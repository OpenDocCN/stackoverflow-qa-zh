# StackOverflow 问答 12100000-12100999

# objective-c - 为 REST API 开发 iOS SDK

> ID：12100000
> 
> 赞同：3
> 
> 时间：2012-08-23T21:09:47.487
> 
> 标签：objective-c, ios, xcode, api, sdk

这几天我一直在努力解决这个问题，似乎无法弄清楚如何最好地构建它。我绝不是 Objective C 的专家。

我们已经为我们的 Drupal 应用程序开发了一个 RESTful API，并且我们目前在 App Store 中有一个使用 ASIHTTPRequest 连接到它的 iOS 应用程序。但是，正如你们中的一些人可能知道的那样，它不再受支持。所以我们决定过渡到 AFNetworking，并希望以这样一种方式构建它，以便我们可以将它作为一个库开源以与我们的 API 一起使用。

我们当前的应用程序使用 CoreData 并将所有数据存储到 SQLite 数据库中。目前的工作流程如下所示：

Get Request Receive JSON Parse and map JSON to CoreData NSManagedObject Save Context

关于你们建议我将源代码作为库开源的路径，我有几个问题。

只是给一个粗略的概述：

我们有成员、组、事件、消息（最简单的）。

我一直在考虑解决这个问题的几种方法：

**将 AFNetworking api 调用和解析/映射方法添加到 NSManagedObject**

我喜欢这个概念，但我不确定它是否有意义。然后核心数据模式成为 API 的模式，这很棒。但我担心的是——如果其他使用它的开发人员不想在他们的应用程序中使用核心数据怎么办？最重要的是，我不确定返回多个实例的方法会是什么样子。例如，如果我有一个 NSManagedObject 组，我应该在哪里调用以获取组索引？此外，我们是否将某人锁定在特定的核心数据模型中，这是一件好事吗？

**拥有知道如何从 API 检索自己的数据、将其解析为自己的属性的单独对象，然后在公共库之外的某个地方映射到 NSManaged 对象**

这种方式听起来也不错，但是我有非常相似的对象具有非常相似的属性。

**类别**

我在这里读到了一些东西，我可以使用一个类别来添加方法， [将附加属性添加到带有辅助 .h .m 文件的 NSManagedObject](https://stackoverflow.com/questions/9900155/add-additional-properties-to-nsmanagedobject-with-secondary-h-m-files) 我不确定这是否有意义。

**API 类、核心数据类和映射器类。**

肯定是乱七八糟的。

**欢迎提出更好的建议！**

我尝试查看其他一些示例，但我认为我没有足够的 Objective C 知识来正确剖析它们。

主要目标是：

抽象为可在其他应用程序中重用的请求库。为对象实施模式是一个加分项 如果他们不想，不要将人们锁定在 CoreData 模型中或根本不使用 CoreData。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:16:14.473

如果您尝试强制执行您的模式，您应该创建自己的模型类。这可以通过子类 NSObject（或任何有意义的东西）或使用 Core Data/NSManagedObject Route 来完成。如果这样做，只需包含所需的文件。

就个人而言，我会单独管理服务器调用。看看 Facebook SDK 3.0 可能会给您一些帮助。基本上创建一个或多个类来处理您的服务器调用，解析信息，然后以对您的用户有意义的方式将其传递回委托/块。

在这里，您可以返回您的自定义对象（或它们的数组等）。您可以在任何网络层之上构建这一切。我是 AFNetworking 的粉丝，但任何方法都可以。只需在子项目/子模块/等中包含所需的代码。只要确保对您使用的所有库都给予信任。

另一种选择是创建一个框架或静态库，将所有这些都包装在一起，并且不允许其他开发人员更改您的内部代码。希望这是一个开始。

# sql-server-2008 - 如何将日期从 table1 填充到 table2？

> ID：12100001
> 
> 赞同：0
> 
> 时间：2012-08-23T21:09:47.747
> 
> 标签：sql-server-2008, insert, identity-column

我正在尝试将记录从 table1 填充到 table2。table1 有三列，没有主键。Table2 具有三个相同的列，其中一个标识列作为主键。以下是我的查询和定义。但不知何故，我得到了一个错误，无法将值 NULL 插入列 'notes_id'，表 'table1; 列不允许空值。插入失败。该语句已终止。我想念什么？

```
CREATE TABLE [dbo].[table1](
    [notes_id] [int] NOT NULL,
    [acty_id] [varchar](80) NOT NULL,
    [notes_datetime] [datetime] NOT NULL,
    [notes_data] [nvarchar](max) NULL,
 CONSTRAINT [PK_tblSRMNotes] PRIMARY KEY CLUSTERED 
(
    [notes_id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

CREATE TABLE [dbo].[table2](
    [acty_id] [varchar](80) NOT NULL,
    [notes_datetime] [datetime] NOT NULL,
    [notes_data] [nvarchar](max) NULL
) ON [PRIMARY]

insert into table1(acty_id, notes_datetime, notes_data)
    select s.acty_id, s.notes_datetime, s.notes_data
    from table2 s 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:12:44.733

您已将第一列设置为 NOT NULL，并将其声明为 PRIMARY KEY，但您尚未说明应如何填充它。通常这是通过 IDENTITY 列：

```
CREATE TABLE [dbo].[table1]
(
    [notes_id] [int] IDENTITY(1,1) NOT NULL,
---------------------^^^^^^^^^^^^^
    [acty_id] [varchar](80) NOT NULL,
    [notes_datetime] [datetime] NOT NULL,
    [notes_data] [nvarchar](max) NULL,
    CONSTRAINT [PK_tblSRMNotes] PRIMARY KEY CLUSTERED (notes_id)
); 
```

# html - 在流体布局中为 jquery UI 滑块制作比例图例/标签

> ID：12100002
> 
> 赞同：0
> 
> 时间：2012-08-23T21:09:49.993
> 
> 标签：html, css, jquery-ui, jquery-ui-slider

[JQuery UI 滑块](http://jqueryui.com/demos/slider/#default)的视觉比例似乎是许多用例所需的常见功能，但我还没有找到制作它的标准方法。

我的问题：这只能根据具体情况通过自定义 HTML 和 CSS 来完成吗？`em`如果是这样，我们如何在图例之间实现正确的间距（假设比例均匀分布，例如 0、10、20、30、40、50）`%`，`px`因为滑块嵌入在流体中布局？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T19:37:47.937

相信我的样本会对你有所帮助。 [JS斌](http://jsbin.com/ijekix/3/)

# json - jQuery Mobile - 如何读取 JSON 并显示表单搜索结果？

> ID：12100003
> 
> 赞同：1
> 
> 时间：2012-08-23T21:09:51.743
> 
> 标签：json, forms, listview, jquery-mobile

我目前正在尝试向 jQuery Mobile 迈出第一步。所以我正在开发一个用于火车时刻表的应用程序。没什么太复杂的。

我输入了一些关于出发、到达、小时数等的信息。查询 url 看起来像这样： 现在[查询示例](http://poucaterra.joaodias.me/app/cp/getdata.php?departure=coimbra&arrival=aveiro&day=2012-08-25&hour=20)
，如果您转到[http://poucaterra.joaodias.me/app/index.html中的应用程序索引](http://poucaterra.joaodias.me/app/index.html)

*（例如，尝试在应用程序中输入相同的值。出发时输入“coimbra”，到达时输入“aveiro”，日期输入“2012-08-25”，小时输入 20）*

显示结果只是一个空白页，上面写着“未定义”。

那么，对我来说，传递返回的 JSON 值、读取它们并将它们发送到带有列表视图的另一个页面，从而显示搜索结果的最佳方式是什么？

请，如果不是要求太多，请向我展示我当前代码的示例。因为因为我在这方面采取了初步措施，所以我已经尝试通读其他代码，但我似乎无法弄清楚在哪里放置什么，何时，如何......*叹息*我真是个菜鸟在这！谢谢 ：）

啊，差点忘了。这是HTML代码：

```
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="pt"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="pt"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="pt"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="pt"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>Pouca Terra</title>
        <meta name="description" content="Pouca Terra - Train timetables">
        <meta name="viewport" content="initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=0;" />

        <!-- Apple Start Icon -->
            <link rel="shortcut icon" href="favicon.ico">
            <meta name="apple-mobile-web-app-capable" content="yes" />
            <meta name="apple-mobile-web-app-status-bar-style" content="black" />
            <link rel="apple-touch-icon-precomposed" href="apple-touch-icon.png"/>
            <link rel="apple-touch-icon-precomposed" sizes="72x72" href="apple-touch-icon-ipad.png" />
            <link rel="apple-touch-icon-precomposed" sizes="114x114" href="apple-touch-icon-iphone4.png" />
            <link rel="apple-touch-startup-image" href="apple-touch-startup-image.png" />

        <!-- CSS -->
            <link rel="stylesheet" href="assets/css/jquery.mobile-1.1.1.min.css" />
            <link rel="stylesheet" type="text/css" href="assets/css/themes/poucaTerra.css"/>

        <!-- Javascript -->
        <script src="assets/js/lib/modernizr-2.5.3.min.js"></script>

    </head>

    <body>
<!--
****************************************************
***************** PAGE: 1 - SEARCH FORM PAGE *************  
****************************************************
-->
            <div data-role="page" id="search">
                <!-- HEADER TOP BAR -->
                    <div data-theme="a" data-role="header" data-position="fixed">
                        <h4>Pouca Terra</h4>
                    </div>
                <!-- END HEADER TOP BAR -->

                <!-- CONTENT FORM -->
                    <div data-role="content" style="padding: 15px">
                        <form id="search-form" action="cp/getdata.php?" method="get">
                                <div data-role="fieldcontain">
                                    <fieldset data-role="controlgroup">
                                        <label for="textinput1">
                                            Departure
                                        </label>
                                        <input name="departure" id="textinput1" placeholder="Estação de Origem" value="" type="text" />
                                    </fieldset>
                                </div>

                                <div data-role="fieldcontain">
                                    <fieldset data-role="controlgroup">
                                        <label for="textinput2">
                                            Arrival
                                        </label>
                                        <input name="arrival" id="textinput2" placeholder="Estação de Destino" value="" type="text" />
                                    </fieldset>
                                </div>

                                <div data-role="fieldcontain">
                                    <fieldset data-role="controlgroup">
                                    <label for="textinput3">
                                            Date
                                        </label>
                                        <input name="day" id="textinput3" placeholder="Formato: aaaa-mm-dd" value="" type="date" />
                                    </fieldset>
                                </div>

                                <div data-role="fieldcontain">
                                    <fieldset data-role="controlgroup">
                                        <label for="slider1">
                                            Hour
                                        </label>
                                        <input type="range" name="hour" id="slider1" value="hour" min="0" max="24" data-highlight="true" data-track-theme="b" />
                                    </fieldset>
                                </div>

                                <input type="submit" value="Submit" />
                        </form>
                    </div>
                <!-- END CONTENT FORM -->

            </div>
<!-- ***************** PAGE: 1 - END SEARCH FORM PAGE ************* -->

<!--
****************************************************
***************** PAGE: 2 - RESULTS TRAIN TIMETABLES *************  
****************************************************
-->
            <div data-role="page" id="results">

                <!-- HEADER TOP BAR -->
                    <div data-theme="d" data-role="header">
                        <h4>Resultados</h4>
                    </div>
                <!-- END HEADER TOP BAR -->

                <!-- CONTENT FORM -->
                    <div data-role="content" style="padding: 15px">
                        <ul data-role="listview" data-theme="c" data-dividertheme="d" data-counttheme="e">  

                        </ul>  
                    </div>
                <!-- END CONTENT FORM -->

            </div>
<!-- ***************** PAGE: 2- END RESULTS TRAIN TIMETABLES ************* -->

        <!-- *** Javascript at the bottom (for performance purposes) *** -->
            <!-- Add to Home -->
                <script type="text/javascript">
                    if ('standalone' in navigator && !navigator.standalone && (/iphone|ipod|ipad/gi).test(navigator.platform) && (/Safari/i).test(navigator.appVersion)) {
                        var addToHomeConfig = {
                            animationIn:'bubble',       // Animation In
                            animationOut:'drop',        // Animation Out
                            lifespan:30000,             // The popup lives 30 seconds
                            expire:2,                   // The popup is shown only once every 2 minutes
                            touchIcon:true,
                            message:''
                        };
                        document.write('<link rel="stylesheet" href="assets/css/add2home.css">');
                        document.write('<script type="application/javascript" src="assets/js/lib/add2home.js"><\/s' + 'cript>');
                    }
                </script>

            <!--jquery-->
                <script type="text/javascript" src="assets/js/lib/jquery-1.8.min.js"></script>

            <!--jquery mobile-->                    
                <script type="text/javascript" src="assets/js/lib/jquery-1.8.min.js"></script>
                <script src="assets/js/lib/jquery.mobile-1.1.1.min.js"></script>

            <!--bootstrap datepicker-->
                <script type="text/javascript" src="assets/js/lib/bootstrap-datepicker.js"></script>

            <!-- Application Javascript -->
                <script type="text/javascript" src="assets/js/pages/index.js"></script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T00:23:56.100

> 我是在第一页（带有表单的那个）还是第二个（带有结果的列表视图的那个）中执行查询？

任何一个都可以，但这是我的建议：这取决于您是在谈论“真实”页面还是 JS 生成的页面。

在传统的基于页面的 Web 开发中，基本模式是这样的：

1.  在第 1 页上构建查询
2.  使用 GET 字符串（例如“ `?foo=bar`”）或 POST 数据（即提交表单，表单上的字段包含您的查询信息）提交它
3.  您的服务器返回第 2 页，其中包含查询结果

您*可以*让第 1 页将查询传递给第 2 页（通过 GET 字符串或 cookie，或将查询传递给中间的服务器），然后让第 2 页通过 AJAX 进行查询……但是因为无论如何您都必须获得第 2 页，所以使用该请求提交查询才有意义。

然而，在移动开发中，“页面”通常根本不涉及导航到新 URL。相反，您只需使用 DOM 操作来更改“页面”（例如“ `$('#oldPage').remove(); $(body).append(newPage)`;”）。在这种情况下，您通常通过 AJAX 调用进行查询，并且由于没有真正的页面转换，“传递查询”就像将 JS 变量从一个函数传递到下一个函数一样简单。

在这种风格中，让“page #2”的代码发出实际的 AJAX 请求通常是有意义的。

希望这会有所帮助，但我觉得我可能没有完全回答您的问题，所以如果您有任何问题，请回复。

# visual-studio-2010 - SGEN：错误：无法加载文件或程序集（HRESULT 异常：0x8013141A）

> ID：12100006
> 
> 赞同：8
> 
> 时间：2012-08-23T21:10:06.303
> 
> 标签：visual-studio-2010, msbuild-4.0, sgen.exe

VS 2010，win server 2003，.Net 3.5 解决方案，从 .Net 1.1 迁移而来

解决方案中的所有项目均已延迟签名。可以为 Debug 成功构建解决方案，但对于 Release 总是失败并出现以下错误。SGEN：错误：无法加载文件或程序集**“AssemblingX**，版本=1.0.5000.0，Culture=neutral，PublicKeyToken=xxxxxxxx”或其依赖项之一。强名称验证失败。（来自 HRESULT 的异常：0x8013141A）

**AssemblingX**是我想要构建的项目。该项目的所有引用的 DLL 都保存在本地文件夹中，并且已经签名。如果我更改项目**AssemblingX**的属性以对其进行签名，则可以构建解决方案以成功发布。

[我按照http://social.msdn.microsoft.com/Forums/nl-NL/msbuild/thread/695581ae-77e7-4c3a-bb3f-6472b8c47f65](http://social.msdn.microsoft.com/Forums/nl-NL/msbuild/thread/695581ae-77e7-4c3a-bb3f-6472b8c47f65)上的指导创建了一个 sgen.exe.config 以启用“loadFromRemoteSources”

但什么都没有改变。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-22T10:10:19.653

此问题与强名称验证有关。在**Ildasm.exe** (C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin)中打开您的**AssemblyX 。**注意它，让我们举个例子。现在以管理员模式打开 VS 命令提示符并运行 sn.exe 命令。如：**`PublicKeyToken``pkt123`**

 **```
sn -Vr *,pkt123 
```

再次构建您的解决方案，现在一切都应该没问题了。

但如果没有，并且您现在也收到相同的错误，那么您需要运行不同版本的 sn.exe。要找到它，请转到 Visual Studio 命令提示符。

```
c:\Program Files(x86)>dir /s sn.exe 
```

这可能需要 5-10 秒，并且应该给出 sn.exe 文件的列表。进入路径执行sn.exe，需要的或者属于你的，如上图。如果不确定要执行哪一个，请执行所有 sn.exe。那应该而且必须解决您的问题。如果没有，请告诉我，让我再次推进 RnD。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-13T18:52:57.297

由于我无法对此唯一答案发表评论，我想确保其他用户不会像我一样遇到这个答案，不会犯其他人可能犯的同样错误。根据强命名实用程序的 MSDN 文档，使用 Vr（签名跳过）开关可能会导致加载恶意程序集，并且只能在开发而不是部署中使用。

[http://msdn.microsoft.com/en-us/library/k5b5tt23(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/k5b5tt23(v=vs.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-24T14:59:43.087

如果仍未解决，您必须在密钥中删除或设置 **AllowStrongNameBypass** (DWORD) 为“1”

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework 
```

在 64 位计算机上，

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework 
```

和

```
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\.NETFramework 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-13T20:16:41.970

在我的情况下，原因是本机库构建到不同的文件夹，然后是应用程序的其余部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-18T15:36:59.913

**打开 cmd。**

```
Cd  "C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin" 
```

**运行**：

`sn –Vr **AssemblingX** name (without dll extension), **PublicKeyToken**`

（编码）

重建解决方案。它应该得到解决。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-26T16:31:18.677

我把对我有用的东西。在第一次构建时它因这个错误而失败，然后我对解决方案进行了重建，它构建得很好。**

# openlayers - 打开图层悬停事件不起作用

> ID：12100012
> 
> 赞同：0
> 
> 时间：2012-08-23T21:10:37.357
> 
> 标签：openlayers

我无法正确注册悬停事件，我不知道为什么。我做了一些迄今为止没有结果的研究，有什么想法吗？？？第一行效果很好，但第二行不行。

谢谢

ClientOverlay.events.register("点击", ClientOverlay, markerClick);

ClientOverlay.events.register("悬停", ClientOverlay, markerClick);

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T11:15:20.427

我不认为这是使用悬停事件的方式，我只使用了 Handler 对象的悬停：

[http://dev.openlayers.org/apidocs/files/OpenLayers/Handler/Hover-js.html](http://dev.openlayers.org/apidocs/files/OpenLayers/Handler/Hover-js.html)

# ios - 在 C 数组中存储 CLLocation2DCoordinates - 动态设置数组大小不起作用

> ID：12100015
> 
> 赞同：2
> 
> 时间：2012-08-23T21:11:24.097
> 
> 标签：ios, nsarray, mkoverlay

我正在尝试编写一个使用地图视图添加叠加层的应用程序。覆盖数据从文件加载到 NSArray 中，如下所示： ...

```
Revier355_2_Poly, //name of the polygon (string) 
6,                //no of coordinates of polygon (int) 
47.4038673907557, //latitude of first coordinate (double)  
8.5247885145479,  //longitude of first coordinate (double)
47.4035082236459,
8.52436382148047,
47.4031174379495,
8.52493568571008,
47.403348653295,
8.52586444637587,
47.4037666977377,
8.52550468311683,
47.4038673907557,
8.5247885145479 
```

...下一个带有名称、点数、坐标的多边形。

现在我想将上述数据转换为 MKPolygons 并将它们放在 NSDictionary 中。为此，我想创建包含文件中每个多边形坐标的 C 数组。这需要在运行时动态设置数组中的项目数。这是我的问题：我无法做到这一点。你能帮忙或指出正确的方向吗？

这是我写的代码

```
int i = 0;
    NSArray *data = [self loadDatafromFile];
    NSMutableDictionary *overlays = [NSMutableDictionary new];
    for ( i=0; i<data.count;i++)
    {

        if ([[data objectAtIndex: i] isKindOfClass: [NSString class]])
            //start of new Polygon called Revier
        {
            //Name of Revier
            NSString *polyName = (NSString*)[data objectAtIndex: i];               
            //PointCount is second entry after name
            int noOfPoints = [[data objectAtIndex: (i+1)] intValue];                    
            //Revier coordinates Error while setting Array size dynamically
            CLLocationCoordinate2D *coord = malloc(sizeof(CLLocationCoordinate2D) * noOfPoints);                          
            for (int j=0; j<noOfPoints+1; j+=2)
                {

                    CLLocationCoordinate2D currCoord = CLLocationCoordinate2DMake([[data objectAtIndex:j+i] doubleValue],[[data objectAtIndex:j+i+1] doubleValue]);
                     coord[j] = currCoord;

                }
            MKPolygon *p = [MKPolygon polygonWithCoordinates:coord count:noOfPoints];
            [overlays setObject: p forKey:polyName];
            free(coord);
        }

    } 
```

这是加载数据的代码...

```
- (NSArray *)loadDatafromFile
{
    NSArray* myArr = [[NSArray alloc] initWithContentsOfFile:[self filePath]];
    NSLog(@"%@",[self filePath]);
    return myArr;
}

- (NSString *) filePath
{
    NSString *path = [[NSBundle mainBundle] pathForResource:@"polygone" ofType:@"txt"];
    NSLog(@"%@",path);
    return path;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:06:27.650

首先，这是您现有代码的问题，该代码将单个元素手动解析为一个大型平面数组......

`for j`循环存在以下问题：

*   `j<noOfPoints+1`应该是`j < (noOfPoints*2)`因为每个点有两个数组元素要处理
*   `data`从数组中获取纬度和经度的索引是错误的（在设置的行中`currCoord`）。顺便说一句，如果它被分成多个语句，那一行会***更容易阅读、理解和（尤其重要）调试。***更正后的代码可能如下所示：

    ```
    int latitudeIndex = j+i +2;     //need to add additional offset of +2
    int longitudeIndex = j+i+1 +2;  //need to add additional offset of +2

    CLLocationDegrees lat = [[data objectAtIndex:latitudeIndex] doubleValue];
    CLLocationDegrees lon = [[data objectAtIndex:longitudeIndex] doubleValue];

    CLLocationCoordinate2D currCoord = CLLocationCoordinate2DMake(lat,lon); 
    ```

*   用于设置 C 数组中元素的索引是错误的。在该行`coord[j] = currCoord;`中，最初`j`将是，`0`但随后会增加`2`。因此，您最终会设置`coord[0]`,`coord[2]`等并使奇数索引未初始化。相反，添加一个单独的计数器作为设置 C 数组的索引（虽然它可以从 计算`j`，但单独的计数器更清晰，更易于理解或更改）：

    ```
    int coordIndex = 0;  //declare and initialize before the for-j loop
    for (int j=0;...
    {
        ...  //code to set currCoord

        coord[coordIndex] = currCoord;
        coordIndex++;
    } 
    ```

这些更改应该可以修复多边形对象的解析和创建，但还有另外两个一般性问题：

*   代码手动解析数组中的每个单独元素，使其难以编写、理解和更改。
*   代码基本上读取 plist 两次，因为外部循环必须读取内部循环已经处理过的元素。外部循环通过检查元素类型是否为字符串来跳过这些。

这两个问题都可以通过使用更好的 plist 格式并让内置的 plist 读取方法为您完成艰苦的工作来解决。您所要做的就是创建 C 数组。

这是您可能的替代 plist 格式：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<array>
    <dict>
        <key>PolygonName</key>
        <string>Revier355_2_Poly</string>
        <key>Coordinates</key>
        <array>
            <dict><key>Latitude</key><real>47.4038673907557</real><key>Longitude</key><real>8.5247885145479</real></dict>
            <dict><key>Latitude</key><real>47.4035082236459</real><key>Longitude</key><real>8.52436382148047</real></dict>
            <dict><key>Latitude</key><real>47.4031174379495</real><key>Longitude</key><real>8.52493568571008</real></dict>
            <dict><key>Latitude</key><real>47.403348653295</real><key>Longitude</key><real>8.52586444637587</real></dict>
            <dict><key>Latitude</key><real>47.4037666977377</real><key>Longitude</key><real>8.52550468311683</real></dict>
            <dict><key>Latitude</key><real>47.4038673907557</real><key>Longitude</key><real>8.5247885145479</real></dict>
        </array>
    </dict>
    <dict>
        <key>PolygonName</key>
        <string>Revier1_Poly</string>
        <key>Coordinates</key>
        <array>
            <dict><key>Latitude</key><real>47.22012717</real><key>Longitude</key><real>8.808388346999999</real></dict>
            <dict><key>Latitude</key><real>47.2394585400515</real><key>Longitude</key><real>8.79568994231076</real></dict>
            <dict><key>Latitude</key><real>47.1394585400515</real><key>Longitude</key><real>4.89568994231076</real></dict>
        </array>
    </dict>
</array>
</plist> 
```

读取这个 plist 的代码是这样的：

```
NSArray *polygonsArray = [NSArray arrayWithContentsOfFile:path];

NSMutableDictionary *overlays = [NSMutableDictionary new];

//loop through the polygon dictionaries...
for (NSDictionary *polygonDict in polygonsArray) 
{
    NSString *polyName = [polygonDict objectForKey:@"PolygonName"];
    NSArray *coordDictionaries = [polygonDict objectForKey:@"Coordinates"];

    //loop through the array of coordinate dictionaries for the 
    //current polygon to create C array of coordinates...
    int noOfPoints = coordDictionaries.count;
    CLLocationCoordinate2D *coord = malloc(sizeof(CLLocationCoordinate2D) * noOfPoints);

    int coordIndex = 0;
    for (NSDictionary *coordDict in coordDictionaries) 
    {
        CLLocationDegrees lat = [[coordDict objectForKey:@"Latitude"] doubleValue];
        CLLocationDegrees lon = [[coordDict objectForKey:@"Longitude"] doubleValue];
        CLLocationCoordinate2D currCoord = CLLocationCoordinate2DMake(lat,lon);
        coord[coordIndex] = currCoord;
        coordIndex++;
    }

    MKPolygon *p = [MKPolygon polygonWithCoordinates:coord count:noOfPoints];
    [overlays setObject:p forKey:polyName];
    [self.mapView addOverlay:p];
    free(coord);
} 
```

请注意，您必须处理的唯一索引计算是针对 C 数组。

如果您需要更高级或标准化的格式，还可以查看[KML](https://developers.google.com/kml/documentation/kml_tut#polygons)。Apple还提供了[KMLViewer](http://developer.apple.com/library/ios/#samplecode/KMLViewer/Introduction/Intro.html)示例应用程序，但我认为示例代码仅解析折线。

关于您在评论中的问题：

> 有没有比 plist 更好的机制来做到这一点？

这取决于您希望存储多少数据。如果 plist 对您的应用程序来说不够快，您将不得不切换到允许随机访问数据的方法（例如 SQL 数据库或多个 plist）。如有必要，这可能值得一个单独的问题。

# mysql - 如何简化多个子查询和 GROUP_CONCAT？

> ID：12100019
> 
> 赞同：1
> 
> 时间：2012-08-23T21:11:33.973
> 
> 标签：mysql, subquery, group-concat

*这个查询在三个查找表ls*、*lo*和*ld*的帮助下从一个主表*m*、三个辅助表*s*、*o*和*d*中获得了我想要的结果，但是它为每个字段查询每个表一次。

 ***```
SELECT m.id, 
(SELECT GROUP_CONCAT(s.field1 SEPARATOR ', ')
    FROM s, ls
    WHERE ls.mid=m.id AND ls.sid=s.id) 
    AS s_field,
(SELECT GROUP_CONCAT(o.field1 SEPARATOR ', ')
    FROM o, lo
    WHERE lo.mid=m.id AND lo.oid=o.id) 
    AS o_field1,
(SELECT GROUP_CONCAT(o.field2 SEPARATOR ', ')
    FROM o, lo
    WHERE lo.mid=m.id AND lo.oid=o.id) 
    AS o_field2,
(SELECT GROUP_CONCAT(o.field3 SEPARATOR ', ')
    FROM o, lo
    WHERE lo.mid=m.id AND lo.oid=o.id) 
    AS o_field3,
(SELECT GROUP_CONCAT(o.field4 SEPARATOR ', ')
    FROM o, lo
    WHERE lo.mid=m.id AND lo.oid=o.id) 
    AS o_field4,
(SELECT GROUP_CONCAT(d.field1 SEPARATOR ', ')
    FROM d, ld
    WHERE ld.mid=m.id AND ld.did=d.id) 
    AS d_field1,
(SELECT GROUP_CONCAT(d.field2 SEPARATOR ', ')
    FROM d, ld
    WHERE ld.mid=m.id AND ld.did=d.id) 
    AS d_field2
FROM m
WHERE m.id=22 GROUP BY m.id 
```

如何重写它以获得相同的结果，但每个表只有一个子查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:24:31.433

您可以使用以下内容：

```
SELECT m.id, 
    GROUP_CONCAT(sls.field1 SEPARATOR ', ') AS s_field,
    GROUP_CONCAT(olo.field1 SEPARATOR ', ') AS o_field1,
    GROUP_CONCAT(olo.field2 SEPARATOR ', ') AS o_field2,
    GROUP_CONCAT(olo.field3 SEPARATOR ', ') AS o_field3,
    GROUP_CONCAT(olo.field4 SEPARATOR ', ') AS o_field4,
    GROUP_CONCAT(dld.field1 SEPARATOR ', ') AS d_field1,
    GROUP_CONCAT(dld.field2 SEPARATOR ', ') AS d_field2,
FROM m
(
    SELECT ls.mid, s.field1
    FROM s
    INNER JOIN ls
        on s.id = ls.sid
) sls
    on m.id = sls.mid
INNER JOIN
(
    SELECT lo.mid, o.field1, o.field2, o.field3, o.field4
    FROM o
    INNER JOIN lo
        on o.id = lo.oid
) olo
    on m.id = olo.mid
INNER JOIN
(
    SELECT ld.mid, d.field1, d.field2
    FROM d
    INNER JOIN ld
        on d.id = ld.did
) dld
    on m.id = dld.mid
WHERE m.id=22 
GROUP BY m.id 
```***

# c# - TaskCompletionSource ：何时使用 SetResult() 与 TrySetResult() 等

> ID：12100022
> 
> 赞同：58
> 
> 时间：2012-08-23T21:11:42.120
> 
> 标签：c#, asynchronous, task-parallel-library, async-await, c#-5.0

我试图围绕 TPL、C# 5 中的新`async`/`await`功能以及`TaskCompletionSource`.

我不清楚的一件事是何时使用`SetResult`,`SetException`和`SetCancel`vs `TrySetResult`, `TrySetException`and `TrySetCancel`。

这是 MSDN 不得不说的：

> 如果任务已处于三种最终状态之一，则此操作将返回 false：RanToCompletion、Faulted 或 Canceled。
> 
> 如果底层任务已被释放，此方法也会返回 false。

好的，我明白了，但它并没有真正提供关于何时或为什么使用其中一个而不是另一个的任何指导。

那么，有什么关系呢？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-08-23T21:14:53.257

我*怀疑*重点是，如果只有一件事会设置结果，只需调用`SetResult`等。如果您最终调用`SetResult`两次，则表明存在错误。（同样，如果`TaskCompletionSource`已被处置。）

如果您有多个线程可能都试图同时设置结果（例如，它表示多个并行 Web 服务调用的第一个结果），那么使用`TrySetResult`，因为多个线程“尝试”是完全合理的" 设置结果，不知道其他线程是否已经设置了它。

我还没有看到任何官方指导，但这是有道理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-03-19T10:34:43.143

除了乔恩的回答之外，MS 文档门户网站还说`TrySetResult`：

`Task<TResult>`如果已经处于三种最终状态之一，则此操作将返回 false ：

*   **RanToCompletion**
*   **故障**
*   **取消**

链接：[https ://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.taskcompletionsource-1.trysetresult?view=net-5.0](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.taskcompletionsource-1.trysetresult?view=net-5.0)

# mysql - 如何改进以下查询

> ID：12100028
> 
> 赞同：0
> 
> 时间：2012-08-23T21:12:09.873
> 
> 标签：mysql, django, django-models

我需要获取给定提供商的所有用户列表。一个用户可能有多个提供者，一个提供者可能有多个用户。这是我到目前为止所拥有的：

我有以下表格：

```
class Provider(models.Model):
    provider = models.CharField(max_length=100, primary_key=True)

class UserProfile(models.Model):
    user = models.ForeignKey(User, primary_key=True)
    provider = models.ManyToManyField(Provider, db_column='provider') 
```

在我看来：

```
providers = Provider.objects.order_by('provider') 
```

在我的模板中：

```
{% for provider in providers %}
<tr>
    <td class="provider">
        {{ provider.provider }}
    </td>
    <td class="email">
        {% for profile in provider.userprofile_set.all %}
            {{ profile.user }}
        {% endfor %}    
    </td>
</tr>
{% endfor %} 
```

这会产生大约 250 个查询，因为我正在遍历模板中的 Provider QuerySet。我将如何改进上述内容 - 有没有办法使用`prefetch_related`或`select_related`在这里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:20:43.187

使用[`prefetch_related()`](https://docs.djangoproject.com/en/1.4/ref/models/querysets/#prefetch-related)；`select _related()`不适用于`ManyToManyField`s：

```
providers = Provider.objects.order_by('provider').all().prefetch_related('userprofile_set') 
```

从文档：

> 返回一个`QuerySet`将在单个批次中自动检索每个指定查找的相关对象的 a。
> 
> 这与 的目的相似`select_related`，因为两者都旨在阻止由访问相关对象引起的大量数据库查询，但策略完全不同。
> 
> ...
> 
> `prefetch_related`另一方面，对每个关系进行单独的查找，并在 Python 中进行“加入”。这允许它预取多对多和多对一对象，这是使用 无法完成`select_related`的，除了由`select_related`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:27:59.303

我没有使用 django，但我只是在这里找到了答案：[docs.djangoproject.com](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-related)

```
providers = Provider.objects.select_related().order_by('provider').all() 
```

# jsp - Spring mvc 控制器 - 参数绑定

> ID：12100043
> 
> 赞同：1
> 
> 时间：2012-08-23T21:13:13.817
> 
> 标签：jsp, spring-mvc

我正在阅读 Spring in action，现在我正在阅读有关构建 Web 应用程序的章节，但我无法完全掌握一件事

例如，如果我们有这样的方法：

```
@RequestMapping(method=RequestMethod.GET, params="new")
public String createSpitterProfile(Model model) {
  model.addAttribute(new Spitter());
  return "spitters/edit";
} 
```

这里我们将类的实例添加`Spitter`到模型中，所以它被传递给这个表单

```
<div>
<h2>Create a free Spitter account</h2>

<sf:form method="POST" modelAttribute="spitter" 
    enctype="multipart/form-data">         
  <fieldset> 
  <table cellspacing="0">
  <tr>
    <th><sf:label path="fullName">Full name:</sf:label></th>
    <td><sf:input path="fullName" size="15" /><br/>
    <sf:errors path="fullName" cssClass="error" />
    </td>
  </tr>
  <tr>
    <th><sf:label path="username">Username:</sf:label></th>
    <td><sf:input path="username" size="15" maxlength="15" />
      <small id="username_msg">No spaces, please.</small><br/>
    <sf:errors path="username" cssClass="error" />

    </td>
  </tr>
  <tr>
    <th><sf:label path="password">Password:</sf:label></th>
    <td><sf:password path="password" size="30" 
            showPassword="true"/> 
    <small>6 characters or more (be tricky!)</small><br/>
    <sf:errors path="password" cssClass="error" />
    </td>
  </tr>

  <tr>
    <th><sf:label path="email">Email Address:</sf:label></th>

    <td><sf:input path="email" size="30"/> 
    <small>In case you forget something</small><br/>
    <sf:errors path="email" cssClass="error" />
    </td>
  </tr>
  <!--<start id="image_field"/>--> 
  <tr>
    <th><label for="image">Profile image:</label></th>
    <td><input name="image" type="file"/>
  </tr>
  <!--<end id="image_field"/>--> 
  <tr>
    <th></th>
    <td>
    <sf:checkbox path="updateByEmail"/>
    <sf:label path="updateByEmail" 
    >Send me email updates!</sf:label>

    </td>
  </tr>
  <tr>
    <th></th>
    <td><input name="commit" type="submit" 
        value="I accept. Create my account." /></td>
  </tr>
  </table>
</fieldset>
</sf:form>
</div> 
```

用户输入数据后，这些输入数据将绑定到某个`Spitter`对象并由

```
 @RequestMapping(method=RequestMethod.POST)
public String addSpitterFromForm(@Valid Spitter spitter, 
BindingResult bindingResult,
@RequestParam(value="image", required=false) MultipartFile image) {

  if(bindingResult.hasErrors()) {
return "spitters/edit";
  } 

  spitterService.saveSpitter(spitter);

  try {
if(!image.isEmpty()) {
  validateImage(image);
  saveImage(spitter.getId() + ".jpg", image);
}
  } catch (ImageUploadException e) {
bindingResult.reject(e.getMessage());
return "spitters/edit";
  }

  return "redirect:/spitters/" + spitter.getUsername();
} 
```

我将一些对象传递给将要填充的模型，但我很感兴趣这在幕后是如何工作的，因为当页面提供给用户时，有关对象的信息会丢失（或者我错了）？

1.添加的对象是否与请求的数据来时Spring动态创建的第二个对象`createSpitterProfile`相同（相同的含义引用） ？`Spitter``addSpitterFromForm`

2.当用户输入进来的请求中`addSpitterFromForm`，Spring如何知道表单中的信息应该被处理到`Spitter`对象，我知道`Spitter`方法签名中有对象，但是Spring如何知道数据应填充此对象属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T01:27:24.163

您必须记住，客户端 Web 浏览器从服务器获取“普通的旧 HTML”（那里没有魔法/隐藏的 Java）。因此 Spring 将模型对象“编码”为 HTML，以`<form>`输入、单选、选择等形式。

用户获得一个普通的 HTML 网页，填写表单并按下提交以 POST 或 GET 页面返回到 Web 服务器。这就是 Spring 将请求参数“反编码”回正在绑定的对象（即）的神奇之处`Spitter`。所以回答 Q1，不，它不是同一个对象，它是一个副本（甚至可能是一个有损副本）。

至于 Q2，当您要求 Spring 将请求绑定到对象时，它所做的只是尝试将请求参数名称与对象上的 setter 匹配。它“知道”是因为您在方法签名中要求它。Spring 在决定如何处理方法签名方面做了一些花哨的事情，并且值得一读，因为你输入参数的顺序很重要。

# ruby-on-rails-3 - 控制来自 Rails 电话“目录”应用程序的更新通知电子邮件的内容

> ID：12100045
> 
> 赞同：0
> 
> 时间：2012-08-23T21:13:48.703
> 
> 标签：ruby-on-rails-3

我已经使用 Rails 设置了一个基本电话目录，我们公司的管理员助理可以访问它来查找员工电话号码和其他联系信息。我还设置了默认邮件 gem，以便在添加/删除或更新条目时将通知电子邮件发送到分发电子邮件地址。我的问题与发送我们的更新通知有关。现在“更新”通知“发送我的更新通知视图的所有信息，因为我已经设置视图以包含所有信息，但理想情况下我想设置它以便它表示更新的信息任何给定的员工记录。任何提示我该怎么做？下面是我的“updatedstaff.notification.text.erb”的一个例子......

姓名：

电话号码：

办公室：

因此，假设其中一位管理员仅更新了给定员工的电话号码......我想发送一封“更新”通知电子邮件，显示/突出显示电话号码已更改。就像它应该列出所有工作人员的信息，但显示“更新->电话号码：”有什么想法我会这样做吗？

干杯，克里斯

# android - 为什么 OrmLite / SqlLite / Android 中的表周围需要“`”？

> ID：12100050
> 
> 赞同：2
> 
> 时间：2012-08-23T21:14:18.670
> 
> 标签：android, sqlite, ormlite

将 OrmLite 与 android 一起使用，我尝试了一个简单的查询：

```
GenericRawResults<String[]> results = queryRaw("SELECT * FROM transaction"); 
```

不幸的是，我收到了一个例外：

```
near "transaction": syntax error: , while compiling: SELECT * FROM transaction 
```

我发现这令人困惑，在逐步查看 Orm 通过编译语句生成的内容后，我意识到语法应该是：

```
GenericRawResults<String[]> results = queryRaw("SELECT * FROM `transaction`"); 
```

我只是有点困惑为什么需要这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:15:29.667

[“事务”是一个 SQLite3 关键字。](http://www.sqlite.org/lang_keywords.html)

该页面的相关引用，位于最顶部：

> SQL 标准规定了 [...] 不能用作表名的关键字 [...]
> [...]
> 如果要使用关键字作为名称，则需要将其引用。

文档是你的朋友。^*

^(* 除非不是。但在这种情况下，它是。)

# android - 刷新有关连接状态更改的 Android 视图

> ID：12100051
> 
> 赞同：1
> 
> 时间：2012-08-23T21:14:19.203
> 
> 标签：android, broadcastreceiver, connectivity

我有几个屏幕，其中有上传按钮。

我还具有检查是否存在 3g 或 wifi 连接的功能，以及将按钮设置为灰色（如果没有连接）和绿色（如果有）的功能。唯一的问题是这仅在首次创建布局时触发，但我希望在连接发生变化时触发它。

有没有办法做到这一点？从概念上讲，我希望在我的主菜单类中有一个广播接收器来触发刷新按钮功能，但我不知道该怎么做。

我在这里浏览了代码：http: [//www.netmite.com/android/mydroid/frameworks/base/core/java/android/net/NetworkConnectivityListener.java](http://www.netmite.com/android/mydroid/frameworks/base/core/java/android/net/NetworkConnectivityListener.java)

以及这里的建议[BroadcastReceiver 作为内部类](https://stackoverflow.com/questions/4854807/broadcastreceiver-as-inner-class)，但我没有运气

当广播接收器是一个单独的类时，它工作得很好，但我想将它集成到各种活动中，我不知道如何进行。

任何方向都会有所帮助

```
private void updateUI(){
    File[] allDir = DataWriter.getRootDir(profile).listFiles();
    if(allDir==null){
        uploadButton.setBackgroundResource(R.drawable.gray_button);
        uploadButton.setEnabled(false);
        return;
    }

    //MAXIM
    boolean anyfiles = false;
    outerloop:
        for(File dir: allDir){
            if(dir.getName().contains(profile[12])){
                File[] allFiles = dir.listFiles();
                for(File f:allFiles){
                    if(f.isDirectory())continue;
                    anyfiles = true;
                    break outerloop;
                }
            }
        }
    //
    if (!anyfiles) {
        uploadButton.setBackgroundResource(R.drawable.gray_button);
        uploadButton.setEnabled(false);

    } else {
        if (intOpt==0) {
            if(checkWifi()==true)
            {   
                uploadButton.setBackgroundResource(R.drawable.red_button);
                uploadButton.setEnabled(true);
            }
            else {
                //MAXIM-changed blue_button to red_button
                uploadButton.setBackgroundResource(R.drawable.gray_button);
                uploadButton.setEnabled(false);
            }
            //uploadButton.setEnabled(true);
        } 
        else if(intOpt==1)
        {
            if(check3G()||checkWifi())
            {
                uploadButton.setBackgroundResource(R.drawable.red_button);
                uploadButton.setEnabled(true);
            }
            else {
                //MAXIM-changed blue_button to red_button
                uploadButton.setBackgroundResource(R.drawable.gray_button);
                uploadButton.setEnabled(false);
            }
            //uploadButton.setEnabled(true);
        }
        else {
            //MAXIM-changed blue_button to red_button
            uploadButton.setBackgroundResource(R.drawable.gray_button);
            uploadButton.setEnabled(false);
        }
        //uploadButton.setEnabled(true);
    }
}

public boolean checkWifi() {
    ConnectivityManager conMan = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
    android.net.NetworkInfo.State wifi = conMan.getNetworkInfo(1).getState();

    if (wifi == android.net.NetworkInfo.State.CONNECTED) {
        return true;
    } else {
        return false;
    }
}

public boolean check3G() {
    ConnectivityManager conMan = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
    android.net.NetworkInfo.State mobile = conMan.getNetworkInfo(0).getState();
    if (mobile == android.net.NetworkInfo.State.CONNECTED) {
        return true;
    } else {
        return false;
    }
} 
```

基本上我需要`updateUI();`在连接发生变化时被触发。

谢谢

跟进：

我收到以下代码的错误“方法的返回类型丢失”

```
BroadcastReceiver networkStateReceiver = new BroadcastReceiver() {

    @Override
    public void onReceive(Context context, Intent intent) {
        Log.w("Network Listener", "Network Type Changed");
        UpdateUI();
    }
};

IntentFilter filter = new IntentFilter(ConnectivityManager.CONNECTIVITY_ACTION);        
registerReceiver(networkStateReceiver, filter); // This is the line that gives me an error 
```

我错过了什么吗？

编辑：更多代码

这是主菜单活动 - 用户可以在其中执行他们想要的任何操作、更改设置等的屏幕

公共类 MenuMainActivity 扩展 Activity { 私有 BHBluetoothService mBluetoothService = null;

```
private String[] profile = null;
private String username = null;
private String password = null;
public static String upass = null; 
public static String uuname = null;
private double[] params = new double[2];
private double[] heart = null;
private double[] stride = null;
private double[] speed = null;
private List<File> files = new ArrayList<File>();
public static int intOpt=0;
private Button baselineButton,exerciseButton,fireTrainButton,
fireSuppButton,emerButton,rehaButton,uploadButton;
private static final int PROGRESS_DIALOG = 0;
private ProgressThread progressThread;
private ProgressDialog progressDialog;
private RadioButton wifiButton, button3g;

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.main_menu);
    initializeBluetooth();
    Bundle extras = this.getIntent().getExtras();
    if (extras.containsKey("profile")) {
        try {
            profile = extras.getStringArray("profile");
            username = profile[0];
            password = profile[1];
            upass=password;
            uuname=username;
            initializeUI();

        } catch (Exception e) {
            e.printStackTrace();
        }
    } else {
        finish();
    }    
    if (extras.containsKey("params") && extras.containsKey("heart") && extras.containsKey("stride") && extras.containsKey("speed")) {
        params = extras.getDoubleArray("params");
        heart = extras.getDoubleArray("heart");
        stride = extras.getDoubleArray("stride");
        speed = extras.getDoubleArray("speed");
    }
    updateUI();

} 
```

出色地; 这是主菜单活动的起始代码。

我想触发 updateUI(); 在任何连接状态更改时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:31:38.893

您可以设置一个`BroadcastReceiver`来监听连接警报。查看[此](https://stackoverflow.com/questions/1783117/network-listener-android)SO 帖子以获取示例。

# c# - EF5 代码优先迁移：小数精度和小数位数

> ID：12100059
> 
> 赞同：3
> 
> 时间：2012-08-23T21:14:53.100
> 
> 标签：c#, entity-framework-migrations, entity-framework-5

我正在尝试在现有的销售点自助服务终端应用程序上使用代码优先。这是一个加油站应用程序，所以我需要使用小数点后三位的货币。

我在迁移中使用以下代码来设置精度和比例：

```
CustomSqlGenerator.DropDefaultConstraint("Config", "DefaultTaxPerDollar", q => Sql(q));
    AlterColumn("Config", "DefaultTaxPerDollar", c => c.Decimal(nullable: false, precision: 19, scale: 4, defaultValue: 0.087m));
```

（该`DropDefaultConstraint`调用是[此错误](https://stackoverflow.com/questions/11974439/changing-column-default-values-in-ef5-code-first)的解决方法。我尝试删除它 - 在初始迁移中创建列而不是稍后更改它 - 无济于事。）

并以适当的精度和比例创建列。我可以使用 SSMS 正确输入值（即 1.2345 保存为 1.2345）。但是当通过模型保存值时，所有值都被截断 - 不四舍五入 - 到小数点后 2 位（例如 0.5555 变为 0.55）。

我尝试的第一件事是在 OnModelCreating 方法中使用 Fluent API，如下[所示](https://stackoverflow.com/questions/9032919/set-decimal16-3-for-a-column-in-code-first-approach-in-ef4-3)：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity()
        .Property(c => c.DefaultTaxPerDollar)
        .HasPrecision(19, 4);

    base.OnModelCreating(modelBuilder);
} 
```

但这会产生`The model backing the 'SalesDataStore' context has changed since the database was created. Consider using Code First Migrations to update the database ([http://go.microsoft.com/fwlink/?LinkId=238269](http://go.microsoft.com/fwlink/?LinkId=238269))`

也试过：

*   包括`modelBuilder.Conventions.Remove<DecimalPropertyConvention>()`在`OnModelCreating`方法中，完全删除 18,2 十进制约定。与上述相同的异常
*   从头开始构建最新的[源代码](http://entityframework.codeplex.com/)`DecimalPropertyConvention`，并将类中的默认比例更改为 4。同样的例外。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:03:33.170

映射定义您的模型。每个迁移都存储模型的压缩 XML 表示（可能还有哈希）。当您更改映射中的任何内容（包括删除任何默认约定）时，您也会更改映射的最终 XML 表示形式及其散列。EF 使用这些哈希来检查模型是否更改 - 如果您更改模型，您还必须进行新的迁移才能使其正常工作。

# c++ - 如果我将字符串复制到 NULL 指针上，为什么 C++ 不打印任何内容？

> ID：12100062
> 
> 赞同：0
> 
> 时间：2012-08-23T21:14:58.633
> 
> 标签：c++, string, pointers

我只是想试试这段代码......

```
#include <iostream>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

using namespace std;

int main() {
      char *outFile1 = NULL;
      char *outFile2 = NULL;
      cout << "HI";
      outFile1 = "//tmp//Softwares//v//vdisk";
      strcpy(outFile2, outFile1);
      cout << "HI";
} 
```

如果我运行这段代码......什么都不会打印。如果我评论“strcpy（outFile2，outFile1）;”......两个“HI”都会被打印出来。为什么会出现这种情况？它不会给我任何错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:19:29.450

您正在写信到一个无效的位置。您的程序在`strcpy()`. 由于输出被缓冲，第一个`HI`不打印。如果您将第一个 cout 更改为：

```
cout << "HI" << endl; 
```

......你可能会明白的。

至于你的程序为什么会崩溃，这会将字符串的地址放入`outfile1`：

```
outFile1 = "//tmp//Softwares//v//vdisk"; 
```

这会将字符串复制到位置零，这（取决于操作系统）通常会杀死您的程序：

```
strcpy(outFile2, outFile1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:18:16.703

没有为任一字符串分配内存。您只需设置一个指向字符串文字“//tmp//Softwares//v//vdisk”的指针。现在，当您将其从 outFile1 复制到 outFile2 时，您很可能会覆盖您不应该覆盖的内容，或者由于某种原因 strcpy 在其他地方引起了问题（很难说，因为它是未定义的）。这只是一个猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:24:03.073

您的代码存在一些问题，其中一个字符字符串 outFile2 尚未分配，因此您的程序可能会损坏堆栈并阻止正确显示输出。

尝试使用 malloc() 分配一些内存来保存要复制的字符串，或者使用 C++ std String 类 (http://www.cplusplus.com/reference/string/string/) 进行研究。C 内存分配类似于，

```
int slen=strlen(outFile1)+1;
outFile2 = (char *)malloc(sizeof(char)*slen);
strncpy(outFile2, outFile1, slen); 
```

# c++ - C++ 类组合错误：未完善的参考

> ID：12100066
> 
> 赞同：0
> 
> 时间：2012-08-23T21:15:09.007
> 
> 标签：c++, class, abstract-class

有这个烦人的错误。

我不断收到对 class::method 的未定义引用

这是我想做的代码

```
student::student(){
conscience* c;
unsigned short choice = rand() % 4;
if (choice == 0){
    c = new betray();
}
if (choice == 1){
    c = new silent();
}
if (choice == 2){
    c = new confused();
}
if (choice == 3){
    c = new experienced();
} 
```

但我不断收到错误。

这种解决方法效果很好，但不在主类构造函数中，而是通过参数传递

```
student::student(conscience* c){
    m_Conscience = c;
} 
```

提前致谢。

编辑：确切的错误：未定义对“背叛：：背叛（）”的引用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:23:20.043

未定义的引用可能意味着以下之一：

1.  您在基类中有一个方法声明，您可以调用该方法声明，但从未在任何派生类中实现。
2.  或者，它被实现了，但是你没有链接到它，所以链接器找不到它。

我建议你检查你是否链接到 betray.o。检查你的makefile。如果您没有makefile，我鼓励您编写一个。

# webrtc - WebRTC 无法创建对等连接

> ID：12100068
> 
> 赞同：5
> 
> 时间：2012-08-23T21:15:16.603
> 
> 标签：webrtc

将 webkitPeerConnection 更改为 webkitPeerConnection00 后，我无法在 webrtc 应用程序上创建对等连接

为什么 onSignalingMessage 不调用

```
 pc = new webkitPeerConnection00(stun, onSignalingMessage); 
```

这是代码

```
$(function(){
var localInfo = {
    video:  $("#video_local").get(0),
    video_remote:  $("#video_remote").get(0),
    stream: null,
    initiator: false,
    peerCon: null,
    started: false,
    uid: render_param.uid,
    readySDP: null
};
wsSend({"act": "list", "join": "1"}, function(data){
    updateRoomDisplay(data.room_list);
    setInterval(function(){
        wsSend({"act": "check"}, function(data){
            $.each(data.ret, function(i, json_str){
                var msg = JSON.parse(json_str)
                if (msg.type == "sdp"){
                    receiveSDP(msg.sdp);
                } else if (msg.type == "room_info"){
                    updateRoomDisplay(msg.room_list);
                }

            });
        });
    }, 3000);
});
function updateRoomDisplay(room_list){
    console.log("list receive", room_list);
    var container = $("#room_container");
    container.empty();
    $.each(room_list, function(i, room_persons){
        if (i > 0){
            var class_add = "";
            if (room_persons == 2){
                class_add = " room_full";
            }
            $('<div class="room' + class_add + '" data-no="' + i + '"> Room' + (100 + i) + 
                "<br/>(" + room_persons + "人)</div>").appendTo(container);
        }
    });
    container.append($('<div style="clear: both">ロビー'+ room_list[0] + '人&lt;/div>'));
}
function receiveSDP(sdp){
    if (sdp == 'BYE') {
        console.log('Session terminated.');
        localInfo.video_remote.src = null;
        localInfo.video_remote.style.opacity = 0;
        localInfo.initiator = false;
        localInfo.started = false;
    } else {
        if (sdp.indexOf("\"ERROR\"", 0) == -1) {
            if (!localInfo.initiator && !localInfo.started) {
                maybeStart();
            }
            if (localInfo.peerCon){
                console.log("processSignalingMessage1");
                localInfo.peerCon.processSignalingMessage(sdp);
            } else {
                console.log("sdp ready");
                localInfo.readySDP = sdp;
            }
        } else {
            console.log("ERROR ***************");
        }
    }
}
$(window).unload(function(){
    $.ajax({
        type: "POST",
        url: "/ajax",
        async: false,
        data: {"act": "leave", "uid": localInfo.uid},
        dataType: "json"
    });
});

$("#room_container").on("click", ".room", function(){
    var no = parseInt($(this).attr("data-no"));
    try {
        navigator.webkitGetUserMedia({audio:true, video:true}, onGUMSuccess, onGUMError);
        console.log("Requested access to local media with new syntax.");
    } catch (e) {
        try {
            navigator.webkitGetUserMedia("video,audio", onGUMSuccess, onGUMError);
            console.log("Requested access to local media with old syntax.");
        } catch (e) {
            alert("webkitGetUserMedia() failed. Is the MediaStream flag enabled in about:flags?");
            console.log("webkitGetUserMedia failed with exception: " + e.message);
        }
    }
    function onGUMSuccess(stream){
        localInfo.stream = stream;
        localInfo.video.src = window.webkitURL ?  window.webkitURL.createObjectURL(stream) : stream;

        wsSend({act: "move", room_fr: 0, room_to: no}, function(data){
            console.log("move_ok receive");
            console.log(data.room_list);
            localInfo.room = data.room_to;
            if (data.count == 2){
                localInfo.initiator = true;
                maybeStart();
            } else {
                localInfo.initiator = false;
            }
        });
        $("#video_container").slideDown();
        $("#room_container").fadeOut();

    }
    function onGUMError(error){
        console.error('An error occurred: [CODE ' + error.code + ']');
        return;
    }
});
$("#dis").click(function(){
    localInfo.stream.stop();
    localInfo.stream = null;
    localInfo.started = false;
    $(localInfo.video).removeAttr("src");
    $(localInfo.video_remote).removeAttr("src");
    if (localInfo.peerCon){
        localInfo.peerCon.close();
        localInfo.peerCon = null;
    }
    wsSend({act: "move", room_fr: localInfo.room, room_to: 0}, function(data){
        console.log("move_ok receive");
        console.log(data.room_list);
        localInfo.room = data.room_to;
    });
    $("#video_container").slideUp();
    $("#room_container").fadeIn();

});

function maybeStart() {
    if (!localInfo.started && localInfo.stream) {
        console.log("Creating PeerConnection.");
        createPeerConnection();
        console.log("Adding local stream.");
        localInfo.peerCon.addStream(localInfo.stream);
        localInfo.started = true;
    }
}

function createPeerConnection(){
    var pc;
    var stun = "STUN stun.l.google.com:19302";

    if (localInfo.peerCon == null){
        console.log("createPeerConnection")
        try {
            pc = new webkitDeprecatedPeerConnection(stun, onSignalingMessage);
        } catch (e){
            try {
                pc = new webkitPeerConnection00(stun, onSignalingMessage);
                console.log("Created webkitPeerConnnection with config.");
            } catch (e) {
                console.log("Failed to create webkitPeerConnection, exception: " + e.message);
                alert("Cannot create PeerConnection object; Is the 'PeerConnection' flag enabled in about:flags?");
                return;
            }
        }
        localInfo.peerCon = pc;
    } else {
        console.log("use peerConnection")
        pc = localInfo.peerCon;
    }

    $(pc).bind("connecting", function(){
        console.log("onSessionConnecting...");
    });
    $(pc).bind("open", function(){
        console.log("onSessionOpened...");
    });

    pc.onaddstream = function(){
        console.log("onRemoteStreamAdded...");
        var url = webkitURL.createObjectURL(event.stream);
        localInfo.video_remote.src = url;

    };
    $(pc).bind("removestream", function(){
        console.log("onRemoteStreamRemoved...");
    });

    if (localInfo.readySDP){
        console.log("processSignalingMessage2");
        localInfo.peerCon.processSignalingMessage(localInfo.readySDP);
    }
}

function onSignalingMessage(msg) {
    console.log("receive signaling message");
    wsSend({"act": "sdp", "room_no": localInfo.room, "sdp": msg});
}

function wsSend(obj, callback){
    if (!callback){
        callback = function(res){
            console.log(res);
        };
    }
    obj = obj || {};
    obj["uid"] = localInfo.uid;
    $.ajax({
        type: "POST",
        url: "/ajax",
        data: obj,
        dataType: "json",
        success: callback,
        error: function(){
        }
    });
} 
```

});

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-24T02:18:28.560

`webkitPeerConnection00`现在正在使用**JSEP** ---- 所以它通过**ice-candidates**而不是**信令消息**：

```
window.PeerConnection = window.webkitPeerConnection00;
var peer = new PeerConnection(stun, onGettingIceCandidates);

function onGettingIceCandidates(candidate, isLastCandidate)
{
    // candidate.toSdp() ------ and ------ candidate.label
} 
```

**请看一下这个项目的代码：** [https ://webrtc-experiment.appspot.com/](https://webrtc-experiment.appspot.com/)

# javascript - PhoneGap / Cordova 回调错误 - 在 PhoneGap 中未执行 RestKit 完成功能

> ID：12100070
> 
> 赞同：1
> 
> 时间：2012-08-23T21:15:21.507
> 
> 标签：javascript, objective-c, ios, cordova, restkit

如果从 RestKit 回调中调用 PhoneGap 回调似乎不起作用。我们已经通过删除 RestKit 调用验证了我们的 PhoneGap 回调逻辑工作正常（加上我们所有其他 PhoneGap 插件回调工作正常）。在下面的代码中，loader.onDidLoadResponse 在 RestKit 调用完成后执行，然而，即使通过 PhoneGap / Cordova 回调行执行，javascript 中相应的完成例程也不会执行。就好像回调消失了。我们是否在上下文或我们如何编写 RestKit 或 PhoneGap 异步逻辑时做错了什么？

任何帮助将不胜感激。

```
-(void)GetRestJson:(NSMutableArray*)arguments withDict:(NSMutableDictionary*)options
{
    NSString* callbackID = [arguments pop];
    NSLog(@"%@",callbackID);
    NSString* url = [arguments objectAtIndex:0];
    NSString* sublocation = [arguments objectAtIndex:1];
    NSDictionary * args = [NSDictionary dictionaryWithObjectsAndKeys:
                           callbackID, @"callBackID",
                           self, @"thisObject",                           
                           nil];
    RKClient* client = [RKClient clientWithBaseURL:[RKURL URLWithString:url]];

// <---- RESTKIT CALL MADE (WORKS)
    [client get:sublocation usingBlock:^(RKRequest* loader)
     {
         loader.onDidLoadResponse = ^(RKResponse *response)     // <---- RESTKIT COMPLETION CALLED (WORKS)
         {
             NSString* result = [response bodyAsString];
             NSString * callbackID = [args objectForKey:@"callBackID"];
             id callingObject = [args objectForKey:@"thisObject"];

             CDVPluginResult* pluginResult = [CDVPluginResult resultWithStatus:CDVCommandStatus_OK
                                                               messageAsString: [result stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
             [callingObject writeJavascript: [pluginResult toSuccessCallbackString:callbackID]];  // <---- PHONEGAP CALLBACK MADE (BROKEN --- DOESN'T ARRIVE BACK ON JS CALLBACK)

         };

         loader.onDidFailLoadWithError = ^(NSError *error)
         {
             NSString* result = [error description];
             NSLog(@"Loaded payload: %@", result);
             NSString * callbackID = [args objectForKey:@"callBackID"];
             id callingObject = [args objectForKey:@"thisObject"];
             CDVPluginResult* pluginResult = [CDVPluginResult resultWithStatus:CDVCommandStatus_OK
                                                               messageAsString: [result stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
             [callingObject writeJavascript: [pluginResult toErrorCallbackString:callbackID]];
         };
     }];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-31T00:28:57.143

两个晦涩的错误阻止了 RestKit 完成函数的执行：

**问题 #1 - PhoneGap 2.0.0 / Cordova 2.0.0 在异步回调逻辑中有一个错误**

PhoneGap 回调逻辑有一个错误，它可以触发来自不同上下文的不相关调用的回调函数。当从 Javascript 进行调用时，PhoneGap 会生成一个新的 callbackId，将其添加到 cordova.callbacks 数组中，并将其传递给本机代码。一段时间后，当原生代码完成请求时，它会注入 javascript 来调用 callbackSuccess 或 callbackError 函数。相应的回调处理程序从 cordova.callbacks 数组中查找回调属性并执行原始调用者的完成函数。问题是每个页面，或页面的重新加载，将 callbackId 计数器重置为零，并且新调用最终会重用相同的 callbackId，即使本机代码尚未完成先前的请求。这可能发生在新页面加载或锚标记中的空 href 重新加载时。

**解决方案：**将递增的 callbackId 替换为唯一标识符，以确保仅调用调用者的完成逻辑。我已经使用 Pseudo-GUID 生成器完成了这项工作。修复概述如下：

在 cordova.2.0.0.js 和 cordova.ios.js 中替换这条线

```
callbackId = service + cordova.callbackId++;    // BUG: incrementing callbackId's can call unrelated callback logic 
```

有了这条线

```
callbackId = service + ":" + 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {var r = Math.random()*16|0,v=c=='x'?r:r&0x3|0x8;return v.toString(16);}); // Generate unique callbackID with Pseudo-GUID 
```

**问题 #2 - 由于带有空 href 的锚点而重新加载页面**

调用页面使用带有空 href="" 的锚标记，这会导致当前页面重新加载并 $(document).ready 再次触发。重新加载会重置 cordova.callbackId 计数器和 cordova.callbacks 数组。新触发的 .ready 函数对本机代码进行新的调用，并重用相同的 callbackId，它们已在使用中，但仍从本机代码中的前一个页面实例挂起。当 RestKit 调用完成时，PhoneGap/Cordova 将 callbackId 触发到现在重复的无关逻辑条目。

**解决方案：**修复上面概述的 callbackId 逻辑可防止执行不相关的回调逻辑。解决方案的第二部分是从锚标记中删除 href 或仅在 div 元素中使用 onclick 以防止页面重新加载或导航到重用 callbackIds 的新页面。

# python - 如何使用python从视频中提取幻灯片

> ID：12100072
> 
> 赞同：9
> 
> 时间：2012-08-23T21:15:25.467
> 
> 标签：python, video, image-processing, video-capture, video-processing

我有一个以 AVI 文件形式提供的视频培训课程。大多数屏幕显示为幻灯片，鼠标指针在其上移动。

我想在屏幕变化时自动捕获幻灯片的屏幕截图（忽略由于鼠标指针四处移动而导致图像发生少量变化时。）

我想这样做，以便我可以将图像粘贴到一个 word 或 html 文档中，我可以在学习时添加注释，因为我正在截屏，但它非常缓慢和乏味，而且课程很长（大约 24小时总播放时间）。

我很了解python，但不确定如何从视频文件中提取静止图像，然后如何将一个静止图像与另一个静止图像进行比较，看看它们有多大差异，以决定保留哪些和丢弃哪些。

任何人都可以建议如何去做吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T21:30:59.487

像[ffmpeg](http://ffmpeg.org/)这样的工具适合从视频中提取图像。从手册：

```
 ffmpeg -i foo.avi -r 1 -s WxH -f image2 foo-%03d.jpeg 
```

这将从视频中每秒提取一个视频帧，并将它们输出到名为`foo-001.jpeg`、`foo-002.jpeg`等的文件中。图像将重新缩放以适应新的 WxH 值。

然后可以通过[PIL](http://www.pythonware.com/products/pil/)和/或[OpenCV](http://opencv.willowgarage.com/wiki/)来比较它们的差异。

**编辑：**我刚刚意识到只抓取[关键帧](http://en.wikipedia.org/wiki/Key_frame#Video_compression)（帧内）可能会更有效，因为当场景发生剧烈变化时会发生这些。稍后快速谷歌我们有这个：

```
ffmpeg -i foo.avi -vsync 0 -vf select="eq(pict_type\,PICT_TYPE_I)" -s WxH -f image2 foo-%03d.jpeg 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T21:50:47.727

你基本上想要的是场景检测。[framedifferenceanalyzer](http://code.google.com/p/framedifferenceanalyzer/)是 Python 中的一个教育性概念证明，它正是这样做的，并且应该为了解问题本身提供一个良好的起点。

至于自己实现它，[ffmpeg](http://ffmpeg.org/)是将视频转换为帧序列的理想工具——我可能不会尝试在纯 Python 中做这部分。

为了计算帧之间的差异，您可以使用 ImageMagick（特别是它的[比较](http://www.imagemagick.org/script/compare.php)工具）。ImageMagick 有几个 Python 绑定，例如[PythonMagick](http://www.imagemagick.org/download/python/)或[magickwand](http://pypi.python.org/pypi/magickwand)仅举两个。

您还可以使用[OpenCV](http://opencv.org/)进行图像分析。OpenCV 是一个高性能、高质量的计算机视觉算法库，并且可能是执行此类操作的最强大的工具之一。但是，它假设您对计算机视觉/图像处理有一定的了解，并且已经对您正在寻找的内容有一个很好的了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-17T17:21:12.693

从视频演示中提取幻灯片/帧有几个原因，尤其是在教育或会议相关视频的情况下。它使您无需观看整个视频即可访问学习笔记。

我已经多次遇到这个问题，所以我决定自己使用 python 为它创建一个解决方案。我已将代码开源，您可以轻松设置此工具并通过几个简单的步骤运行它。

[有关youtube 视频教程](https://youtu.be/Q0BIPYLoSBs)，请参阅此内容。有关如何使用此工具的步骤。

*   克隆[这个项目](https://github.com/kaushikj/video2pdfslides)
*   通过运行“pip install -r requirements.txt”设置您的环境
*   复制您的视频路径
*   运行“python video2pdfslides.py <video_path>”

繁荣！pdf 幻灯片将在输出文件夹中提供 做笔记并享受！

# c# - 用于水晶报表的 Linq2sql 连接字符串。报告需要登录

> ID：12100076
> 
> 赞同：1
> 
> 时间：2012-08-23T21:15:41.277
> 
> 标签：c#, winforms, c#-4.0, linq-to-sql, crystal-reports

如果我取出连接字符串信息，报告在我的机器上运行良好，但它要求任何其他用户提供登录信息，所以我正在尝试添加连接信息。未编译的行是`cr1.SetDatabaseLogon(connection, cr1);`

我究竟做错了什么？任何帮助，将不胜感激！

```
private void launchReport(int pKReport)
{
    using (DataClasses1DataContext db = new DataClasses1DataContext())
    {
        var query = (from s in db.expenseHdrs
                     join d in db.expenseDtls on s.rptNo equals d.rptNo
                     where s.rptNo == pKReport
                     from g in db.employees
                     join r in db.expenseHdrs on g.pk equals r.empPk
                     select new
                     {
                         s.period,
                         s.description,
                         s.department,
                         s.rptNo,
                         s.reimbursement, g.name, 
                         d.expDate,
                         d.expType,
                         d.expDesc
                     });

        CrystalReport1 cr1 = new CrystalReport1();

        ConnectionInfo connection = new ConnectionInfo();
        connection.DatabaseName = "intranet";
        connection.UserID = "sa";
        connection.Password = "*****";
        cr1.SetDatabaseLogon(connection, cr1);

        cr1.SetDataSource(query);
        crystalReportViewer1.ReportSource = cr1;
    }
} 
```

我还尝试在查询后将代码更改为下面，但是当我没有连接字符串凭据时，我仍然遇到与以前完全相同的问题。在除我自己以外的每个用户上，我都会得到相同的 sql server 登录屏幕，无论我输入什么，它都会失败。我认为这是因为没有数据库名称，它不允许我手动输入。

```
 CrystalReport1 cr1 = new CrystalReport1();
            cr1.FileName = @"C:\Intranet\CrystalReport1.rpt";

            ConnectionInfo connectionInfo = new ConnectionInfo();
            connectionInfo.ServerName = "svr-sql";
            connectionInfo.DatabaseName = "intranet";
            connectionInfo.UserID = "sa";
            connectionInfo.Password = "*****";

            SetDBLogonForReport(connectionInfo, cr1);
            cr1.SetDataSource(query);
            crystalReportViewer1.ReportSource = cr1;
        }
    }

private void SetDBLogonForReport(ConnectionInfo connectionInfo, CrystalReport reportDocument)
    {
        Tables tables = reportDocument.Database.Tables;
        foreach (CrystalDecisions.CrystalReports.Engine.Table table in tables)
        {
            TableLogOnInfo tableLogonInfo = table.LogOnInfo;
            tableLogonInfo.ConnectionInfo = connectionInfo;
            table.ApplyLogOnInfo(tableLogonInfo);
        }
    } 
```

![在此处输入图像描述](../Images/9bbb3ac864e178258e0fd51901465ae1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T05:00:41.947

```
CrystalReport1 cr1 = new CrystalReport1();
    cr1.FileName = @"C:\Intranet\CrystalReport1.rpt";

    ConnectionInfo connectionInfo = new ConnectionInfo();
    connectionInfo.ServerName = "svr-sql";
    connectionInfo.DatabaseName = "intranet";
    connectionInfo.UserID = "sa";
    connectionInfo.Password = "*****";

    //add this code 

    connectionInfo.IntegratedSecurity = false;

......................... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T14:50:52.620

使用直接的 sql 数据源是问题所在。我必须将其更改为 OLE DB(ADO) 才能让 sql server 正常工作。哦，水晶报告……

# objective-c - 如何在其他方法中调用和返回数组数据

> ID：12100084
> 
> 赞同：0
> 
> 时间：2012-08-23T21:16:04.817
> 
> 标签：objective-c, arrays, nsmutablearray

我有以下方法，我想调用它并以另一种方法返回数组数据，但这不起作用。但是其他方法中的 self 不返回数据？

```
- (NSMutableArray *)glo
{
    NSMutableArray *globalarray = [[NSMutableArray array]init];
    for (int x = 0; x < 10; x++) {
        [globalarray addObject: [NSNumber numberWithInt: arc4random()%200]];
        return globalarray ;
    }
}

-(IBAction)clicked_insertsort:(id)sender{
    [self glo];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:29:00.763

我真的尝试将代码中的某些部分替换为如下内容：

```
- (NSMutableArray *)glo
{
    NSMutableArray *globalarray = [[NSMutableArray array] init];
    for (int x = 0; x < 10; x++) {
        [globalarray addObject:[NSNumber numberWithInt: arc4random()%200]];
    }
    return globalarray; // pull out from the loop
} 
```

还有这个：

```
-(IBAction)clicked_insertsort:(id)sender{
    NSMutableArray *array = [self glo]; // take care of the return value
    NSLog(@"array : %@", array)
} 
```

* * *

**更新：**

如果你想在你的类中有一个全局变量，你应该定义以下内容：

```
@interface YourClass : NSObject {
    NSMutableArray *globalarray;
}

// ...

@end 
```

并且方法如下（不需要返回值，因为现在整个类都可以使用该变量）

```
- (void)glo {
    if (!globalarray) {
        globalarray = [NSMutableArray array];
        for (int x = 0; x < 10; x++) {
            [globalarray addObject:[NSNumber numberWithInt: arc4random()%200]];
        }
    }            
} 
```

# javascript - 如何防止 iFrame 警报框

> ID：12100085
> 
> 赞同：0
> 
> 时间：2012-08-23T21:16:07.197
> 
> 标签：javascript, html, dom, iframe

即使 iFrame 中的域不是我的，有没有办法阻止 iFrame 中的警报框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:25:36.990

不，没有。由于安全原因，如果 iframe 源来自另一个域，则您无法控制 iframe 中的任何内容。

# matlab - matlab图形中的数据提示自定义

> ID：12100086
> 
> 赞同：4
> 
> 时间：2012-08-23T21:16:10.677
> 
> 标签：matlab, matlab-figure

我有一个带有多个图的图表，每个图都来自不同的源文件。我希望数据提示告诉我 (X,Y) 加上源文件的名称。这么久我最好的尝试（没有成功）是这样的：

```
dcm = datacursormode(gcf);
datacursormode on;
set(dcm,'UpdateFcn',[@myfunction,{SourceFileName}]); 
```

其中*myfunction*是在这种情况下使用的默认函数，粘贴在此消息的末尾并在此处解释：http: [//blogs.mathworks.com/videos/2011/10/19/tutorial-how-to-make- a-custom-data-tip-in-matlab/](http://blogs.mathworks.com/videos/2011/10/19/tutorial-how-to-make-a-custom-data-tip-in-matlab/) 最后，SourceFileName 是一个带有源文件名称的字符串。

有人知道更简单（或正确）的方法吗？

提前致谢。

```
function output_txt = myfunction(~,event_obj)
% Display the position of the data cursor
% obj          Currently not used (empty)
% event_obj    Handle to event object
% output_txt   Data cursor text string (string or cell array of strings).

pos = get(event_obj,'Position');
output_txt = {['X: ',num2str(pos(1),4)],...
    ['Y: ',num2str(pos(2),4)]};

% If there is a Z-coordinate in the position, display it as well
if length(pos) > 2
    output_txt{end+1} = ['Z: ',num2str(pos(3),4)];
end

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T16:14:17.943

```
p=plot( x,y);
setappdata(p,'sourceFile_whatever', SourceFileName)  

dcm = datacursormode(gcf);
datacursormode on;
set(dcm, 'updatefcn', @myfunction) 
```

在回调函数中：

```
function output_txt = myfunction( obj,event_obj)
% Display the position of the data cursor
% obj          Currently not used (empty)
% event_obj    Handle to event object
% output_txt   Data cursor text string (string or cell array of strings).
% event_obj

dataIndex = get(event_obj,'DataIndex');
pos = get(event_obj,'Position');

output_txt = {[ 'X: ',num2str(pos(1),4)],...
    ['Y: ',num2str(pos(2),4)]};

try
    p=get(event_obj,'Target');
    output_txt{end+1} = ['SourceFileName: ',getappdata(p,'sourceFile_whatever')];
end

% If there is a Z-coordinate in the position, display it as well
if length(pos) > 2
    output_txt{end+1} = ['Z: ',num2str(pos(3),4)];
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-12T17:16:03.600

我玩游戏有点晚了，但我想我会回答，以防有人遇到这个问题并且仍然觉得它有用。

改变

```
set(dcm,'UpdateFcn',[@myfunction,{SourceFileName}]); 
```

至

```
set(dcm,'UpdateFcn',{@myfunction,SourceFileName}); 
```

然后可以将回调函数更改为如下所示。（注意：我删除了 Z 坐标，因为问题只提到了 X 和 Y。）

```
function output_txt = myfunction(~,event_obj,filename)
% Display the position of the data cursor
% obj          Currently not used (empty)
% event_obj    Handle to event object
% filename     Name of the source file (string)
% output_txt   Data cursor text string (string or cell array of strings).

pos = get(event_obj,'Position');
output_txt = {['X: ',num2str(pos(1),4)],...
    ['Y: ',num2str(pos(2),4)],...
    ['Source: ',filename]};

end 
```

显然，如果您希望字符串采用不同的格式，您可以使用回调函数中的格式做任何您想做的事情。

您只需更改其函数签名并更新`set(dcm,...`行以匹配即可向回调函数添加任意数量的参数（附加参数位于 . 内`{}`，以逗号分隔）。这适用于 R2013a（我稍后假设），但我没有在任何早期版本上尝试过。

编辑：回调函数可能还需要在与使用它的代码相同的文件中定义。

# java - 如何在 Java 中阅读“echo a | java Class”

> ID：12100088
> 
> 赞同：4
> 
> 时间：2012-08-23T21:16:18.187
> 
> 标签：java, system

我需要以某种方式阅读“echo a | java Class”。我试过

```
public class Class 
{
    public static void main(String[] args)
    {
        System.out.println(args[0]);
    }
} 
```

但它不起作用。我找不到任何其他解决方案。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:18:29.073

从 中读取[**`stdin`**](http://en.wikipedia.org/wiki/Standard_streams#Standard_input_.28stdin.29)，例如，使用[`Scanner`](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)：

```
Scanner scanner = new Scanner(System.in);
String a = scanner.next(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T21:23:09.297

如果必须使用`echo a | java Class`，则需要使用[@João](https://stackoverflow.com/a/12100117/758280)的答案之类的东西。

但是，如果您可以更改命令并且想要使用`args`，则需要使用[`xargs`](http://en.wikipedia.org/wiki/Xargs)：

```
echo a | xargs java Class 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:25:25.453

您可以使用：

```
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

String line;
while ((line = br.readLine()) != null) {
    System.out.println(line);
} 
```

要使用：

```
echo Hello | java InputTest 
```

# git - 为什么当我从 ssh 和 http git clone 时得到不同的结果？

> ID：12100089
> 
> 赞同：0
> 
> 时间：2012-08-23T21:16:20.823
> 
> 标签：git, http, ssh

我得到了一个直接使用 Apache 提供的裸存储库：

```
http://gordon.re/files/t++.git/ 
```

如果我使用 SSH 克隆它：

```
git clone ssh://user/home/user/www/files/t++.git 
```

我得到了最后一个版本（从今天开始）。

如果我使用 HTTP 克隆它：

```
 git clone https://gordon.re/files/t++.git 
```

我从 6 月 6 日收到了一个版本。

为什么，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:19:35.800

在服务器上的存储库中进行操作是否有帮助`git update-server-info`？愚蠢的 HTTP 传输方法需要一些额外的文件才能工作，并且这些文件必须保持最新：示例挂钩之一就是这样做的（我认为是更新后）。

# mysql - 如何在sql中删除字符串

> ID：12100091
> 
> 赞同：0
> 
> 时间：2012-08-23T21:16:27.140
> 
> 标签：mysql, sql

在 MySQL 中，我有一个“Student”表，其中包含一个“StudnetId”列，如下所示：

```
StudentId

S1
S4
S3
S5
S1
S2
S3 
```

使用 SQL，如何根据字符的索引删除字符。

具体来说，我需要在更新表格时删除此列中每一行的“S”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:19:49.297

这将删除该列中每一行的第一个字符。

```
UPDATE Student SET StudentId = SUBSTR(StudentId, 2); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T21:21:40.607

见[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)

```
UPDATE Student SET StudentId = REPLACE(StudentId, 'S', '') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:26:44.057

如果您只想显示不影响 db 中的行，请在下面使用；

```
SELECT REPLACE(StudentId, 'S', '') FROM Student; 
```

如果要更新数据库：

```
UPDATE Student SET StudentId = REPLACE(StudentId, 'S', ''); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:24:31.990

您不能真正从存储在列中的值中删除字符。您必须为该列分配一个全新的值，该值可以使用引用当前存储值的表达式派生。

下面是一个语句示例，该语句将从 StudentId 列中“删除”前导“S”字符：

```
UPDATE `Student`
   SET `StudentId` 
        = IF(SUBSTR(`StudentId`,1,1)='S',SUBSTR(`StudentId`,2),`StudentId`) 
```

请注意，如果 StudentId 的第一个字符不是“S”，则该值不会更改。同样，此语句将获得相同的结果：

```
UPDATE `Student`
   SET `StudentId` = SUBSTR(`StudentId`,2)
 WHERE SUBSTR(`StudentId`,1,1)='S' 
```

其他解决方案（不检查第一个字符是否为“S”）将获得相同的结果，给定数据的特定条件（例如，如果我们可以保证每个值的第一个字符是“S”。使用一个`REPLACE`函数处理前导字符不是“S”的情况，但它可能会删除比前导“S”更多的内容（如果我们没有某种保证字符“S”不会出现在除第一个位置外的任何值。）

# html - Dart 中如何有效处理浏览器历史记录（即后退按钮）？

> ID：12100098
> 
> 赞同：6
> 
> 时间：2012-08-23T21:16:54.363
> 
> 标签：html, browser, browser-history, dart

在 Dart 的标准库中是否有任何工具可以帮助处理状态和后退按钮？或者我是否需要模拟 Javascript 解决方案来实现通过 Web 应用程序状态的导航？

我打算将此应用于个人项目，因此浏览器兼容性不是问题（即仅 HTML5 的解决方案就可以了）。

非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T19:50:58.520

HTML5 定义了用于操作历史的新 API，让您无需重新加载窗口即可更改位置。有一篇关于 Dive Into HTML5 的精彩文章展示了如何使用 history API 在单页应用程序中模拟多页导航。它很容易翻译成 Dart。

这是文章： [http ://diveintohtml5.info/history.html](http://diveintohtml5.info/history.html)

这是历史的 Dart 文档：http: [//api.dartlang.org/docs/continuous/dart_html/History.html](http://api.dartlang.org/docs/continuous/dart_html/History.html)

在带有导航的单页应用程序中，我通常设置客户端代码的方式类似于在服务器上设置 RoR 或 Django 应用程序或 Dart http 服务器的方式：

1.  定义一组匹配窗口位置的匹配器
2.  将匹配器映射到显示虚拟页面或其他位置的函数

然后使其成为无缝体验：

3.  为所有锚点添加一个 href 以添加书签，但添加一个 onclick 处理程序以调用推送历史状态的函数，并添加 preventDefault 以防止重新加载。
4.  在初始页面加载时，读取 URL 并将其发送到 (2) 中的地图

样本：

```
main() {
  // handle the back button
  window.on.popState.add((_) => showPage());
}

showPage() {
  String path = window.location.pathname;
  if (path == '/') {
    showFrontPage();
  } else if (DETAIL_PAGE_URL.hasMatch(path)) {
    String id = DETAIL_PAGE_URL.firstMatch(path).group(1);
    showDetailPage(i);
  }
}

showFrontPage() {
  //... code to build a link to a detail page
  detailAnchor.on.click.add((MouseEvent e) {
    window.history.pushState(null, detail.title, detail.url);
    e.preventDefault();
    showDetailPage(detail);
  }, false);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:57:03.460

就像 javascript 一样，您可以轻松地在 url 中获取哈希锚点

```
var hash = window.location.hash; 
```

哈希值与您的操作之间的关联。

# php - 读取文件并获取特定内容并回显它们（php）

> ID：12100101
> 
> 赞同：0
> 
> 时间：2012-08-23T21:17:09.443
> 
> 标签：php, file-io

我有一个文件（passwords_admin.txt），其中包含如下信息：

```
# This file is for storing administrative
# .passwords_user in the same directory.
#
# NOTE (Important):
# format: <server type> <keyword>[,<keyword>...] <server name> <login name> <password>      
[<location> [<host> <port>] ]
# The first entry for a given server will be the default user.
# Current keywords:
# livepw - The password change script will change the sa password on this server to the 
new live password
# devpw - The password change script will change the sa password on this server to the 
new dev password
## mysql servers
##
# Do not remove the next line
# ----------- MySQL Instances start here ----------
mysql 1515,dev,devpw,online,ldap_pwd dev-exodus-01 dba_admin B66AF9 166.77.177.241 3306
mysql 1515,dev,devpw,online,ldap_pwd dev-exodus-01 dba_query 83939E 166.77.177.241 3306
mysql 1515,dev,devpw,online,ldap_pwd qa-exodus-01 dba_admin B66AF9 166.77.189.125 3306
mysql 1515,dev,devpw,online,ldap_pwd qa-exodus-01 dba_query 583939E 166.77.189.125 3306
...
... 
```

数据以这种格式存储：`format: <server type> <keyword>[,<keyword>...] <server name> <login name> <password> [<location> [<host> <port>] ]`

现在，我想复制和打印特定实例的主机名和关键字（devpw 或 livepw）。

例如，例如 dev-exodus-01。我想打印它的主机名 166.77.177.241 和它的关键字`devpw`。或者有什么方法可以将这些值存储在变量中，以后可以使用它们？

我试过这个，但显然它不起作用。

```
$file = fopen("passwords_admin.txt", "r");
if (!$file) {
    echo "<p>Unable to open remote file.\n";
    exit;
}
while (!feof($file)) {
    $line = fgets($file, 1024);

    if (preg_match("@devpw(.*)@i", $line, $out)) {
        $title = $out[1];
        echo $title;
        echo "<br/>";
    }
} 
```

有什么建议么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:31:22.720

这应该为您指明正确的方向：

```
if (preg_match("@devpw(.*)@i", $line)) {
    $data = explode (" ", $line);
    $keywords = $data[1];
    $hostname = $data[5];
} 
```

它根据您的格式将行拆分为一个数组。`$hostname`设置为第六个条目，并且在`$keywords`第二个条目中。

您需要做一些类似的事情`$keywords`来获取各个关键字，并且您需要找出一种方法，既可以从您想要的配置文件中找到一行，也可以存储多行数据 - 一个数组关联数组可能会起作用。

# java - Android 开发：如何在其中集成线程？

> ID：12100102
> 
> 赞同：2
> 
> 时间：2012-08-23T21:17:10.533
> 
> 标签：java, android, multithreading

所以我试图通过从 youtube 频道检索 json 数据来制作一个 youtube 应用程序。问题是我很擅长编写单线程应用程序。但是当谈到多线程时，我总是失去洞察力。

我还没有在学校学过，大多数教程都是垃圾，或者至少我发现了。

所以我想要做的是在我的“GetVideos”类中引入一个线程，这样它就不会在检索视频时减慢我的应用程序的速度。我知道我必须使用处理程序和线程，但每次我尝试使用它们时，我的应用程序都会崩溃。你们能帮忙吗？

```
public class GetVideos { //class that retrieves JSON data based on youtube username

private String channelName;
private HttpClient client; //client that gets info
private VideoLibrary lib;

public GetVideos(String channelName) {
    this.channelName = channelName;
    client = new DefaultHttpClient();
    lib = new VideoLibrary();
    fillData();
}

private void fillData() {
    try {
        final String URL = "http://gdata.youtube.com/feeds/api/users/" + channelName + "/uploads?v=2&alt=jsonc";
        HttpGet get = new HttpGet(URL);
        HttpResponse response = client.execute(get);
        String jsonString = EntityUtils.toString(response.getEntity());
        JSONObject json = new JSONObject(jsonString);
        JSONArray jsonArray = json.getJSONObject("data").getJSONArray("items");
        for (int i = 0; i < jsonArray.length(); i++) {
            JSONObject items = jsonArray.getJSONObject(i);
            String title = items.getString("title");
            String thumbUrl = items.getJSONObject("thumbnail").getString("sqDefault");
            String url = items.getJSONObject("player").getString("default");
            lib.addVideo(new Video(title, url, thumbUrl));

        }

    } catch (JSONException e) {
        e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
    } catch (ClientProtocolException e) {
        e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
    } catch (IOException e) {
        e.printStackTrace();  
       }
   }

    public VideoLibrary getLib() {
         return lib;
    } 
 }

public class SxePhil extends Activity { //class that makes up the interactive end of
//the app, here the JSON data is put in a list 
private ListView list;
private GetVideos g;
private VideoLibrary videoLibrary;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.sxephil);
    list = (ListView) findViewById(R.id.sxephilList);
    g = new GetVideos("sxephil");
    videoLibrary = g.getLib();

    ArrayList<String> titles = new ArrayList<String>();
    for (int i = 0; i < 25; i++) {
        titles.add(videoLibrary.getVideos().get(i).getTitle());
    }

       ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.simplerow, titles);
        list.setAdapter(adapter);
   }  
} 
```

基本上我尝试的是实现这里使用的线程：http: [//blog.blundell-apps.com/show-youtube-user-videos-in-a-listview/](http://blog.blundell-apps.com/show-youtube-user-videos-in-a-listview/)

在我的代码中，因为这个项目是建立在一个较旧的 sdk 上的，所以我想对其进行现代化改造。看看 GetYoutube*** 类和 MainActivity 类，这就是钱的所在

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:50:38.273

您可以使用 AsyncTask 最轻松地完成此操作。看看这个教程。

[http://android-developers.blogspot.com/2009/05/painless-threading.html](http://android-developers.blogspot.com/2009/05/painless-threading.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:41:53.233

您应该使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)甚至更好的[Loader](http://developer.android.com/guide/components/loaders.html)，它们会自动为您处理踏板

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:43:16.287

第一：基本建议（您必须记住并遵循）

*   永远不要在类构造函数中进行处理（这是糟糕的 OO 设计，恕我直言）
*   永远不要在 Activity.onCreate 方法**中**留下耗时的过程（一般来说，在 UI 线程运行的任何方法中，即 onResume()、onClick()、...）

mario 和 runor49 是对的：您应该在这里使用 AsyncTask （并且您必须阅读并理解[http://developer.android.com/guide/components/processes-and-threads.html#WorkerThreads](http://developer.android.com/guide/components/processes-and-threads.html#WorkerThreads)。如果您不这样做，请阅读又来了……）

基本上，您应该执行以下操作：

1.  onCreate 必须启动一个单独的线程，该线程将包含“长”处理（从网络加载数据）
2.  完成后，该线程必须调用 Activity.runOnUiThread(Runnable)，其中 runnable 将创建 Adapter 并将其分配给 ListView。

这是一个代码示例：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    ...
    loadDataInThread();
    }

private void loadDataInThread() {
    new Runnable() {            
        @Override
        public void run() {
            // LOAD DATA FROM NETWORK
            displayDataInUIThread(datas);
            }
        }.start();
    }       

private void displayDataInUIThread(final VideoLibrary data) {
    runOnUiThread(new Runnable() {
        @Override
        public void run() {
            ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.simplerow, data);
            list.setAdapter(adapter);
        }
    });
} 
```

这是一种非常基本（且粗鲁）的方式，AsyncTask方式（）方式会好得多，但它应该可以工作并履行合同......

# spring-mvc - Spring MVC 将 id 绑定到模型中的对象

> ID：12100107
> 
> 赞同：0
> 
> 时间：2012-08-23T21:17:37.500
> 
> 标签：spring-mvc, binding

代码如下所示：

传感器类：

```
@Entity
@Table(name = "sensor")
public class Sensor {

@Id
@Column(name = "id")
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Integer id;

@ManyToOne
private SensorType sensorType;

@NotEmpty
@Size(min = 3, max = 255)
@Column(name = "name")
private String name;
    ......
} 
```

传感器类型：

```
@Entity
@Table(name = "sensortype")
public class SensorType {

@Id
@Column(name = "id")
@GeneratedValue(strategy = GenerationType.IDENTITY)
private Integer id;

@Column(name = "type")
private String type;
    ......
} 
```

当我尝试插入新传感器时出现错误，SensorType 为空，因为我只是从 jsp 向 SensorController 发送 SensorType“id”，而控制器需要一个 SensorType 对象。

传感器控制器：

```
@Controller
public class SensorController {

@Autowired
private ISensor sensorService;

@RequestMapping(value = "/sensor/add", method = RequestMethod.POST)
public String add(Sensor sensor, BindingResult result, Model model) {

     if (result.hasErrors()) {
                return "sensorAdd";
             }       

     sensorService.insert(sensor);
     return "redirect:/sensors";
  }
} 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:54:02.977

解决这个问题的典型方法是指定一个转换器，这样：

```
public class IdToSensorTypeConveter implements Converter<Integer, SensorType>{
    ...
    @Override
    public SensorType convert(Integer id) {
        return this.sensorTypeDao.findById(id);
    }

} 
```

使用 Spring 注册此转换器：

```
<bean id="conversionService" class="org.springframework.format.support.FormattingConversionServiceFactoryBean">
    <property name="converters">
        <set>
            <bean class="IdToSensorTypeConveter"/>
        </set>
    </property>
</bean>

<mvc:annotation-driven conversion-service="conversionService"/> 
```

现在，如果您提交的表单在传感器字段中有一个 sensorType 字段，它将自动绑定到上述转换器返回的 sensorType。

# c++ - 从向量中删除对象

> ID：12100109
> 
> 赞同：-1
> 
> 时间：2012-08-23T21:17:47.757
> 
> 标签：c++, multithreading, vector, this, delete-operator

步骤 1\. 创建一个类的实例

步骤 2\. 将此实例推送到向量

Step 3\. 调用`delete this;`实例的成员方法

第 4 步。一切正常

步骤 5\. 将一些东西推到向量上并得到这个

```
*** glibc detected *** ./app: double free or corruption (fasttop): 0x0000000001017930 ***
======= Backtrace: =========
/lib/libc.so.6(+0x71bd6)[0x7f607d60cbd6]
/lib/libc.so.6(cfree+0x6c)[0x7f607d61194c]
./app[0x40231c]
./app[0x402290]
./app[0x4053c0]
./app[0x4048fe]
./app[0x404246]
./app[0x403fe0]
./app[0x402400]
./app[0x4035cb]
./app[0x4034d3]
/lib/libpthread.so.0(+0x68ca)[0x7f607e2b78ca]
/lib/libc.so.6(clone+0x6d)[0x7f607d66a92d]
======= Memory map: ========
00400000-0040f000 r-xp 00000000 09:03 60427370                           /root/AHS/app
0060e000-0060f000 rw-p 0000e000 09:03 60427370                           /root/AHS/app
01017000-01038000 rw-p 00000000 00:00 0                                  [heap]
7f6074000000-7f6074021000 rw-p 00000000 00:00 0
7f6074021000-7f6078000000 ---p 00000000 00:00 0
7f607a595000-7f607a596000 ---p 00000000 00:00 0
7f607a596000-7f607ad96000 rw-p 00000000 00:00 0
7f607ad96000-7f607ad97000 ---p 00000000 00:00 0
7f607ad97000-7f607b597000 rw-p 00000000 00:00 0
7f607b597000-7f607b598000 ---p 00000000 00:00 0
7f607b598000-7f607bd98000 rw-p 00000000 00:00 0
7f607bd98000-7f607bd99000 ---p 00000000 00:00 0
7f607bd99000-7f607c599000 rw-p 00000000 00:00 0
7f607c599000-7f607c59a000 ---p 00000000 00:00 0
7f607c59a000-7f607cd9a000 rw-p 00000000 00:00 0
7f607cd9a000-7f607cd9b000 ---p 00000000 00:00 0
7f607cd9b000-7f607d59b000 rw-p 00000000 00:00 0
7f607d59b000-7f607d6f4000 r-xp 00000000 09:03 60425052                   /lib/libc-2.11.3.so
7f607d6f4000-7f607d8f3000 ---p 00159000 09:03 60425052                   /lib/libc-2.11.3.so
7f607d8f3000-7f607d8f7000 r--p 00158000 09:03 60425052                   /lib/libc-2.11.3.so
7f607d8f7000-7f607d8f8000 rw-p 0015c000 09:03 60425052                   /lib/libc-2.11.3.so
7f607d8f8000-7f607d8fd000 rw-p 00000000 00:00 0
7f607d8fd000-7f607d913000 r-xp 00000000 09:03 60425245                   /lib/libgcc_s.so.1
7f607d913000-7f607db12000 ---p 00016000 09:03 60425245                   /lib/libgcc_s.so.1
7f607db12000-7f607db13000 rw-p 00015000 09:03 60425245                   /lib/libgcc_s.so.1
7f607db13000-7f607db93000 r-xp 00000000 09:03 60425438                   /lib/libm-2.11.3.so
7f607db93000-7f607dd93000 ---p 00080000 09:03 60425438                   /lib/libm-2.11.3.so
7f607dd93000-7f607dd94000 r--p 00080000 09:03 60425438                   /lib/libm-2.11.3.so
7f607dd94000-7f607dd95000 rw-p 00081000 09:03 60425438                   /lib/libm-2.11.3.so
7f607dd95000-7f607de8b000 r-xp 00000000 09:03 60032880                   /usr/lib/libstdc++.so.6.0.13
7f607de8b000-7f607e08b000 ---p 000f6000 09:03 60032880                   /usr/lib/libstdc++.so.6.0.13
7f607e08b000-7f607e092000 r--p 000f6000 09:03 60032880                   /usr/lib/libstdc++.so.6.0.13
7f607e092000-7f607e094000 rw-p 000fd000 09:03 60032880                   /usr/lib/libstdc++.so.6.0.13
7f607e094000-7f607e0a9000 rw-p 00000000 00:00 0
7f607e0a9000-7f607e0b0000 r-xp 00000000 09:03 60425177                   /lib/librt-2.11.3.so
7f607e0b0000-7f607e2af000 ---p 00007000 09:03 60425177                   /lib/librt-2.11.3.so
7f607e2af000-7f607e2b0000 r--p 00006000 09:03 60425177                   /lib/librt-2.11.3.so
7f607e2b0000-7f607e2b1000 rw-p 00007000 09:03 60425177                   /lib/librt-2.11.3.so
7f607e2b1000-7f607e2c8000 r-xp 00000000 09:03 60425205                   /lib/libpthread-2.11.3.so
7f607e2c8000-7f607e4c7000 ---p 00017000 09:03 60425205                   /lib/libpthread-2.11.3.so
7f607e4c7000-7f607e4c8000 r--p 00016000 09:03 60425205                   /lib/libpthread-2.11.3.so
7f607e4c8000-7f607e4c9000 rw-p 00017000 09:03 60425205                   /lib/libpthread-2.11.3.so
7f607e4c9000-7f607e4cd000 rw-p 00000000 00:00 0
7f607e4cd000-7f607e4eb000 r-xp 00000000 09:03 60425293                   /lib/ld-2.11.3.so
7f607e6da000-7f607e6df000 rw-p 00000000 00:00 0
7f607e6e7000-7f607e6ea000 rw-p 00000000 00:00 0
7f607e6ea000-7f607e6eb000 r--p 0001d000 09:03 60425293                   /lib/ld-2.11.3.so
7f607e6eb000-7f607e6ec000 rw-p 0001e000 09:03 60425293                   /lib/ld-2.11.3.so
7f607e6ec000-7f607e6ed000 rw-p 00000000 00:00 0
7fff4ee3b000-7fff4ee50000 rw-p 00000000 00:00 0                          [stack]
7fff4efff000-7fff4f000000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
Aborted 
```

有人可以告诉我，这是什么，为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:19:28.340

这是因为你释放了你不拥有的内存。`vector`拥有包含其内容的内存。

`delete this;`就像用完一辆租来的汽车去打捞场一样。不要那样做，租赁公司希望它回来！

注意拥有记忆和仅仅控制它借给你之间的区别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:24:08.310

`delete this`为属于你的对象做`vector`两个大错误：

1.  它是管理存储该实例的内存的向量（它分配它，释放它，......），所以你不应该弄乱它。换句话说，既然你不拥有那段记忆，你就必须不理它。
2.  `delete`如果对象被分配了，则为正确匹配`new`- 但由 管理的对象`vector`不是这样分配的；取而代之的是，`vector`从分配器中获取一块内存（与它认为合理的一样大）并在那里复制使用放置推入其中的元素`new`；因此，您不仅释放了不属于您的内存，而且还使用了错误的方法来释放它。

如果您需要从 a 中删除元素`vector`，只需使用该`vector::erase`方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:26:13.740

如果您`delete this`使用任何方法，您必须确保在该语句之后没有其他人调用实例的任何方法（就此而言，任何代码）。这包括`destructor`.

当您将实例推入向量时，在被销毁时，向量会调用实例的析构函数，因此`double free`

如果您需要一个向量，您可以将指针推送到该实例，这样就可以了。

但是，正如其他人所说，除非绝对必要，否则**不要**使用`delete this`

如果您只是在函数中创建类的本地实例，您也会遇到问题。很可能您没有看到此行为，因为您的程序在局部变量的范围结束之前完成。如果你试过这个：

```
void func() {
    MyClass myClass;
    myClass.theBadFunc();
} 
```

当它返回时，您将有一个核心转储。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T21:37:57.840

这是否类似于您描述的代码？

```
struct MyClass {
    void f() { delete this; }
};

int main() {
    MyClass c;
    std::vector<MyClass> v;
    v.push_back(c);
    c.f();
    return 0;
} 
```

向量无关紧要。问题是`delete this`调用析构函数`c`并释放`c`构建的内存。该内存在堆栈上，无法释放。永远不要删除堆栈对象。当它们超出范围时，编译器生成代码以清理它们，在这种情况下，在`main`.

# c# - 如何在 C:\ 和任何其他驱动器中搜索特定文件类型？我得到异常访问被拒绝

> ID：12100110
> 
> 赞同：0
> 
> 时间：2012-08-23T21:17:47.290
> 
> 标签：c#

> **可能重复：**
> [UnauthorizedAccessException 无法解决 Directory.GetFiles 失败](https://stackoverflow.com/questions/1393178/unauthorizedaccessexception-cannot-resolve-directory-getfiles-failure)

这是我用来搜索文件的函数：

```
public string SearchFor(string fileExtension, DirectoryInfo at)
    {
        string error = null;
        try
        {
            foreach (DirectoryInfo subDir in at.GetDirectories())
            {
                SearchFor(fileExtension, subDir);

                foreach (FileInfo f in at.GetFiles())
                {
                    // test f.name for a match with fileExtension
                    // if it matches...
                    //   yield return f.name;
                    if (f.Name == fileExtension)
                    {
                        return f.Name;
                    }
                    else
                    {
                        error = f.Name;
                    }
                }
            }
        }
        catch (UnauthorizedAccessException) { }
        return error;
    } 
```

我知道在调用函数时要为路径放置什么，但我应该为文件放置什么？如何使用/调用函数？我不知道该放什么文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:30:57.243

一种选择是以管理员身份运行程序。（右键单击并以管理员身份运行）

另一种选择是自定义编码您自己的目录搜索，例如：

```
public IEnumerator SearchFor(string fileExtension, DirectoryInfo at) {
  try {
    foreach (DirectoryInfo subDir in at.GetDirectories()) {
        SearchFor(fileExtension, subDir);

        foreach (FileInfo f in at.GetFiles()) {
            // test f.name for a match with fileExtension
            // if it matches...
            //   yield return f.name;
        }
    }
  } catch (UnauthroizedAccessException) { }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:28:32.737

如果您正在运行该函数的 Windows 帐户没有将目录更改为文件夹的权限，则如果您尝试从代码中访问它，则会出现该异常。您可以使用 try / catch 优雅地处理它并继续搜索，或者您可以尝试在有权进入该目录的帐户下运行。

# jqplot - 如何为 jqplot 条形图设置动画，例如示例

> ID：12100116
> 
> 赞同：0
> 
> 时间：2012-08-23T21:18:16.087
> 
> 标签：jqplot, bar-chart

有没有人有这方面的运气？

**我将此处的确切**示例代码[http://www.jqplot.com/deploy/dist/examples/barTest.html](http://www.jqplot.com/deploy/dist/examples/barTest.html)复制并粘贴到我的文本编辑器中。我添加了所需的所有 .js 文件和 .css 文件。当我在任何浏览器中运行该页面时，我没有看到条形图或动画。我还查看了上述 URL 上的源代码，以了解它是如何工作的。有人能告诉我为什么我可以在 URL 上显示动画条形图，但不能从我的桌面上显示吗？有什么不同？这是我复制的确切代码：

```
<html>
 <title>Untitled Document</title>

<link rel="stylesheet" href="js/jquery.jqplot.min.css" type="text/css" />
<!--[if lt IE 9]><script language="javascript" type="text/javascript" src="js/excanvas.min.js"></script><![endif]-->
<script language="javascript" type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script language="javascript" type="text/javascript" src="js/jquery.jqplot.min.js"></script>
<script language="javascript" type="text/javascript" src="js/excanvas.min.js"></script>
<script language="javascript" type="text/javascript" src="plugins/jqplot.barRenderer.min.js"></script>

<script>

$(document).ready(function(){

        $.jqplot.config.enablePlugins = true;
        var s1 = [2, 6, 7, 10];
        var ticks = ['a', 'b', 'c', 'd'];

        plot1 =  $.jqplot('chart1', [s1], {
            // Only animate if we're not using excanvas (not in IE 7 or IE 8)..
            animate: !$.jqplot.use_excanvas,
            seriesDefaults:{
                renderer:$.jqplot.BarRenderer,
                pointLabels: { show: true }
            },
            axes: {
                xaxis: {
                    renderer: $.jqplot.CategoryAxisRenderer,
                    ticks: ticks
                }
            },
            highlighter: { show: false }
        });

        $('#chart1').bind('jqplotDataClick', 
            function (ev, seriesIndex, pointIndex, data) {
                $('#info1').html('series: '+seriesIndex+', point: '+pointIndex+', data: '+data);
            }
        );
    });
    </script>
</head>

<body>
<div id="chart1" style="margin-top: 20px; margin-left: 20px;width: 300px; height: 300px; position: relative;"></div>

<div><span>Moused Over: </span><span id="info1">Nothing</span></div>
</body>
</html> 
```

这是我在运行该代码后在浏览器中看到的内容：

![在此处输入图像描述](../Images/7b5c14c4c0c745f595117c5a31139376.png)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-27T21:38:00.457

对于任何感兴趣的人，我已经找到了答案。[从我的帖子中的barchart.html 页面](http://www.jqplot.com/deploy/dist/examples/barTest.html#)获取的示例代码似乎不需要条件语法（如下）来为条设置动画：

```
$.jqplot.config.enablePlugins = true;

// Only animate if we're not using excanvas (not in IE 7 or IE 8)..
        animate: !$.jqplot.use_excanvas, 
```

从[示例页面](http://www.jqplot.com/deploy/dist/examples/)上的动画示例中，以下代码可以解决问题：

```
animate: true,
    // Will animate plot on calls to plot1.replot({resetAxes:true})
    animateReplot: true, 
```

我阅读了整个文档，并且对代码进行了很多尝试。最终，我进入了完整的“示例”页面（不是我最初查看的[测试和示例页面](http://www.jqplot.com/tests/)上列出的少数几个，因为它首先在文档中列出）。我真的很想了解插件代码，因为开发人员花了很多时间来真正为他的代码库提供大量信息、评论和更新。

# c# - 具有细粒度密码策略的 Active Directory 帐户密码到期日期

> ID：12100121
> 
> 赞同：2
> 
> 时间：2012-08-23T21:18:49.807
> 
> 标签：c#, .net, active-directory

在 Windows 2008 之前的域环境中获取密码到期日期没有问题。我能够获取默认域策略并获取密码到期日期。

但是，在 2008 年及以后，他们为细粒度密码策略添加了一项功能。本质上，一个特定的用户帐户可能有多个密码策略有效。

有没有人有任何资源或示例代码考虑到这些新的 FGPP 以及如何将它们合并到我现有的脚本中？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T14:39:06.143

最简单的方法是查看`msDS-ResultantPSO`相关特定用户的构造属性，并获取适用于该用户的密码设置对象的 DN。从那里，您可以查看 PSO 上的到期设置，并将其与`pwdLastSet`用户的值结合起来。

如果`msDS-ResultantPSO`用户的属性为空，那么您应该回退到域密码策略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-20T22:21:09.633

我知道这个问题已经有将近 4 年的历史了，但我想添加我正在努力解决类似问题的代码。此外，如果您无法从 PSO 中读取，则需要确保运行您的代码的用户对相关 PSO 具有读取权限（这是给我带来最大麻烦的原因）。

```
var ad = new PrincipalContext(ContextType.Domain, _domain, _ldapPathOu);

UserPrincipal user = UserPrincipal.FindByIdentity(ad, username);
DirectoryEntry entry = user.GetUnderlyingObject() as DirectoryEntry;
DirectorySearcher mySearcher = new DirectorySearcher(entry);
SearchResultCollection results;
mySearcher.PropertiesToLoad.Add("msDS-ResultantPSO");

results = mySearcher.FindAll();

if (results.Count >= 1)
{
    string pso = results[0].Properties["msDS-ResultantPSO"][0].ToString();

    //do something with the pso..
    DirectoryEntry d = new DirectoryEntry(@"LDAP://corp.example.com/"+ pso);

    var searchForPassPolicy = new DirectorySearcher(d);
    searchForPassPolicy.Filter = @"(objectClass=msDS-PasswordSettings)";
    searchForPassPolicy.SearchScope = System.DirectoryServices.SearchScope.Subtree;

    searchForPassPolicy.PropertiesToLoad.AddRange(new string[] {"msDS-MaximumPasswordAge"});
    var x = searchForPassPolicy.FindAll();

    var maxAge = (Int64)x[0].Properties["msDS-MaximumPasswordAge"][0];
    var maxPwdAgeInDays = ConvertTimeToDays(maxAge);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-07T18:56:41.820

由于我没有足够的声誉来评论@foldinglettuce 的答案，我将在我自己的答案中提供它。

首先，您不需要像`DirectoryEntry`使用“@”那样转义正斜杠。它不是必需的，应该被删除。

其次，您要求`msDS-ResultantPSO`加载属性，非常好。然后你检查以确保找到了一个用户`if (results.Count >= 1)`，再次非常好。现在是你失败的地方......如果该属性为空（因此不包括在内）怎么办？你不能`.ToString()`。您需要跟进检查。它应该看起来像这样......

```
if (results.Count >= 1)
{
    if(results[0].Properties.Contains("msDS-ResultantPSO"))
    {
       // do stuff
    }
} 
```

# silverlight - .NET 4.5 可移植类库：是否可以在运行时确定平台？

> ID：12100123
> 
> 赞同：0
> 
> 时间：2012-08-23T21:18:51.540
> 
> 标签：silverlight, windows-phone-7, .net-4.5, portable-class-library

我有一组针对 Silverlight 和 Windows Phone 7.5 的库，在我的库中，我有一个导航解决方案，它具有通用界面但不同的实现 - 取决于平台。（SL & WP7 Navigation 非常相似，有非常细微的差别，遗憾的是无法避免）

如果我要编写一个包含我的 INavigationModel 接口 + 两个实现的可移植类库，有没有办法知道哪个平台正在调用可移植类库？这些信息将帮助我在运行时选择我的解决方案的正确实现。

干杯

*编辑* 也欢迎任何替代解决方案，我仍在尝试拼凑有关可移植类库的任何信息，以查看它们的能力

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:25:22.320

实际上，这可能效果不佳。即使您可以可靠地确定您正在运行的环境（可能是对 Environment.OperatingSystem 的某种破解），如果您的实现有任何复杂性，您也不太可能完全坚持定义类型的最低公分母/方法等

可移植程序集的重点是定义真正共享的位（实用程序方法、接口等）——可能更好的解决方案可能是在可移植程序集中定义具有共享功能的基类/接口，然后在特定于平台的程序集中扩展为实现非便携式位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T21:29:00.597

没有一个好方法可以做你想做的事。可移植库并没有消除对特定平台项目的需求，它只是有助于促进特定平台项目以与平台无关的方式进行对话。

我倾向于建议 INavigationService 的具体实现存在于平台特定项目本身中，而通用抽象存在于可移植项目中。然后使用 IoC 容器或类似 ServiceLocator 的框架来连接它们（我推荐 Autofac）。我在为 MSDN 写的一篇文章（事实上，我为导航服务这样做）中做过类似的事情：[使用可移植类库创建连续客户端](http://msdn.microsoft.com/en-us/magazine/hh852593.aspx)。请务必下载源代码以查看具体示例。

# ios - 在 XCode 中构建项目的问题 - ProcessPCH 错误

> ID：12100125
> 
> 赞同：-1
> 
> 时间：2012-08-23T21:19:03.100
> 
> 标签：ios, xcode, compiler-construction, prefix

在尝试将 Facebook SDK 安装到项目后，我在编译项目时遇到了问题。我已将代码恢复到以前的状态，但是我仍然收到与“ProcessPCH”相关的错误消息。我已经检查了目标设置，但仍然找不到任何解决此问题的方法。

错误代码如下所示：

```
ProcessPCH /Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Intermediates/PrecompiledHeaders/AirFranceMusic-Prefix-acpjajeiwlvgzwgddsqkamtwztjy/AirFranceMusic-Prefix.pch.pth AirFranceMusic/AirFranceMusic-Prefix.pch normal i386 objective-c com.apple.compilers.llvm.clang.1_0.compiler
cd /Users/admin/Documents/AirFranceMusic/src
setenv LANG en_US.US-ASCII
setenv PATH "/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Applications/Xcode.app/Contents/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -x objective-c-header -arch i386 -fmessage-length=0 -std=gnu99 -fobjc-arc -Wno-trigraphs -fpascal-strings -O0 -Wno-missing-field-initializers -Wno-missing-prototypes -Wreturn-type -Wno-implicit-atomic-properties -Wno-receiver-is-weak -Wformat -Wno-missing-braces -Wparentheses -Wswitch -Wno-unused-function -Wno-unused-label -Wno-unused-parameter -Wunused-variable -Wunused-value -Wuninitialized -Wno-unknown-pragmas -Wno-shadow -Wno-four-char-constants -Wno-conversion -Wno-sign-compare -Wno-shorten-64-to-32 -Wpointer-sign -Wno-newline-eof -Wno-selector -Wno-strict-selector-match -Wno-undeclared-selector -Wno-deprecated-implementations -DDEBUG=1 -DDEBUG=1 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.1.sdk -fexceptions -fasm-blocks -Wprotocol -Wdeprecated-declarations -mmacosx-version-min=10.6 -g -Wno-sign-conversion -fobjc-abi-version=2 -fobjc-legacy-dispatch "-DIBOutlet=__attribute__((iboutlet))" "-DIBOutletCollection(ClassName)=__attribute__((iboutletcollection(ClassName)))" "-DIBAction=void)__attribute__((ibaction)" -D__IPHONE_OS_VERSION_MIN_REQUIRED=40000 -I/Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Intermediates/AirFranceMusic.build/Debug-iphonesimulator/AirFranceMusic.build/AirFranceMusic.hmap -I/Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Products/Debug-iphonesimulator/include -I/Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Intermediates/AirFranceMusic.build/Debug-iphonesimulator/AirFranceMusic.build/DerivedSources/i386 -I/Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Intermediates/AirFranceMusic.build/Debug-iphonesimulator/AirFranceMusic.build/DerivedSources -F/Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Products/Debug-iphonesimulator -F/Users/admin/Documents/AirFranceMusic/src --serialize-diagnostics /Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Intermediates/PrecompiledHeaders/AirFranceMusic-Prefix-acpjajeiwlvgzwgddsqkamtwztjy/AirFranceMusic-Prefix.pch.dia -c /Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/AirFranceMusic-Prefix.pch -o /Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Intermediates/PrecompiledHeaders/AirFranceMusic-Prefix-acpjajeiwlvgzwgddsqkamtwztjy/AirFranceMusic-Prefix.pch.pth -MMD -MT dependencies -MF /Users/admin/Library/Developer/Xcode/DerivedData/AirFranceMusic-btdgsdavrzffuyaockrkcyvdacgq/Build/Intermediates/PrecompiledHeaders/AirFranceMusic-Prefix-acpjajeiwlvgzwgddsqkamtwztjy/AirFranceMusic-Prefix.pch.d

In file included from /Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/AirFranceMusic-Prefix.pch:20:
In file included from /Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/../../libs/MKNetworkKit/MKNetworkKit.h:52:
/Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/../../libs/MKNetworkKit/Categories/NSString+MKNetworkKitAdditions.h:26:1: error: missing '@end'
@interface NSString (MKNetworkKitAdditions)
^
@end

/Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/AppDelegate.h:16:1: note: class started here
@interface AppDelegate : UIResponder <UIApplicationDelegate, UITabBarControllerDelegate>
^
In file included from /Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/AirFranceMusic-Prefix.pch:20:
In file included from /Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/../../libs/MKNetworkKit/MKNetworkKit.h:52:
/Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/../../libs/MKNetworkKit/Categories/NSString+MKNetworkKitAdditions.h:26:21: error: method type specifier must start with '-' or '+'
@interface NSString (MKNetworkKitAdditions)
                    ^
/Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/../../libs/MKNetworkKit/Categories/NSString+MKNetworkKitAdditions.h:26:22: error: expected a type
@interface NSString (MKNetworkKitAdditions)
                     ^
/Users/admin/Documents/AirFranceMusic/src/AirFranceMusic/../../libs/MKNetworkKit/Categories/NSString+MKNetworkKitAdditions.h:28:1: error: expected selector for Objective-C method
- (NSString *) md5;
^
4 errors generated. 
```

如果有人对此有解决方案，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T08:33:48.123

该问题现已修复。虽然我对自己造成的问题并不感到自豪，但我很高兴它得到了解决。

**就我而言，我不小心注释掉了我的 AppDelegate 头文件的 @end，导致 XCode 项目完全无法构建。**

我仍然非常不确定为什么它会说我的失败与 MKNetworkKit 中的一个文件有关，但我只能建议你检查所有文件是否存在类似这样的常见错误，如果清理构建/派生数据不起作用. 重新安装 XCode 绝对不是一个理想的解决方案。

# github - Bundler 如何破译哪个提交对应于某个 Gem 版本？

> ID：12100127
> 
> 赞同：1
> 
> 时间：2012-08-23T21:19:04.893
> 
> 标签：github, gem, version, bundler, rubyforge

我一直在研究 Bundler 的页面和 RubyGem 的页面（以及 SO 帖子），但似乎无法弄清楚这一点。

在 Gemfile 中，您可以向 Bundler 指定要使用的 Gem 版本。这就是我所知道的真实情况......剩下的就是我猜测幕后发生的事情。

所以看起来 Bundler 会转到 RubyGems.org 或其他一些来源，以找出 Gem 的版本、依赖项和源文件的位置。这是我的大假设。

然后最有可能 Bundler 去代码存储库，最有可能是 Github，下载源代码。这就是我坚持的地方。如果有人指定 1.0.0 版本，Bundler 怎么知道哪个 Git 提交对应于 1.0.0 版本？

-Bundler 是否通过标签？

- 或者 Bundler 是否会转到与版本号命名相同的 head aa 分支？

- 或者是否在 RubyForge 的某处指定了特定的提交？

- 或者直接通过 RubyForge 获得源代码的快照？

我想知道，因为如果我将 Gem 指定为 1.0.0 并进行捆绑安装。Bundle 在 1.0.0 分支的头部进行提交（如果 Bundler 是这样做的），那么如果该分支上有后续提交（但版本保持不变），这是否意味着我会有不同的版本那个宝石比那些在我之后捆绑的人（在分支上的后续提交之后）？

bundler 将版本解析为特定提交是有道理的，但是 bundler 如何选择提交？因为版本 1.0.0 可以存在于多个提交中。

感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T08:18:27.290

当 gem 上传到 RubyGems.org 时，代码会与 gemspec 一起打包在一个 .gem 文件中（本质上是一个类似于 .zip 或 .tar.gz 文件的存档）。RubyGems.org 然后解压 gemspec 并读取它以获取版本信息等。

当您在 Bundler 中指定 gem 版本时，它会检查 RubyGems.org 以查看该版本是否可用。如果是这样，它会直接从 RubyGems.org 下载 .gem 文件并将其解压缩，所有代码都在 .gem 文件中，因此无需从 GitHub 下载。如果您指定的版本在 RubyGems.org 上不存在，您将收到错误消息。

Bundler 唯一从 GitHub 下载任何内容的情况是您指定`git`或`github`代替版本。在这种情况下，它将下载 master 分支（或 Gemfile 指定的任何分支）中的最新提交，或者，如果 Gemfile.lock 存在，则下载 Gemfile.lock 中列出的任何提交。

# objective-c - 非对称密钥的 RestKit POST 错误

> ID：12100129
> 
> 赞同：0
> 
> 时间：2012-08-23T21:19:17.660
> 
> 标签：objective-c, ios, rest, restkit

我在使用 RestKit 将对象发布到我的服务器时遇到问题。我正在使用昨晚的 RestKit 版本，但至少从去年开始就一直是个问题。我正在做的是我试图将一个新对象保存到服务器，但是当我这样做时，我在请求被发送到服务器之前收到一个映射错误。问题是我的 JSON 响应键和我的 NSObject 属性是不对称的，即使 RestKit 文档说它们不必如此。在添加新的 POST 命令之前，我用于下载 JSON 响应的 GET 命令很好。RestKit 对非对称密钥映射没有任何问题，并且一切正常。但是，现在我正在尝试将 NSObject POST 回服务器，我收到 NSUknownKeyException 错误。如果我将密钥更改为对称，RKObjectMappingOperation 完成，POST 将实际发送到服务器。这对我来说似乎是一个错误，但我想确保这不是发布的要求。

这是我的代码详细信息。这是映射：

```
RKObjectMapping* restaurantReviewMapping = [RKObjectMapping mappingForClass:[RestaurantReview class] ];
[restaurantReviewMapping mapKeyPath:@"restaurant_id" toAttribute:@"restaurantId"];
[restaurantReviewMapping mapKeyPath:@"title" toAttribute:@"title"];
[restaurantReviewMapping mapKeyPath:@"review" toAttribute:@"review"]; 
```

这是 NSObject：

```
@interface RestaurantReview : NSObject

  @property (nonatomic, retain) NSNumber* restaurantId;
  @property (nonatomic, retain) NSNumber* rating;
  @property (nonatomic, retain) NSString* title;

@end 
```

从对象映射文档复制的发布命令：

```
[[RKObjectManager sharedManager] sendObject:review toResourcePath:fullRestaurantReviewUrl usingBlock:^(RKObjectLoader *loader) {
    loader.method = RKRequestMethodPOST;
    loader.delegate = self;
    loader.serializationMapping = [[RKObjectManager sharedManager].mappingProvider objectMappingForClass:[RestaurantReview class] ];
}]; 
```

最后，我在请求发送到服务器之前收到的错误：

```
2012-08-23 14:57:49.118 [61331:c07] D restkit.network:RKObjectLoader.m:374 POST or PUT request for source object <RestaurantReview: 0x74d55c0>, serializing to MIME Type application/json for transport...
2012-08-23 14:57:49.119 [61331:c07] D restkit.object_mapping:RKObjectMappingOperation.m:655 Starting mapping operation...
2012-08-23 14:57:49.184 [61331:c07] *** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<RestaurantReview 0x74d55c0> valueForUndefinedKey:]: this class is not key value coding-compliant for the key restaurant_id.' 
```

这是一个错误还是我做错了什么？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T07:13:20.467

您想提供`inverseMapping`for `serializationMapping`。

# environment-variables - 使用 GNU Parallel 继承环境变量

> ID：12100136
> 
> 赞同：8
> 
> 时间：2012-08-23T21:19:31.373
> 
> 标签：environment-variables, gnu-parallel

我想在 GNU Parallel 中继承环境变量。我有几个“脚本”（实际上只是命令列表，设计用于 GNU Parallel），每行都有数百行，它们都调用不同的外部程序。但是，这些外部程序（我无法控制）需要在运行之前设置几个环境变量。

在本地设置/导出它们似乎没有帮助，而且我看不到任何方法可以将此信息添加到配置文件中。

文档似乎没有任何内容，类似的 SO 页面建议将命令包装在脚本中。然而，这似乎是一个不优雅的解决方案。有没有办法导出当前环境，或者在脚本中指定所需的变量？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T21:52:37.830

这对我有用：

```
FOO="My  brother's  12\"  records"
export FOO
parallel echo 'FOO is "$FOO" Process id $$ Argument' ::: 1 2 3 
```

要使其适用于远程连接（通过 ssh），您需要引用变量以进行 shell 扩展。`parallel --shellquote`可以帮助您做到这一点：

```
parallel -S server export FOO=$(parallel --shellquote ::: "$FOO")\;echo 'FOO is "$FOO" Process id $$ Argument' ::: 1 2 3 
```

如果这不能解决您的问题，请考虑显示一个不起作用的示例。

- 编辑 -

看看`--env`20121022版中介绍的

- 编辑 -

看看`env_parallel`20160322中介绍的。

# jquery - 非css时如何使用JQuery检索和设置body属性

> ID：12100140
> 
> 赞同：0
> 
> 时间：2012-08-23T21:19:39.817
> 
> 标签：jquery, css

我这里有一些代码可以加载外部页面，当然会替换正文及其内容。这很好，除了 body 标签有一些我想检索的属性，这些属性不是由 .css 嵌入在标签中的。我无法更改页面，因为它们有数千个。任何的意见都将会有帮助。

加载页面的代码：

```
$(document).ready(function() {
    $('[id=Page]').load($(JQCurrentPagelink).val(), function() {
}); 
```

样本主体标签：

```
<body background="/Image/ReviewFade02.jpg" leftmargin="20" topmargin="20" marginwidth="20" marginheight="20"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T05:07:05.697

尝试这个：

```
$.ajax({
    url: 'page-to-load.html',
    success: function(data) {
        // load the content of the other page into #ajax-div
        $('#ajax-div').html(data);
        // a RegEx pattern to grab the opening body tag
        var pattern=new RegExp("<body.*>");
        // grab the opening body tag
        var bodyOpeningTag = pattern.exec(data)[0];
        // remove everything we don't need ('<body ', '>' and quotes)
        var bodyAttributesString = bodyOpeningTag.replace('<body ', '');
        bodyAttributesString = bodyAttributesString.replace('>', '');
        bodyAttributesString = bodyAttributesString.replace(/\"/g,'');
        // split the string into a one dimensional array ('background=/images/about.jpg', 'leftmargin=20' etc)
        var bodyAttributesArray = bodyAttributesString.split(' ');
        // split each attribute item into a [attributename, value] array
        var bodyAttributesArray2d = new Array();
        for (var i = 0; i < bodyAttributesArray.length; i++) {
            bodyAttributesArray2d[i] = bodyAttributesArray[i].split('=');   
        }
    }
}); 
```

演示页面在这里：

[jQuery - ajax 加载另一个页面并获取正文属性](http://demos.dconnell.co.uk/jquery-load-body-and-attributes/ "jQuery - ajax 加载另一个页面并获取正文属性")

# assembly - Legal Far Call x86 实模式

> ID：12100142
> 
> 赞同：0
> 
> 时间：2012-08-23T21:19:49.107
> 
> 标签：assembly, x86, nasm

以下列方式执行远调用是否被认为是合法的集会：

```
 call farCall           ;call an example function that jumps to memory

    farCall:
    jmp 0x1111:2222        ;example address in memory 
```

在 0x1111:2222 加载的程序

```
 ;do some stuff
    ret                    ;return to where the call was made, NOT THE JUMP
                            TO THIS ADDRESS 
```

请注意，这是 16 位实模式，而不是 32 位保护模式（我知道已经有问题了）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T07:18:52.050

您的代码在调用时不会将完整的远返回地址（仅偏移量，但不是 CS 段）保存在堆栈上，因此 0x1111:2222 处的子例程无法使用`retf`并且很可能是普通的近处返回给调用者`ret`。

为什么不简单`call 0x1111:2222`呢？

`push cs`您还可以使用+`call (near)`或`push cs`+模拟远调用指令的堆栈效果`push offset`。

# javascript - 有没有比象形文字更难混淆 javascript 函数的方法？

> ID：12100146
> 
> 赞同：0
> 
> 时间：2012-08-23T21:20:07.970
> 
> 标签：javascript, obfuscation, deobfuscation

我正在开发一个在线国际象棋变体游戏。我想创建一个 javascript 函数，其目的是代表玩家与服务器通信花费在移动上的确切时间。

当然，这条消息会被加密，但为了信任这个函数，我想把它混淆到可以依赖混淆算法的程度。

我只知道一些混淆算法，[象形文字](http://patriciopalladino.com/files/hieroglyphy/)是最有趣的。但它并非牢不可破。执行速度和大小并不重要，我可以在同一个函数中扣除发送消息的函数所花费的时间，大小甚至可以达到 2MB。

我很确定没有牢不可破的算法，因为只要它需要在浏览器中运行，任何有足够耐心的人都可以一块一块地看它的作用。

我是否有一个需要恶意用户付出更多努力和时间的替代方案？

**编辑**我已经在 WindowsXP 上的每个浏览器中进行了一些测试，似乎在 FF、IE、Opera 和 Chrome 中，该`setTimeout`函数将在作为第二个参数传递的延迟后触发，**而不管延迟期间系统时间的任何变化**。如果没有提供其他信息以表明其他情况，则合乎逻辑的结论是，无论系统时间如何变化，都可以在客户端测量时间，使用 setTimeout 函数而不是 Date() 对象，达到 setTimeout 延迟给出的精度时间。

Hamish 在下面的回答中提到修改浏览器日期/时间 API 是微不足道的。在这种情况下，javascript 代码很容易受到会增加 setTimeout 实际延迟时间的修改。应该设置一些代码，以便服务器应该开始怀疑欺骗具有不合理延迟时间的人。如果延迟时间不包括在思考时间中，这将始终是一个问题。

我不能使用服务器端计时是有原因的。延迟时间有时会超过合理的数量，这会让用户不满意。有时滞后可以使一切变得不同。

这让我回到了最初的问题。我正在寻找最好的混淆方法，其中最好的衡量标准是攻击者必须做出去混淆的努力。理想情况下，我希望更改混淆算法的速度快于攻击者可以反混淆的速度，然后在攻击者无法预料的情况下不再使用该算法或很少使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:22:04.510

我可以将我的计算机时钟设置为三个小时前，您的脚本会很高兴地发送`-10800 seconds`. 永远不要依赖 JavaScript 以可信的方式处理信息。使用您的服务器端代码来计算玩家回合开始时间和他们移动时间之间的差异，并绝对在服务器上保留游戏的表示并确保移动有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:31:40.473

混淆你的代码没有帮助，原因有两个：

1.  用户仍然可以检查从浏览器发送到服务器的消息。您还必须以某种方式对消息进行签名，以防止它被拦截和修改。通常，解包消息比使用生成它的函数更容易。
2.  您正在尝试测量移动所花费的时间，这意味着您的混淆函数仍然必须信任系统时钟*和*浏览器日期/时间 API。两者都是微不足道的修改。

一个明智的解决方案是测量服务器上发送和接收消息的时间，并测量连接的延迟以校正传输速度（如果您需要*非常*准确）。

# mfc - stl映射const_iterator和g ++错误

> ID：12100150
> 
> 赞同：0
> 
> 时间：2012-08-23T21:20:45.703
> 
> 标签：mfc, g++, cstring

我正在尝试将一些 windows 的 MFC 类移植到 linux，因为我必须将 windows 软件移植到 linux。

这是我需要移植的代码

```
165: SMapCI it = _s$.find("nchairs"); 
166: if (it==_s$.end()) return 10;
167: int n = strtoul(it->second.text.GetString(), NULL, 10); 
```

和 _s$ 和 SMapCI 是这样定义的

```
typedef std::map<CString, STablemapSymbol> SMap;
SMap        _s$;
typedef SMap::const_iterator SMapCI; 
```

所以，这是我的 CString 类

```
class CString {
    protected:
        std::string str;

    public:
        CString(const char *_cstr) { str = _cstr;; };
        bool operator<(char *_cstr) const { return str < _cstr;};
        const char *GetString() { return str.c_str();};
}; 
```

当我构建代码时，出现以下错误：

```
CTablemap/CTablemap.h:167:54: error: passing ‘const CString’ as ‘this’ argument of ‘const char* const CString::GetString()’ discards qualifiers [-fpermissive] 
```

我不明白这个错误。g++ 文档说

```
passing 'const OBJECT' as 'this' argument of 'FUNCTION' discards qualifiers
*Message found in GCC version 4.5.1
*you're returning an address
*you're attempting to access a container element with a const_iterator using a member function that has no non-const versions. The non-const function does not guarantee it will not alter the data 
```

但是......我的GetString函数被定义为“const char *”，所以我有关键字const......所以我不明白......任何帮助都会非常受欢迎

注意：我使用的是我自己的 CString 类，而不是直接用 std::string 更改它，因为我要移植的代码太大，我想对其进行最少的修改。（并且 CString 中定义的某些函数未在 std::string 中定义）

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:24:16.967

您的函数签名应该是

`const char *GetString() const`

注意最后一个`const`。

现在，您在说，“我正在从*非常量*CString 实例返回一个 const char 指针”。这很好，但是你被要求做的是定义一个可以在*const* CString 实例上使用的函数 - 这就是最后一个 const （在函数参数列表之后）所做的，指定可以调用该函数一个`const CString`。

您可能需要该函数的两个版本，但特别是，您在这里需要它，因为它将`const_iterator`其内容公开为 const 对象，而不管它们在容器本身内部是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:32:26.083

GetString 的原型应该是：

```
const char *GetString() const; 
```

第一个 const 表示调用者不能修改返回值。第二个 const 意味着可以为 a 调用此方法`const CString`。

另一方面，我也会更改 operator< 并使用：

```
bool operator<(const char *_cstr) 
```

# java - Collection 的非泛型子类的构造函数

> ID：12100151
> 
> 赞同：4
> 
> 时间：2012-08-23T21:21:01.117
> 
> 标签：java, generics

这是我应该知道的，但我在上面画了一个空白，并且在尝试通过谷歌找到答案时遇到了惊人的困难。

我正在尝试扩展 Java `Collection`，特别是`ConcurrentHashMap`. 我想创建自己的哈希映射类以用于非通用键/值对，特别是使用我自己的类。

所以我已经这样定义了这个类：

```
public class hashMap extends ConcurrentHashMap<class1, class2> 
```

问题是我忘记了如何正确编写构造函数，以便它们是非泛型的。例如，对于原始的`concurrentHashMap`，您必须调用其构造函数来指定键/值对的类。我只想简单地调用构造函数`hashMap()`，而不需要指定那些泛型。

我试过调用`super<class1, class2>();`构造函数，但这给了我一个错误。

这似乎应该是非常简单的事情，而且我很肯定我曾经知道如何做到这一点，但是已经有一段时间了，就像我说的那样，我正在画一个空白。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-23T21:24:56.380

简单明了`super();`会起作用——或者根本不起作用，因为它是隐含的。请记住，这`new HashMap<String,Integer>();`并不是真正意义上的方法调用的构造函数调用：它是实例化 + 构造函数参数的类型规范。构造函数本身**不接收类型参数**，它们仅作为调用站点类型信息存在。

# jquery - 内容居中对齐页面

> ID：12100156
> 
> 赞同：0
> 
> 时间：2012-08-23T21:21:37.997
> 
> 标签：jquery, css

我想将轮播内容在页面上居中，并且还有一个固定的背景，并根据浏览器调整大小改变高度/宽度。

请让我知道如何从我拥有的代码中完成它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:34:59.480

为了居中它删除css`left: 50%;`上的。`ul`

对于后台使用这个 css：

```
body
{
    background-image: url('replaceme');
    background-repeat: no-repeat;
    background-attachment: fixed;
    background-size: 100% 100%;

} 
```

并替换`replaceme`为您想要的图像。

**注意：** *背景 css 有一些 css3 artibutes 可能无法在较旧的 Internet Explorer 中使用，如果您不想使用 css3，请考虑使用此站点：* [http ://www.quackit.com/html/codes/html_stretch_background_image.cfm](http://www.quackit.com/html/codes/html_stretch_background_image.cfm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:38:01.187

添加

```
text-align:center; 
```

到身体并移除

```
left:50%; 
```

从 ul 开始，这将使环形交叉路口居中。

至于背景图像，您可以将 div 设置为 100% 宽度、绝对位置、顶部和底部 0px，并将图像设置为 100% 宽度以动态缩放，但是为了获得更好的 CSS3 方法，请查看 csstricks.com，有那里有一个很好的教程。

[http://css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:45:45.740

由于上述解决方案都不包括垂直和水平居中，如果这是您想要实现的，请将其添加到您的 ul 类中

```
ul {

 list-style: none;
 padding: 0;
 margin: -15em 0 0 -31em;
 width: 62em;
 height: 30em;
 background-color: #0C0C0C;
 top: 50%;
 left: 50%;

} 
```

对于完全可调整大小的背景，我将使用 FrontEndJohn 解决方案，只需记住将 min-width 和 min-height 添加到 body 中，这样您的图像就不会拉伸太多

# c# - 如何在每次迭代中重用 SqlCommand 参数？

> ID：12100157
> 
> 赞同：22
> 
> 时间：2012-08-23T21:21:38.983
> 
> 标签：c#, sql-server, ado.net

我想为我的数据库实现一个简单的删除按钮。事件方法看起来像这样：

```
private void btnDeleteUser_Click(object sender, EventArgs e)
{
    if (MessageBox.Show("Are you sure?", "delete users",MessageBoxButtons.OKCancel, MessageBoxIcon.Warning) == DialogResult.OK)
    {
        command = new SqlCommand();
        try
        {
            User.connection.Open();
            command.Connection = User.connection;
            command.CommandText = "DELETE FROM tbl_Users WHERE userID = @id";
            int flag;
            foreach (DataGridViewRow row in dgvUsers.SelectedRows)
            {
                int selectedIndex = row.Index;
                int rowUserID = int.Parse(dgvUsers[0,selectedIndex].Value.ToString());

                command.Parameters.AddWithValue("@id", rowUserID);
                flag = command.ExecuteNonQuery();
                if (flag == 1) { MessageBox.Show("Success!"); }

                dgvUsers.Rows.Remove(row);
            }
        }
        catch (SqlException ex)
        {
            MessageBox.Show(ex.Message, Application.ProductName, MessageBoxButtons.OK, MessageBoxIcon.Information);
        }
        finally
        {
            if (ConnectionState.Open.Equals(User.connection.State)) 
               User.connection.Close();
        }
    }
    else
    {
        return;
    }
} 
```

但我收到这条消息：

> 已声明变量@id。变量名称在查询批处理或存储过程中必须是唯一的。

有没有办法重用这个变量？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-08-23T21:28:57.853

`Parameters.AddWithValue`向命令添加一个新参数。由于您在具有相同名称的循环中执行此操作，因此您会收到异常*"Variable names must be unique"*。

所以你只需要一个参数，在循环之前添加它，只改变它在循环中的值。

```
command.CommandText = "DELETE FROM tbl_Users WHERE userID = @id";
command.Parameters.Add("@id", SqlDbType.Int);
int flag;
foreach (DataGridViewRow row in dgvUsers.SelectedRows)
{
    int selectedIndex = row.Index;
    int rowUserID = int.Parse(dgvUsers[0,selectedIndex].Value.ToString());
    command.Parameters["@id"].Value = rowUserID;
    // ...
} 
```

另一种方法是先使用[`command.Parameters.Clear();`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection.clear%28v=vs.110%29.aspx)。然后，您还可以在循环中添加参数，而无需两次创建相同的参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T21:29:57.737

而不是：

```
command.Parameters.AddWithValue("@id", rowUserID); 
```

使用类似的东西：

```
System.Data.SqlClient.SqlParameter p = new System.Data.SqlClient.SqlParameter(); 
```

在 foreach 之外，只需在循环内手动设置：

```
p.ParameterName = "@ID";
p.Value = rowUserID; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-12T15:54:33.603

我会用这个：

```
public static class DbExtensions
{
    public static void AddParameter(SQLiteCommand command, string name, DbType type, object value)
    {
        var param = new SQLiteParameter(name, type);
        param.Value = value;
        command.Parameters.Add(param);
    }
} 
```

然后，调用这个：

```
DbExtensions.AddParameter(command, "@" + fieldOfSearch[i], DbType.String, value[i]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:28:37.893

错误是因为您在循环的每次迭代中一次又一次地添加相同的参数。

我会将该代码移动到一个单独的方法中，以便我可以根据需要从多个地方调用它。

```
public bool DeleteUser(int userId)
{
    string connString = "your connectionstring";
    try
    {
      using (var conn = new SqlConnection(connString))
      {
        using (var cmd = new SqlCommand())
        {
            cmd.Connection = conn;
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "DELETE FROM tbl_Users WHERE userID = @id";
            cmd.Parameters.AddWithValue("@id", userId);
            conn.Open();
            cmd.ExecuteNonQuery();
            return true;
        }
      }
    }
    catch(Exception ex)
    {
      //Log the Error here for Debugging
      return false;
    }

} 
```

然后像这样调用它

```
 foreach (DataGridViewRow row in dgvUsers.SelectedRows)
 {
   int selectedIndex = row.Index;
   if(dgvUsers[0,selectedIndex]!=null)
   {
     int rowUserID = int.Parse(dgvUsers[0,selectedIndex].Value.ToString());
     var result=DeleteUser(rowUserID)
   }
   else
   {
      //Not able to get the ID. Show error message to user
   } 
 } 
```

# php - 快速插入数组/sql

> ID：12100159
> 
> 赞同：0
> 
> 时间：2012-08-23T21:21:40.310
> 
> 标签：php, sql, arrays

我得到了这个代码

```
$i             = -1;
$random_string = array();
while (sizeof($random_string) < 1600000) {
    $i++;
    $zmienna           = generatePassword();
    if (!in_array($zmienna, $random_string))
        $random_string[$i] = $zmienna;
    else
        continue;
}
//print_r($random_string);

foreach ($random_string as $value) {
    $sql = "INSERT INTO `kody`(`kod`) VALUES ('$value')";
    mysql_query($sql, $con);
} 
```

但是将其插入数据库甚至数组都需要花费很多时间。有人知道如何改进此代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:28:04.850

嗯，`in_array()`比较贵。使用散列代替简单数组，然后您可以使用`isset()`代替`in_array()`.

另外，不要使用`sizeof()`和`count()`作为循环条件。相反，只需使用一个简单的`for ($i = 0; $i < 1600000; ++$i) { ... }`数组。

根据您的网络主机权限，另一个重要的优化是使用[`fputcsv()`](http://us3.php.net/manual/en/function.fputcsv.php)将您的阵列写入磁盘，然后使用 MySQL[`LOAD DATA INFILE`](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)将内容加载到您的数据库中，而不是生成 160 万个查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:24:32.153

是的，使用一个查询通过 SQL 多插入一次插入所有这些：

```
$values = "('" . implode( "'), ('", $random_string) . "')";
$sql="INSERT INTO `kody`(`kod`) VALUES " . $values;
mysql_query($sql,$con); 
```

正如 drrcknlsn 非常正确地指出的那样，`in_array()`效率低下，因为它对数组执行线性 O(n) 搜索。这是您可以解决的方法（这是一个哈希实现）：

```
while( sizeof($random_string) < 1600000) {
    $i++;
    $zmienna = generatePassword();
    if( !isset( $random_string[$zmienna]))
        $random_string[$zmienna] = $zmienna;
    else
        continue;
} 
```

现在，您可以使用上面的代码生成单个 SQL 查询，这应该运行得更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:23:52.023

问题可能是它试图在每次插入后更新 INDEX。尝试使用事务。这只会在`COMMIT`调用一次（之后）更新 INDEX。如果出现问题，这也会让你`ROLLBACK`。

```
mysql_query("SET AUTOCOMMIT=0");
mysql_query("START TRANSACTION");

foreach($random_string as $value)
{
$sql="INSERT INTO `kody`(`kod`) VALUES ('$value')";
   mysql_query($sql,$con);
}

mysql_query("COMMIT"); 
```

# c# - 检查进程是否每分钟都在运行

> ID：12100160
> 
> 赞同：5
> 
> 时间：2012-08-23T21:21:40.523
> 
> 标签：c#

我有这个基本代码，它将检查每分钟运行的记事本。

```
namespace Watcher
{
    class Program
    {
        static void Main(string[] args)
        {
            for (int i = 0; ; i--)
            {
                foreach (Process clsProcess in Process.GetProcesses())
                {
                    if (clsProcess.ProcessName.Contains("notepad"))
                    {
                        Console.WriteLine("True");
                    }
                    Console.WriteLine("NFalse");
                }
                Thread.Sleep(10000);
            }
        }
    }
} 
```

问题是它为每个正在运行的进程返回“NFalse”（例如，它将打印 100 个）。我怎样才能只打印一次以表明进程没有运行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T21:24:12.837

**重构你的代码。**

你在一种方法上做得太多了。将检查记事本是否正在运行的代码放入单独的方法中：

```
static bool CheckIfProcessIsRunning(string nameSubstring)
{
    foreach (Process clsProcess in Process.GetProcesses())
    {
        if (clsProcess.ProcessName.Contains(nameSubstring))
        {
            return true;
        }
    }
    return false;
} 
```

您可以使用 LINQ 进一步简化此操作：

```
static bool CheckIfProcessIsRunning(string nameSubstring)
{
    return Process.GetProcesses().Any(p => p.ProcessName.Contains(nameSubstring));
} 
```

一旦你编写了这个方法，剩下的就是调用它并根据它返回的是 true 还是 false 来打印正确的消息。

```
while (true)
{
    string message = CheckIfProcessIsRunning("notepad") ? "True" : "NFalse";
    Console.WriteLine(message);
    Thread.Sleep(10000);
} 
```

现在，您有两个非常简单的方法，而不是一个具有复杂逻辑的长方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:24:47.223

您只需要检查您感兴趣的进程。不要费心循环所有正在运行的进程。使用[Process.GetProcessByName()](http://msdn.microsoft.com/en-us/library/z3w4xdc9)。

```
for (int i = 0; ; i--)
{
     Process[] processes = Process.GetProcessByName("notepad++"); // Without extension
     if(processes.Length > 0){
          Console.WriteLine("True");
     }
     else{
          Console.WriteLine("False");
     }

     Thread.Sleep(10000);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:33:29.380

好吧，这似乎运作良好。

```
Dim x = Process.GetProcesses().ToList().FirstOrDefault(Function(p) p.ProcessName.Contains("Notepad"))
if x Is Nothing then
    Console.WriteLine("false")
end if 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T21:24:50.013

只需更改为这个，所以你只打印一次。

```
var b = false;
foreach (Process clsProcess in Process.GetProcesses())
            {
                if (clsProcess.ProcessName.Contains("notepad"))
                {
                    if (!b) b = true;
                }
            }
                Console.WriteLine(b); 
```

# vim - 创建 ~/.vimrc 后打开文件出错

> ID：12100162
> 
> 赞同：9
> 
> 时间：2012-08-23T21:21:52.957
> 
> 标签：vim

在今天之前，我`/etc/vim/vimrc`用来配置我的 vim 设置。今天我想创建`.vimrc`文件。所以，我用

```
touch .vimrc
cat /etc/vim/vimrc > .vimrc 
```

所以，现在当我用 vim 打开任何文件时，我得到以下错误：

```
Error detected while processing /home/ronnie/.vimrc:
line   68:
E122: Function SplitColors already exists, add ! to replace it
line   77:
E122: Function ChangeColors already exists, add ! to replace it
line  171:
E174: Command already exists: add ! to replace it
line  174:
E174: Command already exists: add ! to replace it
Press ENTER or type command to continue 
```

我的系统中都有`/etc/vim/vimrc`和`.vimrc`文件。那么，这是我收到此错误的原因吗，因为从现在开始我只想`.vimrc`用来配置我的 vim 设置。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T21:42:26.180

您正在定义与已定义的某些名称相同的函数。在“覆盖”之前的定义之后添加感叹号`function`，在您的情况下将停止显示错误消息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-07-26T17:14:36.230

这是示例解决方案，因为上面的大多数答案都是正确的，但它们并不能直接帮助您解决问题。感兴趣的领域以粗体表示。

" 有重定义问题的代码

> **函数**CloseDuplicateTabs() 结束函数
> 
> **命令**CloseDupTabs ：调用 CloseDuplicateTabs()

" 带有覆盖的固定代码

> **功能！**CloseDuplicateTabs() 结束函数
> 
> **命令！**CloseDupTabs ：调用 CloseDuplicateTabs()

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-24T07:21:51.553

问题是两者`/etc/vim/vimrc`都有`.vimrc`来源。这取决于几个因素；详情见`:help .vimrc`。

一般来说，系统范围的 Vim 配置应该驻留在前一个文件中，而您的个人定制应该驻留在后者中。对于单用户系统，没有太大区别，但是您将这些内容移到主目录中是正确的。只需从以前的文件中删除重复的函数等，或者如果您已将所有内容移动到您的`.vimrc`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-23T21:26:07.830

为什么不加！按照建议您的功能定义？它会让 vim 停止抱怨。

或者，您可以从 /etc/vim/vimrc 中删除这些定义

# maven - 从源代码构建 WSO2 治理注册表

> ID：12100163
> 
> 赞同：0
> 
> 时间：2012-08-23T21:21:52.867
> 
> 标签：maven, wso2

我想从源代码分发中构建治理注册表。
我按照以下链接 [http://wso2.org/project/registry/4.1.1/docs/installation_guide.html](http://wso2.org/project/registry/4.1.1/docs/installation_guide.html)中提供的说明进行操作，尤其是“使用源代码分发构建 WSO2 治理注册表”段落。

我启动了 maven comman“mvn clean install”，它开始下载依赖项，但几分钟后构建过程停止并出现错误。下面是一个错误示例： [ERROR] Non-resolvable parent POM: Failure to find org.wso2.carbon:governance: pom:3.2.0 in repo.maven.apache.org/maven2 was cached in the local repository,直到中央的更新间隔已经过去或强制更新并且'parent.relativePath'指向错误的本地POM @第22行，第13列-> [帮助2]，才会重新尝试解决方案

这是我的配置：

*   操作系统：Windows 7 64 位
*   Maven：3.0.4
*   JDK：1.6.0.22
*   WSO2 政府注册表：4.0.0

有人知道为什么安装说明不起作用吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T12:00:49.587

请使用 maven2 从分支构建 GReg 4.1.1。

如果您是从[trunk](https://svn.wso2.org/repos/wso2/carbon/)构建碳，请使用 maven3 。

希望这可以帮助。

谢谢

蒂利尼

# c# - Symbols 函数定义无效：split-window-side-by-side

> ID：12100164
> 
> 赞同：0
> 
> 时间：2012-08-23T21:21:53.787
> 
> 标签：c#, emacs, read-eval-print-loop

我是 Emacs 新手（在 Windows 上使用 24.1.1 版），我通过包含以下代码更改了我的 .emacs 文件：[CSharpRepl emacs 集成？](https://stackoverflow.com/questions/6207068/csharprepl-emacs-integration)

```
(defun csharp-repl ()
  "Open a new side-by-side window and start CSharpRepl in it."
  (interactive)
  (split-window-side-by-side)
  (other-window 1)
  (comint-run "C:\\Program Files\\CSRepl\\CSRepl.exe"))

(global-set-key [f11] 'csharp-repl) 
```

当我按下 F11 时，我最终收到一条错误消息，提示“符号的函数定义无效：并排拆分窗口”。如果我离开 (split-window-side-by-side) 和 (other-window 1)，C# REPL 将打开但在一个窗口中，这并不是我真正想要的。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T10:04:57.470

你确定你不是在找`split-window-vertically`？在我的 emacs24 中，我在 Mx 下看不到任何匹配的内容`split-window-side-by-side`。

# android - Titanium：创建带有文本的按钮

> ID：12100167
> 
> 赞同：0
> 
> 时间：2012-08-23T21:22:25.190
> 
> 标签：android, ios, titanium

这是给 tianium 的——目前正在研究 android 开发，但同样欢迎任何 ios 特定信息！

所以我有一个钛应用程序，我想在里面有按钮。不过，每个按钮都用于不同的“部分”，所以我想“嘿，为什么不让每个部分都有一个图标，并在其下放置文本，所以最终结果看起来非常类似于 Windows 桌面，或者说，ipad /iphone 主屏幕"

需要明确的是，我想要的是一组带有一些文字的图像，这些图像是可点击的。

像这样！

```
 <img      <img      <img
   img       img       img
   img>      img>      img>
 section1  section2   has a 
                     long name 
```

但是我该怎么做呢？向按钮添加“标题”只会让文本出现在它旁边，而不是在它下面

干杯~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:57:54.080

您正在寻找所谓的仪表板视图。不幸的是，没有适用于android的，只有iOS。

稍微搜索论坛，我发现了这个：http: [//developer.appcelerator.com/question/67631/grid-view-is-possible-or-not#answer-206038](http://developer.appcelerator.com/question/67631/grid-view-is-possible-or-not#answer-206038)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:05:04.970

你可以用简单的按钮来做到这一点。设置按钮的背景`'@null'`，设置 a `drawableTop`（这将包含您的部分图像），并设置按钮的文本。当然，你可以随意格式化这个Button，添加边距、内边距、格式化文本等。

这是我使用这种技术的布局[之一。](http://dl.dropbox.com/u/232549/icons.png)

如果您想要这些按钮的良好布局，请使用合并的线性布局，或使用编程的 RelativeLayout。

# oop - 非 OOP 编程中多态性的替代方案？

> ID：12100168
> 
> 赞同：6
> 
> 时间：2012-08-23T21:22:33.337
> 
> 标签：oop, polymorphism, procedural-programming

假设我们有一个包含不同元素的绘图程序，例如圆形、矩形、三角形等。不同种类的对象都需要类似的功能，例如`draw()`展示自己。

我想知道程序员将如何处理如今通常由多态性解决的问题，即通过一组不相同的元素并跨不同对象调用通用功能。

想到的一种方法是拥有一个结构，其中包含指向适当函数（或函数指针数组中的索引）的函数指针以及指向实际实例的 void 指针，并传递转​​换为正确类型的指针在函数中。但这就是我 - 一个对这个问题一无所知的人会这样做的方式。

我确实意识到这可能是一个愚蠢的问题，但由于我在“过去”的日子里没有去过，我真的想知道这个问题是如何解决的。在过程编程中使用了什么样的方法，它是否具有性能优势，因为我们都知道多态性即使在像 C++ 这样的快速语言中也会因为虚方法查找而产生开销。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-09-05T14:42:32.067

一个非常简单的例子。

如果您对此感兴趣，您可以在 Linux Kernel 中找到更多内容。

```
#include <stdio.h>                                                              

struct shape {                                                                  
    void (*say_hello)(void);                                                    
};                                                                              

void circle_say_hello(void)                                                     
{                                                                               
    printf("Hi I am circle!\n");                                                
}                                                                               

void square_say_hello(void)                                                     
{                                                                               
    printf("Meh I am square.\n");                                               
}                                                                               

#define ARRAY_SIZE(a) (sizeof(a)/sizeof(a[0]))                                  

int main(int argc, char *argv[])                                                
{                                                                               
    struct shape circle = { .say_hello = circle_say_hello, };                   
    struct shape square = { .say_hello = square_say_hello, };                   
    struct shape* shapes[] = {&circle, &square};                                
    int i;                                                                      

    for (i = 0; i < ARRAY_SIZE(shapes); i++) {                                  
        if (shapes[i] && shapes[i]->say_hello)                                  
            shapes[i]->say_hello();                                             
    }                                                                           

    return 0;                                                                   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:06:21.727

这不是对您的示例的直接回答，而是对您的评论的地址，这显示了错误的观点恕我直言

> 我只是想知道那个特定的问题，如果有一种更有效的方法可以避免虚拟方法的性能开销，我最感兴趣

这里有一些东西要理解。*一切*都有权衡。设计模式和 OO 具有我们喜爱的所有已知优点，但也有缺点，例如太多的类、内存开销、由于许多方法调用导致的性能开销等。

另一方面，旧的“程序”方式也有一些优点，即客观性；代码“简单”（无需考虑如何设计系统，只需将所有内容放在 main 中）并且在许多方面具有更少的开销（更少的内存开销，因为需要更少的类和更紧凑的对象 - 不需要虚拟表等等-和更少的方法调用，因此可能有更好的性能，没有动态绑定的性能开销——不管现在的开销是什么......-)。

但这不是*特定问题实例*的权衡取舍，而是经验表明什么是构建软件的正确方法。**模块化**代码的**重用**和有助于单独测试（***质量***保证）、**可读性**、**可维护性**、灵活**扩展**的代码是已被充分理解的属性，应该是软件开发的主要驱动力。

 *******所以在某些情况下，一个*真正优秀*的 C/C++ 程序员可以按照你所说的那样做“旧方式”，但是它为这个特定程序带来的性能优势值得没有人能够维护或以后能坚持吗？

再举一个类似的例子：你可以用同样的方式问吗？
*为什么在 Web 开发中使用多层架构？*只需将所有内容都放入一台服务器，它会快很多，因为查询后端和 UI 数据的所有层或查询远程数据库的网络延迟等不会有延迟。
当然，你有一定道理。但是然后问问你自己，这可以随着负载的增加而扩展吗？答案是不。那么可扩展性对您来说很重要，还是您想保持“将所有东西放在一个服务器中”的想法？如果您的收入来自电子网站，那么您无法为更多客户提供服务这一事实不会仅仅因为您服务前 100 名客户真的很快就让您的客户满意......无论如何这是我的看法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:46:16.860

在诸如 C 之类的过程语言中，这将通过`draw()`为每个自定义数据类型（可能表示为结构）定义函数的单独实现来解决。任何通用功能都将被分解为一个单独的函数，该函数对每个结构的共享元素进行操作（例如对象中心的 x 和 y 坐标，它们将出现在每个结构中）。从代码和功能的角度来看，这与使用多态性的 OOP 布局没有太大区别，在这种布局中，您仍然必须`draw()`在基类中实现共享方法并在特定子类中覆盖它。在过程语言的情况下，我们只是不会将这些函数定义拆分为单独的“对象”。

有一些奇特的方法可以从过程语言中获得类似对象的行为，例如联合类型或带有额外布尔值的单个整体类型，以确定是否正在使用特定元素。这将允许您编写一个`draw()`函数，该函数可以根据启用的元素执行逻辑切换。在实践中，我唯一看到的大部分是在基于 CORBA 的系统中，其中用 C 编写的程序必须模仿通过 IDL 传播的 OOP 语言的某些行为（即，将 Java 对象转换为构造可以解码成 C 风格的结构）。

至于 C++ 和 Java 等语言中虚方法查找的开销，这在面向对象语言中是无法完全避免的。`final`正确使用关键字（它允许编译器/JVM 优化方法查找表）可以很好地缓解这种情况。*******

# mongodb - 在 Azure 上设置 MongoDB

> ID：12100170
> 
> 赞同：3
> 
> 时间：2012-08-23T21:22:46.360
> 
> 标签：mongodb, azure

我是 Windows Azure 的新手。我正在尝试在 Azure VM（虚拟机）上安装新的 MongoDB。我可以登录机器。我读了这篇文章[http://www.mongodb.org/display/DOCS/MongoDB+on+Azure+VM+-+Windows+Installer](http://www.mongodb.org/display/DOCS/MongoDB+on+Azure+VM+-+Windows+Installer)描述了如何设置它，但我对命令感到困惑

`.\deploy-mongo.ps1 <node-count> <dns-prefix> <image-name> <password> <location> <pub-settings-file-path> [replica-set-name]`

我正在尝试在具有 20GB 硬盘驱动器的 Azure Windows VM 中的 Azure 上安装单个 MongoDB。

什么是 ns-prefix、image-name？你能给我一个例子吗？

我的虚拟机 DNS 是[http://example23231.cloudapp.net](http://example23231.cloudapp.net)。是VM DNS还是什么？

这也是像 examplevm1_2012_22.vhd 这样的 VM 映像名称吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:42:25.623

做你想做的事，你会使用

```
.\deploy-mongo.ps1 1 example23231 MyMongoImage MyPassword "West US" PathToPubSettings file 
```

上述命令将创建一个单独的 Azure VM 实例，该实例位于 example23231.cloudapp.net 并启用了 RDP。它还将下载并安装 MongoDB 作为 Windows 服务。

如果您有一个名为 MyMongoImage 且启用了 WinRM 的图像，它将被使用。否则，将在您的默认存储帐户中创建具有该名称的图像以供后续使用。

默认映像是 30GB 的标准 Windows 2k8R2 映像。注意 mongodb 数据路径默认设置为 OS 驱动器

# javascript - 使用 JS 使用 Ruby 数组进行迭代并在视图中显示

> ID：12100171
> 
> 赞同：0
> 
> 时间：2012-08-23T21:22:59.403
> 
> 标签：javascript, ruby-on-rails

我正在尝试进行 ajax 调用，它将返回对象数组并将其显示在视图中。我可以显示我的类位置的单个对象，但无法遍历数组。我收到以下错误

```
ActionView::Template::Error (undefined method `model_name' for NilClass:Class): 
```

我的 js 文件是

```
 $("#locations").append("<%= escape_javascript(render(@locations)) %>"); 
```

我的部分文件是 _location.erb 是

```
<div id="locations" class="locations">
  <% unless @locations.nil %>
    <% @locations.each do |location| %>
      <%= @locations.name %>
    <% end %>
  <% end %> 
```

我的控制器看起来像

```
 def search
   result = getResultFromSomeWhere
   @locations = Array.new(result.size)
   result.each do |resultobj|
     @locations.push(Location.new(resultobj))
   end
   respond_to do |format|
     format.js
   end
 end 
```

我认为它与序列化有关，因为我正在传递 ActiveRecord 对象数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:42:35.337

假设结果的大小是 5，那么

`@locations = Array.new(result.size)`将返回`[nil, nil, nil, nil, nil]`

然后您将位置推送到该数组

```
[nil, nil, nil, nil, nil, location1, location2, ...] 
```

然后你可以看到你的错误。

# java - 在单词的每个字符之间插入一个字符（a 到 z）

> ID：12100177
> 
> 赞同：0
> 
> 时间：2012-08-23T21:23:29.867
> 
> 标签：java, char

我正在做一个拼写检查器。我已经实现了包含单词列表的哈希表，但是现在我必须编写五种用于生成可能的单词建议的技术。其中之一是

1.  交换相邻字符
2.  在每个字符之间插入一个字符

例如：

我有“bob”这个词...我希望能够在 (az)b (az)o (az)b(az) 之间插入一个字符，看看我是否能得到一个可能是建议的新词对于错过的拼写单词

这是我到目前为止所做的......但不起作用

```
public static void main(String[] args) {
    String word = "evelina";

    char[] wordCharArr = word.toCharArray();

    for(int i=0; i < wordCharArr.length ; i++) {
        //char temp1 = wordCharArr[i];
        for(char j = 'A'; j <= 'Z' ; j++) {
            word.substring(j);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-25T03:17:43.453

我所做的是添加一些代码来创建一个 ArrayList（本质上是一个无限数组），然后用围绕一个字母切换时发现的所有可能性填充它。它还会打印出每一个，但您可以将其删除。

我所做的唯一更改是：

1.添加数组列表

2.修复你的外循环；短一个字符（Bob 需要 4 次迭代，而不是 3 次）

3.添加额外的子字符串段来解释单词的其余部分。

可以通过 words.get(a) 检索元素；其中 'a' 是 Array-list 范围内的 int。不要忘记import语句，import java.util.*；

这也将比 Jeff 的解决方案更有效，因为不必检查整个字典，然后像下面建议的那样从字典中删除每个元素，它只需要检查具有所有 ~100 种可能性的字典。因为字典是按字母顺序排列的，所以可以非常快速地搜索它，但删除每个条目（近 100000 个单词）的效率会降低。

```
import java.util.*;
public class spellcheck {
public static void main(String[] args) {
    String word = "evelina";
    char[] wordCharArr = word.toCharArray();
    ArrayList<String> words = new ArrayList<String>();
    for(int i=0; i <= wordCharArr.length ; i++) {
        for(char j = 'A'; j <= 'Z' ; j++) {
            words.add(word.substring(0,i) + j + word.substring(i,wordCharArr.length));
    System.out.println(word.substring(0,i) + j + word.substring(i,wordCharArr.length));
        }
    }
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:40:02.340

你的问题出在你的 for 循环中。而不是只遍历您正在检查的单词的所有其他字母。您正在遍历每个字母，包括原始字母。外部 for 循环应该略有不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:46:08.367

还有另一种选择，但我不确定它是更容易还是更难实现（至少对我来说听起来更容易）。您可以构建一个简单的查询机制，而不是遍历每个字符并将其插入到单词中，如下所示：

```
 Input: b?ob 
```

所以你的算法会是这样的：

```
 1) Start with your entire word list
 2) Remove all words that don't start with b
 3) You can "ignore" the ?
 4) Remove all words that don't have a 'o' in the 3rd position
 5) Remove all words that don't have a 'b' in the 4th position
 6) Return the results 
```

然后你浏览每个选项

```
 Input 2: bo?b
 Input 3: bob? 
```

# mysql - SQL SELECT 语句表达式值重用于其他表达式

> ID：12100178
> 
> 赞同：6
> 
> 时间：2012-08-23T21:23:37.530
> 
> 标签：mysql, sql, sql-server

我在 mysql 中有一个包含大量行数的表（尽管我正在寻找通用 SQL 解决方案）

```
very_big_table(INT a, INT b, INT c, ...) 
```

我想要 SELECT 语句

```
SELECT a, 
    (b + c) as expression1,
    (b + c + a) AS expression2 -- basically (expression1 + a)
FROM very_big_table
WHERE ...
GROUP BY a
ORDER BY a DESC 
```

只要表达式 1 简单，这看起来不错且易于阅读。
但是当 CASE-WHEN/IFNULL()/SUM()/MIN()/STRCAT() 或某些运算符在这些表达式中发挥作用时，它很难阅读和调试。

我已经解决了一些已经提出的问题，
[将 mysql 值分配给变量内联](https://stackoverflow.com/questions/5623410/assigning-mysql-value-to-variable-inline)
[使用列的值用于另一列（SQL Server）？](https://stackoverflow.com/questions/5180979/use-value-of-a-column-for-another-column-sql-server)
[如何在同一选择语句中使用条件列值？](https://stackoverflow.com/questions/5790697/how-to-use-conditional-columns-values-in-the-same-select-statement)

但是，如果我使用描述的方法，例如

```
SELECT a, 
    expression1,
    (expression1 + a) AS expression2
FROM 
    (SELECT a,
        (b + c) AS expression1
    FROM very_big_table
    WHERE ...
    GROUP BY a) as inner_table
ORDER BY a DESC 
```

这很好用，但是这个查询需要 70 倍以上的时间来执行。至少当我解雇它时，虽然只有一次。
如果我在输出列中 有多个级别的*表达式怎么办？*

有什么优雅的方法来处理这个问题，而不影响可读性？

顺便说一句，为什么SQL 标准或供应商不支持 select 语句中的这个*表达式重用*或*别名引用？*（假设在单个 SELECT 语句表达式中没有循环评估。在这种情况下，编译器会失败）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-06-30T06:57:05.173

您可以使用用户定义的变量来解决您的问题。您的 SQL 可以重写为：

```
SELECT a, 
    @expr1 := (b + c) as expression1,
    (@expr1 + a) AS expression2
FROM very_big_table
WHERE ...
GROUP BY a
ORDER BY a DESC 
```

你可以参考[这篇文章](https://stackoverflow.com/q/32894065/1393498)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T19:20:17.460

我有两个选择。。

使用您的实际查询作为子查询

```
 select a,exp1,exp1+a as exp2
 from (SELECT a 
             ,(b + c) as exp1
       FROM very_big_table
       WHERE ...
       GROUP BY a
 )V
 ORDER BY a DESC 
```

或为您的查询添加外部应用语句...

```
SELECT a 
      ,OA.exp1 as expression1
      ,(OA.exp1 + a) AS expression2 -- basically (expression1 + a)
FROM very_big_table
outer apply (select (b + c) as exp1) OA
WHERE ...
GROUP BY a
ORDER BY a DESC 
```

我猜第二个选项，使用外部应用，更适合阅读......

请记住，每行的外部应用运行

因此，如果 exp1 必须从表中访问大量数据，这可能是个坏主意。

无论如何，仅使用您已经在实际查询中获得的字段，添加它不会有很大的成本。

所以..你会选择什么方式？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T17:19:51.883

解决方法假设表达式不是 sql select 子句，而是嵌套的运算符/函数，纯粹作用于在原始“select from”子句中检索到的数据，因此手头的任务纯粹是为了让代码“看起来很漂亮”：创建用户定义函数

那么你的查询看起来像

```
select a
, myfunction( b, c)
, myfunction( b, c) + a
... 
```

好处 - 这会清理您既定目标的“选择代码”，您也可以集中管理更复杂的逻辑

缺点 - 这不是将移植到其他系统的“通用 sql”，如果函数很少被重用，可能不值得花时间投资

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-02T04:47:20.850

对于 Postgresql 用户

如果您想最大限度地提高复杂计算和/或逻辑的可读性，请将计算封装在自己的函数中

```
create table x
(
    a int not null,
    b int not null,
    c int not null
);

create table y
(
    a int not null,
    z int not null
);

select * from x;

insert into x VALUES
(1,2,3), (4,5,6);

insert into y values
(1, 100); 
```

### 具有复杂计算和/或逻辑的功能：

```
create or replace function computer
(
    rx x, -- this emphasizes that the source of data come from table x
    ry y, -- this emphasizes that the source of data come from table x

    out expression1 int, out expression2 int, out expression3 int
)
as $$
begin
    expression1 := rx.b + rx.c;
    expression2 := expression1 + rx.a;
    expression3 := expression2 + ry.z;
end;
$$ language 'plpgsql'; 
```

测试查询：

```
select x.a, x.b, x.c, y.z, answer.*
from x
join y on x.a = y.a
cross join lateral computer(x,y) answer 
```

输出：

[![在此处输入图像描述](../Images/25d75800c561f7cef427acedcd7d0947.png)](https://i.stack.imgur.com/LkRrk.png)

如果只需要快速测试函数的返回值，可以使用括号-星号语法对其进行扩展：

```
select x.a, x.b, x.c, y.z, (computer(x, y)).*
from x
join y on x.a = y.a 
```

但是不要在生产中使用它，如果该函数有 50 个返回列，则该函数将被调用 50 次。`cross join lateral`在生产中使用。请参阅：[如何将“压缩”的 PostgreSQL 行扩展为单独的列？](https://stackoverflow.com/questions/24444008/how-can-you-expand-a-condensed-postgresql-row-into-separate-columns/24444348#24444348)

如果您的函数不需要关心数据源来自哪里，只需使用`record`函数参数上的类型

```
create or replace function computer_b
(
    anon record,
    out expression1 int, out expression2 int, out expression3 int
)
as $$
begin
    expression1 := anon.b + anon.c;
    expression2 := expression1 + anon.a;
    expression3 := expression2 + anon.z;
end;
$$ language 'plpgsql'; 
```

测试查询：

```
with data_source as
(
    select x.*, y.z
    from x
    join y on x.a = y.a
)
select ds.*, answer.*
from data_source ds
cross join lateral computer_b(ds) answer 
```

# jquery - jQuery Fancybox 2 刷新 iFrame 或它的父页面

> ID：12100181
> 
> 赞同：0
> 
> 时间：2012-08-23T21:23:47.297
> 
> 标签：jquery, iframe, fancybox, fancybox-2

基本上，我喜欢花式框内的花式框用于数据输入。问题是当我完成后，我希望它会刷新调用它的fancybox！

举个例子。我有一个关于浏览器窗口的报告，然后是第一个花式框的详细信息，然后在里面并从中调用，一个花式框，这样我就可以在里面放一个便条....在我添加注释之后，花式框是卸载后，我想在父花式框或任何名称上触发刷新（7个花式框，关闭＃7和＃6刷新）

[https://lh4.googleusercontent.com/-PZlJoSXZSj0/UDWnwAkat0I/AAAAAAAAAPE/SyAPgaSTc1Y/s1600/test.jpg](https://lh4.googleusercontent.com/-PZlJoSXZSj0/UDWnwAkat0I/AAAAAAAAAPE/SyAPgaSTc1Y/s1600/test.jpg)

我在这里的这段代码总是刷新上面例子中的窗口。我希望我能用它来刷新fancybox的父fancybox！

```
 $('.'+sFancy).fancybox({ 
            'href'  : this.href, 
            'width' : '100%', 
            'height' : '100%', 
            'fitToView' : false,
            'autoSize'  :   false,
            'transitionIn'  :   'elastic',
            'transitionOut' :   'elastic',
            'speedIn'   :   200, 
            'speedOut'  :   500, 
            'type' : 'iframe',
            'onClosed'      : function(){
            self.parent.location.reload(true);
            }   
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T17:12:44.850

这适用于我现在的目的。

我已经动态地向fancybox 添加了一个函数，用于关闭最后一个关闭以刷新父级。

这将回答我最初提出的问题：

```
function fancyCall()
{
    var sFancy = 'fancybox';

    if(url.search(/CRMPopper/i) != -1)
        sFancy = 'fancyboxpop';

    $('.'+sFancy).fancybox({ 
        'href'          :   this.href, 
        'width'         :   '100%', 
        'height'        :   '100%', 
        'fitToView'     :   false,
        'autoSize'      :   false,
        'transitionIn'  :   'elastic',
        'transitionOut' :   'elastic',
        'speedIn'       :   100, 
        'speedOut'      :   300, 
        'type'          :   'iframe',
        'onClosed'      :   function(){window.location.reload();}           
    }); 
} 
```

# jquery - 为什么我无法使用 jquery 找到我的标签文本？

> ID：12100183
> 
> 赞同：0
> 
> 时间：2012-08-23T21:23:53.290
> 
> 标签：jquery, asp.net

```
$("[id$=HealthCareReimbursementPerPayPeriodTxt]").blur(function (evt) {
try {
    val1 = (this.value);
    alert(val1);
    val2 = $("[id$=HealthCareReimbursementNumPayPeriodsTxt]");
    alert(val2.value);
}
catch (e) { }
}); 
```

我通过通配符选择了它们，因为它在母版页中。val1 工作得很好（文本框），但 val2（标签）从来没有得到我需要的东西。我也试过 val2.text、val2.val、valueOf(val2)、val2.html、val2.attr('text')。我得到 Object [object]、未定义或一些长函数字符串。

```
<asp:Label ID="HealthCareReimbursementNumPayPeriodsTxt" runat="server"> 
```

如果有帮助，我将在代码隐藏中设置此标签的文本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:26:44.233

在您的代码中，您需要更改它

```
val2 = $("[id$=HealthCareReimbursementNumPayPeriodsTxt]"); 
```

经过

```
val2 = $("[id$=HealthCareReimbursementNumPayPeriodsTxt]")[0]; 
```

jQuery 选择器不直接返回 DOM 对象。您还可以使用类选择器

```
<asp:Label ID="HealthCareReimbursementTotalLbl" Text="0.00" runat="server" 
    CssClass="healthCareReimbursementTotalLbl"></asp:Label> 
```

然后你可以做

```
$(function(){
    $(".healthCareReimbursementTotalTxt").blur(function (evt) {
    try {
        val1 = (this.value);
        alert(val1);
        val2 = $(".healthCareReimbursementTotalLbl")[0];
        alert(val2.value);
    }
    catch (e) { }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T17:53:02.997

尝试这个

```
 $("[id$=HealthCareReimbursementPerPayPeriodTxt]").blur(function (evt) {
              try {
                  val1 = (this.value);
                  alert(val1);

                  // first try wether your are getting this elemnt or not 
                  alert($("[id$=HealthCareReimbursementNumPayPeriodsTxt]").length);
                  if ($("[id$=HealthCareReimbursementNumPayPeriodsTxt]").length > 0) {
                      alert("item found");
                      val2 = $("[id$=HealthCareReimbursementNumPayPeriodsTxt]");
                      alert(val2.val());
                      // if it does not work try
                     // alert(val2.html()); or alert(val2.text);
                  }
                  else {
                      alert("item not found");
                  }
              }
              catch (e) { }
          }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:34:35.097

尝试这个：

```
val2 = $("[id$=HealthCareReimbursementNumPayPeriodsTxt]")[0].val(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T02:08:46.477

要么`val2.html`或`val2.text`应该工作。`.val`仅适用于输入和其他保存值的控件（例如 HiddenFields），不适用于刚刚转换为 HTML 元素（例如标签）的控件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T22:43:46.167

您说标签正在更改为 a `<span></span>`，它没有`val`属性。我认为您需要使用，因为您需要标签*之间*`.html()`的文本。

 *IE

`val2 = $("[id$=HealthCareReimbursementNumPayPeriodsTxt]").html();`*

# mysql - 在sql查询中组合多行和连接表

> ID：12100194
> 
> 赞同：0
> 
> 时间：2012-08-23T21:24:43.213
> 
> 标签：mysql, sql, joomla

首先，我要感谢所有花时间帮助他人的人！这个网站很棒，我已经为我的问题找到了一些解决方案。但现在我被困住了，我想寻求一些帮助。我正在开发一个新项目，我想在其中显示基于 sql 表值的图表。这是关于减肥的，我的用户使用表格输入他们的数据。这些数据存储在 2 个表中：

famd0_facileforms_records：

```
id    user_id    username
--------------------------
14    653        username1
15    648        username2 
```

famd0_facileforms_subrecords：

```
id    record   element    title        name      type            value
------------------------------------------------------------------------------------
199   14       225        Datum        datum     Calendar        2012-08-22 11:32:07
200   14       226        Gewicht      gewicht   Text            92
201   14       242        BMI          bmi       Text            33.79
209   15       225        Datum        datum     Calendar        2012-08-01 11:53:05
210   15       226        Gewicht      gewicht   Text            83
212   15       242        BMI          bmi       Text            26.20 
```

通过使用以下 sql 查询，我能够在图表中显示所有记录：

```
SELECT CONVERT(d1.value, DATE) AS Datum, CONVERT(d2.value, DECIMAL(5,1)) AS Gewicht  
FROM famd0_facileforms_subrecords AS d1  
INNER JOIN famd0_facileforms_subrecords AS d2 ON d1.record = d2.record  
WHERE d1.element = 225 AND d2.element = 226  
ORDER BY d1.value ASC 
```

但我只想在图表中显示登录用户的记录。我可以为登录用户使用一个变量，例如：

```
SELECT `id` FROM `famd0_facileforms_records` WHERE `user_id` = %%J_USER_ID%% 
```

这是我的问题：我不知道如何加入两个表并在我的图表中只显示登录用户的条目。

任何帮助都会很棒。

非常感谢！网络尼科尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:32:31.763

看起来您只需要执行以下操作。您将向`JOIN`表中添加 a`famd0_facileforms_records`并在`WHERE`子句中放置 user_id 上的过滤器：

```
SELECT x.id, 
    CONVERT(d1.value, DATE) AS Datum, 
    CONVERT(d2.value, DECIMAL(5,1)) AS Gewicht
FROM famd0_facileforms_subrecords AS d1
INNER JOIN famd0_facileforms_subrecords AS d2 
    ON d1.record = d2.record
LEFT JOIN famd0_facileforms_records x
    ON d1.record = x.id
WHERE d1.element = 225 
    AND d2.element = 226
    AND x.user_id = %%J_USER_ID%%
ORDER BY d1.value ASC 
```

如果您收到错误但仍想按 id 过滤，则可以添加`WHERE`子句，但不要在 id 中包含 id `SELECT`：

```
SELECT CONVERT(d1.value, DATE) AS Datum, 
    CONVERT(d2.value, DECIMAL(5,1)) AS Gewicht
FROM famd0_facileforms_subrecords AS d1
INNER JOIN famd0_facileforms_subrecords AS d2 
    ON d1.record = d2.record
LEFT JOIN famd0_facileforms_records x
    ON d1.record = x.id
WHERE d1.element = 225 
    AND d2.element = 226
    AND x.user_id = %%J_USER_ID%%
ORDER BY d1.value ASC 
```

# javascript - 使用 Jquery 按属性对 div 进行排序？

> ID：12100197
> 
> 赞同：0
> 
> 时间：2012-08-23T21:24:48.153
> 
> 标签：javascript, jquery, frameworks

我有这个 HTML：

```
​&lt;div indice="1">first</div>
<div indice="3">third</div>
<div indice="2">second</div>

<button onclick="organize();">Sort</button> 
```

当我单击按钮时，我需要使用属性“索引”对相同的 html 进行 asc 排序，并且 dom 看起来像这样：

```
​&lt;div indice="1">first</div>
<div indice="2">second</div>
<div indice="3">third</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:43:23.213

尝试使用 javascripts 数组排序方法

```
$('div').sort(function(a,b){
    return $(a).attr('indice') - $(b).attr('indice');
}); 
```

[http://jsfiddle.net/nPbk8/](http://jsfiddle.net/nPbk8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:45:32.687

您可以尝试使用此链接中的（未经我测试）代码： [james.padolsey.com/javascript/sorting-elements-with-jquery/](http://james.padolsey.com/javascript/sorting-elements-with-jquery/)

您只需将比较函数中的 .text() 替换为 .attr('indice')

如果这不能解决您的问题，请让我在几个小时内回答，届时我将在我的笔记本电脑上，我有一个代码片段可以完全满足您的需求。

# zend-framework2 - ZF2，使用 ZFCUser -> 使用服务管理器

> ID：12100201
> 
> 赞同：3
> 
> 时间：2012-08-23T21:24:54.033
> 
> 标签：zend-framework2, zend-framework-modules

我将 ZfcUser 设置为身份验证模块。该模块效果很好，除了我必须在每个操作中再次定义它：

```
$sm = $this->getServiceLocator();
$auth = $sm->get('zfcuser_auth_service');
if ($auth->hasIdentity()) {
    fb($auth->getIdentity()->getEmail());
}
else return $this->redirect()->toRoute('zfcuser'); 
```

我尝试将代码放入构造中，但效果不佳。然后我检查了服务管理器，但无法使用所有出现的多个版本正确定义它。

这是我的 Module 类的代码：

```
public function getServiceConfig() {
    return array(
        'factories' => array(
            'Todo\Model\TodoTable' =>  function($sm) {
                $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                $table = new TodoTable($dbAdapter);
                return $table;
            },
        ),
    );
} 
```

如何正确设置服务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T08:55:53.270

你考虑过控制器插件吗？它将允许将这六行代码压缩为一个呼叫。

否则，另一种更通用的方法是创建一个附加“调度”事件的基本控制器。Matthew Weier O'Phinney在“事件”标题下写了一篇博客文章，展示了这种方法[http://mwop.net/blog/2012-07-30-the-new-init.html 。](http://mwop.net/blog/2012-07-30-the-new-init.html)

```
public function setEventManager(EventManagerInterface $events)
{
    parent::setEventManager($events);

    $controller = $this;
    $events->attach('dispatch', function ($e) use ($controller) {

        if (is_callable(array($controller, 'checkIdentity')))
        {
            call_user_func(array($controller, 'checkIdentity'));
        }
    }, 100);
}

public function checkIdentity()
{
    // Existing ZfcUser code
} 
```

# javascript - 回车后如何调用onclick函数

> ID：12100203
> 
> 赞同：5
> 
> 时间：2012-08-23T21:24:55.703
> 
> 标签：javascript, jquery

我正在制作一个聊天网络应用程序，要发送一条消息，有一个`input type="text"`和一个`input type="button"`，使用 JavaScript 中的一个函数，我设法通过添加`onclick="sendMessage()"`作为属性来解决它`input button`，但我需要点击它，但我想要它要像任何聊天信使或应用程序一样工作，客户端会写下一些内容并按 ENTER 键，如果我使用 a`<form onsubmit="sendMessage()">`并且`input type="submit"`然后页面将刷新，这可能会工作，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:27:15.227

```
 <form onsubmit="sendMessage();return false"> 
```

这可以防止向服务器发送请求的默认操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-02T09:42:56.377

如果您还想禁用 Posting to server 中的 enter 按钮并执行 Js 脚本。

```
<input type="text" id="txtSearch" onkeydown="if (event.keyCode == 13)
{document.getElementById('btnSearch').click(); return false;}"/>
<input type="button" id="btnSearch" value="Search" onclick="doSomething();"/> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T21:28:53.937

您必须连接到文本框的 onkeypress/up/down 事件。这应该可以帮助您入门： [在 JavaScript 中输入按键事件](https://stackoverflow.com/questions/905222/javascriptenter-key-press-event)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T21:32:31.467

使用 onkeydown() （或 keyPress 或 keyUp，取决于语义）而不是点击 - 这将为您提供一个带有您想要的 event.keyCode 的事件 - 13 - 您可以使用 AJAX 请求（即 XMLHttpRequest）轻松提交

简单代码： - 原始 Javascript，不需要 JQuery：

```
<html>
<script>
function keyPress(e)
{
if (!e) e = window.event; // needed for cross browser compatibility
alert(e.keyCode); // You want 13 here , so 
 // if (e.keyCode == 13)
 //  etc..

// return true; or false, if you want to cancel event

}
</script>
<body>
<input type="text" onkeydown="keyPress()" size="20"/>xx

</body>
</html> 
```

# scala - 奇怪的 Scala 编译器警告

> ID：12100212
> 
> 赞同：1
> 
> 时间：2012-08-23T21:25:47.813
> 
> 标签：scala, playframework

我在 Scala Play Framework 中有以下代码：

```
 case class Step(name: String, f: Unit) {
    def run = {() => f}
  } 
```

编译器给了我一个奇怪的警告

```
comparing values of type Unit and Unit using '==' will always yield true 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:32:32.447

这是因为案例类`==`为您定义了一个方法，该方法会比较案例类中的每个字段。`Step("a", println("1")) == Step("a", println("2"))`即使`Unit`功能不一样也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T22:48:30.513

你真正需要的可能性很小`f: Unit`。毕竟，`Unit`只有一个值：`()`.

我想你可能正在考虑这样做：

```
Step("Debugging", println("here")) 
```

实际上，它尊重所有类型，但在调用或应用返回值时*不会*打印“here” 。相反，它会在您初始化 时打印“here” ，然后将返回值 , 传递给。在你打电话的时候，它什么也不做。`run``run``Step``()``f``run`

也许你想要这个：

```
case class Step(name: String, f: => Unit) {
  def run = {() => f}
} 
```

甚至：

```
case class Step(name: String, f: => Unit) {
  def run = f
} 
```

# java - Java zip 文件已创建但未打开，表示文件意外结束

> ID：12100218
> 
> 赞同：6
> 
> 时间：2012-08-23T21:26:19.343
> 
> 标签：java, gzip

我有`Object`一个

```
private String name;
private int age;
private String country;
// getters and setters 
```

和功能是

```
protected void write(@Nonnull final Document document, @Nonnull final OutputStream stream) throws PersistenceException {
        try {
            jaxbContext.createMarshaller().marshal(document, stream);
        } catch (final JAXBException e) {
            LOGGER.error(e.getMessage(), e);
            throw new PersistenceException("Failed to marshall document " + docment.getUniqueId() + ": " + e.getMessage(), e);
        }
    } 
```

我将其转换为`zip`文件

```
 ByteArrayOutputStream stream = new ByteArrayOutputStream();
           write(document, stream);
           GZIPOutputStream gzipOutputStream = new GZIPOutputStream(new FileOutputStream(new File(getOutputFilePath(document.getUniqueId()))));
           gzipOutputStream.write(stream.toByteArray()); 
```

这会创建 zip 文件，但是当我尝试打开它时，它会说

```
gzip: document.xml.gz: unexpected end of file 
```

我在这里没有做什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T21:37:19.673

您需要确保致电：

```
gzipOutputStream.flush(); 
```

最终

```
gzipOutputStream.close(); 
```

# jquery - jQuery手风琴实现

> ID：12100222
> 
> 赞同：0
> 
> 时间：2012-08-23T21:26:34.343
> 
> 标签：jquery, css, accordion, sass

我目前正在尝试在我的网站[http://jsfiddle.net/8MXAu/中实现这个特殊的手风琴](http://jsfiddle.net/8MXAu/)

我了解 HTML 设置，但我难以理解的是如何将 javascript 和 scss 应用到我的网站以使其正常工作。下面是我的网站 css 布局。如果你能指导我如何设置以及在哪里应用 javascript 和 scss，这将对我有很大帮助！

```
 /*
---------------------------------------
APOLLO
---------------------------------------
by Ryan Clark
www.ryanvsclark.com
---------------------------------------                                                                                                          
*/

/* ---------- GLOBAL STYLING RULES & RESETS ---------- */
* {
    margin: 0px;
    padding: 0px;
}

<virb get="customize.fonts.font_face" />

body {
    background: <virb get="customize.colors.background_footer" />;
    font: normal <virb get="customize.fonts.body_size" /> <virb get="customize.fonts.body_family" />;
    color:<virb get="customize.colors.text" />;
    line-height: 1.5;
    font-family: <virb get="customize.fonts.body_family" />,serif; 
}

hr { display: none; }

#page hr {
    display: block;
    border: none 0; 
    border-top: 1px solid <virb get="customize.colors.line_page" />;
    width: 100%;
    height: 1px;
    margin: 0 0 20px 0;
}

input, option, textarea, 
button {
    font: normal <virb get="customize.fonts.body_size" /> <virb get="customize.fonts.body_family" />;
}

ul, ol {
    list-style-type: none;
}

q:before, q:after { content: ""; }

big   { font-size: 12px; }
small { font-size: 9px; }

img   { border: none; }

a {
    color: <virb get="customize.colors.link" />;
    text-decoration: none;
    outline: none;
}

a:hover {
    color: <virb get="customize.colors.link_hover" />;
}

#footer a {
    color: <virb get="customize.colors.footer_link" />;
    text-decoration: none;
    outline: none;
}

#footer a:hover {
    color: <virb get="customize.colors.footer_link_hover" />;
}

p, h1, h2, h3, h4, h5, h6,
ol, ul {
    line-height: 1.5;
}
#container_right p {
    line-height: 150%;
}
#page #description h2, #page #blog .text h3 {
    font-size: 1.5em;
    font-family: <virb get="customize.fonts.body_family" />;
}

.homepage #page #description h2 {
    margin: 10px 0 0 0;
    font-size: 1.5em;
}

.homepage #page #description h3 {
    font-size: 1.2em;
    font-family: <virb get="customize.fonts.body_family" />;
    color:#888;
}

#header_wrapper, #page_wrapper, #footer_wrapper  {
    width:100%;
    position:relative;
}

/* ---------- HEADER ---------- */

div#header_wrapper {
    width:100%;
    background: <virb get="customize.colors.background_header" />;
    z-index: 2;
}

div#header {
    width:960px;
    margin:0 auto;
    padding:35px 0 25px;
}
    #header h1 {
        font: normal <virb get="customize.fonts.site_size" /><virb get="customize.fonts.site_family" />;
        line-height: 100%;
    }

        #header h1 a,
        #header h1 a:hover {
            color: <virb get="customize.colors.site_name" />;
        }

        #header h1 img {
            display: block;
            max-width: 300px;
        }

    #header h2 {
        font-weight: bold;
        font-size: <virb get="customize.fonts.tagline_size" />;
        font-family: <virb get="customize.fonts.header_family" />;
        color: <virb get="customize.colors.tagline" />;
        line-height: 110%;
        padding-top: 6px;
    }

    #header #page_title {
       float:left;
    }
    #header #site_nav {
       float:right;
       margin-top: 22px;
    }

#display_name {width: 300px;}

    #display_name h2 {color:<virb get="customize.colors.tagline" />; text-transform: uppercase;}

/* ---------- NAVIGATION ---------- */

div#site_nav {
    display: block;
    max-width: 650px;
}

#site_nav ul li {
    display: inline;
    position: relative;
    font-size: <virb get="customize.fonts.nav_size" />;
    font-family: <virb get="customize.fonts.header_family" />;
    font-weight: bold;
    letter-spacing: .2px;
}

#site_nav div.clear {
    display: none;
}

    #site_nav li.section:after { content: " "; }

    #site_nav li.section ul { display: none; } 
    #site_nav li.section:hover ul { display: block; }
    #site_nav li.section ul {
        position: absolute;
        top: <virb get="customize.fonts.nav_size" />;
        left: 10px;
        width: 200px;
        z-index: 111;
        padding-top: 10px;
    }
        #site_nav li.section ul li {
            float: none;
            display: block;
            font: normal <virb get="customize.fonts.nav_size" />;
            background: <virb get="customize.colors.nav_dropdown" />;
            margin: 0;
            padding: 7px 7px 5px 7px;
            letter-spacing: 0;
            text-align: left;
            line-height: 1.5;
            border-bottom: 1px solid <virb get="customize.colors.background_header" />;
        }
            #site_nav li.section ul li:last-child {border-bottom: none;}

            #site_nav li.section ul li a {
                text-transform: none;
                letter-spacing: 0;
                padding: 4px 7px 4px 3px;
                font: <virb get="customize.fonts.header_family" />;
                display: block;
            }

    #site_nav ul li a, 
    #site_nav ul li.section {
        cursor: pointer;
        padding: 0 12px;
        font: <virb get="customize.fonts.header_family" />;
        color: <virb get="customize.colors.nav_link" />;
    }
    #site_nav ul li a:hover,
    #site_nav ul li.section:hover {
        color: <virb get="customize.colors.nav_hover" />;
    }
    #site_nav ul li.active, #site_nav ul li.active a {
        color: <virb get="customize.colors.nav_hover" />;
    }

    #site_nav ul li.active ul li a {
        color: <virb get="customize.colors.nav_link" />;
    }

    #site_nav ul li.active ul li a:hover {
        color: <virb get="customize.colors.nav_hover" />;
    }

    #site_nav ul li.active ul li.active a {
        color: <virb get="customize.colors.nav_hover" />;
        cursor: default;
    }

/* ---------- PAGE ---------- */

div#page_wrapper {
    background: <virb get="customize.colors.background_page" />;
    z-index: 1;
    overflow: hidden;
}

div#page {
    width:960px;
    margin:0 auto;
    padding:25px 0 15px;
    overflow: hidden;
    border-top: 1px solid <virb get="customize.colors.line_page" />;
    border-bottom: 1px solid <virb get="customize.colors.line_page" />;
}

body.index div#page {padding-bottom: 0;}

#page div#description {
    position: relative;
    padding: 0;
    width:600px;
}
    #page #description p, #page #description h2, #page #description h3, #page #description h4, #page #description h5, #page #description h6 {
        padding: 0 0 15px 0;
    }

    #page #description ul li, #page #description ol li {padding: 0 0 5px 0;}

    #page #description h2 {line-height: 1.3;}

div#share {
    display: block;
    position: relative;
    clear: both;
    padding: 10px 0 0 0;
}

#page #title {
    display: none;
}

/* ---------- SIDEBAR ---------- */

div#widgets {
    font-size: 11px;
    overflow: hidden;
    line-height: 0;
    font-family: <virb get="customize.fonts.footer_family" />;
}

div#widgets:after {
    display: block;
    visibility: hidden;
    clear: both;
    content: "\00A0";
}

    #widgets .module {
        display: block;
        float: left;
        width: 300px;
        padding: 0 0 20px 0;
        margin: 0 30px 0 0;
    }
    #widgets .last_module {margin: 0;} 

        #widgets .module h4 {
            font: italic <virb get="customize.fonts.body_size"/> <virb get="customize.fonts.footer_family" />;
            color: <virb get="customize.colors.widget_text" />;
            letter-spacing: .2px;
            padding: 0 0 10px 0;
            margin-bottom:10px;
            border-bottom: 1px solid <virb get="customize.colors.line_footer" />;
        }
            #widgets h4 a { color: <virb get="customize.colors.footer_link" />; }
            #widgets h4 a:hover { color: <virb get="customize.colors.footer_link_hover" />; }

        #widgets .module p {
            font-size: <virb get="customize.fonts.body_size" />;
            line-height: 150%;
            padding: 0;
        }

            #widgets .module.twitter ul li span a,
            #widgets .module.lastfm ul.recent_plays li span {
                color: <virb get="customize.colors.footer_link" />;
            }
            #widgets .module.twitter ul li span a:hover {
                color: <virb get="customize.colors.text" />;
            }

        #widgets .module.lastfm ol {
            list-style-type: decimal;
            list-style-position: inside;
        }

            #widgets .module.rss-feed ul,
            #widgets .module.blog-posts ul, 
            #widgets .module.twitter ul, 
            #widgets .module.lastfm ul.upcoming_events,
            #widgets .module.lastfm ul.recent_plays {
                margin-bottom: -10px;
            }

            #widgets .module.rss-feed ul li,
            #widgets .module.blog-posts ul li,
            #widgets .module.twitter ul li,
            #widgets .module.lastfm ul.upcoming_events li,
            #widgets .module.lastfm ul.recent_plays li {
                padding-bottom: 10px;
            }

                #widgets .module.lastfm ol li img { display: none; }

        #widgets .count_2, #widgets .count_5, #widgets .count_8, #widgets .count_11, #widgets .count_14, #widgets .count_17 {
            margin: 0;
        }

    /* AUDIO PLAYER */

    .module.audio_player ul {
        display: block;
        width: 278px;
        background: #fff;
        border: solid 1px #ddd;
        border-radius: 5px;
        padding: 10px 10px 15px 10px;
        overflow: hidden;
    }
    .module.audio_player li .album_image {
        height: 75px;
        width: 75px;
        padding: 5px 15px 5px 5px;
        margin-bottom: 10px;
        display: block;
        float:left;
    }
    .module.audio_player li .album_image img {
       height:75px;
       width:75px;
    }

    .module.audio_player li {
        display: none;
    }
    .module.audio_player li.selected {
        display: block;
    }
    #widgets .module.audio_player li h3 {
        text-align: left;
        font-size: <virb get="customize.fonts.body_size" />;
        padding-bottom: 2px;
    }
        #widgets .module.audio_player li h3 .download {
            display: none;
        }
    #widgets .module.audio_player ul h4 {
        display: block;
        text-align: left;
        font: normal 12px <virb get="customize.fonts.footer_family" />;
        text-transform: none;
        border: none;
        letter-spacing: 0;
        padding: 0 0 2px 0;
        margin: 0;
        color: <virb get="customize.colors.text" />;
    }
    .module.audio_player .controls {
        display: block;
        float: left;
        margin:5px 0 10px 0;
        text-align: left;
        padding-bottom: 10px;
        width: 180px;
        border-bottom: 1px solid <virb get="customize.colors.line_page" />;
    }
        .module.audio_player .controls .prev,
        .module.audio_player .controls .next {
            display: inline-block;
            width: 20px;
            height: 30px;
        }
        .module.audio_player .controls .prev a,
        .module.audio_player .controls .next a {
            display: inline-block;
            width: 20px;
            height: 30px;
            overflow: hidden;
            text-indent: 1000px;
            -moz-border-radius: 7px;
            -webkit-border-radius: 7px;
            border-radius: 7px;
        }
        .module.audio_player .controls .prev a {
            background: url(<virb get="theme.assets.url" />graphics/sprite_controls.png) no-repeat left -7px;   
        }
        .module.audio_player .controls .next a {
            background: url(<virb get="theme.assets.url" />graphics/sprite_controls.png) no-repeat right -7px;
        }

        .module.audio_player .controls .playpause {
            display: inline-block;
            height: 30px;
            width: 35px;
            overflow: hidden;
        }
            .module.audio_player .controls .playpause a {
                display: block;
                height: 30px;
                width: 35px;
                overflow: hidden;
                text-indent: 1000px;
                background: <virb get="customize.colors.text" /> url(<virb get="theme.assets.url" />graphics/sprite_controls.png) no-repeat center -7px;
                -moz-border-radius: 7px;
                -webkit-border-radius: 7px;
                border-radius: 7px;
            }
            .module.audio_player .playing .controls .playpause a {
                background: <virb get="customize.colors.link" /> url(<virb get="theme.assets.url" />graphics/sprite_controls.png) no-repeat center -52px;
            }

    .module.audio_player audio {
        width: 150px;
        padding: 15px 5px 0px 5px;
    }

    .module.audio_player .length {
        display: block;
        height: 6px;
        width: 150px;
        border: solid 1px #ddd;
        background: #ddd;
        -moz-border-radius: 2px;
        -webkit-border-radius: 2px;
        border-radius: 2px; 
        position: relative; 
        margin-top: 9px;
        float:left;
        margin-left:95px;
    }
        .module.audio_player .length .load {
            height: 6px;
            width: 0%;
            display: block;
            background: <virb get="customize.colors.text" />;
            position: absolute;
        }
        .module.audio_player .length .progress {
            height: 6px;
            width: 0%;
            display: block;
            background: <virb get="customize.colors.link" />;
            position: absolute;
        }
        .module.audio_player .length .time {
            color: <virb get="customize.colors.text" />;
            font-size: <virb get="customize.fonts.body_size" />;
            position: absolute;
            left: 157px;
            top: -4px;
        }

/***** @group Cart widget *****/

.cart-widget {
  width: 75px;
  text-align: center;
  position: fixed;
  top: 100px;
  right: 0;
  z-index: 2000;
}

  .cart-widget .cart {
    background: <virb get="customize.colors.line_page" />;
    font-family: <virb get="customize.fonts.body_family" />;
    font-size: <virb get="customize.fonts.body_size" />;
    color: <virb get="customize.colors.text" />;
    padding: 10px;
  }
    .cart-widget .cart span {
      display: block;
    }
    .cart-widget .cart span.label {
      font-size: .65em;
      text-transform: uppercase;
    }
    .cart-widget .cart span.cart-total {
      font-weight: bold;
    }

  .cart-widget .checkout {
    background: <virb get="customize.colors.link_hover" />;
    padding: 5px 10px;
    text-transform: uppercase;
    color: <virb get="customize.colors.background_page" />;
    font-size: 9px;
    display: block;
    margin-top: 1px;
    -webkit-transition: all .2s linear;
       -moz-transition: all .2s linear;
         -o-transition: all .2s linear;
            transition: all .2s linear;
  }
    .cart-widget .checkout:hover {
      background: <virb get="customize.colors.link" />;
    }

/***** @group Cart widget *****/

/* ---------- FOOTER ---------- */

div#footer {
    width:960px;
    margin:0 auto;
    padding:25px 0;
    font-family: <virb get="customize.fonts.footer_family" />;
    color: <virb get="customize.colors.widget_text" />;
}       

span#virb_customize_footer {
    color: <virb get="customize.colors.footer_text" />;
    padding-top: 10px;
    width:100%;
    display: block;
}

/* ie7 specific styles */

.ie7 .audio_player .controls .playpause a, 
.ie7 .audio_player .controls .prev a, 
.ie7 .audio_player .controls .next a {
  font-size:0;
  display: block;
  line-height: 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T23:19:44.830

您需要将 JS 和 CSS 代码放入您网站的 html 代码中。

```
<head>
  <script type='text/javascript' src='http://code.jquery.com/jquery-1.7.1.js'></script>
  <style type='text/css'>
    .accordion{margin:50px}.accordion dd,.accordion dt{padding:10px;border:1px solid #000;border-bottom:0}.accordion dd:last-of-type,.accordion dt:last-of-type{border-bottom:1px solid #000}.accordion dd a,.accordion dt a{display:block;color:#000;font-weight:bold}.accordion dd{border-top:0;font-size:12px}.accordion dd:last-of-type{border-top:1px solid #fff;position:relative;top:-1px}a{text-decoration:none}body{font:16px Sans-Serif}
  </style>

<script type='text/javascript'>//<![CDATA[ 
  $(function(){
      (function($) {

         var allPanels = $('.accordion > dd').hide();

         $('.accordion > dt > a').click(function() {
              allPanels.slideUp();

         if($(this).parent().next().is(':hidden'))
         {
              $(this).parent().next().slideDown();
         }

         return false;
        });

     })(jQuery);
   });//]]>  

</script>
</head> 
```

CSS 部分可以放在您的 html 代码或 css 中。

# javascript - 仅在某些地方而不在其他地方拆分数组

> ID：12100223
> 
> 赞同：2
> 
> 时间：2012-08-23T21:26:37.650
> 
> 标签：javascript, split

我非常了解这个`.split()`功能。但我似乎能弄清楚的是如何在某些地方分裂而不是在其他地方分裂。听起来很混乱？好吧，我的意思是，例如，假设我`.split(",")`在以下字符串上使用：

```
div:(li,div),div 
```

是否可以拆分它，以便仅拆分括号外的逗号。

所以`string`上面的`split`方法应该返回：

```
['div:(li,div)', 'div'] 
```

当然，目前它也在拆分括号内的第一个逗号，返回：

```
['div:(li', 'div)', 'div'] 
```

有没有办法让这项工作像我想要的那样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:52:12.210

如果您预期的字符串不会变得比这更复杂，您不必担心编写代码来解析它们。正则表达式可以正常工作。

[http://jsfiddle.net/dC5HN/1/](http://jsfiddle.net/dC5HN/1/)

```
var str = "div:(li,div),div:(li,div),div";
var parts = str.split(/,(?=(?:[^\)]|\([^\)]*\))*$)/g);
console.log(parts); 
```

输出：

```
["div:(li,div)", "div:(li,div)", "div"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:43:44.383

REGEX 不是为这种事情而构建的，它本质上是解析。

以前遇到这种情况时，我首先将括号部分暂时替换为占位符，然后拆分，然后将占位符替换为原始括号部分。

有点hacky，但它有效：

```
 var str = 'div:(li,div),div',
        repls = [];

    //first strip out parenthesised parts and store in array
    str = str.replace(/\([^\)]*\)/g, function($0) {
        repls.push($0);
        return '*repl'+(repls.length - 1)+'*';
    });

    //with the parenthisised parts removed, split the string then iteratively
    //reinstate the removed parenthisised parts
    var pieces = str.split(',').map(function(val, index) {
        return val.replace(/\*repl(\d+)\*/, function($0, $1) {
            return repls[$1];
        });
    });

    //test
    console.log(pieces); //["div:(li,div)","div"] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:48:14.200

此函数将拆分您在 splitChar 中指定的任何内容，但如果在括号内则忽略该值：

```
function customSplit(stringToSplit, splitChar){
    var arr = new Array();
    var isParenOpen = 0
    var curChar;
    var curString = "";

    for (var i = 0; i < stringToSplit.length; i++) {
        curChar = stringToSplit.substr(i, 1);
        switch(curChar) {
            case "(":
                isParenOpen++;
                break;

            case ")":
                if(isParenOpen > 0) isParenOpen--;
                break;
            case splitChar:
                if (isParenOpen < 1) {
                    arr.push(curString);
                    curString = "";
                    continue;
                }
        }

        curString += curChar;
    }
    if (curString.length > 0) {
        arr.push(curString);
    }

    return arr;
} 
```

# php - 我无法使用 PHP 更新来更新文本区域

> ID：12100227
> 
> 赞同：0
> 
> 时间：2012-08-23T21:26:51.043
> 
> 标签：php, mysql

我想做的是在文本区域中的表格的“文本”行中显示文本...（这是一个奇怪的句子），我应该能够在该文本区域中添加/删除/编辑文本然后按保存更新它...

当尝试关于表被擦除所有数据时......

```
<?php 

if(isset($_POST['submit_about']))

{

mysql_query("UPDATE about SET `text` = '$row['text']'");

}

// get result from database
  $result = mysql_query("SELECT * FROM about") 
    or die(mysql_error());

// present the result
  while($row = mysql_fetch_array( $result )) {

  echo "<form method='post' action='uc_admin.php'>
  <textarea name='text' rows='8'>" . $row['text'] . "</textarea>
  <br />
  <button type='submit' name='submit_about' class='btn'>Save</button>";
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:32:34.977

改变

```
mysql_query("UPDATE about SET `text` = '$row['text']'"); 
```

至

```
mysql_query("UPDATE about SET `text` = '".mysql_real_escape_string($_POST['text'])."'"); 
```

另外，尝试移动到 mysqli 或 PDO ..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:32:57.860

您的更新查询应如下所示：

```
mysql_query("update `about` set `text`='".mysql_real_escape_string($_POST['text'])."'"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T00:45:44.063

您应该尝试以下代码。

```
mysql_query("UPDATE about SET `text` = '$_POST['text']' WHERE DBid='dbid'"); 
```

DBid 是您的数据库表主 ID。

# perl - CPAN 无法编译 C，如何配置 CCFLAGS？

> ID：12100228
> 
> 赞同：1
> 
> 时间：2012-08-23T21:26:55.180
> 
> 标签：perl, freebsd, cpan

我有一个新的 FreeBSD 9.0 安装，它无法通过 CPAN 安装需要 C 的模块。它似乎归结为`cc`没有被调用`-I/usr/local/include`。我尝试通过使用`INC="-I/usr/local/include"`- 启动 CPAN 来覆盖它，虽然这解决了某些模块的问题，但它会破坏其他模块，因为它似乎覆盖了 makefile 中设置的任何默认值。

我有另一个设置几乎相同的盒子（安装稍旧，但仍然是 FreeBSD 9.0），`perl -V`在旧盒子上显示`ccflags`contains `-I/usr/local/include`，而在新盒子上没有。

我猜这就是为什么 CPAN 在`cc`没有它的情况下打电话的原因。

问题是，我该如何配置它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:32:43.153

CPAN 模块使用的设置来自作为核心 Perl 一部分的 Config 模块。它记录了编译 Perl 时使用的编译选项和设置。

无论出于何种原因，在您的新 FreeBSD 9.0 安装上编译 Perl 的人决定不包含`-I/usr/local/include`.

正如您已经发现的那样，与 Config 模块中的设置作斗争是一项艰巨的工作。总的来说，最简单的就是不打它。如果您希望 Perl 使用`/usr/local/include`，则编译 Perl 以便这样做。您可能还想指定`-l/usr/local/lib`。

您应该检查两个相似系统上的 Perl 版本是否相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:35:07.960

如果它有效，您最好的选择可能是将其添加到由`ccflags`返回的文件中的条目中

```
perl -E'require "Config_heavy.pl"; say $INC{"Config_heavy.pl"};' 
```

否则，肯定有办法将其指定给[ExtUtis::MakeMaker](http://search.cpan.org/perldoc?ExtUtils%3a%3aMakeMaker)和[Module::Build](http://search.cpan.org/perldoc?Module%3a%3aBuild)安装程序。如果是这样，您可以`cpan`使用`o conf makepl_arg`and进行设置`o conf mbuildpl_arg`。（别忘了提交！）

# .net - 绑定到子实体集的子绑定源不更新

> ID：12100229
> 
> 赞同：0
> 
> 时间：2012-08-23T21:27:00.077
> 
> 标签：.net, winforms, linq-to-sql, bindingsource

我有一个表 SampleData，它有一个子表 Measurements。在我的 WinForm frmMain 上，一个 SampleData 对象绑定到 SampleDataBindingSource；MeasurementsBindingSource 将 SampleDataBindingSource 作为其数据源，将 Measurements 作为其 DataMember。一组文本框绑定到 SampleDataBindingSource；datagridview 绑定到 MeasurementsBindingSource。

对于 frmMain，我还有一个演示者类 preMain，它包含一个 SampleData 类型的属性 CurrentSample。`SampleDataBindingSource.DataSource`绑定到 preMain 的 CurrentSample 属性 。

当 Measurements 中的属性足够多时，它会计算 FiringFactor，如果 FiringFactor 不为 1，它会将另一个 Measurement 项添加到 CurrentSample 的 Measurement 实体集中：

```
Partial Class Measurement

    Private Sub UpdateFiringFactor()
        Dim necessaryDataIsAvailable As Boolean = (Me.CrucibleMass IsNot Nothing And _
                                                   Me.CrucibleSampleFiredMass IsNot Nothing And _
                                                   Me.CrucibleSampleMass IsNot Nothing)
        If necessaryDataIsAvailable Then
            Me.FiringFactor = CDbl((Me.CrucibleSampleFiredMass - Me.CrucibleMass) / (Me.CrucibleSampleMass - Me.CrucibleMass))
            If Me.FiringFactor <> 1 Then
                Me.SampleData.AddNewMeasurement()
            End If
        End If
    End Sub

    Private Sub OnCrucibleMassChanged()
        UpdateFiringFactor()
    End Sub

    Private Sub OnCrucibleSampleFiredMassChanged()
        UpdateFiringFactor()
    End Sub

    Private Sub OnCrucibleSampleMassChanged()
        UpdateFiringFactor()
    End Sub
End Class 
```

当我在 datagridview 中输入 CrucibleMass、CrucibleSampleMass 和 CrucibleSampleFiredMass 的值时，UpdateFiringFactor 方法确实运行正确，并且我最终将另一个测量项添加到 CurrentSample 的测量实体集中。但是，datagridview 不显示新行，并且 MeasurementsBindingSource 只有 1 条记录（但是`CurrentSample.Measurements.Count = 2`）。

为什么变化`CurrentSample.Measurements`不传播到`MeasurementsBindingSource`？我已经尝试过`MeasurementsBindingSource.ResetBindings(False)`, `MeasurementsDataGridView.Refresh`, `SampleDataBindingSource.ResetBindings(False)`，但似乎没有任何更新`MeasurementsBindingSource`或其数据网格视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T00:02:14.833

这是我找到的实体集/绑定源问题的解决方案：

```
Imports System.ComponentModel

Partial Class Measurement

    Public Sub ChangeCrucibleMass(ByVal thisMass As Double)
        CrucibleMass = thisMass
        UpdateFiringFactor()
    End Sub

    Public Sub ChangeCrucibleSampleMass(ByVal thisMass As Double)
        CrucibleSampleMass = thisMass
        UpdateFiringFactor()
    End Sub

    Public Sub ChangeCrucibleSampleFiredMass(ByVal thisMass As Double)
        CrucibleSampleFiredMass = thisMass
        UpdateFiringFactor()
    End Sub

    Private Sub UpdateFiringFactor()
        If AllDataAreAvailable() Then
            FiringFactor = (CrucibleSampleFiredMass - CrucibleMass) / (CrucibleSampleMass - CrucibleMass)
            Me.Sample.OnMeasurementsChanged(Nothing, Nothing)
        End If
    End Sub

    Private Function AllDataAreAvailable() As Boolean
        AllDataAreAvailable = False
        Dim allFieldsHaveValue As Boolean = (CrucibleMass IsNot Nothing And CrucibleSampleFiredMass IsNot Nothing And CrucibleSampleMass IsNot Nothing)
        If allFieldsHaveValue Then
            Dim denominatorIsNotZero As Boolean = (CrucibleSampleMass - CrucibleMass) <> 0
            Return denominatorIsNotZero
        End If

    End Function

End Class

Partial Class Sample

    Public Sub OnMeasurementsChanged(ByVal sender As Object, ByVal e As System.ComponentModel.PropertyChangedEventArgs) Handles Me.PropertyChanged
        If Me.Measurements.Count > 0 AndAlso Me.Measurements.Last.FiringFactor IsNot Nothing AndAlso Me.Measurements.Last.FiringFactor <> 1 Then
            Me.Measurements.Add(New Measurement With {.CrucibleMass = Me.Measurements.Last.CrucibleMass})
            RaiseEvent RefreshMeasurementsBinding()
        End If
    End Sub

    Private Sub OnCreated()
        Me.Measurements.Add(New Measurement)
    End Sub

    Public Event RefreshMeasurementsBinding()

End Class 
```

这是表单的屏幕截图：

![在此处输入图像描述](../Images/1d66ba779904a515d1038c752122808e.png)

和代码隐藏：

```
Imports System.ComponentModel

Public Class Form1

    Private WithEvents newSample As Sample

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        newSample = SampleConduit.GetSample(1)
        'newSample = New Sample
        Me.SampleBindingSource.DataSource = newSample
        OnRefreshMeasurementsBinding()

    End Sub

    Private Sub OnRefreshMeasurementsBinding() Handles newSample.RefreshMeasurementsBinding
        Me.MeasurementsBindingSource.DataSource = newSample.Measurements.GetNewBindingList
    End Sub

    Private Sub MeasurmentsDataGridView_CellClick(ByVal sender As Object, ByVal e As System.Windows.Forms.DataGridViewCellEventArgs) Handles MeasurmentsDataGridView.CellClick
        Me.MeasurementsBindingSource.EndEdit()
        Dim currentMeasurement = CType(Me.MeasurementsBindingSource.Current, Measurement)
        Select Case e.ColumnIndex
            Case 0
                currentMeasurement.ChangeCrucibleMass(GetMeasurement)
            Case 1
                currentMeasurement.ChangeCrucibleSampleMass(GetMeasurement)
            Case 2
                currentMeasurement.ChangeCrucibleSampleFiredMass(GetMeasurement)
        End Select
    End Sub

    Private Function GetMeasurement() As Double
        Return CDbl(InputBox("Measurement:", "Get Measurement", "0"))
    End Function

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSave.Click
        Dim currentSample = CType(Me.SampleBindingSource.Current, Sample)
        SampleConduit.SaveSample(currentSample)
    End Sub
End Class 
```

解决方案取决于 Sample 类中的 RefreshMeasurementsBinding 事件和表单中的 OnRefreshMeasurementsBinding 方法。经常将 MeasurementsBindingSource 设置为 Measurements 实体集上的 GetNewBindingList 方法似乎有点笨拙，但它确实有效。

请参阅此论坛帖子中关于 EntitySets 和 BindingSource 和 GetNewBindingList 的 Item#3：

[http://www.infragistics.com/community/forums/t/43526.aspx](http://www.infragistics.com/community/forums/t/43526.aspx)

# amazon-ec2 - 是否有针对 Amazon Linux AMI 版本的新闻源？

> ID：12100230
> 
> 赞同：3
> 
> 时间：2012-08-23T21:27:10.693
> 
> 标签：amazon-ec2, amazon-web-services

这是一个非常平凡的问题，提前抱歉。我只是在寻找*只*包含新的 Amazon Linux AMI 版本的新闻提要。[亚马逊网络服务博客](http://aws.typepad.com)订阅源似乎包含这些版本，但为新的 AMI 提供专用订阅源仍然会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T08:44:12.137

[安全公告页面](http://aws.amazon.com/amazon-linux-ami/security-bulletins/)上有一个 RSS 图标。如果您愿意，也有一些机器人可以将这些条目重新发布到[Twitter](https://twitter.com/AmznLinuxSec)和[Facebook 。](https://www.facebook.com/amznlinuxsec)

# jquery - Eric Hynds jQuery UI 多选小部件：复选框宽度等于每个项目的文本宽度

> ID：12100232
> 
> 赞同：0
> 
> 时间：2012-08-23T21:27:14.367
> 
> 标签：jquery

我使用 Eric Hynds 的多选小部件，但 Checkbox 的宽度等于文本的宽度时存在问题。以下是我的代码：

包含的文件列表

```
<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
<link href="../../Content/themes/redmond/jquery-ui-1.8.2.custom.css" rel="stylesheet" type="text/css" />
<link href="../../Content/themes/redmond/ui.jqgrid.css" rel="stylesheet" type="text/css" />
<link href="../../Content/themes/base/jquery.ui.button.css" rel="stylesheet" type="text/css" />

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js" type="text/javascript"></script>

<link href="../../Content/jquery.multiselect.css" rel="stylesheet" type="text/css" />

<script src="../../Scripts/grid.locale-en.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.jqGrid.min.js" type="text/javascript"></script>
<script src="../../Scripts/grid.common.js" type="text/javascript"></script>
<script src="../../Scripts/grid.formedit.js" type="text/javascript"></script>
<script src="../../Scripts/jqModal.js" type="text/javascript"></script>
<script src="../../Scripts/jqDnR.js" type="text/javascript"></script>

<script src="../../Scripts/dropmenu.js" type="text/javascript"></script>
<script src="../../Scripts/jquery.multiselect.js" type="text/javascript"></script>
<link href="../../Content/style.css" rel="stylesheet" type="text/css" />
<script src="../../Scripts/Common.js" type="text/javascript"></script> 
```

控件的 HTML：

```
<select id="SchemaName" multiple="multiple"></select> 
```

填充控件的代码。我正在使用 AJAX 调用，因为数据来自数据库。我在 stackoverflow 上的一个示例中找到了此代码。

```
var $SchemaName_multiselect = jQuery('select#SchemaName').multiselect();
$SchemaName_multiselect.multiselect({ selectedList: 1 });

jQuery.ajax({
    type: "GET",
    url: "/Controller/Action",
    data: "",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function OnPopulateControl(data, response) {
        if (data.length > 0) {
            jQuery.each(data, function () {
                jQuery('select#SchemaName').append(jQuery("<option></option>").val(this['Value']).html(this['Text']));
            });
        } else {
            jQuery("select#SchemaName").empty().append('<option selected="selected" value="0">Not available<option>');
        }
        jQuery("select#SchemaName").multiselect('refresh');

        jQuery('select#SchemaName').unbind('multiselectclick').bind('multiselectclick', function (event, ui) {

            //ToDo: when the selection has changed.

            }

        });

    },
    error: function (data, response) {
        alert('Error: ' + response);
    }
}); 
```

以下是截图：

![多选问题](../Images/9cc43882ab59a2e0baff5b7d22c089e2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T01:19:13.827

您是否尝试过在代码中替换：

```
 jQuery('select#SchemaName').append(jQuery("<option value=". val(this['Value']). "  selected='selected'>" .html(this['Text']) . "</option> "); 
```

?

# xcode - clang 静态分析器会与返回状态约定混淆吗？

> ID：12100238
> 
> 赞同：0
> 
> 时间：2012-08-23T21:27:55.123
> 
> 标签：xcode, compiler-errors, llvm, clang, unzip

来自：[https ://github.com/cocos2d/cocos2d-x/blob/gles20/cocos2dx/support/zip_support/unzip.cpp](https://github.com/cocos2d/cocos2d-x/blob/gles20/cocos2dx/support/zip_support/unzip.cpp)

unzip.cpp 和 unzip.h 看起来既旧又稳定，但我得到以下 LLVM SA 逻辑错误：

```
cocos2dx/support/zip_support/unzip.cpp
cocos2dx/support/zip_support/unzip.cpp:1186:5：分配的值是垃圾或未定义
cocos2dx/support/zip_support/unzip.cpp:796:12：调用“unzOpenInternal”
cocos2dx/support/zip_support/unzip.cpp:585:1：输入来自“unzOpen”的调用
cocos2dx/support/zip_support/unzip.cpp:687:13: 假设 'central_pos' 不等于 0
cocos2dx/support/zip_support/unzip.cpp:697:13：调用'unz64local_getLong'
cocos2dx/support/zip_support/unzip.cpp:267:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:275:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:275:11：从'unz64local_getByte'返回
cocos2dx/support/zip_support/unzip.cpp:279:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:279:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:283:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:283:15：从'unz64local_getByte'返回
cocos2dx/support/zip_support/unzip.cpp:287:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:287:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:697:13：从'unz64local_getLong'返回
cocos2dx/support/zip_support/unzip.cpp:701:13：调用'unz64local_getShort'
cocos2dx/support/zip_support/unzip.cpp:240:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:248:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:248:11: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:252:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:252:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:701:13：从'unz64local_getShort'返回
cocos2dx/support/zip_support/unzip.cpp:705:13：调用'unz64local_getShort'
cocos2dx/support/zip_support/unzip.cpp:240:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:248:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:248:11: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:252:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:252:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:705:13: 从 'unz64local_getShort' 返回
cocos2dx/support/zip_support/unzip.cpp:709:13：调用'unz64local_getShort'
cocos2dx/support/zip_support/unzip.cpp:240:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:248:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:248:11: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:252:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 不等于 1
cocos2dx/support/zip_support/unzip.cpp:252:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:709:13：从'unz64local_getShort'返回
cocos2dx/support/zip_support/unzip.cpp:714:13：调用'unz64local_getShort'
cocos2dx/support/zip_support/unzip.cpp:240:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:248:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:248:11: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:252:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:252:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:714:13：从'unz64local_getShort'返回
cocos2dx/support/zip_support/unzip.cpp:724:13：调用'unz64local_getLong'
cocos2dx/support/zip_support/unzip.cpp:267:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:275:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:275:11：从'unz64local_getByte'返回
cocos2dx/support/zip_support/unzip.cpp:279:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:279:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:283:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:283:15：从'unz64local_getByte'返回
cocos2dx/support/zip_support/unzip.cpp:287:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:287:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:724:13: 从 'unz64local_getLong' 返回
cocos2dx/support/zip_support/unzip.cpp:730:13：调用'unz64local_getLong'
cocos2dx/support/zip_support/unzip.cpp:267:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:275:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:275:11：从'unz64local_getByte'返回
cocos2dx/support/zip_support/unzip.cpp:279:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:279:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:283:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:283:15：从'unz64local_getByte'返回
cocos2dx/support/zip_support/unzip.cpp:287:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getLong”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:287:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:730:13：从'unz64local_getLong'返回
cocos2dx/support/zip_support/unzip.cpp:735:13：调用'unz64local_getShort'
cocos2dx/support/zip_support/unzip.cpp:240:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:248:11：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:248:11: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:252:15：调用'unz64local_getByte'
cocos2dx/support/zip_support/unzip.cpp:213:1：输入来自“unz64local_getShort”的调用
cocos2dx/support/zip_support/unzip.cpp:217:9: 假设 'err' 等于 1
cocos2dx/support/zip_support/unzip.cpp:252:15: 从 'unz64local_getByte' 返回
cocos2dx/support/zip_support/unzip.cpp:735:13：从'unz64local_getShort'返回
cocos2dx/support/zip_support/unzip.cpp:760:9：调用“unzGoToFirstFile”
cocos2dx/support/zip_support/unzip.cpp:1179:1：输入来自“unzOpenInternal”的调用
cocos2dx/support/zip_support/unzip.cpp:1186:5：分配的值是垃圾或未定义
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:11:25.220

看起来它在调用之前被 unzOpenInternal 中的结构赋值弄糊涂了。不确定后续对 unzFile 的强制转换和在另一个函数中的强制转换对它有多大影响。

由于代码看起来正确，您可能需要向 clang 组和/或 Apple 提交错误报告。

# java - Java列出连接到数据库的参数？

> ID：12100246
> 
> 赞同：0
> 
> 时间：2012-08-23T21:28:49.197
> 
> 标签：java, mysql, database, jdbc

这是我的数据库的代码，它给出了这个错误`java.sql.SQLException: Parameter index out of range 1 > number of parameters`，它是 0

我将把需要保存的代码放在我的数据库中：

```
PedidoDTO nuevoPedido = new PedidoDTO();
nuevoPedido.setFolio("323423"); 
nuevoPedido.setFecha(new Date());
nuevoPedido.addDetalle(detalle1); 
nuevoPedido.addDetalle(detalle2); 
nuevoPedido.addDetalle(detalle3);  
long pedidoId =dao.guardar(nuevoPedido); 
System.out.println( "ID del nuevo pedido: " + pedidoId );

public long guardar(PedidoDTO obj) throws SQLException {

    PedidoDTO dto = new PedidoDTO();
    String url="jdbc:mysql://127.0.0.1:3306/capacitacion?user=capacitacion&password=password";

    try {
        System.out.println("Hola");
        Connection con = DriverManager.getConnection(url);
        String sentenciaSQL = 
        "INSERT INTO capacitacion .pedido (fecha, total, folio) VALUES (" 
            + obj.getFecha() + ", " + obj.getTotal() + ", " + obj.getFolio() + ")";
            PreparedStatement s =  con.prepareStatement(sentenciaSQL);
            //s.setInt(1, obj.getId()); 
            s.setLong(1, obj.getFecha()); 
            s.setDouble(2, obj.getTotal()); 
            s.setString(3, obj.getFolio()); 
            s.execute(); 
            for(PedidoDetalleDTO detalle:obj.getPedidoDetalle()){
                dto.getId();
                dto.getFecha();
                dto.getTotal();
                dto.getFolio();
            }con.close();
    } catch (SQLException e) {
        System.out.println(e);
    }
    return dto.getId();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:32:47.547

```
VALUES (" 
            + obj.getFecha() + ", " + obj.getTotal() + ", " + obj.getFolio() + ") 
```

应该

```
VALUES (?,?,?) 
```

当您使用preparedstatement时，您将使用`s.set...(..)`

阅读本教程，了解如何使用[preparedstatements](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:33:53.593

替换这个：

```
 "INSERT INTO capacitacion .pedido (fecha, total, folio) VALUES (" 
        + obj.getFecha() + ", " + obj.getTotal() + ", " + obj.getFolio() + ")"; 
```

有了这个：

```
 "INSERT INTO capacitacion .pedido (fecha, total, folio) VALUES (? , ? , ? )"; 
```

这是构建参数化 Prepared 语句的方法。? 是您的参数的占位符。

# internet-explorer - PNG在IE8中显示灰色背景

> ID：12100254
> 
> 赞同：0
> 
> 时间：2012-08-23T21:29:32.977
> 
> 标签：internet-explorer, png, transparency

goo.gl/PMvYn

除了 IE8 及以下版本，PNG 似乎在所有浏览器中都能正常显示。任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:33:50.550

IE8 及以下不直接支持 PNG 透明度。

但是，这里有一个适用于 IE7 和 IE8 的解决方法：

[https://stackoverflow.com/a/3999844/141172](https://stackoverflow.com/a/3999844/141172)

# scheme - Bigloo 方案中高阶函数的静态签名

> ID：12100256
> 
> 赞同：1
> 
> 时间：2012-08-23T21:29:53.837
> 
> 标签：scheme, bigloo

有谁知道如何在 Bigloo 方案语言的模块导出部分中为高阶函数创建静态签名？

这是我走了多远

```
(module test
  (export (adder ::double)))

(define (adder x)
  (lambda (y)
    (set! x (+ x y))
    x)) 
```

以下将起作用，但我想将所有类型数据保留在模块声明中

```
(module test
  (export (adder ::double)))

(define (adder x)
  (lambda (y::double)::double
    (set! x (+ x y))
    x)) 
```

# iphone - CAShapeLayer 不是圆角，并且笔划不在顶部

> ID：12100281
> 
> 赞同：1
> 
> 时间：2012-08-23T21:31:58.267
> 
> 标签：iphone, objective-c, ios

大家好，我已经创建了这个框，基本上角半径不起作用，并且笔划也没有显示在形状的顶部。反正有没有让这个工作？

```
UIBezierPath* conPath = [UIBezierPath bezierPath];
[conPath moveToPoint:CGPointMake(conX, conY)];
[conPath addLineToPoint:CGPointMake(conX, conY+50)];
[conPath addLineToPoint:CGPointMake(conX+220, conY+50)];
[conPath addLineToPoint:CGPointMake(conX+220, conY)];

CAShapeLayer* conLayer = [CAShapeLayer layer];
conLayer.path = conPath.CGPath;
conLayer.cornerRadius = 5.0;
UIColor *bg = [UIColor colorWithWhite:1 alpha:0.7];
[conLayer setFillColor:bg.CGColor];
[conLayer setStrokeColor:[UIColor grayColor].CGColor];
[[self layer] addSublayer:conLayer]; 
```

# c++ - 字符串转换：MBCS <-> UNICODE 内有多个 \0

> ID：12100283
> 
> 赞同：1
> 
> 时间：2012-08-23T21:32:00.593
> 
> 标签：c++, windows, unicode, msdn, multibyte-functions

我正在尝试将包含来自位图文件的数据的 std::string 缓冲区转换为 std::wstring。

我正在使用`MultiByteToWideChar`，但这不起作用，因为该函数在遇到第一个 - 字符后停止`'\0'`。似乎它将其解释为字符串的结尾。

当我不传递 -1 作为长度参数，而是传递 std::string-Buffer 中数据的实际长度时，它会将 Unicode-String 与原始字符串中明显未出现在该位置的字符混淆.. .

我必须编写自己的转换函数吗？或者也许我应该将数据保留为一个随意的字符数组，因为特殊符号将被错误地转换？

带着敬意

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:52:51.197

这种方法会失败很多**很多**事情。除此之外，额外的字节可能会在您没有意识到的情况下添加到您的数据中。

奇怪的是，您唯一的选择需要一个`std::wstring()`. 如果这是一个自制的库，您应该不厌其烦地编写一个新函数。如果不是，请确保在编写自己的之前没有更合适的。

# c# - MVC 3.0 地图路由编码

> ID：12100287
> 
> 赞同：0
> 
> 时间：2012-08-23T21:32:25.403
> 
> 标签：c#, asp.net-mvc-3, asp.net-mvc-routing, maproute

我正在编写一个新的 MVC 应用程序；我想对路由进行一些更改以将部门名称添加到 URL。

以下是 VS 2012 生成的内容。

```
 routes.IgnoreRoute("{resource}.axd/{*pathInfo}")

    routes.MapRoute( _
        name:="Default", _
        url:="{controller}/{action}/{id}", _
        defaults:=New With {.controller = "Home", .action = "Index", .id = UrlParameter.Optional} _
    ) 
```

我想在路径的开头传递部门名称。前任。

> http://localhost:/hr/Home/Contact
> 
> http://localhost /hr/Home/关于
> 
> http://localhost /finance/Home/Contact
> 
> http://localhost /finance/首页/关于
> 
> http://localhost /marketing/Home/Contact
> 
> http://localhost /marketing/首页/关于

而不是默认页面：

> http://localhost/Home/关于 http://localhost/Home/Contact

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:37:38.770

这应该很简单；添加`department`到路线的开头：

```
routes.MapRoute( _
    name:="DepartmentRoute", _
    url:="{department}/{controller}/{action}/{id}", _
    defaults:=New With {.controller = "Home", .action = "Index", .id = UrlParameter.Optional} _
) 
```

您可能还想添加一个约束以确保它只匹配部门名称：

```
 constraints:=New With { .department = @"[hr|finance|marketing]" } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:05:36.253

在 URL 中包含部门名称后，有两种方法可以访问部门名称。一种方法是像这样使用属性 RouteData.Values：

```
string department = RouteData.Values["department"]; 
```

另一种方式更优雅。如果我们使用与 URL 模式变量匹配的名称为操作方法定义参数，则 MVC 框架将从 URL 获得的值作为参数传递给操作方法。

```
 public ViewResult Index(string department) {
      ViewBag.Department = department;
      return View();
   } 
```

# sql - 在 Oracle 8i 中连接表以限制结果

> ID：12100294
> 
> 赞同：0
> 
> 时间：2012-08-23T21:32:36.490
> 
> 标签：sql, oracle

我在 SQL 方面的背景有限，但我的谷歌搜索却不是，我觉得我可能只是缺少正确提出这个问题的词汇，所以希望除了回答我的问题之外，我还可以获得进一步研究这个问题所需的词汇。

我有一个零件表 - PARTS 我有一个采购订单表 - PO，我有一个 PO 行项目表 - PO_LINEITEM

我试图回答的问题是给定一个特定的部分，我想获得最新的采购订单，然后查看我们支付的价格。

PO 表保存填写采购订单的日期 (PO_DATE)，PO_LINEITEM 表保存有关特定行项目的信息，例如部件主键 (PART_PRIMARYKEY) 和价格 (PART_PRICE)。PARTS 表并不像其他表那么重要，只是我需要返回一个 PART 主键，以便我可以将结果视图基于 PARTS 表

我已经通过子查询和可扩展的子查询等，但我似乎无法找到正确的组合。

我从以下基础开始：

```
SELECT a.PO_DATE, b.PART_PRIMARYKEY, b.PART_PRICE
FROM PO a, PO_LINEITEM b
WHERE a.PO_PRIMARYKEY = b.PO_PRIMARYKEY 
```

正如您所期望的，这将返回 PO 中每个对象实例的列表，其中包含价格和采购订单的填写日期。我最接近解决这个问题的方法是在日期使用 MAX 函数，例如：

```
SELECT MAX(a.PO_DATE) AS DATE, b.PART_PRIMARYKEY, b.PART_PRICE
FROM PO a, PO_LINEITEM b
WHERE a.PO_PRIMARYKEY = b.PO_PRIMARYKEY
GROUP BY b.PART_PRIMARYKEY, b.PART_PRICE 
```

这将返回我们为特定零件支付的每个价格的最大日期，因此：

PART 1234, £12.95, 12/08/2012
PART 1234, £13.00, 14/08/2012
PART 1234\. £11.15, 17/08/2012
PART 2345, £5.25, 12/08/2012
PART 2345, £5.65, 2012 年 13 月 8 日
等

我需要的是：

第 1234 部分，11.15 英镑，2012 年8 月 17 日第 2345
部分。5.65 英镑，2012 年 8月 13 日

如果我可以按 PART_PRIMARYKEY 进行分组，那就太好了，但是当我尝试时，我得到一个 ORA-00979 而不是 GROUP BY 表达式。

就像我说的那样，我觉得我在这个问题上缺乏词汇量阻碍了我找到答案，所以如果有人能指出我正确的方向，我将不胜感激

所以希望我不是问一个每隔一天就会被问到的问题，但因为我没有使用神奇的单词组合来找到，所以没有找到。

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:54:03.083

查找分析函数。它们是在 8i 中引入的，尽管我不确定它们在当时的先进程度与它们在 11 中的表现相比有多好。我用来理解它们的一些链接：

[http://www.oracle-base.com/articles/misc/analytic-functions.php](http://www.oracle-base.com/articles/misc/analytic-functions.php)

[http://www.orafaq.com/node/55](http://www.orafaq.com/node/55)

不过，这样的子查询可能就足够了（我可能会混淆您的列命名）：

```
select A.PART_PRIMARYKEY, B.PART_PRICE, A.PO_DATE
  from PO A, PO_LINEITEM B
 where A.PO_PRIMARYKEY = B.PO_PRIMARYKEY
       and (A.PART_PRIMARYKEY, A.PO_DATE) in
             (  select A.PART_PRIMARYKEY, max(A.PO_DATE)
                  from PO A, PO_LINEITEM B
                 where A.PO_PRIMARYKEY = B.PO_PRIMARYKEY
              group by A.PART_PRIMARYKEY); 
```

# ruby-on-rails-3 - 检测表单是否使用 ruby on rails 提交？

> ID：12100295
> 
> 赞同：4
> 
> 时间：2012-08-23T21:32:37.177
> 
> 标签：ruby-on-rails-3, forms, submit

有没有办法检测表单是否提交？我试图根据自定义验证设置一个类，如下例所示，这可能吗？

```
 .control-group{ :class => ("error" if form_is_submitted ) } 
```

现在尝试：

```
 .control-group{ :class => ("error" if params[:user][:profile_attributes][:gender] == nil) } 
```

如果未提交表单，则会失败，因为参数为 nill 并引发错误

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-24T00:10:11.990

*如果您的表单数据是通过具有(都具有**前缀)*`name`等属性的字段提交的，您可以检查是否存在于.`user[profile_attributes][gender]` *`user`*`:user``params`

```
... if params.include?(:user) 
```

如果出于某种原因*（例如来自路由）* `params[:user]`即使对于请求也已经有了值`GET`，您可以查找具有值的特定表单字段。例如，您可以添加一个隐藏字段

```
<%= f.hidden_field :some_field, :value => true %> 
```

并在您的情况下检查**它**

```
... if params[:user].include?(:some_field) 
```

* * *

您也可以检查请求是否通过该`POST`方法

```
... if request.post? 
```

这也适用于其他方法，例如`request.put?`更新方法。

# path - 什么是“规范路径”？

> ID：12100299
> 
> 赞同：100
> 
> 时间：2012-08-23T21:32:50.440
> 
> 标签：path, filepath, relative-path, absolute-path

因此，*绝对路径*是一种到达某个文件或位置的方法，该文件或位置描述了到它的完整路径、完整路径以及它与操作系统相关的内容（例如，Windows 和 Linux 的绝对路径是不同的）。另一方面，*相对路径*是从当前位置（两个点）描述的文件或位置的路径，`..`表示目录树中的上级。多年来，我一直很清楚这一点。

在搜索时，我什至看到也有规范化的文件！我所知道的是，CANONICAL 意味着“根据规则”之类的东西。

有人可以启发我关于规范事物的理论吗？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-08-23T21:38:10.907

制作*任何*“规范”的全部目的是让您可以比较两件事。例如，两者`../../here/bar/x`和`./test/../../bar/x`可能都指向同一个位置，但您不能对这两个路径进行文本比较。然而，如果你把它们变成它们的规范表示，它们都变成`../bar/x`，我们看到它们实际上指的是同一个东西。

简而言之，通常情况下，您有多种方式来引用一件事，在这种情况下，您可以定义一个*唯一的**规范表示*，并允许您处理此类事物的集合。

 *（如果您正在寻找更多示例，所有数学都充满了各种对象的“规范”构造，并且非常具有相同的目的。也许这篇[维基百科文章](http://en.wikipedia.org/wiki/Canonical_form)可以提供一些额外的方向。）

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-08-23T21:38:38.823

定义规范路径的一个好方法是：（`the shortest absolute path`短，在字符串长度的含义中）。

这是绝对路径和规范路径之间差异的示例：

绝对路径： `C:\abc\..\abc\file.txt`
规范路径：`C:\abc\file.txt`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-23T21:44:51.220

什么是规范路径（或其与绝对路径的区别）取决于系统。
通常，如果（完整）路径包含别名、快捷方式或符号链接，则规范路径会将所有这些解析为它们所引用的实际目录。
示例：如果`/bin/a`是符号链接，您可以在任何您请求绝对路径的地方找到它，例如从[java.io.File#getAbsolutePath](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#getAbsolutePath%28%29)而真实文件（即链接的实际目标）即`usr/local/bin/a`作为规范路径返回，例如来自[java.io.File#getCanonicalPath](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#getCanonicalPath%28%29)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-01-31T09:11:41.443

当您传递目录而不是文件的名称时，会出现规范路径的大多数问题。对于文件，如果我们提供的绝对路径也是规范路径。但对于 dir，它意味着省略最后一个“/”。例如，“/var/tmp/foo”是规范路径，而“/var/tmp/foo/”不是。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-11-04T07:14:14.997

GNU Coreutils的[文档](https://www.gnu.org/software/coreutils/manual/html_node/readlink-invocation.html#readlink-invocation)中给出了规范路径的良好定义。`readlink`指定“规范化模式”返回不包含任何这些内容的等效路径：

1.  指向自身 (.) 和父 (..) 目录的[硬链接](https://askubuntu.com/a/56157)
2.  重复的分隔符 (/)
3.  符号链接

字符串长度无关紧要，如以下示例所示。

如果您正在运行 linux 或使用 GNU Coreutils ，您可以尝试`readlink -f`（规范化模式）或其首选等效命令`realpath`，以查看系统上某些程序的“绝对路径”和“规范绝对路径”之间的区别。

我可以使用在我的系统上获取“java”的路径`which`

```
$ which java
/usr/bin/java 
```

然而，这条路径实际上是指向另一个符号链接的符号链接。此符号链接链可以使用 显示`namei`。

```
$ namei $(which java)
f: /usr/bin/java
 d /
 d usr
 d bin
 l java -> /etc/alternatives/java
   d /
   d etc
   d alternatives
   l java -> /usr/lib/jvm/java-17-openjdk-amd64/bin/java
     d /
     d usr
     d lib
     d jvm
     d java-17-openjdk-amd64
     d bin
     - java 
```

可以使用前面提到的`realpath`命令找到规范路径。

```
$ realpath $(which java)
/usr/lib/jvm/java-17-openjdk-amd64/bin/java 
```*

# navigation - Fancybox：在所有画廊图像上显示两个导航箭头，“上一个”和“下一个”分别在第一张和最后一张图像上变暗（但可见）

> ID：12100307
> 
> 赞同：0
> 
> 时间：2012-08-23T21:33:08.707
> 
> 标签：navigation, fancybox, fancybox-2

在我的 Fancybox 库中，我修改了 Fancybox CSS 以始终显示导航箭头（不仅仅是悬停时），并将不透明度设置为悬停时从 0.7 增加到 1.0。但是，上一个和下一个箭头不会分别出现在第一张和最后一张图像上，因为它们不起作用（我将“循环”设置为“假”）。在这些图像上只显示两个箭头中的一个会使导航看起来不平衡，所以我希望两个箭头始终显示，但希望非功能箭头比处于非悬停状态的功能箭头更透明，比如 0.3 ，以便用户理解它是不可操作的。

我通过更改此代码更改了 js：

```
if (current.loop || current.index > 0) {
$(current.tpl.prev).appendTo(F.outer).bind('click.fb', F.prev);} 
```

对此：

```
if (current.loop || current.index >= 0) {
$(current.tpl.prev).appendTo(F.outer).bind('click.fb', F.prev);} 
```

并为“下一个”箭头做了同样的事情。

这确实会导致两个箭头都出现，但我无法弄清楚如何让第一张和最后一张图像上的非功能按钮看起来比功能按钮更暗。这是一个示例页面（我恢复为原始 js，因此用户不会感到困惑）： [http ://transweb.sjsu.edu/mntrc/events/2012/gallery1.html](http://transweb.sjsu.edu/mntrc/events/2012/gallery1.html)

任何帮助实现这一点将不胜感激。我是js-impaired（但不是css-impaired），所以请给出完整的代码示例，说明如何将其集成到我当前的代码中。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T06:24:26.367

您很可能知道，要显示永久可见的导航箭头，您可以设置此 css 规则

```
.fancybox-nav span {
  visibility: visible;
} 
```

`loop`这将，或者当然，仅在存在上一个或下一个元素时显示上一个/下一个导航箭头（例如，如果设置为，上一个箭头不会与画廊的第一个元素一起显示`false`）

为了**始终显示“***非功能性*”箭头（并且变暗），您可以使用自定义 fancybox 脚本中的回调即时附加它们，例如：**`beforeShow`**

 **```
beforeShow: function(){
 // evaluates if this is the FIRST element of the gallery
 // if so, appends a dimmed (non-functional) PREVIOUS navigation arrow
 if(this.index == 0) {
   $(this.tpl.prev).appendTo($.fancybox.outer).css({"opacity":0.6});
 } else 
 // evaluates if this is the LAST element of the gallery
 // if so, appends a dimmed (non-functional) NEXT navigation arrow
 if( this.index < this.group.length){
   $(this.tpl.next).appendTo($.fancybox.outer).css({"opacity":0.6});
 }
} 
```**

# mysql - 如何在mysql中按时间戳排序？

> ID：12100308
> 
> 赞同：3
> 
> 时间：2012-08-23T21:33:19.160
> 
> 标签：mysql

```
SELECT * FROM table ORDER BY timestamp; 
```

当我尝试按其时间戳对记录进行排序时，我得到以下顺序

```
08/20/2012 02:09:39 PM
08/20/2012 03:19:08 PM
08/20/2012 09:04:24 AM
08/20/2012 09:05:25 AM 
```

如何更改查询以使记录从 AM 到 PM 排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:41:10.487

问题是时间戳的字符串表示不是规范格式，也就是说，对字符串值进行排序不会按时间戳顺序排序。

要使行按顺序排序，您可以将值的字符表示转换为 DATETIME 或 TIMESTAMP 数据类型，或者至少转换为规范格式的字符表示（例如，'YYYY-MM-DD hh:mm:ss' 24 小时制）。

该`STR_TO_DATE`函数可用于将已知格式的字符串表示形式转换为 DATETIME：

```
SELECT * FROM table
ORDER BY STR_TO_DATE(`timestamp`,'%m/%d/%Y %h:%i:%s %p') 
```

[http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format) [http://dev.mysql.com/doc/refman/5.1/en/date -and-time-functions.html#function_str-to-date](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_str-to-date)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T21:43:41.283

你会想要使用[`STR_TO_DATE()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)

```
select *
from dates
order by STR_TO_DATE(dt,'%m/%d/%Y %h:%i:%s') desc 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/77913/9)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T21:37:40.257

只需添加`DESC`：

```
SELECT * FROM table ORDER BY timestamp DESC; 
```

# python - 如果从 python2.6 导入站点包以与 python2.7 一起使用，可能发生的问题？

> ID：12100310
> 
> 赞同：0
> 
> 时间：2012-08-23T21:33:24.430
> 
> 标签：python, import

我终于设法安装了 numpy，但它似乎只适用于 python2.6 。我不知道如何将它安装在 2.7 文件夹中（尝试了几个小时，但我在头几个月只是一个初学者）。无论如何，如果我使用 Python 2.7 并将绝对路径附加到 sys.path，会不会有问题？

有什么建议么？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:08:09.277

它可以*部分*工作，但这是一个坏主意。**只是不要这样做。**即使它看起来有效，也可能无效。如果确实如此，那么它将来会随机失败。

这些是我想到的潜在问题：

1.  扩展（用 C、C++ 等编写的）特定于特定的 Python 版本；numpy 有一些扩展，AFAICS。仅当您不使用其中任何一个（即使用纯 Python 模块）时，它才会起作用；
2.  Python 将模块编译成字节码。字节码特定于特定的 Python 版本。如果在 python2.7 中使用 python2.6 目录下的模块，编译后的文件会发生冲突。我怀疑这会导致重大问题，除非每次切换 Python 版本时都会重新编译它们；
3.  Python 代码可以是特定于版本的。次要版本不太可能（但例如 Python 2/3 可能存在严重差异），但仍然可能发生。换句话说，为 Python2.6 安装的模块实际上可能与为 Python2.7 安装的模块有些不同；
4.  如果更改加载顺序，Python2.7 可能会从 Python2.6 开始加载一些标准模块。它可以工作，它可能会导致随机破损；
5.  它将使为 Python2.6 安装的所有模块可见。它可能会在某个地方导致一些随机切换，结果无法预测。我怀疑该版本是否有特定内容，但某些模块实际上可能决定使用某种已弃用的界面，发现它可见。

可能还有更多。您实际上可能会尝试，但要做好准备，您可能会浪费大量时间来试图找出为什么某些事情以后不能按预期工作。

除非我遗漏了什么，否则我认为为 Python2.7 安装 numpy 主要涉及*使用*Python 2.7 运行设置；喜欢：

```
python2.7 setup.py clean
python2.7 setup.py build
python2.7 setup.py install 
```

根据您的特定安装/系统，最好使用包管理器、二进制包或类似的工具`pip`。如果您想了解更多关于如何使用这些命令强制执行 Python2.7 的详细信息，您必须告诉我们您选择哪一个。

# c# - 向客户发送消息并接收答案 + 对收到的答案采取行动

> ID：12100312
> 
> 赞同：0
> 
> 时间：2012-08-23T21:33:33.350
> 
> 标签：c#, wcf, callback

问题：服务器应该向客户端发送一个 SerialPort 命令（例如“S”）并从客户端接收端口。Readline 并像发送另一个命令（例如“r01”）一样。

示例：服务器发送“S”并从客户端接收“N”，因此服务器应该发送另一个“S”。如果它收到 != "N" 然后发送 "r01" 等等。

我可以向客户发送消息，但我无法收到答案并存储/使用它。

到目前为止我尝试了什么：

.) 将接收到的信息保存到 serv.connectedClients[ID].receive

服务器：工人阶级：

```
 public void doSomething(Service serv, string ID)
    { 
       serv.SendMessageToClient(client_name, "S");   //send first message                     
        data = serv.connectedClients[ID].receive.ToString(); //the .receive is empty but should have the clients answer stored
       if(data != ""){
          serv.SendMessageToClient(client_name, "r01");  //send second message
          serv.connectedClients[ID].Information = serv.connectedClients[ID].receive.ToString();
          }
    } 
```

在 Service.cs 中：

```
 public void getPortMsg(string msg)
    { 
        connectedClients[OperationContext.Current.Channel.SessionId].receive = msg;
    } 
```

在客户端：

```
 void callback_OnMessageReceivedEvent(string message)
    {
      string portmsg = "";
      portmsg = rfid.send(message); //portmsg gets the port.readline info
       client.getPortMsg(portmsg); //send portmsg to server

    } 
```

和 rfid.send：

```
 public string send(string senden)
    {

        string data = "";
        port.WriteLine(senden);
        data = port.ReadLine();

            return data;
      } 
```

命令：服务器向客户端发送消息。客户端收到消息并调用其中包含答案的服务方法。服务器应该使用这个答案，但在他得到答案之前发送下一条消息。

希望有人知道答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T10:56:04.660

我有一个答案。我不认为这是解决问题的最佳方法，但它有效：

服务器向客户端发送消息+方法的名称。

客户端处理消息并向服务器+方法名称写入答案。

服务器现在知道如何处理答案并调用正确的方法。

代码示例：

服务器：

```
public void methodA(){
   sendToClient("i want an answer",methodA);
} 
```

客户：

```
 public void callback_messageFromServer(string msg,string location){
     string answer = workWithMsg(msg);
     client.sendAnswer(answer,location);
 } 
```

服务器：

```
public void sendAnswer(string msg, string location) {
      if(location == "methodA")
          methodB(msg);
 } 
```

要调用相同的方法，我使用 int count 和 switch(count)。希望它可以帮助某人^^

此致

# android - 将 GIF 数据分配给 Bitmap 对象

> ID：12100314
> 
> 赞同：1
> 
> 时间：2012-08-23T21:33:41.777
> 
> 标签：android, graphics, bitmap

我在很多地方都读到过 Android 不支持原生 gif。结果，我的代码在`BitmapFactory.decodeByteArray`. 这是我的代码：

```
URL url = new URL(imgURL); //you can write here any link
HttpURLConnection ucon = (HttpURLConnection)url.openConnection();
InputStream is = ucon.getInputStream();
BufferedInputStream bis = new BufferedInputStream(is);          

ByteArrayBuffer baf = new ByteArrayBuffer(5000);
int current = 0;
  while ((current = bis.read()) != -1) {
  baf.append((byte) current);
}

image = BitmapFactory.decodeByteArray(baf.toByteArray(), 0, baf.toByteArray().length); 
```

使用调试器，我确认标题数据已正确加载并且是 GIF 格式。但是一旦解码函数运行，我就会得到一个空值。我的第一个猜测是我需要进行 GIF -> PNG 转换。我怎样才能做到这一点？还有其他选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:43:15.947

[http://code.google.com/p/android-gifview/](http://code.google.com/p/android-gifview/)上的 GifView 类运行良好。该项目适用于动画 gif，但它也适用于静态 gif。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T04:43:40.343

因此，尽管 Android 抱怨 GIF 和解码失败，但我认为问题在于我的代码中的其他故障。我所做的更改导致代码现在可以工作。

1.  确保我关闭了输入流
2.  删除了一个可能导致无限循环和线程生成的事件（这是我的解析规则失败，它从 HTML 源中提取了 GIF 文件列表）
3.  确保我`Bitmap`在对象中的文件存储在`List`使用之前始终正确转换。

[我通过这篇帖子](https://stackoverflow.com/questions/7553431/bitmapfactory-decode-function-for-android)找到了帮助和详细信息，这是一个几乎相同的问题。有一些链接可以解决这个问题。

最后，我根本没有触摸我的 Bitmap 或 InputStream 对象，数据被正确接收（根据我对 GIF 标头字节的确认），但之后*使用*数据失败。

# android - 有没有办法让 Activity 知道它是以什么 resultCode 启动的？

> ID：12100315
> 
> 赞同：0
> 
> 时间：2012-08-23T21:33:46.397
> 
> 标签：android, android-activity

环顾四周，我似乎找不到任何方法`Activity`来确定`resultCode`它是从什么开始的。例子：

```
class A extends Activity {
   void yadda() {
      Intent intent = new Intent(this, B.class);
      startActivityForResult(intent, 8675309);
   }
}

class B extends Activity {
   void yadda() {
      int code = getTheResultCode(); // I want to get 8675309
   }
} 
```

我必须把它放进去`Intent`吗？

```
intent.putExtra("resultCode", 8675309); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:36:17.437

在知道resultCode的Activity中：

```
 Intent i = new Intent(getApplicationContext(), NewActivity.class); 
  i.putExtra("resultCode",resultCode); 
  startActivity(i); 
```

在下一个活动中

```
 Bundle extras = getIntent().getExtras(); 
  if (extras != null) { 
     String resultCode= extras.getString("resultCode"); 
  } 
```

# git - Git 子模块（再一次）

> ID：12100319
> 
> 赞同：0
> 
> 时间：2012-08-23T21:34:10.080
> 
> 标签：git, git-submodules

我有与 git 子模块有关的复杂问题/案例。我在 github 和第三方子模块上有自己的 repo（由其他公司提供，只读）。我处理了初始化子模块，更新它，将 .gitsubmodule 和新文件夹添加到主仓库等 - 一切正常。现在我想对子模块文件进行一些更改，将新文件添加到子模块或类似的东西。我做到了，然后我从子模块目录级别执行了提交。我将文件夹更改为主仓库，git status 显示子模块文件夹中未提交的提交。所以…… `git commit -a`，。`git push`（当我在子模块目录中检查 git 状态时，我得到的信息是您的分支在 X 提交之前位于 'origin/master' 之前。）

当我从 github 对我的 repo 进行递归克隆时，我遇到了错误（我想是由子模块的更改引起的）：

```
fatal: reference is not a tree: c19485a57b5152959b9a916409ad5d901c44741d 
Unable to checkout 'c19485a57b5152959b9a916409ad5d901c44741d' in submodule path 'apt' 
```

所以，我的问题是：

1.  我可以在子模块中进行更改并将它们（和跟踪）推送到 github。
    *   如果是，我必须做什么，我可以将所有带有子模块的 repo 和其中的更改拉到另一个主机（一些工作流程？）。
    *   如果没有，我如何通过从我的 github 存储库级别查看子模块并拉到另一个主机来规避对子模块的更改
2.  有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:41:05.630

我认为您忘记`git push`从子模块内部运行。这必须在将提交推送到封闭项目之前完成，否则没有人将能够签出您更新的子模块（因为远程上不存在提交）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T23:05:18.817

问题是您想要更改您没有推送访问权限的第 3 方存储库。解决方案是制作您自己的该存储库的克隆——当您进行编辑时，您应该在该子存储库的上下文中提交它们并推送它们。外部存储库跟踪子模块的状态，但不应管理对子模块文件的更改。

因此，工作流解决方案是拥有您自己的 3rd 方 repo 的克隆，您确实有权访问该 repo。您应该将自己版本的 repo 作为子模块添加到您的项目中。我认为这个[答案](https://stackoverflow.com/a/679346/262078)将有助于消除对使用子模块的正确方法的一些困惑（有时这确实有点棘手）。

# javascript - TinyMCE 验证给出错误：无法调用未定义的方法“getContent”

> ID：12100320
> 
> 赞同：1
> 
> 时间：2012-08-23T21:34:10.573
> 
> 标签：javascript, jquery, asp.net-mvc, jquery-ui, tinymce

我有一个带有小 mce 的文本区域，我像这样加载它：

```
$(document).ready(function () {

    tinyMCE.init({
        mode: "textareas",
        ... 
```

这个文本区域是一个表格。我将表单提交按钮绑定到：

```
$('#btnSubmit').click(function() {

    tinymce.triggerSave();

    var editorContent = tinyMCE.get('Description').getContent();
    if (editorContent == '' || editorContent == null)
    {
        $(tinymce.activeEditor.getBody()).css("background-color", '#ffeeee');
        $(tinymce.activeEditor.getBody().parentNode).css("background-color", '#ffeeee');
        $(tinymce.activeEditor.getBody().parentNode).css("border", '1px solid #ff0000');
    }
}); 
```

在我的实体类中，我有`Required`属性。我的目标是在模型无效时
制作 tinyMCE 背景。`red`但我从 ti 问题标题中得到错误。
有什么帮助吗？
因此，验证有效。如果我删除 textarea 空检查并让颜色改变，它会改变。但是问题是当文本区域中有东西时，我点击提交区域首先变成红色然后提交。
如果验证失败，是否有一些功能可以让我做点什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-26T00:59:28.313

这听起来就像一个未定义的对象错误 - 代码无法解析这一行`tinyMCE.get('Description').getContent();`。

您似乎在`activeEditor`有时使用和有时不使用之间混合，所以我已经标准化了代码，所以您总是依赖`activeEditor`- 这意味着我已经删除了触发错误的行。您似乎也在使用`tinymce`和之间切换，`tinyMCE`这可能不会导致问题，但最好避免......所以我也将其标准化。

没有看到更多其他代码和标记的设置方式，但是很难准确地判断发生了什么。我的更改能解决问题吗？

```
$('#btnSubmit').click(function() {

  tinyMCE.triggerSave();

  var editorContent = tinyMCE.activeEditor.getContent();
  if (editorContent == '' || editorContent == null)
  {
    $(tinyMCE.activeEditor.getBody())
      .css("background-color", '#ffeeee')
      .parent()
      .css({
        "background-color": '#ffeeee',
        "border": '1px solid #ff0000'
      });
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T11:00:11.423

如果您无法控制 TinyMCE 的 init 方法，则可以遵循此解决方案。

```
jQuery(document).ready(function($) {

    function myCustomSetContent( id, content ) {
        // Check if TinyMCE is defined or not.
        if( typeof tinymce != "undefined" ) {
            var editor = tinymce.get( id );
            // Check if TinyMCE is initialized properly or not.
            if( editor && editor instanceof tinymce.Editor ) {
                editor.setContent( text );
                editor.save( { no_events: true } );
            } else {
                // Fallback
                // If TinyMCE is not initialized then directly set the value in textarea.
                //TinyMCE will take up this value when it gets initialized.
                jQuery( '#'+id ).val( text );
            }
            return true;
        }
        return false;
    }

    function myCustomGetContent( id ) {
        // Check if TinyMCE is defined or not.
        if( typeof tinymce != "undefined" ) {
            var editor = tinymce.get( id );
            // Check if TinyMCE is initialized properly or not.
            if( editor && editor instanceof tinymce.Editor ) {
                return editor.getContent();
            } else {
                // Fallback
                // If TinyMCE is not initialized then directly set the value in textarea.
                // TinyMCE will take up this value when it gets initialized.
                return jQuery( '#'+id ).val();
            }
        }
        return '';
    }

    $(".class-to-update-content").on("click", function(e) {
        myCustomSetContent( "tinymce-editor-id", "New Content in Editor" );
    });

    $(".class-to-get-content").on("click", function(e) {
        $("div.class-to-display-content").html( myCustomGetContent( "tinymce-editor-id" ) );
    });
}); 
```

参考：[http ://blog.incognitech.in/tinymce-undefined-issue/](http://blog.incognitech.in/tinymce-undefined-issue/)

# mobile - Yii 移动浏览器

> ID：12100322
> 
> 赞同：1
> 
> 时间：2012-08-23T21:34:32.063
> 
> 标签：mobile, yii, responsive-design

我打算使用 Yii 框架重建我现有的网站。我希望它对移动设备友好，所以我决定从通用的小屏幕尺寸开始（也许是移动 safari？）

我想我会在 Yii 中找到一个现成的选项，最好是*Uncomment this line in layout page for small-size display*。不在那里，文档中没有任何具体内容，[蓝图 css 站点](http://www.blueprintcss.org/)中也没有任何内容。

我在 Google上搜索`mobile yii`等等`'responsive web' yii`，想着*好吧，我可能需要修补某人的 css 解决方案——这不是开始我的 Yii 学习的好方法，但也许是可行的。* 我发现的只是技巧和方法，他们倾向于认为我有为移动浏览器构建的经验。

（我不知道。到目前为止，我在这次搜索中学到的最重要的事情是 CSS 本身并不能实现它；显然**jquery mobile**是首选工具。我提到这一点只是为了让你知道我的理解状态。）

我完全支持“湿漆技术”，并没有把所有东西都交给我，但我想象 Yii 会对移动应用程序的挑战做出回应。我错过了什么？（也许一些选择关键词，因为我的研究产生的很少？）你建议我如何前进？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T05:55:52.780

Try with [Bootstrap](http://twitter.github.com/bootstrap/) framework. Create a new theme in yii and put all the boostrap files in that theme .. your yii application will start working in responsive design mode. You can also use the [bootstrap extension for yii](http://www.yiiframework.com/extension/bootstrap/)

# python - 如何使用 LinkedIn 的新 api 调用获取用户的电子邮件地址？

> ID：12100324
> 
> 赞同：3
> 
> 时间：2012-08-23T21:34:41.510
> 
> 标签：python, linkedin, socialauth

根据这些文档，我应该请求“电子邮件地址”：[https ://developer.linkedin.com/documents/profile-fields](https://developer.linkedin.com/documents/profile-fields)

我假设这与任何其他用户数据调用一样工作，因此我将通过 oauth 过程来获取正确的令牌，然后执行以下操作（在 Python 中使用 oauth2 库）：

```
In [30]: url='http://api.linkedin.com/v1/people/~:(id,first-name,industry,email-address)'
In [31]: resp, content = client.request(url, 'GET')
In [32]: content
Out[32]: '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<person>\n  <id>t0tImGn-yi</id>\n  <first-name>Jeff</first-name>\n  <industry>Computer Software</industry>\n</person>\n' 
```

如您所见，电子邮件地址不在响应中。

我还应该注意，我尝试使用以下方法在 requestToken 请求中指定范围：

`request_token_url = 'https://api.linkedin.com/uas/oauth/requestToken? scope=r_basic_profile+r_emailaddress'`

更新：我在这里找到了其他文档：[https](https://developer.linkedin.com/documents/authentication#toggleview:id=python) ://developer.linkedin.com/documents/authentication#toggleview :id=python 这似乎暗示我应该尝试通过访问这里来访问电子邮件：resp, content = client.request ('http://api.linkedin.com/v1/people/~/email-address', 'GET')

在这种情况下，内容返回“null”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-06T16:42:23.803

写“emailAdress”而不是“email-adress”

```
url='http://api.linkedin.com/v1/people/~:(id,first-name,industry,**emailAdress**)' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-28T07:59:27.033

您需要获取新的 API 密钥，然后在他们进行迁移时发出请求，请参阅[此](https://developer.linkedin.com/comment/17231#comment-17231)

# ranking - 等级评分公式

> ID：12100328
> 
> 赞同：0
> 
> 时间：2012-08-23T21:34:59.417
> 
> 标签：ranking, rank

根据以下数据计算排名百分比的公式是什么：

1193 赢 1197 输

因此，我希望获得 92.6% 的百分比排名

我会很感激你的帮助，

谢谢你。

# jquery - nth-child() 选择器有问题

> ID：12100329
> 
> 赞同：0
> 
> 时间：2012-08-23T21:35:05.800
> 
> 标签：jquery, jquery-selectors, css-selectors

对于店面，我正在构建一个简单的选择器，它允许根据它们的类显示和隐藏元素。

我正在使用 nth-child() 选择器为每个第三个元素添加一个类，但即使选择器确实可以显示和隐藏元素，我的脚本在进行选择后也不会将该类添加到第三个元素。

我正在使用的代码非常大（并且绝对可以优化），所以对于我的意思的一个例子，[请看一下这个 jsFiddle](http://jsfiddle.net/tXGrA/)。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:47:15.940

您误解了 nth-child 的作用。

您希望`.myclass:nth-child(3n)`选择每 3 次出现的`.myclass`.

它真正做的是选择`nth-child`它的父节点的每个元素，而不考虑类。它基本上充当组合选择器。在你的情况下

> 选择每个也具有类 .myclass 的第三个元素

在您的情况下，您应该使用：

```
$(".myclass").each(function(index, item){
    if (index % 3 == 0) {
        // do something
    }
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:57:05.343

[工作演示](http://jsfiddle.net/sJbjw/)

您的代码已修改.. 替换行

```
 jQuery('.' + className).parent().children('.' + className + ':nth-child(3n) a').addClass('product_item_last'); 
```

# javascript - 谷歌地图在 LatLng.toUrlValue 中返回经度 >180

> ID：12100332
> 
> 赞同：0
> 
> 时间：2012-08-23T21:35:31.070
> 
> 标签：javascript, jquery, google-maps-api-3

我正在构建一个带有叠加多边形的全球地图。它位于 jQuery Accordion 中。每当我切换手风琴窗格然后回到地图时，它就会跳到南极洲。为了克服这种行为，我一直在尝试捕获当前中心 LatLng，将其存储在一个变量中，然后在返回地图的手风琴面板时 setCenter()。

它不起作用，所以我尝试使用 .toUrlValue() 方法将当前中心坐标转储到页面上的可见元素。当我向东或向西平移地图时，经度数不断增加。我预计它会达到 180，然后重置为 -180。

![地图经度问题](../Images/208c3fc4f55c7c966753cb44468cc533.png)

我的代码：

```
var currMapCenter = null;

jQuery(document).ready(function() {
  jQuery("#accordion").bind('accordionchange', function(event, ui) {
    if (ui.newContent.attr('id') == 'region-list')
    {
    triggerMapResize(); 
    }
});
});

function initialize_map() {

//do all the initialization here...

currMapCenter = map.getCenter(); //set initial center in variable.

google.maps.event.addListener(map, 'center_changed', function() {
  currMapCenter=map.getCenter();
  jQuery("#description").html(currMapCenter.toUrlValue());//to see what is happening...
});
}

function triggerMapResize()
{
google.maps.event.trigger(map, "resize");
map.setCenter(currMapCenter);
} 
```

[文档](https://developers.google.com/maps/documentation/javascript/reference#Map)表明getCenter () 返回一个 LatLng，而 setCenter() 需要一个 LatLng。我是否误解了当我尝试设置 currMapCenter = map.getCenter() 时会发生什么？鉴于我的地图需要像现在一样包装，我如何捕获可用的 LatLng 以与 setCenter() 一起使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-11-15T16:02:54.493

getCenter() 返回 LatLng，但它可能超过 180 度。这取决于您将地球绕其轴旋转多少次。:)

我找到了解决这个问题的简单方法

```
var loc=map.getCenter();
loc=new google.maps.LatLng(loc.lat(), loc.lng(), false); 
```

现在 LatLng 被重新计算为正确的值，您可以使用它...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:51:57.483

[Map 对象](https://developers.google.com/maps/documentation/javascript/reference#Map)的getCenter 方法记录了该行为

getCenter()
LatLng
返回显示在地图中心的位置。请注意，此**LatLng 对象未包装**。有关详细信息，请参阅 LatLng。

也许您可以使用 getBounds() （如果地图被缩小以显示多个副本，则可能不起作用）

getBounds()
LatLngBounds
返回当前视口的纬度/经度边界。如果世界的多个副本可见，则范围的经度范围为 -180 到 180 度（含）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-22T11:45:59.417

谢谢，这个线程帮助了我。这是我用来验证 noWarp 设置并在坐标不超过 +/- 180 度的情况下访问我需要的中心的代码：-

```
var gmap_center = new google.maps.LatLng(map.getCenter().lat(), map.getCenter().lng(), false);

console.log('GMap lat/lng with default noWrap:true = ' + map.getCenter().lat() + ' / ' + map.getCenter().lng());

console.log('GMap lat/lng with noWrap:false = ' + gmap_center.lat() + ' / ' + gmap_center.lng()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T16:26:54.700

现在看来，这个主题的标题不准确，与实际问题无关。IE8 - 毫不奇怪 - 给了我各种各样的问题并且根本无法绘制地图，而符合标准的浏览器很好，除了在切换手风琴窗格时失去中心。

在我的原始代码中，我正在侦听“center_changed”事件以捕获当前地图中心坐标。我开始怀疑 jQuery 的事件是否在手风琴关闭时改变了地图的位置，所以我将中心捕获事件切换为“mouseout”。这解决了问题，但我仍然不知道是什么原因造成的。

旁注：我一直在使用 window.onload = function () { initialize_map(); 在 IE 以外的浏览器中取得成功，但 IE 卡住了，根本无法加载。

```
var map=null;
var currMapCenter = null;

jQuery(document).ready(function() {
jQuery("#accordion").bind('accordionchange', function(event, ui) {
if (ui.newContent.attr('id') == 'region-list')
{
if(map==null) {
//first load; call map initialization
initialize_map();
}
triggerMapResize(); 
}
});

function initialize_map() {

//do initilization here...

google.maps.event.addListener(map, 'mouseout', function() { 
currMapCenter=map.getCenter();
});
}

function triggerMapResize() {
google.maps.event.trigger(map, "resize");
map.setCenter(currMapCenter);
} 
```

上面的代码没有问题；在 Firefox 14、Chrome 和 IE8 中测试。

# apache - .htaccess 在文件不存在时重定向

> ID：12100334
> 
> 赞同：6
> 
> 时间：2012-08-23T21:35:36.517
> 
> 标签：apache, .htaccess, mod-rewrite

我正在使用 .htaccess 将用户重定向到我的主控制器，它工作正常。但是当我调用一个不存在的js文件时：

```
<script src="/js/jquery1231231312.js"></script> 
```

这个 js 文件不仅仅是说 404 - 文件不存在，而是获取 index.php 的内容。我应该如何进行？

这是我的 .htaccess

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T21:48:05.543

好吧，按照您设置的方式，所有内容都通过`index.php`. 如果对不存在的资源发出请求，它将通过`index.php`. 由 index.php 来实现某些东西不存在，并返回 404 错误，但我猜它的设置是如果`url=`不存在，则返回主页。

您可以更改规则以忽略某些文件的路由，例如您的示例：

```
RewriteEngine on
RewriteCond %{REQUEST_URI} !^/js/
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?url=$1 [QSA,L] 
```

这将使`/js`目录中的任何内容都不会被路由通过`index.php`，因此如果有人请求目录中不存在的文件`/js`，他们只会得到常规的 404 响应。

* * *

编辑：

> 这就是我想要的，忽略某些文件（js、css、图像）的路由，因为如果文件不存在，我会得到正常错误！

如果您想忽略所有图像、javascript 和 css，那么第二行应该是：

```
RewriteCond %{REQUEST_URI} !\.(png|jpe?g|gif|css|js)$ [NC] 
```

# api - 用于检查敏感数据输入是否有效的正确 REST 动词？

> ID：12100335
> 
> 赞同：3
> 
> 时间：2012-08-23T21:35:39.800
> 
> 标签：api, rest

我需要发送数据并比较它是否存在于 API 服务器中。例如：

```
$a['foo'] = 'hello';
$a['bar'] = 'world';
$rest->verb('resource', $a); 
```

如果 和 的值`foo`存在`bar`于 API 服务器中，它应该返回`OK`else `Bad Request`。

我想`GET`用作动词，因为它听起来更合适，只是在查询字符串中发送数据，但是如果是敏感信息`foo`并且`bar`通过 post/put 传输更安全，该怎么办？但是我没有添加或更新任何东西。

在这种情况下，最好的动词是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:43:03.017

好吧，出于安全考虑排除 GET ¹后，实际上只剩下 POST/PUT（完全忽略 DELETE）。

在这些可用选项中，我建议使用 POST，因为它更常见（尤其是在 REST 之外）并且总体上不太具体的 HTTP 动词。

从[我们其他人的 REST 开始](http://developer.mindtouch.com/REST/REST_for_the_Rest_of_Us)：

> POST 动词可以有多种含义。*它是 HTTP 动词的瑞士军刀。* 对于某些资源，它可以用来改变内部状态。对于其他人，*它的行为可能是远程过程调用的行为。*

* * *

¹ GET 的问题是到服务器的任何数据都*必须*通过 URI（资源名称和查询字符串）传输。因此，此响应假定使用 POST 动词的请求*不会*使用 URI 来传输敏感信息，或者它不会比 GET 更好。文章[How Secure are Query Strings over HTTPS?](http://blog.httpwatch.com/2009/02/20/how-secure-are-query-strings-over-https/) 讨论了 URI 中数据的一些问题，即使是 HTTPS 连接（*应该*用于所有敏感请求）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:20:25.253

如果您将这样的问题发送到服务器并返回 OK。一毫秒后，可能就不行了。因此，如果您使用来自服务器的旧（毫秒旧但仍然旧）响应作为接受某些客户端输入的事实，那么当您稍后尝试存储该数据时仍然可能出错。

您应该简单地尝试在服务器上创建一些东西，这意味着它应该是 PUT 或 POST。如果您阅读有关 REST 的信息，它指出如果您知道结果资源的 URL，则应使用 PUT，否则应使用 POST。你有它。如果一切正常，您可能想要发送 201，否则发送 409。

您使用 PUT / POST 在服务器上创建的内容不一定是最终数据 - 它可能只是一个表示客户端已声明此 ID 或其他内容的令牌。

现在，如果您仍然希望在服务器上存储任何内容之前进行额外的预检查，您可能需要查看 Expect 或 Accept 或其他东西......不太记得了。这是您使用 REST 时的两个朋友。:)

[http://en.wikipedia.org/wiki/List_of_HTTP_status_codes](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)
[http://en.wikipedia.org/wiki/List_of_HTTP_header_fields](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields)

我还推荐这本关于 REST 的非常好的书：http: [//shop.oreilly.com/product/9780596529260.do](http://shop.oreilly.com/product/9780596529260.do)

# jquery - 如何将跨度标签的文本切换到输入中，并将文本作为输入值？

> ID：12100340
> 
> 赞同：0
> 
> 时间：2012-08-23T21:35:57.943
> 
> 标签：jquery

我试图从跨度切换到输入，同时保持文本从跨度并使其成为输入的值......

```
$('#container').find('<span />').each(function() {
  $(this).replaceWith($("<input />").val(this.text));
});​ 
```

这就是我尝试过的，但无法让它工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:37:41.717

我认为问题是 DOM 和 jQuery 之间的混淆，尝试使用：

```
$('#container').find('span').each(function() {
  $(this).replaceWith($("<input />").val($(this).text()));
});​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Vr4Vc/)。

您尝试使用 DOM 节点的原始代码`this`是 jQuery`text()`方法（尽管省略了括号）。

# ruby-on-rails - 与 session_secret 一起使用时，Rack::Session::Cookie 是否安全？

> ID：12100350
> 
> 赞同：2
> 
> 时间：2012-08-23T21:36:36.197
> 
> 标签：ruby-on-rails, security, cookies, sinatra

cookie 由 base64 编码的数组内容组成，然后是（我相信）该内容的 SHA1 散列，并用只有服务器知道的长 session_secret 加盐，所使用的策略有多安全？据我了解，哈希是防止客户端篡改 cookie 内容的签名。这个系统安全吗？特别是，攻击者能否弄清楚如何在没有访问 session_secret 的情况下伪造签名？是否还有其他漏洞？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:40:31.517

[SHA1](http://en.wikipedia.org/wiki/SHA-1)有已知的漏洞，所以如果它使用它，我不会推荐它。理论上，这可以被利用来伪造签名。

# cookies - Coherence - 托管在不同服务器上的应用程序之间的 Cookie 会话共享

> ID：12100354
> 
> 赞同：1
> 
> 时间：2012-08-23T21:37:27.413
> 
> 标签：cookies, dns, virtualhost, proxy-server

Coherence - 托管在不同服务器上的应用程序之间的 Cookie 会话共享

我在不同的服务器上有一些**Web 应用程序**，我需要它们在浏览器中共享 cookie 会话。

我想为所有具有不同 url 的域分配相同的域。我该如何实施？

它真的会起作用吗？我想用**代理**服务器上的虚拟主机来做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T21:26:04.943

想到的第一种方法是在 DocumentRoot 中创建一个符号链接，指向另一个服务器上存在的已安装目录。如果您跨服务器并针对每个应用程序执行此操作，那么无论人们到达哪个服务器（由于负载平衡等），就 apache 而言，每个服务器都有一个“完整”集，但实际上您仍然有不同的数据在其各自的位置。

在您的`/html/`目录（例如 DocumentRoot）中，您将拥有：

```
application1/
application2 -> /mnt/application2/
application3 -> /mnt/application3/ 
```

然后你会设置挂载 - 例如 - 所以 a`df`会：

```
192.168.1.2:/var/www/html/application2   ...   /mnt/application2
192.168.1.3:/var/www/html/application3   ...   /mnt/application3 
```

就 apache 和他的浏览器等而言，这样做可以让这个人在同一个站点上，并且您肯定使用的是同一个域，但本质上只是基于 url 在服务器之间拆分文件系统。

# node.js - 如何在 Mongoose 中创建相互依赖的模式？

> ID：12100356
> 
> 赞同：9
> 
> 时间：2012-08-23T21:37:35.110
> 
> 标签：node.js, mongoose, database-schema

我有两个模式，我希望它们相互交互。例如：

```
// calendar.js
var mongoose = require('mongoose');
var Scema = mongoose.Schema;
var Day = mongoose.model('Day');

var CalendarSchema = new Schema({
  name: { type: String, required: true },
  startYear: { type: Number, required: true }
});

CalendarSchema.methods.getDays = function(cb){
   Day.find({ cal: this._id }, cb);
}

module.exports = mongoose.model('Calendar', CalendarSchema);

// day.js
var mongoose = require('mongoose');
var Schema = mongoose.Schema;
var ObjectId = Schema.ObjectId;
var Calendar = mongoose.model('Calendar');    

var DaySchema = new Schema({
  cal: { type: ObjectId, required: true },
  date: { type: Number, required: true },
  text: { type: String, default: 'hello' }
});

DaySchema.methods.getCal = function(cb){
   Calendar.findById(this.cal, cb);
}

module.exports = mongoose.model('Day', DaySchema); 
```

但是，我收到一个错误，因为每个架构都依赖于另一个架构。有没有办法使用猫鼬来完成这项工作？我像这样包括它们：

```
// app.js
require('./models/calendar');
require('./models/day'); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-21T17:24:08.057

我意识到这是一个古老的话题，但我确信发布解决方案会帮助其他人。

解决方案是在需要相互依赖的模式之前导出模块：

```
// calendar.js
var mongoose = require('mongoose');
var Schema = mongoose.Schema;

var CalendarSchema = new Schema({
  name: { type: String, required: true },
  startYear: { type: Number, required: true }
});

module.exports = mongoose.model('Calendar', CalendarSchema);

// now you can include the other model and finish definining calendar
var Day = mongoose.require('./day');    
CalendarSchema.methods.getDays = function(cb){
   Day.find({ cal: this._id }, cb);
}

// day.js
var mongoose = require('mongoose');
var Schema = mongoose.Schema;
var ObjectId = Schema.ObjectId;   

var DaySchema = new Schema({
  cal: { type: ObjectId, required: true },
  date: { type: Number, required: true },
  text: { type: String, default: 'hello' }
});

module.exports = mongoose.model('Day', DaySchema);

// same thing here. require after exporting
var Calendar = require('./calendar'); 

DaySchema.methods.getCal = function(cb){
   Calendar.findById(this.cal, cb);
} 
```

真的就是这么简单。Brian Bickerton 的解释可以在这里找到：

[http://tauzero.roughdraft.io/3948969265a2a427cf83-requiring-interdependent-node-js-modules](http://tauzero.roughdraft.io/3948969265a2a427cf83-requiring-interdependent-node-js-modules)

> 很高兴能够在模块中按名称使用函数，而不是冗长的 module.exports.name。有一个地方可以查看和查看要导出的所有内容也很不错。通常，我看到的解决方案是正常定义函数和变量，然后将 module.exports 设置为最后包含所需属性的对象。这在大多数情况下都有效。当两个模块相互依赖并且相互需要时，它就会崩溃。最后设置导出会导致意想不到的结果。要解决这个问题，只需在顶部分配 module.exports，然后再需要其他模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T11:34:02.477

您需要需要这些文件。如果它们在同一路径中，请执行以下操作：

```
//calendar.js
var Day = require('./day');
/* Other logic here */
var CalendarSchema = new Schema({
  name: { type: String, required: true },
  startYear: { type: Number, required: true }
})
, Calendar;

/* other logic here */
/* Export calendar Schema */

mongoose.model('Calendar', CalendarSchema);
Calendar = mongoose.model('Calendar');
exports = Calendar; 
```

在 day.js 中做同样的事情

编辑：正如 JohnnyHK 所说，这不起作用。[链接到解释](http://nodejs.org/api/modules.html#modules_cycles)

# vb.net - VB.NET 从数据集中选择列

> ID：12100360
> 
> 赞同：2
> 
> 时间：2012-08-23T21:37:40.453
> 
> 标签：vb.net

我有以下内容：

```
 Dim dt As DataTable = ds.Tables(0) 
```

Tables(0) 有大约 20 列。我喜欢只选择一对。“PrID”是字段之一。

我试过

```
 Dim dt As DataTable = ds.Tables(0).Select("PrID") 
```

没有任何成功。任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:41:54.663

一种方法是使用强类型并支持可空类型的`DataRow`扩展方法：[`Field`](http://msdn.microsoft.com/en-us/library/bb360891.aspx#Y0)

```
For Each row As DataRow in ds.Tables(0).Rows
    Dim PrID As Int32 = row.Field(Of Int32)("PrID")
Next 
```

**编辑**：如果您想要另一个`DataTable`具有原始 DataTable 的列子集的另一个，您可以使用`DataView`该表及其[`ToTable`](http://msdn.microsoft.com/en-us/library/a8ycds2f.aspx)方法：

```
Dim displayView = New DataView(ds.Tables(0))
' if you're only interested in: PrID, Col2, Col3
Dim subset As DataTable = displayView.ToTable(false, "PrID", "Col2", "Col3") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T03:58:23.320

您可以使用 PRID 列。

```
 Dim dt As New DataTable
    Dim columns As String() = "PrID".Split(",")
    dt = ds.Tables(0).DefaultView.ToTable(String.Empty, False, columns) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-07T06:55:51.840

```
 'first create a new Dataview 
    Dim [Dataview] As New DataView

    'here add the table to Dataview you want to filter its columns
    [Dataview].Table = Ds.Tables(" here Write TableName ")

    'here you can display selected Columns in Datatable 
    Dim [datatable] As DataTable = [Dataview].ToTable(False, "desired column Name ", "desired Column Name")
    'here you can display selected Columns  in DatagridView1
    DataGridView1.DataSource = [Dataview].ToTable(False, "desired column Name ", "desired Column Name") 
```

# c# - 将新的 WebMethod 添加到 WebService 不会在发布时显示

> ID：12100363
> 
> 赞同：2
> 
> 时间：2012-08-23T21:37:47.053
> 
> 标签：c#, visual-studio-2010, web-services

我对 C# 上的 WebServices 有这个问题，问题是当我向 WebService 添加一个新方法时，在编译它之后，它不会在运行的 WebPage 上显示这个，也不会在 WSDL 上显示。有没有人也有这个问题？我一直在努力让它工作一整天，一切准备就绪，尝试清理解决方案，重建，还检查了该方法是否有标签 [WebMethod] 是的，它们是公共方法，我不知道还有什么可能问题。

**编辑**Web 服务是使用 asmx 制作的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T12:52:21.507

如以下答案之一所述：

[Web服务中的其他方法未显示](https://stackoverflow.com/questions/6339955/additional-method-in-webservice-not-showing-up?rq=1)

问题可能来自一个 asmx 标记文件，该文件被复制到其中并没有更新其命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-11T14:09:09.510

确保您没有将 WebMethod 声明为`static`(C#) 或`shared`(VB)，并确保您有`[WebMethod]`(C#) 或`<WebMethod()>`(VB)

# html - 后代选择器在 Internet Explorer 9 中不起作用

> ID：12100364
> 
> 赞同：1
> 
> 时间：2012-08-23T21:37:56.740
> 
> 标签：html, css

使用此标记：

```
 <div id="shopNav">
        <ul>
            <li class="active">
                <a href="#">test 1</a></li>

        </ul>
    </div>  
    <ul>
        <li class="active1"><a href="#">test</a></li>

    </ul> 
```

这不起作用

```
#shopnav li.active {
    border:1px solid red !important;    
} 
```

但：

```
.active {border:1px solid red !important;} 
```

确实有效。

我对不同的文档类型有不同的行为：

```
<!DOCTYPE PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

第一个在 FF 而不是 ie8 中突出显示，并带有：

行为是一致的，因为只有第二个 li 被赋予了样式。

我完全不明白这一点，因为我觉得我已经使用这种选择器很长时间了......为什么它在 IE9 中不起作用的第一个选择器？为什么第一个选择器不能与 loss.dtd 一起使用？

[在此页面上](http://djembefola.com/shop/test.htm)查看它的实际应用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:50:59.757

`id`属性值区分大小写。当你有`id="shopNav"`，那么在 CSS 中你需要使用`#shopNav`，而不是`#shopnav`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:47:26.853

用这个：

```
#shopnav ul li.active 
```

或这个

```
#shopnav * li.active 
```

# jquery - jQuery遍历表行并选择某些输入

> ID：12100370
> 
> 赞同：0
> 
> 时间：2012-08-23T21:38:09.457
> 
> 标签：jquery, rows

我有一张桌子。可以动态添加/删除行。td 中有表单输入。我如何遍历行并引用当前行输入？表单输入的名称是动态创建的。

如果您查看 jsfiddle，我正在尝试根据第一个和第三个输入更新第二个输入。然后，我需要将下一行的第一个输入设置为新计算的值。

[jsFiddle](http://jsfiddle.net/GmgAe/4/)

 `* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T21:59:03.720

您可以通过调用来定位下一行

```
var nextRow = $(this).next(); 
```

但是你的代码有很多错误，找到下一行是你最轻微的问题。

例子：

```
//nth-child is not zero based
var start = $("td:nth-child(0) input", this).val();

//there is no such function (maybe you extended Date, then it would be ok)
Date.parse(start,"MM/dd/yyyy") 
```

`actualDate`应该是，`startDate`对吧？`

# php - javascript 等效于 bcpowmod

> ID：12100372
> 
> 赞同：2
> 
> 时间：2012-08-23T21:38:12.153
> 
> 标签：php, javascript, bcmath

我正在编写一个可以解码我用 PHP 制作的 RSA 加密的 javascript 版本。一切正常，除了我没有与 bcpowmod 等效的 javascript。

我将 PHP JS 库用于其他功能，但它没有 bcpowmod。

如果我使用默认的数学运算符，例如： (pow(block,q)) % r 我会得到 NAN。

有没有适合我的方法或 js 库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-11T06:05:49.853

bcpowmod 在 javascript 中非常困难。这是执行此操作的代码。我刚刚发布了一个完整的库供任何人在他们的网站中使用 RSA RC4 加密，但很快就被版主 Brad Larson 击落了。他说，Stack Overflow 不想要这种东西。无论如何，这是给你的代码。

Java 脚本在这方面很慢。所以我分多个步骤来做，这样 javascript 就有时间显示进度条或其他东西。我必须编写自己的 bcmath 包才能做到这一点。您可以在[http://jerrywickey.com/test/testJerrysLibrary.php看到整个加密函数库](http://jerrywickey.com/test/testJerrysLibrary.php)

您需要任意精度的乘法、除法、减法和比较。所以他们都在这里。实际的 bcpowmod 分多个步骤完成，因为它只需要很长时间。

计算完成后，它会使用结果调用回调参数中指定的函数。来回交换 a 和 b 以使其为您工作，以防我们对 RSA 公共、私有和模值使用不同的术语。仅对回调函数使用字母数字名称。不要使用括号。

```
bcpowmod( 'plain text', RSAp, RSAq, 'myCallBackForResult');

    function myCallBackForResult( result){
            alert ( result + ' of powmod');
    }

    function bcpowmod( str, a, b, callback){
        RSAencryptStep( (''+str), (''+a), (''+b), '1', callback, 0);
    }

    function RSAencryptStep( str, a, b, result, callback, count){   
        count++;
        if ( JL_bccomp( JL_bcmod( a, '2'), '1')==0) {
            result = JL_bcmod( JL_bcmul( result, str), b);
        }
        str= JL_bcmod( JL_bcmul( str, str), b);
        a= JL_bcdiv( a, '2');
        if ( JL_bccomp( a, '0')!=0){
            var e= "RSAencryptStep('" +str+"','" +a+"','" +b+"','" +result+"','" +callback +"'," +count+")";
            setTimeout( e, 10); 
            clearTimeout( JL_crytime);
            try{
                ge('cryptocount').innerHTML= ( 60 - count);
            }catch(e){}
        }else{
            eval( callback+'("'+ result+'")' );
        }
    }

    function JL_bccomp( a, b){
        if (a.length > b.length){ return 1; }   
        if (a.length < b.length){ return -1; }
        var i= 0; while ( a.charAt(i)==b.charAt(i) && ++i<a.length){ }
        if ( i==a.length){ return 0; }
        if ( parseInt( a.charAt(i)) > parseInt( b.charAt(i))){ return 1; }  
        return -1;      
    }

    function JL_bcadd( a, b){
        var zero= '00000000000000000000'; while ( zero.length < a.length + b.length){ zero+= ''+zero; } 
        if ( a.length < b.length){ a= ''+ zero.substring( 0, ( b.length - a.length )) + a; }
        if ( b.length < a.length){ b= ''+ zero.substring( 0, ( a.length - b.length )) + b; }
        var s= ('0'+a).split('');
        var t= 0;
        for (var i=0; i<a.length; i++){
            t= parseInt( s[s.length-i-1]) + parseInt( b.charAt( b.length-i-1));;
            if (t > 9){
                s[s.length-i-1]= t - 10;
                s[s.length-i-2]= parseInt( s[s.length-i-2]) + 1;
            }else{
                s[s.length-i-1]= t;
            }       
        }
        return trim( trim(( s.join('')+' '), '0'), '');
    }

    function JL_bcsub( a, b){
        var x= JL_bccomp( a, b);
        if ( x==0){
            return '0';
        }
        var minus= '';
        if ( x < 0){
            var x= a;
            a= b;
            b= x;
            minus= '-';
        }
        var s= a.split('');
        var t= 0;
        for (var i=0; i<s.length; i++){
            t= parseInt(s[s.length-i-1]);
            if ( i<b.length){ t= t - parseInt( b.charAt( b.length-i-1)); }
            if ( t<0){
                s[s.length-i-1]= t + 10;
                s[s.length-i-2]= s[s.length-i-2] - 1;
            }else{
                s[s.length-i-1]= parseInt( t);
            }       
        }
        return minus + trim( trim(( s.join('')+' '), '0'), '');
    }

    function JL_bcmul( a, b){
        var s= [];
        for (var i=0; i < a.length + b.length; i++){ s[i]= 0; }
        var t= 0;
        for (i=0; i<b.length; i++){ 
            for (var j=0; j<a.length; j++){
                t= s[i+j] + ( parseInt( a.charAt( a.length - j - 1)) * parseInt( b.charAt( b.length - i - 1))); 
                s[i+j]= t % 10;
                s[i+j+1]= s[i+j+1] + Math.floor( t / 10);
            }
        }
        s.reverse();
        return trim( trim(( s.join('')+' '), '0'), '');
    }

    function JL_bcdiv( a, b){
        var r= '0';
        var rr= '1';
        var e= b;
        var rrs= [];
        var es= [];
        var i= 0;
        while( JL_bccomp( a, b) >= 0){
            rr= '1';
            e= b;
            i= 0;
            while( JL_bccomp( a, e) >= 0){
                a= JL_bcsub( a, e);
                r= JL_bcadd( r, rr);
                if ( typeof es[i] == 'undefined'){
                    es[i]= JL_bcmul( e, '2');
                    rrs[i]= JL_bcmul( rr, '2');
                }
                e= es[i];
                rr= rrs[i];
                i++;
            }
        }
        // a is the remainder
        return r;
    }

    function JL_bcmod( a, m){
        var s= [];
        var e= m;
        var i= 0;
        while( JL_bccomp( a, m) >= 0){
            e= m;
            i= 0;
            while( JL_bccomp( a, e) >= 0){
                a= JL_bcsub( a, e);
                if ( typeof s[i] == 'undefined'){
                    s[i]= JL_bcmul( e, '2');
                } 
                e= s[i];
                i++;
            }
        }
        return a;
    } 
```

# python - Python / rq - 监控worker状态

> ID：12100377
> 
> 赞同：6
> 
> 时间：2012-08-23T21:38:27.153
> 
> 标签：python, task-queue

如果这是一个愚蠢的问题，我道歉并且会羞愧地掩饰我的头，但是：

我正在使用 rq 在 Python 中对作业进行排队。我希望它像这样工作：

1.  作业 A 开始。作业 A 通过 Web API 获取数据并存储。
2.  作业 A 运行。
3.  作业 A 完成。
4.  完成 A 后，作业 B 开始。作业 B 检查作业 A 存储的每条记录并添加一些额外的响应数据。
5.  完成作业 B 后，用户会收到一封愉快的电子邮件，说明他们的报告已准备就绪。

到目前为止我的代码：

```
redis_conn = Redis()
use_connection(redis_conn)
q = Queue('normal', connection=redis_conn) # this is terrible, I know - fixing later
w = Worker(q)
job = q.enqueue(getlinksmod.lsGet, theURL,total,domainid)
w.work() 
```

我认为我最好的解决方案是让 2 名工人，一名负责工作 A，一名负责 B。工作 B 工人可以监控工作 A，当工作 A 完成后，开始工作 B。

我无法想办法挽救我的生命是如何让一名工人监控另一名工人的状态。我可以使用 job.id 从作业 A 中获取作业 ID。我可以用 w.name 获取工人姓名。但是对于我如何将任何这些信息传递给其他工作人员，这还不是最模糊的。

或者，有没有一种我完全想念的更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-18T16:14:21.673

**更新 2015 年 1 月**，这个 pull request 现在被合并了，参数被重命名为`depends_on`，即：

```
second_job = q.enqueue(email_customer, depends_on=first_job) 
```

对于运行旧版本等的人来说，原始帖子保持不变：

我已经提交了一个拉取请求（[https://github.com/nvie/rq/pull/207](https://github.com/nvie/rq/pull/207)）来处理 RQ 中的作业依赖关系。合并此拉取请求后，您将能够：

```
def generate_report():
    pass

def email_customer():
    pass

first_job = q.enqueue(generate_report)
second_job = q.enqueue(email_customer, after=first_job)
# In the second enqueue call, job is created,
# but only moved into queue after first_job finishes 
```

现在，我建议编写一个包装函数来顺序运行您的作业。例如：

```
def generate_report():
     pass

def email_customer():
    pass

def generate_report_and_email():
    generate_report()
    email_customer() # You can also enqueue this function, if you really want to

# Somewhere else
q.enqueue(generate_report_and_email) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-08T07:12:36.543

从文档的[这个页面](http://python-rq.org/docs/)，`rq`看起来每个`job`对象都有一个`result`属性，可调用 by `job.result`，您可以检查它。如果工作尚未完成，它将是`None`，但如果您确保您的工作返回一些值（`"Done"`甚至`job.result`只是value，意味着第一个工人已经完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:58:08.373

将作业 A 和作业 B 所做的事情组合在一个函数中，然后使用 eg `multiprocessing.Pool`（它的`map_async`方法）将其分摊到不同的进程中。

我不熟悉 rq，但`multiprocessing`它是标准库的一部分。默认情况下，它使用的进程数与 CPU 的内核数一样多，根据我的经验，这通常足以使机器饱和。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T13:29:48.177

您可能对项目太深入而无法切换，但如果没有，请查看`Twisted`. [http://twistedmatrix.com/trac/](http://twistedmatrix.com/trac/)我现在正在将它用于一个访问 API、抓取 Web 内容等的项目。它并行运行多个作业，以及按顺序组织某些作业，所以作业 B 没有t 执行直到作业 A 完成。

如果您想尝试，这是学习 Twisted 的最佳教程。[http://krondo.com/?page_id=1327](http://krondo.com/?page_id=1327)

# spring - Selenium 和 Spring 无法调用 @Configuration 方法

> ID：12100382
> 
> 赞同：-2
> 
> 时间：2012-08-23T21:39:41.647
> 
> 标签：spring, selenium, testng

我对这一切都很陌生，设置它有点不知所措。我正在使用 ant 使用 testng 套件运行一堆测试。

它到达了我收到此错误的地步：

`[testng] Failed to invoke @Configuration method org.springframework.test.context.testng.AbstractTestNGSpringContextTests.springTestContextPrepareTestInstance:Error creating bean with name 'com.mystuffs.tests1.CreateTest1': Injection of autowired dependencies failed; nested exception is org.springframework.beans.factory.BeanCreationException: Could not autowire method: public void com.mystuffs.web.BrowserTest1.setBrowser(com.mystuffs.web.browser.Browser); nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'browser' defined in class path resource [applicationcontext.xml]: Invocation of init method failed; nested exception is java.lang.RuntimeException: Could not start Selenium session: Failed to start new browser session: Error while launching browser`

它看起来像是某种依赖问题，但我不确定如何继续。任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T07:41:39.923

无论您尝试什么：问题是您在启动应用程序时尝试实例化 Selenium 浏览器会话，但失败了：

> java.lang.RuntimeException：无法启动 Selenium 会话：无法启动新的浏览器会话：启动浏览器时出错

所以你应该看看为什么 selenium 不能启动浏览器

# python - 将参数传递给命令行 (PYTHON)

> ID：12100385
> 
> 赞同：0
> 
> 时间：2012-08-23T21:40:01.060
> 
> 标签：python, gdata

所以我有一个来自 GDATA API (gdata.sample_util.authorize_client(client, service=client.auth_service, source=client.source, scopes=client.auth_scopes)) 的函数，它使用命令行接收参数。我怎样才能自动化它，以便我可以对参数进行硬编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:01:35.530

你的意思是硬编码参数，每次调用函数时不必编写的参数，或者从命令行打开程序？这些称为默认参数。看一下这个：

[http://docs.python.org/release/1.5.1p1/tut/defaultArgs.html](http://docs.python.org/release/1.5.1p1/tut/defaultArgs.html)

例子：

```
def ask_ok(prompt, retries=4, complaint='Yes or no, please!'):
    while 1:
        ok = raw_input(prompt)
        if ok in ('y', 'ye', 'yes'): return 1
        if ok in ('n', 'no', 'nop', 'nope'): return 0
        retries = retries - 1
        if retries < 0: raise IOError, 'refusenik user'
        print complaint 
```

所以你实际上可以用不同的方式调用这个函数：

`ask_ok('Do you really want to quit?')`

或像这样：

```
ask_ok('OK to overwrite the file?', 2) 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:59:34.640

如果没有传递命令行参数，您可以根据需要添加参数

```
import sys

sys.argv += ["-a"] 
```

# c# - 为什么在 Fiddler 运行时 WCF 数据服务性能更好？

> ID：12100387
> 
> 赞同：8
> 
> 时间：2012-08-23T21:40:20.613
> 
> 标签：c#, wcf-data-services, fiddler

我有一个 Windows 应用程序连接到同一台机器上托管的 WCF 数据服务。

应用程序启动时发生的第一件事是返回 0 到 3 个结果的查询。这是代码：

```
var environments = ctx.Environments
.AddQueryOption("$filter", "Environment eq '" + ConfigurationManager.AppSettings["environment"] + "'")
.AddQueryOption("$expand", "Departments, SecurityGroups"); 
```

我要做的下一件事是检查是否 (environments.Count() == 0) 需要大约 10 秒来评估。第一次似乎是最慢的，但总是需要超过 6 秒。但是，如果我正在运行 Fiddler，我总是会立即获得结果。

为什么运行 Fiddler 会更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T13:42:25.090

当您运行 fiddler 时，它充当所有网络调用的代理，对吗？所以这个代理可能比真正的 DNS 主机响应得更快。您在绑定配置中设置的连接超时是多少？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T13:38:57.400

正如weismat所说，这可能是DNS问题。如果您在 WCF URL 中使用 DNS 名称，请尝试使用环回 ip (127.0.0.1) 或您的本地 IP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T15:42:49.947

我很欣赏所有的答案，但最后看来我的 VS 2010 开发环境出了点问题。通过让 Fiddler 保持启动和运行，我能够处理缓慢的第一个响应，但是在安装 Telerik 控件套件后，我的应用程序在调试时需要将近一分钟来加载表单。怀疑这与另一个问题有关，我安装了 VS 2012 并升级了我的项目，现在一切正常。

再次感谢您的回复。

# php - 在 PHP 中构建数据库模式树

> ID：12100388
> 
> 赞同：0
> 
> 时间：2012-08-23T21:40:25.930
> 
> 标签：php, algorithm, tree

我有一些文件，其中包含当前表引用的表名和表名，如下所示：

```
table1
table2, table3
-
table 2
table 4 
```

这意味着 table1 对表 table2 和 table3 的引用，以及 table2 对 table4 的引用。如何构建表树，其中键是“父”表，子表是这样的引用表：

```
[table4] => array(
    [table2] => array([table1] => null),
)
[table3] => array([table1] => null) 
```

所以，我的问题是我知道如何解析文件中的树记录，如下所示：

```
name    | parent
------------------
table 1 | table 2
table 2 | table 4 
```

但是当一个节点有多个父节点时，我不知道如何解析树结构的最佳方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:33:36.990

如果我错了，请纠正我，但仅仅拥有您需要的桌子和桌子设计是不够的。因此，您需要一个字段值和一个字段 ID。该字段 id 很可能是唯一的 id，可以引用同一个表或另一个表。例如表 1 有一个字段标题和一个字段 ID。如果 id 引用同一个表，您可以使用自联接。该模型称为邻接列表模型，但我不确定参考的方向是什么。

# mercurial - 将一个 Mercurial 存储库用作两个 Mercurial 安装的本地存储库

> ID：12100389
> 
> 赞同：2
> 
> 时间：2012-08-23T21:40:28.177
> 
> 标签：mercurial, project-management, redmine

我们有一个专门的问题跟踪 (Redmine) 机器，它有一个 Mercurial 存储库（称为“Redmine 存储库”）。Redmine 设置为使用该存储库，据我了解，Redmine 从未对该存储库进行任何更改。所有开发人员（最终）将他们的更改推送到该存储库。

我们还有一台专用的生产机器，它可以执行代码，但不用于对代码进行任何更改。

我们有两个选择：

1.  在生产机器上设置另一个 Mercurial 存储库（称为“生产存储库”）。当新的生产版本获得批准时，将更改从 Redmine 存储库拉到生产存储库，然后将本地工作目录更新为生产存储库中的适当修订版。

2.  在生产机器上重用现有的 Redmine 存储库，将其指定为本地安装的 Mercurial 存储库（Redmine 存储库位于可以轻松安装在生产机器上的共享驱动器上）。每当批准新产品时，将本地工作目录更新为 Redmine 存储库中的适当修订版。

使用选项 #2，我们摆脱了额外的“拉动”步骤（从 Redmine 存储库到生产存储库），这稍微简化了过程。但是我不确定两个 Mercurial 安装使用单个存储库是否可以，就好像它是本地的一样。

感谢您对此选择（或此设置的任何其他方面）的任何评论！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T02:25:21.093

这听起来是个坏主意。Mercurial 在保持其存储库原子读写方面做得非常好，但是当存储库位于共享驱动器上时（即使它只是一个使用它的本地存储库），它会更难做到这一点，因为网络共享（尤其是在 Windows 上）并不总是像他们所说的那样使事情变得原子化。

理想情况下，您的存储库（工作目录和存储库）尽可能在本地，并且您使用推/拉来获取/从网络共享的变更集。如果这是不可能的，那么在远程文件系统上使用一个本地应用程序是最好的主意。

如果您确实想尝试使用相同的底层存储库进行两个克隆，请查看[ShareExtension](http://mercurial.selenic.com/wiki/ShareExtension)，它与 Mercurial 一起提供，但仅适用于高级用户。

与其试图背负，不如在你的 redmine 存储库中放一个这样的钩子：

```
[hooks]
changegroup = hg push //production/clone 
```

这将自动将到达 redmine 的变更集推送到生产环境。

# html - HTML 输入文本故障

> ID：12100392
> 
> 赞同：0
> 
> 时间：2012-08-23T21:40:42.733
> 
> 标签：html, input

当我将多行文本粘贴到我的`<input type="text">`时，会发生这种情况：

![输入文本](../Images/1b79cfca2fba39c6a6c1e93821c7f124.png)

当我将文本粘贴到另一个网站时，文本通常会在中间一行：

![输入文本](../Images/cb484728570beddaf7c332ff063172ba.png)

我的 CSS ：

```
.textbox {
    padding:0 5px;
    height:30px;
    background:#FDFDFD;
    line-height:28px;
    width:250px;
    border:1px solid #D2D2D2;
}
@media screen and (-webkit-min-device-pixel-ratio:0) {
    .textbox { line-height:13px; }
} 
```

HTML：

```
<input type="text" class="textbox"> 
```

我只是好奇为什么会这样。我不用`<input type="text">`于此目的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:44:37.143

不要这样做。`<input type="text">`用于单行输入。在创作中，用于`textarea`允许多行。

# c# - IEnumerable.Any(Func) 什么时候返回值？

> ID：12100393
> 
> 赞同：2
> 
> 时间：2012-08-23T21:40:43.590
> 
> 标签：c#, performance, linq, lambda, ienumerable

我最近在我使用的代码库中看到了一些代码，ReSharper 提出将其重构为`collection.Any(Func< bool >)`.

我想知道这对性能的影响。假设我有一个看起来像这样的电话：

`bool hasEvenValue = collection.Any(i => (i % 2) == 0);`

......看起来像这样的数据......

`{ 1, 2, 3, 5, 3, 5, 1, 3, 5, 2 }`

Enumerable.Any() 什么时候返回值？在这种情况下，第二个数据元素，还是会在返回 true 之前处理*每个元素？*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:43:07.537

它一看到匹配的元素就返回，或者如果没有，它会处理整个序列。

出于这个原因，它比使用更好`.Count(...) != 0`（也更具可读性和语义意义）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:45:00.293

这是`IEnumerable<T>.Any(...)`（未使用 dotKeep 编译）的实现：

```
public static bool Any<TSource>(this IEnumerable<TSource> source, Func<TSource, bool> predicate)
{
  if (source == null)
    throw Error.ArgumentNull("source");
  if (predicate == null)
    throw Error.ArgumentNull("predicate");
  foreach (TSource source1 in source)
  {
    if (predicate(source1))
      return true;
  }
  return false;
} 
```

所以基本上只要项目满足条件，它就会返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T02:18:48.213

这是我在 LINQPad 中编写的一些代码，用于说明`Any`运算符在遇到第一个匹配项后终止。

```
void Main()
{
    Console.WriteLine("Are there any evens? " + YieldEvenThenThrowEnumerable().Any(i => i % 2 == 0));
    Console.WriteLine("still running");
    Console.WriteLine("Are there any odds? " + YieldEvenThenThrowEnumerable().Any(i => i % 2 == 1));
    Console.WriteLine("never reaches this point");
}

IEnumerable<int> YieldEvenThenThrowEnumerable()
{
    yield return 2;
    throw new InvalidOperationException("TEST");
} 
```

哪个输出：

> 有没有偶数？
> 真正的
> 仍在运行
> <此时从可枚举中抛出 InvalidOperationException >

如果`Any`测试“如果有偶数”的第一个调用遍历整个可枚举，则程序将终止而不显示任何消息。第二次调用是为了说明“如果有奇数”测试遍历整个列表，导致异常被抛出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T21:44:17.300

> IEnumerable.Any(Func) 什么时候返回值？

总是在它被执行时立即立即执行，因为它没有被延迟执行。它返回一个布尔值，指示序列**中的元素之一**是否对给定谓词返回 true。因此它不需要执行整个查询，不像`Count`.

# c++ - 范围内的范围，做还是不做？

> ID：12100394
> 
> 赞同：3
> 
> 时间：2012-08-23T21:40:51.953
> 
> 标签：c++, scope, dos-donts

尽管下面的示例编译得很好，除了最后一行有错误，我想知道这个“范围”在一个范围内的来龙去脉？还有这个的术语，如果有的话。

考虑这些括号：

```
void func()
{

    int i = 0;

    { // nice comment to describe this scope

        while( i < 10 )
            ++i;

    }

    { // nice comment to describe this scope

        int j= 0;
        while( j< 10 )
            ++j;

    }

    i = 0; // OK
    // j = 0; // error C2065

} 
```

考虑一下：

```
error C2065: 'j' : undeclared identifier 
```

* * *

**编辑：** [接受的答案](https://stackoverflow.com/a/12100453/1555816)来自[bitmask](https://stackoverflow.com/users/430766/bitmask)，尽管我认为每个人都应该将它放在[anio](https://stackoverflow.com/users/35227/anio) 's [answer](https://stackoverflow.com/a/12100458/1555816)的上下文中。特别是，引用：“也许你应该把你的功能分成两个功能”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-23T21:45:28.367

**做**。无论如何！

将数据保持在尽可能本地和尽可能常量有两个主要优点：

*   副作用减少，代码变得更*实用*
*   对于复杂的对象，只要不再需要数据，就可以在函数中尽早*调用析构函数*

此外，这对于文档总结功能的特定部分所做的工作很有用。

我听说这被称为*显式或虚拟作用域*。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T21:45:38.193

我个人认为在函数中添加额外的范围没有太大价值。如果您依赖它来分隔函数的各个部分，也许您应该将函数分解为 2 个函数。较小的功能优于较大的功能。您应该努力拥有易于理解的小功能。

在函数中使用范围的一种合法用途是限制锁的持续时间：

```
int doX() 
{

 // Do some work

  { 
  //Acquire lock

  } // Lock automatically released because of RAII
} 
```

内部作用域有效地限制了持有锁的代码。我相信这是普遍的做法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-23T22:00:10.223

是的，绝对 - 始终保持变量尽可能本地化是一个好习惯！一些例子：

```
for (std::string line; std::getline(std::cin, line); )     // does not
{                                                          // leak "line"
    // process "line"                                      // into ambient
}                                                          // scope

int result;

{                                        // putting this in a separate scope
    int a = foo();                       // allows us to copy/paste the entire
    a += 3;                              // block without worrying about
    int b = bar(a);                      // repeated declarators
    result *= (a + 2*b);
}

{                                        // ...and we never really needed
    int a = foo();                       // a and b outside of this anyway!
    a += 3;
    int b = bar(a);
    result *= (a + 2*b);
} 
```

有时同步需要范围，并且您希望使关键部分尽可能短：

```
int global_counter = 0;
std::mutex gctr_mx;

void I_run_many_times_concurrently()
{
    int a = expensive_computation();

    {
        std::lock_guard<std::mutex> _(gctr_mx);
        global_counter += a;
    }

    expensive_cleanup();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-23T21:46:29.373

**显式作用域**通常不是为了注释目的而进行的，但是如果您觉得这样做会使您的代码更具可读性，我认为这样做没有任何害处。

典型用法是[避免名称冲突并控制何时调用析构函数](https://stackoverflow.com/a/9720548/533120)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-23T21:48:39.350

一对花括号定义了一个范围。在一个范围内声明或定义的名称在该范围外是不可见的，这就是为什么`j`最后没有定义的原因。如果作用域中的名称与之前定义的名称相同并且在该作用域之外，它会隐藏外部名称。

# python - 分组 DataFrame 输出到 CSV 的列名

> ID：12100396
> 
> 赞同：2
> 
> 时间：2012-08-23T21:40:56.507
> 
> 标签：python, csv, pandas

我有`dataFrame`一份大型问卷，我通过以下方式聚合不同轴上的数据来生成摘要：

```
df.groupby(group_name).agg([np.mean, np.std, np.count_nonzero]) 
```

这会在我的问卷中生成一个包含每个问题的平均值、标准和计数的列。分组中每一列的名称`dataFrame`是一个元组`(original_column_name, function_applied)`

问题是，当我输出到 CSV（使用`to_csv()`）时，列名作为元组输出，即`('gender', 'mean'), ('gender', 'std')`理想情况下我想要类似`gender_mean`&`gender_std`

如何在输出到 CSV 之前处理这些列名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:33:52.307

在 pandas 0.8.1 中，试试这个：

```
group_df = df.groupby(group_name).agg([np.mean, np.std, np.count_nonzero])
group_df.rename(None, lambda coltuple: '_'.join(coltuple), False, True) 
```

有关详细信息，请参阅[DataFrame 文档](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html#pandas.DataFrame.rename)。

# mysql - 在mysql中记录查询缺少索引

> ID：12100397
> 
> 赞同：1
> 
> 时间：2012-08-23T21:41:02.653
> 
> 标签：mysql, sql, performance, indexing

我正在尝试查看我有哪些不使用索引的查询。

在外壳中，我做了：

```
> set global log_queries_not_using_indexes=1; 
```

这打开了该选项，如`show global variables`. 如何设置 query_log 打印到哪个文件？我尝试设置其中的几个，但它们似乎都不是它正在写入的那个。我需要做什么才能看到这个查询日志？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T00:13:09.210

它们将被记录到慢查询日志中。

像这样设置慢查询日志的位置：

```
slow_query_log_file=file_name 
```

更多信息：

```
http://dev.mysql.com/doc/refman/5.5/en/slow-query-log.html 
```

# android - android : 使用 MediaPlayer 播放背景音乐时，音效过早停止

> ID：12100401
> 
> 赞同：2
> 
> 时间：2012-08-23T21:41:24.917
> 
> 标签：android, background, effects

我正在尝试在我的应用程序上播放背景音乐，并在您杀死敌人时偶尔播放音效之类的东西。

所有音效都有效，但后来我开始使用 MusicManager 类（类似于本教程：[http](http://www.rbgrn.net/content/307-light-racer-20-days-61-64-completion) ://www.rbgrn.net/content/307-light-racer-20-days-61-64-completion ）尝试播放背景音乐，它可以工作，但声音效果会在半秒左右后被砍掉。

我正在使用以下方法播放音效：

```
 MediaPlayer mp = MediaPlayer.create(context, R.raw.fire); 
 mp.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:41:05.170

请改用声音池。SoundPool 可以同时以不同的音量、速度和循环播放多个流。MediaPLayer 并不是真的要处理游戏音频。

我在市场上发布了 2 款游戏，都使用 SoundPool 并且没有问题。

这里这两个功能是从我的游戏中取出的。

```
 public static void playSound(int index, float speed) 
{       
         float streamVolume = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC); 
         streamVolume = streamVolume / mAudioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
         mSoundPool.play(mSoundPoolMap.get(index), streamVolume, streamVolume, 1, 0, speed); 
}
public static void playLoop(int index, float speed) 
{       
         float streamVolume = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC); 
         streamVolume = streamVolume / mAudioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
         streamVolume = streamVolume / 3f;
         mSoundPool.play(mSoundPoolMap.get(index), streamVolume, streamVolume, 1, -1, speed); 
} 
```

就是这么容易。仔细看一下，我只使用我的 playLoop() 播放背景音乐，所以我降低了音量，但是您可以轻松修改代码以在每次播放时手动设置音量。

还

```
 mSoundPool.play(mSoundPoolMap.get(index), streamVolume, streamVolume, 1, -1, speed); 
```

第一个参数 mSoundPoolMap.get(index) 只是一个包含我所有声音的容器。我为每个声音分配一个最终编号，例如

```
 final static int SOUND_FIRE = 0, SOUND_DEATH = 1, SOUND_OUCH = 2; 
```

我将这些声音加载到这些位置并从中播放它们。（请记住，您不想在每次运行时都加载所有声音，只需加载一次。）接下来的 2 个参数是左/右音量、优先级，然后 -1 设置为循环。

```
 mSoundPool = new SoundPool(8, AudioManager.STREAM_MUSIC, 0); 
```

这将我的声音池设置为 8 个流。另一个是源类型，然后是质量。

玩得开心！

# python - 如何将动态 pyplot 保存为电影文件？

> ID：12100405
> 
> 赞同：4
> 
> 时间：2012-08-23T21:41:58.393
> 
> 标签：python, matplotlib

我遇到了这个简单的例子，可以帮助我解决我的问题：

```
"""
Pyplot animation example.

The method shown here is only for very simple, low-performance
use.  For more demanding applications, look at the animation
module and the examples that use it.
"""

import matplotlib.pyplot as plt
import numpy as np

x = np.arange(6)
y = np.arange(5)
z = x * y[:,np.newaxis]

for i in xrange(5):
    if i==0:
        p = plt.imshow(z)
        fig = plt.gcf()
        plt.clim()   # clamp the color limits
        plt.title("Boring slide show")
    else:
       z = z + 2
       p.set_data(z)

    print "step", i
    plt.pause(0.5) 
```

这在pyplot界面中显示动画，但我想以某种电影格式保存这个动画，有什么办法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:10:38.733

[一种方法是将所有步骤保存为图像，然后使用例如ffmpeg](http://ffmpeg.org/)将它们制作成电影。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-24T06:51:50.247

[在这篇文章http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/](http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/)中解释了另一种将 matplotlib 动画保存为视频的方法。它显示了一个更高级别的解决方案，您可以将动画指定为随时间变化的绘制函数。此外，您不必处理保存每一帧。

# objective-c - 用 Objective c 显示段落和标题的最佳方式是什么？

> ID：12100409
> 
> 赞同：0
> 
> 时间：2012-08-23T21:42:24.667
> 
> 标签：objective-c

我一直在网上寻找并惊讶于我没有找到答案。我有大约 20/30 行文本要显示，大约有 5 个标题，最后一个部分带有电话号码/电子邮件（需要标记以供点击）。展示这些东西的最佳方式是什么？

我使用核心文本吗？（网上没有容易理解的例子）

如何标记文本中的标题？

我应该使用网络视图还是坚持使用本机？

# sql - 与合并的复杂连接

> ID：12100415
> 
> 赞同：1
> 
> 时间：2012-08-23T21:42:56.607
> 
> 标签：sql, sql-server-2005, join, coalesce

我有一张表，我将人口统计信息填充到其中，然后使用动态 sql 从中构建一个表。人口统计信息来自调查，一些调查带有复选框。使用复选框，人们可以选择多个值。

所以我需要以逗号分隔的列表形式输入所有选项。

```
CREATE TABLE Demographics 
  (
    QID NVARCHAR(15)
    ,userid NVARCHAR(50)
    ,question NVARCHAR(800)
    ,choice NVARCHAR(1000)
  )
...
...
--Demographics(QID,userid,question,choice)
--'Insert checkbox (type 5)
INSERT INTO Demographics
SELECT CAST(q.QID AS NVARCHAR(15))
    ,ri.userid
    ,q.QuestionText
    ,ac.Choice
FROM ResponseInfo ri --response details
JOIN Responses r ON ri.ResponseID = r.ResponseID --actual response
JOIN Questions q ON r.QID = q.QID --question info
JOIN AnswerChoices ac ON r.QID = ac.QID --answer choice text
WHERE (q.QuestionTypeID = 5 AND q.QID = ac.QID
AND r.IsOther = 0 
AND q.QID = 16
)
AND ri.userid IN (SELECT userid FROM @Users) AND r.Response = ac.Sequence
ORDER BY ri.userid
...
dynamic sql stuff
...
EXEC sp_exesql @sql 
```

我的结果如下所示：

```
users | question_15 | choice_15 | question_16     | choice_16 |
bill  | age?        | 37        | favorite color? | red       |
bill  | age?        | 37        | favorite color? | green     | 
```

但它必须是：

```
users | question_15 | choice_15 | question_16     | choice_16 |
bill  | age?        | 37        | favorite color? | red,green | 
```

我试着做

```
,COALESCE(ac.Choice + ',','') + ac.Choice 
```

它给了我

```
bill  | age?        | 37        | favorite color? | red,red   | 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:54:42.363

看起来您正在使用 SQL Server。如果您使用的是 SQL Server 的最新版本（例如，SQL Server 2005 或更高版本），您最好将数据存储为 XML。

这使您可以在 SQL 中使用 XPATH/XQUERY 来操作 XML 数据以获得您想要的。我想你会发现这样做更容易。

*   [http://www.simple-talk.com/sql/learn-sql-server/sql-server-xml-cribsheet/](http://www.simple-talk.com/sql/learn-sql-server/sql-server-xml-cribsheet/)
*   [http://www.simple-talk.com/sql/t-sql-programming/beginning-sql-server-2005-xml-programming/](http://www.simple-talk.com/sql/t-sql-programming/beginning-sql-server-2005-xml-programming/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T16:47:00.223

[找到了这个](https://stackoverflow.com/questions/7755815/merge-row-values-into-a-csv-a-k-a-group-concat-for-sql-server)。

很有帮助。我的代码可能需要进行一些清理。

# c# - Xaml 不是破坏了我的封装吗？

> ID：12100417
> 
> 赞同：2
> 
> 时间：2012-08-23T21:43:03.480
> 
> 标签：c#, wpf, winforms, xaml, encapsulation

好的，我想我在这里遗漏了一些东西。

可以说，在 Winforms 应用程序中，我有一个 Form 和一个 UserControl。然后我将一个Button 添加到UserCntrol，然后将UserControl 添加到Form。现在 Button 作为私有成员添加到 UserControl 中，并且在 UserControl 通过公共属性公开它的私有成员之前，Form 不应访问 Button。

```
private void Form1_Load(object sender, EventArgs e)
{
    this.testUserControl1.
} 
```

您不会从 Form 的代码中找到 UserControl 的 Button。从封装的角度来看，我认为这正是我们想要的。

现在让我们说，我在带有 Window 和 UserControl 的 WPF 应用程序中做同样的事情。我通过 Xaml 将 Button 添加到 UserControl，然后将 UserControl 添加到 Window。但现在我可以从 Window 的代码中访问 Button。

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
    this.testUserControl1.button1.Content = "What the HELL!";
} 
```

如果我通过代码而不是 Xaml 添加按钮，我仍然有机会将其设为私有。但是“以声明方式构建 UI，而*不是*通过代码”——这不是 Xaml 存在的原因吗？那不是打破了封装的概念吗？

**编辑：**我知道我们大多数人，包括我自己，都使用 MVVM 开发 WPF 应用程序，您不需要从代码隐藏中引用您的 UI 元素。但是这个问题的背景仍然成立，对吧？我经常构建可重用的 UserContolr（不像 MVVM 中那样作为视图）在多个视图中使用它们作为视觉元素，我通常不需要使用 UserControl 的代码隐藏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:00:26.660

我不太确定你在说什么。您可以在 XAML 中制作 Button 并将其设为私有：

```
<Button x:FieldModifier="private" x:Name="Whatever" Content="This is a button" /> 
```

您不必通过代码来完成。只是它默认为（我认为）`internal`而不是`private`. 但就像 HB 说的那样，我很少为我的控件命名，所以我自己没有遇到过这个。

# c# - 从编码的 URL 中获取值

> ID：12100425
> 
> 赞同：0
> 
> 时间：2012-08-23T21:43:22.137
> 
> 标签：c#, asp.net, .net, winforms

我正在尝试从 C# 中的编码 URL 获取值。例如，我试图从以下位置获取“customerID”：

```
 http://<DOMAIN>/default.aspx%3FcustomerID%3D12345%26reference%3D2222 
```

我尝试了以下方法：

```
 string customerID = HttpUtility.UrlDecode(Request.QueryString["customerID"]); 
```

但它返回NULL。获得此值的正确方法是什么？

谢谢杰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:51:30.333

```
string str = " http://DOMAIN/default.aspx%3FcustomerID%3D12345%26reference%3D2222";

var url = HttpUtility.UrlDecode(str);
var parameters = HttpUtility.ParseQueryString(new Uri(url).Query);
var id = parameters["customerID"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:47:43.577

你的应用程序应该编码？和 = 符号。请求变量通常在信息被传递给处理请求的应用程序之前由 iis 设置。您需要发送应该编码的值，而不是整个 url。如果您的网址看起来像 ?customerID=1234 我想它会起作用，那么问题不在于您的代码，而在于网址的构造方式。

# mysql - 只允许选择具有许多权限的 MySQL 用户

> ID：12100429
> 
> 赞同：1
> 
> 时间：2012-08-23T21:43:40.500
> 
> 标签：mysql, sql, database

我正在创建一个数据库应用程序，它提供任何数据库的动态视图。对于安全功能，我只想允许选择。这可以简单地通过检查第一个单词是否被选中来完成吗？我知道我应该创建另一个具有有限权限的用户，但我试图避免这种情况，以便我的应用程序易于使用。

基本上，有人可以给我一个示例查询，其中 SELECT 是第一个单词，但实际上可以更改数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:52:30.533

> 有人可以给我一个示例查询，其中 SELECT 是第一个单词，但实际上可以更改数据？

~~没有这样的事。`SELECT`仅用于数据读取。~~当然，除非您选择更改数据的功能。请参阅@spencer7593 答案。

但是，您可能想要检查行阻塞`SELECT`命令并避免它们，因为您似乎会将您的数据库开放给第 3 方。

进一步阅读： [http ://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html](http://dev.mysql.com/doc/refman/5.0/en/innodb-locking-reads.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:06:09.770

这是一个可以修改数据的 SELECT 语句示例（这是一个晦涩的极端情况，但它表明可以使用*SELECT*来修改数据）

```
SELECT udf_myfunction() 
```

给定，例如：

```
CREATE FUNCTION udf_myfunction() RETURNS INT
READS SQL DATA
BEGIN
   DELETE FROM dummy_table1;
   UPDATE dummy_table2 SET mycol = CONCAT(mycol,SUBSTR(mycol,1,1));
   RETURN 0;
END 
```

（当然，用户需要被授予`EXECUTE`对该函数的权限，才能执行该函数。）

# javascript - 在同一元素上使用 .addClass() 后修改 .hover()

> ID：12100432
> 
> 赞同：1
> 
> 时间：2012-08-23T21:43:47.003
> 
> 标签：javascript, jquery, addclass, jquery-hover

因此，我尝试使用 .hover() 方法，该方法仅在悬停的元素没有特定类时才执行某些操作。如果我将类添加到 HTML 中的相关元素，它工作正常。但是假设我有一个使用 .addClass() 使用 jQuery 添加类的单击事件。然后 hover() 方法会忽略已添加的类。够啰嗦了。这是代码。

```
$('.foo:not(.bar)').hover(function() { 

    someCrap();  //when hovering a over .foo that doesn't also have the class .bar, do someCrap

}

$('.foo').click(function(){

    $(this).addClass('bar'); //after the element .foo gets another class .bar, the hover event written earlier continues to work, WTF

}) 
```

任何想法男孩和女孩？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:46:34.147

[`.hover()`](http://api.jquery.com/hover/)仅向已创建的*元素*添加事件。您还需要[`.on()`](http://api.jquery.com/on/)用于为未来*元素*创建事件。这意味着您还需要设置*父*级。最好*父母*应该尽可能靠近应该有鼠标事件的*孩子*，以节省性能。

```
$('#parent').on({
    mouseenter : function() {
        "use strict";
        // Do something
    },
    mouseleave: function() {
        "use strict";
        // Do something
    }
}, ".foo:not(.bar)"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T21:54:18.193

当您运行`$(selector).hover(fn);`任何匹配*选择器*的元素时，都会将事件绑定到它们。如果您要添加/更改/删除有关选择器的某些内容，稍后会使该元素不再匹配，则该事件不会在意，因为它已经被绑定。

有几种方法可以处理这个问题，这实际上取决于应用程序中 JavaScript 的数量和用例的具体情况。

1）您可以使用*事件委托*，它利用 JavaScript 事件冒泡的方式允许您将事件绑定到页面特定部分的父元素并在事件发生时执行逻辑 - 这是出于几个原因非常有用。第一，假设您有一个包含 100 条记录的表和一个包含某个类的链接，`edit`当有人点击它时应该会触发一个特定的 JavaScript 函数。如果你这样做`$('a.edit').click(fn);`jQuery 最终会将 100 个不同的事件绑定到各个元素。这可能会使您的应用程序在较旧的机器/浏览器中遇到困难。其次，它使得当事情动态变化时（您向表中添加新行或从链接中删除编辑类，因为您不再希望允许特定行可编辑）您的事件足够聪明，可以知道发生了什么并且仍然有效。在 jQuery 中，您可以使用该`.on()`函数。阅读[文档](http://api.jquery.com/on/)。如果您有早期版本的 jQuery，您可能必须使用`.delegate()`，并且如果您正在运行一些非常旧的 jQuery 函数，您正在寻找`.live()`.

2）如果您的应用程序相对较小，一种更简单的方法是简单地将事件绑定到所有`.foo`元素并在事件本身中检查元素当前是否具有类，`bar`如果没有则继续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T21:53:56.663

我会说它更像是：

```
$( '.foo' ).hover(
 function() { if ( $( this ).has( '.bar' ) ) {} else { // do something } },
 function() { if ( $( this ).has( '.bar' ) ) {} else { // do something } }
); 
```

# php - PHP PDO：在 IN() 中选择数组

> ID：12100434
> 
> 赞同：0
> 
> 时间：2012-08-23T21:43:50.890
> 
> 标签：php, mysql, loops, pdo

我玩游戏有点晚了，正在尝试从 mysql_* 过渡到 PDO，同时尝试应对当前的挑战。我有一个界面，我在其中捕获数组中的框编号值，并且该数组按行项存储在另一个数组中（为了清楚起见，这些是嵌套数组）。

我的主要目的是获取特定行项目的框号并运行 mysql 选择查询以返回给定框中的单元数。如果框中的数量不是用户认为的数量，我希望它抛出错误。

目前我的挑战是我得到一个空的结果集。我相信这是由于我的框号数组没有正确传递给 PDO 选择语句。任何想法或指导将不胜感激。

这是我到目前为止所拥有的：

```
$Boxes = $_POST['Boxes']; //this includes box numbers within an array for each line item of a form

$e = 0;

while($e<$num1){
$units = 0;
$r = 0;
$SO_Line_Item=mysql_result($result1,$e,"SO_Line_Item");

    foreach ($Boxes[$e] as $a => $b)  // the purpose of this loop is to take the values from Boxes and store it in $zzz which I hope to use in my Select statement below.
    {
    $zzz[] = $Boxes[$e][$r];
    $r++; 
    }
   //end inner foreach

$BNs= implode(',', $zzz);

$db = new PDO('mysql:host=XXXXXX ;dbname=XXXXXX', $dbuser,$dbpass);
$stmt = $db->prepare("SELECT Box_Num,Timestamp,SN,Assy_Status FROM Current_Box WHERE Box_Num IN(' . $BNs . ')");
$stmt->execute($zzz);   

$results = $stmt->fetchAll(PDO::FETCH_ASSOC);
var_dump($results); // this shows up as an empty array

}  
$e++;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T00:24:02.440

这样就搞定了。感谢 Marc B 的想法：

```
$e = 0;

while($e<$num1){
$units = 0;
$r = 0;
$SO_Line_Item=mysql_result($result1,$e,"SO_Line_Item");

    foreach ($Boxes[$e] as $a => $b)  
    {

        $zzz[] = $Boxes[$e][$r];

$ce = count($Boxes[$e]);        

    $r++; 
    }
//end inner foreach

$products = implode(',', array_fill(0,$ce, '?'));

$db = new PDO('mysql:host=192.168.1.197 ;dbname=Tracking', $dbuser,$dbpass);
$stmt = $db->prepare("SELECT Box_Num,Timestamp,E3_SN,Assy_Status FROM Current_Box WHERE Box_Num IN( $products )");
$stmt->execute($zzz);
$results = $stmt->fetchAll(PDO::FETCH_ASSOC);
}
unset($zzz);
$e++;
} 
```

# ios - 界面构建的更改未显示在应用程序中

> ID：12100440
> 
> 赞同：0
> 
> 时间：2012-08-23T21:44:36.243
> 
> 标签：ios, xcode, xcode4, interface-builder

我对我的 xcode4 应用程序的主视图进行了一些更改；移动了一些按钮，更改了一些标题；运行它并看到所有的变化。回去，做更多的改变，运行它；变化不再出现。已从界面生成器完成文件 > 保存。已关闭并重新打开 xcode4。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:00:05.547

哇，xcode4，willy-nilly，在我的项目中创建了一个目录“en.lproj”并将我的 .xib 文件移到那里。

解决方案： 1\. 将我的 .xib 移回我的项目目录。2.删除en.lproj目录 3.重建

工作正常。

发生了什么？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:05:48.027

我认为每个 xCode 项目都会创建该目录，这就是它自动放置 .xib 或情节提要的位置。至少我所有的项目都是这样。也许它只是糊涂了？

# git - 为什么git停滞不前？

> ID：12100444
> 
> 赞同：3
> 
> 时间：2012-08-23T21:45:01.637
> 
> 标签：git

我在本地使用 git。在一个目录中，我们称之为项目，我初始化了一个 git 存储库。当我创建/修改文件时，我使用了“git add file”和“git commit”。这些文件现在变成了两个看似独立的项目的混合体，因此我将 project1 文件放入名为 Project1 的子目录中，将 project2 文件放入名为 Project2 的子目录中。我将父目录名称从 Project 更改为 Project12。

完成所有这些之后，我意识到我忽略了考虑我的 git 存储库，所以我将所有文件移回 Project12 旁边的 Project1 和 Project2 目录中，并计划在将它们移回之前“git add --all”它们各自的子目录。

但是当我使用 'git add --all' 时，git 停止了。除了下一行的光标在不合时宜的时间内闪烁之外，什么也没有发生。'Git status' 有各种各样的删除和来自所有移动的新文件。我虽然会尝试清除暂存区域，然后添加/提交。根据我所做的研究，我尝试了“git reset”。这不仅没有解决 'git add --all' 之后的停顿问题，而且现在 git 在 'git status' 之后停顿，光标在下一行闪烁。

我不想'git reset --hard'，因为有些文件我已经更改但没有提交，所以我不想丢失这些更改。我试过'git stash'，但这也停止了。

我应该补充一点，我仍然可以'git add file'，但是有很多文件，我最终想知道出了什么问题。

我对 git 有点陌生，所以如果有人可以解释他们认为这里发生了什么，我将不胜感激。我不确定此时要粘贴什么输出，因为我只是得到一个闪烁的光标。

目标是将文件放入各自的子目录并继续添加/提交到同一分支。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T04:45:26.167

有一个数据文件太大，导致 git 停滞不前。由于每次程序运行时都会创建数据文件，因此可以选择删除数据文件，从而解决了停顿问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T05:37:11.093

摆脱这种混乱局面的一种方法是：

*   在单独的仓库中本地克隆您的仓库
*   检查该克隆是否确实是您在执行所有这些移动/添加/删除之前所拥有的...
    （如果不是，请检查或重置为正确的 SHA1 以获得重组之前的内容）
*   在那个新的仓库中重现你需要的东西，然后在`git add -A`那里试试。

这个想法是不要在看起来有点不稳定的原始存储库中保留太多时间，并检查问题是否在新克隆的存储库中仍然存在。

# c# - ICal 无法读取 .ics 文件

> ID：12100445
> 
> 赞同：2
> 
> 时间：2012-08-23T21:45:04.293
> 
> 标签：c#, asp.net-mvc-3, icalendar

我正在使用 DDay.iCal 库创建 .ics 文件，以便在 iPhone、iPad 和 Mac 上导入 iCal。我已经能够很好地创建该文件，但是当我尝试在上述任何设备上将其导入 iCal 时，我收到一般错误“iCal 无法读取此文件，您的日历中没有添加任何事件”。

这是 .ics 文件的内容：

```
BEGIN:VCALENDAR
VERSION:2.0
METHOD:PUBLISH
PRODID:Local Ruckus 04508292-17ee-4721-ab6d-f6ea49f972d0
BEGIN:VEVENT
DESCRIPTION:Our Miller Lite Hot Country Nights concert series presented by 
 Q104 is back for its 5th year!Shows begin around 7pm. Get here early to cl
 aim your spot! Free and open to public of all ages. Under 21s MUST be acco
 mpanied by a legal guardian and must arrive before 9pm. Venue is 21+ after
 9pm.
DTEND:20120823T230000
DTSTAMP:20120823T213408Z
DTSTART:20120823T190000
SEQUENCE:0
SUMMARY:Hot Country Nights Concert Series
UID:de56c779-63c0-4dc5-b532-4b5a1d31f5ec
END:VEVENT
END:VCALENDAR 
```

有人可以帮我弄清楚这个文件有什么问题吗？

谢谢

# java - Java：调用超类的构造函数，该构造函数调用设置子类字段的覆盖方法

> ID：12100449
> 
> 赞同：9
> 
> 时间：2012-08-23T21:45:15.790
> 
> 标签：java, overriding, field, super

我有这个演示代码：

```
class Test2 extends Test {
    public int number = 0;

    @Override
    public void set(){
        number = 1;
        info();
    }

    @Override
    public void info(){
        System.out.println(number);
    }
}

public class Test {
    public Test(){
        set();
    }

    public void set(){
    }

    public void info(){
    }

    public static void main(String[] args){
        Test2 object = new Test2();
        object.info();
    }
} 
```

代码给出了这个输出：

```
1
0 
```

为什么？我期望这个输出：

```
1
1 
```

在我看来，主函数调用 Test2 类的构造函数来创建对象。构造函数自动调用超类的构造函数。此构造函数调用被覆盖的方法 set()。因此调用了 Test2 类的方法 set()。此方法设置字段并调用写入数字的 info() 方法。然后主函数再次调用创建对象的 info() 方法。

数字字段正确设置为第一行输出为“1”。但是为什么第二行包含 0？似乎根本没有设置该字段。你能解释一下吗？

我应该怎么做才能得到我期望的行为？提前致谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-23T21:53:10.723

```
class Test2 {
    public int number = 0;
} 
```

相当于

```
class Test2 {
    public int number;

    public Test2() {
        super();
        number = 0;
    }
} 
```

因此，通过调用超级构造函数，该字段`number`被设置为 1。在从超级构造函数返回后，`number`执行对 0 的赋值。

只需删除分配，它的行为就会如您所愿。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-04T11:22:59.480

如果说 Animal 扩展 Dog 并且你调用 Animal a = new Dog()

**然后步骤顺序如下**

1.  Animal 的静态字段被初始化

2.  执行动物的静态块

3.  Dog 的静态字段已初始化<如果 Animal 无论如何更改它们，它们将被重新初始化>

4.  Dog 的静态块被执行

5.  动物的非静态字段已初始化如果动物无论如何更改它们，它们将被重新初始化>

6.  动物构造函数被执行

7.  狗初始化的非静态字段<如果动物改变它们，它们将被重新初始化>

8.  Dog 构造函数被执行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:59:01.700

您的代码违反了 Java 中的一条黄金法则——永远不要在构造函数中调用可以被子类覆盖的方法——即此类方法应该是私有的。

当 Test2 中的默认构造函数完成时，它已经覆盖了通过初始化器分配给它的初始值 1 `public int number = 0;`。

# javascript - JavaScript：编造了一个 CodeCademy 教程

> ID：12100450
> 
> 赞同：0
> 
> 时间：2012-08-23T21:45:25.293
> 
> 标签：javascript

我正在 codecademy.com 上编写 JavaScript 教程

它首先为您提供以下功能大纲

```
var getReview = function (movie) {

}; 
```

然后它会为您提供电影列表，并告诉您编写一个函数，以便它根据作为参数传入的任何电影返回对电影的评论。该问题还建议您使用 switch 语句。以下是我想出的，但这不是正确的答案。不幸的是，Codecademy 没有透露答案。我认为在函数中放置 switch 语句很奇怪，但这就是它所说的必须完成的事情。

谁能解释我做错了什么？

```
var getReview = function(movie) {

var result;

switch (movie) {

  case "Matrix":
    result = "good trip out";
    break;

  case "Princess Bride":
    result = "awesome date night movie";  
    break;

  case "Welcome to America":
    result = "Amjad's favorite";
    break;

    case "Remember the Titans":
    result = "love the sports";
    break; 

    case "Why do I look like I'm 12?":
    result = "The Ryan and Zach story"
    break; 

    case "Fighting Kangaroos in the wild";
    result = "Token Australian movie for Leng"
    break; 

    default:
    result = "I don't know";
}

return result; 
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:52:43.723

```
case "Fighting Kangaroos in the wild"; 
```

应该是冒号，而不是分号。

在分配给 的行之后也缺少几个分号`result`。

由于函数是可重用的代码块——任何代码——switch 语句在其中是完全合法的。在这种情况下，这是必要的，因为该函数需要将传递`movie`的值与可能的情况列表进行比较。

ps 如果您是 JS 新手，也要养成良好缩进的习惯 :) 这对您有利。

# adb - 在非 root 设备上需要 adb shell 的帮助

> ID：12100451
> 
> 赞同：2
> 
> 时间：2012-08-23T21:45:25.927
> 
> 标签：adb

我对`adb shell`设备登录感到困惑，我无法进入 root 模式（# 模式）。我只能`adb shell`在任何非 root 设备上访问 $ 模式，例如三星 Galaxy Note、Galaxy 2 和三星 Galaxy Apollo (2.1)，并且无法使用“su -”命令成为超级用户，因此仅限于目录，例如`/data/data/com.myapp.exmple`.

但是使用 root 设备可以使用 adb shell 获得 root 访问权限，并访问它们所以我的基本疑问是使用非 root 设备我们可以使用 adb shell 获得 root 访问权限吗？

如果没有，我正在使用 Andrew Hoog 的书“Synergy Android Forensics”，它演示了 adb shell 可以让您在非 root 设备上访问 root（#mode），而且互联网和论坛上也很少有这样的例子。以这个视频为例。

[http://www.youtube.com/watch?v=tVJ7T2oC_Zs](http://www.youtube.com/watch?v=tVJ7T2oC_Zs)

这基本上演示了如何使用 解锁安全模式锁`adb shell`，它在非 root 设备上获得 root 访问权限（# 模式）。

如果是的话，我犯了什么错误？我安装了最新的 JDK，然后在 C: 中安装了 Android sdk，然后从`c:android-sdk/platform-tools/`目录尝试访问 adb shell。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T09:15:40.960

我正在使用 Android 4.1.2 运行 Cyanogenmod，所以这可能不适用于股票 rom。当我进入

```
adb root 
```

控制台返回

```
root access is disabled by system setting - enable in settings -> development options 
```

在该菜单中，您可以*禁用 root 访问权限*，仅授予*应用程序*、仅*adb*以及*应用程序和 adb*权限。选择*应用程序和 adb*，一切都应该按预期工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-04T13:23:04.127

AFAIK`adb root`或`su-`不会在非 root 的 android 手机上工作。

您可以通过 Google 了解如何根植您的特定型号，但请注意，如果您强行根植手机，可能会失去公司保修。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T08:55:28.120

在 Android 上有一个获取 root 访问权限的命令：

```
adb root 
```

我不知道它是否适用于任何版本的Android。上述命令以 root 身份重新启动 adb。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T16:40:30.523

为 android 4.2 点击您的设备版本版本号（在信息页面底部） 7 次。这将启用开发人员的菜单。

# c# - SQL Server Compact Edition 未在 Visual C# 2010 express 中显示

> ID：12100452
> 
> 赞同：1
> 
> 时间：2012-08-23T21:45:26.290
> 
> 标签：c#, sql-server-ce

我使用的是 64 位 win7，刚刚安装了 Visual C# 2010 express，我没有精简版的选项。我应该安装什么来获得它？![在此处输入图像描述](../Images/2f1080926152166f33921881fa92658e.png)

我已经安装了这个： [http](http://www.microsoft.com/en-us/download/details.aspx?id=5783) ://www.microsoft.com/en-us/download/details.aspx?id= 5783 (SQLCE 3.5) [http://www.microsoft.com/en-us/download/details。 aspx?id=17876](http://www.microsoft.com/en-us/download/details.aspx?id=17876) (SQLCE 4.0)

而且我的“卸载程序”中有两个 SQLCE

![在此处输入图像描述](../Images/4edcfdadc73287505badf808ae1f1f34.png)

# iphone - ios编程中UIViews切换的正确方法

> ID：12100457
> 
> 赞同：0
> 
> 时间：2012-08-23T21:45:36.743
> 
> 标签：iphone, objective-c, ios

大家好

我是一个新手 ios 程序员，当我必须切换我的应用程序的页面时，我面临着很多疑问。

术语“页面”是指一个 UIView，它用一些小部件（按钮、文本框、表格..）填充整个屏幕

据我所知，我应该使用 UIViewController 来管理这些页面中的每一个，因为每个页面都应该是一个屏幕的内容。

我的应用程序以带有许多按钮的 ViewScroller 开始，当用户单击其中一个按钮时，它会打开一个新页面。

第一个页面是连接到 Window 的 RootController 的 UIView。

到目前为止，为了打开新页面，我向 RootController 添加了一个子控制器，它作为 RootController 视图的子视图：

```
RicLocaliController = [[RicercaLocaliViewController alloc] initWithNibName:@"RicercaLocaliViewController" bundle:nil];

[self addChildViewController:RicLocaliController];

[RicLocaliController didMoveToParentViewController:self];        

[self.view addSubview:RicLocaliController.view];

RicLocaliController.view.frame = self.view.bounds; 
```

当用户单击“返回”按钮时，我删除了子控制器和子视图。

沿着这条路走下去，我会得到一个动态的控制器树及其视图。

到目前为止，我还没有遇到任何问题，我的应用程序可以在树中上升到第三级并返回。当方向改变时，每个页面的行为都正确。

但恐怕为每个子页面添加一个子控制器和一个子视图可能不是正确的做法。

我担心如果我在方向改变时嵌套很多页面，应用程序可能会响应缓慢，因为超级视图也会做一些事情来管理这个事件。

所以我想知道我所做的是否完全没有意义，是否应该使用导航控制器或其他方式来管理我的页面更改。

不幸的是，我的老板没有给我足够的时间来好好学习这个主题，所以我想要一个建议来遵循最好的解决方案，可能使用框架提供的最标准和不太复杂的组件，而不是最新的功能。

我阅读了很多关于这个主题的网页，但在我看来，有很多方法可以管理 beetwen 导航页面，这让我感到困惑。

我为我糟糕的英语道歉，但我累了，英语不是我的第一语言。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T21:59:07.980

你必须做一些学习。否则，您稍后将花费更多时间来解决所有问题……但是，这里有一些提示。

使用嵌套的 ViewController 会导致各种麻烦，所以如果您时间不够，请跳过它。

将每个“页面”视为一个 ViewController。ViewController 有一个名为 View 的属性，但它实际上只是整个视图层次结构的顶层视图。视图是任何视觉对象的基类，如标签、按钮等。所有视图都可以有子视图，因此您可以在标签等下添加图像，并且如果您愿意，可以做一些非常奇怪的事情。我这样说只是为了让您解放思想，了解如何使用视图。

现在，ViewController 应该将代码保存到一个视图层次结构中。该视图层次结构仅适用于该视图控制器。

当用户想要导航到另一个页面时，您有几种选择：

NavigationViewController - 当用户想要深入研究数据时应该使用它，例如打开列表中项目的详细视图等。NavigationViewController 为您提供后退按钮、正确动画等方面的帮助。您“弹出”一个视图控制器去退一级。如果用户单击后退按钮，这是自动的。

TabBarViewController - 如果你想在屏幕底部有一个标签栏，请使用它。每个选项卡都连接到一个 ViewController，它有自己的视图层次结构。

PushModal - 如果您在 ViewController 中并且只需要从用户那里获取一些数据，这不是应用程序正常导航的一部分，您可以以模态方式推送新的 ViewController。这是您与内置于 ViewControllers 的 iOS 交互的方式。这也是从视图控制器获取值的好方法。

你有它。去了解更多。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:00:34.250

听起来，对于您正在使用的东西，您应该使用导航控制器。这将自动处理将视图推送到堆栈上，然后再将它们弹出。这还将在导航栏中自动创建一个后退按钮（可自定义）。

如果您使用的是 iOS 5 或 6，我强烈建议您在 Interface Builder 中尝试“故事板”。故事板允许您以图形方式表示不同视图之间的转换（称为“segues”）。

除了更易于设计和实现之外，另一个优点是，如果将来您想更改应用程序的设计，您不必遍历所有代码并手动更新每个视图连接。

# php - 使用 PHP 和 MySQL，您应该检查回滚失败吗？

> ID：12100461
> 
> 赞同：10
> 
> 时间：2012-08-23T21:45:44.273
> 
> 标签：php, mysql, transactions, innodb

我正在使用 PHP 的 mysqli 库。数据库插入和更新总是在一个 try-catch 块中。立即检查每个查询是否成功（`if $result === false`），任何失败都会引发异常。catch 调用`mysqli_rollback()`并退出，并为用户发送一条消息。

我的问题是，我应该费心检查 的返回值`mysqli_rollback()`吗？如果是这样，并且回滚失败，代码应该采取什么行动？

我很难理解回滚是如何失败的（除非 MySQL 中有一些严重的错误）。而且由于 PHP 无论如何都会退出，调用回滚几乎是多余的。为了清楚起见，我当然认为它应该在代码中，但是当 PHP 退出时，它将关闭与 MySQL 的连接，并且未提交的事务会自动回滚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T11:48:02.197

如果回滚失败（例如连接失败），无论如何都会在连接关闭后回滚更改，因此您不需要处理错误。当您在事务中时，除非您有显式提交（或者您在自动提交模式下运行，这意味着您在每个语句之后都有提交），否则事务正在回滚。

> 如果禁用了自动提交的会话在没有明确提交最终事务的情况下结束，MySQL 会回滚该事务。

您想要处理回滚错误的唯一情况是您没有退出脚本，而是稍后启动新事务，因为启动事务将隐式提交当前事务。查看[导致隐式提交的语句](http://dev.mysql.com/doc/refman/5.1/en/implicit-commit.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:03:21.117

`mysqli_rollback`如果您没有（从未）连接到数据库，则可能会失败。取决于您事先的错误处理。

# python - 理解python 2.7 email.feedparser Feedparser __init__ 函数

> ID：12100463
> 
> 赞同：1
> 
> 时间：2012-08-23T21:45:52.283
> 
> 标签：python, python-2.7

*（所以我正在尝试学习python。我认为阅读比我更好的人的代码会很好。我决定通读电子邮件模块......）*

`init`模块中 Feedparser 类的函数`email.feedparser`定义为：

```
def __init__(self, _factory=message.Message):
    """_factory is called with no arguments to create a new message obj"""
    self._factory = _factory
    self._input = BufferedSubFile()
    self._msgstack = []
    self._parse = self._parsegen().next
    self._cur = None
    self._last = None
    self._headersonly = False 
```

我遇到的问题是：

```
self._parse = self._parsegen().next 
```

我认为应该意味着'将属性设置为方法返回值的属性`self._parse`值`next``self._parsegen()`

据我所知，`self._parsgen()`在调用期间`__init__()`将首先调用`self._new_message()`它将设置/添加值到`self._cur`,`self._last`和`self._msgstack`. 然后它将一个空列表对象分配给局部变量`headers`，然后开始迭代该`self._input`对象。我认为 for 的第一个值`line`将是一个`NeedMoreData`对象。由于`NeedMoreData`该类只是扩展对象，因此它应该没有名为的属性或方法`next`。那么是否`next`只是指回迭代器（`self._input`）？

有什么办法可以在解释器中查看这个，以便我可以单步执行脚本的每一行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:29:41.343

> 那么是否`next`只是指回迭代器（`self._input`）？

`next`确实指的是*生成器*。由于该`_parsegen()`方法使用`yield`，它返回一个生成器对象。考虑以下简单示例（来自 IPython）：

```
In [1]: def a():
   ...:     yield 1
   ...:     yield 2
   ...:     

In [2]: a()
Out[2]: <generator object a at 0x1a56550>

In [3]: a().next
Out[3]: <method-wrapper 'next' of generator object at 0x1a567d0>

In [4]: a().next()
Out[4]: 1 
```

所以，是的，你基本上是对的。它将下降到迭代器，并引用从它返回下一个值的方法。

> 有什么办法可以在解释器中查看这个，以便我可以单步执行脚本的每一行？

您可以为此使用[pdb](http://docs.python.org/library/pdb.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T22:30:04.843

该`next`方法是一种生成 python`iterator`或`generator`. 考虑这个问题的最简单方法是重写一个 for 循环。

你有一个非常简单的语法来循环列表：

```
for element in list:
    print element 
```

`element`这将在每次迭代中产生一个。但实际上，Python 正在做类似这样的事情：

```
iterator = iter(list)
while True:
    element = iterator.next()
    # do something with element (e.g. print it)
    print element 
```

当迭代器耗尽（没有更多项）时，它会引发`StopIteration`异常，这就是`for`循环和其他使用迭代器的方法知道何时停止的方式。（所以前面的代码片段真的应该被包装在一个`try/except`块中，但我认为没有它会更清楚阅读）。

您可以在 Python 文档中阅读有关[迭代器的协议。](http://docs.python.org/library/stdtypes.html#iterator-types)（但基本上任何东西都可以是迭代器，如果它定义`__iter__`并产生一个定义 and 的迭代`__iter__`器 `next`。

# php - SQL LIKE 使用 Drupal 7 查询 PHP 序列化数据

> ID：12100472
> 
> 赞同：0
> 
> 时间：2012-08-23T21:46:54.323
> 
> 标签：php, sql, serialization, drupal-7, sql-like

使用 Drupal 7，我正在尝试使用 LIKE 命令从数据库中获取结果，但它无法识别我的通配符。我不确定这是否是 Drupal 问题，或者我做错了什么。无论如何，这是我试图匹配的数据的一个例子，以及我的模式

**匹配的数据**

```
a:2:{i:1;s:2:"17";i:2;s:1:"3";} 
```

**我喜欢的查询**

```
$pattern1 = 'a:2:{i:1;s:2:"17";i:2;s:1:"%";}'//works
$pattern2 = 'a:2:{i:1;s:1:"%";i:2;s:1:"3";}'//fails

$result = db_query(
    "
        SELECT pa.nid, pa.model, pa.combination
        FROM {$Product_Adjustments} pa
        WHERE pa.combination LIKE :pattern
    ",
    array(
        ':pattern' => $pattern1
    )
); 
```

此外，我尝试了 '_' 通配符，但这也没有带来任何东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:56:16.797

你确定模式是正确的？注意模式 1，第一个字符串是 2 长，而在模式 2 中，您正在寻找一个只有 1 长的字符串。你确定这是对的吗？该序列化数据的各个片段的长度是否足以预测甚至可以以这种方式查询？这似乎不太可能，您可能不得不存储一些标准化数据。

# java - Java运行时在程序内部执行与在命令行中执行不同？

> ID：12100479
> 
> 赞同：2
> 
> 时间：2012-08-23T21:47:51.597
> 
> 标签：java, linux, runtime, runtime.exec

我尝试使用 Runtime.getRuntime.exec(command) 编译一些 java 文件并生成命令。下面的代码显示了我在做什么：

```
String command = "javac ";
    for(String s: this.getPackages())
    {
        command = command + "/home/benuni/CompileFiles/" + project + "/" + s + "/*.java ";
    }

    try {
        System.out.println("command: '"+ command +"'");
        Process pro = Runtime.getRuntime().exec(command);
         printLines(" stderr:", pro.getErrorStream());

        pro.waitFor(); 
```

这给出了以下输出：

```
command: 'javac /home/benuni/CompileFiles/HelloWorldProject/HelloWorldPackage/*.java '
stderr: javac: file not found:     /home/benuni/CompileFiles/HelloWorldProject/HelloWorldPackage/*.java
 stderr: Usage: javac <options> <source files>
 stderr: use -help for a list of possible options 
```

它不工作..但是如果我将命令复制到我的shell中，它就没有问题......有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T21:51:36.267

Java 不会`*`为您扩展通配符。那是shell的一个功能。相反，您需要列出目录以获取所有包含的文件。

像这样的东西可以构建你的命令：

```
 File[] files = new File("/home/benuni/CompileFiles/" + project + "/" + s).listFiles(new FilenameFilter() {
        @Override
        public boolean accept(File dir, String name) {
            return name.endsWith(".java");
        }
    });

    StringBuilder command = new StringBuilder("javac");
    for(File file : files) {
        command.append(" ").append(file.getAbsolutePath());
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:51:37.670

当您从命令行输入时，命令分析器将展开`*`为文件列表。当您使用 Runtime.exec 时，不会发生扩展，您必须明确指定整个列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:55:23.097

一种选择是向 javac 提供文件名的实际列表。另一种是让shell来做，使用命令

```
/bin/sh -c javac /home/benuni/CompileFiles/HelloWorldProject/HelloWorldPackage/*.java 
```

# javascript - Jquery：无限循环和暂停

> ID：12100483
> 
> 赞同：2
> 
> 时间：2012-08-23T21:48:43.847
> 
> 标签：javascript, jquery, loops

我有这个代码

```
var timeout = 0;
 $('#container td').each(function(){
   var td = this;
   setTimeout(function() {
     var new_text = $(td).find(text).html();
     popup_text.html(new_text);
     popup.fadeIn('fast').delay(1000).fadeOut('slow');
   }, timeout);
   timeout += 1000 + 1000;
}); 
```

我从表格单元格中获取文本并延迟显示在图层中。1个问题：如何使此代码在无限循环中运行？2问题：当你将鼠标悬停在popop循环暂时停止然后继续时，如何做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T23:19:35.087

One way is to put the code to be repeated in a function, and have the function repeat itself at the end:

```
var timeout = 1000;
var action = function() {
    // Do stuff here
    setTimeout(action, timeout);
};
action(); 
```

However, as ahren suggested, setInterval might be better:

```
var timeout = 1000;
var action = function() {
    // Do stuff here
};
setInterval(action, timeout); 
```

The difference is slight, but if the machine is running slowly for some reason, the setInterval version will run the code every second on average, whereas the setTimeout version will run the code once each second at most.

Neither of those methods really work well with each(), however, so you'll need to store the sequence of popups somewhere and step through them:

```
var timeout = 1000;
var tds = $('#container td');
var index = 0;
var action = function() {
    var td = tds[index];
    var new_text = $(td).html();
    popup.html(new_text);
    popup.fadeIn('fast').delay(1000).fadeOut('slow');

    if(++index >= tds.length)
        index = 0;        
};
setInterval(action, timeout);
action(); 
```

Finally, to avoid moving to the next popup while the popup is hovered, you can add a check for that at the start of the function. It's also necessary to rearrange the animations so that they go "check for hover - fade out - change text - fade in".

```
var timeout = 1000;
var tds = $('#container td');
var index = 0;
var action = function() {
    if(popup.is(':hover'))
        return;

    var td = tds[index];
    var new_text = $(td).html();
    popup.fadeOut('slow', function() {
        popup.html(new_text);
    }).fadeIn('fast');

    if(++index >= tds.length)
        index = 0;        
};
setInterval(action, timeout);
action(); 
```

jsFiddle: [http://jsfiddle.net/qWkYE/2/](http://jsfiddle.net/qWkYE/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T08:18:56.610

如果您喜欢简洁的方式，请使用[jquery-timing 插件](http://creativecouple.github.com/jquery-timing/)并编写：

```
$.fn.waitNoHover = function(){
  return this.is(':hover') ? this.wait('mouseleave') : this;
};
$('#popups div').repeat().each($).fadeIn('fast',$)
  .wait(200).waitNoHover().fadeOut('slow',$).all() 
```

​</p>

请参阅[http://jsfiddle.net/creativecouple/fPQdU/3/](http://jsfiddle.net/creativecouple/fPQdU/3/)

# jquery - 使用简单的 jQuery 图像加载器时遇到问题

> ID：12100484
> 
> 赞同：0
> 
> 时间：2012-08-23T21:48:59.387
> 
> 标签：jquery

我正在尝试实现一个简单的图像缩略图脚本，单击该脚本时会显示更大的图像。

我试图在不使用现有插件的情况下做到这一点。

这是我当前的代码。

```
$('#thumbnails ul li').click(function() {
$('#main').attr('src', $(this).attr('src').replace('small/', 'large/'));});​ 
```

有人可以让我知道我做错了什么吗？我也在这里上传了整个代码...... [http://jsfiddle.net/PjrFe/](http://jsfiddle.net/PjrFe/)

提前谢谢各位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T21:51:35.497

那是因为您正在检查点击的 li 的 attr 'src'；尝试这个：

```
$('#thumbnails ul li').click(function() {
   $('#main').attr('src', $(this).find('img').attr('src').replace('small/', 'large/'));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:20:31.237

当然:)这应该可以解决问题：

[http://jsfiddle.net/PjrFe/18/](http://jsfiddle.net/PjrFe/18/)

# iphone - 带有 Facebook v3.0.8 的 SBJSON 中无法识别的选择器？

> ID：12100488
> 
> 赞同：2
> 
> 时间：2012-08-23T21:49:21.647
> 
> 标签：iphone, facebook, json, sbjson

我下载了 Facebook SDK 3.0.8，并按照说明使用它（拖动框架和资源包）。

我尝试进行身份验证，它工作正常。然后我做：

```
 FBRequest *me = [FBRequest requestForMe];
        [me startWithCompletionHandler: ^(FBRequestConnection *connection,
                                          NSDictionary<FBGraphUser> *my,
                                          NSError *error) {

        }]; 
```

在完成处理程序中，我确实有我的用户对象，所以一切正常。（我知道这一点是因为我 NSLog'd out my.id）但是，在那之后，它通过这个堆栈跟踪得到一个无法识别的选择器异常：

```
objc_exception_throw ()
-[NSObject doesNotRecognizeSelector:] ()
___forwarding___ ()
_CF_forwarding_prep_0 ()
-[SBJSON objectWithString:allowScalar:error:]
-[SBJSON objectWithString:allowScalar:error:]
-[SBJSON objectWithString:error:]
-[FBRequestConnection parseJSONOrOtherwise:error:]
-[FBRequestConnection parseJSONResponse:error:statusCode:]
-[FBRequestConnection completeWithResponse:data:orError:]
__68-[FBRequestConnection startWithCacheIdentity:skipRoundtripIfCached:]_block_invoke_0
-[FBURLConnection invokeHandler:error:response:responseData:]
-[FBURLConnection connectionDidFinishLoading:] 
```

这不会在模拟器中发生，只会在我的设备上发生。我在运行 5.1.1 的 iPhone4S 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T14:14:57.733

很难说，真的。请纠缠 Facebook 升级他们的 SBJson 版本 - 他们使用的版本是*古老*的。如果问题出在 JSON 解析部分，升级可能会很好地解决您的问题。

# javascript - 如何使用 javascript（或 jQuery）将 youtube 视频添加到 iframe（基于 Web 的 RTE）

> ID：12100489
> 
> 赞同：0
> 
> 时间：2012-08-23T21:49:39.170
> 
> 标签：javascript, video, rich-text-editor, execcommand, web-based

我想创建一个带有 javascript (jQuery) 和 HTML 的富文本编辑器，其工作方式类似于“Blogger”。

我希望编辑器的用户能够添加格式化文本（粗体、不同大小的字体等）、添加图像和添加来自 YouTube 的视频。我的搜索结果显示所有基于 Web 的 RTE 都使用“document.execCommand”。虽然我找到了前两个示例（格式化文本和图像），但我没有找到任何添加视频的示例。

我尝试使用此代码（函数“测试”）但不起作用。单击按钮（theVideo）后，iframe（文本编辑器）为空。

```
<body onLoad="def()">
    ...
    <input type="button" id="theVideo" value="video..." onClick="test()" />
    ...
</body>

<script type="text/javascript">
function def(){
    var testframe = document.createElement("iframe");
    testframe.name = testframe.id = "textEditor";

    if (testframe.addEventListener){
        testframe.addEventListener("load",function(e){this.contentWindow.document.designMode = "on";}, false);
    } else if (testframe.attachEvent){
        testframe.attachEvent("load", function(e){this.contentWindow.document.designMode = "on";});
    }

    document.body.appendChild(testframe);

    textEditor.document.designMode="on";
    textEditor.document.open();
    html="<head><style type='text/css'>body{ font-family:arial; font-size:13px; }</style> </head>";
}

function test(){
    sembed = "<div>";

    sembed +="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0'"; 
    sembed +="data-thumbnail-src='http://3.gvt0.com/vi/JQu2OSyFZNM/0.jpg' height='266' width='320'>";

        sembed +="<param name='movie' value='http://www.youtube.com/v/JQu2OSyFZNM&fs=1&source=uds' />";

        sembed +="<embed width='320' height='266' src='http://www.youtube.com/v/JQu2OSyFZNM&fs=1&source=uds' type='application/x-shockwave-flash' >";
        sembed +="</embed>";
    sembed +="</object>";

    sembed +="</div>";

    textEditor.document.execCommand("Inserthtml", "", sembed);
}
</script> 
```

有谁知道如何将视频添加到 iframe？不使用 execCommand 是否有其他解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T21:29:27.863

此代码适用于 Firefox、Chrome、IE。我没有使用 Opera 和 Safari 进行测试

```
<!DOCTYPE html>
<html>
<head>

<script>
function changeStyle(){
    sembed = "<div>";

         sembed +="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0'"; 
         sembed +="data-thumbnail-src='http://3.gvt0.com/vi/JQu2OSyFZNM/0.jpg' height='266' width='320'>";

              sembed +="<param name='movie' value='http://www.youtube.com/v/JQu2OSyFZNM&fs=1&source=uds' />";

              sembed +="<embed width='320' height='266' src='http://www.youtube.com/v/JQu2OSyFZNM&fs=1&source=uds' type='application/x-shockwave-flash' >";
              sembed +="</embed>";
         sembed +="</object>";

   sembed +="</div>";

   var x=document.getElementById("myframe");
   var y=(x.contentWindow || x.contentDocument);
   if (y.document) y=y.document;

   y.open();
   y.write(sembed);
   y.close();
}

</script>
</head>

<body>

<iframe id="myframe" width=850 height=500>
    <p>Your browser does not support iframes.</p>
</iframe><br /><br />

<input type="button" onclick="changeStyle()" value="Add Video.." />

</body>
</html> 
```

# c# - C# EF Code First 1:1 可选关系外键属性

> ID：12100494
> 
> 赞同：1
> 
> 时间：2012-08-23T21:50:08.123
> 
> 标签：c#, entity-framework

我正在尝试在 EF 中创建一个关系，其中外键是可选的。例如像： [https ://stackoverflow.com/a/6023998/815553](https://stackoverflow.com/a/6023998/815553)

我的问题是，有没有办法做类似上述的事情，但我可以在哪里将 ContactID 属性作为模型的一部分？

在我的具体情况下，我有一个人和一个凭证。person 表将有一个可选的 VoucherId，因为该凭证只会在稍后阶段进入以链接到该人。

```
public class Person
{
    public int ID { get; set; }
    public string Name { get; set; }
    public string Surname { get; set; }

    public virtual Voucher Voucher { get; set; }
}

public class Voucher
{
    public int ID { get; set; }
    public string VoucherCode { get; set; }
}

modelBuilder.Entity<Person>()
    .HasOptional(p => p.Voucher)
    .WithOptionalDependent().Map(a => a.MapKey("VoucherId")); 
```

我在这里的工作，但我想要的是你在 Person 类中有 VoucherId。就目前而言，为了向该人添加凭证，我必须将整个 Voucher 对象提供给 Voucher 参数。

```
using (DatabaseContext context = new DatabaseContext())
{
    Voucher v = new Voucher()
    {
        VoucherCode = "23423"
    };
    context.Voucher.Add(v);
    context.SaveChanges();
    Person p = new Person()
    {
        Name = "Bob",
        Surname = "Smith",
        Voucher=v
    };
    context.Person.Add(p);
    context.SaveChanges();
} 
```

我希望能够做到：

```
Person p = new Person()
{
    Name = "Bob",
    Surname = "Smith",
    VoucherId=v.ID // I wouldn't reference it like this, I would have the ID from a different source
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T01:04:59.807

您可以像这样创建 FK 映射：

```
 public class Person
   {
      public int ID { get; set; }
      public string Name { get; set; }
      public string Surname { get; set; }

      [ForeignKey( "Voucher" )]
      public int? VoucherId { get; set; }

      public virtual Voucher Voucher { get; set; }
   } 
```

# c# - 根据flexgrid中的行和列隐藏特定单元格

> ID：12100495
> 
> 赞同：1
> 
> 时间：2012-08-23T21:50:19.263
> 
> 标签：c#, .net, vb.net, c1flexgrid

我有一个 flexgrid（flex 组件网格），我如何隐藏一个单元格。

例如：第 2 行和第 5 列 - 我需要根据某些条件隐藏/删除。

说

```
if(C1FlexGrid1.Rows[2][5].ToString().Length <0)
{
  //I want this to be invisible.
  C1FlexGrid1.Rows[2][5].isVisible=false;
} 
```

我使用的方式没有支持 isVisible 的属性。我有什么办法可以做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T22:28:36.773

最后我想通了：

为你的 winforms 组件网格创建一个 ownerdrawcell 事件：

```
componentGrid.DrawMode = C1.Win.C1FlexGrid.DrawModeEnum.OwnerDraw;
componentGrid.OwnerDrawCell += componentGrid_OwnerDrawCell; 
```

方法

```
void componentGrid_OwnerDrawCell(object sender, C1.Win.C1FlexGrid.OwnerDrawCellEventArgs e)
{
       var value = componentGrid.GetCellCheck(e.Row,e.Col);
       //Your custom condition
       if (value is bool)
       {
          //Will hide the cell
          e.Style.Display = DisplayEnum.None;
       }
       else
       {
           //Will show the cell  
           e.Style.Display = DisplayEnum.Stack;
       }
} 
```

# python - pandas：使用 (row, col) 索引设置值

> ID：12100497
> 
> 赞同：18
> 
> 时间：2012-08-23T21:50:36.047
> 
> 标签：python, pandas

`pandas`提供通过行和列索引列表查找的能力，

```
In [49]: index = ['a', 'b', 'c', 'd']

In [50]: columns = ['one', 'two', 'three', 'four']

In [51]: M = pandas.DataFrame(np.random.randn(4,4), index=index, columns=columns)

In [52]: M
Out[52]: 
        one       two     three      four
a -0.785841 -0.538572  0.376594  1.316647
b  0.530288 -0.975547  1.063946 -1.049940
c -0.794447 -0.886721  1.794326 -0.714834
d -0.158371  0.069357 -1.003039 -0.807431

In [53]: M.lookup(index, columns) # diagonal entries
Out[53]: array([-0.78584142, -0.97554698,  1.79432641, -0.8074308 ]) 
```

我想使用相同的索引方法来设置`M`元素。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2015-01-28T21:30:29.080

自从写下这个答案以来已经过去了很多年，所以我虽然可能会做出一点贡献。随着 pandas 的重构，尝试在一个位置设置一个值

```
M.iloc[index][col] 
```

可能会警告您尝试在切片中设置值。

```
SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy 
```

* * *

**在 0.21 之后**的 pandas 版本中，正确的“pythonic”方式现在是[pandas.DataFrame.at 运算符](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.at.html)

看起来像这样：

```
M.at[index,col] = new_value 
```

* * *

**旧版本的答案**：在旧版本中更“pythonic”的方法是使用[pandas.DataFrame.set_value](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.set_value.html)指令。请注意，此指令返回生成的 DataFrame。

```
M.set_value(index,column,new_value) 
```

* * *

我只是想在找出可以由 .iloc 或 .ix 方法生成的警告的来源之后将其发布在这里。

set_value 方法也适用于多索引数据帧，方法是将索引的多个级别作为元组放入（例如用 (col,subcol) 替换列）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-08-23T21:54:44.830

我不确定我是否关注您，但您是否使用`DataFrame.ix`选择/设置单个元素：

```
In [79]: M
Out[79]: 
        one       two     three      four
a -0.277981  1.500188 -0.876751 -0.389292
b -0.705835  0.108890 -1.502786 -0.302773
c  0.880042 -0.056620 -0.550164 -0.409458
d  0.704202  0.619031  0.274018 -1.755726

In [75]: M.ix[0]
Out[75]: 
one     -0.277981
two      1.500188
three   -0.876751
four    -0.389292
Name: a

In [78]: M.ix[0,0]
Out[78]: -0.27798082190723405

In [81]: M.ix[0,0] = 1.0

In [82]: M
Out[82]: 
        one       two     three      four
a  1.000000  1.500188 -0.876751 -0.389292
b -0.705835  0.108890 -1.502786 -0.302773
c  0.880042 -0.056620 -0.550164 -0.409458
d  0.704202  0.619031  0.274018 -1.755726

In [84]: M.ix[(0,1),(0,1)] = 1

In [85]: M
Out[85]: 
        one       two     three      four
a  1.000000  1.000000 -0.876751 -0.389292
b  1.000000  1.000000 -1.502786 -0.302773
c  0.880042 -0.056620 -0.550164 -0.409458
d  0.704202  0.619031  0.274018 -1.755726 
```

您还可以按索引切片：

```
In [98]: M.ix["a":"c","one"] = 2.0

In [99]: M
Out[99]: 
        one       two     three      four
a  2.000000  1.000000 -0.876751 -0.389292
b  2.000000  1.000000 -1.502786 -0.302773
c  2.000000 -0.056620 -0.550164 -0.409458
d  0.704202  0.619031  0.274018 -1.755726 
```

# javascript - Javascript - (1, 2) 实际上是什么意思？

> ID：12100508
> 
> 赞同：7
> 
> 时间：2012-08-23T21:51:27.547
> 
> 标签：javascript, syntax

我知道在 javascript 中，语法`(1, 'a', 5, ... 'b')`总是会返回最后一个值，但这种语法实际上是什么意思？当我看到`(1, 2)`- 诚然，这几乎从来没有 - 我应该如何解析该语法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T21:58:51.083

单个表达式（逗号之间的位）被求值，然后整个表达式取最后一个的值。因此，像您的示例一样列出一系列数字和字符串文字是毫无意义的：

```
(1, 'a', 5, ... 'b')
// does the same thing as
('b') 
```

...因此，您不妨忽略除最后一个之外的所有内容。但是，如果单个表达式因为它们是函数调用或赋值而具有其他效果，那么您不能将它们排除在外。

我能想到的使用这种语法的唯一好理由是在`for`语句中，因为`for`语法：

```
for([init]; [condition]; [final-expression]) 
```

...不允许您在`[init]`零件内或在`[condition]`or`[final-expression]`零件内使用分号。但是您*可以*使用逗号包含多个表达式：

```
for(x = 0, y = 100, z = 1000; x < y; x++, y--, z-=100) { ... } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T21:57:04.447

运算符评估它的`,`两个参数并返回最后一个。

它最常用于`for`循环：

```
for( i=0, j=0; ...) 
```

[MDN 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T21:57:39.640

逗号运算符评估每一项，然后返回最后一项：

```
var x = (1, 2, 3);
console.log(x == 3);  // true 
```

这是[Mozilla 的文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T21:57:19.027

这只是[逗号运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)，它计算两个表达式并返回第二个。由于它从左到右评估参数，因此如果您有一个用逗号分隔的参数列表，则将返回最后一个参数。来自[JavaScript 风格的元素](http://javascript.crockford.com/style1.html)：

> 逗号运算符是从 C 中借用的，就像 JavaScript 的许多语法一样。逗号运算符接受两个值并返回第二个值。它在语言定义中的存在往往会掩盖某些编码错误，因此编译器往往对某些错误视而不见。最好避免使用逗号运算符，而是使用分号语句分隔符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-23T21:54:21.443

括号 - 只是一个改变优先级的运算符。因此，在这种情况下，您可以省略它们。

你离开了`1, 2`，这只是两个用逗号分隔的表达式。

# php - 如何使用 AJAX 和 PHP 设计一个使用来自另一个页面的许多用户输入的脚本？

> ID：12100514
> 
> 赞同：-1
> 
> 时间：2012-08-23T21:51:46.013
> 
> 标签：php, ajax, jquery

简而言之......我想做的是为我的网站安装脚本......但我希望所有事情都在 1 页中完成，该页面将连接到另一个 php 文件，该文件将包含所有服务器端处理代码。为了做到这一点，我使用 JQuery、Ajax 和 PHP...

现在我的问题在于这样做的最佳实践是什么。如何让我的服务器端 PHP 脚本在漫长的安装过程中接受多个用户输入？

我正在考虑使用将触发类和函数的 switch 语句，就像能够访问将存储在同一个文件中的多个进程（类和函数）一样？......或者人们通常使用其他东西？以前从未这样做过，也找不到关于如何最好地设计它的直接教程。

我在想也许能够通过 php 中的 AJAX 访问类，但这似乎是不可能的....我可以从 php 中的 AJAX 触发函数吗？

我非常感谢您通常如何处理此问题的帮助

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:02:48.010

在 SO 中详细定义整个过程太冗长了。但基本思想是：

*   用户填写表格点击下一步按钮。
*   您获取所有表单值（在 JavaScript 中），使用 AJAX 将其发布到 PHP 页面
*   PHP 页面返回一个标志 (SUCCESS/ERROR) [在后台，如果成功，PHP 已将数据持久化到数据库中]
*   如果 JavaScript 收到 ERROR，您向用户显示错误消息并要求他更正表单
*   如果 java 脚本收到 SUCCESS，则调用下一个 PHP 脚本，它会生成下一个表单并将其发送到您的 JavaScript
*   JavaScript 在页面的 DIV 中填充此表单内容，有效地清除当前表单并在其位置显示新表单。

..整个过程再次从第一步重新开始，为新表格..

# xpath - 如何找到链接的前一个兄弟

> ID：12100520
> 
> 赞同：0
> 
> 时间：2012-08-23T21:52:26.360
> 
> 标签：xpath

我有以下我正在尝试使用 xpath 分析

```
<table>
 <tr>

  <td>Name</td>
  <td>Info</td>
  <td><a href = "file1">Download</a></td>

</tr>

<tr>
 <td>Name2</td>
 <td>Info</td>
 <td><a href = "file2">Download</a></td>

</tr>

....

<tr>
..
</tr>

</table> 
```

我有以下 xpath 来获取下载链接

```
$xpath->query("//a[text()='Download']/@href"); 
```

我想弄清楚的是要发送的查询以获取每个下载的名称。

该页面根本没有 div id 标记，只有普通的 table、tr、td 标签。

我尝试过类似的东西

```
$xpath->query("//preceding-sibling::a[text()='Download']"); 
```

有人对此有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:11:50.107

关！

给定一个特定的上下文节点（这里`href`是下载的属性），您希望找到`td`包含该上下文节点的最年长的兄弟姐妹。所以你的相对路径应该首先上升到`td`然后找到最老的兄弟姐妹：

```
parent::a/parent::td/preceding-sibling::td[last()] 
```

或更简单地说（并且不假设在和之间没有类似`p`或`span`干预的元素）：`td``a`

```
ancestor::td[1]/preceding-sibling::td[last()] 
```

一些用户发现`preceding-sibling`轴上节点的反向编号令人困惑，因此说您真正想要的是`td`最小包含的第一个孩子可能会感觉更简单`tr`：

```
ancestor::tr[1]/child::td[1] 
```

如果您需要一次性获取所有下载链接*和*它们的文本标签，那么您如何做取决于您使用 XPath 的上下文。例如，在 XSLT 中，您可以编写：

```
<xsl:apply-templates select="//a[text()='Download']/@href"/> 
```

然后在适当的模板中获取标签：

```
<xsl:template match="a/@href">
  <xsl:value-of select="string(ancestor::tr[1]/td[1])"/>
  : 
  <xsl:value-of select="."/>
</xsl:template> 
```

在其他宿主语言中，您会想要做类似的事情。关键问题是您必须遍历与表达式匹配的节点`href`，然后对于每个节点，您需要在文档中移回以获取标签。您如何说“根据第一个 XPath 表达式中的当前节点评估第二个 XPath 表达式”会因您的环境而异。

# php - 如何每个浏览器会话只允许一个 POST？

> ID：12100521
> 
> 赞同：0
> 
> 时间：2012-08-23T21:52:26.183
> 
> 标签：php, udid

如何每个浏览器会话只允许一个 POST？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T21:59:43.363

```
<?php
session_start();

if (isset($_SESSION['already_posted'])) {
  echo "Already posted.";
  exit();
}

$is_valid_post = isset($_POST['txt_udid']); // && validate stuff...;

//... process $_POST....

if ($is_valid_post) {
    $_SESSION['already_posted'] = 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:57:05.210

处理提交后将信息保存到 $_SESSION 中，并在处理提交开始时检查是否有任何信息之前保存在 $_SESSION 中。

# linux - Linux CLI：根据搜索从文本文件中提取可变数量的行

> ID：12100523
> 
> 赞同：1
> 
> 时间：2012-08-23T21:52:30.277
> 
> 标签：linux, bash, shell, command-line-interface

我有一个我认为很简单的问题。我有一个占用几 GB 的 mysqldump 文件，我想创建一个脚本，该脚本将仅提取与一个表相关的文本行（传递给脚本的变量）并将它们保存到一个新文件中。

我要提取的部分始终以：

```
-- Table structure for table `myTable` 
```

并且总是以：

```
UNLOCK TABLES; 
```

我以后想要的表名和行数是可变的。我能够找到该部分的开头：

```
START=$(grep -n "Table structure for table \`$2\`" "$1" | awk -F ":" '{print $1}') 
```

`$1`要搜索的文件在哪里，`$2`是表名。这工作得很好，但后来我被卡住了。我知道一旦我有了结束行号，我就可以用 sed 提取行，但是发现结束行号是棘手的部分。

我需要`UNLOCK TABLES;`在我的行号之后找到第一次出现的`$START`行号，而我不知道该怎么做。

有关更多详细信息，这是我要提取的一段文本的示例：

```
--
-- Table structure for table `myTable`
--

DROP TABLE IF EXISTS `myTable`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `myTable` (
  `column1` varchar(12) NOT NULL,
  `column2` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`column1`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `myTable`
--

LOCK TABLES `myTable` WRITE;
/*!40000 ALTER TABLE `myTable` DISABLE KEYS */;
INSERT INTO `myTable` VALUES ('test11', 'test12'),('test21', 'test22');
/*!40000 ALTER TABLE `myTable` ENABLE KEYS */;
UNLOCK TABLES; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:13:13.943

使用`sed`；您无需担心明确的行号；您可以使用正则表达式为第一行和最后一行选择范围。

```
firstLine="-- Table structure for table \`$2\`"
secondLine="UNLOCK TABLES;"

sed -n "/$firstLine/,/$secondLine/p" "$1" 
```

仅打印与所需范围匹配的行的`-n`限制。`sed`

# .net - 如何让 System.Web.Optimization 包与 IIS 虚拟目录中的自定义文件夹一起使用？

> ID：12100524
> 
> 赞同：11
> 
> 时间：2012-08-23T21:52:37.433
> 
> 标签：.net, asp.net-mvc-4, asp.net-optimization, system.web.optimization

我有一个 asp.net mvc4。我有使用 IIS 虚拟目录在此应用程序中部署为子目录的模块，我需要引用这些模块中的文件。这些模块 dll 正在注册捆绑包。但是捆绑包不会在 html 页面中生成任何内容。

从这篇文章[is-it-possible-to-unit-test-bundleconfig-in-mvc4 中](https://stackoverflow.com/questions/11371710/is-it-possible-to-unit-test-bundleconfig-in-mvc4)，我看到包在内部使用 Server.MapPath。所以它似乎应该工作。

我挂钩了 BundleTable.MapPathMethod，甚至自己调用了 Server.MapPath，它确实正确解析到正确的物理目录。但它仍然不会在 html 页面中呈现任何内容。

然后有这篇文章，[为什么-does-resolvebundleurl-not-work-for-custom-folders](https://stackoverflow.com/questions/9647585/why-does-resolvebundleurl-not-work-for-custom-folders/9647592#comment16170422_9647592)，提到了自定义文件夹的“AddDirectory”功能，但是这个功能在最新的优化库中不再可用。

我也尝试过使用新的“IncludeDirectory”方法，但这也不起作用

```
ScriptBundle scriptBundle = new ScriptBundle("~/bundles/jquery");
scriptBundle.IncludeDirectory(basePath + "/Scripts/","jquery-1.*");
bundles.Add(scriptBundle); 
```

还有什么我可以尝试的吗？

* * *

2012 年 8 月 27 日

问题解答：基本上 System.Web.Optimization 不适用于作为子 IIS 虚拟目录的 web url。

问题是 BundleResolver.GetBundleContents 中的这些代码行

```
string mapPathMethod = this.MapPathMethod("~/");
if (!file.FullName.StartsWith(mapPathMethod, StringComparison.OrdinalIgnoreCase)) 
```

这基本上假设每个被捆绑的文件都将位于主 Web 应用程序 PHYSICAL 文件夹下的 PHYSICAL 文件夹中。

IMO 的问题在于，正在搜索要包含的文件的 Web 相对 url 路径很早就被转换为物理路径，并且所有对用于获取这些物理文件的相对 url 路径的引用都被丢弃了。

所以，为了看看我能不能完成这项工作，我必须将 System.Web.Optimization 反编译为裸代码，然后再次重新编译，这样我才能“修复”它。第一步是向 BundleItem 添加一个 RelativePath 属性，这是一个额外的 BundleItem 构造函数，用于传递源相对 url 路径以保留 Web 相对搜索目录文件夹的内容。然后我用循环替换了上面的代码，然后基本上尝试用它们的 BundleItem 重新匹配找到的文件，以便可以将它们转换回有效的 web url

```
foreach (BundleItem bundleItem in bundleFor.Items)
{
  if (file.FullName.StartsWith(bundleItem.Path, StringComparison.OrdinalIgnoreCase)){
    string str = file.FullName.Replace(bundleItem.Path,bundleItem.RelativePath);
    str = str.Replace('\\', '/');
    strs.Add(str);
    break;
  }
} 
```

现在我的包正在正确渲染。但是请注意，我尚未测试此 hack 修复程序的发布或优化或缩小。

我真的认为 asp.net 团队应该让 System.Web.Optimizations 支持 IIS 虚拟目录中的文件。尤其是现在 VS2012 支持 IIS Express，这最终将使构建模块化 Web 应用程序变得更加容易，文件通过 IIS 虚拟目录引用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-17T19:51:28.867

如果您正确配置它，您应该能够使用 virtualPathProvider 完成此操作。

有关如何注册它的信息，请参阅我的答案：[BundleTable.Bundles.GetBundleFor() 返回但不是里面的项目](https://stackoverflow.com/questions/28499885/bundletable-bundles-getbundlefor-returns-but-not-items-inside)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T17:43:49.467

AddDirectory 已重命名为 IncludeDirectory，因此您仍然可以尝试。

# c# - 应将什么放入 AssemblyTrademarkAttribute 中？

> ID：12100532
> 
> 赞同：15
> 
> 时间：2012-08-23T21:53:51.413
> 
> 标签：c#, .net

默认情况下，Visual Studio 会为 C# 程序集生成这组属性：

```
[assembly: AssemblyTitle("ContosoApp")]
[assembly: AssemblyDescription("Contoso's latest great product.")]
#if DEBUG
[assembly: AssemblyConfiguration("Debug")]
#else
[assembly: AssemblyConfiguration("Release")]
#endif
[assembly: AssemblyCompany("Contoso Corporation")]
[assembly: AssemblyProduct("ContosoApp Suite")]
[assembly: AssemblyCopyright("Copyright © Contoso 2012")]
[assembly: AssemblyTrademark("")] // ??
[assembly: AssemblyCulture("")] 
```

我不知道这里的“商标”与“公司”有何不同。这里应该放什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-23T22:02:40.630

我们在这里关注三个领域：公司名称、产品名称和商标。

公司名称很明显，产品名称也是如此。然而，该商标更加模棱两可。根据[这篇文章](http://www.businesslink.gov.uk/bdotg/action/detail?itemId=1073791334&type=RESOURCES)，商标可以是：

*   您的公司名称，默认情况下受知识产权保护（在大多数国家/地区）
*   您的产品名称，可能会或可能不会受保护的知识产权
*   与问题无关的其他内容。

如果您已将产品名称注册为商标，则该产品名称可以受 IP 保护。Microsoft Office 是受保护产品名称/商标的一个很好的例子。在这种情况下，只有您作为所有者才能为您的产品使用产品名称。但是，默认情况下，产品名称不受 IP 保护，任何希望使用它的个人或公司都可以使用它。

`AssemblyProduct`在您的情况下，您有一个注册（并受保护）的产品名称或商标，将其用于和似乎非常合理`AssemblyTrademark`。如果您的产品名称不受 IP 保护，则将其放入其中是不合理的，`AssemblyTrademark`因为其他人也可能使用此产品名称。在这种情况下，我会填写我的公司名称或将其留空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T22:00:20.070

查看微软的[商标页面](http://www.microsoft.com/About/Legal/EN/US/IntellectualProperty/Trademarks/EN-US.aspx)，我认为这是与知识产权相关或命名的商标，例如他们有“Office”和“Hotmail”的地方

# php - 为什么我要使用 spl_autoload_register 而不是 include 或 require 类和函数？

> ID：12100541
> 
> 赞同：3
> 
> 时间：2012-08-23T21:54:41.303
> 
> 标签：php

我不明白在做什么`spl_autoload_register`或`autoload`在做什么。

为什么我不只使用 include 或 require？

我没有看到明确的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T08:53:58.270

自动加载函数或类的优点是：

1.  如果您有很多类，则不需要手动包含它们。以 Zend Framework 为例：您*不想*手动加载所有这些类。使用自动加载器，只需创建一个新类并开始在所有（启用自动加载器的）文件中使用它。
2.  仅加载请求中实际使用的文件，从而可能节省资源。如果您只使用 50 个文件中的 10 个，为什么还要加载其他 40 个？
3.  它迫使您有一个合理的目录布局（毕竟，您需要一些规则，以便您的自动加载器可以找到文件）。
4.  [它可以](http://blog.ircmaxell.com/2012/07/is-autoloading-good-solution.html)（但不是根据定义）比手动包含更快。链接文章中的基准表明，如果您使用页面上所有可用类的大约四分之三，您将“收支平衡”。即便如此，自动加载让你的生活变得如此轻松，即使它比手动加载慢得多，你仍然应该这样做。

# shell - Shell 脚本循环，以十六进制递增

> ID：12100545
> 
> 赞同：1
> 
> 时间：2012-08-23T21:55:06.493
> 
> 标签：shell

```
for num in {3758145536..3758149632..4}
do
    echo "obase=16; $num" | hexnum
    peek -lt $hexnum > "/luascript/dumpfileA"
done 
```

我想要做的是，从地址 0xe000000 迭代到 0xe0001000 使用 peek 偷看这些部分内存并将结果写入文件。

所以我使用 Deceimal 来做增量工作。然后转换为十六进制。

也许，我可以直接增加十六进制吗？

但这不起作用。需要帮助 谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:34:00.190

（我假设您使用的是 bash）。

一般来说，bash 只允许您输入以 10 为底的数字文字。您可以在算术上下文中使用其他底（`((...))`例如，在 内部），但它将以其以 10 为底的表示形式显示。但是，您可以使用`printf`内置快速转换为十六进制表示。

```
for (( num=0xe0000000; num <= 0xe0001000; num+=4 )); do
    peek -lt $( printf "%x" $num ) >> /luascript/dumpfileA
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:46:41.647

如果你正在使用`zsh`你可以做这样的事情（注意`c_bases`需要设置`0x`在前面`$num`）：

```
setopt c_bases
typeset -i 16 num
for num in $( seq $((0xe000c000)) 4 $((0xe000d000)) ); do 
  echo "peek -lt $num > /luascript/dumpfileA"
done | head 
```

输出：

```
peek -lt 0xE000C000 > /luascript/dumpfileA
peek -lt 0xE000C004 > /luascript/dumpfileA
peek -lt 0xE000C008 > /luascript/dumpfileA
peek -lt 0xE000C00C > /luascript/dumpfileA
peek -lt 0xE000C010 > /luascript/dumpfileA
peek -lt 0xE000C014 > /luascript/dumpfileA
peek -lt 0xE000C018 > /luascript/dumpfileA
peek -lt 0xE000C01C > /luascript/dumpfileA
peek -lt 0xE000C020 > /luascript/dumpfileA
peek -lt 0xE000C024 > /luascript/dumpfileA 
```

删除`head`，`echo`并在您对输出感到满意时引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-30T12:04:27.853

很简单！用这个：

```
bc <<< "obase = 16 ; $(seq 0 65536)" 
```

# java - 有效地多次使用 Prepared Statement

> ID：12100550
> 
> 赞同：8
> 
> 时间：2012-08-23T21:55:23.377
> 
> 标签：java, sql, jdbc, prepared-statement

下面是我`multiple records( around 5000-7000)`使用 Prepared Statement 插入 Oracle 数据库的代码。

我目前的做法好吗？或者它可以使用一些改进更多`batch thing`？

```
pstatement = db_connection.prepareStatement(PDSLnPConstants.UPSERT_SQL);

for (Entry<Integer, LinkedHashMap<Integer, String>> entry : MAPPING.entrySet()) {

    pstatement.setInt(1, entry.getKey());
    pstatement.setString(2, entry.getValue().get(LnPConstants.CGUID_ID));
    pstatement.setString(3, entry.getValue().get(LnPConstants.PGUID_ID));
    pstatement.setString(4, entry.getValue().get(LnPConstants.SGUID_ID));
    pstatement.setString(5, entry.getValue().get(LnPConstants.UID_ID));
    pstatement.setString(6, entry.getValue().get(LnPConstants.ULOC_ID));
    pstatement.setString(7, entry.getValue().get(LnPConstants.SLOC_ID));
    pstatement.setString(8, entry.getValue().get(LnPConstants.PLOC_ID));
    pstatement.setString(9, entry.getValue().get(LnPConstants.ALOC_ID));
    pstatement.setString(10, entry.getValue().get(LnPConstants.SITE_ID));
    pstatement.executeUpdate();

    pstatement.clearParameters();
} 
```

**我正在使用的更新代码：-**

```
public void runNextCommand() {

    Connection db_connection = null;
    PreparedStatement pstatement = null;
    int batchLimit = 1000;
    boolean autoCommit = false;

    try {
        db_connection = getDBConnection();

        autoCommit = db_connection.getAutoCommit();
        db_connection.setAutoCommit(false); //Turn off autoCommit
        pstatement = db_connection.prepareStatement(LnPConstants.UPSERT_SQL); // create a statement

        for (Entry<Integer, LinkedHashMap<Integer, String>> entry : GUID_ID_MAPPING.entrySet()) {
            pstatement.setInt(1, entry.getKey());
            pstatement.setString(2, entry.getValue().get(LnPConstants.CGUID_ID));
            pstatement.setString(3, entry.getValue().get(LnPConstants.PGUID_ID));
            pstatement.setString(4, entry.getValue().get(LnPConstants.SGUID_ID));
            pstatement.setString(5, entry.getValue().get(LnPConstants.UID_ID));
            pstatement.setString(6, entry.getValue().get(LnPConstants.ULOC_ID));
            pstatement.setString(7, entry.getValue().get(LnPConstants.SLOC_ID));
            pstatement.setString(8, entry.getValue().get(LnPConstants.PLOC_ID));
            pstatement.setString(9, entry.getValue().get(LnPConstants.ALOC_ID));
            pstatement.setString(10, entry.getValue().get(LnPConstants.SITE_ID));
            pstatement.addBatch();

            batchLimit--;

            if(batchLimit == 0){
                pstatement.executeBatch();
                pstatement.clearBatch();
                batchLimit = 1000;
            }
            pstatement.clearParameters();
        }

    } catch (SQLException e) {
        getLogger().log(LogLevel.ERROR, e);
    } finally {
        try {
            pstatement.executeBatch();
            db_connection.commit();
            db_connection.setAutoCommit(autoCommit);
        } catch (SQLException e1) {
            getLogger().log(LogLevel.ERROR, e1.getMessage(), e1.fillInStackTrace());
        }

        if (pstatement  != null) {
            try {
                pstatement.close();
                pstatement = null;
            } catch (SQLException e) {
                getLogger().log(LogLevel.ERROR, e.getMessage(), e.fillInStackTrace());
            }
        }
        if (db_connection!= null) {
            try {
                db_connection.close();
                db_connection = null;
            } catch (SQLException e) {
                getLogger().log(LogLevel.ERROR, e.getMessage(), e.fillInStackTrace());
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T21:58:33.370

您可以考虑[`addBatch()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/sql/PreparedStatement.html#addBatch%28%29)一次性使用和执行后面的语句。此外，正如@pst 在您的问题中评论的那样，考虑使用`trasaction`.

你会做的方式如下：

```
boolean autoCommit = connection.getAutoCommit();
try{
    connection.setAutoCommit(false //Turn off autoCommit
    pstatement = db_connection.prepareStatement(PDSLnPConstants.UPSERT_SQL);

    int batchLimit = 1000;

    try{
        for (Entry<Integer, LinkedHashMap<Integer, String>> entry : MAPPING.entrySet()) {
            pstatement.setInt(1, entry.getKey());
            pstatement.setString(2, entry.getValue().get(LnPConstants.CGUID_ID));
            pstatement.setString(3, entry.getValue().get(LnPConstants.PGUID_ID));
            pstatement.setString(4, entry.getValue().get(LnPConstants.SGUID_ID));
            pstatement.setString(5, entry.getValue().get(LnPConstants.UID_ID));
            pstatement.setString(6, entry.getValue().get(LnPConstants.ULOC_ID));
            pstatement.setString(7, entry.getValue().get(LnPConstants.SLOC_ID));
            pstatement.setString(8, entry.getValue().get(LnPConstants.PLOC_ID));
            pstatement.setString(9, entry.getValue().get(LnPConstants.ALOC_ID));
            pstatement.setString(10, entry.getValue().get(LnPConstants.SITE_ID));

            pstatement.addBatch();
            batchLimit--;

            if(batchLimit == 0){
                pstatement.executeBatch();
                pstatement.clearBatch
                batchLimit = 1000;
            }
             pstatement.clearParameters();
        }
    }finally{
        //for the remaining ones
        pstatement.executeBatch();

        //commit your updates
        connection.commit();
    }
}finally{
    connection.setAutoCommit(autoCommit);
} 
```

这个想法是为批量更新设置一个限制，并且只有在达到特定限制时才执行数据库更新。这样，您将数据库调用限制为`batchLimit`您定义的每个数据库调用。这样会更快。

另请注意`transaction`，我刚刚展示了如何以及何时`commit`。这可能并不总是正确的点，`commit`因为此决定将基于您的要求。`rollback`如果出现异常，您可能还想执行 a 。因此，由您决定。

查看[“使用事务”](http://docs.oracle.com/javase/tutorial/jdbc/basics/transactions.html)教程以更好地了解如何使用`transaction`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:09:35.087

是的，进行批量更新会显着提高您的性能。只需谷歌，我的首选答案是[来自 Mkyong.com 的](http://www.mkyong.com/jdbc/jdbc-preparedstatement-example-batch-update/)答案。否则，您的代码看起来不错。“clearParameters()”并不是真正需要的，它甚至可能会消耗一些处理器周期。重要提示：如果启用了 AutoCommit，请不要忘记之前禁用它，并在更新后启用它，这再次带来了巨大的改进。

附言

以上建议也是基于我的经验。我刚刚注意到这个问题已经[在 Stackoverflow](https://stackoverflow.com/questions/6892105/bulk-insert-in-java-using-prepared-statements-batch-update)上提出过，答案非常详细。有关 PreparedStatements 和批次的更多信息，请参见此处的 Oracle 文档[和](http://docs.oracle.com/javase/tutorial/jdbc/basics/transactions.html)[此处](http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/preparedstatement.html)的事务（自动提交）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T21:58:40.973

你的一段代码对我来说似乎很好。

只是为了代码清洁，我会放入`entry.getValue()`一个变量（调用它`value`）。
而且没有必要打电话`clearParameters()`。

最后，记住在不再需要准备好的语句时正确处理它（`close()`）。

# ruby-on-rails - Rails：用文本文件中的数据填充模型

> ID：12100551
> 
> 赞同：1
> 
> 时间：2012-08-23T21:55:30.517
> 
> 标签：ruby-on-rails, ruby

我是 Rails 的新手，到目前为止，我一直在从标准的 HTML 表单中填充模型的数据。如果我想要一个名为“汽车”的模型，它具有“品牌”和“颜色”属性，并且我想从文本文件（不是 HTML 表单）中读取 6 辆汽车并创建 6 种不同的汽车模型，该怎么办？我必须知道从哪里开始。任何指导都会非常有用。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:41:04.433

1）如果是在安装应用程序时将 Model.create 语句放入`db/seeds.rb`

2）对于什么是有效的模型级常量，将它们放在类中，例如

```
class Car < ActiveRecord::Base
  MODELS = %q[Ford, Honda, Buick] # %q means words, e.g. "Ford", "Honda", "Buick"
end

# Now you can use `::` to access it, e.g. Car::MODELS for the car models array. 
```

2a）您也可以通过引用创建它们，例如

```
class Car < ActiveRecord::Base
  FORD = "The Ford Motor Company."
  HONDA = "The international Honda Motor Company."
  BUICK = "Buick Inc."
  MODELS = [FORD, HONDA, BUICK]
end

# Now you can use Book::MODELS for the models array.
# and Car::FORD for the FORD type 
```

您可以随时编辑类（这让我有点习惯，因为我曾经是所有程序员的 SQL）。

3）文件本身可以很容易地阅读

```
@input = File.open("/directories_to_it/file")
@input.each_line do |one_row|
  CarBrand.create(:brand => one_row[0], :color => one_row[1]
end
# psuedo-code you may need to play with the line reading a bit for your columns. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:37:16.417

JSON 是一种很好的对象表示格式，易于使用且易于阅读。它可以处理您描述的对象数组。我会将您的对象转换为 json 并将它们写入一个文件，然后您可以使用 JSON.parse() 检索该文件。

有关如何执行此操作的示例，请参阅此链接： [如何以正确的格式写入 JSON 文件](https://stackoverflow.com/questions/5507512/write-to-json-file-in-correct-format-ruby)

# javascript - 非常大的图像显示渐进式

> ID：12100553
> 
> 赞同：1
> 
> 时间：2012-08-23T21:55:37.840
> 
> 标签：javascript, image, onload

我正在尝试将一些相当大的图像加载到 Web 应用程序中。这些图像中最大的可以是 2800x2800。我将它们加载，显示，一切正常。

我的问题是，一旦它们被加载使用：

```
var img = new Image();
img.src = 'myImageURL';
img.onload = function(){
  //display image
} 
```

大图像从上到下逐渐显示在页面上，就好像它们正在加载一样。

我想从视觉上删除它，并且仅在完全加载并在浏览器中呈现后才显示它们。

我也无法更改图像大小，因为此 Web 应用程序旨在让用户缩放图像，一直到原始大小的 100%，所以我必须加载完整的 2800x2800 并将其调整为小。

有谁知道我如何隐藏图像直到它被渲染？我可以隐藏它直到加载，但这基本上就是我正在做的，它是我想要删除的渐进式渲染显示。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:09:07.983

使用标签`onload`上的属性`<img>`，如下所示：

```
<img src="huge.jpg" style="display:none" onload="this.style.display='block'"> 
```

用任何你想要的效果代替，但这`onload`是你的钩子。

演示： http: [//jsfiddle.net/DfCUQ/1/](http://jsfiddle.net/DfCUQ/1/) ^(（注意：`?nocache=X`每次加载时更新演示中的）)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T21:59:23.557

您可以使 css 可见性为“隐藏”，并在图像的位置放置一些文本（或加载微调器等），直到调用 onload 事件。

# android - 使用 ActionBarSherlock 刷新特定选项卡

> ID：12100554
> 
> 赞同：0
> 
> 时间：2012-08-23T21:55:48.180
> 
> 标签：android, tabs, refresh, actionbarsherlock

我有几个带有 ActionBarSherlock 的选项卡，我想在该选项卡处于视图中时刷新特定选项卡。

我只是不知道我应该在我的 onOptionsItemSelected 中包含哪些代码。

任何帮助，将不胜感激。谢谢。

这是当前代码：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case android.R.id.home:
        //Toast.makeText(this, "home", Toast.LENGTH_LONG).show();
        toggle();
        return true;
    case R.id.menu_search:
        //Toast.makeText(this, "search", Toast.LENGTH_LONG).show();
        return true;
    case R.id.menu_refresh:
        if (mViewPager.getCurrentItem()==1){
            Toast.makeText(this, "refresh tab2", Toast.LENGTH_LONG).show();

        // Code would go here I suppose...  

        } 

    default:
        return super.onOptionsItemSelected(item);

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:14:21.607

要重新绘制视图，您可以使用它的 .invalidate(); 方法

[http://developer.android.com/reference/android/view/View.html#invalidate](http://developer.android.com/reference/android/view/View.html#invalidate) ()

虽然我确定您知道您是否使用 ABS，但请使用 findviewbyID() 获取可见的视图

# asp.net-mvc - Ninject 上下文绑定在行动

> ID：12100556
> 
> 赞同：2
> 
> 时间：2012-08-23T21:55:57.350
> 
> 标签：asp.net-mvc, ninject

MVC 3，忍者 2.2。

我有一个需要临时覆盖绑定的场景。覆盖仅适用于控制器中的操作的持续时间。

我需要的是这样的：

```
[HttpGet, Authorize(Users="MySpecialAccount")]
public ActionResult Report(string userName) {
  var reportViewModel = new ReportViewModel();

  using(var block = Kernel.BeginBlock() {
    var principal = //load principal info based on userName;
    block.Rebind<IMyPrincipal>().ToConstant(principal);
    reportViewModel = GetViewModel(); //calls bunch of repos to hydrate view model that reference IMyPrincipal
  }

  return View(reportViewModel);
} 
```

## 背景：

该应用程序使用 Windows 身份验证。我有一个加载自定义主体的自定义提供程序。我们将这个自定义主体注入到我们的 repos/services/etc 中，并帮助我们根据经过身份验证的用户加载适当的数据。长期以来，这一切都很好。现在我有一个场景，我在一个动作中使用模拟。原因可能超出范围，但基本上我使用的是 HTMLToPDF 编写器，它启动一个单独的进程以在不同的帐户下加载 HTML/Action。无论如何，因为我在这一个动作中冒充，所以我的所有存储库都无法加载正确的信息，因为发出请求的不是用户，这是有道理的。所以我发送了一个我们需要为其运行报告的“谁”参数，并且我需要临时重新绑定自定义主体。

希望这是有道理的。以下是加载自定义主体的当前代码片段。

```
In Global.asax:
protected void WindowsAuthentication_OnAuthenticate(Object source, WindowsAuthenticationEventArgs e)
    {

        if (e.Identity.IsAuthenticated)
        {
            //goes to db and loads additional info about logged on user. We use this info in repos/services to load correct data for logged on user.
            var principal = new PrincipalFactory().GetPrincipal(e.Identity); 

            e.User = principal;
        }
    }

//Ninject Binding    
Bind<IMyPrincipal>().ToProvider(new MyPrincipalProvider());

//Provider
public class MyPrincipalProvider : Provider<IMyPrincipal>
{
    protected override IMyPrincipal CreateInstance(IContext context)
    {
        var principal = HttpContext.Current.User as IMyPrincipal;

        return principal ?? new UnauthenticatedPrincipal(new GenericIdentity("Not Authenticated"));
    }
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T05:59:11.780

想到的一种可能性是使用自定义授权属性：

```
public class ImpersonateAuthorizeAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        var authorized = base.AuthorizeCore(httpContext);
        if (!authorized)
        {
            return false;
        }

        string username = httpContext.User.Identity.Name;

        // or if you wanted to load the username from the request:
        // string username = httpContext.Request["username"];

        IPrincipal principal = // load principal info based on username;

        // Swap the principal for this action
        httpContext.User = principal;

        return true;
    }
} 
```

进而：

```
[HttpGet]
[ImpersonateAuthorize(Users="MySpecialAccount")]
public ActionResult Report(string userName) 
{
    // Here this.User will be the custom principal you loaded in 
    // the authorize attribute

    var reportViewModel = new ReportViewModel();

    return View(reportViewModel);
} 
```

另一种方法是在您的 DI 框架配置级别执行此操作：

```
public class MyPrincipalProvider : Provider<IPrincipal>
{
    protected override IPrincipal CreateInstance(IContext context)
    {
        var httpContext = HttpContext.Current;
        var rd = httpContext.Request.RequestContext.RouteData;
        var currentAction = rd.GetRequiredString("action");
        var currentController = rd.GetRequiredString("controller");
        if (string.Equals("report", currentAction, StringComparison.OrdinalIgnoreCase) &&
            string.Equals("users", currentController, StringComparison.OrdinalIgnoreCase))
        {
            IPrincipal principal = // load principal info based on username;
            return principal;
        }

        var principal = httpContext.User as IPrincipal;
        return principal ?? new UnauthenticatedPrincipal(new GenericIdentity("Not Authenticated"));
    }
} 
```

# profiling - Callgrind 配置文件格式包含/自费

> ID：12100558
> 
> 赞同：3
> 
> 时间：2012-08-23T21:56:12.580
> 
> 标签：profiling, file-format, kcachegrind, callgrind

我正在尝试了解 Callgrind 配置文件格式。我找到了[网上的描述](http://kcachegrind.sourceforge.net/cgi-bin/show.cgi/KcacheGrindCalltreeFormat)

在遇到“扩展示例”之前，我以为我理解得很好：

```
events: Instructions

fl=file1.c 
fn=main
16 20 
cfn=func1 
calls=1 50 
16 400 
cfl=file2.c 
cfn=func2 
calls=3 20 
16 400

fn=func1 
51 100 
cfl=file2.c 
cfn=func2 
calls=2 20 
51 300

fl=file2.c 
fn=func2 
20 700 
```

描述如下：*可以看到，在“main”中，仅执行了第 16 行的代码，其中还调用了其他函数。“main”的包含成本是 420，它是自身成本 20 和调用中花费的成本之和。*

当只有 func2 的 self 成本已经是 700 时，'main' 的包含成本怎么可能是 420？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:05:43.270

好的，描述是错误的：当我粘贴这个示例并在 kcachegrind 中打开它时，它确实显示了 820 的总包含成本。这是有道理的。对不起，噪音。

# javascript - 我无法从 iframe 中调用父函数

> ID：12100562
> 
> 赞同：0
> 
> 时间：2012-08-23T21:56:27.793
> 
> 标签：javascript, iframe

我已经看过有关此的其他帖子，但是由于某种原因，以下方法不起作用。

```
onclick="parent.testing();" 
```

现在来看完整的故事。我有一个包含所有 JS 文件的 index.html。同样在索引中，我有一个空的“div”标签。使用 jQuery，我将 page1.html 文件附加到空的“div”。所以索引有点像这样：

```
<html>
<head>
<script files>
<script>
ready { function testing(){do stuff;} }
</script>
</head>
<body>
<div><iframe src="page1.html" (added via jQuery)></div>
</body>
</html> 
```

现在在 page1.html 文件中，我试图在单击链接时调用一个函数。但我收到以下错误：

```
Uncaught TypeError: Cannot call method 'testing' of undefined 
```

我也尝试了以下方法，但没有奏效：

```
onclick="window.testing();"
onclick="window.frames[0].testing();" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:10:15.643

您的父页面脚本不是有效的 JavaScript，但假设`ready { ... }`：

```
<script>
ready { function testing(){do stuff;} }
</script> 
```

...是一种简化，应该表示您在该就绪处理程序中声明`testing()`为本地函数的文档就绪处理程序，因此只能从该就绪处理程序中访问它。您需要`testing()`在父页面中进行全局设置：

```
<script>
$(document).ready({ /* your on ready stuff here */ });

function testing(){ /* do stuff; */ }
</script> 
```

...然后您应该可以使用 iframe 从 iframe 调用它`parent.testing()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:02:05.507

如果我理解你的问题，你的问题是你的函数没有被调用，对吧？所以也许一个解决方案是将它放在你的“page1.html”中

```
<script type="text/javascript" src="your_js_file"></script> 
```

# ruby-on-rails - Rails3 使用 ActiveRecord ；范围因 Time#succ 失败已过时

> ID：12100563
> 
> 赞同：0
> 
> 时间：2012-08-23T21:56:38.150
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, scope

我正在把头撞到墙上——我在 ActiveRecord 中使用各种范围，有些工作，有些没有，我不知道为什么。希望有人给我一个提示/解决方案。所有范围陈述都在同一个模型 - PortfolioProject 中。所有都被调用如下：

```
PortfolioProject.<scope name>(Time.zone.now).order('sequence') 
```

这个有效 - 每次都没有失败：

```
scope :in_discovery, lambda {|curTime| where('sequence > 0 AND ? BETWEEN crnt_discovery_start AND crnt_discovery_finish', curTime) } 
```

以下失败并给出错误消息：**Time#succ 已过时；使用时间 + 1**

```
scope :in_requirements, lambda {|curTime|  where('sequence > 0 AND ? BETWEEN crnt_requirements_start AND crnt_requirements_finish', curTime) }
scope :in_tech_design, lambda {|curTime|  where('sequence > 0 AND ? BETWEEN crnt_tech_dsgn_start AND crnt_tech_dsgn_finish', curTime) }
scope :in_development, lambda {|curTime|  where('sequence > 0 AND ? BETWEEN crnt_development_start AND crnt_development_finish', curTime) }
scope :in_testing, lambda {|curTime|  where('sequence > 0 AND ? BETWEEN crnt_testing_start AND crnt_testing_finish', curTime) }
scope :in_launch, lambda {|curTime|  where('sequence > 0 AND ? BETWEEN crnt_launch_start AND crnt_launch_finish', curTime) } 
```

范围语句的构造是相同的——除了每个语句中使用的列名。

我很感激任何洞察我可能做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T20:12:51.270

伙计们 - 问题在程序的堆栈中更进一步 - 我正在追逐一个幽灵，因为 Rails 没有报告任何带有错误的跟踪信息，我认为它在范围声明中。就像任何仅供参考一样 - 我的最终范围声明如下：

```
scope :in_discovery, lambda{|dtCheck| active_records.where('DATE(?) BETWEEN crnt_discovery_start AND crnt_discovery_finish', dtCheck)} 
```

像冠军一样工作。

问题最终出现在一个子视图中，我再次对 DB2 数据库中的 datatyep TIMESTAMP 字段进行比较。由于它是一个无法更改数据类型的旧版应用程序，因此我在视图中所要做的就是在字段声明的末尾添加“.to_date”。

# wordpress - 如何将 WordPress 连接到 Heroku 的 Postgres 附加组件？

> ID：12100564
> 
> 赞同：0
> 
> 时间：2012-08-23T21:56:41.770
> 
> 标签：wordpress, postgresql, heroku

有没有人使用 Heroku Postgres 插件成功配置了 WordPress 应用程序？我继承了一个当前在 Heroku 上运行的 WordPress 应用程序，但没有使用 Heroku Postgres 插件。

我正在尝试创建应用程序的暂存实例并不断收到“建立数据库连接时出错”。

我正在使用 PG4WP 插件并生成了一个 heroku-postgresql:dev 实例。

我的 DATABASE_URL 配置变量具有以下格式：

```
postgres://xxxxxx:yyyyyy@zzzzzzz.compute-1.amazonaws.com:5432/xxxxxxxxx 
```

我的 wp-config 如下：

```
if (isset($_SERVER["DATABASE_URL"])) {
  $db = parse_url($_SERVER["DATABASE_URL"]);
  define("DB_NAME", trim($db["path"],"/"));
  define("DB_USER", $db["user"]);
  define("DB_PASSWORD", $db["pass"]);
  define("DB_HOST", $db["host"]);
}
else {
  die("Your heroku DATABASE_URL does not appear to be correctly specified.");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T19:30:42.440

WordPress 的 wordpress-heroku fork 解决了我的问题。

它开箱即用，如果您打算在 Heroku 上使用 WordPress，我绝对会推荐它。

不幸的是，我仍然不知道我第一次做错了什么。

# windows - 如何为动画 GIF 加水印并将 2 个 ImageMagick 命令组合在一起？

> ID：12100565
> 
> 赞同：1
> 
> 时间：2012-08-23T21:56:57.690
> 
> 标签：windows, image, image-processing, imagemagick

我在使用命令行中的 imagemagick 的 Windows 7 机器上。

以下代码用于向图像添加水印：

```
composite                      \
     -watermark 30%            \
     -gravity south            \
      the_watermark.png        \
      pic_to_be_watermaked.png \
      watermark_completed.png 
```

问题是：

*   当我尝试为动画 GIF 加水印时它不起作用
*   如何将此水印命令与以下命令结合使用？

此命令获取文件夹“static_images”中的所有 PNG，并将它们组合成动画 GIF。它还确保图像宽度为 350 像素，高度保持适当的纵横比。它还使图像有些模糊，并将动画的速度设置为 4，并确保它无限循环：

```
convert                         \
   -resize 350x350              \
   -fuzz 1.6%                   \
   -delay 4                     \
   -loop 0                      \
    static_images/*.png         \
   -layers OptimizePlus         \
   -layers OptimizeTransparency \
    animated_gif.gif 
```

## 问题：

1.  如何将水印命令与上述命令结合使用？
2.  如何让水印命令与动画 GIF 一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T20:07:47.683

这是你想看到的结果吗？

![带水印的 GIF 动画](../Images/870e179b0f14e249e6aa9cde0d860a8a.png)

诀窍是先给每个 PNG 源文件加水印，然后从加水印的 PNG 创建 GIF。

所以这是这两个命令的结果。首先，创建带水印的 PNG：

```
for i in sample_images/000*.png; do   
   convert                                     \
      "${i}"                                   \
      sample_images/the_watermark.png          \
     -gravity south                            \
     -composite                                \
      sample_images/$(basename "${i}")_wm.png;
done 
```

请注意，我没有使用您的确切`composite`命令，因为它没有创建可读的水印，只是在指定区域有些模糊......

其次，将带水印的 PNG 转换为动画 GIF：

```
convert                         \
   -resize 350x350              \
   -fuzz 1.6%                   \
   -delay 4                     \
   -loop 0                      \
    sample_images/*_wm.png      \
   -layers OptimizePlus         \
   -layers OptimizeTransparency \
    animated_gif.gif 
```

这是你的意思吗？

# sql - 按列而不是行对结果进行排序

> ID：12100566
> 
> 赞同：6
> 
> 时间：2012-08-23T21:57:01.787
> 
> 标签：sql, sql-server, tsql, sql-server-2005

在 SQL 中是否可以按列而不是按行排序？我不需要基本的 ORDER BY 语句，我知道它们是如何工作的（即：按 column1、column2 等排序）。

基本上试图对这样的东西进行排序：

```
column 1    column 2    column 3
   1            0           3 
```

试图对此进行排序：

```
column 3    column 1    column 2
   3           1           0 
```

这在 SQL 中甚至可能吗？最好是 t-sql 或任何将在 sql server 2005 上运行的东西

我在网上搜索了几个小时，似乎没有人想问这个问题。或者我不擅长搜索。

```
 ; with numbered as
   (
     select SUM(OrderReceived) as c1, SUM(OrderOnHold) as c2, SUM(OrderConfirmed) as     c3,
     row_number() over (order by employee) RecordNumber
     from( SELECT 

e.FirstName+' '+e.LastName AS Employee
,CASE WHEN oim.MilestoneID = 10 THEN 1 ELSE 0 END as OrderReceived
,CASE WHEN oim.MilestoneID = 15 THEN 1 ELSE 0 END as OrderOnHold
,CASE WHEN oim.MilestoneID = 20 THEN 1 ELSE 0 END as OrderConfirmed
FROM OrderItems oi
    JOIN Orders o on o.orderid = oi.orderid
    JOIN OrderItemMilestones oim on oim.orderid = oi.orderid and oim.orderitemid     =     oi.orderitemid
    JOIN Milestones m on m.milestoneid = oim.milestoneid
    JOIN Employees e on e.username = oim.recordedbyuser
    JOIN Clients cl on cl.clientid = o.clientid
WHERE oim.MilestoneDate Between '2012-08-01' and '2012-08-05'
    and e.terminationdate is null
),

ordered as
(
 select SUM(OrderReceived) as c1, SUM(OrderOnHold) as c2, SUM(OrderConfirmed) as c3,
         row_number() over (partition by RecordNumber
                           order by employee desc) rn
    from numbered

  unpivot (v for c in (c1, c2, c3)) u
)
select RecordNumber,
     [1] c1,
     [2] c2,
     [3] c3
 from 
 (
 select RecordNumber,
         v,
         Rn
    from ordered
  ) o
 pivot (min(employee) for Rn in ([1], [2], [3])) p 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-24T01:57:35.687

这是对列进行排序的相对简单的方法。如果您首先对数据进行[unpivot](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.90%29.aspx)、排序和[旋转](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.90%29.aspx)，您将获得已排序的列。

[这是带有示例的 Sql Fiddle](http://sqlfiddle.com/#!3/6d442/12)。

```
-- Assign arbitrary numbers to records
-- You might skip this part if you have unique column
-- in which case you should replace RecordNumber with this ID
; with numbered as
(
  select *,
         row_number() over (order by (select null)) RecordNumber
    from test
),
-- Generate order by
-- For all the columns in record.
-- Rn will always be in range
-- 1..NumberOfColumns
-- Order is done on unpivoted data
ordered as
(
  select *,
         row_number() over (partition by RecordNumber
                            order by v desc) rn
    from numbered
 -- list all the columns here
 -- v is for value
 -- c is for column
 unpivot (v for c in (c1, c2, c3)) u
)
-- Finally return the data in original layout
select RecordNumber,
       [1] c1,
       [2] c2,
       [3] c3
  from 
  (
    -- Only the columns needed by the query
    -- Pivot will not play nice even if you
    -- Select only subset of columns in
    -- outer query
    select RecordNumber,
           v,
           Rn
      from ordered
  ) o
 -- Get value for row numbers 1..NumberOfColumns
 pivot (min(v) for Rn in ([1], [2], [3])) p 
```

您可能想要添加标题行，以便知道哪个值来自哪个列。为此，我将添加一个标识标题/行的列，合并所有`o`以获取相应的标题和顺序，以确保这两行保持在一起：

```
 (
    select RecordNumber,
           v,
           Rn,
           1 HdrRow
      from ordered
     union all
    select RecordNumber,
           c,    -- Column name is in c
           Rn,
           0 HdrRow
      from ordered
  ) o
    ...
  order by RecordNumber, HdrRow 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-23T22:00:14.337

你在用`SELECT *`吗？如果是这样，请停止这样做。如果您知道您希望它们以这种方式列出，请编写：

```
SELECT [column 3], [column 1], [column 2] FROM dbo.table; 
```

如果您的意思是要在这些列中排序，我不确定这会有多大意义。但我想你可以这样做：

```
DECLARE @x TABLE(c1 INT, c2 INT, c3 INT);

INSERT @x(c1,c2,c3) SELECT 2,1,3
UNION ALL SELECT 3,4,5
UNION ALL SELECT 5,4,3
UNION ALL SELECT 3,1,2
UNION ALL SELECT 3,3,3
UNION ALL SELECT 3,4,3
UNION ALL SELECT 4,3,4;

SELECT c1 = CASE
  WHEN c1 >= c2 AND c1 >= c3 THEN c1
  WHEN c2 >= c1 AND c2 >= c3 THEN c2
  ELSE c3 END,
c2 = CASE 
  WHEN c1 >= c2 AND c1 >= c3 THEN 
    CASE WHEN c2 >= c3 THEN c2 ELSE c3 END
  WHEN c2 >= c1 AND c2 >= c3 THEN
    CASE WHEN c1 >= c3 THEN c1 ELSE c3 END
  ELSE
    CASE WHEN c1 >= c2 THEN c1 ELSE c2 END
  END,
c3 = CASE
  WHEN c1 <= c2 AND c1 <= c3 THEN c1
  WHEN c2 <= c1 AND c2 <= c3 THEN c2
  ELSE c3 END
FROM @x; 
```

结果：

```
c1   c2   c3
---- ---- ----
3    2    1
5    4    3
5    4    3
3    2    1
3    3    3
4    3    3
4    4    3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:09:41.173

## 带动态查询的双重查询

如果您的查询只返回一行，那么您可以通过执行两次查询来解决这个问题：

1.  查询您的数据以获取列的值
    a)**并**根据结果中的值生成具有列顺序的动态 SQL
2.  执行动态查询

如果您的查询应该返回几行数据，我想我们将需要更多信息，以便提出一个可行的解决方案或至少一个更好的建议来解决您的问题。

# asp.net - @Html.EditorForModel() 的自定义文件名？

> ID：12100570
> 
> 赞同：0
> 
> 时间：2012-08-23T21:57:07.690
> 
> 标签：asp.net, asp.net-mvc-3, editortemplates

所以我有以下代码：

```
@model IEnumerable<My_School_Book.Models.Mark>
@{
    ViewBag.Title = "Marks";
}

<div class="row-fluid">
    <h1>Assignment Marks:</h1>
    @using (Html.BeginForm("Marks", "Assignment", FormMethod.Post, new { @class = "form-horizontal" }))
    {
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Student</th>
                    <th style="width: 50px;">Mark
                    </th>
                    <th style="width: 50px;">Total
                    </th>
                    <th style="width: 50px;">Weight</th>
                </tr>
            </thead>
            <tbody>
                @Html.EditorForModel()
            </tbody>
        </table>
        <div class="form-actions">
            <button type="submit" class="btn btn-primary"><i class="icon-checkmark"></i>&nbsp;Save</button>
            <a href="@Url.Action("Index", "Assignment")" class="btn btn-primary"><i class="icon-back"></i>&nbsp;Cancel</a>
        </div>
    }
</div> 
```

如您所见，传递给视图的模型是模型标记的 IEnumerable。

现在我在 Views/Shared 文件夹下有一个 EditorTemplate，名为 Mark：

```
@model My_School_Book.Models.Mark
<tr>
    <td>@Model.Student.FullName</td>
    <td>
        @Html.TextBoxFor(model => Model.Grade, new { @class = "span12", @style = "min-height: 20px;", @maxlength = "5" })
    </td>
    <td>
        @Model.Assignment.Total
    </td>
    <td>@Model.Assignment.Weight</td>
</tr> 
```

**我的问题是**，我可以将我的 EditorTemplate 文件从 Mark 重命名为 AssignmentMarks 吗？我希望它更具体，而不是一个名为 Marks 的通用名称。

编辑：

在我的 MarkRepository.cs 里面

```
 public IEnumerable<Mark> GetAllByAssignmentID(Guid id)
    {
        return context.Marks.Where(m => m.AssignmentID == id);
    } 
```

在我的 AssignmentController.cs 中

```
 public ActionResult Marks(Guid id)
    {
        IEnumerable<Mark> Marks = markRepository.GetAllByAssignmentID(id).ToList();
        return View(Marks);
    }

    [HttpPost]
    public ActionResult Marks(IEnumerable<Mark> viewModel)
    {
        if (ModelState.IsValid)
        {

        }
        return View(viewModel);
    } 
```

在我的 Marks.cshtml 里面

```
 @Html.EditorForModel("Mark", "AssignmentMark") 
```

在我的 AssignmentMark.cshtml 中

```
@model My_School_Book.Models.Mark
<tr>
    <td>@Html.DisplayTextFor(model => model.Student.FullName)</td>
    <td>@Html.TextBoxFor(model => model.Grade, new { @class = "span12" })</td>
    <td>@Html.DisplayTextFor(model => model.Assignment.Total)</td>
    <td>@Html.DisplayTextFor(model => model.Assignment.Weight)</td>
</tr> 
```

我在视图上收到的错误现在是：

```
System.Data.Entity.DynamicProxies.Assignment_7EDE7AD8477AB363802A036747CD8A8B259C6CD72DCEF587A2B0FBEDC7B2DCE1System.Data.Entity.DynamicProxies.Assignment_7EDE7AD8477AB363802A036747CD8A8B259C6CD72DCEF587A2B0FBEDC7B2DCE1System.Data.Entity.DynamicProxies.Assignment_7EDE7AD8477AB363802A036747CD8A8B259C6CD72DCEF587A2B0FBEDC7B2DCE1System.Data.Entity.DynamicProxies.Assignment_7EDE7AD8477AB363802A036747CD8A8B259C6CD72DCEF587A2B0FBEDC7B2DCE1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T02:37:42.390

1.  将您的模型类重命名为`AssignmentMarks`
2.  代替`@EditorForModel()`，运行以下命令：

    ```
    @foreach(var mark in Model)
    {
      @EditorFor(m => m.Mark, "AssignmentMark")
    } 
    ```

希望这会帮助你。

# gxt - 在 GXT 网格的列中禁用 *一些* 复选框

> ID：12100571
> 
> 赞同：1
> 
> 时间：2012-08-23T21:57:08.637
> 
> 标签：gxt

我有一个显示一些“用户”对象的 GXT 网格。其中一列包含复选框 (CheckboxCell) 。我需要为 1 个特定用户禁用一个复选框，并让其他用户保持启用状态。

我尝试扩展 CheckboxCell 类 - 它没用，因为它不知道上下文（用户正在渲染）：它只知道真/假状态。

试过了

```
GridView view = table.getView();
Element cell = view.getCell(0, 1);
cell.setAttribute("disabled", "disabled"); 
```

-没运气。disabled 属性设置在外部“td”标签而不是子“input”元素上。尝试了 cell.getChild..() 方法 - 它们都抛出“方法不存在”异常。

更新：我最终创建了自己的扩展 AbstractEditableCell 的 CheckboxCellWhichCanBeDisabled 类。恐怕没有别的办法了。

# facebook-graph-api - 是否有 API 可以强制 Facebook 再次抓取页面？

> ID：12100574
> 
> 赞同：48
> 
> 时间：2012-08-23T21:57:20.717
> 
> 标签：facebook-graph-api, caching, facebook-like, facebook-opengraph, facebook-sharer

我知道您可以通过在 Facebook 的调试器工具上输入 URL 来强制更新页面的缓存，同时以该应用程序/页面的管理员身份登录： [https ://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)

但我需要的是一种方法来**自动调用 API 端点或我们内部应用程序中的某些东西，每当我们销售部门的人更新我们一个页面的主图像时**。要求成千上万的销售人员以管理员身份登录并在他们更新我们商品的描述或图像时手动更新页面的缓存是不可行的。

我们不能等待 24 小时让 Facebook 更新其缓存，因为我们每天都会收到客户的投诉，只要他们在我们这边更改后没有立即显示更改。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-08-24T00:12:02.767

页面元数据不是那种应该经常更改的东西，但是您可以通过转到[Facebook 的调试工具](https://developers.facebook.com/tools/debug)并输入要抓取的 URL来手动清除缓存

还有一个用于执行此操作的 API，它[适用于任何 OG 对象](https://developers.facebook.com/docs/opengraph/objects/#update)：

```
curl -X POST \
     -F "id={object-url OR object-id}" \
     -F "scrape=true" \
     -F "access_token={your access token}" \
     "https://graph.facebook.com" 
```

现在需要 access_token。这可以是应用程序或页面 access_token；不需要用户身份验证。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-10-02T21:55:39.387

如果您想在 PHP 中执行此操作而无需**等待回复**，以下函数将执行此操作：

```
//Provide a URL in $url to empty the OG cache
function clear_open_graph_cache($url, $token) {
  $vars = array('id' => $url, 'scrape' => 'true', 'access_token' => $token);
  $body = http_build_query($vars);

  $fp = fsockopen('ssl://graph.facebook.com', 443);
  fwrite($fp, "POST / HTTP/1.1\r\n");
  fwrite($fp, "Host: graph.facebook.com\r\n");
  fwrite($fp, "Content-Type: application/x-www-form-urlencoded\r\n");
  fwrite($fp, "Content-Length: ".strlen($body)."\r\n");
  fwrite($fp, "Connection: close\r\n");
  fwrite($fp, "\r\n");
  fwrite($fp, $body);
  fclose($fp);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-04-30T02:41:23.580

如果您使用的是 javascript sdk，那么您要使用的版本是

```
FB.api('https://graph.facebook.com/', 'post', {
            id: [your-updated-or-new-link],
            scrape: true
        }, function(response) {
            //console.log('rescrape!',response);
        }); 
```

我碰巧喜欢 P​​romise，所以使用 jQuery Deferreds 的替代版本可能是

```
function scrapeLink(url){
    var masterdfd = $.Deferred();
    FB.api('https://graph.facebook.com/', 'post', {
        id: [your-updated-or-new-link],
        scrape: true
    }, function(response) {
        if(!response || response.error){
            masterdfd.reject(response);
        }else{
            masterdfd.resolve(response);
        }
    });
    return masterdfd;
} 
```

然后：

```
scrapeLink([SOME-URL]).done(function(){
    //now the link should be scraped/rescraped and ready to use
}); 
```

请注意，刮板可能需要不同的时间才能完成，因此不能保证它会很快。我也不知道 Facebook 对这种方法的重复或自动使用有何看法，因此明智和保守地使用它可能是值得的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-01-31T19:10:15.997

这是一个简单的 ajax 实现。将其放在您希望 facebook 立即抓取的任何页面上；

```
var url= "your url here";
        $.ajax({
        type: 'POST',
        url: 'https://graph.facebook.com?id='+url+'&scrape=true',
            success: function(data){
               console.log(data);
           }
    }); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-01-22T13:10:34.353

使用 curl 在 Drupal 节点更新中的替代解决方案可能是这样的：

```
<?php
function your_module_node_postsave($node) {
    if($node->type == 'your_type') {
        $url = url('node/'.$node->nid,array('absolute' => TRUE));
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, 'https://graph.facebook.com/v1.0/?id='. urlencode($url). '&scrape=true');
        $auth_header = 'Oauth yOUR-ACCESS-TOKEn';
        curl_setopt($ch, CURLOPT_HTTPHEADER, array($auth_header));
        curl_setopt($ch, CURLOPT_POST, 1);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        $r = curl_exec($ch);
        curl_close ($ch);
    }
} 
```

注意不支持标准 Drupal 核心的 hook_node_postsave() 实现。我必须使用[www.drupal.org/project/hook_post_action](http://www.drupal.org/project/hook_post_action)才能让这个 facebook 抓取拾取最后对节点进行更改，因为在数据库更新后不会触发 hook_node_update()。

Facebook 现在需要访问令牌才能完成此操作。获取令牌的指南可以在这里找到： [https ://smashballoon.com/custom-facebook-feed/access-token/](https://smashballoon.com/custom-facebook-feed/access-token/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-08-11T08:35:18.733

Graph API v2.10 有变化：

> 当针对我们以前没有抓取过的 URL 发出 GET 请求时，我们还将省略 og_object 字段。要触发抓取并填充 og_object，请发出 POST /{url}?scrape=true。一旦被抓取，og_object 将保持缓存并在所有未来的读取请求中返回。
> 
> 从 2017 年 10 月 16 日开始，我们将在所有版本的 Graph API 中要求这些请求的访问令牌。

来源：[Graph API v2.10 简介](https://developers.facebook.com/blog/post/2017/07/18/graph-api-v2.10/)

所以现在我们应该使用 POST 方法进行抓取：

`POST /{url}?scrape=true`

不是

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-31T00:09:58.970

我是[Facebook Object Debugger CLI](https://github.com/dedalozzo/facebook-od)的作者，这是一个用 PHP 编写的命令行界面，旨在使用文本文件作为输入来刷新单个 URL 或一堆 URL 的 Facebook 缓存。该[软件包](https://packagist.org/packages/3f/facebook-od)也可以在[Packagist](https://packagist.org)上使用，并且可以使用[Composer](http://getcomposer.org)进行安装。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-08T18:05:08.700

这是我使用 Koala gem 和 Facebook API v2.9 的 Ruby 解决方案

```
 api = Koala::Facebook::API.new(access_token)
    response = api.put_object(nil, nil, {scrape: true, id: "url-of-page-to-scrape"}) 
```

`response`应该是从被抓取`og:`的页面上的元标记中检索到的属性哈希。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-02-18T18:18:50.927

使用 PHP Facebook SDK 的解决方案：

```
<?php
   try {
      $params = [
         'id' => 'https://www.mysitetoscrape.com/page',
         'scrape' => 'true',
      ];
      $response = $fb->post('/', $params);
      print_r($response);
   } catch(\Facebook\Exceptions\FacebookResponseException $e) {
      // When Graph returns an error
      echo 'Graph returned an error: ' . $e->getMessage();
   } catch(\Facebook\Exceptions\FacebookSDKException $e) {
      // When validation fails or other local issues
      echo 'Facebook SDK returned an error: ' . $e->getMessage();
   }
?> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-07-19T08:31:04.837

我也面临同样的问题。有一种清除缓存的简单方法。

1.  [http://developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)
2.  **在fbrefresh=CAN_BE_ANYTHING**后面输入 URL

 **示例：[http ://www.example.com?fbrefresh=CAN_BE_ANYTHING](http://www.example.com?fbrefresh=CAN_BE_ANYTHING)**

# r - R中的递归分区

> ID：12100575
> 
> 赞同：2
> 
> 时间：2012-08-23T21:57:29.140
> 
> 标签：r, party

我的目标是根据几个客户属性（人口统计、过去的购买类别等）更好地预测公司客户群的购买习惯。我有一个包含大约 100,000 名回头客的数据集，包括他们上次购买的时间间隔（本研究中的因变量）以及几个属性（连续的和分类的）。

我计划对每个细分（定义为在观察中具有相似时间间隔的细分）进行生存分析，以帮助了解购买之间可能的时间间隔。我遇到的问题是如何最好地定义这些细分；即属性分组，使得段之间的时间间隔足够不同而段内的时间间隔相似。我相信构建决策树是最好的方法，我想使用递归分区。

我是 R 新手，并且已经使用了`party`包的`mob`命令，但是我对模型中要包含哪些变量以及要包含哪些进行分区（命令：`mob(y ~ x1 + ... + xk | z1 + ... + zk)`，`x`是模型变量和`z`分区）感到困惑。我只是想从一组属性中构建一棵树，所以我想我想对所有属性进行分区？没有把握。我也尝试过该`rpart`命令，但根据 cp 级别，要么没有树，要么得到具有数十万个节点的树。

如果有人有任何建议，我将不胜感激。对小说感到抱歉，感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T23:52:33.887

从文档中`?mob`：

> MOB 是一种基于模型的递归分区算法，可生成一棵树，该树具有与每个终端节点关联的拟合模型。

它要求模型变量，因为它会在分割变量后在每个终端节点（例如线性、逻辑）建立一个模型。如果您想在不将模型拟合到终端节点的情况下进行分区，我使用的功能是`ctree`（也在`party`包中）。

# python - 如果我的资源更新方法还创建了不同类型的资源，它是否是线程安全的？

> ID：12100577
> 
> 赞同：3
> 
> 时间：2012-08-23T21:57:39.783
> 
> 标签：python, django, tastypie

Tastypie 文档指出，捆绑包[**使 Tastypie 更加线程安全**](http://django-tastypie.readthedocs.org/en/latest/bundles.html#what-are-bundles)，但没有解释如何以及在什么条件下。我已经查看了[代码](https://github.com/toastdriven/django-tastypie/blob/master/tastypie/resources.py#L1910)，但是没有足够的经验来解决它。

我正在制作一个游戏原型，它有一个圆形对象*（对于每一轮比赛）*和每一轮的多个状态*（对于该轮每个玩家的信息）*。每个玩家都会通过对回合单词短语的回答来更新自己的状态。我需要一种机制来懒惰地创建下一轮游戏，如果它还不存在的话。我目前在玩家更新他们的状态时触发该轮创建。

如果多个玩家同时更新他们的状态*（见`StateResource.obj_update()`）*，那么他们创建下一轮的尝试会发生冲突吗？我认为如果一个`obj_update`调用检查下一轮是否存在并尝试在另一个`obj_update`完成创建下一轮之前创建下一轮，则可能会发生这种情况。我会用某种类型的互斥锁来解决这个问题，但我不确定这是否有必要。我想知道是否有一种美味的方式来解决这个问题。

我的代码如下：

```
#models.py
class Round(models.Model):
    game_uid = models.CharField(max_length=75)
    word = models.CharField(max_length=75)
    players = models.ManyToManyField(User)
    next_round = models.OneToOneField('self',null=True,blank=True)

class PlayerRoundState(models.Model):
    player = models.ForeignKey(User)
    round = models.ForeignKey(Round)
    answer = models.CharField(max_length=75)

#api.py
class RoundResource(ModelResource):
    players = fields.ManyToManyField(UserResource, attribute='players',full=False)
    states = fields.ManyToManyField('wordgame.api.StateResource',
                                attribute='playerroundstate_set',
                                full=True)
    . . .
    def obj_create(self, bundle, request=None, **kwargs):
        bundle = super(RoundResource, self).obj_create(bundle, request,**kwargs)
        bundle.obj.word = choice(words) #Gets a random word from a list
        bundle.obj.round_number = 1
        bundle.obj.game_uid = bundle.obj.calc_guid() #Creates a unique ID for the game
        bundle.obj.save()
        return bundle

class StateResource(ModelResource):
    player = fields.ForeignKey(UserResource, 'player',full=False)
    round = fields.ForeignKey(RoundResource, 'round')
    . . . 
    def obj_update(self, bundle, request=None, skip_errors=False, **kwargs):
        bundle = super(StateResource, self).obj_update(bundle, request,
                                                   skip_errors, **kwargs)
        if bundle.obj.round.next_round is None:
            new_round = Round()
            new_round.word = choice(words)
            new_round.round_number = bundle.obj.round.round_number + 1
            new_round.game_uid = bundle.obj.round.game_uid
            new_round.save()
            for p in bundle.obj.round.players.all():
                new_round.players.add(p)
            new_round.save()
            bundle.obj.round.next_round = new_round
            bundle.obj.round.save()

        return bundle 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T02:21:06.713

我认为这与 Tastypie 没有太大关系。

您描述的问题与 ORM 和数据库有关。问题是，在某些情况下，这两个请求都可能创建新请求`Round()`（如果它们可以并行服务并随时切换，gunicorn 和 gevent 就是这种情况），并且其中一个请求会变得陈旧。

考虑以下情况：

第一个请求到达，检索当前轮并“看到”没有“下一个”轮。所以它执行：

```
new_round = Round()
new_round.word = choice(words)
new_round.round_number = bundle.obj.round.round_number + 1
new_round.game_uid = bundle.obj.round.game_uid
new_round.save() 
```

与此同时，第二个请求来了，并且（假设它在您的设置中是可能的）处理切换到第二个请求。它还检索当前回合，并且它还“看到”没有下一轮，因此它也创建了一个（同一逻辑回合的第二个对象）。

然后处理切换回执行的第一个请求：

```
for p in bundle.obj.round.players.all():
    new_round.players.add(p)
new_round.save()
bundle.obj.round.next_round = new_round
bundle.obj.round.save() 
```

所以现在“有”下一轮。第一个请求已处理，一切看起来都不错。但是第二个请求还没有完成，它执行了同样的操作，覆盖了当前的轮对象。

结果是您有一个过时的实例（`Round`由第一个请求创建），并且第一组玩家使用`Round`与第二组不同的实例。

这会导致数据库中的状态不一致。因此，在这种情况下，您的资源更新方法*不是*线程安全的。

对此的一种解决方案是`select_for_update`用于从数据库中检索当前轮次。请参阅[Django 文档](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-for-update)。如果你使用它，第二个和连续的请求将等到你在第一个请求中修改当前轮次，然后才从数据库中检索它。结果将是他们已经“看到”了下一轮，而不是尝试创建它。当然，您必须确保整个更新构成一个事务。

“使用”它的`obj_get()`方法是覆盖资源中的方法，`StateResource`而不是：

```
base_object_list = self.get_object_list(request).filter(**kwargs) 
```

使用（未测试）：

```
base_object_list = self.get_object_list(request).select_for_update().filter(**kwargs) 
```

当然，这不是唯一的解决方案，但其他解决方案可能会涉及重新设计您的应用程序，因此这可能会涉及较少。

# c# - 在 MSBuild 文件中如何获取引用的项目？

> ID：12100578
> 
> 赞同：1
> 
> 时间：2012-08-23T21:57:41.897
> 
> 标签：c#, visual-studio-2010, msbuild

我有一个 MSBuild 脚本文件，我想为文件中导入的每个项目执行一个操作。

如何访问引用的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T02:39:02.360

目前尚不清楚您希望对每个项目执行什么样的操作。假设您只想打印出引用项目的路径，这里是示例代码：

```
 Dictionary<string, string> globalProperties = new Dictionary<string, string>();

    globalProperties.Add("Configuraion", "Debug");
    globalProperties.Add("Platform", "AnyCPU");

    ProjectCollection pc = new ProjectCollection(globalProperties);

    Project sln = pc.LoadProject(@"MyProject.csproj", "4.0");

    foreach (ProjectItem pi in sln.Items)
    {
        if (pi.ItemType == "ProjectReference")
        {
            Console.WriteLine(pi.EvaluatedInclude);
        }
    } 
```

上面的代码使用Microsoft.Build.dll 中的[ProjectCollection](http://msdn.microsoft.com/en-us/library/microsoft.build.evaluation.projectcollection)和[Project](http://msdn.microsoft.com/en-us/library/microsoft.build.evaluation.project)类型，它是 MSBuild 的一部分。

请注意，理论上项目引用取决于构建参数，例如，您可能会引用调试库进行调试配置，而不是发布。因此，在初始化 ProjectCollection 时，您必须传递所需的参数。

# java - 转换像素颜色（字节到位和位到字节）

> ID：12100580
> 
> 赞同：1
> 
> 时间：2012-08-23T21:57:56.420
> 
> 标签：java

我想通过使用像素位来操纵图像。所以，我想隐藏从 PixelGrabber 抓取的像素。argb 值以字节为单位。现在我想将字节数组转换为位并对其进行操作。然后转换回字节数组。

例如：-1057365 到 11101111 11011101 10101011 11111111 和 11101111 11011101 10101011 11111111 到 -1057365

有人知道有什么有效的方法可以在它们之间进行转换吗？或者java已经为它实现了方法，我不知道。

谢谢帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:05:52.553

我假设您拥有的值是 ARGB 代码的原始 4 字节 int 表示。每个通道都是 1 字节宽，范围从 0 到 254，它们一起构成了 0-255^4（减 1）的整个范围。

获取不同通道值的最佳方法是结合屏蔽并将 argb 值转移到不同的字段中。

```
int alpha = (pixel >> 24) & 0xff;
int red   = (pixel >> 16) & 0xff;
int green = (pixel >>  8) & 0xff;
int blue  = (pixel      ) & 0xff; 
```

[来源](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/image/PixelGrabber.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:04:29.387

你可能想看看[`BitSet`](http://docs.oracle.com/javase/7/docs/api/java/util/BitSet.html)。

```
byte[] argb = ...
BitSet bits = BitSet.valueOf(argb);
bits.set(0); // sets the 0th bit to true
bits.clear(0); // sets the 0th bit to false

byte[] newArgb = bits.toByteArray(); 
```

/edit
将 a 转换`byte[]`为`int`：

```
int i = 0;
for(byte b : newArgb) { // you could also omit this loop
    i <<= 8;            // and do this all on one line
    i |= (b & 0xFF);    // but it can get kind of messy.
} 
```

或者

```
ByteBuffer bb = ByteBuffer.allocate(4);
bb.put(newArgb);
int i = bb.getInt(); 
```

# objective-c - UIView 子类 dealloc 未调用

> ID：12100586
> 
> 赞同：0
> 
> 时间：2012-08-23T21:58:29.360
> 
> 标签：objective-c, ios, memory, automatic-ref-counting, aqgridview

我正在使用 AQGridView 在我的应用程序中显示图像网格。用户单击相册，然后我打开一个带有所有图像的网格的新控制器。问题是当用户按下后退按钮返回专辑列表时，网格视图上的 dealloc 没有被调用。我在视图控制器的 dealloc 中记录了一个字符串，它正在被调用。我已经检查了 Instruments 中的 heapshots，即使在弹出视图之后，与 AQGridView 相关的所有内容都不会被释放。我使用 Interface Builder 创建网格视图，它连接到我的 .h 文件中的网格视图。

```
@property (weak, nonatomic) IBOutlet AQGridView *gridView; 
```

我没有持有任何其他指向网格视图的指针。我正在为该项目使用 ARC。我是否需要在网格视图控制器的 dealloc 中以某种方式解除分配 gridView 还是由 ARC 自动处理？如果是，是什么阻止了它被释放？

编辑：我正在使用 NSOperationQueue 在后台加载图像，然后在加载图像后，将它们放入网格单元格中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:17:34.297

在`dealloc`您的网格视图控制器的方法中，将 gridView 指针设置为 nil。

```
-(void)dealloc
{
    self.gridView = nil; 
} 
```

# python - sed和python正则表达式不一致

> ID：12100588
> 
> 赞同：15
> 
> 时间：2012-08-23T21:58:35.327
> 
> 标签：python, regex, sed

*如果这是在某处发布，我深表歉意，但我粗略的搜索没有找到任何东西。*

在进行一些 Python 编程时，我注意到以下命令：

```
re.sub("a*((ab)*)b", r"\1", "aabb") 
```

返回空字符串。但是 sed 中的等效命令：

```
echo "aabb" | sed "s/a*\(\(ab\)*\)b/\1/" 
```

返回`ab`。

对我来说，python 正则表达式开头的 "a*" 指令将匹配两个`a`'s，导致 "(ab)*" 匹配零次，但我不知道 sed 是如何出现的`ab`。有谁知道导致这种情况的两个正则表达式引擎之间有什么区别？我相信默认情况下它们都贪婪地匹配星星，但我想到 sed 可能从右边而不是左边匹配。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-25T18:34:26.767

默认情况下，Python 和 sed 都是贪婪的，但是...... Python 正则表达式尝试在所有情况下从左到右进行评估，尽管如果正在尝试的分支无法通过匹配继续，它最终必须回溯到先前的状态。相反，Sed 正则表达式在评估之前进行优化，以防止不必要的回溯，通过将正则表达式重写为更具确定性的形式。因此，组合的可选模式“aab”可能在普通的“a”之前测试，因为最具体的可能字符串首先被尝试。

Python 模式将字符串“aabb”匹配为“aab”+“b”两次（标记在“<>”之间）

```
>>> re.sub("a*((ab)*)b", r"<\1>", "aabb")
'<><>' 
```

而 sed 通过一个替换匹配整个“aabb”：

```
$ echo "aabb" | sed "s/a*\(\(ab\)*\)b/<\1>/"
<ab> 
```

Python regex backtrace 算法在[regex howto - Repeating Things](http://docs.python.org/howto/regex.html#repeating-things) in two paragraphs 由“A step-by-step example...”一词介绍的很好地解释了。它完全按照[正则表达式文档](http://docs.python.org/library/re.html#regular-expression-syntax)的描述执行 IMO ：“扫描目标字符串时，RE 由 '|' 分隔 **从左到右尝试**。”

示范

顺便说一句，“(|a|aa)”的顺序。"(aa|a|)" 受到 Python 的尊重

```
>>> re.sub("(?:|a|aa)((ab)*)b", r"<\1>", "aabb")
'<ab>'
>>> re.sub("(?:aa|a|)((ab)*)b", r"<\1>", "aabb")
'<><>' 
```

但是这个顺序被**sed 忽略了，**因为 sed 优化了正则表达式。匹配“aab”+“b”可以从模式中删除“a”选项来复制。

```
$ echo "aabb" | sed "s/\(\|a\|aa\)\(\(ab\)*\)b/<\2>/g"
<ab>
$ echo "aabb" | sed "s/\(aa\|a\|\)\(\(ab\)*\)b/<\2>/g"
<ab>
$ echo "aabb" | sed "s/\(aa\|\)\(\(ab\)*\)b/<\2>/g"
<><> 
```

* * *

**编辑**：我删除了有关 DFA/NFA 的所有内容，因为我无法从当前文本中证明这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T19:12:09.267

您构建的有趣谜题。根据我的阅读，python 和 sed 的正则表达式引擎都基于 Henry Spencer 的正则表达式库（与 perl 一样），它依赖于回溯。（不幸的是，我找不到我以此为基础的文章）。

无论如何，这**不**应该是一个实现细节：Python 的行为违反了 POSIX 标准，该标准要求 RE (a) 在最早的可能点匹配，并且 (b) 匹配从该点开始的最长可能字符串. （有关此内容以及更多内容，请参见[`man 7 regex`](http://linux.die.net/man/7/regex)（在 Linux 上）。）

要找到最长的匹配项，回溯（“NFA 类型”）正则表达式引擎必须在找到一个匹配项后继续检查备选方案。因此，实施者偷工减料也就不足为奇了。显然，python 的行为是不一致的，因为它无法找到最长的匹配项。根据 sed 手册页，“出于性能原因”，sed 也不总是符合要求。但很明显，这件事是正确的。

顺便说一句，您的命令并不完全等效：`re.sub`将尽可能多次执行替换，而 sed`s/a/b/`只会执行一次。sed 版本应该是：

```
echo "aabb" | sed "s/a*\(\(ab\)*\)b/\1/g" 
```

这解释了为什么我们在 python 中得到空字符串：RE 匹配`aab`第一次，其余`b`第二次匹配，删除每个部分（因为它全部匹配正则表达式`a*`的最后`b`一个）。您可以通过以下变体看到这一点：

```
>>> re.sub("a*((ab)*)b", r"X\1Y", "aabb")
'XYXY' 
```

# objective-c - iOS - 如何将 UI 对象重置为默认样式

> ID：12100589
> 
> 赞同：1
> 
> 时间：2012-08-23T21:58:37.607
> 
> 标签：objective-c, ios, user-interface, uitextfield

有没有办法将 UI 对象重置为`UITextField`默认的 iOS 外观？

我问是因为我在文本字段周围放置了一个红色边框作为表单验证的一部分，并且我在删除边框时遇到了麻烦，以便 UITextField 看起来与以前*完全相同*。我可以让它非常接近，但它的关闭足以让整天看着 iPhone 屏幕的人注意到:)。

![在此处输入图像描述](../Images/d0b0dd6893887444d4ac7594a08913ab.png) ![在此处输入图像描述](../Images/05c4219f48b0424912ddabed9ddecf0f.png)

这是我给 UITextField 一个红色边框的代码。

```
textfield.layer.borderWidth = 2.0f;
textfield.layer.borderColor = [[[UIColor redColor] colorWithAlphaComponent:0.5] CGColor];
textfield.layer.cornerRadius = 8.0f; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:38:25.143

对于borderWidth 和cornerRadius，默认值为0，对于borderColor，默认值为黑色。

```
textfield.layer.borderWidth = 0;
textfield.layer.borderColor = [[UIColor blackColor] CGColor];
textfield.layer.cornerRadius = 0; 
```

您还可以在更改之前将这些值保存到某个字段，并在需要重置字段时使用保存的值。如果将来默认值发生变化，这甚至会起作用。

# ios - Cocos2d缩放精灵导致神器

> ID：12100603
> 
> 赞同：0
> 
> 时间：2012-08-23T21:59:27.597
> 
> 标签：ios, graphics, opengl-es, cocos2d-iphone

我在 master 分支上，以便它可以与 ARC 一起使用。

我已经实现了一种方法，当用户触摸精灵时，精灵将缩放 1.1 倍。多次触摸将使多个缩放动作排队，建立在彼此之上。时不时地我得到一个奇怪的工件，其中较小版本的精灵出现在缩放版本的顶部。

这是一个屏幕截图：![在此处输入图像描述](../Images/f4096c3bc1cc228f440d620e2ee8bc07.png)

更多背景：我正在使用纹理图集，所以我使用：

```
 sprite = [super spriteWithSpriteFrameName:anObject.filename]; 
```

初始化精灵。这是 openGL/cocos2d 中的错误吗？有关如何停止此工件的任何建议？

编辑：我是 CCSprite 的子类，但据我所知，只有一个精灵实例（对 super 的调用是在类方法中）。基本上，用户将定义精灵将执行的操作列表。也可以使用以下方法中断操作列表：

```
[self stopAllActions] 
```

我已经使用 CCMoveBy 和 CCRotateBy 的子类进行了操作，没​​有任何问题。只有最新的 CCScaleBy 子类会导致此工件。在这些动作的子类中，我没有更改动作中的任何内容，只是跟踪某些变量，以便我可以在中断后正确恢复动作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T12:02:17.963

您是否可能是 CCSprite 的子类，并且在您的子类中您是否也添加了 CCSprite 实例变量？

在这种情况下，您将显示两个精灵。超类精灵和实例变量精灵。如果另一个精灵有时只出现，这可能取决于添加精灵作为子元素的顺序，或 zOrder 属性。

# oracle - 带有字符串的 Oracle Forms 6i SendMessage

> ID：12100605
> 
> 赞同：0
> 
> 时间：2012-08-23T21:59:32.180
> 
> 标签：oracle, delphi, plsql, sendmessage

我正在将我的帕斯卡代码转换为 PL/SQL 以用于 Oracle Forms 6i。下面我的帕斯卡代码，完美运行。

```
program WebcamTest;
//cswi
//www.delphibasics.info
const
  WM_CAP_DRIVER_CONNECT = 1034;
  WM_CAP_GRAB_FRAME = 1084;
  WM_CAP_SAVEDIB = 1049;
  WM_CAP_DRIVER_DISCONNECT = 1035;

function SendMessageA(hWnd: Integer;
                      Msg: Integer;
                      wParam: Integer;
                      lParam: Integer): Integer;
                      stdcall;
                      external 'user32.dll' name 'SendMessageA';

function capGetDriverDescriptionA(DrvIndex: Cardinal;
                                  Name: PAnsiChar;
                                  NameLen: Integer;
                                  Description: PAnsiChar;
                                  DescLen: Integer) : Boolean;
                                  stdcall;
                                  external 'avicap32.dll' name 'capGetDriverDescriptionA';

function capCreateCaptureWindowA(lpszWindowName: PAnsiChar;
                                 dwStyle: Integer;
                                 x : Integer;
                                 y : Integer;
                                 nWidth : Integer;
                                 nHeight : Integer;
                                 ParentWin: Integer;
                                 nId: Integer): Integer;
                                 stdcall;
                                 external 'avicap32.dll' name 'capCreateCaptureWindowA';

function IntToStr(i: Integer): String;
begin
  Str(i, Result);
end;

var
  WebCamId : Integer;
  CaptureWindow : Integer;
  x : Integer;
  FileName : PAnsiChar;
begin
  WebcamId := 0;
  CaptureWindow := capCreateCaptureWindowA('CaptureWindow', 0, 0, 0, 0, 0, 0, 0);
  if CaptureWindow <> 0 then
  begin
    if SendMessageA(CaptureWindow, WM_CAP_DRIVER_CONNECT, WebCamId, 0) = 1 then
    begin
      for x := 1 to 20 do // Take 20 photos.
      begin
        SendMessageA(CaptureWindow, WM_CAP_GRAB_FRAME, 0, 0);
        FileName := PAnsiChar('C:\Test' + IntToStr(x) + '.bmp');
        SendMessageA(CaptureWindow, WM_CAP_SAVEDIB, 0, LongInt(FileName));
      end;
    end;
    SendMessageA(CaptureWindow, WM_CAP_DRIVER_DISCONNECT, 0, 0);
  end;
end. 
```

我已经使用 ora_ffi 包成功翻译了所有的 api。

我无法将下面的行从 Pascal 转换为 PL/SQL（它将捕获的图片保存到由 FileName 标识的指定位置）。

```
SendMessageA(CaptureWindow, WM_CAP_SAVEDIB, 0, **LongInt**(FileName)); 
```

因为我不确定如何将 FileName 作为 SendMessageA 定义所需的 PLS_INTEGER 传递（请参阅粗体了解我如何使用 pascal 实现这一点）。使用 pascal，我可以将 FileName 转换为 LongInt（这是否返回指向 FileName 的指针？如果是这样，我想用 PL/SQL 模拟这种转换）。

注意：问题是关于如何将**Pascal**转换为**PL/SQL**。帕斯卡代码工作正常。

有任何想法吗？

# ajax - JQuery - 函数回调？($.Deferred)

> ID：12100606
> 
> 赞同：0
> 
> 时间：2012-08-23T21:59:33.720
> 
> 标签：ajax, jquery

我目前有一个看起来像这样的函数：

```
 $(function(){
 $('.chained_to_vehicle_make_selector').remoteChainedTo('.chained_parent_vehicle_make_selector', '/models.json');
 $('.chained_to_vehicle_model_selector').remoteChainedTo('.chained_parent_vehicle_model_selector', '/trims.json');
 $('.chained_to_vehicle_trim_selector').remoteChainedTo('.chained_parent_vehicle_trim_selector', '/model_years.json');
}); 
```

正如您可能知道的那样，每个 remoteChainedTo 函数都在进行 AJAX 调用，这工作正常，但需要一些时间。

然后我有第二个代码块：

```
 $(function() {
    $(".chzn-select").chosen();
    $(".chained_parent_vehicle_make_selector").chosen().change( function() {$(".chained_to_vehicle_make_selector").trigger("liszt:updated"); });
    $(".chained_parent_vehicle_model_selector").chosen().change( function() {$(".chained_to_vehicle_model_selector").trigger("liszt:updated"); });
    $(".chained_parent_vehicle_trim_selector").chosen().change( function() {$(".chained_to_vehicle_trim_selector").trigger("liszt:updated"); });
    $(".chained_child").chosen();
}); 
```

这部分代码只要在第一部分完成*后触发就可以正常工作。*然而，由于 AJAX 调用，它当前在上一节之前触发。

如何实现一个结构，以便在第一个代码块完全完成后总是触发第二个代码块？remoteChainedTo 函数没有定义的回调（我可以看到），并且在任何情况下都不可能知道三个调用中的哪一个将最后完成，因此希望以某种方式将回调放在块上，以便第二个代码部分仅在最后一次 AJAX 调用完成后触发。

编辑：经过更多重构，我的代码现在如下所示：

```
 function makeChains(){
 $('.chained_to_vehicle_make_selector').remoteChainedTo('.chained_parent_vehicle_make_selector', '/models.json');
 $('.chained_to_vehicle_model_selector').remoteChainedTo('.chained_parent_vehicle_model_selector', '/trims.json');
 $('.chained_to_vehicle_trim_selector').remoteChainedTo('.chained_parent_vehicle_trim_selector', '/model_years.json');
}

var chainCall = $(function() {
    makeChains();
});

chainCall.done(function() { 
        $(".chzn-select").chosen();
        $(".chained_parent_vehicle_make_selector").chosen().change( function() {$(".chained_to_vehicle_make_selector").trigger("liszt:updated"); });
        $(".chained_parent_vehicle_model_selector").chosen().change( function() {$(".chained_to_vehicle_model_selector").trigger("liszt:updated"); });
        $(".chained_parent_vehicle_trim_selector").chosen().change( function() {$(".chained_to_vehicle_trim_selector").trigger("liszt:updated"); });
        $(".chained_child").chosen();
    }); 
```

但我仍然收到错误消息`Object [object Object] has no method 'done'`。任何提示表示赞赏。

# extjs4 - extjs 4 个主题如何使用全局变量创建自定义组件

> ID：12100609
> 
> 赞同：4
> 
> 时间：2012-08-23T22:00:04.330
> 
> 标签：extjs4, themes, sass

我正在尝试为 ExtJS 4 创建一个自定义主题，比仅更改基色更复杂。因此，这可能更多是关于 SASS 的问题，而不是主题本身。

ExtJS 为它的所有组件声明了 mixin，但是对于其中的许多组件，mixin 没有参数。

```
@mixin extjs-menu {
  .#{$prefix}menu-body {
      @include no-select;
      background: $menu-background-color !important;
      padding: $menu-padding;
  }
  ...
} 
```

例如，这是菜单混合。如您所见，它们没有使用 mixin 参数；相反，他们使用影响所有菜单的全局变量。

因此，要修改此组件，我正在执行以下操作：

```
$menu-background-color: red;
@include ext-menu 
```

但是当您的应用程序中有多个菜单并且您希望每个菜单具有不同的外观时会发生什么。有任何想法吗？

我的想法是用我的更改创建一个 mixin 并调用 ext-menu mixin，但我不确定`$menu-background-color: red`在 mixin 内部声明是否会影响全局变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T13:52:37.343

在您的 .sass 文件中，执行以下操作：

```
.my-menu {
  @include extjs-menu;
} 
```

在您的 JS 代码中，只需分配`cls: 'my-menu'`给 Ext.menu.Menu。

# security - HMAC 消息格式

> ID：12100611
> 
> 赞同：0
> 
> 时间：2012-08-23T22:00:07.400
> 
> 标签：security, api, http, authentication, hmac

当使用 HMAC 对 API 调用进行身份验证时，要散列的消息通常包含很多似乎没有添加任何内容的内容。例如，以下是为 API 生成签名的步骤：

`hmacsha1(HTTP VERB + URI + JSON_REQUEST_CONTENT + DATETIME, "secret")`

为什么不只是这样：

`hmacsha1(JSON_REQUEST_CONTENT, "secret")`

这是假设 JSON_REQUEST_CONTENT 是一个包含所有相关请求信息的 JSON 字符串。

在我看来，添加 HTTP VERB 和 URI（或任何额外的非特定于内容的信息）只是增加了消息的长度，我不明白它的好处。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:06:28.913

HMAC 通常用于防止消息篡改，但它们也用于防止消息重放。

如果 HMAC 只包含有效负载和一个只能防止篡改的秘密，那么如果我再次发送相同的消息，它将是有效的。通过使用其他详细信息（尤其是日期时间或随机数）来装饰请求，以防止重播和篡改。

* * *

要将日期时间用作哈希的盐，您通常需要以明文形式发送带有消息的日期时间（尽管可以从负载外部的请求标头中接收或发送消息的时间粗略推断）。如果日期时间与服务器认为的时间相差太远，则消息将失败（例如，不到一分钟）。如果当服务器对数据进行相同的哈希处理并且没有得到相同的结果时，它也会使消息失败。

要使用 nonce，最实用的方法是让服务说，下次你向我发送请求时，使用这个 nonce。nonce 不需要与请求一起以明文形式发送。当服务器成功处理一条消息时，它会说，下次使用这个随机数，之前的随机数无效。

日期时间通过确保在特定时间发送消息来防止重播，随机数通过使用一次性密码来防止重播。

# jquery - 如何为 popup.html 中的多个不同链接打开和使用相同的选项卡

> ID：12100613
> 
> 赞同：1
> 
> 时间：2012-08-23T22:00:10.990
> 
> 标签：jquery, tabs, google-chrome-extension

我实际上正在开发我的第一个 Chrome 扩展程序，我需要改进一些功能。实际上我是 chrome 扩展的新手，不知道如何管理标签。

实际上，该扩展程序会打开一个弹出窗口，其中包含从远程网页捕获的链接列表。每个链接都会打开一个新选项卡，其中包含正确的内容。

我的目标是打开一个选项卡，并且对于每个链接，使用该单个选项卡（如果创建的选项卡已关闭，我可以打开一个新选项卡并继续使用它）。我想我可以创建一个新选项卡并通过分配的 ID 引用它，但我无法弄清楚如何真正编写正确的代码。

以下是涉及的代码：

## popup.html

```
<!doctype html>
<html>
<head>
    <title>NGI Little Helper - Subscribes</title>
    <link rel="stylesheet" href="popup.css">
    <!-- JavaScript and HTML must be in separate files for security. -->
    <script type="text/javascript" src="common/jquery.js"></script>
    <script type="text/javascript" src="popup.js"></script>
</head>

<body>
    <h1>Topics</h1>
    <div id="content">..:: Loading ::..</div>
</body>
</html> 
```

## popup.js

```
$.get("http://gaming.ngi.it/subscription.php?do=viewsubscription", function(data) {
    var TDs = $('td[id^="td_threadtitle_"]', data);
    $(document).ready(function() {
        $("#content").html("<br/>");
        $.each( TDs, function() {
            //Removes useless elements from the source
            $('img[src="images/misc/tag.png"]', this).remove();
            $('span', this).remove(); //$('span[class="smallfont"]', this).remove();
            $('div[class="smallfont"]', this).remove();
            $('img[src="images/buttons/firstnew.gif"]', this).attr('src', '/img/icons/comment.gif');
            $('a[style="font-weight:bold"]', this).removeAttr("style");
            //Modify the lenght of the strings
            if ($("a[id^='thread_title_']", this).text().length > 35) {
                $("a[id^='thread_title_']", this).text( $("a[id^='thread_title_']", this).text().substring(0, 30) + " [...]" );
            }
            //Modify the URL from relative to absolute and add the target="_newtab"
            $("a[id^='thread_']", this).attr('href', "http://gaming.ngi.it/"+ $("a[id^='thread_']", this).attr('href'));
            $("a[id^='thread_']", this).attr('target', "_newtab");
            //Send the HTML modified to the popup window
            $("#content").html($("#content").html() + $('div', this).wrap("<span></span>").parent().html() +"<br/>" );
        });
    });
}); 
```

## 清单.json

```
{
    "name": "NGI Little Helper",
    "version": "0.8.5",
    "manifest_version": 2,
    "description": "Extension per gli Utenti del forum gaming.ngi.it",
    "options_page": "fancy-settings/source/index.html",
    "background": {
        "page": "background.html"
    },
    "icons": {
        "16": "img/logo16.png",
        "48": "img/logo48.png",
        "128": "img/logo128.png"
    },
    "content_scripts": [{
        "matches": ["*://gaming.ngi.it/*"],
        "js": ["common/jquery.js", "logo_changer/logo_change.js"],
        "run_at": "document_start"
    }],
    "browser_action": {
        "default_icon": "img/icon.png",
        "default_popup": "popup.html",
        "default_title": "Visualizza Subscriptions"
    },
    "permissions": [
        "*://gaming.ngi.it/*"
    ]
} 
```

以下是一段 HTML 代码，将在所有操作后呈现到弹出窗口中。任何 div 都与此类似，除了链接当然会更改：

```
<div>

            <a href="http://gaming.ngi.it/showthread.php?goto=newpost&amp;t=555954" id="thread_gotonew_555954" target="_newtab"><img class="inlineimg" src="/img/icons/comment.gif" alt="Go to first new post" border="0"></a>

            <a href="http://gaming.ngi.it/showthread.php?goto=newpost&amp;t=555954" id="thread_title_555954" target="_newtab">[All Gamez] [Frozen Synapse] S [...]</a>

        </div> 
```

如果需要，我可以提供完整的源代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T05:49:12.713

回收现有选项卡的最简单方法是使用该[`chrome.tabs.query()`](http://developer.chrome.com/extensions/tabs.html#method-query)方法。检查是否有一个带有与模式匹配的 URL 的选项卡（例如`http://gaming.ngi.it/*`）。如果存在，请打开其中的 URL。如果没有，请打开一个新选项卡。像这样：

```
var match = 'http://gaming.ngi.it/*';
var url = 'http://gaming.ngi.it/showthread.php?goto=newpost&amp;t=555954';

chrome.tabs.query({url : match}, function (foundTabs) {
    if (foundTabs[0]) {
        chrome.tabs.update(foundTabs[0].id, {
            active : true,
            url : url
        });
    } else {
        chrome.tabs.create({url : url});
    }
}); 
```

[`reuseTab()`我为 Chrome](https://github.com/fczbkk/chrome-extension-snippets/blob/master/js/reuse-tab.js)编写了一个简单的可重用函数，它托管在 GitHub 中，并包含详细的注释以及对一切工作原理的解释。随意检查并使用它。

# ruby-on-rails - Group By attribute.model 可能吗？

> ID：12100616
> 
> 赞同：0
> 
> 时间：2012-08-23T22:00:17.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

我目前有这样的工作：

```
period_registration = PeriodRegistration.count(:conditions => ["created_at >= ?", 30.days.ago.to_date], group: "date(created_at)") 
```

但是，我想做这样的事情：

```
 period_registration_product = PeriodRegistration.count(:conditions => ["created_at >= ?", 30.days.ago.to_date], group: "period_id.product") 
```

当我这样做时，我在 period_registration_product 中一无所获。当我的 Period_Registration 模型中有 product_id 时，按产品排序的最佳方法是什么？

更新：

`@period_registration_product = PeriodRegistration.joins(:period).where("date(created_at) >= ?", 30.days.ago.to_date).group("periods.product_id").count`

结果是：

`SQLite3::SQLException: ambiguous column name: created_at: SELECT COUNT(*) AS count_all, periods.product_id AS periods_product_id FROM "period_registrations" INNER JOIN "periods" ON "periods"."id" = "period_registrations"."period_id" WHERE (date(created_at) >= '2012-07-25') GROUP BY periods.product_id`

我是否需要指定要查看的 created_at`period`还是`period_registration`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T04:13:20.350

试试这个查询

```
PeriodRegistration.joins(:period).where("period_registrations.created_at >= ?", 30.days.ago.to_date).group("periods.product_id").count 
```

这将返回每个 product_id 中有多少对象的哈希

# jquery - Modernizr - 触摸 || 悬停图片链接

> ID：12100618
> 
> 赞同：0
> 
> 时间：2012-08-23T22:00:19.897
> 
> 标签：jquery, touch, modernizr

我正在尝试使用此功能解决移动和桌面问题。有没有办法让这个脚本用于悬停并`or`为 Modernizr 添加一个运算符以查看它是否检测到触摸功能，如果没有，使用悬停？希望有人可以帮助我澄清这一点。

```
$(function() {
        $('ul.recent-widget li').hover(function(){
            $(this).find('img').animate({top:'182px'},{duration:500});
        }, function(){
            $(this).find('img').animate({top:'0px'},{duration:500});
        });
    }); 
```

这是一个在桌面上工作的例子[http://jsfiddle.net/chris_s/dcq2F](http://jsfiddle.net/chris_s/dcq2F)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T09:54:09.210

使用 Modernizr，您当然可以设置一个条件，正如您在上面的评论中推断的那样，它只会运行一个或另一个函数：

```
if ( Modernizr.touch ) {
   // click or bind to touchstart, touchmove, etc
} else {
   // hover (like your animation example)
} 
```

关于性能，您还可以考虑使用默认的 css 过渡或动画，然后`!Modernizr.csstransitions`在该悬停功能上使用 。

当然，由于移动设备是如此移动的目标，因此任何一种解决方案[都有](http://blog.grayghostvisuals.com/modernizr/conditionally-loading-resources/) [一些](http://daneden.me/2011/12/putting-up-with-androids-bullshit/) [警告](http://css-tricks.com/browser-detection-is-bad/)。也许对几个标准（屏幕尺寸、特征检测、polyfills 等）进行组合测试，然后选择最适合您的情况。

# java - 在 SQL 中使用关键字对搜索结果进行排名

> ID：12100622
> 
> 赞同：0
> 
> 时间：2012-08-23T22:00:29.663
> 
> 标签：java, sql, database-design, full-text-search, search-engine

我在开始这个想法时遇到了麻烦。我有一个 SQL 数据库和一个带有 JAVA/Apache(tomcat) 的 html 接口。我试图创建一个简单的数据库，对歌曲名称进行排序并匹配关于歌曲的关键字。示例我输入了诸如“史诗，电影，女王，唱歌”之类的关键字，而像波西米亚女王狂想曲这样的歌曲符合大多数标准，它是“电影”中的“史诗”歌曲并由“女王”执行，因此这将制作值为 3。并且在数据库中，我们是冠军之类的歌曲将满足所有关键字（史诗、电影、女王、歌唱）-> 所以这首歌将是 4。

我已经涉足了 sql 和一些 JAVA 代码中的计数函数，但我无法找到一种方法来转换关键字，或者计算它们以查看哪个结果更好。

我应该在哪里学习如何制作这样的东西？

* * *

非常感谢您的解释和链接。经过数小时的阅读和重新阅读，我对数据库结构有了更多的了解。并有一个近乎功能的网页。我有最后一个问题。查询给了我 song_ID 和计数的结果。我想了一些方法来让歌曲名称也显示出来。

我的第一个想法是将名称添加到连接表中。

第二是创建一个临时表（视图），然后使用该信息从其他表中查找数据。

第三是编写一个java代码来获取原始结果，然后只显示歌曲名称和数量。……

我认为我缺少一些简单的 SQL 能力来更好地（并且更有效地）处理数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:10:04.380

假设您的数据库有两列：tag 和 song_id，如下所示：

```
CREATE TABLE tags(tag STRING KEY, song_id INT); 
```

然后您可以在 SQL 查询中执行所有操作：

```
SELECT song_id, count(*)
FROM tags
WHERE tag IN ("epic", "movie", "queen", "sing")
GROUP BY song_id
ORDER BY count(*) DESC; 
```

如果您想要更复杂的文本搜索，即如果这个解决方案最终太慢，您应该查看 Apache [Lucene](http://lucene.apache.org/core/)和/或[Solr](http://lucene.apache.org/solr/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T23:46:10.767

三张表：

*   `song_id`主键为整数的歌曲
*   `tag`主键为字符串的标签
*   song-tags 是一个[连接](http://en.wikipedia.org/wiki/Junction_table)其他两个表的连接表。它将有一个复合主键`song_id`和`tag`

因此，如果在歌曲中我们有这些行（[元组](http://en.wikipedia.org/wiki/Tuple#Relational_model)）：

*   歌曲ID：1；名称：波西米亚狂想曲
*   歌曲ID：2；名称：我们是冠军

在标签中我们有：

*   标签：史诗
*   标签：电影
*   标签： 女王
*   标签： 唱

然后在歌曲标签中，我们将拥有：

*   歌曲ID：1；标签：史诗
*   歌曲ID：1；标签：电影
*   歌曲ID：1；标签： 女王
*   歌曲ID：2；标签：史诗
*   歌曲ID：2；标签：电影
*   歌曲ID：2；标签： 女王
*   歌曲ID：2；标签： 唱

现在要找到与特定标签匹配的歌曲只是从歌曲标签表中选择相关行的问题。

原始设计的问题是您将多个标签存储在一行中。相反，对于与给定歌曲匹配的每个标签，您应该有一个单独的行。如果三个标签匹配，那么您将需要三行，依此类推。

您可能想阅读一些有关[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization)的内容，以了解为什么您的原始设计无法有效工作

（注意在 Joe K 之前的回答中，他基本上提出了同样的建议，并给了你一个 SQL 查询来确定哪些标签与哪些歌曲匹配。我刚刚充实了一些东西）

# .net - 更改 log4net 配置以每 x 小时创建一次新日志

> ID：12100624
> 
> 赞同：5
> 
> 时间：2012-08-23T22:00:34.077
> 
> 标签：.net, logging, log4net

如果我想每 x 小时记录一次日志，我仍然不知道如何更改 log4net。我有这个：

```
 <log4net>
        <root>
          <level value="DEBUG"/>
          <appender-ref ref="LogFileAppender"/>
        </root>
        <appender name="LogFileAppender" type="log4net.Appender.RollingFileAppender">
          <param name="File" value="C:\log.txt"/>
          <param name="AppendToFile" value="true"/>
          <rollingStyle value="Size"/>
          <maxSizeRollBackups value="10"/>
          <maximumFileSize value="100MB"/>
          <staticLogFileName value="true"/>
          <layout type="log4net.Layout.PatternLayout">
            <param name="ConversionPattern" value="%-5p%d{yyyy-MM-dd hh:mm:ss} – %m%n"/>
          </layout>
        </appender>
  </log4net> 
```

我有一个日志，我总是在这个 log.txt 中添加日志 - 现在我想让我们说每天一个新的日志文件（24 小时）或者每 12 小时一个新日志。我必须在我的配置中更改什么？对我的配置有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T22:05:14.800

**回复：http : [//logging.apache.org/log4net/release/config-examples.html](http://logging.apache.org/log4net/release/config-examples.html)**

此示例显示如何配置 RollingFileAppender 以在日期期间滚动日志文件。此示例将每分钟滚动一次日志文件！要更改滚动周期，请调整 DatePattern 值。例如，“yyyyMMdd”的日期模式将每天滚动。有关`System.Globalization.DateTimeFormatInfo`可用模式的列表，请参阅。

```
<appender name="RollingLogFileAppender" type="log4net.Appender.RollingFileAppender">
<file value="logfile" />
<appendToFile value="true" />
<rollingStyle value="Date" />
<datePattern value="yyyyMMdd-HHmm" />
<layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
</layout> 
```

在您的特定情况下，上面的示例`<datePattern value="yyyyMMdd-HH" />`仅允许您每小时记录一次。

但是，如果您想`X`每小时记录一次，您可以创建一个自定义附加程序，该附加程序派生自`RollingFileAppender`并覆盖该`AdjustFileBeforeAppend`方法，该方法将根据您的下一个计划的日志间隔日期检查当前时间。例如，请参阅[将 Log4Net RollingFileAppender 设置为每周滚动](https://stackoverflow.com/questions/3719546/have-a-log4net-rollingfileappender-set-to-roll-weekly)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:03:04.250

如下替换滚动样式：

```
<rollingStyle value="Date" /> 
```

您可能还想删除文件大小限制。

# scala - 对选项结果应用或操作

> ID：12100630
> 
> 赞同：0
> 
> 时间：2012-08-23T22:01:52.433
> 
> 标签：scala, scala-option

我有以下代码：

```
class CSplit(var s1: CanvNode, var s2: CanvNode) extends SplitPane
{         
   topComponent =  s1.merge
   bottomComponent = s2.merge
   def containsV(orig: MapCanvT): Option[MapCanvT]  = 
   {
      def containsIn(cn: CanvNode): Option[MapCanvT] = cn match
      {  
        case Left => None 
        case Right(mc) => if (mc == orig) Some(mc) else None                 
      }
      containsIn(s1) match
      {
        case Some(mc) => Some(mc)
        case None => containsIn(s2)
      }
    }
 } 
```

我想减少 containsV 方法的代码。我的第一个想法是使用 fold 方法来缩短 containsIn 方法。但是 Option 没有，也没有扩展 Class Either。Option[T] 不应该扩展 Either[T, None] 吗？然后至少可以使用 Either 的 fold 方法。

我最后的想法是将 s1 和 s2 视为一个 List 并找到它，但我无法编译：

```
def containsV(orig: MapCanvT):
  Option[MapCanvT] = ::[CanvNode](s1, s2).find(_ == Right(orig)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T22:08:48.187

Scala 2.10 添加`fold`到`Option`. 与此同时，您可以`map(f).getOrElse(g)`改用：

```
// These produce identical results
o.fold(g)(x => f(x))
o.map(x => f(x)).getOrElse(g) 
```

编辑：所以，例如，以下三个做同样的事情：

```
val os: List[Option[Int]] = List(Some(5),None)

// Explicit match
os.map{ _ match {
  case Some(x) => x+3
  case None => 0
}}

// map+getOrElse
os.map{ _.map(_+3).getOrElse(0) }

// fold
os.map{ _.fold(0)(_+3) } 
```

在这种`fold`情况下，您首先给案例的默认值`None`，然后是处理有值的情况的函数。在每种情况下，您都应该得到`List(8,0)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-26T08:14:02.290

它可以通过使用 collectFirst 方法的列表来实现

```
def containsV(orig: MapCanvT): Option[MapCanvT]
  = List(s1, s2).collectFirst {case i: MapCanvT if (i == (orig) => i} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T22:27:08.043

让我们从简单的部分开始：

```
 containsIn(s1) match
  {
    case Some(mc) => Some(mc)
    case None => containsIn(s2)
  } 
```

是相同的

```
 containsIn(s1) orElse containsIn(s2) 
```

现在我们只需要处理`containsIn`：

```
 def containsIn(cn: CanvNode): Option[MapCanvT] = cn match
  {  
    case Left => None 
    case Right(mc) => if (mc == orig) Some(mc) else None                 
  } 
```

我们可以使用`fold`on `Either`，它摆脱了大部分模式匹配：

```
 cn.fold(_ => None, Some(_)) 
```

但事情就是这样`orig`。不过，我们可以使用过滤器来处理它：

```
 cn.fold(_ => None, Some(_)) filter (orig.==) 
```

因此：

```
def containsV(orig: MapCanvT): Option[MapCanvT]  = {
  def containsIn(cn: CanvNode): Option[MapCanvT] =
    cn.fold(_ => None, Some(_)) filter (orig.==)
  containsIn(s1) orElse containsIn(s2)
} 
```

我认为`orElse`被忽视了很多。

# java - IP地址范围的间隔分区

> ID：12100631
> 
> 赞同：2
> 
> 时间：2012-08-23T22:01:59.103
> 
> 标签：java, algorithm

我正在处理划分特定 IP 地址范围的问题（在 Java 中）。假设我有：

```
startIP    endIP
1.2.3.4    1.2.5.6 
```

我需要将此范围切割成每个 [0, 255] 间隔，所以我们有：

```
startIP    endIP
1.2.3.4    1.2.3.255
1.2.4.0    1.2.4.255
1.2.5.0    1.2.5.6 
```

我在看这个问题或多或少像划分一个十进制范围`from 7 to 26`，我们有`[7, 9], [10, 19], [20, 26]`. 唯一的区别是我们处理的是`256-simal`数字。有什么想法吗，伙计们？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:22:06.830

您可以使用`InetAddress`它，并运行一个简单的循环来执行增量：

```
InetAddress from = InetAddress.getByName("1.2.3.4");
InetAddress to = InetAddress.getByName("1.2.5.6");
byte[] partsTo = to.getAddress();
for (;;) {
    System.out.print(from+" - ");
    byte[] parts = from.getAddress();
    boolean sameUpperPart = true;
    for (int i = 0 ; sameUpperPart && i < parts.length-1 ; i++) {
        sameUpperPart &= (partsTo[i] == parts[i]);
    }
    if (sameUpperPart) {
         System.out.println(to);
         break;
    }
    int last = parts.length-1;
    parts[last] = (byte)0xFF;
    System.out.println(InetAddress.getByAddress(parts));
    parts[last] = 0x00;
    for (int i = last-1 ; i >= 0 ; i--) {
        if (++parts[i] != 0) {
            break;
        }
    }
    from = InetAddress.getByAddress(parts);
} 
```

此代码[在 ideone 上产生以下输出](http://ideone.com/kxNmh)：

```
/1.2.3.4 - /1.2.3.255
/1.2.4.0 - /1.2.4.255
/1.2.5.0 - /1.2.5.6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:16:23.940

我不知道 Java 的具体解决方案，但 C 中有一个算法。它将 IP 范围划分为最大可能的子网并打印它们。生成的范围将在子网边界上对齐。

```
#define NETWORK_ZEROS(ip, prefix) ((ip) & (0xffffffff << (32 - (prefix))))
#define NETWORK_ONES(ip, prefix) ((ip) | (~ (0xffffffff << (32 - (prefix)))))

void print_ip(unsigned long ip)
{
    unsigned char bytes[4];
    bytes[0] = ip & 0xFF;
    bytes[1] = (ip >> 8) & 0xFF;
    bytes[2] = (ip >> 16) & 0xFF;
    bytes[3] = (ip >> 24) & 0xFF;       
    printf("%d.%d.%d.%d", bytes[3], bytes[2], bytes[1], bytes[0]);        
}

void partition_ip(unsigned long start, unsigned long stop)
{   
    int i;

    while (start < stop)
    {
        // Change the start of the loop to 24 if you 
        // need to align on /24 boundaries
        for (i=0; i <= 32; i++)
        {
            if (NETWORK_ZEROS(start, i) == start && 
                    NETWORK_ONES(start, i) <= stop)
            {
                print_ip(NETWORK_ZEROS(start, i));
                printf(" - ");
                print_ip(NETWORK_ONES(start, i));
                printf("\n");

                start = NETWORK_ONES(start, i) + 1;
                break;
            }
        }

    }
} 
```

要将 IP 转换为二进制数，只需执行以下操作

```
a.b.c.d => ((((a*256)+b)*256)+c)*256+d 
```

或者

```
ip = (a << 24) | (b << 16) | (c << 8) | d 
```

如果您希望通过使用位移来提高效率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T22:34:54.263

一些示例代码（假设初始转换为 int[] 是在外部完成的）并且并没有真正返回有用的数据（只是打印）。但是这个想法是存在的。

```
public class Convertor {
    public static void convert(int []a, int []b) {
        int left = (a[0] << 24) | (a[1] << 16) | (a[2] << 8) | a[3];
        int right = left | 0xff;
        int end = (b[0] << 24) | (b[1] << 16) | (b[2] << 8) | b[3];
        while ( right < end ) {
            System.out.printf("%s -> %s\n", toIp(left), toIp(right));
            left = right + 1; right += 256;
        }
        System.out.printf("%s -> %s\n", toIp(left), toIp(end));
    }

    private static String toIp(int value) {
        return String.format("%d.%d.%d.%d",
                             value >> 24 & 0xFF,
                             value >> 16 & 0xFF,
                             value >> 8 & 0xFF,
                             value & 0xFF);
    }
} 
```

呼叫站点：

```
Convertor.convert(new int[]{1, 2, 3, 4}, new int[]{1, 2, 5, 6}); 
```

输出：

```
1.2.3.4 -> 1.2.3.255
1.2.4.0 -> 1.2.4.255
1.2.5.0 -> 1.2.5.6 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T22:19:32.080

首先将IP地址转换为一个整数，然后通过重复添加256进行分区，然后再转换回IP地址。

```
public class IPPartition {
    public static void main(String[] args) {
        String startIP = "1.2.3.4";
        String endIP = "1.2.5.6";
        long start = toLong(startIP);
        long end = toLong(endIP);
        long last = start;
        long part = (start / 256 + 1) * 256;
        for (; part < end; last = part, part += 256) {
            System.out.println(toIP(last) + " " + toIP(part));
        }
        System.out.println(toIP(last) + " " + toIP(end));
    }

    private static long toLong(String ip) {
        String[] tokens = ip.split("\\.");
        long sum = 0;
        for (int i = 0; i < 4; i++) {
            sum *= 256;
            sum += Integer.parseInt(tokens[i]);
        }
        return sum;
    }

    private static String toIP(long num) {
        String result = "";
        for (int i = 0; i < 4; i++) {
            long section = num % 256;
            result = section + result;
            if (i < 3) result = "." + result;
            num /= 256;
        }
        return result;
    }
} 
```

为了安全起见，我在这里使用了 long，但您也许可以使用整数，我还没有尝试过。也可能有一些错误或其他东西，我没有彻底测试过。

# javascript - 关于验证和语义标签的一些基本 HTML5 问题

> ID：12100633
> 
> 赞同：3
> 
> 时间：2012-08-23T22:02:07.930
> 
> 标签：javascript, html

# 1

`<div id="header"></div>`

可以替换为

`<header></header>`

在 HTML5 中。但是除了更好的可读性之外，还有其他理由使用它吗？

# 2

```
<input type="text"   
   name="username"   
   id="username"  
   placeholder="4 <> 10"  
   pattern="[A-Za-z]{4,10}"  
   autofocus  
   required> 
```

当放置在表单中时，这将导致一些验证。有什么方法可以检查生成的 javascript 类型吗？你能修改它吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T05:44:50.463

1）是的，它在语义上更正确。搜索引擎已经根据其语义解释 HTML5 标签。因此，改善 SEO。

2）类似的东西。您可以使用[`setCustomValidity`](http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#dom-cva-setcustomvalidity)更改消息：

```
 function check(input) {
   if (input.value == "good") {
     input.setCustomValidity('"' + input.value + '" is not a feeling.');
   } else {
     input.setCustomValidity('');
   }
 } 
```

# sublimetext2 - 根据文件名更改默认语法

> ID：12100634
> 
> 赞同：50
> 
> 时间：2012-08-23T22:02:07.737
> 
> 标签：sublimetext2

在 Sublime Text 2 中，我看到了基于扩展的语法的方法。但是没有扩展名的文件名呢？例如，我经常有一个名为“Vagrantfile”的文件，它是 ruby​​ 格式的，但 Sublime Text 2 总是希望以纯文本开始。如果文件名为“Vagrantfile”，有没有办法让它默认为“ruby”？

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-09-02T22:29:31.077

With Sublime Text 2.0.1, build 2217, look in the lower right of the window, where it says "Plain Text" for the Vagrantfile that is open.

![enter image description here](../Images/ef2773a91d28398f08fe9ced6b301a9f.png)

Click that and in the menu that opens, at the top, there will be an "Open all with current extension as ..." sub-menu. Go into that sub-menu and choose Ruby.

Even though the Vagrantfile has no extension, Sublime will remember this and open Vagrantfiles with the Ruby syntax as expected. This does not spread to all files with no extension.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-04-02T11:14:04.523

将以下行添加到**语法特定 - 用户**文件中

*首选项 > 设置 - 更多 > 特定语法 - 用户*

永久保留每个 Vagrantfile 文件的语法。

* * *

```
{
    "extensions":
    [
        "Vagrantfile"
    ]
} 
```

# postgresql - 在 PostgreSQL 上创建非重音扩展时出错

> ID：12100638
> 
> 赞同：36
> 
> 时间：2012-08-23T22:02:45.017
> 
> 标签：postgresql, full-text-search, postgresql-9.1, rails-postgresql, unaccent

我正在尝试将 PostgreSQL 配置为在我的 rails 应用程序中使用全文搜索，如该[Railscast](http://railscasts.com/episodes/343-full-text-search-in-postgresql)中所述。

我正在使用使用with安装的全新`Ubuntu 12.04`服务器。`PostgreSQL 9.1.5``apt-get``ppa:pitti/postgresql``precise`

尝试运行迁移时以及在 psql 控制台中与对等 postgres 用户尝试相同的命令时，我收到以下错误：

```
postgres=# CREATE EXTENSION unaccent; 
```

> 错误：无法打开扩展控制文件“/usr/share/postgresql/9.1/extension/unaccent.control”：
> 没有这样的文件或目录

在我运行的本地机器中，`Ubuntu 10.04 desktop`我使用相同的存储库 ( `natty`)，它运行良好。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-08-23T22:46:21.483

您需要先**`postgresql-contrib-9.1`**在系统中安装该软件包。（适应您的版本号！这是[当前可用的软件包列表。](https://packages.debian.org/search?keywords=postgresql-contrib)）无论如何，在**Debian**，**Ubuntu**和朋友下都是这种情况。使用具有必要权限的系统用户：

```
apt-get install postgresql-contrib-9.1 
```

如果您当前登录的用户没有必要的权限（但`sudo`权限）：

```
sudo apt-get install postgresql-contrib-9.1 
```

引用[PostgreSQL Apt 存储库](https://www.postgresql.org/download/linux/debian/)：

> 如果您的 Debian 版本中包含的版本不是您想要的版本，您可以使用 PostgreSQL Apt Repository。

Postgres 网站上有每个可用操作系统的[基本安装说明。](https://www.postgresql.org/download/)

对于重音不敏感索引，请`unaccent`考虑以下相关问题：

*   [PostgreSQL 是否支持“不区分重音”排序规则？](https://stackoverflow.com/questions/11005036/does-postgresql-support-accent-insensitive-collations)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-14T21:26:45.493

在 CentOS 上：

```
sudo yum install postgres*contrib 
```

# html - 嵌入在静态 html 页面中的 HTTP POST 调用

> ID：12100640
> 
> 赞同：0
> 
> 时间：2012-08-23T22:02:55.110
> 
> 标签：html

我想嵌入一个 HTTP 调用，它将一个 png 图像返回到一个 html 页面。

如果有什么不同，我将在 github 的 gh-pages 上运行该页面。

网址是：[http ://public.opencpu.org/R/user/SChamberlain/ropensci_dash/apistatus10/png](http://public.opencpu.org/R/user/SChamberlain/ropensci_dash/apistatus10/png)

请注意，有时 url 不会返回 png，因为服务有时会关闭。

我想使用 POST 方法调用该 url，然后简单地将 png 返回到页面中。理想情况下，http 调用也将在页面回收时运行。

我使用 iframe、表单、javascript 吗？

谢谢！斯科特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:58:57.280

*【我还不如好好回答】*

当服务器向您提供图像数据并且您想要加载它时，您不妨将其视为图像并使用`img`标签。在您的特定情况下，这种方法的问题是您说服务器有时可能会关闭，这意味着如果您只是附加图像而不首先检查损坏的链接，您将获得丑陋的损坏图像空间。

但是，使用图像的简单性仍然是可行的。通过使用带有加载事件处理程序的小 javascript，*当且仅当*它成功加载时，您可以附加图像。如果您从请求中获得任何类型的错误代码，则加载事件将永远不会触发，并且您不会附加损坏的图像。

这是 vanilla-js 中的概念：

```
img = document.createElement("img");
img.onload = function(e){document.getElementsByTagName("body")[0].appendChild(img);};
img.src = "http://public.opencpu.org/R/user/SChamberlain/ropensci_dash/apistatus10/png"; 
```

你也可以在这里看到它的实际效果：http: [//jsfiddle.net/BwJeC/](http://jsfiddle.net/BwJeC/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:17:58.727

我真的不明白你为什么要发帖。

无论如何，如果您想使用 POST 数据查询图片，可能需要执行 Js XHR 调用并将图像作为 base64 返回，然后执行以下操作：

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
9TXL0Y4OHwAAAABJRU5ErkJggg==" /> 
```

最好的方法仍然是一个简单的 get 调用：

```
<img src="/dynamicallyGeneratedPicture" /> 
```

使用返回图像类型文档的路由或脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:19:00.160

您可以使用 XHR 从外部动态页面加载二进制数据并设置图像的内容。

[这个问题，非常相似](https://stackoverflow.com/questions/1095102/how-do-i-load-binary-image-data-using-javascript-and-xmlhttprequest) [或者这个](https://stackoverflow.com/questions/3721764/handling-images-from-xmlhttprequest-with-html-and-javascript)

# android - Android ActionBar 重新创建选项菜单

> ID：12100641
> 
> 赞同：10
> 
> 时间：2012-08-23T22:03:01.910
> 
> 标签：android, android-actionbar, options-menu

在Android中使用ActionBar时，如何刷新选项菜单？我尝试隐藏和显示该栏，以及使用“getSupportActionBar()”获取它的新实例

我正在尝试实现一个登录/注销按钮，该按钮将根据用户的状态动态变化。

这是我的 onCreateOptionsMenu 方法

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    if (loggedIn)
        menu.add(0, MENU2, 0, "Logout").setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
    else
        menu.add(0, MENU2, 0, "Login").setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
    menu.add(0, MENU1, 0, "Home").setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
    return super.onCreateOptionsMenu(menu);
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-23T22:06:52.913

[使用invalidateOptionsMenu()](http://developer.android.com/reference/android/app/Activity.html#invalidateOptionsMenu%28%29)使菜单无效，然后将代码放入[onPrepareOptionsMenu](http://developer.android.com/reference/android/app/Activity.html#onPrepareOptionsMenu%28android.view.Menu%29)区域。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-23T22:08:09.877

在您的 FragmentActivity 调用中`invalidateOptionsMenu()`

这也是一个公共方法，所以如果你想从片段调用中刷新它`getActivity().invalidateOptionsMenu()`

顺便说一句，如果您使用的是 SherlockActionBar，则需要`getSherlockActivity().invalidateOptionsMenu()` 从片段中调用，否则会出现异常。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-02-12T19:31:39.770

```
invalidateOptionsMenu() 
```

需要 API 级别 11...

对于较低的 API 使用：

```
supportInvalidateOptionsMenu() 
```

# c# - C# Picturebox 移动时留下白色痕迹

> ID：12100644
> 
> 赞同：1
> 
> 时间：2012-08-23T22:03:18.057
> 
> 标签：c#, winforms

我正在使用计时器`PictureBox`在表单内移动。图片框在其后面留下一条白色的痕迹，当图片框停止时消失。有什么办法可以摆脱白色的痕迹吗？我已经尝试过`this.Invalidate();`删除痕迹但导致整个表格闪烁直到图片框停止。

如果有人能帮我解决这个问题，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:06:37.210

在 WinForms 中制作动画通常比在 WPF 中困难得多，因为 WinForms 并非旨在支持动画。

查看为 WinForms 提供一些动画功能的开源库 Dot Net Transitions

> 过渡库允许您为 .NET 的用户界面元素的任何属性创建动画过渡。它提供了一种在 .NET 中执行 UI 动画的简单方法，类似于 Apple 和 iPhone 的 Core Animation 库。

[http://code.google.com/p/dot-net-transitions/](http://code.google.com/p/dot-net-transitions/)

# objective-c - 可以将“粘性”标题添加到分组表视图中吗？

> ID：12100653
> 
> 赞同：1
> 
> 时间：2012-08-23T22:04:38.063
> 
> 标签：objective-c, ios, uitableview

是否有一种自然的方法可以为与用户一起滚动的分组表视图部分添加标题？与节标题在普通表格视图中滚动的方式相同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:10:40.213

您可能想看看这篇文章：[滚动行时无法冻结表格标题？](https://stackoverflow.com/questions/7426849/can-not-freez-the-table-header-while-scrolling-the-rows/7427117#7427117)

就个人而言，我认为处理这个问题的最好方法是使用普通的表格视图并将`UITableViewCells`标题和标题自定义为你想要的。

# syntax - 如何从 vbscript 中取消导入文件？

> ID：12100655
> 
> 赞同：0
> 
> 时间：2012-08-23T22:04:55.513
> 
> 标签：syntax, vbscript

如何从 vbscript 中取消导入文件？因为我导入的文件有很多全局变量，和我要导入的另一个文件不谋而合。

我只想一次导入 1 个文件，以防止全局变量重叠。我该如何做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T09:49:35.380

当前脚本上下文可用的所有数据必须是唯一的。如果您在主上下文、例程或函数中使用“ **ExecuteGlobal** *语句”，那么所有数据都是全局可用的。*使用“**执行** *语句*”使数据在当前上下文中可用。

[http://msdn.microsoft.com/en-us/library/342311f1(VS.85).aspx](http://msdn.microsoft.com/en-us/library/342311f1(VS.85).aspx)

# c# - 有什么方法可以为传出连接选择 IP 地址？

> ID：12100657
> 
> 赞同：1
> 
> 时间：2012-08-23T22:05:08.557
> 
> 标签：c#, asp.net, .net-4.0, asp.net-4.0

我正在创建一个 Web 应用程序，我需要为传出连接选择 IP 地址（或者它会自动选择一个随机更改的 IP 地址 - GoDaddy 共享主机（但我也有一个专用 IP，该主机用于传入连接，我应该能够显然也用于传出连接））。如何枚举网络适配器并选择与 WebRequests、TcpClients 等一起使用的适配器？

谢谢，坎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:10:54.033

即使你的套接字不去听（），你仍然可以使用绑定来分配本地地址。

[例如对于 TcpClient 可以使用构造函数指定](http://msdn.microsoft.com/en-us/library/3bsb3c8f.aspx)

如果确实需要绑定，只需在参数中指定本地地址即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T15:29:17.310

我已经就这个问题联系了 GoDaddy。事实证明，在共享托管环境中（即使使用专用 IP）是不可能的。

# c++ - C++ const 在静态数组声明中使用了两次

> ID：12100659
> 
> 赞同：7
> 
> 时间：2012-08-23T22:05:17.337
> 
> 标签：c++, arrays, static, constants

`const`我之前在数组的声明中见过两次`static`，现在我正在创建自己的静态数组，我想知道为什么在某些情况下需要两次 const。

有一个指针数组会有所不同吗？

```
a. static const TYPE name[5];
b. static const TYPE const name[5];

c. static const TYPE* name[5];
d. static const TYPE* const name[5]; 
```

我的理解是`b.`无效的，但是如果两次使用 const 是有效的，它的目的是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-23T22:07:17.450

```
const TYPE* x; 
```

表示 x 指向的东西是 const。

```
TYPE* const x; 
```

表示指针 x 是 const。

结合你得到的2：

```
const TYPE* const x; 
```

这意味着指针和指向的东西都是常量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:25:05.180

您可以将任何 cv 限定符（`const`或`volatile`）应用于任何类型，包括 cv 限定类型——但不能在同一个声明中。但是，就优先级而言，它们比任何运算符绑定得更牢固，并且可以应用于限定类型的两侧：

```
// Let T by any type:
T const tr;
const T tl;
const T const tlr; // only in C
const const const const const T t5; // only in C
typedef const T CT;
CT const tcc; // fine, although CT was already const 
```

声明完全相同，一个常量`T`。如果`T`已经有 cv 限定符，这不会改变附加限定的含义。

现在，优先；你可以说“我想要一个指向常量的指针`T`”：

```
const T (* tp); 
```

通常写成

```
const T* tp; 
```

因为`const`绑定比`*`无论如何都要强。在相同的模式中，您可以定义一个“恒定但指向可变`T`”的变量：

```
T (* const tp) = 0; // must be initialised, because tp is immutable 
```

通常写为

```
T* const tp = 0; 
```

以同样的`[]`方式应用下标运算符——与表达式中的优先级相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:10:22.373

在第一个代码块中，您`const`在第二行中有一个冗余副本，这没有任何影响。（事实上​​，好的编译器会警告你。）你声明了一个 5`const TYPE`的数组，就是这样。

第二个代码块有两种不同的场景：第一行创建了一个包含五个指向 s 的*可变*指针`const TYPE`的数组，而后一行创建了一个包含五个指向 s 的*常量*指针的数组`const TYPE`。

请注意，您必须初始化一个常量数组：由于您以后无法更改这些值，因此将它们定义为未初始化是没有意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T22:25:07.530

在 C++ 2003 中对一个类型使用`const`两次是非法的，但在 C++ 2011 中是合法的（参见 7.1.6.1 [decl.type.cv] 第 1 段：“冗余 cv 限定被忽略。”）。当你使用

```
static const TYPE const name[5]; 
```

你做了`TYPE`两次常数。但是请注意，此声明在 C++ 2011 中也是非法的，因为您需要`const`在声明对象时对其进行初始化。的意思

```
const TYPE 
```

和

```
TYPE const 
```

是绝对等价的：在这两种情况下，您都使`TYPE`对象保持不变。为了保持一致性，我总是把`const`右边放在右边，因为除了顶级类型之外的每一个都`const`必须放在右边（好吧，除非某些编码指南要求不同，但我正在与愚蠢的编码指南作斗争）。

使用指针时，想法变得不同。涉及到两种类型：类型指向类型和指针。每一个都可以单独制作`const`：

```
TYPE const*       ptr1(0);  // non-const pointer to const TYPE
TYPE* const       ptr2(0);  // const pointer to non-const TYPE
TYPE const* const ptr3(0);  // const pointer to const TYPE 
```

弄清楚是什么的最好方法是`const`从右到左阅读类型声明。当然，这假设`const`限定符被放置在正确的位置。您可以替换`const`为`volatile`或`const volatile`在上面的讨论中，并且同样的推理适用。

# php - strtotime 返回错误的时间

> ID：12100663
> 
> 赞同：1
> 
> 时间：2012-08-23T22:05:36.900
> 
> 标签：php, strtotime

`echo date('Y-m-d h:m:s',strtotime('2008-11-03 16:00:29'))`

返回 2008-11-03 04:11:29

我已经尝试更改我的默认时区并在字符串后面添加 GMT、UTC、PTC 并且没有任何东西会改变输出。如何让 strtotime 匹配输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:08:41.570

您需要`i`几分钟和`H`24 小时。

请参阅[日期](http://php.net/manual/en/function.date.php)文档。

`m`是月份，这就是为什么你的时间有 11 分钟，与月份相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:08:50.727

`'Y-m-d H:i:s'`如果您想要 24 小时制时间，请使用，或将 am/pm 添加到末尾`'Y-m-d h:i:s a'`

# php - 在聊天应用程序中显示在线用户

> ID：12100670
> 
> 赞同：0
> 
> 时间：2012-08-23T22:06:05.707
> 
> 标签：php, javascript, jquery

我有一个聊天应用程序，在这个应用程序中，我想在聊天室中显示在线用户。我有一个记录在线用户的数据库，每当有新用户出现时，它就会不断变化。每当用户离开时，它就会从数据库中删除。数据库由两列组成：用户名和房间。数据库端工作正常。

onlinelar.php：

```
<?php

$data = array();

        $current = $_GET['current'];

        $room = $_GET['room'];

        $getRoomUsers = mysql_query("SELECT * FROM `chat_users_rooms` WHERE `room` = '".$room."'");

        if(mysql_num_rows($getRoomUsers) != $current)
        {
            $data['numOfUsers'] = mysql_num_rows($getRoomUsers);    
        }
        else
        {
            $data['numOfUsers'] = $current; 
        }
        echo json_encode($data);

?> 
```

在线.js：

```
var numOfUsers = 0;
var room;

function chat(room2)
{
room = room2;   
}

$.ajaxSetup({
    cache: false 
});

function getuserlist() {

     $.ajax({
        type: "GET",
        url: "onlinelar.php",
        data: {  
                'room': room,
                'current' : numOfUsers
              },
        dataType: "json",
        cache: false,
        success: function(data) {
                if (numOfUsers != data.numOfUsers) {
                numOfUsers = data.numOfUsers;

                $('#bu').html($("<strong id='bu'>"+ numOfUsers + "</strong>"));
            }

            setTimeout(getuserlist(),1);

        },
    });

} 
```

最后，它在 index.html 中的初始化程序：

- - 某物

```
 <script type="text/javascript">

                var chat = new Chat(<?php echo $room;?>);
                chat.getuserlist();

            </script>
                      <strong id="bu">
                        <?php
                        echo $numOfUsers;
                        ?>
                        </strong> 
```

- - - 某物

在这里，我想检查数据库情况（某个房间的行），并同时更改该房间的聊天数量。'current' 是用户数，'room' 是房间名称。但是即使数据库的行数发生变化，也没有变化。我缺少哪一部分？注意：我在 index.php 中添加了 online.js

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:16:21.307

`$('#bu').html($("<strong id='bu'>"+ numOfUsers + "</strong>"));`

这一行在你的旧元素下放置了一个新元素，你想要做的是通过调用替换旧元素

```
$('#bu').html(numOfUsers); 
```

也`setTimeout()`需要毫秒，所以这`1`是一个非常低的值，您可能希望`1000`从那里开始工作。

**编辑：** 并将`setTimeout()`函数作为参数，因此您要调用：

```
setTimeout(getuserlist, 1000); 
```

# zend-framework - Zend Framework：从不同的表中选择数据

> ID：12100671
> 
> 赞同：1
> 
> 时间：2012-08-23T22:06:06.947
> 
> 标签：zend-framework, zend-db-select

我想在我的网站中创建一个搜索引擎，但是有一个问题，我可以通过一个查询从两个或多个不同的表中选择所有值，因为有一个类别 exp。新闻和此类别中有子类别，每个子类别都有其他表，如果我选择新闻，我需要从子类别表中获取所有值。

经验。表：第一个表名为 test1，第二个表名为 test2：

> id|标题|内容|
> 1|狗|狗大|
> 2|猫|猫小|
> 
> id|标题|内容|
> 1|植物|植物1|
> 2|石头|石头1|

我需要从这个表中获取所有值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:14:39.853

好吧，看起来你需要在这里建立一个[工会](http://framework.zend.com/manual/en/zend.db.select.html#zend.db.select.building.union)：

```
$db = Zend_Db::factory( ...options... );
$select = $db->select()
    ->union(array(
        $db->select()
            ->from(array('t1' => 'test1'))
            ->where(/* search criteria goes here */),
        $db->select()
            ->from(array('t2' => 'test2'))
            ->where(/* search criteria goes here as well */)
        )); 
```

或者，您可能想查看[Sphinx](http://www.php.net/manual/en/intro.sphinx.php)。

# linux - 驱动程序可以获得关于调用 open 的函数的哪些信息？

> ID：12100678
> 
> 赞同：0
> 
> 时间：2012-08-23T22:06:20.877
> 
> 标签：linux, driver, symlink

驱动程序是否知道有关调用打开的应用程序的任何信息？

我正在使用驱动程序来支持 2 个相似但不同的设备。当我在应用程序中调用 open 时，我希望能够指定要使用的特定设备。我为每个设备使用符号链接，将其链接到驱动程序的名称，以便我可以调用`open("/dev/dev1"...`或 `open("/dev/dev2"...`代替，`open("/dev/drivername"...`并且希望能够在打开函数中使用此符号链接名称，如果这可能的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:17:05.223

不，这行不通。驱动程序没有获得有关用于打开节点的路径的任何信息。设备节点由主要/次要数字和字符/块类型指定，仅此而已。如果您希望您的不同“命名”节点是可区分的，大概它们应该具有不同的次要编号。

# php - 使用对象而不是数组

> ID：12100680
> 
> 赞同：3
> 
> 时间：2012-08-23T22:06:24.763
> 
> 标签：php, oop, design-patterns

在以下情况下创建新的对象类型而不是使用数组是否更有意义：

我有一个简单的结构，有两个值：姓名和年龄

```
$ages = array(
     array(
       'name' => 'bill',
       'age'  => 22
    ),
    array(
       'name' => 'bob',
       'age'  => 50
    ),
    // etc
); 
```

问题是这个结构在一个类中生成并通过一个控制器，然后在另一个类中使用。

因此感觉这两个类是捆绑在一起的，因为必须知道这个结构的数组键是在另一个类中生成的。

有没有解决这个问题的设计模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:14:29.590

我认为您不需要（即使有）一种设计模式来在一个类中生成对象/数据结构，并在另一个类中使用它。这是使用类的基本前提。此外，正如 alfasin 所提到的，使用对象比使用数组更整洁。同样在未来，如果需要，您可以与其他对象进行更好的交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T00:24:47.927

我会一路定义一个 Person 模型类。像这样的东西

```
Class Person {

  protected _age;

  protected _name;

  public function __construct($name = null, $age = null) {
    if ($name) setName($name);
    if ($age) setAge($age);
  }

  public function getName() {
    return $this->_name;
  }

  public function setName($name) {
    return $this->_name = (string) $name;
  }

  public function getAge() {
    return $this->_age;
  }

  public function setAge($age) {
    return $this->_age = (int) $age;
  }
} 
```

然后，您可以使用此类创建数据结构，如下所示：

```
$persons = array(new Person('bill', 22),new Person('bob', 50)); 
```

然后这个数组可以被你的控制器传递并在视图中像这样使用：

```
foreach($persons as $person) {
  echo $person->getName();
  echo $person->getAge();
} 
```

这种设计模式被称为 MVC（模型视图控制器）并且非常流行并且有据可查，尽管我的解释不同。

对于您的简单结构来说，这可能看起来有点矫枉过正，但在将来必须扩展代码时，它将为您节省大量时间。

*（代码未经测试，但我认为它应该可以正常工作）*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:10:37.623

由于它是一个简单的结构，您可以使用它，但通常建议使用对象。如果您将来想添加字段，请添加级别（嵌套数组） - 维护会更容易，因为您的程序将更加模块化且耦合更少：

```
// I - easier to use
$bill_age = $ages->get_age('bill'); 
// function get_age() is implemented in the class which 
// makes you code easier to maintain and easier to understand

// II - this implementation is dependent on the structure of $ages 
// if you'll change $ages - you'll have to change all the uses:
$bill_arr = $ages[0];
$bill_age = $bill_arr['age']; 
```

此外，如果您将`II`在代码中的不同位置进行调用，则更改`$ages`结构将导致更改所有这些位置，而如果您实现`I`- 您在代码中只有一个位置需要更改（`get_age($name)`类内部的实现）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-26T16:39:26.403

我认为您可以拥有一个包含此结构的键的类，然后两个类将共享该类以获取键实例。这样，您就不必跟踪两个类中的键。此外，您可以随时在此处添加更多键而无需进行太多更改。更少的耦合和更多的灵活性。

# django - 使用 django-social-auth 确保唯一的电子邮件地址

> ID：12100683
> 
> 赞同：2
> 
> 时间：2012-08-23T22:06:44.027
> 
> 标签：django

我正在查看 django-social-auth 的文档，但似乎找不到可以为用户帐户强制使用唯一电子邮件的设置。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-10T20:20:20.913

我相信答案可以在[this other question](https://stackoverflow.com/questions/19273904/how-to-have-unique-emails-with-python-social-auth)中找到。

它说要在编辑 SOCIAL_AUTH_PIPELINE 中再做一步。我相信这是一个更简单的解决方案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-23T22:21:49.433

最简单的做法是子类化`UserManager`该类，并覆盖其`create_user`方法以检查数据库中是否没有`User`具有该电子邮件地址的实例（`django-social-auth`用于`create_user`...在注册时创建用户）。有关如何设置的更多信息，请参见文档的[配置](http://django-social-auth.readthedocs.org/en/latest/configuration.html)页面。`django-social-auth`然后，您还需要子类`User`化，以便可以将自定义管理器与其关联。[Django 文档](https://docs.djangoproject.com/en/dev/topics/db/managers/#managers)中有关模型管理器的更多信息。

# iphone - 将 GLKView 与 UIViewController 一起使用

> ID：12100689
> 
> 赞同：2
> 
> 时间：2012-08-23T22:07:42.687
> 
> 标签：iphone, ios, opengl-es, glkit

我想用 OpenGL 做一些简单的图像处理，所以我从`GLKView`. 因为我不需要每隔几秒刷新一次视图，所以我没有使用`GLKViewController`，而是使用了一个普通的`UIViewController`子类。

我的问题是，我是简单地将 viewController 的视图设置为 a`GLKView`还是将其添加`GLKView`为视图控制器视图的子视图。由于我`UISlider`也在视图中添加了一个，我认为后者似乎更好，但我不确定。在某些情况下，我还需要调用`setNeedsDisplay`GLKView。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T02:45:09.480

对于您的渲染，您确实应该在 GLKViewController 中使用 GLKView。如果您担心不需要一直刷新，请在 GLKViewController 中使用 self.paused = YES，这将停止渲染循环，当您需要再次渲染时，只需执行 self.paused = NO。

如果您将 glkview 放在另一个视图中，则应将其设置为包含。在你的情况下，你应该有一个普通的 UIView 和一个普通的 UIViewController，然后添加 UISlider 和你的 GLKViewController（带有 GLKView）。

完成此操作后，您可以在父控制器中执行正常的视图操作，而您的 opengl 内容就是您的 glk 控制器。

执行此操作的一个简单示例，设置了包含 UISlider 的父级：

在父级的自定义 UIViewController 内

```
@interface ParentViewController () {
    ...
    UISlider *_slider; // this is your slider
    CustomGLKViewController *_myGlkViewController;
} 
```

然后在 viewDidLoad 里面：

```
// assuming you're using a storyboard
UIStoryboard *myStoryboard = [UIStoryboard storyboardWithName:@"MainStoryboard"
                                                      bundle:[NSBundle mainBundle]];

// setup the opengl controller
// first get an instance from storyboard
_myGlkViewController = [myStoryboard instantiateViewControllerWithIdentifier:@"idForGlkViewController"];
// then add the glkview as the subview of the parent view
[self.view addSubview:_myGlkViewController.view];
// add the glkViewController as the child of self
[self addChildViewController:_myGlkViewController];
[_myGlkViewController didMoveToParentViewController:self];

// if you want to set the glkView to the same size as the parent view, 
// or you can do stuff like this inside myGlkViewController
_myGlkViewController.view.frame = self.view.bounds; 
```

但这只是一个帮助您入门的简单示例，您真的应该阅读有关 ios5 的 UIViewController 包含的苹果文档和 GLKit 的文档

# jquery - jQuery 序列化 HTML5 数据属性

> ID：12100692
> 
> 赞同：10
> 
> 时间：2012-08-23T22:08:01.180
> 
> 标签：jquery, html, custom-data-attribute

在任何地方都找不到这个，也许有人知道或可以提出建议。

我有一个包含很多 的表单`<inputs>`，我想用 jQuery`$.ajax`功能发送该表单，所以我做了`$('#myform').serialize()`并将它作为 json 发送。

现在我的表单更高级并且具有 HTML5`data-`属性，我也想发送这些属性，但`.serialize()`看不到它们。

我尝试将它们放在`<form>`标签中`<input>`- 没有任何效果。

获取它们并与所有表单数据一起发送的最佳做法是什么？我知道`.serializeArray()`，但是如何获取我的标签附加的所有`data-`属性序列化？`<form>`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-24T09:42:15.877

这是如何做到的。这可能不是最好的方法，但它以应有的方式工作。

[http://jsfiddle.net/Bvzqe/12/](http://jsfiddle.net/Bvzqe/12/)

HTML：

```
<form id="frm" data-id="123" data-list[one]="first" data-list[two]="second"> 
```

序列化：

```
 var form = $('#frm');
    var dataarr = new Array();
    for(var i in form.data()) {
        var subarr = new Array();
        subarr['name'] = i;
        subarr['value'] = form.data()[i];
        dataarr.push(subarr);
    }
    var serialized = $.param(form.serializeArray().concat(dataarr)); 
```

它甚至允许您拥有`data-`属性数组，例如

```
data-list[one]="first" data-list[two]="second" 
```

URL 编码它可能看起来是错误的，因为它转义了方括号，但我已经在服务器端对此进行了测试——它完全按照它应该的方式解析所有内容。

这仅适用于那些不想使用的人`<input type="hidden">`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T22:24:34.380

如果可能的话，您应该将附加值存储为`hidden`输入字段（每个值一个），而不是其他输入字段的元数据。然后，它们将作为表单的一部分自动序列化。

我不会为您编写序列化程序，因为我认为这是一个坏主意。但是，如果您*坚持*将值作为字段发送到浏览器，则`data-`可以这样做，将这些`data-`字段转换为`hidden`输入。

```
$('#myform:input').each(function() {
    var input = this;
    $.each($(input).data(), function(key, value) {
        $('<input>', {type: hidden, name: key, value: value}).insertAfter(input);
    });
}); 
```

嘿 presto，将自动序列化的隐藏输入字段！

请注意，jQuery 也用于`.data()`存储事件等内容。为了避免遍历这些对象，您必须使用本机 DOM 函数来检索`data-` *属性*，而不是任何已存储在元素上的与数据相关的*属性。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-01T10:00:44.207

这是我的函数，获取元素的所有数据-* + 支持忽略数组

```
Data2Params: function (el, ignoredAtt) {
    ignoredAtt = typeof ignoredAtt !== 'undefined' ? ignoredAtt : [];

    var data = {};
    for (var key in el.data()) {
        if (ignoredAtt.indexOf(key) === -1)
            data[key] = el.data(key);
    }
    return data;
} 
```

# solr - Solr没有索引

> ID：12100693
> 
> 赞同：2
> 
> 时间：2012-08-23T22:08:02.437
> 
> 标签：solr

我已经设置 Solr 通过 DIH 处理程序从 Oracle DB 索引数据。但是通过 Solr 管理员，我可以看到 DB 连接成功，数据从 DB 检索到 Solr 但未添加到索引中。消息是“添加了 0 个文档”，即使我能够看到返回了 9 条记录。

db-data-config.xml 中的模式和字段是一回事。

请建议我是否应该寻找任何东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T01:15:35.393

您是否通过点击进行了完整导入`http://HOST:PORT/solr/CORE/dataimport?command=full-import`？然后提交应该默认发生。您还可以尝试通过点击明确提交完全导入`http://HOST:PORT/solr/CORE/dataimport?command=full-import&commit=true`。

点击`http://HOST:PORT/solr/CORE/select?q=*:*`并检查您是否返回了 9 个文档。

但是，如果您正在运行增量导入，则可能没有更改任何文档，您可能会看到添加/删除了 0 个文档。

如果您想在开始之前删除现有的 Solr 索引，请点击`http://HOST:PORT/solr/CORE/update?stream.body=<delete><query>*:*</query></delete>&commit=true`然后执行完整的导入和验证。

# scala - 玩！框架 2.0：使用其他字段验证表单中的字段

> ID：12100698
> 
> 赞同：19
> 
> 时间：2012-08-23T22:08:31.510
> 
> 标签：scala, playframework, validation

在剧中！框架，使用 scala，说我有如下形式：

```
import play.api.data._
import play.api.data.Forms._
import play.api.data.validation.Constraints._

case class User(someStringField: String, someIntField: Int)

val userForm = Form(
  mapping(
    "someStringField" -> text,
    "someIntField" -> number verifying(x => SomeMethodThatReceivesAnIntAndReturnsABoolean(x))
  )(User.apply)(User.unapply) 
```

)

where`SomeMethodThatReceivesAnIntAndReturnsABoolean`是一种在 int 上执行一些逻辑来验证它的方法。

但是，我希望能够`someStringField`在验证时考虑 的价值`someIntField`，有没有办法在游戏框架的形式中实现这一点？我知道我可以做类似的事情：

```
val userForm = Form(
  mapping(
    "someStringField" -> text,
    "someIntField" -> number 
  )(User.apply)(User.unapply)
.verifying(x => SomeFunctionThatReceivesAnUserAndReturnsABoolean(x)) 
```

然后我会将可用的整个用户实例传递给验证函数。这种方法的问题是产生的错误将与整个表单相关联，而不是与`someIntField`字段相关联。

有没有办法得到这两个东西，使用另一个字段验证一个字段并维护与我希望验证的特定字段相关的错误，而不是整个表单？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-11-09T15:47:31.767

我对根据其他字段的值向字段添加验证有相同的要求。我不确定这是如何在惯用的 PLAY 2.2.1 中完成的，但我想出了以下解决方案。在这种用法中，我将内置的“映射”降级为一个简单的类型转换器，并在“validateForm”方法中应用我的“高级字段间”验证。映射：

```
val userForm = Form(
mapping(
  "id" -> optional(longNumber),
  "surename" -> text,
  "forename" -> text,
  "username" -> text,
  "age" -> number
)(User.apply)(User.unapply)
)

private def validateForm(form:Form[User]) = {
  if(form("username").value.get == "tom" || form("age").value.get == "38") {
    form
      .withError("forename", "tom - forename error")
      .withError("surename", "tom - surename error")
  }
  else
    form
}

def update = Action { implicit request =>
  userForm.bindFromRequest.fold({
    formWithErrors => BadRequest(users.edit(validateForm(formWithErrors)))
  }, { user => 
    val theForm = validateForm(userForm.fill(user))
    if(theForm.hasErrors) {
      BadRequest(users.edit(theForm))
    } else {
      Users.update(user)
      Redirect(routes.UsersController.index).flashing("notice" -> s"${user.forename} updated!")
    }
  }) 
} 
```

即使它有效，我也在紧急寻找更惯用的版本......

**编辑：**在惯用游戏中使用自定义 play.api.data.format.Formatter，更多信息[请参见 http://workwithplay.com/blog/2013/07/10/advanced-forms-techniques/](http://workwithplay.com/blog/2013/07/10/advanced-forms-techniques/) - 这可以让您以编程方式将错误添加到表单。我的格式化程序如下所示：

```
val usernameFormatter = new Formatter[String] {

override def bind(key: String, data: Map[String, String]): Either[Seq[FormError], String] = {
  // "data" lets you access all form data values
  val age = data.get("age").get
  val username = data.get("username").get
  if(age == "66") {
    Left(List(FormError("username", "invalid"), FormError("forename", "invalid")))
  } else {
    Right(username)
  }
}

override def unbind(key: String, value: String): Map[String, String] = {
  Map(key -> value)
}
}
} 
```

像这样在表单映射中注册：

```
mapping(
[...]
  "username" -> of(usernameFormatter),
[....] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-03-25T04:55:44.667

我相信您正在寻找的是[`play.api.data.validation.Constraint`](https://www.playframework.com/documentation/2.2.x/api/scala/index.html#play.api.data.validation.Constraint).

假设您有一个`RegisterForm`带有预定义列表`cities`和一个`otherCity`字段的列表，并且您需要提供`cities`or `otherCity`，即，如果未提供，`otherCity`则应进行验证：`cities`

```
case class RegisterForm(
  email: String,
  password: String,
  cities: Option[List[String]],
  otherCity: Option[String]
) 
```

您可以围绕此编写自定义[约束：](https://www.playframework.com/documentation/2.2.x/ScalaCustomValidations)

```
val citiesCheckConstraint: Constraint[RegisterForm] = Constraint("constraints.citiescheck")({
  registerForm =>
    // you have access to all the fields in the form here and can
    // write complex logic here
    if (registerForm.cities.isDefined || registerForm.otherCity.isDefined) {
      Valid
    } else {
      Invalid(Seq(ValidationError("City must be selected")))
    }
}) 
```

您的表单定义变为：

```
val registerForm = Form(
  mapping(
    "email" -> nonEmptyText.verifying(emailCheckConstraint),
    "password" -> nonEmptyText.verifying(passwordCheckConstraint),
    "cities" -> optional(list(text)),
    "other_city" -> optional(text)
  )(RegisterForm.apply)(RegisterForm.unapply).verifying(citiesCheckConstraint)
) 
```

在此示例中`emailCheckConstraint`，`passwordCheckConstraint`是我定义的其他自定义约束，类似于`citiesCheckConstraint`. 这适用于 Play 2.2.x。

**更新：** 也适用于 Play 2.3.8。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-02T22:41:45.937

如果您不介意为参数添加前缀，则可以对相关参数进行分组：

```
val aForm = Form(
mapping(
  "prefix" -> tuple(
    "someStringField" -> text,
    "someIntField" -> number
  ) verifying (tup => your verification)
)(tup => User.apply(tup._1, tup._2)(User.unapply...) 
```

我使用类似的东西，只是没有周围的映射。您将不得不稍微调整应用/取消应用并手动传递参数以进行编译。

错误将被注册到“前缀”组。

我还觉得奇怪的是，在验证表单时，您无法在任何您想使用 FormError 的字段上注册错误......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-20T06:50:40.823

感谢 Tom Myer，这是我使用的

```
class MatchConstraint[A](val targetField:String, val map:(String, Map[String, String]) => A, val unmap:A => String) extends Formatter[A] {
  override def bind(key: String, data: Map[String, String]): Either[Seq[FormError], A] = {
    val first = data.getOrElse(key, "")
    val second = data.getOrElse(targetField, "")
    if (first == "" || !first.equals(second)) {
      Left(List(FormError(key, "Not Match!")))
    }
    else {
      Right(map(key, data))
    }
  }

  override def unbind(key: String, value: A): Map[String, String] = Map(key -> unmap(value))
} 
```

我的表格是什么样的

```
val registerForm = Form(
  mapping(
    "email" -> email.verifying(minLength(6)),
    "password" -> text(minLength = 6),
    "passwordConfirmation" -> of(new MatchConstraint[String]("password", (key, data) => data.getOrElse(key, ""), str => str))
  )(RegisterData.apply)(RegisterData.unapply)
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-09T08:54:55.260

在文档中： [Playframework 文档](https://www.playframework.com/documentation/2.2.x/ScalaForms)

您可以看到以下代码： `val userFormConstraintsAdHoc = Form( mapping( "name" -> text, "age" -> number )(UserData.apply)(UserData.unapply) verifying("Failed form constraints!", fields => fields match { case userData => validate(userData.name, userData.age).isDefined }) )`

主要是在 unapply 之后验证，所有的字段都映射好了，这样可以做一个更完整的验证。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-28T09:52:30.060

我猜他们将scala-code映射到JSR-Validation。那里绝对不可能。有一些论据可以做到这一点。主要是验证应该简单而不是复杂的逻辑。我怎么还是想念这个。play1 的 OVal 对我来说更好。

# variables - 将特定形状作为函数参数传递

> ID：12100705
> 
> 赞同：0
> 
> 时间：2012-08-23T22:09:01.273
> 
> 标签：variables, powerpoint, argument-passing, shapes

将 Powerpoint 2010 和 MS Visual Basic 用于应用程序：

我正在尝试将特定形状作为参数传递...尝试了不同的语法或方法，但没有运气，它似乎阻止了在函数之间使用 oShape 变量。

函数 ClickBtn1() 将 oShape 变量设置为要修改的形状的名称，并调用修改函数 Incre()。

Incre() 将数值设置为 12，将文本范围从形状更新为它，然后将前景色更改为 10、10、10，然后重绘幻灯片...

我所拥有的是这样的：

```
Dim oShape As Shape
Dim x As Long

Sub ClickBtn1()
MsgBox "Inside ClickBtn1"
oShape = ActivePresentation.Slides(7).Shapes("ParaIcon")
Incre
End Sub

Sub Incre()
MsgBox "inside Incre"
x = 12
oShape.TextFrame.TextRange.Text = x
oShape.Fill.ForeColor.RGB = RGB(10, 10, 10)
SlideShowWindows(7).View.GotoSlide (SlideShowWindows(7).View.Slide.SlideIndex)
End Sub 
```

我有一个箭头形状，其动作设置为“运行宏 ClickButton1”，在 Powerpoint 文档的幻灯片 7 上有一个名为“ParaIcon”的矩形...

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T02:06:21.437

我会这样做；避免使用全局变量并使用 SET 将对象引用分配给变量。

```
Sub ClickBtn1()
    Dim oShape as Shape
    MsgBox "Inside ClickBtn1"
    SET oShape = ActivePresentation.Slides(7).Shapes("ParaIcon")
    Incre oShape    
End Sub

Sub Incre(oShape as Shape)
    Dim x as Long
    MsgBox "inside Incre"
    x = 12

    ' Convert numbers to string before assigning text
    oShape.TextFrame.TextRange.Text = Cstr(x)

    oShape.Fill.ForeColor.RGB = RGB(10, 10, 10)
    SlideShowWindows(7).View.GotoSlide (SlideShowWindows(7).View.Slide.SlideIndex)    
End Sub 
```

# abap - SAP Business One 2007 中是否有 ABAP 工作台？

> ID：12100707
> 
> 赞同：0
> 
> 时间：2012-08-23T22:09:15.393
> 
> 标签：abap, sapb1

这是一个简单的问题，但很难找到答案。

SAP Business One 2007 中是否有 ABAP 工作台（也称为 SAP R/3 中的事务代码 SE80）？

工作台应该是开放的，而不仅仅是供 SAP 使用。我想知道是否可以在这个 SAP 解决方案中创建自定义 ABAP 程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T06:42:03.713

如果您费心搜索，根本不难找到答案。B1 中没有 ABAP 工作台，因为 B1 不是在 NetWeaver/ABAP 堆栈之上构建的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T05:31:28.687

SAP Business One 不是在 NetWeaver 平台上构建的，因此您不可能拥有 ABAP 应用服务器。另外，请注意，SBO 不是 R/3 结构。关于 SBO 中的技术部分，它有一个 SQL 数据库，您只能编写 SQL 查询来检索数据和生成报告。有一个查询生成器可以帮助您编写查询。总而言之，与 ABAP 相比，SBO 中的数据处理非常有限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T13:58:32.160

您需要使用 .NET/Java 在 SAP Business One 中自定义或开发屏幕。

它与 ABAP 没有任何关系，并且 SAP Business One 中没有事务代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T21:38:29.427

> 关于 SBO 的技术部分，它有一个 SQL 数据库，你只能编写 SQL 查询来检索数据和生成报告。有一个查询生成器可以帮助您编写查询。总而言之，与 ABAP 相比，SBO 中的数据处理非常有限。

但是一旦你有了数据，你就可以用它做任何你想做的事情，例如现在在 SBO 中的原生 Crystal Report rutime ......它还有一个非常丰富和成熟的基于 COM 的 SDK 用于放入数据，DI API （以及基于 XML 的 DI 服务器）。我在工作中一直使用这些为 SBO 创建解决方案......

# html - 如何在 MVC 中回发复选框

> ID：12100708
> 
> 赞同：0
> 
> 时间：2012-08-23T22:09:21.250
> 
> 标签：html, asp.net-mvc

我有一个控制器：

```
using System;
using System.Collections.Generic;
using System.Web.Mvc;
using MvcApplication5.Models;

namespace MvcApplication5.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            var car = new Car { Sold = true };

            return View(car);
        }

        [HttpPost]
        public ActionResult Index(Car car)
        {

            return View(car);
        }

        public ActionResult About()
        {
            return View();
        }
    }
} 
```

模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace MvcApplication5.Models
{
    public class Car
    {

        public bool Sold { get; set; }
    }
} 
```

这是视图：

```
 @model MvcApplication5.Models.Car

@using (Html.BeginForm())
{
    @Html.CheckBoxFor(m => m.Sold, new  { @class = "sold" })
    @Html.HiddenFor(m => m.Sold)

    <div class="disable">Disable</div>
    <button type="submit" value="Submit">Submit</button>
}

<script type="text/javascript">
    $(function () {
        $('.disable').click(function () {
            $('.sold').attr("disabled", "disabled");
        });
    })
</script> 
```

所以我在这里想要实现的是你进来并选中复选框。如果您单击提交，则该值将被很好地回发。但是，如果您单击禁用该复选框将被禁用。然后单击提交。我期待，因为该复选框仍处于选中状态，并且我添加了一个隐藏字段，返回的已售值将是真实的。这就是我添加隐藏字段的全部意义所在。

谁能告诉我为什么当有一个隐藏字段应该保持该值时，复选框在选中但禁用时为 Sold 发回 false ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:34:04.717

disabled=disabled 不发送值，您想要保留该值以禁用它被更新的是 readonly=readonly。IE

```
$('.sold').attr("readonly", "readonly"); 
```

您还需要应用一些 CSS 使其看起来被禁用。

# jquery - jQuery slideDown 导致包装器 div 在 Firefox 中移动

> ID：12100710
> 
> 赞同：3
> 
> 时间：2012-08-23T22:09:38.333
> 
> 标签：jquery, positioning, slideup

我在包含 div 的内部有一个 div（即“包装器”div）。这个包装器 div 的边距设置为自动，因此它位于页面的中心。当您单击一个按钮时，包装器 div 内的另一个 div 使用 jQuery 的 slideDown 函数显示。但是，当这种情况发生时，包装器 div 会向左移动几个像素，并在您再次单击该按钮以通过 jQuery 的上滑功能使 div 消失时向后移动。这是我的代码， div.answer 是您通过单击按钮显示/隐藏的包装 div 内的 div

CSS：

```
 #wrapper {
        background: url(myimages/bground.jpg);
        text-align: center;
        margin: auto;
        width:1020px;
        border:0px solid red;
    }

    div.answer{
        border: 0px solid #5c5c5c;
        padding:3px;
        margin-left: 29px;
        margin-right: 29px;
        display:none;
    } 
```

Javascript：

```
 $('span.problemBullet').toggle(function(){
        $('div.answer').slideDown();
        $(this).html('&nbsp;-&nbsp;');
        $(this).css('padding','0px 2px 0px 2px');

    },
        function(){
            $('div.answer').slideUp();
            $(this).html('&nbsp;+&nbsp;');
            $(this).css('padding', '0px 0px 0px 0px');

        }

    ); 
```

“problemBullet”是我从一个`span`元素创建的一个小按钮，单击它可以让 div 显示和隐藏

这在 Google Chrome 和 Safari 中运行良好。

你可以在这里看到它的实际效果： [点击我](http://www.sarahluo.com/mathProblems.php?subTopicId=1&subTopicName=Representation_of_Numbers_in_the_Computer)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T14:45:11.363

就像评论中指出的那样，发生这种情况是因为向下滑动这个 div 会将主体的高度增加到大于视口的点，从而导致滚动条出现，从而将整个内容向左移动。

我最好的解决方案是默认使用这个 css 显示滚动条：

```
body {
    overflow-y: scroll;
} 
```

# vb.net - VB.net 你会如何提高这个功能的性能

> ID：12100712
> 
> 赞同：-1
> 
> 时间：2012-08-23T22:09:45.500
> 
> 标签：vb.net, performance

我有这个函数，它根据可用库存计算某些产品的建议价格，现在它的作用并不重要，但它以某种方式运行，我的程序在没有它的情况下运行得像 x10 更快，我真的很困惑，我不确定为什么它很慢

```
 Dim MinPrice As Double
    Dim VAT = 1.1899999999999999
    Dim margin1
    Dim potherrule1 As String
    Dim margin2
    Dim potherrule2 As String
    Dim margin3
    Dim potherrule3 As String
    Dim defaultmargin

    If SupplierMargin IsNot Nothing Then
        margin1 = SupplierMargin(0)
        potherrule1 = SupplierPother(0)
        margin2 = SupplierMargin(1)
        potherrule2 = SupplierPother(1)
        margin3 = SupplierMargin(2)
        potherrule3 = SupplierPother(2)
        defaultmargin = SupplierMargin(3)
    End If

    If IsDBNull(CurrentPother) Or (potherrule1 = "x" And potherrule2 = "x" And potherrule3 = "x") Then
        MinPrice = Math.Round((oprice / (1 - defaultmargin)) * VAT, 2)
        Return MinPrice
    End If

    If Not IsDBNull(CurrentPother) Then
        If potherrule1 <> "x" Then
            Dim v1 As Integer
            Dim v2 As Integer
            Dim rule As String = potherrule1
            Dim parts() As String = rule.Split(New String() {" bis "}, StringSplitOptions.None)
            v1 = Integer.Parse(parts(0))
            v2 = Integer.Parse(parts(1))
            If CurrentPother >= v1 And CurrentPother <= v2 Then
                MinPrice = Math.Round((oprice / (1 - margin1)) * VAT, 2)
            End If
            Return MinPrice

        ElseIf potherrule2 <> "x" Then
            Dim v1 As Integer
            Dim v2 As Integer
            Dim rule As String = potherrule2
            Dim parts() As String = rule.Split(New String() {" bis "}, StringSplitOptions.None)
            v1 = Integer.Parse(parts(0))
            v2 = Integer.Parse(parts(1))
            If CurrentPother >= v1 And CurrentPother <= v2 Then
                MinPrice = Math.Round((oprice / (1 - margin2)) * VAT, 2)
                Return MinPrice
            End If

        ElseIf potherrule2 <> "x" Then
            Dim v1 As Integer
            Dim v2 As Integer
            Dim rule As String = potherrule3
            Dim parts() As String = rule.Split(New String() {" bis "}, StringSplitOptions.None)
            v1 = Integer.Parse(parts(0))
            v2 = Integer.Parse(parts(1))
            If CurrentPother >= v1 And CurrentPother <= v2 Then
                MinPrice = Math.Round((oprice / (1 - margin3)) * VAT, 2)
                Return MinPrice
            End If
        Else
            MinimumPriceWhenPother4IsDBnull(SupplierMargin, oprice)
        End If
    End If 
```

您能否建议一些可以使此功能更快的改进？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T13:26:36.690

`MinimumPriceWhenPother4IsDBnull(SupplierMargin, oprice)`我同意@APrough 的观点，该问题可能是由于您的第三个 ElseIf 进行了错误的比较，然后该方法意外下降。你用那个方法做什么？那时你有可能从数据库中读取吗？

您的前三个 If 处理程序中的每一个都可以分解为另一种方法以增加代码重用。虽然它不会增加性能。

另一个警告点。注意 Math.Round。默认情况下，它使用 ANSI 标准四舍五入到最接近的偶数，而不是您在学校学到的四舍五入。请参阅[http://www.thinqlinq.com/Post.aspx/Title/Rounding-in-.Net](http://www.thinqlinq.com/Post.aspx/Title/Rounding-in-.Net)。不过，这不会导致性能下降 10 倍。

此外，您可能希望在 VS Ultimate 中运行性能分析，或获取 Ants 分析器的 eval 以查看代码中真正的瓶颈在哪里。它通常会被事件处理程序、方法调用或其他意想不到的地方隐藏起来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T12:14:07.490

除了上面@Tim Schmelter 的评论，您确实意识到您的第三个条件仍在查看 potherrule2？因此，我的猜测是，当 potherrule3 为 <> "x" 并且您希望它进行评估时，您的代码默认为您的 MinimumPriceWhenPother4IsDBnull 函数。不确定该功能的作用，但如果它运行很多，那可能会导致您的速度问题。

# html - 专注于带有哈希/片段的页脚表单在成功提交后保持哈希

> ID：12100714
> 
> 赞同：0
> 
> 时间：2012-08-23T22:09:56.990
> 
> 标签：html, forms, fragment-identifier

我在页面底部有一个表格。这是一个正常的形式。我已将操作设置为`#adding-show`并且表单`id`是“表单”。结果是表单提交到当前页面（浏览器不发送`#adding-show`到服务器）。

如果提交无效/失败，则表单具有焦点且可见 = 好。

如果提交有效，服务器将浏览器重定向到同一页面（以摆脱回发），没有哈希，但浏览器“记住”哈希，因此浏览器重定向到`#adding-show`页面底部。

简而言之：当提交无效/失败时保持哈希是好的，但如果提交成功则不应使用哈希。

问题：有没有办法做到这一点？正确重定向并适当地“忘记”哈希。有些JS没问题。我可以让服务器做任何事情。

如果你喜欢代码，[它在 Github 上](https://github.com/rudiedirkx/series/blob/7a85b26d0ba984de7bbdd21fba576a05ffc5bea7/index.php#L504)。

或者：

`<form id="adding-show" method="post" action="#adding-show">`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:43:11.703

我已经用一段'条件'JS解决了它：[https](https://github.com/rudiedirkx/series/blob/83c74f183d4c10474e2b92d819349120ad0094b6/index.php#L627) ://github.com/rudiedirkx/series/blob/83c74f183d4c10474e2b92d819349120ad0094b6/index.php#L627它只在页面处于回发状态时打印，所以表单需要被突出显示。

# mysql - 子查询中的Mysql最大日期

> ID：12100724
> 
> 赞同：1
> 
> 时间：2012-08-23T22:10:41.383
> 
> 标签：mysql

我无法弄清楚如何让这个子查询工作以获取该行的最新日期。

```
SELECT Thread_Heading.*, Thread_Articles.*, Thread_ArticlesPost.* 
FROM Thread_Heading 
LEFT JOIN Thread_Articles 
    ON Thread_Articles.Thread_Article_Head_id=Thread_Heading.Thread_Head_id 
LEFT JOIN 
(
    SELECT Thread_ArticlesPost.* 
    FROM Thread_ArticlesPost 
    ORDER BY Thread_ArticlePost_DT DESC
) Thread_ArticlesPost 
    ON  Thread_ArticlesPost.Thread_ArticlePost_Article_id=Thread_Articles.Thread_Article_id  
WHERE Thread_Head_Level = '5' 
GROUP BY Thread_Heading.Thread_Head_id 
ORDER BY Thread_ArticlePost_DT DESC 
```

我需要按每篇 Thread 文章的最新帖子来排序文章发布日期。相当新的 sql 和 php 我只是无法解决这个问题，任何帮助将不胜感激。

吨

```
ABLE: Thread_Heading | 
Thread_Head_id
Thread_Head_Name
Thread_Head_Type
Thread_Head_Creator
Thread_Head_Date
Thread_Head_Level

TABLE: Thread_Articles | 
Thread_Article_id
Thread_Article_Head_id
Thread_Article_Creator
Thread_Article_DT
Thread_Article_Level
Thread_Article_Type
Thread_Article_Title

TABLE: Thread_ArticlesPost | 
Thread_ArticlePost_id
Thread_ArticlePost_Head_id
Thread_ArticlePost_Article_id
Thread_ArticlePost_Creator
Thread_ArticlePost_DT
Thread_ArticlePost_Level
Thread_ArticlePost_Type
Thread_ArticlePost_Title
Thread_ArticlePost_Content 
```

我需要像这样显示日期：

```
Head Name | Article title | ORDER BY LATEST ArticlePost DT | ArticlePost Creator 
```

我使用左连接的原因是即使没有文章或文章回复也能获取左数据。

感谢帮助。

已经用它来显示数据感谢 Blue

SELECT *
FROM
( SELECT th.Thread_Head_Name,
ta. *, tp1.maxdate, tp2.* FROM Thread_Heading th LEFT JOIN Thread_Articles ta ON th.Thread_Head_id = ta.Thread_Article_Head_id LEFT JOIN
( SELECT max(Thread_ArticlePost_DT) maxDate,
Thread_ArticlesPost.* FROM Thread_ArticlesPost GROUP B Thread_ArticlePost_Article_id ) tp1 ON tp1.Thread_ArticlePost_Article_id=ta.Thread_Article_id
LEFT JOIN Thread_ArticlesPost tp2 ON tp1.Thread_ArticlePost_Article_id = tp2.Thread_ArticlePost_Article_id 和 tp1.maxdate = tp2.Thread_ArticlePost_DT
WHERE th.Thread_Head_Level = '5' ORDER BY tp1.maxdate DESC) m GROUP BY Thread_Head_Name ORDER BY Thread_ArticlePost_DT DESC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:16:38.570

如果没有看到您的完整表模式，您将需要执行类似的操作：

```
SELECT th.*, ta.*, tp.* 
FROM Thread_Heading th
LEFT JOIN Thread_Articles ta
    ON th.Thread_Head_id = ta.Thread_Article_Head_id
LEFT JOIN 
(
    SELECT max(Thread_ArticlePost_DT) maxDate, Thread_ArticlesPost.* 
    FROM Thread_ArticlesPost 
    GROUP BY Thread_ArticlePost_Article_id
) Thread_ArticlesPost tp
    ON  tp.Thread_ArticlePost_Article_id=ta.Thread_Article_id  
WHERE Thread_Head_Level = '5' 
GROUP BY th.Thread_Head_id 
ORDER BY tp.maxdate DESC 
```

根据您的编辑，以下应返回您想要的数据：

```
SELECT th.Thread_Head_Name, 
  ta.Thread_Article_Title,
  tp1.maxdate,
  tp2.Thread_ArticlePost_Creator
FROM Thread_Heading th
LEFT JOIN Thread_Articles ta
    ON th.Thread_Head_id = ta.Thread_Article_Head_id
LEFT JOIN 
(
    SELECT max(Thread_ArticlePost_DT) maxDate, 
      Thread_ArticlesPost.Thread_ArticlePost_Article_id
    FROM Thread_ArticlesPost 
    GROUP BY Thread_ArticlePost_Article_id
) tp1
  ON  tp1.Thread_ArticlePost_Article_id=ta.Thread_Article_id  
LEFT JOIN Thread_ArticlesPost tp2
  ON tp1.Thread_ArticlePost_Article_id = tp2.Thread_ArticlePost_Article_id
  AND tp1.maxdate = tp2.Thread_ArticlePost_DT 
WHERE th.Thread_Head_Level = '5' 
ORDER BY tp1.maxdate DESC 
```

编辑#2，根据您的评论，我认为下面的查询应该解决任何剩余的问题：

```
SELECT th.Thread_Head_id,
  th.Thread_Head_Name,
  ta.Thread_Article_Title,
  tp.Thread_ArticlePost_Creator,
  tap.MaxPostDate
FROM Thread_Heading th 
LEFT JOIN
(
  SELECT max(ta.Thread_Article_DT) MaxArticleDate, 
    ta.Thread_Article_Head_id,
    max(tp.Thread_ArticlePost_DT) MaxPostDate
  FROM Thread_Articles ta
  LEFT JOIN Thread_ArticlesPost tp
    ON ta.Thread_Article_id = tp.Thread_ArticlePost_Article_id
  GROUP BY Thread_Article_Head_id
) tap
  ON th.Thread_Head_id = tap.Thread_Article_Head_id 
LEFT JOIN Thread_Articles ta
  ON tap.Thread_Article_Head_id = ta.Thread_Article_Head_id
  AND tap.MaxArticleDate = ta.Thread_Article_DT
LEFT JOIN Thread_ArticlesPost tp
  ON tap.MaxPostDate = tp.Thread_ArticlePost_DT
WHERE th.Thread_Head_Level = '5'
ORDER BY MaxPostDate desc 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/d0009/120)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:30:42.683

您不必`GROUP BY`在您的帖子之外有一个子句，您的帖子已经根据您的最新帖子分组在子查询中。试试这个，

```
SELECT  a.*, b.*, c.* 
FROM    Thread_Heading a
            LEFT JOIN Thread_Articles b
                ON b.Thread_Article_Head_id = a.Thread_Head_id
            LEFT JOIN Thread_ArticlesPost c
                ON c.Thread_ArticlePost_Article_id = b.Thread_Article_id 
            LEFT JOIN 
            (
                SELECT      Thread_ArticlePost_Article_id, MAX(Thread_ArticlePost_DT) maxDate
                FROM        Thread_ArticlesPost 
                GROUP BY    Thread_ArticlePost_Article_id
            ) d ON  d.Thread_ArticlePost_Article_id = b.Thread_Article_id AND
                    c.Thread_ArticlePost_DT = d.maxDate
WHERE       Thread_Head_Level = '5' 
-- GROUP BY a.Thread_Head_id 
ORDER BY    Thread_ArticlePost_DT DESC 
```

# python - Python - 从另一个中减去一个字典列表

> ID：12100731
> 
> 赞同：4
> 
> 时间：2012-08-23T22:11:45.087
> 
> 标签：python, list, dictionary

我有兴趣比较多个列表，获取差异并迭代它。

两者都是包含以下键的字典列表：'ssid' - str，'bssid' - str，'channel' - int，'flags' - list，'found' - bool

我试过了：

```
 list = list(set(networks_list).difference(missing_networks)) 
```

但我收到错误：

```
unhashable type 'dict' 
```

我的数据结构如下所示：

```
list: [{'found': False, 'flags': ['WPA2-PSK-CCMP', 'WPS', 'ESS'], 'ssid': 'SOHO_BROADCAST', 'bssid': '30:46:9a:9d:11:1a', 'channel': 1}, {'found': False, 'flags': ['WPA-EAP-TKIP', 'WPA2-EAP-CCMP', 'ESS'], 'ssid': 'Cisco 2.4ghz', 'bssid': '40:f4:ec:7f:3c:5a', 'channel': 11}, {'found': False, 'flags': ['WPA-EAP-TKIP', 'WPA2-EAP-CCMP', 'ESS'], 'ssid': 'Cisco 5.0ghz', 'bssid': '40:f4:ec:7f:3c:54', 'channel': 149}] 
```

缺失的网络最初是空的。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:21:43.430

与其让它们成为 dicts 列表，不如让它们成为实现的对象列表，`__eq__`并且`__hash__`您提供的代码应该可以工作

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T22:24:17.517

像这样的通用方法可能有很多陷阱，但是如果您的字典大多是原始的，而且不是很大，您可以执行以下操作：

假设您的数据如下所示：

```
networks = [
        {'address': '192.168.1.1'},
        {'address': '127.0.0.1'},
    ]

missing = [
        {'address': '127.0.0.1'}
    ] 
```

您可以将字典列表转换为列表元组（可散列）

```
def make_hashable(d):
    return (frozenset(x.iteritems()) for x in d)

networks_hashable = make_hashable(networks)
missing_hashable = make_hashable(missing) 
```

然后减去

```
diff = set(networks_hashable).difference(missing_hashable) 
```

现在你有一个元组列表

```
print list(diff) 
```

或者，转换回字典

```
print [dict(x) for x in diff] 
```

**更新**

我已经`make_hashable`根据@gnibbler 的评论更改了 的定义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T22:18:54.310

不，通常很难有效地做到这一点。不过，您不必解决一般情况，只需针对您尚未向我们详细说明的特定数据结构。

例如，如果您的 dict 键是 all`int`或者`str`它比键是复数等要容易得多。

编辑：既然您现在已经告诉我们您的数据结构，我可以告诉您一个简单的方法是将**dicts**转换为 nametuples 。

**注意：**您不能只使用`tuple(dict.items()`) 将字典转换为元组，因为键的顺序可能从一个字典到下一个字典不同

```
>>> d = dict(ssid="ssid", bssid="bssid", channel=1, flags="flags", found="True")
>>> networks_list = [d, ]
>>> from collections import namedtuple
>>> NT = namedtuple("my_struct", d.keys())
>>> set(NT(**i) for i in networks_list)
set([my_struct(found='True', flags='flags', channel=1, bssid='bssid', ssid='ssid')]) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-23T22:23:37.847

dict 是一个可变项。这意味着它在其生命周期中没有恒定的哈希值，并且不能放入集合中。

如果您将所有 dicts 转换为具有相同功能的字符串，它们将变为可散列的，您可以在集合中使用它们...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-23T22:55:34.720

如果您尝试以下简单的方法会怎样：

```
 lst = list(set(networks_list.items()).difference(set(missing_networks.items()))) 
```

（顺便说一句：我在这里将您的变量命名为*lst*；鉴于 Python 支持`list()`函数，将一些结果绑定到名称“list”可能是个坏主意。它不是关键字，因此不会引发异常，但是当您编写一些稍后尝试调用该`list()`函数的代码时，您可能会绊倒它）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-24T03:22:21.277

这种方法有效：

```
>>> import random
>>> items = [{'ssid': 'foo%s' % i, 'bssid': 'bar%s' % i, 'channel': i, 'flags': 'abc%s' % i, 'found': random.choice([True, False])} for i in range(1, 11)]
>>> items1 = random.sample(items, 7)
>>> items2 = random.sample(items, 5)
>>> print "\n".join(map(str, items1))
{'found': True, 'flags': 'abc9', 'ssid': 'foo9', 'bssid': 'bar9', 'channel': 9}
{'found': True, 'flags': 'abc7', 'ssid': 'foo7', 'bssid': 'bar7', 'channel': 7}
{'found': False, 'flags': 'abc10', 'ssid': 'foo10', 'bssid': 'bar10', 'channel': 10}
{'found': True, 'flags': 'abc5', 'ssid': 'foo5', 'bssid': 'bar5', 'channel': 5}
{'found': False, 'flags': 'abc4', 'ssid': 'foo4', 'bssid': 'bar4', 'channel': 4}
{'found': True, 'flags': 'abc3', 'ssid': 'foo3', 'bssid': 'bar3', 'channel': 3}
{'found': True, 'flags': 'abc2', 'ssid': 'foo2', 'bssid': 'bar2', 'channel': 2}
>>> print "\n".join(map(str, items2))
{'found': True, 'flags': 'abc3', 'ssid': 'foo3', 'bssid': 'bar3', 'channel': 3}
{'found': True, 'flags': 'abc9', 'ssid': 'foo9', 'bssid': 'bar9', 'channel': 9}
{'found': False, 'flags': 'abc1', 'ssid': 'foo1', 'bssid': 'bar1', 'channel': 1}
{'found': False, 'flags': 'abc8', 'ssid': 'foo8', 'bssid': 'bar8', 'channel': 8}
{'found': True, 'flags': 'abc5', 'ssid': 'foo5', 'bssid': 'bar5', 'channel': 5}
>>> print "\n".join(map(str, [dict(itemset) for itemset in set([tuple(sorted(grp.items())) for grp in items1]).difference([tuple(sorted(grp.items())) for grp in items2])]))
{'found': False, 'flags': 'abc10', 'ssid': 'foo10', 'bssid': 'bar10', 'channel': 10}
{'found': False, 'flags': 'abc4', 'ssid': 'foo4', 'bssid': 'bar4', 'channel': 4}
{'found': True, 'flags': 'abc7', 'ssid': 'foo7', 'bssid': 'bar7', 'channel': 7}
{'found': True, 'flags': 'abc2', 'ssid': 'foo2', 'bssid': 'bar2', 'channel': 2} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-23T22:40:45.753

使用列表推导：

```
>>> l1 = [{1:1, 'a':2},{1:2, 'a':4},{1:5, 'a':'2'}]
>>> l2 = [{1:1, 'a':3},{1:2, 'a':4},{1:5, 'a':'t'}]
>>> l3 = [i for i in l1 if i not in l2]
>>> l3
[{'a': 2, 1: 1}, {'a': '2', 1: 5}] 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-08-30T05:13:39.220

如前所述，dict 是可变的，因此不能通过 set() 操作——这是因为无法保证一旦放入 set 中，dict 就不会改变并等于该 set 的另一个现有元素，因此违反规定的质量。

如果您只是检查字典是否相等，您可以将它们转换为元组，然后在 set() 操作中使用元组，然后将结果集中的元组转换回字典。

```
>>> d = {1:1, 2:2}
>>> t = tuple(d1.items())
>>> t
((1, 1), (2, 2))
>>> d_ = dict(t)
>>> d_
{1: 1, 2: 2}
>>> d == d_
True 
```

将 dict 包装到类中可能会更加麻烦，因为您仍然需要解决从 dict 到不可变数据类型的转换。

由于您的字典中有列表，因此您有更多的工作。最简单的是，如果你可以用原始字典中的元组替换列表。

假设这不可行，您的转换过程必须是一个函数，而不是分别调用 tuple() 和 dict()。您需要先将列表转换为元组，然后将带有元组而不是列表的字典转换为元组。例如：

```
>>> d = {'int1': 1, 'int2': 2, 'list1': ['a', 'b'], 'list2': ['x', 'y']}
>>> d_l = {}
>>> for key, value in d.iteritems():
...   if type(value) == list:
...     d_l[key] = tuple(value)
...   else:
...     d_l[key] = value
>>> d_l
{'int1': 1, 'int2': 2, 'list1': ('a', 'b'), 'list2': ('x', 'y')}
>>> d_ = tuple(d_l.iteritems())
>>> d_
(('int1', 1), ('int2', 2), ('list1', ('a', 'b')), ('list2', ('x', 'y'))) 
```

要转换回来，您有两种选择。要么查看你知道对应于列表的键值（如果你的键是已知的并且不改变），要么查看第二个元素本身是元组的元组（你没有在原始字典中存储任何元组）。如果两个选项都不适用，则必须编写更复杂的转换算法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-30T01:25:06.460

我将在这里接受埃里克的回答。

首先，眼前的问题。为什么字典不可散列？简单地说，因为它是一个可变容器。如果您更改 dict 的内容，则哈希会更改。任何其他可变容器（如列表）也会发生同样的情况。所以，你必须使用不可变的东西。

在我看来，最简单的解决方案是使用包装类。本质上，一个具有单个属性的类是您最初想要的 dict。你可以用任何你想要比较的魔法函数来增加它的趣味性。

所以，如果我有你原来的网络列表

```
network_list = [
{'found': False, 'flags': ['WPA2-PSK-CCMP', 'WPS', 'ESS'], 'ssid': 'SOHO_BROADCAST', 'bssid': '30:46:9a:9d:11:1a', 'channel': 1},
{'found': False, 'flags': ['WPA-EAP-TKIP', 'WPA2-EAP-CCMP', 'ESS'], 'ssid': 'Cisco 2.4ghz', 'bssid': '40:f4:ec:7f:3c:5a', 'channel': 11},
{'found': False, 'flags': ['WPA-EAP-TKIP', 'WPA2-EAP-CCMP', 'ESS'], 'ssid': 'Cisco 5.0ghz', 'bssid': '40:f4:ec:7f:3c:54', 'channel': 149}
] 
```

我可以很容易地应用一个包装类。

```
class Wrapper(object):
    def __init__(self, **kwargs):
        for key, value in kwargs.items():
            setattr(self, key, value)

wrapped_networks = [Wrapper(**{'net_dict': network}) for network in network_list] 
```

这样，字典就可以通过以下方式存储和访问

```
wrapped_networks[0].net_dict # etc... 
```

或其他任何您可能想要命名的名称。此外，由于类的实现方式，您可以使用它来包装您想要的任何东西，即使每个 Wrapper 有多个东西！

正如您可能很清楚的那样，这样做的作用是，根据在运行时分配给它的唯一 ID，实际上被散列的是对象。对您的差异函数进行一些重构以使用这些包装器，并且您应该一切顺利（除非您提出更好的解决方案 =D ）

# html - 水平行内联块 IE7

> ID：12100734
> 
> 赞同：2
> 
> 时间：2012-08-23T22:12:03.887
> 
> 标签：html, css, internet-explorer-7

我想连续放置 3 条水平线。有谁知道如何在 IE7 的 inline-block 中显示水平线？

这是我的CSS：

```
hr.small {
    width: 28.9%;
    margin-right: 6px;
    display: inline-block;
    vertical-align: top;
    zoom: 1;
    *display: inline;
    height: 3px;
    border: 0px;
    color: #7c8690;
    background-color: #7c8690;
} 
```

但它不起作用。

这是 JSFiddle 链接：http: [//jsfiddle.net/sRuz3/6/](http://jsfiddle.net/sRuz3/6/)

如果有人有解决方案。

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T23:27:18.193

给你：http: [//jsfiddle.net/eq3Z2/](http://jsfiddle.net/eq3Z2/)

它也适用于 IE7。

当然，他们不是 HR。它们是 DIV。尝试将 HR 呈现为内联元素会导致 IE7 出错，但我不知道有什么解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:19:23.773

它必须是内联块吗？如果需要，你不能简单地浮动它们并设置一个高度吗？

**编辑 - 示例：**

```
hr.small {

    float:left;
    width: 28.9%;
    margin-right: 6px; /* Choice: Use border instead or halve the margin for IE7 and lowwer (double margin float bug). */
    height: 3px;
    background-color: #7c8690;

} 
```

**再次编辑 - 问题：**

这是一个流畅的布局吗？容器有多大？您正在设置动态宽度但固定边距，这将导致小规模问题并在大范围内将不需要的空白引入最右侧。如果是固定区域，则考虑使用固定宽度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T23:41:54.690

如果您可以将 s 包装在`hr`s 中，似乎有一个解决方案`div`。

将 div 设置为`display:inline`（我们可以使用`span`s 代替，但`hr`s 在 s 中无效`span`）¹ 并通过以下方式给`div`s hasLayout`zoom:1`

见[http://jsfiddle.net/YqKDJ/1/](http://jsfiddle.net/YqKDJ/1/)

* * *

`hr`¹ 顺便说一句， s 在 s 中无效是有原因`span`的，并且与此处相关。An`hr`主要不是一种绘制水平线的方式 - 它具有“主题中断”的特定语义含义。有两个或多个`hr`元素之间没有内容是没有意义的——第二个主题休息没有什么可以打破的。如果您想要多条水平线用于演示目的，您应该使用 CSS 来创建它们，按照@Cynthia 的回答。

# sitecore - 如何根据权限查询项目？

> ID：12100735
> 
> 赞同：0
> 
> 时间：2012-08-23T22:12:09.840
> 
> 标签：sitecore, sitecore6

我想查询 Context 用户作为*写入*访问权限而不是读取访问权限的项目。即，通常我会做这样的事情：

Sitecore.Context.Database.SelectItems("/sitecore/content/somepath/*");

...这将为用户有权读取的所有项目返回一个 Item[] 数组。是否有一种机制可以仅检索用户具有写入权限的项目？还是我将不得不遍历这些项目并单独检查它们？

如何检查上下文用户是否对给定项目具有此权限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T12:54:21.403

如果您希望它“看起来”就像您没有遍历列表一样，您可以在 LINQ 查询中执行安全检查。像这样的东西：

```
var result = Sitecore.Context.Database.SelectItems("/sitecore/content/somepath/*").Where(x => x.Security.CanWrite(Sitecore.Context.User)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T00:11:40.310

我认为您可能必须单独处理这些问题，因为[Sitecore Query](http://sdn.sitecore.net/Reference/Using%20Sitecore%20Query/Sitecore%20Query%20Syntax.aspx)没有任何功能或属性来检查项目的安全属性。（据我所知，快速查询也没有）。

# java - POI 或 docx4j 可以读取受密码保护的 Word 文档吗？

> ID：12100736
> 
> 赞同：-3
> 
> 时间：2012-08-23T22:12:31.960
> 
> 标签：java, apache-poi, docx4j

我遇到了 POI 问题，需要一些帮助。

我有一个个人日记，我已经保存了多年，每月将每日条目写入一个 Word .doc，存储在 year 文件夹中。我添加了一个密码来打开每一个，所以它们都是加密的。

我想使用 Lucene 来索引整个集合，以便更好地搜索（例如，“我最后一次在哪一天和哪一年写​​下我有多喜欢燕麦片？”）。

第一步是使用 POI 读取 Word .doc，但我无法摆脱困境，因为它无法读取我的加密文件。

我写了这个类：

```
package model;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.poi.hwpf.HWPFDocument;
import org.apache.poi.hwpf.model.DocumentProperties;
import org.apache.poi.poifs.crypt.Decryptor;
import org.apache.poi.poifs.crypt.EncryptionInfo;
import org.apache.poi.poifs.dev.POIFSLister;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.security.GeneralSecurityException;
import java.util.LinkedList;
import java.util.List;

/**
 * JournalReader class that's the heart of my efforts to finally read, parse, index, and search my journal.
 * @author Michael
 * @link
 * @since 8/19/12 3:48 PM
 */
public class JournalReader {
    public static final Log LOGGER = LogFactory.getLog(JournalReader.class);
    public static final String DEFAULT_PASSWORD = "journal";

    public static void main(String[] args) {
        if (args.length > 0) {
            try {
                POIFSLister.viewFile(args[0], true);
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
    public List<JournalEntry> readEntries(File journalFile) throws IOException, GeneralSecurityException {
        List<JournalEntry> journalEntries = new LinkedList<JournalEntry>();
        if (journalFile != null) {
            POIFSFileSystem fs = new POIFSFileSystem(new FileInputStream(journalFile));
            // Exception is thrown after info line is executed.
            EncryptionInfo info = new EncryptionInfo(fs);
            Decryptor decryptor = Decryptor.getInstance(info);
            decryptor.verifyPassword(DEFAULT_PASSWORD);
            HWPFDocument journalDocument = new HWPFDocument(decryptor.getDataStream(fs));
            DocumentProperties documentProperties = journalDocument.getDocProperties();
        }
        return journalEntries;
    }
} 
```

我有一个 JUnit 测试来尝试一下：

```
import model.JournalEntry;
import model.JournalReader;
import org.junit.Assert;
import org.junit.Test;

import java.io.File;
import java.io.IOException;
import java.security.GeneralSecurityException;
import java.util.List;

/**
 * JournalReaderTest JUnit test for JournalReader
 * @author Michael
 * @link
 * @since 8/19/12 8:46 PM
 */
public class JournalReaderTest {

    @Test
    public void testReadEntries() throws IOException, GeneralSecurityException {
        JournalReader journalReader = new JournalReader();
        String journalFilePath = "C:\\Users\\Michael\\Documents\\Stuff To Back Up\\Journal\\1994\\AUG94.doc";
        File journalFile = new File(journalFilePath);
        List<JournalEntry> journalEntries = journalReader.readEntries(journalFile);
        Assert.assertNotNull(journalEntries);
        Assert.assertTrue(journalEntries.size() > 0);
    }
} 
```

当我运行 JUnit 测试时，我得到了这个堆栈跟踪：

```
"C:\Program Files\Java\jdk1.7.0_02\bin\java" -ea -Didea.launcher.port=7540 "-Didea.launcher.bin.path=C:\Program Files (x86)\JetBrains\IntelliJ IDEA 122.29\bin" -Dfile.encoding=UTF-8 -classpath "C:\Program Files (x86)\JetBrains\IntelliJ IDEA 122.29\lib\idea_rt.jar;C:\Program Files (x86)\JetBrains\IntelliJ IDEA 122.29\plugins\junit\lib\junit-rt.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\alt-rt.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\charsets.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\deploy.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\javaws.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\jce.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\jsse.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\management-agent.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\plugin.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\resources.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\rt.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\ext\dnsns.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\ext\localedata.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\ext\sunec.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\ext\sunjce_provider.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\ext\sunmscapi.jar;C:\Program Files\Java\jdk1.7.0_02\jre\lib\ext\zipfs.jar;F:\Projects\Java\diary-index\out\test\diary-index;F:\Projects\Java\diary-index\out\production\diary-index;F:\Projects\Java\diary-index\lib\commons-lang3-3.1.jar;F:\Projects\Java\diary-index\lib\log4j-1.2.16.jar;F:\Projects\Java\diary-index\lib\commons-io-2.3.jar;F:\Projects\Java\diary-index\lib\poi-scratchpad-3.8-20120326.jar;F:\Projects\Java\diary-index\lib\poi-3.8-20120326.jar;F:\Projects\Java\diary-index\lib\poi-examples-3.8-20120326.jar;F:\Projects\Java\diary-index\lib\poi-excelant-3.8-20120326.jar;F:\Projects\Java\diary-index\lib\poi-ooxml-3.8-20120326.jar;F:\Projects\Java\diary-index\lib\poi-ooxml-schemas-3.8-20120326.jar;F:\Projects\Java\diary-index\lib\dom4j-1.6.1.jar;F:\Projects\Java\diary-index\lib\stax-api-1.0.1.jar;F:\Projects\Java\diary-index\lib\xmlbeans-2.3.0.jar;F:\Projects\Java\diary-index\lib\antlr-2.7.7.jar;F:\Projects\Java\diary-index\lib\antlr-runtime-3.3.jar;F:\Projects\Java\diary-index\lib\avalon-framework-api-4.3.1.jar;F:\Projects\Java\diary-index\lib\avalon-framework-impl-4.3.1.jar;F:\Projects\Java\diary-index\lib\commons-codec-1.3.jar;F:\Projects\Java\diary-index\lib\commons-io-1.3.1.jar;F:\Projects\Java\diary-index\lib\commons-lang-2.4.jar;F:\Projects\Java\diary-index\lib\commons-logging-1.1.1.jar;F:\Projects\Java\diary-index\lib\docx4j-2.8.0.jar;F:\Projects\Java\diary-index\lib\fop-1.0.jar;F:\Projects\Java\diary-index\lib\itext-2.1.7.jar;F:\Projects\Java\diary-index\lib\jaxb-svg11-1.0.2.jar;F:\Projects\Java\diary-index\lib\jaxb-xmldsig-core-1.0.0.jar;F:\Projects\Java\diary-index\lib\jaxb-xslfo-1.0.1.jar;F:\Projects\Java\diary-index\lib\log4j-1.2.15.jar;F:\Projects\Java\diary-index\lib\poi-3.8.jar;F:\Projects\Java\diary-index\lib\poi-scratchpad-3.8.jar;F:\Projects\Java\diary-index\lib\serializer-2.7.1.jar;F:\Projects\Java\diary-index\lib\stringtemplate-3.2.1.jar;F:\Projects\Java\diary-index\lib\wmf2svg-0.9.0.jar;F:\Projects\Java\diary-index\lib\xalan-2.7.1.jar;F:\Projects\Java\diary-index\lib\xhtmlrenderer-1.0.0.jar;F:\Projects\Java\diary-index\lib\xml-apis-1.3.04.jar;F:\Projects\Java\diary-index\lib\xmlgraphics-commons-1.4.jar;F:\Projects\Java\diary-index\test-lib\junit-4.10.jar" com.intellij.rt.execution.application.AppMain com.intellij.rt.execution.junit.JUnitStarter -ideVersion5 JournalReaderTest
log4j: reset attribute= "false".
log4j: Threshold ="null".
log4j: Level value for root is  [debug].
log4j: root level set to DEBUG
log4j: Class name: [org.apache.log4j.ConsoleAppender]
log4j: Parsing layout of class: "org.apache.log4j.PatternLayout"
log4j: Setting property [conversionPattern] to [%d{dd MMM yyyy HH:mm:ss} %5p %c{1} - %m%n].
log4j: Adding appender named [consoleAppender] to category [root].

java.io.FileNotFoundException: no such entry: "EncryptionInfo"
    at org.apache.poi.poifs.filesystem.DirectoryNode.getEntry(DirectoryNode.java:375)
    at org.apache.poi.poifs.filesystem.DirectoryNode.createDocumentInputStream(DirectoryNode.java:177)
    at org.apache.poi.poifs.crypt.EncryptionInfo.<init>(EncryptionInfo.java:45)
    at org.apache.poi.poifs.crypt.EncryptionInfo.<init>(EncryptionInfo.java:39)
    at model.JournalReader.readEntries(JournalReader.java:43)
    at JournalReaderTest.testReadEntries(JournalReaderTest.java:24)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
    at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
    at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
    at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
    at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
    at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
    at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
    at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
    at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:76)
    at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:195)
    at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)

Process finished with exit code -1 
```

POI 文档和 javadocs 一直没用。在考虑切换到 docx4j 的地方，我感到非常沮丧。这意味着将我所有的 .doc 文件转换为 .docx（当然，在适当的备份之后）。

我想知道是否有人成功使用 docx4j 读取加密的、受密码保护的文件。任何人？我只想得到一个肯定的答案，告诉我值得继续努力。

如果有人能看到我在 POI 上做错了什么，我也会很高兴知道这一点。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:28:30.850

**披露：我在 docx4j 上工作**

docx4j 的 OpcPackage 包含：

```
/**
 * Convenience method to create a WordprocessingMLPackage
 * or PresentationMLPackage
 * from an existing File (.docx/.docxm, .ppxtx or Flat OPC .xml).
 *
 * @param docxFile
 *            The docx file
 * @param password
 *            The password, if the file is password protected (compound)
 *            
 * @Since 2.8.0           
 */ 
public static OpcPackage load(final java.io.File docxFile, String password) throws Docx4JException 
```

它应该照顾受密码保护的部分。

我自己对 docx 文件的加密/解密没怎么玩。

# c++ - Windows 上的互斥体行为

> ID：12100737
> 
> 赞同：1
> 
> 时间：2012-08-23T22:12:42.413
> 
> 标签：c++, windows, mutex

我有以下代码...

在一台机器上它抛出 ERROR_ACCESS_DENIED 而在另一台机器上它抛出 ERROR_ALREADY_EXISTS （句柄不是 NULL）。我想了解为什么有两种不同的行为。在这两台机器上，用户都是本地系统管理员组的域用户。我尝试同时运行三个实例。

* * *

```
#include <windows.h>
#include<iostream>
using namespace std;

void * _hMutex = NULL;

void createMyMutex()
{
    _hMutex = CreateMutex( 
            NULL,              // default security attributes
            false,             // initially not owned
            L"LockTest");      // named mutex

        if (_hMutex == NULL) 
        {
            cout<< GetLastError()<< " Error creating mutex handle"<<endl;
            Exit(0);
        }
        if(GetLastError() == ERROR_ALREADY_EXISTS)
        {
            cout<< GetLastError()<< " Mutex already created" <<endl;
        }   
}

void Lock()
{
    cout<<"Acquiring Lock..."<< endl;
    if(_hMutex != NULL)
        WaitForSingleObject(_hMutex, INFINITE);
    cout<< "Acquired Lock." <<endl;
}

void Unlock()
{
cout<< "Releasing Lock..." <<endl;
    if(_hMutex != NULL)
       ReleaseMutex(_hMutex);
}

int main(int argc, char* argv[])
{

    cout<<"Creating lock"<<endl;
    createMyMutex();
    cout<<"Lock create success"<<endl;

    cout<<"Taking lock"<<endl;
    Lock();
    cout<<"Got the lock"<<endl;

    cout<<"Waiting for 20 seconds"<<endl;
    Sleep(20000);
    cout<<"Wait over"<<endl;

    cout<<"Releasing lock"<<endl;
    Unlock();
    cout<<"Lock released successfully"<<endl;

    cout<<"exiting the program"<<endl;
    return 0;
    } 
```

* * *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:23:14.520

来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682411%28v=vs.85%29.aspx)：

> 如果互斥体是命名互斥体并且该对象在此函数调用之前存在，则返回值是现有对象的句柄，GetLastError 返回`ERROR_ALREADY_EXISTS`，*bInitialOwner*被忽略，调用线程不被授予所有权。但是，如果调用者的访问权限有限，则该函数将失败，`ERROR_ACCESS_DENIED`调用者应使用 OpenMutex 函数。

因此，请尝试[`OpenMutex`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684315%28v=vs.85%29.aspx)仅使用`SYNCHRONIZE`访问权限。

另请注意，Windows 类型`BOOL`不同于 C++ 类型`bool`。所以你应该使用相应的值`TRUE`和`FALSE`调用 Windows API 函数时`BOOL`，**而不是** `true`和`false`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T08:14:52.037

我猜你得到了`ERROR_ALREADY_EXISTS`when call`createMyMutex();`和`ERROR_ACCESS_DENIED`when calls `Lock();`。我建议在全局命名空间中选择一个对象名称。所以你最好使用类似的东西

```
CreateMutex( NULL, FALSE, "Global\\LockTest" ); 
```

有关详细信息，请参阅[MSDN 上的对象命名空间](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684295%28v=vs.85%29.aspx)。

# asp.net-mvc-3 - 在 MVC3 区域中使用 Web 表单

> ID：12100738
> 
> 赞同：4
> 
> 时间：2012-08-23T22:12:44.990
> 
> 标签：asp.net-mvc-3, webforms, asp.net-mvc-areas

我正在尝试将旧的 ReportViewer Webform 集成到我当前的 MVC3 项目中。我希望它可以在`http://<server>/Reports/ViewReport.aspx`. 起初，我在项目的根目录中创建了一个名为 的文件夹`Reports`，将页面转储到那里，它工作得很好。

但是，我现在有一个 Area 也称为`Reports`，我必须删除该文件夹才能使默认路由正常工作。

如何配置我的路由，以使 Webform URL 看起来像是来自`Reports`我的项目中的其他地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:14:59.983

最简单的方法是使用**IIS URL Rewrite**模块。对您的应用程序的代码或路由没有任何更改。只需将您的网页放在某个也可访问的非 MVC 相关文件夹中。

[http://www.iis.net/download/urlrewrite](http://www.iis.net/download/urlrewrite)

但除此之外，您可以尝试将文件直接放在 area 文件夹中，因为`RouteCollection.RouteExistingFiles`默认情况下`false`这意味着您的文件*应该*由通常的 Asp.net Web 表单管道处理。

最重要的是，尽管您没有将文件放在配置了`System.Web.HttpNotFoundHandler`处理程序的文件夹中。默认情况下，视图文件夹具有这些配置，因此子文件夹树中的文件无法从请求级别访问。应用程序当然可以访问它们（这就是 MVC 的工作方式）。

# sql - Xquery SQL 包含

> ID：12100739
> 
> 赞同：2
> 
> 时间：2012-08-23T22:12:55.133
> 
> 标签：sql, xquery

我正在尝试为`ContentNode`包含逗号的所有节点查询以下 XML。

```
<Node xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.xxx.xxx.xxx">
  <SubNode>
    <SubSubNode>
      <ContentNode>Data, </ContentNode> 
```

以下返回 0 个结果：

`select * from Table where [XML].exist('/Node/SubNode/SubSubNode [contains(ContentNode[1],",")]')=1`

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T06:15:00.477

您有一个默认命名空间，您需要在查询中使用它。
看看[WITH XMLNAMESPACES (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms177607.aspx)

```
with xmlnamespaces(default 'http://schemas.xxx.xxx.xxx')
select *
from Table
where [XML].exist('/Node/SubNode/SubSubNode [contains(ContentNode[1],",")]')=1 
```

# eclipse - Eclipse WAS V7.0 开发工具 wsimport 错误

> ID：12100741
> 
> 赞同：3
> 
> 时间：2012-08-23T22:13:21.553
> 
> 标签：eclipse, web-services, websphere, jax-ws, wsimport

我正在尝试使用 WAS V7.0 开发工具从 WSDL 生成“自上而下的 EJB Web 服务”实现。（服务器运行时 WAS 7.0，Web 服务运行时 IBM WebSphere JAX-WS。）选择我的 EJB 和 EAR 项目并指定更多选项后，无论我的选项如何，我总是收到以下错误：

```
Errors occurred during wsimport.
java.lang.NoClassDefFoundError: com/sun/tools/internal/ws/wscompile/WsimportTool
at java.lang.ClassLoader.defineClass1(Native Method)
at java.lang.ClassLoader.defineClassCond(Unknown Source)
at java.lang.ClassLoader.defineClass(Unknown Source)
at java.security.SecureClassLoader.defineClass(Unknown Source)
at java.net.URLClassLoader.defineClass(Unknown Source)
at java.net.URLClassLoader.access$000(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at com.ibm.ast.ws.jaxws.emitter.jdk6.command.AbstractEmitterCommand.loadClass(AbstractEmitterCommand.java:166)
at com.ibm.ast.ws.jaxws.emitter.jdk6.command.WsImportCommand.execute(WsImportCommand.java:113)
at com.ibm.ast.ws.jaxws.emitter.command.WsImportCommand.execute(WsImportCommand.java:81)
at com.ibm.ast.ws.jaxws.creation.command.WsimportNonUIThreadCommand$RunCmdInNonUIThread.run(WsimportNonUIThreadCommand.java:284)
at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121)
Caused by: java.lang.ClassNotFoundException: com.sun.tools.internal.ws.wscompile.WsimportTool
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
... 16 more 
```

通过在 Rational Application Developer 7.5.1 中执行完全相同的步骤，我可以成功地为我的 WSDL 生成一个带有 HTTP 路由器模块的 EJB Web 服务实现。所以我认为这个问题可能与 WAS 开发者工具有关。

你们知道为什么我会收到这个错误吗？任何帮助将非常感激。

谢谢你，乔巴

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T04:35:04.693

确保在运行`wsimport`. 您的工作站上可能有多个 JVM。使用该命令时，下面的 JVM`<was install>/java`是您希望在 PATH 中领先于所有其他人的 JVM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T13:00:18.153

将 Eclipse 配置为使用 IBM 的 SDK 进行项目是不够的，我必须使用 IBM 的 JVM 启动 Eclipse。我编辑了 eclipse 的配置文件 (eclipse.ini) 并添加了 IBM 的 JRE。

```
openFile
-vm
...\IBM\WebSphere7\AppServer\java\bin\javaw.exe
-vmargs
-Dosgi.requiredJavaVersion=1.5
... 
```

[参考](http://websphereissues.wordpress.com/2012/07/13/secure-servers-are-only-supported-with-ibm-jre-6-0-or-above-error-in-eclipse-ide/)

# tridion - 无法在 Tridion 2011 SP1 中保存发布目标

> ID：12100744
> 
> 赞同：3
> 
> 时间：2012-08-23T22:13:48.810
> 
> 标签：tridion, tridion-2011

从 Tridion 5.3 SP1 升级到 Tridion 2011 SP1。

想要更改发布目标中提到的 Httpupload 页面 URL，但在保存时 Tridion 抛出错误

> 8004D025) 错误：引发了“System.EnterpriseServices.TransactionProxyException”类型的异常。无法保存目标类型 (tcm:0-2-65538).SQLUtilities.GetDatabaseConnectionDataStoreDAL.InitDataStoreBroker.InitDataStoreUtilitiesBL.InitDataStoreTargetTypeBL.UpdateTridion.ContentManager.IdentifiableObject.SaveThroughLegacyBL( String)Tridion.ContentManager.IdentifiableObject.Save(SaveEventArgs)Tridion.ContentManager.IdentifiableObject.Save()Tridion.ContentManager.BLFacade.IdentifiableObjectFacade.Update(UserContext,String)XMLState.SaveTargetType.Save

注意：我们能够更新组件和页面，但无法更新/创建新的发布目标以及目标类型

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T22:55:15.043

这很可能是 MSDTC 问题。检查您是否可以使用[DTCPing](http://support.microsoft.com/kb/918331)从 Tridion 服务器访问数据库服务器。

***更新***：其他有类似问题的人报告说这是由他们的 SQL Server 集群引起的，他们实际上需要在防火墙上打开端口 135 来接收单向消息，并打开端口 1024-5000 来接收响应消息。显然，Windows ODBC 数据源管理器比 DTCPing 更适合故障排除，因为它通过 SA 凭据、服务器和端口验证对特定数据库的访问。

# javascript - [^\/:] 的倒数 | 正则表达式改进

> ID：12100745
> 
> 赞同：1
> 
> 时间：2012-08-23T22:13:54.630
> 
> 标签：javascript, regex

这个字符集

```
[^\/:] // all characters except / or : 
```

每个 jslint bc 都很弱我应该指定可以使用的字符而不是这个[SO Post](https://stackoverflow.com/questions/4109214/jslint-insecure-in-regular-expression)不能使用的字符。

这是一个简单的非生产级域测试器，如下所示：

```
domain:         /:\/\/(www\.)?([^\/:]+)/, 
```

我只是在寻找一些关于如何思考这个问题的方向。该帖子提到允许使用无数的 Unicode 字符并不是一件好事……我如何制定一个更好地写这个的计划？

*我不关心我的域检查器的完整性（它只是一个原型）......我关心的是如何以不同的方式编写 reg-exes。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:31:18.613

根据[http://en.wikipedia.org/wiki/Domain_name#Internationalized_domain_names](http://en.wikipedia.org/wiki/Domain_name#Internationalized_domain_names)

> 域名系统中允许的字符集基于 ASCII

并根据[http://www.netregister.biz/faqit.htm#1](http://www.netregister.biz/faqit.htm#1)

> 要命名您的域，您可以使用任何字母、0 到 9 之间的数字和符号“-”[只要第一个字符不是“-”]

并考虑到您的域必须以*.something 结尾*，您正在寻找

```
([a-zA-Z0-9][a-zA-Z0-9-]*\.)+[a-zA-Z0-9][a-zA-Z0-9-]* 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:27:43.223

这是您可以拥有的字符的正则表达式：

```
mycharactersarecool[^shouldnothavethesechars](oneoftwooptions|anotheroption) 
```

这就是你在说的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T22:24:45.220

这对谷歌来说是一个很好的问题，你知道......但只是为了弄湿你的嘴：Matthew O'Riordan 编写了这样的正则表达式，数学与协议或不协议相关。

这是[他的博客文章的链接](http://blog.mattheworiordan.com/post/13174566389/url-regular-expression-for-links-with-or-without-the)

但为了将来参考，让我在这里也提供帖子中的正则表达式：

```
/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[.\!\/\\w]*))?)/ 
```

博客作者马修本人也很好地分解了：

```
(
 ( # brackets covering match for protocol (optional) and domain
  ([A-Za-z]{3,9}:(?:\/\/)?)   # match protocol, allow in format http:// or mailto:
  (?:[\-;:&=\+\$,\w]+@)?   # allow something@ for email addresses
  [A-Za-z0-9\.\-]+   # anything looking at all like a domain, non-unicode domains
  | # or instead of above
  (?:www\.|[\-;:&=\+\$,\w]+@) # starting with something@ or www.
  [A-Za-z0-9\.\-]+   # anything looking at all like a domain
 )
 ( # brackets covering match for path, query string and anchor
  (?:\/[\+~%\/\.\w\-]*)  # allow optional /path
  ?\??(?:[\-\+=&;%@\.\w]*)  # allow optional query string starting with ? 
  #?(?:[\.\!\/\\\w]*) # allow optional anchor #anchor 
 )? # make URL suffix optional
) 
```

## 你的具体例子呢

但在您计算 URL 域的情况下，否定的`[^\/:]`可能只是：

```
[-0-9a-zA-Z_.] 
```

这应该匹配 // 之后和第一个 / 之前的所有内容。但是，当您的 URL 不以斜杠结尾时会发生什么？在这种情况下你会怎么做？

上正则表达式（简化）只匹配一个字符，就像您的否定字符集一样。因此，这只是替换了您正在使用的完整 reg ex 中的否定集。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T22:25:08.177

> *“我应该指定可以使用的字符而不是不能使用的字符”*

不，那是胡说八道，只是 JSLint 是 JSLint。

当您`[^\/:]`在正则表达式中看到它时，它在做什么是显而易见的。如果您尝试列出所有可能*允许*的字符，则生成的正则表达式将非常难以阅读，并且很容易意外忘记包含某些字符。

如果您有一组特定的允许字符，那么可以列出它们。这比试图列出所有可能的无效字符更容易、更可靠。

但是，如果您有一组特定的无效字符，则`[^]`语法是执行此操作的适当方法。

# ios - 如何将所有文件从 NSDocumentDirectory 移动到 NSCachesDirectory？

> ID：12100749
> 
> 赞同：1
> 
> 时间：2012-08-23T22:14:22.383
> 
> 标签：ios, objective-c, appstore-approval, nsdocumentdirectory

我正在尝试将驻留在 NSDocumentDirectory 中的所有文档移动到 NSCachesDirectory，然后在我的应用程序的下一个版本更新的第一个应用程序启动时删除所有这些 NSDocument 文件。我这样做的唯一原因是遵守 Apple 的 iOS 数据存储指南，因为我的应用更新因将 .PDF 文件保存到 NSDocumentsDirectory 而被拒绝（我不知道为什么，因为在此之前该应用从未被拒绝过）更新（应用程序已经快 2 年了，从第一天开始我就一直以这种方式保存 .PDF），也许我有一个严格的审阅者？）

我需要将所有用户已经下载的 .PDF 文件移动到 NSCachesDirectory，然后从 NSDocumentDirectory 中删除它们。

有没有一种简单的方法可以完成？

预先感谢您提供的任何帮助。

我试过这个：

```
NSFileManager *fileManager = [NSFileManager defaultManager];

NSError *error;
NSUserDefaults      *Defaults;
 int                 launchCount;

 Defaults = [NSUserDefaults standardUserDefaults];
 launchCount = [Defaults integerForKey:@"launchCount" ] + 1;
 [Defaults setInteger:launchCount forKey:@"launchCount"];
 [Defaults synchronize];

if(launchCount == 1) {

NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];

NSArray *path2 = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);
NSString *dest = [path2 objectAtIndex:0];

NSArray *Contents = [fileManager contentsOfDirectoryAtPath:documentsDirectory error:&error];

    for(NSString *source in Contents)
    {
        if(![fileManager moveItemAtPath:source
                                 toPath:dest
                                  error:&error])
        {
            //TODO: Handle error
            NSLog(@"Error: %@", error);
        }
    }
} 
```

但我在控制台中收到此错误：

NSFilePath=Test.pdf, NSDestinationFilePath=/Users/Charley/Library/Application Support/iPhone Simulator/5.1/Applications/96EB01D1-81B7-4ECE-B337-D2D663969EE3/Library/Caches, NSUnderlyingError=0xb566d50 "操作无法完成。 文件已存在”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:29:00.540

是的，使用 NSFileManager：

获取您的文档路径和缓存路径。遍历所有文件，并使用 NSFileManager 移动它们

```
- (void) moveAllDocs {
    NSFileManager *fileManager = [NSFileManager defaultManager];

    NSError *error = nil;

    NSString *sourceDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
    NSString *destinationDirectory = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) lastObject];

    NSArray *contents = [fileManager contentsOfDirectoryAtPath:sourceDirectory error:&error];

    for(NSString *sourceFileName in contents) {
        NSString *sourceFile = [sourceDirectory stringByAppendingPathComponent:sourceFileName];
        NSString *destFile = [destinationDirectory stringByAppendingPathComponent:sourceFileName];
        if(![fileManager moveItemAtPath:sourceFile toPath:destFile error:&error]) {
            NSLog(@"Error: %@", error);
        }
    }

} 
```

# javascript - 在 onclick 函数中使用“this”

> ID：12100753
> 
> 赞同：4
> 
> 时间：2012-08-23T22:14:53.680
> 
> 标签：javascript, jquery, onclick, this

我有在页面加载后动态添加的 TR。单击它们时，我想向它们添加“活动”类。这是我到目前为止所拥有的：

```
<tr onClick="makeActive(this);"><td>....</td></tr>

<script>
function makeActive(element){$('.Active').removeClass('Active');element.addClass('Active');}
</script> 
```

该函数运行，并从当前应用它的任何行中删除“活动”类......但它无法将该类添加到单击的行。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-23T22:16:41.847

`this`引用一个 DOM 元素，你必须先将它包装在一个 jQuery 对象中，然后才能对其应用 jQuery 方法。

```
$(element).addClass('Active'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T22:16:41.497

你很接近：

```
<tr onClick="makeActive(this);"><td>....</td></tr>

<script>
function makeActive(element){
    $('.Active').removeClass('Active');
    $(element).addClass('Active');
}
</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T22:20:46.410

尝试：

```
$(element).addClass('Active'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T22:17:08.290

```
$(element).addClass('Active'); 
```

# php - PHP fwrite制表符分隔的文本文件不正确

> ID：12100755
> 
> 赞同：0
> 
> 时间：2012-08-23T22:15:07.817
> 
> 标签：php, mysql, csv, fwrite

我正在尝试编写一个制表符分隔的文本文件。其中一个字段是包含 HTML 的产品描述，它会导致问题（我没有进行测试，但效果很好）。在第 95 行，结构中断。我检查了第 95 行的字段，它是纯文本（没有中断或制表符）。

某些东西导致文件混乱。我尝试过修剪、strip_tags、utf8_encode、删除多个空格并通过“/n”将字符串吐入数组中（然后内爆）。

我的代码：

```
///////////// Get product data from database and store as array /////////////

$products = array();
$c=0;

    $fprod = mysql_query("SELECT id,name,desc FROM products");
    while ($sprod = mysql_fetch_array($fprod)) {

    $products[$c]["id"] = trim($sprod["id"]);
    $products[$c]["name"] = trim($sprod["name"]);

    // strip product description field (the part that doesn't work)

        $prod_desc_a = utf8_encode(strip_tags($sprod["desc"]));    

        // convert any breaks or tabs to \n, explode by \n and then implode

        $prod_desc_b = str_replace(array("\r\n", "\r", "\t", " \t "), "\n", $prod_desc_a);
        $lines = explode("\n", $prod_desc_b);
        $new_lines = array(); 

        foreach ($lines as $i => $line) {
        if(!empty($line))
        $new_lines[] = trim($line);
        }

    $prod_desc_c = implode($new_lines);

// finally remove any multiple spaces and store in array

$prod_desc_final = preg_replace('/\s+/', ' ',$prod_desc_c);

$products[$c]["desc"] = $prod_desc_final;

$c++;
}

///////////// Write the file /////////////

$myFile = "feeds/froogle.txt";
$fh = fopen($myFile, 'w');

    $newline= " \n ";
    $tab= " \t ";

    foreach ($products as $product) {
    $this_line = $product[id] . $tab. $product[name] . $tab . $product[desc] . PHP_EOL; 
    fwrite($fh, $this_line);     
    $this_line = '';
    }

fclose($fh); 
```

任何想法为什么当我导入 Excel 或 Google 文档时文件会中断？非常感谢。

# ruby-on-rails - 审查系统，has_many，belongs_to

> ID：12100756
> 
> 赞同：0
> 
> 时间：2012-08-23T22:15:09.747
> 
> 标签：ruby-on-rails

我很遗憾地遇到了这个问题，当我尝试创建评论时，Product_id 保持为零。为我要审查的产品填写此内容的最简洁方法是什么？

评论_控制器

```
def create
@user = current_user
@review = @user.reviews.new(params[:review])
if @review.save
  redirect_to products_path, notice: 'Thank you for your review'
else
    render 'new'
  end
end 
```

我的产品、评论和用户设置了 has_many 和 belongs_to 关系。

审查的新观点

```
%h1 Write a Review

= form_for @review do |f|
  %fieldset
    = f.label :review
    = f.text_area :review
  %fieldset
    = f.label :rating
    = f.text_field :rating
  %fieldset
    = f.submit 'Post Review', class: 'btn btn-large btn-primary' 
```

我知道我没有找到产品 - 我该如何找到它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:18:34.187

由于您是通过关联创建对象，因此使用 build

```
 @review = @user.reviews.build(params[:review]) 
```

这将提取用户的 id 并将其添加到您的评论对象中的 user_id 中。我需要更多信息来查找产品，您很可能可以在您的评论表单中添加一个隐藏字段，该字段将具有产品 ID

```
 <%= hidden_field :product, @product.id %> #not sure how you are currently finding your product 
```

# routing - Symfony Propel 1.4 第一条规则覆盖 routing.yml 中的下一条规则

> ID：12100759
> 
> 赞同：0
> 
> 时间：2012-08-23T22:15:39.850
> 
> 标签：routing, symfony-1.4

我在 routing.yml 中有几条规则

```
homepage:
  url:   /
  param: { module: cars, action: index }

letters:
  url: /:letter
  class: sfPropelRoute
  options:
    model: MyCarmodelPeer
    type: object
  param:
    module: cars
    action: alphalist
    linkmode: "@letters"
  requirements:
    letter: "([A-Z])"
    sf_method: [get]

show:
  url: /:slug
  class: sfPropelRoute
  options:
    model: MyCarmodelPeer
    type: object
  param:
     module: cars
     action: view
  linkmode: "@show"
  requirements:
   slug: "([A-Z]|0-9)"
   sf_method: [get]

default:
   url:   /:module/:action/* 
```

到主页的路由按预期工作。但是字母和显示路线无法正常工作。如果第一个路由字母那么它工作正常，并且路由显示不起作用。**在这种情况下，我在解析 URL“/bmw-1-series-187-5-120-2004-2008”(/) 后**出现错误空模块和/或操作。 如果我重新排列它们，那么字母指向一个动作视图，但它应该指向动作字母表。

为什么它们会互相覆盖？

**更新**

这是另一个网站上的一个案例，它有效。

```
letters:
  url: /:letter
  param:
    module: define
    action: alphalist
    linkmode: "@letters"
    cachename: "letters"
    layer: "@default-layer"
  requirements:
    letter: "([A-Z]|0-9)"

disclaimer:
  url: /medical-disclaimer/
  param:
    module: define
    action: disclaimer

default-layer:
  url: /:search
  param:
    module: define
    action: word
    linkmode: "@default-layer"
    cachename: "default-layer"
  options:
    segment_separators: ['', '/'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T07:28:31.503

它们相互覆盖，因为 symfony 尝试解决它的方式是相同的。

您定义`url: /:slug`了 for `show`，这意味着 url 将是`/`和之后的东西，例如`/foo`, `/toto`。但是你也定义了这种 url for ，`letters` `/:letter`它也可以匹配 for ！`/foo``/toto`

这就是为什么当您首先定义`show`路线时，`show`有效但`letters`无效。反之亦然。

您必须解决的方法是为每条路线定义**唯一的**url。就像是：

```
letters:
  url: /letters/:letter

show:
  url: /show/:slug 
```

这样，由于前缀（字母和显示），每条路线都不会互相*吃掉。*

**编辑：**

我明白了，您的要求可以帮助 symfony 匹配一个 url，即使两者都有 with `/:slug`。

对于`letter`路线，您的要求只允许一个大写字母。但是对于`show`路线，它允许一个字母大写或一个数字。关于您的网址 ( `bmw-1-series-187-5-120-2004-2008`)，这是错误的。

试试这个要求，对于`show`路线（你可以删除我之前给出的前缀）：

```
 requirements:
   slug: "([a-z0-9\-]+)" 
```

# xcode - Xcode如何使用UIScroll在背景触摸时关闭键盘

> ID：12100760
> 
> 赞同：0
> 
> 时间：2012-08-23T22:15:52.193
> 
> 标签：xcode, uiscrollview

这让我发疯。想出了如何在滚动时关闭键盘，但无法让水龙头工作。

在我的 .h;

```
- (IBAction)backgroundTap:(id)sender;
@property (weak, nonatomic) IBOutlet UITextField *numberTextField; 
```

在他们中

```
 - (IBAction)backgroundTap:(id)sender {
        [numberTextField resignFirstResponder];

    }
- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView {
    [numberTextField resignFirstResponder];
} 
```

将 backgroundTap 链接到 UIControl 不起作用。如上所述，scrollViewWillBeginDragging 确实有效。如何让 backgroundTap 工作？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:21:33.663

您确定正在调用 backgroundTap 方法吗？它是否附加到已启用用户交互的 UIView 上？

您还可以使用...

```
 [self.view endEditing:YES]; 
```

...这将适用于多个文本字段，因此您不必弄清楚哪个文本字段是第一响应者并准确指定要辞职的文本字段。

# java - 使用模式中不存在的属性生成 XML

> ID：12100764
> 
> 赞同：2
> 
> 时间：2012-08-23T22:16:14.087
> 
> 标签：java, xml, jaxb

我正在使用 JAXB 生成 OpenOffice XML，并且需要将`xml:space="preserve"`属性应用于`t`元素。

```
 <r>
        <t>
            foo
        </t>
    </r> 
```

应该

```
 <r>
        <t xml:space="preserve">
            foo
        </t>
    </r> 
```

我使用 JAXB 从 Open Office 模式生成 Java 类。`<t>`type 在 CTRElt Java 类中表示为 String，因此无法设置此属性。当我从现有文档中解组并编组时，以前存在的`space`属性不再存在。

架构的相关部分如下：

`<xsd:element name="t" type="ST_Xstring" minOccurs="1" maxOccurs="1"> <xsd:annotation> <xsd:documentation>Text</xsd:documentation> </xsd:annotation> </xsd:element>`

`<xsd:simpleType name="ST_Xstring"> <xsd:annotation> <xsd:documentation>Escaped String</xsd:documentation> </xsd:annotation> <xsd:restriction base="xsd:string" /> </xsd:simpleType>`

如何生成具有此必需`space`属性的 XML？修改架构不是一种选择。我需要自定义 JAXB 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T13:07:28.973

我最终生成了 XML 并使用正则表达式来添加属性:(

# ruby-on-rails - 如果结果包含正则表达式特殊字符，为什么我不能对扫描的每个结果执行 gsub？

> ID：12100765
> 
> 赞同：0
> 
> 时间：2012-08-23T22:16:18.560
> 
> 标签：ruby-on-rails, ruby

这是“[这个包含数学符号的正则表达式有什么问题？（Ruby/Rails）](https://stackoverflow.com/questions/11909567/whats-wrong-with-this-regular-expression-containing-math-symbols-ruby-rails/) ”的变体。

我不明白为什么`scan`后面的 a对加号 ( )`gsub`不起作用。当模式包含其他正则表达式特殊字符（如星号 ( ) 和插入符号 ( )`+`时，它也会失败。`*``^`

```
~ > irb
>> text = %(test &radic;x+1 &radic;x-1 &radic;x&times;1 &radic;/1)
=> "test &radic;x+1 &radic;x-1 &radic;x&times;1 &radic;/1"
>> radicals = text.scan(/&radic;[^\s]*/)
=> ["&radic;x+1", "&radic;x-1", "&radic;x&times;1", "&radic;/1"]
>> radicals.each do |radical|
?>   text = text.gsub(/#{radical}/, 'hello')
>> end
=> ["&radic;x+1", "&radic;x-1", "&radic;x&times;1", "&radic;/1"]
>> text
=> "test &radic;x+1 hello hello hello" 
```

正如您在第五行中看到的那样，它`scan`找到了带有加号 ( `+`) 的匹配模式，但是当我尝试`gsub`对每个结果执行时，带有加号的模式被忽略了。关于这里发生了什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:23:55.757

当您将字符串替换为具有该`/#{string}/`样式的正则表达式时，特殊字符（如`+`）不会被转义。我希望你想使用：

```
radicals.each do |radical|
    text = text.gsub(/#{Regexp.escape(radical)}/, 'hello')
end 
```

希望这可以帮助！

# c# - 如何在 WPF DataGRID 的特定单元格中设置文本颜色

> ID：12100769
> 
> 赞同：0
> 
> 时间：2012-08-23T22:16:34.687
> 
> 标签：c#, wpf, xaml, datagrid

我有一种方法可以比较两个数据表中的数据。比较之后，我想在 WPF dataGRID 中可视化这些比较数据（位于名为 ChangeTab 的新 DataTable 中）。

我正在从 DataContext 填充数据网格：

```
win.TableOfChange.DataContext = ChangeTab.DefaultView; 
```

```
<DataGrid ItemsSource="{Binding}" Height="107" HorizontalAlignment="Left".... 
```

我正在与问题作斗争，如何用红色可视化不同的数据（在 DataTables 中），以及与绿色相同的数据 - 图片中类似：

![在此处输入图像描述](../Images/c2c52d2dd92b59c215c68bcf3ee29826.png)

有没有办法，如何做到这一点（将颜色设置为 WPF dataGRID 单元格，以获得 C# 中的一些红色和一些绿色）？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:22:40.807

我假设您在比较过程中构建了源表，如果是这样，您可以轻松存储一个表示相等的布尔值。然后，[`CellStyle`](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.cellstyle.aspx)您可以[`DataTrigger`](http://msdn.microsoft.com/en-us/library/system.windows.datatrigger.aspx)在该属性上使用 a[`Setter`](http://msdn.microsoft.com/en-us/library/system.windows.setter.aspx)并将该[`TextElement.Foreground`](http://msdn.microsoft.com/en-us/library/system.windows.documents.textelement.foreground.aspx)属性更改为所需的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:27:11.757

我倾向于对网格中的大多数列使用 DataTemplates。您需要创建一个类，如下所示：

```
class CellContent
{
    public object Content { get; set; }
    public bool IsDifferent { get; set; }
} 
```

然后创建一个类似这样的数据模板：

```
<DataTemplate x:Key="bob">
    <ContentPresenter Content="{Binding Path=Content}" TextElement.Foreground="{Binding Path=IsDifferent, Converter={StaticResource myConverter}}" />
<DataTemplate> 
```

然后将模板分配给每一列。

如果 IsDifferent 为真，另一个可能更好的选项是使用触发器来更改颜色。

# http - Node.JS：流式 HTTP 客户端请求正文？

> ID：12100773
> 
> 赞同：0
> 
> 时间：2012-08-23T22:16:55.747
> 
> 标签：http, node.js, stream, client

我想通过 HTTP 连接在 Node.JS 客户端和 Node.JS 服务器之间创建双向流。但似乎`request`直到客户端调用服务器的事件才被调用`req.end()`。如何建立双向通信？我需要使用单独的请求吗？

澄清：我的期望是有可能

1.  客户端发送请求头，
2.  发送响应头的服务器，以及
3.  服务器和客户端随时发送字节。

编辑：好的，这是选项的摘要：

*   **单独端口上的 TCP 套接字：**如果您不介意打开单独的端口，然后修改以前使用的 HTTP（请求路径和标头以及响应标头）以改用流，这很好。（我拒绝了这个选项。）

*   **单独**的 HTTP 请求，每次需要刷新时结束请求。管理状态将在应用程序中完成，因为现在结束的连接将不再代表结束的会话。（短期内，我会使用这个选项。）

*   **Socket.IO**（是**WebSockets** +反向兼容的实现）：这个选项很吸引人，但是需要在HTTP层前面加上Socket.IO层。Socket.IO 将通过所有 HTTP 请求，但 WebSocket 请求的处理方式不同。（从长远来看，我将使用此选项，但我必须修改我的前端以允许这样做。）

    据我了解，Node.JS`http`库不允许我发送响应标头，除非客户端已经完成（或至少基本上开始）发送请求正文。我想这是有充分理由的，所以第三个选项也可以命名**为在`http`库前面添加一个图层。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:21:23.280

如果您真的在寻找双向通信系统，那么 HTTP 并不是真正正确的协议。整个想法是它是无状态的并且一次处理 1 个请求。这条规则也有例外，但这些确实超出了 HTTP 应该做的事情，并且可以被认为是 hack。

听起来你应该使用像[Socket.IO这样的东西](http://socket.io/)

# java - 获取用户位置 Android

> ID：12100780
> 
> 赞同：0
> 
> 时间：2012-08-23T22:17:39.640
> 
> 标签：java, android, gps, locationmanager, android-location

我正在尝试根据网络提供商获取用户位置，但该事件从未发生，并且该`UpdateLocation()`方法永远不会被调用。这是代码：

```
public void UpdateLocation(Location location)
{
    GeoPoint geoPoint = new GeoPoint((int)(location.getLatitude() * 1E6),(int)(location.getLongitude() * 1E6));
    MapController controller = mapView.getController();
    controller.setCenter(geoPoint);
}
public void GetLocation()
{
     // Acquire a reference to the system Location Manager
    LocationManager locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

    // Define a listener that responds to location updates
    LocationListener locationListener = new LocationListener() {
        public void onLocationChanged(Location location) {
          // Called when a new location is found by the network location provider.
          UpdateLocation(location);
        }

        public void onStatusChanged(String provider, int status, Bundle extras) {}

        public void onProviderEnabled(String provider) {}

        public void onProviderDisabled(String provider) {}
      };

    // Register the listener with the Location Manager to receive location updates
    locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationListener);
} 
```

可能是什么问题呢？我在这里做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:27:12.247

如果我没记错的话，NETWORK_PROVIDER 使用 wifi 信号来确定位置。

需要验证的几件事：

*   wifi开了吗？
*   设备是否注册了 wifi 信号？超过一个？（一个可能还不够）
*   设置中的“定位服务”是否勾选了“使用无线网络”？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:29:38.253

在请求位置之前，您应该检查您的位置提供程序是否已启用：

```
locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER); 
```

看看这个教程。它包括[示例代码](http://developer.android.com/training/basics/location/currentlocation.html)

# c++ - Redefine(#define) 保留的 c++ 关键字

> ID：12100789
> 
> 赞同：0
> 
> 时间：2012-08-23T22:19:02.977
> 
> 标签：c++

是否可以使用#define 重新定义 c++ 关键字？

```
#ifdef int
#undef int 
#define int 2
#endif
int main(){
    //Do something with int
} 
```

在这种情况下我看不到输出，但我想了解内部发生了什么。我没有#define 的原因是我发现如果您不使用标准头文件，可以#define 保留关键字。我还尝试运行以下代码。

```
#include<iostream>
using namespace std;
#ifdef int
#undef int 
#endif
int main(){
    cout<<int;
} 
```

但是上面的 te 在 cout 行抛出错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:26:52.070

是否可以？是的。是不是很好的风格？绝对不。

预处理器不知道 C/C++ 关键字，它只知道预处理器标记并且只进行严格的文本替换。

您的示例导致错误，因为您正在执行`#undef`它。一旦取消定义它，它就会恢复到以前的行为。

我知道做这样的事情的唯一有效用途是[解决旧编译器中的错误](https://stackoverflow.com/questions/984878/what-is-the-possible-use-for-define-for-if-false-else-for)，而现在该编译器不再相关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:33:03.813

从技术上讲，它可以工作，但它可能对你没有多大好处。如果要使用标准 C++ 库，则不允许根据 17.6.4.3.1 [macro.names] 第 2 段定义任何关键字或任何一组其他名称：

> 翻译单元不得在词汇上与关键字、表 3 中列出的标识符或 7.6 中描述的属性标记相同的#define 或#undef 名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:28:27.683

你*可以*，但你不应该。

在您的示例中，`int`不会重新定义，因为它包含在`#ifdef int`. 这意味着“只有在已经有一个名为`int`”的预处理器宏时才这样做，而没有。

如果你刚刚写了`#define int 2`，那么所有出现的`int`都会被替换为`2`; 但是您的代码将无法编译，因为这`2 main() {cout<<2;}`是无稽之谈。

`#undef`不会从语言中删除关键字；它只删除以前使用定义的预处理器宏`#define`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-16T15:29:14.590

如果您不使用标准库，则可以这样做。事实上，预处理器不应该区分保留字和非保留字。

但是，这可能不是您遇到问题的原因。首先，您的示例并没有按照您的想法进行。错误在于`int`通常不是预处理器定义的宏。因此，该`#ifdef int`指令将跳过以下几行直到终止`#endif`。

这意味着您的第二个示例扩展为：

```
// stuff from iostream and possibly other headers 

int main(){
    cout<<int;
} 
```

错误是`cout<<int;`根本不允许这样做。

# c# - $.get 没有从控制器成功

> ID：12100792
> 
> 赞同：0
> 
> 时间：2012-08-23T22:19:28.210
> 
> 标签：c#, jquery, asp.net-mvc, razor

我有一个javascript如下

```
$('#MessageContent').replaceWith("Hi there"); //just sets value to Hi There

    $('body').delegate('#MessageDesc', 'change', function () {
        var sMessageTypeID = $("#MessageDesc").val();
        $.get('@Url.Action("GetMessageContent")', { MessageTypeID: sMessageTypeID }, function (data) {
            $('#MessageContent').replaceWith(data); //should replace hi there with a value
        });
    }); 
```

它应该用返回的内容替换名为“MessageContent”的文本框中的内容。

我的控制器动作看起来像这样

```
public ActionResult GetMessageContent(long MessageTypeID)
    {
        tblMessageType tblMessageType = db.tblMessageTypes.Single(t => t.MessageTypeID == MessageTypeID);
        return View(tblMessageType.MessageContent);
    } 
```

我已经验证 tblMessageType.MessageConent 中的值看起来不错！我很确定问题出在控制器上，而不是 JavaScript。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:24:38.347

首先，确保您的控制器动作被调用，然后尝试返回一个简单的`JsonResult`。

像这样的东西：

```
public JsonResult GetMessageContent(long MessageTypeID)
{
    tblMessageType tblMessageType = db.tblMessageTypes.Single(t => t.MessageTypeID == MessageTypeID);

    return Json(tblMessageType.MessageContent, JsonRequestBehavior.AllowGet);
} 
```

尝试替换此行：

```
$('#MessageContent').replaceWith(data); 
```

有了这个：

```
$('#MessageContent').text(data); 
```

或者

```
$('#MessageContent').val(data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:27:23.643

您的帖子中没有足够的信息来提供确凿的答案，但请尝试以下方法：

*   确保没有 JavaScript 错误（例如在 IE9 中，使用 F12 工具的脚本选项卡）
*   查看 HTTP 流量（同样在 IE9 中，您可以使用 F12 工具）。查看您返回的 HTTP 状态。200=正常，404=未找到，401=未授权，500=错误
*   在控制器操作中设置断点。
*   确保正在调用该操作。
*   确保正确填充操作的参数。
*   确保控制器中没有抛出异常。
*   确保视图不会返回“您好”；-)

# objective-c - 本地化嵌套的 Info.plist 键

> ID：12100794
> 
> 赞同：5
> 
> 时间：2012-08-23T22:19:29.780
> 
> 标签：objective-c, macos, cocoa, internationalization, plist

我正在尝试本地化包含嵌套字典的 InfoPlist.strings 文件中的键，如下所示：

```
baseKey = {
    secondDict = {
        "key" = "value";
    };
}; 
```

有什么方法可以直接从 InfoPlist.strings 文件访问内部键？

```
"baseKey.secondDict.key" = "newValue"; 
```

似乎不起作用...有什么想法吗？我知道我可以在字符串文件中复制字典结构，但它包含一些我不希望在其中包含的其他信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-09-25T08:21:14.073

显然它是这样工作的：

替换`"value"`为一些本地化标识符`newvalue_i18n_key`。

然后，在每种语言的 InfoPlist.strings 中，执行以下操作：

`newvalue_i18n_key = "value";`

这更类似于 NSLocalizedString 的工作方式。根据我的阅读，这**不是**Apple 在[官方文档中关于本地化 plist 文件](https://developer.apple.com/library/ios/documentation/General/Reference/InfoPlistKeyReference/Articles/AboutInformationPropertyListFiles.html#//apple_ref/doc/uid/TP40009254-102276)的内容，而是 Apple 在[一些示例代码中所做的。](https://developer.apple.com/library/prerelease/ios/samplecode/ApplicationShortcuts/Introduction/Intro.html#//apple_ref/doc/uid/TP40016545-Intro-DontLinkElementID_2)

[这个问题](https://stackoverflow.com/questions/32569705/how-localise-the-key-uiapplicationshortcutitemtitle)得到了相同的答案。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-28T10:27:25.503

您可以通过这种方式快速访问嵌套值，其中“用户”是 NSDictionary 的键，“用户名”是 NSString 的键。

```
yourDict[@"User"][@"Username"] 
```

# android - Cordova 2.0 loadUrl 不会重新加载

> ID：12100800
> 
> 赞同：1
> 
> 时间：2012-08-23T22:19:57.517
> 
> 标签：android, cordova, cordova-2.0.0

我正在尝试将 phonegap/cordova（2.0 版）与 Android 一起使用来加载外部 URL。我传递的 URL 重定向到第二个 URL（例如 hhtp://google.com 重定向到[http://google.your-country-iso-code](http://google.your-country-iso-code)）。

```
public class MainActivity extends DroidGap {
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        super.loadUrl(http://mywebsite.com);
    }
    ...
} 
```

当我第一次打开应用程序时，它会毫无问题地加载 webapp。之后，再次打开应用程序，将不会再次加载网络。它只会挂起（即使在强制进程关闭并重新打开应用程序之后）。它使用[http://google.com](http://google.com)但不是我需要加载的网址。

如果我从 onRestart 调用 loadUrl （从另一个活动返回），同样的事情：

```
public void onRestart() {
    super.onRestart();
    super.loadUrl(urlToLoad);
} 
```

我错过了什么？

我也试过这个：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    super.init();
    super.appView.clearCache(true);
    //super.setBooleanProperty("loadInWebView", false);
    super.loadUrl(getWebAppUrl());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T10:25:08.927

检查 config.xml 文件中的访问源值：

如果您尝试访问外部 url，它应该如下所示

```
<access origin=".*"/> 
```

# perl - 如何使用 Perl 通过套接字发送逐字请求？

> ID：12100805
> 
> 赞同：2
> 
> 时间：2012-08-23T22:20:34.687
> 
> 标签：perl, http, httprequest

我需要发送与我指定的格式完全一致的请求，包括空格。实现这一目标的最佳方法是什么？

我要发送的请求类型示例：

```
GET
/
key=val
Host:example.com 
```

该协议是一个简单的请求-响应协议，如 HTTP。我宁愿尽可能利用 LWP 的现有代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:33:02.277

也许您可以使用[IO::Socket::INET](http://search.cpan.org/~gbarr/IO-1.25/lib/IO/Socket/INET.pm)模块。这是一个使用它的简短[示例](http://www.rocketaware.com/perl/perlipc/TCP_Clients_with_IO_Socket.htm)：

```
#!/usr/bin/perl
use IO::Socket;
my $host = '127.0.0.1'; # an example obviously
my $remote = IO::Socket::INET->new( 
   Proto     => "tcp",
   PeerAddr  => $host,
   PeerPort  => "http(80)",
);

my $message = <<MSG;
GET
/
key=val
Host:example.com
MSG
unless ($remote) { die "cannot connect to http daemon on $host" }
$remote->autoflush(1);
print $remote $message;
while ( <$remote> ) { print }
close $remote; 
```

换句话说，在协议层次结构中走低一点。)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T22:40:49.933

我认为这是可以通过 LWP 实现的。老实说，这有点工作。

我已经看过了，您需要实际实现自己的协议（请参阅 参考资料`LWP::Protocol`），因为这是创建实际请求的地方。之后，您需要启用该协议作为 http（或 https）的实现者：

```
LWP::Protocol::implementor('http', 'MyFunkyProtocol'); 
```

例如，看一下`LWP::Protocol::GHTTP`代码。

简单地说，您需要创建一个实现`request`方法的包。在该方法中，您需要组装请求、打开连接、发送并接收响应。

* * *

这是一个简单的工作示例。

MyFunkyProto.pm:

```
package MyFunkyProto;

use LWP::Protocol;
@ISA = qw/LWP::Protocol/;

use HTTP::Response;
use IO::Socket;
use Carp qw/croak/;

sub request
{
    my ($self, $request, $proxy, $arg, $size, $timeout) = @_;

    my $remote = IO::Socket::INET->new(
        Proto     => "tcp",
        PeerAddr  => "example.com",
        PeerPort  => "http(80)"
    ) or croak('unable to connect');

    my $message = <<EOF;
GET
/
key=val
Host:example.com
EOF

    $remote->print($message);
    $remote->flush();

    local $/;
    my $resp = HTTP::Response->parse(<$remote>);

    $remote->close();

    return $resp;
};

1; 
```

脚本.pl：

```
#!/usr/bin/env perl

use strict;
use warnings;
use lib '.';

use MyFunkyProto;
use LWP::Protocol;
use LWP::UserAgent;

LWP::Protocol::implementor('http', 'MyFunkyProto');

my $fr = HTTP::Request->new('GET', 'http://www.example.com/');
my $ua = LWP::UserAgent->new();

my $r = $ua->request($fr);
print $r->as_string(); 
```

请注意，您实际上会想要从`$request`对象构造请求（并获取主机和端口）。或者，如果您很懒惰，只需将其存储在该对象中的某个位置即可。

# r - 在 R 中读取 OLE？

> ID：12100813
> 
> 赞同：5
> 
> 时间：2012-08-23T22:21:29.050
> 
> 标签：r, oledb

我正在尝试读取以[OLE 格式](http://en.wikipedia.org/wiki/Object_Linking_and_Embedding)编码的文件。**它不是**我只能找到阅读器的 Microsoft Office/通用文件格式。

我正在尝试编写自己的阅读器 - 我有文件的规范，但需要能够在文件中打开 OLE 存储/流。

有谁知道可以帮助解决这个问题的**R**包（读取 OLE 流）？

# c++ - C++ 管理对象

> ID：12100816
> 
> 赞同：4
> 
> 时间：2012-08-23T22:21:39.737
> 
> 标签：c++, class, object, delete-operator

我有一个游戏服务器。它创建多个实例`Game`并将它们（或指向它们的指针？什么更好？它有 10 个`ints`和 5 个其他指针，10 个成员函数）添加到向量中。之后一些事件发生在游戏内部，例如game_ends。此时应该从向量中删除游戏......实现它的最佳方法是什么？

我们找到的两种方法是：

1.  创建观察者模式。服务器将是一个观察者，游戏将发送一个事件来删除它。

2.  将游戏设置为`ended`状态，同时服务器不断扫描向量并删除处于`ended`状态的游戏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:48:04.733

**指针或实例**

如果您使用创建指针`new`，则必须记住将其删除。如果您使用的是真实实例，请确保定义 a `copy constructor`，因为`std::vector`经常复制您的对象。

您可以使用`boost::sharedPointer<Game>`. 不要`std::auto_ptr<Game>`与`std::vector`

从**实施选项**中，我会考虑以下几点：

观察者模式很优雅，但是会被调用多少次呢？从向量中删除将是 O(n)，因为您必须先找到它，然后再找到`erase`它。

如果您知道您将拥有的最大游戏数，比如一分钟，并且适合内存，您可以只使用一个线程每分钟遍历向量并删除任何`ended`游戏。

如果内存很关键，则必须使用观察者模式。如果您有很多游戏，并且每个游戏都有一个唯一标识符，您可以考虑`std::map`代替`vector`，然后使用观察者模式从地图中删除，这将是`O(log(n))`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T22:25:57.613

撇开应用程序的性质不谈，如果您通过值而不是指针将对象添加到向量中，一旦将它们从向量中删除，您就不必担心自己删除它们。如果您必须动态创建对象并将它们作为指针添加到向量中，您将负责删除它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-23T22:30:00.943

一个对象不应该真正决定*它自己的*生命周期。您可能应该拥有某种管理上下文，它拥有*容器*并且可以决定对象何时需要离开。实际`Game`元素可能会以某种方式通知管理器它们已完成，但它们不应该删除自己，或从集合中删除自己。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T22:25:17.020

> 创建一个对象或指向对象的指针游戏？

游戏对象大吗？它是否包含其他指针或指向文件、套接字或其他此类事物的指针？

如果其中任何一个的答案是肯定的，那么你应该新建游戏对象，并存储一个指向它的指针。

> 你应该使用观察者还是经常扫描？

为了更好地回答这个问题，我需要更多地了解您的程序。目前，这似乎是一个您更适合做出的设计决定。如果您不断扫描，您将需要旋转一个线程。这可能不是你想要的。

我个人会使用观察者模式。

# ruby-on-rails - gem 用于上传 PDF 模板，填写表格并输出生成的 PDF

> ID：12100818
> 
> 赞同：1
> 
> 时间：2012-08-23T22:21:45.477
> 
> 标签：ruby-on-rails, ruby, pdf

我正在寻找 ruby​​ on rails 中的 Gem，它只需上传那些 PDF（表单可填写字段）并让系统简单地调用该 PDF 模板，填写表单并输出生成的 PDF

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:26:31.983

您应该查看我在 jRuby 中成功使用的[iText 库。](http://itextpdf.com)在 jRuby 中使用它时感觉有点原生。您当然必须做一些工作，但我完全按照您对 iText 的要求做了。

# ruby-on-rails - 使用 BigCommerce API 获取特定字段

> ID：12100819
> 
> 赞同：0
> 
> 时间：2012-08-23T22:21:46.833
> 
> 标签：ruby-on-rails, api

有没有办法使用 BigCommerce API 仅获取资源的某个字段？例如仅获取所有产品的 id 字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:20:46.577

我不相信您可以只在获取请求中返回经过过滤的字段列表。如果您使用的是 Ruby gem，

```
orders = api.get_orders
order_id = orders.collect{|o| o["id"]} 
```

您可以在这里找到宝石 - [https://github.com/bigcommerce/bigcommerce-api-ruby/](https://github.com/bigcommerce/bigcommerce-api-ruby/)

希望这可以帮助！

# php - 使用 codeigniters 表单验证时遇到问题

> ID：12100822
> 
> 赞同：0
> 
> 时间：2012-08-23T22:22:05.800
> 
> 标签：php, html, forms, validation, codeigniter

所以我第一次尝试使用 CI 内置的 form_validation “工具”来获得很大的帮助，而研究我似乎无法掌握它。我的视图设置正确，我的控制器似乎正确...我的问题是当我单击“提交”按钮时，它链接到新功能，但无论我输入什么都不显示任何错误消息“名称”、“电子邮件”框。我希望它现在几乎在任何地方都显示错误消息，我只需要它运行验证并显示错误消息。

控制器文件

```
public function intelli()
{
    $data["messages"] = "";
    $this->load->view('engage_header');
    $this->load->view('engage_nav');
    $this->load->view('intelli/content_intelli', $data);
    $this->load->view('engage_footer');

}
public function intelli_email()
{
    $this->load->helper('form', 'url'));
    $this->load->library('form_validation');

    $this->form_validation->set_rules('name_area', 'Name', 'required|alpha|xss_clean');
    $this->form_validation->set_rules('email_area', 'Email', 'required|valid_email|xss_clean');
    $this->form_validation->set_rules('phone_area', 'Phone', 'is_numeric|xss_clean');

    if ($this->form_validation->run() == FALSE) {
        $data["messages"] = "";
    } else {

        $data["messages"] = "The Email has successfully been sent";
    }

    $this->load->view('engage_header');
    $this->load->view('engage_nav');
    $this->load->view('intelli/content_intelli', $data);
    $this->load->view('engage_footer');
} 
```

查看文件

```
<?php 
    $this->load->helper("form");
?>
<div class="request_demo">
    <div id="request_logo"></div>
    <div id="top_paragraph">
    Intelliship & HALO deliver immediate and quantifiable ROI.  Schedule a demo to learn how this transportation management software will positively impact your company&apos;s bottom-line profit.
    </div>
    <div id="entry_box">
    <?php  echo validation_errors();
    echo $messages;
    ?>
    <div id="request_form">
    <?php echo form_open('/index.php/site/intelli_email')?>
            <input id="name_area" type="text" placeholder="NAME" value="" required/><br/>
            <input id="email_area" type="text" placeholder="EMAIL" value="" required/><br/>
            <input id="phone_area" type="text" placeholder="PHONE" value=""><br/>
            <input id="submit_req" type="submit" value="SUBMIT">
        </form> 
    </div>
</div> 
```

我知道代码现在很草率，但我只是在寻找功能而不是美观。还注意到，因为我在控制器中加载了 helper('form')，所以在视图中加载它是多余的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:29:31.630

您只`id`为表单元素指定。`name`也给他们

```
<input id="name_area" name ="name_area" type="text" placeholder="NAME" value="" required/><br/>
<input id="email_area" name="email_area" type="text" placeholder="EMAIL" value="" required/><br/>
<input id="phone_area" name="phone_area" type="text" placeholder="PHONE" value=""><br/> 
```

Codeigniter 连接规则集，元素基于名称，而不是 id

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T05:50:44.300

或者你可以像这样给

```
<input type="text" name="name_area" value="">
<?php echo form_error('name_area'); ?> 
```

对于不同的字段，forn_error 值会发生变化，例如 email_area,phone_area.... 它显示与字段名相对应的错误（验证）。

# php - NameSpace Autoinclude 仅在 1 个特定类上出错

> ID：12100825
> 
> 赞同：1
> 
> 时间：2012-08-23T22:22:17.457
> 
> 标签：php, namespaces

假设这些在单独的文件中。

```
<?php
namespace aName;

function importerLoader($class)
{
  $elements =  explode('\\',$class);
  if (count($elements) == 2 && $elements[0] == __NAMESPACE__)
  {
    $filename = $elements[1].'.php';
    if (file_exists($filename) )
    {
      error_log("calling".$filename);
      require($filename);

    }
    else
    {
      error_log("File does not exist ".$filename);
      return false;
    }
  }
}

spl_autoload_register(__NAMESPACE__.'\importerLoader');

<?php
namespace aName;

class Question
{

    ...
    protected function importAnswers()
    {
      foreach($this->QuestionData as $answer)
      {
        $this->answerObjects[$index] = new Answer($answer);//Fatal error
        also tried
$this->answerObjects[$index] = new Answer::answerFactory($answer);//Fatal error

      }
    }

    ...
    public static function questionFactory($question)
    {
      $returnMe = false;
      if (self::validQuestionType($question))
      {
        switch ($question[0]->qtid)
        {
          case 1:
            $returnMe = new QuestionType1($question);
            break;
          case 2:
            $returnMe = new QuestionType2($question);
            break;
        }
        return $returnMe;
      }
    }

}

<?php
namespace aName;

class Answer
{
    ...
    public static function answerFactory($answer)
    {
      $returnMe = false;

      switch ($answer->qtid)
      {
        case 1:
          $returnMe = new AnswerType1($answer);
          break;
        case 2:
          $returnMe = new AnswerType2($answer);
          break;
        default:
          $returnMe = new Answer($answer);
          break;
      }
      return $returnMe;
    }
} 
```

最后

```
<?php
namespace aName;

class Quiz
{
    ...

    function importQuestion($question)
    {
      //insert newly created into it's proper ordering int he question objects table.
      $this->_questionObjects[$question[0]->question_order] = Question::questionFactory($question);

    }
} 
```

注意：自动加载器适用于所有其他类。Answer.php 类没有。我得到一个致命错误。我检查了错别字。它都在同一个目录中。当 Quiz 导入问题时，工厂工作。但是当问题得到答案时，我得到一个致命错误。请注意，测验是自动加载器调用的另一个对象中的一个对象。

我明白了

```
PHP Fatal error:  Class 'aName\Answer' not found in C:\<A PATH>\Question.php on line 315 
```

我彻底迷路了。它甚至包含该文件，但它不识别该类。我只能猜测这是一个命名空间问题，但我无法弄清楚它是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T15:04:00.653

我发现了这个问题。我不知道为什么，但编辑器以不正确的编码保存该文件。换了它，它现在可以工作了。

# c# - 应用 Telerik Q2 修补程序后无法单击 Telerik 上下文菜单

> ID：12100827
> 
> 赞同：0
> 
> 时间：2012-08-23T22:22:36.567
> 
> 标签：c#, silverlight, telerik, contextmenu, radgridview

我目前有一个附加上下文菜单的 RadGridView。我订阅 ItemClick 事件并处理在该方法中单击的任何内容。这**适用于 Silverlight Q2 2012**的 RadControls，但在应用**Silverlight5 2012 2 0813 的 RadControls 修补程序**后，该功能部分损坏。

我想要的功能仍然可以在浏览器中运行，但是当在浏览器 (OOB) 之外运行应用程序时，在打开上下文菜单（通过右键单击 GridView）后单击任意位置或按下键盘上的键会导致上下文菜单关闭。单击上下文菜单后永远不会触发关闭事件，仅当我单击上下文菜单外部时才会触发。上下文菜单打开事件总是被点击，但项目点击事件仅在应用程序在浏览器中运行时触发。

我能够保持菜单打开并可供单击的唯一方法是将 ContextMenu 属性 StaysOpen 设置为 true，但我不希望菜单像这样保持打开状态。我检查了 RadContextMenu 的主题，它们在这两个 Telerik 版本中看起来都一样。

这是后面的代码示例（xaml 包含 1 个名为“grid”的网格视图）：

```
 public MainPage() {
  InitializeComponent();
  RadContextMenu contextMenu = new RadContextMenu { FontSize = 10 };
  contextMenu.Opening += ContextMenuOpeningHandler;
  contextMenu.ItemClick += ContextMenuItemClickHandler;
  StyleManager.SetTheme(contextMenu, StyleManager.GetTheme(grid));
  RadContextMenu.SetContextMenu(grid, contextMenu);
}

private void ContextMenuItemClickHandler(object sender, RadRoutedEventArgs e) {
   new RadWindow { Content = "Item Clicked!" }.ShowDialog();
}

private void ContextMenuOpeningHandler(object sender, RadRoutedEventArgs e) {
  RadContextMenu contextMenu = (RadContextMenu)sender;
  contextMenu.IsEnabled = true;
  contextMenu.Items.Clear();
  contextMenu.Items.Add(new RadMenuItem { Header = "item 1" });
  contextMenu.Items.Add(new RadMenuItem { Header = "item 2" });
} 
```

任何帮助或建议将不胜感激。

谢谢，米莎

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T01:53:00.537

这个问题在[Telerik 论坛](http://www.telerik.com/community/forums/silverlight/menu/cannot-click-on-items-in-contextmenu-out-of-browser-after-applying-hotfix.aspx)上得到了回答。

我最终通过在网格中单击鼠标右键时使用 StaysOpen=True 属性手动解决了这个问题。然后我在单击一个项目时手动关闭上下文菜单。

# php - PHP 调用错误的 URL

> ID：12100830
> 
> 赞同：0
> 
> 时间：2012-08-23T22:22:53.463
> 
> 标签：php, wordpress

我正在使用 WP eCommerce snd 下面的 PHP 代码行应该链接到此[页面](http://allfashionsunglasses.com/products-page/)，但它却将其链接到错误的[页面](http://allfashionsunglasses.com/products-page-2/)

```
<?php else: ?>
    <p class="empty">
        <?php _e('Your shopping cart is empty', 'wpsc'); ?><br />
        <a target="_parent" href="<?php echo get_option('product_list_url'); ?>" class="visitshop" title="<?php _e('Visit Shop', 'wpsc'); ?>"><?php _e('Visit the shop', 'wpsc'); ?></a>    
    </p>
<?php endif; ?>

<?php
wpsc_google_checkout();

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:35:10.457

所有这些代码所做的就是定位选项 Product_list_url 并在其中获取 url。该选项中的 url 可能是错误的。该选项要么存储在该插件的管理设置中，要么存储在代码中。首先检查该插件的管理设置并找到选项产品列表 URL 或类似的东西。其他选择是对“product_list_url”进行代码范围的搜索，看看它是否在任何地方进行了硬编码。这是我的两分钱，也是我通常如何在 WP 或 Drupal 中查找内容的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-27T00:16:39.863

我确实发现有一个重复的 URL，它调用了 2 个中的最新 URL。当我删除重复项，然后停用并重新激活插件时，一切都变得好起来了。

# r - 熔化数据的列算术等价

> ID：12100833
> 
> 赞同：3
> 
> 时间：2012-08-23T22:23:07.953
> 
> 标签：r

我有一个“整洁”格式的数据集，如下所示：

```
 group         type score price
1     A Fish + Chips     9     8
2     B Fish + Chips     7    20
3     C Fish + Chips     8    22
4     A        Chips     9     0
5     B        Chips     0     7
6     C        Chips     8    16
7     A        Snags     5    19
8     B        Snags     9     8
9     C        Snags    10     6 
```

我想添加一些派生数据，如果将数据转换为宽格式，将使用列算术（加法、减法等）确定。我一直在尝试解决如何在不再次铸造和熔化的情况下做到这一点。在这里的简单示例中，我想通过从相应数据`Fish`中减去数据来计算类型数据。到目前为止，我想出了以下几点：`Chips``Fish + Chips`

```
ddply(subset(mydata, type %in% c("Chips", "Fish + Chips")),
      .(group), summarise, type="Fish",
      score=score[type=="Fish + Chips"] - score[type=="Chips"],
      price=price[type=="Fish + Chips"] - price[type=="Chips"]) 
```

这使

```
 group type score price
1     A Fish     0     8
2     B Fish     7    13
3     C Fish     0     6 
```

然后我可以`rbind`得到原始数据。任何更好的方法的建议将不胜感激（即使那是铸造和融化）。

这是示例数据：

```
structure(list(group = structure(c(1L, 2L, 3L, 1L, 2L, 3L, 1L, 
 2L, 3L), .Label = c("A", "B", "C"), class = "factor"), type = structure(c(2L, 
 2L, 2L, 1L, 1L, 1L, 3L, 3L, 3L), .Label = c("Chips", "Fish + Chips", 
 "Snags"), class = "factor"), score = c(9, 7, 8, 9, 0, 8, 5, 9, 
 10), price = c(8, 20, 22, 0, 7, 16, 19, 8, 6)), .Names = c("group", 
 "type", "score", "price"), row.names = c(NA, -9L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:54:52.380

我认为你的更好，但这是一个非 plyr/reshape 解决方案：

```
mydataspl <- split(mydata, mydata$type)
subs <- merge(mydataspl$"Fish + Chips", mydataspl$Chips, by= 1)
data.frame(subs[,"group", drop=FALSE], type="Fish", 
   score=with(subs, score.x-score.y), 
   price=with(subs, price.x-price.y)
           )
  group type score price
1     A Fish     0     8
2     B Fish     7    13
3     C Fish     0     6 
```

# sql-server - sql多个表替换表中的结果

> ID：12100835
> 
> 赞同：0
> 
> 时间：2012-08-23T22:23:21.953
> 
> 标签：sql-server, select, union

我有一个**巨大**的MSSQL 数据库（近 120 个演出）。该数据库包含 1371 个表。这些表中只有 3 个是我目前关心的。

我将使用的表：

1.  留言
2.  消息用户
3.  用户

我将使用的“消息”表中的字段：

*   主题
*   身体
*   FromMessageUserID
*   优先ID

***Messages.FromMessageuserID***匹配***MessageUser.MessageUserID***

我将使用的“MessageUser”表中的字段：

*   消息用户ID
*   用户身份

    ***MessageUser.UserID***匹配***User.UserID***

我将使用的“用户”表中的字段：

*   用户身份
*   用户名

现在我可以运行查询：SELECT Subject, Body, FromMessageUserID, PriorityID FROM Messages

并获得如下显示的结果：

主题正文 FromMessageUserID PriorityID

Sub1 主体 1 1001 1

Sub2 身体 2 1002 3

Sub3 主体 3 1001 2

所以我想看看是谁发送了以“Sub3”为主题的消息。

我首先查看 MessageUser 表，我可以看到 MessageUserID 为 1001 的 UserID 为 10。

然后我转到用户表，我可以看到用户 ID 为 10 的用户名是“JohnDoe”。

我有什么方法可以运行查询，并且返回的结果类似于：

主题正文 FromMessageUserID PriorityID

Sub1 Body1 JohnDoe 1

Sub2 Body2 JaneDoe 3

Sub3 Body3 JohnDoe 2

我不关心 PriorityID，因为我知道这些值（总共 4 个）是什么。

我确信解决此问题的正确方法是使用 JOIN 或 UNION，但是我从未使用过它们，过去几个小时内我所做的每一次尝试都失败了。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:48:05.297

尝试这个

```
SELECT m.Subject, m.Body, u.UserName,m.PriorityID FROM Messages m
inner join MessageUser mu on mu.MessageUserId = m.FromMessageUserID
inner join users u on mu.UserID = u.UserID 
```

# php - PDO 语句未插入

> ID：12100839
> 
> 赞同：0
> 
> 时间：2012-08-23T22:23:46.493
> 
> 标签：php, pdo

这个 PDO 插入语句没有插入 MySQL 有什么原因吗？

```
$stmt = $dbh->prepare("INSERT INTO training courseId = :postCourse, title = :postCourseName, startDate = :postStartDate, endDate = :postEndDate");
$stmt->bindParam(':postCourse', $postCourse);
$stmt->bindParam(':postCourseName', $postCourseName);
$stmt->bindParam(':postStartDate', $postStartDate);
$stmt->bindParam(':postEndDate', $postEndDate);
$stmt->execute(); 
```

我没有收到任何错误。一切对我来说都是正确的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T22:26:16.523

您的查询应该是：

```
INSERT INTO training (courseId, title, startDate, endDate) VALUES
(:postCourse, :postCourseName, :postStartDate, :postEndDate); 
```

或者：

```
INSERT INTO training 
SET courseId = :postCourse, 
    title = :postCourseName,
    startDate = :postStartDate, 
    endDate = :postEndDate 
```

见[http://dev.mysql.com/doc/refman/5.5/en/insert.html](http://dev.mysql.com/doc/refman/5.5/en/insert.html)

您应该能够检查以下错误：

```
$stmt = $dbh->prepare(...);
if (!$stmt) {
    var_dump($dbh->errorInfo());
} 
```

或者：

```
$stmt->execute();
var_dump($stmt->errorInfo()); 
```

或者：

```
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
... 
```

见：[http ://www.php.net/manual/en/pdo.error-handling.php](http://www.php.net/manual/en/pdo.error-handling.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T22:25:47.017

是的，你错过了`SET`：

```
$stmt = $dbh->prepare("INSERT INTO training SET courseId = :postCourse, title = :postCourseName, startDate = :postStartDate, endDate = :postEndDate"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-23T22:26:49.767

```
$stmt = $dbh->prepare("INSERT INTO training (courseId, title, startDate, endDate) VALUES (:postCourse, :postCourseName, :postStartDate, :postEndDate"); 
```

检查您的 INSERT 语法[http://dev.mysql.com/doc/refman/5.1/en/insert.html](http://dev.mysql.com/doc/refman/5.1/en/insert.html)

# php - 从 iframe 打开 fancybox2

> ID：12100841
> 
> 赞同：0
> 
> 时间：2012-08-23T22:23:58.063
> 
> 标签：php, jquery, fancybox-2

我正在使用 php 来创建 youtube 拇指，并且需要在 iframe 中使用 fancybox 调用它来打开 youtube 视频。fancybox 2 常见问题解答告诉：

可以从 iframe 调用脚本吗？如果所有必要的文件都包含在父窗口中，那么您可以，例如：

```
<a href="javascript:parent.$.fancybox.open({href : 'myurl'});">Open something</a> 
```

所以我这样做了，我的fancybox实际上按预期从iframe打开到父窗口。唯一的问题是它告诉“无法加载请求的内容。请稍后再试”而不是视频 - 原因可能是 http:address 的问题，我看不到脚本错误在哪里。

我用来在 Iframe 中创建链接的脚本：

```
...some php here...

echo('
<div class="tube"><a title="'.$title.'" href="javascript:parent.Mybox.fancybox.open    ({href : \'http://www.youtube.com/v/'.$v.'?  feature=player_embedded&version=2&autohide=1&hd=1&modestbranding=1&rel=0&border=0&autoplay=0&fs=1&fmt=22 \'});"><img style="border:2px solid #000;margin:5px;" alt="'.$title.'" src="http://i1.ytimg.com/vi/'.$v.'/default.jpg"/></a>');

...some more php here... 
```

它产生的结果是这样的

```
<div class="tube"><a title="MyTitle" href="javascript:parent.Mybox.fancybox.open({href : 'http://www.youtube.com/v/J0_5JEJdB5g?feature=player_embedded&version=2&autohide=1&hd=1&modestbranding=1&rel=0&border=0&autoplay=0&fs=1&fmt=22 '});"><img style="border:2px solid #000;margin:5px;" alt="MyVideo" src="http://i1.ytimg.com/vi/J0_5JEJdB5g/default.jpg"/></a><p>09.11.2012<br/>MyVideo<br/>213times</p></div> 
```

那么我做错了什么？'myurl' 或我的 fancybox 设置有什么问题？

我的fancybox设置是：

```
<script type="text/javascript">

Mybox(document).ready(function() {
    Mybox('#tubeframe')
            .attr('rel', 'media-gallery')
            .fancybox({
                openEffect : 'elastic',
                closeEffect : 'fade',
                prevEffect : 'none',
                nextEffect : 'none',
                padding : 0,
                autoScale   : true,
                fitToView  : true,
                height      : 475,
                width           : 846,
                fixed : true,
                arrows : false,
                helpers : {
                    media : {},
                    buttons : {},
                    title: {
                type: 'outside'
    },
                overlay : {
                    opacity: 0.7,
                    css : {
                    'background-color' : '#433'
        }
    }
                }
            });
 });

     </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T10:28:53.917

经过几天的搜索，找到了此处描述的解决方案：

[从 iframe 中打开 iframe fancybox，使其在父级中打开](https://stackoverflow.com/questions/10406642/open-iframe-fancybox-from-within-an-iframe-so-that-it-opens-in-the-parent)

一切都与花式框设置有关

# stored-procedures - SQL Server：xp_fileexist 和 UNC 路径权限

> ID：12100845
> 
> 赞同：1
> 
> 时间：2012-08-23T22:24:38.683
> 
> 标签：stored-procedures, sql-server-2008-r2

我试图在使用未记录的存储过程的 SQL Server Management Studio 中运行临时查询`xp_fileexist`。我想测试通过 UNC 路径访问的网络共享文件夹下的子文件夹中是否存在文件。

这是一篇[sqlservercentral 帖子](http://www.sqlservercentral.com/Forums/Topic533876-146-2.aspx#bm1057641)，讨论了`xp_fileexist`. 据我所知，我已经获得了所有必要的权限：

*   我正在从对共享文件夹及其子文件夹具有完全控制权的域帐户运行 SQL Server Management Studio。
*   SQL 帐户链接到域帐户并具有`sysadmin`角色。
*   SQL Server 服务以`Network Service`.
*   `Network Service`完全控制共享文件夹及其子文件夹。

我担心其中一些权限设置可能会过大，但`xp_fileexist`仍然看不到子文件夹的内容。

```
EXEC master.dbo.xp_fileexist '\\servername\sharename\subfolder\filename.txt' 
```

```
文件存在 |文件是目录 |父目录存在
-------------------------------------------------- --------
0 |0 |0

```

但`xp_fileexist`确实看到共享文件夹本身。

```
EXEC master.dbo.xp_fileexist '\\servername\sharename' 
```

```
文件存在 |文件是目录 |父目录存在
-------------------------------------------------- --------
0 |1 |1

```

**问题**：

为什么共享文件夹的内容不可见？

实际需要哪些安全设置？

# database-schema - 对 EWS 的本地数据结构的建议？

> ID：12100852
> 
> 赞同：0
> 
> 时间：2012-08-23T22:25:08.190
> 
> 标签：database-schema, exchange-server-2010, ews-managed-api

我正在开发一个 CRM，它将通过 EWS 托管 API 将来自交换服务器的电子邮件存储在本地数据库上。我对 EWS 很陌生。你做过类似的事情吗？

*   你对项目建议什么数据结构？
*   有什么理由我应该为电子邮件和日历设置不同的表格？
*   主键应该是什么？
*   如何处理附件？

PS 我之前通过 IMAP 完成了此操作，并首先下载项目标题。然后在必要时使用 UID 下载完整项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T11:53:25.023

对于您的案例，EWS 托管 API 中最重要的类型是项目类型。Task、Contact、Email message、Appointment、Post item 和 Distribution 列表都继承自 Item 类。我已经使用这个 API 3 个月来开发 WCF 休息服务并且从未存储过数据。但是，我认为你需要为前面提到的每种类型创建一个单独的表（除了Item，因为它更抽象）。例如，联系人类型有一个名为“职位”的属性，那么如果我们使用它如何存储它所有事物的项目类型模式！
DB 的 ID 可能与项目 ID 属性 (uniqueID) 相同。最后，我认为找到事物之间的对应关系（电子邮件广告联系人，任务和联系人，约会和联系人，联系人和组......）需要一些思考。

# r - 在单个函数中结合 S4 和 S3 方法

> ID：12100856
> 
> 赞同：14
> 
> 时间：2012-08-23T22:25:16.360
> 
> 标签：r, cran, s4

什么是定义应该具有 S3 和 S4 类实现的通用功能的好方法？我一直在使用这样的东西：

```
setGeneric("myfun", function(x, ...){  
    standardGeneric("myfun");
});

setMethod("myfun", "ANY", function(x, ...) {
    if(!isS4(x)) {
        return(UseMethod("myfun"));
    }
    stop("No implementation found for class: ", class(x));
}); 
```

这成功了：

```
myfun.bar <- function(x, ...){
    return("Object of class bar successfully dispatched.");
}
object <- structure(123, class=c("foo", "bar"));
myfun(object) 
```

有没有一种“本机”的方式来实现这一点？我知道我们可以使用 为 S3 类定义 S4 方法`setOldClass`，但是如果一个对象有多个类，我们就会失去 S3 方法的调度。例如（在干净的会话中）：

```
setGeneric("myfun", function(x, ...){  
    standardGeneric("myfun");
});

setOldClass("bar")
setMethod("myfun", "bar", function(x, ...){
    return("Object of class bar successfully dispatched.");
});

object <- structure(123, class=c("foo", "bar"));
myfun(object) 
```

`object`这失败了，因为在这种情况下，第二类`bar`被忽略了。我们可能可以通过在`foo`and之间定义正式的 S4 继承来解决这个问题`bar`，但是对于我的应用程序，我宁愿`myfun.bar`在具有类的 S3 对象上开箱即用`bar`。

无论哪种方式，事情都变得一团糟，我想这是一个常见的问题，所以可能有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-23T23:09:42.077

?Methods 的“S3 泛型函数的方法”部分建议了 S3 泛型、S4 类的 S3 样式方法以及 S4 方法本身。

```
setClass("A")                    # define a class

f3 <- function(x, ...)           # S3 generic, for S3 dispatch    
    UseMethod("f3")
setGeneric("f3")                 # S4 generic, for S4 dispatch, default is S3 generic
f3.A <- function(x, ...) {}      # S3 method for S4 class
setMethod("f3", "A", f3.A)       # S4 method for S4 class 
```

调度 S3 类需要 S3 泛型。

setGeneric() 将 f3（即 S3 泛型）设置为默认值，而 f3,ANY 方法实际上是 S3 泛型。由于“ANY”位于（某种程度）类层次结构的根部，因此任何不存在 S4 方法的对象（例如，S3 对象）都将在 S3 泛型处结束。

S4 类的 S3 泛型定义在帮助页面 ?Methods 中进行了描述。我认为，大约，S3 不知道 S4 方法，所以如果一个调用 S3 泛型（例如，因为一个在包名称空间中，包知道 S3 f3 但不知道 S4 f3）f3 泛型找不到 S4 方法。我只是使者。

# php - CakePHP AppExceptionHandler 和视图

> ID：12100858
> 
> 赞同：1
> 
> 时间：2012-08-23T22:25:17.363
> 
> 标签：php, cakephp, exception-handling, error-handling, cakephp-2.0

我检查了[这个问题](https://stackoverflow.com/questions/8644352/render-view-from-appexceptionhandler)和这个[食谱部分](http://book.cakephp.org/2.0/en/development/exceptions.html#create-your-own-exception-handler-with-exception-handler)。
我创建了这样的代码并做了以下步骤：

在 app/Config/core.php

```
Configure::write('Exception.handler', 'AppExceptionHandler::handle'); 
```

在 app/Config/bootstrap.php

```
App::uses('AppExceptionHandler', 'Lib'); 
```

在 app/Lib/AppExceptionHandler.php

```
class AppExceptionHandler {
    public static function handle($error) {
        $errorCode = $error->getCode();
        if ($errorCode == 404) {
            header("HTTP/1.0 404 Not Found");
        } elseif ($errorCode == 500) {
            header("HTTP/1.0 500 Internal Server Error");
        }

        echo "here is something is wrong";
    }
} 
```

除了渲染部分，一切正常。
到目前为止，我只能写“出了点问题”，但我无法在视图文件中查看它。

在“App/Controller”文件夹中，我有“ErrorsController.php”。
当我遇到异常时，我需要运行 ErrorsController。所以我将在该控制器的视图文件中进行渲染。

1.  如何将用户重定向到 ErrorsController ？当然，我可以使用重定向命令来实现。但是当我将用户重定向到 ErrorsController::index() 函数并且当我在 ErrorsController 中发送 404 标头时，我再次被重定向到处理程序页面。
2.  我应该在哪里设置响应标头？我应该在 ErrorsController 中还是从 handler 中设置它？

**编辑：**

```
class ErrorsController extends AppController {
    function beforeFilter() {
        if ( isset($this->request->params['pass'][0]) ) {
             if ($this->request->params['pass'][0] == "404") {
                $this->response->statusCode('404');
            }
        }
    }

    public function index($typeOfError) {
        echo "here I am $typeOfError";
    }
} 
```

当我输入`example.com/errors/index/404`输出是“这里有问题”但我需要它是“这里我是 404”。因为当我进入 ErrorsController 的操作并发送 404 标头时，我被重定向到 AppHandler 的句柄。那么如何渲染我自己的视图呢？

这个问题还是存在的。。

# javascript - Sencha Touch 2 停靠的标签面板

> ID：12100860
> 
> 赞同：0
> 
> 时间：2012-08-23T22:25:43.510
> 
> 标签：javascript, sencha-touch-2

我有一个带有标签栏的面板和标签栏内的两个标签。我不知道为什么，但似乎我无法将标签栏放在底部。无论我尝试什么，标签栏始终位于页面顶部。

面板：

```
Ext.define( 'MyApp.view.Manager', {
    // properties
    extend: 'Ext.tab.Panel',
    fullscreen: true,

    requires:
    [
        'Ext.TitleBar'
    ],
    config:
    {
        tabBarPosition: 'bottom',
        tabBar: true,
        items:
        [
            { xtype: 'addorderpanel' },
            { xtype: 'loginpanel' }
        ]
    }
}); 
```

上面的面板在一个容器内：

```
Ext.define( 'MyApp.view.Main', {
    // properties
    extend: 'Ext.Container',
    config:
    {
        fullscreen: true
    },

    initialize: function ()
    {
        this.callParent(arguments);

        var manager = Ext.create( 'MyApp.view.Manager' );
        this.add(manager);
    }
}); 
```

如果我将第一个面板（“管理器”）直接添加到视口，标签栏位于底部，一切正常。将面板添加到容器中可能是不好的做法，还是我错了？

我希望有人可以帮助我。提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T23:55:26.390

将布局属性添加到主文件中的配置对象。它应该看起来像

```
Ext.define( 'MyApp.view.Main', {
    // properties
    extend: 'Ext.Container',
    config: {
        fullscreen: true,
        layout:'fit'
    },

    initialize: function () {
        this.callParent(arguments);

        var manager = Ext.create( 'MyApp.view.Manager' );
        this.add(manager);
    }
}); 
```

您的选项卡面板没有任何大小，因此选项卡栏位于顶部。

# html - 向下悬停在子菜单 div 之外后，下拉菜单颜色未恢复

> ID：12100862
> 
> 赞同：1
> 
> 时间：2012-08-23T22:25:52.863
> 
> 标签：html, css, drop-down-menu

这是一个有趣的。

CSS：

```
 #menu>li>a:link, #menu>li>a:visited {
        color:#002349;
        display: block;
        float: left;
        width: auto;
        font-weight: 500;
        font-size: 18px;
        text-decoration:none;
        text-transform: lowercase;
        padding: 10px 10px;
    }

    #menu>li:hover>a {
        color:#fff;
        text-decoration: none;
        background-color: #002349;
    }

.submenu {
    position:absolute;
    left: -9999px;
    padding:0px 0px 0px 0px;
    top:32px;
    margin: 0px;
    text-align: left;
    background-color: #002349;
    width: auto;
    z-index: 20;
}

#menu li:hover .submenu {
    display:block;
    position: absolute;
    left:0px;
}

.submenu li {
    text-align: left !important;
    margin:0px 0px 0px 0px !important;
    padding: 0px;
    display:block;
    clear:both;
}

.submenu li a:link, .submenu li a:visited {
    color:#fff !important;
    font-size: 12px;
    margin: 0px;
    padding:5px 12px 7px 12px !important;
    margin: 0px !important;
    display: block;
    text-transform: uppercase;
    white-space: nowrap;
}

.submenu li a:hover, .submenu li a:active {
    color:#fff !important;
    background: #666 !important;
    text-decoration: none;
} 
```

的HTML：

```
<ul id="menu">
    <li><a href="http://jamie.brixwork.com/why-jamie-realtor" title="Meet Jamie MacDougall">why jamie</a>
    </li>
    <li><a href="http://jamie.brixwork.com/why-sothebys" title="Why Sotheby's International?">why sotheby's</a>
    </li>
    <li><a href="http://jamie.brixwork.com/listings" title="Featured Real Estate Listings">featured listings</a>
        <ul class="submenu">
            <li><a href="http://jamie.brixwork.com/listings/pageid-8/city-North+Vancouver/page-1" title="Featured Real Estate Listings">North Vancouver</a></li>
            <li><a href="http://jamie.brixwork.com/listings/pageid-9/city-West+Vancouver/page-1" title="Featured Real Estate Listings">West Vancouver</a></li>
        </ul>
    </li>
</ul> 
```

你可以在这里看到整个页面：http: [//jamie.brixwork.com/why-sothebys](http://jamie.brixwork.com/why-sothebys)

用鼠标浏览“列表”菜单。如果您的鼠标退出 UPWARDS 或 SIDEWAYS，则原始文本颜色（深蓝色）会恢复。

但是，如果您进入下拉菜单 ()，然后通过将鼠标向下移出子菜单来退出，则顶部菜单的文本颜色不会变回。

为什么会这样？我有：悬停在顶部

*   标记，因为我希望悬停效果在子菜单悬停时对顶部菜单项生效，因此我不能仅将悬停效果放在顶部菜单的标签上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:09:21.007

[https://github.com/sorccu/cufon/wiki/FAQ#wiki-faq-10](https://github.com/sorccu/cufon/wiki/FAQ#wiki-faq-10)

事实证明，这是一个 CUFON 问题，检测已关闭。FAQ #10 有答案.. 虽然我什至不明白这意味着什么。:(但是从他们的示例中复制粘贴一个片段解决了它。

我将 CUFON 替换代码更改为：

```
Cufon.replace('#menu>li', { fontFamily: 'gillsans', hover:true,
hoverables: { li: true },
    ignore: { ul: true },
    textless: { li: true }
}); 
```

# scala - 使用scala的好奇错误springmvc注释

> ID：12100870
> 
> 赞同：2
> 
> 时间：2012-08-23T22:26:49.457
> 
> 标签：scala, spring-mvc

我认为你们中的一个非常聪明的 scala 人可能能够解释以下问题。

以下服务始终返回 400（客户端发送的请求在语法上不正确 ()。） - springmvc 中不太有用的错误之一，但通常在未正确指定参数时发生。但是，如果我删除在 None 上进行映射的行，它会起作用。此外，如果我创建一个引用参数的本地 val 然后映射它，它也可以工作。

```
@RequestMapping(value = Array("/willfail/{param}/"))  
def willFail(@PathVariable param:String):String={
    println("This line never even gets executed.")

    //Remove following line and it works.
    None.map(_ == param )

    //Whatever..
    "somepage"
} 
```

这有点尴尬，因为我把大家踢和尖叫拖到 scala 上，这是我对此感到有点内疚的第一个案例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:57:17.913

正如Biju Kunjummen 正确指出的那样，它与从调试信息中重构参数名称有关。

`None.map(_ == param )` `scalac`由于某些原因存在将不同的参数名称（`param$1`而不是`param`）写入调试信息（您可以使用 进行检查`javap -c -l`），因此 Spring MVC 无法将参数与路径变量相关联。

作为一种解决方法，您可以显式指定参数名称 ( `@PathVariable("param")`)，如果在没有调试信息的情况下编译，它也可以使您的程序正常工作。

# wpf - SharpDevelop + IronPython + WPF

> ID：12100875
> 
> 赞同：1
> 
> 时间：2012-08-23T22:27:05.873
> 
> 标签：wpf, ironpython, sharpdevelop

我想使用 IronPython 和 SharpDevelop 4.2 创建一个 WPF 应用程序。但我很困惑如何访问 Window1.xaml 中的对象。

请帮忙.. ：）

这是我由 SharpDevelop 4.2 自动创建的代码：

Window1.xaml

```
<?xml version="1.0" encoding="utf-8"?>
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="wpf01"
Height="300"
Width="300">
<StackPanel
    Margin="15"
    x:Name="stackPanel">
    <Button
        FontSize="24"
        x:Name="button">
        <Button.BitmapEffect>
            <DropShadowBitmapEffect />
        </Button.BitmapEffect>
    Push Me
    </Button>
    <TextBox
        x:Name="txtName"
        Width="120"
        Height="20"
        Text="aaaaa" />     
</StackPanel>
</Window> 
```

窗口1.py

```
import wpf

from System.Windows import Window

class Window1 (Window):
def __init__(self):
    wpf.LoadComponent(self, 'Window1.xaml') 
```

应用程序.py

```
import wpf

from System.Windows import Application
from Window1 import Window1

window = Window1()
app = Application()
app.Run(window) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T12:32:42.073

通过访问您的对象，我假设您想从代码访问您在 xaml 中定义的文本框和按钮。

您可以通过在 Window1 类上定义属性或字段来做到这一点。以[IronPython 和 Visual Studio 2010](https://stackoverflow.com/questions/5853812/gui-development-with-ironpython-and-visual-studio-2010/5858309#5858309)为例进行 GUI 开发。

# firefox - DNN + FireFox 和 Chrome 中的外部文件

> ID：12100876
> 
> 赞同：0
> 
> 时间：2012-08-23T22:27:06.950
> 
> 标签：firefox, google-chrome, iis, dotnetnuke

我们有一个 DNN 站点，其中存储了许多非 DNN 文件。这些是由产品文档软件生成的通用 HTML+JS+CSS 文件。最近，我们注意到其中一代无法在 Chrome 100% 的时间和 Firefox 中正确加载。IE 不会剥落。

由于未正确加载，该站点永远不会完全加载。浏览器中的图标闪烁和/或进程圈继续旋转。但是，如果您在浏览器中切换选项卡，则会停止滑动并加载资源。切换回来，您可以浏览文档。

这些文件包含大量的 javascript 调用和重定向。在 DNN 之外，文件加载没有问题。我们一直在寻找一种方法来轻松地将 DNN 从处理这些文件中排除，但无济于事。

[www.roguewave.com/portals/0/products/visualization/docs/5.5.1/index.html](http://www.roguewave.com/portals/0/products/visualization/docs/5.5.1/index.html)

如果它有任何重要性，我们无法控制文档的生成方式（由其他来源提供），但使用的软件是 Frame 9.0、ePub 2012.2 和 Webworks Help 5.0。

**编辑：**在 DNN 之外，闪烁确实出现在随机和/或首次加载的文档的其他部分中，但不太明显，并且更难以重现每次加载。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T00:22:50.207

您是否偶然在标准 DNN 提供程序之外运行 URL 提供程序？您可能需要设置过滤以确保 URL 提供程序不处理请求，即使它们是非 DNN 文件。

URLMaster 允许自定义正则表达式，它会告诉它不处理某些 URL 格式，在您的情况下，您希望从特定目录向下忽略它。

您还可以检查是否在 DNN 的主机设置中启用了压缩，如果是，请在此处将其关闭并让 IIS 处理压缩。

# c++ - 为什么不能在 const char * str 上应用 str.find_last_of( )

> ID：12100877
> 
> 赞同：0
> 
> 时间：2012-08-23T22:27:06.773
> 
> 标签：c++

我只是在尝试这段代码......我想尝试将我的路径拆分为目录和文件。

```
#include <iostream>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

using namespace std;

void SplitFilename (const char * str)
{
  size_t found;
  cout << "Splitting: " << str << endl;
  found=str.find_last_of("//");
  cout << " folder: " << str.substr(0,found) << endl;
  cout << " file: " << str.substr(found+1) << endl;
}

int main() {
    char *outFile1 = NULL;
    outFile1 = "//tmp//Softwares//v//vdisk";////tmp//iscsi//target1//lun1
    char* outFile2 = (char*) malloc(strlen(outFile1) + strlen(".meta") + 1);
    strcpy(outFile2,outFile1);
    strcat(outFile2, ".meta");
    cout << "str2:" << outFile2 << "\n";
    SplitFilename (outFile2);

} 
```

我收到了这些错误

../src/test.cpp:20：错误：在“str”中请求成员“find_last_of”，它是非类类型“const char *”../src/test.cpp:21：错误：请求对于'str'中的成员'substr'，它是非类类型'const char *' ../src/test.cpp:22：错误：请求'str'中的成员'substr'，它不是-class 类型'const char*'</p>

谁能告诉我如何通过将字符指针传递给 SplitFilename() 函数来使其工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:28:31.653

str 是一个 const char*。它不是一个字符串。char 是原始类型。不是一个对象。我认为您的意思是将 str 转换为实际的字符串对象：

```
std::string my_string(str);
my_string.find_last_fo("//"):
.
.
. 
```

# html - CSS — 响应式水平导航，下方有子导航

> ID：12100881
> 
> 赞同：0
> 
> 时间：2012-08-23T22:27:13.987
> 
> 标签：html, css

我有这个水平导航，它可以按照我想要的方式工作：http: [//jsfiddle.net/rnSY4/](http://jsfiddle.net/rnSY4/)

当窗口变小时，主导航项目会折叠，将子导航向下推。

如果子导航 UL 是主要导航 LI 之一的子导航，我会更喜欢它，但我不知道该怎么做。我发现的所有解决方案都涉及添加`position: absolute`到子导航，这意味着当主导航崩溃时它不会向下移动（我还需要子导航下方的所有内容也向下移动）。

有人有解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:41:24.950

您只需要从父 UL 中删除溢出：隐藏，将顶级 LI 设置为具有 position:relative （这样下拉菜单相对于它们的位置而不是标题），然后将样式应用于下拉菜单。

[http://jsfiddle.net/rnSY4/1/](http://jsfiddle.net/rnSY4/1/)

为了跨浏览器合规性，您需要加载一些 Javascript 以向 LI 添加悬停事件，以便您可以在 IE6 上显示下拉菜单。

# php - 将 $_GET 与 mod_rewrite 一起使用

> ID：12100882
> 
> 赞同：1
> 
> 时间：2012-08-23T22:27:14.097
> 
> 标签：php, apache, mod-rewrite

我做了一个 mod_rewrite ：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/?([^/]+)/(.*) /b.php?n=$1&b=$2 [L,QSA] 
```

它改变了我的网址：

```
http://www.website.com/b.php?n=15&t=example 
```

对此：

```
http://www.website.com/15/example 
```

没有图像工作，所以我把它放在我的标题中：

```
<base href="/"> 
```

BOOM 图像工作。但是，我有通过在我的 url 中使用 t 和 n 变量加载的 gif。

```
echo '<img src="gifs/' . $_GET["t"] . '/' . $_GET["n"] . '.gif">'; 
```

如何在我的新 mod_rewrite url 中获取 $_GET["t"] 和 $_GET["n"] 以显示图像

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:30:57.600

您必须通过拆分“/”来解析 URL。

使用重写将它们作为 $_GET 参数显式删除。

查看 $_SERVER['QUERY_STRING']

# jquery - JQuery 过滤器复选框和滑块

> ID：12100887
> 
> 赞同：1
> 
> 时间：2012-08-23T22:27:48.357
> 
> 标签：jquery, ajax

我有一个滑块和一些复选框，可以过滤某个页面的内容。我到目前为止，它确实在做应该做的事情，但它并没有记住它做了什么。因此，如果我更改复选框，它确实会显示正确的品牌，但如果我更改滑块，它会忘记品牌并且什么也不显示。

**价格变化**

```
$("#slider-range").slider({
    range: true,
    min: 0,
    max: 500,
    values: [75, 300],
    slide: function(event, ui) {
        $("#amount").val("\u20AC" + ui.values[0] + " - \u20AC" + ui.values[1]);
    },
    change: function(event, ui) {
        alert("Stopped at " + ui.values[0] + "-" + ui.values[1]);
        $.ajax({
            type: "POST",
            url: "http://localhost/ajaxfilter/getuser.php",
            data: "amount=" + ui.values[0] + "-" + ui.values[1] + "&amount1=" + ui.values[0] + "&amount2" + ui.values[1],
            success: function(data) {
                //alert(""+brand+"");
                $('#thumbs').html(data);
            }
        }); //end ajax
    }
}); 
```

**品牌变化**

```
$(".brandlist :input").click(function() {
    var brand = new Array();
    $(".brandlist input:checked").each(function() {
        brand.push($(this).val());
    });
    $.ajax({
        type: "POST",
        url: "http://localhost/ajaxfilter/getuser.php",
        data: "brand=" + brand,
        success: function(data) {
            //alert(""+brand+"");
            $('#thumbs').html(data);
        }
    }); //end ajax
});​ 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-12-15T18:08:48.133

我也是 ajax/php 的新手。但我认为当您发布 ajax 变量时。您应该像在 SESSION 中一样存储在 php 文件中，并且应该使用会话变量，以便它保持您之前选择的搜索选项............

# jquery - 如何获取每个匹配元素的innerHTML

> ID：12100888
> 
> 赞同：3
> 
> 时间：2012-08-23T22:27:53.330
> 
> 标签：jquery, each

我有很多`<tr>`元素。每个重要的都标有一个包含“highlight-delete”的类名。我如何遍历整个集合，并将它们中的每一个写入`.innerHTML`控制台？我试过这个但它失败了

```
 $.each('tr[class*=highlight-delete]', function (index, item) {
              console.log(item.innerHTML);
            }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T22:32:58.017

函数的第一个参数`each`应该是`array`or `object`，你传递的是一个字符串：

> jQuery.each（集合，回调（indexInArray，valueOfElement））

```
 $.each($('tr[class*=highlight-delete]'), function (index, item) {
          console.log(item.innerHTML);
  }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T22:28:55.773

你可以使用jquery的`html()` `function`

```
 $('tr[class*=highlight-delete]').each(function (index, item) {
      console.log($(item).html());
 }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-12T18:45:32.020

我知道这是一个旧线程。想要提供一个替代使用 jquery 的`each`.

```
$('tr[class*=highlight-delete]').get().map((currentValue, index, arr) => {return currentValue.innerHTML;}) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T22:30:00.533

尝试

这反而

```
item[0].innerHTML; 
```

实际上 item.innerHTML 或 $(item).html() 可以正常工作。

item[0] 不会，因为我们没有得到一个包装集，而是一个 dom 节点。

[http://jsfiddle.net/adouga/9yqqp/](http://jsfiddle.net/adouga/9yqqp/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-23T22:31:42.573

[`$.each()`](http://api.jquery.com/jQuery.each/)将集合作为其第一个参数，而不是选择器，因此每个*项目*实际上是字符串的每个字符。

您需要通过将字符串包装`$()`或使用替代将字符串更改为集合`$(...).each(function(index, item) {...});`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-23T22:33:24.790

```
$('tr[class*=highlight-delete]').each(function (index, item) {
  console.log(item.innerHTML);
});​ 
```

[jsFiddle 的一个例子](http://jsfiddle.net/coltrane/hEYLu/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-24T05:35:00.180

解决这个问题的一种更简单的方法是简单地利用 jQuery 中的链接。`each`在返回的 jQuery 对象上使用。`this`将绑定到回调函数中的匹配元素。

```
$('tr[class*=highlight-delete]').each(function(){
    console.log(this.innerHTML);
}); 
```

# php - 这段 PHP 代码打印出也使用该应用程序的用户朋友列表有什么问题？

> ID：12100889
> 
> 赞同：0
> 
> 时间：2012-08-23T22:27:58.293
> 
> 标签：php, facebook, api, facebook-fql

我对 PHP 很陌生，所以这可能是一个愚蠢的问题。我尝试了许多不同的方法来让它发挥作用，但没有成功。我正在尝试列出也使用该应用但未打印任何值的应用用户朋友的列表。当我在 Facebook 的 Graph API 工具上成功测试[FQL](http://developers.facebook.com/docs/reference/rest/fql.query)查询时，我测试它时有常见的应用程序用户。我已经在文件开头向 Graph API /me 声明了 $user_profile。当我对变量有新用途时，我重新声明了它，但当我尝试获取使用该应用程序的用户朋友时，它就不起作用了。代码如下：

```
<?php
echo $user_profile['name'] . " is connected.";

echo "<ul>";

$user_profile = $facebook->api('/fql?q=SELECT name, uid FROM user WHERE is_app_user=$appId and uid IN (SELECT uid2 FROM friend WHERE uid1 = me())');

foreach ($user_profile["data"] as $value) {
    $uid = $value["uid"];
    $name = $value["name"];
    echo "<li>" . $name . ": " . $uid . ".</li>";
}

echo "</ul>";
?> 
```

代码已连接到 PHP SDK，并且会话已正确设置。据说当前用户由于线路连接：

```
echo $user_profile['name'] . " is connected."; 
```

任何有关为什么这不起作用的帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:34:15.130

你在声明之前调用它`$user_profile = $facebook...`。放在那一行之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:40:07.407

尝试，

```
<?php

  echo "<ul>";

  $user_profile = $facebook->api('/fql?q=SELECT name, uid FROM user WHERE 
  is_app_user=$appId and uid IN (SELECT uid2 FROM friend WHERE uid1 = me())');

  echo $user_profile['name'] . " is connected.";

  foreach ($user_profile["data"] as $value) {
     $uid = $value["uid"];
     $name = $value["name"];
     echo "<li>" . $name . ": " . $uid . ".</li>";
 }

 echo "</ul>";
?> 
```

# ruby-on-rails - 如何过滤掉 RoR 应用程序中的查询结果？

> ID：12100890
> 
> 赞同：0
> 
> 时间：2012-08-23T22:28:13.800
> 
> 标签：ruby-on-rails

已经与 RoR 合作了一段时间，我找到了一种过滤查询结果的方法，但我不确定我做得对。就像在任何新的语言/技术中一样，你变成了一个孩子的脚本，我不喜欢它。

我有一个控制器可以做到这一点

```
@events = Appointment.scoped
@events = @events.which_user(current_user.id) 
```

然后，在约会模型中，我有这个代码来只保留给定用户 ID 的约会：

```
scope :which_user, lambda {|user_id| {:conditions => ["user_id = ?", user_id]}} 
```

我从一个例子中想出了这段代码，但我仍然几乎无法理解它。有人能告诉我一点 Ruby 魔法在这种情况下是如何工作的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:56:27.670

好吧，就像大多数 Ruby on Rails 的东西一样，在幕后有各种各样的魔法让它工作，但基本上：

```
@events = Appointment.scoped 
```

创建 SQL 查询的表示，但不执行它。这使您可以在运行之前修改查询（如果需要）。默认查询是选择表中所有行的所有字段。

```
scope :which_user, lambda {|user_id| {:conditions => ["user_id = ?", user_id]}} 
```

定义一种向 SQL 查询添加条件（或排序，或其他）的方法。因此，如果您调用`somequery.which_user(3)`，它会返回另一个查询，该查询具有 的所有限制以及必须等于`somequery`的附加限制。`user_id``3`

```
@events = @events.which_user(current_user.id) 
```

做我上面提到的。现在`@events`是一个查询，它将仅返回具有正确`user_id`.

Rails 的最后一点神奇之处在于，当您使用这些查询时，它们会自动执行并转换为记录数组。像这样的功能`each`触发了这个；如果你想遍历你的记录，那么你需要一些实际的记录来遍历——所以 Rails 运行查询并将它们提供给你。

希望有帮助！让我知道我是否留下了太模糊的东西。

**PS：** 还有默认的 Rails 方法`where`，它的工作方式非常相似。对于像这样的简单条件，它可能比使用更容易`scope`：

```
@events = Appointment.where(:user_id => current_user.id) 
```

# php - 动态放置谷歌地图

> ID：12100891
> 
> 赞同：0
> 
> 时间：2012-08-23T22:28:19.430
> 
> 标签：php, google-maps

我正在开发一个酒店预订网站，我希望在列出的每家酒店中都有一个地图部分。我的问题是，每次我将代码嵌入到表单中时，我都会插入每家酒店，我必须为从 Google 获得的每个地图[URL](http://en.wikipedia.org/wiki/Uniform_Resource_Locator)`"`用后退空格来转义引号。该站点的用户不具备执行所有这些操作的知识，那么其他选择是什么？我怎样才能在我们的任何更改中嵌入此代码？`\`

一个例子如下。

```
$map = "<iframe width=\"200\" height=\"200\" frameborder=\"0\" scrolling=\"no\" marginheight=\"0\" marginwidth=\"0\" src=\"https://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q=L8&amp;aq=&amp;sll=12.039321,-76.113281&amp;sspn=132.79415,332.753906&amp;ie=UTF8&amp;hq=&amp;hnear=Liverpool+L8,+United+Kingdom&amp;t=m&amp;z=14&amp;ll=53.389112,-2.95934&amp;output=embed\"></iframe><br /><small><a href=\"https://maps.google.com/maps?f=q&amp;source=embed&amp;hl=en&amp;geocode=&amp;q=L8&amp;aq=&amp;sll=12.039321,-76.113281&amp;sspn=132.79415,332.753906&amp;ie=UTF8&amp;hq=&amp;hnear=Liverpool+L8,+United+Kingdom&amp;t=m&amp;z=14&amp;ll=53.389112,-2.95934\" style=\"color:#0000FF;text-align:left\">View Larger Map</a></small>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:40:32.587

在表单的[PHP](http://en.wikipedia.org/wiki/PHP)端，用于`addSlashes(...);`在其中添加斜杠。

# linux - Linux 用户空间：如何将 16550 兼容的 UART 永久置于环回模式

> ID：12100898
> 
> 赞同：0
> 
> 时间：2012-08-23T22:28:56.827
> 
> 标签：linux, loopback, uart

市场上有一个兼容 16550 的 UART，我想配置它。Linux 驱动程序由制造商提供，我必须通过用户空间程序持续配置（多）UART。

持久性意味着即使我的配置器退出后配置仍保留在芯片内。

我遇到的问题是内核驱动程序中的 uart_ops 操作似乎通过其 .startup 和 .shutdown 操作影响了 MCR（调制解调器控制寄存器）的内容。手头的任务是通过将 MCR 寄存器的第 5 位（从 0 到 7）设置为 1 将 UART 置于环回模式。我通过制造商提供的 IOCTL 来做到这一点（顺便说一句，还有其他方法吗？），但是要访问 IOCTL，我必须提供一个文件描述符：这意味着一个 open()。然后，当我的配置器退出时，系统 close() 文件描述符。

因此，调用了 uart_ops.shutdown() 函数并且我的 MCR 的内容丢失了。后续应用看不到UART处于loopback模式，所以没办法测试。

怎么做？打开端口/关联设备节点，然后在 MCR 中启用环回，然后从不关闭描述符（通过睡眠或无限循环）？这是一个可以接受的解决方案吗？后续应用程序能否在环回模式下看到 UART？

如何避免在后续应用程序测试环回模式之前调用 uart_ops.shutdown 函数及其执行的 MCR 覆盖？

谢谢你。

编辑：

有问题的 UART 是 Exar XR17D158 (http://www.exar.com/connectivity/uart-and-bridging-solutions/pci-uarts/pci-uarts-universal-3-3v-or-5v/xr17d158) 和驱动程序可在此处找到：[http](http://www.exar.com/common/content/document.ashx?id=20639&languageid=1033) ://www.exar.com/common/content/document.ashx ?id=20639&languageid=1033 作为 uart_ops.startup 和 uart_ops.shutdown 成员传递的 serialxr_startup 和 serialxr_shutdown 位于第 806 行和第 902 行在 xr17c15x.c 文件中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:31:54.583

我终于解决了这个问题：不允许 Exar 驱动程序调用它的 uart_ops.shutdown() 函数：我只是在开始时打开（）设备文件，从不关闭（）它以避免驱动程序调用 uart_ops.shutdown （） 功能。为了防止操作系统在程序结束时自动调用close()，我简单的把它放到了一个无限循环中：

```
while(1) {
        sleep(100);
}
return 0; //unreachable 
```

*显然，只要调用最后一个*close() ，驱动程序就会调用 uart_ops.shutdown() 。为了防止这种情况发生，我确保至少仍然需要调用一个 close()，方法是在设备文件上维护一个 open()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:49:01.333

听起来真正的问题是您不希望 Linux 通过在启动时自动加载内核驱动程序并自动初始化设备来对您进行第二次猜测。

如果是这样，您最好的选择可能是配置“modprobe.conf”以*禁用*供应商内核驱动程序的自动加载：

*   [http://www.cyberciti.biz/tips/avoid-linux-kernel-module-driver-autoloading.html](http://www.cyberciti.biz/tips/avoid-linux-kernel-module-driver-autoloading.html)

如果这可行，您可以通过添加自己的启动脚本来“增强”解决方案，以您自己的方式进行配置。如果你愿意。

'希望有帮助！

# nservicebus - 从 NServiceBus 发送多条消息

> ID：12100902
> 
> 赞同：1
> 
> 时间：2012-08-23T22:29:16.840
> 
> 标签：nservicebus

**简介**
我最近使用 NServiceBus 设计器工具在同一解决方案中创建了一些应用程序。这一切都很好，因为它使我可以将所有内容保持在既定标准。我注意到的是，该工具似乎希望在我创建的服务中将所有消息、命令和事件保留在它们自己的程序集中。

考虑以下设置：
解决方案名称：TestCompany已
创建服务：TestCompany.Sales、TestCompany.Finance、TestCompany.Monitoring

以上将创建一个 TestCompany.InternalMessages 程序集，并且监控服务本质上是一个中心点，其中记录了可能发生的任何错误。我希望其他服务可以通过它发送消息。

**问题**
在这种情况下，我担心的是，我希望销售服务向财务服务发送消息，并在发生错误时向监控发送错误消息。在 unicastbus 设置中，您输入程序集及其目的地，但是我基本上想为程序集中的不同消息输入不同的目的地。我知道我可以很好地创建自己的程序集并将消息移动到它，但这似乎与设计师试图推动我的目标背道而驰。有什么建议么？

**更新**：

我相信我必须处理的问题与安装建模模板的方式略有关系。我注意到它们不太适合我，因为我无法将组件添加到端点设计器，也无法在没有收到空引用异常的情况下右键单击。删除并重新安装似乎无法解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T09:21:07.153

我们在建模工具中采用这种方法的原因是 Visual Studio 的性能会随着项目数量的增加而降低。在当前的计划中，这是最小的弊端。

您应该查看的一件事是内置的审核功能，因为它们会将流经系统的所有消息转发到中央队列 - 您可以将监控服务放在该中央队列后面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T08:20:14.067

您可以为程序集中的每条消息输入目标。我不知道这是如何通过 NServiceBus 设计器工具完成的，但在您的配置中，这看起来像：

```
<UnicastBusConfig>
    <MessageEndpointMappings>
        <add Messages="TestCompany.SalesMessages.NewSaleCreatedMessage" Endpoint="FinanceService" />
        <add Messages="TestCompany.SalesMessages.ErrorMessage" Endpoint="MonitoringService" />
    </MessageEndpointMappings>
</UnicastBusConfig> 
```

最佳做法是为每个服务创建一个消息程序集。（同样我不知道设计师如何处理这个）

# sql-server - 尝试执行连接两个表、具有 where 子句并将结果分组的 linq 查询

> ID：12100903
> 
> 赞同：0
> 
> 时间：2012-08-23T22:29:22.480
> 
> 标签：sql-server, linq, linq-to-sql

我确信这是一个简单的，但我不能让它工作。这是我用作参考的 SQL 查询。我想用 LINQ 做同样的事情。

SQL：

```
select
schedulegroupslist.Schedule_Group_Key,
schedulegroupslist.Group_Name
from schedulegroupslist
inner join schedules on schedules.schedule_group_key = schedulegroupslist.Schedule_Group_Key
where schedules.Active = 1
and schedulegroupslist.Schedule_Count > 0
and schedulegroupslist.Active = 1
group by schedulegroupslist.Schedule_Group_Key
,schedulegroupslist.Group_Name 
```

这是我认为可以解决问题的 linq，但我在组计划行上得到了一个空引用异常。

林克：

```
var included = from g in allGroups
           join s in allSchedules 
           on g.ScheduleGroupKey equals s.GroupKey into sg
           from schedules in sg.Where(s => s.Active == true 
                                           && g.ScheduleCount > 0 
                                           && g.Active == true).DefaultIfEmpty()
           group schedules by 
                    new { schedules.Key, schedules.ScheduleGroupName } 
                    into schedulesgroup
           select new { GroupName = schedulesgroup.Key.ScheduleGroupName,
                        ScheduleGroupKey = schedulesgroup.Key.Key }; 
```

对linq不太流利，所以也许有人可以告诉我一个更好的方法来完成我正在做的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:48:45.287

尝试这个：

```
var included = from g in allGroups
               join s in allSchedules on g.ScheduleGroupKey equals s.GroupKey
               where s.Active && g.ScheduleCount > 0 && g.Active
               group s by new { s.Key, s.ScheduleGroupName } into grp
               select new
               {
                   ScheduleGroupKey = grp.Key.Key,
                   GroupName = grp.Key.ScheduleGroupName,
               }; 
```

我认为在这种情况下分组是没有用的，所以这可能会更好：

```
var included = from g in allGroups
               join s in allSchedules on g.ScheduleGroupKey equals s.GroupKey
               where s.Active && g.ScheduleCount > 0 && g.Active
               select new
               {
                   ScheduleGroupKey = s.Key,
                   GroupName = s.ScheduleGroupName,
               }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:49:26.700

```
var included = from g in allGroups
           join s in allSchedules on g.ScheduleGroupKey equals s.GroupKey
           where s.Active == true 
                 && g.ScheduleCount > 0 
                 && g.Active == true
           group g by new { g.ScheduleGroupKey, g.ScheduleGroupName } into gr
           select new 
           {
               gr.Key.ScheduleGroupKey,
               gr.Key.ScheduleGroupName
           } 
```

# javascript - 将变量分配给函数在 JavaScript 中不起作用？

> ID：12100904
> 
> 赞同：2
> 
> 时间：2012-08-23T22:29:30.297
> 
> 标签：javascript

我有一些代码可以读取突出显示的文本。但是我在为 JavaScript 中的函数分配变量时遇到了麻烦。它没有按预期正确调用该函数。

```
<html>
<head>
<script type="text/javascript">

function getSelectionText()
{
    var text = "";
    if (window.getSelection)
    {
        text = window.getSelection().toString();
    }

    return text;
}

var txt = getSelectionText();   //<-----This is not working???

</script>
</head>
<body>
<p id="p1">Select some of this text then press the button<br /></p>

<button onclick= document.write(txt) >GetText</button>
</body>

</html> 
```

如果我在写入参数中使用该函数，它就可以工作。

```
<button onclick= document.write(getSelectionText()) >GetText</button> 
```

如果我为它分配一个变量，为什么不能正确调用该函数？

-斯科特A

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:34:05.977

您`getSelectionText()`在页面加载时调用，因此当时不会选择任何文本。

您需要从事件处理程序中调用它。

此外，您是：

*   使用内在的事件属性（[你不应该](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)）
*   不引用您的属性值（这是不好的做法）
*   在文档加载后尝试调用`document.write`（当它处于关闭状态时）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:38:03.843

这与分配变量无关，而是在调用函数时。

在您的工作版本中，按下按钮时会调用 getSelectionText()。在不工作的版本中，一旦`<script>`加载标签就会调用 getSelectionText() ......当按下按钮时，早期调用的结果就是正在使用的结果。

因为您想要的是在按下按钮时调用该函数，所以这就是您明确需要做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:40:52.383

我刚刚让你的代码工作。在大多数情况下。基本上，我不依赖该`txt`变量，而是使用您的主要功能打印到网页。你为什么不试试[这个](http://jsfiddle.net/DZhD8/1/)，看看你想要改进什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-23T22:47:29.380

您的行 var txt = ... 正在将全局变量 txt 初始化为 getSelectionTxt() 的返回值

理解全局变量是如何初始化的关键是意识到赋值是在加载 javascript 时进行的，而不一定是在加载 HTML DOM 时进行的。结果，在许多情况下，在 DOM 的其他部分准备好之前，全局分配将被评估得太早。

一种延迟事情的方法是使用 body.onload 事件或函数。您可以在 body 标签中设置事件，例如这里在正确的时间调用您的某些功能。

```
<body onload="initializeMyGlobalsFromDom()"> 
```

其中 initializeMyGlobalsFromDom 是一个函数，其中包含您的行 txt = getSelectionTxt(); // 注意：省略 var 关键字以将 txt 称为全局

（您应该继续在函数外部声明“var txt;”，最佳实践可能会在函数内使用它之前说。）

还有一些方法可以在不需要 HTML 标记中的属性的情况下挂钩事件。在全局上下文中（现在你有 var txt = ... ）你可以做

```
window.addEventListener("onload",initializeMyGlobalsFromDom); 
```

* * *

另一个选择是将函数本身分配给全局变量，如下所示：

var txtFn = getSelectionText; // 注意赋值函数不是函数返回值

然后当你使用全局变量时，你必须调用它：

```
<button onclick="document.write(txt())">GetText</button> 
```

# c# - 从 c# 中的过程返回结果时，空格更改为“_”

> ID：12100908
> 
> 赞同：1
> 
> 时间：2012-08-23T22:29:53.123
> 
> 标签：c#, stored-procedures, datagridview, datagridviewcolumn

我的表单中有存储过程和 DataGridView 的数据库。我想将过程结果绑定到 DataGridView 并且一切正常 - 表格正在填充过程的结果，但列有下划线（“_”）而不是空格。
例如：“Cookies count”显示为“Cookies_count”。

存储过程设置列名中的代码：
`SELECT
Films.TitlePL as [Polish title],
Films.TitleOrg as [Original title],
FilmCategory.CategoryName as [Category name],
Films.ProductionYear as [Year of production],` 

带有参数和绑定到 DataGridView 的运行过程的 C# 代码在这里：

```
 var result = DB.spFilmFindSearchGridview(null, null, null, null, null, null, null, null);

      List<spFilmFindSearchGridviewResult> Res = new List<spFilmFindSearchGridviewResult>();
      Res = result.ToList();

      DataGridViewFilmFind.DataSource = Res; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:11:27.247

我想你正在使用 EF 或 linq to sql？这一定是该框架的一个特点。因为 spFilmFindSearchGridviewResult 是一个类，它的属性名称中不能有空格，所以框架必须添加下划线。

编辑：要解决此问题，您应该自己创建列并将 AutoGenerateColumns 设置为 false

# ruby-on-rails - 导轨 + 载波 + 雾 + S3 插座错误

> ID：12100909
> 
> 赞同：16
> 
> 时间：2012-08-23T22:29:58.900
> 
> 标签：ruby-on-rails, amazon-s3, carrierwave, fog

我在尝试将 S3 服务与雾和 Jquery 文件上传（https://github.com/blueimp/jQuery-File-Upload）一起使用时遇到了这个问题

错误

```
Excon::Errors::SocketError (getaddrinfo: nodename nor servname provided, or not known (SocketError)): 
```

当我尝试在控制器中调用“保存”方法时会发生这种情况。我将carrierwave设置如下：

## **配置/初始化程序/carrierwave.rb**

```
CarrierWave.configure do |config|
  config.fog_credentials = {
    :provider               => 'AWS', 
    :aws_access_key_id      => 'access_key_here', 
    :aws_secret_access_key  => 'secret_key_here', 
    :region                 => 'eu-east-1'
  }
  config.fog_directory  = 'folder_name_here'
  config.fog_public     = false 
  config.fog_attributes = {'Cache-Control'=>'max-age=315576000'}
  config.storage = :fog
end 
```

而我的上传者只是“config.storage :fog”和“store_dir” 现在，我已经创建了我的存储桶。

我错过了一些配置吗？它甚至不适用于我的开发环境。

请任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-24T19:39:56.563

区域名称错误。它应该是“us-east-1”

# javascript - D3 - 如何使分区布局的可视化具有等分的扇区？

> ID：12100914
> 
> 赞同：1
> 
> 时间：2012-08-23T22:30:04.157
> 
> 标签：javascript, d3.js

我正在使用 D3 来实现分区布局的可视化。我需要的是分割的部分具有相同的宽度，如下所示：

![期望的结果](../Images/497eb9d5cfeac584a80fb603dccac9a3.png)

但我目前拥有的是：

![当前版本](../Images/22f73909d1d00bfa7615be93f0c40d46.png)

您可以在 Codepen 上找到当前版本，但我也在[此处复制代码：](http://codepen.io/anon/pen/Bfpmg)

```
var w = 960,
    h = 500,
    x = d3.scale.linear().range([0, w]),
    y = d3.scale.linear().range([0, h]),
    color = d3.scale.ordinal().range(["rgb(255,247,236)","rgb(254,232,200)","rgb(253,212,158)","rgb(253,187,132)","rgb(252,141,89)","rgb(239,101,72)","rgb(215,48,31)","rgb(179,0,0)","rgb(127,0,0)"]);

var vis = d3.select("#chart").append("svg:svg")
    .attr("width", w)
    .attr("height", h);

var partition = d3.layout.partition()
    .children(function(d) { return isNaN(d.value) ? d3.entries(d.value) : null; })
    .value(function(d) { return d.value; });

var data = {
  'root': {

    'asdf': {
      'a': {
        'kdjfklsfj': 1,
        'kdjfklsfsj': 1
      },
      'b': 1
    },

    'bnm': {
      'c': 1,
      'd': {
        'lsdkjfdkljsf': {
          'lsdkfj': 1,
          'kldsjfdlk': 1
        },
        'kdjfkjsdfk': 1
      }
    }

  }
};

var rect = vis.selectAll("rect")
    .data(partition(d3.entries(data)[0]))
    .enter().append("svg:rect")
    .attr("x", function(d) { return x(d.x); })
    .attr("y", function(d) { return y(d.y); })
    .attr("width", function(d) { return x(d.dx); })
    .attr("height", function(d) { return y(d.dy); })
    .attr("fill", function(d) { return color((d.children ? d : d.parent).data.key); })
    .on("click", click);

function click(d) {
  x.domain([d.x, d.x + d.dx]);
  y.domain([d.y, 1]).range([d.y ? 20 : 0, h]);

  rect.transition()
    .duration(750)
    .attr("x", function(d) { return x(d.x); })
    .attr("y", function(d) { return y(d.y); })
    .attr("width", function(d) { return x(d.x + d.dx) - x(d.x); })
    .attr("height", function(d) { return y(d.y + d.dy) - y(d.y); });
} 
```

我发现改变数据值（目前所有项目的值都是“1”）自然会增加元素的宽度，但我怎样才能让它有一个等分的盒子呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:01:43.660

您告诉分区函数将每个块的宽度计算为值（如果有的话）或其子值的总和。听起来您想在后一种情况下使用子节点的*数量*作为权重，例如，顶部节点被拆分为 1/2 和 1/2 而不是 4/7 和 3/7。

**编辑：** d3 的 partition() 对象旨在根据其子元素的大小之和来确定父元素的大小，而（如果我理解您的用例）您希望从父母的大小，基于其兄弟姐妹的数量。

要使其正常工作，您必须管理叶节点对象值以“欺骗”d3 执行您想要的操作。这是一个`data`使第一级具有偶数长度的对象：

```
var data = {
  'root': {

    'asdf': {
      'a': {
        'kdjfklsfj': 1/6,
        'kdjfklsfsj': 1/6
      },
      'b': 1/6
     },

    'bnm': {
      'c': 1/8,
      'd': {
        'lsdkjfdkljsf': {
          'lsdkfj': 1/8,
          'kldsjfdlk': 1/8
        },
        'kdjfkjsdfk': 1/8
      }
    }
  }
}; 
```

换句话说，您必须管理数据以符合 d3 的期望。应该执行此操作的不是 d3 操作，而是您的数据生成器。

# ruby-on-rails - Ruby on Rails 教程第 7.2 节，我的输入字段太小，为什么？

> ID：12100917
> 
> 赞同：0
> 
> 时间：2012-08-23T22:30:55.077
> 
> 标签：ruby-on-rails

我正在关注这个 Ruby on Rails[教程](http://ruby.railstutorial.org/chapters/sign-up#sec-using_form_for)，在完成注册表单的 html 和 css 的步骤之后，我得到了下面的第一张图片。与教程显示我应该得到的第二张图片相比，输入文本字段要小得多。有人可以解释这是怎么发生的吗？

![在此处输入图像描述](../Images/f50ed46e1f088a8a91a50ce7c870a1a6.png) ![在此处输入图像描述](../Images/50d9871ce10a7c455aa6366eb136820c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:35:01.550

这可能是因为页面显示在不同的浏览器中，甚至显示在同一个浏览器中，您的字体设置（大小、默认字体系列等）可能与另一个不同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:57:02.677

当您未设置 HTML5 文档类型时，Bootstrap 会发生这种情况。确保您已`<!DOCTYPE html>`在布局的顶部，如教程的清单 7.1 所示。

那里发生了什么？我不知道这里使用的是什么 HTML5 功能，但 Bootstrap 假设它是可用的。您的浏览器将页面视为 5 之前的 HTML 并且无法正确呈现。因此，添加 doctype 会指示浏览器按照 Bootstrap 所期望的方式进行操作。

见顶部：http: [//twitter.github.com/bootstrap/scaffolding.html](http://twitter.github.com/bootstrap/scaffolding.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T05:21:54.203

我发现 Bootstrap 为表单中的输入字段生成了 css `input[type="something"]`。这解释了为什么仅`input`在指定 css 时使用不起作用，因为 Bootstrap 生成的更具体的 css 规则会覆盖我的规则。

```
/* line 59, ../../../../.rvm/gems/ruby-1.9.3-p194/gems/bootstrap-sass-2.0.4.0/vendor/assets/stylesheets/bootstrap/_forms.scss */
select, textarea, input[type="text"], input[type="password"], input[type="datetime, [type="datetime-local"],
input[type="date"], input[type="month"], input[type="time"], input[type="week"], input[type="number"],
input[type="email"], input[type="url"], input[type="search"], input[type="tel"], input[type="color"], .uneditable-input {
    display: inline-block;
    height: 18px;
    padding: 4px;
    margin-bottom: 9px;
    font-size: 13px;
    line-height: 18px;
    color: #555555;
} 
```

# sql - 如何合并两个日期最接近的两个表？

> ID：12100924
> 
> 赞同：1
> 
> 时间：2012-08-23T22:31:47.537
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有两个表 A 和 B，如下所示。我想按项目合并它们，但仅限于退货日期在订单日期之后且退货日期最接近该项目的相应订单日期的地方。结果表如下C。您能帮忙看看我如何在 SQL 代码中实现这种合并吗？

退货日期不必与订单日期在同一年，但鉴于退货日期在订单日期之后，应将其分配到最接近的订单日期。例如，对于项目 1，退货日期 2009 年 9 月 15 日在项目 1 的三个订单日期中最接近 2009 年 8 月 14 日，因此分配到 2009 年 8 月 14 日。同样对于商品 1，退货日期 9/15/2011 是商品 1 的所有三个订单日期之后，但它最接近 8/16/2011，因此它被分配到 8/16/2011。

非常感谢！

表 A：

```
Items    Order_Date
1        8/14/2009
1        8/15/2010
1        8/16/2011
2        9/10/2009
2        9/8/2010
2        9/12/2011 
```

表 B：

```
Items    Return_Date
1        9/15/2009
1        9/15/2011
2        10/15/2010
2        11/15/2011 
```

最终结果表 C：

```
Items        Order_Date    Return_Date
1            8/14/2009     9/15/2009
1            8/15/2010     NULL
1            8/16/2011     9/15/2011
2            9/10/2009     NULL
2            9/8/2010      10/15/2010
2            9/12/2011     11/15/2011 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T07:48:24.553

我也用过[`APPLY`](http://msdn.microsoft.com/en-us/library/ms177634)这里。它似乎与您的示例数据相匹配：

（答案末尾的样本数据）

```
;with MatchedOrders as (
    select
        a.Items,a.Order_Date, b.Return_Date 
    from
        @TableB b
            cross apply
        (select top 1 * from @TableA a
             where a.Items = b.Items and a.Order_Date < b.Return_Date
             order by a.Order_Date desc) a
)
select
    a.Items,
    a.Order_Date,
    mo.Return_Date
from
    @TableA a
        left join
    MatchedOrders mo
        on
            a.Items = mo.Items and a.Order_Date = mo.Order_Date 
```

结果：

```
Items       Order_Date                  Return_Date
----------- --------------------------- ---------------------------
1           2009-08-14 00:00:00.0000000 2009-09-15 00:00:00.0000000
1           2010-08-15 00:00:00.0000000 NULL
1           2011-08-16 00:00:00.0000000 2011-09-15 00:00:00.0000000
2           2009-09-10 00:00:00.0000000 NULL
2           2010-09-08 00:00:00.0000000 2010-10-15 00:00:00.0000000
2           2011-09-12 00:00:00.0000000 2011-11-15 00:00:00.0000000 
```

* * *

样本数据：

```
declare @TableA table (Items int not null,Order_Date datetime2 not null)
insert into @TableA(Items,Order_Date) values
(1,'20090814'),
(1,'20100815'),
(1,'20110816'),
(2,'20090910'),
(2,'20100908'),
(2,'20110912')

declare @TableB table (Items int not null,Return_Date datetime2 not null)
insert into @TableB(Items,Return_Date) values
(1,'20090915'),
(1,'20110915'),
(2,'20101015'),
(2,'20111115') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:44:21.810

我认为 OUTER APPLY 是您所需要的。您是否尝试过这样的事情（SQLServer）：

```
Select A.ItemID, A.OrderDate, [ReturnDates].ReturnDate
from Orders A
    OUTER APPLY (
        select Min(ReturnDate) as ReturnDate 
        From [Returns] b 
        where b.ReturnDate >= A.OrderDate AND b.ItemID = A.ItemID
        ) as ReturnDates 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T07:47:23.697

试试这个：

```
select  ord.Items,ord.Order_Date,l.Return_Date  from orders ord
left join 
(
select * from (
select *,row_number() over (partition by return_date order by diff asc) as rn from (

select b.Items,b.Order_Date,a.Return_Date,a.diff  from 

(select o.Items,o.Order_Date,r.Return_Date,DATEDIFF(dd,o.Order_Date,r.Return_Date) diff  from orders o join ord_ret r
on o.Items = r.Items) a inner join 

(select a.Items,a.Order_Date,MIN(abs(a.diff)) as diff
from (
select o.Items,o.Order_Date,r.Return_Date,DATEDIFF(dd,o.Order_Date,r.Return_Date) diff  from orders o join ord_ret r
on o.Items = r.Items ) a
group by a.Items,a.Order_Date) b

on a.Items = b.Items and a.diff = b.diff  and a.Return_Date > b.Order_Date ) a) final
where rn<> 2) l

on ord.Items = l.Items and ord.Order_Date = l.Order_Date 
```

# javascript - 动态“注入”内容时jQuery模态窗口不居中

> ID：12100925
> 
> 赞同：0
> 
> 时间：2012-08-23T22:31:57.613
> 
> 标签：javascript, jquery, css, modal-dialog, centering

我在使用特定脚本时遇到了一些问题。我找到了一个我正在尝试实现的简单模式窗口脚本。最初的功能是它会简单地隐藏/显示带有“静态”内容的窗口 div。这很好，但我需要能够动态指定内容的能力。所以我通过允许*.load()*函数用于“注入” div 的内容来改变事情，然后脚本将简单地显示窗口正常。但是，当模式关闭时，我使用*.empty()*清空了 div 的内容，以便能够根据用于打开模型窗口的链接中的属性值动态添加不同的内容。

*如果我使用.load()*函数而不是将代码硬编码`<embed>`到 div 的内容中，那么一切都工作得很好，除了窗口不在屏幕中间。如果我对对象进行硬编码，`<embed>`它会很好地居中并且看起来很棒。

`<embed>`显然，如果将对象动态注入到 div中，则整体窗口高度/宽度存在差异。我尝试`.load()`在脚本查找窗口 div 的总宽度/高度之前和之后定位函数，但这似乎没有任何影响。

任何帮助将不胜感激！！

这是脚本：

```
$(document).ready(function() {  

    //select all the a tag with name equal to modal
    $('a[name=modal]').click(function(e) {
        //Cancel the link behavior
        e.preventDefault();

        //Get the A tag
        var id = $(this).attr('href');
        //Get source file for AJAX request
        var source = $(this).attr('src');

        //If source is set, send ajax request, and then load content into window
        if(source != undefined) {
            $('.window').load(source);
        }

        //Get the screen height and width
        var maskHeight = $(document).height();
        var maskWidth = $(window).width();

        //Set heigth and width to mask to fill up the whole screen
        $('#mask').css({'width':maskWidth,'height':maskHeight});

        //transition effect     
        $('#mask').fadeIn(1000);    
        $('#mask').fadeTo("slow",0.8);  

        //Get the window height and width
        var winH = $(window).height();
        var winW = $(window).width();

        //Set the popup window to center
        $(id).css('top',  winH/2-$(id).height()/2);
        $(id).css('left', winW/2-$(id).width()/2);

        //transition effect
        $(id).fadeIn(2000); 

    });

    //if close button is clicked
    $('.window .close').click(function (e) {
        //Cancel the link behavior
        e.preventDefault();

        $('#mask').fadeOut("slow");
        $('.window').fadeOut("slow", function() {       
            $(this).empty();
        });
    });     

    //if mask is clicked
    $('#mask').click(function () {
        $(this).fadeOut("slow");
        $('.window').fadeOut("slow", function() {
            $(this).empty();
        });
    });         
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:52:30.243

这是因为 load 正在触发 AJAX 请求，并且您的居中代码在加载内容之前正在运行。您需要做的是在 ajax 完成处理程序中居中模式。

```
$('.window').load(source,null,function(){ functionThatCentersModal() }); 
```

# ios - 为什么 UIAElement 的孩子不等于自己？

> ID：12100928
> 
> 赞同：3
> 
> 时间：2012-08-23T22:32:56.210
> 
> 标签：ios, xcode, instruments, ios-ui-automation

我注意到我不久前编写的 UIAutomation 脚本中有一些奇怪的行为，而我有一段时间没有运行过。我的断言失败了；在做了一些挖掘之后，我看到在迭代 UIAElement 时`.elements()`，子元素似乎不等于它们自己。

这在过去对我来说很有效，但似乎至少在 XCode 4.3.2 中被破坏了

重现：

1.  创建单视图应用
2.  在视图中抛出一些元素，在元素上设置辅助功能标签，以便它们被 UIAutomation 拾取
3.  在 UIAutomation 中运行以下脚本：

    ```
    var elements = UIATarget.localTarget().frontMostApp().mainWindow().elements();
    for (var i = 0; i < elements.length; i++) {
      var el1 = elements[i];
      var el2 = elements[i];
      var equals = (el1 == el2);
      UIALogger.logMessage(el1.label() + " is equal to " + el2.label() + " ? " + equals);
    } 
    ```

4.  看到这一点`el1`并且`el2`似乎没有引用同一个对象。

我不确定这是否是预期的行为，尽管这对我来说似乎很离谱。如果有人有任何见解，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T09:59:30.117

不确定这是否有帮助，但您可以尝试 === 运算符来比较对象吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-14T14:19:35.503

这实际上是 UIAutomation 软件中的一个已知错误。我想出的解决方法是根据元素的所有可用属性进行测试。这是一个真正的屁股痛。

```
 var el1 = ELEMENT_1;

 var el1x = el1.rect().origin.x;
 var el1y = el1.rect().origin.y;
 var el1w = el1.rect().size.width;
 var el1h = el1.rect().size.height;
 var el1n = el1.name();

 var el2 = ELEMENT_2;

 var el2x = el2.rect().origin.x;
 var el2y = el2.rect().origin.y;
 var el2w = el2.rect().size.width;
 var el2h = el2.rect().size.height;
 var el2n = el2.name();

 if(el1x == el2x && el1y == el2y &&
      el1w == el2w && el1h == el2h &&
      el1n == el2n)
 {
      // Elements are equal
      return true;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-03T18:17:56.823

看看 tuneup.js ( [http://www.tuneupjs.org/](http://www.tuneupjs.org/) )。这个库使 iOS UIAutomation 变得更加愉快。它所做的一件事是扩展 UIAElements 的功能，使用 tuneup 代码中的上述行将是

`var equals = (el1.equals(el2));`

# android - 为什么我无法使用 ICS 内置快捷方式截取我的应用程序的屏幕截图？

> ID：12100933
> 
> 赞同：7
> 
> 时间：2012-08-23T22:33:21.937
> 
> 标签：android, screenshot

起初，这似乎不是问这个问题的合适地方......但由于我只注意到我自己的应用程序存在这个问题，我想没有其他地方可以问它。也许我做错了什么，但我不知道是什么......

您可能知道，ICS 允许您按屏幕截图`Power + VolumeDown`。我拥有一台 HTC One X，快捷方式是`Power + Home`. 我不知道这是否会改变任何东西（也许有 Galaxy Nexus 的人可以尝试一下）。

我自己的应用程序，通知议程（我不会链接它，所以我不会被指控为垃圾邮件或类似的东西，但如果不自我宣传我的应用程序原因，我真的无法发布这个问题），不允许我用上面的组合键和我的 One X 截屏。我可以截取任何其他应用程序的屏幕截图，但它不能单独运行......

你到底认为我在做什么来“禁用”这个？我的应用程序非常简单，而且发生这种情况的情况并不多。有任何想法吗？

每次我尝试截取我的应用程序的屏幕截图时，我都会在 logcat 中得到这个：

```
08-24 00:15:40.570: E/InputManager-JNI(277): An exception was thrown by callback 'interceptKeyBeforeDispatching'.
08-24 00:15:40.570: E/InputManager-JNI(277): java.lang.StringIndexOutOfBoundsException: length=83; regionStart=-1; regionLength=83
08-24 00:15:40.570: E/InputManager-JNI(277):    at java.lang.String.startEndAndLength(String.java:593)
08-24 00:15:40.570: E/InputManager-JNI(277):    at java.lang.String.substring(String.java:1474)
08-24 00:15:40.570: E/InputManager-JNI(277):    at com.android.internal.policy.impl.PhoneWindowManager.interceptKeyBeforeDispatching(PhoneWindowManager.java:2375)
08-24 00:15:40.570: E/InputManager-JNI(277):    at com.android.server.wm.InputMonitor.interceptKeyBeforeDispatching(InputMonitor.java:307)
08-24 00:15:40.570: E/InputManager-JNI(277):    at com.android.server.wm.InputManager$Callbacks.interceptKeyBeforeDispatching(InputManager.java:663)
08-24 00:15:40.570: E/InputManager-JNI(277):    at dalvik.system.NativeStart.run(Native Method) 
```

屏幕截图有效时不会发生这种情况。而是记录了对屏幕截图应用程序的大量其他调用以及许多其他事情。

为什么我的应用程序会阻止屏幕截图并生成上述错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-25T22:53:45.513

可能导致这种情况的一件事是为您的窗口打开 FLAG_SECURE。 [http://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_SECURE](http://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_SECURE)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T17:19:21.790

我会检查截取屏幕截图的应用程序（对您所说的组合键做出反应的应用程序）是否已注册为系统应用程序。Android 设计阻止应用共享帧缓冲区，因此任何试图截取屏幕截图的应用都不会这样做。

深入了解该应用程序的行为和设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T21:24:24.223

我有同样的问题。您可以使用 Eclipse 的 DDMS 透视图截取屏幕截图，只需运行您的应用程序，进入 DDMS 透视图并单击“设备”选项卡上的相机图标

# c++ - 如何使用 std::lock_guard 锁定对 std::map 的读写访问？

> ID：12100937
> 
> 赞同：2
> 
> 时间：2012-08-23T22:33:38.913
> 
> 标签：c++, exception, c++11, native, mutex

当我在 MSVC 2012 中逐步执行以下代码时，我在第 3 行和第 8 行放置了一个断点。

第一个中断出现在第 8 行。

lock_guard 调用得很好，然后我们在第 3 行中断。这一次，由于已经获得了锁，所以当我跨步时会抛出异常。

我真的希望它继续前进，因为它仍然是同一个线程调用（我们刚从第 11 行来。）

是否有另一种更适合这种情况的锁定机制？

我有本机 win32 编程的背景，所以我习惯于 WaitForSingleObject，它会让我轻松通过这里，但 lock_guard 没有。

我应该处理异常吗？我见过的所有例子都没有任何类型的 lock_guard 异常处理程序......

有没有更好的方法来确保地图一次不被多个线程访问？我需要对其进行写入和读取锁定，并且 lock_guard 似乎是一个平滑的选择，因为我不必 ReleaseMutex ...

```
 //Cars.h
    mutable std::mutex carsMutex;
    class Cars
    {
    private:
        std::map<std::string,Cars> _cars;
    public:
        virtual ~Cars() {}
        Cars() {}
        Cars & operator[](const std::string &key);
        Cars & operator[](const DWORD &key);
        std::string color;
    };

    //Cars.cpp
      #include "Cars.h"
1\.    Cars & Cars::operator[](const std::string &key)
2\.    {
3\.        std::lock_guard<std::mutex> lock_a(carsMutex);
4\.        return _cars[key];
5\.    }
6\.    Cars & Cars::operator[](const DWORD &key)
7\.    {
8\.        std::lock_guard<std::mutex> lock_a(carsMutex);
9\.        std::stringstream ss;
10\.       ss << key;
11\.       return operator[](ss.str());
12\.   }
14\.   void main()
15\.   {
16\.       //ok i have multiple threads like this one writing and reading from the map
17\.       Cars cars;
18\.       cars[(DWORD)2012]["volvo"].color = "blue";
19\.   } 
```

**更新：** 这是我对上面代码的编辑。我已经考虑了答案，这是我正确使用 std::lock_guard 的新尝试，如果不正确，请发表评论。

```
 //Cars.h
    mutable std::recursive_mutex carsMutex;
    class Cars
    {
    private:
        std::string _color;
        std::map<std::string,Cars> _cars;
    public:
        virtual ~Cars() {}
        Cars() {}
        Cars & operator[](const std::string &key);
        Cars & operator[](const DWORD &key);
        void color(const std::string &color);
        std::string color();
    };

       //Cars.cpp
       #include "Cars.h"
 1\.    Cars & Cars::operator[](const std::string &key)
 2\.    {
 3\.        std::lock_guard<std::recursive_mutex> lock(carsMutex);
 4\.        return _cars[key];
 5\.    }
 6\.    Cars & Cars::operator[](const DWORD &key)
 7\.    {
 8\.        std::lock_guard<std::recursive_mutex> lock(carsMutex);
 9\.        std::stringstream ss;
10\.        ss << key;
11\.        return operator[](ss.str());
12\.    }
13\.    void color(const std::string &color)
14\.    {
15\.        std::lock_guard<std::recursive_mutex> lock(carsMutex);
16\.        _color = color;
17\.    }
18\.    std::string color()
19\.    {
20\.        std::lock_guard<std::recursive_mutex> lock(carsMutex);
21\.        return _color;
22\.    }
23.
24\.    Cars cars;//this is global...
25\.    void main()
26\.    {
27\.        //ok i have multiple threads like this one writing and reading from the map
28\.        cars[(DWORD)2012]["volvo"].color("blue");
29\.    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:35:59.397

要允许线程重新获取它已经拥有的互斥锁，您需要`std::recursive_mutex`而不是`std::mutex`.

但是，您有一个更大的问题：您的访问器在返回用于分配映射元素的引用*之前解锁互斥锁，因此分配本身是不受保护的。*这可以通过编写一个在返回之前执行赋值的“setter”函数来解决；或者通过返回包含在其析构函数中释放的互斥锁的代理对象。解决这个问题可能会消除对`recursive_mutex`.

# android - 如何列出我的应用程序支持的语言

> ID：12100938
> 
> 赞同：2
> 
> 时间：2012-08-23T22:33:43.947
> 
> 标签：android

该应用程序有许多本地化文件夹：

```
values-cs
values-da
values-de
values-es
... 
```

如何在运行时枚举所有支持的语言？当然，我可以定义一些常量来列出所有值“cs, da, de, ...”，但要避免这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:58:59.783

我认为这可以工作...

```
enum Language {
      en, fr, de, cs
} 
```

然后在你的活动中......

```
List<Language> langs = new ArrayList<Language>();
for(String lan : ctx.getAssets().list("/res")) {
 if(lan.startsWith("values-")) {
   langs.add(Language.valueOf(lan.substring(lan.lastIndexOf('-') + 1)))'
 }
} 
```

# python - 在 python 中使用 pymysql 从 MySQL 访问一个值

> ID：12100939
> 
> 赞同：1
> 
> 时间：2012-08-23T22:33:46.480
> 
> 标签：python, mysql, python-3.x, mysql-python

我正在尝试使用`pymysql`. 我目前的解决方案是 3 行代码。这是处理这个问题的最好方法吗？

```
import pymysql

conn = pymysql.connect(host='localhost', user='root', passwd='')
conn.autocommit(True)
cur = conn.cursor()

memory = '100'

# I want to access one item from mySQL
cur.execute("""SELECT id FROM scada.sensors WHERE memory='{}'""".format(memory))
for x in cur.fetchall(): # only runs once
   sensor_id=x[0] 
```

我需要这个 for 循环来访问 的内容`cur.fetchall()`吗？

我正在使用 Python 3.2.3

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-23T22:39:54.323

如果您只对一个值（或第一个值）感兴趣，则可以使用该`fetchone`方法代替`fetchall`. 这是[MySQLdb 文档中](http://mysql-python.sourceforge.net/MySQLdb.html#some-examples)的一个示例（pymysql 说它复制了整个 MySQLdb API）。

# visual-studio - 如何修改损坏的 Microsoft SDK 头文件 ShlObj.h

> ID：12100943
> 
> 赞同：1
> 
> 时间：2012-08-23T22:33:52.003
> 
> 标签：visual-studio, windows-7, winapi

在我的开发计算机中，ShlObj.h 文件已被修改。

损坏的 ShlObj.h 代码如下。我需要`CSIDL_APPDATA`在我的代码中使用宏。

```
#define CSIDL_APPDATA  F                 0x001a        // <user name>\Application Data 
```

（文件路径：c:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Include\ShlObj.h）

我无法手动修改文件 ShlObj.h。看来我没有修改文件所需的权限。

我应该修复还是重新安装 SDK？

环境：Win7 64位/Visual Studio 2010

# pointers - 循环队列大小

> ID：12100944
> 
> 赞同：2
> 
> 时间：2012-08-23T22:33:56.073
> 
> 标签：pointers, size, circular-buffer

> **可能重复：**
> [如何查找循环队列中的元素数量](https://stackoverflow.com/questions/4459141/how-to-find-number-of-elements-in-a-circular-queue)

我正在实现一个循环队列，但我无法正确获取队列的大小。我发现了一个关于相同问题的先前主题，提出的解决方案是使用两个指针并增加第二个指针，而它并不指向与第一个指针相同的对象。但我认为这种方法只有在队列中有不同对象时才能工作。就我而言，所有对象都是相似的。如何获得循环队列的大小？这个公式对我也不起作用：

```
int size = abs(m_front -m_tail) ; 
```

其中 m_front 和 m_tail 是尾部和前端队列索引。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T22:40:15.173

这应该这样做：

```
if m_front > m_tail 
    size = (m_front - m_tail)
else
    size = (m_front + N - m_tail) 
```

其中 N 是数组的长度。

或者，你可以自己跟踪它，当你增加一个计数器，当你`Queue()`减少它`Dequeue()`。

# c++ - 如果有的话，如何从字符串转换为 LPCSTR？(C++)

> ID：12100951
> 
> 赞同：-2
> 
> 时间：2012-08-23T22:34:22.030
> 
> 标签：c++, string, lpcstr

> **可能重复：**
> [如何将 std::string 转换为 LPCSTR？](https://stackoverflow.com/questions/1200188/how-to-convert-stdstring-to-lpcstr)

我有兴趣制作一个功能，该功能将通过网站上的一系列页面并从每个页面下载信息。例如 - mywebsite.com/?page=1、mywebsite.com/?page=2、?page=3 等。我认为自动执行此操作很容易，但显然不是。为了下载 HTML 源代码，我一直在使用一个名为 URLOpenBlockingStream() 的函数。此函数将站点的 URL 作为参数，作为数据 dype LPCSTR（我假设“指向常量字符串的长指针”）。这似乎阻止了它访问任何网站，除了我硬编码的一个确切的网站。

规避此问题的所有合理尝试都导致编译或运行时错误。有没有办法解决它，或者我应该使用另一个功能？

提前致谢！

**经过很多麻烦和谷歌搜索，我刚刚解决了这个问题。抱歉，它不会让我回答我自己的问题，因为我是新手，但对于任何寻找的人来说，它是这样工作的：**

首先，将所有 URL 放入一个字符串中。如果您需要知道如何转换 int 或其他什么，请查找 stringstreams。然后，使用 string::c_str()，它返回一个*常量*字符串，然后可以将其转换为 LPCSTR。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T23:07:40.833

如果您附上您的代码，这将有所帮助。没有它很难说出什么是错的。

此外，您可能需要安装一个网络嗅探器，如wireshark，以查看是否有任何通信正在发送到服务器，以及响应代码是否正常等。

最后，我会从 MSDN 看这个例子：http: [//msdn.microsoft.com/en-us/library/aa741006 (v=vs.85).aspx#Using_the_URL_Functi](http://msdn.microsoft.com/en-us/library/aa741006(v=vs.85).aspx#Using_the_URL_Functi)

# java - 具有参数化类型的 Java getConstructor(types)

> ID：12100955
> 
> 赞同：7
> 
> 时间：2012-08-23T22:34:46.913
> 
> 标签：java, generics, reflection

如果我有一个带有参数化泛型类型的构造函数的类：

```
public class Foo {
    public Foo(Map<String, Object> data) {
      ...
    }
} 
```

...如果我想调用，如何引用该参数化 Map 的类：

```
Constructor constructor = cls.getConstructor(/*the Map class! */) 
```

`cls`（ Foo 类在哪里。）

我想做类似的事情：

```
Constructor constructor = cls.getConstructor(Map<String,Object>.class); 
```

...但这不起作用。

我敢肯定有一个简单的答案！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-23T22:38:56.843

在运行时，这：

```
 Map<String,Object> 
```

实际上只是一个 Map，没有任何参数。

打电话

```
 cls.getConstructor(Map.class) will be enough 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-23T22:39:40.817

您可以仅通过 Map 类型引用构造函数。通用参数在运行时被擦除：

```
Constructor constructor = Foo.class.getConstructor(Map.class); 
```

# sql - 属性通过连接函数不可见，但在 sql 中它工作正常

> ID：12100956
> 
> 赞同：0
> 
> 时间：2012-08-23T22:34:50.093
> 
> 标签：sql, ruby-on-rails, activerecord

第一个是本地 SQL 查询，它运行良好，但在活动记录中它没有显示任何关于玩家表的内容。Player.name 属性不可见，尽管我已授予对 Batsman 和 Player 模型文件的访问权限

```
SELECT  
    players.name, batsmen.*  
FROM 
    batsmen 
INNER JOIN 
    players ON players.id = batsmen.player_id 
WHERE 
    league_id = 13

Batsman.joins(:player).where('league_id = ?',13).select('players.name') 
```

这里是模型

```
 class Batsman < ActiveRecord::Base   attr_accessible :fours,:name, :siz, :ave,:batsmenViaLeagues, :match, :league_id, :bestf, :fifty, :hights, :hundred, :innings, :nout, :player_id, :runs, :sr, :zero  belongs_to :player  has_many :leagues

class Player < ActiveRecord::Base
  attr_accessible :image, :name   end 
```

# jquery - 几个大表上的 jQuery load + setInterval 有多大的负担？

> ID：12100966
> 
> 赞同：2
> 
> 时间：2012-08-23T22:35:51.010
> 
> 标签：jquery, load, setinterval

我在一个选举网站上工作，并且对 jQuery 和 .load() 和 setInterval() 有疑问。

我有一个页面，其中包含多个候选人种族，结果列在当地县级。假设我有 18 个左右的县和 10 个左右的候选人参加一场特定的比赛，那是一个 10 列、18 行的表格。一个页面上最多可以有 10 场比赛。

目前，该网站设置为每分钟或每两分钟刷新一次（客户要求），以在选举期间显示新结果。但是，我想知道我是否可以使用 .load 刷新表并动态加载表并 setInterval 每隔一分钟左右刷新这些表（使用 .load）。

这与重新加载该页面是否更好/更差/或相同？会不会对服务器造成很大的负担？由于时间限制，它要么是自动刷新，要么是一些 jQuery 解决方案。非常感谢任何建议/想法。

一个示例表：![一页上可能有 10 个表格中的 1 个](../Images/4b3b6033be51cea7f4c6486099dca97a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T10:03:12.433

这真的取决于你。

服务器处理时间不应该产生明显的差异。

就个人而言，我只是刷新整个页面。恕我直言，你会得到相同的结果，但少了 1 件事出错。您永远不会知道，即使您的 IE 5.5 用户也可能能够查看它。

在我看来，技术上的选择必须始终是需要的。如果没有驾驶需求，请选择更简单、更容易的选项。

希望这可以帮助

:)

# php - CIDR 位运算 - 我可以更聪明一点吗？

> ID：12100968
> 
> 赞同：18
> 
> 时间：2012-08-23T22:36:07.227
> 
> 标签：php, binary, bit-manipulation, cidr

我正在构建一个类来表示 IPv4 子网。我将网络地址和子网掩码存储为 4 字节二进制字符串，它们是在构造函数期间根据参数构建的。我希望构造函数接受的一种表示是[CIDR notation](http://en.wikipedia.org/wiki/CIDR_notation)。

我的按位运算有点生疏，我遇到的问题是将子网掩码的十进制整数 CIDR 表示形式转换为 4 字节二进制字符串，反之亦然。我还发现我无法在字符串上执行左/右移位 - 我确定我之前已经成功完成了吗？

* * *

我设法将转换为二进制字符串以使用以下代码：

```
// An example input value.
$mask = 24; // 255.255.255.0

if ($mask < 0 || $mask > 32) {
  // Invalid prefix size
  throw new RangeException('Invalid CIDR prefix size');
} else if ($mask === 0) {
  // Handle 0
  $mask = "\x00\x00\x00\x00";
} else {
  // Left-pad a 4-byte string with $mask set bits
  $mask = pack('N', (0x01 << 31) >> ($mask - 1));
} 
```

我不喜欢这个逻辑有两个原因：

*   我不喜欢`0`当作特例
*   我不喜欢右移后左移

我确信有一种方法可以更有效地做到这一点，并且可以`0`正确处理而不将其视为特殊情况。

* * *

将二进制字符串转换回 CIDR 前缀大小的十进制表示时，我目前正在使用下面的代码。在验证以其他格式提供的子网掩码以确保设置位是连续的时，我有另一个非常相似的代码块。

```
// An example input value.
$mask = "\xff\xff\xff\x00"; // /24

// Convert the binary string to an int so bit shifts will work
$mask = current(unpack('N', $mask));

// A counter to represent the CIDR
$cidr = 0;

// Loop and check each bit
for ($i = 31; $i > 0; $i--) {
  if (($mask >> $i) & 0x01) {
    $cidr++;
  } else {
    break;
  }
}

// Return the result
return $cidr; 
```

由于循环，我不喜欢这个 - 我确信有一种更智能的按位方式来做到这一点。

* * *

有没有更智能的方法来完成这些任务？

想法/建议/一般滥用请...

* * *

编辑：

任何解决方案都需要在 PHP 4.3.10 及更高版本上运行，并且必须在 32 位和 64 位平台上运行。请记住，PHP 中的所有整数都是有符号的，并且在 32 位平台上，任何东西`>= 0x80000000`都将存储为双精度数（因此不能很好地使用按位运算）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-23T23:14:28.703

您的第二个问题也可以看作是在倒数中找到第一个设置位（而不是在非倒数中找到第一个未设置位），这相当于找到数字的整数 log2。

这是按位世界中相当普遍的问题，并且有许多针对它的速度优化算法。您正在使用（缓慢）明显的算法：[http ://www-graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious](http://www-graphics.stanford.edu/~seander/bithacks.html#IntegerLogObvious)

但我假设您并不真正关心速度，而是关心简洁，在这种情况下，您可以执行以下操作：

```
$cidr = (int) (32 - log(~current(unpack('N', $mask)) & 0xffffffff, 2)); 
```

`& 0xffffffff`必须与 64 位整数兼容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-24T03:30:40.067

第二个问题可以通过文本方法来解决：

```
$mask = "\xff\xff\xff\x00";

$cidr = strspn(sprintf('%b', current(unpack('N', $mask))), 1); 
```

它用于`sprintf()`将整数转换为二进制文本表示并`strspn()`计算初始值的数量。

**更新**

在 64 位机器上，二进制文本表示左填充 32 个零，因此需要`ltrim()`像这样修补代码：

```
$cidr = strspn(ltrim(sprintf('%b', current(unpack('N', $mask))), 0), 1); 
```

**更新 2**

第一个问题也可以用文本方法解决，尽管需要使用`str_split()`（在 PHP 4.x 中不起作用）：

```
$mask = vsprintf('%c%c%c%c', array_map('bindec', str_split(str_pad(str_repeat(1, $mask), 32, 0), 8))); 
```

**更新 3**

对我有用的是以下内容（在 32 位和 64 位上测试）：

```
$mask = pack('N', 0xffffffff << (32 - $mask)); 
```

在这个过程中，这个数字变成了一个浮点数，但保留了足够的精度来处理位移。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-28T18:43:08.277

为什么不这样做：

```
$netmask = ( (1<<32) -1 ) << ( 32 - $cidr); 
```

你说你不喜欢左移然后右移，两个左移怎么样;）

在这之后，我把它扔进`ip2long`or `long2ip`。要从掩码到 CIDR，我会这样做：

```
$mask = ip2long($mask);
$base = ( ( 1 << 32 ) - 1 );
$cidr = 32 - log( ( $mask ^ $base ) + 1 , 2); 
```

当然，您可以根据需要使用`pack`或`dechex`或`unpack`以上来适应您的存储类型。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-01T11:17:17.983

为什么要计算它？只需创建一个包含 32 个子网掩码的数组。

```
$cidr2mask = array( "\x00\x00\x00\x00", "\x80\x00\x00\x00", "\xc0\x00\x00\x00", "\xe0\x00\x00\x00",
                    "\xf0\x00\x00\x00", "\xf8\x00\x00\x00", "\xfc\x00\x00\x00", "\xfe\x00\x00\x00", 
                    "\xff\x00\x00\x00", "\xff\x80\x00\x00", "\xff\xc0\x00\x00", "\xff\xe0\x00\x00", 
                    "\xff\xf0\x00\x00", "\xff\xf8\x00\x00", "\xff\xfc\x00\x00", "\xff\xfe\x00\x00", 
                    "\xff\xff\x00\x00", "\xff\xff\x80\x00", "\xff\xff\xc0\x00", "\xff\xff\xe0\x00", 
                    "\xff\xff\xf0\x00", "\xff\xff\xf8\x00", "\xff\xff\xfc\x00", "\xff\xff\xfe\x00", 
                    "\xff\xff\xff\x00", "\xff\xff\xff\x80", "\xff\xff\xff\xc0", "\xff\xff\xff\xe0", 
                    "\xff\xff\xff\xf0", "\xff\xff\xff\xf8", "\xff\xff\xff\xfc", "\xff\xff\xff\xfe");

$mask2cidr = array_flip($cidr2mask); 
```

然后只需使用`$cidr2mask[$cidr];`and `$mask2cidr[$mask]`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-01T21:38:13.520

（无耻的自我宣传）

我已经建立了一个[PHP 库，它对 IP 地址做了非常相似的事情](https://github.com/leth/PHP-IPAddress)。

这是我构建 IPv4 子网掩码的方法：

```
<?php
$mask = (~0) << (32 - $cidr);
$binary_mask = pack('N', $mask);
echo implode('.', unpack('C4', $binary_mask)); 
```

由于命名空间，它不适用于旧版本的 PHP，但在添加之前有分支，我很乐意接受拉取请求以修复兼容性问题。代码（几乎）100% 被单元测试覆盖 :)

唯一的依赖是[pear Math_BigInteger 包](http://pear.php.net/package/Math_BigInteger/)。

# events - 为什么 Doctrine2 没有 preLoad 事件？

> ID：12100969
> 
> 赞同：0
> 
> 时间：2012-08-23T22:36:17.407
> 
> 标签：events, symfony, doctrine, doctrine-orm

我只是好奇为什么这样的事件不存在。是否有明显的原因我没有看到或存在某种解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-24T06:55:38.873

好吧，从我的角度来看，这很明显。

> postLoad - 在实体从数据库加载到当前 EntityManager 或对其应用刷新操作之后，实体发生 postLoad 事件。

[来源](http://docs.doctrine-project.org/projects/doctrine-orm/en/2.1/reference/events.html#lifecycle-events)

既然在所谓的`preLoad`状态下你没有任何实体——你为什么不想用一些东西来修改任何东西？

# linux - infiniband rdma 传输不良 bw

> ID：12100970
> 
> 赞同：5
> 
> 时间：2012-08-23T22:36:29.083
> 
> 标签：linux, performance, infiniband, rdma

在我的应用程序中，我使用 infiniband 基础架构将数据流从服务器发送到另一个服务器。我习惯于通过 infiniband 轻松开发 ip，因为我更熟悉套接字编程。到目前为止，性能（最大 bw）对我来说已经足够好（我知道我没有获得可实现的最大带宽），现在我需要从那个 infiniband 连接中获得更多带宽。

ib_write_bw 声称我的最大可实现带宽约为 1500 MB/s（我没有获得 3000MB/s，因为我的卡安装在 PCI 2.0 8x 中）。

到目前为止，一切都很好。我使用 ibverbs 和 rdma 编码了我的通信通道，但我得到的带宽远远低于我能得到的带宽，我什至得到的带宽比使用套接字少一点，但至少我的应用程序不使用任何 CPU 能力：

ib_write_bw：1500 MB/s

套接字：700 MB/s <= 我系统的一个核心在此测试期间处于 100%

ibvers+rdma: 600 MB/s <= 在这个测试期间根本没有使用 CPU

似乎瓶颈就在这里：

```
ibv_sge sge;
sge.addr = (uintptr_t)memory_to_transfer;
sge.length = memory_to_transfer_size;
sge.lkey = memory_to_transfer_mr->lkey;

ibv_send_wr wr;
memset(&wr, 0, sizeof(wr));
wr.wr_id = 0;
wr.opcode = IBV_WR_RDMA_WRITE;
wr.sg_list = &sge;
wr.num_sge = 1;
wr.send_flags = IBV_SEND_SIGNALED;
wr.wr.rdma.remote_addr = (uintptr_t)thePeerMemoryRegion.addr;
wr.wr.rdma.rkey = thePeerMemoryRegion.rkey;

ibv_send_wr *bad_wr = NULL;
if (ibv_post_send(theCommunicationIdentifier->qp, &wr, &bad_wr) != 0) {
  notifyError("Unable to ibv post receive");
} 
```

此时等待完成的下一个代码是：

```
//Wait for completation
ibv_cq *cq;
void* cq_context;
if (ibv_get_cq_event(theCompletionEventChannel, &cq, &cq_context) != 0) {
  notifyError("Unable to get a ibv cq event");
}

ibv_ack_cq_events(cq, 1);

if (ibv_req_notify_cq(cq, 0) != 0) {
  notifyError("Unable to get a req notify");
}

ibv_wc wc;
int myRet = ibv_poll_cq(cq, 1, &wc);
if (myRet > 1) {
  LOG(WARNING) << "Got more than a single ibv_wc, expecting one";
} 
```

从我的 ibv_post_send 到 ibv_get_cq_event 返回事件的时间是 13.3 毫秒，当传输 8 MB 的块时达到大约 600 MB/s。

要指定更多（在伪代码中我在全局范围内执行的操作）：

主动方：

```
post a message receive
rdma connection
wait for rdma connection event
<<at this point transfer tx flow starts>>
start:
register memory containing bytes to transfer
wait remote memory region addr/key ( I wait for a ibv_wc)
send data with ibv_post_send
post a message receive
wait for ibv_post_send event ( I wait for a ibv_wc) (this lasts 13.3 ms)
send message "DONE"
unregister memory 
goto start 
```

被动侧：

```
post a message receive
rdma accept
wait for rdma connection event
<<at this point transfer rx flow starts>>
start:
register memory that has to receive the bytes
send addr/key of memory registered
wait "DONE" message 
unregister memory
post a message receive
goto start 
```

有谁知道我做错了什么？或者我可以改进什么？我不受“这里没有发明”综合症的影响，所以我什至愿意扔掉我到目前为止所做的事情并采用其他东西。我只需要点对点的连续传输。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T17:06:47.077

根据您的伪代码，看起来好像您为每次传输注册和注销了一个内存区域。我认为这可能是事情进展缓慢的主要原因：内存注册是一项非常昂贵的操作，因此您希望尽可能少地执行此操作并尽可能多地重用您的内存区域。花在注册内存上的所有时间都是您不花在传输数据上的时间。

这指出了您的伪代码的第二个问题：您正在同步等待完成，并且在前一个完成之前不会发布另一个工作请求。这意味着从工作请求完成到您完成并发布另一个请求期间，HCA 处于空闲状态。你最好保持多个发送/接收工作请求在运行中，这样当 HCA 完成一个工作请求时，它可以立即转移到下一个工作请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-29T18:20:16.960

我解决了分配要传输的缓冲区与页面大小对齐的问题。在我的系统中，页面大小为 4K（sysconf(_SC_PAGESIZE) 返回的值）。这样做我现在能够（我仍然进行注册/注销）达到大约 1400 MB/秒。

# c++ - LPCTSTR 与 StringCchCat 的连接

> ID：12100971
> 
> 赞同：1
> 
> 时间：2012-08-23T22:36:42.430
> 
> 标签：c++, concatenation

好吧，我是 c++ 的新手，所以我决定在几个项目之后做一些简单的事情，这些项目让我对 c++ 有了基本的了解（不，hello world 不算在内），我只想在 % 上创建一个文件夹appdata% 我发现我只需要这样做

```
void MakeFolder()
{
LPCTSTR appdata = getenv("APPDATA");
char *appchar = getenv("APPDATA");
size_t sizeApp = sizeof(appchar) + 8;
LPCTSTR folder = "/Folder";
StringCchCat(appdata, sizeApp, folder);
CreateDirectory (appdata,NULL);
} 
```

但它说“StringCchCat：未找到标识符”，我已经包含了 STDDEF.h，并且错误代码没有改变！但我不确定代码本身是否会起作用......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:41:18.490

`StringCchCat`声明在`<strsafe.h>`; 您需要包含该标题。

但是...因为您是 C++ 新手，所以不要乱用 C 字符串。使用`std::string`：

```
char const* const raw_appdata = getenv("APPDATA");
if (raw_appdata == nullptr)
{
    // Handle error
}

std::string const appdata = raw_appdata;
std::string const folder  = appdata + "\\Folder";

if (CreateDirectory(appdata.c_str(), nullptr) == FALSE)
{
    // Handle error
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T22:44:01.847

通常，您需要包含 Strsafe.h 才能使用 StringCchCat

请参阅[http://msdn.microsoft.com/en-us/library/windows/desktop/ms647518(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647518(v=vs.85).aspx)

以您的方式使用 StringCchCat 的问题是源缓冲区（appdata）可能不足以容纳 appdaa 和文件夹。您可以通过将 LPCSTR 转换为 std::string 并将字符串添加在一起（请参阅[如何从 LPCTSTR 转换为 std::string？](https://stackoverflow.com/questions/5513718/how-do-i-convert-from-lpctstr-to-stdstring)），然后在需要时调用 string.c_str()来让自己的生活变得更轻松一个常量字符*。

# jquery - 如何使用 twitter bootstrap 在轮播中为文本飞入设置动画？

> ID：12100976
> 
> 赞同：0
> 
> 时间：2012-08-23T22:37:18.147
> 
> 标签：jquery, animation, twitter-bootstrap

最近我在[http://hondajet.honda.com/](http://hondajet.honda.com/)上看到了这个功能- 当旋转木马向左滑动时，一个文本块从顶部动画/飞入。让旋转木马正常工作，但文本动画效果不佳。

如何获得此文本飞入功能？我想在触发轮播 ***幻灯片***事件时触发文本动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T16:07:46.867

也许不完全是您正在寻找的东西，但它会帮助指明方向：

[http://jsfiddle.net/coltrane/Pn2UB/](http://jsfiddle.net/coltrane/Pn2UB/)

该示例大量使用了 jQuery，但与 twitter 引导程序没有任何关系。

# c# - 出于某种原因， else if 不起作用

> ID：12100977
> 
> 赞同：2
> 
> 时间：2012-08-23T22:37:47.063
> 
> 标签：c#, if-statement

所以我似乎无法得到一个 else if 可以正常工作。

我一直在做的是编写一个单位转换器来尝试自学编程的基础知识，我对它有点陌生。这么新，说这实际上是我的第一个工作 while 循环。所以我一直在编写代码，然后作为一个在编程方面更有经验的朋友告诉我去做。将所述代码分离为方法。我为此使用了VS2010自动方法制作的东西，因为我自己不知道该怎么做。有问题的完整源代码在这里[http://pastebin.com/9mZPPtWr](http://pastebin.com/9mZPPtWr)问题位是这个

`

```
 else if (type == "cups")

      {

        Console.WriteLine("Enter a number of liters to be converted into cups.");
        amount = Convert.ToDouble(Console.ReadLine());
        Console.WriteLine(cupsTolitConverter.Convert(amount) + " cups to said number of liters.");

      }` 
```

我将杯子输入控制台，尽管其他所有输入/输入工作正常并且循环每次都循环回选择位，但我似乎无法让那部分代码工作。它只是不会显示，我已经研究了一个小时，我开始认为我错过了一些非常明显的东西，或者一些非常神秘的东西。此外，我有很多重复的代码，我想知道是否有办法将其简化为更少的重复。

谢谢，我希望这是可读和可以理解的。即使我的代码可能不是。我还从 Accelerated C# 获得了起始代码（最高位）。如果需要，将详细说明我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-23T22:47:13.510

我运行了您的代码，并且（在修复了一个简单的错误之后）它正确地输入了*else 如果*您引用。

您可能需要回显您输入的内容，以确保您没有输入错误。

错误是你有

> 完毕

自己在一条线上。大概您打算分配一个值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-23T23:41:41.060

首先：您在第 141 行有错误。删除该`done`单词。我建议这只是复制粘贴错误。其次：在这里你说你的代码是：

```
else if (type == "cups")

      {

        Console.WriteLine("Enter a number of liters to be converted into cups.");
        amount = Convert.ToDouble(Console.ReadLine());
        Console.WriteLine(cupsTolitConverter.Convert(amount) + " cups to said number of liters.");

      } 
```

但是在您提供链接的解决方案中，有：

```
else if(type == "cups")
                    {

                        Console.WriteLine("Enter a number of liters to be converted into cups.");
                        amount = Convert.ToDouble(Console.ReadLine());
                        Console.WriteLine(cupsTolitConverter.Convert(amount) + " centimeters to said number of inches.");

                    } 
```

我认为这只是疏忽。您的代码工作正常，只需替换

```
Console.WriteLine(cupsTolitConverter.Convert(amount) + " centimeters to said number of inches."); 
```

和

```
Console.WriteLine(cupsTolitConverter.Convert(amount) + " cups to said number of liters."); 
```

在您的解决方案中。

谈论简化您的代码，并删除重复。当然有办法做到这一点。该过程称为代码重构。例如，您在项目中写道：

```
...
else if(type == "grams")
                    {

                        amount = gramsToOunces(ozToGramsConverter, ref done);

                    }
... 
```

将您的评估`amount`替换为gramToOunces() 方法。这在某种程度上也是代码重构。您应该获取代码的常见部分并查看它们依赖的内容。例如：

```
private static double MilesToFeet(UnitConverter milesToFeetConverter, ref int done)
        {

            double amount;
            Console.WriteLine("Enter a number of miles to be converted to feet.");
            amount = Convert.ToDouble(Console.ReadLine());
            Console.WriteLine(milesToFeetConverter.Convert(amount) + " feet to said number of miles.");

            return amount;

        } 
```

您的每个转换方法都有这样的结构。在每种方法中，您都这样做。您打印相同的指令消息...您声明相同的数量变量并将其值设置为控制台输入...然后您编写几乎相同的信息消息。所有这一切，而不是您拥有的 N 种方法，您可以放入 ONE 方法中。首先你应该扩展你的转换器类。添加另外两个字符串字段字段。`FromUnit`和`ToUnit`。为什么？？？因为您将转换器实例作为参数提供给您的方法。您可以使用此实例来存储有关此转换器的更多信息，并在之后创建信息消息。例如：

```
public class UnitConverter
    {
        double ratio;
        public string From { get; set; }
        public string To { get; set; }
        public UnitConverter(double unitratio) { ratio = unitratio; }
        public double Convert(double unit) { return unit * ratio; }
    } 
```

然后，当您创建转换器实例时，为这些属性设置适当的值。

```
UnitConverter milesToFeetConverter = new UnitConverter(5280) { From = "miles" , To = "feet"}; 
```

现在让我们编写一个方法，它将代表您已经创建的所有方法（gramsToOunces、kmsToMiles 等）；

```
private static void MakeConversion(UnitConverter customConverter)
        {
            Console.WriteLine("Enter a number of {0} to be converted to {1}.",customConverter.From, customConverter.To);
            double amount = Convert.ToDouble(Console.ReadLine());
            string message = string.Format("{0} {1} to said number of {2}", amount, customConverter.To, customConverter.From);
            Console.WriteLine(message);
        } 
```

现在您可以删除所有方法，并且在 if 块中您可以调用这个方法，只需使用不同的参数而不是调用不同的方法，它们的作用相同。

否则 if(type == "miles") { MakeConversion(milesToFeetConverter); }

在所有这些操作之后，您的解决方案将如下所示：

```
using System;

namespace ConsoleApplication2
{
    public class UnitConverter
    {
        double ratio;
        public string From { get; set; }
        public string To { get; set; }
        public UnitConverter(double unitratio) { ratio = unitratio; }
        public double Convert(double unit) { return unit * ratio; }
    }

    class Test
    {
        private static void MakeConversion(UnitConverter customConverter)
        {
            Console.WriteLine("Enter a number of {0} to be converted to {1}.",customConverter.From, customConverter.To);
            double amount = Convert.ToDouble(Console.ReadLine());
            string message = string.Format("{0} {1} to said number of {2}", amount, customConverter.To, customConverter.From);
            Console.WriteLine(message);
        }

        public static void Main()
        {                 
            UnitConverter feetToInchesConverter = new UnitConverter(12) { From = "feet", To = "inches"};
            UnitConverter milesToFeetConverter = new UnitConverter(5280) { From = "miles" , To = "feet"};
            UnitConverter kmsToMilesConverter = new UnitConverter(1.609) { From = "kilometers", To = "miles"};
            UnitConverter centToInchesConverter = new UnitConverter(2.54) { From = "centimeters", To = "inches" };
            UnitConverter ozToGramsConverter = new UnitConverter(28.349) { From = "ounces", To = "grams" };
            UnitConverter cupsTolitConverter = new UnitConverter(4.226) { From = "cups", To = "litters" };

            string type;
            int done;

            done = 0;

            while(done == 0)
            {
                {
                    type = Console.ReadLine();

                    if(type == "centi")
                    {
                        MakeConversion(centToInchesConverter);
                    }

                    else if(type == "feet")
                    {
                        MakeConversion(feetToInchesConverter);
                    }

                    else if(type == "km")
                    {
                        MakeConversion(kmsToMilesConverter);
                    }

                    else if(type == "miles")
                    {
                        MakeConversion(milesToFeetConverter);
                    }

                    else if(type == "grams")
                    {
                        MakeConversion(ozToGramsConverter);
                    }

                    else if(type == "cups")
                    {
                        MakeConversion(cupsTolitConverter);
                    }

                    else if(type == "end")
                    {
                        done = 1;
                    }
                }
            }
        }
    }
} 
```

当然，您可以做更多的事情来使代码更容易和更清晰。将 if 替换为案例，将`MakeConversion`方法直接替换为 UnitConverter 类，更改类的体系结构。这只是我对你能做什么的建议。但首先尝试学习如何编写你的方法和类，不要使用 VisualStudio 方法生成器，你应该知道如何自己编写方法。我以某种方式试图解释这一点，希望它有所帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-23T22:48:24.263

您页面链接到的代码的第 141 行是这样的：

```
141 - done 
```

你不会对那个变量做任何事情，你不会以分号结尾。

*（由于您没有使用 Visual Studio 编辑器，我怀疑该程序正在运行，然后您引入了编译时错误。现在每次运行该程序时，您可能运行的是旧版本。希望您可以下载并使用 Visual Studio Express 这将增加学习时间并减少混乱时间。祝你好运）*

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-23T22:50:51.953

如果“If else”没有被击中，则意味着以下两种情况之一：先前的条件为真，或者条件为假。

['==' 运算符在比较字符串](http://msdn.microsoft.com/en-us/library/362314fe%28v=vs.71%29.aspx)时区分大小写， 因此请务必考虑到这一点。这是一个更复杂的主题，随着您的进步，稍后会变得有意义。

祝你好运！

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-08-23T22:46:43.620

我的建议：使用 Nunit 并为其编写单元测试。Nunit 将给出预期值和实际值，您会明白为什么这不起作用。

# android - 继承android样式

> ID：12100981
> 
> 赞同：0
> 
> 时间：2012-08-23T22:38:10.143
> 
> 标签：android, styles, commonsware

在 commonwares (4.0) 书中，它展示了如何继承 android 样式......

```
<style name="activated" parent="android:Theme.Holo"> 
```

但我得到“没有找到具有该名称的资源。我在.. [http://developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)找到文档 说所有可以继承的样式都在我的 R .style 文件 - 但我没有，也不知道如何获得。

该链接还有两个链接显示可用的样式和主题，但两个链接都已损坏。

那么如何继承各种android风格和主题呢？谢谢，加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T23:20:42.683

> But I get "no resource found with that name

As zapi indicates, that style is new to API Level 11\. You will notice that the resource in question is from a `res/values-v11/` directory, so that resource will only be used on API Level 11 or higher. There is another definition of the `activated` style resource in `res/values/` that does not inherit from `Theme.Holo`.

# postgresql - 对 tsvector 中的每个元素使用 Levenshtein 函数？

> ID：12100983
> 
> 赞同：4
> 
> 时间：2012-08-23T22:38:28.317
> 
> 标签：postgresql, levenshtein-distance, fuzzy-search, tsvector

我正在尝试使用 Postgres 创建一个模糊搜索，并且一直使用 django-watson 作为基础搜索引擎来工作。

我有一个名为 search_tsv 的字段，它是一个包含我要搜索的模型的所有字段值的 tsvector。

我想使用 Levenshtein 函数，它完全符合我在文本字段上的要求。但是，我真的不知道如何在 tsvector 的每个单独元素上运行它。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-23T22:58:27.740

考虑扩展名`pg_trgm`而不是`levenshtein()`. 使用 GiST 索引支持[PostgreSQL 9.1 或更高版本中的 KNN 功能](https://wiki.postgresql.org/wiki/What%27s_new_in_PostgreSQL_9.1#K-Nearest-Neighbor_Indexing)时，速度要快几个数量级。

每个数据库安装一次扩展：

```
CREATE EXTENSION pg_trgm; 
```

并使用[`<->`or`%`运算符](https://www.postgresql.org/docs/current/pgtrgm.html#PGTRGM-FUNC-TABLE)。SO上已经发布了几个相关的答案，搜索[pg_tgrm [PostgreSQL]](https://stackoverflow.com/search?q=pg_tgrm%20%5BPostgreSQL%5D) ...

* * *

疯狂拍摄您可能想要的东西：

```
WITH x AS (
    SELECT unnest(string_to_array(trim(strip(
      'fat:2,4 cat:3 rat:5A'::tsvector)::text, ''''), ''' ''')) AS val
    )                                    -- provide ts_vector, extract strings
    , y AS( SELECT 'brat'::text AS term) -- provide term to match
SELECT val, term
      ,(val <-> term) AS trg_dist        -- distance operator
      ,levenshtein(val, term) AS lev_dist
FROM   x, y; 
```

回报：

```
 val | term | trg_dist | lev_dist
-----+------+----------+----------
 cat | brat |    0.875 |        2
 fat | brat |    0.875 |        2
 rat | brat | 0.714286 |        1 
```

# android - 从数字选择器中删除加号和减号栏

> ID：12100986
> 
> 赞同：0
> 
> 时间：2012-08-23T22:39:10.080
> 
> 标签：android, android-layout, android-widget

嗨，我无法将所有号码选择器小部件都放在屏幕上。有没有办法关闭数字选择器上的加号和减号栏以节省空间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:47:14.680

如果您删除加号和减号按钮，您只剩下一个只接受数字的 EditText。为什么不直接使用一系列 EditText？

```
<EditText
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:inputType="number" /> 
```

您没有解释 NumberPickers 不适合的原因，也许您可​​以将它们包装在 ScrollView 或 Horizo​​ntalScrollView 中？

# ms-access - 对 access 2003 .MDB 文件中的所有对象禁用右键单击选项

> ID：12100987
> 
> 赞同：0
> 
> 时间：2012-08-23T22:39:24.503
> 
> 标签：ms-access

已为 access 2003 .MDB 文件中的所有对象禁用右键单击选项。我想在设计视图中打开表单、报告等。我应该选中/取消选中哪些选项？还是因为用户权限？

请指教！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T22:42:48.553

在启动选项中，您应该找到允许完整菜单和允许内置工具栏复选框，确保它们被允许。

# javascript - 仅使用 javascript 删除多个选定的表行

> ID：12100993
> 
> 赞同：0
> 
> 时间：2012-08-23T22:40:09.680
> 
> 标签：javascript

我想使用javascript删除表中选定的行，但问题是一旦删除了一行，索引就会改变。

这个问题很混乱，因为只有特定的行包含复选框，并且可以添加更多的复选框。

**我已经可以使用javascript获得我希望**在数组内部删除的所有正确行索引，但是然后我将如何在不打错行且不使用原型或jquery的情况下删除行。纯粹的javascript？

任何帮助是极大的赞赏。

```
 <table class="example_table" id="mytable">
    <tbody>
          <tr>
                <td><input type="text" id="top row" /></td>
          </tr>

          <tr>
                <td><input type="button" onclick="addNewCheckboxRow()" /></td> 
          </tr>

          <tr>
                <td><input type="button" /></td> 
          </tr>

          <tr>
                <td><input type="checkbox" value="1" id="check1" /></td>  //row that may be deleted
          </tr>

          <tr>
                <td><input type="checkbox" value="2" id="check2" /></td>  //row that may be deleted
          </tr>

          <tr>
                <td><input type="checkbox" value="3" id="check3" /></td>  //row that may be deleted
          </tr>
          <tr>
                <td><input type="checkbox" value="4" id="check4" /></td>  //row that may be deleted
          </tr>   

          <tr>
                <td><input type="button" /></td> 7
          </tr>
        </tbody>
    </table> 
```

我目前的做法。不准确，但你可以得到漂移。

```
var myrow=["6","7"];

document.getElementById("mytable").deleteRow(myrow[0]); //deletes row 6

document.getElementById("mytable").deleteRow(myrow[1]); //deletes row 7 But
                                                        //the index has changed!

//what happens when after the delete more rows are added! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:43:55.480

将您的数组从大到小元素[排序。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/sort)

```
function compareNumbers(a, b)
{
  return b - a;
} 
```

然后从最大到最小。

# c# - TableLayoutPanel 第一列周围没有边框？

> ID：12100994
> 
> 赞同：0
> 
> 时间：2012-08-23T22:40:10.830
> 
> 标签：c#, winforms, tablelayoutpanel

我有一个扩展 TableLayoutPanel 定义/构造的类，如下所示：

```
public class MyTableLayout : TableLayoutPanel
{
    public MyTableLayout()
    {
        this.ColumnCount = 5;
        this.RowCount = 1;
        this.CellBorderStyle = TableLayoutPanelCellBorderStyle.Outset;
    }
} 
```

当我的表格被绘制出来时，它的所有 5 列都有边框（正如人们所期望的那样，给定上面设置*CellBorderStyle*的代码）。

有没有办法可以防止在第一列周围绘制边框？

我知道你可以添加一个 CellPaint 回调：

```
this.CellPaint += tableLayoutPanel_CellPaint; 
```

在此回调中，您可以执行诸如更改特定列的边框颜色之类的操作：

```
private void tableLayoutPanel_CellPaint(object sender, TableLayoutCellPaintEventArgs e)
{
    if (e.Column == 0 && e.Row == 0)
    {
        e.Graphics.DrawRectangle(new Pen(Color.Red), e.CellBounds);
    }
} 
```

但是你怎么画“否”矩形呢？

我尝试将颜色设置为 Color.Empty 但这不起作用：

```
e.Graphics.DrawRectangle(new Pen(Color.Empty), e.CellBounds); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T22:55:16.933

单元格边框的绘制由 OnPaintBackground 覆盖中的 TableLayoutPanel 执行。

要修改绘制边框的方式，您需要不设置边框（因此基类不绘制任何内容），然后在您自己的 OnPaintBackground 覆盖中绘制所有其他边框。

TableLayoutPanel 使用内部函数 ControlPaint.PaintTableCellBorder 来执行边框绘制。由于您不能使用它，您应该查看源代码（使用 Reflector 或 ILSpy）以了解他们是如何做到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T22:46:16.570

换个方式试试。仅在您想要有边框的单元格周围绘制边框：

```
private void tableLayoutPanel_CellPaint(object sender, 
                                        TableLayoutCellPaintEventArgs e) {
  if (e.Column > 0 && e.Row == 0) {
    e.Graphics.DrawRectangle(new Pen(Color.Red), e.CellBounds);
  }
} 
```

显然，将您的边界设置回无，以便绘画可以接管工作：

```
this.CellBorderStyle = TableLayoutPanelCellBorderStyle.None; 
```

# python - 如何强制重新执行 jinja2 模板中的函数？

> ID：12100997
> 
> 赞同：3
> 
> 时间：2012-08-23T22:40:30.440
> 
> 标签：python, google-app-engine, jinja2

我是 GAE/Python 新手。

我有一个调用客户过滤功能的 jinja2 模板：

调用如下所示：

```
{% if constant-parameter|AccessOK %} 
    <li><a href="/tokens-step1">Tokens</a></li>
{% endif %} 
```

我在调用渲染模板的页面上定义了过滤器：

```
TEMPLATE_DIR = os.path.join(os.path.dirname(__file__), 'templates')
jinja_environment = \
    jinja2.Environment(autoescape=True, loader=jinja2.FileSystemLoader(TEMPLATE_DIR))
jinja_environment.filters['AccessOK'] = AccessOK 
```

当我运行它时，它会在我启动应用程序引擎后第一次访问网站时调用它（我有日志条目）。

当我访问其他页面或刷新页面时，不再调用过滤器。

我需要过滤器在每个页面视图上执行。

有人告诉我这是因为参数是常量，如果我将其更改为变量，它将每次都执行。在我的情况下，我需要传递常量，所以我尝试传递 2 个参数（其中变量 = currentuser 并且存在只是为了欺骗系统每次执行过滤器）。

我收到一个错误，表明系统无法识别第二个参数。

谁能告诉我如何确保每次都调用客户过滤器，或者给我一个如何传递 2 个参数的示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T23:27:46.503

这可能不是最优雅的解决方案，但它确实有效。

我添加了一个可变变量作为附加参数（在本例中为 currentuser）。这意味着我必须传递 2 个参数。

我的模板语句现在看起来像：

```
{% if currentuser|AccessOK(constant-parameter) %} 
    <li><a href="/tokens-step1">Tokens</a></li>
{% endif %} 
```

我的功能如下所示：

```
def AccessOK(xCurrentUser, PermissionID): 
```

我忽略了函数中的 xCurrentUser 参数。

如果有人有更好的解决方案，请添加它。

谢谢。