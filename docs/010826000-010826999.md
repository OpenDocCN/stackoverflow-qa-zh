# StackOverflow 问答 10826000-10826999

# apache-commons-httpclient - 使用 Apache HTTPClient - 如何在发送之前查看原始请求字符串？

> ID：10826001
> 
> 赞同：22
> 
> 时间：2012-05-31T00:24:31.137
> 
> 标签：apache-commons-httpclient

出于调试目的，我想查看将要发送的原始请求。有没有办法在没有 HTTP 监视器的情况下直接从[`HttpPost`](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/HttpHost.html?is-external=true)or的 API 获得这个[`HttpClient`](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/HttpClient.html)？

我发现了一些“几乎”重复的问题，但不是针对这个特定的问题

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-02-21T14:28:37.483

您可以为 Apache HttpClient 设置一些环境变量（针对 4.3.2 测试的示例）。

```
System.setProperty("org.apache.commons.logging.Log","org.apache.commons.logging.impl.SimpleLog");
System.setProperty("org.apache.commons.logging.simplelog.showdatetime", "true");
System.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http.wire", "DEBUG"); 
```

还有一些用于调试的变量：

```
System.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http.impl.conn", "DEBUG");
System.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http.impl.client", "DEBUG");
System.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http.client", "DEBUG");
System.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http", "DEBUG"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-11T10:30:28.160

```
org.apache.http.client.fluent.Request#viaProxy 
```

这种方法可以让你的请求通过代理服务器，所以你可以启动一个本地代理服务器，例如Fiddler，这样这个调试代理就可以显示http请求和响应的详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-14T23:28:35.737

尝试`DEBUG`在您的日志记录配置中启用模式，如果您正在使用`log4j`，您可以将其添加到`log4j.xml`项目的文件中

```
<root>
    <priority value="DEBUG" />
    <appender-ref ref="FILE" />
</root> 
```

您将在日志文件中记录完整的请求标头、参数、正文等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-13T08:39:23.430

# log4j2 和/或 slf4j 解决方案

对于使用 log4j2 和/或 slf4j 的每个人，所有提到的解决方案都不起作用。我在我的 maven pom 中添加了以下内容：

```
 <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>1.7.30</version>
    </dependency> 
```

添加一个 log4j2.xml 文件/或使用您现有的文件并添加：

```
 <Logger name="org.apache.http">
        <Level>DEBUG</Level>
    </Logger> 
```

当然，对于有效的 log4j2.xml 配置，您需要定义一些附加程序等。可以[在这里找到一个简单的示例](https://logging.apache.org/log4j/2.x/manual/configuration.html#XML)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-09-10T15:01:32.460

试试这个：

```
HttpClient client = new HttpClient();
PostMethod method = new PostMethod(url);

method.setParameter(...., ....); 
```

检索 URI

```
System.out.println("getUri: " + method.getURI()); 
```

在 POST 中检索参数

```
method.getRequestEntity().writeRequest(System.out); 
```

# scala - 我们如何在 Lift 中格式化 MappedDateTime？

> ID：10826008
> 
> 赞同：1
> 
> 时间：2012-05-31T00:25:34.963
> 
> 标签：scala, format, lift

我`MappedDateTime`想像在java中一样格式化对象：

```
val sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss Z")
sdf.format((new Date())) 
```

`MappedDateTime`在电梯里是怎么做的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T06:33:22.103

由于 MappedDateTime 是 Java 的容器`Date`，因此您可以只使用 Java 的工具来获取日期。但是，在阅读[liftweb api](http://scala-tools.org/mvnsites/liftweb-2.4-M4/#net.liftweb.mapper.MappedDateTime)时`MappedDateTime`，有以下方法可以帮助您：

*   **def format (d: Date): String** : 该方法定义了该字段的字符串解析语义

*   **def parse (s: String): Box[Date]** : 该方法定义了该字段的字符串解析语义。

所以，如果你想改变它们的行为，你可以覆盖这些方法。

# iphone - 我的应用程序运行大约 30 分钟后，声音和新图像无法在视图中加载

> ID：10826010
> 
> 赞同：0
> 
> 时间：2012-05-31T00:26:03.443
> 
> 标签：iphone, objective-c, ios, avaudioplayer

我正在开发一款游戏，起初看起来运行得很好，但是.......在它运行了很长时间之后，声音首先停止工作，[[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error]; 返回一个空值，稍后当我尝试通过 view.image= 将视图设置为等于新图像时，我在控制台中收到一个错误，显示许多文件已打开，ImageIO: CGImageRead_mapData 'open' failed '/ Users/deno/Library/Application Support/iPhone Simulator/5.1/Applications/5A0C777C-70D1-4AA0-8D7B-04A1F734C932/cPetCakes.app/twinkles04fin32.png' 错误 = 24（打开的文件太多）

现在我创建一个新的，每次播放声音时我都会创建一个新的 AVAudioPlayer 对象。我应该重新使用该对象还是如何释放它？？？由于我没有使用分配器，我在想对象会被自动释放？？？

声音代码

```
-(void) PlaySound: (NSString *) name
{
    NSURL *url;

    if ( [name compare:@"chasdog"]==0)
        url  = [[NSBundle mainBundle]
                       URLForResource:name
                       withExtension:@"wav"];

        else
    url  = [[NSBundle mainBundle]
             URLForResource:name
             withExtension:@"mp3"];

    NSError *error;

    audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
    audioPlayer.volume=1.0;
    audioPlayer.numberOfLoops= 0;
    [audioPlayer play];
    audioPlayer.delegate = self;    

} 
```

不再加载新图像的代码

```
 self.image=gPetCakeB[gGame->mPetCakeId]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T00:53:20.830

在播放器委托中，一旦播放器停止播放，就需要释放它：

```
- (void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag {
    [player release];
} 
```

# javascript - 模型中具有父/子关系的 Knockout JS 单选按钮问题

> ID：10826011
> 
> 赞同：1
> 
> 时间：2012-05-31T00:26:19.247
> 
> 标签：javascript, radio-button, knockout.js

在使用 Knockout 将视图模型中的父/子关系表示为视图中的单选按钮选择时，我遇到了一个奇怪的问题。

在下面的示例中，我有一个表示两个应用程序的视图模型。每个应用程序包含三个角色和一个选定的角色 ID。

在视图中，我将每个应用程序下的角色显示为单选按钮列表。应检查其值与父级的选定角色 ID 匹配的按钮。

```
<script src='knockout-2.0.0.js' type='text/javascript'></script>
<script src='knockout.mapping.js' type='text/javascript'></script>

<ul data-bind='template: { name: "applicationTemplate", foreach: Applications }'></ul>

<script type='text/html' id='applicationTemplate'>
  <li><span data-bind='text: Name'></li>
  <ul data-bind='template: { name: "roleTemplate", foreach: Roles }'></ul>      
</script>

<script type='text/html' id='roleTemplate'>
  <li>
    <input type='radio' data-bind='value: Id, 
      checked: $parent.SelectedRoleId(), 
      attr: { name: "roleFor" + $parent.Id(), id: "roleFor" + $parent.Id() + "_" + Id() }' />
    <label data-bind='text: Name, 
      attr: { for: "roleFor" + $parent.Id() + "_" + Id() }'></label>
  </li>        
</script>  

<script type='text/javascript' language='javascript'>

  var data = {
    'Applications': [
      { 'Id': 8, 'Name': 'Weather Predictor', 'SelectedRoleId': 1, 'Roles': [
          { 'Id': 1, 'Name': 'Meteorologist' },
          { 'Id': 2, 'Name': 'Farmer' },
          { 'Id': 3, 'Name': 'Pair of Dice' }               
        ]
      },
      { 'Id': 9, 'Name': 'Daily Crime Report', 'SelectedRoleId': 6, 'Roles': [
          { 'Id': 4, 'Name': 'Superhero' },
          { 'Id': 5, 'Name': 'Commissioner' },
          { 'Id': 6, 'Name': 'Journalist' }
        ]
      }
    ]       
  };

  var viewModel = ko.mapping.fromJS(data);

  ko.applyBindings(viewModel);

</script> 
```

一开始一切都很好：

*   天气预报员
    *   [X] 气象学家
    *   [ ] 农民
    *   [ ] 一对骰子
*   每日犯罪报告
    *   [ ] 超级英雄
    *   [ ] 专员
    *   [X] 记者

但是当我点击“Farmer”时，“Weather Predictor”下的所有角色都未选中：

*   天气预报员
    *   [ ] 气象学家
    *   [ ] 农民
    *   [ ] 一对骰子
*   每日犯罪报告
    *   [ ] 超级英雄
    *   [ ] 专员
    *   [X] 记者

再次单击“Farmer”不仅会选中单选按钮，而且从那时起它将正常工作。只是第一次点击会出现问题。如果我也单击“一对骰子”或任何其他未选中的单选按钮，也会发生同样的问题。

这个问题困扰了我一段时间，我开始怀疑我是否在这里不正确地使用了 Knockout。

任何对此问题的见解将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:57:55.780

当您使用`checked`绑定时，您会希望避免使用`value`绑定，因为它会附加不必要的事件处理程序。

一个简单的选择是`value`在`attr`绑定中添加 （因此您只是设置 value 属性而不添加事件处理程序），然后将`checked`绑定放在它之后（因此在运行`value`之前已经设置了`checked`），例如：

```
data-bind='attr: { value: Id, name: "roleFor" + $parent.Id(), id: "roleFor" + $parent.Id() + "_" + Id() }, checked: $parent.SelectedRoleId' 
```

示例：http: [//jsfiddle.net/rniemeyer/Y478G/](http://jsfiddle.net/rniemeyer/Y478G/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:49:49.907

代替

```
value: Id, checked: $parent.SelectedRoleId() 
```

和

```
value: Id(), checked: $parent.SelectedRoleId 
```

示例：http: [//jsfiddle.net/nickolsky/zrBuL/10/](http://jsfiddle.net/nickolsky/zrBuL/10/)

# c++ - C++ 函数模板导致输入参数出错

> ID：10826012
> 
> 赞同：4
> 
> 时间：2012-05-31T00:27:04.770
> 
> 标签：c++, function, templates, c++11, arguments

我将如何创建一个在自身内部使用模板但不在其参数中使用模板的函数？我有很多具有相同构造函数和函数的类，但在它们的构造函数中做不同的事情，所以我试图创建一个可以接受数字的函数（这是必要的）来告诉开关模板化值应该成为哪个函数. 我该怎么做？

将模板放在函数中而不是模板化函数本身也不起作用

[这](http://ideone.com/aSiLs)不起作用

```
#include <iostream>

template <typename T> void function(uint8_t s, std::string str1, std::string str2, std::string str3){
        T var;
        switch (s){
            case 1:
                // var = class1();
                break;
            // case 2 ...
            // case 3 ...
            default:
                break;
        }
}

int main() {
        std::string str = "01234567";
        std::cout << function(1, str, str, str) << std::endl;

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T00:48:23.920

您是否尝试过明确指定模板参数？

```
function<uint8_t>(1, str, str, str); 
```

编辑：不可能完全按照您的意愿做，因为模板是在编译时解析的，但函数的参数是在运行时解析的。因此，在编译期间，编译器不知道 's' 的值是什么。

出于您的目的，我认为工厂模式是合适的。[请参阅 Alexandrescu 的工厂方法模式](http://loki-lib.cvs.sourceforge.net/loki-lib/loki/include/loki/Factory.h?view=markup)。

示例用法：

```
typedef AbstractT* (*CreatorMethod)(std::string, std::string, std::string);
typedef Factory <AbstractT,uint8_t,CreatorMethod> TFactory;

TFactory tfact;

tfact.Register(1, &someCreatorMethod);
tfact.Register(2, &someOtherCreatorMethod);

std::string str = "01234567";

AbstracT* object = tfact.Create(1 str, str, str);
AbstracT* object = tfact.Create(2 str, str, str); 
```

# sql-server - 禁止 SQL Server SSDT 中的一些警告

> ID：10826014
> 
> 赞同：34
> 
> 时间：2012-05-31T00:27:47.640
> 
> 标签：sql-server, sql-server-data-tools

在[SQL Server Data Tools](http://msdn.microsoft.com/en-us/library/hh272686)中，我想禁止出现 SQL71502（“--- 对对象 --- 有未解析的引用”）的一些但不是全部出现。我知道我可以通过项目属性、构建、抑制 Transact-SQL 警告来抑制，但这将全局抑制。这可以做到吗？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2014-02-27T03:05:38.433

如果需要，您可以在包含生成警告的代码的单个文件级别禁止它。像这样的东西。

```
<Build Include="Stored Procedures\X.sql">
    <SuppressTSqlWarnings>71502</SuppressTSqlWarnings>
</Build> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-01T17:27:47.733

您不清楚什么会决定哪些 71502 消息会被抑制，哪些不会，但根据我自己的理解和研究，我认为答案是相同的。简而言之，没有。

您可以禁止所有警告或基于特定代码 ( 71502 ) 的警告，但这会尽可能细化。

[http://msdn.microsoft.com/en-us/library/hh272681(v=VS.103).aspx](http://msdn.microsoft.com/en-us/library/hh272681(v=VS.103).aspx)

此链接讨论了将警告提升为错误，但也演示了如何使用抑制过滤器 - 基于您可能已经知道的问题。

[http://social.msdn.microsoft.com/Forums/is/ssdt/thread/9b698de1-9f6d-4e51-8c73-93c57355e768](http://social.msdn.microsoft.com/Forums/is/ssdt/thread/9b698de1-9f6d-4e51-8c73-93c57355e768)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-08-08T20:04:16.310

听起来您正在尝试在对象/文件级别执行此操作，例如存储过程。

如果这是您想要的粒度级别，那么在打开项目的情况下，选择对象，然后在属性中选择抑制 TSql 警告，输入 71502 就可以了。

该对象的其他警告仍将引发 - 其他对象中的 71502 警告也将引发。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-04T14:25:08.340

如果警告来自存储过程，您可以通过将警告的数字部分（如果需要更多信息，以逗号分隔）添加到 sproc 属性中的 Suppress TSql 警告部分来设置特定 sproc 的 Suppress。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-09T11:13:29.350

如前所述，可以在对象级别忽略所有出现的警告/错误。如果您只想忽略不可能的对象中出现的某种警告。

我找到了一种可能对您也有帮助的解决方法。

在我的例子中，我在存储过程中引用了一个由“select * into ...”语句创建的表，Visual Studio 无法处理这个新表上的任何后续引用，并且我收到很多 SQL71502 警告。为了欺骗 VS，我在我的 SP 顶部创建了以下内容：

```
IF 1=2 CREATE mytable(...) 
```

这样做 VS 可以验证所有引用，但是因为 if 子句的条件总是错误的，所以对我的 SP 没有负面影响。请记住在必要时更新 CREATE 语句。

# bash - 通过在行中向后打印两个字符之间的单词

> ID：10826017
> 
> 赞同：0
> 
> 时间：2012-05-31T00:28:43.787
> 
> 标签：bash, sed, awk

我在从一行中提取单词时遇到问题。我想要的是它选择符号 # 之前但 / 之后的第一个单词。这是唯一突出的分隔符​​。

一行看起来像这样：

`,["https://picasaweb.google.com/111560558537332305125/Programming#5743548966953176786",1,["https://lh6.googleusercontent.com/-Is8rb8G1sb8/T7UvWtVOTtI/AAAAAAAAG68/Cht3FzfHXNc/s0-d/Geek.jpg",1920,1200]`

我想要这个词`Programming`。

为了得到那条线，我正在使用它来缩小范围。

```
sed -n '/.*picasa.*.jpg/p' 5743548866439293105 
```

所以我希望它几乎可以找到`#`然后向后退，直到它碰到第一个`/`。然后打印出来。在这种情况下，这个词应该是`Programming`但可以是任何东西。

我希望它尽可能短并尝试过

```
sed -n '/.*picasa.*.jpg/p' 5743548866439293105 | awk '$0=$2' FS="/" RS="[$#]" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:39:10.007

你可以这样做`sed`（稍微缩短格式化，但也适用于你的原始字符串）：

```
pax> echo ',["https://p.g.com/111/Prog#574' | sed 's/^[^#]*\/\([^#]*\)#.*$/\1/'
Prog
pax> 
```

更详细地解释：

```
 /---+------------------> greedy capture up to '/'.
   /    |
   |    | /------+---------> capture the stuff between '/' and '#'.
   |    |/       |
   |    ||       | /-+-----> everything from '#' to end of line.
   |    ||       |/  |
   |    ||       ||  |
's/^[^#]*\/\([^#]*\)#.*$/\1/'
                      ||
                      \+---> replace with captured group. 
```

它基本上搜索具有您想要的模式的整行（首先`#`跟随 a `/`），同时捕获（使用`\(`和`\)`括号）只是和之间的`/`东西`#`。

然后，替换将整行替换为您感兴趣的捕获文本（通过`\1`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:00:19.830

`grep`与一些 Perl 正则表达式扩展一起使用：

```
echo $string | grep -P -o "(?<=/)[^/]+(?=#)" 
```

`-P`告诉`grep`使用 Perl 扩展。`-o`告诉`grep`只显示匹配的文本。要了解匹配的内容，请将正则表达式分成三个部分：`(?<=/)`、`[^/]+?`和`(?=#)`. 第一部分说匹配的文本必须跟随一个'/'，而不包括'/'在匹配中。第二部分匹配一串非'/'字符。最后一部分说匹配的文本必须紧跟一个'#'，匹配中不包括'#'。

另一个 grep，使用“\K”功能将匹配“丢弃”到 '#' 之前的最后一个 '/'：

```
# Match as much as possible up to a '/', but throw it away, then match as much as you can
# up to the first #
echo $string | grep -oP ".*/\K.+(?=#)" 
```

使用`cut`and`awk`获取第一个字段（在 # 上拆分），然后是最后一个字段（在 / 上拆分）：

```
echo $string | cut -d# -f1 | awk -F/ '{print $NF}' 
```

使用一些临时变量和 bash 的参数扩展工具：

```
$ FOO=["https://picasaweb.google.com/111560558537332305125/Programming#5743548966953176786",1,["https://lh6.googleusercontent.com/-Is8rb8G1sb8/T7UvWtVOTtI/AAAAAAAAG68/Cht3FzfHXNc/s0-d/Geek.jpg",1920,1200]
$ BAR=${FOO%#*}      # Strip the last # and everything after
$ echo $BAR
[https://picasaweb.google.com/111560558537332305125/Programming
$ BAZ=${BAR##*/}     # Strip everything up to and including the last /
$ echo $BAZ
Programming 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T06:12:04.643

这可能对您有用：

```
sed '/.*\/\([^#]*\)#.*/{s//\1/;q};d' file 
```

# pdf-generation - wicked_pdf - 在用于生成 PDF 但不在生成的 PDF 中的 html.erb 模板中显示链接

> ID：10826018
> 
> 赞同：1
> 
> 时间：2012-05-31T00:29:04.180
> 
> 标签：pdf-generation, ruby-on-rails-3.2, wicked-pdf

在 Rails 3.2.3 中取得 wicked_pdf 生成 PDF 的进展。但是，我希望能够将我的页面上的链接作为 .html.erb 文件中的 HTML 呈现到屏幕上，但是当我查看从该模板生成的 PDF 时，我不想看到这些链接。

我曾尝试遵循 Ryan Bates 在 PDFKit Railscast 220 中所做的事情，但它在 Rails 3.2.3 和 Ruby 1.9.3 上对我不起作用。

这是我的视图代码的删节部分：

```
<h2>Client Setup (Only when Patients module is not available)</h2>
<p>
The setup program installs your Clients module using default settings.  After the installation, you can use this program to customize settings to meet your particular needs.
</p>
<p>
  <%= pdf_image_tag("clients/blank/.png",  alt: "Client Setup (Only when Patients Module is not available) - not-populated") %>
<table>
  <thead>
    <tr>
      <th>Form Item</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Default Value Added Tax (Percent)</td>
      <td>
        The package offers a default Value Added Tax, expressed as a percentage of the invoice, to be added to the invoice.  Numbers from 0 to 999.99 are allowed.
      </td>
    </tr>
  </tbody>
</table>
</p>

<hr />
<form class="form-inline">
  <a href="#to_top" class="btn btn-to_top btn-mini">Back to Top</a>
  <%= link_to "Genie Help Index", help_path, class: "btn btn-main-menu pdf_link" %>
  <p id="pdf_link"><%= link_to "Client Help Index", static_page_path("clients/index"), class: "btn btn-help" %></p>
  <%= link_to "Download PDF", static_page_path(:format => :pdf), class: "btn btn-pdf" %>
  <%= link_to image_tag("file_type_pdf.png", height: "24px", width: "24px" , alt: "Download page as PDF"), static_page_path(:format => :pdf) %>
</form>

<p><%= link_to "Client Help Index", static_page_path("clients/index") %></p>
<p><%= link_to "Download as PDF", static_page_path(:format => "pdf"), class: "pdf_link" %></p>
<p id="pdf_link"><%= link_to "Download as PDF", static_page_path(:format => :pdf) %></p>

<% if request.try(:format).to_s == 'pdf' %>
  <%= link_to "Download this PDF", static_page_path(:format => "pdf") %>
<% end %>

#<% if params[:media] = 'all' %>
#  <%= link_to "Download me as a PDF", static_page_path(:format => "pdf") %>
#<% end %>

<div id="pdf-no"><%= link_to "Get me as a PDF file", static_page_path(:format => "pdf") %></div> 
```

控制器是：（显示页面是要渲染的页面的名称）

```
class StaticPages::GenieHelpController < ApplicationController
  def static_page
    respond_to do |format|
      format.html do
        render :template => show_page,
               :layout => 'application'
      end
      format.pdf do
        render :pdf => show_page,
               :layout => 'generic',
               :template => "#{show_page}.html.erb",
               :handlers => :erb,
               :disable_external_links => true,
               :print_media_type => true
      end
    end
  end
end 
```

views/layouts/generic.pdf.erb 文件中的布局文件如下：

```
<!DOCTYPE html>
<html>
  <head>
    <title><%= full_title(yield(:title)) %></title>
    <%= wicked_pdf_stylesheet_link_tag    "static_pages/genie_v23_help", :refer_only => true %>
    <!--     <%#= wicked_pdf_stylesheet_link_tag    "static_pages/pdf" %>    --> 
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>  
  </head>
  <body>
    <div class="container">
      <%= yield %>
      <%= debug(params) if Rails.env.development? %>
    </div>
  </body>
</html> 
```

旧位置 public/stylesheets/static_pages/genie_help.css 中对应的 css 文件：

```
@media print {
    body { background-color: LightGreen; }
    #container {
                  width: auto;
                  margin: 0;
                  padding: 0;
                  border: 2px;
    }
  #pdf_link {
    display: none;
  }
}
  .pdf_link {
    display: none;
  }

#pdf-no {
    display:none;
} 
```

当我呈现 html 页面时，当格式为 html 时，底部的链接会显示（如预期的那样）。

![渲染的 PDF 但仍然显示链接 - 这些是我想要删除的内容，但如何删除？](../Images/02e0c582eab03d0295dc710e0a9717a3.png)

我做错了什么。我假设如果它可以通过 PDFKit 的中间件完成，那么它在 wkhtmltopdf 下得到支持，因为 PDFKit 和 wicked_pdf 都基于此。

谢谢

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T18:56:10.027

事实证明，我通过混合和匹配基于 lib 帮助文件的 wicked_helper.pdf 文件中的四种方法解决了这个问题。

wicked_pdf_image_tag 更改为 pdf_image_tag 用于拉取请求等待提交来自 - mkoentopf

> 多用途 wicked_pdf_helper “您好，我在 wicked_pdf_helper 方法中添加了一些代码。现在他们提供了完整的文件……”

```
 def wicked_pdf_image_tag(img, options={})
    if request.try(:format).to_s == 'application/pdf'
      image_tag "file://#{Rails.root.join('public', 'images', img)}", options rescue nil
    else
      image_tag img.to_s, options rescue nil
    end
  end 
```

我不明白的是在 Rails 3.2 下，我们是否仍在使用公共目录，因为 sprockets 和 assests 被预编译并公开放置？

我当天早些时候使用的解决方案是在 html 布局中添加额外的页眉/页脚部分，而不是在生成 pdf 的布局中。

这是我使用的帮助文件：

```
module WickedPdfHelper
  def wicked_pdf_stylesheet_link_tag(*sources)
    options = sources.extract_options!
    if request.try(:format).to_s == 'application/pdf'
      #css_dir = Rails.root.join('public','stylesheets')
      css_dir = Rails.root.join('app','assets', 'stylesheets')
      refer_only = options.delete(:refer_only)
      sources.collect { |source|
        source.sub!(/\.css$/o,'')
        if refer_only
          stylesheet_link_tag "file://#{Rails.root.join('public','stylesheets',source+'.css')}", options
        else
          "<style type='text/css'>#{File.read(css_dir.join(source+'.css'))}</style>"
        end
      }.join("\n").html_safe
    else
      sources.collect { |source|
        stylesheet_link_tag(source, options)
      }.join("\n").html_safe
    end
  end

  def pdf_image_tag(img, options={})
    if request.try(:format).to_s == 'application/pdf'
      image_tag "file://#{Rails.root.join('app', 'assets', 'images', img)}", options rescue nil
    else
      image_tag img.to_s, options rescue nil
    end
  end

  def wicked_pdf_javascript_src_tag(jsfile, options={})
    if request.try(:format).to_s == 'application/pdf'
      jsfile.sub!(/\.js$/o,'')
      javascript_src_tag "file://#{Rails.root.join('public','javascripts',jsfile + '.js')}", options
    else
      javascript_src_tag jsfile, options
    end
  end

  def wicked_pdf_javascript_include_tag(*sources)
    options = sources.extract_options!
    sources.collect{ |source| wicked_pdf_javascript_src_tag(source, options) }.join("\n").html_safe
  end
end 
```

最好了解更多有关如何使用资产管道的信息。以及如何确定@media。它与 MIME 类型有关吗？如果是这样，为什么我们不需要/或它们没有在 wick_pdf 中定义？

我还没有使用页码和分页符，但现在有一个悬而未决的问题，我将单独提出。

# android - 如何使用 Android XML 布局？

> ID：10826019
> 
> 赞同：0
> 
> 时间：2012-05-31T00:29:17.893
> 
> 标签：android, xml, layout

XML 布局的目的让我感到困惑，我只在 Visual Studio 中使用拖放式 xml 布局和 C# 代码隐藏的 UI。我应该为我的应用程序中的每个屏幕（加载、主、数据）创建一个单独的 xml 布局吗？视图如何与布局关联？如何引用 xml 并在我的代码中使用它？我只知道 setContentView(xml layout) 调用。

例如，对于我的加载屏幕，我想显示背景图像和加载栏。我在想有一种方法可以让布局包含图片和小部件，以便用户立即看到加载屏幕，并且在实际代码中我正在初始化所有必要的变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:39:31.097

如果您对***Android 中的布局如何工作***感到困惑，最好尝试阅读有关[**XML 布局**](http://developer.android.com/guide/topics/ui/declaring-layout.html)的本主题，并阅读有关[**Android 中用户界面的**](http://mobiforge.com/designing/story/understanding-user-interface-android-part-1-layouts)本教程以抢占先机。

这里还有一个关于[**如何将背景图片设置为进度条**](http://gssdaily.com/forum/viewtopic.php?f=18&t=158)的教程。

`main.xml`你应该从你的应用程序代码中加载布局资源（ ），在`onCreate`你的`Activity`.

```
setContentView(R.layout.main); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:34:40.543

是的，您的应用程序的每个页面都需要一个 XML 文件。为该特定页面编写一个 XML 文件，提及所需的字段，并在您的 .java 文件中使用此命令

```
setContentView(R.layout.main); 
```

# ios - 在 Xcode 中查找丢失的文件

> ID：10826021
> 
> 赞同：8
> 
> 时间：2012-05-31T00:29:45.147
> 
> 标签：ios, xcode

我正在为我的 Xcode 项目重新排列文件系统中的文件。因此，当我打开 Xcode 项目时，所有文件都是红色的。

我可以手动添加每个文件，但是 Xcode 有没有办法为我快速找到这些文件？所有文件都位于一个目录中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-07T21:36:06.043

如果您有一堆丢失的（红色）文件现在位于同一目录中，您可以通过一次选择（Cmd-click）所有文件来改进“在检查器中单独修复每个路径”方法。您将在检查器中看到“多个值”，如下所示：

![Xcode 截图：多个值](../Images/0990b15da32c1faeead360f4294160bf.png)

单击位置下拉菜单下的按钮将弹出一个目录选择器 - 请注意，提示显示“选择包含...的文件夹”而不是“选择文件和位置”。

![在此处输入图像描述](../Images/7a749d185351dd1f7b92c559bbfb88ea.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T00:34:12.537

据我所知，Xcode 没有办法自动定位移动的文件。您可以使用 Inspector（右侧面板）重新连接对其文件的引用，但这样做有点乏味。在您的情况下，简单地删除引用然后将文件添加回您的项目可能会更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T03:23:20.817

我同意已经给出的答案。在真正的紧要关头，或者作为最后的手段，您可以在文本编辑器中打开项目文件并手动修复路径引用。

1.  在 Xcode 中关闭项目
2.  将项目文件备份到安全的地方
3.  在 Finder 中，右键单击项目文件并选择“显示包内容”
4.  将 project.pbxproj 拖到 BBEdit（或 TextEdit 或其他）
5.  编辑您想要的任何“path = xxx”引用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T01:13:04.253

在这种情况下，我执行以下步骤：

> 1) 添加一个名为 Res 的新组
> 
> 2) 单击“将文件添加到...”
> 
> 3）找到有资源的文件夹，点击CMD + A
> 
> 4) 选中“为任何添加的文件夹创建文件夹引用”复选框。在源代码中，我使用例如“fonts/font1.xml”。
> 
> 5）然后为了刷新，我只是删除了一个 Res 组引用
> 
> 6）并执行从1到4的步骤

希望这将是一个有用的

# css - HTML 和正文视口问题

> ID：10826022
> 
> 赞同：3
> 
> 时间：2012-05-31T00:29:55.960
> 
> 标签：css, google-chrome, height

我在filmblurb.org 上有一个网站。

当您向外滚动以形成 100% CSS 布局样式时，我网站的页面容器会延伸到窗口底部，但出于某种原因，即使主体和标签的高度均为 100%，这两个元素也会消失大约在页面的一半，然后在视口缩小时停止。当我在 Google Inspect Element 中分析这些元素时。我的页面容器目前是 min-height: 100%，但由于某种原因，缩小时实际上确实延伸到了视口的底部。

我还截取了我所看到的屏幕截图，以便为您提供更好的想法。在这里它们是 [link]i917.photobucket.com/albums/ad16/jtarr523/...（用于正文）和

![在此处输入图像描述](../Images/00bce40c0c0288ee061c41f46636da57.png)

（对于 HTML）...两者都没有延伸到底部。

有人知道如何解决这个问题吗？

我会很感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T06:03:32.907

`min-height: 100%`在`html`元素上意味着该元素将至少与视口一样高。这并不意味着它会一直延伸到底部。如果向下滚动，那么您仍然可以在`<html>`元素底部下方滚动。

防止这种情况（没有 JavaScript）的唯一方法是确保页面上的所有元素（即可能导致滚动条的所有内容）都保留在`html`元素中。强制执行此操作的一种简单方法是穿上`overflow: hidden`您的`html`元素：

```
body {
    overflow: hidden;
} 
```

如果问题是由浮动引起的，那么这将解决它。`html`如果问题是由绝对定位的元素或最后一个元素的负下边距引起的，那么这将用更严重的问题代替您的问题：页面将在元素的底部被切断。然后，您将不得不以其他方式找到问题元素。

（这同样适用于`body`元素；它需要自己的元素`overflow: hidden;`来确保没有任何东西可以超出它。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T07:35:51.703

不确定它是否适用于浏览器缩放，但根据我的经验（根据[这个](https://stackoverflow.com/questions/3740722/min-height-does-not-work-with-body)问题），如果您将`html`容器元素设置为.`height``100%``min-height: 100%`

```
html { height: 100%; }
body { min-height: 100%; } 
```

替换`body`为对您的主容器的引用，它应该仍然可以工作。`html`据我所知，设置为 100%没有不良反应；它不会切断页面或弄乱任何其他样式。

就像我说的，我不是 100% 确定这与您的问题有关，但可能值得一试。

# html - 如何将文本垂直对齐到图像的中间？

> ID：10826025
> 
> 赞同：0
> 
> 时间：2012-05-31T00:30:49.790
> 
> 标签：html, css

请查看以下 jsFiddle 并进行适当更改。我基本上希望文本完全位于图像高度的中间。

[http://jsfiddle.net/e7AV9/1/](http://jsfiddle.net/e7AV9/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T00:36:18.680

您可以将其设置为背景图像并将其居中，然后像这样添加一些左侧填充[http://jsfiddle.net/e7AV9/5/](http://jsfiddle.net/e7AV9/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T00:47:02.543

您也可以将图像直接放在 HTML 中并以这种方式设置样式：http: [//jsfiddle.net/e7AV9/10/](http://jsfiddle.net/e7AV9/10/)

这是[CSS:content](http://www.quirksmode.org/css/content.html)的问题：

> 我觉得我们根本不应该使用内容声明。它向页面添加内容，而 CSS 旨在向页面添加演示文稿，而不是内容。因此，我觉得如果你想动态生成内容，你应该使用 JavaScript。CSS 是这项工作的错误工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T00:39:08.333

我偏爱绝对定位。

*CSS*

```
* {
    font-family: Verdana;
    font-size: 10px;
}

nav > ul li:nth-child(2) a:before {
    position: absolute;
    top: 9px;
    left: -2px;
    content: url(http://s2.postimage.org/1waex5o10/9j41t1.png) " ";
}

nav a {
    color: #626262;
    padding: 10px;
    margin-left: 10px;
    margin-right: 10px;
    width: 150px;
    display: inline-block;
}

nav ul li {
    position: relative;
    display: inline-block;
    list-style: none;
} 
```

*HTML*

```
<nav>
    <ul>
        <li><a href="index.php">Home</a></li>
        <li><a href="forum.php">Community</a></li>
    </ul>
</nav> 
```

​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T02:16:17.197

另一种解决方案可以只是添加 vertical-align: top 例如这个例子：[http://jsfiddle.net/Vh6wP/](http://jsfiddle.net/Vh6wP/)。

这里还有一个关于垂直对齐的链接：[http](http://css-tricks.com/what-is-vertical-align/) ://css-tricks.com/what-is-vertical-align/其他值。

# javascript - Rails 3.链接到javascript文件中的图像在生产中不起作用

> ID：10826028
> 
> 赞同：2
> 
> 时间：2012-05-31T00:31:36.487
> 
> 标签：javascript, ruby-on-rails, ruby

我有一个链接到一些图像的 js 文件，但我无法让它工作。

我已经尝试过这样的js扩展......

```
case 0: var padImg = 'hs.png'; break;
case 0: var padImg = '/assets/hs.png'; break; 
```

我将文件扩展名更改为 js.erb 并尝试了这个...

```
case 0: var padImg = '<%= asset_path 'hs.png' %>'; break; 
```

然后我将图像移动到 js 文件夹，它终于像这样工作了......

```
case 0: var padImg = 'hs.png'; break; 
```

奇怪的是，它适用于我的开发环境，但不适用于生产环境。为什么以及如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:57:08.847

此语法不正确

```
case 0: var padImg = '<%= asset_path 'hs.png' %>'; break; 
```

它应该给出一个 JavaScript 错误。

尝试

```
case 0: var padImg = "<%= asset_path 'hs.png' %>"; break; 
```

通常对于 JavaScript/CoffeeScript 和 ERB，您希望引用图像，例如

```
$('#logo').attr({
  src: "<%= asset_path('logo.png') %>"
}); 
```

[http://guides.rubyonrails.org/asset_pipeline.html](http://guides.rubyonrails.org/asset_pipeline.html)

如果不是这样，那么如果它与开发不同，那么在那里使用的生产服务器操作系统和 Web 服务器是什么？

它是唯一失败的资产管道吗？

**编辑**

为了让 Apache\JBoss 引用 CSS 中的图像，我必须添加 path\war 名称

所以如果我的应用程序根是 localhost:3000/MyApp 然后引用我必须做的图像`url(/MyApp/images/hs.png)`

如果你有 js.erb 你可以像上面那样做，用 css.erb 你可以做`url(<%= asset_path 'hs.png' %>)`

# apache - Htaccess RewriteUrl 字符

> ID：10826029
> 
> 赞同：0
> 
> 时间：2012-05-31T00:32:14.320
> 
> 标签：apache, .htaccess, redirect, http-status-code-404

我正在尝试制作一个供我自己使用的 PHP wiki，并且有一个 Apache mod_rewrite 规则可以`/Main_Page`转到`/index.php?title=Main_Page`

代码如下：

```
RewriteRule ^([a-zA-Z0-9]+)$ /index.php?title=$1
RewriteRule ^([a-zA-Z0-9]+_?[a-zA-Z0-9]+)$ /index.php?title=$1
RewriteRule ^([a-zA-Z0-9]+_?[a-zA-Z0-9]+_?[a-zA-Z0-9]+)$ /index.php?title=$1
RewriteRule ^([a-zA-Z0-9]+_?[a-zA-Z0-9]+_?[a-zA-Z0-9]+_?[a-zA-Z0-9]+)$ /index.php?title=$1 
```

但是，我被困在了一些事情上。我希望该`[a-zA-Z0-9]`部分接受任何字符，而不仅仅是字母数字字符。这可能吗？如果是这样，我将如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:35:47.713

句点将匹配除换行符以外的任何字符。

# symfony1 - 如何访问自定义 addXXXColumnCriteria 中的其他过滤器值？

> ID：10826031
> 
> 赞同：0
> 
> 时间：2012-05-31T00:32:48.983
> 
> 标签：symfony1, symfony-1.4, propel, symfony-forms

我有一个请求来创建一个表单过滤器，它有两个字段，一个是自由格式文本，另一个是选择。select中的值将决定如何处理将文本中的值变成一个条件。

我可以为任一字段创建自定义 addXXXColumnCriteria，但如何从该函数中访问其他字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:38:31.510

我建议你不要使用 de addXXXColumnCriteria，而是覆盖 FormFilter doBuildCriteria (Propel) 或 doBuildQuery(Doctrine) 方法。我从未使用过 Propel，但我想它和 Doctrine 一样好用。

例如：

```
class yourPropelFormFilter extends anyKindOfSfFormFilterPropel {

  public function doBuildCriteria(array $values) {

     $criteria = parent::doBuildCriteria($values);

     // ... change the criteria behaviour with the $values array (do some print_r to $values to see how the data array is formatted)

     return $criteria;
  }

} 
```

对于 Doctrine（记得使用 getRootAlias 查询方法）：

```
class yourDoctrineFormFilter extends anyKindOfSfFormFilterDoctrine {

   public function doBuildQuery(array $values) {
      $q = parent::doBuildQuery($values);
      $rootAlias = $q->getRootAlias();

      if(...) {
        $q->innerJoin($rootAlias.'.RelationX rx')
          ->addWhere('rx.value = ?',$values['...']);
      }

      return $q;
   }

} 
```

请记住返回条件/查询修改的对象！

# android - 有没有办法让 Android 应用程序直接返回到它开始的活动？

> ID：10826034
> 
> 赞同：0
> 
> 时间：2012-05-31T00:33:03.097
> 
> 标签：android

我只是在学习Android编程。我理解它的方式是服务像堆栈一样工作，是否有办法让活动返回到启动应用程序的第一个活动，而不仅仅是前一个活动。

例如，假设我有 4 个活动，a、b、c、d。有没有办法让活动 d 有一个可以调出活动 a 的按钮？而不是活动d去c，c回到b？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:40:54.747

您可以重新开始活动*a*，但在您的意图中使用标志：

`FLAG_ACTIVITY_REORDER_TO_FRONT`

来自[安卓文档](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_REORDER_TO_FRONT)：

> 如果在传递给 Context.startActivity() 的 Intent 中设置，则此标志将导致已启动的活动被带到其任务历史堆栈的前面（如果它已经在运行）。

使用它，您将重用已经运行的活动实例*，*而不是启动一个新实例。请注意，这样做，活动*b*、*c*和*d*的实例将保留在后堆栈中（现在在活动*a*之后）。

否则，如果您想完成此活动（并将它们从后台堆栈中删除），您可以使用[其他标志启动活动](http://developer.android.com/reference/android/content/Intent.html#FLAG_ACTIVITY_CLEAR_TOP)*a*（从*d*）：

`FLAG_ACTIVITY_CLEAR_TOP`

> 如果设置，并且正在启动的活动已经在当前任务中运行，那么不会启动该活动的新实例，而是关闭它上面的所有其他活动，并且此 Intent 将被传递到（现在顶部）作为新意图的旧活动。

**编辑**：如果您还没有阅读，这是一个很好的阅读资源： [Tasks 和 Back Stack](http://developer.android.com/guide/topics/fundamentals/tasks-and-back-stack.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:35:44.733

是的，你可以这么做。您只需将活动 a 的意图编码到按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T00:38:25.457

使用命令

```
finish(): 
```

您将返回主页

或者写一个指向

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T01:10:41.147

`Activities`您可以通过将信息发送到不同的地方`Intents`。

```
Intent myIntent = new Intent(this, AvitivityName.class);
startActivity(myIntent); 
```

不要忘记添加您的`Activities`in `AndroidManifest.xml`。

这里有一些关于 Android 的教程`Intents`：

1.  [**如何使用 Android 意图**](http://www.vogella.com/articles/AndroidIntent/article.html)。

2.  [**如何通过单击按钮切换到另一个活动**](http://www.warriorpoint.com/blog/2009/05/24/android-how-to-switch-between-activities/)。

# .htaccess - Magento 中的 Htaccess 重写

> ID：10826035
> 
> 赞同：0
> 
> 时间：2012-05-31T00:33:14.547
> 
> 标签：.htaccess, magento

我正在尝试从我们的网址中删除某个字符串“.html”

当前示例网址：

[http://www.buildingmaterialsonline.com.au/insulation/by-brand/pink-batts/l/price-6,10///.html?dir=asc&order=price](http://www.buildingmaterialsonline.com.au/insulation/by-brand/pink-batts/l/price-6,10///.html?dir=asc&order=price)

至：

[http://www.buildingmaterialsonline.com.au/insulation/by-brand/pink-batts/l/price-6,10///?dir=asc&order=price](http://www.buildingmaterialsonline.com.au/insulation/by-brand/pink-batts/l/price-6,10///?dir=asc&order=price)

我当前的 htaccess 文件是：

```
############################################
## enable rewrites

    Options +FollowSymLinks
    RewriteEngine on

#If request contains ref param
RewriteCond %{THE_REQUEST} \?([^&\ ]+).html=  [NC]  
#redirect to URL without the html param
RewriteRule ^  %{REQUEST_URI}?%1 [L,R=301] 

############################################
## you can put here your magento root folder
## path relative to web root

    #RewriteBase /magento/

############################################
## workaround for HTTP authorization
## in CGI environment

    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

############################################
## always send 404 on missing files in these folders

    RewriteCond %{REQUEST_URI} !^/(media|skin|js)/

############################################
## never rewrite for existing files, directories and links

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-l

############################################
## rewrite everything else to index.php

    RewriteRule .* index.php [L]

</IfModule> 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:36:45.517

您不需要使用 htaccess 来执行此操作。

Magento 在后端有一个选项来添加这些后缀。默认为 .html。

本文介绍了如何更改它：

[http://php.quicoto.com/how-to-remove-html-from-magento/](http://php.quicoto.com/how-to-remove-html-from-magento/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-12T07:55:36.847

Magento 提供了一个简单的选项来从类别和产品 URL 中删除 .html。

您不需要使用 .htaccess 进行任何操作。

转到系统 --> 配置

然后单击左侧菜单中的目录。

然后在“搜索引擎优化”选项卡下，从“产品 URL 后缀”和“类别 URL 后缀”中删除“.html”。

单击“保存配置”按钮。

注意：如果您愿意，可以为这些条目设置任何其他后缀。

# python - Python：从（当前已弃用）位置导入模块时发出警告

> ID：10826042
> 
> 赞同：1
> 
> 时间：2012-05-31T00:34:29.883
> 
> 标签：python, python-module, python-import

我们有一个应用程序，它的用户可以使用插件对其进行扩展。我们提供了一些帮助模块，因此用户可以从他们的插件中访问它们

```
import helpermodule 
```

现在我们决定最好更改辅助模块的包装，以便所有这些都从主包中加载，如下所示：

```
from ourpackage import helpermodule 
```

由于我们不想破坏用户插件中的现有代码，我们仍然提供旧方法。（事实上​​，我们刚刚在源代码目录中的`__init__.py`文件中导入了辅助模块。 ）当用户脚本以旧方式导入辅助模块时，`ourpackage`我们非常希望发出警告（使用标准库）。`warnings`

所以我的问题是：有没有办法判断用户是否以“错误”的方式导入了帮助模块？理想情况下，我们希望在不检查用户代码的情况下实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T07:42:31.797

It depends on how you are achieving the "still provide the old way". It sounds like you are leaving the old modules directly on the search path and just doing `import helpermodule` inside ourpackage. (That is, you yourself are still importing the module in the "wrong" way.) In that case here is one possibility.

```
\dir_on_path
helper.py
    \ourpackage
        __init__.py

#### helper.py
import sys
if 'testpack' in sys.modules:
    print "Imported the good way"
else:
    print "Imported the bad way"
####

#### __init__.py
import teststuff
#### 
```

However, note that this way of doing it leaves some awkward problems. You will not be able to do `import testpack.teststuff`. Also, there remains the possibility that the person could import teststuff in both the good and bad ways, creating two separate copies in sys.modules.

If this isn't how you are "still providing the old way" please edit to clarify.

# javascript - 如何让实例从原型函数中删除自己是 JavaScript

> ID：10826046
> 
> 赞同：8
> 
> 时间：2012-05-31T00:34:54.880
> 
> 标签：javascript

如果我有一个 JavaScript 构造函数，并且我在它的原型上设置了一个 destroy 方法。是否可以从 destroy 方法中删除（或至少取消设置）实例？这是我正在尝试做的一个例子。

```
Klass.prototype = {
  init: function() {
    // do stuff
  },
  destroy: function() {
    // delete the instance    
  }
};

k = new Klass
k.destroy()
console.log(k) // I want this to be undefined 
```

我知道我不能简单地`this = undefined`使用 destroy 方法，但我认为我可以通过使用像这样的超时来解决这个问题：

```
destroy: function() {
  var self = this;
  setTimeout( function() {
    self = undefined
  }, 0)  
} 
```

我认为超时函数可以通过闭包访问实例`self`（确实如此），但这似乎不起作用。如果我`console.log(self)`从该函数内部显示为`undefined`，但`k`在全局范围内仍然是`Klass`.

有谁知道如何使这项工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T00:45:14.183

`k`是指向 的实例的引用`Klass`。当您`destroy`作为内部方法调用时`Klass`，`this`函数会绑定到您调用`destroy`方法的对象。它现在是对该实例的另一个引用`Klass`。您在`self`那个小闭包中关闭的 是对该实例的另一个引用。当您将其设置为`undefined`您清除该引用时，而不是它背后的实例。你不能真的`destroy`那个实例本身。您可以*忘记*它（将所有引用设置为`undefined`，您将不会再找到它），但这是您所能做到的。

就是说，告诉我们您想用这个完成什么，我们很乐意帮助您找到解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T00:55:43.740

虽然删除自己的对象实例是可能的，但它非常俗气。你可能想看看[这篇](http://perfectionkills.com/understanding-delete/)文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T00:43:34.080

你试图做的事情是不可能的。即使您覆盖`this`它也不会影响任何持有对该实例的引用的变量。并且在它上面调用一个函数仍然会有正确的`this`.

你唯一能做的就是在你的`destroy`函数中设置一个变量，这将使任何其他函数在调用时抛出异常。但这将是一个坏主意，因为它会减慢速度（好吧，这可以忽略不计），并且您可以在您的班级的文档中放入它在`destroy()`被调用后不应再使用的文档。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T00:51:49.563

这可行，但它要求您知道`new Klass()`实例化的变量的名称：

```
function Klass() {};

Klass.prototype = {
  init: function() {
    //
  },
  destroy: function() {
    // Delete the variable that references the instance of the constructor.
    delete window.k;
  }
};

k = new Klass();
k.destroy();
console.log(k); 
```

如果`k`变量被命名为其他任何名称，则它不起作用：

```
// Won't work.
u = new Klass();
u.destroy(); 
```

它还假设局部变量`k`确实在全局范围内。如果它在一个函数内部，它也不会工作。例如：

```
// Won't work.
var fn = function() {
  k = new Klass();
  k.destroy();
}; 
```

最后，它假定对象的浏览器环境`window`。

# arrays - 数组长度检查时出现未初始化值警告

> ID：10826050
> 
> 赞同：1
> 
> 时间：2012-05-31T00:35:48.133
> 
> 标签：arrays, perl, dereference

我有以下代码：

```
my @product_access = @{ $products->{ $PosDetails->{"SalProductRef"}->[$i]}
                      {DetAccess_tab} };

if ( @product_access == 1 )
{
    $revenue{ $products->{ $PosDetails->{"SalProductRef"}->[$i] }{DetFinanceCategory} }
            {"Total"} += $PosDetails->{"SalSubTotal"}->[$i];
} 
```

在我检查数组长度的地方，我得到了一个`Use of uninitialized value in concatenation`警告。在那条线上得到这个警告似乎有点奇怪。为什么会显示此警告？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T01:14:28.497

某些版本的 perl 会在 if 行的 elsif 子句中报告一些警告。我敢打赌这里就是这种情况。

# ruby-on-rails - Rails sitemap_generator 未初始化常量？

> ID：10826054
> 
> 赞同：5
> 
> 时间：2012-05-31T00:36:23.220
> 
> 标签：ruby-on-rails, ruby, sitemap

我正在尝试使用 Rails 站点 map_generator gem 为 8,000,00 页站点生成站点地图。宝石可以在这里找到：[https ://github.com/kjvarga/sitemap_generator](https://github.com/kjvarga/sitemap_generator)

这是我在 sitemap.rb 中的代码：

```
require 'rubygems'
require 'sitemap_generator'

# Set the host name for URL creation
SitemapGenerator::Sitemap.default_host = "http://www.mysite.com"

SitemapGenerator::Sitemap.create do
  add '/content.aspx?page=privacypolicy'
  Product.find_each do |product|
    add product_path(ppid), :lastmod => content.updated_at
  end
end 
```

但是，当我跑步时

```
>> ruby sitemap.rb 
```

我收到一条错误消息：

> sitemap.rb:9:in `block in': 未初始化的常量 SitemapGenerator::Interpreter::Product (NameError)

但是“产品”是我模型的正确名称。为什么会这样？

我正在运行 Rails 3.1.2 和 Ruby 1.9。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-02T22:41:23.997

我是宝石的作者。以后最好在 GitHub 页面上打开一个问题。SitemapGenerator 在 Rails 3 和 Ruby 1.9.* 中工作。如果您正在运行 Rails，则不需要这些行：

```
require 'rubygems'
require 'sitemap_generator' 
```

您还可以通过运行 Rake 生成站点地图：

```
rake sitemap:refresh:no_ping 
```

在您的情况下发生的情况是，由于您没有通过 Rake 运行，因此脚本不知道 Product 类，因为您的 Rails 环境尚未加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T19:53:26.127

好吧，我无法让这个宝石工作。我的猜测是它不适用于 Rails 3.1.2 或 Ruby 1.9。但是，我能够让另一个 gem (big_sitemap) 工作。这是它的链接。

[https://github.com/alexrabarts/big_sitemap](https://github.com/alexrabarts/big_sitemap)

# java - 使用 Weblogic RMI over T3 来自单个 JVM 的多个 RMI 连接

> ID：10826056
> 
> 赞同：0
> 
> 时间：2012-05-31T00:36:51.597
> 
> 标签：java, weblogic, rmi, jndi

我正在尝试将 JMeter 与一些自定义采样器一起使用来负载测试通常通过 Weblogic RMI over T3 从基于 Swing 的 GUI 访问的 Java 应用程序。目的是通过模拟许多并发用户连接/交互（最多约 500 个）来加载应用程序服务器并测量特定事务的响应时间。

我已经实现了几个 JMeter 采样器，它们通过 JNDI 查找获取到服务器的 RMI 连接，并且工作正常。但是我注意到，即使我使用不同的凭据在不同的线程上获取两个上下文，也只会打开一个 T3 连接。

有没有一种方法可以有效地从一个 JVM 中创建到应用服务器的多个独立连接，或者我是否会被迫每个 JVM 运行一个用户？

应用程序在 WLS 11g 中运行，目前在 Hotspot 32 位上，但将迁移到 JRockit 64 位。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:52:06.960

您正在运行 RMI 连接池。有一些方法可以将其关闭，请参阅 RMI 主页和从它们链接的属性页面，但由于其他原因（例如客户端主机上的端口耗尽），它仍然是一个不切实际的测试。您真的应该考虑使用尽可能多的客户端主机和尽可能多的单独 JVM。

# c++ - 如何使用 indy 10.5.5 c++ 读写 Stream

> ID：10826060
> 
> 赞同：0
> 
> 时间：2012-05-31T00:37:29.123
> 
> 标签：c++, c++builder, indy10

嗨，我尝试使用此代码从服务器读取 Stream

```
void __fastcall TForm1::Edit1KeyPress(TObject *Sender, wchar_t &Key)
{
   //TMemoryStream *TMS = new TMemoryStream;
   TStringStream *TSS = new TStringStream;
   AnsiString A,B;
   TStream *TS;
   INT64 Len;
   try
   {
       if (Key == VK_RETURN)
       {
          Beep(0,0);
          if(Edit1->Text == "mystream")
           {
               TCPClient1->IOHandler->WriteLn("mystream");
               Len = StrToInt(TCPClient1->IOHandler->ReadLn());
               TCPClient1->IOHandler->ReadStream(TS,Len,false);
               TSS->CopyFrom(TS,0);
               RichEdit1->Lines->Text = TSS->DataString;
               Edit1->Clear();
           }
       else
           {
              TCPClient1->IOHandler->WriteLn(Edit1->Text);
              A = TCPClient1->IOHandler->ReadLn();
              RichEdit1->Lines->Add(A);
              Edit1->Clear();
           }
       }
   }
   __finally
   {
       TSS->Free();
   }

} 
```

编译器说，每次客户端尝试从服务器读取流。

```
First chance exception at $75D89617\. Exception class EAccessViolation with message 'Access violation at address 500682B3 in module 'rtl140.bpl'. Read of address 00000018'. Process Project1.exe (6056) 
```

如何处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T00:29:03.073

在`TStream`调用`ReadStream()`. 您的`TS`变量完全未初始化。 `ReadStream()`不会`TStream`为您创建对象，只会写入它，因此您必须`TStream`事先创建自己。

鉴于您显示的代码，您可以`TStream`使用以下`ReadString()`方法完全替换：

```
void __fastcall TForm1::Edit1KeyPress(TObject *Sender, wchar_t &Key) 
{ 
    if (Key == VK_RETURN) 
    { 
        Beep(0,0); 
        if (Edit1->Text == "mystream") 
        { 
            TCPClient1->IOHandler->WriteLn("mystream"); 
            int Len = StrToInt(TCPClient1->IOHandler->ReadLn()); 
            RichEdit1->Lines->Text = TCPClient1->IOHandler->ReadString(Len); 
        } 
        else 
        { 
            TCPClient1->IOHandler->WriteLn(Edit1->Text); 
            String A = TCPClient1->IOHandler->ReadLn(); 
            RichEdit1->Lines->Add(A); 
        } 
        Edit1->Clear(); 
    } 
} 
```

# css - 如何创建一个 calc mixin 作为表达式传递来生成标签？

> ID：10826064
> 
> 赞同：41
> 
> 时间：2012-05-31T00:38:10.023
> 
> 标签：css, sass

我正在研究一个 sass 样式表，我希望在其中使用该`calc`元素来动态调整某些内容的大小。由于`calc`元素尚未标准化，我需要定位`calc()`,`-moz-calc()`和`-webkit-calc()`.

有没有办法让我创建一个可以将表达式传递给的 mixin 或函数，以便它生成所需的标签，然后可以将其设置为 a `width`or `height`？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-05-31T01:37:27.503

这将是一个[带有参数的基本 mixin](http://sass-lang.com/tutorial.html)，幸运的是，表达式在支持的范围内不是特定于浏览器的：

```
@mixin calc($property, $expression) {
  #{$property}: -webkit-calc(#{$expression});
  #{$property}: calc(#{$expression});
}

.test {
  @include calc(width, "25% - 1em");
} 
```

将呈现为

```
.test {
  width: -webkit-calc(25% - 1em);
  width: calc(25% - 1em);
} 
```

您可能希望在不支持 calc 时包含“默认”值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-28T18:05:57.410

Compass 提供[了一个共享实用程序](http://compass-style.org/reference/compass/css3/shared/#mixin-experimental-value)来为这种情况添加供应商前缀。

```
@import "compass/css3/shared";

$experimental-support-for-opera: true; // Optional, since it's off by default

.test {
  @include experimental-value(width, calc(25% - 1em));
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-30T19:35:33.900

使用 unquote 功能可以很容易地使用 calc：

```
$variable: 100%
height: $variable //for browsers that don't support the calc function  
height:unquote("-moz-calc(")$variable unquote("+ 44px)")
height:unquote("-o-calc(")$variable unquote("+ 44px)")
height:unquote("-webkit-calc(")$variable unquote("+ 44px)")   
height:unquote("calc(")$variable unquote("+ 44px)") 
```

将呈现为：

```
height: 100%;
height: -moz-calc( 100% + 44px);
height: -o-calc( 100% + 44px);
height: -webkit-calc( 100% + 44px);
height: calc( 100% + 44px); 
```

您也可以尝试按照上面的建议创建 mixin，但我的做法略有不同：

```
$var1: 1
$var2: $var1 * 100%
@mixin calc($property, $variable, $operation, $value, $fallback)
 #{$property}: $fallback //for browsers that don't support calc function
 #{$property}: -mox-calc(#{$variable} #{$operation} #{$value})
 #{$property}: -o-calc(#{$variable} #{$operation} #{$value})
 #{$property}: -webkit-calc(#{$variable} #{$operation} #{$value})
 #{$property}: calc(#{$variable} #{$operation} #{$value})

.item     
 @include calc(height, $var1 / $var2, "+", 44px, $var1 / $var2 - 2%) 
```

将呈现为：

```
.item {
height: 98%;
height: -mox-calc(100% + 44px);
height: -o-calc(100% + 44px);
height: -webkit-calc(100% + 44px);
height: calc(100% + 44px);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-22T15:39:33.717

另一种写法：

```
@mixin calc($prop, $val) {
  @each $pre in -webkit-, -moz-, -o- {
    #{$prop}: $pre + calc(#{$val});
  } 
  #{$prop}: calc(#{$val});
}

.myClass {
  @include calc(width, "25% - 1em");
} 
```

我认为这是更优雅的方式。

# ios - iOS：Grand Central Dispatch 和 ViewControllers

> ID：10826067
> 
> 赞同：0
> 
> 时间：2012-05-31T00:38:29.887
> 
> 标签：ios, uiviewcontroller, grand-central-dispatch

在这一点上，我很沮丧，但我确定这是我所缺少的。在这段代码中，我的新 viewController 的 segue 在函数的其余部分执行后显示。如何让我的 viewController 成为正在执行的代码？基本上阻止 tweetText 函数发生，直到该视图关闭我试图给用户一个选项来选择一个 Twitter 帐户，如果有多个帐户。我尝试了很多不同的方法。在 Apple 自己的示例代码中，他们建议给用户一个选项，但不提供任何关于如何做到这一点的信息，而无需浏览其余代码。

这是代码：

```
 [accountStore requestAccessToAccountsWithType:accountType withCompletionHandler:^(BOOL granted, NSError *error) {

        if(granted) {
            dispatch_sync(dispatch_get_main_queue(), ^{
                // Get the list of Twitter accounts.
                self.accountsArray = [accountStore accountsWithAccountType:accountType];

                if([self.accountsArray count] > 1 /* Check method to see if preference is still a valid account */) {
                    // Display user accounts if no preference has been set
                    [self performSegueWithIdentifier:@"TwitterAccounts" sender:self.accountsArray];

                    [tweet tweetText:tweetString account:self.twitterAccount type:AchievementTweet];

                } else {
                    [tweet tweetText:tweetString account:[self.accountsArray lastObject] type:AchievementTweet];
                }
            });

        } else {
            [tweet performSelectorOnMainThread:@selector(displayText:) withObject:[NSNumber numberWithInt:403] waitUntilDone:NO];
        }
       }]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:31:30.937

我对你的目的有点困惑，但你有两个选择。

这里真的不需要GCD。

我建议注册一个通知，一旦你的第一个动作完成，它将执行你的第二个动作。（类似于苹果处理图像选择器的方式，在他们的代码中，他们会告知何时最终保存图片以执行另一个功能）。

另一种方法是使用委托，在这种方法中，您可以将代码的第二部分放在一个单独的函数中，然后将该控制器声明为您要首先执行的视图控制器的委托，然后在视图控制器上完成您想要完成的任何操作您会要求委托执行第二个代码，并在必要时要求委托也关闭视图。

# php - 为什么我不能直接浏览 Magento 可下载产品的文件路径？

> ID：10826068
> 
> 赞同：0
> 
> 时间：2012-05-31T00:38:29.683
> 
> 标签：php, apache, .htaccess, magento

我有一个客户，其可下载的 Magento 产品是既可以下载又可以从“我的帐户”区域播放的视频。我已正确设置所有内容，但 Flash 视频播放器无法通过直接路径访问文件，即使该`/media/downloadable/files/links/*`区域中所有文件的权限设置为 777。

我意识到这是 Magento 故意作为安全问题的一部分，但是我该如何覆盖它呢？**我在.htaccess**文件中没有看到任何表明文件权限受到限制的内容，但也许我在某个地方错过了它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T07:14:58.367

直接访问可下载文件被阻止`media/downloadable/.htaccess`：

```
Order deny,allow
Deny from all 
```

# c++ - DirectShow CLR 存在全局变量问题

> ID：10826071
> 
> 赞同：0
> 
> 时间：2012-05-31T00:38:58.307
> 
> 标签：c++, clr, directshow

我正在尝试在 CLR C++ 中编写 GMFBridge 和 DirectShow。我正在尝试将其性能与同一解决方案中的 GMFBridgeLib 和 DirectShowLib 进行比较，看看哪个更有效。

现在我正在关注 GMFBridge 源代码来设置 C++ 捕获。我遇到的一个问题是需要全局的对象，以便可以通过 GUI 按钮访问它们。GMFBridge 代码如下：

```
private:
IGMFBridgeControllerPtr m_pBridge; 
```

然后在设置代码中使用如下：

```
HRESULT hr = m_pBridge.CreateInstance(__uuidof(GMFBridgeController));

if (FAILED(hr))
{
    return hr;
}

// init to video-only, in discard mode (ie when source graph
// is running but not connected, buffers are discarded at the bridge)
hr = m_pBridge->AddStream(true, eMuxInputs, true); 
```

我当前的问题是 CLR 声明任何全局都必须是某种形式的指针，* 或 ^ 取决于托管或非托管。它不会让我像 GMFBridge 源代码那样添加全局变量。如果我创建一个指针：

```
IGMFBridgeControllerPtr* pBridge2; 
```

并尝试在我的 GUI 代码中使用它：

```
(*pBridge2).CreateInstance(__uuidof(GMFBridgeController));
(*pBridge2).AddStream(true, eMuxInputs, true); 
```

它确实可以编译，但是当我运行它时，代码会崩溃

```
An unhandled exception of type 'System.NullReferenceException' occurred in Program.exe.

Addidional information: Object reference not set to an instance of an object. 
```

在代码块上

```
void _Release() throw()
{
    if (m_pInterface != NULL) {            <--------------
        m_pInterface->Release();
    }
} 
```

在 comip.h 第 823 行中调用：

```
HRESULT CreateInstance(const CLSID& rclsid, IUnknown* pOuter = NULL, DWORD dwClsContext = CLSCTX_ALL) throw()
{
    HRESULT hr;

    _Release();

    if (dwClsContext & (CLSCTX_LOCAL_SERVER | CLSCTX_REMOTE_SERVER)) {   <----------
        IUnknown* pIUnknown;
        hr = CoCreateInstance(rclsid, pOuter, dwClsContext, __uuidof(IUnknown), reinterpret_cast<void**>(&pIUnknown));

        if (SUCCEEDED(hr)) {
            hr = OleRun(pIUnknown);

            if (SUCCEEDED(hr)) {
                hr = pIUnknown->QueryInterface(GetIID(), reinterpret_cast<void**>(&m_pInterface));
            }

            pIUnknown->Release();
        }
    }
    else {
        hr = CoCreateInstance(rclsid, pOuter, dwClsContext, GetIID(), reinterpret_cast<void**>(&m_pInterface));
    }

    if (FAILED(hr)) {
        // just in case refcount = 0 and dtor gets called
        m_pInterface = NULL;
    }

    return hr;
} 
```

从这行代码调用的 comip.h 第 626 行

```
(*pBridge2).CreateInstance(__uuidof(GMFBridgeController)); 
```

唯一可行的方法是创建一个不是点对象的局部变量，但是我无法将其设置为全局变量，或者在 GUI 对象中使用它。

如果我将其设为本地：

```
IGMFBridgeControllerPtr pBridge;
pBridge.CreateInstance(__uuidof(GMFBridgeController)); 
```

这样可行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T05:48:36.723

问题似乎是您没有为您声明的指针分配任何内容：

```
IGMFBridgeControllerPtr* pBridge2; 
```

您必须执行以下操作：

```
pBridge2 = &m_pBridge; 
```

或者只是`pBridge2`完全跳过使用并使用`&m_pBridge`。

# sql - SQL Server 2008 恢复 MDF 和 LDF 文件

> ID：10826079
> 
> 赞同：1
> 
> 时间：2012-05-31T00:39:34.263
> 
> 标签：sql, sql-server-2008, sql-server-data-tools

背景：我有一个名为的工作数据库`WBPM`，我使用 SSMS 中的右键单击功能将其重命名为，`WBPM_v20120530`因为我想推出一个新版本的数据库。我相信 SSMS 的右键单击重命名功能不会更改物理`.MDF`或`.LDF`文件，所以当我想使用 SSDT 发布新版本时，我收到错误通知我`WBPM`存在 LDF 和 MDF 文件。

我使用 Windows 资源管理器重命名了物理文件。这是我遵循的程序：

```
-- 1\. The Database had been renamed using SSMS right click FROM WBPM to WBPM_v20120530.
ALTER DATABASE WBPM_v20120530 SET OFFLINE

-- 2\. I have inserted the new string "_v20120530" to the .mdf file using Windows Explorer and then run this command.
ALTER DATABASE WBPM_v20120530
MODIFY FILE (NAME = WBPM, 
FILENAME = 
'C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBMD_v20120530_Primary.mdf')
GO

-- 3\. I have inserted the new string "_v20120530" to the .ldf file and run this command.
ALTER DATABASE WBPM_v20120530 
MODIFY FILE (NAME = WBPM_log, 
FILENAME ='C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBPM_v20120530_Primary.ldf')
GO

-- 4\. I can not bring the database Online?
ALTER DATABASE WBPM_v20120530 SET ONLINE
GO 
```

这是我从 SSMS 收到的错误消息：

> 消息 5120，级别 16，状态 101，第 1 行
> 无法打开物理文件“C:\Program Files\Microsoft SQL Server\MSSQL10_50.MSSQLSERVER\MSSQL\DATA\WBMD_v20120530_Primary.mdf”。
> 操作系统错误 2：“2（无法检索此错误的文本。
> 原因：15105）
> 
> 消息 945，级别 14，状态 2，第 1 行
> 数据库“WBPM_v20120530”由于无法访问文件或内存或磁盘空间不足而无法打开。有关详细信息，请参阅 SQL Server 错误日志。
> 
> 消息 5069，级别 16，状态 1，第 1 行
> ALTER DATABASE 语句失败。

任何帮助将不胜感激，因为我想恢复数据库？

非常感谢和亲切的问候，

伯蒂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:15:19.123

我遵循了您的确切程序，并且能够做到这一点没问题。

请验证 SQL Server 服务帐户对该文件夹是否具有完全权限，是否已禁用 UAC，并且 Windows 资源管理器中的两个文件名的拼写是否与您的 alter 语句中的文件名匹配。

还可以尝试使用稍短的文件名（例如，尝试将 v2 注入文件路径而不是 v20120530 - 你不应该在那里达到上限，但它可能值得一试。

# html - 将底部边框定位在有序列表的项目符号下方

> ID：10826080
> 
> 赞同：3
> 
> 时间：2012-05-31T00:40:04.753
> 
> 标签：html, css, html-lists, border

[http://jsfiddle.net/G34yN/7/](http://jsfiddle.net/G34yN/7/)

有人知道如何将底部边框放置在有序列表的项目符号下方吗？

```
ol li {
    list-style-type:decimal;
    border-bottom: 1px solid #000;
    padding-left: 20px;
    margin-left: 20px;
}

<ol>
    <li>One</li>
    <li>Two</li>
    <li>Three</li>
</ol> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T00:42:16.623

添加：

```
ol {
    list-style-position: inside;
} 
```

在这里看到它：http: [//jsfiddle.net/G34yN/8/](http://jsfiddle.net/G34yN/8/)

您可能需要稍微修改左侧填充。

# delphi - 如何在 QuickReport 的每一页上打印 QRBand？

> ID：10826081
> 
> 赞同：0
> 
> 时间：2012-05-31T00:40:06.500
> 
> 标签：delphi, quickreports

我在临床分析中使用 Delphi2006 和 QuickReport4 组件。

我需要打印带有患者检查结果的页面。

当我打印时，我使用`PageHeader`具有一定高度的空白带，以避免在纸质标志上打印。但是当带有标志的论文结束时，报告会启用具有相同标志的其他乐队。

问题是第三个波段是患者信息头，它应该出现在每个页面中，但唯一这样做的波段是页眉和页脚。

我已经将空白带和信息带都设置为`HeaderBand`，但 QuickReport 只接受第一个作为标题。

关于如何在页面顶部的每一页上打印另一个乐队的任何想法？

我也有同样的问题，医生签名应该在每一页上，但只出现在最后一页上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:08:02.353

您可以使用 ChildBand，将 PageHeader 作为其 ParentBand。每次打印您的（空白）PageHeader 时，她的孩子也将在它之后打印。

# ember.js - 在 EmberJS 中嵌套 @each 观察者（例如 rows.@each.cols.@each.label）

> ID：10826082
> 
> 赞同：1
> 
> 时间：2012-05-31T00:40:16.267
> 
> 标签：ember.js

我正在尝试构建一个观察者来检测何时发生表模型深处的变化。我可以在“rows.@each.label”上收到通知，但不能在“rows.@each.cols.@each.label”上收到通知。

```
App.Row = Ember.Object.extend({
    init: function () {
        this.set('cols', []);
    }
});

App.Col = Ember.Object.extend({
    label: null
});
    var doneWithSetup = false;
var table = Ember.Object.create({
    rows: [],
    colLabelChanged: function () {
        if (doneWithSetup) console.log("IT WORKED! I got notified when a col label changed");
    }.observes("rows.@each.cols.@each.label")
});

var row = App.Row.create({});
var col1 = App.Col.create({ label: "Label 1" });
var col2 = App.Col.create({ label: "Label 2" });
row.get('cols').pushObject(col1);
row.get('cols').pushObject(col2);
table.get('rows').pushObject(row);

// OK, lets try this observer out...
doneWithSetup = true;
col1.set('label', 'some new label');

// FIXME: how do I get colLabelChanged to fire??? 
```

你可以在这里试试：

[http://jsfiddle.net/4H2ya/3/](http://jsfiddle.net/4H2ya/3/)

我做错了什么还是不支持多级@each 观察者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-17T17:43:20.200

根据文档，不支持嵌套 @each。

```
Note that @each only works one level deep. You cannot use nested forms like todos.@each.owner.name or todos.@each.owner.@each.name. 
```

[http://emberjs.com/guides/object-model/computed-properties-and-aggregate-data/](http://emberjs.com/guides/object-model/computed-properties-and-aggregate-data/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T17:31:55.057

这是 EmberJS 0.9.8.1 中的一个错误：[https ://github.com/emberjs/ember.js/issues/541](https://github.com/emberjs/ember.js/issues/541)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T15:59:47.727

运行此代码并在控制台中得到“它工作！当 col 标签更改时我收到通知”。（使用 Chrome 19。）

[http://jsfiddle.net/4H2ya/](http://jsfiddle.net/4H2ya/)

所以实际上支持多个@each，你没有做错任何事。您使用的是哪个版本的 Ember？

# c# - C# 程序传递一个 uint[]，其中包含指向 C++ dll 的字符串指针

> ID：10826086
> 
> 赞同：0
> 
> 时间：2012-05-31T00:41:27.443
> 
> 标签：c#, string, pointers

我知道有很多关于将指针从 C# 程序传递到第三方 C++ dll 的讨论。但我的情况很特殊。

我有一个第三方 C++ DLL，我在其中调用了一个函数：

```
[DllImport(@"ThirdParty.DLL", EntryPoint = "?ThirdPartyEntryPoint", CallingConvention = CallingConvention.Cdecl)]
public static extern Int16 ThirdParty_command(uint p1, ushort p2, uint[] data); 
```

现在棘手的是，“uint[] data”中的元素之一是一个字符串指针，它指向 C++ 中的一个字符串（类型：unsigned char）。我试过这个但它不起作用：

```
String name = "myName";
fixed (char* nameAddress = name)
{
    uint[] data = { 0x00, 0x01, 0x02,(uint) nameAddress };
    Int16 result = ThirdParty_command(0, 0, data);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:13:10.710

很可能`unsigned char*`是正常情况造成的`byte[]`，不是`uint[]`。检查 C 端预期的字符串类型，您可能需要将 UTF-16（C# 字符串）转换为其他编码，如 UTF-8。

# ruby-on-rails - 当 Model.all 来自 Model.find_by 时，rails 中的每个方法的行为都不同

> ID：10826087
> 
> 赞同：1
> 
> 时间：2012-05-31T00:41:50.943
> 
> 标签：ruby-on-rails, ruby-on-rails-3

当我得到我的@variables 时：

```
@variables = Variable.all 
```

我可以

```
@variables.each do |variable| 
```

很好，但是当我用 find_by 得到它时，就像这样：

```
@variables = Variable.find_by_user_id(user.id) 
```

我得到一个**找不到每个方法的错误**！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:43:30.327

find_by_field 方法返回一条记录，您无法对其进行迭代。

你想要的是

```
Variable.where(:user_id => user.id) 
```

或者

```
Variable.find_all_by_user_id(user.id) 
```

或（假设您已正确设置关联）

```
user.variables 
```

# ruby-on-rails - Rails 资产和 CDN 问题（CSS、JS 参考）

> ID：10826089
> 
> 赞同：1
> 
> 时间：2012-05-31T00:42:07.513
> 
> 标签：ruby-on-rails, asset-pipeline, cdn, amazon-cloudfront, assets

我正在处理Rails 3.1.2、asset_sync 和cludfront。我已经安装了asset_sync 并预编译了所有资产。我面临的问题如下：rake编译将javascript和css文件组合成一个应用程序。[js|css]。在生产模式下，应用程序仍在引用原始名称，但使用新的 cdn 路径，我收到 404 错误。

这是生产环境文件：

```
Griov4::Application.configure do
  # Settings specified here will take precedence over those in config/application.rb

  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local       = false
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = false

  # Compress JavaScripts and CSS
  config.assets.compress = true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = true

  # Generate digests for assets URLs
  config.assets.digest = true

  # Defaults to Rails.root.join("public/assets")
  # config.assets.manifest = YOUR_PATH

  # Specifies the header that your server uses for sending files
  # config.action_dispatch.x_sendfile_header = "X-Sendfile" # for apache
  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx

  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.
  # config.force_ssl = true

  # See everything in the log (default is :info)
  # config.log_level = :debug

  # Use a different logger for distributed setups
  # config.logger = SyslogLogger.new

  # Use a different cache store in production
  # config.cache_store = :mem_cache_store

  # Enable serving of images, stylesheets, and JavaScripts from an asset server
  # config.action_controller.asset_host = "http://assets.example.com"

  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)
  # config.assets.precompile += %w( search.js )

  # Disable delivery errors, bad email addresses will be ignored
  # config.action_mailer.raise_delivery_errors = false

  # Enable threaded mode
  # config.threadsafe!

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation can not be found)
  config.i18n.fallbacks = true

  # Send deprecation notices to registered listeners
  config.active_support.deprecation = :notify

  config.action_controller.asset_host = "#{ENV['CDN']}"

end 
```

这是我的 .env 文件

```
FOG_PROVIDER=AWS
FOG_DIRECTORY=
AWS_ACCESS_KEY_ID= 
AWS_SECRET_ACCESS_KEY=
CDN=http://d3tf1w68p27174.cloudfront.net
RACK_ENV=production 
```

我在 js 文件夹中的清单文件：

```
// This is a manifest file that'll be compiled into including all the files listed below.
// Add new JavaScript/Coffee code in separate files in this directory and they'll automatically
// be included in the compiled file accessible from http://example.com/assets/application.js
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//

//= require_tree . 
```

我在 css 文件夹中的清单文件：

```
/*
 * This is a manifest file that'll automatically include all the stylesheets available in this directory
 * and any sub-directories. You're free to add application-wide styles to this file and they'll appear at
 * the top of the compiled file, but it's generally better to create a new file per style scope.
 *= require_self
 *= require bootstrap.min
*/ 
```

然后我输入：`$`bundle exec rake assets:clean assets:precompile

application.ss 和 application.js 被创建，但不幸的是，生产应用程序仍然引用具有以下路径的原始 css/js 文件：

[http://d3tf1w68p27174.cloudfront.net/assets/home-24d72d1643e0016381b14c19d90d9e74.css](http://d3tf1w68p27174.cloudfront.net/assets/home-24d72d1643e0016381b14c19d90d9e74.css)

[http://d3tf1w68p27174.cloudfront.net/assets/home-74ac0007a6e42997f8210f80b99a203b.js](http://d3tf1w68p27174.cloudfront.net/assets/home-74ac0007a6e42997f8210f80b99a203b.js)

我检查了我的本地文件夹和 cdn 文件夹，它们都不包含这些文件。asset_sync 工作正常，因为我可以在我的 cdn 文件夹中看到其余的资产。

我知道这可能与资产管道有关，但我不知道它是什么。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-29T06:53:58.023

为确保您的所有资产都引用新资产主机，请确保您使用的是 Rails`AssetTagHelper`方法（如`image_tag`、`stylesheet_link_tag`、`favicon_link_tag`等）。

如果您在 CSS 中使用背景图像引用，则可以利用[多个资产预处理器](http://guides.rubyonrails.org/asset_pipeline.html#preprocessing)支持来确保它们也引用新资产宿主。

例如，要在“home.css”上启用多个资产预处理，您可以添加`.erb`扩展名，将其更改为“home.css.erb”。该文件将首先由 ERB 处理，然后是 CSS，这意味着您可以引用您的资产，如下例所示：

```
body {
    background: url(<%= asset_path 'bg.png' %>);
} 
```

您可以通过执行“home.css.scss.erb”之类的操作来更进一步。

有关更多信息，请参阅[此](http://guides.rubyonrails.org/asset_pipeline.html#css-and-erb)和[此](https://devcenter.heroku.com/articles/cdn-asset-host-rails31#asset-references-in-css--js)。

# ruby - 在 sinatra 中记录暂停消息

> ID：10826092
> 
> 赞同：2
> 
> 时间：2012-05-31T00:42:19.213
> 
> 标签：ruby, sinatra

我已经建立了一个接受 JSON 格式的 POST 消息的 sinatra Web 服务。它对传入的数据执行各种验证，如果有任何它调用的问题`halt 400, "You're doing it wrong"`或类似的东西，更详细地说明他们做错了什么。

错误消息（例如“你做错了”）可以很好地发送到客户端，但我也想让它们登录到服务器上，这样我就可以看到人们在哪里遇到了客户端实现的问题。有没有简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T00:57:18.503

检查[日志记录](http://www.sinatrarb.com/intro#Logging)和`Exception#backtrace`. 您可能需要执行类似`raise RuntimeError`（或其他错误）的操作，然后捕获错误并将结果发送`error.backtrace`到您的日志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T07:08:39.263

感谢 Carl Zulauf 为我指明了正确的方向。最后，我`halt 400, "message"`用对这个方法的调用替换了我所有的调用：

```
def invalid_request! message
  logger.info "Request rejected: #{message}\n#{caller(1).join "\n"}"
  halt 400, message
end 
```

# java - 使用插入排序、选择排序和合并排序进行排序

> ID：10826093
> 
> 赞同：2
> 
> 时间：2012-05-31T00:42:20.197
> 
> 标签：java, arrays, sorting, arraylist

现在我在高中 12 年级，正在学习 Java 编程课程。现在我明天要考试，我正在努力学习。该测试是一项实际测试，我必须获取原始数据或对象，并使用插入排序、选择排序和合并排序将它们排序为原始数据、数组或数组列表。现在我把它放在原始数据上。只是我很难将对象排序到数组和数组列表中。我对数组和数组列表进行了选择排序，所以它只是合并排序和插入排序，我遇到了很大的麻烦。我只是不明白该怎么做。

提前谢谢你的帮助。

为了简化问题，我想知道如何将这两个类转换为对名为 Circle 的对象进行排序

我在这里的第一段代码得到随机的圆圈，然后将它输入到我的另一个类中进行排序。我的最后一个代码块对其进行了排序。

```
package Merge_Sort_Objects_Array;
import java.util.Scanner;
import java.lang.Math;

public class TestSorts {
    public static void displayArray(int[] array){
        for (int i = 0; i < array.length; i++){
            System.out.print(array[i] + " ");
        }
            System.out.println("\n");
        }

        public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        int numItems;
        int[] test;

        System.out.print("Enter number of elements: ");
        numItems = input.nextInt();

        /* populate array with random integers */
        test = new int[numItems];
        for (int i=0; i < test.length; i++){
            test[i] = (int)(100 * Math.random());
        }
        System.out.println("Unsorted:");
        displayArray(test);

        mergesort.mergesort(test, 0, test.length - 1);

        System.out.println("Sorted: ");
        displayArray(test);
    }

}

  package Merge_Sort_Objects_Array;

    public class mergesort {

    /**
     * Merges two sorted portion of items array
     * pre: items[start.mid] is sorted.  items[mid+1.end] sorted.  start <= mid <= end
     * post: items[start.end] is sorted
     */

    private static void merge(int[] items, int start, int mid, int end){
            int[] temp = new int[items.length];
            int pos1 = start;
            int pos2 = mid + 1;
            int spot = start;

            while (!(pos1 > mid && pos2 > end)){
                if ((pos1 > mid) || ((pos2 <= end) &&(items[pos2] < items[pos1]))){
                    temp[spot] = items[pos2];
                    pos2 +=1;
                }else{
                    temp[spot] = items[pos1];
                    pos1 += 1;
                }
                spot += 1;
            }
            /* copy values from temp back to items */

            for (int i = start;  i <= end; i++){
                items[i] = temp[i];
            }
    }

    /**
     * mergesort items[start..end]
     * pre: start > 0, end > 0
     * post: items[start..end] is sorted low to high
     */
    public static void mergesort(int[] items, int start, int end){
        if (start < end){
            int mid = (start + end) / 2;
            mergesort(items, start, mid);
            mergesort(items, mid + 1, end);
            merge(items, start, mid, end);
        }
    }
} 
```

那个更好吗？

好的 Greg，这是更新后的 testSorts 类。现在我将它们全部更改为 Circle 而不是 int，但是我仍然在之前发现的那个错误。

```
public class TestSorts {
    public static void displayArray(Circle[] array){
        for (int i = 0; i < array.length; i++){
            System.out.print(array[i] + " ");
        }
            System.out.println("\n");
        }

        public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        int numItems;
        Circle[] test;

        System.out.print("Enter number of objects: ");
        numItems = input.nextInt();

        /* populate array with random integers */
        test = new Circle[numItems];
        for (int i=0; i < test.length; i++){
            test[i] = new Circle((int)(10 * Math.random() + 1));
        }
        System.out.println("Unsorted:");
        displayArray(test);

        mergesort.mergesort(test, 0, test.length - 1);

        System.out.println("Sorted: ");
        displayArray(test);
    }

} 
```

这有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:02:33.630

看起来您需要做两件基本的事情来修改现有的排序代码以处理`Circle`对象。

1.  更改类型`int`以键入`Circle`排序方法的数组类型（只是数组类型，而不是索引）。

2.  做一些有意义的事情来代替`items[pos2] < items[pos1]`（因为您不能将对象与 just 进行比较`<`）。也许对于你想按半径排序的圆圈，你可以这样做`items[pos2].getRadius() < items[pos1].getRadius()`。但这取决于你。

[随着您对泛型编程](https://en.wikipedia.org/wiki/Generics_in_Java)的了解越来越多，您会发现更好的方法来做到这一点，这样您现有的代码就可以应用于*任何*合适类型的对象，而无需在每次需要将其与新类型一起使用时对其进行修改。

# php - 如何使用此 jquery 函数关闭模式窗口？

> ID：10826094
> 
> 赞同：3
> 
> 时间：2012-05-31T00:42:30.087
> 
> 标签：php, javascript, jquery, html

下面是我拥有的关闭模式窗口的 Html 按钮和 javascript 函数：

```
<button type="button" id="close" onclick="return parent.closewindow();">Close</button>

function closewindow() {     
    $.modal.close(); 
    return false;
} 
```

现在上面的代码确实关闭了模态窗口，这很好。

但我想知道如何使用下面的这个函数和 html 按钮来编写代码：

```
<button type='button' class='add'>Add</button>

  $(document).on('click', '.add', function(){ 

        $.modal.close(); ;
        return true;
    }); 
```

上面的代码没有关闭模态窗口，这是为什么呢？顺便说一句，这两个代码都在同一页上。

我正在使用由 eric martin 开发的 simplemodal

更新：

以下是完整代码（QandATable2.php），但单击“添加”按钮时仍没有关闭模式窗口：

```
 $(document).ready(function(){
      $('.add').on('click', function(){ 
//close modal window when user clicks on "Add" button (not working)
           $.modal.close();
      });
 });

function plusbutton() { 
    // Display an external page using an iframe 
    var src = "previousquestions.php"; 
    $.modal('<iframe src="' + src + '" style="border:0;width:100%;height:100%;">');

//Opens modal window and displays an iframe which contains content from another php script
    return false;
} 

function closewindow() {     

    $.modal.close(); 
    return false;
//closes modal window when user clicks on "Close" button and this works fines
} 

...HTML

    <table id="plus" align="center">
    <tr>
    <th>
    <a onclick="return plusbutton();">
    <img src="Images/plussign.jpg" width="30" height="30" alt="Look Up Previous Question" class="plusimage" name="plusbuttonrow"/>
    </a>
    <span id="plussignmsg">(Click Plus Sign to look <br/> up Previous Questions)</span>
    </th>
    </tr>
    </table> 
```

下面是显示进入模式窗口的所有信息的完整代码（在 previousquestions.php 脚本中）。这包括“添加”和“关闭”按钮：

```
<div id="previouslink">
<button type="button" id="close" onclick="return parent.closewindow();">Close</button>      
</div>

<?php 

      $output = "";

        while ($questionrow = mysql_fetch_assoc($questionresult)) {
$output .= "
<table>
      <tr>
      <td id='addtd'><button type='button' class='add'>Add</button></td>
      </tr>";
        }
        $output .= "        </table>";

        echo $output;

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:23:06.167

根据我从评论中的记忆，您想在单击右侧`add`按钮时关闭模式`modal`？

```
 $(document).ready(function(){
      $('.add').on('click', function(){ 
           $.modal.close();
      });
 }); 
```

我做了你的第一个例子（在你的问题编辑之前）工作，看看这个**[JSFiddle](http://jsfiddle.net/ult_combo/cS66y/)**。

请注意显示/隐藏元素的顺序并将函数包装`$(document).ready()`在 DOM 中以防止在加载 DOM 之前执行代码。

如果您没有设法使您的页面与我的小提琴类似地工作，您应该从您的页面代码中发布更多内容，因为可能会导致插件无法正常工作（或切换到另一个模态插件）。

**编辑：**您正在使用`iframe`，这就是为什么您不能`iframe`直接从 ' 范围访问父窗口的定义函数的原因。您可以尝试使用`window.opener`访问父窗口的作用域函数，或者解决所有和任何窗口作用域问题：

代替

```
$.modal('<iframe src="' + src + '" style="border:0;width:100%;height:100%;">'); 
```

和

```
$.modal('<div id="modal" style="border:0;width:100%;height:100%;">');
$('#modal').load(src); 
```

这将通过 Ajax 将内容动态加载到 div，这是一种更好的方法，可以解决您面临的任何窗口范围问题。

要么，要么切换到支持将页面直接加载到它的模态插件，例如[colorbox](http://www.jacklmoore.com/colorbox)。

**编辑**

现在有了完整的代码，很容易找到解决方案，只需在 PHP 中添加按钮即可`onclick='parent.closewindow();'`：`add`

```
<td id='addtd'><button type='button' class='add' onclick='parent.closewindow();'>Add</button></td> 
```

这样，它将重新使用现有`closewindow`功能并丢弃按钮的`.on`绑定。`.add`:)

# jquery - 使用 Next/Prev 按钮在选项卡中导航的 Jquery 不会呈现地图和日历

> ID：10826104
> 
> 赞同：1
> 
> 时间：2012-05-31T00:45:38.817
> 
> 标签：jquery, jquery-ui

不久前，我遇到了将地图或日历放置在隐藏选项卡上的问题，当直接单击选项卡时，我终于设法使用调整大小或渲染功能解决了这个问题。它仍然工作正常。

我最近在我的选项卡中添加了下一个和上一个按钮，问题是当我使用这些按钮浏览选项卡时，地图或日历不会第一次呈现。但第二次渲染得很好。也就是说，当您再单击一个下一步以传递包含地图的选项卡，然后单击上一个按钮时，一切都很好。

有没有人遇到过同样的问题或知道如何解决这个问题？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:43:22.660

您可能希望将所有调整大小和渲染函数与 tabshow 的事件回调一起使用

显示选项卡时触发此事件。

[来自 Jquery UI 的代码示例](http://jqueryui.com/demos/tabs/#event-show)

```
Supply a callback function to handle the show event as an init option.
$( ".selector" ).tabs({
   show: function(event, ui) { ... 
     // Objects available in the function context:
ui.tab     // anchor element of the selected (clicked) tab
ui.panel   // element, that contains the selected/clicked tab contents
ui.index   // zero-based index of the selected (clicked) tab

    }
});

OR

Bind to the show event by type: tabsshow.
$( ".selector" ).bind( "tabsshow", function(event, ui) {
  ...

}); 
```

# javascript - 我应该如何在 Ruby 中编写 JavaScript 插件 API？

> ID：10826106
> 
> 赞同：0
> 
> 时间：2012-05-31T00:46:19.163
> 
> 标签：javascript, ruby, api, plugins

我正在用 Ruby 做一个项目，我希望能够用 JavaScript 为它编写插件，所以我正在为它开发一个 JavaScript API。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:48:46.747

我建议使用现有的 javascript 解释器，例如[`therubyracer`](https://github.com/cowboyd/therubyracer). 您可以评估插件代码并通过它与之交互。

# android - Android - 带按钮的 ListView

> ID：10826108
> 
> 赞同：0
> 
> 时间：2012-05-31T00:46:27.273
> 
> 标签：android, listview, button

我有一个 ListView，上面有几个按钮（宽度是 fill_parent）。该按钮包含左侧的图标和右侧的文本。问题是每当我将手指放在按钮上时，绿色背景只会覆盖文本的长度。有没有让绿色覆盖整个按钮？

假设这是文本视图中的一个按钮，其中@ 是图标，`text`是文本。

```
[@ text     ] 
```

当我在按钮上移动手指时，只有这么多被绿色覆盖：

```
[#####|     ] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:02:36.257

您不应该将其用作在按钮上实现图标/文本的手段。

尝试这样的事情：

```
<LinearLayout android:id="@+id/descriptiveName"
android:layout_width="wrap_content" 
android:layout_height="wrap_content"
android:orientation="horizontal" 
android:layout_gravity="center_horizontal" >

<ImageView android:id="@+id/btnIcon"
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content"
    android:src="@drawable/img" 
    android:layout_gravity="center_vertical"/>

<TextView android:id="@+id/btnText" 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" 
    android:text="text"
    android:textColor="#6B6B6B"/> 
```

以与按钮相同的方式获取对 LinearLayout 的引用，并且您也可以以相同的方式为其设置 onClick 侦听器。

您可以为 LinearLayout 添加背景并使其成为选择器，使其在视觉上看起来也像一个按钮。

# validation - ASP.NET MVC 2/3 验证属性 - 如果一个触发为假，其他是否短路？

> ID：10826109
> 
> 赞同：1
> 
> 时间：2012-05-31T00:46:32.357
> 
> 标签：validation, c#-4.0, asp.net-mvc-2, data-annotations, file-handling

我的问题的后续行动：[ASP.NET MVC 2 - 在编辑操作中处理文件；或者，是否可以创建一个“可选”数据注释来跳过其他属性？](https://stackoverflow.com/q/7212053/399584)

如果验证属性触发为假（例如，`Required`缺少字段），是否还会调用其他验证属性，或者它们是否会被跳过/短路？

我问是因为我有一个自定义文件验证属性，我只想在文件实际存在时应用。我正在使用 Simon Ince 的条件验证来`Required`根据我是否正在创建或编辑实体来切换字段，但我不确定是否可以根据第一个结果实际应用另一个属性。我的意思是，如果文件不存在，以下文件验证器可能会抛出异常：

```
public class ValidateFileAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        var file = value as HttpPostedFileBase;

        if (file == null)
        {
            return false;
        }

        string[] validExtensions = { "jpg", "jpeg", "gif", "png" };
        string[] validMimeTypes = { "image/jpeg", "image/pjepeg", "image/gif", "image/png" };

        string[] potentialFileExtensions = file.FileName.Split('.');
        string lastExtension = potentialFileExtensions[(potentialFileExtensions.Length - 1)];
        string mimeType = file.ContentType;

        bool extensionFlag = false;
        bool mimeFlag = false;

        foreach (string extension in validExtensions)
        {
            if (extension == lastExtension)
            {
                extensionFlag = true;
            }
        }

        foreach (string mt in validMimeTypes)
        {
            if (mt == mimeType)
            {
                mimeFlag = true;
            }
        }

        if (extensionFlag && mimeFlag)
        {
            return true;
        }
        else
        {
            return false;
        }
    }
} 
```

我不知道如何解决这个问题。这些文件可能存在也可能不存在，但如果存在，我想验证它们。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T03:56:11.090

除非您打算从自定义属性中重复使用，否则尝试将逻辑放入自定义属性中可能会使事情复杂化。您可以在控制器操作中（或在它调用的单独库中运行您的逻辑吗？）这样您就不必处理尝试链接属性的问题。

# ubuntu - /etc/hosts 中的 www 和子域

> ID：10826110
> 
> 赞同：3
> 
> 时间：2012-05-31T00:46:38.927
> 
> 标签：ubuntu, subdomain, hostname, hosts

我是第一次设置 Ubuntu，我想用它作为服务器来托管网站：

```
www.something.net
blah1.something.net
blah2.something.net 
```

我需要设置什么作为主机名？以及如何在 /etc/hosts 文件中进行设置？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:12:59.527

我认为机器主机名和您机器上的托管网站/域之间可能存在一些混淆。

要设置主机名，您可以使用该`hostname`命令。像下面这样的东西应该可以在 ubuntu 上运行。（您还必须修改您的 DNS 记录，以便`mycomputer.domain.com`解析到您的 IP）

`sudo hostname mycomputer.domain.com`

有关更多信息，请参见[主机名手册页](http://manpages.ubuntu.com/manpages/hardy/man1/hostname.1.html)。您还需要在`/etc/hostname`文件中进行这些更改，否则下次重新启动时主机名将变回。

要将域名指向`www.something.net`您机器上的某个页面，您需要编辑 something.net 的 DNS 记录，这些记录可以在机器本身本地维护，但您必须设置 DNS 服务器。您的 DNS 很可能`something.net`由您注册域的公司提供，在这种情况下，您只需更改 IP 地址`www.something.net`并`something.net`指向（通过他们的网站等）。然后设置一个网络服务器来响应/提供这些站点的页面。

您可能会在 ubuntu wiki 帮助中找到有关配置 Web 服务器的[ApacheMySQLPHP指南。](https://help.ubuntu.com/community/ApacheMySQLPHP)

/etc/hosts 除非您正在制作某种测试设置/内联网系统，否则不会真正参与其中。

希望这可以帮助。

# c++ - 指针转换，不能将 Two* 转换为 One*

> ID：10826115
> 
> 赞同：0
> 
> 时间：2012-05-31T00:47:43.877
> 
> 标签：c++, conversion-operator

假设我有两个班级，一和二。一和二本质上是一样的，但是二可以转换成一。

```
#ifndef _ONE_H_
#define _ONE_H_

class One
{
private:
    float m_x;
    float m_y;

public:
    One();
    One(float x, float y);
};

#endif
#ifndef _TWO_H_
#define _TWO_H_

#include "One.h"

class Two
{
private:
    float m_x;
    float m_y;

public:
    Two();
    Two(float x, float y);
    operator One() { return One(m_x, m_y); }
    operator One* () { return &One(m_x, m_y); }
    operator One& () const { return *this; }

    float GetX(void) { return m_x ;}
    float GetY(void) { return m_y ;}

    void Print();
};

#endif 
```

二可以访问一，但一无权访问二。在 main.cpp 我有：

```
One a(4.5f, 5.5f);

Two b(10.5, 7.5);

One * c = &b; 
```

如果我尝试将 One 的指针指向 Two 的地址，则会出现错误。错误是“错误 C2440：'正在初始化'：无法从 '两个 *' 转换为 '一个 *'”

如果可能的话，我终其一生都无法弄清楚如何做到这一点。任何帮助，将不胜感激。

编辑：在 Two.h 中添加了一个新行，带有`operator One& () const { return *this; }`. 我试图用来让这个转换运算符工作的函数是`void TestRefConstPrint(const One &testClass);`下面的 main，这会出现一个新错误，即“无法将参数 1 从二”转换为“常量一 &”。

我在里面做：

```
int main()
{
    Two b(10.5, 7.5);

    TestRefConstPrint(b);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:50:22.737

您的转换运算符启用转换`Two -> One`和`Two -> One*`. 您正在尝试执行不同的转换，`Two* -> One*`.

要使用`operator One()`转换运算符执行`Two -> One`转换，只需执行以下操作：

```
One c = b; 
```

* * *

如果您真的想进行`Two* -> One*`转换，可以使用显式转换：

```
One * c = (One *)&b; 
```

或使用 C++ 风格的演员表：

```
One * c = reinterpret_cast<One *>(&b); 
```

但是请注意，这不使用您的任何一个转换运算符，并且与转换做了非常不同的事情`Two -> One`：它不创建新对象，它创建一个指向对象`One`所占用内存的指针`Two`。这通常是一个坏主意，您不太可能想要这样做。

* * *

最后，关于您的评论`operator One*()`：它返回一个悬空指针（指向函数返回时超出范围的局部变量的指针）。我假设你写它是为了让`Two* -> One*`转换工作。您应该删除它，因为它不符合您的要求。

# objective-c - 带有背景图像的 UIScrollView

> ID：10826117
> 
> 赞同：6
> 
> 时间：2012-05-31T00:47:54.573
> 
> 标签：objective-c, ios, uiscrollview, uiimageview

我想在 UIScrollView 区域后面有一个背景图像。那部分很容易。我遇到的问题是我不希望图像移动。我希望它填满屏幕，然后滚动只是发生在上面而不影响图像。

我浏览了许多其他类似主题的帖子，但似乎没有任何工作。

当我执行以下操作时，背景会滚动：

```
CGRect fullScreenRect = [[UIScreen mainScreen] applicationFrame];
UISCrollView *scrollView = [[UIScrollView alloc] initWithFrame:fullScreenRect];
scrollView.backgroundColor = [UIColor clearColor];
UIImageView *bkg = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"img"]];
[scrollView addSubview:bkg]; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-31T00:50:10.847

将图像放在 UIImageView 中，并将其放在 UIScrollView 后面。将 UIScrollView 的颜色设置为 100% 透明度 ( `[UIColor clearColor]`)。

# javascript - 将 HTML5 地理坐标分配给 JavaScript 变量

> ID：10826121
> 
> 赞同：0
> 
> 时间：2012-05-31T00:48:27.573
> 
> 标签：javascript, html, geolocation

我正在尝试将全局变量分配给 JavaScript 中的 HTML5 地理位置坐标，并通过 jQuery 将这些变量传递给表单字段。

我遇到的问题是将 lat 和 long 分配给全局变量。我知道地理位置 api 是通过“navigator.geolocation”公开的，但在将这些值分配给全局变量时我必须遗漏一些东西。

这是我的尝试：

```
 var latitude = null;
function lat()
{
    if (navigator.geolocation)
    {
        latitude = position.coords.latitude;
    }
}

var longitude = null;
function lon()
{
    if (navigator.geolocation)
    {
        longitude = position.coords.latitude;
    }
} 
```

任何有助于消除错误的帮助将不胜感激。

编辑：试过这个。无法获取该值，但也不会导致 Firebug 错误：

```
 var latitude = navigator.geolocation.getCurrentPosition(function(position){
  lat = position.coords.latitude
  return lat
});

var longitude = navigator.geolocation.getCurrentPosition(function(position){
  lon = position.coords.longitude
return lon}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:53:27.993

..edit2：更新更有用的回调示例..

```
function requestCurrentPosition(){
        if (navigator.geolocation)
        {
        navigator.geolocation.getCurrentPosition(useGeoData);
        }
}

 function useGeoData(position){
    var longitude = position.coords.longitude;
    var latitude = position.coords.latitude;
    /*do stuff with long and lat here.*/
  } 
```

..编辑：更新示例...

```
var latitude = null;
function lat()
{
if (navigator.geolocation)
{
    navigator.geolocation.getCurrentPosition(
        function(position){
              latitude = position.coords.latitude;
        });
}
}

var longitude = null;
function lon()
{
if (navigator.geolocation)
{
    navigator.geolocation.getCurrentPosition(
        function(position){  
            longitude = position.coords.latitude;
        });
    }
}
} 
```

你可能想看看这个[HTML5 Demo](http://merged.ca/iphone/html5-geolocation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T00:54:25.780

更像这样的东西怎么样：

```
// Does this browser support geolocation?
if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(locationSuccess, locationError);
}
else{
    showError("Your browser doesn't support geolocation!");
}

// Now get user's location

function locationSuccess(position) {
    var lat = position.coords.latitude;
    var lon = position.coords.longitude;
} 
```

# android - 转换为 Dalvik 错误 1 的原因

> ID：10826122
> 
> 赞同：1
> 
> 时间：2012-05-31T00:48:38.847
> 
> 标签：android, dalvik

升级我的 Android SDK、Eclipse 和 Eclipse ADT 版本（一个漫长而痛苦的过程）后，导出失败并出现众所周知的*Conversion to dalvik format failed with error 1*弹出消息。我尝试了许多在 Internet 上发布的建议解决方案，但均无济于事。数量惊人的开发人员似乎遇到了这个问题，但在许多情况下追查原因仍然模糊不清。

我使用的是 Android SDK 工具版本 19、Eclipse ADT 版本 18。我没有使用 Proguard。我的应用程序依赖于单个库项目。我的应用程序所需的其他 jar 文件位于项目的 libs/ 目录中；[根据这篇处理依赖项](http://tools.android.com/recent/dealingwithdependenciesinandroidprojects)的文章，我没有将它们明确添加为 Java 构建路径中的库。

**“错误 1”究竟是什么意思 - 错误代码记录在哪里？**

Eclipse 没有显示任何指示“错误 1”发生原因的消息 - 我在控制台中看不到任何消息（例如，没有“IllegalArgumentException：已添加”），并且“问题”面板中没有任何明显的内容。除了“转换为 dalvik 失败”弹出窗口外，我看到的唯一其他错误指示​​器是在我的工作区 .metadata/.log 文件中：

```
!SUBENTRY 1 com.android.ide.eclipse.adt 4 0 2012-05-30 17:20:49.179
!MESSAGE Conversion to Dalvik format failed with error 1
!STACK 0
com.android.ide.eclipse.adt.internal.build.DexException: Conversion to Dalvik format failed with error 1
    at com.android.ide.eclipse.adt.internal.build.BuildHelper.executeDx(BuildHelper.java:713)
    at com.android.ide.eclipse.adt.internal.project.ExportHelper.exportReleaseApk(ExportHelper.java:251)
    at com.android.ide.eclipse.adt.internal.wizards.export.ExportWizard.doExport(ExportWizard.java:295)
    at com.android.ide.eclipse.adt.internal.wizards.export.ExportWizard.access$0(ExportWizard.java:232)
    at com.android.ide.eclipse.adt.internal.wizards.export.ExportWizard$1.run(ExportWizard.java:217)
    at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121) 
```

有人可以提供更多指导吗？

# ios - Facebook Social Discovery - 以编程方式发布到特定用户的墙上？

> ID：10826125
> 
> 赞同：0
> 
> 时间：2012-05-31T00:49:05.480
> 
> 标签：ios, facebook, facebook-graph-api

如何在特定人的 Facebook 墙上触发程序化帖子，使其看起来像这样（但用我的应用程序替换 GO TRY IT ON）：

![在此处输入图像描述](../Images/136a1a06db3f07296e4544036917dd69.png)

我不希望这成为一个面向世界的通用帖子。我希望这针对我指定的特定用户的墙。我想包含一个特定的消息。我已经为我的应用启用了社交发现（这意味着当我在 iPhone 上搜索 facebook 时可以看到我的应用，并且我可以在我的应用列表中看到它，这样我就可以点击该行并从 facebook 启动我的应用）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T10:22:58.527

看起来您想熟悉 Open Graph 的概念 -> [https://developers.facebook.com/docs/opengraph/](https://developers.facebook.com/docs/opengraph/)

*product*显然是在应用程序打开图形设置中定义的**对象，而***Suggest*是可以对产品进行的**操作。**

所以你在这张图片中向我们展示的不是一个普通*的帖子*，它是一个 Open Graph 动作的发布消息。但我不知道有任何简单的方法可以让这个出版物只对一个用户可见。一般可见性由用户在您的应用程序的身份验证对话框中设置。我不知道是否有办法进一步限制单个操作发布的可见性，可能是通过动态创建一个只有一个用户的好友列表或其他什么...</p>

# ruby-on-rails - Rails 3.2 Rack::Cache HTTP 标头和动作缓存

> ID：10826126
> 
> 赞同：3
> 
> 时间：2012-05-31T00:49:07.900
> 
> 标签：ruby-on-rails, caching, reverse-proxy, rack-cache

下午好，

我在尝试将 HTTP 缓存与 Rack::Cache 和动作缓存（在我的 Heroku 托管应用程序上）结合起来时遇到了一些问题。

单独使用它们，它似乎工作。启用动作缓存后，页面加载速度很快，日志会提示它正在缓存。通过控制器（eTag、last_modified 和 fresh_when）中的 HTTP 缓存，似乎设置了正确的标头。

但是，当我尝试将两者结合起来时，它似乎是动作缓存，但 HTTP 标头始终是 max_age: 0，must_revalidate。为什么是这样？难道我做错了什么？

例如，这是我的“home”操作中的代码：

```
class StaticPagesController < ApplicationController
  layout 'public'

  caches_action :about, :contact, ......, :home, .....

  ......

  def home
    last_modified = File.mtime("#{Rails.root}/app/views/static_pages/home.html.haml")
    fresh_when last_modified: last_modified , public: true, etag: last_modified
    expires_in 10.seconds, :public => true       
  end 
```

出于所有意图和目的，这应该有一个最大年龄为 10 的公共缓存控制标签，不是吗？

```
$ curl -I http://myapp-staging.herokuapp.com/

HTTP/1.1 200 OK
Cache-Control: max-age=0, private, must-revalidate
Content-Type: text/html; charset=utf-8
Date: Thu, 24 May 2012 06:50:45 GMT
Etag: "997dacac05aa4c73f5a6861c9f5a9db0"
Status: 200 OK
Vary: Accept-Encoding
X-Rack-Cache: stale, invalid
X-Request-Id: 078d86423f234da1ac41b418825618c2
X-Runtime: 0.005902
X-Ua-Compatible: IE=Edge,chrome=1
Connection: keep-alive 
```

配置信息：

```
# Use a different cache store in production
config.cache_store = :dalli_store

config.action_dispatch.rack_cache = {
  :verbose      => true,
  :metastore => "memcached://#{ENV['MEMCACHE_SERVERS']}",
  :entitystore => "memcached://#{ENV['MEMCACHE_SERVERS']}"#,
} 
```

在我看来，您应该能够使用动作缓存以及反向代理，对吗？我知道他们做的事情非常相似（如果页面发生变化，代理和动作缓存都将无效并需要重新生成），但我觉得我应该能够同时拥有两者。或者我应该摆脱一个？

**更新**

谢谢楼下的回答！它似乎工作。但是为了避免必须为每个控制器操作编写 set_XXX_cache_header 方法，您是否看到这不起作用的任何原因？

```
before_filter :set_http_cache_headers

.....

def set_http_cache_headers
  expires_in 10.seconds, :public => true
  last_modified = File.mtime("#{Rails.root}/app/views/static_pages/#{params[:action]}.html.haml")
  fresh_when last_modified: last_modified , public: true, etag: last_modified
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T19:08:32.550

使用动作缓存时，仅缓存响应正文和内容类型。对响应的任何其他更改都不会在后续请求中发生。

但是，即使动作本身被缓存，动作缓存也会运行任何之前的过滤器。

因此，您可以执行以下操作：

```
class StaticPagesController < ApplicationController
  layout 'public'

  before_filter :set_home_cache_headers, :only => [:home]

  caches_action :about, :contact, ......, :home, .....

  ......

  def set_home_cache_headers
    last_modified = File.mtime("#{Rails.root}/app/views/static_pages/home.html.haml")
    fresh_when last_modified: last_modified , public: true, etag: last_modified
    expires_in 10.seconds, public: true       
  end 
```

# mysql - 与 mysql 连接

> ID：10826132
> 
> 赞同：-3
> 
> 时间：2012-05-31T00:50:01.487
> 
> 标签：mysql

我们正在尝试使用 ajax 和 php 在 MySQL 数据库和 Google API 之间进行接口（在第 3 行“phpsqlajax_dbinfo.php”定义了数据库信息）。我们想用谷歌 API 的 lat/long 创建一个标记，但我们在“add(Child)”上收到致命错误实际错误消息：“Call to a member function addChild() on a non-object”

我们如何让数据库注册和存储信息？

```
<?php

require_once("phpsqlajax_dbinfo.php");

$xml = ("mapPointInfo.xml") ;

$newLatLng = $_POST['latlng'];      //new markers LatLng
$newLatLng = substr($newLatLng, 1, -1);  //removes first and last characters of
newLatLng which are ( and )

list($newLat, $newLng) = explode(",", $newLatLng);

//$newLng = substr($newLng, 1, 0);

$locName = $_POST['geoNameMarker'];     //geocoded or simple incremented site name
$markerComment = $_POST['createMarker'];    //comment entered by user
$userName = $_POST['user'];         //acquire username from session
$voteValue = "likes";       //acquire vote value if any
date_default_timezone_set('America/New_York');
$timeStamp = date("m/d/Y G:i");         //get timestamp   
year:month:date:hour:minutes:seconds (example: 11:6:31:14:31:42)

if($markerComment == null || $markerComment == '' || $markerComment == ' '){
$markerComment = ' ';
}

$markerComment = htmlentities($markerComment, ENT_QUOTES);
$locName = htmlentities($locName, ENT_QUOTES);

$marker = $xml->addChild('marker');
$marker->addAttribute('lat', $newLat); 
$marker->addAttribute('lng', $newLng);
$marker->addAttribute('name', $locName); 
$marker->addAttribute('type', 'user-sug');

$comment = $marker->addChild('comment', $markerComment);   //add information to
latest/last marker
$comment->addAttribute('user', $userName); 
$comment->addAttribute('vote', 'likes');
$comment->addAttribute('time', $timeStamp); 

header('P3P:CP="IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT"');
header ('http://www.wmuhotspotmap.org/');
exit();

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:14:16.430

致命错误？你得到**一个**致命的错误。它以前如何？我猜这与`$xml`字符串这一事实有关，但出于某种原因，您好像在做`$xml->addChild()`一个带有函数的对象。

# java - Spring 3.0 MVC，无法注册家庭控制器，404错误

> ID：10826137
> 
> 赞同：0
> 
> 时间：2012-05-31T00:50:44.430
> 
> 标签：java, spring, jakarta-ee, spring-mvc

我已经配置了 hibernate 和 Spring，没有任何错误，并且我的项目正在部署，但是我尝试通过控制器“HomeController”加载我的 Home.jsp，但我得到“错误：404 找不到资源……”：

* * *

我尝试了 3 种不同的方法：

**方法一（不是我理想的方法）。**

a) 在欢迎列表 (web.xml) 中定义一个 index.htm

b) 使用@Controller @RequestMethod 通过注解将 HomeController 映射到“/index.htm”

c) HomeController 返回视图“Home” (WEB-INF/views/Home.jsp)

* * *

用于所有 3 种方法的通用项目结构：

![在此处输入图像描述](../Images/ff45f94e49c565dc9dfcb2c217b8d0d0.png)

* * *

**Web.xml：**

```
<web-app metadata-complete="true" version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>yourmarketnet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>yourmarketnet</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout> 
            30 
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>index.htm</welcome-file>
    </welcome-file-list>
</web-app> 
```

**Yourmarketnet-spring.xml 片段：**

```
 <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"     
        p:prefix="/WEB-INF/views/" p:suffix=".jsp" p:viewClass="org.springframework.web.servlet.view.JstlView" /> 
```

**应用程序上下文.xml：**

```
<!-- Activates various annotations to be detected in bean classes --> 
    <context:annotation-config />
    <!-- Scans the classpath for annotated components that will be auto-registered as Spring beans.   For example @Controller and @Service. Make sure to set the correct base-package--> 
    <context:component-scan base-package="com.yourmarketnet.controller" />    
    <!-- Configures the annotation-driven Spring MVC Controller programming model.  Note that, with Spring 3.0, this tag works in Servlet MVC only!  --> 
    <mvc:annotation-driven/>
    <!-- mapping of static resources-->
    <mvc:resources mapping="/resources/**" location="/resources/" />
    <import resource="hibernate-context.xml" /> 
```

**家庭控制器类：**

```
package com.yourmarketnet.controller;
@Controller  
@RequestMapping("/index.htm") 
public class HomeController {  
    public String requestHandler()
    { 
        return "Home"; 
    } 
} 
```

**运行应用程序的结果：**

Http 状态 404

请求的资源 () 不可用。

* * *

**方法二，（不是我理想的方法）**

a) 创建 redirect.jsp ，并定义欢迎列表 (web.xml)

b) 使用@Controller @RequestMethod 通过注解将 HomeController 映射到“/HomeController”

c) 有 redirect.jsp “<% response.sendRedirect("/HomeController");%>” 到我的 HomeController

d) HomeController 返回视图“Home” (WEB-INF/views/Home.jsp)

**Web.xml：**

```
<web-app metadata-complete="true" version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>yourmarketnet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>yourmarketnet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout> 
            30 
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>redirect.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

**Yourmarketnet-spring.xml 片段：**

```
 <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"     
        p:prefix="/WEB-INF/views/" p:suffix=".jsp" p:viewClass="org.springframework.web.servlet.view.JstlView" />
 </beans> 
```

**applicationContext.xml 片段：**

```
<!-- Activates various annotations to be detected in bean classes --> 
    <context:annotation-config />
    <!-- Scans the classpath for annotated components that will be auto-registered as Spring beans.   For example @Controller and @Service. Make sure to set the correct base-package--> 
    <context:component-scan base-package="com.yourmarketnet.controller" />    
    <!-- Configures the annotation-driven Spring MVC Controller programming model.  Note that, with Spring 3.0, this tag works in Servlet MVC only!  --> 
    <mvc:annotation-driven/>
    <!-- mapping of static resources-->
    <mvc:resources mapping="/resources/**" location="/resources/" />
    <import resource="hibernate-context.xml" /> 
```

**家庭控制器类：**

```
package com.yourmarketnet.controller;
@Controller  
@RequestMapping("/HomeController") 
public class HomeController {  
    public String requestHandler()
    { 
        return "Home"; 
    } 
} 
```

**运行应用程序的结果：**

Http 状态 404 /HomeController

请求的资源 (/HomeController) 不可用。

* * *

**方法 3，（如果上述任何方法都可以，但这是我真正想要的）**

a) 从 web.xml 中删除所有欢迎文件标签

b) MapDispatcher 到“/”</p>

c) 使用 @Controller @RequestMethod' 通过注解将 HomeController 映射到“/HomeController”

d) HomeController 返回视图“Home” (WEB-INF/views/Home.jsp)

**Web.xml：**

```
<web-app metadata-complete="true" version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>yourmarketnet</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>yourmarketnet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout> 
            30 
        </session-timeout>
    </session-config>
</web-app> 
```

**Yourmarketnet-spring.xml 片段：**

```
 <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"     
        p:prefix="/WEB-INF/views/" p:suffix=".jsp" p:viewClass="org.springframework.web.servlet.view.JstlView" /> 
```

**applicationContext.xml 片段：**

```
<!-- Activates various annotations to be detected in bean classes --> 
    <context:annotation-config />
    <!-- Scans the classpath for annotated components that will be auto-registered as Spring beans.   For example @Controller and @Service. Make sure to set the correct base-package--> 
    <context:component-scan base-package="com.yourmarketnet.controller" />    
    <!-- Configures the annotation-driven Spring MVC Controller programming model.  Note that, with Spring 3.0, this tag works in Servlet MVC only!  --> 
    <mvc:annotation-driven/>
    <!-- mapping of static resources-->
    <mvc:resources mapping="/resources/**" location="/resources/" />
    <import resource="hibernate-context.xml" /> 
```

**家庭控制器类：**

```
package com.yourmarketnet.controller;
@Controller  
@RequestMapping("/") 
public class HomeController {

    public String requestHandler()
    { 
        return "Home"; 
    } 
} 
```

**阿帕奇服务器日志：**

警告：在名称为“yourmarketnet”的 DispatcherServlet 中找不到具有 URI [/yourmarketnet/] 的 HTTP 请求的映射

**运行应用程序的结果：**

Http 状态 404

请求的资源 () 不可用。

请为我提供正确的代码/标签，以便在没有 404 错误的情况下从 HomeController 服务我的 Home.jsp，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T05:13:08.743

我说的是您问题中的第三种方法。

在您的 web.xml 中，将请求映射更改为`/`而不是`*.htm`. 其他一切，如果只是完美的话，我可以在这里看到。所以这应该适合你。

希望这对您有所帮助。

干杯。

# java - Java WindowBuilder -> 导出为 .jar（可运行或 Applet）

> ID：10826141
> 
> 赞同：0
> 
> 时间：2012-05-31T00:51:18.523
> 
> 标签：java, swing, user-interface, jar, executable

我为 Eclipse 3.7 安装了 WindowBuilder 插件。

我用各种方法（JFrame、JPanel、Application 等）创建了一个非常简单的 GUI。我尝试将我的项目导出为可运行的 JAR / .jar 文件。我必须选择主类：它没有显示任何可供选择的内容！导出仍然有效，但文件无用。

如何正确导出我的 GUI 类？

编辑：似乎我需要一个主要方法来使该类显示在主类列表中。但问题是，WindowBuilder 创建了一个这样的类：

```
import javax.swing.JApplet;
import javax.swing.JButton;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

public class myGuiClass extends JApplet {

    /**
     * Create the applet.
     */
    public myGuiClass() {
        getContentPane().setLayout(null);

        JButton btnMybutton = new JButton("myButton");
        btnMybutton.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent arg0) {
                System.out.println("Button pressed!");
            }
        });
        btnMybutton.setBounds(10, 11, 91, 23);
        getContentPane().add(btnMybutton);

    }
} 
```

如果我在这里创建一个 main 方法，我将无法创建我的 JApplet，因为它不允许在静态 main 方法中引用其非静态构造函数。至少我不知道该怎么做。那么我将如何将这个非常简单的一类程序导出到可运行的 .jar 或小程序中呢？

@Andrew：“应用程序”是指 WindowBuilder-> Swing Designer 菜单中的选项之一。其实就是应用程序窗口，还有JApplet、JFrame、JDialog等。我想要一些可执行的东西，我可以带到另一台电脑上或通过网络运行，所以我不必用 cmd 窗口处理粗略的执行事情......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T19:04:29.233

Try this, this is the way to create a jar or runnable jar in eclipse, all your external libraries in the project will be included

```
File -> Export-> Java ->Runnbale JAR file

Launch configuration : your Class containing the public static void main(String[] args)

Export destination : Target place

Library Handling:

Package required libraries into generated JAR

FINISH 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T18:36:37.247

试试这个代码 - 作为小程序或自由浮动（基于框架）应用程序工作。

```
import java.awt.FlowLayout;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.border.EmptyBorder;

/** This is an hybrid application/applet.  It can be run
 * as either a JFrame or JApplet. */
public class MyGuiApp extends JApplet {

    /** Construct the GUI for an applet. */
    public void init() {
        try {
            SwingUtilities.invokeAndWait( new Runnable() {
                public void run() {
                    GUI gui = new GUI();
                    getContentPane().add(gui.getGui());
                }
            });
        } catch(Exception e) {
            e.printStackTrace();
        }
    }

    /** Launch the GUI in a frame. */
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable(){
            @Override 
            public void run() {
                JFrame f = new JFrame("My GUI");
                f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                GUI gui = new GUI();
                f.getContentPane().add(gui.getGui());
                f.pack();
                f.setLocationByPlatform(true);
                f.setVisible(true);
            }
        });
    }
}

class GUI {

    public JComponent getGui() {
        // Use layouts! ..
        JPanel p = new JPanel(new FlowLayout(FlowLayout.LEADING));
        // ..possibly with borders.
        p.setBorder(new EmptyBorder(10,10,10,10));

        JButton btnMybutton = new JButton("myButton");
        btnMybutton.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent arg0) {
                System.out.println("Button pressed!");
            }
        });
        p.add(btnMybutton);
        return p;
    }
} 
```

# c - 逐行读取文件增加内存？

> ID：10826142
> 
> 赞同：2
> 
> 时间：2012-05-31T00:51:37.550
> 
> 标签：c

我是 c 的新手。我有一些代码试图在 Cuda 中测试，但在提取数据时遇到了一些麻烦。我的数据位于一个文件（19GB）中，我基本上计划读取一定数量的行，将它们保存到一个列表中，发送他们对整个文件进行处理并再次执行此操作。

我刚开始学习如何做到这一点并且遇到了我不确定的 C 问题，当我运行程序时，我的内存不断增加（当我在我的 mac 上访问活动监视器时），但它是似乎与 c 程序无关，它只是显示非活动内存不断增长。即使在程序停止后，内存仍然处于非活动状态（恢复它的唯一方法是重新启动）。据我所知，它不会影响程序，但看起来很奇怪，我很想知道为什么以及是否/我能做些什么？

我对 malloc 和 free 有一点了解（对不起，我更了解 Java/Python 并且从来不必这样做）但我不确定我是否应该在这段代码中这样做，因为我认为`line`变量不断被覆盖。

这是代码：

```
int main() {
    printf("Starting..");
    char line[1024];
    FILE *fp = fopen("output.txt","r");

    if( fp == NULL ) {
        return 1;
    }
    int count = 0;
    while( fgets(line,1024,fp) ) {
        //printf("%s\n",line);
        count++;
    }
    printf(" num of lines is %i \n", count);

    return 0;
} 
```

我很感激关于这里发生了什么的任何提示/建议，以及是否有更好的方法来做到这一点？

更新：对不起，我没有提到，我注意到的行为是在程序运行时。当它运行时，不活动的内存只会不断增长。我有大约 4 个免费演出，30 秒后它全部满了，重新启动是释放它的唯一方法（即使 c 程序被杀死，内存也没有被释放）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T00:53:12.810

您的代码不分配任何内存（`FILE`结构除外），因此您没有任何取决于文件大小的泄漏。

但是，您*确实*`fclose(fp);`会泄漏一些内存，因为您在访问完文件后忘记了。

作为建议，如果您使用的是 linux，请使用`valgrind --leak-check=full ./yourapp`- 假设您的程序是使用调试符号（`-g`gcc 中的开关）编译的，您将获得详细的泄漏报告，准确显示您的程序是否/在何处泄漏内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T01:03:11.553

这是完全正常的。释放内存需要付出努力。这种努力完全浪费了，因为一旦需要内存，系统只需将其从空闲池中删除即可。直接将内存从一种用途转移到另一种用途会更有效。所以这个系统是聪明的而不是愚蠢的。

这不像今天使用一半的内存，明天可以使用两倍的内存。所以释放内存没有任何好处。

当您从文件中读取行时，操作系统会从文件中读取整个块。如果可能，它会尝试将这些块保存在内存中，因为这样可以避免将来必须从磁盘读取。如果它没有更好的用途来存放内存，它会将这些文件块保存在内存中。这既节省了必须释放内存以再次使用内存的工作，又加快了以后对同一文件块的访问。

释放此内存没有任何好处。只是需要操作系统方面的努力才能使其免费，操作系统方面的努力才能使其将来再次使用，并且操作系统会失去避免磁盘读取的机会。因此，释放内存将是完全愚蠢的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T01:21:39.693

这是因为你使用

```
 fgets(buffer, int size, file); 
```

which will only stop reading if you hit EOF. Theres 2 ways of fixing it, either use

```
 while(fgets(buffer, size, file) != EOF){}; 
```

or

```
 while(fread(buffer, sizeof(char), nmem, file) < 1024){}; 
```

I recommend using the latter, for some reason I tend to run into issues using fgets, and you have more control of what your doing with fread.

# ruby-on-rails - 存储用户对颜色选择、导轨的偏好的适当方式

> ID：10826144
> 
> 赞同：1
> 
> 时间：2012-05-31T00:51:58.157
> 
> 标签：ruby-on-rails, database, background-color

我想知道存储用户颜色偏好的合适方法是什么。即假设允许用户根据对象类型选择新闻源的背景颜色。即，如果是图像，则背景为蓝色，如果是帖子，则为橙色等。

一个人应该怎么做呢？我能够区分我认为的所有不同类型。我目前有一个@feeds_item 集合列表，我渲染每个对象。然后我有一些类似的东西..

```
<% if feed_item.is_a? Post %>
    #render specific view 
```

我正在考虑根据用户选择的内容设置颜色。但我应该怎么做呢？我应该将用户的颜色偏好保存在用户模型中，还是在帖子模型中？图像模型？

在我对 Post 对象的偏爱中，我有...

```
<li id="<%= feed_item.id %>">

  <%= link_to image_tag(feed_item.user.image_url(:thumb), :class => "image_avatar"), 
    feed_item.user %>

  <span class="user">
    <%= link_to feed_item.user.name, feed_item.user %>
  </span>
  <span class="content"><%= wrap(feed_item.content) %></span>
  <span class="timestamp">
    Posted <%= time_ago_in_words(feed_item.created_at) %> ago.
  </span>

  <% if current_user == feed_item.user %>
    <%= link_to "delete", feed_item, method: :delete, confirm: "You sure?", title: feed_item.content %>
    <% end %>
</li> 
```

除了可能将 < li > 标签更改为...

```
<li id="<%= feed_item.id %>" style="background-color=#{ ????? }"> 
```

在哪里 ？？？？将是数据库中的一列？这是做这件事的正确方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T03:22:31.797

1.  您应该将首选项保存在它所属的模型中。如果所有偏好都属于用户，则将其保存在用户模型中。
2.  声明样式的方式是：

    `<li id="<%= feed_item.id %>" style="background-color:<%= feed_item.user.this_color %>">`

3.  考虑将其移至视图助手，以便您的视图可以保持简单。

# java - 基于套接字的 PrintWriter 不会在 close() 之后刷新

> ID：10826147
> 
> 赞同：0
> 
> 时间：2012-05-31T00:52:08.307
> 
> 标签：java, sockets, flush, printwriter

我正在编写一个服务器-客户端应用程序。

问题是，在我关闭打印写入器之后，服务器中的`PrintWriter`某个时间点后不会刷新。但是如果我关闭打印编写器，它也会关闭套接字，但是我需要稍后使用它。

我该如何解决这个问题？

```
pw = new PrintStream(socket.getOutputStream());
pw.println("igyulibigyuli");
pw.flush(); 
```

它不会刷新，只要我在刷新后关闭打印机。（或者如果我关闭程序！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T14:19:31.807

问题是套接字正忙于读取（在一个while循环中，直到它不为空）。

# javascript - 发送javascript函数参数onChange

> ID：10826154
> 
> 赞同：0
> 
> 时间：2012-05-31T00:52:49.943
> 
> 标签：javascript, ajax

好的，我已经为此苦苦挣扎了几个小时。我正在使用 ajax 使用 php 代码更新我网站中的 div 但是，我正在尝试从外部 javascript 文件中发送函数中的参数以更新正确的链接（有多个下拉框）

例如：这是我的选择框

```
<script type='text/javascript' src='ajax.js'></script>//include ajax file
<select onchange='MakeRequest(raceupdate);
        this.options[this.selectedIndex].value;'> //so no use of a button is needed to auto link to anchor tag
        <option>Deathmateched</option>
    <?php
        dmList()
        ?>

 </select> 
```

然后接下来是我的外部 ajax 函数 MakeRequest()。

```
function MakeRequest(value)
{
    var linkInfo = "teleport.php?call=" + value;//create appropriate link depending on function parameters  
    var xmlHttp = getXMLHttp();

    xmlHttp.onreadystatechange = function()
    {
        if(xmlHttp.readyState == 4)
        {
            HandleResponse(xmlHttp.responseText);
        }
    }     

    xmlHttp.open("GET", linkInfo, true); //update page using link info variable created above
    xmlHttp.send(null);

} 
```

如您所见，我正在尝试将一串文本传递给此函数，但我似乎在某个地方失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:07:20.900

您可能希望设置您的标签以传递“this”。我看不到你的raceupdate 变量是在哪里声明的，除非它是全局的……在这种情况下，你应该向我们展示你在用那个变量做什么。

```
<select onchange='MakeRequest(this);'> 
    <option>Deathmateched</option>
    <?php
        dmList();
    ?> 
```

如果你这样做，你必须改变这个功能：

```
 function MakeRequest(element)
    {
    var linkInfo = "teleport.php?call=" + element.value;//create appropriate link depending on function parameters  
    var xmlHttp = getXMLHttp();

    xmlHttp.onreadystatechange = function()
    {
        if(xmlHttp.readyState == 4)
        {
            HandleResponse(xmlHttp.responseText);
        }
    }     

    xmlHttp.open("GET", linkInfo, true); //update page using link info variable created above
    xmlHttp.send(null);

} 
```

你想在这里做什么？

```
this.options[this.selectedIndex].value; 
```

在您的评论中，您似乎是在说要跳转到锚标记？如果是这样，那么你会想做类似的事情

```
var anchorTag = document.getElementID("YOUR_ANCHOR_TAG_ID");
anchorTag.focus(); 
```

# java - @ElementCollection 计数频率

> ID：10826156
> 
> 赞同：2
> 
> 时间：2012-05-31T00:53:13.057
> 
> 标签：java, hibernate, jpa, jpql

我有一个这样声明的“标签”属性：

```
@Entity
public class BlogArticle
{
    [...]
    @ElementCollection(fetch = FetchType.EAGER)
    Set<String> tags =new HashSet<String>();
    [...]
} 
```

此属性表示与文章关联的标签。现在我想生成一个标签云。所以我想计算每个标签的频率。

有没有一种简单的方法可以做到这一点？（不创建 Tag 对象？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T05:45:04.783

```
String hql = "select t, count(1) from BlogArticle a inner join a.tags t group by t";
List tagCounts = createQuery( hql ).list();

Iterator itr = tagCounts.iterator();
while ( itr.hasNext() ) {
    Object[] tagCount = (Object[]) itr.next();
    String tag = (String) tagCount[0];
    Long count = (Long) tagCount[1];
} 
```

# callback - Simperium 存储桶可以有多个相同类型的回调吗

> ID：10826162
> 
> 赞同：1
> 
> 时间：2012-05-31T00:54:11.770
> 
> 标签：callback, simperium

我正在使用 Simperium（JS，在客户端），并且我遇到了需要注册多个`ready`处理程序的情况：一个将我存储数据的容器标记为已完成加载（因此我可以将其显示给用户)，另一个检查当前活动的路由是否与我们刚刚加载的对象之一匹配，如果是，则重新运行路由处理程序。

问题是，使用 bucket.on(signal, handler) 似乎用第二个覆盖了第一个应用的处理程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T05:54:31.700

目前仅支持单个处理程序。不过，我们欢迎对此提供任何反馈。

# facebook - facebook注册小部件加载栏在小部件加载后继续显示

> ID：10826171
> 
> 赞同：1
> 
> 时间：2012-05-31T00:55:26.037
> 
> 标签：facebook, loading, registration

我正在使用我们网站上的 FB 注册小部件。

我们的网站允许人们通过注册 CNAME 来自定义他们在我们网站上的页面的 url，因此可以像这样访问页面：

www.example.com/foo 或 foo.mysite.com/

当我嵌入 Facebook 注册小部件并通过规范域 (www.example.com) 访问它时：

1.  蓝色的 Facebook 加载进度条出现 [] [] [] ... 几秒钟，然后...
2.  注册小部件出现

这是意料之中的——一切都很好。

我在控制台中看到一条消息：

```
The "fb-root" div has not been created, auto-creating  all.js (line 30) 
```

但这是唯一的奇怪之处。

example.com 在我的 FB 应用程序中被定义为“应用程序域”（example.com），并且在“Site Url”字段中的“Website with Facebook Login”下，它设置为[http://www.example.com](http://www.example.com)。

当小部件嵌入到 foo.mysite.com 时，就会出现问题。FB 应用程序设置与上述相同。行为与上面提到的几乎相同，除了在第 2 步（出现注册小部件）之后，您仍然可以在后台看到加载进度条。

和以前一样，我仍然在控制台中收到此消息：

```
The "fb-root" div has not been created, auto-creating  all.js (line 30) 
```

不管这个“幻影”加载栏动画如何，小部件本身工作正常，它从 Facebook 正确提取数据，redirect-uri 工作正常（单击时它按预期发布到 redirect-uri，并带有有效的签名数据）。

任何想法是什么导致了这个以及如何解决它？

顺便提一句，

```
<script src="http://connect.facebook.net/en_US/all.js#appId=xxxxx&xfbml=1"> 
```

和

```
<fb:registration fields="name,email" redirect-uri=http://foo.mysite.com/fb_registration?origin=http://foo.mysite.com/stuff&id=42cc fb_only="false" width="300">    </fb:registration> 
```

当这些问题发生时（工作正常或不正确），是唯一起作用的代码。

更新：

跑步

```
$(".FB_Loader").hide() 
```

“修复”问题。但是，如果有人知道可能会发生什么样的跨域内容会导致此错误，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T14:47:02.060

以下消息：

```
The "fb-root" div has not been created, auto-creating  all.js (line 30) 
```

无关紧要。JS SDK 需要这个*div*，但如果它不存在，它会自动创建。

# mysql - Mysql语句中Group By内的顺序

> ID：10826176
> 
> 赞同：2
> 
> 时间：2012-05-31T00:55:45.837
> 
> 标签：mysql

我有一个具有以下结构的表...

```
--------------------------------
id | state_abbr | poll_date
1       GA         2010-01-01
2       GA         2011-01-01
3       NC         2011-02-01
------------------------------- 
```

我需要一个查询来返回每个州的最新 poll_date。我正在使用 group by，但我不知道如何在其中订购以恢复最新的 poll_date。它只是带回每个状态的第一个 poll_date。所以 GA 将是 2010-01-01 并且 NC 将是 2011-02-01 并且 order by 然后将对这些值进行排序。我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:24:03.370

怎么样

```
SELECT id, state_abr, poll_date FROM <yourTableName> t INNER JOIN (SELECT MAX(poll_date) max_date, id, state_abbr FROM <yourTableName> GROUP BY state_abr) p ON t.state_abbr = p.state_abbr && t.poll_date = p.max_date; 
```

由于您不能对超过 1 个事物进行分组，因此您可以通过这种方式执行分组，收集聚合最大日期，然后使用该数据选择最终对应的行。

编辑：删除了 DISTINCT ROW 大脑失误，抱歉，这是我迟到的结果。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:34:07.250

mysql功夫来拯救：

```
select * from
(select * from polls order by state_abr, poll_date desc) x
group by state_abr 
```

尽管它看起来很精神，但即使它在其他数据库中甚至不是有效的 SQL，它也是有效的。

mysql具有特殊的功能，它允许`group by` *不*按列聚合非分组，在这种情况下，它返回指定组遇到的*第一行。*

如果您从对行进行排序的内部查询中进行选择，以便每个组中您想要的行是第一个，您只需在相关列上添加一个分组依据。

# cocos2d-iphone - cocos2d中使用彩色图像作为粒子图像（使用粒子设计器）

> ID：10826178
> 
> 赞同：0
> 
> 时间：2012-05-31T00:56:01.297
> 
> 标签：cocos2d-iphone, particles

我想在 cocos2d 中使用全彩色 PNG 图像作为粒子，并在 ParticleDesigner 中设计发射器。

我拖入了我想使用的图像，并在 ParticleDesigner 中设置了我想要的一切，它看起来不错。

问题是当我导入 cocos2d 时，粒子上似乎有灰色方块（一小部分黄色图像在侧面可见，但它们灰色覆盖了包括透明区域在内的其余部分）。

代码：

```
CCParticleSystemQuad* particleSystem = [CCParticleSystemQuad particleWithFile:@"coin magnet.plist"];
particleSystem.position = ccp(320, 320-16);
[self addChild:particleSystem z:1000]; 
```

我猜这可能是混合选项的问题......

我尝试了 GL_SRC_ALPHA 到 GL_SRC_MINUS_ALPHA（由 ParticleDesigner 中的普通按钮设置）、加法组合，并尝试使用 GL_ZERO 和 GL_ONE 进行不同的操作

为什么颗粒呈灰色？cocos2d 是否支持使用全彩色图像作为粒子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T00:45:54.587

弄清楚了！

原来图像没有正确嵌入到 plist 中（ParticleDesigner 中的错误），所以这就是它显示为灰色的原因。

使用 png 单独导出解决了这个问题。

是的，你绝对可以在 cocos2d 中使用彩色图像作为粒子！

# java - Java 集中的重复值

> ID：10826179
> 
> 赞同：0
> 
> 时间：2012-05-31T00:56:24.983
> 
> 标签：java, collections, set

Java Set 不能有重复的值。这是我的代码：

```
Set<String> set = new HashSet<String>();
Collections.addAll(set, arr); 
```

如果数组 arr 具有相同值的元素，则 set 将具有重复的字符串值，为什么会发生这种情况？

我错过了哪里？我应该迭代数组并使用 add 方法吗？

==================================================== ===========

对不起，上面的代码有效。我在数组 arr 中犯了一个错误。这是一个空白的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T01:13:13.083

当我运行以下代码时，它表明该集合不包含重复项：

```
class FunkTest
{
    public static void main (String [] args)
    {
        Set<String> theHash = new HashSet<String>(); 

        String[] theArray = new String[] {
            "funky",
            "garbage",
            "funky",
            "stuff",
            "things",
            "item",
            "funky",
            "funky"
        };

        Collections.addAll(theHash, theArray);

        for (String thisItem : theHash) {
            System.out.println(thisItem);
        }
    }
} 
```

输出：

```
stuff 
funky 
item 
things 
garbage 
```

你的琴弦一定有什么不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:02:03.223

很可能这些对象实际上并不相等，因此它们不是同一个对象。如果您查看[java.util.HashSet.add()](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html#add%28E%29)的 javadocs ，您会看到用于确定对象是否已经存在的比较使用 .equals()。确保你的 2 个字符串没有任何不同会使 String.equals() 返回 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T01:04:29.903

我看不出这是怎么发生的，因为您使用的是正确实现 equals 的字符串。

以下代码为两个数组打印“1”。你确定你没有犯错吗？

```
import java.util.Set;
import java.util.HashSet;
import java.util.Collections;
class Main
{
    public static void main(String[] args)
    {
        String[] arr1 = new String[]{"one","one"};
        Set<String> set1 = new HashSet<String>();
        Collections.addAll(set1, arr1);
        System.out.println(set1.size());

        String[] arr2 = new String[]{"two",new String("two")};
        Set<String> set2 = new HashSet<String>();
        Collections.addAll(set2, arr2);
        System.out.println(set2.size());
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T01:15:48.647

你误会了。A`Set`永远不会包含重复项。不，您不需要迭代和使用该`add`方法。

回去再看看。什么值是重复的？如果将数组添加到 a 会发生什么`List<String>`？

# javascript - 在 d3.js 中，为空数据跳过 append()

> ID：10826180
> 
> 赞同：17
> 
> 时间：2012-05-31T00:56:37.313
> 
> 标签：javascript, d3.js

我正在用小圆形项目符号绘制折线图。但是，数据中有漏洞，在我的数组中由 null 表示。自然，没有数据的地方就不应该有圈子。但是 d3 的 append() 方法还是会添加它们。我该如何避免这种情况？

这是一个[jsFiddle 模型](http://jsfiddle.net/WxS4a/58/)，准确地再现了我的问题。

我对不在我的图表的 X 轴上的那一系列圆圈感兴趣，因为这些都是空值。

来自 jsfiddle 链接的相关代码：

```
svg.selectAll('circle').data(values).enter()
  .append('circle')// <-- I don't want to do this for null's
  .attr('fill', '#c00')
  .attr('r', 3)
  .attr('cx', xi)
  .attr('cy', yFlipped) 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-05-31T05:42:31.987

一种选择是以不同的方式表示您的数据，这样您就不必依赖索引来计算 x 坐标。例如，如果您将每个数据表示为一个对象（例如`{x: 0, y: 0.2840042}`），那么您可以将 x 坐标计算为`x(d.x)`而不是`x(i)`。

另一种选择是在值为 null 时将半径设置为零，因此圆圈被隐藏：`circle.attr("r", function(d) { return d == null ? 0 : 3; })`。或者，您可以隐藏圆圈：`circle.style("display", function(d) { return d == null ? "none" : null; })`.

您还可以在添加空元素后删除它们：`circle.filter(function(d) { return d == null; }).remove()`. 这适用于初始创建，但我不推荐它，因为如果您稍后重新选择元素，索引会发生变化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-25T19:40:20.363

最简单的选择是从传入的数据中过滤掉空值`.data(…)`，扩充数据以维护索引：

```
svg.selectAll('circle')
  .data(values
    .map(function(v, idx) { return v == null? null : { idx: idx, value: v })
    .filter(function(v) { return v != null })
  )
  .enter()
    .append('circle')
    .attr('fill', '#c00')
    .attr('r', 3)
    .attr('cx', function(d) { return d.idx * 10 }) // or whatever
    .attr('cy', function(d) { return d.value.y }) // or whatever 
```

请注意，您也可以遵循此模式的单个子元素，即使它们不是自然列表。例如，考虑您想要有条件地添加第二个圆圈的情况：

```
var circles = [
    { color: 'red', cx: 30, cy: 30, subCircleColor: 'blue' },
    { color: 'blue', cx: 60, cy: 60, subCircleColor: 'green' },
    { color: 'green', cx: 90, cy: 90 },
];

// Create a group which will hold the circles, since the result will
// be:
//    <g class="circles">
//      <circle color="{{ color }}" ... />
//      <circle class="sub-circle" color="{{ subCircleColor }}" ... />
//    </g>
var circlesGroups = svg.selectAll("g.circles")
    .data(circles)
    .enter()
        .append("g").attr({"class": "circles"})

// Add the first circle to the group
circlesGroups
    .append("circle").attr({
        "fill": function(d) { return d.color },
        "r": 20,
        "cx": function(d) { return d.cx },
        "cy": function(d) { return d.cy },
    })

// If there is a subCircleColor, add the second circle to the group
circlesGroups.selectAll("circle.sub-circle")
    .data(function(d) {
        if (d.subCircleColor)
            return [d];
        return [];
    })
    .enter()
        .append("circle").attr({
            "class": "sub-circle",
            "fill": function(d) { return d.subCircleColor; },
            "r": 10,
            "cx": function(d) { return d.cx },
            "cy": function(d) { return d.cy },
        }) 
```

小提琴：http: [//jsfiddle.net/3d6e648k/](http://jsfiddle.net/3d6e648k/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-22T21:10:06.673

试试这个模式，它可以删除或隐藏你的圈子。

```
// Step 1: hides all circles which are "null"
d3.selectAll(".yourItem")
.data(data)
.enter()
    .append("circle")
    .attr("visibility", function(d,i){
        if(yourFunction(d) == null) return "hidden";
})

// Step 2: optional, deletes all circles which are "hidden"
d3.selectAll("circle[visibility=hidden]").remove(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-30T19:28:33.620

如果您不想一开始就附加它，这是一种方法。我在 .each() 中使用了 if 语句，然后使用 d3.select(this) 将其附加到当前项目。

```
var data = [9, 0, 7, 0, 5, 0, 3, 0, 1];

var svg = d3.select('#svg').append('svg').attr({'viewBox': '-10 -10 99 20'});

svg.selectAll('g').data(data).enter().append('g').each(function (d,i) {
 if(d){
  d3.select(this).append('circle').attr({r:5,cx:(i*9)});
 }else{
  d3.select(this).remove();
 }
}); 
```

这是一个 bin [http://jsbin.com/qojifug/edit?js,output](http://jsbin.com/qojifug/edit?js,output)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T02:12:48.293

只是过滤它。

```
values.filter(function(el){return el !== null;}) 
```

# c# - C# 和 SQL 选择

> ID：10826181
> 
> 赞同：1
> 
> 时间：2012-05-31T00:56:45.633
> 
> 标签：c#

目前我正在做一个关于 C# 和 SQL 的项目，我遇到了关于 SELECT 函数的问题，我在网上找不到任何解决方案。

该方案是关于通过 SQL 服务器从 C# 搜索查询并将结果显示在 C# 的数据网格视图中。

我正在使用 Visual Studio 2008 和 SQL Server Studio 2008。

在开始这个项目之前，我刚刚从 Visual Studio 做了一个快速的 Windows 表单，然后做了一个 datagridview、2 个文本框和一个搜索按钮。

在 SQL Server 中，我有一个带有表格 DVD 的数据库，我想从这个带有 DVD ID 和名称的 Windows 表单中进行搜索。

我从 DVD ID 开始并实现了以下代码：

```
private void btnView_Click(object sender, EventArgs e)
{
   SqlConnection c = new SqlConnection(@"Data Source=GILBERTB-PC\SQLEXPRESS;Initial Catalog=DVDandGameBooking;Integrated Security=True"); 

   DataTable t = new DataTable();

   string sqlString = "SELECT * From DVD where Id ='" + txtID.Text+ "'";

   SqlDataAdapter dt = new SqlDataAdapter(sqlString, c);        
   dt.Fill(t);

   dtgv1.DataSource = t;
} 
```

它奏效了:)

然后我将代码更改为

```
string sqlString = "SELECT * From DVD where Name ='" + txtName.Text+ "'"; 
```

这样我就可以使用 DVD 的名称进行搜索，**但是**当我启动程序并使用名称进行搜索时，它只显示了一个空白数据库

还有什么方法可以更改代码，以便我可以使用 ID 或名称进行搜索？

感谢您的帮助和时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:08:03.363

想法：

1.  确保 txtName.Text 有一个值
2.  尝试使用 Enterprise Manager、Toad 或其他一些查询工具进行 SQL 选择。你得到了什么？
3.  尝试使用 LIKE 作为下面的示例
4.  最坏的情况，也许检查表的排序规则，也许它设置为“区分大小写”的文本匹配。

ID和姓名：

```
SELECT * FROM DVD
      WHERE Id=[ID Value]
      OR Name LIKE '%[Name Value]%' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:06:26.303

或者您可以使用带有如下参数的 SQLCommand：

```
SqlConnection c = new SqlConnection(@"Data Source=GILBERTB-PC\SQLEXPRESS;Initial Catalog=DVDandGameBooking;Integrated Security=True");
string queryString = "SELECT * From DVD where Id = @id";
var paramId = new SqlParameter("id", SqlDbType.VarChar);
var query = new SqlCommand(queryString, c);
query.Parameters.Add(paramId); 
```

如果你真的想使用 SQLDataAdapter，你可以将 select 命令设置为我上面写的那个。否则，您可以使用 dataReader 并遍历结果。

此外，使用这样的参数可以使您的查询更易于阅读，并使 SQL 注入更安全。应该始终考虑它。

Edit1：如果您想使用 Id 或 Name 进行搜索，您可以只制作 2 个参数，并`OR`在 2 之间放置一个，并且可能使用关键字`like`而不是`=`在您的查询中。如果值可以是`null`，您可能希望动态构建查询，具体取决于不是 的值`null`。

# ruby-on-rails - 尝试启动 Rails 服务器时出现语法错误

> ID：10826183
> 
> 赞同：4
> 
> 时间：2012-05-31T00:57:17.427
> 
> 标签：ruby-on-rails, ruby, syntax, gem, rvm

我最近开始从事一个从 github 克隆的项目。

每次我尝试启动 rails 服务器时，都会出现以下错误：

```

/Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:245:in load'load': /Users/thomas/Projects/BillingMiddleware/config/initializers/session_store.rb:3: syntax error, unexpected ':', expecting $end (SyntaxError)
...sion_store :cookie_store, key: '_BillingMiddleware_session'
                              ^
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:245:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in load'load_dependency'
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:245:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/engine.rb:588
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/engine.rb:587:in instance_exec'each'
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/engine.rb:587
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:30:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:30:in run_initializers'run'
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:55:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:54:in run_initializers'each'
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:54:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/application.rb:136:in发送'initialize!'
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in要求'method_missing'
    from /Users/thomas/Projects/BillingMiddleware/config/environment.rb:5
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in load_dependency'require'
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in instance_eval'require'
    from /Users/thomas/Projects/BillingMiddleware/config.ru:4
    from /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:51:in
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:51:in new'initialize'
    from /Users/thomas/Projects/BillingMiddleware/config.ru:1:in
    来自 /Users/thomas/Projects/BillingMiddleware/config.ru:1

```

我的同事也在做这个项目，启动服务器似乎没有任何问题。他和我运行相同版本的 ruby​​、rails 和 WeBrick。

我尝试将语法从 key: 更改为 :key =>，但这应该不是问题，因为我正在运行 ruby​​ 版本 1.9.3。如果我无论如何进行更改，我会收到不同的错误消息：

```
/Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:245:in `load': /Users/thomas/Projects/BillingMiddleware/ config/initializers/wrap_parameters.rb:8: 语法错误，意外':'，期待 kEND (SyntaxError)
  wrap_parameters 格式：[:json]
                         ^
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:245:in `load'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:245:in `load'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/engine.rb:588
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/engine.rb:587:in `each'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/engine.rb:587
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `instance_exec'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:30:in `run'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:55:in `run_initializers'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `each'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/initializable.rb:54:in `run_initializers'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/application.rb:136:in `initialize!'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `send'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `method_missing'
    来自 /Users/thomas/Projects/BillingMiddleware/config/environment.rb:5
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    来自 /Users/thomas/Projects/BillingMiddleware/config.ru:4
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:51:in `instance_eval'
    来自 /Users/thomas/.rvm/gems/ruby-1.9.3-p194/gems/rack-1.4.1/lib/rack/builder.rb:51:in `initialize'
    来自 /Users/thomas/Projects/BillingMiddleware/config.ru:1:in `new'
    来自 /Users/thomas/Projects/BillingMiddleware/config.ru:1

```

我已经厌倦了完全删除和重新安装 rvm、ruby 和 rails 几次都没有成功。我也试过运行 bundle install 但没有帮助。

有谁知道出了什么问题？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T03:02:17.740

尝试将散列更改为 :key => :value 语法。[在Rails 3.1 Deployment to Heroku Error](https://stackoverflow.com/questions/6222673/rails-3-1-deployment-to-heroku-error)中讨论了相同的错误和修复。建议的临时修复是：config/initializers/session_store.rb

```
App::Application.config.session_store :cookie_store, :key => '_BillingMiddleware_session' 
```

config/initializers/wrap_parameters.rb

```
ActionController::Base.wrap_parameters :format => [:json] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:21:14.700

在您修复该行之后，看起来像另一行上的哈希语法。检查一下`config/intializers/wrap_parameters.rb` ，我想知道这个项目是否获得了“不”使用新语法的标志？

# ruby-on-rails - RoR 中模型的通用标志

> ID：10826185
> 
> 赞同：0
> 
> 时间：2012-05-31T00:57:18.800
> 
> 标签：ruby-on-rails, database, architecture

我正在制作一个 Ruby on Rails 应用程序，并且意识到我的 User 类可能最终会带有很多通用的布尔/整数属性。例如，假设我每个季度都有一个促销活动，并且我只希望一个人能够使用该促销活动一次。然后我必须每季度创建一个新列 has_used_promotion_N 来跟踪该促销活动。

或者，我正在考虑创建一个名为“通用标志”的新列，它只是帐户上设置的标志的逗号分隔值。例如：

“has_used_promotion_1，has_used_promotion_2，limit_on_feature_a=20”等可以为某些特定用户设置

（或者也许我会将其存储为 JSON）

无论如何，我正在考虑在我的数据库中给自己一些类似 NoSQL 的功能。

出于某种原因，这真的是糟糕的设计吗？以前有没有其他人这样做过？关于 RoR，我完全想念什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:12:41.230

在我看来，Promotion 应该是一个单独的模型，与 User 具有多对多的关系。当您有促销时，您将创建一个 Promotion 实例，并且当有人使用该促销时，您将该人添加到promotion.users 关系中。

这比您的想法要好得多，因为您现在可以查询这些关系。想要使用第一季度促销的所有用户的列表？没问题。您可以使用您的解决方案来做到这一点，但是您必须求助于一些技巧（这是一个词吗？），并且您必须在每个查询中为每个用户解析通用标志字符串。至少可以说并不理想。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:53:10.727

如果有任意大小的关联集合，那么它应该是一个真实的关系，使用现有的数据库和设施建模。促销听起来就是这样，而且看起来你已经在你的数据库中建模了；没有真正的理由保留重复的值层次结构。

对于*实际*通用标志，您可以拥有一个命名标志表并再次使用真实关联。

您`could`也只需将标志对象序列化为文本列。但是，这样做会妨碍您对标志/标志值进行琐碎的搜索。这对于与单个用户相关联的一堆标志可能无关紧要，除非他们已登录，否则您不关心这些标志，但要小心行事——这取决于您的用例。

# php - 我应该阻止哪些不安全的 JavaScript？

> ID：10826186
> 
> 赞同：1
> 
> 时间：2012-05-31T00:57:27.397
> 
> 标签：php, javascript, xss

我正在编写一个 PHP 脚本，它采用 javascript 代码并将其写在某人的浏览器中，效果很好，但我希望 javascript 能够由任何人编写，所以我需要验证某些东西没有添加到 javascript 代码中像重定向和警报框。

我要问的只是为从 javascript 中审查的内容提供建议，我现在有一个相当广泛的列表，但我只是想确保没有任何明显或非常模糊的东西我错过了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T00:59:47.080

老实说，使用 PHP 和 JavaScript 可能有点麻烦。防止危险的 JavaScript 并不是 100% 万无一失的，因为有些人可以从不同的域加载他们自己的 JavaScript 代码，然后做他们想做的事。

但是，你提到你有一个“蜜罐”？

# c# - 如何获得 NHibernate.Search FT 查询以使用“自由文本”查询样式？

> ID：10826188
> 
> 赞同：1
> 
> 时间：2012-05-31T00:57:50.517
> 
> 标签：c#, nhibernate, full-text-search, nhibernate-search

我正在尝试在基于 NHibernate 的 MVC 项目 (NHibernate.Search) 上使用基于 Lucene 的全文搜索引擎来实现文本搜索选项。我看到的有关如何执行此操作的所有文档都表明我需要查看特定列的值，例如：

```
 var query = "Title:Ford";
            using (var search = NHibernate.Search.Search.CreateFullTextSession(s))
            {                   
                using (var transaction = s.BeginTransaction())
                {
                    var carSearchResults = search.CreateFullTextQuery(query)
                        .SetMaxResults(5)
                        .List();  
                    foreach(var car in carSearchResults)
                    {
                        Console.WriteLine(car.Title);
                    }
                    transaction.Commit();
                }
            } 
```

我宁愿查看搜索字符串的所有全文索引列，就像您可以在 SQL 中在`FREETEXT`函数上使用通配符一样...所以我可以执行以下操作：

```
 var query = "Ford";
            using (var search = NHibernate.Search.Search.CreateFullTextSession(s))
            {                   
                using (var transaction = s.BeginTransaction())
                {
                    var carSearchResults = search.CreateFullTextQuery(query)
                        .SetMaxResults(5)
                        .List();  
                    foreach(var car in carSearchResults)
                    {
                        Console.WriteLine(car.Title);
                    }
                    transaction.Commit();
                }
            } 
```

...这将检查“福特”的所有全文索引属性，并返回所有命中。使用基于 NHibernate 的搜索引擎是否有类似的函数/方法/语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T08:08:44.690

看看[如何在 QueryParser 中合并多个字段？](https://stackoverflow.com/questions/468405/how-to-incorporate-multiple-fields-in-queryparser)

简短的回答，改变：

```
var query = "Title:Ford"; 
```

到：

```
var query = "Title:Ford OR Name:Ford OR Field1:Ford OR Field2:Ford"; // etc for all fields 
```

# design-patterns - 位掩码设计模式

> ID：10826190
> 
> 赞同：2
> 
> 时间：2012-05-31T00:57:58.623
> 
> 标签：design-patterns

我很好奇是否有关于何时使用位掩码来帮助提高代码可读性和/或可维护性的经验法则或设计模式。

我在野外见过它们的一个地方是当有几个或多个配置参数需要传递给函数时。

我是从 OOP 的角度来看的，但答案不必仅限于 OOP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:58:30.767

我认为位掩码主要是为了提高时间和空间性能。从 OOP 的角度来看，它们所代表的任何东西都可以封装在适当的接口中。在 C# 中，您可以查看[flags 枚举](http://msdn.microsoft.com/en-us/library/ms229062.aspx)，以方便地将它们表示为枚举。

要将配置参数传递给方法，我通常更喜欢创建一个类。这样，您可以拥有不仅仅是标志的参数，并且客户端无需担心按位操作。看一下这个[`XmlWriterSettings`类](http://msdn.microsoft.com/en-us/library/system.xml.xmlwritersettings.aspx)的例子。有关标志枚举的示例，请查看[`RegexOptions`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regexoptions.aspx)该类。

# stored-procedures - 用于保存变量并显示记录和时间差异的存储过程

> ID：10826193
> 
> 赞同：1
> 
> 时间：2012-05-31T00:58:20.080
> 
> 标签：stored-procedures, cursor, datediff, temp-tables

我正在使用 GPS 车辆跟踪设备，该设备被编程为在不移动时每 5 分钟发送车辆位置并将其存储在数据库中，在移动时每 100 米发送和存储车辆位置。

该数据库有一个名为“vehiculo_punto_gps”的表，用于存储数据，其中包含每个位置/记录的速度、位置、日期时间、地址、vehicle_punto_gps_id 等值。

```
vehicle_gps_id  | datetime---------- | latitude | longitude | speed

1000------------| 05/16/2012 08:00:00|50.0000   |50.00000   |40 (km/h)
1001------------| 05/16/2012 08:01:00|51.0000   |51.00000   |38 (km/h)
1002------------| 05/16/2012 08:01:23|51.0045   |50.000054  |40 (km/h)
1003------------| 05/16/2012 08:01:40|51.00540  |51.0005430 |39 (km/h)
.
.
.
1040------------| 05/16/2012 08:20:40|53.00540  |53.0005430 |0 (km/h)
1041------------| 05/16/2012 08:25:40|53.00540  |53.0005430 |0 (km/h)
1042------------| 05/16/2012 08:30:40|53.00540  |53.0005430 |0 (km/h)
.
.
.
1060------------| 05/16/2012 10:20:40|53.00540  |53.0005430 |20 (km/h)
1061------------| 05/16/2012 10:20:58|53.0000   |53.00023   |40 (km/h)
1062------------| 05/16/2012 10:21:30|53.0000   |53.00000   |0 (km/h) TRAFFIC LIGHT(DO NOT DISPLAY IF THE DURATION IS LOWER THAN THE TIME PARAMETER)
1063------------| 05/16/2012 10:22:40|53.0045   |53.000054  |40 (km/h)
1064------------| 05/16/2012 10:23:00|53.00540  |53.0005430 |39 (km/h)
. 
.
.
1080------------| 05/16/2012 10:30:40|53.00540  |53.0005430 |0 (km/h)
1081------------| 05/16/2012 10:35:40|53.00540  |53.0005430 |0 (km/h)
1082------------| 05/16/2012 10:40:40|53.00540  |53.0005430 |0 (km/h)
. 
.
.
1100------------| 05/16/2012 12:00:40|53.00540  |53.0005430 |20 (km/h) 
```

我需要一个查询来显示车辆停止的所有位置以及它在那里的时间。例如，使用上表，显示应如下所示：

```
Time                |Duration               | Address                  |Position            |Route Time
05/16/2012 08:20:40 |120 min(8:20-10:20)    |Address 1                 |53.00540,53.0005430 |NULL
05/16/2012 10:30:40 |90 min(10:30-12:00)    |Address 2                 |53.00230,53.0423434 |10 min(10:20-10:30) 
```

在上述条件下（停止时 5 分钟，移动 100 米），它可以显示车辆可能发生交通拥堵的记录。或者也许在加油站。

到目前为止，我尝试使用 SQL 游标，如本文所示[。](https://stackoverflow.com/questions/10625931/how-to-make-a-sql-loop-query-to-check-difference-between-values)然后编辑到这个：

```
ALTER PROCEDURE [dbo].[sp_ChecarVehiculos]
@carro int,
@f1 datetime,
@f2 datetime
AS
BEGIN
IF 1=0 BEGIN
SET FMTONLY OFF
END
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;
SELECT cve_punto_gps,fecha_gps, latitud, longitud, velocidad,direccion
INTO #temp
FROM [desarrollo].[dbo].[vehiculo_punto_gps]
WHERE cve_vehiculo=@carro
and fecha_gps>=DATEADD(HOUR,+7,@f1)
and fecha_gps<=DATEADD(HOUR, +7,(DATEADD(MI,+7,@f2)))
DECLARE @cve_inicio as int,
    @cve_final as int,
    @fecha_inicio as datetime,
    @fecha_final as datetime,
    @latitud_inicio as decimal(18,15),
    @latitud_final as decimal (18,15),
    @longitud_inicio as decimal (18,15),
    @longitud_final as decimal (18,15),
    @velocidad_inicio as int,
    @velocidad_final as int,
    @direccion_inicio as nvarchar(150),
    @direccion_final as nvarchar(150)
DECLARE VehicleCursor CURSOR FAST_FORWARD FOR 
SELECT  cve_punto_gps, 
    fecha_gps,
    latitud,
    longitud,
    velocidad,
    direccion
FROM #temp
ORDER BY cve_punto_gps
OPEN VehicleCursor FETCH NEXT FROM VehicleCursor INTO @cve_inicio, @fecha_inicio,   @latitud_inicio, @longitud_inicio, @velocidad_inicio, @direccion_inicio
FETCH NEXT FROM VehicleCursor INTO @cve_final, @fecha_final, @latitud_final, @longitud_final,@velocidad_final, @direccion_final

declare @tempb table(cve int, fecha datetime, posicion nvarchar(60), velocidad int, direccion nvarchar(150) )
WHILE @@FETCH_STATUS = 0  /*or @velocidad_final !=0*/ BEGIN
Declare @lat1 as decimal (18,15)
Declare @lat2 as decimal (18,15)
Declare @lon1 as decimal (18,15)
Declare @lon2 as decimal(18,15)
select @lat1 = @latitud_inicio , @lat2 = @latitud_final , @lon1 = @longitud_inicio, @lon2 = @longitud_final 
    IF  (sELECT geography::Point(@lat1, @lon1, 4326).STDistance(geography::Point(@lat2, @lon2, 4326)) ) > 80
    BEGIN   
        IF DATEDIFF(MI,@fecha_inicio,@fecha_final) >=1
        BEGIN           
            IF @velocidad_final =0 or @velocidad_inicio=0 
            BEGIN
                declare @posicion nvarchar(60)=(cast(@latitud_inicio as nvarchar(30)) +' '+ cast(@longitud_inicio as nvarchar(30)))

                insert into @tempb values(@cve_inicio,@fecha_inicio, @posicion,@velocidad_inicio, @direccion_inicio)
                --PRINT 'Posición: '+cast(@fecha_inicio as nvarchar(30))+' en '+@direccion_inicio+'('+@posicion+')';
            END     
        END
    END
    SET @cve_inicio = @cve_final
    SET @fecha_inicio = @fecha_final
    SET @latitud_inicio=@latitud_final
    SET @longitud_inicio=@longitud_final
    SET @velocidad_inicio=@velocidad_final
    SET @direccion_inicio=@direccion_final
    FETCH NEXT FROM VehicleCursor INTO @cve_final, @fecha_final, @latitud_final, @longitud_final, @velocidad_final, @direccion_final
END   
CLOSE VehicleCursor 
DEALLOCATE VehicleCursor
select DATEADD(HOUR,-7,fecha) as 'Llegada', direccion as 'Direccion', posicion as     'Posicion'  /*into #tempc */from @tempb
/*select * from #tempc*/
END 
```

但是这个查询不是很准确，因为它显示的是第一个移动位置，而不是车辆达到零速的实际位置。如果我想计算持续时间，我会减去每个显示记录的时间，这也不准确。因此，它显示的不是 120 分钟，而是 130 分钟。（120 + 10 分钟的通勤时间）。

希望我足够清楚，因为这很难解释，因为我不是以英语为母语的人，但我很乐意为您提供更多细节。

提前致谢。

# ruby - 我可以避免在 Ruby on Rails 中转置数组吗？

> ID：10826198
> 
> 赞同：2
> 
> 时间：2012-05-31T00:59:12.710
> 
> 标签：ruby, html-select

我有一个 Rails 应用程序，其中包含在模型中`COUNTRIES`创建的完整国家名称和缩写的列表。`Company`列表的数组用于`COUNTRIES`输入表单上的选择标记，以在 DB 中存储缩写。见下文。`VALID_COUNTRIES`用于验证数据库中的缩写。`FULL_COUNTRIES`用于从缩写中显示完整的国家名称。

```
class Company < ActiveRecord::Base

  COUNTRIES = [["Afghanistan","AF"],["Aland Islands","AX"],["Albania","AL"],...]
  COUNTRIES_TRANSFORM = COUNTRIES.transpose
  VALID_COUNTRIES = COUNTRIES_TRANSPOSE[1]
  FULL_COUNTRIES = COUNTRIES_TRANSPOSE[0]

  validates :country, inclusion: { in: VALID_COUNTRIES, message: "enter a valid country" }
    ...
end 
```

在表格上：

```
<%= select_tag(:country, options_for_select(Company::COUNTRIES, 'US')) %> 
```

并转换回完整的国家名称：

```
full_country = FULL_COUNTRIES[VALID_COUNTRIES.index(:country)] 
```

这似乎是一个很好的哈希应用程序，除了键/值顺序是错误的。对于我需要的选择：

```
COUNTRIES = {"Afghanistan" => "AF", "Aland Islands" => "AX", "Albania" => "AL",...} 
```

同时从数据库中获取缩写并显示我需要的完整国家名称：

```
COUNTRIES = {"AF" => "Afghanistan", "AX" => "Aland Islands", "AL" => "Albania",...} 
```

真可惜，因为`COUNTRIES.keys`or`COUNTRIES.values`会给我验证列表（取决于使用哪种哈希布局）。

我对 Ruby/Rails 比较陌生，正在寻找更类似于 Ruby 的方法来解决问题。以下是问题：

1.  转置是否只发生一次，如果是，何时执行？
2.  有没有办法指定不需要转置的 FULL_ 和 VALID_ 列表？
3.  有没有更好或更合理的替代方法来做到这一点？例如，VALID_COUNTRIES 是 COUNTRIES[x][1]，FULL_COUNTRIES 是 COUNTRIES[x][0]，但 VALID_ 必须与验证一起使用。
4.  有没有一种方法可以使哈希只使用一个哈希而不是一个用于 the`select_tag`和一个用于将数据库中的缩写转换回全名以供显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:20:21.583

> 1）转置是否只发生一次，如果是，什么时候执行？

在编译时是的，因为如果您希望每次使用 lambda 都对其进行评估，则您正在分配常量

```
 FULL_COUNTRIES = lambda { COUNTRIES_TRANSPOSE[0] } 
```

> 2) 有没有办法指定不需要转置的 FULL_ 和 VALID_ 列表？

是的，使用地图或收集（它们是同一件事）

```
VALID_COUNTRIES = COUNTRIES.map &:first
FULL_COUNTRIES = COUNTRIES.map &:last 
```

> 3）有没有更好或合理的替代方法来做到这一点？例如，VALID_COUNTRIES 是 COUNTRIES[x][1]，FULL_COUNTRIES 是 COUNTRIES[x][0]，但 VALID_ 必须与验证一起使用。

往上看

> 4）有没有办法使哈希工作？

是的，我不确定为什么哈希不起作用，因为 rails 文档说 options_for_select 将`hash.to_a.map &:first`用于选项文本和`hash.to_a.map &:last`选项值，所以如果你能澄清为什么它不是，你给出的第一个哈希应该是有效的我可以帮助你更多的。

# c# - Moq Equals 仅适用于 IEquatable

> ID：10826199
> 
> 赞同：3
> 
> 时间：2012-05-31T00:59:12.730
> 
> 标签：c#, moq

我正在使用 Moq 框架进行单元测试，我遇到了这个有趣的问题。

```
public interface Bar : IEquatable<Bar>
{
}

[TestClass]
public class TestClass
{
    Mock<Bar> a;
    Mock<Bar> b;

    public TestClass()
    {
        a = new Mock<Bar>();
        b = new Mock<Bar>();

        a.Setup(bar => bar.Equals(b.Object)).Returns(true);
    }

    [TestMethod]
    public void AssertEqualsTest()
    {
        Assert.AreEqual(a.Object, b.Object); //fails
    }

    [TestMethod]
    public void AssertIsTrueTest()
    {
         Assert.IsTrue(a.Object.Equals(b.Object)); //passes
    }
} 
```

**首要问题**

所以`Assert.AreEqual`只是失败了。我不想每次需要检查相等性时都使用第二个测试中的行，即使我的大多数（如果不是全部）类都继承自 IEquatable。

您可能认为它失败了，因为安装程序仅设置 IEquality.Equals() 函数（`Assert.AreEqual`可能不会检查），但如果您添加该行

```
a.Setup(x => x.Equals((object)b.Object)).Returns(true); 
```

对于构造函数，它仍然失败。

**第二期**

如果您从接口声明中注释掉`: IEquatable<Bar>`（以便`a.Setup`覆盖`object.Equals`），则两个测试都会失败。

我想要的结果是能够在`Mock`对象上设置 equals 并调用`Assert.AreEqual`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T03:14:23.977

**首要问题**

通过 dotPeek 检查。`Assert.AreEqual`调用静态方法`object.Equals`来比较实例。`object.Equals`首先使用`operator ==`并且由于模拟实例没有实现该运算符，这将默认为比较引用。显然，a 和 b 是不同的实例，因此比较返回 false。

**第二期**

我没有看过 Moq 的内部结构，但我认为这是因为接口没有声明 Equals 方法。确认以下（成功）：

```
public interface IBar
{
}

public class Bar : IBar
{
    public override bool Equals(object obj)
    {
        return false;
    }
}

[TestClass]
public class Class1
{
    [TestMethod]
    public void TestMoq()
    {
        var a = new Mock<Bar>();
        var b = new Mock<Bar>();

        a.Setup(bar => bar.Equals(b.Object)).Returns(true);

        Assert.IsTrue(a.Object.Equals(b.Object));
    }
} 
```

如果我删除`Bar.Equals`覆盖，测试也将失败。只是一个猜测，但由于 Moq 在内部使用 Castle，这个问题可以通过这个[Q&A](https://stackoverflow.com/questions/2969274/castle-dynamicproxy-how-to-proxy-equals-when-proxying-an-interface)来解释。

无论如何，我认为你现在正在做什么，`Assert.IsTrue(a.Object.Equals(b.Object));`并且`IEquatable`是一个足够的解决方法。

顺便说一句，正如 JaredPar 上面问的那样，你为什么要比较模拟？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T10:23:07.800

我用了..

```
mockLine2.CallBase = True 
```

为什么？

我们正在测试订单服务。由于订单有两行，服务删除任何符合某些条件的行。行是一个 IList，列表（等）使用 .equals() 来查找您想要的项目，因此要删除该行，您需要一个通过的 equals 实现：

```
Assert.IsTrue(mockLine2.Object.Equals(mockLine2.Object) 
```

“Moq mock 没有检测到一行等于自身，因此订单上的行集合将无法找到该行。”）

您可能会争辩说，由于 Order 不是被测试的类，我们应该模拟订单并断言`order.Lines.Remove()`用正确的行调用，但我们发现使用真实的域对象总体上不那么痛苦（它们都是公平的愚蠢）而不是嘲笑他们。

# jquery - 如何在 Clojurescript 中使用 jayq 从事件中获取数据？

> ID：10826200
> 
> 赞同：1
> 
> 时间：2012-05-31T00:59:15.103
> 
> 标签：jquery, clojure, clojurescript

我正在尝试从 jayq 的事件中获取修改器密钥数据（请参见[此处](https://stackoverflow.com/a/5379955/841431)）。

这工作得很好

```
(delegate $body note-list-item :click
      (fn [e]
        (.preventDefault e)
        (js/alert "clicked!"))) 
```

但这不是。

```
(delegate $body note-list-item :click
      (fn [e]
        (.preventDefault e)
        (if (.metaKey e)
          (js/alert "meta clicked")
          (js/alert "no meta")))) 
```

Chrome 中的 Javascript 控制台给了我`Uncaught TypeError: Property 'metaKey' of object #<Object> is not a function`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:02:06.880

然后我马上就明白了，当然。`metaKey`是对象的属性，而不是方法。在 Clojurescript 中，您可以使用它`(.-metaKey e)`（注意破折号）。有关更多详细信息，请参见[此处](https://stackoverflow.com/questions/9861485/clojurescript-interop)。

# macos - Mac + RStudio：升级硬件还是保留降级的软件？

> ID：10826201
> 
> 赞同：1
> 
> 时间：2012-05-31T00:59:18.170
> 
> 标签：macos, r, rstudio

其他 R 用户可能会同意[`RStudio`IDE](http://www.rstudio.org/)是一种非常有效的提高生产力的方法。但是，随着 的发布`RStudio 0.96.122`，既不支持 32 位 Mac，也不支持 OSX < 10.6 (Snow Leopard)。我运行 OSX 10.6，但在 32 位 Intel Mac 上；因此，我的选择是

1.  接受这将是我的系统的最后一个功能版本并处理它的限制。
2.  向开发人员投诉 - 我宁愿不这样做。
3.  购买昂贵的新硬件，即新的 Mac。
4.  停止使用`R`和/或`RStudio`- 没门！

所以我的问题是：在什么时候升级硬件而不是保留以前版本的软件是明智的`RStudio`？64 位对于“普通”用户来说那么重要吗？

显然`RStudio`是由一些非常聪明的程序员积极开发的，但是，该死的，Mac 很贵。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T22:58:48.183

我目前面临同样的问题。我的猜测是您可以[在 Amazon EC2 上安装 R](http://travisnelson.net/2011/05/05/ec2-micro-instance-of-rstudio/)。在接下来的几天里，我将自己尝试一下。我会回到这里询问如何使用代理来保护结果。

# xpath - 让 XmlSearch 只返回兄弟姐妹，而不是孩子

> ID：10826202
> 
> 赞同：2
> 
> 时间：2012-05-31T00:59:33.230
> 
> 标签：xpath, coldfusion

我收到如下所示的 SOAP 响应：

```
<Activity>
    <Id>A</Id>
    <Subject>foo</Subject>
    <Activity>Task</Activity>
</Activity>
<Activity>
    <Id>B</Id>
    <Subject>bar</Subject>
    <Activity>Appointment</Activity>
</Activity>
<Activity>
    <Id>C</Id>
    <Subject>snafu</Subject>
    <Activity>Task</Activity>
</Activity> 
```

在 Coldfusion 中，我试图用这个来解析 Activity 节点：

```
<cfset arrMainNodes = XmlSearch(soapResponse,  "//*[name()='Activity']")  /> 
```

问题是，如果得到一个包含三个元素的数组，我得到一个包含六个元素的数组：3 个父元素和 3 个子元素。

我一生都无法弄清楚 XPath 语句只会找到兄弟姐妹，而不是孩子。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:24:42.393

**使用**：

```
//*[name()='Activity' and not(ancestor::*[name()='Activity' ])] 
```

**这将选择文档中的所有元素，其名称为`"Activity"`并且没有名称为祖先的`"Activity"`**元素。

# java - 基类和派生类的大小差异

> ID：10826203
> 
> 赞同：-6
> 
> 时间：2012-05-31T00:59:34.080
> 
> 标签：java

```
int x=22;
long z=24;
//now in this case int is smaller than long so
z=x; // is quite appropriate as it implicitly converts from int to long(widening) 
```

同样，我们有这样的类：

```
private static class Box {
    private int width;
    private int height;
    private int length;
    //...
}

private static class WeightBox extends Box {
    private int weight;
    //...
}

public class Main {
    public static void main(String args[]) {
        Box simpleBox = new Box();
        WeightBox wt = new WeightBox();
        simpleBox = wt; //we can always do this
        //wt = simpleBox cannot be done implicitly 
        //for this to work we have to use type casts
    }
} 
```

为什么`simpleBox = wt`simpleBox属于基类而wt属于扩展类却能做到？扩展类不应该大于基类吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:28:45.230

因为你声明：

```
Box simpleBox = new Box(); 
```

在这种情况下，“simpleBox”变量被声明为“Box”类型，这意味着您可以将任何与 Box 赋值兼容的对象实例重新分配给它。在声明时，您已经给它一个恰好属于同一类的值。

由于 wt 被声明为“WeightBox”，它是“Box”的子类，因此它是赋值兼容的（上面提到的 liskov 替换原则）。这与这样做没有什么不同：

```
List<String> list = new ArrayList<String>();
list = new LinkedList<String>(); 
```

ArrayList 和 LinkedList 都与 List 兼容。

如果您想在运行时检查它，这是对类本身的简单操作：

```
Box.class.isAssignableFrom(WeightBox.class) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:13:07.667

考虑铸造时，尺寸无关紧要。查看本[教程](http://forum.codecall.net/topic/50451-upcasting-downcasting/)以了解向上转换和向下转换。方便的是，它是用 Java 编写的。:)

# iframe - iframe 小部件谷歌分析跳出率

> ID：10826205
> 
> 赞同：0
> 
> 时间：2012-05-31T00:59:52.340
> 
> 标签：iframe, google-analytics, widget

我有一个 iframe 小部件，我使用 GA 跟踪代码（嵌入小部件的每个站点的新代码）嵌入到网站上。我们看到跳出率为 55%，但我们的小部件是一个单页网站，所以我原以为跳出率为 100%。我使用自定义事件跟踪我们的小部件中发生的许多事情，我没有看到大量的交互，但跳出率仍然很低。

Google 会看到哪些事件（没有刷新框，一切都通过异步请求在幕后完成）导致跳出率不是 100%？

（是的，我在单页网站上阅读了低于 100% 的 Google Analytics（分析）跳出率，它并没有真正回答我的问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T04:23:11.550

`_trackEvent()`有一个可选参数`opt_noninteraction`——来自[事件跟踪文档](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEventTracking#_gat.GA_EventTracker_._trackEvent)：

> 默认情况下，_trackEvent() 发送的事件命中会影响访问者的跳出率。通过将此参数设置为 true，此事件命中将不会用于跳出率计算。

听起来这可能会占您跳出率的一部分。

# html - 为什么 HTML 表格元素有制表符和换行符，这只是为了便于阅读

> ID：10826215
> 
> 赞同：1
> 
> 时间：2012-05-31T01:01:07.890
> 
> 标签：html, parsing, nokogiri, html-table

我正在尝试阅读/解析网页。一些表格元素似乎有许多制表符和换行符。

很好奇为什么几个单词前面有制表符/换行符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:01:59.673

这是为了可读性和可维护性。它有助于识别块级和容器元素，并确保开始标签具有结束标签。基本上它是为了让开发人员的生活更轻松，因为浏览器不关心缩进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:55:51.060

您可能会看到如下标记：

```
<table id="stuff">
  <tbody>
    <tr>
      <td>
        Hello World!
      </td>
    </tr>
  </tbody>
</table> 
```

```
doc = Nokogiri.HTML(some_string)
p doc.at('#stuff td').text
#=> "\n\t\t\t\tHello World!\n\t\t\t" 
```

如您所见，这确实是该单元格的文本内容。

# spotify - 使用独立的网络应用程序创建 Spotify 播放列表

> ID：10826217
> 
> 赞同：4
> 
> 时间：2012-05-31T01:01:52.617
> 
> 标签：spotify

我只想能够通过发送/接收 http 请求（一个独立的网络应用程序，而不是 Spotify 应用程序和桌面客户端）来创建一个播放列表。我翻遍了文档，找不到明确的解决方案。有人可以指出我正确的方向吗？提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-31T15:05:11.473

您可以通过将曲目 ID 添加到链接中，将歌曲列表（而不是播放列表）传递给桌面播放器，如下所示

```
<a href="spotify:trackset:PlaylistName:49MsPNQCOmxvIYi9AdoPzY,6fUlrsHaz4QfCNF31rk2dU,5KiTsR2h8jnzkvTeucxoAn,6kidUwWb8tB9ktfy7U76iX,6mlUEdb90RqwUisnp65lG7,6KOEK6SeCEZOQkLj5M1PxH,3psrcZoGRaWh6FMGael1NX,3EHLii6bnZxJxsCfLlIb83,0xJtHBdhpdLuClaSQYddI4,6fsdOFwa9lTG7WKL9sEWRU">Play</a> 
```

**更新**

截至今天，有一个用于创建播放列表的 api：[https ://developer.spotify.com/web-api/create-playlist/](https://developer.spotify.com/web-api/create-playlist/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T08:34:47.507

> 我只是希望能够通过发送/接收 http 请求来创建播放列表

目前这是不可能的——Spotify 没有用于操作播放列表的 Web API。您可以使用 libSpotify 一起破解解决方案，尽管以这种方式在服务器服务中使用 libSpotify 违反了 ToS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T04:05:55.217

您可能想查看[https://github.com/liesen/spotify-api-server](https://github.com/liesen/spotify-api-server) 它仅限于一个 spotify 帐户（您配置它的那个），但允许通过 RESTish 调用创建/操作播放列表。

# java - 线程安全迭代 LinkedHashMap

> ID：10826224
> 
> 赞同：3
> 
> 时间：2012-05-31T01:02:34.913
> 
> 标签：java, thread-safety

我有一个私有的 LinkedHashMap 用于从不同的线程读取（仅用于读取）：

```
class foo {

  private LinkedHashMap map = ...;

  public publicMethodCalledFromDifferentThreads() {

     for (Object foo : map) {
        ...
     }
  }
} 
```

此实现不是线程安全的，因此`for`循环无法正确运行。我试图自己找到解决方案，但我想出的唯一方法如下：

```
class foo {

  private LinkedHashMap map = ...;
  private Map.Entry[] mapEntries = map.entrySet().toArray() ...;

  public publicMethodCalledFromDifferentThreads() {

     for (int i = 0; i < mapEntries.length; i++) {
        mapEntries[i]...
        ...
     }
  }
} 
```

所以最后我需要有两个变量，迭代变得非常复杂。最好的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:05:39.777

如果您只是阅读，并且没有修改底层对象，无论是列表还是列表中的东西，都应该没有线程问题。

您实际遇到什么问题？

我认为您可能正在以某种方式修改您的 LinkedHashMap。

此外，您如何确定线程正在跳跃？您确定您不只是看到混合的 2 个线程的输出，即使每个线程都按顺序迭代，这看起来像是在跳来跳去？例如，如果每个线程都打印其当前条目，您可能会看到类似

123 12 45 345 6....

这是顺序的....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:05:56.593

您可以使用[同步地图](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedMap%28java.util.Map%29)。

```
private final Map<K, V> map = Collections.synchronizedMap(new LinkedHashMap<K, V>());

public void foo() {
    synchronized(map) {
        for(K key : map.keySet()) {
            // thread safe iteration
        }
    }
} 
```

# php - PHP MYSQL List Data inside Table问题

> ID：10826225
> 
> 赞同：1
> 
> 时间：2012-05-31T01:02:55.460
> 
> 标签：php, mysql

下面是我的 PHP 代码，用于在表格中显示我的数据库中的所有数据。

如果我使用下面的代码登录并选择 DB 而不是使用 PDO：

```
 mysql_connect("localhost","root","12345678") or die(mysql_error());
   mysql_select_db("clubresults") or die(mysql_error());
   $query=mysql_query("SELECT * from events ORDER By EventID ASC") or die(mysql_error()); 
```

输出为我提供了一个表格，其中列出了正确列出的所有数据。

但是，如果我使用 PDO .. 它会给我这个错误：

```
Warning: mysql_num_fields() expects parameter 1 to be resource, object given in C:\xampp\htdocs\clubresults\listevents.php on line 52

Warning: mysql_fetch_row() expects parameter 1 to be resource, object given in C:\xampp\htdocs\clubresults\listevents.php on line 58 
```

下面是完整的 php 代码，用于抓取数据并将其放置在表格中（不起作用）任何人都能够指出我哪里出错了？因为我自己似乎无法弄清楚。所有建议都非常感谢！谢谢！

```
$pdo = new PDO('mysql:host=localhost;dbname=clubresults', 'root', '12345678');
        #Set Error Mode to ERRMODE_EXCEPTION.
        $pdo->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);  

   $query=$pdo->query('SELECT * from events ORDER By EventID ASC');

   <<<<<<<<<<<<<<<<THIS BIT WORKS IF NOT USING PDO>>>>>>>>>>
$numfields = mysql_num_fields($query);
       print("<table border=\"1\">\n<tr>\n");
       for ($i=0; $i<$numfields; $i++) {
          printf("<th>%s</th>\n", mysql_field_name($query,$i));
       }
       print("</tr>\n");
       while ($row = mysql_fetch_row($query)) {
          print("<tr>\n");
          for ($i=0; $i<sizeof($row); $i++) {
             printf("<td><a href=\"index.php?ID=%s\">%s</a></td>\n", $row[0],$row[$i]);
          }
          print("</tr>\n");
       }
       print("</table>\n"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:12:44.997

您将无法使用PDO`mysql_num_fields()`或`mysql_fetch_row()`与 PDO 一起使用——它们是不同 API 的一部分，即旧的 MySQL 扩展。

相反，既然您已经调用了`PDO::query()`，请调用`$query->fetch()`。使用第一行的数组键来构建表格标题。

```
$query = $pdo->query('SELECT * from events ORDER By EventID ASC');
$rowset = array();

if ($query) {
  while ($row = $query->fetch(PDO::FETCH_ASSOC)) {
    // Build array of rows
    $rowset[] = $row;
  }    

  // Output header first
  $headrow = $rowset[0];
  print("<table border=\"1\">\n<tr>\n");
  // Use $rowset[0] to write the table heading
  foreach ($headrow as $col => $val) {
    printf("<th>%s</th>\n", $col);
  }
  print("</tr>");

  // Then output table rows.
  // Outer loop iterates over row
  foreach ($rowset as $row) {
     print("<tr>");
     // Inner loop iterates over columns using $col => $val
     foreach ($row as $col => $val) {
        // We don't know your column names, but substitute the first column (the ID) for FIRSTCOL here
        printf("<td><a href=\"index.php?ID=%s\">%s</a></td>\n", $row['FRISTCOL'],$val);
     }
     print("</tr>");
  }
}
print("</table>"); 
```

### 附录

一般来说，我建议不要使用`SELECT *`和动态写出你的列标题。相反，要明确说明您在`SELECT`语句中请求的列，并在您写出的表格中明确说明它们。这样，您可以确定列出现的顺序，并且您永远不会因为向表中添加不应该出现在屏幕输出中的列而被抓住。

# jquery - 动画执行后未调用 jQuery Animate 回调？

> ID：10826227
> 
> 赞同：3
> 
> 时间：2012-05-31T01:03:16.890
> 
> 标签：jquery, jquery-animate, infinite-carousel

我正在使用 jQuery`.animate()`创建一个无限轮播。我以前用过`.animate()`，没有任何问题。然而，这一次，动画没有完成。

这是一个非常简单的动画，更改`margin-left`为不同的值。值发生了变化，对我来说它看起来好像是完整的，但是函数没有触发。

这是我的代码：

```
<script type="text/javascript">
  $("#scrollLeft").click(function(){
      $("#scrollContent").animate(
        {'margin-left':'-714px'},
        {queue:false, duration:500},
        function(){
            alert("finishedLeft");
      });
  });
  $("#scrollRight").click(function(){
      $("#scrollContent").animate(
        {'margin-left':'-1190px'},
        {queue:false, duration:500},
        function(){
            alert("finishedRight");
      });
  });
</script> 
```

问题区域是页面底部的轮播。我快跑了`jquery-1.7.1.min.js`。

我想我的主要问题是，即使事件似乎已经完成，什么可能会阻止此功能触发？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T01:14:37.133

[注意你的语法。](http://api.jquery.com/animate/)

[http://jsfiddle.net/n1ck/HBCn5/](http://jsfiddle.net/n1ck/HBCn5/)

```
$("#scrollLeft").click(function() {
    $("#scrollContent").animate({
        'margin-left': '-714px', // don't close out the parameters with parentheses yet ...
        queue: false,            // continue adding the queue option (if needed)
        duration: 500            // and the duration option (if needed) and close after
    }, function() {
        alert("finishedLeft");
    });
});
$("#scrollRight").click(function() {
    $("#scrollContent").animate({
        'margin-left': '-1190px', // same as above
        queue: false,
        duration: 500
    }, function() {
        alert("finishedRight");
    });
});​    ​ 
```

# git - Git Diff - 如何恢复选定的行或块

> ID：10826228
> 
> 赞同：52
> 
> 时间：2012-05-31T01:03:47.690
> 
> 标签：git, diff, git-gui

在 Git GUI 中，我可以选择 diff 的一部分并仅暂存那些行或块。我将如何做相反的事情，如回滚文件中更改的行。通常这些是我只想恢复但仍暂存/提交同一文件的其他部分的意外空白更改。

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2012-05-31T02:55:17.793

使用 暂存您想要的部分`git add -p`，然后丢弃 ( `git checkout -- filename`) 未暂存的更改。

**Git 1.6.5+ 的更新**

在 1.6.5 版本中，Git 学会了使用`-p/--patch`标志结账。您可以使用`git checkout -p -- filename`.

从[文档](https://git-scm.com/docs/git-checkout#git-checkout---patch)：

> 以交互方式选择 <tree-ish> （或索引，如果未指定）和工作树之间的差异中的块。然后将选择的块反向应用于工作树（如果指定了 <tree-ish>，则为索引）。
> 
> 这意味着您可以使用 git checkout -p 有选择地丢弃当前工作树中的编辑。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-08-20T15:02:37.470

在 Git Gui 中，

1.  暂存包含不需要更改的整个文件
2.  取消你想要恢复的线条/大块头
3.  *在Unstaged Changes*窗格中选择文件，然后Commit- *>Revert Changes*撤消对该文件的所有（未暂存）更改

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-31T02:48:01.263

对于 Git Gui：首先，单击重新扫描以扫描修改后的文件。接下来，单击文件名左侧的图标以暂存所有修改以进行提交。然后，右键单击调试行并选择 Unstage Line From Commit。

以上资料来自： http: [//nathanj.github.com/gitguide/tour.html](http://nathanj.github.com/gitguide/tour.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-02-19T11:00:19.583

从 Git 2.24 开始，Git GUI 在上下文菜单中具有“Revert Hunk”和“Revert Line”选项，类似于 staging。您甚至可以“撤消上次还原”，这是一个很好的补充。

这是添加此功能的提交： [https ://github.com/git/git/commit/62bd99934bb2b1a07f786fdf9b94d7b692768e30](https://github.com/git/git/commit/62bd99934bb2b1a07f786fdf9b94d7b692768e30)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-02-08T21:30:28.283

我`git stash -p`用于此目的。它的副作用是使用从工作树中删除的更改创建一个存储，这有时对快速恢复它们很有用。

# java - Android 初学者：设置壁纸

> ID：10826230
> 
> 赞同：-1
> 
> 时间：2012-05-31T01:03:59.540
> 
> 标签：java, android, eclipse, android-intent, bitmap

我是初学者，所以请多多包涵。我创建了一个应用程序，允许您滚动浏览一系列壁纸并选择一个。一切都很完美，但android只将左下角设置为壁纸......壁纸尺寸为640 x 960。

这是我的代码：

```
import java.io.IOException;
import java.io.InputStream;

import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.net.Uri;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.HorizontalScrollView;
import android.widget.ImageView;
import android.widget.LinearLayout;

public class Wallpapers extends Activity implements OnClickListener{

    Button preview;
    Button setBackground;
    Button returnBack;

    ImageView display;
    ImageView wallpaper1;
    ImageView wallpaper2;
    ImageView wallpaper3;
    ImageView wallpaper4;

    LinearLayout backgroundPreview;
    private int image = R.drawable.wallpaper1;
    HorizontalScrollView scrollView;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.wallpapers);

        preview= (Button)findViewById(R.id.wallpaperPreview);
        setBackground = (Button)findViewById(R.id.wallpaperSet);
        returnBack = (Button)findViewById(R.id.wallpaperReturn);
            preview.setOnClickListener(this);
            setBackground.setOnClickListener(this);
            returnBack.setOnClickListener(this);

        display=(ImageView)findViewById(R.id.wallpaperDisplay);
        wallpaper1=(ImageView)findViewById(R.id.wallpaper1);
        wallpaper2=(ImageView)findViewById(R.id.wallpaper2);
        wallpaper3=(ImageView)findViewById(R.id.wallpaper3);
        wallpaper4=(ImageView)findViewById(R.id.wallpaper4);
            wallpaper1.setOnClickListener(this);
            wallpaper2.setOnClickListener(this);
            wallpaper3.setOnClickListener(this);
            wallpaper4.setOnClickListener(this);

        backgroundPreview = (LinearLayout)findViewById(R.id.wallpaperActivityLayout);
        scrollView = (HorizontalScrollView)findViewById(R.id.horizontalScrollView);

    }

    public void onClick(View v) {
        switch (v.getId()) {
        case R.id.wallpaperPreview:
            previewBackground(image);
            break;
        case R.id.wallpaperSet:
            new AlertDialog.Builder(this)
                .setMessage("Would you like to set this image as your wallpaper?")
                .setPositiveButton("Yes", new DialogInterface.OnClickListener() {           
                    public void onClick(DialogInterface dialog, int which) {
                        InputStream is = getResources().openRawResource(image);
                        Bitmap wallpaper = BitmapFactory.decodeStream(is);

                        try{
                            getApplicationContext().setWallpaper(wallpaper);
                        }catch(IOException e){
                            e.printStackTrace();
                        }
                    }
                })
                .setNegativeButton("No", null)
                .show();

            break;
        case R.id.wallpaperReturn:
            reverse();
            break;
        case R.id.wallpaper1:
            display.setImageResource(R.drawable.wallpaper1);
            image = R.drawable.wallpaper1;
            break;
        case R.id.wallpaper2:
            display.setImageResource(R.drawable.wallpaper2);
            image = R.drawable.wallpaper2;
            break;
        case R.id.wallpaper3:
            display.setImageResource(R.drawable.wallpaper3);
            image = R.drawable.wallpaper3;
            break;
        case R.id.wallpaper4:
            display.setImageResource(R.drawable.wallpaper4);
            image = R.drawable.wallpaper4;
            break;
        }

    }

    private void previewBackground(int image) {
        backgroundPreview.setBackgroundResource(image);
        setBackground.setVisibility(View.GONE);
        preview.setVisibility(View.GONE);

        display.setVisibility(View.GONE);
        scrollView.setVisibility(View.GONE);

        returnBack.setVisibility(View.VISIBLE);             
    }

    private void reverse() {
        backgroundPreview.setBackgroundResource(android.R.color.black);
        setBackground.setVisibility(View.VISIBLE);
        preview.setVisibility(View.VISIBLE);

        display.setVisibility(View.VISIBLE);
        scrollView.setVisibility(View.VISIBLE);

        returnBack.setVisibility(View.GONE);                
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T06:14:29.367

```
 public void SetBackground(int Url) {

    try {
        File file = new File("/sdcard/sampleimage");
        Bitmap bitmap = BitmapFactory.decodeResource(getResources(), Url);
        bitmap.compress(CompressFormat.JPEG, 80, new FileOutputStream(file));
        Context context = this.getBaseContext();
        context.setWallpaper(bitmap);            
        Toast.makeText(getApplicationContext(), "Wallpaper has been set",             Toast.LENGTH_SHORT).show();            
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }         
} 
```

在 AndroidManifest.xml 中

```
<uses-permission android:name="android.permission.SET_WALLPAPER"></uses-permission> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-18T14:02:38.870

将此包含在您的 imageView 的 Xml 中：

`android:scaleType="fitXY"`或`"fitCenter"`或`"cropCenter"`或您可能喜欢的任何其他选项

# asp.net - 在asp.net gridview中将控件添加到寻呼机的上一个/下一个的右侧

> ID：10826235
> 
> 赞同：2
> 
> 时间：2012-05-31T01:05:46.813
> 
> 标签：asp.net, gridview

我正在尝试在 asp.net gridview 的上一个/下一个寻呼机的右侧添加一个按钮控件。我曾尝试使用此站点上的示例，但我需要保留上一个/下一个并将按钮放在寻呼机底部行的右侧。

起初我在下一个单元格中显示了一个小（5px）它，然后经过多次其他尝试，现在甚至没有出现。

如何在保持 gridview 生成的下一个/上一个按钮的同时将按钮向右对齐。

谢谢

```
 Private Sub grdClientServiceType_RowCreated(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles grdClientServiceType.RowCreated
    Select Case e.Row.RowType
        Case DataControlRowType.Pager

            'Dim space As New LiteralControl(" ")
            'Dim span1 As New Label
            'span1.Text = " "
            'span1.Style("margin-left") = "50px"

            'Dim butt As New Button
            'butt.ID = "buttShowAvail"
            'butt.BackColor = Drawing.Color.Purple
            'butt.ForeColor = Drawing.Color.White
            'butt.Font.Bold = True
            'butt.ToolTip = "Click for a selection of times available."

            'Dim table As Table = TryCast(e.Row.Cells(0).Controls(0), Table)
            'Dim parentCell As TableCell = table.Rows(0).Cells(table.Rows(0).Cells.Count - 1)
            'Dim w As Integer = parentCell.Width.Value

            'parentCell.Controls.Add(space)
            'parentCell.Controls.Add(butt)

            Dim butt As New Button
            butt.ID = "buttShowAvail"
            butt.BackColor = Drawing.Color.Purple
            butt.ForeColor = Drawing.Color.White
            butt.Font.Bold = True
            butt.ToolTip = "Click for a selection of times available."

            AddHandler butt.Click, AddressOf buttShowAvail_Click
            e.Row.Cells(0).ColumnSpan -= 1
            Dim td As New TableCell
            Dim span1 As New Label
            span1.Text = "Show"
            span1.Style("margin-left") = "10px"
            td.Controls.Add(span1)
            td.Controls.Add(butt)
            Dim span2 As New Label
            span2.Text = "rows per page"
            td.Controls.Add(span2)
            e.Row.Cells.Add(td)

    End Select

End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:48:24.333

我终于弄明白了，感谢这个网站。我只需要改变一些事情来让它工作。
解决方案如下...

```
 Private Sub grdClientServiceType_RowCreated(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles grdClientServiceType.RowCreated
    Select Case e.Row.RowType
        Case DataControlRowType.Pager

            Dim butt As New Button
            butt.ID = "buttShowAvail"
            butt.BackColor = Drawing.Color.Purple
            butt.ForeColor = Drawing.Color.White
            butt.Font.Bold = True
            butt.ToolTip = "Click for a selection of times available."
            butt.Width = "220"
            butt.Height = "40"
            butt.Text = "Show Availability"
            butt.Font.Size = "11"

            AddHandler butt.Click, AddressOf buttShowAvail_Click
            e.Row.Cells(0).ColumnSpan -= 1
            Dim td As New TableCell
            td.Controls.Add(butt)
            e.Row.Cells.Add(td)

    End Select

End Sub 
```

# android - 如何在android中播放来自url的视频？

> ID：10826244
> 
> 赞同：0
> 
> 时间：2012-05-31T01:08:01.583
> 
> 标签：android

我将所有视频都存储在服务器中。我需要连接到该服务器并且应该显示视频。我尝试了各种方式……在谷歌中搜索……尝试了很多样本​​，但我的视频仍然没有播放。它显示消息“抱歉无法播放此视频”。请帮我解决这个问题...为此而苦苦挣扎...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:44:28.187

在您的活动中尝试以下代码。这是你想要的？

```
super.onCreate(savedInstanceState);
setContentView(R.layout.video);
startActivity(new Intent(Intent.ACTION_VIEW,
              Uri.parse("http://www.youtube.com/watch?v=SUOWNXGRc6g"))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:45:59.600

您的视频应采用 Android[支持的格式。](http://developer.android.com/guide/appendix/media-formats.html#core)

# c# - 实体框架异步取消

> ID：10826246
> 
> 赞同：1
> 
> 时间：2012-05-31T01:09:27.390
> 
> 标签：c#, entity-framework

这与我之前的问题有关：

[C# 中的异步方法](https://stackoverflow.com/questions/10825574/async-methods-in-c-sharp/10825606#10825606)

回顾一下，我有几个操作需要花费太多时间才能完成，因此我想异步运行它们

现在我的所有操作都异步运行并报告每个操作完成所需的时间，我还添加了取消但是......即使在内存中取消了操作，数据库操作似乎仍在运行 =(((

在数据库（SQL Server 2008）中执行的操作是存储过程，基本上与链接数据库连接以在两个数据库之间执行同步

所以基本上我怎样才能取消对 sp 的调用以停止操作并回滚事务？？？

我正在使用 EF 调用 sp

# php - 如何从此 PHP 片段中删除类别？

> ID：10826250
> 
> 赞同：0
> 
> 时间：2012-05-31T01:09:52.237
> 
> 标签：php, wordpress, plugins

我正在编辑一个为相关博客文章提供建议的 WordPress 插件。

这是它现在的样子的屏幕截图：

![在此处输入图像描述](../Images/14a72ca4be96ee9f7cb1975bce77136c.png)

我希望它看起来与屏幕截图一模一样，但没有“感恩、幸福”链接……它们只是指向类别的链接。保留“为您推荐”和文章链接，但删除类别链接。

如果我从下面的代码中删除“foreach ($siblings as $url => $name)”片段，那么它会删除类别，但会弄乱指向推荐文章的链接。

我应该如何编辑它？要删除类别但保留其他所有内容？

注意：我不确定这对下面的代码是否重要，但插件会根据上一篇文章在同一类别中选择推荐文章。

```
 ob_start();
    do_action( 'iworks_upprev_box_before' );
    $value .= ob_get_flush();
    if ( $iworks_upprev_options->get_option( 'header_show' ) ) {
        $value .= '<h6>';
        if ( count( $siblings ) ) {
            $value .= sprintf ( '%s ', __('Recommended for You' ) );
            $a = array(); 
            foreach ( $siblings as $url => $name ) {
            $a[] = sprintf( '<a href="%s" rel="%s">%s</a>', $url, $current_post_title, $name );
            }
            $value .= implode( ', ', $a);
        } else if ( $compare == 'random' ) {
            $value .= __('Read more:', 'upprev' );
        } else {
            $value .= __('Read previous post:', 'upprev' );
        }
        $value .= '</h6>';
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:13:19.553

看起来您需要做的就是注释掉这一行或将其删除：

```
$value .= implode( ', ', $a); 
```

您还可以注释/删除以下代码行：

```
$a = array(); 
foreach ( $siblings as $url => $name ) {
   $a[] = sprintf( '<a href="%s" rel="%s">%s</a>', $url, $current_post_title, $name );
} 
```

# c# - 如何创建颜色的多选列表

> ID：10826252
> 
> 赞同：0
> 
> 时间：2012-05-31T01:10:17.530
> 
> 标签：c#, windows-phone-7, xaml

我一直在尝试使用 WP7.1 中支持的颜色填充多选列表，但是在后面的代码中生成这些颜色的列表时遇到问题。到目前为止，我的解决方案如下：

ColorListPage.xaml

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <toolkit:MultiselectList x:Name="ColorList" ItemsSource="{Binding}" Height="88" HorizontalAlignment="Left" VerticalAlignment="Top" >                
            <DataTemplate>
                <StackPanel Orientation="Horizontal" Margin="16,21,0,20">
                    <Rectangle Fill="{Binding}" Width="50" Height="50"/>
                    <TextBlock Text="{Binding}" Margin="12,10,0,0"/>
                </StackPanel>
            </DataTemplate>                
        </toolkit:MultiselectList> 
```

并且我正在尝试将数据绑定到矩形和文本块属性，以便矩形将填充一个solidcolorbrush 值，并且文本块将包含相应的solidcolorbrush 的名称。这就是我卡住的地方，因为我不知道如何做到这一点？具体来说，我不是试图调用强调色，而是所有可用的颜色选项（例如，在明确设置矩形填充时看到的选项列表很大）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T05:25:28.193

你想要一个MultiSelectList 还是一个ListPicker？您是否希望用户能够选择不止一种颜色？这是一个使用 ListPicker 的示例。要获得颜色，您必须自己创建颜色。这是使用强调色的示例

ListPicker 的 xaml：

```
 <toolkit:ListPicker x:Name="ColorPicker" ExpansionMode="FullScreenOnly"
                            FullModeHeader="COLOR"
                            Visibility="Collapsed"
                            ItemsSource="{Binding Brushes}"
                            SelectedItem="{Binding SelectedBrush, Mode=TwoWay}">
            <toolkit:ListPicker.FullModeItemTemplate>
                <DataTemplate>
                    <StackPanel Margin="0 20" Orientation="Horizontal">
                        <Rectangle Width="42" Height="42" Fill="{Binding Brush}"
                               Stroke="{StaticResource PhoneForegroundBrush}"
                               HorizontalAlignment="Left"/>
                        <TextBlock Text="{Binding Name}" Style="{StaticResource PhoneTextExtraLargeStyle}"
                                   HorizontalAlignment="Center" Margin="5,0"/>
                    </StackPanel>
                </DataTemplate>
            </toolkit:ListPicker.FullModeItemTemplate>
        </toolkit:ListPicker> 
```

以及生成颜色集合的代码：

```
private IList<ColorItem> CreateBrushes()
    {
        var brushes = new List<ColorItem>
        {
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,27,161,226)), Name = "blue" },    
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,160,80,0)), Name = "brown" },     
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255, 51,153,51)), Name = "green" },   
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,162,193,57)), Name = "lime" },   
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,216,0,115)), Name = "magenta" }, 
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,240,150,9)), Name = "mango" },   
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,230,113,184)), Name = "pink" },  
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,162,0,255)), Name = "purple" },  
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,229,20,0)), Name = "red" },      
            new ColorItem { Brush = new SolidColorBrush(Color.FromArgb(255,0,171,169)), Name = "teal" },    
        };
        return brushes;
    }

public class ColorItem
{
    public SolidColorBrush Brush { get; set; }
    public string Name { get; set; }
} 
```

您还可以使用反射来收集颜色。

```
 Type t = typeof(Colors);
        var properties = t.GetProperties();
        List<ColorItem> items = new List<ColorItem>();

        for (int i = 0; i < properties.Length; i++)
        {
            var property = properties[i];
            items.Add(new ColorItem
            {
                Name = property.Name,
                Color = new SolidColorBrush((Color)property.GetValue(null, null))
            });
        } 
```

# python - python循环移位字符串中的字符

> ID：10826253
> 
> 赞同：1
> 
> 时间：2012-05-31T01:10:19.227
> 
> 标签：python, subclass

实现“<<”和“>>”方法作为字符串中字符的循环移位的标准str类型的子类sstr。尝试做的是

```
 >>> s1 = sstr("abcde")
 >>> s1 << 0
'abcde'
 >>> s1 >> 0
'abcde'
 >>> s1 << 2
'cdeab'
>>> s1 >> 2
'deabc'
>>> s1 >> 5
 'abcde'

# my attempt:
import string
class sstr(str):
def __new__(self, other):
    return str.__new__(self, other.upper())
def __ilshift__(self, other):
    return str.__ilshift(other)
def __rshift__(self, other):
    return str.__rshift(other) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:49:11.957

这闻起来像家庭作业，所以我不打算在这里发布实际代码。但为了提供帮助，我将指出我在您的代码和算法中看到的缺陷：

我的 python 2.7.2 报告 no`__ilshift`或`__irshift`in `str`。此外，如果您尝试将字符串移动一定数量的字符，那么您不应该移动您调用的变量`other`。你应该改变`self`许多`other`字符。话虽这么说，你可能最好命名`other`为`n`或类似。

现在，我假设您知道循环移位应该如何工作。您提供的示例很好地传达了信息。

作为一个简单的算法（易于阅读/理解），试试这个（伪代码如下）：

```
function __ilshift(self, n) { // self is the string to be shifted. n denotes how many characters to shift it by
    answer = copy()
    for i = 1 to n {
        answer = self[1:] //answer = everything in self excluding the first character
        answer += self[0] // append the first character of self to answer
    }
    return answer
} 
```

上述解决方案将起作用。虽然，它的效率很低。我们知道，当一个 n 字符的字符串移动 时`n`，移动的结果就是字符串本身。当您再考虑一下时，您会意识到自己最终会移动`n % lengthOfSelf`。因此，`for i = 1 to n`变成`for i = 1 to n%len(self)`.

不过，我们可以让这更有效。要做到这一点需要`self`在适当的索引处进行拼接，我会让你弄清楚，因为我认为这是家庭作业。

希望这能让你更接近！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T03:27:44.413

```
s1 << 0 
```

这叫`__lshift__`，不是`__ilshift__`。`i`代表就地；无论如何，您都无法就地更改字符串，也没有尝试在这里（您正在尝试创建新值）。

您的实际代码的问题是您试图通过调用基`str`类的班次来实现班次。但是基`str`类*没有*这种移位操作——这就是你进行这个练习的全部原因！

提示：将两段字符串放在一起。`'foobar' << 2`是`'obar' + 'fo'`。你能看到如何分割字符串来得到那些吗？您用于切片的数字与指定用于移位的数字有何关系？

# java - 可以用 Java 实现流式集合吗？

> ID：10826256
> 
> 赞同：4
> 
> 时间：2012-05-31T01:11:28.560
> 
> 标签：java, collections, streaming

我需要实现一个实用程序服务器来跟踪将从任何其他服务器发送的少量自定义变量。要跟踪变量，需要使用 JDK 定义或自定义的键值集合。

这里有几个注意事项 -

*   始终将所有变量保存在服务器的内存中是内存密集型的。
*   该服务器需要是一个非常轻量级的服务器，并且我不想要繁重的数据库操作。

是否有一个预定义的流集合可以在阈值内存之后序列化数据并根据需要检索它？

我希望我在定义问题陈述时很清楚。

请建议是否有其他更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:18:28.863

这东西看起来很有前途，但正处于开发阶段......

[JDBM3](https://github.com/jankotek/JDBM3)

> **编辑**文件支持的集合的当前版本：[MapDB](http://www.mapdb.org)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:22:16.397

# 数据库

您所描述的听起来与您应该使用数据库完全一样（即索引键/值存储，对于内存来说太大了，但希望在可能的情况下获得内存缓存的性能优势）。

我推荐一个轻量级的嵌入式数据库，例如[H2——](http://www.h2database.com/html/main.html)它体积小、速度快，应该非常适合您的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T01:18:36.710

您是否想过使用现成的 nosql 队列值存储？[以Redis](http://redis.io/)为例？

如果你只想要它 java 你可以选择使用像[ehcache](http://ehcache.org/)这样的库，它会有你需要的功能。

# php - 为 drupal 字段确定 url 的正则表达式

> ID：10826259
> 
> 赞同：-1
> 
> 时间：2012-05-31T01:11:44.437
> 
> 标签：php, regex, drupal

我正在尝试确定一个正则表达式来从这个谷歌警报重定向中解析出内部 url

```
http://www.google.com/url?sa=X&q=http://weheartit.com/entry/29409069&ct=ga&cad=CAcQARgAIAEoATAAOABAo5aK_gRIAlgBYgVlbi1VUw&cd=jRWL16jvo8k&usg=AFQjCNGbJMqWtbCxpcJdu4PGD6RToU6NTw 
```

我需要做的是删除第一部分

```
http://www.google.com/url?sa=X&q= 
```

而且我还会删除尾随字符串

```
&ct=ga&cad=CAcQARgAIAEoATAAOABAo5aK_gRIAlgBYgVlbi1VUw&cd=jRWL16jvo8k&usg=AFQjCNGbJMqWtbCxpcJdu4PGD6RToU6NTw 
```

所以我要结束的结束网址是

```
http://weheartit.com/entry/29409069 
```

* * *

我只是想更新这个感谢您的帮助。这是 drupal 的链接模块中的一个问题，已修复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:46:23.410

仍然不清楚您要完成什么，无论是提取还是移除周围的部分，这并不难：

```
preg_match('#q=(http://[^&]+)#', $source, $result);
print $result[1]; 
```

否则：

```
= preg_replace('#^.+q=([^&]+).+$#', '$1', $source); 
```

会工作。

*   另请参阅[开源 RegexBuddy 替代品](https://stackoverflow.com/questions/89718/is-there)和[在线正则表达式测试](https://stackoverflow.com/questions/32282/regex-testing)以获取一些有用的工具，或[RegExp.info](http://regular-expressions.info/)获取更好的教程。

再一次，替代方案在于[`parse_url`](http://php.net/parse_url)和[`parse_str`](http://php.net/parse_str)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:08:34.117

如果您*真的*想手动将 URL 剥离，您可以...

```
$ cat parseurl.php 
#!/usr/local/bin/php
<?php

$url="http://www.google.com/url?sa=X&q=http://weheartit.com/entry/29409069&ct=ga&cad=CAcQARgAIAEoATAAOABAo5aK_gRIAlgBYgVlbi1VUw&cd=jRWL16jvo8k&usg=AFQjCNGbJMqWtbCxpcJdu4PGD6RToU6NTw";

# Parts of this section could be replaced with parse_url()
$junk = explode("?", $url);
$parts = explode("&", $junk[1]);
$gvar = array();
foreach ($parts as $thisone) {
  $junk = explode("=", $thisone);
  $gvar[$junk[0]]=$junk[1];
}

print_r($gvar);

printf("Embedded URL: %s\n", $gvar["q"]);

$ ./parseurl.php 
Array
(
    [sa] => X
    [q] => http://weheartit.com/entry/29409069
    [ct] => ga
    [cad] => CAcQARgAIAEoATAAOABAo5aK_gRIAlgBYgVlbi1VUw
    [cd] => jRWL16jvo8k
    [usg] => AFQjCNGbJMqWtbCxpcJdu4PGD6RToU6NTw
)
Embedded URL: http://weheartit.com/entry/29409069
$ 
```

要使用 parse_url() 和 parse_str 执行此操作，您可能会使用以下内容：

```
<?php

$url="http://www.google.com/url?sa=X&q=http://weheartit.com/entry/29409069&ct=ga&cad=CAcQARgAIAEoATAAOABAo5aK_gRIAlgBYgVlbi1VUw&cd=jRWL16jvo8k&usg=AFQjCNGbJMqWtbCxpcJdu4PGD6RToU6NTw";

parse_str( parse_url($url, PHP_URL_QUERY), $gvar );
printf("Embedded URL: %s\n", $gvar['q']); 
```

这绝对看起来是更简单的方法，但我会留下第一个版本，这样你就可以看到（可能）在“幕后”发生了什么。:-)

# c# - 有没有办法从网站上读取，一次一行？

> ID：10826260
> 
> 赞同：5
> 
> 时间：2012-05-31T01:11:44.410
> 
> 标签：c#

我有这个代码：

```
string downloadedString;
System.Net.WebClient client;

client = new System.Net.WebClient();

downloadedString = client.DownloadString(
     "http://thebnet.x10.mx/HWID/BaseHWID/AlloweHwids.txt"); 
```

这是一个 HWID 类型的安全性（它将检查您的 HWID 以查看您是否被允许使用该程序）

无论如何，我希望能够一次在其上放​​置多行，例如：

```
xjh94jsl <-- Not a real HWID
t92jfgds <-- Also not real 
```

并且能够逐行读取每一行，并将其更新为下载的字符串。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-31T01:15:11.600

不要将 url 作为字符串下载，将其作为流读取。

```
using System.IO;
using System.Net;

var url ="http://thebnet.x10.mx/HWID/BaseHWID/AlloweHwids.txt";
var client = new WebClient();
using (var stream = client.OpenRead(url))
using (var reader = new StreamReader(stream))
{
    string line;
    while ((line = reader.ReadLine()) != null)
    {
        // do stuff
    }
} 
```

# interrupt - KVM如何处理物理中断？

> ID：10826261
> 
> 赞同：5
> 
> 时间：2012-05-31T01:11:53.640
> 
> 标签：interrupt, kvm

我正在为 VM 的 IO 进行 KVM 优化。我看过KVM代码，通常所有的物理中断都会导致VMexit进入KVM。然后主机的IDT会处理相应的物理中断。我的问题是 KVM 如何决定是否向来宾注入虚拟中断？在什么情况下它会向来宾注入虚拟中断？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T11:01:09.913

在 kvm 的文档中，这是关于何时可以注入虚拟中断的内容。这是链接[http://os1a.cs.columbia.edu/lxr/source/Documentation/kvm/api.txt](http://os1a.cs.columbia.edu/lxr/source/Documentation/kvm/api.txt)
查看第 905 行
。我认为 struct kvm_run 结构可以控制应用程序如何使 VM 运行.使用cscope并在源代码中搜索字符串request_interrupt_window，您将了解kvm如何查看何时进入guest以注入interupt。另外浏览api.txt文件非常有帮助。

干杯

已编辑
这是主机向来宾注入中断的一个示例。
假设 GUEST VM 中存在页面错误

*   这会导致 VMEXIT
*   Hypervisor/KVM 处理 VMEXIT
*   它通过VMCS控制结构查看VMEXIT的原因，发现有缺页。
*   主机/KVM 负责内存虚拟化，所以它检查是否导致页面错误
    *   因为该页面未分配给 GUEST，在这种情况下，它会调用 HOST 内核中的 alloc_page 并执行 VMENTRY 以恢复 GUEST 执行。
    *   或者映射被 GUEST OS 删除，在这种情况下，KVM 使用 VMCS 控制结构作为通信介质来**注入虚拟中断**no ​​14，这会导致 GUEST 内核处理页面错误。

这是主机插入虚拟中断的一个示例。当然，还有很多其他方法/理由可以这样做。**实际上，您可以配置 VMCS 以使来宾在执行每条指令**
后执行 VMEXIT，这可以使用 MONITOR TRAP 标志来完成。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T01:14:02.163

我猜您指的是分配的设备中断（而不是模拟中断或 virt-IO 中断，它们不直接从物理设备转发到来宾）。对于分配设备的每个 irq，调用 request_threaded_irq 并注册 kvm_assigned_dev_thread 以在每次中断时调用。如您所见，然后调用 kvm_set_irq，并且如上所述，如果中断被屏蔽，则唯一发生的合并。在 x86 中，中断可以被 rflags.if、mov-SS 屏蔽，这是由于 TPR 不允许传递中断或由于具有更高优先级的服务中断。KVM 必须遵循架构定义，以免让客人感到惊讶。**

# c - C中的函数在应该返回int时不返回任何内容

> ID：10826264
> 
> 赞同：1
> 
> 时间：2012-05-31T01:12:25.313
> 
> 标签：c

> **可能重复：**
> [函数返回值而没有返回语句](https://stackoverflow.com/questions/4644860/function-returns-value-without-return-statement)

返回 int 但没有显式返回任何内容的函数的返回值是多少。

例如输出

```
 int fun()
    {
            printf("\ncrap");
    }

    void main()
    {
            printf("\n return value of fun %d", fun());
    } 
```

我得到的输出是：

```
 crap
  return value of fun 1 
```

这是否取决于我正在使用的编译器？

谢谢 ！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:14:30.603

fun() 函数中没有返回值，因此返回的值是未定义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:16:16.700

它可能会返回 EAX 寄存器中的任何内容，如果没有明确的返回值，这可能是不可靠的：

[https://stackoverflow.com/a/4644913/375399](https://stackoverflow.com/a/4644913/375399)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-31T01:20:52.793

这取决于编译器。这是我的输出，供您参考

编译器：i686-apple-darwin11-llvm-gcc-4.2

```
crap
return value of fun 0 
```

# python - django 生产环境中的数据库迁移

> ID：10826266
> 
> 赞同：22
> 
> 时间：2012-05-31T01:12:34.593
> 
> 标签：python, mysql, django, migration, django-south

对于在非平凡生产环境中拥有 django 应用程序的人，您如何处理数据库迁移？我知道有`south`，但如果涉及任何实质性内容，似乎会错过很多。

其他两个选项（我能想到或已经使用）是在测试数据库上进行更改，然后（使用应用程序脱机）并导入该 sql 导出。或者，也许是一个风险更大的选择，实时对生产数据库进行必要的更改，如果出现任何问题，则恢复到备份。

您通常如何处理数据库迁移和架构更改？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-02T06:45:14.993

我认为这个问题有两个部分。

首先是管理数据库模式及其变化。我们使用 South 执行此操作，将工作模型和迁移文件都保存在我们的 SCM 存储库中。为了安全（或偏执），我们在运行任何迁移之前（如果我们真的很害怕，那么之后）会转储数据库。到目前为止，South 已经足以满足我们的所有要求。

其次是部署架构更改，这不仅仅是运行 South 生成的迁移文件。根据我的经验，更改数据库通常需要更改已部署的代码。如果您甚至有一个小型网络农场，保持部署的代码与您的数据库模式的当前版本同步可能并非易事 - 如果您考虑不同的缓存层和对已经活跃的站点用户的影响，这会变得更糟。不同的网站处理这个问题的方式不同，我认为没有一个万能的答案。

* * *

解决这个问题的第二部分不一定是直截了当的。我不相信有一种万能的方法，并且没有足够的关于您的网站和环境的信息来建议最适合您的情况的解决方案。但是，我认为可以牢记一些注意事项，以帮助指导大多数情况下的部署。

在某些情况下，使整个站点（Web 服务器和数据库）脱机是一种选择。这无疑是管理更新最直接的方式。但是频繁的停机（即使是计划好的）可能是快速开展业务的好方法，即使是很小的代码更改也会让人厌烦，如果您有大型数据集和/或复杂的迁移，可能需要很多小时。也就是说，对于我帮助管理的网站（这些网站都是内部的，通常只在工作日的工作时间使用），这种方法效果很好。

如果您在主数据库的副本上进行更改，请小心。这里的主要问题是您的站点仍然存在，并且可能正在接受对数据库的写入。当您忙于迁移克隆以供以后使用时，写入主数据库的数据会发生什么情况？您的网站要么一直处于关闭状态，要么暂时处于只读状态，否则您将丢失它们。

如果您的更改是向后兼容的，并且您有一个网络农场，有时您可以通过更新实时生产数据库服务器（我认为在大多数情况下是不可避免的）然后通过将它们从农场中取出来逐步更新农场中的节点短期负载均衡器。这可以正常工作 - 但是这里的主要问题是，如果一个已经更新的节点发送一个旧节点不支持的 url 请求，您将失败，因为您无法在负载均衡器级别进行管理。

我已经看到/听到了其他几种效果很好的方法。

第一个是将所有代码更改包装在一个功能锁中，然后可以在运行时通过一些站点范围的配置选项进行配置。这实质上意味着您可以在关闭所有更改的情况下发布代码，然后在对服务器进行所有必要的更新后，您可以更改配置选项以启用该功能。但这会产生相当繁重的代码......

第二个是让代码管理迁移。我听说过一些网站，其中对代码的更改是以在运行时处理迁移的方式编写的。它能够检测正在使用的模式的版本，以及它返回的数据的格式——如果数据来自旧模式，它会进行适当的迁移，如果数据已经来自新模式，它什么也不做. 从自然站点使用情况来看，您的大部分数据将由使用该站点的人迁移，其余的您可以随时使用迁移脚本来完成。

但我认为此时谷歌成为你的朋友，因为正如我所说，解决方案是非常具体的，我担心这个答案会开始变得毫无意义......搜索“零停机时间部署”之类的东西，你会有很多想法会得到这样的结果[......](http://exortech.com/blog/2009/02/01/weekly-release-blog-11-zero-downtime-database-deployment/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T05:35:48.500

我将 South 用于具有约 40K 行代码库的生产服务器，到目前为止我们没有遇到任何问题。我们还对我们的一些模型进行了几次重大重构，并且我们的问题为零。

我们还拥有的一件事是对模型的版本控制，这有助于我们恢复对软件方面的模型所做的任何更改，而 South 更多地用于实际数据。我们使用[Django Reversion](https://github.com/etianen/django-reversion)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-08T16:09:28.263

我有时对这个问题采取了一种非常规的方法（阅读其他答案，也许它不是那么非常规）。我从来没有用 django 尝试过，所以我只是用它做了一些实验。

简而言之，我让代码捕获旧模式导致的异常并应用适当的模式升级。我不希望这是公认的答案——它只在某些情况下是合适的（有些人可能永远不会争辩）。但我认为它有一种丑小鸭的优雅。

当然，我有一个测试环境，我可以随时重置回生产状态。使用该测试环境，我像往常一样更新我的模式并针对它编写代码。

然后我恢复架构更改并再次测试新代码。我捕获了由此产生的错误，执行架构升级，然后重试错误查询。

必须编写升级函数，使其“无害”，这样如果它被多次调用（就像投入生产时可能发生的那样），它只会执行一次。

实际的 python 代码——我把它放在我的 settings.py 的末尾来测试这个概念，但你可能想把它放在一个单独的模块中：

```
from django.db.models.sql.compiler import SQLCompiler
from MySQLdb import OperationalError

orig_exec = SQLCompiler.execute_sql
def new_exec(self, *args, **kw):
    try:
        return orig_exec(self, *args, **kw)
    except OperationalError, e:
        if e[0] != 1054: # unknown column
            raise
        upgradeSchema(self.connection)
        return orig_exec(self, *args, **kw)
SQLCompiler.execute_sql = new_exec

def upgradeSchema(conn):
    cursor = conn.cursor()
    try:
        cursor.execute("alter table users add phone varchar(255)")
    except OperationalError, e:
        if e[0] != 1060: # duplicate column name
            raise 
```

一旦您的生产环境是最新的，您就可以自由地从您的代码库中删除此自我升级代码。但即使你不这样做，代码也不会做任何重要的不必要的工作。

您需要针对您的数据库引擎和架构更改定制异常类（在我的情况下为 MySQLdb.OperationalError）和数字（在我的情况下为 1054“未知列”/1060“重复列”），但这应该很容易。

您可能需要添加一些额外的检查以确保正在执行的 sql 实际上是由于有问题的架构更改而不是其他问题而出错，但即使您不这样做，这也应该重新引发不相关的异常。唯一的惩罚是，在这种情况下，您将在引发异常之前尝试两次升级和错误查询。

关于 python，我最喜欢的一件事是能够像这样在运行时轻松覆盖系统方法。它提供了很大的灵活性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-07T22:41:25.533

如果你的数据库是非平凡的并且 Postgresql 你有一大堆优秀的 SQL 选项，包括：

*   快照和回滚
*   实时复制到备份服务器
*   试用升级然后上线

试用升级选项很好（但最好与快照合作完成）

```
su postgres
pg_dump <db> > $(date "+%Y%m%d_%H%M").sql
psql template1
# create database upgrade_test template current_db
# \c upgradetest
# \i upgrade_file.sql
...assuming all well...
# \q
pg_dump <db> > $(date "+%Y%m%d_%H%M").sql # we're paranoid
psql <db>
# \i upgrade_file.sql 
```

如果你喜欢上面的安排，但你担心运行两次升级所花费的时间，你可以锁定*db*进行写入，然后如果升级到*upgradetest*顺利，你可以将*db*重命名为*dbold*并将*upgradetest*重命名为*db*。有很多选择。

如果您有一个 SQL 文件列出了您想要进行的所有更改，一个非常方便的 psql 命令`\set ON_ERROR_STOP 1`。这会在出现问题时停止升级脚本。而且，通过大量测试，您可以确保没有任何问题。

有很多可用的数据库模式差异工具，在[这个](https://stackoverflow.com/questions/2703862/postgresql-compare-databases-tool-or-generating-migration-script-util)StackOverflow 答案中注明了一些。但这基本上是很容易手工完成的......

```
pg_dump --schema-only production_db > production_schema.sql
pg_dump --schema-only upgraded_db > upgrade_schema.sql
vimdiff production_schema.sql upgrade_schema.sql
or
diff -Naur production_schema.sql upgrade_schema.sql > changes.patch
vim changes.patch (to check/edit) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-03T17:37:57.920

南方不是到处使用。就像在我的组织中一样，我们有 3 个级别的代码测试。一是本地开发环境，一是暂存开发环境，三是生产环境。

Local Dev 掌握在开发人员手中，他可以根据自己的需要进行游戏。然后是 staging dev，它与生产环境保持一致，当然，直到必须在实时站点上完成数据库更改，我们首先在 staging 上进行数据库更改，并检查一切是否正常，然后我们手动更改生产环境db 使其再次与 staging 相同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-02T20:47:48.563

如果它不是微不足道的，那么您应该拥有模仿生产数据库/应用程序的预生产数据库/应用程序。避免生产停机。

# php - 内容可编辑与输入替换

> ID：10826269
> 
> 赞同：6
> 
> 时间：2012-05-31T01:12:47.810
> 
> 标签：php, javascript, html, input

我正在开发一个应用程序，该应用程序将列出您之前保存的数据。如果您有错字，最初没有输入所有数据点等，您将有机会编辑数据块。

现在我有javascript获取给定块中每个元素的值（通过php中的foreach循环使用来自服务器的数据创建），将其保存到一个对象，然后用`<p>`textarea输入替换这些元素（）然后填充它来自之前抓取它的 js 对象的数据。

一方面，我在从动态内容中转义引号时遇到问题，但感觉这可能不是最优雅的解决方案。

进来内容可编辑。

基本上：我应该走那条路，只需单击“编辑”按钮就使数据块中的每个元素 contenteditable='true' 还是浏览器支持太可疑？

我目前的课程是一个可靠的计划吗？

还是有第三个（第四个、第五个等）选项？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T01:41:44.467

除非您特别需要用户编辑 HTML 内容（或进行复杂的语法高亮等），否则请使用 input/textarea 解决方案。更清洁，更轻巧，更容易做。Contenteditable 很快就会变得复杂，使用 tinyMCE 或类似的东西可能会有点矫枉过正。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:37:55.443

如果您使用过 JSfiddle，您就会知道 contentedible 的效果如何。这就是他们使用的。如果需要，可以使用 jQuery 插件来突出显示语法（Snippet、jquery-syntaxhighlighter）。

# php - 第一次使用后出现 CREATE TABLE 错误？

> ID：10826274
> 
> 赞同：0
> 
> 时间：2012-05-31T01:13:11.977
> 
> 标签：php, mysql

这段代码毫无问题地创建了第一个表，但随后抛出“Error Querying Database 2”，这是第二个 CREATE TABLE 查询的错误。语法看起来不错，但我对此比较陌生......

```
$dbc = mysqli_connect("localhost", "$dbuser", "$dbpass") or die('Error connecting to MySQL server.');
mysqli_select_db($dbc, "autoim9_codeaic");

$content = "CREATE TABLE content (id int NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), page varchar(255), html longtext)";
mysqli_query($dbc, $content) or die('Error querying database1');

$events = "CREATE TABLE events (id int NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), name varchar(255), date varchar(255), time varchar(255), location varchar(255), html longtext, img varchar(255), link varchar(255), target varchar(255), order int)";
mysqli_query($dbc, $events) or die('Error querying database2');

$spotlight = "CREATE TABLE spotlight (id int NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), title varchar(255), img varchar(255), link varchar(255), target varchar(255), order int)";
mysqli_query($dbc, $spotlight) or die('Error querying database3'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:14:19.260

`date`, `time`, 和`order`是 MySQL 中的保留关键字。您要么需要更改它们的名称，要么使用反引号 (`) 来转义它们。

```
$events = "CREATE TABLE events (id int NOT NULL AUTO_INCREMENT, PRIMARY KEY(id), name varchar(255), `date` varchar(255), `time` varchar(255), location varchar(255), html longtext, img varchar(255), link varchar(255), target varchar(255), `order` int)"; 
```

仅供参考，如果你在`varchar(255)`每个领域都使用你可能做错了。[日期和时间字段有自己的数据类型](http://dev.mysql.com/doc/refman/5.5/en/datetime.html)，应该相应地使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:15:51.527

“订单”是一个保留字，因此您需要用反引号括起来（或者最好选择一个稍微不同的字段名称）。

所以这实际上是你的 SQL 中的一个错误。

# c# - linq2entities 的 IQueryable 扩展方法

> ID：10826275
> 
> 赞同：6
> 
> 时间：2012-05-31T01:13:12.240
> 
> 标签：c#, linq, entity-framework, linq-to-entities

我正在尝试实现一种适用于 linq2entities 的扩展方法。我最初假设如果我的扩展方法采用并返回一个 IQueryable，并且只要我的表达式只使用支持的方法，那么它就可以正常工作。我遇到了很多麻烦，所以作为最后的手段，我复制了一个我知道可以工作的现有 .NET 扩展方法（FirstOrDefault）并简单地重命名它。看起来它会根据从方法返回的表达式而不是方法本身的名称来评估“无法转换为商店表达式”验证。

```
var prs = db.People.Where(p => p.PersonKey == 15).Select(p =>
  new
  {
    id = p.PersonKey,
    name1 = p.PersonHistories.AsQueryable().AsOf().Name
  } 
).ToList(); 
```

我的扩展方法，它只是我重命名的 FirstOrDefault 的副本：

```
public static TSource AsOf<TSource>(this IQueryable<TSource> source)
{
  return source.Provider.Execute<TSource>(Expression.Call(null, ((MethodInfo)MethodBase.GetCurrentMethod()).MakeGenericMethod(new Type[] { typeof(TSource) }), new Expression[] { source.Expression }));
} 
```

错误：

```
LINQ to Entities does not recognize the method 
'Models.PersonHistory AsOf[PersonHistory](System.Linq.IQueryable`1[Models.PersonHistory])' 
method, and this method cannot be translated into a store expression. 
```

如何实现 Linq2Entities 中支持的 IQueryable 扩展方法？

我真正想要 AsOf(source, DateTime asOf) 做的是类似的事情`source.FirstOrDefault<IHistory>(s => s.EndDate > asOf && asOf >= s.StartDate )`，但我不确定如何做到这一点，以便得到 linq2entities 的支持。

**LINQKIT：**这是我使用 linqkit 想出的，我希望我能以某种方式将其纳入更可重用的东西：

```
Expression<Func<PersonHistory, bool>> IsCurrent = (p) => p.Ends > DateTime.Now && p.Starts <= DateTime.Now;
var query = db.PersonHistories.Where(IsCurrent); 
```

1.  有一个更全局声明的表达式，而不是一个局部变量。
2.  添加一个 DateTime asOf 参数，而不是 .Now 硬编码。
3.  并且如果可能的话，将其改编成扩展方法（这种与＃1相同，只是扩展方法是理想的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T14:33:31.690

这应该可以在不扩展您的查询提供程序的情况下工作。它基本上将其分解为您的`IsCurrent`功能正在做什么。

```
public static class IQueryableExtensions
{
    public static IQueryable<T> IsCurrent<T>(this IQueryable<T> query,
        Expression<Func<T, DateTime?>> expressionEnd,
        Expression<Func<T, DateTime?>> expressionStart,
        DateTime asOf) where T : class
    {
        // Lambdas being sent in
        ParameterExpression paramEnd = expressionEnd.Parameters.Single();
        ParameterExpression paramStart = expressionStart.Parameters.Single();

        // GT Comparison
        BinaryExpression expressionGT = ExpressionGT(expressionEnd.Body, asOf);

        // LT Comparison
        BinaryExpression expressionLT = ExpressionLE(expressionStart.Body, asOf);

        query = query.Where(Expression.Lambda<Func<T, bool>>(expressionGT, paramEnd))
                     .Where(Expression.Lambda<Func<T, bool>>(expressionLT, paramStart));

        return query;
    }

    private static BinaryExpression ExpressionLE(Expression body, DateTime value)
    {
        return Expression.LessThanOrEqual(body, Expression.Constant(value, typeof(DateTime)));
    }

    private static BinaryExpression ExpressionGT(Expression body, DateTime value)
    {
        return Expression.GreaterThan(body, Expression.Constant(value, typeof(DateTime)));
    }
} 
```

并使用它

```
var query = db.PersonHistories.IsCurrent( p => p.Ends, 
                                          p => p.Starts, 
                                          DateTime.Now ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T01:35:24.160

我看到你评论了我对另一个问题的回答，所以我想我也会在这里回复。我对代码进行了一些修改和改进（支持编译查询和表达式替换的自定义扩展方法）。

这可以作为一个答案：

```
/// <summary>
/// Type helpers
/// </summary>
internal static class TypeSystem
{
    private static Type FindIEnumerable(Type seqType)
    {
        Type type;
        if (seqType == null || seqType == typeof(string) || seqType == typeof(byte[]))
        {
            return null;
        }
        else
        {
            if (!seqType.IsArray)
            {
                if (seqType.IsGenericType)
                {
                    Type[] genericArguments = seqType.GetGenericArguments();
                    int num = 0;
                    while (num < (int)genericArguments.Length)
                    {
                        Type type1 = genericArguments[num];
                        Type[] typeArray = new Type[1];
                        typeArray[0] = type1;
                        Type type2 = typeof(IEnumerable<>).MakeGenericType(typeArray);
                        if (!type2.IsAssignableFrom(seqType))
                        {
                            num++;
                        }
                        else
                        {
                            type = type2;
                            return type;
                        }
                    }
                }
                Type[] interfaces = seqType.GetInterfaces();
                if (interfaces != null && (int)interfaces.Length > 0)
                {
                    Type[] typeArray1 = interfaces;
                    int num1 = 0;
                    while (num1 < (int)typeArray1.Length)
                    {
                        Type type3 = typeArray1[num1];
                        Type type4 = TypeSystem.FindIEnumerable(type3);
                        if (type4 == null)
                        {
                            num1++;
                        }
                        else
                        {
                            type = type4;
                            return type;
                        }
                    }
                }
                if (!(seqType.BaseType != null) || !(seqType.BaseType != typeof(object)))
                {
                    return null;
                }
                else
                {
                    return TypeSystem.FindIEnumerable(seqType.BaseType);
                }
            }
            else
            {
                Type[] elementType = new Type[1];
                elementType[0] = seqType.GetElementType();
                return typeof(IEnumerable<>).MakeGenericType(elementType);
            }
        }
    }

    internal static Type GetElementType(Type seqType)
    {
        Type type = TypeSystem.FindIEnumerable(seqType);
        if (type != null)
        {
            return type.GetGenericArguments()[0];
        }
        else
        {
            return seqType;
        }
    }
}

/// <summary>
/// Marks an extension as compatible for custom linq expression expansion
/// Optionally if you can not write the extension method to fit your needs, you can provide a 
/// expression id constant for a registered expression.
/// </summary>
[AttributeUsage(AttributeTargets.Method, AllowMultiple= false, Inherited = false)]
class ExpandableQueryMethodAttribute :
    Attribute
{
    public ExpandableQueryMethodAttribute()
    {
    }
    public ExpandableQueryMethodAttribute(string expressionId)
    {
        _expressionId = expressionId;
    }

    private string _expressionId;
    public LambdaExpression TranslationExpression
    {
        get
        {
            return _expressionId != null ? QueryMethodTranslationExpressions.GetRegistered(_expressionId) : null;
        }
    }
}

/// <summary>
/// Used to register expressions for extension method to expression substitutions
/// </summary>
static class QueryMethodTranslationExpressions
{
    private static Dictionary<string, LambdaExpression> expressionList = new Dictionary<string, LambdaExpression>();

    /// <summary>
    /// Register expression
    /// </summary>
    /// <typeparam name="TFunc">type of expression delegate</typeparam>
    /// <param name="id">id constant for use with ExpandableQueryMethodAttribute</param>
    /// <param name="expr">expression</param>
    public static void RegisterExpression<TFunc>(string id, Expression<TFunc> expr)
    {
        expressionList.Add(id, expr);
    }

    public static LambdaExpression GetRegistered(string id)
    {
        //Extensions;
        return expressionList[id];
    }
}

static class Extensions
{
    /// <summary>
    /// Use on object sets before using custom extension methods, except inside compiled queries
    /// </summary>
    public static IQueryable<T> AsExtendable<T>(this IQueryable<T> source)
    {
        if (source is ExtendableQuery<T>)
        {
            return (ExtendableQuery<T>)source;
        }

        return new ExtendableQueryProvider(source.Provider).CreateQuery<T>(source.Expression);
    }
}

/// <summary>
/// Provides PlaceHolderQuery
/// 
/// No other functionality
/// </summary>
public class PlaceHolderQueryProvider : IQueryProvider
{
    public PlaceHolderQueryProvider()
    {
    }

    public IQueryable<TElement> CreateQuery<TElement>(Expression expression)
    {
        return new PlaceHolderQuery<TElement>(this, expression);
    }

    public IQueryable CreateQuery(Expression expression)
    {
        Type elementType = TypeSystem.GetElementType(expression.Type);
        try
        {
            return (IQueryable)Activator.CreateInstance(typeof(PlaceHolderQuery<>).MakeGenericType(elementType), new object[] { this, expression });
        }
        catch (System.Reflection.TargetInvocationException tie)
        {
            throw tie.InnerException;
        }
    }

    public TResult Execute<TResult>(Expression expression)
    {
        throw new NotImplementedException();
    }

    public object Execute(Expression expression)
    {
        throw new NotImplementedException();
    }
}

/// <summary>
/// Does nothing
/// 
/// Acts only as a holder for expression
/// </summary>
public class PlaceHolderQuery<T> : IQueryable<T>, IOrderedQueryable<T>
{

    private Expression _expression;
    private PlaceHolderQueryProvider _provider;

    public PlaceHolderQuery(PlaceHolderQueryProvider provider, Expression expression)
    {
        _provider = provider;
        _expression = expression;
    }

    public IEnumerator<T> GetEnumerator()
    {
        throw new NotImplementedException();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        throw new NotImplementedException();
    }

    public Type ElementType
    {
        get
        {
            return typeof(T);
        }
    }

    public Expression Expression
    {
        get
        {
            return _expression;
        }
    }

    public IQueryProvider Provider
    {
        get
        {
            return _provider;
        }
    }
}

/// <summary>
/// Walks the expression tree and invokes custom extension methods ( to expand them ) or substitutes them with custom expressions
/// </summary>
class ExtendableVisitor : ExpressionVisitor
{
    class ExpandingVisitor : ExpressionVisitor
    {
        private Dictionary<ParameterExpression, Expression> _substitutionDictionary;

        public ExpandingVisitor(Dictionary<ParameterExpression, Expression> subDict)
        {
            _substitutionDictionary = subDict;
        }

        protected override Expression VisitParameter(ParameterExpression node)
        {
            if (_substitutionDictionary != null && _substitutionDictionary.ContainsKey(node))
                return _substitutionDictionary[node];
            else
                return base.VisitParameter(node);
        }
    }

    IQueryProvider _provider;

    internal ExtendableVisitor()
    {
        _provider = new PlaceHolderQueryProvider();
    }

    protected override Expression VisitMethodCall(MethodCallExpression node)
    {
        ExpandableQueryMethodAttribute attrib = (ExpandableQueryMethodAttribute)node.Method.GetCustomAttributes(typeof(ExpandableQueryMethodAttribute), false).FirstOrDefault();

        if (attrib != null && node.Method.IsStatic)
        {

            if (attrib.TranslationExpression != null && attrib.TranslationExpression.Parameters.Count == node.Arguments.Count)
            {
                Dictionary<ParameterExpression, Expression> subDict = new Dictionary<ParameterExpression,Expression>();

                for (int i = 0; i < attrib.TranslationExpression.Parameters.Count; i++)
                {
                    subDict.Add(attrib.TranslationExpression.Parameters[i], node.Arguments[i]);
                }

                ExpandingVisitor expander = new ExpandingVisitor(subDict);

                Expression exp = expander.Visit(attrib.TranslationExpression.Body);

                return exp;
            }
            else if (typeof(IQueryable).IsAssignableFrom(node.Method.ReturnType))
            {
                object[] args = new object[node.Arguments.Count];
                args[0] = _provider.CreateQuery(node.Arguments[0]);

                for (int i = 1; i < node.Arguments.Count; i++)
                {
                    Expression arg = node.Arguments[i];
                    args[i] = (arg.NodeType == ExpressionType.Constant) ? ((ConstantExpression)arg).Value : arg;
                }

                Expression exp = ((IQueryable)node.Method.Invoke(null, args)).Expression;

                return exp;
            }
        }            

        return base.VisitMethodCall(node);
    }
}

/// <summary>
/// Used for query compilation
/// 
/// If custom extension methods are used, the existing CompileQuery functions do not work, so I had to write this.
/// </summary>
static class CompiledExtendableQuery
{
    public static Func<TContext, TResult>
               Compile<TContext, TResult>(
       Expression<Func<TContext, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TResult>
               Compile<TContext, TArg0, TResult>(
       Expression<Func<TContext, TArg0, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TResult>
               Compile<TContext, TArg0, TArg1, TResult>
      (Expression<Func<TContext, TArg0, TArg1, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TArg13, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TArg13, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TArg13, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

    public static Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TArg13, TArg14, TResult>
               Compile<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TArg13, TArg14, TResult>(
       Expression<Func<TContext, TArg0, TArg1, TArg2, TArg3, TArg4, TArg5, TArg6, TArg7, TArg8, TArg9, TArg10, TArg11, TArg12, TArg13, TArg14, TResult>> expr) where TContext : ObjectContext
    {
        return System.Data.Objects.CompiledQuery.Compile(expr.Update(new ExtendableVisitor().Visit(expr.Body), expr.Parameters));
    }

}

/// <summary>
/// The query as it becomes when AsExtendable is called on it.
/// </summary>
class ExtendableQuery<T> : IQueryable<T>, IOrderedQueryable<T>
{
    ExtendableQueryProvider _provider;
    Expression _expression;

    public ExtendableQuery(ExtendableQueryProvider provider, Expression expression)
    {
        _provider = provider;
        _expression = expression;
    }

    public IEnumerator<T> GetEnumerator()
    {
        return _provider.ExecuteQuery<T>(_expression).GetEnumerator();
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    public Type ElementType
    {
        get {
            return typeof(T);
        }
    }

    public Expression Expression
    {
        get {
            return _expression;    
        }
    }

    public IQueryProvider Provider
    {
        get {
            return _provider;
        }
    }

}

class ExtendableQueryProvider : IQueryProvider
{
    IQueryProvider _underlyingQueryProvider;

    private ExtendableQueryProvider()
    {
    }

    internal ExtendableQueryProvider(IQueryProvider underlyingQueryProvider)
    {
        _underlyingQueryProvider = underlyingQueryProvider;
    }

    public IQueryable<TElement> CreateQuery<TElement>(Expression expression)
    {
        return new ExtendableQuery<TElement>(this, expression);
    }

    public IQueryable CreateQuery(Expression expression)
    {
        Type elementType = TypeSystem.GetElementType(expression.Type);
        try
        {
            return (IQueryable)Activator.CreateInstance(typeof(ExtendableQuery<>).MakeGenericType(elementType), new object[] { this, expression });
        }
        catch (System.Reflection.TargetInvocationException tie)
        {
            throw tie.InnerException;
        }
    }

    internal IEnumerable<T> ExecuteQuery<T>(Expression expression)
    {
        return _underlyingQueryProvider.CreateQuery<T>(Visit(expression)).AsEnumerable();
    }

    public TResult Execute<TResult>(Expression expression)
    {
        return _underlyingQueryProvider.Execute<TResult>(Visit(expression));
    }

    public object Execute(Expression expression)
    {
        return _underlyingQueryProvider.Execute(Visit(expression));
    }

    private Expression Visit(Expression exp)
    {
        ExtendableVisitor vstr = new ExtendableVisitor();
        Expression visitedExp = vstr.Visit(exp);

        return visitedExp;
    }
} 
```

抱歉我的回复太简短了，现在是半夜，我得快点，因为有工作要做。

我很乐意回答您可能有的任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T23:23:46.673

而不是使用表达式，例如

```
Expression<Func<PersonHistory, bool>> IsCurrent = (p)
    => p.Ends > DateTime.Now && p.Starts <= DateTime.Now;

var query = db.PersonHistories.Where(IsCurrent); 
```

您可以定义扩展方法，例如：

```
public static IsCurrent Func<
    IQueryable<PersonHistory>, DateTime, IQueryable<PersonHistory>
    >()
{
    return (IQueryable<PersonHistory> query, DateTime referenceDate) =>
        query.Where(p.Ends > referenceDate && p.Starts <= referenceDate);
} 
```

像这样使用它：

```
var query = IsCurrent();

var results = query(context.PeoplesHistory, referenceDate); 
```

或者：

```
var results = query(previousResults, referenceDate); 
```

或者：

```
public static IsCurrent Func<IQueryable<PersonHistory>, IQueryable<PersonHistory>>(
    DateTime referenceDate)
{
    return (IQueryable<PersonHistory> query) =>
        query.Where(p.Ends > referenceDate && p.Starts <= referenceDate);
}

var query = IsCurrent(refernceDate);

var results = query(context.PeoplesHistory); 
```

这样您就不需要构建表达式的框架。

# graphics - 3D系统翻译

> ID：10826278
> 
> 赞同：1
> 
> 时间：2012-05-31T01:14:04.190
> 
> 标签：graphics, geometry, computer-vision

我有一个 xy 坐标系

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:30:47.457

![在此处输入图像描述](../Images/27af33c033065623207fd88e6f83de36.png)

这张图应该代表你告诉我的。关键点，是在 CS1 中表达 [x2],[y2]。（我不能在这里使用乳胶，所以我们假设 [A] 表示向量 A，|A| 是向量 A 的长度）

[v2] = v2x * [x2] + v2y * [y2]

由于我们已经很好地定义了 [v1] 和 [d2]，我们可以计算 [x']

[x`] = [d2] - [v1]

从 [x'] 我们可以计算 x2

[x2] = (|x2|/|x'|) *[x`] = (|x1|/|x'|)* [x'] 因为 |x1| = |x2|

从 x2 我们可以计算出 y2，虽然我不记得如何了。这是一个简单的 90° 旋转。应该是这样的：

y2x = - x2y y2y = x2x

一旦我们在 CS1 中表达了 x2,y2，我们就可以计算 v2

v2 = v2x * [x2] + v2y * [y2] = v2x * (x2x*[x1]+x2y*[y1]) + v2y * (y2x*[x1]+y2y*[y1]) = (v2x x2x *+ v2y* y2x)[x1] + (v2x *x2y + v2y* y2y) [y1] // 希望我没有在这里犯任何错误 :)

最后

[X] = [v1] + [v2]

我认为最好的选择是创建一个向量类并使用向量代数进行所有数学运算。您只需要定义 3 个操作：Addition、ScalarMultiplication、90Rotation。

# objective-c - 如何在 NSImageView 中实现 NSImage 的连续旋转？

> ID：10826288
> 
> 赞同：9
> 
> 时间：2012-05-31T01:15:28.387
> 
> 标签：objective-c, macos, cocoa, core-animation, quartz-2d

## 未来的观众：

我已经设法完成了这个旋转动画，并且可以在这个问题上找到带有描述的代码。[NSView 中的 NSImage 旋转不起作用](https://stackoverflow.com/questions/10836131/nsimage-rotation-in-nsview-is-not-working)

在您继续之前，请投票[Duncan C](https://stackoverflow.com/users/205185/duncan-c)的答案。当我设法从他的回答中实现这种轮换时。

* * *

我有这样的图

![在此处输入图像描述](../Images/53b9bf523a0d8937b42d66b756bc5ae9.png)

我想在不同的线程上继续旋转这个同步图标。现在我尝试使用 Quartz composer 并将动画添加到 QCView 但它的效果非常疯狂而且也很慢。

## 问题 ：

如何以非常少的处理费用连续旋转此图像？

### 努力

我阅读了 CoreAnimation、Quartz2D 文档，但我没有找到让它工作的方法。到目前为止我唯一知道的是，我必须使用

*   图层
*   CAImageRef
*   仿射变换
*   NSAnimationContext

现在，我并不期待代码，但是对伪代码的理解会很棒！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-31T02:08:10.000

让物体旋转超过 180 度实际上有点棘手。问题是您为结束旋转指定了一个变换矩阵，而系统决定向另一个方向旋转。

我所做的是创建一个小于 180 度的 CABasicAnimation，设置为相加，并具有重复计数。动画中的每一步都会为对象设置更多动画。

以下代码取自 iOS 应用程序，但在 Mac OS 中该技术是相同的。

```
 CABasicAnimation* rotate =  [CABasicAnimation animationWithKeyPath: @"transform.rotation.z"];
  rotate.removedOnCompletion = FALSE;
  rotate.fillMode = kCAFillModeForwards;

  //Do a series of 5 quarter turns for a total of a 1.25 turns
  //(2PI is a full turn, so pi/2 is a quarter turn)
  [rotate setToValue: [NSNumber numberWithFloat: -M_PI / 2]];
  rotate.repeatCount = 11;

  rotate.duration = duration/2;
  rotate.beginTime = start;
  rotate.cumulative = TRUE;
  rotate.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear]; 
```

CAAnimation 对象对图层进行操作，因此对于 Mac OS，您需要在界面生成器中设置“想要图层”属性，然后将动画添加到视图的图层。

为了让您的视图永远旋转，您需要将重复计数设置为一个非常大的数字，例如 1e100。

创建动画后，您可以使用如下代码将其添加到视图层：

```
[myView.layer addAnimation: rotate forKey: @"rotateAnimation"]; 
```

这就是它的全部内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-04T19:22:18.440

更新：

我最近了解到另一种处理大于 180 度的旋转或连续旋转的方法。

有一个称为 CAValueFunction 的特殊对象，可让您使用任意值（包括指定多个完整旋转的值）对图层的变换进行更改。

您创建图层变换属性的 CABasicAnimation，但随后提供的值不是提供变换，而是提供新旋转角度的 NSNumber。如果您提供像 20pi 这样的新角度，您的图层将旋转 10 个完整旋转（2pi/旋转）。代码如下所示：

```
//Create a CABasicAnimation object to manage our rotation.
CABasicAnimation *rotation = [CABasicAnimation animationWithKeyPath:@"transform"];

rotation.duration = 10.0;
CGFLOAT angle = 20*M_PI;

//Set the ending value of the rotation to the new angle.
rotation.toValue = @(angle);

//Have the rotation use linear timing.
rotation.timingFunction = 
  [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];

/*
 This is the magic bit. We add a CAValueFunction that tells the CAAnimation we are 
 modifying the transform's rotation around the Z axis.
 Without this, we would supply a transform as the fromValue and toValue, and 
 for rotations > a half-turn, we could not control the rotation direction.

 By using a value function, we can specify arbitrary rotation amounts and 
 directions and even rotations greater than 360 degrees.
*/

rotation.valueFunction = 
  [CAValueFunction functionWithName: kCAValueFunctionRotateZ];

/*
 Set the layer's transform to it's final state before submitting the animation, so 
 it is in it's final state once the animation completes.
*/
imageViewToAnimate.layer.transform = 
  CATransform3DRotate(imageViewToAnimate.layer.transform, angle, 0, 0, 1.0);

[imageViewToAnimate.layer addAnimation:rotation forKey:@"transform.rotation.z"]; 
```

（我从一个工作示例应用程序中提取了上面的代码，并取出了一些与主题没有直接关系的东西。您可以在 github 上的项目[**KeyframeViewAnimations**](https://github.com/DuncanMC/KeyframeViewAnimations) （链接）中看到正在使用的此代码。执行旋转的代码在一个名为“handleRotate”的方法中

# java - 通过 Spring 进行 RESTful 身份验证

> ID：10826293
> 
> 赞同：268
> 
> 时间：2012-05-31T01:16:16.537
> 
> 标签：java, spring, rest, spring-mvc, spring-security

**问题：**
我们有一个基于 Spring MVC 的 RESTful API，其中包含敏感信息。API 应该是安全的，但是在每个请求中都发送用户的凭据（用户/密码组合）是不可取的。根据 REST 准则（和内部业务要求），服务器必须保持无状态。该 API 将由另一台服务器以 mashup 风格的方式使用。

**要求：**

*   `.../authenticate`客户端使用凭据向（不受保护的 URL）发出请求；服务器返回一个安全令牌，其中包含足够的信息供服务器验证未来的请求并保持无状态。这可能包含与 Spring Security 的[Remember-Me Token](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/remember-me.html)相同的信息。

*   客户端向各种（受保护的）URL 发出后续请求，将先前获得的令牌附加为查询参数（或者，不太理想的是，附加一个 HTTP 请求标头）。

*   不能期望客户端存储 cookie。

*   由于我们已经使用 Spring，所以解决方案应该使用 Spring Security。

我们一直在努力解决这个问题，所以希望有人已经解决了这个问题。

鉴于上述情况，您将如何解决这一特殊需求？

* * *

## 回答 #1

> 赞同：192
> 
> 时间：2012-06-02T16:33:25.613

我们设法让这个工作完全按照 OP 中的描述工作，希望其他人可以使用该解决方案。这是我们所做的：

像这样设置安全上下文：

```
<security:http realm="Protected API" use-expressions="true" auto-config="false" create-session="stateless" entry-point-ref="CustomAuthenticationEntryPoint">
    <security:custom-filter ref="authenticationTokenProcessingFilter" position="FORM_LOGIN_FILTER" />
    <security:intercept-url pattern="/authenticate" access="permitAll"/>
    <security:intercept-url pattern="/**" access="isAuthenticated()" />
</security:http>

<bean id="CustomAuthenticationEntryPoint"
    class="com.demo.api.support.spring.CustomAuthenticationEntryPoint" />

<bean id="authenticationTokenProcessingFilter"
    class="com.demo.api.support.spring.AuthenticationTokenProcessingFilter" >
    <constructor-arg ref="authenticationManager" />
</bean> 
```

如您所见，我们创建了一个 custom `AuthenticationEntryPoint`，`401 Unauthorized`如果请求没有在过滤器链中被我们的`AuthenticationTokenProcessingFilter`.

**自定义身份验证入口点**：

```
public class CustomAuthenticationEntryPoint implements AuthenticationEntryPoint {
    @Override
    public void commence(HttpServletRequest request, HttpServletResponse response,
            AuthenticationException authException) throws IOException, ServletException {
        response.sendError( HttpServletResponse.SC_UNAUTHORIZED, "Unauthorized: Authentication token was either missing or invalid." );
    }
} 
```

**AuthenticationTokenProcessingFilter**：

```
public class AuthenticationTokenProcessingFilter extends GenericFilterBean {

    @Autowired UserService userService;
    @Autowired TokenUtils tokenUtils;
    AuthenticationManager authManager;

    public AuthenticationTokenProcessingFilter(AuthenticationManager authManager) {
        this.authManager = authManager;
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException {
        @SuppressWarnings("unchecked")
        Map<String, String[]> parms = request.getParameterMap();

        if(parms.containsKey("token")) {
            String token = parms.get("token")[0]; // grab the first "token" parameter

            // validate the token
            if (tokenUtils.validate(token)) {
                // determine the user based on the (already validated) token
                UserDetails userDetails = tokenUtils.getUserFromToken(token);
                // build an Authentication object with the user's info
                UsernamePasswordAuthenticationToken authentication = 
                        new UsernamePasswordAuthenticationToken(userDetails.getUsername(), userDetails.getPassword());
                authentication.setDetails(new WebAuthenticationDetailsSource().buildDetails((HttpServletRequest) request));
                // set the authentication into the SecurityContext
                SecurityContextHolder.getContext().setAuthentication(authManager.authenticate(authentication));         
            }
        }
        // continue thru the filter chain
        chain.doFilter(request, response);
    }
} 
```

显然，**`TokenUtils`**包含一些私密（并且非常特定于案例）代码并且不能轻易共享。这是它的界面：

```
public interface TokenUtils {
    String getToken(UserDetails userDetails);
    String getToken(UserDetails userDetails, Long expiration);
    boolean validate(String token);
    UserDetails getUserFromToken(String token);
} 
```

这应该让你有一个好的开始。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-05-31T02:43:21.943

您可能会考虑[Digest Access Authentication](https://www.rfc-editor.org/rfc/rfc2617#section-3)。基本上协议如下：

1.  请求来自客户端
2.  服务器以唯一的 nonce 字符串响应
3.  客户端提供了一个用户名和密码（以及一些其他值）md5 与随机数散列；这个哈希被称为 HA1
4.  服务器然后能够验证客户的身份并提供所请求的材料
5.  与 nonce 的通信可以继续，直到服务器提供新的 nonce（计数器用于消除重放攻击）

所有这些通信都是通过标头进行的，正如 jmort253 指出的那样，通常比在 url 参数中传达敏感材料更安全。

[Spring Security](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#digest-processing-filter)支持摘要访问身份验证。请注意，尽管文档说您必须有权访问客户端的纯文本密码，但[如果您拥有客户端的 HA1 哈希](https://jira.springsource.org/browse/SEC-1905)，则可以成功进行身份验证。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-03-28T10:01:28.897

关于携带信息的令牌，JSON Web Tokens ( [http://jwt.io](http://jwt.io) ) 是一项出色的技术。主要概念是将信息元素（声明）嵌入到令牌中，然后对整个令牌进行签名，以便验证端可以验证声明确实可信。

我使用这个 Java 实现：[https ://bitbucket.org/b_c/jose4j/wiki/Home](https://bitbucket.org/b_c/jose4j/wiki/Home)

还有一个 Spring 模块（spring-security-jwt），但我还没有研究它支持什么。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-24T04:43:04.313

为什么不开始使用带有 JSON WebTokens 的 OAuth

[http://projects.spring.io/spring-security-oauth/](http://projects.spring.io/spring-security-oauth/)

OAuth2 是一种标准化的授权协议/框架。根据官方 OAuth2[规范](https://www.rfc-editor.org/rfc/rfc6749)：

[你可以在这里](https://www.slideshare.net/vaquarkhan1/microservice-with-oauth2)找到更多信息

# iphone - CATiledLayer 和 UIScrollView，缓存一些缩放级别的旧数据

> ID：10826296
> 
> 赞同：2
> 
> 时间：2012-05-31T01:16:22.793
> 
> 标签：iphone, objective-c, ios, core-graphics, quartz-2d

我设置了一个 CATiledLayer 来动态重新绘制一些我用 Quartz 创建的图形。

这个视图被添加为滚动视图的内容视图，当我滚动和缩放图形时，它会以适当的分辨率重新绘制，并且完全符合我的预期。

我的问题是，如果我更改生成图形的值（它是类似结构的图形的可视化），然后 setNeedsDisplay 在视图上，更改将应用​​并以某些缩放级别显示，但如果你缩小它会显示生成的旧图形。再次放大会回到正确的图形。

我假设正在缓存切片图层中的不同缩放级别，因此更新不会应用于已缓存的缩放级别。

我的问题是，如果是这种情况，有没有办法强制 CATiledLayer 不从缓存数据中重绘？如果没有，有谁知道可能导致问题的原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T17:51:53.110

不知道你是否还有这个问题，但我最近自己也遇到过。这似乎与[更改图像时清除 CATiledLayers 缓存](https://stackoverflow.com/questions/1274680/clear-catiledlayers-cache-when-changing-images)相同的问题答案似乎是将 layer.content 设置为 nil，然后使用 setNeedsDisplay 或 setNeedsDisplayInRect: 调用刷新。因此，无论您在想要清除视图后调用 setNeedsDisplay 来刷新视图，您都可以使用：

```
layer.content = nil;
[layer setNeedsDisplay]; 
```

这似乎对我有用，尽管在上述链接问题的答案的评论中有警告不要直接设置 layer.content 属性。除了可能删除和重新添加图层之外，尽管我无法提出任何其他选项。

# sql - SQL 多重排序和分组

> ID：10826299
> 
> 赞同：1
> 
> 时间：2012-05-31T01:18:00.107
> 
> 标签：sql, doctrine, dql

编辑：我正在使用 DQL

我正在寻求有关 SQL 查询的帮助。

我的表有一个电影列表，每个电影都有一个标题、seriesName 和 seriesNumber。是否可以对它们进行排序，以便标题按 AZ 列出，但是当一个系列出现时，该系列被组合在一起，系列名称按字母顺序排列，就好像它在电影标题列中一样，系列中的条目按系列编号排序。

不好的解释，但基本上我想要的是：

```
MovieTitle                  SeriesName          SeriesNumber
Blade Runner                NULL                NULL
District 9                  NULL                NULL
Hot Fuzz                    NULL                NULL
I am Legend                 NULL                NULL
Fellowship of the Ring      Lord of the Rings   1
Two Towers, The             Lord of the Rings   2
Return of the King          Lord of the Rings   3
Lost in Translation         NULL                NULL
Matrix, The                 Matrix              1
Matrix Reloaded, The        Matrix              2
Matrix Revolutions, The     Matrix              3
Requiem for a Dream         NULL                NULL
This is Spinal Tap          NULL                NULL
Zodiac                      NULL                NULL 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:21:36.597

```
SELECT * FROM x
ORDER BY CASE 
   WHEN SeriesName is NOT NULL THEN SeriesName ELSE MovieTitle  END
   , SeriesNumber 
```

你可能必须这样做

```
SELECT * FROM(
  SELECT *, CASE WHEN SeriesName is NOT NULL THEN SeriesName ELSE MovieTitle END SortOrder  FROM x
)
ORDER BY SortOrder,SeriesNumber 
```

# file - 在 Linux 中使用 QTextStream 进行异常文件读取操作

> ID：10826304
> 
> 赞同：1
> 
> 时间：2012-05-31T01:18:34.530
> 
> 标签：file, qt, stream, seek, file-read

我正在使用 linux 平台 (Ubuntu) 和 QT4.7.4 ，

首先，我使用 vi 创建了一个测试文件“test.txt”，只需在其中写入 100000 行“1234567890”，

然后我编译并运行下面的代码，在我的监督下，它进入无限循环，

有什么想法吗？谢谢！

```
int main(int argc, char *argv[])
{
    QCoreApplication app(argc, argv);
    QString str;

    QFile file("./test.txt");
    if ( file.open(QIODevice::ReadOnly | QIODevice::Text) ) {

        QTextStream ts( &file );
        while(!ts.atEnd()) {
            str = ts.read(10240);
            qDebug()<<"s:"<<ts.status()<<":"<<ts.atEnd()<<":"<<str.count()<<":"<<ts.pos();

        }
    }
    return app.exec();
} 
```

这是 qdebug 输出：

```
s: 0 : false : 10240 : 10240 
s: 0 : false : 10240 : 20480 
s: 0 : false : 10240 : 51200 
s: 0 : false : 10240 : 112640 
s: 0 : false : 10240 : 235520 
s: 0 : false : 10240 : 481280 
s: 0 : false : 10240 : 972800 
s: 0 : false : 10240 : -1 
s: 0 : false : 10240 : -1 
s: 0 : false : 10240 : -1 
s: 0 : false : 10240 : -1 
s: 0 : false : 10240 : -1 
s: 0 : false : 10240 : -1 
s: 0 : false : 10240 : -1 
.... 
```

这里有一些关于 test.txt 的信息

```
$du  -sh test.txt 
1.1M    test.txt

$wc -c test.txt 
1100011 test.txt

$du -S test.txt 
1076    test.txt 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T04:11:06.223

不知何故，您的搜索指针在某处丢失了轨道。这可能是在函数内部调用 seek`pos()`函数。

所以试着在每次迭代中手动寻找你的指针。我建议在迭代中读取小块数据。

试试这个

```
 int pos=0;
       QTextStream ts( &file );
       while(!ts.atEnd()) {
           pos+=5120;
           {
               str = ts.read(5120);

               qDebug()<<"s:"<<ts.status()<<":"<<ts.atEnd()<<":"<<str.count()<<":"<<ts.pos();
               ts.seek(pos);//manually seeking to current position
           }

       } 
```

这应该有效。

您将`s: 0 : true : (final-chunk-data-size) : (size-of-your-test.txt-file)`在 qdebug 输出中看到最后一行。

问题在于`ts.pos();`由于`line` `qDebug()<<"s:"<<ts.status()<<":"<<ts.atEnd()<<":"<<str.count()<<":"<<ts.pos();` QTextStream 是缓冲的，因此 pos() 函数可能必须寻找设备以重建有效的设备位置。[如果您结合使用 QFile 和 TextStream，文本流的内部位置可能会与文件的位置不同步，这样 pos() 函数内部使用的这个 seek 函数可能会出错！！]

因此，如果您使用它而不调用`ts.pos()`它就可以了。您不必手动`seek`. 否则，如果添加 ts.pos()，则应手动添加`seek`.

查看 pos 输出的顺序，它总是在每次 pos() 调用中将 (10240 + 前一个位置) 添加到前一个位置值。这意味着它在每个 pos() 调用中都会跳跃一定数量的先前位置值，因为它与文件的位置不同步一定数量的先前 pos。因此，如果您调用 pos()，则不同步会反映在您的 texstream 对象中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T09:55:51.370

这是 中[的一个错误`QTextStream::pos`](https://bugreports.qt-project.org/browse/QTBUG-9814)，它阻止使用`pos()`大于 16KB 的文件（我认为），它似乎已在 Qt 4.7 和 4.8 之间[修复。](http://qt.gitorious.org/qt/qt/commit/17a4f332f0d416af842145f0ebc7f2ebe7f33527)

但无论如何，`QTextStream::pos()`在该循环内使用会严重影响阅读速度，因此，您应该避免使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T05:48:42.213

您尝试读取的文件似乎有问题。检查 test.txt 的文件编码。如果您看到读取的数据大小，您将看到读取的文本异常，读数从 20K 移动到 50K 再到 100K。

代码很好，对我有用。

# jquery - jQ Auto Grow Text Area 问题 - 延迟扩展和填充问题

> ID：10826305
> 
> 赞同：0
> 
> 时间：2012-05-31T01:18:35.723
> 
> 标签：jquery, iphone, web-applications, plugins, settimeout

我已经在**iPhone 我的网络应用程序**中实现了一个标准的 jQuery 自动增长/扩展 textarea 插件。它工作正常，除了两个问题**（如下所列）**。首先，请允许我强调一下，我已经尝试了谷歌搜索并尝试了不同的教程，并得出结论，这是最适合我需要的教程。

**问题 1\. 延迟扩展 textarea onKeyUp。如何？**在 keyup 上调用函数 expand：

```
 $(this).keyup(update); 
```

由于我使用 CSS3 动画 (-webkit-transition) 为扩展设置动画，并且由于站点/“应用程序”是为 iPhone 构建的，因此我需要将此操作延迟 500 毫秒，以便打字不会因此而滞后。我在代码的不同部分尝试了不同的解决方案，例如 setTimeOut，甚至延迟等，但它不起作用。时期。

**问题 2：textarea 上的填充会导致其随机扩展，并且扩展为应有的两倍。**

```
 padding:10px 10px; 
```

这是一个已知问题 - 我知道，但到目前为止，似乎知道一个人还没有弄清楚如何正确处理它。删除填充使一切正常。在不建议我使用另一个插件或只是删除填充的情况下，如何更改代码以使其与填充一起使用？

**处理扩展的 JS 代码：**

```
 (function($) {

/*
 * Auto-growing textareas; technique ripped from Facebook
 */
$.fn.autogrow = function(options) {

    this.filter('textarea').each(function() {

        var $this       = $(this),
            minHeight   = $this.height(),
            lineHeight  = $this.css('lineHeight');

        var shadow = $('<div></div>').css({
            position:   'absolute',
            top:        -10000,
            left:       -10000,
            width:      $(this).width(),
            fontSize:   $this.css('fontSize'),
            fontFamily: $this.css('fontFamily'),
            lineHeight: $this.css('lineHeight'),
            resize:     'none'
        }).appendTo(document.body);

        var update = function() {

            var val = this.value.replace(/</g, '&lt;')
                                .replace(/>/g, '&gt;')
                                .replace(/&/g, '&amp;')
                                .replace(/\n/g, '<br/>');

            shadow.html(val);

            $(this).css('height', Math.max(shadow.height() + 15, minHeight));
            $("#guestInfoNameLable").css('height', Math.max(shadow.height() + 15, minHeight));
        }

         var fix = function() {

            var val = this.value.replace(/</g, '&lt;')
                                .replace(/>/g, '&gt;')
                                .replace(/&/g, '&amp;')
                                .replace(/\n/g, '<br/>');

            shadow.html(val);
            $(this).css('height', minHeight);
            $("#guestInfoNameLable").css('height', minHeight);
        }

        $(this).keyup(update);
        $(this).change(fix);
        //$(this).change(update).keyup(update).keydown(update);

        update.apply(this);

    });

    return this;

}

})(jQuery); 
```

**HTML 表单：**

```
 <div class="guestInfoLabel" id="guestInfoNameLable">guest</div>
 <textarea id="guestInfoName" autocomplete="off" autocorrect="off"></textarea> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T22:44:02.553

**我最终编写了自己的“插件”** ——10 行！*这里适用于所有寻找简单、轻量级插件的人，该插件适用于元素填充和大多数输入类型。*它可能不是完美无缺*的，但它确实有效。

**工作原理：** OnKeyUp，调用函数*getInputStr*设置超时并调用处理扩展的函数：*expandElement*。此函数计算 \n 的数量，即换行符，并为每个换行符扩展/收缩文本区域 20 像素。如果 textarea 包含超过 8 个换行符，它将停止扩展 (maxHeight)。我在 textArea 上添加了 CSS3 动画以使扩展运行更顺畅，但这当然是完全可选的。这是代码：

```
 -webkit-transition: height 0.6s;
  -webkit-transition-timing-function: height 0.6s; 
```

**第 1 部分：**文本区域 (HTML)

```
 <textarea id="guestInfoName" autocomplete="off" autocorrect="off" onKeyUp="getInputStr(this.value)" onBlur="resetElHeight()" onFocus="expandElement(this.value)"></textarea> 
```

**第 2 部分** *（可选）*：**设置超时**- 以避免文本区域在仍在键入时扩展。(Javascript)

```
//global variables
var timerActivated = false;
var timeOutVariable = "";

function getInputStr(typedStr) {

//call auto expand on delay (350 ms)

if(timerActivated){
    clearTimeout(timeOutVariable);
    //call textarea expand function only if input contains line break
    if((typedStr.indexOf("\n") != -1)) {
        timeOutVariable=setTimeout(function() { expandTxtArea(typedStr); },350);
    }
}
else {
    if((typedStr.indexOf("\n") != -1)) {
        timeOutVariable=setTimeout(function() { expandTxtArea(typedStr); },350);
        timerActivated = true;
    }
}
//auto grow txtArea 
} 
```

**第 3 部分**：**扩展文本区域**(Javascript)

```
function expandTxtArea(typedStr) {
var nrOfBrs = (typedStr.split("\n").length - 1);
var txtArea = $("#guestInfoName");
var label = $("#guestInfoNameLable");
var newHeight = (20 * (nrOfBrs+1));

//console.log("nr of line breaks: " + nrOfBrs); console.log("new height: " + newHeight);

//setting maxheight to 8 BRs
if(nrOfBrs < 9) {
    txtArea.css("height", newHeight); 
    label.css("height",newHeight);
} else {
    txtArea.css("height", 180); 
    label.css("height",180);
}

} 
```

就是这样的人。希望这可以帮助有类似问题的人！

# mysql - 这些 SQL 查询之间有什么区别吗？

> ID：10826309
> 
> 赞同：1
> 
> 时间：2012-05-31T01:19:00.367
> 
> 标签：mysql, sql

他们做同样的事情，但我想知道是否有一些区别，我的意思是关于性能......

**TB1**：tb1_id -> PK ...

**TB2**：tb1_id -> FK ...

```
select columns ... from tb1 a left join tb2 b
    on a.tb1_id=b.tb1_id and b.uid=xxxxxxx where a.tb1_id=yyy limit 1

select columns ... from tb1 a left join tb2 b
    on a.tb1_id=b.tb1_id where a.tb1_id=yyy and b.uid=xxxxxxx limit 1 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:36:06.353

稍微简化一下，您可以认为`JOIN`首先评估您的 s ，然后`WHERE`应用 s 过滤器。使用这个公式：

1）您的第一个查询将返回表中的所有记录和表中`a`的相应记录`b`（如果存在，否则为一组`NULL`s），这些记录在字段中具有匹配`tb1_id`和特定值`uid`。然后，结果集将被过滤为只有记录`a.tb1_id=yyy`和第一条记录返回给客户端。

2）您的第二个查询将返回 table 中的所有记录以及 table中具有匹配的`a`相应记录`b`（如果存在，否则为一组s） 。结果集将被过滤掉，只包含具有特定值 in和特定值 in 的记录。最后一部分很重要。此特定条件将丢弃表中没有匹配集的所有记录，因为. 本质上，**您不会将 a****与****.** **当您这样做时，您会立即将您的****join 转换为****one**。剩余集合的第一条记录将返回给客户端。`NULL``tb1_id``a.tb1_id``b.uid``a``b``NULL != xxxxxxx`**`LEFT JOIN``WHERE``OUTER``INNER`**

也就是说，在您的情况下，您可能会得到相同的结果。巧合的是。您的查询中没有`ORDER BY`，因此返回的记录顺序取决于数据库引擎（您最好认为它不是确定性的，不能依赖，它很可能是这样的），它只是可能碰巧两个查询返回的第一条记录是匹配所有条件的记录-在和中都有`tb1_id`匹配项，在.`a``b``xxxxxxx``b.uid`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T03:02:27.360

他们不一样。请参阅@Pavel_Veller 提供的答案这只是为了支持他的答案。在 Postgres 上运行：

```
create table tb1( tb1_id int );
create table tb2( tb1_id int, uid int );

insert into tb1 values( 1 );

insert into tb2 values( 1, 0 );

select a.tb1_id
  from tb1 a left join tb2 b on a.tb1_id = b.tb1_id and b.uid = 3
  where a.tb1_id = 1;

select a.tb1_id
  from tb1 a left join tb2 b on a.tb1_id = b.tb1_id
  where a.tb1_id = 1
    and b.uid = 3; 
```

结果：

```
postgres=#     select a.tb1_id
postgres-#       from tb1 a left join tb2 b on a.tb1_id = b.tb1_id and b.uid = 3
postgres-#       where a.tb1_id = 1;
 tb1_id
--------
      1
(1 row)

postgres=#     select a.tb1_id
postgres-#       from tb1 a left join tb2 b on a.tb1_id = b.tb1_id
postgres-#       where a.tb1_id = 1
postgres-#         and b.uid = 3;
 tb1_id
--------
(0 rows) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T02:40:45.147

在没有注意到 JOIN 的“LEFT”部分之后，我怀疑我原来的答案。经过一些快速研究，我修改了我的答案。

这篇[文章](http://www.mysqldiary.com/mysql-left-join/)详细解释了事情，表明查询实际上是不同的。

下面的文章中的示例显示了这一点。

```
mysql> SELECT * FROM product LEFT JOIN product_details
   ON (product.id = product_details.id)
   AND product_details.id=2;
+----+--------+------+--------+-------+
| id | amount | id   | weight | exist |
+----+--------+------+--------+-------+
|  1 |    100 | NULL |   NULL |  NULL |
|  2 |    200 |    2 |     22 |     0 |
|  3 |    300 | NULL |   NULL |  NULL |
|  4 |    400 | NULL |   NULL |  NULL |
+----+--------+------+--------+-------+
4 rows in set (0.00 sec)

mysql> SELECT * FROM product LEFT JOIN product_details
   ON (product.id = product_details.id)
   WHERE product_details.id=2;
+----+--------+----+--------+-------+
| id | amount | id | weight | exist |
+----+--------+----+--------+-------+
|  2 |    200 |  2 |     22 |     0 |
+----+--------+----+--------+-------+
1 row in set (0.01 sec) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T01:28:49.913

这两个查询根本不做同样的事情，第一个查询可能不会从 b 返回任何行，而第二个查询不会从 a 或 b 返回任何行，如果没有与 b 的有效连接。

Mysql 将 where 子句中的“=”解释为一个 INNER 连接（它不是一个连接，但在这种情况下它的使用方式相同）

# php - 是否有用于生成有效 PHP 表达式的 PHP 打印函数？

> ID：10826311
> 
> 赞同：2
> 
> 时间：2012-05-31T01:19:24.290
> 
> 标签：php

我正在寻找一种让 PHP 以一种可以作为作业包含到我的（测试）代码中的形式打印出任意数组的方法。

print_r 产生例如：

```
Array
(
[0] => qsr-part:1285
[1] => qsr-part:1286
) 
```

这几乎但不完全有效。

我需要例如：

```
array('qsr-part:1285', 'qsr-part:1286') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T01:22:00.847

[`var_export()`](http://www.php.net/manual/en/function.var-export.php)正是这样做的：它将一个值作为字符串导出到其 PHP 表示中。

请注意，数组始终作为关联的键值对导出，因此您会得到类似的结果，但无论哪种方式都无关紧要：

```
array (
  0 => 'qsr-part:1285',
  1 => 'qsr-part:1286',
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:21:01.300

使用数组或对象，并`json_encode`在一侧和另一侧尝试`json_decode`。

# php - 有人可以为我清理静态变量吗？

> ID：10826314
> 
> 赞同：1
> 
> 时间：2012-05-31T01:20:10.023
> 
> 标签：php, variables, static

在这里使用 PHP，我决定逐章阅读手册并学习新东西。所以现在我发现了静态变量，这似乎是一个很棒的概念，但我理解它的方式是：

每次加载脚本时，静态变量设置一次且仅设置一次。它们可以更改和增加，但实际上不能重新设置。通常在函数中用于设置一个值，而不必在每次函数运行时初始化该变量。

```
<?php

function count2( $inputNum ) {
    static $a = $inputNum;
    echo $a++; //Echo and then increment.
}

for ( $i = 0; $i < 10; $i++ ) {
    count2(50);
}

?> 
```

我希望这会`$a`在 50 处启动静态 var，并增加 11 倍。我怎么会出错？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T01:23:32.700

> 与任何其他 PHP 静态变量一样，静态属性**只能使用文字或常量进行初始化**；不允许表达。因此，虽然您可以将静态属性初始化为整数或数组（例如），**但您不能将其初始化为另一个变量**、函数返回值或对象。

我认为您错过了[文档](http://php.net/manual/en/language.oop5.static.php)中的那部分（强调我的）:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:24:20.623

静态变量不能用另一个变量初始化，其值直到运行时才知道。您必须使用编译时已知的值对其进行初始化。

```
function count2($inputNum) {
  // Initialize only once to an integer (non variable, non-expression)
  static $a = 0;
  if ($a === 0) {
    // If $a is still 0, set it to $inputNum
    $a = $inputNum;
  }
  echo $a++;
}

// First run outputs 25
count2(25);
// 25
// Subsequent runs increment
count2(25);
// 26
count2(25);
// 27 
```

[相关文件...](http://php.net/manual/en/language.oop5.static.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T01:25:01.690

几个问题：

*   您只能声明一次静态变量。`count2()`您的语法通过调用10 次一遍又一遍地破坏它。
*   您不能使用`++`运算符，因为您不能更改静态变量
*   不使用定义和[`constant`](http://php.net/manual/en/function.constant.php)

也许尝试类似：

```
<?php
error_reporting(E_ALL);

/* setup */

function set( $input ) {
    define( 'A', $input );
}
function tick() {
    echo constant( 'A' ) . "\n";
}

/* run */

set( 50 );
for($i=0; $i<10; $i++){
    tick();
}

?> 
```

这将输出：

```
$ php test.php 
50
50
50
50
50
50
50
50
50
50 
```

# java - HTMLUnit 重定向和按钮点击

> ID：10826317
> 
> 赞同：1
> 
> 时间：2012-05-31T01:20:31.967
> 
> 标签：java, htmlunit

我对 HTMLUnit 有疑问。不久我正在做的是，我正在填写表格并登录到网页，然后按下该页面上的按钮。实际上，我无法执行此过程，但我正在尝试。这是我的 HTML 表单源代码和 Java 源代码：

这是来自登录屏幕：

```
<form action="/login" method="post"> 
 ...
 <input type="text" name="login_email" id="login_email" value="" />
 <input type="password" name="login_password" id="login_password" />
 <input type="submit" id="login_submit" name="login_submit" value="Sign in" />
</form> 
```

这种形式有一些隐藏的输入。我知道这听起来很有趣，但是当我不对隐藏输入做任何事情时，我的 Java 代码就可以工作。

这是我使用此表单登录的 Java 代码：

***此代码来自 stackoverflow 问题。我只是测试它，仅此而已。***

```
WebClient webClient = new WebClient();
webClient.setThrowExceptionOnScriptError(false);

HtmlPage currentPage = webClient.getPage("https://www.blablabla.com:1234");
final HtmlForm form = currentPage.getFirstByXPath("//form[@action='/login']");
HtmlTextInput username = (HtmlTextInput) currentPage.getElementById("login_email");
HtmlPasswordInput password = (HtmlPasswordInput) currentPage.getElementById("login_password");

username.setText("username@blablabla.com");
password.setText("passW0rd");
HtmlButton submitButton = (HtmlButton) currentPage.createElement("button");
submitButton.setAttribute("type", "submit");
form.appendChild(submitButton);

HtmlPage newPage = submitButton.click();

System.out.println(newPage.asText()); 
```

在下一部分之前一切都很好。我可以登录，看到新页面的内容。

但是，当我尝试按下新页面中的按钮时，我什么也得不到。实际上，我想我什至无法按下它。

这是我的“按钮”和新网页的 HTML 源代码：

```
<form action="auth" method="post">
 <input type="submit" name="allow" value="Allow"/>
</form> 
```

还有一些隐藏的输入。

这是 -trying- 按下名为“允许”的按钮的 Java 代码：

```
HtmlButton button = newPage.getElementByName("allow");
HtmlPage page = button.click() ; 
```

为了最后一次检查，我使用了另一段代码：

```
System.out.println(page.asText()); 
```

但我收到这样的错误

***错误开始***

```
WARNING: getElementById(script1338426904717) did a getElementByName for Internet Explorer
31.May.2012 04:15:04 com.gargoylesoftware.htmlunit.javascript.host.ActiveXObject jsConstructor
WARNING: Automation server can't create object for 'ShockwaveFlash.ShockwaveFlash'.
31.May.2012 04:15:04 com.gargoylesoftware.htmlunit.javascript.StrictErrorReporter     runtimeError
SEVERE: runtimeError: message=[Automation server can't create object for     'ShockwaveFlash.ShockwaveFlash'.] sourceName=[https://www.jdkahsjkda/dksajda.js] line=[12]     lineSource=[null] lineOffset=[0]
31.May.2012 04:15:04 com.gargoylesoftware.htmlunit.javascript.host.ActiveXObject     jsConstructor 
```

***错误结束***

只要我可以登录，这些错误对我来说都是可以的。

我可以登录，然后查看页面。它说“欢迎使用用户名密码......”但是，我不能按下按钮也不能做任何其他事情。

我希望你们能帮助我解决这个问题。

非常感谢你。

保重，谢谢。

***编辑：***

现在我得到这个错误：

```
Exception in thread "main" com.gargoylesoftware.htmlunit.ElementNotFoundException: elementName=[*] attributeName=[name] attributeValue=[allow]
at com.gargoylesoftware.htmlunit.html.HtmlPage.getElementByName(HtmlPage.java:1565)
at cza.main(cza.java:54) 
```

但是，有一个名为“允许”的按钮。我正在查看***第二***页的来源，我看到了：

```
<input type="submit" name="allow" value="Allow"/>
<input type="submit" name="deny" value="Deny"/> 
```

因此，有一个名为允许和拒绝的按钮。但是，此代码失败。这可能是因为JS还是什么？我尝试从 firstPage 中找到提交按钮并使用它提交表单。不是用假按钮，它再次失败。我为此使用了 HTMLSubmitInput，它再次失败。

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T08:22:20.043

抱歉，我还不能评论...

内容是什么`newPage.getWebResponse().getContentAsString()`？我猜您的页面可能包含许多名称为“allow”的 html 元素

最好确保您获得一个独特且正确的元素，有很多方法可以做到：

```
element.getElementById("id")
page.getFirstByXPath("xpathExpr") || page.getByXPath("xpathExpr") 
```

依此类推……目标确实是确保使用您需要的元素。

在使用输入时，将表单作为变量来操作输入始终是一种好方法。例如：

```
HtmlForm form = page.getforms(0); 
form.getInputByName("name");
form.getInputByValue("value"); 
```

顺便说一句，一些提示：使用 FF 设置初始化 webclient，如下所示：client = new WebClient(BrowserVersion.FIREFOX_3_6); 它获得了最好的 html 代码覆盖率（[http://build.canoo.com/htmlunit/artifacts/](http://build.canoo.com/htmlunit/artifacts/) ）

总是尝试打开/关闭 JS：`client.setJavaScriptEnabled(false);client.setThrowExceptionOnScriptError(false);`

# asp.net-mvc-3 - 由于父子表关系，EF4 生成的 CRUD 视图在创建时出现问题

> ID：10826325
> 
> 赞同：1
> 
> 时间：2012-05-31T01:21:17.930
> 
> 标签：asp.net-mvc-3, sql-server-2008, entity-framework, parent-child, crud

我对 .NET 比较陌生，并且正在使用 MVC3、EF4、SQL 2008 R2 构建一个网站。此外，我还没有在 Stack 上找到任何可以直接解决我的问题的内容，这涉及到 EF 生成的问题以及父子表关系的复杂性。

我们的站点有用户资料（表：Profile），每个人在Social表上可以有几条记录，也就是说Social表有一个ProfileId的FK。

EF4 已经为这个 Social 表生成了 CRUD 视图和控制器，除了 Create 之外，一切都很好。Create 视图自动生成了一个下拉框，允许用户选择他们想要的 ProfileId，但这是错误的。（即，我们不希望有人为其他用户设置社交信息，呵呵。）所以我把下拉菜单变成了@Html.HiddenFor(model => model.ProfileId)，这时我的问题就开始了。

发生的情况是，当我单击该视图上的 CREATE 按钮时，什么也没有发生。这似乎很可能是因为该页面在上下文中没有用户的 ProfileId，我想知道要改变什么来克服这个障碍。（用户的 ProfileId 位于上一页 Index.cshtml 的上下文中，因为我将社交记录列表限制为与他们的 Id 匹配的记录。）

模型中的一些代码：

```
using System;
using System.Collections.Generic;

public partial class Social
{
    public int SocialId { get; set; }
    public int ProfileId { get; set; }
    public Nullable<int> ThemeId { get; set; }
    public string Title { get; set; }
    public Nullable<System.DateTime> CreateDate { get; set; }
    public Nullable<System.DateTime> LastActivityDate { get; set; }
    public Nullable<bool> Active { get; set; }
    public Nullable<bool> Publish { get; set; }

    public virtual Profile Profile { get; set; }
    public virtual Theme Theme { get; set; }
} 
```

控制器代码：

```
 public ActionResult Create()
    {
        ViewBag.ProfileId = new SelectList(db.Profiles, "ProfileId", "Profile");
        ViewBag.ThemeId = new SelectList(db.Themes, "ThemeId", "ThemeTitle");
        return View();
    } 

    [HttpPost]
    public ActionResult Create(Social social)
    {
        if (ModelState.IsValid)
        {
            db.Socials.Add(social);
            db.SaveChanges();
            return RedirectToAction("Index");  
        }

        ViewBag.ProfileId = new SelectList(db.Profiles, "ProfileId", "Profile", social.ProfileId);
        ViewBag.ThemeId = new SelectList(db.Themes, "ThemeId", "ThemeTitle", social.ThemeId);
        return View(social);
    } 
```

...从视图中：

```
 <div class="editor-label">
        @Html.LabelFor(model => model.ProfileId, "Profile")
    </div>
    <div class="editor-field">
        @Html.DropDownList("ProfileId", String.Empty)
        @Html.ValidationMessageFor(model => model.ProfileId)
    </div> 
```

任何帮助将不胜感激！

# regex - Perl if 语句混淆

> ID：10826326
> 
> 赞同：3
> 
> 时间：2012-05-31T01:21:18.540
> 
> 标签：regex, perl, if-statement

这段代码是一个`if`声明；我想测试是否`$rtgene`包含`trn`. 我用以下代码测试了代码`$rtgene= nad3`：

```
if ($rtgene!~/trn/){
$end=$data[$i][0]+100;
}
else{
$end =$data[$i][1];
}
print $end; 
```

这是一个不起作用的替代表达式：

```
($rtgene!~/trn/)? $end=$data[$i][0]+100 : $end=$data[$i][1]; print $end; 
```

问题在于第一个代码（正常的 if else 语句）它可以工作并给我预期的结果，但替代代码（最后一行）它不起作用；它总是执行`else`语句。

**问题**：这个问题的原因是什么？如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T05:36:23.380

由于您试图根据`$end`条件分配两个值之一，为什么不编写这样的条件表达式：

```
$end = ($rtgene !~ /trn/) ? $data[$i][0]+100 : $data[$i][1];
print $end; 
```

[这避免了ysth](https://stackoverflow.com/users/17389/ysth)准确诊断的优先级问题，并且更容易理解。

Perl 可以用来编写高深莫测的代码；但是，让所有代码都难以理解并不是一个好主意。将作业和打印堆叠在一行上往往难以理解。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T05:41:10.767

以下是使用三元条件运算符的方法：

```
$end = $rtgene !~ /trn/ ? $data[$i][0]+100 : $data[$i][1]; 
```

它评估之前的部分`?`，如果为真则返回第一个选项，否则返回第二个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T01:28:59.487

对我来说似乎是一个优先错误。= 的优先级低于 ?:，所以它就像：

```
( ($rtgene!~/trn/) ? $end=$data[$i][0]+100 : $end ) = $data[$i][1]; 
```

也就是说，三元组的任一分支都分配`$data[$i][1]`给`$end`（尽管真正的分支首先分配另一个值，最终被覆盖）。

试试这个：

```
($rtgene!~/trn/) ? ($end = $data[$i][0]+100) : ($end = $data[$i][1]); 
```

# android - 活动 URL 回调在 4.0.3 ICS 中不起作用

> ID：10826327
> 
> 赞同：16
> 
> 时间：2012-05-31T01:21:28.520
> 
> 标签：android, url, callback, android-4.0-ice-cream-sandwich

我在 twitter 应用程序中使用 OAUTH，它会将您发送到应用程序内的 twitter 页面，然后您登录并重定向回处理令牌的应用程序。这在 android 2.0.x 和 3.0.x 中完美运行，但在 4.0 中，当我尝试重定向回我的应用程序时，我得到“网页不可用”。谁能告诉我这是为什么？？我的清单文件中有以下内容：

```
<intent-filter>
    <action android:name="android.intent.action.VIEW"/> 
    <category android:name="android.intent.category.DEFAULT"/>
    <category android:name="android.intent.category.BROWSABLE"/>
    <data android:scheme="myapp" android:host="myactivity"/>
</intent-filter> 
```

推特页面给出了回调 URL，该 URL 一直在工作，但现在在 android 4.0 ICS 中没有，有人可以帮忙吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-29T07:29:50.757

它是 Manifesh 文件活动条目

> ```
>  <action android:name="android.intent.action.VIEW" />
>     <category android:name="android.intent.category.DEFAULT" />
>     <category android:name="android.intent.category.BROWSABLE" />
>     <data
>         android:host="www.yourpage.address"
>         android:scheme="alocola" />                //scheme name
> 
> </intent-filter> 
> ```

它是在 url 中打开的 html 页面，使用 click go 回调

```
> <html> Visit my blog <?php $homepage =
> file_get_contents('http://www.example.com/api/parameters'); echo
> $homepage; ?>  <a href="alocola://other/parameters/here">   ////alocola use scehma
>  <metahttp-equiv="alocola://other/parameters/here"content="5;
> url="alocola://other/parameters/here" > mysite </a>  or run the   <a
> href=\"alocola"> myactivity</a>  callback</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-29T14:15:09.273

```
 <activity
        android:name=".MainActivity"
        android:label="@string/app_name"
        android:launchMode="singleTop" >

<intent-filter>

        <action android:name="android.intent.action.VIEW" />
        <category android:name="android.intent.category.DEFAULT" />
        <category android:name="android.intent.category.BROWSABLE" />
        <data
            android:host="t4jsample"
            android:scheme="oauth" />

    </intent-filter> 
```

这是我在我的应用程序中用于集成 twitter 的内容。这对我有用，我正在使用带有 ICS 4.0.3 的 HTC 欲望 V。

我参考了本教程进行集成。 [http://www.androidhive.info/2012/09/android-twitter-oauth-connect-tutorial/](http://www.androidhive.info/2012/09/android-twitter-oauth-connect-tutorial/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-29T08:53:55.770

确保您的 CALLBACK_URL 是

```
myapp://myactivity 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-27T06:26:19.530

```
<activity
        android:name=".StartupActivity"
        android:launchMode="singleTask"
         >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />

            <category android:name="android.intent.category.DEFAULT" />
            <category android:name="android.intent.category.BROWSABLE" />

            <data
                android:host="www.healthcompanion.com"
                android:path="Common//Registration.jsp"
                android:pathPattern="*.*&amp;data=2&amp;*"
                android:scheme="https" />
        </intent-filter>
    </activity> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-22T09:07:19.683

我使用了它，它解决了我的问题：

```
<intent-filter>
   <action android:name="android.intent.action.VIEW" />
   <category android:name="android.intent.category.DEFAULT" />
   <category android:name="android.intent.category.BROWSABLE" />
   <data android:scheme="x-oauthflow-twitter" android:host="callback" />
</intent-filter> 
```

# html - IE和Firefox显示页面的区别

> ID：10826333
> 
> 赞同：0
> 
> 时间：2012-05-31T01:22:16.760
> 
> 标签：html, css, internet-explorer, firefox

这是我网站的链接：http: [//virtual.weltec.ac.nz/s13/Johnsonville/](http://virtual.weltec.ac.nz/s13/Johnsonville/)

一切在 FireFox 中运行良好，但由于某种原因在 IE 中不行。我注意到的主要是顶部的导航栏。在 Firefox 中，当我将光标移到任何选项卡上时，会显示一个下拉菜单（这是通过 CSS 完成的）。这在 IE 中不起作用。

奇怪的是，如果我转到地图页面，下拉菜单会起作用。但仅适用于该页面......但其他页面中的代码完全相同，并且它们不起作用。

什么会导致这种情况，更重要的是，我怎样才能让它在 IE 中工作？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:36:33.737

发现差异 - 接受挑战。

好吧，whaddaya 知道，您在 QUIRKS MODE 下运行它，难怪它不起作用。地图页面呢？是的，标准模式，它的工作原理。

始终向您的页面添加 DOCTYPE。总是。

# jtextfield - 多行输入文本字段

> ID：10826334
> 
> 赞同：0
> 
> 时间：2012-05-31T01:22:20.927
> 
> 标签：jtextfield

我用样式扩展了输入文本字段的宽度和高度。但是我需要将它改为多行还是一行？我该如何： - 添加多行？- 或者将输入字段类型更改为普通的可扩展文本字段？

〜Ĵ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T04:46:48.363

使用`JTextArea`. 您可能需要设置滚动和文本换行选项以使其按照您想要的方式运行。

# android - 在android中，我试图弄清楚如何构建倒数计时器

> ID：10826336
> 
> 赞同：2
> 
> 时间：2012-05-31T01:22:28.207
> 
> 标签：android

从系统时钟设置自己。倒计时到第二天凌晨2点。假设您启动应用程序时是晚上 11 点。在 main.xml 上运行 3 小时倒计时这是我到目前为止所拥有的

```
import java.util.Calendar;
import java.util.GregorianCalendar;

import android.app.Activity;

public class LastCall extends Activity {

public static void main(String[] args){

    Calendar calendar = new GregorianCalendar();

      int hour = calendar.get(Calendar.HOUR);
      int minute = calendar.get(Calendar.MINUTE);
      int timelefthour = 0;
      int timeleftmin = 0;

      if(calendar.get(Calendar.AM_PM) == 1 && hour != 12)

                timelefthour = (12 - hour) + 2;
                timeleftmin = 60 - minute;

      if(calendar.get(Calendar.AM_PM) == 1 && hour == 12)

                    timelefthour = 13;
                    timeleftmin = 60 - minute;          

      if(calendar.get(Calendar.AM_PM) == 0 && hour == 12)

                timelefthour = 1;
                timeleftmin = 60 - minute;  

      if(calendar.get(Calendar.AM_PM) == 0 && hour <= 2)

                timelefthour = 2 - hour;
                timeleftmin = 60 - minute;

       String lastcall = (Integer.toString(timelefthour) + " hr " + Integer.toString(timeleftmin) + " min ");
      }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T03:04:49.000

看来您非常错误地使用了 Activity 类。

我建议您阅读此页面，然后重新考虑您的方法：

[Android 参考 - 活动](http://developer.android.com/reference/android/app/Activity.html)

您不使用 main 方法在 Android 应用程序中执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T03:15:51.913

典型的 Android Activity 类将如下所示：

```
public class MyActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        //This is where you could create all of your objects etc...
    }

    private void MyMethod() {
        //do stuff
    }
} 
```

这是一个典型的活动。setContentView 将屏幕设置为预先格式化的 xml 布局。您可能希望在 onCreate 函数中创建对象等，该函数在活动开始时调用。

首先，我建议阅读 Android Activity 类的基础知识，并可能制作一个 HelloWorld 应用程序以开始使用。此外，如果您还没有，如果您使用良好的 IDE（例如 Eclipse），Android Dev 会容易得多。IDE 将为您做很多手动工作，您可以只专注于编码。

这是一个很好的链接：http: [//developer.android.com/resources/tutorials/hello-world.html](http://developer.android.com/resources/tutorials/hello-world.html)

# c# - PictureBox 未以 C# 形式显示

> ID：10826338
> 
> 赞同：1
> 
> 时间：2012-05-31T01:23:16.323
> 
> 标签：c#, controls

我有以下代码：

```
 foto = new System.Windows.Forms.PictureBox();
    ((System.ComponentModel.ISupportInitialize)(foto)).BeginInit();
    foto.BackgroundImage = global::Catalogo_Digital.Properties.Resources.voltar;
    foto.BackgroundImageLayout = System.Windows.Forms.ImageLayout.Stretch;
    foto.Location = new System.Drawing.Point(85, 85);
    foto.Name = "foto";
    foto.Size = new System.Drawing.Size(1000, 800);
    foto.TabIndex = 0;
    foto.TabStop = false;
internal System.Windows.Forms.PictureBox foto; 
```

问题是这个名为“foto”的图片框在我调试时没有显示，它只是不可见，我不知道。我只是想创建一个“内部”或“公共”图片框，而不是在设计器模式下，只使用代码。

# html - 选择这个但不是那个

> ID：10826340
> 
> 赞同：0
> 
> 时间：2012-05-31T01:23:22.007
> 
> 标签：html, css, css-selectors

我有一个像这样的菜单：

```
<nav>
    <ul>
        <li><a href="index.php">Home</a></li>
        <li><a href="forum.php">Community</a>
            <ul>
                <li><a href="forum.php">Forum</a></li>
            </ul>
        </li>               
        <li><a>Account Management</a></li>
    </ul>
</nav> 
```

我正在使用以下内容来设置“社区”链接的样式：

```
nav ul li:nth-child(2) a 
```

但这也设置了我不想要的“论坛”链接的样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:27:26.260

您将需要添加一些子选择器，否则您的选择器将忽略嵌套级别并始终选择`a`嵌套在您的 second 中的任何元素`li`：

```
nav > ul > li:nth-child(2) > a 
```

有关子选择器的说明，请参见[this other answer](https://stackoverflow.com/questions/3225891/what-does-mean-in-css-rules/3225905#3225905)。

# python - 带有 Django URL 正则表达式的 TypeError

> ID：10826342
> 
> 赞同：1
> 
> 时间：2012-05-31T01:23:29.220
> 
> 标签：python, regex, django

嗨，我一直对 Regex 感到困惑，我不明白对其他帮助线程的响应。

基本上我的问题是，我可以结合

```
r'^input/?$' 
```

和

```
r'^input/index.html?$' 
```

进入这个？

```
r'^input(/(index.html?)?)?$' 
```

在 Django 中，我收到此错误：

```
input() takes exactly 1 argument (3 given) 
```

它只在正确匹配时给出错误，所以也许这不是正则表达式问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:55:53.870

就个人而言，我不希望将这两个正则表达式结合起来。我认为有两个网址模式，

```
url(r'^input/?$', input, name="input"),
url(r'^input/index.html?$', input), 
```

比一个更具可读性。

但是，如果您确实想将两者结合起来，则可以使用非捕获括号：

```
r'^input(?:/(?:index.html?)?)?$' 
```

一个简单的例子可能有助于解释：

```
>>> import re
>>> # first try the regex with capturing parentheses
>>> capturing=r'^input(/(index.html?)?)?$'
>>> # Django passes the two matching strings to the input view, causing the type error
>>> print re.match(capturing, "input/index.html").groups()
('/index.html', 'index.html')
>>> # repeat with non capturing parentheses
>>> non_capturing=r'^input(?:/(?:index.html?)?)?$'
>>> print re.match(non_capturing, "input/index.html").groups()
() 
```

有关详细信息，请参阅[正则表达式高级语法参考](http://www.regular-expressions.info/refadv.html)页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-10T12:50:11.803

如果您在您的中使用它，`urlpatterns`则不需要编写`?`符号，因为之后的所有内容都可以在您的视图函数中解析。并且请求`/input/index.html?param=2`将使用正则表达式正确处理`r'^input/index.html$'`。然后在视图函数中，您可以获得如下参数：

```
def my_view(request):
    param = request.GET.get('param', 'default_value') 
```

在此处查找更多信息：[https ://docs.djangoproject.com/en/1.9/topics/http/urls/](https://docs.djangoproject.com/en/1.9/topics/http/urls/)

# jquery - 如何从行表中选中复选框的特定列/单元格中获取值？

> ID：10826343
> 
> 赞同：1
> 
> 时间：2012-05-31T01:23:31.363
> 
> 标签：jquery, checkbox, html-table

我创建了一个显示结果的表格 JSON 以消除任何类型的材料，为它生成表格会添加一个复选框，然后当用户**选中该复选框**时，我将从第一列中获取数据，以便实现“删除from" 并删除检查的行数的记录。

也就是说，如果检查了 4 行，那么应该有一个函数**从每行的第一列获取数据**，因此可以通过 jQuery.ajax 将它们发送到 php 文件中进行处理，但我想不出该怎么做

**生成每行带有复选框的表格的代码**

```
// ...
$.ajax({
type: "POST",
url: action,
data: dataSearch,
success: function (response) {
    if (response[0].success == "success") {
        $('.tableBajaMat tr:gt(0)').remove(); //delete tr except first row
        $.each(response, function (index, record) {
            var row = $("<tr />");
            $("<td />").text(record.clavemat).appendTo(row);
            $("<td />").text(record.tipomat).appendTo(row);
            $("<td />").text(record.titulomat).appendTo(row);
            $("<td />").text(record.autormat).appendTo(row);
            $("<td />").html("<input type='checkbox' id='marcar'/>").appendTo(row);
            row.addClass("alt");
            row.appendTo(".tableBajaMat");
        });
    } else {
        alert("Data not found!");
    }

}
});
return false; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:01:36.767

在我得到我的实际答案之前，你不应该将相同的 id 分配给多个 html 元素，但要实现你想要做的事情，你的复选框根本不需要 id。相反，您似乎使用“.tableBajaMat”类作为唯一标识符，因此您*应该*使用 id。但无论如何...

假设您创建了一个触发删除当前选中复选框的按钮，您可以执行以下操作：

```
<input type="button" id="deleteBtn" value="Delete Selected">

$('#deleteBtn').click(function() {

    var clavemats = [],
        $selectedCBs = $('.tableBajaMat input[type="checkbox"]:checked');

    if ($selectedCBs.length === 0) {
        alert("No rows selected to delete.");
        return;
    }
    $selectedCBs.each(function() {
        clavemats.push( $(this).closest('tr').children(':first').text() );
    });
    // now clavemats is an array of the clavemat values
    $.ajax({
        url : 'yourURLhere.php',
        data : { clavemat : clavemats }
        success : function(data) {
           // whatever you want to do on success goes here
        }
    });

}); 
```

以上循环遍历表中所有选中的复选框。在`.each()`回调`this`中是当前复选框，因此`$(this).closest('tr').children(':first').text()`获取当前复选框所在的 tr 元素的第一个子元素的文本。这些值被卡在一个数组中，然后该数组以参数名称“在 Ajax 请求中传递” clavemat” - 显然您可以将其更改为您想要的任何名称。

# jquery - JQuery fadeIn 和 fadeOut on html 更改

> ID：10826345
> 
> 赞同：1
> 
> 时间：2012-05-31T01:23:35.097
> 
> 标签：jquery, fadein, fadeout

我有以下 Jquery Ajax 调用，完成后会更改元素的 HTML：

```
 $("#join").on('click', function(e) {
        e.preventDefault();
        $.post('register.php', $("#registerform").serialize(), function() {
            $('#join').html('Success!')

        });
    });
  }); 
```

现在，我希望能够让 .html('Success!') 淡入超过 3 秒，暂停 3 秒，然后淡出以将同一按钮的 html 更改回 .html('Sign Up')

我已经尝试了几次迭代，但都没有成功——我错过了什么吗？

或者在操作 .html 时不能这样做吗？

谢谢！

**更新**

几乎可以工作的版本：

```
 $("#join").on('click', function(e) {
        e.preventDefault();
        $.post('register.php', $("#registerform").serialize(), function() {
            $('#join').hide().html('Success!').fadeIn(3000, function() {
                $(this).html('Sign Up').delay(3000).fadeIn(3000);
            });

        });
    }); 
```

现在唯一的问题是按钮消失了（我假设它是 hide()），但如果我删除 .hide() 方法，它根本不会呈现。

此外，如果光标停留在按钮上，则效果根本不会呈现，直到它从按钮上移开。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T01:29:23.010

```
$('#join').hide().html('Success!').fadeIn(3000, function() {
  $(this).delay(3000).fadeOut();
}); 
```

编辑：

```
$('#join').fadeOut(400, function() {
  $(this).html('Success').fadeIn(3000, function() {
    $(this).fadeOut(3000, function(){
      $(this).html('Sign UP').fadeIn();
    })
  })
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:29:27.957

```
 var $this = $('#join');  
  $this.on('click', function(e) {
        e.preventDefault();
        $.post('register.php', $("#registerform").serialize(), function(){
          $this.hide().html('Success!').fadeIn(3000,function(){
            setTimeout(function(){$this.fadeOut(3000).html("Sign Up");},3000);
          });
      });
  }); 
```

试试这个...

# c# - 将修饰键应用于字符

> ID：10826348
> 
> 赞同：4
> 
> 时间：2012-05-31T01:23:54.977
> 
> 标签：c#, .net-4.0

将键盘的修饰键应用于字符以获取其修改值（对于当前文化）的最佳方法是什么？

例如，按下 shift 键（对于英国键盘）：

```
Assert.AreEqual('!', Modify('1'));
Assert.AreEqual('"', Modify('2'));
Assert.AreEqual('A', Modify('a'));
Assert.AreEqual('B', Modify('b'));
Assert.AreEqual(':', Modify(';'));
Assert.AreEqual('?', Modify('/')); 
```

我有一种方法可以判断是否按下了修饰键，但我没有一种方法可以在给定这组修饰键的情况下映射到正确的字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T22:41:31.177

根据您要完成的任务，可能会执行以下操作：

```
 [DllImport("user32.dll", CharSet = CharSet.Unicode)]
    static extern short VkKeyScan(char ch);

    [Test]
    public void Test_VkKeyScan()
    {
        Assert.AreEqual(VkKey('!'), VkKey('1'));
        Assert.AreEqual(VkKey('@'), VkKey('2'));
    }

    private short VkKey(char p)
    {
        return (short)(0xff & VkKeyScan(p));
    } 
```

使用提供的方法构建字典`VkKey`也不应该是太大的问题。

更新：正确处理多个布局需要使用`VkKeyScanEx`而不是`VkKeyScan`显式地提供当前或需要的布局作为参数。

# css-transitions - 使用 CSS3 过渡更改字体粗细

> ID：10826349
> 
> 赞同：0
> 
> 时间：2012-05-31T01:23:58.033
> 
> 标签：css-transitions

我目前正在[处理这个页面](http://www.evenpanda.com/content.php?team)。团队成员的字体粗细和他们的名字看起来非常统一，但是一旦我将鼠标悬停在照片上以调用 CSS3 过渡，字体粗细就会变低。

我尝试给照片 div 更多的边距，但字体粗细仍在变化。

我在 Mac 上使用最新的 Chrome。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:35:44.447

以下是我突然想到的两个错误：

1）你有两个 div 的 ID 都是“team”。这几乎肯定会混淆浏览器。

2) IDS 为“#about-pic”和“#about-team”的 div 的“display”属性在 CSS 中拼写错误为“dispplay”。未应用该值。修复该错字，并且类型在悬停事件上稳定。

# mysql - mysql选择麻烦

> ID：10826350
> 
> 赞同：0
> 
> 时间：2012-05-31T01:23:58.070
> 
> 标签：mysql, regex, select, sql-like

这是我第一次尝试实现这种选择。

我的表上有一个列，用于存储诸如`1,3,45,32,47,4,9,100,23,2`

我想创建一个`select`并仅检索匹配的值，例如`4`但`not 45`在表的所有行上。

有时此列只有一个数字，例如`4`

如果我`LIKE %4,%`只使用 SQL 进行选择，将检索第一个示例的值，并且只有一个数字的记录不会出现。

如果我使用`LIKE %4%`SQL 将检索`4, 45, 47`

如果我使用 REGEX `'^4$'`SQL 只会`4`从两个示例中检索...

有什么帮助吗？

PS：对不起我的英语我来自巴西！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:28:37.627

您可以在 where 子句中使用 = 运算符

```
Select some-col 
from some_table 
where column_name = '4' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:29:09.957

将值存储为：,1,3,45,32,47,4,9,100,23,2,

然后做 SQL LIKE %,4,%

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T02:24:08.727

```
where find_in_set('4', col_name) 
```

[http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_find-in-set](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_find-in-set)

ps-考虑改变你的数据库设计，这样你就不需要使用这些黑客来查询你的数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T02:24:22.450

1.  *我的表上有一个列，用于存储诸如`1,3,45,32,47,4,9,100,23,2`*
2.  *我想进行选择并仅检索匹配的值，例如`4`*。

更改 where 子句，如下所示：

```
where column_name like '4' or column_name like '4,%' or column_name like '%,4,%' 
```

它应该可以工作。

# javascript - jquery : 事件 : event.preventDefault(); , e 未定义

> ID：10826354
> 
> 赞同：5
> 
> 时间：2012-05-31T01:24:38.813
> 
> 标签：javascript, jquery, preventdefault

嘿，我有一个在锚点的 onclick 事件上触发的 jquery 函数，函数如下：

```
function dropDown(subid, e) {
 e.preventDefault();
 var sub = '#' + subid;
 // hide all submenus first
 $('.subnav').css({'display' : 'none'});
 //Show the Current Subnav 
 $(sub).css({'display' : 'block'});
} 
```

这就是我试图触发它的方式：

```
<a href="#!" onclick="dropDown('sn_cities')" >Cities</a> 
```

但是我收到此错误：`e is undefined`

我想取消锚链接的默认 onclick 事件，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-31T01:29:29.123

您没有将事件对象（或任何东西）传递给`e`函数的参数。试试这个：

```
onclick="dropDown('sn_cities',event);" 
```

不过，我倾向于完全失去内联 JS：

```
<a href="#!" data-dropDown="sn_cities">Cities</a>

$(document).ready(function() {

    $("a[data-dropDown]").click(function(e) {
       e.preventDefault();
       // hide all submenus first
       $('.subnav').hide();
       //Show the Current Subnav 
       $('#' + $(this).attr("data-dropDown")).show();
    });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:27:38.953

```
function dropDown(subid) {
 var sub = '#' + subid;
 // hide all submenus first
 $('.subnav').css({'display' : 'none'});
 //Show the Current Subnav 
 $(sub).css({'display' : 'block'});
}

<a href="#!" onclick="dropDown('sn_cities'); return false;" >Cities</a> 
```

作为旁注。不推荐使用内联javascript。为清楚起见，将脚本保存在外部文件中。

# python - python，字符串比较不起作用？

> ID：10826355
> 
> 赞同：0
> 
> 时间：2012-05-31T01:24:53.260
> 
> 标签：python, string, python-3.x, compare

我的任务是在单词列表上创建二进制搜索，我提出了 2 个实现（显然还没有提出尚未找到该单词的情况，但这还不是问题），但是当列表缩小到我正在寻找的单词，我的函数没有完成，而是继续运行，直到超过最大递归深度。

我把它打印出来，它清楚地显示了这个词`dasList[mid]`，并一遍又一遍地显示它，直到它最终放弃。

```
def _bisect2(dasList, word):
    mid = int(len(dasList)/2)
    if word.lower() > dasList[mid].lower():
        return _bisect2(dasList[mid: len(dasList)], word)            
    if word.lower() < dasList[mid].lower():
        return _bisect2(dasList[0: mid], word)
    else:
        return mid 
```

这是由

```
print(_bisect2(fileList, input('Please type a word'))) 
```

我正在使用 Python 3.0 解释器。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:37:21.633

您的实现（几乎）对我有用（并且没有显示您使用我的预排序输入描述的行为）。我假设您已经对输入文件进行了排序？下面发布了一个稍微修改（工作）的示例。

```
def _bisect2(dasList, word,lidx=0):
    mid = int(len(dasList)/2)
    if word.lower() > dasList[mid].lower():
        return _bisect2(dasList[mid:], word,lidx=lidx+mid)            
    elif word.lower() < dasList[mid].lower():
        return _bisect2(dasList[:mid], word,lidx=lidx)
    return lidx+mid

words=sorted(["one","two","three","four","five","twenty","foo"])
print (words)
print (_bisect2(words,'three')) 
```

请注意，您正在返回最后一个部分列表中的索引（始终为 0）...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:49:03.470

这对我来说很好。请注意，最后返回的索引将始终是最小列表中单词的索引，而不是原始列表的索引。

另请参阅`>`比较不会再次对列表执行 len，它只是迭代到最后。如果您要迭代到最后，切片语法允许您省略最后一个数字。

```
words = "The quick brown fox jumped over the lazy dog".split()

def bisect(words, word):
    mid = int(len(words)/2)
    if word.lower() > words[mid].lower():
        return bisect(words[mid:], word)
    elif word.lower() < words[mid].lower():
        return bisect(words[0:mid], word)
    return mid

words = sorted(words)
print bisect(words, 'dog') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T02:18:31.913

为什么不使用 Python 的[bisect](http://docs.python.org/library/bisect.html)模块？

来自文档的[食谱：](http://docs.python.org/library/bisect.html#searching-sorted-lists)

```
def index(a, x):
    'Locate the leftmost value exactly equal to x'
    i = bisect_left(a, x)
    if i != len(a) and a[i] == x:
        return i
    raise ValueError 
```

例子：

```
>>> a = ['alfred','edward','mary','susan','thomas','wilma']
>>> index(a, 'mary')
2
>>> index(a, 'martha')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 6, in index
ValueError 
```

# r - 在R中创建向量的不同值的矩阵的有效方法

> ID：10826357
> 
> 赞同：-4
> 
> 时间：2012-05-31T01:25:24.387
> 
> 标签：r, matrix

我正在尝试从向量创建这样的矩阵：

```
 vec =c(1, 2, 3)

    > A
          [,1] [,2] [,3] [,4] [,5]
    [1,]    1    1    0    0    0
    [2,]    1    2    1    0    0
    [3,]    1    3    2    1    0 
```

并且每次向量的长度和值都`vec`在变化。如何编写一个函数来创建这个矩阵？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T03:16:32.647

我对这个问题有点迷茫，但是这条线

```
vec <- 1:3
embed(c(rep(0,length(vec)),vec),length(vec)+1) 
```

...产生您想要的结果的最后一部分：

```
 [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    2    1    0    0
[3,]    3    2    1    0 
```

然后您可以将其绑定到向量的第一个数字。

```
cbind(vec[1],embed(c(rep(0,length(vec)),vec),length(vec)+1)) 
```

给...

```
 [,1] [,2] [,3] [,4] [,5]
[1,]    1    1    0    0    0
[2,]    1    2    1    0    0
[3,]    1    3    2    1    0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:44:49.450

我认为这可能会做到：

```
vec =c(1, 2, 3)

my.matrix <- matrix(0, nrow=length(vec), ncol=(max(vec)+2))
my.matrix

for(i in 1:length(vec)) {

     my.matrix[i,1] <- 1
     z <- seq(vec[i], 1, -1)
     my.matrix[i,2:(vec[i]+1)] <- z
}

my.matrix 
```

# javascript - 单击时更改文本

> ID：10826360
> 
> 赞同：-2
> 
> 时间：2012-05-31T01:25:27.837
> 
> 标签：javascript, jquery

好的，如果我在做一个表格，我可以使用：

```
<form method="get" action="">
<label for="textinput">Text:</label> 
<input type="text" value="" name="textinput" id="textinput" /> 
<input type="submit" id="submitbutton" value="Search" onclick="return changeText('submitbutton');" /> 
</form> 
```

然后添加这个js：

```
function changeText(submitId){
    var submit = document.getElementById(submitId);
    submit.value = 'Working...';
    return false;
}; 
```

但我的问题是我的链接是这样的：

```
<a id="sharelink" href="">Post to Here</a> 
```

所以想知道如果链接ID的ONCLICK > sharelink

我可以展示 > 工作...

有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:39:49.793

好的固定：

我加了...

```
<a id="sharelink"onclick="changeText(this)" href="">Post to Here</a> 
```

脚本是：

```
function changeText(currentElement){
currentElement.firstChild.data="Working ...";
 } 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-05-31T01:38:35.817

也许你应该使用

```
onclick="changeText('submitbutton');" 
```

代替

```
onclick="return changeText('submitbutton');" 
```

# spring - 弹簧安全，方法安全和网址安全

> ID：10826362
> 
> 赞同：4
> 
> 时间：2012-05-31T01:26:23.713
> 
> 标签：spring, spring-security

我正在学习弹簧安全性，但我对它的灵活性感到困惑..

我知道我可以通过在标签中定义规则来保护 url，然后我看到有一个 @secure 注释可以保护方法。然后还有其他注释来保护域（或 POJO）的读取/更新

所以当我想开发一个典型的权限/角色/用户 Web 应用程序时，除了创建规则来保护 url，我是否还必须使用 @secure 注释来保护方法？

ej。

1.  用户输入受限网址
2.  应用程序要求登录
3.  应用程序检查角色是否可以访问 url
4.  用户选择“添加新”选项
5.  再次检查该用户是否有权调用方法“addNew()”？？

或者步骤 4 或 5 之一是多余的。

对不起我的英语

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-09-01T20:38:36.010

URL 级别的安全性相当丰富，例如通过查看[HttpSecurity 的 fluent API](https://docs.spring.io/spring-security/site/docs/3.2.8.RELEASE/apidocs/org/springframework/security/config/annotation/web/builders/HttpSecurity.htmlhttp://)可以看出。但是在 Spring security 中使用方法级安全至少有两个原因：

1.  正如 Jonathan W 所指出的，您的安全逻辑可以通过 http 以外的连接器类型访问。例如，可以通过 EJB 公开逻辑。

2.  对于 REST API，相同的 URI 可能支持具有不同授权规则的不同 http 方法。例如`/myapi/order/{id}`可以接受 GET 和 DELETE，而 DELETE 可能只对具有 Supervisor 角色的用户可用。您不能通过 URL 安全性指定该规则，但您可以通过方法安全性来执行此操作，例如`@Secured("Supervisor")`在处理 DELETE 的方法上使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T03:49:36.483

这是要记住的最重要的事情。您*必须*假设用户可以通过原始 HTTP GET 或 POST 向您的 Web 应用程序发送*任何内容。*这也被称为“永远不要相信客户”。所以上面的步骤 4 和 5 不是多余的。例如，如果您到达第 5 步，则无法确定第 3 步是否已发生。

也就是说，如果您可以仅通过 URL 准确地区分用户打算做什么，*并且*您不需要通过不同的访问通道（例如从队列或 RMI）保护该方法，那么您可以只通过保护网址。但是，无论如何，拥有方法级别的安全性仍然不是一个坏主意……出于几个原因。首先，它记录了正在执行逻辑的预期角色。这有助于理解在开发时所做的假设，这有助于未来的改进。其次，它可以确保未来访问通道的安全性不会被无意中破坏。

# r - 如何测试没有发生错误？

> ID：10826365
> 
> 赞同：44
> 
> 时间：2012-05-31T01:26:51.887
> 
> 标签：r, testing

我开始对 R 包进行测试，并且一直在使用该`testthat`包。请注意，我是新来的测试，所以也许我的方法是关闭的。

我有一个函数在第 16 次执行时失败，在修复这个问题之前，我想编写一个回归测试，如果它再次出现，它将捕获它。

例如，以下总是抛出相同的错误消息：

```
 for i in (1:17) myfun() 
```

`myfun`不返回任何东西，它只有打开数据库连接的副作用。我很清楚，我可以编写一个预期错误并在返回时通过的测试：

```
 expect_error(for (i in 1:17) myfun()) 
```

但我不太明白如何编写测试以确保不会发生错误。由于它并不明显，也许我的方法是错误的。我可以弄清楚如何编写更具体的测试，但我想从这个开始。

我会写什么类型的测试来确保不会出现这样的错误？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2015-05-06T05:28:03.937

**由于 testthat 的变化而进行了重大编辑**

自 0.11 版（通过[RStudio 博客](https://blog.rstudio.org/2015/10/15/testthat-0-11-0/)）以来，直接支持测试缺少错误：

```
expect_error(myfun(), NA) 
```

捕捉`warning`和相同`message`：

```
expect_warning(myfun(), NA)
expect_message(myfun(), NA) 
```

旁注：函数中有一个`info`参数`expect_xxx`可以传递附加信息。所以你可以这样做：

```
for (i in 1:17) expect_error(myfun(), NA, info = paste("i =", i)) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-26T23:11:57.513

也许用另一个 expect_error 包装它。

例子：

```
expect_error(1)
expect_error(expect_error(1)) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-31T02:16:31.533

例如：

```
context("test error")
test_that("test error 1", {
  expect_true({log(10); TRUE})
})

test_that("test error 2", {
  expect_true({log("a"); TRUE})
}) 
```

将测试是否有错误。

```
> test_file("x.r")
test error : .1

    1\. Error: test error 2 -------------------------
    Non-numeric argument to mathematical function
    1: expect_true({
           log("a")
        TRUE
    })
    2: expect_that(object, is_true(), info, label)
    3: condition(object)
    4: expectation(identical(x, TRUE), "isn't true")
    5: identical(x, TRUE) 
```

这意味着第一部分通过了测试，而第二部分失败了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-31T02:48:34.563

这是一种使用不发生错误时`tryCatch`返回的期望的解决方案：`0`

```
expect_equal(tryCatch(for(i in 1:17) myfun()), 0) 
```

# windows-installer - MsiEnumProductsEx 不做任何事情就返回 ERROR_MORE_DATA

> ID：10826366
> 
> 赞同：1
> 
> 时间：2012-05-31T01:26:58.363
> 
> 标签：windows-installer

在一个相对较新的 XP (SP3) 安装中，我从调用`MsiEnumProductsEx`（来自 msi.lib）中得到了奇怪的结果。这是我的代码：

```
 TCHAR userId[8] = _T("s-1-1-0");
    UINT result;
    index = 0;
    TCHAR szInstalledProductCode[39];
    TCHAR szSid[40];
    MSIINSTALLCONTEXT context;
    DWORD numChars = 40;
    MSIINSTALLCONTEXT context;
    result = MsiEnumProductsEx(NULL, userId, MSIINSTALLCONTEXT_ALL, index, szInstalledProductCode, &context, (LPTSTR)szSid, &numChars); 
```

此函数调用后，所有输出变量保持不变；即 , `szInstalledProductCode`,`szSid`并`context`保持`numChars`不变；通过实际给它们虚拟值并查看它们没有被覆盖来进行测试。此外，`result`设置为 234；这通常表明`szSid`缓冲区太小，我需要传入更大的缓冲区；`numChars`变量应该用这个大小填充。但是，如前所述，numChars 与之前 (40) 完全相同，因此以相同的大小（加上一个用于空终止）再次调用该方法与第一次没有什么不同。

当我在其他机器上运行相同的代码时，它的行为与文档所说的完全一样——填充所有变量，包括`szSid`其缓冲区长度；如果缓冲区太小，则返回`ERROR_MORE_DATA`并填充`numChars`适当的大小。

所以我能想到的就是这个安装的 Windows 不知何故被破坏了，但我们需要了解 Windows 中具体错误的根本原因。谁能给我指导；即使只是某些调查途径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T04:57:25.980

这是我解决这个问题的方法：

我使用 SysInternals 的 ProcessMonitor 来查看它在幕后做了什么（将其与在实际工作的机器上使用 ProcessMonitor 进行比较）。我注意到不同之处在于，一旦它查看 HKCR/Installer/Products，它就开始绑定进程（而在工作 PC 上，它会继续从注册表中获取安装程序信息）。结果发现那里有一个格式错误的产品代码（它的开头不知何故是一个连字符），因此该功能失败了。不知道它是如何到达那里的，但你去那里了。

# syntax - 自定义编辑器（Aptana Studio 中的词法分析器），用于不受支持的语言

> ID：10826370
> 
> 赞同：1
> 
> 时间：2012-05-31T01:27:37.877
> 
> 标签：syntax, editor, aptana, syntax-highlighting

我知道可以将一些文件扩展名与现有编辑器（语法规则）连接起来。但是，如何为一些不适合当前编辑器的异国语言创建自己的编辑器？我想到了 Shpaml。我试图安装 shpaml-colorer (https://github.com/occulens/shpaml-colorer)，但我无法让它工作。

# c# - 将 MembershipProvider 从 OBDC 转换为 SQL 抛出异常

> ID：10826389
> 
> 赞同：0
> 
> 时间：2012-05-31T01:30:45.570
> 
> 标签：c#, asp.net, sql, membership-provider

`reader = cmd.ExecuteReader();`调试时抛出异常。

*CS0266：无法将类型“System.IAsyncResult”隐式转换为“System.Data.SqlClient.SqlDataReader”。*

这是从 MSDN 示例成员资格提供程序 (http://msdn.microsoft.com/en-us/library/6tc47t75.aspx) 派生的自定义 MembershipProvider，其用户名值调用电子邮件数据库字段而不是单独的用户名条目，并且连接已从 Odbc 更改为 SQL 连接。

```
 public override MembershipUser GetUser(string username, bool userIsOnline)
    {
        SqlConnection conn = new SqlConnection(connectionString);
        SqlCommand cmd = new SqlCommand("SELECT UserID, Email, PasswordQuestion," +
            " Comment, IsApproved, IsLockedOut, CreationDate, LastLoginDate," +
            " LastActivityDate, LastPasswordChangedDate, LastLockedOutDate" +
            " FROM Users WHERE Email = ? AND ApplicationName = ?", conn);

        cmd.Parameters.Add("@Email", SqlDbType.NVarChar, 128).Value = username;
        cmd.Parameters.Add("@ApplicationName", SqlDbType.NVarChar, 255).Value = m_ApplicationName;

        MembershipUser u = null;
        SqlDataReader reader = null;

        try
        {
            conn.Open();

            reader = cmd.ExecuteReader();

            if (reader.HasRows)
            {
                reader.Read();
                u = GetUserFromReader(reader);

                if (userIsOnline)
                {
                    SqlCommand updateCmd = new SqlCommand("UPDATE Users " +
                        "SET LastActivityDate = ? " +
                        "WHERE Email = ? AND Applicationname = ?", conn);

                    updateCmd.Parameters.Add("@LastActivityDate", SqlDbType.DateTime).Value = DateTime.Now;
                    updateCmd.Parameters.Add("@Email", SqlDbType.VarChar, 255).Value = username;
                    updateCmd.Parameters.Add("@ApplicationName", SqlDbType.VarChar, 255).Value = m_ApplicationName;

                    updateCmd.ExecuteNonQuery();
                }
            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:19:11.020

您是否尝试过在 sqlcommand 中指定参数名称？问号对我来说似乎很奇怪

```
SqlCommand cmd = new SqlCommand("SELECT UserID, Email, PasswordQuestion," +
    " Comment, IsApproved, IsLockedOut, CreationDate, LastLoginDate," +
    " LastActivityDate, LastPasswordChangedDate, LastLockedOutDate" +
    " FROM Users WHERE Email = @email AND ApplicationName = @applicationname", conn); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:18:48.090

您是否尝试过使用 Dataadaptor 而不是阅读器？无论如何，您都没有正确关闭阅读器，这可能会导致您的网站出现内存问题。老实说，除了非常具体的情况外，我几乎总是与读者有问题。

# git - Git - 递归地重新映射文 件所有权

> ID：10826391
> 
> 赞同：1
> 
> 时间：2012-05-31T01:31:00.760
> 
> 标签：git

我必须相信有人以前遇到过这种情况，并希望能对这个问题有所了解。我们公司收购了另一个也使用 Git 的公司。在迁移过程中，用户帐户将使用新格式重命名。问题是，当我们移动 Git 存储库时，存储库中引用的帐户将与新的用户 ID 不匹配。

将 Git 存储库移动到我的服务器时，有没有办法将当前文件和存储库的历史重新映射到更改后的 id？到目前为止，我发现的唯一方法是在从 svn 迁移到 git 时重新映射用户时使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:34:46.187

我*强烈反对*尝试修改历史提交的用户名。您将不得不重写整个历史树，这会给过去曾经克隆过存储库的任何人带来问题（如果没有大量工作，任何东西都不会合并）。

相反，接受过去，让每个人在未来的工作中使用新格式的用户名，然后继续前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:34:56.987

听起来您在谈论文件所有权。Git 不跟踪文件所有权。它跟踪的唯一模式位是可执行位。文件由创建工作树的任何用户创建。

如果实际上您正在谈论每次提交的作者/提交者信息，那是另一回事。正如 Greg 所说，我不鼓励您尝试重写该信息，因为这将重写存储库的整个历史。如果你真的想这样做，你可以使用一个`git filter-branch`命令加上适当的`--env-filter`脚本来对作者/提交者信息进行任何你想要的映射。

# mysql - 从 3 个表中选择查询语法错误

> ID：10826393
> 
> 赞同：0
> 
> 时间：2012-05-31T01:31:42.250
> 
> 标签：mysql, sql, multiple-tables

给定关于对象的信息：id、user_id、group_id

给定用户信息：id_user, id_loc

我需要得到一个查询：

*   用户名（在表 users 中）

*   用户所在位置的名称（在表 locs 中）

*   对象组的名称（在表组中）

我正在尝试这样：

```
SELECT usuarios.first_name as username
    , usuarios.id as userid
    , usuarios.avatar as useravatar
    , usuarios.id_loc
    , locs.name as locname
    , groups.name as groupname 
FROM usuarios,groups,locs 
WHRE usuarios.id_loc = locs.id 
    AND usuarios.id = 1 
    AND group.id = LIMIT 1 
```

有一个错误说

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的“AND locs.id = 3 LIMIT 1”附近使用正确的语法

我究竟做错了什么？我可以在一个查询中做到这一点吗？

-编辑-

这是查询生成器代码（php+mysql）：

```
$query_loc_group_user = 'SELECT usuarios.first_name as username,
                                            usuarios.id as userid,
                                            usuarios.avatar as useravatar,
                                            usuarios.id_loc, 
                                            locs.name as locname,
                                            groups.name as groupname
                                     FROM   usuarios,groups,locs
                                     WHRE   usuarios.id_loc = locs.id
                                     AND    usuarios.id = '.$this->id_user.'
                                     AND    group.id = '.$this->id_group.'
                                     LIMIT 1'; 
```

如果有帮助，我正在尝试在一个查询中执行此操作

```
function get_info(){
    $info;
    $result = cache_query('SELECT first_name,last_name,avatar FROM   usuarios WHERE  id = '.$this->id_user);
    foreach($result as $extra){
        $info['username'] = $extra['first_name'].' '.$extra['last_name'];
        $info['avatar'] = $extra['avatar'];
    }
    $result1 = cache_query('SELECT name FROM locs WHERE  id = '.$this->id_user);
    foreach($result1 as $extra){
        $info['locname'] = $extra['name'];
    }   
    $result2 = cache_query('SELECT name FROM groups WHERE  id = '.$this->id; /*objectid*/
    foreach($result2 as $extra){
        $info['groupname'] = $extra['name'];
    }
    return $info;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:13:32.307

那这个呢？

```
$sql = 'SELECT usuarios.name as username,usuarios.avatar as useravatar, usuarios.id_loc, locs.name as locname';
$sql .= ' FROM usuarios, groups, locs';
$sql .= ' WHERE usuarios.id = '.$this->id_user.' AND groups.id = '.$this->id_group.' AND locs.id = '.$this->id_loc.' LIMIT 1';

$res = mysql_query($sql) or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T04:35:08.260

您需要一些东西来将 usuarios 或 locs 与组相关联。我不知道你的架构，但它可能是这样的：

```
SELECT
    usuarios.first_name as username,
    usuarios.id as userid,
    usuarios.avatar as useravatar,
    usuarios.id_loc,
    locs.name as locname,
    groups.name as groupname
FROM
    usuarios,
    groups,
    locs
WHRE
    usuarios.id_loc = locs.id AND
    [something?] = groups.id AND    -- This is what you're missing.
                                    -- What table/column relates to groups?
    usuarios.id = 1 AND
    group.id = 1
LIMIT 1 
```

... where [something?] 可能是 usuarios 或 locs 中的 id_group 列。现在，您的顶级查询有两个错误。第一个是简单的语法错误，您没有指定 group.id 值。但是，第二个更严重的是，您的 groups 表没有连接子句。

如果您发布三个表的架构，我可能会给您一个更好的答案，但我敢打赌这就是您所缺少的。如果您在 usuarios 或 locs 中没有 group_id 列，那么您需要更清楚您要查询的确切内容，并且一些示例数据可能对您的预期结果有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T16:42:45.807

在一些帮助朋友之后，我得到了这个解决方案

```
SELECT usuarios.first_name,usuarios.last_name,usuarios.avatar,poblacion.poblacion,groups.name as groupname
                                FROM usuarios LEFT JOIN poblacion ON usuarios.id_loc=poblacion.idpoblacion,
                                     helps LEFT JOIN groups ON helps.id_group = groups.id
                                WHERE  usuarios.id = '.$this->id_user.' AND groups.id = '.$this->id_group 
```

# map - shapefile 可以包含相互重叠的形状吗？

> ID：10826394
> 
> 赞同：1
> 
> 时间：2012-05-31T01:31:47.687
> 
> 标签：map, buffer, gis, shapefile

当我想将 shapefile 缓冲到新的 shapefile 时，我有一个问题，如下图所示。我是 GeoProcessing 的新手，请引导我以正确的方式。

谢谢。

![在此处输入图像描述](../Images/a9a29a786ad45a3088d1fc9923f0a344.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T07:16:01.823

标题中您的问题的答案是“是”，shapefile 可以包含重叠的多边形。

但是你的照片在问别的东西......

在左侧，您展示了将三个特征保存到 shapefile 的情况，每个缓冲区一个。在这种情况下，每个特征都是输入 shapefile 中特定特征的缓冲区。

在右侧，您保存了一个要素。这是缓冲区的联合区域。

您想要哪一个取决于您要问的问题 - 在左侧，您将能够识别给定输入要素距离内的点，在右侧，您可以说的关于一个点的所有内容是它是否在距离任何输入特征。

当你做缓冲时你得到哪一个取决于你使用的软件。它可能有一个选项，可以像在左侧一样返回单个缓冲区，也可以像在右侧一样将它们全部合并。

在 R 中，使用 rgeos 和 gBuffer，您可以使用 gBuffer(shapes, buffer, byid=TRUE) 来获取左侧的单个缓冲区（每个“id”一个）。否则（byid=FALSE）你会得到一个合并的缓冲区多边形，就像右边一样。

# php - 如何限制此 MySQL 查询的结果？

> ID：10826403
> 
> 赞同：0
> 
> 时间：2012-05-31T01:34:15.460
> 
> 标签：php, mysql, sql

我无法将 LIMIT 变量添加到以下代码中。我试图只显示第一条记录，但是当我在代码的 .$gid 部分之后添加“LIMIT 1”时，出现错误。我已经尝试了每个变量。我也不确定为什么 " 空间周期 $gid 的格式是这样的。

```
<?php

$sql = "SELECT * FROM `loan_real_types` WHERE fKeyGroup = " . $gid;
$result = mysql_query($sql) or die(mysql_error());
while($results = mysql_fetch_assoc($result)) {
    echo "" . $results['name'] . "";
}

?> 
```

最终，我只是想显示 fkeyGroup 匹配的表的第一条记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:35:03.650

您可能只是忘记在之前添加空间`LIMIT`会导致错误。

```
$sql = "SELECT * FROM `loan_real_types` WHERE fKeyGroup = " . $gid . " LIMIT 1"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:36:37.483

```
$sql = "SELECT * FROM `loan_real_types` WHERE fKeyGroup = " . $gid . " LIMIT 1";
$result = mysql_query($sql) or die(mysql_error());
// just use if here
if ($results = mysql_fetch_assoc($result)) {
  echo "" . $results['name'] . "";
} 
```

# python - Django中的模板问题

> ID：10826407
> 
> 赞同：0
> 
> 时间：2012-05-31T01:34:44.383
> 
> 标签：python, django, django-templates

我被困在[*实际做某事的写视图*](https://docs.djangoproject.com/en/1.4/intro/tutorial03/)部分。我已按照指示将我的观点修改为以下内容：

```
from django.template import Context, loader
from polls.models import Poll
from django.http import HttpResponse

def index(request):
    latest_poll_list = Poll.objects.all().order_by('-pub_date')[:5]
    t = loader.get_template('polls/index.html')
    c = Context({
        'latest_poll_list': latest_poll_list,
    })
    return HttpResponse(t.render(c))

def detail(request, poll_id):
    return HttpResponse("You're looking at poll %s." % poll_id)

def results(request, poll_id):
    return HttpResponse("You're looking at the results of the poll %s." % poll_id)

def vote(request, poll_id):
    return HttpResponse("You're voting on poll %s." % poll_id) 
```

我已经`/home/stanley/mytemplates/polls/`按照教程中的说明制作了我的模板目录，这是与以下内容匹配的相关行`settings.py`：

```
TEMPLATE_DIRS = (
    "/home/stanley/mytemplates/",
    # Put strings here, like "/home/html/django_templates" or "C:/www/django/templates".
    # Always use forward slashes, even on Windows.
    # Don't forget to use absolute paths, not relative paths.
) 
```

但是，在 localhost ( ) 中运行服务器后，我仍然在浏览器中看到以下错误消息`http://127.0.0.1:8000/polls/index.html`：

```
Page not found (404)
Request Method: GET
Request URL:    http://localhost:8000/polls/index.html
Using the URLconf defined in mysite.urls, Django tried these URL patterns, in this order:
^polls/$
^polls/(?P<poll_id>\d+)/$
^polls/(?P<poll_id>\d+)/results/$
^polls/(?P<poll_id>\d+)/vote/$
^admin/
^admin/
The current URL, polls/index.html, didn't match any of these.
You're seeing this error because you have DEBUG = True in your Django settings file. Change that to False, and Django will display a standard 404 page. 
```

我的代码或文件有问题，但无法弄清楚到底是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T02:01:16.253

索引视图的 url 是`/polls/`，不是`/polls/index.html`。

```
url(r'^polls/$', 'polls.views.index'), 
```

如果你想让 /polls/index.html 工作，你必须为其添加一个 url 模式，例如：

```
url(r'^/polls/index.html', 'polls.views.index'), 
```

However, you probably don't want to do that. One of the nice things about Django is that you can define the urls independently of the views and templates, so you don't need 'crufty' urls that end in `.html`.

# javascript - Chrome 扩展 contenteditable 获取和设置插入符号位置

> ID：10826409
> 
> 赞同：2
> 
> 时间：2012-05-31T01:34:51.493
> 
> 标签：javascript, google-chrome, google-chrome-extension, contenteditable

**在 google 扩展程序中使用 DOM**

我正在创建一个**Google Chrome 扩展程序**，我需要在其中将链接插入到**gmail**窗口中。我能够在窗口顶部创建一个简单的扩展按钮并执行替换电子邮件文档中元素的代码。

现在，我想在我键入时在**contenteditable部分中添加链接。**似乎应该有一种简单的方法来用 javascript 文档对象模型中的链接替换文本。这也只需要为 chrome 工作，因为我不打算很快创作一个 firefox 或 ie 版本。

**最初我试图做以下事情：**

1.  从当前插入符号位置插入文本
2.  捕获插入符号位置。
3.  通过偏移量设置插入符号的位置。

**getSelection，没那么快**

我尝试在 gmail 上下文中使用**window.getSelection**（这是一个设置为 contenteditable 并嵌入到 gmail 选项卡中的 iframe 中的正文元素）来获取当前范围和位置。无论是否选择了文本，选择始终为空且不包含任何范围。

我发现**getSelection**代码不起作用的原因是因为在错误的窗口上选择了**document.getSelection 。**当您在 gmail 中创建新消息时，有 5 个 iframe（windows）可用。在这个框架内部有一个称为嵌套的 iframe，它需要调用**getSelection**才能获得正确的文本选择。这是一些代码，可让您在电子邮件的内容可编辑区域中获取选定的插入符号位置。

**这是获取 gmail 文档窗口选择的一种方法**

```
var mySelection = $("iframe")[4].contentDocument.
    querySelector("iframe").contentDocument.getSelection(); 
```

**第一次文本替换尝试**

我现在希望更接近解决方案。抱歉，如果草率，我找不到有关如何编写此代码的任何好的文档。

```
// Select the keyword
var range = s.getRangeAt(0);
var keyEl = range.startContainer.splitText(index);
var newRange = doc.createRange();
newRange.selectNode(keyEl);
s.removeAllRanges();
newRange.setEnd(keyEl, length);
s.addRange(newRange);

// Insert the link
var newLink = document.createElement("a");
newLink.setAttribute("href", value);
s.removeAllRanges();
newRange.surroundContents(newLink);

// Set the position
newRange.setStartAfter(newLink);
newRange.collapse(true);
s.addRange(newRange); 
```

这几乎可以完美地工作，但问题是文本插入符号位于链接内，因此任何在此之后键入的文本都被插入到链接中。这是个大问题。而且，尝试了一些事情，我能够让这个问题部分消失。一个类似的新问题导致了一些奇怪的链接，这些链接延伸到以下单词，但仅限于几个字符。

**希望是文本替换的最后尝试**

```
// find position in text 
var index = s.focusNode.data.search(keyword);
var length = keyword.length;

var range = s.getRangeAt(0);
var keyEl = range.startContainer.splitText(index);
var newRange = doc.createRange();
newRange.selectNode(keyEl);
s.removeAllRanges();
newRange.setEnd(keyEl, length);
s.addRange(newRange);

var newLink = document.createElement("a");
newLink.setAttribute("href", value);
$(newLink).css("text-decoration", "none");
$(newLink).css("cursor", "pointer");
$(newLink).css("color", "color:#3366FF");
newRange.surroundContents(newLink);
newRange.collapse(false);
s.removeAllRanges();
s.addRange(newRange); 
```

在我的许多试验中似乎普遍存在一个问题，现在已经消失了。这产生了一些奇怪的链接，这些链接延伸到以下单词。

**随时帮我清理代码以使其更简洁**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T17:35:20.373

如果您确切知道要插入插入符号的位置，则应该这样做：

```
var node = someTextNode;
var caret = 10; // insert caret after the 10th character
var range = document.createRange();
range.setStart(node,caret);
range.setEnd(node,caret);
var sel = window.getSelection();
sel.removeAllRanges();
sel.addRange(range); 
```

然而，这仅适用于 DOM 文本节点。因此，如果您想操作 contenteditable div 或类似内容的内容，您将不得不递归遍历其子元素并检查文本节点。

我最近编写了一个 Chrome 扩展程序，可以在包括 GMail 在内的网站上进行文本替换 - 这是相应 jQuery 插件的来源，如果它适合您的用例，请随意利用它：[https ://github.com/squidpeople/ASCIImoji/blob/大师/asciimoji.jquery.js](https://github.com/squidpeople/ASCIImoji/blob/master/asciimoji.jquery.js)

# c - UDP数据包解码建议

> ID：10826411
> 
> 赞同：2
> 
> 时间：2012-05-31T01:35:00.593
> 
> 标签：c, sockets, udp

我正在开发一个 C 应用程序来与一个真正的控制系统设备进行通信。该设备使用定义良好的协议结构。例如，考虑设备在请求时作为 UDP 数据包发送的结构之一：-

```
typedef struct poll_request_s {
   uint16             poll_number; /* poll number mirrored from the 
                                    * poll request */
   uint16             length;      /* length of the message */

   /* till above it was all header section this is ACTUAL DATA */
   attribute_list_t   attr_list;   /* this attribute list contains 
                                    * various attributes */
} poll_request_t 
```

现在，`attribute_list_t`是一个包含各种属性的结构，并且此列表中的每个属性都由一个标识符号标识，该标识符号是`uint16`（16 位整数）。所以，简而言之，协议的工作原理是这样的：-

*   你请求一些数据。
*   您以属性列表的形式获取数据。
*   属性列表中的每个属性都有对象标识符。
*   您使用此对象标识符解析每个属性（转换为主机字节顺序）。
*   属性本身可能包含更多的属性列表。（属性初始）

这种`atrtribute_list_t`结构如下所示：-

```
typdef struct attribute_list_s {
   uint16  length;       /* length of attribute list */
   uint16  count;        /* number of attributes in this list */
   uint8   attrs_data[]; /* another container to hold attributes' data */
} attribute_list_t 
```

现在，`attrs_data`只是一个占位符，用于保存列表中的所有属性。事实上，这`attrs_data`必须转换为另一个结构，称为`ava_type`读取属性信息。

```
typdef struct ava_type_s {
   uint16 attr_id; /* type of attribute */
   uint16 length;  /* length of this attribute 
                    *(this length of single attribute not whole list*/
   uint8  data[];  /* another flexible array to hold data for this 
                    * attribute type */
} 
```

现在，为了迭代和解析这个结构中的属性，我目前正在使用这个算法（下面的伪代码）：

```
uint8* packet = recv_packet(SOCKET);
/* this is used as packet iterator pointer */
unit8* packet_ptr = packet;
parsed_packet_t parsed_packet = malloc(SOME_SIZE);
.
. /* do header un-packing */
.
/* dont need attribute_list length so skip this 2 bytes */
parsed_packet += 2;

/* parsed packet do nee count of attributes */
parsed_packet.attribute_list->count = NTOHS(packet_ptr);
packed_ptr += 2; /* skip count */

/* now packet_ptr is pointer to attr_list */
offset = 0, i = 0;
for(i = 0 to attr_list->count) {
   /* cast the attributes' data to ava_type */
   packet_ptr += offset;

   /* parse object identifier */
   parsed_packet.attribute_list->data[i++].object_id = NTOHS(packet_ptr);
   packet_ptr += 2; /* skip 2 bytes */

   /* next offset would be attribute length of this packet */
   attribute_length += 2 + NTOHS(packet_ptr);
   packet_ptr += 2;

   /* now we are pointer to actual data of i(th) attribute */

   /* I've made this parser structure and hash table to
    * retrieve the parser for particular attr_id */
   parser* p = HASH_TABLE(ava_type->attr_id);

   /* parser has function point for network order to host 
    * order and visa-versa */
   p->ntoh(ava_type, parsed_packet.attribute_list->data[i]);
} 
```

现在，我的问题是：

*   即使，我已经`HASH_TABLE`在上述算法中展示了方法，但实际上，我使用的是 20 到 30 `IF-ELSE`。由于 C 没有`hash table`in `stdlib`。协议中有大约 600 结构，我不想写 600 `if-else`。你对按照他们的`attribute_id`.
*   另一个问题是我定义的结构中的编译器填充。我所有的结构都是用`flexible array`数据容器的字段定义的。现在，当我收到消息时，它们`length`几乎包含每个属性，但这`length`不能用于`malloc..ing`我的解析结构，因为编译器可能会神奇地添加一些填充字节并且我得到字节不足。为了安全起见，我通常是`malloc..ing`关于字节的。`lenght + 300`事实上，这在我看来是糟糕的内存管理实践。关于这个问题有什么建议吗？

`malloc..ing`到目前为止，解析接收到的消息的结构对我来说是最大的问题。我想要一些内存高效且快速的方法吗？

另外，如果你已经做过这样的项目，你会分享你的方法吗？有什么建议或意见可以让我朝着正确的方向前进吗？我想要简单的设计，而不会使事情不必要地复杂化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:49:47.537

我*强烈*建议您不要使用`C`结构来定义您的网络协议。`C`结构布局取决于：

1.  硬件
2.  编译器
3.  编译器版本
4.  源代码
5.  源代码中嵌入的#pragmas（如果有）
6.  编译源代码时生效的编译器选项。

使用 XDR 或其他可以为您提供标准格式的东西。您应该能够准确定义您现在在 XDR 中拥有的内容，并自动为您完成所有编码和解码。

# winforms - BackgroundImage 和按钮的图像有什么区别？

> ID：10826413
> 
> 赞同：7
> 
> 时间：2012-05-31T01:35:42.603
> 
> 标签：winforms, image, button, background

我有一个简单的问题，如果我在 Windows 窗体中有一个名为 myButton 的按钮，那么 myButton.Image 和 myButton.BackgroundImage 有什么区别？先感谢您！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T01:43:30.350

`BackgroundImage`就像墙纸一样，它覆盖了整个背景..您应该使用图案或完整的图片作为背景。如果您只是想显示一个图标，请使用`Button.Image`

对于`Button.Image`MS 文档中的属性：

**按钮控件上显示的图像。**

背景图像

**表示要在控件背景中显示的图像的 Image。**

所以你可以设置 a`BackgoundImage`和 a`Button.Image`将`Button.Image`被放置在`BackgroundImage`

> 注意：Windows 窗体控件不支持将具有半透明或透明颜色的图像用作背景图像。RightToLeftLayout 属性为 true 的子控件不支持此属性。

这是我刚刚创建的一个示例，其中`Button`包含两者`BackgroundImage`和`Button.Image`设置。显然有一个背景图像，然后是我的按钮文本和我的文本旁边的按钮图像。

![BackGroundImage 与 Button.image](../Images/ec3f0dffc40339cc9231987e413fe02f.png)

很酷的事情是你可以改变你把你`Button.Image`的`ImageAlign`财产放在哪里

![图像对齐](../Images/9c7aa5b256fd9ce0c6657b1cdc03a3e2.png)

这是使用透明图标而不使用 RTL 的相同按钮，我将背景颜色设置为浅蓝色，一切正常。所以要么我的透明图标真的不透明，要么文档是错误的。

![在此处输入图像描述](../Images/e0b3be784aef1ed9b7ef64581cc68cec.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T01:39:28.400

背景图像 - 顾名思义，图像被设置在背景中，文本出现在它上面。

图片 - 图片与提供的文本相邻（并排）。（见图）

![在此处输入图像描述](../Images/a1352ce5945cd33e742a62b5408c0e44.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T01:51:00.190

myButton.Image=> 按钮控件上显示的图像。myButton.BackgroundImage=> 要在控件背景中显示的图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-28T13:02:07.180

BackgroundImage 的一个优点是 BackgroundImageLayout = Stretch/Zoom 选项，它可以将图标图像调整为按钮大小。

# java - 通过谷歌应用引擎在电子邮件中将 HTML5 Canvas 图像作为嵌入图像发送

> ID：10826420
> 
> 赞同：0
> 
> 时间：2012-05-31T01:36:55.647
> 
> 标签：java, html, google-app-engine, gwt, canvas

我在 GWT + GAE 上运行 Java 应用程序

我想获取我的 html5 Canvas（GWT Canvas 类）的内容，并将它们保存在一个永久的 Web 可寻址文件中

示例：[http ://myserver.com/images/image_434.png](http://myserver.com/images/image_434.png)

当我使用 canvas2.toDataUrl() 获取画布内容时...

1-是否可以通过 HTTP 请求将这些内容发布到 PHP Web API，然后使用 PHP（在我的服务器上）解码 64 位图像并将其写入文件并返回永久链接。

或者

2-是否有可能以某种方式将 RPC 的图像数据发送到服务器端，将其保存到文件中（在 GAE 中阻止 ImageIO），然后以某种方式将该文件嵌入到电子邮件中并将其通过电子邮件发送到我的服务器。

我很困惑，因为：

方法1：我怀疑是否行得通，发布这么长的参数，我不确定，但我有一种行不通的直觉。

方法 2：如果我能弄清楚如何在没有可靠文件 URL 的情况下将图像嵌入邮件中（通过以某种方式直接将流写入消息正文）可能会起作用。

如您所见，我通常对此感到困惑。做到这一点不应该这么难，而且我不能是唯一一个试图做到这一点的人……尽管我现在已经搜索了 3 天。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T13:57:24.890

*   客户端（GWT）：

1- 获取 base64 编码的图像 URI

```
String imageData= canvas2.toDataUrl(); 
```

2- 通过 RPC 调用将图像数据发送到服务器端

```
jdbc.saveImage(imageData,callback); 
```

*   服务器端（GAE）：

3- 向您的 Web 服务器 API 发出 HTTP Post 请求

```
 URL url = new URL("http://myserver.com/my_images_folder/save_image.php");
        URLConnection conn = url.openConnection();
        conn.setReadTimeout(15000); //set a large time out since we're saving images
        conn.setDoOutput(true);
        OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
        wr.write(data);
        wr.flush();

        // Get the response which contains the image file name
        BufferedReader rd = new BufferedReader(new InputStreamReader(conn.getInputStream()));
        String line;
        while ((line = rd.readLine()) != null) {
            resa+=line;
        }
        wr.close();
        System.out.println("close1");
        rd.close();
        System.out.println("Received: "+line); 
```

*   服务器端（您的 Web 服务器 -php API）：

4-将图像保存到文件服务器并返回图像文件名

```
 if (isset($GLOBALS["HTTP_RAW_POST_DATA"])){
        $imageData=$GLOBALS['HTTP_RAW_POST_DATA'];

        //using a timestamp to create unique file names
        //you can pass file name in params if you like instead
        $fileName='User_Images_'.time().'.png';

        // Remove the headers (data:,) part.  
        $filteredData=substr($imageData, strpos($imageData, ",")+1);

        // Need to decode base64 encoded image
        $unencodedData=base64_decode($filteredData);

        $fp = fopen( $fileName, 'wb' );
        fwrite( $fp, $unencodedData);
        fclose( $fp );
    $fileName2='http://myserver.com/my_images_folder/'.$fileName;

    //return the file name
    echo($fileName);
 }else{
    echo('no data posted');
 } 
```

现在我有了文件的硬永久链接，我可以将它嵌入到电子邮件中并用它做其他事情。请参阅下面的参考 3 以了解内联嵌入（这需要文件或 URL，现在我们的网络服务器上有图像的硬 URL，我们可以通过电子邮件将其发送出去）

# android - ImageView 填充父母的宽度或高度，但保持纵横比

> ID：10826422
> 
> 赞同：49
> 
> 时间：2012-05-31T01:37:19.777
> 
> 标签：android, android-layout, android-imageview, android-relativelayout

我有一个方形图像（尽管这个问题也适用于矩形图像）。我想尽可能大地显示图像，必要时拉伸它们以填充它们的父母，同时仍然保持纵横比。图像小于 ImageView。问题是，我无法拉伸图像并“匹配”ImageView 的高度和宽度。

这是我的 XML 布局文件：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:padding="10dp">

    <ImageView android:id="@+id/image"
               android:layout_width="fill_parent"
               android:layout_height="fill_parent"
               android:adjustViewBounds="true"
               android:scaleType="fitCenter"
               android:layout_marginTop="10dp"/>

    <TextView android:id="@+id/name"
              android:layout_below="@id/image"
              android:layout_alignLeft="@id/image"
              android:layout_marginTop="20dp"
              android:layout_width="fill_parent"
              android:layout_height="wrap_content"
              android:textSize="18dp"/>

    <TextView android:id="@+id/name2"
              android:layout_below="@id/name"
              android:layout_width="fill_parent"
              android:layout_height="wrap_content"
              android:textSize="14dp"/>

</RelativeLayout> 
```

我使用了多种 scaleTypes: , , ,的组合`fill_parent`，它们都以正确的纵横比绘制图像，但**它们都没有真正放大图像和 ImageView 本身**，导致 TextViews 被全部推送远离屏幕、ImageView 内的空白区域、图像未缩放或图像被裁剪。`wrap_content``fitCenter``fitStart``fitEnd``centerInside`

 **我无法完全确定正确的组合。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-05-31T02:06:12.450

这些：

```
android:layout_height="wrap_content"
android:scaleType="fitStart"
android:adjustViewBounds="true" 
```

应该调整图像的大小并更改边界的大小以适应新的图像大小。如果它没有在您的设备上执行此操作，请发布您正在使用的图像以及您正在测试的设备。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-12-09T18:13:08.040

使用此代码： `android:scaleType="fitXY"`

有关图像缩放的更多详细信息，请在[此处查看本文中的动作](http://bon-app-etit.blogspot.in/2014/01/imageview-scaletypes.html)

概括：

*   `center`

> 在视图中居中图像，但不执行缩放

![在此处输入图像描述](../Images/2c2334c97624db31db65477bb70fbd37.png)

*   `centerCrop`

> 均匀缩放图像（保持图像的纵横比），使图像的两个尺寸（宽度和高度）都等于或大于视图的相应尺寸（减去填充）。然后图像在视图中居中

![在此处输入图像描述](../Images/78ab3594a10f3641c1b58affb33b7f5f.png)

*   `centerInside`

> 均匀缩放图像（保持图像的纵横比），使图像的两个尺寸（宽度和高度）都等于或小于视图的相应尺寸（减去填充）

![在此处输入图像描述](../Images/e6c49d444a90a5394e0c6fac07ed1a13.png)

*   `fitCenter`

![在此处输入图像描述](../Images/89b01a990ee1528762c3d6b104cd2be3.png)

*   `fitEnd`

![在此处输入图像描述](../Images/365d9fa9dea10c08b7c0dd81dcf795cf.png)

*   `fitStart`

![在此处输入图像描述](../Images/c11ee4e635b390efa338430787232bc9.png)

*   `fitXY`

![在此处输入图像描述](../Images/0fe8e8baaf8541f794a9e64113053bf7.png)

*   `matrix`

> 绘图时使用图像矩阵进行缩放

![在此处输入图像描述](../Images/d04bd102231c615c04e092dbdea48aed.png)

更多细节[在这里](https://robots.thoughtbot.com/android-imageview-scaletype-a-visual-guide?utm_source=Android%20Weekly&utm_campaign=1096591845-Android_Weekly_221&utm_medium=email&utm_term=0_4eb677ad19-1096591845-337990929)新文章

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2017-09-24T06:27:38.933

此 xml 代码将起作用！如果您指定您的应用程序宽度始终与窗口相同，则将`android:adjustViewBounds="true"`根据图像的比例设置高度。

```
 <ImageView
        android:adjustViewBounds="true"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:src="@drawable/screen"/> 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-07-25T10:20:38.623

将此代码与视图布局参数一起用作 wrapcontent

机器人：adjustViewBounds =“真”

希望这会奏效。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-07-02T01:52:51.227

我有同样的问题，android:adjustViewBounds 没有完成它的工作并且在图像顶部有一个填充。进入具有宽度和高度的 match_parent 值的相对布局，我有：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:orientation="vertical" android:layout_width="match_parent"
   android:layout_height="match_parent"
   android:background="@color/transparent">

   <ImageView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:scaleType="fitStart"
    android:adjustViewBounds="true" ... 
```

我将相对布局更改为具有 wrap_content 宽度和高度值的线性布局，现在可以了：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-05T20:53:30.533

您是否尝试以编程方式对其进行调整？我认为如果您计算`TextView`s 的高度并基于此调整图像的高度和宽度，它会非常有效。

```
private void adjustImageView()
{
    //Get the display dimensions
    DisplayMetrics metrics = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(metrics);

    //TextView name
    TextView name = (TextView) findViewById(R.id.name);
    name.setText("your name text goes here");
    name.measure(0, 0);

    //name TextView height
    int nameH = name.getMeasuredHeight();

    //TextView name2
    TextView name2 = (TextView) findViewById(R.id.name2);
    name2.setText("your name2 text goes here");
    name2.measure(0, 0);

    //name2 TextView height
    int name2H = name2.getMeasuredHeight();

    //Original image
    Bitmap imageOriginal = BitmapFactory.decodeResource(getResources(), R.drawable.image);

    //Width/Height ratio of your image
    float imageOriginalWidthHeightRatio = (float) imageOriginal.getWidth() / (float) imageOriginal.getHeight();

    //Calculate the new width and height of the image to display 
    int imageToShowHeight = metrics.heightPixels - nameH - name2H;
    int imageToShowWidth = (int) (imageOriginalWidthHeightRatio * imageToShowHeight);

    //Adjust the image width and height if bigger than screen
    if(imageToShowWidth > metrics.widthPixels)
    {
        imageToShowWidth = metrics.widthPixels;
        imageToShowHeight = (int) (imageToShowWidth / imageOriginalWidthHeightRatio);
    }

    //Create the new image to be shown using the new dimensions 
    Bitmap imageToShow = Bitmap.createScaledBitmap(imageOriginal, imageToShowWidth, imageToShowHeight, true);

    //Show the image in the ImageView
    ImageView image = (ImageView) findViewById(R.id.image);
    image.setImageBitmap(imageToShow);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-21T09:29:20.910

Set `android:layout_height="wrap_content"` in imageview. To create an image with width equals screen width, and height proportionally set according to aspect ratio, do the following. Here I mention how to load image to imageview from url.

```
Glide.with(context).load(url).asBitmap().into(new SimpleTarget<Bitmap>() {
                    @Override
                    public void onResourceReady(Bitmap resource, GlideAnimation<? super Bitmap> glideAnimation) {

                        // creating the image that maintain aspect ratio with width of image is set to screenwidth.
                        int width = imageView.getMeasuredWidth();
                        int diw = resource.getWidth();
                        if (diw > 0) {
                            int height = 0;
                            height = width * resource.getHeight() / diw;
                            resource = Bitmap.createScaledBitmap(resource, width, height, false);
                        }
                                              imageView.setImageBitmap(resource);
                    }
                }); 
```

Hope this helps.**

# html - 带有 CSS 的浮动侧边栏

> ID：10826427
> 
> 赞同：1
> 
> 时间：2012-05-31T01:38:28.897
> 
> 标签：html, css, sidebar

我设置了一个具有固定位置的特定背景颜色的侧边栏，以便在您向下滚动页面时它会保持原位。到目前为止一切似乎都很好，我唯一修改的是去掉列表样式类型，这样侧栏中就不会出现项目符号了。我不知道，也许我一路上搞砸了一些东西，但我就是不知道在哪里！

现在，链接出现在标题旁边，没有背景颜色，并且它们不在固定位置。

有任何想法吗？

```
<!--main container,
gives content area width and centers it horizontally--> <!--width of wrap will be subtracted from width of the browser window (its container)--> #wrap {
  width: 750px;
  margin: 0 auto;
  background: #FFFFFF;
  position: relative;
}
h1 {
  margin: 0;
  background: #cc9
}
#nav {
  padding: 5px 10px;
  background: #FFF;
}
#main {
  float: left;
  width: 480px;
  padding: 10px;
  background: #FFF;
}
h2 {
  margin: 0 0 1em;
}
<!--Setting position to fixed and margin-left will keep sidebar scrolling on page--> #sidebar {
  float: right;
  width: 200px;
  padding: 40px;
  background: #99c;
  position: fixed;
  margin-left: 520px;
}
#footer {
  clear: both;
  padding: 5px 10px;
  background: #cc9;
}
#footer p {
  margin: 0;
}
#nav ul {
  margin: 0;
  padding: 0;
  list-style: none;
}
#nav li {
  display: inline;
  margin: 0;
  padding: 0;
}
#sidebar ul {
  list-style-type: none;
}
<!--links--> a:link {
  color: black
}
a:visited {
  color: blue
}
a:hover {
  font-weight: bold
}
a:active {
  font-style: italic
}
.topnavlink {
  clear: left;
  margin-left: 1em;
  font-size: 1.1em
}
.sidenavlink {
  font-size: 1em
}
.footer {
  clear: left;
}
```

```
<DIV id="sidebar">
  <ul>
    <li><a href="http://www.google.com">Google</a>
    </li>
    <li>
      <a href="mailto:something@google.edu">Email Me</a>
    </li>
</DIV>
</DIV>

<DIV id="footer">
  <P>&copy;Something 2012</P>
</DIV>
</DIV>
</BODY>

</HTML>
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T01:45:29.180

评论是 CSS shoule
`/* comment */`

也不

`<!--comment-->`

是
你的 html 似乎有一些额外的关闭`</div>`
不确定那是不是因为它是更多代码的一部分

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T01:49:06.603

您需要结束标签，`</UL>`并且底部有额外的结束 div

```
<DIV id="sidebar">
            <ul>
                <li><a href="http://www.google.com">Google</a>
                </li>
                <li>
                <a href="mailto:something@google.edu">Email Me</a>
                </li>
            </UL>
        </DIV>

        <DIV id="footer">
            <P> &copy;Something 2012</P>
        </DIV> 
```

你评论错误的方式应该是这样的

```
/*main container, gives content area width and centers it horizontally
width of wrap will be subtracted from width of the browser window (its container)*/
#wrap {
width:750px;
margin:0 auto;
background:#FFFFFF;
position: relative;
}

h1 {
margin:0;
background:#cc9
}

#nav {
padding:5px 10px;
background:#FFF;
}

#main {
float:left;
width:480px;
padding:10px;
background:#FFF;
}

h2 {
margin:0 0 1em;
}

/*Setting position to fixed and margin-left will keep sidebar scrolling on page */
#sidebar {
float:right;
width:200px;
padding:40px;
background:#99c;
position:fixed;
margin-left:520px;
}

#footer {
clear:both;
padding:5px 10px;
background:#cc9;
}

#footer p {
margin:0;
}

#nav ul {
margin:0;
padding:0;
list-style:none;
}

#nav li {
display:inline;
margin:0;
padding:0;
}

#sidebar ul {
list-style-type:none;
}

<!--links-->
a:link {
    color: black
}
a:visited {
color: blue
}
a:hover {
font-weight: bold
}
a:active {
font-style: italic
}
.topnavlink {
clear: left; margin-left: 1em; font-size: 1.1em
}
.sidenavlink {
font-size: 1em
}
.footer {
clear: left;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T01:40:21.037

你`<ul>`用`</div>`而不是结束你的`</ul>`。纠正这一点，一切都应该到位。

# javascript - 使用 JavaScript 快速简便地发布到 Facebook 的方法？

> ID：10826429
> 
> 赞同：0
> 
> 时间：2012-05-31T01:38:40.197
> 
> 标签：javascript, facebook, facebook-graph-api, twitter, social-networking

我正在尝试在`textarea`不使用 SDK 的情况下从 a 和 Facebook 链接发布一些文本。我无法使用 SDK 的原因是我无法将 channel.html 添加到站点的根目录。有没有更简单的方法可以将内容发布到 Facebook 页面？它必须能够发布到页面和提要。让解决方案能够发布到 Twitter、Google+ 和 Pinterest 也很方便（Pinterest 没那么重要）。我希望有一些 JavaScript 库可以让您轻松发布到社交媒体网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T10:05:32.293

首先，使用 SDK 可以在没有通道文件的情况下使用，它可能性能不高。其次，频道文件不必在您的根目录中，您可以根据需要将其放置在站点目录层次结构的最下方——它只需要从同一个域并通过相同的协议加载，也许这就是你的误解……？

# gtk - 如何将自定义 gtkmm 小部件添加到 glade？

> ID：10826435
> 
> 赞同：9
> 
> 时间：2012-05-31T01:40:21.237
> 
> 标签：gtk, widget, glade, gtkmm

我正在[使用 gtkmm 编写一个自定义小部件](https://github.com/bstpierre/gtk-date-chooser)，但我无法让它在林间空地中工作。（小部件本身几乎没有功能；它确实可以工作，我想让它在 glade 中工作，然后再继续下一步。） Glade 找到了小部件，但是当我尝试将它放在窗口中时，glade 崩溃了。

根据我在各种搜索中发现的提示，我将这段代码添加到主源文件中：

```
extern "C"
{
    GType date_chooser_get_type(void)
    {
        return DateChooser::get_type();
    }
} 
```

我怀疑上面的代码不正确，但我找不到任何关于这个函数应该做什么的 gtkmm 或 glade 文档。

根据[glade 的目录文档](http://developer.gnome.org/gladeui/stable/catalogintro.html)，我创建了以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<glade-catalog name="gtk-date-chooser" library="libgtkdatechooser-0.1.so" language="c++">
  <glade-widget-classes>
    <glade-widget-class name="DateChooser" generic-name="date-chooser" title="Date Chooser" />
  </glade-widget-classes>
  <glade-widget-group name="date" title="Date">
    <glade-widget-class-ref name="DateChooser"/>
  </glade-widget-group>
</glade-catalog> 
```

它位于我的小部件源目录的根目录中，名称为`gtk-date-chooser.xml`. 我使用以下命令在该目录中运行 glade：

```
GLADE_CATALOG_SEARCH_PATH=. GLADE_MODULE_SEARCH_PATH=./.libs glade 
```

当窗口出现时，我的小部件出现在目录中指定的特殊“日期”组中，并带有默认图标。如果我放置一个窗口，然后选择要在窗口中放置的小部件，glade 会崩溃。我在控制台上看到以下内容：

```
GladeUI-Message: 2 missing displayable value for GtkWidget::events
GladeUI-Message: No displayable values for property GtkTreeSelection::mode
GladeUI-Message: 1 missing displayable value for GtkCellRendererAccel::accel-mode
GladeUI-Message: 14 missing displayable value for GtkCellRendererAccel::accel-mods

(glade:23757): GladeUI-CRITICAL **: gwa_list_signals: assertion `real_type != 0' failed

(glade:23757): GLib-GObject-WARNING **: cannot retrieve class for invalid (unclassed) type `<invalid>'

(glade:23757): GLib-GObject-CRITICAL **: g_object_class_list_properties: assertion `G_IS_OBJECT_CLASS (class)' failed

(glade:23757): GLib-GObject-WARNING **: cannot retrieve class for invalid (unclassed) type `<invalid>'

(glade:23757): Gtk-CRITICAL **: gtk_container_class_list_child_properties: assertion `GTK_IS_CONTAINER_CLASS (cclass)' failed
GladeUI-Message: Glade needs artwork; a default icon will be used for the following classes:
    DateChooser needs an icon named 'widget-gtk-date-chooser-date-chooser'
**
GladeUI:ERROR:glade-signal-model.c:800:glade_signal_model_iter_n_children: code should not be reached 
```

似乎[这个（未回答的）问题](https://stackoverflow.com/questions/10727979/is-it-possible-to-define-gtk-type-using-gtkmm)的答案可能会提供线索，但我无法找到该问题的任何答案或有助于解决我的问题的线索。

我正在使用的版本：

*   Ubuntu：12.04
*   gtkmm：3.4.0-0ubuntu1
*   林间空地：3.12.0-0ubuntu1

（我愿意基于主干版本或 Centos 6 或 Fedora 16 测试解决方案。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-13T09:30:13.827

将自定义*gtkmm*小部件添加到*Glade*需要以下内容：

1.  至少一个纯自定义小部件实现
2.  自定义小部件的一些与*Glade*相关的额外功能
3.  描述 Glade 的自定义小部件的目录文件
4.  一个库包含自定义小部件和一些与 Glade 相关的功能

最重要的是*Glade*是用*C*而不是*C++*编写的，因此我们必须能够将计划*C*小部件包装到*C++*小部件中，并且我们必须将此包装函数注册到`GType`与自定义小部件相关的。它看起来像以下内容：

```
#include "custom_widget.h"

GType CustomWidget::gtype = 0;

CustomWidget::CustomWidget (GtkEntry *gobj) :
  Gtk::Entry (gobj)
{
}

CustomWidget::CustomWidget () :
  Glib::ObjectBase ("customwidget")
{
}

Glib::ObjectBase *
CustomWidget::wrap_new (GObject *o)
{
  if (gtk_widget_is_toplevel (GTK_WIDGET (o)))
    {
      return new CustomWidget (GTK_ENTRY (o));
    }
  else
    {
      return Gtk::manage(new CustomWidget (GTK_ENTRY (o)));
    }
}

void
CustomWidget::register_type ()
{
  if (gtype)
    return;

  CustomWidget dummy;

  GtkWidget *widget = GTK_WIDGET (dummy.gobj ());

  gtype = G_OBJECT_TYPE (widget);

  Glib::wrap_register (gtype, CustomWidget::wrap_new);
} 
```

您应该非常仔细地编写目录文件。名称必须正确（尤其是`glade-widget-class`）才能正确工作。

```
<?xml version="1.0" encoding="UTF-8" ?>
<glade-catalog name="customwidgets" library="customwidgetsglade" depends="gtk+">

  <init-function>custom_widgets_glade_init</init-function>

  <glade-widget-classes>
    <glade-widget-class name="gtkmm__CustomObject_customwidget" generic-name="customwidget" icon-name="widget-gtk-entry" title="Custom Widget">
    </glade-widget-class>
  </glade-widget-classes>

  <glade-widget-group name="customwidgets" title="Custom Widgets" >
    <glade-widget-class-ref name="gtkmm__CustomObject_customwidget" />
  </glade-widget-group>

</glade-catalog> 
```

没有什么可做的，只是实现这个函数，它将我们的小部件注册为我们*Glade*库初始化的一部分。

```
extern "C" void
custom_widgets_glade_init ()
{
  Gtk::Main::init_gtkmm_internals ();
  custom_widgets_register ();
} 
```

初始化*gtkmm*内部是必须的，因为 `custom_widgets_glade_init`它是从*Glade 调用的，*它是用*C*而不是*C++*编写的，所以它只初始化*GTK+*。

如果您对该主题感兴趣，可以在[此处](http://szilard.blogs.balabit.com/en/2012/06/how-to-add-custom-gtkmm-widget-to-glade/)找到我的博客文章，其中包含更多详细信息。

# php - 在 5.3 之前的 PHP 中使用“create_function”比较器进行排序？

> ID：10826436
> 
> 赞同：5
> 
> 时间：2012-05-31T01:40:24.350
> 
> 标签：php, sorting, anonymous-function

我以前从未在 PHP 中使用过匿名函数，但我发现了一段代码，它使用一个来对对象进行排序

```
usort($numTurnsPerUser,build_sorter('turns'));

function build_sorter($key) {
    return function ($a, $b) use ($key) {
        return strnatcmp($a[$key], $b[$key]);
    };
} 
```

此代码将按键对对象进行排序（我传入“turns”）。例如，一个看起来像这样的对象：（用 JSON 编写，只是为了便于阅读）

```
$numTurnsPerUser = {
    "31":{
        "turns":15,
        "order":0
    }, "36":{
        "turns":12, 
        "order":1
    }, "37":{
        "turns":14, 
        "order":2
    }
} 
```

将被分类为如下所示的对象：

```
$numTurnsPerUser = {
    "36":{
        "turns":12,
        "order":1
    }, "37":{
        "turns":14,
        "order":2
    }, "31":{
        "turns":15, 
        "order":0
    }
} 
```

这在运行 PHP 5.3.0 的本地服务器上运行良好，但无法在运行“php5”的在线服务器上运行——除此之外我找不到任何信息。我收到一个错误

> 解析错误：语法错误，意外的 T_FUNCTION

我读到 PHP < 5.3 不能使用匿名函数，必须使用 create_function，但是匿名函数的“使用”部分让我很困惑。有人可以向我解释一下函数的“使用”部分是什么，或者更好的是，我如何将它“翻译”为所需的 create_function 参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:53:25.413

你可以这样做：

```
Class Sorter {
  private $key;

  public function __construct($key) {
    $this->key = $key;
  }

  public function sort($a, $b) {
    return strnatcmp($a[$this->key], $b[$this->key]);
  }
}

usort($numTurnsPerUser, array(new Sorter('key_b'), 'sort')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T17:26:18.943

直译（因为您特别要求`create_function`）：

```
function build_sorter($key) {
    return create_function('$a, $b', '$key = '.var_export($key, true).';
        return strnatcmp($a[$key], $b[$key]);
    ');
} 
```

如果你经常运行它，请小心，因为每次调用`create_function`它都会添加一个永远不会被破坏的全局函数。如果你这样做太多，它将耗尽内存。

# c# - 自动正则表达式生成器 - 2 个字符串 c# 之间的相似性

> ID：10826438
> 
> 赞同：1
> 
> 时间：2012-05-31T01:40:38.513
> 
> 标签：c#, regex

我正在尝试创建一个用于报废的正则表达式生成器，任何指导都值得赞赏。

我们的想法是，我们有一个大文本 (html)，我们选择 2 个（至少）始终相似的 DOM 元素（例如来自 google 的前 2 个结果），然后我们应该生成一个正则表达式来抓取（匹配）这个结果。

示例：选定元素 1（这将由用户输入）：

```
<a onmousedown="return rwt(this,'','','','1','AFQjCNHqQo9TrXtXXM5lDpiCmNQO9xwkhw','','0CGoQFjAA',null,event)" class="l" href="http://www.miniclip.com/"><em>Games</em> at Miniclip.com - Play Free Online <em>Games</em></a> 
```

选定的元素 2（这将由用户输入）：

```
<a onmousedown="return rwt(this,'','','','2','AFQjCNGlNySkvcXMxEUmjCMOJRQPCdqBHQ','','0CHIQFjAB',null,event)" class="l" href="http://www.games.com/"><em>Games</em>.com: Play <em>Games</em> Online - Free <em>Games</em>, Download <em>Games</em> <b>...</b></a> 
```

包含这两个元素的 HTML 文本：

```
<ol id="rso" eid="GcrGT_KHH4f3sgbXmci5Cw"><!--m--><li class="g"><div sig="U8P" bved="0CBUQkQo" pved="0CBQQkgowAA" class="vsc"><h3 class="r"><a onmousedown="return rwt(this,'','','','1','AFQjCNHqQo9TrXtXXM5lDpiCmNQO9xwkhw','','0CGoQFjAA',null,event)" class="l" href="http://www.miniclip.com/"><em>Games</em> at Miniclip.com - Play Free Online <em>Games</em></a></h3><div class="vspib" aria-label="Detalii rezultat" role="button" tabindex="0">

</div></div></div><!--n--></li><!--m--><li class="g"><div sig="fUe" bved="0CBsQkQo" pved="0CBoQkgowAQ" class="vsc"><h3 class="r"><a onmousedown="return rwt(this,'','','','2','AFQjCNGlNySkvcXMxEUmjCMOJRQPCdqBHQ','','0CHIQFjAB',null,event)" class="l" href="http://www.games.com/"><em>Games</em>.com: Play <em>Games</em> Online - Free <em>Games</em>, Download <em>Games</em> <b>...</b></a></h3><div class="vspib" aria-label="Detalii rezultat" role="button" tabindex="0"> 
```

在这种情况下，好的正则表达式是：

```
(<h3 class="r">)(.*?)(</h3><div) 
```

不难弄清楚。当`<h3 class="r">`出现在与我们的结果无关的另一个元素中时，就会出现问题。例如，如果您添加：

```
<h3 class="r">THIS IS JUST AN EXTRA THING</h3> 
```

在 HTML 文本的开头，上面的正则表达式不起作用。

新的正则表达式需要：

```
(class="vsc"><h3 class="r">)(.*?)(</h3><div) 
```

我知道这不是一件容易实现的事情，但我的想法是找到元素的相似之处（例如，在元素前后取 100 个字符，看看元素 1/元素 2 的相同点）。

希望有人可以指导我实现这一目标的最佳方法。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T21:51:47.907

如果我正确理解了这个问题，那么您需要的第一件事是返回一个正则表达式，该表达式最适合特定字符串，给定该字符串（和一些上下文）。似乎有一些选择，包括[Regulazy](http://osherove.com/blog/2006/7/9/introducing-regulazy-point-amp-click-regular-expressions.html)和[txt2re](http://txt2re.com/)。

您需要的下一件事情是遍历 DOM 的能力，因为您正在寻找父级（例如，在您的示例中给出了 2 个链接，您想要找到周围的 h3）。您可以尝试通过正则表达式执行此操作，但这会很困难，并且您可能无法正确处理所有边缘情况。有各种工具可用于修复不符合 XML 的 HTML 和遍历生成的 DOM，例如我前几天在 Java 中使用[NekoHTML](http://nekohtml.sourceforge.net/)进行此操作。

此时，您可以应用如下算法：

1.  找到两个给定节点之间的第一个公共父节点。
2.  从父级的文本内容构建正则表达式。
3.  将正则表达式应用于顶级 html 节点的内容。
4.  如果您获得超过 1 个匹配项（双 h3 案例），则缩小到父级的父级。
5.  冲洗并重复，从第 2 步开始，使用新的父母。

秘诀显然在于如何从字符串生成正则表达式，但听起来你可以依靠一些第三方工具来完成这部分。本质上，您正在做的是为正则表达式编译器创建一个字符串，因此，如果您需要从头开始实现这一点，一种方法可能是对字符串进行标记并构建一个[Abstract Syntax Tree](http://en.wikipedia.org/wiki/Abstract_syntax_tree)。然后，您可以[访问](http://en.wikipedia.org/wiki/Visitor_pattern)AST 节点以运行优化（例如查找可以用正则表达式 */+ 运算符替换的重复连续节点），然后在最后一次访问中生成正则表达式。

在更高的层次上，您可能想考虑正则表达式是否真的是您问题的正确答案。如果您只是想在 Google 上查找链接，给出几个示例，您可能只需遍历 DOM 以查找父节点，然后获取所有链接的子节点。

# pdf - 使用 Web 技术将多个 PDF 合并为单个多页文件

> ID：10826440
> 
> 赞同：2
> 
> 时间：2012-05-31T01:41:00.570
> 
> 标签：pdf, merge, pdf-generation, phantomjs

我有许多单页 PDF 文件需要合并成一个多页的文件（PDF 是从 HTML 页面生成的）。此外，它需要是一个跨操作系统、跨浏览器的解决方案，并且独立于服务器上使用的后端技术（必须在 Windows、Linux 和 OS X 上工作并易于安装）。我正在考虑将文件与 PDF.js （来自 Mozilla）合并，但从我读过的内容来看，它只会在 Firefox 和 Chrome 下呈现正确的 PDF（所以 IE 用户被排除在外，或者不？）。在浏览器/网络环境中执行此操作的任何其他选项？它将用于商业应用程序，因此如果它是某些第三方软件，我还需要适当的许可证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T19:40:25.080

你不能做这个客户端，除非你自己动手。目前没有任何东西可以处理这个客户端。

你最好的办法是尝试使用服务器端的东西，比如 Python + [PyPDF](http://pybrary.net/pyPdf/)，它是非常跨平台的。

# android - 在没有动画的情况下在android中开始一个新活动

> ID：10826441
> 
> 赞同：0
> 
> 时间：2012-05-31T01:41:14.530
> 
> 标签：android, android-listview, android-activity, android-ui

我想`Activity`在单击一个项目时开始一个新的`ListView`。这`Activity`将具有完全相同的设计 ( `ActionBar`+ `ListView`)，只是其中的所有样式和对象`ListView`都不同。

我认为最好的方法是将它们分成两个活动，但是在两个活动之间转换时，会显示一个动画，并且它使转换看起来像是滞后的。

**第一个问题**：有没有办法开始一个新`Activity`的只有 a`ListView`并让它替换我的当前`ListView`而不触及我的主窗口和状态栏？

**其次**：如果没有，那么是否可以删除两个活动之间的过渡动​​画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T01:57:58.453

在同一个活动中，您可以在 ListView 上再次调用 setAdapter 并给它一个新的适配器（然后可以有不同的数据/行布局等）。

# c# - 等待多个回调

> ID：10826442
> 
> 赞同：6
> 
> 时间：2012-05-31T01:41:20.287
> 
> 标签：c#, multithreading, windows-phone-7, asynchronous

我正在使用一个执行异步调用的库，当返回响应时，会使用结果调用回调方法。这是一个简单的模式，但我现在遇到了障碍。如何多次调用异步方法并等待（不阻塞）它们？当我从所有服务中获取数据时，我想调用我自己的回调方法，该方法将获取异步方法返回的两个（或更多）值。

这里要遵循的正确模式是什么？顺便说一句，我不能将库更改为使用 TPL 或其他东西……我必须忍受它。

```
public static void GetDataAsync(Action<int, int> callback)
{
    Service.Instance.GetData(r1 =>
    {
        Debug.Assert(r1.Success);
    });

    Service.Instance.GetData2(r2 =>
    {
        Debug.Assert(r2.Success);
    });

    // How do I call the action "callback" without blocking when the two methods have finished to execute?
    // callback(r1.Data, r2.Data);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T02:03:14.100

你想要的是类似[CountdownEvent](http://msdn.microsoft.com/en-us/library/system.threading.countdownevent%28VS.100%29.aspx)的东西。试试这个（假设你在 .NET 4.0 上）：

```
public static void GetDataAsync(Action<int, int> callback)
{
    // Two here because we are going to wait for 2 events- adjust accordingly
    var latch = new CountdownEvent(2);

    Object r1Data, r2Data;    

    Service.Instance.GetData(r1 =>
    {
        Debug.Assert(r1.Success);
        r1Data = r1.Data;
        latch.Signal();
    });

    Service.Instance.GetData2(r2 =>
    {
        Debug.Assert(r2.Success);
        r2Data = r2.Data;
        latch.Signal();
    });

    // How do I call the action "callback" without blocking when the two methods have finished to execute?
    // callback(r1.Data, r2.Data);

    ThreadPool.QueueUserWorkItem(() => {
        // This will execute on a threadpool thread, so the 
        // original caller is not blocked while the other async's run

        latch.Wait();
        callback(r1Data, r2Data);
        // Do whatever here- the async's have now completed.
    });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:18:53.440

您可以使用`Interlocked.Increment`您进行的每个异步调用。当一个完成时，调用`Interlocked.Decrement`并检查是否为零，如果为零，则调用您自己的回调。您需要将 r1 和 r2 存储在回调委托之外。

# linux - 不小心删除了mongodb文件

> ID：10826443
> 
> 赞同：1
> 
> 时间：2012-05-31T01:41:21.143
> 
> 标签：linux, mongodb, file-recovery

不小心我删除了数据 mongodb 的文件夹。我找到了一些检索 linux 系统文件的程序，但它们都需要文件的页眉、页脚和扩展名的说明。

例如，Foremost 和 Scalpel 提供了查找 jpg 文件的说明：

```
jpg     y       200000000       \xff\xd8\xff\xe0\x00\x10        \xff\xd9 
```

有谁知道我如何找到 mongodb 文件？(website_production.0 / website_production.1 / website_production.ns / mongodb.lock)

**操作系统是 Ubuntu 服务器 10.04**

对不起我的英语不好。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T14:26:51.307

如果您删除了 /data 目录并且没有可能的备份（通过 mongodump、mongoexport、副本集、辅助设备或文件系统映像），那么您基本上处于一个糟糕的位置，您将不得不从头开始在新数据库中创建数据。

要特别确认您的文件位置问题 - 它们都在数据目录中找到，如果您删除了该目录，它们就消失了，我怀疑最重要的是会恢复它们。使用其默认设置，最重要的是肯定不会恢复，因为它不知道文件结构 afaik。默认情况下，从 10gen .deb 包安装 ubuntu，数据目录位于 /var/lib/mongodb。我不熟悉手术刀。

对不起！

# joomla1.5 - Virtuemart 配置 - 外观问题

> ID：10826444
> 
> 赞同：0
> 
> 时间：2012-05-31T01:41:22.380
> 
> 标签：joomla1.5, virtuemart

我在 Joomla 1.5.25 之上运行 Virtuemart 1.1.9，当我尝试编辑我的 Virtuemart 配置时，页面显示如下图所示......当我在不同服务器上查看同一页面时，选项卡（全局,Security,Site 等）都在那里，还有保存/应用/取消按钮。

AHIA，拉里...

![在此处输入图像描述](../Images/85412946a08ed3deb1f75a8d12c6ac6d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T20:08:43.137

我很确定线索在于“当我在不同的服务器上查看同一页面时”。您在服务器上缺少一些样式表，并且可能缺少一些图像或文件夹。这些是它们所在的典型位置，因此请在正确显示它的服务器上进行比较。

```
yourroot\components\com_virtuemart\shop_image\ps_image\
yourroot\components\com_virtuemart\themes\default\ 
```

并且可能：

```
yourroot\images\M_images 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-07T17:45:17.407

您在服务器上缺少一些样式表（css 文件）和/或一些显示不正确格式的图像。为了确定哪些文件丢失：

1.  使用铬
2.  打开格式错误的页面
3.  按 F12 打开开发者工具
4.  单击 [网络] 选项卡
5.  按 F5 重新加载页面
6.  请参阅 Chrome 的开发人员工具填充为该页面调用的文件列表。在列表中，查找任何状态代码 404 或状态代码失败，这表明文件已被调用但未找到。
7.  从显示具有正确格式的相同页面的其他服务器获取丢失的文件 -> 将它们上传到相关服务器 -> 重新加载页面。
8.  喝一杯（酒

# c# - 当主窗体关闭时，是否可以让程序本身不关闭？

> ID：10826446
> 
> 赞同：2
> 
> 时间：2012-05-31T01:41:42.227
> 
> 标签：c#, forms

我知道在 VB.NET 中可以这样做，但我不知道如何在 C# 中这样做。在这里怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:46:26.213

您可以将（默认情况下）`Main`中的例程（程序的入口点）更改为使用而不是.`Program.cs`[`Application.Run()`](http://msdn.microsoft.com/en-us/library/ms157900.aspx)`Application.Run(Form)`

或者，您可以指定自己的`ApplicationContext`并覆盖[`OnMainFormClosed`](http://msdn.microsoft.com/en-us/library/system.windows.forms.applicationcontext.onmainformclosed.aspx)以提供与自动关闭不同的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T01:44:56.637

您可以隐藏表单并在系统托盘中放置一个图标。覆盖关闭事件并将其隐藏，然后在用户单击托盘图标时显示它。

有关关闭事件以及如何取消关闭的更多信息：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.form.closing.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.closing.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T01:46:07.697

开始一个新的做你建议的事情就足够了`Thread`，但我不确定这会满足你的目标。

编辑：

我建议的技术示例：

```
using System;
using System.Collections.Generic;
using System.Windows.Forms;
using System.Threading;

namespace HangApp
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
            Runner r = new Runner();
        }

        class Runner
        {
            internal Runner()
            {
                _start = DateTime.Now;
                Thread t = new Thread(ThreadStart);
                t.Start();
            }
            DateTime _start;
            void ThreadStart()
            {
                while (true)
                {
                    //  some stuff to do
                    if (ExitConditionMet())
                    {
                        break;
                    }
                }
            }

            bool ExitConditionMet()
            {
                //  will run the app for 5 seconds after main form was closed
                return (DateTime.Now - _start).TotalSeconds > 5;
            }
        }
    }
} 
```

顺便说一句，上面的代码只是一个演示，永远不应该：

*   做一个在紧密循环中什么都不做的线程
*   在类构造函数中启动线程

# ruby-on-rails - heroku rake 迁移问题

> ID：10826450
> 
> 赞同：1
> 
> 时间：2012-05-31T01:41:56.467
> 
> 标签：ruby-on-rails, heroku, migration

我部署到heroku：git push heroku master

然后我尝试： heroku run rake db:migrate 但它显示了这个问题：

```
error: src refspec logs does not match any.
error: failed to push some refs to 'git@heroku.com:appname.git' 
```

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T07:48:13.410

您可能只需要先提交：

```
git commit -m "something" 
```

假设您添加了暂存文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T03:07:45.823

这是个愚蠢的问题。我和你有同样的问题。我在 .bashrc 文件上添加别名。别名 heroku = 'git push heroku master'。这就是你运行 heroku 时总是显示这个问题的原因。删除此行。我相信它会解决你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-04T08:36:15.080

尝试部署`git push -f git@heroku.com:appname.git`

# c# - WCF 将数据插入 My SQL

> ID：10826451
> 
> 赞同：0
> 
> 时间：2012-05-31T01:42:32.740
> 
> 标签：c#, wcf, windows-phone-7

我正在尝试通过 WCF 将窗口电话中的数据插入到 sql server 中。我已经按照这个例子来编辑我的项目..[插入数据](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/e788c532-17e1-4255-b228-61bf261d5c4f) 但数据没有插入我的数据库。我的编码如下：

放在WindowPhone MainPage.xaml.cs 下。

```
private void button1_Click(object sender, RoutedEventArgs e)
        {
            //Insert textbox1.text into database
            string empId = textBox1.Text;
            Service1Client proxy = new Service1Client();
            proxy.AddEmployeeCompleted += new EventHandler<AddEmployeeCompletedEventArgs>(proxy_AddEmployeeCompleted);
            proxy.AddEmployeeAsync(empId);
            MessageBox.Show(textBox1.Text);
        }

private void proxy_AddEmployeeCompleted(object sender, AddEmployeeCompletedEventArgs e)
    {
        bool bb = Convert.ToBoolean(e.Result);
        MessageBox.Show(textBox1.Text);
        if (bb == true)
        {
            MessageBox.Show("Record Added Successfully !!");
        }
        else
        {
            MessageBox.Show("Unable to Insert record,Try Again !!");
        }
    } 
```

Service1.svc.cs 处的代码

```
namespace MyService
{

    public class Service1 : IService1
    {
        public bool AddEmployee(string empId)
        {
            try
            {
                DataClasses1DataContext cont = new DataClasses1DataContext();
                MyEmployee data = new MyEmployee();
                data.EmpId = empId;
                cont.MyEmployees.InsertOnSubmit(data);
                cont.SubmitChanges();
                return true;
            }
            catch
            {
                return false;
            }
        }

    }
} 
```

以及 IService1.cs 中的代码

```
namespace MyService
{

    [ServiceContract]

    public interface IService1
    {
        [OperationContract]

        bool AddEmployee(string empId);
    }
} 
```

我的编码有问题吗？

# python - 在 pdf 中嵌入文件和目录

> ID：10826453
> 
> 赞同：0
> 
> 时间：2012-05-31T01:42:57.150
> 
> 标签：python, perl, pdf, encode

是否有任何代码示例可以将包含文件和子目录的整个目录嵌入到 pdf 中？我知道如何将数据写入 pdf，以便我可以将 base 64 编码数据存储到 pdf 中的节点中。但是，我一直在寻找可以让我将数据作为文本实际写入文档可见方面的东西。我在想可能对目录和空目录进行比较，然后将此文本写入 pdf 的页面。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T04:47:15.950

我不确定我是否理解您的意图，但这是一种方法：

```
tree --charset ascii /home/pipitas > pipitas-tree.txt 
```

此命令创建一个 .txt 文件，其中包含我的主目录的 ASCII 艺术目录树（包含所有子目录和文件）。然后将其转换为 PDF 文件：

```
text2pdf -o pipitas-tree.pdf -w 842 -h 595 -m 24 pipitas-tree.txt 
```

`tree`在大多数操作系统平台上都可用。`text2pdf`是 PDFlib 的一部分，也可用于大多数操作系统；免费版本可在 www.pdflib.com 获得。

# asp.net - 数据库用途中的一些 dbo.aspnet_something

> ID：10826457
> 
> 赞同：0
> 
> 时间：2012-05-31T01:43:37.620
> 
> 标签：asp.net, c#-4.0, database-design

我看到一些社交网络，如网站应用程序数据库

dbo.aspnet_profile dbo.aspnet_roles 等。

文件夹。这是默认会员资格还是你们称之为什么？这是会员资格提供者吗？

在这里，我附上了图片以获取更多说明

![在此处输入图像描述](../Images/d62f23c7e8e4e0f35906bb1eb8406faf.png)

这个在 .NET Framework 4.0 中可用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:55:07.357

这称为 ASP.net 成员资格。

ASP.net Membership 是在 .net 2.0 中发布的，但仍然是最新的，可以与 .net 4.0 一起使用。

你可以很容易地安装它。[指示](http://weblogs.asp.net/sukumarraju/archive/2009/10/02/installing-asp-net-membership-services-database-in-sql-server-expreess.aspx)

您将需要了解数据库的设计方式。[关系图](http://leonardwoody.com/2010/06/02/asp-net-membership-entity-relatioship-diagram/)

最后这里有一个很好的指导[视频](http://www.youtube.com/watch?v=vxxFhGF-Z7E)。

# javascript - 访问页面时自动单击页面上的锚链接

> ID：10826458
> 
> 赞同：1
> 
> 时间：2012-05-31T01:43:57.077
> 
> 标签：javascript, jquery, html

我之前问过这个问题，但一些专家告诉我补充

```
<meta http-equiv="refresh" content="2;url=http://www.example.com/" /> 
```

这可以重新加载给定的链接，但我想知道如何在 id 的帮助下单击元素（锚点）。是否有任何代码在执行时会单击 id='dp99'，并且我希望在访问页面时执行此 javascript。这是HTML

```
<a id='d99' href='http://someline.com'>This is a link</a> 
```

如果有人可以帮助我，我将不胜感激！谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:46:24.800

使用 jQuery：

```
$(document).ready(function() { $('#dp99').click(); }); 
```

没有 jQuery：

```
document.addEventListener('DOMContentLoaded', function () {
  document.getElementById('dp99').click();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:07:05.597

如在[http://marcgrabanski.com/articles/simulating-mouse-click-events-in-javascript上所见](http://marcgrabanski.com/articles/simulating-mouse-click-events-in-javascript)

```
function mouseEvent(type, sx, sy, cx, cy) {

  var evt;

  var e = {

    bubbles: true, cancelable: (type != "mousemove"), view: window, detail: 0,

    screenX: sx, screenY: sy, clientX: cx, clientY: cy,

    ctrlKey: false, altKey: false, shiftKey: false, metaKey: false,

    button: 0, relatedTarget: undefined

  };

  if (typeof( document.createEvent ) == "function") {

    evt = document.createEvent("MouseEvents");

    evt.initMouseEvent(type, e.bubbles, e.cancelable, e.view, e.detail,

    e.screenX, e.screenY, e.clientX, e.clientY,

    e.ctrlKey, e.altKey, e.shiftKey, e.metaKey,

    e.button, document.body.parentNode);

  } else if (document.createEventObject) {

    evt = document.createEventObject();

    for (prop in e) {

      evt[prop] = e[prop];

    }

    evt.button = { 0:1, 1:4, 2:2 }[evt.button] || evt.button;

  }

  return evt;

}

function dispatchEvent (el, evt) {

  if (el.dispatchEvent) {

    el.dispatchEvent(evt);

  } else if (el.fireEvent) {

    el.fireEvent(‘on’ + type, evt);

  }

  return evt;

} 
```

# jquery - 如何调整此站点的高度？

> ID：10826460
> 
> 赞同：0
> 
> 时间：2012-05-31T01:44:15.920
> 
> 标签：jquery, resize, bxslider

我有一个基本上是 a`<ul>`和 5的站点，`<li>`我只是使用 jQuery bxSlider 使其左右滑动，但是由于其中一个中的内容`<li>`很长，因此该站点在任何其他元素上看起来都是这样，即使其中唯一的内容另一个`<li>`是图像。所以我想使用 jQuery 调整高度（强制它）并执行以下操作：

```
if($('#slider1:nth-child(0)').is(':visible'))
            alert("1"); 
        else if($('#slider1:nth-child(1)').is(':visible'))
            alert("2"); 
```

但是现在测试我总是得到第二个警报，即使我是最后一个孩子。知道我做错了什么或如何做到这一点吗？我的 HTML 很简单：

```
<ul id="slider1" style="border=100px;">
          <li>
            <div id="menu" class="nivoSlider">
                <img src="picsHOME/home0.jpg" alt="" />
                <img src="picsHOME/home1.jpg" alt="" />
                <img src="picsHOME/home2.jpg" alt="" />
                <img src="picsHOME/home4.jpg" alt="" />
                <img src="picsHOME/home5.jpg" alt="" />
                <img src="picsHOME/home6.jpg" alt="" />
                <img src="picsHOME/home7.jpg" alt="" />
                <img src="picsHOME/home8.jpg" alt="" />
            </div>
          </li>
          <li>
            <div id="nosotros">
                <img src="nosotros.jpg" alt="" /> <p>
                <img src="NOSOTROS-MISION.jpg" alt="" /><p>
                <img src="FOTOS-NOMBRES.jpg" alt=""  />

            </div>
          </li>
          <li>
            <div id="servicios">
                <img src="servicios.jpg" alt="" />
                <img src="SERVICIOStest.jpg" alt="" />
            </div>
          </li>
          <li>
          <img src="portafolio2.jpg" /><p>
          <a href="http://issuu.com/citro_ids/docs/citro_ids_portafolio_2012?mode=window&backgroundColor=%23222222" />
          <img src="port_link.png" /> <p></a>
          <img src="VERSION-DESCARGABLE2.jpg" />
          </li>
     </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:41:39.353

直接来自 jQuery 文档：

因为 jQuery 对 :nth-child(n) 的实现严格源自 CSS 规范，所以 n 的值是“1-indexed”，即从 1 开始计数。

[http://api.jquery.com/nth-child-selector/](http://api.jquery.com/nth-child-selector/)

你应该从`:nth-child(1)`

如果您想使用基于 0 的方法：

```
if($('#slider1 li:eq(0)').is(':visible'))
        alert("1"); 
    else if($('#slider1:eq(1)').is(':visible'))
        alert("2"); 
```

将`:eq`分别给你 1 和 2 里。

# javascript - 带有数组的 javascript 类是静态的

> ID：10826464
> 
> 赞同：0
> 
> 时间：2012-05-31T01:45:02.453
> 
> 标签：javascript, coffeescript

我正在使用咖啡脚本创建以下类：

```
class User
  userId: 0
  rooms: new Array() 
```

当我创建该类的新实例并向数组添加一些内容时，任何新实例也包含相同的数组。生成的javascript是：

```
 var User;

  User = (function() {

    User.name = 'User';

    function User() {}

    User.prototype.userId = 0;

    User.prototype.rooms = new Array();

    return User;

  })(); 
```

每次实例化类时，如何设计具有新空数组的类？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:48:54.030

您希望`userId`并且在原型`rooms`上`this`，而不是在原型上，否则所有实例都将共享它们。

```
class User
  constructor: (@userId = 0, @rooms = []) ->

u = new User 1, [1,2]
u2 = new User 2, [3,4]

alert "#{ u.userId } #{ u.rooms } #{u2.userId} #{u2.rooms}" 
```

[在这里试试](http://coffeescript.org/#try%3aclass%20User%0A%20%20constructor%3a%20%28@userId%20=%200,%20@rooms%20=%20%5B%5D%29%20-%3E%0A%0Au%20=%20new%20User%201,%20%5B1,2%5D%0Au2%20=%20new%20User%202,%20%5B3,4%5D%0A%0Aalert%20%22#%7B%20u.userId%20%7D%20#%7B%20u.rooms%20%7D%20#%7Bu2.userId%7D%20#%7Bu2.rooms%7D%22)。

简单的`@`意思`this.`。

构造函数行做了很多。它定义了一个构造函数

1) 将传递的值设置为`userId`对象`rooms`（不是原型）
2) 如果未提供每个属性，则为每个属性提供默认值。

请注意，我什至不必在构造函数中做任何其他事情。一定要点击链接，这样你就可以看到这个例子创建的 javascript。

# extjs - 仅当浏览器低于 1024x768 时使用 extjs 4 布局区域滚动

> ID：10826465
> 
> 赞同：0
> 
> 时间：2012-05-31T01:45:21.300
> 
> 标签：extjs, extjs4

我的 Viewport.js 由四个堆叠的垂直带组成，它们的最小宽度为 1024，组合的最小高度为 768（希望它适合 iPad 而无需滚动）

```
me.items = [{
    xtype: 'pageHeader',
    region: 'north'
},{
    xtype: 'pageBreadcrumb',
    region: 'north'
},{
    xtype: 'pageMain',
    region: 'center',
    cls: 'oc-view-center'
},{
    xtype: 'pageFooter',
    region: 'south',
    layout: 'border'
}]; 
```

当我调整桌面浏览器的大小时，我遇到了滚动条的问题，有时会出现没有滚动拇指（我可以忍受），但 pageFooter 也会浮动在我需要修复的“中心”面板的顶部。

给定下面屏幕截图中的布局，如何让滚动正常工作？

![在此处输入图像描述](../Images/da6b9fa8300f914ddf6538af3f988a59.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T20:49:38.040

您不能在每个边界区域中指定多个容器。您可能想考虑将其中一个容器嵌套在“北”区域的容器中。此外，请确保您已在视口配置中将 autoScroll 设置为 true。

# c - 如何使用纯C读取excel文件？

> ID：10826472
> 
> 赞同：5
> 
> 时间：2012-05-31T01:46:14.123
> 
> 标签：c, windows, linux, excel

正如标题所说，我有一个任务，我需要从 excel 文件中读取数据。我想知道如何在纯 C 中实现它，而不是 C++ 或 C#。顺便说一句，我需要在 Linux 中编写和测试程序，但其他人可能会使用 Windows 中的代码，这意味着我的代码必须独立于操作系统。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T11:00:08.143

查看[http://xlslib.sourceforge.net/](http://xlslib.sourceforge.net/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T11:03:49.530

C 中的手工编码 excel 支持很复杂。您必须依赖第三个库。但是如果你只是想遵循 CSV 格式，你可以编写自己的 CSV 解析器。

# ruby-on-rails - 模型关联错误 Rails Admin

> ID：10826473
> 
> 赞同：0
> 
> 时间：2012-05-31T01:46:15.980
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, rails-admin

尝试安装 rails admin 时出现以下错误...假设它是模型关联错误，但我无法弄清楚..

```
 /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activerecord-3.2.3/lib/active_record/inheritance.rb:119:in `compute_type': uninitialized constant Interest::Person (NameError)
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activerecord-3.2.3/lib/active_record/reflection.rb:172:in `klass'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/adapters/active_record.rb:218:in `association_model_lookup'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/adapters/active_record.rb:63:in `block (2 levels) in associations'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/config/fields/association.rb:59:in `call'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/config/fields/association.rb:59:in `associated_model_config'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/config/fields/association.rb:34:in `block in <class:Association>'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/config/configurable.rb:68:in `instance_eval'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/config/configurable.rb:68:in `block in register_instance_option'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/rails_admin/config/configurable.rb:42:in `block in register_instance_option'
    from (erb):86:in `block (2 levels) in template'
    from (erb):85:in `map'
    from (erb):85:in `block in template'
    from (erb):82:in `map'
    from (erb):82:in `template'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/erb.rb:753:in `eval'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/erb.rb:753:in `result'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/file_manipulation.rb:111:in `block in template'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/create_file.rb:54:in `call'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/create_file.rb:54:in `render'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/create_file.rb:47:in `identical?'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/create_file.rb:73:in `on_conflict_behavior'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/empty_directory.rb:111:in `invoke_with_conflict_check'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/create_file.rb:61:in `invoke!'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions.rb:95:in `action'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/create_file.rb:26:in `create_file'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/actions/file_manipulation.rb:110:in `template'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/rails_admin-0.0.3/lib/generators/rails_admin/install_generator.rb:62:in `install'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/task.rb:22:in `run'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:118:in `invoke_task'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `block in invoke_all'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `each'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `map'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/invocation.rb:124:in `invoke_all'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/group.rb:226:in `dispatch'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/thor-0.14.6/lib/thor/base.rb:389:in `start'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/generators.rb:170:in `invoke'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/commands/generate.rb:12:in `<top (required)>'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `block in require'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
    from /Users/nelsonkeating/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/gems/1.9.1/gems/railties-3.2.3/lib/rails/commands.rb:29:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

楷模

```
class User < ActiveRecord::Base
  has_many :friends
  has_many :person_interests, :as => :person
  has_many :interests, :through => :person_interests
  has_many :user_holidays
  has_many :holidays, :through => :user_holidays
  has_many :anniversaries
end

class PersonInterest < ActiveRecord::Base
  attr_accessible :person_id, :person_type, :interest_ids
  belongs_to :interest
  belongs_to :person, :polymorphic => true

end

class Interest < ActiveRecord::Base
  attr_accessible :name
  has_many :person_interests
  has_many :people, :through => :person_interests

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T04:31:28.717

问题是因为您的关联在您的模型`has_many :people`中是这样的：`Interest`

```
has_many :people, :through => :people_interest 
```

模型内部的`person`关联`PersonInterest`肯定足够了`polymorphic`，但`has_many :through`不尊重这一点。

因此，我建议尝试找到另一种方法来吸引所有人。你可以这样做：

```
def people
  person_interests.includes(:person).map(&:people).flatten.uniq
end 
```

# java - 如何在 res/layout 文件夹下的 .xml 文件中使用伪代码？安卓

> ID：10826479
> 
> 赞同：0
> 
> 时间：2012-05-31T01:47:18.947
> 
> 标签：java, android, xml, pseudocode, sgml

所以我想用伪代码告诉自己一些关于 .xml 文件的事情，但是当我执行 // 时，它会像代码一样输入它，所以我不能在那里真正使用它。我可以做些什么来使代码像伪代码一样不可读？我在一个android应用程序中这样做。在 res/layout/(.xml 文件) 文件夹下。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T01:51:05.307

XML中的注释是这样的

```
<!-- this is a comment --> 
```

请注意，它们可以跨越多行

```
<!--
    This is a comment
    on multiple lines
--> 
```

但它们不能嵌套

```
<!-- This <!-- is a comment --> This is not --> 
```

你也不能在标签内使用它们

```
<EditText <!--This is not valid--> android:layout_width="fill_parent" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T01:48:15.750

HTML & XML 中的注释是这样的：

```
<!-- this is a comment --> 
```

有关更多详细信息，请参阅[关于 SGML 和 HTML：注释](http://www.w3.org/TR/html4/intro/sgmltut.html#h-3.2.4)。

* * *

建议：

```
<!-- textSize: For the 'hearing impaired'. --> 
<TextView 
    android:text="invalid" 
    android:textSize="25dp" 
    android:id="@+id/tvResults" 
    android:gravity="center" 
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" /> 
```

# django - 如果有人在管理页面中更改了数据，如何更新数据库表中的相关数据

> ID：10826480
> 
> 赞同：0
> 
> 时间：2012-05-31T01:47:25.640
> 
> 标签：django

我有一个名为 project 的表，该表有以下列：“id,name,prodid,unitid,starttime,endtime”，“name”的值结合了“prodid”和“unitid”的名称，prodid 和unitid 是这里的外键。

如果有人在管理页面中更改了 projid 和 unitid 的名称，如何更新此表中相关行的“名称”列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T04:06:51.533

我认为你可以使用 django[信号](https://docs.djangoproject.com/en/dev/topics/signals/)

# javascript - 获取动态插入的 HTML 以使用 knockoutjs

> ID：10826482
> 
> 赞同：43
> 
> 时间：2012-05-31T01:47:53.817
> 
> 标签：javascript, jquery, html, knockout.js, knockout-2.0

由于所有不错的内置功能，我对所有表都使用 JQuery DataTables，但似乎自定义表布局的唯一方法是为 DataTable 设置“sDom”选项属性并使用类似`$("div.SOMECLASS").html(HTML_HERE)`插入自定义的 html 到表格中。（仅供参考，我只是想自定义标题）。

问题是我希望插入的 html 使用 knockoutjs 绑定。Knockout 似乎没有以这种方式初始化绑定。

有没有办法解决这个问题？

这是我要插入的 html 的一部分。它几乎是表格的一些自定义过滤器功能的下拉列表。

```
'<li><a data-bind="click: Filter(\'Severity 1\', 2)">Severity 1</a></li>' 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-05-31T01:54:12.310

您必须在插入动态 HTML 元素后调用此函数

`ko.applyBindings(viewModel, elementContainingDynamicContent)`

这里的例子[http://jsfiddle.net/rniemeyer/FCN5p/](http://jsfiddle.net/rniemeyer/FCN5p/)

# c# - Simple-ITK C# 安装教程

> ID：10826487
> 
> 赞同：2
> 
> 时间：2012-05-31T01:48:27.433
> 
> 标签：c#, itk

前段时间我在 C++ 中使用过 ITK，现在我正在尝试在 C# 中使用简单的 itk。我查看了 MICCAI 2011 教程，我正在尝试开始。我使用的是 Windows 7 64 位机器和 Visual Studio Ultimate 2010。根据[这个 wiki](http://www.itk.org/Wiki/ITK_Release_4/SimpleITK/GettingStarted#C.23_binary_files)，我应该能够解压缩并将 .dll 引用到我的项目中，它应该可以工作。我可以将 SimpleITKCSharpManaged.dll 添加到我的参考资料中。但是我无法将 SimpleITKCSharpNative.dll 添加到我的引用中。它给了我错误：请确保文件是可访问的，并且它是有效的程序集或 COM 组件。

然后我尝试运行一个简单的控制台应用程序

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using itk.simple;

namespace TestSimpleItk
{
    class Program
    {
        static void Main(string[] args)
        {
            string inputFilename = "001.png";
            if (File.Exists(inputFilename))
            {
                try
                {
                    var input = SimpleITK.ReadImage(inputFilename);
                    var binary = SimpleITK.BinaryThreshold(input, 100, 255, 255, 0);
                    SimpleITK.WriteImage(binary, "cthead1-binary.png");
                }
                catch (Exception ex)
                { 
                    Console.WriteLine("{0}", ex);
                }

            }
            else
            {
                Console.WriteLine("File '{0}' does not exist", inputFilename);
            }
        }
    }
} 
```

抛出的异常是：{“'itk.simple.SimpleITKPINVOKE' 的类型初始化程序抛出异常。”} 内部异常是：{“尝试加载格式不正确的程序。（来自 HRESULT 的异常： 0x8007000B)"}

我尝试将 SimpleITKCSharpNative.dll 复制到我的 bin/debug 目录中，但仍然遇到相同的错误。

关于如何解决这个问题，或者如何在不使用 CMAKE 从源代码本地构建它的情况下启动并运行 SimpleItk 的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T00:48:27.753

ITK 的 Dan Mueller 回答了我的问题。这是他不得不说的：

嗨，费德里科，

您收到的错误提示：“尝试加载格式不正确的程序。”

当 .NET 程序尝试访问使用不同架构构建的 dll 中的函数时，会发生此错误；例如，请参见此处：http: [//blogs.msdn.com/b/arvindsh/archive/2009/06/21/tip-of-the-day-an-attempt-was-made-to-load-a-program -with-an-incorrect-format-net-p-invoke-issue.aspx](http://blogs.msdn.com/b/arvindsh/archive/2009/06/21/tip-of-the-day-an-attempt-was-made-to-load-a-program-with-an-incorrect-format-net-p-invoke-issue.aspx)

解决此问题的最简单方法是使用与 SimpleITK 相同的构建设置。例如，如果您下载了“SimpleITK-0.4.0-CSharp-Win64-anycpu.zip”，那么您的调用程序应该使用 x64 AnyCPU 设置构建。如果您下载了“SimpleITK-0.4.0-CSharp-Win32-x86.zip”，您应该使用 x86 Win32 设置。

要回答您的其他问题：您只需将“SimpleITKCSharpManaged.dll”添加到您的程序引用中，但“SimpleITKCSharpNative.dll”必须在探测路径中（实现此目的的最简单方法是将其放在您的二进制目录中您的程序可执行文件和托管 dll）。以下页面对此进行了解释（此页面适用于 Linux，但 Windows 也需要相同的方法）： [http ://www.itk.org/Wiki/ITK/Release_4/SimpleITK/GettingStarted/Visual_guide_to_building_on_Linux#A_simple_C.23_program](http://www.itk.org/Wiki/ITK/Release_4/SimpleITK/GettingStarted/Visual_guide_to_building_on_Linux#A_simple_C.23_program)

请让我们知道您的进展情况。

高温高压

干杯，丹

# python - 是否有与 __import__ 等效的 __reload__ 函数？

> ID：10826489
> 
> 赞同：3
> 
> 时间：2012-05-31T01:48:55.360
> 
> 标签：python, import, reload

我只知道运行时的模块名称，因此它是这样的：-

```
a = 'mymodule'
__import__(a) 
```

但在此过程中，当 mymodule.py 更改时，我想再次重新加载它。有没有类似的命令

```
__reload__(a) 
```

?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T01:51:42.753

是的。是`reload(module)`。请参阅[python 模块文档](http://docs.python.org/tutorial/modules.html)（第 6.1 节）和[库内置函数参考](http://docs.python.org/library/functions.html)。

参数是模块对象，而不是字符串，因此您必须先导入它。

```
mymodule = __import__('mymodule')
reload(mymodule) 
```

# asp.net - 在 SQLDataSource 中使用字段名称作为选择参数

> ID：10826493
> 
> 赞同：2
> 
> 时间：2012-05-31T01:49:37.527
> 
> 标签：asp.net, .net, sqldatasource

是否可以将字段名称用作 SQLDataSource 中的选择参数？

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:DbConnection %>" 
    ProviderName="<%$ ConnectionStrings:DbConnection.ProviderName %>"      
SelectCommand="select * from sometable where @FieldKey = @FieldValue">
<SelectParameters>
    <asp:Parameter Name="FieldKey" Type="String" />
    <asp:Parameter Name="FieldValue" Type="String" />
</SelectParameters>
</asp:SqlDataSource> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T03:07:29.403

这是我大部分时间的hack（解决方法）

```
protected void page_load(...)
{
   SqlDataSource1.SelectParameters["FieldKey"] = field;
   SqlDataSource1.SelectParameters["FieldName"] = name;
} 
```

或创建两个隐藏字段，将值分配给这些字段，然后使用

```
<asp:ControlParameter /> 
```

这是另一个黑客

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T06:38:10.480

## 选项1

如果`FieldKey`并且`FieldName`正在从后面的代码中获取，我认为您可以轻松地设置如下命令。

```
SqlDataSource1.SelectCommand = string.Format("select * from sometable where {0} = {1}",fieldKey ,fieldValue) 
```

请验证 SQL 注入攻击的输入字段。

## 选项 2

创建存储过程以接受两个参数 key 和 value，您需要**从这些参数构建 SQL 查询并在存储过程中执行**。

然后你可以从数据源调用它。

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="<%$ ConnectionStrings:DbConnection %>" 
    ProviderName="<%$ ConnectionStrings:DbConnection.ProviderName %>"      
    SelectCommand="StoredProcedureName"
    SelectCommandType="StoredProcedure">
<SelectParameters>
    <asp:Parameter Name="FieldKey" Type="String" />
    <asp:Parameter Name="FieldValue" Type="String" />
</SelectParameters>
</asp:SqlDataSource> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T02:41:18.980

如果您的意思是使用来自控件的值 [如文本框、下拉菜单]，那么这里有一些东西

```
<SelectParameters>
    <asp:ControlParameter ControlID="FieldKey" PropertyName="Text"
         Type="String" />
    <asp:ControlParameter ControlID="FieldName" PropertyName="Text"
         Type="String" />
</SelectParameters> 
```

假设值存储在文本框中

# ajax - 部分视图未显示

> ID：10826498
> 
> 赞同：2
> 
> 时间：2012-05-31T01:50:02.207
> 
> 标签：ajax, asp.net-mvc-3, partial-page-refresh

我在“X”控制器下有一个名为“_PartialPage1”的局部视图。这是我的部分观点的内容：

```
<div>Hello</div> 
```

我的 X 控制器包含以下内容：

```
 public ActionResult _PartialPage1()
    {
        return View();
    } 
```

在我的家庭索引中，我有这个：

```
 <div style="float:left"> @Ajax.ActionLink("Call X", "_PartialPage1", "X", new AjaxOptions() { UpdateTargetId = "divToUpdate" }) </div>
 <div style="float:left"> @Ajax.ActionLink("Call Y", "_PartialPage2", "Y",new  AjaxOptions(){ UpdateTargetId = "divToUpdate" }) </div>
 <div style="float:left"> @Ajax.ActionLink("Call Z", "_PartialPage3", "Z",new  AjaxOptions(){ UpdateTargetId = "divToUpdate" }) </div>

 <div id="divToUpdate"></div> 
```

当我单击 Call X 时，没有显示任何内容..我正在尝试学习 ajax 部分页面更新....希望您能帮助我...谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:01:00.877

如果你想渲染一个局部视图，你应该使用：

```
@Html.Partial("PartialViewName"); 
```

你有一个名为“PartialViewName”的局部视图，带有 div 标签 hello

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:03:26.550

如果你有

*   一个名为 XController 的控制器，其中包含一个名为 _PartialPage1 的操作
*   对您正在使用的页面上的 jquery 和 jquery.unobtrusive-ajax javascript 库的引用
*   名为“_PartialPage1”的正确文件夹中的视图
*   id 为 divToUpdate 的 div

那么您提供的代码应该可以工作。我会检查是否满足所有这些条件。我建议使用 firebug 来验证您的 ajax 调用是否有效。返回 PartialView 而不是 View 更合适，但无论哪种方式，您都应该在 div 中看到结果。

# 3d - CALayer 旋转的投影

> ID：10826499
> 
> 赞同：0
> 
> 时间：2012-05-31T01:50:07.497
> 
> 标签：3d, rotation, calayer, perspective

一个图层，用`frame {0,0,w,h}`, `backgroundColor red`, `anchorPoint at {0,0.5}`,`transform.m34 = -1.0/1800,` 设置`position at {0,0}`, 然后*沿 y* ,旋转一个角度`CATransform3DRotate(layer.transform , 0.25 * M_PI, 0, 1, 0)`, 现在我想算出红色区域的宽度。

一开始我以为应该是`cos(0.25 * M_PI) *w`，后来我用代码测试了一下，红色区域变短了`cos(0.25 * M_PI) *w`，应该是透视的原因（物体越近显得越大），但不知道怎么算出红色区域宽度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:07:39.307

如果我对您的理解正确，那么您要做的是在一系列变换后确定两个不同点的相对位置。计算出这样做的方程式可能会很棘手，我发现先根据矩阵写出所有内容然后通过自己乘以矩阵来得到方程式很有帮助。

假设您的锚点位于原点，使用列主矩阵（如 open GL 和 CA 层）。Position1 将表示矩形的左边缘，Position2 表示右边缘。

```
Position1 = {1,0,0,0,
            0,1,0,0,
            0,0,1,0,
            0,0,0,1};

Position2 ={1,0,0,w,  
            0,1,0,0,  
            0,0,1,0,  
            0,0,0,1}; 
```

位置 2 现在需要围绕 y 轴旋转您的角度，所以我们声明

```
Rotation = {cos,0,sin,0,
              0,1,  0,0,
           -sin,0,cos,0,
              0,0,  0,1}; 
```

旋转需要应用于 Position2 并且它们都需要乘以投影矩阵。Position1 不需要旋转，因为它位于旋转轴上。重要的是要意识到仅仅将 m34 设置为一个小的负数并没有做任何神奇的事情，你真正做的是乘以投影矩阵

```
YourProjection = {1,0,0        ,0,
                  0,1,0        ,0,
                  0,0,1        ,0,
                  0,0,-1.0/1800,1}; 
```

乘以不同格式的投影矩阵也可以，使用您最熟悉的任何格式。您可以使用[Open GL](http://www.songho.ca/opengl/gl_projectionmatrix.html)之类的矩阵或[您正在使用](http://web.iitd.ac.in/~hegde/cad/lecture/L9_persproj.pdf)的矩阵，因为它们确实是[等价](http://milen.me/technical/core-animation-3d-model/)的。

```
Position2 = MultiplyMatrices(Rotation,Position2);
Position2 = MultiplyMatrices(YourProjection,Position2);
Position1 = MultiplyMatrices(YourProjection,Position1); 
```

Position1 和 Position2 现在保持在 CALayer 对其执行变换时将给出的确切位置。由于这些是齐次坐标，您必须确保将 x、y、z 分量 (m41,42,43) 除以 w (m44) 以转换回笛卡尔坐标。那么你需要做的就是得到宽度

```
float width = Position1.m41-Position2.m41; 
```

如果你还没有，你可能应该让自己做矩阵乘法的函数，这样你就可以快速轻松地进行这样的计算。你也不会因为这种方式代数错误而感到困惑:)。如果您真的想以代数方式进行操作，只需将其相乘，它就会为您提供所需的内容。此外，如果我的矩阵表示法令人困惑，这里是从列主要到 CALayer 变量的转换。

```
{m11,m12,m13,m14,
 m21,m22,m23,m24,
 m31,m32,m33,m34,
 m41,m42,m43,m44}; 
```

一个简单的平移矩阵在哪里

```
{1,0,0,0,
 0,1,0,0,
 0,0,1,0,
 x,y,z,1}; 
```

# c++ - C++ 对自定义映射迭代器函数的未定义引用

> ID：10826507
> 
> 赞同：0
> 
> 时间：2012-05-31T01:51:57.037
> 
> 标签：c++, templates, reference, iterator, undefined

我已经为分配创建了一个自定义映射（它是一个通用的模板化映射，它有自己的自定义迭代器和部分专业化），但是当应用程序尝试在它的代码中使用它时，我得到了对它所有函数的未定义引用。

我已经在类似的情况下查看了这里的其他问题，我猜我的命名空间或迭代器的位置有错误，或者导致应用程序找不到它的东西？

以下是相关代码：

```
 #ifndef MAP_H
#define MAP_H

#define SIZE 101

#include <string>

using std::string;

namespace myMap{

    ////////////////////START TEMPLATE//////////////////////

    template<class K, class V>
    class map
    {
        private:
            typedef struct SNode{
                K first;
                V second;
                SNode* next;
            } Node;

            Node** hashArray;
            Node* head;
            Node* tail;
            Node* lastEntry;

        public:
            map();
            ~map();

            V generateHash(K first);
            void addPair(K first, V second);
            void checkHeadTail();
            int count(K key);

            V& operator[](K first);

            class iterator
            {
                private:
                    Node* currentNode;
                    K first;
                    V second;
                public:
                    iterator();
                    iterator(Node* pos);
                    ~iterator();

                    void operator++(int);
                    Node* operator->();
                    bool operator!=(iterator other);
            };

            iterator begin(){iterator iter(head); return iter;}
            iterator end(){iterator iter(NULL); return iter;}
    };

    template<class K, class V>
    map<K, V>::map()
    {
        hashArray = new Node*[SIZE];
        for(unsigned int i = 0; i < SIZE; i++){
            hashArray[i] = NULL;
        }

        head = NULL;
        tail = NULL;
        lastEntry = NULL;
    }

    template<class K, class V>
    map<K, V>::~map()
    {
        for(unsigned int i = 0; i < SIZE; i++){
            if(hashArray[i] != NULL){
                Node* tmpNode = hashArray[i];
                Node* currentNode = hashArray[i];
                while(currentNode){
                    currentNode = currentNode->next;
                    delete tmpNode;
                    tmpNode = currentNode;
                }
            }
        }

        delete [] hashArray;
    }

    template<class K, class V>
    V map<K, V>::generateHash(K first)
    {
        V hash = 0;
        for(unsigned int j = 0; j < first.length(); j++){
            hash += first[j];
        }
        return hash % SIZE;
    }

    template<class K, class V>
    void map<K, V>::checkHeadTail()
    {
        if(hashArray[0] != NULL){
            head = hashArray[0];
            tail = hashArray[0];
        }

        Node* currentNode = *hashArray;
        while(currentNode->next){
            currentNode = currentNode->next;
        }
        tail = currentNode;
    }

    template<class K, class V>
    void map<K, V>::addPair(K first, V second)
    {
        Node* newEntry = new Node;
        newEntry->first = first;
        newEntry->second = second;
        newEntry->next = NULL;

        V hash = generateHash(first);

        if(hashArray[hash] == NULL){
            hashArray[hash] = newEntry;
            lastEntry = newEntry;
        } else {
            Node* currentNode = hashArray[hash];
            while(currentNode->next){
                if(currentNode->first == first){
                    currentNode->second += second;
                    lastEntry = currentNode;
                    return;
                }
                currentNode = currentNode->next;
            }
            if(currentNode->first == first){
                currentNode->second += second;
                lastEntry = currentNode;
                return;
            } else {
                currentNode->next = newEntry;
                lastEntry = newEntry;
                return;
            }
        }
        checkHeadTail();
    }

    template<class K, class V>
    V& map<K, V>::operator[](K first)
    {
        V second = 0;
        addPair(first, second);

        return lastEntry->second;
        checkHeadTail();
    }

    template<class K, class V>
    int map<K, V>::count(K key)
    {
        V hash = generateHash(key);
        if(hashArray[hash] != NULL){
            return true;
        }
        return false;
    }

    template<class K, class V>
    void map<K, V>::iterator::operator++(int)
    {
        currentNode = currentNode->next;
    }

    template<class K, class V>
    bool map<K, V>::iterator::operator!=(map::iterator other)
    {
        if(first == other->first) return false; return true;
    }

    template<class K, class V>
    typename map<K, V>::Node* map<K, V>::iterator::operator->()
    {
        return currentNode;
    }

    template<class K, class V>
    map<K, V>::iterator::iterator()
    {
        currentNode = NULL;
    }

    template<class K, class V>
    map<K, V>::iterator::iterator(Node* pos)
    {
        currentNode = pos;
    }

    ////////////////////SPECIALISATION///////////////////////////////

    template<class V>
    class map<string, V>
    {
        private:
            typedef struct SNode{
                string first;
                V second;
                SNode* next;
            } Node;

            Node** hashArray;
            Node* head;
            Node* tail;
            Node* lastEntry;

        public:
            map();
            ~map();

            V generateHash(string first);
            void addPair(string first, V second);
            void checkHeadTail();
            V count(string key);

            V& operator[](string first);

            class iterator
            {
                private:
                    Node* currentNode;
                    string first;
                    V second;
                public:
                    iterator();
                    iterator(Node* pos);
                    ~iterator();

                    void operator++(V);
                    Node* operator->();
                    bool operator!=(iterator other);
            };

            iterator begin();
            iterator end();
    };

    template<class V>
    map<string, V>::map()
    {
        hashArray = new Node*[SIZE];
        for(unsigned int i = 0; i < SIZE; i++){
            hashArray[i] = NULL;
        }

        head = NULL;
        tail = NULL;
        lastEntry = NULL;
    }

    template<class V>
    map<string, V>::~map()
    {
        for(unsigned int i = 0; i < SIZE; i++){
            if(hashArray[i] != NULL){
                Node* tmpNode = hashArray[i];
                Node* currentNode = hashArray[i];
                while(currentNode){
                    currentNode = currentNode->next;
                    delete tmpNode;
                    tmpNode = currentNode;
                }
            }
        }

        delete [] hashArray;
    }

    template<class V>
    V map<string, V>::generateHash(string first)
    {
        unsigned long hash = 0;
        for(unsigned int j = 0; j < first.length(); j++){
            hash += first[j];
        }
        return (V) hash % SIZE;
    }

    template<class V>
    void map<string, V>::checkHeadTail()
    {
        if(hashArray[0] != NULL){
            head = hashArray[0];
            tail = hashArray[0];
        }

        Node* currentNode = *hashArray;
        while(currentNode->next){
            currentNode = currentNode->next;
        }
        tail = currentNode;
    }

    template<class V>
    void map<string, V>::addPair(string first, V second)
    {
        Node* newEntry = new Node;
        newEntry->first = first;
        newEntry->second = second;
        newEntry->next = NULL;

        V hash = generateHash(first);

        if(hashArray[hash] == NULL){
            hashArray[hash] = newEntry;
            lastEntry = newEntry;
        } else {
            Node* currentNode = hashArray[hash];
            while(currentNode->next){
                if(currentNode->first == first){
                    currentNode->second += second;
                    lastEntry = currentNode;
                    return;
                }
                currentNode = currentNode->next;
            }
            if(currentNode->first == first){
                currentNode->second += second;
                lastEntry = currentNode;
                return;
            } else {
                currentNode->next = newEntry;
                lastEntry = newEntry;
                return;
            }
        }
        checkHeadTail();
    }

    template<class V>
    V& map<string, V>::operator[](string first)
    {
        V second = 0;
        addPair(first, second);

        return lastEntry->second;
        checkHeadTail();
    }

    template<class V>
    V map<string, V>::count(string key)
    {
        V hash = generateHash(key);
        if(hashArray[hash] != NULL){
            return true;
        }
        return false;
    }

    template<class V>
    map<string, V>::iterator::iterator()
    {
        currentNode = NULL;
    }

    template<class V>
    map<string, V>::iterator::iterator(Node* pos)
    {
        currentNode = pos;
    }

    template<class V>
    void map<string,V>::iterator::operator++(V)
    {
        currentNode = currentNode->next;
    }

    template<class V>
    typename map<string, V>::Node* map<string, V>::iterator::operator->()
    {
        return currentNode;
    }

    template<class V>
    bool map<string, V>::iterator::operator!=(map::iterator other)
    {
        if(first == other->first) return false; return true;
    }

} // END NAMESPACE

#endif // MAP_H 
```

错误：

```
undefined reference to `myMap::map<std::string, int>::begin()'
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::end()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::begin()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::end()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'|
undefined reference to `myMap::map<std::string, int>::iterator::~iterator()'| 
```

当应用程序尝试使用迭代器时会发生错误：

```
map<string, int>::iterator iter;
for(iter = wordsCount.begin(); iter != wordsCount.end(); iter++){
    orderedList.addWord(iter->first, iter->second);
} 
```

作为任务的一部分，我不能只更改上面的迭代器的使用，我必须自己创建它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:10:21.763

导致错误消息的成员函数的实现不在`map<string, V>`. 我没有看到`map::begin()`,`map::end()`和`map::iterator::~iterator()`任何地方的实现。大多数其他功能似乎都已实现（没有检查所有功能），但缺少这三个功能。`map<K, V>`在类内部实现`begin()`和`end()`，但`iterator::~iterator()`那里也缺少实现。

# c++ - Ubuntu 12.04 上的 C++ Eclipse 升级后无法解决

> ID：10826509
> 
> 赞同：0
> 
> 时间：2012-05-31T01:52:13.707
> 
> 标签：c++, eclipse, ubuntu, eclipse-cdt

升级到 12.04 后，我从 11.10 开始使用的 Eclipse 在启动时充满了错误。现在，它无法解析 fprintf、时钟和时间等标准内容，即使在 11.10 上编译的完全相同的项目并且我三重检查了包含...。我已经在调试和发布中清除了 C、C++ 的发现选项......仍然相同。（虽然在第一次清除之后，事情变得更好了，因为之前的问题更糟，甚至不知道包含）

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T11:33:00.500

右键单击您的项目并选择 Index -> Update with Modified Files

# php - 用 if 语句解释 PHP 中的布尔值

> ID：10826511
> 
> 赞同：0
> 
> 时间：2012-05-31T01:52:43.013
> 
> 标签：php, boolean

以下表单始终返回 true，即使域可用。谁能让我知道我做错了什么？谢谢。

```
<?php
function domainAvailable($domain){
$results = @dns_get_record($domain, DNS_ANY);
return empty($results);
}
if (isset($_REQUEST['domain']))  // check to see if form has been submitted
{
$domain = htmlspecialchars($_REQUEST['domain'], ENT_QUOTES, 'UTF-8');

$httpdomain = 'http://' . $domain;

    if (domainAvailable($httpdomain) == true){
        echo "$domain is not available.";
        if (domainAvailable($httpdomain) == false){
            echo "$domain is available!";   
        }
    }
}
?>
<form method="post" action="">
<div>
<label for="domain name">Suggest a Domain:</label> <input type="text" name="domain" /><br />
<input type="submit" />
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T01:55:06.867

首先理清你的ifs：

```
if (domainAvailable($httpdomain)){
   echo "$domain is not available.";
} else {
   echo "$domain is available!"; 
} 
```

此外，你可能有你的字符串倒退

```
if (domainAvailable($httpdomain)){
   echo "$domain is available.";
} else {
   echo "$domain is not available!"; 
} 
```

然后，摆脱这一行：

```
$httpdomain = 'http://' . $domain; 
```

您的 domainAvailable 函数可能会始终返回 true，因为`http://`它不是有效域名的一部分

对 htmlspecialchars 的调用也可能会导致误报。

把它们放在一起：

```
<?php
#CLI debugging:
if(empty($_REQUEST['domain']) && !empty($argv[1]))
    $_REQUEST['domain'] = $argv[1];

function domainAvailable($domain) {
    $results = @dns_get_record($domain, DNS_ANY);
    return empty($results);
}

if (isset($_REQUEST['domain']))  // check to see if form has been submitted
{
    $domain = htmlspecialchars($_REQUEST['domain'], ENT_QUOTES, 'UTF-8');

    if (domainAvailable($_REQUEST['domain'])) {
        echo "$domain is available.";
    } else {
        echo "$domain is not available!";
    }
} 
```

样本输出：

```
$ php scratch.php google.com | more
google.com is not available!
$ php scratch.php googleasdfasdf.com. | more
googleasdfasdf.com. is available. 
```

# c++ - 有什么工具可以只翻译代码中的注释吗

> ID：10826514
> 
> 赞同：5
> 
> 时间：2012-05-31T01:53:25.903
> 
> 标签：c++, comments, translate

我有一些 C++ 源文件，其中包含意大利语的注释，是否有任何工具可以只将注释翻译成英语。我试过谷歌翻译，它会翻译整个文件，//也会被翻译。因此，从 Google 的翻译结果中粘贴并没有提供有效的 c++ 源文件。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:14:46.840

如果 Google 翻译翻译得足够好，这里有一个适用于 C++ 注释 ( `// ...`) 的方法，粗略但有效：

```
Isolate the comments:
sed -e 's|.*//|//|' -e '/\/\//!s|.*||' sourcefile > comments

Remove the comments from the source:
sed 's|//.*||' sourcefile > barecode

Use Google translate on comments.

paste -d '\0' barecode comments > sourcefile 
```

# javascript - 使用 html5 在 Android 和 iOS 上播放视频

> ID：10826515
> 
> 赞同：1
> 
> 时间：2012-05-31T01:54:11.017
> 
> 标签：javascript, html, video

我正在尝试在 iOS 和 Android 设备上播放视频。我有一个 html 表格，如果您单击一行，它会打开一个播放器，您可以从相应的视频开始。iOS 与下面的代码配合得很好，但 Android 给出了奇怪的行为，它打开了播放器和一个奇怪的巨大播放按钮不在位置。有任何想法吗？

```
<div id="player"></div>
<table>
....
<tr >
<td onclick="DoNav('kft0labfoeiv3f4kdvvm40imu4/video_ec9658f0c1855e2e2ac09ae284f5e6990dbf445d_1338304978.mp4');"> Mycamera
</td>
</tr>
...
</table>

<script>
function DoNav(theUrl)
{

// only add the player if it doesn't yet exist
if($('#myfileplayer').length == 0) {
    var mydiv = $("#player");
    var myvideo = $("<video id='myfileplayer' src='"+ theUrl +
       "' width='280' height='200'  controls></video>");
    mydiv.append(myvideo);
} else {
   $('#myfileplayer').attr("src",theUrl); 
}

$("#myfileplayer").click(function(){
    $(this).play();
});

} 
</script> 
```

我读过这篇文章[让 html5 视频在 android 手机上工作](http://www.broken-links.com/2010/07/08/making-html5-video-work-on-android-phones/)。但我相信我在上面的代码中已经涵盖了这一点。任何人都看到我可以做些什么来让它在Android上运行？

# java - 如何将类型字符串变量传递给 HttpPost？

> ID：10826517
> 
> 赞同：0
> 
> 时间：2012-05-31T01:54:23.883
> 
> 标签：java, eclipse, http-post, httpclient

我正在使用 Java 并尝试使用连接字符串形成 URL。然后将其作为 POST 的 URI 传递给 HttpPost。

此代码失败：

```
String str1 = "http://www.example.com";
String str2 = "/directory";

HttpPost httppost = new HttpPost(str1 + str2); 
```

这也失败了：

```
HttpPost httppost = new HttpPost(str1.concat(str2)); 
```

就像这样：

```
String strCombined = str1 + str2;
HttpPost httppost = new HttpPost(strCombined); 
```

但是，这有效：

```
HttpPost httppost = new HttpPost("http://www.example.com/directory"); 
```

我错过了什么？

编辑：堆栈跟踪：

```
05-31 01:43:29.973: W/System.err(451): java.net.UnknownHostException: http
05-31 01:43:29.983: W/System.err(451):  at java.net.InetAddress.lookupHostByName(InetAddress.java:513)
05-31 01:43:29.993: W/System.err(451):  at java.net.InetAddress.getAllByNameImpl(InetAddress.java:278)
05-31 01:43:29.993: W/System.err(451):  at java.net.InetAddress.getAllByName(InetAddress.java:242)
05-31 01:43:30.003: W/System.err(451):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:136)
05-31 01:43:30.013: W/System.err(451):  at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
05-31 01:43:30.013: W/System.err(451):  at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
05-31 01:43:30.024: W/System.err(451):  at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
05-31 01:43:30.033: W/System.err(451):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
05-31 01:43:30.043: W/System.err(451):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
05-31 01:43:30.043: W/System.err(451):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:15:14.553

从理论上讲，这不是我们可以期待的，对吧？那么在这里困扰您的原因可能是什么。您与我们共享的代码可能是简化版本（为了更好的可读性）而不是您的实际代码，对吗？这让我觉得你的实际代码中可能有错字或任何其他简单的错误，这可能要复杂得多（并且很难找到简单的错误/错别字/错误）。

这可能是一个方法或一个构造函数，比如

```
public HttpPost getConnection(String str1){
 String strCombined = this.domain+ str1;
 HttpPost httppost = new HttpPost(strCombined);
} 
```

在这种情况下，我要做的第一件事是，在将 strCombined 提供给 HttpPost 构造函数之前打印它，看看它是否是我真正期望的。

```
public HttpPost getConnection(String str1){
 String strCombined = this.domain+ str1;
 System.out.print("strCombined : "+strCombined);
 HttpPost httppost = new HttpPost(strCombined);
} 
```

这可能是多线程应用程序的一个简单部分，那么您必须确保此方法是线程安全的！

# regex - 正则表达式错误触发的 MVC3 数据注释

> ID：10826525
> 
> 赞同：1
> 
> 时间：2012-05-31T01:56:05.117
> 
> 标签：regex, asp.net-mvc-3, entity-framework, data-annotations

我有一个实体框架 POCO，它的属性定义如下：

```
[RegularExpression(ValidationHelper.RegularExpressionForDateOnly)]
public virtual DateTime LastBuildDate { get; set; } 
```

常量定义如下：

```
public const String RegularExpressionForDateOnly = 
    @"^(?:(?:(?:0?[13578]|1[02])(\/|-|\.)31)\1|(?:(?:0?[1,3-9]|1[0-2])(\/|-|\.)(?:29|30)\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:0?2(\/|-|\.)29\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:(?:0?[1-9])|(?:1[0-2]))(\/|-|\.)(?:0?[1-9]|1\d|2[0-8])\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$"; 
```

我从 OWASP 得到了那个正则表达式：[https ://www.owasp.org/index.php/OWASP_Validation_Regex_Repository](https://www.owasp.org/index.php/OWASP_Validation_Regex_Repository)

现在，在 MVC3 视图中，我有：

```
<tr>
<td class="editor-label">
    @Html.LabelFor(model => model.LastBuildDate)
</td>
<td class="editor-field">
    @Html.EditorFor(model => model.LastBuildDate)
    @Html.ValidationMessageFor(model => model.LastBuildDate)
</td>
</tr> 
```

当我尝试以“05/30/2012”或“5/30/2012”格式输入日期时，验证失败（客户端和服务器端）。如果我手动尝试该正则表达式，该正则表达式应该允许这些格式。但是，当 MVC3 视图使用它进行验证时，验证失败。

MVC 还有什么其他原因无法通过此正则表达式验证？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:03:05.827

我对正则表达式了解得不够多，无法准确地告诉您您做错了什么，但是当涉及到 MVC3 验证器时，我绝对推荐您也可以在 Nuget 上找到的[Data Annotations Extension 。](http://dataannotationsextensions.org/)它添加了一堆验证属性，包括日期验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T06:37:36.173

顺便提一下，当您需要编写特殊类型时，您可以使用 RemoteValidation 属性（ [http://msdn.microsoft.com/en-us/library/system.web.mvc.remoteattribute(v=vs.98).aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.remoteattribute(v=vs.98).aspx) ）验证，这很简单，因为您不需要制作自定义 DataAnnotation 适配器，然后在 global.asax 中注册您的适配器。

这是一个例子：

您的型号：

```
[Remote("ValidateSpecialNumber", HttpMethod="Post", 
    ErrorMessage = "You're number isn't special.")]
public int SpecialNumber { get; set; } 
```

验证时调用的操作：

```
[HttpPost]
public ActionResult ValidateSpecialNumber(int SpecialNumber)
{
    // validate your number here and return True if validated
    return Json(true);
} 
```

我指出这一点是因为很少有人知道。

问候

# javascript - 即使我注释掉这行 Dog.prototype.constructor=Dog 程序仍然可以正常运行，为什么？

> ID：10826526
> 
> 赞同：0
> 
> 时间：2012-05-31T01:56:30.233
> 
> 标签：javascript

以下代码来自**Example Second Edition 的 JavaScript**，它运行良好。我无法完全理解使用**构造函数**，在我评论 Dog.prototype.constructor=Dog 和 Cat.prototype.constructor=Cat 行之后，我发现它也很有效，我得到了相同的结果，为什么？谢谢！

```
<html>
<head><title>Creating a subclass</title>
<script type="text/javascript">
 function Pet(){ // Base Class
 var owner = "Mrs. Jones";
var gender = undefined;
 this.setOwner = function(who) { owner=who;};
this.getOwner = function(){ return owner; }
 this.setGender = function(sex) { gender=sex; }
this.getGender = function(){ return gender; }
}
 function Cat(){} //subclass constructor
 Cat.prototype = new Pet();
Cat.prototype.constructor=Cat;
 Cat.prototype.speak=function speak(){
return("Meow");
};
 function Dog(){};//subclass constructor
 Dog.prototype= new Pet();
Dog.prototype.constructor=Dog;
Dog.prototype.speak = function speak(){
return("Woof");
};
</script>
</head>
<body><big>
<script>
var cat = new Cat;
var dog = new Dog;
cat.setOwner("John Doe");
cat.setGender("Female");
 dog.setGender("Male");
 document.write("The cat is a "+ cat.getGender()+ " owned by "
+ cat.getOwner() +" and it says " + cat.speak());
document.write("<br>The dog is a "+ dog.getGender() +""+
" owned by " + dog.getOwner() + " and it says "
+ dog.speak());
</script>
</big>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:02:40.267

只是为了让子类被识别为子类。它不会影响构造函数或对象本身的功能，但会影响某种类型的检查。这是一个例子。

留在：

```
var d = new Dog();
d.constructor // Dog, all is good 
```

遗漏：

```
var d = new Dog();
d.constructor // Pet? This dog isn't a dog? 
```

# objective-c - 使全局可变变量可用于 Objective C 中的所有类

> ID：10826527
> 
> 赞同：1
> 
> 时间：2012-05-31T01:56:31.630
> 
> 标签：objective-c

我正在开发一个需要不同类访问的变量的游戏。我想知道是否有办法用 Objective C 制作全局可变变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:01:02.933

在 Objective-C 中创建全局可变变量没有问题。

在头文件中：

```
extern NSMutableArray *gMyArray;
extern NSMutableDictionary *gMyDictionary; 
```

在您的应用程序委托源文件中：

```
NSMutableArray *gMyArray;
NSMutableDictionary *gMyDictionary; 
```

在 applicationDidFinishLaunching 中：

```
gMyArray = [[NSMutableArray alloc] init];
gMyDictionary = [[NSMutableDictionary alloc] init]; 
```

然后只需在要访问全局的每个源文件中#import 头文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T03:13:14.690

通常的方法是提供一个单例类，该类提供对所需变量的访问。而不是暴露一个由调用者直接改变的原始变量，你应该真正封装这些操作。拥有真正的全局变量会产生过多的耦合，并且会产生不好的代码气味。

例如，单例可以让你这样写：

```
[[NetworkTrafficStats instance] addNetworkTraffic:bytes_sent]; 
```

这比维护要好得多：

```
extern unsigned gTotalBytesSent;
//...
gTotalBytesSent += bytes_sent; 
```

值得一读：

*   [单例设计](https://stackoverflow.com/questions/1028909/singleton-design)
*   [Objective-C 单例](http://getsetgames.com/2009/08/30/the-objective-c-singleton/)
*   [ADC：单身人士](https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/Singleton.html)

# jquery - CSS动画悬停jQuery插件的问题

> ID：10826528
> 
> 赞同：0
> 
> 时间：2012-05-31T01:57:36.650
> 
> 标签：jquery, jquery-plugins

我创建了一个 jQuery 插件来在 Hover 上添加简单的 CSS 动画，但不幸的是它只适用于页面中应用了 .animate 类的项目。我怎样才能使它适用于对象本身？而不是一组类或 id。请帮忙。

```
(function($){
   $.fn.extend({

     animate: function(options) {

        var defaults = {
           animation: 'bounce'
        };

        var options = $.extend(defaults, options);

        return this.each(function() 
        {
            var o = options;

            var obj = $(this);

            var animation = o.animation;

  obj.hover(function()         
  {

  switch(animation){
    case 'bounce':
          $(".animate").addClass('bounce');
          break;
    case 'shake':
          $(".animate").addClass('shake');
          break;
    case 'flash':
           $(".animate").addClass('flash');
          break; 
    case 'tada':
           $(".animate").addClass('tada');
          break;
    case 'swing':
           $(".animate").addClass('swing');
          break;
    case 'wobble':
           $(".animate").addClass('wobble');
          break;
    case 'wiggle':
           $(".animate").addClass('wiggle');
          break;
    case 'pulse':
           $(".animate").addClass('pulse');
          break;
    case 'flip':
           $(".animate").addClass('flip');
          break;
    case 'flipInX':
           $(".animate").addClass('flipInX');
          break;
    case 'flipOutX':
           $(".animate").addClass('flipOutX');
          break;
    case 'flipInY':
           $(".animate").addClass('flipInY');
          break;
    case 'flipOutY':
           $(".animate").addClass('flipOutY');
          break;
    case 'fadeIn':
           $(".animate").addClass('fadeIn');
          break;
    case 'fadeInUp':
           $(".animate").addClass('fadeInUp');
          break;
    case 'fadeInDown':
           $(".animate").addClass('fadeInDown');
          break;
    case 'fadeInLeft':
           $(".animate").addClass('fadeInLeft');
          break;
    case 'fadeInRight':
           $(".animate").addClass('fadeInRight');
          break;
    case 'fadeInUpBig':
           $(".animate").addClass('fadeInUpBig');
          break;
    case 'fadeInDownBig':
           $(".animate").addClass('fadeInDownBig');
          break;
    case 'fadeInLeftBig':
           $(".animate").addClass('fadeInLeftBig');
          break;
    case 'fadeInRightBig':
           $(".animate").addClass('fadeInRightBig');
          break;
    case 'fadeOut':
           $(".animate").addClass('fadeOut');
          break;
    case 'fadeOutUp':
           $(".animate").addClass('fadeOutUp');
          break;
    case 'fadeOutDown':
           $(".animate").addClass('fadeOutDown');
          break;
    case 'fadeOutLeft':
           $(".animate").addClass('fadeOutLeft');
          break;
    case 'fadeOutRight':
           $(".animate").addClass('fadeOutRight');
          break;
    case 'fadeOutUpBig':
           $(".animate").addClass('fadeOutUpBig');
          break;
    case 'fadeOutDownBig':
           $(".animate").addClass('fadeOutDownBig');
          break;
    case 'fadeOutLeftBig':
           $(".animate").addClass('fadeOutLeftBig');
          break;
    case 'fadeOutRightBig':
           $(".animate").addClass('fadeOutRightBig');
          break;
    case 'bounceIn':
           $(".animate").addClass('bounceIn');
          break;
    case 'bounceInUp':
           $(".animate").addClass('bounceInUp');
          break;
    case 'bounceInDown':
           $(".animate").addClass('bounceInDown');
          break;
    case 'bounceInLeft':
           $(".animate").addClass('bounceInLeft');
          break;
    case 'bounceInRight':
           $(".animate").addClass('bounceInRight');
          break;
    case 'bounceOut':
           $(".animate").addClass('bounceOut');
          break;
    case 'bounceOutUp':
           $(".animate").addClass('bounceOutUp');
          break;
    case 'bounceOutDown':
           $(".animate").addClass('bounceOutDown');
          break;
    case 'bounceOutLeft':
           $(".animate").addClass('bounceOutLeft');
          break;
    case 'bounceOutRight':
           $(".animate").addClass('bounceOutRight');
          break;
    case 'rotateIn':
           $(".animate").addClass('rotateIn');
          break;
    case 'rotateInDownLeft':
           $(".animate").addClass('rotateInDownLeft');
          break;
    case 'rotateInDownRight':
           $(".animate").addClass('rotateInDownRight');
          break;
    case 'rotateInUpLeft':
           $(".animate").addClass('rotateInUpLeft');
          break;
    case 'rotateInUpRight':
           $(".animate").addClass('rotateInUpRight');
          break;
    case 'rotateOut':
           $(".animate").addClass('rotateOut');
          break;
    case 'rotateOutDownLeft':
           $(".animate").addClass('rotateOutDownLeft');
          break;
    case 'rotateOutDownRight':
           $(".animate").addClass('rotateOutDownRight');
          break;
    case 'rotateOutUpLeft':
           $(".animate").addClass('rotateOutUpLeft');
          break;
    case 'rotateOutUpRight':
           $(".animate").addClass('rotateOutUpRight');
          break;
    case 'lightSpeedIn':
           $(".animate").addClass('lightSpeedIn');
          break;
    case 'lightSpeedOut':
           $(".animate").addClass('lightSpeedOut');
          break;
    case 'hinge':
           $(".animate").addClass('hinge');
          break;
    case 'rollIn':
           $(".animate").addClass('rollIn');
          break;
    case 'rollOut':
           $(".animate").addClass('rollOut');
          break;                                                                                                                              
  }
   $(".animate").addClass('animated');
},

function()
{
    $('.animate').removeClass('animated bounce bounceIn bounceInDown bounceInLeft bounceInRight bounceInUp bounceOut bounceOutDown bounceOutLeft bounceOutRight bounceOutUp fadeIn fadeInDown fadeInDownBig fadeInLeft fadeInLeftBig fadeInRight fadeInRightBig fadeInUp fadeInUpBig fadeOut fadeOutDown fadeOutDownBig fadeOutLeft fadeOutLeftBig fadeOutRight fadeInRightBig fadeOutUp fadeOutUpBig flash flip flipInX flipInY flipOutX flipOutY lightSpeedIn lightSpeedOut pulse rollIn rollOut rotateIn rotateInDownLeft rotateInDownRight rotateInUpLeft rotateInUpRight rotateOut rotateOutDownLeft rotateOutDownRight rotateOutUpLeft rotateOutUpRight shake swing tada wiggle wobble');
});              

        });

    }
});
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:14:13.990

用这个替换 $(".animate") 这应该做你想要的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:15:12.807

您可以使用`this`to 引用自身，注意您不必这样做`$(this)`，因为 inside`this`已经引用了一个`jQuery`对象；来自[文档](http://docs.jquery.com/Plugins/Authoring)：

```
(function( $ ){

  $.fn.myPlugin = function() {

    // there's no need to do $(this) because
    // "this" is already a jquery object 
```

# android - Android 软件键盘触发快速搜索栏

> ID：10826530
> 
> 赞同：2
> 
> 时间：2012-05-31T01:57:50.260
> 
> 标签：android, android-edittext

我有这个奇怪的问题。我有一个这样的 EditText：

```
<EditText 
        android:id="@+id/wordTxt"   
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:hint="@string/enter_word"
        android:layout_marginTop="4dp"
        android:layout_marginLeft="3dp"
        android:layout_marginRight="3dp"        
        android:singleLine="true"
        android:inputType="text"        
        android:imeOptions="normal"/> 
```

问题是，有时当 EditText 获得焦点时，显示的软键盘是触发 Android 快速启动栏的键盘，而不是填充 EditText 的键盘。尤其是在手机重启后会发生这种情况。我已经搜索了互联网，但找不到任何解决方案。有人有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:54:46.213

我不确定这会有所帮助，试试这个

```
InputMethodManager imm = InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
imm.hideSoftInputFromWindow(myEditText.getWindowToken(), 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T03:34:21.433

我真的不知道这个问题的原因，但经过调查，我得出结论，当我在`onCreate`方法中发送文本到语音意图时会发生这种情况。如果我跳过这一步，问题就消失了。作为一种解决方案，我在不同的线程中创建 Intent，该线程将在几毫秒后启动。

# django - Django南迁移AttributeError

> ID：10826532
> 
> 赞同：4
> 
> 时间：2012-05-31T01:58:22.657
> 
> 标签：django, migration, django-south, attributeerror

在 Django (1.4) 中向 South (0.7.5) 迁移时，我遇到了这个错误。我最近将 Timezone 设置更改为 false，即 USE_TZ = False 以解决另一个问题。有任何想法吗？谢谢

```
~/code/django/ssc/dev/ssc/ssc: python manage.py migrate crewcal
Traceback (most recent call last):
  File "manage.py", line 10, in <module>
    execute_from_command_line(sys.argv)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/base.py", line 196, in run_from_argv
    self.execute(*args, **options.__dict__)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/core/management/base.py", line 232, in execute
    output = self.handle(*args, **options)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/south/management/commands/migrate.py", line 105, in handle
    ignore_ghosts = ignore_ghosts,
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/south/migration/__init__.py", line 158, in migrate_app
    Migrations.calculate_dependencies()
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/south/migration/base.py", line 227, in calculate_dependencies
    migration.calculate_dependencies()
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/south/migration/base.py", line 355, in calculate_dependencies
    for migration in self._get_dependency_objects("depends_on"):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/south/migration/base.py", line 335, in _get_dependency_objects
    for app, name in getattr(self.migration_class(), attrname, []):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/south/migration/base.py", line 307, in migration_class
    return self.migration().Migration
AttributeError: 'module' object has no attribute 'Migration'
~/code/django/ssc/dev/ssc/ssc: 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T19:17:28.853

可能为时已晚，但我认为这与 TZ 无关。

每个迁移文件都有如下声明：

```
class Migration(SchemaMigration):
    ... 
```

`AttributeError`原因是没有找到声明的这个迁移类。

检查您的所有迁移是否都有这样的迁移。否则，请提供更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-28T11:36:57.167

对于第二个[Augusto Men](https://stackoverflow.com/users/317971/augusto-men)的回答，错误实际上是关于 South 无法`Migration`在迁移模块中找到实现。这是一般的 Python 错误消息：

```
AttributeError: 'module' object has no attribute 'Migration' 
```

错误在[south.migration.base](https://bitbucket.org/andrewgodwin/south/src/0.8.4/south/migration/base.py#cl-315)中抛出，现在在第 315 行（版本 0.8.4）

## 调试打印输出

不幸的是，`python manage.py migrate`不会告诉您哪个文件受到影响。您可以通过在`<your-virtualenv>/local/lib/python*/site-packages/south/migration/base.py`. 这将告诉您必须处理哪个文件。

```
print('## MODULE: %s' % str(self.migration())) 
```

## 特例

我有一个`AttributeError`显示 for的特殊情况`migrations/<some_app>/__init__.py`，它通常应该只是一个空文件。**在我将一个空模型**文件添加`model.py`到我的应用程序以诱使 Django 查看我的应用程序文件夹后，该空文件停止工作`fixtures`（请参阅[如何从所有应用程序加载 Django 固定装置？](https://stackoverflow.com/questions/5167276/how-to-load-django-fixtures-from-all-apps/24460255#24460255)）。我相信这实际上是一个南方的错误。

## 解决方案

如上所述，找出受影响的迁移模块并简单地将一个`Migration`类的空实现添加到该文件，例如：

```
from south.v2 import SchemaMigration

class Migration(SchemaMigration):
    def forwards(self, orm):
        pass

    def backwards(self, orm):
        pass 
```

# php - ORM 是否满足我们的需求？如果不是，是哪一个？

> ID：10826535
> 
> 赞同：1
> 
> 时间：2012-05-31T01:58:51.013
> 
> 标签：php, orm, doctrine, propel

我为一个拥有大量遗留代码库的网站工作，该代码库有数百个自定义 mysql 查询，使用原始的 PHP MySQL API。出于安全原因，我们想重写我们的模型以删除直接编写的查询。

我们最初的计划是简单地重写我们的查询以使用 PDO PHP 扩展来访问我们的数据库。然而，我们随后开始研究像 Propel 和 Doctrine 这样的 ORM，实际上已经决定尝试使用 Propel。

然而，我开始怀疑这对我们来说是否是矫枉过正——重写我们的模型本身就是一项艰巨的工作。为了完成这项工作，我们将尝试复制模型的现有功能——这意味着将我们所有的数据返回到关联数组中。但是，如果我们这样做，我们是否基本上失去了使用 ORM 系统的大部分好处？

另一个问题是我们的系统严重依赖于缓存查询结果，并使用命名空间系统使结果无效。起初我们认为扩展 Propel 来处理结果缓存可能并不太难，但互联网搜索表明这不是人们通常使用 Propel 做的事情；此外，Doctrine 似乎内置了结果缓存。

如果我们将查询的结果作为关联数组返回，而不是充分利用数据对象，那么我们可能从使用 Doctrine 或 Propel 获得的其他好处是否值得使用 ORM 的开销？我能想到的最好的论点是，在我们完成对模型的大修之后，我们至少可以开始尝试在新系统中充分利用 ORM，并且也许将来可以开始大修旧系统以利用其中。

所以问题是：如果我们不打算使用 ORM 返回对象，我们是否最好直接使用 PDO？或者，如果使用 ORM 有其他优势，Doctrine 的内置缓存是一个杀手级功能（如果我们需要缓存），还是可以将其添加到 Propel 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T09:32:52.153

> 如果我们不打算使用 ORM 返回对象，我们是否最好直接使用 PDO？

在某些时候，每个人都放弃了 ORM，只依赖于 PDO。那是因为水化是昂贵的。

> 或者，如果使用 ORM 有其他优势，Doctrine 的内置缓存是一个杀手级功能（如果我们需要缓存），还是可以将其添加到 Propel 中？

您可以使用 Propel 或 Doctrine 并决定返回对象，而不是数组。您还可以在其中一个 ORM 之上使用缓存层。Doctrine 在他们的“commons”包中提供了一个缓存层（我说的是 Doctrine2，Doctrine 1 无论如何都不再支持了）。Propel 没有提供缓存层，因为有很多现有的库。

在 Propel 中使用缓存层是可行的，只需选择一个缓存库就可以了。顺便说一句，如果你想缓存生成的 SQL 查询，Propel 提供了[查询缓存行为。](http://www.propelorm.org/behaviors/query-cache.html)

总而言之，使用缓存层并不依赖于 ORM，而是依赖于您的应用程序。

# apache - 特立尼达表表现得非常糟糕，多个结果，在刷新时增长

> ID：10826540
> 
> 赞同：1
> 
> 时间：2012-05-31T01:59:43.307
> 
> 标签：apache, html-table, myfaces, trinidad

我正在为一个项目在 MyFaces 网站上工作。它使用的是 Trinidad、Tobago、Tomahawk，在 Tomcat 服务器上进行了测试（T 似乎是他们最喜欢的字母）。一切都或多或少地工作正常并且是最新的。该网站的大部分是建造的。但是，我在尝试使用 tr: table 时遇到了一些非常奇怪的行为。bean 将传递给它一个对象数组列表，该对象的每一列中都列出了字段。问题是，每个字段都被列出了 3 次。如果我在集合中有两个对象，它们每个交替打印 3 次，在表中给出六行。我完全困惑为什么会这样。此外，刷新页面会使表格的大小成倍增加，使已经太多的行增加一倍！我使用 rows="2" 属性来尝试约束它，但每次我选择下一页时它都会增长！

bean 代码非常简单，手动构造两个对象，将它们放入列表中，然后返回列表。我已经验证该列表只有两个条目长。因此，特立尼达代码是：

```
<tr:table value="#{acctManageBean.allEmployees}" var="stat">
<tr:column headerText="Name">
    <tr:outputText value="#{stat.name}"/>
  </tr:column>
  <tr:column headerText="Last">
    <tr:outputText value="#{stat.number}"/>
  </tr:column>
</tr:table> 
```

我在这里只使用快速和肮脏的测试数据，但我完全被一式三份的行为所阻碍。

# c++ - 将共享指针作为参数传递

> ID：10826541
> 
> 赞同：98
> 
> 时间：2012-05-31T01:59:56.860
> 
> 标签：c++, c++11, shared-ptr, c++-faq

如果我声明一个包含在共享指针中的对象：

```
std::shared_ptr<myClass> myClassObject(new myClass()); 
```

然后我想将它作为参数传递给一个方法：

```
DoSomething(myClassObject);

//the called method
void DoSomething(std::shared_ptr<myClass> arg1)
{
   arg1->someField = 4;
} 
```

以上是否只是增加了 shared_pt 的引用计数并且一切都很酷？还是留下一个悬空指针？

你还应该这样做吗？：

```
DoSomething(myClassObject.Get());

void DoSomething(std::shared_ptr<myClass>* arg1)
{
   (*arg1)->someField = 4;
} 
```

我认为第二种方式可能更有效，因为它只需要复制 1 个地址（而不是整个智能指针），但第一种方式似乎更具可读性，我预计不会推动性能限制。我只是想确保它没有危险。

谢谢你。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2012-05-31T03:00:22.587

> 我想将共享指针传递给函数。你能帮我解决这个问题吗？

当然，我可以帮你。我假设您对 C++ 中的所有权语义有一定的了解。真的吗？

> 是的，我对这个主题相当满意。

好的。

好吧，我只能想到两个理由来`shared_ptr`争论：

1.  该函数想要共享对象的所有权；
2.  该函数做了一些专门作用于`shared_ptr`s 的操作。

你对哪一个感兴趣？

> 我正在寻找一个普遍的答案，所以我实际上对两者都感兴趣。不过，我很好奇您在案例 2 中的意思。

此类函数的示例包括`std::static_pointer_cast`自定义比较器或谓词。例如，如果您需要从向量中找到所有唯一的 shared_ptr，则需要这样的谓词。

> 啊，当函数实际上需要操纵智能指针本身时。

确切地。

> 在那种情况下，我认为我们应该通过引用传递。

是的。如果它不改变指针，你想通过 const 引用传递。无需复制，因为您不需要共享所有权。那是另一种情况。

> 好的，我知道了。让我们谈谈另一种情况。

你分享所有权的那个？好的。你如何分享所有权`shared_ptr`？

> 通过复制它。

那么该函数将需要复制 a `shared_ptr`，对吗？

> 明显地。所以我通过对 const 的引用传递它并复制到局部变量？

不，这是一种悲观主义。如果通过引用传递，函数将别无选择，只能手动进行复制。如果它是按值传递的，编译器将在复制和移动之间选择最佳选择并自动执行。所以，按值传递。

> 好点子。我必须更频繁地记住“[想要速度？传递价值。 ”文章。](https://web.archive.org/web/20140205194657/http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)
> 
> 等等，例如，如果函数将 存储`shared_ptr`在成员变量中怎么办？这不会造成冗余副本吗？

该函数可以简单地将`shared_ptr`参数移动到其存储中。移动 a`shared_ptr`很便宜，因为它不会改变任何引用计数。

> 啊，好主意。
> 
> 但我在考虑第三种情况：如果您不想操纵`shared_ptr`, 也不想共享所有权怎么办？

在那种情况下，`shared_ptr`与功能完全无关。如果您想操作指针对象，请获取指针对象，然后让调用者选择他们想要的所有权语义。

> 我应该通过引用还是按价值来获取指针？

通常的规则适用。智能指针不会改变任何东西。

> 如果我要复制，则按值传递，如果我想避免复制，则按引用传递。

正确的。

> 唔。我想你忘记了另一个场景。如果我想共享所有权，但仅取决于特定条件怎么办？

啊，一个有趣的边缘案例。我不希望这种情况经常发生。但是当它发生时，您可以通过值传递并在不需要时忽略副本，或者通过引用传递并在需要时制作副本。

> 我在第一个选项中冒着一个冗余副本的风险，而在第二个选项中失去了潜在的移动。我不能吃蛋糕也吃吗？

如果您处于真正重要的情况，您可以提供两个重载，一个采用 const 左值引用，另一个采用右值引用。一个复制，另一个移动。完美转发功能模板是另一种选择。

> 我认为这涵盖了所有可能的情况。非常感谢。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-05-31T03:39:22.390

我认为人们不必要地害怕使用原始指针作为函数参数。如果函数不打算存储指针或以其他方式影响其生命周期，则原始指针也可以正常工作并代表最低公分母。例如，考虑如何将 a 传递`unique_ptr`给以 a`shared_ptr`作为参数的函数，无论是通过值还是通过 const 引用？

```
void DoSomething(myClass * p);

DoSomething(myClass_shared_ptr.get());
DoSomething(myClass_unique_ptr.get()); 
```

作为函数参数的原始指针不会阻止您在调用代码中使用智能指针，这很重要。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-31T02:07:16.500

是的，关于 shared_ptr<> 的整个想法是多个实例可以保存相同的原始指针，并且只有在 shared_ptr<> 的最后一个实例被销毁时才会释放底层内存。

我会避免指向 shared_ptr<> 的指针，因为这会破坏您现在再次处理 raw_pointers 的目的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T02:07:24.447

在您的第一个示例中传递值是安全的，但有一个更好的习惯用法。尽可能通过 const 引用传递 - 即使在处理智能指针时我也会说是。您的第二个示例并未完全损坏，但非常`!???`. 愚蠢的，没有完成任何事情并且破坏了智能指针的部分要点，并且当您尝试取消引用和修改事物时，会让您陷入痛苦的错误世界。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-22T19:45:14.520

在您的函数中 `DoSomething` ，您正在更改类实例的数据成员，`myClass` 因此您正在修改的是托管（原始指针）对象而不是（shared_ptr）对象。这意味着在此函数的返回点，所有指向托管原始指针的共享指针都将看到它们的数据成员：`myClass::someField`更改为不同的值。

在这种情况下，您将一个对象传递给一个函数，并保证您不会修改它（谈论 shared_ptr 而不是拥有的对象）。

表达这一点的成语是：a const ref, like so

`void DoSomething(const std::shared_ptr<myClass>& arg)`

同样，您向函数的用户保证，您不会将另一个所有者添加到原始指针的所有者列表中。但是，您保留了修改原始指针指向的基础对象的可能性。

CAVEAT：这意味着，如果有人`shared_ptr::reset`在你调用你的函数之前调用，并且在那一刻它是拥有 raw_ptr 的最后一个 shared_ptr，那么你的对象将被销毁，并且你的函数将操纵一个指向被销毁对象的悬空指针。非常危险！！！

# mysql - MySQL选择电子邮件发送帐户到期提醒

> ID：10826543
> 
> 赞同：0
> 
> 时间：2012-05-31T02:00:18.233
> 
> 标签：mysql

我的任务是向我们数据库中的客户发送电子邮件提醒，通知他们的年度订阅即将到期。发送期限为账户过期前30天、15天、7天。已经发送的邮件直到下一个时间段才会重新发送（例如 john.doe@aaa.com 帐户将在 2012-06-01 到期。服务器在 2012-05-02 发送电子邮件，然后等到 2012-05 -17 如果状态没有改变，则再次发送）。此外，如果 account_status.statusId 不是 3，服务器将不会再次发送消息并将 account_metadata.v 设置回 7。

下面的示例数据列表：

**帐户**

```
id  email
1   velit@necenimNunc.com
2   nec@magna.org
3   imperdiet.ullamcorper.Duis@sagittisaugue.com
4   lacus@velitin.edu
5   Curae;@Phasellus.edu
6   dui.nec@Vivamussitamet.org
7   Aliquam.erat.volutpat@Intincidunt.com
8   vehicula.risus.Nulla@id.org
9   Fusce.diam.nunc@egetdictum.ca
10  urna@magnaNam.edu
11  vitae.erat@erategetipsum.ca
12  eu@eratneque.com
13  non@inconsectetuer.com
14  lectus@Nullamfeugiat.ca
15  sit.amet.diam@enimEtiamimperdiet.com
16  consectetuer.euismod.est@euerosNam.com
17  urna.Nunc.quis@egestas.com
18  tristique.aliquet.Phasellus@afelis.org
19  eget.tincidunt.dui@ligula.org
20  primis.in@accumsanneque.edu
21  ultricies.adipiscing@arcuVestibulum.com
22  euismod.et.commodo@nisi.edu
23  iaculis.quis@molestietortornibh.com
24  molestie@Pellentesque.org
25  ligula.tortor.dictum@dolor.com
26  dictum.ultricies.ligula@ipsum.com
27  pretium@turpis.ca
28  neque.Nullam.nisl@feugiatLoremipsum.edu
29  adipiscing.non.luctus@inconsequatenim.ca
30  faucibus@Mauris.com 
```

**帐户状态**

```
id   statusId  accountId  time
1    1         2          2011-06-01 21:54:37
2    1         3          2011-06-02 09:07:14
3    1         4          2011-06-02 09:13:20
4    1         5          2011-06-02 09:54:44
5    1         6          2011-06-02 10:15:52
6    1         7          2011-06-02 10:17:22
7    2         7          2011-06-02 10:21:25
8    1         8          2011-06-02 11:09:03
9    1         9          2011-06-02 11:09:18
10   1         10         2011-06-02 11:13:29
11   1         11         2011-06-02 11:21:11
12   1         12         2011-06-02 11:21:35
13   3         5          2011-06-02 11:41:04
14   3         2          2011-06-02 11:46:07
15   1         13         2011-06-02 11:49:18
16   3         13         2011-06-02 11:53:45
17   1         14         2011-06-02 12:02:26
18   3         14         2011-06-02 12:10:54
19   1         15         2011-06-02 13:41:19
20   1         16         2011-06-02 15:27:03
21   3         16         2011-06-02 15:42:58
22   1         17         2011-06-02 15:46:05
23   1         18         2011-06-02 15:59:56
24   1         19         2011-06-02 16:13:41
25   1         20         2011-06-02 16:17:36
26   1         21         2011-06-02 16:47:04
27   1         22         2011-06-02 16:47:39
28   1         23         2011-06-02 18:35:29
29   1         24         2011-06-02 19:17:06
30   1         25         2011-06-02 20:07:33 
```

**account_metadata**

```
id       accountId  k              v
27033    2          remindEmail    3
27034    3          remindEmail    3
27035    4          remindEmail    3
27036    5          remindEmail    3
27037    6          remindEmail    3
27038    7          remindEmail    3
27039    8          remindEmail    3
27040    9          remindEmail    7
27041    10         remindEmail    7
27042    11         remindEmail    7
27043    12         remindEmail    7
27044    13         remindEmail    3
27045    14         remindEmail    3
27046    15         remindEmail    7
27047    16         remindEmail    3
27048    17         remindEmail    7
27049    18         remindEmail    7 
```

注意：

1.  `accounts.id`并且`account_metadata.accountId`是独一无二的
2.  `accounts.id = account_metadata.accountId = account_status.accountId`
3.  这三个表都是 Innodb

我目前拥有的 MySQL 查询是：

1.  如果 account_status 中的 statusId 不为 3，则将提醒邮件的值设置为 7：

    ```
    UPDATE `account_status` AS acs, `accounts` AS a, `account_metadata` AS am
    SET am.v = '7' 
    WHERE acs.statusId != 3 
    AND acs.accountId = a.id
    AND a.id = am.accountId 
    AND am.k = 'remindEmail'; 
    ```

2.  已发送电子邮件提醒取决于 1 年前的时间段（30 天 => 7、15 天 => 3、7 天 => 1）和`status = 3`：

    ```
    SELECT am.accountId, a.email, am.k, am.v, acs.time
    FROM accounts a 
    INNER JOIN account_status  acs ON a.id = acs.accountId 
    INNER JOIN account_metadata am ON a.id = am.accountId
    WHERE acs.statusId = 3
    AND am.k =  'remindEmail'
    AND NOW() <= DATE_ADD(acs.time, INTERVAL 365 DAY)
    AND NOW() >  DATE_ADD(acs.time, INTERVAL 365 - ((am.v & 1) * 7 + (am.v & 2) * 8 + (am.v & 4) * 15) DAY)
    AND am.v = %s; 
    ```

3.  更新`account_metadata.v`到新状态：

    ```
    UPDATE `account_metadata` AS am
    SET am.v = '%s'
    WHERE am.accountId = '%s'
    AND am.k = 'remindEmail'; 
    ```

这里的问题是，`account_status.accountId`不是唯一的（见上表 where `accountId = 13`）。这将导致#1 将一些行重置为 7，并且客户会觉得他们收到了垃圾邮件。有什么方法可以修改 #2 和/或 #1 以选择最新的`account_status.statusId`（基于`account_status.time`）或通过最新的更新`account_status.stautsId`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T10:51:06.183

我终于自己解决了这个问题。

```
-- If statusId in account_status is not 3, then set value of remindEmail to 7 --
UPDATE account_metadata am  
  INNER JOIN (
    SELECT acs0.id, acs0.accountId, acs0.statusId, acs0.time 
    FROM account_status acs0
    CROSS JOIN (
      SELECT accountId, MAX(id) AS id 
      FROM account_status
      GROUP BY accountId
    ) acs1 USING (accountId, id)
    WHERE acs0.statusId != 3
  ) acs2 ON am.accountId = acs2.accountId
SET am.v = '7'
WHERE am.k = 'remindEmail';

-- Have sent email reminder depend on the period --
-- (30 days => 7, 15 days => 3, 7 days => 1) before 1 year --
-- and status = 3 --
SELECT am.accountId, a.email, am.k, am.v, acs2.time 
FROM accounts a 
INNER JOIN (
  SELECT acs.`id`, acs.`statusId`, acs.`accountId`, acs.`time` 
  FROM `account_status` acs 
  CROSS JOIN (
    SELECT accountId, MAX(id) AS id 
    FROM `account_status` 
    GROUP BY accountId
  ) AS acs1 
  USING (accountId, id) 
  WHERE acs.`statusId` = 3 
) acs2 ON a.id = acs2.accountId 
INNER JOIN account_metadata am ON a.id = am.accountId 
WHERE am.v = %s 
AND am.k =  'remindEmail' 
AND NOW() <= DATE_ADD(acs2.time, INTERVAL 365 DAY) 
AND NOW() >  DATE_ADD(acs2.time, INTERVAL 365 - ((am.v & 1) * 7 + (am.v & 2) * 8 + (am.v & 4) * 15) DAY); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:24:13.313

这似乎有效：

```
SELECT am.accountId, a.email, am.k, am.v, acs.time
FROM accounts a 
INNER JOIN account_status  acs ON a.id = acs.accountId 
AND acs.id = (
    SELECT acs2.id
    FROM account_status acs2
    WHERE  acs2.time = (
           SELECT MAX(acs3.time)
           FROM   account_status acs3
           WHERE  acs3.accountId = acs.accountId)) 
INNER JOIN account_metadata am ON a.id = am.accountId
WHERE acs.statusId = 3
AND am.k =  'remindEmail'
AND NOW() <= DATE_ADD(acs.time, INTERVAL 365 DAY)
AND NOW() >  DATE_ADD(acs.time, INTERVAL 365 - ((am.v & 1) * 7 + (am.v & 2) * 8 + (am.v & 4) * 15) DAY)
AND am.v = %s; 
```

# jquery-mobile - 所有页面的通用页脚

> ID：10826544
> 
> 赞同：3
> 
> 时间：2012-05-31T02:00:45.767
> 
> 标签：jquery-mobile

在我的 JQM 项目中，我有几个可以从页脚访问的页面。

但是，我正在为每个`data-role="page"`我需要包含页脚标记的概念而苦苦挣扎。

有没有办法我可以为整个应用程序指定一次页脚并将按钮`ui-btn-active`设置为我自动打开的页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T06:23:07.003

您可以查看[持久页脚](http://jquerymobile.com/demos/1.1.0/docs/toolbars/footer-persist-a.html)，但您必须为每个页面中的页脚编写代码。使用类`ui-btn-active`，您可以设置活动页面。

你在使用任何移动框架吗？其中一些允许您在公共位置指定 html 代码并将其包含在每个页面中。例如，[罗莫比尔](http://www.rhomobile.com/)。

# sql - SQL查询使用NOT IN找出2列的不同行

> ID：10826547
> 
> 赞同：1
> 
> 时间：2012-05-31T02:01:14.440
> 
> 标签：sql

我非常请求你的帮助。请帮我。

我有 2 张桌子，如下所示：

**第一表**

```
field1  field2  field3  field4    
======  ======  ======  ======    
A       B       C       D    
A       B       C       D    
A       A       C       B   
A       A       C       B 
```

**second_table**

```
field1  field2  field3  field4    
======  ======  ======  ======       
A       B       C       D    
A       B       C       D    
A       A       C       B   
A       A       C       B 
```

我需要准备一个sql查询，如下所示：

*   从 中获取`first_table`不存在于 中的记录`second_table`。
*   此外，查询基于来自 2 列（如 field1 和 field2）的不同记录的组合。

例如：

```
select first_table.field1, first_table.field2,
       first_table.field3, first_table.field4
from
first_table
where
distinct (first_table.field1 NOT IN second_table.field1 AND first_table.field2 
    NOT IN second_table.field2) 
```

但是上面的查询不起作用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:24:25.263

你是这个意思吗？

```
select first_table.field1, first_table.field2,
       first_table.field3, first_table.field4
from first_table
where not exists (
    select 1 from second_table
    where second_table.field1 = first_table.field1
    and second_table.field2 = first_table.field2
) 
```

这假定字段不允许为空。如果需要，易于详细说明处理 null ，但执行此操作的首选方式因数据库而异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T05:20:26.600

您的问题尚不清楚，但我向您提出了两个问题，两个问题都运行良好，我认为其中一个问题肯定会满足您的要求。

1\.

```
select first_table.field1,first_table.field2,first_table.field3,first_table.field4
     from      first_table
     join second_table
     on first_table.field1 not like second_table.field1 and first_table.field2 not like second_table.field2; 
```

2.

```
select first_table.field1,first_table.field2,first_table.field3,first_table.field4 from first_table
 join second_table
 on (first_table.field1  like second_table.field1 and first_table.field2 like          second_table.field2)
   group by first_table.field1,first_table.field2,first_table.field3,first_table.field; 
```

我认为其中之一会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:50:08.183

此查询将在 first_table 中查找在 second_table 中没有相应记录的记录。尝试此操作后，请具体说明您需要什么，以便我们为您提供帮助。

```
select t1.field1, t1.field2, t1.field3, t1.field4 from first_table as t1
left outer join second_table as t2 on t1.field1 = t2.field1 and t1.field2 = t2.field2
where t2.field1 is null and t2.field2 is null 
```

# seo - 是否使用 onclick='window.location' 创建的 Google 索引链接

> ID：10826552
> 
> 赞同：2
> 
> 时间：2012-05-31T02:02:05.120
> 
> 标签：seo

我的网站上有很多链接，例如：

它们是否被索引为常规超链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:06:32.230

也许。搜索引擎通常不处理 JavaScript，但它们开始处理`onclick='window.location'`属于其中的基本 JavaScript。所以他们可能会，但他们可能没有正常链接那么有价值。（内部链接确实具有 SEO 价值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T13:36:36.763

对于谷歌是的！他的爬虫处理简单的 javascrpit 重定向，包括 onclick='window.location'。他没有像经典的 href 链接那样重视，但他可以用它来索引您的页面！

# android - android开发：应用程序错误问题

> ID：10826553
> 
> 赞同：3
> 
> 时间：2012-05-31T02:02:07.100
> 
> 标签：android, android-logcat

我在 Google Play 上有一个 android 应用程序，我有几个人报告了这个错误。但我不知道这意味着什么以及出了什么问题。如果有人可以帮助我并告诉我问题出在哪里，或者有什么好的建议。感谢您的帮助。

```
 java.lang.NullPointerException
 at android.media.MediaPlayer.add_mm_settings(MediaPlayer.java:1855)
 at android.media.MediaPlayer.setDataSource(MediaPlayer.java:798)
 at android.widget.VideoView.openVideo(VideoView.java:225)
 at android.widget.VideoView.access$2000(VideoView.java:49)
 at android.widget.VideoView$6.surfaceCreated(VideoView.java:482)
 at android.view.SurfaceView.updateWindow(SurfaceView.java:551)
 at android.view.SurfaceView.dispatchDraw(SurfaceView.java:348)
 at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
 at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
 at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
 at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
 at android.view.ViewGroup.drawChild(ViewGroup.java:1730)
 at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1459)
 at android.view.View.draw(View.java:6973)
 at android.widget.FrameLayout.draw(FrameLayout.java:357)
 at com.android.internal.policy.impl.PhoneWindow$DecorView.draw(PhoneWindow.java:1949)
 at android.view.ViewRoot.draw(ViewRoot.java:1600)
 at android.view.ViewRoot.performTraversals(ViewRoot.java:1321)
 at android.view.ViewRoot.handleMessage(ViewRoot.java:1957)
 at android.os.Handler.dispatchMessage(Handler.java:99)
 at android.os.Looper.loop(Looper.java:150)
 at android.app.ActivityThread.main(ActivityThread.java:4306)
 at java.lang.reflect.Method.invokeNative(Native Method)
 at java.lang.reflect.Method.invoke(Method.java:507)
 at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
 at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
 at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-14T03:45:13.733

也有这个问题。将 ACCESS_NETWORK_STATE 权限添加到我的 AndroidManifest.xml 解决了这个问题。

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

# c# - 如何在 SharePoint 中获取文件的元数据

> ID：10826558
> 
> 赞同：2
> 
> 时间：2012-05-31T02:02:46.833
> 
> 标签：c#, sharepoint, metadata, spfile

我正在尝试获取 SharePoint 上文件的名称属性？

如果我尝试获取我创建的列的元数据，我可以使用此方法获取此数据

**文件**是 SPFile。

```
if (file.GetProperty("DocId") != null)
{
    docId = file.GetProperty("DocId").ToString();
} 
```

但是当我试图得到名字时

```
if (file.GetProperty("Name") != null)
{
    docId = file.GetProperty("Name").ToString();
}
else {...} 
```

它转到 else 语句。

我哪里错了？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T02:15:29.013

您很可能希望查看与文档库中的 SPFile 关联的 SPItem 的属性 - [SPFile.GetListItem](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfile.getlistitem)。

您还可以使用[SPFile.Properties](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spfile.properties)枚举文件的所有属性，以查看“文件名”属性的名称类似于“vti_title”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T03:42:44.977

用了之后就好了

```
file.Item.Name; 
```

# firefox - 媒体查询在 safari 或 chrome 中不起作用。在Firefox中工作正常

> ID：10826564
> 
> 赞同：1
> 
> 时间：2012-05-31T02:03:41.993
> 
> 标签：firefox, media

[http://timenoplace.com/releases/](http://timenoplace.com/releases/)

这是我正在开发的网站。

媒体查询在 Firefox 中完美运行，而不是在 safari 或 chrome 中。

如果您将宽度降低到 960 以下 - 您会在 Firefox 中看到背景变为黄色......但在 safari 和 chrome 中，更改不会注册。

我以前从未遇到过这个问题。它快把我逼疯了。

在网上找不到任何东西......有人有什么想法吗？？？css 验证...

该项目是我为 wordpress 构建的主题。这可能与此有关吗？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T18:58:41.323

在第 282 行的 style.css 中，您有一个`@media screen {`没有关闭的块`}`。在媒体屏幕的 css 规则之后添加右括号（第 1320 行） - 这应该可以解决问题。

我猜 Firefox 与 chrome 和 safari 不同，它对语法并不太挑剔。

# android - 如何限制 EditText 输入内容

> ID：10826566
> 
> 赞同：4
> 
> 时间：2012-05-31T02:04:10.813
> 
> 标签：android, numbers, android-edittext, phone-number

我正在尝试创建一个简单的计算器，它为用户提供 EditText 以输入数字。允许的输入内容应该是`[1,2,3,4,5,6,7,8,9,0,.]`

我知道可以通过使用以下代码来限制输入内容

```
android:digits="1234567890."
android:inputType="phone" 
```

`.`但是如何防止用户在 EditText 框中添加多个点 ( )？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T02:40:51.263

您可以 在 EditText 中使用[InputFilter限制字符：](http://developer.android.com/reference/android/text/InputFilter.html)

```
EditText mEdit = (EditText)findViewById(R.id.mEdit);          
InputFilter[] filters = {new AdnNameLengthFilter()};  
mEdit.setFilters(filters);  
public static class AdnNameLengthFilter implements InputFilter  
    {  
        private int nMax;  

        public  CharSequence filter (CharSequence source, int start, int end, Spanned dest, int dstart, int dend)  
        {  
            Log.w("Android_12", "source("+start+","+end+")="+source+",dest("+dstart+","+dend+")="+dest);  

            if(dest.toString()=="."||( source.toString()==".")  
            {  
               //DO SOMTHING HERE  
            }else  
            {  
                //DO SOMTHING HERE
            }  
        }
    } 
```

第二个选项是[TextWatcher](http://developer.android.com/reference/android/text/TextWatcher.html)，用于查找用户输入的字符：

```
mEditText = (EditText)findViewById(R.id.ET);
mEditText.addTextChangedListener(mTextWatcher);
TextWatcher mTextWatcher = new TextWatcher() {
        @Override
        public void beforeTextChanged(CharSequence s, int arg1, int arg2,
                int arg3) {
            // YOU STRING BEFORE CHANGE
        }
        @Override
        public void onTextChanged(CharSequence s, int arg1, int arg2,
                int arg3) {
              // CHARS INPUT BY USER
        }
        @Override
        public void afterTextChanged(Editable s) {
              // AFTER TEXT CCHANGE In EDITTEXT BY USER
        }
    }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:07:44.507

使用[TextWatcher](http://developer.android.com/reference/android/text/TextWatcher.html)在输入时检查每个内容，并确定是否应允许将其输入 EditText 或忽略它。

让自己成为一个并覆盖它的方法来实现你想要的任何逻辑。

创建 TextWatcher 后，将其应用于 EditText，如下所示：

```
edt.addTextChangedListener(mTextWatcher); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T02:37:26.570

您可以使用此[数字](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3adigits)属性`android:digits="0123456789"`

# asp.net-mvc - 在 MVC3 ASP.NET 的 PartialView 中使用 RenderPartial

> ID：10826567
> 
> 赞同：1
> 
> 时间：2012-05-31T02:04:26.630
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, partial-views

我对它的工作原理感到非常困惑：

我有一个由控制器呈现的部分视图。此部分视图通过 Ajax 调用呈现，并由控制器的 ActionResult 提供服务。部分视图是强类型的，并通过模型渲染

```
return this.PartialView("OuterPartialView", modelObject). 
```

在这个局部视图中，我通过`@{ Html.RenderPartial("HiddenVariablesView", Model); }`渲染一小部分隐藏变量（我使用 HiddenFor 将它们注入表单）的调用来渲染另一个局部视图，它也是强类型并绑定到同一模型。

**问题是**：隐藏的输入变量在 HTML 中呈现为模型的空/默认值 - 就好像传递的模型只是通过默认构造函数创建的一样。更奇怪的是，当我在局部视图生成（“HiddenVariablesView”和“OuterPartialView”）中放置一个断点时，我可以看到我的模型对象被正确填充。

将不胜感激任何建议

**编辑：** “OuterPartialView”有一个提交回自身的表单（通过 ajax），并且基本上用 div 内的新版本替换自身。看起来局部视图的模型正在恢复为通过动作控制器的 GET 方法构造 OuterPartialView 时最初创建的模型。在提交期间会调用控制器的任何 POST 方法，但在控制器内部完成的模型更改不会反映在生成的 HTML 中

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T04:14:17.037

按照设计，HTML 助手将首先查看您的 POST/GET 数据，并且只有在没有找到任何内容时才会使用您的模型。因此，如果您将模型发布到您的操作，创建一个新模型，设置它，然后返回它，这些新模型值将不会被 HTML 帮助程序使用。为了解决这个问题，你可以做

```
ModelState.Remove("specificvalue"); 
```

或核对整个模型

```
ModelState.Clear(); 
```

有关更多解决方法，请参阅[ASP.Net MVC Html.HiddenFor 错误值](https://stackoverflow.com/questions/4710447/asp-net-mvc-html-hiddenfor-with-wrong-value)。

# c++ - 线程合并排序给出无效结果

> ID：10826568
> 
> 赞同：0
> 
> 时间：2012-05-31T02:04:33.297
> 
> 标签：c++, multithreading, mergesort

我创建了一个适用于非重复整数数组的合并排序。我正在尝试制作相同的多线程版本。

我得到了无效的结果。

```
void mergesort(int data[ ], size_t n)
{
    size_t n1; // Size of the first subarray
    size_t n2; // Size of the second subarray

    if (n > 1)
    {
        // Compute sizes of the subarrays.
        n1 = n / 2;
        n2 = n - n1;

        mergesort(data, n1);         // Sort from data[0] through data[n1-1]
        mergesort((data + n1), n2);  // Sort from data[n1] to the end

        // Merge the two sorted halves.
        merge(data, n1, n2);
    }
}

DWORD WINAPI threadedmergesort(LPVOID params)
{
    size_t n1; // Size of the first subarray
    size_t n2; // Size of the second subarray
    Params* parameters = (Params*) params;
    if (parameters->size > 1)
    {
        // Compute sizes of the subarrays.
        n1 = parameters->size / 2;
        n2 = parameters->size - n1;

        Params* p1 = new Params(parameters->dataArray, n1);
        //mergesort(data, n1);         // Sort from data[0] through data[n1-1]
        HANDLE h1 = CreateThread(NULL, 0, threadedmergesort, (LPVOID)p1, 0, NULL);
        Params* p2 = new Params(parameters->dataArray, n2);
        //mergesort((data + n1), n2);  // Sort from data[n1] to the end
        HANDLE h2 = CreateThread(NULL, 0, threadedmergesort, (LPVOID)p1, 0, NULL);
        WaitForSingleObject(h1, INFINITE);
        WaitForSingleObject(h2, INFINITE);

        // Merge the two sorted halves.
        merge(parameters->dataArray, n1, n2);
    }
    return (DWORD)0x0; //null
}

struct Params
{
    int* dataArray;
    int size;
    Params(int _dataArray[], int _size);
};
Params::Params(int _dataArray[], int _size)
{
    dataArray = _dataArray;
    size = _size;
} 
```

有人可以评论为什么我会使用合并排序的线程版本得到无效的结果，以及我可以做些什么来纠正这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T13:27:14.520

```
Params* p1 = new Params(parameters->dataArray, n1);
//mergesort(data, n1);         // Sort from data[0] through data[n1-1]
HANDLE h1 = CreateThread(NULL, 0, threadedmergesort, (LPVOID)p1, 0, NULL);
Params* p2 = new Params(parameters->dataArray, n2);
//mergesort((data + n1), n2);  // Sort from data[n1] to the end
HANDLE h2 = CreateThread(NULL, 0, threadedmergesort, (LPVOID)p1, 0, NULL); 
```

看起来您将 p1 两次发送到合并排序器。因此，您只是对列表的前半部分进行排序。改变你的第二个参数，一切都应该是正确的。

我的合并排序如下所示：

```
DWORD WINAPI Mergesorter::mergesort_MT(LPVOID param)
{
    Mergesort_Params* i_mergesortParams = (Mergesort_Params*)param;
    unsigned int half = i_mergesortParams->numberOfValues / 2;
    DWORD threadId[2] = {0,0};
    HANDLE h[2];
    Mergesort_Params* mergesortParams;

    if(i_mergesortParams->numberOfValues > 1)
    {
        mergesortParams = new Mergesort_Params[2];
        mergesortParams[0].l_list = i_mergesortParams->l_list;
        mergesortParams[1].l_list = i_mergesortParams->l_list + half;
        mergesortParams[0].numberOfValues = half;
        mergesortParams[1].numberOfValues = i_mergesortParams->numberOfValues - half;

        h[0] = CreateThread(0,0,mergesort_MT,(void*)&mergesortParams[0],0,&threadId[0]);
        //WaitForSingleObject(h[0],INFINITE);
        h[1] = CreateThread(0,0,mergesort_MT,(void*)&mergesortParams[1],0,&threadId[1]);        
        //WaitForSingleObject(h[1],INFINITE);
        WaitForMultipleObjects(2,h,TRUE,INFINITE);
        merge_ST(i_mergesortParams->l_list,half,i_mergesortParams->numberOfValues - half);

    }

//delete threadId;
//delete h;
//delete mergesortParams;

return 0;
} 
```

你解决了你的问题吗？现在我的问题是，我无法对足够的值进行排序 100000 太多（单线程没问题）并且我的 CPU 没有完全使用（我的 A8-3500M 上 25%，所以只有一个核心）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-16T13:49:28.133

需要考虑的几点：

1.  不要使用`CreateThread`，`beginThreadEx`而是使用，请参阅 MSDN 了解更多信息。
2.  正如 TOAOGG 已经指出的那样，您有数据竞争，因为多个线程访问同一内存，并且您没有同步。
3.  您应该使用操作系统线程池而不是显式创建自己的线程。由于这是一种递归算法，因此对于较大的数据集，您将面临耗尽系统资源的风险。每个线程在用户空间中获得 1MB 的默认堆栈大小（不确定，但我认为内核空间中还有另外 1MB），因此对于 32 位进程，您将很快撞到那堵墙。另外，快速创建新线程会产生大量开销，这将减少您在此处想要的任何并发收益。请参阅[SubmitThreadPoolWork 和相关 API](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686766%28v=vs.85%29.aspx)

使用线程池 API 的另一种替代方法是使用 OpenMP 在 C++ 中执行并行 for 循环。Visual Studio 2008 及更高版本支持该选项（当然还有英特尔编译器）。

# r - 在ggplot2条形图中获取分组条形的中点值

> ID：10826569
> 
> 赞同：3
> 
> 时间：2012-05-31T02:04:34.230
> 
> 标签：r, ggplot2

这段代码

```
library(ggplot2)  

test=read.table(text= 
"group fillcd percent
1 1 73.2
1 2 73.8
1 3 78.6
2 1 78.1
2 2 95.6
2 3 95.5
", header=TRUE, sep=""  )        

test$fill <- factor(test$fillcd, labels=c("XX", "EE", "BB"))
test$text=paste(test$percent,"%")

ggplot(data=test, 
  aes(group, percent, fill=fill)) + 
    geom_bar(stat="identity",position="dodge")+
    coord_flip()+  
    geom_text(data = test, aes(y = percent, x = group, label = text )) 
```

生成以下图表： ![在此处输入图像描述](../Images/2cdbe4f2cc8dab5824deba3cbd7e044f.png)

如何获得条形的中点以便在那里放置标签？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T02:22:00.410

我不确定您是指水平中点还是垂直中点，但以下示例可能会有所帮助：

```
ggplot(data=test, 
       aes(group, percent, fill=fill)) + 
         geom_bar(stat="identity",position=position_dodge(width = 0.9))+
         coord_flip()+  
         geom_text(data = test, aes(y = percent/2, x = group, label = text ), 
           position = position_dodge(width = 0.9)) 
```

![在此处输入图像描述](../Images/1a832a39fb125f6403f6e88e49a5d0dd.png)

关键是`position_dodge`。

# apache - 如何使 cfimage 在 Apache 上与 ColdFusion 10 一起工作？

> ID：10826570
> 
> 赞同：4
> 
> 时间：2012-05-31T02:04:35.237
> 
> 标签：apache, tomcat, coldfusion, osx-lion, coldfusion-10

我刚刚在运行包含的 Apache Web 服务器的 OS X 上从 ColdFusion9 升级到 ColdFusion10。现在，我使用带有 writeToBrowser 选项的 cfimage 写入浏览器的所有图像都会引发 404 错误。

在 CF9 下，我之前已将我的 Web 服务器设置为使用一些带有自签名证书的虚拟目录来启用 SSL。我不认为 SSL 是问题的一部分，但你知道的越多越好。

看起来只是缺少某种在安装过程中没有生成的映射（我已经做了几次，结果相同）。

我尝试向 CFFileServlet 目录添加一个别名，该目录将我的 404s 更改为 403s，但我不确定如何纠正这个问题，因为所有文件系统属性都显示为所有人读取。

是否有一些关于如何设置虚拟目录以使 CFFileServlet 位置在我的网站中工作的指导？

如果我查看实际目录，则会在其中正确创建文件。

这是我的 virtualHosts 文件中的示例：

```
 <VirtualHost *:80>
        DocumentRoot "/Library/WebServer/Documents/xxxxxxxxxx"
        ServerName xxxxxxxxxx.local
        DirectoryIndex index.cfm
        Options FollowSymLinks
        Alias /CFIDE /Library/WebServer/Documents/CFIDE
        Alias /mxunit /Library/WebServer/Documents/mxunit

        RewriteEngine On
        RewriteCond %{HTTPS} off

        RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI}

    </VirtualHost>

    <VirtualHost *:443>
        SSLEngine on
        SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
        SSLCertificateFile /etc/apache2/ssl/xxxxxxxxxx.crt
        SSLCertificateKeyFile /etc/apache2/ssl/xxxxxxxxxx.key

        DocumentRoot "/Library/WebServer/Documents/xxxxxxxxxx"
        ServerName xxxxxxxxxx.local
        DirectoryIndex index.cfm
        Options FollowSymLinks
        Alias /CFIDE /Library/WebServer/Documents/CFIDE
        Alias /mxunit /Library/WebServer/Documents/mxunit
    </VirtualHost> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-06T02:12:48.007

经过多次试验和错误并查看本纳德网站上的帖子，我终于得到了这个工作。我决定把它放在 CF10 安装创建的 mod_jk.conf 文件中，这样我就可以将所有 cf 特定的东西放在一起。在文件的底部，我添加了一个别名并将该位置的权限设置为：

```
Alias /CFFileServlet "/Applications/ColdFusion10/cfusion/tmpCache/CFFileServlet"
<Directory "/Applications/ColdFusion10/cfusion/tmpCache/CFFileServlet">
  Options Indexes FollowSymLinks
  AllowOverride None
  Order allow,deny
  Allow from all
</Directory> 
```

之后，我所有的图像都亮了。

我打算将此条目标记为答案，因为它包含有关如何使其工作的详细信息，但我会将赏金奖励给 Kevin，因为它为我指明了正确的方向。谢谢凯文！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T14:53:54.763

如果在 Apache 中使用 VirtualHosts，您需要使用 JkMountCopy 指令。请参阅[Apache Tomcat 连接器文档](http://tomcat.apache.org/connectors-doc/reference/apache.html)，尤其是 JkMountCopy 指令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-18T00:42:40.413

带有 Apache cfimage 的 Ubuntu 12.10 上的 CF10 显示空白页，将以下内容添加到“/etc/apache2/mod_jk.conf”。

```
Alias /CFFileServlet "/opt/coldfusion10/cfusion/tmpCache/CFFileServlet"
<Directory "/opt/coldfusion10/cfusion/tmpCache/CFFileServlet/">
Options Indexes FollowSymLinks
AllowOverride None
Order allow,deny
Allow from all
</Directory> 
```

然后重新启动 Apache，cfimage writeToBrowser 现在可以工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-04T06:50:14.307

不确定您是否已经尝试过，但此[url](http://www.bennadel.com/blog/1868-URL-Rewriting-And-ColdFusion-s-WriteToBrowser-Image-Functionality-CFFileServlet-.htm)解释了您所描述问题的解决方案。它主要讨论 IIS，但如果您查看下面的评论，同样的解决方案也已在 Apache 上尝试过。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T16:20:54.560

对于带有 Apache 和标准安装目录的 Linux 上的 CF10 Standard，您也可以使用这个：

```
RewriteEngine on
RewriteRule ^/CFFileServlet/(.*) /opt/coldfusion10/cfusion/tmpCache/CFFileServlet/$1 [L] 
```

将其添加到`/etc/httpd/conf/mod_jk.conf`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-03T21:14:49.963

通过将“CFFileServlet”虚拟目录添加到“C:\Coldfusion10\cfusion\tmpCache\CFFileServlet”，我能够在 Windows Server 2008 上的 IIS 8 中实现此功能。起初它不起作用，然后我发现我启用了一个重写规则，它将所有 URL 转换为小写。显然这是区分大小写的。禁用该重写规则后，我的 CFCaptcha 图像再次工作！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-25T19:45:03.953

一位海报乔尔对此映射的大小写敏感性质有疑问......

编辑 C:\ColdFusion10\cfusion\wwwroot\WEB-INF\web.xml 并将 servlet 映射的 url-pattern 更改为小写，然后重新启动 CF 应用程序服务器将解决问题

请注意，CFFileServlet 版本将不再工作。如果您的服务器运行多个 CF 站点，并且并非所有站点都将 URL 重写设置为小写，那么有些会中断。

# emacs - ECB vs global vs cscope ..在emacs中

> ID：10826571
> 
> 赞同：1
> 
> 时间：2012-05-31T02:04:41.620
> 
> 标签：emacs, global, cscope, emacs-ecb

我主要使用 cscope 来浏览 emacs 中的源代码。

很难谷歌其他人主要用来浏览源代码的东西。
因为 ECB（emacs 代码浏览器）由于搜索词相似性（browse*）而排在首位

我想知道其他熟练的 emacs 用户使用什么来浏览 c/c++/objective-c 源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T22:12:30.557

我使用 GNU Global 和 Speedbar。

如果您有兴趣尝试它，我写了[一篇](http://www.wolinlabs.com/blog/emacs.global.speedbar.html)关于如何设置和使用它的博客文章......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T05:58:50.387

我主要在代码+语义的内置导航例程中使用`ctags`&进行导航。`gtags`但我主要使用带有一些 Java/Hadoop 片段的 C/C++ 代码

# wpf - 创建的 Viewport2DVisual3D 框架不可见

> ID：10826577
> 
> 赞同：5
> 
> 时间：2012-05-31T02:06:21.090
> 
> 标签：wpf, frame, visible, viewport3d

大家好，我有这样的框架代码

```
<Frame Name="wow" Width="1200" Height="600" ></Frame> 
```

当我单击 a`button`时，它会使用这样的 url 加载它

```
wow.Source=(new Uri("http://www.google.com")); 
```

当我把它扔进一个容器时它会起作用`grid`，它看起来很好，但是当我把它扔进一个`viewport2dvisual3d`容器时，它就不会出现。

```
 <Viewport2DVisual3D.Visual >
    <Grid Width="1200" Height="600" Name="frontPanel" Background="Blue">
      <Frame Name="wow" Width="1200" Height="600" ></Frame>            
        </Grid>                   
          </Viewport2DVisual3D.Visual> 
```

`frame`甚至不可见。我确实看到我的鼠标在几秒钟内变为加载符号，但我似乎仍然看不到框架。

这是一个错误吗？或者我是否必须做一些事情才能使框架出现在`viewport2dvisual3d`视口 3d 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-12T10:24:11.203

到目前为止，我可以看到您缺少 the`Geometry`和`Material`for`Viewport2DVisual3D`和`Viewport2DVisual3D.IsVisualHostMaterial`for`Material`

Viewport2DVisual3D 对象的完整示例

```
 <Viewport2DVisual3D>
        <Viewport2DVisual3D.Geometry>
            <MeshGeometry3D Positions="-1,1,0 -1,-1,0 1,-1,0 1,1,0"
                            TextureCoordinates="0,0 0,1 1,1 1,0"
                            TriangleIndices="0 1 2 0 2 3" />
        </Viewport2DVisual3D.Geometry>
        <Viewport2DVisual3D.Material>
            <DiffuseMaterial Viewport2DVisual3D.IsVisualHostMaterial="True" />
        </Viewport2DVisual3D.Material>
            <Grid Width="1200" Height="600" Name="frontPanel" Background="Blue">
               <Frame Name="wow" Width="1200" Height="600" ></Frame>
            </Grid>
    </Viewport2DVisual3D> 
```

# android - 如何在前台监控应用程序交换？

> ID：10826579
> 
> 赞同：3
> 
> 时间：2012-05-31T02:06:30.827
> 
> 标签：android, foreground

当我的应用程序在后台运行时。它需要在前台监视其他应用程序交换并获取它们的名称。如何实施？即当应用程序进入前台时。必须通知我的应用程序。然后得到它的名字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-04-24T17:44:51.263

可访问性服务提供了一种获取当前前台服务的方法。

扩展 Accessibility Service 并创建一个新类。监听 AccessibilityEvent.TYPE_WINDOW_STATE_CHANGED 事件。每当更改前台活动时都会触发此事件。与回调一起传递的事件对象包含前台应用程序的包名。

AccessibilityService.java

```
public class AccessibilityService extends android.accessibilityservice.AccessibilityService{
    public static AccessibilityService instance;
    @Override
    public void onAccessibilityEvent(AccessibilityEvent accessibilityEvent) {
        // Note : This event is sometimes called more than one for a foreground service
        if (accessibilityEvent.getEventType() == AccessibilityEvent.TYPE_WINDOW_STATE_CHANGED){
            Log.d("Event","TYPE_WINDOW_STATE_CHANGED");
            Log.d("Pkg",accessibilityEvent.getPackageName().toString());
        }
    }

    @Override
    public void onInterrupt() {

    }

    @Override
    protected void onServiceConnected() {
        super.onServiceConnected();
        Log.d("Accessibility","Service Connected");
    }
} 
```

要成功实现该服务，清单文件还必须在应用程序部分包含以下声明以及 res/xml 文件夹中的配置文件

```
<service android:name=".AccessibilityService"
            android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE">
            <intent-filter>
                <action android:name="android.accessibilityservice.AccessibilityService" />
            </intent-filter>
            <meta-data
            android:name="android.accessibilityservice"
            android:resource="@xml/serviceconfig"/>
</service> 
```

服务配置.xml

```
<?xml version="1.0" encoding="utf-8"?>
<accessibility-service
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:accessibilityEventTypes="typeAllMask"
    android:accessibilityFeedbackType="feedbackAllMask"
    android:accessibilityFlags="flagDefault"
    android:notificationTimeout="100"
    android:canRetrieveWindowContent="true"
    /> 
```

确保用户授予无障碍服务权限。它需要从用户一侧手动启用。
获取前台进程名称的示例应用程序的完整代码可在[https://github.com/abinpaul1/Android-Snippets/tree/master/GetForegroundService获得](https://github.com/abinpaul1/Android-Snippets/tree/master/GetForegroundService)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T01:07:32.487

我们不能使用 getRunningTasks，因为 android 指定“方法仅用于调试和呈现任务管理用户界面”。

没有直接的方法可以在后台或前台获取应用程序状态，但有可能了解应用程序何时是前台和后台有关更多详细信息：[请参阅此处](http://vardhan-justlikethat.blogspot.in/2013/05/android-solution-to-detect-when-android.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T02:27:16.590

为了监视其他应用程序，您可以使用[ActivityManager](http://developer.android.com/reference/android/app/ActivityManager.html)来获取活动堆栈的当前顶级应用程序，如您的应用程序中一样：

```
ActivityManager am = (ActivityManager)context.getSystemService(Context. ACTIVITY_SERVICE);
List<ActivityManager.RunningTaskInfo> processes1 = activityManager.getRunningTasks(1);
ComponentName componentInfo = processes1.get(0).topActivity;
String classname =processes1.get(0).topActivity.getClassName(); 
String packagename = processes1.get(0).topActivity.getPackageName(); 
```

# c++ - C ++查找数组中的最大数

> ID：10826584
> 
> 赞同：5
> 
> 时间：2012-05-31T02:07:18.497
> 
> 标签：c++, arrays

我的作业问题：

> 一个名为parkingTickets 的整数数组已被声明并初始化为自今年年初以来市警察每天开出的停车罚单数量。（因此，数组的第一个元素包含 1 月 1 日给出的票数；最后一个元素包含今天给出的票数。）
> 
> 已声明并初始化名为 ndays 的变量以保存数组的大小。（因此，如果今天是 1 月 18 日，ndays 的值为 18；如果今天是 2 月 3 日，ndays 的值为 34。）
> 
> 此外，还声明了一个名为 mostTickets 的变量以及一个变量 k。
> 
> 在不使用任何其他变量的情况下，并且不更改 ndays 的值或 parkTickets 数组的元素，编写一些代码，使 mostTickets 包含在 parkTickets 中找到的最大值。

为此，我有以下代码：

```
for(k = 0; k < ndays; k++) {
    if (parkingTickets[k] > parkingTickets[ndays]) {
        mostTickets = parkingTickets[k];
    }
} 
```

但是我的练习提交者说这是错误的。我的代码有什么问题？我也试过`parkingTickets[ndays - 1]`了，但这也不起作用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-31T02:15:11.120

C++ 也提供[std::max_element](http://www.cplusplus.com/reference/algorithm/max_element)。我怀疑您的老师是否希望您使用它，但是了解标准库可能会很好。

```
mostTickets = *std::max_element(parking_tickets, parking_tickets + ndays) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-31T02:10:35.907

你的比较是错误的。您每次都将当前元素与最后一个元素进行比较。您需要做的是将当前元素与 mostTickets 进行比较。IE

```
if(parkingTickets[k] > mostTickets) 
```

此外，为了更好的衡量标准，我建议将 mostTickets 初始化为 parkingTickets[0]。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T16:39:52.003

让我们首先分析您的解决方案

```
int parkingTickets[] = {3,6,7,4,8,10,0};
int ndays = 7;
for(k = 0; k < ndays; k++) {
    if (parkingTickets[k] > parkingTickets[ndays]) {
    mostTickets = parkingTickets[k]; 
    }
} 
```

这个解决方案的问题是你没有初始化 mostTickets 变量并且你没有 else 子句。这段代码对你有用。

```
 int parkingTickets[] = {3,6,7,4,8,10,0};
 int ndays = 7;
 int mostTickets = -1;
 for(int k = 0; k < ndays; k++) {
    if (parkingTickets[k] > mostTickets) {
    mostTickets = parkingTickets[k]; 
    }
 } 
```

在此之后 mostTickets 将保存数组中最大数字的值。这个解决方案需要 O(n) 才能完成，因为我们正在遍历数组并进行一些比较工作。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2022-01-31T15:31:35.527

```
mostTickets = parkingTickets[0]; k = 1;

while (k < ndays) {
   if (mostTickets < parkingTickets[k])
       mostTickets = parkingTickets[k];
   k++;
} 
```

# wpf - 在网格中的文本块中换行

> ID：10826588
> 
> 赞同：2
> 
> 时间：2012-05-31T02:07:39.780
> 
> 标签：wpf, textblock, word-wrap

我有一个网格如下

```
 <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="115"/>
            <ColumnDefinition Width="140"/>
            <ColumnDefinition Width="115"/>
            <ColumnDefinition Width="140"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0" Grid.Row="0" Margin="5" Grid.RowSpan="5">
            <Border Margin="-1,-1,-1,-1" BorderBrush="#FFFFFFFF" BorderThickness="1,1,1,1" CornerRadius="2,2,2,2">
                <Border BorderThickness="1,1,1,1" CornerRadius="1,1,1,1" Background="#FFFFFFFF">
                    <Border.BorderBrush>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop Color="#FF2F2F2F" Offset="1" />
                            <GradientStop Color="#FF515151" Offset="0.008" />
                        </LinearGradientBrush>
                    </Border.BorderBrush>
                    <Image Margin="5" Stretch="Fill" HorizontalAlignment="Left"
                           VerticalAlignment="Top"  Width="150" Height="150"
                           Tag="{Binding ID}" >
                    </Image>
                </Border>
            </Border>
        </StackPanel>

        <TextBlock Text="Lorem: " Grid.Row="1" Grid.Column="1"  FontWeight="Bold" />
        <TextBlock x:Name="txtId" Text="{Binding lorem}" Grid.Row="1" Grid.Column="2"/>
        <TextBlock Text="Status: " Grid.Row="1" Grid.Column="3" FontWeight="Bold"/>
        <TextBlock Text="{Binding Status}" Grid.Row="1" Grid.Column="4"/>

        <TextBlock Text="DTime: " Grid.Row="2" Grid.Column="1" FontWeight="Bold"/>
        <TextBlock x:Name="txtDetectTime" Text="{Binding DTime}" Grid.Row="2" Grid.Column="2"/>
        <TextBlock Text="CTime: " Grid.Row="2" Grid.Column="3" FontWeight="Bold"/>
        <TextBlock Text="{Binding CTime}" Grid.Row="2" Grid.Column="4" />
        <TextBlock Text="ClTime: " Grid.Row="3" Grid.Column="1"  FontWeight="Bold"/>
        <TextBlock Text="{Binding ClTime}" Grid.Row="3" Grid.Column="2"/>
        <TextBlock Text="Coordinate: " Grid.Row="4" Grid.Column="1" FontWeight="Bold"/>
        <TextBlock Text="{Binding Coordinate}"  Height="Auto" Grid.Row="4" Grid.Column="2" TextWrapping="WrapWithOverflow" Grid.RowSpan="2" />
        <TextBlock Text="Remark: " Grid.Row="4" Grid.Column="3" FontWeight="Bold"/>
        <TextBlock Text="{Binding Remark}" Grid.Row="4" Grid.Column="4"  Height="Auto" TextWrapping="WrapWithOverflow" Grid.RowSpan="2"/>

    </Grid> 
```

现在最后一行的文本通常很长，我想换行。但是文本根本没有换行。

# python - 在 Python 中将文件范围传递给标准输入

> ID：10826594
> 
> 赞同：1
> 
> 时间：2012-05-31T02:08:51.163
> 
> 标签：python, loops, terminal, command, stdin

我在同一目录中有一个系统命名的文件列表，例如。`'test01.ext','test02.ext','test03.ext'...'test99.ext'`. 我想在 Python 中将一定范围的这些文件传递给一个循环。但是，我希望能够确定我想在命令行中循环哪些文件，例如。`'test45.ext'`到`'test62.ext'`. 我该怎么做？

目前我正在使用以下代码：

```
for fname in sys.stdin :
   Some_loop(fname) 
```

出现提示时，我将如何选择（无需手动输入从例如 45 到 62 的所有文件）一系列文件？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:13:39.403

```
files = sys.stdin.splitlines()
for n in range(start,end):
  fname = 'test%02d.ext' % (n,)
  if fname in files:
    some_loop(fname) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:14:01.293

切片文件列表：

```
>>> a =  [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
>>> a[4:6]
[5, 6] 
```

您可能必须`.split('\n')`事先查看文件列表。

# javascript - Cakefile 没有看到 JS 函数

> ID：10826595
> 
> 赞同：0
> 
> 时间：2012-05-31T02:09:00.610
> 
> 标签：javascript, coffeescript, referenceerror, cakefile

我正在编写一个 Cakefile，它定义了一个名为`build`以下行的任务：

```
coffee.stderr.on 'data', (data) ->
    process.stderr.write.data.toString() 
```

当我用 运行任务时`cake build`，它会抛出一个函数未定义的`ReferenceError`说法。`toString`

我尝试修复 Node 安装，并使用`npm`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:11:31.137

我相信你想要

```
process.stderr.write data.toString() 
```

你有一个额外`.`的在那里。

您编写它的方式是尝试调用函数`toString()`的`data`属性。`write`您可能会收到类似`Cannot call method 'toString' of undefined`.

# ruby-on-rails - 有没有一种很好的方法来检查一个字符串是否至少包含一个字符串数组中的一个字符串？

> ID：10826599
> 
> 赞同：6
> 
> 时间：2012-05-31T02:09:51.793
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, string

`string.include?(other_string)`用于检查一个字符串是否包含另一个字符串。有没有一种很好的方法来检查一个字符串是否至少包含一个字符串数组中的一个字符串？

```
string_1 = "a monkey is an animal. dogs are fun"

arrays_of_strings_to_check_against = ['banana', 'fruit', 'animal', 'dog'] 
```

这将返回`true`，因为`string_1`包含字符串`'animal'`。如果我们从中删除`'animal'`，`arrays_of_strings_to_check_against`它将返回`false`。

请注意，字符串`'dog'`from`arrays_of_strings_to_check_against`不应匹配`'dogs'`from `string_1`，因为它必须是完全匹配的。

我正在使用 Rails 3.2.0 和 Ruby 1.9.2

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T02:18:41.177

```
arrays_of_strings_to_check_against.map{ |o| string_1 =~ /\b#{Regexp.escape(o)}\b/ }.any? 
```

甚至：

```
arrays_of_strings_to_check_against.any?{ |o| string_1 =~ /\b#{Regexp.escape(o)}\b/ } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T02:14:03.767

如果`array_of_strings_to_check_against`只包含整个单词，而不是多单词字符串，则可以`&`将两个数组放在一起。如果结果的长度 > 0，则表示匹配。但是，在 之前`.split(' ')`，您必须删除非单词、非空格字符。否则，在这种情况下，它会失败，因为`animal.`(with `.`) 不在您的数组中。

```
if (string_1.gsub(/[^\w\s]/).split(' ') & array_of_strings_to_check_against).length > 0
  puts "Match!!"
end 
```

### 评论后更新：不区分大小写的版本

```
if (string_1.downcase.gsub(/[^\w\s]/).split(' ') & array_of_strings_to_check_against).length > 0
  puts "Match!!"
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T03:06:55.987

```
str1  = "a monkey is an animal. dogs are fun"
str2  = "a monkey is a primate. dogs are fun"
words = %w[banana fruit animal dog]
word_test = /\b(?:#{ words.map{|w| Regexp.escape(w) }.join("|") })\b/i

p str1 =~ word_test,  #=> 15
  str2 =~ word_test   #=> nil 
```

如果你得到`nil`没有匹配; 否则你会得到一个整数（你可以把它当作`true`），它是匹配发生的偏移量的索引。

如果你绝对必须有`true`or `false`，你可以这样做：

```
any_match = !!(str =~ word_test) 
```

通过插值创建的正则表达式为：

```
/\b(?:banana|fruit|animal|dog)\b/i 
```

…其中`\b`匹配“单词边界”，从而防止`dog`匹配`dogs`.

**编辑**：上面的答案不再使用`Regexp.union`，因为它创建了一个区分大小写的正则表达式，而问题需要不区分大小写。

或者，我们可以在测试之前强制所有内容都小写，以获得不区分大小写：

```
words = %w[baNanA Fruit ANIMAL dog]
word_test = /\b#{ Regexp.union(words.map(&:downcase)) }\b/
p str1.downcase =~ word_test,
  str2.downcase =~ word_test 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T05:06:52.863

`Regexp.union`在这种情况下是你的朋友。考虑：

```
# the words we're looking for...
target_words = %w[ore sit ad sint est lore]

search_text = 'Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.'

# define a search ignoring case that looks for partial words...
partial_words_regex = /#{ Regexp.union(target_words).source }/i
partial_words_regex.to_s # => "(?i-mx:ore|sit|ad|sint|est|lore)"

# define a search ignoring case that looks for whole words...
whole_words_regex = /\b(?:#{ Regexp.union(target_words).source })\b/i
whole_words_regex.to_s # => "(?i-mx:\\b(?:ore|sit|ad|sint||lore)\\b)"

# find the first hit...
search_text[whole_words_regex] # => "sit"

# find all partial word hits...
search_text.scan(partial_words_regex) # => ["Lore", "sit", "ad", "ore", "lore", "ad", "lore", "sint", "est"]

# find all whole word hits...
search_text.scan(whole_words_regex) # => ["sit", "ad", "sint", "est"] 
```

把它放在上下文中：

```
string_1 = "a monkey is an animal. dogs are fun"
arrays_of_strings_to_check_against = ['banana', 'fruit', 'animal', 'dog']
string_1[Regexp.union(arrays_of_strings_to_check_against)] # => "animal"
string_1.scan(Regexp.union(arrays_of_strings_to_check_against)) # => ["animal", "dog"] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T02:21:05.600

```
def check_string
  arrays_of_string_to_check_against.each do |item|
      is_include = string_1.include?(item)
  end
end 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-01T05:27:26.087

```
(string_1.scan(/\w+/) & arrays_of_strings_to_check_against).size > 0 
```

# javascript - 如何在回调外使用 node.js 升级事件套接字？

> ID：10826604
> 
> 赞同：0
> 
> 时间：2012-05-31T02:10:43.213
> 
> 标签：javascript, node.js, connect

我正在使用 node.js 连接框架来监听升级事件。我可以使用回调函数中的套接字写回客户端。但是如何使用回调函数外部的套接字写入同一个客户端。在我的情况下，只有一个客户端连接到服务器。

```
app.on('upgrade', function(req, socket) {
    socket.write('hello');    
});

function sendEvent()
{
 // how to use socket here??
}

sendEvent(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:14:23.507

尝试保存套接字以供以后使用（即在`app.on()`函数之外）：

```
var socket;

app.on('upgrade', function(req, sock) {
    socket = sock;
    socket.write('hello');
});

function sendEvent() {
    socket.write('hi!');
}

sendEvent(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T03:53:51.417

如果：

*   实际上只有一个客户端连接到此服务器，或者
*   有多个客户端连接，但所有客户端都可以接收事件

然后你可以使用

```
sockets.emit("some_event") 
```

这将广播到所有连接的客户端（或在您的情况下为 1 个客户端）。

# javascript - 必要时调整图像大小以适合固定高度的容器

> ID：10826608
> 
> 赞同：0
> 
> 时间：2012-05-31T02:11:19.920
> 
> 标签：javascript, jquery, html, css

无论如何，CSS 和/或 JavaScript/jQuery 是否可以仅在需要将剩余内容放入固定高度容器中*时才可以调整图像大小？*如果您在下面的屏幕截图中查看*新的本周*和*每周特价*部分中的图像，您就会明白我的意思。但是，在某些情况下，一切都适合，因为图像足够小并且它们下方的文本量不是很大。

![在此处查看示例](../Images/412819eeb32ae1431f2560e31270345c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:34:32.357

不，不是您所描述的仅使用 CSS。但是，是的，使用 jQuery 你可以做到这一点。

我个人对 jQuery 的效率不够高，无法尝试为您提供编码解决方案，但从概念上讲，您可以执行诸如检查子元素组合的计算高度之类的操作，然后将其与父容器的高度相匹配。然后，如果子元素大于固定元素的高度，则计算差值并将该新值作为内联高​​度属性或内联样式属性添加到图像上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:31:17.303

使用 jQuery：

```
$(document).ready(function() { $('div.item img').each(function() {
    var image = $(this);
    var div = $('div.item p');
    if ((image.height() + div.height()) >> $('div.item').height()) {
        while ((image.height() + div.height()) >> $('div.item').height()) {
            image.height(image.height() - 1);
        }
    }
});}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:51:22.493

设置 max-height CSS 属性有什么问题？

```
<img src="big.jpg" style="max-height:300px"> 
```

然后将 CSS 表达式添加到解决方法 IE6

```
<img src="big.jpg" style="max-height:300px; _height:expression(Math.min(this.offsetHeight, 300))"> 
```

# jquery - 如何发布列表 to struts2/webwork action through jquery ajax?

> ID：10826609
> 
> 赞同：0
> 
> 时间：2012-05-31T02:11:24.850
> 
> 标签：jquery, ajax, struts2, webwork

我想将值发布到列表，即 webwork/struts2 操作的实例字段，但是通过操作接收到的值是 ognl.NoConversionPossible，它有什么问题？我已经在操作中编写了 setter/getter 代码。该动作是一个普通动作，我只需要将一些数据发布到该动作并调用其名为 update 的方法，该方法需要来自前端的 List 参数。就像下面一样。

```
 public class ImageAction {
       private ArrayList<HashMap<String,String>> pks;

       public String update() {
         for (Map map: pks){
           doSth(map.get("seqNo"));
           .......

         }

       }

      public ArrayList<HashMap<String, String>> getPks() {
          return pks;
      }

      public void setPks(ArrayList<HashMap<String, String>> pks) {
          this.pks = pks;
      }

    } 
```

这是我的 jquery 测试代码：

```
var seqs=[]
        var seq1={seqNo:111}
        var seq2={seqNo:222}
        seqs.push(seq1)
        seqs.push(seq2)

        j$.ajaxSettings.traditional = true

        j$.ajax({
            url:approveUrl,
            data:{pks:seqs},
            dataType:'json',
            type:'post',
            traditional: true,
            success:function (response) {
                hideProgressBar(parent.document)
                if (response.result==false){
                    alert(response.msg);
                    return;
                }

//                document.location.reload();
            }

        }) 
```

我添加了引用此[线程](https://stackoverflow.com/questions/5701645/how-to-post-a-list-of-complicated-object-to-struts2)的传统参数。但我没有任何运气。值只能通过传统的方式发布到操作：true，但它不是必需的`List<Map>`，而不是`List<ognl.NoConversionPossible>`，似乎存在一些转换问题。

# objective-c - 多个流，1个文件？

> ID：10826620
> 
> 赞同：0
> 
> 时间：2012-05-31T02:13:03.867
> 
> 标签：objective-c, ios, grand-central-dispatch, nsoperationqueue, nsoutputstream

我想使用多个 NSOutputStreams 将文件写入磁盘（每个都在不同的线程中）。我知道如何处理线程问题，但我不知道用什么来同时将不同的字节范围写入单个文件。

例如，假设写入过程完成时目标文件将在磁盘上为 100 MB。我有 4 个线程和 4 个流（我们将它们称为 s0、s1、s2 和 s3），它们想要将 25MB 写入目标文件。我希望每个流（s0-3）能够同时写入它们各自的目标字节范围（例如 s0 从 0MB-25MB 写入，s1 从 25MB-50MB 写入等）。每个流都是独立的，所以我可以知道哪个流将接收字节或何时接收。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T04:02:30.960

用途`NSFileHandle`及其`-seekToFileOffset:`方法。

# javascript - 添加 1 周的 JS 日期问题

> ID：10826621
> 
> 赞同：2
> 
> 时间：2012-05-31T02:13:07.887
> 
> 标签：javascript, date

我遇到了一个问题，想知道是否有人能给我一些关于原因的见解。以下代码正在为日期添加一周：

```
while (c.getStamp() < b.getStamp()) {
    var f = this.getWeek(c);
    e.push(f);
    c = (c.getStamp() + 604800).toDate();
}

...

Date.prototype.getStamp = function() {
    return Math.round(this.getTime() / 1e3);
};

Number.prototype.toDate = function() {
    return new Date(this * 1e3);
}; 
```

我试图让以下工作，但它会创建一个连续的循环：

```
while (c.getStamp() < b.getStamp()) {
    var f = this.getWeek(c);
    e.push(f);
    c = new Date(c.getFullYear(), c.getMonth(), c.getDate + 7, 0, 0, 0);
} 
```

地点`c = JS Date, ie 05/01/12`和地点`b = JS Date, ie 05/31/12`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T02:15:40.367

你错过了`()`之后`c.getDate`。

除此之外，您可以这样做：

```
c.setTime(c.getTime()+7*24*60*60*1000); // adds 1 week to the date 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T03:26:25.093

要将星期添加到日期，最简单的方法是添加 7 天：

```
var now = new Date();

// add one week exactly
now.setDate(now.getDate() + 7); 
```

如果以毫秒为单位添加相当于 7*24hrs 的值，那么如果一周越过夏令时边界，您将是不正确的。上面的代码在代码中更加清晰。

在您的代码中：

```
> while (c.getStamp() < b.getStamp()) { 
```

如果`c`和`d`都是日期对象，则：

```
while (c < b) { 
```

更高效，更不容易出错并且更少编写。

```
>      var f = this.getWeek(c); 
```

是什么`f`？返回什么`f.getWeek`？

```
>      e.push(f);
>      c = (c.getStamp() + 604800).toDate(); 
```

大概你想给 c 添加一周，所以：

```
 c.setDate(c.getDate() + 7); 
```

之后...

```
>    c = new Date(c.getFullYear(), c.getMonth(), c.getDate + 7, 0, 0, 0);
> --------------------------------------------------------^ 
```

您有语法错误并且没有将毫秒归零。这似乎是一个更长的一周时间`c`，见上文。

> 其中 c = JS 日期，即 05/01/12 和 b = JS 日期，即 05/31/12

请注意，在国际论坛上，如果使用区域特定的表达方式，应避免或解释。以上是美国特有的 mm/dd/yyyy 格式吗？更广泛认可的格式是 dd/mm/yyyy 或更好地使用 ISO8601 格式：yyy-mm-dd（所有兼容 ES5 的浏览器都应该原生支持，但目前还不支持）。

哦，`getStamp`and`toDate`方法似乎试图四舍五入到最接近的秒数。您可以尝试一个一次性完成的功能：

```
Date.prototype.roundToSecond = function() {
  this.setMilliseconds(this.getMilliseconds() > 499? 1000 : 0);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T02:19:06.063

Kolink 有正确的答案，但如果您在处理日期和格式化日期方面做了很多工作，您可能还想看看[Moment.js日期库。](http://momentjs.com/)

# jquery-mobile - 如何让 FullCalendar 在触控设备上工作？

> ID：10826623
> 
> 赞同：17
> 
> 时间：2012-05-31T02:13:33.930
> 
> 标签：jquery-mobile, calendar, fullcalendar

我一直在寻找适合平板电脑的活动日历，但没有找到合适的日历。但是[FullCalendar](http://arshaw.com/fullcalendar/)是一个最好的 jQuery 日历插件，在桌面和平板电脑上看起来很棒。

此日历在桌面上完美运行，但在平板电脑上，我无法根据触摸和滑动选择事件的开始时间和结束时间。当我这样做时，日历会滚动。有什么解决办法吗？我一直在寻找解决方案。

有没有人遇到过这个问题，你解决了吗？请分享您如何解决它的方法。任何形式的帮助表示赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-31T12:09:09.370

您是否尝试过包含[Jquery UI Touch Punch](http://touchpunch.furf.com/)？

默认情况下，Jquery UI 不支持触​​摸事件，因为它没有针对移动设备进行优化。Touch Punch 用 Jquery UI Drag&Drop 功能解决了我的问题，FullCalendar 似乎也使用了这些功能。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-09-24T13:54:15.487

**这行得通**

我使用了这个插件：[jquery.ui.touch.js](https://github.com/joshgerdes/jquery.ui.touch)

为 iOS 和 Android 设备的 Fullcalendar 添加触控支持

只需使用它来初始化您的日历：

```
eventRender: function(event, element) {
            $(element).addTouch();
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-19T19:07:57.637

由于我很难让它与 jQuery UI touch punch 一起使用，而且我找不到任何完整的示例代码，我想我会发布我用来在移动设备上创建和拖动事件的代码：

注意：此示例使用[jQuery UI 触摸打孔](https://github.com/furf/jquery-ui-touch-punch)。

```
$(document).ready(function() {

  $('#calendar').fullCalendar({
    ...
    eventAfterRender: function(event, element, view) {
      element.draggable();
    }
  });

  $('.fc-view tbody').draggable();
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-28T23:26:14.693

根据[此 FullCalendar 博客文章](http://fullcalendar.io/blog/2016/03/touch-support/)，在 v2.7.0 的 beta 版本中提供了 FullCalendar 触摸支持。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-05-02T11:24:34.500

使用最新的[Full Calendar 2.7.1 ，](http://fullcalendar.io/download/)[支持](http://fullcalendar.io/docs/event_ui/Touch_Support/)触控。您甚至可以设置新闻延迟选项。看看文档

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-18T04:51:53.790

我使用了这个插件：jquery.ui.touch.js

这段代码对我有用：

```
$('#calendar').fullCalendar({
[...]
});

$('#calendar').addTouch(); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-10-09T16:42:28.243

对于那些在移动设备上选择一天有困难的人，[这个问题](https://stackoverflow.com/questions/40626776/fullcalendar-select-callback-not-firing-in-mobile/40672810#comment102978688_40672810)非常有帮助，使用 prop longPressDelay as 10 它可以工作！

[在FullCalendar / Docs Touch 支持](https://fullcalendar.io/docs/touch)中查看更多信息

# r - 玩完美俄罗斯方块：如何使用缩放和平移对齐和缩放两条曲线？

> ID：10826625
> 
> 赞同：11
> 
> 时间：2012-05-31T02:13:46.050
> 
> 标签：r, geometry, curve-fitting, curve

给定y轴（s）上的缩放参数和x轴（t）上的平移参数，当目的是最大化曲线叠加（而不是最小化距离）时，如何缩放和对齐两条不重合的曲线？

正如@DWin 所指出的，这可以重新命名为“如何用 R 完美地玩俄罗斯方块”，尽管它的应用程序远远超出了赢得俄罗斯方块游戏的范围。

这个问题的一个变体可能涉及任意数量的刚体变换（旋转、平移和缩放）。

给定曲线 1

```
curve1<-data.frame(x=c(1,1,2,2,3),
                   y=c(9,6,6,3,3))

with(curve1, plot(x=x, y=y, type="l", xlim=c(0,10), ylim=c(0,10))) 
```

![在此处输入图像描述](../Images/2db8da0bbd2eb2cca1a8b2d32af15100.png)

和曲线 2

```
curve2<-data.frame(x=c(4,5,5,6,6,7),
                   y=c(2,2,1,1,2,3))

with(curve2, plot(x=x, y=y, type="l", xlim=c(0,10), ylim=c(0,10))) 
```

![曲线 2](../Images/bbdf6082eecaff82ae8c9dd18a0bc517.png)

我希望找到使两条曲线之间的叠加最大化的 s 和 t。

理想情况下，该方法将在 R 中使用 optim。

在这个组成的例子中，t=3 和 s=1/3，所以

```
t=3
s=1/3

with(curve2, plot(x=x, y=y, type="l", xlim=c(0,10), ylim=c(0,10)))

with(curve1, lines(x=x+t, y=y*s, col="red")) 
```

![在此处输入图像描述](../Images/4b8bd625ae6d692f5594716742ff89fa.png)

请注意，要获得这样的拟合，可以具有共识的区域必须具有比不能叠加的区域更高的参数化权重，并且共识区域越大，权重越高。

我一直在探索的路径：

*   [最小化曲线之间的面积](https://stackoverflow.com/questions/6723157/how-to-compare-two-curves-arrays-of-points)
    *   [叠加两条曲线的算法](http://www.lems.brown.edu/vision/publications/Kimia%27s_Publication/Journals/aligning_curves-PAMI.pdf)
    *   使用形状包进行形状分析
    *   [迭代最近点 (ICP)](http://en.wikipedia.org/wiki/Iterative_closest_point)，如果有人在 R 中实现它或可以移植 C 实现之一

    使用最大似然的方法的奖励分（假设误差的正态分布）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T03:37:21.807

当curve1在y轴上缩放一个因子“tfac”并在x轴上移动一个量“s”时，这将返回点之间的距离：

```
 as.matrix( dist( rbind(as.matrix(curve2), 
                 ( matrix(c(rep(s, 5), rep(1,5)), ncol=2) +   # x-shift matrix
                                       as.matrix(curve1) ) %*% 
                   matrix(c( 1, 0, 0, tfac),ncol=2) ) ) # the y-scaling matrix
                )[ 
                           # better not to use 't' as a variable name
      -(1:5), -(6:11)]  # easier to return the relevant distances when in matrix 
```

将其放入要最小化的函数中应该是一件简单的事情：

```
 dfunc <- function(C1, C2, s, tfac) { sum( .... ) } 
```

我不确定这是否会返回您期望的结果，因为您暗示的目标函数可能不是距离的总和。您可能需要求助于整数编程方法。优化 CRAN 任务视图将是在 R 中查找这些方法的好地方。我想如果出现此问题，另一种选择可能是舍入“s”值并仅缩放到最接近的 2 次方。

```
dfunc <- function(param, D1=curve1, D2=curve2) { 
           sum( as.matrix(dist( 
                   rbind(as.matrix(D2), 
                         ( matrix(c(rep(param[1], 5), rep(1,5)), ncol=2) + 
                           as.matrix(D1) ) %*% 
                   matrix(c(1,0,0,param[2]),ncol=2) ) ) )[-(1:5), -(6:11)])}
optim(c(1,1), dfunc)
#$par
$[1] 3.3733977 0.2243866
# trimmed output 
```

使用这些值可以获得以下叠加： ![使用上述值叠加](../Images/033042bb623d1163d2add5b6e41b0a52.png)

因此，我可能会尝试 s=3, tfac=0.25。（回头看，我从您要求的内容中切换了 t 和 s 的角色。对不起。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-11T14:32:22.940

好的，这是一个解决方案的尝试。

基本技巧是这样的：我们*光栅化*两条曲线，然后我们可以逐块地进行曲线比较。至少，这似乎是比较曲线叠加的一种相当合理的方式。为了鼓励优化器接近曲线，我们还引入了一个损失来惩罚离另一条曲线太远的曲线。

不能保证这适用于更复杂的曲线和变换，但至少这是一个想法。

```
 curve2<-data.frame(x=c(4,5,5,6,6,7),
                    y=c(2,2,1,1,2,3))
 fillin <- function(ax, ay, bx, by, scaling= 10, steps= 100) floor(cbind(seq(from = ax, to = bx, len = steps), seq(from = ay, to = by, len = steps)) * scaling)
 Bmat <- matrix(0, 100, 100)
 for (i in 2:nrow(curve2)){
 Bmat[fillin (curve2[i-1,1], curve2[i-1,2], curve2[i,1], curve2[i,2])] =1
 }
 Bmat.orig = Bmat

 Bmat = Bmat.orig
 #construct utility function based on 
 #manhattan distances to closest point?
 shift = function(mat, offset){
 mat0 = array(0, dim = dim(mat)+2)
 mat0[1:nrow(mat) +1+ offset[1] , 1:ncol(mat) + 1+offset[2]] = mat
 return(mat0[1:nrow(mat) + 1, 1:ncol(mat) + 1])
 }

 for (i in 1:100){
 Bm = (Bmat != 0)
 Btmp1 = shift(Bm, c(1,0))
 Btmp2 = shift(Bm, c(-1,0))
 Btmp3 = shift(Bm, c(0,1))
 Btmp4 = shift(Bm, c(0,-1))

 Bmat = Bmat + pmax(Bm ,Btmp1, Btmp2, Btmp3, Btmp4)/i
 }

 Bmat2 = replace(Bmat, Bmat == max(Bmat), max(Bmat) + 10)

 #construct and compare rasterised versions
 getcurve = function(trans = c(0,1),  curve=data.frame(x=c(1,1,2,2,3) ,
                    y=c(9,6,6,3,3) ), Bmat = Bmat2){
 Amat = array(0, dim = dim(Bmat))
 curve[,1] = curve[,1] + trans[1]
 curve[,2] = curve[,2] * trans[2]
 for (i in 2:nrow(curve)){
 fillin (curve[i-1,1], curve[i-1,2], curve[i,1], curve[i,2]) -> ind
 if (min(ind) < 1 || max(ind) > nrow(Bmat)) return( array(-1, dim= dim(Bmat)))
 Amat[ind] =1
 }
 Amat = (Amat - mean(Amat))/sd(as.vector(Amat))
 Amat
 }
 compcurve = function(trans = c(0,1), curve=data.frame(x=c(1,1,2,2,3) ,
                    y=c(9,6,6,3,3) ) , Bmat = Bmat2){
 Amat = getcurve(trans, curve, Bmat)
 -sum(Amat * Bmat)
 }
 #SANN seems to work for this, but is slow. Beware of finite differencing
 # - criterion is non-smooth! 
 optim(c(0,1), compcurve, method = "SANN", Bmat = Bmat2) -> output
 image(Bmat)
 contour(getcurve(output$par), add = T) 
```

结果：

![适合黑色，符合目标标准](../Images/26cc6505f41eee4c49b01f6f99594e42.png)

不会太破旧吧？

您可能不得不捏造光栅化的细节来解决其他问题。你可能想调整优化的完成方式。

一个“更聪明”的替代方法是注意，对于最佳解决方案，可能至少有一对顶点会重合。这可以为您提供更好的搜索策略。与曲线之间的区域相比，光栅化方案的优势在于它可能更灵活地处理不同的转换和非图形（特别是，第一条曲线中的垂直线是一个问题。）您可以潜在地避免光栅化适当的计算，但只是想想就让我头疼。

由于我们正在最大化标准，因此这是一种最大似然方法。奇怪的是，我认为实际上*不可能*使用正态错误将这个问题表述为最大似然问题，因为正态错误意味着基于 L2 的标准，众所周知，这*不会*给你精确的叠加。

# codeigniter - Codeigniter Parse 错误：语法错误，意外的 T_CLASS

> ID：10826628
> 
> 赞同：0
> 
> 时间：2012-05-31T02:14:09.757
> 
> 标签：codeigniter

我正在尝试一个简单的代码点火器 hello world 教程，但不断收到此错误并且不知道为什么。

> 解析错误：语法错误，第 3 行 C:\xampp\htdocs\loxxbylisa\application\controllers\helloworld.php 中的意外 T_CLASS

```
<? php

    class HelloWorld extend CI_Controller {

    public function index(){
            $this->load->view('helloworld');
        }

    }

?> 
```

我在 XAMPP 中运行它，视图文件夹中的 helloworld.php 只是文本“hello world”。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:26:44.627

现在唯一让我感到震惊的是你在你的开口之间有一个空间

```
class HelloWorld extends CI_Controller 
```

注意extend 末尾的“s”。应该是扩展。[http://php.net/manual/en/keyword.extends.php](http://php.net/manual/en/keyword.extends.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T03:45:23.863

请使用此代码，它将为您工作。在控制器中...您使用了错误的extend拼写...应该是extends

```
<?php

    class HelloWorld extends CI_Controller {

        public function index(){
            $this->load->view('helloworld');
        }

    }

?> 
```

在视图中创建一个名为 helloworld.php 的视图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-23T20:31:29.547

我在使用 Codeignitor 时遇到了类似的错误：

> 遇到未捕获的异常
> 类型：ParseError
> 消息：语法错误，意外的“类”（T_CLASS）

我的代码如下：

```
defined('BASEPATH') OR exit('No direct script access allowed')

class Migrate extends CI_Controller 
```

这里的问题是我应该用 ; 结束第一行。

因此，意外的 T_CLASS 可能是多个拼写错误的结果。始终检查您的代码！

# python - Python 电子邮件附件为空

> ID：10826632
> 
> 赞同：0
> 
> 时间：2012-05-31T02:14:42.347
> 
> 标签：python, email, attachment, email-attachments

我正在尝试使用 Python 2.7 发送带有附件的电子邮件。除了附件内容外，一切正常，附件内容到达电子邮件时为**0 K。**

编码有问题吗？

```
def sendMail(subject, text, *attachmentFilePaths):
    gmailUser = USER
    gmailPassword = PASSWORD
    recipient = RECIPIENT

    msg = MIMEMultipart()
    msg['From'] = gmailUser
    msg['To'] = recipient
    msg['Subject'] = subject
    msg.attach(MIMEText(text))

    for attachmentFilePath in attachmentFilePaths:
        msg.attach(getAttachment(attachmentFilePath))

    mailServer = smtplib.SMTP('smtp.gmail.com', 587)
    mailServer.ehlo()
    mailServer.starttls()
    mailServer.ehlo()
    mailServer.login(gmailUser, gmailPassword)
    mailServer.sendmail(gmailUser, recipient, msg.as_string())
    mailServer.close()

    print('Sent email to %s' % recipient)

def getAttachment(attachmentFilePath):
    contentType, encoding = mimetypes.guess_type(attachmentFilePath)

    if contentType is None or encoding is not None:
        contentType = 'application/octet-stream'
    mainType, subType = contentType.split('/', 1)
    file = open(attachmentFilePath, 'rb')

    if mainType == 'text':
        attachment = MIMEText(file.read())
    elif mainType == 'message':
        attachment = email.message_from_file(file)
    elif mainType == 'image':
        attachment = MIMEImage(file.read(),_subType=subType)
    elif mainType == 'audio':
        attachment = MIMEAudio(file.read(),_subType=subType)
    else:
        attachment = MIMEBase(mainType, subType)

    attachment.set_payload(file.read())
    encode_base64(attachment)
    file.close()
    attachment.add_header('Content-Disposition', 'attachment',   filename=os.path.basename(attachmentFilePath))
    return attachment 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T06:51:39.963

这是你的问题：

```
if mainType == 'text':
    attachment = MIMEText(file.read())                      # <- read file
elif mainType == 'message':
    attachment = email.message_from_file(file)              # <- read file
elif mainType == 'image':
    attachment = MIMEImage(file.read(),_subType=subType)    # <- read file
elif mainType == 'audio':
    attachment = MIMEAudio(file.read(),_subType=subType)    # <- read file
else:
    attachment = MIMEBase(mainType, subType)

attachment.set_payload(file.read())           # <- re-read file ! 
```

这意味着除了在中`else`您将始终用空字符串替换有效负载，因为该文件已被读取。

# c# - link.exe 的 /RELEASE 开关的 .NET 等效项是什么？

> ID：10826633
> 
> 赞同：0
> 
> 时间：2012-05-31T02:14:46.223
> 
> 标签：c#, .net

链接本机映像时，您指定 /RELEASE 以便 link.exe 在二进制文件上标记校验和，因此 windbg 不会抱怨

```
*** WARNING: Unable to verify checksum for foo.exe 
```

我如何为 .NET 程序做到这一点？我查看了 CSC.EXE、AL.EXE 中的选项，但找不到类似的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:21:49.557

您可以在构建后事件中使用[editbin.exe来实现相同的目的。](http://msdn.microsoft.com/en-us/library/tst6zb25%28v=vs.80%29.aspx)检查[此答案](https://stackoverflow.com/questions/5538477/stack-overflow-in-c-sharp-app-using-c-dll/5546869#5546869)以获取示例事件，请改用 /RELEASE 。

仅设备驱动程序需要它，因此这对于托管代码无关紧要。

# php - 如何在 MySQL TEXT 数据类型中搜索一个单词？

> ID：10826635
> 
> 赞同：1
> 
> 时间：2012-05-31T02:14:58.747
> 
> 标签：php, mysql

目前，我的“客户”表中有一个名为“camps”的 TEXT 字段，可以容纳多个单词。每个用户在字段内可以有 0 到大约 50 个单词（以空格分隔。）

我正在尝试搜索每一行的每个“camps”字段，以确定哪个用户在他们的“camps”字段中有某个单词。

例子：

用户 1 在其“营地”字段中有：“Camp1 Camp2 Camp3 Camp7”。

用户 2 在其“营地”字段中有：“营地 2”。

用户 3 在“营地”字段中有：“”。

假设我搜索所有有 Camp2 的人，我希望它确定 User1 和 User2 在他们的“camps”字段中有 Camp2。

这是我到目前为止所拥有的：

```
$camp = $_POST['camp'];

$customers = "SELECT * FROM customers WHERE camps LIKE '%$camp'";

$result = mysql_query($customers); 
```

目前，它似乎只检测“camps”字段内的确切值。如果我通过它“Camp2”，则只有用户 2 会显示。我想让用户 1 和用户 2 显示。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:22:32.097

您缺少另一个通配符。请记住，您还需要匹配在搜索词之后有其他文本的内容。找到 User2 是因为“Camp2”是 camps 字段中的*最后*一项。

```
$customers = "SELECT * FROM customers WHERE camps LIKE '%$camp%'"; 
```

...或者如果你想让它更容易阅读：

```
$customers = "SELECT * FROM customers WHERE camps LIKE '%" . $camp. "%'"; 
```

...甚至可能：

```
$sqlfmt = "SELECT * FROM customers WHERE camps LIKE '%%%s%%'";
...
$customers = sprintf($sqlfmt, $camp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:56:38.773

您可以在字符串末尾使用另一个通配符来注意您正在搜索具有“camp”的任何内容，例如：

```
$customers = "SELECT * FROM customers WHERE camps LIKE '%mysql_real_escape_string($camp)%'"; 
```

或者，如果你想做更复杂的事情，你可以使用[REGEXP](http://dev.mysql.com/doc/refman/5.0/en/regexp.html#operator_regexp)。（未经测试）

```
$customers = "SELECT * FROM customers WHERE camps REGEXP '^(mysql_real_escape_string($camp))$"; 
```

阅读有关[模式匹配](http://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html)的 MySql 文档以获取更多信息

*obs*：注意使用 mysql_real_escape_string 就像[Okonomiyaki3000](https://stackoverflow.com/users/275019/okonomiyaki3000)说的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T02:35:45.347

您的 where 子句应该是：

```
where camps like '%Camp2%' 
```

您可以通过连接替换`Camp2`为您的变量。

# c - 为什么这个缓冲输出和内存分配的例子有缺陷？

> ID：10826636
> 
> 赞同：2
> 
> 时间：2012-05-31T02:15:00.310
> 
> 标签：c

我正在查看[“C 陷阱和陷阱”](https://rads.stackoverflow.com/amzn/click/com/0201179288) ( [PDF](http://www.connectiter.com/c%20books/C%20Traps%20and%20Pitfalls.pdf) ) 第 5 章中给出的示例：

```
#include <stdio.h>

main()
{
    int c;

    char buf[BUFSIZ];
    setbuf(stdout, buf);

    while ((c = getchar()) != EOF)
        putchar(c);
} 
```

> 不幸的是，这个程序是错误的，原因很微妙。要查看问题出在哪里，请询问最后一次刷新缓冲区的时间。
> 
> 答：在主程序完成后，**作为库在将控制权交还给操作系统之前所做的清理工作的一部分。但是到那时，缓冲区已经被释放了！**

main 只是一个必须清理堆栈和变量的函数。但这意味着什么：缓冲区已被释放？

我觉得很难理解。谁能详细解释一下？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:21:33.357

这意味着缓冲区只能从它进入范围的地方（定义它的地方）到它超出范围的地方在 final 处可用`}`。

之后对缓冲区的任何使用都是未定义的行为。标准输出的刷新必然会使用该缓冲区，因为那是它缓冲输出字符的地方。

因此出现了问题 - 在刷新发生之前，缓冲区所在的内存区域可能已被重新使用（取决于 C 运行时环境关闭代码的复杂程度）。

现在它似乎可以正常工作，如果它使用退出后未用于其他任何东西的堆栈的一部分，但它*可能*`main`无法正常工作的事实使它成为一个好主意。

 *尽管您引用的那本书已经过时了，但即使在当前的 C11 标准中，这*仍然是一个问题。*在详述`setbuf`和的部分中`setvbuf`：

> 缓冲区的生命周期必须至少与打开的流一样长，因此应在块退出时释放具有自动存储持续时间的缓冲区之前关闭流。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:36:53.663

你在堆栈上分配一个缓冲区，然后调用说“从现在开始[`setbuf`](http://www.kernel.org/doc/man-pages/online/pages/man3/setbuf.3.html)使用这个缓冲区”。`stdout`

稍后，当`main`返回时，它的堆栈帧（包括 的内存`buf`）从堆栈中删除——但`stdout`仍在使用该地址的内存，因为这是您告诉它要做的。问题是，内存现在可以被其他人重用——你的 C 运行时的关闭代码、中断等等——并且在 C 运行时开始刷新`stdout`缓冲区之前，内存很可能会被其他一些数据覆盖。

（就个人而言，我不会使用术语“释放”来指代返回`buf`时会发生什么`main`——“释放”一词通常指的是堆分配，而不是堆栈分配。但是无论你怎么称呼它，当`main`返回时，`buf`内存就是不再是你可以放弃的。）

有关该问题的更生动的说明，请参阅[Eric Lippert](https://stackoverflow.com/a/6445794/87399)关于在其范围之外使用局部变量的内存的答案。这与您的示例中的问题相同。*

# php - 我们可以在桌面浏览器上提供移动网站体验吗？

> ID：10826640
> 
> 赞同：1
> 
> 时间：2012-05-31T02:15:22.673
> 
> 标签：php, html, browser, curl, user-agent

是否可以在桌面浏览器上显示移动网站（具有完整功能）？

如果某个网站（例如 yahoo 或 google）检测到用户代理来决定重定向到哪里，我想强制它向我显示移动版本。基本上在桌面浏览器上，用户需要查看移动网站的外观。我尝试使用 php-curl 的用户代理，但它只加载第一页，而且也没有图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:19:10.227

可以使用附加组件。对于 Firefox，[`User Agent Switcher`](https://addons.mozilla.org/en-US/firefox/addon/user-agent-switcher/)我目前正在使用。对于 Safari，您可以直接在 Developer 菜单中切换 User-Agent。

SuperUser 上有一个[类似的问题](https://superuser.com/questions/98798/how-do-i-change-firefoxs-user-agent-via-aboutconfig)，描述了如何在 Firefox 中通过 about:config 更改用户代理。可能是唯一不需要安装附加组件或额外软件的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:17:42.143

就个人而言，我会将移动流量重定向到子域，例如`m.example.com`. 然后，您可以`m.example.com`直接在桌面浏览器中访问，您将看到移动设备的外观。

# c - 外部中断程序会不会太长而无法正常工作？

> ID：10826647
> 
> 赞同：1
> 
> 时间：2012-05-31T02:16:15.450
> 
> 标签：c, embedded, interrupt, keil

我有一个关于外部中断程序的问题要问。如果我使用 DS89C450 的 INT1（外部中断 1 设置为下降沿）并且我的外部中断程序很长，它会正常工作吗？或者会有什么问题吗？我正在使用 Keil 嵌入式 C。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T16:56:32.503

在没有 RTOS 的情况下执行此操作的另一种方法是使用事件标志和状态机。您的程序可以用图表表示为在调用特定事件时转换的离散状态。例如，在这张图中，我使用 google 发现：

![在此处输入图像描述](../Images/0b44b8396aa9dc5f5bffafce6009c034.png)

按钮单击是一个事件；例如，可以从您的 INT1 中断触发的东西。然后，您可以将以下循环置于前台：

```
#define STATE_POWER_OFF   1
#define STATE_POWER_ON    2

#define EVENT_BUTTON_CLICK  0x01

volatile unsigned char bEventFlags = 0;
unsigned char bState = STATE_POWER_OFF;

unsigned char getEventFlags( void ) ;

int main(void)
{
    for(;;)
    {
        unsigned char flags = getEventflags() ;

        if (flags != 0)
        { 
           switch (bState)
           {
                case STATE_POWER_OFF:
                    if (flags & EVENT_BUTTON_CLICK)
                    {
                        // Do something
                        bState = STATE_POWER_ON;
                    }
                    break;

                case STATE_POWER_ON:
                    if (flags & EVENT_BUTTON_CLICK)
                    {
                        // Do something
                        bState = STATE_POWER_OFF;
                    }
                    break;
            }
        }
    }
}

unsigned char getEventFlags( void )
{
    unsigned char flags = 0 ;

    // Get copy of flags in critical section and clear down
    _disable_interrupts() ;
    flags = bEventFlags ;
    bEventFlags = 0 ;
    _enable_interrupts ;

    return flags ;
} 
```

然后你的 ISR 会很短：

```
void INT1_ISR(void)
{
    bEventFlags |= EVENT_BUTTON_CLICK;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T16:44:09.440

从某种意义上说，中断处理程序无论如何都会运行完成，不，它不能“太长”。然而，在处理中断时，根据中断架构，要么不运行其他任何东西，要么只运行更高优先级的中断。这样做的后果是您可能会错过实时截止日期。

您甚至可能会错过正在处理的中断源的后续中断。在某些架构上，如果在处理期间未禁用中断，则可能会导致重入，如果处理程序无法重入或堆栈不足，则可能会导致问题。

因此，它能否工作的问题的答案将完全取决于您的应用程序、它有哪些实时截止日期以及可能发生的其他中断源。这样的中断处理程序是否是好的设计的答案当然是*否定*的。即使它现在可以工作，它在其他应用程序中通常也不会有用，并且可能会在维护时中断。

更好的解决方案是在部件上部署一个简单的 RTOS 调度程序内核，并让中断处理程序以适当的优先级发出任务信号。MCS-51 架构可以有效地实现调度器，因为它有 8 个重复的寄存器组 - 对于多达 8 个任务，上下文切换可以非常快。

# c++ - 为固定大小的多索引多态容器提升多索引

> ID：10826650
> 
> 赞同：0
> 
> 时间：2012-05-31T02:16:45.013
> 
> 标签：c++, boost, lru, boost-multi-index

仍在深入研究 C++/boost，因此欢迎任何评论/反馈。

我正在玩 boost::unordered_maps 并使用形状创建了一个多态示例，大约在我（主要）围绕它的时候，我偶然发现了来自 boost multi_index 的 mru 示例。 [http://www.boost.org/doc/libs/1_46_1/libs/multi_index/example/serialization.cpp](http://www.boost.org/doc/libs/1_46_1/libs/multi_index/example/serialization.cpp)

那时我想。嗯，一个固定大小的多索引多态容器，它将丢弃基于 LRU 的值，这听起来很疯狂，无法实现。

```
 #include <boost/multi_index_container.hpp>
    #include <boost/multi_index/hashed_index.hpp>
    #include <boost/multi_index/identity.hpp>
    #include <boost/multi_index/sequenced_index.hpp>
    #include <boost/shared_ptr.hpp>
    #include <boost/tuple/tuple.hpp>
    #include "boost/tuple/tuple_comparison.hpp"

    enum shape_returns {
        SHAPE_ERROR = -1,
        SHAPE_OK = 0
    };

    // coordinates
    typedef boost::tuples::tuple<int, int, int> ShapeKey;

    class Shape {
    public:
        Shape() : pos() {}
        ~Shape() {}

        virtual int draw() { return SHAPE_ERROR; }

        ShapeKey pos;
    };
    typedef boost::shared_ptr<Shape> Shape_ptr;

    class Circle : public Shape {
    public:
        Circle() {}
        ~Circle() {}

        int radius;

        virtual int draw() { /* draw stuff */ return SHAPE_OK; }
    };
    typedef boost::shared_ptr<Circle> Circle_ptr;

    class Square : public Shape {
    public:
        Square() {}
        ~Square() {}

        int len;

        virtual int draw() { /* draw stuff */ return SHAPE_OK; }
    };
    typedef boost::shared_ptr<Square> Square_ptr;

    using namespace boost::multi_index;

    // multi index tags
    struct seq  {};
    struct hash {};

    class ShapesLRU {
        typedef boost::multi_index::multi_index_container<
          Shape_ptr,
          boost::multi_index::indexed_by<
            boost::multi_index::sequenced<boost::multi_index::tag<seq> >,
            boost::multi_index::hashed_unique<
              boost::multi_index::tag<hash>,
              boost::multi_index::identity<Shape_ptr>
            >
          >
        > shapes_list;

    public:
        typedef typename shapes_list::iterator iterator;
        typedef typename boost::multi_index::index<shapes_list, seq>::type seq_index;
        typedef typename boost::multi_index::index<shapes_list, hash>::type hashed_index;

        ShapesLRU (std::size_t max) : max_shapes(max) {}
        ~ShapesLRU() {}

        void insert(const Shape_ptr item)
        {
            std::pair<typename shapes_list::iterator, bool> ret = shapes.push_front(item);

            if (!ret.second) {
                // new item may be different
                erase(item->pos);
                ret = shapes.push_front(item);
            } else if (shapes.size() > max_shapes) {
                shapes.pop_back();
            }
        }

        typename shapes_list::iterator begin() { return shapes.begin(); }
        typename shapes_list::iterator end() { return shapes.end(); }

        typename hashed_index::iterator hash_begin() { return shapes.get<hash>().begin(); }
        typename hashed_index::iterator hash_end() { return shapes.get<hash>().end(); }

        typename hashed_index::iterator find(const ShapeKey &key)
        {
            Shape_ptr tmp(new Shape());
            tmp->pos = key;

            // XXX why compiler error w/o "using namespace boost::multi_index"
            return shapes.get<hash>().find(tmp);
        }

        void erase(const ShapeKey &key)
        {
            typename hashed_index::iterator itr = find(key);
            // XXX why compiler error w/o "using namespace boost::multi_index"
            shapes.get<hash>().erase(itr);
        }

    private:
        // The multi-indexed data store
        shapes_list shapes;

        // The size of the data store
        std::size_t max_shapes;
    };

    inline std::size_t
    hash_value(const Shape_ptr shape)
    {
        std::size_t seed = 0;

        boost::hash_combine(seed, shape->pos.get<0>());
        boost::hash_combine(seed, shape->pos.get<1>());
        boost::hash_combine(seed, shape->pos.get<2>());

        return seed;
    }

    int
    main()
    {
        ShapesLRU shapes(10);

        Circle_ptr cptr1(new Circle());
        ShapeKey pos1(1, 1, 1);
        cptr1->pos = pos1;
        cptr1->radius = 1;

        Circle_ptr cptr2(new Circle());
        ShapeKey pos2(2, 2, 2);
        cptr2->radius = 2;
        cptr2->pos = pos2;

        shapes.insert(cptr1);

        ShapesLRU::hashed_index::iterator itr = shapes.find(pos1);

        return 0;
    } 
```

在完成了很多工作之后，我仍然有以下问题。

1.  在 insert() 中，有没有办法从序列迭代器中获取 hashed_unique 迭代器，以便我可以直接调用擦除？

2.  有没有更好的方法实现查找？如果我可以只使用键来进行类似 boost::unordered_map 的查找，而不是仅仅为了查找而创建一个虚拟形状，那就太好了。

3.  get<> 的正确路径是什么（请参阅代码中的 XXX 注释）我尝试了所有正确的方法，然后开始尝试随机废话，但没有任何结果。

4.  我真的很想要一个 [] 运算符，但我认为这是一个方法... shape[cptr1->pos] = cptr1;

5.  如何从我的 hash_index::iterator 中获取项目（或一般意义上的），打印它当然没有帮助......

p itr $1 = {, std::allocator > > >, boost::multi_index::detail::bucket_array > > >, boost::shared_ptr, long, boost::shared_ptr const*, boost::shared_ptr const&>> = {, std::allocator > > >, boost::multi_index::detail::bucket_array > > >, boost::shared_ptr const*, boost::iterator, long, boost::shared_ptr const*, boost::shared_ptr const& > >> = {, std::allocator > > >, boost::multi_index::detail::bucket_array > > >, boost::shared_ptr const*, boost::iterator, long, boost::shared_ptr const*, boost ::shared_ptr const&> >> = {, std::allocator > > >, boost::multi_index::detail::bucket_array > > >, boost::incrementable, std::allocator > > >, boost::multi_index: :detail::bucket_array > > >, boost::dereferenceable, std::allocator >> >, boost::multi_index::detail::bucket_array > > >, boost::shared_ptr const*, boost::iterator, long, boost::shared_ptr const*, boost::shared_ptr const&> > > >> = { , std::allocator > > >, boost::multi_index::detail::bucket_array > > >, boost::dereferenceable, std::allocator > > >, boost::multi_index::detail::bucket_array > > >, boost::shared_ptr const*, boost::iterator, long, boost::shared_ptr const*, boost::shared_ptr const&> > >> = {, std::allocator >> >, boost::multi_index::detail:: bucket_array > > >, boost::shared_ptr const*, boost::iterator, long, boost::shared_ptr const*, boost::shared_ptr const&> >> = {, long, boost::shared_ptr const*, boost::shared_ptr const&>> = {, long, boost::shared_ptr const*, boost::shared_ptr const&>> = {, long, boost::shared_ptr const*, boost::shared_ptr const&>> = {}, }, }, }, }, }, }, }, }, node = 0x60a010, buckets = 0x7ffffffdd88 }

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T06:13:05.400

> 在 insert() 中，有没有办法从序列迭代器中获取 hashed_unique 迭代器，以便我可以直接调用擦除？

请参阅[迭代器投影](http://www.boost.org/libs/multi_index/doc/tutorial/basics.html#projection)。

> 有没有更好的方法实现查找？如果我可以只使用键来进行类似 boost::unordered_map 的查找，而不是仅仅为了查找而创建一个虚拟形状，那就太好了。

首先，我认为您当前的实现是错误的：您的哈希索引基于`Shape_ptr`相等，这不是您所追求的——您希望基于`Shape::ShapeKey`. 为了得到这个，只需将索引重新定义为

```
boost::multi_index::hashed_unique<
  boost::multi_index::tag<hash>,
  boost::multi_index::member<Shape,ShapeKey,&Shape::pos>
> 
```

为此，您必须为 实现散列`ShapeKey`，作为练习:-) 现在实现`find`就像

```
hashed_index::iterator find(const ShapeKey &key)
{
    return shapes.get<hash>().find(key);
} 
```

> get<> 的正确路径是什么（请参阅代码中的 XXX 注释）我尝试了所有正确的方法，然后开始尝试随机废话，但没有任何结果。

我不明白为什么你的语法不起作用。它应该。

> 我真的很想要一个 [] 运算符，但我认为这是一个方法... shape[cptr1->pos] = cptr1;

Boost.MultiIndex 中的索引是在`std::set`and`std::unordered_set`而不是`std::map`and之后建模`std::unordered_map`的（出于根本原因，我们不需要在这里讨论。）但是考虑到 a`map<T,Q>`几乎是 a `set<mutable_pair<T,Q>>`，其中`mutable_pair`是一个对结构，其第二个成员是`mutable`。您可以利用这种等效性来使用 Boost.MultiIndex 构建类似地图的结构。

> 如何从我的 hash_index::iterator 中获取项目（或一般意义上的），打印它当然没有帮助......

“打印”是什么意思？

# string - 何时在 Go 中使用 []byte 或 string？

> ID：10826651
> 
> 赞同：82
> 
> 时间：2012-05-31T02:16:51.417
> 
> 标签：string, bytearray, go

经常在编写 Go 应用程序时，我发现自己可以选择使用`[]byte`或`string`. 除了明显的可变性之外`[]byte`，我如何决定使用哪一个？

我有几个用例作为示例：

1.  一个函数返回一个新的`[]byte`. 既然切片容量是固定的，那有什么理由不返回字符串呢？
2.  `[]byte`没有`string`默认打印得那么好，所以我经常发现自己`string`为了记录目的而强制转换。它应该一直是一个`string`吗？
3.  前置时`[]byte`，总是会创建一个新的底层数组。如果要添加的数据是常量，为什么不应该是`string`?

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-06-09T23:44:24.713

我的建议是在处理文本时默认使用字符串。但如果以下条件之一适用，请改用 []byte：

*   []byte 的可变性将显着减少所需的分配数量。

*   您正在处理使用 []byte 的 API，避免转换为字符串将简化您的代码。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-08T12:51:00.263

我的感觉是，在 Go 中，比在任何其他非 ML 风格的语言中，类型更用于传达意义和预期用途。因此，弄清楚要使用哪种类型的最佳方法是问自己数据*是*什么。

字符串代表文本。只是文字。编码不是您必须担心的事情，并且所有操作都在逐个字符的基础上进行，无论“字符”实际上是什么。

数组表示二进制数据或该数据的特定编码。`[]byte`意味着数据要么只是一个字节流，要么是一个单字节字符流。`[]int16`表示整数流或两个字节字符的流。

鉴于几乎所有处理字节的东西也有处理字符串的函数，反之亦然，我建议不要问你需要对数据做什么，而是问数据代表什么。然后在找出瓶颈后进行优化。

编辑：[这篇文章](https://groups.google.com/forum/?fromgroups#!topic/golang-nuts/84GCvDBhpbg)是我得到使用类型转换来分解字符串的基本原理的地方。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-05-31T11:18:12.650

1.  一个区别是返回的`[]byte`数据可能被重用以保存另一个/新数据（没有新的内存分配），而 `string`不能。另一个是，至少在 gc 实现中，`string`是一个比`[]byte`. 当有很多这样的项目时，可以用来节省一些内存。

2.  没有必要为日志设置一个`[]byte`to 。`string`典型的“文本”动词，如`%s`，同样`%q`适用于`string`和`[]byte`表达。在另一个方向上，例如`%x`或也是如此`% 02x`。

3.  取决于为什么要执行连接，以及结果是否要再次与/某物/某处其他地方组合。如果是这样，那么`[]byte`可能会表现得更好。

# iphone - iPhone 应用程序是自我控制的。为什么？

> ID：10826655
> 
> 赞同：0
> 
> 时间：2012-05-31T02:17:42.440
> 
> 标签：iphone, objective-c, mpmovieplayercontroller, ibaction

我有一个简单的 iPhone 应用程序。但它在没有 IBAction 的情况下控制自己。代码的可疑部分是这样的。

```
[[NSNotificationCenter defaultCenter] addObserver:self 
                                         selector:@selector(moviePlayBackDidFinish:) 
                                             name:MPMoviePlayerPlaybackDidFinishNotification 
                                           object:mMoviePlayer]; 
```

比 iOS 4.2 更早的版本，该应用程序按我的预期运行。但是 iOS 4.2 和下一个版本，选择器函数被调用而不接触或任何其他 IBAction。那为什么叫它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:38:43.677

您的代码正在做的是将观察者添加到系统的通知中心。因此，当手机收到通知时，您的代码会自动使用该对象执行选择器。

`NSNotificationCenter`可能发生的事情是iOS 4.2 中发送的通知类型发生了变化

# django - 在 https 下提供的 Django 管理静态文件

> ID：10826656
> 
> 赞同：3
> 
> 时间：2012-05-31T02:17:42.710
> 
> 标签：django, file, static, amazon-s3, admin

最近我将我的 Django 项目配置为使用 Amazon S3。除 /admin/ 外，一切正常。我在控制面板中看不到任何 .css 或图像。当我从浏览器检查代码时，我可以看到打印的静态文件 url 类似于“https://blablabla”。

从 https 协议，我必须同意一个证书才能显示请求的对象，因此在 /admin/ 中无法显示任何这些文件。如果我输入了相同的 url 但在 http 下我可以看到该文件而无需同意任何内容。

/admin/ 如何在 http 而不是 https 下调用静态文件？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-12T13:24:45.330

If you set:

AWS_S3_SECURE_URLS = False

in your settings.py then, all the URLS to your static files use http: instead of https:

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-23T00:31:33.190

请设置`STATIC_URL = 'https://blbla.blabla.s3.amazonaws.com/`在`settings.py`

# python - 如何在没有 shell=True 的情况下使用 subprocess.call

> ID：10826668
> 
> 赞同：2
> 
> 时间：2012-05-31T02:19:20.930
> 
> 标签：python, windows

[文档](http://docs.python.org/library/subprocess.html#subprocess.call)建议不要使用`subprocess.call`with `shell=True`，但是当我尝试做一些简单的事情时

```
call(['convert']) 
```

我收到一个错误：

> 必须指定文件系统

当我通过 cmd.exe 运行相同的命令时，我得到

```
C:\Users\Mark>convert
Version: ImageMagick 6.7.3-6 2011-11-10 Q16 http://www.imagemagick.org
... 
```

等等，即它实际上运行。

那么在`call`做什么呢？为什么要找文件？

它是否需要 .exe 的完整路径？如果是这样，我宁愿不这样做，因为我不知道所有 .exe 文件的位置。

* * *

只需使用程序的完整文件路径（ ）尝试过它就可以了`call(['C:/imagemagick/convert.exe'])`。但是问题仍然存在……如果没有完整路径，您将如何做到这一点？只是让它从工作目录执行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T02:24:43.703

我相信`dir`是 cmd.com 的内置功能，而不是独立程序。您将需要 shell=True 或提供类似功能的程序`dir`（如 unixtools 中的 ls.exe 程序）。

为您的编辑更新：您正在处理的内容听起来与此处描述的已知问题/错误完全一样：http: [//bugs.python.org/issue8557](http://bugs.python.org/issue8557)和此处的[python 子进程 Popen 环境路径？](https://stackoverflow.com/questions/5658622/python-subprocess-popen-environment-path)

在 win32 下 subprocess.call的行为似乎`shell=False`很奇怪。似乎您至少需要使用`convert.exe`not`convert`并且需要[自己](http://bugs.python.org/issue8557#msg105867)[搜索`PATH`](http://bugs.python.org/issue8557#msg105867)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:25:10.593

`dir.exe`通过在 shell 中尝试可以更好地理解这里的问题：

```
C:\Users\lvc>dir.exe
 Volume in drive C has no label.
 Volume Serial Number is 4B8C-511A

 Directory of C:\Users\lvc

File Not Found 
```

This means that `dir` is not an executable anywhere in your `%PATH%` - rather, it is a command that the shell knows how to do without looking up a program for it. That means it will never, by definition, work with `shell=False`.

# spring - 如何使用 Maven 父 pom/子 pom 目录结构指向 Spring 资源？

> ID：10826673
> 
> 赞同：1
> 
> 时间：2012-05-31T02:20:31.583
> 
> 标签：spring, maven, classpath

我有一个 Maven 父 pom 和 2 个子项目。我正在使用 Spring，并且无法让类路径从 child_project_2 指向 child_project_1 中的资源。

```
parent
  child_1
    - src
      - main
        - java
          - com
            - company
              - package1
                  - app1.java
      - resources
          -config.xml

  child_2
    - src
      - main
        - java
          - com
            - company
              - package2
                  - app2.java
        - resources 
```

当我运行 app1.java 时，我使用以下命令加载 config.xml 文件：

ApplicationContext ctx = new GenericXmlApplicationContext("src/main/resources/config.xml");

但是，当我运行 app2.java 并需要加载 config.xml 时，我似乎无法正确获取类路径。使用这个 Maven 目录结构，我所有使用 Spring 的子项目如何指向位于 child_1/src/main/resources/config.xml 的同一个 config.xml 文件？

我已经在本地机器上尝试了绝对路径。我已经尝试了从 child_2 到 parent 并返回到 config.xml 的相对路径，以及从 child_2/src/main/resources 到 parent 并返回到 config.xml 的相对路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:57:56.990

src/main/resources 仅用于保存源资源。构建 JAR 时，该目录中的文件将复制到 JAR 中，并与构建 src/main/java 文件的位置一起。

如果 child_1 和 child_2 项目的 JAR 都在您的类路径中，您的代码应如下所示：

```
ApplicationContext ctx = new GenericXmlApplicationContext("config.xml"); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-31T02:53:26.780

编辑 - 根据您的评论，另外：项目 1 需要是项目 2 的依赖项（或创建一个公共模块并让每个模块都依赖它）。

再次编辑 - 从网址中删除 src/main/resources。

您正在使用的构造函数的参数是资源。尝试

```
ApplicationContext ctx = 
    new GenericXmlApplicationContext("classpath:config.xml"); 
```

或者

```
ApplicationContext ctx = 
    new ClassPathXmlApplicationContext("config.xml"); 
```

我总是使用后者，这可能是你想要的。

使用 maven， src/main/resources 中的内容将放在类路径中。

有关 Spring 资源的更多信息，即使现在基本上无关紧要： [http ://www.mkyong.com/spring/spring-resource-loader-with-getresource-example/](http://www.mkyong.com/spring/spring-resource-loader-with-getresource-example/)

顺便说一句 - 你应该在你的 IDE 中包含 spring 的源代码并浏览源代码，这就是我所做的，可以很容易地弄清楚发生了什么，你可以通过调试器运行。

如果您使用 IDEA 和 Maven，这在 IDE 中自动可用，只需从 maven 窗口中选择“下载源”。（或浏览IDEA中的类，并在打开类文件时单击“dwonload sources”）

# c++ - 指向 C++ 中的成员函数的指针

> ID：10826677
> 
> 赞同：4
> 
> 时间：2012-05-31T02:21:32.107
> 
> 标签：c++, class, pointers, member-functions

这实际上是一个下棋程序，但代码太长，无法在此处发布，因此我将使用一个更简单的无关示例：

假设我有一个这样的对象：

```
class A{
    int x1;
    int x2;
public:
    int Average(){ return (x1+x2)/2; }
}; 
```

我想要一个名为 AveragesList 的向量，它存储每个对象的所有 x1 和 x2 值的所有平均值（或指向它们的指针）。所以我试着这样做：

```
vector<int>* AveragesList;

class A{
    int x1;
    int x2;
public:
    int Average(){ return (x1+x2)/2; }
    A(){ AveragesList.push_back(this->Average); } //trying to add pointer to member function Average() to AveragesList
}; 
```

但是当我尝试这个时，我收到一条消息说“指向绑定函数的指针只能用于调用函数”。有解决办法吗？我不想简单地将 x1 和 x2 的平均值放在 AveragesList 中，因为如果 x1 或 x2 发生变化，AveragesList 中的值不会。另外，我的书说不要在 C++ 类中使用公共变量，所以我不确定是否应该使用一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T02:37:08.820

在 C++11 之前，在 C++ 中没有内置的方法来处理闭包，因此在不使用 boost 等库的情况下解决问题的最简单方法如下：定义一个名为 的整数成员变量`average`，除了你的`x1`和`x2`变量。创建对象时将平均值设置为正确的值，并在每次更改`x1`或`x2`更改时更新它。将指针存储在列表中，并使用它来访问平均值。

这不如即时计算结果。如果您使用的是 C++11，则可以使用更好的解决方案：

```
#include <iostream>
#include <vector>
#include <functional>

class A{
    int x1;
    int x2;
public:
    A(int _x1, int _x2) : x1(_x1), x2(_x2) {}
    int Average(){ return (x1+x2)/2; }
    void setX1(int _x1) { x1 = _x1; }
    void setX2(int _x2) { x2 = _x2; }
};

using namespace std;

int main() {
    vector<std::function<int()>> v;
    A a1(1, 5);
    A a2(2, 8);
    v.push_back([&]{return a1.Average();});
    v.push_back([&]{return a2.Average();});
    for (int i = 0 ; i != v.size() ; i++) {
        cout << v[i]() << endl;
    }
    a1.setX1(7);
    a2.setX2(32);
    for (int i = 0 ; i != v.size() ; i++) {
        cout << v[i]() << endl;
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:32:20.980

如果您不想存储“平均”的当前值......那么为什么不存储对“A”的引用呢？

例子：

```
Class A{
    int x1;
    int x2;
public:
    A (int x1, int x2) { this->x1 = x1; this->x2 = x2; }
    int Average(){ return (x1+x2)/2 }
};

...

int
main (int argc, char *argv[])
{
  vector<A> averagesList;
  averagesList.push_back (new A(3, 4));
  ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T02:41:21.207

要执行您想要执行的操作（我猜），您还需要存储将用于调用函数的对象的指针：

```
#include <vector>
#include <iostream>

class A {
  int x1,x2;
public:
  int Average(){ return (x1+x2)/2; }
  A(int a, int b);
};

std::vector< A* > objectVec;
std::vector< int (A::*)() > functionPtrVec;

A::A(int a, int b):
  x1(a), x2(b) {
  objectVec.push_back(this);
  functionPtrVec.push_back(& A::Average);
}

int main() {
  A a1(1,3);
  A a2(10,20);

  for (int k=0; k<objectVec.size(); k++) {
    int (A::* memberFuncPtr)() = functionPtrVec[k];
    A*object = objectVec[k];
    std::cout << (object->*memberFuncPtr)() << std::endl;
  }
  return 0;
} 
```

您可以使用 a`pair`将它们存储在同一个 中`vector`，或者定义您自己的成员仿函数类来存储对象、成员函数指针并具有`()`运算符。

HTH。

# java - 如何访问 try-catch 中的变量？

> ID：10826681
> 
> 赞同：0
> 
> 时间：2012-05-31T02:21:58.273
> 
> 标签：java, android, json

我在做类似的事情

```
JSONArray json = uf.getAllRows();
(int x = 0; x <= json.length(); x++) {
JSONObject jo = json.getJSONObject(x); //Eclipse is suggesting that use try-catch here.

String name = jo.getString("username");
mainll[x] = new LinearLayout(this);
mainll[x].setId(x);
mainll[x].setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,   LayoutParams.WRAP_CONTENT));
mainll[x].setGravity(Gravity.CENTER);
.
.
.
.
} 
```

如果我使用 try catch ，则以下行无法识别“jo”：

```
String name = jo.getString("username"); 
```

谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T02:25:56.803

像这样做：

```
JSONObject jo;
try {
    jo = json.getJSONObject(x);
} catch (...) {
    jo = null; // or other error handling
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T02:26:03.237

只是一个简单的解决方案，您可以在 try..catch 块之外声明您的变量，以便您能够访问它。

例如，

```
String myVariable = "";

try
{
     .
     .
     .
     myVariable = "Some Assignment"; 
}
catch ( Exception e ) { } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T02:26:03.153

把所有东西都包起来

```
try{
  JSONArray json = uf.getAllRows();
  (int x = 0; x <= json.length(); x++) {
  JSONObject jo = json.getJSONObject(x); //Eclipse is suggesting that use try-catch here.

  String name = jo.getString("username");
  mainll[x] = new LinearLayout(this);
  mainll[x].setId(x);
  mainll[x].setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
  mainll[x].setGravity(Gravity.CENTER);
}
catch(Exception e){} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T02:29:25.450

您必须在外部声明您的**jo**变量`try/catch`：

```
String name;
try{

String name = jo.getString("username");
mainll[x] = new LinearLayout(this);
mainll[x].setId(x);
mainll[x].setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,   LayoutParams.WRAP_CONTENT));
mainll[x].setGravity(Gravity.CENTER);
}
catch(Exception ex)
{
 ///
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-31T05:00:48.563

```
JSONArray json = uf.getAllRows();
JSONObject jo = null;
String name = "";

(int x = 0; x <= json.length(); x++) {
   try{
     jo = json.getJSONObject(x); //Eclipse is suggesting that use try-catch here.
   }catch(Exception ex){}

   name = jo.getString("username");
   mainll[x] = new LinearLayout(this);
   mainll[x].setId(x);
   mainll[x].setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT));
   mainll[x].setGravity(Gravity.CENTER);
} 
```

# signal-processing - 检测歌曲中人声的开始位置？

> ID：10826683
> 
> 赞同：14
> 
> 时间：2012-05-31T02:22:01.157
> 
> 标签：signal-processing, audio

检测歌曲中人声从哪里开始的最佳方法是什么？我只需要人声的开始时间。不需要极高的精度。速度更重要。

非常感谢任何有关论文或算法的线索（如果存在）。同时寻找关于哪种框架/语言最适合此的建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T20:16:54.493

***剧透：答案不在下面***

因为我打算做类似的事情，所以我自己对这个主题做了一些研究，发现有一些精确的数字技术可以做到这一点。

我将列出参考资料，让您作为读者来决定这是否是正确的方法。这一切都与人声音频特征提取有关，并在音频数据中找到人声特征。

您可以从这里开始，但它确实不会导致任何地方，但可能有助于了解您的兴趣:)

[http://en.wikipedia.org/wiki/Voice_activity_detection](http://en.wikipedia.org/wiki/Voice_activity_detection)

然后，一些关于说话人识别的文章：

在这里，您需要了解有关`mel frequency cepstral coefficients`（MFCC）特征提取的入门知识。

[http://www.speaker-recognition.org/navAlg.html](http://www.speaker-recognition.org/navAlg.html)

然后，例如，这个：

[http://www.iccce.co.in/Papers/ICCCECE358.pdf](http://www.iccce.co.in/Papers/ICCCECE358.pdf)

我知道它们都不会直接解决您的问题，但至少您将能够掌握您将要处理的怪物的大小。

编辑：框架

我将 c# 用于与此相关的东西，起初我使用自己的 fft 算法，然后转移到使用英特尔数学库的 ILNumerics 库，后来用 fftw 替换了所有这些。

[http://ilnumerics.net/](http://ilnumerics.net/)（嗯，一次免费）

[http://software.intel.com/en-us/articles/intel-mkl/](http://software.intel.com/en-us/articles/intel-mkl/) 英特尔数学内核

[http://www.fftw.org/](http://www.fftw.org/)（一个简单的网页，但性能很残酷）

编辑：新的fft引擎

由于我正在将我的一些代码移植到 android，因此我与一个做了一些被认为不可能的事情的人获得了很好的工作经验 - FFT 库甚至比 FFTW 更快：[FFTS](https://github.com/anthonix/ffts "FFTS")。我对他的魔力的理解是有限的，但他将 codelet 用于各种处理器架构，并且优于所有的库。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-31T20:24:53.007

检查信号功率对流行音乐没有帮助。这是因为当代流行音乐是高度压缩的。这意味着在制作过程的多个阶段都应用了音频电平压缩器，以使歌曲看起来更响亮。有关更多信息，请参阅术语“响度战争”。例如参考 Caty Perry 的歌曲“firework”。整首歌的音量几乎是恒定的。

# c# - 设计模式：Active Record 性能和灵活性

> ID：10826687
> 
> 赞同：0
> 
> 时间：2012-05-31T02:22:30.517
> 
> 标签：c#, oop, design-patterns

我即将开发一个新应用程序并正在考虑最佳实践

我已经阅读过有关 ActiveRecords 的信息，并且我以前也使用过它，但我总是想要一些能让更改更容易、更省时的东西。

**使用活动记录和其他 ORM**：我相信这些方法会从数据库中加载所有记录，而有时我可能只需要一两个

就像如果我想做分页，我需要传递 pageIndex 和 pageSize，如果不加载所有数据你会怎么做

就像我想要 WHERE 子句中的多个字段一样 我不会加载所有记录并根据我的条件进行过滤

我希望所有的选择/过滤/排序都发生在数据库级别

添加静态方法来执行这些操作看起来我会做错事

有没有优雅地处理这个问题的 ORM？

我希望最大限度地控制应用程序流程，以便在必要时轻松优化。

注意：我还在研究**DAO 和其他方法**，但我想对 Active Record 提出意见，以防我仍然想使用它

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:36:12.237

如果您使用的是 C# 3.5+，我相信`Linq`，`IQueryable`并且适当的数据服务层可以解决您的问题。

1.  分页。IQueryable 默认情况下，在调用 toList() 之前不会提交。您可以让您的数据存储返回带有**所有**项目的 IQueryable，但最后进行过滤和分页，并且只处理您需要的项目，

例如

```
var items = getAllItems(); // IQueyrable<Item>, from database

var paged = items.Skip(50).Take(10); // Database still not queried
paged.toList(); // Database return 10 items only 
```

1.  过滤和 WHERE。和上面一样

2.  大多数 ORM 与 Linq 一起工作。例如 NHibernate

3.  > 最大限度地控制应用程序流程。

    可能您需要编写自己的自定义 Linq 提供程序，但相信我，您不必这样做。

# android - 如何从我的着色器代码中替换纹理中的颜色？

> ID：10826689
> 
> 赞同：1
> 
> 时间：2012-05-31T02:22:48.603
> 
> 标签：android, opengl-es-2.0

我正在编写一个简单的图像查看器，用于在 Android 上的 OpenGL ES 2.0 中的几个三角形上显示图像。这些图像中有一种特定的颜色，必须以某种方式替换为黑色。问题是，如果 GL_LINEAR 用于我的最小和最大化过滤器，则需要替换的颜色的轮廓仍然可见。如果我将 GL_NEAREST 用于我的过滤器，着色器可以轻松替换颜色，但是它不会将图像渲染得平滑，并且在放大和缩小时当然看起来像素化。

我想知道是否有更好的方法来执行此类任务。我的一些想法是：

*   构建另一个仅在纹理像素上运行一次并在我的片段着色器期间实际使用纹理之前替换颜色的着色器？
*   重写我的着色器，使其即使在使用 GL_LINEAR 时也能正常工作。

谁能给我任何关于这通常是如何完成的线索？我宁愿在着色器中执行此操作的原因是我可以确保遮罩像素颜色始终保持黑色。

我对 OpenGL ES 2.0 还是很陌生，但我正在尝试了解事情是如何工作的。请记住这一点，并帮助我学习。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:49:03.190

在那种情况下（面具总是在同一个地方），我认为你有更多的选择。

我将创建一个单通道图像，其中蒙版区域为 1，未蒙版区域为 0。

然后在shader中，你对原始纹理和蒙版纹理进行采样，如果蒙版值大于某个阈值，你可以用自己的蒙版颜色替换。

这在一定程度上缓解了使用 GL_LINEAR 的问题，因为您可以调整拒绝像素的值。

例如，如果您在蒙版和未蒙版像素之间进行采样，那么您的蒙版值为 0.5，颜色将为 (0.5*color_key + 0.5*unmasked_color)。如果您发现这种不可接受的颜色渗色，您可以将 alpha 拒绝设置为 0.1、0.001 等，以遮盖其中甚至有轻微遮罩痕迹的任何像素。这会稍微扩大您的蒙版区域，但会让您在结果中的任何地方都看不到颜色键的痕迹。

# c# - c#程序占用大量内存

> ID：10826690
> 
> 赞同：1
> 
> 时间：2012-05-31T02:22:56.523
> 
> 标签：c#, .net, memory, httpwebrequest

> **可能重复：**
> [最好的 .NET 内存和性能分析器？](https://stackoverflow.com/questions/49912/best-net-memory-and-performance-profiler)

我的 C# 程序是一个网络爬虫程序，它广泛使用异步 HttpWebRequests、Regex 和 HTML 敏捷包。它使用 ThreadPool.QueueUserWorkItem 方法进行多线程处理。

它开始使用大约 600,000 K 的内存，最终攀升至超过 1,000,000 K。

如何跟踪占用最多内存的内容并对其进行清理以减少资源密集型？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T02:28:27.083

使用内存分析器 - 它们可以帮助分析此类问题，例如：

*   [http://memprofiler.com/](http://memprofiler.com/)（商业、**托管和非托管集成在一个分析器中**！）
*   [http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/)（商业）
*   [MS 的 CLR Profiler](http://www.microsoft.com/download/en/details.aspx?id=16273)（免费）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T02:26:58.567

您最好的选择是使用*分析器*。我在使用[Redgate ANTS Performance Profiler](http://www.red-gate.com/products/dotnet-development/ants-performance-profiler/)方面取得了巨大成功，它不是免费的。那里可能还有其他不错的选择。

# grails - Grails：如何检查已验证的字段是否已添加到不同的域类中？

> ID：10826691
> 
> 赞同：1
> 
> 时间：2012-05-31T02:23:12.160
> 
> 标签：grails, groovy, junit, validation, missingmethodexception

我有一个 NameAndAddress 域类。每个人都可以是音乐家或社区成员，但不应两者兼而有之。

```
class NameAndAddress {
    ...
}

class Musician {
    NameAndAddress nameAndAddress
}

class CommunityMember {
    NameAndAddress nameAndAddress
} 
```

我想为它们添加一个验证器，检查上述规则。我从音乐家开始：

```
class Musician {
    NameAndAddress nameAndAddress

    static constraints = {
        nameAndAddress(validator: { thisField ->
            return (CommunityMember.findByNameAndAddress(thisField) == null) ? true : false
        })
    }
} 
```

当我在 Musician 上运行 validate() 时，虽然我得到：

```
groovy.lang.MissingMethodException: No signature of method: CommunityMember.findByNameAndAddress() is applicable for argument types: (NameAndAddress) values: [NameAndAddress : 1]
Possible solutions: findByNameAndAddress([Ljava.lang.Object;) 
```

我不明白这个错误。不是说 NameAndAddress 对象对期望的东西无效吗... NameAndAddress 对象？

我该怎么做才能让它工作？

* * *

**编辑：（**
*解决方法）* - 使用上述方法仍然无法正常工作。我有一个丑陋的解决方法，@sudhir 指出会影响性能。但是，如果它可以帮助人们以更清洁的方式理解我正在尝试做的事情，则此代码确实有效：

```
nameAndAddress(validator: { thisField, thisObject ->
    boolean notACommunityMember = true

    for (CommunityMember communityMember : CommunityMember.list()) {
        if (communityMember.getNameAndAddress().getId() == thisField.getId()) {
            notACommunityMember = false
            break
        }
    }

    return notACommunityMember
}) 
```

* * *

**编辑2：（**
*单元测试代码调用验证，由评论请求）* -

```
@TestMixin(DomainClassUnitTestMixin)
class MusicianTest ...

    NameAndAddress aNameAndAddress = new NameAndAddress()

    mockDomain(CommunityMember, [
        [nameAndAddress: aNameAndAddress]
    ])

    Musician musician = new Musician(nameAndAddress: aNameAndAddress)

    musician.validate()
    assert musician.errors["nameAndAddress"] != null 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-02T04:58:31.167

Sudhir 在评论中回答。在 Domain 类名中包含“And”（或者假设是任何谓词）将搞砸 Grails 奇怪的小 findByThenPutVariablesInTheMethodName 语法

将类重命名为 NameAddress，一切顺利。

作为对任何这样做的人的额外提醒，在进行涉及 DomainClass.findByWhatever 的单元测试时，请务必使用 Grails 的 mockDomain 类。我把我的例子放在问题的最底部

# php - 基于字符位置的Javascript令牌拆分

> ID：10826699
> 
> 赞同：0
> 
> 时间：2012-05-31T02:24:36.387
> 
> 标签：php, javascript, parsing, token

我试图找出一种基于 char 位置返回部分字符串的方法。

示例字符串：

```
if($thi_s->[$x]->name['somename']){
    print $name;
} 
```

这是 PHP 代码行，但我希望能够根据 char 位置所在的上下文使用 javascript 解析它。

例如：假设我将光标悬停在变量`$this`上，我想返回 on `$this`，但是如果我将光标悬停在单词上，`name`我想返回完整的上下文，例如`$thi_s->[$x]->name`.

但我也想将它限制在子数组中，例如，如果我将鼠标悬停在变量上`$x`，我只想返回`$x`而不是别的。

或者，如果我对`"somename"`我想要返回的词有把握`$thi_s->[$x]->name['somename']`。

我认为该解决方案将传递给 php 令牌和正则表达式，并且可能是递归函数，但由于这是基于光标位置，我发现很难想出一个解决方案。我不需要完整的解决方案，但需要一些提示和想法来解决这个问题。

谢谢。

# clojure - Clojure：core.logic，conde，运行 1

> ID：10826713
> 
> 赞同：2
> 
> 时间：2012-05-31T02:26:37.213
> 
> 标签：clojure

## 语境

根据 core.logic 文档，conde 确实是 condi，这意味着它可能不会以与 mini-kanren 相同的顺序返回。

## 问题

因此，如果我有以下形式：

```
(run 1 [q]
  (conde ...)) 
```

是否可能 core.logic / mini-kanren 会给我不同的结果，因为：

*   conde 可以以不同的顺序返回结果
*   run 1 只取其中一个，因此两者可能有不同的第一个元素

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T11:36:12.727

是的，这是可能的。`conde`不保证答案顺序（它非常依赖于实现并且无关紧要，因为所有替代方案都是并行探索的）。

在玩 core.logic 时，它多次咬我，因为单元测试采用特定的顺序。

AFAIK，在 Reasoned Schemer 第 2 版中，`conde`将是第 1 版`condi`。

# java - 来自文件的 ArrayList（特定格式）

> ID：10826715
> 
> 赞同：-2
> 
> 时间：2012-05-31T02:27:01.060
> 
> 标签：java, file, input, arraylist

我有一个看起来像这样的文件：

```
 1st ­ ­ ­   ­­­ 2nd ­ ­ ­   ­­­ nth
    e1­ ­ ­ ­   ­­­ ­­v1 ­ ­ ­   ­­­ 1
    e1 ­ ­ ­   ­­­ v3 ­ ­ ­   ­­­ 2
    e1 ­ ­ ­   ­­­ v4 ­ ­ ­   ­­­ 4
    e1 ­ ­ ­   ­­­ v5 ­ ­ ­   ­­­ 7
    e2 ­ ­ ­   ­­­ v1 ­ ­ ­   ­­­ 1
    . ­ ­ ­   ­ ­ ­. ­ ­ ­  ­ ­ ­­­ .
    . ­ ­ ­   ­ ­ ­. ­ ­ ­   ­­­  .
    . ­ ­ ­   ­ ­ ­.      ­  . 
```

我希望第一列是数组列表的名称（e1 或 e2 或 e3），我希望第二列在第 n 个索引内具有它的值（一个 int）。

我该怎么做呢？

如果您想进一步澄清我的意思，请不要害怕留下一个下午。

ps 这是一个更大项目的一部分，但我有点卡在数据的格式上。

我假设我必须寻找一个名称为（第一列）的数组列表，如果我找到它，然后在第 n 个值（第 3 列）处添加值（第 2 列），如果我没有找到它，我创建一个arrayList，然后执行上述操作。

**更新**

所以我设法让程序几乎可以工作——我不能使用 ArrayLists 的原始结构，因为所有变量都必须在编译期间声明——不能在之后声明。我决定使用哈希图，键具有第一个值，以及第 n 个位置的第二个值的数组列表：

```
`HashMap<String, ArrayList<Integer>> userRatings = new HashMap<String, ArrayList<Integer>>();
 if(!userRatings.containsKey(user)) //The user does not have ratings.
                {
                    ArrayList<Integer> ratings = new ArrayList<Integer>();
                    //                     ratings = userRatings.get(user);
                   for (int j = 0; j < 50; j++)
                    {
                        ratings.add(j);
                    }
                    userRatings.get(user).add(location,value);
}                }
                else //The user has ratings
                {
                    userRatings.get(user).add(location,value);**
                }
                System.out.println(user + " " + userRatings.get(user));
            }
            bufferReader.close();
        }    catch (FileNotFoundException e)
        {
            System.out.println("File does not exist or could not be found.");
        }
        catch (IOException e)
        {
            System.out.println("Can't read from file");
        }
        catch (NullPointerException e)
        {
        }` 
```

我现在遇到的问题是添加到数组列表中。我将如何在粗体​​区域中做到这一点？-- 我将如何填充和操作数组列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T05:45:05.653

> 老实说，我认为最初的问题在于以这种格式读取文件。

如果您使用正确的库，这很容易。看看这个： http: [//opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)，它是用来解析 csv 文件的。从那个网站：

> ### 我可以使用自己的分隔符和引号字符吗？
> 
> 是的。有一些构造函数可以提供您自己的分隔符和引号字符。假设您使用制表符作为分隔符，您可以执行以下操作：
> 
> ```
> CSVReader reader = new CSVReader(new FileReader("yourfile.csv"), '\t'); 
> ```

我认为这正是你想要做的。您要求此库使用制表符分隔的值而不是逗号分隔的值来解析输入文件。从上面的示例中，这似乎是您的输入格式。

# javascript - If-else 语句的短路

> ID：10826717
> 
> 赞同：3
> 
> 时间：2012-05-31T02:27:18.050
> 
> 标签：javascript

所以我知道

```
variable && runTrue(); 
```

真正意思

```
if(variable){
    runTrue();
} 
```

* * *

那么有没有更简化的写法

```
if(variable){
    runTrue();
}else{
    runFalse();
} 
```

而不是`if-else`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T03:07:36.833

[使用条件运算符](http://es5.github.com/#x11.12) 的三元表达式`? :`是为这种简单的二元选择发明的：

```
function a() {alert('odd')}
function b() {alert('even')}
var foo = new Date() % 2;

foo? a() : b(); // odd or even, more or less randomly 
```

相当于：

```
if (foo % 2) {
  a(); // foo is odd
} else {
  b(); // foo is even
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T02:27:18.223

是的，我发现这会做和正常一样的事情`if-else`：

```
(variable) && (runTrue(),1) || runFalse(); 
```

它短了***2 个***字符（总比没有好），并且在[jsPerf](http://jsperf.com/if-else-vs-short-circuit-evaluation)中进行了测试，通常`Short-circut evaluation - false`在大多数情况下都比正常的执行方式更快。

```
(variable) &&           //If variable is true, then execute runTrue and return 1
(runTrue(),1) ||        // (so that it wouldn't execute runFalse)
runFalse();             //If variable is false, then runFalse will be executed. 
```

但是，当然，您始终可以使用`variable?runTrue():runFalse();`.

# java - Java：有没有人有办法在数组中找到字符串的最佳匹配？

> ID：10826720
> 
> 赞同：7
> 
> 时间：2012-05-31T02:27:39.813
> 
> 标签：java, pattern-matching, matching, string-matching

基本上我只是想找到一种方法来找到最接近的匹配（不一定精确）`String`

例如，`"delicous"`在`{"pie", "delicious", "test"}`

这很明显，但数组中的值可能并不总是那么不同。

有人可以帮助我实现这一目标。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-31T02:33:08.890

取决于您如何定义“最近”，但一种常见的方法是使用[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)分数。Apache Commons[在 StringUtils 中有这样的方法](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#getLevenshteinDistance(java.lang.CharSequence,%20java.lang.CharSequence))。

从那里您的搜索方法基本上变成：在集合中找到对于给定输入具有最小 Levenshtein 距离的字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:33:51.330

Java没有为此内置任何东西。[您可以尝试使用SecondString](http://secondstring.sourceforge.net/)或[FREJ](http://frej.sourceforge.net/)等第三方库。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-31T02:34:53.527

可以与 Levenshtein Distance 结合使用的另一种方法是首先采用单词的语音表示。执行此操作的一种算法是[Metaphone](http://en.wikipedia.org/wiki/Metaphone)。

Apache Commons Codec的[用户指南](http://commons.apache.org/codec/userguide.html)包含有关此编码器和其他一些编码器的详细信息。

# cloud-foundry - 错误 402：应用打包失败：“同步资源池失败”

> ID：10826721
> 
> 赞同：2
> 
> 时间：2012-05-31T02:27:44.073
> 
> 标签：cloud-foundry

尝试将应用程序推送到 cloudfoundry.com 时，我从 vmc​​ 收到此错误：

```
Error 402: App packaging failed: 'Failed synchronizing resource pool' 
```

我不知道现在该怎么办。该应用程序已停止，没有日志和文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-18T21:23:06.080

这应该在 5 月下旬对 CloudFoundry.com 的更新中得到修复。如果您再次看到它，请告诉我们，或在[http://support.cloudfoundry.com提交支持票](http://support.cloudfoundry.com)

# java - 来自 TaskAttemptContext 的 JobConf

> ID：10826722
> 
> 赞同：0
> 
> 时间：2012-05-31T02:27:48.867
> 
> 标签：java, hadoop, amazon-web-services

我正在尝试掌握`JobConf`一个自定义`TextInputFormat`类。

```
public RecordReader<LongWritable,Text> createRecordReader(InputSplit split, TaskAttemptContext context) {
 return new XmlInputFormat(split, ...jobconf...);
} 
```

我该怎么做？

请使用 Hadoop 0.20 API（Amazon EMR 要求）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:30:55.853

TaskAttemptContext 有一个 getJobConf 方法，它返回 JobConf：

*   `org.apache.hadoop.mapred.TaskAttemptContext.getJobConf()`

# google-maps - Google Maps API v3 返回错误的位置（坐标）

> ID：10826730
> 
> 赞同：2
> 
> 时间：2012-05-31T02:29:48.597
> 
> 标签：google-maps, google-maps-api-3

我正在使用 Google Map GeoCoder v3 (JSON) 来获取坐标

```
Praia do forte
Mata de São João, Bahia 
Brazil 
```

Google Geocoder API*找不到*，但[http://maps.google.com](http://maps.google.com) *可以*找到。

谷歌地图站点
[https://maps.google.com/maps?q=Praia+do+forte,+Mata+de+S%C3%A3o+Jo%C3%A3o,+Bahia,+Brazil&ie=UTF-8&hl= en&authuser=0](https://maps.google.com/maps?q=Praia+do+forte,+Mata+de+S%C3%A3o+Jo%C3%A3o,+Bahia,+Brazil&ie=UTF-8&hl=en&authuser=0)

这是我要进行地理编码的 Google Maps API v3**请求URL**

[http://maps.googleapis.com/maps/api/geocode/json?sensor=false&address=Praia%2Bdo%2Bforte%252C%2BMata%2Bde%2BS%25C3%25A3o%2BJo%25C3%25A3o%252C%2BBahia% 2B%252C%2B巴西](http://maps.googleapis.com/maps/api/geocode/json?sensor=false&address=Praia%2Bdo%2Bforte%252C%2BMata%2Bde%2BS%25C3%25A3o%2BJo%25C3%25A3o%252C%2BBahia%2B%252C%2BBrazil)

这是**回应**。

```
{
   "results" : [
      {
         "address_components" : [
            {
               "long_name" : "Praia",
               "short_name" : "Praia",
               "types" : [ "locality", "political" ]
            },
            {
               "long_name" : "Praia",
               "short_name" : "Praia",
               "types" : [ "administrative_area_level_1", "political" ]
            },
            {
               "long_name" : "Cape Verde",
               "short_name" : "CV",
               "types" : [ "country", "political" ]
            }
         ],
         "formatted_address" : "Praia, Cape Verde",
         "geometry" : {
            "bounds" : {
               "northeast" : {
                  "lat" : 14.97272960,
                  "lng" : -23.47061630
               },
               "southwest" : {
                  "lat" : 14.90016530,
                  "lng" : -23.54284290
               }
            },
            "location" : {
               "lat" : 14.9304640,
               "lng" : -23.5126690
            },
            "location_type" : "APPROXIMATE",
            "viewport" : {
               "northeast" : {
                  "lat" : 14.95202550,
                  "lng" : -23.48065420
               },
               "southwest" : {
                  "lat" : 14.90890030,
                  "lng" : -23.54468380
               }
            }
         },
         "types" : [ "locality", "political" ]
      }
   ],
   "status" : "OK"
} 
```

它显然是在佛得角的一个城市“Praia”这个词上绊倒的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T07:34:19.753

API 地理编码器不同于地图地理编码器（请参阅 API 文档中的常见问题解答）。

但是，*只需*提供足够的信息来识别该地点即可： [http ://maps.googleapis.com/maps/api/geocode/json?sensor=false&address=Praia+do+forte,Brazil](http://maps.googleapis.com/maps/api/geocode/json?sensor=false&address=Praia+do+forte,Brazil)

# objective-c - 在输出流上创建延迟

> ID：10826731
> 
> 赞同：0
> 
> 时间：2012-05-31T02:29:50.250
> 
> 标签：objective-c, ios

我正在处理一项特殊任务，我需要在 TCP 输出流上创建延迟。这是由于对接收器设备的限制。

我可能面临的另一个问题是输出缓冲区溢出，因为与降低的传输速度相比，我可能写得太快了。

一个人会如何处理这样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:37:34.167

我不确定您是否需要 MacOSX 或 iOS 的解决方案，但由于您只标记了 Objective -C，请尝试查看此文档链接

[performSelector:withObject:afterDelay:](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsobject_Class/Reference/Reference.html)

此方法将让您在延迟后执行您的代码！还有其他方法可以在主线程或后台执行。

# python - 使用网格在 tkinter gui 中设置不均匀的单元格高度

> ID：10826738
> 
> 赞同：2
> 
> 时间：2012-05-31T02:31:45.743
> 
> 标签：python, user-interface, tkinter, ttk

这是我的代码：

```
from tkinter import *
from tkinter.ttk import *

class App:

    def __init__(self, master):
        #Frame.__init__(self, master)

        fuzz = Entry(master, width = 20).grid(column=2,row=2)
        Label (text='Fuzz:').grid(column=1,row=2)

        smoothing = Entry(master, width = 20).grid(column=2,row=3,sticky=N)
        Label (text='Smoothing:').grid(column=1,row=3,sticky=N)

        rendering = Entry(master, width = 20).grid(column=2,row=4,sticky=N)
        Label (text='rendering:').grid(column=1,row=4,sticky=N)

        colors = Listbox(master, selectmode="extended", activestyle="dotbox")

        for item in ["color_1", "color_2", "color_3", "color_4"]:
            colors.insert(END, item)
        colors.grid(row=3,column=3, columnspan =1, padx=10, rowspan=2)

        pics = Listbox(master, selectmode="extended", activestyle="dotbox")

        for item in ["pic_1", "pic_2", "pic_3", "pic_4"]:
            pics.insert(END, item)
        pics.grid(row=3,column=4, columnspan=1, padx=10, rowspan=2)

        addcolor = Button(master, text="add color", )
        addcolor.grid(column=3,row=1, sticky=W+E, padx=10)
        remcolor = Button(master, text="remove color", )
        remcolor.grid(column=3,row=2, sticky=W+E, padx=10)

        addpic = Button(master, text="add pic", )
        addpic.grid(column=4,row=1, sticky=W+E, padx=10)
        rempic = Button(master, text="remove pic",)
        rempic.grid(column=4,row=2, sticky=W+E, padx=10)

root = Tk()

app = App(root)

root.mainloop() 
```

这就是我想做的：http: [//i.imgur.com/sizHT.png](http://i.imgur.com/sizHT.png)

基本上，列表框跨越两行，列表框左侧的两个单元格是列表框高度的一半。但是是否可以让单元格与默认高度一样短？

```
I have tried:
    changing the rowspan to 1 
    Having the listbox occupy 10 rows (results in odd padding around the cells) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T07:20:06.100

您必须强制使用默认机制来平均增长每一行。您必须使用`grid_rowconfigure`来设置这些行的“权重”。权重是额外空间如何在行之间分配的相对指标。

在你的情况下：

```
 master.grid_rowconfigure(3, weight=0)
    master.grid_rowconfigure(4, weight=1) 
```

因此，第 3 行（带有平滑）被告知不要占用额外的空间。

# c# - 时间：2019-01-01 标签：c#arrayloopingbitwiseindexvsnull检查

> ID：10826743
> 
> 赞同：0
> 
> 时间：2012-05-31T02:32:39.253
> 
> 标签：c#, arrays, performance, loops, bit-manipulation

在我的项目中，我正在使用用户决定长度的对象数组（object []）。在应用程序的过程中，它也至少每秒循环数百次。这个数组还有一个与之关联的类，它确保对它的任何添加都将使用一个为每个占用的元素设置一个位的数组来填充第一个空缺点。一旦分配的数组条目保持在原位，因为它会影响元素的跟踪以移动它们，因此可能存在间隙。可以删除或添加的元素数量是未知的。与循环访问元素相比，添加和删除发生的频率要低得多。

我需要知道的是，当循环通过这个数组时，哪个会提供更好的平均性能......

1.  检查每个条目是否为空

或者

1.  调用以下代码以获取循环中的下一个索引，以检查 -1 是否停止。Tracker 包含元素的按位位置。该函数只需要为每个填充元素运行一次。&= 行和下一行的减法产生最低位集的整数值。DeBruijn 序列位执行对数基数 2 以获得位位置。

    ```
    private List<Int32> Tracker = new List<Int32>();
    private int EnumTemp;
    private int EnumTemp2;
    private int EnumResult;
    private int EnumIndex = -1;
    //from http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogDeBruijn
    protected internal static readonly Int32[] MultiplyDeBruijnBitPosition2 =
    {
        0, 1, 28, 2, 29, 14, 24, 3, 30, 22, 20, 15, 25, 17, 4, 8,
        31, 27, 13, 23, 21, 19, 16, 7, 26, 12, 18, 6, 11, 5, 10, 9
    };
    public int NextIndex()
            {
                if (EnumIndex == -1)
                {
                    EnumTemp = Tracker[0];
                    EnumIndex = 0;
                }
                while (EnumTemp == 0)
                {
                    if (EnumIndex == Tracker.Count -1)
                    {
                        EnumIndex = -1;
                        return -1;
                    }
                    EnumIndex++;
                    EnumTemp = Tracker[EnumIndex];
                }
                EnumTemp2 &= EnumTemp - 1;
                EnumResult = Engine.MultiplyDeBruijnBitPosition2[(UInt32)((EnumTemp-EnumTemp2) * 0x077CB531U) >> 27];
                EnumResult += (EnumIndex * 32);
                EnumTemp = EnumTemp2;
                return EnumResult;
            }
        } 
    ```

    假设在这两种情况下都将访问数组元素并将其存储在临时变量中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T08:52:03.480

有一点是，检查 x 空行是否为空的速度会比使用跟踪器的快步慢。您需要对差距有多大有所了解。但我的直觉表明，在这会有帮助之前，应该有相当大的间隙（比如空行是填充行的 5 倍）。至于我为什么这么认为；

*   数组访问是按顺序且完美地预取的。因此，填充后的第一个 y 条目已经在缓存中。跳过它们不会阻止内存访问

*   空检查非常快。与此相比，跟踪器“复杂”

*   您的代码变得更加复杂，可能获得的收益很少。

*   我认为在您的情况下，双向链表可能会更快，因为它根本没有间隙并且可以有效地循环。您不需要数组中的位置，因为您可以使用链接列表引用删除对象。

# parsing - 分号插入 ala google go with flex

> ID：10826744
> 
> 赞同：5
> 
> 时间：2012-05-31T02:32:48.233
> 
> 标签：parsing, go, lex, flex-lexer, lexer

我有兴趣在我的 flex 文件中添加分号插入 ala Google Go。

来自 Go 文档：

> # 分号
> 
> 与 C 一样，Go 的形式语法使用分号来终止语句；与 C 不同，这些分号不会出现在源代码中。相反，词法分析器使用一个简单的规则在扫描时自动插入分号，因此输入文本大部分没有分号。
> 
> 规则是这样的。如果换行符之前的最后一个标记是标识符（包括 int 和 float64 之类的词）、基本文字（例如数字或字符串常量）或其中一个标记
> 
> ```
> break continue fallthrough return ++ -- ) } 
> ```
> 
> 词法分析器总是在标记后插入一个分号。这可以概括为“如果换行符出现在可以结束语句的标记之后，则插入分号”。
> 
> 分号也可以在右大括号之前省略，所以像这样的语句
> 
> ```
> go func() { for { dst <- <-src } }() 
> ```
> 
> 不需要分号。惯用的 Go 程序仅在诸如 for 循环子句之类的地方使用分号来分隔初始值设定项、条件和延续元素。如果您以这种方式编写代码，它们还必须在一行中分隔多个语句。
> 
> 一个警告。永远不要将控制结构（if、for、switch 或 select）的左大括号放在下一行。如果这样做，将在大括号前插入分号，这可能会导致不良影响。像这样写它们
> 
> ```
> if i < f() {
>     g()
> } 
> ```
> 
> 不像这样
> 
> ```
> if i < f()  // wrong! 
> {           // wrong!
>     g()     // wrong!
> }           // wrong! 
> ```

我将如何执行此操作（如何在流中插入令牌，如何查看匹配的最后一个令牌以查看它是否是一个好主意等）？

我也在使用野牛，但 Go 似乎只是使用他们的词法分析器来插入分号。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-04T21:47:28.050

您可以通过在必要时插入分号的函数传递词法分析器结果标记。在检测到需要插入时，可以将下一个标记放回输入流，基本上在下一回合再次对其进行词法分析。

下面是一个在换行符之前插入分号的示例，当它跟在 WORD 之后。野牛文件“insert.y”是这样的：

```
%{
#include <stdio.h>

void yyerror(const char *str) {
  printf("ERROR: %s\n", str);
}

int main() {
  yyparse();
  return 0;
}
%} 
%union {
  char *string;
}
%token <string> WORD
%token SEMICOLON NEWLINE
%%
input: 
     | input WORD          {printf("WORD: %s\n", $2); free($2);}
     | input SEMICOLON     {printf("SEMICOLON\n");}
     ;
%% 
```

词法分析器是由 flex 生成的：

```
%{
#include <string.h>
#include "insert.tab.h"
int f(int token);
%}
%option noyywrap
%%
[ \t]          ;
[^ \t\n;]+     {yylval.string = strdup(yytext); return f(WORD);}
;              {return f(SEMICOLON);}
\n             {int token = f(NEWLINE); if (token != NEWLINE) return token;}
%%
int insert = 0;

int f(int token) {
  if (insert && token == NEWLINE) {
    unput('\n');
    insert = 0;
    return SEMICOLON;
  } else {
    insert = token == WORD;
    return token;
  }
} 
```

用于输入

```
abc def
ghi
jkl; 
```

它打印

```
WORD: abc
WORD: def
SEMICOLON
WORD: ghi
SEMICOLON
WORD: jkl
SEMICOLON 
```

取消一个非常量标记需要一些额外的工作——我试图让这个例子保持简单，只是为了给出这个想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-05T15:10:17.370

更改词法分析器规则`\n`并`}`查看词法分析器返回的最后一个标记。这将要求您的词法分析器记录为每个规则返回的最后一个标记。

然后您的换行规则将如下所示：

```
\n   { if (newline_is_semi(last_token)) {
          return SEMICOLON;
       }
     } 
```

`newline_is_semi`将检查 last_token 是否在您列出的令牌列表中。

处理右大括号前的可选分号：匹配 '}' 时检查 last_token 是否为 SEMICOLON，如果不是，则取消输入 '}' 并返回 SEMICOLON

```
'}'  { if (last_token != SEMICOLON) {
          unput('}');
          return SEMICOLON;
       }
     } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-26T11:15:11.093

一种简单的方法是创建一个全局变量

```
%{
    ins_token = 0
%} 
```

然后假设在“）”之后要插入分号，然后设置 ins_token = 1 并在其他令牌中重置 ins_token = 0

现在，在“)”之后出现“\n”，然后检查 ins_token == 1 是否返回分号，否则忽略它并始终重置 ins_token = 0。

ins_token 充当一个标志。当您希望插入分号时设置标志。在获取 \n 时，它将检查该标志，如果设置了它将插入分号。

这是因为 flex 不记得之前的标记。

```
[\n] { if (ins_token == 1) { ins_token = 0; return SEMICOLON; } }
")"  { ins_token = 1; }

...other tokens
...  { ins_token = 0; } 
```

# c - libav：用 RGB24 样本数据填充 AVFrame？

> ID：10826745
> 
> 赞同：0
> 
> 时间：2012-05-31T02:33:02.337
> 
> 标签：c, image-processing, ffmpeg, libavcodec, libav

我正在尝试为使用 RGB24 格式初始化的 AVFrame 填充样本数据。我使用以下代码片段来填充 RGB 数据。但是在编码的视频中，我只能看到仅覆盖视频帧 1/3 的灰度条。此代码片段假设仅填充红色。任何提示我在这里做错了什么？

```
AVFrame *targetFrame=.....
int height=imageHeight();
int width=imageWidth();

  for(y=0;y<encoder.getVideoParams().height ;y++){   
       for(x=0;x< encoder.getVideoParams().width;x++){

   targetFrame->data[0][(y* width)+x]=(x%255); //R  
   targetFrame->data[0][(y* width)+x+1]=0;     //G
   targetFrame->data[0][(y* width)+x+2]=0;     //B

  }
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T02:45:42.337

如果您使用的是 RGB24，则需要在索引到数据缓冲区之前缩放坐标。这是您的内部循环的一个版本，可以正确执行：

```
int offset = 3 * (x + y * width);
targetFrame->data[0][offset + 0] = x % 255; // R
targetFrame->data[0][offset + 1] = 0; // G
targetFrame->data[0][offset + 2] = 0; // B 
```

这是一个更简单的方法：

```
uint8_t *p = targetFrame->data[0];
for(y = 0; y < encoder.getVideoParams().height; y++) {  
    for(x = 0; x < encoder.getVideoParams().width; x++) {
        *p++ = x % 255; // R
        *p++ = 0; // G
        *p++ = 0; // B
    }
} 
```

# .net - 使用 log4net 创建记录器库的最佳实践。是

> ID：10826750
> 
> 赞同：5
> 
> 时间：2012-05-31T02:34:04.863
> 
> 标签：.net, asp.net-mvc-3, logging, log4net

我的目标是创建一个可以跨多个项目共享的 log4net 库。

在我的 .net 4.0 解决方案中，我创建了一个名为 Logger 的类库并从 Web 项目中引用它。

现在我在类库中创建了一个logger.config，并将所有配置都放在了logger.config文件中。然后我用

```
[assembly: log4net.Config.XmlConfigurator(Watch = true, ConfigFile = "Logger.config")] 
```

当我运行 Web 应用程序时，没有任何记录。所以我在 web.config 中添加了这行代码

```
<add key="log4net.Internal.Debug" value="true"/> 
```

这给了我调试信息和错误信息

**未能在应用程序的 .config 文件中找到配置部分“log4net”。检查 .config 文件中的 and 元素。配置部分应如下所示：**

我将配置从 logger.config 移动到 web.config，一切似乎都运行良好。

我不希望 web.config 中的 log4net 配置，但将它作为更清洁的方法使用 logger.config。目标是让其他项目使用这个库，而不必担心每个项目的配置。

现在的问题是，我该怎么做？我究竟做错了什么？任何带有代码示例的建议都会对每个人都有益。

仅供参考，我正在使用结构映射 IOC 来重新爱上记录器，然后再登录它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-10T00:42:09.160

我相信您正在尝试重新发明轮子，有几种工具可以从您的代码中抽象出记录器，从而将记录器框架与您的代码解耦：

[http://slf.codeplex.com/](http://slf.codeplex.com/)

[http://netcommon.sourceforge.net/](http://netcommon.sourceforge.net/)

这些是 .Net 应用程序中最常见的。

现在，如果您坚持使用自己的抽象（这是有效的），这是我的建议：

首先，我假设你会有类似的东西：

```
interface ILogger
{
    void Debug(string message);
    void Info(string message);
    void Warn(string message);
    …..
} 
```

好的，所以在您的代码中，您将注入记录器的单例引用，例如：

```
x.For<ILogger>().Singleton().Use<MyLogger>(); 
```

现在，我通常更喜欢约定而不是配置，但是在记录器的情况下，通过配置文件进行配置是一个很大的优势，因为当您的代码在生产中时，您有时会希望通过禁用或启用记录器来更改日志记录规则，更改日志级别，并启用/禁用命名记录器。

我发现完成此操作的最简单和最可重用的方法是按照您的评论将配置放在外部文件中，然后我不会费心调用`XmlConfigurator`in 代码，因为它对我来说更简单，只需将几个应用程序设置添加到我的像这样的配置文件

```
<!-- Relative to the application root path -->
<add key="log4net.Config" value="Logger.log4net"/>
<add key="log4net.Config.Watch" value="True"/> 
```

就是这样。这些应用程序设置会覆盖您的 log4net 配置，并且易于维护。您的配置文件将如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>

<!-- This section contains the log4net configuration settings -->
<log4net>

  <!-- Define some output appenders -->

  <appender name="LogFileAppender" type="log4net.Appender.FileAppender" >
    <file value="webapp-log.txt" />
    <appendToFile value="true" />
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %-5level %logger [%ndc] - %message%newline" />
    </layout>
  </appender>

  <!-- Setup the root category, add the appenders and set the default priority -->

  <root>
    <level value="DEBUG" />
    <appender-ref ref="LogFileAppender" />
  </root>

</log4net> 
```

要配置更多附加程序：[单击此处](http://logging.apache.org/log4net/release/config-examples.html)

在您的项目中，您只需要对记录器抽象组件的引用，只需在 Web 项目（或 Windows 应用程序，它是相同的）中添加 log4net 配置文件和那些应用程序设置

由于您正在创建一个可重用的组件，我建议您在组织中设置一个内部 Nuget 服务器（它只是一个 IIS 应用程序）并使用它来部署您的组件，在这种情况下是包含记录器的库。此外，如果您创建一个仅包含应用程序设置和 log4net 配置文件的不同 Nuget 包会更好，因此您只能在您的 Web 项目中安装此 Nuget 包

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-09T10:27:59.083

也许对于您的 Web 应用程序，您可以尝试在 application_start (gloabal.asax.cs) 中加载配置文件

```
 void Application_Start(object sender, EventArgs e)
    {
        log4net.Config.XmlConfigurator.Configure(new System.IO.FileInfo(Server.MapPath("Logger.config")));
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T04:36:27.353

您可能想试试这个：[http](http://forums.asp.net/t/1739162.aspx/1) ://forums.asp.net/t/1739162.aspx/1或[这个](http://www.beansoftware.com/ASP.NET-Tutorials/Multiple-Config.aspx)。默认情况下，Web 应用程序将只查看它的主 webconfig 和区域/文件夹中的配置。您应该确保在新`appConfig`的 for中包含所有必需的配置，如下所示`log4net`：

```
 <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
  </configSections>

  <log4net>
    <appender name="FileAppender" type="log4net.Appender.FileAppender">
      <file value="logfile.txt"/>
      <appendToFile value="true"/>
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] – %message%newline"/>
      </layout>
    </appender>
    <root>
      <level value="DEBUG"/>
      <appender-ref ref="FileAppender"/>
    </root>
  </log4net> 
```

ps 也检查一下这个答案：[Can a web.config read from an external xml file?](https://stackoverflow.com/questions/2411184/can-a-web-config-read-from-an-external-xml-file) 如果 web.config 不包含它，请确保您也部署了配置文件。

# php - 如何将php post数据从一个页面传送到另一个页面？

> ID：10826752
> 
> 赞同：2
> 
> 时间：2012-05-31T02:34:50.377
> 
> 标签：php

我有三页，我想让这个过程按这个顺序..

1) 用户在表单中输入电子邮件并点击回车

2) 有一个中间页面保留来自用户的相同电子邮件发布数据并将用户发送到邮件列表（与步骤 1 中的域相同）我确定我会使用 php 标头。

3）邮件列表接收邮件（不同域）

我真的不知道如何开始。有没有更好的办法？我只需要那个中间页面在那里......

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T02:38:09.247

简单地说：http: [//php.net/manual/en/features.sessions.php](http://php.net/manual/en/features.sessions.php)

> PHP 中的会话支持包括一种在后续访问中保留某些数据的方法。

您的中间页面将如下所示：

```
$_SESSION['myvar'] = $_POST['myvar']; 
```

现在，`$_SESSION['myvar']`可以在`session_start();`放置的任何页面上引用。

# jquery - 在网页中上传内容时，Processing.js 的 jQuery 插件在 chrome 中不起作用

> ID：10826755
> 
> 赞同：0
> 
> 时间：2012-05-31T02:34:53.600
> 
> 标签：jquery, processing.js

我是 jquery 的新手，我对将 jquery 与 Processing.js 一起使用有疑问

我在侧边栏上有一些链接；他们每个人都是一堂课，在其中一堂课中，我有一个

```
<p>blablablablabla</p>
<div id='processing'></div> 
```

()

然后，当用户点击课程（上面的内容）时，网页更新内容，并调用一个jquery插件，如果找到id #processing，则调用

```
$.Processing('#processing', 'afile.pde') 
```

（插件）

```
(function(){

var src = './processing-1.3.6.js'

$.Processing = function(parent, file){
    var appendScript = function(){
        $('head').append(function(){
            return $('<script></script>').attr('src', src).html('added processing script');
        })
    }

    var appendProcessing = function(){
        $(parent).append(function(){
            var $c = $('<canvas></canvas>');
            var p = Processing.loadSketchFromSources($c, [file])
            return  $c;
        });    
    }

    appendScript();
    appendProcessing();
}
}()) 
```

问题是函数'$('head')append 没有被调用。在 Chrome 上测试

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T17:37:09.897

**1) Processing.loadSketchFromSources 需要一个普通的 createElement 对象，而不是 jQuery 对象。所以你需要改变这一行：**

错误： var $c = $('<canvas></canvas>');
正确： var $c = document.createElement('canvas');

如果你真的需要 jQuery 对象，那么你需要使用 $c[0] 而不是 $c 从 jQuery 对象中获取纯 createElement，所以这也可以：
var p = Processing.loadSketchFromSources($c[0] ， [文件]）;

**2) 不要在脚本标签中使用 </script> 字符串，因为它会结束你的脚本：**

错误：返回 $('<script></script>')
正确：返回 $('<script></scr'+'ipt>')

**3) <script> 标签内的 html 是不需要的，因为脚本里面没有 html 代码：**
HTML not used: $('<script></scr'+'ipt>').attr('src', src).html('添加的处理脚本');
正确： $('<script></scr'+'ipt>').attr('src', src);

如果您想尝试查看代码，这是一个完整脚本正常工作的页面（加载和运行外部处理 .pde 文件）：http:
[//www.js.do/processing-js/gcravista-sample.htm](http://www.js.do/processing-js/gcravista-sample.htm)

# javascript - JavaScript innerHTML 不更新元素

> ID：10826756
> 
> 赞同：28
> 
> 时间：2012-05-31T02:35:09.997
> 
> 标签：javascript

这是一个非常简单的程序，输出应该是`JavaScript`，但我只得到`s`.

```
<html>
    <head>
        <title></title>
        <script type="text/javascript">
          document.getElementById("ma").innerHTML="JavaScript";
        </script>
    </head>
    <body>
        <h1 id="ma">s</h1>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-05-31T02:36:41.030

在您尝试设置值时，该元素不存在。您需要在`<h1>`添加到 DOM 后调用它。

您可以将此`<script>`标记进一步向下移动，或者将您的逻辑添加到应该在加载文档时调用的函数：

```
window.onload = function() {
    /* Add your logic here */
} 
```

演示：http: [//jsfiddle.net/Lr2Hm/](http://jsfiddle.net/Lr2Hm/)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-31T02:36:53.867

您必须等到 DOM 加载完毕。

```
window.onload = function(){
    document.getElementById("ma").innerHTML="JavaScript";
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-31T02:44:44.423

您有 2 个选择：

```
window.onload = function() {
  //your script here
} 
```

或者

```
<body>
    <h1 id="ma">s</h1>
    <script type='text/javascript'>
        //your script here
    </script>
</body> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-01-14T20:57:49.337

提供的选项对我不起作用。 `document.querySelector`为我工作！

例如：

```
document.querySelector("#ma").innerHTML = "HELLO"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-07T09:17:15.903

请注意，您使用 element.innerHTML="anything" 编写的任何内容都**将替换您 element 的实际内容**。如果要添加更多内容，则必须**将所有内容存储到累积变量**中，即元素的实际内容，以便保留它，然后在内容已满时将此变量解析为 innerHTML。

```
<script type=text/javascript">
var MyFullVar = element.innerHTML + "my new content I want to add";
element.innerHTML = MyFullVar;
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-07-04T07:18:26.400

您还可以`defer`在 DOM 初始化后将关键字与脚本一起使用来执行它

```
<script type=text/javascript" defer>/*Your script here*/</script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-17T20:26:18.907

你也可以这样做...

```
<script type=text/javascript">
    window.onload = function () {
        var element = document.getElementById('element').innerHTML;
        var content = ".........";
        element.innerHTML += content.toString();
    }
    </script> 
```

根据[w3schools](https://www.w3schools.com/jsref/prop_html_innerhtml.asp/)和基本的 JavaScript 规则，这是可行的。我以前也试过这个。

这以 onload 函数为基础，在启动时自动运行代码。它还利用 JS 赋值运算符来快速有效地执行代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-28T09:09:57.987

这个怎么样

```
function change(){
  document.getElementById("content").innerHTML = "Javascript";
}
```

```
<html>
<div>
<p id="content">TypeScript</p>
<button onclick="change()">Change</button>
</div>
</html>
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-25T02:03:34.113

只需将`script`标签放在底部即可。

```
<!doctype html>
<html>
<head>
Head Content here...
</head>
<body>
Body Content...
<script>
script function here...
</script>
</body>
</html> 
```

# vim - Vim Omnicomplete 键绑定的文档

> ID：10826758
> 
> 赞同：0
> 
> 时间：2012-05-31T02:35:16.783
> 
> 标签：vim, omnicomplete

Vim 中是否有带有 Omnicomplete 键绑定（Cx Co 等）的网页？网上好像找不到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T05:27:37.163

如果您在本地有它，为什么要在线搜索它？

```
:help ins-completion 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:41:53.860

给你，厕所怪胎：http: [//vimdoc.sourceforge.net/htmldoc/insert.html#ins-completion](http://vimdoc.sourceforge.net/htmldoc/insert.html#ins-completion)

# php - 循环移位关联数组？

> ID：10826760
> 
> 赞同：3
> 
> 时间：2012-05-31T02:35:54.070
> 
> 标签：php, associative-array

在 PHP 中工作，假设您有一个关联数组：

```
'Monday' => 'mon'
'Tuesday' => 'tue'
'Wednesday' => 'wed'
'Thursday' => 'thur'
'Friday' => 'fri'
'Saturday' => 'sat'
'Sunday' => 'sun' 
```

您如何执行“循环”数组移位？说改变事情，使阵列从星期三开始，并持续到所有 7 天，以星期二结束？

重要说明：我需要按键执行此操作，因为我有其他代码确定轮班需要从哪一天开始。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T03:05:41.903

无需循环

```
 $arr=array('Monday' => 'mon',
'Tuesday' => 'tue',
'Wednesday' => 'wed',
'Thursday' => 'thur',
'Friday' => 'fri',
'Saturday' => 'sat',
'Sunday' => 'sun');
//say your start is wednesday
$key = array_search("Wednesday",array_keys($arr));
$output1 = array_slice($arr, $key); 
$output2 = array_slice($arr, 0,$key); 
$new=array_merge($output1,$output2);
print_r($new); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T02:56:23.980

```
function curcle_shift($arr, $n) {
  return array_slice($arr, $n % 7) + array_slice($arr, 0, $n % 7);
}

// ex. shift the first 2.
var_dump(curcle_shift($arr, 2)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T02:43:24.173

在保持数组键的同时移动数组：

```
function shiftArray($arr, $key) {
    foreach ($arr as $k => $v) {
        if ($k == $key) break;
        unset($arr[$k]);
        $arr[$k] = $v;
    }
    return $arr;
}

print_r(shiftArray($arr, 'Wednesday'));
/*
Array
(
    [Wednesday] => wed
    [Thursday] => thur
    [Friday] => fri
    [Saturday] => sat
    [Sunday] => sun
    [Monday] => mon
    [Tuesday] => tue
)
 */ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-31T02:48:41.270

```
$key = array_keys($arr)[0]; // use a temporary variable in PHP before 5.4
$val = $arr[$key];
unset($arr[$key]);
$arr[$key] = $val; 
```

这将获取第一个键，保存其值，将其从数组中删除，然后再次添加（将其放在数组的末尾）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T03:25:21.943

通过引用切片、合并、处理。

```
function shiftArray( &$a, $k ) {
    $k = array_search( $k, array_keys( $a ) );
    $a = array_merge( array_slice( $a, $k ), array_slice( $a, 0, $k ) );
}

shiftArray( $week, "Wednesday" ); 
```

由于这是通过引用工作的，`$week`因此其本身已被重组。没有新数组。

演示：[http ://codepad.org/uITGdMKy](http://codepad.org/uITGdMKy)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-31T02:55:43.847

```
while (key($arr) !== $pivotKey) {
    list($k, $v) = each($arr);
    unset($arr[$k]);
    $arr[$k] = $v;
} 
```

在进入循环之前确保密钥存在。

# c++ - C ++ 11：使用单个范围循环有效地迭代矩阵？

> ID：10826763
> 
> 赞同：5
> 
> 时间：2012-05-31T02:36:06.557
> 
> 标签：c++, gcc, c++11

（对于具体的编译器/平台上下文，请在 x86_64 上使用 GCC 4.7 和 Ubuntu 12.04）

给定一些函数 f：

```
void f(int x, int y);

int nx = ...;
int ny = ...; 
```

迭代从 (0,0) 到 (nx,ny) 的每个值 (x,y) 的一种方法是：

```
for (int x = 0; x < nx; x++)
    for (int y = 0; y < ny; y++)
        f(x,y); 
```

让它编译为一些生成的代码 Q1。

我们将编写一个函数 g 使得：

```
for (auto it : g(Z))
    f(it.x, it.y); 
```

编译为代码 Q2。

是否可以编写 g 使得 Q2 与 Q1 一样有效？如果是，如何？如果不是，我们能得到的最接近的是什么？

如果有帮助，您可以将 auto 更改为 auto& 或 auto&&。

如果有帮助，您也可以将 it.x 更改为 it.x()，并将 it.y 更改为 it.y()。

（回想一下，基于范围的 for 的扩展只是您选择的类似迭代器的类型：[C++11：基于范围的 for 语句：“range-init”生命周期？](https://stackoverflow.com/questions/9657708/c11-the-range-based-for-statement-range-init-lifetime)）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T02:38:37.063

> 是否可以编写 g 使得 Q2 与 Q1 一样有效？如果是，如何？如果不是，我们能得到的最接近的是什么？

`for`当然可以，您只需要定义以与循环相同的方式递增的迭代器。从我的头顶：

```
class matrix_iterator
{
public:
    ...

    matrix_iterator& operator++()
    {
        if( ++y >= ny )
        {
            ++x;
            y = 0;
        }

        return *this;
    }

private:
    int nx, ny;
    int x, y;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:48:11.403

此代码具有您想要的功能。我还没有验证它，但我怀疑它会产生与原始循环几乎相同的机器代码（在优化编译中）。

```
struct iter {
    int x, y, ny;
    iter(int x, int y, int ny) : x(x), y(y), ny(ny) {}
    iter &operator++ () {
        if (++y >= ny)
        {
            y = 0;
            ++x;
        }
        return *this;
    }
    bool operator != (iter const &rhs) const {
        return y != rhs.y || x != rhs.x;
    }
};

struct container {
    iter endit;
    container(int nx, int ny) : endit(nx, ny, ny) {}
    iter begin() const { return iter(0,0,endit.ny); }
    iter const &end() const { return endit; }
};

container g(Z const &z) { return container(z.nx, z.ny); }

for ( auto it : g(Z) )
    f(it.x, it.y); 
```

# jquery - jquery插件未将插件代码主体应用于每个匹配的元素

> ID：10826775
> 
> 赞同：0
> 
> 时间：2012-05-31T02:37:58.143
> 
> 标签：jquery, jquery-plugins, coffeescript

我正在制作我的第一个文件上传器 jquery 插件（在 coffeescript 中）：

```
 $.fn.uploadable = (opts={}) ->
      console.log $(@).attr('type') # undefined
      event = if $(@).attr('type') is 'file' then 'change' else 'drop'
      @
      .on event, (evt) ->
        # do something
        off
      .on 'dragover', (evt) -> off

    $('#files_input, #drop_zone').uploadable 
```

所以你可以看到，在第一个 .on() 中，我正在确定事件的元素是否是浏览文件按钮；如果是，那么当用户选择文件时，该元素将被监听“更改”事件，如果否，那么我认为它是一些普通的旧 div 或用于 HTML5 拖放操作的东西。

所以我在一个 INPUT 元素和一个 DIV 元素上使用插件。正如您从我的 console.log 中看到的那样，记录了“未定义”

到目前为止，我只知道像 attr() 这样的调用方法，您只能从列出的选择器元素之一中获得结果。但是我需要为每个匹配的元素单独设置 .on(event) 的事件变量。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:16:26.153

通常的插件模式看起来像这样：

```
$.fn.plugin = function(options) {
    options = $.extend({ }, $.fn.plugin.defaults, options || { });
    return this.each(function() {
        // Do things to $(this) to set up your plugin.
    });
};
$.fn.plugin.defaults = { ... }; 
```

CoffeeScript 版本是：

```
$.fn.plugin = (options = { }) ->
    options = $.extend({ }, $.fn.plugin.defaults, options)
    @.each ->
        # Do things to $(@) to set up your plugin
$.fn.plugin.defaults = { ... } 
```

`return`部分`return this.each`是为您提供通常的链接，`this.each`部分是允许插件一次绑定到多个东西的部分。

应用这个你的案例会给你：

```
$.fn.uploadable = (opts = { }) ->
  @.each ->
    event = if $(@).attr('type') is 'file' then 'change' else 'drop'
    $(@)
      .on event, (evt) ->
        # do something
        off
      .on 'dragover', (evt) -> off 
```

# url - URL 不常见重定向

> ID：10826780
> 
> 赞同：0
> 
> 时间：2012-05-31T02:38:33.640
> 
> 标签：url, redirect

我们有一个带有 URL [http://smartwavestudios.com/](http://smartwavestudios.com/)的 WordPress 网站，当您打开 URL 时，它会正确重定向，但是当我输入[http://www.smartwavestudios.com/](http://www.smartwavestudios.com/)时，它会重定向到其他页面。为什么没有“www”的网址与带有“www”的网址不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:46:03.173

发生的事情是 DNS 服务器不会为您的 www 站点和非 www 站点返回相同的内容。虽然这通常会随着时间的推移而解决，即等待几天，但您也可以将以下内容添加到您的 .htaccess 文件中以解决问题。

```
Options +FollowSymLinks
RewriteEngine on
RewriteCond %{HTTP_HOST} ^yoursite.com [NC]
RewriteRule ^(.*)$ http://www.yoursite.com/$1 [L,R=301] 
```

# css - 使 HTML5 视频海报与视频本身大小相同

> ID：10826784
> 
> 赞同：107
> 
> 时间：2012-05-31T02:39:32.040
> 
> 标签：css, html, attributes, html5-video

有谁知道如何调整 HTML5 视频海报的大小，使其适合视频本身的确切尺寸？

这是一个显示问题的 jsfiddle：http: [//jsfiddle.net/zPacg/7/](http://jsfiddle.net/zPacg/7/)

这是代码：

HTML：

```
<video controls width="100%" height="100%"  poster="http://www.wpclipart.com/blanks/buttons/glossy_buttons/glossy_button_blank_orange_rectangle.png">
  <source src="http://demo.inwebson.com/html5-video/iceage4.mp4" type="video/mp4" />
  <source src="http://demo.inwebson.com/html5-video/iceage4.ogg" type="video/ogg" />
  <source src="http://demo.inwebson.com/html5-video/iceage4.webm" type="video/webm" />
</video>​ 
```

CSS：

```
video{
border:1px solid red;
}​ 
```

请注意，橙色矩形不会缩放到视频的红色边框。

此外，仅添加下面的 CSS 也不起作用，因为它会随着海报重新缩放视频：

```
video[poster]{
height:100%;
width:100%;
} 
```

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2015-06-25T07:43:05.423

根据您所针对的浏览器，您可以使用[object-fit](https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit)属性来解决此问题：

```
object-fit: cover; 
```

或者也许`fill`是你正在寻找的。仍在[考虑 IE](http://caniuse.com/#feat=object-fit)。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-06-01T15:27:05.893

您可以将透明海报图像与 CSS 背景图像结合使用来实现此目的（[示例](https://jsfiddle.net/ae28wvf1/)）；但是，要将背景拉伸到视频的高度和宽度，您必须[使用绝对定位的`<img>`标签](//stackoverflow.com/a/388817/1419007)（[示例](https://jsfiddle.net/h6c1do97/1/)）。

也可以在[支持](http://caniuse.com/#feat=background-img-opts)（[示例](https://jsfiddle.net/5qb3L82k/)） 的浏览器中[设置`background-size`为。`100% 100%`](//stackoverflow.com/a/4077153/1419007)[`background-size`](http://caniuse.com/#feat=background-img-opts)![](../Images/723c2a4a0b7bbf513544b1c07694ecf7.png)

* * *

# 更新

一个更好的方法是使用[`object-fit`](https://developer.mozilla.org/docs/Web/CSS/object-fit)@Lars Ericsson 建议的 CSS 属性。

利用

```
object-fit: cover; 
```

如果您不想显示不符合视频纵横比的图像部分，以及

```
object-fit: fill; 
```

拉伸图像以适应视频的纵横比

[例子](https://jsfiddle.net/h6c1do97/2/)

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2015-01-16T10:18:43.500

或者您可以使用简单`preload="none"`的属性使 VIDEO 背景可见。你可以`background-size: cover;`在这里使用。

```
 video {
   background: transparent url('video-image.jpg') 50% 50% / cover no-repeat ;
 }

 <video preload="none" controls>
   <source src="movie.mp4" type="video/mp4">
   <source src="movie.ogg" type="video/ogg">
 </video> 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2015-11-20T03:56:29.520

我一直在玩这个并尝试了所有解决方案，最终我采用的解决方案是来自 Google Chrome 的 Inspector 的建议。如果您将其添加到您的 CSS 中，它对我有用：

```
video{
   object-fit: inherit;
} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-03-16T12:04:41.603

我的解决方案结合了 user2428118 和 Veiko Jääger 的答案，允许预加载但不需要单独的透明图像。我们改用 base64 编码的 1px 透明图像。

```
<style type="text/css" >
    video{
        background: transparent url("poster.jpg") 50% 50% / cover no-repeat ;
    }
</style>
<video controls poster="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" >
    <source src="movie.mp4" type="video/mp4">
    <source src="movie.ogg" type="video/ogg">
</video> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-03-15T00:09:34.047

我想出了这个想法，并且效果很好。好的，所以基本上我们想从显示器中删除视频的第一帧，然后将海报调整为视频的实际大小。如果我们随后设置维度，我们就完成了其中一项任务。然后只剩下一个。所以现在，我知道摆脱第一帧的唯一方法是实际定义一张海报。然而，我们将给视频一个伪造的，一个不存在的。这将导致背景透明的空白显示。即我们的父 div 的背景将是可见的。

使用简单，但是如果您想将 div 的背景尺寸调整为视频的尺寸，它可能不适用于所有 Web 浏览器，因为我的代码使用的是“background-size”。

HTML/HTML5：

```
<div class="video_poster">
    <video poster="dasdsadsakaslmklda.jpg" controls>
        <source src="videos/myvideo.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>
<div> 
```

CSS：

```
video{
    width:694px;
    height:390px;
}
.video_poster{
    width:694px;
    height:390px;
    background-size:694px 390px;
    background-image:url(images/myvideo_poster.jpg);
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-11-17T20:34:46.527

```
<video src="videofile.webm" poster="posterimage.jpg" controls preload="metadata">
    Sorry, your browser doesn't support embedded videos.
</video> 
```

**覆盖**

```
video{
   object-fit: cover; /*to cover all the box*/
} 
```

**充满**

```
video{
   object-fit: fill; /*to add black content at top and bottom*/
   object-position: 0 -14px; /* to center our image*/
} 
```

> **请注意，视频控件在我们的图像**上，因此我们的图像没有完全显示。如果您使用的是适合对象的封面，请在 Photoshop 等视觉应用程序上编辑您的图像并添加边距底部内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-05-16T17:14:48.983

我有一个类似的问题，只是通过创建与我的视频 (16:9) 具有相同纵横比的图像来解决它。我在视频标签上的宽度设置为 100%，现在图像 (320 x 180) 非常适合。希望有帮助！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-26T09:31:04.563

您可以在生成拇指后调整图像大小

```
exec("ffmpeg -i $video_image_dir/out.png -vf scale=320:240 {$video_image_dir}/resize.png",$out2, $return2); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-11-04T11:13:36.513

您可以使用海报在移动设备（或不支持视频自动播放功能的设备）上显示图像而不是视频。因为移动设备不支持视频自动播放功能。

```
<div id="wrap_video">
<video preload="preload" id="Video" autoplay="autoplay" loop="loop" poster="default.jpg">
<source src="Videos.mp4" type="video/mp4">
Your browser does not support the <code>video</code> tag.
</video>
</div> 
```

现在，您可以通过媒体查询为移动设备的视频标签内的海报属性设置样式。

```
#wrap_video
{
width:480px;
height:360px;
position: relative;
} 
@media (min-width:360px) and (max-width:780px)
{
video[poster]
{
top:0 !important;
left:0 !important;
width:480px !important;
height:360px !important;
position: absolute !important;
}
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-11-14T03:28:27.133

不需要额外的div。

HTML：

```
<video controls width="100%" height="100%"  poster="http://www.wpclipart.com/blanks/buttons/glossy_buttons/glossy_button_blank_orange_rectangle.png">
  <source src="http://demo.inwebson.com/html5-video/iceage4.mp4" type="video/mp4" />
  <source src="http://demo.inwebson.com/html5-video/iceage4.ogg" type="video/ogg" />
  <source src="http://demo.inwebson.com/html5-video/iceage4.webm" type="video/webm" />
</video>​ 
```

CSS：

```
video[poster]{ object-fit:cover; }  /* or object-fit:fill */ 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-11-30T01:33:59.807

```
 <div class="container">
        <video poster="~/Content/WebSite/img/SiteSetting/Load.gif" autoplay muted loop class="myVideo">
            <source src="~/Content/WebSite/images/VideoTube.mp4" type="video/mp4" />
        </video>

    </div>

 <style>
    .myVideo {
position: absolute;
right: 0;
left: 0;
bottom: 0;
min-width: 100%;
min-height: 100%;
object-fit: inherit;
 }
@media only screen and (max-width:768px) {
.myVideo {
    position: absolute;
    right: 0;
    left: 0;
    bottom: 0;
    max-width: -webkit-fill-available;
    min-height: 100%;
    object-fit: cover;
    }
   }

     @media only screen and (max-width:320px) {
.myVideo {
    position: absolute;
    right: 0;
    left: 0;
    bottom: 0;
    max-width: -webkit-fill-available;
    min-height: 100%;
    object-fit: cover;
  }
}
</style> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-10-28T16:11:04.590

这有效

```
<video class="video-box" poster="/" controls>
    <source src="some source" type="video/mp4">
</video> 
```

和 CSS

```
.video-box{
 background-image: 'some image';
 background-size: cover;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-12-24T05:57:43.360

```
height:500px;
min-width:100%;
-webkit-background-size: 100% 100%;
-moz-background-size: 100% 100%;
-o-background-size: 100% 100%;
background-size:100% 100%;
object-fit:cover;

-webkit-background-size: cover;
-moz-background-size: cover;
-o-background-size: cover;
background-size:cover; 
```

# android - ADT eclipse xml布局文本编辑器 - 经常中断，直到文件关闭并重新打开

> ID：10826791
> 
> 赞同：18
> 
> 时间：2012-05-31T02:41:08.103
> 
> 标签：android, eclipse, eclipse-adt

> **可能重复：**
> [移动和消失的代码行；Eclipse 的 XML 编辑器的问题](https://stackoverflow.com/questions/10030727/moving-and-vanishing-lines-of-code-trouble-with-eclipses-xml-editor)

我是 Eclipse 和 ADT 的新手，但我在两台不同的机器上设置了我的环境，并且两者都显示相同的奇怪之处（都是 Windows 7 64 位）。

在图形布局和 main.xml 视图之间更改选项卡时，main.xml 视图中的代码行将开始消失或移动。没有视频或动画 gif 很难显示，但我会尝试使用这些屏幕截图：

请注意，我所做的只是突出显示一段文本，然后突然间所有这些伪影都出现了。它使开发变得不那么愉快。

有什么想法吗？请帮我解决这个问题。

图片 ：

![图片1](../Images/c83a71dfedcb2f1b7791e47d1221f4f3.png) ![图片2](../Images/818ccb48d03c4d33d87d8a457496b586.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-12T14:14:07.580

**找到了一个简单的方法来禁用这个错误！！（解决方法）**

Window > Preferences > Android > Editors > 取消勾选“Format XML files using the standard...”（第一个选项）

**然后，只需** `Ctrl + Shift + F` **将您的 XML 自动格式化为 Eclipse 内置约定。你根本不应该得到这个错误。**

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-10T17:41:21.607

我自己也遇到了这个问题，当 xml 编辑器执行此“操作”时转到源代码-> 清理文档，我将对话框上的复选框保持为默认值（除“将行分隔符转换为...”外均选中）并按下好的。

为我解决了这个问题。希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T14:01:44.440

看起来像是 Android 或 Eclipse ADT 的问题...请参阅下面的链接...

[http://code.google.com/p/android/issues/detail?id=30529](http://code.google.com/p/android/issues/detail?id=30529)

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=375421](https://bugs.eclipse.org/bugs/show_bug.cgi?id=375421)

为解决此问题，请将您的 ADT 更新到最低版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-11T09:09:44.470

我的工作解决方案是将 xml 布局文件的行分隔符转换为 Unix (LF, \n, 0A)。(File > Convert Line Del. To > Unix) 这只需要做一次。我没有更改以设置结尾的默认行。

ADT 不再弄乱代码，并且在手动编辑 xml 时，即使我将 windows 换行符设置为默认值，eclipse 也足够聪明，可以为此文件使用 Unix 换行符。

***问题的根源：***

问题是 ADT 插入了错误的换行符。例如。代码行之间有“\r\n\r\r\n”。注意双 \r 字符。

仅使用 Unix 换行符 (\r) 作为行分隔符时，ADT 工作正常。我还注意到在“图形布局”中工作时性能更好，并且 xml 元素之间没有多余的不必要的空行。

所以我猜 ADT 和 Eclipse 都存在错误，ADT 插入了错误的行尾，Eclipse 也因此而发疯。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-10T11:43:58.607

我也有同样的问题，我认为关闭文件并在再次清理后打开它是唯一的解决方案。

我发现这个问题只存在于 Eclipse Indigo。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-12T12:30:17.643

有时对我有用的一件事是执行 Ctrl+A、Ctrl+C、Ctrl+V。基本上，全选、复制和粘贴。这听起来很奇怪，但它通常可以解决问题，而无需做任何特别耗时的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-10T13:14:55.807

我有同样的问题。我所做的是删除了 Eclipse 和 ADT。然后升级到朱诺。新组合似乎为我解决了这个问题。我认为这是新 ADT 和 Indigo 的问题。

# java - Java BufferedImage，写入底层光栅，像素在最终图像中出现偏移

> ID：10826794
> 
> 赞同：10
> 
> 时间：2012-05-31T02:41:26.173
> 
> 标签：java, image-processing, bufferedimage, raster

为线程 necromancny 道歉，我试图制作一个缩减版本进行测试，它可以在这里找到

[https://www.dropbox.com/sh/y0wtlae37yltfz5/yRDSyKj2NY](https://www.dropbox.com/sh/y0wtlae37yltfz5/yRDSyKj2NY)

下载的最大部分是 src 文件夹中的 3 个示例图像（其中 2 个是医疗级眼底图像，所以它们有点大）。抱歉，如果解决方案的整体规模仍然有点大，但如果不认真重新考虑，我就无法将其缩小（我承认我有点睡眠不足，必须在 20 分钟内开始工作）。

我对问题的原始描述如下

*我的问题是这样的。我有一个`BufferedImage`人类视网膜，现在使用自适应阈值我已经成功地从眼睛中提取了血管结构，我的软件的其余部分处理绘制血管并确定它们的厚度，我相信这是正确的。最终结果显示所有坐标与它们的实际位置有相当程度的偏移（仔细观察，您可以看到一些正确连接的种子的曲率跟随血管，并且坐标跟随图像的圆周。我的问题是这个，是什么导致了这种偏移，我该如何补救？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T20:00:30.553

坐标没有偏移，但它们的比例是错误的：红色像素坐标被缩放 0.75（可能）。在 OdinVeinThicknessGen.java 的第 333 行尝试替换

```
wRast.setPixel(x6, y6, redVal); 
```

经过

```
wRast.setPixel(x6 * 4 / 3, y6 * 4 / 3, redVal); 
```

我不知道为什么，你应该更快地找到它，因为你比我更了解你的代码...... ;-)

* * *

请注意，在询问您的下一个问题时，您确实应该提供一个[简短、独立、正确（可编译）的示例](http://sscce.org/)（正如 Andrew 和 Steve 在他们的评论中所建议的那样），因为这需要大量工作（并且需要大量时间）这里的许多人没有或不想采取）如果你没有认识到你的问题。谢谢！

**编辑：**我只是看了你原来的问题（即在你编辑之前）。虽然它不包含 SSCCE，但它包含一些代码和有用的信息，以便更好地找到应用程序中的相关部分。在我看来，最好让问题保持原样，然后将链接添加到整个项目。红色像素更好识别（例如更大的点）的示例图像也会有所帮助。请不要误会我的意思，我只是想为您将来的问题提供一些输入... :-)

# node.js - 为什么 Geddy 不是基于 Connect 构建的？

> ID：10826795
> 
> 赞同：0
> 
> 时间：2012-05-31T02:41:38.950
> 
> 标签：node.js, express, connect, geddy

从这个演示[http://techwraith.github.com/presentations/2012/nodepdx](http://techwraith.github.com/presentations/2012/nodepdx)

作者陈述如下：

*   “连接也给你带来问题”
*   “连接缓冲一些响应”
*   “连接没有结构”
*   “Express 为您提供 Connect 的所有问题”

话虽如此，大多数节点框架都是建立在 Connect 之上的......

那么是什么让 Geddy 明显优于 connect 呢？
它的扩展性更好吗？
Connect 有问题吗？
除了框架的质量之外，上述论点是否与 2012 年相关？

注意：这不是 Express 与 Geddy，我们正在比较 node.js (connect<->geddy) 之上的薄层，它对框架的影响。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T06:26:55.463

Geddy 并不比 Connect / Express 好，最大的不同在于它的结构。就像@josh3736 在他的评论中所说，“Geddy 对你想要如何构建你的应用程序（如 Rails）做出了很多假设，这可能是也可能不是一件好事”。

Geddy 的作者不喜欢看到他看到的每个使用 Express 构建的项目的不同结构以及中间件功能是如何实现的，因此他决定制作 Geddy 并强制执行一个结构。

有关详细信息，请收听 NodeUp 的这一集：http: [//nodeup.com/seventeen](http://nodeup.com/seventeen)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T18:27:42.990

前面的答案基本正确，但真正的答案是 Geddy 早于 Connect。Node 内置的 HTTP 支持使得重写它以使用 Connect 没有任何实际价值。

# configuration - index 显示 httpd 中其他文件的内容

> ID：10826806
> 
> 赞同：0
> 
> 时间：2012-05-31T02:44:27.500
> 
> 标签：configuration, web-config, apache

我如何配置 http.conf 来做到这一点：

当我向 localhost/myfolder/index.html 请求时，它将显示 /myfolder/myfile.html 的内容

求帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T03:03:00.230

在 Apache 中，您可以使用[`Alias`](http://httpd.apache.org/docs/2.0/mod/mod_alias.html#alias)指令，例如：

```
Alias /myfolder/index.html /somewhere/myfolder/myfile.html 
```

或者你可以使用[`mod_rewrite`](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)，例如：

```
RewriteEngine On
RewriteRule ^/myfolder/index\.html$ /myfolder/myfile.html 
```

# jquery - 文本框中的自动完成 json

> ID：10826809
> 
> 赞同：-8
> 
> 时间：2012-05-31T02:44:59.160
> 
> 标签：jquery, autocomplete, textbox

下面是我的 json 输出：

```
{["0001000","0002000","0001200","00003000","990000","78888","89234","2345","2345"]} 
```

如何使用上述 json 数组在文本框字段中实现自动建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:49:21.553

恕我直言，您真的需要花一些时间来搜索和查看文档。

[jQuery UI](http://jqueryui.com/home)库已经提供了这个特性。

[http://jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)

您需要在 HTML 页面中包含 2 个脚本

1) jQuery 库

2) jQuery UI 库

**HTML**

```
<input id="tags">​ 
```

**Javascript**

```
$(function(){
    var availableTags=["0001000","0002000","0001200","00003000","990000","78888","89234","2345","2345"];
    $( "#tags" ).autocomplete({
            source: availableTags
    });

}); 
```

工作示例[http://jsfiddle.net/j9XBd/3/](http://jsfiddle.net/j9XBd/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T02:49:23.703

如果您使用的是 jQuery UI，[关于自动完成的 jQuery 文档很简单](http://jqueryui.com/demos/autocomplete/)。将您的阵列作为`source:`，它应该会自动工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T02:47:52.363

你应该去[jQueryUI 自动完成](http://jqueryui.com/demos/autocomplete/)

只需使用：

`["0001000","0002000","0001200","00003000","990000","78888","89234","2345","2345"];`

没有`{}`像下面这样：

```
var json  = ["0001000","0002000","0001200","00003000","990000","78888","89234","2345","2345"];

$('input:text').autocomplete(json, {

}); 
```

或者您可以自动设置来源

```
$(input:text).autocomplate({
   souce: SOURCE_TO_YOUR_STORE
}); 
```

# sql-server - 有扣除查询吗？

> ID：10826813
> 
> 赞同：-3
> 
> 时间：2012-05-31T02:45:52.287
> 
> 标签：sql-server

有没有办法在不知道更新查询中的原始值的情况下扣除某些值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T03:17:22.670

埃加兹。运算符仍然是减号 ( `-`)。所以：

```
UPDATE Item SET item_quantity = item_quantity - 5 WHERE ID = 1; 
```

在 SQL Server 2008 及更高版本中，支持新的速记：

```
UPDATE Item SET item_quantity -= 5 WHERE ID = 1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:49:40.833

是的，内置命令称为`-`：

```
SELECT item_quantity - 5 FROM item WHERE ID = 1 
```

# ruby-on-rails - Aptana 缩进和代码完成

> ID：10826814
> 
> 赞同：0
> 
> 时间：2012-05-31T02:45:57.250
> 
> 标签：ruby-on-rails, ruby, aptana3

我正在使用 Aptana 3 的独立版本进行 Ruby/Rails 开发。我不确定这是否是一个错误，但通常当我在完成打开命令后按 Enter 时，Aptana 将使用关闭代码完成。例如，如果我输入以下内容：

```
 def testMethod 
```

然后我按下回车键，Aptana 会自动为我缩进下一行，并在第三行放置一个“结束”。现在有时这个功能不起作用。有人知道吗？

# algorithm - 检查矩阵是否为奇异的快速方法？（不可逆，det = 0）

> ID：10826816
> 
> 赞同：10
> 
> 时间：2012-05-31T02:46:06.563
> 
> 标签：algorithm, matrix, matrix-inverse

检查一个小方阵（<16*16 个元素）是否为奇异（不可逆，det = 0）的最快算法是什么（链接到 C 或 C++ 示例会很酷）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-31T08:20:01.340

最好的方法是通过 SVD 计算[条件数](http://en.wikipedia.org/wiki/Condition_number)并检查它是否大于 1 / epsilon，其中 epsilon 是机器精度。

如果您允许假阴性（即矩阵有缺陷，但您的算法可能无法检测到它），您可以使用维基百科文章中的 max(a_ii) / min(a_ii) 公式作为条件数的代理，但是您必须首先计算 QR 分解（该公式适用于三角矩阵）：A = QR 与 R 正交，然后 cond(A) = cond(Q)。还有一些技术可以用 O(N) 操作计算 Q 的条件数，但有更复杂的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T04:32:13.453

我同意高斯消元法。[http://math.nist.gov/javanumerics/jama/doc/Jama/LUDecomposition.html](http://math.nist.gov/javanumerics/jama/doc/Jama/LUDecomposition.html)文档 LU 分解 - 从矩阵构造 LU 分解后，您可以调用其上的方法来获取行列式。我的猜测是，至少值得将其与任何更专业的方案进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-30T19:42:23.193

在 R 中，差异很接近，但 qr 分解胜出。尝试以下操作：

```
 Sig <- matrix(rnorm(16),4,4)

    a <- Sys.time()
    for(j in 1:1000){
      out <- svd(Sig)
      cond <- any(out$d < 1e-10)
    }
    Sys.time()-a

    a <- Sys.time()
    for(j in 1:1000){
      out <- qr(Sig)
      cond <- out$rank < NROW(Sig)
    }
    Sys.time()-a 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-05-31T04:24:35.647

*最快*的方法可能是为您希望处理的每个大小矩阵硬编码一个行列式函数。

这是 N = 3 的一些伪代码，但是如果您查看行列式的[莱布尼茨公式](http://en.wikipedia.org/wiki/Determinant#n-by-n_matrices)，则所有 N 的模式都应该是清晰的。

```
function is_singular3(matrix) {
    det = matrix[1][1]*matrix[2][2]*matrix[3][3]
        - matrix[1][1]*matrix[2][3]*matrix[3][2]
        - matrix[1][2]*matrix[2][1]*matrix[3][3]
        + matrix[1][2]*matrix[2][3]*matrix[3][1]
        + matrix[1][3]*matrix[2][1]*matrix[3][2]
        - matrix[1][3]*matrix[2][2]*matrix[3][1];

     if(det==0) return true
     else return false
} 
```

# javascript - 创建一个 javascript 文件

> ID：10826817
> 
> 赞同：-1
> 
> 时间：2012-05-31T02:46:25.517
> 
> 标签：javascript, jquery, asp.net-mvc-3, jqgrid

在 asp-mvc 中，我有一个包含以下内容的部分视图：

```
<table id="grid">
</table>
<div id="pager1">
</div>

<script language="javascript" type="text/javascript">
$('#grid').jqGrid({
    url: '/Employee/JsonEmployee',
    datatype: 'json',
    mtype: 'GET',
    colNames: ['NUMBER', 'NAME', 'ROLE', 'OPERATIONS'],
    colModel: [
{ name: 'NUMBER', index: 'number', width: 200, sortable: false, align: 'center' },
{ name: 'NAME', index: 'name', width: 300, sortable: false, align: 'center' },
{ name: 'ROLE', index: 'role', width: 200, sortable: false, search: false, align: 'center' },
{ name: 'OPERATIONS', index: 'operation', width: 200, sortable: false, search: false, align: 'center'}],
    rowNum: 10,
    rowList: [10, 20, 30],
    pager: '#pager1',
    sortname: 'number',
    viewrecords: true,
    sortorder: "desc",
    height: "100%",
    caption: "EMPLOYEES"
});
jQuery("#grid").jqGrid('navGrid', '#pager1', { del: false, add: false, edit: false }, {}, {}, {}, { width: 600 });

</script> 
```

它工作正常，但后来，我决定删除视图底部的脚本并将其放入 Scripts 文件夹中的 javascript(.js) 文件中：Local.js

```
function () {
$('#grid').jqGrid({
    url: '/Employee/JsonEmployee',
    datatype: 'json',
    mtype: 'GET',
    colNames: ['NUMBER', 'NAME', 'ROLE', 'OPERATIONS'],
    colModel: [
{ name: 'NUMBER', index: 'number', width: 200, sortable: false, align: 'center' },
{ name: 'NAME', index: 'name', width: 300, sortable: false, align: 'center' },
{ name: 'ROLE', index: 'role', width: 200, sortable: false, search: false, align: 'center' },
{ name: 'OPERATIONS', index: 'operation', width: 200, sortable: false, search: false, align: 'center'}],
    rowNum: 10,
    rowList: [10, 20, 30],
    pager: '#pager1',
    sortname: 'number',
    viewrecords: true,
    sortorder: "desc",
    height: "100%",
    caption: "EMPLOYEES"
});
jQuery("#grid").jqGrid('navGrid', '#pager1', { del: false, add: false, edit: false }, {}, {}, {}, { width: 600 });

  }; 
```

我在我的 _Layout.cshtml 中调用了脚本文件：

```
 <head>
    <meta charset="utf-8" />
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link href="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/Content/css")" rel="stylesheet" type="text/css" />
    <link href="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/Content/themes/base/css")" rel="stylesheet" type="text/css" />
    <script src="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/Scripts/js")"></script>

    <script src="@Url.Content("~/Scripts/i18n/grid.locale-en.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")" type="text/javascript"></script>
   <script src="@Url.Content("~/Scripts/Local.js")" type="text/javascript"></script>
    <meta name="viewport" content="width=device-width" />
</head> 
```

当我运行我的网络应用程序时，它不再工作了...... jqGrid 不再显示......问题可能出在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:55:40.337

您在 Local.js 中的代码永远不会执行，您可以在 dom 准备好时调用它`$(document).ready()`

```
$(document).ready(function () {
    $('#grid').jqGrid({
        url: '/Employee/JsonEmployee',
        datatype: 'json',
        mtype: 'GET',
        colNames: ['NUMBER', 'NAME', 'ROLE', 'OPERATIONS'],
        colModel: [
    { name: 'NUMBER', index: 'number', width: 200, sortable: false, align: 'center' },
    { name: 'NAME', index: 'name', width: 300, sortable: false, align: 'center' },
    { name: 'ROLE', index: 'role', width: 200, sortable: false, search: false, align: 'center' },
    { name: 'OPERATIONS', index: 'operation', width: 200, sortable: false, search: false, align: 'center'}],
        rowNum: 10,
        rowList: [10, 20, 30],
        pager: '#pager1',
        sortname: 'number',
        viewrecords: true,
        sortorder: "desc",
        height: "100%",
        caption: "EMPLOYEES"
    });
    jQuery("#grid").jqGrid('navGrid', '#pager1', { del: false, add: false, edit: false }, {}, {}, {}, { width: 600 });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T02:57:06.593

Local.js 文件中的函数没有名称...您没有调用该函数，因此 Local.js 中的所有内容都不起作用！您可以使用：

```
window.onload = function() {
  //your code here
} 
```

但不建议使用。你应该给你的函数命名并调用它们

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:07:16.550

好吧，我按照 Musa 所说的做了，但我没有在 _Layout.cshtml 中调用它，而是在我的视图中调用它......我的视图是一个局部视图，所以我猜它会受到那个影响（？）

# actionscript-3 - 错误 1120：访问未定义的属性

> ID：10826822
> 
> 赞同：0
> 
> 时间：2012-05-31T02:47:15.117
> 
> 标签：actionscript-3, flash-cs5

即使我已经在类中进一步定义了该函数，我在已加星标的行上的以下代码中收到访问未定义属性的错误：

```
package {

  import flash.display.Stage;
  import flash.events.Event;
  import flash.events.KeyboardEvent;
  public class Key{
    private static var initialized:Boolean = false;
    private static var keysDown:Object = new Object();
    private function initialize(stage:Stage){
      if(!initialized){
        stage.addEventListener(KeyboardEvent.KEY_DOWN, keyPressed);
        stage.addEventListener(KeyboardEvent.KEY_UP, keyReleased);
      **stage.addEventListener(Event.DEACTIVATE, clearKeys);**
        initialized = true;
      }
    }
    public static function isDown(keyCode:uint):Boolean {
      return Boolean(keyCode in keysDown);
    }
    Private static function keyPressed(event:KeyboardEvent):void {
      keysDown[event.keyCode] = true;
    }
    private static function keyReleased(event:KeyboardEvent):void{
      if(event.keyCode in keysDown){
        delete keysDown[event.keyCode];
      }
    }
    Private static function clearkeys(event:Event):void{
      keysDown = new Object():
    }
  }
} 
```

编辑：修复大写错误后弹出新错误（谢谢杰森）。谁能帮我这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T02:57:10.200

`Private`必须是小写才能成为访问修饰符关键字`private`。

如：

```
private static var initialized:Boolean = false; 
```

作为大写`Private`，编译器假定您正在引用命名空间“Private”，例如：

```
package
{
    import flash.utils.flash_proxy;
    import mx.core.mx_internal;

    use namespace arcane;

    public dynamic class X
    {
        flash_proxy var prop1:Boolean;

        mx_internal var prop2:Boolean;

        arcane var prop3:Boolean;
    }
} 
```

# android - Android：更改图案中的按钮颜色

> ID：10826832
> 
> 赞同：1
> 
> 时间：2012-05-31T02:48:27.480
> 
> 标签：android, button, time, colors, delay

我正在尝试为 Android 实现类似 Simon Says 之类的东西。这是我的代码：

```
for(int i = 1; i <= sequence.size(); i++){
handler.postDelayed(new Runnable(){
                    public void run(){
                        if (sequence.peek() == 1){
                            green.setPressed(true);
                            handler.postDelayed(new Runnable(){
                                public void run(){
                                    green.setPressed(false);                
                                    }
                            }, 1000);
                        }
                        else if (sequence.peek() == 2){
                            red.setPressed(true);
                            handler.postDelayed(new Runnable(){
                                public void run(){
                                    red.setPressed(false);               
                                    }
                            }, 1000);
                        }
                        else if (sequence.peek() == 3){
                            yellow.setPressed(true);
                            handler.postDelayed(new Runnable(){
                                public void run(){
                                    yellow.setPressed(false);               
                                    }
                            }, 1000);
                        }
                        else if (sequence.peek() == 3){
                            blue.setPressed(true);
                            handler.postDelayed(new Runnable(){
                                public void run(){
                                    blue.setPressed(false);             
                                    }
                            }, 1000);
                        }
                        int myNum = sequence.peek();
                        sequence.poll();
                        sequence.add(myNum);
                    }
                }, 1000);
            }
} 
```

基本上，我有一个队列（序列），其中包含闪烁按钮颜色的模式。（setPressed(true) 与 setPressed(false) 颜色不同） 第一次调用时，只有一个按钮需要更改颜色，因此可以正常工作。第二次调用时，2 个按钮颜色应该改变。我现在的代码将同时点亮两者。我如何使它首先闪烁一种按钮颜色，完成它，然后闪烁第二种按钮颜色？我已经尝试了一百万种不同的东西，这仍然是我得到的最接近的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T08:58:46.257

我的猜测是，在没有测试任何代码的情况下，这是因为你的 for 循环。基本上，它遍历所有序列，并以 1000 毫秒的延迟将可运行的内容发布到处理程序。

这意味着： i 为 0：sequence1 以 1000 毫秒开始；i 为 1：sequence1 也以 1000 毫秒开始；我是 2....

因为它在处理程序中，所以它不会影响 for 循环的运行时，这意味着所有迭代都直接在彼此之后传递，这导致每个 runnable 都“几乎”同时执行。

只需尝试将延迟设置为 (i+1)*1000，这样每个“按钮”都会在“他的时间”时被激活（一秒钟）。

# php - 用点声明的常量名称（SOME.CONSTANT）：如何访问？

> ID：10826834
> 
> 赞同：0
> 
> 时间：2012-05-31T02:48:40.760
> 
> 标签：php

如何在不使用“常量”函数的情况下访问名称用点声明的常量（例如：*SOME.CONSTANT*）？

主要原因是我可以像这样声明一个类属性：

```
class Classname {
  public $variable = SOME.CONSTANT; // Can't use "constant('SOME.CONSTANT')" here
} 
```

然而：我应该避免在常量名称中使用点的任何特殊原因？我刚开始使用它，所以我可以为常量创建某种“命名空间”，如*AUTHCONTROL.ACCESSLEVEL.ADMIN*

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T13:57:02.040

`_`在常量名称中用作命名空间分隔符可能会更好。例子包括`E_USER_ERROR`,`M_PI`等等。

# ios - Admob 插页式自家广告

> ID：10826836
> 
> 赞同：1
> 
> 时间：2012-05-31T02:48:43.753
> 
> 标签：ios, admob, interstitial

我已经实施 admob 试图让插页式房屋广告发挥作用。

```
interstitial_ = [[GADInterstitial alloc] init];
interstitial_.adUnitID = @"xxxMediationInterstitialID";
GADRequest *request = [GADRequest request];
request.testing = YES;    
[interstitial_ loadRequest:request]; 
```

当我将测试标志设置为是时，一切正常。我知道付费广告需要邀请您，但我想为应用内购买创建一个自家广告，以理想地删除广告。

我对 admob 网站上的创建插页式房屋广告部分感到困惑。似乎他们允许您为广告上传自定义横幅，但我不知道该怎么做。只是“第三方网址”。有没有办法让自家广告在我的测试中展示？我在哪里上传横幅？我确定它很简单，我只是找不到确切的位置/方法。有人做过吗？我应该将测试标志设置为否吗？（它总是说没有内容或什么......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T20:00:53.020

您需要设置 request.testing = NO，测试仅用于调试并确保您的实施正常工作 - 并确保您在开发时不会通过显示和点击自己的广告来违反 Google 规则。一旦您准备好发布您的应用程序，请确保将测试设置为否！

如果你实现了委托函数 didFailToReceiveAdWithError ，你可以对错误进行 NSLog 并查看为什么你没有收到任何广告 - 也许你所在的地区没有可用的广告？

对于自家广告，您必须将其上传到 admob 页面，并且他们会确保在您的应用请求广告时将其提供给您的应用。我还没有这方面的经验，所以我不能再给你介绍了。

但实际上我正在尝试在我的应用中做同样的事情——在没有插页式广告的情况下提供应用内购买。我在想（但不确定）自家广告不会转化为实现应用内购买的应用内函数调用。我在想我会尝试显示 AdMobs 插页式广告，如果失败，我会滑动我自己的视图，上面有我的应用内购买优惠和当前视图顶部的按钮。我还没有实现细节;-)

# xml - 构建 symfony 项目时出现 XML 错误

> ID：10826847
> 
> 赞同：1
> 
> 时间：2012-05-31T02:50:48.823
> 
> 标签：xml, symfony

构建 symfony2 项目时。显示视图问题流动。

说明：引用的文件包含错误 (http://www.doctrine-project.org/schemas/orm/doctrine-mapping.xsd)。有关更多信息，请右键单击问题视图中的消息并选择“显示详细信息...” 资源：Doctrine.Tests.Models.DDC117.DDC117Translation.dcm.xml 路径：/MySymfony/vendor/doctrine/tests/Doctrine/测试/ORM/Mapping/xml 位置：第 1 行类型：XML 问题

我认为 xml 文件中的链接（http://www.doctrine-project.org/schemas/orm/doctrine-mapping.xsd）死了。帮我解决这个错误 Eclipse 配置。

# android - 将 GPS 数据模拟到 Android AVD 不起作用

> ID：10826848
> 
> 赞同：-1
> 
> 时间：2012-05-31T02:50:56.530
> 
> 标签：android, eclipse, gps, avd

我希望有人可以帮助我解决在 Eclipse 中将模拟 GPS 数据发送到 Android AVD 时遇到的问题。如果我在真实设备上运行应用程序，一切正常，但是当我尝试在 eclipse 中使用内置模拟器时，什么都不会发生。我也尝试过远程登录到 AVD 并发出 geo fix 命令。下面是我正在使用的代码，虽然我认为如果它在真实设备上运行没有什么问题

清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="net.TestGoogleMaps"
android:versionCode="1"
android:versionName="1.0" >
    <uses-sdk android:targetSdkVersion="10" android:minSdkVersion="8"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"></uses-permission>  
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"></uses-permission>  
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".TestingGoogleMapsActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

   </application>
</manifest> 
```

主.xml

```
<?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:orientation="vertical"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
  >
</LinearLayout> 
```

主要代码

```
package net.TestGoogleMaps;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.location.Criteria;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.view.View;
import android.widget.TextView;
import android.widget.Toast;

public class TestingGoogleMapsActivity extends Activity 
{

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
        {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        LocationManager locationManager; 
        String context = Context.LOCATION_SERVICE; 
        locationManager = (LocationManager)getSystemService(context); 
        Criteria criteria = new Criteria(); 
        criteria.setAccuracy(Criteria.ACCURACY_FINE); 
        criteria.setAltitudeRequired(false); 
        criteria.setBearingRequired(false); 
        criteria.setCostAllowed(true); 
        criteria.setPowerRequirement(Criteria.POWER_LOW); 
        String provider = locationManager.getBestProvider(criteria, true); 

        Location location = locationManager.getLastKnownLocation(provider); 

        updateWithNewLocation(location);

        locationManager.requestLocationUpdates(provider, 2000, 10,    
                                               locationListener); 
    }

    private final LocationListener locationListener = new LocationListener() { 
        public void onLocationChanged(Location location) { 
          updateWithNewLocation(location); 
        } 

        public void onProviderDisabled(String provider){ 
          updateWithNewLocation(null); 
        } 

        public void onProviderEnabled(String provider){ } 
        public void onStatusChanged(String provider, int status,  
                                    Bundle extras){ } 
      };

    public void updateWithNewLocation(Location location)
    {

        Context contextApp = getApplicationContext();

        String text ;
        int duration = 2000;

        if(location == null)
        {
            text ="Null Location";

        }
        else
        {
            text = "Lat : " + location.getLatitude() + " Lon: " + location.getLongitude();
        }

        Toast toast = Toast.makeText(contextApp, text, duration);
        toast.show();
    }   
} 
```

在 eclipse 的 LogCat 选项卡中模拟 GPS 数据从 eclipse 到设备时，有时也会出现以下错误。

```
05-31 02:31:35.158: E/InputQueue-JNI(347): channel '406e6640  net.TestGoogleMaps/net.TestGoogleMaps.TestingGoogleMapsActivity (client)' ~ Publisher closed input channel or an error occurred.  events=0x8 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:09:45.037

我知道您的问题，您可以手动设置当前（长/滞后）

DDMS->Devices->Emulator Control->Location Controls->Manual->input (Long/Lag) and SEND

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T08:56:52.120

正如 Tanvir Ahmed 所说，它看起来像是[一个错误（来源）](http://code.google.com/p/android/issues/detail?id=13046)。我也为此绊倒了一天多。您可以尝试的是，对 AVM 使用“Google APIs - API Level 10”而不是“Android 2.3.3”。

# php - 拖放图像并将数据发布到 PHP

> ID：10826849
> 
> 赞同：1
> 
> 时间：2012-05-31T02:51:02.583
> 
> 标签：php, jquery

我正在使用[http://jsfiddle.net/28SMv/8/](http://jsfiddle.net/28SMv/8/)拖放图像。然后我需要从放置区域检索图像信息。我想为放置区域插入一个表格并想发布数据。

我怎样才能使用 PHP 做到这一点？有人有其他从放置区域检索图像信息（imageid）的示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T02:58:42.607

您要做的是创建一个表单并使用 javascript 创建隐藏的表单元素，这些元素将存储哪些图像已被拖动到哪个位置。当用户提交表单时，数据将被传递到您的脚本中，您可以在其中做任何您想做的事情。

这种隐藏元素的创建可以连接到拖放事件，以根据需要添加或删除元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T05:50:26.403

**脚本 ：**

```
$( "span").draggable({ revert: "invalid" });

        $( "#box1" ).droppable({
            accept: "#wrap1 span",
            drop: function( event, ui ) {
                id=ui.draggable.attr('id');
                $('#frm').append('<input type="text" value="'+id+'" id="i'+id+'"><br><br>');
                //or do what you want exactly like above code
            }
        });

        $( "#wrap1" ).droppable({
            accept: "#wrap1 span",
            drop: function( event, ui ) {
                id=ui.draggable.attr('id');
                $('#frm #i'+id).remove();
            }
        }); 
```

**网页：**

```
<style>
.custom-state-active { background: #eee; }

.left{
    float:left;
}
.right{
    float:left;
}

#wrap1{
    float:left;
    width:200px;
    border:1px solid red;
    height:100px;
    margin:10px;
    clear:both;
}
#box1{
    float:left;
    width:200px;
    border:1px solid green;
    height:100px;
    margin:10px;
    clear:both;
}
span{
    float:left;
    margin:3px;
    border:1px solid #0CF;
}

</style>
<div class="left">
    <div id="wrap1">
        <span id="img1">test1--->1</span>
        <span id="img2">test1--->2</span>
    </div>

</div>

<div class="right">
    <div id="box1"></div>
</div>

<form id="frm" style="float:left; margin:10px;" action="test.php" method="post">
</form> 
```

演示：http: [//jsfiddle.net/3qJdp/](http://jsfiddle.net/3qJdp/)

放置成功后，您可以创建/删除表单元素（使用隐藏的输入框）。最后，您可以发布表格日期。

我希望这对你有一点帮助

# java - 带有货币符号的 Java String.format

> ID：10826850
> 
> 赞同：16
> 
> 时间：2012-05-31T02:51:14.160
> 
> 标签：java, locale

以下形式的一些**现有代码**用于格式化数值：

```
String.format( pattern, value ) 
```

请注意，我**不能更改代码本身**- 我只能更改提供给代码的格式模式。

为默认语言环境输出货币符号的格式模式是什么？本质上，我想实现以下输出：

```
String.format( "...", 123 )  => $ 123 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-31T03:14:15.563

无需重新发明轮子。[`DecimalFormat`](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)带有货币支持：

```
String output = DecimalFormat.getCurrencyInstance().format(123.45); 
```

这还带有完整的语言环境支持，可以选择传入 a [`Locale`](http://docs.oracle.com/javase/6/docs/api/java/util/Locale.html)：

```
String output = DecimalFormat.getCurrencyInstance(Locale.GERMANY).format( 123.45); 
```

这是一个测试：

```
System.out.println(DecimalFormat.getCurrencyInstance().format( 123.45) );
System.out.println(DecimalFormat.getCurrencyInstance(Locale.GERMANY).format( 123.45)) ; 
```

输出：

```
$123.45
123,45 € 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T03:02:38.850

您可以尝试以下方法：

```
public static void main(String[] args) {
    System.out.println(String.format(" %d \u20AC", 123)); // %d for integer
    System.out.println(String.format(" %.2f \u20AC", 123.10)); // %f for floats
} 
```

这打印：

```
123 €
123.10 € 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-31T05:17:44.327

以您给出的限制，我认为不可能实现它。要获取当前区域设置的货币符号，您需要最少的代码。

如果您绝对没有办法在程序中添加代码，您最好使用已建立的符号来表示“[货币](http://en.wikipedia.org/wiki/Currency_%28typography%29)”（¤）。它是为了这个确切的目的而建立的，以象征没有任何更具体符号的货币。

如果您不能更改给定的代码，而是将代码作为一个整体添加到项目中，您可以使用它来找出最适合使用的符号。拥有它后，您可以使用它为现有代码创建用于格式化的模式。

如果您可以找出原始程序接下来将在哪个语言环境中运行，您可以编写一个使用该设置来填充您的配置的助手程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-27T06:27:01.723

如果没有可用的默认语言环境，我们可以使用 unicode 和十进制格式设置货币符号。如以下代码所示：

例如设置印度货币符号和格式化值。这无需用户更改设置即可工作。

```
Locale locale = new Locale("en","IN");
DecimalFormat decimalFormat = (DecimalFormat) DecimalFormat.getCurrencyInstance(locale);
DecimalFormatSymbols dfs = DecimalFormatSymbols.getInstance(locale);
dfs.setCurrencySymbol("\u20B9");
decimalFormat.setDecimalFormatSymbols(dfs);
System.out.println(decimalFormat.format(12324.13)); 
```

输出：

```
₹12,324.13 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-05-31T03:12:04.800

```
 String formatstring=String.format("$%s", 123);
    System.out.println(formatstring); 
```

# ruby-on-rails - CoffeeScript 未在 Rails 3.1 中更新

> ID：10826853
> 
> 赞同：1
> 
> 时间：2012-05-31T02:52:07.353
> 
> 标签：ruby-on-rails, configuration, coffeescript

我正在开发一个使用 CoffeeScript 的 Rails 3.1 应用程序。作为一名新的 Rails 开发人员，我一直在对一些配置进行更改，以尝试充分利用资产管道和 Heroku。

但是，我现在处于这样一个位置，无论我对 app/assets/javascripts/*.js.coffee 文件进行什么更改，本地 Rails 开发服务器都拒绝接收这些更改并重新编译应用程序。我可以触发重新编译 .js.coffee 文件的唯一方法是停止 WEBrick 并重新启动它。

然而，这个问题似乎并不影响我对 Heroku 的推动。那些似乎重新编译就好了。

我的设置的一些细节：

*   我不使用 rake assets:precompile 在本地编译资产。[相反，我使用此处](https://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar)描述的“#2 在 slug 编译期间编译资产”方法。
*   我的 Gemfile 的相关部分如下所示：

    ```
    宝石'导轨'，'3.2.3'
    宝石“耙子”，“0.9.2.2”
    gem 'activesupport', '~> 3.2.3'
    宝石'json'

    组：资产做
      gem 'sass-rails', '~> 3.2.3'
      宝石'咖啡轨'，'〜> 3.2.1'
      ..
    结尾

    ```

*   我的 config/environments/development.rb 有这些相关的（我认为）行。如果这里的某些东西看起来很奇怪，我真的不记得为什么要进行更改（尽管也许我在我的 SCM 中记录了一些内容）。

```
  config.consider_all_requests_local = true
  config.action_controller.perform_caching = false

  # 将弃用通知打印到 Rails 记录器
  config.active_support.deprecation = :log

  # 只使用浏览器内置的最佳标准支持
  config.action_dispatch.best_standards_support = :builtin

  # 不压缩资源
  config.assets.compress = false

  # 扩展加载资源的行
  config.assets.debug = true

  config.assets.compile = true

  config.serve_static_assets = true

  # 为资产 URL 生成摘要
  config.assets.digest = true

```

关于寻找什么的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T12:51:28.587

删除 config.assets.compile、config.serve_static_assets 和 config.assets.digest 后，CoffeeScript 编译再次工作。

# web-services - Adobe Flex 4.6 具有相同 WebService 对象的多个操作

> ID：10826859
> 
> 赞同：0
> 
> 时间：2012-05-31T02:52:48.043
> 
> 标签：web-services, flash, apache-flex

我的 flex 应用程序中有支持多种操作的 WebService。我正在尝试对这些操作使用相同的 web 服务实例。但是，一旦我使用不同的操作，我就会从服务器返回失败。在网络监视器中进行检查时，我看到 SoapAction HTTP 标头从未更新为第二个操作所需的标头。根据 adobe docs，这应该是可能的，但似乎对我不起作用。我的代码如下。如果有人能指出解决方案，那将非常有帮助。

```
// main.mxml

public var ws:WebService;
public var op1:CallResponder = new CallResonder();
public var op2:CallResponder = new CallResonder();

// triggered on creationComplete Event
public function initWebsvc()
{
    ws = new WebService();
    ws.loadWsdl("http://www.examplesvc.com/test.asmx?wsdl");
}

protected function submit_ClickEventHandler(event:MouseEvent):void
{
    op1.addEventListener(ResultEvent.RESULT, op1_resultHandler);
    op1.token = ws.operation1();
}

protected function op1_resultHandler(event:ResultEvent):void
{
    op2.addEventListener(ResultEvent.RESULT, op2_resultHandler);
    op2.token = ws.operation2();  // This fails
}

protected function op2_resultHandler(event:ResultEvent):void
{
    Alert.show("SUCCESS");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T07:52:10.863

我认为这是因为有两个 WebService 实现。一种在 mx.rpc.soap 中实现，另一种在 mx.rpc.soap.mxml 中实现。第二个不仅实现了 IMXMLObject 接口（以便在 MXML 中正确使用它），而且还提供了额外的功能，例如并发性（就像所有 rpc 服务一样）。

这背后的想法是，在 MXML 中定义的服务只是一个实例，将被重用。你不能实例化更多的实例。在 ActionScript 中，您可能会创建大量实例。

因此，在 ActionScript 中使用 Web 服务时，请使用 mx.rpc.soap.mxml 实现并将并发属性设置为“多个”。

[mx.rpc.soap.mxml.WebService](http://help.adobe.com/de_DE/FlashPlatform/reference/actionscript/3/mx/rpc/soap/mxml/WebService.html)与[mx.rpc.soap.WebService](http://help.adobe.com/de_DE/FlashPlatform/reference/actionscript/3/mx/rpc/soap/WebService.html)

# image - 在使用 VBScipt 打开的 IE 窗口中显示图像

> ID：10826865
> 
> 赞同：1
> 
> 时间：2012-05-31T02:53:55.183
> 
> 标签：image, internet-explorer, vbscript

我正在使用 VBScripta 创建一个新的 Internet Explorer 窗口并显示一个表单。我想将图像添加到 IE 窗口，但我无法添加任何图像。取而代之的是一个带有小十字的框。[我在“在 VBScript MsgBox 中显示图像](https://stackoverflow.com/questions/7172431/having-trouble-displaying-a-image-in-vbscript)”找到了类似的查询，但提供的解决方案从网络加载图像（它的工作），但我希望它从本地文件夹（不工作）。有人可以帮我解决这个问题吗？非常感谢 ：）

```
Set objIE = CreateObject("InternetExplorer.Application")  
With objIE     
 .Navigate "C:\Users\NA34242\Documents\SAP\Pages\GetTRs.html"     
 .ToolBar = False     
 .StatusBar = False     
 .Left = 100     
 .Top = 100     
 .Width = 200     
 .Height = 200     
 .Visible = True     
 .Document.Title = "Form"     
 .Document.Body.InnerHTML =  "<img src=""C:\images.png"" height=100 width=100>" 
End With 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T12:27:34.513

很抱歉，这种方法不适用于大多数浏览器，这是一个安全问题，您只能将 uri 用于 IMG.src 您可以做的是导航到文件本身并使其可见，如果您需要其他页面上的东西你必须在另一个框架中做。

这是我采用的一个脚本，用于显示来自我的位置 c: 驱动器的图像。使用 show sub 可以显示文本但不能显示 IMG

```
dim oIe
InitIE 500, 500
oIe.navigate "file:///C|/Users/peter/butterfly.png"
'--- ---'
Sub InitIE(iWidth,iHeight)
  Dim iLeft, iTop
  On error resume next
  Set oIe = WScript.CreateObject("InternetExplorer.Application", "IE_")
  If Err.Number <> 0 Then
    WScript.CreateObject("WScript.Shell").Popup("Error:" & Err.description)
    Wscript.Quit
  Else
    With oIe
      .Visible = False
      .TheaterMode = True
      .FullScreen = True
       iLeft = (.width - iWidth) / 2
       iTop = (.Height - iHeight) / 2
      .FullScreen = False
      .TheaterMode = False                            
      .MenuBar = True
      .ToolBar = False
      .StatusBar = True
      .AddressBar = False
      .navigate "about:blank"
      .Width = iWidth
      .Height = iHeight
      .Left = iLeft
      .Top = iTop
      .Resizable = True
      .Visible = True
      .document.focus()                                
    End With
  End If
End Sub
'--- ---'
Sub Show(ByVal sText)
  If IEReady() Then 
    oIe.Document.body.innerHTML = oIe.Document.body.innerHTML & sText & "<br>"
    iLengte = iLengte + 300
    oIe.Document.parentWindow.scroll 0, iLengte
  End If
End Sub
'--- ---'
Function IEReady()
  IEReady = False
  If TypeName(oIe) <> "Object" Then
    If oIe.ReadyState = 4 Then
      IEReady = True
    End If
  End If
End Function
'--- ---'
Sub CloseIE
  oIe.Quit
  Set oIe = Nothing
End Sub 
```

# php - Recess框架，关系“in”不存在

> ID：10826866
> 
> 赞同：0
> 
> 时间：2012-05-31T02:54:01.173
> 
> 标签：php, recess

我正在使用 php 中的凹槽框架为我的 iPhone 应用程序编写 Web 服务。我正在使用如下代码来获取我给的数组中那个国家的记录，

```
 $testtable = new testTable();
 $countryArray = $decoded_params["country"];
 $records = $testtable->in('country', $countryArray); 
```

但是当我使用这些代码说“in”关系不存在时发生了错误。有人遇到过这个问题吗？如果我做错了，我怎么能做一个“in”查询？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T19:30:43.887

我很确定这是在某个时候添加的。

你最好的选择是从 github repo 克隆最新版本 - [https://github.com/recess/recess](https://github.com/recess/recess)

你也可以试试这个：

```
$records = $testtable->in('country', implode(',',$countryArray)); 
```

# c - 我们什么时候需要 C 中的缓冲区？

> ID：10826869
> 
> 赞同：3
> 
> 时间：2012-05-31T02:54:15.323
> 
> 标签：c

我正在阅读其他人的代码，看到很多人使用像 BUFFER_SIZE 这样的宏作为宏。问题是，许多程序可以在没有这个缓冲区的情况下编写。那么我们什么时候需要缓冲，什么时候不需要呢？我的意思是，为什么我们需要一个缓冲区？以及如何正确使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T03:04:39.483

来自维基百科：

> 缓冲区是物理内存存储的一个区域，用于在数据从一个地方移动到另一个地方时临时保存数据。

话虽如此，我觉得缓冲区有一些具体的用途：

*   将异步数据源转换为同步数据源：这是一个很大的问题，很多 API 都是以这种思维方式构建的。例如，假设您正在读取一个天生就容易出错的数据源。异步地，您有一个可能在某些时候失败的流，但您可以请求再次读取数据。这种数据处理是一个非常低级的细节，您不希望高级程序员担心它。解决方案是编写一个管理流的低级处理程序，并在数据被安全读入后将数据放入缓冲区。例如，您会在文件系统、网络协议等中看到缓冲区的这种使用......

*   传递大量数据：如果你想在多人之间共享数据，你需要一个临时的地方来存储数据以在人与人之间进行调解。

*   复制东西/进行破坏性操作：如果您需要释放一个指针并在内存中移动某些东西（无论出于何种原因），您可以将数据放在一个临时保存位置。一个常见的情况是我正在做一些破坏性操作字符串之类的事情：我无法操作原始字符串，我需要复制它，所以如果其他人持有它，我不会破坏指针.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T03:00:39.763

缓冲区只是一块数据，您需要多少以及何时需要它取决于任务。涉及缓冲区的最常见操作是文件 I/O 和数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:03:38.830

有时，它被用来吸收一些网络抖动。你可以在 Youtube 上流畅地观看电影的原因是你的浏览器首先将一些数据下载到缓冲区中，然后再播放。

# django - 由于 libpq-dev 中的依赖错误，无法安装 psycopg2

> ID：10826870
> 
> 赞同：0
> 
> 时间：2012-05-31T02:54:16.407
> 
> 标签：django, postgresql, pip, psycopg2, libpq

我一直在尝试安装 psycopg2 以在 virtualenv 中使用。我设法发现它取决于`libpq-dev`（因为 pip 给我一个`Error: pg_config executable not found.`错误）可以使用`apt-get install libpq-dev`.

但是，我所有的安装尝试`libpq-dev`都导致了以下错误：

```
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Some packages could not be installed. This may mean that you have
requested an impossible situation or if you are using the unstable
distribution that some required packages have not yet been created
or been moved out of Incoming.
The following information may help to resolve the situation:

The following packages have unmet dependencies:  
 libpq-dev : Depends: libkrb5-dev but it is not going to be installed
E: Broken packages 
```

谁能解决这个问题？

## 来源.list

```
# deb cdrom:[Debian GNU/Linux 6.0.1a _Squeeze_ - Official amd64 NETINST Binary-1 20110320-15:00]/ squeeze main

#deb cdrom:[Debian GNU/Linux 6.0.1a _Squeeze_ - Official amd64 NETINST Binary-1 20110320-15:00]/ squeeze main

deb http://ftp.us.debian.org/debian/ squeeze main
deb-src http://ftp.us.debian.org/debian/ squeeze main

deb http://security.debian.org/ squeeze/updates main
deb-src http://security.debian.org/ squeeze/updates main

# squeeze-updates, previously known as 'volatile'
deb http://ftp.us.debian.org/debian/ squeeze-updates main
deb-src http://ftp.us.debian.org/debian/ squeeze-updates main

# Backports repository
deb http://backports.debian.org/debian-backports squeeze-backports main contrib non-free

# RabitMq
deb http://www.rabbitmq.com/debian/ testing main 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T04:56:51.567

尝试将“contrib non-free”添加到每个来源。我认为这是因为这些软件包未列在您在 sources.list 中的来源中。尝试像这个例子一样改变每一行：

```
deb http://ftp.us.debian.org/debian/ squeeze main contrib non-free
deb-src http://ftp.us.debian.org/debian/ squeeze main contrib non-free

deb http://security.debian.org/ squeeze/updates main contrib non-free
deb-src http://security.debian.org/ squeeze/updates main contrib non-free

deb http://ftp.us.debian.org/debian/ squeeze-updates main contrib non-free
deb-src http://ftp.us.debian.org/debian/ squeeze-updates main contrib non-free 
```

这对我有用。我希望它也对你有用......

如果这对你没有帮助，你可以试试[这个](https://serverfault.com/questions/204558/libpq-dev-has-unmet-dependencies)。如果您指定要安装的数据包版本，它似乎可以工作，如下所示：

```
apt-get install libpq-dev=8.4.5-2~bpo50+1 
```

让我知道这是否有效！最良好的祝愿！

# asp.net - jqGrid 不显示行

> ID：10826875
> 
> 赞同：0
> 
> 时间：2012-05-31T02:55:03.623
> 
> 标签：asp.net, jqgrid, wcf-rest

我正在尝试在 jqGrid (4.3.2) 中显示行但还没有成功。我的网络服务响应是：

```
{"d":
{"__type":"JSONResponse:pe",
 "ActionType":null,
 "JSONData":"
            {\"total\":1,
             \"page\":1,
             \"records\":5,
             \"rows\":[
                       {\"invid\":1,\"cell\":[{\"invid\":1,\"amount\":500,\"tax\":65,\"total\":565,\"note\":\"myNote 0\"}]},
                       {\"invid\":2,\"cell\":[{\"invid\":2,\"amount\":510,\"tax\":75,\"total\":585,\"note\":\"myNote 1\"}]},
                       {\"invid\":3,\"cell\":[{\"invid\":3,\"amount\":520,\"tax\":85,\"total\":605,\"note\":\"myNote 2\"}]},
                       {\"invid\":4,\"cell\":[{\"invid\":4,\"amount\":530,\"tax\":95,\"total\":625,\"note\":\"myNote 3\"}]},
                       {\"invid\":5,\"cell\":[{\"invid\":5,\"amount\":540,\"tax\":105,\"total\":645,\"note\":\"myNote 4\"}]}
                      ]
            }",
 "Status":false
} 
```

} <- （假设上面代码中的这个花括号）

我的网格配置如下所示：-

```
<script type="text/javascript">
    $(document).ready(function () {

        gridConfig();

    });

    function gridConfig() {
        var request = JSON.stringify(requestData());
        var jsonResponse;

        $("#list").jqGrid({
            url: '/ScriptServices/JsonService.svc/Process',
            ajaxGridOptions: { contentType: 'application/json; charset=utf-8' },
            datatype: 'json',
            postData: { request: function () { return request; } },
            mtype: 'GET',
            colNames: ['Inv No', 'Amount', 'Tax', 'Total', 'Notes'],
            colModel: [
                    { name: 'invid', index: 'invid', width: 55 },
                    { name: 'amount', index: 'amount', width: 80, align: 'right' },
                    { name: 'tax', index: 'tax', width: 80, align: 'right' },
                    { name: 'total', index: 'total', width: 80, align: 'right' },
                    { name: 'note', index: 'note', width: 150, sortable: false }
                  ],
            pager: $('#pager'),
            rowNum: 10,
            rowList: [10, 20, 30],
            sortname: 'invid',
            sortorder: 'desc',
            viewrecords: true,
            jsonReader: {
                root: "d.JSONData.rows",
                page: "d.JSONData.page",
                total: "d.JSONData.total",
                records: "d.JSONData.records",
                cell: "cell",
                id:0
            },
            caption: 'My first grid'
        });

    };

    function requestData() {
        var request;
        request = {
            ActionType: 'GET_GRID_DATA',
            RequestJSONData: '{ }'
        };
        return request;
    }

</script> 
```

我无法找到问题。是否需要任何其他格式。请帮忙..

**更新1：**

现在我的数据在 Oleg 建议后以正确的 json 格式出现，但是由于我的 json 数据中的 __type 额外字段，它无法正确呈现。

修改后的 json 数据如下所示：-

```
{
"d":
    {"__type":"JSONResponse:pe",
     "ActionType":"GRID_RESP",
     "JSONData":
                {"__type":"JQGridJSONReader:pe",
                "total":1,
                "page":1,
                "records":5,
                "rows":[
                        {"__type":"InvoiceGrid:pe",
                        "invid":1,
                        "cell":[{"__type":"JqGridCell:pe","invid":1,"amount":500,"tax":65,"total":565,"note":"myNote 0"}]},
                        .... and More Rows
                        ]
                },
     "Status":true
} 
```

} <- （假设上面代码中的这个花括号）

我已经检查了这个[链接](https://stackoverflow.com/q/627356/907176)并实现了默认的构造函数建议，`protected internal`在我的情况下是不可能的。

我的服务配置如下所示：

```
<system.serviceModel>
    <services>
        <service name="JsonService" behaviorConfiguration="JsonServiceAspNetAjaxBehavior">
            <endpoint address="" behaviorConfiguration="JsonServiceEndPointBehavior"
                binding="webHttpBinding" contract="JsonService" />
        </service>
    </services>
    <behaviors>
        <endpointBehaviors>
            <behavior name="JsonServiceEndPointBehavior">
                <enableWebScript/>
              <dataContractSerializer ignoreExtensionDataObject="true" />
            </behavior>
        </endpointBehaviors>
        <serviceBehaviors>
            <behavior name="JsonServiceAspNetAjaxBehavior">
                <serviceMetadata httpGetEnabled="true"/>
                <serviceDebug includeExceptionDetailInFaults="true" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true"
        multipleSiteBindingsEnabled="true" />
</system.serviceModel> 
```

如果我申请`<webHttp/>`，`endpointBehaviors`我会收到“UriTemplate 查询值的变量必须具有可以由 'QueryStringConverter' 转换的类型”错误。

我的网络服务看起来像这样：-

```
[ServiceContract(Namespace = "http://www.abhishek.com/portal/json")]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
public class JsonService
{
    [OperationContract]
    [WebInvoke(Method = "GET", RequestFormat = WebMessageFormat.Json,
        ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    [GenerateScriptType(typeof(JsonService), ScriptTypeId = "JsonService1")]
    public PresentationEntities.JSONResponse Process(PresentationEntities.JSONRequest request)
    {
        JSONResponse response;

        try
        {
            if (request == null)
            {
                throw new ArgumentNullException("request", string.Format(ExceptionHelper.ARG_NULL_EXP_MSG, "JSONManager"));
            }
            else
            {
                JQGridTransalator gridtransalator = new JQGridTransalator();
                response = gridtransalator.JQGridToJSONResponse(); // fill response.JSONData with JQGridJSONReader
            }
        }
        catch (Exception)
        {
            throw;
        }

        return response;
    }} 
```

JQGridJSONReader 看起来像这样：-

```
[DataContract(Name = "JQGridJSONReader", Namespace = "pe")]
public class JQGridJSONReader
{
    public JQGridJSONReader()
    {

    }

    [DataMember(Name = "total", Order = 1)]
    public int Total { get; set; }

    [DataMember(Name = "page", Order = 2)]
    public int Page { get; set; }

    [DataMember(Name = "records", Order = 3)]
    public int Records { get; set; }

    [DataMember(Name = "rows", Order = 4)]
    public List<InvoiceGrid> Rows { get; set; }
} 
```

从 json 数据中删除 __type 的任何建议。

**更新2：**

更新代码以便我可以更清楚地回答我的问题

```
[DataContract(Name = "InvoiceGrid", Namespace = "pe")]
public class InvoiceGrid
{
    [DataMember(Name = "cell", Order = 2)]
    public List<JqGridCell> Cell { get; set; }
}

[DataContract(Name = "JqGridCell", Namespace = "pe")]
public class JqGridCell
{
    [DataMember(Name = "invid", Order = 1)]
    public int Invid { get; set; }

    [DataMember(Name = "invdate", Order = 2)]
    public DateTime InvDate { get; set; }

    [DataMember(Name = "amount", Order = 3)]
    public double Amount { get; set; }

    [DataMember(Name = "tax", Order = 4)]
    public double Tax { get; set; }

    [DataMember(Name = "total", Order = 5)]
    public double Total { get; set; }

    [DataMember(Name = "note", Order = 6)]
    public string Note { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T06:06:28.060

您的错误是您将对象与数据`d.JSONData`从对象序列化到 JSON**两次**。可能您手动使用了一些 JSON 序列化而不是使用对象，并允许 .NET 序列化数据本身。

您如何查看`d.JSONData.rows`无法访问的数据，因为`d.JSONData`它是*字符串*而不是具有`rows`属性的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T18:20:56.983

更正的第一个错误：- 正如@Oleg 所建议的，我将 JSONData（为字符串格式）转换为 json 对象。这是由于在发送数据之前使用了 JSON 序列化。

第二个错误更正：-

我的单元格类型是这样的：`List<GridData>`并且 GridData 具有单元格内容（即复杂类型`GridData`）。所以我得到了这个

`"cell":[{"__type":"JqGridCell:pe","invid":1,"amount":500,"tax":65,"total":565,"n‌​ote":"myNote 0"}]},`在此单元格中，第一行是复杂类型。想象一下，`"cell":[{ComplexType}]`所以我在第一个单元格中得到了“[Object object]”，而其他单元格保持为空。

因此将单元格类型更正为`List<string>`向其添加网格数据，然后将单元格添加到`List<InvoiceGrid>`.

```
 JQGridJSONReader input = new JQGridJSONReader();
        input.Page = 1;
        input.Total = 1;
        input.Records = 5;

        input.Rows = new List<InvoiceGrid>();

        for (int i = 0; i < 5; i++)
        {
            InvoiceGrid invGrid = new InvoiceGrid();
            invGrid.Cell = new List<string>();
            JqGridCell gridrows = new JqGridCell();
            gridrows.Invid = 1 + i;
            gridrows.Amount = 500.00 + (i * 10);
            gridrows.Tax = 65.00 + (i * 10);
            gridrows.Total = gridrows.Amount + gridrows.Tax;
            gridrows.Note = "myNote " + i.ToString();
            invGrid.Cell.Add(gridrows.Invid.ToString());
            invGrid.Cell.Add(gridrows.InvDate.ToString());
            invGrid.Cell.Add(gridrows.Amount.ToString());
            invGrid.Cell.Add(gridrows.Tax.ToString());
            invGrid.Cell.Add(gridrows.Total.ToString());
            invGrid.Cell.Add(gridrows.Note.ToString());
            input.Rows.Add(invGrid);
        } 
```

我在想这个错误是因为`__type`额外的 json 数据。但似乎 jqGrid 忽略了这一点。

我的 json 数据现在看起来像这样。注意：- 这次我忽略了 invid，但可以包括在内。

```
{"d":
{"__type":"JSONResponse:pe",
 "ActionType":"GRID_RESP",
 "JSONData":
            {"__type":"JQGridJSONReader:pe",
             "total":1,
             "page":1,
             "records":5,
             "rows":[
                    {"__type":"InvoiceGrid:pe",
                    "cell":["1","500","65","565","myNote 0"]},
                    {"__type":"InvoiceGrid:pe",
                    "cell":["2","510","75","585","myNote 1"]},
                    {"__type":"InvoiceGrid:pe",
                    "cell":["3","520","85","605","myNote 2"]},
                    {"__type":"InvoiceGrid:pe",
                    "cell":["4","530","95","625","myNote 3"]},
                    {"__type":"InvoiceGrid:pe",
                    "cell":["5","540","105","645","myNote 4"]}
                    ]
            },
 "Status":true
}} 
```

非常感谢@Oleg。

# vim - 获取视觉选择的 cword

> ID：10826878
> 
> 赞同：3
> 
> 时间：2012-05-31T02:55:27.060
> 
> 标签：vim

在 vim 的命令模式下，如果我按下`CTRL``r``CTRL``w`光​​标 ( ) 下的单词`<cword>`，这对于搜索和替换非常有用。

但是，如果我进行视觉选择并按下

```
:s/<c-r><c-w> 
```

我得到光标行中的第一个单词。如何获得`<cword>`视觉选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T03:03:17.523

不完全使用`<c-r><c-w>`，但您可能会发现这也很有用：

1.  用于`y``i``w`拉出当前单词进行注册；
2.  然后，使用`:/s/<c-r>0`将单词粘贴到寄存器中（替换`<c-r>0`）。

# android - 如何使“滚动条”出现在左侧？

> ID：10826879
> 
> 赞同：31
> 
> 时间：2012-05-31T02:55:38.303
> 
> 标签：android, android-listview, android-scrollview, android-scrollbar

在 Android`ListView`中，如何使`scrollbar`左侧出现？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-05-31T03:20:22.787

例子：

```
mView.setVerticalScrollbarPosition(View.SCROLLBAR_POSITION_LEFT); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T02:59:05.897

[您可以使用View.SCROLLBAR_​​POSITION_LEFT](http://developer.android.com/reference/android/view/View.html#SCROLLBAR_POSITION_LEFT)将任何视图的滚动条位置移动到左侧。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T04:06:47.250

正如其他两个答案所提到的，一种可能性是将[View.setVerticalScrollbarPosition()](http://developer.android.com/reference/android/view/View.html#setVerticalScrollbarPosition%28int%29)与[SCROLLBAR_](http://developer.android.com/reference/android/view/View.html#SCROLLBAR_POSITION_LEFT) ​​POSITION_LEFT 一起使用。然而，一个巨大的警告是，这需要 API 级别 11+，在撰写本文时占 Android 安装的不到 10%。对于大多数应用程序，这是不可接受的。

在旧版本的 Android 上实现您想要的一种可能性是做一些非常笨拙的事情：关闭滚动条，用左侧的窄布局镜像您的主布局，宽度足以容纳滚动条，并在滚动主视图时使用[scrollyBy()](http://developer.android.com/reference/android/view/View.html#scrollBy%28int,%20int%29)手动滚动左视图（通过覆盖 [onScrollChanged()](http://developer.android.com/reference/android/view/View.html#onScrollChanged%28int,%20int,%20int,%20int%29)）。

也就是说，除非有非常令人信服的理由将滚动条向左移动，否则我实际上并不建议这样做。在大多数情况下，您希望您的应用程序适合设备上的任何其他应用程序并像设备上的任何其他应用程序一样运行，只需让 Android 遵循其默认设置即可。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-21T09:36:06.973

试试我的 hack，似乎至少在 2.2 及更高版本上有效。

```
import java.lang.reflect.Field;

import android.annotation.SuppressLint;
import android.content.Context;
import android.graphics.Rect;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.LayerDrawable;
import android.util.AttributeSet;
import android.util.Log;
import android.view.View;
import android.widget.ListView;

/**
 * This class fixes the lack of setVerticalScrollbarPosition(View.SCROLLBAR_POSITION_LEFT) before API level 11
 * @author Genadz Batsyan
 */

public class ListViewWithLeftScrollBar extends ListView {
    private static final String LOG_TAG = ListViewWithLeftScrollBar.class.getSimpleName();
    private static final boolean DEBUG = true;

    private boolean patchInvalidate;

    public ListViewWithLeftScrollBar(Context context) {
        super(context);
        moveVerticalScrollbarToTheLeft();
    }

    public ListViewWithLeftScrollBar(Context context, AttributeSet attrs) {
        super(context, attrs);
        moveVerticalScrollbarToTheLeft();
    }

    public ListViewWithLeftScrollBar(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        moveVerticalScrollbarToTheLeft();
    }

    @Override
    public void invalidate(Rect r) {
        invalidate(r.left, r.top, r.right, r.bottom);
    }

    @Override
    public void invalidate(int left, int top, int right, int bottom) {
        int width = right - left;
        if (DEBUG) log("invalidate original w:"+ getWidth() +" h:"+ getHeight()+"  rect:"+left+", "+top+", "+right+", "+bottom);
        if (patchInvalidate && right == getWidth() && top == 0 && bottom == getHeight() && width < 30) {
            // The above condition should ensure that ListView is VERY likely to be invalidating the scrollbar.
            // In fact ListView appears to not invalidate anything except the scrollbar, ever.
            left = 0;
            right = left + width;
            if (DEBUG) log("invalidate patched  w:"+ getWidth() +" h:"+ getHeight()+"  rect:"+left+", "+top+", "+right+", "+bottom);
        }
        super.invalidate(left, top, right, bottom);
    }

    private void moveVerticalScrollbarToTheLeft() {
        try {
            if (DEBUG) log("moveVerticalScrollbarToTheLeft: Trying API Level >=11");
            tryApiLevel11();
            if (DEBUG) log("moveVerticalScrollbarToTheLeft: API Level >=11 success");
        } catch (Throwable t1) {
            if (DEBUG) {
                log("moveVerticalScrollbarToTheLeft: API Level >=11 FAILED");
                t1.printStackTrace();
            }
            try {
                if (DEBUG) log("moveVerticalScrollbarToTheLeft: Trying hack for API Level <11");
                tryApiLevelPre11();
                patchInvalidate = true;
                if (DEBUG) log("moveVerticalScrollbarToTheLeft: API Level <11 hack success");
            } catch (Throwable t2) {
                if (DEBUG) {
                    log("moveVerticalScrollbarToTheLeft: API Level <11 hack FAILED");
                    t2.printStackTrace();
                }
            }
        }
    }

    @SuppressLint("NewApi")
    private void tryApiLevel11() {
        setVerticalScrollbarPosition(View.SCROLLBAR_POSITION_LEFT);
    }

    private void tryApiLevelPre11() throws Exception {
        Class<?> viewClass = View.class;

        Field scrollCacheField = viewClass.getDeclaredField("mScrollCache");
        scrollCacheField.setAccessible(true);
        Object scrollCache = scrollCacheField.get(this);
        if (DEBUG) log("scrollCache: "+ scrollCache);

        Field scrollBarField = scrollCache.getClass().getDeclaredField("scrollBar");
        scrollBarField.setAccessible(true);
        Object scrollBar = scrollBarField.get(scrollCache);
        if (DEBUG) log("scrollBar: "+ scrollBar);

        Field verticalThumbField = scrollBar.getClass().getDeclaredField("mVerticalThumb");
        verticalThumbField.setAccessible(true);
        Object verticalThumb = verticalThumbField.get(scrollBar);
        if (DEBUG) log("verticalThumb: "+ verticalThumb);

        Drawable verticalThumbDrawable = (Drawable) verticalThumb;
        Drawable replacementVerticalThumbDrawable = new LayerDrawable(new Drawable[]{ verticalThumbDrawable }) {
            @Override
            public void setBounds(int left, int top, int right, int bottom) {
                if (DEBUG) log("setBounds original: "+left+", "+top+", "+right+", "+bottom);
                int width = right - left;
                left = 0;
                right = left + width;
                if (DEBUG) log("setBounds patched:  "+left+", "+top+", "+right+", "+bottom);
                super.setBounds(left, top, right, bottom);
            }       
        };
        verticalThumbField.set(scrollBar, replacementVerticalThumbDrawable);
    }

    private static void log(String msg) {
        Log.d(LOG_TAG, msg);
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-12-01T13:57:04.920

你可以在xml中添加这个

```
android:verticalScrollbarPosition="left" 
```

像这样

```
<ScrollView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:verticalScrollbarPosition="left"
    android:scrollbarThumbVertical="@drawable/scrollbar"
    /> 
```

或在 Kotlin 中使用此代码

```
scrollView.verticalScrollbarPosition = View.SCROLLBAR_POSITION_LEFT 
```

# php - 我的贝宝链接没有重定向到贝宝网站

> ID：10826889
> 
> 赞同：0
> 
> 时间：2012-05-31T02:56:41.033
> 
> 标签：php, magento, magento-1.5

我已将我的 magento 从 1.5 迁移到 1.7，但问题出现在**[http://dev.sinergiprima.co.id/wasis/checkout/cart/](http://dev.sinergiprima.co.id/wasis/checkout/cart/)**页面，当我单击链接贝宝时，它不会重定向到贝宝网站，而是它在**[http://dev.sinergiprima.co.id/wasis/checkout/cart/](http://dev.sinergiprima.co.id/wasis/checkout/cart/)**再次重定向，有没有人可以帮助我？想到这里就郁闷了，真的需要各位大神帮忙。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-15T17:56:58.503

我通过添加解决了它：

```
curl_setopt($this->_getResource(), CURLOPT_SSLVERSION, 3); 
```

到 lib/Varien/Http/Adapter 中的 write 函数

# jquery - 使用 Ajax 在不同的服务器（相同的网络）上调用 ColdFusion 脚本？

> ID：10826893
> 
> 赞同：0
> 
> 时间：2012-05-31T02:57:14.097
> 
> 标签：jquery, ajax, coldfusion

我在 ColdFusion 页面中有以下内容，一旦页面加载，它就会为我们提取一些数据：

```
ajaxRequest#RowURnumber[I]#.open("POST", "/cfapps/include/scriptname.cfm?i=#RowNumber[I]#", true);
ajaxRequest#RowURnumber[I]#.send(null); 
```

是否可以在我们网络中的不同服务器上托管此脚本并使用上述代码调用它？我曾尝试使用 http 地址和 UNC 路径，但它们似乎不起作用。

任何想法将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:17:31.063

您不能简单地使用 ajax 访问同一域以外的任何页面，即使是同一网络。

对于您的解决方案，您将在您的域中使用代理页面，从前端您将对域中的此代理页面执行 AJAX 请求，这将从该冷融合页面获取内容并将其传递到前端。

```
$.ajax({
  type:'GET',
  url :'url to a proxy page in server A',
  success: function (){//...}
}); 
```

在服务器 A 中，您将有一个代理页面说 proxy.cfm

```
<cfhttp url="http://www.serverB.com/the actual page..." />
<cfset html = cfhttp.FileContent />
<cfoutput>#html#</cfoutput> 
```

因此，您的 AJAX 将要求服务器 A 从服务器 B 获取内容并将其返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T03:14:03.323

如果脚本位于不同的域，则浏览器的同源策略将阻止脚本运行。您可以查看一些解决方法（JSONP、CORS）。JSONP 将是更向后兼容的解决方案。

# matlab - MATLAB histfit - 从数据中获取 PDF，ksdensity？

> ID：10826894
> 
> 赞同：0
> 
> 时间：2012-05-31T02:57:21.863
> 
> 标签：matlab, plot, probability, histogram

我想使用 histfit 从绘图中获取密度曲线方程。

我看到使用 ksdensity 函数可以获得点向量。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T06:18:52.947

```
histfit(data); 
```

将数据绘制为直方图，并显示最佳拟合高斯的平滑曲线。

```
[mu, sigma] = normfit(data);
pd = fitdist(data,'normal'); 
```

将给出同一组数据的平均值 (mu) 和标准差 (sigma)，由 histfit 用于生成拟合曲线。

如果你这样做`edit histfit`，你可以查看它，通过将正态曲线下的面积和直方图中的面积相等来找到正态曲线的高度，查找周围的代码

```
% Normalize the density to match the total area of the histogram
xd = get(hh,'Xdata');             % Gets the x-data of the bins.
rangex = max(xd(:)) - min(xd(:)); % Finds the range of this data.
binwidth = rangex/nbins;          % Finds the width of each bin.
area = n * binwidth;
y = area * pdf(pd,x); 
```

有关进行缩放的那部分的更多提示。

# java - java输出格式的树

> ID：10826896
> 
> 赞同：0
> 
> 时间：2012-05-31T02:57:38.027
> 
> 标签：java, json

我想使用 java 为 JQuery Dynatree 输出一棵树，但失败了。

```
public class Category {
    String name;

    Category parentCategory;

    public Category(String name, Category parentCategory) {
        super();
        this.name = name;
        this.parentCategory = parentCategory;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Category getParentCategory() {
        return parentCategory;
    }

    public void setParentCategory(Category parentCategory) {
        this.parentCategory = parentCategory;
    }
} 
```

主班

```
import java.util.ArrayList;
import java.util.List;

public class Main {

    static Category root;
    static Category category1;
    static Category category11;
    static Category category12;
    static Category category2;
    static Category category21;
    static Category category22;

    static Category category3;

    public static void main(String[] args) {
         root = new Category("root", null);

         category1 = new Category("c1", root);
         category11 = new Category("c11", category1);
         category12 = new Category("c12", category1);

         category2 = new Category("c2", root);
         category21 = new Category("c21", category2);
         category22 = new Category("c22", category2);   

         category3 = new Category("c3", root);

         print(root);
    }

    public static void print(Category category){    
        List<Category> childList = getChild(category);

        if(category.getParentCategory() == null){ //root
            System.out.println("{title:"+category.getName()+",key:"+category.getName()+",");
        }
        else {
            //if(childList.size()==0){
            //  System.out.println("{title:"+category.getName()+",key:"+category.getName()+",");
            //}
        //  else {
                System.out.println("children:[{title:"+category.getName()+",key:"+category.getName()+",");
        //  }           
        }           

        if(childList.size()==0) return;
        for(Category child : childList){
            print(child);
        }   
        System.out.println("}]");
        System.out.println("}");
    }

    public static List<Category> getChild(Category category){
        List<Category> childList = new ArrayList<Category>();
        if("root".equals(category.getName())){
            childList.add(category1);
            childList.add(category2);
            childList.add(category3);

            return childList;
        }

        if("c1".equals(category.getName())){
            childList.add(category11);
            childList.add(category12);

            return childList;           
        }

        if("c2".equals(category.getName())){
            childList.add(category21);
            childList.add(category22);

            return childList;           
        }

        return childList;// empty

    }

} 
```

我的输出不正确，应该是这样的：

```
 {title: "root", key: "root", 
      children: [
        {title: "c1", activate: true,
          children: [
            {title: "c11", key: "c11" },
            {title: "c12", key: "c12" }
          ]
        },
        {title: "c2", select: true,
          children: [
            {title: "c21", key: "c21" },
            {title: "c22", key: "c22" }
          ]
        },
        {title: "c3", hideCheckbox: true }       
      ]
    } 
```

我的代码有错误，如何修复？或者使用这个设计，是否有可能得到这个结果？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T03:01:37.900

似乎输出是JSON。

你试过[gson](http://code.google.com/p/google-gson/)吗？您不需要编写代码来序列化数据，gson 会为您将对象序列化为 JSON。

# wpf - wpf listview/gridview 列调整大小事件

> ID：10826901
> 
> 赞同：0
> 
> 时间：2012-05-31T02:58:09.433
> 
> 标签：wpf, events

我有一个从名为 Props 的类对象填充的列表视图。在列表视图中，我有一个标题字段和一个工作时间字段（加上其他不相关的字段）。我填充列表视图的方式是清除它并使用 foreach 从类对象（道具）中重新添加每个项目。我有一个 List<> 变量，用作 Props 类的数组。我需要更新当前工作对象的工作时间字段，该对象始终是列表视图中的第一个对象。我还有一个标签，用作工作时间的叠加层。此标签覆盖在工作项（列表视图中的第一项）上。它覆盖在工作时间列上。这工作得非常好，除非当我调整列（称为标题的第一列）的大小时，标签保持在原位。

我知道这是非正统的，但这是我可以让工作项目显示更新的工作时间的唯一方法。另外，我知道这个问题可能有点令人困惑，但这是我能解释它的最佳方式。

谢谢，克雷格

# c# - 在 C# 中使用 speex 预处理器的最简单方法是什么？

> ID：10826902
> 
> 赞同：4
> 
> 时间：2012-05-31T02:58:14.267
> 
> 标签：c#, speex

我需要使用 speex 预处理器，并且只有我的 VOIP 应用程序中的预处理器（不需要使用编解码器）。我的应用程序是用 C# 编写的。我想我知道最简单的步骤，但不知道在哪里可以找到这些物品。

如果我能找到这些，我认为最简单：

1.  仅包含预处理器函数的 Windows DLL，或者如果大小足够小，我猜整个 speex 库都可以。到目前为止，我只找到了 EXE 格式的二进制文件，所以如果我找不到二进制文件，我必须安装他们用来构建源代码的编译器，可能还有其他几个库（就像我对大多数开源构建的经验一样）。

2.  C# 版本的头文件，用于调用 DLL 函数。

所以我的问题是，有人知道我在哪里可以找到这些吗？我相信人们之前已经创建了这些，基于大量的 speex 用户，只是无法在网上找到任何东西。

希望人们不要认为我很懒，如果我知道很多其他人可能已经做过完全相同的事情，我只是讨厌做这种“忙碌的工作”:)

更新：我确实找到了包含 libspeex.dll 的[http://www.rarewares.org/files/others/libspeex-dll-1.2rc1.zip](http://www.rarewares.org/files/others/libspeex-dll-1.2rc1.zip)，但是 DLL 没有导出，所以不确定他们期望它如何工作。他们拥有的其他二进制文件也只是 EXE。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T22:36:28.243

我最终只使用了一些功能，但如果有人不想做这项工作，这是我写的：

```
 [DllImportAttribute("libspeexdsp.dll")]
    public static extern IntPtr speex_echo_state_init(int frameSize,int filterLength);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern void speex_echo_state_destroy(IntPtr st);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern void speex_echo_cancellation(IntPtr st, IntPtr recorded, IntPtr played, IntPtr echoRemoved);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern void speex_echo_playback(IntPtr st, IntPtr played);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern void speex_echo_capture(IntPtr st, IntPtr recorded, IntPtr echoRemoved);

    [DllImportAttribute("libspeexdsp.dll")]
    public unsafe static extern int speex_echo_ctl(IntPtr st, int id, ref IntPtr val);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern IntPtr speex_preprocess_state_init(int frameSize, int sampleRate);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern int speex_preprocess_ctl(IntPtr st, int id, IntPtr val);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern int speex_preprocess_run(IntPtr st, IntPtr recorded);

    [DllImportAttribute("libspeexdsp.dll")]
    public static extern void speex_preprocess_state_destroy(IntPtr st); 
```

我想我很幸运，因为没有很多结构需要 delcare，大部分都是 IntPtr 或 int，所以很容易。

至于找到二进制文件，我没有发现它们在任何地方预编译，但源代码确实包含了 VS 解决方案文件，这些文件只经过了一些小改动，所以我想这部分对于任何使用 C# 的人来说都很容易，因为他们'无论如何都会使用VS。出于某种原因，我认为它需要其他一些编译器，比如 GCC，或者大多数开源项目似乎使用的其他编译器（我都不熟悉）。再次，幸运的是，它没有！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-31T03:23:17.913

Speex 是用 C 语言编写的，并且具有导出功能。我只是自己下载了源代码并查看了。在此处下载源代码，然后从那里[访问 http://www.speex.org/downloads/](http://www.speex.org/downloads/)。它看起来相当广泛，......快乐的编码。

当然，有这个，但它仍处于测试阶段：

[http://nspeex.codeplex.com/](http://nspeex.codeplex.com/)

# jquery - Jquery 插件 - 操作时间选择器选择

> ID：10826903
> 
> 赞同：1
> 
> 时间：2012-05-31T02:58:23.627
> 
> 标签：jquery, asp.net-mvc, timepicker

我在一个页面上有 2 个 Jquery timePickers。timePicker 插件来自[http://labs.perifer.se/timedatepicker/](http://labs.perifer.se/timedatepicker/)

在视图中，我有这两个时间选择器控件-。

```
$("#time1, #time2").timePicker({
        startTime: "09.00", 
        endTime: new Date(0, 0, 0, 19, 0, 0), 
        show24Hours: false,
        separator: '.',
        step: 60
}); 
```

“#time1”采用“事件开始”时间。#time2 采用“事件结束”时间。我有 MVC 、 jquery 、 js 代码，这些代码运行以获取所有先前选择的“time1”的列表。我在#time1 中隐藏了以前“选择并保存”的值。例如，用户之前保存了上午 9 点、上午 10 点、上午 11 点。我从数据库中获取这些值（到列表“listTimes”中）并将这些值隐藏在#time1 控件中并且不再可见。

```
 $(listTimes).each(function () {

   $('.time-picker:first').find('li:contains("' + this + '")').hide();    
                         }); 
```

但是，如果用户在时间 1 中选择上午 9 点，在时间 2 中选择下午 2 点，那就是 5 小时的块。我不仅要隐藏上午 9 点，我还必须隐藏 10、11、12、1 点，因为它是 5 小时时段。直到现在，我只能隐藏上午 9 点。需要一些帮助来隐藏剩余的时间。我需要以某种方式用持续时间（time2-time1）中的所有时间填充列表“listTimes”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T12:25:24.963

这些方面的东西应该适合你：

```
var startTime = "09:00";
var endTime = "11:30";
var $startTime = $('.time-picker:first').find('li:contains("' + startTime + '")');
var $currentTime = $startTime.next('li');

$startTime.hide();

while($currentTime.html() != endTime) ​{
    $currentTime.hide();
    $currentTime = $currentTime.next('li');
}​ 
```

[现场演示](http://jsfiddle.net/MxTqN/2/)

# javascript - 如何将脚本传递给 main.scala.html - 玩！2

> ID：10826906
> 
> 赞同：2
> 
> 时间：2012-05-31T02:59:34.653
> 
> 标签：javascript, templates, scala, parameters, playframework

我正在尝试将特定于页面的 javascripts 作为参数传递给主模板。这是我尝试过的：

**main.scala.html：**

```
@(title: String,moreScripts: Html)(content: Html)

<!DOCTYPE html>

<html>
    <head>
        <title>@title</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/main.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/favicon.png")">
        <script src="@routes.Assets.at("javascripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
        @moreScripts
    </head>
    <body>
        @content
    </body>
</html> 
```

**test.scala.html：**

```
@main("Test",<script src="javascripts/test/test.js" type="text/javascript"></script>) {
        <h1>Test</h1>
} 
```

但我收到一个`type mismatch; found : scala.xml.Elem required: play.api.templates.Html`错误。`<script>`我也尝试将声明包装起来`@{}`无济于事。

我需要如何构造`<script>`语句以便将语句识别为 HTML？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T09:39:37.983

这已在[邮件列表中](https://groups.google.com/d/msg/play-framework/JTlcTZlq-HY/7hSLt-SxwAoJ)讨论过。希望有帮助。

```
@main{ <script src="javascripts/test/test.js" type="text/javascript"></script> } {
   <h1>Test</h1>
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-04T04:35:46.093

我也为此苦苦挣扎，但这似乎对我有用：

main.scala.html：

```
@(title: String, moreScripts: Html = Html(""))(content: Html)
<!DOCTYPE html>
<html>
  <head>
   <title>@title</title>
   @moreScripts
  </head>
  <body>
   @content
  </body>
</html> 
```

test.scala.html：

```
@moreScripts = { <script src="routes.Assets.at("javascripts/MyJS.js")"></script>}

@main("Page Title", moreScripts) {
  <h1>Some content here</h1>
} 
```

当然，您的 Javascript 文件应该位于`app/assets/javascripts`标准 Javascript 或 Coffeescript 文件中

# ios5 - 在程序生成的滚动完成后将调用什么 UIScrollview 委托方法

> ID：10826908
> 
> 赞同：2
> 
> 时间：2012-05-31T03:00:26.510
> 
> 标签：ios5, uiscrollview, scroll, uiscrollviewdelegate

我需要一些帮助，我真的需要知道在我执行一些程序生成的滚动后会调用什么 UIScrollView 委托方法。从[这个](https://stackoverflow.com/questions/1969256/uiscroll-view-delegate-not-calling-scrollviewdidendscrollinganimation)链接，我知道我必须尝试实施

`- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView`

但是在我实现它之后，从 NSlog，我知道当滚动视图已经完成时没有调用这个方法，nslog 显示在调用这个委托方法之后，应用程序调用了

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView{ 
```

然后再次调用scrollViewDidEndScrollingAnimation，多次返回scrollViewDidScroll，直到滚动真正停止，我需要在程序生成滚动之前将BOOL值设置为True，并且需要在滚动真正停止后将其设置为False。有人可以帮我解决这个问题吗？

这是我的示例代码，要做到这一点：

```
BOOL isScroll;

- (void)viewDidLoad {
    isScroll = YES;
    [self generateScrollProgrammatically];
}

- (void) generateScrollProgrammatically{
    //i do some code for scrolling uiscrollview programmatically
}

- (void)scrollViewDidScroll:(UIScrollView *)scrollView{
    NSLog(@"scrollViewDidScroll");

    if (isScroll){
        //do something
    }

}

- (void)scrollViewDidEndScrollingAnimation:(UIScrollView *)scrollView{
    NSLog(@"scrollViewDidEndScrollingAnimation");
} 
```

这是我被告知的nslog：

```
2012-05-31 09:58:10.583 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.584 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.595 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.596 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.597 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.598 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.611 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.615 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.616 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.617 myApps[1203:fb03] scrollViewDidEndScrollingAnimation
2012-05-31 09:58:10.631 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.632 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.633 myApps[1203:fb03] scrollViewDidEndScrollingAnimation
2012-05-31 09:58:10.634 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.635 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.636 myApps[1203:fb03] scrollViewDidEndScrollingAnimation
2012-05-31 09:58:10.636 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.637 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.638 myApps[1203:fb03] scrollViewDidEndScrollingAnimation
2012-05-31 09:58:10.640 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.642 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.644 myApps[1203:fb03] scrollViewDidEndScrollingAnimation
2012-05-31 09:58:10.644 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.645 myApps[1203:fb03] scrollViewDidScroll
2012-05-31 09:58:10.646 myApps[1203:fb03] scrollViewDidEndScrollingAnimation 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T20:06:07.660

是的，这也咬到我了。我能找到的唯一方法是替换：

```
[scrollView setContentOffset:offset animated:YES]; 
```

和：

```
[UIView animateWithDuration:[[UIApplication sharedApplication] statusBarAnimationDuration]
                 animations:^{ scrollView.contentOffset = offset; }
                 completion:^{ [scrollView.delegate scrollViewDidEndScrollingAnimation:scrollView]; }]; 
```

# amazon-web-services - 如何使用电子邮件/访问密钥/安全密钥登录 AWS

> ID：10826911
> 
> 赞同：9
> 
> 时间：2012-05-31T03:00:56.003
> 
> 标签：amazon-web-services

我有带有信息电子邮件地址/访问密钥/安全密钥的 AWS 帐户，没有任何其他密码，我找不到登录 AWS 服务的位置，例如 EC2 等？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-31T03:56:24.033

电子邮件地址和密码用于通过网站（包括 AWS 控制台）登录 Amazon 账户：

> [https://console.aws.amazon.com](https://console.aws.amazon.com)

如果您没有与该电子邮件地址关联的密码，则您需要有权访问该电子邮件帐户，以便您可以生成并接收密码重置电子邮件。

访问密钥 ID 和秘密访问密钥是您可以通过 API 和一些 AWS 命令​​行工具和第三方服务访问 AWS 功能的一种方式。您输入或使用这些的具体方式取决于您用于访问 AWS 功能的工具。

AWS 还使用了许多其他凭证，包括 X.509 证书和私钥。这些类似于访问密钥 id 和秘密访问密钥，但

我写了一篇文章，解释了一些不同的 AWS 凭证及其使用方式：[http ://alestic.com/2009/11/ec2-credentials](http://alestic.com/2009/11/ec2-credentials)

# mysql - 将变量重置为 0

> ID：10826912
> 
> 赞同：2
> 
> 时间：2012-05-31T03:01:01.853
> 
> 标签：mysql, sql

我有一点代码，我不能完全正常工作。给我带来麻烦的部分是：

```
IF( Class_Subset = @prevSub AND RegNum = @prevNum AND `DRI` >99.99 ,
@Platinum :=@Platinum + 1 ,''  ) 
```

我需要做的是告诉, 或条件不再满足时`@Platinum`重置回。`zero``Class_Subset``RegNum`

有任何想法吗？

整个代码：

```
SELECT  
 Harley.Hgt, Harley.RegNum, Harley.Callname, Harley.OLastname,  
 Harley.Tpe, Harley.Points, Harley.Class, Harley.Total_Points,  
 Harley.Title, Harley.Platinum, Harley.Silver_Purple,  
 Harley.Date_Earned, Harley.Judge, Harley.HostClub, Harley.DRI,  
 Harley.Class_Subset, Harley.IncorrectRegNum, Harley.MemNum, Harley.ID
FROM
 (
   SELECT
    Hgt, RegNum, Callname, OLastname, Tpe, Points, Class,  
    Total_Points, Title, Silver_Purple, Date_Earned, Judge,  
    HostClub, DRI, Class_Subset, IncorrectRegNum, MemNum, ID, 
    IF (
     Class_Subset = @prevSub  
     AND RegNum = @prevNum  
     AND `DRI` > 99.99,  
     @Platinum := @Platinum + 1,  
     0
    ) AS Platinum,  
    @prevSub := Class_Subset,  
    @prevNum := RegNum
   FROM  
    Harley,  
    (  
      SELECT @Platinum := 0, @prevSub := '', @prevNum := ''  
    ) r  
   ORDER BY RegNum, Class_Subset, Date_Earned  
 ) Harley 
```

这就是文件的样子，您可以看到为什么它需要在 RegNum 和 Subset 匹配时记住变量，但一旦它们发生变化就会重置为 0：

[样本数据 http://nadacforum.com/Platinum.png](http://nadacforum.com/Platinum.png "点击放大")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T05:25:53.313

我想我现在看到了这个问题。

`Platinum`正在计算的行集由`RegNum`和`Class_Subset`（特别是）排序，这很好，因为计算确实依赖于那些被排序的列。但`IF()`条件也涉及`DRI`列，并且如您的屏幕截图所示，一系列`DRI`大于 的值`99.99`可能会在一组`(RegNum, Class_Subset)`. 恢复后，您需要继续使用白金值，*而不是*重置为`1`.

因此，您的`@Platinum`表达方式应该更复杂一些。这是改变它的一种方法：

```
**@Platinum :=** IF (
 Class_Subset = @prevSub  
 AND RegNum = @prevNum  
 ~~AND `DRI` > 99.99,~~
 **@Platinum**,  
 0
) **+ (`DRI` > 99.99)** AS Platinum, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T03:40:51.447

您一定在寻找：

```
if(
    Class_Subset = @prevSub 
    AND RegNum = @prevNum 
    AND `DRI` >99.99,
    @Platinum + 1,
    0
) into @Platinum 
```

通过上述更改，您的查询可能如下所示：

```
select /* some fields here, */ if ( ...as above... from ... 
```

# javascript - 如何在 chrome 中设置 DOM 断点

> ID：10826916
> 
> 赞同：44
> 
> 时间：2012-05-31T03:01:34.140
> 
> 标签：javascript, debugging, google-chrome, google-chrome-devtools

我正在尝试按照[此处](https://developers.google.com/chrome-developer-tools/docs/elements)的教程进行操作。

我被困在**DOM Breakpoints**部分（靠近底部）。

我去了他们正在谈论的[示例网站。](https://github.com/google/closure-library/blob/master/closure/goog/demos/hovercard.html)我按下`ctrl`++`shift`并`i`导航到“元素”选项卡。在元素选项卡中，我找到了以下 html 部分：

```
<div id="profileCard" style="position: absolute; left: 403px; top: 135px; visibility: hidden; display: none; " class="goog-hovercard">
</div> 
```

现在我被困在试图找到上下文菜单：

> 在#profileCard 元素上调出上下文菜单并选择要中断的事件：子树修改、属性修改和节点删除

这是一个屏幕截图，显示我在哪里：

![ss](../Images/1812fe8bebf8db466e28970a72606a9e.png)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-05-31T03:34:50.320

要在 Chrome 中设置断点，请像上面显示的那样打开检查器，然后单击顶部的脚本选项。这将允许您查看页面上使用的脚本并在该页面上插入断点。以及逐步了解它们和其他有用的调试选项。

以上是针对 javascript，要中断 dom 元素，右键单击要中断的元素（在检查器内部），它会弹出上下文菜单，允许您中断子树修改和类似的东西。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-06-16T17:22:05.673

只是想补充一点，您只需右键单击元素面板中的元素并转到：

`Break On...`并选择`Subtree modifications`, `Attributes modifications`, 或`Node removal`

[![在此处输入图像描述](../Images/f649df2a74a17207f0e73d0b0afea1a7.png)](https://i.stack.imgur.com/uA75K.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-02-03T06:21:33.640

# json - 如何将 JSON 从 powershell 导出到 node.js

> ID：10826920
> 
> 赞同：1
> 
> 时间：2012-05-31T03:02:09.750
> 
> 标签：json, node.js, powershell, socket.io

我正在使用`Azure Node SDK`来尝试这个。

我正在从 powershell 导出以下 JSON

```
get-process | Select Name,ID,VM,WS | Select -First 10 | ConvertTo-Json 
```

这给了我这样的东西。

```
{
    "Name":  "AcroRd32",
    "Id":  6776,
    "VM":  185810944,
    "WS":  63762432
}
{
    "Name":  "BCMWLTRY",
    "Id":  1128,
    "VM":  580022272,
    "WS":  38010880
}
{
    "Name":  "conhost",
    "Id":  332,
    "VM":  52039680,
    "WS":  3592192
} 
```

有没有办法，我可以从节点 app.js 文件中获取这些数据？我正在尝试将其处理`node.js / express`并`socket.io`编码。

我已经从 powershell 调用了一些基于 Web 的 API，并成功地将变量传递给了 REST API。 [http://poshcode.org/3369](http://poshcode.org/3369)

但是，我很难将 powershell`JSON`数据传递给本地`node.js` 实例。

任何帮助/指针表示赞赏。

# python - 从二进制获取日期时间

> ID：10826928
> 
> 赞同：1
> 
> 时间：2012-05-31T03:03:21.247
> 
> 标签：python, datetime, binary

我想以 2000 年 1 月 1 日的形式获得日期和时间。我正在制作的程序从存储信息表的压缩文档中读取。程序到达日期时间单元并退出

*   946652400 作为整数
*   或 11110000110001000110110000111000 作为二进制

这应该解释为 1999 年 12 月 31 日星期五 15:00:00 UTC，我希望它显示为 2000 年 1 月 1 日。我可以使用python中某种形式的方法吗？我也可以将此信息显示为 1999 年 12 月 31 日。如果没有，有人可以从上面的示例中解释如何创建它吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-31T03:16:00.493

使用日期时间：

```
>>> import datetime
>>> datetime.datetime.fromtimestamp(946652400)
datetime.datetime(2000, 1, 1, 0, 0) 
```

时区是一团糟，尤其是当您不得不担心未来时。但是，如果您只是处理过去，您始终可以应用静态偏移量来将值调整到所需的时区。

您给出的值已经在 2000 年 1 月 1 日，如果您知道适当的偏移量，可以将其调整回 UTC。

```
>>> dt = datetime.datetime.fromtimestamp(946652400)
>>> OFFSET = datetime.timedelta(hours=-9)
>>> adjusted_dt = dt + OFFSET
datetime.datetime(1999, 12, 31, 15, 0) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T03:14:03.697

```
import time
time_struct = time.gmtime(946652400)
print time.strftime('%d/%m/%Y', time_struct) 
```

time 模块是 stdlib 的一部分： 记录[在这里](http://docs.python.org/library/time.html) 这里有一个[表格](http://docs.python.org/library/time.html#time.strftime)，显示`%m`您可以在`strftime`.

# javascript - Backbone.js 没有在 IE 中解析数据

> ID：10826930
> 
> 赞同：1
> 
> 时间：2012-05-31T03:03:53.140
> 
> 标签：javascript, ajax, backbone.js, backbone-events

我正在使用backbone.js 来构建一个网站。它在我们的开发服务器中运行良好，但它没有使用 IE7-9 解析客户端服务器中的数据。（火狐、Safari 都可以）

我发现主干调用 fetch() 来请求数据，但是当数据返回时它没有启动 parse()。我找不到成功或错误返回。有一段代码：

```
EMR.CategoriesCollection = Backbone.Collection.extend({

        url : 'contents/json/categories.txt',

        initialize:function () {
            console.log('Get data from:', this.url);
            this.fetch();
        },

        model: EMR.ItemModel,

        parse : function(data) {
            console.log("CategoriesCollection parse data:", [data]);
            return data; 
        }
    }); 
```

请比较下面的两个链接（在 IE 7-9 中），它们是同一组代码，只是服务器不同：

它的工作原理：1）[http://pms.dq.hk/clients/amex_eMR/client/cn/emr/test_data.html](http://pms.dq.hk/clients/amex_eMR/client/cn/emr/test_data.html)

失败：2）[http://qwww.americanexpress.com/hk/cn/emr/test_data.html](http://qwww.americanexpress.com/hk/cn/emr/test_data.html)

如果主干发送了 fetch()，但 parse() 没有触发，如何追踪问题？

我可以尝试任何可能的方法吗？

谢谢你的建议。

问候，

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T05:45:21.287

问题在这里：http: [//forum.jquery.com/topic/the-problem-with-ie8-and-encoding-error-c00ce56e](http://forum.jquery.com/topic/the-problem-with-ie8-and-encoding-error-c00ce56e)

我们客户的服务器返回数据

```
Content-Type    text/plain; charset=big-5 
```

当我在 fetch() 中添加错误处理程序时，我可以看到错误返回“由于错误 c00ce56e 无法完成操作”。这就是 parse() 不起作用的原因。

我无法更改客户端的服务器设置，所以我将数据文件放到返回 Content-Type text/plain 的其他目录；解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T09:24:38.937

> 我可以尝试任何可能的方法吗？

你好。您是否尝试向 fetch 方法添加错误回调？此外，«fail» 服务器以 gzip 格式发送 gzip 压缩内容。也许 IE 不能以正确的方式处理压缩的 JSON？或者您可以尝试将 Content-Type 标头从 «text/plain» 更改为 «application/json»？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:48:17.483

我可以看到两者之间的唯一区别是响应标头..

你的服务器：

```
Connection  Keep-Alive
Date    Thu, 31 May 2012 03:41:16 GMT
Etag    "ae6691-123ac-59de3b00"
Keep-Alive  timeout=15, max=98
Server  Apache/2.0.63 (Unix) PHP/5.3.2 DAV/2 
```

客户端服务器：

```
Connection  keep-alive
Content-Type    text/plain; charset=big-5
Date    Thu, 31 May 2012 03:41:25 GMT
Last-Modified   Tue, 22 May 2012 06:41:10 GMT
Vary    Accept-Encoding 
```

客户端服务器响应中的内容类型引起了我的注意，但我不是 IE 专家..您可能想提及您遇到问题的 IE 版本并测试其他一些版本以隔离它..

# php - { } codeigniter 的模型/视图中的大括号

> ID：10826931
> 
> 赞同：2
> 
> 时间：2012-05-31T03:04:08.273
> 
> 标签：php, codeigniter

在 CodeIgniter 模型/视图中看到一些花括号：

`mkdir("userdata/{$userID}/live/",0755,true);`

我知道`$userID`某种类型的变量可能包含用户的会话用户 ID。我的问题是如何设置一些值让我使用这样`{ }`的 .

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T03:13:22.130

`{$varname}`是指定变量名称边界的显式方式

```
"$abcdefg" 
```

在这种情况下，php 将尝试输出带有名称的变量的值`abcdefg`

```
"{$a}bcdefg" 
```

在这种情况下，它将输出变量的值`a`并附加字符串字面量`bcdefg`。

因此，您可以在花括号内使用当前范围内可见的**任何变量**

# c - 为什么 /dev/video1 不触发选择？

> ID：10826942
> 
> 赞同：3
> 
> 时间：2012-05-31T03:06:01.047
> 
> 标签：c, linux, video, video-capture

我有 2 个 USB 网络摄像头连接到我的 debian 6 盒子。一个是a `Logitech QuickCam Orbit`，另一个是a `Logitech QuickCam 4000 Pro`。

目前 Orbit 显示为`/dev/video0`4000 Pro 为`/dev/video1`.

两个摄像头似乎都工作正常，也就是说，我可以同时打开它们`/dev/video0`并且`/dev/video1`没有错误。我可以使用`video4Linux` `ioctl()`. 我可以使用`video4linux` `ioctl()`--all 设置他们的捕获格式而不会出错。司机似乎工作得很好。

`select()`然后我为这两个文件描述符进行了设置，但`select()`从未为`/dev/video1`文件描述符触发。

这是我的`select()`相关代码：

```
FD_ZERO(&readFDS);
FD_SET(nCaptureReadPipeFD, &readFDS);   // this is a control channel for my thread
FD_SET(nCameraOneFD, &readFDS);
if (nNumberOfCameras == 2) FD_SET(nCameraTwoFD, &readFDS);

nReturnCode = select(nSelectFD, &readFDS, NULL, NULL, NULL); 
```

我想我是`select()`正确的——我已经检查了所有相关的文件描述符，它们对应于`open()`调用返回的相应文件描述符。`select()`调用中使用的文件描述符`nSelectFD`确实比最大的文件描述符多 1。

但仍然没有采取任何行动`/dev/video1`

使用多台相机时，我是否必须处理主要/次要设备编号？

# c++ - Stacking multiple forward declarations in one header and one namespace

> ID：10826944
> 
> 赞同：0
> 
> 时间：2012-05-31T03:06:42.433
> 
> 标签：c++, header, namespaces, forward-declaration

I have a set of classes to implement and I plan to do it in the following way:

(1) A master header file (entity.h) that has all the forward declarations of these classes enclosed in a namespace i.e.:

```
namespace SomeNameSpace {
    class A;
    ...
    class E;
} 
```

(2) Each of the classes then have separate header files (i.e. A.h, B.h) that defines the classes and declares all the constituent variables and methods.

(3) And finally, the .cpp's that define all the members and statics (i.e. A.cpp, B.cpp).

Now, I tried to put this scheme to work by doing `#include "entity.h"`, but I am slapped with an "ambiguity" error whenever I try to use one of these classes. If I skip step (1) and simply include all the individuals header files of each class, then I don't have that problem (and that's how I've been writing code).

So anyway, is my scheme viable? Is there some way to make it work? What I really wanted is to have some sort of way to put every custom object in one namespace. I suppose I can make that work by simply putting all the class declarations into one file, but that'd make entity.h bloated.

I've searched around with keywords "forward declaration", "C++", "namespace", "one namespace", "master header", "header" and couldn't find anything that's quite relevant. Maybe what I want to do is wrong?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:21:07.287

A different approach would be wrapping the classes into a namespace directly from the original headers, and then including them, e.g.:

A.h:

```
namespace SomeNameSpace {
    class A{
        // Class definition
        void something();
    }
} 
```

A.cpp:

```
#include "A.h"
namespace SomeNameSpace {
    void A::something()
    {
    }
    // And other function definitions
} 
```

entity.h:

```
#include "A.h"
#include "B.h"
// And so on... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T03:22:33.373

You cannot use "class A;" in your entity.h because that means that you are actually declaring a class but you already have done so in A.h You can either add the whole declaration in your entity.h but not using any A.h, B.h etc. Or, you can just use the same namespace in each *.h file : A.h -> namespace SomeNamespace { class A ... }

B.h -> namespace SomeNamespace{ class B ... }

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T03:19:31.940

You cannot use a class in a scope where there is not a complete definition (the forward declaration is not enough). Normally you might forward declare in the header and #include in the cpp. I don't see the point in organizing the way you are trying to; The canonical wisdom is to forward declare whenever possible and #include whenever necessary.

# php - javascript函数没有显示正确的页面

> ID：10826947
> 
> 赞同：0
> 
> 时间：2012-05-31T03:07:09.607
> 
> 标签：php, javascript

我想根据下拉选择打开一个特定的窗口，该函数在一组数据的第一行上工作正常（从数据库中提取它）因为我不知道每次会有多少行脚本正在运行，我创建了一个循环并编写函数的次数与行数一样多，它们的名称不同。问题是，当我从第一行更改下拉菜单时，会打开正确的窗口，例如 custom.php?id=1，但是当我打开第二个窗口时，如果我从列表中选择 comunicarse，它会打开自定义。 php?id=2 (id=2 是用户的id) 下面是代码，希望大家能看懂....

```
 <html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<title></title>
<style>
table {
border-style:ridge;
border-width:1px solid;
border-collapse:collapse;
font-family:sans-serif;
font-size:12px;
width:100%;
}
table thead th, table.excel tbody th {
background:#CCCCCC;
border-style:ridge;
border-width:1;
text-align: center;
vertical-align:bottom;
}
table tbody th {
text-align:center;

}
table tbody td {
vertical-align:bottom;
}
table tbody td {
padding: 0 3px;
border: 1px solid 0000000;
}

table  td {
padding: 0 3px;
border: 1px solid 0000000;

}

</style>

<link rel="stylesheet" href="../css/style.css" type="text/css">

<?php 
include("../../cons/dbinfo.php");

$busco_react = "SELECT * 
FROM  `envios_mercadolibre` 
WHERE status != 'ENTREGADA'  AND status != 'CANCELADA' AND aviso != 1";
$bus1 = mysql_query($busco_react);
while ($b1 = mysql_fetch_array($bus1)){
$para = $b1['id'];

echo '<script language="Javascript" type="text/javascript">
function ReactToChange'.$para.'()
{
if (document.getElementById("DropDownList").value === "custom")
{
    window.open("custom.php?id='.$para.'")
}
else if (document.getElementById("DropDownList").value === "comunicarse")
{
    window.open("comunicarse.php?id='.$para.'")
}
else if (document.getElementById("DropDownList").value === "esperando")
{
    window.open("esperando.php?id='.$para.'")
}
else if (document.getElementById("DropDownList").value === "compro")
{
    window.open("compro.php?id='.$para.'")
}
else {}
}
</script>';

 }
?>
</head>
<body>
<table width = "2200px">
<tr><td colspan="3" align="center"><a href="../index.php">Back to index</a></td></tr>
</table>
<br />
<?php 

echo "<form method='post' action='sendemails.php'>";
echo "<table  border='1' cellpading ='0' cellspacing ='0'>";
echo "<thead><tr><th>MAIL</th><th>Email Address</th><th>Content</th>
<th>Extra 1</th><th>Extra 2</th><th>Full Address</th><th>Full Name</th></tr>
</thead><tbody>";

$bus = "SELECT * FROM  `envios_mercadolibre` WHERE status != 'ENTREGADA'  AND status   !=    'CANCELADA' AND aviso != 1";
$bu = mysql_query($bus) or die("este");
while ($b = mysql_fetch_array($bu)){
$contenido = $b['contenido'];
$extra1 = $b['extra1'];
$extra2 = $b['extra2'];
$usuario_id = $b['usuario_id'];
$para1 = $b['id'];

$datosUsuario = "SELECT nombre, apellido, email from usuarios WHERE id = $usuario_id";
$datosU = mysql_query($datosUsuario) or die("foo");
while ($c = mysql_fetch_array($datosU)){
$nombre = $c['nombre'];
$apellido = $c['apellido'];
$email = $c['email'];

$todoelnombre = $nombre.", ".$apellido;

echo "<tr>
<td><select id='DropDownList' onchange='ReactToChange$para1()'>
<option value='later'>LATER</option>
<option value='comunicarse'>COMUNICARSE CON NOSOTROS</option>
<option value='esperando'>ESPERANDO CALIFICACION EN MERCADO LIBRE</option>
<option value='compro'>NO COMPRO</option>
<option value='custom'>CUSTOM</option>
</select></td>
<td>$email</td>
<td>$contenido</td>
<td>$extra1</td>
<td>$extra2</td>
<td>$todaladire</td>
<td>$todoelnombre
<input type='hidden' name ='datos-$para1' value ='$email' />
</td>
</tr>
";

}

}

echo "<tr><TD colspan ='7' align='center'><input type='submit' /></td></tr></table>";

?>

</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T03:41:14.930

如果没有看到您的数据库结构，很难说出确切的答案，但起初我不会在 while 循环中创建您的 javascript 函数，因为它会生成多个函数。最重要的是，如果您使用稍后使用适当参数调用的参数化 javascript 函数，您实际上不需要第一个 SELECT。

我已经修改了你的代码，请看下面更有效的 javascript 函数及其调用：

```
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<title></title>
<style>
table {
border-style:ridge;
border-width:1px solid;
border-collapse:collapse;
font-family:sans-serif;
font-size:12px;
width:100%;
}
table thead th, table.excel tbody th {
background:#CCCCCC;
border-style:ridge;
border-width:1;
text-align: center;
vertical-align:bottom;
}
table tbody th {
text-align:center;

}
table tbody td {
vertical-align:bottom;
}
table tbody td {
padding: 0 3px;
border: 1px solid 0000000;
}

table  td {
padding: 0 3px;
border: 1px solid 0000000;

}

</style>

<link rel="stylesheet" href="../css/style.css" type="text/css">

<script language="Javascript" type="text/javascript">
function ReactToChange(para,ptype)
{
    window.open(ptype+".php?id="+para);
}
</script>

</head>
<body>
<table width = "2200px">
<tr><td colspan="3" align="center"><a href="../index.php">Back to index</a></td></tr>
</table>
<br />
<?php 

echo "<form method='post' action='sendemails.php'>";
echo "<table  border='1' cellpading ='0' cellspacing ='0'>";
echo "<thead><tr><th>MAIL</th><th>Email Address</th><th>Content</th>
<th>Extra 1</th><th>Extra 2</th><th>Full Address</th><th>Full Name</th></tr>
</thead><tbody>";

$bus = "SELECT * FROM  `envios_mercadolibre` WHERE status != 'ENTREGADA'  AND status   !=    'CANCELADA' AND aviso != 1";
$bu = mysql_query($bus) or die("este");
while ($b = mysql_fetch_array($bu)){
$contenido = $b['contenido'];
$extra1 = $b['extra1'];
$extra2 = $b['extra2'];
$usuario_id = $b['usuario_id'];
$para1 = $b['id'];

$datosUsuario = "SELECT nombre, apellido, email from usuarios WHERE id = $usuario_id";
$datosU = mysql_query($datosUsuario) or die("foo");
while ($c = mysql_fetch_array($datosU)){
$nombre = $c['nombre'];
$apellido = $c['apellido'];
$email = $c['email'];

$todoelnombre = $nombre.", ".$apellido;

echo "<tr>
<td><select id='DropDownList' onchange='ReactToChange($para1,this.options[this.selectedIndex].value)'>
<option value='later'>LATER</option>
<option value='comunicarse'>COMUNICARSE CON NOSOTROS</option>
<option value='esperando'>ESPERANDO CALIFICACION EN MERCADO LIBRE</option>
<option value='compro'>NO COMPRO</option>
<option value='custom'>CUSTOM</option>
</select></td>
<td>$email</td>
<td>$contenido</td>
<td>$extra1</td>
<td>$extra2</td>
<td>$todaladire</td>
<td>$todoelnombre
<input type='hidden' name ='datos-$para1' value ='$email' />
</td>
</tr>
";

}

}

echo "<tr><TD colspan ='7' align='center'><input type='submit' /></td></tr></table>";

?>

</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-31T03:32:16.383

而不是编写多个函数，您可以编写

```
function ReactToChange(para)
{
  //only call document.getElementById("DropDownList").value once - good programming practice
  var dropdownvalue = document.getElementById("DropDownList").value;
  if (dropdownvalue  === "custom")
  {
     window.open("custom.php?id='"+para+"'")
  }
  else if (dropdownvalue  === "comunicarse")
  {
     window.open("comunicarse.php?id='"+para+"'")
  }
 ...
}

<select id='DropDownList' onchange='ReactToChange($para1)'>
  <option value='later'>LATER</option>
  ...
</select> 
```

现在您的代码更短了，因为您只有一个函数来处理所有事情请注意，您将“Id”作为参数传递

如果您有数千条记录，您将生成数千个函数来减慢页面速度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:40:15.993

不确定是否`.value`将始终正常工作。此时请考虑代码中的以下更改：

```
function ReactToChange'.$para.'()
{
    var dropdown = document.getElementById('DropDownList'),
    selectedValue = dropdown.options[dropdown.selectedIndex];

    // now make all comparisons against selectedValue
    // ...
    if (selectedValue === 'comunicarse') {
        window.open("comunicarse.php?id='.$para.'")
    }
    // ...
} 
```

# c - sscanf 不动，每次扫描相同的整数

> ID：10826953
> 
> 赞同：14
> 
> 时间：2012-05-31T03:08:09.247
> 
> 标签：c, string, input, scanf

我有一个包含整数的字符串，我正在尝试将所有整数放入另一个数组中。当`sscanf`找不到`int`我希望循环停止时。所以，我做了以下事情：

```
int i;
int getout = 0;
for (i = 0; i < bsize && !getout; i++) {
    if (!sscanf(startbuffer, "%d", &startarray[i])) {
        getout = 1;
    }
}
//startbuffer is a string, startarray is an int array. 
```

这导致 的所有元素`startarray`成为 中的第一个字符`startbuffer`。 `sscanf`工作正常，但它不会移动到下一个 int 它只是停留在第一个位置。

知道有什么问题吗？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-31T03:23:10.573

每次调用时都会传递相同的字符串指针`sscanf`。如果要“移动”输入，则每次都必须移动字符串的所有字节，这对于长字符串来说会很慢。此外，它将移动*未*扫描的字节。

相反，您需要通过查询消耗的字节数和读取的值数来自己实现这一点。使用该信息自行调整指针。

```
int nums_now, bytes_now;
int bytes_consumed = 0, nums_read = 0;

while ( ( nums_now = 
        sscanf( string + bytes_consumed, "%d%n", arr + nums_read, & bytes_now )
        ) > 0 ) {
    bytes_consumed += bytes_now;
    nums_read += nums_now;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T03:20:45.123

将字符串转换为流，然后您可以使用 fscanf 获取整数。试试这个。 [http://www.gnu.org/software/libc/manual/html_node/String-Streams.html](http://www.gnu.org/software/libc/manual/html_node/String-Streams.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-31T03:13:55.863

这是 sscanf 的正确行为。sscanf 对 a 进行操作`const char*`，而不是来自文件的输入流，因此它不会存储任何有关它所使用内容的信息。

至于解决方案，您可以`%n`在格式字符串中使用以获取它到目前为止已消耗的字符数（这是在C89标准中定义的）。

eg`sscanf("This is a string", "%10s%10s%n", tok1, tok2, &numChar);` `numChar`将包含到目前为止消耗的字符数。您可以将其用作偏移量以继续扫描字符串。

如果字符串只包含不超过 long 类型（或 long long 类型）最大值的整数，使用`strtol`or `strtoll`。请注意，`long`类型可以是 32 位或 64 位，具体取决于系统。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-05-31T03:13:57.693

你是对的：`sscanf`确实没有“移动”，因为没有什么可以移动。如果你需要扫描一堆整数，你可以使用`strtol`- 它告诉你它读了多少，所以你可以在下一次迭代中将 next 指针反馈给函数。

```
char str[] = "10 21 32 43 54";
char *p = str;
int i;
for (i = 0 ; i != 5 ; i++) {
    int n = strtol(p, &p, 10);
    printf("%d\n", n);
} 
```

# python - 使用 HTMLParser 获取精确符号

> ID：10826954
> 
> 赞同：0
> 
> 时间：2012-05-31T03:08:18.687
> 
> 标签：python, html-parser

`HTMLParser.unescape`行为如下：

```
>>> import HTMLParser
>>> h= HTMLParser.HTMLParser()
>>> h.unescape('alpha &lt; &beta;')
u'alpha < \u03b2' 
```

我应该怎么做才能得到确切的`beta`符号而不是`\u03b2`？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T03:49:11.053

`\u03b2` **是**“确切的`beta`符号”。

你必须学会​​区分事物和事物的表示。

您的字符串由小写字母 a、小写字母 l、小写字母 p、小写字母 h、小写字母 a、空格、左尖括号、空格和 beta 组成。

`u'...'`序列是字符串的表示。它向您展示了**一种可能**的字符序列，您可以将其*键入 Python 源文件*以表达该字符串的概念。`u'foo'`是字符串`foo`。也是如此`u'\x66\x6f\x6f'`。也是如此`u'\u0066\u006f\u006f'`。当您要求 Python 显示其中任何一个的表示形式时，它将显示`u'foo'`，因为 Python 认为这是该字符串的最简单表示形式。

当您**打印** `u'\u0066\u006f\u006f'`时，您将看到`foo`没有`u`前缀和引号的 ，因为现在您要求的是*文本*表示，而不是*源代码*表示。您可以对程序中的字符串执行相同操作：`print h.unescape('alpha &lt; &beta;')`，**如果**您的终端当前能够显示`β`，您应该会看到`alpha < β`。如果没有，您通常会收到 UnicodeEncodeError，因为 Python 尝试将字符串的*字节*表示形式发送到您的终端（使用某种字符串编码将字符转换为字节），并且编码不是经过设计的处理`β`。对于**该**问题，请参阅[Python、Unicode 和 Windows 控制台](https://stackoverflow.com/questions/5419/python-unicode-and-the-windows-console)

# php - Codeigniter 和 Facebook PHP SDK - 错误发布到用户墙

> ID：10826955
> 
> 赞同：3
> 
> 时间：2012-05-31T03:08:31.340
> 
> 标签：php, codeigniter, facebook-graph-api, facebook-php-sdk

我正在使用 FB PHP SDK 将消息发布到用户的墙上。一旦用户通过 FB 进行身份验证，我允许他们使用此帮助函数发布消息

```
function post_facebook($fb) {

    $CI =& get_instance();

    $CI->load->library('facebook');

    $config = array(
        'appId'  => '123123123123',
        'secret' => '567567567567'
    );

    $facebook = new Facebook($config);
    $user_id  = $facebook->getUser();

    if ($user_id) {

        $facebook->api('/me/feed', 'POST', array(
                                              'message' => $fb['post_text'],
                                           )
                   );
     }
} 
```

这实际上将帖子发送到 FB 并**显示**在墙上。

但是在 Firebug 中我可以看到这个错误

```
<h4>A PHP Error was encountered</h4>

<p>Severity: Warning</p>
<p>Message:  Missing argument 1 for Facebook::__construct(), called in /var/www/vhosts/example.com/httpdocs/system/core/Loader.php on line 1099 and defined</p>
<p>Filename: libraries/Facebook.php</p>
<p>Line Number: 36</p>

</div><div style="border:1px solid #990000;padding-left:20px;margin:0 0 10px 0;">

<h4>A PHP Error was encountered</h4>

<p>Severity: Notice</p>
<p>Message:  Undefined variable: config</p>
<p>Filename: libraries/Facebook.php</p>
<p>Line Number: 40</p>

</div> 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-31T03:22:51.470

您看到的错误来自对 的调用`$this->load->library('facebook')`，您应该将 $config 数组作为参数传递给它并从 CI 对象访问库，如下所示：

```
$config = array(
    'appId'  => '123123123123',
    'secret' => '567567567567'
);
$CI->load->library('facebook', $config);

$user_id  = $CI->facebook->getUser(); 
```

在此处阅读有关加载程序的更多信息：

[http://codeigniter.com/user_guide/libraries/loader.html](http://codeigniter.com/user_guide/libraries/loader.html)

# scala - scala 编码风格：根据可选值初始化 val Seq

> ID：10826956
> 
> 赞同：2
> 
> 时间：2012-05-31T03:08:33.630
> 
> 标签：scala, collections, coding-style

我正在开发一个简单的函数，它应该基于可能不存在的可选参数构建一个 sql 条件。

我正在尝试使用不可变值以及优雅和惯用的方式来完成它。

到目前为止，我带来了这样的东西：

```
val cond: Seq[String] = Nil ++ 
  (if (entity != "*") Seq("entity = {entity}") else Nil) ++
  (if (name != "*") Seq("name = {name}") else Nil) ++

val condition = 
  if (cond.size == 0) "" 
  else " where " + cond.mkString(" and ") + " " 
```

所以，我只是合并 Seqs，如果该值不存在，我将它与 Nil 合并

使用 var 我得到类似的东西：

```
var cond: Seq[String] = Seq();
if (entity != "*") cond = cond :+ "entity = {entity}"
if (name != "*") cond = cond :+ "name = {name}" 
```

我发现它更具可读性（我想知道第二种方法是否因为 var 而不是线程安全的）

我想知道解决此类问题的 scala 惯用且优雅的方法是什么

- 编辑

最后，我确定了这个实现：

```
val condition: String = {

  var cond: Seq[String] = Seq();

  if (entity != "") 
    cond = cond :+ "entity = {entity}"
  if (filter != "")
    cond = cond :+ """(name like {filter} or prev like {filter} or post like {filter})"""

  if (cond.size == 0) "" 
  else " where " + cond.mkString(" and ") + " "
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-31T03:37:12.010

不要重复自己：

```
def seqIf(r: String, s: String) = if (r != "*") Seq("%s = {%s}".format(s,s)) else Nil

val cond = seqIf(entity, "entity") ++ seqIf(name, "name") 
```

不仅是字符串：

```
def seqIf[A](p: Boolean, a: A) = if (p) Seq(a) else Nil

val cond = seqIf(entity != "*", "entity = {entity}") ++ 
  seqIf(name != "*", "name = {name}") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T07:12:31.663

另一种方法是保留可变结构，但隐藏在块中以避免副作用：

```
val cond = {
  var cs = Seq[String]()
  if (entity != "*") cs = cs :+ "entity = {entity}"
  if (name != "*") cs = cs :+ "name = {name}"
  cs
} 
```

这样的构造是完全安全的，因为`var`在块外无法访问。您还可以将 val 与可变构建器一起使用，例如`ListBuffer`. 在这种情况下。只要确保您没有将可变对象泄漏到块外：

```
import scala.collection.mutable.ListBuffer

val cond = {
  val cs = ListBuffer[String]()
  if (entity != "*") cs += "entity = {entity}"
  if (name != "*") cs += "name = {name}"
  cs.result() //Converts the ListBuffer into an immutable List
} 
```

这是完全可以接受的，因为块本身仍然是“纯的”。这种模式出现在 Scala API 中。

# ruby-on-rails - 在这种情况下，常规多态关联是否有效？

> ID：10826959
> 
> 赞同：0
> 
> 时间：2012-05-31T03:09:12.170
> 
> 标签：ruby-on-rails, ruby-on-rails-3, associations, polymorphic-associations

我有四个模型和这些关联

```
forums
  belongs to user
  has many topics
topics
  belongs to user AND forum (at the same time)
  has many posts
posts
  belongs to topic AND user (at the same time)
users
  has many forums
  has many topics
  has many posts 
```

我想弄清楚的问题是如何处理

```
topics  
  belongs to user AND forum (at the same time)
posts
  belongs to topic AND user (at the same time) 
```

[似乎常规的多态关联仅支持您有 EITHER OR 场景而不是 AND 场景的情况。](http://guides.rubyonrails.org/association_basics.html#polymorphic-associations)

因此，例如，我认为常规多态关联只支持这样的情况

```
comments
  belongs to EITHER photo OR blog 
```

代替

```
comments
  belongs to posts AND commenter 
```

常规的多态关联会起作用吗？如果没有，我还有什么其他选择？

# php - 这种格式有什么问题？

> ID：10826960
> 
> 赞同：-2
> 
> 时间：2012-05-31T03:09:42.497
> 
> 标签：php, mysql

我的代码格式有问题我相信我仍然不确定发生了什么导致此错误，

我收到错误解析错误：语法错误，意外的 T_VARIABLE，期待 '('

这是我的代码

```
<?php
$runamazonapi = false;
if $runamazonapi = true 
{
"run this code"
else
}  
//do nothing
{
    ?> 
```

如果 $runamazonapi = true，我在第 3 行或这部分收到以下错误

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T03:12:17.373

```
<?php
$runamazonapi = false;
if ($runamazonapi == true) 
{
    "run this code"
} 
else 
//do nothing
{

}
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T03:11:01.530

您的代码存在许多语法错误，但该错误意味着 php 解析器希望找到一个变量，`(`但却找到了一个变量。您需要`()`围绕 if 语句条件，并且需要关闭`}`第一个`if`条件。此外，您需要使用正确的`{}`方法来打开和关闭 else 子句：

```
<?php
$runamazonapi = false;
if ($runamazonapi = true)
{
"run this code"
}
else
{  
//do nothing
}
    ?> 
```

此外，您所拥有的将无法正常工作。您*分配* `$runamazonapi`给true，而不是检查它是否为true。你需要使用`==`not `=`：

```
<?php
$runamazonapi = false;
if ($runamazonapi == true)
{
"run this code"
}
else
{  
//do nothing
}
    ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T03:17:08.757

尝试

```
 if($runamazonapi){
 //run code
 }else{
 //do something
 } 
```

# apache - 使用 vlc、apache 网络服务器的 http 流式传输

> ID：10826964
> 
> 赞同：2
> 
> 时间：2012-05-31T03:09:53.977
> 
> 标签：apache, vlc, http-streaming

我想知道您是否可以在以下情况下帮助我。

目前我正在接收 H.264 格式的 udp 流，并希望使用 vlc 将其转码为移动设备格式并将其转换为流文件，然后我可以使用 apache Web 服务器提供该文件。

有没有人有关于如何做到这一点的教程？

谢谢你。

# asp.net - 在默认应用程序池中关闭回收是否安全

> ID：10826966
> 
> 赞同：2
> 
> 时间：2012-05-31T03:10:13.840
> 
> 标签：asp.net, asp.net-mvc, iis-7, application-pool

我的应用程序在应用程序启动时启动的计划任务很少。这些任务执行操作，然后休眠 X 时间。除了运行睡眠时间长于应用程序池中为回收设置的默认时间的任务之外，这工作得很好。

它是一个仅供内部使用的小型应用程序。该应用程序最多只能有 10-15 人同时登录，并且服务器上仅托管该应用程序。

我想知道关闭回收是否安全？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T08:05:02.220

我会告诉你一些经验。

我们不回收池，网站运行完美，没有任何问题！我们回收池的唯一时间通常是在下次重新启动时。

也许在一个共享环境中，许多不同的程序员在同一个池下运行，站点有问题并且忘记关闭处理程序，回收是必须的。

但是在一个受控环境中，您可以控制池上运行的内容，经过测试没有这个问题，没有抛出异常处理，不需要回收。

PS：*如果asp.net太差，需要时不时重启，那我就换个语言*。当然不是，如果程序良好且设计良好，它是非常稳定且良好的语言，可以运行数天（如果不是永远）。这是来自现实生活，拥有真实的站点、真实的服务器——而不仅仅是理论。

# transactions - 关于STM实现的问题

> ID：10826968
> 
> 赞同：3
> 
> 时间：2012-05-31T03:10:31.170
> 
> 标签：transactions, multicore, stm

我已经阅读了两个完全不同的关于 STM 是如何实现的说明。也许两者都是有效的，或者一个是错误的，我希望有人能阐明。

**采取 1**（维基百科）：允许所有线程修改共享内存，但事务中的每次读取和写入都会被记录。在事务结束时，系统检查其他线程是否没有同时对内存进行更改。如果未进行任何更改，则提交事务。否则，重新启动事务。

*   问：如果这是一个有效的实现，那么允许两个线程在同一个事务中执行似乎是没有用的。他们将读取彼此的写入，并且交易块内的计算将是错误的。

**取2**（找不到源）：当程序进入事务时，它会获取其中包含的所有变量的副本，并且可以对它们进行访问。在事务结束时，系统尝试用副本更新主控。如果自第一次复制后 master 没有更改，则提交事务。否则，重新启动事务。

另外，当两个线程同时进入同一个事务时会发生什么？这不会导致某种竞争条件吗？由于两者都试图修改相同的共享内存，因此两者都需要重新启动并且问题会无限期地继续下去，除非系统介入并告诉一个线程对其进行冷却（有点像锁=）我确定我是这里缺少一个概念。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-13T02:30:16.173

我不是专家，但读过几篇论文。与新技术提案一样，看起来一个小组提出了 STM，但其他​​小组的后续工作着眼于变体。不止你说的那两个。例如，这篇论文给出了一种在事务上具有阻塞锁的机制，而不是在你的两个中都采用积极的非阻塞方法：http: [//pages.cs.wisc.edu/~david/courses/cs758/Fall2007/papers/ saha-mcrt-ppopp-2007.pdf](http://pages.cs.wisc.edu/~david/courses/cs758/Fall2007/papers/saha-mcrt-ppopp-2007.pdf) 实现技术中唯一的共同点似乎是类似于数据库的事务语义。因此，研究的核心问题是这些*语义*是否会导致更好的程序和/或更高的效率。它们的实施方式有待商榷。

> 另外，当两个线程同时进入同一个事务时会发生什么？这不会导致某种竞争条件吗？由于两者都试图修改相同的共享内存，因此都需要重新启动...

并不真地。系统总是会取得进展，因为当 2 个或更多提交发生冲突时，日志允许将所有提交回滚到冲突事务开始的点。然后可以允许线程继续执行并按顺序提交。没错，这会导致重复工作，尤其是当单个对象需求量很大时。然而，只有当它比上下文交换更昂贵时，避免这种情况才是值得的。STM 的人打赌内存冲突是比较少见的。维基百科的方案在这个假设上特别激进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-09T14:20:09.430

这是一个答案的链接，其中概述了 TL2 STM 算法，并提供了几篇关于实现它以及如何将普通代码机械地转换为 STM 代码的相当易读的论文的链接：

[Stackoverflow：您如何实现软件事务内存？](https://stackoverflow.com/questions/1627600/how-do-you-implement-software-transactional-memory/12334438#12334438)

显然，这是一个活跃的研究领域，因此有很多方法。对给定问题最有效的方法取决于手头问题的并发性和读/写比率。

关于 TL2 算法，您的问题：

> ...允许两个线程在同一个事务中执行似乎没用。他们将读取彼此的写入，并且交易块内的计算将是错误的。

它是关于在事务期间看到什么数据（读取集）或更新（写入集），而不是它们正在执行什么代码。TL2 算法允许进行推测性工作，而无需持有任何锁，保持写入集对每个线程都是私有的，直到提交。在提交时，事务获取写锁，然后执行最终版本检查读取集版本是否仍然匹配主值版本（公共提交值），然后再将更新刷新到主值以增加其版本。当然，事务可以在提交之前看到它自己的私有更新和任何提交的主值，但不同的 tx 看不到彼此未刷新的写入集。如果其他一些事务同时提交并更改了读取集中看到的主版本，则 tx 被中止。这在应用程序逻辑运行时强制保持一致性而不持有锁。上面链接中的论文有更多的细节和优化。

> 另外，当两个线程同时进入同一个事务时会发生什么？这不会导致某种竞争条件吗？

是的，如果线程正在读取另一个线程将更新的值，那么线程在执行不同的工作时会与 TL2 竞争。由于在最终一致性检查中中止，工作可能会被丢弃。当发生这种情况时，您应该编写代码重试多次，直到您获得一致的读取，最终导致成功提交。希望是，如果您的服务器上有许多内核，您将通过偶尔丢弃内核的工作来获得比使用阻塞内核的粗粒度锁更多的总吞吐量。另一个希望是 STM 可以比手工制作避免死锁的最佳细粒度锁定方法更直接。显然，吞吐量取决于实际的应用程序逻辑和冲突。

> 由于两者都试图修改相同的共享内存，因此两者都需要重新启动并且问题会无限期地继续下去，除非系统介入并告诉一个线程对其进行冷却（有点像锁=）

您提到的活锁是通过在提交时锁定主值来避免的。以主值内存地址的升序内存顺序获取所有锁，您将不会出现死锁。两个线程之一将首先获得它需要的所有锁。另一个会阻塞。然后第一个线程将执行其读取集一致性检查，刷新它的写入集以增加主值，然后释放锁。第二个线程最终将获得它的所有锁，然后执行其读取集一致性检查，并由于看到该线程增加了它在其应用程序逻辑中使用的主值的版本而中止事务。

显然，这种提交时间锁定策略会阻塞线程，但不会在任意应用程序逻辑运行时保持锁定。这个关键部分可以积极调整。这些论文甚至提到了处理器指令，这些指令要求线程在持有这些锁的同时不间断地运行。

# asp.net-mvc - 了解域服务与应用程序服务与域实体中的行为（方法）

> ID：10826976
> 
> 赞同：1
> 
> 时间：2012-05-31T03:12:23.037
> 
> 标签：asp.net-mvc, architecture, domain-driven-design, service-layer

我们一直致力于为分层应用程序开发架构。我们计划有一个 ASP.NET MVC 表示层，它同时为移动浏览器和“普通”浏览器提供服务。也就是说，如果用户在移动设备上导航到网站，我们需要相同的 ASP.NET MVC 表示层来提供针对移动浏览器优化的视图，同时提供针对移动浏览器优化的“常规”视图如果用户使用的是台式机/笔记本电脑，则使用台式机/笔记本电脑浏览器。目前，我们不打算支持原生移动应用程序，但我们可能会在未来添加该功能。此外，该体系结构将具有域模型层——域实体、域服务等、应用程序服务、

但是，我一直在尝试找出域服务、应用程序服务和域实体中的行为（方法）之间的区别，因为它适用于我们正在开发的系统。下面是我们系统中的一个高级用例以供检查。

我们有报告和报告组。这两个实体之间存在多对多的关系。数据库表是：Reports <-> Jct_Reports_ReportGroups <-> ReportGroups，域实体看起来像：

```
Report class :
    public string ReportName { get; set; }
    ...
    public virtual ICollection<ReportGroup> ReportGroups { get; set; }

ReportGroup class :
    public string GroupName { get; set; }
    ...
    public virtual ICollection<Report> Reports { get; set; } 
```

当然，用户可以创建一个报告（不创建报告组），他们可以创建一个包含一个或多个报告的报告组。此外，用户可以删除报告。当这种情况发生时，会发生很多事情。首先，我们检查报告是否在任何报告组中（单个报告可以在许多不同的报告组中）。如果在任何报告组中找到该报告，我们将遍历每个报告组并从报告组中删除该报告（通过从 Jct_Reports_ReportGroups 表中删除一行）。然后，对于包含要删除的报告的每个报告组，我们检查报告组中是否还有其他报告。如果报告组中没有其他报告，我们也会删除报告组（通过从 ReportGroups 表中删除行）。如果报告组中还有其他报告，我们不会删除该报告组。如果所有这些操作都成功，我们将删除用户选择的要删除的报告（通过删除 Reports 表中的行）。最后，向用户显示一条消息，说明报表删除是否成功。

我希望这是一个足够的用例来帮助理解我们整个应用程序的一小部分。

我在某处读到域服务封装了不适合域对象的业务逻辑，并且不是典型的 CRUD 操作，而外部消费者使用应用程序服务与您的系统对话——如果消费者需要访问 CRUD 操作，他们会暴露在这里。但是，我只是不了解 POCO 域实体中会使用哪些方法（业务逻辑），哪些业务逻辑将被视为域服务并包含在业务层中，以及哪些业务逻辑将被视为包含在应用服务层。所以，我的主要问题是：鉴于上述用例，关于如何在域实体中区分域服务、应用程序服务和行为（方法）的建议是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-31T10:14:00.050

这是一个相当大的问题。

我更喜欢以下非严格的指导方针：

**应用服务**：假设我们有一组描述用户与系统交互的用例。假设我们有特定输入和输出的案例`Login`；`Cash transfer`他们还描述了成功和失败的场景。有了这个，我们通常有一个应用程序服务规范：我会公开两个方法`LoginResul Login(name, pass)`，`TransferResult CashTrasnfer(from, to, amount)`或多或少相同的输入和输出以及成功/失败行为。

很明显，为了实现用例，应用程序服务调用 BL（但添加了安全性和其他特定于应用程序的检查）。

**域服务**：正如您所描述的：“不自然地适合域对象”。

有了 CashTransnfer 用例，我们必须：

*   加载帐户“来自”
*   加载帐户“到”
*   check 'from' balance' //可能会返回错误
*   验证帐户访问（锁定等）//可能返回错误
*   从“来自”中提取“金额”
*   把金额放在“到”
*   （理想情况下，这应该是一个单一的“业务”交易）。

很明显，这个函数不适合 Account 实体——所以最好有一个特殊`TransferService`的。

* * *

特别是关于报告/报告组功能 - 它可能是实体范围，因为没有非逻辑引用（所有项目都可以从报告中访问）：

```
Report.Remove() {
    foreach(group in Groups) {
        group.RemoveReport(this);
    }
    repository.Remove(this);
} 
Group.RemoveReport(report) {
    reports.Remove(report);
    if(reports.Count == 0)
        repository.Remove(this);
} 
```

或在报告服务和实体之间拆分（引用存储库可能有问题）：

```
Report.RemoveFromAllGroups() {
   foreach(group in Groups) {
        group.RemoveReport(this);
        if(group.IsEmpty)
            //add to collection to return
    }
}
Service.Remove(report) 
{
    var emptyGroups = report.RemoveFromAllGroups();
    reportRepo.Remove(report);
    groupRepo.Remove(emptyGroups);
} 
```

# linux - 如何以编程方式在 linux 系统中创建文件以及沿路径丢失的目录？

> ID：10826978
> 
> 赞同：1
> 
> 时间：2012-05-31T03:12:55.600
> 
> 标签：linux, create-directory

我想在我的程序中在 linux 系统上创建一个文件，比如 /a/b/c/test，目前我只有 dir /a 存在并且我想在我的程序中执行它，是否有任何函数可以创建文件为以及在一笔交易中缺少目录（即创建 b/c/test）？如果路径上缺少目录，open、fopen、mkdir 似乎都无法工作。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-31T03:15:56.827

我认为你需要两个命令：

```
$ mkdir -p /a/b/c/ && touch /a/b/c/test 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-31T03:24:01.943

来自`strace mkdir -p a/b/c`：

```
mkdir("a", 0751)                        = 0
open("a", O_RDONLY|O_NOCTTY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|O_NOFOLLOW) = 3
fchdir(3)                               = 0
close(3)                                = 0
mkdir("b", 0751)                        = 0
open("b", O_RDONLY|O_NOCTTY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|O_NOFOLLOW) = 3
fchdir(3)                               = 0
close(3)                                = 0
mkdir("c", 0751)                        = 0 
```

换句话说，您必须`mkdir()`在每个目录的循环中调用自己，然后创建文件。这就是`mkdir`exe 的执行方式（在 C 中）。为什么不`mkdir -p /a/b/c`使用 运行命令`execve`？当然，为调用正确设置了 C 内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-31T03:16:06.413

抱歉，您必须对两步过程感到满意：

```
mkdir -p /a/b/c
touch /a/b/c/test 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-31T05:23:09.317

如果您使用[Glib](http://developer.gnome.org/glib/)（Gtk 的最低级别库，可以独立使用），您可以调用[g_mkdir_with_parents](http://developer.gnome.org/glib/2.32/glib-File-Utilities.html#g-mkdir-with-parents)来创建所有目录（就像`mkdir -p`命令一样）

# c# - 使用 LINQ 拆分数组

> ID：10826994
> 
> 赞同：11
> 
> 时间：2012-05-31T03:15:11.823
> 
> 标签：c#, .net, arrays, linq, linq-to-objects

我有一个这样的单维集合：

```
[1,2,4,5.....n] 
```

我想将该集合转换为这样的二维集合：

```
[[1,2,3],
[4,5,6],
...] 
```

基本上我想分组或拆分，如果你愿意，数组中的'n'个成员组

我可以用一个`foreach`语句来做到这一点，但我目前正在学习 LINQ，所以我不想遍历所有元素并手动创建一个新数组，我想使用 LINQ 功能（如果适用）

是否有任何 LINQ 函数可以帮助我完成此任务？

我在想，`GroupBy`或者`SelectMany`我不知道他们是否会帮助我，但他们可能会

任何帮助将不胜感激=）：**

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-31T03:31:00.677

您可以按索引除以批量大小进行分组，如下所示：

```
var batchSize = 3;
var batched = orig
    .Select((Value, Index) => new {Value, Index})
    .GroupBy(p => p.Index/batchSize)
    .Select(g => g.Select(p => p.Value).ToList()); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-31T03:19:39.740

使用[MoreLinq](http://code.google.com/p/morelinq/) .Batch

```
 var result = inputArray.Batch(n); // n -> batch size 
```

例子

```
 var inputs = Enumerable.Range(1,10);

    var output = inputs.Batch(3);

    var outputAsArray = inputs.Batch(3).Select(x=>x.ToArray()).ToArray(); //If require as array 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-31T03:18:42.627

你想要`Take()`和`Skip()`。这些方法可以让你拆分一个`IEnumerable`. 然后，您可以`Concat()`再次将它们拍打在一起。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-31T03:19:04.170

它不是纯粹的 LINQ，但它打算与它一起使用：

```
public static class MyEnumerableExtensions
{
    public static IEnumerable<T[]> Split<T>(this IEnumerable<T> source, int size)
    {
        if (source == null)
        {
            throw new ArgumentNullException("source can't be null.");
        }

        if (size == 0)
        {
            throw new ArgumentOutOfRangeException("Chunk size can't be 0.");
        }

        List<T> result = new List<T>(size);
        foreach (T x in source)
        {
            result.Add(x);
            if (result.Count == size)
            {
                yield return result.ToArray();
                result = new List<T>(size);
            }
        }
    }
} 
```

它可以从您的代码中用作：

```
private void Test()
{
    // Here's your original sequence
    IEnumerable<int> seq = new[] { 1, 2, 3, 4, 5, 6 };

    // Here's the result of splitting into chunks of some length 
    // (here's the chunks length equals 3). 
    // You can manipulate with this sequence further, 
    // like filtering or joining e.t.c.
    var splitted = seq.Split(3);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-31T03:42:18.660

下面的示例将一个数组拆分为每组 4 个项目。

```
int[] items = Enumerable.Range(1, 20).ToArray(); // Generate a test array to split
int[][] groupedItems = items
                         .Select((item, index) => index % 4 == 0 ? items.Skip(index).Take(4).ToArray() : null)
                         .Where(group => group != null)
                         .ToArray(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-13T13:43:14.687

它很简单：

```
static class LinqExtensions
{
    public static IEnumerable<IEnumerable<T>> ToPages<T>(this IEnumerable<T> elements, int pageSize)
    {
        if (elements == null)
            throw new ArgumentNullException("elements");
        if (pageSize <= 0)
            throw new ArgumentOutOfRangeException("pageSize","Must be greater than 0!");

        int i = 0;
        var paged = elements.GroupBy(p => i++ / pageSize);
        return paged;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-01-11T15:53:05.907

我基于[Jeremy Holovacs 的](https://stackoverflow.com/a/10827020/11522147)答案的解决方案，并使用 Take() 和 Skip() 创建子数组。

```
 const int batchSize = 3;
        int[] array = new int[] { 1,2,4,5.....n};

        var subArrays = from index in Enumerable.Range(0, array.Length / batchSize + 1)
                      select array.Skip(index * batchSize).Take(batchSize); 
```