# StackOverflow 问答 000063000-000063999

# c# - C# SQL 将数据库恢复到默认数据位置

> ID：63008
> 
> 赞同：6
> 
> 时间：2008-09-15T13:46:42.680
> 
> 标签：c#, sql

我正在编写一个 C# 应用程序，它通过 FTP 下载压缩的数据库备份。然后，应用程序需要提取备份并将其还原到默认数据库位置。

我不知道运行应用程序的机器上将安装哪个版本的 SQL Server。因此，我需要根据实例名称（在配置文件中）找到默认位置。

我发现的示例都有一个他们读取的注册表项，但这不起作用，因为这假设只安装了一个 SQL 实例。

我发现的另一个示例创建了一个数据库，读取该数据库的文件属性，完成后删除该数据库。那只是麻烦。

我确实在 .NET 框架中找到了一些应该可以工作的东西，即：

```
Microsoft.SqlServer.Management.Smo.Server(ServerName).Settings.DefaultFile
```

问题是这会返回空字符串，这无济于事。

我还需要找出运行 SQL 服务的 NT 帐户，以便在提取备份文件后授予该用户对备份文件的读取权限。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-23T08:02:50.667

我发现的是

```
Microsoft.SqlServer.Management.Smo.Server(ServerName).Settings.DefaultFile 
```

只有在没有明确定义路径时才返回非空值。只要您指定了一个非默认路径，此函数就会正确返回该路径。

因此，一个简单的解决方法是检查此函数是否返回字符串或 null。如果它返回一个字符串，则使用它，但如果它为空，则使用

```
Microsoft.SqlServer.Management.Smo.Server(ServerName).Information.RootDirectory + "\\DATA\\" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T14:15:16.387

一种方法是使用与主数据库相同的位置。您可以使用以下 SQL 查询 SQL Server 实例：

```
select filename from master.dbo.sysdatabases where name = 'master' 
```

这将返回主数据库的完整路径。使用该路径，您可以使用 FileInfo 对象仅提取该路径的目录部分。这避免了为您尝试连接的 SQL Server 实例检查注册表的猜测工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T14:07:29.557

一种可能是更简单的解决方案的选项是在您的目标服务器上创建一个新数据库，然后使用您的备份在该数据库上恢复。您的备份将在正确的位置，当您恢复备份文件时，您不必大惊小怪地“移动”备份文件。SQL 期望备份恢复到与它们备份时完全相同的物理路径。如果不是这种情况，您必须在 RESTORE 期间使用 MOVE 选项。例如，如果您想在名称上添加日期，此解决方案还可以更轻松地在此过程中重命名数据库。

# javascript - JavaScript 中的无限循环不会触发浏览器警告

> ID：63011
> 
> 赞同：1
> 
> 时间：2008-09-15T13:46:50.400
> 
> 标签：javascript, loops

我正在使用 Google 地图将一组图像显示为叠加层。显示这些图像应该无限循环，但大多数浏览器都会检测到这一点，并显示警告。

有没有办法在 JavaScript 中创建一个无限循环，以便浏览器不会停止或警告它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-15T13:49:30.533

尝试[setInterval](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval)或[setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/settimeout)。

这是一个例子：

```
(show = (o) => setTimeout(() => {

  console.log(o)
  show(++o)

}, 1000))(1);
```

```
.as-console-wrapper { max-height: 100% !important; top: 0; }
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T13:50:23.963

您应该使用计时器来不断带来新图像，而不是无限循环。检查`setTimeout()`功能。需要注意的是，您应该在调用自身的函数中调用它，以便它再次等待。取自[w3schools](http://www.w3schools.com/js/js_timing.asp)的示例：

```
var c = 0
var t;

function timedCount() {
  document.getElementById('txt').value = c;
  c = c + 1;
  t = setTimeout("timedCount()", 1000);
}
```

```
<form>
  <input type="button" value="Start count!" onClick="timedCount()">
  <input type="text" id="txt">
</form>
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T13:57:00.797

以下代码将设置一个间隔，并将图像设置为每秒图像源数组中的下一个图像。

```
function setImage(){
  var Static = arguments.callee;
  Static.currentImage = (Static.currentImage || 0);
  var elm = document.getElementById("imageContainer");
  elm.src = imageArray[Static.currentImage++];
}
imageInterval = setInterval(setImage, 1000); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T13:51:26.427

与其使用无限循环，不如创建一个每隔 n 秒触发一次的计时器 - 您将获得“永远运行”方面，而不会导致浏览器挂起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T13:50:04.277

也许尝试使用一个计时器，它每次滴答作响时都会检索下一个图像，不幸的是我不知道任何 JavaScript，所以我无法提供代码示例

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T13:54:03.770

```
function foo() {
  alert('hi');
  setTimeout(foo, 5000);
} 
```

然后只需使用“onload”之类的动作来启动“foo”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T14:04:49.373

如果它适合您的情况，您可以继续加载新图像以响应用户交互，就像[这个网站一样](http://flickriver.com/photos)（只需向下滚动）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T16:38:45.683

只是一个正式的答案：

```
var i = 0;

while (i < 1) {
   do something...

   if (i < 1) i = 0;
   else i = fooling_function(i);  // must return 0
} 
```

我认为没有浏览器会检测到这样的事情。

# java - IKVM 中的缓冲图像

> ID：63030
> 
> 赞同：0
> 
> 时间：2008-09-15T13:48:27.543
> 
> 标签：java, .net, bufferedimage, ikvm, notimplementedexception

`BufferedImage`用 IKVM 替换我正在转换为 .NET 的 Java 项目的缺失功能的最佳和/或最简单的方法是什么？

运行应用程序时，我基本上得到“ `cli.System.NotImplementedException`：*BufferedImage* ”异常，否则运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T18:24:15.663

IKVM 中的 AWT 代码相当容易阅读和编辑。我建议您查找您正在使用的引发该异常的方法，然后实现它们。我之前用 IKVM 的 AWT 实现做过几次，发现后台/服务器相关的功能很容易做到。但是，如果您的应用程序是桌面应用程序，那么它的可用性就会大大降低。

# javascript - 组织 ExtJS 项目的最佳方式

> ID：63035
> 
> 赞同：16
> 
> 时间：2008-09-15T13:48:44.437
> 
> 标签：javascript, php, json, extjs

我刚刚开始开发一个 ExtJS 应用程序，我计划用一个非常轻量级的 JSON PHP 服务来支持它。除此之外，它将是独立的。我的问题是，组织将不可避免地存在的文件和类的最佳方式是什么？任何人都有大型 ExtJS 项目（几千行）的经验。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-16T21:17:08.517

我将从这里开始[http://blog.extjs.eu/know-how/writing-a-big-application-in-ext/](http://blog.extjs.eu/know-how/writing-a-big-application-in-ext/)

该站点对如何构建应用程序进行了很好的介绍性概述。

我们目前在我们的两个 ASP.NET MVC / ExtJS 应用程序中使用这些想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-18T17:14:46.180

我建议用户愿意等待应用程序加载，因此我们通常在应用程序初始启动时加载所有 JS。我建议根据需要加载和评估 JS 文件是不必要的——尤其是当所有 JS 在部署到生产之前都将被缩小时。

我建议使用命名空间，每个文件一个类，以及一个定义明确且记录良好的类层次结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T13:59:54.393

在开发应用程序时，您的文件和文件夹结构并不重要，因为您可能希望最小化发布代码并在完成后将其粘贴到单个 JS 文件中。自动处理程序或构建脚本可能是最好的选择（请参阅[http://extjs.com/forum/showthread.php?t=44158](http://extjs.com/forum/showthread.php?t=44158)）。

也就是说，我在 ExtJS 论坛上的某个地方读到过，建议每个类使用一个文件，我可以根据自己的经验证明这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T14:41:48.397

在开始新的大项目时，我决定将其模块化。通常，在大型项目中，并非所有模块都由特定用户使用，因此我按需加载它们。Fe，如果一个项目有 50 多个模块，那么用户很可能只使用 10 个模块。

这样的架构让您的初始代码相对较小。

模块存储在服务器上并由 AJAX 调用加载，评估 AJAX 回调中的 responseText。唯一的问题是，您必须跟踪模块依赖关系，这些依赖关系也可以存储在模块中。我有一个名为 Module 的类，我检查每个新模块实例是否存在于任务中。如果它还不存在，我从服务器加载它。

# actionscript-3 - AS3 FTP 编程和 Socket 和 ByteArray 类

> ID：63038
> 
> 赞同：3
> 
> 时间：2008-09-15T13:49:16.620
> 
> 标签：actionscript-3, sockets, ftp, bytearray

很抱歉主题行听起来像是一个更书呆子的哈利波特标题。

我正在尝试使用 AS3 的 Socket 类编写一个简单的 FTP 程序，以在 Flex Builder 3 中导出为 AIR 应用程序。我正在使用本地网络上的 FTP 服务器来测试程序。我可以成功连接到服务器（简单的部分），但我无法发送任何命令。我很确定您必须使用 ByteArray 类来发送这些命令，但是我显然遗漏了一些关键信息。有谁知道如何做到这一点？谢谢！戴夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T01:17:11.897

FTP 协议早于 UTF 编码。切换到 ANSI/ASCII 以获得更好的结果。如果您确实选择了 writeMultiByte 而不是 writeUTFBytes，请注意它在 linux 中存在错误。[这是](http://www.flexiblefactory.co.uk/flexible/?p=75)解决它的一种方法。

[这里](https://stackoverflow.com/questions/285290/trying-to-send-an-http-request-over-sockets)还有一个问题，行尾是罪魁祸首，所以请确保你做对了（如上所述）。

如前所述，如果这是从 Web 运行的，则所有套接字连接都需要跨域策略，但这不是基于 HTTP 的文件。最近对安全规则的更改意味着任何基于套接字的连接必须首先从托管在目标主机端口 843 上的策略服务器获取跨域。

引自 Adob​​e：

> 如果没有套接字策略文件，SWF 文件可能不再与自己的域建立套接字连接。在版本 9,0,115,0 之前，SWF 文件可以在没有策略文件的情况下在其自己的域中建立与端口 1024 或更大端口的套接字连接。
> 
> HTTP 策略文件可能不再用于授权套接字连接。在版本 9,0,115,0 之前，从 /crossdomain.xml 在端口 80 的主位置提供的 HTTP 策略文件可用于授权与同一主机上任何端口 1024 或更高端口的套接字连接。

本质上，这意味着您必须控制目标 FTP 主机，并在其上安装补充软件才能使其正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-10T16:59:15.790

我已经能够让 FTP 客户端在浏览器中工作，但它有问题。我必须在端口 843 上运行一个侦听器来为策略文件提供服务，以便允许 Flash 连接和传输数据。然后，我必须弄清楚 FTP 的实际工作原理：

您必须打开 2 个套接字：一个命令套接字和一个数据套接字。命令套接字是您发送 USER、PASS、CWD 和 STOR 命令的地方。数据套接字是您将 ByteArray 数据写入的位置。发送 PASV 命令将告诉您数据套接字必须连接到哪个端口。

在 Mac 上，在 Safari 和 FF 中，当我调用“socket.close()”命令时，服务器套接字实际上会关闭。在 Windoze 上，它没有。这是一个大问题，因为在服务器关闭连接之前不会触发 Event.CLOSE 事件。这是在 livedocs 中。

这就是我所在的地方。我不知道为什么它会在 Mac 上完美运行，然后在 Windows 上的 3 种不同浏览器中完全崩溃。我唯一能想到的是，它要么是我的 Windows 配置中的某些东西阻止了与服务器的正常通信，要么是 Window Flash 播放器导致了问题。

有什么想法吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-20T10:43:59.127

也阅读[这个链接，也许](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS1EFE2EDA-026D-4d14-864E-79DFD56F87C6.html)[这个](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cf7.html)链接也很有用。

第一个是关于策略文件的，第二个是 TELNET（所以，这里没有 FTP）客户端的示例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T17:27:44.387

你 100% 确定语法是正确的吗？我知道对于 HTTP，您必须在请求通过后包含额外的换行符。没有它，您将一无所获。不知道它是如何与FTP虽然。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T17:12:57.830

我们需要更多信息来解决这个问题。你在这里说的对我来说似乎是正确的。您使用的是 Socket 类来发送数据，而不是 ByteArray。

您确定没有发送数据吗？您如何收到回复？可能是它工作正常，但您只是不知道吗？正如我所说，告诉我们更多关于你在做什么..

Lee Brimelow[在 gotoAndLearn](http://gotoandlearn.com/play?id=69)上有一个关于编写 POP3 客户端的截屏视频。这与您正在做的事情基本相同，因此请看一下。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-14T04:30:39.870

根据我收集到的信息，您必须一次发送一个命令并在继续之前验证响应。你应该得到一些反对 ProgressEvent.SOCKET_DATA 的东西

试试这个，看看你会得到什么回应。

```
socket.writeUTFBytes("USER "+user+"\n"); socket.flush(); 
```

然后，您将像这样读出响应。

```
var response:String = mySocket.readUTFBytes(mySocket.bytesAvailable); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-02T12:12:22.760

FTP 标准要求在命令末尾使用 CRLF。尝试在您的示例中使用“\r\n”代替“\n”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-21T23:19:20.103

您必须从 FTP 服务器提供跨域策略文件才能正确连接。

# java - 我如何学习 Java5 或 Java6？

> ID：63042
> 
> 赞同：5
> 
> 时间：2008-09-15T13:49:50.660
> 
> 标签：java

我是一位非常有经验的 Java 程序员，我整个时间都在使用 Java 1.4 及更早版本。我在哪里可以找到一个快速参考，它可以提供我需要了解的有关 Java5 中的新功能的所有信息，以及以后的快速参考？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T13:53:49.213

[Java 5 新特性](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html)

[Java 6 新特性](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html)

真正的肉在 Java 5 中。泛型、自动装箱、注释。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T13:52:24.553

这是一个很好的起点：

[https://docs.oracle.com/javase/1.5.0/docs/relnotes/features.html](https://docs.oracle.com/javase/1.5.0/docs/relnotes/features.html)

[http://java.sun.com/developer/technicalArticles/releases/j2se15/](https://web.archive.org/web/20081011231920/http://java.sun.com/developer/technicalArticles/releases/j2se15)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T14:55:59.127

我会彻底推荐Brian Goetz、Tim Peierls、Joshua Bloch 和 Joseph Bowbeer 的[Java Concurrency in Practice 。](http://www.amazon.co.uk/Java-Concurrency-Practice-Brian-Goetz/dp/0321349601/ref=sr_1_1?ie=UTF8&s=books&qid=1221490235&sr=8-1)它只关注良好的并发编码，但包含有关 Java 5 和 6 库中新并发特性的出色指导。

当然，它对其他特性一点帮助都没有，但是如果你曾经处理过线程（如果你有一个 GUI，那么你就有了线程），那么这本书是必不可少的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-03T02:33:55.270

Java 5 引入了几项重大更新，例如语言改进（即注释、泛型、自动装箱和改进的循环语法）等等。注释是一种用元数据标记类的机制，以便元数据感知程序可以使用它们。泛型是一种为属于集合的对象（例如 Arraylist）指定类型的机制，以便在编译时保证类型安全。自动装箱允许基本类型（例如 int）和包装类型（例如 Integer）之间的自动转换。改进的循环语法包括对每个循环的增强，以便比较容易地遍历数组或集合的项目。

Java 6 专注于新规范和 API，包括 XML、Web 服务、JDBC 4.0 版、基于注释的编程、Java 编译器 API 和应用程序客户端 GUI。随着 Java 6 添加了新的编译器 API，Java 编译器现在可以接收和/或将输出发送到文件系统的抽象（程序可以指定/处理编译器输出）。此外，Java 6 在 AWT（更快的启动屏幕和对系统托盘的支持）和 SWING（更好的拖放、对自定义布局的支持、多线程增强和编写 GIF 图像的能力）中添加了对应用程序 GUI 功能的增强。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T13:59:22.650

我可以推荐 Bruce Eckel 的“Thinking in Java”第 4 版。他回顾了一堆你可以跳过的基本内容，但他对 1.5 新特性的处理非常透彻，尤其是关于泛型的章节。它是一个很好的 Java 参考。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T13:59:24.427

[Dietel：如何编写 Java](https://rads.stackoverflow.com/amzn/click/com/0132222205)

强烈推荐这本书。什么都教，做得好。从简单的 Hello World 开始，到您编写自己的 BASIC 编译器结束。也处理数据库。什么都做，嗯，设计。只是不能说足够。

它也是一本漂亮的书，我的意思是在设计和色彩方面，它并不枯燥。

# .net - WCF Datacontract 免费序列化 (3.5 SP1)

> ID：63043
> 
> 赞同：3
> 
> 时间：2008-09-15T13:49:51.127
> 
> 标签：.net, wcf, serialization

有没有人让这个真正起作用？关于如何启用此功能的文档不存在，尽管有一个 3.5 SP1 项目，但我仍然缺少属性异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T15:11:50.273

我让它在一个测试应用程序上工作得很好......

服务定义：

```
[ServiceContract]
public interface IService1
{

    [OperationContract]
    CompositeType GetData(int value);

}

public class CompositeType
{
    bool boolValue = true;
    string stringValue = "Hello ";

    public bool BoolValue
    {
        get { return boolValue; }
        set { boolValue = value; }
    }

    public string StringValue
    {
        get { return stringValue; }
        set { stringValue = value; }
    }
} 
```

服务实施：

```
public class Service1 : IService1
{
    public CompositeType GetData(int value)
    {
        return new CompositeType()
        {
            BoolValue = true,
            StringValue = value.ToString()
        };
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T08:07:12.893

我发现它不适用于内部/私有类型，但是将我的类型公开它工作正常。这意味着也没有匿名类型:(

使用反射器，我找到了似乎做出决定的方法 ClassDataContract.IsNonAttributedTypeValidForSerialization(Type)。这似乎是杀手的最后一行，类型必须是可见的，所以不允许内部/私有类型:(

```
internal static bool IsNonAttributedTypeValidForSerialization(Type type)
{
    if (type.IsArray)
    {
         return false;
    }
    if (type.IsEnum)
    {
        return false;
    }
    if (type.IsGenericParameter)
    {
        return false;
    }
    if (Globals.TypeOfIXmlSerializable.IsAssignableFrom(type))
    {
        return false;
    }
    if (type.IsPointer)
    {
        return false;
    }
    if (type.IsDefined(Globals.TypeOfCollectionDataContractAttribute, false))
    {
        return false;
    }
    foreach (Type type2 in type.GetInterfaces())
    {
        if (CollectionDataContract.IsCollectionInterface(type2))
        {
            return false;
        }
    }
    if (type.IsSerializable)
    {
        return false;
    }
    if (Globals.TypeOfISerializable.IsAssignableFrom(type))
    {
        return false;
    }
    if (type.IsDefined(Globals.TypeOfDataContractAttribute, false))
    {
        return false;
    }
    if (type == Globals.TypeOfExtensionDataObject)
    {
        return false;
    }
    if (type.IsValueType)
    {
        return type.IsVisible;
    }
    return (type.IsVisible && (type.GetConstructor(BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance, null, Globals.EmptyTypeArray, null) != null)); 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T14:46:38.417

WCF 中有几个序列化选项：数据协定、XML 序列化和原始数据有效负载。您想使用其中哪些？从问题来看，您似乎正在尝试使用除用 datacontact 属性装饰的对象以外的其他东西。这就是你要问的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T14:52:12.397

是的，我正在尝试使用作为 SP1 的一部分宣布的无属性序列化（[http://www.pluralsight.com/community/blogs/aaron/archive/2008/05/13/50934.aspx](http://www.pluralsight.com/community/blogs/aaron/archive/2008/05/13/50934.aspx)）。该死的，如果我能让它工作并且没有它的文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T15:16:05.287

可能我对抽象基类的使用使事情变得混乱，尽管我将所有内容都添加到已知类型列表中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-16T16:31:43.227

是的，它可能与抽象类和继承有关。它有时会与序列化混淆。此外，如果一切都不是公开的，它也可能是类和类层次结构的可见性。

# wcf - 有没有办法告诉 WCF 在请求中使用安全性，但在响应中忽略它？

> ID：63067
> 
> 赞同：2
> 
> 时间：2008-09-15T13:52:25.223
> 
> 标签：wcf, soap, axis

我们必须连接到第三方 SOAP 服务，并且我们正在使用 WCF 来执行此操作。该服务是使用 Apache AXIS 开发的，我们无法控制它，也无法改变它的工作方式。我们看到的问题是它希望使用 Web 服务安全性对请求进行格式化，因此我们正在执行所有正确的签名等操作。然而，来自第 3 方的响应是不安全的。如果我们嗅探电线，我们会看到响应正常（尽管没有任何时间戳、签名等）。底层 .NET 组件将此视为错误，因为它认为这是一个安全问题，因此我们实际上并没有收到这样的肥皂响应。有什么方法可以配置 WCF 框架以发送安全请求，但不要期望响应中的安全字段？查看 OASIS 规范，它没有

有关信息，这是我们看到的异常：

我们收到的例外是：

```
System.ServiceModel.Security.MessageSecurityException was caught
  Message="Security processor was unable to find a security header in the message. This might be because the message is an unsecured fault or because there is a binding mismatch between the communicating parties.   This can occur if the service is configured for security and the client is not using security."
  Source="mscorlib"
  StackTrace:
    Server stack trace:
       at System.ServiceModel.Security.TransportSecurityProtocol.VerifyIncomingMessageCore(Message& message, TimeSpan timeout)
       at System.ServiceModel.Security.TransportSecurityProtocol.VerifyIncomingMessage(Message& message, TimeSpan timeout)
       at System.ServiceModel.Security.SecurityProtocol.VerifyIncomingMessage(Message& message, TimeSpan timeout, SecurityProtocolCorrelationState[] correlationStates)
       at System.ServiceModel.Channels.SecurityChannelFactory`1.SecurityRequestChannel.ProcessReply(Message reply, SecurityProtocolCorrelationState correlationState, TimeSpan timeout)
       at System.ServiceModel.Channels.SecurityChannelFactory`1.SecurityRequestChannel.Request(Message message, TimeSpan timeout)
       at System.ServiceModel.Dispatcher.RequestChannelBinder.Request(Message message, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout) 
```

顺便说一句，我看到很多帖子都说如果你不考虑时间戳，那么安全字段就不会出现。这不是一个选项 - 我们正在与之通信的服务要求时间戳。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-09T18:10:32.130

Microsoft 现在有此功能的修补程序。

[http://support.microsoft.com/kb/971493](http://support.microsoft.com/kb/971493)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T14:57:20.683

有趣的是你应该问这个问题。大约一年前，我问微软如何做到这一点。当时，使用 .NET 3.0 是不可能的。不确定这在 3.5 世界中是否发生了变化。但是，不，没有物理方法可以为请求增加安全性并使响应为空。

在我以前的雇主中，我们使用了一个模型，该模型需要在请求中使用证书的 WS-Security 标头，但响应是不安全的。

您可以使用 ASMX Web 服务和 WSE 执行此操作，但不能使用 WCF v3.0。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T14:57:55.143

您很有可能无法单独使用配置。我必须与 Axxis 进行一些集成工作（我们的目标是 WSE3——WCF 的祖先），并且我必须编写一些代码并将其粘贴到 WSE3 的管道中，以便在将 Axxis 的响应传递给 WSE3 之前对其进行处理。好消息是，将这些处理程序添加到管道非常简单，一旦进入处理程序，您就可以获得一个 SoapMessage 的实例，并且可以使用它做任何您想做的事情（例如删除时间戳）

# javascript - 为SVG + Javascript框架寻求一个好的解决方案

> ID：63081
> 
> 赞同：14
> 
> 时间：2008-09-15T13:54:22.660
> 
> 标签：javascript, frameworks, svg

我希望听到其他人使用 SVG + Javascript 框架的经验。

我希望框架处理的事情——DOM 创建、事件处理和最小尺寸。

Jquery SVG 插件 - [http://keith-wood.name/svg.html](http://keith-wood.name/svg.html)似乎是我能找到的唯一一个。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-15T14:12:30.010

[Raphael](http://dmitrybaranovskiy.github.io/raphael/)是一个用于处理矢量图形的 JavaScript 框架，可以使用 SVG 或 VML，具体取决于浏览器支持的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-09-05T14:09:06.697

检查[D3 库](http://mbostock.github.com/d3/)

> D3.js 是一个小型、免费的 JavaScript 库，用于根据数据操作文档。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-20T21:02:41.300

我最喜欢的 JavaScript 框架是 jQuery。但是由于某些 HTML 特定的地方，原始的 jQuery 包无法在 SVG 中运行。

但我已经修补了最新版本的 jQuery (1.4.2)，所以它现在可以在 SVG 下运行。您可以[从此处获取已修补的 jQuery 包](http://hgcoaxial.appspot.com/static/jquery-1.4.2.svg.js)。

它的一个问题是 SVG 不会从包含的 jQuery 源调用初始化函数，所以我要引入`jQueryInitialize`函数并且`jQueryInitialize(window);`必须在`svg:onload`事件中手动调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-04-03T15:51:07.460

这篇文章太老了，但我想也许人们会感兴趣，看看[`http://snapsvg.io/`](http://snapsvg.io/)哪个是由 Raphael 的同一个人构建的框架。但是对于现代浏览器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T14:05:27.737

您需要 SVG 还是只需要类似矢量的图形操作？John Resig 将“处理”可视化语言移植到 JavaScript。我从来没有使用过它，但是如果你实际上不需要 SVG，它可能会帮助你 jQuery 的创建者。

[http://ejohn.org/blog/processingjs/](http://ejohn.org/blog/processingjs/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T14:09:08.350

我还没有使用它，但我[前段时间为 PlotKit 添加](http://www.liquidx.net/plotkit/)了书签，因为它是一个生成 svg 的 javascript 框架

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-20T21:05:52.293

抱歉，垃圾邮件预防机制阻止我在一个答案中发布多个超链接。[这是在 SVG 下运行 jQuery 的概念证明](http://hgcoaxial.appspot.com/test)。

# python - 在没有制表符、缩进和空格标准的情况下，有没有办法在 Python 中编码？

> ID：63086
> 
> 赞同：9
> 
> 时间：2008-09-15T13:55:14.483
> 
> 标签：python

我想开始在小型项目中使用 Python，但是错位的制表符或缩进会引发编译错误这一事实确实让我很紧张。是否有某种类型的设置可以关闭它？

我目前正在使用 NotePad++。是否有一个 IDE 可以处理制表符和缩进？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-16T01:55:09.743

答案是不。

至少，直到实现以下类似的东西：

```
from __future__ import braces 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-09-15T13:56:47.927

不，缩进语法是 Python 语言不可或缺的一部分，无论好坏。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-15T23:56:17.487

埃马克！说真的，它对“tab is a *command* , not a *character* ”的使用，对于python开发来说绝对是完美的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-15T13:59:45.067

我在启动 Python 时遇到的所有空白问题都是制表符和空格混合的结果。一旦我将所有内容配置为只使用其中一个，我就不再遇到问题了。

就我而言，我将 UltraEdit 和 vim 配置为使用空格代替制表符。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-15T14:06:46.233

可以编写一个预处理器，它使用伪 Python 关键字（如“endif”和“endwhile”）随机缩进代码并正确缩进。在将 python 用作“类 ASP”语言时，我必须这样做，因为在这样的环境中，“缩进”的整个概念变得有点模糊。

当然，即使有这样的东西，你真的应该理智地缩进，这时转换就变得多余了。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-15T15:15:07.007

当人们将此标记为 Python 的问题时，我很难理解。我立即接受了它，实际上发现它是我最喜欢的语言“功能”之一 :)

在其他语言中，我有两个工作： 1\. 修复大括号，以便计算机可以解析我的代码 2\. 修复缩进，以便我可以解析我的代码。

所以在 Python 中，我有一半的事情要担心；-)

（注：我唯一一次遇到缩进问题是当 Python 代码在博客和论坛中时会混淆空白，但随着应用程序变得越来越智能，这种情况越来越少）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-15T14:22:30.457

> 我目前正在使用 NotePad++。是否有一个 IDE 可以处理制表符和缩进？

为此，我喜欢Eclipse 的[pydev](http://pydev.sourceforge.net/)扩展。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-15T13:56:55.477

我不这么认为，因为 Python 是一种以空格分隔的语言。也许带有自动缩进的文本编辑器或 IDE 会有所帮助。你目前在用什么？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-15T13:59:18.077

不，没有。缩进是 Python 的语法。你可以：

1.  使用 tabnanny.py 检查您的代码
2.  使用能够突出此类错误的语法感知编辑器（vi 会这样做，我打赌 emacs 会这样做，然后，大多数 IDE 也会这样做）
3.  （牵强）编写您自己的预处理器将大括号（或您喜欢的任何块分隔符）转换为缩进

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-15T14:00:05.720

当您使用 Python 时，您应该在编辑器中禁用制表符（实际上总是，恕我直言，但尤其是在您使用 Python 时）。寻找“使用空格作为制表符”之类的选项：任何体面的编辑器都应该有一个。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-15T14:00:23.083

并不真地。有几种方法可以修改给定代码行的空白规则，但您仍然需要缩进级别来确定范围。

您可以终止语句，`;`然后在同一行开始新的语句。（人们在[打高尔夫球时经常这样做。）](http://codegolf.com/)

如果你想将一行分成多行，你可以用`\`字符结束一行，这意味着当前行有效地从下一行的第一个非空白字符继续。这在视觉上*似乎*违反了通常的空格规则，但这是合法的。

我的建议：如果您有制表符/空格混淆，请不要使用制表符。使用空格，并选择 2 或 3 个空格作为缩进级别。

一个好的编辑器会做到这一点，所以你不必担心这个。[（例如， emacs](http://www.gnu.org/software/emacs/)的python 模式，你可以只使用 tab 键，它会让你诚实）。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-15T14:09:10.037

我同意贾斯汀和其他人的观点——选择一个好的编辑器并使用空格而不是制表符来进行缩进，空格的事情就不是问题了。我最近才开始使用 Python，虽然我认为空格问题会是一个真正的烦恼，但事实并非如此。作为记录，我使用的是 emacs，尽管我确信还有其他编辑器做得同样出色。

如果你真的死心塌地反对它，你总是可以通过预处理器传递你的脚本，但这在很多层面上都是一个坏主意。如果您要学习一门语言，请接受该语言的特性，而不是试图绕过它们。否则，学习一门新语言又有什么意义呢？

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-15T14:16:37.973

让你的缩进正常工作对于你使用的任何语言都很重要。

即使它不会影响程序在大多数其他语言中的执行，不正确的缩进对于任何试图阅读您的程序的人来说都是非常混乱的，因此您需要花时间弄清楚如何配置您的编辑器以正确对齐事物.

Python 在如何让你缩进方面非常自由。您可以在制表符和空格之间进行选择（但您确实应该使用空格）并且可以选择多少个空格。它唯一需要的是您始终如一，无论您使用哪种语言，这最终都很重要。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-15T14:28:27.523

可以通过将编辑器设置为使用空格而不是制表符来修复制表符和空格的混淆。

为了使空白完全直观，您可以使用更强大的代码编辑器或 IDE（如果您只需要适当的自动代码缩进，则不需要完整的 IDE）。

可以在 Python wiki 中找到编辑器列表，尽管这有点太累人了：- [http://wiki.python.org/moin/PythonEditors](http://wiki.python.org/moin/PythonEditors)

这里已经有一个问题试图将其缩小一点：

*   [https://stackoverflow.com/questions/60784/poll-which-python-ideeditor-is-the-best](https://stackoverflow.com/questions/60784/poll-which-python-ideeditor-is-the-best)

也许您应该添加一个更具体的问题：“您更喜欢在 Windows 上使用哪个 Python 编辑器或 IDE - 为什么？”

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-15T14:34:34.030

由于制表符，我有点不愿意学习 Python。但是，当我使用 Vim 时，我几乎没有注意到它。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-15T23:53:40.817

如果您不想使用带有自动缩进功能的 IDE/文本编辑器，可以使用 Tools\Scripts 目录中的 pindent.py 脚本。它是一个预处理器，可以转换如下代码：

```
def foobar(a, b):
if a == b:
a = a+1
elif a < b:
b = b-1
if b > a: a = a-1
end if
else:
print 'oops!'
end if
end def foobar 
```

进入：

```
def foobar(a, b):
   if a == b:
       a = a+1
   elif a < b:
       b = b-1
       if b > a: a = a-1
       # end if
   else:
       print 'oops!'
   # end if
# end def foobar 
```

这是有效的python。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-10-08T16:35:33.253

我很惊讶没有人提到 IDLE 作为一个很好的默认 python 编辑器。漂亮的语法颜色，处理缩进，具有智能感知，易于调整字体，并且它带有 python 的默认下载。哎呀，我主要编写 IronPython，但它非常好且易于在 IDLE 中编辑并从命令提示符运行 ipy。

哦，空白有什么大不了的？最容易阅读的 C 或 C# 也很好地缩进，python 只是强制执行一个非常简单的格式规则。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-15T15:57:56.200

许多 Python IDE 和通用的文本/源代码编辑器可以为您处理空白。

然而，最好只是“放手”，享受 Python 的空白规则。通过一些练习，它们根本不会影响你，你会发现它们有很多优点，其中最重要的是：

1.  由于强制空格，Python 代码更易于理解。您会发现，当您阅读其他人编写的代码时，它比 Perl 或 PHP 中的代码更容易理解。
2.  空格为您节省了很多控制字符（如 { 和 }）的击键，它们会乱扔用类 C 语言编写的代码。更少的 {s 和 }s 意味着更少的 RSI 和手腕疼痛。这不是一件可以掉以轻心的事情。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-15T17:25:34.493

在 Python 中，缩进是一种语义元素，并提供视觉分组以提高可读性。

空格和制表符都可以表示缩进。这是不幸的，因为：

*   选项卡的解释因编辑器和 IDE 而异，并且通常是可配置的（并且通常是配置的）。

*   OTOH，一些编辑器是不可配置的，但会应用他们自己的缩进规则。

*   不同的空格和制表符序列可能在视觉上无法区分。

*   剪切和粘贴可以改变空白。

因此，除非您知道给定的代码只能由您自己使用单个工具和不变的配置进行修改，否则您必须避免使用制表符进行缩进（配置您的 IDE），并确保在引入它们时会收到警告（搜索用于前导空格中的制表符）。

只要将任意语义应用于控制字符，您仍然可以不时地被咬。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-16T03:03:31.297

检查编辑器的选项或找到允许您将制表符转换为空格的编辑器/IDE。我通常将编辑器的选项设置为用 4 个空格替换 TAB 字符，我从来没有遇到任何问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-22T23:27:06.833

不，没有办法绕过它，这是设计使然：

```
>>> from __future__ import braces
  File "<stdin>", line 1
SyntaxError: not a chance 
```

大多数 Python 程序员根本不使用制表符，而是使用空格来缩进，这样就没有编辑器到编辑器的不一致。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-10-04T00:20:23.160

是的，有办法。我讨厌这些“没有办法”的答案，除非你发现一个，否则没有办法。

在那种情况下，无论它值多少钱，都有一个。

我曾经读到一个人设计了一种编码方式，以便一个简单的脚本可以正确地重新缩进代码。虽然我今天没有找到任何链接，但我发誓我读过它。

主要技巧是*始终*`return`在函数的末尾使用，始终*在*`pass`an`if`的末尾或类定义的末尾使用，并始终在`continue`a 的末尾使用`while`。当然，任何其他*无效*指令都符合目的。

然后，一个简单的*awk*脚本可以获取您的代码并通过读取 pass/continue/return 指令来检测块的结尾，并使用 if/def/while/... 指令来检测代码的开头。

当然，因为你将开发你的缩进脚本，你会发现你不必在 if 中的 return 之后使用 continue，因为 return 会触发缩进机制。这同样适用于其他情况。习惯就好。

如果您勤奋，您将能够自动剪切/粘贴和添加/删除`if`和更正缩进。顺便说一句，从 Web 粘贴代码需要您对它有一点了解，以便您可以将其调整为“非经典”设置。

# database - 代理与自然/业务键

> ID：63090
> 
> 赞同：189
> 
> 时间：2008-09-15T13:55:44.687
> 
> 标签：database, database-design, primary-key, key

我们又来了，旧的争论仍然存在......

我们最好有一个业务键作为主键，还是我们宁愿有一个代理 id（即 SQL Server 标识）对业务键字段具有唯一约束？

请提供例子或证据来支持你的理论。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-09-15T14:06:22.803

使用代理键的几个原因：

1.  **稳定性**：由于业务或自然需要而更改键将对相关表产生负面影响。代理键很少（如果有的话）需要更改，因为值没有任何意义。

2.  **约定**：允许您拥有标准化的主键列命名约定，而不必考虑如何为它们的 PK 连接具有不同名称的表。

3.  **速度**：根据 PK 值和类型，整数的代理键可能更小，索引和搜索速度更快。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2008-09-15T14:48:15.650

两个都。吃你的蛋糕。

请记住，主键没有什么特别之处，只是它被标记为这样。它只不过是一个 NOT NULL UNIQUE 约束，一个表可以有多个。

如果您使用代理键，您仍然需要一个业务键来确保根据业务规则的唯一性。

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2009-02-12T14:54:35.817

似乎没有人说任何支持非代理（我犹豫说“自然”）键的东西。所以这里...

代理键的一个**缺点**是它们**没有意义**（被某些人认为是一个优点，但是......）。这有时会迫使您在查询中加入比实际需要的更多的表。比较：

```
select sum(t.hours)
from timesheets t
where t.dept_code = 'HR'
and t.status = 'VALID'
and t.project_code = 'MYPROJECT'
and t.task = 'BUILD'; 
```

反对：

```
select sum(t.hours)
from timesheets t
     join departents d on d.dept_id = t.dept_id
     join timesheet_statuses s on s.status_id = t.status_id
     join projects p on p.project_id = t.project_id
     join tasks k on k.task_id = t.task_id
where d.dept_code = 'HR'
and s.status = 'VALID'
and p.project_code = 'MYPROJECT'
and k.task_code = 'BUILD'; 
```

除非有人认真认为以下是个好主意？：

```
select sum(t.hours)
from timesheets t
where t.dept_id = 34394
and t.status_id = 89    
and t.project_id = 1253
and t.task_id = 77; 
```

“但是”有人会说，“当 MYPROJECT 或 VALID 或 HR 的代码发生变化时会发生什么？” 我的回答是：“你为什么**需要**改变它？” 这些不是“自然”键，因为某些外部机构将立法规定今后“有效”应重新编码为“好”。只有一小部分“自然”密钥真正属于该类别 - SSN 和邮政编码是常见的例子。我肯定会为 Person、Address 之类的表使用无意义的数字键 - 但不是为**所有**表使用，出于某种原因，这里的大多数人似乎都提倡。

另见：[我对另一个问题的回答](https://stackoverflow.com/questions/337503/whats-the-best-practice-for-primary-keys-in-tables/337716#337716)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2008-09-15T13:59:41.993

代理键永远不会有改变的理由。我不能对自然键说同样的话。姓氏、电子邮件、ISBN 号码——它们都可以在一天内改变。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-09-15T14:04:04.493

代理键（通常是整数）具有使您的表关系更快的附加值，并且在存储和更新速度方面更经济（更好的是，与业务键字段相比，使用代理键时不需要更新外键，时不时会改变）。

表的主键应该用于唯一标识行，主要用于连接目的。想想 Persons 表：名称可以更改，并且不能保证它们是唯一的。

Think Companies：您是一家快乐的 Merkin 公司，与 Merkia 的其他公司开展业务。您很聪明，不会使用公司名称作为主键，因此您使用 Merkia 政府的唯一公司 ID，全部由 10 个字母数字字符组成。然后 Merkia 更改了公司 ID，因为他们认为这是个好主意。没关系，您可以使用数据库引擎的级联更新功能来进行最初不应该涉及您的更改。后来，您的业务扩大了，现在您在弗里多尼亚的一家公司工作。Freedonian 公司 ID 最多 16 个字符。您需要扩大公司 id 主键（也是 Orders、Issue、MoneyTransfers 等中的外键字段），在主键中添加 Country 字段（也在外键中）。哎哟! 弗里多尼亚的内战，它' s 分裂在三个国家。您的同事的国家名称应更改为新名称；级联更新救援。顺便说一句，你的主键是什么？（国家，CompanyID）还是（CompanyID，国家）？后者有助于加入，前者避免了另一个索引（或者可能很多，如果您希望您的订单也按国家/地区分组）。

所有这些都不是证据，而是表明为所有用途（包括连接操作）唯一标识行的代理键优于业务键。

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2009-09-28T18:11:01.973

我一般讨厌代理键。只有在没有可用的优质自然密钥时才应使用它们。当您考虑它时，认为向您的表中添加无意义的数据可以使事情变得更好是相当荒谬的。

以下是我的理由：

1.  使用自然键时，表以最常被搜索的方式聚集，从而使查询更快。

2.  使用代理键时，您必须在逻辑键列上添加唯一索引。您仍然需要防止逻辑重复数据。例如，即使 pk 是代理 id 列，您也不能在组织表中允许两个具有相同名称的组织。

3.  当代理键用作主键时，自然主键是什么就不太清楚了。在开发时，您想知道哪些列集使表独一无二。

4.  在一对多关系链中，逻辑键链。例如，组织有很多账户，账户有很多发票。所以Organization 的逻辑键是OrgName。Accounts 的逻辑键是 OrgName、AccountID。Invoice 的逻辑键是 OrgName、AccountID、InvoiceNumber。

    当使用代理键时，键链被截断，只有一个外键指向直接父级。例如，Invoice 表没有 OrgName 列。它只有一个 AccountID 列。如果要搜索给定组织的发票，则需要加入组织、帐户和发票表。如果您使用逻辑键，那么您可以直接查询组织表。

5.  存储查找表的代理键值会导致表被无意义的整数填充。要查看数据，必须创建连接到所有查找表的复杂视图。查找表旨在保存一组可接受的列值。它不应该通过存储一个整数代理键来编码。规范化规则中没有任何内容建议您应该存储代理整数而不是值本身。

6.  我有三本不同的数据库书籍。其中没有一个显示使用代理键。

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2013-12-27T16:14:31.713

我想与您分享我在这场无休止的战争中的经验：D 关于自然键与替代键的困境。我认为代理键（人工自动生成**的**）和自然键（由具有域含义的列组成）都有**优点**和**缺点**。因此，根据您的情况，选择一种方法或另一种方法可能更相关。

由于似乎很多人将代理键视为近乎完美的解决方案，而将自然键视为瘟疫，我将重点介绍另一种观点的论点：

# 代理键的缺点

代理键是：

1.  性能问题的来源：
    *   它们通常使用自动递增的列来实现，这意味着：
        *   每次您想获得一个新的 Id 时都要往返于数据库（我知道这可以使用缓存或 [seq]hilo 类似的算法来改进，但这些方法仍然有其自身的缺点）。
        *   如果有一天您需要将数据从一个模式移动到另一个模式（至少在我的公司经常发生这种情况），那么您可能会遇到 Id 冲突问题。是的，我知道你可以使用 UUID，但最后一个需要 32 个十六进制数字！（如果您关心数据库大小，那么这可能是一个问题）。
        *   如果您对所有代理键使用一个序列，那么 - 可以肯定的是 - 您最终会在数据库上发生争用。
2.  容易出错。序列具有最大值限制，因此 - 作为开发人员 - 您必须注意以下几点：
    *   您必须循环您的序列（当达到最大值时，它会返回到 1,2，...）。
    *   如果您将序列用作数据的排序（随着时间的推移），那么您必须处理循环的情况（ID 为 1 的列可能比 ID 最大值 - 1 的行更新）。
    *   确保您的代码（甚至是不应发生的客户端接口，因为它应该是内部 Id）支持用于存储序列值的 32b/64b 整数。
3.  他们不保证非重复数据。您始终可以有 2 行具有所有相同的列值但具有不同的生成值。对我来说，从数据库设计的角度来看，这是代理键的问题**。**
4.  [更多在维基百科...](http://en.wikipedia.org/wiki/Surrogate_key "缺点部分")

# 自然键的神话

1.  复合键的效率低于代理键。不！这取决于使用的数据库引擎：
    *   [甲骨文](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:6070436300346195032 "askTom：自然键作为主键与代理键")
    *   [MySQL](https://stackoverflow.com/questions/1460465/composite-primary-key-performance-drawback-in-mysql)
2.  自然键在现实生活中不存在。抱歉，它们确实存在！**例如，在航空业中，以下元组对于给定的预定**航班（航空公司、出发日期、航班号、操作后缀）将始终是唯一的。**更一般地，当一组业务数据通过给定标准**保证是唯一的时，那么这组数据就是一个[好的]自然关键候选者。
3.  自然键“污染”子表的架构。对我来说，这更像是一种感觉，而不是一个真正的问题。拥有 4 列 2 字节的主键可能比 11 字节的单列更有效。此外，这 4 列可用于直接查询子表（通过使用 where 子句中的 4 列）而不连接父表。

# 结论

在相关时使用自然键，并在最好使用代理键时使用它们。

希望这对某人有所帮助！

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2008-09-15T13:58:16.690

始终使用没有商业意义的密钥。这只是一个好习惯。

编辑：我试图在网上找到它的链接，但我做不到。但是，在[“企业架构模式”](http://martinfowler.com/books.html) [Fowler] 中，它很好地解释了为什么您不应该使用除了作为键之外没有任何意义的键以外的任何东西。它归结为一个事实，它应该只有一份工作和一份工作。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-09-15T14:19:10.947

如果您打算使用 ORM 工具来处理/生成数据类，则代理键非常方便。虽然您可以将复合键与一些更高级的映射器（阅读：hibernate）一起使用，但它会给您的代码增加一些复杂性。

（当然，数据库纯粹主义者会争辩说，即使是代理键的概念也是可憎的。）

我喜欢在合适的时候使用 uids 作为代理键。他们的主要胜利是您提前知道密钥，例如，您可以创建一个已设置 ID 并保证唯一的类的实例，而使用整数密钥，您需要默认为 0 或 - 1 并在保存/更新时更新为适当的值。

不过，UID 在查找和连接速度方面会受到惩罚，因此取决于相关应用程序是否需要它们。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-09-15T14:02:09.070

在我看来，使用代理键更好，因为它改变的可能性为零。几乎我能想到的任何你可以用作自然键的东西都可能改变（免责声明：并不总是正确的，但通常是这样）。

一个例子可能是汽车数据库 - 乍一看，您可能认为车牌可以用作钥匙。但是这些可以改变，所以这是一个坏主意。你不会真的想在发布应用程序*后*发现这一点，当有人来找你想知道为什么他们不能将他们的车牌更改为他们闪亮的新个性化车牌时。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2008-09-15T14:35:53.607

如果可能，请始终使用单列代理键。这使得连接以及插入/更新/删除更加清晰，因为您只负责跟踪一条信息以维护记录。

然后，根据需要，将您的业务密钥堆叠为唯一的约束或索引。这将使您保持数据完整性。

业务逻辑/自然键可以更改，但表的物理键不应该更改。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-15T14:01:59.693

在数据仓库场景中，我认为最好遵循代理键路径。两个原因：

*   您独立于源系统，并且那里的更改（例如数据类型更改）不会影响您。
*   您的 DW 将需要更少的物理空间，因为您将只使用整数数据类型作为代理键。您的索引也会更好地工作。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-10-24T12:48:20.307

***案例1：***您的表是一个少于50条记录（50种）**的查找表**

在这种情况下，**根据每条记录的含义使用手动命名的键**。

例如：

```
Table: JOB with 50 records
CODE (primary key)       NAME               DESCRIPTION
PRG                      PROGRAMMER         A programmer is writing code
MNG                      MANAGER            A manager is doing whatever
CLN                      CLEANER            A cleaner cleans
...............
joined with
Table: PEOPLE with 100000 inserts

foreign key JOBCODE in table PEOPLE
looks at
primary key CODE in table JOB 
```

* * *

***案例2：***你的表是一张**有数千条记录的表**

使用**代理/自动增量键**。

例如：

```
Table: ASSIGNMENT with 1000000 records
joined with
Table: PEOPLE with 100000 records

foreign key PEOPLEID in table ASSIGNMENT
looks at
primary key ID in table PEOPLE (autoincrement) 
```

* * *

**在第一种情况下：**

*   您可以选择 table 中的所有程序员，`PEOPLE`而无需使用 join with table `JOB`，但只需：`SELECT * FROM PEOPLE WHERE JOBCODE = 'PRG'`

**在第二种情况下：**

*   您的数据库查询速度更快，因为您的主键是整数
*   您无需费心寻找下一个唯一键，因为数据库本身会为您提供下一个自动增量。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-02-12T15:52:34.413

当业务信息可以更改或相同时，代理键可能很有用。毕竟，企业名称在全国范围内不必是唯一的。假设您与两家名为 Smith Electronics 的企业打交道，一家在堪萨斯州，一家在密歇根州。您可以通过地址区分它们，但这会改变。甚至状态也可以改变；如果堪萨斯州堪萨斯城的史密斯电子公司渡河到密苏里州堪萨斯城会怎样？没有明显的方法可以使这些业务与自然密钥信息区分开来，因此代理密钥非常有用。

将代理键想象成 ISBN 号。通常，您通过书名和作者来识别一本书。但是，我有两本书，HP Willmott 的《珍珠港》，它们绝对是不同的书，而不仅仅是不同的版本。在这种情况下，我可以参考书籍的外观，或者早期与后期，但我也可以使用 ISBN。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-15T14:16:31.703

这是代理键几乎*总是*有意义的情况之一。在某些情况下，您要么选择最适合数据库的方式，要么选择最适合您的对象模型的方式，但在这两种情况下，使用无意义的键或 GUID 是一个更好的主意。它使索引更容易和更快，并且它是您的对象的标识，不会改变。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-06-27T14:44:11.123

提醒一下，将聚集索引放置在随机代理键（即读取 XY8D7-DFD8S 的 GUID）上并不是一个好习惯，因为它们 SQL Server 无法对这些数据进行物理排序。相反，您应该在这些数据上放置唯一索引，尽管简单地为主表操作运行 SQL 分析器，然后将这些数据放入数据库引擎优化顾问中也可能是有益的。

见线程@http [://social.msdn.microsoft.com/Forums/en-us/sqlgetstarted/thread/27bd9c77-ec31-44f1-ab7f-bd2cb13129be](http://social.msdn.microsoft.com/Forums/en-us/sqlgetstarted/thread/27bd9c77-ec31-44f1-ab7f-bd2cb13129be)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-07T12:11:48.970

在时间点数据库的情况下，最好将代理键和自然键结合起来。例如，您需要跟踪俱乐部的会员信息。成员的某些属性永远不会改变。例如出生日期，但姓名可以更改。因此，使用 member_id 代理键创建一个 Member 表，并有一个 DOB 列。创建另一个名为 person name 的表，并包含 member_id、member_fname、member_lname、date_updated 列。在这个表中，自然键是 member_id + date_updated。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-02-09T22:53:15.847

课程用马。陈述我的偏见；我首先是一名开发人员，所以我主要关心为用户提供一个工作应用程序。

我曾在具有自然键的系统上工作过，并且不得不花费大量时间来确保值的变化会波及。

我曾在只有代理键的系统上工作过，唯一的缺点是缺乏用于分区的非规范化数据。

与我合作过的大多数传统 PL/SQL 开发人员都不喜欢代理键，因为每次连接的表数量众多，但我们的测试和生产数据库从未出过汗。额外的连接不会影响应用程序的性能。对于不支持“X 内连接 Y on Xa = Yb”等子句的数据库方言，或者不使用该语法的开发人员，代理键的额外连接确实使查询更难阅读，并且更长的输入和检查：见@Tony Andrews 帖子。但是，如果您使用 ORM 或任何其他 SQL 生成框架，您将不会注意到它。触摸打字也减轻了。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-04-24T15:02:51.850

也许与这个主题不完全相关，但我在处理代理键时很头疼。Oracle 预交付分析在其仓库中的所有维度表上创建自动生成的 SK，并将这些数据存储在事实中。因此，只要在添加新列或需要为维度中的所有项目填充新列时需要重新加载它们（维度）时，更新期间分配的 SK 会使 SK 与存储到事实的原始值不同步，从而强制完全重新加载加入它的所有事实表。我希望即使 SK 是一个毫无意义的数字，也有某种方式无法改变原始/旧记录。众所周知，开箱即用很少能满足组织的需求，我们必须不断地进行定制。现在我们的仓库中有 3 年的数据，Oracle 财务系统的完全重新加载非常大。因此，就我而言，它们不是从数据输入中生成的，而是添加到仓库中以帮助报告性能。我明白了，但我们的确实发生了变化，这是一场噩梦。

# vim - 更智能的 Vim 恢复？

> ID：63104
> 
> 赞同：51
> 
> 时间：2008-09-15T13:57:47.113
> 
> 标签：vim, recovery

当先前的 Vim 会话崩溃时，您会看到“交换文件...已经存在！” 对于上一个会话中打开的每个文件。

你能让这个 Vim 恢复提示更智能吗？（不关闭恢复！）具体来说，我在考虑：

*   如果交换的版本不包含未保存的更改并且编辑过程不再运行，你可以让 Vim 自动删除交换文件吗？
*   您是否可以自动执行建议的过程，即以新名称保存恢复的文件，将其与磁盘上的文件合并，然后删除旧的交换文件，从而需要最少的交互？特别是当swap版本和磁盘版本相同时，一切都应该是自动的。

我发现了`SwapExists`自动命令，但我不知道它是否可以帮助完成这些任务。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-09-15T14:20:29.417

我有 vim 将我的交换文件存储在一个本地目录中，通过在我的 .vimrc 中有这个：

```
set directory=~/.vim/swap,. 
```

除了其他好处之外，这使得交换文件很容易一次找到。现在，当我的笔记本电脑断电或其他什么情况下，我开始备份一堆交换文件时，我只需运行我的`cleanswap`脚本：

```
TMPDIR=$(mktemp -d) || exit 1
RECTXT="$TMPDIR/vim.recovery.$USER.txt"
RECFN="$TMPDIR/vim.recovery.$USER.fn"
trap 'rm -f "$RECTXT" "$RECFN"; rmdir "$TMPDIR"' 0 1 2 3 15
for q in ~/.vim/swap/.*sw? ~/.vim/swap/*; do
  [[ -f $q ]] || continue
  rm -f "$RECTXT" "$RECFN"
  vim -X -r "$q" \
      -c "w! $RECTXT" \
      -c "let fn=expand('%')" \
      -c "new $RECFN" \
      -c "exec setline( 1, fn )" \
      -c w\! \
      -c "qa"
  if [[ ! -f $RECFN ]]; then
    echo "nothing to recover from $q"
    rm -f "$q"
    continue
  fi
  CRNT="$(cat $RECFN)"
  if diff --strip-trailing-cr --brief "$CRNT" "$RECTXT"; then
      echo "removing redundant $q"
      echo "  for $CRNT"
      rm -f "$q"
  else
      echo $q contains changes
      vim -n -d "$CRNT" "$RECTXT"
      rm -i "$q" || exit
  fi
done 
```

这将删除所有与真实文件保持同步的交换文件。任何不匹配的内容都会在 vimdiff 窗口中显示，以便我可以合并未保存的更改。

——乔瑟

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-21T02:10:53.033

我刚刚发现了这个：

[http://vimdoc.sourceforge.net/htmldoc/diff.html#:DiffOrig](http://vimdoc.sourceforge.net/htmldoc/diff.html#:DiffOrig)

我将 DiffOrig 命令复制并粘贴到我的 .vimrc 文件中，它就像一个魅力。这极大地简化了交换文件的恢复。我不知道为什么它默认不包含在 VIM 中。

这是给那些赶时间的人的命令：

```
 command DiffOrig vert new | set bt=nofile | r # | 0d_ | diffthis
    \ | wincmd p | diffthis 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-04-29T01:05:06.963

接受的答案因一个非常重要的用例而被破坏。假设您创建了一个新缓冲区并输入了 2 个小时而没有保存，然后您的笔记本电脑崩溃了。如果您运行建议的脚本**，它将删除您的唯一记录，即 .swp 交换文件**。我不确定正确的修复方法是什么，但在这种情况下，看起来 diff 命令最终会将同一个文件与其自身进行比较。下面的编辑版本会检查这种情况，并让用户有机会将文件保存在某处。

```
#!/bin/bash

SWAP_FILE_DIR=~/temp/vim_swp
IFS=$'\n'

TMPDIR=$(mktemp -d) || exit 1
RECTXT="$TMPDIR/vim.recovery.$USER.txt"
RECFN="$TMPDIR/vim.recovery.$USER.fn"
trap 'rm -f "$RECTXT" "$RECFN"; rmdir "$TMPDIR"' 0 1 2 3 15
for q in $SWAP_FILE_DIR/.*sw? $SWAP_FILE_DIR/*; do
  echo $q
  [[ -f $q ]] || continue
  rm -f "$RECTXT" "$RECFN"
  vim -X -r "$q" \
      -c "w! $RECTXT" \
      -c "let fn=expand('%')" \
      -c "new $RECFN" \
      -c "exec setline( 1, fn )" \
      -c w\! \
      -c "qa"
  if [[ ! -f $RECFN ]]; then
    echo "nothing to recover from $q"
    rm -f "$q"
    continue
  fi
  CRNT="$(cat $RECFN)"
  if [ "$CRNT" = "$RECTXT" ]; then
      echo "Can't find original file. Press enter to open vim so you can save the file. The swap file will be deleted afterward!"
      read
      vim "$CRNT"
      rm -f "$q"
  else if diff --strip-trailing-cr --brief "$CRNT" "$RECTXT"; then
      echo "Removing redundant $q"
      echo "  for $CRNT"
      rm -f "$q"
  else
      echo $q contains changes, or there may be no original saved file
      vim -n -d "$CRNT" "$RECTXT"
      rm -i "$q" || exit
  fi
  fi
done 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-24T03:03:14.973

很棒的提示 DiffOrig 是完美的。这是我用来在当前目录下的每个交换文件上运行它的 bash 脚本：

```
#!/bin/bash

swap_files=`find . -name "*.swp"`

for s in $swap_files ; do
        orig_file=`echo $s | perl -pe 's!/\.([^/]*).swp$!/$1!' `
        echo "Editing $orig_file"
        sleep 1
        vim -r $orig_file -c "DiffOrig"
        echo -n "  Ok to delete swap file? [y/n] "
        read resp
        if [ "$resp" == "y" ] ; then
                echo "  Deleting $s"
                rm $s
        fi
done 
```

可能可以使用更多的错误检查和引用，但到目前为止已经奏效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-24T20:16:50.920

我不想在 .vimrc 中设置我的 VIM 工作目录。这是对 chouser 脚本的修改，它根据需要将交换文件复制到交换路径，检查重复项，然后对它们进行协调。写的很仓促，在实际使用之前一定要评估一下。

```
#!/bin/bash

if [[ "$1" == "-h" ]] || [[ "$1" == "--help" ]]; then
   echo "Moves VIM swap files under <base-path> to ~/.vim/swap and reconciles differences"
   echo "usage: $0 <base-path>"
   exit 0
fi

if [ -z "$1" ] || [ ! -d "$1" ]; then
   echo "directory path not provided or invalid, see $0 -h"
   exit 1
fi

echo looking for duplicate file names in hierarchy
swaps="$(find $1 -name '.*.swp' | while read file; do echo $(basename $file); done | sort | uniq -c | egrep -v "^[[:space:]]*1")"
if [ -z "$swaps" ]; then
   echo no duplicates found
   files=$(find $1 -name '.*.swp')
   if [ ! -d ~/.vim/swap ]; then mkdir ~/.vim/swap; fi
   echo "moving files to swap space ~./vim/swap"
   mv $files ~/.vim/swap
   echo "executing reconciliation"
   TMPDIR=$(mktemp -d) || exit 1
   RECTXT="$TMPDIR/vim.recovery.$USER.txt"
   RECFN="$TMPDIR/vim.recovery.$USER.fn"
   trap 'rm -f "$RECTXT" "$RECFN"; rmdir "$TMPDIR"' 0 1 2 3 15
   for q in ~/.vim/swap/.*sw? ~/.vim/swap/*; do
     [[ -f $q ]] || continue
     rm -f "$RECTXT" "$RECFN"
     vim -X -r "$q" \
         -c "w! $RECTXT" \
         -c "let fn=expand('%')" \
         -c "new $RECFN" \
         -c "exec setline( 1, fn )" \
         -c w\! \
         -c "qa"
     if [[ ! -f $RECFN ]]; then
       echo "nothing to recover from $q"
       rm -f "$q"
       continue
     fi
     CRNT="$(cat $RECFN)"
     if diff --strip-trailing-cr --brief "$CRNT" "$RECTXT"; then
         echo "removing redundant $q"
         echo "  for $CRNT"
         rm -f "$q"
     else
         echo $q contains changes
         vim -n -d "$CRNT" "$RECTXT"
         rm -i "$q" || exit
     fi
   done
else
   echo duplicates found, please address their swap reconciliation manually:
   find $1 -name '.*.swp' | while read file; do echo $(basename $file); done | sort | uniq -c | egrep '^[[:space:]]*[2-9][0-9]*.*'
fi 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-11T15:08:13.287

我的 .bashrc 文件中有这个。我想对这段代码的一部分给予适当的赞扬，但我忘记了我是从哪里得到它的。

```
mswpclean(){

for i in `find -L -name '*swp'`
do
    swpf=$i
    aux=${swpf//"/."/"/"}
    orif=${aux//.swp/}
    bakf=${aux//.swp/.sbak}

    vim -r $swpf -c ":wq! $bakf" && rm $swpf
    if cmp "$bakf" "$orif" -s
    then rm $bakf && echo "Swap file was not different: Deleted" $swpf
    else vimdiff $bakf $orif
    fi
done

for i in `find -L -name '*sbak'`
do
    bakf=$i
    orif=${bakf//.sbak/}
    if test $orif -nt $bakf
    then rm $bakf && echo "Backup file deleted:" $bakf
    else echo "Backup file kept as:" $bakf
    fi
done } 
```

我只是在我的项目的根目录上运行它，如果文件不同，它会打开 vim diff。然后，将保留最后一个要保存的文件。为了使它完美，我只需要替换最后一个：

```
else echo "Backup file kept as:" $bakf 
```

通过类似的东西

```
else vim $bakf -c ":wq! $orif" && echo "Backup file kept and saved as:" $orif 
```

但我没有时间正确测试它。

希望能帮助到你。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-10-06T11:10:55.503

查找 ./ -type f -name ".*sw[klmnop]" -delete

信用：@Shwaydogg [https://superuser.com/questions/480367/whats-the-easiest-way-to-delete-vim-swapfiles-ive-already-recovered-from](https://superuser.com/questions/480367/whats-the-easiest-way-to-delete-vim-swapfiles-ive-already-recovered-from)

首先导航到目录

# winforms - 对足够好的 Winforms GUI 设计有什么建议吗？

> ID：63123
> 
> 赞同：3
> 
> 时间：2008-09-15T14:00:15.157
> 
> 标签：winforms, user-interface, design-patterns

我正在使用 VB2008 开发一个中型应用程序。为了更好地测试我的应用程序，我遵循 MVP/Supervising Controller 方法。

我的问题是：您对职责分离的建议是什么？到目前为止，我已经提出了一个带有控制器实例和我的类实例的 winform。控件通过 DataBinding 更新

问题是我只是不确定在我的班级中在哪里编写职责（比如说验证、报告创建、查询等）？在一个单独的班级？

您可以指出我的任何干净的 Winform 类设计的小例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T02:29:28.813

我建议您花时间阅读 Jeremy Millers 的“[构建您自己的 CAB](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx) ”系列文章，以了解随着您的应用程序变得越来越复杂，您可能喜欢/需要实现什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T14:15:49.363

Martin Fowler 是有关包括 MVC 在内的所有设计模式的良好信息来源。Fowler 讨论了被动视图并且还展示了职责分离

[http://martinfowler.com/eaaDev/ModelViewPresenter.html](http://martinfowler.com/eaaDev/ModelViewPresenter.html)

# inheritance - 如何删除此并行层次结构

> ID：63125
> 
> 赞同：0
> 
> 时间：2008-09-15T14:00:23.193
> 
> 标签：inheritance, oop

我正在尝试为以下场景找到最佳设计 - 一个存储舞蹈比赛结果的应用程序。

一个事件包含多轮，每轮包含许多表演（每支舞一个）。每场表演都由许多评委进行评判，评委会返回一张计分表。

有两种类型的轮次，最后一轮（包含 6 对或更少的舞蹈对）或正常轮（包含超过 6 个舞蹈对）。每个都需要稍微不同的行为和数据。

在最后一轮的情况下，每张计分表都包含决赛中 6 对夫妇的有序列表，显示法官将哪对夫妇排在第 1 名、第 2 名等。我称这些排名为“计分表包含 6 个排名”。一个位置包含一对夫妇的号码，这对夫妇是什么地方

在正常轮次的情况下，每个计分表包含一组无序的 M 对（M < 进入轮次的对数 - 由比赛组织者确定的确切值）。我将这些回忆称为：“M 回忆的记分表”。召回不包含分数或排名

例如在决赛中

*   第一名：56对
*   第二名：情侣234
*   第三名：情侣198
*   第四名：情侣98
*   第五名：情侣3
*   第六名：情侣125

为正常一轮以下夫妇被召回54,67,201,104,187,209,8,56,79,35,167,98

我的天真版本实现为

事件 - has_one final_round, has_many rounds

final_round - has_many final_performances final_performance - has_many final_scoresheets final_scoresheet - has_many 排名

回合 - has_many 表现 表现 has_many scoresheets scoresheet has_many 回忆

但是我不喜欢这需要的重复，而且我有几个并行的层次结构（用于回合、性能和计分表），这将是一个痛苦的维护。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T14:05:39.793

这需要一点我没有的领域知识，但在我看来，有序与无序的情况有点无关紧要。如果每对情侣都有一个分数，那么最后一轮的排序可以从每对情侣的分数中推断出来，对吧？这意味着最后一轮的数据结构将与其他轮次的数据结构一样，由多个（对，分数）集组成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-26T15:50:06.843

如果不详细了解发生了什么，就很难给出明确的建议。但是，根据我阅读的内容，您的并行层次结构似乎没有必要。

尚不清楚 final_performance 是否真的与 performance 不同。我猜他们的得分不同；这应该反映在 final_scoresheet 的差异中，并且您可能认为您需要使 final_performance 不同，因为它必须包含 final_scoresheets。也许您可以只有一个表现对象，而不是让成绩表包含在表现中，而是让圆形对象将成绩表与表现相关联：

```
round.getScoresheet(couple,dance) 
```

而不是

```
round.getPerformance(couple,dance).getScoresheet() 
```

我还想知道您是否需要用于放置和召回的对象：它们可以只是从记分表中检索到的（有序的）夫妻列表吗？如果是这样，那么您已经消除了三个类。

包容优于继承。

# dns - 阻止网站的一部分

> ID：63126
> 
> 赞同：0
> 
> 时间：2008-09-15T14:00:25.627
> 
> 标签：dns, osx-leopard, google-reader

我试图阻止谷歌阅读器：

阅读器.google.com

**www.google.com/reader**

**困难的部分是阻止阅读器目录**

我通过更改我的 /etc/hosts 文件阻止了 reader.google.com（这是针对 Mac 的）

有什么方法可以在不购买软件的情况下阻止 www.google.com/reader？请注意，这是针对 Safari 的，因此 Greasemonkey 将无法工作，并且 Leopard 的家长控制在打开时会限制 CPU。

我也尝试过 OpenDNS，这很棒，但不适用于这个......

有什么想法吗？

**更新：**这适用于经常出差的笔记本电脑。所以路由器或家庭代理服务器将无法工作。Firefox 可以，但我不认为我可以从 Mac 上卸载 Safari。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T14:05:43.927

设置代理服务器并通过它阻止它。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T14:06:23.427

您可以使用代理（例如[Proxomitron](http://proxomitron.info/index.html)）来执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T14:08:05.153

您可以使用[Privoxy](http://www.privoxy.org/)过滤任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T14:11:40.387

另一种选择是使用像 www.opendns.com 这样的免费服务作为您的 dns 服务器，它们允许您阻止特定域或打开过滤等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T14:02:53.280

在路由器级别呢？我的路由器作为内置的 URL 拦截器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T14:05:40.900

也许您可以找到某种可以安装的 http 代理来过滤此内容并在浏览时使用它。在 Firefox 上，您可以轻松地为 Adblock Plus 定义规则。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T14:51:07.830

[我使用Safari AdBlock](http://safariadblock.sourceforge.net/)完全符合您的要求。只需在 Safari->Preferences->AdBlock 中定义一些规则，您就可以开始使用了！

# .net - 将自定义 TextboxCell 添加到包含打开 FileDialog 的按钮的 DataGridView 控件

> ID：63130
> 
> 赞同：1
> 
> 时间：2008-09-15T14:00:49.960
> 
> 标签：.net, .net-2.0

我想将 DataGridViewTextBoxCell 单元格添加到 DataGridViewCell 控件，但除了能够正常输入文本单元格外，它还必须包含一个“...”按钮，一旦单击该按钮就会打开 OpenFileDialog 窗口以允许用户选择一个文件。选择后，文本单元格将填充完整的文件路径。

解决此问题的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T14:10:27.333

[这篇](http://msdn.microsoft.com/en-au/library/7tas5c80.aspx)MSDN 文章解释了如何将自定义控件添加到`DataGridView`.

您应该能够制作一个`UserControl`有文本框和按钮的，并将其嵌入到`DataGridView`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T14:11:51.887

为此，您需要创建自己的列和单元格类。我建议使用**.NET** Reflector 以查看 DataGridViewTextBox 的实现细节作为起点，然后自定义以在其末尾添加按钮的显示。查看这些教程以开始...

[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa730882(VS.80).aspx)

[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms180996.aspx)

# oop - 重用/发布等效原则 (REP)

> ID：63142
> 
> 赞同：24
> 
> 时间：2008-09-15T14:02:00.397
> 
> 标签：oop, language-agnostic

什么是重用/发布等效原则，为什么它很重要？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-15T14:02:11.783

重用/发布等效原则 (REP) 说：

> 重用单元是释放单元。有效的重用需要跟踪来自变更控制系统的发布。包是重用和发布的有效单元。

**重用单位就是释放单位**

不应通过从一个类复制代码并将其粘贴到另一个类来重用代码。如果原作者修复了代码中的任何错误，或添加了任何功能，您将不会自动获得收益。您必须找出更改的内容，然后更改您的副本。你的代码和原来的代码会逐渐发散。

相反，应该通过在代码中包含已发布的库来重用代码。原作者保留对其进行维护的责任；您甚至不需要查看源代码。

**有效的重用需要跟踪变更控制系统的发布**

库的作者需要用某种编号或名称来标识版本。这允许库的用户识别不同的版本。这需要使用某种发布跟踪系统。

**包是重用和发布的有效单元**

可以使用一个类作为重用和发布的单元，但是在一个典型的应用程序中有这么多的类，发布跟踪系统跟踪它们会很麻烦。需要一个更大规模的实体，而该软件包很好地满足了这一需求。

另请参见 Robert Martin 关于[粒度](http://www.objectmentor.com/resources/articles/granularity.pdf)的文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-18T14:22:40.253

来自罗伯特马丁的清洁建筑。

> 重用/发布等效原则 (REP) 是一个看似显而易见的原则，至少事后看来是这样。想要重用软件组件的人不能也不会这样做，除非这些组件通过发布过程进行跟踪并获得发布号。
> 
> 这不仅仅是因为没有版本号，就无法确保所有重用的组件相互兼容。相反，它也反映了这样一个事实，即软件开发人员需要知道新版本何时到来，以及这些新版本将带来哪些变化。
> 
> 开发人员收到有关新版本的警报并根据该版本中所做的更改决定继续使用旧版本的情况并不少见。因此，发布过程必须生成适当的通知和发布文档，以便用户可以就何时以及是否集成新版本做出明智的决定。

# webserver - 如何处理文件上传到专用图像服务器？

> ID：63146
> 
> 赞同：2
> 
> 时间：2008-09-15T14:02:18.243
> 
> 标签：webserver, file-upload

我有一个正在运行的应用程序的网络服务器。有一个带有表单的网页：一些文本数据和一个文件上传字段。现在，我想要的是它像这样工作：
文件被发送到专用服务器，然后运行一个应用程序。服务器应返回某种路径（或任何标识上传和保存的文件并允许创建 URL 的内容）。然后，这个路径和用户填充的数据都应该提交给带有应用程序的网络服务器，用于任何类型的数据库存储。

问题是，有 2 个不同的服务器，所以我不能用 javascript 上传文件，可以吗？另一种方法是使用`iframe`上传表单并将其放入其中 - 但我认为我无法使用 javascript 访问上传结果（仍在 iframe 中）以将文件路径传递给我的主服务器。

我也可以将文件上传到我的应用程序正在运行的同一台服务器上，然后将`rsync`其上传到另一台服务器上 - 但如果可以的话，我想避免它，实际上尽量减少流量:)

你如何在你的应用程序中处理这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T14:08:15.887

如果您使用 iframe，您可以将上传表单提交到专用图像服务器，如果结果成功，则让它从原始服务器加载一个页面，其中包含“传递的信息（例如图像路径）” " 作为 GET 参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T14:05:59.030

POST 到专用服务器，服务器存储图像并通过网络服务或其他方式回调网络服务器，以提供所需的任何信息。

# c++ - Win32 的用户界面控件

> ID：63147
> 
> 赞同：8
> 
> 时间：2008-09-15T14:02:20.940
> 
> 标签：c++, winapi, user-interface

我看到很多 .NET 的用户界面控件库，但是我在哪里可以使用简单的 C/C++ 获得类似的东西？

诸如更漂亮的按钮、刻度盘、列表视图、图表等。

似乎每个 Win32 程序员的通行权都是最终编写自己的集合。：/

* * *

请不要使用 MFC 控件。我只做纯C/C++。话虽如此，我也不想为我的应用程序添加一个数兆字节的框架，以便我可以拥有一个更漂亮的按钮。

* * *

我很抱歉遗漏了一个小细节，那就是我的开发是针对 Windows Mobile 的。

所以清单文件已经出来了。

我只是注意到有多少开发公司已经为制作漂亮的 .NET 组件而疯狂，并且想知道等效的 C/C++ Win32 组件去了哪里？

我读到有多少人最终编写了自己的渐变按钮类等。所以你会认为这些东西会有一些商业类。这很奇怪。

我将仔细研究 QT 并研究它对此类事物的 GUI 支持。当您是自己的 uISV 中的一个人时，这就是挑战。没有其他开发人员可以帮助您“完成工作”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T14:38:38.343

我过去使用过[奇趣科技的 Qt 框架](http://trolltech.com/products/qt/)并取得了巨大的成功：此外，它也是跨平台的，所以理论上你可以针对 Win、Mac 和 Linux（前提是你不做任何特定于平台的操作）当然，您的其余代码；））

编辑：我注意到您的目标是 Windows Mobile；这无疑增加了 Qt 的实力，因为它的跨平台支持也扩展到了[WinCE 和嵌入式 Linux](http://trolltech.com/products/qt/features/platforms/index)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T14:06:42.710

如果您不介意使用 MFC 库，您应该尝试[Visual C++ 2008 Feature Pack](http://www.microsoft.com/downloads/details.aspx?FamilyId=D466226B-8DAB-445F-A7B4-448B326C48E7&displaylang=en)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T14:06:53.207

[黄貂鱼](http://www.roguewave.com/products/stingray.php)

[CodeJock](http://www.codejock.com/products/toolkitpro/?2yn6s14z=zsp) - 用于 MFC/C++ 的工具包专业版

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T14:09:00.613

[Code Project](http://www.codeproject.com/)有很多用于 C/C++ 的 UI 控件

它们中的大多数都专注于 MFC 或 WTL，但也有一些是纯[Win32](http://www.codeproject.com/KB/winsdk/)的。

顺便说一句，如果你不使用框架，你真的应该考虑 WTL 而不是纯 Win32。它的开销很低，而且生产力提高了大约一百万倍。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T18:07:27.263

对于更漂亮的按钮等，如果您还没有这样做，请[嵌入应用程序清单](http://msdn.microsoft.com/en-us/library/bb773175(VS.85).aspx)，以便您的程序链接到通用控件库的版本 6。这样做将使您获得标准 Windows 控件的 Windows XP 或 Vista 风格的版本。

如果您想要 Windows 本身提供的控件类型之外的控件类型，您可能必须自己编写或更具体地说明您要查找的控件类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T14:13:38.277

MFC 功能包源自[BCGSoft 组件](http://www.bcgsoft.com/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T14:18:01.963

使用 winAPI，您几乎可以做任何您想做的事情，而且速度也非常快。这需要一些时间才能弄清楚，但它确实有效。转到 MSDN，查找 MessageBox()，查看 DialogBox() 并从那里开始。

顺便说一句，我个人并不关心 MFC。如果你想使用类似 MFC 的方法，我推荐 Borland 的 C++ Builder。很旧，但我认为仍然非常有用。

# java - 在 Java 中构建一串分隔项的最佳方法是什么？

> ID：63150
> 
> 赞同：350
> 
> 时间：2008-09-15T14:02:43.687
> 
> 标签：java, string, algorithm

在 Java 应用程序中工作时，我最近需要组装一个以逗号分隔的值列表以传递给另一个 Web 服务，而无需事先知道有多少元素。我能想到的最好的事情是这样的：

```
public String appendWithDelimiter( String original, String addition, String delimiter ) {
    if ( original.equals( "" ) ) {
        return addition;
    } else {
        return original + delimiter + addition;
    }
}

String parameterString = "";
if ( condition ) parameterString = appendWithDelimiter( parameterString, "elementName", "," );
if ( anotherCondition ) parameterString = appendWithDelimiter( parameterString, "anotherElementName", "," ); 
```

我意识到这不是特别有效，因为到处都在创建字符串，但我的目的是为了清晰而不是优化。

在 Ruby 中，我可以做这样的事情，感觉更优雅：

```
parameterArray = [];
parameterArray << "elementName" if condition;
parameterArray << "anotherElementName" if anotherCondition;
parameterString = parameterArray.join(","); 
```

但是由于 Java 缺少连接命令，所以我想不出任何等效的东西。

那么，在 Java 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：604
> 
> 时间：2008-09-15T14:13:34.720

### Java 8 之前：

Apache 的 commons lang 在这里是你的朋友——它提供了一种与你在 Ruby 中引用的非常相似的 join 方法：

[`StringUtils.join(java.lang.Iterable,char)`](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#join(java.lang.Iterable,%20char))

* * *

### 爪哇 8：

`StringJoiner`Java 8 通过和提供开箱即用的连接`String.join()`。下面的片段显示了如何使用它们：

[`StringJoiner`](https://docs.oracle.com/javase/8/docs/api/java/util/StringJoiner.html)

```
StringJoiner joiner = new StringJoiner(",");
joiner.add("01").add("02").add("03");
String joinedString = joiner.toString(); // "01,02,03" 
```

* * *

[`String.join(CharSequence delimiter, CharSequence... elements))`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.CharSequence...-)

```
String joinedString = String.join(" - ", "04", "05", "06"); // "04 - 05 - 06" 
```

* * *

[`String.join(CharSequence delimiter, Iterable<? extends CharSequence> elements)`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.Iterable-)

```
List<String> strings = new LinkedList<>();
strings.add("Java");strings.add("is");
strings.add("cool");
String message = String.join(" ", strings);
//message returned is: "Java is cool" 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-09-15T14:15:23.750

您可以编写一个适用于 java.util.Lists 的小型连接式实用程序方法

```
public static String join(List<String> list, String delim) {

    StringBuilder sb = new StringBuilder();

    String loopDelim = "";

    for(String s : list) {

        sb.append(loopDelim);
        sb.append(s);            

        loopDelim = delim;
    }

    return sb.toString();
} 
```

然后像这样使用它：

```
 List<String> list = new ArrayList<String>();

    if( condition )        list.add("elementName");
    if( anotherCondition ) list.add("anotherElementName");

    join(list, ","); 
```

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2011-05-15T22:16:13.707

在 Android 的情况下，来自 commons 的 StringUtils 类不可用，所以为此我使用了

```
android.text.TextUtils.join(CharSequence delimiter, Iterable tokens) 
```

[http://developer.android.com/reference/android/text/TextUtils.html](http://developer.android.com/reference/android/text/TextUtils.html)

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2012-09-18T06:55:47.057

[Google 的 Guava 库](http://code.google.com/p/guava-libraries/)有com.google.common.base.Joiner***[类](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Joiner.html)***，可以帮助解决这些任务。

样品：

```
"My pets are: " + Joiner.on(", ").join(Arrays.asList("rabbit", "parrot", "dog")); 
// returns "My pets are: rabbit, parrot, dog"

Joiner.on(" AND ").join(Arrays.asList("field1=1" , "field2=2", "field3=3"));
// returns "field1=1 AND field2=2 AND field3=3"

Joiner.on(",").skipNulls().join(Arrays.asList("London", "Moscow", null, "New York", null, "Paris"));
// returns "London,Moscow,New York,Paris"

Joiner.on(", ").useForNull("Team held a draw").join(Arrays.asList("FC Barcelona", "FC Bayern", null, null, "Chelsea FC", "AC Milan"));
// returns "FC Barcelona, FC Bayern, Team held a draw, Team held a draw, Chelsea FC, AC Milan" 
```

* * *

这是[一篇关于 Guava 的字符串实用程序](http://code.google.com/p/guava-libraries/wiki/StringsExplained)的文章。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2014-03-22T12:30:59.070

在 Java 8 中，您可以使用[`String.join()`](http://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.Iterable-)：

```
List<String> list = Arrays.asList("foo", "bar", "baz");
String joined = String.join(" and ", list); // "foo and bar and baz" 
```

另请查看[此答案](https://stackoverflow.com/a/22577565/1115554)以获取 Stream API 示例。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2014-12-22T09:23:31.380

在 Java 8 中，您可以这样做：

```
list.stream().map(Object::toString)
        .collect(Collectors.joining(delimiter)); 
```

如果列表有空值，您可以使用：

```
list.stream().map(String::valueOf)
        .collect(Collectors.joining(delimiter)) 
```

它还支持前缀和后缀：

```
list.stream().map(String::valueOf)
        .collect(Collectors.joining(delimiter, prefix, suffix)); 
```

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2008-09-15T14:07:31.897

您可以概括它，但正如您所说，Java 中没有连接。

[这](http://snippets.dzone.com/posts/show/91)可能会更好。

```
public static String join(Iterable<? extends CharSequence> s, String delimiter) {
    Iterator<? extends CharSequence> iter = s.iterator();
    if (!iter.hasNext()) return "";
    StringBuilder buffer = new StringBuilder(iter.next());
    while (iter.hasNext()) buffer.append(delimiter).append(iter.next());
    return buffer.toString();
} 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2008-09-15T14:05:17.487

使用基于[`java.lang.StringBuilder`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/StringBuilder.html)! （“一个可变的字符序列。”）

就像您提到的那样，所有这些字符串连接都在创建字符串。 `StringBuilder`不会那样做。

为什么`StringBuilder`而不是[`StringBuffer`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/StringBuffer.html)？从`StringBuilder`javadoc：

> 在可能的情况下，建议优先使用此类而不是 StringBuffer，因为它在大多数实现下会更快。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-09-15T14:21:38.913

我会使用谷歌收藏。有一个不错的加入设施。
[http://google-collections.googlecode.com/svn/trunk/javadoc/index.html?com/google/common/base/Join.html](http://google-collections.googlecode.com/svn/trunk/javadoc/index.html?com/google/common/base/Join.html)

但如果我想自己写，

```
package util;

import java.util.ArrayList;
import java.util.Iterable;
import java.util.Collections;
import java.util.Iterator;

public class Utils {
    // accept a collection of objects, since all objects have toString()
    public static String join(String delimiter, Iterable<? extends Object> objs) {
        if (objs.isEmpty()) {
            return "";
        }
        Iterator<? extends Object> iter = objs.iterator();
        StringBuilder buffer = new StringBuilder();
        buffer.append(iter.next());
        while (iter.hasNext()) {
            buffer.append(delimiter).append(iter.next());
        }
        return buffer.toString();
    }

    // for convenience
    public static String join(String delimiter, Object... objs) {
        ArrayList<Object> list = new ArrayList<Object>();
        Collections.addAll(list, objs);
        return join(delimiter, list);
    }
} 
```

我认为它更适用于对象集合，因为现在您不必在加入对象之前将它们转换为字符串。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2008-09-15T14:17:36.647

[Apache commons](http://commons.apache.org/) StringUtils 类有一个 join 方法。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2015-10-31T11:38:39.100

## 爪哇 8

```
stringCollection.stream().collect(Collectors.joining(", ")); 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2018-04-16T15:10:02.887

Java 8 原生类型

```
List<Integer> example;
example.add(1);
example.add(2);
example.add(3);
...
example.stream().collect(Collectors.joining(",")); 
```

Java 8 自定义对象：

```
List<Person> person;
...
person.stream().map(Person::getAge).collect(Collectors.joining(",")); 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-11-17T22:07:32.153

使用 StringBuilder 和类`Separator`

```
StringBuilder buf = new StringBuilder();
Separator sep = new Separator(", ");
for (String each : list) {
    buf.append(sep).append(each);
} 
```

分隔符包裹一个分隔符。分隔符由 Separator 的`toString`方法返回，除非在第一次调用时返回空字符串！

类的源代码`Separator`

```
public class Separator {

    private boolean skipFirst;
    private final String value;

    public Separator() {
        this(", ");
    }

    public Separator(String value) {
        this.value = value;
        this.skipFirst = true;
    }

    public void reset() {
        skipFirst = true;
    }

    public String toString() {
        String sep = skipFirst ? "" : value;
        skipFirst = false;
        return sep;
    }

} 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-15T14:06:13.257

您可以为此使用 Java 的[`StringBuilder`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/StringBuilder.html)类型。还有`StringBuffer`，但它包含通常不必要的额外线程安全逻辑。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2014-03-26T11:21:36.963

还有一个最小的（如果您不想仅仅为了加入字符串而将 Apache Commons 或 Gauva 包含到项目依赖项中）

```
/**
 *
 * @param delim : String that should be kept in between the parts
 * @param parts : parts that needs to be joined
 * @return  a String that's formed by joining the parts
 */
private static final String join(String delim, String... parts) {
    StringBuilder builder = new StringBuilder();
    for (int i = 0; i < parts.length - 1; i++) {
        builder.append(parts[i]).append(delim);
    }
    if(parts.length > 0){
        builder.append(parts[parts.length - 1]);
    }
    return builder.toString();
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-15T14:06:32.023

为什么不编写自己的 join() 方法？它将作为参数集合的字符串和分隔符字符串。在该方法中迭代集合并在 StringBuffer 中构建您的结果。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-11-16T02:15:13.050

如果您使用的是[Eclipse Collections](https://www.eclipse.org/collections/)，您可以使用`makeString()`或`appendString()`。

`makeString()`返回一个`String`表示，类似于`toString()`.

它有三种形式

*   `makeString(start, separator, end)`
*   `makeString(separator)`默认开始和结束为空字符串
*   `makeString()`默认分隔符为`", "`（逗号和空格）

代码示例：

```
MutableList<Integer> list = FastList.newListWith(1, 2, 3);
assertEquals("[1/2/3]", list.makeString("[", "/", "]"));
assertEquals("1/2/3", list.makeString("/"));
assertEquals("1, 2, 3", list.makeString());
assertEquals(list.toString(), list.makeString("[", ", ", "]")); 
```

`appendString()`类似于`makeString()`，但它附加到`Appendable`(like `StringBuilder`) 和 is `void`。它具有相同的三种形式，但多了一个第一个参数，即 Appendable。

```
MutableList<Integer> list = FastList.newListWith(1, 2, 3);
Appendable appendable = new StringBuilder();
list.appendString(appendable, "[", "/", "]");
assertEquals("[1/2/3]", appendable.toString()); 
```

如果您无法将您的集合转换为 Eclipse Collections 类型，只需使用相关适配器对其进行调整。

```
List<Object> list = ...;
ListAdapter.adapt(list).makeString(","); 
```

**注意：**我是 Eclipse 集合的提交者。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2016-04-25T11:55:01.727

如果您使用的是 Spring MVC，那么您可以尝试以下步骤。

```
import org.springframework.util.StringUtils;

List<String> groupIds = new List<String>;   
groupIds.add("a");    
groupIds.add("b");    
groupIds.add("c");

String csv = StringUtils.arrayToCommaDelimitedString(groupIds.toArray()); 
```

这将导致`a,b,c`

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-15T14:10:23.963

您可能应该使用 a `StringBuilder`with`append`方法来构造您的结果，但除此之外，这与 Java 提供的解决方案一样好。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-15T14:10:35.150

为什么不在 Java 中做与在 ruby​​ 中所做的相同的事情，即仅在将所有片段添加到数组后才创建分隔符分隔的字符串？

```
ArrayList<String> parms = new ArrayList<String>();
if (someCondition) parms.add("someString");
if (anotherCondition) parms.add("someOtherString");
// ...
String sep = ""; StringBuffer b = new StringBuffer();
for (String p: parms) {
    b.append(sep);
    b.append(p);
    sep = "yourDelimiter";
} 
```

您可能希望在单独的辅助方法中移动该 for 循环，并使用 StringBuilder 而不是 StringBuffer ...

*编辑*：修复了追加的顺序。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-09-16T19:36:23.517

使用 Java 5 变量 args，因此您不必将所有字符串显式地填充到集合或数组中：

```
import junit.framework.Assert;
import org.junit.Test;

public class StringUtil
{
    public static String join(String delim, String... strings)
    {
        StringBuilder builder = new StringBuilder();

        if (strings != null)
        {
            for (String str : strings)
            {
                if (builder.length() > 0)
                {
                    builder.append(delim).append(" ");
                }
                builder.append(str);
            }
        }           
        return builder.toString();
    }
    @Test
    public void joinTest()
    {
        Assert.assertEquals("", StringUtil.join(",", null));
        Assert.assertEquals("", StringUtil.join(",", ""));
        Assert.assertEquals("", StringUtil.join(",", new String[0]));
        Assert.assertEquals("test", StringUtil.join(",", "test"));
        Assert.assertEquals("foo, bar", StringUtil.join(",", "foo", "bar"));
        Assert.assertEquals("foo, bar, x", StringUtil.join(",", "foo", "bar", "x"));
    }
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-01-21T09:44:39.330

对于那些在 Spring 上下文中的人，他们的[StringUtils](http://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/util/StringUtils.html)类也很有用：

有许多有用的快捷方式，例如：

*   collectionToCommaDelimitedString(Collection coll)
*   collectionToDelimitedString(Collection coll, String delim)
*   arrayToDelimitedString(Object[] arr, String delim)

和许多其他人。

如果您尚未使用 Java 8 并且您已经处于 Spring 上下文中，这将很有帮助。

我更喜欢它而不是 Apache Commons（虽然也非常好），因为 Collection 支持更简单，如下所示：

```
// Encoding Set<String> to String delimited 
String asString = org.springframework.util.StringUtils.collectionToDelimitedString(codes, ";");

// Decoding String delimited to Set
Set<String> collection = org.springframework.util.StringUtils.commaDelimitedListToSet(asString); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-15T14:09:26.900

你可以尝试这样的事情：

```
StringBuilder sb = new StringBuilder();
if (condition) { sb.append("elementName").append(","); }
if (anotherCondition) { sb.append("anotherElementName").append(","); }
String parameterString = sb.toString(); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-15T14:15:58.990

所以基本上是这样的：

```
public static String appendWithDelimiter(String original, String addition, String delimiter) {

if (original.equals("")) {
    return addition;
} else {
    StringBuilder sb = new StringBuilder(original.length() + addition.length() + delimiter.length());
        sb.append(original);
        sb.append(delimiter);
        sb.append(addition);
        return sb.toString();
    }
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-15T14:17:37.037

不知道这是否真的更好，但至少它使用了 StringBuilder，这可能会稍微更有效率。

如果您可以在进行任何参数定界之前建立参数列表，那么下面是一种更通用的方法。

```
// Answers real question
public String appendWithDelimiters(String delimiter, String original, String addition) {
    StringBuilder sb = new StringBuilder(original);
    if(sb.length()!=0) {
        sb.append(delimiter).append(addition);
    } else {
        sb.append(addition);
    }
    return sb.toString();
}

// A more generic case.
// ... means a list of indeterminate length of Strings.
public String appendWithDelimitersGeneric(String delimiter, String... strings) {
    StringBuilder sb = new StringBuilder();
    for (String string : strings) {
        if(sb.length()!=0) {
            sb.append(delimiter).append(string);
        } else {
            sb.append(string);
        }
    }

    return sb.toString();
}

public void testAppendWithDelimiters() {
    String string = appendWithDelimitersGeneric(",", "string1", "string2", "string3");
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-15T14:19:09.683

您的方法还不错，但您应该使用 StringBuffer 而不是使用 + 号。+ 有一个很大的缺点，即为每个单独的操作创建一个新的 String 实例。你的字符串越长，开销就越大。所以使用 StringBuffer 应该是最快的方法：

```
public StringBuffer appendWithDelimiter( StringBuffer original, String addition, String delimiter ) {
        if ( original == null ) {
                StringBuffer buffer = new StringBuffer();
                buffer.append(addition);
                return buffer;
        } else {
                buffer.append(delimiter);
                buffer.append(addition);
                return original;
        }
} 
```

完成创建字符串后，只需在返回的 StringBuffer 上调用 toString()。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-15T14:29:10.860

如果您的代码不是线程化的，则应该使用 StringBuilder 和 StringBuffer（如果是），而不是使用字符串连接。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-09-15T14:30:45.880

你让这变得比它必须的复杂一点。让我们从示例的结尾开始：

```
String parameterString = "";
if ( condition ) parameterString = appendWithDelimiter( parameterString, "elementName", "," );
if ( anotherCondition ) parameterString = appendWithDelimiter( parameterString, "anotherElementName", "," ); 
```

随着使用 StringBuilder 而不是 String 的微小变化，这变为：

```
StringBuilder parameterString = new StringBuilder();
if (condition) parameterString.append("elementName").append(",");
if (anotherCondition) parameterString.append("anotherElementName").append(",");
... 
```

完成后（我假设您还必须检查其他一些条件），只需确保使用以下命令删除尾逗号：

```
if (parameterString.length() > 0) 
    parameterString.deleteCharAt(parameterString.length() - 1); 
```

最后，得到你想要的字符串

```
parameterString.toString(); 
```

您还可以将第二次调用中的“，”替换为可以设置为任何内容的通用分隔符字符串。如果您知道需要（无条件地）附加的内容列表，则可以将此代码放在采用字符串列表的方法中。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-09-15T15:16:44.397

```
//Note: if you have access to Java5+, 
//use StringBuilder in preference to StringBuffer.  
//All that has to be replaced is the class name.  
//StringBuffer will work in Java 1.4, though.

appendWithDelimiter( StringBuffer buffer, String addition, 
    String delimiter ) {
    if ( buffer.length() == 0) {
        buffer.append(addition);
    } else {
        buffer.append(delimiter);
        buffer.append(addition);
    }
}

StringBuffer parameterBuffer = new StringBuffer();
if ( condition ) { 
    appendWithDelimiter(parameterBuffer, "elementName", "," );
}
if ( anotherCondition ) {
    appendWithDelimiter(parameterBuffer, "anotherElementName", "," );
}

//Finally, to return a string representation, call toString() when returning.
return parameterBuffer.toString(); 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-09-16T19:50:47.147

因此，您可能会做一些事情来获得您正在寻找的感觉：

1) 扩展 List 类 - 并向其中添加 join 方法。join 方法将简单地完成连接和添加分隔符的工作（这可能是 join 方法的参数）

2) 看起来 Java 7 将向 java 添加扩展方法 - 它允许您将特定方法附加到类上：因此您可以编写该 join 方法并将其作为扩展方法添加到 List 甚至收藏。

解决方案 1 可能是目前唯一现实的解决方案，尽管 Java 7 还没有推出 :) 但它应该可以正常工作。

要使用这两者，您只需像往常一样将所有项目添加到列表或集合中，然后调用新的自定义方法来“加入”它们。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2010-02-01T19:24:59.827

使用[Dollar](http://bitbucket.org/dfa/dollar)很简单，只需键入：

```
String joined = $(aCollection).join(","); 
```

注意：它也适用于数组和其他数据类型

## 执行

在内部，它使用了一个非常巧妙的技巧：

```
@Override
public String join(String separator) {
    Separator sep = new Separator(separator);
    StringBuilder sb = new StringBuilder();

    for (T item : iterable) {
        sb.append(sep).append(item);
    }

    return sb.toString();
} 
```

该类`Separator`仅在第一次调用时返回空字符串，然后返回分隔符：

```
class Separator {

    private final String separator;
    private boolean wasCalled;

    public Separator(String separator) {
        this.separator = separator;
        this.wasCalled = false;
    }

    @Override
    public String toString() {
        if (!wasCalled) {
            wasCalled = true;
            return "";
        } else {
            return separator;
        }
    }
} 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2010-07-26T19:19:14.010

来自 izb 的版本略有改进 [速度]：

```
public static String join(String[] strings, char del)
{
    StringBuilder sb = new StringBuilder();
    int len = strings.length;

    if(len > 1) 
    {
       len -= 1;
    }else
    {
       return strings[0];
    }

    for (int i = 0; i < len; i++)
    {
       sb.append(strings[i]).append(del);
    }

    sb.append(strings[i]);

    return sb.toString();
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2015-03-19T01:30:50.667

修复答案 Rob Dickerson。

它更容易使用：

```
public static String join(String delimiter, String... values)
{
    StringBuilder stringBuilder = new StringBuilder();

    for (String value : values)
    {
        stringBuilder.append(value);
        stringBuilder.append(delimiter);
    }

    String result = stringBuilder.toString();

    return result.isEmpty() ? result : result.substring(0, result.length() - 1);
} 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2016-08-21T17:46:49.260

我个人经常使用以下简单的解决方案进行日志记录：

```
List lst = Arrays.asList("ab", "bc", "cd");
String str = lst.toString().replaceAll("[\\[\\]]", ""); 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2019-11-29T06:37:59.657

如果要在对象属性列表中应用逗号。这是我发现最有用的方式。

这里**getName()**是我一直试图添加“，”的类的字符串属性。

**字符串消息 = listName.stream().map(list -> list.getName()).collect(Collectors.joining(", "));**

* * *

## 回答 #36

> 赞同：-2
> 
> 时间：2008-09-15T14:09:28.583

```
public static String join(String[] strings, char del)
{
    StringBuffer sb = new StringBuffer();
    int len = strings.length;
    boolean appended = false;
    for (int i = 0; i < len; i++)
    {
        if (appended)
        {
            sb.append(del);
        }
        sb.append(""+strings[i]);
        appended = true;
    }
    return sb.toString();
} 
```

# c - 在 C 中挂钩到 TCP 堆栈

> ID：63157
> 
> 赞同：4
> 
> 时间：2008-09-15T14:03:59.797
> 
> 标签：c, tcp, stack, freebsd, bsd

这不仅仅是我想要在这里进行的捕捉。我想首先捕获数据包，然后实时检查特定数据的有效负载，将其删除，注入签名并将数据包重新注入堆栈以像以前一样发送。

我阅读了使用 IPFW 的 ipfw 转移套接字，它看起来很有希望。修改数据包并使用转移套接字将它们重新注入堆栈的示例怎么样？另外，出于好奇，是否可以使用 Java 从套接字读取数据，或者这是否会限制我打包和重新注入等？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T14:16:20.423

请参阅转向插座：[转向插座 mini HOWTO](http://www.faqs.org/docs/Linux-mini/Divert-Sockets-mini-HOWTO.html)。

它们通过将匹配某个 ipfw 规则的流量传递到一个特殊的原始套接字来工作，然后该套接字可以将更改的流量重新注入网络层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T14:17:35.617

如果您只是在寻找数据包捕获，那么 libpcap 非常受欢迎。它用于 tcpdump 和 ethereal 等基本工具。至于“挂钩到堆栈”，除非您计划从根本上改变网络实现方式（即添加您自己的层或更改 TCP 的行为），否则您使用 IPF 进行数据包修改或干预的想法似乎最好的选择。在 Linux 中，他们有一个特定的用户空间模块重定向目标，IPF 可能有类似的东西，或者你可以修改 IPF 来做类似的事情。

如果您只是对查看数据包感兴趣，那么 libpcap 是您的最佳选择。您可以在以下网址找到它：[http ://www.tcpdump.org/](http://www.tcpdump.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-20T08:06:26.860

我认为可以使用 QUEUE 或 NFQUEUE iptables 目标在用户空间中执行此操作。客户端应用程序附加到一个队列并接收所有匹配的数据包，它可以在重新注入之前对其进行修改（如果需要，它也可以丢弃它们）。

有一个需要链接的客户端库 libnetfilter_queue。遗憾的是，文档很少，但有一些邮件列表帖子和示例四处流传。

出于性能原因，您不希望对每个数据包都执行​​此操作，而只想对特定匹配的数据包执行此操作，您必须使用标准 iptables 规则对其进行匹配。如果这还不够，您需要编写自己的 netfilter 内核模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-20T08:52:43.130

我将回应其他推荐 iptables 的响应（取决于您尝试匹配的模式和您想要进行的数据包修改的复杂性） - 直到我注意到问题上的 BSD 标记。

正如[Stephen Pellicer](https://stackoverflow.com/users/360/stephen-pellicer)已经提到的，libpcap 是捕获数据包的好选择。不过，我相信 libpcap 也可以用来发送数据包。作为参考，我很确定[tcpreplay](http://tcpreplay.synfin.net/)使用它来重播 pcap 格式的文件。

# c++ - 如何从进程内部确定 CPU 和内存消耗

> ID：63166
> 
> 赞同：687
> 
> 时间：2008-09-15T14:04:43.727
> 
> 标签：c++, c, memory, cpu

我曾经的任务是从正在运行的应用程序内部确定以下性能参数：

*   可用的总虚拟内存
*   当前使用的虚拟内存
*   我的进程当前使用的虚拟内存

    * * *

*   可用总 RAM
*   当前使用的内存
*   我的进程当前使用的 RAM

    * * *

*   当前使用的 CPU 百分比
*   我的进程当前使用的 CPU 百分比

代码必须在 Windows 和 Linux 上运行。尽管这似乎是一项标准任务，但在手册（WIN32 API、GNU 文档）以及 Internet 上查找必要的信息还是花了我几天的时间，因为关于这个主题的信息太多不完整/不正确/过时了在那里发现。

为了避免其他人遇到同样的麻烦，我认为将所有零散的信息以及我通过反复试验发现的信息收集在一个地方是个好主意。

* * *

## 回答 #1

> 赞同：736
> 
> 时间：2008-09-15T15:55:30.560

## 视窗

上面的一些值很容易从适当的 Win32 API 中获得，为了完整起见，我只是在这里列出它们。然而，其他的则需要从 Performance Data Helper 库 (PDH) 中获取，这有点“不直观”，并且需要大量痛苦的试验和错误才能开始工作。（至少我花了很长时间，也许我只是有点愚蠢......）

注意：为清楚起见，以下代码中省略了所有错误检查。请检查返回码...！

*   总虚拟内存：

    ```
    #include "windows.h"

    MEMORYSTATUSEX memInfo;
    memInfo.dwLength = sizeof(MEMORYSTATUSEX);
    GlobalMemoryStatusEx(&memInfo);
    DWORDLONG totalVirtualMem = memInfo.ullTotalPageFile; 
    ```

    注意：这里的名称“TotalPageFile”有点误导。实际上，此参数给出了“虚拟内存大小”，即交换文件的大小加上已安装的 RAM。

*   当前使用的虚拟内存：

    与“总虚拟内存”中的代码相同，然后

    ```
     DWORDLONG virtualMemUsed = memInfo.ullTotalPageFile - memInfo.ullAvailPageFile; 
    ```

*   当前进程当前使用的虚拟内存：

    ```
    #include "windows.h"
    #include "psapi.h"

    PROCESS_MEMORY_COUNTERS_EX pmc;
    GetProcessMemoryInfo(GetCurrentProcess(), (PROCESS_MEMORY_COUNTERS*)&pmc, sizeof(pmc));
    SIZE_T virtualMemUsedByMe = pmc.PrivateUsage; 
    ```

*   总物理内存 (RAM)：

    与“总虚拟内存”中的代码相同，然后

    ```
    DWORDLONG totalPhysMem = memInfo.ullTotalPhys; 
    ```

*   当前使用的物理内存：

    与“总虚拟内存”中的代码相同，然后

    ```
    DWORDLONG physMemUsed = memInfo.ullTotalPhys - memInfo.ullAvailPhys; 
    ```

*   当前进程当前使用的物理内存：

    与“当前进程当前使用的虚拟内存”中的代码相同，然后

    ```
    SIZE_T physMemUsedByMe = pmc.WorkingSetSize; 
    ```

*   当前使用的CPU：

    ```
    #include "TCHAR.h"
    #include "pdh.h"

    static PDH_HQUERY cpuQuery;
    static PDH_HCOUNTER cpuTotal;

    void init(){
        PdhOpenQuery(NULL, NULL, &cpuQuery);
        // You can also use L"\\Processor(*)\\% Processor Time" and get individual CPU values with PdhGetFormattedCounterArray()
        PdhAddEnglishCounter(cpuQuery, L"\\Processor(_Total)\\% Processor Time", NULL, &cpuTotal);
        PdhCollectQueryData(cpuQuery);
    }

    double getCurrentValue(){
        PDH_FMT_COUNTERVALUE counterVal;

        PdhCollectQueryData(cpuQuery);
        PdhGetFormattedCounterValue(cpuTotal, PDH_FMT_DOUBLE, NULL, &counterVal);
        return counterVal.doubleValue;
    } 
    ```

*   当前进程当前使用的 CPU：

    ```
    #include "windows.h"

    static ULARGE_INTEGER lastCPU, lastSysCPU, lastUserCPU;
    static int numProcessors;
    static HANDLE self;

    void init(){
        SYSTEM_INFO sysInfo;
        FILETIME ftime, fsys, fuser;

        GetSystemInfo(&sysInfo);
        numProcessors = sysInfo.dwNumberOfProcessors;

        GetSystemTimeAsFileTime(&ftime);
        memcpy(&lastCPU, &ftime, sizeof(FILETIME));

        self = GetCurrentProcess();
        GetProcessTimes(self, &ftime, &ftime, &fsys, &fuser);
        memcpy(&lastSysCPU, &fsys, sizeof(FILETIME));
        memcpy(&lastUserCPU, &fuser, sizeof(FILETIME));
    }

    double getCurrentValue(){
        FILETIME ftime, fsys, fuser;
        ULARGE_INTEGER now, sys, user;
        double percent;

        GetSystemTimeAsFileTime(&ftime);
        memcpy(&now, &ftime, sizeof(FILETIME));

        GetProcessTimes(self, &ftime, &ftime, &fsys, &fuser);
        memcpy(&sys, &fsys, sizeof(FILETIME));
        memcpy(&user, &fuser, sizeof(FILETIME));
        percent = (sys.QuadPart - lastSysCPU.QuadPart) +
            (user.QuadPart - lastUserCPU.QuadPart);
        percent /= (now.QuadPart - lastCPU.QuadPart);
        percent /= numProcessors;
        lastCPU = now;
        lastUserCPU = user;
        lastSysCPU = sys;

        return percent * 100;
    } 
    ```

* * *

## Linux

在 Linux 上，起初似乎很明显的选择是使用 POSIX API 等`getrusage()`。我花了一些时间试图让它工作，但从来没有得到有意义的值。当我最终自己检查内核源代码时，我发现显然这些 API 在 Linux 内核 2.6 中还没有完全实现！？

最后，我通过读取伪文件系统`/proc`和内核调用的组合获得了所有值。

*   总虚拟内存：

    ```
    #include "sys/types.h"
    #include "sys/sysinfo.h"

    struct sysinfo memInfo;

    sysinfo (&memInfo);
    long long totalVirtualMem = memInfo.totalram;
    //Add other values in next statement to avoid int overflow on right hand side...
    totalVirtualMem += memInfo.totalswap;
    totalVirtualMem *= memInfo.mem_unit; 
    ```

*   当前使用的虚拟内存：

    与“总虚拟内存”中的代码相同，然后

    ```
    long long virtualMemUsed = memInfo.totalram - memInfo.freeram;
    //Add other values in next statement to avoid int overflow on right hand side...
    virtualMemUsed += memInfo.totalswap - memInfo.freeswap;
    virtualMemUsed *= memInfo.mem_unit; 
    ```

*   当前进程当前使用的虚拟内存：

    ```
    #include "stdlib.h"
    #include "stdio.h"
    #include "string.h"

    int parseLine(char* line){
        // This assumes that a digit will be found and the line ends in " Kb".
        int i = strlen(line);
        const char* p = line;
        while (*p <'0' || *p > '9') p++;
        line[i-3] = '\0';
        i = atoi(p);
        return i;
    }

    int getValue(){ //Note: this value is in KB!
        FILE* file = fopen("/proc/self/status", "r");
        int result = -1;
        char line[128];

        while (fgets(line, 128, file) != NULL){
            if (strncmp(line, "VmSize:", 7) == 0){
                result = parseLine(line);
                break;
            }
        }
        fclose(file);
        return result;
    } 
    ```

*   总物理内存 (RAM)：

    与“总虚拟内存”中的代码相同，然后

    ```
    long long totalPhysMem = memInfo.totalram;
    //Multiply in next statement to avoid int overflow on right hand side...
    totalPhysMem *= memInfo.mem_unit; 
    ```

*   当前使用的物理内存：

    与“总虚拟内存”中的代码相同，然后

    ```
    long long physMemUsed = memInfo.totalram - memInfo.freeram;
    //Multiply in next statement to avoid int overflow on right hand side...
    physMemUsed *= memInfo.mem_unit; 
    ```

*   当前进程当前使用的物理内存：

    将“当前进程当前使用的虚拟内存”中的getValue()更改如下：

    ```
    int getValue(){ //Note: this value is in KB!
        FILE* file = fopen("/proc/self/status", "r");
        int result = -1;
        char line[128];

        while (fgets(line, 128, file) != NULL){
            if (strncmp(line, "VmRSS:", 6) == 0){
                result = parseLine(line);
                break;
            }
        }
        fclose(file);
        return result;
    } 
    ```

*   当前使用的CPU：

    ```
    #include "stdlib.h"
    #include "stdio.h"
    #include "string.h"

    static unsigned long long lastTotalUser, lastTotalUserLow, lastTotalSys, lastTotalIdle;

    void init(){
        FILE* file = fopen("/proc/stat", "r");
        fscanf(file, "cpu %llu %llu %llu %llu", &lastTotalUser, &lastTotalUserLow,
            &lastTotalSys, &lastTotalIdle);
        fclose(file);
    }

    double getCurrentValue(){
        double percent;
        FILE* file;
        unsigned long long totalUser, totalUserLow, totalSys, totalIdle, total;

        file = fopen("/proc/stat", "r");
        fscanf(file, "cpu %llu %llu %llu %llu", &totalUser, &totalUserLow,
            &totalSys, &totalIdle);
        fclose(file);

        if (totalUser < lastTotalUser || totalUserLow < lastTotalUserLow ||
            totalSys < lastTotalSys || totalIdle < lastTotalIdle){
            //Overflow detection. Just skip this value.
            percent = -1.0;
        }
        else{
            total = (totalUser - lastTotalUser) + (totalUserLow - lastTotalUserLow) +
                (totalSys - lastTotalSys);
            percent = total;
            total += (totalIdle - lastTotalIdle);
            percent /= total;
            percent *= 100;
        }

        lastTotalUser = totalUser;
        lastTotalUserLow = totalUserLow;
        lastTotalSys = totalSys;
        lastTotalIdle = totalIdle;

        return percent;
    } 
    ```

*   当前进程当前使用的 CPU：

    ```
    #include "stdlib.h"
    #include "stdio.h"
    #include "string.h"
    #include "sys/times.h"
    #include "sys/vtimes.h"

    static clock_t lastCPU, lastSysCPU, lastUserCPU;
    static int numProcessors;

    void init(){
        FILE* file;
        struct tms timeSample;
        char line[128];

        lastCPU = times(&timeSample);
        lastSysCPU = timeSample.tms_stime;
        lastUserCPU = timeSample.tms_utime;

        file = fopen("/proc/cpuinfo", "r");
        numProcessors = 0;
        while(fgets(line, 128, file) != NULL){
            if (strncmp(line, "processor", 9) == 0) numProcessors++;
        }
        fclose(file);
    }

    double getCurrentValue(){
        struct tms timeSample;
        clock_t now;
        double percent;

        now = times(&timeSample);
        if (now <= lastCPU || timeSample.tms_stime < lastSysCPU ||
            timeSample.tms_utime < lastUserCPU){
            //Overflow detection. Just skip this value.
            percent = -1.0;
        }
        else{
            percent = (timeSample.tms_stime - lastSysCPU) +
                (timeSample.tms_utime - lastUserCPU);
            percent /= (now - lastCPU);
            percent /= numProcessors;
            percent *= 100;
        }
        lastCPU = now;
        lastSysCPU = timeSample.tms_stime;
        lastUserCPU = timeSample.tms_utime;

        return percent;
    } 
    ```

* * *

## TODO：其他平台

我会假设，一些 Linux 代码也适用于 Unix，除了读取 /proc 伪文件系统的部分。也许在 Unix 上，这些部分可以用`getrusage()`类似的功能代替？

* * *

## 回答 #2

> 赞同：152
> 
> 时间：2009-12-16T02:21:57.443

# Mac OS X

## 总虚拟内存

这在 Mac OS X 上很棘手，因为它不使用预设的交换分区或 Linux 之类的文件。这是 Apple 文档中的一个条目：

> **注意：**与大多数基于 Unix 的操作系统不同，Mac OS X 不为虚拟内存使用预先分配的交换分区。相反，它使用机器引导分区上的所有可用空间。

所以，如果你想知道还有多少虚拟内存可用，你需要得到根分区的大小。你可以这样做：

```
struct statfs stats;
if (0 == statfs("/", &stats))
{
    myFreeSwap = (uint64_t)stats.f_bsize * stats.f_bfree;
} 
```

## 当前使用的虚拟总数

使用“vm.swapusage”键调用 systcl 可以提供有关交换使用的有趣信息：

```
sysctl -n vm.swapusage
vm.swapusage: total = 3072.00M  used = 2511.78M  free = 560.22M  (encrypted) 
```

并不是说如果需要更多交换，此处显示的总交换使用量可能会改变，如上一节所述。所以总数实际上是*当前*的交换总数。在 C++ 中，可以这样查询这些数据：

```
xsw_usage vmusage = {0};
size_t size = sizeof(vmusage);
if( sysctlbyname("vm.swapusage", &vmusage, &size, NULL, 0)!=0 )
{
   perror( "unable to get swap usage by calling sysctlbyname(\"vm.swapusage\",...)" );
} 
```

请注意，在 sysctl.h 中声明的“xsw_usage”似乎没有记录在案，我怀疑有一种更便携的方式来访问这些值。

## 我的进程当前使用的虚拟内存

`task_info`您可以使用该功能获取有关当前进程的统计信息。这包括进程的当前驻留大小和当前虚拟大小。

```
#include<mach/mach.h>

struct task_basic_info t_info;
mach_msg_type_number_t t_info_count = TASK_BASIC_INFO_COUNT;

if (KERN_SUCCESS != task_info(mach_task_self(),
                              TASK_BASIC_INFO, (task_info_t)&t_info,
                              &t_info_count))
{
    return -1;
}
// resident size is in t_info.resident_size;
// virtual size is in t_info.virtual_size; 
```

## 可用总 RAM

系统中可用的物理 RAM 量可使用如下`sysctl`系统函数获得：

```
#include <sys/types.h>
#include <sys/sysctl.h>
...
int mib[2];
int64_t physical_memory;
mib[0] = CTL_HW;
mib[1] = HW_MEMSIZE;
length = sizeof(int64_t);
sysctl(mib, 2, &physical_memory, &length, NULL, 0); 
```

## 当前使用的内存

您可以从`host_statistics`系统函数中获取一般内存统计信息。

```
#include <mach/vm_statistics.h>
#include <mach/mach_types.h>
#include <mach/mach_init.h>
#include <mach/mach_host.h>

int main(int argc, const char * argv[]) {
    vm_size_t page_size;
    mach_port_t mach_port;
    mach_msg_type_number_t count;
    vm_statistics64_data_t vm_stats;

    mach_port = mach_host_self();
    count = sizeof(vm_stats) / sizeof(natural_t);
    if (KERN_SUCCESS == host_page_size(mach_port, &page_size) &&
        KERN_SUCCESS == host_statistics64(mach_port, HOST_VM_INFO,
                                        (host_info64_t)&vm_stats, &count))
    {
        long long free_memory = (int64_t)vm_stats.free_count * (int64_t)page_size;

        long long used_memory = ((int64_t)vm_stats.active_count +
                                 (int64_t)vm_stats.inactive_count +
                                 (int64_t)vm_stats.wire_count) *  (int64_t)page_size;
        printf("free memory: %lld\nused memory: %lld\n", free_memory, used_memory);
    }

    return 0;
} 
```

这里需要注意的一点是，Mac OS X 中有五种内存页面。它们如下：

1.  **已锁定且无法换出的**有线页面****
***   **正在加载到物理内存中并且相对难以换出的**活动页面*******   **加载到内存中的非活动**页面，但最近没有使用过，甚至可能根本不需要。这些是交换的潜在候选人。可能需要刷新此内存。*   **缓存**的页面已经被缓存了一些，很可能很容易被重用。缓存内存可能不需要刷新。缓存页面仍有可能被重新激活*   **完全免费并可随时使用的**免费页面。********

 ****需要注意的是，仅仅因为 Mac OS X 有时可能会显示非常少的实际可用内存，这可能并不能很好地表明有多少可以在短时间内使用。

## 我的进程当前使用的 RAM

请参阅上面的“我的进程当前使用的虚拟内存”。相同的代码适用。

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2008-09-15T16:27:38.500

# Linux

在 Linux 中，此信息在 /proc 文件系统中可用。我不太喜欢使用的文本文件格式，因为每个 Linux 发行版似乎都至少自定义了一个重要文件。快速查看“ps”的来源会发现混乱。

但在这里可以找到您寻求的信息：

**/proc/meminfo**包含您寻找的大部分系统范围的信息。这里看起来像在我的系统上；我认为您对**MemTotal**、**MemFree**、**SwapTotal**和**SwapFree 感兴趣**：

```
Anderson cxc # more /proc/meminfo
MemTotal:      4083948 kB
MemFree:       2198520 kB
Buffers:         82080 kB
Cached:        1141460 kB
SwapCached:          0 kB
Active:        1137960 kB
Inactive:       608588 kB
HighTotal:     3276672 kB
HighFree:      1607744 kB
LowTotal:       807276 kB
LowFree:        590776 kB
SwapTotal:     2096440 kB
SwapFree:      2096440 kB
Dirty:              32 kB
Writeback:           0 kB
AnonPages:      523252 kB
Mapped:          93560 kB
Slab:            52880 kB
SReclaimable:    24652 kB
SUnreclaim:      28228 kB
PageTables:       2284 kB
NFS_Unstable:        0 kB
Bounce:              0 kB
CommitLimit:   4138412 kB
Committed_AS:  1845072 kB
VmallocTotal:   118776 kB
VmallocUsed:      3964 kB
VmallocChunk:   112860 kB
HugePages_Total:     0
HugePages_Free:      0
HugePages_Rsvd:      0
Hugepagesize:     2048 kB 
```

对于 CPU 利用率，您必须做一些工作。Linux 提供自系统启动以来的整体 CPU 利用率；这可能不是您感兴趣的。如果您想知道最后一秒或 10 秒的 CPU 利用率是多少，那么您需要查询信息并自行计算。

该信息在**/proc/stat中可用，在**[http://www.linuxhowtos.org/System/procstat.htm](http://www.linuxhowtos.org/System/procstat.htm)中有很好的记录；这是我的 4 核盒子上的样子：

```
Anderson cxc #  more /proc/stat
cpu  2329889 0 2364567 1063530460 9034 9463 96111 0
cpu0 572526 0 636532 265864398 2928 1621 6899 0
cpu1 590441 0 531079 265949732 4763 351 8522 0
cpu2 562983 0 645163 265796890 682 7490 71650 0
cpu3 603938 0 551790 265919440 660 0 9040 0
intr 37124247
ctxt 50795173133
btime 1218807985
processes 116889
procs_running 1
procs_blocked 0 
```

首先，您需要确定系统中有多少 CPU（或处理器，或处理内核）可用。为此，请计算“cpuN”条目的数量，其中 N 从 0 开始并递增。不要计算 'cpu' 行，它是 cpuN 行的组合。在我的示例中，您可以看到 cpu0 到 cpu3，总共有 4 个处理器。从现在开始，您可以忽略 cpu0..cpu3，而只关注“cpu”行。

接下来，您需要知道这些行中的第四个数字是空闲时间的度量，因此“cpu”行上的第四个数字是自引导时间以来所有处理器的总空闲时间。这个时间以 Linux 的“jiffies”来衡量，每个时间是 1/100 秒。

但是您并不关心总空闲时间；您关心给定时间段内的空闲时间，例如最后一秒。计算一下，您需要读取此文件两次，相隔 1 秒。然后您可以对该行的第四个值进行比较。例如，如果您取样并获得：

```
cpu  2330047 0 2365006 1063853632 9035 9463 96114 0 
```

然后一秒钟后你得到这个样本：

```
cpu  2330047 0 2365007 1063854028 9035 9463 96114 0 
```

减去这两个数字，你会得到 396 的差异，这意味着你的 CPU 在最后 1.00 秒中空闲了 3.96 秒。当然，诀窍是您需要除以处理器的数量。3.96 / 4 = 0.99，还有你的空闲百分比；99% 空闲，1% 忙。

在我的代码中，我有一个包含 360 个条目的环形缓冲区，并且我每秒都会读取这个文件。这让我可以快速计算 1 秒、10 秒等的 CPU 利用率，一直到 1 小时。

对于特定于进程的信息，您必须查看**/proc/pid**；如果你不关心你的 pid，你可以查看 /proc/self.

您的进程使用的 CPU 在**/proc/self/stat**中可用。这是一个由一行组成的看起来很奇怪的文件；例如：

```
19340 (whatever) S 19115 19115 3084 34816 19115 4202752 118200 607 0 0 770 384 2
 7 20 0 77 0 266764385 692477952 105074 4294967295 134512640 146462952 321468364
8 3214683328 4294960144 0 2147221247 268439552 1276 4294967295 0 0 17 0 0 0 0 
```

这里的重要数据是第 13 个和第 14 个令牌（这里是 0 和 770）。第 13 个 token 是进程在用户态执行的 jiffies 数，第 14 个是进程在内核态执行的 jiffies 数。将两者相加，就得到了它的总 CPU 利用率。

同样，您必须定期对该文件进行采样，并计算差异，以确定进程随时间的 CPU 使用率。

**编辑：** 请记住，当您计算进程的 CPU 利用率时，您必须考虑 1）进程中的线程数，以及 2）系统中的处理器数。例如，如果您的单线程进程仅使用 25% 的 CPU，那可能是好是坏。在单处理器系统上很好，但在 4 处理器系统上不好；这意味着您的进程不断运行，并使用 100% 的可用 CPU 周期。

对于特定于进程的内存信息，您可以查看 /proc/self/status，如下所示：

```
Name:   whatever
State:  S (sleeping)
Tgid:   19340
Pid:    19340
PPid:   19115
TracerPid:      0
Uid:    0       0       0       0
Gid:    0       0       0       0
FDSize: 256
Groups: 0 1 2 3 4 6 10 11 20 26 27
VmPeak:   676252 kB
VmSize:   651352 kB
VmLck:         0 kB
VmHWM:    420300 kB
VmRSS:    420296 kB
VmData:   581028 kB
VmStk:       112 kB
VmExe:     11672 kB
VmLib:     76608 kB
VmPTE:      1244 kB
Threads:        77
SigQ:   0/36864
SigPnd: 0000000000000000
ShdPnd: 0000000000000000
SigBlk: fffffffe7ffbfeff
SigIgn: 0000000010001000
SigCgt: 20000001800004fc
CapInh: 0000000000000000
CapPrm: 00000000ffffffff
CapEff: 00000000fffffeff
Cpus_allowed:   0f
Mems_allowed:   1
voluntary_ctxt_switches:        6518
nonvoluntary_ctxt_switches:     6598 
```

以“Vm”开头的条目是有趣的：

*   **VmPeak**是进程使用的最大虚拟内存空间，以 kB（1024 字节）为单位。
*   **VmSize**是进程当前使用的虚拟内存空间，以 kB 为单位。在我的示例中，它非常大：651,352 kB，或大约 636 MB。
*   **VmRss**是已映射到进程地址空间的内存量，或它的驻留集大小。这要小得多（420,296 kB，或大约 410 兆字节）。区别：我的程序通过 mmap() 映射了 636 MB，但只访问了其中的 410 MB，因此只分配了 410 MB 的页面。

我不确定的唯一项目是**我的进程当前使用的交换空间**。我不知道这是否可用。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-12-19T07:11:35.720

**在 Windows 中，您可以通过以下代码获取 CPU 使用率：**

```
#include <windows.h>
#include <stdio.h>

//------------------------------------------------------------------------------------------------------------------
// Prototype(s)...
//------------------------------------------------------------------------------------------------------------------
CHAR cpuusage(void);

//-----------------------------------------------------
typedef BOOL ( __stdcall * pfnGetSystemTimes)( LPFILETIME lpIdleTime, LPFILETIME lpKernelTime, LPFILETIME lpUserTime );
static pfnGetSystemTimes s_pfnGetSystemTimes = NULL;

static HMODULE s_hKernel = NULL;
//-----------------------------------------------------
void GetSystemTimesAddress()
{
    if(s_hKernel == NULL)
    {
        s_hKernel = LoadLibrary(L"Kernel32.dll");
        if(s_hKernel != NULL)
        {
            s_pfnGetSystemTimes = (pfnGetSystemTimes)GetProcAddress(s_hKernel, "GetSystemTimes");
            if(s_pfnGetSystemTimes == NULL)
            {
                FreeLibrary(s_hKernel);
                s_hKernel = NULL;
            }
        }
    }
}
//----------------------------------------------------------------------------------------------------------------

//----------------------------------------------------------------------------------------------------------------
// cpuusage(void)
// ==============
// Return a CHAR value in the range 0 - 100 representing actual CPU usage in percent.
//----------------------------------------------------------------------------------------------------------------
CHAR cpuusage()
{
    FILETIME               ft_sys_idle;
    FILETIME               ft_sys_kernel;
    FILETIME               ft_sys_user;

    ULARGE_INTEGER         ul_sys_idle;
    ULARGE_INTEGER         ul_sys_kernel;
    ULARGE_INTEGER         ul_sys_user;

    static ULARGE_INTEGER     ul_sys_idle_old;
    static ULARGE_INTEGER  ul_sys_kernel_old;
    static ULARGE_INTEGER  ul_sys_user_old;

    CHAR usage = 0;

    // We cannot directly use GetSystemTimes in the C language
    /* Add this line :: pfnGetSystemTimes */
    s_pfnGetSystemTimes(&ft_sys_idle,    /* System idle time */
        &ft_sys_kernel,  /* system kernel time */
        &ft_sys_user);   /* System user time */

    CopyMemory(&ul_sys_idle  , &ft_sys_idle  , sizeof(FILETIME)); // Could been optimized away...
    CopyMemory(&ul_sys_kernel, &ft_sys_kernel, sizeof(FILETIME)); // Could been optimized away...
    CopyMemory(&ul_sys_user  , &ft_sys_user  , sizeof(FILETIME)); // Could been optimized away...

    usage  =
        (
        (
        (
        (
        (ul_sys_kernel.QuadPart - ul_sys_kernel_old.QuadPart)+
        (ul_sys_user.QuadPart   - ul_sys_user_old.QuadPart)
        )
        -
        (ul_sys_idle.QuadPart-ul_sys_idle_old.QuadPart)
        )
        *
        (100)
        )
        /
        (
        (ul_sys_kernel.QuadPart - ul_sys_kernel_old.QuadPart)+
        (ul_sys_user.QuadPart   - ul_sys_user_old.QuadPart)
        )
        );

    ul_sys_idle_old.QuadPart   = ul_sys_idle.QuadPart;
    ul_sys_user_old.QuadPart   = ul_sys_user.QuadPart;
    ul_sys_kernel_old.QuadPart = ul_sys_kernel.QuadPart;

    return usage;
}

//------------------------------------------------------------------------------------------------------------------
// Entry point
//------------------------------------------------------------------------------------------------------------------
int main(void)
{
    int n;
    GetSystemTimesAddress();
    for(n=0; n<20; n++)
    {
        printf("CPU Usage: %3d%%\r", cpuusage());
        Sleep(2000);
    }
    printf("\n");
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2015-07-16T21:14:28.910

# Linux

读取内存和加载数字的一种便携式方法是[`sysinfo`调用](http://man7.org/linux/man-pages/man2/sysinfo.2.html)

## 用法

```
 #include <sys/sysinfo.h>

   int sysinfo(struct sysinfo *info); 
```

## 描述

```
 Until Linux 2.3.16, sysinfo() used to return information in the
   following structure:

       struct sysinfo {
           long uptime;             /* Seconds since boot */
           unsigned long loads[3];  /* 1, 5, and 15 minute load averages */
           unsigned long totalram;  /* Total usable main memory size */
           unsigned long freeram;   /* Available memory size */
           unsigned long sharedram; /* Amount of shared memory */
           unsigned long bufferram; /* Memory used by buffers */
           unsigned long totalswap; /* Total swap space size */
           unsigned long freeswap;  /* swap space still available */
           unsigned short procs;    /* Number of current processes */
           char _f[22];             /* Pads structure to 64 bytes */
       };

   and the sizes were given in bytes.

   Since Linux 2.3.23 (i386), 2.3.48 (all architectures) the structure
   is:

       struct sysinfo {
           long uptime;             /* Seconds since boot */
           unsigned long loads[3];  /* 1, 5, and 15 minute load averages */
           unsigned long totalram;  /* Total usable main memory size */
           unsigned long freeram;   /* Available memory size */
           unsigned long sharedram; /* Amount of shared memory */
           unsigned long bufferram; /* Memory used by buffers */
           unsigned long totalswap; /* Total swap space size */
           unsigned long freeswap;  /* swap space still available */
           unsigned short procs;    /* Number of current processes */
           unsigned long totalhigh; /* Total high memory size */
           unsigned long freehigh;  /* Available high memory size */
           unsigned int mem_unit;   /* Memory unit size in bytes */
           char _f[20-2*sizeof(long)-sizeof(int)]; /* Padding to 64 bytes */
       };

   and the sizes are given as multiples of mem_unit bytes. 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-05-26T07:42:27.263

# QNX

由于这就像一个“代码维基页面”，我想从 QNX 知识库中添加一些代码（注意：这不是我的工作，但我检查了它，它在我的系统上运行良好）：

如何以 % 获得 CPU 使用率：[http ://www.qnx.com/support/knowledgebase.html?id=50130000000P9b5](http://www.qnx.com/support/knowledgebase.html?id=50130000000P9b5)

```
#include <atomic.h>
#include <libc.h>
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/iofunc.h>
#include <sys/neutrino.h>
#include <sys/resmgr.h>
#include <sys/syspage.h>
#include <unistd.h>
#include <inttypes.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/debug.h>
#include <sys/procfs.h>
#include <sys/syspage.h>
#include <sys/neutrino.h>
#include <sys/time.h>
#include <time.h>
#include <fcntl.h>
#include <devctl.h>
#include <errno.h>

#define MAX_CPUS 32

static float Loads[MAX_CPUS];
static _uint64 LastSutime[MAX_CPUS];
static _uint64 LastNsec[MAX_CPUS];
static int ProcFd = -1;
static int NumCpus = 0;

int find_ncpus(void) {
    return NumCpus;
}

int get_cpu(int cpu) {
    int ret;
    ret = (int)Loads[ cpu % MAX_CPUS ];
    ret = max(0,ret);
    ret = min(100,ret);
    return( ret );
}

static _uint64 nanoseconds( void ) {
    _uint64 sec, usec;
    struct timeval tval;
    gettimeofday( &tval, NULL );
    sec = tval.tv_sec;
    usec = tval.tv_usec;
    return( ( ( sec * 1000000 ) + usec ) * 1000 );
}

int sample_cpus( void ) {
    int i;
    debug_thread_t debug_data;
    _uint64 current_nsec, sutime_delta, time_delta;
    memset( &debug_data, 0, sizeof( debug_data ) );

    for( i=0; i<NumCpus; i++ ) {
        /* Get the sutime of the idle thread #i+1 */
        debug_data.tid = i + 1;
        devctl( ProcFd, DCMD_PROC_TIDSTATUS,
        &debug_data, sizeof( debug_data ), NULL );
        /* Get the current time */
        current_nsec = nanoseconds();
        /* Get the deltas between now and the last samples */
        sutime_delta = debug_data.sutime - LastSutime[i];
        time_delta = current_nsec - LastNsec[i];
        /* Figure out the load */
        Loads[i] = 100.0 - ( (float)( sutime_delta * 100 ) / (float)time_delta );
        /* Flat out strange rounding issues. */
        if( Loads[i] < 0 ) {
            Loads[i] = 0;
        }
        /* Keep these for reference in the next cycle */
        LastNsec[i] = current_nsec;
        LastSutime[i] = debug_data.sutime;
    }
    return EOK;
}

int init_cpu( void ) {
    int i;
    debug_thread_t debug_data;
    memset( &debug_data, 0, sizeof( debug_data ) );
/* Open a connection to proc to talk over.*/
    ProcFd = open( "/proc/1/as", O_RDONLY );
    if( ProcFd == -1 ) {
        fprintf( stderr, "pload: Unable to access procnto: %s\n",strerror( errno ) );
        fflush( stderr );
        return -1;
    }
    i = fcntl(ProcFd,F_GETFD);
    if(i != -1){
        i |= FD_CLOEXEC;
        if(fcntl(ProcFd,F_SETFD,i) != -1){
            /* Grab this value */
            NumCpus = _syspage_ptr->num_cpu;
            /* Get a starting point for the comparisons */
            for( i=0; i<NumCpus; i++ ) {
                /*
                * the sutime of idle thread is how much
                * time that thread has been using, we can compare this
                * against how much time has passed to get an idea of the
                * load on the system.
                */
                debug_data.tid = i + 1;
                devctl( ProcFd, DCMD_PROC_TIDSTATUS, &debug_data, sizeof( debug_data ), NULL );
                LastSutime[i] = debug_data.sutime;
                LastNsec[i] = nanoseconds();
            }
            return(EOK);
        }
    }
    close(ProcFd);
    return(-1);
}

void close_cpu(void){
    if(ProcFd != -1){
        close(ProcFd);
        ProcFd = -1;
    }
}

int main(int argc, char* argv[]){
    int i,j;
    init_cpu();
    printf("System has: %d CPUs\n", NumCpus);
    for(i=0; i<20; i++) {
        sample_cpus();
        for(j=0; j<NumCpus;j++)
        printf("CPU #%d: %f\n", j, Loads[j]);
        sleep(1);
    }
    close_cpu();
} 
```

如何获得免费（！）内存：[http ://www.qnx.com/support/knowledgebase.html?id=50130000000mlbx](http://www.qnx.com/support/knowledgebase.html?id=50130000000mlbx)

```
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>
#include <err.h>
#include <sys/stat.h>
#include <sys/types.h>

int main( int argc, char *argv[] ){
    struct stat statbuf;
    paddr_t freemem;
    stat( "/proc", &statbuf );
    freemem = (paddr_t)statbuf.st_size;
    printf( "Free memory: %d bytes\n", freemem );
    printf( "Free memory: %d KB\n", freemem / 1024 );
    printf( "Free memory: %d MB\n", freemem / ( 1024 * 1024 ) );
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-04-24T07:54:28.990

**Mac OS X - 中央处理器**

总体 CPU 使用率：

从*[在 Mac OS X 上检索系统信息](https://stackoverflow.com/questions/8736713/retrieve-system-information-on-macos-x)*：

```
#include <mach/mach_init.h>
#include <mach/mach_error.h>
#include <mach/mach_host.h>
#include <mach/vm_map.h>

static unsigned long long _previousTotalTicks = 0;
static unsigned long long _previousIdleTicks = 0;

// Returns 1.0f for "CPU fully pinned", 0.0f for "CPU idle", or somewhere in between
// You'll need to call this at regular intervals, since it measures the load between
// the previous call and the current one.
float GetCPULoad()
{
   host_cpu_load_info_data_t cpuinfo;
   mach_msg_type_number_t count = HOST_CPU_LOAD_INFO_COUNT;
   if (host_statistics(mach_host_self(), HOST_CPU_LOAD_INFO, (host_info_t)&cpuinfo, &count) == KERN_SUCCESS)
   {
      unsigned long long totalTicks = 0;
      for(int i=0; i<CPU_STATE_MAX; i++) totalTicks += cpuinfo.cpu_ticks[i];
      return CalculateCPULoad(cpuinfo.cpu_ticks[CPU_STATE_IDLE], totalTicks);
   }
   else return -1.0f;
}

float CalculateCPULoad(unsigned long long idleTicks, unsigned long long totalTicks)
{
  unsigned long long totalTicksSinceLastTime = totalTicks-_previousTotalTicks;
  unsigned long long idleTicksSinceLastTime  = idleTicks-_previousIdleTicks;
  float ret = 1.0f-((totalTicksSinceLastTime > 0) ? ((float)idleTicksSinceLastTime)/totalTicksSinceLastTime : 0);
  _previousTotalTicks = totalTicks;
  _previousIdleTicks  = idleTicks;
  return ret;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-21T11:07:04.963

### 对于 Linux

您还可以使用 /proc/self/statm 获取包含关键进程内存信息的单行数字，这比处理从 proc/self/status 获得的一长串报告信息要快

参见*[过程（5）](http://man7.org/linux/man-pages/man5/proc.5.html)*

```
/proc/[pid]/statm

    Provides information about memory usage, measured in pages.
    The columns are:

        size       (1) total program size
                   (same as VmSize in /proc/[pid]/status)
        resident   (2) resident set size
                   (same as VmRSS in /proc/[pid]/status)
        shared     (3) number of resident shared pages (i.e., backed by a file)
                   (same as RssFile+RssShmem in /proc/[pid]/status)
        text       (4) text (code)
        lib        (5) library (unused since Linux 2.6; always 0)
        data       (6) data + stack
        dt         (7) dirty pages (unused since Linux 2.6; always 0) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-12T22:51:52.897

在 Linux 上，您不能/不应该使用 SysInfo 的 freeram 或通过对 totalram 进行一些算术来获得“总可用物理内存”。

推荐的方法是阅读 proc/meminfo，引用*[kernel/git/torvalds/linux.git，*/proc/meminfo：提供估计的可用内存*](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=34e431b0ae398fc54ea69ff85ec700722c9da773)*：

> 许多负载平衡和工作负载放置程序检查 /proc/meminfo 以估计有多少可用内存。他们通常通过将“免费”和“缓存”相加来做到这一点，十年前这很好，但今天几乎可以保证是错误的。

> 在 /proc/meminfo 中提供这样的估计会更方便。如果将来事情发生变化，我们只需在一个地方进行更改。

一种方法是*[Adam Rosenfield 对*How do you determine the amount of Linux system RAM in C++?*](https://stackoverflow.com/questions/349889/how-do-you-determine-the-amount-of-linux-system-ram-in-c/350039#350039)* 建议：读取文件，并使用 fscanf 抓取该行（但不要使用 MemTotal，而是使用 MemAvailable）

同样，如果您想获得使用的物理内存总量，具体取决于“使用”的含义，您可能不想从 totalram 中减去 freeram，而是从 memtotal 中减去 memavailable 以获得 top 或 htop 告诉您的内容。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-10-26T17:22:43.830

我在我的 C++ 项目中使用了以下代码，它运行良好：

```
static HANDLE self;
static int numProcessors;
SYSTEM_INFO sysInfo;

double percent;

numProcessors = sysInfo.dwNumberOfProcessors;

//Getting system times information
FILETIME SysidleTime;
FILETIME SyskernelTime; 
FILETIME SysuserTime; 
ULARGE_INTEGER SyskernelTimeInt, SysuserTimeInt;
GetSystemTimes(&SysidleTime, &SyskernelTime, &SysuserTime);
memcpy(&SyskernelTimeInt, &SyskernelTime, sizeof(FILETIME));
memcpy(&SysuserTimeInt, &SysuserTime, sizeof(FILETIME));
__int64 denomenator = SysuserTimeInt.QuadPart + SyskernelTimeInt.QuadPart;  

//Getting process times information
FILETIME ProccreationTime, ProcexitTime, ProcKernelTime, ProcUserTime;
ULARGE_INTEGER ProccreationTimeInt, ProcexitTimeInt, ProcKernelTimeInt, ProcUserTimeInt;
GetProcessTimes(self, &ProccreationTime, &ProcexitTime, &ProcKernelTime, &ProcUserTime);
memcpy(&ProcKernelTimeInt, &ProcKernelTime, sizeof(FILETIME));
memcpy(&ProcUserTimeInt, &ProcUserTime, sizeof(FILETIME));
__int64 numerator = ProcUserTimeInt.QuadPart + ProcKernelTimeInt.QuadPart;
//QuadPart represents a 64-bit signed integer (ULARGE_INTEGER)

percent = 100*(numerator/denomenator); 
```

# javascript - 使用 e4x 在 Flex 中编辑 XML

> ID：63181
> 
> 赞同：1
> 
> 时间：2008-09-15T14:05:47.080
> 
> 标签：javascript, apache-flex, e4x

在 Flex 中，我有一个 xml 文档，如下所示：

```
var xml:XML = <root><node>value1</node><node>value2</node><node>value3</node></root> 
```

在运行时，我想为根下的每个节点创建一个 TextInput 控件，并将值绑定到 XML 中的值。据我所知，我不能在运行时使用 BindingUtils 绑定到 e4x 节点（如果我在这里错了，请告诉我！），所以我正在尝试手动执行此操作：

```
for each (var node:XML in xml.node)
{
    var textInput:TextInput = new TextInput();
    var handler:Function = function(event:Event):void 
    {
        node.setChildren(event.target.text);
    };
    textInput.text = node.text();
    textInput.addEventListener(Event.CHANGE, handler);
    this.addChild(pileHeightEditor);
} 
```

我的问题是，当用户编辑其中一个 TextInputs 时，分配给的节点始终是 for 循环中遇到的最后一个节点。我习惯了 C# 中的这种模式，每次创建匿名函数时，都会获取所用值的值的“快照”，因此每个处理函数中的“节点”会有所不同。

如何“拍摄快照”节点的当前值以在处理程序中使用？或者我应该在 Flex 中使用不同的模式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T14:25:25.223

不幸的是，函数闭包在 Actionscript 中的工作很奇怪/很差。变量只有在超出范围时才会获得“快照”。不幸的是，变量是函数范围的，而不是块范围的。所以它最终不会像你想要的那样工作。

您可以创建一个字典以从*TextInput -> node*映射，或者您可以将节点存储在`TextInput's`data 属性中。

我希望您所描述的内容确实可以正常工作，因为这是一种简单/强大的表达方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T16:24:07.510

闭包只捕获对变量的*引用*，而不是它的当前值。由于局部变量是函数范围的（不是块范围的），因此循环中的每次迭代都会创建一个闭包，该闭包捕获对同一变量的引用。

您可以将 TextInput 创建代码提取到一个单独的函数中，这将为您提供一个单独的变量实例来捕获闭包。像这样的东西：

```
for each (var node:XML in xml.node)
{
    var textInput:TextInput = createTextInput(node);
    this.addChild(pileHeightEditor);
}
... 

private function createTextInput(node:XML) : TextInput {
    var textInput:TextInput = new TextInput();
    var handler:Function = function(event:Event):void 
    {
        node.setChildren(event.target.text);
    };
    textInput.text = node.text();
    textInput.addEventListener(Event.CHANGE, handler);
    return textInput;
} 
```

# java - 从 Java 应用程序安装程序查找 Mac OS X 上所有可用的 JRE

> ID：63206
> 
> 赞同：4
> 
> 时间：2008-09-15T14:08:20.880
> 
> 标签：java, macos, installation

如果 Java 应用程序需要特定的 JRE 版本，那么我如何在安装过程中检查它在 Mac OS X 上的可用性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T14:10:24.090

它应该像查看 /System/Library/Frameworks/JavaVM.framework/Versions/ 一样简单

例如从我的机器：

```
manoa:~ stu$ ll /System/Library/Frameworks/JavaVM.framework/Versions/
total 56
774077 lrwxr-xr-x  1 root  wheel    5 Jul 23 15:31 1.3 -> 1.3.1
167151 drwxr-xr-x  3 root  wheel  102 Jan 14  2008 1.3.1
167793 lrwxr-xr-x  1 root  wheel    5 Feb 21  2008 1.4 -> 1.4.2
774079 lrwxr-xr-x  1 root  wheel    3 Jul 23 15:31 1.4.1 -> 1.4
166913 drwxr-xr-x  8 root  wheel  272 Feb 21  2008 1.4.2
168494 lrwxr-xr-x  1 root  wheel    5 Feb 21  2008 1.5 -> 1.5.0
166930 drwxr-xr-x  8 root  wheel  272 Feb 21  2008 1.5.0
774585 lrwxr-xr-x  1 root  wheel    5 Jul 23 15:31 1.6 -> 1.6.0
747415 drwxr-xr-x  8 root  wheel  272 Jul 23 10:24 1.6.0
167155 drwxr-xr-x  8 root  wheel  272 Jul 23 15:31 A
776765 lrwxr-xr-x  1 root  wheel    1 Jul 23 15:31 Current -> A
774125 lrwxr-xr-x  1 root  wheel    3 Jul 23 15:31 CurrentJDK -> 1.5
manoa:~ stu$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T14:11:14.647

这篇文章可能会有所帮助： http: [//developer.apple.com/technotes/tn2002/tn2110.html](http://developer.apple.com/technotes/tn2002/tn2110.html)
总结：

```
String javaVersion = System.getProperty("java.version");
if (javaVersion.startsWith("1.4")) {
  // New features for 1.4
} 
```

# apache-flex - 如何让 Google 等搜索引擎可以访问 Flex RIA 内容？

> ID：63232
> 
> 赞同：3
> 
> 时间：2008-09-15T14:10:47.737
> 
> 标签：apache-flex, ria, google-search, googlebot

您将如何使 Google 可以访问 Flex RIA 应用程序的内容，以便 Google 可以索引内容并显示指向您的 Flex RIA 中正确项目的链接。考虑一个在 Flex 中创建的在线商店，其中提供的商品应由 Google 编制索引。然后 Google 上的链接应该会在 RIA 中打开相应的产品。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T15:43:58.373

目前，使 RIA 可被搜索引擎索引的最佳技术称为[渐进增强](http://en.wikipedia.org/wiki/Progressive_enhancement)（或优雅降级，取决于您如何看待它）。基本上，您使用与应用程序加载相同的数据创建应用程序的简单 HTML 版本。这个版本应该是由某种后端服务器技术动态生成的。该 HTML 版本可以被 Google 索引，但每个页面还包含一个检查，以确定访问者是否能够查看丰富版本，如果可以，则将 HTML 内容替换为 Flash、Flex 或 Silverlight 应用程序，最好以这种方式应用程序以显示与当前页面相同数据的状态启动。“替换”可能意味着它只是将应用程序嵌入到 HTML 内容之上，或者它将用户重定向到嵌入它的页面。前一种解决方案更可取，.

保持商店的 HTML 和 RIA 版本同步的一种方法是确定 URL 方案并确保 RIA 使用某种深度链接技术。如果访问者通过搜索引擎到达特定项目，则说`/items/345`RIA中对应的伪URL应该相同，这样您就可以将RIA嵌入页面顶部并将该URL设置为参数以制作RIA加载后立即显示相同的页面。

今年夏天，谷歌和雅虎！宣布他们将开始使用自定义版本的 Flash Player 来索引基于 Flash 的应用程序，“以与人相同的方式”探索它们。现在，两个月后，仍然没有证据表明这确实发生了。[Ryan Stweart 不得不取消他的 Flex SEO 比赛](http://blog.digitalbackcountry.com/?p=1617)，因为很明显没有人能赢。问题似乎是该事件，尽管该技术可能非常有效（尽管我持怀疑态度），但自定义 Flash Player 需要某种网络接口才能加载任何引用的资源，如 XML 数据、其他 SWF 等。 ，而[这目前没有由谷歌实现](http://blog.iconara.net/2008/07/27/why-google-isnt-indexing-dynamic-content-yet/). 这意味着对于动态加载所有数据的应用程序，比如我能想到的所有数据，Googlebot 实际上不会看到任何相关的内容。雅虎！完全忽略基于 SWF 的内容。

[哦，碰巧我在 Flex 节目的最新一集中](http://www.theflexshow.com/blog/index.cfm/2008/9/10/The-Flex-Show-Episode-54)谈到了 Flex 和 SEO =)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T14:15:58.740

这里有一个巨大的线程：

[http://tech.groups.yahoo.com/group/flexcoders/message/58926](http://tech.groups.yahoo.com/group/flexcoders/message/58926)

但本质上，谷歌已经为 .SWF 文件编制了索引（您可以通过将搜索结果限制为仅 .SWF 文件来自行测试）。它可以搜索 SWF 文件中的任何文本内容。

但是，如果您网站中的文本信息来自数据库/网络服务器。然后它将无法轻松访问此信息。

实现此功能的一个示例是使用 XML 文件作为索引页面，然后使用 XSLT 转换使用 Flex 呈现它。“Ted On Flex”对此有很好的信息。

[http://flex.org/consultants](http://flex.org/consultants)

# language-agnostic - 生成的代码是否需要人类可读？

> ID：63257
> 
> 赞同：6
> 
> 时间：2008-09-15T14:13:33.003
> 
> 标签：language-agnostic, code-generation, readability

我正在开发一个工具，该工具将为一个接口和几个实现该接口的类生成源代码。我的输出并不是特别复杂，所以让输出符合我们正常的代码格式标准并不难。

但这让我开始思考：自动生成的代码需要如何具有人类可读性？什么时候应该花费额外的精力来确保生成的代码易于阅读和理解？

就我而言，我生成的类本质上只是一些与构建的另一部分相关的数据的容器，其中包含获取数据的方法。没有人需要查看类本身的代码，他们只需要调用类提供的各种 getter。因此，代码是否“干净”、格式正确且易于人类阅读可能并不重要。

但是，如果您生成的代码中包含大量简单逻辑，会发生什么情况？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-15T14:15:53.590

我认为生成的代码具有可读性并遵循正常的编码风格同样重要。在某些时候，有人要么需要调试代码，要么查看“幕后”发生的事情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-15T14:35:10.580

是的，一点没错！; 我什至可以给你讲一个故事来解释为什么人类可以轻松阅读自动生成的代码很重要......

我曾经有机会从事一个新项目。现在，当您开始编写代码时，您需要做的第一件事就是创建某种与数据库之间的连接和数据表示。但是，我们不是仅仅手工编写这段代码，而是有人开发了自己的代码生成器来自动从数据库模式构建基类。*真的很简洁，编写所有这些代码的繁琐工作现在已经脱离了我们的掌控......唯一的问题是，生成的代码对于普通人*来说远非可读。

当然，我们并没有这样做，因为嘿，它只是为我们节省了很多工作。但是过了一段时间，事情开始出错了，从用户输入中错误地读取了数据（或者我们认为），数据库内部发生了损坏，而我们*只能*读取。奇怪..因为阅读不会改变任何数据（再次，我们认为）......

像任何优秀的开发人员一样，我们开始质疑我们自己的代码，但经过几天的搜索......即使重写代码，我们也找不到任何东西......然后我们恍然大悟，自动生成的代码被破坏了！

所以现在一个更大的任务等待着我们，检查自动生成的代码，没有理智的人可以在合理的时间内理解......我说的是非缩进，非常糟糕的风格代码，带有不可发音的变量和函数名称......它事实证明，自己重写代码甚至会更快，而不是试图弄清楚代码是如何工作的。

最终，编写代码生成器的开发人员稍后对其进行了重新制作，因此它现在可以生成*可读*的代码，以防像以前一样出现问题。

这是[我刚刚找到](http://www.pragmaticprogrammer.com/the-pragmatic-programmer/extracts/wizards)的有关当前主题的链接；我实际上是在寻找[“实用程序员”一书中](http://www.pragprog.com/the-pragmatic-programmer)的其中一章的链接，以指出我们首先查看代码的原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T14:17:15.087

我认为这取决于如何使用生成的代码。如果代码不是供人类阅读的，即每当发生变化时它就会重新生成，我认为它不必是可读的。但是，如果您将代码生成用作“正常”编程的中间步骤，则生成的代码应该与源代码的其余部分具有相同的可读性。

事实上，使生成的代码“不可读”可能是一个优势，因为它会阻止人们“破解”生成的代码，而是在代码生成器中实现他们的更改——这在您需要重新生成代码时非常有用无论出于何种原因，不要丢失您的同事所做的更改，因为他认为生成的代码已“完成”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T14:21:18.650

是的，它确实。首先，您可能需要对其进行调试——您将自己轻松搞定。其次，它应该遵守您在商店中使用的任何编码约定，因为有一天代码可能需要手动更改，从而成为人工代码。当您的代码生成工具没有涵盖您需要的特定事物并且认为不值得为此目的修改该工具时，通常会出现这种情况。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T14:25:16.003

查找[主动代码生成](http://www.c2.com/cgi/wiki?ActiveCodeGeneration)与[被动代码生成](http://www.c2.com/cgi/wiki?PassiveCodeGeneration)。关于被动代码生成，**绝对是的，总是。**关于主动代码生成，*当*代码达到透明的目标时，它的行为与文档化的 API 完全一样，那么不会。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T14:18:46.067

我会说代码必须是人类可读的，除非您的代码生成工具有一个出色的调试器，否则您（或不幸的同事）可能会在代码的一个腰部深处试图跟踪那个如此难以捉摸的错误在系统中。我自己对“来自 UML 的代码”的探索在我的嘴里留下了苦涩的味道，因为我无法掌握所谓的“花哨”调试过程。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T14:19:41.913

*如果您必须调试自己生成的代码，您将自杀。* 不要开始认为你不会。 **请记住，当您信任您的代码来生成代码时，您已经在系统中引入了两个错误 - 您已经插入了两次自己。**

绝对没有理由不让它成为人类可解析的，那么你为什么要这样做呢？

-亚当

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T14:23:57.253

生成代码的全部意义在于做一些更容易用某种高级语言定义的“复杂”。由于它是生成的，因此对生成的代码的实际维护应该在生成代码的子程序中，而不是在生成的代码中。

因此，人类可读性应该具有较低的优先级；诸如运行时速度或功能之类的事情要重要得多。当您查看诸如 bison 和 flex 之类的工具时尤其如此，它们使用生成的代码预先生成快速查找表来进行模式匹配，而手动维护这简直是疯狂的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T14:59:38.290

没有提到的问题的另一个方面是生成的代码也应该是“版本控制友好的”（只要可行）。

我发现多次检查生成代码与源代码中的差异很有用。

这样，您甚至可以偶尔在生成代码的工具中发现错误。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T14:17:08.423

将来有人很可能会想通过并查看您的代码的作用。所以让它有点理解是一件好事。

您可能还希望在每个生成的文件的顶部包含一个注释，说明该文件的生成方式和原因以及它的目的是什么。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T14:17:26.520

通常，如果您要生成稍后需要人工修改的代码，则它需要尽可能地具有人类可读性。然而，即使它的代码将被生成并且再也不会被触及，它仍然需要足够的可读性，以便您（作为编写代码生成器的开发人员）可以调试生成器 - 如果您的生成器吐出错误的代码，这可能很难如果难以理解，请追查。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T14:18:43.350

我认为花费额外的时间使其易于阅读以使其更易于调试是值得的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T14:19:04.880

生成的代码应该是可读的，（格式等通常可以由一个半体面的 IDE 处理）。在代码生命周期的某个阶段，有人会查看它，他们会想要理解它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-15T14:19:08.047

我认为对于工作方式非常简单的数据容器或对象，人类可读性并不是很重要。

但是，一旦开发人员可能不得不阅读代码以了解某些事情是如何发生的，它就需要是可读的。如果逻辑有错误怎么办？如果没有人能够阅读和理解代码，怎么会有人发现它？我会为更复杂的逻辑部分生成注释，以表达意图，因此更容易确定是否真的存在错误。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-15T14:19:28.870

逻辑应该总是可读的。如果其他人要阅读代码，试着把自己放在他们的位置上，看看你是否能在不阅读特定代码的情况下完全理解高（和低？）级别的代码。

我不会花太多时间在永远不会被阅读的代码上，但如果不是太多时间，我会浏览生成的代码。如果不是，至少发表评论以弥补可读性的损失。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-15T14:19:45.360

如果此代码可能会被调试，那么您应该认真考虑以人类可读的格式生成它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-15T14:21:51.923

有不同类型的生成代码，但最简单的类型是：

1.  生成的代码不打算被开发人员看到。例如，定义布局的 xml-ish 代码（想想 .frm 文件，或 SSIS 生成的可怕文件）
2.  生成的代码旨在成为稍后将由您的开发人员定制的类的基础，例如，生成代码以减少打字乏味

如果你正在做后者，你*肯定*希望你的代码是人类可读的。

类和接口，无论您认为对开发人员应该多么“禁区”，几乎肯定会属于生成的代码类型 2。调试器会在某个时刻碰到它们——应用代码格式是最少的当编译器命中那些生成的类时，您可以简化调试过程

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-15T14:24:58.093

就像这里的几乎所有其他人一样，我说让它可读。在您的生成过程中无需花费任何额外费用，您（或您的继任者）在他们挖掘时会很感激。

对于真实世界的示例 - 查看 Visual Studio 生成的任何内容。格式很好，有评论和一切。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-15T14:26:11.913

生成的代码就是代码，任何代码都没有理由不可读且格式良好。这很便宜，尤其是在生成的代码中：您不需要自己应用格式，生成器每次都会为您完成！:)

作为一个次要选项，以防你真的那么懒惰，如何在将代码写入磁盘之前通过你选择的美化实用程序管道代码以确保至少某种程度的一致性。尽管如此，我所认识的几乎所有优秀的程序员都对他们的代码进行了迂腐的格式化，这是有充分理由的：没有只写代码。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-15T14:32:19.963

绝对是的，因为上面已经说过很多很好的理由。还有一个问题是，如果您的代码需要由评估员检查（出于安全性和可靠性问题），如果代码是人工可重新编写的，那就更好了。否则，评估员将拒绝对其进行评估，并且您的项目将被当局重新审核。唯一的解决方案是评估......代码生成器（这通常要困难得多；））

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-15T15:05:49.477

这取决于代码是只能由编译器读取还是由人类读取。此外，代码是否应该超快或可读性是否重要也很重要。如有疑问，请付出额外的努力来生成可读的代码。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-15T15:16:16.940

我认为答案是：视情况而定。

*这取决于您是否需要将生成的代码配置和存储为人工制品。例如，人们很少保留或配置从 c 编译器输出的目标代码，因为他们知道每次都可以从源代码复制它。我认为这里可能有类似的类比。*这取决于您是否需要根据某些标准对代码进行认证，例如 Misra-C 或 DO178。*这取决于每次编译代码时是否会通过您的工具生成源代码，或者是否将其存储以供以后包含在构建中。

就个人而言，如果您只想构建代码，将其编译成可执行文件，然后将中间代码扔掉，那么我看不出让它太漂亮有什么意义。

# sql-server - 仅选择具有 NULL 值的列

> ID：63291
> 
> 赞同：58
> 
> 时间：2008-09-15T14:16:41.390
> 
> 标签：sql-server

如何选择表中仅包含所有行的 NULL 值的所有列？我正在使用**MS SQL Server 2005**。我试图找出表中未使用哪些列，以便删除它们。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-09-15T15:10:20.293

这是 sql 2005 或更高版本：将 ADDR_Address 替换为您的表名。

```
declare @col varchar(255), @cmd varchar(max)

DECLARE getinfo cursor for
SELECT c.name FROM sys.tables t JOIN sys.columns c ON t.Object_ID = c.Object_ID
WHERE t.Name = 'ADDR_Address'

OPEN getinfo

FETCH NEXT FROM getinfo into @col

WHILE @@FETCH_STATUS = 0
BEGIN
    SELECT @cmd = 'IF NOT EXISTS (SELECT top 1 * FROM ADDR_Address WHERE [' + @col + '] IS NOT NULL) BEGIN print ''' + @col + ''' end'
    EXEC(@cmd)

    FETCH NEXT FROM getinfo into @col
END

CLOSE getinfo
DEALLOCATE getinfo 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-15T14:18:09.530

```
SELECT cols
FROM table
WHERE cols IS NULL 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-15T14:56:21.123

这应该为您提供表“Person”中只有 NULL 值的所有列的列表。您将获得多个结果集的结果，这些结果集要么为空，要么包含单个列的名称。您需要在两个地方替换“Person”才能将其与另一个表一起使用。

```
DECLARE crs CURSOR LOCAL FAST_FORWARD FOR SELECT name FROM syscolumns WHERE id=OBJECT_ID('Person')
OPEN crs
DECLARE @name sysname
FETCH NEXT FROM crs INTO @name
WHILE @@FETCH_STATUS = 0
BEGIN
    EXEC('SELECT ''' + @name + ''' WHERE NOT EXISTS (SELECT * FROM Person WHERE ' + @name + ' IS NOT NULL)')
    FETCH NEXT FROM crs INTO @name
END
CLOSE crs
DEALLOCATE crs 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-07-10T19:56:29.010

这是 Bryan 2008 年及以后的查询的更新版本。它使用 INFORMATION_SCHEMA.COLUMNS，为表模式和表名添加变量。列数据类型已添加到输出中。在查找特定数据类型的列时，包括列数据类型会有所帮助。我没有添加列宽或任何东西。

对于输出，使用了 RAISERROR ... WITH NOWAIT，因此文本将立即显示，而不是像 PRINT 那样在最后一次全部显示（大部分情况下）。

```
SET NOCOUNT ON;

DECLARE
 @ColumnName sysname
,@DataType nvarchar(128)
,@cmd nvarchar(max)
,@TableSchema nvarchar(128) = 'dbo'
,@TableName sysname = 'TableName';

DECLARE getinfo CURSOR FOR
SELECT
     c.COLUMN_NAME
    ,c.DATA_TYPE
FROM
    INFORMATION_SCHEMA.COLUMNS AS c
WHERE
    c.TABLE_SCHEMA = @TableSchema
    AND c.TABLE_NAME = @TableName;

OPEN getinfo;

FETCH NEXT FROM getinfo INTO @ColumnName, @DataType;

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @cmd = N'IF NOT EXISTS (SELECT * FROM ' + @TableSchema + N'.' + @TableName + N' WHERE [' + @ColumnName + N'] IS NOT NULL) RAISERROR(''' + @ColumnName + N' (' + @DataType + N')'', 0, 0) WITH NOWAIT;';
    EXECUTE (@cmd);

    FETCH NEXT FROM getinfo INTO @ColumnName, @DataType;
END;

CLOSE getinfo;
DEALLOCATE getinfo; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-15T14:29:49.313

或者您是否只想查看一列是否只有 NULL 值（因此可能未使用）？

进一步澄清这个问题可能会有所帮助。

**编辑：** 好的..这里有一些非常粗略的代码可以让你继续......

```
SET NOCOUNT ON
DECLARE @TableName Varchar(100)
SET @TableName='YourTableName'
CREATE TABLE #NullColumns (ColumnName Varchar(100), OnlyNulls BIT)
INSERT INTO #NullColumns (ColumnName, OnlyNulls) SELECT c.name, 0 FROM syscolumns c INNER JOIN sysobjects o ON c.id = o.id AND o.name = @TableName AND o.xtype = 'U'
DECLARE @DynamicSQL AS Nvarchar(2000)
DECLARE @ColumnName Varchar(100)
DECLARE @RC INT
    SELECT TOP 1 @ColumnName = ColumnName FROM #NullColumns WHERE OnlyNulls=0
    WHILE @@ROWCOUNT > 0
    BEGIN
        SET @RC=0
        SET @DynamicSQL = 'SELECT TOP 1 1 As HasNonNulls FROM ' + @TableName + ' (nolock) WHERE ''' + @ColumnName + ''' IS NOT NULL'
        EXEC sp_executesql @DynamicSQL
        set @RC=@@rowcount
        IF @RC=1
        BEGIN
            SET @DynamicSQL = 'UPDATE #NullColumns SET OnlyNulls=1 WHERE ColumnName=''' + @ColumnName + ''''
            EXEC sp_executesql @DynamicSQL
        END
        ELSE
        BEGIN
            SET @DynamicSQL = 'DELETE FROM #NullColumns WHERE ColumnName=''' + @ColumnName+ ''''
            EXEC sp_executesql @DynamicSQL
        END
    SELECT TOP 1 @ColumnName = ColumnName FROM #NullColumns WHERE OnlyNulls=0
    END

SELECT * FROM #NullColumns

DROP TABLE #NullColumns
SET NOCOUNT OFF 
```

是的，有更简单的方法，但我现在要开会。祝你好运！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-15T14:46:35.093

你可以做：

```
select 
  count(<columnName>)
from
  <tableName> 
```

如果计数返回 0，则表示该列中的所有行均为 NULL（或表中根本没有行）

可以改为

```
select 
    case(count(<columnName>)) when 0 then 'Nulls Only' else 'Some Values' end
from 
    <tableName> 
```

如果你想自动化它，你可以使用系统表来迭代你感兴趣的表中的列名

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T15:19:18.103

如果您需要列出所有列值所在的所有行`NULL`，那么我会使用该`COLLATE`函数。这需要一个值列表并返回第一个非空值。如果您将所有列名添加到列表中，然后使用`IS NULL`，您应该得到所有仅包含空值的行。

```
SELECT * FROM MyTable WHERE COLLATE(Col1, Col2, Col3, Col4......) IS NULL 
```

您实际上不应该有任何带有 ALL`columns`空值的表，因为这意味着您没有`primary key`(not allowed to be `null`)。没有主键是要避免的；这打破了第一范式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-05-14T18:33:36.463

试试这个 -

```
DECLARE @table VARCHAR(100) = 'dbo.table'

DECLARE @sql NVARCHAR(MAX) = ''

SELECT @sql = @sql + 'IF NOT EXISTS(SELECT 1 FROM ' + @table + ' WHERE ' + c.name + ' IS NOT NULL) PRINT ''' + c.name + ''''
FROM sys.objects o
JOIN sys.columns c ON o.[object_id] = c.[object_id]
WHERE o.[type] = 'U'
    AND o.[object_id] = OBJECT_ID(@table)
    AND c.is_nullable = 1

EXEC(@sql) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-06T14:17:01.247

实际上不确定 2005 年，但 2008 年吃了它：

```
USE [DATABASE_NAME] -- !
GO

DECLARE @SQL NVARCHAR(MAX)
DECLARE @TableName VARCHAR(255)

SET @TableName = 'TABLE_NAME'   -- !

SELECT @SQL = 
(
    SELECT 
        CHAR(10)
        +'DELETE FROM ['+t1.TABLE_CATALOG+'].['+t1.TABLE_SCHEMA+'].['+t1.TABLE_NAME+'] WHERE '
        +(
            SELECT  
            CASE t2.ORDINAL_POSITION 
                WHEN (SELECT MIN(t3.ORDINAL_POSITION) FROM INFORMATION_SCHEMA.COLUMNS t3 WHERE t3.TABLE_NAME=t2.TABLE_NAME) THEN ''
                ELSE  'AND '
            END
            +'['+COLUMN_NAME+'] IS NULL' AS 'data()'
            FROM INFORMATION_SCHEMA.COLUMNS t2 WHERE t2.TABLE_NAME=t1.TABLE_NAME FOR XML PATH('')
         )  AS 'data()'
    FROM INFORMATION_SCHEMA.TABLES t1 WHERE t1.TABLE_NAME = @TableName FOR XML PATH('')
)

SELECT @SQL -- EXEC(@SQL) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-09-09T06:48:22.380

在这里，我为任何类型的 SQL 表创建了一个脚本。请复制此存储过程并在您的环境中创建它并使用您的表运行此存储过程。

```
exec [dbo].[SP_RemoveNullValues] 'Your_Table_Name' 
```

存储过程

```
GO
/****** Object:  StoredProcedure [dbo].[SP_RemoveNullValues]    Script Date: 09/09/2019 11:26:53 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- akila liyanaarachchi
Create procedure [dbo].[SP_RemoveNullValues](@PTableName Varchar(50) ) as 
begin

DECLARE Cussor CURSOR FOR 
SELECT COLUMN_NAME,TABLE_NAME,DATA_TYPE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = @PTableName  

OPEN Cussor;

Declare @ColumnName Varchar(50)
Declare @TableName  Varchar(50)
Declare @DataType Varchar(50)
Declare @Flage  int 

FETCH NEXT FROM Cussor INTO @ColumnName,@TableName,@DataType
WHILE @@FETCH_STATUS = 0
BEGIN

set @Flage=0

If(@DataType in('bigint','numeric','bit','smallint','decimal','smallmoney','int','tinyint','money','float','real'))
begin
set @Flage=1
end 
If(@DataType in('date','atetimeoffset','datetime2','smalldatetime','datetime','time'))
begin
set @Flage=2
end 
If(@DataType in('char','varchar','text','nchar','nvarchar','ntext'))
begin
set @Flage=3
end 

If(@DataType in('binary','varbinary'))
begin
set @Flage=4
end 

DECLARE @SQL VARCHAR(MAX) 

if  (@Flage in(1,4))
begin 

SET @SQL ='  update ['+@TableName+'] set ['+@ColumnName+']=0 where ['+@ColumnName+'] is null'
end 

if  (@Flage =3)
begin 

SET @SQL ='  update ['+@TableName+'] set ['+@ColumnName+'] = '''' where ['+@ColumnName+'] is null '
end 

if  (@Flage =2)
begin 

SET @SQL ='  update ['+@TableName+'] set ['+@ColumnName+'] ='+'''1901-01-01 00:00:00.000'''+' where ['+@ColumnName+'] is null '
end 

EXEC(@SQL)

FETCH NEXT FROM Cussor INTO @ColumnName,@TableName,@DataType
END

CLOSE Cussor
DEALLOCATE Cussor

END 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T14:32:06.110

您必须遍历这组列并检查每一列。您应该能够使用 DESCRIBE table 命令获取所有列的列表。

伪代码：

```
 foreach $column ($cols) {
   query("SELECT count(*) FROM table WHERE $column IS NOT NULL")
   if($result is zero)  {
      # $column contains only null values"
      push @onlyNullColumns, $column;
   } else {
      # $column contains non-null values
   }
}
return @onlyNullColumns; 
```

我知道这似乎有点违反直觉，但 SQL 没有提供选择列的本机方法，只有行。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T14:47:56.900

我还建议搜索所有具有相同值的字段，而不仅仅是 NULL。

也就是说，对于每个表中的每一列执行查询：

```
SELECT COUNT(DISTINCT field) FROM tableName 
```

并专注于结果返回 1 的那些。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-10T20:21:37.267

```
SELECT  t.column_name
FROM    user_tab_columns t
WHERE   t.nullable = 'Y' AND t.table_name = 'table name here' AND t.num_distinct = 0; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-05-05T13:40:57.037

'user2466387' 版本的更新版本，额外的小测试可以提高性能，因为测试不可为空的列是没有用的：

```
AND IS_NULLABLE = 'YES' 
```

完整代码：

```
SET NOCOUNT ON;

DECLARE
 @ColumnName sysname
,@DataType nvarchar(128)
,@cmd nvarchar(max)
,@TableSchema nvarchar(128) = 'dbo'
,@TableName sysname = 'TableName';

DECLARE getinfo CURSOR FOR
SELECT
     c.COLUMN_NAME
    ,c.DATA_TYPE
FROM
    INFORMATION_SCHEMA.COLUMNS AS c
WHERE
    c.TABLE_SCHEMA = @TableSchema
    AND c.TABLE_NAME = @TableName
    AND IS_NULLABLE = 'YES';

OPEN getinfo;

FETCH NEXT FROM getinfo INTO @ColumnName, @DataType;

WHILE @@FETCH_STATUS = 0
BEGIN
    SET @cmd = N'IF NOT EXISTS (SELECT * FROM ' + @TableSchema + N'.' + @TableName + N' WHERE [' + @ColumnName + N'] IS NOT NULL) RAISERROR(''' + @ColumnName + N' (' + @DataType + N')'', 0, 0) WITH NOWAIT;';
    EXECUTE (@cmd);

    FETCH NEXT FROM getinfo INTO @ColumnName, @DataType;
END;

CLOSE getinfo;
DEALLOCATE getinfo; 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2008-09-15T14:24:16.893

你可能需要澄清一下。你真正想要完成什么？如果你真的想找出只包含空值的列名，那么你将不得不遍历架构并基于它进行动态查询。

我不知道您使用的是哪个 DBMS，所以我将在此处放置一些伪代码。

```
for each col
begin
  @cmd = 'if not exists (select * from tablename where ' + col + ' is not null begin print ' + col + ' end'
exec(@cmd)
end 
```

# redirect - 如何让 sun 网络服务器从

> ID：63295
> 
> 赞同：2
> 
> 时间：2008-09-15T14:16:54.947
> 
> 标签：redirect, webserver, sunone

我有 Sun webserver iws6 (iplanet 6) 代理我的 bea 集群。我的集群位于 /portal/yadda 下。我想要任何人去

```
http://the.domain.com/ 
```

被快速重定向到

```
http://the.domain.com/portal/ 
```

我有和 index.html 做一个帖子和重定向，但用户有时会看到它。有没有人有更好的方法？

亚伦

我已经尝试了下面的3个回复。他们都没有为我工作。回到绘图板。一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-15T14:49:43.247

您也可以在 .htaccess 文件中添加以下行

重定向永久/oldpage.html [http://www.example.com/newpage.html](http://www.example.com/newpage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T14:23:05.447

这有帮助吗？ [http://docs.sun.com/source/816-5691-10/essearch.htm#25618](http://docs.sun.com/source/816-5691-10/essearch.htm#25618)

* * *

要映射 URL，请执行以下步骤：

打开类管理器并从下拉列表中选择服务器实例。

选择内容管理选项卡。

单击其他文档目录链接。Web 服务器显示附加文档目录页面。（可选）通过输入以下内容之一添加另一个目录。

网址前缀。例如：计划。要将 URL 映射到的目录的绝对物理路径。例如：C:/iPlanet/Servers/docs/marketing/plans 单击确定。

单击应用。

通过选择以下选项之一编辑列出的当前附加目录之一： 编辑

删除 如果正在编辑，请选择要更改的列出目录旁边的编辑。

使用 ASCII 格式输入新前缀。

（可选）如果要将样式应用到目录，请在“应用样式”下拉列表中选择一种样式：有关样式的更多信息，请参阅应用配置样式。单击确定以添加新的文档目录。

单击应用。

选择应用更改以硬启动/重新启动您的服务器。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-15T14:27:09.243

您应该能够将网络服务器配置为进行标头重定向（301 或 302，具体取决于您的情况），因此它无需加载 HTML 页面即可进行重定向。这也可以在 PHP 中完成：

```
<?php
header("Location: http://www.example.com/"); /* Redirect browser */

/* Make sure that code below does not get executed when we redirect. */
exit;
?> 
```

如果您不想修改服务器配置。

如果您的服务器使用 .htaccess 文件，请插入类似于以下内容的行：

```
Redirect 301 /oldpage.html http://www.example.com/newpage.html 
```

-亚当

# c# - 我怎么知道最后一个 OutputDataReceived 何时到达？

> ID：63303
> 
> 赞同：24
> 
> 时间：2008-09-15T14:17:27.957
> 
> 标签：c#, asynchronous, system.diagnostics

我在针对 .Net 框架 3.5 的程序中有一个 System.Diagnostics.Process 对象

我已经重定向了`StandardOutput`和`StandardError`管道，并且我正在异步接收来自它们的数据。我还为 Exited 事件设置了一个事件处理程序。

一旦我打电话`Process.Start()`，我就想在等待事件发生时离开并做其他工作。

不幸的是，对于返回大量信息的进程，Exited 事件似乎在最后一个`OutputDataReceived`事件之前被触发。

我怎么知道最后一次`OutputDataReceived`收到是什么时候？理想情况下，我希望该`Exited`事件是我收到的最后一个事件。

这是一个示例程序：

```
using System;
using System.Diagnostics;
using System.Threading;

namespace ConsoleApplication1
{
  class Program
  {

    static void Main(string[] args)
    {
      string command = "output.exe";
      string arguments = " whatever";

      ProcessStartInfo info = new ProcessStartInfo(command, arguments);

      // Redirect the standard output of the process. 
      info.RedirectStandardOutput = true;
      info.RedirectStandardError = true;

      // Set UseShellExecute to false for redirection
      info.UseShellExecute = false;

      Process proc = new Process();
      proc.StartInfo = info;
      proc.EnableRaisingEvents = true;

      // Set our event handler to asynchronously read the sort output.
      proc.OutputDataReceived += new DataReceivedEventHandler(proc_OutputDataReceived);
      proc.ErrorDataReceived += new DataReceivedEventHandler(proc_ErrorDataReceived);
      proc.Exited += new EventHandler(proc_Exited);

      proc.Start();
      // Start the asynchronous read of the sort output stream. Note this line!
      proc.BeginOutputReadLine();
      proc.BeginErrorReadLine();

      proc.WaitForExit();

      Console.WriteLine("Exited (Main)");

    }

    static void proc_Exited(object sender, EventArgs e)
    {

      Console.WriteLine("Exited (Event)");
    }

    static void proc_ErrorDataReceived(object sender, DataReceivedEventArgs e)
    {
      Console.WriteLine("Error: {0}", e.Data);
    }

    static void proc_OutputDataReceived(object sender, DataReceivedEventArgs e)
    {
      Console.WriteLine("Output data: {0}", e.Data);
    }

  }
} 
```

运行此程序时，您会注意到“Exited (Event)”出现在输出中一个完全可变的位置。您可能需要运行它几次，显然，您需要将“output.exe”替换为您选择的能够产生适当大量输出的程序。

所以，问题又来了：我怎么知道最后一个`OutputDataReceived`收到的时间？理想情况下，我希望该`Exited`事件是我收到的最后一个事件。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-09-14T20:13:57.310

答案是[`e.Data`将设置为`null`](https://msdn.microsoft.com/en-us/library/system.diagnostics.datareceivedeventhandler%28v=vs.110%29.aspx)：

```
static void proc_ErrorDataReceived(object sender, DataReceivedEventArgs e)
{
     if( e.Data == null ) _exited.Set();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-25T02:36:18.817

如果 e.Data 设置为 null 会更舒服，但实际上，该值将是一个空字符串。请注意，第一个值也可以是空字符串。真正的答案是，一旦您收到空字符串以外的其他值，然后查找下一个空字符串。我正在使用 Visual Studio 2019。

# internet-explorer-7 - 如何在不打开IE的情况下更改IE的主页？

> ID：63343
> 
> 赞同：2
> 
> 时间：2008-09-15T14:20:57.777
> 
> 标签：internet-explorer-7, windows-server-2008

这是一个有趣的问题。在最近安装的 Server 2008 64bit 上，我打开 IE 并通过工具 -> 选项将主页更改为 iGoogle.com。单击确定，然后单击主页按钮。IE 崩溃。

现在您会认为我可以将 iGoogle 作为主页删除，但是当我打开 IE 时，它会立即转到该页面并在打开时崩溃。

显然，我更愿意找到解决方案来解决 IE 在 iGoogle 页面上崩溃的原因，但为了让 IE 再次运行，我需要删除 iGoogle 作为主页。有没有办法在不打开 IE 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-15T14:22:07.523

控制面板 -> Internet 选项

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-15T14:23:21.983

查看注册表，起始页似乎存储在

HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main\Start Page

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T14:23:44.837

您可以通过控制面板执行此操作，但您也可以将 url 作为参数提供给 iexplore.exe。

```
start » run » iexplore about:blank 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T14:26:23.567

两种方式：

1.  控制面板->Internet 选项
2.  开始->运行...“%windir%\system32\inetcpl.cpl”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T14:25:05.927

不确定 Windows Server 2008 上的 IE7，但对于 IE6，起始页存储在 HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Main 的注册表项“起始页”中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T14:29:54.993

答案已发布，但您无需询问即可找到答案
1：将主页设置为随机的，即 FindMeKeyForURL.com
2：在注册表中搜索它
3：提取并修改它，现在您可以部署.reg 文件

# windows - 我上次与我的 Domain Server 通话是什么时候？

> ID：63345
> 
> 赞同：1
> 
> 时间：2008-09-15T14:21:07.650
> 
> 标签：windows, active-directory

我的应用程序如何从 Windows 获取有效的“上次连接到域”时间戳，即使应用程序脱机运行？

背景：我正在编写一个在整个公司的多台客户端机器上运行的应用程序。所有这些客户端机器都在我公司实施的 AD 域之一上。如果客户端机器有一段时间没有和AD通信，这个应用程序需要采取一定的措施。

一个例子可能是运行此应用程序的机器被盗。例如 4 周后，应用程序拒绝工作，因为它检测到机器已经 4 周没有与它的 AD 域通信。

请注意，这不能与用户帐户绑定，因为该应用程序可能作为本地服务帐户运行。这是我感兴趣的计算机域关系。

我已经考虑并拒绝使用`WinNT://<domain>/<machine>$,user`，因为它在离线时不起作用。此外，`LDAP://...`离线时任何查找都不起作用。

我还考虑并拒绝每天安排此查询并将时间戳存储在注册表或文件中。这个解决方案需要太多的设置和编码。除了这个值必须由 Windows 本地存储。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T15:33:29.863

我不相信这个值存储在客户端机器上。它存储在 Active Directory 中，您可以使用[Dsquery](http://technet.microsoft.com/en-us/library/cc730720.aspx)工具获取非活动机器的列表。

最好的选择是让您的程序进行简单的测试，例如连接到 DC，然后存储该操作的时间戳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T15:15:48.800

恕我直言，我认为客户端机器不会存储它上次与 AD 通信的时间戳。此信息存储在活动目录本身（即在 DC 上）

一旦用户登录到 Windows 机器，凭据就会被缓存。如果该机器与网络断开连接，则凭据将永远存在。您可以使用组策略关闭此功能，以便机器不会缓存任何凭据。

# vim - Screen + vim causes shift-enter to insert 'M' and a newline

> ID：63378
> 
> 赞同：8
> 
> 时间：2008-09-15T14:24:36.817
> 
> 标签：vim, ide, editor, gnu-screen

When running a vim instance in gnu screen hitting shift enter in insert mode adds an 'M' and then a newline, rather than just a newline.

Does anybody know what the problem might be, or where to look?

Relevant system info:

> Ubuntu 8.04.1
> 
> Screen version 4.00.03 (FAU) 23-Oct-06
> 
> VIM - Vi IMproved 7.1 (2007 May 12, compiled Jan 31 2008 12:20:21) Included patches: 1-138
> 
> Konsole 1.6.6 (Using KDE 3.5.10)

Thanks to the comments. When checking the value of `$TERM` I noticed that it was `xterm` (as expected), but within screen `$TERM` was set to `screen-bce`. Setting `TERM=xterm` after launching screen resolves this issue.

Adding the following to `~/.screenrc` solved the problem without having to do anything manually:

> term xterm

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T14:30:26.053

Missing info from your question:

1.  Where do you run screen and see this issue? Some terminal app (KTerminal, Gnome terminal, virtual console etc) or remote session (eg putty, ssh from another computer)
2.  do a “echo $TERM” and tell us its output
3.  do a “cat -v”, press Shift-Enter, then Enter, then `Ctrl`-`D` and then tell us what is output.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T21:09:48.243

First, you could fix your $TERM for within konsole. Install "ncurses-term" and configure konsole to set $TERM=konsole-256color. Then configure screen with "term screen-256color". Or 'konsole' and 'screen', respectively, if that's your preference. Konsole and screen are *not* xterm and doesn't support everything xterm does, so using incorrect $TERM can lead to bad things.

# c# - 将托管线程上的模拟令牌传递给非托管线程

> ID：63379
> 
> 赞同：2
> 
> 时间：2008-09-15T14:24:49.297
> 
> 标签：c#, vb.net, multithreading, unmanaged, managed

我有一个 VB.Net winforms 应用程序需要通过网络播放 WMV 文件的情况。运行应用程序的用户无法直接访问网络共享。通过模拟，我可以看到文件存在（没有模拟，File.Exists 为网络共享上的文件返回 false）。然后，当我尝试将文件加载到 Windows Media Player 控件中时，该控件仍然是黑色的。我推断，当 Windows Media Player 控件加载到内存中时，它运行在与 .Net 托管线程不同的非托管线程上。有没有办法将该安全令牌从托管线程传递到非托管线程？我完全错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-27T20:28:44.800

您是否尝试过使用[`SetThreadPrincipal`](http://msdn.microsoft.com/en-us/library/system.appdomain.setthreadprincipal.aspx)方法 off `AppDomain`？

例子：

`IPrinicipal userPrincipal = new MyCustomPrincipal();`

`AppDomain currentDomain = AppDomain.CurrentDomain;`

`currentDomain.SetThreadPrincipal(userPrincipal);`

你在你的问题中提到，WMV 似乎运行不受管理，所以如果这个前提是正确的，这真的不应该工作（见我的第二个答案）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T16:51:07.977

我想你尝试使用

```
[DllImport("advapi32.dll", SetLastError=true)]
public static extern int LogonUser(string pszUsername, string pszDomain, string pszPassword, int dwLogonType, int dwLogonProvider, ref IntPtr phToken); 
```

登录网络共享。

以我的经验，它不关心线程。

如果您认为它可能有用，我可以向您展示一个用法示例。在这里提到它有点长镜头。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-20T18:02:13.953

WMP 很有可能正在启动它自己的从您的进程令牌继承的线程，这是 ::CreateThread() 的默认行为。我很确定不可能从外部更改线程令牌，除非控件接受令牌作为参数，否则您无能为力。

我不确定除了将其放入另一个进程并使用 ::CreateProcessAsUser() 与您拥有的令牌创建该进程或将文件缓冲到本地某处之外是否有答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-27T20:30:03.830

假设 WMV 播放器在您的 AppDomain 之外运行，我会尝试托管 WPF / Silverlight 媒体播放器以通过网络访问文件。

# actionscript-3 - 有没有办法在不使用 Flash IDE 的情况下从 FLA 文件构建 Flash 9 SWF？

> ID：63390
> 
> 赞同：11
> 
> 时间：2008-09-15T14:25:39.840
> 
> 标签：actionscript-3, flash, open-source

如果有其他方法可以实现这些目标，这将是有用的两个原因： 1) 在 Flash IDE 中构建真的很慢；我希望第三方编译器会更快。2) 如果能够在没有安装 Flash IDE 的机器上构建项目，那就太好了。我熟悉那里的其他 AS3 编译器，但我不知道有任何将 FLA 文件作为输入的编译器。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T21:56:44.310

要回答最初的问题，不使用 Flash IDE 就无法编译 FLA。

使用自动打开 Flash 创作和编译 FLA 的命令行脚本的唯一部分解决方案。你可以在这里找到一个这样的例子：

[http://www.mikechambers.com/blog/2004/02/20/flashcommand-flash-command-line-compiler-for-os-x/](http://www.mikechambers.com/blog/2004/02/20/flashcommand-flash-command-line-compiler-for-os-x/)

如果您只需要编译 ActionScript 代码和资产，则有许多选项（一些包含在此线程中），包括 Flex SDK 中包含的 mxmlc 编译器（由 Adob​​e 提供）。

[http://www.adobe.com/products/flex/](http://www.adobe.com/products/flex/)

希望有帮助...

迈克室

网格@adobe.com

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T14:58:39.340

Eclipse 有一个名为 FDT 的插件。它使用开源编译器 MTASC 并支持 ANT。该工具对开源开发人员免费。在此处获取更多信息：http: [//fdt.powerflasher.com/](http://fdt.powerflasher.com/)

希望能帮助到你 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T17:21:30.260

FDT（或者更准确地说是 as2 的 mtasc 或 as3 的 flex）不能将 .fla 文件作为输入。

Fla 文件用于设计、时间线动画等，但如果您只进行编程，则不需要 fla 文件或 Flash IDE。FDT 是一个了不起的编码工具，尽管还有其他替代品（FDT 相当昂贵，除非你在 osflash.org 上有一个项目）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T18:47:08.090

[http://www.projectsprouts.org](http://www.projectsprouts.org)是你绝对应该看的东西。它为 as2 和 as3 自动创建项目，如果您没有库（如 mtasc 或 Flex 编译器）下载库，因此允许您在没有 Flash IDE 的情况下编译 swfs。

当然，这不完全是您要问的 - 我会说不，没有第三方编译器可以采用 FLA 并编译 swfs - 如果存在它将是未经授权/非商业的，因为 FLA 格式不是打开，只有swf格式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T18:57:46.457

我还推荐使用 FlashDevelop。这是另一个开源工具，它是一个非常轻量级的 IDE（我相信基于 SciTE），它集成了 SWFMILL（一种可以从 XML 文件创建 SWF 布局项的流行工具）和 mtasc（一种流行的 Actionscript 第三方编译器）。我不完全确定您是否可以将 .FLA 文件作为输入，但是您可以通过在 XML 中创建布局来完全避免 FLA 文件，或者如果为您创建布局的设计师/Flash 开发人员可以简单地提供一个已编译的空文件（到目前为止作为代码）SWF 文件，这些工具将允许您将编译的动作脚本直接注入到 SWF 文件中。这种技术也可以用在命令行上来生成构建脚本等等。

这是网站： [http ://www.flashdevelop.org](http://www.flashdevelop.org)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-06T07:04:38.183

这是[**Haxe**在 2008 年必须提供的](http://old.haxe.org/index?version=1270)，在这个问题提出之前（至少[来自 doc](http://old.haxe.org/doc/intro?version=2835)）：

> Flash：您可以将 Haxe 程序编译为 .swf 文件。Haxe 可以使用“旧的”Flash<8 API 或最新的 AS3/Flash9 API 为 Flash Player 6 到 9 进行编译。Haxe 提供了非常好的性能和语言特性来开发 Flash 内容。

虽然我不确定当时的答案是否足够好，但现在肯定是**答案**。

# php - 返回 SQL 语句的 MySQL 语句？

> ID：63399
> 
> 赞同：6
> 
> 时间：2008-09-15T14:27:23.440
> 
> 标签：php, mysql, export

我需要在远程服务器上转储表，但我无法直接访问服务器。我唯一的访问权限是通过 PHP 脚本。

是否有某种方式可以让 MySQL 返回一个

```
INSERT INTO `table_name` (`field1`, `field2`) VALUES ('a', 'b'), ('c', 'd') 
```

声明，比如`mysqldump`会返回什么？

我无权访问 phpMyAdmin，而且我最好不想使用`exec`,`system`或`passthru`.

有关另一种导出方法，请参阅[此问题](https://stackoverflow.com/questions/81934/easy-way-to-export-a-sql-table-without-access-to-the-server-or-phpmyadmin)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T14:28:38.990

1）你可以从 exec 或 passthru 运行 mysqldump
2）看看这个：[http ://www.php-mysql-tutorial.com/perform-mysql-backup-php.php](http://www.php-mysql-tutorial.com/perform-mysql-backup-php.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T14:30:51.870

如果你可以在服务器上使用 php-scripts 我会推荐[phpmyadmin](http://www.phpmyadmin.net/home_page/index.php)。然后，您可以从 Web 界面执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T14:31:01.573

你应该看看[PHPMyAdmin](http://phpmyadmin.sourceforge.net)，它是一个基于 php 的 MySQL 管理工具。它支持数据库的备份和恢复以及数据库服务器的“GUI”。它工作得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T14:31:30.153

我很确定[phpMyAdmin](http://www.phpmyadmin.net/)会[为你做这件事](http://www.phpmyadmin.net/documentation/#faqexport)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T14:32:05.097

这

```
select 'insert into table table_name (field1, field2) values'
       || table_name.field1 || ', ' || table_field2 || ');'
from   table_name 
```

应该让你开始。替换 || 使用您的数据库风格的字符串连接运算符。如果 field1 或 field2 是字符串，您将不得不想出一些引用/转义的技巧。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T14:36:28.067

这是一种生成大量单独查询语句的方法。您还可以使用 implode 更有效地组合字符串，但这对于初学者来说更容易阅读，并且从中您可以提出一百万种其他方法。

```
$results = mysql_query("SELECT * FROM `table_name`");
while($row = mysql_fetch_assoc($results)) {

    $query = "INSERT INTO `table_name` ";
    $fields = '(';
    $values = '('; 

    foreach($row as $field=>$value) {
        $fields .= "'".$field."',";
        $values .= "'".mysql_escape_string($value)."',";
    }

    //drop the last comma off
    $fields = substr($fields,0,-1);
    $values = substr($values,0,-1);

    $query .= $fields . " VALUES " . $values;

    //your final result
    echo $query;
} 
```

看看这是否能让你开始

# ios - iPhone 应用程序加载

> ID：63408
> 
> 赞同：14
> 
> 时间：2008-09-15T14:29:15.900
> 
> 标签：ios, iphone

当我加载我的 iPhone 应用程序时，它总是先加载黑屏，然后弹出主窗口。即使加载了单个窗口的简单空应用程序也会发生这种情况。

我注意到，在加载时，大多数应用程序会放大主窗口（或将其缩放以适应屏幕，但是您想考虑一下），然后加载屏幕内容，没有黑屏（请参阅联系人应用程序为例）。

我怎样才能达到这个效果？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-15T14:35:24.403

将 Default.png 添加到您的项目中。这应该是您想要显示的图像，而不是黑色的启动屏幕。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-15T14:39:36.577

也只是为了节省您一些时间，在您的应用程序运行期间无法更改此图像。如果您查看 Apple 的 Clock 应用程序，您可以看到 Default.png 如何根据应用程序的最后状态发生变化。由于权限限制，您无法在自己的应用程序中执行此操作。此外，请务必阅读 iPhone HIG 以了解有关 Default.png 使用的最佳实践，简而言之，不要将其用作 Twitteriffic 之类的启动屏幕。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T14:43:22.153

您还可以截取您的应用程序的屏幕截图以帮助创建 Default.png - 按住 Home 按钮的同时，按下并释放 Lock Sleep/Wake 按钮。屏幕截图可以在照片应用程序的相机胶卷库中找到，并且可以同步回您的桌面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T15:25:28.230

当应用程序从启动图像过渡到实际应用程序内容时，它不应该让用户感到不安 - 内容（文本/图像）可以添加到屏幕上，但内容不应该改变。如果这一切只剩下一个空的蓝色页眉、一个白色的正文和一个蓝色的页脚——那么这就是你应该拥有的一切。如果您在底部有一个持久的标签栏和一个本地化的应用程序（不同的文本描述），那么启动图像应该出现图标但没有文本。（有关示例，请参见 Clock.app 和 Facebook.app。）

屏幕截图也可以在 XCode 中使用 Organizer 窗口中的 Screenshot 选项卡和插入的设备进行。

# emacs - 使用 Emacs 作为 IDE

> ID：63421
> 
> 赞同：176
> 
> 时间：2008-09-15T14:31:22.603
> 
> 标签：emacs, ide, development-environment, slime

目前，当我使用 C 或 C++ 进行编码时，我使用 Emacs 的工作流程涉及三个窗口。右侧最大的包含我正在使用的文件。左边一分为二，底部是我用来输入编译或制作命令的外壳，顶部通常是我在工作时想查阅的某种文档或自述文件。现在我知道那里有一些非常专业的 Emacs 用户，我很好奇如果打算将 Emacs 用作完整的 IDE，其他 Emacs 的功能还有什么用处。具体来说，大多数 IDE 通常以某种形式实现这些功能：

*   源代码编辑器
*   编译器
*   调试
*   文档查找
*   版本控制
*   OO 功能，例如类查找和对象检查器

对于其中的一些，很明显 Emacs 是如何适应这些功能的，但其余的呢？此外，如果必须专注于特定语言，我会说它应该是 C++。

**编辑：**一位用户指出，当我说“其余的呢”时，我应该更具体一些。大多数情况下，我对有效的版本控制以及文档查找感到好奇。例如，在 SLIME 中，对 Lisp 函数进行快速的超规范查找是相当容易的。有没有一种快速的方法可以在 C++ STL 文档中查找某些内容（例如，如果我忘记了[hash_map](http://www.sgi.com/tech/stl/hash_map.html)的确切语法）？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-09-15T14:41:01.380

您必须具体说明“其余”的含义。除了对象检查器（我知道）之外，emacs 很容易完成上述所有操作：

*   编辑（明显）
*   编译器 - 只需运行`M-x compile`并输入您的编译命令。从那里开始，您可以只`M-x compile`使用默认值。Emacs 将捕获 C/C++ 编译器错误（最适合 GCC）并帮助您导航到带有警告或错误的行。
*   调试 - 同样，当您要调试时，键入`M-x gdb`它会创建一个带有特殊绑定的 gdb 缓冲区
*   文档查找 - emacs 具有出色的代码导航 CScope 绑定。对于其他文档：Emacs 也有一个手册页阅读器，对于其他一切，还有网络和书籍。
*   版本控制 - 有很多 Emacs 绑定用于各种 VCS 后端（CVS、SCCS、RCS、SVN、GIT 都浮现在脑海中）

编辑：我意识到我关于文档查找的答案确实与代码导航有关。这里有一些更中肯的信息：

*   [在 emacs 中查找联机帮助页、信息手册和 Elisp 文档](http://www.delorie.com/gnu/docs/emacs/emacs_289.html)
*   [在 Emacs 中查找 Python 文档](https://bitbucket.org/jonwaltman/pydoc-info)。

谷歌搜索无疑会揭示更多的例子。

正如第二个链接所示，即使不支持开箱即用，也可以在其他文档中查找函数（以及其他内容）。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-16T02:20:33.303

我不得不推荐[Emacs Code Browser](http://ecb.sourceforge.net/ "Emacs 代码浏览器主页")作为 emacs 更“传统”的 IDE 风格环境。

**编辑**：我现在还高度推荐[Magit](http://www.emacswiki.org/emacs/Magit)，而不是 emacs 中的标准 VCS 接口。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-09-15T14:40:06.170

您是否尝试过 Mx 编译，而不是在 shell 窗口中运行 make 命令？它将运行您的 make 命令，显示错误，并且在许多情况下，如果输出包含文件名和行号，则可以很容易地跳转到导致错误的代码行。

如果您是 IDE 的粉丝，您可能还想查看 emacs 的 speedbar 包（Mx speedbar）。而且，如果您还没有，请了解如何使用标签表来导航您的代码。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-01T22:19:33.310

曾经发现的 emacs 的某些角落会让您以您从未想过的方式提高工作效率。正如其他人所提到的，使用标签是缩放源代码的一种奇妙而快速的方法，并且使用 M-/ (dabbrev-expand) 通常在完成变​​量名时完全符合您的期望。

使用发生对于获取缓冲区中所有出现的正则表达式的缓冲区很有用。这在重构代码和查找代码片段或变量的使用时非常方便，或者如果您在源文件中使用 TODO 标记并且想要全部访问它们。

flush-lines、sort-numeric-fields、replace-regexp 和 rectangle 函数对于从某些工具获取转储并将其转换为有用的数据（例如 elisp 程序或逗号分隔的电子表格）非常有用。

我写了一个关于 IDE 的页面，就像你可以用 emacs 做的事情一样

[http://justinsboringpage.blogspot.com/2007/09/11-visual-studio-tricks-in-emacs.html](http://justinsboringpage.blogspot.com/2007/09/11-visual-studio-tricks-in-emacs.html)

学习 elisp 是另一种很好的方式，可以让您自己回答 emacs 除了典型的 IDE 之外还能做什么。

例如，我写过关于编写 Perforce 辅助函数（如责备）的博客（编写你自己的意味着你可以让它完全按照你想要的方式运行）......

[http://justinsboringpage.blogspot.com/2009/01/who-changed-line-your-working-on-last.html](http://justinsboringpage.blogspot.com/2009/01/who-changed-line-your-working-on-last.html)

我还编写了代码，可以动态地为某个函数创建注释，这与我正在使用的编码标准相匹配。

我的 elisp 代码没有一个特别好，而且大部分代码已经存在于库中，但是能够让 emacs 执行在工作日中出现的自定义内容真的很有用。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-04T08:50:05.957

[您可以在我的网站](http://xtalk.msk.su/~ott/en/writings/emacs-vcs/index.html)上找到有关 emacs 和版本控制集成的详细说明。我还在撰写有关使用 Emacs 作为多种语言的开发环境的文章 - C/C++、Java、Perl、Lisp/Scheme、Erlang 等...

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-10-02T11:08:39.497

对于版本控制，您可以使用多种东西，具体取决于您使用的版本控制系统。但有些功能对所有人来说都是通用的。

**vc.el**是在文件级别处理版本控制的内置方法。它具有大多数版本控制系统的后端。例如，Subversion 后端随 Emacs 一起提供，还有 git 后端和其他可从其他来源获得的后端。

最有用的命令是**Cx vv** (vc-next-action)，它为您正在访问的文件执行适当的下一步操作。这可能意味着从存储库更新或提交您的更改，如果您使用的是需要它的系统（如 RCS），vc.el 还会重新绑定**Cx Cq以签入和签出文件。**

其他非常有用的命令是**Cx vl**和**Cx v =**，它们向您显示您正在使用的文件的日志和当前差异。

但是为了真正的生产力，除了简单的事情之外，您应该避免使用单文件 vc.el 命令。有几个包可以让您了解整个树的状态，并为您提供更多功能，更不用说创建跨多个文件的连贯提交的能力了。

其中大部分都受到严重影响或基于 CVS 的原始**pcl-cvs** / **pcvs**。甚至有两个是 subversion 附带的，**psvn.el**和**dsvn.el**。有 git 等软件包。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2013-01-31T22:14:34.163

好的，这里的每个人都在给出完美的提示，让 emacs 成为一个很棒的 IDE。

但是任何人都应该记住，当您使用大量扩展自定义您的 emacs 时（尤其是那些用于动态类型检查、函数定义查找等的扩展），您的 emacs 将加载非常非常慢的编辑器。

要解决此问题，我强烈建议在`server mode`.

它使用起来非常简单，无需自定义您的 init 文件。您只需要以守护程序模式启动 emacs；

```
emacs --daemon 
```

这将创建一个 emacs 服务器，然后您可以从终端或从 gui 连接它。我还建议创建一些别名以便于调用。

```
alias ec="emacsclient -t"
alias ecc="emacsclient -c &"
# some people also prefer this but no need to fight here;
alias vi="emacsclient -t" 
```

这样，emacs 会比 gedit 更快地启动，承诺。

这里的一个可能问题是，如果您从临时用户运行 emacs 守护程序，您可能无法将 emacs 服务器连接为`root`.

因此，如果您需要打开具有 root 访问权限的文件；改为使用`tramp`。只需使用您的普通用户运行您的 emacs 客户端并打开这样的文件；

```
C-x C-f
/sudo:root@localhost/some/file/that/has/root/access/permissions
# on some linux distro it might be `/su:root@...` 
```

这让我的生活变得更轻松，我可以通过这种方式在几毫秒内打开我重度定制的 python IDE。您可能还想将 emacs --daemon 添加到系统启动中，或者为 emacsclient 创建一个桌面文件。随你（由你决定。

更多关于 emacs 守护进程和 emacs 客户端的信息可以在 wiki 上找到；

[http://www.emacswiki.org/emacs/EmacsAsDaemon](http://www.emacswiki.org/emacs/EmacsAsDaemon)

[http://www.emacswiki.org/emacs/EmacsClient](http://www.emacswiki.org/emacs/EmacsClient)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-15T14:54:48.943

我同意您应该了解 Mx compile（将其和 Mx next-error 绑定到短键序列）。

了解版本控制的绑定（例如 vc-diff、vc-next-action 等）

查看寄存器。您不仅可以记住缓冲区中的位置，还可以记住整个窗口配置（Cx rw -- window-configuration-to-register）。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-09-17T10:34:31.033

探索 Emacs 的 VC 特性的起点（可能不明显）是**Mx vc-next-action**。

它根据文件的状态和 VC 后端对当前文件执行“下一个逻辑版本控制操作”。因此，如果文件不受版本控制，它会注册它，如果文件已更改，则提交更改等。

这需要一点时间来适应，但我发现它非常有用。

默认键绑定是**Cx vv**

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-11-04T16:17:30.893

我知道这是一个非常古老的帖子。但是这个问题对emacs初学者是有效的。

IMO 使用 emacs 作为 ide 的最佳方式是使用带有 emacs 的[语言服务器协议](https://langserver.org/)。您可以在链接的网站上找到有关语言服务器的所有信息。

为了快速设置，我敦促您访问此页面[eglot](https://github.com/joaotavora/eglot)。IMO eglot 做得很好。它与公司等自动完成包很好地集成在一起。提供查找参考等。

同样对于调试器，您可能需要针对特定​​语言的特定调试器。您可以在 emacs 中使用 gdb。只需键入`M-x gdb`.

为了编译你的代码，最好使用 shell 命令。我正在研究这个项目[eproj](https://github.com/sidhartharya10/eproj)。完成它需要一段时间。但它所做的只是将 shell 命令映射到项目类型。并通过 shell 构建您的项目。执行命令也是如此。我可能需要帮助来完成这个项目。它还没有准备好使用，但如果你知道一点 elisp，你可以通过代码。

除此之外，最好使用 emacs compile 命令。

对于版本控制，我还没有看到任何其他软件包可以与[magit](https://github.com/magit/magit)的强大功能相媲美。它特定于 git。对于 git，还有另一个包 git-timemachine，我觉得它非常有用。

对象查找和类查找由语言服务器协议提供。

项目树可用于与[treemacs](https://github.com/magit/magit)类似的 ide 接口。

还有一个名为[projectile](https://github.com/bbatsov/projectile)的项目交互库。

对于自动完成，我发现[公司模式](https://github.com/company-mode/company-mode)非常有用。

真正的 emacs 可以做任何事情。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-10-24T04:24:32.710

有一个[TFS.el 用于将 emacs 集成到 Microsoft TFS](http://www.emacswiki.org/emacs/MSTFS)中。它适用于任何 TFS，包括运行 Codeplex.com 的 TFS。

设置的基本步骤：

1.  将 tfs.el 放在您的加载路径中。

2.  在您的 .emacs 文件中：

    ```
    (require 'tfs)
    (setq tfs/tf-exe  "c:\\vs2008\\common7\\ide\\tf.exe")
    (setq tfs/login "/login:domain\\userid,password")
          -or-
    (setq tfs/login (getenv "TFSLOGIN"))  ;; if you have this set 
    ```

3.  同样在您的 .emacs 文件中，为 tfs 命令设置本地或全局键绑定。像这样：

    ```
    (global-set-key  "\C-xvo" 'tfs/checkout)
    (global-set-key  "\C-xvi" 'tfs/checkin)
    (global-set-key  "\C-xvp" 'tfs/properties)
    (global-set-key  "\C-xvr" 'tfs/rename)
    (global-set-key  "\C-xvg" 'tfs/get)
    (global-set-key  "\C-xvh" 'tfs/history)
    (global-set-key  "\C-xvu" 'tfs/undo)
    (global-set-key  "\C-xvd" 'tfs/diff)
    (global-set-key  "\C-xv-" 'tfs/delete)
    (global-set-key  "\C-xv+" 'tfs/add)
    (global-set-key  "\C-xvs" 'tfs/status)
    (global-set-key  "\C-xva" 'tfs/annotate)
    (global-set-key  "\C-xvw" 'tfs/workitem) 
    ```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-09-16T05:58:58.613

compile、next-error 和 previous-error 都是 Emacs 中 C++ 开发的非常重要的命令（在 grep 输出上也很有效）。Etags、visit-tags-table 和 find-tag 也很重要。completion.el 是 20 世纪最伟大的无名 hack 之一，它可以将您的 C++ hack 速度提高一个数量级。哦，我们不要忘记ediff。

我还没有学习如何在不访问 shell 的情况下使用版本控制，但现在我运行提交的频率非常高（使用 git），我可能不得不这样做。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-05-10T15:38:43.870

您可能还会发现[标签栏](http://www.emacswiki.org/emacs/TabBarMode)很有用。它模拟了我从 Eclipse 迁移到 Emacs 时遗漏的唯一行为。绑定到“，”和“。” 为了移动到上一个和下一个选项卡栏，它使您无需一直按 Ctrl-x b 切换缓冲区。

不幸的是，上述网页没有提供正确的下载版本。然而，大多数 Ubuntu 版本在他们的 emacs-goodies 包中提供它。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-01-06T23:13:59.513

我在 Windows 上使用 emacs。compile 模块很好，但我希望 compile 对它建议的 compile 命令行更智能。 [可以使用“文件变量”来指定`compile-command`](http://www.gnu.org/software/emacs/manual/html_node/emacs/Specifying-File-Variables.html#Specifying-File-Variables)，但我想要比这更聪明的东西。所以我写了一个小函数来帮忙。它猜测要使用的编译命令，以在运行时提示用户`compile`。

guess 函数会查找 vbproj 或 csproj 或 sln 文件，如果找到，它会建议 msbuild。然后它查看缓冲区文件名，并据此提出不同的建议。.wxs 文件意味着它是一个 WIX 项目，并且您可能想要构建一个 MSI，因此猜测逻辑建议为 MSI 使用 nmake 命令。如果它是一个 Javascript 模块，那么建议运行 jslint-for-wsh.js 来检查 .js 文件。作为后备，它建议使用nmake。

我使用的代码如下所示：

```
(defun cheeso-guess-compile-command ()
  "set `compile-command' intelligently depending on the
current buffer, or the contents of the current directory."
  (interactive)
  (set (make-local-variable 'compile-command)
       (cond
        ((or (file-expand-wildcards "*.csproj" t)
             (file-expand-wildcards "*.vcproj" t)
             (file-expand-wildcards "*.vbproj" t)
             (file-expand-wildcards "*.shfbproj" t)
             (file-expand-wildcards "*.sln" t))
         "msbuild ")

        ;; sometimes, not sure why, the buffer-file-name is
        ;; not set.  Can use it only if set.
        (buffer-file-name
         (let ((filename (file-name-nondirectory buffer-file-name)))
           (cond

            ;; editing a .wxs (WIX Soluition) file
            ((string-equal (substring buffer-file-name -4) ".wxs")
             (concat "nmake "
                     ;; (substring buffer-file-name 0 -4) ;; includes full path
                     (file-name-sans-extension filename)
                     ".msi" ))

            ;; a javascript file - run jslint
            ((string-equal (substring buffer-file-name -3) ".js")
             (concat (getenv "windir")
                     "\\system32\\cscript.exe c:\\users\\cheeso\\bin\\jslint-for-wsh.js "
                     filename))

            ;; something else - do a typical .exe build
            (t
             (concat "nmake "
                     (file-name-sans-extension filename)
                     ".exe")))))
        (t
         "nmake "))))

(defun cheeso-invoke-compile-interactively ()
  "fn to wrap the `compile' function.  This simply
checks to see if `compile-command' has been previously set, and
if not, invokes `cheeso-guess-compile-command' to set the value.
Then it invokes the `compile' function, interactively."
  (interactive)
  (cond
   ((not (boundp 'cheeso-local-compile-command-has-been-set))
    (cheeso-guess-compile-command)
    (set (make-local-variable 'cheeso-local-compile-command-has-been-set) t)))
  ;; local compile command has now been set
  (call-interactively 'compile))

;; in lieu of binding to `compile', bind to my monkeypatched function
(global-set-key "\C-x\C-e"  'cheeso-invoke-compile-interactively) 
```

我尝试将其作为编译功能的“事先建议”，但无法使其令人满意地工作。所以我定义了一个新函数并将它绑定到我一直使用的相同的击键组合`compile`。

* * *

> **编辑**现在有“ [smarter-compile.el](http://marmalade-repo.org/packages/smarter-compile) ”，它使这个想法更进一步。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-27T12:21:39.903

关于文档查找：这取决于您的编程语言。

C 库和系统调用通常记录在手册页中。为此，您可以使用`M-x man`. 有些事情可能会在信息页面中更好地记录；使用`M-x info`.

对于 elisp 本身，使用`C-h f`. 对于 python，`>>> help(<function, class, module>)`在解释器中使用。

我发现大多数其他语言都以 html 形式提供文档。为此，请尝试使用嵌入式浏览器（我使用 w3m）。将您的`BROWSER`环境变量设置为（在 *nix 上）的包装脚本`emacsclient -e "(w3m-goto-url-new-session \"$@\")"`，以防某些东西可能会打开浏览器并且您希望它在 emacs 中打开。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-11-15T14:50:05.043

近年来，Clang 成为了 Emacs C++ 支持的重要组成部分。Atila Neves 在 CppCon 2015 上发表演讲： [“Emacs as a C++ IDE”](https://youtu.be/5FQwQ0QWBTU)

这是一个 16 分钟的演讲，他展示了以下主题的解决方案：

*   跳转到定义
*   自动完成
*   动态语法高亮
*   在项目中查找文件

幻灯片可以在[这里](https://github.com/CppCon/CppCon2015/raw/master/Lightning%20Talks%20and%20Lunch%20Sessions/Emacs%20as%20a%20C%2B%2B%20IDE/Emacs%20as%20a%20C%2B%2B%20IDE%20-%20Atila%20Neves%20-%20CppCon%202015.pdf)找到。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-02-25T14:05:30.570

尝试 lsp 模式。现在您可以在 emacs 中使用其他 IDE 功能连接到服务器。寻找更多信息：[lsp-mode](https://github.com/emacs-lsp/lsp-mode)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-11-07T15:29:44.657

在 Unix 或 X windows 风格中，我不知道有一个适用于所有东西的集成 IDE。

为了与调试器交互，只是 IDE 的一个组件，请考虑[realgud](https://github.com/realgud)。我发现它有用的另一件事是位置消息的解析器，因此如果您有调用堆栈跟踪并想在调用堆栈中的特定位置进行编辑，这个前端接口可以做到这一点。

到目前为止，该程序可以使用改进。但随后它也可以使用致力于它的人来改进它。

免责声明：我在 realgud 上工作

# c++ - 如何在 Win32 应用程序中通过 C++/MFC 在鼠标光标处显示动态文本

> ID：63429
> 
> 赞同：1
> 
> 时间：2008-09-15T14:31:57.377
> 
> 标签：c++, winapi, mfc

我希望能够在 win32 应用程序中的鼠标光标位置显示一些动态文本，例如给出一个 X，Y 坐标，该坐标将随着光标移动，就好像附加了一样。我可以在 mousemove 事件期间使用鼠标坐标处的窗口的 TextOut() 调用来执行此操作，并使存储的最后一个光标位置周围的矩形无效以清除先前的输出。然而，这可能会受到闪烁的影响，并导致在窗口中绘制其他内容（例如跟踪框）时出现问题。有没有更好的方法来做到这一点，也许使用现有的光标绘制/无效机制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T15:38:11.333

您可以通过 ToolTips 执行此操作 - 查看[CToolTipCtrl](http://msdn.microsoft.com/en-us/library/6b4cb3a5(VS.80).aspx)。

如果您想要无闪烁跟踪工具提示，那么您需要从使用[trackActivate](http://msdn.microsoft.com/en-us/library/bb760421(VS.85).aspx)消息的 CToolTipCtrl 派生您自己的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T20:17:32.613

您可能需要考虑移动一个小的透明窗口以跟随鼠标。特别是从 Windows 2000 开始，[分层](http://msdn.microsoft.com/en-us/library/ms632599(VS.85).aspx#layered)窗口似乎是首选武器（坦白：没有个人经验）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T09:37:42.997

您可以覆盖 OnSetCursor 以获取动态鼠标光标。我刚刚找到了一个德语教程。

[德语教程](https://web.archive.org/web/20050320074845/http://www.cpp-tutor.de/mfc/mfc/kap7/tut/tut4.htm)

[英文翻译教程](http://translate.google.com/translate?hl=de&sl=de&tl=en&u=https%3A%2F%2Fweb.archive.org%2Fweb%2F20050320074845%2Fhttp%3A%2F%2Fwww.cpp-tutor.de%2Fmfc%2Fmfc%2Fkap7%2Ftut%2Ftut4.htm&sandbox=1)

# winforms - 以编程方式在 winforms 应用程序中显示工具提示

> ID：63439
> 
> 赞同：27
> 
> 时间：2008-09-15T14:32:56.560
> 
> 标签：winforms

如何以编程方式使控件的工具提示显示在 Winforms 应用程序中，而无需将鼠标悬停在控件上？（必要时可以使用 P/Invoke）。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-15T14:51:27.530

如果你`Tooltip`在表单上使用控件，你可以这样做：

`ToolTip1.Show("Text to display", Control)`

[ToolTip 控件的“显示”方法](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.show.aspx)的MSDN 文档对此有所有不同的变体以及如何使用它们。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-15T14:38:28.950

```
System.Windows.Forms.ToolTip ToolTip1 = new System.Windows.Forms.ToolTip();
ToolTip1.SetToolTip(this.textBox1, "Hello"); 
```

工具提示将设置在控件“textBox1”上。

在这里阅读：

[http://msdn.microsoft.com/en-us/library/aa288412.aspx](http://msdn.microsoft.com/en-us/library/aa288412.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-30T09:52:43.880

首先，您需要将工具提示控件添加到表单第二个将工具提示控件附加到您希望工具提示显示的某个控件（MyControl）第三个这样做： Tooltip1.Show("My ToolTip Text", MyControl)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-23T14:46:58.317

凯文，如果您想创建自己的气球，请阅读此链接：[任务 3：显示气球提示](http://www.microsoft.com/indonesia/msdn/pinvoke.aspx)。提到了具有 TOOLTIPS_CLASS 常量的 NativeMethods 类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T14:37:00.997

这是我使用的代码：

```
static HWND hwndToolTip = NULL;

void CreateToolTip( HWND hWndControl, TCHAR *tipText )
{  
    BOOL success;

  if( hwndToolTip == NULL )
  {
    hwndToolTip = CreateWindow(  TOOLTIPS_CLASS, 
                                 NULL, 
                                 WS_POPUP | TTS_NOPREFIX | TTS_ALWAYSTIP,                                     
                                 CW_USEDEFAULT, CW_USEDEFAULT, 
                                 CW_USEDEFAULT, CW_USEDEFAULT,                                     
                                 NULL, NULL,
                                 hInstResource, 
                                 NULL ); 
  }

  if( hwndToolTip )
  { 
    TOOLINFO ti; 

    ti.cbSize   = sizeof(ti); 
    ti.uFlags   = TTF_TRANSPARENT | TTF_SUBCLASS; 
    ti.hwnd     = hWndControl; 
    ti.uId      = 0; 
    ti.hinst    = NULL; 
    ti.lpszText = tipText; 

    GetClientRect( hWndControl, &ti.rect ); 

    success = SendMessage( hwndToolTip, TTM_ADDTOOL, 0, (LPARAM) &ti ); 
  }
} 
```

调用 CreateToolTip 函数为某个控件创建一个工具提示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-08T19:34:04.193

如果您为整个表单创建私有变量，您将能够调用 sub 并调整初始延迟。

```
Public Class MyForm        
Private MyTooltip As New ToolTip        
...        
Sub ApplyToolTips        
'For default        
ApplyToolTips (1000)        
End Sub        

Sub ApplyTooltips (ByVal Delay as Integer)        

MyTooltip .InitialDelay = Delay        
MyTooltip.AutoPopDelay = 5000        
...        
MyTooltip.SetToolTip(Me.btnClose, "Close the form")        

End Sub       

Private Sub Btn_Click(sender As System.Object, e As System.EventArgs) Handles Btn.Click           
    Dim PicBox As PictureBox = CType(sender, PictureBox)        
    ApplyTooltips (0)       
    ApplyTooltips (1000)       
End Sub 
```

# sql - 如何在 SQL SELECT 中执行 IF...THEN？

> ID：63447
> 
> 赞同：1688
> 
> 时间：2008-09-15T14:34:09.337
> 
> 标签：sql, sql-server, tsql, if-statement, case

如何执行`IF...THEN`in`SQL SELECT`语句？

例如：

```
SELECT IF(Obsolete = 'N' OR InStock = 'Y' ? 1 : 0) AS Saleable, * FROM Product 
```

* * *

## 回答 #1

> 赞同：1941
> 
> 时间：2008-09-15T14:38:24.473

该`CASE`语句最接近 SQL 中的 IF，所有版本的 SQL Server 都支持该语句。

```
SELECT CAST(
             CASE
                  WHEN Obsolete = 'N' or InStock = 'Y'
                     THEN 1
                  ELSE 0
             END AS bit) as Saleable, *
FROM Product 
```

`CAST`如果您希望结果为布尔值，则只需要使用运算符。如果您对 a 感到满意`int`，则此方法有效：

```
SELECT CASE
            WHEN Obsolete = 'N' or InStock = 'Y'
               THEN 1
               ELSE 0
       END as Saleable, *
FROM Product 
```

`CASE`语句可以嵌入到其他`CASE`语句中，甚至可以包含在聚合中。

SQL Server Denali (SQL Server 2012) 添加了[IIF](http://msdn.microsoft.com/en-us/library/hh213574%28v=sql.110%29.aspx)语句，该语句也可用于[访问（](http://www.techonthenet.com/access/functions/advanced/iif.php) [Martin Smith](https://stackoverflow.com/questions/63447/how-do-you-perform-an-if-then-in-an-sql-select/6769805#6769805)指出）：

```
SELECT IIF(Obsolete = 'N' or InStock = 'Y', 1, 0) as Saleable, * FROM Product 
```

* * *

## 回答 #2

> 赞同：350
> 
> 时间：2008-09-15T15:10:49.870

在这种情况下，case 语句是你的朋友，它采用以下两种形式之一：

简单案例：

```
SELECT CASE <variable> WHEN <value>      THEN <returnvalue>
                       WHEN <othervalue> THEN <returnthis>
                                         ELSE <returndefaultcase>
       END AS <newcolumnname>
FROM <table> 
```

扩展案例：

```
SELECT CASE WHEN <test>      THEN <returnvalue>
            WHEN <othertest> THEN <returnthis>
                             ELSE <returndefaultcase>
       END AS <newcolumnname>
FROM <table> 
```

您甚至可以将 case 语句放在一个 order by 子句中，以实现真正花哨的排序。

* * *

## 回答 #3

> 赞同：297
> 
> 时间：2011-07-20T23:39:10.790

在 SQL Server 2012 中，您可以使用该[**`IIF`**功能](http://msdn.microsoft.com/en-us/library/hh213574(v=sql.110).aspx)。

```
SELECT IIF(Obsolete = 'N' OR InStock = 'Y', 1, 0) AS Salable, *
FROM   Product 
```

这实际上只是一种速记（尽管不是标准 SQL）的写作方式`CASE`。

`CASE`与扩展版本相比，我更喜欢简洁。

两者都`IIF()`解析`CASE`为 SQL 语句中的表达式，并且只能在定义明确的地方使用。

> CASE 表达式不能用于控制 Transact-SQL 语句、语句块、用户定义函数和存储过程的执行流程。

如果这些限制不能满足您的需求（例如，需要根据某些条件返回不同形状的结果集），那么 SQL Server 也有一个过程[`IF`](http://msdn.microsoft.com/en-gb/library/ms182717.aspx)关键字。

```
IF @IncludeExtendedInformation = 1
  BEGIN
      SELECT A,B,C,X,Y,Z
      FROM   T
  END
ELSE
  BEGIN
      SELECT A,B,C
      FROM   T
  END 
```

[然而，有时必须小心避免这种方法的参数嗅探问题](https://dba.stackexchange.com/a/9874/3690)。

* * *

## 回答 #4

> 赞同：102
> 
> 时间：2008-09-15T14:39:49.900

*[你可以在The Power of SQL CASE Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml)*中找到一些很好的例子，我认为你可以使用的语句是这样的（来自[4guysfromrolla](http://www.4guysfromrolla.com/)）：

```
SELECT
    FirstName, LastName,
    Salary, DOB,
    CASE Gender
        WHEN 'M' THEN 'Male'
        WHEN 'F' THEN 'Female'
    END
FROM Employees 
```

* * *

## 回答 #5

> 赞同：79
> 
> 时间：2008-09-15T14:37:49.093

使用案例。像这样的东西。

```
SELECT Salable =
        CASE Obsolete
        WHEN 'N' THEN 1
        ELSE 0
    END 
```

* * *

## 回答 #6

> 赞同：51
> 
> 时间：2008-09-15T14:37:44.523

```
SELECT  
(CASE 
     WHEN (Obsolete = 'N' OR InStock = 'Y') THEN 'YES'
                                            ELSE 'NO' 
 END) as Salable
, * 
FROM Product 
```

* * *

## 回答 #7

> 赞同：49
> 
> 时间：2008-09-15T14:40:04.580

微软 SQL 服务器 (T-SQL)

在 a`select`中，使用：

```
select case when Obsolete = 'N' or InStock = 'Y' then 'YES' else 'NO' end 
```

在一个`where`子句中，使用：

```
where 1 = case when Obsolete = 'N' or InStock = 'Y' then 1 else 0 end 
```

* * *

## 回答 #8

> 赞同：49
> 
> 时间：2010-01-06T01:02:08.577

从[这个链接](http://www.databasejournal.com/features/mssql/article.php/3087431/T-SQL-Programming-Part-1---Defining-Variables-and-IFELSE-logic.htm)`IF THEN ELSE`中，我们可以在 T-SQL中理解：

```
IF EXISTS(SELECT *
          FROM   Northwind.dbo.Customers
          WHERE  CustomerId = 'ALFKI')
  PRINT 'Need to update Customer Record ALFKI'
ELSE
  PRINT 'Need to add Customer Record ALFKI'

IF EXISTS(SELECT *
          FROM   Northwind.dbo.Customers
          WHERE  CustomerId = 'LARSE')
  PRINT 'Need to update Customer Record LARSE'
ELSE
  PRINT 'Need to add Customer Record LARSE' 
```

这对 T-SQL 来说还不够好吗？

* * *

## 回答 #9

> 赞同：46
> 
> 时间：2008-09-15T14:37:56.673

```
 SELECT
   CASE 
      WHEN OBSOLETE = 'N' or InStock = 'Y' THEN 'TRUE' 
      ELSE 'FALSE' 
   END AS Salable,
   * 
FROM PRODUCT 
```

* * *

## 回答 #10

> 赞同：32
> 
> 时间：2015-12-17T17:24:10.927

SQL Server 中的简单 if-else 语句：

```
DECLARE @val INT;
SET @val = 15;

IF @val < 25
PRINT 'Hi Ravi Anand';
ELSE
PRINT 'By Ravi Anand.';

GO 
```

SQL Server 中的嵌套 If...else 语句 -

```
DECLARE @val INT;
SET @val = 15;

IF @val < 25
PRINT 'Hi Ravi Anand.';
ELSE
BEGIN
IF @val < 50
  PRINT 'what''s up?';
ELSE
  PRINT 'Bye Ravi Anand.';
END;

GO 
```

* * *

## 回答 #11

> 赞同：24
> 
> 时间：2008-09-15T14:40:26.823

使用 CASE 语句：

```
SELECT CASE
       WHEN (Obsolete = 'N' OR InStock = 'Y')
       THEN 'Y'
       ELSE 'N'
END as Available

etc... 
```

* * *

## 回答 #12

> 赞同：24
> 
> 时间：2016-04-26T15:10:54.010

SQL Server 2012 中添加了一个新功能[IIF](https://msdn.microsoft.com/en-IN/library/hh213574.aspx)（我们可以简单地使用）：

```
SELECT IIF ( (Obsolete = 'N' OR InStock = 'Y'), 1, 0) AS Saleable, * FROM Product 
```

* * *

## 回答 #13

> 赞同：22
> 
> 时间：2013-06-08T22:21:28.753

使用纯位逻辑：

```
DECLARE @Product TABLE (
    id INT PRIMARY KEY IDENTITY NOT NULL
   ,Obsolote CHAR(1)
   ,Instock CHAR(1)
)

INSERT INTO @Product ([Obsolote], [Instock])
    VALUES ('N', 'N'), ('N', 'Y'), ('Y', 'Y'), ('Y', 'N')

;
WITH cte
AS
(
    SELECT
        'CheckIfInstock' = CAST(ISNULL(NULLIF(ISNULL(NULLIF(p.[Instock], 'Y'), 1), 'N'), 0) AS BIT)
       ,'CheckIfObsolote' = CAST(ISNULL(NULLIF(ISNULL(NULLIF(p.[Obsolote], 'N'), 0), 'Y'), 1) AS BIT)
       ,*
    FROM
        @Product AS p
)
SELECT
    'Salable' = c.[CheckIfInstock] & ~c.[CheckIfObsolote]
   ,*
FROM
    [cte] c 
```

请参阅[工作演示：如果`case`在 SQL Server](http://sqlfiddle.com/#!3/0b900/3/0)中没有。

首先，您需要计算选定条件的值`true`和值。`false`这里有两个[NULLIF](https://docs.microsoft.com/en-us/sql/t-sql/language-elements/nullif-transact-sql?view=sql-server-2017)：

```
for true: ISNULL(NULLIF(p.[Instock], 'Y'), 1)
for false: ISNULL(NULLIF(p.[Instock], 'N'), 0) 
```

结合在一起给出 1 或 0。接下来使用[按位运算符](http://msdn.microsoft.com/en-us/library/ms176122.aspx)。

这是最[所见即所得](http://en.wikipedia.org/wiki/WYSIWYG)的方法。

* * *

## 回答 #14

> 赞同：18
> 
> 时间：2016-05-11T15:56:30.827

```
SELECT 1 AS Saleable, *
  FROM @Product
 WHERE ( Obsolete = 'N' OR InStock = 'Y' )
UNION
SELECT 0 AS Saleable, *
  FROM @Product
 WHERE NOT ( Obsolete = 'N' OR InStock = 'Y' ) 
```

* * *

## 回答 #15

> 赞同：16
> 
> 时间：2015-08-25T09:44:46.240

```
SELECT CASE WHEN profile.nrefillno = 0 THEN 'N' ELSE 'R'END as newref
From profile 
```

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2015-12-09T12:15:36.127

```
case statement some what similar to if in SQL server

SELECT CASE 
            WHEN Obsolete = 'N' or InStock = 'Y' 
               THEN 1 
               ELSE 0 
       END as Saleable, * 
FROM Product 
```

* * *

## 回答 #17

> 赞同：12
> 
> 时间：2016-02-11T21:35:21.910

这不是答案，只是我工作时使用的 CASE 语句的一个示例。它有一个嵌套的 CASE 语句。现在你知道为什么我的眼睛是交叉的。

```
 CASE orweb2.dbo.Inventory.RegulatingAgencyName
    WHEN 'Region 1'
        THEN orweb2.dbo.CountyStateAgContactInfo.ContactState
    WHEN 'Region 2'
        THEN orweb2.dbo.CountyStateAgContactInfo.ContactState
    WHEN 'Region 3'
        THEN orweb2.dbo.CountyStateAgContactInfo.ContactState
    WHEN 'DEPT OF AGRICULTURE'
        THEN orweb2.dbo.CountyStateAgContactInfo.ContactAg
    ELSE (
            CASE orweb2.dbo.CountyStateAgContactInfo.IsContract
                WHEN 1
                    THEN orweb2.dbo.CountyStateAgContactInfo.ContactCounty
                ELSE orweb2.dbo.CountyStateAgContactInfo.ContactState
                END
            )
    END AS [County Contact Name] 
```

* * *

## 回答 #18

> 赞同：11
> 
> 时间：2012-10-26T15:30:18.990

如果您是第一次将结果插入表中，而不是将结果从一个表传输到另一个表，这在 Oracle 11.2g 中有效：

```
INSERT INTO customers (last_name, first_name, city)
    SELECT 'Doe', 'John', 'Chicago' FROM dual
    WHERE NOT EXISTS 
        (SELECT '1' from customers 
            where last_name = 'Doe' 
            and first_name = 'John'
            and city = 'Chicago'); 
```

* * *

## 回答 #19

> 赞同：9
> 
> 时间：2018-01-31T11:31:07.450

作为该`CASE`语句的替代解决方案，可以使用表驱动方法：

```
DECLARE @Product TABLE (ID INT, Obsolete VARCHAR(10), InStock VARCHAR(10))
INSERT INTO @Product VALUES
(1,'N','Y'),
(2,'A','B'),
(3,'N','B'),
(4,'A','Y')

SELECT P.* , ISNULL(Stmt.Saleable,0) Saleable
FROM
    @Product P
    LEFT JOIN
        ( VALUES
            ( 'N', 'Y', 1 )
        ) Stmt (Obsolete, InStock, Saleable)
        ON  P.InStock = Stmt.InStock OR P.Obsolete = Stmt.Obsolete 
```

结果：

```
ID          Obsolete   InStock    Saleable
----------- ---------- ---------- -----------
1           N          Y          1
2           A          B          0
3           N          B          1
4           A          Y          1 
```

* * *

## 回答 #20

> 赞同：8
> 
> 时间：2017-08-08T21:33:52.243

```
SELECT CASE WHEN Obsolete = 'N' or InStock = 'Y' THEN 1 ELSE 0 
             END AS Saleable, * 
FROM Product 
```

* * *

## 回答 #21

> 赞同：7
> 
> 时间：2019-02-28T19:09:28.880

您可以有两种选择来实际实施：

1.  使用从 SQL Server 2012 引入的 IIF：

    ```
    SELECT IIF ( (Obsolete = 'N' OR InStock = 'Y'), 1, 0) AS Saleable, * FROM Product 
    ```

2.  使用`Select Case`：

    ```
    SELECT CASE
        WHEN Obsolete = 'N' or InStock = 'Y'
            THEN 1
            ELSE 0
        END as Saleable, *
        FROM Product 
    ```

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2014-01-08T10:18:59.093

对于使用 SQL Server 2012 的用户，IIF 是一项已添加的功能，可替代 Case 语句。

```
SELECT IIF(Obsolete = 'N' OR InStock = 'Y', 1, 0) AS Salable, *
FROM   Product 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2020-11-25T14:04:50.093

```
SELECT
if((obsolete = 'N' OR instock = 'Y'), 1, 0) AS saleable, *
FROM
product; 
```

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2016-11-30T11:05:06.307

```
 SELECT IIF(Obsolete = 'N' OR InStock = 'Y',1,0) AS Saleable, * FROM Product 
```

* * *

## 回答 #25

> 赞同：4
> 
> 时间：2018-11-02T15:44:37.203

问题：

```
SELECT IF(Obsolete = 'N' OR InStock = 'Y' ? 1 : 0) AS Saleable, * FROM Product 
```

ANSI：

```
Select 
  case when p.Obsolete = 'N' 
  or p.InStock = 'Y' then 1 else 0 end as Saleable, 
  p.* 
FROM 
  Product p; 
```

使用别名——`p`在这种情况下——将有助于防止出现问题。

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2020-02-18T10:42:00.440

使用 SQL CASE 就像普通的 If / Else 语句一样。在下面的查询中，如果过时值 = 'N' 或如果 InStock 值 = 'Y' 则输出将为 1。否则输出将为 0。然后我们将 0 或 1 值放在可销售列下。

```
SELECT
      CASE 
        WHEN obsolete = 'N' OR InStock = 'Y' 
        THEN 1 
        ELSE 0 
      END AS Salable
      , * 
FROM PRODUCT 
```

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2019-10-31T12:06:34.417

它会是这样的：

```
SELECT OrderID, Quantity,
CASE
    WHEN Quantity > 30 THEN "The quantity is greater than 30"
    WHEN Quantity = 30 THEN "The quantity is 30"
    ELSE "The quantity is under 30"
END AS QuantityText
FROM OrderDetails; 
```

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2018-10-08T06:34:01.200

```
SELECT 
  CAST(
    CASE WHEN Obsolete = 'N' 
    or InStock = 'Y' THEN ELSE 0 END AS bit
  ) as Saleable, * 
FROM 
  Product 
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2019-11-28T10:17:11.160

为了完整起见，我要补充一点，SQL 使用三值逻辑。表达方式：

```
obsolete = 'N' OR instock = 'Y' 
```

可以产生三个不同的结果：

```
| obsolete | instock | saleable |
|----------|---------|----------|
| Y        | Y       | true     |
| Y        | N       | false    |
| Y        | null    | null     |
| N        | Y       | true     |
| N        | N       | true     |
| N        | null    | true     |
| null     | Y       | true     |
| null     | N       | null     |
| null     | null    | null     | 
```

因此，例如，如果产品已过时，但您不知道产品是否有库存，那么您不知道产品是否可销售。您可以将这个三值逻辑编写如下：

```
SELECT CASE
           WHEN obsolete = 'N' OR instock = 'Y' THEN 'true'
           WHEN NOT (obsolete = 'N' OR instock = 'Y') THEN 'false'
           ELSE NULL
       END AS saleable 
```

一旦弄清楚它是如何工作的，就可以通过决定 null 的行为将三个结果转换为两个结果。例如，这会将 null 视为不可销售：

```
SELECT CASE
           WHEN obsolete = 'N' OR instock = 'Y' THEN 'true'
           ELSE 'false' -- either false or null
       END AS saleable 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2020-04-09T01:31:38.797

我喜欢使用 CASE 语句，但问题要求在 SQL Select 中使用 IF 语句。我过去使用的是：

```
SELECT

   if(GENDER = "M","Male","Female") as Gender

FROM ... 
```

这就像 excel 或工作表 IF 语句，其中有一个条件，然后是真条件，然后是假条件：

```
if(condition, true, false) 
```

此外，您可以嵌套 if 语句（但随后使用应该使用 CASE :-)

（注意：这适用于 MySQLWorkbench，但可能不适用于其他平台）

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2020-05-21T18:44:59.193

您可以使用案例陈述：

```
Select 
Case WHEN (Obsolete = 'N' or InStock = 'Y') THEN 1 ELSE 0 END Saleable,
Product.*
from Product 
```

# .net - 从字符串中拆分出整数

> ID：63463
> 
> 赞同：10
> 
> 时间：2008-09-15T14:35:57.427
> 
> 标签：.net, string, .net-2.0

假设我有一个网页当前通过 url 参数接受单个 ID 值：
[http ://example.com/mypage.aspx?ID=1234](http://example.com/mypage.aspx?ID=1234)

我想将其更改为接受id*列表*，如下所示：
[http ://example.com/mypage.aspx?IDs=1234,4321,6789](http://example.com/mypage.aspx?IDs=1234,4321,6789)

*所以它可以通过context.Request.QueryString["IDs"]*作为字符串提供给我的代码。 将该字符串值转换为 List<int> 的最佳方法是什么？

**编辑：**我知道如何在逗号上执行 .split() 以获取字符串列表，但我问是因为我不知道如何轻松将该字符串列表转换为 int 列表。这仍然在 .Net 2.0 中，所以没有 lambdas。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-15T14:57:42.587

没有冒犯那些提供明确答案的人，但许多人似乎在回答你的问题而不是解决你的问题。你想要多个 ID，所以你认为你可以这样：

[http://example.com/mypage.aspx?IDs=1234,4321,6789](http://example.com/mypage.aspx?IDs=1234,4321,6789)

问题是这是一个不可靠的解决方案。以后如果你想要多个值，如果它们有逗号怎么办？更好的解决方案（这在查询字符串中完全有效）是使用具有相同名称的多个参数：

[http://example.com/mypage.aspx?ID=1234;ID=4321;ID=6789](http://example.com/mypage.aspx?ID=1234;ID=4321;ID=6789)

然后，您使用的任何查询字符串解析器都应该能够返回 ID 列表。如果它不能处理这个（并且也处理分号而不是＆符号），那么它就坏了。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-15T14:47:43.470

像这样的东西可能会起作用：

```
public static IList<int> GetIdListFromString(string idList)
{
    string[] values = idList.Split(',');

    List<int> ids = new List<int>(values.Length);

    foreach (string s in values)
    {
        int i;

        if (int.TryParse(s, out i))
        {
            ids.Add(i);
        }
    }

    return ids;
} 
```

然后将使用它：

```
string intString = "1234,4321,6789";

IList<int> list = GetIdListFromString(intString);

foreach (int i in list)
{
    Console.WriteLine(i);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T14:42:48.597

您可以从数组中实例化 List<T>。

VB.NET：

```
Dim lstIDs as new List(of Integer)(ids.split(',')) 
```

如果数组包含非 int 元素，这很容易出现转换错误

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T14:40:53.267

我能想到的就是循环遍历字符串列表（您从执行拆分中获得）并`int.TryParse()`一个接一个地对它们执行类似操作并将它们放入一个新的`List<int>`. 将它封装在某个地方的一个不错的小助手方法中，它不会太可怕。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T14:52:17.810

如果你喜欢功能风格，你可以尝试类似

```
 string ids = "1,2,3,4,5";

    List<int> l = new List<int>(Array.ConvertAll(
        ids.Split(','), new Converter<string, int>(int.Parse))); 
```

没有 lambda，但你确实有转换器和谓词以及其他可以由方法制成的好东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-15T15:16:28.017

我看到[我的答案](https://stackoverflow.com/questions/63463/split-out-ints-from-string#63649)来得太晚了，即其他几个人也写了同样的。因此，我提出了一种使用正则表达式来验证和划分字符串的替代方法。

```
class Program
{
    //Accepts one or more groups of one or more digits, separated by commas.
    private static readonly Regex CSStringPattern = new Regex(@"^(\d+,?)*\d+$");

    //A single ID inside the string. Must only be used after validation
    private static readonly Regex SingleIdPattern = new Regex(@"\d+");

    static void Main(string[] args)
    {
        string queryString = "1234,4321,6789";

        int[] ids = ConvertCommaSeparatedStringToIntArray(queryString);
    }

    private static int[] ConvertCommaSeparatedStringToIntArray(string csString)
    {
        if (!CSStringPattern.IsMatch(csString))
            throw new FormatException(string.Format("Invalid comma separated string '{0}'",
                                                    csString));

        List<int> ids = new List<int>();
        foreach (Match match in SingleIdPattern.Matches(csString))
        {
            ids.Add(int.Parse(match.Value)); //No need to TryParse since string has been validated
        }
        return ids.ToArray();
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T14:45:29.310

split 是首先想到的，但它返回一个数组，而不是一个列表；你可以尝试类似的东西：

```
 List<int> intList = new List<int>;

foreach (string tempString in ids.split(',')
{
    intList.add (convert.int32(tempString));
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T15:01:27.663

最终的代码片段，我希望从所有建议中得到最好的：

```
Function GetIDs(ByVal IDList As String) As List(Of Integer)
    Dim SplitIDs() As String = IDList.Split(new Char() {","c}, StringSplitOptions.RemoveEmptyEntries)
    GetIDs = new List(Of Integer)(SplitIDs.Length)
    Dim CurID As Integer
    For Each id As String In SplitIDs
        If Integer.TryParse(id, CurID) Then GetIDs.Add(CurID)
    Next id
End Function 
```

我希望能够在一两行内联代码中做到这一点。一行来创建字符串数组，并希望在框架中找到一些我还不知道的东西来处理将它导入到可以智能地处理强制转换的 List<int> 。但是，如果我必须将其移至方法，那么我会的。是的，我正在使用 VB。我只是更喜欢 C# 来提问，因为它们会吸引更多的听众，而且我的流利程度也差不多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-15T14:37:17.673

从 URL 中提取值后，您可以使用 string.Split() 来拆分它们。

```
string[] splitIds = ids.split(','); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T14:41:46.867

您只需要遍历它们并 int.TryParse 中的每一个。之后只需添加到列表中。

没关系 - @Splash 打败了我

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T14:50:09.500

```
List<int> convertIDs = new List<int>;
string[] splitIds = ids.split(',');
foreach(string s in splitIds)
{
    convertIDs.Add(int.Parse(s));
} 
```

为了完整起见，您需要在 for 循环周围（或在 int.Parse() 调用周围）放置 try/catch，并根据您的要求处理错误。您也可以像这样执行 tryparse()：

```
List<int> convertIDs = new List<int>;
string[] splitIds = ids.split(',');
foreach(string s in splitIds)
{
    int i;
    int.TryParse(out i);
    if (i != 0)
       convertIDs.Add(i);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T14:50:45.647

要继续上一个答案，只需遍历 Split 返回的数组并转换为新的整数数组。下面的 C# 示例：

```
 string[] splitIds = stringIds.Split(',');

        int[] ids = new int[splitIds.Length];
        for (int i = 0; i < ids.Length; i++) {
            ids[i] = Int32.Parse(splitIds[i]);
        } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T14:57:16.440

我认为最简单的方法是如前所示进行拆分，然后循环遍历这些值并尝试转换为 int。

```
class Program
{
    static void Main(string[] args)
    {
        string queryString = "1234,4321,6789";

        int[] ids = ConvertCommaSeparatedStringToIntArray(queryString);
    }

    private static int[] ConvertCommaSeparatedStringToIntArray(string csString)
    {
        //splitting string to substrings
        string[] idStrings = csString.Split(',');

        //initializing int-array of same length
        int[] ids = new int[idStrings.Length];

        //looping all substrings
        for (int i = 0; i < idStrings.Length; i++)
        {
            string idString = idStrings[i];

            //trying to convert one substring to int
            int id;
            if (!int.TryParse(idString, out id))
                throw new FormatException(String.Format("Query string contained malformed id '{0}'", idString));

            //writing value back to the int-array
            ids[i] = id;
        }

        return ids;
    }
} 
```

# python - 在松散连接的团队中，哪个是最有用的 Mercurial 钩子？

> ID：63488
> 
> 赞同：-1
> 
> 时间：2008-09-15T14:38:58.763
> 
> 标签：python, mercurial, hook

我最近在 Mercurial 中发现了通知扩展，它允许我在推送更改时快速发送电子邮件，但我很确定我仍然错过了许多可以让我的生活更轻松的功能。

*   通知扩展：[https ://www.mercurial-scm.org/wiki/NotifyExtension](https://www.mercurial-scm.org/wiki/NotifyExtension)

哪个 Mercurial 挂钩或互操作挂钩的组合对于在松散连接的团队中工作最有用？

请添加指向您使用的非标准部件的链接和/或添加挂钩（或说明如何设置它），以便其他人可以轻松使用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T14:56:06.723

我真的很喜欢我用我的自定义钩子所做的事情。我让它向我的 campfire 帐户发布消息（campfire 是一个基于组的应用程序）。结果真的很好。因为我有我的客户在那里，它可以向他展示我的进步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T14:52:58.417

看看 hgweb 的东西。您可以设置 RSS 提要并查看所有修订等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-01T11:13:07.403

我写了一小部分可能很有趣的小钩子：http: [//fellowiki.org/hg/support/quecksilber/file/](http://fellowiki.org/hg/support/quecksilber/file/)

无论如何，这些是对我最有用的钩子;-)

# c++ - 有人在现实生活中使用模板元编程吗？

> ID：63494
> 
> 赞同：33
> 
> 时间：2008-09-15T14:39:31.757
> 
> 标签：c++, templates, template-meta-programming

我在 5 年多前发现了[模板元编程，并从阅读](http://en.wikipedia.org/wiki/Template_metaprogramming)[现代 C++ 设计](https://rads.stackoverflow.com/amzn/click/com/0201704315)中获得了巨大的乐趣，但我从未找到在现实生活中使用它的机会。

您*是否*曾经在实际代码中使用过这种技术？

> [Boost](http://www.boost.org/)的贡献者无需申请；o)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-09-15T14:46:23.033

我曾经在 C++ 中使用模板元编程来实现一种称为“符号扰动”的技术，用于处理几何算法中的退化输入。通过将算术表达式表示为嵌套模板（即基本上通过手动写出解析树），我能够将所有表达式分析交给模板处理器。

用模板做这种事情比使用对象编写表达式树并在运行时进行分析更有效。它更快，因为修改后的（扰动的）表达式树可以在与您的其余代码相同的级别上提供给优化器，因此您可以获得优化的全部好处，无论是在您的表达式中，还是（在可能的情况下）在您的表达式和周围的代码。

当然，您可以通过为您的表达式实现一个小型 DSL（领域特定语言）并将翻译后的 C++ 代码粘贴到您的常规程序中来完成同样的事情。这将为您带来所有相同的优化优势并且更加清晰 - 但权衡是您必须维护解析器。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-21T14:01:14.273

我发现现代 C++ 设计中描述的策略在两种情况下非常有用：

1.  当我开发一个组件时，我希望它会被重用，但方式略有不同。Alexandrescu 提出的使用策略来反映设计的建议在这里非常适合 - 它帮助我解决了过去的问题，例如“我可以使用后台线程来执行此操作，但如果以后有人想在时间片中执行此操作怎么办？” 好的，我只是编写我的类来接受 ConcurrencyPolicy 并实现我目前需要的。然后，至少我知道支持我的人可以在需要时编写并插入新策略，而无需完全重新设计我的设计。警告：有时我必须控制自己，否则这可能会失控——记住[YAGNI](http://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it "雅尼")原则！

2.  当我试图将几个类似的代码块重构为一个时。通常代码会被复制粘贴和稍微修改，因为否则它会有太多的 if/else 逻辑，或者因为涉及的类型太不同。我发现策略通常允许一个干净的万能版本，而传统逻辑或多重继承则不允许。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-15T14:44:35.567

我在游戏图形代码的内部循环中使用了它，您需要某种程度的抽象和模块化，但无法支付分支或虚拟调用的成本。总的来说，它是一个比大量手写特殊情况函数更好的解决方案。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-16T04:31:41.960

模板元编程和表达式模板作为优化方法在科学界变得越来越流行，它们将一些计算工作卸载到编译器上，同时保持一些抽象。生成的代码较大且可读性较差，但我已使用这些技术来加速 FEM 库中的线性代数库和求积方法。

对于特定于应用程序的阅读，[Todd Veldhuizen](http://ubiety.uwaterloo.ca/~tveldhui/)是该领域的知名人士。一本流行的书是Daoqi Yang 的[C++ and Object Oriented Numeric Computing for Scientists and Engineers](http://www.math.wayne.edu/~yang/book.htm)。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2010-08-27T16:59:55.603

在编写 c++***库***时，模板元编程是一种奇妙而强大的技术。我在自定义解决方案中使用过几次，但通常不太优雅的旧式 c++ 解决方案更容易通过代码审查并且更容易为其他用户维护。

但是，在编写可重用的组件/库时，我已经从模板元编程中获得了很多成果。我说的不是 Boost 的一些大的东西，只是会经常重用的小组件。

我将 TMP 用于单例系统，用户可以在其中指定他们想要的单例类型。界面非常基本。在它下面由重型 TMP 提供动力。

```
template< typename T >
T& singleton();

template< typename T >
T& zombie_singleton();

template< typename T >
T& phoenix_singleton(); 
```

另一个成功的用途是简化我们的 IPC 层。它是使用经典的 OO 风格构建的。每条消息都需要从一个抽象基类派生并覆盖一些序列化方法。没什么太极端的，但它会生成很多样板代码。

我们向它扔了一些 TMP，并自动生成了仅包含 POD 数据的简单消息案例的所有代码。TMP 消息仍然使用 OO 后端，但它们大大减少了样板代码的数量。TMP 还用于生成消息访问者。随着时间的推移，我们所有的消息都迁移到了 TMP 方法。为消息传递构建一个简单的 POD 结构并添加使 TMP 生成类所需的几行（可能是 3 行）比派生新消息以通过 IPC 发送常规类更容易且代码更少框架。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-11T00:22:29.280

我一直使用模板元编程，但在 D 中，而不是 C++。C++ 的模板元语言最初是为简单的类型参数化而设计的，几乎是偶然地成为图灵完备的元语言。因此，它是只有 Andrei Alexandrescu 而不仅仅是凡人可以使用的 Turing tarpit。

另一方面，D 的模板子语言实际上是为超越简单类型参数化的元编程而设计的。Andrei Alexandrescu[似乎很喜欢它，](http://digitalmars.com/d/2.0/phobos/std_algorithm.html)但其他人实际上可以理解他的 D 模板。它也足够强大，有人在其中编写了一个[编译时光线跟踪器](http://h3.team0xf.com/ctrace/)作为概念证明。

我猜我在 D 中写过的最有用/最重要的元程序是一个函数模板，它给定一个结构类型作为模板参数和一个列标题名称列表，其顺序与作为运行时的结构中的变量声明相对应参数，将读入一个 CSV 文件，并返回一个结构数组，每行一个，每个结构字段对应一列。所有类型转换（字符串到浮点数、整数等）都是根据模板字段的类型自动完成的。

另一个很好的，主要工作，但仍然不能正确处理少数情况，是正确处理结构、类和数组的深拷贝函数模板。它仅使用编译时反射/自省，因此它可以与结构一起使用，与成熟的类不同，它在 D 中没有运行时反射/自省功能，因为它们应该是轻量级的。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-16T17:34:10.080

大多数使用模板元编程的程序员通过 boost 之类的库间接使用它。他们甚至可能不知道幕后发生了什么，只知道它使某些操作的语法变得更加容易。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-06-16T06:54:58.140

我已经将它用于 DSP 代码，尤其是 FFT、固定大小的循环缓冲区、hadamard 变换等。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2010-11-30T09:25:59.270

对于那些熟悉 Oracle 模板库 ( [OTL](http://otl.sourceforge.net/) )、boost::any 和[Loki](http://loki-lib.sourceforge.net/)库（现代 C++ 设计中描述的库）的人，这里是概念证明 TMP 代码，它使您能够在容器中存储一行 otl_stream 并按`vector<boost::any>`列访问数据数字。“是的”，我将把它合并到生产代码中。

```
#include <iostream>
#include <vector>
#include <string>
#include <Loki/Typelist.h>
#include <Loki/TypeTraits.h>
#include <Loki/TypeManip.h>
#include <boost/any.hpp>
#define OTL_ORA10G_R2
#define OTL_ORA_UTF8
#include <otlv4.h>

using namespace Loki;

/* Auxiliary structs */
template <int T1, int T2>
struct IsIntTemplateEqualsTo{
    static const int value = ( T1 == T2 );
};

template <int T1>
struct ZeroIntTemplateWorkaround{
    static const int value = ( 0 == T1? 1 : T1 );
};

/* Wrapper class for data row */
template <class TList>
class T_DataRow;

template <>
class T_DataRow<NullType>{
protected:
    std::vector<boost::any> _data;
public:
    void Populate( otl_stream& ){};
};

/* Note the inheritance trick that enables to traverse Typelist */
template <class T, class U>
class T_DataRow< Typelist<T, U> >:public T_DataRow<U>{
public:
    void Populate( otl_stream& aInputStream ){
        T value;
        aInputStream >> value;
        boost::any anyValue = value;
        _data.push_back( anyValue );

        T_DataRow<U>::Populate( aInputStream );
    }

    template <int TIdx>
    /* return type */
    Select<
        IsIntTemplateEqualsTo<TIdx, 0>::value,
        typename T,
        typename TL::TypeAt<
            U,
            ZeroIntTemplateWorkaround<TIdx>::value - 1
        >::Result
    >::Result
    /* sig */
    GetValue(){
    /* body */
        return boost::any_cast<
            Select<
                IsIntTemplateEqualsTo<TIdx, 0>::value,
                typename T,
                typename TL::TypeAt<
                    U,
                    ZeroIntTemplateWorkaround<TIdx>::value - 1
                >::Result
            >::Result
        >( _data[ TIdx ] );
    }
};

int main(int argc, char* argv[])
{
    db.rlogon( "AMONRAWMS/WMS@amohpadb.world" ); // connect to Oracle
    std::cout<<"Connected to oracle DB"<<std::endl;
    otl_stream o( 1, "select * from blockstatuslist", db );

    T_DataRow< TYPELIST_3( int, int, std::string )> c;
    c.Populate( o );
    typedef enum{ rcnum, id, name } e_fields; 
    /* After declaring enum you can actually acess columns by name */
    std::cout << c.GetValue<rcnum>() << std::endl;
    std::cout << c.GetValue<id>() << std::endl;
    std::cout << c.GetValue<name>() << std::endl;
    return 0;
}; 
```

对于那些不熟悉提到的库的人。

`operator >>`OTL 的 otl_stream 容器的问题在于，通过声明适当类型的变量并以下列方式应用到 otl_stream 对象，只能按顺序访问列数据：

```
otl_stream o( 1, "select * from blockstatuslist", db );
int rcnum; 
int id;
std::string name;
o >> rcnum >> id >> name; 
```

这并不总是很方便。解决方法是编写一些包装类并用来自 otl_stream 的数据填充它。希望能够声明列类型列表，然后：

*   取列的类型 T
*   声明该类型的变量
*   申请`olt_stream::operator >>(T&)`
*   存储结果（在 boost::any 的向量中）
*   取下一列的类型并重复，直到处理完所有列

您可以借助 Loki 的`Typelist`结构、模板特化和继承来完成所有这些工作。

借助 Loki 的库结构，您还可以生成一堆 GetValue 函数，这些函数返回适当类型的值，从列号（实际上是 in 类型的数量`Typelist`）推导出来。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-12T18:31:25.800

问这个问题将近 8 个月后，我终于使用了一些 TMP，我使用接口的[TypeList](http://www.ddj.com/cpp/184403813)以便在基类中实现 QueryInterface。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-06-17T23:43:11.213

我将它与 boost::statechart 一起用于大型状态机。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-15T14:51:40.323

是的，当我将遗留 API 包装在更现代的 C++ 接口中时，主要是做一些类似于鸭子打字的事情。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-15T15:09:24.743

不，我没有在生产代码中使用它。

为什么？

1.  我们必须使用*本机* *平台*编译器支持 6 个以上的平台。在这种环境中使用 STL 已经够难了，更不用说现代模板技术了。
2.  开发人员似乎不再跟上 C++ 的进步。我们在必要时使用 C++。我们有遗留代码和遗留设计。新代码以其他方式完成，例如 Java、Javascript、Flash。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-09-16T17:50:11.073

不要那样做。其背后的原因如下：根据模板元编程的性质，如果您的逻辑的某些部分是在编译时完成的，那么它所依赖的每个逻辑也必须在编译时完成。一旦你启动它，在编译时执行你的逻辑的一部分，没有回报。雪球会继续滚动，没有办法阻止它。

例如，您不能迭代 boost::tuple<> 的元素，因为您只能在编译时访问它们。您必须使用模板元编程来实现原本简单直接的 C++，而当 C++ 的用户不够小心，没有在编译时移动太多东西时，*总是会发生这种情况。*有时很难看出编译时逻辑的某种使用何时会出现问题，有时程序员渴望尝试测试他们在 Alexandrescu 中读到的内容。无论如何，在我看来，这是一个非常糟糕的主意。

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2008-09-15T17:52:50.607

直到最近，由于对编译器的支持很差，许多程序员很少使用模板。然而，虽然模板在过去有很多问题，但较新的编译器有更好的支持。我编写的代码必须与 Mac 和 Linux 上的 GCC 以及 Microsoft Visual C++ 一起工作，而且只有 GCC 4 和 VC++ 2005 才能使这些编译器很好地支持该标准。

通过模板进行通用编程并不是您一直需要的东西，但绝对是您工具箱中有用的代码。

显而易见的示例容器类，但模板也可用于许多其他事情。我自己工作的两个例子是：

*   智能指针（例如引用计数、写时复制等）
*   数学支持类，如矩阵、向量、样条线等，需要支持多种数据类型并且仍然高效。

# jsf - 是否有任何生成语义和跨浏览器 html 标记的 JSF 组件库？

> ID：63509
> 
> 赞同：3
> 
> 时间：2008-09-15T14:40:55.653
> 
> 标签：jsf, semantic-markup

我根据客户的要求使用 RichFaces，但是它（和股票 JSF 控件）生成的标记是嵌套表的一大堆。是否有任何控件库可以生成更好的标记？AJAX 支持是一个巨大的优势！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T05:11:37.353

有 ICEFaces 提供比 RichFaces 更多的语义支持。您也可以尝试 Nitobi 套件，它也提供类似的解决方案。如果您对其中任何一个不满意，我建议您尝试编写自己的部分来扩展 Sun 面孔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T13:22:12.840

简短的回答：不，我还没有找到。您的选择包括使用不太复杂的控件并了解标准控件发出的 html。像 h:panelGrid 这样的东西呈现为一个表格。没有什么可以阻止您编写自己的渲染系列来生成更多标准的 html，但这将是一笔巨大的时间投资。至于使用 RichFaces，如果您更多地使用 a4j: 标签命名空间，您仍然会获得跨浏览器 ajax，而没有您不喜欢的所有标记。

# c# - C# 和 VB 之间的 Visual Studio 2005 中的 Intellisense - 无法导航到定义

> ID：63517
> 
> 赞同：2
> 
> 时间：2008-09-15T14:41:39.333
> 
> 标签：c#, vb.net, visual-studio, intellisense

当您将 C# 和 VB 项目组合在一个解决方案中时，MS 无法正确导航到方法的定义，这让我感到非常震惊。如果您尝试从 VB 导航到 C#，它会打开“对象资源管理器”，如果从 C# 导航到 VB，它会生成一个元数据文件。

老实说，在不同语言之间跳转有什么复杂的，尤其是如果它们使用相同的 CLR 的话？

有谁知道这是为什么，或者是否有任何解决方法？他们在 VS 2008 中做对了吗？

* * *

@Keith，恐怕您的回答可能是对的。我真的很震惊，微软把这件事搞砸了。有没有人有任何解决方法的想法？

* * *

@Mladen Mihajlovic - 这正是我所描述的情况。自己尝试一下；项目引用没有任何区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T14:47:30.503

这对两种语言都是通用的。

*   VB.Net 中的 F12 始终带您进入对象浏览器
*   C# 中的 F12 始终带您进入元数据定义

这是一种经过深思熟虑的机制，旨在尝试匹配升级用户的预期行为。C# 方式为您提供正确的信息，但 VB 方式是 VBA 或 VB6 用户所期望的。

VS2008 中的行为是相同的。

这些是外部项目的规则，如果它在同一个解决方案中，两者都应该带你去代码。

* * *

你是对的 - VB 项目将 C# 项目视为外部项目，反之亦然 - 你无法从一个代码导航到另一个代码。我已经在最新的 VS2008 中对此进行了测试，但它仍然是一个问题。

它也无法获得完整的元数据。在您的 C# 代码中添加一个方法，在您编译 C# 程序集之前，它不会出现在 VB 的智能感知中。

这类似于组件在工具条中的显示方式，因此我认为正常导航到代码功能是具有通用编译器的代码功能，其他一切都使用某种反射。

只要您仍在构建 PDB，它就应该能够找到文件，我想它不会，因为他们也需要它来支持发布版本。如果没有 PDB 查找，它就找不到代码行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-16T10:11:12.970

确保您引用的是 VB*项目*，而不仅仅是 DLL 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-19T10:01:48.197

[这是一个已知问题](https://connect.microsoft.com/VisualStudio/feedback/details/501303/find-all-references-go-to-definition-do-not-work-across-vb-c-in-same-solution#)，解决方法有两种：使用`ctrl+,`或使用一些添加此功能的插件，例如 resharper（将在 .xml 中添加此功能`F12`）。

# c# - VS2005 C# 以编程方式更改 app.config 中包含的连接字符串

> ID：63546
> 
> 赞同：9
> 
> 时间：2008-09-15T14:45:47.013
> 
> 标签：c#, .net, winforms, configuration

想以编程方式更改数据库的连接字符串，该数据库在 Windows 应用程序中利用 asp.net 的成员资格提供程序。system.configuration 命名空间允许更改用户设置，但是，我们想调整应用程序设置吗？是否需要使用 XML 编写一个类来修改该类？是否需要删除当前连接（可以选择一个连接清除）并添加一个新连接？可以调整现有的连接字符串吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-01-09T22:49:19.320

不得不做这件事。这是对我有用的代码：

```
var config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
var connectionStringsSection = (ConnectionStringsSection)config.GetSection("connectionStrings");
connectionStringsSection.ConnectionStrings["Blah"].ConnectionString = "Data Source=blah;Initial Catalog=blah;UID=blah;password=blah";
config.Save();
ConfigurationManager.RefreshSection("connectionStrings"); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-15T14:59:49.307

```
// Get the application configuration file.
System.Configuration.Configuration config =
        ConfigurationManager.OpenExeConfiguration(
        ConfigurationUserLevel.None);

// Create a connection string element and
// save it to the configuration file.

// Create a connection string element.
ConnectionStringSettings csSettings =
        new ConnectionStringSettings("My Connection",
        "LocalSqlServer: data source=127.0.0.1;Integrated Security=SSPI;" +
        "Initial Catalog=aspnetdb", "System.Data.SqlClient");

// Get the connection strings section.
ConnectionStringsSection csSection =
    config.ConnectionStrings;

// Add the new element.
csSection.ConnectionStrings.Add(csSettings);

// Save the configuration file.
config.Save(ConfigurationSaveMode.Modified); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-15T14:50:11.513

您可以使用 System.configuration 命名空间以编程方式打开配置：

`Configuration myConfig = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);`

然后您可以在以下位置访问连接字符串集合：

`myConfig.ConnectionStrings.ConnectionStrings`

您可以根据需要修改集合，并在完成后调用`.Save()`配置对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T14:56:13.760

使用 ConnectionStringsSection 类。该文档甚至提供了一个示例，说明如何创建新的 ConnectionString 并让框架将其保存到配置文件中，而无需实现整个 XML shebang。

请参阅[此处](http://msdn.microsoft.com/en-us/library/system.configuration.connectionstringssection(VS.80).aspx)并向下浏览以获取示例。

# c# - c# 带有重复代码的属性

> ID：63556
> 
> 赞同：5
> 
> 时间：2008-09-15T14:46:56.917
> 
> 标签：c#, properties, attributes

我有一个类有一堆看起来像这样的属性：

```
public string Name
{
    get { return _name; }
    set { IsDirty = true; _name = value; }
} 
```

如果我可以依靠 C# 3.0 为这些生成后备存储，那会容易得多，但是有什么方法可以排除 IsDirty=true; 这样我就可以编写类似这样的属性并且仍然得到相同的行为：

```
[MakesDirty]
public string Name { get; set; } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T14:55:11.483

**不。不是没有写比原始版本更多的（神秘的？）代码**（你必须使用反射来检查属性上的属性，什么不是......我提到它'慢'）..这是我可以忍受的那种重复。

[当属性发生变化时](http://msdn.microsoft.com/en-us/library/ms229614.aspx)，MS 也同样需要引发事件。INotifyPropertyChanged 是更改通知的重要接口。我见过的每个实现都可以

```
set
{ 
  _name = value; 
  NotifyPropertyChanged("Name"); 
} 
```

如果可能的话，我认为 MS 的那些聪明人已经有了类似的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T14:47:55.323

您可以尝试设置一个代码片段来轻松创建它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T15:12:47.650

如果您真的想这样做，使用属性来修改代码所做的事情，有一些方法可以做到，它们都与 AOP（面向方面​​的编程）有关。查看[PostSharp](http://www.postsharp.org/)，它是一个后编译器，可以在编译后的步骤中修改您的代码。例如，您可以为您的属性（或方面，它在 AOP 中的调用方式）设置一个自定义属性，该属性将代码注入属性设置器中，将您的对象标记为脏。如果您想了解如何实现这一点的一些示例，您可以查看他们的[教程](http://www.postsharp.org/about/getting-started/)。

*但是要小心 AOP，因为如果使用不当，您可以轻松地使用它来创建更多您试图解决的问题。*

有更多的 AOP 框架，一些使用后编译，一些使用 .Net 中存在的方法拦截机制，与第一个相比，后者有一些性能缺陷。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T15:00:05.607

不，当您使用自动属性时，您无法控制实现。最好的选择是使用模板工具、代码片段或创建`<T`封装 setter 逻辑的私有 SetValue >(ref T backingField, T value)。

```
private void SetValue<T>(ref T backingField, T value)
{
   if (backingField != value)
   {
      backingField = value;
      IsDirty = true;
   }
}

public string Name
{
   get
   {
      return _name;
   }
   set
   {
      SetValue(ref _name, value);
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T14:52:15.750

另一种选择可能是代码生成器，例如 codesmith 来自动创建属性。如果您创建的属性是数据库表中的列，这将特别有用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T14:54:37.430

上下文绑定对象。如果创建扩展上下文绑定对象的类并创建 ContextAttribute，则可以拦截对此类属性的调用并设置 IsDirty。.NET 将为您的类创建一个代理，因此所有调用都通过远程接收器之类的东西。

这种方法的问题在于，只有在外部调用时才会调用您的代理。我给你举个例子。

```
class A
{
    [Foo]
    public int Property1{get; set;}
    public int Property2{get {return variable;} set{ Property1 = value; variable = value; }
} 
```

当从另一个类调用 property1 时，将调用您的代理。但是如果另一个类调用property2，即使property2 的集合将调用property1，也不会调用代理（当您在类中时不需要代理）。

有很多使用 ContextBoundObjects 的示例代码，请查看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T14:56:40.983

为此，我可以推荐使用[Enterprise Library](http://www.codeplex.com/entlib)。例如，每当您输入/退出方法时，策略应用程序块都会提供基础架构来执行“某事”（某事 = 您可以自己编写代码）。您可以使用属性控制行为。以此为提示，详细了解企业库的文档。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T14:59:16.297

有一个可以分配给属性的 DefaultValueAttribute，这主要由设计器工具使用，因此它们可以指示属性何时更改，但是，它可能是描述属性默认值的一种“整洁”方式，从而能够识别它是否已更改。

您需要使用反射来识别属性更改 - 这实际上并没有*那么*昂贵，除非您做很多事情！

警告：您无法判断属性是否已从非默认值更改为默认值。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-15T15:03:30.467

我想说解决这个问题的最好方法是使用面向方面的编程（AOP）。Mats Helander[在 InfoQ 上对此](http://www.infoq.com/articles/aspects-of-domain-model-mgmt)做了一篇文章。这篇文章有点乱，但可以遵循。有许多不同的产品在 .NET 空间中执行 AOP，我推荐 PostSharp。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T15:08:10.067

如果您确实使用属性，我相当肯定您将不得不[滚动自己的逻辑](http://www.csharphelp.com/archives/archive119.html)来推断它们的含义以及如何处理它们。无论使用您的自定义类对象，都必须有一种方法来执行这些属性操作/检查，最好是在实例化时。

否则，您正在考虑使用可能的事件。您仍然必须将事件添加到每个 set 方法，但这样做的好处是您无需硬编码如何处理每个属性上的脏集，并且可以在一个地方控制要做什么。这至少会引入更多的代码重用。

# windows - 使用 Windows 媒体格式 (WMF) 捕获桌面

> ID：63563
> 
> 赞同：2
> 
> 时间：2008-09-15T14:47:53.593
> 
> 标签：windows, winapi, wmf

我正在使用[Windows Media Format SDK](http://msdn.microsoft.com/en-us/library/aa387410(VS.85).aspx)实时捕获桌面并将其保存在 WMV 文件中（实际上这是对我的项目的过度简化，但这是相关部分）。对于编码，我使用的是[Windows Media Video 9 Screen](http://www.microsoft.com/windows/windowsmedia/forpros/codecs/video.aspx#WindowsMediaVideo9Screen)编解码器，因为它对于屏幕捕获非常有效，而且几乎所有人都可以使用它而无需安装任何东西，因为编解码器包含在 Windows Media Player 9 运行时（包含在Windows XP SP1)。

我正在使用 GDI 功能制作 BITMAP 屏幕截图，并将这些 BITMAP 提供给编码器。您可以猜到，使用 GDI 进行屏幕截图很慢，而且我没有得到屏幕光标，我必须手动将其添加到 BITMAP。我最初得到的 BITMAP 是 DDB，我需要将它们转换为 DIB 以便编码器理解（RGB 输入），这需要更多时间。

启动分析器显示大约 50% 的时间花在编码器 WMVCORE.DLL 中。这是意料之中的，当然，因为编码是 CPU 密集型的。

问题是，有一个叫做[Windows Media Encoder](http://www.microsoft.com/windows/windowsmedia/forpros/encoder/default.mspx)的东西，它带有一个 SDK，可以使用所需的编解码器以更简单、更 CPU 友好的方式进行屏幕捕获。

WME 基于 WMF。它是一个更高级别的库，并且还具有 .NET 绑定。我不能在我的项目中使用它，因为这会带来我必须避免的不需要的依赖项。

我在询问 WME 用于将样本数据提供给 WMV 编码器的方法。编码发生在 WME 中，就像它发生在我使用 WMF 的应用程序中一样。WME 比我的应用程序更高效，因为它有一种更有效的方式将视频数据提供给编码器。它不依赖缓慢的 GDI 函数和 DDB->DIB 转换。

它是如何完成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-21T11:31:26.413

CamStudio 的源代码，这是一个 GPL 的截屏应用程序，已经存在多年（商业化，然后是后来的 open-srcd）可能有用吗？

[http://sourceforge.net/project/showfiles.php?group_id=131922](http://sourceforge.net/project/showfiles.php?group_id=131922)

我建议也查看 VNC 客户端的内容，尽管它们可能非常简单（我认为只需抓取屏幕截图然后 jpg'ing 自上次捕获以来发生变化的图块）。

如果 WMV9 占用过多 CPU，您可能要考虑不使用 WMV9 作为即时编码的编码器？也许使用 HyperCam 使用的旧的、效率较低的压缩器（如 MS RLE），然后再压缩为 WMV？MS RLE 至少自 Win2000 以来一直是默认安装，我相信： [http ://wiki.multimedia.cx/index.php?title=Microsoft_RLE](http://wiki.multimedia.cx/index.php?title=Microsoft_RLE)

CamStudio 的无损编解码器是 GPL（与上面的链接相同），它提供了非常好的压缩（尽管您需要在安装程序中捆绑 dll）并且可以即时使用，它适用于所有现代系统的高压缩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T18:29:36.410

你检查过[BB FlashBack](http://www.bbsoftware.co.uk/BBFlashBack/Home.aspx)库吗？

我也在寻找类似的东西，我刚刚开始评估 BB FlashBack 库。

我不确定外部依赖项或安装足迹。它似乎有一个必须安装的专有编解码器，但编解码器的安装可以由暴露的 BB FlashBack API 处理。

请注意，存在许可限制（许可证密钥的运行时设置，...）

如果您想在提交许可下载之前评估 API，我可以通过电子邮件将 SDK 中的 CHM 发送给您。

我正在评估的事情： 正确捕获 WPF 视图 鼠标光标跟踪 存储电影的大小 如何在没有专有编解码器的情况下显示存储的电影（即 SWF 导出）

——巴特加

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T01:42:08.637

自从我完成任何 Win32 编码以来已经有很长时间了，但是 AFAIK，WMF 作为一种格式基本上是 GDI 命令及其参数的列表，这可以解释为什么编码效率更高......

您可能需要连接到顶级 GDI 上下文（就像远程桌面一样，我猜）并在调用 GDI 命令时捕获它们。我似乎记得有某种方法可以创建 WMF 输出 GDI 上下文，这意味着您可以通过某种方式将调用委托给它。

我在这里猜测，但您可能能够在 Windows 项目的 TightVNC/QuickVNC 中找到上述示例代码，因为他们必须执行类似的操作才能以有效的方式捕获屏幕上的更改。

# javascript - Unobtrusive Javascript：如果启用了 Javascript，则删除链接

> ID：63581
> 
> 赞同：1
> 
> 时间：2008-09-15T14:50:34.303
> 
> 标签：javascript

我正在使用[PopBox](http://www.c6software.com/Products/PopBox/)放大页面上的缩略图。但我希望我的网站即使对于关闭 javascript 的用户也能正常工作。

我尝试使用以下 HTML 代码：

```
<a href="image.jpg">
     <img src="thumbnail.jpg" pbsrc="image.jpg" onclick="Pop(...);"/>
</a> 
```

现在我需要使用 javascript 禁用 a-Tag，否则我的 PopBox 将无法工作。

我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T14:53:37.323

将 onclick 事件放在链接本身上，如果您不希望执行默认行为（要遵循的链接），则从处理程序返回 false

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T14:55:05.277

只需将 onclick 放在 a-tag 上：

```
<a href="image.jpg onclick="Pop()"; return false;"><img ...></a> 
```

确保`false`在函数末尾（此处`Pop`）或内联返回，如上例所示。这可以防止用户被`<a>`的默认行为重定向到链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T14:56:12.667

你可以给你所有的后备锚标签一个特定的类名，比如“简单”

使用[原型](http://www.prototypejs.org/api/utility/dollar-dollar)，您可以使用 CSS 选择器获取使用该类的所有标签的数组，例如

```
var anchors=$$('a.simple') 
```

现在您可以遍历该数组并清除 href 属性，或安装 onclick 处理程序以覆盖正常行为等...

（编辑添加上面列出的其他方法要简单得多，这只是来自于做大量不显眼的 javascript 的背景，您的 JS 会在其中启动并使用额外的东西来增强功能 HTML 页面！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-08T08:53:35.727

在我看来，我可以建议最好的解决方案吗？这是使用 jQuery 1.4+。

在这里，您有一个包含所有照片的容器。注意添加的类。

```
<div id="photo-container">
    <a href="image1.jpg">
        <img class="popup-image" src="thumbnail1.jpg" pbsrc="image1.jpg" />
    </a>
    <a href="image2.jpg">
        <img class="popup-image" src="thumbnail2.jpg" pbsrc="image2.jpg" />
    </a>
    <a href="image3.jpg">
        <img class="popup-image" src="thumbnail3.jpg" pbsrc="image3.jpg"/>
    </a>
</div> 
```

然后您以这种方式制作单个事件处理程序：

```
<script type="text/javascript">
$(document).ready(function(){
    var container = $('#photo-container');

    // let's bind our event handler
    container.bind('click', function(event){
        // thus we find (if any) the image the user has clicked on
        var target = $(event.target).closest('img.popup-image');

        // If the user has not hit any image, we do not handle the click
        if (!target.length) return;

        event.preventDefault(); // instead of return false;

        // And here you can do what you want to your image
        // which you can get from target
        Pop(target.get(0));
    });
});
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T21:51:35.527

`href`锚点（标签）不需要该属性`<a>`，所以摆脱它......

```
 <a id="apic001" href="pic001.png"><img src="tn_pic001.png"></a>

   <script type="text/javascript">
      document.getElementById("apic001").removeAttribute("href");
   </script> 
```

此方法将避免`onclick`.

在 IE6/FF3/Chrome 中测试。附带好处：您可以使用 id 作为 URI 片段直接链接到包含该缩略图的页面部分：.`[http://whatever/gallery.html](http://whatever/gallery.html)**#apic001**`

为了获得最大的浏览器兼容性，`name="apic001"`请在标记中为锚标记添加一个属性（“name”和“id”值必须相同）。

使用 jQuery、dojo、Prototype 等，您应该能够在多个类似的锚点上执行 removeAttribute 而无需 id。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-02T11:59:54.803

您应该能够将 Chris 的想法中的 return false 与您自己的代码混合并匹配：

```
<a href="image.jpg" onclick="return false;">
    <img src="thumbnail.jpg" pbsrc="image.jpg" onclick="Pop(...);">
</a> 
```

如果有人禁用了 Javascript，那么他们的浏览器会忽略这两个元素中的 onclick 语句并跟随链接；如果他们启用了 Javascript，那么他们的浏览器会遵循两个 OnClick 语句——第一个语句告诉他们不要点击`<a>`链接。^_^

# php - 从 PHP 在 Windows 上包括区分大小写的文件

> ID：63599
> 
> 赞同：0
> 
> 时间：2008-09-15T14:52:15.283
> 
> 标签：php, windows, apache, pear

我们在使用from`PEAR`上的库时遇到问题。`Windows``PHP`

Pear 包含许多类，我们正在使用其中的一些类，其中之一是`Mail.php`. 我们在路径上使用 PEAR，而不是提供单个 PEAR 文件的完整显式路径：

```
require_once('Mail.php'); 
```

而不是：

```
require_once('/path/to/pear/Mail.php'); 
```

这会导致站点的管理模块出现问题，其中有一个`mail.php`文件（用于向用户发送邮件）。如果我们在发送电子邮件的管理屏幕中（例如用户管理屏幕，当用户从审核队列中获得批准时，可以生成新的随机密码并将其通过电子邮件发送给用户），并且我们尝试将`Mail.php`我们“意外”包含在 mail.php .

无需更改以显式要求 PEAR 模块的 PEAR 安装的完整路径（非标准，通常将 PEAR 安装到您的路径......）有没有办法在 Windows 上强制 PHP 要求文件区分大小写？

我们自己将 PEAR 路径添加到包含路径中，因此可以控制路径顺序。我们还认识到，无论大小写如何，我们都应该避免使用与 PEAR 名称冲突的文件名，并且将来会这样做。然而，这个页面（它不是一个包含文件，而是一个控制器）已经在存储库中存在了几年，并且插件专门生成 URL 以在其处理过程中提供指向该页面的链接/重定向。

> （我们支持 Apache、Microsoft IIS、LightHTTPD 和 Zeus，使用 PHP 4.3 或更高版本（包括 PHP5））

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T14:55:10.113

由于这是操作系统级别的事情，我不相信有一种简单的方法可以做到这一点。

您可以尝试将您的 include 从更改`include('Mail.php');`为`include('./Mail.php');`，但我不确定这是否适用于 Windows 机器（没有一个带有 PHP 的机器可以测试）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T19:25:16.203

在包含路径中包含 2 个具有相同名称的文件不是一个好主意，请重命名您的文件，以便您编写的文件具有与第三方库不同的名称。无论如何，对于您当前的情况，我认为通过更改包含路径中的路径顺序，您可以解决此问题。PHP 会一一搜索包含路径中的文件。当在包含路径中找到所需文件时，PHP 将停止搜索该文件。因此，在您的应用程序的管理部分，如果您想包含 PEAR 邮件文件，而不是您编写的 mail.php，请更改您的包含路径，使 PEAR 路径位于当前目录之前。做这样的事情：

```
<?php
  $path_to_pear = '/usr/share/php/pear';
  set_include_path( $path_to_pear . PATH_SEPARATOR . get_include_path() );
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T14:57:30.683

如果您使用的是 PHP 4，则可以利用[此](http://bugs.php.net/bug.php?id=43821)错误。当然，这是一个混乱的解决方案......

或者您可以将您的 mail.php 文件重命名为其他名称...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T11:20:44.823

我相当肯定这个问题是由 Win32 子系统中的 NTFS 代码引起的。如果您使用 Ext2 可安装文件系统 (IFS)，您应该在该驱动器上区分大小写。

# ruby - 调试鞋子应用程序的最佳方法是什么？

> ID：63618
> 
> 赞同：8
> 
> 时间：2008-09-15T14:54:18.833
> 
> 标签：ruby, shoes

Shoes 有一些内置的转储命令（Shoes.debug），但是是否有其他工具可以调试代码而无需在整个过程中注入调试消息？像 gdb 这样的东西会很棒。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T03:26:55.573

您还可以使用 Shoes.show_log 自动打开调试控制台。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T20:47:54.197

鞋子控制台。按 Alt+/（或 mac 上的 apple+/）查看应用程序的堆栈跟踪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T18:27:44.767

请注意，如果您使用 Alt + / 您必须在启动应用程序“之前”运行它

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T15:25:59.023

你看过 ruby​​-debug gem 吗？

```
 % sudo gem install ruby-debug 

```

rdebug 可执行文件为您提供了与 gdb 类似的界面（断点设置等）。您只需使用 rdebug 而不是 ruby​​ 执行您的脚本。

您也可以这样做以避免手动设置断点：

```
 class Foo
  require 'ruby-debug'
  def some_method_somewhere
    debugger # acts like a breakpoint is set at this point
  end
end 

```

这是关于 ruby​​-debug 的教程： [http ://www.datanoise.com/articles/2006/7/12/tutorial-on-ruby-debug](http://www.datanoise.com/articles/2006/7/12/tutorial-on-ruby-debug)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-25T21:41:02.537

我对这里提到的 Apple-/（或 Alt-/）有点困惑。我最终做的是不带参数运行*./shoes*，这会弹出控制台，然后使用*./shoes my_app.rb*启动我的应用程序。

# ruby-on-rails - 在 Rails 应用程序中导入 XML 文件，UTF-16 编码问题

> ID：63632
> 
> 赞同：2
> 
> 时间：2008-09-15T14:55:32.827
> 
> 标签：ruby-on-rails, xml, ruby

我正在尝试通过 Ruby on Rails 应用程序中的网页导入 XML 文件，代码 ruby​​ 视图代码如下（我已删除 HTML 布局标签以使阅读代码更容易）

```
<% form_for( :fmfile, :url => '/fmfiles', :html => { :method => :post, :name => 'Form_Import_DDR', :enctype => 'multipart/form-data' } ) do |f| %>
<%= f.file_field :document, :accept => 'text/xml', :name => 'fmfile_document' %>
<%= submit_tag 'Import DDR' %>
<% end %> 
```

生成以下 HTML 表单

```
<form action="/fmfiles" enctype="multipart/form-data" method="post" name="Form_Import_DDR"><div style="margin:0;padding:0"><input name="authenticity_token" type="hidden" value="3da97372885564a4587774e7e31aaf77119aec62" />
<input accept="text/xml" id="fmfile_document" name="fmfile_document" size="30" type="file" />
<input name="commit" type="submit" value="Import DDR" />
</form> 
```

'fmfiles_controller' 中的 Form_Import_DDR 方法是使用 REXML 读取 XML 文档的繁重工作的代码。代码如下

```
@fmfile = Fmfile.new
@fmfile.user_id = current_user.id
@fmfile.file_group_id = 1
@fmfile.name = params[:fmfile_document].original_filename

respond_to do |format|
  if @fmfile.save
    require 'rexml/document'
    doc = REXML::Document.new(params[:fmfile_document].read)

    doc.root.elements['File'].elements['BaseTableCatalog'].each_element('BaseTable') do |n|
      @base_table = BaseTable.new
      @base_table.base_table_create(@fmfile.user_id, @fmfile.id, n)
    end 
```

它继续读取所有不同的 XML 元素。

我在 Mac OS X 10.5.4 的开发环境中使用 Rails 2.1.0 和 Mongrel 1.1.5，站点数据库和浏览器在同一台机器上。

我的问题是这个。当读取字符编码为 UTF-8 的 XML 文档时，整个过程工作正常，但当 XML 文件为 UTF-16 时失败，有谁知道为什么会发生这种情况以及如何停止？

我在下面包含了来自调试器控制台的错误输出，大约需要 5 分钟才能获得此输出，并且浏览器在以下输出之前超时，并显示“无法打开页面”

```
Processing FmfilesController#create (for 127.0.0.1 at 2008-09-15 16:50:56) [POST]
Session ID: BAh7CDoMdXNlcl9pZGkGOgxjc3JmX2lkIiVmM2I3YWU2YWI4ODU2NjI0NDM2
NTFmMDE1OGY1OWQxNSIKZmxhc2hJQzonQWN0aW9uQ29udHJvbGxlcjo6Rmxh
c2g6OkZsYXNoSGFzaHsABjoKQHVzZWR7AA==--dd9f588a68ed628ab398dd1a967eedcd09e505e0
Parameters: {"commit"=>"Import DDR", "authenticity_token"=>"3da97372885564a4587774e7e31aaf77119aec62", "action"=>"create", "fmfile_document"=>#<File:/var/folders/LU/LU50A0vNHA07S4rxDAOk4E+++TI/-Tmp-/CGI.3001.1>, "controller"=>"fmfiles"}
[4;36;1mUser Load (0.000350)[0m   [0;1mSELECT * FROM "users" WHERE (id = 1) LIMIT 1[0m
[4;35;1mFmfile Create (0.000483)[0m   [0mINSERT INTO "fmfiles" ("name", "file_group_id", "updated_at", "report_created_at", "report_link", "report_version", "option_on_open_account_name", "user_id", "option_default_custom_menu_set", "option_on_close_script", "path", "report_type", "option_on_open_layout", "option_on_open_script", "created_at") VALUES('TheTest_fp7 2.xml', 1, '2008-09-15 15:50:56', NULL, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, NULL, NULL, '2008-09-15 15:50:56')[0m

REXML::ParseException (#<Iconv::InvalidCharacter: "਼䙍偒数 (followed by a few thousand similar looking chinese characters)
䙍偒数潲琾", ["\n"]>
/Library/Ruby/Site/1.8/rexml/encodings/ICONV.rb:7:in `conv'
/Library/Ruby/Site/1.8/rexml/encodings/ICONV.rb:7:in `decode'
/Library/Ruby/Site/1.8/rexml/source.rb:50:in `encoding='
/Library/Ruby/Site/1.8/rexml/parsers/baseparser.rb:210:in `pull'
/Library/Ruby/Site/1.8/rexml/parsers/treeparser.rb:21:in `parse'
/Library/Ruby/Site/1.8/rexml/document.rb:190:in `build'
/Library/Ruby/Site/1.8/rexml/document.rb:45:in `initialize' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T15:42:30.013

而不是 rails/mongrel 问题，听起来更有可能是您的 XML 文件或 REXML 处理它的方式存在问题。您可以通过编写一个简短的脚本来直接（而不是在请求中）读取您的 XML 文件并查看它是否仍然失败来检查这一点。

假设确实如此，我会看几件事。首先，我会检查您是否正在运行最新版本的 REXML。几年前，在其 UTF-16 处理中 存在一个错误 ( [http://www.germane-software.com/projects/rexml/ticket/63 )。](http://www.germane-software.com/projects/rexml/ticket/63)

我要检查的第二件事是您的问题是否与此类似：[http](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/ba7b0585c7a6330d) ://groups.google.com/group/rubyonrails-talk/browse_thread/thread/ba7b0585c7a6330d 。如果是这样，您可以尝试该线程中的解决方法。

如果以上都没有帮助，请回复更多信息，例如您在尝试读取文件时遇到的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T18:02:12.860

因为要让它工作，我只需要将第一个 XML 元素的编码属性更改为 UTF-8 而不是 UTF-16，因此 XML 文件实际上是 UTF-8 并且被生成它的应用程序错误地标记。

XML 文件是 FileMaker Pro Advanced 8.5 在 OS X 10.5.4 上生成的 FileMaker DDR 导出文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T21:23:36.113

实际上，我认为您的问题可能与我刚刚在[这篇文章](https://stackoverflow.com/questions/291455/xml-data-at-root-level-is-invalid)中详述的问题有关。如果我是你，我会在 TextPad 中以二进制模式打开它，看看在你的 XML 启动之前是否有任何字节顺序标记。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:53:52.393

您是否尝试过使用 JRuby 执行此操作？我听说 Unicode 字符串在 JRuby 中得到了更好的支持。

您可以尝试的另一件事是使用另一个 XML 解析库，例如 libxml ou Hpricot。

REXML 是您可以使用且可能无法扩展的最慢的 Ruby XML 库之一。

# .net - WPF 数据绑定和验证规则最佳实践

> ID：63646
> 
> 赞同：101
> 
> 时间：2008-09-15T14:56:37.410
> 
> 标签：.net, wpf, data-binding, validation

我有一个非常简单的 WPF 应用程序，我在其中使用数据绑定来允许编辑一些自定义 CLR 对象。我现在想在用户单击保存时进行一些输入验证。但是，我读过的所有 WPF 书籍并没有真正为这个问题投入任何篇幅。我看到您可以创建自定义 ValidationRules，但我想知道这是否会超出我的需求。

所以我的问题是：是否有一个很好的示例应用程序或文章可以演示在 WPF 中验证用户输入的最佳实践？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2008-09-15T15:09:12.527

我认为新的首选方法可能是使用 IDataErrorInfo

[在这里](http://blogs.msdn.com/wpfsdk/archive/2007/10/02/data-validation-in-3-5.aspx)阅读更多

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-12-01T16:54:35.020

来自 MS 的[Patterns & Practices 文档](http://msdn.microsoft.com/en-us/library/gg405484(v=PandP.40).aspx)：

> ## 数据验证和错误报告
> 
> 您的视图模型或模型通常需要执行数据验证并向视图发出任何数据验证错误的信号，以便用户可以采取行动纠正它们。
> 
> Silverlight 和 WPF 支持管理在更改绑定到视图中控件的单个属性时发生的数据验证错误。对于数据绑定到控件的单个属性，视图模型或模型可以通过拒绝传入的错误值并引发异常来在属性设置器中发出数据验证错误信号。如果数据绑定的 ValidatesOnExceptions 属性为 true，则 WPF 和 Silverlight 中的数据绑定引擎将处理该异常并向用户显示存在数据验证错误的视觉提示。
> 
> 但是，应尽可能避免以这种方式抛出带有属性的异常。另一种方法是在视图模型或模型类上实现 IDataErrorInfo 或 INotifyDataErrorInfo 接口。这些接口允许您的视图模型或模型对一个或多个属性值执行数据验证，并向视图返回错误消息，以便可以将错误通知用户。

该文档继续解释如何实现 IDataErrorInfo 和 INotifyDataErrorInfo。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-16T04:07:51.190

就个人而言，我正在使用异常来处理验证。它需要以下步骤：

1.  在您的数据绑定表达式中，您需要添加“ValidatesOnException=True”
2.  在您绑定的数据对象中，您需要添加 DependencyPropertyChanged 处理程序，在其中检查新值是否满足您的条件 - 如果不满足 - 您恢复到对象旧值（如果需要）并抛出异常。
3.  在您用于在控件中显示无效值的控件模板中，您可以访问错误集合并显示异常消息。

这里的技巧是只绑定到派生自 DependencyObject 的对象。INotifyPropertyChanged 的​​简单实现不起作用 - 框架中有一个错误，它阻止您访问错误集合。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T21:55:36.827

还要检查[这篇文章](http://www.bennedik.de/2008/05/wpf-integration-for-vab-update-for.html)。据说微软从他们的模式和实践中发布了他们的[企业库（v4.0）](http://blogs.msdn.com/agile/archive/2008/05/16/enterprise-library-4-0-for-visual-studio-2008-released.aspx)，他们涵盖了验证主题，但天知道他们为什么不包括 WPF 验证，所以我要引导你的博客文章解释了作者的内容做了适应它。希望这可以帮助！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-07-04T16:38:43.653

您可能对**[WPF 应用程序框架 (WAF)](http://waf.codeplex.com)****的BookLibrary**示例应用程序感兴趣。它展示了如何在 WPF 中使用验证，以及在存在验证错误时如何控制“保存”按钮。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-25T08:13:44.380

如果您的业务类直接由您的 UI 使用，则最好使用 IDataErrorInfo，因为它使逻辑更接近其所有者。

If your business class is a stub class created by a reference to an WCF/XmlWeb service then you can not/must not use IDataErrorInfo nor throw Exception for use with ExceptionValidationRule. Instead you can:

*   Use custom ValidationRule.
*   Define a partial class in your WPF UI project and implements IDataErrorInfo.

# windows-server-2003 - 如何使用 Windows 2003 网络负载平衡停止网络泛滥？

> ID：63658
> 
> 赞同：0
> 
> 时间：2008-09-15T14:58:02.103
> 
> 标签：windows-server-2003, load-balancing

我知道 MsNLB 可以配置为使用 IGMP 进行用户多播。但是，如果交换机不支持 IGMP，有哪些选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-15T15:07:38.147

如果你能找到一个旧的“哑”集线器，你可以通过它运行节点 NIC，或者如果你的交换机是可管理的，你可以设置端口，这样它们就不会记住 MAC 地址到 IP 地址的映射。

我会说我在 WLBS（NLB 的 2003+ 版本）在端口泛滥方面有过可怕的经历。我们有一个现有的负载平衡系统，其中负载平衡的 NIC 进入 VLAN 以保持流量分离，并且我们关闭了 MAC 地址到 IP 的映射以减少问题。我们正在从 WLBS 迁移负载平衡；但是，由于这种配置的可靠性。

# c# - 结构实现接口是否安全？

> ID：63671
> 
> 赞同：105
> 
> 时间：2008-09-15T14:59:29.743
> 
> 标签：c#, interface, struct

我似乎记得读过一些关于结构通过 C# 在 CLR 中实现接口的坏处，但我似乎找不到任何关于它的信息。不好吗？这样做会产生意想不到的后果吗？

```
public interface Foo { Bar GetBar(); }
public struct Fubar : Foo { public Bar GetBar() { return new Bar(); } } 
```

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2009-08-17T18:17:03.553

由于没有其他人明确提供此答案，我将添加以下内容：

**在结构上实现**接口没有任何负面影响。

用于保存结构的接口类型的任何*变量*都将导致使用该结构的装箱值。如果结构是不可变的（一件好事），那么这在最坏的情况下是一个性能问题，除非您是：

*   将生成的对象用于锁定目的（无论如何都是一个非常糟糕的主意）
*   使用引用相等语义并期望它适用于来自同一结构的两个装箱值。

这两种情况都不太可能，相反，您可能会执行以下操作之一：

### 泛型

结构实现接口的许多合理原因可能是它们可以在具有*[约束](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)***的通用**上下文中使用。当以这种方式使用时，变量如下：

```
class Foo<T> : IEquatable<Foo<T>> where T : IEquatable<T>
{
    private readonly T a;

    public bool Equals(Foo<T> other)
    {
         return this.a.Equals(other.a);
    }
} 
```

1.  启用将结构用作类型参数
    *   只要没有使用类似`new()`or`class`的其他约束。
2.  允许避免对以这种方式使用的结构进行装箱。

那么 this.a 不是接口引用，因此它不会导致放入其中的任何内容。此外，当 c# 编译器编译泛型类并需要插入在 Type 参数 T 的实例上定义的实例方法的调用时，它可以使用受[约束](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.constrained.aspx)的操作码：

> 如果 thisType 是值类型并且 thisType 实现了方法，则 ptr 未经修改地作为“this”指针传递给调用方法指令，用于通过 thisType 实现方法。

这避免了装箱，并且由于值类型正在实现接口，因此*必须*实现方法，因此不会发生装箱。在上面的示例中，`Equals()`调用是在 this.a ¹上没有框的情况下完成的。

### 低摩擦 API

大多数结构应该具有类似原始的语义，其中按位相同的值被认为等于²。运行时将隐式提供此类行为，`Equals()`但这可能很慢。此外，这种隐式相等*不会*作为实现公开，`IEquatable<T>`因此可以防止结构被轻松用作字典的键，除非它们自己显式实现它。因此，许多公共结构类型通常声明它们实现`IEquatable<T>`（它们在哪里`T`）以使其更容易和更好地执行，并与 CLR BCL 中许多现有值类型的行为保持一致。

BCL 中的所有原语至少实现：

*   `IComparable`
*   `IConvertible`
*   `IComparable<T>`
*   `IEquatable<T>`（因此`IEquatable`）

许多还实现`IFormattable`了，而且许多系统定义的值类型，如 DateTime、TimeSpan 和 Guid 也实现了许多或所有这些。如果您正在实现类似的“广泛有用”的类型，例如复数结构或一些固定宽度的文本值，那么实现许多这些通用接口（正确）将使您的结构更有用和可用。

## 排除项

显然，如果接口强烈暗示可*变性*（如`ICollection`) 或者您通过忽略诸如`Add()`抛出异常之类的方法的含义而使用户感到困惑。

许多接口并不意味着可变性（例如`IFormattable`），而是作为以一致方式公开某些功能的惯用方式。通常结构的用户不会关心这种行为的任何装箱开销。

## 概括

当明智地完成时，在不可变值类型上，实现有用的接口是一个好主意

* * *

### 笔记：

1：请注意，编译器在对*已知*为特定结构类型但需要调用虚拟方法的变量调用虚拟方法时可能会使用此选项。例如：

```
List<int> l = new List<int>();
foreach(var x in l)
    ;//no-op 
```

List 返回的枚举器是一个结构体，这是一种在枚举列表时避免分配的优化（有一些有趣的[后果](http://www.eggheadcafe.com/software/aspnet/31702392/c-compiler-challenge--s.aspx)）。但是 foreach 的语义指定如果枚举器实现`IDisposable`then`Dispose()`将在迭代完成后被调用。显然，通过盒装调用发生这种情况会消除枚举器作为结构的任何好处（实际上它会更糟）。更糟糕的是，如果 dispose 调用以某种方式修改了枚举器的状态，那么这将发生在装箱的实例上，并且在复杂的情况下可能会引入许多细微的错误。因此在这种情况下发出的 IL 是：

```
IL_0001：newobj System.Collections.Generic.List..ctor
IL_0006：stloc.0     
IL_0007：没有         
IL_0008：ldloc.0     
IL_0009：调用virt System.Collections.Generic.List.GetEnumerator
IL_000E: stloc.2     
IL_000F: br.s IL_0019
IL_0011：ldloca.s 02
IL_0013：调用 System.Collections.Generic.List.get_Current
IL_0018：stloc.1     
IL_0019: ldloca.s 02
IL_001B：调用 System.Collections.Generic.List.MoveNext
IL_0020：stloc.3     
IL_0021：ldloc.3     
IL_0022：brtrue.s IL_0011
IL_0024：离开.s IL_0035
IL_0026: ldloca.s 02
IL_0028：受限。System.Collections.Generic.List.Enumerator
IL_002E: callvirt System.IDisposable.Dispose
IL_0033：没有         
IL_0034：最后  

```

因此，IDisposable 的实现不会导致任何性能问题，并且如果 Dispose 方法实际执行任何操作，枚举数的（令人遗憾的）可变方面将被保留！

2：double 和 float 是该规则的例外，其中 NaN 值不相等。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-09-15T15:09:21.780

这个问题有几件事正在发生......

结构可以实现接口，但存在与转换、可变性和性能有关的问题。有关更多详细信息，请参阅此帖子：[https ://docs.microsoft.com/en-us/archive/blogs/abhinaba/c-structs-and-interface](https://docs.microsoft.com/en-us/archive/blogs/abhinaba/c-structs-and-interface)

一般来说，结构应该用于具有值类型语义的对象。通过在结构上实现接口，您可能会遇到装箱问题，因为结构在结构和接口之间来回转换。由于装箱，更改结构内部状态的操作可能无法正常运行。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-14T16:34:31.010

在某些情况下，结构实现接口可能会很好（如果它从来没有用过，那么 .net 的创建者是否会提供它是值得怀疑的）。如果一个结构体实现了类似的只读接口`IEquatable<T>`，将结构体存储在类型的存储位置（变量、参数、数组元素等）`IEquatable<T>`将需要对其进行装箱（每个结构体类型实际上定义了两种东西：一个存储位置类型表现为值类型，堆对象类型表现为类类型；第一个可以隐式转换为第二个——“装箱”——第二个可以通过显式转换转换为第一个—— “拆箱”）。可以在不装箱的情况下利用结构的接口实现，但是，使用所谓的约束泛型。

例如，如果一个人有一个方法`CompareTwoThings<T>(T thing1, T thing2) where T:IComparable<T>`，那么这样的方法可以调用`thing1.Compare(thing2)`而无需框`thing1`或`thing2`。如果`thing1`碰巧是，例如，一个`Int32`，运行时将知道它何时生成代码`CompareTwoThings<Int32>(Int32 thing1, Int32 thing2)`。由于它将知道承载该方法的事物和作为参数传递的事物的确切类型，因此不必将它们中的任何一个装箱。

实现接口的结构的最大问题是存储在接口类型的位置`Object`，或`ValueType`（与其自己类型的位置相反）的结构将表现为类对象。对于只读接口，这通常不是问题，但对于像`IEnumerator<T>`它这样的变异接口可能会产生一些奇怪的语义。

例如，考虑以下代码：

```
List<String> myList = [list containing a bunch of strings]
var enumerator1 = myList.GetEnumerator();  // Struct of type List<String>.IEnumerator
enumerator1.MoveNext(); // 1
var enumerator2 = enumerator1;
enumerator2.MoveNext(); // 2
IEnumerator<string> enumerator3 = enumerator2;
enumerator3.MoveNext(); // 3
IEnumerator<string> enumerator4 = enumerator3;
enumerator4.MoveNext(); // 4 
```

标记语句#1 将`enumerator1`准备读取第一个元素。该枚举器的状态将被复制到`enumerator2`. 标记语句 #2 将推进该副本以读取第二个元素，但不会影响`enumerator1`. 然后将第二个枚举器的状态复制到`enumerator3`，这将由标记的语句#3 推进。然后，因为`enumerator3`and`enumerator4`都是引用类型，所以*REFERENCE* to`enumerator3`将被复制到`enumerator4`，因此标记的语句将有效地*推进* `enumerator3`and `enumerator4`。

有些人试图假装值类型和引用类型都是`Object`，但事实并非如此。实值类型可以转换为`Object`，但不是它的实例。存储在该类型位置的实例`List<String>.Enumerator`是值类型，并且表现为值类型；将其复制到 type 的位置`IEnumerator<String>`会将其转换为引用类型，并且*它将表现为引用类型*。后者是一种`Object`，而前者不是。

BTW, a couple more notes: (1) In general, mutable class types should have their `Equals` methods test reference equality, but there is no decent way for a boxed struct to do so; (2) despite its name, `ValueType` is a class type, not a value type; all types derived from `System.Enum` are value types, as are all types which derive from `ValueType` with the exception of `System.Enum`, but both `ValueType` and `System.Enum` are class types.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T15:06:24.330

结构被实现为值类型，类是引用类型。如果你有一个 Foo 类型的变量，并且你在其中存储了一个 Fubar 的实例，它会将它“装箱”成一个引用类型，从而首先破坏了使用结构的优势。

我看到使用结构而不是类的唯一原因是因为它将是值类型而不是引用类型，但结构不能从类继承。如果你让结构继承一个接口，并且你传递接口，你就会失去结构的值类型性质。如果您需要接口，不妨将其设为一个类。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-15T15:14:58.317

（好吧，没有什么重要的东西要添加，但还没有编辑能力，所以就这样吧..）
**完全安全。在结构上实现接口没有什么违法的。但是，您应该质疑为什么要这样做。**

但是**，获取对结构的接口引用会将**其装箱。所以性能损失等等。

我现在能想到的唯一有效场景[在我的帖子中进行了说明](https://stackoverflow.com/questions/51526/changing-the-value-of-an-element-in-a-list-of-structs#51585)。当您想要修改存储在集合中的结构状态时，您必须通过结构上公开的附加接口来完成。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T15:04:12.913

值类型实现接口的理由很少。由于您不能子类化值类型，因此您始终可以将其称为具体类型。

当然，除非您有多个结构都实现了相同的接口，否则它可能会有点用处，但那时我建议使用一个类并正确地使用它。

当然，通过实现一个接口，你正在装箱结构，所以它现在位于堆上，你将无法再通过值传递它......这真的强化了我的观点，你应该只使用一个类在这个情况下。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T15:04:52.553

我认为问题在于它会导致装箱，因为结构是值类型，因此会有轻微的性能损失。

该链接表明它可能存在其他问题...

[http://blogs.msdn.com/abhinaba/archive/2005/10/05/477238.aspx](http://blogs.msdn.com/abhinaba/archive/2005/10/05/477238.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T15:04:05.973

实现接口的结构没有任何后果。例如，内置的系统结构实现了 和 之类的`IComparable`接口`IFormattable`。

* * *

## 回答 #9

> 赞同：-10
> 
> 时间：2008-09-15T15:03:54.490

结构就像存在于堆栈中的类。我看不出为什么他们应该是“不安全的”。

# python - 如何在 Python 下为 Delphi 创建线程

> ID：63681
> 
> 赞同：1
> 
> 时间：2008-09-15T15:00:45.637
> 
> 标签：python, delphi

我在我的 Delphi 应用程序中使用 Python 为 Delphi 组件托管 Python 脚本。我想创建通过脚本继续运行的后台任务。

即使脚本执行结束，是否可以创建继续运行的线程（但不能创建继续运行的主机进程）。我注意到如果执行脚本结束并且有线程正在运行，程序就会卡住。但是，如果我等到线程完成，一切都会好起来的。

我正在尝试对线程使用“线程”标准模块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T19:05:12.460

如果有帮助，Python 有自己的标准线程模块。您可以使用 threading 模块创建线程对象。

[线程文档](https://docs.python.org/2/library/threading.html)

[线程文档](https://docs.python.org/3/library/threading.html)

thread 模块使用简单的 Lock 对象提供低级线程和同步。

同样，不确定这是否有帮助，因为您在 Delphi 环境下使用 Python。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T15:10:03.227

根据定义，线程是同一进程的一部分。如果您希望它们继续运行，则需要将它们分叉到一个新进程中；请参阅 os.fork() 和朋友。

您可能希望新进程在生成脚本后立即结束（通过 exit() 等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T15:12:27.043

如果一个进程死亡，它的所有线程都会随之死亡，因此解决方案可能是一个单独的进程。

看看创建一个 xmlrpc 服务器是否对您有帮助，这是一个用于进程间通信的简单解决方案。

# java - java程序退出时调用函数

> ID：63687
> 
> 赞同：16
> 
> 时间：2008-09-15T15:01:28.863
> 
> 标签：java, events

我想在每次用户退出程序时保存程序设置。所以我需要一种在用户退出程序时调用函数的方法。我怎么做？

我正在使用 Java 1.5。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-09-15T15:03:27.020

您可以通过执行以下操作将关闭挂钩添加到您的应用程序：

```
Runtime.getRuntime().addShutdownHook(new Thread(new Runnable() {
    public void run() {
        // what you want to do
    }
})); 
```

这基本上相当于在整个程序周围有一个 try {} finally {} 块，并且基本上包含了 finally 块中的内容。

请注意注意[事项](https://stackoverflow.com/questions/63687/calling-function-when-program-exits-in-java#63886)！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-15T15:22:04.180

添加关闭挂钩[addShutdownHook(java.lang.Thread)](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))可能是您要寻找的。但是，这种方法存在问题：

*   如果程序以不受控制的方式中止（即如果它被杀死），您将丢失更改
*   如果出现错误（权限被拒绝、磁盘已满、网络错误），您将丢失更改

所以最好立即保存设置（可能在一个额外的线程中，以避免等待时间）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T17:08:42.240

您是否正在创建一个独立的 GUI 应用程序（即 Swing）？

如果是这样，您应该考虑如何为用户提供退出应用程序的选项。也就是说，如果有一个文件菜单，我希望会有一个“退出”菜单项。此外，如果用户关闭应用程序中的最后一个窗口，我也希望它退出应用程序。在这两种情况下，它都应该调用处理保存用户首选项的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-16T03:58:19.637

使用 Runtime.getRuntime().addShutdownHook() 肯定是一种方法 - 但如果您正在编写 Swing 应用程序，我强烈建议您查看 JSR 296（Swing 应用程序框架）

这是一篇关于基础知识的好文章：http: [//java.sun.com/developer/technicalArticles/javase/swingappfr/](http://java.sun.com/developer/technicalArticles/javase/swingappfr/)。

JSR 参考实现提供了您在比添加关闭挂钩更高的抽象级别寻找的那种特性。

这是参考实现： [https ://appframework.dev.java.net/](https://appframework.dev.java.net/)

# linux - 如何通过 DHCP 可靠地获取 IP 地址？

> ID：63690
> 
> 赞同：0
> 
> 时间：2008-09-15T15:01:44.293
> 
> 标签：linux, dhcp

我使用的嵌入式 Linux 系统有时希望从 DHCP 服务器获取其 IP 地址。我们使用的 DHCP Client 客户端 ( [dhcpcd](http://www.phystech.com/download/dhcpcd.html "DHCPCD") ) 具有有限的重试逻辑。如果我们的设备在没有任何可用的 DHCP 服务器的情况下启动并超时，则 dhcpcd 将退出并且设备将永远不会获得 IP 地址，直到它重新启动且 DHCP 服务器可见/已连接。我不可能是唯一一个有这个问题的人。这个问题似乎并不特定于嵌入式系统（尽管在那里情况更糟）。你怎么处理这个？是否有更强大的客户端可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T15:05:00.073

来自 ISC 的参考 dhclient 应该在默认配置中永远运行，如果它在启动时没有获得租约，它应该稍后获得租约。

我在 FreeBSD 上使用开箱即用的 dhcp 客户端，它源自 OpenBSD 并基于 ISC 的 dhclient，这是开箱即用的行为。

见[http://www.isc.org/index.pl?/sw/dhcp/](http://www.isc.org/index.pl?/sw/dhcp/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T15:05:18.760

你有几个选择：

1.  当您没有 IP 地址时，请重新启动 dhcpcd 以进行更多重试。
2.  有一个备用的静态 IP 地址。[这在我制作](http://itwatchdogs.com)的嵌入式设备中非常成功。
3.  使用[自动 IP](http://www.duxcw.com/faq/network/autoip.htm)作为备份。Windows 执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T17:04:47.680

添加到`rc.local`检查以查看是否已获得 IP。如果在不久的将来没有设置“at”工作，请再次尝试。继续调度“at”作业，直到获得 IP。

# c# - 在 C# 中使用泛型创建数学库

> ID：63694
> 
> 赞同：33
> 
> 时间：2008-09-15T15:02:16.337
> 
> 标签：c#, generics, interface, math

是否有任何可行的方法使用泛型来创建不依赖于选择存储数据的基本类型的数学库？

换句话说，假设我想写一个 Fraction 类。分数可以用两个整数或两个双精度数或诸如此类的形式表示。重要的是基本的四种算术运算都定义得很好。所以，我希望能够写`Fraction<int> frac = new Fraction<int>(1,2)`和/或`Fraction<double> frac = new Fraction<double>(0.1, 1.0)`.

不幸的是，没有代表四个基本操作（+、-、*、/）的接口。有没有人找到一种可行的、可行的方法来实现这一点？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-15T15:51:16.857

这是一种抽象出相对轻松的运算符的方法。

```
 abstract class MathProvider<T>
    {
        public abstract T Divide(T a, T b);
        public abstract T Multiply(T a, T b);
        public abstract T Add(T a, T b);
        public abstract T Negate(T a);
        public virtual T Subtract(T a, T b)
        {
            return Add(a, Negate(b));
        }
    }

    class DoubleMathProvider : MathProvider<double>
    {
        public override double Divide(double a, double b)
        {
            return a / b;
        }

        public override double Multiply(double a, double b)
        {
            return a * b;
        }

        public override double Add(double a, double b)
        {
            return a + b;
        }

        public override double Negate(double a)
        {
            return -a;
        }
    }

    class IntMathProvider : MathProvider<int>
    {
        public override int Divide(int a, int b)
        {
            return a / b;
        }

        public override int Multiply(int a, int b)
        {
            return a * b;
        }

        public override int Add(int a, int b)
        {
            return a + b;
        }

        public override int Negate(int a)
        {
            return -a;
        }
    }

    class Fraction<T>
    {
        static MathProvider<T> _math;
        // Notice this is a type constructor.  It gets run the first time a
        // variable of a specific type is declared for use.
        // Having _math static reduces overhead.
        static Fraction()
        {
            // This part of the code might be cleaner by once
            // using reflection and finding all the implementors of
            // MathProvider and assigning the instance by the one that
            // matches T.
            if (typeof(T) == typeof(double))
                _math = new DoubleMathProvider() as MathProvider<T>;
            else if (typeof(T) == typeof(int))
                _math = new IntMathProvider() as MathProvider<T>;
            // ... assign other options here.

            if (_math == null)
                throw new InvalidOperationException(
                    "Type " + typeof(T).ToString() + " is not supported by Fraction.");
        }

        // Immutable impementations are better.
        public T Numerator { get; private set; }
        public T Denominator { get; private set; }

        public Fraction(T numerator, T denominator)
        {
            // We would want this to be reduced to simpilest terms.
            // For that we would need GCD, abs, and remainder operations
            // defined for each math provider.
            Numerator = numerator;
            Denominator = denominator;
        }

        public static Fraction<T> operator +(Fraction<T> a, Fraction<T> b)
        {
            return new Fraction<T>(
                _math.Add(
                  _math.Multiply(a.Numerator, b.Denominator),
                  _math.Multiply(b.Numerator, a.Denominator)),
                _math.Multiply(a.Denominator, b.Denominator));
        }

        public static Fraction<T> operator -(Fraction<T> a, Fraction<T> b)
        {
            return new Fraction<T>(
                _math.Subtract(
                  _math.Multiply(a.Numerator, b.Denominator),
                  _math.Multiply(b.Numerator, a.Denominator)),
                _math.Multiply(a.Denominator, b.Denominator));
        }

        public static Fraction<T> operator /(Fraction<T> a, Fraction<T> b)
        {
            return new Fraction<T>(
                _math.Multiply(a.Numerator, b.Denominator),
                _math.Multiply(a.Denominator, b.Numerator));
        }

        // ... other operators would follow.
    } 
```

如果您未能实现您使用的类型，您将在运行时而不是在编译时失败（这很糟糕）。实现的定义`MathProvider<T>`总是相同的（也很糟糕）。我建议您避免在 C# 中执行此操作，并使用 F# 或其他更适合此抽象级别的语言。

**编辑：**修正了加减法的定义`Fraction<T>`。另一个有趣且简单的事情是实现一个在抽象语法树上运行的 MathProvider。这个想法立即指向做自动微分之类的事情：http: [//conal.net/papers/beautiful-differentiation/](http://conal.net/papers/beautiful-differentiation/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-15T15:22:29.873

我相信这回答了你的问题：

[http://www.codeproject.com/KB/cs/genericnumerics.aspx](http://www.codeproject.com/KB/cs/genericnumerics.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-09T14:40:00.260

这是泛型类型附带的一个微妙问题。假设一个算法涉及除法，比如说高斯消元法来求解方程组。如果你传入整数，你会得到一个错误的答案，因为你会进行*整数*除法。但是如果你传入具有整数值的双参数，你会得到正确的答案。

平方根也会发生同样的事情，就像在 Cholesky 分解中一样。分解一个整数矩阵会出错，而分解一个恰好具有整数值的双精度矩阵会很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T15:18:13.193

首先，您的类应该将泛型参数限制为基元（公共类 Fraction where T : struct, new() ）。

其次，您可能需要创建[隐式](http://msdn.microsoft.com/en-us/library/z5z9kes2(VS.71).aspx)强制转换重载，以便您可以处理从一种类型到另一种类型的强制转换，而无需编译器哭泣。

第三，您还可以重载四个基本运算符，以使接口在组合不同类型的分数时更加灵活。

最后，您必须考虑如何处理算术上溢和下溢。一个好的库将非常明确地处理溢出的方式。否则你不能相信不同分数类型的运算结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-02T12:01:21.400

此处的其他方法将起作用，但它们对原始运算符具有很高的性能影响。我想我会在这里为需要最快而不是最漂亮方法的人发布这个。

如果您想在不付出性能损失的情况下进行通用数学运算，那么不幸的是，这样做的方法是：

```
[MethodImpl(MethodImplOptions.AggressiveInlining)]
public static T IncrementToMax(T value)
{
    if (typeof(T) == typeof(char))
        return (char)(object)value! < char.MaxValue ? (T)(object)(char)((char)(object)value + 1) : value;

    if (typeof(T) == typeof(byte))
        return (byte)(object)value! < byte.MaxValue ? (T)(object)(byte)((byte)(object)value + 1) : value;

    // ...rest of the types
} 
```

我知道，这看起来很可怕，但是使用这种方法会生成运行速度尽可能快的代码。JIT 将优化所有强制转换和条件分支。

你可以在这里阅读解释和一些额外的重要细节：[http ://www.singulink.com/codeindex/post/generic-math-at-raw-operator-speed](http://www.singulink.com/codeindex/post/generic-math-at-raw-operator-speed)

# windows-vista - Vista 是否对 DCOM 调用中的接口 ID 进行更严格的检查？（存根收到错误数据）？

> ID：63720
> 
> 赞同：5
> 
> 时间：2008-09-15T15:05:05.267
> 
> 标签：windows-vista, dcom

我希望每个人都能原谅这个问题的长度和叙述方式。我决定在我的博客中详细描述一下这种情况。后来我看到乔尔对这个网站的邀请，我想我会把它贴在这里看看是否有人对这种情况有任何见解。

我编写了一个应用程序，现在支持一个应用程序，该应用程序包含一个 Visual Basic 胖客户端，它将 DCOM 与使用 ATL 用 C++ 编写的中间层 COM+ 组件进行通信。它在我们所有的八个办公室中运行。每个办公室都有一个后端服务器，其中包含 COM+ 应用程序（由 18 个独立的组件组成）和 SQLServer。SQLServer 通常位于同一后端服务器上，但不一定如此。

我们最近将我们最大的办公室——纽约——的后端服务器从一个 MSC 集群迁移到了一个托管在 VMWare 的 ESX 技术上的新虚拟机。由于 COM+ 应用程序的位置已从旧服务器移动到具有不同名称的新服务器，因此我必须重定向所有客户端，以便它们在新服务器上激活 COM+ 应用程序。该程序是旧帽子，因为我对经历过类似基础设施升级的几个较小的办公室做了基本相同的事情。

一切看起来都很正常，周一早上，整个办公室——大约 1,000 台 Windows XP 工作站——都在新服务器上顺利运行。但随后电话来自我的移动组——有一位在家工作的律师使用 VPN 连接，在被重定向到新服务器后出现奇怪的错误：

```
FillTreeView2 上的错误 - 存根收到错误数据。

```

嗯？我以前从未见过此错误消息。是新服务器吗？但是办公室里的所有工作站都工作正常。我告诉移动组将律师切换回旧服务器（仍在运行），错误消失了。那么有什么区别呢？原来这位律师正在家里运行 Vista。

我们的任何办公室都没有运行 Vista，但我们确实有一些在家里运行 Vista 的律师（当然有些在我的纽约办公室）。我也这样做，我从未见过这个问题。为了确认存在问题，我启动了我的 Vista 笔记本电脑，将其指向新服务器，并得到了同样的错误。我将它指向旧服务器，它运行良好。显然，Vista 和新服务器上的组件存在一些问题——这个问题似乎不会影响 XP 客户端。会是什么呢？

下一站——我的笔记本电脑上的应用程序错误日志。这产生了有关错误的更多信息：

```
来源：Microsoft-Windows-RPC-Events
日期：2008 年 9 月 2 日上午 11:56:07
事件编号：10
级别：错误
电脑：开发笔记本电脑
说明：应用程序未能完成 COM 调用，因为不正确
接口 ID 作为参数传递。

预期的接口 ID 为 00000555-0000-0010-8000-00aa006d2ea4，
返回的接口 ID 为 00000556-0000-0010-8000-00aa006d2ea4。

用户操作 - 联系应用程序供应商以获取应用程序的更新版本。

```

界面 ID 提供了我解开谜团所需的线索。“预期”接口 id 标识 MDAC 的 Recordset 接口——特别是该接口的 2.1 版。“返回”接口对应于 Recordset 的更高版本（2.5 版与 2.1 版的不同之处在于在 vtable 的末尾包含了一个附加条目——方法 Save）。

实际上，我的组件接口公开了许多将 Recordset 作为输出参数传递的方法。那么他们是否突然返回了更高版本的 Recordset —— 具有不同的接口 ID？显然情况确实如此。然后我想，这有什么关系。对于旧接口的客户端，vtable 看起来是一样的。事实上，我怀疑如果我们谈论的是进程内 COM，而不是 DCOM，这种看似无害的阻抗失配会被默默地忽略，不会造成任何问题。

当然，当进程和机器边界发挥作用时，客户端和服务器之间存在代理和存根。在这种情况下，我将类型库编组与自由线程编组器一起使用。所以有两个谜团需要解开：

为什么我在新服务器上的方法的输出参数中返回了不同的接口？

为什么这只会影响 Vista 客户端？

由于我的服务器软件托管在我的八个办公室的每个服务器上，我决定尝试按顺序将我的 Vista 客户端指向所有这些办公室，以查看哪些与 Vista 有问题，哪些没有。光照测试。一些较旧的服务器仍可与 Vista 一起使用，但较新的服务器则不能。尽管一些较旧的服务器仍在运行 Windows 2000，而较新的服务器在 2003 年，但这似乎不是问题。

在比较了组件 DLL 的日期之后，似乎每当客户端指向具有 2003 年之前的组件 DLL 的服务器时 Vista 都可以。但是那些拥有日期在 2003 年之后的 DLL 是有问题的。信不信由你，多年来，服务器组件上的代码没有（或至少没有重大）变化。显然，不同的日期仅仅是由于在我的开发机器上重新编译了我的组件。似乎其中一个重新编译发生在 2003 年。

灯泡亮了。在将记录集从服务器传回客户端时，我的 ATL C++ 组件将接口称为 _Recordset。此符号来自嵌入在 msado15.dll 中的类型库。这是我在 C++ 代码中的行：

```
#import "c:\Program Files\Common Files\System\ADO\msado15.dll" no_namespace rename ( "EOF", "adoEOF" )

```

不要被msdad15.dll中的15个骗了。显然，这个 DLL 在长系列的 MDAC 版本中没有更改名称。

那天我编译应用程序时，MDAC 的版本是 2.1。所以 _Recordset 使用 2.1 接口 id 编译，即运行这些组件的服务器返回的接口。

所有客户端都使用 1999 年生成（我相信）的 COM+ 应用程序代理。定义我的接口的类型库包括以下行：

```
importlib("msado21.tlb");

```

这解释了为什么他们希望在我的方法的输出参数中使用 Recordset 2.1 版。很明显，问题出在我 2003 年的重新编译上，而且当时 _Recordset 符号不再对应于 2.1 版。实际上 _Recordset 对应于 2.5 版本，其接口 id 不同。我的解决方案是在我的 C++ 代码中将所有引用从 _Recordset 更改为 Recordset21。我重建了组件并将它们部署到新服务器。瞧——客户似乎又高兴了。

总之，有两个困扰我的问题留给我。

为什么代理/存根基础结构似乎与 Vista 客户端的行为不同？与 XP 相比，Vista 似乎对从方法参数返回的接口 ID 进行了更严格的检查。

我应该如何在 1999 年以不同的方式对此进行编码，以免发生这种情况？接口应该是不可变的，当我在较新版本的 MDAC 下重新编译时，我无意中更改了我的接口，因为这些方法现在返回了不同的 Recordset 接口作为输出参数。据我所知，当时的类型库没有特定于版本的符号——也就是说，更高版本的 MDAC 类型库定义了 Recordset21，但该符号在 2.1 类型库中不可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T06:10:31.627

当微软获得安全信仰时，DCOM（和底层的 RPC）得到了很多关注，并且肯定有一些改变来关闭导致更严格的编组的安全漏洞。我很惊讶您在 Vista 中看到了这一点，但在 XP 中却没有，但有可能为 Vista 添加了额外的检查。或者，XP中的可选严格性可能在Vista中成为强制性的。

虽然我对 MDAC 了解得不够多，无法知道您是否可以阻止这种情况，但我确实知道安全是微软非常愿意牺牲向后兼容性的少数几个领域之一，因此您可能无法做任何事情”更好”早在 1999 年。

# .net - 中点舍入枚举

> ID：63723
> 
> 赞同：0
> 
> 时间：2008-09-15T15:05:18.560
> 
> 标签：.net

有没有办法可以在配置文件（即 web.config 或 app.config）中配置 MidPointRounding 枚举默认设置我有相当多的源代码库，我需要在应用程序范围内配置如何进行舍入，是否使用在 Math.Round 或小数类型舍入...我想这样做是为了在整个应用程序中获得一致的舍入结果，而无需更改使用小数类型或使用 Math.Round 的每一行...。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T05:55:20.277

您可以使用后编译工具玩游戏，这些工具会更改程序集以调用您的函数而不是 Math.Round。但是，我只会硬着头皮更改源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T16:07:36.897

Enum.Parse() 是你的朋友

```
MyEnum GetEnumValue(string enumString) {
  return (MyEnum)Enum.Parse(typeof(MyEnum),enumString);
} 
```

显然，您还需要对从配置文件中获取的字符串进行一些错误检查，在这种情况下，您可能希望返回默认值。

# intellij-idea - 为什么默认的 IntelliJ 默认类 javadoc 注释使用非标准语法？

> ID：63741
> 
> 赞同：45
> 
> 时间：2008-09-15T15:07:50.800
> 
> 标签：intellij-idea, javadoc

为什么默认的 IntelliJ 默认类 javadoc 注释使用非标准语法？它可以用“@author jstauffer”创建一行，而不是用“用户：jstauffer”创建一行。它创建的其他行（日期和时间）可能没有可用的 javadoc 语法，但为什么不使用可用的 javadoc 语法呢？

这里有一个例子供参考：

```
/**
 * 由 IntelliJ IDEA 创建。
 * 用户： jstauffer
 * 日期：2007 年 11 月 13 日
 * 时间：上午 11:15:10
 * 要更改此模板，请使用 File | 设置 | 文件模板。
 */
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-15T15:25:55.420

我不确定为什么 Idea`@author`默认不使用标签。

但是您可以通过转到`File -> Settings -> File Templates`并编辑选项卡`File Header`中的条目来更改此行为`Includes`。

从 IDEA 14 开始，它是：`File -> Settings -> Editor -> File and Code Templates -> Includes -> File Header`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-01-11T18:49:05.337

在 Mac 上的 AndroidStuido 1.0.2 中

进入**首选项** ，然后在左侧跨度**文件和代码模板** 选择右侧的文件和代码模板后，选择**包括**选项卡选择 **文件头**并更改文件头。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-03T00:53:54.363

默认值是可读、可用的，但不遵守或建议任何编码标准。

我认为 IntelliJ 在默认情况下不使用 Javadoc 标记的原因是为了避免可能干扰开发商店中可能存在的任何编码/javadoc 标准。如果需要将默认值修改为更合适的值，用户应该很清楚。

在我工作的地方，出于各种原因，不鼓励使用作者标签。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T19:42:10.313

因为它是一个默认文件模板，您应该根据组织的标准或您的喜好进行更改。

我最好的猜测。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T19:12:50.090

您显示的标题片段很可能比 javadoc 更早，并且只是从一些编码标准文档中借来的，可能是为 C++ 编写的。

# javascript - JavaScript 中的 innerHTML 操作

> ID：63743
> 
> 赞同：0
> 
> 时间：2008-09-15T15:08:05.510
> 
> 标签：javascript, html, dom

我正在开发一个网页代码，它从服务器动态获取内容，然后使用类似的东西将此内容放置到容器节点

```
container.innerHTML = content; 
```

有时我必须覆盖此节点中以前的一些内容。这很好用，直到以前的内容占用更多的垂直空间然后新的内容会占用并且用户向下滚动页面 - 滚动超过新内容允许的高度，前提是它的高度。

在这种情况下，页面会错误地重绘——旧内容的一些伪影仍然存在。它工作正常，甚至可以通过最小化和恢复浏览器（或强制以其他方式重绘窗口）来消除伪影，但这似乎不太方便。

我只在 Safari 下测试这个（这是一个 iPhone 优化的网站）。

有人知道如何处理这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T19:21:47.507

我发现的最简单的解决方案是在您正在编辑`<a>`的顶部放置一个锚标记：`div`

```
<a name="ajax-div"></a> 
```

然后，当您更改 的内容时`div`，您可以这样做让浏览器跳转到您的锚标记：

```
location.hash = 'ajax-div'; 
```

使用它来确保在您更新内容时用户不会向下滚动太多，并且您不应该首先遇到问题。

（在最新的 FF beta 和最新的 safari 中测试）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T16:47:16.270

听起来 Safari 的 webkit 渲染引擎一开始并没有识别出内容的变化，至少还不足以完全去除之前的 html 内容。最小化然后恢复窗口会在浏览器的渲染引擎中启动重绘事件。

我想我会探索 2 条途径：首先我可以使用 iframe 代替当前的“内容”节点吗？浏览器希望 IFrame 发生变化，但是正如您所见，它们并不总是那么擅长更改 DIV 或其他元素的内容。

其次，也许通过如前所述修改滚动位置。您可以按照建议将滚动条简单地移回 0，或者如果这太突兀，您可以尝试在内容更改后恢复滚动条。从当前滚动位置减去旧内容节点的高度（将浏览器的滚动重置为内容节点的 0），更改节点内容，然后将新节点的高度添加到滚动位置。

虽然 Palehorse 是对的（我目前无法投票赞成他的答案——没有分数），像 jQuery、Dojo 甚至 Prototype 这样的抽象库通常可以帮助解决这些问题。尤其是当您看到您的页面/站点超越了简单的 DOM 操作时，您会发现库提供的工具和增强功能非常有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T15:14:05.433

听起来您的浏览器本身有问题。这个问题只出现在一个浏览器中吗？

您可能会尝试的一件事是使用像[jQuery](http://jquery.com/)这样的轻量级库。它很好地处理了浏览器的差异。**要为具有容器**ID 的 div 设置内部 HTML，您只需编写以下代码：

```
$('#container').html( content ); 
```

这将适用于大多数浏览器。我不知道它是否会专门解决您的问题，但可能值得一试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T16:01:43.900

在替换内容之前将滚动位置设置回顶部（element.scrollTop = 0; element.scrollLeft = 0; by heart）是否有效？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T17:03:34.937

每次更新 innerHTML 时，将元素的 CSS 高度设置为“自动”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T17:04:16.870

我会尝试做 container.innerHTML = ''; container.innerHTML = 内容；

# java - 添加新元素时应该使用克隆吗？什么时候应该使用克隆？

> ID：63748
> 
> 赞同：2
> 
> 时间：2008-09-15T15:08:20.360
> 
> 标签：java, memory, class

我想在 Java 中实现一个用于处理图形数据结构的类。我有一个 Node 类和一个 Edge 类。Graph 类维护两个列表：节点列表和边列表。每个节点必须有一个唯一的名称。我该如何防范这样的情况：

```
Graph g = new Graph();

Node n1 = new Node("#1");
Node n2 = new Node("#2");

Edge e1 = new Edge("e#1", "#1", "#2");

// Each node is added like a reference
g.addNode(n1);
g.addNode(n2);
g.addEdge(e1);

// This will break the internal integrity of the graph
n1.setName("#3");   
g.getNode("#2").setName("#4"); 
```

我相信在将节点和边添加到图形时应该克隆它们并返回一个 NodeEnvelope 类，该类将保持图形结构的完整性。这是正确的做法还是设计从一开始就被打破了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T17:19:00.797

我在 Java 中经常使用图形结构，我的建议是使 Graph 依赖于维护其结构的 Node 和 Edge 类的任何数据成员都成为最终的，没有设置器。事实上，如果可以的话，我会让 Node 和 Edge 完全不可变，这有[很多好处](http://www.javapractices.com/topic/TopicAction.do?Id=29)。

因此，例如：

```
public final class Node {

    private final String name;

    public Node(String name) {
           this.name = name;
    }

    public String getName() { return name; }
    // note: no setter for name
} 
```

然后，您将在 Graph 对象中进行唯一性检查：

```
public class Graph {
    Set<Node> nodes = new HashSet<Node>();
    public void addNode(Node n) {
        // note: this assumes you've properly overridden 
        // equals and hashCode in Node to make Nodes with the 
        // same name .equal() and hash to the same value.
        if(nodes.contains(n)) {
            throw new IllegalArgumentException("Already in graph: " + node);
        }
        nodes.add(n);
    }
} 
```

如果您需要修改节点名称，请移除旧节点并添加新节点。这可能听起来像是额外的工作，但它可以节省很多精力来保持一切正常。

但是，实际上，从头开始创建自己的 Graph 结构可能是不必要的——如果您自己构建，这个问题只是您可能遇到的许多问题中的第一个。

我建议找到一个好的开源 Java 图形库，然后使用它。根据您在做什么，有一些选择。我过去使用过[JUNG](http://jung.sourceforge.net/)，我会推荐它作为一个很好的起点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T15:17:02.773

我不清楚为什么要为节点添加额外的字符串名称间接。`public Edge(String, Node, Node)`你的 Edge 构造函数的签名不是更有意义`public Edge (String, String, String)`吗？

我不知道克隆会在哪里帮助你。

ETA：如果危险来自在创建节点后更改节点名称，`IllegalOperationException`如果客户端尝试在具有现有名称的节点上调用 setName()，则抛出一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T15:12:28.277

在我看来，除非你明确声明你的数据结构这样做，否则你永远不应该克隆元素。

大多数事物所需的功能需要将实际对象通过引用传递到数据结构中。

如果你想让这个`Node`类更安全，就让它成为图的内部类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T17:51:34.697

使用 NodeEnvelopes 或边缘/节点工厂对我来说听起来像是过度设计。

你真的想在 Node 上公开一个 setName() 方法吗？您的示例中没有任何内容表明您需要它。如果您将 Node 和 Edge 类都设为不可变，那么您设想的大多数违反完整性的场景都将变得不可能。（如果您需要它们是可变的，但仅在它们被添加到图表之前，您可以通过在节点/边缘类上设置一个 isInGraph 标志来强制执行此操作，该标志由 Graph.Add{Node, Edge} 设置为 true，并且如果在设置此标志后调用，让您的 mutator 抛出异常。）

我同意 jhkiley 的观点，将 Node 对象传递给 Edge 构造函数（而不是字符串）听起来是个好主意。

如果您想要一种更具侵入性的方法，您可以使用从 Node 类返回到它所在的 Graph 的指针，并在 Node 的任何关键属性（例如，名称）发生变化时更新 Graph。但我不会这样做，除非您确定需要能够更改现有节点的名称，同时保留边缘关系，这似乎不太可能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-09T22:48:25.403

Object.clone() 存在一些重大问题，在大多数情况下不鼓励使用它。请参阅 Joshua Bloch 的“ [Effective Java](http://java.sun.com/docs/books/effective/) ”中的第 11 条以获得完整答案。我相信您可以在原始类型数组上安全地使用 Object.clone()，但除此之外，您需要谨慎地正确使用和覆盖克隆。您最好定义一个复制构造函数或根据您的语义显式克隆对象的静态工厂方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T16:47:21.107

除了@jhkiley.blogspot.com 的评论之外，您还可以为 Edges 和 Nodes 创建一个工厂，拒绝创建具有已使用名称的对象。

# sql-server - 您建议在开发环境中运行 SQL Server Express 2008 服务的用户帐户是什么？

> ID：63749
> 
> 赞同：29
> 
> 时间：2008-09-15T15:08:22.203
> 
> 标签：sql-server, installation, development-environment, account

SQL Server Express 2008 设置允许您为每个服务分配不同的用户帐户。

对于开发环境，您会使用域用户、本地用户、NT Authority\NETWORK SERCVICE、NT Authority\Local System 还是其他一些帐户，为什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-09-15T15:28:32.107

**不建议使用本地系统**，它是管理员等效帐户，因此可能会导致有问题的编码利用管理员特权，这在生产系统中是不允许的，因为具有安全意识的管理员/DBA 真的不喜欢以管理员身份运行服务.

根据服务器实例是否需要访问其他域资源，应该确定它应该在哪种类型的低权限帐户下运行。

如果它不需要访问任何（非匿名）域资源，那么我通常会创建一个唯一的本地低权限帐户来运行它，以便获得不在同一身份上下文中运行多个服务的额外安全优势. [请注意，SQL Server 或 SQL Server 代理服务不支持本地服务帐户。](http://msdn.microsoft.com/en-us/library/ms143504%28v=sql.105%29.aspx)

如果它确实需要访问非匿名域资源，那么您有三个选择：

1.  作为**[网络服务](http://msdn.microsoft.com/en-us/library/ms143504%28v=sql.105%29.aspx)**运行，它也是一个低权限帐户，但保留了计算机网络凭据。
2.  在本地服务帐户下运行
3.  在具有低本地权限的自定义域帐户下运行。在开发人员帐户下运行的一个优点是更容易以您自己的身份将调试器附加到进程而不会影响安全性，因此调试更容易（因为默认情况下非管理员帐户无权将调试器附加到另一个身份进程）。使用另一个域帐户的一个缺点是管理这些帐户的开销，特别是因为每个开发人员的每项服务理想情况下都应该具有唯一的凭据，因此如果开发人员离开，您不会有任何泄漏。

我倾向于做的大部分事情都不需要该服务来访问域资源，因此我倾向于使用我管理的唯一本地低权限帐户。我还以非管理员用户的身份运行（并且在 XP SP2、Server 2003、Vista 和 Server 2008 下运行，没有出现重大问题），所以当我需要该服务来访问域资源时，我不用担心关于使用我自己的域凭据（加上这样我不必担心网络管理员创建/维护一堆非生产域身份）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-15T15:12:54.483

这取决于。

*   本地系统 - 从不，它的特权太高了。
*   网络服务——也许，如果您需要连接到网络资源，但这是值得怀疑的。
*   本地服务 - 可能是最佳选择，权限有限，不解锁网络连接
*   本地交互用户？它真的需要有登录权限，或者作为用户吗？
*   域用户？天哪，除非您从其中访问网络驱动器，否则不会；如果 SQL 运行异常，则攻击者会针对该域进行身份验证。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-01T16:34:25.997

MS 现在有一篇很好的文章：http: [//msdn.microsoft.com/en-us/library/ms143504 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms143504(v=sql.105).aspx)

他们声明 SQL Server 引擎不允许本地服务。就个人而言，我使用本地系统只是为了避免在开发过程中出现问题，但在生产中，最佳实践是创建一个域级服务帐户，它只具有完成工作所需的权限。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-09-15T15:19:50.363

无论它想用作默认值。改变它只是在以后自找麻烦。

# html - 何时是使用and代替and的最佳时间，如果有的话？

> ID：63752
> 
> 赞同：3
> 
> 时间：2008-09-15T15:08:55.757
> 
> 标签：html, semantics

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-15T15:15:33.120

虽然总的来说，我会远离非语义标签，例如`b`and `i`，`strong`并且`em`不是 and 的直接替代`b`品`i`。

我会使用`b`or`i`当它只是您要进行的演示，而您要标记的内容没有语义意义。例如，像 stackoverflow 这样的标志可以用`stack<b>overflow</b>`. “溢出”部分对“堆栈”没有语义意义，但`stack<span class="overflow-logo">overflow</span>`也不提供任何东西。

希望这可以帮助。

* * *

不知道如何评论（编辑：需要 moar karma！），但这是对 Erik 评论的回复。

请阅读[HTML5 工作草案](http://www.whatwg.org/specs/web-apps/current-work/#the-b)。它很好地解释了何时使用`b`.

> 该`b`元素表示在风格上从普通散文中偏移的一段文本，而不传达任何额外的重要性，例如文档摘要中的关键词、评论中的产品名称或其他典型的印刷表示加粗的文本范围。

“溢出”在徽标中没有强调“堆栈”，因此用“溢出”包装`em`在语义上是不正确的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-15T15:09:38.643

绝不。它们在 XHTML 2.0 中被删除，因为它们是表示标签。CSS 应该用于粗体/斜体内容。

**编辑：**如果您正在寻找一个纯粹的展示标签，那就是`SPAN`带有类和一点 CSS 的标签的用途。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-15T15:25:15.437

根据[HTML 5 规范](http://www.w3.org/html/wg/html5/)，应该*在适当*`<b>`的时候使用。`<i>`

 *[在我](http://www.w3.org/html/wg/html5/#the-i)：

> [A] 以另一种声音或语气或以其他方式偏离正常散文的文本范围，例如分类名称、技术术语、来自另一种语言的惯用短语、思想、船名或其他一些散文典型的印刷表示是斜体。

[在 b 上](http://www.w3.org/html/wg/html5/#the-i)：

> [A] 文本范围在风格上与普通散文偏移，但不传达任何额外的重要性，例如文档摘要中的关键词、评论中的产品名称，或其他典型的排版显示为粗体的文本范围。

一般而言，当所有其他语义选项都已用尽时，“适当时”被认为是最后的手段。尽管它们可能是“表达性的”，但这肯定会损害它们的语义表亲`<em>`，并`<strong>`分别认为它们总是斜体或粗体。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-15T15:30:32.367

在[http://www.webmasterworld.com/forum21/7095-1-15.htm](http://www.webmasterworld.com/forum21/7095-1-15.htm)上有一个很好的评论：

> “如果页面阅读器真的 `<strong>`用强烈的声音阅读每个标签，或者真的强调`<em>`页面上的每个部分，那么可怜的用户就会得到一个页面定期对她或他大喊大叫。
> 
> 我觉得这个问题真的是不言而喻。如果我设置粗体或斜体字体仅用于排版，那么我使用`<b>`and `<i>`。如果有一个单词或短语我想在说话时强调，那么——而且只有这样——我才使用 `<strong>`or `<em>`。”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T15:14:04.450

对于由所见即所得编辑器生成的标记。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T15:22:30.763

多年来，我一直在使用 <b> 来指示我网站上的关键词。我编写了一个小实用程序，它会爬取站点以查找 <b> 标记并将它们添加到索引中。当我想加粗一个单词而不将它添加到索引时，我使用 <strong>。我已经使用这个约定好几年了——现在退出为时已晚。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T15:48:57.923

有技术规则，但这是我的两条经验法则：

1) 如果你正在写一些东西，如果说出来，你会强调一个词，<strong> 和 <em> 是合适的。（例如，“你一定是在*嘲笑*我，派尔！”）

2）如果您出于技术原因强调一个词，但不会在口语对话中强调该词，则 <b> 和 <i> 是合适的。（例如，“他登上 RMS *Titanic*并扬帆远航，再也见不到了。”）

不过，不要遗漏其他标签，例如 < cite >！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T16:02:27.283

正式地，<i /> 和 <b /> 是“展示性的”，不应使用。虽然许多开发人员认为 <em /> 和 <strong /> 是展示性的，但事实并非如此。它们通常分别为斜体和粗体，但 CSS 可以（并且应该在适当的时候）改变强调和强度的显示方式。

类似的事情可以用 <span /> 标签上的 css 完成，许多人认为这是首选方法，但规范无法证实。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-15T15:13:41.707

每当您想错误地做事时……开个玩笑。

真正的答案是永远不会，这些标签已被[W3C弃用](http://www.w3c.com/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T15:13:59.600

<b> 和 <i> 都不是语义标签，所以纯粹主义者会说它们不应该被使用。我认为它们的使用是合理的，例如将在线内容打印出来，其中文本以粗体或斜体作为惯例，而不是作为加强或强调内容的方式。

一个简单的例子是，如果您将一篇杂志文章放在网上，该文章按书名引用一本书：您可能希望将书名用斜体字表示，但斜体字不是为了强调，所以 <em> 标记不合适。您可以在此处使用 <i>，但语义上的做法是使用类似 <span class="booktitle"> 的内容，然后使用 CSS 将书名设为斜体。您引用的是标题，而不是强调，并且您不希望屏幕阅读器对标题进行口头强调。

我个人的观点是今天不要使用 <b> 或 <i> ，但是当您除了粗体或斜体之外并不想做任何事情时，使用 <strong> 或 <em> 作为它们的替代品同样不正确。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T15:17:44.770

我认为当你试图让你的标记有意义时，这些很少有用。

然而，有一些新标签产生了一些相同的结果，但提供了更多的语义价值。例如，当我提到一本书的名称时，我喜欢使用 <cite> 标签，因为它仍然是斜体，但现在 HTML 带有关于原因的含义。

还有许多其他语义标签也会影响此处列出的格式：

[http://www.w3.org/TR/xhtml2/mod-text.html](http://www.w3.org/TR/xhtml2/mod-text.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T15:34:59.737

可以说标签仍然有一个用途`<i>`：当表达一个物种的学名（又名拉丁名）时。按照惯例，物种的学名通常以斜体显示。[*例子*](http://en.wikipedia.org/wiki/Golden_eagle)。在这种情况下使用它在语义上是不正确的，`<em>`因为人们不是试图强调名称，而只是在视觉上区分它。使用类似的东西可能更合适`<span class="sci-name">`，但是当人们考虑到大多数科学名称是由[斜体语言](http://en.wikipedia.org/wiki/Italic_languages)的单词组成时，主要是拉丁语，`<i>`标签就成为一种语义丰富且方便的解决方案。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T15:12:25.827

<b> 和 <i> 标签没有语义，而 <strong> 和 <em> 有。如果读者大声朗读文本块，它将对 <strong> 和 <em> 标签做出反应，而 <i> 和 <b> 标签将被忽略，并被视为纯视觉元素。我倾向于将 <i> 和 <b> 视为已弃用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-01-17T04:09:42.967

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2008-09-15T15:12:21.537

**为移动设备编写网站时**。它们并不总是支持“最新和最伟大”的标准，在所有现代浏览器中都已贬值但并未删除，并且占用的空间和带宽更少（尽管理论上流是由网站或无线浏览器压缩的，但不能指望）。

-亚当

# sharepoint - 无需使用信息路径即可在 SharePoint 中创建电子邮件表单的简单方法

> ID：63755
> 
> 赞同：3
> 
> 时间：2008-09-15T15:09:16.460
> 
> 标签：sharepoint

有谁知道这样做的好方法？我需要有简单的表单，无需编写大量代码即可提交到电子邮件。这些表单将托管在 MOSS 2007 中的内容查看器 Web 部件或类似部件中。我想避免使用 InfoPath。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T15:46:26.510

您可以使用一个列表来为您提供输入表单。

这取决于 a) 人们是否应该能够看到彼此的提交内容和 b) 电子邮件应该发给谁。

您可以设置警报（操作 -> 提醒我）以在将新项目添加到列表时向一个人/多个人发送电子邮件。

在设置 -> 列表设置 -> 高级设置中，有用户可以查看/编辑的项目的选项。但是，不能在用户只能看到自己的项目的列表上设置警报。在这种情况下，我会使用一个简单的工作流程来发送电子邮件。不过，我只使用过 MOSS 2007 和 SharePoint Designer - 我不确定 WSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T00:37:54.237

您可以按照上面的建议实现一个列表，并添加一个[SPItemEventReceiver](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spitemeventreceiver_methods.aspx)以在添加或更改列表项时发送电子邮件（链接显示所有可处理的事件）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T21:19:15.430

Sharepoint Designer 中的工作流应该是实现它的最简单方法，无需编码。

这是一篇解释如何执行此操作的文章：

**工作流程示例：发送通知消息**： http: [//office.microsoft.com/en-us/sharepointdesigner/HA101829081033.aspx](http://office.microsoft.com/en-us/sharepointdesigner/HA101829081033.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T15:11:42.630

使用 sharepoint sdk，您可以创建自己的 Web 部件。如果您将它们添加到 GAC，您可以将它们包含在您的 sharepoint 站点中。不过，您当然必须构建一个用于发送电子邮件的 Web 部件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-30T23:44:13.933

`text boxes`在文本编辑器中使用所需的 、等创建一个简单的 HTML 表单`text areas`，`select drop downs`添加 mailto 标记并保存。

然后在媒体和内容下添加页面查看器 Web 部件。

选择站点操作，编辑页面并在编辑工具选项卡下选择格式文本，HTML 标记编辑 HTML 源并将您创建的 HTML 表单粘贴到文本编辑器中，然后选择确定并保存。

# xml - 有没有办法“区分”两个 XML 元素？

> ID：63756
> 
> 赞同：0
> 
> 时间：2008-09-15T15:09:20.903
> 
> 标签：xml, comparison, diff, dtd

我需要检查两个 XML 之间的差异，但不是“盲目地”，鉴于两者都使用相同的 DTD，我实际上有兴趣验证它们是否具有相同数量的元素或是否存在差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T15:37:38.793

*   [来自Logilab](http://www.logilab.org/859)的 xmldiff
*   [diffxml](http://diffxml.sourceforge.net/)
*   包含在[XMLSpy中的商业版本](http://www.altova.com/products/xmlspy/xml_differencing.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T16:16:36.453

[oXygen](http://www.oxygenxml.com/xml_diff_and_merge.html)具有良好的 XML 差异（和合并）支持。

# java - 是否可以从另一个虚拟机中杀死一个 Java 虚拟机？

> ID：63758
> 
> 赞同：4
> 
> 时间：2008-09-15T15:09:23.527
> 
> 标签：java, process-management

我有一个启动另一个 Java 应用程序的 Java 应用程序。启动器有一个看门狗定时器，并定期接收来自第二个虚拟机的通知。但是，如果没有收到通知，则应终止第二个虚拟机，并且启动器将执行一些额外的清理活动。

问题是，有没有办法只使用java来做到这一点？到目前为止，我必须使用一些本机方法来执行此操作，而且它有点难看。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T15:24:49.043

我可能遗漏了一些东西，但你不能在返回的对象[`destroy()`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Process.html#destroy())上调用方法吗？[`Process`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Process.html)[`Runtime.exec()`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Runtime.html#exec(java.lang.String))

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-15T15:42:10.263

你可以使用[java.lang.Process](http://java.sun.com/javase/6/docs/api/java/lang/Process.html)来做你想做的事。创建嵌套流程并引用 Process 实例后，您可以获取对其标准输出和错误流的引用。你可以定期监控这些，如果你想关闭进程，可以调用 .destroy() 。整个事情可能看起来像这样：

```
Process nestedProcess = new ProcessBuilder("java mysubprocess").start();
InputStream nestedStdOut = nestedProcess.getInputStream(); //kinda backwards, I know
InputStream nestedStdErr = nestedProcess.getErrorStream();
while (true) {
    /*
       TODO: read from the std out or std err (or get notifications some other way)
       Then put the real "kill-me" logic here instead of if (false)
    */
    if (false) {
        nestedProcess.destroy();
        //perform post-destruction cleanup here
        return;
    }

    Thread.currentThread().sleep(1000L); //wait for a bit
} 
```

希望这可以帮助，

肖恩

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-15T15:26:00.863

您还可以在调用 System.exit() 的第二个 JVM 上发布服务（通过粗麻布、粗麻布等）并从看门狗 JVM 中使用它。如果您只想在第二个 JVM 停止发送这些定期通知时将其关闭，则它可能无法响应服务调用。

使用 java.lang.Runtime.exec() 调用 shell 命令可能是您最好的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T08:30:36.137

执行此操作的常用方法是调用`Process.destroy()`... 但是它是一个不完整的解决方案，因为在 *nix 上使用 sun JVM 时会破坏映射到不能保证终止进程的 SIGTERM（因为您也需要 SIGKILL）。最终结果是您无法使用 Java 进行真正的流程管理。

关于这个问题有一些未解决的错误，请参阅： [链接文本](http://bugs.sun.com/view_bug.do?bug_id=4073195)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T15:47:58.707

`java.lang.Process`有`waitFor()`等待进程死亡的`destroy()`方法，以及杀死子进程的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T07:17:22.363

好的，要点如下：

我正在使用 Process API 关闭第二个虚拟机，但它不起作用。

原因是我的第二个应用程序是一个 Eclipse RCP 应用程序，我使用包含的 eclipse.exe 启动器启动它。

但是，这意味着 Process API destroy() 方法将针对 eclipse.exe 进程。杀死这个进程使 Java 进程毫发无损。因此，我的一位同事在这里编写了一个小应用程序，它将杀死正确的应用程序。

因此，使用 Process API（并删除多余的中间步骤）的解决方案之一是摆脱 Eclipse 启动器，让我的第一台虚拟机复制其所有功能。

我想我得去上班了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T15:14:01.673

你应该能够做到这一点`java.lang.Runtime.exec`和 shell 命令。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T15:17:24.537

您可以让 java 代码在运行时检测平台并触发平台的终止进程命令。这确实是对您当前解决方案的改进。

还有[Process.destroy()](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Process.html#destroy())，如果您使用的是[ProcessBuilder](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ProcessBuilder.html) API

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-15T15:29:14.837

不完全是进程管理，但您可以在您正在启动的 java 虚拟机中启动一个 rmi 服务器，并将[远程](http://java.sun.com/j2se/1.5.0/docs/api/java/rmi/Remote.html)实例绑定到一个方法，该方法执行所需的任何清理并调用 System.exit()。然后第一个 vm 可以调用该远程方法来关闭第二个 vm。

# php - 我对哪些数据库有权限

> ID：63764
> 
> 赞同：5
> 
> 时间：2008-09-15T15:09:54.210
> 
> 标签：php, sql, mysql, permissions

如何在基本 SQL、特定于 MySQL 或 PHP 中找到我对哪些数据库具有最低读取权限？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-01T13:22:51.007

MySQL中有一个命令可以显示您拥有的所有权限。命令是：

```
显示赠款；

```

它会给你类似的输出：

```
root@(none)~> 显示授权；
+-------------------------------------------------- ------------------+
| 授予 root@localhost |
+-------------------------------------------------- ------------------+
| GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION |
+-------------------------------------------------- ------------------+
一组中的 1 行（0.00 秒）

```

这在[此处的手册](http://dev.mysql.com/doc/refman/5.0/en/show-grants.html)中有记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T15:19:22.770

在 MySQL 中，可以执行

`SHOW DATABASES;`

**描述**

`SHOW DATABASES;`查看您至少可以访问的内容。您是否在寻找更程序化的东西？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-10T02:03:11.297

您也可以尝试使用 phps 连接到数据库 mysql_connect(...) 会快速告诉您是否有权访问。

# shell - 用于 unix 管道命令的调试器

> ID：63771
> 
> 赞同：4
> 
> 时间：2008-09-15T15:10:13.570
> 
> 标签：shell, terminal

当我构建 *nix 管道命令时，我发现我想在构建下一阶段之前查看一个阶段的输出以验证正确性，但我不想重新运行每个阶段。有谁知道可以帮助解决这个问题的程序？它将自动保留最后阶段的输出以用于任何新阶段。我通常通过将每个命令的结果发送到一个临时文件（即 tee 或一次运行每个命令）来做到这一点，但如果程序处理这个会很好。

我设想一个类似于选项卡式界面的东西，其中每个选项卡都标有每个管道命令，选择一个选项卡会显示将该命令应用于先前结果的输出（至少一百行）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T15:11:35.797

使用 'tee' 将中间结果复制到某个文件，并将它们传递到管道的下一个阶段，如下所示：

```
cat /var/log/syslog | tee /tmp/syslog.out | grep something | tee /tmp/grep.out | sed 's/foo/bar/g' | tee /tmp/sed.out | cat >>/var/log/syslog.cleaned 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T15:16:31.777

如果您需要双向通信（即使用 netcat），也可以使用管道：

```
mknod backpipe p
nc -l -p 80 0<backpipe | tee -a inflow | nc localhost 81 | tee -a outflow 1>backpipe 
```

（[通过](http://clug.net.nz/index.php/netcat "通过")）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T15:21:10.097

还有“pv”命令 - 在 debian / ubuntu 存储库中可用，它向您显示管道的吞吐量。

手册页中的示例：从另一个进程传输文件并将预期大小传递给 pv：

```
 cat file | pv -s 12345 | nc -w 1 somewhere.com 3000 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T15:13:41.050

`tee`(1) 是你的朋友。它将其输入发送到指定的文件和标准输出。

把它粘在你的管道之间。例如：

```
ls | tee /tmp/out1 | sort | tee /tmp/out2 | sed 's/foo/bar/g' 
```

# c - 整数的位反转，忽略整数大小和字节序

> ID：63776
> 
> 赞同：6
> 
> 时间：2008-09-15T15:10:49.107
> 
> 标签：c, integer, bit-manipulation

给定一个整数 typedef：

```
typedef unsigned int TYPE; 
```

或者

```
typedef unsigned long TYPE; 
```

我有以下代码来反转整数的位：

```
TYPE max_bit= (TYPE)-1;

void reverse_int_setup()
{
    TYPE bits= (TYPE)max_bit;

    while (bits <<= 1)
        max_bit= bits;
}

TYPE reverse_int(TYPE arg)
{
    TYPE    bit_setter= 1, bit_tester= max_bit, result= 0;

    for (result= 0; bit_tester; bit_tester>>= 1, bit_setter<<= 1)
        if (arg & bit_tester)
            result|= bit_setter;
    return result;
} 
```

只需要首先运行 reverse_int_setup()，它存储一个最高位打开的整数，然后对 reverse_int( *arg* ) 的任何调用都返回*arg*，并将其位反转（用作二叉树的键，取自增加计数器，但这或多或少无关紧要）。

在调用 reverse_int_setup(); 之后，是否有一种与平台无关的方法可以在编译时获得 max_int 的正确值？否则，是否有一种算法你认为比我对 reverse_int()的算法*更好/更精简？*

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T16:50:28.587

以下程序用于演示用于反转位的更精简的算法，可以轻松扩展以处理 64 位数字。

```
#include <stdio.h>
#include <stdint.h>
int main(int argc, char**argv)
{
        int32_t x;
        if ( argc != 2 ) 
        {
                printf("Usage: %s hexadecimal\n", argv[0]);
                return 1;
        }

        sscanf(argv[1],"%x", &x);
        /* swap every neigbouring bit */
        x = (x&0xAAAAAAAA)>>1 | (x&0x55555555)<<1;
        /* swap every 2 neighbouring bits */
        x = (x&0xCCCCCCCC)>>2 | (x&0x33333333)<<2;
        /* swap every 4 neighbouring bits */
        x = (x&0xF0F0F0F0)>>4 | (x&0x0F0F0F0F)<<4;
        /* swap every 8 neighbouring bits */
        x = (x&0xFF00FF00)>>8 | (x&0x00FF00FF)<<8;
        /* and so forth, for say, 32 bit int */
        x = (x&0xFFFF0000)>>16 | (x&0x0000FFFF)<<16;
        printf("0x%x\n",x);
        return 0;
} 
```

此代码不应包含错误，并使用 0x12345678 进行测试以生成正确答案 0x1e6a2c48。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-16T10:06:42.217

```
#include<stdio.h>
#include<limits.h>

#define TYPE_BITS sizeof(TYPE)*CHAR_BIT

typedef unsigned long TYPE;

TYPE reverser(TYPE n)
{
    TYPE nrev = 0, i, bit1, bit2;
    int count;

    for(i = 0; i < TYPE_BITS; i += 2)
    {
        /*In each iteration, we  swap one bit on the 'right half' 
        of the number with another on the left half*/

        count = TYPE_BITS - i - 1;  /*this is used to find how many positions 
                                    to the left (and right) we gotta move 
                                    the bits in this iteration*/

        bit1 = n & (1<<(i/2)); /*Extract 'right half' bit*/
        bit1 <<= count;         /*Shift it to where it belongs*/

        bit2 = n & 1<<((i/2) + count);  /*Find the 'left half' bit*/
        bit2 >>= count;         /*Place that bit in bit1's original position*/

        nrev |= bit1;   /*Now add the bits to the reversal result*/
        nrev |= bit2;
    }
    return nrev;
}

int main()
{
    TYPE n = 6;

    printf("%lu", reverser(n));
    return 0;
} 
```

这次我使用了 TK 中的“位数”的想法，但通过不假设一个字节包含 8 位而是使用 CHAR_BIT 宏来使其更具可移植性。代码现在更高效（删除了内部 for 循环）。我希望这次代码也稍微不那么神秘。:)

使用 count 的需要是，每次迭代中我们必须移动一位的位置的数量是不同的——我们必须将最右边的位移动 31 个位置（假设为 32 位），第二个最右边的位移动 29 个位置，依此类推在。因此，随着 i 的增加，计数必须随着每次迭代而减少。

希望这些信息有助于理解代码......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-15T17:30:30.130

```
typedef unsigned long TYPE;

TYPE reverser(TYPE n)
{
    TYPE k = 1, nrev = 0, i, nrevbit1, nrevbit2;
    int count;

    for(i = 0; !i || (1 << i && (1 << i) != 1); i+=2)
    {
        /*In each iteration, we  swap one bit 
            on the 'right half' of the number with another 
            on the left half*/

        k = 1<<i; /*this is used to find how many positions 
                    to the left (or right, for the other bit) 
                    we gotta move the bits in this iteration*/

        count = 0;

        while(k << 1 && k << 1 != 1)
        {
            k <<= 1;
            count++;
        }

        nrevbit1 = n & (1<<(i/2));
        nrevbit1 <<= count;

        nrevbit2 = n & 1<<((i/2) + count);
        nrevbit2 >>= count;

        nrev |= nrevbit1;
        nrev |= nrevbit2;
    }
    return nrev;
} 
```

这在 Windows 下的 gcc 中运行良好，但我不确定它是否完全独立于平台。几个值得关注的地方是：

*   for 循环中的条件 - 它假定当您将 1 移到最左边的位之外时，您会得到一个 0 和 1 的“脱落”（我所期望的以及旧 Turbo C 给 iirc 带来的好处），或者1 圈，你得到一个 1（这似乎是 gcc 的行为）。

*   内部while循环中的条件：见上文。但是这里发生了一件奇怪的事情：在这种情况下，gcc 似乎让 1 掉出来而不是绕圈子！

代码可能很神秘：如果您有兴趣并需要解释，请不要犹豫——我会把它放在某个地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-16T16:39:20.820

@ΤZΩΤZΙΟΥ

在回复 ΤZΩΤZΙΟΥ 的评论时，我提出了上面的修改版本，它取决于位宽的上限。

```
#include <stdio.h>
#include <stdint.h>
typedef int32_t TYPE;
TYPE reverse(TYPE x, int bits)
{
    TYPE m=~0;
    switch(bits)
    {
        case 64:
            x = (x&0xFFFFFFFF00000000&m)>>16 | (x&0x00000000FFFFFFFF&m)<<16;
        case 32:
            x = (x&0xFFFF0000FFFF0000&m)>>16 | (x&0x0000FFFF0000FFFF&m)<<16;
        case 16:
            x = (x&0xFF00FF00FF00FF00&m)>>8 | (x&0x00FF00FF00FF00FF&m)<<8;
        case 8:
            x = (x&0xF0F0F0F0F0F0F0F0&m)>>4 | (x&0x0F0F0F0F0F0F0F0F&m)<<4;
            x = (x&0xCCCCCCCCCCCCCCCC&m)>>2 | (x&0x3333333333333333&m)<<2;
            x = (x&0xAAAAAAAAAAAAAAAA&m)>>1 | (x&0x5555555555555555&m)<<1;
    }
    return x;
}

int main(int argc, char**argv)
{
    TYPE x;
    TYPE b = (TYPE)-1;
    int bits;
    if ( argc != 2 ) 
    {
        printf("Usage: %s hexadecimal\n", argv[0]);
        return 1;
    }
    for(bits=1;b;b<<=1,bits++);
    --bits;
    printf("TYPE has %d bits\n", bits);
    sscanf(argv[1],"%x", &x);

    printf("0x%x\n",reverse(x, bits));
    return 0;
} 
```

笔记：

*   gcc 将警告 64 位常量
*   printfs 也会产生警告
*   如果您需要超过 64 位，代码应该足够简单以便扩展

我提前为我在上面犯下的编码罪行道歉 - 仁慈的好先生！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T02:09:31.917

[在http://graphics.stanford.edu/~seander/bithacks.html](http://graphics.stanford.edu/~seander/bithacks.html)上有一个很好的“Bit Twiddling Hacks”合集，包括各种用 C 编码的简单和不那么简单的位反转算法。

我个人喜欢“明显”算法（[http://graphics.stanford.edu/~seander/bithacks.html#BitReverseObvious](http://graphics.stanford.edu/~seander/bithacks.html#BitReverseObvious)），因为它很明显。其他一些可能需要较少的指令来执行。如果我真的需要优化某些东西，我可能会选择不太明显但速度更快的版本。否则，为了可读性、可维护性和可移植性，我会选择明显的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-04T05:36:40.530

这是一个更普遍有用的变体。它的优点是它能够在要反转的值（代码字）的位长度未知但保证不超过我们称为 maxLength 的值的情况下工作。这种情况的一个很好的例子是霍夫曼代码解压缩。

下面的代码适用于长度为 1 到 24 位的码字。它已针对在 Pentium D 上的快速执行进行了优化。请注意，每次使用它访问查找表多达 3 次。我尝试了许多变体，以牺牲更大的表（4096 和 65,536 个条目）为代价将这个数字减少到 2。这个具有 256 字节表的版本是明显的赢家，部分原因是表数据位于缓存中非常有利，也可能是因为处理器具有 8 位表查找/翻译指令。

```
const unsigned char table[] = {  
0x00,0x80,0x40,0xC0,0x20,0xA0,0x60,0xE0,0x10,0x90,0x50,0xD0,0x30,0xB0,0x70,0xF0,  
0x08,0x88,0x48,0xC8,0x28,0xA8,0x68,0xE8,0x18,0x98,0x58,0xD8,0x38,0xB8,0x78,0xF8,  
0x04,0x84,0x44,0xC4,0x24,0xA4,0x64,0xE4,0x14,0x94,0x54,0xD4,0x34,0xB4,0x74,0xF4,  
0x0C,0x8C,0x4C,0xCC,0x2C,0xAC,0x6C,0xEC,0x1C,0x9C,0x5C,0xDC,0x3C,0xBC,0x7C,0xFC,  
0x02,0x82,0x42,0xC2,0x22,0xA2,0x62,0xE2,0x12,0x92,0x52,0xD2,0x32,0xB2,0x72,0xF2,  
0x0A,0x8A,0x4A,0xCA,0x2A,0xAA,0x6A,0xEA,0x1A,0x9A,0x5A,0xDA,0x3A,0xBA,0x7A,0xFA,  
0x06,0x86,0x46,0xC6,0x26,0xA6,0x66,0xE6,0x16,0x96,0x56,0xD6,0x36,0xB6,0x76,0xF6,  
0x0E,0x8E,0x4E,0xCE,0x2E,0xAE,0x6E,0xEE,0x1E,0x9E,0x5E,0xDE,0x3E,0xBE,0x7E,0xFE,  
0x01,0x81,0x41,0xC1,0x21,0xA1,0x61,0xE1,0x11,0x91,0x51,0xD1,0x31,0xB1,0x71,0xF1,  
0x09,0x89,0x49,0xC9,0x29,0xA9,0x69,0xE9,0x19,0x99,0x59,0xD9,0x39,0xB9,0x79,0xF9,  
0x05,0x85,0x45,0xC5,0x25,0xA5,0x65,0xE5,0x15,0x95,0x55,0xD5,0x35,0xB5,0x75,0xF5,  
0x0D,0x8D,0x4D,0xCD,0x2D,0xAD,0x6D,0xED,0x1D,0x9D,0x5D,0xDD,0x3D,0xBD,0x7D,0xFD,  
0x03,0x83,0x43,0xC3,0x23,0xA3,0x63,0xE3,0x13,0x93,0x53,0xD3,0x33,0xB3,0x73,0xF3,  
0x0B,0x8B,0x4B,0xCB,0x2B,0xAB,0x6B,0xEB,0x1B,0x9B,0x5B,0xDB,0x3B,0xBB,0x7B,0xFB,  
0x07,0x87,0x47,0xC7,0x27,0xA7,0x67,0xE7,0x17,0x97,0x57,0xD7,0x37,0xB7,0x77,0xF7,  
0x0F,0x8F,0x4F,0xCF,0x2F,0xAF,0x6F,0xEF,0x1F,0x9F,0x5F,0xDF,0x3F,0xBF,0x7F,0xFF};  

const unsigned short masks[17] =  
{0,0,0,0,0,0,0,0,0,0X0100,0X0300,0X0700,0X0F00,0X1F00,0X3F00,0X7F00,0XFF00};  

unsigned long codeword;   // value to be reversed, occupying the low 1-24 bits  
unsigned char maxLength;  // bit length of longest possible codeword (<= 24)  
unsigned char sc;         // shift count in bits and index into masks array  

if (maxLength <= 8)  
{  
   codeword = table[codeword << (8 - maxLength)];  
}  
else  
{  
   sc = maxLength - 8;  

   if (maxLength <= 16)  
   {
      codeword = (table[codeword & 0X00FF] << sc)  
               |  table[codeword >> sc];  
   }  
   else if (maxLength & 1)  // if maxLength is 17, 19, 21, or 23  
   {  
      codeword = (table[codeword & 0X00FF] << sc)  
               |  table[codeword >> sc] |  
                 (table[(codeword & masks[sc]) >> (sc - 8)] << 8);  
   }  
   else  // if maxlength is 18, 20, 22, or 24  
   {  
      codeword = (table[codeword & 0X00FF] << sc)  
               |  table[codeword >> sc]  
               | (table[(codeword & masks[sc]) >> (sc >> 1)] << (sc >> 1));  
   }  
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T15:17:51.447

怎么样：

```
long temp = 0;
int counter = 0;
int number_of_bits = sizeof(value) * 8; // get the number of bits that represent value (assuming that it is aligned to a byte boundary)

while(value > 0)            // loop until value is empty
{
    temp <<= 1;             // shift whatever was in temp left to create room for the next bit
    temp |= (value & 0x01); // get the lsb from value and set as lsb in temp
    value >>= 1;            // shift value right by one to look at next lsb

    counter++;
}

value = temp;

if (counter < number_of_bits)
{
    value <<= counter-number_of_bits;
} 
```

（我假设您知道有多少位值保存并且它存储在 number_of_bits 中）

显然 temp 需要是可以想象的最长的数据类型，并且当您将 temp 复制回 value 时， temp 中的所有无关位都应该神奇地消失（我认为！）。

或者，“c”方式是说：

```
while(value) 
```

你的选择

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T15:37:05.970

我们可以将反转所有可能的 1 字节序列的结果存储在一个数组中（256 个不同的条目），然后使用对该表的查找和一些 oring 逻辑的组合来获得整数的反转。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T16:06:12.460

这是 TK 解决方案的变体和更正，它可能比 sundar 的解决方案更清晰。它从 t 中获取单个位并将它们推入 return_val：

```
typedef unsigned long TYPE;
#define TYPE_BITS sizeof(TYPE)*8

TYPE reverser(TYPE t)
{
    unsigned int i;
    TYPE return_val = 0
    for(i = 0; i < TYPE_BITS; i++)
    {/*foreach bit in TYPE*/
        /* shift the value of return_val to the left and add the rightmost bit from t */
        return_val = (return_val << 1) + (t & 1);
        /* shift off the rightmost bit of t */
        t = t >> 1;
    }
    return(return_val);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-04T05:44:04.947

适用于任何大小的任何类型的对象的通用方法是反转对象的字节数，并反转每个字节中的位顺序。在这种情况下，位级算法与具体数量的位（一个字节）相关联，而“可变”逻辑（关于大小）被提升到整个字节的级别。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-22T02:06:09.857

如果位反转是时间关键的，并且主要与 FFT 结合使用，最好是存储整个位反转数组。在任何情况下，该数组的大小都将小于必须在 FFT Cooley-Tukey 算法中预先计算的单位根。计算数组的一种简单方法是：

```
int BitReverse[Size]; // Size is power of 2
void Init()
{
   BitReverse[0] = 0;
   for(int i = 0; i < Size/2; i++)
   {
      BitReverse[2*i] = BitReverse[i]/2;
      BitReverse[2*i+1] = (BitReverse[i] + Size)/2;
   }
} // end it's all 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-02-18T01:38:20.283

这是我对自由空间解决方案的概括（以防有一天我们得到 128 位机器）。当使用 gcc -O3 编译时，它会产生无跳转代码，并且显然对 foo_t 在正常机器上的定义不敏感。不幸的是，它确实取决于 shift 是 2 的幂！

```
#include <limits.h>
#include <stdio.h>

typedef unsigned long foo_t;

foo_t reverse(foo_t x)
{
        int shift = sizeof (x) * CHAR_BIT / 2;
        foo_t mask = (1 << shift) - 1;
        int i;

        for (i = 0; shift; i++) {
                x = ((x & mask) << shift) | ((x & ~mask) >> shift);
                shift >>= 1;
                mask ^= (mask << shift);
        }

        return x;
}       

int main() {
        printf("reverse = 0x%08lx\n", reverse(0x12345678L));
} 
```

# winforms - 在 WinForms 中拥有 ASP.NET 的 RadioButtonList 功能有哪些选择？

> ID：63778
> 
> 赞同：0
> 
> 时间：2008-09-15T15:10:55.800
> 
> 标签：winforms, webforms, radio-button, radiobuttonlist

这种类型的控件是否仅在第 3 方库中可用？有人实现了开源版本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T15:17:33.083

我相信您可以在网格中包含单选按钮，尽管这比需要的更麻烦。

另外，我认为制作自己的控件并使用流布局面板动态创建单选按钮并不难。

# c++ - 在 C++ 应用程序中实现脚本

> ID：63784
> 
> 赞同：26
> 
> 时间：2008-09-15T15:11:42.630
> 
> 标签：c++, scripting

我想将我的应用程序的各个部分移动到简单的脚本中，以允许对 C++ 不甚了解的人能够编辑和实现各种功能。

因为它是一个实时应用程序，所以我需要对这些脚本进行某种多任务处理。理想情况下，我希望它让 c++ 应用程序调用一个脚本函数，然后继续运行（在 c++ 线程下），直到一个暂停点（Wait(x)），或者它返回。在等待的情况下，需要保存状态，以便在持续时间到期后下一次应用程序循环时重新启动脚本。

脚本还需要能够调用 c++ 类方法，最好使用 c++ 类，而不是围绕 c++ 类的普通包装函数。

我不想花费大量时间来实现这一点，因此使用现有的脚本语言比编写自己的脚本语言更可取。我听说 Python 和 Lua 可以集成到一个 c++ 应用程序中，但我不知道如何做到这一点以实现我的目标。

*   脚本必须能够调用 c++ 函数
*   当调用某些函数（例如等待）时，脚本必须能够“暂停”，并由 c++ 线程再次重新启动
*   需要快速——这是一个实时应用程序，可能有很多脚本正在运行。

如果可以保存和重新启动脚本（可能由与原始线程不同的线程），我可能可以相当轻松地滚动多任务代码。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-15T16:56:52.113

您可以使用 Lua 或 Python。Lua 比 python 更“轻量级”。它的内存占用比 python 小，并且根据我们的经验更容易集成（人们在这一点上的里程可能会有所不同）。它可以支持一堆脚本同时运行。至少，Lua 支持以您想要的方式停止/启动线程。

Boost.python 很好，但在我（有限的）经验中，我们很难为不同的环境进行编译，而且相当重量级。它有（在我看来）需要 Boost 的缺点。对于某些人来说，这可能不是问题，但如果您不需要 Boost（或不使用它），您将引入大量代码来让 Boost.python 工作。YMMV。

我们已将 Lua 构建到多个平台（win32、Xbox360 和 PS3）上的应用程序中。我相信它可以在 x64 上运行。使用 Luabind 的建议很好。我们最终在两者之间编写了自己的接口，虽然不太复杂，但拥有该胶水代码将为您节省大量时间，也许还会让您烦恼。

但是，无论使用哪种解决方案，调试都可能很痛苦。我们目前没有很好的解决方案来调试嵌入到我们应用程序中的 Lua 脚本。由于我们没有在我们的应用程序中使用 python，我无法谈论那里可能有哪些工具可用，但几年前情况大致相同——调试很差。使用脚本来扩展功能很好，但脚本中的错误可能会导致问题并且可能难以定位。

如果您需要在那里进行更改，Lua 代码本身就有点混乱。我们已经在 Lua 代码库本身中看到了难以追踪的错误。我怀疑 Boost::Python 可能有类似的问题。

并且对于任何脚本语言，它不一定是“非程序员”扩展功能的解决方案。看起来好像是这样，但您最终可能会花费大量时间来调试脚本，甚至可能是 Lua。

总而言之，我们对 Lua 非常满意，并在两场比赛中发布了它。我们目前没有放弃该语言的计划。总而言之，我们发现它比几年前可用的其他替代品更好。Python（和 IronPython）是其他选择，但根据经验，它们似乎比 Lua 更笨重。不过，我很想听听那里的其他经历。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-15T15:19:01.600

我强烈建议您看一下[Luabind](http://sourceforge.net/projects/luabind/)。它将 Lua 集成到您的 C++ 代码中变得非常简单，反之亦然。也可以公开整个 C++ 类以在 Lua 中使用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-15T15:27:16.040

最好的办法是嵌入 lua (www.lua.org) 或 python (www.python.org)。两者都用于游戏行业，并且都相对容易地访问 extern "C" 函数，而 lua 在这里具有优势（因为数据类型更容易在 lua 和 C 之间转换）。与 C++ 对象的接口对您来说需要更多的工作，但您可以在 Google、lua 或 python 讨论论坛上查找如何执行此操作。

我希望这会有所帮助！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-15T15:22:44.413

你绝对可以用 Python 做你想做的事。 [这是将 Python 嵌入应用程序的文档。](http://docs.python.org/ext/embedding.html) 我很确定 Lua 也可以，只是我对它不太熟悉。

您正在描述协作式多任务处理，其中脚本需要定期调用 Break 或 Wait 函数。也许更好的解决方案是在自己的线程中运行脚本语言，然后使用互斥锁或无锁队列作为脚本语言和程序其余部分之间的接口。这样，一个不经常调用 Break() 的错误脚本就不会意外冻结您的程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-15T15:18:15.767

看看[Boost.Python](http://www.boost.org/doc/libs/1_36_0/libs/python/doc/index.html)库。看起来做你想做的事情应该相当简单。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-15T17:04:42.577

看看[SWIG](http://www.swig.org)。我用它来与 Python 交互，但它支持许多其他语言。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-15T17:22:06.327

再投一票给 Lua。它很小，速度很快，不会消耗太多内存（对于游戏，最好的选择是在初始化时分配大缓冲区并在那里重新定向所有 Lua 内存分配）。我们使用 tolua 生成绑定，但还有其他选项，其中大多数比 boost.python 更小/更易于使用 (IMO)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-20T17:54:31.383

至于调试 Lua（如果你走那条路），我一直在使用 DeCoda，而且还不错。它假装是一个 IDE，但在那方面失败了，但您可以将调试过程附加到 Visual Studio，并在断点处向下调用堆栈。非常方便追踪该错误。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T16:08:43.650

您还可以使用[Ch](http://softintegration.com/)嵌入 C/C++ 脚本。我一直在将它用于我正在从事的游戏项目，并且效果很好。力量和适应性的完美结合。

# drupal - 是什么让 Drupal 更好/不同于 Joomla

> ID：63787
> 
> 赞同：3
> 
> 时间：2008-09-15T15:11:45.563
> 
> 标签：drupal, joomla

我和几个朋友谈过，他们说 Drupal 很棒，而且比 Joomla 好得多。主要区别/优势是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-16T04:29:09.750

普遍的共识是程序员更喜欢 Drupal，而普通人更喜欢 Joomla。Joomla 因其更简单的用户界面而受到称赞。（我个人不同意这一点；我认为 Joomla 的 UI 使用起来非常痛苦。但话又说回来，我是以程序员的眼光看待它。）另一方面，Drupal 因其高水平的可扩展性，以及添加特性（Drupal 术语中的“模块”）的大量高质量（或多或少）插件库，其中许多本身是可扩展的。

从今天开始使用 Joomla，今晚您可能会得到一个不错但并不完美的网站。立即开始使用 Drupal，您将能够准确地构建您想要的网站 - 一旦您投入时间。

如果您考虑有一天将您的技能转化为一份有报酬的工作，那么您绝对应该支持 Drupal。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-17T05:07:38.447

围绕 drupal 的社区 - 有一个模块可以做几乎所有事情。有时，也有不止一种方法可以做某事。

如果你想改变几乎任何东西，从展示（主题）到功能（钩子），这是可能的。然而，它不是 MVC，它确实需要很多时间来适应。

使用 Views + CCK + Panels Module，您很少需要触摸代码来创建各种各样的页面。

最后，Drupal 的用户和角色系统更加灵活。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-15T15:14:02.890

[API](http://api.drupal.org/)。_ 每一种形式和几乎每一个功能都可以通过一个与 API 挂钩的模块进行修改，而无需接触核心代码。这使得升级**更**容易，因为您的自定义不会被覆盖。

它默认输出的代码也更好。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-18T18:03:19.183

在底层，Joomla 主要运行在 OO 架构上，而 Drupal 几乎完全采用 OO 范式进行程序化。Joomla 没有表单构建器（我知道），因此您不得不为表单手动编码整个 html 块，而使用 Drupal，您可以将表单创建为结构化数组。在 Joomla 中，创建管理功能和前端功能需要您将文件放在管理目录和前端目录中，或者创建一个安装文件来为您正确分区。在 Drupal 中，与特定模块有关的所有内容都包含在 1 个目录中，您可以控制访问和 url 结构。

一般来说，Joomla 的管理 GUI 被认为比 Drupal 的更漂亮，更易于使用，但在我看来，Joomla 在编程级别上是一个不太直观的系统，并且使某些任务比必要的更加困难。在我看来，Drupal 真正胜过 Joomla 的 2 个领域是能够动态创建各种内容类型 - 具有各种字段 - 以轻松分割数据，以及创建带有路径的对 seo 友好的 url 的能力，甚至更好的是，路径自动。

底线：从管理的角度来看，Joomla 看起来很漂亮，但 Drupal 的性能往往优于 Joomla，并且是一个更易于定制的系统，可以实现您真正希望从 CMS 中实现的许多功能。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-18T17:40:13.217

从管理和用户的角度来看，Joomla 开始时既有趣又简单，但是一旦需要（自然地）定制网站，就会变得很痛苦。

在我看来，Drupal 正好相反。它有一个陡峭的学习曲线（痛苦的部分），但随着时间的推移变得更容易而不是更难。这来自管理员和用户部分。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-16T20:00:26.360

Drupal 在这两个模块上大放异彩。

*   [CCK](http://drupal.org/project/cck)：向节点添加自定义字段

*   [视图](http://drupal.org/project/views)：控制内容列表的呈现方式；它本质上是一个智能查询生成器

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-04T23:27:17.020

值得一提的是，Joomla**在**1.5 之前的版本非常丑陋，而且 API 包含许多与旧 Mambo 代码相关的非常具体的调用。最新版本和所有未来版本都建立在一个非常强大的 OO 框架之上，所以如果你最近没有看过它，现在就去做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-07T09:07:24.657

我喜欢 Drupal 的地方在于插件模型：您拥有自己的 drupal 核心，并且可以通过创建自己的单独模板目录和模块（插件）来自定义它。

如需完整的技术概览，您还可以在中勾选 Drupal 和 Joomla[http://www.cmsmatrix.org/matrix/cms-matrix](http://www.cmsmatrix.org/matrix/cms-matrix)

# visual-sourcesafe - 从 VSS 打开解决方案时，VS 2003 报告“无法从 Web 服务器获取项目文件”

> ID：63790
> 
> 赞同：0
> 
> 时间：2008-09-15T15:12:16.297
> 
> 标签：visual-sourcesafe, visual-studio-2003

尝试在新格式化的 pc 上从源代码管理打开项目时，从 VSS 获取 sln 文件后，我收到“无法从 Web 服务器获取项目文件”。如果我尝试从资源管理器打开 sln 文件，我也会收到相同的错误。

任何指示或想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T15:56:23.243

这个问题很老，所以您可能已经解决了这个问题，但以防万一：项目文件是否使用 IIS？如果是这样，那么它可能正在尝试从 IIS 读取项目文件，并且新格式化的计算机上不存在虚拟目录。此外，当您打开解决方案时，应在“输出”窗口中提供有关消息的更多详细信息，以帮助您找到原因。使用 VS2003，您还需要将您的用户帐户添加到“调试器用户”和“VS 开发人员”以及可能正在运行 AppPool 的帐户（可能是网络服务器、ASPNET 或 IUSER_xxx）。这也可能取决于您使用的身份验证类型。有时我还必须将这些组权限添加到虚拟目录位置。不过，我已经有一段时间没有将 VS2003 用于 Web 项目了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T15:21:59.097

你的 sln 文件有什么奇怪的地方吗？您是否使用文本编辑器打开它以查看它是否链接到远程资源？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T15:33:41.110

尝试删除 .csproj 文件（不过先备份它们）。

# java - Java 是否对底层操作系统以外的文件名施加任何进一步的限制？

> ID：63800
> 
> 赞同：5
> 
> 时间：2008-09-15T15:12:55.250
> 
> 标签：java, operating-system, filesystems

Java 是否强加了它自己的任何额外限制。Windows（直到 Vista）不允许包含名称

```
\ / < > ? * : 
```

我知道如何验证名称（正则表达式）。

我需要验证用户输入的文件名。

我的应用程序不需要在任何其他平台上运行，当然，我更愿意独立于平台！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T15:18:30.820

不，您可以转义 Java 不允许在字符串文字中使用但文件系统允许的任何字符。

此外，如果尝试将 Windows 应用程序移植到 Mac 或 Unix，最好使用：

```
File.separator 
```

确定要在每个平台上使用的正确文件分隔符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T15:30:38.420

当您创建一个输入的参数时，该类`new File`的特定平台实现将对其进行规范化。`java.io.FileSystem`据我所知，没有特定于 Java 的限制。

是的，总是使用`File.separator`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T15:33:46.697

Java 支持任何`String`可以用 Unicode 表示的东西（受制于一些非常长的最大长度，`Integer.MAX_VALUE`），文件名只是另一种`String`.

当然，这意味着您可以尝试使用底层操作系统不支持的名称来引用文件。`IOException`如果你这样做，当你尝试使用文件参考时，你会得到某种结果......

# unix - 等效于 PowerShell 中的 *Nix 'which' 命令？

> ID：63805
> 
> 赞同：495
> 
> 时间：2008-09-15T15:13:59.460
> 
> 标签：unix, powershell, command

我如何询问 PowerShell 某物在哪里？

例如，“哪个记事本”，它会根据当前路径返回运行 notepad.exe 的目录。

* * *

## 回答 #1

> 赞同：487
> 
> 时间：2008-09-15T17:56:32.890

当我开始在 PowerShell 中自定义我的个人资料时，我创建的第一个别名是“which”。

```
New-Alias which get-command 
```

要将其添加到您的个人资料中，请键入：

```
"`nNew-Alias which get-command" | add-content $profile 
```

最后一行开头的 `n 是为了确保它将作为新行开始。

* * *

## 回答 #2

> 赞同：197
> 
> 时间：2013-06-05T20:22:09.063

这是一个实际的*nix 等价物，即它提供*nix 风格的输出。

```
Get-Command <your command> | Select-Object -ExpandProperty Definition 
```

只需替换您要查找的任何内容即可。

```
PS C:\> Get-Command notepad.exe | Select-Object -ExpandProperty Definition
C:\Windows\system32\notepad.exe 
```

当您将其添加到您的配置文件时，您将希望使用函数而不是别名，因为您不能将别名与管道一起使用：

```
function which($name)
{
    Get-Command $name | Select-Object -ExpandProperty Definition
} 
```

现在，当您重新加载您的个人资料时，您可以这样做：

```
PS C:\> which notepad
C:\Windows\system32\notepad.exe 
```

* * *

## 回答 #3

> 赞同：110
> 
> 时间：2008-09-15T15:22:32.760

我通常只输入：

```
gcm notepad 
```

或者

```
gcm note* 
```

gcm 是 Get-Command 的默认别名。

在我的系统上，gcm note* 输出：

```
[27] » gcm note*

CommandType     Name                                                     Definition
-----------     ----                                                     ----------
Application     notepad.exe                                              C:\WINDOWS\notepad.exe
Application     notepad.exe                                              C:\WINDOWS\system32\notepad.exe
Application     Notepad2.exe                                             C:\Utils\Notepad2.exe
Application     Notepad2.ini                                             C:\Utils\Notepad2.ini 
```

您将获得与您要查找的内容相匹配的目录和命令。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2014-04-01T04:17:28.330

**试试这个例子：**

```
(Get-Command notepad.exe).Path 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-11-17T10:14:58.887

我对Which函数的提议：

```
function which($cmd) { get-command $cmd | % { $_.Path } }

PS C:\> which devcon

C:\local\code\bin\devcon.exe 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2017-04-08T19:06:36.310

与 Unix 的快速匹配`which`是

```
New-Alias which where.exe 
```

但是如果它们存在，它会返回多行，所以它变成

```
function which {where.exe command | select -first 1} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2017-04-11T19:29:22.910

我喜欢`Get-Command | Format-List`，或者更短，为这两者使用别名，并且仅用于`powershell.exe`：

```
gcm powershell | fl 
```

你可以找到这样的别名：

```
alias -definition Format-List 
```

制表符完成适用于`gcm`.

让选项卡一次列出所有选项：

```
set-psreadlineoption -editmode emacs 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-15T15:16:09.563

这似乎可以满足您的要求（我在[http://huddledmasses.org/powershell-find-path/](http://huddledmasses.org/powershell-find-path/)上找到了它）：

```
Function Find-Path($Path, [switch]$All = $false, [Microsoft.PowerShell.Commands.TestPathType]$type = "Any")
## You could comment out the function stuff and use it as a script instead, with this line:
#param($Path, [switch]$All = $false, [Microsoft.PowerShell.Commands.TestPathType]$type = "Any")
   if($(Test-Path $Path -Type $type)) {
      return $path
   } else {
      [string[]]$paths = @($pwd);
      $paths += "$pwd;$env:path".split(";")

      $paths = Join-Path $paths $(Split-Path $Path -leaf) | ? { Test-Path $_ -Type $type }
      if($paths.Length -gt 0) {
         if($All) {
            return $paths;
         } else {
            return $paths[0]
         }
      }
   }
   throw "Couldn't find a matching path of type $type"
}
Set-Alias find Find-Path 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-15T15:16:27.173

检查这个[PowerShell 哪个](http://blog.stangroome.com/2007/09/06/my-manwich-powershell-which).

那里提供的代码表明了这一点：

```
($Env:Path).Split(";") | Get-ChildItem -filter notepad.exe 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-12-13T05:14:57.143

[`where`](http://ss64.com/nt/where.html)在 Windows 2003 或更高版本（或 Windows 2000/XP，如果您已安装资源工具包）上尝试该命令。

顺便说一句，这在其他问题中得到了更多答案：

[Windows上是否有相当于“which”的？](https://stackoverflow.com/questions/304319/is-there-an-equivalent-of-which-on-windows)

[PowerShell 相当于 Unix`which`命令？](https://superuser.com/questions/34492/powershell-equivalent-to-unix-which-command)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-06-01T07:08:46.993

如果您想要一个既可以接受来自管道的输入也可以作为参数的命令，您应该尝试以下操作：

```
function which($name) {
    if ($name) { $input = $name }
    Get-Command $input | Select-Object -ExpandProperty Path
} 
```

将命令复制粘贴到您的个人资料 ( `notepad $profile`)。

例子：

```
❯ echo clang.exe | which
C:\Program Files\LLVM\bin\clang.exe

❯ which clang.exe
C:\Program Files\LLVM\bin\clang.exe 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-12-22T11:06:40.330

采用：

```
function Which([string] $cmd) {
  $path = (($Env:Path).Split(";") | Select -uniq | Where { $_.Length } | Where { Test-Path $_ } | Get-ChildItem -filter $cmd).FullName
  if ($path) { $path.ToString() }
}

# Check if Chocolatey is installed
if (Which('cinst.bat')) {
  Write-Host "yes"
} else {
  Write-Host "no"
} 
```

还是这个版本，调用原来的where命令。

这个版本也更好用，因为它不限于 bat 文件：

```
function which([string] $cmd) {
  $where = iex $(Join-Path $env:SystemRoot "System32\where.exe $cmd 2>&1")
  $first = $($where -split '[\r\n]')
  if ($first.getType().BaseType.Name -eq 'Array') {
    $first = $first[0]
  }
  if (Test-Path $first) {
    $first
  }
}

# Check if Curl is installed
if (which('curl')) {
  echo 'yes'
} else {
  echo 'no'
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-03-05T18:03:51.640

我的 PowerShell 配置文件中有这个`which`高级功能：

```
 function which {
    <#
    .SYNOPSIS
    Identifies the source of a PowerShell command.
    .DESCRIPTION
    Identifies the source of a PowerShell command. External commands (Applications) are identified by the path to the executable
    (which must be in the system PATH); cmdlets and functions are identified as such and the name of the module they are defined in
    provided; aliases are expanded and the source of the alias definition is returned.
    .INPUTS
    No inputs; you cannot pipe data to this function.
    .OUTPUTS
    .PARAMETER Name
    The name of the command to be identified.
    .EXAMPLE
    PS C:\Users\Smith\Documents> which Get-Command

    Get-Command: Cmdlet in module Microsoft.PowerShell.Core

    (Identifies type and source of command)
    .EXAMPLE
    PS C:\Users\Smith\Documents> which notepad

    C:\WINDOWS\SYSTEM32\notepad.exe

    (Indicates the full path of the executable)
    #>
        param(
        [String]$name
        )

        $cmd = Get-Command $name
        $redirect = $null
        switch ($cmd.CommandType) {
            "Alias"          { "{0}: Alias for ({1})" -f $cmd.Name, (. { which $cmd.Definition } ) }
            "Application"    { $cmd.Source }
            "Cmdlet"         { "{0}: {1} {2}" -f $cmd.Name, $cmd.CommandType, (. { if ($cmd.Source.Length) { "in module {0}" -f $cmd.Source} else { "from unspecified source" } } ) }
            "Function"       { "{0}: {1} {2}" -f $cmd.Name, $cmd.CommandType, (. { if ($cmd.Source.Length) { "in module {0}" -f $cmd.Source} else { "from unspecified source" } } ) }
            "Workflow"       { "{0}: {1} {2}" -f $cmd.Name, $cmd.CommandType, (. { if ($cmd.Source.Length) { "in module {0}" -f $cmd.Source} else { "from unspecified source" } } ) }
            "ExternalScript" { $cmd.Source }
            default          { $cmd }
        }
    } 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-07-20T12:50:12.807

[您可以从https://goprogram.co.uk/software/commands](https://goprogram.co.uk/software/commands)安装该`which`命令以及所有其他 UNIX 命令。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-11-06T22:44:50.440

如果你有[独家新闻](https://github.com/ScoopInstaller/Scoop)，你可以安装一个直接克隆：

```
scoop install which
which notepad 
```

# linux - 在 Linux/bash 下拆分文件及其行

> ID：63870
> 
> 赞同：1
> 
> 时间：2008-09-15T15:19:29.617
> 
> 标签：linux, bash, large-files, filesplitting

我有一个相当大的文件（1.5 亿行 10 个字符）。我需要将它拆分为 200 万行的 150 个文件，每个输出行或者是源行的前 5 个字符或最后 5 个字符。我可以在 Perl 中相当快地做到这一点，但我想知道是否有使用 bash 的简单解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T15:28:24.773

在家工作？:-)

我认为带有 sed （将每行分成两行）和 split （将内容分成多个文件）的简单管道就足够了。

man 命令是你的朋友。

* * *

确认不是作业后补充：

怎么样

```
sed 's/\(.....\)\(.....\)/\1\n\2/' input_file | split -l 2000000 - out-prefix- 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T15:31:31.927

我认为这样的事情可以工作：

```
out_file=1
out_pairs=0
cat $in_file | while read line; do
    if [ $out_pairs -gt 1000000 ]; then
        out_file=$(($out_file + 1))
        out_pairs=0
    fi
    echo "${line%?????}" >> out${out_file}
    echo "${line#?????}" >> out${out_file}
    out_pairs=$(($out_pairs + 1))
done 
```

不过，不确定它是否比使用 Perl 更简单或更高效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T15:35:48.080

每行变体的前五个字符，假设大文件名为 x.txt，并假设可以在当前目录中创建名称为 x.txt.* 的文件：

split -l 2000000 x.txt x.txt.out && (用于 x.txt.out* 中的拆分文件；do outfile="${splitfile}.firstfive"; echo "$splitfile -> $outfile"; cut -c 1 -5 "$splitfile" > "$outfile"; 完成)

# asp.net - SQL Server 2005 在连接到同一服务器上运行的网站时出现问题

> ID：63875
> 
> 赞同：1
> 
> 时间：2008-09-15T15:20:29.020
> 
> 标签：asp.net, sql-server-2005, database-connection

*建立与服务器的连接时发生错误。连接到 SQL Server 2005 时，此故障可能是由于在默认设置下 SQL Server 不允许远程连接造成的。（提供者：命名管道提供者，错误：40 - 无法打开与 SQL Server 的连接）*

您好，我是在 SQL Server 2005 上开发的新手。我已经使用 SQL Server 2000 工作了几年，但是在完成连接到服务器的常规操作后，我在 Web 服务器上遇到了这个异常。

谷歌上有几个链接指向我可能的解决方案，但它们都没有解决我的问题。我在“Surface Area 不管...”对话框上进行了更改（这到底是什么？为什么 SQL Server 发生了如此大的变化？？？现在看起来很复杂）。

我已确保正确配置 SQL Server 2005 以允许数据库服务器实例上的传入连接。我还选择了*自动*作为启动类型，以便在每次系统启动时自动启动 SQL Server Browser 服务。不，没有防火墙在运行。

我尝试更改连接字符串以使用端口进行连接、使用 IP 进行连接、使用实例名称进行连接......

似乎没有任何效果，我仍然遇到同样的错误。有什么提示吗？

回答人们提出的问题：是的，我可以使用 Management Studio 从另一台计算机进行连接。是的，我确定它已配置为接受本地和远程 TCP/IP 以及命名管道。是的，我重新启动了服务器。

我正在使用已启用的混合模式安全性。我已经启用了 sa 用户。我能够使用 .udl 文件连接到数据库，并且我检查了我的连接字符串是否正常。我可以使用 DBArtisan 和 SQL Server 客户端工具连接到数据库。我可以在服务器和不同的机器上做到这一点。即使有这一切...

该网站仍然无法连接。

新更新...我整天都在为这个问题苦苦挣扎，但仍然没有找到原因。我发布的错误消息似乎是.net 在无法连接时给出的一般错误。我在连接字符串上放置了垃圾（键入不存在的服务器），但仍然出现相同的错误。

这些是我在服务器上使用的一些连接字符串：

connectionString="集成安全=SSPI；数据源=SERVER；初始目录=db；网络库=DBMSSOCN；"

connectionString="数据源=SERVER；初始目录=db；用户ID=sa；密码=xxxxx；"

connectionString="数据源=SERVER\MSSQLSERVER；初始目录=db；用户ID=sa；密码=xxxxx；"

我尝试使用一些奇怪的命令注册 sql server 实例，我在这里发现：http: [//kb.discountasp.net/article.aspx](http://kb.discountasp.net/article.aspx?id=1041) ?id=1041 为此，我使用了 aspnet_regsql.exe 工具。它仍然无法正常工作...

我也知道服务器上安装了最新版本的 MDAC。我唯一怀疑的是服务器有两个数据库引擎：SERVER 和 server\sqlexpress

这与问题有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T19:56:25.753

> 我唯一怀疑的是服务器有两个数据库引擎：SERVER 和 server\sqlexpress

我认为这是问题的根源。您打算连接到哪一个？您需要指定要连接的“实例”。

假设您打算连接到 SERVER 实例，则连接字符串应如下所示（假设默认实例名称）：

数据源= **YOURSERVER\MSSQLSERVER** ; 初始目录=db；用户 ID=sa；密码=xxxxx；

或者对于 sql express，连接字符串如下所示： Data Source= **YOURSERVER\sqlexpress** ; 初始目录=db；用户 ID=sa; 密码=xxxxx；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T15:22:26.257

您可以通过 Management Studio 从另一台计算机连接到 SQL Server 吗？这可能会帮助您缩小是 SQL Server 配置还是连接字符串配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-15T15:23:00.357

重新检查表面区域配置，并确保允许 TCP/IP 连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T15:23:25.863

这可能是很多事情。我要检查的第一件事是确保您可以使用 SQL Server Management Studio 连接到服务器。其次，检查您的连接字符串以确保它是正确的。表面积配置不应应用于本地连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T15:53:31.220

尝试在服务器上重新安装最新的 MDAC。我曾经有一个类似的问题，这解决了它。

[ [http://www.microsoft.com/downloads/details.aspx?familyid=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en][1]](http://www.microsoft.com/downloads/details.aspx?familyid=6c050fe3-c795-4b7d-b037-185d0506396c&displaylang=en][1])

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T16:02:18.610

基于错误看起来代码正在尝试使用命名管道而不是 TCPIP 进行连接。您实际上可能需要在连接字符串中明确指出 sql 提供程序应使用 tcpip 进行连接，因此您的连接字符串如下所示。

使用集成身份验证（Windows）：

集成安全=SSPI；数据源=*服务器名*；初始目录= *DATABASENAME* ; **网络库=DBMSSOCN** ;

使用 SQL 身份验证：

UID=*用户名*；密码=*密码*；数据源=*服务器名*；初始目录= *DATABASENAME* ; **网络库=DBMSSOCN** ;

我以前见过类似的情况，由于某种原因，默认情况下“命名管道”被用作传输/连接层，特别是因为 Web 应用程序和 sql 服务器都在同一台机器上运行。我通常总是使用 tcpip 作为传输或网络库。

另一种故障排除技术是使用 UDL（或数据链接文件）对连接进行故障排除。这允许您在连接提供程序（ODBC、OLEDB 等）之间切换并设置其他连接选项。

1.  在机器的桌面上右键单击并选择新建 -> 文本文档。
2.  将 *.txt 文件重命名为 TestConnect.udl（名称无关紧要，只需 .udl 扩展名即可）。您应该看到图标从文本文件图标变为在数据网格顶部显示计算机的图标，或类似的东西（换句话说，窗口应该有一个图标。）。
3.  现在双击该文件，您将看到一个“数据链接属性”小程序出现。
4.  单击提供程序选项卡，您将看到不同连接提供程序的列表。我首先选择“Microsoft OLE DB Provider for SQL Server”。我们可以使用它来确认 OLE DB 是否可以连接。
5.  单击下一步，然后输入服务器名称或 IP 地址。选择 Windows NT 集成安全性。（您可以随时返回并将其更改为使用 sql 登录。）此时您可以单击“测试连接”。如果连接成功，则从下拉列表中选择一个数据库名称。
6.  最后，如果连接失败，请选择“全部”选项卡，然后查找“网络库”并编辑其值，将其设置为“DBMSSOCN”。
7.  返回连接选项卡并再次单击“测试连接”。
8.  这次重复步骤 4 和 5 并选择“SQL Native Client”。

希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T16:15:00.217

在提示符下：

osql -E -S

... 给你一个 > 提示？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T19:14:20.863

您是否尝试在连接字符串中指定实例名称？显然 sql server express 对实例名称特别挑剔。

我还开始研究 SQL Server 配置管理器。那么您是否点击了“SQL Server 2005 网络配置”，然后查看了“ *InstanceName*的协议”？并且您启用了 TCP/IP 和命名管道？

您是否还查看了“SQL Native Client Configuration”->“Client Protocols”，并且您看到那里也启用了 TCP/IP 和命名管道？

使用SQL Server 2005的Surface Area Configuration工具，点击“Surface Area Configuration for Services and Connections”，然后在“Database Engine”-->“Remote Connections”下选择什么？由于您似乎正在尝试使用命名管道进行连接，因此您需要确保选择“本地和远程连接”和“同时使用 tcp/ip 和命名管道”。

您可能知道，一旦进行了任何更改，您必须通过 Management Studio 停止并重新启动 sql server 实例（您不需要重新启动整个机器，尽管重新启动整个机器会到达那里）。

还有我的最后一条建议。暂时离开这个，然后让你的思绪离开它几分钟。当您重新潜入时，您可能会发现以前错过或忽略的东西。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-16T18:20:50.577

我解决了连接问题。问题出在我的应用程序上。问题的原因是开发（而不是生产）数据库的连接字符串由生成数据集的对话框之一硬编码。此对话框将连接字符串放置在 web.config 和名为“Settings.settings.cs”的隐藏源代码文件中。通过将连接字符串固定到正确的位置解决了该问题。

该错误消息完全具有误导性，但通过遵循堆栈跟踪中提供的所有方法，我能够发现这一点。

因此，如果您发现此错误消息，则有很多可能的原因。您的第一个赌注是遵循此错误的通常步骤，即检查服务器是否允许远程和本地连接，并重新启动浏览器服务。

If that doesn't work, check the stack trace, look for code that is in your application, put a break point there and explore all the properties on the connection string. At least that's how I solved it.

# menu - DVD 菜单编码

> ID：63876
> 
> 赞同：10
> 
> 时间：2008-09-15T15:20:42.967
> 
> 标签：menu, dvd

作为一名程序员，我不知道如何为 DVD 编程菜单，我听说这是可能的，甚至见过使用 DVD 菜单的基本游戏——尽管它很可能是一个封闭系统。甚至有可能吗？如果可以，为此存在什么语言、编译器等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T15:28:39.393

有几个开源项目可以创建 DVD 和菜单。我最近使用[dvd-slideshow](https://web.archive.org/web/20201109023628/http://dvd-slideshow.sourceforge.net/wiki/Main_Page)制作了带有菜单等的简单 dvd。另一个是[DVD Styler](http://www.dvdstyler.de/)。所有这些程序基本上都是用于编码、菜单创建等的各种命令行工具的前端。由于这些是开源项目，您可以查看源代码并了解它们是如何实现的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T15:45:01.630

DVD-Video 标准中描述了出现在典型*电影DVD 上的 DVD 菜单：*[维基百科](http://en.wikipedia.org/wiki/DVD-Video)。

如果您尝试创建这种类型的菜单，有许多程序可以创建这些菜单。我对[DVD Styler](http://www.dvdstyler.de/)很幸运。

如果您要创建在 DVD 上分发的应用程序，则编程语言的选择取决于您。我想你可以使用某种操作系统自动启动功能来运行一个应用程序，它会为用户显示一个菜单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-07T01:32:49.360

The WIKI States (in 2011) "Programming interface DVD播放器实现的虚拟机运行DVD中包含的'字节码'。这用于控制播放和在菜单上显示特殊效果。指令集称为虚拟机（VM ) DVD 命令集。共有 16 个通用参数寄存器 (GPRM) 用于保存临时值和 24 个系统参数 (SPRM)。由于具有适度灵活的编程接口，DVD 播放器可用于玩游戏，例如 DVD re - 发布 Dragon's Lair，以及更复杂和高级的游戏，例如 Scene It，所有这些都可以在标准 DVD 播放器上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-10T20:34:06.000

看起来[http://dvdauthor.sourceforge.net/](http://dvdauthor.sourceforge.net/)在这里可以提供帮助，因为您可以使用命令行界面并提供 xml 文件。

您可能需要编写一个框架，该框架可以从您的游戏创作工具生成 xml 文件（和其他内容）。

# reporting-services - 将 Reporting Services 报表导出到 Excel 并让表头换行

> ID：63878
> 
> 赞同：3
> 
> 时间：2008-09-15T15:21:20.783
> 
> 标签：reporting-services

我在报告服务中有一个报告，当我预览它时，表格的标题会换行，但是当我将它导出到 Excel 时，不会。他们只是被切断了。当我导出到 Excel 时如何强制它换行有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-15T19:51:19.480

尽管此链接没有直接解决您的问题，但它在 Excel 中报告呈现的设计考虑方面相当全面

链接：[为 Microsoft Excel 输出设计](http://msdn.microsoft.com/en-us/library/ms159836(SQL.90).aspx)(Reporting Services)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T02:00:31.430

如果您要将报告从 SSRS 导入 EXCEL，并且发现某些 TOP 列已连接，那么解决此问题的最佳方法是：

*   返回报表设计器并调整所有文本框。
*   调整到设计器窗口的左侧。当它调整到左侧时，您会看到一条蓝线。
*   顶部的数据集也应该移向设计器窗口的左侧。
*   您可能在左侧有日期时间功能，将其垂直调整到顶部数据集，间隔为 0-1 点。
*   包括您的标题，即您的公司名称，报告名称和下面提到的所有参数应该在下面调整到我之前提到的日期时间功能。

通过调整文本框与报表设计器一起玩，您将看到魔力。

# php - CakePHP：动作运行两次，没有充分的理由

> ID：63881
> 
> 赞同：5
> 
> 时间：2008-09-15T15:21:28.350
> 
> 标签：php, cakephp, action, cakephp-1.2

我的蛋糕有一个奇怪的问题（cake_1.2.0.7296-rc2）。在某些情况下，我的 start()-action 会运行两次，即使只发出了一个请求。

触发器似乎是： - 加载一个对象，如：`$this->Questionnaire->read(null, $questionnaire_id);` - 访问 $this-data

`loadAvertisement()`如果我禁用来自-action的调用`start()`，则不会发生这种情况。如果我禁用里面的两个电话`loadAdvertisement():`

```
$questionnaire = $this->Questionnaire->read(null, $questionnaire_id);
$question = $this->Questionnaire->Question->read(null, $question_id); 
```

......然后它也不会发生。

为什么？

请参阅下面的代码，控制器是“questionnaires_controller”。

```
function checkValidQuestionnaire($id)
{
    $this->layout = 'questionnaire_frontend_layout';

    if (!$id)
    {
        $id = $this->Session->read('Questionnaire.id');        
    }

    if ($id) 
    {
        $this->data = $this->Questionnaire->read(null, $id);

        //echo "from ".$questionnaire['Questionnaire']['validFrom']." ".date("y.m.d");
        //echo " - to ".$questionnaire['Questionnaire']['validTo']." ".date("y.m.d");

        if ($this->data['Questionnaire']['isPublished'] != 1 
            //|| $this->data['Questionnaire']['validTo'] < date("y.m.d")
            //|| $this->data['Questionnaire']['validTo'] < date("y.m.d")
            )
        {
            $id = 0;
            $this->flash(__('Ungültiges Quiz. Weiter zum Archiv...', true), array('action'=>'archive'));
        }
    }
    else
    {
        $this->flash(__('Invalid Questionnaire', true), array('action'=>'intro'));
    }

    return $id;
}

function start($id = null) {
    $this->log("start");

    $id = $this->checkValidQuestionnaire($id);

    //$questionnaire = $this->Questionnaire->read(null, $id);
    $this->set('questionnaire', $this->data);

    // reset flow-controlling session vars
    $this->Session->write('Questionnaire',array('id' => $id));
    $this->Session->write('Questionnaire'.$id.'currQuestion', null);
    $this->Session->write('Questionnaire'.$id.'lastAnsweredQuestion', null);
    $this->Session->write('Questionnaire'.$id.'correctAnswersNum', null);

    $this->loadAdvertisement($id, 0);

    $this->Session->write('Questionnaire'.$id.'previewMode', $this->params['named']['preview_mode']);

    if (!$this->Session->read('Questionnaire'.$id.'previewMode'))
    {
        $questionnaire['Questionnaire']['participiantStartCount']++;
        $this->Questionnaire->save($questionnaire);
    }        

}

function loadAdvertisement($questionnaire_id, $question_id)
{

    //$questionnaire = array();
    $questionnaire = $this->Questionnaire->read(null, $questionnaire_id);

    //$question = array();
    $question = $this->Questionnaire->Question->read(null, $question_id);

    if (isset($question['Question']['advertisement_id']) && $question['Question']['advertisement_id'] > 0)
    {
        $this->set('advertisement', $this->Questionnaire->Question->Advertisement->read(null, $question['Question']['advertisement_id']));
    }
    else if (isset($questionnaire['Questionnaire']['advertisement_id']) && $questionnaire['Questionnaire']['advertisement_id'] > 0)
    {
        $this->set('advertisement', $this->Questionnaire->Question->Advertisement->read(null, $questionnaire['Questionnaire']['advertisement_id']));
    }

} 
```

我真的不明白这个......它不认为它应该是这样的。任何帮助将不胜感激！:)

问候，斯图

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-09T17:01:08.193

Check your layout for non-existent links, for example a misconfigured link to favicon.ico will cause the controller action to be triggered for a second time. Make sure favicon.ico points towards the webroot rather than the local directory, or else requests will be generated for /controller/action/favicon.ico rather than /favicon.ico - and thus trigger your action.

This can also happen with images, stylesheets and javascript includes.

To counter check the $id is an int, then check to ensure $id exists as a primary key in the database before progressing on to any functionality.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-14T06:32:19.343

对我来说，这是一个 JS 问题。

使用 jQuery 处理 wrap 函数，在包装的内容中重新执行 JS！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T15:56:35.673

您可能想尝试使用 debug_print_backtrace() 函数找出它的来源。( [http://nl.php.net/manual/en/function.debug-print-backtrace.php](http://nl.php.net/manual/en/function.debug-print-backtrace.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T07:34:44.377

有同样的问题，某个动作随机运行2-3次。我追踪了两个原因：

*   Firefox 插件 Yslow 设置为从其首选项自动加载，导致使用 F5 时重新加载页面（而不是从浏览器地址栏加载页面并按 Enter 时）。

*   我在 $html->link(); 的选项中有一个错误的 css 样式声明；在某些情况下，它会以 background-image: url(''); 的形式结束，这也会导致重新运行。将链接的样式设置为 background-image: none; 当没有可用的图像时，对我来说固定的东西。

希望这可以帮助。我知道这是一篇相当老的帖子，但是当搜索这个问题时，它在谷歌中的排名很高，我认为它仍然可以通过发布来帮助其他人。

祝你好运

杰伦登韩

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T13:09:09.037

上周我遇到了这样的问题。

两个可能的原因

*   路线错误（请检查您的路线配置）
*   有故障的 AppController。我在 AppController 中添加了很多东西，尤其是在 beforeFilter() 和 beforeRender() 中，所以你可能也想检查一下。

还有一件事，你在哪里设置 Questioneer.id 在你的会话中？也许这就是问题所在？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-28T18:17:38.127

是的，当网页中的链接断开时会发生这种情况。每个浏览器都以不同的方式处理它（Firefox 称之为 2x）。我测试了一下，CakePHP v1.3和v2.2.1没有区别。要找出罪魁祸首，请将此行添加到代码中，然后打开您`www`文件夹中生成的第二个文件：

```
file_put_contents("log-" . date("Hms") . ".txt", $this->params['pass'] ); // CakePHP v1.3 
file_put_contents("log-" . date("Hms") . ".txt", $this->request['pass'] ); //CakePHP v2.2.1 
```

PS：首先我责怪jQuery。但最后它被遗忘了在第 3 部分脚本中加载 AJAX 的图像。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-09T18:02:16.060

我遇到了类似的问题，这个问题似乎与端点上的大小写不敏感有关。

即：
[http://server/Questionnaires/loadAvertisement](http://server/Questionnaires/loadAvertisement) -vs-
[http://server/questionnaires/loadavertisement](http://server/questionnaires/loadavertisement)

当调用适当大小写的端点时，该方法运行一次 - 而小写的​​端点运行两次。问题偶尔发生 - 发生在一个控制器上，但不在另一个控制器上（基本上相同的逻辑，没有额外的组件等）。我无法确认，但相信是浏览器的错——而不是 CakePHP 本身。

我的解决方法是确保每个端点链接都是正确大小写的。为了更进一步，我在 Route 的配置中添加了常见的 case-variants：

app/config/routes.php

```
<?php
// other routes..
$instructions = ['controller'=>'Questionnaires','action'=>'loadAvertisement'];
Router::connect('/questionnaires/loadavertisement', $instructions);
Router::connect('/QUESTIONNARIES/LOADADVERTISEMENT', $instructions);
// ..etc 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-16T11:14:49.250

如果你错过`<something>`了，例如一个 View，Cake 会触发一个丢失的`<something>`错误，它会尝试渲染它的`Error View`. 因此，`AppController`会被调用两次。如果您解决了缺少的问题，`AppController`则调用一次。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-09T08:46:57.197

我在 chrome 中遇到了同样的问题，我禁用了我的“HTML Validator”插件。哪个页面加载了两次

# asp.net - 如何从 DMZ 中的 ReportViewer 控件查看 SQL Server 2005 Reporting Services 报告

> ID：63882
> 
> 赞同：1
> 
> 时间：2008-09-15T15:21:31.360
> 
> 标签：asp.net, reporting-services, reportviewer, reportingservices-2005

我希望能够通过 ReportViewer 控件从 DMZ 中的 ASP.NET 应用程序查看 SQL Server 2005 Reporting Services 报告。SQLand SSRS 服务器位于防火墙后面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-15T15:24:23.973

`所以我不得不改变 ASP.NET 2.0 应用程序从页面调用报告的方式。最初，我使用 JavaScript 打开一个新窗口。

```
ViewCostReport.OnClientClick = "window.open('" + Report.GetProjectCostURL(_PromotionID) + "','ProjectCost','resizable=yes')"; 
```

我遇到的问题是 window.open 调用只能在客户端网络中工作，而不能在位于其 DMZ 中的新 Web 服务器上工作。我必须创建一个嵌入 ReportViewer 控件的新报表 WebForm 来查看报表。

我遇到的另一个问题是必须使用 Windows 身份验证访问报表服务器，因为它正被另一个应用程序用于报表，并且该应用程序使用角色来访问报表。因此，我开始使用 ReportViewer 控件来模拟 Windows 用户。我发现解决方案是这样的：

创建一个新类，该类实现用于访问报表的 Microsoft.Reporting.WebForms.IReportServerCredentials 接口。

```
public class ReportCredentials : Microsoft.Reporting.WebForms.IReportServerCredentials
{
    string _userName, _password, _domain;
    public ReportCredentials(string userName, string password, string domain)
    {
        _userName = userName;
        _password = password;
        _domain = domain;
    }

    public System.Security.Principal.WindowsIdentity ImpersonationUser
    {
        get
        {
            return null;
        }
    }

    public System.Net.ICredentials NetworkCredentials
    {
        get
        {
            return new System.Net.NetworkCredential(_userName, _password, _domain);
        }
    }

    public bool GetFormsCredentials(out System.Net.Cookie authCoki, out string userName, out string password, out string authority)
    {
        userName = _userName;
        password = _password;
        authority = _domain;
        authCoki = new System.Net.Cookie(".ASPXAUTH", ".ASPXAUTH", "/", "Domain");
        return true;
    }
} 
```

然后我为按钮创建了一个事件来调用报告：

```
protected void btnReport_Click(object sender, EventArgs e)
{
    ReportParameter[] parm = new ReportParameter[1];
    parm[0] =new ReportParameter("PromotionID",_PromotionID);
    ReportViewer.ShowCredentialPrompts = false;
    ReportViewer.ServerReport.ReportServerCredentials = new ReportCredentials("Username", "Password", "Domain");
    ReportViewer.ProcessingMode = Microsoft.Reporting.WebForms.ProcessingMode.Remote;
    ReportViewer.ServerReport.ReportServerUrl = new System.Uri("http://ReportServer/ReportServer");
    ReportViewer.ServerReport.ReportPath = "/ReportFolder/ReportName";
    ReportViewer.ServerReport.SetParameters(parm);
    ReportViewer.ServerReport.Refresh();
} 
```

# css - 如何解决 IE 中当鼠标未悬停在图像上时不显示边框的问题

> ID：63885
> 
> 赞同：0
> 
> 时间：2008-09-15T15:22:02.293
> 
> 标签：css, internet-explorer, image

我正在尝试在一组图像上创建一个相当简单的效果。当图像没有鼠标悬停时，我希望它有一个简单的灰色边框。当它上面有图像时，我希望它有一个不同的“选定”边框。

以下 CSS 在 Firefox 中运行良好：

```
.myImage a img
{
    border: 1px solid grey;
    padding: 3px;
}
.myImage a:hover img
{
    border: 3px solid blue;
    padding: 1px;
} 
```

但是，在 IE 中，当鼠标未悬停在图像上时，不会出现边框。我的 Google-fu 告诉我 IE 中存在导致此问题的错误。不幸的是，我似乎找不到修复该错误的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-15T15:37:13.567

尝试使用不同的颜色。我不确定 IE 是否理解“灰色”（而是使用“灰色”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-15T15:50:22.867

以下适用于 IE7、IE6 和 FF3。关键是使用a:link:hover。IE6 将 A 元素变成了块元素，这就是为什么我添加了浮动内容来收缩包装内容。

请注意，它处于标准模式。不知道在怪癖模式下会发生什么。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title></title>
    <style type="text/css">
      a, a:visited, a:link, a *, a:visited *, a:link * { border: 0; }
      .myImage a
      {
          float: left;
          clear: both;
          border: 0;
          margin: 3px;
          padding: 1px;
      }
      .myImage a:link:hover
      {
          float: left;
          clear: both;
          border: 3px solid blue;
          padding: 1px;
          margin: 0;
          display:block;
      }
    </style>
  </head>
  <body>
    <div class="myImage"><a href="#"><img src="http://stackoverflow.com/Content/Img/stackoverflow-logo-250.png"></a></div>
    <div class="myImage"><a href="#"><img src="http://stackoverflow.com/Content/Img/stackoverflow-logo-250.png"></a></div>
  </body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T15:52:50.770

以我的经验，IE 不适用于伪类。我认为最通用的处理方法是使用 Javascript 将 CSS 类应用于元素。

CSS：

```
.standard_border
{
    border: 1px solid grey;
    padding: 3px;
}
.hover_border
{
    border: 3px solid blue;
    padding: 1px;
} 
```

内联 Javascript：

```
<img src="image.jpg" alt="" class="standard_border" onmouseover="this.className='hover_border'" onmouseout="this.className='standard_border'" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T15:45:54.500

IE 在锚元素以外的任何东西上都有 :hover 伪类的问题，因此您需要将悬停影响到锚本身的元素更改。因此，如果您在锚点中添加了一个类似“图像”的类并将您的标记更改为如下所示：

```
<div class="myImage"><a href="..." class="image"><img .../></a></div> 
```

然后，您可以将 CSS 更改为如下所示：

```
.myImage a.image
{
    border: 1px solid grey;
    padding: 3px;
}
.myImage a.image:hover
{
    border: 3px solid blue;
    padding: 1px;
} 
```

这应该通过将边框放在锚点而不是图像上来模拟所需的效果。请注意，您可能需要在 CSS 中使用类似以下内容来消除图像的默认边框：

```
.myImage a img {
    border: none;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T15:52:43.967

尝试使用*背景*而不是*边框*​​。

它不一样，但它可以在 IE 中使用（查看我网站上的菜单：[www.monex-finance.net](http://www.monex-finance.net/ENG/index.php)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T15:56:47.657

```
<!--[if lt IE 7]>
<script src="http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js" type="text/javascript"></script>
<![endif]--> 
```

把它放在你的标题中，应该可以修复一些 ie 错误。

# lucene - Lucene 和 Lucene.Net 中的俄语分析器

> ID：63896
> 
> 赞同：15
> 
> 时间：2008-09-15T15:23:03.947
> 
> 标签：lucene

Lucene 对俄语的支持很差。

RussianAnalyzer（lucene-contrib 的一部分）质量非常低。

Snowball 的RussianStemmer 模块更糟糕。它不能识别 Unicode 字符串中的俄语文本，显然是假设必须使用 Unicode 和 KOI8-R 的一些奇怪组合。

你知道更好的解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-01-19T14:06:15.603

我用[http://code.google.com/p/russianmorphology/](http://code.google.com/p/russianmorphology/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-08-11T14:40:03.953

我的回答可能为时已晚，但据记录，我发现[AOT 项目的分析器](http://code.google.com/p/russianmorphology/)比 Lucene 附带的分析器好得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-20T22:13:25.897

项目[http://code.google.com/p/russianmorphology/](http://code.google.com/p/russianmorphology/)移至[https://github.com/AKuznetsov/russianmorphology](https://github.com/AKuznetsov/russianmorphology)。请考虑该项目的新托管。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T18:46:55.313

如果一切都失败了，请使用[Sphinx](http://www.sphinxsearch.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T10:06:35.347

这就是开源的美妙之处。你有源代码，所以如果当前的实现不适合你，你总是可以创建自己的，甚至更好，扩展现有的。“Lucene in Action”一书将是一个好的开始。

# vb6 - 为什么这个函数生成的哈希码不是唯一的？

> ID：63897
> 
> 赞同：1
> 
> 时间：2008-09-15T15:23:04.523
> 
> 标签：vb6, hash-code-uniqueness, hash-function

我正在测试我从谷歌搜索得到的下面的 VB 函数。我打算用它来生成哈希码以进行快速字符串比较。但是，有时两个不同的字符串具有相同的哈希码。例如，这些字符串

“122Gen 1 堆大小（.NET CLR 内存 w3wp）：mccsmtpteweb025.20833333333333E-02”

“122Gen 2 堆大小（.NET CLR 内存 w3wp）：mccsmtpteweb015.20833333333333E-02”

具有相同的哈希码 237117279。

请告诉我： - 该功能有什么问题？- 我该如何解决？

谢谢

马丁

* * *

```
Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (dest As Any, src As Any, ByVal bytes As Long)

Private Function HashCode(Key As String) As Long
  On Error GoTo ErrorGoTo

  Dim lastEl As Long, i As Long
  ' copy ansi codes into an array of long'
  lastEl = (Len(Key) - 1) \ 4
  ReDim codes(lastEl) As Long
  ' this also converts from Unicode to ANSI'
  CopyMemory codes(0), ByVal Key, Len(Key)
  ' XOR the ANSI codes of all characters'

  For i = 0 To lastEl - 1
    HashCode = HashCode Xor codes(i) 'Xor'
  Next

ErrorGoTo:
  Exit Function
End Function 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-15T15:30:38.560

我敢打赌，当两个字符串使用您的函数生成相同的哈希时，不仅仅是“场合”。事实上，它发生的频率可能比你想象的要多。

需要意识到的几点：

首先，会有哈希冲突。它发生了。即使使用像 MD5（128 位）这样非常非常大的空间，仍然有两个字符串可以生成相同的结果哈希。您必须通过创建存储桶来处理这些冲突。

其次，长整数并不是真正的大哈希空间。与使用更多位相比，您将获得更多的碰撞。

第三，Visual Basic 中有一些可用的库（如 .NET 的`System.Security.Cryptography`命名空间），它们在散列方面比大多数普通人做得更好。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-15T15:27:16.463

这两个字符串具有相同的字符。（注意“2”和“1”被翻转）

这就是哈希值相同的原因。

确保哈希函数考虑了字符的顺序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-15T15:26:35.670

散列函数不保证散列值的唯一性。如果输入值范围（判断您的样本字符串）大于输出值范围（例如 32 位整数），那么唯一性在物理上是不可能的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-15T15:55:34.053

如果最大的问题是它没有考虑字节的位置，你可以像这样修复它：

```
Private Function HashCode(Key As String) As Long
  On Error GoTo ErrorGoTo

  Dim lastEl As Long, i As Long
  ' copy ansi codes into an array of long'
  lastEl = (Len(Key) - 1) \ 4
  ReDim codes(lastEl) As Long
  ' this also converts from Unicode to ANSI'
  CopyMemory codes(0), ByVal Key, Len(Key)
  ' XOR the ANSI codes of all characters'

  For i = 0 To lastEl - 1
    HashCode = HashCode Xor (codes(i) + i) 'Xor'
  Next

ErrorGoTo:
  Exit Function
End Function 
```

唯一的区别是它将字符位置添加到 XOR 之前的字节值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T15:31:14.237

没有哈希函数可以保证唯一性。有大约 40 亿个 32 位整数，因此即使是最好的哈希函数在出现大约 40 亿个和 1 个字符串时也会产生重复（而且很可能很久以前）。

迁移到 64 位散列甚至 128 位散列并不是真正的解决方案，尽管它降低了冲突的可能性。

如果您想要一个更好的哈希函数，您可以查看加密哈希，但最好重新考虑您的算法并决定是否可以通过其他方式处理冲突。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T15:32:49.147

[System.Security.Cryptography](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aspx)命名空间包含多个可以为您进行散列的类（例如[MD5](http://msdn.microsoft.com/en-us/library/system.security.cryptography.md5.aspx)），这可能会比您自己更好地散列它们，并且会花费更少的精力。

您不必总是重新发明轮子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T15:33:43.250

简单的 XOR 是一个糟糕的哈希：你会发现很多字符串发生冲突。一方面，哈希不依赖于字符串中字母的顺序。

尝试使用 FNV 哈希[http://isthe.com/chongo/tech/comp/fnv/](http://isthe.com/chongo/tech/comp/fnv/)

这真的很容易实现。它在每次异或之后移动哈希码，因此不同顺序的相同字母将产生不同的哈希。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T15:36:49.623

我为他修复了语法突出显示。

此外，对于那些不确定环境或建议更安全的哈希的人：它是经典（.Net 之前）VB，因为.Net 需要括号来调用 CopyMemory。

IIRC，Classic VB 没有内置任何安全哈希。网络上的内容也不多，所以这可能是他最好的选择。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T17:03:37.930

哈希函数并不意味着为不同的字符串返回不同的值。然而，一个好的散列函数应该为看起来相似的字符串返回不同的值。哈希函数用于搜索的原因有很多，包括搜索大型集合。如果散列函数是好的并且如果它返回范围 [0,N-1] 的值，那么 M 个对象的大型集合将被划分为 N 个集合，每个集合具有大约 M/N 个元素。这样，您只需在 M/N 元素的数组中进行搜索，而不是在 M 元素的数组中进行搜索。

但是，如果你只有 2 个字符串，计算它们的哈希值并**不会更快！**最好只比较两个字符串**。**

一个 interresing 哈希函数可以是：

```
 unsigned int hash(const char* name) {
      unsigned mul=1;
      unsigned val=0;
      while(name[0]!=0) {
        val+=mul*((unsigned)name[0]);
        mul*=7; //you could use an arbitrary prime number, but test the hash dispersion afterwards
        name++;
      }
      return val;
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-15T15:27:54.870

我不太了解您工作的环境。这是 .Net 代码吗？如果您真的想要好的哈希码，我建议您研究加密哈希（经过验证的算法），而不是尝试编写自己的哈希码。

顺便说一句，您可以编辑您的帖子并将代码粘贴为代码示例（参见工具栏）吗？这将使阅读更容易。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-15T15:29:50.107

“不要那样做。”

编写自己的哈希函数是一个很大的错误，因为您的语言肯定已经实现了 SHA-1，这是一个非常好的哈希函数。如果您只需要 32 位（而不是 SHA-1 提供的 160 位），则只需使用 SHA-1 的最后 32 位。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-15T15:34:46.147

这里有一个 MD5 散列的可视化基本实现

[http://www.bullzip.com/md5/vb/md5-visual-basic.htm](http://www.bullzip.com/md5/vb/md5-visual-basic.htm)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T15:41:27.660

这个特殊的散列函数对字符串中的所有字符进行异或。不幸的是 XOR 是关联的：

```
(a XOR b) XOR c = a XOR (b XOR c) 
```

因此，任何具有相同输入字符的字符串都会产生相同的哈希码。提供的两个字符串是相同的，除了两个字符的位置，因此它们应该具有相同的哈希码。

您可能需要找到更好的算法，MD5 将是一个不错的选择。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-15T15:53:58.443

XOR 操作是可交换的；也就是说，当对字符串中的所有字符进行异或运算时，字符的顺序无关紧要。字符串的所有字谜将产生相同的 XOR 哈希。

在您的示例中，您的第二个字符串可以通过将“...Gen”之后的“1”与后面的第一个“2”交换来从第一个字符串生成。

你的功能没有问题。所有有用的散列函数有时都会产生冲突，你的程序必须准备好解决它们。

当输入散列到已经用较早输入标识的值时，就会发生冲突。如果散列算法不能产生冲突，则散列值需要与输入值一样大。与仅存储输入值相比，这种散列算法的用途有限。

-阿尔。

# apache-flex - 在 Flex 中为 Sprite 设置动画的最佳方法

> ID：63910
> 
> 赞同：2
> 
> 时间：2008-09-15T15:25:01.973
> 
> 标签：apache-flex

使用 Flex 时是否有处理动画的首选方式——例如，如果我想渲染一个球并在屏幕上弹跳它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-16T02:06:43.117

如果您正在构建一个 Flex 应用程序，您应该使用 Flex 的本机效果类。它们可能已经编译到您的应用程序中，因为核心组件使用它们，并且您不会像使用另一个库那样使用重复的功能来增加 SWF 大小。对于简单的动画，mx.effects.AnimateProperty 或 mx.effects.Tween 应该可以正常工作。

如果您正在处理常规的 ActionScript 项目（没有 Flex 框架），那么我同意 Marc Hughes 给出的答案。但是，如果是这种情况，请不要说您正在使用 Flex，因为这意味着您正在使用 Flex 框架，这可能会让人非常困惑。如果您指的是 Flex Builder，请使用全名以避免潜在的误解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-22T15:20:27.940

您不能总是将 Flex 的效果类与普通精灵一起使用。某些效果期望您的目标对象（要补间的对象）实现 IUIComponent 接口，而其他效果则没有。因此，您可以使用 mx.effects.Tween，或者如果您必须使用效果类之一，则需要将您的 sprite 强制转换为 UIComponent。

另一种选择是使用上面建议的 tween 包之一，或者使用 goasap 滚动你自己的包！

[果阿萨普](http://www.goasap.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T16:14:05.273

我更喜欢使用补间库来处理这样的事情。检查这些：

[吐温](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fcode.google.com%2Fp%2Ftweener%2F&ei=X4nOSIPJAaioesqPveAI&usg=AFQjCNH06RZesH0SEvPCYbJ-J0OMFd7GGQ&sig2=Ki_WXXUX1aHzahMMMSctIw)

[TweenLite / TweenMax](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fblog.greensock.com%2Ftweenmaxas3%2F&ei=jInOSK2QC6jeeu3z-eEI&usg=AFQjCNFfJ41rVV8JX7vg8VfC2vRwuwzAkQ&sig2=sCb4Kj8LvIXZj9Wt9iLZ9g)

[KitchenSync](http://code.google.com/p/kitchensynclib/)

实际上使用前两个时我很幸运，并且阅读了关于最后一个的好东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-29T09:36:54.763

即使您的目标不是 UIComponent，您也可以使用 mx.effects.AnimateProperty。

如果您想要实现的补间是一个简单的补间（移动、调整大小、淡入淡出等），这可以节省您编写 mx.effects.Tween 所需的样板代码。

# wordpress - Joomla 博客/Wordpress 集成

> ID：63916
> 
> 赞同：0
> 
> 时间：2008-09-15T15:25:28.137
> 
> 标签：wordpress, joomla

我正在寻找一个类似于 wordpress 的博客界面来放置在 Joomla 托管网站中。Joomla 的管理界面够奇特，也够难使用，以至于每日更新是不可行的。

我正在寻找的是一个易于使用的发布界面，它支持具有不同帐户/名称的多个用户、标记方案以及按日期/用户/标记功能轻松查找。

特别是，我正在寻找一个相对易于部署、开箱即用的解决方案，并且不希望将 rss 提要一起破解或编写太多自定义代码。我知道那里有[几个扩展](http://extensions.joomla.org/component/option,com_mtree/task,listcats/cat_id,1759/Itemid,35/)，但它们都收到了褒贬不一的评论……有人用过这些吗？或者有没有人有将这样的东西放在一起的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T15:29:11.450

那么你可以做到这一点 - 有一个 wordpress 安装。让用户在那里发帖，然后使用其中的 RSS 提要（或 XML RPC Blogging API）来更新 Joomla 安装。您将不得不编写一次更新片段，但是所有的头痛都消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-16T18:35:03.367

我并不是想在这里变得聪明，但是如果 Joomla 的管理界面不适合您，那么您不是通过尝试修补他们的 UI 而不是花时间寻找更容易的 CMS 来伤害自己吗管理/更适合您的用户群？

**编辑：**我在 ASP.NET 中处理过的所有 CMS 都是国产的。但是，我正在考虑根据两个受人尊敬的朋友的建议来检查[Umbraco 。](http://www.umbraco.org/)如果您在 Joomla 中已经有内容并且迁移到另一个 CMS 将是矫枉过正，我认为 vaibhav 做得对。您应该考虑设置 Wordpress 或其他一些博客引擎，然后让 Joomla 使用内容并将其显示在 Joomla 站点中。我还没有做过，但是从我看到 Joomla 时的记忆来看，我相信它会支持这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T19:03:45.303

在做了更多研究后，我决定使用开源[MojoBlog](http://www.joomlify.com/)。它的安装和配置非常容易，在通过阅读他们的论坛解决了几次停顿和挂断之后，我启动并运行了。编辑界面并不理想，但比 Joomla admin 好得多，并且它具有多用户支持、标签分类、按标签、日期等查看的模块。我认为它在短期内足以满足我的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-25T19:05:51.187

我们“corePHP”已成功将 WordPress 和 WordPress 多用户博客平台集成到 Joomla! 中。请访问我们以了解这些功能丰富的组件必须为您提供什么。[https://www.corephp.com/wordpress/wordpress-integration-for-joomla-1.5.html](https://www.corephp.com/wordpress/wordpress-integration-for-joomla-1.5.html)

快乐的博客，

Michael Pignataro 运营副总裁 www.corephp.com

# javascript - 什么是最好的在线 javascript/css/html/xhtml/dom 参考？

> ID：63918
> 
> 赞同：15
> 
> 时间：2008-09-15T15:25:30.320
> 
> 标签：javascript, html, css, ajax, xhtml

我是一名前端开发人员，我正在寻找有关 javascript/css/html/xhtml/dom/browser 怪癖和支持的最佳全方位在线文档的意见。我尝试过 Sitepoint、Quirksmode、W3Schools，但所有这些似乎都缺乏某些方面，并且一直在组合使用它们。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-15T15:30:21.480

我喜欢 Mozilla 的参考资料：

[http://developer.mozilla.org/en/JavaScript](http://developer.mozilla.org/en/JavaScript)

[http://developer.mozilla.org/en/DOM](http://developer.mozilla.org/en/DOM)

这些根本不是您想要的一站式站点，但它们对我有帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-15T15:26:26.183

我喜欢~~gotapi.com~~（更新 2：站点显然处于脱机状态——使用其他资源，例如[MDN](https://developer.mozilla.org/en-US/)）

**更新：**最初的答案是从 2008 年开始的——今天我想说去看看[Mozilla 开发者网络](https://developer.mozilla.org/en-US/)（正如许多其他人所说的那样）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-15T19:26:19.757

您的描述中实际上是一针见血。没有一个网站可以为您提供您在这些方面的每一个方面所寻求的详细信息。

我发现这三个在从空白页面开始时非常有用：[Mozilla DOM 参考](http://developer.mozilla.org/en/Gecko_DOM_Reference)（用于一般 js 语法等）、[w3schools x/html 参考](http://www.w3schools.com/tags/default.asp)（查找不常见的属性！）和[quirksmode](http://www.quirksmode.org/)（跨浏览器 js/样式详细信息）。这些排名很高，因此如果您要搜索特定内容，请查找它们的网址。

至于特定的浏览器怪癖，最好的办法是在它们出现时处理它们，并培养有效地在谷歌上搜索答案的技能。许多浏览器怪癖有许多变量，这些变量会影响您最终看到的内容，以及针对特定怪癖的“解决方案”如何开发取决于某人花了多少时间研究它。阅读一堆搜索结果，看看问题是否都相似或完全不同。然后，优化您的搜索！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-15T16:01:07.613

直接转到 W3C 文档。它们有时有点神秘，但它们是可靠的文档。

对于怪癖，显然像 Quirksmode 这样的网站很好。但只有在您阅读了实际的 W3C 文档之后。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-15T17:30:43.810

Sitepoint 有一个非常[全面的 CSS 指南](http://reference.sitepoint.com/css)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-16T13:57:02.333

包含在 Aptana IDE 中的相同参考是在线的……刚刚发现这个……真的很好：

CSS [http://www.aptana.com/reference/html/api/CSS.index.html](http://www.aptana.com/reference/html/api/CSS.index.html)

HTML [http://www.aptana.com/reference/html/api/HTML.index.html](http://www.aptana.com/reference/html/api/HTML.index.html)

HTML DOM O [http://www.aptana.com/reference/html/api/HTMLDOM0.index-frame.html](http://www.aptana.com/reference/html/api/HTMLDOM0.index-frame.html)

HTML DOM 1 & 2 [http://www.aptana.com/reference/html/api/HTMLDOM2.index-frame.html](http://www.aptana.com/reference/html/api/HTMLDOM2.index-frame.html)

JavaScript 关键字 [http://www.aptana.com/reference/html/api/JSKeywords.index.html](http://www.aptana.com/reference/html/api/JSKeywords.index.html)

JavaScript 核心 [http://www.aptana.com/reference/html/api/JSCore.index-frame.html](http://www.aptana.com/reference/html/api/JSCore.index-frame.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-15T15:31:44.080

我喜欢 w3schools 的 html 或简单问题。

对于 Javascript，我发现[Mozilla 开发者中心](http://developer.mozilla.org/En)非常有用：[Core Javascript 1.5 Reference](http://developer.mozilla.org/en/Core_JavaScript_1.5_Reference)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-15T15:33:57.227

zvon.org

[http://reference.sitepoint.com/](http://reference.sitepoint.com/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-15T15:56:50.697

[blooberry.com](http://blooberry.com)是一个很棒的 HTML/CSS 参考网站。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-15T17:32:42.463

[devguru.com](http://devguru.com)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-15T17:56:56.883

我依靠[http://quirksmode.org/resources.html](http://quirksmode.org/resources.html)获取有关 HTML/CSS/JavaScript 的信息。该资源以有用的表格格式很好地解决了跨浏览器兼容性问题。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-03-12T13:17:17.243

这可能对某些 javascript 函数有用[http://kangax.github.com/es5-compat-table/](http://kangax.github.com/es5-compat-table/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-15T15:31:14.300

[selfhtml.org](http://selfhtml.org/ "自我HTML")上有一个很好的德语参考资料（我认为是法语）。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-15T17:33:11.167

我建议阅读这些[JavaScript 视频讲座](http://www.catonmat.net/blog/learning-javascript-programming-language-through-video-lectures/)（其中 15 个）。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-15T17:49:53.267

GotAPI 是一个很棒的资源[http://www.gotapi.com](http://www.gotapi.com)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-15T18:54:10.710

[http://www.selfhtml.org/](http://www.selfhtml.org/)是德文（原文）和法文（翻译）。不幸的是，英文翻译已暂停：[http ://en.selfhtml.org/](http://en.selfhtml.org/)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-05-05T07:24:43.800

我总是从[www.zvon.org](http://www.zvon.org)开始，尤其是[参考](http://www.zvon.org/index.php?nav_id=references&mime=html)部分。提供良好的概述并直接链接到相应的标准。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-08-18T07:25:36.803

*   [javascriptkit.com/jsref/](http://www.javascriptkit.com/jsref/)（方便的**JavaScript**参考与示例）
*   javascriptkit.com/domref/（带有示例的**DOM参考）**

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2008-09-15T15:28:07.240

我倾向于先访问[http://msdn.microsoft.com/](http://msdn.microsoft.com/)。

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-09-15T19:28:43.527

我推荐 w3schools.com。我发现这是一个非常好的和全面的库。

# java - Struts 1.3：在应用程序上下文之外转发？

> ID：63930
> 
> 赞同：3
> 
> 时间：2008-09-15T15:27:09.677
> 
> 标签：java, struts

Struts 1.3 应用程序。struts/Java 不提供主网站。我需要将 struts 操作的结果转发到网站中的页面，该页面不在 struts 上下文中。目前，我在上下文中转发到 JSP 并使用元刷新转发到实际位置。这似乎有点糟糕。有没有更好的办法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T15:40:55.947

严格意义上，你不能“前进”。只需调用类方法中`sendRedirect()`的`HttpServletResponse`对象，然后.`Action``execute()``return null`

或者，调用对象（您将要返回`setModule()`的`ActionForward`对象）或将路径设置为绝对 URI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-15T19:56:45.067

我最终做了 response.sendRedirect()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T12:29:56.597

如果这仍然在 Web 应用程序中，您可以使用[ServletContext.RequestDispatcher](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/RequestDispatcher.html)吗？这就是 Struts doForward() 方法的工作原理。但是，要离开 Struts/Java，您需要 sendRedirect()。

```
RequestDispatcher rd = getServletContext().getRequestDispatcher(uri);
rd.forward(request, response); 
```

# java - 我可以提交一个引用 POJO（即不仅仅是字符串或布尔值）字段的 Struts 表单吗？

> ID：63935
> 
> 赞同：1
> 
> 时间：2008-09-15T15:27:51.140
> 
> 标签：java, jsp, struts

我有一个 Struts (1.3x) ActionForm，它有几个字符串和布尔属性/字段，但也有一些 POJO 字段。

所以我的表格看起来像：

```
MyForm extends ActionForm {
    private String name;
    private int id;
    private Thing thing;

    ...getters/setters...
} 
```

在 JSP 中，我可以引用 POJO 的字段：

```
<html:text property="thing.thingName" /> 
```

...并且值显示正确，但是如果我尝试**提交**表单，则会收到 ServletException: BeanUtils.populate 错误。

网上似乎有很多关于这个一般主题的信息，但没有一个真正解决我的具体问题，即：我不应该能够在 Struts 中提交包含 POJO 字段的表单吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-15T15:33:03.860

您可以，只要字段遵循 JavaBean 约定并且 setter 采用 Struts 可以理解的内容。

所以`Thing`需要`getThingName()`和`setThingName(String)`。

# sql - 如何在 SQL 2005 Reporting Services 报表的标题中显示数据？

> ID：63938
> 
> 赞同：8
> 
> 时间：2008-09-15T15:28:07.333
> 
> 标签：sql, reporting-services, header, report

开箱即用的 SSRS 报告不能在页眉中公开数据。有没有办法让这些数据显示出来？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-15T15:58:42.860

我想要在我的报告中做的一件事是为我的报告提供漂亮的标题。我喜欢有一个徽标和用户的报告参数以及其他数据来显示，以便为报告需要澄清的业务需求提供更多信息。Microsoft SQL Server 2005 Reporting Services 本身不能做的一件事是在标题中显示来自数据集的数据。这篇文章将解释如何解决这个问题以及它是多么容易。

在商业智能项目部分创建报表服务器项目并将其命名为 AdventureWorksLTReports。我使用 CodePlex 的 AdventureWorksLT 示例数据库。

[替代文字 http://www.cloudsocket.com/images/image-thumb.png](http://www.cloudsocket.com/images/image-thumb.png)

接下来，通过在设计器的报告区域中单击鼠标右键来显示页眉。

[替代文字 http://www.cloudsocket.com/images/image-thumb1.png](http://www.cloudsocket.com/images/image-thumb1.png)

将出现页眉。如果要显示页脚，可以从与页眉相同的菜单访问。

[替代文字 http://www.cloudsocket.com/images/image-thumb2.png](http://www.cloudsocket.com/images/image-thumb2.png)

我创建了一个存储过程，该过程返回要在页眉中显示的销售订单的数据。我将在页眉中显示有关销售订单的以下信息：

*   订购日期
*   销售订单号
*   公司
*   销售人员
*   到期总额

我为页眉中的每个数据字段创建了一个文本框，并为相应的标签创建了一个文本框。不要更改您希望销售订单数据包含在其中的文本框中的表达式。

[替代文字 http://www.cloudsocket.com/images/image-thumb3.png](http://www.cloudsocket.com/images/image-thumb3.png)

在报表正文中，为页眉中所需的每个数据字段放置一个文本框。在每个文本框的可见性中，为隐藏选择 True。这将是页眉中所需数据的占位符。

[替代文字 http://www.cloudsocket.com/images/image-thumb4.png](http://www.cloudsocket.com/images/image-thumb4.png)

您的报告应该类似于下面显示的屏幕截图。

[替代文字 http://www.cloudsocket.com/images/image-thumb5.png](http://www.cloudsocket.com/images/image-thumb5.png)

最后一步也是最重要的一步是在位于页眉的文本框中引用隐藏文本框。我们使用以下表达式来引用所需的文本框：

=ReportItems!.Value

您的报告现在应该类似于以下内容：

[替代文字 http://www.cloudsocket.com/images/image-thumb6.png](http://www.cloudsocket.com/images/image-thumb6.png)

您的报告预览现在应该在报告标题中包含销售订单标题数据。

[替代文字 http://www.cloudsocket.com/images/image-thumb7.png](http://www.cloudsocket.com/images/image-thumb7.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T15:39:53.560

你必须通过参数来做到这一点。为要显示的每条数据添加一个参数，然后将参数设置为隐藏。然后将默认值设置为“来自查询”并将数据集和值字段设置为适当的值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-31T15:05:26.113

我认为最好的选择是创建一个内部参数，默认值是您要显示的数据集的字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-15T15:44:46.717

以下是两种可能的**解决方法**：

1.  您可以将数据绑定字段作为隐藏文本框放置在报表正文中，然后在标题中放置另一个文本框，其值指向隐藏在正文中的那个。

2.  尝试使用报表参数来存储数据，并使用这些参数来访问标题中的数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T06:05:37.600

如果您的报告跨越多个页面，则此技术将不起作用，而是使用查询参数，并将文本框值设置为 =Parameters!Name.Value 根据[本文](http://www.experts-exchange.com/Database/Reporting_/Q_21954812.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-02T05:03:27.960

我和猎户座阿德里安在这里。报告参数是要走的路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-01T10:33:29.497

我想在标题中显示一个所有返回行共有的字段，对于这种情况，我选择了链接表解决方案（在正文中放置一个包含该字段的表，并将标题中的文本框链接到该表）。

我这样做是因为如果您使用参数解决方案并且没有数据返回到相关字段，则会显示文本“参数缺少值”，而不仅仅是一个空白表。我认为此文本会使用户感到困惑（因为该参数甚至不可见）。

# vbscript - 非管理员时 WMI 中缺少课程

> ID：63940
> 
> 赞同：3
> 
> 时间：2008-09-15T15:28:20.907
> 
> 标签：vbscript, wmi

我希望在 Windows XP中以*受限用户*身份登录时能够查看`Win32_PhysicalMedia`信息（无管理员权限）。*以Admin*身份登录时它工作正常， 刚刚给出了一份干净的健康单，并且类正确生成了信息，但此代码的计数为 0**`WMIDiag``Win32_DiskDrive``Win32_PhysicalMedia`**

 **```
set WMI = GetObject("WinMgtmts:/root/cimv2")
set objs = WMI.InstancesOf("Win32_PhysicalMedia")
wscript.echo objs.count 
```

或者，如果在物理驱动器属性上找到的硬盘序列号在`SerialNumber` 我可以作为受限用户阅读的另一类中可用，请告诉我。我没有尝试使用 WMI 写入任何属性，但在以*Limited User*身份运行时我无法读取此内容。有趣的是，`DiskDrive`错过了该属性，它在以*受限用户*`Signature`身份运行时对我的应用程序有用，但在从 *管理员*帐户运行时存在。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-16T12:39:31.583

WMI 不会向受限用户提供此信息。

如果您可以使用您的语言访问 Win32 函数，则可以调用[GetVolumeInformation](http://msdn.microsoft.com/en-us/library/aa364993(VS.85).aspx)。

# emacs - 如何使 Emacs 终端颜色与 Emacs GUI 颜色相同？

> ID：63950
> 
> 赞同：69
> 
> 时间：2008-09-15T15:29:01.637
> 
> 标签：emacs, ubuntu, colors

我在 Ubuntu（目前是 Hardy Heron）上使用 Emacs 进行编程，我喜欢 Emacs GUI 中的默认文本颜色。但是，在终端中运行 Emacs 时，默认的文本颜色是不同的且花哨的。

如何使终端中的颜色与 GUI 中的颜色相匹配？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2008-09-15T16:46:13.777

您不必拘泥于终端默认的 16 种（或更少）颜色。现代终端将支持 256 种颜色（这将使您非常接近您的 GUI 外观）。

不幸的是，让您的终端支持 256 色是一个棘手的部分，并且因术语而异。[这个页面](http://www.xvx.ca/~awg/emacs-colors-howto.txt)帮了我很多（但它*已经*过时了；我肯定已经在 gnome-terminal 和 xfce4-terminal 中获得了 256 种颜色；但您可能必须从源代码构建它们。）

一旦您的终端愉快地使用 256 种颜色，神奇的调用就是在您调用 emacs 之前将您的终端类型设置为“xterm-256color”，例如：

```
env TERM=xterm-256color emacs -nw 
```

或者，您可以在`.bashrc`文件中设置 TERM：

```
export TERM=xterm-256color 
```

你可以通过做来检查它是否在 emacs 中工作`M-x list-colors-display`，它将显示 16 种或全部 256 种绚丽的颜色。

如果可行，请按照`color-theme`其他人的建议进行查看。

（你可能会在某个时候感到沮丧；上帝知道我每次尝试做类似的事情时都会这样做。但坚持下去；这是值得的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T15:33:35.417

我不确定这是否可能，因为 GUI 可能比终端具有更多功能（是的，我最近看到的 GUI 终端只有 16 种颜色）。这可能取决于终端的设置方式。无论如何，我会玩[Color Theme](http://www.emacswiki.org/cgi-bin/wiki?ColorTheme)。

无论如何，你为什么在终端和 GUI 中都使用 Emacs？一般来说，人们会发现其中一种很有吸引力，并且只使用那个。如果您正在远程使用 Emacs，也许您想在本地运行它并使用[Tramp](http://www.gnu.org/software/tramp/)远程打开文件，或者以 root 身份。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-10T15:01:28.043

我能够与 emacs 26 非常接近。

我按照 Emacs 常见问题解答让 24 位颜色工作： [https ://www.gnu.org/software/emacs/manual/html_mono/efaq.html#Colors-on-a-TTY](https://www.gnu.org/software/emacs/manual/html_mono/efaq.html#Colors-on-a-TTY)

然后我更改了 xterm-standard-colors 变量：

```
(set 'xterm-standard-colors
  '(("black"          0 (  0   0   0))
    ("red"            1 (255   0   0))
    ("green"          2 (  0 255   0))
    ("yellow"         3 (255 255   0))
    ("blue"           4 (  0   0 255))
    ("magenta"        5 (255   0 255))
    ("cyan"           6 (  0 255 255))
    ("white"          7 (255 255 255))
    ("brightblack"    8 (127 127 127))
    ("brightred"      9 (255   0   0))
    ("brightgreen"   10 (  0 255   0))
    ("brightyellow"  11 (255 255   0))
    ("brightblue"    12 (92   92 255))
    ("brightmagenta" 13 (255   0 255))
    ("brightcyan"    14 (  0 255 255))
    ("brightwhite"   15 (255 255 255)))
  ) 
```

（我没有更改“明亮*”颜色，因为我不使用它们，而且它们似乎`list-colors-display`在 X11 emacs 中不可用，无论如何）

通过这两个更改，X11 和终端之间的颜色对我来说看起来几乎相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-04T23:30:41.180

响应有点晚，但我遇到了黑色背景显示为灰色的问题。我通过玩调色板来修复它。

编辑 > 配置文件首选项 > 颜色 > 调色板

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-15T15:30:55.657

我认为这是不可能的。使用终端，您通常会绑定到一些预定义的颜色（使用诸如 gnome-terminal 之类的东西，您可以调整这些颜色——但您仍然受限于预定义的、有限数量的颜色）。

# delphi - 开发 Win32 Delphi 应用程序的最佳工具集是什么？

> ID：63957
> 
> 赞同：24
> 
> 时间：2008-09-15T15:29:32.620
> 
> 标签：delphi

开发 Win32 Delphi 应用程序的最佳开发工具集是什么？包括支持工具，例如自动构建服务器和建模软件。获得 Delphi 开发的最佳工具列表会很有趣，因此请提供该工具的简要描述，说明您使用它的原因，为什么选择它而不是替代品以及它对您的开发过程产生的影响。请每个帖子一个工具，以便更受欢迎，希望更有用的工具过滤到顶部。当我有时间时，我将根据我对我们在这里使用的工具的看法更新我的答案。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-15T15:37:08.450

**IDE** Delphi 2007 Professional（即将成为 Delphi 2009）

**自动构建服务器** [FinalBuilder 6](http://www.finalbuilder.com/)

**单元测试** [DUnit](http://dunit.sourceforge.net/)

**代码分析** [AQTime](http://www.automatedqa.com/products/aqtime/index.asp)

**安装程序创建** [InnoSetup](http://www.innosetup.com/isinfo.php)

**帮助文件管理** [帮助和手册](http://www.ec-software.com/products_hm_overview.html)

**代码建模与设计** [ModelMaker 9](http://www.modelmakertools.com/)

**代码格式化** [Jedi Code Formatter](http://jedicodeformat.sourceforge.net/)

**源代码管理** [Subversion](http://subversion.tigris.org/)和[TortoiseSVN](http://tortoisesvn.tigris.org/)

**问题跟踪** [Jira](http://www.atlassian.com/software/jira/)

**错误报告和记录** [MadExcept](http://www.madshi.net/madExceptDescription.htm)

**文件比较和合并** [Beyond Compare](http://www.scootersoftware.com/moreinfo.php)

**对象持久化框架** [tiOPF](http://tiopf.sourceforge.net/)

**界面测试**？？？

**代码文档**？？？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-16T14:06:44.963

[GExperts](http://www.gexperts.org/) - (FOSS) 集成 IDE 工具（已经提到，但值得进一步解释）。我最常用的功能包括集成的 grep 搜索（可以包括使用正则表达式）和漂亮的 UI、代码导航（ctrl-g 用于快速搜索和跳转到单元中的任何方法）、自定义组合键（例如，您可以设置 ctrl -shift-B 到 Build-All)，任何已安装系统字体的 ascii 图表，

注意：FOSS - 免费开源软件

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-15T16:07:25.697

**GExpert**为 IDE 添加了几个新功能：[http ://www.gexperts.org/](http://www.gexperts.org/)

Delphi IDE**键盘快捷键**： http: [//delphi.about.com/od/adptips2005/qt/editorshortcuts.htm](http://delphi.about.com/od/adptips2005/qt/editorshortcuts.htm)

Delphi**在线文档**：[http ://docs.codegear.com/](http://docs.codegear.com/)

Delphi IDE / Tortoise **SVN**集成[http://delphiaddinfortortoisesvn.tigris.org/](http://delphiaddinfortortoisesvn.tigris.org/)

**JEDI VCS**：面向Delphi的开源VCS系统：http: [//jedivcs.sourceforge.net/](http://jedivcs.sourceforge.net/)

**代码文档**：Doxygen ( [http://www.doxygen.nl/](http://www.doxygen.nl/) ) + Pas2Dox 过滤器( [http://sourceforge.net/projects/pas2dox/](http://sourceforge.net/projects/pas2dox/) )

**Trac**，项目管理，问题跟踪，Wiki，Subversion web UI：[http ://trac.edgewall.org/](http://trac.edgewall.org/)

**咬住**，持续集成：[http ://bitten.edgewall.org/](http://bitten.edgewall.org/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-16T14:11:14.313

[WinMerge](http://winmerge.org) - (FOSS) 具有合并功能的 Diff 工具

注意：FOSS - 免费开源软件

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-30T04:12:36.927

IDE 增强[Model Maker 代码浏览器](http://www.modelmakertools.com)

我知道这是重复，但它需要单独作为答案。这是我的第一，离不开，荒岛工具。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-16T14:00:12.670

[用于代码分析和改进的Pascal Analyzer](http://www.peganza.com/)（专有）工具，包括警告（例如不明确的引用）、可能的优化、*潜在*内存泄漏的识别（很有用，因为大多数内存报告仅显示测试期间实际采用的路径）、重复的字符串文字（即可能最好作为 consts）、uses 子句中未使用的单位、遵守约定，等等。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-18T10:09:12.100

**组件集（专有）**：DevExpress QuantumGrid Suite
**组件集（免费）**：JEDI 和 JCS
**IDE 专家**：GExperts
**版本控制系统**：JVCS/Free VCS
**异常捕获器/日志**：EurekaLog
**本地化套件**：siComponents of TsiLang

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-16T09:28:41.153

如果您还没有使用 D2009，请使用[Delphi Speedup](http://andy.jgknet.de/dspeedup/)

[DDevExtensions](http://andy.jgknet.de/dspeedup/index.php?page=DDevExtensions)在 IDE 中为您提供了一些额外的调整

[FastMM](http://sourceforge.net/projects/fastmm/)包含在 D2006 及更高版本的 IDE 中，但如果您自己运行它，您有更多选择

[FastCode](http://fastcode.sourceforge.net/)一些 RTL 和 VCL 函数的高度优化版本

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-30T04:07:27.703

代码格式：[DelForExp](http://www.dow.wau.nl/aew/delforexp.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-16T03:54:00.333

**IDE：**德尔福 2009

**自动构建：** FinalBuilder 6，如果您没有预算，请使用 WANT 工具。

**单元测试：** DUnit

**代码分析：** AQTime

**安装程序创建：** InnoSetup

**代码建模和设计：** ModelMaker 9

**源代码版本控制：** Subversion

**UI 测试：** TestComplete

**代码文档：** Doc-O-Matic

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-15T18:57:04.057

JEDI JVCL 来自 Sourceforge.net 的 JCL

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-19T03:06:28.923

[CodeSite](http://www.raize.com) - 出色的调试工具，高度可配置

[是的，我在重复一些，但我认为我们的想法是在每个帖子中放一个，让好的帖子浮起来]

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-07-22T11:50:16.347

[DevExpress](http://devexpress.com/) VCL 组件。使用起来非常简单，外观漂亮——美学本身就是一个特点。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-16T22:06:18.913

AQTime 也是一个很好的代码分析器。提供功能和线路使用指标，为开发人员提供所有处理时间都花在哪里的线索。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-30T04:08:35.173

分析：[Prodelphi](http://www.prodelphi.de/)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-15T17:51:09.580

我使用的是：

[压缩包](http://www.cnpack.org/index.php?lang=en)。Ide 增强
FinalBuilder。自动构建工具

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-16T12:09:48.580

我还没有添加“评论”的能力，所以我将其添加为答案：[Joel Spolsky](http://www.joelonsoftware.com/items/2008/09/15.html "乔尔软件")建议最好将此类问题表述为“每个答案一个工具” - 这将允许投票关于个人开发工具，因此更有可能按照受欢迎程度为您提供最佳工具列表。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-30T04:10:28.897

源文件比较：[ModelMaker Structured Difference Viewer](http://www.modelmakertools.com)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-16T09:17:58.883

到目前为止有很多好的建议。

我会添加以下内容

GExperts - IDE 集成工具 www.gexperts.org

ModelMaker Code Explorer - 非常适合在许多其他事情中进行额外的重构 http://www.modelmakertools.com/

CodeSite - 很棒的调试工具 http://www.raize.com/DevTools/CodeSite/Default.asp

VirtualTreeview - 很好的免费树组件，一旦你了解它是如何工作的 http://www.delphi-gems.com/index.php?option=com_content&task=view&id=12&Itemid=38

我不得不同意，就我而言，FinalBuilder 和 MadExcept 都是必不可少的。

周围还有很多很棒的组件套件，TMS、DevExpress 等。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-07-22T11:43:30.963

关于单元测试，现在有一个[DUnit2 项目](http://members.optusnet.com.au/~mcnabp/)。

它支持 Delphi 2009 并带来了[对 DUnit 的一些改进](http://members.optusnet.com.au/~mcnabp/Projects/DUnit2/DUnit2Description.html)。

**编辑**

刚刚找到了另一个项目，[DUnitLite](http://code.google.com/p/dunitlite/)，它在 DUnit 上具有扩展语法。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-19T03:04:49.507

[TeeChart Pro](http://www.steema.com) - 没有它我会迷失图表/图形数据

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-14T16:04:33.590

静态代码分析很重要。特别是如果您使用其他人的代码。

我喜欢 CodeHealer，它非常适合标记关键且难以定位的问题。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2010-10-20T12:38:49.250

[虚拟树视图](http://www.delphi-gems.com/index.php?option=com_content&task=view&id=12&Itemid=38)。

TntWare Unicode 控件。

# c# - 游戏编程和事件处理程序

> ID：63960
> 
> 赞同：12
> 
> 时间：2008-09-15T15:30:25.427
> 
> 标签：c#, xna, camera

我已经有 10 年没有编程游戏了（我的最后一次经历是 DJGPP + Allegro），但我想我会在周末去看看 XNA 看看它是如何形成的。

我印象深刻，但是当我继续拼凑游戏引擎时，我有一个（可能）基本问题。

您应该在多大程度上依赖 C# 的委托和事件来推动游戏？作为一名应用程序程序员，我大量使用委托和事件，但我不知道这样做是否有很大的开销。

在我的游戏引擎中，我设计了一种“追逐凸轮”，可以附加到对象上，然后重新计算其相对于对象的位置。当物体移动时，有两种方法可以更新追踪凸轮。

*   在主游戏循环中有一个“UpdateCameras()”方法。
*   使用事件处理程序，并让追踪摄像头订阅 object.OnMoved。

我使用后者，因为它允许我将事件链接在一起并很好地自动化引擎的大部分。突然间，巨大而复杂的东西被降到了少数 3 到 5 行事件处理程序中……真是太棒了。

但是，如果每纳秒触发一次的事件处理程序会导致严重的减速，我将删除它并使用循环方法。

想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-15T15:41:23.603

如果您将事件视为订阅者列表，那么在您的代码中您所做的就是注册订阅者。在 CLR 级别，实现这一目标所需的指令数量可能最少。

如果您希望您的代码是通用的或动态的，那么您需要在调用事件之前检查是否订阅了某些内容。C# 和 .NET 的事件/委托机制以极低的成本（就 CPU 而言）为您提供了这一点。

如果您真的关心每个时钟周期，那么您永远不会编写通用/动态游戏逻辑。这是可维护/可配置代码和完全速度之间的权衡。

写得好，在我能证明这是一个问题之前，我会支持活动/代表。

您真正知道这对您来说是否是个问题的唯一方法是分析您的代码——无论如何，对于任何游戏开发，您都应该这样做！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-15T19:19:09.917

重要的是要意识到 C# 中的事件不是排队的异步事件（例如，Windows 消息队列）。它们本质上是一个函数指针列表。因此，引发事件不会比遍历函数指针列表并调用每个指针对性能产生更糟糕的影响。

同时，意识到正因为如此，事件是同步的。如果您的事件*侦听*器很慢，您将减慢*引发*事件的类。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T04:09:39.880

这里的主要问题似乎是：“使用 C# 委托和事件相关的开销是多少？”

与常规函数调用相比，事件几乎没有显着的开销。

使用委托可以创建隐含的因此隐藏的垃圾。垃圾可能是导致性能问题的主要原因，尤其是在 Xbox360 上。

以下代码以 EntityVisitor 对象的形式每秒生成大约 2000 字节的垃圾（以 60 fps 的速度）：

```
 private delegate void SpacialItemVisitor(ISpacialItem item);

    protected override void Update(GameTime gameTime)
    {
        m_quadTree.Visit(ref explosionCircle, ApplyExplosionEffects);
    }

    private void ApplyExplosionEffects(ISpacialItem item)
    {
    } 
```

只要您避免产生垃圾，委托就足以满足大多数目的。因为存在隐患，我宁愿避开它们，改用接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T15:41:27.787

XNA 鼓励使用接口、事件和委托来驱动用它编写的东西。查看为您设置的 GameComponent 相关类。

答案是“只要你觉得舒服就行”。

详细说明一下，例如，如果您从 gamecomponent 类继承并继承到 cameracontroller 类，并将其添加到 Game.Component 集合中。然后您可以创建您的相机类并将它们添加到您的相机控制器。

这样做会导致相机控制器被定期调用，并且能够选择和激活正确的相机或多个相机，如果这是你想要的。

这是一个例子（他所有的教程都很棒）： [ReoCode](http://roecode.wordpress.com/2008/02/11/xna-framework-gameengine-development-part-10-cameramanager-gamecomponents/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-15T15:42:28.640

在我远离实际工作的额外时间里，我也一直在学习 XNA。

恕我直言（或者如果您问我的同事，请不要那么谦虚）是事件句柄的开销将被游戏中的其他元素（例如渲染）压倒。鉴于在正常的 .Net 编程中大量使用事件，我认为底层代码已经得到了很好的优化。

老实说，我认为使用 UpdateCameras 方法可能是过早的优化。除了相机之外，事件系统可能还有更多用途。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T20:56:30.120

顺便说一句，您可能有兴趣知道[Allegro](http://www.talula.demon.co.uk/allegro/index.html)的原始开发人员[Shawn Hargreaves](http://www.talula.demon.co.uk/)是 XNA 团队的主要开发人员之一 :-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-28T23:17:39.743

在了解事件对性能的影响之前，您必须首先评估是否需要它。

假设您确实在尝试更新追踪摄像头并且它不仅仅是一个示例，那么您正在寻找的不是一个事件（尽管事件也可能起到作用），如果您正在关注一个化身，那么它可能是大部分时间都在移动。

我发现一种非常有效的方法是使用分层转换，如果您有效地实现这一点，相机将不会是唯一受益于这样一个系统的对象，目标是将相机保持在对象的坐标空间内追踪。

如果您想对相机跟踪对象的速度和方式应用一些弹性，那么这种方法并不是最好的方法，为此，最好使用更新调用、参考以及一些基本的加速度和阻力物理。

Events are more useful for things that only happen from time to time or that affect many different aspects of the application, like a character dying, probably many different systems would like to be aware of such an event, kill statistics, the controlling AI, and so on, in such a case, keeping track of all the objects that would be have to constantly check if this has happened is far less effective than throwing an event and having all the interested objects be notified only when it happens.

# c# - Flickering during updates to Controls in WinForms (e.g. DataGridView)

> ID：63974
> 
> 赞同：7
> 
> 时间：2008-09-15T15:31:32.537
> 
> 标签：c#, .net, winforms

In my application I have a DataGridView control that displays data for the selected object. When I select a different object (in a combobox above), I need to update the grid. Unfortunately different objects have completely different data, even different columns, so I need to clear all the existing data and columns, create new columns and add all the rows. When this is done, the whole control flickers horribly and it takes ages. Is there a generic way to get the control in an update state so it doesn't repaint itself, and then repaint it after I finish all the updates?

It is certainly possible with TreeViews:

```
myTreeView.BeginUpdate();
try
{
    //do the updates
}
finally
{
    myTreeView.EndUpdate();
} 
```

Is there a generic way to do this with other controls, DataGridView in particular?

UPDATE: Sorry, I am not sure I was clear enough. I see the "flickering", because after single edit the control gets repainted on the screen, so you can see the scroll bar shrinking, etc.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-04T20:33:37.477

People seem to forget a simple fix for this:

```
Object.Visible = false;

//do update work

Object.Visible = true; 
```

I know it seems weird, but that works. When the object is not visible, it won't redraw itself. You still, however, need to do the `begin` and `end` update.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-15T18:45:31.010

The .NET control supports the [SuspendLayout](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.suspendlayout.aspx) and [ResumeLayout](http://msdn.microsoft.com/en-us/library/y53zat12.aspx) methods. Pick the appropriate parent control (i.e. the control that hosts the controls you want to populate) and do something like the following:

```
this.SuspendLayout();

// Do something interesting.

this.ResumeLayout(); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-15T15:57:16.563

Double buffering won't help here since that only double buffers paint operations, the flickering the OP is seeing is the result of multiple paint operations:

*   Clear control contents -> repaint
*   Clear columns -> repaint
*   Populate new columns -> repaint
*   Add rows -> repaint

so that's four repaints to update the control, hence the flicker. Unfortunately, not all the standard controls have the BeginUpdate/EndUpdate which would remove all the repaint calls until the EndUpdate is called. Here's what you can do:

1.  Have a different control for each data set and Show/Hide the controls,
2.  Remove the control from its parent, update and then add the control again,
3.  Write your own control.

Options 1 and 2 would still flicker a bit.

On the .Net GUI program I'm working on, I created a set of custom controls that eliminated all flicker.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-16T08:13:49.880

Rather than adding the rows of the data grid one at a time, use the `DataGridView.Rows.AddRange` method to add all the rows at once. That should only update the display once. There's also a `DataGridView.Columns.AddRange` to do the same for the columns.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-17T13:49:16.527

This worked for me.

[http://www.syncfusion.com/faq/windowsforms/search/558.aspx](http://www.syncfusion.com/faq/windowsforms/search/558.aspx)

Basically it involves deriving from the desired control and setting the following styles.

```
SetStyle(ControlStyles.UserPaint, true);
SetStyle(ControlStyles.AllPaintingInWmPaint, true); 
SetStyle(ControlStyles.DoubleBuffer, true); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-15T15:33:16.947

Sounds like you want double-buffering:

[http://www.codeproject.com/KB/graphics/DoubleBuffering.aspx](http://www.codeproject.com/KB/graphics/DoubleBuffering.aspx)

Although this is mainly used for individual controls, you can implement this in your Windows Forms control or Form.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-15T15:35:41.810

Unfortunatly, I think that thins might just be a by-product of the .net framework. I am experiencing similar flickering albeit with custom controls. Many of the reference material I have read indicates this, alongside the fact the the double buffering method failed to remove any flickering for me.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-10T05:11:06.863

You may also try this, its work.

```
public static void DoubleBuffered(Control formControl, bool setting)
{
    Type conType = formControl.GetType();
    PropertyInfo pi = conType.GetProperty("DoubleBuffered", BindingFlags.Instance | BindingFlags.NonPublic);
    pi.SetValue(formControl, setting, null);
} 
```

# .net - 在实例化时为类提供唯一 ID：.Net

> ID：63995
> 
> 赞同：2
> 
> 时间：2008-09-15T15:34:22.997
> 
> 标签：.net, vb.net

每次实例化一个新的类时，我想给一个类一个唯一的 ID。例如，对于一个名为 Foo 的类，我希望能够执行以下操作

```
dim a as New Foo()
dim b as New Foo() 
```

a 将获得一个唯一的 ID，而 b 将获得一个唯一的 ID。ids 只需要在运行时是唯一的，所以我只想使用一个整数。我找到了一种方法来做到这一点，但是（这是警告）我不希望能够从任何地方更改 ID。我目前对实现此方法的想法如下：

```
Public Class test
    Private Shared ReadOnly _nextId As Integer
    Private ReadOnly _id As Integer
    Public Sub New()
        _nextId = _nextId + 1
        _id = _nextId
    End Sub
End Class 
```

但是，这不会编译，因为它会在 _nextId = _nextId + 1 上引发错误我不明白为什么这是一个错误（因为 _Id 也是只读的，您应该能够在构造函数中更改只读变量。 ) 我认为这与共享也有关。任何解决方案（希望不是笨拙的呵呵）或解释为什么这不起作用都会被接受。重要的部分是我希望这两个变量（或者如果有一种方法只有一个更好，但我认为这是不可能的）在对象初始化后是不可变的。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-15T15:45:21.940

这种设计容易受到多线程问题的影响。我强烈建议您使用 Guids 作为您的 ID (Guid.NewGuid())。如果您绝对必须使用整数，请查看[Interlocked](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.aspx)类。您可以将所有递增和 Id 逻辑包装在一个基类中，这样您就只能在一个位置访问 ID 生成器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-15T15:59:55.870

考虑以下代码：

```
Public Class Foo 
    Private ReadOnly _fooId As FooId 

    Public Sub New() 
        _fooId = New FooId() 
    End Sub 

    Public ReadOnly Property Id() As Integer 
        Get 
            Return _fooId.Id 
        End Get 
    End Property 
End Class 

Public NotInheritable Class FooId 
    Private Shared _nextId As Integer 
    Private ReadOnly _id As Integer 

    Shared Sub New() 
        _nextId = 0 
    End Sub 

    Public Sub New() 
        SyncLock GetType(FooId) 
            _id = System.Math.Max(System.Threading.Interlocked.Increment(_nextId),_nextId - 1) 
        End SyncLock 
    End Sub 

    Public ReadOnly Property Id() As Integer 
        Get 
            Return _id 
        End Get 
    End Property 
End Class 
```

不是在 Foo 中存储一个 int，而是存储一个 FooId 类型的对象。这样您就可以完全控制对 id 可以做什么和不可以做什么。

为了保护我们的 FooId 免受操纵，它不能被继承，并且除了构造函数和 int 的 getter 之外没有其他方法。此外，变量 _nextId 是 FooId 私有的，不能从外部更改。最后，FooId 构造函数中的 SyncLock 确保它永远不会并行执行，从而保证进程中的所有 ID 都是唯一的（直到您点击 MaxInt :)）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-15T15:47:09.130

ReadOnly 变量必须在对象构造期间初始化，之后不能更新。这不会编译，因为您不能因此而增加 _nextId。（Shared ReadOnly 变量只能在 Shared 构造函数中赋值。）

因此，如果您删除 _nextId 定义上的 ReadOnly 修饰符，您应该没问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-15T15:47:15.603

我会这样做。

```
Public MustInherit Class Unique
    Private _UID As Guid = Guid.NewGuid()
    Public ReadOnly Property UID() As Guid
        Get
            Return _UID
        End Get
    End Property
End Class 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-15T15:38:45.843

它会引发错误，因为 _nextId 是只读的。删除它。

**编辑：** 正如你所说，ReadOnly 变量可以在构造函数中更改，但如果它们是共享的，则不能。这些只能在共享构造函数中更改。例子：

```
Shared Sub New()
   _nextId = 0
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-15T15:48:29.127

共享整数不应该是只读的。标记的字段`readonly`只能分配一次，并且必须在构造函数退出之前分配。

由于共享字段是私有的，因此无论如何外部都不会更改该字段。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-15T16:06:13.280

您说“这不会编译，因为它会引发错误”，但从未说过该错误是什么。

共享变量是静态的，因此内存中只有一个副本可供所有实例访问。您只能从静态（共享）构造函数（New（））修改静态只读（共享只读），所以您可能想要这样的东西：

```
Public Class test
   Private Shared ReadOnly _nextId As Integer
   Private ReadOnly _id As Integer

   Public Shared Sub New()
      _nextId = _nextId + 1
   End Sub

   Public Sub New()
      _id = _nextId
   End Sub
End Class 
```

（我认为这在 VB 中是正确的语法。）在 C# 中，它看起来像这样：

```
public class Test
{
   private static readonly int _nextId;
   private readonly int _id;

   static Test()
   {
      _nextId++;
   }

   public Test()
   {
      _id = _nextId;
   } 
```

}

这里唯一的问题是静态构造函数只会被调用一次，所以 _nextId 只会增加一次。由于它是一个静态只读变量，因此您只能将其初始化为静态构造函数，因此您的新实例不会像您想要的那样获得递增的 _id 字段。

您在这种情况下要解决的问题是什么？这些唯一 ID 是否必须是整数值？如果没有，您可以使用 Guid 并在您的构造函数中调用 Guid。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-15T16:44:26.120

我发布了一个[类似的问题](https://stackoverflow.com/questions/41792/instance-constructor-sets-a-static-member-is-it-thread-safe)，专注于设置唯一实例 ID 的多线程问题。您可以查看它以获取详细信息。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-15T15:36:28.890

这可能会引发错误，因为您从未将 _nextId 初始化为任何内容。它需要有一个初始值，然后才能安全地添加 1。

# ruby - Ruby 的隐藏特性

> ID：63998
> 
> 赞同：159
> 
> 时间：2008-09-15T15:34:28.630
> 
> 标签：ruby, hidden-features

继续“...的隐藏特性”模因，让我们分享 Ruby 编程语言鲜为人知但有用的特性。

试着用核心 Ruby 来限制这个讨论，而不用任何 Ruby on Rails 的东西。

也可以看看：

*   [C#的隐藏特性](https://stackoverflow.com/questions/9033/hidden-features-of-c)
*   [Java的隐藏特性](https://stackoverflow.com/questions/15496/hidden-features-of-java)
*   [JavaScript 的隐藏特性](https://stackoverflow.com/questions/61088/hidden-features-of-javascript)
*   [Ruby on Rails 的隐藏特性](https://stackoverflow.com/questions/709679/hidden-features-of-ruby-on-rails)
*   [Python的隐藏特性](https://stackoverflow.com/questions/101268/hidden-features-of-python)

（请，每个答案只有*一个隐藏功能。）*

谢谢

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-09-15T17:41:22.660

从 Ruby 1.9 开始，Proc#=== 是 Proc#call 的别名，这意味着 Proc 对象可以在 case 语句中使用，如下所示：

```
def multiple_of(factor)
  Proc.new{|product| product.modulo(factor).zero?}
end

case number
  when multiple_of(3)
    puts "Multiple of 3"
  when multiple_of(7)
    puts "Multiple of 7"
end 
```

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2008-09-15T16:31:32.313

Peter Cooper 有一个[很好](http://www.rubyinside.com/21-ruby-tricks-902.html)的 Ruby 技巧列表。也许我最喜欢他的是允许列举单个项目和集合。（也就是说，将非集合对象视为仅包含该对象的集合。）它看起来像这样：

```
[*items].each do |item|
  # ...
end 
```

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2008-09-16T07:53:31.863

不知道这是多么隐藏，但我发现它在需要从一维数组中生成哈希时很有用：

```
fruit = ["apple","red","banana","yellow"]
=> ["apple", "red", "banana", "yellow"]

Hash[*fruit]    
=> {"apple"=>"red", "banana"=>"yellow"} 
```

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2008-09-16T08:14:19.460

我喜欢的一个技巧是在`*`数组以外的对象上使用 splat ( ) 扩展器。这是正则表达式匹配的示例：

```
match, text, number = *"Something 981".match(/([A-z]*) ([0-9]*)/) 
```

其他示例包括：

```
a, b, c = *('A'..'Z')

Job = Struct.new(:name, :occupation)
tom = Job.new("Tom", "Developer")
name, occupation = *tom 
```

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2010-06-16T15:23:36.663

哇，没有人提到触发器运算符：

```
1.upto(100) do |i|
  puts i if (i == 3)..(i == 15)
end 
```

* * *

## 回答 #6

> 赞同：49
> 
> 时间：2009-01-23T22:35:34.483

ruby 的一个很酷的地方是您可以在其他语言不喜欢的地方调用方法和运行代码，例如在方法或类定义中。

例如，要创建一个直到运行时才具有未知超类的类，即随机类，您可以执行以下操作：

```
class RandomSubclass < [Array, Hash, String, Fixnum, Float, TrueClass].sample

end

RandomSubclass.superclass # could output one of 6 different classes. 
```

这使用了 1.9`Array#sample`方法（仅在 1.8.7 中，请参阅 参考资料`Array#choice`），该示例非常做作，但您可以在此处看到强大的功能。

另一个很酷的例子是能够放置不固定的默认参数值（就像其他语言经常需要的那样）：

```
def do_something_at(something, at = Time.now)
   # ...
end 
```

当然，第一个示例的问题在于它是在定义时评估的，而不是调用时。因此，一旦选择了一个超类，它就会在程序的其余部分保持该超类。

但是，在第二个示例中，每次调用`do_something_at`时，`at`变量都会是调用方法的时间（嗯，非常接近）

* * *

## 回答 #7

> 赞同：47
> 
> 时间：2008-09-17T16:56:16.200

另一个小功能 - 将 a 转换`Fixnum`为最多 36 的任何基数：

```
>> 1234567890.to_s(2)
=> "1001001100101100000001011010010"

>> 1234567890.to_s(8)
=> "11145401322"

>> 1234567890.to_s(16)
=> "499602d2"

>> 1234567890.to_s(24)
=> "6b1230i"

>> 1234567890.to_s(36)
=> "kf12oi" 
```

正如 Huw Walters 评论的那样，转换另一种方式同样简单：

```
>> "kf12oi".to_i(36)
=> 1234567890 
```

* * *

## 回答 #8

> 赞同：40
> 
> 时间：2009-06-30T05:09:36.623

具有默认值的哈希！在这种情况下是一个数组。

```
parties = Hash.new {|hash, key| hash[key] = [] }
parties["Summer party"]
# => []

parties["Summer party"] << "Joe"
parties["Other party"] << "Jane" 
```

在元编程中非常有用。

* * *

## 回答 #9

> 赞同：38
> 
> 时间：2008-09-15T15:49:07.377

下载 Ruby 1.9 源代码，然后 issue `make golf`，然后你可以做这样的事情：

```
make golf

./goruby -e 'h'
# => Hello, world!

./goruby -e 'p St'
# => StandardError

./goruby -e 'p 1.tf'
# => 1.0

./goruby19 -e 'p Fil.exp(".")'
"/home/manveru/pkgbuilds/ruby-svn/src/trunk" 
```

阅读`golf_prelude.c`更多隐藏的东西。

* * *

## 回答 #10

> 赞同：38
> 
> 时间：2008-09-16T07:39:33.333

1.9 Proc 功能中另一个有趣的附加功能是 Proc#curry，它允许您将接受 n 参数的 Proc 转换为接受 n-1 的 Proc。这里结合了我上面提到的 Proc#=== 提示：

```
it_is_day_of_week = lambda{ |day_of_week, date| date.wday == day_of_week }
it_is_saturday = it_is_day_of_week.curry[6]
it_is_sunday = it_is_day_of_week.curry[0]

case Time.now
when it_is_saturday
  puts "Saturday!"
when it_is_sunday
  puts "Sunday!"
else
  puts "Not the weekend"
end 
```

* * *

## 回答 #11

> 赞同：35
> 
> 时间：2009-12-21T17:32:42.360

非布尔值的布尔运算符。

`&&`和`||`

两者都返回最后评估的表达式的值。

这就是为什么`||=`如果变量未定义，将使用右侧的值返回表达式更新变量。这没有明确记录，而是常识。

然而，`&&=`它并没有那么广为人知。

```
string &&= string + "suffix" 
```

相当于

```
if string
  string = string + "suffix"
end 
```

如果变量未定义，这对于不应进行的破坏性操作非常方便。

* * *

## 回答 #12

> 赞同：29
> 
> 时间：2008-09-16T00:22:09.890

Rails 提供的 Symbol#to_proc 函数真的很酷。

代替

```
Employee.collect { |emp| emp.name } 
```

你可以写：

```
Employee.collect(&:name) 
```

* * *

## 回答 #13

> 赞同：28
> 
> 时间：2008-09-17T18:40:01.443

最后一个 - 在 ruby​​ 中，您可以使用任何要分隔字符串的字符。采取以下代码：

```
message = "My message"
contrived_example = "<div id=\"contrived\">#{message}</div>" 
```

如果您不想转义字符串中的双引号，您可以简单地使用不同的分隔符：

```
contrived_example = %{<div id="contrived-example">#{message}</div>}
contrived_example = %[<div id="contrived-example">#{message}</div>] 
```

除了避免转义分隔符外，您还可以将这些分隔符用于更好的多行字符串：

```
sql = %{
    SELECT strings 
    FROM complicated_table
    WHERE complicated_condition = '1'
} 
```

* * *

## 回答 #14

> 赞同：26
> 
> 时间：2009-11-30T03:30:00.283

使用 Range 对象作为无限惰性列表：

```
Inf = 1.0 / 0

(1..Inf).take(5) #=> [1, 2, 3, 4, 5] 
```

更多信息在这里：[http ://banisterfiend.wordpress.com/2009/10/02/wtf-infinite-ranges-in-ruby/](http://banisterfiend.wordpress.com/2009/10/02/wtf-infinite-ranges-in-ruby/)

* * *

## 回答 #15

> 赞同：25
> 
> 时间：2008-09-15T15:44:16.140

我发现使用**define_method**命令动态生成方法非常有趣，而且不为人所知。例如：

```
((0..9).each do |n|
    define_method "press_#{n}" do
      @number = @number.to_i * 10 + n
    end
  end 
```

上面的代码使用“define_method”命令动态创建方法“press1”到“press9”。与其键入所有 10 个本质上包含相同代码的方法，不如使用 define method 命令根据需要动态生成这些方法。

* * *

## 回答 #16

> 赞同：23
> 
> 时间：2008-09-22T18:56:02.837

# 模块功能

声明为*module_function*的模块方法将在包含该模块的类中创建自己的副本作为**私有实例方法：**

```
module M
  def not!
    'not!'
  end
  module_function :not!
end

class C
  include M

  def fun
    not!
  end
end

M.not!     # => 'not!
C.new.fun  # => 'not!'
C.new.not! # => NoMethodError: private method `not!' called for #<C:0x1261a00> 
```

如果您使用不带任何参数的*module_function*，那么 module_function 语句之后的任何模块方法都将自动成为 module_functions 本身。

```
module M
  module_function

  def not!
    'not!'
  end

  def yea!
    'yea!'
  end
end

class C
  include M

  def fun
    not! + ' ' + yea!
  end
end
M.not!     # => 'not!'
M.yea!     # => 'yea!'
C.new.fun  # => 'not! yea!' 
```

* * *

## 回答 #17

> 赞同：23
> 
> 时间：2009-06-29T23:05:14.440

短注入，像这样：

[范围总和：](http://weblog.raganwald.com/2008/02/1100inject.html)

```
(1..10).inject(:+)
=> 55 
```

* * *

## 回答 #18

> 赞同：21
> 
> 时间：2008-09-16T03:08:32.643

警告：此项目被评为***2008 年最可怕的黑客攻击***第一名，因此请小心使用。实际上，像瘟疫一样避免它，但它肯定是隐藏的红宝石。

## Superators 为 Ruby 添加新的运算符

曾经想要一个超级秘密的握手操作符来执行代码中的一些独特操作吗？喜欢打代码高尔夫？尝试像 -~+~- 或 <--- 这样的运算符。最后一个在示例中用于反转项目的顺序。

除了钦佩它之外，我与[Superators Project没有任何关系。](http://jicksta.com/posts/superators-add-new-operators-to-ruby)

* * *

## 回答 #19

> 赞同：19
> 
> 时间：2010-01-25T14:13:23.127

**在 Ruby 中自动激活哈希**

```
def cnh # silly name "create nested hash"
  Hash.new {|h,k| h[k] = Hash.new(&h.default_proc)}
end
my_hash = cnh
my_hash[1][2][3] = 4
my_hash # => { 1 => { 2 => { 3 =>4 } } } 
```

这简直太方便了。

* * *

## 回答 #20

> 赞同：19
> 
> 时间：2009-10-08T21:29:33.787

我参加聚会迟到了，但是：

您可以轻松地获取两个等长数组并将它们转换为散列，其中一个数组提供键，另一个提供值：

```
a = [:x, :y, :z]
b = [123, 456, 789]

Hash[a.zip(b)]
# => { :x => 123, :y => 456, :z => 789 } 
```

（这是因为 Array#zip “压缩”了两个数组中的值：

```
a.zip(b)  # => [[:x, 123], [:y, 456], [:z, 789]] 
```

而 Hash[] 可以采用这样的数组。我也看到人们这样做：

```
Hash[*a.zip(b).flatten]  # unnecessary! 
```

哪个产生相同的结果，但是 splat 和 flatten 完全没有必要——也许它们不是过去的？）

* * *

## 回答 #21

> 赞同：16
> 
> 时间：2010-09-29T16:43:06.607

**解构数组**

```
(a, b), c, d = [ [:a, :b ], :c, [:d1, :d2] ] 
```

在哪里：

```
a #=> :a
b #=> :b
c #=> :c
d #=> [:d1, :d2] 
```

使用这种技术，我们可以使用简单的赋值从任何深度的嵌套数组中获取我们想要的确切值。

* * *

## 回答 #22

> 赞同：15
> 
> 时间：2008-10-22T02:28:07.743

`Class.new()`

在运行时创建一个新类。参数可以是派生自的类，块是类体。您可能还想查看以`const_set/const_get/const_defined?`正确注册您的新课程，以便`inspect`打印出名称而不是数字。

不是您每天都需要的东西，但是当您这样做时非常方便。

* * *

## 回答 #23

> 赞同：13
> 
> 时间：2008-09-15T17:31:17.413

您在 Rubyland 中看到的许多魔力都与元编程有关，元编程就是编写代码，为您编写代码。Ruby 的`attr_accessor`、`attr_reader`和`attr_writer`都是简单的元编程，因为它们在一行中创建了两个方法，遵循标准模式。Rails 使用其关系管理方法（如`has_one`和`belongs_to`.

但是创建自己的元编程技巧`class_eval`来执行动态编写的代码非常简单。

以下示例允许包装器对象将某些方法转发到内部对象：

```
class Wrapper
  attr_accessor :internal

  def self.forwards(*methods)
    methods.each do |method|
      define_method method do |*arguments, &block|
        internal.send method, *arguments, &block
      end
    end
  end

  forwards :to_i, :length, :split
end

w = Wrapper.new
w.internal = "12 13 14"
w.to_i        # => 12
w.length      # => 8
w.split('1')  # => ["", "2 ", "3 ", "4"] 
```

该方法`Wrapper.forwards`采用方法名称的符号并将它们存储在`methods`数组中。然后，对于给定的每一个，我们使用`define_method`创建一个新方法，其工作是发送消息，包括所有参数和块。

元编程问题的一个很好的资源是[Why the Lucky Stiff's "Seeing Metaprogramming Clearly"](http://viewsourcecode.org/why/hacking/seeingMetaclassesClearly.html)。

* * *

## 回答 #24

> 赞同：13
> 
> 时间：2009-08-03T20:44:51.360

创建一个连续数字数组：

```
x = [*0..5] 
```

将 x 设置为 [0, 1, 2, 3, 4, 5]

* * *

## 回答 #25

> 赞同：12
> 
> 时间：2008-09-15T16:27:50.607

使用任何响应`===(obj)`案例比较的东西：

```
case foo
when /baz/
  do_something_with_the_string_matching_baz
when 12..15
  do_something_with_the_integer_between_12_and_15
when lambda { |x| x % 5 == 0 }
  # only works in Ruby 1.9 or if you alias Proc#call as Proc#===
  do_something_with_the_integer_that_is_a_multiple_of_5
when Bar
  do_something_with_the_instance_of_Bar
when some_object
  do_something_with_the_thing_that_matches_some_object
end 
```

`Module`（因此`Class`）、`Regexp`、`Date`和许多其他类定义了一个实例方法 :===(other)，并且都可以使用。

感谢[Farrel](https://stackoverflow.com/questions/63998/hidden-features-of-ruby#65015)提醒您在 Ruby 1.9`Proc#call`中使用别名。`Proc#===`

* * *

## 回答 #26

> 赞同：11
> 
> 时间：2010-01-02T20:59:28.230

“ruby”二进制文件（至少是 MRI）支持许多使 perl 单行代码非常流行的开关。

重要的：

*   -n 只用“gets”设置一个外循环——它神奇地与给定的文件名或 STDIN 一起工作，在 $_ 中设置每个读取行
*   `put`-p 与 -n 类似，但在每次循环迭代结束时有一个自动s
*   -a 在每个输入行上自动调用 .split，存储在 $F 中
*   -i 就地编辑输入文件
*   -l 在输入时自动调用 .chomp
*   -e 执行一段代码
*   -c 检查源代码
*   -w 带有警告

一些例子：

```
# Print each line with its number:
ruby -ne 'print($., ": ", $_)' < /etc/irbrc

# Print each line reversed:
ruby -lne 'puts $_.reverse' < /etc/irbrc

# Print the second column from an input CSV (dumb - no balanced quote support etc):
ruby -F, -ane 'puts $F[1]' < /etc/irbrc

# Print lines that contain "eat"
ruby -ne 'puts $_ if /eat/i' < /etc/irbrc

# Same as above:
ruby -pe 'next unless /eat/i' < /etc/irbrc

# Pass-through (like cat, but with possible line-end munging):
ruby -p -e '' < /etc/irbrc

# Uppercase all input:
ruby -p -e '$_.upcase!' < /etc/irbrc

# Same as above, but actually write to the input file, and make a backup first with extension .bak - Notice that inplace edit REQUIRES input files, not an input STDIN:
ruby -i.bak -p -e '$_.upcase!' /etc/irbrc 
```

随意谷歌“ruby one-liners”和“perl one-liners”以获得更多有用和实用的例子。它本质上允许您使用 ruby​​ 作为 awk 和 sed 的相当强大的替代品。

* * *

## 回答 #27

> 赞同：10
> 
> 时间：2008-09-15T15:45:58.570

**send()**方法是一种通用方法，可用于 Ruby 中的任何类或对象。如果没有被覆盖，send() 接受一个字符串并调用传递它的字符串的方法的名称。例如，如果用户单击“Clr”按钮，“press_clear”字符串将被发送到 send() 方法并调用“press_clear”方法。send() 方法允许以有趣且动态的方式调用 Ruby 中的函数。

```
 %w(7 8 9 / 4 5 6 * 1 2 3 - 0 Clr = +).each do |btn|
    button btn, :width => 46, :height => 46 do
      method = case btn
        when /[0-9]/: 'press_'+btn
        when 'Clr': 'press_clear'
        when '=': 'press_equals'
        when '+': 'press_add'
        when '-': 'press_sub'
        when '*': 'press_times'
        when '/': 'press_div'
      end

      number.send(method)
      number_field.replace strong(number)
    end
  end 
```

[我在Blogging Shoes: The Simple-Calc 应用程序](http://www.codingwithoutcomments.com/2008/09/01/blogging-shoes-the-simple-calc-application/)中详细讨论了这个功能

* * *

## 回答 #28

> 赞同：9
> 
> 时间：2008-09-15T23:51:16.860

愚弄一些类或模块，告诉它需要一些它确实不需要的东西：

```
$" << "something" 
```

例如，当需要 A 而需要 B 但我们在代码中不需要 B（并且 A 也不会通过我们的代码使用它）时，这很有用：

例如 Backgroundrb's `bdrb_test_helper requires` `'test/spec'`，但您根本不使用它，所以在您的代码中：

```
$" << "test/spec"
require File.join(File.dirname(__FILE__) + "/../bdrb_test_helper") 
```

* * *

## 回答 #29

> 赞同：9
> 
> 时间：2011-06-08T13:28:40.997

```
private unless Rails.env == 'test'
# e.g. a bundle of methods you want to test directly 
```

看起来像 Ruby 的一个很酷且（在某些情况下）不错/有用的 hack/功能。

* * *

## 回答 #30

> 赞同：9
> 
> 时间：2010-09-30T21:05:44.067

**定义一个接受任意数量参数并丢弃它们的方法**

```
def hello(*)
    super
    puts "hello!"
end 
```

上面的`hello`方法只需要`puts` `"hello"`在屏幕上调用`super`——但由于超类`hello`定义了参数，它也必须这样做——但是因为它实际上并不需要使用参数本身——它不必给它们一个名字。

* * *

## 回答 #31

> 赞同：8
> 
> 时间：2008-09-15T16:36:01.930

如何打开基于 ARGV[0] 的文件？

`readfile.rb:`

```
$<.each_line{|l| puts l}

ruby readfile.rb testfile.txt 
```

这是编写一次性脚本的绝佳捷径。有一大堆大多数人不知道的预定义变量。明智地使用它们（阅读：不要乱扔你打算用它们维护的代码库，它会变得混乱）。

* * *

## 回答 #32

> 赞同：8
> 
> 时间：2011-05-17T20:59:54.080

要将多个正则表达式与 结合`|`，您可以使用

```
Regexp.union /Ruby\d/, /test/i, "cheat" 
```

创建类似于以下内容的正则表达式：

```
/(Ruby\d|[tT][eE][sS][tT]|cheat)/ 
```

* * *

## 回答 #33

> 赞同：8
> 
> 时间：2009-07-16T21:37:02.900

我发现这在某些脚本中很有用。它使直接使用环境变量成为可能，例如在 shell 脚本和 Makefile 中。环境变量用作未定义的 Ruby 常量的后备。

```
>> class <<Object
>>  alias :old_const_missing :const_missing
>>  def const_missing(sym)
>>   ENV[sym.to_s] || old_const_missing(sym)
>>  end
>> end
=> nil

>> puts SHELL
/bin/zsh
=> nil
>> TERM == 'xterm'
=> true 
```

* * *

## 回答 #34

> 赞同：8
> 
> 时间：2010-02-26T10:05:21.077

`Fixnum#to_s(base)`在某些情况下可能非常有用。一种这样的情况是通过使用 36 为基数将随机数转换为字符串来生成随机（伪）唯一标记。

长度为 8 的令牌：

```
rand(36**8).to_s(36) => "fmhpjfao"
rand(36**8).to_s(36) => "gcer9ecu"
rand(36**8).to_s(36) => "krpm0h9r" 
```

长度为 6 的令牌：

```
rand(36**6).to_s(36) => "bvhl8d"
rand(36**6).to_s(36) => "lb7tis"
rand(36**6).to_s(36) => "ibwgeh" 
```

* * *

## 回答 #35

> 赞同：5
> 
> 时间：2010-05-26T08:58:55.360

我是：

```
%w{An Array of strings} #=> ["An", "Array", "of", "Strings"] 
```

有用的频率有点有趣。

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2010-11-27T22:53:32.883

## 多个返回值

```
def getCostAndMpg
    cost = 30000  # some fancy db calls go here
    mpg = 30
    return cost,mpg
end
AltimaCost, AltimaMpg = getCostAndMpg
puts "AltimaCost = #{AltimaCost}, AltimaMpg = #{AltimaMpg}" 
```

## 并行分配

```
i = 0
j = 1
puts "i = #{i}, j=#{j}"
i,j = j,i
puts "i = #{i}, j=#{j}" 
```

## 虚拟属性

```
class Employee < Person
  def initialize(fname, lname, position)
    super(fname,lname)
    @position = position
  end
  def to_s
     super + ", #@position"
  end
  attr_writer :position
  def etype
     if @position == "CEO" || @position == "CFO"
         "executive"
     else
         "staff"
     end
  end
end
employee = Employee.new("Augustus","Bondi","CFO")
employee.position = "CEO"
puts employee.etype    =>  executive
employee.position = "Engineer"
puts employee.etype    =>  staff 
```

## method_missing - 一个绝妙的主意

*（在大多数语言中，当找不到方法并且抛出错误并且您的程序停止时。在 ruby​​ 中，您实际上可以捕获这些错误，并可能针对这种情况做一些智能的事情）*

```
class MathWiz
  def add(a,b) 
    return a+b
  end
  def method_missing(name, *args)
    puts "I don't know the method #{name}"
  end
end
mathwiz = MathWiz.new
puts mathwiz.add(1,4)
puts mathwiz.subtract(4,2) 
```

> 5
> 
> 我不知道减法
> 
> 零

* * *

## 回答 #37

> 赞同：4
> 
> 时间：2010-01-02T20:35:05.503

James A. Rosen 的提示很酷（[*items].each），但我发现它破坏了哈希：

```
irb(main):001:0> h = {:name => "Bob"}
=> {:name=>"Bob"}
irb(main):002:0> [*h]
=> [[:name, "Bob"]] 
```

当我接受要处理的事情列表但很宽容并允许调用者提供一个时，我更喜欢这种处理案例的方式：

```
irb(main):003:0> h = {:name => "Bob"}
=> {:name=>"Bob"}
irb(main):004:0> [h].flatten
=> [{:name=>"Bob"}] 
```

这可以很好地与方法签名相结合：

```
def process(*entries)
  [entries].flatten.each do |e|
    # do something with e
  end
end 
```

* * *

## 回答 #38

> 赞同：4
> 
> 时间：2010-11-09T23:05:16.970

调用在继承链中任意位置定义的方法，即使被覆盖

ActiveSupport 的对象有时会伪装成内置对象。

```
需要'active_support'
天 = 5.天
days.class #=> Fixnum
days.is_a?(Fixnum) #=> true
Fixnum === days #=> false（嗯？你到底是什么？）
Object.instance_method(:class).bind(days).call #=> ActiveSupport::Duration（啊哈！）
ActiveSupport::Duration === days #=> true

```

当然，上面的内容依赖于 active_support 没有重新定义 Object#instance_method 的事实，在这种情况下，我们真的会陷入困境。再说一次，我们总是可以在加载任何 3rd 方库之前保存 Object.instance_method(:class) 的返回值。

Object.instance_method(...) 返回一个 UnboundMethod ，然后您可以将其绑定到该类的实例。在这种情况下，您可以将其绑定到 Object 的任何实例（包括子类）。

如果对象的类包含模块，您还可以使用这些模块中的 UnboundMethod。

```
模组模组
  def var_add(更多); @var+更多；结尾
结尾
类
  包括模组
  定义初始化（变量）；@var=var; 结尾
  # 覆盖
  def var_add(更多); @var+更多+更多；结尾
结尾
cla = Cla.new('abcdef')
cla.var_add('ghi') #=> "abcdefghighi"
Mod.instance_method(:var_add).bind(cla).call('ghi') #=> "abcdefghi"

```

这甚至适用于覆盖对象所属类的实例方法的单例方法。

```
Foo 类
  定义我的方法；'原来的'; 结尾
结尾
foo = Foo.new
foo.mymethod #=> '原始'
def foo.mymethod; '单身'; 结尾
foo.mymethod #=> '单例'
Foo.instance_method(:mymethod).bind(foo).call #=> 'original'

# 你也可以在单例类上调用#instance 方法：
类 << foo; 自己; end.instance_method(:mymethod).bind(foo).call #=> 'singleton'

```

* * *

## 回答 #39

> 赞同：3
> 
> 时间：2010-03-04T12:13:38.197

我只是*喜欢*这样的内联关键字**救援**：
**编辑示例：**

```
@user #=> nil (but I did't know)
@user.name rescue "Unknown"
link_to( d.user.name, url_user( d.user.id, d.user.name)) rescue 'Account removed' 
```

这样可以避免破坏我的应用程序，并且比 Rails *.try()发布的功能要好得多*

* * *

## 回答 #40

> 赞同：3
> 
> 时间：2010-07-27T07:27:56.067

**任何可枚举对象（数组、哈希等）的**each_with_index方法？****

 **```
myarray = ["la", "li", "lu"]
myarray.each_with_index{|v,idx| puts "#{idx} -> #{v}"}

#result:
#0 -> la
#1 -> li
#2 -> lu 
```

也许它比其他答案更广为人知，但对所有 ruby​​ 程序员来说并不那么出名:)

* * *

## 回答 #41

> 赞同：3
> 
> 时间：2011-03-17T00:06:44.267

人们应该知道符号文字的某些方面。特殊符号文字解决的一种情况是，当您需要使用正常的符号文字语法创建一个名称由于某种原因导致语法错误的符号时：

```
:'class' 
```

您还可以进行符号插值。在访问器的上下文中，例如：

```
define_method :"#{name}=" do |value|
  instance_variable_set :"@#{name}", value
end 
```

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2012-01-19T21:40:14.693

我刚刚阅读了所有答案......一个值得注意的遗漏是解构分配：

```
> (a,b),c = [[1,2],3]
=> [[1,2],3]
> a
=> 1 
```

它也适用于块参数。当您有嵌套数组时，这很有用，其中每个元素都代表不同的东西。无需编写像“array[0][1]”这样的代码，您可以将嵌套数组分解并在一行代码中为每个元素指定一个描述性名称。

* * *

## 回答 #43

> 赞同：2
> 
> 时间：2008-11-29T05:17:42.317

Ruby 有一种[call/cc](http://gd.tuwien.ac.at/languages/scheme/tutorial-dsitaram/t-y-scheme-Z-H-14.html#%_sec_13.1)机制，允许人们自由地在堆栈中上下跳跃。

简单的例子如下。这当然不是在 ruby​​ 中乘以一个序列的方式，但它演示了如何使用 call/cc 到达堆栈以使算法短路。在这种情况下，我们递归地乘以一个数字列表，直到我们看到每个数字或者我们看到零（我们知道答案的两种情况）。在零的情况下，我们可以在列表中任意深并终止。

```
#!/usr/bin/env ruby

def rprod(k, rv, current, *nums)
  puts "#{rv} * #{current}"
  k.call(0) if current == 0 || rv == 0
  nums.empty? ? (rv * current) : rprod(k, rv * current, *nums)
end

def prod(first, *rest)
  callcc { |k| rprod(k, first, *rest) }
end

puts "Seq 1:  #{prod(1, 2, 3, 4, 5, 6)}"
puts ""
puts "Seq 2:  #{prod(1, 2, 0, 3, 4, 5, 6)}" 
```

你可以在这里看到输出：

[http://codepad.org/Oh8ddh9e](http://codepad.org/Oh8ddh9e)

有关在堆栈上向另一个方向移动延续的更复杂示例，请阅读[Generator](http://www.ruby-doc.org/stdlib/libdoc/generator/rdoc/index.html)的源代码。

* * *

## 回答 #44

> 赞同：2
> 
> 时间：2009-05-06T03:39:40.353

```
class A

  private

  def my_private_method
    puts 'private method called'
  end
end

a = A.new
a.my_private_method # Raises exception saying private method was called
a.send :my_private_method # Calls my_private_method and prints private method called' 
```

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2010-05-08T03:29:24.247

```
@user #=> nil (but I did't know)
@user.name rescue "Unknown" 
```

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2012-02-09T15:55:09.607

## sprintf 快捷方式

我最喜欢的红宝石功能。语法是`format_string % argument`

```
"%04d"  % 1         # => "0001"
"%0.2f" % Math::PI  # => "3.14" 
```

也适用于数组 ( `format_string % array_of_arguments`)

```
"%.2f %.3f %.4f" % ([Math::PI]*3) 
# => "3.14 3.142 3.1416" 
```***********