# StackOverflow 问答 000264000-000264999

# asp.net-mvc - 如何使用 ASP.NET MVC ActionFilterAttribute/IResultFilter 修改输出

> ID：264002
> 
> 赞同：3
> 
> 时间：2008-11-05T00:30:33.500
> 
> 标签：asp.net-mvc

我正在尝试修改输出流以搜索/替换从视图返回的一些 XHTML 标记。我可以使用传统的 ASP.NET 响应过滤器，但我想先尝试 ASP.NET MVC 操作过滤器。

```
public class MyResultFilter : ActionFilterAttribute
{
    public override void OnResultExecuting(ResultExecutingContext filterContext)
    {            
        base.OnResultExecuting(filterContext);
    }
    public override void OnResultExecuted(ResultExecutedContext filterContext)
    {
        ViewResult viewResult = filterContext.Result as ViewResult;
        Debug.WriteLine("OnResultExecuted");
        base.OnResultExecuted(filterContext);
    }   
} 
```

我无法确定如何修改或获取 viewResult 输出流。Web 上的示例仅显示日志记录的基本属性，从不修改结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T00:47:58.847

我认为使用 ActionFilterAttribute 执行此操作不是一个好主意，因为它专用于控制器级别的决策，而不是特定于 HTML 请求后处理。正确执行此操作的最佳方法可能是创建特定的基 View 类甚至 ViewEngine，或者使用旧的好 HttpModules，因为它们是为您尝试做的事情而创建的。干杯。

# code-snippets - 代码片段执行工具

> ID：264004
> 
> 赞同：11
> 
> 时间：2008-11-05T00:32:12.950
> 
> 标签：code-snippets

“代码片段执行”是指编写几行代码、运行和测试它而无需启动 IDE 并创建虚拟项目的能力。

它非常有用，可以在不创建项目的情况下通过小代码示例帮助人们，干净地编译所有内容，向他们发送代码片段并删除项目。

我不是在问最好的代码片段或片段编辑器或在哪里存储片段！

对于 C#，我使用[Snippet Compiler](http://www.sliver.com/dotnet/SnippetCompiler/)。

对于 Java，我使用 Eclipse [Scrapbook](http://www.eclipsezone.com/eclipse/forums/t61137.html)。

对于 LINQ，我使用[LINQPad](http://www.linqpad.net/)。

对其他（更好的？）工具有什么建议吗？例如，有没有不涉及启动 Eclipse 的 Java 版本？

C呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-12-28T13:49:24.733

试试[ideone](http://ideone.com)。它能够在服务器端以包括 C 和 Java 在内的 40 多种编程语言运行您的代码（个人免费使用）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T01:35:57.643

对于 C，浏览器内的[http://codepad.org/](http://codepad.org/)确实很棒。执行代码和一切。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T01:01:38.537

为了执行 JavaScript 片段，我使用大多数[Firebug](http://getfirebug.org)和 Google Chrome JavaScript 控制台。

对于 F#，我使用[交互式控制台](http://en.wikibooks.org/wiki/F_Sharp_Programming/Getting_Set_Up#F.23_Interactive_Environment)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-09T20:24:47.817

我有时想尝试一些非常简短的东西来确认语义。由于创建一个临时文件并放入样板文件需要 30 多秒，我有这个脚本：

```
#!/bin/sh

body="$1"
out=$(mktemp /tmp/ccrun-XXXXXX)
src=${out}.c
cat > ${src} <<EOF
#include <limits.h>
#include <string.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

#define UNUSED __attribute__((unused))

int main(int UNUSED argc,char UNUSED *argv[])
{
EOF
echo "$body" >> ${src}
echo -e "return 0;\n}" >> ${src}
cc -std=c99 -Wall -Wextra ${CCRUN_FLAGS} -o ${out} ${src} -lm
shift
echo ${out} "$@"
${out} "$@"
#rm ${out} ${src} 
```

示例调用（此代码静态初始化函数指针数组）如下所示：

```
$ ccrun 'int f(int a){return a+1;} int g(int a){return a+2;} int (*farr[2])(int) = {f,g}; for (int i=0; i<2; i++) printf("%d %d\n",i,farr[i](i));'
/tmp/ccrun-6nT4Wo
0 1
1 3 
```

如果我想做些小改动，我只需编辑命令行。如果它在命令行上变得笨拙，我将编辑临时文件，在这种情况下为`/tmp/ccrun-6nT4Wo.c`. 可执行文件的命令行参数可以在程序之后给出（第一个参数）。可执行文件保留在原处，因此无需重新编译即可运行。您可以为任何语言做类似的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T09:16:45.730

在 Ruby 中，您可以使用[交互式 Ruby Shell](http://en.wikipedia.org/wiki/Interactive_Ruby_Shell)。

看起来 mono 项目中的大师们已经完成了[C# 交互式](http://www.mono-project.com/CsharpRepl). 耶

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-12T04:05:33.097

对于 Python 和 Sage，请尝试[http://live.codenode.org](http://live.codenode.org)。它也是一个开源项目，在 BSD 下获得许可，因此可以从您自己的计算机上下载和运行，更多信息在这里：[http ://codenode.org](http://codenode.org)

# xml - 在 Delphi 中对超大型文档进行最快的 XML 处理

> ID：264020
> 
> 赞同：8
> 
> 时间：2008-11-05T00:41:51.590
> 
> 标签：xml, delphi, delphi-2009, large-files

我需要关于在 Delphi 中使用什么（我使用 Delphi 2009）以尽可能快地处理非常大的 XML 文件（例如 100 MB）的建议。

我需要输入 XML，从我的程序中访问和更新其中的数据，然后再次导出修改后的 XML。

希望输入和输出可以在快速的 Windows 机器上在几秒钟内完成。

* * *

澄清。我预计我将需要使用 DOM，因为访问用于开发报告和更新数据的数据结构很重要，并且我需要此功能非常快速。

输入只为文件加载完成一次，输出只为文件保存完成，通常只在退出时完成一次。这些也应该很快，但不如内存数据访问和更新重要。

我的理解是，第 3 方解析器仅对输入和输出有帮助，而不是在加载到内存后使用和修改数据。还是我错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T08:24:27.147

如果我正确理解了您的问题，那么您已经知道数据结构并且您正在修改数据 - 而不是文件的 XML 结构。

在这些情况下*，如果性能至关重要*，那么您可以尝试直接进行文本操作 - 跳过 XML 解析。

从流中读取，使用一些快速的文本搜索算法，例如[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer-Moore_string_search_algorithm)，找到您需要修改数据的地方，进行修改并将数据输出到另一个流中。

这将是一次性的，没有 XML 解析，没有内存中的 XML 树构建。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T01:44:42.320

SAX 值得考虑，而不是 DOM 解析器。

使用 DOM，您需要支付加载文档的开销，但一旦加载数据，就可以快速访问和更新。

使用 SAX，您必须为 begin-element、end-element 等编写处理程序，但您在进行操作时拥有更大的灵活性。

尽管它可能对您的情况没有帮助，但 SAX 在您搜索时非常有用，因为您可以在任何时候停止解析，因此一旦您找到了您想要的内容，您就可以停止。

如果您的程序在知道要进行哪些更改之前不需要解析所有数据，您可以编写 SAX 处理程序，在读取数据时更新数据并以其他方式传递数据，这样它就可以流式传输数据，而不必将其全部加载到任何类型的内存结构中。这将使解决方案非常可扩展，因为您不会遇到非常大的文件的内存限制。

对于它的价值，我倾向于使用 MSXML DOM 和 SAX 解析器。可以说它们不是表现最好的，我认为可能有更多的人在努力改进它们，所以它们会变得越来越好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T07:14:31.140

我对SimDesign 的[NativeXML](http://www.simdesign.nl/xml.html)非常满意。它还包括一个名为 FastXML 的特殊版本，我尚未对其进行测试，但据说它很快。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-05T01:36:58.577

您可能想看看[The Delphi Inspiration 中的 DIHtmlParser 组件](http://www.yunqa.de/delphi/doku.php/products/htmlparser/index)。它应该“非常快，尤其是在解析大文件时”，并且“在现代机器上，每秒的 HTML 数据超过 15 MB”。尽管我从未尝试过处理大文件，但我对它有过一些很好的体验。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T00:56:08.707

我不是专家，但我相信共识是​​ SAX 解析器将比 DOM 更有效......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T11:38:04.150

如果您曾经考虑过事件驱动的 SAX 方式，那么[XML Parser 库](http://destructor.de/xmlparser/index.htm)可能会非常方便。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-07T03:59:47.647

我刚刚发现的另一种可能性是使用我购买的[LMD ElPack 包](http://www.lmdinnovative.com/products/lmdelpack/desc/newfeat.php)，它们包含一个 XML 支持库，他们说“速度非常快，完全支持 unicode，并且只为您的 Exe 文件增加了很小的空间”。

查看包含在 LMD 7 包（用于 Delphi 2009）中的 LMDXML.pas 单元的源代码，它说该代码基于 Michail Vlasov 的 SimpleXML Release 8.0（2006 年 7 月）代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-08T07:11:50.920

如果您只需要直接操作，我会同意 zendar 的回答。

至于 DOM 或 SAX 实现，我会推荐[DIXml](http://www.yunqa.de/delphi/doku.php/products/xml/index?DokuWiki=kg5ade2rod3o49f5v1anmf7ol1)。

# asp.net - XMLHTTP POST 请求和 System.Reflection

> ID：264022
> 
> 赞同：0
> 
> 时间：2008-11-05T00:43:17.203
> 
> 标签：asp.net, reflection, xmlhttprequest, dts

我有一个 DTS 作业，它使用 MSXML2.XMLHTTP3.0 对象生成对 ASP.NET 应用程序的发布请求。在幕后，ASP.NET 应用程序正在使用 System.Reflection 获取一些程序集信息，我收到以下异常：

> System.Web.HttpException 错误代码：-2147467259 消息会话状态只能在 enableSessionState 设置为 true 时使用，无论是在配置文件中还是在 Page 指令中。还请确保 System.Web.SessionStateModule 或自定义会话状态模块包含在应用程序配置的 \ 部分中。

DTS 职位代码：

```
Dim objSvHTTP
Dim PostData

Set objSvHTTP = CreateObject("Msxml2.XMLHTTP.3.0")
objSvHTTP.open "POST", "http://www.mywebsite.com", false
objSvHTTP.send

If (objSvrHTTP.responseText = "") Then
    //do something
Else
    //do somethiing else
End If 
```

ASP.NET 应用程序代码：

```
string WebPath = "D:\mywebsite\bin\mywebsite.dll";
Assembly UI = Assembly.LoadFrom( @WebPath );
Type t = UI.GetType( "MyWebsite.BasePage" );
MethodInfo MyMethod = t.GetMethod( "MyMethod" );
object obj = Activator.CreateInstance(t); 
MyMethod.Invoke( obj, null); 
```

问题是，我是否需要在向 ASP.NET 应用程序的 XMLHTTP 请求中提供有效的 Active Directory 凭据以避免错误消息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-14T09:57:57.497

试试这个： http: [//support.instantasp.co.uk/Topic4710-31-1.aspx](http://support.instantasp.co.uk/Topic4710-31-1.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T17:26:19.353

@伊斯拉尔汗：

我们最终找到了一种解决方法，即当 DTS 调用该过程所需的特定网页时不执行反射代码。

这可以解释为什么当我们试图在我们的开发和生产环境中解决这个问题时得到的结果好坏参半。我对每个环境中的 web.config 文件进行了比较，发现 HttpModules 部分中的 Session 引用是在我们的生产环境中，而不是在我们的开发环境中。

该过程在开发中有效，但在生产中无效。我已将此建议提交给我的同事，看看他们是否想尝试此解决方案而不是解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T09:48:35.830

从异常消息来看，这对我来说不像是身份验证问题。难道是被调用的方法试图访问 ASP.NET 会话？这将解释异常。

# apache-flex - 在 Flex 中使用 MXML 文件与使用普通的 actionscript 类有什么开销？

> ID：264043
> 
> 赞同：1
> 
> 时间：2008-11-05T00:53:59.990
> 
> 标签：apache-flex, optimization, mxml

我发现使用嵌入式脚本编写 MXML 类比尝试制作动作脚本文件要容易得多。

然而，我想知道使用 MXML 文件会产生什么样的开销——就文件大小而言。我并不是特别关心性能，但如果这是相关的，我会对任何发现感兴趣。

显然，我说的是具有布局的 UI 组件。MXML 更容易可视化和修改，但我也不清楚它到底编译了什么。我希望有一个可以忽略不计的差异。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-05T01:58:08.737

如果您要使用相同的功能，MXML 不会使您的 swf 变得更大。

影响大小的是使用 Flex SDK 及其组件。无论您是使用 MXML 还是 AS3 声明它们，您都在使用它们，并且它们的代码被构建到 swf 中。同样，如果您引用 Flex RSL，从而避免将 Flex 内容直接构建到您的 swf 中，则无论哪种方式，它的大小都是相同的。数据绑定确实创建了很多事件和侦听器，因此可能会导致一些膨胀，但不会比您使用 AS3 实用程序函数声明数据绑定机制更多。

由于 MXML 确实会生成中间 AS3 代码，因此它可能比您自己编写的更冗长，因此您可以从中看到一些额外的大小。要查看它（这有助于总体理解），您可以使用编译器指令查看以保留生成的代码。

> 来自：[http ://www.flashguru.co.uk/flex-2-compilation-hidden-goodies](http://www.flashguru.co.uk/flex-2-compilation-hidden-goodies)
> 
> 1.  右键单击导航器面板中的 Flex 项目。
> 2.  从上下文菜单中选择属性。
> 3.  在属性窗口中选择 Flex 编译器。
> 4.  在“附加编译器参数”字段中输入 -keep-generated-actionscript。
> 5.  单击“确定”以应用更改。
> 6.  单击“运行”按钮构建您的 Flex 项目。
> 7.  在导航器面板中再次右键单击您的 Flex 项目。
> 8.  从上下文菜单中选择刷新。
> 9.  导航器面板中的 Flex 项目下应该会出现一个新文件夹，名为“生成”</li>

一旦您开始调试和分析您的项目，这是一件好事，因为您可以真正看到编译器在哪里做正确（或错误）的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-16T21:54:09.237

包括 Flex 框架（无论是通过 MXML 还是纯 Actionscript）将显着增加最终 SWF 的大小。

我刚刚编写了一个由单个按钮组成的 Flash 电影。MXML 版本为 175K，而非 Flex Actionscript 版本为 2K。

虽然我自己并没有使用它，但这个项目似乎很有希望获得（一些）Flex 功能，而膨胀更少：

[http://code.google.com/p/e4xu/](http://code.google.com/p/e4xu/)

# algorithm - 您是否使用过旅行推销员算法来解决问题？

> ID：264050
> 
> 赞同：21
> 
> 时间：2008-11-05T00:56:19.390
> 
> 标签：algorithm, traveling-salesman, np-hard

我在大学时在 NP Completeness 的背景下学习了 TSP。我从来没有真正遇到过适用于实际问题的情况。一些研究表明，它已被用来选择最便宜的移动钻头的路径，即在电路板上打孔。这几乎是我能找到的所有东西。

你在用吗？TSA 还有哪些其他实际应用？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T02:41:03.267

我曾经被要求编写一个程序，用“曲线”（一条不会自相交的曲线）相当均匀地填充一个矩形区域。我的第一次尝试是在矩形内生成随机点并尝试找到它们的路径（不一定是绝对最短的）。不幸的是，这种方法效果不佳，我放弃了它。

我最终确实解决了这个问题：

![替代文字](https://imgur.com/BMWnQ.png)

我的成功方法与 TSP 无关，但出于好奇，我将对其进行总结：

从单个线段开始。现在循环：如果一行“太长”，则将其一分为二。随机移动每个点，但使点相互排斥。当进展不大时结束循环。有细节，但希望你能明白。

当然，这会产生一个有角度的路径（这是可以接受的），但很容易将拐角变成平滑的弧线。

是的，我确实保留了代码。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-05T01:23:17.247

知道问题何时是 NP-hard 有助于排除涉及解决该问题的解决方案。每当您看到 TSP（或任何其他 NP-hard 问题）为非平凡规模的问题抬起丑陋的头时，您就*知道*自己走错了路。你不仅知道，而且知道*为什么*，并且可以自信地告诉你的老板/队友/任何人。

话虽如此， [http](http://en.wikipedia.org/wiki/CONCORDE) ://en.wikipedia.org/wiki/CONCORDE表明：

> Concorde 已应用于基因映射问题、[1] 蛋白质功能预测、[2] 车辆路线、[3] 将位图图像转换为连续线图、[4] 为地震勘测调度船舶运动、[5] 和研究组合优化问题的缩放特性。[6]

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-05T02:10:56.073

是的，我在 Geocaching 应用程序中使用它来规划路线。

它目前使用点之间的直线距离，但应该正确（当我绕过它时）使用道路来计算点之间的距离。

[http://code.google.com/p/gpsturbo/](http://code.google.com/p/gpsturbo/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-05T01:01:15.480

我从来没有亲自使用过它，但是除了钻孔电路板之外的另一个应用是如果你想去许多不同的地方，比如卖真空吸尘器。您可以使用问题的解决方案来决定最便宜的方式来访问任何地方一次。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-06T00:27:12.507

大多数时候，您不想使用解决 NP-Complete/Hard 问题的算法。您只需要一个“足够好”的算法。这些通常基于启发式并给出合理的近似值。

我有一个问题是独立集（NP-Complete）的一个实例，但我发现了一种贪心算法，它在绝大多数情况下都给出了很好的结果，并且运行时间很有效。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-05-02T10:03:04.160

TSP 是 NP 完全问题的*hello world*。在它的纯粹规范形式中，你不会经常在野外找到它（[不包括像这样的演示](http://www.youtube.com/watch?v=T5D3hTjZlRc)），但是一个巨大的 NP 完全问题子集是相关的，甚至是基于 TSP 的，例如：

*   [车辆路线](http://www.youtube.com/watch?v=GybpV0uLrxc)（包括供应卡车路线）
*   航空公司/航班路线
*   列车路线
*   滑雪坡犁机走线

其中每一个都有额外的、特定于域的约束，这使得它们更难解决。所以TSP很好地介绍了NP完全问题，了解它们的本质。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-05T02:21:22.573

许多类型的优化排序，例如拼车取货、UPS 包裹递送等，凡是节点遍历需求都可以用一维工作量来表示，例如时间或距离。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-06T01:01:30.487

现实生活中很少有问题与你在数学课上学到的东西相匹配。问题被简化和抽象化，这样你就可以看到数学而不被细节分心。正如您所提到的，大型 TSP 的最佳现实示例实际上并不涉及任何旅行推销员：它涉及调度机器，这些机器具有执行与[序列相关的设置时间的](http://books.google.com/books?id=EkpDak9kEs0C&pg=PA84&lpg=PA84&dq=machine+scheduling+sequence+dependent+setup+tsp+makespan&source=web&ots=GLaEPtLPrd&sig=uPg85BQACVRWa0K3B_5pxX04134)作业。这包括手臂在不同位置移动工具的机器，以及一些绘画应用（红色->橙色->黄色比红色->黄色->橙色更容易）。在[X 射线晶体学](http://ecommons.library.cornell.edu/bitstream/1813/8613/1/TR000730.pdf)中也有一些应用，您必须将一些晶体样品定向在几个不同的角度。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-06T02:06:35.693

与该线程中的其他人一样，我为大学中的一个 NP 完全问题构建了一个解决方案（这是一个朋友的副项目） - 一个调度程序。在我同意解决他的问题时，我不知道 NP Complete 是什么。后来我意识到我已经提出了一些相当好的启发式方法来解决问题 - 但当然真正的诀窍是知道何时告诉用户没有解决方案并且他们过度限制了问题。

这是将我最终的理论课程和现实世界结合在一起的好方法。

同样，启发式和“足够接近”通常适用于现实世界中的使用，因为寻找和实施理想解决方案的成本，接近最优解决方案是首选。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-16T16:38:53.767

该公司基于改进的 TSP 算法。

[https://www.mobicorp.com/](https://www.mobicorp.com/)

他们在纽约市附近安排有线电视安装人员和维修人员等问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-08-05T21:00:36.960

因为对于具有 20-60 个节点的地图，人类通常可以比大多数算法更好地解决 TSP 问题，所以让计算机解决问题并不常见。当成本足够高时，让计算机比人类提高 1-2% 的成本是值得的。如果路线没有改变，那么可以证明花一些时间对其进行优化是合理的。这在集成电路设计中很常见。

当向您显示航空公司列表和每条航线的价格时，航空公司旅行网站使用 TSP 问题的专门版本。不同的是距离而不是距离，他们优化了成本，当然没有要求每个城市都访问一次！假设您想从 LGA 飞往 LAX。大约有 1/2 打直接路线，以及无数其他路线。它可能建议 LGA->ORD->LAX 或 LGA->DWF->LAX。可以手动定价路线的人类有时可以找到比旅游网站搜索的票价更低的票价。通常，人们不想要超过两个连接，但对于给定航班的连接数量没有上限。

我用它来解决我的[旅行推销员 iPhone 游戏](http://ring3software.com/tsp/)的路线。有趣的是，人们非常擅长解决最短路线，但不擅长解决最长路线。最长和最短的路线具有相同的复杂性，但人们似乎受过训练，能够找到最短路线，通常比计算机更快更好。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-08-16T09:04:18.027

在我的第一份工作中，我们构建了一个家庭护理调度应用程序。
我们用一些非线性时间约束和一个额外的非线性成本函数解决了 TSP 问题。
我们使用非最优求解器来解决问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-05T02:51:40.813

谷歌地图（以及其他所有基于地图的路由软件）不会使用某种旅行推销员来解决行车路线吗？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-06T00:07:55.790

据我所知，我还没有使用过 TSP，但我已经研究过一些自主机器人来穿越迷宫。所以我想知道 TSP 是否可以应用于迷宫解决。

# c++ - iostream 链接器错误

> ID：264057
> 
> 赞同：20
> 
> 时间：2008-11-05T00:58:34.380
> 
> 标签：c++, c, linker, iostream

我有一些旧的 C 代码，我想与一些 C++ 代码结合使用。

过去的 C 代码包括以下内容：

```
#include <windows.h>
#include <stdio.h>
#include <string.h>
#include "mysql.h" 
```

现在我试图让它像这样使用 C++ 和 iostream：

```
#include <windows.h>
#include <stdio.h>
#include <string>
#include <iostream>
#include "mysql.h" 
```

但是我在编译时不断收到以下链接器错误：

> [链接器错误] 未定义对 `std::string::size() const' 的引用
> 
> [链接器错误] 对 `std::string::operator[](unsigned int) const' 的未定义引用
> 
> [链接器错误] 对 `std::string::operator[](unsigned int) const' 的未定义引用
> 
> [链接器错误] 对 `std::string::operator[](unsigned int) const' 的未定义引用
> 
> [链接器错误] 未定义对 `std::ios_base::Init::Init()' 的引用
> 
> [链接器错误] 未定义对 `std::ios_base::Init::~Init()' 的引用
> 
> ld 返回 1 个退出状态

我该如何解决这个问题？

编辑：我的编译器是 Dev-C++ 4.9.9.2

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-05T01:07:39.213

C`string.h`头文件和 C++`string`头文件不可互换。

总的来说，你的问题是文件被正确编译，但错误的运行时库被链接进来。

Dev-C++ 使用 GCC。GCC 可以根据文件扩展名正确确定文件中的语言，但不会链接正确的运行时库，除非您特别要求它（命令行中的 -lstdc++）。将 GCC 称为“g++”（或者，在您的情况下，“mingwin32-g++”）也将获得正确的语言并链接所需的库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T01:06:17.763

您需要链接到您的 C++ 运行时。这取决于您的平台和编译器，但是将 -lC 添加到您的链接线可能会做到这一点。

所以可能使用您的 C++ 编译器而不是 ld 进行链接。

在任何情况下，如果您希望 C++ 代码正常工作，您可能必须使用 C++ 编译器而不是 ld 进行链接——通常需要异常和静态初始化程序才能正常工作......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-07T09:58:16.483

当我尝试用 Cygwin (g++) 编译时，我得到了同样的错误。

只需添加`-L/usr/local/bin -L/usr/lib`编译规则，它应该可以工作。

这可能特定于 Cygwin，但它也可能有助于解决您的问题。

# asp.net - VS 2008 不断删除和重新添加 ASPXCodeBehind

> ID：264058
> 
> 赞同：70
> 
> 时间：2008-11-05T00:58:41.070
> 
> 标签：asp.net, visual-studio, visual-studio-2010, visual-studio-2008, visual-studio-2015

我有一个 VS 2008 C# Web 项目，每当我对其中的文件（甚至不是项目文件本身）进行一些更改时，VS 都会从 csproj 文件中删除一些这样的行：

```
<SubType>ASPXCodeBehind</SubType> 
```

所以是这样的：

```
<Compile Include="Default.aspx.cs">
  <DependentUpon>Default.aspx</DependentUpon>
  <SubType>ASPXCodeBehind</SubType>
</Compile> 
```

会变成

```
<Compile Include="Default.aspx.cs">
  <DependentUpon>Default.aspx</DependentUpon>
</Compile> 
```

**但是**下次我在这个项目上工作时，它会重新添加这些行！就这样一直来回走动，导致我们的源代码控制系统发生了很多无意义的“变化”。这在 VS 2005 中从来没有发生过，而且对于在同一个项目文件上工作的其他开发人员来说似乎也没有发生过，只是对我来说。

有谁知道为什么会发生这种情况以及我如何阻止它这样做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-09-21T01:13:08.437

对我来说，区别取决于 Web 项目是否在 Visual Studio 中打开。

我发现如果在 Visual Studio 中打开项目的情况下将项目文件提交到版本控制，则存在 SubType 元素。关闭解决方案/项目然后从项目文件中删除 SubType 元素。现在，我始终确保在 VS 中关闭项目的情况下执行我的提交，以避免对项目文件进行不必要的更改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-10T19:18:03.023

在 VS2010 上工作并通过删除 solutionFileName.sln.DotSettings.user 文件和 solutionFileName.suo 解决了这个问题。这对我有帮助，试试看。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-06T21:28:26.220

将文件内容拆分为多个文件 - 每个类一个文件可能会有所帮助。

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=283434](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=283434)

最新链接：

[https://developercommunity.visualstudio.com/content/problem/389773/vs-2017-keeps-removing-and-re-adding-aspxcodebehin.html](https://developercommunity.visualstudio.com/content/problem/389773/vs-2017-keeps-removing-and-re-adding-aspxcodebehin.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-12T13:33:53.697

在 Tortoise SVN 中提交项目更改时，这些行也出现在 VS2012 的项目文件中。该项目曾经是一个网站，我将其转换为 Web 应用程序。

我能够使用以下不需要关闭项目的步骤绕过此**问题**：

1.  在提交 SVN 之前，使用“BUILD > Clean Solution”清理解决方案。
2.  单击“全部保存”按钮保存项目文件。
3.  使用 Tortoise SVN 提交更改。
4.  继续做项目...

# .net - 部分类中的属性未出现在“数据源”窗口中！

> ID：264074
> 
> 赞同：3
> 
> 时间：2008-11-05T01:04:02.870
> 
> 标签：.net, entity-framework, partial-classes

实体框架已创建所需的部分类。我可以将这些部分类添加到“数据源”窗口，并且属性会按预期显示。但是，如果我在单独的源文件中扩展任何类，即使在构建和刷新之后，这些属性也不会出现在“数据源”窗口中。

跨源文件的部分类中的所有属性在“数据源”窗口中按预期工作，除非已使用 EF 创建部分类。

编辑：删除 edm 设计师的违规表格后，将所有作品重新添加到其中。几乎不是一个长期的解决方案。还有其他人遇到类似的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-12T04:23:56.517

我使用了以下解决方法：

步骤 1... 创建所需项目 在您的解决方案中创建两个项目：1 - 应用程序项目（因此您正在使用的应用程序，例如 Windows 窗体应用程序） 2 - 数据层项目（一个类库项目，使 DLL 成为构建输出）

Step 2... Link The Projects 在应用程序项目中，添加对datalayer项目的项目引用，（references - add reference - project-Tab）

步骤 3... 在部分类中创建一个属性 在数据层项目中： - 如果您使用的是本地数据库，请添加数据库文件 - 添加新的 Linq to SQL 类项（.dbml 文件） - 将所需的表添加到来自服务器资源管理器的设计器表 - 右键单击​​设计器中的一个类并选择“查看代码” - 您将被带到一个已完成部分类信息的文件。- 将部分类公开 - 创建一个测试属性，例如：public string TEST { get{return "TEST";} } - 构建数据层项目 - 您现在已经向您的设计器构建类之一的部分类添加了一个属性。 ..

第 4 步 - 添加数据源 - 在您的应用程序项目中 - 转到数据源选项卡并添加一个新的对象数据源，同时选择您添加的部分类属性的类。

*   您应该在数据源视图中看到 TEST 属性...

全部做完

我认为它可以工作，因为将 .dbml 文件和部分类放在单独的项目中并通过应用程序项目中的 DLL 进行访问..强制 Visual Studio 编译并使应用程序项目中的所有内容都可用......而不是 dll当所有内容都在一个项目中时，似乎会发生单独的临时文件，而将部分类属性从数据源列表中删除。

加上它还不错..为您的数据层有一个单独的项目使其可在项目之间重用..：D

希望它适用于某人......

# c# - 如何在 C# 中使 ASP.NET 控件与同一页面上的 Silverlight 应用程序对话

> ID：264075
> 
> 赞同：0
> 
> 时间：2008-11-05T01:04:17.190
> 
> 标签：c#, asp.net, silverlight, silverlight-2.0

例如：

首先，假设我有一个带有 Windowless=true 的 Silverlight 应用程序，这样我就可以在其上放置 ASP.NET 控件。然后我在页面上放置一个 ASP.NET 按钮。当用户按下 ASP.NET 按钮时，我怎么能说 Silverlight 应用程序中的控件文本发生变化？如何从捕获 ASP.NET 按钮单击的 C# 代码向 Silverlight 应用程序发送更新消息？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T02:09:58.307

据我所知，根据您的问题，Silverlight 应用程序正在 Web 浏览器中运行，并且您已将其嵌入到 asp.net 页面中？您在页面上拖动的 asp.net 按钮的代码位于服务器上，并以 html 格式发送到 Web 浏览器。当您单击页面上的按钮时，它会将表单数据提交回 ASP.NET 解释并调用您的按钮单击代码的服务器。由于该代码在服务器上执行，因此无法访问 silverlight 应用程序。如果您确实需要直接在客户端上与 silverlight 应用程序交互，您可以在浏览器中使用 javascript。

这是一个基本示例：http: [//blogs.vertigo.com/personal/ralph/Blog/archive/2008/05/15/call-silverlight-from-javascript-call-javascript-from-silverlight.aspx](http://blogs.vertigo.com/personal/ralph/Blog/archive/2008/05/15/call-silverlight-from-javascript-call-javascript-from-silverlight.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T10:00:57.030

从内存中，您需要从您的 silverlight 应用程序中公开一个可编写脚本的成员，例如：

```
[ScriptableMember()]
public void ChangeText(string newText)
{
    // Update your text control here
} 
```

并在构造函数中注册它以从 javascript 编写脚本：

```
public MySilverlight()
{
    InitializeComponent();
    HtmlPage.RegisterScriptableObject("MyObject", this);
} 
```

然后，您可以从 javascript 调用它；

```
function ChangeText()
{
    var yourObject = getElementById("yourObjectID");
    yourObject.Content.MyObject.ChangeText("New Text");
} 
```

然后只需连接按钮的客户端单击即可调用 javascript ChangeText 方法。

希望这可以帮助。

# algorithm - 如何计算一个数字最接近的 2 或 10 的幂？

> ID：264080
> 
> 赞同：11
> 
> 时间：2008-11-05T01:06:04.037
> 
> 标签：algorithm, math

将 2 或 10 的最接近幂计算到另一个数字的最有效方法是什么？例如

3.5 将返回 4 代表 2 的幂，返回 1 代表 10 的幂

123 将返回 128 的 2 次方和 100 的 10 次方

0.24 对于 2 的幂返回 0.25，对于 10 的幂返回 0.1

我只是在寻找算法，不介意语言。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-05T01:10:21.283

```
n^round(log_n(x)) 
```

其中 log_n 是以 n 为底的对数。您可能需要修改 round() 取决于您如何定义“最接近”。

请注意，`log_n(x)`可以实现为：

```
log_n(x) = log(x) / log(n) 
```

其中`log`是任何方便底的对数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-23T01:10:01.270

对于整数的 2 次幂，有一个巧妙的技巧，就是将最后一位一遍又一遍地向右复制。然后，你只需要增加你的数字，你就有了 2 的幂。

```
int NextPowerOf2(int n)
{
   n |= (n >> 16);
   n |= (n >> 8);
   n |= (n >> 4);
   n |= (n >> 2);
   n |= (n >> 1);
   ++n;
   return n;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T01:19:41.980

对于 2 和 >= 1 的幂，您可以看到可以右移多少次。每次这是您要带走的 2 的 1 次方。一旦你降到0，你就有了你的号码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T01:12:56.427

我认为我可能会解决这个问题，但使用对数基数 2 和对数基数 10。

(123) 的 log10 是 2.something。取它的底线，然后将 10 提高到那个功率，那应该会让你接近。

同样的事情应该适用于对数基数 2。

(9) 的 log2 是 3

你可能会玩对数的四舍五入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-23T03:37:40.863

> 您可能需要修改 round() 取决于您如何定义“最接近”。

@Greg Hewgill 的回答是正确的，只是对于您提供的示例来说它为时过早。例如，10^round(log_10(3.5)) == 10，而不是 1。我假设这就是他所说的“你如何定义“最接近””的意思。

可能是使用 Greg 公式的最简单方法，如果它太高（或对于 x < 1 而言太低），请使用下一个较低的 2 次幂：

```
closest = n ^ round(log_n(x))

if (closest > x) {
    other = closest / n
} else {
    other = closest * n
}

if (abs(other - x) < abs(closest - x)) {
    return other
} else {
    return closest
} 
```

# sql - 在SQL中，如果另一个表中没有对应的行，如何从一个表中删除一行？

> ID：264090
> 
> 赞同：5
> 
> 时间：2008-11-05T01:08:57.087
> 
> 标签：sql

我该怎么做：

DELETE FROM foo WHERE id=1 AND **bar 不包含 id==1**

详细地说，我怎样才能`id = 1`从表中删除一行`foo`，只有在表中没有一行的情况`bar`下`id = 1`。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-05T01:15:54.547

```
DELETE FROM foo WHERE id=1 AND NOT EXISTS (SELECT * FROM bar WHERE id=1) 
```

我假设你的意思是 foo 和 bar 是表，如果它在 bar 中不存在，你想从 foo 中删除一条记录。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-05T06:58:50.627

使用连接：

```
delete f
from   foo f
left
join   bar b on
       f.id = b.id 
where  f.id = 1 and
       b.id is null 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T03:26:24.033

使用 SQL“存在”命令。

[http://www.techonthenet.com/sql/exists.php](http://www.techonthenet.com/sql/exists.php)

# php - MySQL 数据建模

> ID：264119
> 
> 赞同：1
> 
> 时间：2008-11-05T01:26:06.693
> 
> 标签：php, mysql, database, data-modeling

我必须在 MySQL 数据库中表示的数据当前存在以下问题：

我必须支持具有不同数据的不同类型的产品，例如汽车、酒店房间、书籍等。对于我的应用程序，每个产品都有一些通用数据，如名称、描述、价格等。

所以我想有一个产品表，包含通用数据，汽车、hotel_rooms、书籍和任何以 1:1 关系引用此产品表的表。

问题是将产品表作为主表，所以我可以查询产品表并通过这些查询“自动”获取额外数据，这样我就可以使应用程序更“通用”。

关于如何实现这一点的任何想法？我有一些想法，但我不认为它们是最好的方法，当这个问题可能比我想象的更常见时，我不想去做肮脏的黑客攻击。

使用：PHP + Zend 框架 + MySQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-05T16:10:28.143

拥有一个基础对象，然后使用多态性对该基础对象进行子类化。基础对象存储所有共享数据（在 1 个表中）。然后每个子类都有其独特的属性，并将它们从单独的表键中获取到基表中。使子类能够从其父对象加载公共数据，以及加载其唯一/不同的数据。

# maven-2 - 如何将构建任务移动到父 POM

> ID：264120
> 
> 赞同：0
> 
> 时间：2008-11-05T01:27:08.347
> 
> 标签：maven-2

我的 ejb 项目有一个 POM。在其中，我添加了一个 maven-antrun-plugin 执行步骤来在验证阶段构建 websphere ejb 存根。这可行，但非常冗长，并且由于我需要向许多其他 ejb 项目添加类似的步骤，因此我想将公共部分移动到我们所有 ejb 的父 POM。

我的第一次尝试是将整个构建标记移动到父 POM，但这在父 POM 的安装/部署期间失败，因为验证步骤是针对父 POM 而不是仅针对子 POM 执行的。

我的第二次尝试涉及为阶段指定 ejb:verify。这部分成功，因为父 POM 是可部署的。但是，没有为子 POM 执行验证步骤。

我尝试了其他几种变体，包括指定 ejb 的阶段，ejb:ejb 并在插件定义中指定 true。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T16:33:08.423

如果您将配置放在父级的 pluginManagement 部分中，那么它将不会在那里运行。然后在孩子中你只需要绑定antrun插件，它就会继承执行配置并运行。这很好，因为您可以控制哪些子代继承这些值。

您可以在我在这里写的章节中看到示例：http: [//www.sonatype.com/book/reference/optimizing.html#d0e8621](http://www.sonatype.com/book/reference/optimizing.html#d0e8621)

# vim - % VIM 键盘命令

> ID：264123
> 
> 赞同：2
> 
> 时间：2008-11-05T01:28:16.270
> 
> 标签：vim

有没有办法让 vim 中的 % 找到下一个 ([{ 或其他什么，即使它不在同一行？

例子：

```
int main(int argc, char ** argv) {
     #Your cursor is somewhere in this comment, I want
     #it to get to the ( after printf
     printf("Hello there.\n");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T01:37:35.283

如果您想在后续行中查找左大括号，无需插件，只需进入正常模式并键入：

```
/{ [enter] 
```

其中 { 是您要查找的支架类型。

`n`然后，您可以使用和浏览它们`N`。

要映射`F12`键以打开和关闭搜索突出显示，请[使用此技巧。](http://ronny.haryan.to/archives/2005/03/03/tip-quick-no-highlight-search-matches-in-vim/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T01:46:04.033

如果我理解正确，您正试图让它甚至在下一行找到左大括号**。**如果你抱怨它没有找到右括号，除非整件事都是一行，我不知道为什么那行不通。

无论如何，如果你想让 % 拥有超能力，[matchit 插件](http://www.vim.org/scripts/script.php?script_id=39)就是开始的地方。它包含在正常发行版中，因此您不必下载它。只需添加

```
:runtime macros/matchit.vim 
```

对于您的 .vimrc，并且 % 还将知道许多新技巧（如何在使用关键字的语言中匹配平衡的 XML 标记 if/then/end if 语句）等。它不会直接解决您的请求，因为 matchit使用与正常 % 相同的限制（它不是从光标处或之后开始的匹配，在同一行上）。但由于它可以使用正则表达式搜索作为匹配标记（而不仅仅是字符），因此应该可以将其配置为开放表达式为 . *\n。*{ 或一些符合该标准的东西，但在更下方的线上拿起一个大括号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T01:37:31.010

这令人费解......对我来说， % 找到任何 {[( 匹配关闭，无论匹配有多少行。我在我的 .vimrc 中看不到任何会改变这种行为的东西，顺便说一句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T00:13:34.063

看起来 Jim Burger 有它，但以防万一你真的问如何搜索这些东西：

/[{[（] [进入]

这将找到任何这些符号中的下一个。

顺便说一句：在这种情况下，vim 足够聪明，可以弄清楚你想要什么，但你经常不得不用 '\' 转义方括号或圆括号。例如，要搜索下一个右括号，您可以输入（注意 \]）：

/[\]}）] [进入]

# bcel - bcel 中的静态初始化器

> ID：264126
> 
> 赞同：1
> 
> 时间：2008-11-05T01:29:06.517
> 
> 标签：bcel

在 BCEL 中，我想在类的静态初始化程序中初始化静态字段。但是，我还没有找到这样做的方法……有什么提示吗？

我需要类似的东西：

```
// Field descriptor #8 [I
private static int[] a;

static {};
     0  bipush 10
     2  multianewarray int[] [9]
     6  putstatic Output.a : int[] [11]
     9  return 
```

然而，我似乎只能生成（使用`MethodGen`）类似的东西：

```
public static void {}();
   0  bipush 10
   2  multianewarray int[] [9]
   6  putstatic Output.a : int[] [11]
   9  return 
```

这当然不一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T01:34:29.033

我自己才发现的。

```
 MethodGen method = new MethodGen(Constants.ACC_STATIC,
            Type.VOID,
            new Type[] { }, new String[] { }, "<clinit>",
            cg.getClassName(), il, cg.getConstantPool()); 
```

clinit 似乎是类初始化程序...

# c# - 如何从它打开的winform调用主程序'？

> ID：264127
> 
> 赞同：2
> 
> 时间：2008-11-05T01:30:16.407
> 
> 标签：c#, winforms

我有一个程序，当它启动时，会打开一个 winform（它是 Application.Run(new ...) 中指定的那个。从这个表单我打开另一个表单：

```
OtherForm newForm=new OtherForm();
newForm.Show(); 
```

我如何从新的 winform 与打开它的表单进行通信？这样我就可以在其中添加一些项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T01:35:37.987

最简单的方法是覆盖构造函数，例如`OtherForm newForm=new OtherForm(string title, int data);`. 这也适用于引用类型（这将是一种将数据发回的简单方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T01:49:32.403

在另一个窗体的构造函数中，添加对主窗体的引用。然后在您需要访问的主窗体上公开/内部任何内容。

```
Form m_mainForm;
public OtherForm(Form mainForm)
{
    m_mainForm = mainForm;
} 
```

编辑：

作为对您的第二篇文章的回应 - 您还可以考虑公开创建项目所需的必要值。例如，如果您需要名字和姓氏来创建新的“人”项，您可以在对话框中将它们作为属性公开。这将有助于将其断开一点并使其更具通用性。

当然，您的解决方案也很有效，只有您知道什么在您的设计中最有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T01:57:18.177

我想我在这里找到了答案： [http ://www.c-sharpcorner.com/UploadFile/mosessaur/winformsdelegates09042006094826AM/winformsdelegates.aspx](http://www.c-sharpcorner.com/UploadFile/mosessaur/winformsdelegates09042006094826AM/winformsdelegates.aspx)

我必须使用代表。在第二种形式中，我定义：

```
public delegate void AddItemDelegate(string item);
public AddItemDelegate AddItemCallback; 
```

从打开它的表格中，我写道：

```
private void btnScenario2_Click(object sender, EventArgs e)
{

    FrmDialog dlg = new FrmDialog();
    //Subscribe this form for callback
    dlg.AddItemCallback = new AddItemDelegate(this.AddItemCallbackFn);
    dlg.ShowDialog();

}
private void AddItemCallbackFn(string item)
{

    lstBx.Items.Add(item);

} 
```

# python - 通过 XML-RPC 使用 Python 访问 Ruby 对象？

> ID：264128
> 
> 赞同：3
> 
> 时间：2008-11-05T01:33:50.127
> 
> 标签：python, ruby, xml-rpc, interop

我正在尝试通过 XML-RPC 导出 Ruby 框架。但是，当尝试从没有直接作为处理程序添加到 XML-RPC 服务器的类中调用方法时，我遇到了一些问题。请看下面我的例子：

我有一个测试 Ruby XML-RPC 服务器，如下所示：

```
require "xmlrpc/server"

class ExampleBar
  def bar()
    return "hello world!"
  end
end

class ExampleFoo
  def foo()
    return ExampleBar.new
  end

  def test()
    return "test!"
  end
end

s = XMLRPC::Server.new( 9090 )

s.add_introspection

s.add_handler( "example", ExampleFoo.new )

s.serve 
```

我有一个测试 Python XML-RPC 客户端，如下所示：

```
import xmlrpclib

s = xmlrpclib.Server( "http://127.0.0.1:9090/" )

print s.example.foo().bar() 
```

我希望python客户端打印“hello world！” 因为它相当于以下 ruby​​ 代码：

```
example = ExampleFoo.new
puts example.foo().bar() 
```

但是它会生成一个错误：“xmlrpclib.ProtocolError: <ProtocolError for 127.0.0.1:9090/: 500 Internal Server Error>”。

print s.example.test() 工作正常。

我不希望新的 ExampleBar 对象通过网络，但我希望它被“缓存”在服务器端，并且随后对 bar() 的调用得到尊重。

XML-RPC 可以支持这种用法还是太基础了？

所以我想我的问题真的是；如果不使用 XML-RPC，我怎样才能使它工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T02:03:03.033

您的客户端（在您的 Python 代码中）是一个 ServerProxy 对象。它只接受布尔、整数、浮点数、数组、结构、日期或二进制数据类型的返回值。

但是，如果不进行接线，它就无法返回另一个 ServerProxy，而您需要它来访问另一个类。您可能可以在 Ruby 端实现对象缓存，但这将涉及跟踪活动会话并决定何时删除对象、如何处理丢失的对象等。

相反，我建议在 ruby​​ 端公开一个薄包装器，该包装器执行原子操作，例如：

```
def foobar()
  return ExampleFoo.new().foo().bar()
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T08:07:33.467

XML-RPC 不能传递对象。参数类型的集合是有限的（正如 jakber 所说）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-10T21:38:59.830

在支持的数据结构中返回 nil 也会导致内部服务器错误消息。stdlib ruby​​ xmlrpc 服务器似乎不支持允许 nils 的 xmlrpc 扩展，即使 python 端支持。xmlrpc4r 支持 nils 但我还没有尝试过。

# iphone - 如何发出 HTTP 发布请求以获取 JSON 对象以响应 iPhone 应用程序？

> ID：264140
> 
> 赞同：11
> 
> 时间：2008-11-05T01:41:30.987
> 
> 标签：iphone, json, cocoa-touch, nsurlrequest

我有一个在服务器上运行的 Web 服务，它以 XML 格式或 JSON 格式返回数据。我想请求 JSON 格式，但使用 HTTP Post 方法。

非常感谢任何帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-05T07:25:29.573

这是适用于 JSON 发布请求的代码，TouchJSON 框架用于解析 JSON，感谢“schwa”。

```
NSArray *keys = [NSArray arrayWithObjects:@"username", @"password", @"preference", @"uid", nil];
NSArray *objects = [NSArray arrayWithObjects:@"accuser", @"accpass", @"abc_region", @"100", nil];
NSDictionary *theRequestDictionary = [NSDictionary dictionaryWithObjects:objects forKeys:keys];

NSURL *theURL = [NSURL URLWithString:@"http://url.com/request.php"];
NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:theURL cachePolicy:NSURLRequestReloadIgnoringCacheData timeoutInterval:10.0f];
[theRequest setHTTPMethod:@"POST"];

[theRequest setValue:@"application/json-rpc" forHTTPHeaderField:@"Content-Type"];
NSString *theBodyString = [[CJSONSerializer serializer] serializeDictionary:theRequestDictionary];
NSLog(@"%@", theBodyString);
NSData *theBodyData = [theBodyString dataUsingEncoding:NSUTF8StringEncoding];
// NSLog(@"%@", theBodyData);
[theRequest setHTTPBody:theBodyData];

NSURLResponse *theResponse = NULL;
NSError *theError = NULL;
NSData *theResponseData = [NSURLConnection sendSynchronousRequest:theRequest returningResponse:&theResponse error:&theError];
NSString *theResponseString = [[[NSString alloc] initWithData:theResponseData encoding:NSUTF8StringEncoding] autorelease];
NSLog(theResponseString);
NSDictionary *theResponseDictionary = [[CJSONDeserializer deserializer] deserialize:theResponseString];
NSLog(@"%@", theResponseDictionary);
NSString *theGreeting = [theResponseDictionary objectForKey:@"greeting"];
[self setValue:theGreeting forKey:@"greeting"]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T04:25:43.103

不太确定你的问题到底是什么。但是谷歌“TouchJSON”应该可以帮助你入门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T05:00:22.410

很抱歉出现错误和内存泄漏，但是像这样的东西怎么样：

```
CFURLRef url = CFURLCreateWithString(NULL, CFSTR("http://example.com/post"), NULL);
CFHTTPMessageRef msg = CFHTTPMessageCreateRequest(
    NULL,
    CFSTR("POST"),
    url,
    kCFHTTPVersion1_1);

const char *body = "key=value&id=30293";
CFDataRef bodyData = CFDataCreate(NULL, body, strlen(body));
CFHTTPMessageSetBody(msg, bodyData);

CFReadStreamRef myReadStream = CFReadStreamCreateForHTTPRequest(NULL, myRequest);
CFReadStreamOpen(myReadStream);
CFHTTPMessageRef myResponse = CFReadStreamCopyProperty(
    myReadStream,
    kCFStreamPropertyHTTPResponseHeader);

//
// Handle myResponse
//

CFReadStreamClose(myReadStream);
CFRelease(myReadStream);
CFRelease(bodyData);
CFRelease(msg);
CFRelease(url); 
```

# wix - 关于制作下载器应用程序的任何指示？最好是 Wix/MSI？

> ID：264144
> 
> 赞同：4
> 
> 时间：2008-11-05T01:43:05.443
> 
> 标签：wix, windows-installer, download, installation

我们有一个希望我们的用户下载的应用程序。目前，他们单击链接并下载 EXE。我们想做的是有一个启动板/下载器应用程序，该应用程序体积小且下载速度快，然后可以下载并安装主应用程序。

在理想情况下，下载器将是一个 MSI（因此我们可以修改一些 MSI 数据库）。

我是一个 seriosu MSi 新手，所以我对从哪里开始寻找没有真正的想法。任何帮助或指示将不胜感激！

谢谢

安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T05:32:49.927

您需要编写一个引导程序 EXE，[Windows Installer SDK](http://msdn.microsoft.com/en-us/library/aa372866.aspx)中有一些文档，或者如果您想采取惰性路线，看起来[MSI Factory](http://www.indigorose.com/msi-factory/features.php)包括 WiX 兼容性和可自定义的引导程序 EXE，包括 HTTP 下载选项。

或者，如果您坚持开源，请查看 WiX 中的 ClickThrough。WiX 网站上似乎没有太多信息，所以我猜它是 WiX 3 的一部分。但描述听起来与您需要的相似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T18:42:31.323

试试[http://dotnetinstaller.codeplex.com](http://dotnetinstaller.codeplex.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T15:33:30.980

我不建议您编写自己的 exe，我建议您使用您已经拥有的东西，即 Visual Studio 附带 的[Generic Boostrapper 。](http://msdn.microsoft.com/en-us/magazine/cc163899.aspx)

这将创建您的 msi 的任务分开。创建 boostrapper 是一件更简单的事情。如果您在 Visual Studio 中创建 msi，则有一个 UI 可以执行此操作。否则，您可以创建一个 msbuild 任务来自己完成。

# python - 如何获取超过1000？

> ID：264154
> 
> 赞同：51
> 
> 时间：2008-11-05T01:56:20.550
> 
> 标签：python, google-app-engine, google-cloud-datastore

如何从数据存储中获取超过 1000 条记录并将所有记录放在一个列表中以传递给 django？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2010-08-22T21:38:31.533

从版本 1.3.6（2010 年 8 月 17 日发布）开始，您**可以**

[从变更日志：](http://code.google.com/p/googleappengine/wiki/SdkReleaseNotes#Version_1.3.6_-_August_17,_2010)

> 数据存储区 count() 查询的结果**和所有数据存储区查询的偏移量不再上限为 1000**。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2010-02-21T10:08:56.143

仅作记录 - 1000 个条目的获取限制现在已经消失：

[http://googleappengine.blogspot.com/2010/02/app-engine-sdk-131-include-major.html](http://googleappengine.blogspot.com/2010/02/app-engine-sdk-131-including-major.html)

引述：

> 不再有 1000 个结果限制 - 没错：随着游标的添加以及过去几个月中许多较小的数据存储稳定性和性能改进达到顶峰，我们现在有足够的信心完全取消最大结果限制。无论您是进行获取、迭代还是使用游标，结果的数量都没有限制。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-06T14:59:46.067

App Engine 为您提供了一种通过对 Key 进行排序并使用最后一个键作为下一个偏移量来将结果“分页”1000 的好方法。他们甚至在这里提供了一些示例代码：

[http://code.google.com/appengine/docs/python/datastore/queriesandindexes.html#Queries_on_Keys](http://code.google.com/appengine/docs/python/datastore/queriesandindexes.html#Queries_on_Keys)

尽管他们的示例将查询分散到许多请求中，但您可以将页面大小从 20 更改为 1000，并在循环中查询，组合查询集。此外，您可以使用 itertools 链接查询，而无需在需要之前对其进行评估。

例如，要计算超过 1000 行的行数：

```
class MyModel(db.Expando):
    @classmethod
    def count_all(cls):
        """
        Count *all* of the rows (without maxing out at 1000)
        """
        count = 0
        query = cls.all().order('__key__')

        while count % 1000 == 0:
            current_count = query.count()
            if current_count == 0:
                break

            count += current_count

            if current_count == 1000:
                last_key = query.fetch(1, 999)[0].key()
                query = query.filter('__key__ > ', last_key)

        return count 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-11-05T04:21:46.513

每次遇到这个限制时，我总是想知道“*为什么*需要超过 1,000 个结果？” 您知道 Google 本身提供的结果不超过 1,000 个吗？试试这个搜索： [http](http://www.google.ca/search?hl=en&client=firefox-a&rls=org.mozilla:en-US:official&hs=qhu&q=1000+results&start=1000&sa=N) ://www.google.ca/search?hl=en&client=firefox-a&rls=org.mozilla:en-US:official&hs=qhu&q=1000+results&start=1000&sa= N 直到我才知道最近，因为我从来没有花时间点击查询的第 100 页搜索结果。

如果您实际上将 1,000 多个结果返回给用户，那么我认为手头的问题比数据存储不允许您这样做的事实更大。

需要这么多结果的一个可能（合法）原因是，如果您正在对数据进行大型操作并提供摘要（例如，所有这些数据的平均值是多少）。这个问题的解决方案（在 Google I/O talk 中讨论过）是动态计算汇总数据，当它进入时，并保存它。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-11-05T02:07:43.820

**你不能。**

部分常见问题解答指出，您无法访问超出查询的第 1000 行，增加“OFFSET”只会导致更短的结果集，

即：OFFSET 999 --> 1 结果回来了。

来自维基百科：

> App Engine 将从实体返回的最大行数限制为每次 Datastore 调用 1000 行。大多数 Web 数据库应用程序使用分页和缓存，因此一次不需要这么多数据，因此在大多数情况下这不是问题。[需要引用] 如果应用程序每次操作需要超过 1,000 条记录，它可以使用它的拥有客户端软件或 Ajax 页面以对无限数量的行执行操作。

来自[http://code.google.com/appengine/docs/whatisgoogleappengine.html](http://code.google.com/appengine/docs/whatisgoogleappengine.html)

> 服务限制的另一个示例是查询返回的结果数。一个查询最多可以返回 1,000 个结果。将返回更多结果的查询仅返回最大值。在这种情况下，执行此类查询的请求不太可能在超时之前返回请求，但存在限制以节省数据存储上的资源。

来自[http://code.google.com/appengine/docs/datastore/gqlreference.html](http://code.google.com/appengine/docs/datastore/gqlreference.html)

> 注意：LIMIT 子句的最大值为 1000。如果指定的限制大于最大值，则使用最大值。同样的最大值适用于 GqlQuery 类的 fetch() 方法。
> 
> 注意：与 fetch() 方法的 offset 参数一样，GQL 查询字符串中的 OFFSET 不会减少从数据存储中提取的实体数量。它只影响 fetch() 方法返回的结果。具有偏移量的查询具有与偏移量大小线性对应的性能特征。

来自[http://code.google.com/appengine/docs/datastore/queryclass.html](http://code.google.com/appengine/docs/datastore/queryclass.html)

> limit 和 offset 参数控制从数据存储中获取多少结果，以及 fetch() 方法返回多少：
> 
> *   数据存储将偏移量 + 限制结果提取到应用程序。数据存储本身**不会**跳过第一个偏移量结果。
>     
>     
> *   fetch() 方法跳过第一个偏移结果，然后返回其余的（限制结果）。
>     
>     
> *   该查询具有与偏移量加上限制线性对应的性能特征。

## 这意味着什么

如果您有一个单数查询，则无法请求 0-1000 范围之外的任何内容。

增加偏移量只会增加 0，所以

```
LIMIT 1000  OFFSET 0 
```

将返回 1000 行，

和

```
LIMIT 1000 OFFSET 1000 
```

将返回**0 行**，因此，无法使用单个查询语法手动或使用 API 获取 2000 个结果。

## 唯一合理的例外

就是在表上创建一个数字索引，即：

```
 SELECT * FROM Foo  WHERE ID > 0 AND ID < 1000 

 SELECT * FROM Foo WHERE ID >= 1000 AND ID < 2000 
```

如果您的数据或查询不能有这个“ID”硬编码标识符，那么您就不**走运了**

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-02-04T23:58:37.523

此 1K 限制问题已解决。

```
query = MyModel.all()
for doc in query:
    print doc.title 
```

通过将 Query 对象视为可迭代对象：迭代器以小批量从数据存储中检索结果，允许应用程序停止对结果进行迭代以避免获取超出需要的数据。当检索到与查询匹配的所有结果时，迭代停止。与 fetch() 一样，迭代器接口不缓存结果，因此从 Query 对象创建新的迭代器将重新执行查询。

最大批量大小为 1K。而且您仍然拥有自动数据存储配额。

但是在 1.3.1 SDK 计划中，他们引入了可以序列化和保存的游标，以便将来的调用可以从上次停止的地方开始查询。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-05T02:17:22.737

1000 条记录限制是 Google AppEngine 中的硬限制。

此演示文稿[http://sites.google.com/site/io/building-scalable-web-applications-with-google-app-engine](http://sites.google.com/site/io/building-scalable-web-applications-with-google-app-engine)解释了如何使用 AppEngine 有效地对数据进行分页。

（基本上通过使用数字 id 作为键并在 id 上指定 WHERE 子句。）

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-07-01T15:44:55.437

当超过 1000 条记录时，通过远程 api 获取仍然存在问题。我们编写了这个小函数来逐块迭代表：

```
def _iterate_table(table, chunk_size = 200):
    offset = 0
    while True:
        results = table.all().order('__key__').fetch(chunk_size+1, offset = offset)
        if not results:
            break
        for result in results[:chunk_size]:
            yield result
        if len(results) < chunk_size+1:
            break
        offset += chunk_size 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-09-10T00:58:32.703

我们在`ModelBase`课堂上使用的东西是：

```
@classmethod
def get_all(cls):
  q = cls.all()
  holder = q.fetch(1000)
  result = holder
  while len(holder) == 1000:
    holder = q.with_cursor(q.cursor()).fetch(1000)
    result += holder
  return result 
```

这样就无需考虑每个模型的 1000 个查询限制。我想密钥版本同样容易实现。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-09-25T12:29:42.067

```
class Count(object):
def getCount(self,cls):
    class Count(object):
def getCount(self,cls):
    """
    Count *all* of the rows (without maxing out at 1000)
    """
    count = 0
    query = cls.all().order('__key__')

    while 1:
        current_count = query.count()
        count += current_count
        if current_count == 0:
            break

        last_key = query.fetch(1, current_count-1)[0].key()
        query = query.filter('__key__ > ', last_key)

    return count 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-08-10T20:21:05.830

```
entities = []
for entity in Entity.all():
    entities.append(entity) 
```

就那么简单。请注意，每个实体都有一个 RPC，它比以块的形式获取要慢得多。因此，如果您担心性能，请执行以下操作：

如果您的商品少于 100 万件：

```
entities = Entity.all().fetch(999999) 
```

否则，使用游标。

还应该注意的是：

```
Entity.all().fetch(Entity.all().count()) 
```

返回最大值 1000，不应使用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-08-27T01:45:38.453

JJG：您上面的解决方案很棒，除了如果您有 0 条记录，它会导致无限循环。（我在本地测试我的一些报告时发现了这一点）。

我修改了 while 循环的开始，如下所示：

```
while count % 1000 == 0:
    current_count = query.count()
    if current_count == 0:
        break 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-05T02:33:05.547

要将两个查询的内容加在一起：

```
list1 = first query
list2 = second query
list1 += list2 
```

列表 1 现在包含所有 2000 个结果。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-16T08:04:30.073

建议的解决方案仅在条目按键排序时才有效...如果您首先按另一列排序，您仍然必须使用 limit(offset, count) 子句，那么 1000 个条目的限制仍然适用。如果您使用两个请求也是一样的：一个用于检索索引（带有条件和排序），另一个使用 where index in () 和来自第一个结果的索引子集，因为第一个请求不能返回超过 1000 个键？（Google *Queries on Keys*部分没有明确说明我们是否必须*按键*排序以消除 1000 个结果的限制）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-03-16T03:07:51.983

这接近 Gabriel 提供的解决方案，但不获取它只是计算它们的结果：

```
count = 0
q = YourEntityClass.all().filter('myval = ', 2)
countBatch = q.count()
while countBatch > 0:
    count += countBatch
    countBatch = q.with_cursor(q.cursor()).count()

logging.info('Count=%d' % count) 
```

非常适合我的查询，而且速度也很快（1.1 秒计算 67,000 个实体）

请注意，查询不能是不等式过滤器或集合，否则游标将不起作用，您将收到此异常：

> AssertionError：没有可用于 MultiQuery 的游标（使用“IN”或“！=”运算符的查询）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-02-08T11:40:54.757

如果您使用 NDB：

```
@staticmethod
def _iterate_table(table, chunk_size=200):
    offset = 0
    while True:
        results = table.query().order(table.key).fetch(chunk_size + 1, offset=offset)
        if not results:
            break
        for result in results[:chunk_size]:
            yield result
        if len(results) < chunk_size + 1:
            break
        offset += chunk_size 
```

# c# - WPF Dispatcher.Invoke 'hanging'

> ID：264163
> 
> 赞同：22
> 
> 时间：2008-11-05T02:01:54.347
> 
> 标签：c#, .net, wpf, invoke, dispatcher

我有一个有点复杂的 WPF 应用程序，当尝试使用调度程序调用 UI 线程上的调用时，它似乎“挂起”或陷入等待调用。

一般流程是：

1.  处理按钮上的点击事件
2.  创建一个新线程（STA）：创建演示者和 UI 的新实例，然后调用方法**Disconnect**
3.  然后断开连接在 UI 上设置一个名为**Name的属性**
4.  然后 Name 的设置器使用以下代码设置属性：

```
 if(this.Dispatcher.Thread != Thread.CurrentThread)
    {
        this.Dispatcher.Invoke(DispatcherPriority.Normal, (ThreadStart)delegate{
            this.Name = value; // Call same setter, but on the UI thread
        });
        return;
    }

    SetValue(nameProperty, value); // I have also tried a member variable and setting the textbox.text property directly. 
```

我的问题是，当调用调度程序**调用**方法时，它似乎每次都挂起，并且调用堆栈表明它处于睡眠状态，等待或加入 Invoke 实现。

那么，是否有什么我做错了，我错过了，明显与否，或者是否有更好的方法来调用 UI 线程来设置这个属性（和其他属性）？

**编辑：**解决方案是在线程委托结束时调用 System.Windows.Threading.Dispatcher.Run() （例如，正在执行工作的位置） - 感谢所有帮助的人。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-05T06:01:49.290

Invoke 是同步的——你需要 Dispatcher.BeginInvoke。另外，我相信您的代码示例应该将“SetValue”移动到“else”语句中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-28T17:32:25.390

我认为用代码更好地显示这一点。考虑这种情况：

线程 A 这样做：

```
lock (someObject)
{
   // Do one thing.
   someDispatcher.Invoke(() =>
   {
      // Do something else.
   }
} 
```

线程 B 这样做：

```
someDispatcher.Invoke(() =>
{
   lock (someObject)
   {
      // Do something.
   }
} 
```

乍一看，一切似乎都很好，花花公子，但事实并非如此。这会产生死锁。调度程序就像线程的队列，在处理此类死锁时，以这样的方式思考它们很重要：“以前的调度可能会阻塞我的队列吗？”。线程 A 将进入......并在锁下调度。但是，如果线程 B 在线程 A 在代码中标记为“做一件事”的时间点出现怎么办？好...

*   线程 A 锁定了 someObject 并且正在运行一些代码。
*   线程 B 现在调度，调度器将尝试获取 someObject 上的锁，因为线程 A 已经拥有该锁，所以阻塞了你的调度器。
*   然后线程 A 将排队另一个调度项。这个项目永远不会被解雇，因为你的调度员永远不会完成你之前的请求；它已经卡住了。

你现在有一个漂亮的僵局。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-10T16:54:58.300

你说你正在创建一个新的 STA 线程，这个新线程上的调度程序是否正在运行？

我从“this.Dispatcher.Thread != Thread.CurrentThread”中得知您希望它是一个不同的调度程序。确保它正在运行，否则它不会处理它的队列。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-08T16:23:54.450

我想你的意思是如果 (!this.Dispatcher.CheckAccess())

我也对 Invoke 感到困惑，或者如果我可以 BeginInvoke，我的代表没有被调用 - 似乎在做所有事情：-(

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T06:33:09.117

这听起来像是一个僵局。如果调用 .Invoke 的线程已经持有 UI 线程完成其工作所需的锁 / 互斥锁 / 等，这通常会发生。最简单的方法是改用 BeginInvoke：这样，当前线程可以继续运行，并且（可能）很快就会释放锁 - 允许 UI 获取它。或者，如果您可以识别出有问题的锁，您可以故意释放它一段时间。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-07T04:19:12.360

我遇到了类似的问题，虽然我仍然不确定答案是什么，但我认为你的

```
 if(this.Dispatcher.Thread != Thread.CurrentThread)
{
    this.Dispatcher.Invoke(DispatcherPriority.Normal, (ThreadStart)delegate{
        this.Name = value; // Call same setter, but on the UI thread
    });
    return;
} 
```

应该替换为

```
 if(this.Dispatcher.CheckAccess())
{
    this.Dispatcher.Invoke(DispatcherPriority.Normal, (ThreadStart)delegate{
        this.Name = value; // Call same setter, but on the UI thread
    });
    return;
} 
```

CheckAccess 不会出现在 Intellisense 中，但它存在并且用于此目的。另外，我同意一般来说你想要 BeginInvoke 在这里，但是我发现当我执行这个异步时我没有得到 UI 更新。不幸的是，当我同步执行时，我会遇到死锁情况......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-10T09:15:53.367

我知道这是一个旧线程，但这是另一个解决方案。

我刚刚解决了一个类似的问题。我的调度员运行良好，所以...

我必须显示 DEBUG -> THREAD WINDOW 来识别在任何地方执行我的代码的所有线程。

通过检查每个线程，我很快就知道是哪个线程导致了死锁。

它是多个线程组合一个`lock (locker) { ... }`语句，并调用 Dispatcher.Invoke()。

就我而言，我可以只更改一个特定的`lock (locker) { ... }`语句，并将其替换为`Interlocked.Increment(ref lockCounter)`.

这解决了我的问题，因为避免了僵局。

```
void SynchronizedMethodExample() {

    /* synchronize access to this method */
    if (Interlocked.Increment(ref _lockCounter) != 1) { return; }

    try {
    ...
    }
    finally {
        _mandatoryCounter--;
    }
} 
```

# mysql - 将 MYSQL_ROW 类型转换为字符串

> ID：264172
> 
> 赞同：1
> 
> 时间：2008-11-05T02:07:44.100
> 
> 标签：mysql, string

我正在使用 MYSQL C API，并且我有一个 MYSQL_ROW 对象，我想将其转换为字符串。有谁知道如何做到这一点？我还没有在 API 的文档中找到任何东西。

string str = (string)row[0] <-- 运行时错误

PS我尝试将它转换为字符串，但它不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T02:50:47.553

两件事情：

1.  `string`不是 C 数据类型。您可能正在寻找`char *`.

2.  根据[MySQL API Documentation](http://dev.mysql.com/doc/refman/5.1/en/c-api-datatypes.html)， MYSQL_ROW 不是以空值结尾的字符串。您应该使用`mysql_fetch_lengths()`将所需字段复制到新字符串。

# entity-framework - 实体框架和 LINQ To SQL - 利益冲突？

> ID：264175
> 
> 赞同：13
> 
> 时间：2008-11-05T02:10:28.790
> 
> 标签：entity-framework, linq, linq-to-sql, linq-to-entities, entity-sql

过去一周，我一直在博客圈上看到 Linq to SQL 已死 [EF 和 Linq to Entities 万岁]。但是当我阅读 MSDN 上的概述时，在我看来 Linq to Entities 生成 eSQL 就像 Linq to SQL 生成 SQL 查询一样。

现在，由于底层实现（并且由于 SQL Server 还不是 ODBMS）仍然是关系存储，在某些时候实体框架必须将转换为 SQL 查询。为什么不修复 Linq to SQL 问题（m:m 关系，仅支持 SQL 服务器等）并使用 Linq to SQL in 作为生成这些查询的层？

这是因为性能还是 EF 使用不同的方式将 eSQL 语句转换为 SQL？

在我看来 - 至少对于我没有学识的头脑来说 - 很自然地适合在 EF 中将 Linq 转为 SQL。

评论？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-05T13:20:55.440

值得注意的是，Entity Framework（至少）有三种消费方式：

*   LINQ to Entity over Object Services over Entity Client
*   实体 SQL 之上的对象服务之上的实体客户端
*   使用实体客户端命令对象的实体 SQL（最类似于经典 ADO.NET）

实体客户端最终会输出 ESQL 命令的表示（以规范的、与数据库无关的形式），特定 RDBMS 的 ADO.NET 提供程序负责将其转换为存储特定的 SQL。恕我直言，这是正确的模型，因为多年来已经投入（并将继续投入）为每个商店制作出色的 ADO.NET 提供程序。

由于 Entity Framework 需要与许多商店一起工作，因此需要与许多 ADO.NET 提供程序一起工作，因此他们无法轻松优化实体客户端在每个商店的基础上生成的内容（至少 - 这就是我们使用 v1 的地方）。LINQ to SQL 团队要解决的问题要小得多——“仅适用于 SQL Server”，因此可以更轻松地存储特定内容。我知道 EF 团队知道在某些情况下，EF 到 SQL Server 生成 TSQL 的效率低于 L2S，并且正在努力改进 V2 的这一点。

有趣的是，此模型允许在实体客户端和 ADO.NET 提供程序之间为商店添加新功能。这些“包装提供者”可以添加诸如日志记录、审计、安全、缓存等服务。[这在http://blogs.msdn.com/efdesign/archive/2008/07/09/transparent-caching-support-in-the-entity-framework.aspx](http://blogs.msdn.com/efdesign/archive/2008/07/09/transparent-caching-support-in-the-entity-framework.aspx)上作为 V2 功能进行了讨论

如果您从更大的角度来看，您会发现尝试以某种方式将 L2S TSQL 生成改进到实体框架的体系结构中将非常困难并且确实受到限制。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-30T06:56:09.493

实际上，EF 在翻译 LINQ 查询时不会生成 EntitySQL。在 EF 中，我们为所有查询提供了基于数据结构的表示，称为 CQT 或规范查询树。LINQ 翻译器和 EntitySQL 解析器都产生 CQT，查询翻译管道的其余部分使用 CQT（和其他内部中间形式），经过各种转换后，它到达 ADO.NET 提供程序（作为存储级 CQT），然后负责将其翻译成后端的 SQL 方言。所以路径是 LINQ -> CQT -> SQL 或 EntitySQL -> CQT -> SQL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-18T19:36:02.027

Linq to SQL 和 Entity Framework 之间的一个很大区别是 EF 实现了实体数据模型规范 (EDM)，并且还有其他围绕 EDM 构建的产品，例如 ADO.NET Data Services（又名 Astoria）。

EDM 现在被用于在名为开放数据协议 (OData [http://odata.org/](http://odata.org/) ) 的新规范中扩展 AtomPub，该规范用于在 REST 之上标准化 CRUD。

# java - 我应该创建一个新的石英作业和触发器还是一个作业和多个触发器？

> ID：264191
> 
> 赞同：5
> 
> 时间：2008-11-05T02:26:08.947
> 
> 标签：java, scheduling, quartz-scheduler

我正在寻找使用石英来安排电子邮件，但我不确定采用哪种方法：

1.  创建新作业并在安排电子邮件时触发或
2.  创建一个作业，并在每次安排电子邮件时创建一个新触发器

无论哪种方式，我都需要传递消息/收件人等，而且我不确定创建大量作业是否会开始增加相当大的内存开销，因为很可能会安排数千封电子邮件。

**更新**：这些电子邮件将由用户而不是我安排 - 所以我将在运行时以编程方式添加这些电子邮件，它们不会在任何特定时间发出。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T16:46:56.023

Quartz 旨在处理数以万计的触发器。这里对可扩展性的主要限制是 JobStore 中的可用空间。一个有合理数据库支持的 JDBCJobStore 应该能够处理数十万个触发器。

如果可以通过触发器的作业数据映射对单个作业进行参数化，则为每封电子邮件创建一个作业和一个触发器。Quartz 定期轮询作业存储以查找准备触发的触发器。Quartz 旨在安全地处理来自该查询的任意大的结果集。

重要的是——这实际上与 Quartz 本身无关——是你有必要的带宽来执行峰值负载。如果用户倾向于将邮件安排成群，您需要确保您有足够的计算资源来发送电子邮件。这将包括网络带宽、处理和配置为利用可用资源的足够工作线程。

请注意，如果 Quartz 在执行作业时确实落后太多，您可以配置 Quartz 应该对触发器做什么。您可以继续尝试，跳过触发器等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T03:14:42.297

触发器是否基于时间表？您可以使用[CronTrigger](http://www.opensymphony.com/quartz/wikidocs/CronTriggers%20Tutorial.html)来设置更复杂的基于时间的计划，而不是单独的触发器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T02:45:39.357

您可能会考虑对一组电子邮件进行排队或以其他方式分组，并拥有一个或几个定期（或计划的）作业，然后处理“批处理”。

您甚至可以让 Quartz 作业将电子邮件排队，以供一组工作人员使用和发送。

我不会推荐数千个 Quartz 作业/触发器——这不是该工具的预期用途（恕我直言）。

* * *

编辑：回应以下评论：

当用作在同一 JVM 中执行应用程序的框架的一部分时，我不建议使用数千个 Quartz 作业/触发器，这些作业/触发器将与应用程序的其余部分竞争资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-18T19:57:07.500

我会推荐一份工作和一个触发器。将电子邮件请求放入数据库表中，并让石英作业查找要发送的新电子邮件。

# .net - 如何控制触发事件处理程序的顺序？

> ID：264196
> 
> 赞同：20
> 
> 时间：2008-11-05T02:28:08.410
> 
> 标签：.net, events

事件处理程序是否按照它们附加到事件的顺序触发？如果不是，我可以对事件处理程序强制执行某种顺序，以便按特定顺序调用它们吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-05T06:33:46.403

假设事件的简单实现（在委托字段上使用 += 和 -= ，这反过来将使用`Delegate.Combine/Remove`）然后是的，事件处理程序将按照它们被订阅的顺序被调用。文档中有效地提供了保证[`Delegate.Combine`](http://msdn.microsoft.com/en-us/library/aa326800.aspx)：

> **返回值**
> 
> 一个新的多播（可组合）委托，其调用列表按该顺序连接*a* 和*b的调用列表。*

请参阅我[关于事件的文章，了解](http://pobox.com/~skeet/csharp/events.html)其中的一些示例`Delegate.Combine/Remove`（以及幕后的事件）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-17T17:40:01.343

*不要**依赖**事件排序*。所有事件分派在逻辑上应该是独立的，就好像它们是并行发生的一样。

在其他类和线程中添加事件处理程序可能会扰乱您假设的顺序，这不是一个安全的假设，它违背了事件作为独立解耦动作的概念。

我会更进一步，并断言如果您必须承担事件触发的顺序，那么您有一个严重的设计缺陷和/或滥用事件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T02:31:15.910

您可能有一个事件处理程序，它以指定的顺序调用其他函数或委托。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T03:46:37.347

我会建议“包装它”。

做这样的事情...

```
MyObject.MyEvent += new MyEventHandler(Wrapper);

public void Wrapper()
{
    Method1();
    Method3();
    Method2();
} 
```

这样，您仍然可以挂钩事件，但可以完全控制所调用的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-08T13:56:00.140

这么晚才回复很抱歉。

* * *

我遇到了一种情况，我必须处理事件处理程序的顺序。

我有一个表单，当我单击表单上的一个按钮时，一个对象被添加到我代码中某处的集合中。

该集合有一个“已添加”事件，并且有两个委托已与它挂钩。其中一种方法删除刚刚添加到集合中的任何项目，而另一种方法向用户显示消息。

* * *

如果我在此处显示一些代码，则触发事件时将引发“IndexOutOfRange”异常：

```
// this methods hooks two delegates to MyCollection.Added event, but the order results in a "IndexOutOfRange" exception after the event is triggered
HookEvents()
{
   MyCollection.Added += new CollectionItemAddedHandler(DeleteItem_After_CollectionItemAdded);

   MyCollection.Added += new CollectionItemAddedHandler(ShowMessage_After_CollectionItemAdded);
}

// when user click a button on form, add a object to MyCollection
Button_Clicked()
{
   MyCollection.Add(new object());     
}

// at the moment a object is added into the collection, this method remove it
DeleteItem_After_CollectionItemAdded(NewIndexArgs e)
{
    MyCollection.Remove(e.NewIndex); // e.NewIndex represents the newly added item index in current collection  
}

// at the moment a object is added into the collection, this method show its information (hey, but remember, I just remove it in the previous method)
ShowMessage_After_CollectionItemAdded(NewIndexArgs e)
{
    MessageBox.Show(MyCollection[e.NewIndex]); // tell user what is just added into the current collection
    // a "IndexOutOfRange" exception is thrown here....
} 
```

* * *

使这种情况正常工作**的**是应该首先触发“ShowMessage_After_CollectionItemAdded”方法**，**然后是“DeleteItem_After_CollectionAdded”方法。

虽然我们可以先 += "ShowMessage..." 方法，但有时**我们无法预定义此序列，直到运行时**。

# jquery - $.getJSON 在 IE8 中返回缓存数据

> ID：264216
> 
> 赞同：102
> 
> 时间：2008-11-05T02:46:44.223
> 
> 标签：jquery, asp.net-mvc, internet-explorer-8, getjson

我现在正在玩 ASP.net MVC 和 JQuery。我遇到了似乎没有意义的行为。

我正在调用 JQuery 的`$.getJSON`函数来填充一些 div。事件在事件上触发`$(document).ready`。这完美地工作。

在填充 div 时，有一个小`AJAX.BeginForm`的添加了另一个要使用的值。它正确调用远程函数，并在成功后调用原始 javascript 函数来重新填充 div。

这是奇怪的部分：在 FireFox 和 Chrome 中 - 一切正常。但是在 IE8 (Beta) 中，第二次调用填充 Div 脚本（调用 $.getJSON 函数）获取缓存数据并且不询问服务器！

希望这个问题有意义：简而言之 - 为什么要`$.getJSON`获取缓存数据？为什么它只影响 IE8？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2008-12-11T00:16:41.853

这就是它对我的工作方式......

```
$.ajaxSetup({ cache: false });
$.getJSON("/MyQueryUrl",function(data,item) {
     // do stuff with callback data
     $.ajaxSetup({ cache: true });
   }); 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2008-11-05T09:09:40.613

只是让您知道，Firefox 和 Chrome 将所有 Ajax 请求视为不可缓存。IE（所有版本）将 Ajax 调用视为其他 Web 请求。这就是你看到这种行为的原因。
如何在每次请求时强制 IE 下载数据：

*   正如你所说，在 JQuery 中使用 'cache' 或 'nocache' 选项
*   向请求添加一个随机参数（丑陋，但有效:)）
*   在服务器端，设置可缓存性（例如使用属性，见下文）

代码：

```
public class NoCacheAttribute : ActionFilterAttribute
{
    public override void OnActionExecuted(ActionExecutedContext context)
    {
        context.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);
    }
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-05T04:35:40.400

感谢肯特的回答。使用 $.ajax('{ cache: no }'); 完美地工作。[编辑]

或者至少我认为我做到了。似乎 jquery $.getJSON 没有读取对 $.ajax 对象所做的任何更改。

最终工作的解决方案是手动添加一个新参数

```
var noCache = Date();
$.getJSON("/somepage/someaction", { "noCache": noCache }, Callback); 
```

日期分辨率仅为分钟；这实际上意味着该解决方案仍会缓存长达一分钟。这对我的目的来说是可以接受的。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-08-13T03:49:30.363

我通过在控制器中的操作上放置以下属性解决了同样的问题：

```
[OutputCache(Duration = 0, VaryByParam = "None")] 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-11T16:55:36.200

如果您使用的是 ASP.net MVC，请考虑添加一个扩展方法以轻松实现无缓存，如下所示：

```
 public static void NoCache(this HttpResponse Response)
    {
        Response.Cache.SetNoStore();
        Response.Cache.SetExpires(DateTime.MinValue);
        Response.Cache.SetCacheability(HttpCacheability.NoCache);
        Response.Cache.SetValidUntilExpires(false);

        Response.Expires = -1;
        Response.ExpiresAbsolute = DateTime.MinValue;
        Response.AddHeader("Cache-Control", "no-cache");
        Response.AddHeader("Pragma", "no-cache");
    } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-05T02:51:30.377

您可能需要发送缓存破坏程序。

我建议使用 $.ajax( { cache: no }) 以防万一（在获取请求中添加随机后缀）

（这些天我倾向于在任何地方使用 $.ajax，更可调整）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-05-29T07:44:31.710

准备好回答了吗？

[http://lestopher.tumblr.com/post/21742012438/if-youre-using-ie8-and-getjson](http://lestopher.tumblr.com/post/21742012438/if-youre-using-ie8-and-getjson)

所以，只需添加

```
jQuery.support.cors = true; 
```

在你的脚本的开头，BANG 它起作用了！

# c++ - 多个粗体菜单项

> ID：264217
> 
> 赞同：3
> 
> 时间：2008-11-05T02:47:29.183
> 
> 标签：c++, windows, menu, bold

我一直在研究以粗体显示菜单项所需的努力——无需自己绘制菜单——并在谷歌搜索后发现了 MFS_DEFAULT 菜单项状态。MSDN[文档](http://msdn.microsoft.com/en-us/library/ms647578(VS.85).aspx)提到

> **MFS_DEFAULT**
> 指定菜单项是默认的。一个菜单只能包含一个默认菜单项，它以粗体显示。

我进行了实验，*似乎*与文档相反，我似乎能够使用此标志以粗体显示多个（或可能全部！）菜单项。有没有人有这方面的经验，即如果有多个粗体菜单项有什么陷阱？达到我想要实现的目标确实有点像黑客攻击，而且我有点担心未知的副作用（即在一个菜单中有多个“默认”菜单项）。

编辑：我还应该补充一点，[这篇文章](http://wint.virtualplastic.net/showtweak.php?tweak_id=115)声称 MFS_DEFAULT 标志除了以粗体显示菜单项外什么都不做；尽管如此，我还是有点担心违背“官方”文件......

EDIT2：这样做的目的是告诉用户有问题的菜单项（即加粗的那个）也可以通过双击有问题的控件来调用（菜单项是上下文菜单的一部分）。当我想到这个问题时，我没有考虑到这样一个事实——通常——只有一个命令可以与双击事件相关联（d'oh！）。因此，我接受了 zaphod 的回答（它没有直接回答这个问题，但它确实解决了我的“问题”）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T03:16:41.307

你想达到什么目的？

我怀疑将 MFS_DEFAULT 用于其他目的的最大反对意见是你违反了微软试图公布的关于粗体菜单项的含义以及用户（或辅助屏幕阅读器之类的程序）应该在遇到一个时做出反应。

如果你想要做的只是让用户注意一些特别感兴趣的菜单项——嗯，这看起来有点奇怪，但它看起来也很无辜，如果它引起了你我会感到惊讶未来的巨大问题。当然，一切皆有可能！不过，我想知道你到底在做什么。

如果你试图通过加粗和不加粗的菜单项来暴露你的程序状态的一部分——这对我来说似乎有点出乎意料，但我不想在听到细节之前做出判断。

如果你有其他目标——比如你认为菜单的默认字体很丑，你更喜欢所有内容都加粗——那么你发现的方法可能是权宜之计，但也可能有更好的方法获得您想要的东西的方法，如果您愿意，我们可以更详细地讨论（也许在一个单独的问题中）。我怀疑是这种情况，但谁知道呢？

# svn - VIM 中的颜色边距

> ID：264219
> 
> 赞同：2
> 
> 时间：2008-11-05T02:47:42.460
> 
> 标签：svn, vim, colors, margins

有人知道我如何在 VIM 中获得 diff 的颜色边距（如果可能的话）？我的意思是这样的：（例如，在 NetBeans 中：[Netbeans color margins](http://www.picamatic.com/show/2008/11/05/05/39/1308705_147x152.png)）。在我使用 NetBeans 时非常有用，也许有人为 VIM 编写了这么有用的插件？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T04:39:13.967

这不是您正在寻找的内容，但是您可以在 vimdiff 中隐藏一个窗口，并且差异颜色将保持活动状态。使用 'vim -d file1 file2' 然后 :hide。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T20:21:54.173

AFAIK，这不是 Vim 本身支持的东西。有[diffchanges 插件](http://www.vim.org/scripts/script.php?script_id=2158)，它可能很有用。

# python - 从 Python 设置 gzip 时间戳

> ID：264224
> 
> 赞同：9
> 
> 时间：2008-11-05T02:50:59.987
> 
> 标签：python, gzip

我对使用 Python 的`gzip`模块压缩数据感兴趣。碰巧我希望压缩输出是确定性的，因为这对于一般事物来说通常是一个非常方便的属性——例如，如果某个非 gzip 感知进程正在寻找输出中的变化，或者如果输出将被加密签名。

不幸的是，每次的输出都不一样。据我所知，唯一的原因是 gzip 标头中的时间戳字段，Python 模块始终使用当前时间填充该字段。我认为实际上不允许您使用没有时间戳的 gzip 流，这太糟糕了。

无论如何，Python`gzip`模块的调用者似乎没有办法提供基础数据的正确修改时间。（实际`gzip`程序似乎尽可能使用输入文件的时间戳。）我想这是因为基本上唯一关心时间戳的是`gunzip`写入文件时的命令——现在，我，因为我想要确定性的输出。这是不是要求太过分了？

有没有其他人遇到过这个问题？

`gzip`对来自 Python 的任意时间戳的某些数据最不可怕的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T03:49:51.973

是的，你没有任何漂亮的选择。时间用 _write_gzip_header 中的这一行写入：

```
write32u(self.fileobj, long(time.time())) 
```

由于他们没有给你一种方法来覆盖时间，你可以做以下事情之一：

1.  从 GzipFile 派生一个类，并将`_write_gzip_header`函数复制到派生类中，但在这一行中具有不同的值。
2.  导入 gzip 模块后，将新代码分配给其时间成员。您实际上将在 gzip 代码中提供名称 time 的新定义，因此您可以更改 time.time() 的含义。
3.  复制整个 gzip 模块，并将其命名为 my_stable_gzip，然后更改您需要的行。
4.  将 CStringIO 对象作为 fileobj 传入，并在 gzip 完成后修改字节流。
5.  编写一个伪造的文件对象，跟踪写入的字节，并将所有内容传递到真实文件，时间戳的字节除外，您自己编写。

这是选项＃2（未经测试）的示例：

```
class FakeTime:
    def time(self):
        return 1225856967.109

import gzip
gzip.time = FakeTime()

# Now call gzip, it will think time doesn't change! 
```

选项 #5 可能是最干净的，因为它不依赖于 gzip 模块的内部（未经测试）：

```
class GzipTimeFixingFile:
    def __init__(self, realfile):
        self.realfile = realfile
        self.pos = 0

    def write(self, bytes):
        if self.pos == 4 and len(bytes) == 4:
            self.realfile.write("XYZY")  # Fake time goes here.
        else:
            self.realfile.write(bytes)
        self.pos += len(bytes) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-03-16T11:25:36.173

从 Python 2.7 开始，您可以在 gzip 标头中指定要使用的时间。NB 文件名也包含在标题中，也可以手动指定。

```
import gzip

content = b"Some content"
f = open("/tmp/f.gz", "wb")
gz = gzip.GzipFile(fileobj=f,mode="wb",filename="",mtime=0)
gz.write(content)
gz.close()
f.close() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T15:17:54.923

提交一个[补丁](http://www.python.org/dev/patches/)，其中排除了时间戳的计算。它几乎肯定会被接受。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T21:17:09.707

我接受了考文垂先生的建议并[提交了补丁](http://bugs.python.org/issue4272)。然而，鉴于 Python 发布计划的当前状态，3.0 即将到来，我不希望它很快出现在发布中。不过，我们会看看会发生什么！

同时，我喜欢 Batchelder 先生的选项 5，即通过正确设置时间戳字段的小型自定义过滤器管道 gzip 流。这听起来像是最干净的方法。正如他所演示的那样，所需的代码实际上非常小，尽管他的示例确实依赖于（当前有效的）假设`gzip`模块实现将选择使用恰好一个四字节调用来写入时间戳的简单性`write()`。尽管如此，如果需要，我认为提出一个完全通用的版本并不难。

猴子修补方法（又名选项 2）因其简单性而非常诱人，但让我停下来，因为我正在编写一个调用 的库`gzip`，而不仅仅是一个独立程序，而且在我看来，有人可能会尝试`gzip`从另一个线程调用在我的模块准备好将其更改为`gzip`模块的全局状态之前。如果其他线程试图进行类似的猴子修补特技，这将是特别不幸的！我承认这个潜在的问题听起来不太可能在实践中出现，但想象一下诊断出这样的混乱是多么痛苦！

我可以模糊地想象尝试做一些棘手和复杂的事情，也许不是那么面向未来，以某种方式导入`gzip`模块的私有副本和猴子补丁*，*但到那时，过滤器似乎更简单、更直接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T03:44:19.397

在 lib/gzip.py 中，我们找到了构建标头的方法，包括确实包含时间戳的部分。在 Python 2.5 中，这从第 143 行开始：

```
def _write_gzip_header(self):
    self.fileobj.write('\037\213')             # magic header
    self.fileobj.write('\010')                 # compression method
    fname = self.filename[:-3]
    flags = 0
    if fname:
        flags = FNAME
    self.fileobj.write(chr(flags))
    write32u(self.fileobj, long(time.time())) # The current time!
    self.fileobj.write('\002')
    self.fileobj.write('\377')
    if fname:
        self.fileobj.write(fname + '\000') 
```

如您所见，它使用 time.time() 来获取当前时间。根据在线模块文档，time.time 将“以浮点数形式返回时间，以自纪元以​​来的秒数表示，以 UTC 为单位。” 因此，如果您将其更改为您选择的浮点常量，您总是可以写出相同的标题。我看不到更好的方法来做到这一点，除非您想进一步破解库以接受您在未指定时默认为 time.time() 时使用的可选时间参数，在这种情况下，我敢肯定如果您提交补丁，他们会喜欢的！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T04:32:23.747

这不漂亮，但你可以用这样的东西临时修补 time.time：

```
import time

def fake_time():
  return 100000000.0

def do_gzip(content):
    orig_time = time.time
    time.time = fake_time
    # result = do gzip stuff here
    time.time = orig_time
    return result 
```

它不漂亮，但它可能会起作用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-18T18:06:32.567

类似于上面多米尼克的答案，但对于**现有**文件：

```
with open('test_zip1', 'rb') as f_in, open('test_zip1.gz', 'wb') as f_out:
    with gzip.GzipFile(fileobj=f_out, mode='wb', filename="", mtime=0) as gz_out:
         shutil.copyfileobj(f_in, gz_out) 
```

测试 MD5 和：

```
md5sum test_zip*
7e544bc6827232f67ff5508c8d6c30b3  test_zip1
75decc5768bdc3c98d6e598dea85e39b  test_zip1.gz
7e544bc6827232f67ff5508c8d6c30b3  test_zip2
75decc5768bdc3c98d6e598dea85e39b  test_zip2.gz 
```

# php - 如何获取 Google 搜索的顶部结果？

> ID：264232
> 
> 赞同：1
> 
> 时间：2008-11-05T02:53:20.450
> 
> 标签：php

在 PHP 脚本中，我只想获取 Google 搜索的顶部结果的 URL 并重定向到它。我可以刮掉它，但有更好的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-05T02:55:31.617

使用手气不错的功能。

例子：

> [http://www.google.com/search?hl=en&q=](http://www.google.com/search?hl=en&q=) **stackoverflow** & **btnI=I'm+Feeling+Lucky** &aq=f&oq=

它会自动将您带到最佳结果。

# cygwin - 从 CYGWIN 访问时，如何确定在 VAX 打开的 vms 中放入 .rhosts 文件中的内容

> ID：264236
> 
> 赞同：1
> 
> 时间：2008-11-05T02:56:53.347
> 
> 标签：cygwin, remoting, unix, vax

在 Windows XP 上尝试使用 Cygwin 的远程 shell 远程访问服务器时，如何确定在 VAX openvms 系统中放入 .rhosts 文件的内容？.rlogin 和 rsh 是唯一可用于访问 VAX 服务器的方法，它必须使用 Cygwin 远程访问 VAX 服务器。SSH 不是一个选项。当从 Sun 服务器访问 VAX 服务器时，它工作正常。我已经尝试了许多可能的组合，Cygwin 可能会将 VAX 发送到用户名和来源地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-05T03:12:54.890

*   返回什么错误信息？
*   有输出吗？
*   如果这真的是 VAX（不是 Alpha），它是使用 Digital 的 TCP/IP 实现还是其他供应商？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-14T02:29:52.783

这个问题的答案是尝试访问 VAX 的客户端必须在客户端的 .rhosts 文件中具有 VAX 服务器的名称（在本例中为 ACSD5（但不需要用户名））。我不知道为什么。VAX 必须尝试以某种方式访问​​客户端，这要求 .rhosts 列出了 VAX 服务器。所以无论如何问题都解决了。

# php - php Echo/打印多行字符串？

> ID：264238
> 
> 赞同：1
> 
> 时间：2008-11-05T03:00:23.633
> 
> 标签：php, echo, multiline

我有一个启动我的 exe 的 php 文件。exe 确实 cout 并且文本以 html 打印，这一切都很好。直到我写“someline\n”；\n 打破了输出，我只看到最后一行。我如何打印/回显其中包含多行的文本/字符串？

当前的粘贴已 \n 注释掉，我的文本打印正常。它在控制台中看起来很难看，当我使用 IE7 查看源代码（虽然我主要使用 FF 浏览）时，源代码看起来很痛苦。这是我当前的 php 和 cpp 文件

```
<html>
<head>
</head>
<body>
<?php
echo( exec('c:/path/to/exe/launchMe.exe hey lol hi') );
?>
</body>
</html> 
```

cpp

```
#include <string>
#include <iostream>
#include <sstream>
using namespace std;

const string htmlLine(string s)
{
    s+= "<br />";
//  s += "\n";
    return s;
}

int main(int argc, char *argv[])
{
    stringstream s;
    s << argc;
    cout << htmlLine("woot") << htmlLine(s.str());
    for (int i=0; i<argc; ++i)
    {
        s.str("");
        s << i << " = " << argv[i];
        cout << htmlLine(s.str());
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T03:03:49.697

从[http://php.net/exec](http://php.net/exec)：

> ## 返回值
> 
> 命令结果的最后一行。如果您需要执行命令并将命令中的所有数据直接传回而不受任何干扰，请使用[passthru()](http://php.net/passthru)函数。

[exec()](http://php.net/exec)函数只返回最后一行输出，而passthru [()](http://php.net/passthru)则返回*所有*输出。

# linux - 实时 Linux 扩展已经过时了吗？

> ID：264240
> 
> 赞同：2
> 
> 时间：2008-11-05T03:00:39.577
> 
> 标签：linux, kernel, real-time

来自 Ingo Molnar 的新实时和低延迟补丁是否会使以前的 Linux 实时扩展（例如 RTAI、Xenomai）过时？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T06:06:42.323

虽然我还没有尝试在 Linux 上构建实时系统，但在我看来并不像它。RTAI 看起来像 API。POSIX.4 将是类似的（当然，在我作为该委员会的前副主席和该书的作者的拙见中，它当然是*无限优越的：）。*

在我看来，Molnar 的工作似乎是为了真正为Linux提供实时*性能而设计的。*因此，要编写一个真实的、实时的应用程序，您可能正在谈论 (1) 使用实时 API 以及标准的 *nix 调用，以及 (2) 非常仔细地构建您的应用程序，考虑到上面提到的技术[实时 Linux](http://rt.wiki.kernel.org/index.php/Main_Page) Wiki 。所以总的来说，我会说你需要两者。而且可能比这两个还要多！

# .net - .config 到构造函数的技巧？

> ID：264243
> 
> 赞同：4
> 
> 时间：2008-11-05T03:03:20.023
> 
> 标签：.net, configuration, interface, inversion-of-control, factory

我正在做一个快速的项目来监控/处理数据。本质上，这只是监视器、时间表和处理器。监视器使用计划检查数据（ftp、本地、imap、pop 等）并将新数据发送到处理器。它们都有接口。

我正在尝试找到一种理智的方式来使用 config 来配置每个监视器使用的调度/处理器。这很容易：

```
<monitor type="any.class.implementing.monitor">
    <schedule type="any.class.implementing.schedule">
        ...
    </schedule>
    <processor type="any.class.implementing.processor" />
</monitor> 
```

我正在苦苦挣扎的是配置任何旧监视器/时间表/处理器的最佳方法是什么。一方面，可以实现构造函数参数或属性（不采用任何语法）：

```
<monitor type="any.class.implementing.monitor">
    <args>
        <arg value="..." />
    </args>
    <properties>
        <property name="..." value=..." />
    </properties>
    <schedule type="any.class.implementing.schedule">
        ...
    </schedule>
    <processor type="any.class.implementing.processor" />
</monitor> 
```

另一种解决方案是每个接口中的工厂方法，它将自定义配置作为参数：

```
public IMonitor Create(CustomConfigSection config); 
```

我见过有人同时使用这两种方法。你喜欢哪个？将配置映射到构造函数时有什么技巧吗？

我对 DI 是否能融入这个烂摊子感到有些不安。最后，这将是每个监视器实例的一组绑定，除了配置可以覆盖的默认值之外，这似乎毫无意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-07T18:08:07.357

首先，我将定义代表监视器的配置元素：

```
public class MonitorElement : ConfigurationElement
{
    // ...whatever schema you prefer...
}

public class MonitorElementCollection : ConfigurationElementCollection
{
    // ...standard implementation...
} 
```

以及托管它们的配置部分：

```
public class YourSection : ConfigurationSection
{
    [ConfigurationProperty("monitors")]
    [ConfigurationCollection(typeof(MonitorElementCollection))]
    public MonitorElementCollection Monitors
    {
        get { return (MonitorElementCollection) this["monitors"]; }
    }
} 
```

然后，我将定义一个表示监视器集的接口：

```
public interface IMonitorRepository
{
    IEnumerable<Monitor> GetMonitors();
} 
```

并创建一个读取配置文件的实现：

```
public sealed class ConfiguredMonitorRepository : IMonitorRepository
{
    private readonly string _sectionName;

    public ConfiguredMonitorRepository(string sectionName)
    {
        _sectionName = sectionName;
    }

    public IEnumerable<Monitor> GetMonitors()
    {
        var section = (YourSection) ConfigurationManager.GetSection(_sectionName);

        if(section != null)
        {
            foreach(var monitor in section.Monitors)
            {
                yield return ...create and configure monitor...
            }
        }
    }
} 
```

这定义了您将配置转换为实际实例的位置，这只是您问题的一半。我认为用于设置构造函数参数和属性的 XML 语法很好。您或许可以从[Autofac 的 XML 配置系统](http://code.google.com/p/autofac/wiki/XmlConfiguration)中收集到一些 API 和实现思路。

确实，您正在做的是 IoC 容器的强项；您可以考虑利用其中之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T04:09:03.183

当我完成这种事情时，我实现了一个`IConfigurationSectionHandler`基本上作为工厂来解析配置，创建配置中指定类型的对象，并以某种数据结构（通常是 List 或字典）。无论您是否使用 an `IConfigurationSectionHandler`，我认为工厂都是可行的方法，因为您将本地化处理解析配置文件并在一个类（或每个部分一个）中创建对象的代码。

我也更喜欢具有简单构造函数的类和用于配置的属性设置器/获取器，而不是构造函数中具有大量参数的类。这使得工厂更容易操作，并减少了工厂与正在构建的类之间的耦合。

# java - 如何为 jBPM 中的流程定义部署生成 sql 脚本？

> ID：264248
> 
> 赞同：3
> 
> 时间：2008-11-05T03:06:06.557
> 
> 标签：java, workflow, jbpm

我正在考虑将 jBPM 与我当前的项目集成，到目前为止，仅包括我耳中的 jpdl jar 并使用 spring 模块 0.8 jbpm 模块，但是我必须有一个合理的方法来从我的更改到设计器中的流程定义到生产中的部署。

该路径必须在许多环境（开发、许多测试、登台和生产）中是可重复的，并且理想情况下应该在系统本身未运行时完成。

理想情况下，我会将整个定义打包为 SQL 脚本，但是我还没有看到任何工具可以将 processdefinition.xml 转换为 sql，并且手动组装它似乎过于繁琐且容易出错。

有没有其他人在这里有任何经验？

该系统在 websphere 6.1 上运行，我倾向于避免在迁移时执行 java 代码（运行 java 代码以生成可以在迁移期间使用的工件虽然可以）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-13T12:43:20.737

如果您想避免走下坡路`.par`，很容易编写一些简单的 Java 代码来将新的流程定义版本部署到您的数据库。就像是

```
JbpmConfiguration jbpmConfiguration = JbpmConfiguration.getInstance("jbpm.cfg.xml"));
ProcessDefinition processDefinition = ProcessDefinition.parseXmlInputStream(newPdStream);
JbpmContext context = jbpmConfiguration.createJbpmContext();
context.getGraphSession().deployProcessDefinition(processDefinition); 
```

您需要在类路径上有相关数据库的`hibernate.properties`or `hibernate.cfg.xml`。

这种方式的好处是所有版本控制的东西都是自动为你完成的。我们曾经使用 hack 修改流程定义（基本上忽略版本控制），但对于当时处于活动状态的流程实例来说，这是一个巨大的混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-02T08:33:26.100

解决方法建议：部署和拦截 sql 查询

我还没有尝试过，但我建议尝试使用 jBPM-console deploy servlet 的部署或

```
context.getGraphSession().deployProcessDefinition(processDefinition); 
```

正如 shyamsundar 所建议的那样

和

使用 LogDriver 记录 sql 更新：[http: //rkbloom.net/logdriver/logdriver.tar.gz](http://rkbloom.net/logdriver/logdriver.tar.gz)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T18:33:43.767

为什么不专门使用 JBPM 提供的 ant 任务扩展[`DeployProcessTask`](http://docs.jboss.org/jbpm/v3/javadoc/org/jbpm/ant/DeployProcessTask.html)。您可以部署到只有一个`.par`文件的不同环境，并且对应`jbpm-cfg.xml`于各种 dev/test/staging/prod 环境。您可能需要做的唯一更改是将您的休眠配置配置为直接连接到数据库而不是使用数据源。

# xml - 写入和读取 xml 字符串的正确方法

> ID：264249
> 
> 赞同：2
> 
> 时间：2008-11-05T03:07:08.987
> 
> 标签：xml, vb.net, network-programming

我已经在这堵墙上撞了很长时间了，所以我想我会问一些专家。

我需要将 xml 字符串从一台计算机发送到下一台计算机。我想像这样格式化xml：

```
<xml>
  <author>Joe the Magnificent</author>
  <title>Joe Goes Home</title>
</xml> 
```

任何人都可以提供一些帮助吗？

编辑：更多细节

我控制发送和接收，并成功地单向传输硬编码字符串。

这是接收端：

```
 Dim author As String
    Dim title As String

    Dim xDoc As New XmlDocument
    Dim xAuthor As XmlElement
    Dim xTitle As XmlElement

    xDoc.LoadXml(xml)
    xAuthor = xDoc.FirstChild.Item("author")
    xTitle = xDoc.FirstChild.Item("title")

    author = xAuthor.FirstChild.Value
    title = xTitle.FirstChild.Value

    ShowMessage(author, title) 
```

大多数情况下，这是一个学习如何为我做 XML 的练习，所以除了我自己的知识之外，它没有真正的目的。我正在寻找一些关于做这些事情的最佳方式的意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T03:32:52.477

使用[XmlDocument.Load](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.load.aspx)方法，您有 4 个选项：来自 Stream、TextReader、URL 或 XmlReader。

您可以使用[NetworkStream](http://msdn.microsoft.com/en-us/library/system.net.sockets.networkstream.aspx)类通过网络。您可以将您的 XML 发布到网站上，然后通过 URL 选项将其吸收。您可能希望更具体地了解您希望发生传输的协议。

例如，要写入流，请使用流的 XmlWriter.Create 重载。使用 XmlWriterSettings 对象提供缩进。

```
 Dim settings As XmlWriterSettings = New XmlWriterSettings()
   settings.Indent = true
   settings.IndentChars = (ControlChars.Tab)
   settings.OmitXmlDeclaration = true

   Dim myNetworkStream As New NetworkStream(mySocket) 'mySocket is a whole other code sample

   ' Create the XmlWriter object and write some content.
   writer = XmlWriter.Create(myNetworkStream, settings)
   XmlDocument.WriteTo(writer) 
```

构建 xml 文档 [旧方法] 非常麻烦，我建议查看 VB9 XML 文字。然而，这里是 .NET 2 样式 XmlDocument 操作的示例：

```
 Dim doc As New XmlDocument()
    Dim root As XmlElement = doc.CreateElement("xml")
    Dim author As XmlElement = doc.CreateElement("author")
    author.Value = "Joe the magnificent"
    Dim title As XmlElement = doc.CreateElement("title")
    title.Value = "Joe goes home"

    root.AppendChild(author)
    root.AppendChild(title)
    doc.AppendChild(root) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-12T12:37:57.897

这就是我最终做的事情：

```
Public Function FormatMessage(ByVal author As String, ByVal title As String, ByVal genre As String) As String
Dim xDoc As New XmlDocument

' Create outer XML
Dim xNode As XmlNode = xDoc.AppendChild(xDoc.CreateElement("xml"))

' Create Author Node
Dim xAuthor As XmlNode = xNode.AppendChild(xDoc.CreateElement("author"))
xAuthor.InnerText = author

' Create Message Node
Dim xTitle As XmlNode = xNode.AppendChild(xDoc.CreateElement("message"))
xtitle.InnerText = title

' Create Genre Node
Dim xGenre As XmlNode = xNode.AppendChild(xDoc.CreateElement("genre"))
xGenre.InnerText = genre

' Create StringWriter to convert XMLDoc to string
Dim xWriter As New IO.StringWriter()
Dim xml_writer As New XmlTextWriter(xWriter)
xDoc.WriteContentTo(xml_writer)
Return xWriter.ToString

End Function 
```

此函数根据输入值构建 xml 字符串，然后将 xml 字符串分解回原始值，我使用了这个：

```
Dim author As String
Dim title As String
Dim genre As String

Dim xDoc As New XmlDocument
Dim xAuthor As XmlElement
Dim xTitle As XmlElement
Dim xGenre as XmlElement

xDoc.LoadXml(xml)
If xDoc.DocumentElement.Name = "xml" Then
    xAuthor = xDoc.FirstChild.Item("author")
    xTitle = xDoc.FirstChild.Item("title")

    author = xAuthor.FirstChild.Value
    title = xTitle.FirstChild.Value
    genre = xGenre.FirstChild.Value
End If

ShowMessage(author, title, genre) 
```

谢谢您的帮助！凯杰

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T03:35:52.563

好吧，我不知道这是否是您要查找的内容，但是如果您使用的是最新版本的 VB 和 .NET，那么您应该能够使用 xml 文字和 LINQ 来解析您的 xml：就像这样->

```
Sub Send()
    Dim myxml = <xml>
                   <author>Joe the Magnificent</author>
                   <title>Joe Goes Home</title>
                </xml>
Readxml(myxml)
End Sub

Sub Readxml(myxml as XDocument)
Dim Data = From xml in myxml...<xml> _
           Select New With {.Author = xml.<author>.value, _
                            .title = xml.<title>.value}

For each item in Data
    ShowMessage(item.Author,Item.Title)
Next
End Sub 
```

请注意，上面只是空气代码，因此它可能无法运行，而不是在我的计算机上，因此我无法对其进行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-06T14:30:47.290

像这样创建一个类：

```
Imports System.Data

Public Class STKReservedStock_insertrow
Inherits Request
Public Sub New(User As String, Company As String)
    MyBase.New("stkreservestockall", User, Company)
End Sub

#Region "Properties"

Public Property _pdt As String
    Get
        Return DirectCast(Field("pdt"), String)
    End Get
    Set(ByVal value As String)
        Field("pdt") = value
    End Set
End Property
Public Property _whse As String
    Get
        Return DirectCast(Field("whse"), String)
    End Get
    Set(ByVal value As String)
        Field("whse") = value
    End Set
End Property
Public Property _traceNumber As Integer
    Get
        Return DirectCast(Field("traceNumber"), Integer)
    End Get
    Set(ByVal value As Integer)
        Field("traceNumber") = value
    End Set
End Property
Public Property _bin As String
    Get
        Return DirectCast(Field("bin"), String)
    End Get
    Set(ByVal value As String)
        Field("bin") = value
    End Set
End Property
Public Property _lotref As String
    Get
        Return DirectCast(Field("lotref"), String)
    End Get
    Set(ByVal value As String)
        Field("lotref") = value
    End Set
End Property
Public Property _packUOM As String
    Get
        Return DirectCast(Field("packUOM"), String)
    End Get
    Set(ByVal value As String)
        Field("packUOM") = value
    End Set
End Property
Public Property _grade As String
    Get
        Return DirectCast(Field("grade"), String)
    End Get
    Set(ByVal value As String)
        Field("grade") = value
    End Set
End Property
Public Property _shpLabel As Integer
    Get
        Return DirectCast(Field("shpLabel"), Integer)
    End Get
    Set(ByVal value As Integer)
        Field("shpLabel") = value
    End Set
End Property
Public Property _countLoc As String
    Get
        Return DirectCast(Field("countLoc"), String)
    End Get
    Set(ByVal value As String)
        Field("countLoc") = value
    End Set
End Property
Public Property _palletType As String
    Get
        Return DirectCast(Field("palletType"), String)
    End Get
    Set(ByVal value As String)
        Field("palletType") = value
    End Set
End Property
Public Property _subPdt As String
    Get
        Return DirectCast(Field("subPdt"), String)
    End Get
    Set(ByVal value As String)
        Field("subPdt") = value
    End Set
End Property
Public Property _subTn As Integer
    Get
        Return DirectCast(Field("subTn"), Integer)
    End Get
    Set(ByVal value As Integer)
        Field("subTn") = value
    End Set
End Property
Public Property _origReserved As Decimal
    Get
        Return DirectCast(Field("origReserved"), Integer)
    End Get
    Set(ByVal value As Decimal)
        Field("origReserved") = value
    End Set
End Property
Public Property _reserved As Decimal
    Get
        Return DirectCast(Field("reserved"), Integer)
    End Get
    Set(ByVal value As Decimal)
        Field("reserved") = value
    End Set
End Property
Public Property _dateReserved As Date
    Get
        Return DirectCast(Field("dateReserved"), Date)
    End Get
    Set(ByVal value As Date)
        Field("dateReserved") = value
    End Set
End Property
Public Property _reservedBy As String
    Get
        Return DirectCast(Field("reservedBy"), String)
    End Get
    Set(ByVal value As String)
        Field("reservedBy") = value
    End Set
End Property
Public Property _reason As String
    Get
        Return DirectCast(Field("reason"), String)
    End Get
    Set(ByVal value As String)
        Field("reason") = value
    End Set
End Property
Public Property _party As String
    Get
        Return DirectCast(Field("party"), String)
    End Get
    Set(ByVal value As String)
        Field("party") = value
    End Set
End Property
Public Property _Cancelled As String
    Get
        Return DirectCast(Field("Cancelled"), String)
    End Get
    Set(ByVal value As String)
        Field("Cancelled") = value
    End Set
End Property
Public Property _CancelledByUsr As String
    Get
        Return DirectCast(Field("CancelledByUsr"), String)
    End Get
    Set(ByVal value As String)
        Field("CancelledByUsr") = value
    End Set
End Property
Public Property _RsvQty As Decimal
    Get
        Return DirectCast(Field("RsvQty"), Integer)
    End Get
    Set(ByVal value As Decimal)
        Field("RsvQty") = value
    End Set
End Property
#End Region

End Class 
```

然后像这样发送它：

```
 Dim XMLRqst As New STKReservedStock_insertrow(User, Company)

    Rqst._pdt = If(IsDBNull(drStock.Item("pdt")), "", drStock.Item("pdt").ToString)
    Rqst._whse = If(IsDBNull(drStock.Item("whse")), "", drStock.Item("whse").ToString)
    Rqst._traceNumber = If(IsDBNull(drStock.Item("traceNumber")), 0, CInt(drStock.Item("traceNumber")))
    Rqst._bin = If(IsDBNull(drStock.Item("bin")), "", drStock.Item("bin").ToString)
    Rqst._lotref = If(IsDBNull(drStock.Item("lotref")), "", drStock.Item("lotref").ToString)
    Rqst._packUOM = If(IsDBNull(drStock.Item("packUOM")), "", drStock.Item("packUOM").ToString)
    Rqst._grade = If(IsDBNull(drStock.Item("grade")), "", drStock.Item("grade").ToString)
    Rqst._shpLabel = If(IsDBNull(drStock.Item("shpLabel")), 0, CInt(drStock.Item("shpLabel")))
    Rqst._countLoc = If(IsDBNull(drStock.Item("countLoc")), "", drStock.Item("countLoc").ToString)
    Rqst._palletType = If(IsDBNull(drStock.Item("palletType")), "", drStock.Item("palletType").ToString)
    Rqst._subPdt = If(IsDBNull(drStock.Item("subPdt")), "", drStock.Item("subPdt").ToString)
    Rqst._subTn = If(IsDBNull(drStock.Item("subTn")), 0, CInt(drStock.Item("subTn")))
    Rqst._origReserved = reservedqty
    Rqst._reserved = reservedqty
    Rqst._dateReserved = Now
    Rqst._reservedBy = User
    Rqst._reason = reason
    Rqst._party = party
    Rqst._Cancelled = "f"
    Rqst._CancelledByUsr = ""
    Rqst._RsvQty = reservedqty

Send(XMLRqst.toxml) 
```

发送显然是您的发送子例程（无论它发送到哪里）

# excel - 导出制表符分隔时使用的最佳 MIME 类型和扩展名是什么？

> ID：264256
> 
> 赞同：29
> 
> 时间：2008-11-05T03:12:48.837
> 
> 标签：excel, export, mime-types, csv

我遇到了 Excel 不能很好地处理 UTF-8 编码的 CSV 文件的问题。请参阅Stack Overflow 上的[相关问题。](https://stackoverflow.com/questions/155097/microsoft-excel-mangles-diacritics-in-csv-files)

我遵循了导出为 UTF-16 的解决方案，但是似乎使用 UTF-16，逗号字符不能用作分隔符，只能用作制表符。

但是，对于制表符分隔的文件，我在任何地方都找不到正确的文件名和 mime 类型。我在某处发现它是 application/vnd.ms-excel 和 xls。这适用于 Excel 2003，但 2007 不批准。

那么它应该是什么？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-25T07:52:14.857

对于制表符分隔的文件，[http:](http://www.rfc-editor.org/rfc/rfc4180.txt) //www.rfc-editor.org/rfc/rfc4180.txt 提到了“文本/制表符分隔值”。

该格式（稀疏地）在[http://www.iana.org/assignments/media-types/text/tab-separated-values](http://www.iana.org/assignments/media-types/text/tab-separated-values)中描述。

更多信息请访问：[http ://www.cs.tut.fi/~jkorpela/TSV.html](http://www.cs.tut.fi/~jkorpela/TSV.html)

我希望这有帮助？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-18T21:52:23.463

Mime-type 是一种 HTTP 事物，仅对浏览器有意义 - 当您下载本地副本时，它不会与文件一起保存。所以 Excel 永远不会看到你的 mime 类型。

# grammar - 语法写作工具

> ID：264262
> 
> 赞同：12
> 
> 时间：2008-11-05T03:16:58.593
> 
> 标签：grammar, parsing, ebnf

我正在尝试在 EBNF 中编写语法（除非有很好的理由，它必须是 EBNF）并且正在为它寻找一些实用程序 - 如果有一个可以制作的 GUI 界面，那就太好了，但是我最想找的是可以检查语法的东西，例如看它是否是 LALR( *n* )，如果是，*n*的值是多少。是否存在这样的实用程序？还有其他我应该知道的有用的语法编写工具吗（我不是在寻找解析器生成器）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-26T16:33:10.453

使用**TinyPG**！它是一个具有轻量级 GUI 的令人惊叹的一体化**编译器编译器，您可以在其中使用****RegEx**、**EBNF**构建解析器，并编写**C#/VB代码来使用****解析树**做一些事情！

这是我之前所做的简短且内容丰富的摘要，它还将您链接到下载。

* * *

***我对 TinyPG 的理解：***

[TinyPG](http://www.codeproject.com/KB/recipes/TinyPG.aspx)允许您编写和开发：

*   使用[**正则表达式**](http://www.codeproject.com/KB/dotnet/regextutorial.aspx)定义**终端**[。](http://www.codeproject.com/KB/dotnet/regextutorial.aspx)[](http://www.codeproject.com/KB/dotnet/regextutorial.aspx)
***   [**在扩展 BNF**](http://en.wikipedia.org/wiki/EBNF)[元语法](http://en.wikipedia.org/wiki/EBNF)中定义**非终结**符和解析器规则。[](http://en.wikipedia.org/wiki/EBNF)***   在 TinyPG 中用**C# 或 VB**编写**编译器**代码。****

 ******它有一个内置的 IDE，仅限 Windows *（在 C#.NET 中创建，开源）*。

它允许您使用内置的**RegEx 工具**试用和预览**正则表达式。**.NET 支持 RegEx 语法，这意味着即使您**输出的解析器代码**也使用 .NET 的正则表达式。

 ****您编写 EBNF 来描述**您选择的语言** *（这里有一些免费提供的[BNF 语法描述现代编程语言](http://www.devincook.com/GOLDParser/grammars/index.htm)（C、Java、JavaScript、C#、VB.NET、SQL-89）*

使用 TinyPG，您的**RegEx**和您的**EBNF**会输出一个**解析树** [*（参见此图）*](http://upload.wikimedia.org/wikipedia/en/a/a9/Parser_Flow.gif)。

现在你用解析树做什么？你为你的**编译器/解释器/翻译器**编写**C#/VB 代码** *（在 TinyPG 中，根据 BNF 语法规则） 。****（在 TinyPG 中，打开提供的示例中的“simple expression2.tpg”文件以查看计算器****“编译器”**的演示）*

 ****TinyPG 允许您在 TinyPG IDE 中**编译和测试**您的**标记器+解析器+编译器**，并最终以 C#.NET 或 VB.NET *（您的选择）输出***解析器源代码**，并带有**现成的**类。

 ***适合大众的优秀**多合一编译器编译器。**享受！

*PS：如果我在这方面有任何错误，请纠正我。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T04:09:16.537

将 Steven Dee 的建议更进一步，您可能想要查看[ANTLRWorks](http://www.antlr.org/works/index.html)，这是一个用于 ANTLR 语法的交互式 GUI 开发工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T08:04:34.347

要检查语法是否允许某种解析器算法，只需将其放入解析器生成器即可。在 LALR(1) 的情况下，将语法传递给 YACC 以查看它是否检测到冲突。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-01T19:02:57.227

列表中缺少[CoCo/R C#。](http://www.ssw.uni-linz.ac.at/Coco/)它使用简单，用途广泛，特别有用，具有适用于多种语言的代码生成器

Coco/R for C#, Java, C++, F#, VB.Net, Oberon, 其他语言

[1] [http://www.ssw.uni-linz.ac.at/Coco/](http://www.ssw.uni-linz.ac.at/Coco/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T09:07:14.673

[ANTLR](http://www.antlr.org/)是 Java 中的 GUI 解析器生成器，具有广泛的语法分析和分解功能。检查常见问题；它可能支持你正在寻找的东西。

# php - 调试挂起的php

> ID：264266
> 
> 赞同：5
> 
> 时间：2008-11-05T03:21:52.390
> 
> 标签：php, debugging, process, hung

我有一个偶尔挂起的 php web 应用程序。当我导航到该页面时，即使最大执行次数为 210，它也会坐在那里尝试加载数小时。这是一个应用程序在代理后面使用 curl 来下载内容。错误报告设置为全部，但这并不重要，因为页面是空白并挂起的。

我在调试挂起的 PHP 进程时找不到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T03:25:01.183

最后我检查了一下，HTTP/IO 操作发生在 php 时间之外，因此 CURL 可能正在消亡或超时。

它的 IO，所以 php 只是抛出一些系统库，然后调用“select”等待它回​​来。

如果它不回来.. php 代码甚至不会循环，因此甚至不会知道它不会回来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T04:09:00.750

我敢打赌它是一个卷曲问题。几年前我有一个类似的问题，我添加了一个特定的 curl 选项，有时会挂起脚本。我希望我能确切地记住问题是什么，但我相信最终是 curl 链接到了下面的错误库。（**编辑**）实际上，我很确定在我的情况下它是 SSL 库，因为 curl 使用的是旧版本的 openssl。

我建议`curl_setopt()`首先删除所有呼叫，然后将它们重新添加以查看是否可以隔离错误。我**想**如果你在命令行上运行等效的 curl 命令，你可能会立即看到错误。

我通过更新 curl 正在使用的 openssl 库来修复它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T05:56:10.190

要查看幕后发生的事情，您可以安装 xdebug，然后启用触发分析 (?XDEBUG_PROFILE=1)...它将输出日志到与 kcachegrind/etc 兼容的文件系统...您可以使用它来查看执行悬而未决的地方。

当然，这很可能是卷曲问题....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T18:02:43.143

This is going to sound lame, but just open a file handle at the very start of your page request, then start doing fwrites to /tmp/debug.txt . See where the last one gets written, and then start echoing various variable values out into the file in that area. Use the theory of binary search to distribute your fwrites into finer and finer sections of resolution on your code.

```
i.e.

$fh = fopen("/tmp/debug.txt", "w");

fwrite($fh, "made it to here 1 \n");

//some code

fwrite($fh, "made it to here 2 \n");

//more code

fwrite($fh, "made it to here 3 \n"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T17:03:28.690

[Xdebug](http://xdebug.org)是一个好主意，如果没有帮助，我还建议通过 ktrace、strace 或 truss 运行您的网络服务器。它向您确切显示了它的作用以及它可能挂在哪里。

听起来好像存在临时连接问题，或者您的应用程序依赖的其他东西被阻止了。

如果您使用 Apache，请查看[Apache HTTP 调试指南](http://httpd.apache.org/dev/debugging.html#truss)。该指南有点以 *nix 为中心，但可以应用于任何网络服务器。

除了调试您的网络服务器之外，我还建议您添加检查您的代理是否始终处于启动/响应状态并且下载源始终可用。可以使用[nagios之类的工具或](http://nagios.org)[Pingdom](http://pingdom.com)之类的 3rd 方服务添加这些检查。最后但同样重要的是，它也可能是一个临时的 DNS 问题，因此您可以使用 IP 连接到代理和下载源和/或添加对 DNS 服务的监控。

高温高压

# c - 什么是记录在 C（或可能是 C++）中使用 X-Macros 模式的良好参考？

> ID：264269
> 
> 赞同：20
> 
> 时间：2008-11-05T03:25:05.957
> 
> 标签：c, include, c-preprocessor

[在 C 预处理器](http://en.wikipedia.org/wiki/C_preprocessor)的这个维基百科条目中给出了“ [X-Macros](http://en.wikipedia.org/wiki/C_preprocessor#X-Macros) ”的基本定义和示例以及一些参考：

> X-Macro 是一个头文件（通常使用“.def”扩展名而不是传统的“.h”），其中包含类似宏调用的列表（可以称为“组件宏”）。

关于如何使用这种强大的技术，有哪些好的信息来源？有使用这种方法的知名开源库吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-05T15:50:34.920

我在代码中经常使用 X Macros()。该值来自仅将新数据添加到“X 列表”而不修改任何其他代码。

X Macros() 最常见的用途是将错误文本与错误代码相关联。当添加新的错误代码时，程序员必须记住添加代码和文本，通常在不同的地方。X 宏允许在一个地方添加新的错误数据，并在任何需要的地方自动填充。

不幸的是，这些机制使用了很多预编译器的魔法，这会使代码有些难以阅读（例如，使用 连接`token1##token2`字符串，使用 创建字符串`#token`）。因此，我通常会在评论中解释 X 宏在做什么。

这是使用错误/返回值的示例。所有新数据都被添加到“ `X_ERROR`”列表中。无需修改任何其他代码。

```
/* 
 * X Macro() data list
 * Format: Enum, Value, Text
 */
#define X_ERROR \
  X(ERROR_NONE,   1, "Success") \
  X(ERROR_SYNTAX, 5, "Invalid syntax") \
  X(ERROR_RANGE,  8, "Out of range")

/* 
 * Build an array of error return values
 *   e.g. {0,5,8}
 */
static int ErrorVal[] =
{
  #define X(Enum,Val,Text)     Val,
   X_ERROR
  #undef X
};

/* 
 * Build an array of error enum names
 *   e.g. {"ERROR_NONE","ERROR_SYNTAX","ERROR_RANGE"}
 */

static char * ErrorEnum[] = {
  #define X(Enum,Val,Text)     #Enum,
   X_ERROR
  #undef X
};

/* 
 * Build an array of error strings
 *   e.g. {"Success","Invalid syntax","Out of range"}
 */
static char * ErrorText[] = {
  #define X(Enum,Val,Text)     Text,
   X_ERROR
  #undef X
};

/* 
 * Create an enumerated list of error indexes
 *   e.g. 0,1,2
 */
enum {
  #define X(Enum,Val,Text)     IDX_##Enum,
   X_ERROR
  #undef X
  IDX_MAX   /* Array size */
};

void showErrorInfo(void)
{
    int i;

    /* 
     * Access the values
     */
    for (i=0; i<IDX_MAX; i++)
        printf(" %s == %d [%s]\n", ErrorEnum[i], ErrorVal[i], ErrorText[i]);

} 
```

您还可以使用 X Macros() 生成代码。例如，要测试错误值是否“已知”，X 宏可以在 switch 语句中生成案例：

```
 /*
  * Test validity of an error value
  *      case ERROR_SUCCESS:
  *      case ERROR_SYNTAX:
  *      case ERROR_RANGE:
  */

  switch(value)
  {

  #define X(Enum,Val,Text)     case Val:
   X_ERROR
  #undef X
         printf("Error %d is ok\n",value);
         break;
      default:
         printf("Invalid error: %d\n",value);
         break;
  } 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-02-21T20:05:04.650

几年前，当我开始在我的代码中使用函数指针时，我发现了 X-macros。我是一名嵌入式程序员，经常使用状态机。我经常会写这样的代码：

```
/* declare an enumeration of state codes */
enum{ STATE0, STATE1, STATE2, ... , STATEX, NUM_STATES};

/* declare a table of function pointers */
p_func_t jumptable[NUM_STATES] = {func0, func1, func2, ... , funcX}; 
```

问题是我认为必须维护我的函数指针表的顺序以使其与我的状态枚举的顺序相匹配非常容易出错。

我的一个朋友向我介绍了 X-macros，它就像我脑子里的一个灯泡熄灭了。说真的，我这辈子 X 宏你都去哪儿了！

所以现在我定义下表：

```
#define STATE_TABLE \
        ENTRY(STATE0, func0) \
        ENTRY(STATE1, func1) \
        ENTRY(STATE2, func2) \
        ...
        ENTRY(STATEX, funcX) \ 
```

我可以按如下方式使用它：

```
enum
{
#define ENTRY(a,b) a,
    STATE_TABLE
#undef ENTRY
    NUM_STATES
}; 
```

和

```
p_func_t jumptable[NUM_STATES] =
{
#define ENTRY(a,b) b,
    STATE_TABLE
#undef ENTRY
}; 
```

作为奖励，我还可以让预处理器构建我的函数原型，如下所示：

```
#define ENTRY(a,b) static void b(void);
    STATE_TABLE
#undef ENTRY 
```

另一种用法是声明和初始化寄存器

```
#define IO_ADDRESS_OFFSET (0x8000)
#define REGISTER_TABLE\
    ENTRY(reg0, IO_ADDRESS_OFFSET + 0, 0x11)\
    ENTRY(reg1, IO_ADDRESS_OFFSET + 1, 0x55)\
    ENTRY(reg2, IO_ADDRESS_OFFSET + 2, 0x1b)\
    ...
    ENTRY(regX, IO_ADDRESS_OFFSET + X, 0x33)\

/* declare the registers (where _at_ is a compiler specific directive) */
#define ENTRY(a, b, c) volatile uint8_t a _at_ b:
    REGISTER_TABLE
#undef ENTRY

/* initialize registers */
#def ENTRY(a, b, c) a = c;
    REGISTER_TABLE
#undef ENTRY 
```

然而，我最喜欢的用法是在通信处理程序方面

首先，我创建一个 comms 表，其中包含每个命令名称和代码：

```
#define COMMAND_TABLE \
    ENTRY(RESERVED,    reserved,    0x00) \
    ENTRY(COMMAND1,    command1,    0x01) \
    ENTRY(COMMAND2,    command2,    0x02) \
    ...
    ENTRY(COMMANDX,    commandX,    0x0X) \ 
```

我在表中同时具有大写和小写名称，因为大写将用于枚举，而小写将用于函数名称。

然后我还为每个命令定义结构来定义每个命令的样子：

```
typedef struct {...}command1_cmd_t;
typedef struct {...}command2_cmd_t;

etc. 
```

同样，我为每个命令响应定义结构：

```
typedef struct {...}response1_resp_t;
typedef struct {...}response2_resp_t;

etc. 
```

然后我可以定义我的命令代码枚举：

```
enum
{
#define ENTRY(a,b,c) a##_CMD = c,
    COMMAND_TABLE
#undef ENTRY
}; 
```

我可以定义我的命令长度枚举：

```
enum
{
#define ENTRY(a,b,c) a##_CMD_LENGTH = sizeof(b##_cmd_t);
    COMMAND_TABLE
#undef ENTRY
}; 
```

我可以定义我的响应长度枚举：

```
enum
{
#define ENTRY(a,b,c) a##_RESP_LENGTH = sizeof(b##_resp_t);
    COMMAND_TABLE
#undef ENTRY
}; 
```

我可以确定有多少命令如下：

```
typedef struct
{
#define ENTRY(a,b,c) uint8_t b;
    COMMAND_TABLE
#undef ENTRY
} offset_struct_t;

#define NUMBER_OF_COMMANDS sizeof(offset_struct_t) 
```

注意：我从未实际实例化 offset_struct_t，我只是将它用作编译器为我生成命令数量的一种方式。

请注意，我可以生成函数指针表，如下所示：

```
p_func_t jump_table[NUMBER_OF_COMMANDS] = 
{
#define ENTRY(a,b,c) process_##b,
    COMMAND_TABLE
#undef ENTRY
} 
```

还有我的函数原型：

```
#define ENTRY(a,b,c) void process_##b(void);
    COMMAND_TABLE
#undef ENTRY 
```

最后，为了最酷的使用，我可以让编译器计算我的传输缓冲区应该有多大。

```
/* reminder the sizeof a union is the size of its largest member */
typedef union
{
#define ENTRY(a,b,c) uint8_t b##_buf[sizeof(b##_cmd_t)];
    COMMAND_TABLE
#undef ENTRY
}tx_buf_t 
```

再次，这个联合就像我的偏移结构，它没有被实例化，相反我可以使用 sizeof 运算符来声明我的传输缓冲区大小。

```
uint8_t tx_buf[sizeof(tx_buf_t)]; 
```

现在我的传输缓冲区 tx_buf 是最佳大小，当我向这个通信处理程序添加命令时，我的缓冲区将始终是最佳大小。凉爽的！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T14:32:53.173

Dobb 博士对此有[一篇文章](http://www.ddj.com/cpp/184401387)。

# algorithm - 拼写检查城市名称？

> ID：264270
> 
> 赞同：7
> 
> 时间：2008-11-05T03:25:18.577
> 
> 标签：algorithm, language-agnostic, spell-checking

我认为这个问题比普通的拼写检查更容易，因为与所有已知的英语单词相比，美国城市的列表很小。

无论如何，这是问题所在：我有充满城市名称的文本文件；其中有些拼写正确，有些拼写不正确。

我可以使用什么样的算法来纠正城市名称的所有拼写错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T03:38:45.880

您是否真的需要更正拼写错误或只是将它们标记为使用普通拼写检查器？如果是后者，您只需要获取正确拼写列表并确保每个名称与列表中的名称相同。

如果你想真正纠正它们，你可能想使用[编辑距离](http://en.wikipedia.org/wiki/Edit_distance)的概念来比较拼写错误的字符串与参考列表中的相似度。然后，您可以用最接近的匹配替换拼写错误的单词。您可能还想处理目标城市不在您的列表中的可能性。

[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance) Wikipedia 文章是另一个很好的资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T03:43:27.573

首先将正确的城市名称加载到数组中，然后遍历文件中的城市名称。通过查看当前城市名称是否在正确名称的数组中来检查当前城市名称的拼写是否正确。如果它不在数组中，请尝试将拼写错误单词的[Soundex](http://wikipedia.org/wiki/Soundex)或[Metaphone值与正确名称数组中的单词进行比较，以找到正确的拼写方式。](http://wikipedia.org/wiki/Metaphone)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T04:36:23.130

诀窍是知道该名称实际指的是哪个城市以及*该*城市名称的正确拼写方式。这与仅检查英语单词不同。

您要解决的真正任务是什么？您正在处理地址列表吗？您不应该为此编写自己的工具：整个行业都致力于这项看似简单的任务。:)

我必须为[The Perl Review](http://theperlreview.com)的订阅列表执行此操作。我已经非常熟悉世界各地不同邮局的网络服务。您通常可以访问邮政服务网站以获取地址的规范形式。有一些地理编码工具可以为您提供相同的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-26T21:46:49.707

我已经做到了。编辑距离方法是我所做的，它工作得很好，但是实时执行太慢了。

您将面临的一个挑战是，有许多城市与其他城市名称相距 1 编辑距离。你没有说文本文件中的名称来自哪里，这有很大的不同。在我的例子中，是随机输入城市名称进行搜索的人，他们偶尔会拼错他们想要的城市，但他们拼错的是一个真实的城市名称。在这种情况下，您必须对用户的意图进行一些猜测，一种简单的方法是考虑状态（如果提供）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-05T04:15:33.687

网络上有一些常见拼写错误的城市名称列表（例如 Pittsburg **h**）。除此之外，我和杰里米在一起。你只需要找到城市名称数据集，你可能想试试 USGS。Zillow 有您可能可以使用的社区数据。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-11-05T03:39:01.933

如果同一城市名称在文件中出现多次，您可以使用每个城市名称的出现次数并标记仅出现一次的城市名称。

# java - Windows 上的 Java 串行通信

> ID：264277
> 
> 赞同：33
> 
> 时间：2008-11-05T03:30:12.153
> 
> 标签：java, windows, serial-port

我一直在寻找可以与 Windows/Win32 上的串行设备通信的 Java API，但我检查过的许多 API 要么适用于 Linux，要么过于过时，要么只是受到了不好的批评。

有人可以向我推荐一个他们已经尝试过或知道在 Windows XP 上易于实现的产品吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-05T03:56:21.603

几周前我开始寻找同样的东西，到目前为止，我对多平台[RXTX库非常满意。](http://users.frii.com/jarvi/rxtx/)适用于任何 Windows、Linux 和 OS X。具有非常干净、易于理解的 API。

编辑：RXTX 也是开源的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T07:28:06.167

毫无保留，我推荐来自 serialio.com 的[Java Serial Port ；](http://serialio.com/products/serialport/serialport.php)我在使用 Sun、IBM 和 RxTx 串行包时遇到了严重的稳定性问题。SerialPort 在 5 年多来一直在 24/7 全天候生产中坚如磐石。

它们支持标准的 Java 串行 API，以及它们自己的替代专有 API。不过，我会坚持使用标准 API，除非你真的需要标准 API 不需要的东西，只是为了让你的选择保持开放。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-05-16T15:43:58.787

在过去五年左右的时间里，我一直在使用[PureJavaComm 。](https://github.com/nyholku/purejavacomm)它得到积极维护，是一个纯 Java（通过 JNA）实现。由于缺乏维护和许多微妙的问题，RXTX 让我失望了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-02-10T18:52:07.497

Java 因其不稳定的串行 I/O 支持而臭名昭著。在之前的工作中，我们尝试将 RXTX 和 SerialIO 用于从 Teknic 伺服控制器以 56kbps 传输数据的应用程序，发现它们会大量占用 CPU。也许对于不需要从串行端口连续流式传输的应用程序，这两个库都很好，但我们不认为从串行端口流式传输 I/O 应该持续占用 15-30% 的 CPU当 JVM 中需要响应的其他线程非常需要机器时。

相反，我们用 C++ 创建了一个服务器，它将从伺服器上的串行端口读取数据流，对其进行转换/打包，然后通过套接字连接以 XML 格式将其发送到我们的 Java 应用程序。C++ 中串行 I/O 服务器上的 CPU 负载？在最坏的情况下勉强爬到 1%。

Java 在某些方面做得很好——在我看来，串行 I/O 不是其中之一，具体取决于应用程序的类型......

最终，你甚至应该对我所说的持保留态度，同时尝试 RXTX 和 SerialIO（这很便宜，Java 版本大约 50 美元），如果它们满足你的需求，那就去吧。就我个人而言，我会坚持使用 SerialIO，因为它受到支持并正在积极开发中。RXTX，没那么多。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-28T20:54:09.490

我编写了一个开源 Java 库，因为现有的 Java 库都不符合我的需求（过时、闭源、难以修改、未维护……）。

它被称为 JSerial，它是 MIT 许可的，您可以在这里了解更多信息：[https](https://github.com/thibautd/JSerial) ://github.com/thibautd/JSerial ！

目前只支持 Windows，但我有支持 Linux 的计划。如果需要，您可以使用最新的 Visual Studio 轻松修改本机部分。

# asp.net - AspNetWindowsTokenRoleProvider 在 ASP.NET 中无法正常工作以进行 Windows 身份验证

> ID：264278
> 
> 赞同：5
> 
> 时间：2008-11-05T03:31:45.880
> 
> 标签：asp.net, windows, authentication

我正在使用 Windows 身份验证的 ASP.NET 中开发 Intranet 应用程序。我创建了一个从 Active Directory 域控制器获取信息的 AD 类。这是我用来获取当前登录用户所在的用户组之类的东西。问题出在用户所在的 ASP.NET 角色中。看起来很有趣，但用户所在的 AD 组列表完全是不同于用户拥有的角色列表。

这是我得到的：

特定用户的 AD 组列表

1.  开发者
2.  账户运营商
3.  域管理员
4.  IS_IUSRS
5.  管理员

同一用户的角色列表

1.  PUDDOM\域用户
2.  每个人
3.  内置\用户
4.  内置\管理员
5.  NT AUTHORITY\交互式
6.  NT AUTHORITY\Authenticated Users
7.  NT AUTHORITY\本组织
8.  当地的
9.  PUDDOM\域管理员
10.  PUDDOM\Denied RODC 密码复制组
11.  PUDDOM\DnsAdmins

其他信息：

1.  我的网站使用来自 IIS7 的集成 Windows 身份验证。
2.  我的一部分`web.config`看起来像

这个：

```
<authentication mode="Windows"  />
<authorization>
  <deny users="?" />

</authorization>

<roleManager defaultProvider="AspNetWindowsTokenRoleProvider"  enabled="true">
        <providers>
            <remove name="AspNetSqlRoleProvider" />
        </providers>
</roleManager> 
```

如何核对列表？

我需要让我的角色列表反映与我的 AD 组列表相同的数据，因为我将在我的站点地图和其他内容中使用角色修剪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T06:28:05.667

您的部分结果是因为用户所属的某些组是其他组的成员。用户组的完整列表将包括用户所属的所有组，包括直接或通过其他组的成员身份，这些组也是成员。

该列表还将包括默认情况下通常对本机管理工具隐藏的内置组。

您最好的办法是让应用程序存储您希望应用程序查看的组的主列表，或者您希望应用程序忽略的组列表（包括列表或排除列表）。然后，当您拉回特定用户的角色时，只需将其与配置的排除或包含列表进行比较并过滤掉不需要的结果。

如果您想要更简单的方法，codeproject 上有一个开源的[AD 角色提供程序，](http://www.codeproject.com/KB/aspnet/active_directory_roles.aspx)它已经支持排除和包含列表。它还具有其他不错的功能，例如可以真正加速您的应用程序的可选缓存。内置 AD 角色提供程序的性能很差。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T05:56:48.177

您可能需要专门将网站权限分配给要枚举的组。

# c# - 系统托盘访问

> ID：264281
> 
> 赞同：7
> 
> 时间：2008-11-05T03:34:35.483
> 
> 标签：c#, .net

有没有办法（在 C# 中）访问系统托盘？我不是在谈论制作通知图标。我想遍历托盘中的项目（我会猜测进程，但我不知道如何确定托盘中实际有什么以及什么只是一个进程），并且还用我自己的图标表示这些项目ui。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T08:18:09.703

您如何看待 Win32 互操作？我找到了可能对你有用的[C/Win32 代码。](http://skyscraper.fortunecity.com/gigo/311/winprog/shellico.txt "这个 C/Win32 代码")（实际上，这看起来是一个有趣的问题，所以我可能会尝试自己解决它，但不是现在）。

神奇的是他获得了系统托盘窗口的句柄：

```
NotifyWnd = FindWindowEx(SysTray, 0, "TrayNotifyWnd", 0);
```

然后他在它的消息泵上设置了一个钩子：

```
hHook=SetWindowsHookEx(WH_CALLWNDPROC,HOOKPROC(MsgProc),
         hInstance,dwExplorerThreadId);
```

然后在消息泵挂钩回调期间，他获得了对有关窗口的一些指针数据的引用：

```
TWDataT* twd=(TWDataT*)GetWindowLong(NotifyWnd,0);
```

谜底就是他的循环：

```
 pTWIconDataT p=COMCTL32_332(twd->iconsInfo,i);
```

COMCTL32_332 是用 GetProcAddress 定义的，并指向 Comctl32.dll 的序号 332 - 根据我对 Dependency Viewer 的检查，这是[DPA_GetPtr](http://msdn.microsoft.com/en-us/library/bb775617.aspx "DPA_GetPtr")，它从动态指针数组中获取数据。我不熟悉幕后发生的事情，但这似乎并非完全不可能。

我自己会玩这个，但希望这是一个让你开始的好地方。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T04:26:27.440

Mathias Rauen 的 madCollection（对于 Delphi 而不是 c#）可以列出[Tray Icons](http://help.madshi.net/TrayIcons.htm)。

还有一个命令行工具：[Windows System Tray Scan Utility](http://exodusdev.com/products/windows-system-tray-scan-utility)

我还在 Delphi（不是 Delphi.NET）中编写（未发布）我自己的程序，不使用 madCollection，它显示托盘图标、进程名称、工具提示和其他信息，但它并不完美。有一些图标无法显示（即使它列出了其他信息），并且在 windows 9x 下无法显示任何图标。我根本没有在Vista下测试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T09:59:56.300

在 Windows 2000 中，系统托盘图标位于纯工具栏控件（窗口类“ToolbarWindow32”）中，它是“TrayNotifyWnd”窗口的子窗口，因此您可以向其发送工具栏消息，例如`TB_BUTTONCOUNT`和`TB_GETBUTTON`。

但是您需要小心：诸如 TB_GETBUTTON 之类的消息需要指向用于存储结果的缓冲区的指针，需要该缓冲区**位于 SysTray 进程本身中**。这要求您具有正确的权限，并`VirtualAllocEx`用于分配内存。

我还没有在 XP 或 Vista 上尝试过。我预计事情已经改变了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-05T11:32:00.247

在 Windows 2000/Xp 中实现它是完全可能的。不幸的是，在 Windows 7 中，这似乎不再可行。

技巧很简单：你必须找到托盘窗口句柄：

```
 static IntPtr GetSystemTrayHandle()
    {
        IntPtr hWndTray = FindWindow("Shell_TrayWnd", null);
        if (hWndTray != IntPtr.Zero)
        {
            hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, "TrayNotifyWnd", null);
            if (hWndTray != IntPtr.Zero)
            {
                hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, "SysPager", null);
                if (hWndTray != IntPtr.Zero)
                {
                    hWndTray = FindWindowEx(hWndTray, IntPtr.Zero, "ToolbarWindow32", null);
                    return hWndTray;
                }
            }
        }

        return IntPtr.Zero;
    } 
```

由于此窗口是 ToolbarWindow32，因此您必须使用 WinAPI 枚举整个按钮。唯一的问题是用于此的所有结构都应分配在目标进程地址空间中，因此您必须使用以下内容：

```
 private static unsafe bool GetTBButton(IntPtr hToolbar, int i, ref TBBUTTON tbButton, ref string text, ref IntPtr ipWindowHandle)
    {
        // One page
        const int BUFFER_SIZE = 0x1000;

        byte[] localBuffer = new byte[BUFFER_SIZE];

        UInt32 processId = 0;
        UInt32 threadId = User32.GetWindowThreadProcessId(hToolbar, out processId);

        IntPtr hProcess = Kernel32.OpenProcess(ProcessRights.ALL_ACCESS, false, processId);
        if (hProcess == IntPtr.Zero) { Debug.Assert(false); return false; }

        IntPtr ipRemoteBuffer = Kernel32.VirtualAllocEx(
            hProcess,
            IntPtr.Zero,
            new UIntPtr(BUFFER_SIZE),
            MemAllocationType.COMMIT,
            MemoryProtection.PAGE_READWRITE);

        if (ipRemoteBuffer == IntPtr.Zero) { Debug.Assert(false); return false; }

        // TBButton
        fixed (TBBUTTON* pTBButton = &tbButton)
        {
            IntPtr ipTBButton = new IntPtr(pTBButton);

            int b = (int)User32.SendMessage(hToolbar, TB.GETBUTTON, (IntPtr)i, ipRemoteBuffer);
            if (b == 0) { Debug.Assert(false); return false; }

            // this is fixed
            Int32 dwBytesRead = 0;
            IntPtr ipBytesRead = new IntPtr(&dwBytesRead);

            bool b2 = Kernel32.ReadProcessMemory(
                hProcess,
                ipRemoteBuffer,
                ipTBButton,
                new UIntPtr((uint)sizeof(TBBUTTON)),
                ipBytesRead);

            if (!b2) { Debug.Assert(false); return false; }
        }

        // button text
        fixed (byte* pLocalBuffer = localBuffer)
        {
            IntPtr ipLocalBuffer = new IntPtr(pLocalBuffer);

            int chars = (int)User32.SendMessage(hToolbar, TB.GETBUTTONTEXTW, (IntPtr)tbButton.idCommand, ipRemoteBuffer);
            if (chars == -1) { Debug.Assert(false); return false; }

            // this is fixed
            Int32 dwBytesRead = 0;
            IntPtr ipBytesRead = new IntPtr(&dwBytesRead);

            bool b4 = Kernel32.ReadProcessMemory(
                hProcess,
                ipRemoteBuffer,
                ipLocalBuffer,
                new UIntPtr(BUFFER_SIZE),
                ipBytesRead);

            if (!b4) { Debug.Assert(false); return false; }

            text = Marshal.PtrToStringUni(ipLocalBuffer, chars);

            if (text == " ") text = String.Empty;
        } 
```

不幸的是，在 Windows 7 中 tbButton.dwData 等于 0，因此您找不到 NotifyIcon 和目标进程之间的任何关联

# asp.net - ObjectDataSource 抛出异常

> ID：264286
> 
> 赞同：4
> 
> 时间：2008-11-05T03:40:17.593
> 
> 标签：asp.net, visual-studio-2008, objectdatasource

我正在使用一个 ASP.NET 页面`GridView`和一个`ObjectDataSource`.

我想针对我的业务层中的一个类（用 DataObject() 装饰）配置 ObjectDataSource。以非常相似的方式设置的许多其他课程。我选择了该类并单击 Next 以选择 SelectMethod 的函数，但它在没有警告和任何错误的情况下关闭。

我可以`TypeName`为设置`ObjectDataSource`并将其附加到`GridView`. 我尝试了`Refresh Schema`，但弹出一个错误：

> 调用“刷新架构”时出错。详细信息：调用的目标已引发异常。

我可以手动设置`ObjectDataSource`，但我天生懒惰，更喜欢使用 GUI。

为什么会失败？

一切都很好。我可以手动连接所有内容，页面运行良好。然而，当我去配置`ObjectDataSource`UI 时它仍然失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-07-29T17:52:58.260

ODS 控件有一些先决条件才能正常工作，`Exception has been thrown by the target of an invocation.`如果其中一些配置不正确，则会抛出该泛型。以下是一些尝试解决问题的方法：

1.  绑定到 ODS 控件的类*必须*具有不带任何参数的默认空构造函数。重载也可以，但至少要有一个默认的空构造函数；确保这存在。

2.  如果该类存在于包含 ODS 的 UI 项目所引用的另一个项目中，则 ODS 可能会从其绑定类中脱离出来。确保完全清理并重新构建解决方案，以便 ODS 向导可以读取当前的类模式。

3.  尝试删除 ODS（将源中 IDS 中的任何自定义属性保存到记事本中，以便稍后逐项添加）并添加一个新属性。添加新的 ODS 后，使用 Wizzard 指向您想要的类并查看它是否有效。

# linux - 如何发现正在使用的 Linux 发行版

> ID：264290
> 
> 赞同：26
> 
> 时间：2008-11-05T03:41:39.823
> 
> 标签：linux, operating-system

有时我需要访问一些运行 Linux 的服务器（或者可能是另一个类似 Unix 的 SO），但我不知道如何验证服务器上正在使用哪个[发行版](http://en.wikipedia.org/wiki/Linux_distribution)（有时甚至是服务器的“负责人”不知道）。

是否有一种简单可靠的方法来发现这一点，并且在所有这些方法中都是统一且一致的？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-05T03:48:49.980

`lsb_release -i`可能对你有用。

更多详细信息可通过`lsb_release -a`

[在http://etbe.coker.com.au/2007/08/30/identifying-the-distribution-of-a-linux-system/](http://etbe.coker.com.au/2007/08/30/identifying-the-distribution-of-a-linux-system/)进行一些讨论

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-11-05T03:52:12.330

```
cat /etc/*release 
```

`/etc/`大多数发行版都会在（如`/etc/redhat-release`、等）中放置一个发布文件，`/etc/gentoo-release`其中通常包含您的发行版的版本号。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-05T04:17:04.883

令人讨厌的是，这是一个比看起来更难的问题。

对于 Linux 系统，使用 lsb_release。

```
$ lsb_release --all
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 8.04.1
Release:        8.04
Codename:       hardy
$ lsb_release -i
Distributor ID: Ubuntu 
```

这具有 lsb_release 仅适用于 Linux 版本的限制。

对于所有的 Unix 系统，你也可以解析 uname。

```
$ uname -a
Linux blue-laptop 2.6.24-21-generic #1 SMP Tue Oct 21 23:43:45 UTC 2008 i686 GNU/Linux 
```

[您可以在uname Wikipedia 页面](http://en.wikipedia.org/wiki/Uname)上找到有关系统和发行版的一些信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-05T05:25:24.997

您应该问自己是否真的需要知道正在使用哪个发行版（可能是因为您想为这个发行版构建一个特定的包）。在许多其他情况下，这是一个更好的主意，只需测试并查看您需要的功能是否存在。这可能看起来需要做更多的工作，因为您必须逐个测试每个功能，但是这样，您的软件就会变得更加灵活。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-04T11:00:51.707

您可以使用不同的命令来检查正在使用的发行版。这里我只提到其中的 5 个。

1.  > lsb_relase -a

`lsb_release`提供特定于分布的信息。而`-a`显示有关分布的所有信息。您也可以使用`-d`which 仅显示描述。

2.  > unname -a

`uname`还提供系统信息。而`-a`显示所有信息。您可以使用`man uname`其他选项。

3.  > 猫 /etc/*释放

您还可以使用`cat`命令从**etc**文件夹中打印出所有特定的发布信息。该命令实际上是从**/etc**文件夹中读取**lsb-release**和**os-release**文件。

 **4.  > 猫 /etc/问题

此命令从**/etc**文件夹中读取**问题**文件。

 **5.  > 猫 /proc/版本

此命令从**/proc**文件夹中读取**版本**文件。**/proc**文件夹包含有关系统进程的信息。

 ***** * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T04:01:49.690

在我的`.cshrc`我有

```
setenv DISTRO `sed -e 's/.*(//' -e 's/)).*//' /proc/version` 
```

对于[ksh](http://en.wikipedia.org/wiki/Korn_shell) / [Bash](http://en.wikipedia.org/wiki/Bash_%28Unix_shell%29)用户，我认为它转换为

```
export DISTRO=`sed -e 's/.*(//' -e 's/)).*//' /proc/version` 
```

当然，这可能不适用于您最喜欢的发行版。（我在[Oracle 的 Unbreakable Linux](http://en.wikipedia.org/wiki/Oracle_Linux#RHEL_compatibility)上遇到了一些问题，它提供了类似于 Redhat 的东西，但对于我的目的来说已经足够了。）

**2016 年 8 月更新**我有一段时间没有以这种方式使用 Linux（2008 年是很久以前的事了）。对于我现在拥有的系统，这似乎不再适用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-05T05:03:10.953

我发现 /etc/issue 通常与正在使用的发行版有关。

但我不知道它在所有发行版上的可用性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-06-17T10:28:00.063

[proc 文件系统](http://en.wikipedia.org/wiki/Procfs)：Linux 中包含所有硬件级别信息的目录。所以只需输入

```
cd /proc/ 
```

在那里，您会发现存储在文本文件中的信息金矿，其中包含有关系统的所有任意信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-05T03:44:48.520

你可以使用'uname'：

```
[anton@localhost ~]$ uname -a
Linux localhost 2.6.26-ARCH #1 SMP PREEMPT Tue Aug 26 21:15:43 UTC 2008 i686 AMD Athlon(tm) 64 Processor 3000+ AuthenticAMD GNU/Linux 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-05T03:46:47.393

```
uname -r 
```

应该打印当前运行的内核版本（至少，它适用于 Linux，不知道它是否与 *BSD 或其他相同）。这与发行版不同，但内核版本通常包含定制的发行版名称，例如“2.6.27-gentoo-r1”或其他内容。

Init 经常在启动时打印一些东西，但是当它运行时这并不是很好。

否则，据我所知，没有任何普遍性。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-07-10T09:31:42.650

## NeoFetch

... 是一个非常专业的**BASH 脚本**，它应该包含您可能想要的所有信息。

（*免责声明：*我不隶属于它）

### 用法

```
neofetch --stdout | grep '^OS: ' | sed -e 's/OS:[[:space:]]\+//' 
```

可能会给：

> Debian GNU/Linux 11（靶心）x86_64

但还有更多信息。

### 安装

选项：

1.  系统包`neofetch`

2.  如果不可用，请参阅[官方安装说明](https://github.com/dylanaraps/neofetch/wiki/Installation)

3.  或者一次性使用——如果你有信心和互联网连接——你可以使用：

    ```
    wget 'https://raw.githubusercontent.com/dylanaraps/neofetch/master/neofetch' \
        && bash neofetch --stdout \
        && rm neofetch 
    ```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2008-11-05T03:43:33.890

尝试`uname -a`

# c# - 独立开发人员的最佳持续集成设置 (.NET)

> ID：264307
> 
> 赞同：56
> 
> 时间：2008-11-05T03:53:37.130
> 
> 标签：c#, .net, asp.net, continuous-integration

我正在寻找一个轻量级、易于设置的 CI 服务器，可以在我的笔记本电脑上与 Visual Studio 和 Resharper 一起运行。显然，我正在关注 CruiseControl、TeamCity 等所有知名品牌，但对我来说最大的考虑是易于设置和较小程度的内存占用。

编辑：我还想对大 2/3 之外的其他解决方案提出一些建议......

编辑：如果没有其他人要添加任何内容，我将接受答案？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-05T04:06:07.293

我使用[TeamCity](http://www.jetbrains.com/teamcity/)，并且非常非常容易设置和运行。

检查[演示和文档](http://www.jetbrains.com/teamcity/documentation/index.html)。您将在不到一小时的时间内启动并运行它！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-05T07:39:42.760

我刚刚开始使用 CruiseControl.NET。

在没有任何先验知识的情况下，我能够在几个小时内使用 MSBuild、M​​STest 和 Team Foundation Server（即 CodePlex）通过单个测试项目启动并运行它。我在这里发布了一堆有用资源的链接[Devsta 2008 Day 0: Source Control and CI](http://codermike.com/devsta-2008-day-0-source-control-and-ci)

由于我的项目很小，我无法帮助解决内存占用问题。我可以告诉你，虽然它没有做任何事情（即大部分时间），但它在我的系统上使用了大约 5MB。事实上，它附带的托盘图标通知程序比服务占用更多的内存，大约为 6MB。当然，当它做一些事情时，它会上升。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-22T08:29:57.510

[Hudson](http://wiki.hudson-ci.org/display/HUDSON/Meet%2BHudson)（更新：[Jenkins](http://jenkins-ci.org/) ¹）非常容易设置，与 CruiseControl 相比，在其中管理工作（项目）无疑是一件轻而易举的事。它也适用于独立开发人员。

有关更多信息，请参阅[有关在 .NET 环境中专门使用 Hudson 的答案](https://stackoverflow.com/questions/616149/how-and-why-do-i-set-up-a-c-build-machine/616230#616230)。

( ¹关于 Hudson/Jenkins 情况的背景信息：[如何在 Hudson 和 Jenkins 之间进行选择？](https://stackoverflow.com/questions/4973981/how-to-choose-between-hudson-and-jenkins) )

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-05T04:32:31.437

为了易于使用，我发现 CruiseControl.Net 非常简单。现在谈到内存占用，我不得不说它确实破坏了我的系统。 **也就是说**，同时托管 CruiseControl.Net 的开发框并不是一个好方法。不幸的是，这就是我过去使用它时所能访问的全部内容。

我无法与其他工具交谈。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T12:37:45.700

我使用 CI 作为一个单独的开发者。

当我将我的 dev 分支合并到我的测试分支时，CI 抓取代码，编译它，修改连接字符串，更改一些应用程序设置，并通过[Beyond Compare](http://www.scootersoftware.com)将其复制到我的测试站点，供测试人员查看.

# regex - 人们为什么要捍卫正则表达式语法？

> ID：264309
> 
> 赞同：10
> 
> 时间：2008-11-05T03:56:04.800
> 
> 标签：regex, syntax

有一个类似的问题，但它只是得到了人们总是给出的关于正则表达式语法的相同旧答案，但这不是这里的重点，所以请尽量不要下意识地使用关于正则表达式语法的相同旧答案。这次尝试更加原创和个性化。

正则表达式语法非常紧凑，几乎太紧凑以至于不好。它就像代码打高尔夫球，每个人都同意打代码在生产代码中不是一件好事。然而，大多数人接受正则表达式语法，这似乎......至少可以说是矛盾的。

因此，现在人们可能会听到一些常见的防御措施，包括：

*   *答*：很紧凑

*   *Counter* : 在这个时代，我们不是都同意代码应该是识字的，并且像“client”这样的变量比“c”更好吗？

*   *答*：这是一种“特定领域的语言”

*   *计数器*：所有非常容易理解、非紧凑、非神秘和我敢说漂亮的领域语言，比如 SQL 或 LINQ，怎么样？

*   *答*：知道了就很容易理解了。

*   *Counter* : 大多数优秀的语言都很容易理解，即使您以前从未使用过它们。例如，任何人都可以很容易地跳入 Python，即使他们以前从未见过它。为什么人们在正则表达式如此难看的时候为它辩护，然后继续抱怨 Lisps 括号？

好的，现在每个人都尝试在这里保持原创和诚实，不要只是拿出 20 年前程序员用来设计正则表达式的老生常谈的答案。除非你真的相信它们是当今时代的有效命题。

* * *

**编辑：**为了记录，我从几年前就知道正则表达式，即使在今天也经常使用它们，甚至可能会摸索它们。然而，我突然有一种感觉，也许是时候重新考虑我认为关于正则表达式的“真相”了，并从现代的角度来看它们。主要是因为质疑原则是进一步发展的必要条件，而且因为很多新人对他们的强烈抱怨，他们不能一概而论，所以我决定试着站在一个新人的角度考虑一下有什么好的地方反对正则表达式。

至于**主观性**，我不认为这比当时的**程序员笑话**更主观或更少与程序员相关。相反，它与程序员非常相关。

至于**争论**，这就是问题的重点。为了获得好的论点赞成和反对正则表达式过时的语法，这可以让新手真正了解更多关于为什么正则表达式是它们的原因，甚至更好地希望让一些新手想出一个更好的解决方案，因为我们老思想看不到被正则表达式的“酷”蒙蔽了双眼。

* * *

**引用：**

> 正则表达式的 Perl 5.10 文档已经融化成一堆不可读的乱码，因为语法中出现了许多滑稽的特性，以至于没有人可以再为它编写合理的文档了。

你是想说正则表达式变得不可维护？那么作为优秀的程序员，我们应该考虑重构它们吗？也许像我们对许多其他技术所做的那样清理和尝试？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-11-05T05:04:23.213

我要说的大部分内容都由 Adam 和 DGM 解决，但我认为他们没有很好地涵盖你的第二点。

“所有非常容易理解、不紧凑、不神秘并且我敢说漂亮的领域语言，比如 SQL 或 LINQ，怎么样？”

我认为表达这个问题的一个好方法是问，你会如何用英语来解释正则表达式？

```
<TAG\b[^>]*>(.*?)</TAG> 
```

寻找“<TAG”一个单词边界零个或多个不是'>'的东西，后跟一个'>'记住零个或多个东西，停在第一个“</TAG>”

这是一个相当简单的正则表达式。英文表格真的更容易理解吗？你能做得更好吗？

正则表达式很难阅读，但你想从它们那里得到什么也很难解释。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-11-05T04:00:42.903

看看问题的另一面：你将如何设计一种新的语法来体现正则表达式的所有特性、一致性、简洁性和健壮性，但对程序员更友好？

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-11-05T04:29:32.893

你的反驳是似是而非的。你知道正则表达式语法，还是从无知的角度争论？建立你的偏见很重要。

*   这根本不像打代码打高尔夫球。我不确定你在那里的联系。为什么不抱怨指针或其他使用相同参数的东西呢？

*   正则表达式的紧凑性与糟糕的变量名无关。一个名为 c 的变量可以是任何东西。正则表达式语法既不模棱两可也不含糊。它准确地描述了它的模式。

*   这是一个DSL。那么如果是呢？你有没有试过用 SQL 做复杂的事情？这也是一个大麻烦。做同样的事情需要更多的打字和更多的语法并不能改善这种情况。我教过的大多数人都遇到了正则表达式的问题，因为他们不习惯思考和设计模式，而不是因为语法是异国情调的。

*   一旦你知道它就很容易理解。嗯，是的。电动工具并未针对新手或不愿学习的人进行优化。我不抱怨 Lisp 括号，但我不介意正则表达式语法。

如果您不想使用正则表达式，请不要使用。使用字符串操作函数或解析器。使用其他工具。当你忙于那个时，我将在你面前解决十个问题，因为我不会逆流而上，也不会将我无法完成的工作归咎于工具。

你想完成多少工作取决于你。找到让你最快到达那里的工具并学习它。如果你不喜欢那样，发明一些更好的东西。在那之前，停止抱怨。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-11-05T04:28:47.153

这实际上是美国退休程序员协会针对当今在 Python 和 Java 上咬牙切齿的年轻人的阴谋。我们需要对神秘主义者保持敬畏和尊重，他们的聪明才智用三字符助记符克服了微小核心记忆和神秘语言的挑战……并且*喜欢*它。上坡……双向……在雪地里。:-)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-11-05T04:14:44.577

我会捍卫正则表达式语法，因为它（大致）与我在学习算法和机器课程时学到的符号相匹配。这是一种生成机器以摄取指定常规语言的简单方法。

正则表达式语法就是这样，因为它确实是您完全描述您正在寻找的行为所需要的一切。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-11-05T04:14:17.713

有用！！
如果有一种易于阅读的语言在每种主要编程语言中都有扩展，并且有充分的文档记录和测试，并且不像正则表达式那样压缩，但也不太冗长（冗长 = 烦人），我很想知道更多关于它的信息

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-11-05T05:26:04.790

正则表达式的一些问题不是语言本身，而是人们试图使用它们的目的。当他们真正想要的是一个相当简单的解析器时，他们会写一行又一行的正则表达式。

正则表达式非常适合简单到中等复杂的子字符串匹配和数据提取。但是在某些复杂点上，您只需要抽出编译器 - 编译器并编写一个真正的解析器。我认为很多人没有意识到正则表达式主要用于匹配，而不是用于解析。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-11-05T04:18:56.377

您应该将正则表达式视为高端电动工具（我指的是建筑行业意义上的电动工具）。

如果你正在为你的棚子建造一个小工作台，你不会拔出射钉枪、电锯和工业路由器。你用一把锯子，一些钉子和一把锤子。

同样，您不会在某处没有起重机的情况下建造 30 层楼的建筑物。

我们的想法是为工作使用正确的工具，并**为**您的技能水平使用正确的工具。

如果您必须砍伐一棵树，请确保在启动电锯之前了解所有有关回扣的知识。如果您不这样做，请改用手锯，省去去医院重新连接断肢的机会。

我像使用电锯一样使用正则表达式——非常小心。如果您对该工具感到不舒服，请不要使用它。一旦你学会了如何正确使用它，你会发现更快地完成工作会容易得多。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-11-06T01:03:54.260

其他人已经暗示了这一点，但需要明确说明：

*常规语言不像编程语言。它们更接近数学符号。*

紧凑性和古怪性更多是由于试图从 ASCII 字符中强制使用精确的符号，而不是故意尝试简洁或混淆。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-11-05T04:00:27.180

正则表达式的另一个问题是它有很多口味。.Net regex vs php regex vs 其他 regex，看起来都一样，但结果不一样（有时根本没有结果）。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-11-05T05:43:07.613

我认为类似 SQL 的正则表达式语言将是一个令人着迷的项目。我很想看到有人创造它。

为什么*没有*一种可以写作的语言

`LOOK FOR "<TAG"`

`THEN WORDBOUNDARY THEN ZERO-OR-MORE NOT('>') FOLLOWED-BY '>'`

`THEN ZERO-OR-MORE SOMETHING REMEMBERED`

`THEN NEAREST "</TAG>"`

我不确定谁是目标受众——我不认为我会使用它，因为我一直在学习正则表达式。

当然，“需要使用如此复杂的表达式的人”几乎映射到每天必须处理同样复杂的事情的程序员？

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-11-05T16:23:13.967

Pyparsing ( [http://pyparsing.wikispaces.com/Examples](http://pyparsing.wikispaces.com/Examples) ) 是一个 Python 库，它可以轻松编写具有高度可读性的类似正则表达式的表达式，例如这些将解析“Hello, World!”的行：

```
from pyparsing import Word, alphas
greet = Word( alphas ) + "," + Word( alphas ) + "!"
greet.parseString("Hello, World!") 
```

看起来该库非常接近能够匹配正则表达式的功能（请参阅上面提到的示例页面）。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-11-05T15:49:14.597

它们类似于 BNF 表示法等，是许多良好语言规范的基础。因此，在词法分析器中使用这样的符号来表示预期字符的类别是有道理的。基本符号真的没有那么神秘。

然后我认为 UNIX-do-all-you-can-in-a-single-line 的想法占据了主导地位。在 sed 和 grep 脚本改进之后，正则表达式获得了新的权力，但它们的简写外延。Larry Wall 将它们合并到 Perl 中，作为解析文本的通用工具。我猜它保留了对于 perl 仍然很重要的 oneliners 的紧凑性。并且有通用字符类的简写名称，甚至更多的权力被要求和给予正则表达式。当然，由于 Perl 也是一种模块语言，因此正则表达式语法也适用于语句块，并且它利用了更广为人知的语法。

IMO 将它们纳入 Java 确实是人们关注它们的原因。Java 没有采取任何措施来适应它们。结果，中等难度的反斜线表达式变成了密集的反斜线丛林。如果你愿意的话，Java 给了正则表达式一个新的市场，但它是它们最残暴的形式。如果您已经看过这些并且没有更多关注，您可能会认为正则表达式是不应该的事情。

有趣的是，对于 Ambrose 的冗长版本，如果语法足够清晰，有人可以为 Perl 提供一个模块，该模块可以采用冗长的正则表达式并将其“编译”成 Perl 可以理解的紧凑正则表达式，通过使用更简单的正则表达式`overload::constants`或者可能是`Parse::RecDescent`语法.

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-11-05T04:36:03.910

就是这样……正如您正确指出的那样，主要是出于传统原因。现在

*   **再培训和重组**：它已经获得了大量的追随者，即使有人愿意，它的根基也已经变得太深而无法进行大修。人们已经学会了神秘的规则，并开发了他们的技巧、社区和工具包（我插入 Expresso）。
*   **广泛的支持：当前的语法在平台上得到了广泛的支持。***即使你不考虑编写自己的引擎和处理所有边缘情况的艰巨任务，*重写这种支持水平也是一项艰巨的任务
**   **Reg Exp 不太可能改变**最后也是最重要的，RegExp 不能等同于代码的可读性。就我个人而言，我谨慎地使用正则表达式并进行快速切口，其优点大于好处。（例如，将客户的 Excel 电子表格刮成由开发人员设计的 XML 格式的内部工具。） 正则表达式不需要维护和修改.. 如果它非常复杂.. 用注释掩盖气味（和它应该只有一次）。如果您发现正则表达式被定期修改（或者如果您的工作场所没有其他人知道正则表达式），那么这可能是一个糟糕的选择，您应该切换到常规代码。*

 *就我个人而言，我发现正则表达式（至少是日常任务所需的部分）很容易掌握.. 一天或 2 天。高级的东西很难（MasteringRegExp 书的后半部分），但你也不需要那么频繁。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-11-05T16:09:42.247

正则表达式（至少最初是这样）描述了一种正则语言。正则语言具有非常好的理论特性，因为它们都可以通过确定性有限自动机来描述和描述。非平凡正则表达式的 DFA 很难手工编写代码。

更重要的是，perl等后端使用的正则表达式编译器非常擅长它们的工作。手动调整有竞争力的代码是非常困难的。

最后，它们的存在很大程度上是一个历史产物。他们已经存在了很长时间，获得了思想份额，很多人都认识他们。您拥有并且其他人可以支持的工具比尚不存在的理论工具要好得多。

如果只是语法让您失望，也许您应该考虑查看 Haskell 中的解析器组合器。它们可以表达相同想法的超集，并具有更明确的语法。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-11-05T15:57:21.460

查看您提到的类似问题及其答案，我看到了一些尝试创建“更友好”的替代语法的尝试，来自我们今天所知道的正则表达式的支持者和批评者。

我发现它们比等效的正则表达式更易读。

现在，当然，我是正则表达式的常规用户，所以我确信我对它们的舒适度是其中的重要部分。但我对它们的主要问题不是不熟悉，而是它们很快变得太大而无法一次全部吸收。当你的 20 个字符的正则表达式变成一个 10 行 x 30 列的伪英语表达式时，就很难看出它的各个部分是如何相互关联的。

也许有人会想出一种替代正则表达式的语法，即使在复杂的情况下，它也更易于阅读，但我认为这种语法本质上需要一些与子例程调用等效的语法。我们不会编写具有 15 层嵌套逻辑的 200 行应用程序代码块，因为仅跟踪其逻辑将是一项艰巨的任务，更不用说弄清楚它实际上做了什么。如果我们要将正则表达式分解成更类似于英语的形式，那么同样的问题也会发生，我们需要同样的工具来管理它。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-11-05T04:15:09.943

就像亚当说的，还有什么更好的吗？想到尝试做一堆 strcmp 操作而不是一个好的正则表达式，我不寒而栗。像任何表达性语言一样，可能会滥用正则表达式并制作非常不可读的结构，但通常即使是看似不可读的正则表达式也比实现相同目的的等效程序代码更有意义。

如果没有正则表达式，您必须编写自己的例程来解析、回溯、比较、存储索引、进行替换和管理所有结果。正则表达式以非常富有表现力的形式为您提供所有这些。我不喜欢重复代码，但是如果每次我需要寻找一个中等复杂的模式时我都必须编写自己的解析器......我不知道我会做什么。

是的，有不同风格的正则表达式，但大多数最流行的非常相似，而且无论您使用哪种语言，通常都有帮助您阅读的文档。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-05-31T04:14:32.570

来自 perl 模块[Regexp::English](http://search.cpan.org/~chromatic/Regexp-English-1.01/lib/Regexp/English.pm)：

> Regexp::English 提供了另一种正则表达式语法，它比标准机制稍微冗长。此外，它还添加了一些方便的功能，例如增量表达式构建和绑定捕获。

```
 use Regexp::English;

    my $re = Regexp::English
            -> start_of_line
            -> literal('Flippers')
            -> literal(':')
            -> optional
                    -> whitespace_char
            -> end
            -> remember
                    -> multiple
                            -> digit;

    while (<INPUT>) {
            if (my $match = $re->match($_)) {
                    print "$match\n";
            }
    } 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-11-29T15:23:42.137

我敢打赌，本次讨论的所有参与者都会同意，对于某些**小**的正则表达式代码，必须用英文写一长段来描述它的作用。任何一种可以用来做即使是最简单的正则表达式描述的语言都可能用 N 行代码来完成，其中 N（可能）与正则表达式本身的长度相比呈指数增长。

# java - 查找操作性能

> ID：264312
> 
> 赞同：1
> 
> 时间：2008-11-05T03:57:15.097
> 
> 标签：java, performance, imaging

我试图从我的渲染管道中挤出更多的性能。（到目前为止）最慢的部分是在大图像上执行 java.awt.imaging.LookupOp。

图像大小约为 2048x2048。

我发现在绘图操作中完成过滤器比调用过滤器方法要快得多。然而，这仍然给我们留下了大约 250 毫秒（或 4 fps）的查找操作。有人有任何渲染技巧吗？

这基本上是我们正在做的事情：

```
public void paint(Graphics g)
{
    if(recalcLUT)
    {
        Graphics2D g2d = (Graphics2D) displayImage.getGraphics();
        g2d.drawImage(srcImage, lut, 0, 0);
    }

    Graphics2D g2d = (Graphics2D) g;
    g2d.clearRect(0, 0, this.getWidth(), this.getHeight());
    AffineTransform at = new AffineTransform();
    at.setToIdentity();
    at.scale(scale, scale);
    g2d.drawImage(displayImage, at, null);
} 
```

lut 变量是 LookupOp 通常是 ShortLookupOp，图像是 16 位灰度图像

谢谢

[瑞恩布彻：](https://stackoverflow.com/users/27818/ryan-boucher "瑞安·布彻")

我知道还有一些其他明显的性能优化可以在这里完成。但主要问题只是进行 LookupOp 操作，所以我正在寻找这方面的建议。

Lookup Ops 本质上是创建数组的地方，而不是将图像的每个像素渲染为其颜色，而是将颜色用作数组的索引并将颜色渲染为索引中的值。在这个特定的例子中，我用它来做一些简单的亮度/对比度操作。您也可以使用 rescaleOp 来实现这一点，这本质上是一种将线性函数应用于所有像素值的方法。但事实证明这会更慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T14:38:51.243

我已经有近八年没有使用过 java 了，所以有些语法可能无关紧要。

任何关于循环的性能的关键是将尽可能多的东西推到循环之外。如果你不能，那么只有在它们发生变化时才执行计算。通常最好等到最后一分钟再重新计算，这样您就可以缓存多个更改。

1.  将所有对象构造移到渲染循环之外。如果您事先知道需要多少个对象，则将它们传递进去；如果您不使用对象池并让工厂在渲染循环之外创建对象。这将为您节省建造/破坏时间。

2.  仅在比例发生变化时计算您的 AffineTransform。将其推到绘制循环之外并将其传入（作为 const 参考......它们甚至存在于 Java 中吗？我在 C++ 中已经太久了）

3.  您可能不需要调用 at.setToIdentity() 因为您的 AffineTransform 应该默认为 Identity 矩阵（检查此）

4.  recalcLUT 是否需要每帧调用一次？执行 if 语句后将 recalcLUT 设置为 false 是否有意义？

我不确定 LookupOp 的目标是什么。如果你给我更多关于它在做什么的信息，我可能会提出更多建议。

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T15:23:39.767

您是否有能力将此处理推送到 GPU 上？多个硬件管道将显着加快处理速度。

如果你不能，那么你应该考虑在 CPU 上并行化 LookupOp。据我了解，每次查找都可以单独完成。因此，您可以启动多个线程（多少取决于您的 CPU Arch 以及同时发生的其他事情）并让每个线程查找图像的一部分。在每次更新运行时，您都需要一个信号量来等待所有线程完成。

在任何一种情况下，您都应该执行以下操作来权衡没有变化的每一帧的一些内存消耗。除非您的帧速率受到限制，否则您的帧数越多，没有任何变化的机会就越大。这将节省您做不必要的工作。

```
//Has filter or source image changed?
//   yes, recalculate filter and cache
//   no, render cached image 
```

最后，您是否了解 LookupOp 的实现？它在做什么，是否可以通过自己编写实现来收集任何性能增强（这应该是最后的手段）。

# mfc - CArchive 可以从文件的指定位置读写吗？

> ID：264317
> 
> 赞同：3
> 
> 时间：2008-11-05T04:02:55.473
> 
> 标签：mfc, carchive

我想将对象列表序列化和反序列化到文件中。但是我发现如果我使用CArchive，新的内容会覆盖文件中的原始内容，这不是我的预期。有什么方法可以让我从文件中的指定位置读写？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T15:36:28.147

CArchive 有一个 c'tor 将 ptr 带到 CFile。也许如果您将当前指针设置正确的文件传递给它，它就会成功。

# c++ - vb.net byte[] 到 C++ char*

> ID：264318
> 
> 赞同：2
> 
> 时间：2008-11-05T04:02:57.487
> 
> 标签：c++, vb.net, interop, marshalling

我正在调用一个非托管 C++ dll，它需要一个 char* 作为其参数之一，我想将一个 byte[] 推入其中。该项目是用 VB.NET 编写的。

什么类型的编组将为此工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T08:25:56.753

如果您需要固定托管结构以便将其作为参数传递，您可以使用以下代码。

```
 // (c) 2007 Marc Clifton
    /// <summary>
    /// A helper class for pinning a managed structure so that it is suitable for
    /// unmanaged calls. A pinned object will not be collected and will not be moved
    /// by the GC until explicitly freed.
    /// </summary>

    internal class PinnedObject<T> : IDisposable where T : struct
    {
        protected T managedObject;
        protected GCHandle handle;
        protected IntPtr ptr;
        protected bool disposed;

        public T ManangedObject
        {
            get
            {
                return (T)handle.Target;
            }
            set
            {
                Marshal.StructureToPtr(value, ptr, false);
            }
        }

        public IntPtr Pointer
        {
            get { return ptr; }
        }

        public int Size
        {
            get { return Marshal.SizeOf(managedObject); }
        }

        public PinnedObject()
        {
            managedObject = new T();
            handle = GCHandle.Alloc(managedObject, GCHandleType.Pinned);
            ptr = handle.AddrOfPinnedObject();
        }

        ~PinnedObject()
        {
            Dispose();
        }

        public void Dispose()
        {
            if (!disposed)
            {
                if (handle.IsAllocated)
                    handle.Free();
                ptr = IntPtr.Zero;
                disposed = true;
            }
        }
    }
} 
```

然后，您可以使用 PinnedObject.Pointer 调用非托管代码。在您的 extern 声明中，使用 IntPtr 作为该参数的类型。

```
PinnedObject<BatteryQueryInformation> pinBatteryQueryInfo = new PinnedObject<BatteryQueryInformation>();
pinBatteryQueryInfo.ManangedObject = _structBatteryQueryInfo;
Unmanaged.Method(pinBatteryQueryInfo.Pointer); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-21T13:52:49.437

在您的 PInvoke 定义中，只需将 char* 参数声明为 byte[] ，标准编组器将处理工作。

但这可能是也可能不是最好的主意。C++ 函数需要一个字符串还是需要一个数据缓冲区（C/C++ 代码经常使用 char* 作为缓冲区，依赖于 char 是一个字节的事实）？

如果它是一个缓冲区，那么 byte[] 肯定是正确的，但如果它需要一个字符串，那么如果将参数声明为字符串（要明确）并使用 Encoding.ASCII.GetString() 转换byte[] 到一个字符串。

此外，如果它的 C++ 函数需要一个字符串，并且您决定将参数声明为 byte[]，请确保字节数组以零结尾，因为 C/C++ 就是这样确定字符串的结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T04:45:54.593

我不是 .net 专家，但我最近需要做一些类似的事情。

这不仅仅是序列化的问题，你还必须阻止垃圾收集器在 C++ 领域使用它时清理你的字节数组......

下面的 C# 片段应该会有所帮助。

```
// 固定 byte[] (byteArray)  
GCHandle 句柄 = GCHandle.Alloc(byteArray, GCHandleType.Pinned);   
IntPtr 地址 = handle.AddrOfPinnedObject();  
// 使用地址指针做你的 C++ 工作。

// 清理
处理.Free();
```

# svn - SVN递归删除

> ID：264323
> 
> 赞同：23
> 
> 时间：2008-11-05T04:12:33.817
> 
> 标签：svn

有没有办法删除一个文件夹，让我们从 SVN 中继递归地调用它 FolderX？谷歌上的快速搜索只告诉我如何递归删除所有 .svn 文件夹，这不是我想要做的

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-05T04:29:13.470

在 posix 系统上尝试以下操作：

```
find ./ -name "FolderX" | xargs svn delete --force 
```

这将查找从当前目录开始的所有匹配文件/文件夹并对它们执行操作，即 svn delete。尽管没有 cygwin，但我不确定如何在 Windows 中执行此操作。

对于win32，下面的评论者提出了类似的解决方案（cmd）：

```
for /R . %1 in (*.EXT) do svn delete %1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T06:12:13.623

`svn delete FolX --force`即使子树中有未版本化的文件，也应该这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-29T16:36:30.123

```
find . -name ".svn" -exec rm -rf {} \; 
```

来源：[递归 SVN 删除](http://www.commandlinefu.com/commands/view/902/delete-all-.svn-directories-from-current-path-recursive)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-26T14:39:39.083

我创建了一个 SH 以作为“rm”通用轻松运行。

*   在“/usr/bin”中，我创建“ **rm_svn_dirs** ”文件，放入：

`#!/bin/bash`

`if [ $\# -eq 0 ] ; then`

```
 echo
    echo "Path not found"
    echo "Use:"
    echo "    $0 path"`
    echo "    $0 /var/www/test/svn/website"
    echo "    $0 ."
    echo "Operation cancelled"
    echo
    exit 1
fi

echo 
echo "Recursively delete .svn directories in:"
if [ $1 != "." ] ; then
    echo $1
else
    pwd
fi

echo
read -p "Continue? [Yes/No]: " x
if [ "$x" != "Yes" ] ; then
    echo "Operation cancelled"
    echo
    exit 1
fi

find $1 -name .svn -exec rm -rf {} \;
echo "End!"
echo
exit 0` 
```

*   保存文件，并使其可执行：

    `chmod +x rm_svn_dirs`

*   要使用：

    `rm_svn_dirs /var/www/svn/www`

    `rm_svn_dirs ./svn/www`

    `rm_svn_dirs .`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-25T10:53:09.560

如果您想在批处理文件中使用它，请不要忘记将 % 加倍：

> 对于 /R 。(*.EXT) 中的 %1 执行 svn 删除 %1

_

> 对于 /R 。(*.EXT) 中的 %%1 执行 svn 删除 %%1

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-08-01T09:56:39.593

对我来说效果很好

```
find directory_to_delete/ -type d -name '*.svn' | xargs rm -rf 
```

# wpf - WPF SaveFileDialog - 限制驱动器

> ID：264332
> 
> 赞同：1
> 
> 时间：2008-11-05T04:20:31.070
> 
> 标签：wpf

如何限制 WPF SaveFileDialog 显示的驱动器号列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T06:48:06.263

恕我直言，因为它只是旧 FileDialog 公共控件的包装，如果你能做到这一点，我会感到惊讶。我可能是错的...

我首先要问为什么你需要限制某些驱动器（Windows-组策略和其他安全机制应该​​照顾用户权利）如果你真的需要这个......我会去

*   **覆盖 FileOk 事件，检查所选路径中的驱动器，如果路径不允许，则取消事件。同时通知用户解释拒绝的原因**
*   如果由于 UX 原因这不好，您可以修改注册表和/或组策略键以隐藏驱动器。谷歌搜索应该给你一些指示..但我自己不会这样做。不建议。

# java - 使用 Hibernate Criteria 查询多对多关系

> ID：264339
> 
> 赞同：10
> 
> 时间：2008-11-05T04:25:03.837
> 
> 标签：java, sql, hibernate, criteria, many-to-many

我不确定如何描述这个问题，所以我认为一个例子是问我问题的最佳方式：

我有两个具有多对多关系的表：

DriversLicence <-> LicenseClass

LicenceClass 是“汽车”、“摩托车”和“中刚性”之类的东西。

使用 Hibernate Criteria，我如何找到同时具有“汽车”和“摩托车”LicenceClasses 的所有许可证？

更新 12/11/2008 我发现这可以通过使用自定义 ResultTransformer 轻松实现。然而问题是结果转换器仅在查询返回其结果后应用，它实际上并没有成为 SQL 的一部分。所以我想我现在的问题是“你能做我最初在 SQL 中描述的事情吗？是否有 Hibernate Criteria 模拟？”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-23T22:22:29.593

这是我最终使用 HQL 实现它的方法：

```
public List<DriversLicence> findDriversLicencesWith(List<LicenceClass> licenceClasses) {
    String hqlString = "select dl from DriversLicenceImpl dl where 1=1 ";
    for (int i = 0; i < licenceClasses.size(); i++) {
        hqlString += " and :licenceClass" + i + " = some elements(dl.licenceClasses)";
    }

    Query query = getSession().createQuery(hqlString);
    for (int i = 0; i < licenceClasses.size(); i++) {
        query.setParameter("licenceClass" + i, licenceClasses.get(i));
    }
    return query.list();
} 
```

或者使用带有 sqlRestriction 的 Hibernate Criteria：

```
for (LicenceClass licenceClass : licenceClasses) {               
    criteria.add(Restrictions.sqlRestriction("? = some(select " + LicenceClass.PRIMARY_KEY + " from " +
                    LICENCE_CLASS_JOIN_TABLE + "  where {alias}." +
                    DriversLicence.PRIMARY_KEY + " = " + DriversLicence.PRIMARY_KEY + ")",
                    licenceClass.getId(), Hibernate.LONG));
} 
```

LICENCE_CLASS_JOIN_TABLE 是 hibernate 生成的表的名称，用于支持 driversLicence 和 LicenceClass 之间的多对多关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T05:44:07.143

您仍然可以使用点符号来处理关系。例如，假设您有 DriversLicence.licenceClass 属性和 LicenceClass.type 属性，则：

```
session.createCriteria(DriversLicence.class)
   .add(Expression.or(
     Expression.eq("licenceClass.type", "Car"),
     Expression.eq("licenceClass.type", "Motorbike")
   )
).list(); 
```

不过就个人而言，我只是避免在这种情况下使用条件，因为它不是动态查询，而是使用：

```
session.createQuery("from DriversLicence where licenceClass.type in (:types)")
  .setParameterList("types", myListOfTypes)
  .list(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T03:12:13.843

我有一个类似的问题，但使用 HQL 进行了修复，我有一个与“用户”类相关的“企业”类，也与“角色”类相关，当我需要所有相关的企业时，它们具有多对多的关系对于特定用户，我执行以下操作；

```
Select e from Enterprise As e inner join e.Users As u inner join u.Roles As r 
Where u.UserCode=? 
```

我想在你的情况下你应该做类似的事情；

```
Select dl from LicenceClass As l inner join l.DriversLicences As dl
Where 
l.LicenseClass.Name = ? OR 
l.LicenseClass.Name=? OR 
l.LicenseClass.Name=? 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-04T12:13:13.323

另一种选择是链式连接（每个 LicenseClass 一个连接）。我使用了这样的标准构建器和谓词

```
 List<Predicate> predicates = new ArrayList<>();
 for(Integer lcId : licenceClassIdList) {
     SetJoin<DriversLicence, LicenceClass> dlClasses = dlRoot.join(DriversLicence_.licenceClasses);
     predicates.add(builder.equal(dlClasses.get(LicenseClass_.id), lcId));
 }
 Predicate predicate = builder.and(predicates.toArray(new Predicate[predicates.size()])); 
```

注意 dlRoot 是 Root 类的对象，您可以从 CriteriaQuery 类中获取它。结果谓词是您要查找的内容...

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-07T08:48:58.173

“我认为这不会奏效。我想查找**同时具有**“汽车”和“摩托车”的所有许可证

用户 Expression.and(....) 而不是 Expression.or(....) 在 Nick 提供的代码段中

# c - 在 C 中是否有 sleep() 的替代方法？

> ID：264350
> 
> 赞同：15
> 
> 时间：2008-11-05T04:33:24.400
> 
> 标签：c, sleep, delay

在传统的嵌入式编程中，我们将给出一个延迟函数，如下所示：

```
for(i=0;i<255;i++)
   for(j=0;j<255;j++); 
```

在微处理器看来，这就是 sleep() 函数的工作方式吗？

C 中的 sleep() 函数是否有替代方法？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-05T04:36:08.590

您描述的那种循环称为“忙等待”。在实际操作系统中，休眠不会导致忙等待；它告诉操作系统在睡眠期结束之前不要安排进程。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-05T04:58:19.667

一种常见的机制是使用`select()`保证超时的 a，并将睡眠时间指定为超时：

```
// Sleep for 1.5 sec
struct timeval tv;
tv.tv_sec = 1;
tv.tv_usec = 500000;
select(0, NULL, NULL, NULL, &tv); 
```

通常`select()`用于检查一组文件描述符并等待至少一个准备好执行 I/O。如果没有准备好（或者，在这种情况下，如果没有指定 fds），它将超时。

超过繁忙循环的优点`select()`是它在睡眠时消耗的资源非常少，而繁忙循环在其优先级允许的范围内独占处理器。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-05T04:45:08.743

替代方案取决于您要做什么以及您使用的操作系统。

如果您只是想浪费时间，那么这些可能会有所帮助：

在大多数 unix 类型的系统上，您会发现一个“睡眠”功能，它或多或少类似于具有更高分辨率的睡眠。小心那个，因为它通常不能只睡一微秒。

在某些 unix 类型的系统上，select 系统调用可以与所有文件描述符设置为零一起使用，以获得相当准确的亚秒级等待。

在 Windows 系统上，您有睡眠，这几乎相同，但需要几毫秒。

在多任务操作系统中，有时可以将睡眠函数作为参数指定为 0。这通常会导致函数放弃它的时间片，但如果没有其他任务准备好运行，则会立即重新调度。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-05T07:00:07.830

您不会使用您发布的代码在嵌入式系统上休眠。一个像样的编译器会完全删除它，即使你的编译器没有删除它也是次优的，因为在一个紧密的循环中运行处理器会消耗功率，这对于嵌入式系统来说是一个问题。即使不依靠电池运行的系统也关心电力使用，因为较低的电力使用意味着更便宜的电源和冷却。

您通常执行此操作的方式是您的 CPU 将执行某种 IDLE 或 SLEEP 指令，这将导致它暂时停止处理命令。连接到定时器电路的外部中断线将定期唤醒处理器，CPU 会在该点检查它是否已经睡眠足够长的时间，如果没有，它会重新进入睡眠状态。

```
//Pseudo code
int start = getTime();
int end = start + sleepTime;

while (getTime() < end) {
       asm("SLEEP");
} 
```

确切的细节因处理器而异。如果您在操作系统上作为进程运行，则 sleep 调用通常只是告诉调度程序暂停您的进程，然后内核决定是调度另一个进程还是使 CPU 休眠。此外，上面的代码不适用于需要截止日期保证等的实时系统。在这些情况下，您需要获取循环中的时间，知道时间中断的持续时间，以便您知道是否可以重新睡眠超过最后期限，并可能重新编程计时器硬件或忙于等待。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-05T04:41:47.190

您在 OP 中谈论“嵌入式编程”。如果您正在进行嵌入式工作并需要 sleep() 之类的东西，通常有可用的硬件计数器/计时器。这将因架构而异，因此请查看数据表。

如果你不做嵌入式工作，我很抱歉:)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-05T04:43:01.477

如果您使用 for 循环，您最好知道它们编译成什么以及这些指令在您给定的时钟速度下需要多长时间，**并**确保 CPU 运行您的指令而不是其他任何东西（这可以在嵌入式系统中完成，但它是棘手，因为它不允许中断）。

否则，您将无法判断实际需要多长时间。

早期的 PC 游戏存在这个问题——它们是为 4.7MHz 的 PC 构建的，当更快的计算机出现时，它们就无法玩了。

“睡眠”工作的最佳方式是让 CPU 知道它在任何给定点的时间。不一定是实际时间（上午 7 点 15 分），但至少是相对时间（自某个时间点以来的 8612 秒）。

这样，它可以将增量应用于当前时间并循环等待，直到达到当前+增量。

任何依赖于 CPU 周期数的东西本质上都是不可靠的，因为 CPU 可能会执行另一个任务并让你的循环挂起。

假设您有一个内存映射的 16 位 I/O 端口，CPU 每秒递增一次。我们还假设它位于嵌入式系统中的内存位置 0x33，其中 int 也是 16 位。一个叫做 sleep 的函数就变成了这样：

```
void sleep (unsigned int delay) {
    unsigned int target = peek(0x33) + delay;
    while (peek(0x33) != target);
} 
```

您必须确保 peek() 每次都返回内存内容（因此优化编译器不会弄乱逻辑）并且您的 while 语句每秒运行一次以上，这样您就不会错过目标，但是这些是不影响我提出的概念的操作问题。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-05T05:44:42.553

这里有更多关于 sleep() 如何工作的[信息](https://stackoverflow.com/questions/175882/whats-the-algorithm-behind-sleep#176908)

顺便说一句，忙碌的等待不一定适合业余爱好者——尽管它确实会烧毁您可能想要用于其他目的的处理器。如果您使用的是时间源，您将受限于该源的粒度。例如，如果您有一个 1 ms 的计时器，并且想要 500 uS，那么您就有问题了。如果您的嵌入式系统可以处理您将在 500 uSec 的循环中嗡嗡作响的事实，那可能是可以接受的。即使您有一个具有所需粒度的计时器，您也需要在正确的时间从该计时器中获得一个中断......然后调度中断处理程序......然后进入您的代码。有时，繁忙的循环是最方便的解决方案。 **有时。**

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-05T05:43:55.253

Busy-waiting 即使在嵌入式系统中也适用于业余爱好者，使用实时源。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-05T06:27:49.940

任何体面的 C 编译器都无需额外的工作即可完全删除您的代码，延迟就会消失

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-05T05:55:46.540

sleep 实际上与操作系统接口，其中睡眠进程被放置在调度队列之外。我通常使用：

```
poll(0, 0, milliseconds); 
```

适用于 POSIX 兼容系统。`select`也适用于 Windows（它们必须有一个本机 API（可能称为`Sleep`）。）

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-11-08T04:16:41.700

Joseph Albahari 在“C# 中的线程”中的第 20 页对此进行了有趣的讨论。您在 .Net 中的睡眠时间不能少于 1 毫秒，但 DateTime.Ticks 的间隔粒度为 100 纳秒（= 0.1 微秒）。为了控制我的 5 轴 CNC 步进器，我只需要在步进命令之间暂停 10 微秒。我已经使用微控制器进行了令人讨厌的循环，但我认为如果你有一大堆工作，交出一个处理器来完成这项工作是可以的，尽可能停止线程。至少它不会总是一样的。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-07-14T16:01:39.073

```
#include <Windows.h>

static NTSTATUS(__stdcall *NtDelayExecution)(BOOL Alertable, PLARGE_INTEGER DelayInterval) = (NTSTATUS(__stdcall*)(BOOL, PLARGE_INTEGER)) GetProcAddress(GetModuleHandle("ntdll.dll"), "NtDelayExecution");

static NTSTATUS(__stdcall *ZwSetTimerResolution)(IN ULONG RequestedResolution, IN BOOLEAN Set, OUT PULONG ActualResolution) = (NTSTATUS(__stdcall*)(ULONG, BOOLEAN, PULONG)) GetProcAddress(GetModuleHandle("ntdll.dll"), "ZwSetTimerResolution");

static void SleepShort(float milliseconds) {
    static bool once = true;
    if (once) {
        ULONG actualResolution;
        ZwSetTimerResolution(1, true, &actualResolution);
        once = false;
    }

    LARGE_INTEGER interval;
    interval.QuadPart = -1 * (int)(milliseconds * 10000.0f);
    NtDelayExecution(false, &interval);
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-07-30T21:56:59.730

在 linux 中可用 usleep( int microseconds ) nanosleep( ... ) 更精确的请参见调用参数的手册页

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-11-05T05:39:10.740

在 unix 衍生操作系统中，您可能会安排一个 signal() 调用，并且您的代码会简单地阻塞代码，直到发出信号。信号是为此目的而设计的，它们非常简单有效。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-02-06T10:13:25.827

一个尝试......真正解决这个问题，即有效的东西（不像上面的回答尝试）大声笑

我仍然需要改进这段代码才能让它出来。很少有附加组件是受欢迎的。

```
// Sleep for both Windows and Linux: 
// Too bad? No one proposed you a solution that works? 
// Since Windows has no select.h nor poll.h, an implementation
// is necessary.
//  
// Solutions on boards are often refered to use either select or poll, but ok, what about C (not c++)?
//
/// implementation of poll is destined in this attempt for windows
/// Ideally, you add this part of code to the header of you *.c file, and it might work through...

#ifdef WIN32
#include <time.h>
#include <sys/time.h>
#include <ws2tcpip.h>
#include <Winsock2.h>
#include <windows.h>
/* winsock doesn't feature poll(), so there is a version implemented
 * in terms of select() in mingw.c. The following definitions
 * are copied from linux man pages. A poll() macro is defined to
 * call the version in mingw.c.
 */
#define POLLIN      0x0001    /* There is data to read */
#define POLLPRI     0x0002    /* There is urgent data to read */
#define POLLOUT     0x0004    /* Writing now will not block */
#define POLLERR     0x0008    /* Error condition */
#define POLLHUP     0x0010    /* Hung up */
#define POLLNVAL    0x0020    /* Invalid request: fd not open */
struct pollfd {
  SOCKET fd;        /* file descriptor */
  short events;     /* requested events */
  short revents;    /* returned events */
};

int mingw_poll (struct pollfd *, unsigned int, int);

#define poll(x, y, z)        mingw_poll(x, y, z)
#endif

int mingw_poll(struct pollfd *fds, unsigned int nfds, int timo)
{
    struct timeval timeout, *toptr;
    fd_set ifds, ofds, efds, *ip, *op;
    int i, rc;

    /* Set up the file-descriptor sets in ifds, ofds and efds. */
    FD_ZERO(&ifds);
    FD_ZERO(&ofds);
    FD_ZERO(&efds);
    for (i = 0, op = ip = 0; i < nfds; ++i) {
    fds[i].revents = 0;
    if(fds[i].events & (POLLIN|POLLPRI)) {
        ip = &ifds;
        FD_SET(fds[i].fd, ip);
    }
    if(fds[i].events & POLLOUT) {
        op = &ofds;
        FD_SET(fds[i].fd, op);
    }
    FD_SET(fds[i].fd, &efds);
    } 

    /* Set up the timeval structure for the timeout parameter */
    if(timo < 0) {
    toptr = 0;
    } else {
    toptr = &timeout;
    timeout.tv_sec = timo / 1000;
    timeout.tv_usec = (timo - timeout.tv_sec * 1000) * 1000;
    }

#ifdef DEBUG_POLL
    printf("Entering select() sec=%ld usec=%ld ip=%lx op=%lx\n",
           (long)timeout.tv_sec, (long)timeout.tv_usec, (long)ip, (long)op);
#endif
    rc = select(0, ip, op, &efds, toptr);
#ifdef DEBUG_POLL
    printf("Exiting select rc=%d\n", rc);
#endif

    if(rc <= 0)
    return rc;

    if(rc > 0) {
        for (i = 0; i < nfds; ++i) {
            int fd = fds[i].fd;
        if(fds[i].events & (POLLIN|POLLPRI) && FD_ISSET(fd, &ifds))
            fds[i].revents |= POLLIN;
        if(fds[i].events & POLLOUT && FD_ISSET(fd, &ofds))
            fds[i].revents |= POLLOUT;
        if(FD_ISSET(fd, &efds))
            /* Some error was detected ... should be some way to know. */
            fds[i].revents |= POLLHUP;
#ifdef DEBUG_POLL
        printf("%d %d %d revent = %x\n", 
                FD_ISSET(fd, &ifds), FD_ISSET(fd, &ofds), FD_ISSET(fd, &efds), 
                fds[i].revents
        );
#endif
        }
    }
    return rc;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-02-06T16:43:12.587

我在这篇文章（[http://cboard.cprogramming.com/c-programming/111229-how-use-sleep-function.html](http://cboard.cprogramming.com/c-programming/111229-how-use-sleep-function.html)）中找到了这个函数，它可以工作：

```
#include <stdio.h>
#include <windows.h>

int main()
{
    puts("Hello \n");
    /* in windows.h is declared the Sleep (upper S) function and it takes time in 
miliseconds */
    Sleep(3000);
    puts("World \n");
    return 0;
} 
```

# c - 如何回到已经用 C 打印的某个位置？

> ID：264358
> 
> 赞同：1
> 
> 时间：2008-11-05T04:41:06.753
> 
> 标签：c, printf, textcolor

让我们假设下面的程序打印了大约 10 行 #

```
for(i=0;i<10;i++)
prinf("\n#"); 
```

现在如何回到第 5 行并编辑该 # 并更改它的颜色而不清除屏幕或清除以下 5 行？

我试过了

```
window(5,0,20,20);
textcolor(GREEN);
cprintf("#"); 
```

但它不是在编辑那个，而是在原始的一侧打印。为什么？

还有其他方法可以动态更改已打印文本的颜色吗？请帮帮我..我的环境是windows上的turbo c

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T06:42:30.380

看起来您正在混合 printf 和另一个输出库 - 不建议这样做。Printf 期望被发送到字符终端，而有问题的输出库可能错误地假设它具有独占访问权限（并且可能行为不端。）

基于一个函数，您可能正在使用 conio.h。可以在[此处](http://poli.cs.vsb.cz/c/help/conio.htm)找到文档，其中包含显示每个可用功能的目录。从该索引中，您应该能够立即发现该功能。

窗口函数不会做你想做的事，因为它只设置光标可以更改文本的区域 - 它不会移动光标，你需要使用其他库函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T05:14:12.617

`-1:` 发布家庭作业问题的一些提示：

1) 正确回答问题！发布的代码不执行描述状态：

```
 for(i=0;i<10;i++)
    prinf("#"); 
```

这将在一行上打印 10 个`#`字符，因为没有行尾字符。原始描述谈到“打印 10 行”。

2) 提供必要的详细信息：您使用的是什么环境：Windows？Linux？什么编译器？这是一个窗口或基于文本的环境？

3) 发布前的 STFW。查找“ANSI 转义序列”或“定位光标”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T08:52:41.423

window 函数通常会从第一个两个坐标像素创建一个窗口，即在您的示例中 (5,0) 到下一个 2 个坐标指向的像素。所以你的程序应该可以工作

试试看，或者使用 gotoxy()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T04:52:33.830

也许-

```
cprintf("\b#"); 
```

'b' 用于退格

# wcf - 性能调优 WCF 服务

> ID：264366
> 
> 赞同：2
> 
> 时间：2008-11-05T04:47:39.080
> 
> 标签：wcf, performance

WCF Web 服务最重要的性能调整领域是什么？

*   ASP.net 线程设置？
*   WCF 节流？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-02-19T23:35:45.117

请查看下面的文章和白皮书。我认为它们应该为您提供更具体的性能考虑因素以供探索，并且可能提供一些非常实用的设置来调整、优化或更改。我也在另一个问题中发布了这个答案，但我认为它对遇到这个问题的任何人都有用。

副手，甚至不知道你的场景，你不能说 X 油门设置比 Y 线程设置更重要。

[性能调优 WCF 服务](http://msdn.microsoft.com/en-us/library/hh273113.aspx)

[优化 WCF Web 服务性能](http://msdn.microsoft.com/en-US/library/ee377061%28v=bts.10%29.aspx)

[使用 ServiceThrottlingBehavior 控制 WCF 服务性能](http://msdn.microsoft.com/en-us/library/ms735114.aspx)

[运输配额](http://msdn.microsoft.com/en-us/library/ms731078.aspx)

[优化 IIS 性能](http://msdn.microsoft.com/en-US/library/ee377050%28v=bts.10%29.aspx)

[ASP.NET 性能概述](http://msdn.microsoft.com/en-us/library/cc668225.aspx)

[Windows Communication Foundation (WCF) 与现有分布式通信技术的性能比较](http://msdn.microsoft.com/en-us/library/bb310550.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-30T10:18:04.297

那么首先要看的是WCF是你的瓶颈还是其他东西（比如你的数据库调用等）。大多数性能改进可以通过通常的东西（WCF 没有什么特别的）来完成，比如缓存、优化的 DB 访问、数据结构的选择、allogirthms 等。

WCF 特有的东西是将所有 Web 服务调用设计为无状态的，以便可以使用负载平衡在多个服务器上轻松扩展它们。尝试提供不太健谈的粗粮服务。如果您的服务使用者是基于 .Net 的，使用 Net.Tcp 协议，它的编组比 SOAP/HTTP 好得多。WCF 节流相当保守，您最好增加节流限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T06:00:35.127

这取决于您的应用程序设计、硬件和负载。

如果我必须选择一种技术，它可能会使用单个调用对象。

一旦您感觉到系统可以处理的峰值负载，节流就会很有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-08T18:31:42.873

[Mikayel Vardanyan](https://www.monitis.com/blog/author/mvardan/)的这篇文章对我非常有用：https: [//www.monitis.com/blog/top-8-application-based-iis-server-performance-tips/](https://www.monitis.com/blog/top-8-application-based-iis-server-performance-tips/)

总之：

1.  删除竞争的、未使用的和重复的应用程序和服务
2.  优化内容使用
3.  限制应用程序池的队列长度
4.  启用 IIS HTTP 压缩
5.  在 IIS 上发展 Web 花园
6.  回收应用程序池
7.  减少记录频率
8.  在 IIS7 中使用 Expires 标头

# c# - iPhone Web 应用缓存持久性

> ID：264367
> 
> 赞同：1
> 
> 时间：2008-11-05T04:50:26.190
> 
> 标签：c#, asp.net, iphone, iphone-web-app

我如何编写一个 ASP.NET (C#) 应用程序，当它被标记为“主屏幕图标”时，它将呈现一个页面可以永久缓存在 iPhone 上？我尝试在“Response.ExpiresAbsolute = DateTime.MaxValue;”后面的代码上设置它 但无济于事。每次启动主屏幕图标时，仍会执行服务器代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T04:59:55.657

您需要通过 HTML5 缓存和应用清单文件进行设置。Thw WhatWG 小组发布了[一份](http://www.whatwg.org/specs/web-apps/current-work/#offline)规范草案。

# java - 如何对 MultiMap 进行排序 在java中？

> ID：264372
> 
> 赞同：8
> 
> 时间：2008-11-05T04:53:53.420
> 
> 标签：java

是否有理由在 Java 中对 MultiMap 进行排序以及如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T06:08:56.030

假设你在谈论[`org.apache.commons.collections.MultiMap`](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/MultiMap.html)，那么你不能；因为它返回 a`Collection`而不是 a `List`，所以它不支持 order 的概念。

如果您正在谈论[`org.apache.commons.collections.MultiHashMap`](https://commons.apache.org/proper/commons-collections/javadocs/api-3.2.2/org/apache/commons/collections/MultiHashMap.html)，那么您需要做的就是遍历键，获取`ArrayList`返回并使用`Collections.sort()`.

那是假设您正在使用[该实现](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/MultiMap.html)。

没有什么能阻止你`MultiMap`相当容易地实现你自己的，它支持排序列表。它可能很简单`HashMap<K, Collection<V>>`，我不熟悉 MultiMaps 的工作原理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T07:10:16.843

其实我不知道你为什么要对地图进行排序。Map 是一个字典，您可以从该字典中检索您感兴趣的一个（或在多映射的情况下是一个集合）值。

在 MultiMap 的情况下，您可能希望对 get 产生的 Collection 进行排序。但是，排序 Map 有什么优势，因为它不会加快任何查找特定值的速度？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-18T07:17:05.617

最简单的解决方案是使用来自番石榴的 TreeMultimap。直接使用

```
TreeMultimap<...> sortedMap = TreeMultimap.create(notSortedMultiMap); 
```

如果您的键和值是自然可排序的（实现 Comparable），或者

```
TreeMultimap<...> sortedMap = TreeMultimap.create(keyComparator, valueComparator);
sortedMap.putAll(notSortedMultiMap); 
```

如果您需要提供自定义比较器。

如果您知道需要对其进行排序并且不太关心检索速度，那么您当然可以从一开始就使用 TreeMap。

然后您可以遍历 TreeMap 或使用 values() 或条目之类的东西来获取排序集合。

# .net - 将大型 VB6 应用程序升级到 .NET。关于 VB 迁移伙伴的意见

> ID：264375
> 
> 赞同：4
> 
> 时间：2008-11-05T04:54:43.140
> 
> 标签：.net, vb6, migration, vb6-migration

我有一个非常大的 VB6 代码库，其中包含大量的 3rd 方控件。想要将其移至 .NET。重写它是毫无疑问的——客户认为花钱得到同样的东西没有任何价值。使用内置升级向导迁移到 .NET 基本上是不可能的。

有没有人尝试过[http://www.vbmigration.com/](http://www.vbmigration.com/)的 VB 迁移伙伴 如果有，体验如何？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T15:36:02.673

我是 VB 迁移合作伙伴工具（位于 www.vbmigration.com）的主要作者。一般来说，我们对来自现有或潜在客户的所有请求都做出了非常快速的答复。如果发现难以与我们联系，我很抱歉。[请在http://www.vbmigration.com/contactus.aspx](http://www.vbmigration.com/contactus.aspx)重试

我们确实相信我们的工具能够处理非常大的 VB6 应用程序。实际上，我们的大多数客户都在使用它来迁移 200-500K 行代码范围内的应用程序。我们目前正在开发一个包含超过 1300 万个 LOC 的“怪物应用程序”，这些 LOC 被划分为 1200 多个项目。

正如 RSConley 所建议的那样，如果您的应用程序可以部分迁移和测试，那么任何转换工具都能发挥最佳效果。我们支持 VB6 项目组（在单个操作中转换）、批量转换，并且我们支持与源代码控制工具的集成。（例如，我们保留上一代的解决方案/项目指南，以便您的 SC 工具知道如何处理新生成的代码。）

最后，我们即将发布 1.11 版本，它可以生成与原始 COM DLL 二进制兼容的 .NET DLL，这样您就可以同时迁移一个组件，从最基本的组件开始，所有其他部分都使用该组件。您的应用程序，而无需重新编译它们。（据我们所知，VB Migration Partner 是唯一具有此功能的工具。）

Francesco Balena -- VB 迁移合作伙伴团队

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T05:12:22.417

我以前从未与 VB 迁移人员合作过，但是我强烈建议不要将代码库迁移到 .NET。它确实没有增加价值。

我取得的巨大成功是在 .NET 中添加新功能并通过 VB6 应用程序中的 COM 互操作获得它。这非常轻松，是在遗留应用程序中利用 .NET 的好方法。

...我的 2 美分

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T13:48:00.113

简短的回答是 VB6 和 VB.NET（以及因此 C#）是独立但相关的语言。两个平台之间存在许多细微的差异（Integer 是 Int32 而不是 Int16）和严重的差异（图形、表单和打印引擎）。您需要将此视为您正在转换到一个完全不同的平台。

我发现除了某些特定情况外，各种迁移工具都不值得付出努力。例如使用水晶报表的数据库前端。

至于迁移的价值。只有您和您的公司才能做出这样的决定。在 PC 上维护应用程序足够长的时间，最终您必须认真考虑它。主要是为了利用一种全新的技术（例如从 DOS 切换到 Windows）。我的应用程序始于 1985 年，在其 20 年的历史中发生了 3 次重大转换（工作站到 DOS、DOS 到 Windows 3.X、Windows 3.X 到 32 位 Windows 和面向对象的框架）。

我们正在考虑 .NET 有几个原因。VB.NET 是一种相关语言，泛型和继承允许我们的大部分样板代码压缩成几行。更丰富的图形 API 等等。当然，转换权衡一切都是令人头疼的问题。然而，当我们切换到面向对象的框架时，我们的应用程序变成了一个通过 COM 链接到多个 DLL 的小型 EXE。由于我们的应用程序结构，我们有机会进行零碎的转换和测试。

我强烈建议，如果您打算将您在 VB6 中的应用程序重构为可以部分转换和测试的结构。您将能够使用活动 DLL 来完成此操作。如果你尝试一次性完成，那么你会发现 80% 的项目会很快完成，而最后的 20% 将是纯粹的地狱。通过零碎转换，您将在每一步都留下工作软件。

在这里更全面地探讨了这些问题

[如何将大型应用程序从 VB6 切换到 VB.NET](https://stackoverflow.com/questions/395/how-to-switch-a-large-app-from-vb6-to-vb-net)

# php - 有没有人为 WCF 服务开发了基于 PHP 的客户端？

> ID：264377
> 
> 赞同：0
> 
> 时间：2008-11-05T04:57:28.717
> 
> 标签：php, wcf, compatibility

有没有人为 WCF 服务开发了基于 PHP 的客户端？我正在为我的工作完成 WCF 服务。只是我不希望客户端在.Net Stack 上运行。我预计 PHP (LAMP) 将成为常态。

是否有一些明显的陷阱需要避免？

我没有运行任何安全性（BasicHTTPBinding）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T05:58:12.730

您可以使用 PHP5 [SOAP 扩展](http://www.php.net/soap)，查看[此](http://weblogs.asp.net/gunnarpeipman/archive/2007/09/17/using-wcf-services-with-php.aspx)示例。

# mysql - 有没有办法在 MySQL / Rails 中强制区分大小写以进行单个查找？

> ID：264381
> 
> 赞同：8
> 
> 时间：2008-11-05T05:03:01.797
> 
> 标签：mysql, ruby-on-rails, case-sensitive

我正在搜索标签，一些用户喜欢“猫”，而另一些用户喜欢“猫”去图...

无论如何，有没有办法强制特定的发现区分大小写？如：

```
Tag.find(:some-special-option-here) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-05T09:02:49.753

您还可以在不更改列属性的情况下进行区分大小写的搜索。

```
SELECT * FROM mytable WHERE myfield='Value' 
```

此查询匹配：

*   价值
*   价值
*   价值
*   价值
*   *等等*

尽管...

```
SELECT * FROM mytable WHERE BINARY myfield='Value' 
```

仅匹配：

*   价值

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-19T18:05:10.537

您可以通过在创建表时将“COLLATE utf8_bin”添加到 :options 字符串来使所有字符串在创建表时区分大小写。例如：

```
create_table( "page_infos", :force => true, :options => "ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE utf8_bin") do |t|
      t.string   "title",       :limit => 120
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T05:14:28.870

在 mysql 数据库中，将文本的数据类型设置为 utf_collat​​e_bin。例如：

```
ALTER TABLE `sets` CHANGE `set_name` `set_name` VARCHAR( 64 ) CHARACTER SET utf8 COLLATE utf8_bin NOT NULL 
```

其中“sets”是表，“set_name”是 VARCHAR(64) 类型的列。您也可以在 PhpMyAdmin 中执行此操作..

任何二进制整理都可以完成这项工作；但 utf8 更可取。

如果您想知道当前整理末尾的 _ci 是什么，它的意思是“不区分大小写”：p

# visual-studio - 在非开发机器上运行 vc2008 调试构建

> ID：264385
> 
> 赞同：4
> 
> 时间：2008-11-05T05:09:38.973
> 
> 标签：visual-studio, visual-studio-2008, debug-build

我正在 vc2008 中构建我的应用程序并在机器网络上对其进行测试。

除了安装 Visual Studio 2008 之外，还有什么方法可以在另一台机器上运行 C++ 程序的调试版本？（即没有安装vc2008）

安装 redist 软件包只会安装 vc2008 程序的发布模式支持 DLL。目前它抱怨“此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。”，我认为这是“我缺少 DLL”的代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T05:36:00.700

你不能，因为调试运行时没有安装程序 redist（实际上软件许可证禁止分发它，所以即使你确实把一些东西放在一起，你也会违反 EULA）。但是，“调试构建”通常涉及 4 个单独的选项，另外 3 个不影响分发应用程序。

1.  生成一个允许符号调试的 .pdb 文件（cl /Zi 和链接 /DEBUG）。您可能希望将 /OPT:ref 添加到链接器选项；链接器在不创建 .pdb 文件时会丢弃未引用的函数，但在 /DEBUG 模式下它会保留所有函数（因为调试符号引用了它们），除非您明确添加它。

    我通常对我的所有构建都执行此操作，甚至是生产版本。只要您使用 /OPT:ref 重新打开链接器优化，它就不会真正花费任何成本，如果您最终想要读取故障转储，拥有这些符号会很方便。

2.  使用 C 运行时库的调试版本（可能是 MSVCR*D.dll，但这取决于您使用的运行时）。这归结为 /MT 或 /MTd （或其他东西，如果不使用 dll 运行时）。

    这意味着你不能再重新分配东西了。它还对某些库函数的性能产生巨大影响，尤其是内存分配。调试运行时版本小心地用值“毒化”它们接触的内存以清除未初始化的数据错误，发布版本通常保留旧数据以节省接触它的时间。我相信使用 MSVCP* STL 实现，调试版本也省略了所有通常完成的分配池，因此泄漏检查器可以准确地显示您认为的块，而不是它一直在分配的更大的内存块，但这意味着它会在更慢的情况下对 malloc 进行更多调用。如果你有指针或迭代器处理错误，这可能会影响你得到什么样的不当行为。

3.  关闭编译器优化 (/Od)。

    这个做了很多事情（[这个问题](https://stackoverflow.com/questions/69250/why-does-a-cc-program-often-have-optimization-turned-off-in-debug-mode)对这个主题有一些很好的讨论），但基本上它会损害性能。很多。不幸的是，如果您希望单步运行顺利，则需要它。

4.  设置预处理器#defines DEBUG 或 NDEBUG。

    这以各种方式影响了许多库，但最值得注意的是它编译或消除了 assert() 和朋友。

因此，您可能会考虑使用这些选择的较少组合进行构建。我大量使用具有符号（/Zi 和链接 /DEBUG）和断言（/DDEBUG）的构建，但仍然优化（/O1 或 /O2 或您使用的任何标志）但堆栈帧指针保留用于清除回溯 (/Oy-) 并使用正常的运行时库 (/MT)。这与我的发布版本接近并且是半可调试的（回溯很好，单步执行在源代码级别有点古怪；组装级别当然可以正常工作）。你可以有很多你想要的配置；只需克隆您的发行版并打开调试的任何部分似乎有用。

唯一会影响尝试重新分发应用程序的是 2。

如果您尝试在另一台机器上进行调试，您可能也对[msvsmon](http://msdn.microsoft.com/en-us/library/xf8k2h6a.aspx)感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T06:17:39.633

当然，您始终可以将程序配置为在 CRT 中静态链接，而不是使用 DLL。

这样，您就避免了必须确保正确安装调试 DLL 的麻烦（无论是在设置方面还是在没有再分发许可证方面）。

只需将“运行时库”的代码生成设置更改为“多线程调试 (/MTd)”或使用命令行上的“/MTd”选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T06:06:01.857

阅读[这篇博](http://blogs.msdn.com/jigarme/archive/2008/05/08/vc-debug-c-runtime-files.aspx)文，了解您需要哪些文件才能运行应用程序的调试风格以及从何处获取这些文件。但是，您不能正式将它们重新分发给第三方。

如果您有应用程序的安装程序，还可以构建一个合并模块，以便在没有 Visual Studio 的计算机上部署调试运行时。当然，这仅用于测试目的。合并模块位于**`C:\Program Files\Common Files\Merge Modules`**.

# linux - Linux 等效于 Mac OS X“打开”命令

> ID：264395
> 
> 赞同：233
> 
> 时间：2008-11-05T05:23:22.783
> 
> 标签：linux, macos, command-line, command-line-interface

我发现 Mac OS X 中的“打开”命令在命令行中非常方便。来自“人开”：

> 该`open`命令打开一个文件（或目录或 URL），就像您双击文件的图标一样。如果未指定应用程序名称，则使用通过 LaunchServices 确定的默认应用程序来打开指定的文件。

也就是说，如果我想用默认的 PDF 查看器（恰好是预览）打开一个 PDF 文件，我只需要这样做：

```
open my.pdf 
```

然而，在 Linux 中，要从命令行打开 PDF 文件，我必须四处寻找默认的 PDF 查看器，例如“evince”（谁会猜到？？），然后

```
evince my.pdf 
```

那么，在 Linux 命令行中是否有一个简单的“打开”命令等价物？

谢谢！

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2008-11-05T05:28:35.630

你可以试试`xdg-open`，大多数 Linux 发行版都有。它将为您的文件打开默认关联的应用程序。

仅供参考[https://portland.freedesktop.org/doc/xdg-open.html](https://portland.freedesktop.org/doc/xdg-open.html)

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-11-05T06:23:16.267

您正在寻找的等价物是[`xdg-open`](http://portland.freedesktop.org/xdg-utils-1.0/xdg-open.html)，它可以以与 OS X 的`open`命令相同的方式使用。例如：

```
xdg-open ~/Documents/Chubby_Bubbies.odt 
```

但是，这确实很难快速准确地键入。相反，您应该为 xdg-open 创建一个别名，这样可以加快处理速度。

当然，您可以将其别名为使其与 OS X 匹配（您可以选择任何您想要的东西），但就个人而言，出于速度原因`open`，我使用右方括号 ( ) 作为快捷方式。`]`要使用它，请将以下内容添加到您的`.bashrc`文件中：

```
alias ']'='xdg-open' 
```

然后，要打开任何资源，请像以下任何示例一样使用它：

```
] www.google.com
] file.txt
] ~/Pictures
] ssh://myserver.local/home/jeremy 
```

这还允许您在当前目录中打开文件浏览器（例如 Nautilus）：

```
] . 
```

根据经验，我发现单字母别名最适合上述快捷方式。毕竟，目标是效率。您可以返回并在 OS X 上使用相同的别名——我将其留给读者作为练习。:-)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-03-28T14:38:10.537

我只是自己解决了这个问题，所以我想我会写下我是如何做到的，这与 Suan 的要求特别相关。这些步骤允许您只输入“open”，而不是您的终端包含您不需要的消息：

创建一个名为`open`in的脚本`~/bin`，内容就是：

```
xdg-open "$1" &> /dev/null & 
```

保存并关闭脚本，然后键入“source .profile”（或 .bash_profile，如果相关）。就是这样，因此键入“打开音乐”将在 nautilus GUI 中打开您的音乐文件夹，并且不应在终端上输入任何内容。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-05T12:06:18.277

传统上，您可以使用“see”命令。它只使用运行邮件帽。这将在没有 Gnome 和 X 等的情况下工作。

```
man see 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-05T05:45:31.617

侏儒开放

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-08-02T15:30:36.290

如果您的 mimes 设置正确，则可以使用`mimeopen`. 查看它的手册页，因为它有一些有用的选项。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-10-03T01:42:07.220

在 Gnome Desktop 环境下，我使用以下命令：

```
nautilus `pwd` & 
```

这类似于“打开”。Mac 中的命令

# .net - Winforms Form Constructor vs Load事件

> ID：264396
> 
> 赞同：12
> 
> 时间：2008-11-05T05:25:04.653
> 
> 标签：.net, winforms, constructor, initialization, onload-event

加载表单时，代码需要执行诸如设置数据网格、组合框、设置标题等操作。我倾向于始终使用加载事件而不是新的（构造函数）。有没有什么指南最适合哪些活动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T06:38:53.973

对 InitializeComponent 的调用会自动插入到表单/页面的构造函数中。InitializeComponent 是自动生成的方法

*   在您的 winform / XAML 页面上创建各种 UI 元素
*   使用存储在资源文件中的值初始化它们的属性

因此，与 UI 安排/修改相关的任何内容都应**在**此调用之后进行。当您在 Form.OnLoad 的覆盖中执行此操作时，您可以确保 UI 已准备就绪（已调用 InitializeComponent）......所以我会投票支持 UI 的 OnLoad。
创建非 UI 成员，构造函数将是我首先要看的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T09:46:38.120

Bear in mind that anything in the constructor of a form will be created/executed at that forms creation. i.e. at:

Form frm = new Form();

Whereas anything in the Load event will occur only when the form is **shown** i.e. frm.Show();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T05:43:32.557

基本上，您希望您的构造函数尽可能轻巧。我尝试将大部分内容放在 Load 事件处理程序中，因为 UI 元素已经创建并且此时可以使用。但是，我通常在构造函数中实例化类对象等，因为它实际上是构造对象的一部分。有时你不能把东西放在一个地方或另一个地方，但在你可以的时候，你应该把它们放在看起来最合适的地方。

# asp.net - DataList，条件语句中 ?

> ID：264400
> 
> 赞同：3
> 
> 时间：2008-11-05T05:28:24.880
> 
> 标签：asp.net, datalist

我正在尝试在 ASP.NET 3.5 中执行以下操作。基本上，我将 LINQDataSource 绑定到 DataList。有一个名为“已删除”的属性，如果它是真的，我想显示不同的标记。以下代码引发错误：

```
<asp:DataList runat="server">
    <ItemTemplate>
        <% If CBool(Eval("Deleted")) Then%> 
            ...
        <% Else%>
            ...
        <% End If%>
    </ItemTemplate>
</asp:DataList> 
```

这可能吗？如果没有，有什么替代方案？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-07-10T17:11:21.933

我可能会建议保持代码前端精简并通过函数结果写出所需的文本：

```
<asp:DataList runat="server">
    <ItemTemplate>
         <%# GetText(Container.DataItem) %>
    </ItemTemplate>
</asp:DataList> 
```

和代码隐藏：

```
protected static string GetText(object dataItem)
{        
    if (Convert.ToBoolean(DataBinder.Eval(dataItem, "Deleted"))
        return "Deleted";

    return "Not Deleted";
} 
```

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T06:05:10.000

一种解决方法是使用面板。

```
<asp:DataList runat="server">
    <ItemTemplate>
        <asp:Panel Visible="<%# Eval("Deleted") %>">
            ...(deleted content here)...
        </asp:Panel>
        <asp:Panel Visible="<%# Not Eval("Deleted") %>">
            ...(other content here)...
        </asp:Panel>
    </ItemTemplate>
</asp:DataList> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T05:49:18.740

为什么不直接使用 RowDataBound 事件并检查字段的值呢？RowDatabound 非常适用于您希望根据结果集中的值更改网格视图中的数据的情况。

[来自 MSDN 的 RowDataBound 事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowdatabound.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T05:55:29.240

也许使用数据列表的 ItemDataBound 事件。对于 gridview，它的 rowdatabound 事件非常适合根据结果集中的其他值更改值的显示。 [项目数据绑定事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)

所以基本上在 itemdatabound 上你可以玩弄你的条件。同样，这是一个有根据的猜测，因为我通常使用 gridview 上的 RowDataBound 事件来完成此操作。

# asp.net - IE 6.0 中未识别的元素

> ID：264402
> 
> 赞同：0
> 
> 时间：2008-11-05T05:32:07.947
> 
> 标签：asp.net, html, css, cross-browser

我在我的 HTML 中使用了这个：

```
<q> Hai How r u </q> 
```

它以引号显示文本，例如“Hai How r u”。

这在 FF 中运行良好，但在 IE 6.0 中却不行。

请让我知道为什么会发生这种情况，以及您可能知道的任何解决方案。

我不想在我的 HTML 或单独的 css 文件中使用引号 (") 字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T05:38:15.330

A List Apart 有一整篇文章专门讨论这个`<q>`标签：
[Long Live The Q Tag](http://www.alistapart.com/articles/qtag)

总结就是在火狐等浏览器中添加CSS*去掉引号，然后自己手动编码。*这有点痛苦，但至少它平衡了竞争环境，并且您知道您的内容看起来与跨浏览器相同。

如果您*真的*不想自己输入引号，请查看以下文章：

*   [http://simon.incutio.com/archive/2003/04/03/fixingQuotesWithJavascript](http://simon.incutio.com/archive/2003/04/03/fixingQuotesWithJavascript)
*   [http://diveintomark.org/archives/2002/05/04/the_q_tag](http://diveintomark.org/archives/2002/05/04/the_q_tag)
*   [http://diveintomark.org/archives/2002/08/14/the_q_tag_revisited](http://diveintomark.org/archives/2002/08/14/the_q_tag_revisited)
*   [http://www.clagnut.com/blog/157/](http://www.clagnut.com/blog/157/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T18:54:51.367

`<q>`Internet Explorer 8 支持它的价值。

`<q>`涉及多个嵌套`<q>`元素（嵌套引号）和每种语言的“正确”引用样式存在很多问题。这阻碍了用户代理支持和采用率。

在 Firefox 中也并非一帆风顺，如果使用 CSS 生成的引号路线，当您的最终用户使用生成的字符剪切和粘贴文本时，这些字符不会进入您的剪贴板。（[见 Mozilla 错误 12460](https://bugzilla.mozilla.org/show_bug.cgi?id=12460)）

展望未来， W3C HTML 工作组在[2008 年 10 月有](http://lists.w3.org/Archives/Public/public-html/2008Oct/thread.html#msg92)[一个关于 HTML 5 应该做什么的有趣线程`<q>`](http://lists.w3.org/Archives/Public/public-html/2008Oct/thread.html#msg92)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T05:35:48.330

为什么不直接使用`"`字符？与应该分别替换为强和强调不同的是，引号标记在含义上与引号字符直接匹配`<b>`。`<i>`应该没有必要使用`<q>`.

**编辑**：感谢您澄清问题 Yan。OP：您不想使用引号是否有特定的原因？我之前说的内容仍然有效，但也许我们可以帮助解决阻止您使用引号的问题。

**编辑2**：：|

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-08T22:55:27.247

我想这并没有真正回答这个问题，但我忽略了引号不会在 IE6 上呈现的事实。我用这个设置了一个样式表：

```
q:before { content: "\201c"; }
q:after { content: "\201d"; }

q q:before { content: "\2018"; }
q q:after { content: "\2019"; } 
```

这会在元素之前和之后呈现*花引号。*`q`适用于 IE7 和适当的浏览器。如果您想要直引号，请替换`201c`和。`201d``0022`

解决 IE6 问题的方法是使用 Javascript，或者对`q`标签应用一些不同的样式，例如，以下将显示为斜体和深灰色：

```
q { font-style: italic; color: #444444; } 
```

# cocoa - Cocoa 10.5 多线程应用运行缓慢

> ID：264409
> 
> 赞同：1
> 
> 时间：2008-11-05T05:37:56.903
> 
> 标签：cocoa, multithreading, macos, osx-leopard

有一个在 10.4 中运行良好的 Cocoa 视频捕获应用程序。它使用 NSThread 来启动视频捕获驱动程序。当应用程序刚启动时，视频捕获非常慢（1-2 fps）。但在调整 UI 窗口大小（或将窗口从背景移至前台）后，视频捕获速度恢复正常。这只发生在 10.5 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T05:45:03.693

不确定具体原因，但您应该使用 Instruments 来弄清楚发生了什么

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T08:50:05.800

“我的应用程序很慢”的答案总是“Run Shark”。偶尔，它现在是“Run Instruments”，但在大多数情况下，我发现 Shark 比 Instruments 更快地给我答案。

Shark 当然是在 /Developer/Applications 中。如果你没有安装 CHUD，那就去做吧，否则你就错过了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T17:25:52.530

我们有一个应用程序，它使用类似于您描述的多线程视频捕获和录制。我们使用 libdc1394 从 Firewire 摄像头进行捕获，使用 NSOpenGLView 进行显示，使用 QuickTime 进行视频编码。来自摄像机的捕获与 OpenGL 视频显示和 QuickTime MPEG4 编码在单独的线程上。

几个月前，我们将此应用程序迁移到 Leopard，没有任何不良影响。事实上，每秒 30 帧视频的 CPU 负载在 Leopard 上有所降低。

您是否检查过以确保您正确处理所有 NSLock 等？我们遇到了性能问题，一个线程上的锁正在停止另一个线程上的操作，从而降低了我们的帧率。也许您可以考虑只在绝对需要它们的区域周围放置锁，或者通过实现操作的无锁版本。

# eclipse - 我在 Eclipse 中看不到我的其他项目！

> ID：264412
> 
> 赞同：2
> 
> 时间：2008-11-05T05:39:57.103
> 
> 标签：eclipse

通过右键单击一个项目并选择在新窗口中打开，我一直在单独的窗口中使用 Eclipse 和每个项目。这工作正常，但突然......即使我关闭 Eclipse 并重新打开它，导航器也只显示我正在处理的项目之一。我怎样才能导航回来？？？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T05:41:58.847

好的，我明白了：我使用了 Window -> New Window，在新窗口中一切恢复正常。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T06:45:54.177

您还可以在包资源管理器中单击该资源管理器右上角的箭头，然后选择“顶级元素/***工作集***”（而不是“顶级元素/项目”。

这样，您将返回工作集（项目集）视图，允许您在新窗口中重新打开您选择的任何项目。

当涉及到 PDT（PHP 开发环境）时，您应该在 PHP 资源管理器右上角的同一个箭头处有有用的选项：

[![](https://i.stack.imgur.com/Q8OXL.png)](https://i.stack.imgur.com/Q8OXL.png)

（并且[选择正确的文件](http://www.102degrees.com/blog/2007/07/11/show-the-right-files-in-php-explorer/)也可能令人困惑！）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-05T13:05:37.960

答案很晚，但对于将来遇到这个问题的人来说：

这可能是eclipse的一个错误。至少在我看来是这样。

技巧：关闭日食。从工作区文件夹中删除元数据文件。在同一工作区中重新启动 Eclipse。从“从现有源选项创建项目”中一一加载所有现有项目

注意：对于像我这样的懒人来说，这是一个不优雅但简单而快速的 hack。我从上面尝试了其中一些。他们都没有工作。这个工作得很好。是的一件事-您必须重置已安装的 JRE 以指向您机器上的 JDK。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T06:24:57.917

eclipse中还有一个工作空间的概念，有时会让人困惑

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T11:31:45.130

尝试停用“专注于活动任务”选项。（如果您已安装 Mylyn 插件）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-11T10:10:01.407

'顶级元素/工作集' - 不工作'窗口 - > 新窗口，在新窗口中一切恢复正常。- 两周前在旧版本的 Eclipse 上对我来说没问题，我安装了新版本，但在这里它不起作用

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-12-18T06:29:37.143

您可以遵循的最简单方法是从 eclipse 切换到另一个工作区（转到文件菜单

// 然后切换工作区）然后导入项目（文件菜单 // 导入 // 现有项目到工作区）。

# asp.net - 如何在 Eval 格式字符串中使用单引号

> ID：264414
> 
> 赞同：7
> 
> 时间：2008-11-05T05:41:52.233
> 
> 标签：asp.net, sql, eval, string-formatting

我有一个Repeater，它的SqlDatasource 嵌套在一个Gridview TemplatedField 中。
中继器的数据源 SelectCommand 使用来自 Gridview 的 Eval 的 FormatString 设置。
SelectCommand 有一个用于比较字符串的 WHERE 子句。
因为我已经使用了单引号和双引号，所以我无法在 SQL WHERE 子句中分隔字符串。

**如何在 Eval FormatString 中添加单引号？**

我试过使用“[替换](http://forums.asp.net/p/1116668/1732706.aspx#1732706)”。
我尝试过使用“[特殊字符](http://www.firstobject.com/dn_markspecialchar.htm)”（... WHERE StringField = '{0}' ...）

到目前为止没有运气。感谢您提供的任何帮助。

```
<asp:GridView ID="GridView1" runat="server" DataSourceID="DataSource1" DataKeyNames="Foo" AutoGenerateColumns="False" AllowSorting="true" >
    <Columns>
        <asp:BoundField DataField="Foo" HeaderText="Foo" SortExpression="Foo" />
        <asp:BoundField DataField="Bar" HeaderText="Bar" SortExpression="Bar" />
        <asp:TemplateField>
            <ItemTemplate>
                <asp:Repeater ID="Repeater1" runat="server" DataSourceID="DataSourceNested">
                    <ItemTemplate>
                        <asp:Label ID="Label1" runat="server" Text='<%# Eval("Blah") %>'></asp:Label>
                    </ItemTemplate>
                </asp:Repeater>
                <asp:SqlDataSource ID="DataSourceNested" runat="server" DataFile="~/App_Data/DatabaseName"
                    SelectCommand='<%# Eval("Bar", "SELECT Blah FROM TableName WHERE (StringField = {0})") %>' >
                </asp:SqlDataSource>
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-05T06:10:49.630

不要忘记 .aspx 页面只是 XML。您只需像往常一样转义引号。

例如：

```
<asp:Repeater ID="repeatTheLabel" runat="server">
    <ItemTemplate>
        <asp:Label ID="Label1" Text="<%# Eval(&quot;Id&quot;, &quot;This is item '{0}'.&quot;) %>" runat="server" />
    </ItemTemplate>
    <SeparatorTemplate>
        <br />
    </SeparatorTemplate>
</asp:Repeater> 
```

当上述表达式被数据绑定时，介于`<%#`和之间的值`%>`变为：

> `Eval("Id", "This is item '{0}'.")`

...当与具有“Id”属性值从 1 到 5 的对象数组进行数据绑定时，它在 HTML 页面上作为输出生成：

> 这是项目'1'。
> 这是项目'2'。
> 这是项目'3'。
> 这是项目'4'。
> 这是项目'5'。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T06:01:43.330

为什么不在代码隐藏中将此 WHERE 子句定义为 const。定义：

```
protected const string SELECTCLAUSE = 
"SELECT Blah FROM TableName WHERE (StringField = '{0}')"; 
```

那么您的 SelectCommand 属性将是：

```
SelectCommand='<%# Eval("Bar", SELECTCLAUSE ) %>' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T08:17:19.563

将您的 sql 查询存储在 Page 类的属性中。它不仅有效 :-)，而且使您的代码更易于阅读和维护。

哦，您应该在查询中使用参数而不是进行字符串替换。这将通过消除对单引号的需要来解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T05:48:56.540

您是否尝试过转义单引号字符？

```
... WHERE (StringField = \'{0}\') ... 
```

# c - 主 pty 如何检测从 tty 是否已退出？

> ID：264428
> 
> 赞同：1
> 
> 时间：2008-11-05T05:50:53.027
> 
> 标签：c, linux, pty

我正在使用 BSD 样式的 pty/tty 对来实现运行子 shell。当用户退出子 shell 时，如何在主进程中检测到发生这种情况？我正在使用 select(nfds, &read_fds, NULL, NULL, &timeout); 在主端的 read_fds 中设置主 pty 文件描述符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T06:07:42.023

子shell 通常由`fork()`某种类型的 a 创建。子进程的 PID 返回给主进程，主进程可以检查（`waitpid()`可能使用 ）它是否仍在运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T01:45:07.997

通过检查 GNU inetutils 包中的 telnetd 源代码，我找到了这个问题的答案。在 telnetd 中，他们使用这样的 SIGCHLD 处理程序：

```
int status;
pid_t pid = waitpid((pid_t)-1, &status, WNOHANG);
syslog (LOG_INFO, "child process %ld exited: %d",
    (long) pid, WEXITSTATUS(status));
// do cleanup code 
```

# javascript - 如何获取两个 JavaScript 对象图之间的差异列表？

> ID：264430
> 
> 赞同：19
> 
> 时间：2008-11-05T05:53:18.450
> 
> 标签：javascript, json, data-structures, diff

我希望能够获得两个 JavaScript 对象图之间所有差异的列表，以及出现差异的属性名称和值。

值得一提的是，这些对象通常以 JSON 格式从服务器检索，并且通常不超过几层深度（即，它可能是本身具有数据的对象数组，然后是具有其他数据对象的数组）。

我不仅想查看基本属性的更改，还想查看数组成员数量的差异等。

如果我没有得到答案，我可能最终会自己写这篇文章，但希望有人已经完成了这项工作，或者知道有人做过。

* * *

编辑：这些对象通常在结构上彼此非常接近，所以我们不是在谈论彼此完全不同的对象，但可能有 3 或 4 个增量。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-05T19:36:46.477

这是我的问题的部分、幼稚的解决方案——我会在进一步开发时更新它。

```
function findDifferences(objectA, objectB) {
   var propertyChanges = [];
   var objectGraphPath = ["this"];
   (function(a, b) {
      if(a.constructor == Array) {
         // BIG assumptions here: That both arrays are same length, that
         // the members of those arrays are _essentially_ the same, and 
         // that those array members are in the same order...
         for(var i = 0; i < a.length; i++) {
            objectGraphPath.push("[" + i.toString() + "]");
            arguments.callee(a[i], b[i]);
            objectGraphPath.pop();
         }
      } else if(a.constructor == Object || (a.constructor != Number && 
                a.constructor != String && a.constructor != Date && 
                a.constructor != RegExp && a.constructor != Function &&
                a.constructor != Boolean)) {
         // we can safely assume that the objects have the 
         // same property lists, else why compare them?
         for(var property in a) {
            objectGraphPath.push(("." + property));
            if(a[property].constructor != Function) {
               arguments.callee(a[property], b[property]);
            }
            objectGraphPath.pop();
         }
      } else if(a.constructor != Function) { // filter out functions
         if(a != b) {
            propertyChanges.push({ "Property": objectGraphPath.join(""), "ObjectA": a, "ObjectB": b });
         }
      }
   })(objectA, objectB);
   return propertyChanges;
} 
```

这是一个如何使用它的示例以及它将提供的数据（请原谅这个冗长的示例，但我想使用一些相对不平凡的东西）：

```
var person1 = { 
   FirstName : "John", 
   LastName : "Doh", 
   Age : 30, 
   EMailAddresses : [
      "john.doe@gmail.com", 
      "jd@initials.com"
   ], 
   Children : [ 
      { 
         FirstName : "Sara", 
         LastName : "Doe", 
         Age : 2 
      }, { 
         FirstName : "Beth", 
         LastName : "Doe", 
         Age : 5 
      } 
   ] 
};

var person2 = { 
   FirstName : "John", 
   LastName : "Doe", 
   Age : 33, 
   EMailAddresses : [
      "john.doe@gmail.com", 
      "jdoe@hotmail.com"
   ], 
   Children : [ 
      { 
         FirstName : "Sara", 
         LastName : "Doe", 
         Age : 3 
      }, { 
         FirstName : "Bethany", 
         LastName : "Doe", 
         Age : 5 
      } 
   ] 
};

var differences = findDifferences(person1, person2); 
```

此时，`differences`如果将数组序列化为 JSON，则数组如下所示：

```
[
   {
      "Property":"this.LastName", 
      "ObjectA":"Doh", 
      "ObjectB":"Doe"
   }, {
      "Property":"this.Age", 
      "ObjectA":30, 
      "ObjectB":33
   }, {
      "Property":"this.EMailAddresses[1]", 
      "ObjectA":"jd@initials.com", 
      "ObjectB":"jdoe@hotmail.com"
   }, {
      "Property":"this.Children[0].Age", 
      "ObjectA":2, 
      "ObjectB":3
   }, {
      "Property":"this.Children[1].FirstName", 
      "ObjectA":"Beth", 
      "ObjectB":"Bethany"
   }
] 
```

`this`值中的是`Property`指被比较对象的根。所以，这个解决方案还不*是*我所需要的，但它非常接近。

希望这对那里的人有用，如果您有任何改进建议，我会全力以赴；我昨晚很晚才写了这篇文章（即今天凌晨），可能有些事情我完全忽略了。

谢谢。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-07-16T15:26:24.790

查看现有答案后，我注意到[https://github.com/flitbit/diff](https://github.com/flitbit/diff)库尚未列为解决方案。

根据我的研究，这个库在积极开发、贡献和分叉方面似乎是解决差异对象挑战的最佳库。这对于在服务器端创建差异并仅将更改的位传递给客户端非常方便。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-07-08T10:08:28.977

有一个[objectDiff 库](http://github.com/NV/objectDiff.js)可以让你做到这一点。在其[演示页面上](http://nv.github.com/objectDiff.js/)，您可以看到两个 javascript 对象之间的区别。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-03-11T20:07:11.670

您还可以尝试 rus-diff [https://github.com/mirek/node-rus-diff](https://github.com/mirek/node-rus-diff)生成 MongoDB 兼容（重命名/未设置/设置）差异。

对于您的示例对象：

```
var person1 = {
  FirstName: "John",
  LastName: "Doh",
  Age: 30,
  EMailAddresses: ["john.doe@gmail.com", "jd@initials.com"],
  Children: [
    {
      FirstName: "Sara",
      LastName: "Doe",
      Age: 2
    }, {
      FirstName: "Beth",
      LastName: "Doe",
      Age: 5
    }
  ]
};

var person2 = {
  FirstName: "John",
  LastName: "Doe",
  Age: 33,
  EMailAddresses: ["john.doe@gmail.com", "jdoe@hotmail.com"],
  Children: [
    {
      FirstName: "Sara",
      LastName: "Doe",
      Age: 3
    }, {
      FirstName: "Bethany",
      LastName: "Doe",
      Age: 5
    }
  ]
};

var rusDiff = require('rus-diff').rusDiff

console.log(rusDiff(person1, person2)) 
```

它生成一个集合列表：

```
{ '$set': 
   { 'Age': 33,
     'Children.0.Age': 3,
     'Children.1.FirstName': 'Bethany',
     'EMailAddresses.1': 'jdoe@hotmail.com',
     'LastName': 'Doe' } } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-07-08T10:03:20.390

**解决方案 1**

使用 JSON.stringify(obj) 获取要比较的对象的字符串表示形式。将字符串保存到文件中。使用任何差异查看器来比较文本文件。

注意： JSON.stringify 将忽略指向函数定义的属性。

**解决方案 2**

这可以通过一些修改来完成您想要的，它是函数 _.isEqual ( [http://documentcloud.github.com/underscore/](http://documentcloud.github.com/underscore/insp) ) 的修改版本。请随时提出任何修改建议！我写它是为了弄清楚两个对象之间的第一个区别发生在哪里。

```
// Given two objects find the first key or value not matching, algorithm is a
// inspired by of _.isEqual.
function diffObjects(a, b) {
  console.info("---> diffObjects", {"a": a, "b": b});
  // Check object identity.
  if (a === b) return true;
  // Different types?
  var atype = typeof(a), btype = typeof(b);
  if (atype != btype) {
    console.info("Type mismatch:", {"a": a, "b": b});
    return false;
  };
  // Basic equality test (watch out for coercions).
  if (a == b) return true;
  // One is falsy and the other truthy.
  if ((!a && b) || (a && !b)) {
    console.info("One is falsy and the other truthy:", {"a": a, "b": b});
    return false;
  }
  // Unwrap any wrapped objects.
  if (a._chain) a = a._wrapped;
  if (b._chain) b = b._wrapped;
  // One of them implements an isEqual()?
  if (a.isEqual) return a.isEqual(b);
  // Check dates' integer values.
  if (_.isDate(a) && _.isDate(b)) return a.getTime() === b.getTime();
  // Both are NaN?
  if (_.isNaN(a) && _.isNaN(b)) {
    console.info("Both are NaN?:", {"a": a, "b": b});
    return false;
  }
  // Compare regular expressions.
  if (_.isRegExp(a) && _.isRegExp(b))
    return a.source     === b.source &&
           a.global     === b.global &&
           a.ignoreCase === b.ignoreCase &&
           a.multiline  === b.multiline;
  // If a is not an object by this point, we can't handle it.
  if (atype !== 'object') {
    console.info("a is not an object:", {"a": a});
    return false;
  }
  // Check for different array lengths before comparing contents.
  if (a.length && (a.length !== b.length)) {
    console.info("Arrays are of different length:", {"a": a, "b": b});
    return false;
  }
  // Nothing else worked, deep compare the contents.
  var aKeys = _.keys(a), bKeys = _.keys(b);
  // Different object sizes?
  if (aKeys.length != bKeys.length) {
    console.info("Different object sizes:", {"a": a, "b": b});
    return false;
  }
  // Recursive comparison of contents.
  for (var key in a) if (!(key in b) || !diffObjects(a[key], b[key])) return false;
  return true;
}; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-24T11:01:34.570

如果你使用的是 NodeJS，这个脚本也有一个 NPM 版本。[https://github.com/NV/objectDiff.js](https://github.com/NV/objectDiff.js)

麾。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-06T20:27:10.083

我最近写了一个模块来做这件事，因为我对我发现的众多不同的模块不满意（我列出了一堆最流行的模块以及为什么它们在我的模块的自述文件中不可接受）。它被称为`odiff`：[https](https://github.com/Tixit/odiff) ://github.com/Tixit/odiff 。这是一个例子：

```
var a = [{a:1,b:2,c:3},              {x:1,y: 2, z:3},              {w:9,q:8,r:7}]
var b = [{a:1,b:2,c:3},{t:4,y:5,u:6},{x:1,y:'3',z:3},{t:9,y:9,u:9},{w:9,q:8,r:7}]

var diffs = odiff(a,b)

/* diffs now contains:
[{type: 'add', path:[], index: 2, vals: [{t:9,y:9,u:9}]},
 {type: 'set', path:[1,'y'], val: '3'},
 {type: 'add', path:[], index: 1, vals: [{t:4,y:5,u:6}]}
]
*/ 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-05-18T19:18:40.943

我找到的库都不够用，所以我编写了自己的 AngularJS 工厂。它以两种方式比较对象并仅返回同一结构内的差异。

```
/**
 * Diff
 * Original author: Danny Coulombe
 * Creation date: 2016-05-18
 * 
 * Work with objects to find their differences.
 */
controllers.factory('diff', [function() {

    var factory = {

        /**
         * Compare the original object with the modified one and return their differences.
         * 
         * @param original: Object
         * @param modified: Object
         * 
         * @return Object
         */
        getDifferences: function(original, modified) {

            var type = modified.constructor === Array ? [] : {};
            var result = angular.copy(type);
            var comparisons = [[original, modified, 1], [modified, original, 0]];

            comparisons.forEach(function(comparison) {

                angular.forEach(comparison[0], function(value, key) {

                    if(result[key] === undefined) {

                        if(comparison[1][key] !== undefined && value !==    null && comparison[1][key] !== null && [Object, Array].indexOf(comparison[1][key].constructor) !== -1) {

                            result[key] = factory.getDifferences(value, comparison[1][key]);
                        }
                        else if(comparison[1][key] !== value) {

                            result[key] = comparison[comparison[2]][key];
                        }

                        if(angular.equals(type, result[key])
                        || result[key] === undefined
                        || (
                            comparison[0][key] !== undefined
                            && result[key] !== null
                            && comparison[0][key] !== null
                            && comparison[0][key].length === comparison[1][key].length
                            && result[key].length === 0
                        )) {
                            delete result[key];
                        }
                    }
                });
            });

            return result;
        }
    };

    return factory;
}]); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-11-10T06:04:50.647

```
var d = { 
   FirstName : "John", 
   LastName : "Doh", 
   Age : 30, 
   EMailAddresses : [
      "john.doe@gmail.com", 
      "jd@initials.com"
   ], 
   Children : [ 
      { 
         FirstName : "Sara", 
         LastName : "Doe", 
         Age : 2 
      }, { 
         FirstName : "Beth", 
         LastName : "Doe", 
         Age : 5 
      } 
   ] 
};

var f = { 
   FirstName : "John", 
   LastName : "Doe", 
   Age : 33, 
   EMailAddresses : [
      "john.doe@gmail.com", 
      "jdoe@hotmail.com"
   ], 
   Children : [ 
      { 
         FirstName : "Sara", 
         LastName : "Doe", 
         Age : 3 
      }, { 
         FirstName : "Bethany", 
         LastName : "Doe", 
         Age : 5 
      } 
   ] 
};

resultobj = []
function comp_obj(t1,t2){
	flag = 1;
	key1_arr = Object.keys(t1)
	key2_arr = Object.keys(t2)
	if(key1_arr.length == key2_arr.length){
		for(key1 in t1){
			ty1    = Object.prototype.toString.call(t1[key1])
			ty2    = Object.prototype.toString.call(t2[key1])
			if(ty1 == ty2) {
				if(ty1 == '[object String]' || ty1 == '[object Number]' ){
					if(t2[key1] != t1[key1]){
						flag = 0;
						break;
					}	
				}else if(ty1 == '[object Array]'){
					var result = comp_arr(t1[key1],t2[key1]);
					console.log(ty1,ty2)
					if(!result)
						flag = 0;
				}else if(ty1  == '[object Object]'){
					var result = comp_obj(t1[key1],t2[key1])
					if(!result)
						flag = 0;

				}
			}else{
				flag = 0;
				break;	
			}

		}
	}else{
		flag	= 0;
	}
	if(flag)
		return true
	else
		return false;
}
function comp_arr(a,b){
	flag = 1;
	if(a.length == b.length ){
		for(var i=0,l=a.length;i<l;i++){
			type1    = Object.prototype.toString.call(a[i])
			type2    = Object.prototype.toString.call(b[i])
			if(type1 == type2) {
				if(type1 == '[object String]' || type1 == '[object Number]' ){
					if( a[i] != b[i]){
						flag = 0;
						break;
					}	
				}else if(type1 == '[object Array]'){
					var result = comp_arr(a[i],b[i]);
					if(!result)
						flag = 0;
				}else if(type1  == '[object Object]'){
					var result = comp_obj(a[i],b[i])
					if(!result)
						flag = 0;
				}	
			}else{
				flag = 0;
				break;	
			}
		}
	}else
		 flag = 0;
	if(flag)
		return true
	else
		return false;
}
function create(t,attr,parent_node,innerdata){
	var dom = document.createElement(t)
	for(key in attr){
		dom.setAttribute(key,attr[key])
	}
	dom.innerHTML = innerdata;
	parent_node.appendChild(dom)
	return dom;
}
window.onload = function () {
	for(key in f){
		if(!(key in d)) 
			resultobj.push({'Property_name':key,'f_value':JSON.stringify(f[key]),'d_value':JSON.stringify(d[key])})
		type1    = Object.prototype.toString.call(f[key])
		type2    = Object.prototype.toString.call(d[key])
		if(type1 == type2){
			if(type1 == '[object String]' || type1 == '[object Number]' ){
				if(f[key] != d[key])
					resultobj.push({'Property_name':key,'f_value':JSON.stringify(f[key]),'d_value':JSON.stringify(d[key])})
			}else if(type1 == '[object Array]'){
				var result = comp_arr(f[key],d[key]);
				if(!result)
					resultobj.push({'Property_name':key,'f_value':JSON.stringify(f[key]),'d_value':JSON.stringify(d[key])})
			}else if(type1 == '[object Object]'){
				var result = comp_obj(f[key],d[key])	
				if(!result)
					resultobj.push({'Property_name':key,'f_value':JSON.stringify(f[key]),'d_value':JSON.stringify(d[key])})
			}
		}else 
			resultobj.push({'Property_name':key,'f_value':JSON.stringify(f[key]),'d_value':JSON.stringify(d[key])})
	}
	var tb = document.getElementById('diff');
	var s1 = document.getElementById('source1');
	var s2 = document.getElementById('source2');
	s1.innerHTML = 'Object 1 :'+ JSON.stringify(f)
	s2.innerHTML = 'Object 2 :'+JSON.stringify(d)
	resultobj.forEach(function(data,i){
			tr_dom = create('tr',{},tb,'')
			no = create('td',{},tr_dom,i+1)
			Object.keys(data).forEach(function(tr){
				td_dom = create('td',{},tr_dom,data[tr])
			})
	})
}
```

```
 <html>
    <body>
      <p id="source1"> </p>
      <p id="source2"> </p>
      <p id="source7"> DIFFERENCE TABLE</p>
      <table border=''>
        <thead>
          <th>S.no</th>
          <th>Name Of the Key</th>
          <th>Object1 Value</th>
          <th>Object2 Value</th>
        </thead>
        <tbody id="diff">

        </tbody>
      </table>
    </body>
</html>
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-25T16:35:33.110

你可以用 filter 和 indexOf 来做

```
var first = [ 1, 2, 3, 4, 5 ];
var second = [ 4, 5, 6 ];

var difference = first.filter(x => second.indexOf(x) === -1);
console.log(difference); 
```

# objective-c - 将 plist 转换为二进制 plist

> ID：264440
> 
> 赞同：20
> 
> 时间：2008-11-05T06:00:45.283
> 
> 标签：objective-c, iphone, cocoa-touch, plist, core-foundation

在将基于 XML 的大型数据集读入 iPhone 应用程序时，Apple 强烈建议使用二进制 plist 格式。他们的理由之一是 XML 解析在 iPhone 上非常繁重。但是，这需要先转换位于远程 Web 服务器上的文件。

对于频繁更改的内容，手动执行此操作是不可接受的。如果可能的话，我想避免让基于 Web 的应用程序调用命令行来执行转换（即 plutil）。

是否有公开可用的算法来执行此转换？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-05T06:39:10.620

是的。所有 plist 代码都是 CoreFoundation 的一部分，它是开源的。CoreFoundation 可以直接在 Linux 和 Windows 上构建和运行，因此您可以使用在 Mac OS X 上使用的普通 API 编写 CF 工具，但在其他平台上构建和运行它。

您要查看的特定 API 是[CFPropertyListWriteToStream()](http://developer.apple.com/documentation/CoreFoundation/Reference/CFPropertyListRef/Reference/reference.html#//apple_ref/c/func/CFPropertyListWriteToStream)。CoreFoundation 的代码可从[Apple](http://www.opensource.apple.com/darwinsource/10.5.5/CF-476.15/) ( [tarball](http://www.opensource.apple.com/darwinsource/tarballs/apsl/CF-476.15.tar.gz) ) 等其他地方获得。

最后，取决于您更新文件的频率、服务器上必须保留多少处理器以及数据的重复次数，您可能还剩下一项重要的增强功能。默认情况下，二进制 plist 中的某些元素是唯一的（例如字符串）。其他元素不是（例如数组和字典）。二进制 plist 格式允许它们是唯一的，问题是实际遍历和唯一的数组和字典的成本很高。如果您的内容中有很多相同的数组或 dicts，您可能会看到通过使它们唯一化而显着减小了大小。您可以通过破解 CFBinaryPlist.c 中的 _flattenPlist() 来启用[它](http://www.opensource.apple.com/darwinsource/10.5.5/CF-476.15/CFBinaryPList.c)。

如果您这样做，请确保对其进行非常彻底的测试，并且不要对无法通过网络更新的任何文件执行此操作，以防万一将来的版本进行任何优化会破坏它。此外，请确保您已准备好立即将其关闭。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-12-06T18:55:25.447

有一个 PHP 和 ruby​​ 实现：

[http://code.google.com/p/cfpropertylist/](http://code.google.com/p/cfpropertylist/)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-02-13T11:28:06.110

链接的 Ruby 实现仅是 Ruby 1.9。我敲开了一个在 Ruby 1.8 中工作的快速二进制序列化程序。

[http://gist.github.com/303378](http://gist.github.com/303378)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-05T06:38:45.770

目前尚不清楚您是要在 iPhone 上还是在服务器上进行转换。如果它在服务器上，并且您可以使用 Cocoa 框架，则`NSPropertyListSerialization`提供服务以在 OS X（自 10.2 起）上支持的 plist 类型（字符串、XML 和二进制）之间进行转换。如果您更愿意使用 Core Foundation 库中的类似方法，那么您也可以使用它。

要将 XML plist 转换为二进制 plist：

```
NSString *xmlPlistPath; // already set
NSString *outPath; // already set

NSData *plistData;
NSString *error;
NSPropertyListFormat format;
id plist;
plistData = [NSData dataWithContentsOfFile:xmlPlistPath];

plist = [NSPropertyListSerialization propertyListFromData:plistData
                                         mutabilityOption:NSPropertyListImmutable
                                                   format:&format
                                         errorDescription:&error];

if(plist == nil) { // unable to parse plist
    //deal with failure -- error gives description of the error
} else {
    binaryPlistData = [NSPropertyListSerialization dataFromPropertyList:plist
                                                                 format:NSPropertyListBinaryFormat_v1_0
                                                       errorDescription:&error];
    if(binaryPlistData == nil) {//unable to create serialized plist
         // deal with failure -- error gives description of the error
    }

    if(![binaryPlistData writeToFile:outPath atomically:YES]) {
        // unable to write file
    }
} 
```

有关更多信息，请参阅developer.apple.com 上的[Property List Pramming Guide](http://developer.apple.com/documentation/Cocoa/Conceptual/PropertyLists/Articles/SerializedPListsConcept.html#//apple_ref/doc/uid/20001016-55191)页面。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-16T05:14:30.460

还有一个 Perl 实现也称为 [Data::Plist](https://metacpan.org/pod/Data::Plist)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-06-05T14:24:38.653

## 命令行工具 plutil - 属性列表实用程序

Apple 有两个非常好的命令行工具来处理属性列表文件。

*   `/usr/libexec/Plistbuddy`- 用于编辑 plist
*   `/usr/bin/plutil`- 语法检查和类型转换

## 从 plutil 手册页：

> plutil 可用于检查属性列表文件的语法，或将 plist 文件从一种格式转换为另一种格式。指定 - 作为从标准输入读取的输入文件。

### 将现有 plist 转换为 XML、二进制或 JSON 格式

```
plutil -convert xml1 stops2.plist
plutil -convert binary1 stops2.plist
plutil -convert json stops2.plist 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-12T06:16:55.477

将 plist 添加为 Rails 控制器的有效响应格式的[binary_plist gem看起来很有希望。](https://github.com/samsoffes/binary_plist)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-04-25T03:45:34.817

几天前，我发现在 iOS 中与 plist 二进制数据联网时遇到了一些问题，而`Gist`我的这个是为了简单地解决问题：[用 Swift 编写的 Plist Converter](https://gist.github.com/ngbaanh/f9c640e64e60189c7dc5e37fbce4b4f1)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-11-15T05:42:22.827

[Java Spring框架解决方案](https://github.com/uddhav/java-plist-serializer)

# php - 是否存在在 1 行中执行以下操作的本机 php (5+) 函数？

> ID：264441
> 
> 赞同：1
> 
> 时间：2008-11-05T06:00:47.140
> 
> 标签：php, arrays

```
function array_value_from_key($array,$key)
{
     return !empty($array[$key]) ? $array[$key] : null;
} 
```

我问的原因是因为我有一个返回数组的类函数。

而不是必须做

```
$myArray = myClass::giveMeArray();
$myValue = $myArray[$myKey]; 
```

我想做一些类似的事情

```
$myValue = array_value_from_key(myClass::giveMeArray(),$myKey); 
```

当返回一个对象时，您可以链接该对象，例如

```
$myValue = myClass::giveMeObject()->aValue; 
```

瞧，漂亮又干净……找不到看似简单而琐碎的功能让我发疯了……

PS ..我想如何使用这样一个功能的另一个例子

```
if(arrayKeyVal(aClass::giveMeArray(),$myKey)) {
    do_something();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T08:48:58.097

你可以像这样返回一个[ArrayObject](http://www.php.net/~helly/php/ext/spl/classArrayObject.html)。

```
<?
class MyClass
{
    public static function getArray()
    {
        $arr = array('dave' => 1, 'bob' => 2, 'james' => 3);
        return new ArrayObject($arr, ArrayObject::ARRAY_AS_PROPS);
    }
}

$var = MyClass::getArray()->bob;

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T06:22:07.253

我没试过，但是：

```
$myValue = @$myArray[$myKey]; 
```

可能有用，但老实说，我认为你最好使用

```
$myValue = (array_key_exists($myKey, $myArray)) ? $myArray[$myKey] : null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-19T05:22:51.270

$myValue = ($tmp = myClass::giveMeArray() && $tmp[$myKey]) ？$tmp[$myKey] : null;

它并不漂亮，但它会在一行中完成所有操作。;-)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-05T10:27:34.137

Why don't you change the giveMeArray() function like so:

```
function giveMeArray($key = false) {
    $array = $whatever;
    $toret = null;
    if ($key) {
        if (array_key_exists($key, $array)) {
            $toret = $array[$key];
        }
    } else {
        $toret = $array()
    }
    return $toret;
} 
```

Then you can call it as

```
$arr = myClass::giveMeArray(); //To get the whole array
$value = myClass::giveMeArray($myKey); //To get the specific element 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-05T06:43:12.983

**编辑**：原来我需要复习一下我的 PHP5。我在下面的回答是不正确的，只适用于 PHP4，因为 PHP5 有[方法链](http://www.talkphp.com/advanced-php-programming/1163-php5-method-chaining.html)。

* * *

PHP 不允许您像在许多其他语言中那样将函数的返回语句链接在一起。例如，在 Javascript 中：

```
document.getElementById('abc').style.color = "#fff"; 
```

这有点痛苦，但就是这样。您在 PHP 中必须做的等效操作是存储临时变量。如果是 PHP，您必须编写以上内容：（显然这些不是真正的 PHP 函数）

```
$myElement = $document->getElementById('abc');
$myElement->style->color = "#fff"; 
```

一点积极的一面是，它使调试变得更容易一些。

请注意，这仅适用于函数：您可以“链接”对象的属性：

```
$myObject->myArray[5]->anotherProperty->anotherArray[3]->anotherObject->aFunction(); 
```

所以，简而言之，如果你想使用一个函数的结果，你必须先临时存储它

# apache - 配置 webserver:80 以将域名请求定向到同一台机器上不同的正在运行的 webserver:8080，不同的端口？

> ID：264454
> 
> 赞同：0
> 
> 时间：2008-11-05T06:11:16.433
> 
> 标签：apache, jetty

我运行 Jetty6，但如果需要，我很乐意将 Apache 放在前面。

我想在同一台机器上的不同端口上运行两个网络服务器实例。我希望端口 80 上的实例将第二个公共域名重定向到端口 8080 上的第二个网络服务器。

这不应该对网络用户可见。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T06:26:19.193

只需使用 apache 的 mod_proxy 就可以解决您的问题

```
 ProxyRequests Off

  <Proxy *>
    Order deny,allow
    Allow from all
  </Proxy>

  ProxyPass        /  http://localhost:8080/
  ProxyPassReverse /  http://localhost:8080/ 
```

更多关于[apache 文档](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html#proxypass)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T06:26:29.677

[nginx](http://nginx.net/)设置为代理是执行此操作的常用方法。它有很好的声誉，我个人知道有几个高流量网站使用它并取得了很好的效果。

twiki有很多信息，[这个代理设置](http://wiki.codemongers.com/NginxTurboGearsProxy)[可能](http://wiki.codemongers.com/Main)与您正在寻找的类似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T06:20:08.613

如果我正确理解您的问题，您需要在 Apache 中启用 mod_proxy，然后在端口 80 上运行的 Web 服务器上使用此行。

ProxyPassReverse / [http://localhost:8080/](http://localhost:8080/)

这会将所有对端口 80 的请求反向代理到端口 8080。

# mysql - sqlite3和mysql之间有速度差异吗？

> ID：264457
> 
> 赞同：10
> 
> 时间：2008-11-05T06:12:26.803
> 
> 标签：mysql, ruby-on-rails, database, sqlite

经过大量谷歌搜索后，我一直想知道 mysql 和 sqlite3 之间有什么好处/区别。我主要希望在将我的开发数据库移动到我的生产数据库时减速，尽管我认为这主要发生在我的代码中。有谁知道性能上的主要区别是什么？在那里？或者你能指出一些比较这两者的文献的方向吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-05T06:26:37.120

我希望从您的问题来看，您不是在谈论在开发和生产中使用不同的数据库系统。

如果您在开发和生产中使用不同的数据库，请不要。不同的数据库引擎表现不同，会导致出现意想不到的错误。尽量让你的开发系统接近生产环境（提示：在虚拟机中运行）

SQLite 和 MySQL 在正确的环境中都是很好的产品。了解他们的能力是什么。

SQLite：

*   与客户端应用程序在进程内运行
*   没有网络能力
*   因此，查询开销非常低
*   对于简单的查询来说可能相当快，因为​​要做的 IPC、系统调用和数据复制更少。
*   并发性非常有限（我认为每个数据库文件是一个作者或多个读者）

MySQL：

*   更多功能
*   引擎的选择（InnoDB 为许多工作负载提供了良好的功能）
*   更多地控制存储、备份、恢复等
*   支持网络 - 允许在大规模应用中使用
*   更好的并发性——InnoDB 引擎有 MVCC，这意味着读取器不会阻塞写入器，写入器也不会阻塞读取器。即使是旧的 MyISAM 引擎也有表级锁定，而不是整个数据库的 sqlite。
*   可能是复杂查询的更好优化器

简而言之，您无法真正比​​较它们。SQLite 作为一种嵌入式数据库非常流行——Firefox 3 里面就有一个。

在 SQLite 中，您被困在将数据库存储在本地磁盘（当然，如果有的话，也可以是网络磁盘）上。如果您想扩展您的 Web 应用程序，您可能必须使用基于服务器的数据库，例如 MySQL。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-05T16:02:18.003

SQLite 是一个嵌入式数据库引擎，但它与您的应用程序在同一进程中运行。MySQL，是一个在自己的进程中运行的数据库服务器。

SQLite 不会浪费处理和带宽打包应用程序服务器进程和数据库服务器进程之间的请求。它只是解析请求，确定要做什么（查询计划），然后在 SQLite 数据库文件上调用 fopen() 并执行查询。

当您的站点受到大量并发请求的冲击时，MySQL 会更好，并且您需要额外的线程和队列来正确处理所有请求。

如果您的网站每天的点击量不超过 100000 次，或者您的数据库大小不超过 25 GB，那么 SQLite 可能是最好的数据库。SQLite 的另一个优点是，您通常可以在额外进程或数据库服务器稀缺的情况下轻松使用它。查看[http://www.sqlite.org/whentouse.html](http://www.sqlite.org/whentouse.html)。

您还可以使用 SQLite 做其他事情。查看[http://www.squidoo.com/sqlitehammer](http://www.squidoo.com/sqlitehammer)了解有关 SQLite 的其他见解。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T07:01:18.593

这里有一个简单的方法来看待它：Sqlite 是记事本，MySQL 是 MS Word。两者基本上都做同样的事情，但它们的核心非常非常不同，用于不同的目的。

Sqlite 是一个很好的数据库，而且通常足够好，而 MySQL 是一个复杂得多的系统，但随着复杂性的增加，强大的功能也随之而来。

我还必须建议不要在开发和生产中使用不同的数据库。使用与客户使用的不同的东西是愚蠢的。如果您在开发时需要加速，您的客户可以在使用您的程序时使用相同的加速。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-05T07:57:32.943

## SQLite 是最快的

SQLite 只能通过一个连接访问，使用文件系统存储所有内容，不使用任何服务器。

它又快又轻。实际上应该是 MySQL 的两倍。

## SQLite 和 MySQL 不用于相同的任务

您将 SQLite 用于不需要存储超过 5 Go 数据的简单应用程序。EG：本地议程、音乐播放器、模拟或什至用于您将嵌入 USB 密钥的网站演示。

否则，需要为更大的项目选择Mysql，因为它可以处理大量数据并且可以同时访问。您可以将它用于具有用户访问权限的网站、Intranet 等。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T16:10:41.527

这在不同的语言中可能会有所不同，但是如果您只是偶尔修改数据库，那么在 PHP 中 SQLite 是很好的。这是因为为了确保完整性，每当要修改数据库时，都会锁定 SQLite 文件，进行更改并将其写入文件，然后解锁文件。在此期间，任何其他进程都无法访问数据库，并且在此期间来自其他进程的请求是否失败或阻塞取决于实现。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-11-19T11:32:02.760

实际上，我发现自己需要重新投影我的程序的数据库逻辑（已经在生产中），因为 SQlite 的一个错误是，当面临相对大量的数据和操作时，它根本无法锁定数据库并将其保留，直到程序关闭，意味着每个程序数据的进度都是暂时的，然后每次添加都会丢失。可爱吗？

迁移到 MySql，我明白了，我尝试了一些方法来测试速度差异，结果发现在 280'500 条记录的表上像“UPDATE table SET column1=column1”这样的安全查询，SQlite 需要大约 13秒，而 MySql 只用了 1 秒。

我仍然不是数据库专家，但选择是一个简单的考虑：如果您需要一个简单的内存存储来存储有限的数据量、复杂性和并发性（例如小型实用程序或使用非关键数据运行的程序），那么SQlite 会很好，否则当你需要稳定性、并发性、大量数据、查询复杂时，你的数据库将是 MySql。

关于开发和生产中的不同数据库我不同意，但如果你这样做了，你肯定有充分的理由。

# java - Windows 上的 Java RS-232 通信

> ID：264469
> 
> 赞同：9
> 
> 时间：2008-11-05T06:25:38.197
> 
> 标签：java, windows, serial-port

有谁知道用于在 WIN32 环境中控制 RS-232 设备的良好 Java API？我试过 RXTX 但他们不支持 RS232，只支持 RS-485。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T06:46:51.710

毫无保留，我推荐来自[serialio.com](http://serialio.com)的 Java Serial Port 。我在使用 Sun、IBM 和 RxTx 串行包时遇到了严重的稳定性问题。SerialPort 在 24/7 的生产中已经坚如磐石了 2 年多。

它们支持标准的 Java 串行 API，以及它们自己的替代专有 API。不过，我会坚持使用标准 API，除非你真的需要标准 API 不需要的东西，只是为了让你的选择保持开放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-12-08T21:45:09.433

我建议你试试 jSSC。此库支持 Win32(Win98 - Win7) 和 Win64。Linux 版本正在建设中。Google 代码上的项目页面：[http ://code.google.com/p/java-simple-serial-connector/](http://code.google.com/p/java-simple-serial-connector/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T06:34:04.653

[J/CoMM](https://sourceforge.net/projects/jcomm/)呢？

> 独立于操作系统的 RS232 远程控制。基于 Java 的服务器（控制台），易于调整的 HTML GUI，本地/互联网使用，包括。设备驱动程序 API 和驱动程序（例如 EIKI LC-XM1/SM1/VM1！！）

[![替代文字](https://i.stack.imgur.com/jfNAz.jpg)](https://i.stack.imgur.com/jfNAz.jpg)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-09T17:29:25.640

我刚刚使用 Java 1.6 和 Windows 7 64 位快速且没有问题地使用 Scream3r 的 jSSC 库实现了一个单向接口（设备-> 计算机）。

提示：如果您查看他在 jSSC-Terminal.zip 中的附加代码，您会得到一个很好的（并且对于使用 lib 至关重要）示例如何使用该库！

谢谢你 Scream3r 分享这个，你让我很开心！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-04T17:38:56.560

我偶然发现了 scm，它是另一个用于 RS232 串行端口通信的开源库。项目页面是[https://github.com/RishiGupta12/serial-communication-manager](https://github.com/RishiGupta12/serial-communication-manager)

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2008-11-05T06:34:42.470

你试过Sun 的[Javacomm](http://java.sun.com/products/javacomm/)吗？

# php - PHP删除字符串中的一个字符

> ID：264480
> 
> 赞同：44
> 
> 时间：2008-11-05T06:34:40.317
> 
> 标签：php, string

我的 php 很弱，我正在尝试更改此字符串：

```
http://www.example.com/backend.php?/c=crud&m=index&t=care
                                   ^ 
```

成为：

```
http://www.example.com/backend.php?c=crud&m=index&t=care
                                  ^ 
```

删除. `/`_ `backend.php?`关于最好的方法的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2008-11-05T06:49:01.207

我认为最好简单地使用[str_replace](http://www.php.net/str_replace)，就像手册说的那样：

> 如果您不需要花哨的替换规则（如正则表达式），则应始终使用此函数而不是 ereg_replace() 或 preg_replace()。

```
<?
$badUrl = "http://www.site.com/backend.php?/c=crud&m=index&t=care";
$goodUrl = str_replace('?/', '?', $badUrl); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T06:37:38.297

```
$str = preg_replace('/\?\//', '?', $str); 
```

编辑：请参阅 CMS 的答案。晚了，我应该知道的更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T06:41:28.663

虽然正则表达式在这里很适合，但我将向您介绍另一种方法。它*可能*比等效的正则表达式快一点，但生活就是选择（......或其他东西）。

```
$length = strlen($urlString);
for ($i=0; $i<$length; i++) {
  if ($urlString[$i] === '?') {
    $urlString[$i+1] = '';
    break;
  }
} 
```

很奇怪，我知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T06:49:41.830

```
$splitPos = strpos($url, "?/");
if ($splitPos !== false) {
    $url = substr($url, 0, $splitPos) . "?" . substr($url, $splitPos + 2);
} 
```

# firefox - 如何生成 SSL 证书？如何在 FF3 中访问证书无效的页面？

> ID：264482
> 
> 赞同：1
> 
> 时间：2008-11-05T06:36:18.177
> 
> 标签：firefox, ssl-certificate

我无法在 firefox3 中访问 localhost https 页面。它给出了错误

> '无法安全连接，因为 SSL 协议已被禁用。（错误代码：ssl_error_ssl_disabled）'

我通过 about:config 启用了所有与 SSL2 相关的首选项，错误更改为

> '数据传输错误浏览器连接成功，但传输信息时连接中断。请再试一次。'

第一个错误似乎很可能是由于证书无效，但无法弄清楚第二个......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T09:13:01.073

什么 Web 服务器为这些页面提供服务？是 IIS 还是 Apache？您是否尝试使用其他浏览器访问这些页面？如果问题出在浏览器或 Web 服务器中，回答问题将提供线索。

[这是如何创建 SSL 证书的好链接](http://blogs.technet.com/jhoward/archive/2005/02/02/365323.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T09:34:20.343

使用 openssl 创建自签名证书的快速方法：

```
openssl req -new -x509 -days 365 -nodes -out /etc/apache2/cert.pem -keyout /etc/apache2/cert.pem -subj '/C=US/ST=Yourstate/L=Yourcity/O=Your Company, Inc./OU=Development/CN=your.vhostname.com/emailAddress=youremail@example.com' 
```

（最好单独创建一个 CA 证书并使用它来创建一个要使用的证书；当您使用像上面这样的自签名证书时，apache 会向错误日志抱怨。但我没有方便的方法来做到这一点。）

然后在你的 apache 配置中（如果需要，分别为每个虚拟主机），说：

```
SSLEngine on
SSLCertificateFile /etc/apache2/cert.pem 
```

并确保 mod_ssl 已启用。

您可以使用 curl 来调试您的问题：

```
$ curl -sSvk https://your.vhostname.com 2>&1 | less 
```

# c# - 这些比较应该返回什么？

> ID：264495
> 
> 赞同：3
> 
> 时间：2008-11-05T06:45:24.710
> 
> 标签：c#, .net, string, comparison

我有一个使用 string.compare(string,string) 对一些值进行排序的应用程序。我不明白为什么“1022”比较小于“10-23”而“10-23”比较小于“1024”。

是否有特定于“-”值的东西导致了这个结果？string.compare 的重载是否会为相同类型的数据（带有破折号的数字）在不同的文化设置下给出相同的结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T07:15:50.937

从[string.Compare(String, String)](http://msdn.microsoft.com/en-us/library/84787k22.aspx)的文档中：

> 使用单词排序规则进行比较。

并[进一步](http://msdn.microsoft.com/en-us/library/system.globalization.compareoptions.aspx)：

> .NET Framework 使用三种不同的排序方式：单词排序、字符串排序和序数排序。Word 排序对字符串执行区分区域性的比较。某些非字母数字字符可能具有分配给它们的特殊权重。例如，连字符（“-”）可能分配给它的权重非常小，因此“coop”和“co-op”在排序列表中彼此相邻出现。字符串排序类似于单词排序，只是没有特殊情况。因此，所有非字母数字符号都位于所有字母数字字符之前。序数排序根据字符串中每个元素的 Unicode 值比较字符串。

来自 Michael Kaplan 的更多详细信息：[排序键的 A&P，第 9 部分（又名不总是可传递的，但准时和标点符号）](http://www.siao2.com/2007/09/20/5008305.aspx)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T07:01:51.870

好吧，忽略破折号是相当无辜的。如果你想包含它们，也许`StringComparison.Ordinal`在重载中使用。

阅读[文档`string.Compare`](http://msdn.microsoft.com/en-us/library/84787k22.aspx)，它使用单词排序规则，这[意味着](http://msdn.microsoft.com/en-us/library/system.globalization.compareoptions.aspx)：

> Word 排序对字符串执行区分区域性的比较。某些非字母数字字符可能具有分配给它们的特殊权重。例如，连字符（“-”）可能分配给它的权重非常小，因此“coop”和“co-op”在排序列表中彼此相邻出现。

至少它是可传递的：我用“连接”记录了一个关于破折号的非常相似的[错误- 其中 A < B、B < C](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=236900)*和*C < A。因为非传递比较本质上违反了排序规则。它被关闭“不会修复”。这里是：

```
string s1 = "-0.67:-0.33:0.33";
string s2 = "0.67:-0.33:0.33";
string s3 = "-0.67:0.33:-0.33"; 
Console.WriteLine(s1.CompareTo(s2));
Console.WriteLine(s2.CompareTo(s3));
Console.WriteLine(s1.CompareTo(s3)); 
```

（在我的机器上返回 1,1,-1）

# c#-3.0 - 我们应该使用通用集合来提高安全性和性能吗？

> ID：264496
> 
> 赞同：1
> 
> 时间：2008-11-05T06:45:31.527
> 
> 标签：c#-3.0

我们应该使用通用集合来提高安全性和性能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T06:51:30.797

当然。你为什么不呢？IMO 比性​​能更重要的是通用 API 更具表现力。这适用于一般的通用 API，而不仅仅是集合。

编辑：只是为了澄清这些：

*   由于“它们是不同的实现”以及整个泛型/非泛型方面的原因，泛型和非泛型集合之间的性能特征略有不同。显然，通用版本避免了装箱/拆箱和（在大多数用例中）获取时的执行时间转换。在实践中，这可能只对值类型有意义，因为拳击开始发挥作用。对于大型集合，内存使用的差异可能比执行*速度*的差异更显着。

*   我对实际的类型安全方面不太担心。这当然是一件好事，但我不记得在使用非泛型集合时由于放入了错误的类型（或将其作为错误的类型获取）而实际看到过错误。虽然这肯定是一个好处。

*   我认为表达*能力非常*重要。我可以看一眼方法的声明，并知道从返回值中可以得到什么——我不需要仔细阅读文档，也不需要像笨拙的名称或文档一样给出变量。此外，您还可以获得 Intellisense 等的所有好处。关于语言的问题之一是“我能用它表达什么？” 泛型允许表达比以前更丰富的概念。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T06:51:00.067

绝对地。

传统的集合，例如 ArrayList，隐式存储对象。

这意味着，这样做：

```
ArrayList list = new ArrayList();
list.Add(5);
list.Add("FooBar"); 
```

是合法代码。这引入了一些问题。

*   通常，您不希望在同一个集合中存储不同的类型，并且有编译时检查这一点很好。
*   当你存储一个值类型（比如上面的整数 5）时，必须先将它装箱成引用类型，然后才能存储到集合中。
*   读取值时，必须将其从 Object 转换回所需的类型。

但是，您可以通过使用泛型集合消除所有这些问题：

```
List<int> list = new List();
list.Add(5);
// Compile Time Error.
list.Add("FooBar") 
```

直接使用集合的索引时，您还可以获得智能感知支持，而不仅仅是通用的“对象”智能感知。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T06:55:57.077

简短的回答：是的

更长的答案：使用泛型集合确实没有缺点。编译时类型检查消除了强制转换中出现运行时错误的可能性。内置类型（例如整数）的性能会更好，因为不需要装箱和拆箱（顺便说一下，与 Java 泛型集合相比）

# javascript - 从外部检测 iframe 内的点击？

> ID：264508
> 
> 赞同：3
> 
> 时间：2008-11-05T06:51:46.820
> 
> 标签：javascript, dom, iframe

这是场景。有从其他站点加载到 iframe 中的内容。我单击 iframe 内的某个链接。

是否有可能在 iframe 之外以某种方式捕获该链接是什么？

更新因为我收到了我的意图是否纯粹的问题，所以我会更多地解释用例。可能是我从错误的方向开始这项任务。

所以，我们有一个桌面客户端，可以在网络上四处走动（实际上是为了购物），当客户找到她想买的东西时，她点击“那个”（任何东西 - 图片、链接、地址）并将“那个”发送到我们的服务它被手动解析为链接到产品并转换为她的注册表中的条目。没有什么不寻常的。

现在，任务是使其成为网络应用程序。因此，客户在我们的网站上注册并开始浏览网上商店。因此，我的第一选择是 iframe。但问题是如何找到她点击的内容？

或者，一般来说 - 如何将“书签”保存到其他站点的某个对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T07:05:35.480

如果页面不在同一个域中，则无法执行此操作。您的脚本无法跨域查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T07:06:29.550

如果它来自另一个站点，那么我知道的唯一方法是将您需要的信息写入 iframe 的 window.name 属性。

**那**，你可以从你的主要文档中阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-05T23:27:05.577

您可以尝试不可见的 div 点击技术，在 iframe 顶部有一个 div 并在隐藏时注册一个点击服务器端，一旦他们将鼠标悬停在它上面。

[https://gist.github.com/729591](https://gist.github.com/729591)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T13:34:01.563

如果您的 iframe 在同一个域中，只需将事件侦听器添加到链接的 onclick 事件即可。

例子：

```
<a href="javascript:void(0)" onclick="top.harvestLink(this)" title="Item=foo" alt="">Foo</a> 
```

然后在托管 iframe 的页面中，您有您的处理程序：

```
function harvestLink(anAnchor,aShoppingListArray) {
  var itemName = anAnchor.title.split("=")[1];
  aShoppingList.push({item:itemName,dateStamp:new Date()});
} 
```

这是一个说明原理的简单示例。您可能希望将其他信息添加到标题标签，在这种情况下您将进行不同的解析，并且您可能希望使用与“标题”不同的属性来存储它。您可以自己做家务。也可以使用按钮元素而不是锚标签来完成（更容易，IMO），但请务必将按钮的类型属性设置为“按钮”，否则 IE 将提交表单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-19T20:55:25.870

实际上没有办法做到这一点。`window.name`如果没有被访问站点的合作，上述回答者指示的传输将无法运行。`window.name`除非父母和孩子在同一个域上，否则无法访问。

我最近通过`window.name`在子节点中设置然后重定向到父域的 404 页面来解决这个问题。突然，父框架可以读取该`iframeID.contentWindow.name`值并获取信息。但是该重定向是由我在 iframe 中的页面完成的。

我见过的这种跨域、跨框架通信的每个场景都是在程序员控制子框架或父框架和子框架时发生的。我发现的每个浏览器都只控制父级。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-19T21:25:18.963

一些网站所做的一种方法是创建一个书签。用户会定期浏览，然后如果他们通过您的 Web 应用程序找到想要添加为书签的网站，他们只需单击书签即可。

小书签是一个 javascript 函数，它可能会显示一个模态对话框窗口，然后可以远程访问您网站的书签功能。

例如，[Facebook 的 Share Bookmarklet](http://www.facebook.com/share_options.php)，任意数量的[Delicious](http://www.kokogiak.com/delicious_linkbacks.html)小书签。

然后，您的 Web 应用程序将提供一种方法来组织人们使用您的书签保存的书签。您也可以查看 Firefox 插件，但小书签是一种对跨浏览器更友好的解决方案。

# jdbc - 为集成测试煽动数据库失败

> ID：264514
> 
> 赞同：1
> 
> 时间：2008-11-05T06:56:15.937
> 
> 标签：jdbc, soa, integration-testing, spring-test

在运行集成测试（在这种情况下，Web 服务与 JDBC 通信）时，如何强制数据库抛出错误，以便检查产生的肥皂错误？

我正在使用 Spring 的事务测试框架，所以仅仅发出一个`DROP TABLE whatever;`来破坏它是不合理的吗？:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T07:19:41.990

根据我的经验，这是模拟对象的绝佳用途。特定情况下，您需要导致特定故障以测试您的对象（在单元测试的情况下）或对象集（在集成测试的情况下）将如何处理特定故障。最好完全控制失败，而不是在集成测试中强制失败的特定情况。

我最近使用了一个实体框架，遇到了类似的困境。通过为实体创建模拟对象，我能够在运行某些测试时强制在方法调用期间引发异常，以便测试与数据库交互的失败条件。这不是处理 Spring 的事务框架的答案，但我确信同样的原则也适用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-30T03:52:35.627

拔掉数据库服务器的网线会不会很费劲？这很好地模拟了“数据库死亡”。

# winapi - 确定 Vista 中的窗口可见性

> ID：264526
> 
> 赞同：4
> 
> 时间：2008-11-05T07:04:13.237
> 
> 标签：winapi, windows-vista

我想确定某个窗口是否对用户可见或隐藏/被遮挡。在 Windows XP 中，我将使用 GetClipBox() 函数并检查 NULLREGION 或空 RECT 返回值。这工作得非常好，但在 Windows Vista 上，如果另一个窗口遮挡了该窗口，它就不起作用。在这种情况下，GetClipBox() 返回带有非空 RECT 的 SIMPLEREGION。

有谁知道为什么这在 Vista 上不起作用，或者是否有另一种方法来检查用户是否可以看到窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-21T07:45:40.613

GetClipBox() 没有在启用 DWM 的情况下返回 NULLREGION 的简单原因是因为您没有被剪裁！DWM 的重点是每个窗口（不是子窗口，如按钮或编辑框）都有自己的缓冲区来绘制，因此可以移动前景窗口而无需填充它们后面的窗口。

举个简单的例子，当它在后台时，将鼠标悬停在任务栏中的窗口条目上，并在预览中看到它正在更新。

另请注意，使用玻璃边缘，您的窗户可以完全被其他窗户覆盖并且仍然可见！（您甚至无法测试客户区，因为像 Windows Media Player 使用的扩展玻璃 - 将其调整到尽可能小，并看到它在整个区域都使用玻璃！）当然，分层窗口（从 XP 开始) 和自定义窗口区域意味着这可能总是如此，但现在它是默认设置。

**摘要/ TL；DR：**

如果您正在制作繁重的动画/花哨效果并希望在 DWM 下运行时减少 CPU 使用率，您可以做的最好的事情可能是检测您的应用程序何时失去前台并回退到对 CPU 更友好的更新（不是不更新！如果你得到一个WM_PAINT，忽略它，因为你在后台，当你被激活时你不会得到一个！）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T14:53:33.070

在您安装的 Vista 中，是否打开了桌面窗口管理器组合？我猜是这样，如果你把它关掉，你会得到预期的 XP 行为。问题是在具有 DWM 组合的 Vista 下，处理窗口的方式发生了很大变化，我认为没有一种简单的方法可以得到你想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T15:31:17.893

> 在您安装的 Vista 中，是否打开了桌面窗口管理器组合？我猜是这样，如果你把它关掉，你会得到预期的 XP 行为。问题是在具有 DWM 组合的 Vista 下，处理窗口的方式发生了很大变化，我认为没有一种简单的方法可以得到你想要的。

是的，我的机器上启用了 DWM。我尝试了以下方法来测试您的假设：

1.  右键单击我的应用程序并选择“属性”
2.  单击“兼容性”选项卡
3.  启用“禁用桌面合成”复选框
4.  点击“应用”

在此之后 GetClipBox() 函数正常工作。所以你的预感是正确的。我发现我可以通过在我的应用程序中使用以下函数以编程方式执行此操作：

```
DwmEnableComposition(DWM_EC_DISABLECOMPOSITION); 
```

但是，这会在我的应用程序运行时禁用透明效果，这是不可取的。我更喜欢不那么突兀的解决方案。

无论如何，谢谢你的建议！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T14:30:08.423

一种有点混乱的方法是获取您要检查的窗口的位置/大小，然后按 Z 顺序遍历高于它的所有窗口，并计算它们覆盖的窗口部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T15:39:36.660

由于您知道 GetClipRect 在 XP 和 Vista（启用和不启用 DWM）上的输出是什么，因此您可以创建一个函数来确定它根据操作系统采用不同的路径。在伪代码中：

```
function bool IsWindowVisible()
{
   bool isVisible = false;

   if (OSVersion == "XP")
   {
      // GetClipRect tests which run on XP and set isVisible
   }
   else if (OSVersion == "Vista")
   {
      if (DWMCompisitionEnabled == true)
      {
         // GetClipRect tests for Vista with DWM enabled and set isVisible
      }
      else
      {
         // GetClipRect tests for Vista with DWM disabled and set isVisible
      }
   }
   return isVisible;
} 
```

# java - 如何在Java中找到两个相邻的重复数字并将它们替换为单个数字？

> ID：264530
> 
> 赞同：4
> 
> 时间：2008-11-05T07:07:25.023
> 
> 标签：java, regex, string

我需要在一个字符串中找到两个相邻的重复数字并用一个替换。如何在 Java 中做到这一点。一些例子：

123345 应该是 12345 77433211 应该是 74321

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-05T07:20:55.137

大概是一个`replaceAll("(\\d)\\1+", "$1")`

*   `$`在替换字符串中扮演特殊角色，指定第一个捕获组。
*   `+`允许替换尽可能多的相同数字`(\\d)\\1`只会成对替换它们：`777xx`=> `77xx`（感谢[Ben Doom](https://stackoverflow.com/users/12267/ben-doom)的评论）

所以：

```
System.out.println("77433211".replaceAll("(\\d)\\1+", "$1")); 
```

将返回

```
74321 
```

* * *

```
String java.lang.String.replaceAll(String regex, String replacement) 
```

用给定的替换替换此字符串中与给定正则表达式匹配的每个子字符串。

调用这种形式的方法会`str.replaceAll(regex, repl)`产生与表达式完全相同的结果

```
java.util.regex.Pattern.compile(regex).matcher(str).replaceAll(repl) 
```

* * *

**警告**：`String.replaceAll()`函数不会修改应用它的字符串。它返回一个修改后的字符串（如果模式不匹配，则返回一个*具有相同内容的新字符串）*

因此，您需要影响对`replaceAll()`自身的调用结果，以便使用正则表达式更改实际更新您的 String。

```
String aString = "77433211"
aString = aString.replaceAll("(\\d)\\1+", "$1")); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T08:20:26.577

我终于自己做了。那些正在寻找解决方案的人，我就是这样做的：

```
import java.util.regex.*;

public class RepetingDigits{
    public static void main(String[] args) {
        String word = "77433211";
        Pattern pattern = Pattern.compile("(\\d)\\1");
        Matcher matcher = pattern.matcher(word);
        word = matcher.replaceAll("$1");  
        System.out.println(word);
    }
} 
```

更简单：

```
**word = word.replaceAll("(\\d)\\1", "$1");** 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T07:19:04.517

使用正则表达式：

```
var myString='123345'
myString.replace(/([0-9])\1/g,'$1') 
```

这将完全匹配 2 次重复。

```
'123334'.replace(/([0-9])\1+/g,'$1') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T07:26:15.767

这是一个计算两个重复数字的正则表达式（x 是数字）

```
[x]{2}(?!=[x]) 
```

# version-control - Version control server performance when using CruiseControl (StarTeam or alternatives)

> ID：264535
> 
> 赞同：2
> 
> 时间：2008-11-05T07:12:47.790
> 
> 标签：version-control, continuous-integration, cruisecontrol, starteam

We are using CruiseControl with a StarTeam server and having problems with the StarTeam server crashing. We are wondering if we are hitting the server too hard. Across 3 CruiseControl machines and a total of about 30 projects, we are logging into StarTeam and checking for modifications every minute or so. Most of our projects have ~20,000 files in them. Does anyone have experience with the performance limitations in this type of a scenario with StarTeam?

I'm also interested in performance metrics for CruiseControl with other version control systems -- such as TFS, Perforce, SVN, etc... Do they have scalability issues when using CruiseControl and a large number of projects with lots of files?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T08:02:26.113

I've some experience with using Star Team for continous integration - though using TeamCity, not CruiseControl. In our case, the regular connections from TeamCity to StarTeam barely register as a blip on our performance monitoring.

Have you looked at the StarTeam log files on your server? - usually located in the root directory of your code vault or hive. I've usually found the logs sufficient to troubleshoot any issues.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T22:37:20.107

You want to look into using the "compound modification set" as described here:

*   Page 69 of [Pragmatic Project Automation](http://pragprog.com/titles/auto/pragmatic-project-automation)
*   [http://www.nabble.com/How-I-can-use-compound-modification-set-with-triggers--td19397718.html](http://www.nabble.com/How-I-can-use-compound-modification-set-with-triggers--td19397718.html)
*   [http://cruisecontrol.sourceforge.net/main/configxml.html#compound](http://cruisecontrol.sourceforge.net/main/configxml.html#compound)

Does StarTeam support "triggers"? Instead of having your CruiseControl machines checking the repository every minute for a change, you'd have your StarTeam machine letting CruiseControl know when the code has been changed by touching a file.

Basically, when an update is made to a project your VCS touches a file that CruiseControl monitors (like project-a-update.txt). Once it notices that the file has change CruiseControl knows to go bother doing an update from your VCS. So it's polling a single text file per project every N minutes, instead of the entire repository.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T08:19:25.180

Our biggest performance improvement when running CC on several active projects was to install an MPX cache agent on the same machine and make sure it was storing file attributes and contents. (Well, that and making sure to use ccache in the builds.)

The idea of triggers exists in the StarTeam SDK, but I'm not sure how integrated it is with CC. To check if a build is required, we keep the last pull from the server in a clean directory and use stcmd list to compare for changes. This is very speedy.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T16:55:44.600

As far as I can tell, StarTeam does not support triggers. The CruiseControl.NET StarTeam task only supports polling, and I have not seen any evidence anywhere that StarTeam supports triggers natively.

I am experiencing the exact same issue though of pushing StarTeam to it's limit. I am not certain, but I am beginning to think that the crashing issue is related to simultaneous accesses since the problems happen much more often when a project is highly active by developers as well as CruiseControl.

The penalty for polling for changes is also getting to be quite significant. Even worse is that the penalty is doubled. The first call to StarTeam is a call of "hist" to get the changeset for reporting and triggering a build, then a call of "co" does a second check of the entire source tree and checks out any out-of-date or missing files. If anybody can suggest a way to create a trigger around a StarTeam project that would eliminate either, I would love to give it a try.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T19:02:06.050

An additional bit of information I was able to find.

StarTeam does not always disconnect a user (or agent in the case of CruiseControl accesses), and can result in having dozens of open connections/logins for the same user/agent. Unfortunately, it is very hard to confirm if this is a related issue because I cannot reliably overload the server.

We are using an older version of StarTeam that does not have MPX. I wonder if anyone has experience using StarTeam on a different continuous integration environment that supports the MPX method.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-29T02:59:37.900

Firstly, I have no experience of StarTeam! I do have experience of CruiseControl and subversion though.

You could change your schedule interval to something less aggressive than 1 minute - 3-5 minutes is usually acceptable for checking projects to see if they need building. But I accept there may be a reason that you need to check very frequently.

Subversion scales very well. This is because whenever cruise checks to see if there is an update all it does is compare the local version number with the remote version number of the project, it does not need to check each file. The speed of this check is therefore not affected by the number of files in the project.

I hope this helps you.

# python - 使用 jython 和 open office 2.4 将文档转换为 pdf

> ID：264540
> 
> 赞同：2
> 
> 时间：2008-11-05T07:17:32.163
> 
> 标签：python, jython, openoffice.org

我使用 pyuno 完成了一个 python 脚本，它成功地将文档/xls/rtf 等转换为 pdf。然后我需要更新一个 mssql 数据库，因为 open office 目前支持 python 2.3，它很古老，缺乏对体面的数据库库的支持。所以我求助于使用 Jython，这样我就不会因为使用旧的 pyuno 在 OO python 环境中运行而感到负担。

这也意味着我的转换代码被破坏了，我现在需要使用 java 库而不是 pyuno 库。

> 导入 com.sun.star.beans.PropertyValue 作为 PropertyValue
> 导入 com.sun.star.bridge.XUnoUrlResolver 作为 XUnoUrlResolver
> 导入 com.sun.star.comp.helper.Bootstrap 作为 Bootstrap
> ->> 导入 com.sun.star.frame。 XComponentLoader as XComponentLoader
> ->> import com.sun.star.frame.XStorable as XStorable
> import com.sun.star.lang.XMultiComponentFactory as XMultiComponentFactory
> import com.sun.star.uno.UnoRuntime as UnoRuntime
> import com.sun.star.uno .XComponentContext 作为 XComponentContext

带有“->>”的包含不导入编译器无法识别 com.sun.star.frame 看不到“框架”位。这些是我包含的库。

[替代文字 http://www.freeimagehosting.net/uploads/eda5cda76d.jpg](http://www.freeimagehosting.net/uploads/eda5cda76d.jpg)

关于这个问题的一些建议会很受欢迎

> 上下文 = XComponentContext
> xMultiCompFactory = XMultiComponentFactory
> xcomponentloader = XComponentLoader
> 
> //在python中使用
> ctx = None
> smgr = None
> doc = None
> url = None
> 
> context = Bootstrap.bootstrap()
> xMultiCompFactory = self.context.getServiceManager()
> xcomponentloader = UnoRuntime.queryInterface(XComponentLoader.class, ....xMultiCompFactory.createInstanceWithContext("com.sun.star.frame.Desktop", context))
> 
> file = "file:\\" + file
> // 也相当于 url = uno.systemPathToFileUrl(file) 在 Java 中，这样我就可以利用它来很好地格式化我的路径
> properties = []
> p = PropertyValue()
> p.Name = "Hidden"
> p.Value = True
> properties.append(p)
> properties = tuple(properties)
> doc = xcomponentloader.loadComponentFromURL(file, "_blank",0, properties)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T04:38:37.790

就这样，根据这个家伙的说法，你需要一些油......它就像一个魅力

[http://www.oooforum.org/forum/viewtopic.phtml?p=304263#304263](http://www.oooforum.org/forum/viewtopic.phtml?p=304263#304263)

包括这个库 C:\OpenOffice_24\program\classes\unoil.jar

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T11:09:58.247

Using Jython is a great idea for this I think. But why could you not use two scripts, one with pyuno/2.3 and one with pymssql/2.5 (or whatever db adapter you are using)?.

The intermediate format could be anything like a pickle, or json, or XML.

Edit: I should add that I have used pyuno quite extensively, and I feel your pain.

# vb6 - VB6中的动态内存分配

> ID：264541
> 
> 赞同：2
> 
> 时间：2008-11-05T07:17:52.180
> 
> 标签：vb6, memory-management

有这样的事吗？

我说的是类似于 C++`new`命令的东西，即需要显式释放内存（或有内存泄漏风险）的内存分配。

我问是因为我记得以前必须通过将表单/控件/其他对象设置为来解决一些 GDI 泄漏问题，`Nothing`但现在不记得是什么或为什么......

在 VB6 中开发时，我们是否需要担心内存管理？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T13:35:42.493

就 VB6 中的内存管理而言，有几个方面值得关注。

第一个是循环引用，其中子类指向父类，反之亦然。在没有明确设置对 Nothing 的引用的情况下，有时表单也是如此，尤其是作为 Target 对象的编辑器的对话框。再次确保一切设置为空将解决问题。

基本原则是 1) 如果一个对象指向的任何东西都是“活着的”，那么它就不会被垃圾收集。因此，当您设置对循环引用的父对象的引用时，子对象还活着，因此父对象不会被垃圾收集，因为父对象还活着，孩子不会被垃圾收集。

表格也是一样。如果您没有将编辑对象的对话框的目标属性设置为空，那么只要目标对象处于活动状态，它就不会触发最后的一系列事件。

这样做最常见的副作用是您的应用程序无法正常关闭，并且您的内存占用量会随着应用程序的使用时间增加而增长。

至于 GDI 泄漏，只要您使用使用句柄、指针的外部 DLL。对于这些功能，您将自己置于与 C++ 相同的领域。因此，您必须确保遵循您正在使用的特定 API 或 DLL 的所有规则，这通常涉及在完成后显式销毁您创建的内容。

循环引用问题有一个优雅的解决方案。您使用代理而不是直接引用父母的孩子。

首先为父对象创建一个代理类。

```
Option Explicit Public Event GetRef(ByRef RHS As MyObject)

Public Function GetMyObject() As MyObject
    Dim Ref As MyObject
    RaiseEvent GetRef(Ref)
    Set GetMyObject = Ref
End Function 
```

然后在Parent中定义一个私有变量

```
Private WithEvents MyProxy As MyObjectProxy

Private Sub Class_Initialize()
    Set MyProxy = New MyObjectProxy
End Sub 
```

然后设置一个名为 Proxy 的只读属性并实现 GetRef 事件。

```
Public Property Get Proxy() As MyObjectProxy
    Set Proxy = MyProxy
End Property

Private Sub MyProxy_GetRef(RHS As MyObject)
    Set RHS = Me
End Sub 
```

对于孩子或其他任何需要参考的东西，代码如下。

```
Private ParentProxy As MyObjectProxy

Public Property Get Parent() As MyObject
    If ParentProxy Is Nothing Then
        Set Parent = Nothing
    Else
        Set Parent = ParentProxy.GetRef
    End If
End Property

Public Property Set Parent(RHS As MyObject)
    If RHS Is Me Then
        Set MyObjectProxy = Nothing
    ElseIf Target Is Nothing Then
        Set MyObjectProxy = Nothing
    Else
        Set MyObjectProxy = RHS.Proxy
    End If
End Property 
```

因为事件机制不设置引用或增加任一对象上的 COM 引用计数，它避免了整个循环引用问题，这是许多 VB6 程序员的祸根。

注意：我得到它的来源称它为代理，但感谢 Anthony 的评论，我发现它也符合中介者模式的定义。它使用特定的 VB6 Centric 功能；事件 API 不太符合中介者模式的精神。

还要意识到 .NET 框架与 VB6 的事件 API 等效，尽管它的实现方式不同（委托等）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T08:26:55.207

我想说你永远不必担心内存管理，但这并不完全正确。这在一定程度上取决于运行 VB6 代码的执行环境。我当然见过在 COM+ 下运行的 VB6 类，如果它们在完成后没有明确地将对象引用设置为 Nothing，则会泄漏内存。

抛开环境问题不谈，您在 VB6 类型系统中分配的内存通常会为您清理干净。我说的是你用 New 关键字分配的东西。但 rpetrich 和其他人指出，有一个明显的例外：-

由于 VB 使用引用计数机制来管理已分配对象的生命周期，如果您有任何循环引用，则可能会泄漏内存。例如，A->B->C->A。如果您遇到这种情况，您可能需要自己发现它并通过显式设置对 Nothing 的引用来解决它。我不知道有任何工具对识别此类问题有很大帮助。

当您使用以其他语言编写的库时，会出现更多问题。您可能会新建一个用 C++ 编写的 COM 对象，该对象在内部分配一些内存，并发现您必须调用特定方法（例如 Close）来释放该内存。也许这样的 COM 对象写得不好，但它们中的很多都是存在的。

所以没有规则可以遵循，除了也许： -

1.  尝试尽可能多地了解您使用的任何库的行为，并且
2.  在性能监视器中查看内存跟踪的同时始终运行您的代码，以确保其内存使用量不会以无限制的方式增长。
3.  尝试注意循环引用；-)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T08:38:47.633

是的，我在各种形式上都遇到了类似的问题，所以我在每次卸载时都将它们明确设置为空。

但主要与 3rd 方控件有关的问题似乎有时并非所有 COM 引用都正确清除。

看看[这里](http://www.devx.com/tips/Tip/12285)。

# c++ - 将字符数组视为比特流的 C/C++ 代码

> ID：264552
> 
> 赞同：8
> 
> 时间：2008-11-05T07:24:56.550
> 
> 标签：c++, bit-manipulation, extract

我在 char[] 数组中有一大堆二进制数据，我需要将其解释为一个打包的 6 位值数组。

我*可以*坐下来写一些代码来做到这一点，但我认为必须有一个很好的现存类或有人已经写过的函数。

我需要的是这样的：

```
int get_bits(char* data, unsigned bitOffset, unsigned numBits); 
```

所以我可以通过调用获得数据中的第 7 个 6 位字符：

```
const unsigned BITSIZE = 6;
char ch = static_cast<char>(get_bits(data, 7 * BITSIZE, BITSIZE)); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T07:53:13.230

[Boost.DynamicBitset](http://www.boost.org/doc/libs/release/libs/dynamic_bitset/dynamic_bitset.html) - 试试看。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T09:19:46.223

这可能不适用于大于 8 的大小，具体取决于字节序系统。这基本上是 Marco 发布的内容，尽管我不完全确定他为什么会一次收集一点。

```
int get_bits(char* data, unsigned int bitOffset, unsigned int numBits) {
    numBits = pow(2,numBits) - 1; //this will only work up to 32 bits, of course
    data += bitOffset/8;
    bitOffset %= 8;
    return (*((int*)data) >> bitOffset) & numBits;  //little endian
    //return (flip(data[0]) >> bitOffset) & numBits; //big endian
}

//flips from big to little or vice versa
int flip(int x) {
    char temp, *t = (char*)&x;
    temp = t[0];
    t[0] = t[3];
    t[3] = temp;
    temp = t[1];
    t[1] = t[2];
    t[2] = temp;
    return x;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T08:21:49.243

我认为以下内容可能会起作用。

```
int get_bit(char *data, unsigned bitoffset) // returns the n-th bit
{
    int c = (int)(data[bitoffset >> 3]); // X>>3 is X/8
    int bitmask = 1 << (bitoffset & 7);  // X&7 is X%8
    return ((c & bitmask)!=0) ? 1 : 0;
}

int get_bits(char* data, unsigned bitOffset, unsigned numBits)
{
    int bits = 0;
    for (int currentbit = bitOffset; currentbit < bitOffset + numBits; currentbit++)
    {
        bits = bits << 1;
        bits = bits | get_bit(data, currentbit);
    }
    return bits;
} 
```

我没有调试或测试过它，但你可以用它作为起点。

另外，请考虑位顺序。你可能想改变

```
 int bitmask = 1 << (bitoffset & 7);  // X&7 is X%8 
```

到

```
 int bitmask = 1 << (7 - (bitoffset & 7));  // X&7 is X%8 
```

取决于如何生成位数组。

# c# - 你能在 ASP.net 2.0 中通过 CSS 或 Skin 设置页面标题吗

> ID：264563
> 
> 赞同：2
> 
> 时间：2008-11-05T07:33:48.403
> 
> 标签：c#, asp.net, html, themes, skins

我正在使用 asp.net 2.0 我知道可以通过后面的代码设置页面标题。但是是否可以使用 Theme、skin 或 css 设置页面标题？

我需要根据所选主题显示不同的标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T07:52:11.220

通过在页面的 Head 元素中插入 Literal 控件，您应该能够对其应用主题，从而设置其 Text 属性。

如果这不起作用，您可以随时检查 Page.Theme 属性并相应地设置页面标题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T13:37:44.177

不是通过 CSS

# c# - Viewstate 中的敏感数据？

> ID：264570
> 
> 赞同：4
> 
> 时间：2008-11-05T07:47:38.720
> 
> 标签：c#, asp.net, viewstate

我需要在每个会话中跨几个页面（通过 https 运行）存储敏感数据。

我不能使用会话对象，主要原因是会话存储被设计为备份存储（主要是进行服务调用并加载会话）。如果会话已重新启动，或者换句话说会话中的密钥不存在，则创建服务并重新填充会话。

因此，在用户键入敏感数据的情况下，我需要跨页面转发这些数据，我们目前没有持久存储，因此左侧选项是将这些敏感数据存储在 Viewstate 中。

1）我应该加密数据然后存储在 Viewstate 中（虽然不推荐 - 秒和性能影响）或 2）我应该将数据存储在可序列化的类中并将其存储在 Viewstate 中吗？（由于性能影响，不再推荐）

请问有什么意见吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T08:08:40.830

> 我需要在每个会话中跨几个页面（通过 https 运行）存储敏感数据。

ViewState 在页面级别设置和维护。它不能跨不同的页面请求进行，只能回发当前页面。假设您真的意味着您必须“跨越几页”而不是回发数据。

您可能会将敏感数据存储在 cookie 中，但这会带来一些安全风险。

您还可以将敏感数据存储在服务器端数据存储（xml 文件、数据库等）中，并将数据的密钥存储在客户端 cookie 中。安全一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T08:08:48.317

好吧，一般的答案是不要这样做！尽管 viewstate 是（可以）加密的，但它并不是为存储敏感数据而设计的。原因是视图状态数据可以被第三方获取并在以后解密。

但是，这并不意味着您不应该这样做... :-) 首先，您的连接是通过 https 进行的，因此您传输的所有内容都已加密。这意味着获取敏感数据将非常困难。如果第三方窃取您的敏感数据，他首先必须解密连接，然后解密视图状态。因此，攻击者可能更容易使用其他方法来获取您的数据（如欺骗用户、网络钓鱼等）。

因此，为了您的数据安全，我认为将它们存储在加密的视图状态中并使用 https 就足够了。

在 1) 和 2) 之间进行选择应该对性能没有影响或影响很小。当您在视图状态中存储对象时，该对象被序列化然后存储，因此无论您选择哪种方法，数据都会为您序列化。设计一个类来存储您的数据听起来像是一种干净的方法，所以我建议这样做。您甚至可能希望创建一个将敏感数据存储在加密字段中的类，以使获取敏感信息变得更加困难，但这会花费更多的性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T03:01:11.357

如果您使用的是 2.0，则可以加密视图状态。请参阅此[Channel9 文章](http://channel9.msdn.com/wiki/howtoconfigurethemachinekeyinaspnet2/)。AES 对于美国军方和联邦政府来说是足够好的加密。虽然 DES 可以在几小时内破解，但 AES 需要[150 万亿年（以 2001 年硬件计算）](http://www.nist.gov/public_affairs/releases/aesq&a.htm)来破解 AES。即使使用更快和更分布式的硬件，您的视图状态也不值得恶意用户破解它所需的资源。除非您认为机器密钥在某种程度上不安全，否则我不确定加密会带来什么安全风险。

至于性能，带有敏感数据的视图状态是在将数据存储在有价值的内存服务器端或使用宝贵的 CPU 周期来加密数据之间的权衡（尤其是在 2.0 中，您可以配置“[服务器端视图状态](http://aspadvice.com/blogs/robertb/archive/2005/11/16/13835.aspx)”）。您可能希望收集一些与您的工作量和特定硬件相关的经验证据，以找出真正的权衡是什么。如果将应用程序设计为在会话中存储状态而不是视图状态还为时不晚，您可能还需要考虑 SqlSessionStore，它是安全的（服务器端）并且不使用太多服务器端内存。

如果您使用的是 1.1，那么所有关于将敏感数据放入视图状态的令人沮丧的建议都是 100% 正确的，因为从 1.1 解码视图状态（或从 2.0 解码未加密的视图状态）是一项微不足道的任务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T09:22:01.413

Considering that you are talking about a decent amount effort to write code to get this to work safely and reliably with viewstate, you should consider putting that time and effort into just creating the server-side data store instead.

You already have a clearly defined need for one, and the effort to implement it is probably the same or less than the custom viewstate mechanism that is your alternative. The difference is that the persistent store might have value elsewhere in the app, or later on during development of other features... while the viewstate mechanism doesn't add value outside the immediate scope of the one requirement.

It would be rather trivial to drop a simple MS Access data file on the server, or you can even just drop in an XML or text files and write your data to those. It isn't much more effort beyond that to go to the light-weight relational stores like SQL Express, VistaDB, or even MySQL

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T08:08:29.067

在视图状态中存储适量的数据，无论您是否使用可序列化的类，都不应成为性能问题。

您将需要使用加密来保护视图状态中的数据值。同样，性能不应该是少量数据的问题。有关如何启用视图状态加密的详细信息，请参阅[此页面。](http://weblogs.asp.net/varad/archive/2005/02/04/367056.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T08:08:32.640

敏感数据不应该存储在 ViewState 中，因为它很容易被反序列化。

但是您也说页面是通过https运行的，所以您需要回答的问题是；数据对谁敏感？访问页面的用户？然后你需要加密它。

如果不是，那么您应该没问题，因为您使用的是 https。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T12:33:09.080

由于开发人员认为不可能发生的事情而导致所有安全漏洞，我认为我永远不会在视图状态中存储敏感信息。
加密与否。

您无法控制用户环境，因此您无法控制真正可以访问此“敏感”信息的内容。

# svn - 使用 Tortoise SVN 跨 SVN 存储库移动目录

> ID：264571
> 
> 赞同：54
> 
> 时间：2008-11-05T07:50:36.513
> 
> 标签：svn, tortoisesvn

鉴于两者都在同一个 SVN 存储库中，如何将子目录从一个目录移动到另一个目录？我正在使用乌龟SVN。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-11-05T07:55:51.137

选择要移动的文件夹/文件，然后右键单击它们并将它们拖动到要移动的位置。一个菜单会出现一个选项“ **SVN Move versioned files here** ”

正如[phenry](https://stackoverflow.com/questions/264571/move-directory-across-svn-repository-using-tortoise-svn/1894533#1894533)所阐明的，目标文件夹必须被识别为 SVN 文件夹。该文件夹应该已经提交到存储库，或者您可以选择添加以将其设置为添加。

如果目标文件夹不是 SVN 存储库的一部分，请在右键单击并拖动后使用 SVN 导出命令将文件复制到任何目标文件夹。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-12-12T20:04:17.937

请注意，[Chris Thompson 接受的答案](https://stackoverflow.com/questions/264571/move-directory-across-svn-repository-using-tortoise-svn/264576#264576)仅**在 TortoiseSVN 已经识别两个目录**时才有效。如果您在资源管理器中创建一个新文件夹并尝试将文件从现有文件夹移动到该文件夹​​，您将不会获得 TortoiseSVN 上下文菜单项。创建新文件夹后，您必须执行**Commit**操作（创建新版本号）或**Add**操作（不会），以便 TortoiseSVN 知道新文件夹，然后您将获得选项在 SVN 中移动项目。更多[在这里](http://www.modhul.com/2008/11/14/moving-directories-in-a-svn-repository-using-tortoise-svn/)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-10T07:07:56.270

或者在存储库浏览器中，您只需将文件/文件夹拖放到所需的文件夹中即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T05:56:19.697

如果您在移动前重命名了父文件夹，移动时您会看到“交叉/不允许”标志。

解决方法是首先移动子项，然后只重命名父项（如果您已经重命名了父项，请撤消）。

# python - Python - 一个变量不应该等于另一个变量

> ID：264575
> 
> 赞同：6
> 
> 时间：2008-11-05T07:54:08.020
> 
> 标签：python, variables

这是我的示例代码。它是高斯赛德尔（矩阵求解器）的迭代过程。本质上，当错误足够小时，它会退出 while 循环。

```
i=1
while (i>0):
    x_past = x_present

    j=0
    while(j<3):
        value=0
        k=0
        while(k<3):
            if(k!=j):
                if(i==1):
                    if(k>j):
                        value=value+0
                    else:
                        value=value+x_present[k]*eqn[j][k]    
                else:
                    value=value+x_present[k]*eqn[j][k]
            else:
                value=value+eqn[j][k]
            k=k+1
        x_present[j:j+1]=[value]
        j=j+1
    print "X_PAST"
    print x_past
    print "X_PRESENT"
    print x_present    
    if(error(x_past, x_present)<10**-2):
        break;
    i=i+1 
```

我已经减少了代码，使其更易于管理。如果你不明白它在做什么，它对解决这个问题并不那么重要。

这是问题所在。每次

```
x_present[j:j+1]=[value] 
```

运行时，x_past 等于 x_present。我不知道为什么会这样，因为我设置 x_past 等于 x_present 的唯一位置是在循环的顶部。如果我拿走

```
x_past=x_present 
```

句子，x_past 永远不会等于 x_present。这使我认为这是导致问题的两种陈述的某种组合。

这是一个很大的问题，因为如果 x_past = x_present 每次错误 = 0 并且循环在第一次迭代后中断。代码确实有效，例如，如果我告诉代码运行 8 次迭代并且中断它给了我应该的答案。

在过去的 4 个小时里，我一直试图弄清楚这一点，但我完全被难住了。我使用 python 的时间不长，所以我在语法方面的故障排除技巧并不是那么好。任何帮助，将不胜感激！！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-05T08:13:16.343

是的，我认为这里的答案显示了您的问题。只是想澄清一点。

您正在引用一个列表，因此当列表更改时，对该列表的任何引用都将反映该更改。展示：

```
>>> x_present = [4,5,6]
>>>
>>> x_past = x_present
>>>
>>> x_past
[4, 5, 6]
>>>
>>> x_present.append(7)
>>>
>>> x_past
[4, 5, 6, 7]
>>> 
```

如果你想要一份列表的副本，你必须这样做，**listcopy = mylist[:]**。（或者`import copy;listcopy = copy.copy(mylist)`

```
>>> x_past = x_present[:]
>>> x_past
[4, 5, 6, 7]
>>>
>>> x_present.append(8)
>>>
>>> x_past
[4, 5, 6, 7] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T08:00:34.807

x_past 和 x_present 是什么？我不太了解 Python，但从 .NET/Java 的角度来看，如果它们引用了某些数据结构（地图或其他），那么让它们引用同一个对象（就像你在开始时所做的那样）将意味着通过一个变量所做的任何更改都将通过另一个变量可见。听起来您需要获取数据结构的副本，而不仅仅是进行引用分配。您正在使用的数据结构是否有任何可用的“克隆”功能？

正如我所说，我不太了解 Python，所以这可能是完全错误的......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T09:50:22.090

正如其他人指出的那样，答案是替换：`x_past = x_present`由`x_past = x_present[:]`. 通常，您可以使用`copy`模块在 Python 中复制对象。

```
>>> import copy
>>> a = range(10)
>>> a
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> b = a
>>> a += 10, 11
>>> a
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
>>> b
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
>>> c = copy.copy(a) # shallow copy
>>> c
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
>>> del a[3:]
>>> a
[0, 1, 2]
>>> b
[0, 1, 2]
>>> c
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11] 
```

至少可以说，您的代码是 unpythonic。

它可以替换为类似以下代码的内容：

```
import copy
# assert(len(x_present) >= len(eqn))

first = True
while True:
    x_past = copy.copy(x_present) # copy

    for j, eqj in enumerate(eqn):
        x_present[j] = sum(x_present[k] * eqj[k] 
                           for k in range(j if first else len(eqj)) 
                           if k != j)
        x_present[j] += eqj[j] 

    print "X_PAST\n%s\nX_PRESENT\n%s" % (x_past, x_present)
    if allequal(x_past, x_present, tolerance=10**-2):
        break
    first = False 
```

这是`allequal()`（使用绝对错误。在您的情况下它可能是一个好主意，也可能不是一个好主意（您可以改用相对错误））：

```
def allequal(x, y, tolerance):
    return (len(x) == len(y) and 
            all(-tolerance < (xx - yy) < tolerance
                for xx, yy in zip(x, y))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T08:36:39.993

在 Python 中，一切都是对象。所以语句 x_past = x_present 指向同一个引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T08:02:06.303

看起来 x_present 好像是一个列表。我怀疑这意味着赋值 x_last = x_present 使 x_last 成为别名，即它们引用相同的变量。可能是这样吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T08:14:10.303

尝试将`x_past = x_present`线路更改为`x_past = [x for x in x_present]`，看看是否有帮助。

列表复制速记是我最喜欢的 python 功能，因为我可以做其他语言无法做到的单行：

`greaterthan100 = [x for x in number if x > 100]`

`notinblacklist = [x for x in mylist if x not in blacklist]`

`firstchildofbigfamily = [x.child[0] for x in familylist if len(x.child) > 10]`

# ruby - 在 Ruby 的 Test::Unit::TestCase 中，有没有办法让测试方法访问要测试的方法总数？

> ID：264578
> 
> 赞同：0
> 
> 时间：2008-11-05T08:00:17.930
> 
> 标签：ruby, unit-testing, testunit

即当我编写我的测试套件以包括其他套件以及测试用例时，是否有全局计数 TestRunner 已执行的测试数量，将执行？

我可以通过任何方式以编程方式访问该计数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T12:30:30.817

不知道它已经执行了多少，但你不能检查一下总共使用了多少测试`self.methods.grep(/test_/)`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-30T03:18:30.653

`Test::Unit::TestSuite#size`可能会有所帮助。

`Test::Unit::TestCase#size`可能不是，因为它返回 1。

# java - Java中有SoftHashMap吗？

> ID：264582
> 
> 赞同：65
> 
> 时间：2008-11-05T08:03:22.540
> 
> 标签：java, hashmap, weak-references, soft-references

我知道有一个`WeakHashMap`in `java.util`，但是因为它使用`WeakReference`s 来表示所有东西，它只被 this引用，所以被`Map`引用的对象将在下一个 GC 循环中丢失。因此，如果您想缓存随机数据，这几乎是没有用的，很可能会再次请求而不会在其余时间进行硬链接。最好的解决方案是使用`SoftReference`s 代替的地图，但我在 Java RT 包中没有找到。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-05T08:11:23.163

编辑（2012 年 8 月）：

事实证明，目前最好的解决方案可能是 Guava 13.0 的`Cache`类，在[Guava 的 Wiki](https://github.com/google/guava/wiki/CachesExplained)上进行了解释——这就是我要使用的。它甚至支持构建一个`SoftHashMap`（请参阅 参考资料`CacheBuilder.newBuilder().softKeys()`），但它可能不是您想要的，正如 Java 专家 Jeremy Manson 解释的那样（您将在下面找到链接）。

* * *

不是[我所知道的](http://www.javalobby.org/java/forums/t16581.html)`SoftHashMap`（2008 年 11 月），但是您可以在网上找到一些实现。

喜欢这个：[`SoftHashMap`](http://www.koders.com/java/fidF6A9D06D716A6B562853A8DA95C43169F4044FC0.aspx?s=idef%3Aconfiguration)或者[这个](http://www.krugle.org/examples/p-5RTxkghvRYJ5a4Wv/SoftHashMap.java)。

* * *

编辑（2009 年 11 月）
正如[Matthias](https://stackoverflow.com/users/127013/matthias)在评论中提到的，[Google Guava](https://github.com/google/guava) [**MapMaker**](https://github.com/google/guava/wiki/MapMakerMigration)确实使用了 SoftReferences：

> 一个`ConcurrentMap`构建器，提供以下功能的任意组合：

> *   软键或弱键，

*   软或弱的价值观，
*   定时到期，和
*   按需计算值。

正如[这个线程](http://www.mail-archive.com/general@lists.ops4j.org/msg08349.html)中提到的，另一个 JSR166y 候选者：

[jsr166y.ConcurrentReferenceHashMap](http://anonsvn.jboss.org/repos/jbosscache/experimental/jsr166/src/jsr166y/ConcurrentReferenceHashMap.java)

> 它为 Google 实现提供了一个替代的并发引用映射（它依赖于后台线程来驱逐条目）

* * *

编辑（2012 年 8 月）

仅当请求条目的定时到期时，Google 实现才使用后台线程。特别是，它只是简单地使用`java.util.Timer`，它不像拥有一个单独的后台线程那样具有侵入性。

Jeremy Manson 建议，对于任何缓存，使用此功能以避免 SoftReference 的危险：http: [//jeremymanson.blogspot.de/2009/07/how-hotspot-decides-to-clear_07.html](http://jeremymanson.blogspot.de/2009/07/how-hotspot-decides-to-clear_07.html)

[Apache Commons](http://commons.apache.org/collections/)还有另一个实现，即[org.apache.commons.collections.map.ReferenceMap](https://commons.apache.org/proper/commons-collections/javadocs/api-3.2.2/org/apache/commons/collections/map/ReferenceMap.html)；它不支持定时删除，但它支持选择是否应该按身份或相等来比较密钥。此外，这个实现不是并发的——它可以同步，但在来自多个线程的访问下效果不太好。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-30T03:56:02.053

我熟悉两个提供 SoftHashMap 实现的库：

1.  [Apache Commons](http://commons.apache.org/collections/)：org.apache.commons.collections.map.ReferenceMap

2.  [谷歌收藏](http://google-collections.googlecode.com/)：com.google.common.collect.ReferenceMap

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-05T08:45:21.537

[98期java专家时事通讯](http://www.javaspecialists.eu/archive/Issue098.html)中有一个示例实现

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-26T16:37:02.407

您是否考虑过使用[LRUMap](https://commons.apache.org/proper/commons-collections/apidocs/org/apache/commons/collections4/map/LRUMap.html)而不是软 HashMap？您可以更好地控制存储的内容（或至少存储多少）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-05T15:27:15.090

Apache [Shiro](http://en.wikipedia.org/wiki/Apache_Shiro)带有一个为缓存而设计的 SoftHashMap。它基于上面 jb 发布的文章并在 Apache v2 下获得许可。[您可以在此处](http://shiro.apache.org/static/1.1.0/apidocs/)找到文档，并在[此处](http://shiro.apache.org/static/1.1.0/apidocs/src-html/org/apache/shiro/util/SoftHashMap.html)找到源代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T15:54:24.023

如果你想实现一个缓存软引用绝对是一个比弱引用更好的主意，但是它将你的整个缓存删除策略交给了垃圾收集器。这可能不是你想要的。

如果缓存删除策略很重要，您很可能需要使用常规引用自行完成。但是，您将不得不决定何时弹出项目以及弹出哪些项目。如果您只想在堆空间用完时丢失东西，您可以通过以下方式查询可用堆空间：

```
Runtime.getRuntime().getFreeMemory(); 
```

然后，一旦可用内存下降到一定数量以下，您就可以开始丢弃项目。或者你可以为缓存实现一个最大大小，并使用它来决定什么时候丢弃东西。

这是我设计的具有 O(1) 插入、删除和查找时间的[LRU 缓存](https://stackoverflow.com/questions/221525/how-would-you-implement-an-lru-cache-in-java-6#224256)，它具有可配置的最大元素数。如果你想要一个缓存，这将是一个比 SoftHashMap 更好的解决方案。

软引用是创建可增长缓存的好方法。因此，理想的解决方案是使用 SoftHashMap 以及常规的固定大小缓存。让所有插入到缓存中的内容都进入固定缓存和软哈希映射，然后引用一些东西，看看它是否在软哈希映射中（并更新缓存中的参考时间）。这样，您所有最重要的项目（根据您选择的策略 LRU、MFU、...）将永远不会被删除，因为它们在缓存中被硬引用，但您也将保留更多的东西（没有策略控制）只要因为有足够的内存。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-07-10T13:07:22.030

例如，您可以使用此实现线程安全的软参考 HashMap：

```
package cz.b2b.jcl.util;

import java.util.*;
import java.lang.ref.*;
import java.util.concurrent.ConcurrentHashMap;
import java.util.concurrent.ConcurrentLinkedQueue;
import java.util.AbstractMap.SimpleImmutableEntry;

public class ConcurrentSoftHashMap<K, V> extends AbstractMap {

    /**
     The internal HashMap that will hold the SoftReference.
     */
    private final Map<Object, SoftReference> hash = new ConcurrentHashMap<>();
    /**
     The number of "hard" references to hold internally.
     */
    private final int HARD_SIZE;
    /**
     The FIFO list of hard references, order of last access.
     */
    private final ConcurrentLinkedSetQueue hardCache = new ConcurrentLinkedSetQueue();
    /**
     Reference queue for cleared SoftReference objects.
     */
    private final ReferenceQueue queue = new ReferenceQueue();

    public ConcurrentSoftHashMap(int hardSize) {
        HARD_SIZE = hardSize;
    }

    @Override
    public Object get(Object key) {
        Object result = null;
        // We get the SoftReference represented by that key
        SoftReference soft_ref = hash.get(key);
        if (soft_ref != null) {
            // From the SoftReference we get the value, which can be
            // null if it was not in the map, or it was removed in
            // the processQueue() method defined below
            result = soft_ref.get();
            if (result == null) {
                // If the value has been garbage collected, remove the
                // entry from the HashMap.
                hash.remove(key);
            } else {
                // We now add this object to the beginning of the hard
                // reference queue.  
                hardCache.enqueue(result);
                if (hardCache.size() > HARD_SIZE) {
                    // Remove the last entry if list longer than HARD_SIZE
                    hardCache.dequeue();
                }
            }
        }
        return result;
    }

    /**
     Here we put the key, value pair into the HashMap using
     a SoftValue object.
     @param key
     @param value
     @return
     */
    @Override
    public Object put(Object key, Object value) {
        processQueue(); // throw out garbage collected values first
        return hash.put(key, new SoftValue(value, key, queue));
    }

    @Override
    public Object remove(Object key) {
        processQueue(); // throw out garbage collected values first
        return hash.remove(key);
    }

    @Override
    public void clear() {
        hardCache.clear();
        processQueue(); // throw out garbage collected values
        hash.clear();
    }

    @Override
    public int size() {
        processQueue(); // throw out garbage collected values first
        return hash.size();
    }

    @Override
    public boolean containsKey(Object key) {
        processQueue(); // throw out garbage collected values first
        return hash.containsKey(key);
    }

    @Override
    public Set entrySet() {
        Set<Map.Entry> entry = new HashSet<>();
        Map.Entry simpleImmutableEntry = null;
        Object result = null;
        processQueue(); // throw out garbage collected values first
        for (Map.Entry<Object, SoftReference> item : hash.entrySet()) {
            if (item == null) {
                continue;
            }
            Object key = item.getKey();
            SoftReference soft_ref = item.getValue();
            if (soft_ref != null) {
                result = soft_ref.get();
                if (result == null) {
                    hash.remove(key);
                } else {
                    hardCache.enqueue(result);
                    if (hardCache.size() > HARD_SIZE) {
                        hardCache.dequeue();
                    }
                    simpleImmutableEntry = new SimpleImmutableEntry(key, result);
                    entry.add(simpleImmutableEntry);

                }
            }

        }

        return entry;
    }

    private class ConcurrentLinkedSetQueue<E> extends ConcurrentLinkedQueue<E> {

        public void enqueue(E o) {
            if (!contains(o)) {
                add(o);
            }
        }

        public E dequeue() {
            return poll();
        }

    }

    /**
     We define our own subclass of SoftReference which contains
     not only the value but also the key to make it easier to find
     the entry in the HashMap after it's been garbage collected.
     */
    private static class SoftValue extends SoftReference {

        private final Object key; // always make data member final

        /**
         Did you know that an outer class can access private data
         members and methods of an inner class? I didn't know that!
         I thought it was only the inner class who could access the
         outer class's private information. An outer class can also
         access private members of an inner class inside its inner
         class.
         */
        private SoftValue(Object k, Object key, ReferenceQueue q) {
            super(k, q);
            this.key = key;
        }
    }

    /**
     Here we go through the ReferenceQueue and remove garbage
     collected SoftValue objects from the HashMap by looking them
     up using the SoftValue.key data member.
     */
    private void processQueue() {
        SoftValue sv;
        while ((sv = (SoftValue) queue.poll()) != null) {
            hash.remove(sv.key); // we can access private data!
        }
    }

} 
```

# asp.net-mvc - ASP.NET MVC beta 快速入门的本地副本？

> ID：264583
> 
> 赞同：0
> 
> 时间：2008-11-05T08:03:45.143
> 
> 标签：asp.net-mvc

我刚刚下载了 ASP.NET MVC 测试版并想在本地浏览快速入门。它们看起来不像是使用 beta 安装程序安装的，而且我没有看到它们的独立下载链接。有没有地方可以找到这些在本地保存和使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-05T16:19:12.837

目前它们仅在此处在线提供：http: [//quickstarts.asp.net/previews/mvc/](http://quickstarts.asp.net/previews/mvc/)

# java - 在 xstream 中反序列化遗留的 XML 结构

> ID：264596
> 
> 赞同：0
> 
> 时间：2008-11-05T08:18:50.590
> 
> 标签：java, xstream

我正在尝试反序列化如下所示的 xml 结构：

```
<somecontainer>
    <key1>Value1</key1>
    <key1>Value2</key1>
    <key2>Value3</key2>
    <key2>Value4</key2>
</somecontainer> 
```

我基本上可以选择要反序列化的 if 元素类型，可能是一对列表之类的东西。这里的本质是元素名称是键。

不，我无法更改 xml 结构。任何人都知道如何用 xstream 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T18:34:51.300

我已经有一段时间没有使用 XStream 了，但是[隐式集合](http://x-stream.github.io/alias-tutorial.html#omit)可能会满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T16:12:32.293

我发现这种情况需要一个自定义序列化程序，没有办法解决。

相似地

```
<node attr1="xxx">value1</node> 
```

还需要一个自定义序列化程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-16T18:13:16.230

您还可以考虑在反序列化之前将文档转换为规范化形式。这将消除对自定义序列化程序的需要。

我想权衡是是否更容易维护自定义序列化程序或 XSL 转换步骤？

# ms-access - 如何在 MS Access 中自动重新加载报告？

> ID：264598
> 
> 赞同：2
> 
> 时间：2008-11-05T08:20:33.020
> 
> 标签：ms-access, report, auto-update

我在 MS Access 中有一份报告，其中表中的基础数据不规则地变化。我希望报告自动反映这些更改，方法是每 10 秒重新加载一次表单，或者报告收到有关更改的通知并显示新数据。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T08:51:45.127

我能想到的唯一方法并不优雅：

创建一个隐藏表单，将其计时器间隔设置为 10 秒（或您需要的任何间隔）。当 Forms 的计时器事件触发时，遍历打开的报告集合并关闭并重新打开找到的每个报告。

类似于以下内容：

```
Public Sub RefreshOpenReports()
    Dim rpt As Report

    With Reports
        ' Iterate over all open reports...
        For Each rpt In Reports
            rpt.Requery
        Next
    End With

End Sub 
```

# c# - 在 C# 中按值传递引用类型

> ID：264609
> 
> 赞同：24
> 
> 时间：2008-11-05T08:28:30.867
> 
> 标签：c#, reference

我想将引用类型按值传递给 C# 中的方法。有没有办法做到这一点。

在 C++ 中，如果我想通过值传递，我总是可以依赖复制构造函数来发挥作用。C# 中除了： 1\. 显式创建一个新对象 2\. 实现 IClonable 然后调用 Clone 方法之外，还有其他方法。

这是一个小例子：

让我们以 C++ 中的类 A 为例，它实现了一个复制构造函数。

一个方法 func1(Class a)，我可以通过 func1(objA) 来调用它（自动创建一个副本）

C#中是否存在类似的东西。顺便说一句，我使用的是 Visual Studio 2005。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-05T08:33:46.783

不，C# 中没有等效的复制构造函数。您传递的（按值）是*参考*。

`ICloneable`也是有风险的，因为它是深还是浅的定义不明确（而且它没有得到很好的支持）。另一种选择是使用序列化，但同样，它可以快速获取比您预期更多的数据。

如果担心您不希望该方法进行更改，则可以考虑使该类不可变。那么*没有人*可以对它做任何令人讨厌的事情。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T08:33:14.400

正如已经解释的那样，没有与 C++ 的复制构造函数等效的东西。

另一种技术是使用对象不可变的设计。对于不可变对象，传递引用和副本之间没有（语义）差异。这就是 System.String 的设计方式。其他系统（尤其是函数式语言）更多地应用这种技术。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-11-30T11:31:09.060

根据此链接（已发布）：http: [//msdn.microsoft.com/en-us/library/s6938f28 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/s6938f28(VS.80).aspx)

按值传递引用类型如下所示。引用类型 arr 按值传递给 Change 方法。

除非为数组分配了新的内存位置，否则任何更改都会影响原始项目，在这种情况下，更改完全是该方法的本地更改。

```
class PassingRefByVal 
{
    static void Change(int[] pArray)
    {
        pArray[0] = 888;  // This change affects the original element.
        pArray = new int[5] {-3, -1, -2, -3, -4};   // This change is local.
        System.Console.WriteLine("Inside the method, the first element is: {0}", pArray[0]);
    }

    static void Main() 
    {
        int[] arr = {1, 4, 5};
        System.Console.WriteLine("Inside Main, before calling the method, the first element is: {0}", arr [0]);

        Change(arr);
        System.Console.WriteLine("Inside Main, after calling the method, the first element is: {0}", arr [0]);
    }
} 
```

最后，有关更深入的讨论，请参阅 Jon Skeet 在此问题中的帖子：

[在 C# 中通过引用或值传递对象](https://stackoverflow.com/questions/8708632/passing-objects-by-reference-or-value-in-c-sharp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-21T07:53:28.990

看看[这个](http://www.codeproject.com/KB/cs/parameter_object_by_value.aspx)

```
public class Product
{
   public string Name;
   public string Color;
   public string Category;

   public Product(Product o)
   {
      this.Name=o.Name;
      this.Color=o.Color;
      this.Category=o.Category;
   } 
   // Note we need to give a default constructor when override it

   public Product()
   {
   }
} 
public Product Produce(Product sample)
{
   Product p=new Product(sample);
   p.Category="Finished Product";
   return p;
}
Product sample=new Product();
sample.Name="Toy";
sample.Color="Red";
sample.Category="Sample Product";
Product p=Produce(sample);
Console.WriteLine(String.Format("Product: Name={0}, Color={1}, Category={2}", p.Name, p.Color, p.Category));
Console.WriteLine(String.Format("Sample: Name={0}, Color={1}, Category={2}", sample.Name, sample.Color, sample.Category)); 
```

# .net - 版本控制的生产环境

> ID：264615
> 
> 赞同：2
> 
> 时间：2008-11-05T08:33:51.480
> 
> 标签：.net, windows, version-control, production-environment, web-applications

我的问题是，如何以一种好的方式对生产环境进行版本控制？

这是我们当前的环境：

*   （内部服务器）开发 - 版本控制源代码
*   （客户服务器）验收测试环境
*   （客户服务器）暂存环境
*   （客户服务器）生产环境

当我们发布验收测试的新功能时，我们会在 Visual Studio 中发布，压缩更改并将它们应用到测试服务器上。在那里，我们创建了一个备份文件夹（以便我们可以恢复更改）并创建一个发布文件夹，以便我们可以在这些更改被批准后将它们移动到 Staging。

这是创建备份文件夹、发布文件夹、重新创建目录结构并尝试跟踪哪些功能进入哪个版本的大量体力劳动。这很乏味，并且某些开发人员不遵循发布程序总是存在问题。

* * *

理论上我可以为测试环境创建一个存储库。（忘记源代码，这是关于已发布的应用程序）在每个版本中，开发人员都会提交并提供有关他正在发布的功能的评论。

当功能应该从 Test 移动到 Staging 时，我们会导出从上次更新 Staging 环境时所做的更改，并将它们复制到 Staging 应用程序中。在那里我们做了一个提交，稍后可以提取它以发布到生产环境。

这样做的缺点是使用 subversion 会使应用程序与那些 .svn 目录混淆。这可以通过禁止访问 IIS 或 web.config 中的那些目录来解决。另一种解决方案是在应用程序根目录上方的目录中使用 Git。但是对于 Windows 环境中没有经验的开发人员来说，Git 更难使用。

有没有人有这个问题的经验？您如何对生产环境进行版本控制？如果您需要恢复发布，您是否有在发布之前创建的备份文件夹？

我已经与我们的开发人员讨论过这个问题，他们认为使用 subversion 进行版本控制和备份测试/登台/生产环境有任何问题。恰恰相反，他们会乐于在每次需要发布新功能时不创建发布/备份文件夹。

同时，这也有一些不安全感。以前没有人听说过这个，将应用程序放在版本控制系统中，我们不确定会有什么缺点。

如果你有这样的场景经验，我会很高兴听到它。

迈克尔·伦丁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T08:45:23.017

另一种做事的方法是使用构建服务器。每次您签入代码时，构建服务器都会在开发环境中构建并打包新构建。然后使用您的代码签入可部署包。

然后，您可以将打包的构建部署到其他环境。这样您就不必在那里备份版本，因为您的主存储库中已经拥有所有构建的版本。如果您确保部署是完全自动化的并且可以使用一个命令（powershell？）完成，则无需再在服务器上保留备份。

这实际上比您提出的解决方案更好，更易于维护。因为构建的每个版本都与代码一起保存，所以您始终可以为任何构建包找到完整的开发环境。如果您单独对服务器进行版本控制，并且在某处发现错误，则可能很难找到导致错误的代码版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T23:04:46.170

We use subversion as a way to deploy things to our different servers(prod, demo, dev, etc.) and have not run into any difficulties. The only things to watch out for are database differences and config file differences. The config files can be templatized, so as not to overwrite the files in each different deployment, but then you don't get those versioned for the changes to that specific platform.

With this sort of a system, you can make use of subversion's tags to update/roll back to specific deployment versions easily.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T08:43:07.157

我一直使用[mercurial](http://www.selenic.com/mercurial/wiki/) (Hg) 作为生产版本控制系统。（不是代码，而是实际部署的二进制文件）。这工作得很好。Subversion 不太适合在我的场景中使用，因为我确实希望能够将生产更改（例如配置文件）同步回测试甚至开发。颠覆更难在不同的存储库之间同步/合并（很多手动应对）。并且使用 hg tag 和 hg update 可以轻而易举地恢复到稳定（或不稳定）的标签。

哦，我完全同意，您应该使用 buildserver (cruisecontrol.net) 或其他东西，并将所有东西也保留在那里。我的场景还不够，因为客户生产系统的配置是自定义特定的，即使经过广泛的测试，也可能有一些配置在两个版本之间不再做同样的事情（或传入数据发生了显着变化）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-11T08:05:40.757

感谢您的回答和建议。

我看到我需要重新考虑我们处理这些环境的发布的方式。拥有一个包含所有版本的构建服务器可以解决部分问题。我将获得对源代码的提交评论，并更好地控制哪些功能进入什么构建。我仍然需要跟踪什么环境中的构建是什么，以便在出现问题时能够恢复发布。

@Jonke 我会看看 Mercurial。如果您有一个构建系统，其中每个修订版都具有版本控制的源代码，那么版本控制的生产环境可能会过大。但是，如果在部署新功能期间出现任何问题，我仍然希望有一种快速的方法来将更改恢复到以前的版本。我也喜欢你在服务器上获取版本控制配置文件的方式，因为生产环境总是有与开发环境不同的配置。

也许我正在寻找灵丹妙药:)

# .net - When Would You Prefer DateTime Over DateTimeOffset

> ID：264617
> 
> 赞同：56
> 
> 时间：2008-11-05T08:35:57.950
> 
> 标签：.net, datetime, datetimeoffset

A few months ago I was introduced to the new [`DateTimeOffset`](http://msdn.microsoft.com/library/system.datetimeoffset.aspx) type and was glad [`DateTime`](http://msdn.microsoft.com/library/system.datetime.aspx)'s flaws with regard to time zones were finally taken care of.

However, I was left wondering if there were any overhead or problems that could occur from using this new type.

I work on a multi-locale web application. Does anyone know of anything that could sway me from just using it for all my date/time work? Is there a window for abuse here?

Reference: [DateTimeOffset: A New DateTime Structure in .NET 3.5 by Justin Van Patten](http://blogs.msdn.com/bclteam/archive/2007/06/14/datetimeoffset-a-new-datetime-structure-in-net-3-5-justin-van-patten.aspx)

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-11-05T09:01:49.457

Sometimes you really just want to represent a "local" (timezone unaware) date and time rather than an *instant* in time. To be honest it's more often useful to represent just a time - e.g. "wake me up at 8am, regardless of timezone" - but date and time could be useful too.

I agree that for the vast majority of cases, `DateTimeOffset` is a better fit. It does strike me as odd that there isn't a `DateTimeTimeZone` struct which has both the instant and its timezone though... an offset doesn't actually give you all the information you need. (For instance, given a `DateTimeOffset`, you don't know what the time will be 24 hours later, because you don't know when DST might kick in.)

If you want that kind of structure, I have a [very crude implementation in another answer](https://stackoverflow.com/questions/246498/creating-a-datetime-in-a-specific-time-zone-in-c-fx-35#246529). I'm sure it could be improved very easily :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T09:04:13.213

Well, one obvious answer would be when you need to support clients without the SP that it ships in (it isn't actually in 3.5 - it is in 2.0 SP1, which shipped at the same time).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-12T21:11:09.027

Whilst I wouldn't PREFER to use DateTime over DateTimeOffset, please note that sometimes you NEED to, as MS .Net does not support DateTimeOffset as a DataColumn.DataType property [DataColumn.DataType Property](https://docs.microsoft.com/en-us/dotnet/api/system.data.datacolumn.datatype?view=netframework-4.7.2) even though SQL datetimeoffset has been around since SQL2008\.

I myself had a problem with reading (`ReadXml`) a DateTimeOffset value of an XML exported DataSet with `XmlReadMode.InferTypedSchema`; it read it as a DateTime and crashed when I tried to merge it into a DateTimeOffset column

# visual-studio - 使用 Visual Studio 查找缺失的 XML 注释内容

> ID：264623
> 
> 赞同：7
> 
> 时间：2008-11-05T08:41:03.477
> 
> 标签：visual-studio, xml-comments

在整个 C# 源代码中，我们有很多注释错过了实际内容，例如：

```
/// <summary>
/// </summary> 
```

或这个：

```
/// <summary>
///
/// </summary> 
```

或这个：

```
/// <param Name="flag"></param> 
```

不幸的是，Visual Studio 不会为这种类型的缺失注释生成警告。但是对我们来说，如果我们可以在 Visual Studio 中单击列表中的一个项目（例如，warings 列表），然后将其带到源代码中的错误位置来纠正它，那就太好了。此外，在每次构建 xml 文件时看到缺少的 xml 注释内容列表也会很高兴。您对如何实现这一目标有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T08:48:06.100

试试[XML 评论检查器](http://www.ookii.org/software/xmlcommentchecker/)：

> XML Comment Checker 是一个应用程序，它将检查 XML 文档中的 .Net 程序集是否有遗漏。它提供了比 C# 编译器本身更全面的检查，非常适合您希望在将注释编译成真实文档之前检查它们，例如使用 Microsoft Sandcastle。

从功能列表中：

> **检查空白部分。**可选地，如果任何必需的部分或元素存在但为空，XML 注释检查器将发出警告。默认情况下未启用此功能

Visual Studio 的用法：

> XML Comment Checker 可以设置为 Visual Studio 中的构建后事件以自动检查程序集。**XML Comment Checker 发出的警告已被格式化，以便 Visual Studio 能够识别它们**并将它们显示在错误列表中。构建后命令行示例： "PathToCommentChecker\CommentChecker.exe" "$(TargetPath)" -nologo -warnemptysections

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-05-21T12:45:35.803

ReSharper 是 Visual Studio 的这个（以及许多其他）缺点的答案。对于不使用它的人，我只有同情。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T08:46:27.647

[FxCop](http://en.wikipedia.org/wiki/FxCop)和自定义规则？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-28T01:38:02.020

您可以使用 XSLT 文件并针对 XSLT 文件调试 xml，然后如果 xml 格式不正确，它将抛出错误，向您显示 xml 格式不正确的确切行号。这个简单的 XSLT 文件有效——

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl"
>
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

# cruisecontrol.net - CruiseControl.Net 的 FTP 发布者？

> ID：264625
> 
> 赞同：2
> 
> 时间：2008-11-05T08:43:31.773
> 
> 标签：cruisecontrol.net

有谁知道如何使用 CruiseControl.Net 发布到 FTP 服务器？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T08:50:54.597

我认为没有特定的方法可以做到这一点。您当然可以始终在 Cruise control.net 的窗口中运行命令行 ftp 客户端

一个提示：

我发现像这样的东西很难在 cc.net 中设置和维护。涉及大量的试验和错误，因为每次试验都在服务器上工作，并且每个错误都可能需要很长时间才能调试。我通常有一个非常通用的 cc.net 构建设置，我可以为我的所有项目复制它，这些项目只是从版本控制中获取源代码并启动一个 nant 构建脚本。因为您可以在本地机器上运行 nant 构建脚本以及调试，所以要容易得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-01T01:13:27.250

与您使用的编译器无关，从 1.5 版开始，有一个 FTP 发布者，它使用自由汇编`edtFTPnet.dll`，它会自动发布任何信息。享受。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T17:02:07.103

我们在工作中遇到了一个问题，我们需要在构建过程中进行大量文件操作，因此我编写了一个插件来执行此操作。

资源方面，这很容易做到，我需要的所有信息都在这个链接中： [http ://confluence.public.thoughtworks.org/display/CCNET/Custom+Builder+Plug-in](http://confluence.public.thoughtworks.org/display/CCNET/Custom+Builder+Plug-in)

除了我实现了 iTask，而不是 iBuilder。

希望对您有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T17:03:48.253

如果您将 MSBuild 与 CC.NET 一起使用，则可以使用[FTP Task for MS Build](http://www.digizzle.com/Projects/FtpTask/Default.aspx)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-17T15:08:58.247

如果您要为 CC.Net 路由执行 FTP 任务，您应该知道，在 1.5 版中存在导致所有文件再次复制到 FTP 服务器的问题，即使它们自上次上传以来没有更改.

尽管如此，我还是成功地将它用于两个较小的站点。我在[博客](http://www.damirscorner.com/UsingFTPTaskInCruiseControlNETForPublishingWebsites.aspx)上写过我设置它的经验。

# javascript - 如何让 Javascript 调试与我的 ASP.NET MVC 应用程序一起工作？

> ID：264626
> 
> 赞同：6
> 
> 时间：2008-11-05T08:43:57.793
> 
> 标签：javascript, asp.net-mvc, visual-studio-2008, debugging

我似乎无法为我的 ASP.NET MVC 应用程序进行 Javascript 调试，即使我可以为传统的 ASP.NET WebForm 应用程序进行调试。

我已按照步骤取消选中 IE 和其他的“禁用脚本调试”框。

当我添加一个简单的函数以在 site.master 和任何内容视图中显示警报时，断点将不会触发。

我是否遗漏了一些明显的东西，或者我是否需要使用像 FireBug 这样的外部工具进行调试？

顺便说一句，我使用的是 Visual Studio Web Developer Express 2008。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-03-29T20:23:45.473

我今天也刚遇到这个问题。如果您将脚本文件包含在 mvc 视图中，调试器将不知道它们在哪里。

将它们放在脚本文件夹中的外部`.js`文件（例如`default.js`）中，在 site.master 中添加脚本标签，然后您将遇到断点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-27T18:54:05.160

```
function test()
{
  debugger;
  alert("hi");
} 
```

我不知道它是否适用于 express，但是当 IE 按下“调试器”指令时，它会询问我是否要调试，并使用 wich 工具。Visual Studio 出现在提供给我的选项列表中。

我不知道快递会不会出现在你面前。

“调试器”也适用于萤火虫。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T21:41:15.650

VS JS 调试可以工作，但是……老实说，得到 Firebug。它是免费的，而且比 VS 调试器做得更多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-27T16:26:00.840

这是我在 MVC 中调试 javascript 的解决方法。VS2008 不会在 aspx 页面中为 javascript 处理断点，但它会处理一个单独的 .js 文件。我在处理页面时创建了一个 debugJscript.js 文件。我从我的 aspx 页面创建了对该调试页面的引用。我可以通过这种方式单步执行 javascript，然后在对它感到满意时将 javascript 代码推回 aspx 页面。

如果您像这样引用您的文件，您也可以避免在该外部 .js 文件上出现缓存问题：

```
 <script type="text/javascript" src="../../Scripts/DebugJScript.js?<%=DateTime.Now %>" ></script> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-05T13:50:55.567

我不使用 VS.Net Express，但在 VS.Net Standard 中，您可以转到解决方案中的“调试”菜单并选择“附加到进程”。然后，您将可以选择调试类型：Native、Managed 或 Script。选择脚本，然后从列表中选择您的进程。现在将在您的 IDE 中出现一个脚本列表。单击要调试的脚本之一，输入一两个断点，您应该准备好了。

如果 MS 已经削弱了 Express 版本，因此您无法附加到进程，那么我猜您会被卡住并且需要 $$$ 升级（这不会让我完全感到惊讶）。嘿，你想要什么免费的？:)

# html - 如何在 HTML 中创建可编辑的下拉列表？

> ID：264640
> 
> 赞同：63
> 
> 时间：2008-11-05T08:57:09.903
> 
> 标签：html, combobox, html-select

我想创建一个带有下拉列表的文本字段，让用户选择一些预定义的值。用户还应该能够键入新值或从下拉列表中选择预定义的值。我知道我可以为此使用两个小部件，但在我的应用程序中，如果它统一在一个小部件中会更符合人体工程学。

是否有标准小部件或者我必须使用第三方 javascript？

浏览器的便携性如何？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2013-07-15T16:03:24.723

您可以通过使用`<datalist>`HTML5 中的标记来完成此操作。

```
<input type="text" name="product" list="productName"/>
    <datalist id="productName">
        <option value="Pen">Pen</option>
        <option value="Pencil">Pencil</option>
        <option value="Paper">Paper</option>
    </datalist>
```

如果您在浏览器中双击输入文本，则会出现一个包含已定义选项的列表。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-07-30T21:24:38.277

这可以在纯 HTML、CSS 和 JQuery 的帮助下实现。我创建了一个示例页面：

```
$(document).ready(function(){

    $(".editableBox").change(function(){         
        $(".timeTextBox").val($(".editableBox option:selected").html());
    });
});
```

```
.editableBox {
    width: 75px;
    height: 30px;
}

.timeTextBox {
    width: 54px;
    margin-left: -78px;
    height: 25px;
    border: none;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="wrapper">
    <select class="editableBox">        
        <option value="1">01:00</option>
        <option value="2">02:00</option>
        <option value="3">03:00</option>
        <option value="4">04:00</option>
        <option value="5">05:00</option>
        <option value="6">06:00</option>
        <option value="7">07:00</option>
        <option value="8">08:00</option>
        <option value="9">09:00</option>
        <option value="10">10:00</option>
        <option value="11">11:00</option>
        <option value="12">12:00</option>
        <option value="13">13:00</option>
        <option value="14">14:00</option>
        <option value="15">15:00</option>
        <option value="16">16:00</option>
        <option value="17">17:00</option>
        <option value="18">18:00</option>
        <option value="19">19:00</option>
        <option value="20">20:00</option>
        <option value="21">21:00</option>
        <option value="22">22:00</option>
        <option value="23">23:00</option>
        <option value="24">24:00</option>
    </select>
    <input class="timeTextBox" name="timebox" maxlength="5"/>
</div>
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-05T16:05:42.753

最好的方法可能是使用第三方库。

~~[在jQuery UI](http://docs.jquery.com/UI/Autocomplete)~~ [jQuery UI](https://jqueryui.com/autocomplete/)和~~[dojo](http://dojotoolkit.org/book/dojo-book-0-9/part-2-dijit/form-validation-specialized-input/auto-completer)~~ [dojo](https://dojotoolkit.org/reference-guide/1.10/dijit/form/FilteringSelect.html)中有一个您正在寻找的实现。jQuery 更受欢迎，但 dojo 允许您在 HTML 中以声明方式定义小部件，这听起来更像您正在寻找的东西。

您使用哪一个取决于您的风格，但两者都是为跨浏览器工作而开发的，并且两者都将比复制和粘贴代码更频繁地更新。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-07-17T11:16:17.743

基于 CSS 和一行 JavaScript 代码的非常简单的实现（只有基本功能）。

```
.dropdown {
  position: relative;
  width: 200px;
}

.dropdown select {
  width: 100%;
}

.dropdown > * {
  box-sizing: border-box;
  height: 1.5em;
}

.dropdown input {
  position: absolute;
  width: calc(100% - 20px);
}
```

```
<div class="dropdown">
  <input type="text" />
  <select  onchange="this.previousElementSibling.value=this.value; this.previousElementSibling.focus()">
    <option>This is option 1</option>
    <option>Option 2</option>
  </select>
</div>
```

**请注意：**它使用`previousElementSibling()`的是[旧浏览器](https://developer.mozilla.org/en-US/docs/Web/API/NonDocumentTypeChildNode/previousElementSibling#Browser_compatibility)（低于 IE9）不支持的

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-05T09:05:15.380

该`<select>`标签只允许使用预定义的条目。您的问题的典型解决方案是使用一个标记为“其他”的条目和一个禁用的编辑字段 ( `<input type="text"`)。添加一些 JavaScript 以仅在选择“其他”时启用编辑字段。

可能以某种方式创建一个允许直接编辑的下拉菜单，但 IMO 不值得付出努力。如果是这样，亚马逊、谷歌或微软就会这样做；-) 只需用最简单的解决方案完成工作。它更快（你的老板可能喜欢那样）并且通常更容易维护（你可能喜欢那样）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-12-18T12:31:39.590

带有文本框的组合框（用于预定义值和用户定义值。）

[带有文本框的组合框（单击此处）](https://www.zoonman.com/projects/combobox/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-05T09:02:43.560

我不确定有没有办法在没有 javascript 的情况下自动完成。

您需要的是在浏览器端运行的东西，以便在用户进行选择时将您的表单提交回服务器 - 因此是 javascript。

此外，请确保您为那些关闭了 javascript 的人提供了替代方法（即提交按钮）。

一个很好的例子：[组合框查看器](http://www.dynamicdrive.com/dynamicindex17/comboviewer.htm)

昨天我甚至有一个更复杂的组合框，使用这个[dhtmlxCombo](https://stackoverflow.com/questions/262150/good-javascript-combo-box-replacement-for-combo-boxes-with-tons-of-elements#262187)，使用 ajax 在大量数据中检索相关值。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-05T09:05:40.403

不幸的是，组合框被排除在 HTML 规范之外。

不幸的是，管理它的唯一方法是自己动手或使用预​​先构建的。[这个](http://www.tgreer.com/comboArticle.html)看起来很简单。我将[这个](http://www.dhtmlx.com/docs/products/dhtmlxCombo/index.shtml)用于开源应用程序，但不幸的是您必须为商业用途付费。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-10-08T04:46:07.140

一点CSS，你就完成了 [小提琴](http://jsfiddle.net/QEVXK/)

```
<div style="position: absolute;top: 32px; left: 430px;" id="outerFilterDiv">
<input name="filterTextField" type="text" id="filterTextField" tabindex="2"  style="width: 140px;
    position: absolute; top: 1px; left: 1px; z-index: 2;border:none;" />
        <div style="position: absolute;" id="filterDropdownDiv">
<select name="filterDropDown" id="filterDropDown" tabindex="1000"
    onchange="DropDownTextToBox(this,'filterTextField');" style="position: absolute;
    top: 0px; left: 0px; z-index: 1; width: 165px;">
    <option value="-1" selected="selected" disabled="disabled">-- Select Column Name --</option>
</select> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-07-30T22:42:38.110

HTML 没有内置的可编辑下拉列表或组合框，但我在[一篇文章](https://medium.com/free-code-camp/mostly-css-drop-down-combo-boxes-4ff4bb182ff7)中实现了一个主要是 CSS 的解决方案。

![](https://miro.medium.com/max/627/1%2A1RW6aHEJcyn6J5bDOIxM3A.gif)

[您可以在此处](https://codepen.io/qwertie/pen/QBYMdZ)查看完整的演示，但总而言之，编写 HTML 如下：

```
<span class="combobox withtextlist">
  <input value="Fruit">
  <span tabindex="-1" class="downarrow"></span>
  <select size="10" class="sticky">
    <option>Apple</option>
    <option>Banana</option>
    <option>Cherry</option>
    <option>Dewberry</option>
  </select>
</span> 
```

并使用这样的 CSS 来设置它的样式（这是为两个组合框设计的，组合框有一个向下箭头 ▾ 按钮，以及单击时打开的下拉菜单，并且可能有不同的样式）：

```
/* ------------------------------------------ */
/* ----- combobox / dropdown list styling     */
/* ------------------------------------------ */
.combobox {
  /* Border slightly darker than Chrome's <select>, slightly lighter than FireFox's */
  border: 1px solid #999;
  padding-right: 1.25em; /* leave room for ▾ */
}
.dropdown, .combobox { 
  /* "relative" and "inline-block" (or just "block") are needed
     here so that "absolute" works correctly in children */
  position: relative;
  display: inline-block;
}
.combobox > .downarrow, .dropdown > .downarrow {
  /* ▾ Outside normal flow, relative to container */
  display: inline-block;
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  width: 1.25em;

  cursor: default;
  nav-index: -1; /* nonfunctional in most browsers */

  border-width: 0px;          /* disable by default */
  border-style: inherit; /* copy parent border */
  border-color: inherit; /* copy parent border */
}
/* Add a divider before the ▾ down arrow in non-dropdown comboboxes */
.combobox:not(.dropdown) > .downarrow {
  border-left-width: 1px;
}
/* Auto-down-arrow if one is not provided */
.downarrow:empty::before {
  content: '▾';
}
.downarrow::before, .downarrow > *:only-child {
  text-align: center;

  /* vertical centering trick */
  position: relative;
  top: 50%;
  display: block; /* transform requires block/inline-block */
  transform: translateY(-50%);
}
.combobox > input {
  border: 0
}
.dropdown > *:last-child,
.combobox > *:last-child {
  /* Using `display:block` here has two desirable effects:
     (1) Accessibility: it lets input widgets in the dropdown to
         be selected with the tab key when the dropdown is closed. 
     (2) It lets the opacity transition work.
     But it also makes the contents visible, which is undesirable 
     before the list drops down. To compensate, use `opacity: 0`
     and disable mouse pointer events. Another side effect is that
     the user can select and copy the contents of the hidden list,
     but don't worry, the selected content is invisible. */
  display: block;
  opacity: 0;
  pointer-events: none;

  transition: 0.4s; /* fade out */
  position: absolute;
  left: 0;
  top: 100%;
  border: 1px solid #888;
  background-color: #fff;
  box-shadow: 1px 2px 4px 1px #666;
  box-shadow: 1px 2px 4px 1px #4448;
  z-index: 9999;
  min-width: 100%;
  box-sizing: border-box;
}
/* List of situations in which to show the dropdown list.
   - Focus dropdown or non-last child of it => show last-child
   - Focus .downarrow of combobox => show last-child
   - Stay open for focus in last child, unless .less-sticky
   - .sticky last child stays open on hover
   - .less-sticky stays open on hover, ignores focus in last-child */
.dropdown:focus > *:last-child,
.dropdown > *:focus ~ *:last-child,
.combobox > .downarrow:focus ~ *:last-child,
.combobox > .sticky:last-child:hover,
.dropdown > .sticky:last-child:hover,
.combobox > .less-sticky:last-child:hover,
.dropdown > .less-sticky:last-child:hover,
.combobox > *:last-child:focus:not(.less-sticky),
.dropdown > *:last-child:focus:not(.less-sticky) {
  display: block;
  opacity: 1;
  transition: 0.15s;
  pointer-events: auto;
}
/* focus-within not supported by Edge/IE. Unsupported selectors cause 
   the entire block to be ignored, so we must repeat all styles for 
   focus-within separately. */
.combobox > *:last-child:focus-within:not(.less-sticky),
.dropdown > *:last-child:focus-within:not(.less-sticky) {
  display: block;
  opacity: 1;
  transition: 0.15s;
  pointer-events: auto;
}
/* detect Edge/IE and behave if though less-sticky is on for all
   dropdowns (otherwise links won't be clickable) */
@supports (-ms-ime-align:auto) {
  .dropdown > *:last-child:hover {
    display: block;
    opacity: 1;
    pointer-events: auto;
  }
}
/* detect IE and do the same thing. */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  .dropdown > *:last-child:hover {
    display: block;
    opacity: 1;
    pointer-events: auto;
  }
}
.dropdown:not(.sticky) > *:not(:last-child):focus,
.downarrow:focus, .dropdown:focus {
  pointer-events: none; /* Causes second click to close */
}
.downarrow:focus {
  outline: 2px solid #8BF; /* Edge/IE can't do outline transparency */
  outline: 2px solid #48F8;
}

/* ---------------------------------------------- */
/* Optional extra styling for combobox / dropdown */
/* ---------------------------------------------- */
*, *:before, *:after {
  /* See https://css-tricks.com/international-box-sizing-awareness-day/ */
  box-sizing: border-box; 
}
.combobox > *:first-child {
  display: inline-block;
  width: 100%;
  box-sizing: border-box; /* so 100% includes border & padding */
}
/* `.combobox:focus-within { outline:...}` doesn't work properly 
   in Firefox because the focus box is expanded to include the 
   (possibly hidden) drop list. As a workaround, put focus box on 
   the focused child. It is barely-visible so that it doesn't look
   TOO ugly if the child isn't the same size as the parent. It
   may be uglier if the first child is not styled as width:100% */
.combobox > *:not(:last-child):focus {
  outline: 2px solid #48F8;
}
.combobox {
  margin: 5px; 
} 
```

您还需要一些 JavaScript 来将列表与文本框同步：

```
function parentComboBox(el) {
    for (el = el.parentNode; el != null && Array.prototype.indexOf.call(el.classList, "combobox") <= -1;)
        el = el.parentNode;
    return el;
}
// Uses jQuery
$(".combobox.withtextlist > select").change(function() { 
  var textbox = parentComboBox(this).firstElementChild;
  textbox.value = this[this.selectedIndex].text;
});
$(".combobox.withtextlist > select").keypress(function(e) {
  if (e.keyCode == 13) // Enter pressed
    parentComboBox(this).firstElementChild.focus(); // Closes the popup
}); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-03-05T12:08:34.933

没有 CSS 的简单 HTML + Javascript 方法

```
function editDropBox() {
    var cSelect = document.getElementById('changingList');

    var optionsSavehouse = [];
    if(cSelect != null) {
        var optionsArray = Array.from(cSelect.options);

        var arrayLength = optionsArray.length;
        for (var o = 0; o < arrayLength; o++) {
            var option = optionsArray[o];
            var oVal = option.value;

            if(oVal > 0) {
                var localParams = [];
                localParams.push(option.text);
                localParams.push(option.value);
                //localParams.push(option.selected); // if needed
                optionsSavehouse.push(localParams);
            }
        }
    }

    var hidden = ("<input id='hidden_select_options' type='hidden' value='" + JSON.stringify(optionsSavehouse) + "' />");

    var cSpan = document.getElementById('changingSpan');
    if(cSpan != null) {
        cSpan.innerHTML = (hidden + "<input size='2' type='text' id='tempInput' name='fname' onchange='restoreDropBox()'>");
    }
}

function restoreDropBox() {
    var cSpan = document.getElementById('changingSpan');
    var cInput = document.getElementById('tempInput');
    var hOptions = document.getElementById('hidden_select_options');

    if(cSpan != null) {

        var optionsArray = [];

        if(hOptions != null) {
            optionsArray = JSON.parse(hOptions.value);
        }

        var selectList = "<select id='changingList'>\n";

        var arrayLength = optionsArray.length;
        for (var o = 0; o < arrayLength; o++) {
            var option = optionsArray[o];
            selectList += ("<option value='" + option[1] + "'>" + option[0] + "</option>\n");
        }

        if(cInput != null) {
            selectList += ("<option value='-1' selected>" + cInput.value + "</option>\n");
        }

        selectList += ("<option value='-2' onclick='editDropBox()'>- Edit -</option>\n</select>");
        cSpan.innerHTML = selectList;
    }
}
```

```
<span id="changingSpan">
    <select id="changingList">
        <option value="1">Apple</option>
        <option value="2">Banana</option>
        <option value="3">Cherry</option>
        <option value="4">Dewberry</option>
        <option onclick="editDropBox()" value="-2">- Edit -</option>
    </select>
</span>
```

# c++ - 在 IE 中分叉或复制用户浏览器会话

> ID：264642
> 
> 赞同：3
> 
> 时间：2008-11-05T09:00:05.670
> 
> 标签：c++, internet-explorer, com, toolbar, iwebbrowser2

是否可以在 Internet Explorer 插件中分叉用户会话（或执行类似操作）？

我想处理用户单击工具栏中的按钮时所在的页面。为避免中断用户浏览，我想“复制”所有内容，以便在后台解析和处理页面。该处理可能涉及诸如在 Google 搜索中加载结果链接的内容（如果这是单击按钮的位置）。

所以 - 我基本上想要的是模仿`Ctrl`+`N`但对用户隐藏窗口，这样他们就不会被打断。

[如您所见，如果您在http://www.snee.com/xml/crud/posttest.html](http://www.snee.com/xml/crud/posttest.html)上填写并提交表单并按`Ctrl`+ `N`，发布的所有内容仍会出现在新窗口中，但不会两次发布数据。

我正在考虑以某种方式复制`IWebBrowser2`，但是：

*   我不确定这是否可能（我无法在 MSDN 上找到任何信息）
*   我不知道它是否也复制了会话。

创建一个新的实例`IWebBrowser2`并简单地导航到当前 URL 不是一个有效的解决方案，因为`POST`-variables 当然不会被继承。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T18:06:57.587

BHO 或插件可以工作。有很多选择可以获取源代码，这有点。选择你的姿态。查找 IDocHostUIHandler 以更改行为。IHTMLElementCollection 在浏览器中解析页面。目前我能想到的最简单的事情是......

将当前内容保存到流中。与获取/查看源代码相同。

```
// ＃包括
HRESULT SaveDocumenttoStream(IWebBrowser* pWebBrowser,
                             IStream* pStream)
{
HRESULT 小时；
IDispatch* pHtmlDoc = NULL；
IPersistStreamInit* pPersistStreamInit = NULL;
hr = pWebBrowser->get_Document( &pHtmlDoc );
如果（成功（小时）&& pHtmlDoc）
{
  // 查询 IPersistStreamInit。
  hr = pHtmlDoc->QueryInterface(IID_IPersistStreamInit,
                               (void**)&pPersistStreamInit );
  如果（成功（小时））
  {
     hr = pPersistStreamIni->Save(, True);
     pPersistStreamInit->Release();
  }
  pHtmlDoc->Release();
}

```

您提供浏览器和 stream.HTH

--

迈克尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-13T14:30:56.540

有趣的想法。您能否复制 DOM holus-bolus，然后用副本替换新窗口的 DOM。这只是一个猜测。在这一点上，我和你一样在黑暗中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-29T19:48:49.150

我认为这是不可能的，因为你必须考虑这么多细节，总会有一些事情发生。只说两个：

*   您必须注意嵌入式 Web 浏览器（框架、IFRAME）。我认为复制主页只会复制他们的 URL，因此当您在某处恢复序列化的主页时，他们的内容将被重新加载，因此您的页面内容会发生变化。因此，您将不得不下降到帧级别。
*   您必须注意那些在您背后尝试连接到某个服务器以发送您分叉的页面已经发送的数据的脚本。所以你可能会改变页面的逻辑。

因此，实时处理是捕获用户看到的状态的唯一真正解决方案；如果这是您想要实现的目标。如果你不需要这么多细节，它可能更容易做到。

# c - getopt() 行为异常

> ID：264656
> 
> 赞同：2
> 
> 时间：2008-11-05T09:10:26.540
> 
> 标签：c, getopt

`getopt()`没有像我对空头期权的预期那样表现。

例如：使用缺少的参数调用以下程序：

有效案例：`testopt -d dir -a action -b build`

错误案例：`testopt -d -a action -b build`

这并没有引发任何错误，因为我期待一个错误消息操作数丢失`-d`

*   这是一个已知的错误？
*   如果是这样，是否有可用的标准修复程序？

我的代码：

```
#include <unistd.h>
/* testopt.c                       */
/* Test program for testing getopt */
int main(int argc, char **argv)
{
    int chr;
    while ( ( chr = getopt(argc, argv, ":d:a:b:") ) != -1 )
    {
            switch(chr)
            {
                    case 'a':
                            printf("Got a...\n");
                            break;
                    case 'b':
                            printf("Got b...\n");
                            break;
                    case 'd':
                            printf("Got d...\n");
                            break;
                    case ':':
                            printf("Missing operand for %c\n", optopt);
                            break;
                    case '?':
                            printf("Unknown option %c\n", optopt);
                            break;
            }
    }
    printf("execution over\n");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T09:35:28.127

`getopt()`thinks`-a`是 的参数`-d`，而不是选项。

尝试`testopt -a action -b build -d`- 它应该抱怨缺少论点。

您需要检查具有有效值的`-d`选项（和所有其他选项） - 开头没有破折号的选项。`optarg`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T09:16:20.023

根据[手册页](http://www.gnu.org/software/libtool/manual/libc/Using-Getopt.html#Using-Getopt)，您应该以冒号开头选项字符串，以便`getopt()`返回`':'`以指示缺少参数。默认似乎正在返回`'?'`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T10:26:38.460

上面的代码对我来说很好，在 Red Hat 上使用 gcc 3.4.5：

```
$ ./a.out -d test
Got d...
execution over

$ ./a.out -d
Missing operand for d
execution over 
```

你的环境是什么？

**更新**：好的，qrdl 是正确的。getopt() 怎么会这样工作？

# asp.net-mvc - ASP.NET MVC 中的服务器控件

> ID：264664
> 
> 赞同：0
> 
> 时间：2008-11-05T09:14:42.757
> 
> 标签：asp.net-mvc

我想在 ASP.MVC 视图中使用服务器控件。我想从 View 中检索数据并将其传递给控件。我如何使用服务器端控件（网格、按钮等）及其事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T11:08:53.680

You can use server controls on aspx views just like you would in ordinary aspx pages (for example, ListView is quite useful). You have to bind it to viewdata in the Page_Load function. Though, you cannot use any events related to postback (edit and paging in GridView, etc.).

# dynamic - 动态网站的 SEO 兼容性

> ID：264668
> 
> 赞同：-1
> 
> 时间：2008-11-05T09:17:59.533
> 
> 标签：dynamic, seo

我读过SEO适用于静态网站，它在初始页面本身中保存信息。我想知道是否有可能实现动态添加信息的SEO。

我的意思是我在这里使用 ajax 来加载信息，在这种情况下如何实现 SEO，是否有可能.. 请帮助我..

谢谢普拉文贾亚帕尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-21T08:35:27.360

使用 javascript 和 Ajax 的正确方法是首先在没有 javascript 的情况下编写您的页面和交付内容。所有内容都应以逻辑组织的方式显示。完成此操作后，您可以使用 JS/Ajax 为启用 JS 的访问者提供卓越的可用性。

这将使您的所有用户、启用和禁用的 javascript 以及搜索引擎受益。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T10:19:35.183

You have to make all your content accessible without javascript (ie. ajax). Otherwise the search engine spiders cannot index your content.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T00:31:56.880

您可以创建一个具有 AJAX 且与搜索引擎兼容的网站，但必须创建这样的网站，以便在没有 AJAX 的情况下通过相同的 URL 访问相同的信息。搜索引擎无法执行 Javascript，因此任何只能通过 Javascript 获得的内容将无法被搜索引擎访问。

您需要在`<noscript>`标签内或默认情况下在页面内提供此内容，并让 Javascript 为您的 AJAX 版本隐藏它。

您不能向 Google 等搜索引擎提供不同的页面，因为它们通常会以机器人的身份抓取页面，但也会通过发送声称是 Internet Explorer 的用户代理字符串来屏蔽用户。这是他们确保您不会试图玩弄搜索引擎并且他们看到的内容与普通用户相同的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T09:28:39.437

As long as each page has a unique URL (either by url rewriting or by query string parameters) and uses that to drive the content being displayed SEO will work.

I've done this a number of times in the past.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T09:41:16.743

Ensure that your content is accessible to clients without JavaScript. You may have JavaScript on your pages that changes the content based on the URL.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T10:15:09.450

I don't really know about this, but IMHO, using semantic markups and submitting sitemap to Google helps a lot.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-22T17:52:00.543

为了解决这个问题，我创建了该站点的站点地图。例如，在我的站点地图中，我有

www.site.com/level_one/level_two/page1.html, www.site.com/level_one/level_two/page2.html, ...

所以爬虫（谷歌、雅虎、必应等）知道要寻找什么。但是当用户访问 www.site.com 时，总是使用纯 ajax 站点。因此，您需要像访问静态站点一样访问站点地图中的页面。

解决此问题的其他方法（更多工作）是使页面在没有 javascript 的情况下兼容，因此如果用户可以执行 javascript，您将所有 href 重写为“#”（例如）

请检查： http: [//www.mattcutts.com/blog/give-each-store-a-url/](http://www.mattcutts.com/blog/give-each-store-a-url/)

希望能帮助到你

# svn - How to enable mod_dav_svn in the root directory of a named virtual host?

> ID：264676
> 
> 赞同：15
> 
> 时间：2008-11-05T09:26:56.663
> 
> 标签：svn, apache

Is this possible? I had troubles with SVN clients not being able to access the repository with the following error message:

> Repository moved permanently to '[http://svn.example.com/test/](http://svn.example.com/test/)'; please relocate

If I added the '/' to the end of the path I was trying to access, it just strips it off again, and shows the same error message. My configuration file looks like:

```
<VirtualHost *>
  ServerName svn.example.com
  # Normal VirtualHost stuff here

  <Location /svn>
    # Uncomment this to enable the repository
    DAV svn
    SVNParentPath /some/path/to/repositories

    # Setup mod_authz_svn, etc, etc here
  </Location>
</VirtualHost> 
```

Note: This works. But if I change the Location to just `/` it stops working again with the error above. Is it possible to use the root directory, or am I missing something here? Firefox displays the repository listing fine when serving the repositories out of the root.

As someone else pointed out, this only seems to be an issue inside named virtual hosts... Anyone have any smart ideas why?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-17T13:58:39.883

The problem is that you are using the document root also as the repository root (I'm not blaming you, this should just work, but it doesn't).

Try pointing the `DocumentRoot` and `SVNParentPath` directives to different physical locations, so the resulting config file should look like this (abbreviated):

```
<VirtualHost *:80>
    DocumentRoot /home/svn.example.com/docroot

    <Location />
        SVNParentPath /home/svn.example.com/svnroot
        SVNListParentPath on
    </Location>
</VirtualHost> 
```

Also, as @Nigel Jewell says, remove that Rewrite block, for sanity.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T00:39:52.950

Continuing from comments to my previous answer, I've tried also with a VirtualHost:

```
<VirtualHost 127.0.0.1:80>
<Location />
    DAV svn
    SVNPath /repository
    AuthType Basic
    AuthName "Repository authentication"
    AuthUserFile /repository/.svn-auth
    AuthzSVNAccessFile /repository/.svn-access
    Satisfy All
    Require valid-user
</Location>
</VirtualHost> 
```

and it's working, I can browse the repository with firefox and can access it with the svn command line client.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-22T02:59:23.230

Found this in /etc/apache2/conf.d/subversion.conf (need to map error documents to defaults):

```
<VirtualHost *>
    ServerName svn.example.com
    ErrorLog    /var/log/apache2/svn.example.com-error_log
    TransferLog /var/log/apache2/svn.example.com-access_log
    #
    # Do not set DocumentRoot. It is not needed here and just causes trouble.
    #
    # Map the error documents back to their defaults.
    # Otherwise mod_dav_svn tries to find a "error" repository.
    #
    ErrorDocument 400 default
    ErrorDocument 401 default
    ErrorDocument 403 default
    ErrorDocument 404 default
    ErrorDocument 405 default
    ErrorDocument 408 default
    ErrorDocument 410 default
    ErrorDocument 411 default
    ErrorDocument 412 default
    ErrorDocument 413 default
    ErrorDocument 414 default
    ErrorDocument 415 default
    ErrorDocument 500 default
    ErrorDocument 501 default
    ErrorDocument 502 default
    ErrorDocument 503 default
    #
    <Location />
...
    </Location> 
```

After I've done this everything started working as expected.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T22:32:42.660

I ended up using mod_rewrite succesfully to rewrite all access to the root directory into `/svn`, hence getting access to the repositories from `/repository_name`. For reference, this is the configuration I ended up with:

```
# Rewrite / into /svn to avoid errors that seem to occur when using the root
# for repositories.
RewriteEngine On
# Subdirectories that SHOULD be accessed directly, ie. trac
# /svn should be here to avoid redirect loops
RewriteCond %{REQUEST_URI} !^/(trac|svn)/
RewriteRule ^/(.*)$ /svn/$1 [PT] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T00:57:15.973

Ok, I think we have found who to blame: named virtual hosts :)

With this configuration:

```
<VirtualHost dave.test>
<Location />
    DAV svn
    SVNPath /repository
    AuthType Basic
    AuthName "Repository authentication"
    AuthUserFile /repository/.svn-auth
    AuthzSVNAccessFile /repository/.svn-access
    Satisfy All
    Require valid-user
</Location>
</VirtualHost> 
```

when I run the command `svn ls http://dave.test` I got this error:

```
svn: Server sent unexpected return value (405 Method Not Allowed) in response to
PROPFIND request for '/' 
```

So apparently there is an issue when one tries to enable mod_dav_svn in the root directory of a named virtual host...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-17T13:11:12.837

Thanks for this, finally got it working with a VirtualHost due to your comments.

```
<VirtualHost *:80>
    ServerAdmin webmaster@example.com
    ServerName svn.example.com
    ServerAlias svn
    DocumentRoot /home/svn.example.com/public_html

    RewriteEngine On

    RewriteCond %{REQUEST_URI} ^/svn$
    RewriteRule .* /svn/ [PT]

    RewriteCond %{REQUEST_URI} !^/svn/
    RewriteRule ^/(.*)$ /svn/$1 [PT]

    <Location /svn>
            DAV svn
            SVNParentPath /home/svn.example.com/public_html
            SVNListParentPath on
    </Location>

    <LocationMatch /svn/.+>
            AuthzSVNAccessFile /home/svn.example.com/support/access.cfg

            AuthType Basic
            AuthName "Subversion"
            AuthUserFile /home/svn.example.com/.htpasswd
            Require valid-user
    </LocationMatch>
</VirtualHost> 
```

As shown I found that you probably want to also add:

```
RewriteCond %{REQUEST_URI} ^/svn$
RewriteRule .* /svn/ [PT] 
```

In order to catch [http://svn.example.com/svn](http://svn.example.com/svn) without the ending /.

Nige.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-05T22:48:47.497

```
This is working for me:

<Location />
    DAV svn
    SVNPath /repository
    AuthType Basic
    AuthName "Repository authentication"
    AuthUserFile /repository/.svn-auth
    AuthzSVNAccessFile /repository/.svn-access
    Satisfy All
    Require valid-user
</Location> 
```

Pointing the browser to [http://127.0.0.1](http://127.0.0.1) shows me the repository content.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-22T22:28:23.297

DocumentRoot "/usr/local/apache/htdocs/ForSvn" ServerName xxx.xxx ServerAdmin xxx ErrorLog "/usr/local/apache/logs/xxx-error_log" TransferLog "/usr/local/apache/logs/xxx-access_log"

```
ReWriteEngine On
RewriteCond %{REQUEST_URI} ^/svn$
RewriteRule .* /svn/ [PT]

<Location /svn>
       DAV svn
       SVNParentPath /svn/repos
       SVNListParentPath on

       # Limit write permission to list of valid users.
       <LimitExcept GET PROPFIND OPTIONS REPORT>
             AuthType Basic
             AuthName "Subversion"
             AuthUserFile /svn/authfiles/svn-htpasswd
             AuthzSVNAccessFile /svn/authfiles/svn-access.conf
             Require valid-user
       </LimitExcept>
</Location>

<LocationMatch /svn/myProject/>
             AuthType Basic
             AuthName "Subversion (private)"
             AuthUserFile /svn/authfiles/svn-htpasswd
             AuthzSVNAccessFile /svn/authfiles/svn-access.conf
             Require user user1 user2 user3...
</LocationMatch> 
```

and works fine with me. Thank you for this.

# java - 自动将测试从 JUnit 3 迁移到 JUnit 4 的最佳方法？

> ID：264680
> 
> 赞同：50
> 
> 时间：2008-11-05T09:32:45.993
> 
> 标签：java, junit, migration

我有一堆扩展 TestCase 的 JUnit 3 类，并希望将它们自动迁移为带有注释的 JUnit4 测试，例如`@Before`, `@After`,`@Test`等。
有任何工具可以在大批量运行中执行此操作吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-24T13:19:43.750

在我看来，这不可能那么难。所以让我们尝试一下：

## 0\. 进口

您需要导入三个注解：

```
import org.junit.After;
import org.junit.Before;
import org.junit.Test;` 
```

在您进行接下来的一些更改后，您将不需要`import junit.framework.TestCase;`.

## 1.注释`test*`方法

所有以 开头的方法都`public void test`必须在`@Test`注解之前。使用正则表达式可以轻松完成此任务。

## 2.注解SetUp和TearDown方法

Eclipse 生成以下`setUp()`方法：

```
@Override
protected void setUp() throws Exception { } 
```

必须替换为：

```
@Before
public void setUp() throws Exception { } 
```

同样适用于`tearDown()`：

```
@Override
protected void tearDown() throws Exception { } 
```

取而代之

```
@After
public void tearDown() throws Exception { } 
```

## 3.摆脱`extends TestCase`

每个字符串的文件只删除一次出现

```
" extends TestCase" 
```

## 4.删除主要方法？

可能有必要删除/重构将执行测试的现有主要方法。

## 5.将`suite()`方法转换为`@RunWithClass`

根据saua的评论，必须有`suite()`方法的转换。谢谢，萨瓦！

```
@RunWith(Suite.class)
@Suite.SuiteClasses({
  TestDog.class
  TestCat.class
  TestAardvark.class
}) 
```

## 结论

我认为，通过一组正则表达式很容易完成，即使它会杀死我的大脑；）

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2010-12-26T19:45:10.707

以下是我用来执行 furtelwart 建议的实际正则表达式：

```
// Add @Test
Replace:
^[ \t]+(public +void +test)
With:
    @Test\n    $1
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Remove double @Test's on already @Test annotated files
Replace:
^[ \t]+@Test\n[ \t]+@Test
With:
    @Test
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Remove all empty setUp's
Replace:
^[ \*]+((public|protected) +)?void +setUp\(\)[^\{]*\{\s*(super\.setUp\(\);)?\s*\}\n([ \t]*\n)?
With nothing
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Add @Before to all setUp's
Replace:
^([ \t]+@Override\n)?[ \t]+((public|protected) +)?(void +setUp\(\))
With:
    @Before\n    public void setUp()
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Remove double @Before's on already @Before annotated files
Replace:
^[ \t]+@Before\n[ \t]+@Before
With:
    @Before
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Remove all empty tearDown's
Replace:
^[ \*]+((public|protected) +)?void +tearDown\(\)[^\{]*\{\s*(super\.tearDown\(\);)?\s*\}\n([ \t]*\n)?
With nothing
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Add @After to all tearDown's
Replace:
^([ \t]+@Override\n)?[ \t]+((public|protected) +)?(void +tearDown\(\))
With:
    @After\n    public void tearDown()
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Remove double @After's on already @After annotated files
Replace:
^[ \t]+@After\n[ \t]+@After
With:
    @After
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Remove old imports, add new imports
Replace:
^([ \t]*import[ \t]+junit\.framework\.Assert;\n)?[ \t]*import[ \t]+junit\.framework\.TestCase;
With:
import org.junit.After;\nimport org.junit.Before;\nimport org.junit.Test;\nimport static org.junit.Assert.*;
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Remove all extends TestCase
Replace:
[ \t]+extends[ \t]+TestCase[ \t]+\{
With:
 {
Regular Expression: on
Case sensitive: on
File name filter:
*Test.java

// Look for import junit.framework;
Find:
import junit\.framework
Manually fix
Regular Expression: on
Case sensitive: on

// Look for ignored tests (FIXME, disabled, ...)
Find:
public[ \t]+void[ \t]+\w+test
Manually fix
Regular Expression: on
Case sensitive: on

// Look for dummy/empty tests
Find:
public[ \t]+void[ \t]+test[\w\d]*\(\s*\)\s*\{\s*(//[^\n]*)?\s*\}
Manually fix
Regular Expression: on
Case sensitive: on 
```

注意：按照上面显示的顺序执行它们很重要。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-24T09:10:08.307

我们正在将相当大的代码库迁移到 JUnit4。由于这是我第二次进行这样的迁移，我决定将代码保存在某处：

[https://github.com/FranciscoBorges/junit3ToJunit4](https://github.com/FranciscoBorges/junit3ToJunit4)

它处理的极端案例比上面答案中列举的案例更多。如：

*   调用`TestCase.setUp()`和`TestCase.tearDown()`
*   `TestCase(String)`在子类构造函数中调用构造函数
*   调用`TestCase.assert*`移至`Assert`.
*   将包名称固定`junit.framework`为`org.junit`
*   ETC

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-05T10:08:07.343

我目前不知道有什么工具可以做到这一点——我希望 Eclipse 很快就会提供一些插件——但是你可以敲出一个简单的源代码树来探索 Java 类，如果你只想要它就可以为你做这件事做一个基本的转换。我必须编写类似的东西来为遗留应用程序自动生成框架测试用例，所以我已经有了相当多的支持代码。欢迎您使用它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T09:26:18.423

据我所知，目前还没有可用的迁移工具。我所知道的是：

*   去年，在纳什维尔的 OOPSLA 上，有一篇关于 API 迁移的论文，但可惜他们的工具似乎没有公开可用。我将提供该论文的链接，（尽管我敢说它对您没有什么用，因为它涉及大量理论）：[“注解重构：推断旧版应用程序的升级转换”](http://people.cs.vt.edu/~tilevich/papers/rosemari-oopsla.pdf)。

*   上面，我写了“没有可用的工具（还）”，因为我的学生 Lea Hänsenberger 目前正在研究从 JUnit 4 a 到 JExample 以及从 JUnit 3 到 JUnit 4 的自动 API 迁移。请[在 Twitter 上关注 JExample](http://twitter.com/jexample)在她发布第一个测试版时收到通知。

我希望这些信息对您有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-28T06:09:49.563

好贴。我使用带有以下 RegEx 字符串的 Netbeans 进行了升级：（第一行搜索字符串，第二行替换字符串）

```
public void test
@Test\n    public void test

@Override\n.*protected void onSetUp
@Before\n    protected void onSetUp

@Override\n.*protected void onTearDown
@After\n    protected void onTearDown 
```

不要忘记标记正则表达式复选框！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-12-05T22:09:50.930

如果您想*自动将*Junit3 测试转换*为 Junit4*，您可以使用 Vogella 的 Codemodify 工具，该工具可在以下地址获得：

*   [https://github.com/vogellacompany/codemodify](https://github.com/vogellacompany/codemodify)

TL;DR 按如下方式安装和使用它：

*   如果您还没有使用 Eclipse，请获取它（它是开源的）
*   从菜单：**Help > Install new software ，然后将更新站点**[http://dl.bintray.com/vogellacompany/junit-4-tools/](http://dl.bintray.com/vogellacompany/junit-4-tools/)粘贴到*Work With*字段中
*   完成安装，如果需要重新启动。

然后，您可以右键单击任何 Junit3 测试类，并选择**Source > Convert to JUnit4**菜单项将您的类转换为 JUnit4。

[![在此处输入图像描述](https://i.stack.imgur.com/lueKt.png)](https://i.stack.imgur.com/lueKt.png)

该工具将自动*删除 TestCase parent*，过时的导入，添加*@Before*，*@After*，*@Test*注释等。

# java - 在以 root 身份运行的 Java 线程中，我们如何应用特定于登录用户的 Unix 权限？

> ID：264681
> 
> 赞同：3
> 
> 时间：2008-11-05T09:32:57.757
> 
> 标签：java, unix, permissions

我们有一个在 Unix 上以**root**身份运行的 Java 程序，因此可以读取文件夹的内容`/home/user1`和`/home/user2`. 但是，如果 Unix 用户“user1”在我们的应用程序中登录，他应该无法访问“/home/user2”数据。我们想直接使用 Unix 权限，而不是在我们的应用程序中重新创建所有权限！那么，我们能不能...

1.  尝试根据登录的用户更改我们程序的 UID 吗？听起来很难，而且每个文件访问都在不同的线程中，所以我们程序的每个线程上的 UID 都会不同......
2.  使用JNI读取“ `/home/user2`”的权限...然后判断user1是否有足够的“ `/home/user2`”权限？（如何 ？）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T10:09:11.773

最简单和最便携的方法是生成一个子进程，让它执行一个用 C 编写的包装器，该包装器更改 UID，删除所有特权（小心，编写一个包装器来做到这一点很棘手 - 这和写作一样难setuid 包装器），并执行您通过 RMI 与之交谈的另一个 java 实例。该 java 实例将代表用户执行所有文件系统操作。

对于单线程 Linux 程序，您可以改用`setfsuid()`/ `setfsgid()`，但这不是可移植或多线程程序的选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T12:14:32.487

**使用安全管理器！**

1.  将当前的 unix 用户 id 放入 ThreadLocal
2.  创建您自己的 SecurityManager 来检查 unix 用户对 checkRead() 和 checkWrite() 的权限
3.  System.setSecurityManager(新的 MySecurityManager())
4.  享受

**更新**

当然，没有标准库来读取 unix 文件权限。这不是WORA。

但是我已经简单地尝试找到一个可以使用的库，并找到了这个：http: [//jan.newmarch.name/java/posix/](http://jan.newmarch.name/java/posix/)它使用 JNI，但您不需要编写自己的 JNI 代码，它是一个很大的解脱。:) 我相信肯定还有其他人。

Class Stat 从那里为您提供所有必需的访问信息：http: [//jan.newmarch.name/java/posix/posix.Stat.html](http://jan.newmarch.name/java/posix/posix.Stat.html)

**更新 2**

正如人们所提到的，这种方法无法检查“非标准”unix 安全功能，例如 ACL 或 Posix 功能（可能是；不确定它们是否适用于文件）。但是如果设定了与主机操作系统安全性完全同步的目标，那么我们就更需要使用 SecurityManager，因为它是一种 JVM 范围的保护机制！是的，我们可以启动一个子 SUID 进程来验证权限（并保持它运行，在用户登录时通过管道运行与它通信），**但我们需要从 SecurityManager 这样做**！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T09:54:51.940

如果您只希望应用程序允许用户 1 读取文件，我强烈建议应用程序以用户 1 身份运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T10:00:29.853

如果其他一切都失败了，您可以从 java 运行 shellscript 并解析结果。

例如描述[here](http://www.devx.com/tips/Tip/14667)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T10:09:47.793

对于那些想知道的人，显然**不可能**`setuid`通过为每个独立线程 调用 JNI 来做到这一点。`setuid`影响整个进程，而不仅仅是调用它的线程。

如果您想`setuid`在单线程 Java 程序中调用，那么[http://www2.sys-con.com/itsg/virtualcd/Java/archives/0510/Silverman/index.html](http://www2.sys-con.com/itsg/virtualcd/Java/archives/0510/Silverman/index.html)上有一个很好的示例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T12:37:43.033

另一种选择是颠倒该方法：大多数时间以root身份运行代码而不是更改用户ID或在必须使用某些受限资源时以某种方式检查权限，而是以大多数时间以用户身份运行*并*交谈当它需要做一些只有root才能做的事情时，以root身份运行的一个较小的守护进程。这还具有减少攻击面的额外好处。

当然，您随后必须验证从以用户身份运行的进程到以 root 身份运行的进程的连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-07-16T16:08:29.500

我也有像 Mikael 一样的确切问题，并到此页面寻找答案。

没有一个答案对我来说是 100% 满意的。所以我在想4个选择：

1.  使用有权访问所有用户的 Linux 组。在该组下运行单个 Java 应用程序。这个 Java 应用程序可以使用任何方式与“根”应用程序通信。

    潜在地，它可以是“酒店”版。例如，每 100 个用户（或视情况而定）有 1 个“酒店”（具有组权限的应用程序）。因此，如果您有 10,000 个用户，您需要 100 家酒店，这是非常易于管理的。

2.  为每个子应用程序在其自己的用户 ID 下生成一个 JVM。这就像调用脚本，但不是使用 stdin/stdio/stderr，而是使用任何通信协议。就我而言，我使用的是 XMPP 和[IO 数据](http://xmpp.org/extensions/xep-0244.html)（因为它已经被其他组件使用，所以它在“哪里”运行，也就是运行哪个 JVM 并不重要）。

3.  创建一个[超级服务器](http://en.wikipedia.org/wiki/Super-server)“根”应用程序。这可以是原始“根”应用程序的一部分，也可以是专门用于服务管理的单独服务。

    超级服务器负责处理用户特定子应用的传入请求（即它实际上成为[反向代理](http://en.wikipedia.org/wiki/Reverse_proxy)），并启动真正的子应用（如果它们尚未运行），并来回传递消息在客户端和子应用程序之间。

    此外，可以将子应用程序*池*化（或者甚至“钝化”，如果有的话），就像[Java EE EJB 容器](http://www.leocrawford.org.uk/work/jcea/part1/ejbcontainer.html)那样。因此，即使有 10,000 个用户和（可能）10,000 个子应用程序服务，运行的子应用程序的最大数量也是有上限的。闲置的应用程序被关闭以为其他应用程序腾出空间。

4.  与#3 相同，但不是创建专有的服务管理机制，而是与[Upstart](http://en.wikipedia.org/wiki/Upstart)（或底层操作系统中的服务管理框架）集成。即有一个可以控制Upstart 的“根”服务。Upstart可以启动、停止、重启，可以查询子服务的状态，就像它可以控制mysqld、Apache等一样。

For me, now, the quickest and simplest to implement would be #1\. However, my ideal solution would be #4, but it will take time and testing whether it works well. (the concept itself borrows from inetd/xinetd and EJB, so I think it's pretty sound fundamentally)

# css - CSS：从 2 开始编号页面而不是 1

> ID：264685
> 
> 赞同：4
> 
> 时间：2008-11-05T09:35:49.063
> 
> 标签：css, counter

在 CSS 中，使用：

```
@page { @top-right { content: "Page " counter(page) " of " counter(pages); } } 
```

打印页面时，我可以在每页的顶部显示页码。这很好用。但是现在，我怎样才能使页码以 2 而不是 1 开头？我可以通过修改上面的 CSS 规则来做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-13T08:34:24.707

如果您使用的是飞碟（我的情况），请使用以下 CSS：

> 表{-fs-table-paginate：分页；}

它就像一个魅力。和飞碟岩石:)。真的强烈推荐。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-11T23:03:11.793

尝试：

```
@page {
    counter-increment: page;
    counter-reset: page 1;
    @top-right {
        content: "Page " counter(page) " of " counter(pages);
    }
} 
```

using`page 1`将重置计数器的起点。您可以使用任何整数开始计数。默认值为`0`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-08T19:48:26.703

在玩了飞碟之后，我想 CSS 没有办法做到这一点（或者它是一个非常复杂的），因为“page”/“pages”似乎是内部 CSS 变量。也许 CSS 3 会变得更好，似乎有一个 calc() 函数，所以 counter(calc(page+1))*或许*可以工作......

但是还有另一种方法可以从第 2 页开始获取 PDF。您可以通过将此行添加到 xhtml 文件来向 PDF 添加空白的第一页：

```
<h1 style="page-break-before:always"></h1> 
```

然后，您可以在使用打印机时仅打印 PDF 的第 2-... 页，也可以使用某些 PDF 编辑器从 PDF 中删除第一页。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-14T12:32:07.050

你看过关于计数器的 CSS 文档吗？[看到这里在](http://www.w3.org/TR/CSS2/generate.html#counters)我看来，您可以调用计数器重置。默认情况下，计数器设置为 0。如果在您的 Body 标签中您执行了“内容重置：第 1 页；” 那么它应该强制第一页从 2 而不是 1 开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-21T15:31:22.727

为查看此页面的其他人发布此内容。您还可以查看下面提供的另一个 stackoverflow 帖子。这对我有用。

[飞碟 - 使用 css 计算页数](https://stackoverflow.com/questions/29136505/flying-saucer-page-count-with-css)

```
.seq-start{
    -fs-page-sequence: start;
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-05T09:46:25.937

不知道这是否有效，但你为什么不试试`counter(page+1)`呢？

# java - 有没有办法从 Java 程序中隐藏 win32 启动控制台（如果可能没有 JNI）

> ID：264687
> 
> 赞同：18
> 
> 时间：2008-11-05T09:36:20.153
> 
> 标签：java, winapi, console

您从控制台启动一个 java 程序（可能使用 .bat 脚本）。我不希望控制台保持可见，我想隐藏它。

有没有一种简单的方法可以做到这一点？没有 JNI 吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-05T09:38:11.663

使用 javaw。

[http://java.sun.com/javase/6/docs/tooldocs/windows/java.html](http://java.sun.com/javase/6/docs/tooldocs/windows/java.html)

> javaw 命令与 java 相同，只是 javaw 没有关联的控制台窗口。当您不希望出现命令提示符窗口时，请使用 javaw。但是，如果由于某种原因启动失败，javaw 启动器将显示一个包含错误信息的对话框。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-05-25T13:46:43.890

您可以使用`start javaw`. 它将隐藏黑色控制台窗口。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-05T09:42:11.560

这个 .bat 技巧适用于一般程序，所以我认为它也应该适用于启动 java 程序：

调用`start program`而不是仅`program`在您的 .bat 脚本中调用

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-05T09:40:46.993

您可以使用 javaw.exe（没有 java）而不是使用 java.exe 来隐藏控制台。

要设置的最有用的关联之一是使用 java.exe 使 *.jar 文件可执行。然后，您只需在命令行上键入 jar 的名称即可开始执行。

如果您使用 javaw.exe 而不是 java.exe，您将看不到控制台输出。请注意，Java 安装程序通常将 *.jar 文件与 javaw.exe 而不是 java.exe 关联，从而覆盖您的设置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-02-24T17:05:59.573

下载 jsmooth 并在一两分钟内创建您自己的自定义 exe。然后只需使用该 exe 启动您的 java 应用程序。您甚至可以将 JRE 与您的应用程序捆绑在一起。

[http://jsmooth.sourceforge.net](http://jsmooth.sourceforge.net)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-06T12:09:53.517

如果从文件运行，你的脚本应该看起来像 `start javaw start javaw -jar ***.jar`

# java - 在 Java 中捕获全局按键

> ID：264689
> 
> 赞同：3
> 
> 时间：2008-11-05T09:37:34.503
> 
> 标签：java, global, keypress

因此，每当用户在我的 Swing 应用程序中的任何位置按下空格键时，我都想触发一个事件（暂停/取消暂停某些媒体）。

由于有如此多的控件和面板可以具有焦点，因此实际上不可能将键事件都添加到它们中（更不用说粗略了）。

所以我发现

```
KeyboardFocusManager.getCurrentKeyboardFocusManager().addKeyEventDispatcher() 
```

太棒了，您可以注册全局按键预处理程序。但是有一个主要问题 - 在输入字段，表格单元格等中一直输入空格，我显然不想触发暂停事件！

那么有什么想法吗？也许有办法全局检测光标是否集中在允许文本输入的东西上，而不必检查所有可编辑控件的列表（呕吐！）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T09:45:29.277

我认为您自己回答了这个问题-是的，我认为您可以找出当前具有焦点的元素，并且如果它是某个字段类的实例，则出于暂停事件的目的而忽略该空间。如果它接缝繁重，请不要担心，instanceof 对于 JVM 来说非常快（无论如何，您所说的人类规模事件对于处理器来说都是一个 eon）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T18:29:25.210

我对我的 Swing 生疏了，但我认为您应该尝试使用[Toolkit.addAWTEventListener](http://java.sun.com/javase/6/docs/api/java/awt/Toolkit.html#addAWTEventListener(java.awt.event.AWTEventListener,%20long))和`KEY_EVENT_MASK`. 然后，您可以根据 AWTEvent 处理的类型和来源对其进行过滤。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T22:52:17.317

好的...好吧，我正在尝试根据来源进行过滤。问题是我的可编辑组合框...它们是 instanceof

```
javax.swing.plaf.basic.BasicComboBoxEditor$BorderlessTextField 
```

而且由于 BorderlessTextField 是一个私有内部类，我显然不能对它进行 instanceof 检查。

想法？

编辑：好的，所以这有效....

```
 KeyboardFocusManager.getCurrentKeyboardFocusManager().addKeyEventPostProcessor(new KeyEventPostProcessor() {

            public boolean postProcessKeyEvent(KeyEvent e) {
                if (e.getID() == KeyEvent.KEY_PRESSED) {
                    Object s = e.getComponent();
                    if (!(s instanceof JTextField) &&
                        !(s instanceof JTable && ((JTable) s).isEditing())
                        ) {
                        music_player.pauseEvent();
                    }

                    //System.out.println(s.getClass().toString());
                }
                return true;
            }
        }); 
```

它完全恶心，我讨厌它。我希望我能找到一种方法来检查按键是否已被任何组件消耗 - 然后我只能在按键未被任何组件操作时执行暂停事件。

# xml - 微软 XML 解析器 3.0

> ID：264698
> 
> 赞同：-1
> 
> 时间：2008-11-05T09:42:10.673
> 
> 标签：xml, parsing

我工作的一个应用程序使用 Microsoft XML 解析器 3.0。我找不到任何关于它的文档，这已经成为一个问题，因为我们不能将此 Web 应用程序与 Firefox、Safari 等一起使用。我错了吗？

我们可以在不同的浏览器中安装 XML parser 3.0 吗？

谁可以找到有关它的文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T09:57:00.080

**资源：**

*   [MSDN](http://msdn.microsoft.com/en-us/library/ms763742.aspx)
*   [MSXML 团队博客](http://blogs.msdn.com/xmlteam/)
*   [维基百科](http://en.wikipedia.org/wiki/MSXML)

> 我们可以在不同的浏览器中安装 XML parser 3.0 吗？

不，MSXML 是一个 ActiveX 对象，因此它仅在 IE 中受支持。

但是其他浏览器也有等价物。如果您想知道如何将基于 MSXML 的代码转换为跨平台代码，则必须提供更多详细信息。

# sql - SQL Express 2005，安全数据库文件

> ID：264702
> 
> 赞同：1
> 
> 时间：2008-11-05T09:45:27.203
> 
> 标签：sql, security, deployment

我已经构建了一个使用 SQL Express 2005 的应用程序并且我想部署它，但问题是任何在他的计算机上安装了 SQL Management Studio（或类似软件）的人都可以连接到我的数据库并对其进行更改。有没有办法阻止最终用户查看或编辑我的数据库的内容，即使是那些拥有管理员权限的用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T10:03:08.617

我猜你指的是默认情况下 SQL Server 安装允许 Windows 和 SQL Server 身份验证的事实。如果您删除 Windows 身份验证模式，则用户将不得不通过 SQL Server 身份验证进行连接。

这来自[http://support.microsoft.com/kb/247931](http://support.microsoft.com/kb/247931)

> SQL Server 身份验证
> 
> SQL Server 身份验证依赖于 SQL Server 计算机维护的内部用户列表。此列表不包括 Windows NT 用户，并且特定于 SQL Server 计算机。用户是使用 SQL Server 企业管理器创建和配置的。要使用此身份验证方法，请执行以下步骤：
> 
> • 如果您通过开放式数据库连接 (ODBC) 进行连接，则在 ODBC 管理器中，当您配置数据源时选择 SQL Server 身份验证。
> 
> • 在ActiveX 数据对象(ADO) 连接字符串中，使用ODBC 时包括参数“UID”和“PWD”，使用SQLOLEDB 提供程序时包括参数“用户ID”和“密码”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T09:54:01.757

我想这不是您希望的答案，但任何具有管理权限的人都将能够浏览和编辑数据库中的信息是不可避免的。

你无法改变这一点。

也许您可以考虑为什么要阻止这种访问？

我希望您想防止数据被篡改或意外损坏？

如果这是原因，那么您可以通过向数据库添加约束来防止损坏。添加外键约束、唯一性约束以及有助于防止数据损坏的所有内容。

然后管理员需要在它们篡改之前故意取消这些约束，这将防止大多数意外损坏，但当然不能防止恶意破坏。

如果您担心保护您的知识产权，您可以加密程序组件（存储过程、视图和函数）。这种加密不是很强，但可以防止随意检查。

通过使用添加加密

```
WITH ENCRYPTION 
```

CREATE 或 ALTER 语句中的子句。

# terminology - WS Addressing

> ID：264705
> 
> 赞同：-1
> 
> 时间：2008-11-05T09:45:47.293
> 
> 标签：terminology, ws-addressing

What is WS Adressing?

Thanks Sekar

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T09:49:31.657

[WS-Addressing or Web Services Addressing is a specification of transport-neutral mechanisms that allow web services to communicate addressing information.](http://en.wikipedia.org/wiki/WS-Addressing)

# c - converting character encoding using a posix c function

> ID：264708
> 
> 赞同：3
> 
> 时间：2008-11-05T09:47:05.700
> 
> 标签：c, posix, character-encoding

Is there a standard posix C function to convert encodings, say from windows-1251 to utf-8 and back?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T09:56:33.873

Yes, it's `iconv()`.

References:

*   [http://www.opengroup.org/onlinepubs/009695399/functions/iconv.html](http://www.opengroup.org/onlinepubs/009695399/functions/iconv.html)
*   [http://www.opengroup.org/onlinepubs/009695399/functions/iconv_open.html](http://www.opengroup.org/onlinepubs/009695399/functions/iconv_open.html)
*   [http://www.opengroup.org/onlinepubs/009695399/functions/iconv_close.html](http://www.opengroup.org/onlinepubs/009695399/functions/iconv_close.html)

# .net - .NET WinForms 中最大化 MDI 子项的多个控制按钮

> ID：264709
> 
> 赞同：2
> 
> 时间：2008-11-05T09:47:34.013
> 
> 标签：.net, winforms, user-interface, mdi

[MDI 错误 http://www.dicu.com/pics/bug_mdi.jpg](http://www.dicu.com/pics/bug_mdi.jpg)

这就是我尝试自动最大化 MDI 子项时得到的结果。代码是这样的：

```
this.IsMdiContainer = true;
child = new Form();
child.MdiParent = this;
child.WindowState = FormWindowState.Maximized;
child.Show(); 
```

任何想法为什么我会得到多个控制按钮？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T21:31:28.570

我可以部分复制这个。不要在构造函数中调用子类的 Show() 方法，而是在父类的 Load 事件处理程序中调用。不太确定不平衡的最小/最大/关闭图标。

# logging - 有没有一种方便的方法来分析 servlet？

> ID：264711
> 
> 赞同：1
> 
> 时间：2008-11-05T09:49:26.053
> 
> 标签：logging, servlets, analytics, tracking

传统的日志文件分析工具（awstats、statcounter）或通用网络分析（谷歌分析、雅虎网络分析）不适合分析 servlet 上的流量。使用日志框架（例如 log4j）记录消息并为此编写自定义分析软件是否有一个很好的替代方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T10:52:23.807

我使用[dTrace](http://www.sun.com/bigadmin/content/dtrace/)，但我在 Solaris 上运行。如果您在 Linux 上，他们也有类似的工具[SystemTap](http://sourceware.org/systemtap/)。它们非常适合分析，特别是如果您不想更改应用程序的一行代码。

注意：这两种方法都允许您使用简单的脚本来衡量流量

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T11:09:31.977

也许您可以编写一个[servlet 过滤器，通过独立于平台的](http://java.sun.com/products/servlet/Filters.html)[JMX 监控基础设施](http://java.sun.com/developer/technicalArticles/J2SE/jmx.html)报告分析等？

# c# - 嵌入在另一个对象中的属性

> ID：264714
> 
> 赞同：2
> 
> 时间：2008-11-05T09:50:08.767
> 
> 标签：c#, wcf, reportviewer

我正在尝试使用要传递给report.rdlc 的业务对象。我的对象中的属性没有直接暴露。我需要的属性嵌入在顶级对象内的另一个对象中。由于这是一个 WCF 项目，我无法控制服务器端发生的事情。我只能请求这些对象或从数据库中插入/更新/删除它们的信息。这样做是因为后端可以使用多种风格的数据库。

以下是将我的业务对象添加为后看到的内容`DataSource`：

```
-BusinessObject
 -CustomerInfo
  -ClientName
    -ColumnName
    -DisplayName
    -FieldName
    -IsNull
    -KeyColumn
    -SenondKeyColumn
    -StringValue 
  -ClientID
    -ColumnName
    -DisplayName
    -FieldName
    -IntValue
    -IsNull
    -KeyColumn
    -SenondKeyColumn
   +ClientAddress
   +Instrument
   +Telephone 
```

等等等等

例如，我需要能够显示该`ClientName.StringValue`字段。如果我将我想要的字段拖到我得到的报告上：

```
=First(Fields!StringValue.Value) 
```

我假设在运行报告时这不会显示任何内容，因为它无法限定`StringValue`它正在谈论的内容并且可能有很多。

如果我尝试拖动`ClientName`我得到的对象：

```
=First(Fields!ContactName.Value) 
```

然而，这给出了：

```
#ERROR 
```

报告运行时。

我原以为你可以使用：

```
=First(Fields!ClientName.StringValue.Value) 
```

但这甚至不会让我建立。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T14:04:53.060

问题是信息不在根级别。不过我解决了。

```
=First(Fields!ClientName.Value.StringValue, "BusinessObject_CustomerInfo") 
```

我现在已经很好地掌握了 ReportViewer 组件了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T16:23:30.690

如果您将数据源设置为从服务返回的 CustomerInfo 实例（或列表），它应该可以工作。当您开始处理对象层次结构时，ReportViewer 控件可能会有点复杂，但如果所有信息都位于根级别，则您不必做任何疯狂或特殊的事情。

# entity-framework - 为什么在 Entity Framework 和 EntityDataSource 示例中使用“it”？

> ID：264718
> 
> 赞同：5
> 
> 时间：2008-11-05T09:52:46.593
> 
> 标签：entity-framework

愚蠢的问题我敢肯定，但为什么实体框架 EntityDataSource 对象需要 where 子句包含“**它**”作为对象选择器的第一部分？

where 子句 ( [http://msdn.microsoft.com/en-us/library/cc488531.aspx](http://msdn.microsoft.com/en-us/library/cc488531.aspx) ) 的文档指出该字符串直接传递给 ObjectQuery(T)，所以我应该能够传入 (例如）“ **x** .OnlineOrderFlag = TRUE”，其中 x 是谓词中有意义的任何内容，但是该子句仅在我传入“ **it** .OnlineOrderFlag = TRUE”时才有效

所有 Microsoft 示例都使用“它”，所以我错过了什么？

史蒂夫戴维斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T10:03:26.697

看起来“它”只是一个隐式参数名称。在查询表达式中，这是由范围变量提供的，但您没有在对 的调用中指定参数名称`Where`，因此看起来它只是隐式使用“it”。

我同意它的记录很差:(

# gdi+ - gdi+ Graphics::DrawImage 真的很慢~~

> ID：264720
> 
> 赞同：18
> 
> 时间：2008-11-05T09:53:15.267
> 
> 标签：gdi+, performance, drawimage

我正在使用 GDI+ Graphic 将 4000*3000 的图像绘制到屏幕上，但它真的很慢。大约需要 300 毫秒。我希望它只占用不到 10 毫秒。

```
Bitmap *bitmap = Bitmap::FromFile("XXXX",...); 
```

// - - - - - - - - - - - - - - - - - - - - - - // 这部分大约需要300ms，太可怕了！

```
int width = bitmap->GetWidth();
int height = bitmap->GetHeight();
DrawImage(bitmap,0,0,width,height); 
```

//------------------------------------------------------

我不能使用 CachedBitmap，因为我想稍后编辑位图。

我该如何改进它？还是有什么不对？

这个原生 GDI 函数也将图像绘制到屏幕上，它只需要 1 毫秒：

```
SetStretchBltMode(hDC, COLORONCOLOR);   
StretchDIBits(hDC, rcDest.left, rcDest.top, 
        rcDest.right-rcDest.left, rcDest.bottom-rcDest.top, 
        0, 0, width, height,
        BYTE* dib, dibinfo, DIB_RGB_COLORS, SRCCOPY); 
```

//------------------------------------------------ --------------

如果我想使用 StretchDIBits，我需要传递 BITMAPINFO，但是如何从 Gdi+ 位图对象中获取 BITMAPINFO？我通过 FreeImage lib 进行了实验，我使用 FreeImageplus 对象调用 StretchDIBits，它绘制得非常快。但是现在我需要绘制Bitmap，并在Bitmap的位数组上写一些算法，如果我有一个Bitmap对象，我怎么能得到BITMAPINFO呢？真的很烦-_______________-|

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-05T16:03:48.203

如果您使用 GDI+，TextureBrush 类是您快速渲染图像所需要的。我已经用它编写了几个 2d 游戏，大约 30 FPS 左右。

我从来没有用 C++ 编写过 .NET 代码，所以这里有一个 C#-ish 示例：

```
Bitmap bmp = new Bitmap(...)
TextureBrush myBrush = new TextureBrush(bmp)

private void Paint(object sender, PaintEventArgs e):
{
    //Don't draw the bitmap directly. 
    //Only draw TextureBrush inside the Paint event.
    e.Graphics.FillRectangle(myBrush, ...)
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T10:47:53.847

你有一个 4000 x 3000 分辨率的屏幕？哇！

如果没有，你应该只绘制图像的可见部分，它会快得多......

[第一次评论后编辑]我的评论确实有点愚蠢，我想 DrawImage 会掩盖/跳过不需要的像素。

在您的编辑（显示 StretchDIBits）之后，我猜可能速度差异的来源可能来自[StretchDIBits](http://msdn.microsoft.com/en-us/library/ms532289.aspx "拉伸DIBits")是硬件加速的事实（“*如果驱动程序不能支持 JPEG 或 PNG 文件图像*”是一个提示......）而 DrawImage 可能是（我没有证据！）用 C 编码，依靠 CPU 能力而不是 GPU 的能力......

如果我没记错的话，DIB 图像很快（尽管是“设备独立的”）。参见[高速 Win32 动画](http://www.drdobbs.com/cpp/184403210?pgno=5 "高速 Win32 动画")：“*使用 CreateDIBSection 做高速动画*”。好的，它适用于旧 Windows 版本（1996 年！）中的 DIB 与 GDI，但我认为它仍然是正确的。

[编辑] 也许[Bitmap::GetHBITMAP](http://msdn.microsoft.com/en-us/library/ms536295(VS.85).aspx)函数可能会帮助您使用 StretchDIBits （未测试......）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T11:54:05.007

只是一个想法; 与其在绘制之前检索图像的宽度和高度，不如在加载图像时缓存这些值？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T14:00:21.400

探索将插值模式显式设置为 NearestNeighbor 的影响（在您的示例中，看起来实际上不需要插值！但是 300 毫秒是在不需要插值时进行高质量插值的成本，因此值得尝试）

要探索的另一件事是更改位图的颜色深度。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T16:25:30.047

不幸的是，当我遇到类似的问题时，我发现 GDI+ 比 GDI 慢得多，而且通常硬件加速也不行，但现在微软已经转向 WPF，他们不会回来改进 GDI+！

所有显卡制造商都转向 3D 性能，似乎对 2D 加速不感兴趣，并且没有明确的信息来源说明哪些功能可以或可以不进行硬件加速。非常令人沮丧，因为使用 GDI+ 在 .NET 中编写了一个应用程序，我不乐意更改为完全不同的技术以将其加速到合理的水平。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-10-24T12:46:52.853

我认为它们不会有太大的不同，但是由于您实际上不需要调整图像大小，请尝试使用不会（尝试）调整大小的[DrawImage重载：](http://msdn.microsoft.com/en-us/library/ms536030.aspx)

```
DrawImage(bitmap,0,0); 
```

就像我说的那样，我怀疑它会有所不同，因为我*确信***DrawImage**检查位图的**宽度**和**高度**，如果不需要调整大小，只需调用此重载。（我希望它不会打扰所有 1200 万像素而没有实际工作）。

更新：我的想法是错误的。我后来发现了，但是伙计们的评论让我想起了我的旧答案：你**想**指定目标大小；即使它与源大小匹配：

```
DrawImage(bitmap, 0, 0, bitmap.GetWidth, bitmap.GetHeight); 
```

原因是因为目的地的 dpi 和目的地的 dpi 之间的 dpi 差异`bitmap`。GDI+ 将执行缩放以使图像出现正确的“大小”（即以英寸为单位）

* * *

自去年 10 月以来，我自己了解到的是，您确实想要绘制位图的*“缓存”*版本。GDI+中有一个`CachedBitmap`类。使用它有一些技巧。但是最后我有一个功能位（Delphi）代码可以做到这一点。

需要注意的是，它`CachedBitmap`可以变得无效 - 这意味着它不能用于绘制。如果用户更改分辨率或颜色深度（例如远程桌面），就会发生这种情况。在这种情况下，`DrawImage`将失败，您必须重新创建`CachedBitmap`：

```
class procedure TGDIPlusHelper.DrawCachedBitmap(image: TGPImage;
      var cachedBitmap: TGPCachedBitmap;
      Graphics: TGPGraphics; x, y: Integer; width, height: Integer);
var
   b: TGPBitmap;
begin
   if (image = nil) then
   begin
      //i've chosen to not throw exceptions during paint code - it gets very nasty
      Exit;
   end;

   if (graphics = nil) then
   begin
      //i've chosen to not throw exceptions during paint code - it gets very nasty
      Exit;
   end;

   //Check if we have to invalidate the cached image because of size mismatch
   //i.e. if the user has "zoomed" the UI
   if (CachedBitmap <> nil) then
   begin
      if (CachedBitmap.BitmapWidth <> width) or (CachedBitmap.BitmapHeight <> height) then
         FreeAndNil(CachedBitmap); //nil'ing it will force it to be re-created down below
   end;

   //Check if we need to create the "cached" version of the bitmap
   if CachedBitmap = nil then
   begin
      b := TGDIPlusHelper.ResizeImage(image, width, height);
      try
         CachedBitmap := TGPCachedBitmap.Create(b, graphics);
      finally
         b.Free;
      end;
end;

    if (graphics.DrawCachedBitmap(cachedBitmap, x, y) <> Ok) then
begin
       //The calls to DrawCachedBitmap failed
       //The API is telling us we have to recreate the cached bitmap
       FreeAndNil(cachedBitmap);
       b := TGDIPlusHelper.ResizeImage(image, width, height);
       try
          CachedBitmap := TGPCachedBitmap.Create(b, graphics);
       finally
          b.Free;
       end;

       graphics.DrawCachedBitmap(cachedBitmap, x, y);
    end;
 end; 
```

`cachedBitmap`是通过引用传入的。将创建`DrawCachedBitmap`对其*缓存*版本的第一次调用。然后在后续调用中传递它，例如：

```
Image imgPrintInvoice = new Image.FromFile("printer.png");
CachedBitmap imgPrintInvoiceCached = null;

...

int glyphSize = 16 * (GetCurrentDpi() / 96);

DrawCachedBitmap(imgPrintInvoice , ref imgPrintInvoiceCached , graphics, 
      0, 0, glyphSize, glyphSize); 
```

考虑到当前的 DPI，我使用例程在按钮上绘制字形。当用户运行高 dpi 时，Internet Explorer 团队也可以使用相同的方法来绘制图像（即绘制缩放图像时速度非常慢，因为他们使用 GDI+）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-30T12:04:12.917

尝试使用文件中的位图副本。某些文件的 FromFile 函数返回“慢”图像，但其副本绘制速度更快。

```
Bitmap *bitmap = Bitmap::FromFile("XXXX",...);

Bitmap *bitmap2 = new Bitmap(bitmap); // make copy

DrawImage(bitmap2,0,0,width,height); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-12-01T02:57:12.327

/* 首先对不起 ma 英语，代码部分是波兰语，但很容易理解。我有同样的问题，我找到了最好的解决方案。这里是。

不要使用：图形图形（hdc）；graphics.DrawImage(gpBitmap, 0, 0); 它很慢。

**使用：GetHBITMAP(Gdiplus::Color(), &g_hBitmap) 用于 HBITMAP 并使用我的函数 ShowBitmapStretch() 进行绘制。**

您可以调整它的大小，而且速度要快得多！Artur Czekalski / 波兰

*/

```
//--------Global-----------
Bitmap *g_pGDIBitmap; //for loading picture
int gRozXOkna, gRozYOkna; //size of working window
int gRozXObrazu, gRozYObrazu; //Size of picture X,Y
HBITMAP g_hBitmap = NULL; //for displaying on window
//------------------------------------------------------------------------------
int ShowBitmapStretch(HDC hdc, HBITMAP hBmp, int RozX, int RozY, int RozXSkal, int RozYSkal, int PozX, int PozY) 
{
    if (hBmp == NULL) return -1;
    HDC hdc_mem = CreateCompatibleDC(hdc); //utworzenie kontekstu pamięciowego
    if (NULL == hdc_mem) return -2;
    //Trzeba połączyć BMP z hdc_mem, tzn. umieścić bitmapę w naszym kontekście pamięciowym
    if (DeleteObject(SelectObject(hdc_mem, hBmp)) == NULL) return -3; 

    SetStretchBltMode(hdc, COLORONCOLOR); //important! for smoothness
    if (StretchBlt(hdc, PozX, PozY, RozXSkal, RozYSkal, hdc_mem, 0, 0, RozX, RozY, SRCCOPY) == 0) return -4;

    if (DeleteDC(hdc_mem) == 0) return -5;
    return 0; //OK
}
//---------------------------------------------------------------------------
void ClearBitmaps(void)
{
    if (g_hBitmap) { DeleteObject(g_hBitmap);  g_hBitmap = NULL; }
    if (g_pGDIBitmap) { delete g_pGDIBitmap;  g_pGDIBitmap = NULL; }
}
//---------------------------------------------------------------------------
void MyOpenFile(HWND hWnd, szFileName)
{
    ClearBitmaps(); //Important!
    g_pGDIBitmap = new Bitmap(szFileName); //load a picture from file

    if (g_pGDIBitmap == 0) return;
    //---Checking if picture was loaded
    gRozXObrazu = g_pGDIBitmap->GetWidth();
    gRozYObrazu = g_pGDIBitmap->GetHeight();
    if (gRozXObrazu == 0 || gRozYObrazu == 0) return;

    //---Uworzenie bitmapy do wyświatlaia; DO IT ONCE HERE!
    g_pGDIBitmap->GetHBITMAP(Gdiplus::Color(), &g_hBitmap); //creates a GDI bitmap from this Bitmap object
    if (g_hBitmap == 0) return;

    //---We need to force the window to redraw itself
    InvalidateRect(hWnd, NULL, TRUE);
    UpdateWindow(hWnd);
}
//---------------------------------------------------------------------------
void MyOnPaint(HDC hdc, HWND hWnd) //in case WM_PAINT; DO IT MANY TIMES
{
    if (g_hBitmap)
    {
        double SkalaX = 1.0, SkalaY = 1.0; //scale
        if (gRozXObrazu > gRozXOkna || gRozYObrazu > gRozYOkna || //too big picture, więc zmniejsz; 
           (gRozXObrazu < gRozXOkna && gRozYObrazu < gRozYOkna)) //too small picture, można powiększyć 
        {
            SkalaX = (double)gRozXOkna / (double)gRozXObrazu; //np. 0.7 dla zmniejszania; FOR DECREASE
            SkalaY = (double)gRozYOkna / (double)gRozYObrazu; //np. 1.7 dla powiększania; FOR INCREASE
            if (SkalaY < SkalaX) SkalaX = SkalaY; //ZAWSZE wybierz większe skalowanie, czyli mniejszą wartość i utaw w SkalaX
        }

    if (ShowBitmapStretch(hdc, g_hBitmap, gRozXObrazu, gRozYObrazu, (int)(gRozXObrazu*SkalaX), (int)(gRozYObrazu*SkalaX), 0, 0, msg) < 0) return; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-01T19:07:13.210

我进行了一些研究，但无法找到一种使用 GDI/GDI+ 更快地渲染图像的方法

```
Graphics.DrawImage/DrawImageUnscaled 
```

同时也很简单。

直到我发现

```
ImageList.Draw(GFX,Point,Index) 
```

是的，它真的非常快速和简单。

# c# - 让我的 ASP.NET 网站与 Firefox 兼容？

> ID：264729
> 
> 赞同：1
> 
> 时间：2008-11-05T09:57:32.357
> 
> 标签：c#, asp.net, vb.net, firefox

我有一个 ASP.net 网站 ( [http://www.erate.co.za](http://www.erate.co.za) ) 2.0 版。当有人在 Firefox 中打开我的网站时，一切看起来都不同了。

为什么会这样，我怎样才能使它兼容？

请帮忙！

艾蒂安

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T10:04:50.580

这些问题与 ASP.NET / C# 没有任何关系。

它们与您对网页设计 / HTML / CSS 的理解以及如何制作跨浏览器兼容的 UI 有关。

我建议您查看[http://www.w3schools.com/](http://www.w3schools.com/)以获取有关良好网页设计实践的一些信息。

您需要解决的 Source 的一些明显问题是

*   没有通用的 CSS 样式表
*   样式被内联应用于许多元素
*   使用长字符串“         ” 对齐文本

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T10:01:02.863

只要您只是生成 HTML，底层服务器技术就不会对您的网站外观产生任何影响。您需要做的是确保您的 HTML 和 CSS 在所有浏览器中都按预期工作。一个好的开始方法是确保您只输出符合标准的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T20:32:53.680

手头的问题是您使用的样式在 Firefox 中不起作用，例如 cursor:hand; 与光标：指针；两者都在 IE 中工作，但只有指针在 Firefox 中工作。一个快速的建议是通过位于以下位置的 w3c 验证器运行结果页面：http: [//validator.w3.org/](http://validator.w3.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T10:15:42.740

就其本身而言，ASP.NET 生成普通的 HTML/Javascript，因此该技术没有任何问题。

专注于html，尽量接近[w3c标准](http://validator.w3.org/)，应该会有很大帮助。

[Firebug](http://getfirebug.com/)是一个令人难以置信的 Firefox 网络开发扩展，它也可以帮助您调试 CSS。

这可能是一项痛苦的任务，特别是如果您的网站又旧又大。祝你好运！

# resources - 如何管理应用资源？

> ID：264734
> 
> 赞同：4
> 
> 时间：2008-11-05T10:00:08.670
> 
> 标签：resources, web-applications

我们正在开发一个支持 3 种语言的 Web 应用程序。

有这些键值对来翻译一切。目前，我们为此使用 Excel（键、德语、法语、英语）。但这并不好用……如果有超过 1 个人编辑这个文件，你就没有机会自动合并不同的文件。

是否有可以处理这项工作的好（免费）工具？

- - 附加信息 - -

（这是一个 STRUTS 应用程序）但问题是一般如何管理这些类型的信息（或者至少以一种方便的方式，它还支持多个用户编辑这个单个文件（“可*合并*”文件类型））

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T10:41:34.937

为什么不使用[gettext](http://www.gnu.org/software/gettext/)并管理单独的 .po 文件？请参阅该[博客条目](http://mel.melaxis.com/devblog/2005/08/06/localizing-php-web-sites-using-gettext/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T10:02:00.600

如果您可以以纯文本形式存储此信息，那么您将能够使用诸如 subversion 之类的版本控制系统来帮助您合并更改。颠覆是免费的。

颠覆的免费指南（“红皮书”）很好地解释了这种合并是如何工作的。

[http://svnbook.red-bean.com/en/1.5/svn.basic.vsn-models.html#svn.basic.vsn-models.copy-merge](http://svnbook.red-bean.com/en/1.5/svn.basic.vsn-models.html#svn.basic.vsn-models.copy-merge)

编辑：另一个想法——如果你真的想继续使用电子表格——谷歌文档支持同时编辑电子表格。您可以导入现有电子表格并免费获得多用户合并愿望，而对您的工作方式几乎没有改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T10:22:22.947

好问题。有一些“最佳实践”取决于您实际编写的代码（java、ms-windows c#）。

我通过使用SQL db而不是excel文件解决了这个问题（但我认为必须有更好的方法），并为VS（VB6，........，...，emacs）编写了一个插件能够将新密钥插入数据库，而无需使用版本控制进行往返。键是他们认为对标签的最佳猜测的开发人员名称。(key => save, sv => "spara", no => "", en => "save")。

然后可以将这个 db 作为模块、类、obj、txt 生成到适当的代码（平台），并且可以根据 ide 进行访问，因此在 c# 中，bt,label = corelang.save;

然后其他人可以完成所有语言的工作，然后我们只需更新数据库并重新运行生成到平台资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T10:42:05.090

经过多年的本地化工作，包括索尼等大公司的本地化。我只能说“标准”是 Excel :)

周围有很多好主意，可能还有很多更好的方法，但在现实生活中，excel 似乎是最好的/具有成本效益的解决方案，不需要培训或制作复杂的新工具即可完成工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-03T22:05:51.403

发现 Intellij Idea（至少在版本 7 和 8 中）有一个应用程序资源编辑器。但它根本不是免费的。并且它不适用于具有超过 1.000 个键的更大资源文件。

另一个不错的选择是使用谷歌的电子表格......对于那些不知道它的人 - 它就像一个“在线 Excell 网络应用程序”。它可以处理来自多个用户的并发访问。耶！但可悲的是，它来自谷歌。这使得它无法用于商业项目。

所以，还在找...

欢呼，法力

# c# - Resharper region options on Alt+Insert

> ID：264741
> 
> 赞同：4
> 
> 时间：2008-11-05T10:04:03.543
> 
> 标签：c#, resharper

How can I set Resharper to wrap, say, the generated equality members with regions when selected from the Alt+Insert menu?

Thanks

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T22:19:25.997

对话框底部通常有一个“在区域中换行”选项，但不是针对此选项。我会将其作为请求提交给 JetBrains。目前，您必须选择生成的方法并使用 ctrl->E,U,5 （环绕快捷方式）来获得预期的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T10:27:18.380

it doesn't really answer your question, but I just can't resist to try to convince you NOT to use regions. Why would you want to do it? The obvious disadvantages of regions are:

*   they don't compile, so you can never know if the name of the region really describes what is inside
*   regions are often used to hide rubbish code. The thinking here is: you can't see the rubbish bits, so it is as if they didn't exist. But guess what, they still exist...
*   regions are just textual, they don't have any semantic meaning. That means that the code inside the region can change the state of another region - which doesn't help to figure out what is happening in the class at all
*   if you structure your code correctly, it should be obvious what it is doing anyway

I believe using regions makes sense pretty much only for automatically generated parts, e.g. WinForms designer stuff. In most (all?) other cases it is much better to refactor the code, extract some extra classes or methods, etc. to make it clear.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-07T22:25:52.190

您可以突出显示您感兴趣的文本，并使用 CTRL + k 的 Visual Studio 快捷键，从菜单中选择#region。

# asp.net-mvc - How to structure VB.NET Windows Forms applications

> ID：264744
> 
> 赞同：14
> 
> 时间：2008-11-05T10:05:03.090
> 
> 标签：asp.net-mvc, vb.net, winforms

What is the best way to structure a VB.NET [Windows Forms](http://en.wikipedia.org/wiki/Windows_Forms) application so that code can be reused and the application can be extended easily?

I used to create lots of new forms. This lead to lots of repeated code and forms which did similar things.

Now, for forms which do similar jobs, such as view/edit/delete items from a specific database table, I create a form with the required controls, have the form create an instance of a class with parameters such as a collection of the controls and a string containing the database table name. Then the individual controls call functions of the class.

Advanced forms will inherit and extend this basic form class.

1.  Has there already been work done in this area?
2.  Are there books / articles available which discuss the options available on this topic?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T14:12:37.333

我在这种[被动屏幕](http://www.martinfowler.com/eaaDev/PassiveScreen.html)模式上取得了巨大的成功。

在我看来，传统 MVC 架构的一个大问题是人们在表单类中塞进了太多东西。这增加了您必须执行的手动测试量。

编译后您可以进行的自动化测试越多，您在办公桌上发现的错误就越多。在复杂的应用程序中，即使是很小的更改也会经常发生副作用。

解决这个问题的诀窍是制作一个表单程序集（或 EXE）引用的控制器程序集。每个表单在程序集中都有一个对应的类。单击一个按钮将调用`ThisForm.ThisButton(<args>)`该按钮，然后将触发框架中较低的对象。每个表单都实现了一个接口，因此，如果控制器类需要来自表单的附加信息，它就有一个接口来检索它。

然后对于您的[单元测试](http://en.wikipedia.org/wiki/Unit_testing)，您通过实现虚拟类来触发事件并将信息提供给控制器类来模拟执行复杂操作的操作员。控制器类没有任何不同，因为虚拟类实现了所有预期的接口。

有一个重要的例外，那就是琐碎的对话。对于有几个复选框的对话框，我觉得这个组织有点矫枉过正。我经常使用[命令模式](http://en.wikipedia.org/wiki/Command_Pattern)。因此，在我定义 Command 对象的程序集中，我放置了与该命令关联的 SIMPLE 对话框。对话有多简单才能获得这种治疗取决于您。

我喜欢按如下方式构建我的应用程序。

*   实用程序 - 这是一个包含我一直使用的东西的程序集 - 数学函数、文件函数等。

*   对象 - 这包含我用于此应用程序的特定对象。

*   UIFramework - 这定义了所有的表单和控制器接口。

*   命令 - 这包含所有操纵我的应用程序对象的命令对象。

*   UI - 实现控制器接口的对象

*   EXE - 实现表单接口并调用控制器对象的表单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T15:00:29.437

您可能想查看 Rocky Lhotka 流行的[CSLA 框架](http://www.lhotka.net/cslanet/)。它提供了一种非常结构化的方式来实现业务对象，因此您可以将非 UI 代码排除在表单之外。除了分离您的业务逻辑之外，它还提供内置的 n 级撤消、验证、安全性、数据绑定支持等。

最常针对 CSLA 的一个抱怨是它使测试驱动开发变得困难，因此这可能也是需要考虑的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-22T14:44:49.030

有很大帮助的是[用户控件](http://msdn.microsoft.com/en-us/library/aa302342.aspx)的使用。使用用户控件，您可以以不同的形式重复使用相同的 UI。此外，您可以在一个表单上拥有多个用户控件，因此，如果您的表单带有一个包含 5 个选项卡的选项卡控件，则每个选项卡的内容都可以是一个用户控件，而不是将数百个控件全部混合在一个表单中，每个用户控件都有自己的控件和验证逻辑，最终表单中只有六个控件：tabcontrol 和 5 个用户控件。

这无助于将 UI 代码与应用程序逻辑分开，但它使您能够拥有小型的结构化实体，而不是具有数千行代码的表单。

# c# - BindingFlags.IgnoreCase 不适用于 Type.GetProperty()？

> ID：264745
> 
> 赞同：226
> 
> 时间：2008-11-05T10:05:10.533
> 
> 标签：c#, reflection, getproperty, bindingflags

想象以下

类型 T 有一个字段 Company。执行以下方法时，它可以完美运行：

```
Type t = typeof(T);
t.GetProperty("Company") 
```

虽然下面的电话我得到了空

```
Type t = typeof(T);
t.GetProperty("company", BindingFlags.IgnoreCase) 
```

有人有想法吗？

* * *

## 回答 #1

> 赞同：466
> 
> 时间：2008-11-05T10:09:35.827

您已经覆盖了默认查找标志，如果您指定新标志，则需要提供所有信息以便可以找到该属性。例如：`BindingFlags.IgnoreCase | BindingFlags.Public | BindingFlags.Instance`

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2008-11-05T10:07:38.420

您需要添加`BindingFlags.Public | BindingFlags.Instance`

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-09-22T16:19:02.917

谢谢，这真的帮助了我今天的紧要关头。我保存了审计信息，但属性名称的大小写不正确。（审计是内置在数据层中的。）无论如何，我不得不添加 IgnoreCase 作为绑定标志，但它仍然无法正常工作，直到我的同事找到了这个答案。结果函数：

```
public static void SetProperty(Object R, string propertyName, object value)
{
    Type type = R.GetType();
    object result;
    result = type.InvokeMember(
        propertyName, 
        BindingFlags.SetProperty | 
        BindingFlags.IgnoreCase | 
        BindingFlags.Public | 
        BindingFlags.Instance, 
        null, 
        R, 
        new object[] { value });
} 
```

这是我称之为 DotMagic 的类的一部分。

# c# - 找出方法可能在 C# 中抛出的异常

> ID：264747
> 
> 赞同：53
> 
> 时间：2008-11-05T10:07:08.890
> 
> 标签：c#, .net, exception

有没有办法找出 .NET 代码中的任何方法可能引发的异常？理想情况下，我想看看可能会抛出什么并选择我想要处理的那些。我想我想要你从 java 中的 throws 子句中获得的信息。

情况是我正在对来自网络的 xml 文档进行 linq 查询，并想知道可能出了什么问题。我可以打开反射器中的组件并查看，但我认为可能有更简单的方法。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-05T10:10:17.353

.NET 没有像 java 那样的强制（“检查”）异常。如果开发人员添加了一个块，智能感知*可能会*显示此信息`/// <exception.../>`- 但最终可能会发生比您预期的更多的异常（`OutOfMemoryException`, `ThreadAbortException`,`TypeLoadException`等都可能发生相当不可预测的情况）。

一般来说，您应该了解哪些事情可能会出错，以及哪些事情您实际上可以做一些有用的事情。在大多数情况下，正确的行为是让异常冒泡（只需运行任何“finally”代码来释放资源）。

[Eric Lippert 在这里](http://blogs.msdn.com/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)有一个关于这个主题的好博客。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-05T13:45:36.297

我认为[异常猎人](http://www.red-gate.com/products/Exception_Hunter/index.htm)可以提供这些信息，但是它需要花钱......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T19:39:36.323

在 StackOverflow 上阅读了另一篇关于此的文章后，我在其他答案的基础上编写了一个工具来执行此操作，您可以在此处从 GitHub 获取源代码：

[异常反射器](https://github.com/stevesheldon/ExceptionReflector)

你也可以在这里阅读更多：

[http://steves-rv-travels.com/archives/167](http://steves-rv-travels.com/archives/167)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T10:11:21.080

只要您使用 BCL 类，它们都已完全记录在案，因此 Intellisense 会显示方法可以抛出的任何异常。除此之外（和阅读文档），我认为没有办法。

# java - 为什么 JAX-WS 调用返回的地图总是空的？

> ID：264756
> 
> 赞同：3
> 
> 时间：2008-11-05T10:10:48.243
> 
> 标签：java, web-services, map, jax-ws

我的 Web 服务方法返回一个`Page`对象，其中包括以下方法：

```
public Map<String,String[]> getParameters() { ... }
public setParameters(Map<String,String[]> parameters) { ... } 
```

在客户端，JAX-WS 生成的`getParameters()`方法返回一个`Parameters`对象，该对象提供一个`getEntry()`返回`List<Entry>`. 但是，此列表始终为空。原因是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T10:11:12.890

您必须在 setter 和 getter 中使用具体类型而不是接口：

```
public HashMap<String,String[]> getParameters() { ... }
public setParameters(HashMap<String,String[]> parameters) { ... } 
```

然后，一切都按预期工作。

# c++ - 使用 msbuild 时抑制 C++“生成后事件”

> ID：264763
> 
> 赞同：1
> 
> 时间：2008-11-05T10:11:52.810
> 
> 标签：c++, msbuild

我正在使用 msbuild 构建一个 C++ 项目，并且我想抑制“构建后事件”。我尝试了以下属性但没有成功：

```
/property:PostBuildEvent=
/property:VCPostBuildEventTool= 
```

两者都不会产生任何影响，并且仍会执行构建后事件。

有谁知道如何使用 msbuild 抑制这些（以及可能的其他）事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-28T21:03:51.503

我只是想出了如何做到这一点。涉及2个步骤：

首先，如果您尚未使用批处理文件启动 msbuild 进程，请创建一个调用 msbuild 进程的批处理文件。然后在调用 msbuild 进程之前在批处理文件中添加一个变量。像这样的东西：

```
set ISFULLBUILD=True
msbuild TFSBuild.proj >> BuildOutput.txt 
```

然后，您需要修改您的构建后事件以仅在未设置变量或具有错误值的情况下执行某些操作：

```
IF NOT '%ISFULLBUILD%'=='True' copy /y $(TargetFileName) "..\..\..\..\..\..\Binaries\$(ConfigurationName)\" 
```

在这种情况下 - TargetFileName (Whatever.dll) 只会在您从 Visual Studio 构建时被复制。但是，当您使用新的批处理文件构建时 - 它不会在 IF 语句之后执行命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T11:07:35.477

您是否尝试将构建事件设置为空白以外的其他内容？如果你用多余的东西覆盖它，比如“dir”或其他东西，它是否仍然执行原始的构建后步骤？

这不是最优雅的解决方案，但它可能会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T13:27:42.293

Ack，看起来 msbuild 实际上调用了不那么灵活的 vcbuild，所以我想我被卡住了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T12:21:29.990

如果您能够修改构建后事件，则可以使用环境变量来执行此操作，例如`SKIP_POST_BUILD_EVENTS`. 然后，您可以在调用之前设置该环境变量`msbuild`，并在执行任何代码之前检查该变量是否存在于构建后事件中。

# java - 如何获取 Websphere 6.1 端口号

> ID：264764
> 
> 赞同：1
> 
> 时间：2008-11-05T10:12:15.167
> 
> 标签：java, websphere

我目前正在开发一个 WebSphere 6.1 Web 项目。

在我的 java 代码中，如何获取当前正在运行的应用程序端口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T13:04:36.537

servlet API 在 HttpServletRequest 中为您提供本地端口。

```
protected void doGet(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
    PrintWriter writer = response.getWriter();
    writer.write("" + request.getLocalPort());
    writer.close();
} 
```

端口在节点的*serverindex.xml*中定义（例如 [WAS]/profiles/AppSrv01/config/cells/localhostNode01Cell/nodes/localhostNode01/serverindex.xml）。

```
<specialEndpoints xmi:id="NamedEndPoint_1214751102556" endPointName="WC_defaulthost">
  <endPoint xmi:id="EndPoint_1214751102556" host="*" port="9080"/> 
```

我不确定 WAS JMX 支持是否会公开此信息 - 您必须查看文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-19T09:58:17.393

如果您使用 RAD，您可以从 IDE 运行管理控制台，然后发现 WAS 使用的所有端口

[http://pic.dhe.ibm.com/infocenter/radhelp/v9/index.jsp?topic=%2Fcom.ibm.sca.tools.doc%2Fsamples%2Ftopics%2Fwas_ports.html](http://pic.dhe.ibm.com/infocenter/radhelp/v9/index.jsp?topic=%2Fcom.ibm.sca.tools.doc%2Fsamples%2Ftopics%2Fwas_ports.html) ![在此处输入图像描述](https://i.stack.imgur.com/097kP.png)

# javascript - 隐藏 DIV 在 Opera 中无法正常工作

> ID：264766
> 
> 赞同：2
> 
> 时间：2008-11-05T10:15:00.573
> 
> 标签：javascript, opera

我的代码在 IE8、Firefox 和 Safari 中运行良好。但它在 Opera 中无法正常工作。发生的情况是 DIV 被隐藏，但 DIV 占用的空间仍然出现在我的网页中。

```
<div  style=" z-index:-1;height :380; width:760; position:relative; text-align:center" id="new-add">
    <object id="banner-flash" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 
    codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" 
        width="769" height="382" top="0"> 
    <param name="movie"  value="exp.swf" /> 
    <param name="quality" value="high" /> 
    <param name="bgcolor" value="#ffffff" /> 
    <param name="wmode" value="transparent" />
    <embed src="exp.swf" wmode="transparent" quality="high" bgcolor="#ffffff" width="780" height="382"
 name="mymoviename" align="" type="application/x-shockwave-flash" 
    pluginspage="http://www.macromedia.com/go/getflashplayer"> 
    </embed> 
    </object> 
</div>

<div  id="fechar-link" style=" font-family: Verdana,Arial,Helvetica,sans-serif; font-style: normal; 
    font-variant: normal; font-weight: normal; font-size: 10pt; line-height: normal; font-size-adjust: none; 
    font-stretch: normal; text-decoration: none; text-align:center" >
    <a href="#" onclick="
        document.getElementById('new-add').style.height =0;
        document.getElementById('banner-flash').style.height =0;
        document.getElementById('fechar-link').style.height  = 0;

        document.getElementById('new-add').style.visibility ='hidden';
        document.getElementById('banner-flash').style.visibility ='hidden';
        document.getElementById('fechar-link').style.visibility ='hidden';  "  >Close</a>
        </div> 
```

我需要做什么，让 DIV 占用的空间消失？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T10:21:46.787

您可以尝试 style.display 属性：

> 隐藏
> 
> document.getElementById('YourElem').style.display = 'none';
> 
> 显示
> 
> document.getElementById('YourElem').style.display = '';

**编辑：**在此答案中将 PorneL 评论纳入帐户

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T10:19:44.480

我不知道它是否会解决您的问题，但您可以尝试使用：

```
document.getElementById("xxx").display = "none"; 
```

代替

```
document.getElementById("xxx").style.visibility = "hidden"; 
```

# file - 文件路径控制

> ID：264771
> 
> 赞同：4
> 
> 时间：2008-11-05T10:18:31.440
> 
> 标签：file, vba, path, controls

如何在 VBA 前面板中放置文件路径控件？我希望用户能够选择浏览按钮并选择文件路径，而不是到处放置对话框。我需要用户选择三个或更多文件路径。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T10:42:19.700

重新阅读您的 Q 后，您想避开对话框！哦，好吧，我想说

> 我可以发布关于在 VBA 上使用 MSDIAG 的 hack，它解释了如何修补注册表以使其在 VBA 下使用，而无需安装其他 MS-VB 产品......但我宁愿让你谷歌那个......你可以当然明白为什么。

但是你不想要对话框......你想要控件和按钮：使用***列表框***！要填充您的列表框，请使用**Dir**命令（使用列表框的**additem**方法）。实现这一目标的两个阶段：

*   首先获取目录（并在将其添加到列表框之前添加“->”或其他前缀，以便用户了解这不是文件）；
*   然后获取文件名（您可以使用 Dir 的参数按扩展名过滤，就像在 DOS 中一样）。

最后，在列表框的 OnClick 和 OnDoubleClick 下，您必须解释列表框的默认属性（Item），检查“->”并使用 ChDir 更改目录并重新填充，否则您将选择文件。

写起来比代码复杂得多……相信我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T10:41:34.157

您是指 Microsoft Office 的 VBA 还是一般的 VBA？

在办公室，`Application.FileDialog(msoFileDialogOpen)`.

否则，请查看 Win32 API 函数`SHBrowseForFolder`（在 shell32.dll 中）。`Declare Function`您可以使用关键字将其导入 VBA 以供使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T12:46:40.300

没有直接的 VBA 功能。您可以决定将表单（Access 表单或通用 microsoft 表单）与 2 个控件组合：(1) 文本框 (2) 浏览按钮（最终将使用 fileDialog 命令或 windows API）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T21:32:03.703

也许从 Microsoft MVPs 站点浏览文件夹 API 将适合：

[http://www.mvps.org/access/api/api0002.htm](http://www.mvps.org/access/api/api0002.htm)

它使用 fwzgekg 提到的 SHBrowseForFolder，并且不返回文件对话框，它返回可浏览的文件夹列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-22T15:08:32.353

这是你想要的吗？

```
FilePath = Application.GetOpenFilename 
```

# c# - 计算 DataGridViewImageColumn 中唯一图像出现的次数

> ID：264782
> 
> 赞同：0
> 
> 时间：2008-11-05T10:22:54.677
> 
> 标签：c#, winforms, datagridview

在绑定到 DataView 的 DataGridView 中，列中的单元格将包含 ImageList 中的两个图像之一（例如绿色“在线”图像或红色“离线”图像），如何计算每个图像的出现次数遍历 DataGridView 的行时？

DataGridViewImageCell 的 Value 和 FormattedValue 属性返回不同的引用，即使基础 DataTable 中的条目是通过引用 ImageList 中的相同 Image 创建的。

因此，与其计算 4 次“在线”和 6 次“离线”，我得到了 10 次据称不同的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T11:28:26.870

鉴于描述，我可以建议的最好方法是手动跟踪单元格的 .Tag 中的图像键/索引，然后在 .Tag 上运行您的不同计数。或者，如果您在列表/集合中也有数据，请计算来自原始来源的数据。

[更新以下回复] 由于数据是数据绑定的，因此您应该能够迭代 的`.Rows`，`DataGridView`获取`.DataBoundItem`每个的。然后对于每个底层对象，您应该能够使用以下方法获取实际属性值`TypeDescriptor`：

```
 string propName = col.DataPropertyName;
        // could also be a dictionary/hashset etc
        // could be typed if you know the type
        List<object> values = new List<object>();
        foreach(DataGridViewRow row in dgv.Rows)
        {
            object obj = row.DataBoundItem;
            // could be typed (via cast) if you know the type
            object val = TypeDescriptor.GetProperties(obj)[propName].GetValue(obj);
            if (!values.Contains(val))
            {
                values.Add(val);
            }
        } 
```

那有什么帮助吗？

# mysql - mysql插入竞争条件

> ID：264807
> 
> 赞同：12
> 
> 时间：2008-11-05T10:40:51.100
> 
> 标签：mysql, locking, transactions, race-condition

如何在 MySQL 中停止竞争条件？手头的问题是由一个简单的算法引起的：

1.  从表中选择一行
2.  如果不存在，则插入

然后要么你得到一个重复的行，要么你通过唯一/主键阻止它，一个错误。

现在通常我认为事务在这里有帮助，但由于该行不存在，事务实际上并没有帮助（或者我错过了什么？）。

LOCK TABLE 听起来有点矫枉过正，尤其是在表每秒更新多次的情况下。

我能想到的唯一其他解决方案是 GET_LOCK() 用于每个不同的 id，但没有更好的方法吗？这里也没有可扩展性问题吗？而且，对每个表都这样做听起来有点不自然，因为对我来说这听起来像是高并发数据库中非常常见的问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-05T10:44:24.557

你想要的是[LOCK TABLES](http://dev.mysql.com/doc/refman/5.0/en/lock-tables.html)

或者如果这看起来过分，那么[INSERT IGNORE](http://dev.mysql.com/doc/refman/5.0/en/insert.html)会检查该行是否已实际插入。

> 如果使用 IGNORE 关键字，则执行 INSERT 语句时发生的错误将被视为警告。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T10:45:23.133

在我看来，您的 id 列上应该有一个唯一索引，因此重复插入会触发错误，而不是再次被盲目接受。

这可以通过将 id 定义为主键或单独使用唯一索引来完成。

我认为你需要问的第一个问题是为什么你有很多线程在做同样的工作？为什么他们必须插入完全相同的行？

在得到回答之后，我认为只是忽略错误将是最高效的解决方案，但是测量这两种方法（GET_LOCK v/s 忽略错误）并自己看看。

我知道没有其他方法。为什么要避免错误？当发生另一种类型的错误时，您仍然需要编写代码。

正如 staticsan 所说，事务确实有帮助，但正如它们通常隐含的那样，如果两个插入由不同的线程运行，它们都将在隐含事务中并看到数据库的一致视图。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-15T21:40:39.587

锁定整个表确实是矫枉过正。为了获得您想要的效果，您需要一些文献中称为“谓词锁”的东西。除了发表在发表学术研究的论文上之外，没有人见过这些。下一个最好的事情是锁定数据的“访问路径”（在某些 DBMS 中：“页面锁定”）。

一些非 SQL 系统允许您在一个语句中同时执行 (1) 和 (2)，这或多或少意味着您的操作系统在 (1) 和 (2) 之间暂停执行线程所产生的潜在竞争条件完全是被淘汰。

尽管如此，在没有谓词锁的情况下，这样的系统仍然需要求助于某种锁定方案，并且它所采用的锁的“粒度”（/“范围”）越精细，并发性就越好。

（总结一下：一些 DBMS——尤其是那些你不需要付费的——确实没有提供比“整个表”更精细的锁定粒度。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T10:47:01.557

在技​​术层面上，事务在这里会有所帮助，因为在您提交事务之前，其他线程不会看到新行。

但在实践中，这并*不能解决*问题——它只会*移动*它。您的应用程序现在需要检查提交是否失败并决定要做什么。我通常会让它回滚你所做的，并重新启动事务，因为现在该行将可见。这就是基于事务的程序员应该如何工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-21T07:31:17.340

我遇到了同样的问题并在网上搜索了一会儿:)

最后，我提出了类似于[在共享（临时）目录中创建文件系统对象以安全打开临时文件的方法的解决方案：](http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/avoid-race.html)

```
$exists = $success = false;
do{
 $exists = check();// select a row in the table 
 if (!$exists)
  $success = create_record();
  if ($success){
   $exists = true;
  }else if ($success != ERROR_DUP_ROW){
    log_error("failed to create row not 'coz DUP_ROW!");
    break;
  }else{
    //probably other process has already created the record,
    //so try check again if exists
  }
}while(!$exists) 
```

不要害怕*忙循环*——通常它会执行一次或两次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-14T06:18:01.937

通过在表上放置唯一索引，您可以非常简单地防止重复行。这与 LOCKS 或 TRANSACTIONS 无关。

您是否关心插入是否因为重复而失败？如果失败需要通知吗？还是插入行才是最重要的，谁或多少重复插入失败并不重要？

如果你不在乎，那么你只需要`INSERT IGNORE`. 根本不需要考虑事务或表锁。

InnoDB 自动具有行级锁定，但这仅适用于更新和删除。你是对的，它不适用于插入。您无法锁定尚不存在的内容！

您可以显式地`LOCK`显示整个表。但是，如果您的目的是防止重复，那么您做错了。同样，使用唯一索引。

如果要进行一组更改并且您想要一个全有或全无的结果（或者甚至是一个更大的全有或全无结果中的一组全有或全无结果），则使用事务和保存点。然后使用`ROLLBACK`or`ROLLBACK TO SAVEPOINT *savepoint_name*`撤消更改，包括删除、更新**和**插入。

`LOCK`表不是事务的替代品，但它是不支持事务的 MyISAM 表的唯一选择。如果行级锁定还不够，您也可以将它与 InnoDB 表一起使用。有关使用带有锁表语句的事务的更多信息，请参阅[此页面](http://dev.mysql.com/doc/refman/5.6/en/lock-tables-and-transactions.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-16T20:33:16.723

我有一个类似的问题。我有一张表，在大多数情况下应该有一个唯一的 ticket_id 值，但在某些情况下我会有重复；不是最好的设计，但它就是这样。

1.  用户 A 检查票是否已预订，但未预订
2.  用户 B 检查票是否已预订，不是
3.  用户 B 将“保留”记录插入到该票证的表中
4.  用户 A 将“保留”记录插入到该票证的表中
5.  用户 B 检查重复？是的，我的记录更新了吗？是的，离开它
6.  用户 A 检查重复？是的，我的记录更新了吗？不，删除它

用户 B 已预订票，用户 A 报告该票已被其他人拿走。

在我的例子中，关键是你需要一个决胜局，在我的例子中，它是行上的自动增量 ID。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-05T13:38:38.590

如果插入忽略不适合您接受的答案中的建议，那么根据您问题中的要求：

> 1]从表
> 2中选择一行]如果它不存在，插入它

另一种可能的方法是在插入 sql 语句中添加条件，例如：

```
INSERT INTO table_listnames (name, address, tele)
SELECT * FROM (SELECT 'Rupert', 'Somewhere', '022') AS tmp
WHERE NOT EXISTS (
    SELECT name FROM table_listnames WHERE name = 'Rupert'
) LIMIT 1; 
```

参考： [https ://stackoverflow.com/a/3164741/179744](https://stackoverflow.com/a/3164741/179744)

# asp.net - 如何在 ASP.NET 运行时更改 FormsCookieName

> ID：264813
> 
> 赞同：5
> 
> 时间：2008-11-05T10:45:26.143
> 
> 标签：asp.net, cookies, forms-authentication

我们希望每个应用程序实例的 FormsCookiePath 的 FormsCookieName 发生变化。我们有一个应用程序，它在 1 个服务器/域名上有多个实例。因此，我们只能同时在 1 个应用程序中工作，因为 cookie 会相互覆盖。顺便说一句，会话也是如此。

有没有办法动态地改变这个名称，例如在 Global.asax Application_Start 中？这将很有用，因为我们在每个应用程序中都保留了一个许可证名称，该名称可用作 CookieName 的基础。

我们已经使用 Web.config 和额外文件来覆盖外部文件中的 Web.config 值，使用：`<appSettings file="Web.AppSettings.Config">`

但这需要手动操作，这些操作可能会被遗忘并且是多余的，因为可以从数据库中检索设置。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-04-09T17:52:26.233

我有类似的情况，我做了以下。在 Application_Start 中，我检查了我的 cookie 名称是否需要更改。这将在我对所有应用程序具有相同 web.config 的所有应用程序进行新部署之后发生。

```
 protected void Application_Start(object sender, EventArgs e)
{
  // determine unique cookie name per application
  string cookieName = ...
  // Get the web.config forms settings
  Configuration c = WebConfigurationManager.OpenWebConfiguration("~");
  AuthenticationSection auth = c.GetSection("system.web/authentication") 
        as AuthenticationSection;
  // See if we have mismatch in web.config or in Forms cookiename
  if (auth != null && auth.Forms != null && 
       (auth.Forms.Name != cookieName 
          || FormsAuthentication.FormsCookieName != cookieName
       )
     )
  {
     // Assign value in web.config for future restarts
     auth.Forms.Name = cookieName;
     // would be nice if this restarted the app, but it doesn't appear to
     c.Save();
     // This seems to restart the app
     System.Web.HttpRuntime.UnloadAppDomain();
  }
  ...
} 
```

web.config 在应用程序启动时被修改，然后 Web 应用程序重新启动。下次启动 Web 应用程序时，cookie 名称会同步，并且会跳过重置代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-05-12T09:52:30.627

几天来，我一直在与 Cookies 作斗争。这是一次很棒的学习经历。

**所以想分享一下我发现和发现的可能方式：**有几个HACKs可以修改Forms Authentication Cookie name：

1.  您可以在 Global.asax 的 Application_Start 事件中的 Web.Config 文件的 Authenticaiton 部分下自动修改 cookie 名称。感谢罗恩分享[这个](https://stackoverflow.com/a/5606765/6324452)。但我不能保证其身份将用于运行应用程序域的用户是否有足够的权限来修改磁盘上的文件。因此我需要一个即兴的解决方案，所以我设计了以下方法。

2.  感谢 ILSpy 让我看到 FormsAuthentication 类的内部，非常感谢 Reflection 让我修改了一个类的私有字段。我使用以下代码在运行时使用以下一小段代码修改 cookie 名称，这就像一个魅力！

* * *

```
 protected void Application_Start(Object sender, EventArgs e)
    {
        // This will enforce that FormsAuthentication class is loaded from configuration settings for the application.
        FormsAuthentication.Initialize();

        // The new cookie name whatever you need can go here, I needed some value from my application setting to be prefixed so I used it.
        string newCookieName = string.Format("{0}.ASPXAUTH", ConfigurationManager.AppSettings["SomeSettingThatIsUniquetoSite"]);

        // Modifying underlying baking field that points to FormsAuthentication.FormsCookieName         
        Type type = typeof(FormsAuthentication);
        System.Reflection.FieldInfo field = type.GetField("_FormsName", System.Reflection.BindingFlags.NonPublic | System.Reflection.BindingFlags.Static);
        field.SetValue(null, newCookieName);
    } 
```

* * *

请求建议，漏洞，因为这是我在这个论坛上的第一个答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T16:48:20.997

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.formscookiename.aspx)，存储 cookie 名称的 FormsAuthentication.FormsCookieName 属性是只读属性。此属性必须从 web.config 中读取。

每个实例在 web.config 中都需要一个单独的名称。我建议在您现有的变更管理系统中包含身份验证 cookie 的名称。

# logging - Logging for JBoss 3.2.5 Java EE Client

> ID：264815
> 
> 赞同：3
> 
> 时间：2008-11-05T10:46:44.317
> 
> 标签：logging, jakarta-ee, jboss, client

I am trying to find out why a Java EE client (stand alone Java program that uses jbossall-client.jar) is failing to connect to a Java EE Server so it would be good to enable logging that occurs from within JBoss AS classes such as `org.jnp.interfaces.NamingContext` - presume there is a config file I can set up?

Just for info this is the actual exception that I am getting - hopefully logging would give a bit more info.

**Error**

```
javax.naming.CommunicationException: 
    Receive timed out [Root exception is java.net.SocketTimeoutException: 
        Receive timed out]
        at org.jnp.interfaces.NamingContext.discoverServer
            (NamingContext.java:1119) 
```

# c# - 来自函数的可变数量的结果

> ID：264817
> 
> 赞同：1
> 
> 时间：2008-11-05T10:47:52.503
> 
> 标签：c#

我在很多地方都有类似于以下的代码：

```
var dbParams = db.ReadParams(memberID, product, GetSubscriptionFields());
Debug.Assert(dbParams.Count == 4);

_memberCode = dbParams[0];
_password = dbParams[1];
_userName = dbParams[2];
_reasonCode = dbParams[3]; 
```

ReadParams() 返回一个字符串数组，字符串的数量取决于 GetSubscriptionFields() 函数。我可以在我的代码中直接使用 dbParams[]，但我发现为数组中的每个值赋予有意义的名称更有帮助。有没有一种方法可以直接获得所有结果，而无需通过数组？

我正在寻找类似的东西：

```
db.ReadParams(memberID, product, out _memberCode, out _password, out _userName, out _reasonCode); 
```

或者

```
Tuple<_memberCode, _password, _userName, _reasonCode> = db.ReadParams(memberID, product); 
```

当然，它必须是合法的 C# 代码:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T11:15:23.043

您正在使用高度面向对象的语言编写代码，那么为什么不使用对象呢？

```
Member m = db.ReadParams(memberID, product, GetSubscriptionFields()); 
```

在您使用的代码中

```
m.memberCode
m.password
m.username
m.reasonCode 
```

当然，您不必使这些值可公开访问，您可以使它们只能通过 setter/getter 方法访问，并且只有 getter，您可以避免它们在对象创建后被更改。

当然，对 db.ReadParams 的不同调用应该返回不同的对象，例如，您可以创建一个抽象基类并从它的 db.ReadParams 继承所有可能的结果。因此，您可能必须将 db.ReadParams 封装到另一种方法中，以找出要创建的正确类型的对象：

```
ReadParamsResult rpr = myDb.ReadParamsAsObject(memberID, product, GetSubscriptionFields());

// Verify that the expected result object has been returned
Debug.Assert(rpr is Member);

// Downcast
Member m = (Member)rpr; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T11:07:04.963

为什么不使用常量呢？

然后在你的代码中你可以有

```
dbParams[MEMBER_CODE]
dbParams[PASSWORD]
dbParams[USERNAME]
dbParams[REASON_CODE] 
```

在不改变方法工作方式的情况下满足您的有意义名称的目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T11:09:13.833

我认为您的元组想法非常好。你可以这样定义它：

```
public class Tuple<T1, T2, T3, T4>
{
    public T1 Field1 { get; set; }
    public T2 Field2 { get; set; }
    public T3 Field3 { get; set; }
    public T4 Field4 { get; set; }
} 
```

您可能想要定义其中的一些，具有两个和三个属性。不幸的是，它不能帮助您命名类的属性。确实没有办法做到这一点（至少在 C# 4.0 之前，您可以将动态类型与匿名类型一起使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T11:10:00.713

并不真地; 由于参数的数量不固定，因此实际上没有更好的方法。常规元组的问题是您仍在按位置工作 - 只是使用“.Value0”而不是“[0]”。并且匿名类型不能直接暴露在 API 中。

当然，您随后可以使用属性将值包装在您自己的类中，然后进行投影：

```
 return new Foo {MemberCode = arr[0], ...} 
```

（其中 Foo 是您的类，代表此结果的任何内容，具有命名的类型化属性）

或者，您可以将它们放入字典中，但这对调用者没有任何帮助，就像数组一样。

唯一的其他选择是*非常*蹩脚的东西，比如接受`Action<string>`你用来分配每个参数的参数数组。我将详细说明最后一个**只是为了好玩**- 我不建议你这样做：

```
static void Main()
{
    string name = "";
    int value = 0;
    Foo("whatever",
        x => { name = x; },
        x => { value = int.Parse(x); });    
}
// yucky; wash eyes after reading...
static void Foo(string query, params Action<string>[] actions)
{
    string[] results = Bar(query); // the actual query
    int len = actions.Length < results.Length ? actions.Length : results.Length;
    for (int i = 0; i < len; i++)
    {
        actions[i](results[i]);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T07:43:08.230

我也想出了这个......我最喜欢它，但这是个人喜好，我知道这绝对不是最干净的想法：

```
using System.Diagnostics;

public static class ArrayExtractor
{
  public static void Extract<T1>(this object[] array, out T1 value1)
      where T1 : class
  {
    Debug.Assert(array.Length >= 1);
    value1 = array[0] as T1;
  }

  public static void Extract<T1, T2>(this object[] array, out T1 value1, out T2 value2)
      where T1 : class
      where T2 : class
  {
    Debug.Assert(array.Length >= 2);
    value1 = array[0] as T1;
    value2 = array[1] as T2;
  }
} 
```

当然，我将这个类扩展到 10 或 15 个参数。

用法：

```
string fileName;
string contents;
ArrayExtractor.Extract(args, out fileName, out contents); 
```

甚至更好

```
args.Extract(out fileName, out contents); 
```

其中 args 当然是一个对象数组。

# css - 表格标题背景图像垂直平铺

> ID：264822
> 
> 赞同：1
> 
> 时间：2008-11-05T10:50:19.473
> 
> 标签：css

我有一个渐变图像作为表头（9x18pix）的背景。该图像通过选择器类调用。当 header 内容增长到 2 行（垂直高度增加）时，bg 图像垂直平铺，看起来很难看。如何在不平铺的情况下垂直拉伸 bg 图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T11:06:15.573

你不能拉伸它。好吧，如果没有一些讨厌的 CSS hack，那将不会在所有可用的浏览器中真正起作用。我不会使用它们（除非您的 HTML 代码仅针对单个浏览器，例如，如果它是供内部使用的页面并且正在使用的浏览器是已知的）。不过，你可以让它在一个方向重复。这是您在使用渐变时通常想要的。

```
background-repeat: repeat-x; 
```

这是一个示例图像：

![替代文字](https://i.stack.imgur.com/N6GUA.png)

这是使用它的 HTML 代码

```
<html>
<head><title>Gradient Test</title>
<style type="text/css">
    th {
        color:brown;
        background-image:url(http://img222.imageshack.us/img222/6586/fillhz2.png);
        background-repeat:repeat-x;
        margin: 0;
    }
</style>
</head>
<body>
    <table>
        <tr>
            <th>One line</th>
            <th>Three<br>lines<br>of text</th>
        </tr>
        <tr>
            <td>Data</td>
            <td>Data</td>
        </tr>
    </table>
</body>
</html> 
```

它会重复，但只在一个方向上。通常一个渐变可以在一个方向上安全地重复，不需要拉伸它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T11:47:37.110

您在这里遇到的问题是您的背景在重复，Mecki 的评论是正确的并且应该可以解决您的问题，除非您说明它应该以哪种方式重复，否则背景图像将始终重复，如果有的话。

这是所有不同 CSS 背景属性的链接，可能会对您有所帮助： [http ://www.w3schools.com/css/css_background.asp](http://www.w3schools.com/css/css_background.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T11:08:57.003

首先，我假设您使用 CSS 来放置此背景图像。您可能需要澄清答案的那部分。

我不相信有一个 css 函数可以用来拉伸背景图像。正如 Mecki 所说，您可以使用 background-repeat 水平平铺图像，但这不会处理超出原始平铺高度的标题。

处理这个问题的最简单方法就是让你的背景足够大以容纳几行或更多行。

因此，如果您将背景设置为 40 像素高或稍大一点，则不会在文件大小方面增加大量内容，但您的设计会更加灵活。

一般而言，就布局和图形而言，最好始终保持一定的灵活性，以应对浏览器的不一致和不同的用户需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T14:40:27.090

或者，您可以将容器的背景颜色设置为与渐变中的最后一行相同的颜色。这样渐变图像的末端将不可见。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T07:01:12.323

```
<html>
<head><title>Gradient Test</title>
<style type="text/css">
    th {
        color:brown;
        background-image:url(http://img222.imageshack.us/img222/6586/fillhz2.png);
        background-repeat:repeat;
        margin: 0;
    }
</style>
</head>
<body>
    <table>
        <tr>
            <th>One line</th>
            <th>Three<br>lines<br>of text</th>
        </tr>
        <tr>
            <td>Data</td>
            <td>Data</td>
        </tr>
    </table>
</body>
</html>
```

# .net - 属性“ID”的正确命名约定是什么：ID 或 Id？

> ID：264823
> 
> 赞同：24
> 
> 时间：2008-11-05T10:50:36.633
> 
> 标签：.net, naming-conventions, fxcop

非常简单的问题：当我有一个可持久对象时，它通常有一个名为 ID 的属性（用于抽象类）。

那么..是命名约定ID还是Id？

例如。

```
public int ID { get; set; } 
```

或者

```
public int Id { get; set; } 
```

干杯:)

PS。这是.NET顺便说一句。FXCop 配置将是一个奖励。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-05T11:01:22.370

我通常使用*Identifier*。如果我真的想保持简短（例如，作为较长标识符的一部分），我会使用 Id，除非它是参数或私有成员。

[.NET Framework 命名指南](http://msdn.microsoft.com/en-us/library/ms229043.aspx)这样说：

> 首字母缩略词是由术语或短语中单词的字母组成的单词。例如，HTML 是超文本标记语言的首字母缩写。仅当缩写词广为人知且易于理解时，才应在标识符中包含缩写词。首字母缩略词与缩写词的不同之处在于缩写词会缩短一个单词。例如，ID 是标识符的缩写。通常，库名称不应使用缩写。
> 
> 标识符中可以使用的两个缩写是 ID 和 OK。在 Pascal 大小写标识符中，它们应该显示为 Id 和 Ok。如果用作驼峰式标识符中的第一个单词，它们应该分别显示为 id 和 ok。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-05T11:00:28.063

无论你喜欢它是什么，只要保持一致。ID不是一个词，它是身份的缩写。如何写缩写是人们长期争论的话题。例如是吗

```
getResourceURL 
```

或者

```
getResourceUrl 
```

实际上两者都可以在不同的框架中使用。另一个流行的缩写。有类似问题的是UTF8。

保持一致很重要，否则人们总是必须为每种方法查找正确的大小写，如果每种方法都以不同的方式处理它。

我对此有自己的约定。如果缩写。位于名称的末尾，全部大写，如果在其他地方，则遵循骆驼符号规则。例如

```
getResourceURL
urlOfResource
compareUrlToString 
```

为什么？我喜欢缩写。要大写。大多数人希望 URL 或 UTF 大写。但是，如果在名字的中间，它会破坏骆驼符号的优势。骆驼记法的优点是您可以看到一个新单词的首字母大写。所以比较：

```
compareURLToString
compareUrlToString 
```

在第一种情况下，我没有立即看到 URL 是一个单词，而 To 是下一个单词。T 可能是 URL (URLT) 的一部分并且是不同的缩写，因此我将使用第二种形式。但是，如果它在末尾，它将不起作用，没有其他单词，因此我更喜欢大写形式。我在所有代码中都坚持这个约定。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-05T11:12:59.663

指导方针说“Id”。

幸运的是，.Net 的人很友好地给了我们“命名准则”而不是“命名规则”;)，所以基本上，如果你强烈认为违反准则规则确实比遵循它更有价值，那么一定要打破它，如果他们理解你的原因，没有人会追究你的责任（比如它提供了更多的可读性并强调了名称的含义）

在我的店里，我们使用“ID”，即使指南说“Id”，但没有人真的对此感到内疚。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-05T11:23:07.147

正如其他人指出的那样，根据 .NET 约定，Id 是正确的，但不知何故感觉不对，所以很多人使用 ID（并且仍然存在）。

我不知道你的字段的内容是什么（数字、字符串、guid），但如果你想跳过这个问题，你可以简单地为对象标识符使用另一个 .NET 约定：**名称**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T10:58:12.203

我们在内部使用 ID，因为在我看来，ID 就像心理学说话，但 FxCop 抱怨说，因为 ID 不是首字母缩写词，它是缩写（用于身份/标识符）。根据 FxCop 规则，只有两个字符长的首字母缩写词才允许全部大写。其他一切都应该是正确的情况。

我们在 ID 属性上放了一个 SuppressMessage 属性，大家都很高兴。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-23T16:12:59.297

“ID”是 FxCop 命名规则中硬编码的缩写之一，即使它们是其他单词的一部分，也总是被认为拼写错误。我发现覆盖它的唯一方法是将“ID”添加到 Acronyms as ()：

```
<Dictionary>
<Acronyms>
   <CasingExceptions>
        <Acronym>ID</Acronym>
  </CasingExceptions>
</Acronyms>
</Dictionary> 
```

它适用于 FxCop 1.36。PS 一般来说，我认为“Id”是一个更好的选择，但有时如果它是基于我们无法控制的 XML 文件（或 Web 服务）生成的，则无法更改名称

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-05T10:57:07.790

我更喜欢 ID，也与其他词（例如 CustomerID）结合使用，但严格来说，这违反了常规命名约定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-05T11:12:50.940

我们在这里将“Id”或其他首字母缩略词视为一个词，而“Id”是一个简单的词，因为在银行业务中我们确实得到了很多奇怪的字母组合。所以我们把它当作一个单词，只有第一个字母大写，这就是我们最终在我们的内部编码约定文件中被定义的方式。

但底线是：选择对开发人员团队和其他查看源代码并坚持使用的人来说更舒适的约定。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-07-15T15:59:30.970

[http://en.wiktionary.org/wiki/id#Abbreviation](http://en.wiktionary.org/wiki/id#Abbreviation)

为什么要打呢？

# java - 获取有关 Java 进程终止的通知

> ID：264825
> 
> 赞同：8
> 
> 时间：2008-11-05T10:51:45.057
> 
> 标签：java

有一个控制台 Java 应用程序应该一直运行，直到它被`Ctrl`+停止`C`或关闭控制台窗口。如何对该应用程序进行编程以在退出前执行清理代码？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-05T10:58:02.547

您可以使用[Shutdown Hook](http://www.onjava.com/pub/a/onjava/2003/03/26/shutdownhook.html)。

基本上，您需要创建一个 Thread 来执行您的关闭操作，然后[将其添加为关闭挂钩](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook(java.lang.Thread))。例如：

```
class ShutdownHook extends Thread
{
    public void run()
    {
        // perform shutdown actions
    }
}

// Then, somewhere in your code

Runtime.getRuntime().addShutdownHook(new ShutdownHook()) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-05T13:50:30.233

一个 Shutdown 钩子是要走的路，但请注意，不能保证代码实际执行。JVM 崩溃、电源故障或 JVM 上的简单“kill -9”可能会阻止代码清理。因此，您必须确保您的程序即使突然中止也能保持一致的状态。

就个人而言，我只是将数据库用于所有状态存储。它的事务模型确保无论发生什么，持久存储都处于正常状态。他们花了数年时间让代码变得万无一失，所以我为什么要把时间浪费在已经解决的问题上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-01T15:15:37.603

程序退出时删除临时文件 bat.bat 的程序：

```
public class Backup {

    public static void createBackup(String s)
    {

        try{
            String fileName ="C:\\bat"+ ".bat";
            FileWriter writer=new FileWriter(fileName);
            String batquery="cd C:\\Program Files\\MySQL\\MySQL Server 5.0\\bin"
                    + "\nmysqldump -uroot -proot bankdb > \""+s+".sql\""                    
                    +"\nexit";

            writer.append(batquery);
            writer.close();
        }
        catch(Exception e){e.getMessage();}
        try{
            Process p =Runtime.getRuntime().exec("cmd /c start C:\\bat.bat");

        }
        catch(Exception e){e.getMessage();}
        ShutDownHook sdh=new ShutDownHook();
        Runtime.getRuntime().addShutdownHook(sdh);
    }

}

  class ShutDownHook extends Thread
    {
        public void run()
    {
        try
        {
            File f=new File("c:/bat.bat");
            f.delete();
        }
        catch(Exception e){e.getMessage();}

    }

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-01T15:10:49.323

`Thread`s方法中编写的代码`run()`将在运行时对象终止时执行...

```
class ShutdownHookclass extends Thread {
    public void run() {
        // perform shutdown actions
    }
}

//could be written anywhere in your code
Runtime.getRuntime().addShutdownHook(new ShutdownHookclass()) 
```

# iis - Rename Virtual Directory in IIS using VBScript?

> ID：264826
> 
> 赞同：4
> 
> 时间：2008-11-05T10:51:47.990
> 
> 标签：iis, vbscript

How can I rename a Virtual Directory (or Web Application) in IIS 6.0/7.0 using VBScript?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-07-13T14:07:35.737

如果您只想更改 IIS 7 中的站点名称。请编辑该`applicationHost.config`文件。这个文件可以在`c:\Windows\System32\inetsrv\config\`

查找并替换应用程序的名称。保存文件。如果您重新启动 IIS 管理控制台，您将看到名称已更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T16:00:02.437

您想在 IIS 中重命名它，还是更改虚拟路径？adsutil 都可以。它应该安装在 c:\inetpub\AdminScripts

adsutil.vbs SET W3SVC/ *svcnum* /Root/ *AppName* /AppFriendlyName "新友好名称"
adsutil.vbs SET W3SVC/ *svcnum* /Root/ *AppName* /AppRoot "新应用程序路径"

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-13T15:51:04.113

请参阅 IIsWebVirtualDirSetting WMI 集合（来自 MicrosoftIISv2 WMI 命名空间）中对象的“名称”属性。

请参阅[http://msdn.microsoft.com/en-us/library/ms525005%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/ms525005%28v=vs.90%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-01T08:14:11.797

我假设您想使用本地 shell 脚本。

试试 PowerShell，我认为 IIS7 引入了看起来相当强大的[新管理工具。](http://learn.iis.net/page.aspx/98/using-scripts-to-automate-management/)我**认为**您还可以使用这些脚本通过 WMI 远程管理 IIS。

它不应该比 VBScript 更复杂。

另一种方法是使用 VBScript 来编辑 IIS 配置文件或创建[管理对象](http://learn.iis.net/page.aspx/165/how-to-use-microsoftwebadministration/)，但这似乎并不是真正的方法。

希望这会有所帮助。

# java - 控制 servlet 中的类路径

> ID：264828
> 
> 赞同：7
> 
> 时间：2008-11-05T10:52:31.683
> 
> 标签：java, tomcat, servlets, classpath

我的 servlet 应用程序包含许多库 .jar，其中一些包含嵌入式 log4j.xml 或 log4j.properties 文件。我想确保 log4j 首先找到我的 log4j.xml！我尝试在 servlet 中搜索各种类路径元素的优先级规范（例如，WEB-INF/classes 是否总是在 WEB-INF/lib 之前？），或者某种方式来配置或调整 servlet 的类加载器，以便给定的资源目录出现在类路径的早期。到目前为止，我已经画了一个空白。关于确保 servlet .war 文件通过类加载器加载正确的 log4j.xml 有什么建议吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-05T15:49:14.457

# 雄猫 8.5

同上 Tomcat 8.0。

请参阅文档：[类加载器 HOW-TO](https://tomcat.apache.org/tomcat-8.5-doc/class-loader-howto.html)。

# 雄猫 8.0

答案很简单，取自 Tomcat 文档页面[Class Loader HOW-TO](https://tomcat.apache.org/tomcat-8.0-doc/class-loader-howto.html)。特别注意`/WEB-INF/`目录/文件夹的使用。

> 因此，从 Web 应用程序的角度来看，类或资源加载按以下顺序查看以下存储库：
> 
> *   JVM 的引导类
> *   `/WEB-INF/classes`您的网络应用程序
> *   `/WEB-INF/lib/*.jar`您的网络应用程序
> *   系统类加载器类（如上所述）
> *   通用类加载器类（如上所述）
> 
> 如果配置了 Web 应用程序类加载器[，](https://tomcat.apache.org/tomcat-8.0-doc/config/loader.html)则`<Loader delegate="true"/>`顺序变为：
> 
> *   JVM 的引导类
> *   系统类加载器类（如上所述）
> *   通用类加载器类（如上所述）
> *   `/WEB-INF/classes`您的网络应用程序
> *   `/WEB-INF/lib/*.jar`您的网络应用程序

# 雄猫 6

摘自 Tomcat 6 页面，[Class Loader HOW-TO](http://tomcat.apache.org/tomcat-6.0-doc/class-loader-howto.html)。

> 因此，从 Web 应用程序的角度来看，类或资源加载按以下顺序查看以下存储库：
> 
> *   JVM 的引导类
> *   系统类加载器类（如上所述）
> *   **`/WEB-INF/classes`您的网络应用程序**
> *   **`/WEB-INF/lib/*.jar`您的网络应用程序**
> *   `$CATALINA_HOME/lib`
> *   `$CATALINA_HOME/lib/*.jar`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T11:02:10.120

据我了解，类路径中的资源选择是不确定的（从应用程序开发人员的角度来看）。即使相同的文件被一致地加载，行为也可能发生变化： 1\. 当您升级当前容器的版本时。2.如果你切换容器。

最简单的解决方案是*从库 jars 中删除嵌入式 log4j 配置文件*。嵌入 log4j 配置几乎从来都不是一个好主意，因为它会导致您在此处看到的问题...

它们是您开发的第三方罐子还是罐子？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T11:23:14.040

我们的 web.xml 文件中的 Spring `Log4jConfigListener`。

您可以将 log4j 配置文件的位置指定为上下文参数，即您可以将其设置为 /WEB-INF/log4j.xml

这对你来说是一个选择吗？如果您不使用 Spring，我知道您可以通过编程方式设置 Log4j 位置，这也可能有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T12:30:28.320

根据我的经验，WEB-INF/classes 通常优先于 WEB-INF/lib 中的 jar，但是，这也取决于您使用的 servlet 容器（例如，我永远无法弄清楚 JRun 的行为）。如果您能告诉我您正在使用哪个容器，那将非常有帮助。

另外，您确定有问题的 log4j 配置位于 WEB-INF/lib 的 jar 中吗？通常，当我在 servlet 容器情况下遇到类路径问题时，这是因为库位于Web 应用程序**之外**。

servlet 规范*建议*web 应用程序类加载器在委托给容器的类加载器 (SRV.9.7.2) 之前加载自己的类，但由于这与 Java 规范背道而驰，并非所有供应商都默认这样做（实际上 Tomcat 是唯一的我使用的容器默认情况下会这样做）。话虽如此，始终可以配置容器的 Web 应用程序类加载行为。如果你告诉我你正在使用哪个容器，我或许可以帮助你（具体来说，我之前在 WebLogic、WebSphere、Glassfish 和 JRun 上成功地做到了这一点）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T14:57:46.447

如果您无法控制类路径，因为 Tomcat 正在为您设置它，您是否至少能够为 设置系统属性`log4j.configuration`？我相信该属性指向的位置可以设置在类路径之外。

如果不是，另一种方法（虽然丑陋）是在您的应用程序代码中自己显式运行其中一个配置器。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-05T10:55:07.717

您需要在 CLASSPATH 中有 log4j.properties。最好的地方是在 WEB-INF/classes 下。

您还必须确保使用您的 log4j.jar 版本。所以，把它放在 WEB-INF/lib 中，只是为了确保你没有使用来自 tomcat 文件夹的一个，因为它可能会导致奇怪的类加载问题。

# ruby-on-rails - How to keep track of information over several calls to render :partial

> ID：264832
> 
> 赞同：2
> 
> 时间：2008-11-05T10:57:11.783
> 
> 标签：ruby-on-rails, ruby, partials

I am using attribute_fu to render a nice block of rows for a particular table.

```
<%= f.render_associated_form(@foo.bars, :new => 5) %> 
```

I would like to have the `bar` partial have some notion of a bit of state. (Because the notion is specific to the view, I do not want to externalize this to the `Bar` model itself and calculate it in the controller.) For simplicity's sake, pretend it is the index of the `bar` in the `@foo.bars` list.

(I am aware that if this was the case I could use the :collection => @foo.bars to enable bar_counter... this doesn't appear to function in my tests but I have seen docs for it.)

My question -- how do I pass a variable into the partial such that I can keep and edit the state? Naively, I assumed that doing something like

```
<% @tmp = {:index => 1} %>
%= f.render_associated_form(@foo.bars, :new => 5, :locals => {:tmp => @tmp}) %>

#goes in the view
<%= tmp[:index] += 1 %> 
```

would work. `tmp` gets passed appropriately but calling [] throws "Uh oh, you just called a method on nil". Surprisingly to me, I can do tmp.inspect, tmp.class, etc to look at the Hash, and these have the results I would expect. But tmp[:index] or tmp[:anything_I_want] cause it to blow up.

Making `tmp` an array had similar results.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T02:31:31.913

我最终以彻底的 Rails 方式解决了这个问题——修补 :attribute_fu 以满足我的需求。希望我能尽快向社区发布我的补丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T16:57:20.950

The behavior you describe above seems like it must be a bug in attribute_fu, since the local isn't getting properly passed along, which it definitely should. I'd be interested to know what you did to patch it.

# wcf - 您可以在 WCF 之外使用 DataContractSerializer 吗？

> ID：264834
> 
> 赞同：1
> 
> 时间：2008-11-05T10:58:04.777
> 
> 标签：wcf, serialization

从我所做的阅读中，我的印象是 DataContractSerializer 处理版本问题的方式是，如果请求中的成员不存在，它将设置默认值，如果附加成员在请求中但不在序列化程序的定义中将简单地忽略这些字段而不处理它们。

首先，这个假设是否正确？

其次，您是否可以使用此 DataContractSerializer 而不是 XMLSerializer，以便将此版本控制功能添加到旧的 asmx Web 服务？基本上，如果您将新成员添加到您的 Web 服务架构请求中，您将不需要发送给每个客户端？当您收到来自客户端的请求时，您可以使用 DataContractSerializer 反序列化到您的对象中。

希望这是有道理的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T16:16:19.533

您可以在 WCF 之外使用 DataContractSerializer 手动反序列化和序列化对象图。但是，您不能告诉 ASMX 使用序列化程序。用 WCF 服务替换 ASMX 服务要好得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-17T15:53:57.703

我已经使用 DataContract Serializer 导入 xml 文件，它工作正常。

# xml - 定义元素的内容类型以及可枚举的属性

> ID：264838
> 
> 赞同：0
> 
> 时间：2008-11-05T10:59:20.250
> 
> 标签：xml, schema

我无法定义元素的内容类型（“电话号码”），同时定义具有枚举限制的属性（“位置”）。

这是我卡住的地方：

```
<xs:element name="phonenumbers">
    <xs:complexType>
        <xs:sequence maxOccurs="unbounded">
            <xs:element name="phonenumber">
                <!--
                Try #1:
                Define the type of the attribute "location" and the
                content-type of the element "phonenumber". But without
                enumeration restrictions on "location".
                -->

                <xs:complexType>
                    <xs:simpleContent>
                        <xs:extension base="xs:integer">
                            <xs:attribute name="location" type="xs:string"/>                                                        
                        </xs:extension>                                                    
                    </xs:simpleContent>
                </xs:complexType>

                <!--
                Try #2:
                Enumerables in attribute "location" with no content-type
                of the element "phonenumber", thus being unable to put
                anything in it.
                -->

                <xs:complexType>                                                
                    <xs:attribute name="location">
                        <xs:simpleType>
                            <xs:restriction base="xs:string">
                                <xs:enumeration value="Home"/>
                                <xs:enumeration value="Work"/>
                                <xs:enumeration value="Mobile"/>
                            </xs:restriction>
                        </xs:simpleType>
                    </xs:attribute>
                </xs:complexType>

            </xs:element>
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T11:09:17.703

关于什么

```
<xs:element name="phonenumbers">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="phonenumber" minOccurs="0" maxOccurs="unbounded">
        <xs:complexType>
          <xs:simpleContent>
            <xs:extension base="xs:integer">
              <xs:attribute name="location" use="required">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:enumeration value="Home"/>
                    <xs:enumeration value="Work"/>
                    <xs:enumeration value="Mobile"/>
                  </xs:restriction>
                </xs:simpleType>
              </xs:attribute>
            </xs:extension>
          </xs:simpleContent>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:element> 
```

# c# - Deleting records in LINQ with foreign keys - invalid cast exception

> ID：264857
> 
> 赞同：3
> 
> 时间：2008-11-05T11:09:28.217
> 
> 标签：c#, sql, linq, delete-row

I have a simple database:

```
ARTICLE
----------
ArticleId (PK),
ArticleTitle
..other stuff...

USER-ARTICLE
------------
ArchiveId (PK),
UserId,
ArticleId
..other stuff... 
```

The `articleId`'s are foreign keys.

I want to be able to delete a user article row by `UserArticleId` using the following code,

```
UserArticle myobjtodelete = PersonalArchiveDb.UserArticles.Single(ua => ua.ArchiveId == 3);
PersonalArchiveDb.UserArticles.DeleteOnSubmit(myobjtodelete);
PersonalArchiveDb.SubmitChanges(); 
```

^((Yes I'm aware I can do the statement inside the delete rather than retrieving the object, it was for debugging purposes to make sure the object definitely exists - it does.))

When the debugger hits the `SubmitChanges()` line, I get a runtime error:

> Specified cast is not valid.

Here is the stack trace,

> at System.Data.Linq.IdentityManager .StandardIdentityManager .SingleKeyManager`2.TryCreateKeyFromValues(Object[] values, V& v) at System.Data.Linq.IdentityManager.StandardIdentityManager.IdentityCache`2.Find(Object[] keyValues) at System.Data.Linq.IdentityManager.StandardIdentityManager.Find(MetaType type, Object[] keyValues) at System.Data.Linq.CommonDataServices.GetCachedObject(MetaType type, Object[] keyValues) at System.Data.Linq.ChangeProcessor.GetOtherItem(MetaAssociation assoc, Object instance) at System.Data.Linq.ChangeProcessor.BuildEdgeMaps() at System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode failureMode) at System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode)
> at System.Data.Linq.DataContext.SubmitChanges() at Driver_SOC_ASO.Controls.PersonalArchive.ArchiveListing.grdArchive_RowDeleting(Object sender, GridViewDeleteEventArgs e) in C:\work\Driver.Net\Driver-SOC-ASO\Driver-SOC-ASO\Controls\PersonalArchive\ArchiveListing.ascx.cs:line 78 at System.Web.UI.WebControls.GridView.OnRowDeleting(GridViewDeleteEventArgs e) at System.Web.UI.WebControls.GridView.HandleDelete(GridViewRow row, Int32 rowIndex) at System.Web.UI.WebControls.GridView.HandleEvent(EventArgs e, Boolean causesValidation, String validationGroup) at System.Web.UI.WebControls.GridView.RaisePostBackEvent(String eventArgument) at System.Web.UI.WebControls.GridView.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData)
> at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)

I am at a loss, any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T00:01:23.600

这可能是这个[bug](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=351358)的一个例子，微软称它在 .NET 4.0 中已修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T03:39:21.233

尝试设置 ON CASCADE DELETE 为`ArticleId`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-10T21:46:48.917

在您的 dbml 中，检查是否存在不正确的关联黑白文章和用户文章。

# c# - 在 WinForms 应用程序中存储身份验证设置的最佳机制是什么

> ID：264889
> 
> 赞同：6
> 
> 时间：2008-11-05T11:28:14.373
> 
> 标签：c#, .net, winforms, email

我有一个应用程序将使用 System.Net.Mail 和 System.Net.NetworkCredential 发送经过身份验证的电子邮件我的问题是我应该如何存储创建 NetworkCrednetial 对象所需的密码？

该应用程序没有登录名，但我可以设置一个选项，允许用户输入他们的电子邮件凭据（在几乎所有情况下，这将是他们的 Windows 登录名）。我不能使用 Active Directory，因为不是每个客户都使用它。

我可以从用户那里获取密码，然后将其保存到用户注册表、文件或数据库中。显然我必须加密它。我对加密不是很熟悉，所以如果人们认为那是最好的机制，我们将不胜感激。

我的偏好是避免存储任何东西，所以无论如何我可以绕过必须自己存储凭据，也许我可以从当前登录或其他地方获取它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-05T12:30:51.843

要存储用户名和密码（在 Windows 中），请使用[DPAPI](https://stackoverflow.com/search?q=dpapi)。它的 .Net 接口是[ProtectedData](http://msdn.microsoft.com/en-us/library/system.security.cryptography.protecteddata.aspx)和 ProtectedMemory 类。

但首先，您可以尝试[UseDefaultCredentials](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.credentials.aspx)或 DefaultNetworkCredentials 是否适用于您的环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T17:07:20.117

您还可以使用 Win32 Credentials UI - 有许多来自 .NET 的示例用于使用它，包括[MSDN 上的这个](http://msdn.microsoft.com/en-us/library/aa302353.aspx)。

# lucene - 检索 Solr 查询中的特定字段？

> ID：264907
> 
> 赞同：60
> 
> 时间：2008-11-05T11:42:18.620
> 
> 标签：lucene, solr

我在 Jetty 上运行 Solr 实例，当我使用 Solr 管理面板进行搜索时，它会返回整个文档。我应该怎么做才能从搜索返回的每个 Solr 文档中只获取指定的字段？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-11-14T11:58:21.417

```
/?q=query&fl=field1,field2,field3 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-05T20:28:34.033

在 Solr Admin 主页中，单击“完整界面”。在该页面上有一个名为“要返回的字段”的框。您可以在此处列出您想要的（逗号分隔）。“*”表示所有字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-28T12:55:23.640

```
http://xx.xxx.xx.xx:8983/solr/corename/select?indent=on&q=*:*&wt=json&fl=ImageID,Imagepath,Category 
```

此链接有 fl 参数： fl 是一个字段列表，它将显示索引列表中的指定字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-05T09:50:08.710

最好的方法是从 Admin concole 运行查询。当我们运行它时，它还提供了实际执行的 SQL 查询。只需复制查询并使用它。

关于问题：从表中选择特定字段。在管理控制台中查找“FL”文本框。写下您要检索的字段名称，逗号分隔。点击“执行查询”按钮。右上角的 SQL 将可用。

生成的查询：......select?fl=FIELDNAME&indent=on&q= *:* &wt=json

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-09T09:37:27.977

您可以在查询中简单地传递带有必填字段名称的 fl 参数。

&fl=field1,field2,field3&query= *：*

您的回复文件仅包含提及的字段。

# logging - 所有消息的 JMS 队列日志记录/浏览（队列的不可见使用者）（OpenJMS）

> ID：264909
> 
> 赞同：0
> 
> 时间：2008-11-05T11:43:41.330
> 
> 标签：logging, queue, jms, message-queue, openjms

你知道，如果有一些很好的方法来浏览/记录 JMS 队列？（我正在使用 OpenJMS）

对于主题，我可以再添加一个消费者，仅此而已，但是对于队列，我还没有完成解决方案。我想记录某些队列和主题中的所有消息，而不会将它们从队列中“弹出”（以便记录器可以浏览“不可见”的队列）。

使用**javax.jms.QueueBrowser**我可以获得队列的快照，但这似乎没有提供“侦听器解决方案” - 一次又一次地读取无限循环队列上的所有消息，并希望没有消息碰巧被写入并在我的快照之前消耗 - 这听起来不是一个好的解决方案。

另一种选择是为每个“逻辑队列”创建两个队列——一个用于记录器，一个用于实际使用——记录器然后将消息转发到“实际队列”——这可能可行，但可能有更好的解决方案？

因此，如果有人有一个解决方案可以通过“不可见”记录器或其他一些不错的记录解决方案来获取队列中的所有消息，那会很酷。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T12:44:11.333

如果您切换到[Apache ActiveMQ](http://activemq.apache.org/)（这是一个更好、更流行的开源 JMS 提供程序，它也完全支持 JMS 1.1 和 J2EE 1.4），您将获得许多[用于监视和浏览队列的替代方案](http://activemq.apache.org/how-can-i-monitor-activemq.html)，特别是您可以使用[Web 控制台](http://activemq.apache.org/web-console.html)或[JMX](http://activemq.apache.org/jmx.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T14:10:12.360

我也在寻找一个解决方案，并且遇到了一个名为 Hermes ( [http://www.hermesjms.com/confluence/display/HJMS/Home](http://www.hermesjms.com/confluence/display/HJMS/Home) ) 的 OSS 项目。我不能保证，但我会尝试一下。主页提到了浏览/搜索队列的能力。

# oracle - How do I calculate tables size in Oracle

> ID：264914
> 
> 赞同：137
> 
> 时间：2008-11-05T11:47:31.153
> 
> 标签：oracle

Being used to (and potentially spoiled by) `MSSQL`, I'm wondering how I can get at tables size in `Oracle` 10g. I have googled it so I'm now aware that I may not have as easy an option as `sp_spaceused`. Still the potential answers I got are most of the time outdated or don't work. Probably because I'm no DBA on the schema I'm working with.

Would anyone have solutions and or recommendations?

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2008-11-05T22:27:47.880

您可能对此查询感兴趣。它告诉您为每个表分配了多少空间，同时考虑到表上的索引和任何 LOB。您通常有兴趣了解“Purchase Order 表占用多少空间，包括任何索引”，而不仅仅是表本身。你总是可以深入研究细节。请注意，这需要访问 DBA_* 视图。

```
COLUMN TABLE_NAME FORMAT A32
COLUMN OBJECT_NAME FORMAT A32
COLUMN OWNER FORMAT A10

SELECT
   owner, 
   table_name, 
   TRUNC(sum(bytes)/1024/1024) Meg,
   ROUND( ratio_to_report( sum(bytes) ) over () * 100) Percent
FROM
(SELECT segment_name table_name, owner, bytes
 FROM dba_segments
 WHERE segment_type IN ('TABLE', 'TABLE PARTITION', 'TABLE SUBPARTITION')
 UNION ALL
 SELECT i.table_name, i.owner, s.bytes
 FROM dba_indexes i, dba_segments s
 WHERE s.segment_name = i.index_name
 AND   s.owner = i.owner
 AND   s.segment_type IN ('INDEX', 'INDEX PARTITION', 'INDEX SUBPARTITION')
 UNION ALL
 SELECT l.table_name, l.owner, s.bytes
 FROM dba_lobs l, dba_segments s
 WHERE s.segment_name = l.segment_name
 AND   s.owner = l.owner
 AND   s.segment_type IN ('LOBSEGMENT', 'LOB PARTITION')
 UNION ALL
 SELECT l.table_name, l.owner, s.bytes
 FROM dba_lobs l, dba_segments s
 WHERE s.segment_name = l.index_name
 AND   s.owner = l.owner
 AND   s.segment_type = 'LOBINDEX')
WHERE owner in UPPER('&owner')
GROUP BY table_name, owner
HAVING SUM(bytes)/1024/1024 > 10  /* Ignore really small tables */
ORDER BY SUM(bytes) desc
; 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-04-11T15:47:11.373

```
-- Tables + Size MB
select owner, table_name, round((num_rows*avg_row_len)/(1024*1024)) MB 
from all_tables 
where owner not like 'SYS%'  -- Exclude system tables.
and num_rows > 0  -- Ignore empty Tables.
order by MB desc -- Biggest first.
;

--Tables + Rows
select owner, table_name, num_rows
 from all_tables 
where owner not like 'SYS%'  -- Exclude system tables.
and num_rows > 0  -- Ignore empty Tables.
order by num_rows desc -- Biggest first.
; 
```

> 注意：这些是估计值，通过收集统计数据更加准确：

```
exec dbms_utility.analyze_schema(user,'COMPUTE'); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2008-11-05T15:45:02.967

首先，我通常会警告说，为了进行空间分析而收集表统计信息是一件有潜在危险的事情。收集统计信息可能会更改查询计划，特别是如果 DBA 配置了一个使用您的调用未使用的非默认参数的统计信息收集作业，并且会导致 Oracle 重新解析使用相关表的查询，这可能是一种性能打。如果 DBA 故意留下一些没有统计信息的表（如果您`OPTIMIZER_MODE`是 CHOOSE 则很常见），收集统计信息可能会导致 Oracle 停止使用基于规则的优化器并开始使用基于成本的优化器进行一组查询，这可能是主要的性能如果在生产中意外完成，会令人头疼。如果您的统计数据准确，您可以查询`USER_TABLES`（或`ALL_TABLES`或`DBA_TABLES`) 直接调用`GATHER_TABLE_STATS`. 如果您的统计数据不准确，可能是有原因的，您不想扰乱现状。

其次，最接近 SQL Server`sp_spaceused`过程的可能是 Oracle 的`DBMS_SPACE`包。Tom Kyte 有一个很好的[`show_space`程序](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:231414051079)，它为这个包提供了一个简单的界面，并打印出类似于打印出来的信息`sp_spaceused`。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-05-21T02:01:46.450

我修改了 WW 的查询以提供更详细的信息：

```
SELECT * FROM (
  SELECT
    owner, object_name, object_type, table_name, ROUND(bytes)/1024/1024 AS meg,
    tablespace_name, extents, initial_extent,
    ROUND(Sum(bytes/1024/1024) OVER (PARTITION BY table_name)) AS total_table_meg
  FROM (
    -- Tables
    SELECT owner, segment_name AS object_name, 'TABLE' AS object_type,
          segment_name AS table_name, bytes,
          tablespace_name, extents, initial_extent
    FROM   dba_segments
    WHERE  segment_type IN ('TABLE', 'TABLE PARTITION', 'TABLE SUBPARTITION')
    UNION ALL
    -- Indexes
    SELECT i.owner, i.index_name AS object_name, 'INDEX' AS object_type,
          i.table_name, s.bytes,
          s.tablespace_name, s.extents, s.initial_extent
    FROM   dba_indexes i, dba_segments s
    WHERE  s.segment_name = i.index_name
    AND    s.owner = i.owner
    AND    s.segment_type IN ('INDEX', 'INDEX PARTITION', 'INDEX SUBPARTITION')
    -- LOB Segments
    UNION ALL
    SELECT l.owner, l.column_name AS object_name, 'LOB_COLUMN' AS object_type,
          l.table_name, s.bytes,
          s.tablespace_name, s.extents, s.initial_extent
    FROM   dba_lobs l, dba_segments s
    WHERE  s.segment_name = l.segment_name
    AND    s.owner = l.owner
    AND    s.segment_type = 'LOBSEGMENT'
    -- LOB Indexes
    UNION ALL
    SELECT l.owner, l.column_name AS object_name, 'LOB_INDEX' AS object_type,
          l.table_name, s.bytes,
          s.tablespace_name, s.extents, s.initial_extent
    FROM   dba_lobs l, dba_segments s
    WHERE  s.segment_name = l.index_name
    AND    s.owner = l.owner
    AND    s.segment_type = 'LOBINDEX'
  )
  WHERE owner = UPPER('&owner')
)
WHERE total_table_meg > 10
ORDER BY total_table_meg DESC, meg DESC
/ 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-05T12:18:23.320

首先，收集表上的优化器统计信息（如果您还没有）：

```
begin
   dbms_stats.gather_table_stats('MYSCHEMA','MYTABLE');
end;
/ 
```

*警告：正如贾斯汀在他的回答中所说，收集优化器统计信息会影响查询优化，不应在没有适当注意和考虑的情况下进行*！

然后从生成的统计信息中找出该表占用的块数：

```
select blocks, empty_blocks, num_freelist_blocks
from   all_tables
where  owner = 'MYSCHEMA'
and    table_name = 'MYTABLE'; 
```

*   分配给表的总块数为 blocks + empty_blocks + num_freelist_blocks。

*   blocks 是实际包含数据的块数。

将块数乘以正在使用的块大小（通常为 8KB）得到占用的空间——例如 17 个块 x 8KB = 136KB。

要一次对架构中的所有表执行此操作：

```
begin
    dbms_stats.gather_schema_stats ('MYSCHEMA');
end;
/

select table_name, blocks, empty_blocks, num_freelist_blocks
from   user_tables; 
```

[注意：阅读此 AskTom 线程](http://asktom.oracle.com/pls/asktom/f?p=100:11:0::::P11_QUESTION_ID:266215435203)后对上述内容所做的更改

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-05T11:57:14.610

IIRC the tables you need are DBA_TABLES, DBA_EXTENTS or DBA_SEGMENTS and DBA_DATA_FILES. There are also USER_ and ALL_ versions of these for tables you can see if you don't have administration permissions on the machine.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-12-19T07:39:47.760

对于子分区表和索引，我们可以使用以下查询

```
 SELECT owner, table_name, ROUND(sum(bytes)/1024/1024/1024, 2) GB
    FROM
    (SELECT segment_name table_name, owner, bytes
     FROM dba_segments
     WHERE segment_type IN ('TABLE', 'TABLE PARTITION', 'TABLE SUBPARTITION')
     UNION ALL
     SELECT i.table_name, i.owner, s.bytes
     FROM dba_indexes i, dba_segments s
     WHERE s.segment_name = i.index_name
     AND   s.owner = i.owner
     AND   s.segment_type IN ('INDEX', 'INDEX PARTITION', 'INDEX SUBPARTITION')
     UNION ALL
     SELECT l.table_name, l.owner, s.bytes
     FROM dba_lobs l, dba_segments s
     WHERE s.segment_name = l.segment_name
     AND   s.owner = l.owner
     AND   s.segment_type = 'LOBSEGMENT'
     UNION ALL
     SELECT l.table_name, l.owner, s.bytes
     FROM dba_lobs l, dba_segments s
     WHERE s.segment_name = l.index_name
     AND   s.owner = l.owner
     AND   s.segment_type = 'LOBINDEX')
    WHERE owner in UPPER('&owner')
    GROUP BY table_name, owner
    HAVING SUM(bytes)/1024/1024 > 10  /* Ignore really small tables */
    ORDER BY SUM(bytes) DESC
    ; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-03-27T18:34:32.030

这是 WWs 答案的一个变体，它包括上面其他人建议的分区和子分区，以及显示类型的列：表/索引/LOB 等

```
SELECT
   owner, "Type", table_name "Name", TRUNC(sum(bytes)/1024/1024) Meg
FROM
(  SELECT segment_name table_name, owner, bytes, 'Table' as "Type"
   FROM dba_segments
   WHERE segment_type in  ('TABLE','TABLE PARTITION','TABLE SUBPARTITION')
 UNION ALL
   SELECT i.table_name, i.owner, s.bytes, 'Index' as "Type"
   FROM dba_indexes i, dba_segments s
   WHERE s.segment_name = i.index_name
   AND   s.owner = i.owner
   AND   s.segment_type in ('INDEX','INDEX PARTITION','INDEX SUBPARTITION')
 UNION ALL
   SELECT l.table_name, l.owner, s.bytes, 'LOB' as "Type"
   FROM dba_lobs l, dba_segments s
   WHERE s.segment_name = l.segment_name
   AND   s.owner = l.owner
   AND   s.segment_type IN ('LOBSEGMENT','LOB PARTITION','LOB SUBPARTITION')
 UNION ALL
   SELECT l.table_name, l.owner, s.bytes, 'LOB Index' as "Type"
   FROM dba_lobs l, dba_segments s
   WHERE s.segment_name = l.index_name
   AND   s.owner = l.owner
   AND   s.segment_type = 'LOBINDEX')
   WHERE owner in UPPER('&owner')
GROUP BY table_name, owner, "Type"
HAVING SUM(bytes)/1024/1024 > 10  /* Ignore really small tables */
ORDER BY SUM(bytes) desc; 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-04-16T02:39:24.243

```
select segment_name,segment_type,bytes/1024/1024 MB
from dba_segments
where segment_name='TABLENAME' and owner ='OWNERNAME' order by mb desc; 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-11-19T15:30:36.097

我修改了查询以获取每个表空间的架构大小..

```
SELECT owner,
     tablespace_name,
     TRUNC (SUM (bytes) / 1024 / 1024)   Meg,
     ROUND (ratio_to_report (SUM (bytes)) OVER () * 100) Percent
FROM (SELECT tablespace_name, owner, bytes
        FROM dba_segments
       WHERE segment_type IN
                 ('TABLE', 'TABLE PARTITION', 'TABLE SUBPARTITION')
      UNION ALL
      SELECT i.tablespace_name, i.owner, s.bytes
        FROM dba_indexes i, dba_segments s
       WHERE     s.segment_name = i.index_name
             AND s.owner = i.owner
             AND s.segment_type IN
                     ('INDEX', 'INDEX PARTITION', 'INDEX SUBPARTITION')
      UNION ALL
      SELECT l.tablespace_name, l.owner, s.bytes
        FROM dba_lobs l, dba_segments s
       WHERE     s.segment_name = l.segment_name
             AND s.owner = l.owner
             AND s.segment_type IN ('LOBSEGMENT', 'LOB PARTITION')
      UNION ALL
      SELECT l.tablespace_name, l.owner, s.bytes
        FROM dba_lobs l, dba_segments s
       WHERE     s.segment_name = l.index_name
             AND s.owner = l.owner
             AND s.segment_type = 'LOBINDEX')
WHERE owner IN UPPER ('&owner')
GROUP BY owner, tablespace_name
--HAVING SUM(bytes)/1024/1024 > 10  /* Ignore really small tables */
ORDER BY tablespace_name -- desc
; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-05T22:20:36.897

取决于您所说的“表格大小”。表与文件系统上的特定文件无关。一个表将驻留在一个表空间上（如果它是分区的，则可能是多个表空间，如果您还想考虑表上的索引，则可能是多个表空间）。一个表空间通常会有多个表，并且可能分布在多个文件中。

如果您正在估计表的未来增长需要多少空间，那么 avg_row_len 乘以表中的行数（或您期望的表中的行数）将是一个很好的指南。但是 Oracle 会在每个块上留出一些空闲空间，部分是为了允许行在更新时“增长”，部分是因为在该块上可能无法容纳另一整行（例如，8K 块只能容纳 2 行3K，尽管这将是一个极端的例子，因为 3K 比大多数行大小大得多）。所以 BLOCKS（在 USER_TABLES 中）可能是一个更好的指南。

但是，如果您在一个表中有 200,000 行，删除了其中的一半，那么该表仍将“拥有”相同数量的块。它不会释放它们以供其他表使用。此外，块不会单独添加到表中，而是以称为“范围”的组的形式添加。因此，表中通常会有 EMPTY_BLOCKS（也在 USER_TABLES 中）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-12-16T05:19:58.143

分区表的更正：

> ```
> SELECT owner, table_name, ROUND(sum(bytes)/1024/1024/1024, 2) GB
> FROM
> (SELECT segment_name table_name, owner, bytes
>  FROM dba_segments
>  WHERE segment_type IN ('TABLE', 'TABLE PARTITION', 'TABLE SUBPARTITION')
>  UNION ALL
>  SELECT i.table_name, i.owner, s.bytes
>  FROM dba_indexes i, dba_segments s
>  WHERE s.segment_name = i.index_name
>  AND   s.owner = i.owner
>  AND   s.segment_type IN ('INDEX', 'INDEX PARTITION', 'INDEX SUBPARTITION')
>  UNION ALL
>  SELECT l.table_name, l.owner, s.bytes
>  FROM dba_lobs l, dba_segments s
>  WHERE s.segment_name = l.segment_name
>  and   s.owner = l.owner
>  AND   s.segment_type in ('LOBSEGMENT', 'LOB PARTITION', 'LOB SUBPARTITION')
>  UNION ALL
>  SELECT l.table_name, l.owner, s.bytes
>  FROM dba_lobs l, dba_segments s
>  WHERE s.segment_name = l.index_name
>  AND   s.owner = l.owner
>  AND   s.segment_type = 'LOBINDEX')
> WHERE owner in UPPER('&owner')
> GROUP BY table_name, owner
> HAVING SUM(bytes)/1024/1024 > 10  /* Ignore really small tables */
> order by sum(bytes) desc
> ; 
> ```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-12T08:12:22.270

基于块大小返回表的原始大小的简单选择，还包括带索引的大小

select table_name,(nvl (( select sum( blocks) from dba_indexes a,dba_segments b where a.index_name=b.segment_name and a.table_name=dba_tables.table_name ),0)+blocks)*8192/1024 TotalSize,blocks*8 dba_tables 中的 tableSize 按 3 顺序排列

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-06-07T06:52:27.490

我发现这更准确一点：

```
SELECT
   owner, table_name, TRUNC(sum(bytes)/1024/1024/1024) GB
FROM
(SELECT segment_name table_name, owner, bytes
FROM dba_segments
WHERE segment_type in  ('TABLE','TABLE PARTITION')
UNION ALL
SELECT i.table_name, i.owner, s.bytes
FROM dba_indexes i, dba_segments s
WHERE s.segment_name = i.index_name
AND   s.owner = i.owner
AND   s.segment_type in ('INDEX','INDEX PARTITION')
UNION ALL
SELECT l.table_name, l.owner, s.bytes
FROM dba_lobs l, dba_segments s
WHERE s.segment_name = l.segment_name
AND   s.owner = l.owner
AND   s.segment_type IN ('LOBSEGMENT','LOB PARTITION')
UNION ALL
SELECT l.table_name, l.owner, s.bytes
FROM dba_lobs l, dba_segments s
WHERE s.segment_name = l.index_name
AND   s.owner = l.owner
AND   s.segment_type = 'LOBINDEX')
---WHERE owner in UPPER('&owner')
GROUP BY table_name, owner
HAVING SUM(bytes)/1024/1024 > 10  /* Ignore really small tables */
ORDER BY SUM(bytes) desc 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-08-18T09:11:51.233

```
select segment_name as tablename, sum(bytes/ (1024 * 1024 * 1024)) as tablesize_in_GB
From dba_segments /* if looking at tables not owned by you else use user_segments */
where segment_name = 'TABLE_WHOSE_SIZE_I_WANT_TO_KNOW'
and   OWNER = 'WHO OWNS THAT TABLE' /* if user_segments is used delete this line */ 
group by segment_name ; 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2013-11-05T08:32:54.010

还有一个选项允许通过连接获得“选择”大小，以及表大小作为选项

```
-- 1
EXPLAIN PLAN
   FOR
      SELECT
            Scheme.Table_name.table_column1 AS "column1",
            Scheme.Table_name.table_column2 AS "column2",
            Scheme.Table_name.table_column3 AS "column3",
            FROM Scheme.Table_name
       WHERE ;

SELECT * FROM TABLE (DBMS_XPLAN.display); 
```

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2013-06-18T19:17:31.887

我有与最后一个计算表数据段、表索引和 blob 字段的变体相同的变体：

```
CREATE OR REPLACE FUNCTION
  SYS.RAZMER_TABLICY_RAW(pNazvanie in varchar, pOwner in varchar2)
return number
is
  val number(16);
  sz number(16);
begin
  sz := 0;

  --Calculate size of table data segments
  select
    sum(t.bytes) into val
  from
    sys.dba_segments t
  where
    t.segment_name = upper(pNazvanie)
  and
    t.owner = upper(pOwner);
  sz := sz + nvl(val,0);

  --Calculate size of table indexes segments
  select
    sum(s.bytes) into val
  from
    all_indexes t
  inner join
    dba_segments s
  on
    t.index_name = s.segment_name
  where
    t.table_name = upper(pNazvanie)
  and
    t.owner = upper(pOwner);
  sz := sz + nvl(val,0);

  --Calculate size of table blob segments
  select
    sum(s.bytes) into val
  from
    all_lobs t
  inner join
    dba_segments s on t.segment_name = s.segment_name
  where
    t.table_name = upper(pNazvanie)
  and
    t.owner = upper(pOwner);
  sz := sz + nvl(val,0);

  return sz;

end razmer_tablicy_raw; 
```

[来源](http://konurbaev-e.blogspot.ru/2013/06/oracle-database-how-to-calculate-actual.html)。

# java - How to create own header.jsp in JBoss Portal with language support?

> ID：264917
> 
> 赞同：0
> 
> 时间：2008-11-05T11:51:15.607
> 
> 标签：java, internationalization, jboss-portal

I want to create own header.jsp file instead of the one included in the JBoss Portal 2.6 but have to support the locale set by the user.

The original header.jsp does not contain any i18n and I don't know how to do it, especially how to get the actual locale.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-20T13:06:00.823

在 header.jsp 中，使用 scriptlet：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>

<%
   locale = request.getLocale()  // get the user's locale from the HttpServletRequest

%> 
```

然后设置属性包：

```
<fmt:setLocale value="<%= locale %>" />

<fmt:setBundle basename="header" /> 
```

然后你可以创建

```
   header_en.properties
   header_de.properties

```

用于定制消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T12:02:39.827

您可以查看 Thread.currenThread 方法来查看用户的语言。

之后你必须有一个框架来实现 i18n，例如：struts 或 jsf。

# .net - 从 Visual Studio 2005 切换到 Visual Studio 2008 是否值得？

> ID：264920
> 
> 赞同：15
> 
> 时间：2008-11-05T11:52:12.343
> 
> 标签：.net, visual-studio, frameworks

作为一个团队，我们使用带有框架 3.0 的 Visual Studio 2005。我在想我们是否可以切换到带有框架 3.5 的 Visual Studio 2008 ？这值得么 ？

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-05T11:53:40.610

是的，这是 100% 值得的。Visual Studio 2008 完全支持 2005 代码 (.net 2.0)。当您使用 2008 时，您还会享受到许多改进。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-11-05T12:01:20.483

多目标支持（对所有 .Net 项目使用 Dev Studio 2008，无需转换它们）
重构（生产力工具/宏）
单元测试（仅限专业版）
更好的网页设计师，改进编辑和 CSS 支持
CSS 源视图 Intellisense
透明 Intellisense （不要隐藏代码）
ASP.NET AJAX
JavaScript 支持 Intelissense
JavaScript 调试
Windows Presentation Foundation (WPF) 设计器 LINQ（语言集成查询）
对象关系设计器（O/R 设计器）
更好的调试功能（多线程、脚本、LINQ、 WPF)
调试远程进程、SQL 调试、XSLT 调试（仅限专业版）
新报告工具（支持 PDF）
Crystal 报表新功能（也是 ASP.NET）（仅限专业版）
社区帮助（用户在在线帮助中添加的评论）
ClickOnce 部署增强（设置）
更好的 Vista 支持
Office 支持（仅限专业版）
智能设备的许多工具（专业版只要）

使用开发工作室 2008 SP1

支持智能设备偶尔连接的应用程序
电源包控件和组件
打印机兼容性库（使用 VB6 报告而不重写它们）

资料来源：

[http://msdn.microsoft.com/en-us/library/bb386063.aspx#Original](http://msdn.microsoft.com/en-us/library/bb386063.aspx#Original)

[http://msdn.microsoft.com/en-us/vstudio/products/cc149003.aspx](http://msdn.microsoft.com/en-us/vstudio/products/cc149003.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-05T11:55:35.193

100% 值得，同意。

此外，使用新项目（或易于迁移的项目）切换到 3.5 将对提高生产力有很大帮助。即使您不使用 LinQ 之类的功能。

[对象初始化器和自动属性](http://weblogs.asp.net/scottgu/archive/2007/03/08/new-c-orcas-language-features-automatic-properties-object-initializers-and-collection-initializers.aspx)将使您的生活更轻松。

同样如前所述，您仍然可以使用 VS 2008 开发 2.0 项目，因此切换完全不会受到伤害。Webdesigner 领域已经有了一些改进，尤其是 Javascript Syntaxhighlightning 等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T12:10:12.743

即使您还不能使用 .NET 3.5，C# 3.0 语言功能（尤其是如果您使用[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)）也非常值得。它还对 WCF 等有更好的支持（因为您提到 3.0 - 这是 VS2005 中的一个杂项）。

再加上 IDE 的改进，这是一个不费吹灰之力的 IMO。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T13:20:43.460

C# 的智能感知得到了很大改进

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T13:48:06.277

是的。工作更快更可靠

# html - 使一个元素单独居中，但与另一个元素对齐时右对齐

> ID：264924
> 
> 赞同：2
> 
> 时间：2008-11-05T11:53:52.183
> 
> 标签：html, css, user-interface, layout

我们有一个页面通常有两个并排排列的元素。尽管为此探索了几个角度，但我们似乎无法让它发挥作用。我们并不反对使用 JavaScript，只是觉得基于 CSS 的解决方案应该是可能的。有没有办法只使用 CSS（必要时可能还有额外的标记）来制作`element2`中心，当它自己出现时？

# 例子

有时我们有两个并排的元素。

```
<div id="container">
  <div id="element1">content</div>
  <div id="element2">content</div>
</div>
```

但在某些情况下，仅`element2`在页面上，例如：

```
<div id="container">
  <div id="element2">content</div>
</div>
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T12:19:10.747

有一个纯 css 解决方案，但是它不适用于 IE 小于 7 的版本，因为它无法理解兄弟选择器 (+)，因此您可能需要考虑 JavaScript 解决方案（也许是 Dean Edwards 的[IE7](http://dean.edwards.name/IE7/)） . 无论如何，一些示例CSS：

```
div#element2{
  width:100px;
  margin:0 auto;
}
div#element1{
  width:50px;
  float:left;
}
div#element1 + div#element2{
  width:50px;
  float:left;
  margin:0;
} 
```

关键是 div#element1 + div#element2 行，它选择 div#element2，因为它直接跟在 div#element1 之后。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T23:56:01.650

我认为 Phil 是在正确的轨道上，但你应该尝试使用 CSS`last-child`伪类。据我所知，`first-child`并且`last-child`是 CSS 中近似`if`构造的唯一方法。

```
div#container div#element2:last-child {
    width:100px;
    margin:0 auto;
}

div#element1{
    width:50px;
    float:left;
}

div##element2{
    width:50px;
    float:left;
    margin:0;
} 
```

上面的 CSS 基本上说“如果 element2 是其父元素的最后一个子元素，则使用这组样式，否则使用这些其他样式。

这甚至应该在 IE7 中工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T23:32:14.100

一个严格的 CSS2 解决方案：

```
#container {
    text-align:center;
}
#element1, #element2 {
    display:inline-block;
} 
```

内部元素应该像#container 内的内联文本一样布局，但在内部保持块。

这是标准 CSS，但获得浏览器支持可能需要[一些技巧](http://foohack.com/2007/11/cross-browser-support-for-inline-block-styling/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T23:41:32.600

这不是很酷的解决方案，因为表格不再“时髦”，但它完全解决了问题（总之，ie）

```
<style>
    #container {
        margin:0 auto;
        width:100px;
    }

    #container table{
        width: 100%;
        text-align:center;
    }

    #element1{ 
        background-color:#0000ff;
    }

    #element2 {
        background-color: #ff0000;
    }
</style>

<div id=container>
    <table cellspacing=0 cellpadding=0>
        <tr>
            <td id="element1">content</td>
            <td id="element2">content</td>
        </tr>
    </table>
</div> 
```

# c# - Assembly not referenced error in Windows Service

> ID：264925
> 
> 赞同：1
> 
> 时间：2008-11-05T11:54:00.890
> 
> 标签：c#, windows-services

I am designing a windows service and now deploying it.

I have the code:

ServiceInstaller serviceInstaller1 = new ServiceInstaller();

This instantiates the object (obviously, but throws the following compile-time error:

Error 1 The type 'System.Configuration.Install.ComponentInstaller' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Configuration.Install, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. C:\Users\firstname.lastnameDocuments\Visual Studio 20

How do I fix this? I'm thinking I need an app config file in my Windows Service?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T12:04:13.757

构建时是否在您的开发机器上出现此错误（看起来像这样）？或者安装时在目标机器上？

如果是前者：照它说的做：添​​加所需的参考；参考->添加参考->System.Configuration.Install

它应该已经安装在目标机器的 GAC 中，所以不应该做任何其他事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T12:00:32.577

System.Configuration.Install should be in the GAC. Is it not there? Does the target machine only have .NET 1.0 or 1.1? Or does the app.config (which you say you might not have present) stipulate one of those earlier .NET Framework versions should be used?

Ah, it is on the dev machine. Then you should go with Marc's answer and just add a reference to the System.Configuration.Install assembly to your project.

# text-processing - 计算重复的 URL，可能的最快方法

> ID：264930
> 
> 赞同：2
> 
> 时间：2008-11-05T11:57:39.417
> 
> 标签：text-processing

我仍在处理这个庞大的 URL 列表，我收到的所有帮助都很棒。

目前我的列表看起来像这样（虽然有 17000 个 URL）：

[http://www.example.com/page?CONTENT\_ITEM\_ID=1](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=1)
[http://www.example.com/page?CONTENT\_ITEM\_ID=3](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=3)
[http://www.example.com/page?内容\_ITEM\_ID=2](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=2)
[http://www.example.com/page?CONTENT\_ITEM\_ID=1](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=1)
[http://www.example.com/page?CONTENT\_ITEM\_ID=2](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=2)
[http://www .example.com/page?CONTENT\_ITEM\_ID=3](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=3)
[http://www.example.com/page?CONTENT\_ITEM\_ID=3](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=3)

我可以用几种方法过滤掉重复项没问题，awk 等。我真正想做的是取出重复的 URL，但同时计算 URL 在列表中存在的次数并打印带有管道分隔符的 URL 旁边的计数。处理完列表后，它应该如下所示：

网址 | 数数

[http://www.example.com/page?CONTENT\_ITEM\_ID=1](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=1) | 2
[http://www.example.com/page?CONTENT\_ITEM\_ID=2](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=2) | 2
[http://www.example.com/page?CONTENT\_ITEM\_ID=3](http://www.example.com/page?CONTENT%5C_ITEM%5C_ID=3) | 3

什么方法是实现这一目标的最快方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T12:00:40.347

这可能是您无需编写代码即可获得的最快速度。

```
    $ 猫 foo.txt
    http://www.domain.com/page?CONTENT_ITEM_ID=1
    http://www.domain.com/page?CONTENT_ITEM_ID=3
    http://www.domain.com/page?CONTENT_ITEM_ID=2
    http://www.domain.com/page?CONTENT_ITEM_ID=1
    http://www.domain.com/page?CONTENT_ITEM_ID=2
    http://www.domain.com/page?CONTENT_ITEM_ID=3
    http://www.domain.com/page?CONTENT_ITEM_ID=3
    $ 排序 foo.txt | 唯一的-c
          2 http://www.domain.com/page?CONTENT_ITEM_ID=1
          2 http://www.domain.com/page?CONTENT_ITEM_ID=2
          3 http://www.domain.com/page?CONTENT_ITEM_ID=3

```

做了一些测试，虽然速度不是特别快，但对于 17k 来说，它只需要 1 秒多一点（在加载的 P4 2.8Ghz 机器上）

```
$ wc -l foo.txt
174955 foo.txt
vinko@mithril:~/i3media/2008/product/Pending$ 时间排序 foo.txt | 唯一的-c
  54482 http://www.domain.com/page?CONTENT_ITEM_ID=1
  48212 http://www.domain.com/page?CONTENT_ITEM_ID=2
  72261 http://www.domain.com/page?CONTENT_ITEM_ID=3

真正的 0m23.534s
用户 0m16.817s
系统 0m0.084s

$ wc -l foo.txt
14955 foo.txt
$ 时间排序 foo.txt | 唯一的-c
   4233 http://www.domain.com/page?CONTENT_ITEM_ID=1
   4290 http://www.domain.com/page?CONTENT_ITEM_ID=2
   6432 http://www.domain.com/page?CONTENT_ITEM_ID=3

真实0m1.349s
用户 0m1.216s
系统 0m0.012s

```

尽管 O() 像往常一样赢得了比赛。测试了 S.Lott 的解决方案和

```
$猫pythoncount.py
从集合导入 defaultdict
我的文件 = 打开（“foo.txt”，“ru”）
fq= defaultdict( int )
对于 myFile 中的 n：
    fq[n] += 1
对于 fq.items() 中的 n：
    打印 "%s|%s" % (n[0].strip(),n[1])

$ wc -l foo.txt
14955 foo.txt

$ 时间 python pythoncount.py
http://www.domain.com/page?CONTENT_ITEM_ID=2|4290
http://www.domain.com/page?CONTENT_ITEM_ID=1|4233
http://www.domain.com/page?CONTENT_ITEM_ID=3|6432

实际0m0.072s
用户 0m0.028s
系统 0m0.012s

$ wc -l foo.txt
1778955 foo.txt

$ 时间 python pythoncount.py
http://www.domain.com/page?CONTENT_ITEM_ID=2|504762
http://www.domain.com/page?CONTENT_ITEM_ID=1|517557
http://www.domain.com/page?CONTENT_ITEM_ID=3|756636

实际0m2.718s
用户 0m2.440s
系统 0m0.072s

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-05T13:37:05.270

你会一遍又一遍地这样做吗？如果不是，那么“最快”可能是最快实施的

```
sort </file/of/urls | uniq --count | awk '{ print $2, " | ", $1}' 
```

（未经测试，我不在 UNIX 命令行附近）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T12:15:26.603

在 perl 中

[免责声明：目前无法测试此代码]

```
while (<>) {
    chomp;
    $occurences{$_}++;
}
foreach $url (sort keys %occurences) {
    printf "%s|%d\n", $url, $occurences{$url};
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T12:03:15.817

请参阅[将元组列表转换为 python 中的字典](https://stackoverflow.com/questions/261655/converting-a-list-of-tuples-into-a-dict-in-python)。

本质上，您使用 int 而不是列表做同样的事情。

这可能比系统排序更快，因为它是 O(n)。但是，它也是 Python，而不是 C。

```
from collections import defaultdict
myFile = open( "urlFile", "ru" )
fq= defaultdict( int )
for n in myFile:
    fq[n] += 1

for url, count in fq.iteritems():
    print url.rstrip(), "|", count 
```

在我的小戴尔 D830 上，它可以在 0.015 秒内处理 17000 个 URL。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-18T00:55:14.360

这是 Python 的另一个版本：

```
import fileinput, itertools

urls = sorted(fileinput.input())
for url, sameurls in itertools.groupby(urls):
    print url.rstrip(), "|", sum(1 for _ in sameurls) 
```

例子：

```
$ cat foo.txt
http://www.domain.com/page?CONTENT_ITEM_ID=1
http://www.domain.com/page?CONTENT_ITEM_ID=3
http://www.domain.com/page?CONTENT_ITEM_ID=2
http://www.domain.com/page?CONTENT_ITEM_ID=1
http://www.domain.com/page?CONTENT_ITEM_ID=2
http://www.domain.com/page?CONTENT_ITEM_ID=3
http://www.domain.com/page?CONTENT_ITEM_ID=3

$ python countuniq.py foo.txt
http://www.domain.com/page?CONTENT_ITEM_ID=1 | 2
http://www.domain.com/page?CONTENT_ITEM_ID=2 | 2
http://www.domain.com/page?CONTENT_ITEM_ID=3 | 3 
```

表现：

```
C:\> timethis "sort urls17000.txt|uniq -c"
...
TimeThis :  Elapsed Time :  00:00:00.688

C:\> timethis python countuniq.py urls17000.txt
...
TimeThis :  Elapsed Time :  00:00:00.625

C:\> timethis python slott.py urls17000.txt
...
TimeThis :  Elapsed Time :  00:00:00.562

C:\> timethis perl toolkit.pl urls17000.txt
...
TimeThis :  Elapsed Time :  00:00:00.187 
```

**结论**：所有解决方案都在 1 秒内。管道是最慢的，[S.Lott 的解决方案](https://stackoverflow.com/questions/264930/count-duplicate-urls-fastest-method-possible#264942)比上面的 python 版本和[工具包的 perl 解决](https://stackoverflow.com/questions/264930/count-duplicate-urls-fastest-method-possible#264969)方案更快。

* * *

```
C:\> timethis perl toolkit.pl urls1778955.txt
...
TimeThis :  Elapsed Time :  00:00:17.656

C:\> timethis "sort urls1778955.txt|uniq -c"
...
TimeThis :  Elapsed Time :  00:01:54.234

$ wc urls1778955.txt
1778955  1778955 81831930 urls1778955.txt 
```

散列胜过对大量 url 进行排序。

# xul - How to create firefox3 sidebar?

> ID：264932
> 
> 赞同：2
> 
> 时间：2008-11-05T11:58:03.533
> 
> 标签：xul, firefox-3, sidebar

Hi I want to create sidebar in Firefox 3 but have no clue how to do this.

I find tutorial on MDC ([https://developer.mozilla.org/en/Creating_a_Firefox_sidebar](https://developer.mozilla.org/en/Creating_a_Firefox_sidebar)) but after installation extension do not work with "not compatible with Firefox 3.0.3" error.

Does anybody have any tip or link to some resource about how to make sidebar?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T13:14:42.660

好吧，一个 Firefox 扩展，无论是侧边栏、工具栏还是任何其他类型的扩展，基本上都是 XUL 和 Javascript 的混合体，所有这些都很好地打包到一个称为 XPI 的安装程序包中。

有关出色的 XUL 教程，请参阅[http://xulplanet.mozdev.org/tutorials/xultu/](http://xulplanet.mozdev.org/tutorials/xultu/)。有关构建扩展和包格式的信息，请参阅[https://developer.mozilla.org/en/Building_an_Extension](https://developer.mozilla.org/en/Building_an_Extension)。

对于侧边栏，您基本上必须通过使用覆盖来覆盖浏览器的侧边栏区域。有关良好的覆盖信息，请查看 MDC 和[http://www.oreillynet.com/pub/a/mozilla/excerpt/FirefoxHacks_chap01/](http://www.oreillynet.com/pub/a/mozilla/excerpt/FirefoxHacks_chap01/)上的摘录。

除了上面的链接之外，您需要的只是 XML 知识、一些 Javascript 和创造性思维。

要解决上述问题，您必须在*install.rdf*文件中指定正确的 Firefox 版本。对于 Firefox 3，将 maxVersion 设置为：

```
 <em:maxVersion>3.*</em:maxVersion> 
```

# java - 如何检查一个双精度数是否最多有 n 个小数位？

> ID：264937
> 
> 赞同：11
> 
> 时间：2008-11-05T12:01:05.510
> 
> 标签：java, floating-point, decimal

目前我有这个方法：

```
static boolean checkDecimalPlaces(double d, int decimalPlaces){
    if (d==0) return true;

    double multiplier = Math.pow(10, decimalPlaces); 
    double check  =  d * multiplier;
    check = Math.round(check);      
    check = check/multiplier; 
    return (d==check);      
} 
```

但是这种方法`checkDecmialPlaces(649632196443.4279, 4)`可能失败了，因为我在以 2 为基数的基础上进行了以 10 为基数的数学运算。

那么如何才能正确完成这项检查呢？

我想得到一个双精度值的字符串表示，然后用正则表达式检查它——但这感觉很奇怪。

**编辑：** 感谢所有的答案。在某些情况下，我真的得到了双倍的回报，对于这些情况，我实施了以下措施：

```
private static boolean checkDecimalPlaces(double d, int decimalPlaces) {
    if (d == 0) return true;

    final double epsilon = Math.pow(10.0, ((decimalPlaces + 1) * -1));

    double multiplier = Math.pow(10, decimalPlaces);
    double check = d * multiplier;
    long checkLong = (long) Math.abs(check);
    check = checkLong / multiplier;

    double e = Math.abs(d - check);
    return e < epsilon;
} 
```

我将其更改`round`为截断。似乎所做的计算`round`增加了太多的不准确性。至少在失败的测试用例中。
正如你们中的一些人指出的那样，如果我可以得到我应该`BigDecimal`用来检查的“真实”字符串输入，所以我已经完成了：

```
BigDecimal decimal = new BigDecimal(value);
BigDecimal checkDecimal = decimal.movePointRight(decimalPlaces);
return checkDecimal.scale() == 0; 
```

我得到的`double`值来自读取 excel 文件的 Apache POI API。我做了一些测试，发现虽然 API 返回数字单元格的值，但当我立即使用以下`double`格式对其进行格式化时，我可以获得准确的表示： `double``DecimalFormat`

```
DecimalFormat decimalFormat = new DecimalFormat();
decimalFormat.setMaximumIntegerDigits(Integer.MAX_VALUE);
// don't use grouping for numeric-type cells
decimalFormat.setGroupingUsed(false);
decimalFormat.setDecimalFormatSymbols(new DecimalFormatSymbols(Locale.US));
value = decimalFormat.format(numericValue); 
```

这也适用于无法以二进制格式精确表示的值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T12:15:21.737

如果您的目标是用小数点右侧正好*n 个*有效数字来表示一个数字，那么[BigDecimal](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html)就是要使用的类。

> 不可变的、任意精度的有符号十进制数。BigDecimal 由一个任意精度的整数未缩放值和一个 32 位整数刻度组成。如果为零或正数，则刻度是小数点右侧的位数。如果为负数，则将数字的未缩放值乘以 10 的负数次方。因此 BigDecimal 表示的数字的值是 (unscaledValue × 10-scale)。

`scale`可以通过[setScale(int)设置](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html#setScale(int))

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-05T13:07:09.713

测试失败，因为您已达到二进制浮点表示的精度，大约 16 位，[IEEE754 双精度](http://en.wikipedia.org/wiki/Double_precision)。将 649632196443.4279 乘以 10000 将截断二进制表示，导致之后舍入和除法时出错，从而使函数的结果完全无效。

有关更多详细信息，请参阅[http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)

更好的方法是检查`n+1`小数位是否低于某个阈值。如果`d - round(d)`小于[`epsilon`](http://en.wikipedia.org/wiki/Epsilon)（参见[limit](http://en.wikipedia.org/wiki/Limit_(mathematics))），则 的十进制表示`d`没有有效的小数位。类似地，如果`(d - round(d)) * 10^n`小于`epsilon`，则 d 最多可以有`n`重要的位置。

使用[Jon Skeet](https://stackoverflow.com/users/22656/jon-skeet)来[`DoubleConverter`](http://pobox.com/~skeet/csharp/DoubleConverter.cs)检查那些`d`不够准确以保持您正在寻找的小数位的情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-05T12:04:26.860

与所有浮点运算一样，您不应该检查是否相等，而应该检查误差（epsilon）是否足够小。

如果您更换：

```
return (d==check); 
```

有类似的东西

```
return (Math.abs(d-check) <= 0.0000001); 
```

它应该工作。显然，与您要检查的小数位数相比，epsilon 应该选择得足够小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T12:06:05.670

`double`类型是二进制浮点数。在处理它们时总是存在明显的不准确之处，就好像它们是十进制浮点数一样。我不知道您是否能够编写函数以使其按您想要的方式工作。

如果对您很重要，您可能必须返回数字的原始来源（可能是字符串输入）并保留十进制表示。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T21:12:27.737

如果您可以切换到 BigDecimal，那么正如 Ken G 解释的那样，这就是您应该使用的。

如果没有，那么您必须处理其他答案中提到的许多问题。对我来说，您正在处理一个二进制数（double）并询问有关该数字的十进制表示的问题；即，您正在询问字符串。我认为你的直觉是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-05T12:31:49.377

我不确定这是否真的可行。例如，`1.0e-13`有多少位小数？如果它是由于在做算术时的一些舍入误差而导致的，并且真的只是`0`变相了怎么办？**如果打开，另一方面您要询问前n**位小数是否有任何非零数字，您可以执行以下操作：

```
 static boolean checkDecimalPlaces(double d, unsigned int decimalPlaces){
      // take advantage of truncation, may need to use BigInt here
      // depending on your range
      double d_abs = Math.abs(d);
      unsigned long d_i = d_abs; 
      unsigned long e = (d_abs - d_i) * Math.pow(10, decimalPlaces);
      return e > 0;
   } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-07T13:07:36.607

我认为这更好转换为字符串并询问指数的值

```
 public int calcBase10Exponet (Number increment)
 {
  //toSting of 0.0=0.0
  //toSting of 1.0=1.0
  //toSting of 10.0=10.0
  //toSting of 100.0=100.0
  //toSting of 1000.0=1000.0
  //toSting of 10000.0=10000.0
  //toSting of 100000.0=100000.0
  //toSting of 1000000.0=1000000.0
  //toSting of 1.0E7=1.0E7
  //toSting of 1.0E8=1.0E8
  //toSting of 1.0E9=1.0E9
  //toSting of 1.0E10=1.0E10
  //toSting of 1.0E11=1.0E11
  //toSting of 0.1=0.1
  //toSting of 0.01=0.01
  //toSting of 0.0010=0.0010  <== need to trim off this extra zero
  //toSting of 1.0E-4=1.0E-4
  //toSting of 1.0E-5=1.0E-5
  //toSting of 1.0E-6=1.0E-6
  //toSting of 1.0E-7=1.0E-7
  //toSting of 1.0E-8=1.0E-8
  //toSting of 1.0E-9=1.0E-9
  //toSting of 1.0E-10=1.0E-10
  //toSting of 1.0E-11=1.0E-11
  double dbl = increment.doubleValue ();
  String str = Double.toString (dbl);
//  System.out.println ("NumberBoxDefaultPatternCalculator: toSting of " + dbl + "=" + str);
  if (str.contains ("E"))
  {
   return Integer.parseInt (str.substring (str.indexOf ("E") + 1));
  }
  if (str.endsWith (".0"))
  {
   return str.length () - 3;
  }
  while (str.endsWith ("0"))
  {
   str = str.substring (0, str.length () - 1);
  }
  return - (str.length () - str.indexOf (".") - 1);
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-01T12:29:07.627

也许会有所帮助。这是我的方法

```
private int checkPrecisionOfDouble(Double atribute) {
    String s = String.valueOf(atribute);
    String[] split = s.split("\\.");
    return split[1].length();
} 
```

或者

```
private boolean checkPrecisionOfDouble(Double atribute, int decimalPlaces) {
    String s = String.valueOf(atribute);
    String[] split = s.split("\\.");

    return split[1].length() == decimalPlaces;
} 
```

# mysql - How do I export a CSV from Access?

> ID：264943
> 
> 赞同：4
> 
> 时间：2008-11-05T12:03:20.810
> 
> 标签：mysql, ms-access, csv

I am trying to import an access database to mysql. I have created a mysql database, but do not want to use all of the colums in the access database. Is there a way to export only certain colums from the access database to csv?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T15:12:49.163

1) Make a query on the table with only the columns you want, and save it.
2) Select the query, and then got to File->Export (Select Save As "text *.txt, *cvs, etc.") and follow the prompts

# permissions - 在不挂载文件系统的情况下使用 Samba 进行随机访问？

> ID：264950
> 
> 赞同：2
> 
> 时间：2008-11-05T12:05:29.743
> 
> 标签：permissions, samba, mount

我正在使用一台没有 root 访问权限的机器，并且想以随机访问模式访问 Samba 服务器上的文件。我知道我可以使用 smbclient 完整地传输文件，但是文件非常大（> 1GB），我宁愿将它们视为可以进行随机访问的远程文件。

如上所述的问题是我没有对这台机器（Linux 机器）的 root 访问权限，所以我无法挂载远程 Samba 文件系统。

是否有用户级解决方案可以让我随机访问 Samba 服务器上的文件内容？似乎应该可以做内核文件系统客户端正在做的所有事情，但来自用户级应用程序。

顺便说一句，我只需要只读访问权限，并且保证远程文件不会更改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T12:21:25.343

在深入研究 Samba 源代码后回答我自己的问题：有一个客户端库 libsmbclient，其中包括所有常见的文件处理内容：smbc_open、smbc_fstat、smbc_lseek、smbc_read 等。例如，这是我刚刚写的一个片段，其中读取向后文件（只是为了检查它是否在进行真正的搜索）：

```
fd = smbc_open(path, O_RDONLY, 0);
smbc_fstat(fd, &st);

for (offset = st.st_size - BUFLEN; offset > 0; offset -= BUFLEN) {
    smbc_lseek(fd, offset, SEEK_SET);
    smbc_read(fd, buffer, BUFLEN);
} 
```

（为清楚起见，删除了错误检查）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T12:13:19.603

尝试`smbmount`在没有root权限的情况下使用挂载文件系统：

```
mkdir ~/temp
smbmount //{server}/{share} ~/temp -o username=username={username},password={password} 
```

*编辑：更新为使用`smbmount`而不是`mount`.*

# maven-2 - 使用 maven 创建文档

> ID：264951
> 
> 赞同：8
> 
> 时间：2008-11-05T12:05:46.200
> 
> 标签：maven-2, latex, docbook, maven-pdf-plugin

我只是在重新访问 Maven 的中间。当我们上次查看这个时，我们的团队经历了一次糟糕的经历，因为那是在 maven 从 1.x 重新架构到 2.x 的时期，所以我们需要的很多依赖项都没有转移到新的存储库中. 不过，我现在有时间重新考虑。

我对使用 maven 和 LaTeX 或 DocBook 来创建文档很感兴趣，我想知道是否有人有任何经验可以分享、项目/模块结构、使用好的插件等...

非常感谢 ：-）

编辑：

澄清一下，我希望写一篇技术文章/书籍，而我想要的工件可能是 PDF。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-05T12:59:08.137

DocBook 是 Doxia 的众多支持输入之一，Doxia 是 maven 用于生成文档的引擎。参考这里：[http ://maven.apache.org/doxia/modules/index.html](http://maven.apache.org/doxia/modules/index.html)

事实上，Doxia 网站回答了您的确切问题：[http ://maven.apache.org/doxia/book/index.html](http://maven.apache.org/doxia/book/index.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-05T12:21:50.163

[您可以使用 mvn site 命令（即使用插件 site](http://maven.apache.org/plugins/maven-site-plugin/) ）使用 Maven 轻松创建站点（包含文档）。

该插件创建技术报告（例如 Javadoc、单元测试报告、代码覆盖率......），但也可用于创建“真实站点”。您在[此页面](http://maven.apache.org/plugins/maven-site-plugin/examples/creating-content.html)中有更多详细信息。

基本上，您使用[APT](http://maven.apache.org/doxia/references/apt-format.html)（*几乎是纯文本*，非常容易理解）或基于 XML 的格式[Xdoc](http://maven.apache.org/doxia/references/xdoc-format.html)编写您的页面。

2 年前，我使用 XDoc 格式和 Site Maven 插件为我开发的一个应用程序创建了一个完整的用户指南。在全球范围内，它很容易创建！

我希望这能帮到您！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-19T14:43:56.750

我一直在成功使用 Maven 插件 Docbkx。你应该试一试

[Docbkx](http://docbkx-tools.sourceforge.net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-30T15:39:27.817

你绝对应该看看[Maven Docbkx 插件](http://docbkx-tools.sourceforge.net/)。它可能符合您的需求。Doxia 对 DocBook 的支持是-uhm- 次优的。事实上，上次我尝试它时，它产生了一些新的东西——据我所知——不是 DocBook。

我所指的 Maven Docbkx 插件支持世界上的所有自定义（通过插件参数或 XSLT 覆盖，如果你喜欢的话）+它具有一些将其与 Maven 构建集成的机制。（例如将 Maven pom 属性包含到文档中的处理说明。）

请注意，目标是拥有一个插件，以防止您必须自己手动组合处理链。所以这个插件既可以转换为 FO，也可以转换为 PDF。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-14T15:33:59.597

我最近使用 docbook 和用于 maven 的 docbkx 插件为我的 maven 多模块项目实现了项目文档。我现在每次构建项目站点时都会自动生成 html 和 pdf 文件。我认为 docbkx 真的很棒，所以我建议你使用它。

确实如此 - 您只需使用 maven 站点和 doxia 插件就可以创建一个非常好的站点。事实上，我正在使用这两个来生成我的项目站点，但是 doxia 对 docbook 的支持非常有限，并且不允许您模块化文档，例如，包括主文档中的部分文档。因此，对于大型参考手册，我使用的是 docbkx。

如果你想看一看，我的项目就[在这里](http://juffrou.sourceforge.net)。您实际上可以下载源代码并查看它的本质。当然，如果您对此设置有任何疑问，我将非常乐意提供帮助。

干杯卡洛斯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-05T10:38:15.937

尽管这个问题已经很老了，但我想对此进行更新。如果你想使用 LaTeX 作为你的文档，你应该使用一个 maven 插件来生成文档。有几个 maven-plugins 这样做，但其中很多不再维护。有一个新的 maven-plugin 不需要或只需要很少的配置即可使其工作，并且生成的 PDF（或 PS 或 DVI）可以作为工件发布。

看看：[mathan-latex-maven-plugin](https://github.com/reallyinsane/mathan-latex-maven-plugin)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-11-05T12:33:54.117

AFAIK 没有可以处理 LaTeX 或 DocBook 的官方或半官方插件，但您可以做的（除了使用上述站点插件）是配置 exec 插件以在站点生命周期内处理您的 LaTeX/DocBook 源，即项目网站建设的同时。

例如，像

```
<plugin>
  <groupId>org.codehaus.mojo</groupId>
  <artifactId>exec-maven-plugin</artifactId>
  <executions>
    <execution>
    <id>latex</id>
    <goals>
      <goal>exec</goal>
    </goals>
    <phase>site</phase>
      <configuration>
          ...
      </configuration>
    </execution>
  </executions>
</plugin> 
```

# javascript - 如何使用 JavaScript 检查 cookie 是否被阻止

> ID：264961
> 
> 赞同：1
> 
> 时间：2008-11-05T12:11:23.350
> 
> 标签：javascript, cookies

如何使用 JavaScript 检查 cookie 是否被阻止？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T12:24:51.687

写一个cookie然后读取它......

例如：

```
    函数 readCookie(cname) {
        a = 修剪（document.cookie）；
        水库=''；
        而（一个！=''）{
            cookiename = a.substring(0,a.search('='));
            cookiewert = a.substring(a.search('=')+1,a.search(';'));
            if(cookiewert == '' || a.search(';')==-1) {
                cookiewert = a.substring(a.search('=')+1,a.length);
            } 别的 {
                cookiewert = a.substring(a.search('=')+1,a.search(';'));
            }

        if(cname == trim(cookiename)){
            res = cookiewert;
            返回（资源）；
        }
        i = a.search(';')+1;
        如果（i == 0）{i = a.length}
        a = a.substring(i,a.length);
     }
     返回（资源）
    }

    函数 checkSessionCookie() {
     //写入cookie
     document.cookie = 'sessioncookieallowed=true;';
     var check = readCookie('sessioncookieallowed');
    }

```

调用函数 checkSessionCookie();

# c# - 如何在字符串数组中搜索字符串

> ID：264962
> 
> 赞同：81
> 
> 时间：2008-11-05T12:12:19.777
> 
> 标签：c#, asp.net

我需要在字符串数组中搜索一个字符串。我不想在其中使用任何 for 循环

```
string [] arr = {"One","Two","Three"};

string theString = "One" 
```

我需要检查 arr 中是否存在 theString 变量。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2008-11-05T12:16:15.197

好吧，有些东西必须要看，循环比递归更有效（因为尾端递归没有完全实现）......所以如果你不想自己循环，那么：

```
bool has = arr.Contains(var); // .NET 3.5 
```

或者

```
bool has = Array.IndexOf(arr, var) >= 0; 
```

有关信息：**避免使用 var 之类的名称**- 这是 C# 3.0 中的关键字。

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2008-11-05T13:56:56.507

前面提到的每个方法都在内部或外部循环，因此如何实现它并不重要。这是查找目标字符串的所有引用的另一个示例

```
 string [] arr = {"One","Two","Three"};
       var target = "One";
       var results = Array.FindAll(arr, s => s.Equals(target)); 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-11-05T12:18:07.067

它必须是 string[] 吗？A List<String> 会给你你所需要的。

```
List<String> testing = new List<String>();
testing.Add("One");
testing.Add("Two");
testing.Add("Three");
testing.Add("Mouse");
bool inList = testing.Contains("Mouse"); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-11-05T12:19:42.367

```
bool exists = arr.Contains("One"); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-03-26T11:53:47.330

我认为使用***Array.Exists***比使用*Array.FindAll*更好。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2013-11-06T10:15:50.387

它很简单。我总是使用此代码从字符串数组中搜索字符串

```
string[] stringArray = { "text1", "text2", "text3", "text4" };
string value = "text3";
int pos = Array.IndexOf(stringArray, value);
if (pos > -1)
{
    return true;
}
else
{
    return false;
} 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-11-05T12:19:48.777

如果数组已排序，则可以使用[BinarySearch](http://msdn.microsoft.com/en-us/library/system.array.binarysearch.aspx)。这是一个 O(log n) 操作，因此循环速度更快。如果您需要应用多个搜索并且速度是一个问题，您可以在使用它之前对其（或副本）进行排序。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-05T12:18:24.757

每个实现 IList 的类都有一个方法[Contains(Object value)](http://msdn.microsoft.com/en-us/library/system.collections.ilist.contains.aspx)。System.Array 也是如此。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-05T12:57:52.413

为什么禁止“我不想使用任何循环”？这是最明显的解决方案。当有机会变得显而易见时，抓住它！

请注意，喜欢`arr.Contains(...)`的调用仍然会*循环*，只是不会是你编写了循环。

您是否考虑过更适合搜索的替代表示？

*   一个好的 Set 实现会表现良好。（HashSet、TreeSet 或本地等效项）。
*   如果可以确定`arr`已排序，则可以使用二进制搜索（这需要递归或循环，但不像直线搜索那样频繁）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-05T12:31:13.200

起初，我可以想出这样的东西（但它是伪代码，假设你不能使用任何 .NET 内置库）。可能需要一些调整和重新思考，但应该足以领先一步，也许吧？

```
int findString(String var, String[] stringArray, int currentIndex, int stringMaxIndex)
    {
    if currentIndex > stringMaxIndex 
       return (-stringMaxIndex-1);
    else if var==arr[currentIndex] //or use any string comparison op or function
       return 0;
    else 
       return findString(var, stringArray, currentIndex++, stringMaxIndex) + 1 ;
    }

    //calling code
    int index = findString(var, arr, 0, getMaxIndex(arr));

    if index == -1 printOnScreen("Not found");
    else printOnScreen("Found on index: " + index); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-05T12:49:12.493

在 C# 中，如果可以使用 ArrayList，则可以使用 Contains 方法，该方法返回一个布尔值：

```
if MyArrayList.Contains("One") 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-11-07T14:09:39.337

您可以使用Array 类型的[Find](http://msdn.microsoft.com/en-us/library/d9hy2xwa(v=vs.110).aspx)方法。从 .NET 3.5 及更高版本开始。

```
public static T Find<T>(
    T[] array,
    Predicate<T> match
) 
```

下面是一些例子：

```
// we search an array of strings for a name containing the letter “a”:
static void Main()
{
  string[] names = { "Rodney", "Jack", "Jill" };
  string match = Array.Find (names, ContainsA);
  Console.WriteLine (match);     // Jack
}
static bool ContainsA (string name) { return name.Contains ("a"); } 
```

这是使用匿名方法缩短的相同代码：

```
string[] names = { "Rodney", "Jack", "Jill" };
string match = Array.Find (names, delegate (string name)
  { return name.Contains ("a"); } ); // Jack 
```

一个 lambda 表达式进一步缩短了它：

```
string[] names = { "Rodney", "Jack", "Jill" };
string match = Array.Find (names, n => n.Contains ("a"));     // Jack 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-12-05T08:55:44.383

您可以通过以下方式检查元素是否存在

```
arr.Any(x => x == "One") 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-07-13T14:37:51.283

这是旧的，但这是我做的方式，

`enter code here`var result = Array.Find(names, element => element == "One");

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-07-26T19:48:29.607

我很惊讶没有人建议使用`Array.IndexOf`Method。

确实，`Array.IndexOf`有两个优点：

*   它允许搜索元素是否包含在数组中，
*   它同时获取数组的索引。

```
int stringIndex = Array.IndexOf(arr, theString);
if (stringIndex >= 0)
{
    // theString has been found
} 
```

内联版本：

```
if (Array.IndexOf(arr, theString) >= 0)
{
    // theString has been found
} 
```

# algorithm - 用近点坐标在集合中查找对象的最快方法

> ID：264972
> 
> 赞同：2
> 
> 时间：2008-11-05T12:17:49.127
> 
> 标签：algorithm, search, performance, spatial

我有对象的集合。每个对象代表一个坐标范围（即一个块）。我想要的是在给定方向上找到另一个坐标附近的对象。

有没有办法在不遍历整个集合的情况下做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T13:29:40.587

您可能想研究[Binary Space Partitioning](http://en.wikipedia.org/wiki/Binary_space_partitioning)和类似的算法（想到[Quadtree ，以及](http://en.wikipedia.org/wiki/Quadtree)[Plane Sweet Algorithms](http://www.cs.mcgill.ca/~cs251/ClosestPair/ClosestPairPS.html)的变体）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T12:51:12.083

在插入对象时..按坐标对它们进行排序，然后使用分治算法来搜索您最近的可能性

# visual-studio-2008 - 升级到 VS2008 SP1 时对 csproj 文件的影响

> ID：264984
> 
> 赞同：1
> 
> 时间：2008-11-05T12:19:41.807
> 
> 标签：visual-studio-2008, .net-3.5

我们正在将我们的 VS2008 升级到新的 SP1，但注意到 csproj 文件中发生了一些我们无法找到相关信息的更改。似乎csproj文件中的ProductVersion从：

```
<ProductVersion>9.0.21022</ProductVersion> 
```

到

```
<ProductVersion>9.0.30729</ProductVersion> 
```

看起来有一些属性表明 csproj 文件是/可以被 VS 2008 SP1 使用（可能是为了让解决方案选择器窥视）但是我们应该注意这个属性更改的其他隐藏副作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T12:43:10.493

我认为它更有可能是*生成*文件的产品版本，而不是说它可以被什么使用。看到构建版本产生任何明显的差异，我会感到非常惊讶。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T12:45:37.337

主要版本是 Visual Studio 版本选择器选择要打开的 Visual Studio 版本的全部（如果您同时拥有 2005 和 2008）。

我想如果您在安装了 SP1 的 Visual Studio 中创建了一个项目，那么它可能会抱怨并要求您安装 sp1？

我没有任何没有 SP1 的 VS 2008 来测试这个:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-10T13:23:59.967

我的同事刚刚通过公司 IT 的 ninja 更新获得了 SP1（大概我会在重新启动后得到它）。我的 RTM 副本似乎并不关心所有 csproj 文件中的较新版本字符串。**************************