# StackOverflow 问答 000751000-000751999

# wix - 如何为所有用户安装程序快捷方式？

> ID：751000
> 
> 赞同：14
> 
> 时间：2009-04-15T10:02:08.317
> 
> 标签：wix, windows-installer, shortcuts

我正在使用 Windows Installer XML 工具包创建安装程序 msi 文件。安装创建的 msi 文件时，位于 ProgramMenuFolder 文件夹下的快捷方式会导致仅管理员用户的快捷方式。如何让安装程序在所有用户配置文件下创建快捷方式，以便机器上的每个人都有快捷方式？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-15T10:58:42.877

在[Package 元素](http://wix.sourceforge.net/manual-wix3/wix_xsd_package.htm)中，添加如下所示的 InstallScope 属性：

```
InstallScope='perMachine' 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-01-08T19:44:03.220

基于 WIX 教程[http://www.tramontana.co.hu/wix/lesson1.php](http://www.tramontana.co.hu/wix/lesson1.php)中的 SampleFirst.wxs ，我更改了两部分。

首先，添加属性 ALLUERS = 1 ""。正如其他人所指出的那样，这将安装所有用户配置文件的快捷方式。

其次，将组件“ProgramMenuDir”的注册表值的根更改为 HKMU。安装程序将根据 ALLUSERS 属性决定在安装时是否应使用 HKLM（本地计算机）或 HKCU（当前用户）。

然后，您应该能够添加对话框来修改 ALLUSERS 属性，并相应地更改注册表根。

```
<?xml version="1.0" encoding="utf-8"?>
<!-- Original Source available at "http://www.tramontana.co.hu/wix/download.php?file=samples/samplefirst.zip&type=application/zip" 
  This version has been modified for a local machine install (all users) vs a user install-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Name="Foobar 1.0" Id="YOURGUID-CD32-4B20-BB4F-58A5C3B21A7C" UpgradeCode="YOURGUID-EDCE-42A2-9DA2-59FB08AC4FA6" Language="1033" Codepage="1252" Version="1.0.0" Manufacturer="Acme Ltd.">
        <Package Id="*" Keywords="Installer" Description="Acme's Foobar 1.0 Installer" Comments="Foobar is a registered trademark of Acme Ltd." Manufacturer="Acme Ltd." InstallerVersion="100" Languages="1033" Compressed="yes" SummaryCodepage="1252" />
        <Media Id="1" Cabinet="Sample.cab" EmbedCab="yes" DiskPrompt="CD-ROM #1" />
        <Property Id="DiskPrompt" Value="Acme's Foobar 1.0 Installation [1]" />
        <Property Id="ALLUSERS" Value="1" />
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="PFiles">
                <Directory Id="Acme" Name="Acme">
                    <Directory Id="INSTALLDIR" Name="Foobar 1.0">
                        <Component Id="MainExecutable" Guid="YOURGUID-2191-4A98-806B-2554B0DD8FC3">
                            <File Id="FoobarEXE" Name="FoobarAppl10.exe" DiskId="1" Source="FoobarAppl10.exe" KeyPath="yes">
                                <Shortcut Id="startmenuFoobar10" Directory="ProgramMenuDir" Name="Foobar 1.0" WorkingDirectory="INSTALLDIR" Icon="Foobar10.exe" IconIndex="0" Advertise="yes" />
                                <Shortcut Id="desktopFoobar10" Directory="DesktopFolder" Name="Foobar 1.0" WorkingDirectory="INSTALLDIR" Icon="Foobar10.exe" IconIndex="0" Advertise="yes" />
                            </File>
                        </Component>
                        <Component Id="HelperLibrary" Guid="YOURGUID-7BA7-4BD1-90B9-C0DFC21674B1">
                            <File Id="HelperDLL" Name="Helper.dll" DiskId="1" Source="Helper.dll" KeyPath="yes" />
                        </Component>
                        <Component Id="Manual" Guid="YOURGUID-F60A-48D6-83FD-44ED01AA579A">
                            <File Id="Manual" Name="Manual.pdf" DiskId="1" Source="Manual.pdf" KeyPath="yes">
                                <Shortcut Id="startmenuManual" Directory="ProgramMenuDir" Name="Instruction Manual" Advertise="yes" />
                            </File>
                        </Component>
                    </Directory>
                </Directory>
            </Directory>
            <Directory Id="ProgramMenuFolder" Name="Programs">
                <Directory Id="ProgramMenuDir" Name="Foobar 1.0">
                    <Component Id="ProgramMenuDir" Guid="YOURGUID-2D4F-443F-9ADA-563DB3C1581F">
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
                        <RegistryValue Root="HKMU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="" KeyPath="yes" />
                    </Component>
                </Directory>
            </Directory>
            <Directory Id="DesktopFolder" Name="Desktop" />
        </Directory>
        <Feature Id="Complete" Level="1">
            <ComponentRef Id="MainExecutable" />
            <ComponentRef Id="HelperLibrary" />
            <ComponentRef Id="Manual" />
            <ComponentRef Id="ProgramMenuDir" />
        </Feature>
        <Icon Id="Foobar10.exe" SourceFile="FoobarAppl10.exe" />
        <UI />
    </Product>
</Wix> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T10:08:58.473

Stuart Preston 的博客很好地描述了如何做到这一点：

[为“所有用户”安装快捷方式（通过 Wayback Machine）](https://web.archive.org/web/20111118011836/http://consultingblogs.emc.com:80/stuartpreston/archive/2005/12/06/2470.aspx)

**编辑：**

大纲是：

> 在您的 .wxs 文件中，包括以下内容：
> 
> ```
> <Property Id="ALLUSERS"><![CDATA[2]]></Property> 
> ```
> 
> 这将预设一个属性，该属性模仿为您的安装选择“所有用户”而不是“仅我”的行为。您还需要一个类似于以下的目录结构：
> 
> ```
> <Directory Id='ProgramMenuFolder' Name='PMenu' LongName='Programs'>
> <Directory Id='MyProductShortcutDir' Name='MyPMenu' LongName='MyProduct' />
> </Directory> 
> ```
> 
> 最后，您的快捷方式应位于“文件”元素中，如下所示：
> 
> ```
> <File Id="MyProduct.File0" LongName="MyProduct.exe" Name="MYPROD_1.EXE" src="c:\MyProductSourceFolder\MyProduct.exe" >
> <Shortcut Id="MyProduct.Shortcut" Directory="MyProductShortcutDir" Name="MPSCUT" LongName="My Product Shortcut" /> 
> </File> 
> ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-24T00:35:12.780

[Bob Arnson](https://stackoverflow.com/users/104149/bob-arnson)有一篇[博客文章](http://www.joyofsetup.com/2008/04/01/new-wix-feature-setting-package-installation-scope/)介绍了如何在 Wix 中设置用户与机器。
快速的答案是将 Package 元素的 InstallScope 属性设置为“perMachine”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T02:49:42.810

简单地定义 ALLUSERS=1 来强制每台机器安装。

```
 <Property Id="ALLUSERS"><![CDATA[1]]></Property> 
```

# video - 将 jpg 文件流转换为 FLV 流

> ID：751003
> 
> 赞同：2
> 
> 时间：2009-04-15T10:04:11.150
> 
> 标签：video, compression, camera, flv

我使用可以由我的软件控制的 Panasonic hcm280a 相机，它会生成一个巨大的 jpeg 文件流，我想将此流转换为 FLV 流，最好具有良好的压缩比

FFMpeg 会这样做吗？我基本上是在寻找可以为我生成流媒体的现成开源软件（或商业软件）。同样，我的输入是来自相机服务器的 jpg 文件流。

任何见解或评论将不胜感激谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T10:07:15.810

对[这个问题](https://stackoverflow.com/questions/93954/how-to-programatically-create-videos)的回答证实 FFmpeg 能够从一系列图像构建视频。但是，那里没有详细说明。

在 FFmpeg 常见问题解答中，您可以找到：

[3.2 如何将单张图片编码成电影？](http://www.ffmpeg.org/faq.html#SEC14)

首先，重命名您的图片以遵循数字顺序。例如，`img1.jpg`, `img2.jpg`, `img3.jpg`,... 然后你可以运行：

```
ffmpeg -f image2 -i img%d.jpg /tmp/a.mpg 
```

请注意，`%d`替换为图像编号。

`img%03d.jpg`表示序列`img001.jpg`,`img002.jpg`等...

ffmpeg 读取的任何图像格式都使用相同的逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T10:09:08.300

这不是您问题的具体答案，但[www.doom9.org](http://www.doom9.org)是一个很好的视频相关信息来源，值得查看下载和指南

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T10:54:50.657

用`ffmpeg`. 我假设您的框架名称为`frame0000.jpg`, `frame0001.jpg`, ...

```
ffmpeg -f image2 -r 1 -i frame%04d.jpg  -s 320x240 -y -an -r 24 out.flv 
```

`-r 1`告诉输入流是每秒一帧（每秒一张图像），选择您喜欢的 `-s 320x240`缩放所有帧 `-y -an`以覆盖输出文件并禁用音频录制 `-r 24`以在输出流中有 24 fps

您也可以考虑放在`-sameq`中间以尽可能保持质量。

要正确重命名所有框架，您可以使用这个 bash one liner：

```
i=0 ; for f in *.jpg ; do mv "$f" $(printf "frame%04d.jpg" $i) ; i=$((i+1)) ; done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-18T03:46:33.790

Motion 使用 ffmpeg 输出 flv 文件：[http](http://www.lavrsen.dk/twiki/bin/view/Motion/WebHome) ://www.lavrsen.dk/twiki/bin/view/Motion/WebHome 您可以禁用运动检测并使其连续输出（请参阅“output_all on”“ffmpeg_video_codec flv”）。

# asp.net-3.5 - 类库中的 Listview 引用

> ID：751013
> 
> 赞同：0
> 
> 时间：2009-04-15T10:07:14.560
> 
> 标签：asp.net-3.5, class-library, system.web.ui.webcontrols

我正在尝试从我的类库中的 System.Web.UI.WebControls 访问 ListView 类。

所以我添加了对 System.Web 的引用，并希望它会出现，但不幸的是它没有出现。现在我只能假设这是因为 ListView 是 3.5 版本而不是 2.0 版本的一部分。所以我检查了我的类库以确保它的目标是 3.5 而不是 2.0，并且它肯定引用了 3.5 框架。

有没有人知道我错过了在正确的命名空间中仍然看不到 ListView 的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-01T23:54:52.963

添加参考 从 .net 选项卡中选择 System.Web.Extensions

# c# - 是否可以在 C# 中强制使用 using 语句

> ID：751016
> 
> 赞同：6
> 
> 时间：2009-04-15T10:07:41.643
> 
> 标签：c#, using

真的希望能够用某种属性来装饰我的类，该属性将强制使用 using 语句，以便始终安全地处理该类并避免内存泄漏。有人知道这种技术吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-15T10:13:25.873

好吧，有一种方法可以做到这一点 - 只允许通过接受委托的静态方法访问您的对象。作为一个非常简化的示例（显然有许多不同的打开文件的方式 - 读/写等）：

```
public static void WorkWithFile(string filename, Action<FileStream> action)
{
    using (FileStream stream = File.OpenRead(filename))
    {
        action(stream);
    }
} 
```

如果唯一能够创建一次性对象实例的东西是您自己的类中的方法，那么您可以确保它们得到适当的使用。诚然，没有什么可以阻止委托复制参考并在以后尝试使用它，但这不是完全相同的问题。

当然，这种技术严重限制了您可以对对象执行的操作 - 但在某些情况下它可能很有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T10:12:13.753

您可以使用[FxCop](http://msdn.microsoft.com/en-us/library/bb429476.aspx)来强制执行此规则。请参阅 Wikipedia 以获得[快速概览](http://en.wikipedia.org/wiki/FxCop)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:19:46.850

如果要确保始终释放对象，请将终结器与 IDisposable 结合使用。

但在您这样做之前，请阅读 IDisposable 和终结器，并意识到您通常不需要它们，除非您的类正在执行诸如管理非托管资源的生命周期之类的事情。

使用终结器，您的对象将“最终”被回收，无论是否包含在 using 中。using 语句对 IDisposable 很方便，它允许进行确定性清理。唯一需要注意的是，带有终结器的对象清理起来成本更高，并且在等待终结时通常会在内存中停留更长时间。

ref[我什么时候需要实现终结器或 IDisposable？](http://petesbloggerama.blogspot.com/2005/06/when-do-i-need-to-implemen_111967455770395396.html) 或 [technorabble：使用 Dispose、Finalizers 和 IDisposable](http://tech.norabble.com/2008/07/using-dispose-finalizers-and.html)

# c# - 从类库加载部分

> ID：751021
> 
> 赞同：2
> 
> 时间：2009-04-15T10:09:56.457
> 
> 标签：c#, .net, asp.net-mvc, renderpartial

有没有办法从类库中加载部分视图？
我想从几个网站中提取通用部分，以使它们更易于维护。

目前我用（例如）渲染我的部分

```
<%Html.RenderPartial("~/Views/Search/_searchBlock.ascx", ViewData);%> 
```

这是基于文件的，但是在创建类库时，会编译视图。有没有办法加载在这个库中编译的库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T10:13:22.440

我能想到的唯一方法是使用[嵌入式资源](http://support.microsoft.com/kb/319292)和自定义视图引擎。System.Web.Mvc.Html.RenderPartialExtensions 中的点反射器（或下载 MVC 资源）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T09:22:45.860

请参阅 Phil Haacks[的新帖子](http://haacked.com/archive/2009/04/22/scripted-db-views.aspx)了解另一种想法

# java - 将 APR 与 Tomcat 一起使用有什么好处（如果有的话）？

> ID：751025
> 
> 赞同：11
> 
> 时间：2009-04-15T10:10:30.653
> 
> 标签：java, apache, tomcat, apr

Tomcat 可以选择使用 APR 来处理连接。使用它有什么好处？有没有人有第一手的经验？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T10:30:42.587

[这](http://www.mbaworld.com/docs/apr.html)是否回答了你的问题。好处？

> Tomcat 可以使用 Apache Portable Runtime 提供*卓越的可扩展性、性能以及与本机服务器技术的更好集成*。Apache Portable Runtime 是一个高度可移植的库，它是 Apache HTTP Server 2.x 的核心。APR 有很多用途，包括访问高级 IO 功能（例如 sendfile、epoll 和 OpenSSL）、操作系统级功能（随机数生成、系统状态等）和本地进程处理（共享内存、NT 管道和 Unix 套接字）。
> 
> 这些特性使 Tomcat 成为一个通用的网络服务器，将更好地与其他本地网络技术集成，并且总体上使 Java 作为一个成熟的网络服务器平台更可行，而不仅仅是一个以后端为中心的技术。

（我的重点）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T05:53:29.720

如果您不打算在 Tomcat 前使用 Web 服务器（用于提供静态内容），那么 APR 应该会有所改进。

我只是通过[JBoss Web](http://www.jboss.org/jbossweb/)间接使用它，但我总是更喜欢在 Tomcat 前面有一个 Apache httpd，所以我认为 APR 是无关紧要的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-14T21:06:54.787

我将 APR 与 mod_perl2 一起使用，我注意到性能有所提高。这种性能改进来自于使用 APR 直接访问的不仅仅是系统状态等，因为 APR 是一个高度优化的库，可以直接从 Web 服务器处理 cookie、标头、数据类型等。它还提供对连接的所有方面的直接访问，这些方面通常不可用。

我还没有将它与 Java 一起使用，但我试图弄清楚如何让 TomCat 6 允许我从 JSP 代码中使用它。我希望通过直接从我的 Java 代码中使用 APR 来提高效率，就像我使用 Perl 一样。

# winforms - 未保存更改的模式

> ID：751034
> 
> 赞同：2
> 
> 时间：2009-04-15T10:13:08.570
> 
> 标签：winforms, design-patterns

我正在开发一个带有许多不同表单和用户控件的 winforms 应用程序。当表单/控件退出以及应用程序关闭时，是否有我可以实施的推荐模式通知用户当前表单/控件上存在未保存的更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:34:01.830

1.  **Memento**是一种封装不可撤销更改的方法。

    然后，您可以记录未提交的纪念品实例。

    但这通常很复杂。

2.  **状态**通常是最好的。

    您的应用程序有两种“更改”状态：已保存所有更改、未保存更改。

    每个州都有一个基于“更改”和“保存”方法的过渡规则。

    *   “保存”的 Saved All Changes 实现什么也不做。

    *   “保存”的未保存更改实现将状态设置为“已保存所有更改”。

    *   Saved All Changes 实现“change”将状态设置为 Unsaved Changes。

    *   “更改”的未保存更改实现什么也不做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-11T15:26:55.563

我将 LLBL Gen pro 用于 ORM，以便在对象中内置一些良好的实体跟踪。我自己推出了一种似乎效果很好的方法。我创建了一个新界面，我的基本用户控件和基本表单实现了：

```
public interface IClosingNotification
{
    /// <summary>
    /// True if there is a dirty entity (or a dirty entity in the collection) present
    /// </summary>
    bool DirtyEntityPresent { get; }
    /// <summary>
    /// Register an entity to be watched for changes
    /// </summary>
    /// <param name="entity"></param>
    void RegisterForClosingNotification(IEntity entity);
    /// <summary>
    /// Register a collection to be watched for changes
    /// </summary>
    /// <param name="collection"></param>
    void RegisterForClosingNotification(IEntityCollection collection);
    /// <summary>
    /// Returns true if the form should close without any notification
    /// </summary>
    /// <returns></returns>
    bool ShouldClose();
} 
```

在我的基本控件/表单中，我有一个在每个表单上观察的实体集合，并且我在这些类中有一个 CloseForm() 方法，我在表单关闭时使用它。在我的表单中，每当我创建一个对象时，我都可以使用以下方法将其注册为关闭通知：RegisterForClosingNotification(MyCustomer);

它在我们的场景中运行良好。

# sql - 具有许多索引的表的慢速批量插入

> ID：751039
> 
> 赞同：26
> 
> 时间：2009-04-15T10:14:10.130
> 
> 标签：sql, sql-server, indexing, bulkinsert

我尝试将数百万条记录插入具有 20 多个索引的表中。

在最后一次运行中，每 100.000 行花费了 4 多个小时，并且查询在 3½ 天后被取消......

您对如何加快速度有什么建议吗？

（我怀疑很多索引是原因。如果你也这么认为，我怎样才能在操作之前自动删除索引，然后再次创建相同的索引？）

额外信息：

*   索引使用的空间大约是数据单独使用的空间的 4 倍
*   插入每 100.000 行包装在一个事务中。

* * *

状态更新：

接受的答案帮助我让它更快。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-15T10:23:44.333

您可以禁用和启用索引。请注意，禁用它们可能会产生不必要的副作用（例如具有重复的主键或唯一索引等），只有在重新启用索引时才会发现这些副作用。

```
--Disable Index
ALTER INDEX [IXYourIndex] ON YourTable DISABLE
GO

--Enable Index
ALTER INDEX [IXYourIndex] ON YourTable REBUILD
GO 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-15T10:30:52.587

这听起来像是一个数据仓库操作。在插入之前删除索引并在之后重建它们是正常的。

重建索引时，首先构建聚集索引，反之，最后将其删除。它们都应该具有 100% 的填充因子。

代码应该是这样的

```
if object_id('Index') is not null drop table IndexList
select name into Index from dbo.sysindexes where id = object_id('Fact')

if exists (select name from Index where name = 'id1') drop index Fact.id1
if exists (select name from Index where name = 'id2') drop index Fact.id2        
if exists (select name from Index where name = 'id3') drop index Fact.id3
.
.
BIG INSERT

RECREATE THE INDEXES 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T10:31:02.397

正如另一个答案所指出的那样，禁用索引将是一个非常好的开始。

> 每 100.000 行 4 小时 [...] 插入每 100.000 行包含在一个事务中。

您应该考虑减少数量，服务器必须在事务中维护大量状态（因此可以回滚），这（连同索引）意味着添加数据非常困难。

为什么不将每个插入语句包装在自己的事务中？

还要查看您使用的 SQL 的性质，您是每条语句（和网络往返）添加一行，还是添加很多？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-10-09T19:00:13.490

在这些情况下，经常建议禁用然后重新启用索引。不过，我对这种方法有疑问，因为：

(1) 应用程序的 DB 用户需要模式更改权限，通常不应该拥有这些权限。(2) 选择的插入方法和/或索引模式可能一开始就不是最优的，否则重建完整的索引树不应该比一些体面的批量插入更快（例如，客户端一次发出一个插入语句，导致数以千计的服务器往返；或者对聚集索引的选择不当，导致索引节点不断分裂）。

这就是为什么我的建议看起来有点不同的原因：

*   增加 ADO.NET BatchSize
*   明智地选择目标表的聚集索引，这样插入就不会导致聚集索引节点分裂。通常一个标识列是一个不错的选择
*   让客户端先插入临时堆表（堆表没有任何聚集索引）；然后，发出一个大的“insert-into-select”语句，将所有暂存表数据推送到实际目标表中
*   应用 SqlBulkCopy
*   通过选择大容量日志恢复模式来减少事务日志

[您可能会在本文](http://arnosoftwaredev.blogspot.com/2011/10/tips-for-lightning-fast-insert.html)中找到更详细的信息。

# excel - 如何以编程方式重新启用 MS Office 禁用文件列表中的文档

> ID：751048
> 
> 赞同：5
> 
> 时间：2009-04-15T10:16:46.190
> 
> 标签：excel, ms-word, ms-office, powerpoint

MS Office 程序会保留一份在之前打开时导致错误的已禁用文件的列表。用户可以通过程序菜单访问列表并选择要重新启用的文档来从该列表中删除文档。( [http://support.microsoft.com/kb/286017](http://support.microsoft.com/kb/286017) )

**问题是：**如何在不与 gui 交互的情况下以编程方式完成对文档的重新启用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-02T15:45:36.447

合并以前的答案并在此处进行阐述。

Office 产品将禁用的项目存储在注册表中名为`HKEY_CURRENT_USER\Software\Microsoft\Office\<version>\<product>\Resiliency\DisabledItems`. 例如，Excel 2010 的禁用列表位于`HKEY_CURRENT_USER\Software\Microsoft\Office\14.0\Excel\Resiliency\DisabledItems`.

每个禁用的项目都存储为一个随机命名的类型键`REG_BINARY`。字节数组的格式为：

*   字节 0-3 : ??? （可能是 32 位 uint 类型代码，1 = COM 插件）
*   字节 4-7 ：第一个字符串（路径）的 32 位 uint 长度（以字节为单位）
*   字节 8-11 ：第二个字符串（描述）的 32 位 uint 长度（以字节为单位）
*   bytes 12-end ：两个 unicode 字符串，每个字符串的字节长度存储在上面的 uints 中

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-02-11T01:00:30.897

在 Excel 2016 中重新启用所有“禁用项目”的 BAT 脚本。
禁用项目位于 Excel->文件->选项->插件->管理->禁用项目。

```
:: Deletes all values under the key.  
REG DELETE HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Excel\Resiliency\DisabledItems /va /f 
```

参考参数：
/va 删除此键下的所有值。
/f 在没有提示的情况下强制删除。

PS。我有一堆使用任务计划程序运行宏的工作簿。Excel 会随机添加崩溃到禁用项目列表的工作簿。所以每天运行这个 BAT 脚本就可以解决它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-26T22:38:58.177

这是我拼凑起来的 Powershell 脚本，以解决我在 Win7 上使用 MS-Access 2013 时遇到的类似问题

```
#RemoveOfficeDisabledItem.ps1
#command line: 
#   powershell -executionpolicy unrestricted -file ".\RemoveOfficeDisabledItem.ps1"

#Update these variables to suit your situation
$OfficeVersion="15.0"
$OfficeApp="Access"
$FileName="My Blocked File.mdb"

#Converts the File Name string to UTF16 Hex
$FileName_UniHex=""
[System.Text.Encoding]::ASCII.GetBytes($FileName.ToLower()) | %{$FileName_UniHex+="{0:X2}00" -f $_}

#Tests to see if the Disabled items registry key exists
$RegKey=(gi "HKCU:\Software\Microsoft\Office\${OfficeVersion}\${OfficeApp}\Resiliency\DisabledItems\")
if($RegKey -eq $NULL){exit}

#Cycles through all the properties and deletes it if it contains the file name.
foreach ($prop in $RegKey.Property) {
   $Val=""
   ($RegKey|gp).$prop | %{$Val+="{0:X2}" -f $_}
   if($Val.Contains($FileName_UniHex)){$RegKey|Remove-ItemProperty -name $prop}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T06:57:19.130

关于 MS Office XP (2002) MSWord，禁用文档列表以随机命名的二进制值保存在以下键下：[HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Resiliency\DisabledItems]

因此，为每个用户删除“DisabledItems”键下的值可能会奏效。

还有更多的东西吗？我不知道 - 还没有。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-26T08:56:53.780

在 codeproject有一篇关于 Office 如何处理 COMAddins 的好[文章](http://www.codeproject.com/Articles/552349/Excelplusaddinsplustroubleshootingplusguide "Excel 插件疑难解答指南")。普通插件的处理方式相同，系统到目前为止保持不变（直到 Office 2013）。据我所知。随机命名的值包含由空字符串分隔的 unicode 字符的字节数组。我找不到空分隔值数组中的所有条目。然而，索引 (3) 包含 ADDIn 的文件名，索引 (4) 包含 ADDIn 的描述（如果可用）。

因此，正如 Luie 在 2009 年所写的那样，在删除注册表项之前，应该读取这些值并要求用户重新安装插件。

# fluent-nhibernate - NHibernate 要求事件是虚拟的？

> ID：751050
> 
> 赞同：2
> 
> 时间：2009-04-15T10:17:19.467
> 
> 标签：fluent-nhibernate, nhibernate-mapping

我正在尝试使用 NHibernate 映射实体层次结构，几乎所有实体层次结构都有事件。但是，在尝试构建会话工厂时，我收到类似于以下内容的错误消息：

> Core.Domain.Entities.Delivery：方法 remove_Scheduled 应该是虚拟的

**Delivery**是我的域模型中的一个实体，带有一个名为**Scheduled**的事件。由于无法将事件声明为虚拟事件，因此我不知道如何在此处进行。为什么 NHibernate 需要虚拟事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T10:32:41.537

如果你使用延迟加载，公共成员必须声明为虚拟的，因为 NHibernate 会在运行时为你的实体创建代理对象。所以不要使用延迟加载或者只是将事件声明为虚拟的——这并不常见，但它是可能的。

NHibernate 为所有延迟加载的实体创建代理类，并在实体被引用但尚未加载的地方使用它们。访问此代理会触发从数据库加载真实实体。这种方法需要在运行时从您的实体类继承并覆盖公共成员，因此该成员是虚拟的。

还有另一种解决方案。您可以添加`proxy="ISomeInterface"`到类声明中。然后你不需要虚拟成员，而代理只实现给定的接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T07:19:05.857

我在延迟加载的对象上实现 INotifyPropertyChanged 时遇到了同样的问题。问题是您实际上处理了两个不同的 .NET 实例，因此当您在真实实例中触发 NPC 事件时，您不会从对代理的任何引用中接收到它。使其成为虚拟允许代理“转发”此事件。不幸的是，在 VB.NET (2005) 中无法将事件定义为虚拟/可覆盖，因此我们不得不引入一个 C# 项目，其基类仅实现这些虚拟事件，以解决 VB 问题。另见[https://forum.hibernate.org/viewtopic.php?f=25&t=990162&start=0](https://forum.hibernate.org/viewtopic.php?f=25&t=990162&start=0)

如果还有其他方法，我会很想了解自己，因为我们的方法使代理变得不那么透明。同样在需要初始化延迟加载的对象时自动重新连接会话的区域似乎有点痛苦。

问候， 提奥

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:27:58.677

你的映射怎么样？你映射了一个事件吗？

我以前没有遇到过这个问题，但是，我总是在我的类映射中指定“lazy=false”属性，这样我的属性就不必被声明为虚拟的。（因为我不喜欢将属性声明为虚拟，如果我的商业模式不需要这个）

```
<class name="MyClass" table="MyTable" lazy="false">
</class> 
```

# .net - 如何确定我的程序是否有权在目录中创建文件？

> ID：751053
> 
> 赞同：4
> 
> 时间：2009-04-15T10:20:08.150
> 
> 标签：.net

如果我有权在程序目录中创建新文件，我想在那里创建文件，如果没有，我想在程序的 AppData 文件夹中创建文件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T10:31:42.943

您可以使用[FileIOPermission](http://msdn.microsoft.com/en-us/library/system.security.permissions.fileiopermission.aspx)来确定您的应用程序是否具有文件/文件夹的特定权限。

来自 MSDN：

```
FileIOPermission f = new FileIOPermission(PermissionState.None);
f.AllLocalFiles = FileIOPermissionAccess.Read;
try
{
    f.Demand();
}
catch (SecurityException s)
{
    Console.WriteLine(s.Message);
} 
```

编辑：对您的问题的更明确的回答可能是：

```
private string GetWritableDirectory()
{
  string currentDir = Environment.CurrentDirectory; // Get the current dir
  FileIOPermission f = new FileIOPermission(FileIOPermissionAccess.Write, currentDir);
  try
  {
    f.Demand(); // Check for write access
  }
  catch (SecurityException s)
  {
    return Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) ; // Return the appdata (you may want to pick a differenct folder here)
  }
  return currentDir; // Have write access to current dir
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:42:28.967

只需尝试创建文件夹并捕获随后的异常：其他一切都不安全，因为由于 Windows（或多或少）是一个实时系统，在您测试权限的那一刻和创建文件夹的那一刻之间，权限可能已更改。考虑以下潜在的关键事件链：

*   用户即将更改文件夹权限
*   Application tests for folder creation rights: test for rights successful
*   User commits the changes
*   Application tries to create the folder

# sql - 在 SQL 中比较图像

> ID：751054
> 
> 赞同：3
> 
> 时间：2009-04-15T10:20:41.860
> 
> 标签：sql, stored-procedures

与数据库中的图像进行比较的最佳方法是什么？我试图比较它们（@Image 是 Image 类型）：

```
Select * from Photos 
where [Photo] = @Image 
```

但收到错误“数据类型图像和图像在等于运算符中不兼容”。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T10:27:35.823

由于 Image 数据类型是用于存储数据的二进制和巨大空间，IMO，比较 Image 字段的最简单方法是哈希比较。所以你需要在你的表上存储 Photo 列的哈希值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T10:35:23.637

如果您需要比较图像，您应该从数据库中检索所有图像，并使用您用于访问数据库的语言进行比较。这就是为什么在关系数据库中存储图像或其他二进制文件不是最佳实践的原因之一。每次要将图像存储在数据库中时，都应该创建唯一的文件名。用这个唯一的文件名重命名文件，将图像存储在磁盘上，然后将它在磁盘上的名称插入到数据库中，最后插入文件的原始名称或应用程序用户提供的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-24T01:56:35.390

通常，正如已经提到的，您需要使用图像处理货架上的专用算法。

此外，由于问题太笼统，很难给出准确的答案。两个图像可以被认为是不同的或不基于属性的数量。

例如，您可以拥有一张 100x100 像素的花图像和同一朵花的图像，但调整为 50x50 像素。对于某些目的和应用，这两个将被认为是相似的（不管不同的尺寸），但对于其他目的将是不同的图像。

您可能想检查一些工具如何实现图像比较并了解它是如何工作的：

*   [差异](http://pdiff.sourceforge.net/)
*   [ImageMagick](http://www.imagemagick.org/) [比较](http://www.imagemagick.org/script/compare.php)

如果您不想比较图像内容而只想检查两个二进制流（图像文件、其他二进制文件、具有图像内容的二进制对象）是否相等，那么您可以比较图像的[MD5](http://en.wikipedia.org/wiki/MD5)校验和。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T11:18:59.053

这取决于您想要的准确度以及需要比较的图像数量。您可以使用各种函数，如 DATALENGTH 和 SUBSTRING 或 READTEXT 进行一些比较。或者，您可以在 CLR 中编写代码并通过存储过程实现它以进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T11:25:21.020

比较图像属于计算机科学的一个特定类别，即图像处理。您应该搜索一些提供图像处理功能的库。使用它，您可以比较给定两个图像相同或相同的比例。您最多可以有 2 张相互匹配的图像，最高可达 50% 或更多或更少。有定义返回比率的比较公式的数学算法。

希望这为您提供进一步解决问题的方向..

# python - python中的二进制数组

> ID：751055
> 
> 赞同：5
> 
> 时间：2009-04-15T10:21:22.000
> 
> 标签：python

如何在python中创建大数组，创建它的效率如何

在 C/C++ 中：

```
byte *data = (byte*)memalloc(10000); 
```

或者

```
byte *data = new byte[10000]; 
```

在蟒蛇...？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T10:29:37.080

看看[数组模块](http://docs.python.org/library/array.html)：

```
import array
array.array('B', [0] * 10000) 
```

您可以传递一个生成器，而不是传递一个列表来初始化它，这更节省内存。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T10:31:49.463

您可以预先分配一个列表：

```
l = [0] * 10000 
```

这将比 .appending 稍微快一点（因为它避免了中间重新分配）。但是，这通常会为指向整数对象的指针列表分配空间，这将大于 C 中的字节数组。

如果您需要内存效率，可以使用数组对象。IE：

```
import array, itertools
a = array.array('b', itertools.repeat(0, 10000)) 
```

请注意，这些在实践中使用起来可能会稍微慢一些，因为在访问元素时有一个拆箱过程（它们必须首先转换为 python`int`对象）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:27:30.470

通常使用 python，您只需创建一个列表

```
mylist = [] 
```

并将其用作数组。或者，我认为您可能正在寻找数组模块。请参阅[http://docs.python.org/library/array.html](http://docs.python.org/library/array.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T10:37:23.053

**您可以使用数组**模块有效地创建大数组，但使用它不会像 C 那样快。如果您打算做一些数学运算，最好使用**numpy.array**

检查[此问题](https://stackoverflow.com/questions/111983/python-array-versus-numpy-array)以进行比较。

# c# - System.Net.WebException：底层连接已关闭：接收时发生意外错误

> ID：751056
> 
> 赞同：2
> 
> 时间：2009-04-15T10:21:22.797
> 
> 标签：c#, webrequest

我正在尝试在 C# 中创建一个方法来从 url 返回网页 html 内容的字符串。我尝试了几种不同的方法，但收到错误**System.Net.WebException：底层连接已关闭：接收时发生意外错误。**

以下在本地运行良好，但在远程服务器上运行时出现上述错误：

```
 public static string WebPageRead(string url)
    {
        string result = String.Empty;

        WebResponse response = null;
        StreamReader reader = null;

        try
        {
            if (!String.IsNullOrEmpty(url))
            {
                HttpWebRequest request = HttpWebRequest.Create(url) as HttpWebRequest;
                request.Method = "GET";
                request.KeepAlive = false;
                request.ProtocolVersion = HttpVersion.Version10;

                response = request.GetResponse();
                reader = new StreamReader(response.GetResponseStream(), Encoding.UTF8);
                result = reader.ReadToEnd();
            }
        }
        catch (Exception exc)
        {
            throw exc;
        }
        finally
        {
            if (reader != null)
            {
                reader.Close();
            }

            if (response != null)
            {
                response.Close();
            }
        }

        return result;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T10:59:13.360

这可能不是问题，但请尝试以下操作：

```
public static string WebPageRead(string url)
{
    if (String.IsNullOrEmpty(url))
    {
        return null;
    }

    HttpWebRequest request = HttpWebRequest.Create(url) as HttpWebRequest;
    if (request == null)
    {
        return null;
    }

    request.Method = "GET";
    request.KeepAlive = false;
    request.ProtocolVersion = HttpVersion.Version10;

    using (WebResponse response = request.GetResponse())
    {
        using (Stream stream = response.GetResponseStream())
        {
            using (StreamReader reader = 
                       new StreamReader(stream, Encoding.UTF8))
            {
                return reader.ReadToEnd();
            }
        }
    }
} 
```

我回应先前的答案，建议您使用已知的良好 URL 尝试此操作。我要补充一点，您应该使用已知良好的 HTTP 1.1 URL 尝试此操作，注释掉将版本设置为 1.0 的行。如果这有效，那么它会大大缩小范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T12:43:20.630

感谢您的回复，问题是由于远程服务器上的 DNS 问题！为了确认，我最后使用了以下代码：

```
 public static string WebPageRead(string url)
    {
        string content = String.Empty;

        if (!String.IsNullOrEmpty(url))
        {
            HttpWebRequest request = HttpWebRequest.Create(url) as HttpWebRequest;

            if (request != null)
            {
                request.Method = "GET";
                request.KeepAlive = false;
                request.ProtocolVersion = HttpVersion.Version10;

                try
                {
                    using (WebResponse response = request.GetResponse())
                    {
                        using (Stream stream = response.GetResponseStream())
                        {
                            using (StreamReader reader = new StreamReader(stream, Encoding.UTF8))
                            {
                                content = reader.ReadToEnd();
                            }
                        }
                    }
                }
                catch (Exception exc)
                {
                    throw exc;
                }
            }
        }                    

        return content;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:46:03.687

之前有这样的问题是通过在有问题的机器上打开 IE 中的 url 来解决的。然后 IE 会询问您是否要将 url 添加到安全站点列表中。添加它，它适用于该网址。

这只是可能的原因之一。严重的是，很多其他问题都可能导致这种情况。除了上述问题之外，我发现解决此问题的最佳方法是捕获异常并重试请求。

# c# - 使用 Process.Start 打印文档而不显示 Word

> ID：751065
> 
> 赞同：7
> 
> 时间：2009-04-15T10:25:26.403
> 
> 标签：c#, printing, automation, ms-word

我正在使用以下代码从 C# 应用程序打印 Word 文档。

```
 ProcessStartInfo info = new ProcessStartInfo(myDocumentsPath);
            info.Verb = "Print";
            info.CreateNoWindow = true;
            info.WindowStyle = ProcessWindowStyle.Hidden;
            Process.Start(info); 
```

这很好用 Word 打开并打印文档，然后自行关闭。问题是，尽管 CreateNoWindow = true 且 WindowsStyle =Hidden，Word 仍会明显打开。我原以为这两个设置意味着 Word 以静默方式打开。

编辑：请不要建议 Word 对象模型自动化 - 我有许多不同的文档类型需要打印（PDF 等） - 目前只是 Word 文档导致问题。

有什么想法吗？

TIA

马特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T10:29:21.340

Word 可以随意忽略（并且显然会忽略）您要求它保持隐藏状态的请求。

另请参阅[为什么我的隐藏进程仍然可见？](https://stackoverflow.com/questions/537766/why-is-my-hidden-process-still-visible)

# svn - 什么 VCS 允许我同时向多个挂起的提交添加更改？

> ID：751068
> 
> 赞同：3
> 
> 时间：2009-04-15T10:26:10.723
> 
> 标签：svn, git, mercurial, dvcs, bazaar

我的工作流程通常涉及我对文件进行多项更改，每一项更改都属于它自己的跨项目更改的概念单元（= 提交）。

我想做的是将某些差异（整个文件或仅文件的某些行）添加到待处理的提交（可能必须命名）并让多个待处理的提交“活动”同时。

然后，当所有文件中与特定挂起提交相关的所有更改都完成时，我可以提交命名的提交！

关于哪个 VCS 会是一个很好的候选人的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T11:15:47.190

在 svn 中，您可以定义[更改列表](http://svnbook.red-bean.com/nightly/en/svn.advanced.changelists.html)，然后仅提交特定更改列表中的文件。

Git 更进一步，它允许您通过使用[git add -p](http://blog.tplus1.com/index.php/2008/10/31/break-up-changes-into-different-commits-with-git-add-p/)从文件中交互式选择更改的块来记录补丁。

尽管很受欢迎，但这些功能与最佳实践背道而驰。您无法以这种方式正确测试您的更改。一切都可能在您的工作副本中正常工作，但仅提交部分更改可能会破坏构建。使用[功能分支](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.commonpatterns.html#svn.branchmerge.commonpatterns.feature)更安全，任何现代版本控制系统都支持这一点。

还有 Mercurial [ShelveExtension](http://www.selenic.com/mercurial/wiki/index.cgi/ShelveExtension)和[git-stash](http://git-scm.com/docs/git-stash)，它们允许您以补丁块的粒度搁置选定的更改以供以后提交。这种工作方式确实允许您在提交之前进行正确的测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T20:52:57.113

原始请求听起来很像“樱桃采摘”：手动选择“差异”的片段以包含在新提交中。至少 Git 和 Darcs 支持这一点。对于 emacs + git 有[gitsum](http://github.com/chneukirchen/gitsum)，我非常喜欢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T19:37:19.513

在 bzr 中，您可以使用搁置/取消搁置命令从文件中获取一些更改然后返回，或者使用 loom 插件轻松管理一组相关补丁。但是这些都不能解决您最初的请求，我怀疑任何 VCS 都可以这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T11:22:23.193

确保每个单独更改的提交都会导致可构建的系统是非常困难的。

我强烈建议一次做一件事并分别提交每个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T15:38:30.860

内容警告：我的印象，仅基于路过的熟人：

如果您需要对同时进行但在某种意义上不相关的更改进行微观管理，那么您可能需要研究[darcs](http://darcs.net/)，与 svn、git 或 mercurial 等系统相比，它具有相反的重点。

在 darcs 中，补丁是关键元素，给定分支的状态实际上只是一组补丁的总和。该模型可能适合您尝试做的事情，但显然@wcoenen 对最佳实践的警告成立。对于每组补丁，您需要确保构建（无论它可能包含什么）没有被破坏。

顺便说一句，你是 Eoghan M...ri 认为的吗？

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-15T11:16:43.380

Subversion 客户端 (>=1.5) 包含更改列表的概念：*一组与所选名称相关联的文件*。

当在同一个工作副本中处理多个不同的文件集时，这变得特别有用。Subversion 无需记住每组文件中的每个文件，而是允许您将更改列表与每组文件相关联。大多数将一组文件作为目标的命令现在也将接受 --changelist 选项，该选项根据更改列表的成员过滤这些目标。可以使用新的 changelist 子命令编辑更改列表成员资格。

# c++ - 在 C++ 中实现变量约束

> ID：751069
> 
> 赞同：4
> 
> 时间：2009-04-15T10:26:48.057
> 
> 标签：c++, constraints

我一直在寻找一个示例来展示如何在 C++ 中实现约束（或让我轻松做到这一点的 boost 库），但运气不佳。我能想到的最好的办法是：

```
#include <boost/function.hpp>
#include <boost/lambda/lambda.hpp>

template<typename T>
class constrained
{
    public:
        constrained(boost::function<bool (T)> constraint, T defaultValue, T value = defaultValue)
        {
            ASSERT(constraint(defaultValue));
            ASSERT(constraint(value));

            this->value = value;
            this->defaultValue = defaultValue;          
            this->constraint = constraint;                      
        }

        void operator=(const T &assignedValue)
        {
            if(constraint(assignedValue))
                value = assignedValue;      
        }   

    private:
        T value;
        T defaultValue;
        boost::function<bool (T)> constraint;
};

int main(int argc, char* argv[])
{
    constrained<int> foo(boost::lambda::_1 > 0 && boost::lambda::_1 < 100, 5, 10);

    foo = 20; // works
    foo = -20; // fails

    return 0;
} 
```

当然，您可能希望约束类提供更多功能。这只是一个起点的想法。

无论如何，我看到的问题是我必须重载 T 定义的所有运算符，以使其真正表现得像 T，而我无法找出它们是什么。现在，我实际上不需要那么多不同类型的约束，所以我可以省略模板并硬编码它们。不过，我想知道是否有一个通用的（或至少更简洁/优雅的）解决方案，或者我的方法是否有任何严重错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T11:48:37.470

看起来不错的小例子。但一定要实现所有的运算符并处理某种错误的值。

```
foo = 100; // works
++foo; // should throw an exception or perform an assert 
```

使用[boost 运算符](http://www.boost.org/doc/libs/1_38_0/libs/utility/operators.htm)来帮助您处理运算符重载。

有一个选项作为模板参数可能会很好：异常或断言。

我会使用这样的课程。最好有一个索引参数来自动检查向量范围并进行断言。

```
void foo( VectorIndex i ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T13:00:39.730

您不需要像其他人建议的那样重载*所有*运算符，尽管这是提供最大控制的方法，因为涉及类型对象的表达式`constrained<T>`将保持这种类型。

另一种方法是仅重载变异运算符（=、+=、-=、*=、/=、%=、&=、|=、^=、<<=、>>=、pre 和 post ++， pre 和 post --) 并提供用户定义的转换为`T`：

```
template<typename T>
class constrained {
    ... // As before, plus overloads for all mutating operators
public:
    operator T() const {
        return value;
    }
}; 
```

这样，任何涉及`constrained<T>`对象的表达式（例如`x + y`where `x`is`int`和`y`is `constrained<int>`）都将是 type 的右值`T`，这通常更方便和高效。不会失去安全性，因为您不需要控制*任何*涉及`constrained<T>`对象的表达式的值——您只需要在 a`T`变为 a时检查约束`constrained<T>`，即在`constrained<T>`的构造函数和任何变异运算符中.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T12:00:51.603

我同意 Mykola Golubyev 的观点，即 boost 运算符会有所帮助。

您应该为正在使用的所有类型定义所需的所有运算符。

如果您使用的任何类型不支持运算符（例如 operator++()），则调用此方法的代码将不会编译，但所有其他用法都会编译。

如果您想对不同类型使用不同的实现，请使用模板专业化。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T13:03:53.933

您可能对[Boost.Constrained_Value感兴趣。](http://student.agh.edu.pl/~kawulak/constrained_value/)去年 12 月对其进行[了审查](http://www.boost.org/community/review_schedule.html)，但它不在最新的 Boost 版本中。IIRC，审查大多是积极的，但仍有待决定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T11:03:19.933

我可能只是感到困惑，但是如果您面对的参数*不能*违反特定约束，那么为它们创建一个类，检查构造函数和赋值运算符中的约束不是最简单的吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T13:07:26.670

Boost 实际上有这样一个库正在讨论中（我不知道它变成了什么）。我还编写了我自己的这种类型版本，其行为略有不同（不太灵活，但更简单）。我在这里写了一个公认的有点偏见的比较：[Constrained vs. restricted value types](http://fhtagn.unwesen.de/articles/constrained_vs_restricted_value_types)

**编辑**：显然 Eric 更清楚 boost 的实现发生了什么。

# c# - wcf 中的构造函数

> ID：751074
> 
> 赞同：3
> 
> 时间：2009-04-15T10:27:43.607
> 
> 标签：c#, wcf

谁能告诉我如何在 WCF 中创建 Datacontract 的对象。我有一个应用程序，我需要一个构造函数，但是在客户端，当我创建一个对象时，它不显示构造函数。我知道一种解决方案，比如添加一个部分包含构造函数的类。混淆在这里“在哪里添加部分类”

请有人帮助我........我是 C# 和 .net 的新手。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-23T21:30:29.157

有两种方法可以为 DataContract 类提供构造函数。可能最一致的方法是将 DataContract 移动到您在服务和客户端中引用的单独类库中。正如 John Saunders 所说，有一种方法可以告诉 Visual Studio 在为引用的服务生成代理代码时使用现有类。在此之后，您可以正常地将构造函数添加到该类。

如果您希望构造函数仅出现在客户端或由于某些其他原因无法使用共享类库，您可以创建一个部分类。这样的类实际上没有定义的“位置”。通过部分类提供构造函数所需要做的就是创建一个新的类文件，该文件定义与代理相同的类。

所以假设你有一个代理类 ReferencedServiceProxy.ContractClass 你需要创建一个新的代码文件来定义部分类

```
namespace ReferencedServiceProxy
{
   partial class ContractClass
   {
       // Constructor. Naturally the constructor cannot overwrite one
       // defined in the proxy class already. Not sure if those define
       // a default constructor.
       public ContractClass()
       {
           // Implementation
       }
   }
} 
```

只要文件被正常编译，编译器就会完成所有其余的工作。

但是，在不知道需要构造函数的情况下，可能值得指出的是，在客户端反序列化对象时不会调用构造函数，因为对象不是这样“构造”的。

[http://mehranikoo.net/CS/archive/2007/11/09/DataContractConstructorsInWCF.aspx](http://mehranikoo.net/CS/archive/2007/11/09/DataContractConstructorsInWCF.aspx)与反序列化期间发生的事情以及如何影响它有关。只是我通过艰难的方式学到的东西.. Silverlight 甚至不支持 OnDeserialization 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T10:40:33.327

为了做你想做的事，你必须在客户端和服务之间共享数据契约类型。在“添加服务参考”对话框中有一个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T10:37:26.157

**在我的 WCF 中**

**ITestPointSrv.cs**

```
[ServiceContract]    
public interface ITestPointSrv    
{    
    [OperationContract]
    DataTable GetMonthEvents(Int32 p_nYear, Int32 p_nMonth);
} 
```

**TestPointSrv.svc.cs**

```
public DataTable GetMonthEvents(Int32 p_nYear, Int32 p_nMonth)    
{    
    return (new OccasionType()).GetMonthEvents(p_nYear, p_nMonth);    
} 
```

**在我的 WCF 中**

**调度程序.cs**

```
TestPointSrvClient srv = new TestPointSrvClient();    
DataTable dtEvents = srv.GetMonthEvents(this.dtpMonth.Year,
    this.dtpMonth.Month); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T10:38:49.367

在生成的代码中，它有什么构造函数？如果（非抽象、非静态）类没有任何显式构造函数，它将获得一个默认构造函数（公共的、无参数的）。那么您在生成的代码中看到了什么代码（对于这个对象）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T10:39:34.327

您的 Web 服务的 WSDL（Web 服务描述语言）不会告诉 DataContract 的构造函数信息。序列化仅适用于 DataContract 类中的 [DataMember] 字段。因此，生成的客户端不包含您的 DataContract 的任何方法或构造函数，它当然只有一个无参数的默认构造函数。

如果您确实想将构造函数添加到 DataContract 类，您可以在解决方案的 Web 参考文件夹中打开 Reference.cs 文件，然后找到该类并对其进行修改。请注意，如果您更新您的网络参考，自定义代码将被覆盖。

像您所说的另一个解决方案，为生成的 DataContract 类创建了一个部分类。如果您检查 reference.cs 文件，您将知道如何执行此操作。（您需要在 VS 中单击显示所有文件图标才能查看 reference.cs）

# .net - IEqualityComparer.Equals 与 IEnumerable.Contains 一起使用时，x 或 y 是列表中的值吗？

> ID：751081
> 
> 赞同：2
> 
> 时间：2009-04-15T10:30:18.390
> 
> 标签：.net, ienumerable, iequalitycomparer

IEnumberable 有一个扩展方法 Contains<T>，它接受两个参数。第一个参数是要检查的值，第二个参数是 IEqualityComparer 的实现。查看 IEqualityComparer.Equals 它需要两个名为 x 和 y 的参数，用于比较第一个和第二个对象。

我的问题是 IEnumerable 的值是 X 还是 Y？

*例子*

```
List<string> test = new List<String() { "a", "b", "c" };
test.Contains("d", myComparer); 
```

当它为第一个值调用 Equals 方法时，它将是 Equals("a","d") 还是 Equals("d","a")？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T10:34:08.240

没关系 - 平等应该是对称的。从文档中[`IEqualityComparer<T>.Equals`](http://msdn.microsoft.com/en-us/library/ms132154.aspx)：

> Equals 方法是自反的、对称的和传递的。也就是说，如果用于将对象与自身进行比较，则返回true；如果对 y 和 x 为真，则对两个对象 x 和 y 为真；如果对 x 和 y 为真并且对 y 和 z 也为真，则对两个对象 x 和 z 为真。

我不相信 in 的用法`Enumerable.Contains`是明确定义的，即它可能会在未来的版本中改变。如果你只是让你的相等比较器遵守接口文档，你会没事的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T08:12:15.917

为了完整起见，IEnumberable 的反射代码显示它位于左侧（见下文）。但是，这并不能保证永远不会改变，因此使用它存在风险。

```
public static bool Contains<TSource>(this IEnumerable<TSource> source, TSource value, IEqualityComparer<TSource> comparer)
{
    if (comparer == null)
    {
        comparer = EqualityComparer<TSource>.Default;
    }
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    foreach (TSource local in source)
    {
        if (comparer.Equals(local, value))
        {
            return true;
        }
    }
    return false;
} 
```

# cocoa - 将 NSMutableArray 写入可可文件的问题

> ID：751093
> 
> 赞同：5
> 
> 时间：2009-04-15T10:36:20.217
> 
> 标签：cocoa, nsmutablearray, writefile

一个真正的初学者问题。我有一个 NSView 子类，我在其中创建了一个包含 NSValues 的 NSMutableArray。当我想使用 writetofile 将数组写入文件时：自动：文件已创建，但它不包含可变数组包含的任何 NSValue。有谁知道我如何成功地将这个可变数组写入文件？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T10:56:28.390

NSValues 不能保存在 plist 中（这是 writeToFile:atomically: 所做的）。[在此处](http://developer.apple.com/documentation/Cocoa/Conceptual/PropertyLists/AboutPropertyLists/AboutPropertyLists.html#//apple_ref/doc/uid/10000048i-CH3-SW2)查看您可以保存的值。（NSNumber 是一种可以保存的 NSValue，但其他 NSValue 会失败。）

如果你想用 NSValues 保存你的数组，你可以使用[归档](http://developer.apple.com/documentation/Cocoa/Conceptual/Archiving/Archiving.html)而不是 writeToFile:atomically:。NSArray 和 NSValue 都支持存档，因此您只需将数组转换为存档并将该数据保存到文件中。（它也将包括 NSValues。）代码如下所示：

```
[NSKeyedArchiver archiveRootObject:myArray toFile:@"myPath"]; 
```

要加载它，只需使用：

```
NSArray *myArray = [NSKeyedUnarchiver unarchiveObjectWithFile:@"myPath"]; 
```

# visual-c++ - 从资源 DLL 加载控件的标题

> ID：751094
> 
> 赞同：1
> 
> 时间：2009-04-15T10:36:48.110
> 
> 标签：visual-c++, mfc, internationalization

我是 MFC 的新手，我需要构建一个应该能够在运行时更改语言的多语言应用程序。

AFAIK 使用 MFC 进行国际化的常用方法是创建仅资源的 DLL。但是似乎没有简单的方法（也就是说，加载 DLL，调用一些函数，然后 MFC 自动更新所有东西或类似的东西）在运行时切换资源 DLL，对吧？

所以我将不得不手动更新所有控件等等。我已经设法从 DLL 的字符串表中加载字符串，但是由于按钮等控件的标题存储在相应的对话框中（如果我相信我的资源黑客:)）我认为必须有一种方法来加载它们并避免手动在字符串表中存储一个附加字符串。

还是有其他我不知道的方法？

如果有什么不同...我必须使用 MS Embedded Visual C++ 4

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T00:43:07.513

我从事一个大型本地化 MFC 项目。这是我们的策略：

1.  键 -> 本地化字符串的字典，特定于每种语言。有几种方法可以实现这一点，稍后再介绍。

2.  对话框资源中的控件 ID 或标题设置为用于查找翻译的键

3.  创建一个基本 CDialog、CFormView 等并在 init 调用[::EnumChildWindows](http://msdn.microsoft.com/en-us/library/ms633494(VS.85).aspx)中。在回调中，查找翻译并将控件的标题替换为翻译。

对于您的字典，您可以采用几种方法。

*   如果您想依赖内置的本地化资源选择和字符串表，您必须以某种方式将控件与字符串 ID 匹配。您可以仔细确保控件 ID 与字符串 ID 匹配，也可以对标题中的 ID 进行 ASCII 编码，然后使用 atoi 解析 int 值。

*   您可以放弃内置的本地化字符串表处理并为每种语言维护自己的字符串 -> 字符串字典。这使您可以将标题设置为资源中的非本地化字符串，从而使布局更容易（尽管您仍然需要在所有语言中进行测试。）它将要求您执行自己的“依赖注入”以确保加载找到正确的字典。您希望能够在不重新构建核心二进制文件的情况下发布更新/附加的语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T11:57:54.147

如果您不想要求重新启动应用程序（*迄今为止*最简单的解决方案，也是您应该使用 IMO 的解决方案），您可以使用资源 dll 并在用户切换语言时重新创建主窗口。这样，MFC 将以新语言重新创建菜单等。无论如何，从您切换资源句柄的那一刻起，新对话框就会以新语言显示。

我不确定这与嵌入式世界有何关系，我的经验来自桌面 MFC。

# c++ - 检查是否加载了特定的设备驱动程序

> ID：751100
> 
> 赞同：2
> 
> 时间：2009-04-15T10:39:52.407
> 
> 标签：c++, windows, drivers

我正在尝试确定是否可以检查是否使用 C++ 在 Windows Server 2003 中加载了特定的视频卡设备驱动程序。谁能给我指点我如何实现这一目标？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T10:44:30.010

使用**EnumDeviceDrivers -**[这里](http://msdn.microsoft.com/en-us/library/ms682619%28VS.85%29.aspx)有一个例子。

# formatting - 使用 GAWK 打印数千个分离的浮点数

> ID：751101
> 
> 赞同：0
> 
> 时间：2009-04-15T10:40:11.360
> 
> 标签：formatting, floating-point, separator, gawk

我必须用 gawk 处理一些巨大的文件。我的主要问题是我必须使用千位分隔符打印一些浮点数。例如：`10000`应该在输出中显示为`10.000`和。`10000,01``10.000,01`

我（和谷歌）想出了这个函数，但是对于浮点数失败了：

```
function commas(n) {
  gsub(/,/,"",n)
  point = index(n,".") - 1
  if (point < 0) point = length(n)
    while (point > 3) {
      point -= 3
      n = substr(n,1,point)"."substr(n,point + 1)
    }
  sub(/-\./,"-",n)
  return d n
} 
```

但它因浮动而失败。

现在我正在考虑将输入拆分为一个整数和一个 < 1 部分，然后在格式化整数之后再次粘合它们，但是没有更好的方法吗？

**免责声明：**

*   我不是程序员
*   我通过一些 SHELL 环境知道这一点。可以设置千位分隔符的变量，但它必须在具有不同语言和/或语言环境设置的不同环境中工作。
*   英语是我的第二语言，如果我用错了，请见谅

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T11:08:03.277

它因浮点数而失败，因为您正在传递欧洲类型的数字（1.000.000,25 代表一百万零四分之一）。如果您只是更改逗号和句点，则您提供的功能应该可以工作。我会先用 1000000.25 测试当前版本，看看它是否适用于非欧洲数字。

可以调用以下 awk 脚本`"echo 1 | awk -f xx.gawk"`，它将向您展示“正常”和欧洲版本的运行情况。它输出：

```
123,456,789.1234
123.456.789,1234 
```

显然，您只对函数感兴趣，实际代码将使用输入流将值传递给函数，而不是固定字符串。

```
function commas(n) {
    gsub(/,/,"",n)
    point = index(n,".") - 1
    if (point < 0) point = length(n)
    while (point > 3) {
        point -= 3
        n = substr(n,1,point)","substr(n,point + 1)
    }
    return n
}
function commaseuro(n) {
    gsub(/\./,"",n)
    point = index(n,",") - 1
    if (point < 0) point = length(n)
    while (point > 3) {
        point -= 3
        n = substr(n,1,point)"."substr(n,point + 1)
    }
    return n
}
{ print commas("1234,56789.1234") "\n" commaseuro("12.3456789,1234") } 
```

除了对逗号和句点的处理之外，这些功能是相同的。在以下描述中，我们将它们称为分隔符和小数：

*   gsub 删除所有现有的分隔符，因为我们将把它们放回去。
*   point 找到小数点在哪里，因为那是我们的起点。
*   如果没有小数，则 if 语句从末尾开始。
*   我们在剩下三个以上字符时循环。
*   在循环内部，我们调整插入分隔符的位置，并插入它。
*   循环完成后，我们返回调整后的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:00:48.373

与[Pax的回答](https://stackoverflow.com/questions/751101/printing-thousand-seperated-floats-with-gawk/751191#751191)一起去：

阅读[GNU awk 手册的“转换”部分，](http://www.gnu.org/manual/gawk/html_node/Conversion.html#Conversion)其中明确讨论了`LOCALE`环境变量对数字类型的字符串表示的影响。

# c++ - 序列向量

> ID：751104
> 
> 赞同：1
> 
> 时间：2009-04-15T10:43:13.070
> 
> 标签：c++

我有这个数据结构 Seq，它继承了类向量但有一些额外的功能。使用这个数据结构 Seq 我有这个预定义的数据结构：

```
typedef Seq< vector<int> > MxInt2d; 
```

我现在想要一个包含 MxInt2d 类型的几个组件的向量；我在想类似的事情：

```
MxInt2d* loops; 
```

只是我认为我必须初始化这个向量并且我没有它的构造函数。我应该写一个构造函数来初始化它吗？

* * *

因此，如果一方面我将声明以下数据结构：

```
 MxInt2d myEdges_; 
```

然后初始化。另一方面，我的变量循环的声明：

```
 vector<MxInt2d> loops; 
```

如果我想在 loops[0] 中复制 myEdges_ 的前 5 个元素，我将使用以下语法：

```
for (int i=0;i<5;i++)
  loops[0].push_back(myEdges_[i]); 
```

该程序被编译，但是当我运行它时，我收到一条总线错误消息。如果我将初始化用于第二个循环，也会发生同样的事情：

```
for (int i=0;i<5;i++){
    loops[1].push_back(myEdges_[i]);
 } 
```

（对不起，我的判断不好，我对矢量真的很陌生） madalina

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T10:46:27.697

不要使用指针，除非你必须这样做。再次使用`vector`：

```
vector<MxInt2d> loops; 
```

现在，`loops`容器是空的（即里面没有矩阵）。如果您希望它包含 2 个`MxInt2d`对象，则必须插入它们或以`loops`不同方式初始化：

```
// loops will contain two empty MxInt2d objects
vector<MxInt2d> loops(2);

// after the following command,
// loops will contain 3 MxInt3d objects
loops.push_back(MxInt2d()); 
```

只有在您填充之后，`loops`您才能开始填充其元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T10:49:31.387

在进入你的问题之前——一个观察：

你继承了向量吗？导出向量不是一个好主意。所有标准的 STL 容器都缺少虚拟析构函数，并且从没有虚拟析构函数的类公开继承是主要的 C++ 禁忌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:38:13.843

数组在 C++ 中是邪恶的。您可以将向量用于几乎可以使用数组的任何内容。一个常见问题；可以解决初始化的问题。请参阅此讨论[how-to-initialize std::vector like 'C' array](https://stackoverflow.com/questions/231491/how-to-initialize-const-stdvectort-like-a-c-array/661359#661359)。

因此，您可以使用“向量循环；” 没有什么问题。

高温下，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T14:42:19.860

你在这里有几个问题。

一，你不应该从向量派生。如果您需要使用向量执行自定义内容的代码，您应该使用具有向量而不是向量的自定义内容编写一个类。例如：

```
class Seq
{
public:
   // assorted constructors

// construct vec_ with zero elements
   Seq() {}; 

// construct vec_ with one element
   Seq(int singleItemToAdd) 
: vec_(1, singleItemToAdd) {};

// construct vec_ with 'multipleItemsToAdd' elements
   Seq(const int* multipleItemsToAdd, size_t numItemsToAdd) 
: vec_(multipleItemsToAdd,multipleItemsToAdd+numItemsToAdd) {}; 

   // assorted custom operations (instead of deriving from vector)
   void customSeqOperation() const
   {
      /// your custom stuff here
      :   :
   }
private:
   vector<int> vec_;
}; 
```

下一个问题，你说这段代码编译但在运行时崩溃：

```
vector<MxInt2d> loops;
for (int i=0;i<5;i++)
  loops[0].push_back(myEdges_[i]); 
```

如果这是您本质上竞争的代码，那么它崩溃的原因是因为 loops[0] 没有元素——您还没有添加它。您需要在循环中添加一个元素（这是一个向量），然后才能访问第一个：

```
vector<MxInt2d> loops;
MxInt2d firstElement = getTheElement();
loops.push_back(firstElement);   
for (int i=0;i<5;i++)
  loops[0].push_back(myEdges_[i]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T10:49:36.987

从 STL 容器继承不是一个好主意，因为它们没有虚拟析构函数，如果您尝试通过基指针删除派生指针（希望我做对了），这可能会导致行为不足。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T10:51:52.287

实际上，您的数据结构看起来很复杂。通过创建它的指针，您使它变得更加复杂。如果您可以创建 MxInt2d 的数组/向量而不是使其成为指针，那就更好了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T10:52:23.797

不，不一定。std::vector 会将所有元素初始化为 0，因此如果这是您需要的，您将不必编写自定义构造函数。

# java - 为什么在使用方法入口调试时，被调试的程序速度变慢了这么多？

> ID：751105
> 
> 赞同：33
> 
> 时间：2009-04-15T10:43:39.857
> 
> 标签：java, debugging, jdi

我正在使用 jdi 接口创建调试器，当我使用 MethodEntryRequests 启用方法条目跟踪时，被调试程序的速度降低了数十倍。我已将主线程的过滤器和挂起策略设置为 SUSPEND_EVENT_THREAD。Classfilter 是有限的，如果我打印任何收到的事件，它不会显示超过几十个，所以它不应该收到太多。我在本地调试，并在调试后的 java 程序中有以下类型的命令行：

`-Xdebug -Xrunjdwp:transport=dt_socket,suspend=y,server=y,address=1337`

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-24T22:08:04.567

简短的回答是在设置方法条目时执行通过解释器运行。我认为无论如何都没有这...

这曾经是所有在调试模式下运行的代码的情况，但[它在 1.4 中得到了增强](https://docs.oracle.com/javase/8/docs/technotes/guides/jpda/enhancements1.4.html)......现在 HotSpot 可用于“全速”调试，除了方法进入和退出、观察点以及单步或方法中的情况包含断点。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-26T12:36:19.557

2个原因：

1.  它必须对每个方法条目添加检查（没有选项可以仅调整某些方法）
2.  方法内联变得不可能（因此小方法的运行速度要慢 10-100 倍）

分析器和 .net 应用程序也是如此

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-21T03:26:38.887

我假设调试器需要为每个方法调用唤醒，以查看它是否与选择中断的方法匹配。因为它必须在执行之前检查每个方法调用是否存在潜在匹配，所以它比不必执行所有这些检查要慢得多。

# sql - 基于集合的操作和调用存储过程

> ID：751112
> 
> 赞同：6
> 
> 时间：2009-04-15T10:44:59.570
> 
> 标签：sql, sql-server

我正在研究一个存储过程，该过程对课堂上的学生执行一些操作

在最后一步，它根据一些标准更新一些学生的状态。

这一切都很简单，但我在这里进退两难。基本上系统中存在一个名为

```
pUpdateStudentStatus(studentID, statusID, comments, userID) 
```

每当要更新单个用户的状态时，应用程序都会使用此 sp。除了更新状态之外，它还会在 StudentStatusHistory 表中记录更改。

所以这是我的困境，

*   如果我想使用该存储过程，我需要遍历记录（通过光标或自己编写循环）
*   如果我想保持所有操作集为基础，我需要从 pUpdateStudentStatus 复制逻辑（将来可能会改变）

**还有其他选择吗？你会选哪一个？**

我认为使用更新触发器的替代方法不是一种可行的方法，因为我需要一些额外的详细信息，例如更改状态的用户的 userId 和评论

我正在使用 SqlServer2005

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T11:13:25.307

您不会说`pUpdateStudentStatus`是在您的控制之下还是由第三方创建。

如果它是第三方 SP，我认为您除了使用光标/循环之外别无选择，因为 SP 的内部结构可能会在未来的版本中发生变化。

如果 SP 在您的控制之下，另一种选择是创建一个`pUpdateStudentStatus`具有新名称的版本，该版本将以基于集合的方式运行（可能通过接受参数的表变量），然后重写现有的`pUpdateStudentStatus`以充当在参数表中使用单行调用新过程的包装器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T11:13:40.737

就个人而言，除非性能是一个问题（听起来这很可能是偶尔运行的工作，甚至可能安排在工作时间之外），否则我会遍历现有程序。CPU 总是比 DBA/程序员的时间便宜，维护考虑应该优先于效率，除非不这样做会对业务产生影响。无论哪种方式，您都应该记录您为什么采用您在代码中选择的任何方法。

此外，如果您还没有文档制度，我建议您在数据库中设置一个简单的文档表，其中包含（至少）sp 名称和描述性文本。由于存储过程/用户定义函数的性质，除非采用某种策略，否则对已实现的功能进行概览控制可能会很棘手，而且我见过太多的数据库，其中有大量的存储过程/udfs 并且没有探索什么功能在哪里实现的简单方法。如果您的团队支持版本控制和完整文档，则值得称赞，但如果不可用，那么在其内部记录数据库是简单、健壮且快速获胜的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T10:49:38.687

如果你想保持操作集为基础，那么是的，遗憾的是，你需要从`pUpdateStudentStatus`.

您将需要在一方面基于集合的更新的性能和另一方面代码重用（和易于维护）之间做出决定。我知道我通常会选择哪个，但您的选择取决于您对性能的需求与其他考虑因素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T14:06:04.457

如果您正在处理少量记录，循环是可以接受的，但如果批处理变得很大，您将需要基于集合的代码。

如果您最终需要基于集合的逻辑，另一种替代方法是更改​​ proc 以允许基于集合或单独的插入。通过使参数可选（您的 GUI 将需要检查以确保为单个插入传递所有必需的参数）并为要传递的批次号添加一个参数以进行基于集合的操作，您可以将两者的逻辑放在一个过程。

如果批号为空，则执行当前操作。如果通过，则转到 proc 的批处理部分。对于批处理，插入过程可以由另一个生成新批号的过程调用，将要插入的信息插入到工作表中，包括批号。然后它使用 batchnumebr 作为插入过程的输入参数。

您仍然需要为这两种情况编写逻辑，但由于它们在同一个过程中，它们将更容易维护，并且您不太可能忘记更新这两个进程。

# algorithm - 寻找散列算法的伪代码（开放、链接和多重）

> ID：751115
> 
> 赞同：1
> 
> 时间：2009-04-15T10:45:46.637
> 
> 标签：algorithm, hashtable, pseudocode

您好，我正在寻找“开放”、“链接”和“多重哈希”算法的伪代码。是的，我一直在谷歌上寻找大量的时间，但我没能找到好的东西。

如果你有链接分享，我会很感激

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T11:29:00.277

这个[哈希表教程](http://eternallyconfuzzled.com/tuts/datastructures/jsw_tut_hashtable.aspx)有打开和链接冲突解决的例子。

[Bob Jenkins 的网站](http://www.burtleburtle.net/bob/)有更多关于散列表、完美散列和高效散列函数的示例。

我还没有找到对多重散列的令人满意的解释（特别是为什么组合两个不同的 32 位散列被认为比平滑的 64 位散列更好）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:02:25.380

[http://en.wikipedia.org/wiki/Cryptographic_hash_function](http://en.wikipedia.org/wiki/Cryptographic_hash_function)
然后从那里：

*   [http://en.wikipedia.org/wiki/MD5#Pseudocode](http://en.wikipedia.org/wiki/MD5#Pseudocode)
*   [http://en.wikipedia.org/wiki/SHA_hash_functions#Examples_and_pseudocode](http://en.wikipedia.org/wiki/SHA_hash_functions#Examples_and_pseudocode)

等等

# c++ - 与 Boost 的正则表达式区分大小写的部分匹配

> ID：751119
> 
> 赞同：0
> 
> 时间：2009-04-15T10:47:30.750
> 
> 标签：c++, regex, boost

从下面的代码中，我希望从相应的输入中得到这个输出：

```
Input: FOO     Output: Match
Input: FOOBAR  Output: Match
Input: BAR     Output: No Match
Input: fOOBar  Output: No Match 
```

但为什么它为输入 FOOBAR 提供“不匹配”？

```
#include <iostream>
#include <vector>
#include <fstream>
#include <sstream>
#include <boost/regex.hpp>
using namespace std;
using namespace boost;

int main  ( int arg_count, char *arg_vec[] ) {
   if (arg_count !=2 ) {
       cerr << "expected one argument" << endl;
       return EXIT_FAILURE;
   }

   string InputString = arg_vec[1];
   string toMatch = "FOO";

   const regex e(toMatch);
   if (regex_match(InputString, e,match_partial)) {
       cout << "Match" << endl;
   } else {
       cout << "No Match" << endl;
   }

   return 0;
} 
```

**更新：**

最后，它使用以下方法：

```
#include <iostream>
#include <vector>
#include <fstream>
#include <sstream>
#include <boost/regex.hpp>
using namespace std;
using namespace boost;

bool testSearchBool(const boost::regex &ex, const string st) {
    cout << "Searching " << st << endl;
    string::const_iterator start, end;
    start = st.begin();
    end = st.end();
    boost::match_results<std::string::const_iterator> what;
    boost::match_flag_type flags = boost::match_default;
    return boost::regex_search(start, end, what, ex, flags);
}

int main  ( int arg_count, char *arg_vec[] ) {
    if (arg_count !=2 ) {
        cerr << "expected one argument" << endl;
        return EXIT_FAILURE;
    }

    string InputString = arg_vec[1];
    string toMatch = "FOO*";

    static const regex e(toMatch);
    if ( testSearchBool(e,InputString) ) {
        cout << "MATCH" << endl;
    }
    else {
         cout << "NOMATCH" << endl;
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T11:48:49.963

使用`regex_search`而不是`regex_match`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T10:59:05.560

您的正则表达式必须考虑子字符串“FOO”开头和结尾的字符。我不确定，但“FOO*”可能会奏效

如果在文本输入的末尾找到部分字符串，而不是开头，则 match_partial 只会返回 true。

> 部分匹配是匹配文本输入末尾的一个或多个字符，但不匹配所有正则表达式（尽管如果有更多输入可用，它可能已经匹配）

所以与“FOO”匹配的 FOOBAR 将返回 false。正如另一个答案所暗示的那样，使用 regex.search 可以让您更有效地搜索子字符串。

# google-app-engine - 如何在 Google App Engine 的 Datastore 模型中获取行数？

> ID：751124
> 
> 赞同：27
> 
> 时间：2009-04-15T10:49:04.070
> 
> 标签：google-app-engine, google-cloud-datastore

我需要获取 App Engine 上特定模型的记录计数。如何做到这一点？

我批量上传了 4000 多条记录，但 modelname.count() 只显示 1000 条。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-06T15:36:35.177

您应该使用[数据存储统计信息](https://developers.google.com/appengine/docs/java/datastore/stats)：

```
Query query = new Query("__Stat_Kind__");
query.addFilter("kind_name", FilterOperator.EQUAL, kind);       
Entity entityStat = datastore.prepare(query).asSingleEntity();
Long totalEntities = (Long) entityStat.getProperty("count"); 
```

请注意，上述内容不适用于开发数据存储区，但可用于生产（发布时）。

我看到这是一篇旧帖子，但我添加了一个答案，以帮助其他人搜索相同的内容。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-15T12:45:05.867

从 1.3.6 版开始，计数查询不再有 1,000 个上限。因此，您可以执行以下操作来获得超过 1,000 的计数：

```
count = modelname.all(keys_only=True).count() 
```

这将计算您的*所有*实体，如果您有大量实体，这可能会相当慢。因此，您应该考虑`count()`使用指定的限制进行调用：

```
count = modelname.all(keys_only=True).count(some_upper_bound_suitable_for_you) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-03-08T16:12:27.013

这是一个非常古老的线程，但为了防止其他人看到它，有 3 种方法可以完成此操作：

1.  访问数据存储统计信息
2.  在数据存储中保留一个计数器
3.  分片计数器

[此链接中解释](http://www.shiftedup.com/2015/03/08/how-to-count-all-entries-of-a-given-type-in-the-app-engine-datastore)了这些方法中的每一种。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-05-14T09:48:13.820

```
count = modelname.all(keys_only=True).count(some_upper_limit) 
```

只是为了添加到 dar 之前的帖子，必须指定这个 'some_upper_limit'。如果不是，默认计数仍将是最大值 1000。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-30T03:05:58.103

在 GAE 中，当您拥有超过 1000 个对象时，计数总是会让您翻阅结果。处理此问题的最简单方法是向模型或不同的计数器表添加计数器属性，并在每次创建新对象时更新它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-11-20T21:45:26.790

我仍然使用计数达到了 1000 的限制，所以改编了 dar 的代码（我的有点快和脏）：

```
class GetCount(webapp.RequestHandler):
    def get(self):
        query = modelname.all(keys_only=True)

        i = 0
        while True:
            result = query.fetch(1000)
            i = i + len(result)
            if len(result) < 1000:
                break
            cursor = query.cursor()
            query.with_cursor(cursor)

        self.response.out.write('<p>Count: '+str(i)+'</p>') 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-12-06T13:22:06.153

另一种解决方案是使用仅键查询并获取迭代器的大小。此解决方案的计算时间将随着条目的数量线性增加：

```
Datastore datastore = DatastoreOptions.getDefaultInstance().getService();
KeyFactorykeyFactory = datastore.newKeyFactory().setKind("MyKind");
Query query = Query.newKeyQueryBuilder().setKind("MyKind").build();
int count = Iterators.size(datastore.run(query)); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-03-23T15:47:54.363

```
DatastoreService ds = DatastoreServiceFactory.getDatastoreService();
Query query = new Query("__Stat_Kind__");
Query.Filter eqf = new Query.FilterPredicate("kind_name",
                                Query.FilterOperator.EQUAL,
                                "SomeEntity");
query.setFilter(eqf);
Entity entityStat = ds.prepare(query).asSingleEntity();
Long totalEntities = (Long) entityStat.getProperty("count"); 
```

# windows - 视觉小尺寸语言

> ID：751129
> 
> 赞同：2
> 
> 时间：2009-04-15T10:50:51.087
> 
> 标签：windows, visual-studio, user-interface, lazarus

我需要开发一个包含 6 或 7 个表单的简单 Windows 应用程序。它的主要目的是管理文件和启动外部程序。

这些是我的愿望，按重要性降序排列

1.  自由的
2.  Be Visual，我的意思是，在屏幕上绘制形式和对象的可能性。
3.  可以将它放在 USB 笔式驱动器中。

我需要一种轻型/小型语言，而不是一种非常复杂的语言。我的程序将只有很少的表单，而且它的功能很简单。

有没有符合这个愿望的语言？如果没有，是否有任何商业用途？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T10:53:15.463

如果我是你，我会使用[Visual C# Express 。](http://www.microsoft.com/express/vcsharp/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T09:01:27.090

正如其他人所建议的那样，C# 不是一个糟糕的选择。

我个人会使用[wxPython](https://stackoverflow.com/questions/115495/is-python-any-good-for-gui-development/115654#115654)。如果您想要一个 GUI 来帮助您布置表单，[wxDesigner](http://www.roebling.de/)非常好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-02T16:08:24.630

再次投票给拉撒路/自由帕斯卡。它从棒上工作，并生成（在 Windows 32/64/CE 上）独立二进制文件，您可以完全访问 windows api 和其他windwos 特定小工具（COM）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T19:08:25.263

看看[Visual Basic Express](http://www.microsoft.com/express/vb/Default.aspx)。IMNTBHO，VB.Net 的学习曲线比 C# 等价物要浅。

如果做不到这一点（尽管这么说让我很痛苦），请查看 MS-Access（以及随身携带的运行时安装）。它不是免费的，但也不是很贵。学习曲线甚至比 VB.Net 还要浅。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T19:35:10.847

您提到希望您的程序可以在 USB 驱动器上移植，因此只要您将使用您的程序的所有机器都安装了 .Net 框架，之前建议 C# 和 VB.Net 的答案就很好。

如果您需要在没有 .Net 的系统上运行您的程序，您需要查看可以生成本机 .exe 或可以将脚本包装在可执行文件中的编程环境。哪个是正确的取决于您的需求和编程经验，但我会看看[Lazarus/Free Pascal](http://www.lazarus.freepascal.org/)、[C++](http://msdn.microsoft.com/en-us/visualc/default.aspx)或[Python](http://www.python.org/)（使用[py2exe](http://www.py2exe.org/)）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T09:03:44.043

Visual Studio Express 版本似乎很适合您的要求。

检查： http: [//www.microsoft.com/Express/](http://www.microsoft.com/Express/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T16:18:13.373

我推荐[Turbo Explorer](http://www.codegear.com/downloads/free/turbo)。它是一个免费的 RAD IDE，可以在 C++ 或 Delphi 中生成本机 win32 应用程序，而不需要像 .NET 这样的托管框架。

使用起来再简单不过了。只需将组件拖放到表单上，编译并运行。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-02T16:40:21.260

我通常会在 .NET 框架上推动 C# 或其他东西，但是在闪存盘上运行的规定意味着您需要可以本机编译的东西。除了上面提到的 Lazarus/FreePascal，你可能还想研究[CodeGear Delphi](http://www.codegear.com/products/delphi)

# tcp - 哪种方法更适合在两个进程之间发送图像流，本地 TCP/IP 连接或进程间通信？

> ID：751134
> 
> 赞同：1
> 
> 时间：2009-04-15T10:54:25.587
> 
> 标签：tcp, stream, interprocess

假设我必须复制流中的每个图像（我不能简单地使用任何互斥保护访问该数据，无论如何都必须复制它），哪种方法更好，优点/缺点？

我还想知道与在同一过程中使用图像相比，这意味着多少性能损失。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T10:56:34.880

[对于图像，通过共享内存](http://www.cs.cf.ac.uk/Dave/C/node27.html)进行IPC将是最佳选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:00:01.657

至少 Windows 的防火墙会干扰本地 TCP/IP 连接。因此我更喜欢共享内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:07:05.337

在性能方面，通过共享内存进行 IPC 是最好的选择，但恕我直言，即使套接字消耗更多的处理，它们也会在软件的进化性方面为您提供更好的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T11:27:37.847

谷歌“内存映射文件”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-29T05:10:13.440

我将采用 DirectShow 捕获设备的 VCAM 示例（可在： [http](http://tmhare.mvps.org/downloads/vcam.zip) ://tmhare.mvps.org/downloads/vcam.zip 获得）

此驱动程序在 O/S 中显示为视频捕获设备，并将在目标进程中运行。源将使用共享内存缓冲区为其注入帧。

虽然比最小共享内存 IPC 方案更复杂，但它提供了令人难以置信的优势，因为您的视频管道可以连接到大多数媒体播放器程序、捕获和编辑工具等。

我已经做过好几次了，包括像接收器、混音器、Freeframe 效果插件等功能。应该需要一两天的时间来破解。

# c++ - 在 C++ 中使用类型名作为函数参数时如何传递引用？

> ID：751136
> 
> 赞同：3
> 
> 时间：2009-04-15T10:55:18.533
> 
> 标签：c++, templates

我对模板有一些奇怪的问题。当尝试传递参数化迭代器时，它抱怨找不到函数。代码片段在这里，忘记功能，它使用对模板化迭代器的引用，这是我感兴趣的

```
#include <list>
#include <iostream>

template<typename T>
void print_list_element(typename std::list<T>::iterator& it){
    std::cout << *it << std::endl;
}

int main() {
    std::list<int> theList;
    theList.push_back(1);

    std::list<int>::iterator it = theList.begin();
    print_list_element(it);

    return 0;
} 
```

如果您尝试使用 g++ v4.3.2 编译它，它会抱怨一条消息：

```
main.cpp:14: error: no matching function for call to 'print_list_element(std::_List_iterator<int>&)' 
```

我写的代码有问题还是 g++ 需要更多信息？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T11:01:38.533

g++ 无法确定`print_list_element`它应该使用哪个模板重载。如果您明确指定模板参数，它会起作用：

```
print_list_element<int>(it); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T13:25:36.877

更好的方法是编写这样的函数：

```
template<typename Iter>
void print_element(Iter it){
    std::cout << *it << std::endl;
} 
```

这现在适用于任何类型的迭代器，而不仅仅是`std::list<T>::iterator`. 此外，模板类型将从参数中正确推断。

我意识到这是一个人为的例子，但几乎总是你可能不想传递`list<T>::iterator`给函数。在最坏的情况下，至少是 ListType 上的模板，以便您的代码可以使用带有自定义分配器的列表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T11:05:10.427

这是非法的，因为 std::list< T >::iterator 不是标准所谓的适当推导上下文

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-15T12:36:37.773

其他回答是正确的，但为了完整起见，我将补充一点，按照设计，C++ 只能*在某些情况下*自动推断模板参数，而这不是其中之一。

想一想，你就会意识到，这种情况下的自动扣除会导致不良情况。 `std::list<T>::iterator`不是一个真正的类型，它只是一个`typedef`真正类型的别名（例如它可能是`T*`），它立即被翻译成，所以编译器必须建立某种“反向索引”以便映射`T*`回`std::list<T>::iterator`自动推导来`T`这里工作。但是，一旦创建了另一个类模板，该类模板具有一个被调用的类型成员，这种映射就会中断`iterator`——`typedef`然后`T*`编译器将有两种选择要翻译`T*`成什么，并且无法在它们之间进行选择。*显然，当一个不相关的类添加一个特定的类*时，任何自动扣除策略都会中断*`typedef`类型成员*太脆弱而无法工作。

# sql - 如何从 MS SQL 中的表中单独获取最高的“N'th Maximum”值？

> ID：751141
> 
> 赞同：1
> 
> 时间：2009-04-15T10:57:26.467
> 
> 标签：sql, sql-server

假设有一个 'Employee' 表，其中一列是薪水。

我想从表格中单独获得“前 N”的最高薪水。

这怎么能轻易拿到？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T11:00:16.430

```
SELECT TOP 1 employee.name, employee.salary from (
    SELECT TOP N employee.name, employee.salary
    FROM employee
    ORDER BY employee.salary DESC ) 
```

这给出了从顶部开始的第 N 个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T11:11:30.477

```
WITH    (
        SELECT  e.*, ROW_NUMBER() OVER (ORDER BY employee.salary DESC) AS rn
        FROM    employee
        ) AS q
SELECT  *
FROM    q
WHERE   rn = @n 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-14T11:46:05.310

```
SELECT TOP 1 E.Salary
FROM (SELECT TOP(N) Salary
      FROM Employee
      ORDER BY Salary DESC) E
ORDER BY E.Salary 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T10:58:47.480

```
SELECT TOP N employee.name, employee.salary
FROM employee
ORDER BY employee.salary DESC 
```

?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T10:59:28.507

```
SELECT TOP 1 Salary FROM
(SELECT TOP(N) Salary FROM Employee
ORDER BY Salary DESC) E 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-15T11:24:37.790

```
 SELECT TOP 1 * FROM Employees
    ORDER BY Employees.Salary DESC 
```

# asp.net-mvc - 将数据从视图传递到操作？？解决方案？

> ID：751142
> 
> 赞同：1
> 
> 时间：2009-04-15T10:58:14.627
> 
> 标签：asp.net-mvc

我正在尝试将用户 ID（整数）从视图发送到操作。如果我使用 routevalues 对象传递它，则用户 ID 将在浏览器地址栏中可见。如何在不使用上述方法的情况下将用户 ID 从视图传递到操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T11:02:41.713

用户 ID 通常是从您的身份验证机制（cookie 等）中推断出来的，因此对于*当前*用户，您不需要传递它。

*您将*其包含在请求中的主要时间是当显示的页面*与*用户相关时 - 特别是您（或管理员）想要浏览其他用户记录的地方 - 然后您可以使用“/users/current/orders”（使用 cookie）或“/users/12345/orders”（您应该验证浏览 12345 的权限）。

请注意，如果您使用 /current/ 或类似的，您应该确保它不会在不同用户之间缓存 - 因此在许多方面，只显示用户 ID 并使用 url 更简单；只需选择简单的“/users/12345/orders”案例即可。

这里的场景是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:12:15.403

您可以在表单中使用隐藏的输入元素。对于正在更改系统中数据的任何内容，您通常应该使用 POST，而不是 GET（即使用表单，而不是 a href）。

# sql - sql查询中的最大计数

> ID：751156
> 
> 赞同：1
> 
> 时间：2009-04-15T11:00:16.557
> 
> 标签：sql, oracle10g

我在 oracle 数据库中有下表（简化）：

```
productId  |  modelDescription 
         1 |             thing
         2 |     another thing
         3 |       not a thing
         4 |             thing 
```

我想选择此表中出现次数最多的模型描述。问题是可能有几乎无限的模型描述。所以结果集应该是这样的：

```
modelDescription | appearance 
           thing |          2 
   another thing |          1 
             ... |        ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T11:02:33.447

```
select modeldescription, count(modeldescription) 
from products 
group by modeldescription
order by 2 desc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:12:03.000

此外，如果您只想要最高添加以下内容：

选择**Top 1**型号描述......

# c - 提前以编程方式确定文件“磁盘大小”

> ID：751157
> 
> 赞同：2
> 
> 时间：2009-04-15T11:00:42.450
> 
> 标签：c, windows, winapi, diskspace, filesize

在写入之前，我需要知道给定的内存缓冲区作为磁盘（USB 棒）文件有多大。我知道除非大小落在块大小边界上，否则它可能会被四舍五入，例如，一个 1 字节的文件在磁盘上占用 4096 字节。我目前正在使用*GetDiskFreeSpace()*来计算磁盘块大小，然后使用它来计算磁盘大小，如下所示：

```
GetDiskFreeSpace(szDrive, &dwSectorsPerCluster, 
                 &dwBytesPerSector, NULL, NULL);

dwBlockSize = dwSectorsPerCuster * dwBytesPerSector;

if (dwInMemorySize % dwBlockSize != 0)
{
    dwSizeOnDisk = ((dwInMemorySize / dwBlockSize) * dwBlockSize) + dwBlockSize;
}
else
{
    dwSizeOnDisk = dwInMemorySize;
} 
```

这似乎工作正常，**但** *GetDiskFreeSpace()*根据 MSDN 仅适用于高达 2GB 的磁盘。*GetDiskFreeSpaceEx()*不会返回相同的信息，所以我的问题是，我还能如何计算大于 2GB 的驱动器的此信息？有没有我错过的 API 调用？我可以根据整体磁盘大小假设一些硬值吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T12:55:52.220

MSDN 仅声明该`GetDiskFreeSpace()`函数不能报告大于 2GB的**卷大小。**它可以很好地检索每个集群的扇区和每个扇区的字节数，我自己将它用于非常相似的代码;-)

但如果您也需要磁盘容量，则需要额外调用`GetDiskFreeSpaceEx()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T14:02:48.113

磁盘上文件的大小是一个模糊的概念。在 NTFS 中，文件由一组数据元素组成。您主要考虑的是“未命名的数据流”。这是一个文件的属性，如果它很小，可以与目录条目中的其他属性一起打包。[显然](http://en.wikipedia.org/wiki/NTFS#Resident_vs._non-resident_files)，您可以在目录条目本身中存储多达 700-800 字节的数据流。因此，您假设的 1 字节文件将与 0 字节或 700 字节文件一样大。

另一个影响是文件压缩。这将使磁盘上的大小可能小于内存中的大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:30:24.407

您应该能够使用 DeviceIoControl 函数和
DISK_GEOMETRY_EX 获得此信息。它将返回一个包含您正在寻找的信息的结构，我认为

[http://msdn.microsoft.com/en-us/library/aa363216(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa363216(VS.85).aspx)

[http://msdn.microsoft.com/en-us/library/ms809010.aspx](http://msdn.microsoft.com/en-us/library/ms809010.aspx)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2010-06-11T11:37:07.857

在动作脚本中！

```
var size:Number = 19912;
var sizeOnDisk:Number = size;
var reminder:Number = size % (1024 * 4);
if(reminder>0){
    sizeOnDisk = size + ((1024 * 4)- reminder)
}
trace(size)
trace(sizeOnDisk) 
```

# c# - 引用类型自动属性的自动实例化

> ID：751158
> 
> 赞同：2
> 
> 时间：2009-04-15T11:00:44.057
> 
> 标签：c#, .net

我是唯一想要这个的人吗？它似乎是可以合理地为任何具有公共无参数构造函数的类提供的东西。现在必须在使用它们的类的构造函数中实例化这些属性，这在某种程度上消除了自动属性的便利性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T11:23:58.307

我希望能够指定所需的线程安全程度。特别是，您是否需要发出锁定代码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T11:06:32.250

确实，这可能有用，但它就是这样。在 C# 4.0 中没有这方面的迹象，因此您只需使用构造函数或字段（以及手动属性实现）。

重新考虑您的“对于任何具有公共无参数构造函数的类” - 实际上，我假设任何实现都可以直接与字段初始值设定项相媲美，因此无论构造函数组合如何都可以工作。

# python - 如何使用 wx.lib.docview 包？

> ID：751159
> 
> 赞同：2
> 
> 时间：2009-04-15T11:00:46.710
> 
> 标签：python, user-interface, wxpython, docview

我目前正在开发一个基本上基于文档的简单 wxPython 应用程序。到目前为止，我一直在手动实现通常的打开/保存/撤消/重做等内容。

我突然想到 wxPython 一定有一些东西可以帮助我，经过一番搜索后发现了[docview 包](http://www.wxpython.org/docs/api/wx.lib.docview-module.html)。

在这一点上，虽然我只是不太确定如何将所有东西连接起来并开始工作。任何人有任何关于从哪里开始的好链接或提示？

文档似乎对此有点薄，而且 Robin Dunn 的 wxPython 书根本没有真正涵盖这个包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:52:38.093

您可以查看 [wxPython Docs and Demos](http://wxpython.org/download.php)中的 docviewdemo.py ：

在我的机器上，它们位于：

*   C:\Program Files\wxPython2.8 Docs and Demos\samples\pydocview\
*   C:\Program Files\wxPython2.8 Docs and Demos\samples\docview\

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-30T18:22:46.077

除了提到的之外，samples\ide 中还有一个相当广泛的示例 docview/pydocview。如果您希望它运行，您将不得不进行一些代码更正（我已在 trac.wxwidgets.org #11237 提交了一份概述修复程序的票证）。它非常复杂，但我发现弄清楚如何做一些更复杂的事情很方便。例如，samples\ide\activegrid\tools\ProjectEditor.py 是从头开始构建的，并且具有撤消支持等，而不仅仅是依赖于已经为您完成所有工作的控件。这样你就可以在细节层面看到事情应该如何完成。在这方面，文档是相当无用的。

如果您决定不使用 docview/pydocview，我有一个基于 wxPython 构建的电子表格应用程序，您可能会发现它作为示例很有用。虽然它没有实现文档视图框架，但它确实具有它的一些特性，并且我已经实现了一个撤消/重做系统。[在http://www.missioncognition.net/pysheet/](http://www.missioncognition.net/pysheet/)查看它 我目前正在开发一个基于 pydocview 的应用程序，所以我希望它最终会出现在我的网站上。

# java - SQL 中 MySQL 和 SQLite 的区别

> ID：751160
> 
> 赞同：10
> 
> 时间：2009-04-15T11:00:52.153
> 
> 标签：java, mysql, sqlite, jdbc

我正在编写使用**JDBC同时使用****SQLite**和**MySQL的 java 应用程序。**

 **这些数据库的**SQL**有什么不同吗？我可以对**SQLite**和**MySQL**使用相同的查询，还是有任何数据库特定的东西，对另一个不起作用？

到目前为止，我只使用过**MySQL ，所以我对****SQLite**不太了解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T11:17:52.143

如果你坚持使用[ANSI SQL92](http://en.wikipedia.org/wiki/SQL-92)，你应该没问题。

MySQL 和 SQLite 都缺少一些 SQL92 特性（例如，FULL OUTER JOIN）。MySQL 有 RIGHT JOIN 和 LEFT JOIN，SQLite 只有 LEFT JOIN。SQLite 不支持 FOREIGN KEY 约束，MySQL 也不支持 MyISAM 表。SQLite 当然没有 GRANT/REVOKE，因为权限系统基于底层操作系统的文件权限。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-08-18T20:07:25.073

我正在做类似的事情。除了我遇到的那些提到的差异之外，还有一些差异：

*   在带有 Xerial JDBC 驱动程序的较新版本的 SQLite3 中，确实支持外键。SQLite 支持内联外键约束定义：
    CREATE TABLE Blah (foreignId Integer REFERENCES OtherTable (id));

    MySQL（使用 InnoDB）将*接受*相同的语法，但实际上不会强制执行约束，除非您使用单独的 FOREIGN KEY 子句显式命名外部表和键列：
    CREATE TABLE Blah (foreignId INTEGER, FOREIGN KEY foreignId参考其他表（id））；

*   旧版本的 SQLite JDBC 驱动程序不支持 Statement.RETURN_GENERATED_KEYS；在较新的 Xerial 驱动程序中修复。

*   自动递增键的语法不同；SQLite: (id INTEGER PRIMARY KEY ASC, ...); MySQL: (id INTEGER PRIMARY KEY AUTO_INCREMENT, ...)

*   SQLite 接受 n 路逗号分隔连接：
    SELECT * FROM A, B, C ON (Ax = By AND By = Cz);

    MySQL 没有；以下适用于两者：
    SELECT * FROM A INNER JOIN B ON Ax = By INNER JOIN C ON By = Cz;

*   关于类型差异，与 SQLite 的 JDBC 驱动程序相关的一个烦恼是同一列可以通过 ResultSet.getObject(.); 生成不同的类型；例如，一个 Integer 或 Long 取决于包含的数字的大小。

*   SQLite 中的自增键必须声明为 INTEGER 类型；在 MySQL 中，任何数字整数类型都有效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-12T06:19:21.537

一个很大的区别是[类型系统](http://www.sqlite.org/datatype3.html)。SQLite 允许您将任何类型的数据放在任何列中。但是，如果可能，它会将数据转换为列的声明类型。

# c# - 在一组中使用 Visual Studio 2008 和 2005

> ID：751163
> 
> 赞同：3
> 
> 时间：2009-04-15T11:01:05.320
> 
> 标签：c#, visual-studio

我们有一个使用 vs 2005 的团队。我们想升级到 vs 2008，但希望逐步升级。如果我们团队中有几个人升级到 2008（仍然针对 2.0 框架），而其他从事相同解决方案的人继续使用 2005，这会导致任何问题。

*   解决方案或项目文件是否因此而改变？
*   是否有任何向后兼容性问题需要处理或其他冲突会迫使团队进行大爆炸式升级？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T11:07:45.727

为什么要增量升级？在使用 Visual Studio 2008 时，您仍然可以面向 .NET 2.0。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T11:04:50.257

不会工作。2k8 升级您的解决方案。

* * *

让我来证明这一点。解决方案，一旦升级，2005年就打不开了。相信个别项目可以。

因此，一种解决方案可能是制作解决方案的副本，将其命名为 project.2005.sln，然后升级原始解决方案并将其命名为 project.2008.sln。

我的盒子里没有 2k5，所以我无法测试这个。这很简单，只要您事先完全签入，就可以无损地进行测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:09:56.220

您可以通过重命名所有解决方案/项目文件（不理会实际源代码）来实现这一点 - 然后您的团队成员可以加载适合他们的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T11:12:26.183

对于 C#，项​​目文件几乎相同（不同的版本号、新的目标平台属性）。然而，VS2008 将始终尝试“转换”旧的 VS2005 文件，而 VS2005 拒绝打开新文件。因此，混合环境不是很实用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T11:24:18.743

我们对混合 VS 版本所做的是在 2005 年创建解决方案，并设置所有项目。然后将其检查到 SourceSafe（或您使用的任何东西）。然后使用VS2008的用户在他的机器上本地升级解决方案，然后撤消VS2008在升级解决方案时所做的签出，然后每个人都可以同时处理该项目，只要不对解决方案文件进行任何更改！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T11:09:41.447

据我所知，升级到 VS 2008 时更改的是解决方案文件 (*.sln)，而不是项目文件*.csproj/* .vbproj。因此，如果您有不同的 .sln 文件，您可以将两个 IDE 用于同一个神。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T11:10:48.073

部分可能，但必须小心。

*   需要一个版本控制系统（并使用基于 2005/2008 的配置构建服务器）
*   根据 VS.NET 版本分离解决方案和项目文件。每个人都应该只打开相应的 .sln van .proj 文件。（关于项目文件更改的一些提示：[VS.NET 2005 中的 .NET 2.0 项目！= VS.NET 2008 中的 .NET 2.0 项目](http://geekswithblogs.net/dlussier/archive/2007/11/22/117050.aspx)）
*   可以提交常见的 C#/VB.NET 源文件、XML 文件。其他文件 - 比如说 .resx - 可能会导致疼痛。

我认为将所有项目切换到 VS.NET 2008 会更容易。

VS.NET 2088 的一个注释：我们对 WinForms 设计器有奇怪的体验，并且在构建后有一些冻结。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T13:07:35.563

大约 6 个月以来，我们一直在做您想做的事情。

我们的经验仅限于 Web 应用程序、类库和基本的 WinForms 项目。但我们对 2005 年和 2008 年之间的开发人员分裂没有任何问题。

您将需要两个单独的解决方案文件（一个用于 2005，一个用于 2008），但它们的区别仅在于一个包含字符串“9.0”而另一个包含字符串“10.0”。

项目文件将在 2008 年进行修改，但它基本上只添加了到 2005 年被忽略的新属性。

**根据我的经验，2008 项目文件与 2005 兼容。2008 解决方案文件不是，但创建兼容副本是一项简单的任务，将“9.0”替换为“10.0”，反之亦然。**

如果您正在处理 Web 应用程序项目，您应该对项目文件进行一项额外的更改，以便它与两个版本兼容。

[有关详细信息，请在此处](https://stackoverflow.com/questions/615173/developers-with-vs-2005-and-vs-2008-working-on-the-same-projects/615690#615690)和[此处](https://stackoverflow.com/questions/554007/visual-studio-plugin-to-allow-opening-2005-solutions-with-2008/554498#554498)查看我的答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T13:14:57.917

2008 年与 2005 年相比，2008 年大爆炸。我没有发现任何转换项目的问题。

# c# - System.Data.SQLite 参数问题

> ID：751172
> 
> 赞同：11
> 
> 时间：2009-04-15T11:02:43.757
> 
> 标签：c#, parameters, system.data.sqlite

我有以下代码：

```
try
{
    //Create connection
    SQLiteConnection conn = DBConnection.OpenDB();

    //Verify user input, normally you give dbType a size, but Text is an exception
    var uNavnParam = new SQLiteParameter("@uNavnParam", SqlDbType.Text) { Value = uNavn }; 
    var bNavnParam = new SQLiteParameter("@bNavnParam", SqlDbType.Text) { Value = bNavn };
    var passwdParam = new SQLiteParameter("@passwdParam", SqlDbType.Text) {Value = passwd};
    var pc_idParam = new SQLiteParameter("@pc_idParam", SqlDbType.TinyInt) { Value = pc_id };
    var noterParam = new SQLiteParameter("@noterParam", SqlDbType.Text) { Value = noter };
    var licens_idParam = new SQLiteParameter("@licens_idParam", SqlDbType.TinyInt) { Value = licens_id };

    var insertSQL = new SQLiteCommand("INSERT INTO Brugere (navn, brugernavn, password, pc_id, noter, licens_id)" +
    "VALUES ('@uNameParam', '@bNavnParam', '@passwdParam', '@pc_idParam', '@noterParam', '@licens_idParam')", conn);
    insertSQL.Parameters.Add(uNavnParam); //replace paramenter with verified userinput
    insertSQL.Parameters.Add(bNavnParam);
    insertSQL.Parameters.Add(passwdParam);
    insertSQL.Parameters.Add(pc_idParam);
    insertSQL.Parameters.Add(noterParam);
    insertSQL.Parameters.Add(licens_idParam);
    insertSQL.ExecuteNonQuery(); //Execute query

    //Close connection
    DBConnection.CloseDB(conn);

    //Let the user know that it was changed succesfully
    this.Text = "Succes! Changed!";
}
catch(SQLiteException e)
{
    //Catch error
    MessageBox.Show(e.ToString(), "ALARM");
} 
```

它执行得很好，但是当我查看我的“brugere”表时，它已经插入了值：'@uNameParam'、'@bNavnParam'、'@passwdParam'、'@pc_idParam'、'@noterParam'、'@licens_idParam' 从字面上看. 而不是替换它们。

我尝试过设置断点并检查参数，它们确实具有正确的分配值。所以这也不是问题。

我现在一直在修补这个，没有运气，有人可以帮忙吗？

哦，作为参考，这里是 DBConnection 类中的 OpenDB 方法：

```
public static SQLiteConnection OpenDB()
{
    try
    {
        //Gets connectionstring from app.config
        const string myConnectString = "data source=data;";

        var conn = new SQLiteConnection(myConnectString);
        conn.Open();
        return conn;
    }

    catch (SQLiteException e)
    {
        MessageBox.Show(e.ToString(), "ALARM");
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-15T11:07:55.443

您应该删除 INSERT 语句中参数名称周围的引号。

所以而不是

```
VALUES ('@uNameParam', '@bNavnParam', '@passwdParam', '@pc_idParam',
        '@noterParam', '@licens_idParam') 
```

采用

```
VALUES (@uNameParam, @bNavnParam, @passwdParam, @pc_idParam,
        @noterParam, @licens_idParam) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T12:00:30.233

感谢 rwwilden 和 Jorge Villuendas，答案是：

```
var insertSQL = new SQLiteCommand("INSERT INTO Brugere (navn, brugernavn, password, pc_id, noter, licens_id)" +
" VALUES (@uNavnParam, @bNavnParam, @passwdParam, @pc_idParam, @noterParam, @licens_idParam)", conn);
insertSQL.Parameters.AddWithValue("@uNavnParam", uNavn);
insertSQL.Parameters.AddWithValue("@bNavnParam", bNavn);
insertSQL.Parameters.AddWithValue("@passwdParam", passwd);
insertSQL.Parameters.AddWithValue("@pc_idParam", pc_id);
insertSQL.Parameters.AddWithValue("@noterParam", noter);
insertSQL.Parameters.AddWithValue("@licens_idParam", licens_id);

insertSQL.ExecuteNonQuery(); //Execute query 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-02-13T16:29:37.187

当您使用`System.Data.SqlClient`then 您提供来自`System.Data.SqlDbType`枚举的参数类型。

**但是**如果你使用`System.Data.SQLite`，那么你必须使用`**System.Data.DbType**`枚举。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-13T12:47:37.190

代替

> 值（'@uNameParam'、'@bNavnParam'、'@passwdParam'、'@pc_idParam'、'@noterParam'、'@licens_idParam'）

和

> 值（？，？，？，？，？，？）

# .net - Redmon 重定向到 .NET Windows.Forms 应用程序

> ID：751182
> 
> 赞同：1
> 
> 时间：2009-04-15T11:05:44.653
> 
> 标签：.net, winforms, redmon

我有一个有趣的任务：编写一个程序来捕获来自名为[Redmon](http://pages.cs.wisc.edu/~ghost/redmon/)的程序的输入。它基本上是一个将输出重定向到程序的虚拟打印机。

我安装了 Redmon 并创建了一个 winforms 应用程序来捕获输出。但我被困在这里。我检查了我的程序收到了什么，它在参数级别上什么都没有（主参数上的字符串 [] 是空的）。

Redmon 启动我的程序，但随后它停止了。我想我应该以某种方式阅读它发送给程序的内容，但是如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T11:19:02.267

我假设 Redmon 流到标准输入 - 在这种情况下，您必须从输入流中读取 - 通过 Console.In（如果它是基于字符的）或 Console.OpenStandardInput（用于原始二进制流访问）。

作为从 stdin 读取的内容的一个简单示例（它读取文本行，每行反转）：

```
static void Main() {
    WriteReversedLines(Console.In);
}
static void WriteReversedLines(TextReader reader) {
    string line;
    while ((line = reader.ReadLine()) != null) {
        char[] chars = line.ToCharArray();
        Array.Reverse(chars);
        Console.WriteLine(chars);
    }
} 
```

显然，您需要稍微不同地处理二进制数据，但在概念上它是相似的。

# c# - 强制 .NET JIT 编译器在应用程序启动期间生成最优化的代码

> ID：751186
> 
> 赞同：14
> 
> 时间：2009-04-15T11:06:50.953
> 
> 标签：c#, .net, optimization, compiler-construction, jit

我正在用 C# 编写一个 DSP 应用程序（基本上是一个多轨编辑器）。我已经在不同的机器上对它进行了很长一段时间的分析，我注意到了一些“好奇”的东西。

在我的家用机器上，播放循环的第一次运行占用了大约 50%-60% 的可用时间（我认为这是由于 JIT 完成了它的工作），然后对于后续循环，它会下降到稳定的 5 ％ 消耗。问题是，如果我在较慢的计算机上运行应用程序，第一次运行占用的时间超过可用时间，导致播放中断并弄乱输出音频，这是不可接受的。之后，它下降到 8%-10% 的消耗。

即使在第一次运行之后，应用程序也会不时地调用一些耗时的例程（或多或少每 2 秒一次），这导致稳定的 5% 消耗经历了 20%-25% 的非常短的峰值。我注意到，如果我让应用程序运行一段时间，这些峰值也会下降到 7%-10%。（我不确定这是否是由于 JIT 重新编译了这些代码部分）。

所以，我对 JIT 有一个严重的问题。虽然应用程序即使在非常慢的机器上也能很好地运行，但这些“编译风暴”将是一个大问题。我试图弄清楚如何解决这个问题，我想出了一个想法，即用一个属性标记所有“合理”例程，该属性将告诉应用程序在启动期间预先“挤压”它们，因此在真正需要时会对其进行全面优化。但这只是一个想法（我也不太喜欢它），我想知道是否有更好的解决方案来解决整个问题。

我想听听你们的想法。

（NGEN 应用程序不是一个选项，我喜欢并想要我可以获得的所有 JIT 优化。）

编辑：

内存消耗和垃圾回收不是问题，我使用的是对象池，播放期间的最大内存峰值为 304 Kb。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-08-03T19:45:23.573

您可以触发 JIT 编译器在应用程序的初始化例程期间使用 ... 方法编译整个程序集`PrepareMethod`（无需使用`NGen`）。

此处更详细地描述了此解决方案：[在运行时强制 JIT 编译](http://www.liranchen.com/2010/08/forcing-jit-compilation-during-runtime.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T11:12:17.977

初始速度确实听起来像 Fusion+JIT，ILMerge（对于 Fusion）和 NGEN（对于 JIT）会有所帮助；您总是可以在启动时通过系统播放无声曲目，这样就可以完成所有艰苦的工作而用户不会注意到任何失真？

NGEN 是一个不错的选择；*你有理由*不能使用它吗？

您在初始加载*后*提到的问题听起来与 JIT 无关**。**也许是垃圾收集。

你试过剖析吗？CPU 和内存（集合）？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T14:18:34.800

正如 Marc 所提到的，持续的峰值听起来不像是 JIT 问题。其他要寻找的东西：

*   垃圾收集 - 您是否在音频处理期间分配内存？如果您正在创建大量垃圾，甚至是在 Gen 0 集合中幸存的对象，这可能会导致明显的峰值。听起来您正在做某种预分配，但要注意库代码中的隐藏分配（即使是 foreach 循环也可以分配！）

*   非规范化。在处理可能导致 CPU 峰值的非常小的浮点数时，某些类型的处理器存在问题。有关详细信息，请参阅[http://www.musicdsp.org/files/denormal.pdf](http://www.musicdsp.org/files/denormal.pdf)。

编辑：

即使您不想使用 NGen，至少也要比较 NGen 的版本，这样您就可以看到 JITing 的不同之处

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-03T19:56:26.437

如果您认为自己受到 JIT 的影响，请使用 NGEN 预编译您的应用程序并再次运行测试。NGEN 编译的代码中没有 JIT 开销。如果您仍然在 NGEN 的应用程序中看到峰值，那么您知道它们不是由 JIT 引起的。

# drupal - Drupal 站点地图模块

> ID：751193
> 
> 赞同：6
> 
> 时间：2009-04-15T11:09:31.587
> 
> 标签：drupal

我正在寻找一个可以在 Drupal 中创建站点地图的模块，但找不到。我尝试了[站点地图](http://drupal.org/project/site_map)模块，但它只能生成站点地图页面；它不能在每个页面的末尾创建站点地图块。我也尝试了[站点菜单模块](http://drupal.org/project/sitemenu)，但它也无法创建如上所示的站点地图块。

可能只是我不知道怎么配置，但是我把每一个readme文件都看了一遍，试了几天，还是不行。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-10-20T18:19:24.530

在尝试了一个模块（站点地图）但缺少自定义选项后，我遇到了同样的问题，我编写了一个自定义模块。花了更少的时间弄乱站点地图模块，只需获取站点地图，以下代码就足够了（调整您的菜单）：

```
function sitemap_render_menu ($menu) {
    $output = "<ul>";
    foreach ($menu as $item) {
    $link = $item["link"];
    if ($link["hidden"]) {
        continue;
    }

    $output .= "<li><a href=\"" . check_url(url($link["href"], $link["options"])) . "\">" . $link["title"] . "</a></li>";

    if ($item["below"]) {
        $output .= sitemap_render_menu($item["below"]);
    }
    }

    $output .= "</ul>";
    return $output;
}

function sitemap_content () {
    $output = "<h1>Sitemap</h1>";
    $output .= "<span id=\"sitemap\">";
    $output .= sitemap_render_menu(menu_tree_all_data("your-menu"));
    $output .= "</span>";
    return $output;
}

function sitemap_menu () {
    $items = array();

    $items["sitemap"] = array (
        "title" => "Sitemap",
        "page callback" => "sitemap_content",
        "access arguments" => array("access content"),
        "type" => MENU_CALLBACK);

    return $items;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-16T14:45:05.470

[在http://groups.drupal.org/node/15980](http://groups.drupal.org/node/15980)有站点地图模块的基本比较

我使用了 sitemenu，它满足了我的需求，但真正的答案取决于您如何使用分类、内容类型等来构建您的网站。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T12:28:27.827

像[自动菜单](http://drupal.org/project/automenu)这样的东西在这里也可能对你有用。您可以简单地将它生成的菜单添加到首页的页脚块中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-03T00:10:31.070

安装站点地图模块后，此 php 代码将打印站点地图。

```
<?php echo theme('site_map'); ?> 
```

您可以创建一个空视图块并为空文本指定上述内容，选择 PHP 代码输入格式。

可能有更好的方法来创建自定义块来显示 php 代码，但我不知道。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T13:20:27.390

我的想法是使用具有自定义块类型的[Views模块。](http://drupal.org/project/views)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-09T12:52:16.890

我认为您可以从[菜单块](http://drupal.org/project/menu_block)模块中受益。因为您可以在页脚中为您需要的所有菜单创建菜单块。[然后，您可以使用 minipanels 块（来自面板](http://drupal.org/project/panels)模块）将它们全部添加到页脚或一个块中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-29T07:40:41.610

您可以使用为我们提供可配置块的 Footer_sitemap 模块。 [https://drupal.org/project/footer_sitemap](https://drupal.org/project/footer_sitemap)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-04-16T04:49:29.960

这是一个最佳答案的小模型，它使用当前主题来显示层次结构

```
function sitemap_render_menu ($menu) {

    $output = "<ul  class='menu'>";

    foreach ($menu as $item) {
        $link = $item["link"];
        if ($link["hidden"]) {
            continue;
        }

        $cc=($item["below"]) ? "class='collapsed'" : '';

        $output .= "<li $cc><a href=\"" . check_url(url($link["href"], $link["options"])) . "\">" . $link["title"] . "</a>";

        if ($item["below"]) {
            $output .= sitemap_render_menu($item["below"]);
        }

        $output .= "</li>";

    }

    $output .= "</ul>";
    return $output;
}

function sitemap_content ($title,$menu) {
    $output = "<h1>$title</h1>";
    $output .= "<span id=\"sitemap\">";
    $output .= sitemap_render_menu(menu_tree_all_data($menu));
    $output .= "</span>";
    return $output;
}

function sitemap_menu () {
    $items = array();

    $items["sitemap"] = array (
      "title" => "Sitemap",
      "page callback" => "sitemap_content",
      "access arguments" => array("access content"),
      "type" => MENU_CALLBACK);

    return $items;
}

print sitemap_content("Navigational menu","Navigation"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-04-10T12:40:08.307

一个不依赖于作为菜单项包含的内容的简单解决方案可以通过以下方式实现：

创建新视图

以块形式输出

使用字段：

内容标题（配置为“将此字段链接到原始内容”

内容类型（配置为“从显示中排除”）

格式为

带设置的无格式列表 - 分组字段 Nr.1 选择内容：类型；

Filter Criterea: Content: Published (Yes) Content Type - 配置以选择您希望包含的内容类型；

排序标准 - 根据您的喜好配置

# sql-server - 高性能机器执行 SQL 查询比普通机器慢？

> ID：751207
> 
> 赞同：0
> 
> 时间：2009-04-15T11:12:35.340
> 
> 标签：sql-server, cpu

我们有一台 8 CPU 2.5GHz 的机器和 8GB 的​​ RAM，它执行 SQL 查询的速度比双核 2.19GHz 的 4GB RAM 慢。

为什么会出现这种情况，因为两台机器上都安装了 Microsoft SQL Server 2000？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T11:15:27.407

只需检查这些链接以指示瓶颈所在的位置

[http://www.brentozar.com/sql/](http://www.brentozar.com/sql/)

我认为磁盘布局和 SQL Server 数据库文件造成问题的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:17:09.043

此外，您可能有不同的 SQL Server 设置（内存分配和 AWE 内存、线程、最大查询内存、处理器关联、优先级提升）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:26:53.230

我们的多核服务器解决方案（我们的应用程序执行许多非常复杂的查询，这些查询往往会创建许多线程，这些线程有时会开始互锁甚至死锁）：

```
sp_configure 'show advanced options', 1
reconfigure
go
sp_configure 'max degree of parallelism', 1
reconfigure 
```

这不是理想的解决方案，但我们没有注意到其他操作的任何性能损失。

当然，您也应该优化磁盘布局，有时会限制 64 位服务器的 SQL 服务器内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T11:24:28.167

检查两台机器上相同查询的执行计划，如果可能，请在此处发布。

很可能会是这样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T12:03:57.213

请记住，仅仅因为一台机器比另一台机器有更多的 CPU 以更高的时钟速度和内存运行，它不一定会比另一台更快地解决给定的问题。

尽管您没有提供详细信息，但 8 CPU 机器可能有 8 个插槽，每个插槽都有一个单核 CPU（比如 P4 时代的 Xeon）和 1 GB 的本地（比如 RDRAM）RAM。第二台机器是配备 4GB DDR2 RAM 的现代 Core 2 Duo。

虽然机器 #1 中的每个 CPU 具有更高的单独频率，但 netburst 架构的时钟对时钟比 Core 2 架构慢得多。此外，如果您的 CPU 负载较轻，但内存密集型负载不适合第一台机器上 CPU 的 1GB 本地内存，那么您在第一台机器上的内存访问可能会更加昂贵（因为它们必须发生）通过其他 CPU）。此外，Core 2 机器上的 DDR2 比 Xeon 中的 RDRAM 快得多。

CPU 频率和总内存并不是一切——CPU 架构、内存类型以及 CPU 和内存层次结构也很重要。

当然，正如其他答案所暗示的那样，它可能是一个更简单的答案——SQL Server 在尝试并行化查询时绊倒了自己。

# java - EJB 事务类型

> ID：751209
> 
> 赞同：4
> 
> 时间：2009-04-15T11:13:30.750
> 
> 标签：java, transactions, ejb-3.0, ejb

我一直在寻找关于此的综合文章，但还没有找到足够好的文章。

有人可以向我解释交易类型的工作原理吗？(Required, RequiresNew, Mandatory, Never...) 主要是如何影响不同类型的服务之间的服务调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-24T23:52:18.923

Bill Burke 和 Richard Monson Haefel 所著的 Enterprise Java Beans 3.0 是任何与 EJB3 相关的优秀参考资料。txn 属性实际上非常简单。基本上，您使用注释在 EJB 中的方法级别使用这些。

1.  必需意味着运行该方法需要 txn。如果调用者在 txn 中，它将被使用。如果没有，将创建和使用新的 txn。
2.  RequiresNew 意味着运行该方法需要一个新的 txn。如果调用者在一个 txn 中，它将被挂起并创建和使用一个新的 txn。如果没有，将创建并使用新的 txn
3.  强制意味着调用者在调用该方法时需要在一个 txn 中。否则会引发错误。
4.  支持意味着该方法不关心调用者是否在 txn 中。
5.  NotSupported - 如果调用者在 txn 中，则 txn 将被挂起，并且该方法将在没有 txn 的情况下运行。
6.  从不 - 与 NotSupported 相同，但如果调用者有 txn 但 NotSupported 不会引发错误，则会引发错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:22:18.607

[EJB 事务管理的开发人员](http://www.kevinboone.com/ejb-transactions.html)指南对我来说似乎是一个非常全面的指南。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T15:38:59.507

有用，链接：

*   [http://docs.oracle.com/javaee/5/tutorial/doc/bncij.html](http://docs.oracle.com/javaee/5/tutorial/doc/bncij.html)
*   [http://www.ibm.com/developerworks/java/library/j-ts1/index.html](http://www.ibm.com/developerworks/java/library/j-ts1/index.html)
*   [http://static.springsource.org/spring/docs/2.5.x/reference/transaction.html#tx-propagation](http://static.springsource.org/spring/docs/2.5.x/reference/transaction.html#tx-propagation)
*   [http://entjavastuff.blogspot.co.uk/2011/02/ejb-transaction-management-going-deeper.html](http://entjavastuff.blogspot.co.uk/2011/02/ejb-transaction-management-going-deeper.html)
*   [http://www2.sys-con.com/itsg/virtualcd/java/archives/0504/tyagi/index.html](http://www2.sys-con.com/itsg/virtualcd/java/archives/0504/tyagi/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-06T15:11:07.570

掌握 Enterprise JavaBeans 3.0，Wiley。

免费提供：

[http://www.theserverside.com/tt/books/wiley/masteringEJB3/index.tss](http://www.theserverside.com/tt/books/wiley/masteringEJB3/index.tss)

见 ch。10.

# jquery - 如何使用getJSON，用post方法发送数据？

> ID：751218
> 
> 赞同：117
> 
> 时间：2009-04-15T11:15:57.063
> 
> 标签：jquery, asp.net-mvc, post, http-post, getjson

我正在使用上述方法，它适用于 URL 中的一个参数。

例如`Students/getstud/1`，应用控制器/动作/参数格式的地方。

现在我在 Student 控制器中有一个动作，它接受两个参数并返回一个 JSON 对象。

那么如何`$.getJSON()`使用 post 方法发布数据呢？

类似的方法也是可以接受的。

重点是用 AJAX 调用控制器的动作。

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2009-04-15T11:59:16.243

$.getJSON() 方法执行 HTTP GET 而不是 POST。您需要使用[$.post()](http://docs.jquery.com/Ajax/jQuery.post)

```
$.post(url, dataToBeSent, function(data, textStatus) {
  //data contains the JSON object
  //textStatus contains the status: success, error, etc
}, "json"); 
```

在该调用中，`dataToBeSent`可以是您想要的任何内容，但如果要发送 html 表单的内容，您可以使用[serialize](http://docs.jquery.com/Ajax/serialize)方法从表单创建 POST 数据。

```
var dataToBeSent = $("form").serialize(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-09-29T03:49:16.650

这是我的“单线”解决方案：

```
$.postJSON = function(url, data, func) { $.post(url+(url.indexOf("?") == -1 ? "?" : "&")+"callback=?", data, func, "json"); } 
```

为了使用 jsonp 和 POST 方法，此函数将“回调”GET 参数添加到 URL。这是使用它的方法：

```
$.postJSON("http://example.com/json.php",{ id : 287 }, function (data) {
   console.log(data.name);
}); 
```

服务器必须准备好处理回调 GET 参数并将 json 字符串返回为：

```
jsonp000000 ({"name":"John", "age": 25}); 
```

其中“jsonp000000”是回调 GET 值。

在 PHP 中，实现如下：

```
print_r($_GET['callback']."(".json_encode($myarr).");"); 
```

我做了一些跨域测试，它似乎工作。不过还需要更多的测试。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-15T18:08:12.540

只需将这些行添加到您的`<script>`（在加载 jQuery 之后但在发布任何内容之前）：

```
$.postJSON = function(url, data, func)
{
    $.post(url, data, func, 'json');
} 
```

替换（部分/全部）`$.getJSON`并`$.postJSON`享受！

您可以使用与 相同的 Javascript 回调函数`$.getJSON`。不需要服务器端更改。（嗯，我一直推荐`$_REQUEST`在 PHP 中使用[http://php.net/manual/en/reserved.variables.request.php](http://php.net/manual/en/reserved.variables.request.php)，[$_REQUEST、$_GET 和 $_POST 中哪一个最快？](https://stackoverflow.com/questions/1924939/php-request-vs-get-and-post)）

这比@lepe 的解决方案简单。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-27T14:38:06.683

我有做 getJSON 的代码。我只是用post替换它。令我惊讶的是，它奏效了

```
 $.post("@Url.Action("Command")", { id: id, xml: xml })
      .done(function (response) {
           // stuff
        })
        .fail(function (jqxhr, textStatus, error) {
           // stuff
        });

    [HttpPost]
    public JsonResult Command(int id, string xml)
    {
          // stuff
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-11-16T11:23:20.860

我只是使用了 post 和 if：

```
data = getDataObjectByForm(form);
var jqxhr = $.post(url, data, function(){}, 'json')
    .done(function (response) {
        if (response instanceof Object)
            var json = response;
        else
            var json = $.parseJSON(response);
        // console.log(response);
        // console.log(json);
        jsonToDom(json);
        if (json.reload != undefined && json.reload)
            location.reload();
        $("body").delay(1000).css("cursor", "default");
    })
    .fail(function (jqxhr, textStatus, error) {
        var err = textStatus + ", " + error;
        console.log("Request Failed: " + err);
        alert("Fehler!");
    }); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-05T19:58:20.333

`$.getJSON()`对于发送 AJAX 请求和获取 JSON 数据作为响应非常方便。唉，jQuery 文档缺少一个应该命名为`$.postJSON()`. 为什么不直接使用`$.getJSON()`并完成它呢？好吧，也许您想发送大量数据，或者在我的情况下，IE7 只是不想与 GET 请求一起正常工作。

确实，目前还没有`$.postJSON()`方法，但是您可以通过在函数中指定第四个参数（类型）来完成同样的事情`$.post()`：

我的代码如下所示：

```
$.post('script.php', data, function(response) {
  // Do something with the request
}, 'json'); 
```

* * *

## 回答 #7

> 赞同：-8
> 
> 时间：2010-07-20T18:35:15.990

如果你只有两个参数，你可以这样做：

```
$.getJSON('/url-you-are-posting-to',data,function(result){

    //do something useful with returned result//
    result.variable-in-result;
}); 
```

# php - AJAX 复选框 if 语句

> ID：751227
> 
> 赞同：0
> 
> 时间：2009-04-15T11:18:26.323
> 
> 标签：php, javascript, ajax, syntax

在将查询字符串发送到 PHP 之前，我已经从表单 ID 中提取了一堆变量。但是，由于一个输入是一个复选框，我试图让 AJAX 根据是否选中来设置变量值。IE。

```
 if (document.getElementById('bold').checked) { var bold = "true"; 
    }
    else { var bold = "false"; } 
```

但是，它实际上并没有向 PHP 发送任何内容。我很多时候都在猜测语法，所以如果有人能纠正我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T11:29:39.947

只要你给它一个名字，它就应该可以在后端以“on”或“off”的形式访问，例如

```
var $checked = $_POST["checkboxname"] == "on"; 
```

所以你的javascript是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T11:34:47.487

首先，而不是： var bold = "true";

我认为您实际上正在寻找类似的东西： document.getElementById('bold').value = "true";

其次，如果未选中复选框，则不会将任何内容发送到 PHP 脚本（未选中的复选框不会作为表单提交的一部分发送）。

# gwt - GWT JavaScriptObject 读取“删除”属性

> ID：751228
> 
> 赞同：3
> 
> 时间：2009-04-15T11:18:38.977
> 
> 标签：gwt, javascript-objects

我在扩展的 JavaScriptObject 类中有以下本机方法：

```
public final native boolean getDelete()  /*-{ return this.delete; }-*/; 
```

但这显然不起作用，因为“删除”是一个 javascript 运算符。

如何正确读取此属性。

抛出的异常是：

**com.google.gwt.dev.js.JsParserException：在 . 操作员**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T14:10:32.853

通过将其作为字符串访问来尝试：

```
public final native boolean getDelete()  /*-{ return this['delete']; }-*/; 
```

# storage - 关系数据库 - 必须有更多的权利？

> ID：751236
> 
> 赞同：15
> 
> 时间：2009-04-15T11:20:53.480
> 
> 标签：storage, database

我真的很喜欢数据库设计和语义管理数据的整个概念以及随之而来的所有逻辑。

然而，我在数据库方面的知识水平（我猜）非常基础——我可以使用 ER 图、连接表、处理多对多、一对多等正确建模数据关系。我有经验当谈到一般的编程时，我认为我的数据库知识就像了解面向对象编程的基础知识，即如何建模汽车类，从车辆类继承，包含车轮对象等等。

现在我想进一步了解关系数据库，以便我可以自信地向雇主说我可以在专业水平上处理该主题。

我现在所能处理的可能是我个人网站后端的电影数据库，如果我是亚马逊并且必须存储数百万部电影，它可能会崩溃。那么有可扩展性的主题吗？我敢肯定，如果您要在专业水平上使用数据库，那么您必须理解并能够在现实生活中应用数据库设计中的一系列非常“标准”的主题/概念。

因此，如果该领域的任何数据库专家能够命名一些领域、概念、案例研究或任何有益于学习以真正擅长数据库的东西，我将非常感激。我确信这里潜伏着大量的科学，我想要它。

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T11:26:22.547

该领域的标准文本是 CJ Date 的“数据库系统简介”。

我有二十年的C经验；我读了它，认为它很棒，因此我写了一个关系数据库（一个合适的数据库，而不是这个 SQL 恶意！）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T07:53:43.840

另一个领域是维度建模和数据仓库。

我多年来一直在使用关系建模，然后我阅读[了 The Data Warehouse Toolkit](https://rads.stackoverflow.com/amzn/click/com/0471200247)并获得了关于如何使用它的全新观点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-27T08:11:45.207

如果他[的《数据库系统简介》](http://en.wikipedia.org/wiki/Special:BookSources/0321197844)对您来说不够肮脏，请从 CJ Date 的[《深度数据库：从业者的关系理论》中获得更多的污垢。](http://en.wikipedia.org/wiki/Special:BookSources/0596100124)

说真的，与许多其他专业数据库工作者所拥有的相比，这两本书将以更少的篇幅为您提供更多关于 RDBMS 的知识。特别是深入了解数据库，它着眼于如何在语言不支持的情况下以关系方式考虑数据库，以及如何欺骗 SQL 使其成为一种接近关系的语言。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-28T03:25:26.027

我将自愿列出您可能想要考虑作为数据库编程方面的领域列表。我不会声称您需要精通所有这些，甚至是其中的大多数，才能使用 DBMS 进行编程，甚至也不需要对 DBMS 进行编程。但是，它们都是在某些时候具有一定相关性的主题 - 没有特定的顺序：

*   查询语言设计
*   查询优化
*   查询重写
*   数据类型
*   存储组织
*   事务管理
*   通信协议
*   加密
*   认证和识别
*   架构设计
*   复制
*   备份还原
*   两阶段提交
*   乐观并发控制
*   锁定和悲观并发控制
*   授权
*   基于标签的访问控制
*   集合论
*   关系理论
*   分布式查询
*   布尔逻辑
*   用户定义的类型和函数
*   目录管理
*   缓冲区管理
*   排序
*   国际化（I18N）、本地化（L10N）、全球化（G11N）
*   量词
*   审计
*   触发器
*   存储过程

我也不主张完整性或最小性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T05:12:28.640

作为数据库的学生，我只能在有限的范围内发言，但我可以推荐两个可能有帮助的网站......

[http://database-programmer.blogspot.com/2008/09/comprehensive-table-of-contents.html](http://database-programmer.blogspot.com/2008/09/comprehensive-table-of-contents.html)

这是 Kenneth Downs 网站，他从 SQL 的最基础开始，深入研究更复杂的主题。毕竟，这个人已经围绕 DB 编写了一个框架。

另一个是高可扩展性...

[http://highscalability.com/](http://highscalability.com/)

他们进入了 DB 的每个领域。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-28T23:50:05.787

我认为集合 + 关系代数是大多数数据库用户知之甚少但会很好学习的东西。当您了解将一种关系映射到另一种关系背后所涉及的逻辑时，您开始更清楚地看到为什么规范化之类的事情是好的，为什么最好尽可能避免使用 NULL 等等。您还开始看到 SQL 与更纯粹的关系查询语言相比的缺陷，由于性能原因等原因，特征对范式施加了限制。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T11:26:24.993

嗯，它总是很好的设计示例......看看是否有你认识的人需要数据库来做某事。但是根据您感兴趣的行业，研究 VLDB（超大型数据库）技术可能会有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-24T07:33:47.647

我相信对现有数据库的优化可能会很有趣。即为什么你应该非规范化表。

一些基本的关系代数是有用的知识，与集合论密切相关。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-24T08:04:25.547

一个非常常见的场景是必须将丑陋的数据库映射到一个实体模型，这不需要直接反映在数据库的结构中。找出哪种方法最适合对您的域中的数据进行建模可能会很棘手。

全文搜索和 XML 是似乎越来越多的主题。

我没有这方面的经验，但我知道 DB2（其中有试用版）有一些疯狂的新特性）

玩得开心 ：-）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-28T04:22:46.667

[http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html](http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html)

[http://blogs.msdn.com/pathelland/archive/2007/07/23/normalization-is-for-sissies.aspx](http://blogs.msdn.com/pathelland/archive/2007/07/23/normalization-is-for-sissies.aspx)

[http://www.25hoursaday.com/weblog/2007/08/03/WhenNotToNormalizeYourSQLDatabase.aspx](http://www.25hoursaday.com/weblog/2007/08/03/WhenNotToNormalizeYourSQLDatabase.aspx)

[http://itc.conversationsnetwork.org/shows/detail571.html](http://itc.conversationsnetwork.org/shows/detail571.html)

[http://www.scribd.com/doc/2592098/DVPmysqlucFederation-at-Flickr-Doing-Billions-of-Queries-Per-Day](http://www.scribd.com/doc/2592098/DVPmysqlucFederation-at-Flickr-Doing-Billions-of-Queries-Per-Day)

[http://highscalability.com/flickr-architecture](http://highscalability.com/flickr-architecture)

[http://highscalability.com/ebay-architecture](http://highscalability.com/ebay-architecture)

[http://www.addsimplicity.com/downloads/eBaySDForum2006-11-29.pdf](http://www.addsimplicity.com/downloads/eBaySDForum2006-11-29.pdf)

[http://blog.maxindelicato.com/2008/12/scalability-strategies-primer-database-sharding.html](http://blog.maxindelicato.com/2008/12/scalability-strategies-primer-database-sharding.html)

[http://blog.maxindelicato.com/2008/12/the-ihsdf-theorem-a-proposed-theorem-for-the-tradeoffs-in-horizo​​ntally-scalable-systems.html](http://blog.maxindelicato.com/2008/12/the-ihsdf-theorem-a-proposed-theorem-for-the-tradeoffs-in-horizontally-scalable-systems.html)

[http://www.iamcal.com/talks/](http://www.iamcal.com/talks/)

[http://natishalom.typepad.com/nati_shaloms_blog/2009/04/writing-your-own-scalable-twitter.html](http://natishalom.typepad.com/nati_shaloms_blog/2009/04/writing-your-own-scalable-twitter.html)

[http://www.mysqlperformanceblog.com/](http://www.mysqlperformanceblog.com/)

[http://www.cecs.uci.edu/~papers/ipdps07/pdfs/SMTPS-201-paper-1.pdf](http://www.cecs.uci.edu/~papers/ipdps07/pdfs/SMTPS-201-paper-1.pdf)

[http://video.google.com/videoplay?docid=7278544055668715642](http://video.google.com/videoplay?docid=7278544055668715642)

[http://www.niallkennedy.com/blog/uploads/flickr_php.pdf](http://www.niallkennedy.com/blog/uploads/flickr_php.pdf)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-28T16:09:16.907

这取决于你想用你的数据库做什么，你的数据看起来如何，你的工作流程是什么，你必须使用多少服务器、客户端和数据库......

因此，假设您像我一样必须处理多个数据库，而不是很大（每个小于 100 GB），并且您有许多具有许多不同需求的客户，这使您开发了许多自定义解决方案，例如生成自定义报告或导出。这使您更像是程序员而不是 DBA。您需要的是生产力，而不是性能。

在这种情况下，我想出的最佳解决方案是尽可能地摆脱 SQL。您可以通过使用某种 ORM（无论是自制的还是现有的 ORM）来实现这一点，从而将 SQL 脚本转换为对象编程。这样做我在几分钟内就完成了使用 SQL 需要几个小时的工作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-29T00:13:35.400

免责声明：不是数据库设计方面的专家。

一些性能问题可以通过以下方式处理：

1.  非规范化您的数据库，以减少要加入的表的数量
2.  添加索引
3.  应该进行过滤，以便您首先删除最大的不匹配数据，然后在缩减集上挑选下一个条件。最好从 100 个值 -> 10 个匹配第一个条件 -> 1 个匹配第一个和第二个条件，而不是 100 个值 -> 80 个匹配第二个条件 -> 1 个匹配第一个和第二个条件。看似微不足道，但记住这一点很重要。
4.  *divide* *et* *impera*是可扩展性的座右铭。如果您有一些以非线性方式扩展的东西，比如说 O(N^2)，将 N 保持在尽可能低的水平是有意义的，并且您应该将数据集划分为更小的集合，假设它们是独立的并且您可以制定分区。这方面的一个例子是分片，通常用于将用户数据库保存在大型社交网站中。（注意：举个例子，我不会这样实现）他们没有拥有一个包含所有用户的庞大数据库，而是拥有 26 个服务器（每个字母一个），然后他们将所有昵称都放在同一个首字母在同一台服务器上。这具有以下优点：

    一种。你平衡不同机器上的负载
    b. 如果一台机器崩溃，您只能让一部分用户无法访问该站点，而不是所有用户
    c. 您预先选择具有高度区分标准的搜索（第一个字母），然后执行第二次搜索（用户名）
    d. 您减少了每个数据库的条目数。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-29T00:36:07.267

不要忘记在数据库中表示层次结构和/或图形。这可能会很痛苦，而且没有正确的答案。

这些 SO 帖子中提到了标准技术（至少对于层次结构）：

*   [在多个表中报告层次结构](https://stackoverflow.com/questions/781068/reporting-hierarchy-in-mutltiple-tables)
*   [将平面表解析为树的最有效/优雅的方法是什么？](https://stackoverflow.com/questions/192220/what-is-the-most-efficient-elegant-way-to-parse-a-flat-table-into-a-tree/192462#192462)

编辑：还有用于 GIS 的[空间数据库应用程序，您可以在其中使用](http://en.wikipedia.org/wiki/Spatial_database)[R-trees](http://en.wikipedia.org/wiki/R-tree)等基于点位置的数据结构和/或索引。使用这些与常规的非空间数据库功能有点不同。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-29T20:38:09.543

在我看来，数据库技能分为三个“轨道”：开发人员、DBA 和架构师。从开发的角度来看，您希望专注于开发、了解 Architect 并在此过程中尽可能多地学习 DBA 知识。

作为一名开发人员（在我看来），关键是让你的 SQL 达到一个非常好的标准。作为面试官，如果我正在寻找开发人员，我不在乎您是否可以设计数据库，就像您如何编写查询一样。假设您了解基本的 CRUD 命令，您是否了解：

存储过程（不仅仅是如何使用它们，而是何时和为什么）
视图（同上，包括物化视图）
触发器（插入、更新、删除、如何和为什么）
游标（尤其是对性能的影响）
参照完整性
事务
索引
添加默认值、约束和表的身份
复杂使用 group by 和具有
功能，尤其是：
- 日期和时间操作
- 字符串操作
- 处理空值

您应该能够单独使用 SQL 从数据库中提取您需要的任何数据，您永远不需要使用您的程序代码以任何方式操作或解析它（您可以选择，但这将是一个选择，而不是您没有知道如何用 SQL 来做）。

作为一名开发人员，我会查看 Joe Celko 为 Smarties 编写的 SQL。很多 SQL 来做你可能从未真正想过能够在 SQL 中做的事情。

学习这些东西的最好方法之一是写报告（管理信息），虽然看起来很乏味。我见过很多人抱怨写报告很乏味，然后写得非常非常糟糕（不仅仅是因为他们没有尝试）。报告往往接近于纯 SQL，因此您必须真正了解手头的工具，而复杂的报告确实将那些了解 SQL 的人和不了解 SQL 的人暴露出来。人们也往往不想为他们等待太久，所以性能也是关键。

查看您当前的数据库，并想出一些可能有人真正想知道的非常非常尴尬的事情。想想最流行和最不流行的营销、趋势。然后尝试将它们组合成一个查询。

在性能方面，我还试图深入了解查询优化器的工作原理，它如何决定何时使用索引和何时进行表扫描，索引何时有帮助以及何时它们会阻碍。

一个优秀的开发人员不仅会编写好的查询，他们还会编写快速、可维护的查询。要真正掌握这一点，您需要使用一个包含十几个（或更多表）的数据库，理想情况下，该数据库包含数百万行。那是当您开始看到您认为可以拖后腿的查询时。

其他人已经很好地涵盖了建筑师/设计师的东西。关于这个主题我想说的是，对于每个必须设计的数据库，都需要为其编写数百个查询。当您提高技能时，您可能需要考虑按比例分解工作，并确保您的查询确实符合要求。

就链接而言，它取决于平台——所有这些东西往往是特定于平台的。但这就是谷歌的目的。

不是我完全怀疑你想要什么，但值得知道，因为很多认为他们知道 SQL 的人真的不知道......

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-27T18:31:51.113

我强烈建议从[www.dbdebunk.com](http://www.dbdebunk.com)开始。它有很多与理论相反的实际东西。该网站有点过时，但仍然有用。如果您真的想成为数据库专业人士，即使是商业内容也不会太贵。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-27T20:21:27.760

我建议稍微缩小你的范围。选择一个 sql server 并成为它的专家……例如获取 mysql，了解存储类型、复制类型等之间的差异。以几种不同的方式实现复制。获取大型数据集并尝试优化查询。做一些支点并为此优化您的索引。调查备份策略。了解当您拥有一个每天持续增加 100,000 个事务的 10GB 数据库时如何提高复制和备份的性能。编写软件来插入记录和脚本来进行复制和备份。

当您尝试涵盖所有 sql 服务器时，很难成为没有实际经验的有效 dba。只关注一个...我建议使用 mysql 或 mssql，但不管你的船是什么。

-大学教师

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-29T00:24:45.407

只有一种严格的技术可以在概念上对我所知道的关系数据库模式进行建模（而且我已经花了很多时间寻找）。它被混淆地命名为“对象角色建模”。这里有几个参考。

[http://www.agilemodeling.com/artifacts/ormDiagram.htm](http://www.agilemodeling.com/artifacts/ormDiagram.htm)

[http://www.tdan.com/view-articles/5033](http://www.tdan.com/view-articles/5033)

[http://en.wikipedia.org/wiki/Object_role_modeling](http://en.wikipedia.org/wiki/Object_role_modeling)

[http://en.wikipedia.org/wiki/NORMA](http://en.wikipedia.org/wiki/NORMA)

这是[Visual Studio 的插件](http://sourceforge.net/projects/orm)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-04-30T12:41:09.947

好吧，坦率地说，数据库只是一种存储和访问数据的方式。文件系统的作用也差不多。

LDAP 的一个相似之处在于它是一种*协议*，因此它不是对您可以使用它做什么以及应该如何实现它的定义，对于 SQL 也可以这样说。

因此，如果您想了解更多关于数据库的信息，您实际上是在说您想了解更多关于 SQL 协议和/或如何存储和获取数据的信息。

您可能有兴趣四处搜索“B-Tree”是什么以及如何使用它。另一件值得查找的事情是 EAV（实体-属性-值）以及为什么模式对它如此重要。

有了这些知识，您实际上可以扮演自己的数据库角色，同时欣赏 RDBM 已经为您所做的事情。

如果您想要更实用的方法，请查看开源 PostgreSQL 提供的文档，可能从[这个](http://www.postgresql.org/docs/8.3/static/history.html).

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-05-05T05:46:50.837

You could start by reading one of the (almost recent) review papers that focuses on the foundations and trends in Databases: [The anatomy of databases](http://db.cs.berkeley.edu/papers/fntdb07-architecture.pdf)

# jsf - 即使 A4j 验证失败 +jsf 也提交表单

> ID：751239
> 
> 赞同：0
> 
> 时间：2009-04-15T11:21:34.100
> 
> 标签：jsf

我正在使用 a4j 检查用户名是否存在以进行 onblur 事件，它会在用户已经存在时显示错误消息，但是，如果我在显示错误消息后单击提交按钮，当涉及 inputtext 的 required=true 时它会被提交'不提交

required="true" 验证器="#{RegistrationBean.checkFirstName}">

public void checkFirstName(FacesContext facesContext, UIComponent 组件, 对象值)
{

```
 String name = (String) value;

     if(name.trim().length()==0){
         System.out.println("Name *******");

         String message = bundle.getString("Name_Required");
        FacesContext.getCurrentInstance().addMessage("Reg:firstName",
                new FacesMessage(FacesMessage.SEVERITY_ERROR, message,message));                

     }                  
     if(name.trim().equalsIgnoreCase("tom")){

         String message = bundle.getString("Name_exists");
        FacesContext.getCurrentInstance().addMessage("Reg:firstName",
                new FacesMessage(FacesMessage.SEVERITY_ERROR, message,message));                

    }

  } 
```

谁能建议我哪里出错了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T11:41:06.677

使用 JSF 代码会更容易为您提供帮助。因此，我建议您在 JSF 页面中添加类似的内容：

```
<h:inputText id="firstName" ... validator="#{aBean.checkFirstName}"> 
```

Java 代码的问题是发生错误时不会抛出任何 ValidatorException。因此，您的代码必须是：

```
public void checkFirstName(FacesContext facesContext, UIComponent component, Object value) {
    String name = (String) value;
    if ((name == null) || name.trim().length() == 0) {
        System.out.println("Name *******");
        String message = bundle.getString("Name_Required");
        throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR, message, message)); // Throw the required error
    }
    if (name.trim().equalsIgnoreCase("tom")) {
        String message = bundle.getString("Name_exists");
        throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR, message, message)); // Throw the already exist error
    }
} 
```

这样，如果该字段填写的值为空或者已经存在，就会抛出ValidatorException，用户会得到一个错误信息（不要忘记在你的表单中添加`<h:messages/>`or`<h:message/>`组件），并且不会提交表单！

# css - 如何在 IE6+7 中通过 CSS 访问第 n 个元素

> ID：751241
> 
> 赞同：1
> 
> 时间：2009-04-15T11:21:53.523
> 
> 标签：css, internet-explorer

我想知道我们如何在 IE6/IE7 中使用 CSS访问第 n^个元素。`<li>`

HTML：

```
<ul class="myUL">
  <li><a href="" target="">Link1</a></li>
  <li><a href="">Link2</a></li>
  <li><a href="">Link3</a></li>
</ul> 
```

现在假设我想访问 Link2，该怎么做？注意：不使用javascript。仅通过CSS。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T11:24:55.980

你不能。给它一个唯一的类名。

你可以做`:first`，`:last`但不是 n'th，我也不确定它们在 IE6 中是否有效。

```
<ul class="myUL">
  <li class="link1"><a href="" target="">Link1</a></li>
  <li class="link2"><a href="">Link2</a></li>
  <li class="link3"><a href="">Link3</a></li>
</ul> 
```

在 CSS 中，参考`ul.myUl li.link2`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T11:33:31.967

正如 Ian 正确地指出的那样，静态 CSS 无法做到这一点。但是，您可以使用 JavaScript。

HTML：

```
<ul class="myUL" id="myUL">
    <li><a href="" target="">Link1</a></li>
    <li><a href="">Link2</a></li>
    <li><a href="">Link3</a></li>
</ul> 
```

JS：

```
var n = 2;
nthElem = getElementById("myUL").childNodes[n-1];
nthElem.style = "color: red";
//or
nthElem.className = "cssClassForNthElem"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:34:38.237

就像 Ian 说的，这在 IE6 中是不可能的，在 IE7 中也是不可能的。IE7 和 IE8 实际上支持`:first-child`来自 CSS 2.1 的选择器（我相信你可以猜到它的作用），但不支持CSS 3`:nth-child`也不支持。`:last-child`

# .net - 如何判断 win32 应用程序是否使用 .NET 运行时

> ID：751254
> 
> 赞同：6
> 
> 时间：2009-04-15T11:26:20.080
> 
> 标签：.net, executable

如何判断可执行文件是否为 .NET 应用程序？

我宁愿不必安装 Visual Studio。但如果我必须这样做，我会的。首选命令行程序。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-15T11:31:31.190

`PEVerify`会这样做:)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-15T11:31:10.943

如果应用程序需要 mscoree.dll 才能运行，它就是一个 .NET 可执行文件。[您可以使用Dependency Walker](http://www.dependencywalker.com/)检查这一点，但通常任何工具都可以为您提供运行所需 DLL 的列表。

如果你想知道一个正在运行的进程是否是 .NET 进程，我只能推荐[Process Explorer](http://www.dependencywalker.com/)。该工具将为您提供有关该过程的大量信息，包括一些 .NET 属性。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-15T11:31:57.010

或者更简单：使用 Process Explorer。[在这里](http://download.sysinternals.com/Files/ProcessExplorer.zip)免费下载

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-15T11:36:32.303

Process Explorer 默认使用黄色为 dotNet 应用程序着色。这应该足够了:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T11:30:10.743

将其放入[Reflector](http://www.red-gate.com/products/reflector/)中，它将被反编译。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-15T12:25:49.953

您可以使用默认安装的 ILDasm.exe 以及在您的机器上安装 .Net Framework SDK（查看 C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin）只需打开 ildasm.exe en将程序集放入其中，如果已解散，则为.net，如果收到错误则不是。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-15T12:42:24.627

更简单：

1.  打开属性，查看“版本”选项卡，如果在“其他信息”下看到一个名为“程序集版本”的属性，那么它很可能是一个 .NET 应用程序。

2.  使用记事本或类似应用程序打开 EXE 或 DLL 并查找文本“mscorlib”（不带引号）。如果您找到它，它很可能是一个 .NET 应用程序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T12:30:09.023

> “我宁愿不必安装 Visual Studio。但如果必须安装，我会安装。首选命令行程序。”

您不必安装 Visual Studio 来运行 .NET 应用程序 - 只需 .NET 框架，您可以自己下载它。

但是，如果要确定它是否是 .NET 应用程序，可以下载并使用[.NET Reflector](http://www.red-gate.com/products/reflector/)或使用 .NET 框架 SDK 附带的 ILDasm。

# asp.net - 对 DataSource 进行插入操作后，RadGrid 丢失了当前编辑项的轨道

> ID：751262
> 
> 赞同：0
> 
> 时间：2009-04-15T11:27:33.417
> 
> 标签：asp.net, telerik, radgrid

我有一个绑定到 LinqDataSource 的 RadGrid。网格具有自动生成的编辑和删除列。它显示一个没有任何层次结构的简单表格。

我正在采取以下步骤。

使用 LinqDataSource 填充 RadGrid

单击网格最后一行的编辑

从页面上的另一个控件，更新 linqdatasource 并在网格上调用 rebind

网格失去了当前编辑项目的轨迹，并在编辑模式下打开了不同的项目

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T11:34:53.867

如果你重新绑定数据源，一切都会被重置。您将需要跟踪当前的“编辑”项目，并在重新启动数据源后“重新激活”它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T11:50:38.337

确保：

1.  所有绑定都发生在 OnInit 事件中（或在处理按钮单击之后）
2.  视图状态没有为网格禁用

# sql - 关系数据库中的术语“元组”是什么意思？

> ID：751264
> 
> 赞同：62
> 
> 时间：2009-04-15T11:28:15.537
> 
> 标签：sql, terminology, rdbms, definition, tuples

请解释一下sql中的元组是什么意思？谢谢..

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-07-05T00:52:00.267

这里的大多数答案都在正确的轨道上。但是，**一行不是元组**。 **元组**`*`是具有名称的已知值的*无序*集。因此，以下元组是相同的（我使用虚构的元组语法，因为关系元组在很大程度上是一种理论结构）：

```
(x=1, y=2, z=3)
(z=3, y=2, x=1)
(y=2, z=3, x=1) 
```

...当然假设 x、y 和 z 都是整数。另请注意，没有“重复”元组之类的东西。因此，以上不仅相等，而且它们是*同一事物*。最后，元组只能包含已知值（因此，没有空值）。

**行**是具有名称的一`**`组有序的已知或未知值（尽管它们可能被省略）。因此，以下比较在 SQL 中返回 false：

```
(1, 2, 3) = (3, 2, 1)
(3, 1, 2) = (2, 1, 3) 
```

请注意，有一些方法可以“伪造它”。例如，考虑以下`INSERT`语句：

```
INSERT INTO point VALUES (1, 2, 3) 
```

假设 x 是第一个，y 是第二个，z 是第三个，这个查询可能被重写为：

```
INSERT INTO point (x, y, z) VALUES (1, 2, 3) 
```

或这个：

```
INSERT INTO point (y, z, x) VALUES (2, 3, 1) 
```

...但我们真正要做的只是更改排序而不是删除它。

还要注意，也可能存在未知值。因此，您可能有未知值的行：

```
(1, 2, NULL) = (1, 2, NULL) 
```

...但请注意，这种比较总是会产生`UNKNOWN`. 毕竟，你怎么知道两个未知值是否相等呢？

最后，行可能会重复。换句话说，`(1, 2)`and`(1, 2)`可能比较相等，但这并不一定意味着它们是同一件事。

如果这是您感兴趣的主题，我强烈建议您阅读[SQL and Relational Theory: How to Write Accurate SQL Code](https://rads.stackoverflow.com/amzn/click/com/0596523068) by CJ Date。

`*`请注意，我说的是元组，因为它们存在于关系模型中，这与一般的数学有点不同。

`**`以防万一您想知道，SQL 中的几乎所有内容都是行或表。因此，`(1, 2)`是一行，`VALUES (1, 2)`而是一个表（只有一行）。

**更新**：我在[这里](http://jasonmbaker.wordpress.com/2009/07/05/the-relational-model-of-tuples-relations-rows-and-tables/)的博客文章中对这个答案进行了一些扩展。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-15T11:34:37.160

这是一个缩短的“ `N-tuple`”（如 in`quadruple`等`quintuple`）

它是作为一个整体的行集的一行。

如果您发出：

```
SELECT  col1, col2
FROM    mytable 
```

，整个结果将是 a `ROWSET`，并且每一对`col1, col2`将是 a `tuple`。

一些数据库可以作为一个整体使用元组。

就像，你可以这样做：

```
SELECT  col1, col2
FROM    mytable
WHERE   (col1, col2) =
        (
        SELECT  col3, col4
        FROM    othertable
        ) 
```

，它检查一个整体是否`tuple`与另一个`rowset`整体匹配。`tuple``rowset`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T11:40:36.397

在**关系数据库**中，表是[**关系**（在数学意义上）](http://en.wikipedia.org/wiki/Relation_(mathematics))。关系是一组元组。因此关系数据库中的表行是关系元组。

维基关系：

> 在数学中（更具体地说，在集合论和逻辑中），关系是将真值分配给 k 个个体的组合（k 元组）的属性。通常，该属性描述了 k 元组的组件之间的可能连接。对于给定的一组 k 元组，根据属性是否成立，为每个 k 元组分配一个真值。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-20T03:43:39.900

无论在数学中使用什么，RDBMS 中的元组通常被认为是表或结果集中的一行。在 RDBMS 中，元组是无序的。MDDBMS 中的元组是单元格中的数据实例及其关联的维度实例（成员）。

列族数据存储中的元组是什么？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-01T09:24:05.597

元组 = 1 条记录；n-tuple = 'n' 记录的有序列表；Elmasri Navathe 书（第 198 页，第 3 版）。

记录 = 有序或无序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-08T20:31:26.790

据我了解，一个表具有一组键 K 和一个具有域 K 的键入函数 T。表的一行或“元组”是具有域 K 的函数 r，使得 r(k) 是 T 的一个元素(k) 对于每个密钥 k。因此，该术语具有误导性，因为“元组”实际上更像是一个关联数组。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-15T11:30:35.500

数据库表中的行

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-02-24T12:30:06.840

> > 元组是用于关联关系数据库中的表的已知值。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2017-09-22T16:23:29.163

元组用于引用关系数据库模型中的一行。但是元组与行有一点区别。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-15T11:31:03.190

元组用于定义来自多维数据集的数据切片；它由一个或多个维度的一个成员的有序集合组成。元组用于识别多维数据集中的多维数据的特定部分；由多维数据集中每个维度的一个成员组成的元组完整地描述了一个单元格值。

# bash - 如何在终端中打开包含“exam”字样的文件？

> ID：751266
> 
> 赞同：1
> 
> 时间：2009-04-15T11:29:08.403
> 
> 标签：bash

我想打开许多包含单词考试的 pdf 文件。我的 Mac 终端使用 Bash。

名字中的单词考试是随机的：有时在初学者，有时在中间，有时在名字的末尾。

**如何在终端中打开包含“Exam”一词的文件？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T11:32:57.880

```
find . -name "*exam*" -exec <name of pdf reader executable> {} \; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T13:43:31.407

*   不要解析`ls`。它的输出不可靠，只能用于查看（用于人类解析）。看[http://mywiki.wooledge.org/ParsingLs](http://mywiki.wooledge.org/ParsingLs)。
*   不要使用`xargs`. 它会破坏您的数据以*使其*变得更智能。文件名中有空格或引号？你可以肯定它会爆炸。

为了`xargs`表现得好，你必须竭尽全力：

```
printf '%s\0' *Exam* | xargs -0 open 
```

是的，这相当令人费解。继续阅读。

该`find`解决方案虽然准确，但它是递归的（可能是您想要的），但在提示中键入也有点多。

```
find . -name '*Exam*' -exec open {} + 
```

你可以通过记住`open`在 Mac OS X 上接受多个参数来让这一切变得更容易（这正是这样`xargs`做的），所以这对于打开当前目录中包含单词的所有文档来说是很好的`Exam`：

```
open *Exam* 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:31:14.623

就像是

```
acroread *Exam*.pdf 
```

应该管用。这匹配任何包含“Exam”并以“.pdf”结尾的字符串。这还假设您有一个名为“acroread”的命令，该命令知道如何阅读 PDF:s，这对于 Mac OS X 可能适用，也可能不适用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-15T11:33:01.017

我会使用：

```
ls *Exam* | xargs open 
```

# perl - 如何从 Perl 脚本中的外部命令收集输出？

> ID：751267
> 
> 赞同：3
> 
> 时间：2009-04-15T11:29:27.810
> 
> 标签：perl, pdf, pdflib

我有一个名为 TET.EXE 的工具，它是 PDFlib 家族的产品，它用于提取特定文本的坐标。使用 Perl 脚本中的这些坐标，我们可以提取所需的文本。这是运行 .EXE 然后将坐标提供给 Perl 的手动过程，所以有人可以建议我完成整个过程。

我的意思是 Perl 脚本本身应该运行 .EXE 并获取所需的坐标并提取文本。在 linux 中使用哪些命令来运行这个 perl 脚本？拜托，我需要您对以下内容的建议。
提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T11:45:22.983

如果我理解正确，您希望 perl 启动一个可执行文件并对打印到 stdout 的文本执行某些操作......在这种情况下，有几个选项：

[使用反引号](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)：

```
my $output = `TED.EXE`; 
```

这会将 TED.EXE 命令的输出放在变量 $output 中，并且很可能足以满足您的需要。

[使用 IPC::Open3](http://search.cpan.org/~nwclark/perl-5.8.9/lib/IPC/Open3.pm)：

```
use IPC::Open3;
my($wtr, $rdr, $err);
my $pid = open3($wtr, $rdr, $err,
                'some cmd and args', 'optarg', ...); 
```

这将运行您的命令并将 $wtr、$rdr 和 $err 关联到标准输入、输出和错误流。

还有其他方法可以做你想做的事（[Expect.pm](http://search.cpan.org/~rgiersig/Expect-1.15/Expect.pod)，[Run3](http://search.cpan.org/~rschupp/IPC-Run3-0.042/lib/IPC/Run3.pm)等），但我相信上面提到的应该足够了。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T12:00:31.230

Perl 提供了许多方法来运行外部程序并收集其输出。基于查看 tet.exe 我会说你最好的选择是使用[open](http://perldoc.perl.org/functions/open.html)函数并使用正则表达式循环输出以查找坐标：

```
open my $pdftext, "-|", "/path/to/tet.exe", "--text", $pdffile
    or die "could not open $pdffile using tet.exe: $!";

my ($x, $y);
while (my $line = <$pdftext>) {
    last if ($x, $y) = $line =~ /regex that matches the coords/;
}
die "file did not contain coordinates" unless defined $x; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T11:37:22.520

如果 TET.EXE 输出到控制台，您可以使用以下命令捕获该输出

```
my $tetOutput = `tet.exe /myoptions`; 
```

如果您想了解它，请搜索“perl backtick”

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T11:41:22.760

我不明白问题，但可能是：

```
my $result = qx{TET.EXE some.pdf some params}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T02:43:01.267

您还可以考虑另一种方法：[使用 Perl 库来提取坐标](https://stackoverflow.com/questions/196788/how-do-i-get-character-offset-information-from-a-pdf-document)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T16:44:27.433

[perlipc](http://perldoc.perl.org/perlipc.html)文档展示了许多从 Perl 与外部进程交互的方法。

许多人告诉您使用反引号，但您也可以查看[IPC::System::Simple](http://search.cpan.org/dist/IPC-System-Simple)，它通过处理操作系统特定的怪癖提供了更强大的方法来做同样的事情。

# javascript - Ajax 无法通过 readyState 1，为什么？

> ID：751269
> 
> 赞同：14
> 
> 时间：2009-04-15T11:29:45.533
> 
> 标签：javascript, ajax, readystate

我试图让这个函数工作，它会请求参数，`url`然后将 responseText 发送到`callback`它是一个函数。

似乎它只能到达`readyState 1`（感谢 Firebug 命令）。

这里是：

```
function Request(url, callback){
if (window.XMLHttpRequest) { // Mozilla, Safari, ...
    httpRequest = new XMLHttpRequest();
} else if (window.ActiveXObject) { // IE
    httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
} else{
    return false;
}
httpRequest.onreadystatechange = function(){
    console.log(httpRequest.readyState);
    if (httpRequest.readyState == 4) {
        callback(httpRequest.responseText);
    }
};
console.log(httpRequest, url);
httpRequest.open('GET', url, true);
httpRequest.send(null);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-08T06:05:38.730

我通过分配 onload 事件而不是 onreadystatechange 解决了这个问题：

```
function Request(url, callback){
if (window.XMLHttpRequest) { // Mozilla, Safari, ...
    httpRequest = new XMLHttpRequest();
} else if (window.ActiveXObject) { // IE
    httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
} else{
        return false;
}

var readyStateChange = function(){
    console.log(httpRequest.readyState);

    if (httpRequest.readyState == 4) {
                callback(httpRequest.responseText);
    }
};

if (isFirefox && firefoxVersion > 3) {
    httpRequest.onload = readyStateChange;
} else {
    httpRequest.onreadystatechange = readyStateChange;
}

console.log(httpRequest, url);
httpRequest.open('GET', url, true);
httpRequest.send(null);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T11:41:17.283

通过直接在浏览器中访问来检查有问题的 URL 是否确实响应。

用不同的浏览器测试你是否得到相同的结果。

使用某种形式的 HTTP 监视器来观察客户端到服务器的对话（我最喜欢的是[Fiddler](http://www.fiddlertool.com/fiddler)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:35:12.523

Ajax 请求可能不返回数据（因此，某种服务器端错误）。尝试在 firebug 控制台中启用选项“显示 XMLHttpRequests”，以检查这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-09T13:43:21.957

我也面临同样的问题。通过阅读下面的网址，我解决了我的问题。

[http://bytes.com/topic/javascript/answers/548442-ajax-readystate-1-wall](http://bytes.com/topic/javascript/answers/548442-ajax-readystate-1-wall)

基本上，当我将我的函数指定为 httpRequest.onreadystatechange 的事件侦听器时，我无法将任何变量传递给它。所以我必须将变量嵌入到服务器后端的 HTTP POST 字符串中，然后从 HTTP 响应中取回它。

它适用于 FF 3。无需使用 jQuery。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-01T15:32:27.553

我在 FireFox 上遇到了同样的问题，但在 Chrome 上没有。

问题是我的响应将 mime-type 设置为“application/octet-stream”。

将其更改为“text/html”使其也可以在 FireFox 上运行。

# sql - 获得下一个没有“身份”的身份证号码的最佳方法

> ID：751270
> 
> 赞同：9
> 
> 时间：2009-04-15T11:29:47.887
> 
> 标签：sql, sql-server, transactions, locking, deadlock

我必须在遗留数据库的表中插入一些记录，并且由于其他古老系统使用它，因此更改表不是解决方案。

问题是目标表有一个 int 主键但没有标识规范。所以我必须找到下一个可用的 ID 并使用它：

```
select @id=ISNULL(max(recid)+1,1) from subscriber 
```

但是，当我这样做时，我想防止其他应用程序插入表中，这样我们就不会遇到任何问题。我试过这个：

```
begin transaction
    declare @id as int
    select @id=ISNULL(max(recid)+1,1) from subscriber WITH (HOLDLOCK, TABLOCK)
    select @id
    WAITFOR DELAY '00:00:01'
    insert into subscriber (recid) values (@id)
commit transaction
select * from subscriber 
```

在 SQL Management Studio 的两个不同窗口中，一个事务总是作为死锁牺牲品被杀死。

我也先尝试`SET TRANSACTION ISOLATION LEVEL SERIALIZABLE`了相同的结果...

关于如何确保我获得下一个 id 并使用它而不冒其他人（或我！）被冲洗掉的风险，有什么好的建议吗？

很抱歉之前没有提到这一点，但这是一个 SQL 2000 服务器，所以我不能使用 FOR UPDATE 和 OUTPUT 之类的东西

## **更新**：这是对我有用的解决方案：

```
BEGIN TRANSACTION
    DECLARE @id int

    SELECT  @id=recid
    FROM    identities WITH (UPDLOCK, ROWLOCK)
    WHERE table_name = 'subscriber'

    waitfor delay '00:00:06'

    INSERT INTO subscriber (recid) values (@id)

    UPDATE identities SET recid=recid+1 
    WHERE table_name = 'subscriber'

COMMIT transaction

select * from subscriber 
```

WAITFOR 是为了让我可以有多个连接并多次启动查询以引发并发。

感谢 Quassnoi 的回答以及所有其他做出贡献的人！惊人的！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T11:38:24.403

Create another table:

```
t_identity (id INT NOT NULL PRIMARY KEY CHECK (id = 1), value INT NOT NULL) 
```

with a single row, lock this row, and increment `value` by one each time you need an `IDENTITY`.

To lock, increment, and return the new value in a single statement, use:

```
UPDATE  t_identity
SET     value = value + 1
OUTPUT  INSERTED.value 
```

If you don't want to update, just lock, then issue:

```
SELECT  value
FROM    t_identity WITH (UPDLOCK, ROWLOCK) 
```

This will lock the table until the end of the transaction.

If you always first lock `t_identity` before messing with `ancient_table`, you will never get a deadlock.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T11:34:31.123

添加另一个带有标识列的表，并使用这个新表和列来选择/生成旧表的标识值。

**Update**: Depending on the frequency of INSERTS (and the number of existing rows ***e***) you could seed your new IDENTITY values at ***e+x*** where ***x*** is sufficiently large. Thhis would avoid conflict with the legacy inserts. A sad solution, an imperfect one for sure, but something to think about?

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T17:43:41.733

**EDIT** this is basically the method purposed by @Quassnoi, I just implement it in a loop so you can run it against multiple windows at the same time to see it works great.

set up:

create user's existing table:

```
create table Subscriber
(
recid  int not null primary key
) 
```

create new table to keep track of the missing identity, you could add an extra column to keep track of a table if this is needed for multiple tables, but I hve not done that in this example:

```
CREATE TABLE SubscriberIDs
(
SubscriberID int
)
insert into SubscriberIDs values (0) --row must exist first 
```

create test script, put this into multiple windows and run them at the same time:

```
declare @idtable table --will hold next ID to use
(
id int
)
declare @x  int
declare @y  int
set @x=0
while @x<5000 --set up loop
begin
    set @x=@x+1
    begin transaction
    --get the next ID to use, lock out other users
    UPDATE SubscriberIDs
        SET SubscriberID= SubscriberID+ 1
        OUTPUT  INSERTED.SubscriberID
        INTO @idtable
    --capture the next id from temp table variable
    select @y=id from @idtable
    --print @y
    --use the next id in the actual table
    insert into subscriber values (@y)

    commit
    --print @x
    waitfor delay '00:00:00.005'
end --while 
```

**---------------------------------------------------------------**
**EDIT** here is my original attempt, which will eventually get some deadlocks when run in a loop and in multiple windows at the same time. The above method always works. I tried all combinations of transactions, with(holdlock), and set transaction isolation level serializable, etc. but could not get it to run as well as the above method.

set up:

```
create table subscriber
(
recid  int not null primary key
) 
```

used to capture the id:

```
declare @idtable table
(
id int
) 
```

the insert:

```
insert into subscriber
    OUTPUT INSERTED.recid
        recid
    INTO @idtable
    SELECT ISNULL(MAX(recid),0)+1 FROM subscriber 
```

list the new id:

```
select * from @idtable 
```

list all the ids:

```
select * from subscriber 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T08:47:25.450

You shouldn't get a deadlock here as the second should just wait for the first to complete. Your issue is that you are creating a transaction, then adding another lock while in that transaction.

Also, you are getting the ID then using it in two separate statements, whereas you could do it all in one solution:

```
set transaction isolation level serializable
begin transaction
    insert into subscriber (recid) 
       SELECT (select ISNULL(max(recid)+1,1) from subscriber)
commit transaction
select * from subscriber 
```

This should ensure that you have only consistency on your inserts. However, as you specify that legacy applications are also using this table, can you be certain that when they insert new records it won't conflict with this?

# .net - 如何检查 LINQ to SQL 连接错误

> ID：751282
> 
> 赞同：9
> 
> 时间：2009-04-15T11:32:52.810
> 
> 标签：.net, linq-to-sql, error-handling, connection

如何检查 Linq.DataContext 对象是否填充了数据并且没有出现连接错误？

谢谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-15T11:35:55.627

```
DataContext.DatabaseExists() 
```

或者

```
DataContext.Connection.Open() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T11:36:39.183

您要防范什么特定情况？

DataContext 与 DataSet 不同——它（不一定）不是数据*容器*（身份管理/更改跟踪除外）——它是数据*源*。

一般来说，如果发生错误，它不会给你一个对象（来自查询）——它会抛出一个异常。因此，如果您已经通过 LINQ-to-SQL 获得了一个实例，那么它应该包含一些内容。

您是否看到要避免的特定问题？

# sql-server - 与存储过程有关的错误

> ID：751296
> 
> 赞同：0
> 
> 时间：2009-04-15T11:35:09.233
> 
> 标签：sql-server, sql-server-2005

```
set ANSI_NULLS ON
set QUOTED_IDENTIFIER ON
GO
ALTER Procedure [dbo].[rptGGM]
(
    @FromDate datetime,
    @ToDate datetime,
    @PartyName varchar(50),
    @Type int
)

As
DECLARE @WhrStr VarChar(500)

SET @WhrStr = 
    CASE @Type
    WHEN 1 THEN
        ' And E.ATAAir between '+ @FromDate +' And '+@ToDate

    WHEN 2 THEN
        ' And D.ATASea between '+ @FromDate+ ' And '+@ToDate
    END
exec
(
'SELECT 
         A.FileNumber As [File No],
         S.POString As [PO Numbers],
         G.PartyName As [Exporter Name],
         C.CargoDesc As [Cargo Description],
         Dbo.ActualDate(A.ETA) As ETA,
         Dbo.ActualDate(IsNull(E.ATAAir, D.ATASea)) As ATA,
        S.SIString As [Supplier Invoices],
D.VesselName As [Vessel Name],
      D.VoyageNo As [Voyage No],
        dbo.PackCntDetails(A.FileID) As [Pk/Cnt Details]

FROM
    FileMain A

LEFT JOIN SIPOString S ON S.FileID=A.FileID
LEFT JOIN Party G ON G.PartyID = A.ExporterID
INNER JOIN Cargo C ON C.FileID = A.FileID
LEFT JOIN FileSea D ON D.FileID = A.FileID
LEFT JOIN FileAir E ON E.FileID = A.FileID

WHERE   
     G.PartyName='+@PartyName +' '+@WhrStr

) 
```

执行上述程序时，出现以下错误消息 241，级别 16，状态 1，程序 rptGGM，第 12 行从字符串转换日期时间时转换失败。任何人都可以帮助解决错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T14:58:04.300

作为一个没有 EXEC 的简单查询，这会简单得多。为什么你把这一切都包装在 EXEC 中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:06:09.817

使用动态 SQL 是非常糟糕的做法，因为它不仅可能因为转换问题和数据长度而失败，而且还允许 SQL 注入。

使用这样的正确查询：

```
SELECT 
         A.FileNumber As [File No],
         S.POString As [PO Numbers],
         G.PartyName As [Exporter Name],
         C.CargoDesc As [Cargo Description],
         Dbo.ActualDate(A.ETA) As ETA,
         Dbo.ActualDate(IsNull(E.ATAAir, D.ATASea)) As ATA,
        S.SIString As [Supplier Invoices],
D.VesselName As [Vessel Name],
      D.VoyageNo As [Voyage No],
        dbo.PackCntDetails(A.FileID) As [Pk/Cnt Details]

FROM
    FileMain A

LEFT JOIN SIPOString S ON S.FileID=A.FileID
LEFT JOIN Party G ON G.PartyID = A.ExporterID
INNER JOIN Cargo C ON C.FileID = A.FileID
LEFT JOIN FileSea D ON D.FileID = A.FileID
LEFT JOIN FileAir E ON E.FileID = A.FileID

WHERE   
     G.PartyName=@PartyName AND
     (
           ((@Type = 1) And (E.ATAAir Between @FromDate And @ToDate))
     Or
           ((@Type = 2) And (E.ATASea Between @FromDate And @ToDate))
     ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:41:14.867

您必须引用日期时间值

```
...
WHEN 1 THEN
    ' And E.ATAAir between '''+ CAST(@FromDate AS varchar(30)) +''' And '''+CAST(@ToDate AS varchar(30)) + ''''

WHEN 2 THEN
    ' And D.ATASea between '''+ CAST(@FromDate AS varchar(30))+ ' And '''+CAST(@ToDate AS varchar(30)) + ''''
END
... 
```

您稍后还会在@partyname 附近遇到错误：

```
...
WHERE   
     G.PartyName='''+@PartyName +''' '+@WhrStr 
```

编辑：添加了 CAST！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T11:43:28.200

在构造@WhrStr 时，您需要进行从日期时间到varchar 的显式转换。以下应该有效：

```
CAST(@FromDate as varchar) 
```

# jquery-ui - 如何在小部件事件处理程序中访问小部件选项中保存的数据

> ID：751300
> 
> 赞同：3
> 
> 时间：2009-04-15T11:35:46.407
> 
> 标签：jquery-ui

我有数据保存在选项变量中，但在选择列表的事件（OnChange）中，this 指的是 DOMElement，因此 this.options 指的是对象列表。

我能拥有的任何其他地方

```
var o = this.options; 
```

但这在这种情况下没有用。

如何获取/设置小部件信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-16T10:45:53.390

使用[`this._on()`方法](http://api.jqueryui.com/jQuery.widget/#method-_on)绑定处理程序。此方法由 jQuery UI 小部件工厂提供，将确保在处理函数中`this`始终引用小部件实例。

```
_create: function () {
    ...
    this._on(this.selectElement, {
        change: "_onChange" // Note: function name must be passed as a string!
    });
},
_onChange: function (event) {
    // 'this' is now the widget instance.
}, 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-18T11:11:29.533

您也可以简单地在事件处理程序中执行此操作（例如，对于自动完成小部件）

```
select: function(event, ui) {
   var options = jQuery(event.target).data("autocomplete").options;

   ...
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-16T13:40:16.530

```
(function($){
    $.widget(
        "ui.my_ui_widget", 
        {
            //------------------------------------------------------------------
            _init : function(){
                var o = this.options; // 2
                o.context = this;
                ...
                // 3
                $('#'+o.id).bind('change', {context:this}, this.on_change );
                ...
            },
            //------------------------------------------------------------------
            on_change: function(event) {
                var context = event.data.context; // 4
            var o       = context.options;

                o.id = ''; // 5

                var sel = this; // event handler context
                var selectedIndex = sel.selectedIndex;
                if (selectedIndex < 0) return;

                o.id = sel.options[selectedIndex].value; // 5

                context.update_ui(); // 6
            },
            //------------------------------------------------------------------
        } 
    );
    //--------------------------------------------------------------------------
    $.extend( $.ui.my_ui_widget, {
        getter       : "id",
        getterSetter : "xxx, yyy",

        defaults : {
               ...
             context   : undefined, // 1
             ...
             on_change : undefined,
               ...
            }
        }
    );
    //--------------------------------------------------------------------------
})(jQuery);

$(document).ready(function() {
    $('.my_ui_widget').each( function(i) {
            var id = this.id;
            var mode = '';

            try{
                mode = this.attributes['mode'].value;
            } catch(err) {
                mode = 'unlinked';
            }

            $('#'+id).my_ui_widget( {id:id, mode:mode} );
        }
    );
}); 
```

1.  从一开始就启用上下文
2.  记住小部件的 this 作为上下文（如果愿意，也可以是 self）
3.  以 jquery 方式将上下文传递给事件处理程序
4.  在处理程序端需要时提取
5.  访问小部件数据
6.  根据需要调用小部件方法

# c# - 无法将类型“X”隐式转换为“字符串”——它何时以及如何确定它“不能”？

> ID：751303
> 
> 赞同：17
> 
> 时间：2009-04-15T11:36:27.543
> 
> 标签：c#, type-conversion, tostring

现在我和`Guid`s 在一起。

我当然记得，在某些地方的整个代码中，这种隐式转换有效，而在其他地方则无效。直到现在我还没有看到这种模式。

编译器如何决定何时不能？我的意思是，`Guid.ToString()`存在类型方法，不是在需要这种转换时调用吗？

有人可以告诉我这种转换在什么情况下会自动完成以及何时必须`myInstance.ToString()`明确调用？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-15T11:39:05.277

简而言之，当定义了隐式或显式转换运算符时：

```
class WithImplicit {
    public static implicit operator string(WithImplicit x) {
        return x.ToString();}
}
class WithExplicit {
    public static explicit operator string(WithExplicit x) {
        return x.ToString(); }
}
class WithNone { }

class Program {
    static void Main() {
        var imp = new WithImplicit();
        var exp = new WithExplicit();
        var none = new WithNone();
        string s1 = imp;
        string s2 = (string)exp;
        string s3 = none.ToString();
    } 
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T11:48:20.700

您实际上不需要自己调用 ToString() 的唯一地方是连接字符串时。

```
Guid g;
int i;
string s = "Hello "+g+' '+i; 
```

然后在某些情况下，调用是由 .NET Framework 进行的，例如在[String.Format()](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)中。

除此之外，编译器只会转换已知兼容的类型（例如基类或实现接口或通过显式编码的转换运算符）。当您使用强制转换并且编译器知道类型不兼容时（例如，不在同一继承行中，而不是接口），它也会说它无法转换它。泛型类型参数也是如此。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T11:49:19.807

不，没有从`GUID`to的隐式转换`String`，因此这在代码中的任何地方都不起作用。

它仅适用于有显式转换的情况，但转换可能不是很明显。例如，当您连接字符串时：

```
string id = "--" + guidValue + " : " + num; 
```

这可能看起来像是从`GUID`to的隐式转换`String`，但事实并非如此。生成的代码实际上如下所示：

```
string id = String.Concat(new object[] { "--", guidValue, " : ", num }); 
```

所有操作数都转换为类型`Object`并放置在数组中。然后该方法为数组中的每个项目`String.Concat`调用该`ToString`方法以获取它们的字符串表示形式。

# delphi - Delphi：在变量数组中传递 TObject

> ID：751313
> 
> 赞同：3
> 
> 时间：2009-04-15T11:39:05.930
> 
> 标签：delphi, variant, tobject

我有一个需要 TObject 类型参数的过程，如下所示：

```
MyProcedure (const AValue : TObject); 
```

我有一个 Variant 数组，我正在循环调用该过程，如下所示：

```
 for i:=0 to High(myArray) do
    MyProcedure (myArray[i]); 
```

编译器给出错误提示：“不兼容的类型：TObject 和 Variant”。

我能做些什么来解决这个问题？

**更多信息：**到目前为止，我一直在变量数组中传递简单类型（字符串、数字、日期）（这些数组通常是不同类型的混合——我最终将它们作为参数传递给数据库存储过程）。现在我还需要（在某些情况下）传递一个 TObject。

传递值的最合适的数据类型/结构是什么，可以同时保存简单类型和对象？我想我可以创建我自己的 TParam 类型，它对两者都有一个字段，但我不确定确切的语法。有人有这方面的例子吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T11:56:48.977

Variant 不能包含对象，它只能包含原始类型，例如整数和字符串。

我建议将您的数组更改为您想要的类型而不是变体。如果您不确定所需的对象类型，则创建一个 TObject 数组或您的数组将包含的对象的最低基类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T11:54:03.587

您不能存储普通对象是一种变体。但是你可以存储接口。

```
var
  v : Variant;
  i : IInterface;

begin
  v := i; // Works perfectly;
end. 
```

查看变体的类型：

```
varEmpty    = $0000; { vt_empty        0 }
varNull     = $0001; { vt_null         1 }
varSmallint = $0002; { vt_i2           2 }
varInteger  = $0003; { vt_i4           3 }
varSingle   = $0004; { vt_r4           4 }
varDouble   = $0005; { vt_r8           5 }
varCurrency = $0006; { vt_cy           6 }
varDate     = $0007; { vt_date         7 }
varOleStr   = $0008; { vt_bstr         8 }
varDispatch = $0009; { vt_dispatch     9 }
varError    = $000A; { vt_error       10 }
varBoolean  = $000B; { vt_bool        11 }
varVariant  = $000C; { vt_variant     12 }
varUnknown  = $000D; { vt_unknown     13 }
//varDecimal  = $000E; { vt_decimal     14 } {UNSUPPORTED as of v6.x code base}
//varUndef0F  = $000F; { undefined      15 } {UNSUPPORTED per Microsoft}
varShortInt = $0010; { vt_i1          16 }
varByte     = $0011; { vt_ui1         17 }
varWord     = $0012; { vt_ui2         18 }
varLongWord = $0013; { vt_ui4         19 }
varInt64    = $0014; { vt_i8          20 }
varUInt64   = $0015; { vt_ui8         21 } 
```

如果你真的想要，你可以将 TObject 转换为 Pointer to Integer 并存储它。但我不确定这是否是你真正想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T11:50:29.057

我的第一反应是问为什么要将 TObjects 存储在变体列表中，但假设您有充分的理由！

如果您首先设法将 TObject 实例放置在 Array 中，那么您可能将指针放置在了 Tobject 中。在这种情况下，您需要做的是将 Variant/Integer 类型转换为 TObject 例如

```
for i:=0 to High(myArray) do
    MyProcedure (TObject(myArray[i])); 
```

这应该有效，但是与任何类型转换一样，您需要确保 myArray[i] 实际上是指向 TObject 实例的指针，否则可能会发生可怕的事情。

你确定 TList 不会做你想做的事。变体实际上是为了存储基本类型，例如字符串、整数、浮点数、布尔值而不是对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T12:25:19.220

我认为用 Variant 变量和 TOBject 变量创建 TParam 不是一个好主意。就像是：

```
Tobject = record
  prim: Variant;
  obj: TObject;
end 
```

会工作，但对我来说似乎很乱。Pascal 不是一种动态类型的语言，我不会尝试将其视为一种语言。我会建议：

创建另一个函数来处理变体，以及拥有

```
MyProcedure (const AValue : TObject); 
```

也有

```
MyProcedure (const AValue : Variant); 
```

并单独处理您的数据。或者创建一个定义您的数据输入的记录，例如，不要让变体和对象的 TParam 具有以下内容：

```
TStoredProcParm = record
  name: String;
  bought: TDateTime;
end; 
```

等等。也许您有太多不同的数据，以至于变体/对象路由是最好的，但这似乎有点让人头疼 - 当您的其他代码通过 Variant 数组时，您如何知道哪个变体是哪个以及如何使用每个它们在您的存储过程中？

# delphi - Delphi Win32：加速动态创建的控件（父属性）

> ID：751318
> 
> 赞同：7
> 
> 时间：2009-04-15T11:39:56.583
> 
> 标签：delphi, user-interface, dynamic

我们有几个动态构建其内容的框架的 GUI。每个框架创建面板、标签、编辑、组合框等用作输入字段。这工作得很好，我们还计划让每个框架在单独的线程中构建其内容。

但是有一个大问题：它相当慢！创建控件不需要时间，但设置 Parent 属性似乎非常耗时。

我尝试了几种方法来加快这个过程，但没有运气。我试过 Enabled=False, Visible=False, DisableAlign, LockWindowUpdate, WM_SETREDRAW... 但似乎没有什么影响设置控件父级的耗时过程。

即使我们使用线程，这也需要时间，因为 VCL 函数必须在 Synchronize 中调用。

有没有其他方法可以加快控件的创建和显示？

亲切的问候，马格努斯

**编辑：**没有数据感知组件或 GUI 中触发的任何事件。我只是创建控件并显示它们。使用计时器，我已将控件父级 (AControl.Parent := AOwner) 的分配确定为耗时的部分。

**编辑2：**如下面的答案所示，速度问题不是设置父级而是控件的绘制。当我测试容器可见的时间并设置父级时，会立即绘制控件。

**编辑 3：**我们的动态 GUI 的另一个耗时部分是将项目分配给组合框。ComboBox.Items.Assign(DataItems) 其中 DataItems 的项目不超过三到六个。

*谢谢大家花时间帮助我！*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T12:02:58.543

不要尝试使用多个线程来创建控件，或者通常使用 VCL。无论如何，这不会提高速度，但更重要的是完全禁止使用 VCL。

**编辑：**您应该阅读 StackOverflow 上处理 VCL 和多线程的其他问题和答案，但简而言之：VCL 不是线程安全的，对控件的所有访问都必须在主线程的上下文中完成。因此，当使用多个线程时，您必须将几乎所有内容都包装在*Synchronize()*调用中，这实际上会序列化所有线程并进一步减慢速度。

最好的办法是重构你的 UI，这样它就不需要一次全部创建。按需创建所有帧，仅在它们首次显示时。

**编辑 2：**这里有一些测试代码显示设置 Parent 属性不是真正的问题，但创建所有控件（以及需要的所有消息处理）可能是。

```
procedure TForm1.Button1Click(Sender: TObject);
var
  i, j, x, y: integer;
  Edit: TEdit;
  Ticks: LongWord;
begin
  Visible := FALSE;
  DestroyHandle;

  try
    for i := 1 to 20 do begin
      y := 20 + i * 25;
      for j := 1 to 10 do begin
        x := (j - 1) * 100;

        Edit := TEdit.Create(Self);
        Edit.SetBounds(x, y, 98, 23);
        Edit.Parent := Self;
      end;
    end;
  finally
    Ticks := timeGetTime;
    Visible := TRUE;
    Caption := IntToStr(timeGetTime - Ticks);
  end;
end; 
```

代码在释放父窗体的句柄后动态创建 200 个*TEdit控件。*在我的系统上创建所有这些控件并设置它们的属性需要 10 毫秒，但最终显示表单（将创建所有窗口）需要 100 毫秒。由于这只能在主线程中完成，我怀疑使用多个线程会对您有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T11:59:33.590

我不知道这是否可行，但是您是否尝试过将表单创建为 .dfm 文本格式，然后使用 ObjectTextToBinary 函数将 .dfm 直接加载到表单中。这可能有效，也可能无效，值得研究。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T13:22:09.070

你在设置 DisableAlign 什么？尝试对每个可以容纳子控件（例如面板）的控件执行 DisableAlign。我之前已经看到 DisableAlign 导致动态构建表单的巨大加速。

**编辑：**再想一想，我的回答部分是推测性的。我不知道在控件树的根上设置 DisableAlign 的效果是否会流向它的子级。我认为它不会，但也许它会。我必须查看 VCL 代码。（然而，关于加速的部分是真实的。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T13:25:43.163

另一个疯狂的猜测：尝试使用 Visible := false 创建您的容器（表单、面板或框架）。然后将所有动态创建的控件附加到它上面，然后设置 Visible := true

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T16:19:34.867

我前段时间发现了这个问题，并通过简单地将控件托管在“临时”框架（即未分配给表单的框架）中来显着改善创建时间。我相信缓慢是由于每个控件与父表单（最终）进行大量调用（例如 SetBounds、SetVisible 等）进行通信。通过使用浮动框架，您可以完成并完成此操作，然后将框架分配给表单你需要的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T12:25:51.840

您可以将数据的实际检索分流到后台线程，但 UI 内容必须发生在一个线程中，即主线程。所以你的框架的实际设置将发生在同一个线程中。

你试过探查器吗？可能是您的 GUI 过于连接，并且更新/接线会导致许多不必要的事件/副作用。使用分析器，您可以更深入地了解导致性能低下的真正原因。例如，它可能表明您花了很多时间等待数据库返回，或者可能是每个集合都触发了一个事件，该事件触发了另一个事件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T12:36:45.090

如果您使用数据件控件，请确保在 TDataSet 中调用 DisableControls。这也可能导致许多重绘。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T13:07:41.523

只是一个疯狂的猜测：也许它有助于以相反的层次顺序设置控件的父级，即首先设置嵌套最深的控件的父级，然后是其父级的父级，依此类推。这***可能会***切断一些多余的刷新，因为 Windows 还不“知道”您的控件。

# c# - 如何使用命名内容创建 WPF 用户控件

> ID：751325
> 
> 赞同：110
> 
> 时间：2009-04-15T11:41:25.067
> 
> 标签：c#, wpf, xaml, user-controls, controls

我有一组带有附加命令和逻辑的控件，它们以相同的方式不断重复使用。我决定创建一个包含所有常用控件和逻辑的用户控件。

但是，我还需要控件来保存可以命名的内容。我尝试了以下方法：

```
<UserControl.ContentTemplate>
    <DataTemplate>
        <Button>a reused button</Button>
        <ContentPresenter Content="{TemplateBinding Content}"/>
        <Button>a reused button</Button>
    </DataTemplate>
</UserControl.ContentTemplate> 
```

但是，似乎无法命名放置在用户控件内的任何内容。例如，如果我按以下方式使用控件：

```
<lib:UserControl1>
     <Button Name="buttonName">content</Button>
</lib:UserControl1> 
```

我收到以下错误：

> 无法在元素“按钮”上设置名称属性值“按钮名称”。'Button' 位于元素 'UserControl1' 的范围内，当它在另一个范围中定义时，它已经注册了一个名称。

如果我删除 buttonName，那么它会编译，但是我需要能够命名内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2010-08-05T09:28:48.517

答案是不使用 UserControl 来执行此操作。

创建一个扩展**ContentControl的类**

```
public class MyFunkyControl : ContentControl
{
    public static readonly DependencyProperty HeadingProperty =
        DependencyProperty.Register("Heading", typeof(string),
        typeof(MyFunkyControl), new PropertyMetadata(HeadingChanged));

    private static void HeadingChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        ((MyFunkyControl) d).Heading = e.NewValue as string;
    }

    public string Heading { get; set; }
} 
```

然后使用样式来指定内容

```
<Style TargetType="control:MyFunkyControl">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="control:MyFunkyControl">
                <Grid>
                    <ContentControl Content="{TemplateBinding Content}"/>
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

最后 - 使用它

```
<control:MyFunkyControl Heading="Some heading!">            
    <Label Name="WithAName">Some cool content</Label>
</control:MyFunkyControl> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-04-16T19:58:02.697

使用 XAML 时，这似乎是不可能的。当我实际上拥有我需要的所有控件时，自定义控件似乎有点过头了，但只需将它们与少量逻辑组合在一起并允许命名内容。

[正如 mackenir 所建议的，京东博客](http://blog.bluecog.co.nz/archives/2007/08/27/wpf-cannot-set-name-attribute/)上的解决方案似乎是最好的折衷方案。扩展 JD 的解决方案以允许仍然在 XAML 中定义控件的方法如下：

```
 protected override void OnInitialized(EventArgs e)
    {
        base.OnInitialized(e);

        var grid = new Grid();
        var content = new ContentPresenter
                          {
                              Content = Content
                          };

        var userControl = new UserControlDefinedInXAML();
        userControl.aStackPanel.Children.Add(content);

        grid.Children.Add(userControl);
        Content = grid;           
    } 
```

在上面的示例中，我创建了一个名为 UserControlDefinedInXAML 的用户控件，它的定义与使用 XAML 的任何普通用户控件一样。在我的 UserControlDefinedInXAML 中，我有一个名为 aStackPanel 的 StackPanel，我希望我的命名内容出现在其中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-23T20:10:59.850

我使用的另一种选择是在事件中设置`Name`属性。`Loaded`

就我而言，我有一个相当复杂的控件，我不想在代码隐藏中创建它，它会为某些行为寻找一个具有特定名称的可选控件，因为我注意到我可以将名称设置为`DataTemplate`我想我也可以在`Loaded`活动中做到这一点。

```
private void Button_Loaded(object sender, RoutedEventArgs e)
{
    Button b = sender as Button;
    b.Name = "buttonName";
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-09T09:23:48.633

有时您可能只需要引用 C# 中的元素。然后，根据用例，您可以设置 an`x:Uid`而不是 an`x:Name`并通过调用 Uid finder 方法（如[Get object by its Uid in WPF](https://stackoverflow.com/questions/1887611/get-object-by-its-uid-in-wpf) ）来访问元素。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-06T00:09:57.200

您可以使用此帮助器在用户控件中设置名称：

```
using System;
using System.Reflection;
using System.Windows;
using System.Windows.Media;
namespace UI.Helpers
{
    public class UserControlNameHelper
    {
        public static string GetName(DependencyObject d)
        {
            return (string)d.GetValue(UserControlNameHelper.NameProperty);
        }

        public static void SetName(DependencyObject d, string val)
        {
            d.SetValue(UserControlNameHelper.NameProperty, val);
        }

        public static readonly DependencyProperty NameProperty =
            DependencyProperty.RegisterAttached("Name",
                typeof(string),
                typeof(UserControlNameHelper),
                new FrameworkPropertyMetadata("",
                    FrameworkPropertyMetadataOptions.None,
                    (d, e) =>
                    {
                        if (!string.IsNullOrEmpty((string)e.NewValue))
                        {
                            string[] names = e.NewValue.ToString().Split(new char[] { ',' });

                            if (d is FrameworkElement)
                            {
                                ((FrameworkElement)d).Name = names[0];
                                Type t = Type.GetType(names[1]);
                                if (t == null)
                                    return;
                                var parent = FindVisualParent(d, t);
                                if (parent == null)
                                    return;
                                var p = parent.GetType().GetProperty(names[0], BindingFlags.Instance | BindingFlags.Public | BindingFlags.SetProperty);
                                p.SetValue(parent, d, null);
                            }
                        }
                    }));

        public static DependencyObject FindVisualParent(DependencyObject child, Type t)
        {
            // get parent item
            DependencyObject parentObject = VisualTreeHelper.GetParent(child);

            // we’ve reached the end of the tree
            if (parentObject == null)
            {
                var p = ((FrameworkElement)child).Parent;
                if (p == null)
                    return null;
                parentObject = p;
            }

            // check if the parent matches the type we’re looking for
            DependencyObject parent = parentObject.GetType() == t ? parentObject : null;
            if (parent != null)
            {
                return parent;
            }
            else
            {
                // use recursion to proceed with next level
                return FindVisualParent(parentObject, t);
            }
        }
    }
} 
```

并且您的 Window 或 Control Code Behind 设置您通过属性控制：

```
 public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

    }

    public Button BtnOK { get; set; }
} 
```

你的窗口 xaml：

```
 <Window x:Class="user_Control_Name.MainWindow"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:test="clr-namespace:user_Control_Name"
            xmlns:helper="clr-namespace:UI.Helpers" x:Name="mainWindow"
            Title="MainWindow" Height="350" Width="525">
        <Grid>
            <test:TestUserControl>
                <Button helper:UserControlNameHelper.Name="BtnOK,user_Control_Name.MainWindow"/>
            </test:TestUserControl>
            <TextBlock Text="{Binding ElementName=mainWindow,Path=BtnOK.Name}"/>
        </Grid>
    </Window> 
```

UserControlNameHelper 获取您的控件名称和您的类名称，以便将 Control 设置为 Property。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-16T13:57:19.440

我选择为我需要获取的每个元素创建一个额外的属性：

```
 public FrameworkElement First
    {
        get
        {
            if (Controls.Count > 0)
            {
                return Controls[0];
            }
            return null;
        }
    } 
```

这使我能够访问 XAML 中的子元素：

```
<TextBlock Text="{Binding First.SelectedItem, ElementName=Taxcode}"/> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-21T19:50:22.023

```
<Popup>
    <TextBox Loaded="BlahTextBox_Loaded" />
</Popup> 
```

后面的代码：

```
public TextBox BlahTextBox { get; set; }
private void BlahTextBox_Loaded(object sender, RoutedEventArgs e)
{
    BlahTextBox = sender as TextBox;
} 
```

真正的解决方案是让微软解决这个问题，以及所有其他视觉树损坏的问题。假设地说。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-05-13T14:45:14.647

另一种解决方法：将元素引用为**RelativeSource**。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-30T07:16:50.557

在将一堆命名控件放入其中时，我使用 TabControl 时遇到了同样的问题。

我的解决方法是使用一个控件模板，其中包含要在标签页中显示的所有控件。在模板内部，您可以使用 Name 属性，也可以至少在同一模板内部使用来自其他控件的数据绑定到命名控件的属性。

作为 TabItem 控件的内容，使用一个简单的控件并相应地设置 ControlTemplate：

```
<Control Template="{StaticResource MyControlTemplate}"/> 
```

从后面的代码访问模板内的那些命名控件需要使用可视化树。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-01-30T21:18:28.340

我遇到了这个问题并找到了一种解决方法，可以让您使用 Xaml 设计自定义控件。它仍然有一些技巧，但它解决了我所有的问题而没有任何明显的妥协。

基本上，您可以按照通常使用 xaml 的方式执行所有操作，但您还可以在控件模板本身上包含一些标头声明，并对要在代码构造函数中加载的模板进行 Base64 编码。此 Xaml 摘录中未显示，但我使用的完整 Xaml 命名空间实际上是针对 XamlTemplates 而不是 Controls 命名空间。这是故意的，因为“发布”构建将开发调试引用从我的生产控制命名空间中移开。更多关于下面的内容。

```
<ControlTemplate TargetType="{x:Type TabControl}" 
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid x:Name="templateRoot" 
          ClipToBounds="True" 
          SnapsToDevicePixels="True" 
          Background="Transparent"
          KeyboardNavigation.TabNavigation="Local">
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="ColumnDefinition0"/>
            <ColumnDefinition x:Name="ColumnDefinition1" Width="0"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition x:Name="RowDefinition0" Height="Auto"/>
            <RowDefinition x:Name="RowDefinition1" Height="*"/>
        </Grid.RowDefinitions>
        <TabPanel x:Name="HeaderPanel"
                  Panel.ZIndex="1"                          
                  Margin="{Binding MarginHeaderPanel, RelativeSource={RelativeSource AncestorType=TabControl}}"
                  Background="{Binding Background, RelativeSource={RelativeSource AncestorType=TabControl}}"
                  IsItemsHost="True"                          
                  KeyboardNavigation.TabIndex="2"/>
        <Border x:Name="blankregion" Panel.ZIndex="1" Margin="0" Padding="0" 
                Background="{Binding Background, RelativeSource={RelativeSource AncestorType=TabControl}}">
            <ContentPresenter x:Name="blankpresenter"                                      
                              KeyboardNavigation.TabIndex="1"    
                              Content="{Binding TabBlankSpaceContent, RelativeSource={RelativeSource AncestorType=TabControl}}"                                          
                              ContentSource="TabBlankSpaceContent" 
                              SnapsToDevicePixels="True"/>
        </Border>

        <Grid x:Name="ContentPanel">
            <Border 
                BorderBrush="{Binding BorderBrush, RelativeSource={RelativeSource AncestorType=TabControl}}"
                BorderThickness="{Binding BorderThickness, RelativeSource={RelativeSource AncestorType=TabControl}}"                       
                Background="{Binding SelectedItem.Background, RelativeSource={RelativeSource AncestorType=TabControl}}"
                KeyboardNavigation.DirectionalNavigation="Contained" 
                KeyboardNavigation.TabNavigation="Local"                                           
                CornerRadius="{Binding BorderRadius, RelativeSource={RelativeSource AncestorType=TabControl}}"
                KeyboardNavigation.TabIndex="3">
                <ContentControl x:Name="PART_SelectedContentHost" 
                                ContentTemplate="{Binding SelectedContentTemplate, RelativeSource={RelativeSource AncestorType=TabControl}}"
                                Content="{Binding SelectedContent, RelativeSource={RelativeSource AncestorType=TabControl}}"
                                ContentStringFormat="{Binding SelectedContentStringFormat, RelativeSource={RelativeSource AncestorType=TabControl}}" 
                                Margin="{Binding Padding, RelativeSource={RelativeSource AncestorType=TabControl}}"
                                SnapsToDevicePixels="{Binding SnapsToDevicePixels, RelativeSource={RelativeSource AncestorType=TabControl}}"/>
            </Border>

        </Grid>
    </Grid>
    <ControlTemplate.Triggers>
        <!--Triggers were removed for clarity-->
    </ControlTemplate.Triggers>
</ControlTemplate> 
```

我要指出的是，上面的 XAML 没有命名它派生的控件，并且模板中的所有内容都使用相对查找来绑定其属性；甚至是定制的。

在 C# 方面，我使用 Xaml 中的控件模板的 Base64 编码版本和指令来调整控件的开发/发布版本。理论是我在开发空间中的控件不会遇到这个主题所涉及的问题，但会给我一种测试/开发它们的方法。发布的 DLL 版本似乎工作得非常好，并且所构建的控件确实具有很好的设计时支持，就像它们在调试/开发方面所做的那样。

```
#if DEBUG
namespace AgileBIM.Controls
{
    public class AgileTabControl : AgileBIM.XamlTemplates.AgileTabControlDesigner { }
}

namespace AgileBIM.XamlTemplates
#else
namespace AgileBIM.Controls
#endif
{
#if DEBUG    
    public partial class AgileTabControlDesigner : TabControl
#else
    public class AgileTabControl : TabControl
#endif
    {

#if DEBUG
        private static Type ThisControl = typeof(AgileTabControlDesigner);
#else
        private static Type ThisControl = typeof(AgileTabControl);
        private string Template64 = "Base64 encoded template removed for clarity"
#endif

#if DEBUG
        public AgileTabControlDesigner() { InitializeComponent(); }
#else
        public AgileTabControl()
        {
            string decoded = System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(Template64));
            System.IO.StringReader sr = new System.IO.StringReader(decoded);
            System.Xml.XmlReader xr = System.Xml.XmlReader.Create(sr);
            ControlTemplate ct = (ControlTemplate)System.Windows.Markup.XamlReader.Load(xr);

            DefaultStyleKey = ThisControl;
            Template = ct;
        }
#endif

        public Thickness MarginHeaderPanel 
        {
            get { return (Thickness)GetValue(MarginHeaderPanelProperty); } 
            set { SetValue(MarginHeaderPanelProperty, value); } 
        }
        public static readonly DependencyProperty MarginHeaderPanelProperty =
            DependencyProperty.Register("MarginHeaderPanel", typeof(Thickness), ThisControl, new PropertyMetadata(new Thickness(0)));

        public CornerRadius BorderRadius 
        { 
            get { return (CornerRadius)GetValue(BorderRadiusProperty); } 
            set { SetValue(BorderRadiusProperty, value); }
        }
        public static readonly DependencyProperty BorderRadiusProperty =
            DependencyProperty.Register("BorderRadius", typeof(CornerRadius), ThisControl, new PropertyMetadata(new CornerRadius(0)));

        public object TabBlankSpaceContent 
        { 
            get { return (object)GetValue(TabBlankSpaceContentProperty); } 
            set { SetValue(TabBlankSpaceContentProperty, value); } 
        }
        public static readonly DependencyProperty TabBlankSpaceContentProperty =
            DependencyProperty.Register("TabBlankSpaceContent", typeof(object), ThisControl, new PropertyMetadata());
    }
} 
```

在创建要在主应用程序中使用的“发布”控件 DLL 之前要记住的关键事项是使用最新最好的控件模板版本更新 base64 编码字符串。这是因为 Release 版本与原始 Xaml 完全分离，完全依赖于编码版本。

上面的控件和其他类似的控件可以在[GitHub](https://github.com/AgileBIM/AgileBIM.Controls)上找到。这是我正在制作的一个库，旨在“解锁”许多我想要设置标准控件不公开的样式的东西。那并添加一些不存在的功能。例如，上面的 TabControl 有一个附加的 content 属性，用于利用选项卡标题的“未使用”区域。

### 重要笔记：

*   使用此方法会丢失基本样式，但如果您的自定义控件样式使用该`BasedOn="{StaticResource {x:Type TabControl}}"`机制，您可以将其全部恢复。
*   我需要花时间研究这是否会导致任何值得注意的内存泄漏，以及我是否可以采取任何措施来对抗它们，如果有人对此有任何想法，请在评论中告诉我。

# cakephp - 选择性地为 CakePHP 中的某些操作启用 SSL

> ID：751338
> 
> 赞同：6
> 
> 时间：2009-04-15T11:44:38.710
> 
> 标签：cakephp, ssl, https

我正在尝试为基于 CakePHP 的网站上的某些操作启用 SSL。我正在使用 requireSecure() 并在相应的 blackHoleCallback() 中重定向到[https://url 。](https://url)

为了降低服务器负载，一旦用户完成需要 SSL 的操作，我想重定向回[http://whatever_url 。](http://whatever_url)

我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T11:59:46.083

所以这是我遇到的一种解决方案。我将以下代码段添加到`beforeFilter()`in `AppController`：

```
if (!in_array($this->action, $this->Security->requireSecure) and env('HTTPS'))
    $this->_unforceSSL(); 
```

函数定义为：

```
function _unforceSSL() {
    $this->redirect('http://' . $_SERVER['SERVER_NAME'] . $this->here);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-08T10:30:00.520

确保对安全页面使用需要安全连接的 cookie，对非安全页面使用普通 cookie。这样，如果有人捕获了不安全的 cookie，他们将无法劫持任何敏感信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-11T08:19:50.557

我不喜欢重定向方法的是用户仍然会访问不安全的 url，并且只有在此之后他才会被重定向。

我想在 html->link/url 级别完成一些事情，根据您传递的内容返回 ssl/non-ssl 链接，类似于： [http ://cakephp.1045679.n5.nabble.com/Re-Login -通过-HTTPS-on-CakePHP-td1257438.html](http://cakephp.1045679.n5.nabble.com/Re-Login-through-HTTPS-on-CakePHP-td1257438.html) 但也使用安全组件

**稍后编辑**，我做了一些更简单的事情，刚刚完成了我的工作，我尝试创建一个简单的示例（不要忘记在 config/core.php 或 bootstrap.php 中定义 MYAPP_SECURE_URL）：在应用程序中我创建了 app_helper.php：

```
class AppHelper extends Helper {
    function url($url = null, $full = false) {
        if($url['action'] == 'login' && $url['controller'] == 'users') {
            return MYAPP_SECURE_URL.'/users/login';
        }
        return h(Router::url($url, $full));
    }
} 
```

# python - 为什么此 pyd 文件无法在某些计算机上导入？

> ID：751339
> 
> 赞同：10
> 
> 时间：2009-04-15T11:45:05.777
> 
> 标签：python, windows

我的 python 项目有一个 C++ 组件，它在 Python egg 中编译和分发为 .pyd 文件。我注意到它似乎只与我们全新的一些 64 位 Windows 服务器不兼容。我们有 4 台（据称）配置相同的机器——每台都运行 Windows 2003 server 64 位版本，但其中 2 台机器不允许我调用 egg 中的函数。

经过一些实验后，我找到了[产生可重现错误](http://pastebin.com/m6d6aef7e)的方法。当 Python 尝试导入 pyd 文件时，似乎会出现问题。

我将 pyd 复制到一个临时文件夹并从该位置运行 Python.exe，顺便说一下，我们仍在使用 Python 2.4.4 的 32 位版本，因为我们的库还没有移植到 64 位架构。接下来我尝试导入我的模块（称为 pyccalyon）。第一次尝试此操作时，我收到一条错误消息：

```
"ImportError: DLL load failed: The specified module could not be found" 
```

下次我尝试这个时，python 解释器崩溃了：根本没有堆栈跟踪！

你自然会怀疑我的 PYD - 奇怪的是它已经在数千台 PC 和 10 台其他服务器上使用，其中许多是相同规格的 64 位机器。该项目在开发和发布后都在不断测试，所以如果这个东西如此不稳定，我们很久以前就知道它了。这个组件被认为是稳定的代码，所以它的崩溃如此惊人是令人惊讶的。

对我可以做些什么来调试这个麻烦的库有什么建议吗？在这一点上欢迎疯狂的想法，因为我们已经用尽了所有明智的想法。

谢谢！

**更新 0**：好的，使用进程监视器我能够将一个失败的 64 位服务器与另一个运行良好的服务器进行比较。我发现损坏似乎是由于缺少 DLL、SysWOW64/mscoreee.dll 而发生的——知道这个组件是什么以及我在哪里可以得到它吗？我可以将此反馈给我们的 IT 配置人员，他们可以安装东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T11:53:12.217

您可以尝试类似[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)的方法，以查看它尝试加载的 DLL。我假设找不到它依赖的其他 DLL 之一。

编辑：看起来您已经设法从中获得了一些有用的信息，但我将阐明如何减少 procmon 产生的大量信息。

使用过滤器函数指定命令行（在这种情况下，要求命令行包含python）。这将只向您显示来自您感兴趣的进程的消息。然后您可以过滤掉所有成功结果，这样您就可以看到它正在寻找哪个 DLL。

显然还有很多其他的东西你可以过滤，但这就是我过去得到结果的方式。这是一个非常方便的工具，可以用来计算在这种情况下发生的事情。

（depends 或 DependencyWalker 之类的工具也有助于找出库所依赖的 DLL - 它们提供静态信息，而 procmon 会显示动态视图。它们都很有用。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T11:49:07.123

您是否尝试过检查 PYD 链接的 DLL？例如，您可以使用[Dependency Walker](http://www.dependencywalker.com/)或 VS 的depends.exe 来做到这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T13:10:49.097

根据[Microsoft 的知识库](http://support.microsoft.com/kb/316091)，mscoree.dll 是 .NET Framework 的一部分。确切地说，它是 Microsoft .NET 运行时执行引擎。

获得它的方法是（重新）安装 .NET Framework。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T11:54:28.173

也许您在它不起作用的机器上缺少 C++ 运行时/标准库 DLL，并且模块正在尝试使用它们？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-24T02:02:34.283

刚遇到同样的问题，depends.exe 向我展示了它`foo.pyd`是用`python25.lib`而不是`python27.lib`. 所以找不到`python25.dll`。

# css - 如何使用 CSS 让列表项保持在一起？

> ID：751360
> 
> 赞同：2
> 
> 时间：2009-04-15T11:50:54.890
> 
> 标签：css, list, layout, styling

HTML的骨架是这样的

```
<div class="TwoCol">
<img src="imgurl"/>
<h1>A headline</h1>
<p>Some exciting text</p>
<ul>
<li>Item A</li>
<li>Item B</li>
<li>Item C</li>
</ul>
<p>More riveting text </p>
</div> 
```

CSS是

```
.TwoCol img{
    float:left;
    padding-right:5px;
    border:none;
}
.TwoCol ul{
list-style-type:none;
} 
```

我所追求的效果是我的 div 左上角的图像，如果文本比它环绕在图像下方的图像长，则文本在右侧。

但是，如果列表从图像的右侧开始，我希望所有项目在彼此下方垂直对齐，而不是图像下方的列表项出现在图像下方并将列表分成两部分。

我需要一个图像素描实用程序:)

这

```
IMG Headline
IMG Para1
IMG Item A
    Item B
    Item C
Para2 
```

不是这个

```
IMG Headline
IMG Para1
IMG Item A
Item B
Item C
Para2 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T13:11:40.733

你可以设置`<ul>`为

```
display: inline-block; 
```

您可能还想要`clear: left;`您的图像，因为根据其他内容，它们可能会开始彼此相邻堆叠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T11:54:12.167

添加`margin-left`到你的`ul`那是图像的宽度（或更多）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T13:15:42.173

id 说将图像设置为背景图像，然后给 ul 或 li 一个左边距。确保您已将填充和边距重置为 0，否则输出将区分跨浏览器

# windows - 避免关键部分的重新初始化

> ID：751361
> 
> 赞同：0
> 
> 时间：2009-04-15T11:51:31.987
> 
> 标签：windows, winapi, critical-section

我有一个创建全局临界区、初始化并使用它的 dll。

现在第三方应用程序多次使用/加载 dll，这会导致堆损坏。

appverifier[警告](http://technet.microsoft.com/en-us/library/bb457063.aspx)我

--> VERIFIER STOP 00000211：pid 0x1470：关键部分已经初始化。<--

使用全局标志来检查临界区对象是否已经初始化并没有帮助，有什么想法可以完成同样的事情吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T12:32:45.583

> 现在第三方应用程序不止一次使用/加载 dll

Windows 不会多次重新加载同一个 DLL。相同意味着*相同*的路径。如果第 3 方应用程序是从不同位置加载的，那就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T12:36:28.320

可能对使用“setAtom”和“getAtom”API 有帮助吗？我知道他们有点“老派”，但你永远不会知道。

# geometry - 仅在放大很多时，如何使用 UMN-Mapserver 显示几何图形的边框？

> ID：751362
> 
> 赞同：0
> 
> 时间：2009-04-15T11:51:54.903
> 
> 标签：geometry, border, zooming, mapserver, umn

我有一个 UMN 的地图文件，它显示了一层矢量，每个几何图形都有不同的颜色，具体取决于它们的属性。这很好用。我还想在每个几何图形周围添加边框。这没问题，但是在显示完整区域的视图上，边界在图像中占主导地位，因为每个几何图形只有几个像素。所以我只想在指定的缩放级别显示边框。我可以根据缩放禁用或启用整个图层，但我不知道如何仅针对边框实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T21:16:07.470

您至少可以通过两种方式做到这一点。
首先，您可以定义两个图层，一个有边框，一个没有边框。然后您可以使用 MINSCALEDENOM 和 MAXSCALEDENOM 根据缩放级别显示第一个或第二个。

或者，您可以定义一个带有彩色几何图形的图层，没有边框，以在所有缩放级别显示。然后您应该定义一个仅包含边框的图层，显示在第一个图层的顶部，但仅以指定的缩放级别显示（再次使用 MINSCALE 和 MAXSCALE）。该图层使用与常规图层相同的数据，但必须为 POLYGON 类型但不带 COLOR 关键字（仅应指定 OUTLINECOLOR）。这样，只会显示多边形的边框，如果将其显示在另一个之上，则可以创建边框效果。

有关关键字的详细说明，[http://www.mapserver.org/mapfile/layer.html](http://www.mapserver.org/mapfile/layer.html)

# apache - 从 Tomcat 切换到 Glassfish

> ID：751363
> 
> 赞同：4
> 
> 时间：2009-04-15T11:52:25.807
> 
> 标签：apache, tomcat, glassfish

为了响应[页面传递不正确的错误](https://stackoverflow.com/questions/246540/apache-tomcat-error-wrong-pages-being-delivered)，我们正在考虑从 Apache + Tomcat 切换到 Glassfish。这不是受到功能的启发，而是受到无法消失的故障的挫败感。

问题是：

*   我们应该使用 Glassfish 与 Apache 合作，还是完全取代 Apache？Apache 和 Tomcat 之间的接口显然以某种方式与我们看到的错误有关，我们最不需要做的就是再次出现同样的问题。另一方面，我们需要 PHP，Apache 已经准备好处理它。

*   我们应该使用 Glassfish 2 还是 3？第 3 版似乎是一个完全重写的版本，这里和其他地方的评论表明很多人都坚持使用第 2 版。

*   Apache 和 Glassfish 在同一台服务器上的合作情况如何？例如，Apache 可以简单`ProxyPass`地将对选定域的所有请求都发送到 Glassfish（与目前正在执行的对 Tomcat 的更具体的代理相反）。

*   有没有更简单的方法？我不想白白做所有这些工作。

*   这个问题是否属于 serverfault.com？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-16T09:43:32.503

在我正在处理的项目中，我们已经从 Tomcat 更改为 Glassfish，因为需要一个带有 JMS 的应用服务器。

> 我们应该使用 Glassfish 与 Apache 合作，还是完全取代 Apache？

严格来说，前面不需要 Apache。Glassfish 有一些配置选项来创建虚拟域，就像您从 Apache 获得的一样。更多信息[在这里](http://docs.sun.com/app/docs/doc/820-4335/ablsw?a=view)。我想这取决于您的需求。Glassfish 确实`mod_jk`在 Glassfish 前面支持 Apache 中的模块。我们使用`mod_jk`.

> 我们应该使用 Glassfish 2 还是 3？版本 3 似乎是一个完整的重写

根据[路线图](http://wiki.glassfish.java.net/Wiki.jsp?page=GlassFishV3Schedule)，Glassfish 3 直到 2009 年 9 月下旬才会发布，即便如此，在 3.1 出来之前它也不支持高可用性集群等功能。[这里](http://blogs.oracle.com/theaquarium/entry/update_on_glassfish_v3_plans)有一些信息。所以就我个人而言，我会等待 3.1，但这只是我 :-)

> Apache 和 Glassfish 在同一台服务器上的合作情况如何？

在同一台服务器上使用 Glassfish 和 Apache 没有问题

> 有没有更简单的方法？我不想白白做所有这些工作。

是的。使用 Glassfish 自己的 http 和虚拟主机配置，但同样取决于您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-23T22:21:40.980

在其 Web 配置文件版本中获取 Glassfish v3。这是一个更轻量级的解决方案，同时保留了所需的所有功能，并且具有比 Tomcat 更好的管理控制台。GF v3 还支持热重新部署，保留现有的 Web 会话。它工作得很好。我们还在 glassfish 前面使用带有 apache 的 mod_jk，因为我们为不同的项目运行多个域，监听不同的端口，但需要通过端口 80 提供所有内容。如果您只需要一个域，则可以使用 Glassfish v3 来提供所有内容将 http-listener 配置为使用端口 80。这是通过管理控制台直观地完成的。祝你好运。

# php - 多维 PHP 数组或对 mysql DB 的多个查询

> ID：751365
> 
> 赞同：1
> 
> 时间：2009-04-15T11:53:24.807
> 
> 标签：php, mysql, multidimensional-array

我正在使用[PHPExcel](http://www.codeplex.com/PHPExcel)库，它似乎做得很好，但在我的方法中，它似乎并没有那么快。

我需要生成一个带有分配表、数据、公式和样式（粗体、颜色、边框）的 excel 文件，这需要我分配计算资源和时间。
我认为我的方法不太好。当即将使用 PHP 代码和来自 mysql 数据库的数据生成这种文件（excel）时，必须是正确的顺序。

1) 生成所有没有格式/样式、没有公式、添加数据和公式和样式
的工作表 2) 生成带有数据的工作表、添加公式、添加样式
3)....

最好将数据库中的所有需要​​数据放在一个多维数组中，而不是每次我希望写入新工作表时都查询数据库？

我正在使用双核处理器机器和 4GB 或 RAM，如果 Apache 没有崩溃，我需要大约 1 分钟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-16T06:56:03.637

我建议分析您的 PHP 代码以找出花费最多时间的地方。您可以在我的博客上找到[有关使用 XDebug 分析 PHP conde 的分步教程。](http://hype-free.blogspot.com/2008/06/profiling-php-with-xdebug.html)然后尝试优化最耗时/最频繁调用的部分。您可以做的最好的优化之一是尽可能用内置函数替换 PHP 方法，因为它们的速度要快几个数量级。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T23:56:06.833

1.  让 mysql 进行计算：我曾经优化过一份报告，其中原始开发人员使用循环来计算总和而不是 sql sum 函数，它写得太糟糕了，超过了 php 的时间限制
2.  确保你的计算 SQL 已经足够优化
3.  计算然后生成内容

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-27T00:14:52.950

执行更多、更简单的查询比执行更少、更复杂的查询要快。但是您需要对它们进行基准测试，因为这在很大程度上取决于您查询的数据。

也就是说，您可能会在 PHP 中遇到内存问题。我建议的是看看你是否可以重新安排数据处理算法。我要做的是一次只获取一个大型数据集，但已经由 MySQL 按照您需要处理它的顺序进行排序。然后，您可以使用无缓冲查询。

无缓冲的查询意味着客户端库在将其交给您的代码之前不会存储整个结果集。这意味着它可能比库通常处理的要大，但要使其正常工作，您的处理循环必须在每个周期从 API 获取一行 - 即这意味着每次都`while()`调用一个循环。`mysql_fetch_assoc()`

处理已经按您需要的顺序的结果集的另一个优点是，您可以要求比您需要的更多的东西，并在您进行时将其过滤掉。这在要求更多时有效，因为它*较少*被数据库过滤。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T21:57:43.543

数据库查询，即使是返回 30,000 行的查询，通常只需要几分之一秒。使用这样的 proc 和 RAM，它可能会在 IO 处变慢。我敢打赌，大部分时间都花在了编写文件上。

话虽如此，我建议将所有数据放在前面。至少那时，你是从记忆中阅读的。我不确定 MySQL 是否使用指向当前行的指针将所有内容加载到内存中，或者它是否只加载当前行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T00:03:08.123

只需一分钟的处理时间，您的数据集听起来就不足以需要对结果集进行分区。

因此，假设，将其全部加载到内存中就可以了。

但是，mysql 无论如何都会缓存查询，因此连续的重复查询也不应该是一个大问题。

听起来确实像 IO 写入磁盘上的文件是你的慢点。我不太了解 xls 文件的样式和格式如何工作，但我很确定您可以通过减少格式或组织它来减少很多无意义的写入，这样您就不会进行任何内联格式，即使这样可能的。

我建议的最好的事情是优化您的查询。这通常是我遇到此类问题的第一个优化位置。如果您可以编辑您的帖子并包含我可以查看的 sql。（随意剪断敏感信息）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-24T11:01:33.577

MySQL 将能够对数据执行任何计算/转换，而不是您的 PHP 层，因此我将编写一个查询来完成所有工作以获取一个电子表格的数据。

比对每个电子表格执行一次。

# silverlight - Silverlight 2 中大量数据的列表框性能问题

> ID：751367
> 
> 赞同：2
> 
> 时间：2009-04-15T11:53:43.667
> 
> 标签：silverlight, silverlight-2.0

我正在使用 Silverlight 2，当我使用 Listbox 控件时，我遇到了性能问题。我正在绑定大约 500 条记录的对象列表，数据绑定需要 3-4 秒。

但我对 DataGrid 没有这个问题。

有没有人有改善 Listbox 中性能问题的答案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T14:14:52.233

这背后的原因是 DataGrid 支持 UI 虚拟化，而 ListBox 不支持。这意味着 DataGrid 仅为可见项创建可视元素，而 ListBox 为其所有项创建可视元素。每当您必须从可能非常大的项目列表中进行选择时，请使用 DataGrid 而不是 ListBox。您可以设置 DataGrid 的样式并使用 TemplateColumn 使其看起来像一个 ListBox。

迈克尔

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T11:59:03.560

在不了解有关您的应用程序的其他上下文的情况下，可能会发生一些事情。首先想到的是你有一个非常“沉重”的视觉树。ListBox 中的每个项目都将创建一些可视对象图。您拥有的越多，渲染所需的时间就越长。

当这些项目在屏幕上不可见时，Silverlight 仍在进行渲染它们的工作。基本上这意味着 Layout() 和 Measure() 传递正在对所有数据绑定的 ListBox 项执行，即使它们不可见。

诀窍是使用虚拟化来强制 Silverlight 不对当时在控件可见区域内不可见的控件执行布局/测量传递。

这是一篇博客文章，描述了如何使用 StackPanel 执行此操作。将其抽象为 ListBox 或更好的方法并不需要太多，您可以简单地将 ListBox 的控件容器设置为虚拟化堆栈面板，然后您就完成了:)

[http://blogs.msdn.com/uberdemo/archive/2009/02/18/a-virtualizedstackpanel-control-in-silverlight-2-0.aspx](http://blogs.msdn.com/uberdemo/archive/2009/02/18/a-virtualizedstackpanel-control-in-silverlight-2-0.aspx)

# filter - 您可以在 log4net 中的 Logger 级别进行过滤吗

> ID：751368
> 
> 赞同：4
> 
> 时间：2009-04-15T11:53:49.187
> 
> 标签：filter, log4net, logging

我想过滤掉包含指定字符串的消息。我使用过`log4net.Filter.StringMatchFilter`，但这仅适用于附加程序。

我想已经在 Logger 级别过滤该消息。这些方面的东西：

```
<logger name="MyLogger.WebServices">
    <level value="Debug" />
    <filter type="log4net.Filter.StringMatchFilter">
        <stringToMatch value="do not log me" />
        <acceptOnMatch value="false" />
    </filter>
    <appender-ref ref="file" />
    <appender-ref ref="debug" />
</logger> 
```

这种方式真的可以吗？或者是否有不同的方法来处理这种情况。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-16T10:13:15.623

过滤器仅用于附加程序。如果您需要过滤掉多个 appender 的事件，您可以使用 forwardingappender 进行预过滤。这样您就不必在多个附加程序上复制和粘贴相同的过滤器。

您的示例如下所示：

```
<appender name="screeningAppender" type="log4net.Appenders.ForwardingAppender">
    <filter type="log4net.Filter.StringMatchFilter">
            <stringToMatch value="do not log me" />
            <acceptOnMatch value="false" />
    </filter>

    <appender-ref ref="file" />
    <appender-ref ref="debug" />
</appender>

<logger name="MyLogger.WebServices">
    <level value="Debug" />
    <appender-ref ref="screeningAppender" />
</logger> 
```

# c# - 使用扩展方法的字符串和日期时间实用函数库的建议

> ID：751370
> 
> 赞同：4
> 
> 时间：2009-04-15T11:54:04.820
> 
> 标签：c#, c#-3.0, extension-methods

我正在为 C# 中的 String 和 DateTime 实用程序函数编写扩展方法库。您能否通过建议您可能希望参与其中的 String 和 DateTime 有用的实用函数来帮助我？有了您的建议，我可以使它更具凝聚力和集体性。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T12:07:14.880

```
public static bool IsNullOrEmpty(this string value){
    return string.IsNullOrEmpty(value);
}
public static string Reverse(this string value) {
    if (!string.IsNullOrEmpty(value)) {
        char[] chars = value.ToCharArray();
        Array.Reverse(chars);
        value = new string(chars);
    }
    return value;
}
public static string ToTitleCase(this string value) {
    return CultureInfo.CurrentCulture.TextInfo.ToTitleCase(value);
}
public static string ToTitleCaseInvariant(this string value) {
    return CultureInfo.InvariantCulture.TextInfo.ToTitleCase(value);
} 
```

微不足道，但稍微好一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T12:57:19.800

那些不专门*扩展*字符串或日期时间，而是*定位*或返回字符串或日期时间的方法呢？然后你也可以构建一些`int`和`TimeSpan`方法，这样你就可以编写流畅的接口，例如：

```
 DateTime yesterday =  1.Days().Ago(); 
```

.

```
public static TimeSpan Days(this int value)
{
    return new TimeSpan(value, 0, 0, 0);
}

public static TimeSpan Hours(this int value)
{
    return new TimeSpan(value, 0, 0);
}

public static TimeSpan Minutes(this int value)
{
    return new TimeSpan(0, value, 0);
}

//... 
```

.

```
public static DateTime Ago(this TimeSpan value)
{
    return DateTime.Now.Add(value.Negate());
}

public static DateTime FromNow(this TimeSpan value)
{
   return DateTime.Now.Add(value);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T12:01:59.277

**字符串扩展**

1.  `MakeTitle`-- 从 TitleCase 字符串中创建一个标题，.ie，将 "FooBar" 转换为 "Foo Bar"。我发现这对于打印枚举非常有用： `fooEnum.ToString("g").MakeTitle()`
2.  `Collapse`-- 修剪两端的空格并将所有内部空格折叠成一个空格。
3.  `IsNothing`-- 与 IsNullOrEmpty 类似，但首先修剪空格，这有助于您不想只是空格的 TextBox 输入，但如果没有输入则设置为 null。

**日期时间扩展**

1.  `EndOfDay`-- 将时间设置为给定日期的晚上 11:59:59
2.  `StartOfDay`-- 将时间设置为给定日期的凌晨 12:00:00

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T12:56:52.220

**字符串扩展**

```
static string ToCamelCase(this string s) {...}  // Converts a string into Camel Notation, useful for code generation
static string ToPascalCase(this string s) {...} // Converts a string into Pascal Notation
static int [Soundex][1](this string s) {...}      // Gets the soundex of a string 
```

**日期时间扩展**

```
static bool IsWithinRange(this DateTime d, DateTime start, DateTime end) {...}
static string [ToRelativeTime][2](this DateTime d) {...} 
```

# html - 如何为“utf-8”编码设置 vim 7 的 html 整洁选项？

> ID：751373
> 
> 赞同：3
> 
> 时间：2009-04-15T11:55:05.660
> 
> 标签：html, vim, htmltidy

我需要使用通常的方式在 vim 中运行 tidy：

`:compile tidy`

`:make`

但是，如果我在一个 utf-8 文件上，我会得到错误，如果我在 vim 之外运行 tidy，我看不到，即，

`tidy -e -q -utf8 <filename>`

我得到了我所期待的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T14:13:29.647

My Vim script skills do not go far enough to have a general solution ready, but what you can do when editing a utf-8 file:

```
:compiler tidy
:setlocal makeprg=<TAB> [and edit the tidy command line to include -utf8]
:make 
```

Explanation:

":compile tidy" just executes the compiler plugin file for tidy and does setlocal to set makeprg to tidy call with some options (-q -e --gnu-emacs yes). Apparently for utf-8 files tidy needs the additional option -utf8, so you have to set this manually. Afterwards you call :make as normal.

If you are *only* editing utf8 files, you can of course edit the tidy compiler plugin file directly and hard code the -utf8 option to tidy there. Use the following to edit the plugin file

```
:e $VIMRUNTIME/compiler/tidy.vim 
```

# java - Java 调用拦截日志

> ID：751377
> 
> 赞同：0
> 
> 时间：2009-04-15T11:56:33.503
> 
> 标签：java, trace

我想要一个程序来记录我对类文件夹（如 com.mycompany.mylibrary）的每次调用并输出一个有效的 java 程序，就像[http://linux.die.net/man/1/ltrace](http://linux.die.net/man/1/ltrace)在 Linux 中所做的那样。

你们知道任何像我正在寻找的呼叫拦截器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T12:01:10.543

我猜你想使用一些面向方面的机制，比如[AspectJ](http://www.eclipse.org/aspectj/)。尽管我对“输出有效的 Java 程序”的意思感到困惑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T05:50:12.507

我发现： [http](http://www.jroller.com/carlossg/entry/tracing_an_application_using_aspectj) : //www.jroller.com/carlossg/entry/tracing_an_application_using_aspectj 但我将不得不重新编译我需要跟踪的 jar，因为 AspectJ 切入点是在编译时注入的。因此，我仍在寻找一种不需要任何重新编译的解决方案，就像 ltrace 适用于 C 一样。

# php - 从 HTML 表单中发布任意数量的记录

> ID：751381
> 
> 赞同：3
> 
> 时间：2009-04-15T11:57:03.533
> 
> 标签：php, mysql, html, post

我正在制作一个网页，其中有一个产品列表，以及每个产品旁边的一个字段，客户可以在其中输入他们想要订购的数量。产品列表是从数据库生成的，因此产品的数量是未知的。有没有办法发布订购的每种产品的数量以及每种产品的 ID（来自数据库）？

谢谢

本

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T12:00:45.147

您可以使用数组表示法创建表单字段，例如：

```
<input type="text" name="quantity[productid]"> 
```

因此，您可以像这样在表单中动态生成一些字段：

```
<input type="text" name="quantity[3]">
<input type="text" name="quantity[4]">
<input type="text" name="quantity[2]"> 
```

然后在 PHP 中它会变成一个数组，你可以很容易地循环：

```
foreach ($_POST['quantity'] as $productId => $quantity) {
    echo (int) $productId . ':' . (int) $quantity;
    //etc.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T12:00:00.920

正确的方法是让数据库跟踪它发出的元素数量并存储隐藏字段。

如果你不能这样做，你可以自己在页面中构建一些javascript，在提交时，它将计算页面中元素的数量并设置表单中隐藏字段的值来保存这个值。

# d - 有没有办法确保成员函数在 D 中是虚拟的？

> ID：751382
> 
> 赞同：6
> 
> 时间：2009-04-15T11:57:50.053
> 
> 标签：d

据我了解，所有成员函数在 D 中都是虚拟的，但是如果编译器看到它们从未被覆盖，则可以自由地将函数设为非虚拟。

我不清楚的是，当您编译一个未覆盖成员函数的模块然后将该模块导入您覆盖成员函数的其他地方时会发生什么。我认为它不会重新编译原始模块。它是否只是假设任何具有外部链接的成员函数都是虚拟的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T12:08:35.003

默认情况下，所有 D 成员函数都是虚函数。我不认为那里有任何编译器实际上使函数非虚拟作为优化。不过，您可以通过将类或函数标记为“final”来手动完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T01:11:54.370

除了不能虚拟化的模板化函数之外，FepingCreature 大部分是正确的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T15:55:51.403

这是如何实现的是编译器和链接器特定的。但是可以优化虚函数调用的一种常见情况是当您在本地实例化一个类时。然后函数调用可以直接在这个范围内执行，因为类的类型在编译时是完全已知的。这可以在编译器级别完成。

除此之外，如果链接器意识到函数实现永远不会被覆盖，那么链接器可能会进行优化并将虚函数调用替换为对该类的直接函数调用。特别是，如果一个类从不派生，那么所有对成员函数的调用都可以直接执行。就好像链接器会尽可能插入“final”关键字。（链接器可能不会将此优化应用于导出的类和函数，因为链接器不知道函数是否在其他库或可执行文件中被覆盖。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T14:56:44.553

我相信 FeepingCreature 是正确的，但除此之外，我认为您可以假设只有编译器直接从源代码创建可执行文件时才会考虑此类优化。

# php - php和邮件交互

> ID：751386
> 
> 赞同：2
> 
> 时间：2009-04-15T11:59:12.670
> 
> 标签：php, email

我正在从事一个未来项目，该项目将不是从界面而是从电子邮件获取信息到私人网站。经过一些研究，[posterous.com](http://posterous.com/)正在做一些有趣的事情，通过电子邮件在个人博客上发布。[flickr](http://www.flickr.com/)正在使用电子邮件中附加的照片做同样的事情并将其发布到服务器上以炫耀

我的问题。在网上哪里可以找到概念证明或已经制作的脚本

1.  以特定间隔（每 5 分钟）读取弹出电子邮件帐户
2.  提取邮件的主题和内容
3.  获取附件照片
4.  将该特定信息保存到服务器上的文件

所有这些都可以用 php 完成，但我的资格不足以自己做到这一点，但我可以肯定地调整一些脚本！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T12:26:08.657

如果您查看 Zend Framework 的 Zend_Mail 库之类的东西 - [http://framework.zend.com/manual/en/zend.mail.read.html](http://framework.zend.com/manual/en/zend.mail.read.html) - 您的状态会很好。我一直在使用它来检索电子邮件以用于其他目的，它为您提供了一个不错的小对象，其中包含数组中的所有标题。使用您需要的数据，然后转储其余数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T12:24:13.263

我不了解现有的软件，但如果您想编写自己的脚本，[Zend Framework 的 Mail 组件](http://framework.zend.com/manual/en/zend.mail.read.html)肯定会让事情变得更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T12:27:48.607

快速环顾四周，我发现了两个有希望的脚本：

[http://www.weberdev.com/get_example-4015.html](http://www.weberdev.com/get_example-4015.html)

和

[http://www.nerdydork.com/download-pop3imap-email-attachments-with-php.html](http://www.nerdydork.com/download-pop3imap-email-attachments-with-php.html)

看起来两者都可以修改以满足您的需求。

# java - 如何安装第二个 JVM？

> ID：751392
> 
> 赞同：1
> 
> 时间：2009-04-15T12:00:22.043
> 
> 标签：java, jvm, ubuntu-8.10

我正在使用 Linux Ubuntu 8.10，我想安装第二个 JVM。我目前正在使用 Java 1.6，但我想安装 Java 1.4，然后将 1.4 JVM 设置为我的默认 JVM，以便使用。我怎么能那样做？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T12:04:28.303

只需安装您想要的软件包。之后，您可以使用 update-java-alternatives 切换 java 实现

有关更多信息，请参阅[帮助页面](https://help.ubuntu.com/community/Java)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T12:05:33.387

使用 Linux，您可以安装多个 JVM 而不会发生冲突（与更新注册表的 Windows 不同）。

您的“默认”JVM 以两种方式控制：如果您从命令行执行 java，则它是 PATH 环境变量。这在任何 Unix 参考资料中都有描述。

另一种方法是 ${HOME}/.java/deployment/deployment.properties 文件，Java Webstart 和 Java 浏览器插件使用该文件。您会在此文件中找到几个引用版本的配置变量。最安全的方法是在安装早期版本之前重命名 .java 目录。

# flex3 - Flex AMFPHP vs WebORB vs XMl

> ID：751398
> 
> 赞同：1
> 
> 时间：2009-04-15T12:01:11.260
> 
> 标签：flex3, amfphp, weborb

我是 Flex 3 和 Flash 远程处理的新手，我无法决定使用哪种技术进行前端/后端通信。

我从 XML 开始，但在 PHP 中构造所有 XML、在 Flex 中解析它们以及在 Flex 中再次构造 XML 然后在 PHP 中解析它们发送回数据似乎开销很大。

这就是我找到 AMFPHP 的原因，它看起来很棒，我可以直接访问 PHP 中的类/对象并修改它们。看起来干净多了。例如对数据库中的数据进行更新，我只需调用一个带有定义属性的 set 方法。

然后我也找到了WebORP。

AMFPHP 最大的缺点是什么？有什么建议吗？

非常感谢，马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T12:07:03.570

我对 WebORP 一无所知，但 AMFPHP 肯定比 xml 更适合您。AMF 是一种二进制传输，比传输所有 ascii 文本并全部解析要快得多。此外，它还允许您直接使用 PHP 类文件。

我真的想不出任何缺点；）

xml 唯一更有意义的情况是，如果您正在编写一个将被多种不同语言使用（消费）的服务，并且您需要最小公分母。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:12:53.747

WebORB 也是一个很好的选择，但它们主要专注于 .NET（这就是我使用它的目的），因此您必须比较 AMFPHP、ZendAMF 和 WebORB。WebORB 有很多其他功能，例如消息传递、pdf 支持、msmq 支持……但我不知道 PHP 支持哪些功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-05T12:12:11.310

我将 AMFPHP 用于一个几乎有设计师和我自己的小项目，这很好，它真的又快又容易。我在一个涉及约 4 名 Flex 开发人员的中型项目中使用了 WebORB；它工作得很好，我觉得这种方法可以处理一个相当大的群体（顺便说一句，我们在 Flex 方面使用了 Cairngorm）。

我觉得 WebORB 更完整，尽管 PHP 端的类编组有点难以调试。（即，如果您在 Flex 中准备了一个对象，并且 AS3 类定义与 PHP 类定义略有不同，这很难从错误中解释。同步这些应该是自动化的，不知道这是否可能。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T15:48:28.553

一起阅读这些内容。

[http://blogs.adobe.com/mikepotter/2006/07/php_and_flex_js.html](http://blogs.adobe.com/mikepotter/2006/07/php_and_flex_js.html) [http://www.5etdemi.com/blog/archives/2006/12/clearing-the-fud-on-amfphps-speed-versus -json 和 xml](http://www.5etdemi.com/blog/archives/2006/12/clearing-the-fud-on-amfphps-speed-versus-json-and-xml)

# sqlite - sql查询 - 如何在组内应用限制

> ID：751399
> 
> 赞同：17
> 
> 时间：2009-04-15T12:01:50.777
> 
> 标签：sqlite, group-by

我有一个名为 t1 的表，其中包含以下字段：ROWID、CID、PID、Score、SortKey

它有以下数据：

```
1, C1, P1, 10, 1
2, C1, P2, 20, 2
3, C1, P3, 30, 3

4, C2, P4, 20, 3
5, C2, P5, 30, 2

6, C3, P6, 10, 1
7, C3, P7, 20, 2 
```

我要写什么查询，以便它在 CID 上应用 group by，但不是每组返回 1 个结果，而是每组最多返回 2 个结果。还有条件是分数> = 20，我想要按CID和SortKey排序的结果。

如果我必须对上述数据运行查询，我希望得到以下结果：

**C1 的结果 - 注意：ROWID 1 不被视为其分数 < 20**

```
C1, P2, 20, 2
C1, P3, 30, 3 
```

**C2 的结果 - 注意：ROWID 5 出现在 ROWID 4 之前，因为 ROWID 5 具有较小的值 SortKey**

```
C2, P5, 30, 2
C2, P4, 20, 3 
```

**C3 的结果 - 注意：ROWID 6 没有出现，因为它的分数小于 20，所以这里只返回 1 条记录**

```
C3, P7, 20, 2 
```

简而言之，我想要一个 GROUP BY 中的限制。我想要最简单的解决方案，并希望避免使用临时表。子查询很好。另请注意，我为此使用 SQLite。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-16T06:00:30.743

这是一个相当便携的查询来做你想做的事：

```
SELECT *
FROM table1 a 
WHERE a."ROWID" IN (
    SELECT b."ROWID" 
    FROM table1 b 
    WHERE b."Score" >= 20 
      AND b."ROWID" IS NOT NULL 
      AND a."CID" = b."CID" 
    ORDER BY b."CID", b."SortKey" 
    LIMIT 2
)
ORDER BY a."CID", a."SortKey"; 
```

该查询使用具有排序和限制的相关子查询来生成`ROWID`应出现在最终结果中的 s 列表。因为相关子查询是针对每一行执行的，无论它是否包含在结果中，它可能不如下面给出的窗口函数版本高效 - 但与该版本不同的是，它可以在不支持窗口的 SQLite3 上工作功能。

此查询要求`ROWID`是唯一的（可以用作主键）。

我在 PostgreSQL 9.2 和 SQLite3 3.7.11 中测试了上述内容；它在两者中都可以正常工作。它不适用于 MySQL 5.5 或最新的 5.6 里程碑，因为 MySQL 不支持`LIMIT`与`IN`.

SQLFiddle 演示：

*   PostgreSQL（工作正常）：[http ://sqlfiddle.com/#!12/22829/3](http://sqlfiddle.com/#!12/22829/3)

*   SQLite3（工作正常，查询文本相同，但由于明显的 JDBC 驱动程序限制需要单值插入）：[http ://sqlfiddle.com/#!7/9ecd8/1](http://sqlfiddle.com/#!7/9ecd8/1)

*   MySQL 5.5（失败两种方式；MySQL 不喜欢`a."ROWID"`在`ANSI`模式下引用，所以我不得不取消引用；然后它失败了`This version of MySQL doesn't yet support 'LIMIT & IN/ALL/ANY/SOME subquery`）：[http ://sqlfiddle.com/#!2/e1f31/2](http://sqlfiddle.com/#!2/e1f31/2)

SQLite 演示显示它在 SQLite3 命令行上运行良好：http: [//pastebin.com/26n4NiUC](http://pastebin.com/26n4NiUC)

输出（PostgreSQL）：

```
 ROWID | CID | PID | Score | SortKey 
-------+-----+-----+-------+---------
     2 | C1  | P2  |    20 |       2
     3 | C1  | P3  |    30 |       3
     5 | C2  | P5  |    30 |       2
     4 | C2  | P4  |    20 |       3
     7 | C3  | P7  |    20 |       2
(5 rows) 
```

如果要过滤特定的，只需在*外部*子句中`CID`添加`AND "CID" = 'C1'`或其他内容。 *`WHERE`*

 *这是一个密切相关的答案，其中包含更详细的示例：[https ://stackoverflow.com/a/13411138/398670](https://stackoverflow.com/a/13411138/398670)

* * *

由于这最初被标记为`SQL`（无 SQLite）......只是为了完整性，在 PostgreSQL 或其他支持 SQL 标准窗口函数的数据库中，我可能会这样做：

```
SELECT "ROWID", "CID", "PID", "Score", "SortKey"
FROM (
  SELECT *, row_number() OVER (PARTITION BY "CID" ORDER BY "SortKey") AS n
  FROM table1
  WHERE "Score" >= 20
) x
WHERE n < 3
ORDER BY "CID", "SortKey"; 
```

产生相同的结果。SQLFiddle，包括额外的`C1`行来证明限制过滤器确实有效：[http ://sqlfiddle.com/#!12/22829/1](http://sqlfiddle.com/#!12/22829/1)

如果要过滤特定的，只需在*内部*子句中`CID`添加`AND "CID" = 'C1'`或其他内容。 *`WHERE`*

 ** * *

顺便说一句，您的测试数据不足，因为对于任何得分 > 20 的 CID，它的行数永远不会超过两行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-10-22T03:17:51.780

这实际上不是`GROUP BY`问题（您不是在汇总值）。这是每组最大 n 的问题（我认为`greatest-n-per-group`Stackoverflow 上实际上有一个标签）。

解决方案的确切细节将取决于问题，例如每个组是否有两次相同的排序键。你可以从这样的事情开始：

```
SELECT * FROM table T1 WHERE Score > 20 AND
  (SELECT COUNT(*) FROM table T2 
      WHERE T2.CID = T1.CID AND T2.SortKey <= T1.SortKey AND T2.RowID <> T1.RowID
        AND T1.Score > 20) < 2;
  ORDER BY CID, SortKey; 
```

这样做是只考虑分数高于 20 的那些行。然后，对于每个候选行，它计算同一个表中分数 > 20 但排序键小于或等于该行的排序键的*其他行的数量。*如果该数字是 0 或 1 行，则该行有资格包含在结果中。

最后 ORDER by 执行您的排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T12:07:51.433

在`MySQL`：

```
SELECT  l.*
FROM    (
        SELECT  cid,
                COALESCE(
                (
                SELECT  id
                FROM    mytable li
                WHERE   li.cid = dlo.cid
                        AND li.score >= 20
                ORDER BY
                        li.cid, li.id
                LIMIT 1, 1
                ), CAST(0xFFFFFFFF AS DECIMAL)) AS mid
        FROM    (
                SELECT  DISTINCT cid
                FROM    mytable dl
                ) dlo
        ) lo, mytable l
WHERE   l.cid >= lo.cid
        AND l.cid <= lo.cid
        AND l.id <= lo.mid
        AND l.score >= 20 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-15T12:19:14.213

不应该是像**这样简单的事情吗？

```
SELECT CID, PID, Score, SortKey
FROM T1
WHERE score >= 20
ORDER BY CID, Sortkey 
```

**

还是我错过了什么？

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2011-06-02T14:14:15.237

我们可以在 SQLite 中使用 LIMIT 子句。例如 ：

```
select * from tableName where field1='something' limit 10; 
```

这给出了前 10 行。

# java - 当bean具有可变参数构造函数时，如何XML配置Spring bean以进行构造函数注入

> ID：751400
> 
> 赞同：46
> 
> 时间：2009-04-15T12:01:58.980
> 
> 标签：java, spring

有没有办法在 XML 中编写 Spring bean，以便在构造函数具有可变参数类型时使用构造函数注入？IE，有没有办法以指定列表的方式指定数组？

例如：

```
class MyClass {
    MyClass(String... args) {
        // rest omitted
    }
} 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-15T12:29:05.280

因为`args`是`String`您可以使用的数组`<list>`：

```
 <bean name="myBean" class="MyClass">
    <constructor-arg>
        <list>
            <value>111</value>
            <value>222</value>
            <value>333</value>
            <value>444</value>
        </list>
    </constructor-arg>
</bean> 
```

# java - flex ant 任务中的 flex 编译器错误（警告）消息

> ID：751402
> 
> 赞同：1
> 
> 时间：2009-04-15T12:02:09.450
> 
> 标签：java, linux, apache-flex, ant

如果我使用 flex sdk 中的 ant 任务编译我们的 flex 项目，我会收到以下警告。有谁知道这是从哪里来的以及为什么会发生这种情况以及我是否可以安全地忽略它？（swf 文件本身似乎是在没有实际错误的情况下创建的）

```
[mxmlc] The args attribute is deprecated. Please use nested arg elements.
[mxmlc] Loading configuration file /home/jrose/SDKs/flex_sdk_3-1/frameworks/flex-config.xml
[mxmlc] Locking assertion failure.  Backtrace:
[mxmlc] #0 /usr/lib/libxcb-xlib.so.0 [0x786057c7]
[mxmlc] #1 /usr/lib/libxcb-xlib.so.0(xcb_xlib_unlock+0x31) [0x78605891]
[mxmlc] #2 /usr/lib/libX11.so.6(_XReply+0x254) [0x77053494]
[mxmlc] #3 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so [0x77e6ddce]
[mxmlc] #4 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so [0x77e57d77]
[mxmlc] #5 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so [0x77e57ef3]
[mxmlc] #6 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so(Java_sun_awt_X11GraphicsEnvironment_initDisplay+0x26) [0x77e58136]
[mxmlc] #7 [0xb1411008]
[mxmlc] #8 [0xb140ab6b]
[mxmlc] #9 [0xb140ab6b]
[mxmlc] #10 [0xb1408236]
[mxmlc] #11 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so [0xb76a3eec]
[mxmlc] #12 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so [0xb7873ae8]
[mxmlc] #13 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so [0xb76a3d1f]
[mxmlc] #14 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so(JVM_DoPrivileged+0x32d) [0xb770182d]
[mxmlc] #15 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/libjava.so(Java_java_security_AccessController_doPrivileged__Ljava_security_PrivilegedAction_2+0x3d) [0xb73a730d]
[mxmlc] #16 [0xb1410898]
[mxmlc] #17 [0xb140aa94]
[mxmlc] #18 [0xb1408236]
[mxmlc] #19 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so [0xb76a3eec]
[mxmlc] Locking assertion failure.  Backtrace:
[mxmlc] #0 /usr/lib/libxcb-xlib.so.0 [0x786057c7]
[mxmlc] #1 /usr/lib/libxcb-xlib.so.0(xcb_xlib_lock+0x2e) [0x7860596e]
[mxmlc] #2 /usr/lib/libX11.so.6 [0x77052619]
[mxmlc] #3 /usr/lib/libX11.so.6(XGetVisualInfo+0x26) [0x77048666]
[mxmlc] #4 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so [0x77e570b9]
[mxmlc] #5 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so [0x77e57303]
[mxmlc] #6 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so [0x77e57fa1]
[mxmlc] #7 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/xawt/libmawt.so(Java_sun_awt_X11GraphicsEnvironment_initDisplay+0x26) [0x77e58136]
[mxmlc] #8 [0xb1411008]
[mxmlc] #9 [0xb140ab6b]
[mxmlc] #10 [0xb140ab6b]
[mxmlc] #11 [0xb1408236]
[mxmlc] #12 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so [0xb76a3eec]
[mxmlc] #13 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so [0xb7873ae8]
[mxmlc] #14 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so [0xb76a3d1f]
[mxmlc] #15 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/server/libjvm.so(JVM_DoPrivileged+0x32d) [0xb770182d]
[mxmlc] #16 /usr/lib/jvm/java-1.5.0-sun-1.5.0.16/jre/lib/i386/libjava.so(Java_java_security_AccessController_doPrivileged__Ljava_security_PrivilegedAction_2+0x3d) [0xb73a730d]
[mxmlc] #17 [0xb1410898]
[mxmlc] #18 [0xb140aa94]
[mxmlc] #19 [0xb1408236] 
```

**蚂蚁目标**

```
<target name="compile-flex-swf" description="creates swf file">
    <mxmlc file="${basedir}/flex_src/company_gui.mxml" 
        keep-generated-actionscript="false" 
        output="${basedir}/target/${ant.project.name}.swf" 
        fork="true" 
        debug="${flex.debug}" 
        services="${basedir}/WebContent/WEB-INF/flex/services-config.xml" 
        actionscript-file-encoding="UTF-8" 
        optimize="true">

        <load-config filename="${FLEX_HOME}/frameworks/flex-config.xml" />
        <context-root>company</context-root>
        <compiler.library-path dir="${LCDS_HOME}/resources/frameworks" append="true">
            <include name="libs/fds.swc" />
        </compiler.library-path>
        <compiler.library-path dir="../company_flex/target" append="true">
            <include name="*.swc" />
        </compiler.library-path>
    </mxmlc>
</target> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T21:17:58.440

这些回溯真的与 flex 或 ant 无关。它实际上只是 AWT 和 XCB 之间的交互。[您可以通过sun 错误 6532373](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6532373)或[Xlib 错误](https://bugs.freedesktop.org/show_bug.cgi?id=11390)11390找到更多信息。有一些解决方法，但我认为没有必要（除了删除那些讨厌的消息）。

# asp.net - 使用 jQuery 的 ASP.NET 回发？

> ID：751415
> 
> 赞同：16
> 
> 时间：2009-04-15T12:06:52.870
> 
> 标签：asp.net, jquery, user-interface, postback, modal-dialog

我有一个 ASP.NET 按钮，但最近，我用标准的 HTML 按钮替换了它……我需要做的是回发到 ASP.NET 页面并确保调用了一个方法。

上一个按钮是一个 ASP.NET 按钮，所以我有这个事件：

```
Protected Sub btnCancelar_Click(ByVal sender As Object, ByVal e As System.EventArgs) 
    UtilTMP.DisposeObjects()
    Server.Transfer("~\Forms\test.aspx", True)
End 
```

但是我使用的是带有 JavaScript ALERT 的按钮，我最近更改为 jQuery UI 模态对话框，但它没有等我回答问题..回发立即发生......所以我决定更改为标准 HTML按钮...但我需要回发到 ASP.NET 页面并调用类似的方法。

如果我只是回发它不会调用清理

```
Protected Sub Cleanup()
    UtilTMP.DisposeObjects()
    Server.Transfer("~\Forms\test.aspx", True)
End 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-15T13:31:41.667

看看这是否有帮助： http: [//www.codeproject.com/KB/aspnet/sample.aspx](http://www.codeproject.com/KB/aspnet/sample.aspx)。

基本上，您声明一个虚拟锚标记：

```
<a id="anchorId" runat="server" onclick="return true" onserverclick="foo"></a> 
```

在后面的代码中，您需要声明一个 foo 方法：

```
protected void foo(object sender, EventArgs e)
{
    // Do something here
} 
```

然后你可以用这个 javascript 调用这个锚的 onclick 函数：

```
document.getElementById('anchorId').click() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T18:16:14.137

虽然您可以使用 JQuery 进行回发，但调用 Web 方法（页面中的 Web 服务）可能会更好。调用也可能更快，因为您没有发布整个页面 ViewState。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T12:16:58.790

如果要在回发时触发事件处理程序，则需要将 __EVENTTARGET 隐藏字段设置为适当的值。但是，我会以不同的方式来做。将 ASP 按钮放在您的模式对话框中，并与它们关联的事件处理程序。让弹出对话框的点击处理程序返回 false （这样回发不会从该按钮点击发生）。这样，您的表单就会从 ASP 按钮回传，并且自动调用处理程序，包括客户端隐藏字段设置。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-21T02:01:58.840

看看这篇文章

[http://www.deviantpoint.com/post/2009/03/12/Using-jQuery-UI-Dialogs-for-confirmation-windows.aspx](http://www.deviantpoint.com/post/2009/03/12/Using-jQuery-UI-Dialogs-for-confirmation-windows.aspx)

基本思想是将回调函数放在隐藏字段中并在`$(this).dialog('close');`

我用它让它在 Gridview 中工作，所以如果你想知道如何做到这一点，请发表评论。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-20T04:45:24.503

我是通过谷歌看到这篇文章的，所以我怀疑其他人也会。我在这里尝试了对我不起作用的方法。我将解释我的解决方案，但首先概述我正在尝试做的事情。

我有一个使用 jQuery ajax 将数据发布到我的 web 服务的表单，这反过来又更新了我的数据库。我有一个图像上传表单，出于安全原因，您无法在 ajax 调用中使用完整的文件路径来传递给 web 服务......所以它必须通过常规的 asp.net 回发来完成。所以我的困境是如何做到这两点。我所做的是使用我的 ajax 函数来更新数据库，一旦我从 web 服务成功返回，我会告诉表单回发到代码隐藏中的某个方法，然后重定向到任何地方。 `$("#Button1").click(function () { javascript: __doPostBack('ctl00$ContentPlaceHolder1$atest', '') });`

这与将单击功能分配给 asp.net 控件基本上完全相同，只是我告诉 javascript 执行它而不是单击按钮。 `atest`将是我分配给 asp.net 控件的 ID。
注意：`<%=myclientid.ClientID %>`这里不起作用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T12:19:37.177

无论是 WebControl 还是标准 HTML 按钮，您都应该能够通过返回 false 来停止将任何 JS 附加到按钮 onclick 事件的回发。

例如`<input type="image" id="test" onclick="doWhatever();return false;" />`

# postgresql - PostgreSQL 连接

> ID：751420
> 
> 赞同：0
> 
> 时间：2009-04-15T12:08:13.023
> 
> 标签：postgresql, concatenation, plpgsql

我得到了这个函数来连接我的 pgSQL 服务器中的字段：

```
开始
    如果 acc 为 NULL 或 acc = '' THEN
      返回指令；
    别的
      返回ACC || ';' || 指示；
    万一;
  结尾;

```

它工作得很好，但现在我希望这个函数能够区分相等的条目。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T12:17:28.990

```
CREATE TYPE tp_concat AS (data TEXT[], delimiter TEXT);

CREATE OR REPLACE FUNCTION group_concat_iterate(_state tp_concat, _value TEXT, delimiter TEXT, is_distinct boolean)
  RETURNS tp_concat AS
$BODY$
  SELECT
    CASE
      WHEN $1 IS NULL THEN ARRAY[$2]
      WHEN $4 AND $1.data @> ARRAY[$2] THEN $1.data
      ELSE $1.data || $2
  END,
  $3
$BODY$
  LANGUAGE 'sql' VOLATILE;

CREATE OR REPLACE FUNCTION group_concat_finish(_state tp_concat)
  RETURNS text AS
$BODY$
    SELECT array_to_string($1.data, $1.delimiter)
$BODY$
  LANGUAGE 'sql' VOLATILE;

CREATE AGGREGATE group_concat(text, text, boolean) (SFUNC = group_concat_iterate, STYPE = tp_concat, FINALFUNC = group_concat_finish); 
```

像这样使用它：

```
SELECT  GROUP_CONCAT(textfield, ';', TRUE)
FROM    mytable 
```

如果您不想重复，并且

```
SELECT  GROUP_CONCAT(textfield, ';', FALSE)
FROM    mytable 
```

如果你这样做。

# .net - Column.DbType 影响运行时行为

> ID：751427
> 
> 赞同：2
> 
> 时间：2009-04-15T12:10:54.780
> 
> 标签：.net, linq-to-sql

根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.columnattribute.dbtype.aspx)，列类型/元素的 DbType 属性/属性仅用于创建数据库。

然而，今天，当尝试将数据提交到 SQLCE 数据库上的 IMAGE 列时（不确定是否仅在 CE 上），我遇到了“数据被截断为 8000 字节”的异常。这是因为 DbType 仍被定义为 SQLCE 不支持的 VARBINARY(MAX)。在 DbType 中将类型更改为 IMAGE 可以解决此问题。

那么 Linq2SQL 属性还有哪些其他惊喜呢？这是一个错误还是有意的？我应该向 MS 报告吗？

**更新**

从 Guffa 得到答案后，我对其进行了测试，但似乎对于 NVARCHAR(10) 添加 11 字符长度的字符串会导致 SQL 异常，而不是 Linq2SQL 异常。

```
The data was truncated while converting from one data type to another. 
     [ Name of function(if known) =  ]
A first chance exception of type 'System.Data.SqlServerCe.SqlCeException' 
     occurred in System.Data.SqlServerCe.dll 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T12:40:55.970

仅当您要创建表时才*需要*DbType ，但这并不意味着它在其余时间被忽略。

例如，如果您定义一个大小为 100 的 VarChar 列，如果您发送的字符串长度超过 100 个字符，即使数据库中的字段实际上可以容纳该字符串，您也会收到异常。

文档说，如果不需要，则不应指定 DbType，因为数据类型是从您使用的值推断出来的。但是，在某些情况下，您可能不希望它使用推断的 DbType。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T12:20:54.053

听起来 MSDN 文章可能具有误导性……但是，LINQ-to-SQL 虽然还活着，但并没有获得大量的开发时间，所以我不会屏住呼吸等待更新。

您可以在连接上发帖，或者向 MSDN 页面（社区内容）添加备注。

# java - 从今天开始，我无法在 Eclipse 中访问 netscape.javascript.* 类

> ID：751428
> 
> 赞同：3
> 
> 时间：2009-04-15T12:10:57.523
> 
> 标签：java, applet, netscape

从今天开始，我的 Eclipse 无法加载`JSObject`. 此代码以前工作正常。任何想法如何解决它？我`netscape.jar`在类路径中有简单的。

这是现在无法工作的代码：

```
import netscape.javascript.*;

  ...

    try {
        doc = (JSObject) JSObject.getWindow(app); //.getMember("document");
    } catch(JSException e) {
        doc = null;
        Debug.error("DBscorm().<init>: Exception " + e);
        throw(e);
    } catch(Exception e){
        doc = null;
        Debug.error("DBscorm().<init>: Exception " + e);
        throw(e);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T13:51:10.310

在每个 JDK 子文件夹中都有一个名为 plugin.jar 的文件

获取此文件并将其添加到您的 Eclipse 类路径中。这将使它工作 - 保证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T12:29:51.097

几种可能性：

*   您是否缺少导入语句？尝试使用 CTRL+SHIFT+O 组织导入
*   netscape.jar 是否仍配置为项目的库？（Project Properties->Java Build Path->Libraries 选项卡，然后在必要时单击“Add JARs...”）

# log4j - 如何引导 log4j 输出，以便不同的日志级别转到不同的附加程序？

> ID：751431
> 
> 赞同：8
> 
> 时间：2009-04-15T12:13:22.730
> 
> 标签：log4j

是否可以将“调试”和“信息”输出写入控制台，而“信息”输出仅写入某个日志文件？例如，给定此日志记录：

```
LOG.debug(fileContent);
LOG.info(fileLength); 
```

对应的是`log4j.xml`什么样的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-16T06:30:11.110

好的，我现在知道了：

```
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        ...
    </appender>

    <appender name="otherAppender"
              class="org.apache.log4j.FileAppender FileAppender">
       <param name="Threshold" value="INFO"/>
        ...
    </appender>

    <root>
        <priority     value="debug" />
        <appender-ref ref="console" />
        <appender-ref ref="otherAppender" />
    </root>
</log4j:configuration> 
```

谢谢你的帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T12:29:50.270

这绝对是可能的。配置看起来像这样（不检查语法正确性）：

```
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        ...
    </appender>

    <appender name="otherAppender"
              class="org.apache.log4j.FileAppender FileAppender">
        ...
    </appender>

    <logger name="com.mycompany.mypackage.MyClass">
        <level        value="info"/>
        <appender-ref ref="otherAppender" />
    </logger>

    <root>
        <priority     value="debug" />
        <appender-ref ref="console" />
    </root>
</log4j:configuration> 
```

所有调试和信息消息都发送到`console`附加程序。信息消息转到`otherAppender`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T12:31:44.197

转到[此](http://supportweb.cs.bham.ac.uk/documentation/tutorials/docsystem/build/tutorials/log4j/log4j.html#LOG4J-Basics-Basics-Example-consandpatt)页面以获取一些示例。

就像在程序中添加两个不同的 appender 一样简单，一个 appender 用于您想要执行的每种类型的日志记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T05:28:54.270

With the configuration from Eddie I can only get the "info" output for MyClass. But what I would like to have is that the "info" output of MyClass goes to a file AND the "debug" output of MyClass goes to console.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T05:46:38.000

按照 rwwilden 的建议做，但删除这部分：

```
<logger name="com.mycompany.mypackage.MyClass">
    <level value="info"/>
    <appender-ref ref="otherAppender" />
</logger> 
```

并`<param name="Threshold" value="INFO"/>`在otherAppender下添加。

# javascript - 检测 Iframe 内容何时加载（跨浏览器）

> ID：751435
> 
> 赞同：96
> 
> 时间：2009-04-15T12:15:01.367
> 
> 标签：javascript, events, cross-browser

我正在尝试检测 iframe 及其内容何时加载但运气不佳。我的应用程序在父窗口的文本字段中输入一些内容并更新 iframe 以提供“实时预览”

我开始使用以下代码 (YUI) 来检测 iframe 加载事件何时发生。

```
$E.on('preview-pane', 'load', function(){
    previewBody = $('preview-pane').contentWindow.document.getElementsByTagName('body')[0];
} 
```

'preview-pane' 是我的 iframe 的 ID，我使用 YUI 来附加事件处理程序。但是，尝试在我的回调中访问正文（在 iframe 加载时）失败，我认为是因为 iframe 在事件处理程序准备好之前加载。如果我通过使生成它的 php 脚本休眠来延迟 iframe 加载，则此代码有效。

基本上，我问的是跨浏览器检测 iframe 何时加载且其文档准备就绪的正确方法是什么？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-04-15T13:04:50.327

> 检测 iframe 何时加载且其文档已准备好？

如果您可以让 iframe 从框架内的脚本告诉您自己，那将是理想的选择。例如，它可以直接调用父函数来告诉它它已经准备好了。跨框架代码执行始终需要小心，因为事情可能会以您意想不到的顺序发生。另一种选择是设置'var isready = true;' 在其自己的范围内，并让父脚本嗅探“contentWindow.isready”（如果没有，则添加 onload 处理程序）。

如果由于某种原因让 iframe 文档协作不切实际，那么您就会遇到传统的负载竞争问题，即即使元素彼此相邻：

```
<img id="x" ... />
<script type="text/javascript">
    document.getElementById('x').onload= function() {
        ...
    };
</script> 
```

无法保证在脚本执行时该项目尚未加载。

摆脱负载竞争的方法是：

1.  在 IE 上，您可以使用 'readyState' 属性来查看是否已经加载了某些内容；

2.  如果可以接受仅启用 JavaScript 的项目，您可以动态创建它，在设置源和附加到页面之前设置“onload”事件函数。在这种情况下，在设置回调之前无法加载它；

3.  将其包含在标记中的老式方法：

    `<img onload="callback(this)" ... />`

HTML 中的内联“onsomething”处理程序几乎总是错误的，应该避免，但在这种情况下，有时它是最不坏的选择。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-04-15T12:23:33.297

请参阅[此](http://sonspring.com/journal/jquery-iframe-sizing)博客文章。它使用 jQuery，但即使您不使用它，它也会对您有所帮助。

基本上你把它添加到你的`document.ready()`

```
$('iframe').load(function() {
    RunAfterIFrameLoaded();
}); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-12-26T11:11:51.520

对于那些使用 React 的人来说，检测同源 iframe 加载事件就像`onLoad`在 iframe 元素上设置事件监听器一样简单。

`<iframe src={'path-to-iframe-source'} onLoad={this.loadListener} frameBorder={0} />`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-12T22:58:29.453

对于使用 Ember 的任何人，这应该可以按预期工作：

```
<iframe onLoad={{action 'actionName'}}  frameborder='0' src={{iframeSrc}} /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2022-01-24T16:33:03.463

1.  **此代码在没有 jquery**的情况下检测 iframe 内容何时加载：

信用[Biranchi 的回答](https://stackoverflow.com/questions/9249680/how-to-check-if-iframe-is-loaded-or-it-has-a-content/10444444#10444444)

```
 // wait for the doc to load (wait for the class 'iframe...' to load) before sending the script
    checkIframeLoaded()

    function checkIframeLoaded() {
        // console.log(" function checked")
        // Get a handle to the iframe element
        var iframe = document.getElementsByClassName("docs-texteventtarget-iframe")[0];
        console.log("iframe", iframe)
        // check if the iframe is loaded or not (= undefined = null)
        if (iframe == null) {
            // If we are here, it is not loaded. Set things up so we check the status again in 1000 milliseconds
            window.setTimeout(checkIframeLoaded, 1000);
        } else {
            var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            // Check if loading is completed
            if (iframeDoc.readyState == 'complete') {

                // The loading is complete, call the function we want executed once the iframe is loaded
                iframeDoc.addEventListener("keydown", dispatchkeyboard, false);
            } else {
                // even if the iframe is loaded the "readystate may not be completed yet" so we need to recall the function.
                window.setTimeout(checkIframeLoaded, 1000);
            }
        }
    } 
```

1.  此代码适用**于 jquery**：

信用：[吉尔斯·布斯凯的回答](https://stackoverflow.com/a/46217408/1486850)

```
 // use jquery to detect when iframe is loaded but doesn't work offline
    // (this code needs jQuery because it use the "$" below). if you use it; add this require in the ===usercript=== section
    //  @require    http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js

    var editingIFrame = $('iframe.docs-texteventtarget-iframe')[0];
   if (editingIFrame) {
        console.log("inside doc.getele")
        editingIFrame.contentDocument.addEventListener("keydown", dispatchkeyboard, false);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-20T10:06:34.863

```
jQuery(document).ready(function () {
    jQuery('iframe').load(function() {
        console.log(jQuery(this))
    });
}) 
```

# immutability - 存储库和不可变对象？

> ID：751437
> 
> 赞同：4
> 
> 时间：2009-04-15T12:15:31.740
> 
> 标签：immutability, irepository

我可能会因阻抗不匹配而注定要失败，但我正在尝试协调我在 IRepository 和不可变对象中看到的示例。

我正在开发一个编目应用程序，其中数百个 Web 请求在产品的“工作集”上运行——整个目录的一个子集往往在任何给定时间都在发挥作用。

同时，我们的数据团队不断更新产品数据——新图片、更新价格、描述等。

在我看来，就性能而言，我最好将产品视为不可变的。它们由存储库加载和缓存，并且许多线程可以同时访问同一个产品对象。

但是这个想法似乎与我看到的许多使用 Update/Delete 方法的 IRepository 示例不同——只要线程可以写入产品，似乎我就会对比赛和其他讨厌的事情敞开心扉。

因此，我设想了一个“编辑器”模型，其中通过伴随的“编辑器”对象对实体进行更改，然后保持更改并强制重新加载相关产品以供所有人使用。产品永远不会改变 - 只是在外部“编辑”并重新加载。

这有道理吗？正如我所看到的那样，这可以与存储库一起使用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T12:21:28.310

存储库仅负责数据检索/存储。工厂负责创建新对象。

在您的情况下，不可变对象是可以的。但是，您需要一些方法来使被取代的产品无效并将它们从存储库缓存中删除。在大多数情况下，任何悬空引用都可以忽略，因为它们在检索时有效。

在产品更新的情况下，您需要确保通过工厂创建新产品。您的存储库将仅包括三种操作类型：检索（或查找）、保存和取代。Save 存储新产品的位置，该产品未更改。而取代将存储新产品，使旧产品无效并将其从缓存中清除。

就 C# 签名而言，我可以想象这两种存储方法具有以下外观：

```
void Save(Product product);

void Supersede(Product oldProduct, Product newProduct); 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T12:20:10.827

是否存在无法进行简单锁定（排他/悲观或[乐观](http://en.wikipedia.org/wiki/Optimistic_concurrency_control)）的高并发或性能要求？

# linux - 创建软件设备的最佳实践？

> ID：751451
> 
> 赞同：-1
> 
> 时间：2009-04-15T12:20:35.847
> 
> 标签：linux, jmx, portal, appliance

我有一个应用程序，客户要求我们将其打包到一个软件设备中，并希望找到我需要考虑的所有事项的列表。与选择操作系统相关的东西都有很好的文档记录，但其他方面，例如构建可用的 Web 控制台、我应该考虑的框架（应用程序是用 Java 编写的）以及我可能需要在设计方面进行重构的东西却没有。

非常感谢任何指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T12:57:56.757

创建设备时需要考虑几件事情。您不想从事的一件事是维护操作系统。所以选择一个被认为是稳定和安全的操作系统。安装操作系统时，仅包含您的应用程序绝对需要的那些软件包。始终选择任何应用程序框架的稳定版本。理想情况下，您将使用相对主流的东西。再一次，您应该支持您的应用程序，而不是框架。

一份非详尽的清单将包括以下内容：

*   选择一个稳定、受支持、安全的操作系统。
*   选择商品，现成的硬件。零件应易于查找和更换。
*   不要安装未使用的软件包。
*   弄清楚部署后如何修补/更新软件。
*   提供基于 Web 的配置选项，这样您就不必登录到 shell 来更改设置。
*   出于与上述相同的原因，通过 Web 前端使日志文件可用。
*   在启动期间引导您的应用程序。
*   确定如何保护 Web 前端和一般设备。
*   提供一种在一般硬件故障的情况下将您的应用程序迁移到另一个设备的方法。
*   您的应用程序是否值得集群和故障转移？
*   使备份您的应用程序变得轻松无痛。理想情况下，您的用户不必关闭应用程序来备份他们的数据。

# python - 调度员蟒蛇

> ID：751455
> 
> 赞同：0
> 
> 时间：2009-04-15T12:22:08.853
> 
> 标签：python

大家好，我有以下“错误”调度员：

```
def _load_methods(self):
    import os, sys, glob
    sys.path.insert(0, 'modules\commands')
    for c in glob.glob('modules\commands\Command*.py'):
        if os.path.isdir(c):
            continue
        c = os.path.splitext(c)[0]
        parts = c.split(os.path.sep )
        module, name = '.'.join( parts ), parts[-1:]
        module = __import__( module, globals(), locals(), name )
        _cmdClass = __import__(module).Command
        for method_name in list_public_methods(_cmdClass):
            self._methods[method_name] = getattr(_cmdClass(), method_name)
    sys.path.pop(0) 
```

它产生以下错误：

ImportError：没有名为 commands.CommandAntitheft 的模块

其中 Command*.py 放置在 modules\commands\ 文件夹中

有人能帮我吗？

一种可能的解决方案（它有效！！！）是：

```
 def _load_methods(self):
    import os, sys, glob, imp

    for file in glob.glob('modules/commands/Command*.py'):
        if os.path.isdir(file):
            continue
        module = os.path.splitext(file)[0].rsplit(os.sep, 1)[1]
        fd, filename, desc = imp.find_module(module,
                ['./modules/commands'])
        try:
            _cmdClass = imp.load_module( module, fd, filename, desc).Command
        finally:
            fd.close()

        for method_name in list_public_methods(_cmdClass):
            self._methods[method_name] = getattr(_cmdClass(), method_name) 
```

bobince（坦克:-)）建议的所有风险仍然存在，但现在我可以在“运行时”加载命令

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:33:23.863

> sys.path.insert(0, 'modules\commands')

最好不要将相对路径放入 sys.path。如果当前目录在执行过程中发生变化，它将中断。

此外，如果您从与脚本不同的目录运行，它将无法工作。如果要使其相对于脚本的位置，请使用**file**。

此外，为了安全起见，'\' 字符应该转义为 '\\'，实际上它应该使用`os.path.join()`而不是依赖于 Windows 路径规则。

```
sys.path.insert(0, os.path.abspath(os.path.join(__file__, 'modules'))) 
```

> sys.path.pop(0)

危险的。如果另一个导入的脚本与 sys.path 一起使用（并且可能），那么您将拉错路径。您自己的模块的重新加载也会中断。最好离开它所在的路径。

> 模块，名称 = '.'.join( 部分 )，部分 [-1:]

请记住，您的路径包括“模块”段。因此，您正在有效地尝试：

```
import modules.commands.CommandSomething 
```

但由于“modules.commands”已经在您添加搜索的路径中，您真正想要的只是：

```
import CommandSomething 
```

> __import__（模块，全局（），本地（），名称）

'fromlist' 也是一个列表，所以如果你真的想让它写 'CommandSomething' 到你的局部变量，它应该是 '[name]'。（您几乎肯定不想要这个；将 fromlist 留空。）

> _cmdClass = __import__(module).Command

是的，这行不通，模块是一个模块对象，而 __import__ 想要一个模块名称。你已经有了模块对象；为什么不只是“module.Command”？

我对这一切的反应很简单：*太多的魔法*。

你让这对自己来说过于困难，并且通过弄乱导入系统的内部来制造许多潜在的问题和脆弱性。即使对于有经验的 Python 程序员来说，这也是一件棘手的事情。

使用显式导入的普通旧 Python 模块几乎肯定会更好。硬编码命令列表确实不是什么大问题。将所有命令放在一个包中， __init__.py 说：

```
__all__= ['ThisCommand', 'ThatCommand', 'TheOtherCommand'] 
```

可能会重复文件名一次，但比过多的魔法更简单、更健壮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T18:41:04.577

你真的需要将东西作为模块导入吗？如果您只是从文件系统中的任意位置加载代码，而不是摆弄模块路径等，您可以使用[`execfile`](http://docs.python.org/library/functions.html#execfile).

IE。

```
for file in glob.glob('modules/commands/Command*.py'):
    if os.path.isdir(file):
        continue

    moddict={}
    execfile(file, moddict)
    _cmdClass = moddict['Command']
    ... 
```

# python - 可以将方法调用链接到内置的“set()”吗？（那么为何不？）

> ID：751457
> 
> 赞同：3
> 
> 时间：2009-04-15T12:23:08.603
> 
> 标签：python

如果我尝试：

```
mi_list = ['three', 'small', 'words']
mi_set = set(mi_list)
mi_set.remove('small')
print mi_set 
```

我得到：

```
set(['three', 'words']) 
```

这是我所期望的。而如果我尝试：

```
mi_list = ['three', 'small', 'words']
mi_set = set(mi_list).remove('small')
print mi_set 
```

我得到：

```
None 
```

为什么？

我怀疑有一个线索，如果我尝试删除不存在的元素 - 例如“大” - 会报告错误：

```
KeyError: 'big' 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-15T12:33:57.297

`set.remove`什么都不返回（无）。

您的代码将 的返回值分配给`set.remove`变量`mi_set`。因此，mi_set 为无。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-15T22:11:55.240

python 中有一个通用约定，*即导致[副作用的](http://en.wikipedia.org/wiki/Side_effect_(computer_science))方法返回 None*。示例包括 list.sort、list.append、set.add、set.remove、dict.update 等。

这本质上是为了帮助您避免错误。假设您有一个名为 mi_set 的集合。如果你能写：

```
mi_set2 = mi_set.remove('small') 
```

那么读者可能会想：“`mi_set2`不同于`mi_set`”。但事实并非如此！并且混淆可能会导致由于错误地共享数据结构而导致的细微错误。因此，通过返回`None`，python 迫使您记住我上面列出的那些方法会修改对象，而不是创建新对象。

另请参阅[此处](http://mail.python.org/pipermail/python-list/2004-August/277901.html)的长讨论。尽管请注意，自该线程以来已添加了类似`sorted()`和`reversed()`已添加的方法。

[请注意，由于历史原因，list.pop 是该规则的一个例外——它允许您使用像堆栈一样的列表。即使这样，它也会返回删除的对象，而不是列表。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T12:48:02.333

在您的情况下，要走的路是使用**差异**成员：

```
>>> a = set(["a", "b", "c"])
>>> a = a.difference(["a"])
>>> print a
set(['c', 'b']) 
```

区别在于**remove**作用于当前集合（修改实例的 python 库对象成员函数通常返回 None），而**区别**创建并返回一个新集合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T13:00:11.010

为什么会返回`None`？因为 .remove、.add 等返回`None`:) 就是这样。它们不支持链接。

`set`正在使用改变它的方法。您可以创建自己的使用链接的 set 版本，但这可能会导致一些问题：

```
class chain_set(set):
   def chain_add(self, x):
      newself = self.copy()
      newself.add(x)
      return newself

cs = chain_set([1,2,3,4])
cs.chain_add(5)
# chain_set([1, 2, 3, 4, 5])
cs.chain_add(7)
# chain_set([1, 2, 3, 4, 7])
cs.chain_add(7).chain_add(8)
# chain_set([1, 2, 3, 4, 7, 8]) 
```

问题是——你期望`cs`自己改变吗？

您是否总是想修改原始集（可能会产生一些难以发现的错误）或者您是否希望每次都复制该集（较大的集可能会很慢）。如果你知道你需要什么行为并且你记得它 - 只需继续你自己的集合实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T12:33:33.803

您确定该`remove`函数返回一个值吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-16T07:50:46.580

remove 修改原始集合而不返回任何内容（或者更确切地说，它返回 None）。此示例显示当您对原始对象调用 remove 时会发生什么情况：

```
Python 3.0.1 (r301:69561, Feb 13 2009, 20:04:18) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> lst = [1,2,3]
>>> s1 = set(lst)
>>> s1
{1, 2, 3}
>>> s2 = s1.remove(2)  # instead of reassigning s1, I save the result of remove to s2
>>> s1
{1, 3}  # *** 2 is not an element in the original set ***
>>> s2  # s2 is not a set at all!
>>> 
```

要回答您问题的另一部分，异常表明 remove 尝试从集合中删除参数，但不能因为参数不在集合中。相反，remove 返回 None 表示成功。

# c# - .NET 多选列表框 - 如何获取刚刚选择的项目？

> ID：751465
> 
> 赞同：0
> 
> 时间：2009-04-15T12:24:48.427
> 
> 标签：c#, vb.net, listbox

在 .NET 中，似乎没有一个属性可以在多选列表框中找到*刚刚选择的项目；*SelectedIndex 始终显示第一个选定的项目。从内存中，VB6 的 ListIndex 属性发生了相应的变化……为什么要删除一个有用的属性？！

**重复：** [如何获取多选列表框中的最后一个选定项目？](https://stackoverflow.com/questions/305555/how-to-get-the-last-selected-item-in-multiselect-listbox)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T12:32:41.950

创建您自己的从列表框继承的列表框并覆盖 onclick？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-18T14:25:27.673

您能否创建一个隐藏字段并将每次单击事件时选择的值复制到该字段中。这应该始终包含客户端选择的最后一项。

# c# - C#/.NET：使用 NUnit 测试 BackgroundWorker

> ID：751472
> 
> 赞同：2
> 
> 时间：2009-04-15T12:27:24.193
> 
> 标签：c#, .net, multithreading, unit-testing, backgroundworker

此测试在使用 NUnit 控制台运行程序运行时失败。如果我只用 TestDriven.NET 运行该测试，它就可以工作，但如果我用 TestDriven.NET 运行整个套件，它就不行：

```
[Test]
public void BackgroundWorkerFiresRunWorkerCompleted()
{
  var runner = new BackgroundWorker();
  ManualResetEvent done = new ManualResetEvent(false);
  runner.RunWorkerCompleted += delegate { done.Set(); };

  runner.RunWorkerAsync();

  bool res = done.WaitOne(TimeSpan.FromSeconds(10));
  // This assert fails:
  Assert.IsTrue(res, "RunWorkerCompleted was not executed within 10 seconds");
} 
```

我怀疑这个问题与没有消息循环有关，但我不确定。

使用 BackgroundWorker 有什么要求？

是否有解决方法可以使测试正常工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T12:45:48.253

我认为这与消息泵无关，因为无论如何测试通常都以阻塞方式运行。但可能是在“UI”线程上调用了该事件，该线程使用未处理的 Windows 消息。

因此，如果问题是消息泵或 Windows 消息未处理，您可以尝试这样替换当前`bool res = done.WaitOne(TimeSpan.FromSeconds(10));`行：

```
DateTime end = DateTime.Now.AddSeconds(10);
bool res = false;
while ((!res) && (DateTime.Now<end)) {
   Application.DoEvents();
   res = done.WaitOne(0):
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T12:31:13.247

您是否缺少 BGW DoWork 事件处理程序？

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2011-01-10T17:53:42.527

只需在您之前添加一个睡眠：

`Assert.IsTrue(res, "RunWorkerCompleted was not executed within 10 seconds");`

像这样的东西：

`System.Threading.Thread.Sleep(10000);`

# coldfusion - 如何使用 ColdFusion 的 ImageMagick

> ID：751477
> 
> 赞同：3
> 
> 时间：2009-04-15T12:29:35.450
> 
> 标签：coldfusion, imagemagick, jmagick

ColdFusion 有一个很棒的 cfimage 标签，可以完美运行。但是，它不允许操纵矢量格式。这使我继续寻找 3rd 方工具来做一些“图像魔术”。

我决定用 ColdFusion 试试 ImageMagick。我读过几篇文章说“我曾经使用 ColdFusion 的 ImageMagick 工作了 X 年”。这是鼓舞人心的，但在遇到问题时并不是特别有用。

我尝试了以下方法：

1.  cfexecute 带参数运行命令行“转换”命令。ColdFusion 页面不产生任何结果 - 只是一个空页面。图像未转换。浏览器没有异常或文本。ImageMagick 命令 'convert image.eps image.jpg' 在 Windows 命令行中完美运行，但在 ColdFusion 中却不行。

2.  Im4java 和 JMagick 包装器直接从 Java 对象运行 IM 命令。我用 CreateObject 函数创建了 Java 对象并试图执行它的方法，但只得到了不同类型的 Java 错误，例如“无法将 image.jpg 转换为整数”。

欢迎任何建议。

谢谢！

PS：我的第一个'stackoverflow' :)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-28T12:01:46.097

经过一些尝试和失败后，我让 ImageMagick (IM) 为我工作。让我简要描述一下如何使用 Coldfusion 的 ImageMagick：

1.  在盒子上安装 ImageMagick 和 Ghostscript。Ghostscript 用于矢量图形操作。
2.  使用 CFEXECUTE 标签调用带有参数的 IM：

    `<cfexecute name="#FullIMPath#" timeout="60" arguments="""#ExpandPath(filename1)#"" ""#ExpandPath(filename2)#""" />`

评论：

一种。在“名称”属性中写入 ImageMagic 可执行文件之一（例如 convert.exe）的完整路径。

湾。为源图像和目标图像编写完整路径。请注意附加引号 - 如果完整路径包含空格（C:\Program Files），则必须将每个图像名称括在双引号中。由于 Coldfusion 解析 'arguments' 属性，因此您必须筛选带有附加引号的引号，例如 - ""C:\Program Files\""。

C。使用 timeout 属性，允许 ImageMagic 在 Coldfusion 进一步执行模板之前产生结果。

谢谢大家的回答和兴趣。

PS：附加提示：

*   ImageMagick 提供多种格式可供使用 - 从常规 JPEG 到 Photoshop *.psd 文件。但是，对于像 Encapsulated Postscript *.eps 这样的矢量格式，您需要安装 Ghostscript；
*   您可以通过小技巧使用 Adob​​e PDF 和 Adob​​e Illustrator (*.ai) 格式 - 将它们重命名为 *.eps 并让 ImageMagick 将它们视为 Encapsulated Postscript 矢量文件。这至少允许将矢量文件转换为位图；
*   进程是资源密集型的，请考虑增加 Coldfusion 的 JVM 内存限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T00:01:27.567

cfexecute 应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T15:18:56.653

还要考虑 cfx_image .. 它是激发 cfimage 灵感的绝佳标签。我相信它也可以做矢量图像。没有什么我做不到的。

# windows - 批处理文件重定向

> ID：751499
> 
> 赞同：0
> 
> 时间：2009-04-15T12:34:21.900
> 
> 标签：windows, batch-file, dos

我有一个调用我的 IDE 的批处理文件，所以我只想知道我们是否可以将我的 IDE 中存在的内容（全部内容）提取到一些文本文件中。

我的批处理文件写在下面

```
D:\WindRiver\wrenv.exe -p vxworks653-2.2.3 run
PAUSE 
```

是否需要将更多代码添加到我现有的批处理文件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T12:44:30.440

我不确定您对“*提取我的 IDE 中存在的内容*”有何看法，但一般来说，这类问题是使用自动化工具解决的。此类工具可以从窗口名称、按钮标题、文本内容中获取 Windows 环境中的任何内容……您可能需要从 3thd 方应用程序中获取的所有内容（甚至是 gui 元素的图片）

我建议你看看[AutoHotKey](http://www.autohotkey.com/)，大约 200KB 的 Windows 自动化脚本语言。

通常，您不能批量执行此操作。

在 AutoHotKey 中获取窗口的内容可以很简单：

```
 WinGetText, text, "name of the window"
 FileAppend, %text%, c:\out.txt 
```

它可能会变得更复杂一些，但是您可能想要的任何东西都不会涉及超过 10 行的 AHK 脚本。

这是最好的方法，因为它不依赖于给定程序的特性，所以一旦你学习了 AHK，你可以以统一的方式从系统中获取任何信息。

请记住，某些应用程序使用非标准 Windows 组件，并且它们可能无法自动化（但这很少见）。

在社区论坛上有很多有用的函数和库，基本上你可能需要任何东西来获取信息 - 将标准输入/输出重定向到你的文件，COM Accesibilty 模块（在 Windows 中自动化的系统方法），甚至一些 ocr 包装器扫描图像上的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T18:28:00.753

抱歉回复晚了。这是实际的 IDE(D:\WindRiver\wrev.exe -p vxworks653-2.2.3)，当我将它放在命令提示符中时，我的 IDE 被调用。请再联系我澄清

谢谢斯蒂芬

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T12:41:12.740

我问了一个可能有用[的类似问题。](https://stackoverflow.com/questions/106453/how-do-i-redirect-tornado-vxworks-shell-output)只有当您的 IDE 将信息输出到 stdout/stderr 等时，这种方法才可能起作用。

我已经取得了一些（有限的）成功，连接到已经运行的进程以尝试拦截它们正在输出的数据。

具体来说，您要捕捉的是什么？它的一个窗口的输出？如果启动失败会提示错误信息？

**[编辑]**我仍然不确定您要捕获的确切内容，但听起来您可以从批处理文件中启动 Python 脚本。[该脚本启动您的 IDE](https://stackoverflow.com/questions/24931/how-to-capture-python-interpreters-and-or-cmd-exes-output-from-a-python-script)并捕获 stdout 和 stderr，这将为您提供正常输出*和*任何错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T15:49:56.013

**>>> 嗨，我刚刚尝试使用 AutoHotKey....**

不，它不正确。

只有当我安装了我没有的 WindRiver 时才能生成正确的代码。好的，让我简短地解释一下。

首先假设 IDE 的标题以“WindRiver”字样开头。WindRiver 必须在其控件层次结构中的某些标准窗口控件中保存文本。有问题的控件类型指导您如何从中获取文本。例如，如果它是 ListView 或 ListBox，则必须使用

```
ControlGet, outputVar, List,, SysListView321, WindRiver 
```

上面的代码的意思是，“从标题以'WindRiver'开始的应用程序中获取第一个SysListView32控件的文本（因此最后是1），并将其放入ouputVar变量中”

如果它保留在编辑框中，您可以简单地执行以下操作：

```
ControlGetText, OutputVar, Edit1, WindRiver 
```

这意味着“在应用程序中获取标题为 WindRiver 的第一个编辑控件的内容”

为了获得相关控件的类型和数量，只需打开 Window Spy（右键单击 AHK 托盘图标）并将鼠标悬停在控件上即可查看其详细信息。

整个脚本将如下所示：

```
Run, d:\WIndriver ....
WinWaitActive, WindRiver
ControlGetText, OutputVar, Edit1, WindRiver
MsgBox %OtputVar% 
```

如果窗口的标题不断变化，您将不得不使用窗口类 instad title 来识别窗口。例如，您可以将记事本定位为

```
ControlGetText, o, Edit1, Untitled 
```

或者

```
COntrolGetText, o, Edit1, ahk_class Notepad 
```

第一种方法使用窗口标题，第二种方法使用应用程序的 Window API 类，因为标题可以更改，所以效果更好。

总而言之，要熟悉 AHK，请查看启动示例。我可以向你保证，经过几天的练习，你会发现自己可以根据自己的需要调整任何应用程序。

要了解 AHK 的强大功能以及可以在其中完成哪些惊人的事情，请查看[Dock](http://www.autohotkey.com/forum/topic19400.html)模块。

您无法批量执行此操作并使用 std 重定向，因此您最好习惯 AHK 或一些类似的自动语言（AutoIt、Phantom、WinRunner....）。顺便说一句，这种问题通常会在 AHK 社区请求帮助论坛上的几个小时内得到回答。

# sql - SQL CLR 存储过程和 Web 服务

> ID：751500
> 
> 赞同：4
> 
> 时间：2009-04-15T12:34:37.467
> 
> 标签：sql, web-services, permissions, clrstoredprocedure

我目前正在处理一项需要从 CLR 存储过程调用 Web 服务中的方法的任务。

一点背景：

基本上，我有一项需要大量工作的任务。如果严格在 SQL 中完成，处理大约需要 30-45 分钟。如果我将相同的过程放入代码中，我可以在几秒钟内完成它，因为能够更有效地优化处理。唯一的问题是我必须将此进程设置为 SQL Server 中的自动化任务。

在这种情况下，我将流程公开为 Web 服务（我也将它用于其他事情）并希望 SQL CLR 存储过程使用该服务并执行代码。这让我可以完成我的自动化任务。

问题：

我已经阅读了很多关于如何在 CLR Sproc 中使用 Web 服务的不同主题，并且非常有效地做到了这一点。这是我所遵循的示例。

[http://blog.hoegaerden.be/2008/11/11/calling-a-web-service-from-sql-server-2005/](http://blog.hoegaerden.be/2008/11/11/calling-a-web-service-from-sql-server-2005/)

我可以让这个例子正常工作。但是，每当我将此进程与涉及数据库调用的 Web 服务方法配对时，我都会收到以下异常（取决于我是否包含在 try/catch 中）：

消息 10312，级别 16，状态 49，过程 usp_CLRRunDirectSimulationAndWriteResults，第 0 行 .NET Framework 执行已中止。UDP/UDF/UDT 没有恢复线程令牌。

或者

> 消息 6522，级别 16，状态 1，过程 MyStoredProc，第 0 行
> 
> 执行用户定义的例程或聚合“MyStoredProc”期间发生 .NET Framework 错误：
> 
> System.Security.SecurityException：请求“System.Security.Permissions.EnvironmentPermission，mscorlib，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”类型的权限失败。
> 
> System.Security.SecurityException：
> 
> 在 System.Security.CodeAccessSecurityEngine.Check（对象需求，StackCrawlMark& stackMark，布尔 isPermSet）
> 
> 在 System.Security.CodeAccessPermission.Demand()
> 
> 在 System.Net.CredentialCache.get_DefaultCredentials()
> 
> 在 System.Web.Services.Protocols.WebClientProtocol.set_UseDefaultCredentials（布尔值）
> 
> 在 MyStoredProc.localhost.MPWebService.set_UseDefaultCredentials（布尔值）
> 
> 在 MyStoredProclocalhost.MPWebService..ctor()
> 
> 在 MyStoredProc.StoredProcedures.MyStoredProc（字符串 FromPostCode，字符串 ToPostCode）

我确信这是一个许可问题，但我不能，因为我的生活让它工作。我曾尝试在 CLR 存储过程中使用模拟和其他一些东西。有什么建议么？我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-19T18:08:31.057

我只是想出来，但这就是我得到的：

在 SQL 中创建程序集时，您需要将 permission_set 设置为 UNSAFE。

```
CREATE ASSEMBLY [<assemblyname>] FROM '<path>/<assemblyname>.dll'
WITH PERMISSION_SET = UNSAFE
GO 
```

如果您使用 VS SQL 数据库项目进行部署，也可以通过在数据库项目的属性的数据库选项卡上将权限设置为不安全来完成。

# java - ant 中的类路径验证

> ID：751501
> 
> 赞同：2
> 
> 时间：2009-04-15T12:35:08.463
> 
> 标签：java, ant, build-process, build, classpath

我`<path id="...">`的`build.xml`. 在调用编译器之前，我想验证类路径上的每个 jar/目录是否存在，并打印缺少的警告。有人知道现有的解决方案还是我需要为此编写自己的任务？

* * *

好的，我决定去做一个自定义任务。在这里，以防有人需要这样的东西：

```
import java.io.File;
import java.util.Iterator;

import org.apache.tools.ant.BuildException;
import org.apache.tools.ant.Task;
import org.apache.tools.ant.types.Reference;
import org.apache.tools.ant.types.ResourceCollection;
import org.apache.tools.ant.types.resources.Resources;

public class CheckClasspathTask extends Task {

    private Reference reference;

    public CheckClasspathTask() {
    }

    public void setRefId(Reference reference) {
        this.reference = reference;
    }

    public void execute() throws BuildException {
        Resources resources = new Resources();
        resources.setProject(getProject());
        resources.add((ResourceCollection) reference.getReferencedObject());
        boolean isFirst = true;
        for (Iterator i = resources.iterator(); i.hasNext(); ) {
            String f = i.next().toString();
            if (!new File(f).exists()) {
                if (isFirst) {
                    isFirst = false;
                    System.out.println("WARNING: The following entries on your classpath do not exist:");
                }
                System.out.println(f);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-26T20:09:12.433

这将检查类路径中的每个文件或文件夹是否存在。如果其中一个不存在，则构建将失败，并显示第一个无法找到的名称。

```
<target name="check-classpath" depends="create-classpath">
    <pathconvert pathsep="," property="myclasspath" refid="compile.classpath"/>
    <foreach list="${myclasspath}" param="file" target="check-file-or-folder-exists" />
</target>

<target name="check-file-or-folder-exists">
    <fail message="Error: ${file} not found">
      <condition>
        <not>
          <available file="${file}" />
        </not>
      </condition>
    </fail>
</target> 
```

请注意，`<foreach>`在 ant-contribs -- [Ant Contribs clickable LINK](http://ant-contrib.sourceforge.net/tasks/tasks/foreach.html)

这将需要加载 ant-contrib jar 并连接其中的所有目标：

```
<taskdef resource="net/sf/antcontrib/antcontrib.properties">
    <classpath>
        <pathelement location="${some.lib.dir}/ant-contrib-1.0b3.jar" />
    </classpath>
</taskdef> 
```

应该存在一个`<for>`任务，允许设置一个选项以继续遍历所有路径元素，并且只在最后显示一个错误。我发现我的 Eclipse 版本`<foreach>`已经在类路径中，所以我认为这对我来说已经足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T16:47:48.717

我会说可能有一个自定义的 ant 任务是有序的，有点像在这个[build.xml](http://code.google.com/p/switchtransaccional/source/browse/FrontEnds/nbproject/build-impl.xml?r=34)`org.netbeans.modules.bpel.project.anttasks.ValidateBPELProjectTask`的 ' `pre-dist`' 目标中完成的。

注意：[ValidateBPELProjectTask ant 任务](http://www.koders.com/java/fid176241E48F72FBB1B5AD8F6DD366BCCC0B3ABD61.aspx?s=AntClassLoader#L95)比您通常的自定义任务要复杂一些：它需要有自己的类路径才能运行（类路径最初并未最初传递给 build.xml）。
由于您无法修改当前 ant 任务类加载器的类路径，因此 ValidateBPELProjectTask 定义了一个新的`AntClassLoader`并调用`setContextClassLoader()`.

不过，您将不需要这样的机制：您只需将要检查的目录列表作为参数传递给您的任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T18:07:09.273

我还没有找到很多方法来使用默认任务迭代 Ant 脚本中的路径。如果您在具有类 UNIX 外壳的机器上构建，您可以调用外壳来检查类路径元素。

调用 shell 脚本时，您可以使用[`apply`task](http://ant.apache.org/manual/Tasks/apply.html)，但是当类路径元素不存在时，我无法打印它。

假设您有以下类路径声明：

```
<path id="your.classpath">
    <fileset dir="your.libs"/>
    <pathelement location="/some/missing/dir"/>
</path> 
```

这将报告是否缺少任何元素，但不会告诉您哪些元素：

```
<apply executable="test" type="file" ignoremissing="false">
    <arg value="-e"/>
    <srcfile/>
    <path refid="build.classpath"/>
</apply> 
```

您可以将其与一个简单的 shell 脚本结合起来，并通过更改`executable`属性来获得所需的内容——假设您只想要一个大的警告消息而不是构建失败：

```
#!/bin/sh

test -e "$1" || echo "WARNING: Classpath element $1 does not exist!" 
```

如果您希望构建失败，您可以将`apply`任务设置为在报告错误时失败（在这种情况下是缺少文件/目录），然后修改 shell 脚本以在打印警告后返回非零退出代码。

另一种方法是使用[`exec`任务](http://ant.apache.org/manual/Tasks/exec.html)并内联执行一个小脚本：

```
<pathconvert property="classpath" refid="build.classpath" pathsep=":"/>
<exec executable="sh">
    <arg value="-c"/>
    <arg value="for f in `echo ${classpath} | tr ':' '\n'`; do test -e $f || echo WARNING: Classpath element $f     does not exist!; done"/>
</exec> 
```

# c# - 在 C# 中针对引用的 XSD 验证 XML

> ID：751511
> 
> 赞同：170
> 
> 时间：2009-04-15T12:40:00.090
> 
> 标签：c#, xml, xsd

我有一个具有指定架构位置的 XML 文件，例如：

```
xsi:schemaLocation="someurl ..\localSchemaPath.xsd" 
```

我想在 C# 中进行验证。当我打开文件时，Visual Studio 会根据架构验证它并完美地列出错误。但是，不知何故，如果不指定要验证的架构，我似乎无法在 C# 中自动验证它，如下所示：

```
XmlDocument asset = new XmlDocument();

XmlTextReader schemaReader = new XmlTextReader("relativeSchemaPath");
XmlSchema schema = XmlSchema.Read(schemaReader, SchemaValidationHandler);

asset.Schemas.Add(schema);

asset.Load(filename);
asset.Validate(DocumentValidationHandler); 
```

我不应该能够自动使用 XML 文件中指定的模式进行验证吗？我错过了什么？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2009-04-15T17:16:35.340

您需要创建一个 XmlReaderSettings 实例，并在创建时将其传递给您的 XmlReader。然后您可以`ValidationEventHandler`在设置中订阅以接收验证错误。您的代码最终将如下所示：

```
using System.Xml;
using System.Xml.Schema;
using System.IO;

public class ValidXSD
{
    public static void Main()
    {

        // Set the validation settings.
        XmlReaderSettings settings = new XmlReaderSettings();
        settings.ValidationType = ValidationType.Schema;
        settings.ValidationFlags |= XmlSchemaValidationFlags.ProcessInlineSchema;
        settings.ValidationFlags |= XmlSchemaValidationFlags.ProcessSchemaLocation;
        settings.ValidationFlags |= XmlSchemaValidationFlags.ReportValidationWarnings;
        settings.ValidationEventHandler += new ValidationEventHandler(ValidationCallBack);

        // Create the XmlReader object.
        XmlReader reader = XmlReader.Create("inlineSchema.xml", settings);

        // Parse the file. 
        while (reader.Read()) ;

    }
    // Display any warnings or errors.
    private static void ValidationCallBack(object sender, ValidationEventArgs args)
    {
        if (args.Severity == XmlSeverityType.Warning)
            Console.WriteLine("\tWarning: Matching schema not found.  No validation occurred." + args.Message);
        else
            Console.WriteLine("\tValidation error: " + args.Message);

    }
} 
```

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2012-08-03T18:47:01.807

如果您使用的是 .NET 3.5，一种更简单的方法是使用`XDocument`和`XmlSchemaSet`验证。

```
XmlSchemaSet schemas = new XmlSchemaSet();
schemas.Add(schemaNamespace, schemaFileName);

XDocument doc = XDocument.Load(filename);
string msg = "";
doc.Validate(schemas, (o, e) => {
    msg += e.Message + Environment.NewLine;
});
Console.WriteLine(msg == "" ? "Document is valid" : "Document invalid: " + msg); 
```

有关更多帮助，请参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/bb340331.aspx)。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-08-03T14:57:42.150

以下[示例](https://msdn.microsoft.com/en-us/library/db5d30c9(v=vs.110).aspx)验证 XML 文件并生成相应的错误或警告。

```
using System;
using System.IO;
using System.Xml;
using System.Xml.Schema;

public class Sample
{

    public static void Main()
    {
        //Load the XmlSchemaSet.
        XmlSchemaSet schemaSet = new XmlSchemaSet();
        schemaSet.Add("urn:bookstore-schema", "books.xsd");

        //Validate the file using the schema stored in the schema set.
        //Any elements belonging to the namespace "urn:cd-schema" generate
        //a warning because there is no schema matching that namespace.
        Validate("store.xml", schemaSet);
        Console.ReadLine();
    }

    private static void Validate(String filename, XmlSchemaSet schemaSet)
    {
        Console.WriteLine();
        Console.WriteLine("\r\nValidating XML file {0}...", filename.ToString());

        XmlSchema compiledSchema = null;

        foreach (XmlSchema schema in schemaSet.Schemas())
        {
            compiledSchema = schema;
        }

        XmlReaderSettings settings = new XmlReaderSettings();
        settings.Schemas.Add(compiledSchema);
        settings.ValidationEventHandler += new ValidationEventHandler(ValidationCallBack);
        settings.ValidationType = ValidationType.Schema;

        //Create the schema validating reader.
        XmlReader vreader = XmlReader.Create(filename, settings);

        while (vreader.Read()) { }

        //Close the reader.
        vreader.Close();
    }

    //Display any warnings or errors.
    private static void ValidationCallBack(object sender, ValidationEventArgs args)
    {
        if (args.Severity == XmlSeverityType.Warning)
            Console.WriteLine("\tWarning: Matching schema not found.  No validation occurred." + args.Message);
        else
            Console.WriteLine("\tValidation error: " + args.Message);

    }
} 
```

前面的示例使用以下输入文件。

```
<?xml version='1.0'?>
<bookstore xmlns="urn:bookstore-schema" xmlns:cd="urn:cd-schema">
  <book genre="novel">
    <title>The Confidence Man</title>
    <price>11.99</price>
  </book>
  <cd:cd>
    <title>Americana</title>
    <cd:artist>Offspring</cd:artist>
    <price>16.95</price>
  </cd:cd>
</bookstore> 
```

书籍.xsd

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    xmlns="urn:bookstore-schema"
    elementFormDefault="qualified"
    targetNamespace="urn:bookstore-schema">

 <xsd:element name="bookstore" type="bookstoreType"/>

 <xsd:complexType name="bookstoreType">
  <xsd:sequence maxOccurs="unbounded">
   <xsd:element name="book"  type="bookType"/>
  </xsd:sequence>
 </xsd:complexType>

 <xsd:complexType name="bookType">
  <xsd:sequence>
   <xsd:element name="title" type="xsd:string"/>
   <xsd:element name="author" type="authorName"/>
   <xsd:element name="price"  type="xsd:decimal"/>
  </xsd:sequence>
  <xsd:attribute name="genre" type="xsd:string"/>
 </xsd:complexType>

 <xsd:complexType name="authorName">
  <xsd:sequence>
   <xsd:element name="first-name"  type="xsd:string"/>
   <xsd:element name="last-name" type="xsd:string"/>
  </xsd:sequence>
 </xsd:complexType>

</xsd:schema> 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2015-11-06T10:24:12.700

我个人喜欢在没有回调的情况下进行验证：

```
public bool ValidateSchema(string xmlPath, string xsdPath)
{
    XmlDocument xml = new XmlDocument();
    xml.Load(xmlPath);

    xml.Schemas.Add(null, xsdPath);

    try
    {
        xml.Validate(null);
    }
    catch (XmlSchemaValidationException)
    {
        return false;
    }
    return true;
} 
```

（请参阅 Timiz0r 在[Synchronous XML Schema Validation? .NET 3.5](https://stackoverflow.com/questions/7719022/synchronous-xml-schema-validation-net-3-5)中的帖子）

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-04-15T12:54:50.930

我曾在 VB 中进行过这种自动验证，这就是我的做法（转换为 C#）：

```
XmlReaderSettings settings = new XmlReaderSettings();
settings.ValidationType = ValidationType.Schema;
settings.ValidationFlags = settings.ValidationFlags |
                           Schema.XmlSchemaValidationFlags.ProcessSchemaLocation;
XmlReader XMLvalidator = XmlReader.Create(reader, settings); 
```

然后我在阅读文件时订阅了该`settings.ValidationEventHandler`事件。

# csv - 链式数据计算。制作和替代品？

> ID：751513
> 
> 赞同：0
> 
> 时间：2009-04-15T12:40:51.057
> 
> 标签：csv, unix, makefile, workflow

在 UNIX 上，我必须通过各种命令行实用程序从以前的数据中生成数字结果。这些实用程序读取起始数据（通常，但不仅限于 csv 文件），执行计算，并写入数据（同样，通常，但不仅限于 csv 文件）。

当然，我不想冒过时的派生数据的风险，所以我需要通过实用程序链接数据依赖关系。使用电子表格可以看到一个微不足道的相似性：当您更改一个单元格时，所有其他相关的单元格也会以级联方式发生变化。但是，由于我的任务更加复杂和自动化，我不能使用电子表格。

现在，你可以有的第一个想法是使用 make，这是我已经体验过的东西。这是微不足道的，很适合这项任务。但是，您依赖于文件，因此如果您依赖于存储在数据库中的某些数据，则必须欺骗系统。我也知道 biomake，但据我所知是在 prolog 中制作的，我不想通过那条路冒险。

在我探索 makefile 路径之前，我对您的其他输入感兴趣。关于如何进行这种数据处理、比 make 更好的实用程序以及如何组织文件布局（数据和 makefile），你们中是否有人有很好的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T04:55:33.007

我想到的一些替代方案：

*   [Ant](http://ant.apache.org)对使用 Java 自定义依赖项有很好的支持。
*   [SCons](http://www.scons.org)允许您使用 Python 编写自定义依赖项代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-16T05:10:45.013

另外两个选择是

*   Jam the [boost](http://www.boost.org/)项目使用它并且
*   [QT](http://www.qtsoftware.com/products)使用的 QMake

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T22:39:26.940

[Rake](http://Rake.RubyForge.Org/)是一个面向依赖的编程的 Ruby 实现，它深受 Make 和 Ant 的启发，但使用*起来*更加简洁和好用。

最近，现场出现了一个新人，叫做[Tap](http://Tap.RubyForge.Org/)。它还允许面向依赖的编程，但使用诸如工作流之类的概念对其进行了扩展。它是由一个在生物分子研究实验室工作的生物化学博士生设计的，专门用来做你提到的事情：保持从实验中获得的科学数据是最新的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T22:05:17.623

假设可以发现数据库记录更新，那么应该可以编写一个程序，将标记文件的日期设置为最新数据记录的日期（或“现在”，如果更简单的话）相关的源表。为每个数据库或查询执行此操作将为您提供一组标记文件，这些文件可以与您现有的 CSV 源文件一起使用，以提供依赖关系树并使用标准 make 驱动整个计算。

在每次构建时更新哨兵的一个简单方法是使用构建脚本运行数据代理生成器，然后使用 make 代替 make 命令本身。

作为正常依赖检查的一部分，应该可以安排 make 自动更新标记。类似以下（未经测试）的东西应该可以解决问题：

```
all: result
clean:
        -rm table_*.txt
        -rm step*.csv
        -rm results.txt

results.txt: step2.csv
        write_report -o results.txt step2.csv

step1.csv: source.csv table_A.txt 
        do_step1 -o step1.csv source.csv

step2.csv: step1.csv table_B.txt
        do_step2 -o step2.csv

table_A.txt:
        touch_sentinel -o table_A.txt rawdata.sqlite A 

table_B.txt:
        touch_sentinel -o table_B.txt otherdata.sqlite B 
```

where`touch_sentinel`创建一个输出文件，日期为自数据库中表的最新更新以来。确定如何学习日期对读者来说是一个练习......

# sql-server - 如何以编程方式更改标识列值？

> ID：751522
> 
> 赞同：160
> 
> 时间：2009-04-15T12:43:47.930
> 
> 标签：sql-server, sql-server-2005, tsql, identity, sql-server-2005-express

我有一个`Test`带有列的表的 MS SQL 2005 数据库`ID`。`ID`是一个标识列。

我在这个表中有行，它们都有相应的 ID 自动递增值。

现在我想像这样更改此表中的每个 ID：

`ID = ID + 1`

但是当我这样做时，我得到一个错误：

> 无法更新标识列“ID”。

我试过这个：

```
 ALTER TABLE Test NOCHECK CONSTRAINT ALL 
    set identity_insert ID ON 
```

但这并不能解决问题。

我需要为此列设置身份，但我也需要不时更改值。所以我的问题是如何完成这项任务。

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2009-07-27T13:15:27.147

你需要

```
set identity_insert YourTable ON 
```

然后删除您的行并以不同的身份重新插入。

完成插入后，不要忘记关闭 identity_insert

```
set identity_insert YourTable OFF 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-06-22T10:16:44.463

`IDENTITY`列值是不可变的。

但是，可以切换表元数据以删除`IDENTITY`属性，进行更新，然后切换回来。

假设以下结构

```
CREATE TABLE Test
(
ID INT IDENTITY(1,1) PRIMARY KEY,
X VARCHAR(10)
)

INSERT INTO Test 
OUTPUT INSERTED.*
SELECT 'Foo' UNION ALL
SELECT 'Bar' UNION ALL
SELECT 'Baz' 
```

然后你可以做

```
/*Define table with same structure but no IDENTITY*/
CREATE TABLE Temp
(
ID INT PRIMARY KEY,
X VARCHAR(10)
)

/*Switch table metadata to new structure*/
ALTER TABLE Test SWITCH TO Temp;

/*Do the update*/
UPDATE Temp SET ID = ID + 1;

/*Switch table metadata back*/
ALTER TABLE Temp SWITCH TO Test;

/*ID values have been updated*/
SELECT *
FROM Test

/*Safety check in case error in preceding step*/
IF NOT EXISTS(SELECT * FROM Temp)
    DROP TABLE Temp /*Drop obsolete table*/ 
```

在 SQL Server 2012 中，可以有一个自动递增列，也可以更直接地更新`SEQUENCES`

```
CREATE SEQUENCE Seq
    AS INT
    START WITH 1
    INCREMENT BY 1

CREATE TABLE Test2
(
ID INT DEFAULT NEXT VALUE FOR Seq NOT NULL PRIMARY KEY,
X VARCHAR(10)
)

INSERT INTO Test2(X)
SELECT 'Foo' UNION ALL
SELECT 'Bar' UNION ALL
SELECT 'Baz'

UPDATE Test2 SET ID+=1 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-04-15T12:48:01.927

通过 SQL Server 2005 管理器中的 UI，更改列删除列的自动编号（身份）属性（通过右键单击选择表并选择“设计”）。

然后运行您的查询：

```
UPDATE table SET Id = Id + 1 
```

然后将自动编号属性添加回列。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-04-15T13:32:50.743

首先，IDENTITY_INSERT 的设置为 on 或 off 将无法满足您的要求（它用于插入新值，例如堵塞间隙）。

通过 GUI 执行操作只是创建一个临时表，将所有数据复制到一个没有标识字段的新表中，然后重命名该表。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-08-30T15:09:19.097

这可以使用临时表来完成。

# 这个想法

*   禁用约束（如果您的 id 被外键引用）
*   用新的 id 创建一个临时表
*   删除表格内容
*   将复制表中的数据复制回原始表
*   启用先前禁用的约束

# SQL 查询

假设您的`test`表有两个额外的列 ( `column2`and `column3`)，并且有 2 个表的外键引用`test`称为`foreign_table1`and `foreign_table2`(因为现实生活中的问题从来都不是简单的)。

```
alter table test nocheck constraint all;
alter table foreign_table1 nocheck constraint all;
alter table foreign_table2 nocheck constraint all;
set identity_insert test on;

select id + 1 as id, column2, column3 into test_copy from test v;
delete from test;
insert into test(id, column2, column3)
select id, column2, column3 from test_copy

alter table test check constraint all;
alter table foreign_table1 check constraint all;
alter table foreign_table2 check constraint all;
set identity_insert test off;
drop table test_copy; 
```

就是这样。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-04-11T20:18:55.117

DBCC CHECKIDENT ('databasename.dbo.orders',RESEED, 999) 您可以使用此命令更改任何标识列编号，也可以从您想要的每个数字开始该字段编号。例如在我的命令中我要求从1000 (999+1) 希望就够了...祝你好运

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-15T13:01:03.333

如果该列不是 PK，您始终可以在表中创建一个带有递增数字的 NEW 列，删除原始列，然后将新列更改为旧列。

好奇为什么你可能需要这样做......我曾经用身份列做的最重要的是回填数字，我最终使用 DBCC CHECKIDENT (tablename,RESEED,newnextnumber)

祝你好运！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T13:10:56.087

身份修改可能会失败，具体取决于许多因素，主要是围绕与 id 列链接的对象/关系。似乎数据库设计在这里是一个问题，因为 id 应该很少改变（我相信你有你的理由并且正在级联更改）。如果您确实需要不时更改 id，我建议您创建一个新的虚拟 id 列，该列不是您可以自己管理并从当前值生成的主键/自动编号。或者，如果您在允许身份插入时遇到问题，上面的 Chrisotphers 想法将是我的另一个建议。

祝你好运

PS它没有失败，因为它运行的顺序是试图将列表中的值更新为id列表中已经存在的项目？抓住稻草，也许加上行数+1，然后如果可行，减去行数：-S

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-27T10:18:12.513

如果您需要偶尔更改 ID，最好不要使用标识列。过去，我们使用“计数器”表手动实现自动编号字段，该表跟踪每个表的下一个 ID。IIRC 我们这样做是因为身份列导致 SQL2000 中的数据库损坏，但能够更改 ID 有时对测试很有用。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-02-05T21:01:02.930

您可以插入具有修改值的新行，然后删除旧行。以下示例将 ID 更改为与外键*PersonId相同*

```
SET IDENTITY_INSERT [PersonApiLogin] ON

INSERT INTO [PersonApiLogin](
       [Id]
      ,[PersonId]
      ,[ApiId]
      ,[Hash]
      ,[Password]
      ,[SoftwareKey]
      ,[LoggedIn]
      ,[LastAccess])
SELECT [PersonId]
      ,[PersonId]
      ,[ApiId]
      ,[Hash]
      ,[Password]
      ,[SoftwareKey]
      ,[LoggedIn]
      ,[LastAccess]
FROM [db304].[dbo].[PersonApiLogin]
GO

DELETE FROM [PersonApiLogin]
WHERE [PersonId] <> ID
GO
SET IDENTITY_INSERT [PersonApiLogin] OFF
GO 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-08-08T13:34:46.127

首先保存所有 ID 并以编程方式将它们更改为您不需要的值，然后将它们从数据库中删除，然后使用类似的方法再次插入它们：

```
use [Name.Database]
go
set identity_insert [Test] ON
insert into [dbo].[Test]
           ([Id])
     VALUES
           (2)
set identity_insert [Test] OFF 
```

对于批量插入使用：

```
use [Name.Database]
go
set identity_insert [Test] ON
BULK INSERT [Test]
FROM 'C:\Users\Oscar\file.csv'
WITH (FIELDTERMINATOR = ';',
      ROWTERMINATOR = '\n',
      KEEPIDENTITY)
set identity_insert [Test] OFF 
```

来自 file.csv 的样本数据：

```
2;
3;
4;
5;
6; 
```

如果您不设置`identity_insert`为关闭，您将收到以下错误：

> 当 IDENTITY_INSERT 设置为 OFF 时，无法在表“Test”中插入标识列的显式值。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-17T23:41:06.977

我看到了一篇很好的文章，它在最后一刻帮助了我。我试图在一个有标识列的表中插入几行，但做错了，不得不删除回来。一旦我删除了这些行，我的身份列就会改变。我试图找到一种方法来更新插入的列，但是 - 没有运气。所以，在谷歌搜索时发现了一个链接..

1.  删除了错误插入的列
2.  使用身份打开/关闭强制插入（如下所述）

[http://beyondrelational.com/modules/2/blogs/28/posts/10337/sql-server-how-do-i-insert-an-explicit-value-into-an-identity-column-how-do- i-update-the-value-of-an.aspx](http://beyondrelational.com/modules/2/blogs/28/posts/10337/sql-server-how-do-i-insert-an-explicit-value-into-an-identity-column-how-do-i-update-the-value-of-an.aspx)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-27T10:01:32.153

非常好的问题，首先我们需要对**特定**表进行 IDENTITY_INSERT，然后运行插入查询（必须指定列名）。

**注意：**编辑标识列后，不要忘记**关闭**IDENTITY_INSERT。如果您没有完成，您将无法编辑任何其他表的标识列。

```
SET IDENTITY_INSERT Emp_tb_gb_Menu ON
     INSERT Emp_tb_gb_Menu(MenuID) VALUES (68)
SET IDENTITY_INSERT Emp_tb_gb_Menu OFF 
```

[http://allinworld99.blogspot.com/2016/07/how-to-edit-identity-field-in-sql.html](http://allinworld99.blogspot.com/2016/07/how-to-edit-identity-field-in-sql.html)

# pdf - 如何从终端中的多个 png 文件创建一个文件？

> ID：751525
> 
> 赞同：0
> 
> 时间：2009-04-15T12:44:49.643
> 
> 标签：pdf, png

**数据示例**

```
06-7-1-B.png
06-7-2-B.png
07-3-1-B.png
07-3-2-B.png
06-6-1-P.png
06-6-2-P.png
07-12-1-P.png
07-12-2-P.png
07-6-1-P.png
07-6-2-P.png
07-7-1-P.png
07-7-2-P.png
08-2-1-P.png
08-2-2-P.png
08-2-3-P.png
08-7-1-P.png
08-7-2-P.png
08-7-3-P.png
08-7-4-P.png
08-9-1-P.png
08-9-2-P.png 
```

我想按如下方式将文件连接在一起。例如，文件 06-7-1-B.png 和 06-7-2.png 应该连接在一起并重命名为 06-7-B.png。

**如何从终端中的许多 png 文件创建一个 png 或 pdf 文件？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T12:48:52.037

您需要更清楚“连接”两个图像的含义，这并不明显。您的意思可以是任何东西，从创建蒙太奇，即将图像并排“粘合”在一起，到图像堆叠在一起的某种“组合”，也许使用 alpha 通道透明度让较低层闪耀。

对于其中许多，您应该将[ImageMagick](http://www.imagemagick.org/script/index.php)视为从命令行执行此操作的一种方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T12:54:57.200

试试[ImageMagick http://www.imagemagick.org](http://www.imagemagick.org)（如 unwind 所建议）：

蒙太奇 +frame +shadow +label -geometry +0+0 -tile 2x1 06-7-1-B.png 06-7-2.png 06-7-B.png

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T12:50:41.983

您可以使用 Netpbm 工具执行此操作。Netpbm 是旨在从命令行（或脚本）使用的小型快速工具的集合。有很多工具，每一个都有自己的用途，它们可以通过管道链接在一起来完成复杂的操作。请参阅[文档](http://netpbm.sourceforge.net/doc/)。

还有 ImageMagick，但在大多数情况下，Netpbm 会运行得更快并且使用更少的内存。如果您有较小的图像，这将不是问题。

# compiler-construction - 在 JDK 1.6 编译器中，“-source 1.6”启用了什么（如果有的话）？

> ID：751532
> 
> 赞同：2
> 
> 时间：2009-04-15T12:47:41.400
> 
> 标签：compiler-construction, java

我知道使用 -target 1.6 更改了类文件格式（使用 -source 1.6 时需要这样做）。但是源选项是否专门更改了任何内容或启用了任何新功能？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T12:52:12.730

从[javac 文档](http://java.sun.com/javase/6/docs/technotes/tools/windows/javac.html)：

> 1.6 - 这是默认值。Java SE 6 中没有引入语言更改。但是，源文件中的编码错误现在报告为错误，而不是像以前一样的警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T12:53:20.917

来自[Sun 的 javac 文档](http://java.sun.com/javase/6/docs/technotes/tools/windows/javac.html)：

> Java SE 6 中没有引入语言更改。但是，源文件中的编码错误现在报告为错误，而不是像以前一样的警告。

# ruby-on-rails - 在 Rails 中直接“放置”到 Apache 日志

> ID：751542
> 
> 赞同：1
> 
> 时间：2009-04-15T12:51:08.427
> 
> 标签：ruby-on-rails, apache, passenger

将调用`puts`写入 Apache 日志文件的配置设置是什么？（使用乘客在 Apache 上运行 Rails）

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T13:37:03.543

为什么不直接记录到 Rails 日志？您可以使用`Rails.logger`写入应用程序日志目录中的文件。

例子：

```
Rails.logger.warn "Login failed for user #{@user.login}" 
```

Rails 内置了不同的日志记录级别（调试、信息、警告、错误和致命），这些可以在您的环境文件中指定。因此，要将生产模式下的日志记录设置为调试级别：

```
config.log_level = :debug 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T10:12:34.443

我认为您可以“重新打开” STDOUT 以指向 RAILS_DEFAULT_LOGGER 指向的任何内容（在这种情况下是您的乘客日志）。

但我不确定这是一个好主意，原因如下：

日志用于您在应用程序的正常功能期间想知道的事情，并且根据您的环境 logger.debug() 调用打印到 development.log 而不是 production.log 进行不同的过滤，logger.error() 符合逻辑，到处。

STDOUT (p, puts, printf, pretty_print...) 是完美的 por 脚本/控制台实验，对于调试器调用，请参阅：[post about ruby](http://www.themomorohoax.com/2009/02/09/use-debugger "邮政") ​​-debug，了解如何使用“puts”或“p”来观看执行过程中变量的值。

我希望这可以帮助你。

# python - 使用 Python 解析 shell 文件输出

> ID：751557
> 
> 赞同：4
> 
> 时间：2009-04-15T12:55:18.993
> 
> 标签：python

我有一个包含数据的文件。该文件是从 shell 脚本文件生成的输出：

```
|a                     |869         |
|b                     |835         |
|c                     |0           |
|d                     |0           |
|e                     |34          |
|f                     |3337 
```

我怎样才能从中得到a = 869？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T13:04:10.923

你可以这样做：

```
output = {}
for line in open("myfile"):
    parts = line.split('|')
    output[parts[1].strip()] = parts[2].strip()

print output['a'] // prints 869
print output['f'] // prints 3337 
```

或者，按照 Eugene Morozov 的建议，使用[csv](http://docs.python.org/library/csv.html)模块：

```
import csv
output = {}
reader = csv.reader(open("C:/output.txt"), delimiter='|')
for line in reader:
    output[line[1].strip()] = line[2].strip()

print output['a'] // prints 869
print output['f'] // prints 3337 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T13:09:13.953

```
lines =  file("test.txt").readlines()
d = dict([[i.strip() for i in l.split("|")[1:3]] for l in lines if l.strip()]) 
```

例如：

```
>>> lines =  file("test.txt").readlines()
>>> d = dict([[i.strip() for i in l.split("|")[1:3]] for l in lines if l.strip()])
>>> d['a']
'869' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T13:02:19.740

您还可以将[csv](http://docs.python.org/library/csv.html)模块与 delimiter 一起使用`|`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T13:13:08.107

也许不是最 Pythonic 的方式，但如果您的 shell 输出存储在 f.txt 中并且您正在寻找要处理的每一行，这应该可以工作：

```
h = open("f.txt", "rt")
inp = h.readline()
while inp:
  flds = inp.split('|')
  str = flds[1].strip() + " = " + flds[2].strip()
  print str
  inp = h.readline() 
```

# c# - C# Powershell 互操作

> ID：751561
> 
> 赞同：1
> 
> 时间：2009-04-15T12:56:19.647
> 
> 标签：c#, powershell, interop, active-directory, exchange-server

系统管理员正在编写一些常见的内务管理 Power Shell 脚本。主要用于 AD 管理（更新交换详细信息、在安全组周围移动人员等）

我想使用 C# 中的这些脚本（我打算将其编写为库，供网站使用）。

我看过这篇[代码项目文章](http://www.codeproject.com/KB/cs/HowToRunPowerShell.aspx)，它看起来很有趣，也是一个很好的起点。

有没有人有任何 Power Shell 互操作的经验？在我一头扎进尖峰之前，谁能想到任何主要的陷阱？

**额外的信息：**

我很欣赏存在后勤方面的挑战，尤其是在 CI 和版本控制方面。

该计划最初是使用目录服务，通过 Web API 和 CmdLets 公开服务。不幸的是，我们在使用目录服务时遇到了困难（例如，大集合的截断结果）。

同时，我认为我应该使用系统管理员的脚本进行调查，而不是使用不一致的组合。为什么要重新发明轮子？

我已经编写了我的域模型。我打算实现存储库模式，这样我就可以抽象出 AD / Exchange 集成，以便将来实现不同的实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T16:28:25.347

如果脚本依赖于系统或用户配置文件，那么您需要首先将配置文件显式点源到您的运行空间中。

更高级别的控制（例如，从一个命令到另一个命令的会话，...访问调试输出）需要更高级/低级/复杂的工作。

除此之外，一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T13:28:40.567

对于从已编译程序运行脚本的常见问题，我认为这种方法没有很多陷阱。我发现最大的问题往往是

1.  防止人们移动脚本
2.  确保人们不会在脚本中添加未反映在调用程序中的隐藏依赖项。

但我确实认为你应该考虑另一种发展模式。与其让程序引用脚本，不如将所有逻辑添加到已编译的库中。这可以很容易地链接到程序中并通过 CmdLet 暴露给 PowerShell。我发现这是在程序中的脚本之间维护共享代码的一种更简单的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:17:24.443

在过去的几个月里，我一直在 C# 应用程序中运行 PowerShell 代码，它运行良好，你可以用它做一些非常有趣的事情。这就是说 JaredPar 提到在应用程序外部的脚本文件中包含 PowerShell 脚本可能会很痛苦。我将所有的 PowerShell 代码放在一个库中，并将其发送到需要的地方，并且运行良好。

# sitefinity - Sitefinity 自定义模块

> ID：751562
> 
> 赞同：2
> 
> 时间：2009-04-15T12:56:31.503
> 
> 标签：sitefinity

我有一些用于从这里创建自定义模块的示例代码：

[自定义 Sitefinity 模块示例](http://blogs.sitefinity.com/Ivan/Posts/09-01-25/Sitefinity_3_6_beta_-_sample_bare_bones_module_on_the_new_backend_architecture.aspx)

在 BooksListView.ascx 上显示“在此处显示图书列表”。但我不确定如何做到这一点。任何人都可以帮助甚至更好地拥有一个完整的示例模块。

我正在使用 Sitefinity 3.6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-20T17:32:01.203

Sitefinity[站点内模块创建网络研讨会简介](http://www.sitefinitywatch.com/blog/09-04-20/Introduction_to_Sitefinity_Intra-Site_Module_Creation.aspx)最近在线发布。

此外，在[Sitefinity 开发人员博客](http://blogs.sitefinity.com/)上发布了几篇关于此主题的博客文章和示例。

# python - pylab 中的顶部和底部轴（例如，使用不同的单位）（或左右）

> ID：751567
> 
> 赞同：5
> 
> 时间：2009-04-15T12:57:27.913
> 
> 标签：python, matplotlib, plot, axes

我正在尝试使用 pylab/matplotlib 绘制绘图，并且 x 轴有两组不同的单位。所以我希望情节有两个不同刻度的轴，一个在顶部，一个在底部。（例如，一个有英里，一个有公里左右。）

如下图所示（但我想要多个 X 轴，但这并不重要。）

![带 JpGraph 的多轴](https://i.stack.imgur.com/gCIBN.png)

有人知道pylab是否可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-25T20:52:38.357

这可能有点晚了，但看看这样的事情是否会有所帮助：

[http://matplotlib.sourceforge.net/examples/axes_grid/simple_axisline4.html](http://matplotlib.sourceforge.net/examples/axes_grid/simple_axisline4.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-29T12:33:12.057

如示例图片所示，在“原始”框架旁边添加多个轴可以通过添加附加轴`twinx`并配置其`spines`属性来实现。

我认为这看起来与示例图片非常相似：

[![图1](https://i.stack.imgur.com/onzce.png)](https://i.stack.imgur.com/onzce.png)

```
import matplotlib.pyplot as plt
import numpy as np

# Set font family
plt.rcParams["font.family"] = "monospace"

# Get figure, axis and additional axes
fig, ax1 = plt.subplots()
ax2 = ax1.twinx()
ax3 = ax1.twinx()
ax4 = ax1.twinx()

# Make space on the right for the additional axes
fig.subplots_adjust(right=0.6)

# Move additional axes to free space on the right
ax3.spines["right"].set_position(("axes", 1.2))
ax4.spines["right"].set_position(("axes", 1.4))

# Set axes limits
ax1.set_xlim(0, 7)
ax1.set_ylim(0, 10)
ax2.set_ylim(15, 55)
ax3.set_ylim(200, 600)
ax4.set_ylim(500, 750)

# Add some random example lines
line1, = ax1.plot(np.random.randint(*ax1.get_ylim(), 8), color="black")
line2, = ax2.plot(np.random.randint(*ax2.get_ylim(), 8), color="green")
line3, = ax3.plot(np.random.randint(*ax3.get_ylim(), 8), color="red")
line4, = ax4.plot(np.random.randint(*ax4.get_ylim(), 8), color="blue")

# Set axes colors
ax1.spines["left"].set_color(line1.get_color())
ax2.spines["right"].set_color(line2.get_color())
ax3.spines["right"].set_color(line3.get_color())
ax4.spines["right"].set_color(line4.get_color())

# Set up ticks and grid lines
ax1.minorticks_on()
ax2.minorticks_on()
ax3.minorticks_on()
ax4.minorticks_on()
ax1.tick_params(direction="in", which="both", colors=line1.get_color())
ax2.tick_params(direction="in", which="both", colors=line2.get_color())
ax3.tick_params(direction="in", which="both", colors=line3.get_color())
ax4.tick_params(direction="in", which="both", colors=line4.get_color())
ax1.grid(axis='y', which='major')

plt.show() 
```

# gwt - GWT 从 1.5 升级到 1.6

> ID：751568
> 
> 赞同：7
> 
> 时间：2009-04-15T12:57:30.080
> 
> 标签：gwt

有没有人将应用程序从 GWT 1.5 升级到 GWT 1.6？我想知道你是否有一个你喜欢的策略，或者你是否需要一个策略。

显然，我可以阅读升级文档。只是想知道是否有人完成了升级并遇到了任何问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T11:47:48.457

我继续并开始转换。我还没有完成，但如果其他人正在考虑从 1.5 升级到 1.6，我会继续用我目前所看到的来回答这个问题。

*   如果您使用 Eclipse 的 cypal 插件，那么它目前不支持 GWT 1.6。通过删除插件 jar 来卸载它并重新启动 eclipse。安装 Google Eclipse 插件作为替代（但请参阅下面的问题）。该插件不会将您现有的项目识别为 GWT 项目。解决此问题的一种简单方法是使用插件创建一个新项目，然后将该项目中的 buildSpec 和 natures 部分复制到您的实际项目中。现在插件应该能识别你的项目了。
*   升级说明说要创建一个新的 web.xml。相反，使用你已经拥有的，然后复制它。无需更改。
*   将 google app engine SDK 和 GWT DSK 添加到项目构建路径
*   GWTCompiler 更改为 Compiler。升级文档没有讨论您需要在此处进行的更改，但您至少需要将 -out 选项替换为 -war。
*   对于许多人（所有人？），编译器将无法工作，并且会因堆栈溢出错误而失败。您可以使用命令行工具修复此问题，但我还没有找到使用插件修复它的方法。要从命令行解决此问题，您需要添加堆栈参数以增加堆栈的大小。我用 ant 构建，所以我在 build.xml 中添加了以下行：

    <jvmarg value="-Xss64M" />

随着我了解更多，我会更新这个。

2009 年 5 月 3 日更新：

升级完成。不确定我是否喜欢 1.5。Eclipse 与新的文件布局并不完全一致。也就是说，它现在没有将 war 目录识别为 Web 内容的根目录。可能在某个地方有这个设置。

补充笔记：

*   在您的代码中，删除对 InetAddress 的引用（用于生成 GUID 以在我的应用程序中注册）。这可能是因为我的 GUID 代码需要移动到不同的包，不确定。
*   将 WEB-INF 中的 appengine-web.xml 从 temp 项目复制到 war/WEB-INF
*   eclipse 插件用一些废话来编译休眠对象，在我的所有表中添加了一个 jdoDetachedState 列。呸！

对于最后一项，代码没有被 ant 构建检测，因此生产部署不受此错误的影响。它只是 Eclipse 生成的代码，我明确将其排除在生产战之外。

以下是部署它的网站的免费插件，所以如果这些事情惹恼了你，请不要阅读它： [https ://penwag.com/](https://penwag.com/)

2009 年 5 月 9 日更新

*   我的电子邮件 IT 不再工作 - App Engine SDK 会干扰。
*   我的 IDE (Eclipse) 与新布局不能很好地共存，因此它无法识别 war/WEB-INF/lib jar 应该自动放入路径中。

2009 年 6 月 2 日更新

*   我重新进行了升级，采用了不同的方法： [从 GWT 1.5 升级到 GWT 1.6 - 再次](http://penwag.blogspot.com/2009/06/upgrade-from-gwt-15-to-gwt-16-again_02.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:44:30.743

[GWT 升级页面](http://code.google.com/webtoolkit/doc/1.6/ReleaseNotes_1_6.html#Upgrading)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-29T14:15:01.770

We managed to use the Xss option with Cypal: go to Preferenes, Cypal Studio, try with Default VM Option: -Xmx1024M -Xss1024k

HTH Vincenzo Caselli [http://www.rcp-vision.com](http://www.rcp-vision.com)

# date - 在 J2ME 中，如何判断是否启用了夏令时？

> ID：751569
> 
> 赞同：2
> 
> 时间：2009-04-15T12:57:52.607
> 
> 标签：date, java-me, dst

如何获得夏令时是否开启？（因为如果它打开，`Calendar.HOUR_OF_DAY`则（例如）11 而不是 12。）或者我应该使用另一种方式来获取一天中的时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:42:18.133

这是[TimeZone 的 J2ME 文档](http://java.sun.com/javame/reference/apis/jsr118/java/util/TimeZone.html)。你想看看 TimeZone.getOffset() 我相信，为了完成你所描述的。

# c# - 重载“base”构造函数还是“this”构造函数？

> ID：751575
> 
> 赞同：7
> 
> 时间：2009-04-15T12:59:37.593
> 
> 标签：c#, .net, overloading, constructor-overloading

我有几个从简化派生的类型，`Base`如下所示。

我不确定`this`在重载构造函数时是使用基类的构造函数还是构造函数。

`ConcreteA`纯粹使用`base`构造函数重载构造函数，而
`ConcreteB`重载使用`this`前两个重载。

重载构造函数的更好方法是什么？

```
public abstract class Base
{
    public string Name { get; set; }
    public int? Age { get; set; }

    protected Base() : this(string.Empty) {}
    protected Base(string name) : this(name, null) {}
    protected Base(string name, int? age)
    {
        Name = name;
        Age = age;
    }
}

public class ConcreteA : Base
{
    public ConcreteA(){}
    public ConcreteA(string name) : base(name) {}
    public ConcreteA(string name, int? age) : base(name, age)
    {
    }
}

public class ConcreteB : Base
{
    public ConcreteB() : this(string.Empty, null){}
    public ConcreteB(string name): this(name, null){}
    public ConcreteB(string name, int? age) : base(name, age)
    {
    }
} 
```

**[编辑]** 看起来伊恩·奎格利在他的[回答](https://stackoverflow.com/questions/751575/overload-base-contructor-or-this-contructor/751590#751590)中所建议的似乎是有道理的。如果我要进行初始化验证器的调用，`ConcreteA(string)`则在以下情况下将永远不会初始化验证器。

```
public class ConcreteA : Base
{
    public ConcreteA(){}
    public ConcreteA(string name) : base(name) {}
    public ConcreteA(string name, int? age) : base(name, age)
    {
        InitializeValidators();
    }
    private void InitializeValidators() {}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T13:03:21.547

**This**. Because if you ever place code in ConcreteB(string, int?) then you want the string only constructor to call it.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T13:03:54.480

In general, I'd call "this" rather than "base". You'll probably reuse more code that way, if you expand your classes later on.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T13:03:56.960

可以混搭；最终，当您使用`this(...)`构造函数时，它*最终*会到达首先调用的 ctor `base(...)`。在需要时重用逻辑是有意义的。

您可以安排它，以便所有构造函数都称为一个公共（可能是私有）`this(...)`构造函数，它是唯一一个调用`base(...)`- 但这取决于 a: 这样做是否有用，以及 b: 是否有一个`base(...)`那会让你的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T13:03:18.960

In your case from what you have provided it doesn't matter. You really only want to use `this` when you have a constructor in your current class that is not part of your base class, or if there is some code in the current class constructor that you want to execute that isn't contained in the base class.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T13:03:54.900

为了降低代码路径的复杂度，我通常会尽量只`base()`调用一个构造函数（`ConcreteB`案例）。这样你就知道基类的初始化总是以同样的方式发生。

但是，根据您覆盖的类，这可能是不可能的或增加了不必要的复杂性。这适用于特殊的构造函数模式，例如实现[ISerializable](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.iserializable.aspx)时的模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T13:23:55.167

再次问自己为什么要重载 Base 类中的构造函数？这个就够了：

```
protected Base() 
```

子类也是如此，除非您在实例化时需要任一字段具有特定值，在您的示例中并非如此，因为您已经拥有默认构造函数。

还要记住，任何构造函数都应该将对象的实例置于正确的状态。

# asp.net - Asp.Net LinkBut ton Onclick = method(container.dataitem)，需要语法帮助

> ID：751577
> 
> 赞同：1
> 
> 时间：2009-04-15T13:00:29.137
> 
> 标签：asp.net, methods, containers, dataitem

我有一个链接按钮，我想在后面的代码中调用一个方法。该方法需要一个参数，我需要将其粘贴在 container.dataitem 中。我知道 container.dataitem 语法是正确的，因为我在其他控件中使用它。我不知道如何使用它作为方法的参数。单击按钮后，应使用 container.dataitem 调用该方法。该方法称为'AddFriend（字符串用户名）' 下面是代码。谢谢！

```
<asp:LinkButton ID="lbAddFriend" runat="server" OnClick='<%# "AddFriend(" +((System.Data.DataRowView)Container.DataItem)["UserName"]+ ")" %>' Text="AddFriend"></asp:LinkButton></td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T13:06:03.367

您需要使用 ButtonField 并处理 RowCommand 中的单击。检查[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)

```
 <asp:buttonfield buttontype="Link" 
                  commandname="Add" 
                  text="Add"/> 
```

在后面的代码中......

```
 void ContactsGridView_RowCommand(Object sender, GridViewCommandEventArgs e)
  {
    if(e.CommandName=="Add")
    {
         AddFriend(DataBinder.Eval(Container.DataItem, "Price""UserName"));
    }
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:38:56.750

我认为同样的事情也适用于数据列表，但我一直在后面的代码中使用它作为中继器。Mayby 使用 DataListItemEventArgs 和 DataListCommandEventArgs 代替中继器。

```
protected void rptUserInfo_Data(object sender, RepeaterItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        UserInfo oUserInfo = e.Item.DataItem as UserInfo;

        LinkButton hlUser = e.Item.FindControl("hlUser") as LinkButton;
        hlUser.Text = oUserInfo.Name;
        hlUser.CommandArgument = oUserInfo.UserID + ";" + oUserInfo.uName;
        hlUser.CommandName = "User";
    }
}
public void UserArtItem_Command(Object sende, RepeaterCommandEventArgs e)
{
    if (e.CommandName == "User")
    {
        string command = e.CommandArgument.ToString();
        string[] split = command.Split(new Char[] { ';' });

        Session["ArtUserId"] = split[0];
        Session["ArtUserName"] = split[1];
        Response.Redirect("~/Author/" + split[1]);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T15:47:27.177

也许这个？

```
<asp:LinkButton ID="lbAddFriend" runat="server"
 Text="Add Friend" OnCommand="AddFriend"
 CommandArgument='<%# Eval("UserName").ToString() %>' /> 
```

然后在代码中：

```
Protected Sub AddFriend(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.CommandEventArgs)
    Dim UserName As String = e.CommandArgument
    'Rest of code
End Sub 
```

# sql - 关于向1:m关系的表部分插入数据的问题

> ID：751582
> 
> 赞同：0
> 
> 时间：2009-04-15T13:01:03.487
> 
> 标签：sql, database-design

将记录插入到与另一个表具有 1:m 关系的数据库表时，确保相关表已更新（插入）新记录不是最佳做法吗？如果仅更新其中一个相关表，会有什么后果吗？

另外，如果我更新关系 m 侧的表（例如，汽车和车轮的关系，其中一辆车可以有多个车轮但一个车轮只能属于一辆车），我是否应该始终将外键插入为显式参数？例如，如果另一个相关表的 PK 系统为 1、2、3、4、5 并且以独特的方式上升，我是否应该通过存储过程将外键值作为值插入？

编辑：这听起来很不合时宜，但不幸的是，我只从自我实践中学习/学习了数据库设计和 Sql Server（没有正式培训）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:11:49.127

让我们用你的例子..

```
car:
    car_id
    name

wheel:
    wheel_id
    car_id 
```

`car`如果您的第一个问题是在向表中插入记录时是否应该确保表中存在对应的行`wheel`，那么可以！实际上，如果您的 RDBMS 使用外键正确设置，那么您将无法在`wheel`没有父行的情况下将行插入到`car`.

我认为这也可以解决您的第二个问题。如果没有，你能详细说明吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:24:16.037

当您有一对多关系时，您必须先将记录插入到父表中。在插入父表时，您可能需要也可能不需要插入子表。这完全取决于您的设计以及插入初始记录时可用的信息。例如，客户和订单具有一对多的关系。但是客户可能会在他或她实际购买任何东西之前添加，因此不会有订单。或者一个新客户可能正在尝试购买某些东西，并且需要存储他/她的客户信息和他/她的订单。您应该在设置数据库结构时设置主键/外键关系。这将确保您永远不会在没有关联客户的情况下下订单。在 Order 表中，您将为 Customer 表中的 id 字段添加一列。当您插入记录时，该值将像其他信息一样成为插入的一部分。

如果您更新父表或子表，则不需要更新另一个表，除非您更改具有 PK.FK 关系的字段。最好不要更改此值（主键应该几乎不需要更改。如果您使用诸如名称之类的东西作为主键，则需要重新考虑您的设计。）

# c# - 三星WiTu（i900/Omnia）手机方案

> ID：751584
> 
> 赞同：0
> 
> 时间：2009-04-15T13:01:15.237
> 
> 标签：c#, compact-framework, mobile

我想编写一个简单的 C# 程序，将在来电时激活以在电话屏幕上显示文本。只是一个由来电激活的简单 C# 程序。有什么想法可以开始吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T13:06:23.990

最好的办法是在 Modaco 或 xda-forums 上提问。他们在那里有一个非常大的 Windows Mobile 社区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-30T07:32:06.640

看看这个：

[http://www.developer.com/ws/pc/article.php/3547381/Your-Windows-Mobile-50-Applications-Can-Monitor-Clients-and-Respond-to-Change.htm](http://www.developer.com/ws/pc/article.php/3547381/Your-Windows-Mobile-50-Applications-Can-Monitor-Clients-and-Respond-to-Change.htm)

使用系统状态和通知代理 API，您可以注册一个在状态更改时将触发的事件，您可以监控的状态之一是来电。

# java - Java：遍历树到树

> ID：751585
> 
> 赞同：0
> 
> 时间：2009-04-15T13:01:18.073
> 
> 标签：java, xml, parsing

解决此问题的最有效方法是什么：我遍历了一个 XML 文件并创建了以下一组链接（字符串）列表：

*   a > b > c
*   a > b > d
*   a > f > [i]

现在我正在尝试将 XML 重建为其原始结构：

```
<a>
 <b>
  <c/><d/>
 </b>
 <f>i</f>
</a> 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T13:09:36.713

您可能不想为此使用列表作为数据结构。您最好创建一个`Node`类型或类似的东西，它可以包含文本和子节点，以便您可以将数据存储在节点的树/层次结构中。像这样简单的事情应该可以解决问题：

```
public class Node {
    private String text;
    private List<Node> children = new ArrayList<Node>();

    public String getText() {
        return text;
    }

    public void setText(String text) {
        this.text = text;
    }

    public List<Node> getChildren() {
        return children;
    }

} 
```

`Node`然后，在您读入文件时创建这些 s 的树并使用相同的结构将其写回应该是微不足道的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:10:21.063

您需要存储有关原始 XML 结构的更多信息。例如，这 3 个列表没有关于子节点顺序的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T13:11:06.817

在第一步中，我会使用树数据结构来保存元素（就像 matt 解释的一样[）](https://stackoverflow.com/questions/751585/java-traversed-tree-to-tree/751616#751616)。

你的表示对我来说不清楚，你如何区分标签和元素？由于`i`与标签保存在相同的列表中，但不是标签。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-25T08:10:49.567

Set 不保留文档顺序。`pre/post/size/level/kind`您希望以基于范围的表格`ORDPATH`编码`parent/leftsibl/rightsibl/firstchild/node`（

# visual-studio-2005 - Visual Studio 删除“Run On”数据库引用

> ID：751588
> 
> 赞同：0
> 
> 时间：2009-04-15T13:02:44.390
> 
> 标签：visual-studio-2005, usability

在 Visual Studio 中，当我创建一个包含存储过程的新脚本时，我通常在我们的数据库上运行它的方法是右键单击并选择“Run On”。在数据库引用窗口中，我添加/选择我需要的内容并运行。我们刚刚在我们的开发环境中切换了数据库服务器，这里的一些引用不再有效。有谁知道如何从这个列表中删除它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T13:05:57.737

在项目中的引用下，您将看到旧的数据库引用。从那里删除它们，您还需要从服务器资源管理器中删除它们。

# c# - 可以在 OSX .app 包中包含 Mono 运行时吗？

> ID：751599
> 
> 赞同：13
> 
> 时间：2009-04-15T13:05:12.277
> 
> 标签：c#, macos, mono

我正在寻找一个需要在 Windows 和 OSX 上运行的应用程序。由于我已经非常熟悉 C#/.NET，我想我会看看使用 Mono。但我也希望它非常易于安装，并且不希望用户必须单独安装 Mono 包。是否可以创建一个包含所有内容的 OS X .app 包？也就是说，我的应用程序、资源和完整的 Mono 运行时？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T15:21:47.957

是的，你可以这样做。选择一个应用程序，任何应用程序，然后显示包内容。稍微探索一下，您会发现里面有一个 Contents/MacOS 目录。它将包含一个设置了执行位的文件。这可以是机器代码或任何以`#!`一行开头的旧脚本。你需要做的就是用一个骨架应用程序复制目录结构，将你的 Mono 运行时推到某个地方的 Resources 目录中，然后编写一个初始化所有内容的 bash 脚本。可能有自动实用程序可以在某个地方执行此操作，但手动执行此操作非常容易。

我建议使用你最喜欢的构建工具来自动化这个过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T20:45:58.487

有可能通过相当多的黑客攻击和一些工具链的乐趣来编译一个静态针对 Mac OS 平台的 .NET 应用程序，而无需使用它部署单声道。查看这个网站，了解如何在某些 iPhone 应用程序中静态使用 Mono。

[http://arstechnica.com/open-source/news/2009/01/open-source-mono-framework-brings-c-to-iphone-and-wii.ars](http://arstechnica.com/open-source/news/2009/01/open-source-mono-framework-brings-c-to-iphone-and-wii.ars)

另一个很棒的资源是 irc.gnome.org 或 irc.gimp.net 上的 #mono 频道 ( [http://mono-project.com/IRC](http://mono-project.com/IRC) )

# apache - URL 重写/正则表达式调试

> ID：751606
> 
> 赞同：3
> 
> 时间：2009-04-15T13:07:00.043
> 
> 标签：apache, .htaccess, mod-rewrite, url-rewriting

我需要对此有一套新的看法。我很难发现问题。

在文件夹 XI 中有一个 .htaccess 文件，其中包含以下两行：

```
RewriteEngine on
RewriteRule ^([A-Za-z0-9\.-]+)/?$ item-display.php?bibid=$1 [NC,L] 
```

我的解释是，该目录中的任何内容都将被重定向到项目显示页面。问题是在 item-display 页面上，回显 bibid 输出“display-item”的值。所以不知何故我从： [http://localhost/test/cat/item/14056a 重定向](http://localhost/test/cat/item/14056a) 到：[http://localhost/test/cat/item/item-display.php?bibid=item-display](http://localhost/test/cat/item/item-display.php?bibid=item-display)

有任何想法吗？

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T14:08:58.443

您必须排除要重定向到的文件，因为该文件也与模式匹配：

```
RewriteCond %{REQUEST_URI} !/item-display\.php$
RewriteRule ^([A-Za-z0-9\.-]+)/?$ item-display.php?bibid=$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T13:10:17.647

试试这个

```
RewriteEngine on
RewritePath /test/cat/item
RewriteRule ^([A-Za-z0-9\.-]+)/?$ item-display.php?bibid=$1 [L] 
```

我认为问题在于它正在查看整个 URL 而不仅仅是最后一个项目 ID 部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:03:15.820

该请求是子处理的，因此它提取了我假设的重写 URL 的文件名部分。尝试添加 NS 标志。

# hibernate - Hibernate 的复合键

> ID：751611
> 
> 赞同：9
> 
> 时间：2009-04-15T13:08:48.167
> 
> 标签：hibernate

为了生成下一个 SQL 代码：

```
create table users (
    user_name varchar(15) not null primary key, 
    user_pass varchar(15) not null);

create table user_roles(
    username varchar(15) not null,
    role_name varchar(15) not null, 
    primary key(usernmae, rolename)
); 
```

您可以使用以下代码：

```
 <?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
    <class name="databaselayer.users.UserDB" table="users">
        <id name="username" type="string" column="user_name">
                <meta attribute="scope-set">public</meta>      
        </id>    
        <property name="password" type="string" column="user_pass"  not-null="true"/>
        <set name="roles" cascade="save-update" inverse="true">
                <key column="user_name"/>
                <one-to-many class="databaselayer.users.RoleDB"/>
        </set>                       
    </class>
   <class name="databaselayer.users.RoleDB" table="user_roles">
        <composite-id>
            <key-many-to-one name="username" class="databaselayer.users.UserDB" column="user_name"/>
            <key-property name="role" type="string" column="role_name"/>
        </composite-id>             
    </class>          
</hibernate-mapping> 
```

您可能需要在类路径中包含您的类以及 hbm 映射文件。
接下来我发布我的 Ant 架构目标：
**注意** ${basedir}/build/WEB-INF/classes 包含 *.class 和 *.hbm.xml 文件。

```
<target name="schema" description="Generate DB schema from the O/R mapping files">
    <hibernatetool destdir="${basedir}">            
        <classpath path="${basedir}/build/WEB-INF/classes">
            <fileset dir="${basedir}/build/WEB-INF/classes">
            <include name="**/*"/>
        </fileset>              
        </classpath>
        <configuration configurationfile="${basedir}/hibernate.cfg.xml"/>
        <hbm2ddl 
            drop="true" 
            create="true"
            export="true"
            outputfilename="libamo2-ddl.sql"
            delimiter=";"
            format="true"/>       
    </hibernatetool>
</target> 
```

## 来自 Hibernate 文档的相关链接

[复合 ID](http://www.hibernate.org/hib_docs/reference/en/html/mapping.html#mapping-declaration-compositeid)
[组件作为复合 ID](http://www.hibernate.org/hib_docs/reference/en/html/components-compositeid.html)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T13:15:57.320

在休眠文档中查找“composite-id”元素。以下内容至少可以为您提供意图-将您的`id`元素替换为：

```
<composite-id>
    <key-property name="username"/>
    <key-property name="role"/>
</composite-id> 
```

请注意，*强烈*建议将您的 ID 改为一个单独的类（“组件”），它可以正确实现 hashCode 和 equals，并且是可序列化的。否则，您将只有非常尴尬的方式来使用`session.get()`or来查找您的对象`session.load()`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-21T01:15:52.520

我添加了 Chris Winters 的答案，但使用外键来实现它。你可以写：

```
<composite-id>
    <key-many-to-one name="username" class="com.foo.User" />
    <key-many-to-one name="role_id" class="com.foo.Role" />
</composite-id> 
```

这将完成这项工作并处理外键，并使您可以灵活地自行定义 Hibernate 在数据库中创建哪些表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T14:00:04.907

也许实际上是这样的：

```
<class name="User" table="users">
  <id name="username" column="user_name"/>
  <property name="password" column="user_pass" not-null="true"/>
  <set name="roles" table="user_roles">
    <key column="user_name"/>
    <element type="string" column="role_name" />
  </set>
</class> 
```

这会将角色映射到 User 类中的集合，并与您提供的模式大致匹配。它不会在其中的列中生成主键`user_roles`。

不过，您通常会从具有更多规范化模式的 Hibernate 中获得更好的结果。例如，在这种情况下，您没有角色本身的表；但是您似乎所描述的内容很自然地被建模为 User 和 Role 类，它们之间具有多对多的关系。像这样的东西：

```
<class name="User" table="users">
  <id name="username" column="user_name"/>
  <property name="password" column="user_pass" not-null="true"/>
  <set name="roles" table="user_roles">
    <key column="user_name"/>
    <many-to-many column="role_name" class="Role"/>
  </set>
</class>
<class name="Role" table="roles">
  <id name="name" column="role_name"/>
</class> 
```

现在这将产生一个带有表的模式`users`，`roles`并且`user_roles`现在`user_roles`将在用户名和角色名列中具有一个主键。您现在还可以在某个地方挂起有关角色的其他信息，例如描述。

此外，您发布的错误是 ClassNotFoundException 这似乎不太可能是您的映射的实际问题。

如果必须，您可以使用复合 ID 来执行此操作，但我会说您只是不想因为这么简单的事情而陷入痛苦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-19T18:32:05.337

Sergio，看看hibernate教程中的这个[复合键映射。](http://www.skill-guru.com/blog/2010/02/10/mapping-composite-keys-in-hibernate/)可能会帮到你。

# asp.net - 在启用分页的 Asp.net Gridview rowcommand 事件中使用 row.FindControl 时出现索引超出范围错误

> ID：751614
> 
> 赞同：1
> 
> 时间：2009-04-15T13:09:27.790
> 
> 标签：asp.net, gridview, findcontrol, rowcommand

以下代码在 Asp.net Gridview 控件内的数据第 1 页上效果很好：

```
 If e.CommandName = "Void" Then

        'Read the status of the ticket currently
        Dim RowIndex As Integer = CInt(e.CommandArgument)
        Dim row As GridViewRow = grdTradeTickets.Rows(RowIndex)

        Dim lblTransactionID As Label = DirectCast(row.FindControl("lblTransactionID"), Label)
        Dim lblTtStatus As Label = DirectCast(row.FindControl("lblTtStatus"), Label)
        Dim lblTradeTicketID As Label = DirectCast(row.FindControl("lblTradeTicketID"), Label)

        'If already void, show "Already Void" message to user. Else continue "Are you sure you want to void this Trade Ticket?"
        If lblTtStatus.Text = "Void" Then

            mdlPopupAlready.show()

        Else

            mdlPopup.Show()
            lblTradeTicketIdToVoid.Text = lblTradeTicketID.Text

        End If

    End If 
```

但是，如果用户在任何后续页面上单击“无效”按钮，则会引发以下错误：

“索引超出范围。必须为非负数且小于集合的大小。参数名称：索引”

它不像索引是空的或什么的。它有一个价值。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T13:38:21.043

尝试替换行：

```
Dim RowIndex As Integer = CInt(e.CommandArgument)
Dim row As GridViewRow = grdTradeTickets.Rows(RowIndex) 
```

和

```
Dim row As GridViewRow = DirectCast(DirectCast(e.CommandSource, Control).Parent.Parent, GridViewRow) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T10:03:02.880

我面临着同样的问题。然后原来是 SubString() 方法的问题。我在做什么我正在使用索引从字符串中获取子字符串。像

myString.SubString(3, 6);

在 myString 中，我传递的“abc”表示长度为 3 的字符串。查找一些使用子字符串或集合的代码并尝试调试它。干杯:)

# c# - 在服务器和客户端之间实现心跳的模式

> ID：751622
> 
> 赞同：6
> 
> 时间：2009-04-15T13:10:54.337
> 
> 标签：c#, .net, design-patterns

我想在服务器中实现一个心跳功能，它会定期提醒 **窗口客户端**它的活跃度。我正在考虑的想法很少，但希望得到建议和示例/参考

*   有一个单独的线程可以向连接的客户端发送心跳

*   有不同类型的心跳来指示服务器的不同状态（慢、快、客户端不堪重负、启动和就绪）

*   也许让客户端订阅不同的级别，默认发送心跳

我真的很想看看它在实践中是如何完成的，例子是最好的。

**EDIT 1**客户端和服务器不是基于网络的！（服务器可能会迁移到网络，但我认为它不应该改变协议太多）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T14:20:06.310

使用 Josh 提到的拉动模型是最简单的方法。首先，你会解决很多安全问题。无需担心客户端防火墙。另外，您不必担心必须在每个客户端上打开相同的端口，或者打开动态端口并通知服务器正在使用哪个客户端上的哪个端口。

此外，您不必在服务器上维护订阅者列表。另外，如果客户端以不那么干净的方式断开连接（应用程序崩溃、电源故障等），您无需担心清理订阅者列表。

基本上，从客户端到服务器上的服务的简单轮询是最简单和最干净的方法，恕我直言。我已经用过好几次了。如果您愿意，您甚至可以将轮询间隔设置为用户可配置的。

编辑：

虽然我无法提供参考或示例代码，但我将描述我过去所做的事情。

基本上，我有一个 Web 服务，当被查询时，它会返回系统的状态。这个 Web 服务显然是在服务器上运行的。客户端在启动时将启动一个单独的线程，该线程将每 30 秒查询一次 Web 服务以获取服务器系统的状态。然后，将更新 UI 以指示该状态。一旦该任务完成，线程将重新休眠 30 秒。更新时间可通过配置文件进行配置。只要确保捕获错误，这样如果对服务的请求由于服务器关闭以外的原因而失败，整个应用程序就不会崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T02:25:50.620

这几乎可以肯定是矫枉过正，但是有一个完整的（并且非常活跃的）学科着眼于故障检测器的类别，它们可以提供什么样的保证，以及它们如何实际实施。对于那些想要比这个提问者暗示的更进一步的人，看看：

```
系列书籍 -
书名 - 分布式计算
章节标题——关于快速故障检测器对实时容错系统的影响
第一页 - 354
最后一页 - 369
版权所有 - 2002
作者 - Marcos K. Aguilera
作者 - Gérard Le Lann
作者 - Sam Toueg
DOI - 10.1007/3-540-36108-1_24
链接 - http://www.springerlink.com/content/e03yf4etbnle9728
```

```
书名 - 分布式算法
章节标题 - 心跳：用于静态可靠通信的无超时故障检测器
第一页 - 126
最后一页 - 140
版权所有 - 1997
作者 - Marcos Kawazoe Aguilera
作者 - 陈伟
作者 - Sam Toueg
DOI - 10.1007/BFb0030680
链接 - http://www.springerlink.com/content/dj5n71hl17841416

```

此外，从问题中也不清楚，但如果所讨论的语言是 Java，关于这个主题的一个很好的资源是：[Reliable Distributed Programming 简介](https://rads.stackoverflow.com/amzn/click/com/3540288457)，有很多优秀的示例代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T13:36:35.743

我们在谈论什么样的客户？Windows 客户端还是 asp.net？有两种非常通用的模式。您可以推送或拉取数据。如果您在互联网上遇到防火墙和 nat，则推送不起作用。因此，您最终会得到第三种变体，其中客户端启动连接，服务器保持连接打开以来回发送信息。

您需要提供更多信息，我们是在谈论 Internet 还是 Intranet？您的目标是什么 .net 框架？你在说多少客户？可以处理十几个客户端（特别是在推送模型或第三种模型中）的解决方案可能与可以扩展到数千个客户端的解决方案看起来非常不同。

最简单的解决方案是从客户端进行轮询，除非您希望服务器与客户端进行即时通信，否则这是可行的方法。心跳不是即时通讯。

# 编辑

好的，您指出了套接字，您真的确定要进行较低级别的网络类型编程吗？为什么不建立在现有的网络策略（例如 HTTP）之上。你可以通过 HTTP 做一个简单的远程服务，它可以让你绕过防火墙。或者如果您的服务器是 Web 服务器则更好，那么只需设置一个普通的旧 xml 服务。

我没有任何可以分享的例子，但应该有很多。

# html - 并排放置 2 个 div / Internet Explorer 6/7 浮动和填充（？）错误修复

> ID：751624
> 
> 赞同：0
> 
> 时间：2009-04-15T13:11:06.227
> 
> 标签：html, internet-explorer, css-float, css

我需要并排放置 2 个 div。但更重要的是，我希望它在 IE6/7 中正确显示。不过，我已经设法用 Firefox 成功了。我的代码：

```
#container{
    padding:10px;
}

#left{
    float:left;
    width:500px;
}

#right{
    width: 300px;
    float:right;
    padding:7px;
    background-color:#F0FCEB;
}

<div id="box"> 
<div id="left">Some content here</div> 
<div id="right">Some content here 2</div>
<div style="clear:both;"></div>
</div> 
```

结果如下图：

所需输出（FF 输出）： ![期望的输出](https://i.stack.imgur.com/PCGnT.gif)

IE6/7 输出： ![IE6/7 输出](https://i.stack.imgur.com/XK5Ca.gif) 如何在 IE 中摆脱这种不必要的填充，或者有其他方法吗？注意：我使用 jQuery 和 Nifty for jQuery 创建圆角。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T14:15:43.340

> 这里有一些内容 2

那是什么内容？您的示例按原样工作，因此是内容本身导致问题的原因。

它是否可能包括一个表格，就像它在镜头上的样子？

<form> 有一个默认的顶部/底部边距，垂直边距如何折叠是一些混淆和浏览器差异的问题（如果可能，通常最好避免）。所以迷你重置规则：

```
form { margin: 0; } 
```

可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T13:28:15.933

不要使用桌子！我经常对长表格使用无序列表。但这里 2 个 div 可能会起作用。确保为便于访问，您将 Ara: 标记为 a`<label>`并将[其与输入字段相关联](http://www.webrichtlijnen.nl/english/manual/development/production/forms/accessibility/input-fields-and-labels/)

确保在表达之前重置项目的默认填充和边距。

```
#box label, #box input {margin:0;padding:0;} 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-04-15T13:17:12.577

使用 a `<table>`，根据我的经验，它们最适合并排对齐

# performance - 进行 TDD 时的性能测试最佳实践？

> ID：751626
> 
> 赞同：11
> 
> 时间：2009-04-15T13:11:17.037
> 
> 标签：performance, tdd, automated-tests, integration-testing

我正在做一个非常需要一些性能调整的项目。

如果我的优化没有提高程序的速度，我该如何编写失败的测试？

详细说明一下：

问题不在于发现要优化哪些部分。我可以为此使用各种分析和基准测试工具。

问题在于使用*自动化*测试来证明特定优化确实具有预期的效果。如果我以后可以使用测试套件来发现可能的性能回归，那也是非常可取的。

我想我可以运行我的分析工具来获取一些值，然后断言我的优化代码会产生更好的值。然而，明显的问题是基准值不是硬值。它们因当地环境而异。

那么，总是使用同一台机器进行这种集成测试的答案是什么？如果是这样，您仍然必须考虑结果中的一些模糊性，因为即使在相同的硬件上，基准测试结果也可能会有所不同。那么如何考虑到这一点呢？

或者答案可能是保留旧版本的程序并比较前后的结果？这将是我的首选方法，因为它主要与环境无关。有没有人有这种方法的经验？我想只有在最新版本的性能至少与前一个版本一样好的情况下，如果所有测试都可以通过，则只需要保留一个旧版本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-16T17:35:10.713

我怀疑应用 TDD 来提高性能是一个错误。无论如何，用它来获得好的设计和工作代码，并使用在 TDD 过程中编写的测试来确保持续的正确性——但是一旦你拥有了良好的代码和一套可靠的测试，你就处于良好状态调整，并应用不同的（来自 TDD）技术和工具。

TDD 为您提供良好的设计、可靠的代码和测试覆盖安全网。这会让你进入一个调整的好地方，但我认为由于你和其他人提到的问题，它不会让你在调整的道路上走得更远。作为 TDD 的忠实拥护者和支持者以及实践者，我这么说。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T13:15:18.557

首先，您需要为可接受的性能建立一些标准，然后您需要设计一个在使用现有代码时无法满足该标准的测试，然后您需要调整代码的性能，直到它通过测试。你可能会有不止一个性能标准，你当然应该有不止一个测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T14:15:46.960

在许多服务器应用程序（可能不是您的情况）中，性能问题仅在并发访问和负载下表现出来。因此，测量例程执行的绝对时间并尝试改进它并不是很有帮助。即使在单线程应用程序中，这种方法也存在问题。测量绝对常规时间依赖于平台提供的时钟，这些[并不总是很精确](http://www.devx.com/Java/Article/28685)；您最好依靠例行程序的平均时间。

我的建议是：

*   使用分析来识别执行次数最多且花费最多时间的例程。
*   使用[JMeter](http://jakarta.apache.org/jmeter/)或[Grinder](http://grinder.sourceforge.net/)之类的工具来详细说明具有代表性的测试用例、模拟并发访问、将您的应用程序置于压力之下并测量（更重要的是）吞吐量和平均响应时间。这将使您更好地了解从外部角度看您的应用程序的行为方式。

虽然您可以使用单元测试来确定应用程序的一些非功能方面，但我认为上面给出的方法将在优化过程中提供更好的结果。在单元测试中放置与时间相关的断言时，您将不得不选择一些非常近似的值：时间可能会根据您用于运行单元测试的环境而有所不同。您不希望仅仅因为您的一些同事使用劣质硬件而导致测试失败。

调优就是找到合适的东西来调优。您已经有一个正常运行的代码，因此将与性能相关的断言放在事后*而不*建立代码的关键部分可能会导致您浪费大量时间来优化应用程序的非必要部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T13:16:36.523

记录当前代码的运行时间。

```
if (newCode.RunningTime >= oldCode.RunningTime) Fail 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-16T10:07:01.893

在 CI 服务器中运行测试 + 分析。您还可以定期运行负载测试。

您担心差异（正如您所提到的），因此它与定义绝对值无关。有一个额外的步骤，将这次运行的性能测量值与最后一次构建的性能测量值进行比较，并将差异报告为 %。您可以为重要的时间变化竖起红旗。

如果您关心绩效，您应该有明确的目标，并坚持这些目标。您应该在整个系统上进行测试来衡量那些。即使您的应用程序逻辑很快，您也可能会遇到导致您错过目标的视图问题。您也可以将其与差异方法结合使用，但对于这些方法，您对时间变化的容忍度较低。

请注意，您可以在您的开发计算机上运行相同的进程，只使用该计算机中以前的运行，而不是开发人员之间共享的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-20T15:08:02.077

还没有遇到这种情况；）但是，如果我这样做了，这就是我的处理方式。（我想我是从 Dave Astel 的书中学到的）

第 1 步：提出“可接受的性能”规范，例如，这可能意味着“用户需要能够在 N 秒（或毫秒）内完成 Y”
第 2 步：现在编写一个失败的测试。使用您友好的计时器类（例如，.NET 有 StopWatch 类）和`Assert.Less(actualTime, MySpec)`
Step#3：如果测试已经通过，那么您就完成了。如果是红色，则需要优化并使其变为绿色。一旦测试变为绿色，性能现在是“可接受的”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T07:11:03.700

对于调优本身，可以直接对比新旧代码。但不要保留两个副本。这听起来像是一场噩梦。此外，您只是将一个版本与另一个版本进行比较。功能的更改可能会减慢您的功能，这是用户可以接受的。

就个人而言，我从未见过“必须比上一个版本更快”类型的性能标准，因为它很难衡量。

您说“非常需要性能调整”。在哪里？哪些查询？有哪些功能？谁说，企业，用户？什么是可接受的性能？3秒？2 秒？50 毫秒？

任何性能分析的起点都是定义通过/失败标准。一旦你有了这个，你就可以自动化性能测试。

为了可靠性，您可以使用（简单）统计方法。例如，在相同的条件下运行相同的查询 100 次。如果 95% 的人在 n 秒内返回，那就是通过。

就个人而言，我会在集成时从标准机器或集成服务器本身执行此操作。在某处记录每个测试的值（巡航控制对于这类事情有一些不错的功能）。如果您这样做，您可以看到性能如何随着时间的推移以及每次构建的进展情况。您甚至可以制作图表。经理喜欢图表。

在进行性能测试时，无论您是否进行自动化测试，始终很难拥有稳定的环境。无论您如何开发（TDD、Waterfall 等），您都会遇到这个特殊问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-09T06:58:15.010

kent beck 和他的团队自动化了 TDD 中的所有测试。

在这里进行性能测试，我们也可以在 TDD 中自动化测试。

性能测试的标准是我们应该测试是或否的情况

如果我们很好地了解规范，我们也可以在 TDD 中自动化它们

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-23T13:11:01.107

虽然我大致同意 Carl Manaster 的回答，但使用现代工具，可以将TDD 为功能测试提供的*一些优势转化为性能测试。*

使用大多数现代性能测试框架（我的大部分经验是使用[Gatling](http://gatling.io/)，但我相信大多数性能测试框架的新版本也是如此），可以将自动化性能测试集成到持续集成构建中，并对其进行配置，以便如果不满足性能要求，CI 构建将失败。

因此，如果可以事先商定您的性能要求是什么（对于某些应用程序，可能由与用户或客户商定的 SLA 驱动），如果更改导致性能问题，这可以为您提供快速反馈，并确定需要性能的领域改进。

良好的性能要求是“当每小时有 5000 个订单时，95% 的用户旅程应该包括不超过 10 秒的等待时间，并且屏幕转换不超过 1 秒”。

这还依赖于在 CI 管道中部署到类似生产的测试环境。

但是，使用性能需求来推动开发可能仍然不是一个好主意，就像使用功能需求一样。对于功能需求，您通常在运行应用程序之前对它是否会通过测试有一些了解，并且尝试编写您认为会通过的代码是明智的。就性能而言，[尝试优化性能尚未衡量的代码是一种可疑的做法](https://softwareengineering.stackexchange.com/questions/80084/is-premature-optimization-really-the-root-of-all-evil)。您可以在某种程度上使用性能*结果来推动您的应用程序开发，而不是性能**要求*。

# iphone - 不以全屏模式播放视频

> ID：751627
> 
> 赞同：1
> 
> 时间：2009-04-15T13:11:37.457
> 
> 标签：iphone, video, size, screen, mode

首先，原谅我的英语:)

我在苹果开发者网站上读到该框架提供的视频播放仅支持全屏模式。

我需要开发一个可以在缩小屏幕模式下播放视频的应用程序。我已经看到 Orange TV 做出了一些我需要做的事情。

[http://img218.imageshack.us/img218/1228/tvplayerorange.jpg](http://img218.imageshack.us/img218/1228/tvplayerorange.jpg) [http://img218.imageshack.us/img218/1228/tvplayerorange.jpg http://img218.imageshack.us/img218/1228/tvplayerorange。 jpg](http://img218.imageshack.us/img218/1228/tvplayerorange.jpg)

该应用程序可在应用商店获得，但您需要订阅才能测试此应用程序。无论如何，要恢复它，我们可以在缩小模式下观看视频（电视流视频），如果我们点击屏幕，它会切换到全屏模式。

所以我的问题是，我想做的事情是可能的（Orange TV 做到了），但我想知道实现它的难度。看来我必须制作一个视频播放器。如果需要很多时间，我想我会使用 iPhone 的媒体播放器框架，即使对我来说不是最佳解决方案。

随时问我更多细节;）

谢谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T09:13:01.233

[查看此处](http://ericasadun.com/iPhoneDocs220/interface_m_p_movie_player_controller.html)的 MPMoviePlayerController 类转储，您可以看到这些公共成员：

```
-(BOOL) isFullscreen;  
-(void) setFullscreen:(BOOL)fp8; 
```

因此，以窗口模式播放电影的机会很小。但是，这些成员不是官方可用的，并且可能有意想不到的行为。这只是一个提示，我自己没有做过。请注意，使用未记录的 API 可能会使 Apple 从 AppStore 拒绝您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T14:29:56.660

无法使用内置媒体框架来显示窗口视频。您必须将另一个编解码器和流媒体库移植到 iPhone 才能实现此目的。

# algorithm - 多个列表的排序组合

> ID：751632
> 
> 赞同：0
> 
> 时间：2009-04-15T13:12:41.353
> 
> 标签：algorithm, sorting

将 L1、L2、L3 视为分别按排序顺序包含 n1、n2 和 n3 个整数的列表。

任务是构建一个排序列表 L 使得，

```
L[0] = L1[0] + L2[0] + L3[0]
L[i] = L1[i1] + L2[i2] + L3[i3]
L[n1 * n2 * n3] = L1[n1] + L2[n2] + L3[n3]

```

但是 n1, n2, n3 非常大，因此不能一次性构造 L 再进行排序。

因此，列表将分阶段构建，以便我们可以显示 k 个顶部整数并保存计算状态以通过计算第 [k+1] 个顶部整数来恢复。

可以使用哪些数据结构和算法来实现目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T13:21:54.843

既然您已经有三个排序列表，您就不能只使用修改后的[合并排序吗？](http://en.wikipedia.org/wiki/Merge_sort)（“修改”是指利用您知道每个输入列表已经排序的事实。）

假设您不能直接使用合并排序，因为您不想在内存中计算整个新合并的排序列表，那么您如何：使用修改后的合并排序来计算第一组合并条目并显示那些，维护合并排序中使用的指针。你只需坚持你在每个列表中的位置，一个指向每个列表中当前位置的指针，然后为每个块选择你离开的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:34:50.553

好的，我可能会被这个答案激怒。但是由于您只需要算法，因此最好的解决方案是遍历每个列表，同时构建具有最佳元素的结果列表（在这种情况下是较低的，或者您喜欢的那个）。使用此方法，您有 4 个位置，一个用于您要遍历的每个列表，最后一个点可能指向您需要插入的结果列表中的位置（或插入的最后一个位置）。有了这个，您唯一需要的结构就是一个列表。

在这种情况下，我发现合并排序存在问题。您显示的数据可能不是确切的数据（因为您需要对下一部分进行排序，并且可以与当前部分合并）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T12:05:39.250

好的，首先是二维的示例：

```
    1 2 3

1 2 3 4
5 6 7 8
7 8 9 10

```

显然，您从左上角开始，然后将值放入结果列表中。接下来，您必须将所有可到达的候选（通过增加一个索引）从那里添加到某种排序的集合中，这里是值为 3 和 6 的单元格。然后从该集合中取出最低的成员，将其值放入结果列表中，将所有可从那里到达但尚未在集合中的候选者添加到该列表中，依此类推。

你会需要：

*   一个包含候选人的数据结构，具有所有索引和结果值（我在下面将其表示为“ `((i1 i2) value)`”）。
*   候选集合的数据结构，按值排序。堆似乎是理想的选择。

当您将它们放入集合时，您必须确保所有候选者的索引都是唯一的。这些值不一定是唯一的，但堆应该按它们排序。由于给定的一组索引总是产生相同的值，因此只有在插入堆时遇到该值时，您才必须检查索引的唯一性。使堆的节点不是单个候选者而是具有相同值的候选者列表可能是一种优化。

使用上面的示例执行此操作：首先，结果列表是 (2)。候选者是 ((1 2) 3) 和 ((2 1) 6)。取出值最低的候选者，将值放入结果列表 -> (2 3)，找到所有新候选者的坐标 -> (2 2) 和 (1 3)，计算它们的值 -> ((2 2 ) 7) 和 ((1 3) 4)，将它们放入候选堆（此处为序列化表示）-> ((1 3) 4) ((2 1) 6) ((2 2) 7)，起泡，冲洗，重复。

以表格形式：

```
结果列表候选人
(2) ((1 2) 3) ((2 1) 6)
(2 3) ((1 3) 4) ((2 1) 6) ((2 2) 7)
(2 3 4) ((2 1) 6) ((2 2) 7) ((2 3) 8)
(2 3 4 6) ((2 2) 7) ((3 1) 8) ((2 3) 8)
(2 3 4 6 7) ((3 1) 8) ((2 3) 8) ((3 2) 9)
(2 3 4 6 7 8) ((2 3) 8) ((3 2) 9)
(2 3 4 6 7 8 8) ((3 2) 9) ((3 3) 10)
(2 3 4 6 7 8 8 9) ((3 3) 10)
(2 3 4 6 7 8 8 9 10)

```

目前我没有看到更好的方法。堆似乎需要n1、n2和n3之和数量级的节点。

# c# - 到 SQL Server 群集的连接字符串

> ID：751634
> 
> 赞同：5
> 
> 时间：2009-04-15T13:14:18.357
> 
> 标签：c#, sql-server, ado.net, cluster-computing

谁能指出我或告诉我如何将连接字符串写入 SQL Server 群集实例？

我想与 SQL Server 集群的特定实例的数据库（初始目录）建立可信连接。我找了很长一段时间，但找不到谷歌的官方答案。

我要求 C# ADO.Net 代码的连接字符串。

我知道如何将连接字符串写入普通的单机非集群 SQL Server 实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T15:14:02.840

服务器名称是虚拟服务器名称。

例子：

*   你有身体`pserver1`，`pserver2`
*   这些一起构成集群`cserver` - 这托管虚拟服务器`vserv1`（也许，见下文）`vserv2`

所以，它是`vserv1\instancename`或`vserv1`。您不使用物理服务器名称

根据虚拟服务器的可能名称数量进行编辑：

集群可以是主动/被动/A/P）或主动/主动（A/A）

*   在 A/P 中，只有一个虚拟服务器被托管，备用节点没有被主动使用。
*   在 A/A 中，有 2 个虚拟服务器，通常每个节点托管一个。每个节点都为另一个节点备用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-16T09:41:10.293

连接字符串以通常的方式编写；但在集群中，您有 3 个（或更多）地址：一个用于构成集群的每个节点，一个用于集群。例如：我们有两个节点，地址分别为 192.168.0.10 和 192.168.0.20：如果您在连接字符串中写下其中一个数字作为 DataSource，您将获得对该物理实例的访问权限。但是，如果您想访问集群（虚拟）Sql Server 实例，则必须使用集群的地址（例如：192.168.0.230）作为数据源。当然，您也可以使用机器名称而不是 IP 地址，前提是您与集群在同一个域中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T16:39:07.040

这在我能找到的任何地方都没有记录，但我必须使用集群上可用性组侦听器的名称。例如：

```
data-source=tcp:AG1-Listener 
```

从字面上看，这在任何地方都没有记录。我很幸运，在某处的博客上找到了一个集群的连接字符串，并从那里弄清楚了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-20T15:03:40.823

我知道这是一个旧线程，但是：

[https://support.microsoft.com/en-us/kb/273673](https://support.microsoft.com/en-us/kb/273673)

解释了为什么应该在连接上指定超时。摘录如下。

如果群集管理员对 SQL Server 服务器进行故障转移，则不会发送 TCP 重置数据包。如果 SQL Server 进程被操作系统（由 Kill.exe）终止，则会发送重置数据包。

如果应用程序未指定查询超时参数或查询超时为零 (0)，这可能会影响客户端应用程序。

如果应用程序没有查询超时值，则在发生故障转移后打开的连接将保持在 ESTABLISHED 状态。打开的连接没有关闭并且没有从这些连接发送更多 TCP 数据包的事实表明这些连接完全空闲。因为故障转移没有向客户端应用程序发送任何 TCP 重置数据包，所以这些打开的连接会无限期地等待查询结果（假设无限期查询超时），并可能导致连接停止响应（挂起）。

# asp.net - ASP.NET - 不能 GetType() 的 MasterPage

> ID：751636
> 
> 赞同：1
> 
> 时间：2009-04-15T13:15:17.213
> 
> 标签：asp.net, master-pages, gettype

我有一个 MasterPage 并按如下方式获取其类型：

[替代文字 http://www.yart.com.au/stackoverflow/masterpage.png](http://www.yart.com.au/stackoverflow/masterpage.png)

没问题，这行得通

现在，当我创建一个 aspx 页面并尝试同样的事情时，我得到了 null：

[替代文字 http://www.yart.com.au/stackoverflow/page.png](http://www.yart.com.au/stackoverflow/page.png)

为什么？

我怎样才能让它工作？

**笔记**

下面的答案说我需要参考一个大会。但是，当我将此应用程序作为 ASP.NET 网站运行时，我该怎么做 - 这里有已编译的 DLL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T13:23:39.907

发生这种情况的原因是因为您正在单独编译每个页面，因为您使用的是网站而不是 Web 项目。

所以每一页都是一个单独的程序集，彼此不知道。如果您想使用 GetType，我建议您更改为 Web 项目以使您的生活更轻松。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T14:38:07.263

在您的 aspx 页面的标记中，您可以指定您正在使用的母版页类型，如下所示：

```
<%@ MasterType VirtualPath="~/MasterPage.master" %> 
```

在任何情况下，您都可以在代码隐藏中通过这样的调用获取当前母版页的类型：

```
protected void Page_Load(object sender, EventArgs e)
{
    Type t;
    t = this.Master.GetType();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T13:21:19.010

`Type.GetType(string)`需要一个程序集限定的类型名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T20:40:42.587

添加史蒂夫建议的内容，我一直使用他的方法，还可以查看这篇关于 MasterType 指令的 MSDN 文章。

[http://msdn.microsoft.com/en-us/library/ms228274.aspx](http://msdn.microsoft.com/en-us/library/ms228274.aspx)

# c# - 从 C# 读取和写入 Microsoft Project 2007

> ID：751638
> 
> 赞同：2
> 
> 时间：2009-04-15T13:15:36.620
> 
> 标签：c#, ms-project

有没有办法从 Microsoft Project 2007 mpp 文件中读取和写入数据？我有一个从 Project 2003 访问数据库文件中读取和写入数据的应用程序。为了使它工作，我首先将 Project 2003 mpp 文件保存为 Access 数据库，然后我的代码可以读取和写入 Access 数据库。但 Project 2007 不允许您另存为 Access 数据库文件。我想知道是否有其他方法可以获取数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T13:17:51.903

您可以使用[.NET Office Interop](http://msdn.microsoft.com/en-us/office/aa905525.aspx)来使用 Microsoft Project 2007。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-27T13:16:16.367

您可能会发现[MPXJ](http://mpxj.sf.net)很有用。它将允许您读取 MPP 文件，以及来自 Project 和其他规划应用程序的各种文件格式。如果您想再次将数据读入 Project，它将允许您将数据保存为 MPX 或 MSPDI 文件。

乔恩

ps

免责声明：我维护 MPXJ。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-10T08:15:51.093

[Aspose.Tasks for .NET](http://www.aspose.com/categories/.net-components/aspose.tasks-for-.net/default.aspx)允许您在[Microsoft Project 2007 中读取和写入数据](http://www.aspose.com/documentation/.net-components/aspose.tasks-for-.net/index.html)。使用该组件的简单 API 可以轻松执行数据读取和写入操作。此外，它不需要在运行您的应用程序的机器上安装 MS Office。

披露：我在 Aspose 担任开发人员布道师。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-02T02:31:23.930

我强烈建议使用 MS Project 对象模型。我最近开发了一个 MS Project 插件，其中我从 MS Project 导入/导出。

我在下面用 C# 提供了一个示例。

```
MSProject.Tasks tasks = Globals.ThisAddIn.ProjectApp.ActiveProject.Tasks;

for (int TaskNo = 1; TaskNo <= tasks.Count; TaskNo++)
{
   string TaskName;
   TaskName = tasks[TaskNo].Name;

 // more code

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-01T22:25:33.140

您可以使用 Project Server 接口 (PSI) 来完成此操作。有一个完整的 SDK 可用：

[http://msdn.microsoft.com/en-us/library/ms512767.aspx](http://msdn.microsoft.com/en-us/library/ms512767.aspx)

还可以查看有关报告数据库的部分：

[http://msdn.microsoft.com/en-us/library/ms510779.aspx](http://msdn.microsoft.com/en-us/library/ms510779.aspx)

当然，您始终可以使用对象模型，但在访问时间分段数据时会出现性能问题。报告数据库将所有时间分段数据非规范化为非常易于查询的视图。

科尔比非洲 [http://colbyafrica.blogspot.com](http://colbyafrica.blogspot.com)

# iphone - 访问 sqlite3 数据库

> ID：751640
> 
> 赞同：0
> 
> 时间：2009-04-15T13:15:51.423
> 
> 标签：iphone, objective-c

我已经使用 macbook 上的终端通过 sqlite3 创建了数据库和表，然后使用我的 iPhone 应用程序部署它。它在模拟器插入和检索表中的值时工作正常。

但是当我将它安装在真正的 iPhone 上时，它无法正常工作，为什么？我认为它无法获取数据库的路径，那我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:30:07.863

您是否将数据库留在基本应用程序路径中？
因为如果是，实际的硬件将不允许您写入该目录中的文件，只需读取即可。要写入数据库，您首先必须将其复制到可访问的目录。

我正在做类似的事情（其中文件名是一个包含数据库文件名称的 NSString）：

```
NSArray *docPaths =
  NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *docPath = [docPaths objectAtIndex:0];
NSString *fullName = [docPath stringByAppendingPathComponent:fileName];
NSFileManager *fm = [NSFileManager defaultManager];
if (![fm fileExistsAtPath:fullName])
{
  NSString *path = [[NSBundle mainBundle] bundlePath];
  NSString *defaultName = [path stringByAppendingPathComponent:fileName];
  [fm copyItemAtPath:defaultName toPath:fullName error:NULL];
} 
```

基本上，检查文件是否已经存在，如果不存在，则从基本 bundlePath 复制它。

# sql - SQL Server 动态排序依据

> ID：751642
> 
> 赞同：3
> 
> 时间：2009-04-15T13:16:19.707
> 
> 标签：sql, sql-server

我正在尝试在存储过程中使用动态顺序，因此我可以将我希望将数据作为参数返回到存储过程中的顺序传递。这适用于 VARCHAR 字段，但是如果我尝试对 int 或 datetime 字段进行排序，则会出错，我拥有的代码如下

```
DECLARE @ORDERBY INT
SET @ORDERBY = 1
SELECT TOP 10 * FROM TBL_LMS_USERS_RECORDs_LAST_ATTEMPT
ORDER BY 
CASE 
    WHEN @OrderBy = 1 THEN s10_record_dow
    --WHEN @OrderBy = 2 THEN pk_big_record_id
    else s10_record_dow
END 
```

如果我取消注释 case 语句中的第二个 WHEN ，则会出现错误

> “将数据类型 varchar 转换为 bigint 时出错。”

如果我不使用 case 语句，我可以按此字段进行排序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T13:23:15.120

将其更改为：

```
SELECT TOP 10 * FROM TBL_LMS_USERS_RECORDs_LAST_ATTEMPT
ORDER BY 
    CASE WHEN @OrderBy = 1 THEN s10_record_dow ELSE NUll END,  
    CASE WHEN @OrderBy = 2 THEN pk_big_record_id ELSE NULL END,
    CASE WHEN @OrderBy <> 1 AND  @OrderBy <> 2 THEN s10_record_dow 
         ELSE NULL 
    END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-25T21:14:42.520

为什么不使用 ROW_NUMBER()？

```
SELECT TOP 10 
       *,
       CASE @SortBy
         WHEN 'A' THEN ROW_NUMBER () OVER (ORDER BY s10_record_dow)
         WHEN 'B' THEN ROW_NUMBER () OVER (ORDER BY pk_id)
       END RowNumber
FROM TBL_LMS_USERS_RECORDs_LAST_ATTEMPT 
```

然后您订购的列可以是任何类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-07T16:17:33.393

```
order by 
(case when (@orderByAsc = 1) then r.SomeColumn end) asc,
(case when (@orderByAsc = 0) then r.SomeColumn end) desc 
```

这就是你上升或下降的方式

# windows - Windows 上 Mono 的意义何在

> ID：751648
> 
> 赞同：64
> 
> 时间：2009-04-15T13:18:03.807
> 
> 标签：windows, mono

这可能是一个愚蠢的问题......但我只是在研究 Mono 项目，他们有一个关于[在 Windows 上安装 Mono](http://mono-project.com/Mono:Windows)的部分。但是，既然 Windows 显然已经有了 .NET 运行时，谁能告诉我为 Windows 安装 Mono 到底有什么意义？它对跨平台开发有帮助吗？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-04-16T23:04:59.907

Mono 有几个 .NET 没有的功能。

Mono 是高度模块化的。您可以将其分解成小块，只部署*您*需要的那些部分。不想要 System.Xml？好吧，没了。

单声道是可嵌入的。您可以将其托管在您的 C/C++ 应用程序中，以允许用户从安全的托管沙盒环境编写脚本。最著名的例子是 mod_mono，它在 Apache 网络服务器中托管 Mono，例如，ASP.NET 是如何在 Mono 中实现的。此功能与上面提到的模块化配合得很好。

这已经被提及：静态链接。与模块化*也很相配。*

编译器即服务是另一种。Anders Hejlsberg 已经谈论它*很久*了，*也许*，也许它会为 C# 5.0 做好准备。好吧，Mono 已经拥有它，而且实际上已经拥有它多年。

Mono 的首席开发人员 Miguel de Icaza 还提出了一项他称之为“拥抱和扩展.NET”的计划，该计划以其他 CLI 实现（包括 .NET）无法（当前）实现的方式扩展 CLI。到目前为止，Embrace 和 Extend.NET 具有三个特性。

Mono.Simd，它提供对底层 CPU 的 SIMD 指令的安全和受控访问（例如 Intel 上的 SSE 或 PowerPC 上的 AltiVec）。用于游戏和图形。

ECMA 规范允许的 64 位数组索引，但 Mono 是唯一真正提供它们的 VM。用于超级计算。

最近，延续。这实际上是 Mono 第一次偏离规范范围：长数组索引根据规范完全有效，并且 Mono.Simd 也适用于每个 CLI 兼容的实现（尽管*非常*慢），但 Mono.Tasklet 需要特殊来自不属于 CLI 或 .NET 的 VM 的支持。这用于游戏逻辑，例如在第二人生中。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-04-15T13:21:11.270

因为 Mono 没有 100% 地实现与 MS .Net 框架相同的 .Net，所以您可以在 Mono 上进行测试而不必在 Linux 上运行是件好事。此外，Mono 有绑定以使用 MS 不支持的 GTK 制作表单。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-04-15T13:23:24.200

### Mono 做了一些 .Net 没有做的事情。

例如，mono 支持静态链接，因此您可以构建、编译和分发您的应用程序，而无需单独的运行时安装程序。如果您构建的应用程序依赖单声道来实现跨平台，则与 .Net 存在一些差异，因此在 Windows 上坚持使用单声道可以更好地保证兼容性。

### .Net 做了一些单声道没有做的事情。

BCL 中有一些地方尚未移植到单声道，例如 WPF 和 Winforms 等。

如果你想要一个也可以在 mac/linux 上运行的应用程序，你可能想先为 mono 开发，即使你在 windows 上做了大部分工作。

* * *

**注意：**所有这些都早于 .Net Core/Standard。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2010-04-17T02:08:08.520

来自 Mono 的[技术常见问题解答](http://www.mono-project.com/FAQ:_Technical)：

> **为什么要支持Windows，什么时候可以运行真实的东西？**
> 
> 有多种原因：
> 
> 支持 Windows 有助于我们从 Mono 的非便携版本中识别出可移植部分，从而帮助 Mono 在未来变得更加便携。
> 
> 它可以帮助我们，因为我们可以通过划分问题（是运行时问题还是操作系统问题？）来隔离 Mono 中的问题。
> 
> Mono 的大约一半的贡献者是 Windows 开发人员。他们有许多不同的原因促成这项工作，我们发现让这些开发人员在 Windows 上运行运行时而不强迫他们使用新的操作系统非常重要。
> 
> Mono 不会大量修改 Windows 注册表、更新系统 DLL、将 DLL 安装到 Windows/System32 路径。
> 
> 它可以帮助基于 Windows 的开发人员在部署到 Linux 之前在 Mono 下测试他们的代码。
> 
> Mono 和嵌入 Mono 的应用程序无需安装程序即可部署（您可以“xcopy”部署您的应用程序和所需的 Mono 文件，而无需安装 .NET 运行时）。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-04-15T13:21:37.993

如果你想用 C# 开发一个跨平台的应用程序，那么使用微软的实现并不是最聪明的事情，因为其他平台没有完全兼容的替代方案。

所以在 Windows 上使用 Mono 开发应用程序可以确保你将它移植到其他 OS 上不会有什么麻烦（前提是你避免了 P/Invoke 等其他坑）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-04-15T14:57:08.297

有些人之所以使用它，是因为他们不允许在他们的 Windows PC 上安装 .Net 框架，因为注册表和系统文件的数量太多了。（在严格控制的环境中。）

另一方面，Mono 是自包含在 Program Files 中的，并且只写入一个带有路径的注册表项（这不是运行所必需的）。

我认为这有点愚蠢，但这是多个用户告诉我们的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-15T13:21:17.090

它主要用于帮助为 Mono 特定库开发 Mono 应用程序。也是为了帮助推进这项事业，以便开发人员在为 Mono 开发时可以在他们的自然环境中工作。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-15T13:24:21.873

虽然没有引起广泛关注，但在少数情况下，mono 比标准 Microsoft 运行时有所改进。今年，米格尔在 PDC 上就其中一些内容发表了演讲：

请参阅这些帖子：

*   [演示视频](http://tirania.org/blog/archive/2008/Nov-02-1.html)
*   [SIMD 支持和游戏](http://tirania.org/blog/archive/2008/Nov-03.html)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-09-22T06:23:57.110

即使您有与 Mono 动态链接的程序，您也可以在 pendrive 上安装已编译的 .exe 和 Mono 运行时，然后转到另一台未安装 .NET/Mono 的计算机，然后在新 PC 上运行该程序而无需安装任何运行时。即，它导致便携式应用程序（特别适用于便携式 USB 笔式驱动器应用程序） 这在 .NET 中是不可能的。您必须以特定的安装程序方式安装 .NET 运行时，即不可能包含文件夹复制和粘贴的运行时。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-16T23:08:55.810

我认为他们这样做的主要原因是他们可以在 Mono 和 .NET 上并排运行 .NET 应用程序来比较它们。此外，还有一些应用程序依赖于 Mono 库。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-17T10:44:27.037

除了其他答案中提到的众多原因之外，可能需要在 Wine 上安装 Mono for Windows 以允许在 Wine 中运行 .Net 应用程序。

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2009-04-15T13:23:27.443

[让你不被网缠住！](http://www.gnu.org/software/dotgnu/danger.html)

# scripting - 你更喜欢编译语言还是脚本语言？

> ID：751652
> 
> 赞同：2
> 
> 时间：2009-04-15T13:21:25.047
> 
> 标签：scripting, compilation, principles

由于这是一个使用各种不同技术的广泛社区，因此提出这个问题似乎是合适的地方。

您喜欢编译还是喜欢编写脚本？

我问这个是因为我倾向于用我实际需要的选定模块（如 Lua、Awk、AutoHotKey ......）用小型脚本语言来编写东西，而不是用成熟的非便携式 IDE 和大的一刀切的主流语言来编程每一个小改动都需要加载和重新编译项目的库。

我喜欢我真正需要更改/修复/更新项目的唯一工具是我碰巧运行脚本的任何系统上可用的任何编辑器（当然，解释器是我可以随身携带的单个可执行文件或立即从 Internet 下载并保存在磁盘上，无需任何安装程序）。

我也很高兴知道任何想要更新项目的人除了编辑器之外不需要任何其他东西——没有臭名昭著的编译问题、依赖问题等，而且任何不喜欢我放在*那里*的按钮的人都可以打开文件并将其放在他想要的任何地方，甚至在几分钟内将其删除。

我问这个是因为我注意到有些程序员倾向于认为任何不是本机可执行文件的东西都不够好。我什至记得论坛上的一篇帖子，我保存了我的一个开源应用程序 - 另一位程序员说“*好应用程序，但它不是 .exe* ”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T13:24:18.160

如果我有我的愿望，我可以在不编译的情况下进行编程和测试，然后在我完成后编译。

但如果我必须选择，我会选择编译器。

![替代文字](https://imgs.xkcd.com/comics/compiling.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T13:24:44.057

我喜欢任何能让我在开发周期中尽早发现错误的技术。因此，我更喜欢编译与解释的项目。静态编译是一种工具，可用于在很早的阶段强制将错误检测到代码中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T13:26:45.877

如果没有编译时间，你什么时候有时间玩 Stack Overflow（或轮椅曲棍球）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-15T13:25:01.277

我喜欢编译。这个过程为我提供了有关我的语法错误、类型不匹配等的信息。此外，编译使大多数文件不可编辑，这对于创建非开源软件非常有用。最后但并非最不重要的一点是编译使程序运行得更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T13:37:23.527

我不会说你所说的是普遍正确的。以 PHP 为例。这是一种脚本语言。但是它有数百个不同的模块。可以在您的计算机上运行的东西可能无法在另一台计算机上运行。此外，仍然存在配置文件 (php.ini)，如果您的程序在不同的计算机上运行相同，则更改配置会影响您的程序。

# .net - 带有 Flash 内容加载缓慢的 IE gridview

> ID：751665
> 
> 赞同：0
> 
> 时间：2009-04-15T13:24:04.510
> 
> 标签：.net, flash, internet-explorer, optimization, gridview

在我们的应用程序的一部分中，我们能够搜索音乐。搜索结果被加载到一个网格视图中，其中列出了歌曲名称、艺术家、使用所需的版税，以及一个小 Flash 对象，单击时播放预览（来自[该站点](http://www.wimpyplayer.com/)的 wimpy 按钮）

当用户搜索返回大量结果时，gridview 的加载时间会非常长。我已将其缩小到 flash 对象： IE 似乎等待显示 gridview，直到为每一行加载了 flash 对象。Firefox 改为呈现 gridview，然后加载 swf。

有没有办法强制 IE 立即渲染 gridview，然后加载 swf（如 Firefox）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:25:56.953

您可以使用 jQuery 并通过动态添加 Flash 内容来对完成的渲染做出反应。

# c# - C# asp.net mvc 1.0 路由

> ID：751677
> 
> 赞同：0
> 
> 时间：2009-04-15T13:26:38.217
> 
> 标签：c#, model-view-controller, routing

在我的网络应用程序中。我想设置这样的路线：

```
/document/quality/index
/document/general/index

/document/quality/detail/[id]
/document/general/detail/[id] 
```

如您所见，我有两种文件：一般文件和质量文件。在我的 global.asax 文件中进行设置的最佳方法是什么？我尝试了以下方法，但我没有得到它的工作：

```
routes.MapRoute(
    "QualityDocument",
    "Document/Quality/{action}/{id}",
    new { controller = "Document", action="Index", id= ""}
    );

routes.MapRoute(
    "GeneralDocument",
    "Document/General/{action}/{id}",
    new { controller = "Document", action = "Index", id = "" }
    );

routes.MapRoute(
    "Default",                                              // Route name
    "{controller}/{action}/{id}",                           // URL with parameters
    new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
); 
```

**编辑**

我现在可以使用它，但是当我更改 asax 文件中的 action="" 时，它不再起作用：

全球.asax：

```
routes.MapRoute(
    "GeneralDocument",
    "Document/General/{action}/{id}",
    new { controller = "Document", action = "blaat", id = "" }
    ); 
```

文档控制器：

```
public void blaat(int? id)
{
    Response.Write("algemeen");
    // return View();
} 
```

现在我得到资源未找到错误。但是当我使用 index 而不是 blaat 时，它正在工作。怎么会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:54:15.483

也许添加控制器属性，但将其限制为文档控制器。

```
routes.MapRoute(
    "QualityDocument",
    "{controller}/Quality/{action}/{id}",
     new { controller = "Document", action="Index", id= ""},
     new { controller = "Document" }
);
routes.MapRoute(
    "GeneralDocument",
    "{controller}/General/{action}/{id}",
    new { controller = "Document", action = "Index", id = "" },
    new { controller = "Document" }   ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T15:48:19.857

您应该能够在路由前加上“文档”，然后设置默认值，例如：

```
 routes.MapRoute("DocumentView", 
                "Document/{controller}/{action}/{id}", 
                new { controller = "General", action="Index", id = ""  }
            ); 
```

记住你想要完全定义的路由！在制定路线时。不要让那些意想不到的路线通过：D

看看 Scott Hanselman 在 MIX 上的演讲非常有趣，你会得到一些很棒的建议！

[http://www.hanselman.com/blog/Mix09FirstHalfRollupAndSessionVideos.aspx](http://www.hanselman.com/blog/Mix09FirstHalfRollupAndSessionVideos.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T13:30:32.480

试试这个：

```
routes.MapRoute(
    "QualityDocument",
    "Document/Quality/index",
    new { controller = "Document", action="Index" }
);

routes.MapRoute(
    "Default",                                              // Route name
    "Document/Quality/details/{id}",                               // URL with parameters
    new { controller = "Document", action = "Details", id = "" }  // Parameter defaults
); 
```

# c++ - 类的函数声明中最后一个“const”的含义？

> ID：751681
> 
> 赞同：816
> 
> 时间：2009-04-15T13:27:37.357
> 
> 标签：c++, constants, declaration, c++-faq

在这样的声明中是什么意思`const`？让`const`我很困惑。

```
class foobar
{
  public:
     operator int () const;
     const char* foo() const;
}; 
```

* * *

## 回答 #1

> 赞同：1064
> 
> 时间：2009-04-15T13:49:27.367

当您将`const`关键字添加到方法时，`this`指针本质上将成为指向`const`对象的指针，因此您无法更改任何成员数据。（除非您使用`mutable`，稍后会详细介绍）。

关键字是函数签名的`const`一部分，这意味着您可以实现两种类似的方法，一种在对象为 时调用`const`，另一种不是。

```
#include <iostream>

class MyClass
{
private:
    int counter;
public:
    void Foo()
    { 
        std::cout << "Foo" << std::endl;    
    }

    void Foo() const
    {
        std::cout << "Foo const" << std::endl;
    }

};

int main()
{
    MyClass cc;
    const MyClass& ccc = cc;
    cc.Foo();
    ccc.Foo();
} 
```

这将输出

```
Foo
Foo const 
```

在非常量方法中，您可以更改实例成员，这在`const`版本中是无法做到的。如果将上面示例中的方法声明更改为下面的代码，则会出现一些错误。

```
 void Foo()
    {
        counter++; //this works
        std::cout << "Foo" << std::endl;    
    }

    void Foo() const
    {
        counter++; //this will not compile
        std::cout << "Foo const" << std::endl;
    } 
```

这并不完全正确，因为您可以将成员标记为`mutable`，`const`然后方法可以更改它。它主要用于内部计数器和东西。解决方案是下面的代码。

```
#include <iostream>

class MyClass
{
private:
    mutable int counter;
public:

    MyClass() : counter(0) {}

    void Foo()
    {
        counter++;
        std::cout << "Foo" << std::endl;    
    }

    void Foo() const
    {
        counter++;    // This works because counter is `mutable`
        std::cout << "Foo const" << std::endl;
    }

    int GetInvocations() const
    {
        return counter;
    }
};

int main(void)
{
    MyClass cc;
    const MyClass& ccc = cc;
    cc.Foo();
    ccc.Foo();
    std::cout << "Foo has been invoked " << ccc.GetInvocations() << " times" << std::endl;
} 
```

这将输出

```
Foo
Foo const
Foo has been invoked 2 times 
```

* * *

## 回答 #2

> 赞同：201
> 
> 时间：2009-04-15T13:29:34.607

const 意味着该方法承诺不会改变类的任何成员。即使对象本身被标记，您也可以执行被标记的对象成员`const`：

```
const foobar fb;
fb.foo(); 
```

将是合法的。

请参阅[C++ 中“const”有多少和哪些用途？](http://www.stackoverflow.com/questions/455518/how-many-and-which-are-the-uses-of-const-in-c)了解更多信息。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2009-04-15T13:30:08.427

`const`限定符意味着可以对 的任何值调用方法`foobar`。当您考虑在 const 对象上调用非常量方法时，差异就出现了。考虑您的`foobar`类型是否具有以下额外的方法声明：

```
class foobar {
  ...
  const char* bar();
} 
```

该方法`bar()`是非常量的，只能从非常量值访问。

```
void func1(const foobar& fb1, foobar& fb2) {
  const char* v1 = fb1.bar();  // won't compile
  const char* v2 = fb2.bar();  // works
} 
```

背后的想法`const`是标记不会改变类内部状态的方法。这是一个强大的概念，但在 C++ 中实际上是不可执行的。与其说是保证，不如说是一种承诺。还有一个经常坏的，很容易坏的。

```
foobar& fbNonConst = const_cast<foobar&>(fb1); 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-04-15T13:30:06.210

这些 const 意味着如果“with const”方法更改内部数据，编译器将出错。

```
class A
{
public:
    A():member_()
    {
    }

    int hashGetter() const
    {
        state_ = 1;
        return member_;
    }
    int goodGetter() const
    {
        return member_;
    }
    int getter() const
    {
        //member_ = 2; // error
        return member_;
    }
    int badGetter()
    {
        return member_;
    }
private:
    mutable int state_;
    int member_;
}; 
```

考试

```
int main()
{
    const A a1;
    a1.badGetter(); // doesn't work
    a1.goodGetter(); // works
    a1.hashGetter(); // works

    A a2;
    a2.badGetter(); // works
    a2.goodGetter(); // works
    a2.hashGetter(); // works
} 
```

阅读[本文](http://www.parashift.com/c%2B%2B-faq-lite/const-correctness.html#faq-18.10)了解更多信息

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-04-15T13:37:14.743

布莱尔的回答是正确的。

但是请注意，有一个`mutable`限定符可以添加到类的数据成员中。任何如此标记的成员*都*`const`可以在不违反`const`合同的情况下修改方法。

如果您希望对象记住调用特定方法的次数，同时不影响该方法的“逻辑”常量，您可能想要使用它（例如）。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-03-14T05:48:18.753

*[C++ Common Knowledge: Essential Intermediate Programming中](https://rads.stackoverflow.com/amzn/click/com/0321321928)*Const成员函数*的含义给出了清晰的解释：*

 *> 类 X 的非 const 成员函数中 this 指针的类型是 X * const。也就是说，它是一个指向非常量 X 的常量指针（参见 Const Pointers 和 Pointers to Const [7, 21]）。因为 this 所指的对象不是 const，所以可以修改。类 X 的 const 成员函数中 this 的类型是 const X * const。也就是说，它是一个指向常量 X 的常量指针。因为 this 所指的对象是 const，所以它不能被修改。这就是 const 和非 const 成员函数之间的区别。

所以在你的代码中：

```
class foobar
{
  public:
     operator int () const;
     const char* foo() const;
}; 
```

你可以这样想：

```
class foobar
{
  public:
     operator int (const foobar * const this) const;
     const char* foo(const foobar * const this) const;
}; 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2019-03-26T17:24:17.703

我想补充以下几点。

*你也可以把* *它变成一个`const &`和`const &&`*

所以，

```
struct s{
    void val1() const {
     // *this is const here. Hence this function cannot modify any member of *this
    }
    void val2() const & {
    // *this is const& here
    }
    void val3() const && {
    // The object calling this function should be const rvalue only.
    }
    void val4() && {
    // The object calling this function should be rvalue reference only.
    }

};

int main(){
  s a;
  a.val1(); //okay
  a.val2(); //okay
  // a.val3() not okay, a is not rvalue will be okay if called like
  std::move(a).val3(); // okay, move makes it a rvalue
} 
```

*随意改进答案。我不是专家*

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-05-30T05:54:27.253

当您`const`在方法签名中使用时（如您所说`const char* foo() const;`：），您是在告诉编译器指向的内存`this`不能被此方法更改（`foo`在此处）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-12-20T17:07:06.130

这里 const 意味着在该函数中任何变量的值都不能改变

```
class Test{
private:
    int a;
public:
    void test()const{
        a = 10;
    }
}; 
```

像这个例子一样，如果你试图在测试函数中改变一个变量的值，你会得到一个错误。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-08-18T09:05:23.657

与函数声明一起使用的**const**关键字指定它是一个**const 成员函数**，并且**不能更改**对象的数据成员。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-03-20T19:44:17.213

[https://isocpp.org/wiki/faq/const-correctness#const-member-fns](https://isocpp.org/wiki/faq/const-correctness#const-member-fns)

> # 什么是“`const`成员函数”？
> 
> 检查（而不是变异）其对象的成员函数。
> 
> `const`成员函数由成员`const`函数的参数列表后面的后缀表示。带有`const`后缀的成员函数称为“const 成员函数”或“检查器”。没有`const`后缀的成员函数称为“非常量成员函数”或“mutators”。</p>
> 
> ```
> class Fred {
> public:
>   void inspect() const;   // This member promises NOT to change *this
>   void mutate();          // This member function might change *this
> };
> void userCode(Fred& changeable, const Fred& unchangeable)
> {
>   changeable.inspect();   // Okay: doesn't change a changeable object
>   changeable.mutate();    // Okay: changes a changeable object
>   unchangeable.inspect(); // Okay: doesn't change an unchangeable object
>   unchangeable.mutate();  // ERROR: attempt to change unchangeable object
> } 
> ```
> 
> 调用尝试`unchangeable.mutate()`是在编译时捕获的错误。没有运行时空间或速度损失`const`，并且您不需要编写测试用例来在运行时检查它。
> 
> `const`成员函数的结尾`inspect()`应该用来表示该方法不会改变对象的*抽象*（客户端可见）状态。这与说该方法不会更改对象结构的“原始位”略有不同。C++ 编译器不允许采用“按位”解释，除非它们能够解决通常无法解决的别名问题（即，可能存在可能修改对象状态的非常量别名）。这个别名问题的另一个（重要）见解：用指向常量的指针指向一个对象并不能保证该对象不会改变；它只是保证对象不会*通过那个指针*改变。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-14T15:14:18.153

在`const`对象中只能`const`调用方法。这种方法的所有领域都被视为`const`领域。最后一期有奇怪的效果：

*   指针变为 const 指针`int* const`，这与指向 const 的指针不同`const int*`。因此，您可以更改指针指向的对象，但不能使指针指向另一个对象。
*   引用应该成为一个常量引用，但它始终是一个常量引用：你不能将它重新初始化到另一个对象。但是您可以再次更改引用所指的对象。

# user-interface - 使用 MFC 创建 GUI

> ID：751685
> 
> 赞同：8
> 
> 时间：2009-04-15T13:28:31.037
> 
> 标签：user-interface, mfc

最近开始学习MFC（Prosise book），感觉很难。但最困难的部分似乎是关于创建用户界面。似乎您必须知道控件应位于的位置（基于对话框的应用程序并非如此）。

你怎么解决这个问题？您是否首先在 Photoshop 中绘制应用程序，然后测量那里的距离？

而且，是否有任何图形用户界面设计器？（减轻疼痛）。我非常喜欢它，特别是因为它的速度和它不需要大框架的事实。

欢迎经常做 MFC 编程的人给我建议，教我如何擅长 MFC 编程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T13:58:53.443

MFC 很简单，只要你保持它应该做的事情的界限（基本的 Doc/View、对话框、没有花哨的糖果 UI……）；一旦你需要扩展基本行为，它就会变得越来越难。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T13:44:29.623

我不得不同意，对于 MFC 工作，作为 Visual Studio 一部分的资源编辑器可能是使用 MFC 的最简单方法。您可以将控件放在对话框上并将它们拉伸到适当的比例。作为记录，MFC*是*一个框架，只是它作为 Windows 的一部分捆绑在一起。

如果您希望控件调整大小，则需要添加一些代码来处理调整对话框大小时传递的调整大小（我认为是 ON_SIZE）消息。只要您不想一次调整太多东西的大小/重新定位，这还不错。

就个人而言，我建议避免使用 MFC 来支持[WxWidgets](http://www.wxwidgets.org/)。有一些很棒的 GUI 布局程序，例如[wxDesigner](http://www.roebling.de/)，它可以使创建可调整大小的对话框和属性页变得相当轻松。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T13:36:37.177

MFC 是一种痛苦，IMO。除非您需要使用 c++ 进行编程，否则我建议您将 C# 与 WPF 或 WinForms 一起使用。这要容易得多。如果你需要使用 c++，还有更好的 GUI 解决方案，比如 Qt。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-18T04:42:03.350

我已经使用 MFC 超过 10 年了。它还不错，只要您对在其他平台上运行您的应用程序不感兴趣，我会推荐它而不是其他非 Microsoft 框架。如果您希望您的应用程序看起来像一个对话框，请使用 Aardvark 建议的 CFormView 并使用对话框编辑器对其进行布局。在我的许多 MFC 程序中，视图是 CListViews 或类似资源管理器的应用程序，左侧是树，右侧是 ListView。我们经常使用的另一个是带有选项卡控件和属性页的通用 CView。在那些中，您没有布局问题。您只需创建控件并将它们放置在距边缘某个预定义距离处。散文非常好。这就是让我继续使用 MFC 的原因。查看 CodeProject.com 了解一些扩展 MFC 的类，例如，调整对话框和属性表的大小。布赖恩

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-15T14:01:20.847

MFC 应用程序可能会变得非常臃肿（例如，应用程序的可执行文件大小、内存占用和/或需要与您的应用程序一起使用的运行时 DLL）。如果您专注于 C++，我建议您改用[WTL](http://wtl.sourceforge.net/)（以前是 Microsoft 库，但现在在 SourceForge 上）。它是具有类似语法的 MFC 的一个非常轻量级的替代方案（使用模板）。

最近我已经为我的大多数应用程序（包括 GUI）放弃了 C++ for Java，而且我不打算回去。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-15T13:37:45.757

一个典型的 MFC 应用程序有一个顶级框架窗口和一些子视图窗口和控制栏。这些东西通常都不需要手动定位，尽管您有时需要在构建过程中指定初始大小。您可以使用 Visual Studio 的对话框编辑器来布局对话框。必须手动编写定位代码应该很少见。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-15T13:44:39.763

您使用的是哪个版本的 Visual C++？我使用的所有版本都带有一个非常好的图形工具，用于放置和编辑 GUI 组件。我通常添加所需的基本组件，为它们编写一些代码以查看它们的外观，然后在我确定一个并添加其他组件之前尝试不同的布局来移动东西。

尽管我多年来一直在断断续续地编写 MFC 应用程序并且非常喜欢它，但我不得不同意发帖人的意见，他问你为什么要费心学习。这些天你可能会更好地利用你的时间学习 C# 或 Java。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-15T14:16:10.267

如果您希望 MFC 应用程序中对话框的布局功能从**CFormView**派生 CView 类。这应该看起来很像 .NET WinForms、VB6 等基于“表单”的 GUI...

这可以通过新应用程序向导在 Generated Classes 的 Base Class 下拉部分下完成（我在 VS 2008 上检查过）。

您也可以只创建一个基于对话框的应用程序——您似乎已经很熟悉了。

还有几个其他的 CView 派生类提供了其他方法来设计应用程序的“视图”。使用默认 CView 作为基类（向导默认创建）假设您将手动创建“控件”和/或*绘制*屏幕。绘画（实际上是使用 GDI 绘制显示）是老式 Win32 开发人员熟悉的东西，但在更现代的框架中通常从未做过。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-15T13:36:26.850

很多时候，您使用对话框资源编辑器和数据绑定在 MFC 中创建 UI（您可以拥有基于对话框的视图）。如果您不创建对话框，那么通常您会考虑一些用于控件布局的算法，并实现它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-01-21T18:37:56.437

您可以使用 MFC 获得出色的结果，而无需添加任何其他框架。这是我创建的实用程序的[示例。](http://wificredentials.com/elements.html)

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-11-25T21:21:06.040

在 GUI 中使用 QT。我相信你会喜欢它............

# jquery - 只能在贪婪的droppable上拖放一次

> ID：751688
> 
> 赞同：1
> 
> 时间：2009-04-15T13:28:57.727
> 
> 标签：jquery, jquery-ui

我有两个在屏幕上非常接近的可放置 div（注意：它们不是嵌套的）。两个div上面拖了一个大的可拖动div；当鼠标被释放时，draggable 恰好落在**两个**可放置的div 上（即触发了两个可放置的事件）。

我想要发生的是，在这种情况下，可拖动对象将**仅落在一个**可放置对象上，而不会落在另一个上。顺序根本不重要。

这样做的最佳方法是什么？

我想到的一种低效方法是跟踪所有可丢弃的事件时间戳，如果可丢弃事件的时间戳之前已经存储在某个数组中，则拒绝该事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T15:20:12.827

您可以在可放置元素上使用“数据”方法来存储对它们迄今为止接受的可拖动元素的引用。因此，例如，您可以执行以下操作：

```
<script language="javascript">
$(function() {
    $('.droppable').droppable({
        greedy:true,
        [...other:options],
        over: function(event,ui) {
            var already_dragged = $(this).data('mysite.dropped_items');
            if($.inArray(ui.draggable.id,already_dragged) >= 0) {
                $(this).droppable('disable');
            }
        },
        out: function(event,ui) {
            $(this).droppable('enable');
        },
        drop: function(event,ui) {
            var already_dragged = $(this).data('mysite.dropped_items');
            if($.inArray(ui.draggable.id,already_dragged) < 0) {
                already_dragged.push(ui.draggable.id);
                $(this).data('mysite.dropped_items',already_dragged);
            }
        }
    }).data('mysite.dropped_items',new Array());
});
</script>

<div id="droppable1" class="droppable"></div>
<div id="droppable2" class="droppable"></div>
<div id="draggable_1" class="draggable"></div> 
```

**本质上，这是在做什么......**

我们使用 jQuery 数据对象将一个名为 'mysite.dropped_items' 的数组附加到每个 $('.droppable') 元素。每次将可拖动对象悬停在其中一个可放置对象上时，系统都会检查该可放置对象的 id 是否已在其“mysite.dropped_items”数组中。如果是，则 droppable 将被禁用。如果不是，一切都会按预期进行。

我还没有测试过这个确切的代码块，但理论上它应该可以工作。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T09:45:33.887

我能够以稍微不同的方式解决我的问题。让我先回顾一下我的情况：

1.  我有两个在屏幕上非常接近的可放置 div 对象
2.  我有一个可拖动的 div，它没有唯一的 ID。这个可拖动的可以一次又一次地放在我的 droppables 上（即它不会被消耗，如果这有任何意义的话）
3.  当一个可拖动对象位于两个可放置对象之上时，当前的 jquery 行为是可拖动对象将同时命中两个可放置对象。这对我来说是一个不受欢迎的效果。
4.  我的预期行为：draggable 应该只落在第一个 droppable 上，并且不应该被周围的任何其他后续 droppable 触发。

    var tsArray = new Array();

    $('.droppable').droppable({ drop : function() {

    ```
    for (var i = 0; i < tsArray.length; i++) {
        if (tsArray[i] + 150 > ev.timeStamp) {
            return;
        } 
    }

    tsArray.length = 0; // Empty it for performance
    tsArray.push(ev.timeStamp);

    // Do any logic you require here 
    ```

    });

基本思想是，当一个可拖动对象被拖放到两个可拖放对象上时，每个可拖放事件的事件时间戳非常接近。它们相隔几毫秒。我只是进行检查以确保它们之间存在很大的时间差。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T18:20:44.593

您可以简单地在您的 droppable 中的 OVER、OUT 事件中指定，以禁用其他 droppables。

比如让我们说 drop1 和 drop2 在 DOM 上是不相关的，但在彼此之上，并且你将 drag1 放到它们上面。您可以简单地访问 drop1 的 OVER、OUT、功能（如果这是优先的）并执行 OVER：禁用 drop2，OUT：启用 drop2

伪代码，但我想你会知道它在 jquery 中是如何工作的。

# java - 如何将java应用程序嵌入到jsp页面中

> ID：751693
> 
> 赞同：0
> 
> 时间：2009-04-15T13:29:58.130
> 
> 标签：java, jsp

我有一个简单的 java 应用程序，想将它嵌入到一个 jsp 页面中。在命令行接受参数的那一刻，是否可以从网页传递参数，如果可以，如何？

谢谢

〜凯尔G

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:36:27.943

目前尚不清楚你是否想把它做成一个小程序（我猜你是这样做的）。

如果是这样，[Sun 的 applet 教程](http://java.sun.com/docs/books/tutorial/deployment/applet/getStarted.html)中有一个关于将应用程序转换为 applet 的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:39:27.217

这应该是您的小应用程序的链接：

> www.yourpage.com/index.jsp?item=myitem

在您的 index.jsp 中，您可以通过以下方式获取它：

```
...
This is the item passed by GET:
<%= request.getParameter("item") 
//your code here
%>
... 
```

# .net - 选择哪个验证框架：Spring Validation 或 Validation Application Block (Enterprise LIbrary 4.0)？

> ID：751700
> 
> 赞同：7
> 
> 时间：2009-04-15T13:30:55.633
> 
> 标签：.net, validation, frameworks, validation-application-bl

我正在尝试为主要应用程序选择一个验证框架，虽然这两个选项看起来都很诱人，但我想知道在选择其中一个之前我应该​​注意哪些特定的优缺点。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T20:05:32.710

在我看来，使用属性进行验证并不是最好的解决方案。首先，您必须在域模型中引用基础设施。其次，您没有任何机会向已编译的类添加验证。最后，您无法使用属性验证复杂的逻辑，您必须对实体使用 Validate 方法，这看起来很尴尬。

在我看来，验证应该分开到不同的对象。例如，您可以将验证定义为规则的 IValidator。使用像[xVal](http://xval.codeplex.com/)这样的框架有助于使用 JavaScript 在表示层中进行验证。

您可能想寻找 .NET 的[xVal](http://xval.codeplex.com/)和[FluentValidation](http://fluentvalidation.codeplex.com/)。[NHibernate Validator](http://nhforge.org/media/p/7.aspx) 1.2 alpha 也具有流畅的语法，并且与 xVal 集成（不确定 alpha，但 1.0 应该是）。

企业验证块也几乎没有负面影响。我的实体的属性最终有 3 行属性，使可读性更差。尝试使用 AND 或 OR 运算符添加验证也很痛苦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T19:24:52.170

我在 Enterprise Library 块中发现的一件事是它可以强制您使用您不想要/不需要的其他块。例如，验证可能使用日志记录块，但您对自己的日志记录系统感到满意。现在您的应用程序以不同的方式记录事物。也就是说，我喜欢 Ent Lib 中的 Validation 块的外观。我还没有玩过 Spring.NET。

# java - Java Applet 对某些用户来说启动很慢？

> ID：751701
> 
> 赞同：0
> 
> 时间：2009-04-15T13:31:00.890
> 
> 标签：java, applet, performance, startup, freeze

[更新：我忘了添加这 30 秒。冻结问题仅在我第一次尝试从服务器加载文件时发生。随后的加载非常快。也许是一些奇怪的反向 DNS 查找？我在 Google 的 appengine 上托管。]

我最近开始了一个名为[http://www.chartle.net](http://www.chartle.net)的小项目，它是围绕一个小程序构建的。

启动时间是影响小程序用户体验的一个重要因素。我收集统计数据并惊讶地发现我经常很长的启动时间（比必要的高 50 到 100 倍）

小程序在 1-3 秒内启动，具体取决于您的计算机和连接速度。对于某些用户来说，它仍然需要长达 100 秒。

我自己的测试结果好坏参半。大多数情况下它非常快，但有时会冻结浏览器很长时间，Java 控制台没有告诉我原因。最好的猜测是，加载保存的图表时它会停止。

请帮助我解决这个问题 - 通过打开已保存的图表来进行最佳测试（单击[http://www.chartle.net/gallery](http://www.chartle.net/gallery)上的“创建”链接之一）

干杯，迪特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T13:49:33.573

这是通用帮助，而不是特定于您的演示（在几次尝试中加载对我来说很好）。

**冻结小程序**

在 JDK bin 目录中有一个非常方便的程序，叫做[jstack](http://java.sun.com/javase/6/docs/technotes/tools/share/jstack.html)。刷新浏览器窗口，直到它崩溃，然后运行：

```
jstack *process_id* 
```

这将为您提供任何冻结的 Java 进程的堆栈跟踪。如果 Java 不是一个单独的进程，那么您可以使用浏览器的进程（例如，对于 Opera）。

以下几个问题对我来说很常见：

1.  我建议您在 init 方法上使用 invokeLater 而不是 invokeAndWait（尽管如果您使用 start/stop 方法则不能这样做）
2.  Opera 的自定义 java 插件表现很差......
3.  同步块和invokeAndWait 引起的死锁

**慢速小程序**

可能浏览器正在从服务器获取资源，无法使用 jar 文件？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:12:30.383

可能只有旧插件会导致这些问题。这意味着基本上所有在 OSX 上运行的人以及在 1.6_update_10 之前使用 Java 的其他用户。

所以，我非常感谢有这种设置的人观看他们的 Java 控制台并描述第一次启动行为。

干杯，迪特

# html - 在输入中按下输入时如何防止 WebKit 浏览器提交表单

> ID：751702
> 
> 赞同：0
> 
> 时间：2009-04-15T13:31:38.220
> 
> 标签：html, safari, google-chrome, webkit, submit

当使用具有许多文本输入的表单时，WebKit/Safari/Google Chrome 会在任何输入元素中按下“输入”时提交表单。即使没有提交输入元素并且没有注册*onclick*处理程序。

例如，请参阅此示例代码：

```
<html>
    <body>
        <form method="POST" action=".">
            <ul>
                <li><input type="text" name="foo" value="<?=rand()?>"/></li>
                <li><input type="text" name="bar" value="<?=$_POST['foo']?>"/></li>
            </ul>
        </form>
    </body>
</html> 
```

在两个文本输入元素中的任何一个中按 Enter 键时，将提交表单。

由于我在 JavaScript 中使用异步 HTTP 请求处理表单，因此我需要防止这种行为。*我可以为keypressed*事件注册一个自定义处理程序来*preventDefault*和*stopPropagation*。但是当动态添加新的文本输入元素时，它看起来很丑陋，而且并不实用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T13:40:05.843

监听`onsubmit`表单上的事件并返回`false`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T14:25:02.787

如果您不想提交表单，请不要包含 <form> 元素。包含独立的表单字段元素是有效的。

```
value="<?=$_POST['foo']?>" 
```

XSS 漏洞。您需要 htmlspecialchars() 所有文本到 HTML 输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-25T11:26:19.010

Daniel A. White 是对的，但由于我对答案有点困惑，也许应该明确说明 return false 应该在事件上：

```
function goWithSubmit(e)
{
  if (e) e.returnValue=false;
} 
```

# javascript - JavaScript 原型函数没有覆盖原始函数

> ID：751704
> 
> 赞同：7
> 
> 时间：2009-04-15T13:31:45.787
> 
> 标签：javascript, prototype

当我遇到原型的概念时学习 javascript。我成功地向**cat**类添加了新方法，但未能覆盖原来的**talk**方法。

```
function cat(name) {
    this.name = name;
    this.talk = function() {
        alert( this.name + " : I'm a girl!" )
    }
}

cat.prototype.talk = function() {
    alert( this.name + " : I'm a dude!" )
}

cat1 = new cat("felix")
cat1.talk() 
```

为什么这不会提醒新文本？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-15T13:59:15.407

'function cat' 只是一个函数。它的原型是一个空对象 ({})。可以调用“新猫”将成员“姓名”和“谈话”添加到新对象。在这个新对象下面是函数原型，它仍然是 {}。

```
var c= new cat('Tiddles');

c ownProperties: { 'name': 'Tiddles', 'talk': function() {...} }
c inherited: {} 
```

现在，当您写入“cat.prototype.talk”时，您正在向该底层对象添加成员：

```
c ownProperties: { 'name': 'Tiddles', 'talk': function() {...} }
c inherited: { 'talk': function() {...} } 
```

直接在实例'c'上设置的'talk'函数优先于在c的构造函数原型上间接设置的'talk'。

所以你在这里混合了两种继承风格，'this'-assigning 方法和'prototype' 方法。

向原型编写方法的好处是，您不会将相同成员的冗余副本复制到每个对象实例中；写入实例的优点是它解决了绑定方法的问题。您选择哪一个取决于您，但不要将两者混为一谈。如果你想走原型路线，只有 'name' 应该被写入 'this'，因为这是每个实例特有的唯一属性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T13:49:08.317

开头附加的函数附加到对象（每个实例1个函数）。另一个附加到原型（所有实例共享一个函数）。

对象级别的成员覆盖原型级别的成员。

# windows - 将 Windows Mono 运行时与应用程序捆绑在一起

> ID：751705
> 
> 赞同：8
> 
> 时间：2009-04-15T13:31:52.977
> 
> 标签：windows, mono

关于我之前关于[Windows 上的 Mono 的](https://stackoverflow.com/questions/751648/whats-the-point-of-mono-on-windows)问题，假设我针对 Windows Mono 运行时开发了一个应用程序，以便它也可以在 Linux、OSX 等上运行。为了使它更复杂，我使用 GTK# 所以我不必处理 WinForms。那么有没有一种简单的方法可以将 Windows Mono 运行时与我的 Windows 版本的应用程序捆绑在一起，以便一次安装所有这些？或者，这没有意义吗？一旦我针对 Windows Mono 运行时进行开发，它仍然可以针对 MS .NET 运行时运行吗？（我想我仍然需要安装 GTK#）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T13:48:20.537

简短的回答是肯定的。

编程时应该注意的事情是

1.  不使用平台 API
2.  不要硬编码目录和文件名分隔符，即不要硬编码文件路径，而是使用适当的类来获取路径分隔符然后连接名称。
3.  请记住，*nx 上的文件名区分大小写，而 Windows 上则不区分大小写。编程时不要引用与 log.txt 和 Log.txt 相同的文件，但要保持小。

除此之外，如果您在 *nx 系统上创建了 GTK# 应用程序，如果您安装了 GTK# 程序集，您将能够在 Windows 上运行它，反之亦然。

我自己做了这个，它按预期工作。我在 Windows 上找到 GTK# 的特定程序集 dll 版本时遇到了问题，这花了我几个小时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:50:20.120

通常，您可能只会在 Windows 上使用 .Net 运行时。.Net 的 GTK# 安装程序可从 Mono 的[下载页面](http://www.go-mono.com/mono-downloads/download.html "下载页面")获得。您的用户需要安装它，然后可以使用常规的 .Net 运行时运行您的应用程序。

# sql-server-2005 - T-SQL - 将记录选择为连接文本？

> ID：751708
> 
> 赞同：2
> 
> 时间：2009-04-15T13:32:31.633
> 
> 标签：sql-server-2005, triggers, concatenation

我正在尝试调查何时以及为什么在 SQL 2005 数据库中删除某些行。我已经开始构建一个触发器来在删除一行时记录一些信息。

当从某个表中删除行时，我的触发器被激活。我已将其设置为在删除发生时在另一个日志记录表中记录时间戳。我还想记录被删除的数据，但不想为每个字段和值编写代码而烦恼。

我知道当数据被删除时，它可以（暂时）在 SQL Server 的“已删除”表中看到。所以在删除之后，我可以“SELECT * FROM Deleted”并查看数据。我想把这个表的内容变成一个大的文本块，我可以把它保存到我的日志表中的一个文本字段中。

所以......简单来说，有没有一种方法可以获取一个或多个行的记录集并将其转换为单个字符串变量？全部在我的触发器中的 SQL 命令中？如果我可以包含列名，则可以加分。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:05:27.920

在触发器中工作时，我会远离任何运行时间过长的事情。这包括一些仅用于确定静态表布局的查询（因为您不想自己编写代码），因此您可以构建一个字符串。

我一直在做这类事情，但主要是使用存储过程参数。我使用的模板中有大部分内容。

创建此函数，将在引号内很好地显示列或显示 NULL：

```
CREATE FUNCTION [dbo].[QuoteNull]
(
     @InputStr      varchar(8000)  --value to pad
)
RETURNS
varchar(8000)
AS

/*
TEST WITH:
----------
PRINT '     dbo.QuoteNull(null)             ->'+dbo.QuoteNull(null)+'<-'
PRINT '     dbo.QuoteNull(''apple'')          ->'+dbo.QuoteNull('apple')+'<-'
PRINT '     dbo.QuoteNull(123)              ->'+dbo.QuoteNull(123)+'<-'
PRINT '     dbo.QuoteNull(GETDATE())        ->'+dbo.QuoteNull(GETDATE())+'<-'
PRINT '     dbo.QuoteNull(GETDATE())        ->'+dbo.QuoteNull(CONVERT(varchar(23),GETDATE(),121))+'<-'
*/

BEGIN
    RETURN COALESCE(''''+@InputStr+'''','null')
END

GO 
```

将此粘贴到您的代码中：

```
INSERT INTO YourLogTable
        (xxx,yyy,zzz,ColumnTextValue)
    SELECT
        xxx,yyy,zzz,'values:'
            +'  '+RTRIM('ColumnNameInt               ')+'='+dbo.QuoteNull(                    ColumnNameInt               )
            +', '+RTRIM('ColumnNameVarchar           ')+'='+dbo.QuoteNull(                    ColumnNameVarchar           )
            +', '+RTRIM('ColumnNameChar              ')+'='+dbo.QuoteNull(                    ColumnNameChar              )
            +', '+RTRIM('ColumnNameDate              ')+'='+dbo.QuoteNull(CONVERT(varchar(23),ColumnNameDate         ,121))
        FROM DELETED 
```

确保表中的每一列都有一行（如果有更多，请稍后删除多余的行），如果您想详细查看任何日期，请使用上面显示的转换。

运行此查询：

```
select sc.name 
    FROM syscolumns sc INNER JOIN sysobjects so ON sc.id = so.id 
    where UPPER(so.name)=UPPER('YourTableName') order by sc.colorder desc 
```

在 SQL Server Management Studio 中获取输出（在文本输出模式下），然后在列名称上执行 ALT-LEFT_Click-Drag 一个正方形，然后复制此基于列的选择。

返回到您的代码并按住 ALT 键并单击并在插入语句的左列中的完整“ColumnName...”值上拖动一个正方形并粘贴。如果您选择了列，它将仅替换该列，并且左右保持代码不变。对插入右侧的“ColumnName...”值执行相同的操作，您现在有了一个 INSERT，它将构建您想要的数据，但不会在触发器中浪费太多时间。

# asp.net - 当其中有不可序列化的对象时，如何找出 ASP.NET 会话的大小？

> ID：751710
> 
> 赞同：2
> 
> 时间：2009-04-15T13:32:40.933
> 
> 标签：asp.net, session, size

我有一种感觉，我在我的 ASP.NET 会话中放入了相当多的数据，但我不知道有多少以及是否应该担心。我发现了一个[类似的问题](https://stackoverflow.com/questions/198082/how-to-find-out-size-of-session-in-aspnet-from-web-application)，但这依赖于序列化对象并检查它们的序列化大小。在我的情况下，会话中的大部分数据都在来自另一个库的对象中，该库没有将其类标记为“Serializable”。（我知道这限制了我使用 InProc 会话状态提供程序，但这是另一个问题）。有没有人知道如何遍历对象图并找出它的大小？

**补充：**好的，一种方法是手动遍历对象图和使用 Marshal.SizeOf() 方法。但要让它发挥作用，需要大量的写作。是否有更简单的方法可以达到相同的效果？我的目标不是字节精度，我对数量级感兴趣（千字节、兆字节、数十兆字节......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:50:10.760

你不能生成一个堆转储并从中找到会话的大小。[在 java 中，我可以转储堆，然后在mat](http://www.eclipse.org/mat/)中打开它，找到会话对象并找出子图的大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:04:15.333

对于测试，您可以组合一个存根自定义会话提供程序，实现 SessionStateStoreProviderBase 抽象类。我会编写将所有内容存储在 WebCache 中的支持字段（以便管理会话数据），并最终在调用 SetAndReleaseItemExclusive 方法时使用 Marshal.SizeOf() 方法生成统计信息。

```
 public override void SetAndReleaseItemExclusive(HttpContext context, string id, SessionStateStoreData item, object lockId, bool newItem)
        {

        double MemSize = 0;
        foreach (object sessObj in item.Items)
        {
            MemSize += Marshal.SizeOf(sessObj);
        }

} 
```

有关获取字段大小的更多信息，请参阅此问题： [Getting the size of a field in bytes with C#](https://stackoverflow.com/questions/207592/getting-the-size-of-a-field-in-bytes-with-c)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-15T13:51:25.567

您可能可以将会话状态信息存储在数据库中并检查大小，但我不确定是否有任何工具可以让您查看和遍历对象图。

如果可能，再检查一次您的设计，看看您是否可以最大限度地减少会话中的信息。

# c# - DevExpress Microsoft Visual C#

> ID：751713
> 
> 赞同：3
> 
> 时间：2009-04-15T13:33:34.220
> 
> 标签：c#, .net, devexpress

有人熟悉 Microsoft Visual C# 中的 DevExpress 吗？

我的老板给了我学习的代码，这个代码有DevExpress 8.3的版本。我想在我的已经有 DevExpress 9.1 版本的笔记本电脑上打开这段代码 找到文件有问题吗？非常感谢！

问候 tinincute

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T13:48:18.413

DevExpress 有一个转换工具，位于开始 -> 所有程序 -> developerper .NET vx.x -> 工具 -> ProjectConvertor

这应该够了吧

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T13:37:50.343

如果你只想看代码，应该没问题。

对于编译，您必须将项目转换为使用 DevExpress 9.1。您可以使用 DevExpress 工具升级或手动删除和添加引用以使用 9.1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-06T20:35:51.177

是的，您可以使用 devexpress 9.1 中的项目转换器并将旧版本转换为新版本。可能您会遇到一些折旧方法的问题，但不会那么多。

# sql - SQL Server - 参数名称中的无效字符

> ID：751719
> 
> 赞同：15
> 
> 时间：2009-04-15T13:35:15.030
> 
> 标签：sql, sql-server, parameters

我需要知道在 SQL 参数名称中使用的有效字符是什么。

给定一些简单的东西，例如`SELECT * FROM tblTest WHERE testid = @[X]`，如果 X 包含一个连字符，则该语句将失败。参数名称的有效字符是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-15T14:03:42.543

在您的在线 SQL 书籍中搜索“标识符”，您应该会找到：

**常规标识符规则**

> 常规标识符的格式规则取决于数据库兼容级别。可以使用 sp_dbcmptlevel 设置此级别。当兼容级别为 90 时，适用以下规则：
> 
> 第一个字符必须是以下之一：
> 
> *   Unicode 标准 3.2 定义的字母。字母的 Unicode 定义包括从 a 到 z、
>     从 A 到 Z 的拉丁字符，以及来自其他语言的字母字符。
> *   下划线 (_)、at 符号 (@) 或数字符号 (#)。
> 
> 标识符开头的某些符号在 SQL Server 中具有特殊含义。以 at 符号开头的常规标识符始终表示局部变量或参数，不能用作任何其他类型对象的名称。以数字符号开头的标识符表示临时表或过程。以双数字符号 (##) 开头的标识符表示全局临时对象。尽管可以使用数字符号或双数字符号字符来开始其他类型对象的名称，但我们不推荐这种做法。
> 
> 某些 Transact-SQL 函数的名称以双 at 符号 (@@) 开头。为避免与这些函数混淆，您不应使用以@@ 开头的名称。
> 
> 后续字符可以包括以下内容：
> 
> *   Unicode 标准 3.2 中定义的字母。
> *   来自基本拉丁文或其他国家文字的十进制数字。
> *   at 符号、美元符号 ($)、数字符号或下划线。
> 
> 标识符不能是 Transact-SQL 保留字。SQL Server 保留保留字的大写和小写版本。不允许嵌入空格或特殊字符。不允许使用补充字符。

在您的在线 SQL 书籍中搜索“分隔标识符”，您应该会找到：

> 标识符的主体可以包含当前代码页中的任意字符组合，但分隔字符本身除外。例如，分隔标识符可以包含空格、对常规标识符有效的任何字符以及以下任何一个字符。
> 
> ```
> tilde (~)                hyphen (-)   
> exclamation point (!)    left brace ({)   
> percent (%)              right brace (})   
> caret (^)                apostrophe (')   
> ampersand (&)            period (.)   
> left parenthesis (()     backslash (\)   
> right parenthesis ())    accent grave (`) 
> ```

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:53:33.347

在联机丛书中搜索标识符 [SQL Server]。它具有参数名称必须遵循的规则。（这是SQL Server 2008的搜索），其他版本应该是类似的搜索

# java - 默认情况下如何将java Logger输出到文件

> ID：751736
> 
> 赞同：28
> 
> 时间：2009-04-15T13:39:00.247
> 
> 标签：java, logging, java.util.logging

Netbeans 仔细地将 Logger.getLogger(this.getClass().getName()).log(Level. [...] 语句洒到 catch 块中。现在我想将它们全部指向一个文件（和控制台）。

每个日志记录教程，只有我一个人告诉如何让特定的记录器输出到文件中，但我认为有比修复每个自动生成的日志语句更好的方法？为某种根记录器或其他东西设置处理程序？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-15T13:59:46.017

我只是在启动时添加以下内容

```
Handler handler = new FileHandler("test.log", LOG_SIZE, LOG_ROTATION_COUNT);
Logger.getLogger("").addHandler(handler); 
```

`LOG_SIZE`您可以为和指定自己的值`LOG_ROTATION_COUNT`

您可能需要调整日志记录级别以适应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T13:46:26.453

您必须在记录器配置文件中定义日志写入的位置。例如，如果您使用 log4j，则 log4j.xml（或 log4j.properties）文件将包含此类信息。

例如，这是一个简单的 log4j.xml 文件，它直接登录到文件 (my-app.log) 和控制台中：

```
<?xml version="1.0" encoding="UTF-8"?>
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">

    <appender name="rolling" class="org.apache.log4j.DailyRollingFileAppender">
        <param name="File" value="my-app.log" />
        <param name="DatePattern" value=".yyyy-MM-dd" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern"
                value="%d{yyyy-MM-dd HH:mm:ss} %-5p [%C] [IP=%X{ipAddress}] [user=%X{user}] %m%n" />
        </layout>
    </appender>

    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern"
                value="%d{yyyy-MM-dd HH:mm:ss} %-5p [%C] [user=%X{user}] %m%n" />
        </layout>
    </appender>

    <root>
        <priority value="info" />
        <appender-ref ref="console" />
        <appender-ref ref="rolling" />
    </root>

</log4j:configuration> 
```

# c# - WPF TextBlock highlight certain parts based on search condition

> ID：751741
> 
> 赞同：18
> 
> 时间：2009-04-15T13:40:14.080
> 
> 标签：c#, wpf, highlight, textblock

I have TextBlock that has Inlines dynamicly added to it (basically bunch of Run objects that are either italic or bold).

In my application I have search function.

I want to be able to highlight TextBlock's text that is in being searched for.

By highlighting I mean changing certain parts of TextBlock text's color (keeping in mind that it may highlight several different Run objects at a time).

I have tried this example [http://blogs.microsoft.co.il/blogs/tamir/archive/2008/05/12/search-and-highlight-any-text-on-wpf-rendered-page.aspx](http://blogs.microsoft.co.il/blogs/tamir/archive/2008/05/12/search-and-highlight-any-text-on-wpf-rendered-page.aspx)

But it seams very unstable :(

Is there easy way to solve this problem?

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-03-03T16:27:10.440

This question is similar to [How to display search results in a WPF items control with highlighted query terms](https://stackoverflow.com/questions/3728584/how-to-display-search-results-in-a-wpf-items-control-with-highlighted-query-terms)

In answer to that question, I came up with an approach that uses an IValueConverter. The converter takes a text snippet, formats it into valid XAML markup, and uses a XamlReader to instantiate the markup into framework objects.

The full explanation is rather long, so I've posted it to my blog: [Highlighting Query Terms in a WPF TextBlock](https://web.archive.org/web/20180308102102/http://underground.infovark.com/2011/03/03/highlighting-query-terms-in-a-wpf-textblock/)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-02-25T21:47:45.660

I took [dthrasers answer](https://stackoverflow.com/a/5183538/1767377) and took out the need for an XML parser. He does a great job explaining each of the pieces in [his blog](http://underground.infovark.com/2011/03/03/highlighting-query-terms-in-a-wpf-textblock/), However this didn't require me to add any extra libraries, here's how I did it.

Step one, make a converter class:

```
class StringToXamlConverter : IValueConverter
{

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        string input = value as string;
        if (input != null)
        {
            var textBlock = new TextBlock();
            textBlock.TextWrapping = TextWrapping.Wrap;
            string escapedXml = SecurityElement.Escape(input);

            while (escapedXml.IndexOf("|~S~|") != -1) {
            //up to |~S~| is normal
            textBlock.Inlines.Add(new Run(escapedXml.Substring(0, escapedXml.IndexOf("|~S~|"))));
            //between |~S~| and |~E~| is highlighted
            textBlock.Inlines.Add(new Run(escapedXml.Substring(escapedXml.IndexOf("|~S~|") + 5,
                                      escapedXml.IndexOf("|~E~|") - (escapedXml.IndexOf("|~S~|") + 5))) 
                                      { FontWeight = FontWeights.Bold, Background= Brushes.Yellow });
            //the rest of the string (after the |~E~|)
            escapedXml = escapedXml.Substring(escapedXml.IndexOf("|~E~|") + 5);
            }

            if (escapedXml.Length > 0)
            {
                textBlock.Inlines.Add(new Run(escapedXml));                      
            }
            return textBlock;
        }

        return null;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException("This converter cannot be used in two-way binding.");
    }

} 
```

Step two: Instead of a TextBlock use a ContentBlock. Pass in the string (you would of used for your textBlock) to the content block, like so:

```
<ContentControl Margin="7,0,0,0"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Content="{Binding Description, Converter={StaticResource CONVERTERS_StringToXaml}, Mode=OneTime}">
</ContentControl> 
```

Step three: Make sure the text you pass includes `|~S~|` before and `|~E~|` after the text part you want to be highlighted. For example in this string `"my text |~S~|is|~E~| good"` the `is` will be highlighted in yellow.

Notes:
You can change the style in the run to determine what and how your text is highlighted
Make sure you add your Converter class to your namespace and resources. This might also require a rebuild to get working.

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2020-03-01T11:55:59.623

## Differences to other solutions

*   easier to reuse -> attached behavior instead of custom control
*   MVVM friendly -> no code behind
*   works BOTH ways! -> Changing the term to be highlighted OR the text, both updates the highlight in the textblock. The other solutions i checked had the problem, that changing the text does not reapply the highlighting. Only changing the highlighted term/search text worked.

## How to use

*   IMPORTANT: do NOT use the regular `Text="blabla"` property of the TextBlock anymore. Instead bind your text to `HighlightTermBehavior.Text="blabla"`.
*   Add the attached properties to your TextBlock like that

```
<TextBlock local:HighlightTermBehavior.TermToBeHighlighted="{Binding MyTerm}"
           local:HighlightTermBehavior.Text="{Binding MyText}" /> 
```

or hardcoded

```
<TextBlock local:HighlightTermBehavior.TermToBeHighlighted="highlight this"
           local:HighlightTermBehavior.Text="bla highlight this bla" /> 
```

## Add this class

*   To change the kind of highlighting, just change these Methods:
    `AddPartToTextBlock()` for non highlighted text
    `AddHighlightedPartToTextBlock()` for the highlighted text.
*   At the moment highlighted is `FontWeights.ExtraBold` and non highlighted text is `FontWeights.Light`.
*   probably hard to read without an IDE, sorry.

```
public static class HighlightTermBehavior
{
    public static readonly DependencyProperty TextProperty = DependencyProperty.RegisterAttached(
        "Text",
        typeof(string),
        typeof(HighlightTermBehavior),
        new FrameworkPropertyMetadata("", OnTextChanged));

    public static string GetText(FrameworkElement frameworkElement)               => (string) frameworkElement.GetValue(TextProperty);
    public static void   SetText(FrameworkElement frameworkElement, string value) => frameworkElement.SetValue(TextProperty, value);

    public static readonly DependencyProperty TermToBeHighlightedProperty = DependencyProperty.RegisterAttached(
        "TermToBeHighlighted",
        typeof(string),
        typeof(HighlightTermBehavior),
        new FrameworkPropertyMetadata("", OnTextChanged));

    public static string GetTermToBeHighlighted(FrameworkElement frameworkElement)
    {
        return (string) frameworkElement.GetValue(TermToBeHighlightedProperty);
    }

    public static void SetTermToBeHighlighted(FrameworkElement frameworkElement, string value)
    {
        frameworkElement.SetValue(TermToBeHighlightedProperty, value);
    }

    private static void OnTextChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        if (d is TextBlock textBlock)
            SetTextBlockTextAndHighlightTerm(textBlock, GetText(textBlock), GetTermToBeHighlighted(textBlock));
    }

    private static void SetTextBlockTextAndHighlightTerm(TextBlock textBlock, string text, string termToBeHighlighted)
    {
        textBlock.Text = string.Empty;

        if (TextIsEmpty(text))
            return;

        if (TextIsNotContainingTermToBeHighlighted(text, termToBeHighlighted))
        {
            AddPartToTextBlock(textBlock, text);
            return;
        }

        var textParts = SplitTextIntoTermAndNotTermParts(text, termToBeHighlighted);

        foreach (var textPart in textParts)
            AddPartToTextBlockAndHighlightIfNecessary(textBlock, termToBeHighlighted, textPart);
    }

    private static bool TextIsEmpty(string text)
    {
        return text.Length == 0;
    }

    private static bool TextIsNotContainingTermToBeHighlighted(string text, string termToBeHighlighted)
    {
        return text.Contains(termToBeHighlighted, StringComparison.Ordinal) == false;
    }

    private static void AddPartToTextBlockAndHighlightIfNecessary(TextBlock textBlock, string termToBeHighlighted, string textPart)
    {
        if (textPart == termToBeHighlighted)
            AddHighlightedPartToTextBlock(textBlock, textPart);
        else
            AddPartToTextBlock(textBlock, textPart);
    }

    private static void AddPartToTextBlock(TextBlock textBlock, string part)
    {
        textBlock.Inlines.Add(new Run {Text = part, FontWeight = FontWeights.Light});
    }

    private static void AddHighlightedPartToTextBlock(TextBlock textBlock, string part)
    {
        textBlock.Inlines.Add(new Run {Text = part, FontWeight = FontWeights.ExtraBold});
    }

    public static List<string> SplitTextIntoTermAndNotTermParts(string text, string term)
    {
        if (text.IsNullOrEmpty())
            return new List<string>() {string.Empty};

        return Regex.Split(text, $@"({Regex.Escape(term)})")
                    .Where(p => p != string.Empty)
                    .ToList();
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-03-13T10:41:09.657

By strange coincidence, I have recently written an article that solves the very same problem. It is a custom control that has the same properties as a TextBlock (so you can swap is out for a `TextBlock` wherever you need it), and it has an extra Property that you can bind to called `HighLightText`, and wherever the value of `HighLightText` is found in the main `Text` property (case insensitive), it is highlighted.

It was a fairly straight-forward control to create, and you can find the article here:

[WPF TextBlock With Search String Matching](http://deanchalk.com/wpf-textblock-with-search-string-matching/)

And the full code as a solution here:

[SearchMatchTextblock(GitHub)](https://github.com/deanchalk/SearchMatchTextblock)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-13T17:05:02.887

I had a similar problem - trying to implement a text search over a load of presenters that basically represent a report. The report was originally written into a string and we were leveraging FlowDocumentViewer's built in `ctrl`-`F` - it's not very good and has some wierd options but was sufficient.

If you just want something like that you can do the following:

```
 <FlowDocumentScrollViewer>
            <FlowDocument>
                <Paragraph FontFamily="Lucida Console" FontSize="12">
                    <Run Text="{Binding Content, Mode=OneWay}"/>
                </Paragraph>
            </FlowDocument>
        </FlowDocumentScrollViewer> 
```

We decided to go for a rewrite as the report is kept in sync with the rest of the program and basically every edit changes it, having to recreate the entire report everytime means that this is quite slow. We wanted to improve this by moving to a update-the-bits-you-need-to model but needed to have view model (rather than just a string) to be able to do that in a sane way! We wanted to preserve the searching functionality before swapping out the report however and go one better and have highlighting of the 'current' search position in one colour and other search hits in another.

Here's a simplified version of my solution; a class that derives from `TextBlock` that adds a dependency property of Type `HighlightingInformation`. I've not included the namespace and usings as they are sensitive.

```
public class HighlightingTextBlock : TextBlock
{
    public static readonly DependencyProperty HighlightingProperty =
        DependencyProperty.Register("Highlighting", typeof (HighlightingInformation), typeof (HighlightingTextBlock));

    public HighlightingInformation Highlighting
    {
        get { return (HighlightingInformation)GetValue(HighlightingProperty); }
        set { SetValue(HighlightingProperty, value); }
    }

    public HighlightingTextBlock()
    {
        AddValueChangedCallBackTo(HighlightingProperty, UpdateText);
    }

    private void AddValueChangedCallBackTo(DependencyProperty property, Action updateAction)
    {
        var descriptor = DescriptorFor(property);
        descriptor.AddValueChanged(this, (src, args) => updateAction());
    }

    private DependencyPropertyDescriptor DescriptorFor(DependencyProperty property)
    {
        return DependencyPropertyDescriptor.FromProperty(property, GetType());
    }

    private void UpdateText()
    {
        var highlighting = Highlighting;
        if (highlighting == null)
            return;
        highlighting.SetUpdateMethod(UpdateText);

        var runs = highlighting.Runs;
        Inlines.Clear();
        Inlines.AddRange(runs);
    }
} 
```

The type this class can be bound to uses the update method when it's text and list of highlights are changed to update the list of Runs. The highlights themselves look something like this:

```
public class Highlight
{
    private readonly int _length;
    private readonly Brush _colour;

    public int Start { get; private set; }

    public Highlight(int start, int length,Brush colour)
    {
        Start = start;
        _length = length;
        _colour = colour;
    }

    private string TextFrom(string currentText)
    {
        return currentText.Substring(Start, _length);
    }

    public Run RunFrom(string currentText)
    {
        return new Run(TextFrom(currentText)){Background = _colour};
    }
} 
```

To produce the correct collection of highlights is a seperate problem, which I basically solved by treating the collection of presenters as a Tree that you recursively search for content - leaf nodes are those that have content and other nodes just have children. If you search depth-first you get the order you'd expect. You can then basically write a wrapper around the list of results to keep track of the position. Im not going to post all the code for this - my response here it is to document how you can make wpf do multi-coloured highlighting in MVP style.

I haven't used `INotifyPropertyChanged` or `CollectionChanged` here as we didn't need the changes to be multi-cast (eg one presenter has multiple views). Initially I tried to do that by adding an event changed notification for Text and one for a list (which you also have to manually subscribe to the `INotifyCollectionChanged` event on). I had concerns about memory leaks from the event subcriptions however and the fact that the updates for the text and the highlights didn't come at the same time made it problematic.

The one drawback of this approach is that people shouldn't bind to the Text property of this control. In the real version I have added some checking + exception throwing to stop people from doing this but ommitted it from the example for clarity's sake!

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-04-13T15:36:05.363

Here is what I came up with by building off of the exisiting `TextBlock` and adding a new dependency property named `SearchText`:

```
public class SearchHightlightTextBlock : TextBlock
{
    public SearchHightlightTextBlock() : base() { }

    public String SearchText { get { return (String)GetValue(SearchTextProperty); }
                               set { SetValue(SearchTextProperty, value); } }      

    private static void OnDataChanged(DependencyObject source,
                                      DependencyPropertyChangedEventArgs e)
    {
        TextBlock tb = (TextBlock)source;

        if (tb.Text.Length == 0)
            return;

        string textUpper = tb.Text.ToUpper();
        String toFind = ((String) e.NewValue).ToUpper();
        int firstIndex = textUpper.IndexOf(toFind);
        String firstStr = tb.Text.Substring(0, firstIndex);
        String foundStr = tb.Text.Substring(firstIndex, toFind.Length);
        String endStr = tb.Text.Substring(firstIndex + toFind.Length, 
                                         tb.Text.Length - (firstIndex + toFind.Length));

        tb.Inlines.Clear();
        var run = new Run();
        run.Text = firstStr;
        tb.Inlines.Add(run);
        run = new Run();
        run.Background = Brushes.Yellow;
        run.Text = foundStr;
        tb.Inlines.Add(run);
        run = new Run();
        run.Text = endStr;

        tb.Inlines.Add(run);
    }

    public static readonly DependencyProperty SearchTextProperty =
        DependencyProperty.Register("SearchText", 
                                    typeof(String), 
                                    typeof(SearchHightlightTextBlock), 
                                    new FrameworkPropertyMetadata(null, OnDataChanged));
} 
```

And in your view, this:

```
<view:SearchHightlightTextBlock SearchText="{Binding TextPropertyContainingTextToSearch}" 
                                Text="{Binding YourTextProperty}"/> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-08T04:18:50.030

Here I present another Approach for highlighting text. I had a use case where I needed to decorate a bunch of C# Code in WPF, however I did not want to use textBlock.Inlines.Add type of syntax, instead I wanted to generate the highlighting XAML on the fly and then dynamically add it to a Canvas or some other container in WPF.

So suppose you want to colorize the following piece of code and also highlight a part of it:

```
public static void TestLoop(int count)
{ 
   for(int i=0;i<count;i++)
     Console.WriteLine(i);
} 
```

Suppose the above code is found in a file called Test.txt . Suppose you want to colorize all the C# keywords (public, static, void etc..) and simple types(int, string) in Blue, and Console.WriteLine highlight in yellow.

Step 0\. Create a new WPF Application and include some sample code similar to above in a file called Test.txt

Step 1\. Create a Code Highlighter class:

```
using System.IO;
using System.Text;

public enum HighLightType
{
    Type = 0,
    Keyword = 1,
    CustomTerm = 2
}

public class CodeHighlighter
{
    public static string[] KeyWords = { "public", "static", "void", "return", "while", "for", "if" };
    public static string[] Types = { "string", "int", "double", "long" };

    private string FormatCodeInXaml(string code, bool withLineBreak)
    {
        string[] mapAr = { "<","&lt;" , //Replace less than sign
                            ">","&gt;" }; //Replace greater than sign
        StringBuilder sb = new StringBuilder();

        using (StreamReader sr = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(code))))
        {
            while (!sr.EndOfStream)
            {
                string line = sr.ReadLine();

                line = line.Replace("\t", "&#160;&#160;&#160;&#160;"); //Replace tabs
                line = line.Replace(" ", "&#160;"); //Replace spaces

                for (int i = 0; i < mapAr.Length; i += 2)
                    line = line.Replace(mapAr[i], mapAr[i + 1]);

                if (withLineBreak)
                    sb.AppendLine(line + "<LineBreak/>"); //Replace line breaks
                else
                    sb.AppendLine(line);
            }

        }
        return sb.ToString();
    }

    private string BuildForegroundTag(string highlightText, string color)
    {
        return "<Span Foreground=\"" + color + "\">" + highlightText + "</Span>";
    }

    private string BuildBackgroundTag(string highlightText, string color)
    {
        return "<Span Background=\"" + color + "\">" + highlightText + "</Span>";
    }

    private string HighlightTerm(HighLightType type, string term, string line)
    {
        if (term == string.Empty)
            return line;

        string keywordColor = "Blue";
        string typeColor = "Blue";
        string statementColor = "Yellow";

        if (type == HighLightType.Type)
            return line.Replace(term, BuildForegroundTag(term, typeColor));
        if (type == HighLightType.Keyword)
            return line.Replace(term, BuildForegroundTag(term, keywordColor));
        if (type == HighLightType.CustomTerm)
            return line.Replace(term, BuildBackgroundTag(term, statementColor));

        return line;
    }

    public string ApplyHighlights(string code, string customTerm)
    {
        code = FormatCodeInXaml(code, true);
        customTerm = FormatCodeInXaml(customTerm, false).Trim();

        StringBuilder sb = new StringBuilder();
        using (StreamReader sr = new StreamReader(new MemoryStream(Encoding.UTF8.GetBytes(code))))
        {
            while (!sr.EndOfStream)
            {
                string line = sr.ReadLine();

                line = HighlightTerm(HighLightType.CustomTerm, customTerm, line);

                foreach (string keyWord in KeyWords)
                    line = HighlightTerm(HighLightType.Keyword, keyWord, line);

                foreach (string type in Types)
                    line = HighlightTerm(HighLightType.Type, type, line);

                sb.AppendLine(line);
            }
        }

        return sb.ToString();

    }
} 
```

Step 2\. Add a Canvas XAML tag to your MainWindow.xaml

```
<Window x:Class="TestCodeVisualizer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TestCodeVisualizer"
        mc:Ignorable="d"
        Title="MainWindow" Height="350" Width="525">

    <Canvas Name="canvas" />
</Window> 
```

Step 3\. In Your WPF Application add the following code: (make sure that test.txt is in the correct location) :

```
using System.Text;
using System.IO;
using System.Windows;
using System.Windows.Markup;

namespace TestCodeVisualizer
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            string testText = File.ReadAllText("Test.txt");
            FrameworkElement fe = GenerateHighlightedTextBlock(testText, "Console.WriteLine");
            this.canvas.Children.Add(fe);
        }

        private FrameworkElement GenerateHighlightedTextBlock(string code, string term)
        {
            CodeHighlighter ch = new CodeHighlighter();
            string uc = "<UserControl xmlns='http://schemas.microsoft.com/winfx/2006/xaml/presentation' xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml'>[CONTENT]</UserControl>";

            string content = "<TextBlock>" + ch.ApplyHighlights(code, term) + "</TextBlock>";
            uc = uc.Replace("[CONTENT]", content);

            FrameworkElement fe = XamlReader.Load(new System.IO.MemoryStream(Encoding.UTF8.GetBytes(uc))) as FrameworkElement;
            return fe;
        }

    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-16T11:07:57.973

Ended up writing following code

At moment has few bugs, but solves the problem

```
if (Main.IsFullTextSearch)
{
    for (int i = 0; i < runs.Count; i++)
    {
        if (runs[i] is Run)
        {
            Run originalRun = (Run)runs[i];

            if (Main.SearchCondition != null && originalRun.Text.ToLower()
                .Contains(Main.SearchCondition.ToLower()))
            {
                int pos = originalRun.Text.ToLower()
                          .IndexOf(Main.SearchCondition.ToLower());

                if (pos > 0)
                {
                    Run preRun = CloneRun(originalRun);
                    Run postRun = CloneRun(originalRun);

                    preRun.Text = originalRun.Text.Substring(0, pos);
                    postRun.Text = originalRun.Text
                        .Substring(pos + Main.SearchCondition.Length);

                    runs.Insert(i - 1 < 0 ? 0 : i - 1, preRun);
                    runs.Insert(i + 1, new Run(" "));
                    runs.Insert(i + 2, postRun);

                    originalRun.Text = originalRun.Text
                        .Substring(pos, Main.SearchCondition.Length);

                    SolidColorBrush brush = new SolidColorBrush(Colors.Yellow);
                    originalRun.Background = brush;

                    i += 3;
                }
            }
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-14T18:32:04.870

If you are handling ContainerContentChanging for your ListViewBase, you can take the following approach: [TextBlock highlighting for WinRT/ContainerContentChanging](https://stackoverflow.com/a/33132820/703178)

Please note that this code is for Windows RT. The WPF syntax will be slightly different. Also note that if you are using binding to populate the TextBlock.Text property, the text generated by my approach will be overwritten. I use ContainerContentChanging to populate target fields because of radically-increased performance and improvements in memory usage, vs. normal binding. I use binding only to manage the source data, not the data view.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-06T19:18:09.663

The following highlight search method takes your **TextBlock** and **search term** then returns your block with this term or words which contain this term highlighted purple.

```
 private TextBlock HighlightSearch(TextBlock textBlock, string searchTerm)
    {
        string[] words = textBlock.Text.Split(' ');

        textBlock.Text = string.Empty; 

        foreach (string word in words)
        {
            if (!string.IsNullOrEmpty(searchTerm) &&
                word.IndexOf(searchTerm, StringComparison.OrdinalIgnoreCase) >= 0)
            {
                textBlock.Inlines.Add(new Run($"{word} ") { Foreground = Brushes.Purple, FontWeight = FontWeights.DemiBold });
            }
            else
            {
                textBlock.Inlines.Add($"{word} ");
            }
        }

        return textBlock; 
    } 
```

`

# php - 向一组变量添加条件格式和标点符号

> ID：751743
> 
> 赞同：1
> 
> 时间：2009-04-15T13:41:23.500
> 
> 标签：php, variables, formatting, conditional

我经常需要列出用逗号、空格或标点符号分隔的项目，地址是一个典型的例子（这对于地址来说是多余的，只是为了举例！）：

```
echo "L$level, $unit/$num $street, $suburb, $state $postcode, $country.";
//ouput: L2, 1/123 Cool St, Funky Town, ABC 2000, Australia. 
```

听起来很简单，有没有一种简单的方法可以“有条件地”仅在变量存在时在变量之间添加自定义分隔符？是否需要检查是否设置了每个变量？因此，使用上述内容，另一个细节较少的地址可能会输出如下内容：

```
//L, / Cool St, , ABC , . 
```

一种稍微费力的检查方法是查看是否设置了每个变量并显示标点符号。

```
if($level){ echo "L$level, "; }
if($unit){ echo "$unit"; }
if($unit && $street){ echo "/"; }
if($street){ echo "$street, "; }
if($suburb){ echo "$suburb, "; }
//etc... 
```

最好有一个可以自动执行所有剥离/格式化等的功能：

```
somefunction("$unit/$num $street, $suburb, $state $postcode, $country."); 
```

* * *

另一个例子是一个简单的 csv 列表。我想输出以逗号分隔的 x 项：

```
for($i=0; $i=<5; $i++;){ echo "$i,"; }
//output: 1,2,3,4,5, 
```

例如，在循环中，确定数组的最后一项或满足循环条件以在列表末尾不包含逗号的最佳方法是什么？我读过的一个很长的方法是在一个项目*之前*放一个逗号，除了第一个条目，比如：

```
$firstItem = true; //first item shouldn't have comma
for($i=0; $i=<5; $i++;){
  if(!$firstItem){ echo ","; }
  echo "$i";
  $firstItem = false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T14:15:52.467

对于您的第一个示例，您可以将数组与一些数组方法结合使用来获得所需的结果。例如：

```
echo join(', ', array_filter(array("L$level", join(' ', array_filter(array(join('/', array_filter(array($unit, $num))), $street))), $suburb, join(' ', array_filter(array($state, $postcode))), $country))) . '.'; 
```

这个单行代码读起来相当复杂，所以总是可以将数组、array_filter 和 join 调用包装到一个单独的方法中，并使用它：

```
function merge($delimiter)
{
    $args = func_get_args();
    array_shift($args);
    return join($delimiter, array_filter($args));
}

echo merge(', ', "L$level", merge(' ', merge('/', $unit, $num), $street), $suburb, merge(' ', $state, $postcode), $country) . '.'; 
```

您需要调用 array_filter 来删除空条目，否则仍会打印出分隔符。

对于第二个示例，将项目添加到数组中，然后使用 join 插入分隔符：

```
$arr = array();
for($i=0; $i=<5; $i++)
{
    $arr[] = $i;
}
echo(join(',', $arr)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T13:56:33.090

[虽然 Phillip 的回答解决了您的问题，但我想用Eric Lippert](http://blogs.msdn.com/ericlippert/archive/2009/04/13/restating-the-problem.aspx)的以下博客文章来补充它。尽管他的讨论是在 c# 中进行的，但它适用于任何编程语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:02:56.193

您的第二个问题有一个简单的解决方案：

```
for($i=0; $i<=5; $i++)
    $o .= "$i,";
echo chop($o, ','); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T14:03:40.937

Philip 的解决方案在处理数组时可能是最好的（如果您不必过滤掉空值），但如果您不能使用数组函数——例如，在处理从返回的查询结果时——`mysqli_fetch_object()`那么一种解决方案只是一个简单的 if 语句：

```
$list = '';
$row=mysqli_fetch_object($result);
do {
    $list .= (empty($list) ? $row->col : ", {$row->col}");
} while ($row=mysqli_fetch_object($result)); 
```

或者，或者：

```
do {
    if (isset($list)) {
        $list .= ", {$row->col}";
    } else $list = $row->col;
} while ($row=mysqli_fetch_object($result)); 
```

要构建一个列表并过滤掉空值，我会编写一个自定义函数：

```
function makeList() {
    $args = array_filter(func_get_args()); // as per Jon Benedicto's answer
    foreach ($args as $item) {
        if (isset($list)) {
            $list .= ", $item";
        } else {
            $list = $item;
        }
    }
    if (isset($list)) {
        return $list;
    } else return '';
} 
```

然后你可以这样称呼它：

```
$unitnum = implode('/',array_filter(array($unit,$num)));
if ($unitnum || $street) {
    $streetaddress = trim("$unitnum $street");
} else $streetaddress = '';
if ($level) {
    $level = "L$level";
}
echo makeList($level, $streetaddress, $suburb, $state $postcode, $country).'.'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T17:03:22.673

好的，拿那个！（但不要太严重^^）

```
<?php

function bothOrSingle($left, $infix, $right) {
    return $left && $right ? $left . $infix . $right : ($left ? $left : ($right ? $right : null));
}

function leftOrNull($left, $postfix) {
    return $left ? $left . $postfix : null;
}

function rightOrNull($prefix, $right) {
    return $right ? $prefix . $right : null; 
}

function joinargs() {
    $args = func_get_args();
    foreach ($args as $key => $arg) 
        if (!trim($arg)) 
            unset($args[$key]);

    $sep = array_shift($args);
    return join($sep, $args);
}

$level    = 2;
$unit     = 1;
$num      = 123;
$street   = 'Cool St';
$suburb   = 'Funky Town';
$state    = 'ABC';
$postcode = 2000;
$country  = 'Australia';

echo "\n" . '"' . joinargs(', ', rightOrNull('L', $level), bothOrSingle(bothOrSingle($unit, '/', $num), ' ', $street), bothOrSingle($state, ' ', $postcode), bothOrSingle($country, '', '.')) . '"';

// -> "L2, 1/123 Cool St, ABC 2000, Australia."

$level    = '';
$unit     = '';
$num      = '';
$street   = 'Cool St';
$suburb   = '';
$state    = 'ABC';
$postcode = '';
$country  = '';

echo "\n" . '"' . joinargs(
    ', ', 
    leftOrNull(
        joinargs(', ', 
            rightOrNull('L', $level), 
            bothOrSingle(bothOrSingle($unit, '/', $num), ' ', $street), 
            bothOrSingle($state, ' ', $postcode), 
            $country
        ),
        '.'
    )
) . '"';

// -> "Cool St, ABC."

$level    = '';
$unit     = '';
$num      = '';
$street   = '';
$suburb   = '';
$state    = '';
$postcode = '';
$country  = '';

echo "\n" . '"' . joinargs(
    ', ', 
    leftOrNull(
        joinargs(', ', 
            rightOrNull('L', $level), 
            bothOrSingle(bothOrSingle($unit, '/', $num), ' ', $street), 
            bothOrSingle($state, ' ', $postcode), 
            $country
        ),
        '.'
    )
) . '"';

// -> "" (even without the dot!)

?> 
```

是的，我知道 - 看起来有点像brainfuck。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T13:52:19.323

我总是发现使用语言的数组方法既快速又容易。例如，在 PHP 中：

```
<?php
echo join(',', array('L'.$level, $unit.'/'.$num, 
          $street, $suburb, $state, $postcode, $country)); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T15:03:45.317

```
<?php
    $level  = 'foo';
    $street = 'bar';
    $num    = 'num';
    $unit   = '';

    // #1: unreadable and unelegant, with arrays
    $values   = array();
    $values[] = $level ? 'L' . $level : null;
    // not very readable ...
    $values[] = $unit && $num ? $unit . '/' . $num : ($unit ? $unit : ($num ? $num : null));
    $values[] = $street ? $street : null;

    echo join(',',  $values);

    // #2: or, even more unreadable and unelegant, with string concenation
    echo trim( 
        ($level ? 'L' . $level . ', ' : '') . 
        ($unit && $num ? $unit . '/' . $num . ', ' : ($unit ? $unit . ', ' : ($num ? $num . ', ': '')) .
        ($street ? $street . ', ': '')), ' ,');

    // #3: hey, i didn't even know that worked (roughly the same as #1):
    echo join(', ', array(
        $level ? 'L' . $level : null,
        $unit && $num ? $unit . '/' . $num : ($unit ? $unit : ($num ? $num : null)),
        $street ? $street : null
    ));
?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T15:34:06.600

只需取出最后一个逗号，即用空替换它。

```
$string1 = "L$level, $unit/$num $street, $suburb, $state $postcode, $country.";
$string1 = eregi_replace(", \.$", "\.", $string1);
echo $string1; 
```

这将完成工作。

# c# - 关于 try-catch 块的思考

> ID：751744
> 
> 赞同：6
> 
> 时间：2009-04-15T13:41:35.623
> 
> 标签：c#, exception-handling, coding-style, try-catch

您对如下所示的代码有何看法：

```
public void doSomething()
{
    try
    {
       // actual code goes here
    }
    catch (Exception ex)
    {
        throw;
    }
} 
```

我看到的问题是没有处理实际错误，只是将异常抛出到不同的地方。我发现调试起来更加困难，因为我没有得到实际问题所在的行号。

所以我的问题是为什么这会很好？

- - 编辑 - -

从答案看来，大多数人都说在没有捕获自定义或特定异常的情况下这样做是没有意义的。这就是我想要评论的内容，当没有捕获到特定异常时。我可以看到实际使用捕获的异常做某事的意义，而不是这段代码的方式。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-15T13:45:01.933

根据您所查看的质量，它不会在不同的地方引发异常。没有目标的“抛出”会重新抛出异常，这与抛出异常非常不同。主要是重新抛出不会重置堆栈跟踪。

在这个特定的示例中，catch 毫无意义，因为它什么都不做。异常被愉快地重新抛出，就好像 try/catch 不存在一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T13:45:17.767

我认为该构造应该用于处理您知道将在代码中抛出的异常；如果引发其他异常，则重新抛出。

考虑到投掷；与 throw ex 不同；

throw ex 会将堆栈截断到新的抛出点，丢失有关异常的有价值信息。

```
public void doSomething()
{
    try
    {
       // actual code goes here
    }
    catch (EspecificException ex)
    {
        HandleException(ex);
    }
    catch (Exception ex)
    {
        throw;
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-15T13:48:44.450

它不会，理想情况下，catch 块会做一些处理，然后重新抛出，例如，

```
try
{
    //do something
}
catch (Exception ex)
{
    DoSomething(ex); //handle the exception
    throw;
} 
```

当然，如果您想在代码的上层进行一些进一步的处理，重新抛出将很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T13:46:52.067

做这样的事情是相当没有意义的，总的来说，我尽量不走上做无意义的事情的道路；）

在大多数情况下，我相信捕获您知道如何处理的特定类型的异常，即使这仅意味着使用更多信息创建您自己的异常并将捕获的异常用作 InnerException。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T13:48:55.683

有时这是合适的——当您要处理调用堆栈中更高的异常时。但是，您需要在该 catch 块中做一些事情，而不仅仅是重新抛出以使其有意义，例如记录错误：

```
public void doSomething()
{
    try
    {
       // actual code goes here
    }
    catch (Exception ex)
    {
        LogException (ex);  // Log error...
        throw;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T13:53:02.863

我不认为仅仅重新抛出错误会有用。除非您一开始并不真正关心错误。

我认为实际上做一些事情会更好。

您可以查看[MSDN 异常处理指南](http://msdn.microsoft.com/en-us/library/ms173162(VS.80).aspx)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T13:44:09.673

我见过像这样捕获通用异常然后将其重新打包到自定义异常对象中的实例。

这与您所说的不同之处在于，这些自定义 Exception 对象包含有关发生的实际异常的更多信息，而不是更少。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-15T13:46:27.420

对于初学者来说，我只是这样做

```
catch
{
   throw;
} 
```

但基本上，如果您要捕获多种类型的异常，您可能希望在本地处理一些异常，而另一些则备份堆栈。

例如

```
catch(SQLException sex) //haha
{
   DoStuff(sex);
}
catch
{
   throw;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-15T13:47:28.183

取决于你所说的“看起来像这样”是什么意思，如果在 catch 块中除了重新抛出之外没有别的东西......如果是这种情况，try catch 是没有意义的，除非，正如你所说，混淆异常发生的位置. 但是，如果您需要在发生错误的地方做某事，但希望在堆栈中进一步处理异常，这可能是合适的。但是，捕获将针对您正在处理的特定异常，而不是针对任何异常

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T14:45:40.990

通常拥有不做任何事情的异常处理块根本不好，原因很简单，它会阻止 .Net 虚拟机在性能优化代码时内联您的方法。

For a full article on why see "[Release IS NOT Debug: 64bit Optimizations and C# Method Inlining in Release Build Call Stacks](http://www.hanselman.com/blog/ReleaseISNOTDebug64bitOptimizationsAndCMethodInliningInReleaseBuildCallStacks.aspx)" by [Scott Hanselman](http://www.hanselman.com/blog/AboutMe.aspx)

# c# - Rijndael / AES 从 C# 到 VB6

> ID：751759
> 
> 赞同：4
> 
> 时间：2009-04-15T13:44:55.257
> 
> 标签：c#, vb6, aes, rijndaelmanaged, rijndael

我需要在 VB6 中加密一个字节数组并在 C#（NET 2.0）中解密它。反之亦然（C# 到 VB6）。

在 C# 中，我使用了 RijndaelManaged 类。在 VB6 中，我使用了来自 Internet 的免费片段。最好的似乎是[http://www.frez.co.uk/freecode.htm#rijndael](http://www.frez.co.uk/freecode.htm#rijndael) 但是这两种实现从相同的输入开始产生不同的输出:(

也许这是 RijndaelManaged 中的 IV 向量的问题......我不明白......

在 VB6 和 NET 之间使用 Rijndael/AES 的任何解决方案/经验？或 TripleDes....

谢谢你

更新：重要提示：运行 vb6 应用程序的机器没有 NET 框架。所以我不能使用 Interop 和/或暴露为 COM 的 NET 包装类。:(

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T13:59:18.620

您可以使用 .NET 的互操作从 VB6 调用 C# 实现。这样双方都将使用同一个库。

这里有一些额外的信息： http: [//msdn.microsoft.com/en-us/library/hfzzah2c (vs.71).aspx](http://msdn.microsoft.com/en-us/library/hfzzah2c(vs.71).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T14:18:55.347

我刚刚抓取了[SlowAES](http://code.google.com/p/slowaes)，一个 AES 的 Javascript 实现，并将它嵌入到一个 Windows 脚本组件中，这使得它可以通过 COM 访问。然后我可以从 COM 客户端调用组件。我没有尝试 VB6，因为我没有 Visual Studio 6。但是对于我尝试过的 COM 客户端，当我使用相同的密钥 IV 时，我发现加密与 .NET 和[RijndaelManaged](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndaelmanaged.aspx) () 类完全兼容、模式和密钥大小。

SlowAES 有点有限。例如，我没有看到欧洲央行模式。但我测试的东西与.NET 兼容。

[WSC 文件的源代码可用](http://cheeso.members.winisp.net/srcview.aspx?dir=AES-example)。该源还包括可从 VB6 使用的符合 RFC2898 的 PBKDF2。因此，您可以通过密码设置密钥。[它与 .NET 中的Rfc2898DeriveBytes](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)类 兼容。

另请参阅[相关问题](https://stackoverflow.com/questions/270510/how-to-encrypt-in-vbscript-using-aes)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-05T14:25:11.420

如果您可以在此处进行简单的 C 到 C# 转换，这是一个不错的解决方案。它适用于 VB6/php 和 C。看看[Encryption for C++, Visual Basic, php using PC1](http://www.expertcore.org/viewtopic.php?f=49&t=1816)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T08:26:08.133

也许我会给你一些关于IV的信息。

初始化向量是一个明文发送的数据，应该为每个加密随机生成，以使构造型标头攻击更难或不可能执行。当然，加密器和解密器都必须具有相同的值集。

还有一些模式可以运行加密和解密。看看这个页面：[维基百科：分组密码操作模式](http://en.wikipedia.org/wiki/Cipher_feedback)。您还应该确保两者的此模式相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-20T16:35:57.440

VbCorLib 现在支持加密，包括 Rijndael。

它是免费的，并且类似于 .NET。链接：http: [//vbcorlib.blogspot.com/](http://vbcorlib.blogspot.com/)

# sql-server-2008 - 本机模式下 SQL Reporting Services 2008 启动缓慢

> ID：751762
> 
> 赞同：5
> 
> 时间：2009-04-15T13:45:26.550
> 
> 标签：sql-server-2008, reporting-services, ssrs-2008

当天的第一个报告请求或在未知的时间段内没有报告请求时，我们遇到了启动时间缓慢的问题。在 SQL Reporting Server 2005 安装中，我们将设置应用程序池以避免回收 Reporting Services 应用程序。

但是，我的客户在本机模式下在 Windows Server 2008 上安装了 SQL Reporting Server 2008。没有我可以找到的 IIS 安装。我已经检查了 SQL 报告服务配置设置、帮助文件和论坛，并没有在本机安装中找到解决此问题的方法。

在本机模式下安装时，如何控制 Reporting Services 应用程序的回收？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-15T15:18:44.067

我没有找到 tcc'sresponse 中引用的参数。然而，他的回答确实让我知道配置文件的存在；我确实找到了一个包含详细内容的页面：

[MSDN：如何：修改 Reporting Services 配置文件](http://msdn.microsoft.com/en-us/library/bb630448.aspx)

在其中我找到了 RecycleTime 参数。它默认为 720，感觉就像 20 分钟左右超时。我把它设置为28800。

我重新启动了 Reporting Services 服务，并访问了该站点。通常需要一两分钟才能出现，在那段时间服务器正在努力工作。现在很活泼；我将全天进行测试，看看这是否会阻止 Report Services 回收进程并每 20 分钟重新构建一次并向该站点报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T14:02:04.733

我相信解决方案是在 rsreportserver.config 文件中添加一个 ProcessTimeout 键。默认安装时，此文件中有此密钥，但已将其注释掉。我不确定这是分钟还是秒，但我将其修改为 28800，并且在超过 12 小时没有任何活动后，今天早上该进程仍在运行。第一份报告在几秒钟内加载。

该文件位于 ~/program files/microsoft sql server/msrs10.mssqlserver/reporting services/reportserver

我还修改了这个文件中的7200。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-03T17:14:39.373

`SQL Server 2008`不使用 IIS，这就是 RecycleTime 参数移动到 RS 配置文件的原因。这也意味着您可以在数据库服务器上安装报表服务器以获得更好的性能，而无需安装 IIS。

对于仅在正常工作时间内活动的报表服务器，默认的 RecycleTime 720（12 小时）应该是合理的。尽管如此，我还是遇到了同样的问题，即使我将报表订阅安排在每个工作日上午 7:30 运行，以使报表服务器在当天初始化。

我现在想知道 RecycleTime 参数是否真的以分钟为单位指定，或者这可能是文档错误。我将尝试更大的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-24T04:32:19.180

*我正在运行 SQL Server 2008 R2，并且我的rsreportserver.config*中有两个设置（最初被注释掉）我取消注释并配置了。我的值如下所示：

```
<Add Key="ProcessTimeout" Value="4320" /><!-- seconds -->
<Add Key="ProcessTimeoutGcExtension" Value="30" /><!-- seconds --> 
```

在撰写本文时，这些配置元素[没有记录](http://msdn.microsoft.com/en-us/library/ms157273%28v=sql.105%29.aspx)在 MSDN 文档中用于 SQL Server 2008 R2 的*rsreportserver.config*文件，但是有一篇[知识库文章在](http://support.microsoft.com/kb/955811)*更多信息*下简要描述了它们：

> 有两个配置设置可确定进程监视器在停止服务之前等待服务活动的时间。这些设置定义如下：
> 
> 1.  **ProcessTimeout**
>     此设置适用于 Reporting Services 正在执行的任何操作。
> 2.  **ProcessTimeoutGcExtension**
>     此设置仅在垃圾收集正在进行且已达到 ProcessTimeout 值时适用。

使用该`ProcessTimeout`设置使我的 SSRS 实例保持唤醒状态，并将该`RecycleTime`设置设置为适当大的值（在我的情况下为 30 天或 43,200 秒）有助于避免在该时间跨度过去时发生的强制回收。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-01T23:36:54.713

通过将 RecycleTime 设置为 28800，您只会增加慢速启动之间的时间。在 480 小时后运行第一份报告仍需要一些时间。如果有帮助，您可以将 RecyleTime 设置为 0 以停止回收。

如果这不是一个选项，您可以通过多种方法使其保持活动状态，例如：
1.）在 SSRS 报告管理器网站中安排一个虚拟报告（我最喜欢的方法）
2.）[预定脚本](http://www.pawlowski.cz/2011/07/solving-issue-long-starting-report-ssrs-2008/)

我意识到这是一个老问题，但没有很好的记录，希望这对那里的人有所帮助。

# java - 发生异常后如何在java中重新生成一个thrift服务器？

> ID：751771
> 
> 赞同：2
> 
> 时间：2009-04-15T13:46:52.350
> 
> 标签：java, process, thrift

我是 Java 新手，并且在 Java 中编写了一个小但非常重要的节俭服务。

我注意到偶尔它会停止服务而没有任何错误消息；似乎java进程只是随机死亡，没有堆栈跟踪或异常。

即使发生错误，确保此过程仍然有效的最佳方法是什么？这是主要功能，如果有帮助的话：

```
public static void main(String [] args) {
    try {
        MyAppServiceHandler handler = new MyAppServiceHandler();
        MyApp.Processor processor = new MyApp.Processor(handler);
        TServerTransport serverTransport = new TServerSocket(8080);
        TServer server = null;
        server = new TSimpleServer(processor, serverTransport);
        System.out.println("Starting thrift server...");
        server.serve();
    }
    catch (TTransportException e) {
        e.printStackTrace();
    }
    catch (Exception e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-08T09:41:00.933

我已更改为更好的解决方案。

我`main`在 java 中的函数如下所示：

```
public static void main(String [] args) {
    try {
      MyAppServiceHandler handler = new MyAppServiceHandler();
      MyApp.Processor processor = new MyApp.Processor(handler);
      TServerTransport serverTransport = new TServerSocket(8080);
      TServer server = null;
      server = new TSimpleServer(processor, serverTransport);
      System.out.println("Starting thrift server...");
      server.serve();
    }
    catch (TTransportException e) {
      e.printStackTrace();
    }
    catch (Exception e) {
      e.printStackTrace();
    }
} 
```

这会使服务器死机，这与我想要的原始解决方案背道而驰。但是，Java 进程/服务器现在是从[Supervisor](http://supervisord.org)启动的，它会密切关注进程并在它死亡时重新生成它，而原始解决方案（使用 while 循环）将使服务器保持活动状态，但如果存在则打印堆栈跟踪连接到端口时出现问题，这些错误消息将被遗漏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T13:56:00.953

如果调用服务被阻止，您可以执行以下操作：

```
public static void main(String [] args) {
   while(true){
    try {
        MyAppServiceHandler handler = new MyAppServiceHandler();
        MyApp.Processor processor = new MyApp.Processor(handler);
        TServerTransport serverTransport = new TServerSocket(8080);
        TServer server = null;
        server = new TSimpleServer(processor, serverTransport);
        System.out.println("Starting thrift server...");
        server.serve();
    }
    catch (TTransportException e) {
        e.printStackTrace();
    }
    catch (Exception e) {
        e.printStackTrace();
    }
    //do cleanup
  }
} 
```

# c# - 为什么我不能在 for 循环中更改 linq IEnumerable 中的元素？

> ID：751776
> 
> 赞同：6
> 
> 时间：2009-04-15T13:48:29.460
> 
> 标签：c#, linq

昨天我写了以下 c# 代码（为了易读而缩短了一点）：

```
 var timeObjects = ( from obj in someList
                     where ( obj.StartTime != null )
                     select new MyObject()
                     {
                        StartTime= obj.StartTime.Value,
                        EndTime = obj.EndTime
                     } ) 
```

因此，每个项目都有一个 startTime，有些项目有一个 EndTime（其他项目的 EndTime 为 null）。

如果开始和结束时间都知道，我想计算经过的时间：

```
foreach ( var item in timeObjects)
{
    if ( item.EndTime  == null )
    {
      item.elapsed = 0;
    }
    else
    {
      item.elapsed = ( item.EndTime.Value - item.StartTime).Minutes;
    }
} 
```

但这不起作用！timeObjects 集合永远不会改变。

如果我说：

```
 var timeObjects = ( from obj in someList
                     where ( obj.StartTime != null )
                     select new MyObject()
                     {
                         StartTime= obj.StartTime.Value,
                         EndTime = obj.EndTime
                     } ).ToList();

foreach ( var item in timeObjects)
{
    if ( item.EndTime  == null )
    {
      item.elapsed = 0;
    }
    else
    {
      item.elapsed = ( item.EndTime.Value - item.StartTime).Minutes;
    }
}
//(only change is the ToList() at the end of the linq statement) 
```

它确实有效。

我很想知道这是为什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-15T13:51:28.080

你`timeObjects`是一个延迟执行的可枚举。如果您对列表进行两次枚举，结果实际上将被评估两次，从而创建新对象。

当您执行 ToList() 时，它创建了该查询/可枚举结果的本地副本，这就是您看到更改的原因。这种 LINQ 查询不会在后台创建任何类型的列表。在您对其进行枚举之前，不会执行查询本身。您在 (from ... select) 状态下所做的只是创建查询定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T13:51:42.383

您最初的 timeObjects 定义定义了一个延迟评估的 LINQ 表达式，因此每次您尝试遍历 timeObjects 可枚举时，它都会创建 MyObject 的新实例。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-15T13:54:15.700

似乎在调用 ToList() 之前它不是 IEnumerable 而是[IQueryable](http://msdn.microsoft.com/en-us/library/system.linq.iqueryable.aspx)，因此对临时对象进行了更改。

# validation - 禁用 struts2 验证的日志记录

> ID：751781
> 
> 赞同：1
> 
> 时间：2009-04-15T13:49:15.137
> 
> 标签：validation, logging, struts2

我想禁用 struts2 验证的日志记录，每当调用包含验证的 struts 操作时，我的日志中都会出现“垃圾”，就像这样：“[Apr 15 14:42:41] ERROR (CommonsLogger.java:24) - Validation error对于域：blahblah。”。

我已经在使用 log4j，它的日志记录很好，但我不想让这个“垃圾”填满我的日志。

如果需要一些代码，我会得到它，但此时我不知道要呈现什么。

准确地说，这个“垃圾”日志记录了 struts2 中的验证消息（例如“请输入您的姓名”），也许这会帮助有人帮助我。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:57:23.430

在 log4j 中，您可以修改每个类的日志记录级别，通常每个类都有自己的记录器。但它们是分层的，因此您通常可以为包设置日志记录级别并影响其所有成员。因此，将以下内容添加到您的`log4j.properties`文件中：

```
log4j.logger.com.opensymphony.xwork2.validator = FATAL 
```

不过，这是一个相当广泛的笔刷——这样您就无法了解验证中潜在的严重问题。您可能想要查明哪个类正在发出日志消息，并且只修改其日志记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-11T12:29:12.413

@milostrivun

log4j.logger.com.opensymphony.xwork2.validator = 致命

这会将记录器级别设置为 FATAL，这相当于指示 log4j 记录优先级为 FATAL 或更高的消息（尽管没有比 FATAL 更高的级别）。

因此，来自 com.opensymphony.xwork2.validator 软件包中任何类的 TRACE、DEBUG、INFO、WARN、ERROR 级别消息都不会被打印出来。

说得通？

# datagridview - 如何在 Windows 窗体应用程序中从 Datagridview 控件创建 XML 文件？

> ID：751795
> 
> 赞同：2
> 
> 时间：2009-04-15T13:52:26.250
> 
> 标签：datagridview

我在 Windows 应用程序中创建一个 XML 文件，在我有 DataGridView 控件的表单中，用户单击该行并输入文本或从组合框中选择值。我以编程方式创建行，比如说在创建了 10 行之后，我想将该信息保存到 XML 文件中，以便下次运行我的应用程序时，再次填充 datagridview... 最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T14:19:54.767

得到了很好的解决方案：

```
 private void saveItemDatabase_Click(object sender, EventArgs e)
    {
        DataTable dt = new DataTable("itemstable"); 

        for(int i=0; i<itemDataGridView.ColumnCount; i++){
            dt.Columns.Add(itemDataGridView.Columns[i].Name,typeof(System.String));
        }

        DataRow myrow ;
        int icols = itemDataGridView.Columns.Count; 
        foreach (DataGridViewRow drow in this.itemDataGridView.Rows) { 
            myrow = dt.NewRow(); 
            for (int i = 0; i <= icols - 1; i++) { 

                myrow[i] = drow.Cells[i].Value; 
            } 
            dt.Rows.Add(myrow); 
        } 

        dt.WriteXml("items.xml");

    } 
```

# jquery - 在模态对话框中淡入叠加

> ID：751796
> 
> 赞同：19
> 
> 时间：2009-04-15T13:52:42.630
> 
> 标签：jquery, jquery-ui, jquery-plugins

我有一个 JQuery UI 对话框，它是模态的，具有 50% 不透明度的黑色背景。是否可以使背景不透明度从 0% 衰减到 50%？如果是这样，怎么做？因为目前感觉有点像在显示对话时直接打脸。

FWIW，这是我目前使用的 CSS：

```
.ui-widget-overlay {
    background: black;
    opacity: 0.5;
    filter: alpha(opacity = 50);
    position: absolute;
    top: 0;
    left: 0;
 } 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2010-09-22T08:58:49.663

您还可以将其添加到 fadeIn 模态中：

```
$(loginForm).dialog({
        resizable: false,
        open: function(){
            $('.ui-widget-overlay').hide().fadeIn();
        },
        show: "fade",
        hide: "fade" 
}); 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-11T21:38:22.647

这是对利亚姆波特答案的扩展。他的作品非常适合淡入，但不处理淡出。我发现这是使背景也淡出的最简单方法：

```
beforeClose: function(){
    $('.ui-widget-overlay:first')
        .clone()
        .appendTo('body')
        .show()
        .fadeOut(400, function(){ 
            $(this).remove(); 
        })
    ;
} 
```

您不能在“关闭”方法中执行此操作，因为 jQuery 已经删除了 '.ui-widget-overlay' 容器，但是通过将其克隆为仅进行淡入淡出，您可以避开它们的删除并仍然使用所有默认值样式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-15T16:08:08.107

我知道这是一个老问题，但是我刚刚在搜索中遇到了它，并且觉得我可以帮助其他人。

我敢肯定这可以改进，但是当使用 jQuery UI 对话框时，这会淡入淡出你的叠加层。

```
open: function(){
    $('.ui-widget-overlay').hide().fadeIn();
},
beforeClose: function(){
    $('.ui-widget-overlay').remove();
    $("<div />", {
        'class':'ui-widget-overlay'
    }).css(
        {
            height: $("body").outerHeight(),
            width: $("body").outerWidth(),
            zIndex: 1001
        }
    ).appendTo("body").fadeOut(function(){
        $(this).remove();
    });
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T14:03:05.803

您可以使用 jQuery`fadeTo()`函数。更多信息可以在下面的链接中找到。 [http://docs.jquery.com/Effects/fadeTo#speedopacitycallback](http://docs.jquery.com/Effects/fadeTo#speedopacitycallback)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-18T09:52:53.777

对利亚姆·波特的回答只是一个小小的改进。如果您希望覆盖是全屏的，那么您可以将他的代码更改为使用`$(document).height()`and`$(document).width()`而不是 body，因为后者的测量值小于可见区域。

```
open: function(){
    $('.ui-widget-overlay').hide().fadeIn();
},
beforeClose: function(){
    $('.ui-widget-overlay').remove();
    $("<div />", {
        'class':'ui-widget-overlay'
    }).css({
        height: $(document).height(),
        width: $(document).width(),
        zIndex: 1001
    }).appendTo("body").fadeOut(function(){
        $(this).remove();
    });
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-01T16:56:16.167

您可以创建自己的小部件扩展 $.ui.dialog 以使用选项添加具有准确配置的覆盖显示和隐藏动画。

另一个缺少通过单击覆盖关闭对话框的功能也很容易添加：

在某个文件中，比如 jquery-ui.fsrc.dialog.js：

```
(function( $, undefined ) {

$.widget('fsrc.fsrc_dialog', $.ui.dialog, {
open: function() {
    // some helpful vars
    var self = this,
        options = self.options;

    // call parent method - it will create overlay and save it in self.overlay variable
    var ret = $.ui.dialog.prototype.open.apply(this, arguments);

    if (options.showOverlay) {
        // immediately hide and animate overlay
        // kind a hack, but jquery ui developers left no better way
        self.overlay.$el.hide().show(options.showOverlay)
    }
    if (options.closeOnOverlay) {
        // close dialog on click on overlay
        self.overlay.$el.click(function() {
            self.close();
        })
    }
    return ret;
},
close: function(event) {
    var self = this,
        options = self.options;

    if (options.hideOverlay) {
        // save and unset self.overlay, so it will not be destroyed by parent function during animation
        var overlay = self.overlay
        self.overlay = null;
        overlay.$el.hide(options.hideOverlay, function() {
            // destroy overlay after animation as parent would do
            overlay.destroy();
        })
    }

    // call parent method
    var ret = $.ui.dialog.prototype.close.apply(this, arguments);
    return ret;
}
});

}(jQuery)); 
```

在页面中：

```
<script src='/js/jquery-ui.fsrc.dialog.js' type='text/javascript'></script>
<script type="text/javascript">
<!--
    jQuery(document).ready(function(){
        jQuery('#show').click(function(){
            jQuery('#order_form_container').fsrc_dialog({
                modal: true,
                closeOnOverlay: true,
                show: {effect: "fade", duration: 500},
                showOverlay: {effect: "fade", duration: 500},
                hide: {effect: "fade", duration: 300},
                hideOverlay: {effect: "fade", duration: 300},
            });
        })
    })
-->
</script>` 
```

我将命名空间、小部件和选项命名为对我有利的名称。

测试过jquery1.7.2、jquery-ui1.8.19、IE9、ff11、chrome18.0.1025.168m、opera11.61

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-11-14T14:27:43.933

```
$('.ui-widget-overlay').hide().fadeIn(); 
```

此效果在 IE 上存在问题，因为在淡入后不透明度将不起作用

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-07-08T15:26:54.350

我不得不修改 Sam Barnes 的答案以使其工作（我还在 $(document).ready 函数中抛出了对话框单击函数）：

```
<script type='text/javascript'>
  $(".dialog").click(function(){
    $('.ui-widget-overlay').hide().fadeIn();        
    $("div.dialog").dialog({
        resizable: false,
        close: function(){
            $('.ui-widget-overlay').hide();
        },
        show: "fade",
        hide: "fade" 
    });
    $(".ui-dialog").fadeIn();
    return false;
  });
  $(".ui-widget-overlay").click(function(){
    $(this).hide();
    $(".ui-dialog").hide();
  });
</script>
<style>
  .ui-widget-overlay {
    background: black;
    opacity: 0.5;
    filter: alpha(opacity = 50);
    position: absolute;
    top: 0;
    left: 0;
   }
</style>
<div class='ui-widget-overlay'></div>
<div class='dialog' title='Heading!'>Some Message!</div> 
```

您可以通过添加以下内容来添加隐藏在退出按钮按下的内容：

```
$(document).keyup(function(e) {

  if (e.keyCode == 27) { 
       $(".ui-dialog").hide();
       $('.ui-widget-overlay').hide();
  }
}); 
```

# vb.net - My.Computer.FileSystem.MoveFile 和 File.Move 有什么区别

> ID：751797
> 
> 赞同：2
> 
> 时间：2009-04-15T13:52:43.893
> 
> 标签：vb.net

这个问题真的说明了一切。

这两种似乎执行完全相同的功能的方法之间有什么区别？

是否有指导说明应该使用哪个或有条件何时可以使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-15T14:10:14.913

有`FileSystem.MoveFile`比 更多的选项`File.Move`，例如可选地显示一个进度对话框，如果它不存在则创建目标文件夹。

如果您只是想移动或重命名文件，则`File.Move`无论您使用哪种方法，最终都会调用该方法，因此直接调用它意味着开销略小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T13:54:16.807

我相信它们具有几乎相同的功能。我见过的大多数人更喜欢使用后者，因为“我的电脑”。是仅 VB.NET 的构造，而 File.Move 用于 C# 和 VB.NET。这使得获得帮助更容易，C# 编码人员更容易阅读 VB.NET 代码，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T13:54:33.907

我还没有检查过`My.Computer.FileSystem.MoveFile`，但是您可以说明它们是否是移动带有关联图像目录的 html 文件的差异。因为`File.Move`只是移动文件，但不移动关联目录

# svn - 在代理后面解开 svn 访问

> ID：751798
> 
> 赞同：2
> 
> 时间：2009-04-15T13:52:55.173
> 
> 标签：svn, repository, unfuddle

我正在使用 unfuddle 来托管一些私人项目，unfuddle 是一个很好的解决方案，可以通过 SVN 随时更新和修改我的源代码，即使我不在家也可以。

问题是在工作中，我们使用了一个我无法禁用的强制代理，这使我无法通过 SVN 访问我的 unfuddle 存储库。

有什么解决方案，或者有没有代理限制的 unfuddle 的免费替代方案？我不太关心 unfuddle 提供的项目管理和错误跟踪，我只想能够通过 SVN 在任何我想访问的地方访问我的源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T15:57:45.560

许多颠覆主机允许通过 HTTPS 连接到它们。在这种情况下，代理服务器看不到特殊的颠覆命令，并且通常透明地传递它们，就像您仅将 https 用于网络服务器一样。

（我没有使用 unfuddle 的经验，但它在其他一些情况下也有效）

# design-patterns - 工厂方法模式的实际用途是什么？

> ID：751804
> 
> 赞同：17
> 
> 时间：2009-04-15T13:53:49.307
> 
> 标签：design-patterns

我对设计模式很陌生。我刚刚遇到了工厂设计模式。我知道它将实例化委托给子类。但我没有得到该模式的实际应用。这种模式在哪些场景可以使用效果好。我听说过模式滥用，不想沉迷其中。任何人都可以提及一个常用的现实世界示例。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-15T14:00:29.070

我已经将它用于应用程序的插件......这样你就可以让你的主应用程序调用类工厂来实例化实现你在主应用程序中开发的某些接口的特定插件。这样，您可以编写应用程序的主要部分，而无需知道要插入什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T14:12:53.690

即在以下两种情况之一：

1.  你的类不知道它想要创建的对象的类型，但它只想要一个能够“完成工作”的对象。由于 EMF 大量使用了这种模式，因此它跃入脑海。
2.  您希望类的子类确定要使用的对象的类型。即，您正在编写父类而不知道将创建什么具体产品，这将是具体创建者的责任。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T14:01:21.800

假设您有一个包含类型对象的队列`task`。

现在，您可以`task`出于各种原因进行子类化。如果您从某个来源（如数据库）加载任务，则可以使用工厂来确定要加载的任务类型。

例如：

```
private IEnumerable<Task> GetTasks(DataTable Table){

  Task NewTask;

  foreach(DataRow Row in Table){
    switch(tasktype){
      case tasktypes.TaskTypeA:
        NewTask = NewTaskA(...);
        break;

      case TaskTypes.TaskTypeB:
        NewTask = NewTaskB(...);
        break;
      ...
    }

    yield return NewTask;
  }
} 
```

稍后，您可以在队列中的任务上调用虚拟方法，例如“使用”或“处理”。

工厂方法的优点（在这种情况下）是您只需打开一次任务类型（在创建任务时），然后让多态处理大多数其他事情。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T13:59:42.333

我只是在调度应用程序中使用它，其中要调度的任务位于单独的程序集中，而调度程序对任务一无所知......它从外部源获取定义任务的程序集的名称，然后动态加载程序集，使用定义明确的接口实例化该程序集中的类。调度程序中的工厂方法，将程序集名称作为输入参数，返回加载的程序集中的类的实例......

..但是有很多用途和使用方式..这种模式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T14:03:48.190

诚然，由于 C# 的工作方式，消除了实际使用模式描述的更痛苦的实现细节的需要，但是我的 SQL DAL 功能将对象工厂（和 SQL 命令）传递给使用工厂以生成的实用程序函数对象。如果我没有使用 C#，我想我可以改用生成对象的显式工厂类。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-04-15T14:01:00.257

工厂模式对于将容量映射到适当的处理程序非常有用。

# .net - 与 Web 服务器上的应用程序级别无关的相对 AJAX 路径

> ID：751806
> 
> 赞同：0
> 
> 时间：2009-04-15T13:54:01.490
> 
> 标签：.net, javascript, asp.net-mvc

我有一些类似于下面的 javacsript 代码。请注意它如何使用一些参数对“/ContollerName/ActionName”进行 ajax 调用。只要将应用程序*部署*在 IIS 的站点根目录上，它就可以正常工作。但是，如果我将它部署在虚拟目录上，则路径将一直指向站点根目录，并且它将失败。

```
$.get("/ControllerName/ActionName", { foo: _bar, foo2: $(titleRow).attr("id"),
            Direction: direction
        }, function(data, success) {
            if (eval(data).Result == _successEnum) {
                successfulCallback();
            } else {
                failCallback(errorMessage, eval(data).LogPath);
            }

        }, "json"); 
```

我怎样才能使它既可以部署在站点根级别，也可以部署在虚拟目录上。

以下两者都应该基本上可以工作。我使用 ASP.NET MVC。

*   [http://localhost/ControllerName/ActionName?foo=bar](http://localhost/ControllerName/ActionName?foo=bar)
*   [http://localhost/TestApplication/ControllerName/ActionName?foo=bar](http://localhost/TestApplication/ControllerName/ActionName?foo=bar)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T13:58:06.987

用作`Url.Action`第一个参数。

```
// link to a controller 
Url.Action("Home");
// link to an action 
Url.Action("Home", "Index"); 
```

# asp.net - __doPostback - 从 JavaScript 调用事件背后的代码？

> ID：751807
> 
> 赞同：3
> 
> 时间：2009-04-15T13:54:06.857
> 
> 标签：asp.net, javascript, events, postback

我希望在我的代码中从 JavaScript 调用一个方法，我有点知道该怎么做.. 我必须调用`__DoPostBack`控件和参数的传递名称..

但是如果事件不存在，即没有控制怎么办。我真正想做的是调用一个事件..但该事件不存在，因为没有与之关联的控件..

我有点可以这样做：

```
If IsPostBack Then
       If Request(”__EVENTTARGET”).Trim() = “CleanMe” Then
           CleanMe()
       End If
..... 
```

但这意味着我必须手动完成。我可以不连接一个事件....否则我将有很多不同的 IF（即，如果它通过了，那么调用它......等等）。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T13:59:54.843

如果你想使用__doPostBack()，你必须有一个控件来接收命令。但是，您不必显式连接事件来处理它。如果您希望 __doPostBack() 调用 Foo()，请执行以下操作：

```
MyControl : IPostBackEventHandler
{
    void RaisePostBackEvent(string eventArgument)
    {
        Foo();
    }
} 
```

调用 __doPostBack() 将调用目标控件上的 RaisePostBackEvent 方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T14:03:44.117

您可以使用 PageMethod 来调用您的代码隐藏函数，这是一个示例链接：http: [//blogs.microsoft.co.il/blogs/gilf/archive/2008/10/04/asp-net- ajax-pagemethods.aspx](http://blogs.microsoft.co.il/blogs/gilf/archive/2008/10/04/asp-net-ajax-pagemethods.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T13:57:35.600

如果您真的想连接到一个事件，可以减少麻烦的选项是创建一个隐藏的 asp 按钮并通过 javascript 单击它

# c# - 是否有针对 .NET 的应用程序配置的深入指南？

> ID：751817
> 
> 赞同：7
> 
> 时间：2009-04-15T13:56:42.777
> 
> 标签：c#, .net, vb.net

是否有人拥有或曾经遇到过 .net app.config 的深入指南？我在尝试找到 .net 这一领域的权威指南时遇到了重大问题。

我已经可以处理自定义配置部分，从基本键/值对设置一直到完整的自定义配置处理程序，我很难找到相关信息，但我找不到任何关于配置文件的基本本机 .NET 功能的文档......例如，关于 BCL 配置。

我浏览了 machine.config.comments 和 config.xsd 文件，它提供了一些见解，但不足以完全掌握配置文件的全部潜力。我还浏览了我在 Safari 上可以找到的所有内容，并且只设法提出了一些我以前不知道的有用的花絮，但似乎 .NET 的这个领域的文档非常少，除非你有一个非常考虑到特定目的，试图找到有关它的信息是没有用的。

如果有人能指出我对此的一些深入、明确的信息，我将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-15T14:08:27.867

您可能想查看 Jon Rista 在 Codeproject 上的 .NET Configuration 上的这三部分系列：

*   [揭开 .NET 2.0 配置的奥秘](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration.aspx)
*   [解读 .NET 2.0 配置的奥秘](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration2.aspx)
*   [破解 .NET 2.0 配置的奥秘](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration3.aspx)

真的真的很有帮助，而且写得很好！帮了我很多。

# c# - 如何以编程方式添加和填充 和 C#中的标签

> ID：751823
> 
> 赞同：0
> 
> 时间：2009-04-15T13:59:16.280
> 
> 标签：c#, xml, xsd

我需要向现有 XML 模式添加一些标签并将其写入文件。但是，我需要为每个现有架构添加标签。在 C# 中完成它的最佳方法是什么？

谢谢！

我有以下解析模式的代码：

```
 /// <summary>
    /// Iterates over all elements in a XmlSchema and prints them out
    /// </summary>
    /// <param name="schema"></param>
    private void IterateOverSchemaElements(XmlSchema schema)
    {
        XmlSchemaComplexType complex;
        foreach (XmlSchemaObject schemaObj in schema.Items)
        {
            complex = schemaObj as XmlSchemaComplexType;
            if (complex != null)
            {
                if (OutputTextDelegate != null)
                {
                    OutputTextDelegate(string.Format("ComplexType: {0}", complex.Name));
                }
                complex.Annotation = new XmlSchemaAnnotation();                    
                //Get sequence of the complextype:
                XmlSchemaSequence sequence = complex.ContentTypeParticle as XmlSchemaSequence;
                if (sequence != null)
                {
                    // Iterate over each XmlSchemaElement in the Items collection.
                    foreach (XmlSchemaElement childElement in sequence.Items)
                    {
                        if (OutputTextDelegate != null)
                        {
                            OutputTextDelegate(string.Format("--Element: {0}", childElement.Name));
                        }                            
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T18:35:25.900

您最好将模式作为 XML 文档而不是模式进行操作。例如，此代码在作为复杂类型序列的一部分的每个元素定义下创建一个注释：

```
const string uri = "http://www.w3.org/2001/XMLSchema";
XmlDocument d = new XmlDocument();
d.Load(path);
XmlNamespaceManager ns = new XmlNamespaceManager(d.NameTable);
ns.AddNamespace("xs", uri);

foreach (XmlElement ct in d.SelectNodes("//xs:complexType", ns))
{
    foreach (XmlElement e in ct.SelectNodes("xs:sequence/xs:element", ns))
    {
        XmlElement a = d.CreateElement("xs", "annotation", uri);
        a.InnerText = String.Format(
            "Complex type: {0}; Element name: {1}",
            ct.GetAttribute("name"),
            e.GetAttribute("name"));
        e.AppendChild(a);
    }
} 
```

# sql-server - 设计评论表

> ID：751831
> 
> 赞同：3
> 
> 时间：2009-04-15T14:00:11.053
> 
> 标签：sql-server, database-design

基本上我想创建一个评论系统，其中评论可能有也是评论的父母但我也希望他们可能有可能是其他东西的父母，例如用户或产品（即，我希望能够评论产品、用户、其他评论或几乎任何资源）

我该怎么做？

当前表：

标签、产品、用户、评论

编辑 - 这将是一个有点高流量的网站，所以我不能让它做各种疯狂:-)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T14:19:27.043

您想对产品、用户、评论等发表评论吗？或者找到评论所指的产品、用户、评论等？

对于前者，我会用表格将事物与他们的评论联系起来：

```
create table join_products_comments (
   product_id int (unique, i.e., one thread of comments per product),
   comment_thread_id int
);

create table join_users_comments (
   user_id int (unique, i.e., one thread of comments per user),
   comment_thread_id int
); 
```

其中 comment_thread 只是对每个评论引用的线程的引用：

```
create table comment_threads (
    thread_id int (PK),
    thread_name nvarchar2(256),
    created datetime
);

create table comments (
    comment_id int (PK),
    comment_thread_id int (FK),
    parent_comment_id int (FK),
    user_id int (FK), -- person who posted the comment
    comment text,
    created datetime
); 
```

因此，系统中的每个可评论实体都会有一个连接表和一个评论线程，等待热切的用户添加评论。或者，您可以直接链接到根注释，而无需使用这种间接方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:10:49.547

您最好的选择是将评论与目标隔离开来。就像是...

```
comment:
    comment_id (PK),
    user_id (FK),
    date,
    comment,
    parent_comment_id (FK) 
```

然后像...

```
product_comment:
    product_comment_id (PK),
    product_id (FK),
    comment_id (FK, unique) 
```

只有根评论（没有父评论）会有一行。这将允许您仍然保持强大的外键架构，并且仍然只能将评论与一个产品相关联。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-15T14:04:42.353

也许

```
CREATE TABLE comment (
id INT PK,
parent_comment INT NULL FK,
content TEXT,
table_source VARCHAR(30), -- SYSNAME,
row_source INT,
) 
```

在 table_source 中，您将保存表源（产品、用户等），在 row_source 中，保存注释指向的行的 ID。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-15T14:17:03.447

我的尝试：

```
CREATE TABLE Comment
(
    CommentID               INT            NOT NULL IDENTITY(1,1) PRIMARY KEY
   ,CommentValue            VARCHAR(5000)  NOT NULL
   ,CommentParentCommentID  INT            NULL     --fk to self
   ,CommentParentTagID      INT            NULL     --fk to Tags
   ,CommentParentProductID  INT            NULL     --fk to Parents
   ,CommentParentUserID     INT            NULL     --fk to Users

) 
```

这将允许您使用索引找到它们，而不会浪费太多存储空间

# sharepoint - 查询 ldap 以检索组用户是（在 sharepoint 中）的成员

> ID：751832
> 
> 赞同：0
> 
> 时间：2009-04-15T14:00:26.747
> 
> 标签：sharepoint, active-directory, ldap

我将 Sharepoint 与 Nintex 结合使用。查询 ldap 的可能性可以通过 Nintex 获得，并且基本的查询操作运行良好！现在我正在尝试获取用户所属的组的数组或集合..我试过了

```
(&(objectCategory=group)(member=cn={itemproperty:ldapName},dc=MyDomain)) 
```

不幸的是，这不起作用，我没有从日志记录中得到回复，也找不到任何其他解决方案......

对此问题的任何提示或帮助将不胜感激！

埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T14:15:05.790

您将需要从您的用户那里检索“memberOf”属性以获取他是直接成员的组的列表。

我说直接是因为存在嵌套组（用户是 A 组的成员，而后者又是 B 组的成员）并且不会返回。

此外，“memberOf”属性也不会返回主要组（通常是“Users”）。

马克

PS：如果您可以使用 .NET 3.5，则有一个更新的 AD 接口将用户公开为强类型对象 - 请参阅[Joe Kaplan 和 Ethan Wilansky](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)的优秀文章。

在那里，您可以获取一个用户，然后在用户对象上调用 .GetAuthorizationGroups 即可！

# iphone - iPhone & cocos2d - 在设备中运行时的间隔动作计时问题

> ID：751836
> 
> 赞同：2
> 
> 时间：2009-04-15T14:00:47.090
> 
> 标签：iphone, cocoa-touch, opengl, cocos2d-iphone

我正在为我的各种应用程序使用 cocos2d 框架，并且遇到了以下问题。我已经设置了一些动作序列和 CallFuncNDs，这些动作设置了持续时间，当我在 iPhone 模拟器中运行它时，它就像我期望的那样工作：转换需要我设置它们的时间，然后它们就会消失以正确的顺序。

当我在我配置的 iPhone 上测试它时，它会在不到一秒的时间内完成。正确的顺序，动作之间的时间是成正比的，但是都被压缩到了一秒。

任何人都知道为什么 cocos2d 动画在设备上的行为会有所不同？我的代码都设置为类似于 cocos2d 效果演示，不同之处在于我正在为 ParticleSystem 而不是 Sprite 设置动画 - 尽管问题仍然出现在 Sprites 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T13:36:40.997

我在模拟器中测试代码时遇到了类似的困难，它运行完美。但是当移到设备上时，时间似乎已经关闭。我将这种差异归因于模拟器对桌面 CPU 和内存的使用，当设备使用它的物理硬件时，由于 Cocos2d 处理事物的方式（逐帧，在“游戏循环”中），时间是关闭的。当你开始做一些事情时，帧率下降并且 Cocos 错误......尤其是当你的时间表运行得非常接近时，或者时间表会自行取消并以不同的时间重新安排（增量低至 0.1 及以下是我遇到最多的地方）。

# xcode - CMake、Xcode 和 Unix Makefile

> ID：751837
> 
> 赞同：26
> 
> 时间：2009-04-15T14:00:48.197
> 
> 标签：xcode, makefile, cmake

我一直在使用经典的 Unix Makefile 生成器，直到我找到一个解释 CMake 可以使用“cmake -G Xcode”生成一个不错的 xcode 项目文件的网页，所以我在我的源目录中运行了该命令，我得到了一个不错的 xcode 项目。这很好，但我面临一些缺点，想知道是否有解决方案：

*   现在我不能使用 unix makefiles 构建树（我曾经在构建目录中运行 cmake ../myproj 然后 make 命令）这不再起作用（我想项目目录中的临时文件负责）

*   我的一些头文件是由 cmake 生成的（myproj.h.in 变成了 myproj.h，例如包含在一些测试中），但我在我得到的 xcode 项目中找不到这些文件。

在此先感谢您就如何将 xcode 项目和 unix makefile 结合使用以同时使用两者的任何好的建议。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-16T09:07:26.757

我自己找到了答案（我的意思是问好人）：

为每种类型的构建文件使用 2 个单独的构建目录。这将确保每个构建目录都有正确的构建文件和生成的文件供其使用。

在 add_executable() 命令中，除了源文件之外，还包括头文件和生成的头文件，以便在 Xcode 中显示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-01-12T01:08:44.037

您可以使用 xcodebuild 仍然拥有一个正确的 Xcode 项目并从命令行/shell 脚本/Makefile 构建它，例如

```
xcodebuild -project MyProject.xcodeproj -target MyTarget -configuration Release 
```

# sql - 使用 UNION 运算符在 SQL 视图上创建索引？它真的会提高性能吗？

> ID：751838
> 
> 赞同：18
> 
> 时间：2009-04-15T14:00:54.920
> 
> 标签：sql, sql-server, database, views

我正在尝试在以下视图上创建索引：

```
SELECT     'Candidate' AS Source, CandidateID AS SourceId, LastName + ', ' + FirstName AS SourceName
FROM         dbo.Candidates
UNION
SELECT     'Resource' AS Source, ResourceID AS SourceId, LastName + ', ' + FirstName AS SourceName
FROM         dbo.Resources
UNION
SELECT     'Deal' AS Source, DealID AS SourceId, CONVERT(varchar, Number) + '-' + CONVERT(varchar, RevisionNumber) AS SourceName
FROM         dbo.Deals
UNION
SELECT     'Job Order' AS Source, JobOrderID AS SourceId, CustomerNumber AS SourceName
FROM         dbo.JobOrders 
```

我收到以下错误：

```
Msg 1939, Level 16, State 1, Line 2
Cannot create index on view '_Source' because the view is not schema bound. 
```

我将 WITH SCHEMABINDING 添加到 CREATE 中，现在出现以下错误：

```
Msg 10116, Level 16, State 1, Line 2
Cannot create index on view 'DEALMAKER.dbo._Source' because it contains one or more UNION, INTERSECT, or EXCEPT operators. Consider creating a separate indexed view for each query that is an input to the UNION, INTERSECT, or EXCEPT operators of the original view. 
```

我的问题是：

我将如何在此视图上创建索引？创建单独的索引视图**真的**有效吗？

最后，我**真的**会看到任何可能加入此视图的查询的性能改进吗？

提前致谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-15T14:02:03.950

您不能在使用联合运算符的视图上创建索引。实在是没办法，抱歉！

我想你已经看到了，但是看看这个[MSDN 页面](http://msdn.microsoft.com/en-us/library/ms191432.aspx)。它给出了索引视图的要求并解释了它们是什么以及它们是如何工作的。

至于如果您可以索引视图是否会看到性能优势，这将完全取决于您的表的大小。我不希望对创建单独的索引视图有任何影响，因为我假设您的表已经被索引并且您没有在视图中执行任何连接或逻辑。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-15T15:08:36.943

**你为什么在世界上使用 UNION？**

使用 SQL 中的文字，出现重复的可能性为零。再说一遍，为什么要使用 UNION？

UNION 强制发生不同的事情，并且比 DISTINCT 慢一点。

但既然你有这样的东西：

```
SELECT 'A'
UNION
SELECT 'B'
UNION
SELECT 'C' 
```

你不可能有重复的。

将其更改为 UNION ALL，您的查询将执行得更快。

这是基本的 SQL - 编写一个经过良好调整的查询比创建视图索引更重要。从基础开始，了解 SQL，调整查询，然后担心花费空间和减慢 DML 以提高查询速度。

## 编辑：

查询中的文字可以防止表之间的重复。唯一剩下的可能性是表中的欺骗。由于列看起来像 PK，并且没有可能导致重复的连接，而且表看起来都像查找表，所以我说的是正确的。如果该假设不正确，那么您**可能**在没有 ALL 的情况下合法使用 UNION。然而，我发现 99% 的时间人们真的打算使用 ALL 并且我们公司的标准是仅使用 UNION 向 SQL 添加注释，因为它经常是一个错误。即联合——是的，我需要一个不同的列表。

# c++ - 如何在 OpenGL 中使纹理透明？

> ID：751840
> 
> 赞同：5
> 
> 时间：2009-04-15T14:01:16.650
> 
> 标签：c++, opengl, textures, opacity

我试图在谷歌上对此进行研究，但在我看来没有任何连贯的简单答案。这是因为它不简单，还是因为我没有使用正确的关键字？

尽管如此，这是我迄今为止取得的进展。

1.  创建 8 个顶点以形成 2 个正方形。
2.  创建了一个具有 200 位 alpha 值的纹理（因此，大约 80% 透明）。
3.  为每个正方形分配了相同的纹理，显示正确。
4.  注意到当我使用 255 alpha 的纹理时，它看起来更亮。

init 类似于以下内容：

```
glClearColor(0.0, 0.0, 0.0, 0.0);
glShadeModel(GL_FLAT);
glEnable(GL_DEPTH_TEST);

glEnable(GL_CULL_FACE);
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
glGenTextures(1, textureIds);
glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);

int i, j;
GLubyte pixel;
for (i = 0; i < TEXTURE_HEIGHT; i++)
{
    for (j = 0; j < TEXTURE_WIDTH; j++)
    {
        pixel = ((((i & 0x8) == 0) ^ ((j & 0x8) == 0)) * 255);
        texture[i][j][0] = pixel;
        texture[i][j][1] = pixel;
        texture[i][j][2] = pixel;
        texture[i][j][3] = 200;
    }
}

glBindTexture(GL_TEXTURE_2D, textureIds[0]);

glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);

glTexImage2D(
    GL_TEXTURE_2D, 0, GL_RGBA,
    TEXTURE_WIDTH, TEXTURE_HEIGHT,
    0, GL_RGBA, GL_UNSIGNED_BYTE, texture); 
```

这有点类似于*OpenGL Programming Guide*书中第 417 页的代码片段，并创建了一个检查模式。

然后，显示功能包含...

```
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glEnable(GL_TEXTURE_2D);

// Use model view so that rotation value is literal, not added.
glMatrixMode(GL_MODELVIEW);
glPushMatrix();

// ... translation, etc ...

glBindTexture(GL_TEXTURE_2D, textureIds[0]);
glBegin(GL_QUADS);
glTexCoord2f(0.0, 0.0); glVertex3f(-1.0, +1.0, 0.0); // top left
glTexCoord2f(0.0, 1.0); glVertex3f(-1.0, -1.0, 0.0); // bottom left
glTexCoord2f(1.0, 1.0); glVertex3f(+1.0, -1.0, 0.0); // bottom right
glTexCoord2f(1.0, 0.0); glVertex3f(+1.0, +1.0, 0.0); // top right
glEnd();

    // not neccecary to repeat, just good practice
glBindTexture(GL_TEXTURE_2D, textureIds[0]);
glBegin(GL_QUADS);
glTexCoord2f(0.0, 0.0); glVertex3f(-0.5, +1.0, -1.0); // top left
glTexCoord2f(0.0, 1.0); glVertex3f(-0.5, -1.0, -1.0); // bottom left
glTexCoord2f(1.0, 1.0); glVertex3f(+1.5, -1.0, -1.0); // bottom right
glTexCoord2f(1.0, 0.0); glVertex3f(+1.5, +1.0, -1.0); // top right
glEnd();

glFlush();
glDisable(GL_TEXTURE_2D);

glPopMatrix();

SwapBuffers(); 
```

因此，这会在背景中呈现第二个正方形；我可以看到这一点，但看起来它们正在与背景混合（我假设这是因为它们在 200 位 alpha 中比 255 位更暗）而不是背后的纹理......

![透明纹理不起作用](https://i.stack.imgur.com/ducoN.png)

如您所见，没有透明度......我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-15T16:10:20.833

因此，此处但已删除的另一个答案提到了这一点-通常，要使 alpha 混合正常工作，您需要在相机坐标系中从远到近对对象进行排序。
这就是您的多边形与背景混合的原因。您可以通过禁用深度测试来确认这确实是问题所在。如果没有深度测试，所有片段都会显示出来，您将能够看到 alpha 混合。

更多关于这个在[这个页面。](http://www.opengl.org/resources/faq/technical/transparency.htm)

# file - 非常大的 Jar 文件和 FAT32

> ID：751845
> 
> 赞同：1
> 
> 时间：2009-04-15T14:01:41.003
> 
> 标签：file, jar, fat32, bigdata

我正在对我们正在开发的一大块桌面应用程序进行一些分析。

一个要求是它能够对一些传统文件格式进行 i/o，实际上每个文件格式运行高达 800Mb。可以合理地预期导入的大小约为 5Gb。

理想情况下，我只需将我想要的任何文件粘贴到 jar 文件中，签署该文件，然后将其发送出去以便稍后重新导入。

但据我所知，我们的应用程序必须支持 XP Pro (FAT32)，其最大文件大小限制约为 4Gb。

我必须将我的数据分成多个块吗？（因此承担跟踪正在发生的事情的复杂性？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:13:17.963

没有其他方法可以在 FAT32 上存储 5GB 数据，而不是将其分成块。

编写一个处理超过 4GB 档案的例程，即拆分和合并。将它封装在某个 util 类或 util 文件中，并从您的保存/加载方法中调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T14:11:50.853

fat 32 上的最大文件大小是 4gb（实际上是 4Gb - 2bytes），所以如果你必须使用它并且你的单个文件已经结束，你将不得不拆分它。

# c# - C# Virtual 和 Override 的内部工作原理

> ID：751849
> 
> 赞同：9
> 
> 时间：2009-04-15T14:02:17.523
> 
> 标签：c#, inheritance, virtual, overriding

C# virtual 和 override 机制如何在内部工作的话题已经在程序员中讨论死了......但是在谷歌上半小时后，我找不到以下问题的答案（见下文）：

使用一个简单的代码：

> ```
> public class BaseClass
> {
>   public virtual SayNo() { return "NO!!!"; }
> }
> 
> public class SecondClass: BaseClass
> {
>   public override SayNo() { return "No."; }
> }
> 
> public class ThirdClass: SecondClass
> {
>   public override SayNo() { return "No..."; }
> }
> 
> class Program
> {
>   static void Main()
>   {
>      ThirdClass thirdclass = new ThirdClass();
>      string a = thirdclass.SayNo(); // this would return "No..."
> 
>      // Question: 
>      // Is there a way, not using the "new" keyword and/or the "hide"
>      // mechansim (i.e. not modifying the 3 classes above), can we somehow return
>      // a string from the SecondClass or even the BaseClass only using the 
>      // variable "third"?
> 
>      // I know the lines below won't get me to "NO!!!"
>      BaseClass bc = (BaseClass)thirdclass;
>      string b = bc.SayNo(); // this gives me "No..." but how to I get to "NO!!!"?
>   }
> } 
> ```

我想我不能简单地使用最派生的实例（不修改3个类的方法签名）来获取基类或中间派生类的方法。但我想确认并巩固我的理解......

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-15T14:29:19.393

C# 无法做到这一点，但*实际上*在 IL 中可以使用`call`而不是`callvirt`. 因此，您可以通过[`Reflection.Emit`](http://msdn.microsoft.com/en-us/library/3y322t50.aspx)与[`DynamicMethod`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.dynamicmethod.aspx).

这是一个非常简单的例子来说明它是如何工作的。如果您真的打算使用它，请将其包装在一个不错的函数中，以使其与不同的委托类型一起使用。

```
delegate string SayNoDelegate(BaseClass instance);

static void Main() {
    BaseClass target = new SecondClass();

    var method_args = new Type[] { typeof(BaseClass) };
    var pull = new DynamicMethod("pull", typeof(string), method_args);
    var method = typeof(BaseClass).GetMethod("SayNo", new Type[] {});
    var ilgen = pull.GetILGenerator();
    ilgen.Emit(OpCodes.Ldarg_0);
    ilgen.EmitCall(OpCodes.Call, method, null);
    ilgen.Emit(OpCodes.Ret);

    var call = (SayNoDelegate)pull.CreateDelegate(typeof(SayNoDelegate));
    Console.WriteLine("callvirt, in C#: {0}", target.SayNo());
    Console.WriteLine("call, in IL: {0}", call(target));
} 
```

印刷：

```
callvirt, in C#: No.
call, in IL: NO!!! 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T14:06:10.337

如果不修改您的样本并打折反射，则没有任何办法。虚拟系统的目的是无论如何都强制调用派生类，CLR 擅长其工作。

不过，有几种方法可以解决这个问题。

选项 1：您可以将以下方法添加到 ThirdClass

```
public void SayNoBase() {
  base.SayNo();
} 
```

这将强制调用 SecondClass.SayNo

选项 2：这里的主要问题是您想以非虚拟方式调用虚拟方法。C# 仅提供一种通过 base 修饰符执行此操作的方法。这使得在您自己的类中以非虚拟方式调用方法成为不可能。您可以通过将其分解为第二种方法并代理来解决此问题。

```
public overrides void SayNo() {
  SayNoHelper();
}

public void SayNoHelper() {
  Console.WriteLine("No");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T14:06:54.017

当然...

```
 BaseClass bc = new BaseClass();
   string b = bc.SayNo(); 
```

“虚拟” *意味着*将要执行的实现是基于底层对象的实际类型，而不是它所填充的变量的类型......所以如果实际对象是第三类，那就是你将得到的实现，无论您将其投射到什么位置。如果您想要上面描述的行为，请不要将方法设为虚拟...

如果您想知道“有什么意义？” 它用于“多态性”；这样您就可以将集合或方法参数声明为某种基类型，并包含/传递它的派生类型的混合，然而，在代码中，即使每个对象都分配给声明为基类型，对于每一个，将为任何虚拟方法调用执行的实际实现将是在类定义中为每个对象的 ACTUAL tyoe 定义的实现......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T17:35:34.390

在 C# 中使用`base`仅适用于直接基础。您无法访问 base-base 成员。

看起来其他人用关于它可以在伊利诺伊州做的答案打败了我。

但是，我认为我编写代码的方式有一些优势，所以无论如何我都会发布它。

我所做的不同之处在于使用表达式树，它使您能够使用 C# 编译器进行重载解析和泛型参数替换。

那东西很复杂，如果你能提供帮助，你不想自己复制它。在您的情况下，代码将像这样工作：

```
var del = 
    CreateNonVirtualCall<Program, BaseClass, Action<ThirdClass>>
    (
        x=>x.SayNo()
    ); 
```

您可能希望将委托存储在只读静态字段中，以便您只需编译一次。

您需要指定 3 个通用参数：

1.  所有者类型 - 如果您不使用“CreateNonVirtualCall”，这是您将调用代码的类。

2.  基类 - 这是您要从中进行非虚拟调用的类

3.  委托类型。这应该表示使用“this”参数的额外参数调用的方法的签名。可以消除这种情况，但需要在代码生成方法中进行更多工作。

该方法接受一个参数，一个表示调用的 lambda。它必须是一个电话，而且只有一个电话。如果你想扩展代码生成，你可以支持更复杂的东西。

为简单起见，lambda body 被限制为只能访问 lambda 参数，并且只能将它们直接传递给函数。如果您扩展方法主体中的代码生成以支持所有表达式类型，则可以删除此限制。但这需要一些工作。你可以对回来的代表做任何你想做的事情，所以限制并不是什么大不了的事。

需要注意的是，这段代码并不完美。它可以使用更多的验证，并且由于表达式树的限制，它不适用于“ref”或“out”参数。

我确实在示例案例中使用 void 方法、返回值的方法和泛型方法对其进行了测试，并且成功了。但是，我敢肯定，您会发现一些不起作用的边缘情况。

无论如何，这是 IL Gen 代码：

```
public static TDelegate CreateNonVirtCall<TOwner, TBase, TDelegate>(Expression<TDelegate> call) where TDelegate : class
{
    if (! typeof(Delegate).IsAssignableFrom(typeof(TDelegate)))
    {
        throw new InvalidOperationException("TDelegate must be a delegate type.");
    }

    var body = call.Body as MethodCallExpression;

    if (body.NodeType != ExpressionType.Call || body == null)
    {
        throw new ArgumentException("Expected a call expression", "call");
    }

    foreach (var arg in body.Arguments)
    {
        if (arg.NodeType != ExpressionType.Parameter)
        {
            //to support non lambda parameter arguments, you need to add support for compiling all expression types.
            throw new ArgumentException("Expected a constant or parameter argument", "call");
        }
    }

    if (body.Object != null && body.Object.NodeType != ExpressionType.Parameter)
    {
        //to support a non constant base, you have to implement support for compiling all expression types.
        throw new ArgumentException("Expected a constant base expression", "call");
    }

    var paramMap = new Dictionary<string, int>();
    int index = 0;

    foreach (var item in call.Parameters)
    {
        paramMap.Add(item.Name, index++);
    }

    Type[] parameterTypes;

    parameterTypes = call.Parameters.Select(p => p.Type).ToArray();

    var m = 
        new DynamicMethod
        (
            "$something_unique", 
            body.Type, 
            parameterTypes,
            typeof(TOwner)
        );

    var builder = m.GetILGenerator();
    var callTarget = body.Method;

    if (body.Object != null)
    {
        var paramIndex = paramMap[((ParameterExpression)body.Object).Name];
        builder.Emit(OpCodes.Ldarg, paramIndex);
    }

    foreach (var item in body.Arguments)
    {
        var param = (ParameterExpression)item;

        builder.Emit(OpCodes.Ldarg, paramMap[param.Name]);
    }

    builder.EmitCall(OpCodes.Call, FindBaseMethod(typeof(TBase), callTarget), null);

    if (body.Type != typeof(void))
    {
        builder.Emit(OpCodes.Ret);
    }

    var obj = (object) m.CreateDelegate(typeof (TDelegate));
    return obj as TDelegate;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T14:04:41.010

您无法访问覆盖的基本方法。无论您如何投射对象，始终使用实例中的最后一个覆盖。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T14:21:49.690

如果它支持一个字段，您可以使用反射拉出该字段。

即使您使用来自 typeof(BaseClass) 的反射来取消方法信息，您仍将最终执行您覆盖的方法

# delphi - 临时表资源限制

> ID：751850
> 
> 赞同：0
> 
> 时间：2009-04-15T14:02:39.627
> 
> 标签：delphi, bde, midas-server

我有两个应用程序（服务器和客户端），它们使用通过 TDCOMConnection 与 TClientDataSet 连接的 TQuery，在某些情况下，客户端数据集打开大约 300000 条记录，然后应用程序抛出异常“临时表资源限制”。

有什么解决方法可以解决这个问题吗？（除了“不要打开这么大的数据集”？）

更新：哎呀，对不起，有 300K 记录，而不是 300 万..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-16T00:52:15.620

错误可能来自 TQuery 而不是 TClientDataSet。使用 TQuery 时，它会创建一个临时表，您可能会遇到这个限制。然而，在这样说时，将 3,000,000 条记录加载到 TClientDataSet 中也是一个坏主意，因为它也会尝试将每条记录加载到内存中——如果它们每个只有几个字节，这可能是可能的，但它可能仍然会杀死你的机器（显然在每个 1kb 的情况下，您至少需要 3GB 的 RAM）。

您应该尝试将数据分成更小的块。如果是 TQuery 失败，这将意味着调整 SQL（更少的字段/更少的记录）或迁移到更好的数据库（毕竟 BDE 有点累了）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-15T15:25:51.270

你已经有了答案。不要在 ClientDataSet (CDS) 中打开如此庞大的数据集。

CDS 中的 300 万行是一个巨大的内存负载（取决于每行的大小，它可能是巨大的）。

使用 CDS 的全部目的是快速处理可在内存中操作的小型数据集。添加那么多行是荒谬的。改用真实的数据集，或者重新设计一些东西，这样您就不需要一次检索这么多行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T15:51:36.730

一次处理超过 300 万条记录实在是太多了。我的猜测是您正在执行导出或类似的操作，这需要通过网络发送许多记录。您可以用来减少此问题的一种方法是让中间层生成一个导出文件，然后将该文件交付给客户端（最好先使用 ZLIB 或类似的东西进行压缩）。

如果您将数据拉回客户端以供查看，请考虑仅发送摘要信息，然后允许客户端一次通过数据挖掘一部分。用户会感谢你，因为你的表现会大大提高，他们不必通过他们不关心的记录来挖掘。

**编辑**

即使是 300,000 条记录，一次处理也太多了。如果你有那么多便士，你能扛得住吗？但如果你把它变成更大的面额，你可以。如果您将数据发送给客户以获取报告，那么我强烈建议采用汇总方法……给他们一张大图，让他们慢慢钻研数据。发送分组数据，然后让它们慢慢打开。

如果这是一个搜索结果屏幕，那么设置返回记录数的限制+1。例如显示100条记录，设置限制为101。仍然只显示100条，最后一条记录意味着有MORE超过100 条记录，因此客户需要调整他们的搜索条件以返回较小的子集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-16T09:01:39.587

临时表资源限制不是单个查询的限制。它是所有打开查询的限制。所以它可能是您当时关闭所有其他查询的解决方案。

如果不能使用ADO连接，也可以设计一种分页机制，逐页查询数据。

祝你好运

# java - JSF 数据表中的多个页脚行

> ID：751860
> 
> 赞同：10
> 
> 时间：2009-04-15T14:03:57.190
> 
> 标签：java, jsf, datatable

我想知道是否有任何方法可以在 ah:dataTable （或 t:datatable）中有多个页脚行 我想做这样的事情（不编译）

```
<h:dataTable ... var="row">
  <h:column>
    <f:facet name="header">
     Header
    </f:facet>
    <h:outputText value="#{row.value}"/>
    <f:facet name="footer">
     FirstFooter
    </f:facet>
    <f:facet name="footer">
     Second Footer in a new tr
    </f:facet>
  </h:column>
</h:dataTable> 
```

结果是这样的

```
<table border=1 style="border:1px solid">
<thead><tr><th>Header</th></tr></thead>
<tbody><tr><td>Data Value 1</td></tr>
<tr><td>Data Value 2</td></tr>
<tr><td>Data Value ...</td></tr>
<tr><td>Data Value n</td></tr>
</tbody>
<tfoot>
<tr><td>FirstFooter</td></tr>
<tr><td>Second Footer in a new tr</td></tr>
</tfoot>
</table> 
```

任何想法如何最好地做到这一点？谢谢。

编辑：如果我可以避免使用自定义控件/自定义渲染器，那就太好了

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T10:46:01.530

我最终使用的解决方案是与 t:datatable 关联的自定义渲染器（数据表的 tomahawk 扩展）

```
public class HtmlMultiHeadTableRenderer extends HtmlTableRenderer 
```

我只需要覆盖一种方法

```
protected void renderFacet(FacesContext facesContext,   
  ResponseWriter writer, UIComponent component, boolean header) 
```

在其中我查找名称为 header、header2、header3 ... headerN 的构面（一旦缺少一个，我就停止查找）并且与页脚相同。这让我可以做类似的代码

```
<h:dataTable ... var="row">
  <h:column>
    <f:facet name="header">
     Header
    </f:facet>
    <f:facet name="header2">
     A second Tr with th's
    </f:facet>
    <h:outputText value="#{row.value}"/>
    <f:facet name="footer">
     FirstFooter
    </f:facet>
    <f:facet name="footer2">
     Second Footer in a new tr
    </f:facet>
  </h:column>
</h:dataTable> 
```

这花了大约一天的时间（还有一些其他的扩展，比如允许基于组的 colspans）来编码和记录，

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T17:20:06.253

正如 McDowell 所说，panelGrid 将在没有自定义控件的情况下执行您所要求的操作，除非我遗漏了什么。

```
<f:facet name="footer">
    <h:panelGrid columns="1"> 
        <h:outputText value="FirstFooter" />
        <h:outputText value="Second Footer in a new tr" />
    </h:panelGrid>
</f:facet> 
```

这呈现如下

```
<tfoot>
    <tr>
        <td colspan="3">
            <table>
                <tbody>
                    <tr>
                        <td>FirstFooter</td>
                    </tr>
                    <tr>
                        <td>Second Footer in a new tr</td>
                    </tr>
                </tbody>
            </table>
        </td>
    </tr>
</tfoot> 
```

您也可以在 panelGrid 中使用除 outputText 之外的标签来获得您想要的任何效果（只需确保将它们包装在 panelGroup 或类似的东西中）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T09:15:34.510

Richfaces 列具有 breakBefore 属性，允许您执行以下操作：

```
<f:facet name="footer">
    <rich:column>
        <h:outputText value="First Footer"/>
    </rich:column>
    <rich:column breakBefore="true">
        <h:outputText value="Second Footer"/>
    </rich:column>
</f:facet> 
```

这就是您所追求的，但不幸的是没有使用您指定的库。

如果您使用的是 Facelets，您总是可以使用*ui:repeat*构建一个常规表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T15:51:58.943

（构面必须具有唯一的名称（它们存储在[构面图](http://java.sun.com/javaee/5/docs/api/javax/faces/component/UIComponent.html#getFacets())中）。）

有两种方法可以做到这一点：

1.  只需在页脚中放置一个[panelGrid](http://java.sun.com/javaee/javaserverfaces/1.2_MR1/docs/tlddocs/h/panelGrid.html)并使用样式表来获得您想要的外观。
2.  创建一个呈现[您](http://java.sun.com/javaee/5/docs/api/javax/faces/render/Renderer.html)想要的标记的[自定义组件。](http://java.sun.com/javaee/5/docs/tutorial/doc/bnatt.html#bnatw)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-28T16:37:58.363

我不能使用自定义渲染器，所以我在 JSF 中使用纯 html 完成了它：

```
 <t:dataTable value="#{...}" var="...">

             <f:facet name="header">
                 <h:outputText escape="false" value="&lt;/th&gt;&lt;/tr&gt;"/>
                <tr>
                    <th rowspan="2" class="tableHeaderLightGrey">
                        Zeit
                    </th>

                    <th colspan="#{filterController.trafficClass.size()}" class="tableHeaderLightGrey">
                        Verbrauch
                    </th>
                    <th colspan="#{filterController.trafficClass.size()}" class="tableHeaderLightGrey">
                        Bandbreite
                    </th>
                    <th colspan="#{filterController.trafficClass.size()}" class="tableHeaderLightGrey">
                        Auslastung
                    </th>

                    <th rowspan="2" class="tableHeaderLightGrey">
                        Gesamtauslastung
                    </th>
                </tr>
                <tr>
                   <c:forEach items="#{filterController.trafficClass}" var="trafficClass">
                        <th class="tableHeaderLightGrey">
                            #{trafficClass.name}
                        </th>
                    </c:forEach>

                    <c:forEach items="#{filterController.trafficClass}" var="trafficClass">
                        <th class="tableHeaderLightGrey">
                            #{trafficClass.name}
                        </th>
                    </c:forEach>

                    <c:forEach items="#{filterController.trafficClass}" var="trafficClass">
                        <th class="tableHeaderLightGrey">
                            #{trafficClass.name}
                        </th>
                    </c:forEach>
                </tr>
                 <h:outputText escape="false" value="&lt;tr&gt;&lt;th&gt;"/>

             </f:facet>

            ... columns ...

        </t:dataTable> 
```

标题方面打开了一个`<tr><th>`我立即使用输出文本关闭并在最后再次打开以获取有效 html 的内容。`<tr><th></th></tr>`这样，您将在自定义标题之前和之后得到一个空白，但在我的情况下这是可以接受的。

# matrix - MPI矩阵多重编译错误：未用代码声明

> ID：751861
> 
> 赞同：0
> 
> 时间：2009-04-15T14:03:58.830
> 
> 标签：matrix, mpi

我编写了一个 mpi 矩阵乘法程序，它使用`scanf("%d", &size)`, 指定矩阵大小，然后我定义`int matrix[size*size]`了 ，但是当我编译它时，它报告矩阵未声明。请告诉我为什么，或者我的问题是什么！

根据 Ed 的建议，我将矩阵定义更改为 if(myid == 0) 块，但得到了同样的错误！现在我发布我的代码，请帮助我找出我出错的地方！谢谢你！

```
int size;

int main(int argc, char* argv[]) {

int myid, numprocs; 
int *p; 
MPI_Status status; 
int i,j,k; 
MPI_Init(&argc, &argv); 
MPI_Comm_rank(MPI_COMM_WORLD,&myid); 
MPI_Comm_size(MPI_COMM_WORLD, &numprocs); 
if(myid == 0)
 {       
  scanf("%d", &size); 
  int matrix1[size*size];
  int matrix2[size*size]; 
  int matrix3[size*size];
  int section = size/numprocs; 
  int tail = size % numprocs; 
  srand((unsigned)time(NULL));
  for( i=0; i<size; i++) 
     for( j=0; j<size; j++)
        { 
            matrix1[i*size+j]=rand()%9;
            matrix3[i*size+j]= 0; 
            matrix2[i*size+j]=rand()%9; 
         }            
      printf("Matrix1 is: \n"); 
      for( i=0; i<size; i++) 
         {            
             for( j=0; j<size; j++)
              {
                  printf("%3d", matrix1[i*size+j]); 
              }       
             printf("\n");   
         }         
       printf("\n");   
       printf("Matrix2 is: \n"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-15T14:26:05.733

重新格式化的代码会很好......

一个问题是您没有声明 size 变量。另一个问题是声明数组的 [size] 符号只适用于在编译时已知的大小。你想`malloc()`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T22:06:36.370

如果您使用动态内存分配，您实际上不需要定义 MAX_SIZE。

```
#include <stdio.h>
#include <stdlib.h>
...
   scanf("%d", &size); 
   int *matrix1 = (int *) malloc(size*size*sizeof(int)); 
   int *matrix2 = (int *) malloc(size*size*sizeof(int)); 
   int *matrix3 = (int *) malloc(size*size*sizeof(int));
... 
```

# sql-server - 压缩数据库中的数据

> ID：751875
> 
> 赞同：0
> 
> 时间：2009-04-15T14:07:58.007
> 
> 标签：sql-server, database, compression

鉴于我目前在 Google 上的（缺乏）发现，Quick q 可能是一个愚蠢的问题。

我有一个数据库。在这个数据库中是一个带有一些数据的表。数据是一个大的 BLOB，但无法压缩（出于我无法控制的原因）。

我有一个与该数据库对话的应用程序。我真的希望能够确保数据在传输过程中被压缩。

据我了解，数据库提供程序将处理压缩等。

是这样吗？是否有常见的设置，比如 SQL Server 以启用压缩？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T14:13:08.743

对于 SQL Server，我找到[了这个“连接”条目](http://connect.microsoft.com/SQLServer/feedback/ViewFeedback.aspx?FeedbackID=412131)，但没有：我认为 TDS 当前没有被压缩。您可以（虽然我不太喜欢它）使用 SQL-CLR 在 .NET 代码中压缩它，但它可能会产生太多开销。

我知道在这种情况下它不是一个选项（来自问题），但通常最好以您想要获取它们的方式存储 BLOB。因此，如果您想压缩它们，请将它们压缩存储。SQL 不是处理二进制文件的好工具；-p 这样的策略还意味着您没有使用供应商特定的功能 - 只是存储不透明 BLOB 的能力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:34:19.457

如果您的数据库访问层不提供压缩，您可以在数据库服务器和应用程序主机之间建立 VPN 链接。最重要的 VPN 解决方案会压缩传输中的数据。[OpenVPN](http://openvpn.net)是一种简单且易于设置的解决方案，用于快速创建隧道。数据在传输过程中被压缩。可能不会像本机压缩那样有效，但它是一种可能的解决方案。而且您可以免费获得加密:)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T14:18:51.413

SQL Server 2008 是第一个原生支持备份压缩的 SQL Server 版本。2008 年之前，您需要使用第三方产品。

# ios - 在 iPhone 或 iPad 上遍历视图层次结构

> ID：751876
> 
> 赞同：43
> 
> 时间：2009-04-15T14:08:00.003
> 
> 标签：ios, debugging, cocoa-touch, view-hierarchy

这是一个有用的例程，您可以在 iOS 应用程序中使用它来遍历视图层次结构，当您想知道正在创建什么以及它要去哪里时。

此例程将视图层次结构转储到`NSLog()`从传入的视图开始。子视图在 subviews 数组和所有超类中按顺序显示它们的索引，以冒号分隔，最后是帧大小。

要转储应用程序的整个视图层次结构，请调用如下方法：

```
dumpViews([[UIApplication sharedApplication] keyWindow], @"", @""); 
```

要显示相机视图的层次结构，请在控制器中覆盖此方法：`navigationController:willShowViewController:viewController:animated:`

并像这样调用转储例程：

```
dumpViews(self.modalViewController.view, @"", @""); 
```

对于所有其他视图：

```
dumpViews(myView, @"", @""); 
```

## 资源

```
void dumpViews(UIView* view, NSString *text, NSString *indent) 
{
    Class cl = [view class];
    NSString *classDescription = [cl description];
    while ([cl superclass]) 
    {
        cl = [cl superclass];
        classDescription = [classDescription stringByAppendingFormat:@":%@", [cl description]];
    }

    if ([text compare:@""] == NSOrderedSame)
        NSLog(@"%@ %@", classDescription, NSStringFromCGRect(view.frame));
    else
        NSLog(@"%@ %@ %@", text, classDescription, NSStringFromCGRect(view.frame));

    for (NSUInteger i = 0; i < [view.subviews count]; i++)
    {
        UIView *subView = [view.subviews objectAtIndex:i];
        NSString *newIndent = [[NSString alloc] initWithFormat:@"  %@", indent];
        NSString *msg = [[NSString alloc] initWithFormat:@"%@%d:", newIndent, i];
        dumpViews(subView, msg, newIndent);
        [msg release];
        [newIndent release];
    }
} 
```

## 示例相机转储

```
UIView:UIResponder:NSObject {{0, 0}, {320, 480}}
  0：PLCameraView:UIView:UIResponder:NSObject {{0, 0}, {320, 480}}
    0: UIView:UIResponder:NSObject {{0, 0}, {320, 427}}
    1: UIImageView:UIView:UIResponder:NSObject {{10000, 10000}, {320, 480}}
    2: UIView:UIResponder:NSObject {{0, 427}, {320, 53}}
    3：PLCropOverlay:UIView:UIResponder:NSObject {{0, 0}, {320, 480}}
      0: UIImageView:UIView:UIResponder:NSObject {{0, 20}, {320, 96}}
      1：PLCropLCDLayer:UIView:UIResponder:NSObject {{0, 20}, {320, 96}}
      2：TPBottomDualButtonBar:TPBottomButtonBar:TPBottomBar:UIView:UIResponder:NSObject {{0, 384}, {320, 96}}
        0：TPPushButton:UIThreePartButton:UIPushButton:UIControl:UIView:UIResponder:NSObject {{22, 26}, {128, 47}}
        1：TPCameraPushButton:TPPushButton:UIThreePartButton:UIPushButton:UIControl:UIView:UIResponder:NSObject {{170, 26}, {128, 47}}
          0: UIImageView:UIView:UIResponder:NSObject {{51, 12}, {26, 19}}

```

# c++ - 在构造函数初始化程序中确定数组大小

> ID：751878
> 
> 赞同：22
> 
> 时间：2009-04-15T14:08:43.153
> 
> 标签：c++, arrays, constructor, initialization

在下面的代码中，我希望在调用 Class 构造函数时将数组定义为大小为 x 的数组。我怎样才能做到这一点？

```
class Class
{
public:
  int array[];
  Class(int x) : ??? { }
} 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-09-04T21:19:05.797

你们这太复杂了。当然，您可以在 C++ 中执行此操作。为了效率，他使用普通的阵列就可以了。一个向量只有在他不提前知道数组的最终大小时才有意义，即它需要随着时间的推移而增长。

如果您可以知道链中更高一级的数组大小，那么模板类是最简单的，因为没有动态分配并且没有内存泄漏的机会：

```
template < int ARRAY_LEN > // you can even set to a default value here of C++'11

class MyClass
  {   
  int array[ARRAY_LEN]; // Don't need to alloc or dealloc in structure!  Works like you imagine!   
  }

// Then you set the length of each object where you declare the object, e.g.

MyClass<1024> instance; // But only works for constant values, i.e. known to compiler 
```

如果你在声明对象的地方不知道长度，或者你想重用不同长度的同一个对象，或者你必须接受一个未知的长度，那么你需要在你的构造函数中分配它并释放它你的析构函数......（理论上总是检查以确保它工作......）

```
class MyClass
  {
  int *array;

  MyClass(int len) { array = calloc(sizeof(int), len); assert(array); }   
  ~MyClass() { free(array); array = NULL; } // DON'T FORGET TO FREE UP SPACE!
  } 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-15T14:11:12.040

您不能使用在编译时无法计算的非常量维度来初始化数组的大小（至少在当前的 C++ 标准中，AFAIK 中没有）。

我建议使用`std::vector<int>`而不是数组。它为大多数操作提供了类似数组的语法。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-15T14:13:18.057

使用 new 运算符：

```
class Class
{
   int* array;
   Class(int x) : array(new int[x]) {};
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-15T14:16:40.997

我不认为它可以做到。至少不是你想要的方式。当大小来自动态信息 (x) 时，您无法创建静态大小的数组 (array[])。

您需要存储指向 int 的指针和大小，并重载复制构造函数、赋值运算符和析构函数来处理它，或者使用 std::vector。

```
class Class
{
  ::std::vector<int> array;
  Class(int x) : array(x) { }
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-06T10:09:37.323

很抱歉破坏了这个旧线程。实际上有一种方法可以找出数组编译时的大小。它是这样的：

```
#include <cstdlib>

template<typename T>
    class Class
    {
        T* _Buffer;

        public:
        template<size_t SIZE>
            Class(T (&static_array)[SIZE])
            {
                _Buffer = (T*)malloc(sizeof(T) * SIZE);

                memcpy(_Buffer, static_array, sizeof(T) * SIZE);
            }

            ~Class()
            {
                if(_Buffer)
                {
                    free(_Buffer);
                    _Buffer = NULL;
                }
            }
    };

int main()
{
    int int_array[32];
    Class<int> c = Class<int>(int_array);

    return 0;
} 
```

或者，如果你讨厌 malloc / new，那么你可以创建一个 size 模板类。不过，我不会真的推荐它，而且语法很丑陋。

```
#include <cstdio>

template<typename T, size_t SIZE>
    class Class
    {
        private:
            T _Array[sz];
        public:
            Class(T (&static_array)[SIZE])
            {
                memcpy(_Array, static_array, sizeof(T) * SIZE);
            }
    };

int main()
{
    char int_array[32];
    Class<char, sizeof(int_array)> c = Class<char, sizeof(int_array)>(int_array);
    return 0;
} 
```

无论如何，我希望这会有所帮助:)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-12-06T07:05:54.340

你不明白没有必要使用向量，如果一个人想使用数组，这是一个效率问题，例如更少的空间，没有复制时间（在这种情况下，如果处理得当，甚至不需要删除数组中的数组析构函数）等。无论出于何种原因。

正确答案是：（引用）

```
class Class
{
   int* array;
   Class(int x) : array(new int[x]) {};
}; 
```

不要试图强迫一个人使用非最佳替代方案，否则你会迷惑没有经验的程序员

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T14:13:09.587

为什么不使用原始数组，而不是使用向量。

```
class SomeType {
  vector<int> v;
  SomeType(size_t x): v(x) {}
}; 
```

使用向量将为您提供面对异常时的自动泄漏保护以及与原始数组相比的许多其他好处。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-10-13T05:47:54.270

我有同样的问题，我用这种方式解决了

```
class example
{
  int *array;

  example (int size)
  {
    array = new int[size];
  }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-05-28T14:53:50.333

就像已经建议的那样，对于大多数情况，向量是一个不错的选择。

或者，如果要避免动态内存分配并且在编译时已知最大大小，则可以将自定义分配器与 std::vector 一起使用，或者可以使用嵌入式模板库之类的库。

见这里：[https ://www.etlcpp.com/home.html](https://www.etlcpp.com/home.html)

示例类：

```
 #include <etl/vector.h>

class TestDummyClass {
public:
    TestDummyClass(size_t vectorSize) {
        if(vectorSize < MAX_SIZE) {
            testVector.resize(vectorSize);
        }
    }

private:
    static constexpr uint8_t MAX_SIZE = 20;
    etl::vector<int, MAX_SIZE> testVector;
    uint8_t dummyMember = 0;
}; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-15T14:13:43.813

你不能在 C++ 中做到这一点 - 使用 std::vector 代替：

```
#include <vector>

struct A {
   std::vector <int> vec; 
   A( int size ) : vec( size ) {
   }
}; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-15T14:15:05.260

将您的数组声明为指针。您可以稍后通过 new 在初始化列表中对其进行初始化。

最好使用未知大小的向量。

您可能还想在可变长度数组上查看[这个问题。](https://stackoverflow.com/questions/737240/c-c-array-size-at-run-time-w-o-dynamic-allocation-is-allowed)

# vb.net - 将字符串列表转换为由分隔符分隔的字符串

> ID：751881
> 
> 赞同：47
> 
> 时间：2009-04-15T14:09:24.917
> 
> 标签：vb.net, string

将列表（字符串）转换为值由逗号（`,`）分隔的字符串的最佳方法是什么

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2009-04-15T14:12:19.447

```
String.Join(",", myListOfStrings.ToArray()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T14:34:07.320

这取决于您所说的“最佳”是什么意思。占用内存最少的是首先计算最终字符串的大小，然后创建具有该容量的 StringBuilder 并将字符串添加到其中。

StringBuilder 将创建一个大小正确的字符串缓冲区，该缓冲区是您从 ToString 方法中获得的字符串。这意味着没有创建额外的中间字符串或数组。

```
// specify the separator
string separator = ", ";

// calculate the final length
int len = separator.Length * (list.Count - 1);
foreach (string s in list) len += s.Length;

// put the strings in a StringBuilder
StringBuilder builder = new StringBuilder(len);
builder.Append(list[0]);
for (int i = 1; i < list.Count; i++) {
   builder.Append(separator).Append(list[i]);
}

// get the internal buffer as a string
string result = builder.ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-12-08T11:13:38.357

我的解决方案：

```
string = ["a","2"]\n
newstring = ""
endOfString = len(string)-1
for item in string:
    newstring = newstring + item
if item != string[endOfString]:
    newstring = newstring ","' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-07T21:47:43.957

一个简单的解决方案：

```
dim str as string = ""
for each item as string in lst
  str += ("," & item)
next
return str.substring(1) 
```

它从字符串中取出第一个字符`(",")`

# javascript - HTML JavaScript 包含文件变量范围

> ID：751882
> 
> 赞同：6
> 
> 时间：2009-04-15T14:09:30.890
> 
> 标签：javascript, html

如果我在我的 HTML 页面中包含一个 JavaScript 文件，我的 JavaScript 文件中声明的变量`<script />`在我的 HTML 页面的标签中是否也有作用域？例如，在我包含的 JS 文件中，我声明了一个变量：

```
var myVar = "test"; 
```

然后在我的 HTML 页面中，这会产生什么（如果它在我的包含脚本标记之后）？

```
alert(myVar); 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-15T14:14:14.437

如果您将*任何函数之外*的变量声明为

```
var myVar = 'test'; 
```

或在*任何*位置

```
myVar = 'test'; 
```

或者

```
window.myVar = 'test'; 
```

它应该被添加到全局对象（窗口）并在任何地方都可用

```
alert(myVar); 
```

或者

```
alert(window.myVar); 
```

或者

```
alert(window['myVar']); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T14:15:52.637

它将产生一个包含“测试”的警报。

在 JavaScript 的顶层声明的所有变量共享相同的作用域。如果你想在一个文件中使用不会与另一个文件冲突的变量，那么你可以使用匿名函数来引入一个新的范围：

```
var myVar = "something else";
(function () {var myVar = "test"; alert(myVar)})();
alert(myVar); 
```

**编辑**：正如 BYK 指出的那样，您可以通过分配一个对象文字将其扩展为类似于完整命名空间的东西：

```
var MyNamespace = (function () {
  var myVar = "something";
  return { alert: function() { alert(myVar) },
           setVar: function(value) { myVar = value } }
})(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:18:43.380

当您在代码中声明变量或函数时，您正在创建`window`. 考虑这些例子：

```
var a = 'Cow';
alert(window.a); // Cow
alert(this.a); // Cow
alert(a); // Cow 
```

`window`如果您在函数内声明变量，则除非您将其添加到对象中，否则您的变量将无法从其外部访问：

```
function lalala() {
    alert(a); // still Cow
    a = 'Pig'; // We're tired of cows by now. Let's make it a pig.
    var b = 'Sheep';
}
lalala();
alert(a); // Pig
alert(b); // undefined, since b is declared in the lalala scope 
```

因此，您的示例将 alert `test`。

# winforms - WinForms 与 GtkSharp 与 Mono

> ID：751884
> 
> 赞同：22
> 
> 时间：2009-04-15T14:10:25.413
> 
> 标签：winforms, mono, gtk#

当使用 Mono 开发要在 Windows 和 Mac OSX（可能还有 Linux）上运行的应用程序时，您会建议使用 WinForms 或 GtkSharp 作为 GUI，**为什么**？

将不胜感激具体的例子和成功/恐怖故事。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-06T19:54:38.873

跨平台开发是个好主意，但老实说，我从未见过在其原生环境之外看起来**真的很好的应用程序。**这就是为什么我认为，如果你真的想提供良好的用户体验，你应该在你想支持的所有平台上使用原生工具包。

当然，如果你只是想要一个概念证明，那么 Mac（或 Linux）上的 WinForms 就可以了，但如果你想要一个与其他原生解决方案竞争的应用程序，那么你真的应该考虑为每个支持的平台编写一个单独的原生前端。

[Mindjet的](http://www.mindjet.com/)[MindManager](http://www.mindjet.com/products/mindmanager/mac/)就是一个很好的例子。他们的 Mac 版本是一个完整的、从头开始重写的界面。结果是一个应用程序为 Mac 用户提供了他们在他们的平台上所期望的体验。

所以，回到单声道。Mono中有[Cocoa 绑定](http://www.mono-project.com/MonoMac)。就个人而言，我从未尝试过使用它们，但如果你想用你的应用程序来定位 Mac，它们当然值得一看。如果它们可以被视为在 Mac 上进行 UI 开发的有效选择，那就太好了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T14:17:31.200

在决定是否使用跨平台架构时，请衡量您对拥有紧凑 UI 的要求以及对变化和开发时间的敏捷性的要求。使用特定于平台的 UI 框架（几乎）总是会给您带来比跨平台框架更好的外观和更好的性能结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T14:41:00.860

GtkSharp 在 Mac OS X 上需要 X11。Mac 用户会发现这令人反感。我还没有在 OS X 上尝试过 Winforms，但是 mono 的 Linux winforms 支持非常不成熟（有缺陷）并且速度很慢。我认为目前还没有针对 OS X 的成熟 .net GUI 工具包，至少在 Swing 或 SWT 级别上没有。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-23T18:47:11.530

您的应用程序的大多数用户将拥有什么平台？如果大多数用户是 Windows 用户，请使用 Winforms，但如果大多数用户是 Linux 用户，请使用 Gtk#。我不知道哪一个在 OSX 上效果最好。

另请阅读这篇文章：[http ://www.mono-project.com/Gui_Toolkits](http://www.mono-project.com/Gui_Toolkits)

# objective-c - 当我在运行时只知道类名时，如何获取类对象

> ID：751885
> 
> 赞同：2
> 
> 时间：2009-04-15T14:10:29.077
> 
> 标签：objective-c, class, runtime

我需要从一个字符串中获取类对象，其中包含运行时类的名称。我找到了一个名为 objc_getClass 的函数，但我不确定它是否真的是我要搜索的。

我可以这样实现吗？NSString *name = @"AnyClass"; 类 *myClass = objc_getClass([name UTF8String]);

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T14:21:09.177

我相信您正在寻找的功能是：

```
NSClassFromString(@"AnyClass"); 
```

它可以让你做：

```
id obj = [[NSClassFromString(@"AnyClass") alloc] init]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T14:21:12.907

我自己找到了答案 ^^NSClassFromString 是我的朋友 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T14:17:46.050

你确定你不是说：

AnyClass *myClassInstance = [[AnyClass alloc] init];

或者这个类是否已经实例化并且你需要一个指向它的指针？您可能需要提供更多详细信息。

# php - 用户定义的 MySQL 函数无法通过 PHP PDO 连接访问

> ID：751916
> 
> 赞同：0
> 
> 时间：2009-04-15T14:15:31.860
> 
> 标签：php, mysql, pdo

我有一个简单的 MySQL 函数：

```
DELIMITER $$
DROP FUNCTION IF EXISTS `mydb`.`CALC` $$
CREATE FUNCTION `mydb`.`CALC_IT`(Flag VARCHAR(1), One FLOAT, Other FLOAT) 
RETURNS FLOAT
BEGIN
    IF One IS NULL THEN RETURN 0; END IF;
    IF Other IS NULL THEN RETURN 0; END IF;
    IF Flag = 'Y' THEN
        RETURN Other - One;
    ELSE
        RETURN Other
    END IF;
END $$
DELIMITER ; 
```

它是在使用 PDO 连接的 PHP 查询中调用的：

```
$query = 'SELECT CALC_IT(`Flag`, `One`, `Two`) FROM `mydb`.`table` WHERE `Condition` = 1';
$db = new PDO('mysql:host=localhost', 'user', 'pass');
$stmt = $db->prepare($query);
if (!$stmt->execute()) {
    var_dump($stmt->errorInfo());
} 
```

但是，它报告以下内容：

```
array
  0 => string '42000' (length=5)
  1 => int 1305
  2 => string 'FUNCTION CALC_IT does not exist' (length=37) 
```

而且，如果您尝试使用旧版 Mysql 代码，它可以工作：

```
$db = mysql_connect('localhost', 'user', 'pass');
$result = mysql_query($query);
if (mysql_error()) {
    var_dump(mysql_error());
} 
```

如果您尝试使用任何其他 mysql 客户端，该查询也可以工作。

那么**为什么*某些*用户定义的 MySQL 函数在 PHP 的 PDO 库中不起作用呢？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:43:53.803

> 新 PDO('mysql:host=localhost', 'user', 'pass');

缺少 dbname=mydb？

> 它将是 mydb.CALC_IT

是的，这是一种可能。在连接时选择数据库而不是在查询中明确指定它有优点和缺点。如果您只在服务器上使用单个数据库，那么在连接时这样说并处理可能的访问权限错误往往会更容易，但如果您正在执行跨数据库工作，请以显式方式“mydb. CALC_IT”将是必要的。

# c++ - 容器问题：***检测到 glibc *** free()：无效指针：0x41e0ce94 ***

> ID：751940
> 
> 赞同：1
> 
> 时间：2009-04-15T14:20:27.930
> 
> 标签：c++, glibc

我在 Linux 上有一个 C++ 程序，它在一段时间后崩溃并显示以下消息：

```
*** glibc detected *** free(): invalid pointer: 0x41e0ce94 *** 
```

在程序中，我广泛使用容器。他们必须存储一个简单类的对象。

**编辑**2009-4-17：

与此同时，很明显该错误与简单类无关。如果我将容器更改为保存其他数据类型，错误仍然会发生。问题一定出在我的代码中的其他地方，我目前正在尝试解决...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-15T14:25:51.787

考虑使用 std::string 来保存字符串值而不是原始 char 指针。这样您就不必担心在分配、复制和销毁方法中管理字符串数据。你的问题很可能就在那里。

编辑：你发布的新类没有问题，如果你只使用 char * 指向字符串常量，第一个版本也没有问题。问题出在程序的其他地方或您使用课程的方式上。您将不得不花更多时间在调试器和/或 valgrind 中进行挖掘以追踪问题。我会弄清楚指定地址所指向的内容，并尝试确定为什么它被释放两次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T14:22:28.830

猜测一下，您的复制 ctor、赋值操作或析构函数有问题 - 您需要显示这些代码。

**编辑：**刚刚注意到你没有赋值运算符 - 假设你的复制构造函数和析构函数没问题，你也需要一个赋值运算符，如 std:; 容器将使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:34:29.113

我一直在与我们正在开发的 C/C++ 应用程序作斗争，我想到的第一个想法是

*   一个指针已被修改并且它指向一个无效的位置 (ptr++;) 或类似的东西。
*   您已释放对象，但指针仍保持方向。

    [Valgrind](http://valgrind.org/)之类的工具可以帮助您检测代码中可能存在的错误。安装：

    sudo apt-get install valgrind

    并使用它：

    valgrind --tool=memcheck --leak-check=full ...

    它会在程序运行时报告错误，并在程序结束后给你一个报告。唯一的问题是 valgrind 认为可能的问题可能不是真正的问题。但这是一个起点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T15:10:30.540

这肯定是一个错误的字符串值。如果是悬空指针问题，使用 std::string 可能在这方面有所帮助。还要确保所有字符串初始化都按预期工作。

如果我正确理解了该类，则您假设驻留在 m_cstring 中的任何内存都不会在该类的生命周期内被释放。在您的情况下，这也意味着容器的生命周期。检查你的范围。

您可能遇到的另一个问题是，如果您的析构*函数正在*删除 cstring，那么在构造函数中使用默认值是一个非常糟糕的主意，因为您将尝试解除分配静态分配的 cstring。

可以在 C++ 中定义一个应该返回字符串但不返回任何内容的函数，最终得到一个错误的字符串（通常编译器会捕获“到达非 void 函数的结尾”，但不会总是）。

同上使用 valgrind。

作为阅读各种评论后的附录，程序中其他地方的内存错误总是有可能损坏了其中一个字符串。

**编辑**4-16

在这一点上，我将验证对象的值在构造/破坏时是否正确形成。（尝试打印它们？）如果一切看起来都不错，您可能需要在代码中的其他地方查看错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T14:23:42.433

你的析构函数里面是什么？可能它没有cstring。如果是这种情况，那么您在实例上共享您的 cstring 指针，然后每个实例释放相同的指针。

# c# - 系统托盘中的 .Net 控制台应用程序

> ID：751944
> 
> 赞同：17
> 
> 时间：2009-04-15T14:21:22.080
> 
> 标签：c#, .net-3.5, console, system-tray

有没有办法在最小化时将控制台应用程序放在系统托盘中？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-15T14:40:16.307

是的，你可以这样做。创建一个 Windows 窗体应用程序并添加一个[NotifyIcon 组件](http://msdn.microsoft.com/en-us/library/7yyz6s5c.aspx)。

然后使用以下方法（[在 MSDN 上找到](http://msdn.microsoft.com/en-us/library/ms682073(VS.85).aspx)）分配和显示一个控制台

```
[DllImport("kernel32.dll")]
public static extern Boolean AllocConsole();

[DllImport("kernel32.dll")]
public static extern Boolean FreeConsole();

[DllImport("kernel32.dll")]
public static extern Boolean AttachConsole(Int32 ProcessId); 
```

当您的控制台在屏幕上时，捕获最小化按钮单击并使用它来隐藏控制台窗口并更新通知图标。您可以使用以下方法（[在 MSDN 上](http://msdn.microsoft.com/en-us/library/ms633499.aspx)找到）找到您的窗口：

```
[DllImport("user32.dll", SetLastError = true)]
static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

// Find window by Caption only. Note you must pass IntPtr.Zero as the first parameter.
// Also consider whether you're being lazy or not.
[DllImport("user32.dll", EntryPoint="FindWindow", SetLastError = true)]
static extern IntPtr FindWindowByCaption(IntPtr ZeroOnly, string lpWindowName); 
```

当您准备好关闭应用程序时，请务必致电 FreeConsole。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-06-04T17:26:45.933

```
using System.Windows.Forms;
using System.Drawing;

static NotifyIcon notifyIcon = new NotifyIcon();
static bool Visible = true;
static void Main(string[] args)
{
    notifyIcon.DoubleClick += (s, e) =>
    {
        Visible = !Visible;
        SetConsoleWindowVisibility(Visible);
    };
    notifyIcon.Icon = Icon.ExtractAssociatedIcon(Application.ExecutablePath);
    notifyIcon.Visible = true;
    notifyIcon.Text = Application.ProductName;

    var contextMenu = new ContextMenuStrip();
    contextMenu.Items.Add("Exit", null, (s, e) => { Application.Exit(); });
    notifyIcon.ContextMenuStrip = contextMenu;

    Console.WriteLine("Running!");

    // Standard message loop to catch click-events on notify icon
    // Code after this method will be running only after Application.Exit()
    Application.Run(); 

    notifyIcon.Visible = false;
}

[DllImport("user32.dll")]
public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);
[DllImport("user32.dll")]
static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
public static void SetConsoleWindowVisibility(bool visible)
{
    IntPtr hWnd = FindWindow(null, Console.Title);
    if (hWnd != IntPtr.Zero)
    {
        if (visible) ShowWindow(hWnd, 1); //1 = SW_SHOWNORMAL           
        else ShowWindow(hWnd, 0); //0 = SW_HIDE               
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-15T14:25:21.023

控制台本身没有可最小化的窗口。它在命令提示符窗口中运行。您可以挂钩窗口消息并在最小化时隐藏窗口。在您的应用程序中，可以像在 Windows 应用程序中一样添加托盘图标。嗯，不知何故，这**闻起来**......

但是：我不确定你为什么要这样做。控制台应用程序的设计不同于 Windows 应用程序。因此，也许可以将应用程序更改为 Windows 窗体应用程序？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-04-14T21:48:42.870

我正是为了这个目的使用[TrayRunner](http://trayrunner.com "TrayRunner")。本质上，它包装了一个控制台应用程序，用于捕获所有输出。但是当最小化时，它会最小化到系统托盘而不是任务栏。您甚至可以自定义最小化时要显示的图标。我将它用于 Tomcat 或 Apache 之类的东西，以释放任务栏上的空间，而不将它们作为 Windows 服务运行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-06T11:44:01.780

```
[DllImport("user32.dll")]
internal static extern bool SendMessage(IntPtr hWnd, Int32 msg, Int32 wParam, Int32 lParam);
static Int32 WM_SYSCOMMAND = 0x0112;
static Int32 SC_MINIMIZE = 0x0F020;

static void Main(string[] args)
{
    SendMessage(Process.GetCurrentProcess().MainWindowHandle, WM_SYSCOMMAND, SC_MINIMIZE, 0);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T14:28:11.377

您不能隐藏控制台应用程序，因为它实际上没有要隐藏的窗口，看它是如何在控制台中运行的（控制台本身只是控制台的一个窗口，而不是在其中运行的应用程序）

# jsp - JSP 缓冲区溢出

> ID：751957
> 
> 赞同：0
> 
> 时间：2009-04-15T14:25:12.833
> 
> 标签：jsp, buffer-overflow

我有一个 1MB 的文件要上传，并且设置了以下内容，但出现异常。我认为这是我的缓冲区大小和或 autoFlush 设置。

目前：

```
<%@ page errorPage="error.jsp" buffer="500kb" autoFlush="false" %> 
```

我试图将缓冲区设置为 2000KB，但没有 luk。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T14:26:29.493

那是*输出的缓冲区，但**输入*的是文件上传。

解决方案取决于您的 Web 框架。

# javascript - 谷歌地图最佳做法？

> ID：751964
> 
> 赞同：5
> 
> 时间：2009-04-15T14:26:40.957
> 
> 标签：javascript, google-maps

我们开始在我们的网络应用程序上广泛使用谷歌地图。一开始它工作得很好，但是当我们添加更多标记时，我们发现性能并不完全正常。虽然我很确定我们不会以最有效的方式使用它。

我正在寻找有关 Google 地图最佳做法和技巧的信息。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-20T20:28:30.247

您可能会在本文中找到一些好主意，[该文章](http://www.svennerberg.com/2009/01/handling-large-amounts-of-markers-in-google-maps/)比较了处理大量标记的几种方法。

Marker Manager 有一些限制，具体取决于您要完成的工作；例如，它不允许每个缩放级别的每个标记都可用。[我根据本教程](http://www.appelsiini.net/2008/11/introduction-to-marker-clustering-with-google-maps)中讨论的原则创建了一个聚类函数。它使用 PHP 中的静态地图 API，但集群背后的原理可以随心所欲地使用。

**更新：**这个集群实用程序刚刚发布：[MarkerClusterer](http://gmaps-utility-library.googlecode.com/svn/trunk/markerclusterer/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T15:02:54.973

使用[标记管理器](http://googlemapsapi.blogspot.com/2006/11/marker-manager.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:29:49.470

*   将标记限制在可见范围内（即，了解窗口边界，并仅显示落在窗口内的标记）
*   学习聆听各种地图活动并做出反应 - 例如视点移动、缩放等 - 以更新标记
*   不要显示明显重叠的标记 - 仅显示一个标记（可能是不同的阴影或颜色以表示此标记处有多个点），如果用户想查看各个标记，请让他们放大。如果您想花哨，请使用工具提示显示放大的窗口。

# c++ - 包含和/或链接二进制文件未使用的内容有什么负面影响？

> ID：751966
> 
> 赞同：6
> 
> 时间：2009-04-15T14:27:21.003
> 
> 标签：c++, linux, linker, g++, ld

假设我有一个正在构建的二进制文件，并且我包含了一堆从未实际使用过的文件，然后是否链接到这些包含文件描述的库？（同样，这些库从未使用过）

除了增加编译时间之外，这样做的负面后果是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-15T14:29:07.800

我能想到的一些是**命名空间污染**和**二进制大小**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T14:30:39.733

除了编译时间；复杂性增加，调试时不必要的分心，维护开销。

除此之外，一无所有。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T14:30:14.147

除了 Sasha 列出的还有**维护成本**。当您选择删除未使用的东西时，您是否能够轻松检测到将来使用的内容和未使用的内容？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-15T14:33:32.627

如果这些库从未使用过，则可执行文件的大小不应增加。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-15T14:42:55.567

根据具体的链接器，您可能还会注意到未使用库的全局对象仍会被构造。这意味着内存开销并增加了启动成本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-15T14:58:58.057

如果您包含但未使用的库不在目标系统上，即使它们不是必需的，它也无法编译。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-15T15:00:14.513

[这](https://stackoverflow.com/questions/715502/how-do-linkers-decide-what-parts-of-libraries-to-include/715631#715631)是我对有关 C 和静态库的类似问题的回答。也许它在 C++ 的上下文中也对您有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-15T15:00:25.933

您提到了编译时间的增加。据我了解，这些库是静态链接的，而不是动态链接的。在这种情况下，这取决于链接器如何处理未使用的函数。如果它忽略它们，您将主要遇到维护问题。如果它们被包括在内，可执行文件的大小将会增加。现在，这比它在硬盘驱动器上占据的位置更重要。由于缓存问题，大型可执行文件可能会运行得更慢。如果exe中的活动代码和非活动代码相邻，它们将被缓存在一起，从而使缓存实际上更小，效率更低。

VC2005 及更高版本有一个称为 PGO 的优化，它以确保有效缓存经常使用的代码的方式对可执行文件中的代码进行排序。我不知道 g++ 是否有类似的优化，但值得研究一下。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-15T15:05:31.940

这里对问题进行了一点汇编，必要时进行维基编辑：

主要问题似乎是：**命名空间污染** 这可能会导致未来的调试、版本控制出现问题，并增加未来的维护成本。

至少还会有次要的**Binary Bloat**，因为将维护函数/类/命名空间引用（在符号表中？）。动态库不应该大大增加二进制文件的大小（但它们会成为二进制文件运行的依赖项？）。从 GNU C 编译器来看，如果在源代码中从未引用静态链接库，则它们不应包含在最终二进制文件中。（基于 C 编译器的假设，可能需要澄清/纠正）

此外，根据库的性质，可能会实例化全局和静态对象/变量，从而**增加启动时间和内存开销**。

哦，增加了编译/链接时间。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-15T15:30:04.707

当我在源代码树中编辑文件时，我发现它令人沮丧，因为我正在处理的某些符号出现在源文件中（例如，我刚刚更改了原型的函数名称 - 或者，可悲但更典型的是，只是将原型添加到标题中）所以我需要检查使用是否正确，或者编译器现在告诉我该文件中的使用不正确。所以，我编辑文件。然后我看到一个问题——这个文件在做什么？事实证明，尽管代码在产品中被“使用”了，但它实际上并没有被积极使用。

我在星期一发现了这个问题。一个包含 10,000 多行代码的文件调用了一个函数“extern void add_remainder(void);” 参数为 0。所以，我去修复它。然后我查看了其余的代码......原来它是大约 15 年前的一个开发存根，从未被删除。结果证明，干净地删除代码涉及对六个以上文件的微小编辑——而且我还没有弄清楚从枚举中间删除枚举常量是否安全，以防万一。暂时标记为“未使用/过时 - 可以安全移除吗？”。

在过去的 15 年中，该代码块的覆盖率为零——生产、测试​​……的确，它只是庞大系统的一小部分——按百分比计算，它不到图表上的 1%。尽管如此，这是额外浪费的代码。

令人费解。恼人的。令人沮丧的普遍（到目前为止，我已经记录并修复了今年至少六个类似的错误）。

并且浪费了我的时间——以及其他开发者的时间。多年来，其他人在做我正在做的事情——一项彻底的工作——定期编辑该文件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-15T14:46:10.320

我从来没有遇到过链接 .lib 文件的任何问题，该文件只使用了很小的一部分。只有真正使用的代码才会链接到可执行文件中，并且链接时间没有明显增加（使用 Visual Studio）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-15T14:48:07.303

如果您链接到二进制文件并且它们在运行时加载，它们可能会执行非平凡的初始化，这可以做任何事情，从分配少量内存到消耗稀缺资源以您不期望的方式改变模块的状态，以及超过。

你最好摆脱你不需要的东西，只是为了消除一堆未知数。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-15T15:49:33.397

如果构建树没有得到很好的维护，它甚至可能无法编译。如果您在没有交换空间的嵌入式系统上编译。编译器在尝试编译大型目标文件时可能会耗尽内存。

它最近发生在我们的工作中。

# php - 如何实现“require_global”？

> ID：751976
> 
> 赞同：4
> 
> 时间：2009-04-15T14:30:16.817
> 
> 标签：php

现在的情况：

*   我有我的 MVC 框架的*当前版本*，它使用类作为控制器。
*   我有一些来自*旧*MVC 框架的“老式”模块，它使用简单的平面包含作为控制器。

大大简化了，这意味着：

**新版本：**

```
<?PHP
class blaController extends baseController {
    private $intVar;

    function dosomethingFunction() {
        $this->intVar = 123;
        $this->view('myView');
    }
}
?> 
```

**旧版：**

```
<?PHP
$globalVar = 123;
// view "controllername" is automatically shown
?> 
```

我现在正在尝试编写一个包装器，以便能够在我的新 MVC 中使用我的旧控制器，而无需重写所有内容。为此，我有一个“包装器”控制器：

```
class wrapController extends baseController {
    function dosomethingFunction() {
        require 'old_dosomething.function.php';
        $this->view('old_dosomething_view');
    }
} 
```

（再一次：这是非常非常简化的 - 只是为了理解这个想法。不是实际的代码。）

这种方法的问题是，以前的全局变量 $globalVar 现在只存在于方法“dosomethingFunction”内部，视图不能访问。

如果我可以强制要求表现为“在全局范围内”，那么情况就不会如此，这样 $globalVar 将再次在全局范围内可用。

那么：有没有办法实现“ **require_global** ”或类似的东西？

（我的问题的一个解决方案是修改我的旧控制器以从一堆“全局”命令开始，但我更喜欢不需要更改太多旧代码的解决方案。）

（注意：请不要告诉我 GLOBALS 不好。它完全忽略了这个问题的重点。请接受让一些旧代码在更新、更清洁的环境中工作的要求。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-15T14:44:35.627

您可以将在 dosomethingFunction() 中定义的局部变量添加到全局范围：

```
class wrapController extends baseController {
    function dosomethingFunction() {
        require 'old_dosomething.function.php';
        //begin added code  
        $vararr = get_defined_vars();
        foreach($vararr as $varName => $varValue) 
              $GLOBALS[$varName] = $varValue;            
        //end added code          
        $this->view('old_dosomething_view');
    }
} 
```

请注意，要使其按预期工作，您应该在使用函数中的任何其他内容之前调用 require 。get_defined_vars() 仅返回当前范围内的变量，因此不需要 array_diff hack。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T14:52:14.937

这是我能想到的最简单的解决方案。

使用 get_defined_vars() 函数两次并获取每次调用的差异以确定所需文件引入了哪些变量。

例子：

```
$__defined_vars       = get_defined_vars();
require('old_dosomething.function.php');
$__newly_defined_vars = array_diff_assoc($__defined_vars, get_defined_vars());
$GLOBALS = array_merge($GLOBALS, $__newly_defined_vars);
$this->view('old_dosomething_view'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T14:39:03.533

嗯，这是我以前从未见过的问题。我想你可以这样做

```
class wrapController extends baseController {
    function dosomethingFunction() {
        require 'old_dosomething.function.php';

        // Force "old" globals into global scope
        $GLOBALS['globalVar'] = $globalVar;

        $this->view('old_dosomething_view');
    }
} 
```

但这也是一个相当乏味的手动过程，具体取决于我们谈论的全局变量的数量。我会考虑这个，但我不知道有什么“自动魔法”解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T15:43:15.300

对于任何感兴趣的人：我的（到目前为止）最终版本：

```
class wrapController extends baseController {
    function dosomethingFunction() {
        // ... do some initialisation stuff ...

        $__defined_vars = array_keys(get_defined_vars());

        require 'old_dosomething.function.php';

        $__newly_defined_vars = array_diff(
                                    array_keys(get_defined_vars()),
                                    $__defined_vars, 
                                    array('__defined_vars')
                                );
        foreach ($__newly_defined_vars as $var) {
            $GLOBALS[$var] = &$$var;
        }

        $this->view('old_dosomething_view');
    }
} 
```

丑陋，但它的工作原理。感谢您的大力帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T15:29:31.667

您是否尝试过 Zend Framework 中的 Zend_Registry？

注册表是用于在应用程序空间中存储对象和值的容器。通过将值存储在注册表中，相同的对象在整个应用程序中始终可用。此机制是使用全局存储的替代方案。

[http://framework.zend.com/manual/en/zend.registry.html](http://framework.zend.com/manual/en/zend.registry.html)

# asp.net - 使用 ASP.NET LoginView 动态显示链接

> ID：751979
> 
> 赞同：3
> 
> 时间：2009-04-15T14:31:07.813
> 
> 标签：asp.net, loginview

我在使用 LoginView 来满足我的需要时遇到问题。有人可以告诉我是否可以在 LoginView 中执行此操作（以及如何），或者我是否需要使用代码隐藏。

我有两个角色 - 管理员和用户。我想根据角色动态显示链接。我将在 if 语句中写出我想要的内容，因为它更容易解释：

```
if (role = Administrator) //Display only if administrator.
   Show Hyperlink 1
   Show Hyperlink 2
else
   if (role = User) //Display only if user.
      Show Hyperlink 3
      Show Hyperlink 4
   endif
   //Display these if a user or if non-authenticated user...
   Show Hyperlink 5
   Show Hyperlink 6
   Show Hyperlink 7 
endif 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-15T14:38:34.283

尝试这样的事情，它使用该[`RoleGroups`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginview.rolegroups.aspx)属性。您还可以为用户指定 RoleGroup，但如果您使用 LoggedInTemplate，它将对所有在 RoleGroup 中没有组的登录用户生效。最后，实际上没有办法像您在用户/匿名中描述的场景那样拥有共享模板，因此您可能不得不复制。另一种可能性是您不将它们包含在您的 LoginView 中并将它们也显示给管理员。

```
<asp:LoginView runat="server" ID="LoginView">
    <AnonymousTemplate>
        <asp:HyperLink runat="server" ID="Link5" />
        <asp:HyperLink runat="server" ID="Link6" />
        <asp:HyperLink runat="server" ID="Link7" />
    </AnonymousTemplate>
    <LoggedInTemplate>
        <asp:HyperLink runat="server" ID="Link3" />
        <asp:HyperLink runat="server" ID="Link4" />
        <asp:HyperLink runat="server" ID="Link5" />
        <asp:HyperLink runat="server" ID="Link6" />
        <asp:HyperLink runat="server" ID="Link7" />
    </LoggedInTemplate>
    <RoleGroups>
        <asp:RoleGroup Roles="Administrator">
            <ContentTemplate>
                <asp:HyperLink runat="server" ID="Link1" />
                <asp:HyperLink runat="server" ID="Link2" />
            </ContentTemplate>
        </asp:RoleGroup>
    </RoleGroups>
</asp:LoginView> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-15T14:42:43.620

您当然可以使用 ASP.NET LoginView 控件实现您正在寻找的内容。

您需要查看 LoginView 控件的“ [RoleGroups](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginview.rolegroups.aspx) ”属性，因为这允许您创建根据经过身份验证的用户所属的角色而不同的 ContentTemplates。

例如：

```
<form id="form1" runat="server">
   <asp:LoginView id="LoginView1" runat="server">
      <RoleGroups>
         <asp:RoleGroup Roles="administrator">
            <ContentTemplate>
               <ul>
                  <li>Hyperlink 1</li>
                  <li>Hyperlink 2</li>
               </ul>
            </ContentTemplate>
         </asp:RoleGroup>
         <asp:RoleGroup Roles="user">
            <ContentTemplate>
               <ul>
                  <li>Hyperlink 3</li>
                  <li>Hyperlink 4</li>
               </ul>
            </ContentTemplate>
          </asp:RoleGroup>
      </RoleGroups>
      <AnonymousTemplate>
         <ul>
            <li>Hyperlink 5</li>
            <li>Hyperlink 6</li>
         </ul>
      </AnonymousTemplate>
   </asp:LoginView>
</form> 
```

使用这种机制，您可以在 ASP 标记中纯粹以声明方式为每个角色定义内容。或者，您始终可以在服务器端代码中执行此操作，然后可以根据您喜欢的任何标准显示/隐藏任何控件（runat="server"）。例如，作为 LoginView 控件的替代方法，您可以使用[MultiView/View](http://msdn.microsoft.com/en-us/library/3ek2z7fh.aspx)控件。

# c# - 按 T AB 键时绕过 DataGridView 中的只读单元格

> ID：751981
> 
> 赞同：8
> 
> 时间：2009-04-15T14:32:17.217
> 
> 标签：c#, winforms, datagridview

任何人都可以告诉我一些代码，我可以在按下 TAB 键时绕过 DatagridView 中的只读单元格吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-01-24T11:12:50.757

```
private void dataGridView1_CellEnter(object sender, DataGridViewCellEventArgs e)
{
   if (dataGridView1.CurrentRow.Cells[e.ColumnIndex].ReadOnly)
    {
        SendKeys.Send("{tab}");
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-15T15:22:51.917

覆盖 SelectionChanged 事件是正确的方法。CurrentCell 属性可用于设置当前单元格。你想要这样的东西：

```
private void dataGridView_SelectionChanged(object sender, EventArgs e)
{
    DataGridViewCell currentCell = dataGridView.CurrentCell;
    if (currentCell != null)
    {
        int nextRow = currentCell.RowIndex;
        int nextCol = currentCell.ColumnIndex + 1;
        if (nextCol == dataGridView.ColumnCount)
        {
            nextCol = 0;
            nextRow++;
        }
        if (nextRow == dataGridView.RowCount)
        {
            nextRow = 0;
        }
        DataGridViewCell nextCell = dataGridView.Rows[nextRow].Cells[nextCol];
        if (nextCell != null && nextCell.Visible)
        {
            dataGridView.CurrentCell = nextCell;
        }
    }
} 
```

您需要为当前只读单元格添加一个测试，并在下一个单元格不可见或只读时循环。如果所有单元格都是只读的，您还需要检查以确保您不会永远循环。

您还必须处理显示索引与基本索引不同的情况。

要在按下 Tab 时获得此行为，您需要添加一个 KeyDown 处理程序：

```
private void AlbumChecker_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.Tab)
    {
        SelectNextEditableCell(DataGridView dataGridView);
    }
} 
```

并将第一个代码放入这个新方法中。

您可能想检查 DataGridView 是否也有焦点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-03T21:22:14.220

我做了一个继承`DataGridView`类的例子。该示例适用于 TAB 和 ENTER 键，因此用户可以快速插入数据，但仍可以使用鼠标或上、下、右、左键选择单元格并将它们复制到 Excel。它可以模拟多个 TAB，直到 Grid 到达非 ReadOnly Cell。希望它有用。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Windows.Forms;

namespace System.Windows.Forms
{
  class MyDataGridView : DataGridView
  {
    protected override bool ProcessDialogKey(Keys keyData)
    {
      if (keyData == Keys.Enter || keyData == Keys.Tab)
      {
        MyProcessTabKey(Keys.Tab);
        return true;
      }
      return base.ProcessDialogKey(keyData);
    }

    protected override bool ProcessDataGridViewKey(KeyEventArgs e)
    {
      if (e.KeyCode == Keys.Enter || e.KeyCode == Keys.Tab)
      {
        MyProcessTabKey(Keys.Tab);
        return true;
      }
      return base.ProcessDataGridViewKey(e);
    }

    protected bool MyProcessTabKey(Keys keyData)
    {
      bool retValue = base.ProcessTabKey(Keys.Tab);
      while (this.CurrentCell.ReadOnly)
      {
        retValue = base.ProcessTabKey(Keys.Tab);
      }
      return retValue;
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T17:50:53.107

继承 DataGridView 并覆盖 ProcessDialogKey（对于在编辑时按下的键）和 ProcessDataGridViewKey（对于在不编辑时按下的键）。按下 Tab 时，将 CurrentCell 设置为下一个非只读单元格。

可选择覆盖 WndProc 以过滤只读单元格上的鼠标点击。（请参阅 DataGridView.GetColumnDisplayRectangle 以查找单击了哪一列）。

[从这里](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/2025a294-9143-4ecf-82b1-f632da163e85)开始的好来源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-03T03:11:33.493

您可以在 ProcessDialogKey 中通过此代码捕获 Tab 键

```
 Dim uKeyCode As Keys = (keyData And Keys.KeyCode)
    Dim uModifiers As Keys = (keyData And Keys.Modifiers)

    (uKeyCode = Keys.Return OrElse uKeyCode = Keys.Tab) AndAlso uModifiers = Keys.Shift 
```

通过 ProcessDataGridViewKey 中的这段代码

```
 (e.KeyCode = Keys.Return OrElse e.KeyCode = Keys.Tab) AndAlso e.Modifiers = Keys.Shift 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-28T18:41:45.667

赫克托——我希望你还在听。您的解决方案是我在广泛搜索中看到的最优雅、最直接的解决方案。我遇到了覆盖关键事件的建议，但是您调用 base.ProcessTabKey 的建议特别简单，当您到达 dgv 的末尾时，它会处理将焦点传递给下一个控件的问题。您的解决方案需要的另一件事是在 MyProcessTabKey 中检查 dgv 的最后一个单元格。如果该单元格是只读的，并且用户在前一个单元格中使用制表符，则 while 语句将进入无限循环。添加以下代码作为 while 循环中的第一条语句似乎可以解决问题，尽管它确实将最后一个（只读）单元格保留为“活动”单元格（意味着它看起来好像已被选中）。

```
 if (this.CurrentCell.RowIndex == this.Rows.Count - 1
                && this.CurrentCell.ColumnIndex == this.Columns.Count - 1)
                { retValue = false; break; } 
```

我有一个后续问题。您或其他人是否知道如何使这种方法与 Shift-Tab 一起使用，因此 dgv 也会向后跳过只读单元格？由于 Shift 和 Tab 是不同的键事件，我不知道如何在覆盖的 ProcessDialogKey 和 ProcessDataGridViewKey 方法中检测 Shift-Tab。谢谢。史蒂夫

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-10T18:19:11.427

当单元格处于编辑模式，并且您想监听击键事件时，您可以尝试处理 DataGridView 的 EditingControlShowing 事件...

```
Private Sub myDvGrid_EditingControlShowing(ByVal sender As System.Object, ByVal e As System.Windows.Forms.DataGridViewEditingControlShowingEventArgs) Handles myDvGrid.EditingControlShowing
    Dim c As DataGridViewTextBoxEditingControl = DirectCast(e.Control, DataGridViewTextBoxEditingControl)

    RemoveHandler c.PreviewKeyDown, AddressOf edtctrlOn_PreviewKeyDown
    RemoveHandler c.TextChanged, AddressOf edtctrlOn_TextChanged

    AddHandler c.TextChanged, AddressOf edtctrlOn_TextChanged
    AddHandler c.PreviewKeyDown, AddressOf edtctrlOn_PreviewKeyDown

End Sub 
```

然后，在 edtctrlOn_PreviewKeyDown 事件中，您可以将参数冒泡到原始数据网格的 PreviewKeyDown 事件处理程序。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-08-19T20:54:13.313

```
 if (e.KeyValue == 13)
        {
            e = new KeyEventArgs(Keys.Tab);
        } 
```

# c# - 在 C# 中初始化 Generic.List

> ID：751990
> 
> 赞同：46
> 
> 时间：2009-04-15T14:34:31.563
> 
> 标签：c#, .net, generics, constructor

在 C# 中，我可以使用以下语法初始化列表。

```
List<int> intList= new List<int>() { 1, 2, 3 }; 
```

我想知道该`{}`语法是如何工作的，以及它是否有名称。有一个带有 的构造函数`IEnumerable`，你可以调用它。

```
List<int> intList= new List<int>(new int[]{ 1, 2, 3 }); 
```

这似乎更“标准”。当我解构 List 的默认构造函数时，我只看到

```
this._items = Array.Empty; 
```

我希望能够做到这一点。

```
CustomClass abc = new CustomClass() {1, 2, 3}; 
```

并且能够使用`1, 2, 3`列表。这是如何运作的？

**更新**

Jon Skeet 回答了

> 它调用无参数构造函数，然后调用 Add：

```
> List<int> tmp = new List<int>();
> tmp.Add(1); tmp.Add(2); tmp.Add(3);
> List<int> intList = tmp; 
```

我明白是做什么的。我想知道怎么做。该语法如何知道调用 Add 方法？

**更新**

我知道，接受 Jon Skeet 的回答是多么陈词滥调。但是，带有字符串和整数的示例非常棒。还有一个非常有用的 MSDN 页面是：

*   *[对象和集合初始化器（C# 编程指南）](http://msdn.microsoft.com/en-us/library/bb384062.aspx)*

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-04-15T14:36:32.930

这称为*集合初始化程序*。它调用无参数构造函数，然后调用 Add：

```
List<int> tmp = new List<int>();
tmp.Add(1);
tmp.Add(2);
tmp.Add(3);
List<int> intList = tmp; 
```

对类型的要求是：

*   它实现`IEnumerable`
*   `Add`它具有适合您提供的参数类型的重载。您可以在大括号中提供多个参数，在这种情况下，编译器会查找`Add`具有多个参数的方法。

例如：

```
public class DummyCollection : IEnumerable
{
    IEnumerator IEnumerable.GetEnumerator()
    {
        throw new InvalidOperationException("Not a real collection!");
    }

    public void Add(string x)
    {
        Console.WriteLine("Called Add(string)");
    }

    public void Add(int x, int y)
    {
        Console.WriteLine("Called Add(int, int)");
    }
} 
```

然后你可以使用：

```
DummyCollection foo = new DummyCollection
{
    "Hi",
    "There",
    { 1, 2 }
}; 
```

（当然，通常您希望您的收藏能够`IEnumerable`正确实施......）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-15T14:36:42.120

阅读*[对象和集合初始化器（C# 编程指南）](http://msdn.microsoft.com/en-us/library/bb384062.aspx)*。基本上，您可以使用列表的每个自定义类型（实现 IEnumerable）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-15T14:37:44.847

它们被称为[集合初始](http://msdn.microsoft.com/en-us/library/bb384062.aspx)值设定项（另见[此处](http://msdn.microsoft.com/en-us/library/bb531208.aspx)），它们的工作方式是寻找一种`Add()`可以满足其要求的方法。它需要`Add()`花括号中的每个整数。

对方法的搜索`Add()`是纯粹的编译器魔法。很难找到该名称的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-15T14:38:16.327

您正在寻找的名称是“Collection Initializer”。它通过在集合类型上查找名为 Add 的方法并为您指定的每个值调用它来工作。

更多细节：[对象和集合初始化器（C# 编程指南）](http://msdn.microsoft.com/en-us/library/bb384062.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T14:36:35.927

我相信这是 .Add 方法的捷径。不过，我从未尝试过覆盖它，所以我不知道这是否可能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T14:37:44.270

就我而言，通过对象初始化添加项目会搜索方法 Add。因此，由于 List<int> 将具有 void Add(int)，因此它将起作用。

要在课堂上使用它，只需添加

```
class CustomClass { 
   public void Add(int num) {
      // Your code here
   }
} 
```

正如 Hallgrim 所指出的，您的班级应该实现 IEnumerable。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-15T14:41:37.320

它实际上是使用`.Add`方法。这意味着它正在调用`.Add`构造函数内括号中的每个项目。

# php - 创建“完全”模块化的基于 ZF 的应用程序的最佳方法是什么？

> ID：751992
> 
> 赞同：0
> 
> 时间：2009-04-15T14:35:52.917
> 
> 标签：php, zend-framework, web-applications, modularity

在过去的一段时间里，我一直在开发一个基于 Zend 框架的网上商店应用程序，我们正在从头开始构建它。该应用程序已为多个客户成功设置，但我们在应用程序的可扩展性和模块化方面遇到了越来越多的问题。

许多客户在某些问题上需要很多不同的方法，通常需要自定义默认模块或扩展它们。我一直在网上寻找基于 Zend Framework 的代码，可以指导我这样做，到目前为止，[Magento](http://www.magentocommerce.com)是我想出的唯一示例。尽管 Magento 似乎在提供可扩展性和模块化方面做得很好，但对于我当前的需求（或者看起来如此）来说，代码过于复杂和广泛。

**在理想情况下，它将按如下方式工作：**

*   每个客户端都安装了“基本”应用程序
*   模块、控制器、模型应该很容易被覆盖或扩展
*   新模块应该很容易创建

是否有任何其他基于 Zend Framework 的应用程序或其他指针可以引导我朝着正确的方向前进？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-16T18:51:00.330

我认为 Zend Framework 1.8 版将解决构建模块化应用程序的许多问题。尤其是新的（[Zend_Application](http://framework.zend.com/manual/en/zend.application.html)），它应该允许自动加载模块资源，这在这一点上并不容易。

我对此了解不多，但这可能值得研究。1.8 应该会在本月底发布。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-15T15:02:08.237

Zend Framework 是一个...框架。您正在寻找的是一个完整的系统。作为开发人员，您的工作就是在框架（无论是 Zend 还是您自己的）之上构建一个系统。

人们通常会告诉您不要重新发明轮子，但在这种情况下，您需要为您的公司开发自己的系统，以便能够轻松地为新客户开发和部署。

如前所述，这是您正在寻找的一个非常复杂的答案。你不会得到那个答案。

# c# - 我的项目使用什么语言？

> ID：751993
> 
> 赞同：5
> 
> 时间：2009-04-15T14:36:16.287
> 
> 标签：c#, java, vb.net, delphi, programming-languages

我将很快就一个项目为一家公司提供建议，但我不太确定我应该建议哪种编程语言。

这是一个相当简单（基于桌面）的应用程序，在网络上有一个中央数据源，用于存储和编辑组成机器的部件。需要在应用程序中配置机器，并通过此配置生成生产文档（手册、软件、物料清单）。（例如，如果将 A 部分和 B 部分添加到配置的机器中，则必须使用手册第 5 章中的变体 X，如果这有意义的话）

有一些非标准组件，例如带有单选框和复选框的树，其中必须有某种版本控制。它需要一个所见即所得的编辑器来编辑手册的章节。它不一定要在 Windows 以外的平台上运行，因为它只会在公司网络上使用，并且每个人都运行 Windows。

我在考虑 Java，因为它有大量有用的库和免费的 IDE。我自己是一名 Java 程序员，所以我对其他编程语言不是很熟悉。关于我应该使用哪种语言以及为什么？我相信公司中存在一些 VB/VBA 和 Delphi 知识（它不是一家 IT 公司，我不太可能自己编程）。

多谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-15T17:55:12.580

根据您对应用程序和环境的描述，没有什么能比得上 Delphi！

这是 Delphi 大放异彩的理想案例：
- 结合了最快性能和开发的本地桌面应用程序。
- 过多的优秀（通常是免费的）组件；您可能会发现您的树
- 对于 DB 应用程序来说非常强大且简单
- 非常活跃且乐于助人的社区

另请参阅[为什么我将它推荐给另一个 SO 用户](https://stackoverflow.com/questions/179319/what-language-or-rad-ide-do-you-recommend-for-building-shareware/179550#179550)。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-15T17:25:46.863

我想如果你在你的公司有 Delphi 知识：它是桌面应用程序的一个非常好的选择，正如[avar 所说](https://stackoverflow.com/questions/751993/what-language-do-i-use-for-my-project/752292#752292)：你可以在这里找到很多好的组件[Torry 的 Delphi 页面](http://www.torry.net)。

我推荐这篇[文章](http://www.tmssoftware.com/site/blog.asp?post=%20115)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-15T15:39:45.557

对于桌面应用程序（加上数据库/win32 的东西），我推荐 delphi。你可以找到很多好的组件。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-15T23:25:40.117

您可能想要选择您的团队最有经验的语言。我个人很喜欢德尔福，听起来这可能是您所描述的一个不错的选择。Delphi 非常适合与数据库对话的桌面应用程序。但是，如果您的团队（那些编写和维护应用程序的人）在 Java / C# / VB 方面更有经验，那么您应该这样做。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-15T14:46:34.653

好吧，您描述的场景不是非常特定于语言，所以这里有一些提示：

*   一般来说，java是绝对可以的，但是：
*   在 Windows 世界中，您可以更轻松地使用 .net 语言，因为可以直接访问 COM/activex 以在 adobe 或 Word 中组合文档片段
*   因为公司里有一些vb知识，所以维护软件的任务可能会变得更便宜。

我建议使用 c#，因为通过单声道，您可以在必要时使用 Linux。

好吧，那是我的 2 美分。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-15T14:40:54.153

依靠。在**很多**事情上。你熟悉什么语言？您使用什么数据库（MS SQL 与 .NET 语言一起使用时有一些优势，但也可以与 java 一起使用，或者......）？

这些库（至少对我而言）不是主要的决策点，因为也有很多其他语言的库。

如果您不自己编程，请询问从事这项工作的开发人员。项目除了技术之外还有其他标记，例如使用的时间和花费的金钱。如果您选择开发人员熟悉的语言，则更有可能是时间和成本。

您的问题在某种程度上过于开放，无法给出确切的答案。但也许这有助于你思考。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-15T14:53:12.517

您应该使用以下任何一种语言：

**1) 最适合项目**

例如：如果您的项目需要实时处理，请使用有利于执行该任务的语言。

**2）你（和你的团队）是最舒服的。**

您需要与您的团队讨论您目前知道的任何语言是否合适（牢记第 1 点）。如果都不合适，那么在项目的整个生命周期中，哪种语言（牢记第 1 点）在学习、开发和支持（维护）方面都最适合。

这听起来像是非常简短的建议，但我相信它至关重要。如果您的项目要成功，您需要一种可以“生活”的语言，并且会与您合作而不是与您对抗。如果你是一个木工，你*可以*用锤子把螺丝钉在一块木头上，但用螺丝刀不是更*舒服吗？*

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-15T14:41:26.320

在标记语言中，请避免使用 asp.net，因为它是桌面应用程序。除此之外，所有其他语言都会做得很好。这将归结为个人偏好（更重要的是开发人员的个人偏好）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-15T14:48:00.453

> 我自己是一名 Java 程序员，所以我对其他编程语言不是很熟悉。

如果您要编写软件，您应该使用 Java。您已经熟悉它，并且您的熟悉可以帮助您取悦您的客户。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-15T14:52:05.093

如果你不写它，你需要找出谁是并考虑他们的经验。仅仅因为你不知道他们熟悉什么就让他们学习一门新语言并不是一个好方法。

Java 会工作，C# 会工作（我个人会喜欢 C#），这真的取决于你的经验。

这与“非标准”组件有关吗？如果有他们想要使用的第 3 方控件，这可能会决定要使用的语言/平台。Java 和 C# 中也有许多免费控件和示例，扩展标准 Java / .NET 控件甚至可能比使用 3rd 方控件更好。

听起来您需要更多地了解应用程序和其他一些东西，然后才能真正建议其他人该做什么。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-15T14:40:22.580

好吧，使用你所知道的（Java）有很多智慧。

然而，为了反驳“因为它有大量有用的库和免费 IDE”——.NET 还拥有庞大的库库和免费 IDE（包括 Visual Studio 的 Express 版本）。对于 .NET，C# 将是一种比 VB 更接近 Java 的语言。

不过，我认为您最终会使用 Java（通过熟悉 - 并不总是一件坏事）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-15T14:41:28.613

当我们构建客户端系统时，我们使用 .Net（通常是 C#）。我们在后端做 Java，但听起来你可能没有传统的后端。对于所有可用于 Java 的库和框架，目前绝大多数高质量的 UI 组件都在 .Net 空间中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-15T14:53:27.383

我认为你在哪种编程语言和环境中编程并不重要，只要你彻底了解它。C++、Java 和 C# 都有很好的库，并且都有自己的长处和短处。重要的是你知道语言的特性、开发环境、调试器、一个好的分析器、标准库、最好的第三方库等等......此外，一段时间后你可以重用你自己的代码作为好。例如，您提到了一个高级树小部件。在我们公司，我们有自己的树（在 C++ 中），我们可以根据需要对其进行微调。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-15T14:53:33.593

当您管理开发而其他人正在执行和维护时，我建议与他们协商编程语言。

当您必须进行维护时，请专注于您知道的语言。

如果您完成了所有/大部分工作，那么当您在途中没有足够的时间学习一门新语言时，只需使用您熟悉的语言即可。特别是如果应用程序很重要并且需要完全没有错误。（尽管我们都知道从来没有“最后一个错误”）;-)

3rd 方库的数量不是一个好的标准，因为这并不能反映它们的质量（也许大多数东西都是废话），而且许多库也意味着选择错误库的机会很大。

不要忘记检查所选语言是否能够胜任这项工作。（速度、平台限制、内存占用……）

# c++ - 用于闭源应用程序的 C++ 压缩 (zip) 库

> ID：751994
> 
> 赞同：11
> 
> 时间：2009-04-15T14:36:30.000
> 
> 标签：c++, compression, zip

请为商业闭源应用程序推荐一个 C++ 压缩 (zip) 库。所以，不是 GPL 许可证。

这是我的日常工作...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-15T14:41:21.220

我知道你说的是 C++，但[zlib](http://www.zlib.net/)是一个[获得许可](http://www.zlib.net/zlib_license.html)的C 库，你可以直接从 C++ 应用程序中使用它。

如果我没记错的话，zlib 周围也有各种“类似 iostream”的包装器可用。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-15T14:39:04.783

7 Zip 是 LGPL，这意味着只要您将其视为 3rd-party 库，您就可以在闭源应用程序中使用它。

[http://www.7-zip.org/](http://www.7-zip.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T18:29:15.453

如果你需要快速解压，你能找到的最好的可能是[LZO](http://www.oberhumer.com/opensource/lzo/)。请注意，在封闭源代码项目中使用时，您需要单独的（付费）商业许可证。不过，如果您需要快速减压，这可能是物有所值的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:55:14.487

[libbzip2](http://www.bzip.org/)是 BSD 许可的，应该比 zlib[压缩得更好，尽管速度较慢。](http://en.wikipedia.org/wiki/Bzip2#Compression_efficiency)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-30T14:28:46.723

试试这个：

[http://zziplib.sourceforge.net/](http://zziplib.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-10T12:29:27.817

Ultimate IDE 框架中的 zip 插件...看起来很容易使用。它在内部使用 zlib。*****