# StackOverflow 问答 11182000-11182999

# html - CSS 选择器和伪类

> ID：11182000
> 
> 赞同：0
> 
> 时间：2012-06-24T23:32:25.907
> 
> 标签：html, css, css-selectors, pseudo-class

例如说我有以下样式：

```
#HorizNav ul li a.active:link { background-color: #FFF; }
#HorizNav ul li a.active:visited { background-color: #FFF; }
#HorizNav ul li a.active:active { background-color: #FFF; }
#HorizNav ul li a.active:hover { background-color: #FFF; } 
```

如果所有样式都相同，那么我将如何将这些样式组合在一起？

会是这样吗？

```
#HorizNav ul li a.active:link, a.active:visited, a.active:active, a.active:hover { } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-24T23:34:43.067

更简单

```
#HorizNav ul li a.active { background-color: #FFF; } 
```

# vb.net - SNMP prtAlertCode

> ID：11182001
> 
> 赞同：0
> 
> 时间：2012-06-24T23:32:43.437
> 
> 标签：vb.net, printing, snmp

我一直在尝试从工作中的打印机获取警报代码，以查看到底发生了什么，但是每次发送 SNMP 查询时它都不会返回任何结果。我正在使用 SimpleSNMP 参考。

打印机是佳能 iR-ADV C5045。

这就是我调用函数的方式：

```
Dim strAlertCode As String = SNMPQueryGet("1.3.6.1.2.1.43.18.1.1.7") 
```

这是功能：

```
Private Function SNMPQueryGet(ByVal OID As String)
    Dim strResult As String = "True"

    Dim host As String = "192.168.1.202"
    Dim community As String = "public"
    Dim requestOid() As String
    Dim result As Dictionary(Of Oid, AsnType)
    requestOid = New String() {OID}
    Dim snmp As SimpleSnmp = New SimpleSnmp(host, community)
    If Not snmp.Valid Then
        strResult = True
    End If
    result = snmp.Get(SnmpVersion.Ver1, requestOid)
    If result IsNot Nothing Then
        Dim kvp As KeyValuePair(Of Oid, AsnType)
        For Each kvp In result
            If Not kvp.Key.ToString() = "" Then
                strResult = kvp.Value.ToString()
            Else
                strResult = "True"
            End If
        Next
    Else
        strResult = "True"
    End If

    Return strResult
End Function 
```

*编辑*

打印机 MIB PDF：[https ://dl.dropbox.com/u/19613123/MIB_iR-ADV-C5051-C5045-C5035-C5030_v120_non.pdf](https://dl.dropbox.com/u/19613123/MIB_iR-ADV-C5051-C5045-C5035-C5030_v120_non.pdf)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T21:31:20.133

Rambomst：您提到了包含所有 C5045 OID 的 PDF，您介意分享 PDF 吗？...我正在寻找那些代码！

iReasoning 的 MIB 浏览器对于 SNMP 调试非常方便：http: [//ireasoning.com/mibbrowser.shtml](http://ireasoning.com/mibbrowser.shtml)

# c - 分配中的不兼容类型

> ID：11182006
> 
> 赞同：2
> 
> 时间：2012-06-24T23:33:30.670
> 
> 标签：c

我正在用 C 编写一些代码：

```
int main(){
    char guess[15];
    guess = helloValidation(*guess);
    return 0;
} 
```

我的功能是：

```
char[] helloValidation(char* des) {
    do {
        printf("Type 'hello' : ");
        scanf("%s", &des);
    }while (strcmp(des, "hello") != 0);
        return des
} 
```

但它给了我这个错误：

```
incompatible types in assignment 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-24T23:38:29.103

数组由`guess`函数本身修改。然后您尝试重新分配数组指针`guess`，导致错误。更不用说错误地尝试引用`*guess`或`&des`错误地使用。我建议您阅读 C 指针/数组概念。

```
#include <stdio.h>
#include <string.h>

char* helloValidation(char* des) {
    do {
        printf("Type 'hello' : ");
        scanf("%s", des);
    } while (strcmp(des, "hello") != 0);
    return des;
}

int main() {
    char guess[15];
    helloValidation(guess);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-24T23:38:52.430

说法`scanf`不正确！它应该读作：

```
scanf("%s", des); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-24T23:36:53.317

您不能将其分配回guess，在您的情况下，您不必将guess传递给函数（摆脱那个 * ）

所以这个函数会改变猜测（不是它的副本），所以不需要尝试重新分配它

```
helloValidation(guess); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-24T23:39:12.733

由于您将猜测传递给 helloValidation 函数并在 scanf 中使用它，因此无需返回它并将其重新分配回 char[] 引用。

代替

```
guess = helloValidation(*guess); 
```

和

```
helloValidation(*guess); 
```

您收到错误是因为猜测引用已在堆栈上分配。你不能重写它。猜测是指针，您可以覆盖指针中的值，但这不会触及那里的内存。

# iphone - iOS 6 中的 UIScrollView

> ID：11182008
> 
> 赞同：11
> 
> 时间：2012-06-24T23:33:41.630
> 
> 标签：iphone, xcode, uiscrollview, ios6

最近我下载了 Xcode 4.5(iOS 6)，但是当我试图继续我的一个项目时，我注意到 UIScrollView 不能正常工作，让我更清楚地解释一下：

我创建了 UIScrollView 并使用以下代码添加了初始化它：

```
-(void)viewDidLoad{

    [mainScrollView setScrollEnabled:YES];
    mainScrollView.contentSize = CGSizeMake(480, 0);

    [super viewDidLoad];

} 
```

在我打开我的 XIB 并将其链接`mainScrollView`到 UIScrollView 之后，在我将一些 UIButton 添加到 scrollView 之后。当我构建项目时，它`mainScrollView`正在滚动但按钮没有出现，我的意思是，我只能看到已经存在的按钮屏幕上。**我在做什么错？如何设置 UIScrollView？**

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-30T11:18:12.907

对于`xcode 4.5`，如果您正在使用`scrollView`，则必须取消选中`use AutoLayout`文件检查器中的“”。

或者如果你想“使用`AutoLayout`”，那么在**.m(implementation) 文件**中添加这个

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    theScroller.contentSize=CGSizeMake(1024.0,1300.0);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T00:05:16.430

也许您只是输入错误，但您`CGSize`的高度为 0？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-31T15:02:45.553

您可以使用 XCode 4.5 中的自动布局来做到这一点但是您在 viewDidAppear 中配置 UIScrollView

我也在带有图像的静态 UITableView 中执行此操作。

将您的图像命名为 timg1.png、timg2.png....

在你的 ControllerView.h 文件中

```
@property (weak, nonatomic) IBOutlet UIScrollView *Sv1;
@property (weak, nonatomic) IBOutlet UIPageControl *Pc1; 
```

在您的 ControllerView.m 文件中

```
-(void)viewDidAppear:(BOOL)animated
{

    //Scrollview
    Sv1.delegate = self;

    Sv1.contentSize = CGSizeMake(260, 176);

    [self.Sv1 setBackgroundColor:[UIColor clearColor]];
    // ScrollViewGarten.frame = CGRectMake(9, 11, 283, 170);
    [Sv1 setCanCancelContentTouches:NO];

    Sv1.multipleTouchEnabled = NO;
    Sv1.indicatorStyle = UIScrollViewIndicatorStyleWhite;
    Sv1.clipsToBounds = YES;
    Sv1.scrollEnabled = YES;
    Sv1.pagingEnabled = YES;

    NSUInteger nimagesTextil = 0;
    CGFloat cxTextil = 0;
    for (; ; nimagesTextil++) {
        NSString *imageNameTextil = [NSString stringWithFormat:@"timg%d.png", (nimagesTextil + 1)];
        UIImage *imageTextil = [UIImage imageNamed:imageNameTextil];
        if (imageTextil == nil) {
            break;
        }
        UIImageView *imageViewTextil = [[UIImageView alloc] initWithImage:imageTextil];

        CGRect rect = imageViewTextil.frame;
        rect.size.height = 176;
        rect.size.width = 260;
        rect.origin.x = ((Sv1.frame.size.width - imageTextil.size.width) / 2) + cxTextil;
        rect.origin.y = ((Sv1.frame.size.height - imageTextil.size.height) / 2);

        imageViewTextil.frame = rect;

        [Sv1 addSubview:imageViewTextil];

        cxTextil += Sv1.frame.size.width;
    }
    self.Pc1.numberOfPages = nimagesTextil;
    [Sv1 setContentSize:CGSizeMake(cxTextil, [Sv1 bounds].size.height)];
    self.Pc1.currentPage = 0;

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-05T10:15:24.823

如果您想解决此问题并使用 AutoLayout，请将您的`contentSize`代码移至该`viewDidAppear`方法。我在这个 SO 问题中找到了答案：[Embed ImageView in ScrollView with Auto Layout on iOS 6](https://stackoverflow.com/questions/12619786/embed-imageview-in-scrollview-with-auto-layout-on-ios-6)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-18T19:57:20.030

我相信这是 Xcode 4.5 或 iOS 6 SDK 的错误。我修复它的方法是以编程方式将子视图添加到我的 UIScrollView 中。

因此，您必须执行以下操作：

```
- (void)viewDidLoad {

    [super viewDidLoad];

    UIButton *button = [[UIButton alloc] initWithFrame:CGRectMake(400.0f, 10.0f, 60.0f, 30.0f);
    [mainScrollView addSubView:button];
    mainScrollView.contentSize = CGSizeMake(480.0f, mainScrollView.frame.size.height);
} 
```

试试这个，让我知道这是否对你有用。

如果你有旧版本的 Xcode，复制代码和那里的 nib 以查看结果可能是个好主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-12T08:30:21.620

我会这样做：

```
-(void)viewDidLayoutSubviews
{
[self.scrollview setScrollEnabled:YES];
[self.scrollview setUserInteractionEnabled:YES];
[self.scrollview setContentSize:CGSizeMake(320, _y)];
[self.scrollview setAlwaysBounceVertical:YES];
} 
```

我使用类变量 _y 因为我将所有子视图高度添加到它。

# scala - 弱引用相等

> ID：11182009
> 
> 赞同：4
> 
> 时间：2012-06-24T23:34:00.947
> 
> 标签：scala

如何将 ref.WeakReference 实例与另一个 ref.WeakReference 实例进行比较？

内置的 equals 方法没有通过简单的检查：

```
import ref.WeakReference
val st : String = "qwerty"
val r1 : WeakReference[String] = new WeakReference(st)
val r2 : WeakReference[String] = new WeakReference(st)
r1 == r2
res1: Boolean = false 
```

可以使用`r1.get == r2.get`，但此方法无法用于比较对已处置对象的引用：在这两种情况下，我都会得到 None 和 None 等于 None

是否可以实际比较弱参考？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T00:18:20.537

问题是当对象被取消引用时没有安全的默认行为；因此，WeakReference 不会假装提供一个。将它包装在一个确实实现了适当行为的对象中是微不足道的。如果您愿意，您甚至可以提供一个隐式并让类型系统确保您的引用被正确的 equals 行为所要求。

所以简短的回答是：这不是为了保护你不去想它。

编辑（回应评论）：您正在构建身份服务。这维护了实体<->标识符的映射，该映射必须在对实体的所有引用的生命周期内持续存在。大多数情况下，实体和表示实体的对象是同一事物，对于这些情况，使用 a`WeakHashMap[Entity,Identifier]`用于实体->标识符映射和 a`WeakHashMap[Identifier,WeakReference[Entity]]`用于标识符->实体映射（如果且仅当需要时）。

如果您确实需要实体与对其标识符的引用一样长，您可以通过维护一个影子标识符来做到这一点，该标识符可以在需要时重生标识符，因此使用：`WeakHashMap[Entity,Shadow[Identifier]`并`WeakHashMap[Identifier, Tuple2[Shadow[Identifier],Entity]]`在 Shadow 中使用适当的重生逻辑包装来观察 ReferenceQueues。

但是，大多数情况下，如果简单的方法不合适，您就需要跟踪外部标识符，此时事情既非常棘手，又对您要解决的确切问题非常敏感。

# redis - redis：备份dump.rdb

> ID：11182012
> 
> 赞同：31
> 
> 时间：2012-06-24T23:34:42.217
> 
> 标签：redis

## 语境

我有一个实时运行的 redis 服务器。

我想做一个备份。

## 主意：

我想做以下事情：

```
cp dump.rdb ~/some-other-location/06-24-2012.rdb ? 
```

## 关心

我没有看到任何东西可以保证 dump.rdb 始终是一个一致的数据库存储。（也就是说，在我看来，当我执行 cp 时，redis 正在写入一些数据，因此 dump.rdb 处于不一致状态。）

## 问题：

这很糟糕，因为我现在必须关闭 redis 数据库才能制作 dump.rdb 的副本

## 问题：

在 redis-server 运行时，对数据库进行实时备份的正确方法是什么？手册的哪一部分向我保证，这种方法会创建一个处于一致（不是半写）状态的数据库。

谢谢！

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-06-25T06:00:08.263

来自[http://redis.io/topics/persistence](http://redis.io/topics/persistence)

> > Redis 对数据备份非常友好，因为您可以在数据库运行时复制 RDB 文件：RDB 一旦生成就永远不会修改，并且在生成时它使用临时名称并仅使用 rename(2) 以原子方式重命名为最终目标当新快照完成时。

因此，正确的方法是简单地将 dump.rdb 复制到您的备份位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T11:29:20.490

**如果您使用 Amazon S3，使用s3cmd**工具备份 Redis 数据库非常简单。

s3cmd： [http ://s3tools.org/s3cmd](http://s3tools.org/s3cmd)

教程： http: [//guchex.com/viniciusfbm/post/50/how-to-backup-redis-database-encrypted-to-s3-via-command-line-ubuntu](http://guchex.com/viniciusfbm/post/50/how-to-backup-redis-database-encrypted-to-s3-via-command-line-ubuntu)

# c# - Assert.AreEqual 失败。预期的： . 实际的：

> ID：11182015
> 
> 赞同：0
> 
> 时间：2012-06-24T23:35:00.620
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, unit-testing

我是单元测试的新手，所以我可能做错了什么。

我有一些 XmlResult 类：

```
public class XmlResult : ActionResult
    {
        public XmlDocument Document { private get; set; }

        public override void ExecuteResult(ControllerContext context)
        {
            //Do something
        }
    } 
```

我也有控制器扩展方法：

```
public static class ControllerExtensions
    {
        public static XmlResult Xml(this Controller controller, XmlDocument document)
        {
            return new XmlResult { Document = document };
        }
    } 
```

和一个测试方法：

```
[TestClass]
    public class ControllerExtensionsTests
    {
        #region Xml
        [TestMethod]
        public void XmlExtensionShouldReturnCorrectValue()
        {
            // Arrange
            var mockRepository = new Mock<T>();
            var productsController = new ProductController(mockProductRepository.Object);

            var someXmlDocument = new XmlDocument();

            // Act
            var actual = productsController.Xml(someXmlDocument);
            var expected = new XmlResult { Document = someXmlDocument };

            // Assert
            Assert.AreEqual(expected, actual);               
        }
        #endregion
    } 
```

当我称`Assert.AreEqual(expected, actual);` 我的测试失败并显示消息时`"Assert.AreEqual failed. Expected:<XmlResult>. Actual:<XmlResult>."`。我究竟做错了什么？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:12:46.897

我会在你的 xml 结果类上添加一个覆盖 equals 方法，并为 equals 比较做你自己的实现。

像下面这样的......

```
public class XmlResult : ActionResult
{
    public XmlDocument Document { private get; set; }

    public override void ExecuteResult(ControllerContext context)
    {
        //Do something
    }

    public bool Equals(XmlResult other)
    {
        if(ReferenceEquals(null, other))
        {
            return false;
        }
        if(ReferenceEquals(this, other))
        {
            return true;
        }
        return Equals(other.Document, Document);
    }

    public override int GetHashCode()
    {
        return (Document != null ? Document.GetHashCode() : 0);
    }
} 
```

# c# - 在 Windows 窗体中从 Active Directory 导入计算机

> ID：11182017
> 
> 赞同：0
> 
> 时间：2012-06-24T23:35:05.890
> 
> 标签：c#, winforms, active-directory

在 Windows 窗体应用程序中，是否有任何控件允许使用来自 AD DS 的按钮导入？（类似于允许选择文件的控件）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T05:06:09.713

不幸的是，基本的.NET 类库没有这样的东西。

但是社区一直很忙，并提供了几种实现：

*   [Active Directory 对象选取器控件](http://www.codeproject.com/Articles/6848/Active-Directory-object-picker-control)

![在此处输入图像描述](../Images/756b8e863d3b187048a7bf6fbef806e5.png)

*   [Active Directory 通用对话框 .NET](http://adui.codeplex.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T05:06:39.527

不确定它是否能满足您的所有需求，但它存在名为**Directory Object Picker**的东西，它仅适用于用户和组（本地或域中）。[Microsoft 解释了如何在 C++ 中使用它](http://msdn.microsoft.com/en-us/library/ms675899.aspx)。[这个](http://www.csharpfr.com//code.aspx?ID=52023)法国网站给出了一个用 C# 完成同样事情的项目。我也做我自己的版本。

# ruby-on-rails-3 - 如何定义路线

> ID：11182019
> 
> 赞同：0
> 
> 时间：2012-06-24T23:35:17.320
> 
> 标签：ruby-on-rails-3, routes

在我的`routes.rb`文件中，我已将成员添加到电影资源：

```
resources :movies do
  get 'search', :on => :member
end 
```

所以我有这个路线列表：

```
search_movie GET    /movies/:id/search(.:format) {:action=>"search", :controller=>"movies"}
      movies GET    /movies(.:format)            {:action=>"index", :controller=>"movies"}
             POST   /movies(.:format)            {:action=>"create", :controller=>"movies"}
   new_movie GET    /movies/new(.:format)        {:action=>"new", :controller=>"movies"}
  edit_movie GET    /movies/:id/edit(.:format)   {:action=>"edit", :controller=>"movies"}
       movie GET    /movies/:id(.:format)        {:action=>"show", :controller=>"movies"}
             PUT    /movies/:id(.:format)        {:action=>"update", :controller=>"movies"}
             DELETE /movies/:id(.:format)        {:action=>"destroy", :controller=>"movies"} 
```

我希望在我看来使用这条路线如下：

```
= link_to 'Find Movies With Same Director', search_path(@movie) 
```

但它出现了错误：

```
undefined local variable or method `search_path' 
```

我的错误是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T23:38:05.693

试试这个功能：`search_movie_path`

# java - 搜索时忽略变音符号

> ID：11182020
> 
> 赞同：4
> 
> 时间：2012-06-24T23:35:29.713
> 
> 标签：java, search, grails, lucene, compass-lucene

我正在使用 Compass/Lucene 来搜索和索引我的数据库。我希望在搜索时忽略变音符号和字符大小写，这样查询“foo”将匹配“Fóo”和“foo”，而对“fóó”的查询将匹配“fóo”和“fOO”。

根据我读过的内容，我似乎需要更改 Compass 在索引和搜索上下文时使用的默认分析器。我找到了指定要使用的分析器的位置，但似乎找不到满足我要求的分析器实现。是否已经存在忽略变音符号和字符大小写的分析器，还是我需要自己编写？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-24T23:55:59.027

查看 org.apache.lucene.analysis.ASCIIFoldingFilter 看看它是否符合您的要求。如果没有，我会使用它的源代码作为编写自己的源代码的起点。

您是对的，您*必须*使用相同的分析器配置进行索引和查询，原因很明显，如果您已经从索引中剥离了所有变音符号，那么您也需要从任何查询中剥离它们。

需要注意的一件事是确保在索引/查询过程中的某个地方对任何 unicode 进行规范化。具体参见：[http](http://unicode.org/reports/tr15/) : //unicode.org/reports/tr15/、http: [//unicode.org/faq/normalization.html](http://unicode.org/faq/normalization.html)和[http://docs.oracle.com/javase/6/docs/api/ java/text/Normalizer.html](http://docs.oracle.com/javase/6/docs/api/java/text/Normalizer.html)。

编辑：正如下面评论中提到的，作为过滤器，您不能直接将 ASCIIFoldingFilter 用作分析器，但是在此处将其包含在分析器中的直接说明：stackoverflow.com/a/3834244/390153

编辑：正如@jspboix 在下面的评论中提到的，您还需要链接 LowerCaseFilter 来处理字符大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T17:48:08.597

在我的 Grails 应用程序中，我使用了可搜索插件，并且刚刚将系统配置为使用“德语”分析器：

```
compassSettings = ['compass.engine.analyzer.default.type': 'German'] 
```

这至少忽略了大小写和变音符号 - “ä”在索引中存储为“a”。

我刚刚在我的一个测试文档中添加了“Fóo”和“Föo”并搜索了“foo”——它找到了“Föo”但没有找到“Fóo”。所以我想如果你将语言切换到正确的值（法语？）它应该可以工作。

# javascript - 通过 API 调用 Google Play 搜索查询的 JSON 输出？

> ID：11182023
> 
> 赞同：12
> 
> 时间：2012-06-24T23:36:16.043
> 
> 标签：javascript, google-play

是否有一个 API 可以在 Google Play 中搜索特定名称（例如食物）的应用程序并将输出返回为 JSON？

例如，我们希望有一个 API 可以解析这样的查询：https: [//play.google.com/store/search?q=food&c=apps](https://play.google.com/store/search?q=food&c=apps)

我们需要一些东西让 JavaScript 从网页中被调用。

我们见过的所有 Google Play API 都不允许这样做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-28T06:53:17.850

从 AppAware 找到一个 JSON API：[https ://groups.google.com/forum/?fromgroups#!topic/android-market-api/-F2QfvGt1nU](https://groups.google.com/forum/?fromgroups#!topic/android-market-api/-F2QfvGt1nU)

注意：它只检查应用程序，这足以满足我们的目的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-06T15:37:21.023

您可能需要查看此线程：**[从 Android Play 商店获取数据](https://stackoverflow.com/questions/10272155/getting-data-from-android-play-store)**：

*   嵌入式 JAR 解决方案
*   AC#项目
*   许多网站提供废弃 Google Play 内容

# javascript - jQuery .hover() 性能疑点

> ID：11182025
> 
> 赞同：1
> 
> 时间：2012-06-24T23:36:32.217
> 
> 标签：javascript, jquery, performance, variables, hover

虽然我知道一些 jQuery 来简化前端操作编程，但我也知道一些“最佳实践”来提高浏览器的性能，比如缓存通过`var`ID 选择器并始终从 ID 选择器下降。但是我对这段代码有疑问。能不能做得更好？

序言：此代码通过 .hover() 为（已缓存的）选择器内的几个块设置动画。

HTML 是这样的：

```
<div clas="block-link red">(...)</div>
<div clas="block-link yellow">(...)</div>
<div clas="block-link magenta">(...)</div>
<div clas="block-link moradopelusa">(...)</div> 
```

和 jQuery 在其中一个动画中悬停：

```
var cached_blocks = jQuery(.block-link);

jQuery(cached_blocks).hover(function(){
    var this_block = jQuery(this),
        this_block_text = jQuery(this_block).children(div.text),
        this_block_image = jQuery(this_block).children(div.image),
        this_block_link = jQuery(this_block).children(div.link),
        this_block_link_icon = jQuery(this_block_link).children(a.icon);

    /* Animate in; show everything */
    jQuery(this_block_text).animate(..);
    jQuery(this_block_image).animate(..);
    jQuery(this_block_link).animate(..);
    jQuery(this_block_link_icon).animate(..);

}, function() {
    var this_block = jQuery(this),
        this_block_text = jQuery(this_block).children(div.text),
        this_block_image = jQuery(this_block).children(div.image),
        this_block_link = jQuery(this_block).children(div.link),
        this_block_link_icon = jQuery(this_block_link).children(a.icon);

    /* Animate out; put everything where they belong */
    jQuery(this_block_text).animate(..);
    jQuery(this_block_image).animate(..);
    jQuery(this_block_link).animate(..);
    jQuery(this_block_link_icon).animate(..);
}); 
```

我看到我在悬停后再次声明变量，但我不知道有什么技巧可以不再做。无论如何，即使这样，它也像一个魅力。

**更新：**固定代码 #1

```
var cached_blocks = jQuery(.block-link);

jQuery(cached_blocks).on('mouseenter mouseleave', function(){
    var this_block = jQuery(this),
        this_block_text = jQuery(this_block).children(div.text),
        this_block_image = jQuery(this_block).children(div.image),
        this_block_link = jQuery(this_block).children(div.link),
        this_block_link_icon = jQuery(this_block_link).children(a.icon);

    /* Animate in; show everything */
    this_block_text.animate(e.eventType(...));
    this_block_image.animate(e.eventType(...));
    this_block_link.animate(e.eventType(...));
    this_block_link_icon.animate(e.eventType(...));
}); 
```

注 1：是的，我在代码的其他部分使用了 cached_blocks。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:00:56.077

您似乎无缘无故地重复代码？

```
var cached_blocks = jQuery('.block-link');

cached_blocks.on('mouseenter mouseleave', function(e) {
    var this_block = jQuery(this),
        this_block_text = this_block.children('div.text'),
        this_block_image = this_block.children('div.image'),
        this_block_link = this_block.children('div.link'),
        this_block_link_icon = this_block.children('a.icon');

    this_block_text.animate({something: (e.type==='mouseenter' ? 0 : 400)});
    this_block_image.animate({top: (e.type==='mouseenter' ? 10 : 200)});
    this_block_link.animate({left: (e.type==='mouseenter' ? 300 : 40)});
    this_block_link_icon.animate({right: (e.type==='mouseenter' ? 0 : 1400)});
}); 
```

除非您也在其他地方使用包含 text/image/link... 元素的变量，否则缓存它们只是为了与下一行的 animate() 一起使用是浪费空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-24T23:47:49.153

我认为您可以绑定`mouseout`和`mouseover`使用相同的回调闭包`($element.on("mouseout mouseover", callback))`，并使用类似的东西检测闭包内的事件`e.type == "mouseout"`。

在你的代码中你正在做

```
this_block_text = jQuery(this_block).children(div.text) 
```

进而

```
jQuery(this_block_text).animate(..); 
```

为什么不是这个？

```
this_block_text.animate(..) 
```

`this_block_text`已经是一个 jQuery 对象

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-24T23:49:54.127

```
jQuery(this_block_text).animate(..);
jQuery(this_block_image).animate(..);
jQuery(this_block_link).animate(..);
jQuery(this_block_link_icon).animate(..); 
```

没有必要将它们写成 jQuery(...) 因为 this_block_text、this_block_image 等已经是 jQuery 对象。

```
this_block_text.animate() 
```

会跑。

同样使用 $.() 而不是 jQuery() 更好更干净。

而且 $('div.block-link') 比 $('.block-link') 快

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-24T23:52:27.700

在这段代码中最突出的是你调用的频率`jQuery`。如果您已经有一个 jQuery 对象，则无需再次调用 jQuery。

这：

```
var cached_blocks = jQuery(".block-link");
jQuery(cached_blocks).hover(...); 
```

做同样的事情：

```
var cached_blocks = jQuery(".block-link");
cached_blocks.hover(...); 
```

如果您不打算重用`cached_blocks`，那么拥有它不会有任何性能改进，因此您可以将代码简化为：

```
jQuery(".block-link").hover(...); 
```

如果元素已经在页面上，我会将代码简化为：

```
var links = jQuery(".block-link");

var parts = {
    text: links.children("div.text"),
    image: links.children("div.image"),
    link: links.children("div.link"),
    icon: links.children("a.icon")
};

links.hover(function() {
    parts.text.animate(..);
    parts.image.animate(..);
    parts.link.animate(..);
    parts.icon.animate(..);
}, function() {
    parts.text.animate(..);
    parts.image.animate(..);
    parts.link.animate(..);
    parts.icon.animate(..);
}); 
```

在不知道你想做什么样的动画的情况下，我无法再简化它，但我怀疑你也不需要这么多调用来制作动画。

# objective-c - 使用屏幕截图 xcode 4.2 保存屏幕的一部分

> ID：11182029
> 
> 赞同：-1
> 
> 时间：2012-06-24T23:36:58.053
> 
> 标签：objective-c, ios5, xcode4.2, screenshot

在我的应用程序中，我有一个 ui 图像视图，其中删除的部分覆盖在另一个图像视图之上，因此用户可以从相机胶卷上传图片并在屏幕上进行操作。我想使用以下代码将这两个图像保存在一起以拍摄屏幕。但是，由于它还采用了顶部栏和底部的选项卡视图，是否可以通过屏幕截图按钮指定屏幕的某个区域进行保存？

我可以操作以下代码，使其不会对整个屏幕进行屏幕截图，这样我就可以省略条形按钮吗？

```
if ([[UIScreen mainScreen] respondsToSelector:@selector(scale)])
    UIGraphicsBeginImageContextWithOptions(self.view.window.bounds.size, NO, [UIScreen mainScreen].scale);
else
    UIGraphicsBeginImageContext(self.view.bounds.size);
[self.view.window.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *viewImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();

UIImageWriteToSavedPhotosAlbum(viewImage, nil, nil, nil); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T23:44:06.627

好吧，您总是可以从`UIView`,

```
UIGraphicsBeginImageContext(view.bounds.size);
[view.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

所以，基本上不是从整个窗口的视图中获取图层......您只需从您感兴趣的视图中获取图层，然后从中创建图像。

然后将图像保存到您想要的任何位置。

# .htaccess - htaccess - 重定向子域内的内容，但不是子域

> ID：11182032
> 
> 赞同：0
> 
> 时间：2012-06-24T23:37:36.157
> 
> 标签：.htaccess, redirect, directory, subdomain

我目前正在使用：

```
RedirectMatch 301 http://blog.domain.com/(.*) /blog/article/$1 
```

将旧链接如：blog.domain.com/article-title 重定向到 www.domain.com/blog/article/article-title

但是，当我只是访问 blog.domain.com 时，它会将我带到 www.domain.com/blog/article。

这是一个意想不到的副作用。我希望 blog.domain.com/ 本身简单地重定向到 www.domain.com/blog 但其中的内容如上所述重定向（效果很好。）

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-24T23:56:10.383

`/(.*)`将匹配后跟零个或多个字符的斜线，这意味着`http://blog.example.com/`将匹配并由该规则处理。将其更改为`/(.+)`仅匹配一个斜杠后跟一个或多个字符，这应该会停止根重定向。像这样的东西怎么样：

```
Redirect 301 / http://www.example.com/blog
RedirectMatch 301 /(.+) http://www.example.com/blog/article/$1 
```

如果将 blog.example.com 放在虚拟主机中，这将起作用，假设 [www.]example.com 位于单独的虚拟主机中。如果您从单个虚拟主机中处理它们，这将无休止地重定向到自身。我知道在一个 vhost 中处理它的唯一方法是使用 mod_rewrite。像这样的东西，也许：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^(www\.)?blog\.example\.com$ [NC]
RewriteRule ^$ http://www.example.com/blog/ [R=301,L]

RewriteCond %{HTTP_HOST} ^(www\.)?blog\.example\.com$ [NC]
RewriteRule ^(.+)$ http://www.example.com/blog/article/$1 [R=301,L] 
```

# java - 从 Spring 2.5 MVC 到 Spring 3.0 MVC

> ID：11182033
> 
> 赞同：3
> 
> 时间：2012-06-24T23:37:56.367
> 
> 标签：java, spring, spring-mvc, controller, annotations

我正在尝试学习 Spring，并且正在学习 Spring 2.5 中编写的教程。我的研究表明，SimpleFormController 已被贬低，取而代之的是注释 @Controller。我正在尝试将此类转换为控制器类，有人可以告诉我这是如何完成的，下面是我的类。我不确定类中的方法，但这些方法也会改变还是我只是在我的类中添加注释？

```
package springapp.web;

import org.springframework.web.servlet.mvc.SimpleFormController;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.view.RedirectView;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import springapp.service.ProductManager;
import springapp.service.PriceIncrease;

public class PriceIncreaseFormController extends SimpleFormController  {

    /** Logger for this class and subclasses */
    protected final Log logger = LogFactory.getLog(getClass());

    private ProductManager productManager;

    public ModelAndView onSubmit(Object command)
            throws ServletException {

        int increase = ((PriceIncrease) command).getPercentage();

        logger.info("Increasing prices by " + increase + "%.");

        productManager.increasePrice(increase);

        logger.info("returning from PriceIncreaseForm view to " + getSuccessView());

        return new ModelAndView(new RedirectView(getSuccessView()));
    }

    protected Object formBackingObject(HttpServletRequest request) throws ServletException {
        PriceIncrease priceIncrease = new PriceIncrease();
        priceIncrease.setPercentage(20);
        return priceIncrease;

    }

    public void setProductManager(ProductManager productManager) {
        this.productManager = productManager;
    }

    public ProductManager getProductManager() {
        return productManager;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:27:07.223

通过使用 注释“createPriceIncrease”方法`@ModelAttribute`，您可以告诉 spring 如何最初填充“priceIncrease”模型值。

告诉 Spring在`@SessionAttributes`每次请求后自动将“priceIncrease”对象存储在会话中。

最后，`@ModelAttribute`“post”和“get”方法的方法参数告诉spring找到一个名为“priceIncrease”的模型属性。
它会知道这是一个会话属性，如果可以的话，会在那里找到它，否则，它将使用“createPriceIncrease”方法创建它。

```
@Controller
@SessionAttributes({"priceIncrease"})
@RequestMapping("/priceIncrease")
public class MyController {

  @ModelAttribute("priceIncrease")
  public PriceIncrease createPriceIncrease() {
      PriceIncrease priceIncrease = new PriceIncrease();
      priceIncrease.setPercentage(20);
      return priceIncrease;
  }

  @RequestMapping(method={RequestMethod.POST})
  public ModelAndView post(@ModelAttribute("priceIncrease") PriceIncrease priceIncrease,
      HttpServletRequest request,
      HttpServletResponse response) {
     ...
  }

  @RequestMapping(method={RequestMethod.GET})
  public ModelAndView get(@ModelAttribute("priceIncrease") PriceIncrease priceIncrease,
      HttpServletRequest request,
      HttpServletResponse response) {
     ...
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-24T23:45:57.673

控制器不需要扩展任何类；只需适当地注释它。

我认为[“Bare Bones Spring”](https://github.com/JamesEarlDouglas/barebones-spring-mvc)是一个很好的 3.0 教程。

# android - 单击选项卡直接使用选项卡进入新活动

> ID：11182039
> 
> 赞同：0
> 
> 时间：2012-06-24T23:38:30.597
> 
> 标签：android, android-tabs

我有一个底部有 2 个选项卡的屏幕，当单击第二个选项卡时，它将定向到另一个底部也有 2 个选项卡的新屏幕，但是第一个屏幕中的选项卡将堆叠在新屏幕中，请查看图像，您可以看。

第一个屏幕

```
setContentView(R.layout.tabs);   
TabHost tabHost = getTabHost();
Intent intent = getIntent();
intent.setClass(this, CardDetailActivity.class);
tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator("CardDetail").setContent(intent));
intent.setClass(this, CardTransTabActivity.class);
tabHost.addTab(tabHost.newTabSpec("tab2").setIndicator("Transactions").setContent(intent)); 
```

第二屏

```
setContentView(R.layout.tabs);
TabHost tabHost = getTabHost();
Intent intent = getIntent();
intent.setClass(this, UsageTransactionHistoryActivity.class);
tabHost.addTab(tabHost.newTabSpec("tab1").setIndicator("FarePayment").setContent(intent));
intent.setClass(this, ReloadTransactionHistoryActivity.class);
tabHost.addTab(tabHost.newTabSpec("tab2").setIndicator("Reload").setContent(intent)); 
```

![在此处输入图像描述](../Images/6f88f5d55b8c237dc662ff7ec882a305.png)

我不希望选项卡堆叠在第二个屏幕中，该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:40:02.370

除了我在评论中提到的问题之外，这是预期的行为。TabHost 已弃用，应避免使用。您应该查看新的[ActionBar](http://developer.android.com/reference/android/app/ActionBar.html)或实现启动 Activity 的自定义按钮。

# ruby-on-rails - 在 Ruby on Rails 中处理投标网站的最佳方式

> ID：11182044
> 
> 赞同：0
> 
> 时间：2012-06-24T23:39:41.237
> 
> 标签：ruby-on-rails, payment, credit-card

我是 Ruby on Rails 的新手，我正在尝试制作一个类似于 ebay 的网站（用户可以发布列表，其他人可以对这些列表出价）。我想知道处理从一个用户到另一个用户的资金转移的最佳方法是什么。PayPal 会是最佳解决方案，还是有任何其他服务可以在不收取任何费用或不从每笔交易中扣除百分比的情况下做得更好？再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T23:53:03.267

那么买家会先将钱转入您的账户，然后您将在减免后将这笔钱汇给卖家。当然，您可以接受贝宝或任何其他支付网关。有关详细信息，请参阅[active_merchant](http://activemerchant.org)。

# php - 将韩文字符插入mysql

> ID：11182047
> 
> 赞同：4
> 
> 时间：2012-06-24T23:40:03.413
> 
> 标签：php, mysql, sql

我想在 MySQL 中插入一些短语

第一个字段是英语，第二个字段是韩语。每次我从我的 PHP 脚本中插入值时都会出现问题，它会像这样在 MYSQL 中显示。`&#54617;&#44368;`

但是，如果我从 PhpMyAdmin 插入相同的韩语值，它将起作用，所以问题来自 php 脚本。我在网上发现我必须`Collation`在 MySQL 中更改？

有什么帮助吗？

```
<?

//*---------------------------------------------------------*\\
//* if POST
//*---------------------------------------------------------*\\
if($_POST['addphrase'])
{
    $SQL = "INSERT INTO `sd_phrases` VALUES(NULL,?,?)";
    $db = new db();
    $db->execute($SQL,$_POST['english'],$_POST['korean']);
    $box = new true_box();
    $box->init('PLease Wait....','index.php?action=phrases');
    die();
}

?>
<form method="post">
<center>
    <table class="horz">
    <tr><th colspan="2">Add a new Phrase</th></tr>
    <tr><td>English Phrase</td><td><div align="left"><input type="text" size="80" name="english"></div>
    </td></tr>
    <tr><td>Korean Phrase</td><td><div align="left"><input type="text" size="80" name="korean"></div>
    </td></tr>
    <tr><td colspan="2"><input type="submit" value="Add" name="addphrase"></td></tr>
    </table>
</center>
</form> 
```

![在此处输入图像描述](../Images/17891c44216a20c5369e3d49c9a46ba9.png)

![在此处输入图像描述](../Images/d6350cc44c5d8f993bdc315894b91c8a.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-24T23:46:35.630

排序规则应设置`utf8_unicode_ci`为 Danack57 所说的。

您应该只使用 UTF8 作为您的字符编码方案。

```
default-character-set = utf8 
```

打开每个mysql连接后，执行`set names utf8;` Read [this](http://www.bluebox.net/news/2009/07/mysql_encoding/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T01:14:40.053

问题是 html 页面向用户浏览器报告编码的方式。我怀疑一个报告为 utf8，另一个报告为其他编码。因此，当这些值从浏览器回传时，它们的编码方式不同。Php 不进行编码，它或多或少地采用表单发布的内容。加载页面并检查网络浏览器中的编码，看看您是否可以让两个页面使用元标记报告相同的编码。

# php - header() 函数不像手册中所写的那样工作。错误可能在哪里？

> ID：11182050
> 
> 赞同：4
> 
> 时间：2012-06-24T23:40:59.900
> 
> 标签：php, http-headers, httpresponse, response.redirect

我在功能上有一些问题`header()`。它可以工作，但不能同时工作。

手册说：

> 请记住，必须在发送任何实际输出之前调用 header()，无论是通过普通 HTML 标记、文件中的空白行还是从 PHP 发送。

否则会出错。

`header()`但是在发送输出并工作后，我可以在 html-script 或 php 代码中的任何位置调用`header()`：

```
<?php
   echo "Output here";
   header("Location: http://stackoverflow.com");    // it works, it redirects to the site
   echo "And output here";
?> 
```

任何`header()`作品。这个`header("Some-Header: bar-foo")`可以设置标题：

```
<!DOCTYPE html>
<html>
   <body>

     … some script here…

    <?php
      print_r(headers_list());      // only one header: [0] => X-Powered-By: PHP/5.3.5
      header("Some-Header: bar-foo")
      print_r(headers_list());      // two headers: [0] => X-Powered-By: PHP/5.3.5
                                                    [2] => Some-Header: bar-foo
      var_dump(headers_sent($file, $line)); // bool(false)
      var_dump($file); // string(0) ""
      var_dump($line); // int(0)
    ?>

     … some script here…

   </body>
</html> 
```

怎么可能？设置有问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T23:43:27.857

如果输出缓冲打开并且您在第一次刷新之前写入标头，则可能会发生这种情况。见[http://www.php.net/manual/en/ref.outcontrol.php#ini.output-buffering](http://www.php.net/manual/en/ref.outcontrol.php#ini.output-buffering)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-24T23:43:40.623

`php.ini`很有可能启用了[output_buffering](http://www.php.net/manual/en/outcontrol.configuration.php#ini.output-buffering)，这是该规则的例外。例如

```
<?php

  ob_start();
  echo 'Foo';
  header('Location: http://www.google.com/');
  echo 'Bar';
  ob_end_flush(); 
```

（注：`ob_start`如果启用了ini，脚本文件中不需要`output_buffering`，但想通过代码演示前提）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-24T23:53:44.407

我认为您的 php 配置文件有问题，可能在您的 php.ini 中，您将 output_buffering 设置为非关闭值。

# c++ - kdevelop #包括

> ID：11182051
> 
> 赞同：4
> 
> 时间：2012-06-24T23:41:19.183
> 
> 标签：c++, eigen, kdevelop

Kdevelop wiki[说（页面底部）](http://userbase.kde.org/KDevelop4/FAQ)

*对于配置构建工具链后 KDevelop 仍未正确确定包含路径的情况，您可以手动将每个目录的包含路径添加到 .kdev_include_paths 文件中。这可以通过运行与“找不到包含文件”问题相关联的“解决问题”向导在 KDevelop 内部完成，例如通过悬停有问题的#include 行。*

现在，我已经这样做了（不再有任何有问题的、下划线的、#include 行）。但是当我尝试构建时，我得到：

```
~/projects/mqncpptest/build> make
[100%] Building CXX object CMakeFiles/mqncpptest.dir/main.cpp.o
~/projects/mqncpptest/main.cpp:15:23: fatal error: Eigen/Dense: No such file or directory
compilation terminated. 
```

用户 BЈовић 询问更多信息：

我按照 KDEvelop 指令进行了最小编译。项目->从模板新建->标准（基于简单 C make 的 c++ 应用程序）。版本控制系统为“none”，cmake 目录为：/usr/bin/cmake。然后KDEvelop下划线`#include <Eigen/Dense>`，我点击屏幕下端弹出的“添加自定义包含路径”，输入特征路径，删除下划线，`#include <Eigen/Dense>`然后构建，然后我得到`/home/kaveh/projects/mqn_get/main.cpp:15:23: fatal error: Eigen/Dense: No such file or directory`。我应该补充一点，这段代码在 eclipse 和 shell 中构建没有问题。

动机：我正在尝试在 kdevelop 下构建它，因为我需要使用调试器（代码没有给出预期的结果）而且 eclipse对IMO 来说太重了*。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T06:07:48.080

您所做的是为解析器包含了一个目录，但没有为构建包含一个目录。为此，您需要修改您的 make 文件。

对于 g++，您需要使用[-I](http://gcc.gnu.org/onlinedocs/cpp/Search-Path.html)选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T23:54:07.297

你应该包括

```
#include "Eigen/Dense" 
```

而不是

```
#include <Eigen/Dense> 
```

最后一个用于包含在系统头目录中

# ruby - Ruby 中的 to_s 与 to_str（以及 to_i/to_a/to_h 与 to_int/to_ary/to_hash）

> ID：11182052
> 
> 赞同：67
> 
> 时间：2012-06-24T23:41:26.580
> 
> 标签：ruby, string, methods

我正在学习 Ruby，我看到了一些让我有点困惑的方法，尤其是`to_s`vs `to_str`（以及类似的`to_i`/ `to_int`、`to_a`/ `to_ary`、 & `to_h`/ `to_hash`）。我读过的内容解释了较短的形式（例如`to_s`）用于显式转换，而较长的形式用于隐式转换。

我真的不明白如何`to_str`实际使用。字符串以外的东西会定义`to_str`吗？你能给出这个方法的实际应用吗？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-06-24T23:55:04.233

首先请注意，所有这些都适用于 Ruby 中的每一对“短”（例如`to_s`/ `to_i`/ `to_a`/ `to_h`）与“长”（例如`to_str`/ `to_int`/ `to_ary`/ `to_hash`）强制方法（对于它们各自的类型），因为它们都具有相同的语义。

* * *

它们有不同的含义。你不应该实现`to_str`，除非你的对象*像*一个字符串，而不是仅仅由一个字符串*表示*。唯一实现的核心类`to_str`是 String 本身。

来自*Programming Ruby*（引自[这篇博](https://web.archive.org/web/20161201181048/http://briancarper.net/blog/98.html)文，值得一读）：

> [`to_i`和`to_s`] 不是特别严格：例如，如果一个对象具有某种体面的字符串表示形式，它可能会有一个`to_s`方法…… [`to_int`和`to_str`] 是严格的转换函数：只有当 [您的] 对象可以自然地实现它们时，您才能实现它们在每个可以使用字符串或整数的地方使用。

[Pickaxe 中较旧的 Ruby 文档](http://ruby-doc.com/docs/ProgrammingRuby/html/ref_c_string.html#String.to_str)有这样的说法：

> 几乎所有类都支持的不同`to_s`，`to_str`通常仅由那些行为类似于字符串的类实现。

例如，除了[Integer](http://ruby-doc.org/core/Integer.html#method-i-to_int)之外，[Float](http://ruby-doc.org/core/Float.html#method-i-to_int)和[Numeric](http://ruby-doc.org/core/Numeric.html#method-i-to_int)都实现了`to_int`(`to_i`的等价物`to_str`)，因为它们都可以很容易地替换 Integer （它们实际上都是数字）。除非你的类与 String 有同样紧密的关系，否则你不应该实现`to_str`.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-10-28T13:59:42.173

要了解您是否应该使用/实现`to_s`/ `to_str`，让我们看一些示例。**考虑到这些方法何时失败**是有启发性的。

```
1.to_s              # returns "1"
Object.new.to_s     # returns "#<Object:0x4932990>"
1.to_str            # raises NoMethodError
Object.new.to_str   # raises NoMethodError 
```

正如我们所看到的，`to_s`很乐意将**任何对象**变成字符串。另一方面，当其参数看起来不像字符串时`to_str` **会引发错误。**

* * *

现在让我们来看看`Array#join`。

```
[1,2].join(',')     # returns "1,2"
[1,2].join(3)       # fails, the argument does not look like a valid separator. 
```

`Array#join`在加入它们之前将数组中的项目（无论它们实际上是什么）转换为字符串很有用，因此`Array#join`调用`to_s`它们。

但是，分隔符应该是一个字符串——**有人打电话`[1,2].join(3)`可能会出错**。这就是`Array#join`调用`to_str`分隔符的原因。

* * *

同样的原则似乎也适用于其他方法。考虑`to_a`/`to_ary`在哈希上：

```
{1,2}.to_a      # returns [[1, 2]], an array that describes the hash
{1,2}.to_ary    # fails, because a hash is not really an array. 
```

总而言之，这是我的看法：

*   调用`to_s` 以获取描述对象的字符串。
*   调用`to_str`来验证一个对象真的像一个字符串。
*   `to_s`当您可以构建一个描述您的对象的字符串时实现。
*   `to_str`当您的对象可以完全表现得像一个字符串时实现。

我认为你可以`to_str`自己实现的情况可能是一个`ColoredString`类——一个带有颜色的字符串。如果您似乎很清楚将彩色逗号传递给`join`不是错误并且应该导致`"1,2"`（即使该字符串不会被着色），那么*请*`to_str`在 ColoredString 上实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-27T13:15:04.737

[Zverok](https://zverok.github.io/blog/2016-01-18-implicit-vs-expicit.html)有一篇很好理解的文章，关于何时使用什么（用 to_h 和 to_hash 解释）。

实现这些方法的对象是否可以转换为字符串 -> 使用`to_s`
或者它是某种（增强的）字符串的类型 -> 使用`to_str`

* * *

我在 gem ['configuration'](https://rubygems.org/gems/configuration)（[GitHub](https://github.com/ahoward/configuration)和[Configuration.rb](https://github.com/ahoward/configuration/blob/master/lib/configuration.rb)）中看到了`to_hash`Configuration 类在实践中的有意义的用法

它代表——顾名思义——提供的配置，实际上是一种散列（具有附加功能），而不是可转换为散列。

# actionscript-3 - 如何在 AS3 中将课程应用于时间轴？

> ID：11182054
> 
> 赞同：0
> 
> 时间：2012-06-24T23:41:53.963
> 
> 标签：actionscript-3, flash, class

我现在正在用 ActionScript 3 做一个小项目。这个项目快完成了，但我想添加一个介绍框架。然后我遇到了一个问题。

我有 2 个带有代码的 .as 文件。一个叫Game，另一个叫intro。游戏是文档类。

我有 2 帧，当我开始游戏时，Game 类适用于它们。那么我如何将 Game 类应用到第 2 帧，将 Intro 类应用到第 1 帧。

代码有点长，就不上传了。这是其中的一部分。代码也可以完美运行，所以ai没有问题。

游戏.as

```
package  {
      public class Game extends MovieClip {
             public function Game () {
                      //constructor
             }
             // some other functions
       }
 } 
```

简介

```
 package  {
      public class Introextends MovieClip {
             public function Intro() {
                      //constructor
             }
             // some other functions
       }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T05:02:47.073

您不能动态更改 AS3 中的文档类，从 OOP 的角度来看，这样做也没有任何意义。你有三个选择：

1.  保持文档类不变，`Game`并在启动主代码之前`Game`加载类。`Intro`
2.  在介绍完成后，将文档类更改为`Intro`并加载到类中。`Game`
3.  创建一个新类作为“持有者”类，并将其用作文档类。`Intro`然后`Game`单独加载。

我会选择选项 3，因为它可能是最容易实现并且最有意义的。您可以将旧主时间轴中的所有帧移动到新的 MovieClip 中，然后将该 MovieClip 链接到`Game`该类。`Intro`为班级制作一个类似的影片剪辑。使用您的新类在适当的时间以编程方式创建每个新实例。

# iphone - 我可以将应用程序与 iPhone 消息应用程序集成吗？

> ID：11182056
> 
> 赞同：0
> 
> 时间：2012-06-24T23:42:41.710
> 
> 标签：iphone, ios5

是否可以与 Message 应用程序（Apple 核心应用程序）集成

例如，如果用户键入一系列字符，应用程序是否可以拦截这些键并显示选项窗口或类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T23:45:06.140

不 - 无法从 iOS 消息应用程序中捕获输入的文本。应用沙盒可以防止这种情况。

# regex - Vim reg 表达式和别名方法

> ID：11182060
> 
> 赞同：4
> 
> 时间：2012-06-24T23:43:36.313
> 
> 标签：regex, vim

我已经学习 vim 并且开始看到它有多么强大（尤其是与 reg 表达式结合使用）。现在我正在尝试用浮点值替换 python 文件中的所有整数。例如，您将遇到需要 [0.0, 0.0, 0.0] 之类的东西

我现在最好的是： :%s/\(\d+\)\@<=s*,/.0,/g 虽然我产生的结果像 0.032.0

两件事情：

1.  你们中的任何一个正则专家都可以提出一种解决上述问题的可靠方法吗？
2.  我开始看到这些表达式有多复杂。无论如何要说在我的 .vimrc 中定义一个整数或浮点数的子正则表达式，并有办法将它嵌入到以后的调用中。例如，所需的调用可能是 :%s/\($(AnInt)\)+/-/g 以将整数后的加号更改为减号。（那个或同样模块化的东西）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T00:42:52.663

假设你得到“像 0.032.0”的结果是因为你从 0.032 开始

注意，当您尝试强制正则表达式而不是其他任何东西来解析非常规语言时，就会发生这种情况。有许多这种正则表达式失败的边缘情况。我将在我经历的过程中尝试说明它们。

`:%s/\(\[.*\)\@<=\([0-9]\+\)\(,[^,]*\.[^,]*\)\@<!\.\@!\(.*\]\)\@=/\2.0/cg`

这是如何运作的？

首先，我想确保我在一个数组中。`\(\[.*\)\@<=`

这是一个寻找文字的后向断言`[`

这将在多行指定的列表上失败，并且在这种情况下也会失败（它将匹配 3 和 4）：

```
for (i,j,k) in zip([0, 0, 0], range(3), listOfLists[4]): 
```

这需要权衡复杂性。请仔细检查所有匹配项，以确保您没有做您不打算做的事情。

接下来，我要实际匹配文本，`\([0-9]\+\)`简单。

接下来，我要确保数字前后没有任何点，但忽略逗号前后的内容。 `\(,[^,]*\.[^,]*\)\@<!`

接下来，我想确保比赛之后没有文字句点。 `\.\@!`

最后，我想确保`]`在比赛之后的某个地方有一个文字（以确保我在一个数组中。`\(.*\]\)\@=`

最后但并非最不重要的是，我用第二个捕获的组替换找到的文本并添加一个句点。

至于你的#2，不，但你可以将这些区域拉到命名的粘贴缓冲区中并随意使用它们。使用命令编辑模式`q:`

# python - 在非 utf 符号上使用 MySQLdb 进行 Utf8 编码

> ID：11182062
> 
> 赞同：0
> 
> 时间：2012-06-24T23:43:59.383
> 
> 标签：python, mysql, unicode, encoding, utf-8

我收到一个 xml 提要，它的值如下：

```
<Theme>Valentine&#39;s Day</Theme>
<Copyright>&#169; Ventures. All Rights Reserved.</Copyright> 
```

我需要解析值并将其存储在 mysql 数据库中。清理值以便我可以插入的最佳方法是`"Valentie's Day"`什么`"<copyright symbol> Ventures. All Rights Reserved."`？像这样的标记大约有 20 多种。

做一个直`INSERT`，我会得到以下错误：

```
Warning: Incorrect string value: '\xA9 1987...' for column 'title' at row 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:01:26.623

如果您使用真正的 xml 解析器解析 XML，您将获得 Unicode 字符串作为文本。然后，您可以使用 UTF-8 对它们进行编码：

```
title = text.encode('utf8') 
```

和 title 将可写入您的数据库，尽管许多细节仍不清楚，因为我们不知道您是如何写入数据库的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T23:48:51.553

指定编码，然后将字符串编码为`utf8`.

```
# -*- coding: utf-8 -*-
title = text.encode('utf8') 
```

# python - django-tables2 刷新排序和页面更改

> ID：11182063
> 
> 赞同：1
> 
> 时间：2012-06-24T23:44:00.540
> 
> 标签：python, django, django-tables2

我试图用 django-tables2 创建一个排行榜表，允许用户按所有列排序、搜索和过滤。我没有做任何特别的事情，只是按照 django-tables2 的文档进行操作。

这是它在模型中的样子：

```
class LeaderboardTable(tables.Table):
    rank = tables.TemplateColumn('{{ record.rank }}')
    name = tables.TemplateColumn('{{ record.user__first_name }} {{ record.user__last_name }}')
    team = tables.TemplateColumn('{{ record.team }}')
    points = tables.TemplateColumn('{{ record.points }}') 
```

这是视图中的样子：

```
def get_leaderboard(request):
    table = LeaderboardTable(Profiles.objects.select_related().all())
    RequestConfig(request).configure(table)
    return render(request, 'leaderboard.html', {'table': table}) 
```

如果您查看上面的代码，您可能会注意到名称列不正确，因为我还没有想出如果我结合到查询集中的字段时如何排序 - 如果您也能回答这个问题，那就太好了。

我喜欢 django-tables2 处理表格的创建和分页；但是，每次我点击排序/下一页或上一页时，都会导致页面刷新。有没有办法抑制这种情况？另外，我不知道是不是因为我要返回 10,000 条记录，但是 django-tables2 在排序和分页方面似乎很慢。

我为此使用了正确的应用程序吗？你们认为我应该使用其他东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T21:36:34.220

django-tables2**不**支持在不刷新页面的情况下使用 JavaScript 进行排序/分页（此时）。

返回 10k 记录应该没有问题。我建议您使用[django-debug-toolbar 之](http://pypi.python.org/pypi/django-debug-toolbar)类的东西来查看哪些查询执行速度很慢（例如，您的`select_related()`调用可能不起作用）。

您可以将表重写为：

```
class LeaderboardTable(tables.Table):
    rank = tables.Column()
    name = tables.Column(order_by=("first_name", "last_name"))
    team = tables.Column()
    points = tables.Column()

    def render_name(self, record):
        return u"%s %s" % (record.user.first_name, record.user.last_name) 
```

检查 using 是否可以`render_name`解决您的性能问题。它应该比 using 更快`TemplateColumn`，但只有在表格的每一页中呈现大量行时，这才有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-30T16:57:23.577

对于要放入表中的如此数量的项目并能够在不刷新整个页面的情况下对表进行排序，我建议您使用[SlickGrid](https://github.com/mleibman/SlickGrid)，它是一个将 json 数据作为输入的 javascript 库。

只需将您的查询集转储到 json var 中并将其传递给您的模板。

# wso2 - 聚合调解器 wso2 未按预期工作

> ID：11182069
> 
> 赞同：1
> 
> 时间：2012-06-24T23:44:31.867
> 
> 标签：wso2, wso2esb

我有一个用例，我需要使用迭代器调解器发送多个调用并使用聚合调解器来聚合响应。当聚合调解器完成其中一个响应是我期望的部分时，其他响应将附加到正文的末尾。

我创建了以下代理来演示问题（添加了很多日志信息，以便逻辑应该易于理解）：

```
<?xml version="1.0" encoding="UTF-8"?>
<proxy xmlns="http://ws.apache.org/ns/synapse" name="GbTestServiceProxy" transports="https http" startOnLoad="true" trace="disable">
    <target endpoint="GbTestServiceEP">
        <inSequence>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** inSequence::START ****    " />
            </log>
            <log level="full">
                <property name="    **** GbTestServiceProxy ****    " value="    **** inSequence::messageIn ****    " />
            </log>
            <enrich>
                <source xmlns:gb="http://www.logius.nl/digikoppeling/gb/2010/10" clone="true" xpath="//gb:digikoppeling-external-data-references"/>
                <target type="property" property="DIGI-EXT-DATA-REF"/>
            </enrich>
            <enrich>
                <source type="body" clone="true"/>
                <target type="property" property="ORIG_BODY"/>
            </enrich>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** inSequence::DigikoppelingExternalDataReference ****    " />
                <property name="DIGI-EXT-DATA-REF" expression="get-property('DIGI-EXT-DATA-REF')" />
            </log>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** inSequence::originalSoapBody ****    " />
                <property name="ORIG_BODY" expression="get-property('ORIG_BODY')" />
            </log>
            <property name="gb_iterate_cnt" value="0"/>
            <property name="gb_aggregate_cnt" value="0"/>
            <iterate xmlns:gb="http://www.logius.nl/digikoppeling/gb/2010/10" preservePayload="true" attachPath="//gb:digikoppeling-external-data-references" expression="//gb:digikoppeling-external-data-references/gb:data-reference">
                <target>
                    <sequence>
                        <xslt key="conf:/xslt/retrieve_gb_data_reference.xslt"/>
                        <property name="gb_iterate_cnt" expression="number(get-property('gb_iterate_cnt')) + 1"/>
                        <log level="full">
                            <property name="    **** GbTestServiceProxy ****    " value="    **** inSequence::iterateDataReference ****    "/>
                            <property name="gb_iterate_cnt" expression="get-property('gb_iterate_cnt')"/>
                        </log>
                        <send>
                            <endpoint>
                                <address uri="http://192.168.56.100:8280/services/GbHandlerStubProxy"/>
                            </endpoint>
                        </send>
                    </sequence>
                </target>
            </iterate>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** inSequence::START ****    " />
            </log>
        </inSequence>
        <outSequence>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::START ****    " />
            </log>
            <log level="full">
                <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::messageIn ****    " />
            </log>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::checkIterateCount ****    "/>
                <property name="gb_iterate_cnt" expression="get-property('gb_iterate_cnt')"/>
            </log>
            <property name="gb_aggregate_cnt" expression="number(get-property('gb_aggregate_cnt'))+1"/>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::checkAggregateCount ****    "/>
                <property name="gb_aggregate_cnt" expression="get-property('gb_aggregate_cnt')"/>
            </log>
            <aggregate>
                <completeCondition timeout="5000">
                    <messageCount min="3" max="3"/>
                </completeCondition>
                <onComplete xmlns:poc="http://minienm.nl/wso2/wus/2.0/testgb/1.0/" expression="//poc:data-reference-local">
                    <log level="custom">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::checkAggregateCount ****    "/>
                        <property name="gb_aggregate_cnt" expression="get-property('gb_aggregate_cnt')"/>
                    </log>
                    <log level="full">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::resultAggregate ****    " />
                    </log>
                    <log level="custom">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::enrich#1-storeAggregateResult ****    "/>
                    </log>
                    <enrich>
                        <source type="body" clone="false"/>
                        <target type="property" property="RESULT_AGGREGATE"/>
                    </enrich>
                    <log level="custom">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::originalResultAggregate ****    " />
                        <property name="RESULT_AGGREGATE" expression="get-property('RESULT_AGGREGATE')" />
                    </log>
                    <log level="custom">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::enrich#2-replaceAggregateResultWithOriginalBody ****    "/>
                    </log>
                    <enrich>
                        <source type="property" clone="false" property="ORIG_BODY"/>
                        <target type="body"/>
                    </enrich>
                    <log level="custom">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::enrich#3-addHolderForAggregateResultToBody ****    "/>
                    </log>
                    <enrich>
                        <source type="inline" clone="false">
                            <poc:internal-data-references xmlns:poc="http://minienm.nl/wso2/wus/2.0/testgb/1.0/"/>
                        </source>
                        <target xmlns:gb="http://www.logius.nl/digikoppeling/gb/2010/10" action="sibling" xpath="//gb:digikoppeling-external-data-references"/>
                    </enrich>
                    <log level="custom">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::enrich#4-addAggregateResultToHolder ****    "/>
                    </log>
                    <enrich>
                        <source type="property" clone="false" property="RESULT_AGGREGATE"/>
                        <target xmlns:poc="http://minienm.nl/wso2/wus/2.0/testgb/1.0/" action="child" xpath="//poc:internal-data-references"/>
                    </enrich>
                    <log level="full">
                        <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::send ****    "/>
                    </log>
                    <send />
                </onComplete>
            </aggregate>
            <log level="custom">
                <property name="    **** GbTestServiceProxy ****    " value="    **** outSequence::END ****    " />
            </log>
        </outSequence>
    </target>
    <publishWSDL uri="http://192.168.56.100:8280/services/TestGb_WUS_2.0_v1.0?wsdl"/>
</proxy>

<proxy xmlns="http://ws.apache.org/ns/synapse" name="GbHandlerStubProxy" transports="https,http" statistics="disable" trace="disable" startOnLoad="true">
    <target>
        <inSequence>
            <log level="custom">
                <property name="    **** GbHandlerStubProxy ****    " value="    START    " />
            </log>
            <xslt key="conf:/xslt/create_response_stub_gb_handler.xslt">
                <property name="localDirectory" value="/this/is/a/local/directory/" />
            </xslt>
            <header name="To" action="remove" />
            <property name="RESPONSE" value="true" scope="default" type="STRING" />
            <log level="custom">
                <property name="    **** GbHandlerStubProxy ****    " value="    END    " />
            </log>
            <send />
        </inSequence>
    </target>
</proxy> 
```

这是一条测试消息：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://minienm.nl/wso2/wus/2.0/testgb/1.0/" xmlns:ns1="http://www.logius.nl/digikoppeling/gb/2010/10">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:aanleverBericht>
         <!--Optional:-->
         <ns:kenmerk>kenmerk</ns:kenmerk>
         <ns:berichtsoort>berichtsoort</ns:berichtsoort>
         <!--Optional:-->
         <ns:aanleverkenmerk>aanleverkenmerk</ns:aanleverkenmerk>
         <!--Optional:-->
         <ns:eerderAanleverkenmerk>eerderAanleverkenmerk</ns:eerderAanleverkenmerk>
         <ns:identiteitBelanghebbende>
            <ns:nummer>nummer</ns:nummer>
            <!--Optional:-->
            <ns:type>KvK</ns:type>
         </ns:identiteitBelanghebbende>
         <ns:rolBelanghebbende>rolBelanghebbende</ns:rolBelanghebbende>
         <!--Optional:-->
         <ns:identiteitOntvanger>
            <ns:nummer>nummer</ns:nummer>
            <!--Optional:-->
            <ns:type>OIN</ns:type>
         </ns:identiteitOntvanger>
         <!--Optional:-->
         <ns:rolOntvanger>rolOntvanger</ns:rolOntvanger>
         <ns:berichtInhoud>
            <ns:mimeType>mimeType</ns:mimeType>
            <ns:bestandsnaam>bestandsnaam</ns:bestandsnaam>
            <ns:inhoud>VGhpcyBpcyBhIHRlc3QgYmFzZTY0IGVuY29kZWQgc3RyaW5n</ns:inhoud>
         </ns:berichtInhoud>
         <!--Optional:-->
         <ns:berichtBijlagen>
            <!--1 or more repetitions:-->
            <ns:bijlage>
               <ns:mimeType>mimeType</ns:mimeType>
               <ns:bestandsnaam>bestandsnaam</ns:bestandsnaam>
               <ns:inhoud>VGhpcyBpcyBhIHRlc3QgYmFzZTY0IGVuY29kZWQgc3RyaW5n</ns:inhoud>
            </ns:bijlage>
         </ns:berichtBijlagen>
         <!--Optional:-->
         <ns:autorisatieAdres>autorisatieAdres</ns:autorisatieAdres>
         <!--Optional:-->
         <ns1:digikoppeling-external-data-references profile="digikoppeling-gb-1.0">
            <!--1 or more repetitions:-->
            <ns1:data-reference contextId="contextId-1">
               <ns1:lifetime>
                  <!--Optional:-->
                  <ns1:creationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:creationTime>
                  <!--Optional:-->
                  <ns1:expirationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:expirationTime>
               </ns1:lifetime>
               <ns1:content contentType="contentType">
                  <ns1:filename>filename</ns1:filename>
                  <ns1:checksum type="MD5">0123456789abcdef0123456789abcdef</ns1:checksum>
                  <ns1:size>1000</ns1:size>
               </ns1:content>
               <ns1:transport>
                  <ns1:location>
                     <!--You have a CHOICE of the next 2 items at this level-->
                     <ns1:senderUrl type="xs:anyURI">>https://any.url/any.name.sender</ns1:senderUrl>
                  </ns1:location>
               </ns1:transport>
            </ns1:data-reference>
            <ns1:data-reference contextId="contextId-2">
               <ns1:lifetime>
                  <!--Optional:-->
                  <ns1:creationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:creationTime>
                  <!--Optional:-->
                  <ns1:expirationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:expirationTime>
               </ns1:lifetime>
               <ns1:content contentType="contentType">
                  <ns1:filename>filename</ns1:filename>
                  <ns1:checksum type="MD5">0123456789abcdef0123456789abcdef</ns1:checksum>
                  <ns1:size>1000</ns1:size>
               </ns1:content>
               <ns1:transport>
                  <ns1:location>
                     <!--You have a CHOICE of the next 2 items at this level-->
                     <ns1:senderUrl type="xs:anyURI">>https://any.url/any.name.sender</ns1:senderUrl>
                  </ns1:location>
               </ns1:transport>
            </ns1:data-reference>
            <ns1:data-reference contextId="contextId-3">
               <ns1:lifetime>
                  <!--Optional:-->
                  <ns1:creationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:creationTime>
                  <!--Optional:-->
                  <ns1:expirationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:expirationTime>
               </ns1:lifetime>
               <ns1:content contentType="contentType">
                  <ns1:filename>filename</ns1:filename>
                  <ns1:checksum type="MD5">0123456789abcdef0123456789abcdef</ns1:checksum>
                  <ns1:size>1000</ns1:size>
               </ns1:content>
               <ns1:transport>
                  <ns1:location>
                     <!--You have a CHOICE of the next 2 items at this level-->
                     <ns1:senderUrl type="xs:anyURI">>https://any.url/any.name.sender</ns1:senderUrl>
                  </ns1:location>
               </ns1:transport>
            </ns1:data-reference>
         </ns1:digikoppeling-external-data-references>
      </ns:aanleverBericht>
   </soapenv:Body>
</soapenv:Envelope> 
```

这是结果：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
   <soapenv:Header xmlns:wsa="http://www.w3.org/2005/08/addressing">
      <wsa:MessageID>urn:uuid:63df7b91-b96b-4894-9f02-dd00145e4493</wsa:MessageID>
      <wsa:Action>//www.minienm.nl/TestGb_WUS_2.0_v1.0/TestGb_WUS_2.0_v1.0/submitDocumentResponse</wsa:Action>
      <wsa:RelatesTo>urn:uuid:4ab77dc5-96ac-41d7-8e74-0b444a6cf7e5</wsa:RelatesTo>
   </soapenv:Header>
   <soapenv:Body>
      <ns:aanleverBericht xmlns:ns="http://minienm.nl/wso2/wus/2.0/testgb/1.0/">
         <!--Optional:-->
         <ns:kenmerk>kenmerk</ns:kenmerk>
         <ns:berichtsoort>berichtsoort</ns:berichtsoort>
         <!--Optional:-->
         <ns:aanleverkenmerk>aanleverkenmerk</ns:aanleverkenmerk>
         <!--Optional:-->
         <ns:eerderAanleverkenmerk>eerderAanleverkenmerk</ns:eerderAanleverkenmerk>
         <ns:identiteitBelanghebbende>
            <ns:nummer>nummer</ns:nummer>
            <!--Optional:-->
            <ns:type>KvK</ns:type>
         </ns:identiteitBelanghebbende>
         <ns:rolBelanghebbende>rolBelanghebbende</ns:rolBelanghebbende>
         <!--Optional:-->
         <ns:identiteitOntvanger>
            <ns:nummer>nummer</ns:nummer>
            <!--Optional:-->
            <ns:type>OIN</ns:type>
         </ns:identiteitOntvanger>
         <!--Optional:-->
         <ns:rolOntvanger>rolOntvanger</ns:rolOntvanger>
         <ns:berichtInhoud>
            <ns:mimeType>mimeType</ns:mimeType>
            <ns:bestandsnaam>bestandsnaam</ns:bestandsnaam>
            <ns:inhoud>VGhpcyBpcyBhIHRlc3QgYmFzZTY0IGVuY29kZWQgc3RyaW5n</ns:inhoud>
         </ns:berichtInhoud>
         <!--Optional:-->
         <ns:berichtBijlagen>
            <!--1 or more repetitions:-->
            <ns:bijlage>
               <ns:mimeType>mimeType</ns:mimeType>
               <ns:bestandsnaam>bestandsnaam</ns:bestandsnaam>
               <ns:inhoud>VGhpcyBpcyBhIHRlc3QgYmFzZTY0IGVuY29kZWQgc3RyaW5n</ns:inhoud>
            </ns:bijlage>
         </ns:berichtBijlagen>
         <!--Optional:-->
         <ns:autorisatieAdres>autorisatieAdres</ns:autorisatieAdres>
         <!--Optional:-->
         <ns1:digikoppeling-external-data-references profile="digikoppeling-gb-1.0" xmlns:ns1="http://www.logius.nl/digikoppeling/gb/2010/10">
            <!--1 or more repetitions:-->
            <ns1:data-reference contextId="contextId-1">
               <ns1:lifetime>
                  <!--Optional:-->
                  <ns1:creationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:creationTime>
                  <!--Optional:-->
                  <ns1:expirationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:expirationTime>
               </ns1:lifetime>
               <ns1:content contentType="contentType">
                  <ns1:filename>filename</ns1:filename>
                  <ns1:checksum type="MD5">0123456789abcdef0123456789abcdef</ns1:checksum>
                  <ns1:size>1000</ns1:size>
               </ns1:content>
               <ns1:transport>
                  <ns1:location>
                     <!--You have a CHOICE of the next 2 items at this level-->
                     <ns1:senderUrl type="xs:anyURI">>https://any.url/any.name.sender</ns1:senderUrl>
                  </ns1:location>
               </ns1:transport>
            </ns1:data-reference>
            <ns1:data-reference contextId="contextId-2">
               <ns1:lifetime>
                  <!--Optional:-->
                  <ns1:creationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:creationTime>
                  <!--Optional:-->
                  <ns1:expirationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:expirationTime>
               </ns1:lifetime>
               <ns1:content contentType="contentType">
                  <ns1:filename>filename</ns1:filename>
                  <ns1:checksum type="MD5">0123456789abcdef0123456789abcdef</ns1:checksum>
                  <ns1:size>1000</ns1:size>
               </ns1:content>
               <ns1:transport>
                  <ns1:location>
                     <!--You have a CHOICE of the next 2 items at this level-->
                     <ns1:senderUrl type="xs:anyURI">>https://any.url/any.name.sender</ns1:senderUrl>
                  </ns1:location>
               </ns1:transport>
            </ns1:data-reference>
            <ns1:data-reference contextId="contextId-3">
               <ns1:lifetime>
                  <!--Optional:-->
                  <ns1:creationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:creationTime>
                  <!--Optional:-->
                  <ns1:expirationTime type="xs:dateTime">2001-12-31T12:00:00Z</ns1:expirationTime>
               </ns1:lifetime>
               <ns1:content contentType="contentType">
                  <ns1:filename>filename</ns1:filename>
                  <ns1:checksum type="MD5">0123456789abcdef0123456789abcdef</ns1:checksum>
                  <ns1:size>1000</ns1:size>
               </ns1:content>
               <ns1:transport>
                  <ns1:location>
                     <!--You have a CHOICE of the next 2 items at this level-->
                     <ns1:senderUrl type="xs:anyURI">>https://any.url/any.name.sender</ns1:senderUrl>
                  </ns1:location>
               </ns1:transport>
            </ns1:data-reference>
         </ns1:digikoppeling-external-data-references>
         <poc:internal-data-references xmlns:poc="http://minienm.nl/wso2/wus/2.0/testgb/1.0/">
            <poc:data-reference-local contextId="contextId-1" xmlns:gb="http://www.logius.nl/digikoppeling/gb/2010/10">
               <poc:location>/this/is/a/local/directory/filename</poc:location>
            </poc:data-reference-local>
         </poc:internal-data-references>
      </ns:aanleverBericht>
      <poc:data-reference-local contextId="contextId-2" xmlns:poc="http://minienm.nl/wso2/wus/2.0/testgb/1.0/" xmlns:gb="http://www.logius.nl/digikoppeling/gb/2010/10">
         <poc:location>/this/is/a/local/directory/filename</poc:location>
      </poc:data-reference-local>
      <poc:data-reference-local contextId="contextId-3" xmlns:poc="http://minienm.nl/wso2/wus/2.0/testgb/1.0/" xmlns:gb="http://www.logius.nl/digikoppeling/gb/2010/10">
         <poc:location>/this/is/a/local/directory/filename</poc:location>
      </poc:data-reference-local>
   </soapenv:Body>
</soapenv:Envelope> 
```

如您所见，最后两个 poc:data-reference-local 条目附加到正文的末尾。任何想法我做错了什么？

我看到的另一件奇怪的事情是，聚合中介 (outSequence::resultAggregate) 的第二个日志条目按预期显示了所有三个结果。但是，日志条目 originalResultAggregate 仅显示第一个。这与我遇到的奇怪行为有关吗？

编辑：我注意到的另一件事是我添加的计数器功能不起作用（请参阅属性 gb_iterate_cnt 和 gb_aggregate_cnt）。我究竟做错了什么？

问候，尼德基尔

# php - 简单的 Html DOM 获取 xpath

> ID：11182070
> 
> 赞同：0
> 
> 时间：2012-06-24T23:44:36.373
> 
> 标签：php, html, web-scraping, fetch

我是获取的新手，在代码中它说`div[class="movies]/div/a` 我试图在 div 之后使用 /a 获取所有标签，它只获取一个，请帮助我了解如何获取所有标签。

谢谢

```
<?php
include_once('../../simple_html_dom.php');

function scraping_IMDB($url) {
    // create HTML DOM
    $html = file_get_html($url);

    // get title/
    $ret['Title'] = $html->find('**div[class="movies]/div/a**', 0)->innertext;

    // get rating
    $ret['Rating'] = $html->find('div[class="DataWhite"] b', 0)->innertext;

    // get overview
    foreach($html->find('div[class="DataWhite"]') as $div) {
        // skip user comments
        if($div->find('h5', 0)->innertext=='User Comments:')
            return $ret;

        $key = '';
        $val = '';

        foreach($div->find('*') as $node) {
            if ($node->tag=='h5')
                $key = $node->plaintext;
            if ($node->tag=='a' && $node->plaintext!='more')
                $val .= trim(str_replace("\n", '', $node->plaintext));

            if ($node->tag=='text')
                $val .= trim(str_replace("\n", '', $node->plaintext));
        }

        $ret[$key] = $val;
    }

    // clean up memory
    $html->clear();
    unset($html);

    return $ret;
}

// -----------------------------------------------------------------------------
// test it!
$ret = scraping_IMDB('http://www.tastekid.com/like/The+Help/movies');

foreach($ret as $k=>$v)
    echo '<strong>'.$k.' </strong>'.$v.'<br>';
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:45:15.683

我不是 100% 清楚代码应该是什么，但问题在于“0”。

```
// get title/
$ret['Title'] = $html->find('**div[class="movies]/div/a**', 0)->innertext; 
```

至

```
// get title/
$ret['Title'] = $html->find('**div[class="movies]/div/a**')->innertext; 
```

这将找到*所有*具有“电影”类的 div。因为当你有“，0”时，它只会找到第一个。然后，您将需要迭代此输出，就像使用 DataWhite 类对象完成的一样。

# scala - 使用解析器组合器丢弃剩余的输入

> ID：11182072
> 
> 赞同：1
> 
> 时间：2012-06-24T23:45:00.730
> 
> 标签：scala, parser-combinators

我只想解析以下字符串，直到`END`令牌然后忽略其余部分：

```
val input = """
0)
blah1
blah2
blah3
1)
blah4
blah5
END
blah6
""" 
```

使用

```
object Pars extends RegexParsers {
  def strings: Parser[List[String]] = rep(str) <~ end
  def str:     Parser[String]       = ".*".r
  def end:     Parser[String]       = "END" <~ rep(".*".r)
}

Pars.parseAll(Pars.strings, input) 
```

进入无限循环和 OutOfMemoryError。我做错了什么，如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T00:17:19.380

只是不要使用`parseAll`. 改为使用`parse`。

至于你遇到的问题，你在几个地方说了两次同样的事情：

```
rep(".*".r) 
```

`rep`两者`*`都表示“任意次数的重复”。现在，`.*`匹配空字符串，`rep`然后继续匹配无限数量的空字符串。

这是我重写它的方法：

```
object Pars extends RegexParsers {
  def strings: Parser[List[String]] = 
    ( "END" ^^^ Nil 
    | ".+".r ~ strings ^^ { case head ~ tail => head :: tail }
    )
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:47:45.183

```
object Pars extends RegexParsers { 
  def strings: Parser[List[String]] = rep(str) <~ "END"
  def str:     Parser[String]       = """.*\r?\n""".r ^? { 
    case s if !(s matches """END\r?\n""") => s.replaceAll("""[\r\n]""", "")
  }
}

Pars.parse(Pars.strings, input) // note parse, not parseAll
  //[9.4] parsed: List(0), blah1, blah2, blah3, 1), blah4, blah5) 
```

关键似乎是你不能只匹配`.*`- 你必须匹配`.*\r?\n`才能获得一行文本（`\r`Windows格式文件需要）。我也尝试`^.*$`了我认为可行的方法，但没有。也没有`".*" <~ """\r?\n""".r`。

（`^?`类似于，`^^`除了它需要一个偏函数。）

如果有人可以使它更优雅，请告诉我！

# c++ - 将 .txt 文件中的字符串转换为 Vector

> ID：11182081
> 
> 赞同：-2
> 
> 时间：2012-06-24T23:46:48.980
> 
> 标签：c++

我正在尝试编写将字符串存储在向量中的程序，然后将它们添加到 .txt 文件中，然后如果我想用保存在 .txt 文件中的字符串填充向量并让我打印出来.

但是当我尝试这样做时，它说向量没有被填充，ifstream 和 >> 不适用于将字符串加载到向量中。

```
int main()
{
    vector<string> champ_list;
    vector<string> fri_list;
    string champ_name;
    string list_name;
    string champ_again;
    cout <<"Pleas enter in the name of the list for your Random pick\n"; 
    cin>>list_name;

    do
    {
        cout <<"Please enter in the name of the champion you would like to add to the list\n";
        cin>>champ_name;
        champ_list.push_back(champ_name);
        cout <<"Would you like to add another name to the list y/n\n";
        cin>>champ_again;
    } while(champ_again == "y");
    cout <<"1\n";

    ofstream mid_save("mid.txt");
    mid_save<<champ_list[0]<<"\n";
    cout <<"2\n";

    // This is where the program crashes 
    ifstream mid_print("mid.txt");
    mid_print>>fri_list[0];
    cout<<"3\n";

    cout <<fri_list[0];
    cin>>list_name;

    return 0;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:37:52.130

我怀疑您想在重新打开“mid.txt”文件以供阅读之前关闭它。您绝对应该测试文件流的状态，以确保它们成功打开。例如：

```
ofstream mid_save("mid.txt");
if (!mid_save) {
    std::cerr << "can't open mid_save\n";
    return 1;
}
mid_save<<champ_list[0]<<"\n";
cout <<"2\n";
mid_save.close(); // Close the file before reopening it for input

ifstream mid_print("mid.txt");
if (!mid_print) {
    std::cerr << "can't open mid_print\n";
    return 1;
}
mid_print>>fri_list[0];
cout<<"3\n"; 
```

# android - 困惑从 Android 生命周期中使用哪些方法来保存我的应用程序状态

> ID：11182082
> 
> 赞同：3
> 
> 时间：2012-06-24T23:46:52.973
> 
> 标签：android, android-lifecycle

我的应用程序有两种布局 A 和 B。

在 A 中，用户通过按 RADIO BUTTONS 选择一些数据。然后他按下一个 BUTTON 进入 B 布局并使用这个选定的变量来动态构建一些视图（EditTexts、TextVies 和 Buttons）。

在布局 A 中，我实现了 onDestroy()（如果我实现 onStop()，也会发生同样的事情）来保存用户选择的数据。如果我通过返回或按下主页并从任务管理器中删除它来退出应用程序，如果用户再次启动应用程序，用户选择的数据仍将可见。

现在，在布局 B 中，首先我根据布局 A 的用户选择数据构建视图的第一部分，然后我还有额外的按钮，允许用户根据需要向该布局添加和删除尽可能多的视图。

现在我的困惑来了............在用户填写布局B中需要的任何内容后，然后返回A，或退出应用程序，我想保存在布局 B 中输入的数据。我知道如何使用 SharedPreferences 保存数据，但我不知道我需要为布局 B 实施哪些方法，甚至可能还需要为 A 实施哪些方法来完成我的任务。

这正是我想要发生的......我想要的是能够使用用户为布局 B 填充的数据启动应用程序。布局 A 似乎正在工作。如果用户在布局 A 中选择相同的数据（意味着保持一切原样），只有这样我才想使用保存的数据，否则我想用用户的新选择重新启动新的布局 B。

还有一个问题。如果用户从 B 返回布局 A，因为所有内容都已保存在布局 A 中，他可以按下按钮并返回布局 B（可能想要更改他/她选择的值或只是不小心按下了返回按钮）。我也为布局 B 实现了 onDestroy()，但我遇到了问题。如果用户没有更改布局 A 中的选择并再次进入布局 B，我保存的所有内容现在都将重建，但如果他/她返回 A 并再次来到 B，则它不存在，每次都会发生这种情况...如果我来回走动，我只会在奇数情况下看到保存的数据，在偶数情况下它不存在。

在布局 B 中，我将所有内容保存在 onDestroy() 中，然后在 onCreate() 中检查布局 A 的数据是否相同，以便我可以再次重建布局 B；否则，布局 B 将是新的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:40:15.560

而不是使用`onDestroy()/onCreate()`你最好使用`onPause()/onResume()`，因为这些**总是**被调用，但是对 onDestroy() 的调用可能会在这里和那里错过。

您需要`onPause()`在您的活动 A 和 B中实施。

一旦您弄清楚如何可靠地将您的首选项保存在 中`onPause()`，您可以根据您的应用程序逻辑在不需要时丢弃已保存的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T00:09:13.667

onDestroy 对于序列化数据来说太迟了。您不知道 Activity 何时被销毁。

反正。您必须以某种方式调用 Activity B。为什么不直接将这些值作为 Intent 的附加值传递？

# javascript - 显示微调器，直到 iframe 加载一个 http post 响应

> ID：11182083
> 
> 赞同：5
> 
> 时间：2012-06-24T23:47:03.230
> 
> 标签：javascript, jquery, iframe

我有两个网站 A.com 和 B.com。我必须将 B.com 嵌入到 A.com 的 iframe 中。我无法在 B.com 上进行任何更改

B.com 仅适用于带有一些帖子数据的帖子请求。我有这个工作如下

```
<!--This is the div inside which I will embedd the iframe-->
<div id="frameDiv"></div>

<script type="text/javascript">

    //Create iframe
    var $ifr = $('<iframe name="myFrame" id="myFrame"></iframe>');

    //create form
    var $form = $('<form action="B.com" method="post" target="myFrame"></form>');

    //Append hidden field to form to pass postData
    $form.append($('<input type="hidden" name="dataName"><input>').val('data'));

    //Append form to the iframe and then append iframe to the div    
    $('#frameDiv').append($ifr.append($form));

    $form.submit();
</script> 
```

现在，B.com 在 iframe 中完美加载并响应发布请求。但是 B.com 很慢。我想在 #frameDiv 中显示一个微调器，直到 iframe 加载。我怎样才能做到这一点？

这是我尝试过的：

```
$('#frameDiv').append($spinnerImage)

//Does not work, fires immediately
$ifr.load(function(){
    //Hide the spinner image
});

//Does not work, fires immediately
$ifr.ready(function(){
    //Hide the spinner image
}); 
```

如果 B.Com 是一个简单的 get 并被设置为 iframe 的 src 属性，jQuery load 方法就可以了。但在这种情况下，它没有。

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-25T02:11:20.307

@charlietfl 的答案是正确的并且有效。我只是想分享另一种我发现也有效的方法。

只需将 iframe 的背景设置为微调器 :)

```
#myFrame
{
    background-image: url('/content/images/spinner.gif');   
    background-repeat: no-repeat;
} 
```

当 B.com 加载时，新文档会隐藏微调器。

知道首选哪种方法吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-25T00:15:19.283

您可以尝试在 iframe 的初始加载事件处理程序中绑定新的加载事件侦听器。以下适用于同一域 iFrame：

```
$ifr.load(function(){
    /* bind new load event listener for next load*/
    $(this).load(function(){
         /* hide spinner*/
    })
}); 
```

# javascript - chrome 扩展 popup.js 中的 setTimeout 函数问题

> ID：11182087
> 
> 赞同：2
> 
> 时间：2012-06-24T23:48:11.100
> 
> 标签：javascript, google-chrome-extension, settimeout

我有一个包含一系列函数的 popup.js 文件。我正在尝试运行一个设置为在创建新选项卡时运行的函数，但延迟时间很短。这是一个函数示例和我尝试过的解决方案。

```
// function.
function foo_bar()
{
 // some ajax call.
}

// try 1
setTimeout(foo_bar,1000);
EDIT:// executed without delay.

// try 2
setTimeout(function(){
//some ajax call.
},1000)
EDIT:// executed without delay.

// try 3
setTimeout(function(){
foo_bar();
},1000)
EDIT: // didn't seem to execute.

// try 4 and 5
window.addEventListener('load',foo_bar());
window.addEventListener('DOMContentLoaded',foo_bar());
// no delay takes place. The function completes before the page even loads.

// try 6
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {...}); 
// used the status from here to wait till page load is complete.
//problem with this is that sometimes the status doesn't get updated.

// try 7
// tried to delay the php script by using sleep(2), but ajax call would never complete. 
```

有人可以帮忙吗？不确定它是否有帮助，但脚本未定义为背景或内容。

编辑：更多细节。调用的函数是执行对远程服务器的 ajax 调用，然后根据数据，使用 chrome.tabs.executeScript 操作新选项卡所在的页面。唯一的问题是，页面有一半时间还没有准备好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:07:02.200

尝试 4 和 5 应该是：

```
window.addEventListener('load',foo_bar);
window.addEventListener('DOMContentLoaded',foo_bar); 
```

没有延迟，因为您将它们称为内联。

# c++ - 指向成员的指针作为模板参数推导

> ID：11182088
> 
> 赞同：3
> 
> 时间：2012-06-24T23:48:22.540
> 
> 标签：c++, class, templates, parameters, pointer-to-member

我想将指向成员的指针作为 foo1 的模板参数。这是代码：

```
struct baz{
    int qux;
};

template<typename C, typename T, T C::*m>
struct foo1{};

template<typename C, typename T>
void barr2(T C::*m){
}

template<typename C, typename T>
void barr1(T C::*m){
    barr2(m); // ok
    foo1<C, T, &baz::qux> _; // ok
    foo1<C, T, m> f; // g++4.6.1 error here; how to pass 'm' correctly ?
}

int main(){
    barr1(&baz::qux);
} 
```

那么它应该是什么样子呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-24T23:55:59.510

它对您不起作用，因为您试图在编译时表达式中使用运行时信息。这与使用从控制台读取的整数来专门化模板相同。它并不意味着工作。

它不一定能解决你的问题，但如果`barr1`函数的目的是减轻打字负担，这样的事情可能对你有用：

```
struct baz{
    int qux;
};

template<typename C, typename T, T C::*m>
struct foo1 {};

#define FOO(Class, Member)                                  \
    foo1<Class, decltype(Class::Member), &Class::Member>

int main(){
    FOO(baz, qux) f;
} 
```

# linux - antiword 在托管服务器上不起作用

> ID：11182095
> 
> 赞同：2
> 
> 时间：2012-06-24T23:50:10.727
> 
> 标签：linux, directory, redhat

我想这可能是一个愚蠢的问题，但它花了我几个小时。

在 Redhat Linux 服务器上，我编写了一个网页，试图将同一台服务器上的软件称为“antiword”。

antiword 位于 /home/myusername/bin，需要目录 /home/myusername/.antiword 才能运行。

当我在浏览器中运行我的网页时，它搜索 /.antiword 而不是 /home/myusername/.antiword

所以它说找不到目录。

我该如何解决这个问题？

## 一件事要澄清

antiword 是程序名称。无论您在哪里调用它，它都会在同一位置“/home/myusername/.antiword”搜索目录“.antiword”

顺便说一句，我没有 root 帐户，所以“ln”不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-14T17:53:59.837

我有同样的问题。希望这对其他人有用，因为`antiword`它是非常有用的软件。

`antiword`出于某种原因不喜欢托管 Web 服务器（此处概述：http: [//foswiki.org/Support/Question638](http://foswiki.org/Support/Question638)）。`node`我在将在本地 QA 机器上运行良好的服务器部署到云中的生产服务器时遇到了这种情况。因此，我的解决方案涉及`node`.

这在生产中不起作用：

```
var exec = require('child_process').exec;

exec('antiword /some/word.doc', function(err, stdout, stderr) {
    console.log(stderr);
  }); 
```

你应该看到

```
I can't find the name of your HOME directory 
```

或类似的东西。提供的[链接](http://foswiki.org/Support/Question638)揭示了原因。为了解决这个问题，我设置了`$ANTIWORDHOME`环境变量（根据[文档](http://manpages.ubuntu.com/manpages/gutsy/man1/antiword.1.html)）：

```
var exec = require('child_process').exec;

var environment = process.env;
environment.ANTIWORDHOME = '/usr/share/antiword';

exec(command, {env:environment}, function(err, stdout, stderr) {
    console.log(stdout);
  }); 
```

现在，如果一切都是正确的，您将看到由`antiword`错误产生的结果，而不是让我陷入困境的错误。

# html - 并排自动定位 div

> ID：11182097
> 
> 赞同：0
> 
> 时间：2012-06-24T23:50:29.417
> 
> 标签：html, css

我有一些自动生成的 HTML 代码。

当我`float:left;`在共享类上添加一个时，它看起来像这样：

```
+----------------+   +--------------+
|   div 1        |   |   div 2      |
|                |   |              |
|                |   +--------------+
|                |                  
|                |   +--------------+
|                |   |   div 3      |
+----------------+   +--------------+ 
```

我想要的是这样的：

```
+----------------+   +--------------+
|   div 1        |   |   div 2      |
|                |   |              |
|                |   +--------------+
|                |                  
|                |   
|                |   
+----------------+   

+--------------+
|   div 3      |
+--------------+ 
```

我怎样才能得到这个结果？

我的 CSS 代码如下所示：

```
position: relative;
width: 40%;
float: left;
border: 1px solid black;
clear: left; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-24T23:55:59.443

只需添加`clear: left;`到 div 3

**编辑：**只需使用`:nth-child(2n+1)`or `:nth-of-type(2n+1)`css3 选择器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T00:04:01.293

假设你的 div 有一个通用的类名，例如`.boxes`，添加这个 CSS：

```
.boxes:nth-child(odd) {clear: left;} 
```

这将使每个奇数框都清除浮动并开始新行。

或者，设置容器的宽度，使得只有两个盒子可以并排放置，然后使用`display: inline-block`代替`float: left;`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T00:01:37.957

添加一个 CSS 属性为 clear:both; 的元素 在第二个 DIV 之后，类似于：

```
<div id="first"></div>
<div id="second"></div>
<br class="clear_both" />
<div id="third"></div> 
```

然后在 CSS 中：

```
.clear_both {
    clear:both;
    height:0;
    width:0;
} 
```

# css - 避免浏览器自动下划线和链接通用词

> ID：11182100
> 
> 赞同：3
> 
> 时间：2012-06-24T23:51:03.783
> 
> 标签：css

我在所有浏览器的网络上都看到了这一点：高度搜索作品上的可怕蓝色链接。

目前，在我的网站[http://www.thumbslinger.com](http://www.thumbslinger.com)上，在我的鸟种“合法”副本中，“弹吉他”这两个词被加了下划线和链接。在 Firebug 中，我检查并发现它自动插入：

```
<a id="FALINK_2_0_1" class="FAtxtL" href="#">play guitar</a> 
```

我不得不绕过雅虎和他们关于在编码电子邮件时随机选择出现在搜索中的通用词的事情，但除了覆盖这个特定的 ID 之外，是否有任何关于如何防止这种情况发生的讨论？

编辑：现在我看到还有另外两个词，它们被赋予了唯一的 ID！只是重新设计 FALINK 并不容易。我可以使用 jquery 来解析和搜索，但是诸神..这一切是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T05:40:24.873

这听起来像是您自己计算机中的某种软件，尽管可能不是病毒防护工具归类为恶意软件的东西。

对 fatxtl 和 falink 等字符串的搜索大多会给出包含它们的标记在讨论论坛和博客帖子中显示为可见文本的结果（以及在“专家交流”网站上的一次点击，其中“批准的答案”只是对“搜索”的模糊猜测劫持病毒”）。

但是，有些页面中带有类似结构的代码`<a class=FAtxtL href=... id=FALINK_1_0_0 ...>`出现在标记中。也许在您自己的浏览中（而不是在网页上）生成您所看到的链接的软件实际上是为了将带有真实 URL 而不是 的链接注入`"#"`可能被上传的文档中。

无论如何，运行一些病毒防护和反广告软件是个好主意。即使他们可能无法通过名称识别这种软件，但他们可能会通过其属性检测到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-08T23:42:13.867

就我而言，我发现安装了一个名为 YonToo 的东西。一旦我删除它，链接就停止了，最近我在亚马逊时开始出现的下拉列表也停止了。不知道 YonToo 来自哪里，但我从应用程序中删除了它，这解决了不需要的链接，谁知道还有什么

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-14T15:10:26.137

我知道这是一个老问题，但我只想添加一些我发现的东西，以防将来有人遇到这个问题：

我的浏览器在随机单词下划线，悬停时会出现一个弹出窗口，显示 TopArcadeHits 的添加。

事实证明，TopArcadeHits 软件实际上安装在我的机器上，并且在我的浏览器中创建了一个插件。

我有 99% 的把握这是从 CNET 下载的东西。

只是需要注意的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-08T03:23:45.160

DealCabby 是另一个这样做的人。

我不知道这是外部广告软件，我认为它是由开发人员添加的，旨在惹恼他们的观众:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-27T04:51:02.263

我的系统上安装了 TopArcadeHits，但我的 FF 浏览器中也安装了一个插件。赠品是鼠标悬停时出现的弹出添加说“由TopArcadeHits提供支持”。

我卸载了程序并禁用了插件（我认为可能还有一个插件），问题就消失了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-26T02:06:54.953

嘿，我只是想更新这篇文章，因为我发现了其他人可能遇到的确切原因。它实际上被称为 FBPhotoZoom，它可以通过 Facebook 访问浏览器，通常，这里也有 EasyInline：[http ://www.easyinline.com/support](http://www.easyinline.com/support)

上面的那个页面会告诉你如何关闭它，但本质上，检查 FBPhotoZoom 的浏览器扩展并禁用它......如果不存在，它可能已经安装，所以检查你的控制面板/添加/删除程序并查看在那里。

对我来说非常烦人并且最终没有什么价值，所以我不确定我在哪里捡到它，但很高兴找到了罪魁祸首。

# .htaccess - .htaccess 仅在某些情况下重定向

> ID：11182101
> 
> 赞同：0
> 
> 时间：2012-06-24T23:51:13.583
> 
> 标签：.htaccess, redirect

在这些情况下，我需要重定向到 www.domain.com/go404：

> www.domain.com
> 
> www.domain.com/
> 
> 域名.com
> 
> domain.com/

但不是，当他们打字时（我已经涵盖了）

```
 www.domain.com/subdomain or
   domain.com/subdomain 
```

目前，我的 .htaccess 代码有这个片段：

```
 # This sends "just domain" visits to 404
 RewriteCond %{HTTP_HOST} ^domain.com$ [NC] 
 RewriteRule ^(.*)$ http://www.domain.com/go404 [R=301,L]

 # This one makes a NON WWW become a WWW
 RewriteCond %{HTTP_HOST} ^domain.com$ [NC] 
 RewriteRule ^(.*)$ http://www.domain.com/$1 [R=301,L]

 # This strips the trailing slash
 RewriteRule ^(.*)\/(\?.*)?$ $1$2 [R=301,L] 
```

谁能告诉我如何设置条件，以便它只允许在没有尾部斜杠和/或子文件夹字符串的情况下编写域？如上所述，那些应该重定向到 404。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:14:42.497

这些规则应该满足您的需要：

```
 RewriteCond %{HTTP_HOST} ^domain.com$ [NC] 
 RewriteRule ^(.*)$ http://www.domain.com/$1 [R=301,L]

 RewriteCond %{HTTP_HOST} ^www.domain.com$ [NC] 
 RewriteRule ^$ go404 [R=301,L] 
```

# dojo - 如何在 Dojo 小部件模板中创建唯一 ID？

> ID：11182103
> 
> 赞同：11
> 
> 时间：2012-06-24T23:51:27.700
> 
> 标签：dojo, widget

我有一个正在编写的 Dojo 小部件，它向用户页面添加标签和输入框。

a的`for`属性`label`需要 HTML ID 值，但 Dojo 小部件不应包含 ID，以防在同一页面上创建多个实例。

那么，有人对如何解决这些相互冲突的需求有任何建议吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-25T03:45:12.380

开箱即用，如果在构建时配置参数不存在，dijit 注册表设置 WidgetID (this.id) 的方式如下：

```
constructor: function(args) { args=args || {};
  this.id = args.id || dijit.registry.getUniqueId(this.declaredClass)
} 
```

模板适用于字符串替换，所以如果你的类中有一个属性，比如**foo**，将它*放入*模板的方法如下：

```
templateString = '<div class="${foo}">'; 
```

在您的情况下，模板中某处有一个标签->输入对，它是这样的

```
<div><!--domNode-->
   <table>
       <td><label for="${id}-edit-title">Title</label></td>
       <td><input id="${id}-edit-title" type="text" /></td>
   </table>
</div> 
```

所以

虽然暂时有点过时，但这是一个很好的起点： [http ://dojotoolkit.org/documentation/tutorials/1.6/templated/](http://dojotoolkit.org/documentation/tutorials/1.6/templated/)

继续阅读`dojo.Stateful`get/set 机制

最后转向`dijit._WidgetsInTemplateMixin`。

# java - Javac 编译问题

> ID：11182104
> 
> 赞同：0
> 
> 时间：2012-06-24T23:51:28.340
> 
> 标签：java, javac

尝试编译具有注释的项目时出现以下错误`@Access(AccessType.FIELD)`

> 执行 javac 失败，但无法解析错误：编译器 (1.6.0_20) 发生异常。
> 
> 检查 Parade 是否有重复项后，请在 Java Developer Connection (http://java.sun.com/webapps/bugreport) 提交错误。包括您的程序和以下诊断谢谢。
> 
> tools.javac.code.Symbol$CompletionFailure ：找不到 javax.persistence.AccessType 的类文件。构建错误

如何在 java 解析器中修复此错误？我使用 elcipselink 和 eclipse 作为 IDE。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T23:58:41.833

可能是您的 JPA JAR 版本：根据 javadocs，此注解仅从 JPA 2.0 开始使用：

[http://docs.oracle.com/javaee/6/api/javax/persistence/AccessType.html](http://docs.oracle.com/javaee/6/api/javax/persistence/AccessType.html)

# scala - 与字符串数字匹配 - 无法访问的代码

> ID：11182105
> 
> 赞同：0
> 
> 时间：2012-06-24T23:51:32.147
> 
> 标签：scala, pattern-matching

Scala 新手，似乎无法让我的匹配表达式起作用。我已经阅读了如何评估语句之间的差异（例如，一个新变量与一个声明的变量相反），但似乎无法让反引号或大写起作用。

```
// declared inside of object
val numberOne = "+17201234567"
val numberTwo = "+17201235678"

def returnSomething(number: String): String = number match {
  case numberOne => "my first number"
  case numberTwo => "my second number"
  case _ => "a default number"
}

...

returnSomething("+17201235678") // should return "my second number" 
```

请帮助澄清为什么这不起作用，因为我在 match 语句的第二行收到“无法访问的代码”错误。我知道这个问题已经结束了，但由于某种原因，我见过的例子都没有为我工作。典型的菜鸟语言的东西。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T00:21:25.480

这些中的任何一个都可以工作：

```
// declared inside of object
val numberOne = "+17201234567"
val numberTwo = "+17201235678"

def returnSomething(number: String): String = number match {
  case `numberOne` => "my first number"
  case `numberTwo` => "my second number"
  case _ => "a default number"
}

// declared inside of object
val NumberOne = "+17201234567"
val NumberTwo = "+17201235678"

def returnSomething(number: String): String = number match {
  case NumberOne => "my first number"
  case NumberTwo => "my second number"
  case _ => "a default number"
} 
```

但是你说你试过了，没用。那么，究竟出了什么问题呢？

# javascript - 更新javascript函数中的进度指示器

> ID：11182106
> 
> 赞同：1
> 
> 时间：2012-06-24T23:51:37.700
> 
> 标签：javascript, progress

（请参阅底部的更新）

我已经查看了几十个问题，但无法完成这项工作。

鉴于下面的代码，我如何强制它在每次迭代后更新我的简单进度指示器 ($("#log"))？

**编辑：**我认为这个 JSFiddle 体现了我的问题：http: [//jsfiddle.net/kPRky/](http://jsfiddle.net/kPRky/)

这是 HTML：

```
<div id="test"></div>
<div id="log"></div> 
```

这是调用函数的方式：

```
$("#test").html(createLevelMap()); 
```

这就是功能

```
function createLevelMap() {
    var height = 300;
    var width = 1000;
    var totalpixels = height * width; //used for calculating loading percentages;
    var currentpixel = 0; //used for calculating loading percentages;

    var x = 0;
    var y = 0;
    //lots of other variables

    for (x = 0; x < width; x += 1) {
        for (y = 0; y < height; y += 1) {

            //lots of calculations with lots of variables

            currentpixel += 1;
            $("#log").html((currentpixel / totalpixels) * 100 + "%");
        }
    }

    return ('done'); //actually returns a very long base64 encoded string
} 
```

**更新**

我简化了它，以便我有一个单独的函数来呈现每一列，而不是整个网格。但是，使用 setTimeout 仍然无法正确显示进度。

```
for (x = 0; x < width; x += 1) {
    $("#log").html(((x + 1) / width) * 100 + "%<br>(sliver " + (x + 1) + "/" + width + ")");
    setTimeout(createSliver(x), 100);
} 
```

^^ 这会产生我期望的输出，但没有百分比更新。我将其更改为 setTimeout(function() { createSliver(x) }, 100); 按照评论中的建议，然后我什至没有得到我的输出（也仍然没有增加百分比）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:08:26.560

这个怎么样？

```
var height = 300;
var width = 1000;
var totalpixels = height * width; //used for calculating loading percentages;
var currentpixel = 0; //used for calculating loading percentages;

incrementAndUpdate(currentpixel, totalpixels);

function incrementAndUpdate(currentValue, totalPixels) {
    $("#log").html((currentValue / totalPixels) * 100 + "%");
    if (currentValue < totalPixels) {
        setTimeout(function () { incrementAndUpdate(currentValue + 1, totalPixels); }, 1);
    }
} 
```

​</p>

鉴于此速度较慢，我建议您可能以较少的频率调用它，并在每次尝试 setTimeout/html 更新调用时做更多的工作单元。也许创建一个工作队列，在你的`incrementAndUpdate`函数中，选择直接调用函数，或者通过 setTimeout。

像这样的东西...

```
function incrementAndUpdate(currentValue, totalPixels) {
    $("#log").html((currentValue / totalPixels) * 100 + "%");

    // do a bit of work.

    if (currentValue < totalPixels) {
        var workFunction = function () { incrementAndUpdate(currentValue + 1, totalPixels); }
        if (currentValue % 100 == 0)
            setTimeout(workFunction, 1);
        else
            workFunction();
    }
} 
```

这完成了相同数量的工作，但它以更少的`setTimeout`调用速度更快。您可以调整调用 setTimeout 的频率，以尽可能优化用户体验。

这是您的小提琴的更新：http: [//jsfiddle.net/kPRky/1/](http://jsfiddle.net/kPRky/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:49:38.283

最好的解决方案是使用 Web Workers。这使您可以在与 UI 更新完全不同的线程中运行您的处理。如果你需要支持没有 web worker 的浏览器，你需要使用 setTimeout 让 GUI 更新有机会运行。

如果使用超时方法，您将通过设置最大时间来获得最佳体验，您将让它在跳出循环并调用 setTimeout 之前运行。这将使 GUI 重新绘制。

一个例子在这里：http: [//jsfiddle.net/kPRky/6/](http://jsfiddle.net/kPRky/6/)

您可以通过在 somethingSlow 方法中添加/删除零来加速/减慢它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T03:35:36.313

因此，我通过从内部调用 setTimeout() 函数获得了更新的进度。这是我丢失的关键。

这是现在的基本格式：

```
function nextRow() {
    x += 1;
    setTimeout(function () { createSliver() }, 100);
    if (x < width) { setTimeout(function () { nextRow() }, 100); }
}

function createSliver() {
    //do stuff here
    currentpixel += 1;
    $("#log").html(((currentpixel) / totalpixels) * 100 + "%<br>(pixel " + (currentpixel) + "/" + totalpixels + ")");
    y += 1;
    if (y < height) {
        setTimeout(function () { createSliver() }, 100);
    } else {
        y = 0;
    }

function mainFunction() {
        setTimeout(function () { nextRow() }, 100);
        return (data);
} 
```

但是现在我的“数据”没有正常返回。我假设是因为现在一切都在异步运行......便便。

# php - 如何只允许授权客户端访问对象属性

> ID：11182112
> 
> 赞同：0
> 
> 时间：2012-06-24T23:53:14.617
> 
> 标签：php

我的一些 PHP 域对象具有应该从对象外部设置的属性，但只能由某些客户端对象设置。我该如何执行此操作？

我在课堂上使用 setter，如果我能找到一种方法来区分不同的调用者，我相信我可以在 setter 中做一些检查。不过，这似乎有点令人费解。我觉得我违反了 OO 设计原则（也许是“告诉，不要问”？）。

我想这是一个相当常见的场景。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:17:03.753

在这种情况下，我觉得这是一个糟糕的设计。你会违反班级的单一职责原则。相反，将您的代码重构为多个类，但使用组合来附加可选属性。

例如：

```
class MyDataObject {
    private $main_property;
    private $extended_property;

    /* ... getters/setters for $main_property. */
    public function set_extended_property(IExtendedProperty $property) {
        $this->extended_property = $property;
    }
} 
```

`IExtendedProperty`自定义属性数据的接口在哪里。

# java - 如何在 Java 中显示文件复制操作的进度。在 Web 应用程序中不使用 Swing？

> ID：11182114
> 
> 赞同：5
> 
> 时间：2012-06-24T23:53:24.207
> 
> 标签：java, progress-bar, file-copying

我有一个需要执行文件复制操作并向用户显示进度条的 Web 应用程序。

目前，复制是通过调用完成的，`cpio`在操作完成之前无法给 Java 代码提供进度。虽然可以使用 Java 监控写入的字节数与读取的字节数以估计复制进度，但我认为如果我用 Java 编写实际的复制操作，可能会有更简单的解决方案。我仍将`cpio`用于归档目的，但实际副本将由 Java 类执行。

我在搜索中找到的大部分帮助都与progressMonitor 有关，它包含了一个swing 组件，我不确定它是否可以做我想要的。我所需要的只是一个整数/双倍的进度，我可以将它作为 100 的百分比提供给我的 Web 应用程序的进度条组件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T02:12:11.123

以下是如何在 java 中复制文件并在命令行上监控进度：

```
import java.io.*;

public class FileCopyProgress {
    public static void main(String[] args) {
        System.out.println("copying file");
        File filein  = new File("test.big");
        File fileout = new File("test_out.big");
        FileInputStream  fin  = null;
        FileOutputStream fout = null;
        long length  = filein.length();
        long counter = 0;
        int r = 0;
        byte[] b = new byte[1024];
        try {
                fin  = new FileInputStream(filein);
                fout = new FileOutputStream(fileout);
                while( (r = fin.read(b)) != -1) {
                        counter += r;
                        System.out.println( 1.0 * counter / length );
                        fout.write(b, 0, r);
                }
        }
        catch(Exception e){
                System.out.println("foo");
        }
    }
} 
```

您将不得不以某种方式更新您的进度条而不是 `System.out.println()`. 我希望这会有所帮助，但也许我不明白你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T03:05:37.703

基本上，您应该使用侦听器模式。在这个例子中，监听器有一个方法来接受刚刚写入的字节数。它可以预先填充总文件大小，以计算要在屏幕上显示的百分比。

```
ReadableByteChannel source = ...;
WritableByteChannel dest = ...;
FileCopyListener listener = ...;

ByteBuffer buf = ByteBuffer.allocateDirect(BUFFER_SIZE);
while (src.read(buf) != -1) {
  buf.flip();
  int writeCount = dest.write(buf);
  listener.bytesWritten(writeCount);
  buf.compact();
}
buf.flip();
while (buffer.hasRemaining()) {
  int writeCount = dest.write(buf);
  listener.bytesWritten(writeCount);
} 
```

# android - 按钮在表面视图上不起作用

> ID：11182118
> 
> 赞同：0
> 
> 时间：2012-06-24T23:54:43.567
> 
> 标签：android, button, add, surfaceview

我一直在研究这个链接的一些源代码 [http://android-er.blogspot.com/2010/12/add-overlay-on-camera-preview.html](http://android-er.blogspot.com/2010/12/add-overlay-on-camera-preview.html)

如果我想添加另一个按钮，我应该在这里做什么，我已经在 xml 中添加了按钮，但是它们不起作用，它们的源代码是：

```
LinearLayout layoutbg = (LinearLayout) findViewById(R.id.background);
    layoutbg.setOnClickListener(new LinearLayout.OnClickListener(){

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            switch (v.getId()) {

            case (R.id.previous_btn):
            //some source   
showImage();
                break;

            case (R.id.next_btn):
    //some source           showImage();
                break;

            }

        }

        private void showImage() {
            // TODO Auto-generated method stub
    Toast.makeText(AndroidCamera.this, " User don't  ", Toast.LENGTH_SHORT);
        }

    });
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:32:50.957

让你的活动实施`View.OnClickListener`

之后在您的`onCreate()`方法中执行以下操作：

```
Button btn1= findViewById(R.id.previous_btn);
Button btn2= findViewById(R.id.next_btn);
btn1.setOnClickListener(this);
btn2.setOnClickListener(this); 
```

在实现后必须覆盖的 OnClick() 方法中，执行`View.OnClickListener`以下操作：

```
@Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            switch (v.getId()) {

            case (R.id.previous_btn):
            //some source   
showImage();
                break;

            case (R.id.next_btn):
    //some source           showImage();
                break;

            }

        } 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T00:19:20.343

您应该将侦听器目录添加到按钮，而不是 LinearLayout... 并使用`View.OnClickListener`

只需转到您链接的教程的第二部分，“下一步：- 实现 Android 相机的 takePicture 功能”，有代码为按钮添加侦听器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-25T01:27:46.847

问题可能出在您的 XML 中。Android 倾向于最后绘制位于 XML 文档底部的视图。这意味着如果您的按钮在文档中的位置高于它们顶部的表面，则用户的点击将点击您的 SurfaceView 而不是您的按钮。

例如，在这种情况下，您的按钮将不可点击：

```
<RelativeLayout
  ... >
    <Button ... />
    <SurfaceView
      android:layout_width="match_parent"
      android:layout_height="match_parent" />
</RelativeLayout> 
```

但在这种情况下：

```
<RelativeLayout
  ... >
    <SurfaceView
      android:layout_width="match_parent"
      android:layout_height="match_parent" />
    <Button ... />
</RelativeLayout> 
```

# jquery - iScroll4 仅在调整窗口大小时显示滚动

> ID：11182119
> 
> 赞同：0
> 
> 时间：2012-06-24T23:54:47.497
> 
> 标签：jquery, iscroll4, iscroll

我偶然发现了这个问题，我花了一段时间才意识到它是什么，因为在任何地方都没有直接的答案。

问题是当我的页面加载时，我的 iScrolls 不起作用：滚动条消失了，滑动也坏了。它仅在我调整窗口大小时自行修复。使用 refresh() 没有帮助，而且 HTML 结构看起来还不错。下面回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T23:54:47.980

问题不在我的 iScroll 代码或 HTML 中。它在我的 CSS 中：

由于浏览器呈现页面的方式，如果您的容器具有`display:none;`（在我的情况下，我使用动态类来显示/隐藏内容），iScroll 无法计算、发疯和死亡，直到调整大小将其唤醒。

解决方案：使用`visibility:hidden;`or`opacity: 0;`代替。

# php - 从“另存为浏览器”对话框获取路径

> ID：11182132
> 
> 赞同：0
> 
> 时间：2012-06-24T23:56:54.517
> 
> 标签：php, javascript, jquery

我正在开发一个使用 jQuery 和 php 的应用程序。我想用一个“另存为”对话框提示用户，该对话框已经具有我要将数据保存到的文件名。现在，已经有很多关于这个主题的帖子使用以下内容：

```
header('Content-disposition: attachment;filename=whatever.dat'); 
```

我见过另一种技术：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns='http://www.w3.org/1999/xhtml'> 
  <head>
    <title>iframe downloader thingy</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        $('a#linky').click(function(){
          var iframe = document.createElement("iframe"); 
          iframe.src = 'http://cl.ly/120d44203F223O1X2T43/example_branding.zip'; 
          iframe.style.display = "none"; 
          document.body.appendChild(iframe);
          return false;
        });
      });
    </script>
  </head>
  <body>
    <a id="linky">Click to download</a>
  </body>
</html> 
```

我需要将用户从“另存为”对话框中选择的整个路径返回给我，以便在 php 服务器脚本中进行进一步处理。我要做的是获取一些 MySQL 数据并将该数据保存为逗号分隔的文本文件，作为 Outlook 或 Thunderbird 邮件客户端的输入。

希望我已经清楚地解释了这一点。谢谢

埃德科恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:05:59.723

我将继续为您节省大量时间 - 您绝对无法访问浏览器的“另存为”对话框中的那一小行文本。但是，您可以做的是从与浏览器获取信息的来源完全相同的来源获取信息。

给定可下载文件的 URL，您应该能够编写一些 PHP 代码来获取下载 URL 提供给浏览器的“Content-disposition”标头。

# objective-c - 在运行时动态修改块

> ID：11182134
> 
> 赞同：4
> 
> 时间：2012-06-24T23:57:16.247
> 
> 标签：objective-c, objective-c-blocks, objective-c-runtime

我正在尝试为objective-c 类制作一个好的基于块的初始化程序。我在超类中声明它，我希望它在所有子类中都有用。

现在我有：

```
+ (id)createWithBlock:(void (^) (id newObject))creationBlock {
    id newObject = [self object];    
    creationBlock(newObject);
    return newObject;
} 
```

可以这样使用（在子类中）：

```
Record *newRecord = [Record createWithBlock:^(id newObject) {
    Record *newRecord = (Record *)newObject;
    newRecord.name = @"Ginger";
    newRecord.type = @"Rhizome";
}]; 
```

现在还可以，但我希望能减少一点。理想情况下，它看起来像：

```
Record *newRecord = [Record createWithBlock:^{
    name = @"Ginger";
    type = @"Rhizome";
}]; 
```

但这似乎有点雄心勃勃。我也可以：

```
Record *newRecord = [Record createWithBlock:^(Record *newRecord) {
    newRecord.name = @"Ginger";
    newRecord.type = @"Rhizome";
}]; 
```

最后一个版本很困难，因为 clang 似乎对块进行了一些编译时类型检查。上面的内容不会与我上面的 createWithBlock: 的定义一起编译，因为：`incompatible block pointer types initializing 'void (^)(struct Record *)', expected 'void (^)(struct objc_object *)`。

如果它没有进行这种强大的类型检查，我可以在运行时调整方法。（或者如果我 typedef 我的块声明，也许我现在可以这样做？）

一段时间以来，我一直在摸不着头脑，并且我已经阅读了几乎所有我能找到的块上的文档，包括 clang 规范。如果有人有想法，我很想听听，这是一个开源项目，我认为该模式将使所有 Objective-c 用户受益。

现在我的想法倾向于`imp_implementationWithBlock()`. 但随后我需要根据其中的内容“构建”一个新的 IMP，然后将其换掉。可行的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T00:17:53.520

你用的是什么编译器？我相信最新版本的 LLVM 将接受您提供的最后一个代码示例。（即您给出的错误不应该发生。）

特别是，这对我在 Xcode 4.3.3 中的全新 Xcode 项目中使用 LLVM 3.1 有效。

# c# - 为单页应用程序捆绑 HTML 内容

> ID：11182138
> 
> 赞同：0
> 
> 时间：2012-06-24T23:58:11.687
> 
> 标签：c#, asp.net

我正在构建一个单页应用程序。目前，我还有几个用母版页构建的独立页面。在他们的标记中，我有这个：

```
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" 
     Runat="Server">
                        My HTML here
</asp:Content> 
```

所以目前，我所做的是将所有 .aspx 文件的所有 HTML 复制粘贴到一页 .aspx 文件的 asp:Content 控件中。问题是，当我更改其中一个 .aspx 文件中的 HTML 时，我还需要记住在单页文件中复制粘贴。很乱。

有更好的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:18:45.617

尝试使用用户控件 (.ascx) 并在主页和单个页面中引用。然后，您只需在一处更新用户控件。

# javascript - 如何让 HTML5 JavaScript 画布识别来自 iphone/ipad 的触摸/点击？

> ID：11182139
> 
> 赞同：1
> 
> 时间：2012-06-24T23:58:38.590
> 
> 标签：javascript, html, ios, html5-canvas, dom-events

我有一个非常简单的 HTML5 游戏，可以在常规浏览器中按预期运行，但是当从 iPhone 或 iPad 上的浏览​​器访问时，它无法识别 click 事件或 touchstart 事件。

原始代码来自此处的教程： [http ://www.lostdecadegames.com/how-to-make-a-simple-html5-canvas-game/](http://www.lostdecadegames.com/how-to-make-a-simple-html5-canvas-game/)

我已经对其进行了修改并添加了一个单击事件，该事件会将笑脸移动到您在画布上单击的任何位置。此单击事件在 Mac 和 Windows 浏览器中使用鼠标运行良好：http: [//iwebss.com/test](http://iwebss.com/test)

但是如果您使用 iPhone 或 iPad 访问它，则单击事件不起作用。我还尝试为 touchstart 添加一个额外的侦听器，这也不起作用。

这些是我添加到代码中的新侦听器：

```
 addEventListener("click", mouseClickEvent, false);
    function mouseClickEvent(e) {
        alert("click event");
            mouseClick = true;
        if (e.offsetX) {
              mouseX = e.offsetX;
              mouseY = e.offsetY;
            }  else if(e.layerX) {
              mouseX = e.layerX;
              mouseY = e.layerY;
            }
    }

    addEventListener("touchstart", testEvent, false);
    function testEvent(e) {
        alert("touchstart event");
    } 
```

关于我做错了什么或如何阅读 iPhone 和 iPad 触摸事件的任何想法？

编辑：我也尝试了也不起作用的 mousedown 事件。

已解决：我想通了...请参阅下面的答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T00:05:05.277

要附加的处理程序是：

```
ontouchstart - a finger goes down.
ontouchmove - a finger moves.
ontouchend - a finger goes up.

ongesturestart - a scale or a rotation starts.
ongesturechange - a scale or a rotation.
ongestureend - a scale or a rotation ends. 
```

几个元 iOS 特定元标记以及[此处](http://matt.might.net/articles/how-to-native-iphone-ipad-apps-in-javascript/)的其他信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T00:34:44.970

好的，我想通了……虽然事件侦听器在普通浏览器中工作，但对于 iphone/ipad，您需要专门将其附加到画布上。

所以在我给定的例子中，我有：

`var canvas = document.createElement("canvas");`

所以这适用于常规浏览器，但**不适**用于 iphone/ipad：

`addEventListener("click", mouseClickEvent, false);`

**解决方案：**这是我必须做的才能让它在 iphone/ipad 上工作（在前面添加画布）：

`canvas.addEventListener("click", mouseClickEvent, false);`

这也适用于 touchstart 事件！

作为旁注，我想知道您是否在 iphone 上使用 touchstart 或 click 事件是否重要？

# javascript - 在 Javascript 中模拟子类化 - 检查我是如何做到的？

> ID：11182144
> 
> 赞同：3
> 
> 时间：2012-06-24T23:58:47.833
> 
> 标签：javascript, subclass

我正在编写一些 GNOME javascript 的 javascript，它或多或少是蜘蛛猴。将其视为*永远不会*在 spidermonkey 之外运行的 spidermonkey 代码，因此无需担心跨浏览器兼容性等问题。

基本上我有一个*不可*`Folks.Individual`子类化的类，但我想通过修补它来模拟子类化它，向它添加一些吸气剂。（对于那些感兴趣的人，它是通过 gobject 自省获得的，在我的 GJS 版本中，你不能继承 a ）。*`GObject``GObject`*

 *笔记：

*   `contactSys.get_individual(contactID)`返回`Folks.Individual`我正在修补
*   我添加了一些 getter `email`, `aliasText`, 并`online`返回一些值。
*   我通过 使用这个类`let contact = new Contact(id);`，只是想把`contact`它当作一个使用`Folks.Individual`，加上我修补的额外属性。
*   如果我要修补的属性不是动态的，我会这样做：

    ```
    let contact = contactSys.get_individual(contactID);
    contact.email = ....;
    contact.aliasText = ....;
    contact.online = ....; 
    ```

我只是想要一个关于上述内容的便利函数，这样我就可以调用`let contact = new Contact(contactID)`它，它会返回修补`contact`的`email`,`aliasText`和`online`属性（尽管作为吸气剂）。

这就是我目前所做的。我的问题是，这是“正确”的做法吗？我应该使用`this`而不是`contact`within`Contact()`吗？我应该做些什么`Folks.Individual.prototype`而不是把它称为 a`Contact`吗？

```
function Contact (contactID) {                                                  
    let contactSys = Shell.ContactSystem.get_default(),                         
        contact    = contactSys.get_individual(contactID); // <-- this is a Folks.Individual
    contact._contactSys = contactSys;                                           

    /* these are defined as getters in case the underlying values change */     
    Object.defineProperty(contact, 'email', {get: function () {                 
        return contact._contactSys.get_email_for_display(this);                 
    }});                                                                        
    Object.defineProperty(contact, 'aliasText', {get: function () {             
        return contact.alias     ||                                             
               contact.full_name ||                                             
               contact.nickname  ||                                             
               contact.email     ||                                             
               _("Unknown");                                                    
    }});                                                                        
    Object.defineProperty(contact, 'online', {get: function () {                
        return contact.presence_type === Folks.PresenceType.AVAILABLE ||        
               contact.presence_type === Folks.PresenceType.AWAY ||             
               contact.presence_type === Folks.PresenceType.EXTENDED_AWAY ||    
               contact.presence_type === Folks.PresenceType.BUSY;               
    }});                                                                        
    return contact;                                                             
} 
```

记住——**我不能继承 Folks.Individual**，所以我会用一个包装函数来修补它的实例，`new Contact(contactID)`这样我就可以把它当作一个子类来对待。我只是想知道是否有这样做的标准方法。

干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T07:40:55.250

至少您可以更简洁有效地进行“在线”操作：

```
var ONLINE = Folks.PresenceType.AVAILABLE |
              Folks.PresenceType.AWAY |
              Folks.PresenceType.EXTENDED_AWAY |
              Folks.PresenceType.BUSY;

Object.defineProperty(contact, 'online', {
  get: function(){ return (this.presence_type & ONLINE) > 0 }
}); 
```*

# objective-c - 将图像发送到另一个视图控制器 UIImageView IOS 5.1

> ID：11182145
> 
> 赞同：0
> 
> 时间：2012-06-24T23:58:54.783
> 
> 标签：objective-c, ios, uitableview, uiimageview, uiimage

我的 uitableview 中有一个来自 Facebook 的名称列表，当用户选择一行时，用户详细信息应显示在另一个视图中。

在我的朋友.m

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    long long fbid = [[arrayOfIDs objectAtIndex:indexPath.row]longLongValue];

    NSString *user=[NSString stringWithFormat:@"%llu/picture",fbid];

    [facebook requestWithGraphPath:user andDelegate:self];

    FriendDetail *profileDetailPicture = [[FriendDetail alloc] initWithNibName: @"FriendDetail" bundle: nil];

    profileDetailPicture.profileImage.image= transferImage.image;

    profileDetailPicture.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;

    [self presentModalViewController:profileDetailPicture animated:YES];

    [profileDetailPicture release];

}

-(void)request:(FBRequest *)request didLoad:(id)result{
    if ([result isKindOfClass:[NSData class]])
    {
       transferImage.image = [[UIImage alloc] initWithData: result];
      // UIImage * sendPicture=[[UIImage alloc] initWithData: result];

        NSLog(@"Profile Picture");
    }
} 
```

这很好，因为如果我在表格视图下方放置一个 uiiamgeview 以查看它是否有效，似乎我得到了它有效的正确图像。 ![在此处输入图像描述](../Images/002e30b57ca775e6a49ed753975b6f2f.png)

但是当我选择该行并尝试在以下几行中将图像发送到其他视图控制器 UIImageview

```
FriendDetail *profileDetailPicture = [[FriendDetail alloc] initWithNibName: @"FriendDetail" bundle: nil];

        profileDetailPicture.profileImage.image= transferImage.image;

        profileDetailPicture.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;

        [self presentModalViewController:profileDetailPicture animated:YES]; 
```

它不会将图像发送到应出现朋友图像的详细视图控制器![在此处输入图像描述](../Images/15d822e18e9de861de9a5bb6cb5ecc72.png)

我尝试了 UIImageView 和 UIImage 方法，但无法完成。

代码有什么问题？

- - - - -编辑 - - - - -

所以感谢回答我已经更改了代码，下面的代码工作正常

```
-(void)request:(FBRequest *)request didLoad:(id)result{

    if ([result isKindOfClass:[NSData class]])
    {

       transferImage.image = [[UIImage alloc] initWithData: result];

        FriendDetail *profileDetailPicture = [[FriendDetail alloc] initWithNibName: @"FriendDetail" bundle: nil];

        [profileDetailPicture view];
        profileDetailPicture.profileImage.image= transferImage.image;

        profileDetailPicture.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;

        [self presentModalViewController:profileDetailPicture animated:YES];

        [profileDetailPicture release];
        NSLog(@"Profile Picture");
    }
}
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    long long fbid = [[arrayOfIDs objectAtIndex:indexPath.row]longLongValue];

    NSString *user=[NSString stringWithFormat:@"%llu/picture",fbid];

    [facebook requestWithGraphPath:user andDelegate:self];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:22:52.190

这条线是问题所在：

```
profileDetailPicture.profileImage.image= transferImage.image 
```

我假设 profileImage 是一个 IBOutlet？问题是此时这将为零，因为您的详细视图控制器的视图尚未加载。

解决这个问题的常用方法是将图像存储在细节控制器的成员变量中，然后将其填充到 viewDidLoad 中的 profileImage 的图像成员中，或者您确定细节视图已经加载的其他地方。（例如，如果您要调用`[profileDetailPicture view]`强制视图在此行之前加载，它应该可以工作。）

# javascript - 哪个事件会以最快和最一致的方式触发 - matchMedia、window.resize、orientationchange 或两者兼而有之？

> ID：11182149
> 
> 赞同：3
> 
> 时间：2012-06-25T00:00:09.370
> 
> 标签：javascript, android, iphone, mobile, webkit

基本上，当用户旋转他们的手机时，我需要启动一个功能，并且想知道每个人的体验，他们最好为此推荐哪个事件，以便该功能被最快和最一致地调用。我知道我的标题中提到的所有事件在各种 webkit 设备上都有其积极和消极的一面，所以想确保我使用的是正确的方法。

我还主要在 iOS 和 Android v2.2+ 设备上进行测试

所有建议表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T05:32:32.127

我发现orientationchange 在Android（本机浏览器）和iOS 上都非常可靠。

# iphone - iPhone：使用视图控制器将项目添加到单独的 tableviewcontroller

> ID：11182150
> 
> 赞同：0
> 
> 时间：2012-06-25T00:00:27.623
> 
> 标签：iphone, uitableview, parent-child

目前我有一个显示该控制器实现文件中`UITableViewController`数组的项目列表**。**现在，我想在右上角有一个按钮，当您按下它时，您会进入一个简单的页面，您可以在其中将项目添加到上一页的列表中。添加完项目后，它只会将您带回到列表中，现在列表中多了一个项目。

所以，我有一个`navigationController`进入我`tableViewController`的按钮和一个按钮，可以将你“推”到添加项目页面。

如何访问对 tableViewController 的引用，以便调用我的`-(void)addNewItem:(NSString *) name;`方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:23:42.080

这是我如何做到这一点的基本概述。它对我有用，但我不确定这是最好的方法——其他人肯定会加入。

“列表页面”（您的第一个 UITableViewController）实现了一个委托，“添加页面”调用该委托以让“列表页面”知道要添加的项目的详细信息。

当“列表页面”被带有所述详细信息的“添加页面”回调时，它会保存新项目，然后关闭“添加页面”。

为了把这一切联系起来，当“列表页面”创建并显示“添加页面”时，它会传递`self`给“添加页面”上的一个 ivar（我称之为`delegate`）。这基本上就是两者联系和交流的方式。

这是我为委托定义的协议：

```
@protocol AddItemViewControllerDelegate
- (void)addItemViewController:(AddItemViewController *)controller 
             withNewEventName:(NSString *)eventName;
@end 
```

这是“列表页面”按钮单击处理程序：

```
- (IBAction)addItem
{
    AddItemViewController *controller = [[AddItemViewController alloc] initWithNibName:@"AddItemView" bundle:nil];
    controller.delegate = self;
    [self presentModalViewController:controller animated:YES];
    [controller release];
} 
```

这是“添加页面”中的提交代码：

```
if ([self.delegate respondsToSelector:@selector(addItemViewController:withNewEventName:)]) {
    [self.delegate addItemViewController:self withNewEventName:eventNameTextField.text];
} 
```

最后，这是“列表页”中委托协议的实现：

```
- (void)addItemViewController:(AddItemViewController *)controller 
             withNewEventName:(NSString *)eventName 
{
    EventModel *newEvent = [[EventModel alloc] init];
    newEvent.name = eventName;
    [eventsList addObject:newEvent];
    [newEvent release];
    [self saveEvents];
    [self dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T00:19:08.523

我遇到了同样的问题，而且必须将新项目添加到本地数据库中。您的问题是您的表格视图的数据源是什么？它是 coredata、SQLLite 还是只是一个项目数组？我在这里找到了单例类的解决方案是 [教程](http://iphone.galloway.me.uk/iphone-sdktutorials/singleton-classes/)。不过，这将需要一些时间来实现单例类。

如果您只想将文本添加到表格视图中，您可以使用 alertview。

例如，如果您使用数组作为表的数据源，您可以在每次按下您创建的按钮时添加一个带有警报视图的项目

首先创建一个按钮，连接您的按钮以使用文件所有者在您的 .xib 文件中执行 IBAction

-

```
(IBAction)add:(UIButton *)sender
{

    UIAlertView* dialog = [[UIAlertView alloc] initWithTitle:@"Enter Item Name"
                                                     message:@"  "   
                                                    delegate:self 
                                           cancelButtonTitle:@"Cancel"
                                           otherButtonTitles:@"OK", nil];

    UITextField *nameField = [[UITextField alloc] 
                              initWithFrame:CGRectMake(20.0, 45.0, 245.0, 25.0)];
    [nameField setBackgroundColor:[UIColor whiteColor]];
    nameField.text = @"";
    nameField.tag = 100;
    [dialog addSubview:nameField];
    [nameField release];
    [dialog show];
    [dialog release];

}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    NSString *title = [alertView buttonTitleAtIndex:buttonIndex];
    yourArraylist = [[NSMutableArray alloc] init];

    if([title isEqualToString:@"OK"])
    {

        UITextField* nameField = (UITextField *)[alertView viewWithTag:100];
        [yourArraylist addObject:nameField.text];

     // do additional  data source issues here 
    [self.mytableView reloadData];
} 
```

# android - 在新活动中获取 DatePicker 值

> ID：11182151
> 
> 赞同：0
> 
> 时间：2012-06-25T00:00:38.943
> 
> 标签：android

嗨，感谢您查看这个新手问题。

我一直在寻找与我的问题相关的任何答案，但似乎找不到我遇到的问题，或者我可能需要有人解释我做错了什么。

无论如何，我的问题是我正在尝试学习 Intents 并在 putExtra、getExtra 等活动之间传递数据..，所以我创建了一个非常简单的应用程序，其功能是将所选日期从日期选择器传递到新活动并将其显示在屏幕上。我一定是做错了什么，因为当我单击按钮开始下一个活动时收到“android.content.res.Resources$NotFoundException”，我尝试了与其他已回答问题不同的代码但无济于事，我是否缺少某些东西?. 我的代码在下面，再次感谢你们所有人的任何答案。

第一项活动

```
package date.Picker;

import android.app.Activity; 
import android.content.Intent;
import android.os.Bundle; 
import android.view.View; 
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.DatePicker;   

public class DatePickerActivity extends Activity  {           

 int year;  
 int month;  
 int day; 

Button selectButton;
DatePicker datePicker;

@Override    
public void onCreate(Bundle savedInstanceState) {        
    super.onCreate(savedInstanceState);         
    setContentView(R.layout.main);                   

    datePicker = (DatePicker) findViewById(R.id.datePicker);
    selectButton = (Button) findViewById(R.id.selectButton);
    selectButton.setOnClickListener(new OnClickListener()
    {           

public void onClick(View v){         

    Intent intent = new Intent(getApplicationContext(),        datePickerResult.class);

    month = datePicker.getMonth();  
    day = datePicker.getDayOfMonth(); 
    year = datePicker.getYear();

    intent.putExtra("year",year);  
    intent.putExtra("month",month);  
    intent.putExtra("day",day);  

    startActivity(intent);

    } 

    });
}
 } 
```

第二次活动

```
package date.Picker;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.widget.TextView;

 public class datePickerResult extends Activity {

 int year;  
 int month;  
 int day; 

 TextView textView1;

@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.dpresult);

textView1 = (TextView)findViewById(R.id.textView1); 

Bundle extras = getIntent().getExtras();  

    extras.getBundle("year"); 
    extras.getBundle("day");  
    extras.getBundle("month");  

    textView1.setText(year);
 }
} 
```

因此，感谢您提供的任何答案或帮助。对不起，如果它有点浪费时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:05:38.223

弹出的第一件事是您调用了：

```
textView1.setText(year); 
```

编译器将`int year`视为资源 ID，因此它会尝试查找具有该 ID 的资源。既然做不到，那就放弃。请尝试以下两行之一：

```
textView1.setText(year+"");
textView1.setText(Integer.valueOf(year)); 
```

接下来，您不会分配以下内容的返回值：

```
extras.getBundle("year"); 
extras.getBundle("day");  
extras.getBundle("month"); 
```

您需要做的是选择额外的，并将其分配给一个变量。像这样：

```
year = extras.getInt("year");
day = extras.getInt("day");
month = extras.getInt("month"); 
```

那应该正确地从您`Bundle`的`Intent`.

# c# - 从谷歌财经/雅虎财经获取报价

> ID：11182161
> 
> 赞同：6
> 
> 时间：2012-06-25T00:02:02.330
> 
> 标签：c#, finance

我如何在 C# 上收到股票报价？Google Finance API 不是很有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-06-24T05:52:25.233

**谷歌金融 API 替代方案。**[AlphaVantage](https://www.alphavantage.co/)是 Google 财务 API 的免费、出色的替代品。您可以注册一个免费的 API 密钥以开始检索实时和历史股票市场报价。

**如何使用 C# 检索 AlphaVantage 股票市场数据？**这是一些用 C# 检索每月股票市场价格的示例代码。您将需要安装[ServiceStack.Text](https://github.com/ServiceStack/ServiceStack.Text) - 一个免费的、开源的、高性能的 .NET 文本实用程序来运行以下 (Install-Package ServiceStack.Text)。

```
public class AlphaVantageData
{
      public DateTime Timestamp { get; set; }
      public decimal Open { get; set; }
      public decimal High { get; set; }
      public decimal Low { get; set; }
      public decimal Close { get; set; }
      public decimal Volume { get; set; }
}

// retrieve monthly prices for Microsoft
var symbol = "MSFT";
var apiKey = "demo"; // retrieve your api key from https://www.alphavantage.co/support/#api-key
var monthlyPrices = $"https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY&symbol={symbol}&apikey={apiKey}&datatype=csv"
                .GetStringFromUrl().FromCsv<List<AlphaVantageData>>();

monthlyPrices.PrintDump(); 
```

您可以在 gistlyn [here](https://gistlyn.com/?gist=099fff06d515a39964932e6eafded243)中运行上述示例代码。我在[这里](https://medium.com/@mark.holdt/alphavantage-and-c-1d560e690387)写了一篇完整的文章“AlphaVantage 和 C#” 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T12:50:42.937

最快的方法之一是使用 yahoo http 请求（一些细节可以在[http://www.gummy-stuff.org/Yahoo-data.htm](http://www.gummy-stuff.org/Yahoo-data.htm)中找到）

然后使用以下代码以编程方式检索结果，而不是手动下载或使用电子表格。

```
public static string Extract(string yahooHttpRequestString)
{
      //if need to pass proxy using local configuration  
      System.Net.WebClient webClient = new WebClient();  
      webClient.Proxy = HttpWebRequest.GetSystemWebProxy();  
      webClient.Proxy.Credentials = CredentialCache.DefaultCredentials;  

      Stream strm = webClient.OpenRead(yahooHttpRequestString);  
      StreamReader sr = new StreamReader(strm);  
      string result = sr.ReadToEnd();            
      strm.Close();             
      return result;  
} 
```

然后您可以进一步处理返回的字符串，或者修改上面的代码以将每个引号段的字符串解析为更详细的数据结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T00:17:05.240

我建议你通过[雅虎的股票报价！在 C#](http://www.codeproject.com/Articles/37550/Stock-quote-and-chart-from-Yahoo-in-C)文章中访问来自 Yahoo 的股票报价......

# c# - C# 使用 Object & XMLSerializer 添加 XML 属性

> ID：11182162
> 
> 赞同：2
> 
> 时间：2012-06-25T00:02:27.510
> 
> 标签：c#, xml, serialization

我有以下代码将对象输出到 XML 文件：

```
using System;
using System.IO;
using System.Collections.Generic;
using System.Reflection;
using System.Xml;
using System.Xml.Serialization;

namespace TrailBlazerReloaded
{
    public class Config
    {
        Config config = null;
        XmlSerializer serializer = new XmlSerializer(typeof(Config));

        public Config()
        {
            CollectionPaths = null;
            Definitions = null;
            TrailerPath = null;
        }

        public string Version { get; set; }

        public string[] CollectionPaths { get; set; }

        public string[] Definitions { get; set; }

        public string[] TrailerPath { get; set; }

        public void WriteConfig(Config configToSave)
        {
            serializer = new XmlSerializer(typeof(Config));
            TextWriter textWriter = new StreamWriter(@"config.xml");
            serializer.Serialize(textWriter, configToSave);
            textWriter.Close();
        }

        public Config ReadConfig()
        {
            if (File.Exists(@"Config.xml"))
            {
                var reader = new StreamReader("Config.xml");
                config = (Config) serializer.Deserialize(reader);
                reader.Close();
            }

            return config;
        }

        public static string GetConfigFilePath()
        {
            return Assembly.GetExecutingAssembly().Location + ".config";
        }

    }
} 
```

它返回以下结果：

```
<?xml version="1.0" encoding="utf-8"?>
<Config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Version>0.0.1</Version>
  <CollectionPaths>
    <string>F:\Trailblazer Test Folder 1</string>
    <string>F:\Trailblazer Test Folder 2</string>
    <string>F:\Trailblazer Test Folder 3 (100 Films)</string>
  </CollectionPaths>
  <Definitions>
    <string>1080p</string>
    <string>720p</string>
    <string>480p</string>
  </Definitions>
  <TrailerPath>
    <string>C:\</string>
  </TrailerPath>
</Config> 
```

但是，我希望输出在每个定义标记项上包含一个属性，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Version>0.0.1</Version>
  <CollectionPaths>
    <string>F:\Trailblazer Test Folder 1</string>
    <string>F:\Trailblazer Test Folder 2</string>
    <string>F:\Trailblazer Test Folder 3 (100 Films)</string>
  </CollectionPaths>
  <Definitions>
    <string active="true">1080p</string>
    <string active="false">720p</string>
    <string active="true">480p</string>
  </Definitions>
  <TrailerPath>
    <string>C:\</string>
  </TrailerPath>
</Config> 
```

有任何想法吗？:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T00:15:13.137

您将不得不使用自定义类型而不是字符串。

```
public class Definition
{
    [XmlAttribute("active")]
    public bool Active;

    [XmlText]
    public string Text;
} 
```

然后像这样定义`Definitions`属性

```
[XmleElement("string")]
public Definition[] Definitions { get; set; } 
```

# java - 使用一系列图像的动态壁纸

> ID：11182163
> 
> 赞同：3
> 
> 时间：2012-06-25T00:03:13.487
> 
> 标签：java, android, live-wallpaper, image

大家好。这是我第一个安卓项目。我正在尝试使用从视频中获取的一系列图像创建动态壁纸。每张图片的尺寸为 960 x 800。到目前为止，动态壁纸可以正常工作，但我仍然有无法解决的问题。

1.  设置后，动态壁纸仅显示整个 png 的一部分。我设法让它滚动图像宽度，它滚动但它只显示整个宽度的一部分。并且它只显示整个图像的部分高度，大约直到图像的一半在纵向上，而在横向上从上到下只显示一部分。我希望动态壁纸看起来不错，并在纵向和横向模式下都适合手机屏幕。

2.  它有效，但它有点停顿。只有当我切换屏幕时它才会继续工作。在这个问题上更具体的是，当你设置它时它会动画，但在循环的一半时突然停止，当你切换屏幕时它会继续工作一点，这意味着它会在序列上前进一点。为了完成序列并重新开始，您需要继续浏览屏幕。

3.  我希望序列更快，就像它是一个视频一样。

这是我的代码::

```
package com.livewallpaper.mw3lwp;

import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.os.Handler;
import android.service.wallpaper.WallpaperService;
import android.view.SurfaceHolder;

public class ModernWarfare3LiveWallpaper extends WallpaperService {
    private final Handler handler = new Handler();
    public float mxOffset;
    public void onCreate() 
    {
        super.onCreate();
    }

    public void onDestroy() 
    {
        super.onDestroy();
    }

    public Engine onCreateEngine() 
    {
        return new CercleEngine();
    }

    class CercleEngine extends Engine {

        private final Runnable drawRunner = new Runnable(){
            @Override
            public void run() {
                updateBG();
                drawFrame();

            }
        };

        public Bitmap myBg;
        int bgcycle = 0;

        public void updateBG() {
            if(bgcycle==50){
                bgcycle=0;
            }

            switch (bgcycle) {
                case 0: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n01); break;
                case 1: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n02); break;
                case 2: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n03); break;
                case 3: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n04); break;
                case 4: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n05); break;
                case 5: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n06); break;
                case 6: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n07); break;
                case 7: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n08); break;
                case 8: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n09); break;
                case 9: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n10); break;
                case 10: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n11); break;
                case 11: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n12); break;
                case 12: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n13); break;
                case 13: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n14); break;
                case 14: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n15); break;
                case 15: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n16); break;
                case 16: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n17); break;
                case 17: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n18); break;
                case 18: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n19); break;
                case 19: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n20); break;
                case 20: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n21); break;
                case 21: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n22); break;
                case 22: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n23); break;
                case 23: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n24); break;
                case 24: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n25); break;
                case 25: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n26); break;
                case 26: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n27); break;
                case 27: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n28); break;
                case 28: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n29); break;
                case 29: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n30); break;
                case 30: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n31); break;
                case 31: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n32); break;
                case 32: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n33); break;
                case 33: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n34); break;
                case 34: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n35); break;
                case 35: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n36); break;
                case 36: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n37); break;
                case 37: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n38); break;
                case 38: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n39); break;
                case 39: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n40); break;
                case 40: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n41); break;
                case 41: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n42); break;
                case 42: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n43); break;
                case 43: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n44); break;
                case 44: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n45); break;
                case 45: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n46); break;
                case 46: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n47); break;
                case 47: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n48); break;
                case 48: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n49); break;
                case 49: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n50); break;
                case 50: myBg = BitmapFactory.decodeResource(getResources(),R.drawable.n51); break;
            }

            bgcycle++;
        }

        CercleEngine() 
        {   
            updateBG(); 
        }

        public void onCreate(SurfaceHolder surfaceHolder) 
        {
            super.onCreate(surfaceHolder);
        }

        @Override
        public void onOffsetsChanged(float xOffset, float yOffset, float xStep, float yStep, int xPixels, int yPixels) 
        {
            super.onOffsetsChanged(mxOffset, yOffset, xStep, yStep, xPixels, yPixels);
            mxOffset = xPixels;
            drawFrame();
        }

        void drawFrame() 
        {
            final SurfaceHolder holder = getSurfaceHolder();

            Canvas c = null;
            try 
            {
                c = holder.lockCanvas();
                if (c != null) 
                {           

                    c.save();
                    c.translate((float) mxOffset, 0f);

                    if(myBg != null) {
                        updateBG();
                        c.drawBitmap(myBg, 0, 0, null);
                    }

                    c.restore();
                    //updateBG();
                    //c.drawBitmap(myBg, 0, 0, null);

                }
            }finally{
                if (c != null) holder.unlockCanvasAndPost(c);
            }
            handler.removeCallbacks(drawRunner);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T09:11:16.787

问题是您每次都在 updateBG() 中创建位图。那就是让它变得迟钝。

# ruby-on-rails - 推特流停止工作

> ID：11182164
> 
> 赞同：4
> 
> 时间：2012-06-25T00:03:33.213
> 
> 标签：ruby-on-rails, tweetstream

我正在使用`tweetstream`gem连接到 twitter API，如下[所示](https://github.com/intridea/tweetstream#usage)。它工作正常，但是当我在更改处理流的方式时停止并重新启动流时，在 2 小时左右重新启动大约 5 次后，流停止给我更新，并且`on_reconnect`事件每 30 秒左右发生一次.

我在想这是因为这会触发速率限制，或者是因为在开始新的连接之前之前的连接没有被终止。有没有合适的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T07:24:40.530

我不确定我的问题的原因，但这就是我所做的：

*   更新库（捆绑更新）。关于 github 问题的讨论似乎暗示底层 EventMachine gem 可能存在导致连接问题的错误，该错误已在最新版本中修复。

*   确保您的系统时间是现实的。至少有一次我的系统时间（它没有与互联网时钟同步）与实时时间相差 30 多分钟，并且我的请求令牌被拒绝为无效（过期或将来签名）。

*   将流阅读器包装在[Daemon](http://daemons.rubyforge.org/)中。给守护进程一个`{:monitor => true}`选项，这样它就会在它死亡时重新启动作业。这种情况每周在我的服务器上发生几次，并出现超时错误（我猜测 API 端服务中断，或者我自己的互联网连接出现故障）。这更像是一种创可贴，因为它最初不应该真的死掉，但它把这个问题推到了我的优先级列表中，以至于我目前并不担心它。

# java - 编写处理程序来确定结果集中的数据类型

> ID：11182169
> 
> 赞同：0
> 
> 时间：2012-06-25T00:04:35.950
> 
> 标签：java, mysql, resultset

所以，我有一个用 java 编写的程序，它查看一个 mysql 数据库，并且我有一些在程序的不同部分针对它运行的查询。

在处理 select / leftjoin 语句期间填充的结果集时，我发现它非常麻烦。例如，如果我不知道表中数据的确切类型怎么办？是否有任何（好的）方法来编写一个处理程序，它将一个 int 转换为一个 int/a double 到一个 double，将 String 转换为一个字符串......不断地。

我只是想知道，因为我觉得做一个结果集 > String > Double 效率很低 Double.parseDouble((resultset.getString(index))); 只是感觉不对，因为这意味着我不仅要知道数据类型，还要知道确切的索引。这也使空值也变得更加棘手。

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:42:57.263

阅读名为 ResultSetMetaData 的 JDBC 类。

[http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSetMetaData.html](http://docs.oracle.com/javase/7/docs/api/java/sql/ResultSetMetaData.html)

有一个很好的方法叫做`getColumnType (int colnum)`.

# c++ - 映射成员变量以进行迭代

> ID：11182174
> 
> 赞同：0
> 
> 时间：2012-06-25T00:05:25.657
> 
> 标签：c++, qt, map, member-variables

在我的 C++/QT 应用程序中，我有一个包含数百个变量的结构，如下所示：

```
struct MyStruct
{
    int a1;
    double a2;
    struct InnerStruct
    {
        int b1;
        bool b2;
        struct InnerInnerStruct
        {
            char c1;
              .
              .
              .
        };
        InnerInnerStruct b3;
          .
          .
          .

    };
    InnerStruct a3;
      .
      .
      .
}; 
```

我想要一个每个结构成员变量的地址映射，它有整数作为键类型，所以我可以通过它的键访问它：

```
MyStruct ms;
theMap[0] = &(ms.a1);
theMap[1] = &(ms.a2);
theMap[2] = &(ms.a3.b1);
theMap[3] = &(ms.a3.b2);
theMap[4] = &(ms.a3.b3.c1);

theMap[3] = true; // MyStruct::InnerStruct::b2 is 'true' now 
```

我应该如何定义 Map 对象？我需要什么样的深奥才能拥有此功能？普通模板？提升东西？一些抵消技巧？QVariant 不知何故？

**注意：**不幸的是，Qt 的属性系统不是一个选项。

* * *

**编辑：**关于我的请求的奇怪性质：我从某个地方接收数据帧，比如设备。数据的前 4 个字节指定帧的类型。所以每当我收到这些数据时，我必须把它放入 Device 结构的相应成员变量中。由于有数百种不同的数据类型，而且我需要在不止一个地方使用这种匹配，我想摆脱繁重的工作——或者至少做一次——（“if/else”和“switch”声明）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:53:09.873

**更新：**请参阅我对您问题的[其他答案](https://stackoverflow.com/a/11182820/1329652)。将每个数据框放入树数据模型中自己的元素中会更简洁。这种元素的子元素将是框架中的数据成员。这与您的各种框架具有不同数量的元素的情况相匹配。如果每个框架都有相同数量的元素，那么表格模型会更适合。Qt 的模型视图系统对所有数据使用 QVariants，并提供索引到任意复杂模型的方法，所以为什么要重新发明轮子。

在内部，您仍然可以使用结构来保存数据，但至少您不需要具有固定的全局（外部）结构。在创建原型模型时，可以为每个顶层元素（例如最顶层）分配其数据类型，在内部创建底层数据结构等。

现在回到你原来的方法。

类似 QVariant 的方法将起作用，如果整数键是运行时属性，这大约是使其真正起作用的唯一方法。如果您希望整数键仅在编译时有用，那么整数指定的模板函数/仿函数/类成员当然可以解决问题。

现在该值已分配给一个变体，“变体”必须将分配转发给目标成员。

theMap 可以是您想要的任何容器类型。该功能在“变体”中。我们称它为句柄，因为它本质上是一个变量的句柄。

您可以编写代码以支持转换，例如，让双句柄允许分配整数可能很有用。

不过，让我重复一遍：这是一个真正邪恶的设计，我认为没有必要做任何如此糟糕的事情。这是一种反模式。它尖叫：有人搞砸了。不要这样做。

下面是最简单的实现。

```
#include <QMap>
#include <QVariant>

class Handle
{
    QVariant::Type type;
    void * address;
public:
    Handle() : type(QVariant::Invalid), address(0) {}
    explicit Handle(int* p) : type(QVariant::Int), address(p) {}
    explicit Handle(bool * p) : type(QVariant::Bool), address(p) {}
    explicit Handle(double* p) : type(QVariant::Double), address(p) {}
    Handle & operator=(int* p) { return *this = Handle(p); }
    Handle & operator=(int v) {
        if (type == QVariant::Int) { *(int*)address = v; }
        else if (type == QVariant::Double) { *(double*)address = v; }
        else Q_ASSERT(type == QVariant::Invalid);
        return *this;
    }
    int toInt() const { Q_ASSERT(type == QVariant::Int); return *(int*)address; }
    Handle & operator=(bool* b) { return *this = Handle(b); }
    Handle & operator=(bool b) {
        Q_ASSERT(type == QVariant::Bool); *(bool*)address = b;
        return *this;
    }
    bool toBool() const { Q_ASSERT(type == QVariant::Bool); return *(bool*)address; }
    Handle & operator=(double* p) { return *this = Handle(p); }
    Handle & operator=(double d) {
        Q_ASSERT(type == QVariant::Double); *(double*)address = d;
        return *this;
    }
    int toDouble() const { Q_ASSERT(type == QVariant::Double); return *(double*)address; }
};

struct MyStruct
{
    int a1;
    double a2;
    struct InnerStruct
    {
        int b1;
        bool b2;
    } b3;
};

int main()
{
    MyStruct s;
    QMap<int, Handle> map;
    map[0] = &s.a1;
    map[1] = &s.a2;
    map[2] = &s.b3.b1;
    map[3] = &s.b3.b2;
    map[0] = 10;
    map[1] = 1.0;
    map[2] = 20;
    map[3] = true;
    return 0;
} 
```

# nhibernate - 使用 Fluent Nhibernate，我无法在其参考列中使用父对象 ID 保存子对象

> ID：11182177
> 
> 赞同：0
> 
> 时间：2012-06-25T00:06:00.267
> 
> 标签：nhibernate, fluent-nhibernate

典型问题 - 我正在尝试使用嵌套的新 IEnumerable 子对象保存新父对象，这些子对象都有引用列来存储父 ID，但我无法正确配置 NHibernate 以保存子对象。

它不会保存的原因是因为子表上引用父表记录 ID 的列设置为不允许为空。但是我无法在我的 HasMany 上找出正确的设置，这将允许 NHibernate 生成父记录 ID 并在子记录引用列中提供它。

因此，我最终得到“无法将 NULL 插入列......”错误。

因此，我在 Stackoverflow 上阅读了大量的问题/答案，并浏览了[Ayende Rehien](http://nhibernate.hibernatingrhinos.com/tags/tdd)和[Fluent 的 Wiki](https://github.com/jagregory/fluent-nhibernate/wiki/Getting-started)，并且我尝试了许多不同的设置都无济于事（即删除相反的、不同的级联选项..）。

目前我的实体看起来像这样：

```
 public class Product
 {
   public virtual int Id { get; set; }
   public virtual string Name { get; set; }
   public virtual IEnumerable<Attribute> Attributes { get; set; }
}

public class Attribute
{
    public virtual int Id { get; set; }
    public virtual Product Product { get; set; }
    public virtual IEnumerable<AttributeValue> Values { get; set; }
}

public class AttributeValue
{
    public virtual int Id { get; set; }
    public virtual Attribute Attribute { get; set; }
    public virtual string Value { get; set; }
} 
```

我的流利映射看起来像：

```
public class ProductMap : ClassMap<Product>
{
  public ProductMap()
  {
    Id(x => x.Id);
    Map(x => x.Name);
    Map(x => x.Description);
    HasMany(x => x.Attributes).Inverse().Cascade.All();
   }
 }

public class AttributeMap : ClassMap<Attribute>
{
    public AttributeMap()
    {
        Id(x => x.Id);
        Map(x => x.Name);
        References(x => x.Product);
        HasMany(x => x.Values).Inverse().Cascade.All();
    }
}

public class AttributeValueMap : ClassMap<AttributeValue>
{
    public AttributeValueMap()
    {
        Id(x => x.Id);
        Map(x => x.Value);
        References(x => x.Attribute);
    }
} 
```

我的 DB 架构设置为不允许 Attributes 和 AttributesValues 表上的引用列使用 null，但我尝试将其设置为 allow null，因为我已经读过它可以设置为返回并更新，但事实并非如此。

我无法找到为什么我不能保存子对象并让 Nhibernate 将父 ID 保存在引用的字段上。我见过很多例子，他们从来不需要设置外键，并在映射中引用它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:30:31.113

当然，我在阅读的第 16 篇文章中找到了答案，即我必须让数据库中的引用列允许 null = true 以及需要删除的 inverse 。当我在没有反向指定的情况下尝试测试时（不仅我没有清楚地理解此[答案](https://stackoverflow.com/questions/5235311/fluent-nhibernate-cascade-issue-trying-to-insert-null-id)中引用的内容），而且我的参考列也没有设置为允许空值。

# c - fopen 返回 null - Perror 打印无效参数

> ID：11182178
> 
> 赞同：2
> 
> 时间：2012-06-25T00:06:06.247
> 
> 标签：c, file-io

简单的 fopen 操作似乎不起作用。perror 返回 - 无效的参数。有什么问题。

我在 R: 中有一个名为 abc.dat 的 ascii 文件。

```
int main()
{
    FILE *f = fopen("R:\abc.dat","r");
    if(!f)
    {
        perror ("The following error occurred");

        return 1;
    }
} 
```

输出：

> 发生以下错误：参数无效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T00:07:51.360

逃离你的`\`. `\\`在字符串中使用时必须是。

```
FILE *f = fopen("R:\\abc.dat","r"); 
```

否则，该字符串被视为`fopen`包含`\a`“警报”转义序列，这是对其无效的参数。

常见的转义序列及其用途是：

```
\a  The speaker beeping
\\  The backslash character

\b  Backspace (move the cursor back, no erase)
\f  Form feed (eject printer page; ankh character on the screen)
\n  Newline, like pressing the Enter key
\r  Carriage return (moves the cursor to the beginning of the line)
\t  Tab
\v  Vertical tab (moves the cursor down a line)
\’  The apostrophe
\”  The double-quote character
\?  The question mark
\0  The “null” byte (backslash-zero)
\xnnn   A character value in hexadecimal (base 16)
\Xnnn   A character value in hexadecimal (base 16) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T00:08:03.483

您需要在文件名参数中转义反斜杠：

```
 FILE *f = fopen("R:\\abc.dat","r"); 
```

这是因为从字面上理解 - 未转义 -`\a`是一个*控制字符*，通常表示`bell`，即声音/显示系统警报；这是文件名中的无效字符。

参见[贝尔字符](http://en.wikipedia.org/wiki/Bell_character)：

> 在 C 编程语言（创建于 1972 年）中，钟字符可以用 \a 放在字符串或字符常量中。（'a' 代表 "alert" 或 "audible"，之所以选择它是因为 \b 已用于退格字符。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-25T00:08:15.060

您需要转义文件名中的反斜杠：

```
FILE *f = fopen("R:\\abc.dat", "r"); 
```

# php - PHP图像转换系统

> ID：11182179
> 
> 赞同：-4
> 
> 时间：2012-06-25T00:07:00.180
> 
> 标签：php, image, converter

如何用PHP编写一个图像转换系统，可以将上传的.jpeg、.png、.bmp或.gif文件转换成上传者给定的另一种类型。系统自动检测上传文件的类型，不能大于2MB？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:11:16.807

您可能应该[在 PHP 中使用 GD 和 Image 函数](http://docs.php.net/manual/en/ref.image.php)

将 png 转换为 jpeg（忽略透明度）的示例是

```
// Quality is a number between 0 (best compression,low quality) and 100 (best quality)
function png2jpg($originalFile, $outputFile, $quality) {
    $image = imagecreatefrompng($originalFile);
    imagejpeg($image, $outputFile, $quality);
    imagedestroy($image);
} 
```

此函数使用[GD 库中的 imagecreatefrompng() 和 imagejpeg() 函数。](http://docs.php.net/manual/en/book.image.php)

# android - 理解 Fragment 的 setRetainInstance(boolean)

> ID：11182180
> 
> 赞同：358
> 
> 时间：2012-06-25T00:07:02.283
> 
> 标签：android, android-fragments

从文档开始：

> 公共无效 setRetainInstance（布尔保留）
> 
> 控制是否在 Activity 重新创建期间（例如从配置更改）保留片段实例。这只能与不在后台堆栈中的片段一起使用。如果设置，片段生命周期将在重新创建活动时略有不同：
> 
> *   onDestroy() 将不会被调用（但 onDetach() 仍然会被调用，因为片段正在与其当前活动分离）。
> *   onCreate(Bundle) 不会被调用，因为片段没有被重新创建。
> *   onAttach(Activity) 和 onActivityCreated(Bundle) 仍将被调用。

我有一些疑问：

*   片段是否也保留其视图，或者会在配置更改时重新创建？“保留”究竟是什么意思？

*   当用户离开activity时，fragment会被销毁吗？

*   为什么它不适用于后堆栈上的片段？

*   在哪些用例中使用此方法有意义？

* * *

## 回答 #1

> 赞同：361
> 
> 时间：2012-07-03T20:48:00.317

首先，查看[**我**](http://www.androiddesignpatterns.com/2013/04/retaining-objects-across-config-changes.html)关于保留片段的帖子。它可能会有所帮助。

现在回答你的问题：

> 片段是否还保留其~~视图~~状态，或者会在配置更改时重新创建 - 究竟什么是“保留”？

是的，`Fragment`的状态将在配置更改期间保留。具体来说，“保留”意味着片段*不会*在配置更改时被销毁。也就是说，即使配置更改导致底层被破坏，`Fragment`也会*保留。*`Activity`

> 当用户离开activity时，fragment会被销毁吗？

就像`Activity`s一样，`Fragment`s可能会在内存资源不足的时候被系统销毁。无论您是否让您的片段在配置更改中保留其实例状态，都不会影响系统是否会在`Fragment`您离开`Activity`. 如果您离开`Activity`（即按主页按钮），`Fragment`s 可能会或可能不会被破坏。如果您`Activity`通过按后退按钮离开 （因此，调用`finish()`并有效地销毁`Activity`），所有`Activity`附加`Fragment`的 s 也将被销毁。

> 为什么它不适用于后堆栈上的片段？

不支持它可能有多种原因，但对我来说最明显的原因是`Activity`持有对 的引用`FragmentManager`，并且`FragmentManager`管理后台堆栈。也就是说，无论您是否选择保留您`Fragment`的 s ，`Activity`（以及因此`FragmentManager`的 后堆栈）都将在配置更改时被销毁。它可能不起作用的另一个原因是，如果允许保留片段*和*非保留片段都存在于同一个 backstack 上，事情可能会变得棘手。

> 在哪些用例中使用此方法有意义？

保留的片段对于跨活动实例传播状态信息（尤其是线程管理）非常有用。例如，片段可以作为`Thread`或的实例的主机`AsyncTask`，管理其操作。有关更多信息，请参阅我关于此主题的[**博客文章。**](http://www.androiddesignpatterns.com/2013/04/retaining-objects-across-config-changes.html)

一般来说，我会将它`onConfigurationChanged`与使用`Activity`...类似地对待它，不要仅仅因为您太懒而无法正确实现/处理方向更改而将其用作创可贴。仅在需要时使用它。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-09-06T05:27:17.647

`setRetaininstance`仅当您`activity`由于配置更改而被销毁和重新创建时才有用，因为实例是在调用`onRetainNonConfigurationInstance`. 也就是说，如果您旋转设备，保留的片段将保留在那里（它们不会被破坏和重新创建。）但是当运行时终止活动以回收资源时，什么都不会留下。当您按下后退按钮并退出活动时，一切都被破坏了。

通常我使用这个功能来保存方向更改时间。假设我从服务器下载了一堆位图，每个是 1MB，当用户不小心旋转他的设备时，我当然不想再做所有的下载工作。所以我创建了一个`Fragment`保存我的位图并将其添加到管理器并调用`setRetainInstance`，即使屏幕方向发生变化，所有位图仍然存在。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-01-15T14:23:58.757

SetRetainInstance(true) 允许片段生存。其成员将在轮换等配置更改期间保留。但是当活动在后台被杀死时，它仍然可能被杀死。如果后台的包含活动被系统杀死，它的 instanceState 应该由您正确处理 onSaveInstanceState 的系统保存。换句话说，onSaveInstanceState 将始终被调用。虽然如果 SetRetainInstance 为 true 并且片段/活动尚未被杀死，则不会调用 onCreateView，但如果它被杀死并被尝试恢复，它仍然会被调用。

以下是对android活动/片段的一些分析，希望对您有所帮助。 [http://ideaventure.blogspot.com.au/2014/01/android-activityfragment-life-cycle.html](http://ideaventure.blogspot.com.au/2014/01/android-activityfragment-life-cycle.html)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-03-28T21:35:03.800

## setRetainInstance() - 已弃用

作为片段[版本 1.3.0-alpha01](https://developer.android.com/jetpack/androidx/releases/fragment#1.3.0-alpha01)

> 片段上的 setRetainInstance() 方法已被弃用。随着 ViewModel 的引入，开发人员可以使用特定的 API 来保留可以与活动、片段和导航图相关联的状态。这允许开发人员使用正常的、未保留的 Fragment 并将他们想要保留的特定状态分开，避免常见的泄漏源，同时保持保留状态的单个创建和销毁的有用属性（即 ViewModel 的构造函数以及它收到的 onCleared() 回调）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-03T08:44:51.747

[setRetainInstance(boolean)](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance(boolean))当你想要一些不依赖于 Activity 生命周期的组件时很有用。例如，[rxloader](https://github.com/evant/rxloader)使用这种技术来“为 rxjava 的 Observable 处理 Android 的活动生命周期”（我在[这里](https://www.reddit.com/r/androiddev/comments/2sq814/rx_java_and_android_lifecycle/cns48fx)找到了）。

# macos - Mac App Store 图标大小（plist 要求）

> ID：11182182
> 
> 赞同：2
> 
> 时间：2012-06-25T00:07:59.640
> 
> 标签：macos

我很难找到 Mac 应用商店的图标大小要求以及如何在 plist 中设置这些要求。有人可以帮我列出这些吗？

我尝试查看 Apple 的文档，但他们一直将我引向 iOS，这增加了我的困惑。

# asp.net-mvc-3 - Asp.NET MVC3 中文件的 URL 重定向？（饲料燃烧器）

> ID：11182186
> 
> 赞同：1
> 
> 时间：2012-06-25T00:08:14.390
> 
> 标签：asp.net-mvc-3, url-rewriting, feedburner, url-redirection

我在 XML 文件中设置了一个播客源，我当前的订阅者使用直接文件 URL 订阅它。（所以[http://website.com/feed.xml](http://website.com/feed.xml)）我一直在阅读有关如何使用 FeedBurner 设置该 XML 文件的副本，强制在 FeedBurner 文件上进行所有未来更新，然后设置从旧的 XML url 重定向到新的 FeedBurner URL，以跟踪订阅者（我的主要目标）。

[http://underscorebleach.net/jotsheet/2005/07/feedburner-rss-migration](http://underscorebleach.net/jotsheet/2005/07/feedburner-rss-migration)

不幸的是，我在这个主题上看到的所有教程都假设我有一个 Apache 服务器并且我可以修改 .htaccess 文件，所以我一直在摸索在我的 MVC3 网站上获得相同结果的方法。

到目前为止，我尝试了 2 种不同的方法：

在我的 Web.config 的“system.webServer”部分添加 url 重写规则

```
<rewrite>
  <rules>
    <rule name="feedburner redirect" enabled="true" stopProcessing="true">
      <match url="feed.xml" ignoreCase="true" />
      <action type="Redirect" url="http://feeds.feedburner.com/NewFeed" appendQueryString="false" />
      <conditions logicalGrouping="MatchAll">
        <add input="{HTTP_USER_AGENT}" pattern="FeedBurner" negate="true" />
      </conditions>
    </rule>
  </rules>
</rewrite> 
```

这不起作用，我还在 Visual Studio 中收到关于“rewrite”元素如何不是“system.webServer”的有效子元素的警告，所以我不确定这是否是正确的实现，但是这就是我看到的其他示例的编写方式。

我尝试过的另一种方法是创建一个路由，如果对旧 URL 发出请求，该路由会将 HTTP 响应更改为 301 重定向到新的 FeedBurner URL。

网址路由类：

```
namespace Routes
{
    public class UrlRoute : RouteBase
    {
        public static void RerouteUrls()
        {
            var httpContext = HttpContext.Current;
            string redirectLocation = "";

            const string status = "301 Moved Permanently";

            string currentUrl = httpContext.Request.Url.ToString().ToLower();

            if (currentUrl.Contains("feed.xml"))
            {
                redirectLocation = "http://feeds.feedburner.com/NewFeed";
            }
            else
            {
                // None of the criteria was met; do not redirect user.
                return;
            }

            // Redirect page
            httpContext.Response.Clear();
            httpContext.Response.RedirectLocation = redirectLocation;
            httpContext.Response.StatusCode = 301;
            httpContext.Response.Status = status;
            httpContext.Response.End();
        }

        public override RouteData GetRouteData(HttpContextBase httpContext)
        {
            RerouteUrls();

            return null;
        }

        public override VirtualPathData GetVirtualPath(RequestContext requestContext,
                                                   RouteValueDictionary values)
        {
            return null;
        }
    }
} 
```

在 Global.asax 中：

```
public static void RegisterRoutes(RouteCollection routes)
{
    //...

    routes.Add(new Routes.UrlRoute());

    //...
}

protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    RegisterRoutes(RouteTable.Routes);

    Database.SetInitializer<EF4DataContext>(null);
} 
```

但同样，直接在地址栏中输入“feed.xml”会显示旧的 XML 文件，并且 URL 不会改变。

我还看到了很多关于设置重定向到新操作的新控制器操作的建议，但在这种情况下，它只是一个文件，而不是视图操作或网页，所以我认为这不适用于这里。

任何有关此主题的指导将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T02:58:58.923

想通了...我没有解释 URL 重写规则的“条件”部分。当我希望重定向对旧提要文件的所有请求时，它将重写规则仅限于来自 FeedBurner 的请求。所以我只需要删除该部分。我只剩下这个：

```
<rewrite>
    <rules>
        <rule name="feedburner redirect" enabled="true" stopProcessing="true">
            <match url="feed.xml" ignoreCase="true" />
            <action type="Redirect" url="http://feeds.feedburner.com/NewFeed" appendQueryString="false" />
        </rule>
    </rules>
</rewrite> 
```

# php - 从 Instagram 获取所有带有 PHP 特定主题标签的照片

> ID：11182191
> 
> 赞同：30
> 
> 时间：2012-06-25T00:09:02.783
> 
> 标签：php, hashtag, instagram

我需要使用 PHP 获取一些具有特定主题标签的图片吗？任何帮助都会很棒，或者提示？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-27T07:23:15.770

这是我不久前写的另一个例子：

```
<?php       
    // Get class for Instagram
    // More examples here: https://github.com/cosenary/Instagram-PHP-API
    require_once 'instagram.class.php';

    // Initialize class with client_id
    // Register at http://instagram.com/developer/ and replace client_id with your own
    $instagram = new Instagram('CLIENT_ID_HERE');

    // Set keyword for #hashtag
    $tag = 'KEYWORD HERE';

    // Get latest photos according to #hashtag keyword
    $media = $instagram->getTagMedia($tag);

    // Set number of photos to show
    $limit = 5;

    // Set height and width for photos
    $size = '100';

    // Show results
    // Using for loop will cause error if there are less photos than the limit
    foreach(array_slice($media->data, 0, $limit) as $data)
    {
        // Show photo
        echo '<p><img src="'.$data->images->thumbnail->url.'" height="'.$size.'" width="'.$size.'" alt="SOME TEXT HERE"></p>';
    }
?> 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-25T00:16:01.510

instagram 公共 API 的标签部分可以帮助您做到这一点。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-07-31T09:38:29.727

如果您只需要基于标签显示图像，则无需包含包装类“instagram.class.php”。由于 Instagram API 中的媒体和标签端点不需要身份验证。您可以使用以下基于 curl 的函数根据您的标签检索结果。

```
 function callInstagram($url)
    {
    $ch = curl_init();
    curl_setopt_array($ch, array(
    CURLOPT_URL => $url,
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_SSL_VERIFYPEER => false,
    CURLOPT_SSL_VERIFYHOST => 2
    ));

    $result = curl_exec($ch);
    curl_close($ch);
    return $result;
    }

    $tag = 'YOUR_TAG_HERE';
    $client_id = "YOUR_CLIENT_ID";
    $url = 'https://api.instagram.com/v1/tags/'.$tag.'/media/recent?client_id='.$client_id;

    $inst_stream = callInstagram($url);
    $results = json_decode($inst_stream, true);

    //Now parse through the $results array to display your results... 
    foreach($results['data'] as $item){
        $image_link = $item['images']['low_resolution']['url'];
        echo '<img src="'.$image_link.'" />';
    } 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2016-06-27T09:02:20.110

自 2015 年 11 月 17 日起，您必须对用户进行身份验证才能发出任何请求（甚至例如“获取一些具有特定主题标签的图片”）请求。请参阅[Instagram 平台变更日志](https://www.instagram.com/developer/changelog/)：

> 2015 年 11 月 17 日或之后创建的应用程序：所有 API 端点都需要有效的 access_token。2015 年 11 月 17 日之前创建的应用程序：在 2016 年 6 月 1 日之前不受新 API 行为的影响。

这使得现在在 2016 年 6 月 1 日之前在这里给出的所有答案都不再有用。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2016-06-22T19:59:41.897

我已经设置了一个 php 代码，如果您想根据标签访问没有 api 的 Instagram 图像，它可以提供帮助

[Instagram标签图像的PHP代码](https://github.com/AH72KING/Instagram-scraping/blob/master/instagram_hashtag_images.php)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-05-20T13:52:21.413

要获得超过 20 个，您可以使用加载更多按钮。

**索引.php**

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Instagram more button example</title>
  <!--
    Instagram PHP API class @ Github
    https://github.com/cosenary/Instagram-PHP-API
  -->
  <style>
    article, aside, figure, footer, header, hgroup, 
    menu, nav, section { display: block; }
    ul {
      width: 950px;
    }
    ul > li {
      float: left;
      list-style: none;
      padding: 4px;
    }
    #more {
      bottom: 8px;
      margin-left: 80px;
      position: fixed;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
    }
  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#more').click(function() {
        var tag   = $(this).data('tag'),
            maxid = $(this).data('maxid');

        $.ajax({
          type: 'GET',
          url: 'ajax.php',
          data: {
            tag: tag,
            max_id: maxid
          },
          dataType: 'json',
          cache: false,
          success: function(data) {
            // Output data
            $.each(data.images, function(i, src) {
              $('ul#photos').append('<li><img src="' + src + '"></li>');
            });

            // Store new maxid
            $('#more').data('maxid', data.next_id);
          }
        });
      });
    });
  </script>
</head>
<body>

<?php
  /**
   * Instagram PHP API
   */

   require_once 'instagram.class.php';

    // Initialize class with client_id
    // Register at http://instagram.com/developer/ and replace client_id with your own
    $instagram = new Instagram('ENTER CLIENT ID HERE');

    // Get latest photos according to geolocation for Växjö
    // $geo = $instagram->searchMedia(56.8770413, 14.8092744);

    $tag = 'sweden';

    // Get recently tagged media
    $media = $instagram->getTagMedia($tag);

    // Display first results in a <ul>
    echo '<ul id="photos">';

    foreach ($media->data as $data) 
    {
        echo '<li><img src="'.$data->images->thumbnail->url.'"></li>';
    }
    echo '</ul>';

    // Show 'load more' button
    echo '<br><button id="more" data-maxid="'.$media->pagination->next_max_id.'" data-tag="'.$tag.'">Load more ...</button>';
?>

</body>
</html> 
```

**ajax.php**

```
<?php
    /**
     * Instagram PHP API
     */

     require_once 'instagram.class.php';

      // Initialize class for public requests
      $instagram = new Instagram('ENTER CLIENT ID HERE');

      // Receive AJAX request and create call object
      $tag = $_GET['tag'];
      $maxID = $_GET['max_id'];
      $clientID = $instagram->getApiKey();

      $call = new stdClass;
      $call->pagination->next_max_id = $maxID;
      $call->pagination->next_url = "https://api.instagram.com/v1/tags/{$tag}/media/recent?client_id={$clientID}&max_tag_id={$maxID}";

      // Receive new data
      $media = $instagram->getTagMedia($tag,$auth=false,array('max_tag_id'=>$maxID));

      // Collect everything for json output
      $images = array();
      foreach ($media->data as $data) {
        $images[] = $data->images->thumbnail->url;
      }

      echo json_encode(array(
        'next_id' => $media->pagination->next_max_id,
        'images'  => $images
      ));
?> 
```

**instagram.class.php**

找到函数 getTagMedia() 并替换为：

```
public function getTagMedia($name, $auth=false, $params=null) {
    return $this->_makeCall('tags/' . $name . '/media/recent', $auth, $params);
} 
```

# java - 如何从一个端口为 Jetty 提供 https 和 http？

> ID：11182192
> 
> 赞同：17
> 
> 时间：2012-06-25T00:09:08.043
> 
> 标签：java, http, https, jetty, port

（我知道这是一个重复的问题，但最初的发帖人是出于错误的原因提出的。我并不是在暗示我是出于*正确*的原因提出的，但让我们看看。）

我们有一个在非标准端口号上运行的 Web 服务。尽管用户似乎能够记住端口号，但有时他们会错误地键入 http: 而不是 https:。有人问我们是否可以在该端口上提供 HTTP，然后将它们重定向到同一端口上的 HTTPS。这听起来很邪恶......我喜欢可用性，但感觉也许它应该是浏览器的工作来做到这一点？

我见过的一个解决方案是“在 Jetty 前面编写自己的代理”。这个解决方案会起作用，但我认为它不会很好用，因为我不相信我可以编写一个与 Jetty 本身一样高效的代理。另外，即使代理本身是高效的，所有数据仍然需要额外的一跳，这保证无论如何都会减慢流量。

还有比这更好的方法吗？也许 Jetty 本身有一些地方可以嵌入协议检测逻辑，这将允许利用它们的速度，同时还可以消除代理会引入的额外跃点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-25T01:07:32.723

**更新：有关如何将单个端口重定向到 HTTPS 和 HTTP 侦听器的说明，请参阅[此答案。](https://stackoverflow.com/a/24891007/552792)如果出于某种原因您不使用该解决方案，请参见下文：**

~~不可能在同一端口上同时传输来自 http 和 https 的流量。Jetty 使用两个完全不同的连接器来绑定到安全和非安全端口。事实上，我遇到的每个 Web 服务器都将这两个协议绑定到两个完全独立的端口。~~

出于可用性考虑，我建议的一件事是使用默认端口，这完全对用户隐藏了端口。默认情况下 http 使用端口 80，默认情况下 https 使用端口 443。因此，如果您将连接器配置为分别在端口 80 和端口 443 上运行，那么您的用户不必键入端口，您的开发团队也不需要必须处理在 HTML、CSS、JavaScript 和其他资源的绝对路径中包含端口号。

Jetty 被设计成一个独立的 Web 服务器，与**旧版本的 Tomcat**不同，Apache 建议在 Apache HTTP 服务器后面运行它。因此，只要您没有其他 HTTP 服务器在运行，并且使用了这些端口，您就可以将 Jetty 配置为在默认端口上运行而不会出现任何问题。**这来自经验。我们正是以这种方式运行 Jetty。**

最后，一个协议可以绑定到多个端口。因此，如果您当前在端口 8080 上运行 Jetty 用于 http 和 8443 用于 https，您可以保持这些连接器处于活动状态并为端口 80 和端口 443 添加另外两个连接器。这为您的应用程序部分启用了向后兼容性使用端口号，让您有时间继续前进。

```
<!-- Legacy HTTP connector -->
<Call name="addConnector">
  <Arg>
      <New class="org.mortbay.jetty.nio.SelectChannelConnector">
        <Set name="host"><SystemProperty name="jetty.host" /></Set>
        <Set name="port"><SystemProperty name="jetty.port" default="8080"/></Set>
        <Set name="maxIdleTime">30000</Set>
        <Set name="Acceptors">2</Set>
        <Set name="statsOn">false</Set>
        <Set name="confidentialPort">8443</Set>
        <Set name="lowResourcesConnections">5000</Set>
        <Set name="lowResourcesMaxIdleTime">5000</Set>
      </New>
  </Arg>
</Call>
<!-- Second connector for http on port 80 -->
<Call name="addConnector">
  <Arg>
      <New class="org.mortbay.jetty.nio.SelectChannelConnector">
        <Set name="host"><SystemProperty name="jetty.host" /></Set>
        <Set name="port"><SystemProperty name="jetty.port" default="80"/></Set>
        <Set name="maxIdleTime">30000</Set>
        <Set name="Acceptors">2</Set>
        <Set name="statsOn">false</Set>
        <Set name="confidentialPort">8443</Set>
        <Set name="lowResourcesConnections">5000</Set>
        <Set name="lowResourcesMaxIdleTime">5000</Set>
      </New>
  </Arg>
</Call>

<!-- Legacy SSL Connector for https port 8443 -->
<Call name="addConnector">
 <Arg>
  <New class="org.mortbay.jetty.security.SslSocketConnector">
    <Set name="Port">8443</Set>
    <Set name="maxIdleTime">30000</Set>
    <Set name="handshakeTimeout">2000</Set>
    <Set name="keystore"><SystemProperty name="jetty.home" default="." />/etc/keystore</Set>
    <Set name="password">xxxxxx</Set>
    <Set name="keyPassword">xxxxxx</Set>
    <Set name="truststore"><SystemProperty name="jetty.home" default="." />/etc/keystore</Set>
    <Set name="trustPassword">OBF:xxxxx</Set>
    <Set name="handshakeTimeout">2000</Set>
    <!-- Set name="ThreadPool">
      <New class="org.mortbay.thread.BoundedThreadPool">
        <Set name="minThreads">10</Set>
        <Set name="maxThreads">250</Set>
     </New>
    </Set -->
  </New>
 </Arg>
</Call>

<!-- Default SSL Connector for https port 443 -->
<Call name="addConnector">
 <Arg>
  <New class="org.mortbay.jetty.security.SslSocketConnector">
    <Set name="Port">443</Set>
    <Set name="maxIdleTime">30000</Set>
    <Set name="handshakeTimeout">2000</Set>
    <Set name="keystore"><SystemProperty name="jetty.home" default="." />/etc/keystore</Set>
    <Set name="password">xxxxxx</Set>
    <Set name="keyPassword">xxxxxx</Set>
    <Set name="truststore"><SystemProperty name="jetty.home" default="." />/etc/keystore</Set>
    <Set name="trustPassword">OBF:xxxxx</Set>
    <Set name="handshakeTimeout">2000</Set>
    <!-- Set name="ThreadPool">
      <New class="org.mortbay.thread.BoundedThreadPool">
        <Set name="minThreads">10</Set>
        <Set name="maxThreads">250</Set>
     </New>
    </Set -->
  </New>
 </Arg>
</Call> 
```

对于第 2 和第 4 连接器，唯一真正的区别是端口号。简而言之，您可以为每个连接器/协议配置多个端口，但不能为同一端口配置多个协议/连接器。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-07-22T15:05:47.000

**更新**：从 jetty-9.4.15.v20190215 起，Jetty 内置了对端口统一的支持；看到[这个答案](https://stackoverflow.com/a/54915462/394431)。

# 我们可以

这是可能的，我们已经做到了。这里的代码适用于 Jetty 8；我没有用 Jetty 9 测试过，但是[这个答案](https://stackoverflow.com/a/40076056/394431)有类似的 Jetty 9 代码。

顺便说一句，这被称为*端口统一，而且很明显，* [Glassfish](http://antwerkz.com/port-unification-in-glassfish-3-part-1/)使用[Grizzly](https://grizzly.java.net/portunification.html)很早就支持它。

## 大纲

基本思想是产生一个`org.eclipse.jetty.server.Connector`可以提前查看客户端请求的第一个字节的实现。幸运的是，HTTP 和 HTTPS 都让客户端开始通信。对于 HTTPS（通常是 TLS/SSL），第一个字节将是`0x16`(TLS) 或`>= 0x80`(SSLv2)。对于 HTTP，第一个字节将是旧的可打印 7 位 ASCII。现在，根据第一个字节，`Connector`将产生 SSL 连接或普通连接。

在这里的代码中，我们利用了 Jetty`SslSelectChannelConnector`本身 extends的事实`SelectChannelConnector`，并且有一个`newPlainConnection()`方法（调用它的超类来产生一个非 SSL 连接）以及一个`newConnection()`方法（产生一个 SSL 连接）。因此，我们的 new`Connector`可以在观察到来自客户端的第一个字节后扩展`SslSelectChannelConnector`并委托给其中一个方法。

不幸的是，我们需要在第一个字节可用`AsyncConnection` *之前创建一个实例。*该实例的某些方法甚至可能在第一个字节可用之前被调用。因此，我们创建了一个`LazyConnection implements AsyncConnection`它，它可以在以后确定它将委托给哪种连接，甚至在它知道之前将合理的默认响应返回给某些方法。

基于 NIO，我们`Connector`将使用`SocketChannel`. 幸运的是，我们可以扩展`SocketChannel`创建一个`ReadAheadSocketChannelWrapper`委托给“真实”`SocketChannel`但可以检查和存储客户端消息的第一个字节。

## 一些细节

一个非常hacky的位。我们`Connector`必须重写的方法之一是`customize(Endpoint,Request)`. 如果我们最终得到一个基于 SSL 的，`Endpoint`我们可以传递给我们的超类；否则超类将抛出一个`ClassCastException`，但只有在传递给*它的*超类*并*在`Request`. 所以我们传递给超类，但是当我们看到异常时撤消设置方案。

我们还覆盖`isConfidential()`并`isIntegral()`确保我们的 servlet 可以正确使用`HttpServletRequest.isSecure()`来确定是否使用了 HTTP 或 HTTPS。

尝试从客户端读取第一个字节可能会抛出一个，但我们可能不得不在一个不期望`IOException`出现的地方尝试这样做，在这种情况下，我们会保留异常并稍后抛出它。`IOException`

在 Java >= 7 和 Java 6 中扩展`SocketChannel`看起来不同。在后一种情况下，只需注释掉 Java 6`SocketChannel`没有的方法。

## 编码

```
public class PortUnificationSelectChannelConnector extends SslSelectChannelConnector {
    public PortUnificationSelectChannelConnector() {
        super();
    }

    public PortUnificationSelectChannelConnector(SslContextFactory sslContextFactory) {
        super(sslContextFactory);
    }

    @Override
    protected SelectChannelEndPoint newEndPoint(SocketChannel channel, SelectSet selectSet, SelectionKey key) throws IOException {
        return super.newEndPoint(new ReadAheadSocketChannelWrapper(channel, 1), selectSet, key);
    }

    @Override
    protected AsyncConnection newConnection(SocketChannel channel, AsyncEndPoint endPoint) {
        return new LazyConnection((ReadAheadSocketChannelWrapper)channel, endPoint);
    }

    @Override
    public void customize(EndPoint endpoint, Request request) throws IOException {
        String scheme = request.getScheme();
        try {
            super.customize(endpoint, request);
        } catch (ClassCastException e) {
            request.setScheme(scheme);
        }
    }

    @Override
    public boolean isConfidential(Request request) {
        if (request.getAttribute("javax.servlet.request.cipher_suite") != null) return true;
        else return isForwarded() && request.getScheme().equalsIgnoreCase(HttpSchemes.HTTPS);
    }

    @Override
    public boolean isIntegral(Request request) {
        return isConfidential(request);
    }

    class LazyConnection implements AsyncConnection {
        private final ReadAheadSocketChannelWrapper channel;
        private final AsyncEndPoint endPoint;
        private final long timestamp;
        private AsyncConnection connection;

        public LazyConnection(ReadAheadSocketChannelWrapper channel, AsyncEndPoint endPoint) {
            this.channel = channel;
            this.endPoint = endPoint;
            this.timestamp = System.currentTimeMillis();
            this.connection = determineNewConnection(channel, endPoint, false);
        }

        public Connection handle() throws IOException {
            if (connection == null) {
                connection = determineNewConnection(channel, endPoint, false);
                channel.throwPendingException();
            }
            if (connection != null) return connection.handle();
            else return this;
        }

        public long getTimeStamp() {
            return timestamp;
        }

        public void onInputShutdown() throws IOException {
            if (connection == null) connection = determineNewConnection(channel, endPoint, true);
            connection.onInputShutdown();
        }

        public boolean isIdle() {
            if (connection == null) connection = determineNewConnection(channel, endPoint, false);
            if (connection != null) return connection.isIdle();
            else return false;
        }

        public boolean isSuspended() {
            if (connection == null) connection = determineNewConnection(channel, endPoint, false);
            if (connection != null) return connection.isSuspended();
            else return false;
        }

        public void onClose() {
            if (connection == null) connection = determineNewConnection(channel, endPoint, true);
            connection.onClose();
        }

        public void onIdleExpired(long l) {
            if (connection == null) connection = determineNewConnection(channel, endPoint, true);
            connection.onIdleExpired(l);
        }

        AsyncConnection determineNewConnection(ReadAheadSocketChannelWrapper channel, AsyncEndPoint endPoint, boolean force) {
            byte[] bytes = channel.getBytes();
            if ((bytes == null || bytes.length == 0) && !force) return null;
            if (looksLikeSsl(bytes)) {
                return PortUnificationSelectChannelConnector.super.newConnection(channel, endPoint);
            } else {
                return PortUnificationSelectChannelConnector.super.newPlainConnection(channel, endPoint);
            }
        }

        // TLS first byte is 0x16
        // SSLv2 first byte is >= 0x80
        // HTTP is guaranteed many bytes of ASCII
        private boolean looksLikeSsl(byte[] bytes) {
            if (bytes == null || bytes.length == 0) return false; // force HTTP
            byte b = bytes[0];
            return b >= 0x7F || (b < 0x20 && b != '\n' && b != '\r' && b != '\t');
        }
    }

    static class ReadAheadSocketChannelWrapper extends SocketChannel {
        private final SocketChannel channel;
        private final ByteBuffer start;
        private byte[] bytes;
        private IOException pendingException;
        private int leftToRead;

        public ReadAheadSocketChannelWrapper(SocketChannel channel, int readAheadLength) throws IOException {
            super(channel.provider());
            this.channel = channel;
            start = ByteBuffer.allocate(readAheadLength);
            leftToRead = readAheadLength;
            readAhead();
        }

        public synchronized void readAhead() throws IOException {
            if (leftToRead > 0) {
                int n = channel.read(start);
                if (n == -1) {
                    leftToRead = -1;
                } else {
                    leftToRead -= n;
                }
                if (leftToRead <= 0) {
                    start.flip();
                    bytes = new byte[start.remaining()];
                    start.get(bytes);
                    start.rewind();
                }
            }
        }

        public byte[] getBytes() {
            if (pendingException == null) {
                try {
                    readAhead();
                } catch (IOException e) {
                    pendingException = e;
                }
            }
            return bytes;
        }

        public void throwPendingException() throws IOException {
            if (pendingException != null) {
                IOException e = pendingException;
                pendingException = null;
                throw e;
            }
        }

        private int readFromStart(ByteBuffer dst) throws IOException {
            int sr = start.remaining();
            int dr = dst.remaining();
            if (dr == 0) return 0;
            int n = Math.min(dr, sr);
            dst.put(bytes, start.position(), n);
            start.position(start.position() + n);
            return n;
        }

        public synchronized int read(ByteBuffer dst) throws IOException {
            throwPendingException();
            readAhead();
            if (leftToRead > 0) return 0;
            int sr = start.remaining();
            if (sr > 0) {
                int n = readFromStart(dst);
                if (n < sr) return n;
            }
            return sr + channel.read(dst);
        }

        public synchronized long read(ByteBuffer[] dsts, int offset, int length) throws IOException {
            throwPendingException();
            if (offset + length > dsts.length || length < 0 || offset < 0) {
                throw new IndexOutOfBoundsException();
            }
            readAhead();
            if (leftToRead > 0) return 0;
            int sr = start.remaining();
            int newOffset = offset;
            if (sr > 0) {
                int accum = 0;
                for (; newOffset < offset + length; newOffset++) {
                    accum += readFromStart(dsts[newOffset]);
                    if (accum == sr) break;
                }
                if (accum < sr) return accum;
            }
            return sr + channel.read(dsts, newOffset, length - newOffset + offset);
        }

        public int hashCode() {
            return channel.hashCode();
        }

        public boolean equals(Object obj) {
            return channel.equals(obj);
        }

        public String toString() {
            return channel.toString();
        }

        public Socket socket() {
            return channel.socket();
        }

        public boolean isConnected() {
            return channel.isConnected();
        }

        public boolean isConnectionPending() {
            return channel.isConnectionPending();
        }

        public boolean connect(SocketAddress remote) throws IOException {
            return channel.connect(remote);
        }

        public boolean finishConnect() throws IOException {
            return channel.finishConnect();
        }

        public int write(ByteBuffer src) throws IOException {
            return channel.write(src);
        }

        public long write(ByteBuffer[] srcs, int offset, int length) throws IOException {
            return channel.write(srcs, offset, length);
        }

        @Override
        protected void implCloseSelectableChannel() throws IOException {
            channel.close();
        }

        @Override
        protected void implConfigureBlocking(boolean block) throws IOException {
            channel.configureBlocking(block);
        }

//        public SocketAddress getLocalAddress() throws IOException {
//            return channel.getLocalAddress();
//        }
//
//        public <T> T getOption(java.net.SocketOption<T> name) throws IOException {
//            return channel.getOption(name);
//        }
//
//        public Set<java.net.SocketOption<?>> supportedOptions() {
//            return channel.supportedOptions();
//        }
//
//        public SocketChannel bind(SocketAddress local) throws IOException {
//            return channel.bind(local);
//        }
//
//        public SocketAddress getRemoteAddress() throws IOException {
//            return channel.getRemoteAddress();
//        }
//
//        public <T> SocketChannel setOption(java.net.SocketOption<T> name, T value) throws IOException {
//            return channel.setOption(name, value);
//        }
//
//        public SocketChannel shutdownInput() throws IOException {
//            return channel.shutdownInput();
//        }
//
//        public SocketChannel shutdownOutput() throws IOException {
//            return channel.shutdownOutput();
//        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-16T22:15:21.347

基于答案“是的，我们可以”，我构建了适用于当前码头 9.3.11 的代码，我认为有些人会感兴趣。

```
import java.io.IOException;
import java.net.InetSocketAddress;
import java.nio.ByteBuffer;
import java.nio.channels.ReadPendingException;
import java.nio.channels.WritePendingException;
import org.eclipse.jetty.util.Callback;
import org.eclipse.jetty.io.Connection;
import org.eclipse.jetty.io.EndPoint;

public class MyReadAheadEndpoint implements EndPoint {
/** real endpoint we are wrapping    */ private final EndPoint endPoint;
/** buffer used to read start bytes  */ private final ByteBuffer start     ;
/** how many N start bytes to read   */ private       int        leftToRead;
/** first  N bytes                   */ private final byte[]     bytes     ;
/** buffered exception to throw next */ private IOException pendingException = null;
@Override public InetSocketAddress getLocalAddress            () { return endPoint.getLocalAddress(); }
@Override public InetSocketAddress getRemoteAddress           () { return endPoint.getRemoteAddress(); }
@Override public boolean           isOpen                     () { return endPoint.isOpen(); }
@Override public long              getCreatedTimeStamp        () { return endPoint.getCreatedTimeStamp(); }
@Override public boolean           isOutputShutdown           () { return endPoint.isOutputShutdown(); }
@Override public boolean           isInputShutdown            () { return endPoint.isInputShutdown(); }
@Override public void              shutdownOutput             () { endPoint.shutdownOutput(); }
@Override public void              close                      () { endPoint.close(); }
@Override public Object            getTransport               () { return endPoint.getTransport(); }
@Override public long              getIdleTimeout             () { return endPoint.getIdleTimeout(); }
@Override public Connection        getConnection              () { return endPoint.getConnection(); }
@Override public void              onOpen                     () { endPoint.onOpen(); }
@Override public void              onClose                    () { endPoint.onClose(); }
@Override public boolean           isOptimizedForDirectBuffers() { return endPoint.isOptimizedForDirectBuffers(); }
@Override public boolean           isFillInterested           () { return endPoint.isFillInterested(); }
@Override public boolean           flush                      (final ByteBuffer... v) throws IOException { return endPoint.flush(v); }
@Override public void              setIdleTimeout             (final long          v) { endPoint.setIdleTimeout(v); }
@Override public void              write                      (final Callback      v, final ByteBuffer... b) throws WritePendingException { endPoint.write(v, b); }
@Override public void              setConnection              (final Connection    v) { endPoint.setConnection(v); }
@Override public void              upgrade                    (final Connection    v) { endPoint.upgrade(v); }
@Override public void              fillInterested  (final Callback   v) throws ReadPendingException { endPoint.fillInterested(v); }
@Override public int               hashCode() { return endPoint.hashCode(); }
@Override public boolean           equals(final Object obj) { return endPoint.equals(obj); }
@Override public String            toString() { return endPoint.toString(); }
public byte[] getBytes() { if (pendingException == null) { try { readAhead(); } catch (final IOException e) { pendingException = e; } } return bytes; }
private void throwPendingException() throws IOException { if (pendingException != null) { final IOException e = pendingException; pendingException = null; throw e; } }

public MyReadAheadEndpoint(final EndPoint channel, final int readAheadLength){
    this.endPoint = channel;
    start = ByteBuffer.wrap(bytes = new byte[readAheadLength]);
    start.flip();
    leftToRead = readAheadLength;
}

private synchronized void readAhead() throws IOException {
    if (leftToRead > 0) {
        final int n = endPoint.fill(start);
        if (n == -1) { leftToRead = -1; }
        else         {  leftToRead -= n; }
        if (leftToRead <= 0) start.rewind();
    }
}

private int readFromStart(final ByteBuffer dst) throws IOException {
    final int n = Math.min(dst.remaining(), start.remaining());
    if (n > 0)  {
        dst.put(bytes, start.position(), n);
        start.position(start.position() + n);
        dst.flip();
    }
    return n;
}

@Override public synchronized int fill(final ByteBuffer dst) throws IOException {
    throwPendingException();
    if (leftToRead > 0) readAhead();
    if (leftToRead > 0) return 0;
    final int sr = start.remaining();
    if (sr > 0) {
        dst.compact();
        final int n = readFromStart(dst);
        if (n < sr) return n;
    }
    return sr + endPoint.fill(dst);
} 
```

}

```
import org.eclipse.jetty.io.Connection;
import org.eclipse.jetty.io.EndPoint;
import org.eclipse.jetty.io.ssl.SslConnection;
import org.eclipse.jetty.server.Connector;
import org.eclipse.jetty.server.ConnectionFactory;
import org.eclipse.jetty.server.AbstractConnectionFactory;
import org.eclipse.jetty.http.HttpVersion;
import org.eclipse.jetty.util.ssl.SslContextFactory;
import org.eclipse.jetty.util.annotation.Name;
public class MySslConnectionFactory extends AbstractConnectionFactory {
private final SslContextFactory _sslContextFactory;
private final String _nextProtocol;

public MySslConnectionFactory() { this(HttpVersion.HTTP_1_1.asString()); }

public MySslConnectionFactory(@Name("next") final String nextProtocol) { this((SslContextFactory)null, nextProtocol); }

public MySslConnectionFactory(@Name("sslContextFactory") final SslContextFactory factory, @Name("next") final String nextProtocol) {
    super("SSL");
    this._sslContextFactory = factory == null?new SslContextFactory():factory;
    this._nextProtocol = nextProtocol;
    this.addBean(this._sslContextFactory);
}

public SslContextFactory getSslContextFactory() { return this._sslContextFactory; }

@Override protected void doStart() throws Exception {
    super.doStart();
    final SSLEngine engine = this._sslContextFactory.newSSLEngine();
    engine.setUseClientMode(false);
    final SSLSession session = engine.getSession();
    if(session.getPacketBufferSize() > this.getInputBufferSize()) this.setInputBufferSize(session.getPacketBufferSize());
}

@Override public Connection newConnection(final Connector connector, final EndPoint realEndPoint) {
    final MyReadAheadEndpoint aheadEndpoint = new MyReadAheadEndpoint(realEndPoint, 1);
    final byte[] bytes = aheadEndpoint.getBytes();
    final boolean isSSL;
    if (bytes == null || bytes.length == 0) {
        System.out.println("NO-Data in newConnection : "+aheadEndpoint.getRemoteAddress());
        isSSL = true;
    } else {
        final byte b = bytes[0];    // TLS first byte is 0x16 , SSLv2 first byte is >= 0x80 , HTTP is guaranteed many bytes of ASCII
        isSSL = b >= 0x7F || (b < 0x20 && b != '\n' && b != '\r' && b != '\t');
        if(!isSSL) System.out.println("newConnection["+isSSL+"] : "+aheadEndpoint.getRemoteAddress());
    }
    final EndPoint      plainEndpoint;
    final SslConnection sslConnection;
    if (isSSL) {
        final SSLEngine engine = this._sslContextFactory.newSSLEngine(aheadEndpoint.getRemoteAddress());
        engine.setUseClientMode(false);
        sslConnection = this.newSslConnection(connector, aheadEndpoint, engine);
        sslConnection.setRenegotiationAllowed(this._sslContextFactory.isRenegotiationAllowed());
        this.configure(sslConnection, connector, aheadEndpoint);
        plainEndpoint = sslConnection.getDecryptedEndPoint();
    } else {
        sslConnection = null;
        plainEndpoint = aheadEndpoint;
    }
    final ConnectionFactory next = connector.getConnectionFactory(_nextProtocol);
    final Connection connection = next.newConnection(connector, plainEndpoint);
    plainEndpoint.setConnection(connection);
    return sslConnection == null ? connection : sslConnection;
}

protected SslConnection newSslConnection(final Connector connector, final EndPoint endPoint, final SSLEngine engine) {
    return new SslConnection(connector.getByteBufferPool(), connector.getExecutor(), endPoint, engine);
}

@Override public String toString() {
    return String.format("%s@%x{%s->%s}", new Object[]{this.getClass().getSimpleName(), Integer.valueOf(this.hashCode()), this.getProtocol(), this._nextProtocol});
} 
```

}

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-08-13T05:05:24.870

您可以通过编写自定义 Jetty ConnectionFactory 来实现这一点。我建议从复制和修改 SslConnectionFactory 和 SslConnection 的代码开始。您需要检查连接的前几个字节（必要时进行缓冲）以查找 SSL 客户端 Hello。使用 SSLv2 Hello，您可以通过两个长度字节来识别它，然后是 0x01，然后是版本字节。SSLv3 Hello 以 0x16 开头，后跟版本字节。版本字节序列将为 SSL 3.0 的 0x03 0x00、SSL 2.0 的 0x02 0x00、TLS 1.0 的 0x03 0x01、TLS 1.1 的 0x03 0x02、TLS 1.2 的 0x03 0x03。有效的 HTTP 流量不应以这些字节序列开头。（[这个答案](https://security.stackexchange.com/a/34783)有更多细节。）如果是 SSL，通过 SSLEngine 传递它；如果没有，则直接将其传递给下一个协议连接器。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-02-27T22:23:01.943

[从 jetty-9.4.15.v20190215 开始，对端口统一的支持通过类OptionalSslConnectionFactory](https://github.com/eclipse/jetty.project/blob/release-9.4.15/jetty-server/src/main/java/org/eclipse/jetty/server/OptionalSslConnectionFactory.java)内置在 Jetty 中。

这是一个示例类，它在运行时将启动一个侦听单个端口 8000 并响应 HTTP 或 HTTPS 的服务器。（这基于[此处](https://www.eclipse.org/jetty/documentation/9.4.x/embedded-examples.html#embedded-many-connectors)用于单独 HTTP 和 HTTPS 连接器的 Jetty 示例代码。）

```
import java.io.*;
import javax.servlet.http.*;
import org.eclipse.jetty.http.HttpVersion;
import org.eclipse.jetty.server.*;
import org.eclipse.jetty.server.handler.AbstractHandler;
import org.eclipse.jetty.util.ssl.SslContextFactory;

public class Jetty9PortUnification {

    public static void main(String[] args) throws Exception {
        // Use example keystore and keys from Jetty distribution
        String keystorePath = "jetty-distribution/demo-base/etc/keystore";
        File keystoreFile = new File(keystorePath);
        if (!keystoreFile.exists()) {
            throw new FileNotFoundException(keystoreFile.getAbsolutePath());
        }

        Server server = new Server();

        HttpConfiguration httpConfig = new HttpConfiguration();
        httpConfig.setSecureScheme("https");
        httpConfig.setSecurePort(8000);

        SecureRequestCustomizer src = new SecureRequestCustomizer();
        httpConfig.addCustomizer(src);

        HttpConnectionFactory httpConnectionFactory = new HttpConnectionFactory(httpConfig);

        SslContextFactory sslContextFactory = new SslContextFactory();
        sslContextFactory.setKeyStorePath(keystoreFile.getAbsolutePath());
        sslContextFactory.setKeyStorePassword("OBF:1vny1zlo1x8e1vnw1vn61x8g1zlu1vn4");
        sslContextFactory.setKeyManagerPassword("OBF:1u2u1wml1z7s1z7a1wnl1u2g");

        SslConnectionFactory sslConnectionFactory = new SslConnectionFactory(sslContextFactory, HttpVersion.HTTP_1_1.asString());

        ServerConnector portUnified = new ServerConnector(server,
            new OptionalSslConnectionFactory(sslConnectionFactory, HttpVersion.HTTP_1_1.asString()),
            sslConnectionFactory,
            httpConnectionFactory);
        portUnified.setPort(8000);

        server.addConnector(portUnified);

        server.setHandler(new AbstractHandler() {
            @Override
            public void handle(String target, Request baseRequest, HttpServletRequest request, HttpServletResponse response) throws IOException {
                response.setContentType("text/plain");
                response.getWriter().println("Hello");
                baseRequest.setHandled(true);
            }
        });

        server.start();
        server.join();
    }
} 
```

要运行它，您需要`javax.servlet-api-3.1.0.jar`, `jetty-server-9.4.15.v20190215.jar`, `jetty-util-9.4.15.v20190215.jar`,`jetty-http-9.4.15.v20190215.jar`和`jetty-io-9.4.15.v20190215.jar`.

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-06-25T05:24:49.367

即使将 Jetty 排除在外，这也是不可能的，因为服务器必须检测传入连接是 HTTP 还是 SSL/TLS。TLS 协议并非旨在支持这种用法，因此任何实现都将是一个 hack（我也找不到任何实现）。

确实存在一个[SSL-SSH 多路复用器](http://www.rutschle.net/tech/sslh.shtml)，它可以区分传入连接是 TLS 还是 SSH，并且[OpenVPN](http://openvpn.net/index.php/open-source/overview.html)具有“端口共享”功能，它将非 OpenVPN 连接代理到另一个端口。

一种可能的方法是使用与数据包内的字符串匹配的 iptables 规则。HTTP 请求的第一个数据包应该包含“HTTP/”，而 TLS ClientHello 数据包不会。然后可以将连接重定向到不使用 TLS 的不同端口。请注意，由于在整个数据包中进行字符串搜索，这会产生额外的开销，并且是一个非常老套的解决方案。

```
iptables --table nat --append PREROUTING --protocol tcp --dport 10433 --match string --string "HTTP/" --REDIRECT 1080 
```

# php - 使用 PHP 的 JavaScript 文件换行符

> ID：11182196
> 
> 赞同：1
> 
> 时间：2012-06-25T00:10:04.717
> 
> 标签：php, javascript, string, compiler-construction

我正在编写一个编译 JavaScript 框架的 PHP 脚本。现在我正在使用以下代码在 JavaScript 文件中创建换行符，但我猜有更好的方法来做到这一点？

```
// Line break, can this be written better?
$line_break = '

';

// Get JavaScript files
$js_file_core = file_get_contents('js/core.js', true);
$js_file_timers = file_get_contents('js/timers.js', true);

// Add a line break between files and combine them
$compiled_js = $js_file_core . $line_break . $js_file_timers; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T00:14:46.227

利用

```
$line_break = "\n"; 
```

换行。注意双引号而不是单引号。\n 必须用双引号括起来才能正常工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T00:33:02.170

PHP 有一个常量[PHP_EOL](http://us3.php.net/manual/en/reserved.constants.php)来帮助跨平台支持换行符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-25T00:43:50.633

上面的人已经告诉过你使用“\n”了。我会指出引号。许多人可能会尝试使用单引号 (')。如果你用像'\n'这样的单引号来尝试这个，你只会打印出\n。改用双引号：“\n”

有所作为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-25T00:16:28.407

也许 '\n' 对 linux 用户来说更好。人们总是使用 '\n' 来换行，而不是 dos 中使用的 '\r\n' 而不是 mac-os 中的 '\r'。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-25T00:14:22.970

// 换行，这个可以写得更好吗？是的！在 PHP 中使用 \n "\n" 强制换行符！

```
$line_break = "\n";// prints a newline! 
```

# mysql - 选择查询的反转结果

> ID：11182198
> 
> 赞同：0
> 
> 时间：2012-06-25T00:10:38.550
> 
> 标签：mysql, select

我有一个名为“产品”的表，其中包含以下数据。

```
--------------------
| id | tag_name    |
--------------------
| 1  | electronics |
| 1  | tv          | 
| 1  | lcd         |
| 2  | tv          | 
| 2  | lcd         |
| 3  | tv          |
| 3  | lcd         |
-------------------- 
```

所有产品都必须有一个“电子”标签，但很少有产品缺少该标签。根据我的问题上面的数据，我运行什么查询以便返回 ids 2 和 3，因为它们没有“电子”标签。

想到的2个解决方案是

1.  使用 NOT IN - `select distinct id from products where id not in (select id from products where tag_name='electronics')`- 有几百万行，这是非常低效的

2.  第二种解决方案是拼凑一个脚本，该脚本选择所有不同的 ID，然后检查该 ID 是否存在“电子”标签，如果不存在则插入该行。

还有另一种更有效的方法来处理这个问题吗？（可能`JOIN`在同一张桌子上使用 a）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:22:24.693

```
INSERT INTO products 
SELECT a.id, 'electronics'
FROM products a
LEFT JOIN products b ON a.id = b.id AND b.tag_name = 'electronics'
WHERE b.id IS NULL
GROUP BY a.id 
```

这实际上会更新`products`表格，为所有没有它的产品提供“电子”标签。

[http://sqlfiddle.com/#!3/f312a/1/0](http://sqlfiddle.com/#!3/f312a/1/0)

但是，如果您只想*选择*`id`没有特定标签的s，请使用 zerkms 的[解决方案](https://stackoverflow.com/a/11182241/1446794)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T00:44:21.760

`JOIN`不适用于您的情况，因为并非所有`id`s 都有`electronics` *tag_name*。

试试这个：

```
 SELECT DISTINCT id
    FROM Products
GROUP BY id
  HAVING not GROUP_CONCAT(tag_name) like CONCAT('%','electronics','%') 
```

**[从演示中查看此处：SQLFiddle.com](http://sqlfiddle.com/#!2/20856/9)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T00:20:17.883

```
SELECT DISTINCT t1.id
FROM products t1
LEFT JOIN products t2 ON t2.tag_name = 'electronics' AND t1.id = t2.id
WHERE t2.id IS NULL 
```

[http://sqlfiddle.com/#!2/8d805/2](http://sqlfiddle.com/#!2/8d805/2)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T00:19:30.723

像这样的东西怎么样，我在本地尝试过，它似乎可以工作

```
SELECT DISTINCT p1.id 
    FROM products p1 
    LEFT JOIN products p2 ON p1.id = p2.id AND p1.tag_name != p2.tag_name 
WHERE p1.tag_name != 'electronics' and p2.id IS NULL 
```

# c++ - 帮助使用扩张功能 OpenCV

> ID：11182203
> 
> 赞同：6
> 
> 时间：2012-06-25T00:11:52.933
> 
> 标签：c++, function, opencv, image-processing, mathematical-morphology

在下面的代码中，我想使用该`dilate`函数，但我不知道如何将一个`Mat`类转换为`InputArray`and `OutputArray`。你能帮助我吗？

使用这个原型函数：

```
void dilate(InputArray src, OutputArray dst, InputArray kernel, Point anchor=Point(-1,-1), int iterations=1, int borderType=BORDER_CONSTANT, const Scalar& borderValue=morphologyDefaultBorderValue() ) 
```

这是我的代码：

```
#include "opencv2/opencv.hpp"

using namespace cv;

int main(int, char**)
{
    Mat edges;

    VideoCapture cap(0); // open the default camera
    if(!cap.isOpened())  // check if we succeeded
        return -1;

    for(;;)
    {

        Mat frame;
        cap >> frame; // get a new frame from camera
        cvtColor(frame, edges, CV_BGR2GRAY);
        GaussianBlur(edges, edges, Size(7,7), 1.5, 1.5);
        //dilate(edges,edges,NULL);
        Canny(edges, edges, 0, 30, 3);
        imshow("edges", frame);
        if(waitKey(30) >= 0) break;
    }
    // the camera will be deinitialized automatically in VideoCapture destructor
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-25T00:23:10.240

Stack Overflow 周围有很多例子，[像这样](https://stackoverflow.com/a/11035901/176769)：

```
int erosion_size = 6;   
cv::Mat element = cv::getStructuringElement(cv::MORPH_CROSS,
                      cv::Size(2 * erosion_size + 1, 2 * erosion_size + 1), 
                      cv::Point(erosion_size, erosion_size) );

cv::dilate(edges, edges, element); 
```

[或者这个](https://stackoverflow.com/a/10384122/176769)：

```
cv::dilate(edges, edges, cv::Mat(), cv::Point(-1,-1)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T08:37:26.207

> 在下面的代码中，我想使用 dilate 函数，但我不知道如何将 Mat 类转换为 InputArray 和 OutputArray。你能帮助我吗？

好吧，您可以使用`Mat`as `Inputarray`/`Outputarray`参数而不进行强制转换。见[官方文档](http://docs.opencv.org/modules/core/doc/intro.html#inputarray-and-outputarray)。

还有[这里的](http://opencv.itseez.com/doc/tutorials/imgproc/erosion_dilatation/erosion_dilatation.html)官方 OpenCV 侵蚀/延迟教程。或者，您可以使用**karlphillip**帖子中的示例。

# javascript - kineticjs - 鼠标悬停不准确

> ID：11182204
> 
> 赞同：0
> 
> 时间：2012-06-25T00:11:53.407
> 
> 标签：javascript, canvas, mouseover, kineticjs

我正在构建一个极坐标图可视化，它需要在其弧上显示工具提示。它可以工作，只是鼠标悬停不精确：它是通过将鼠标悬停在没有形状的地方触发的，并且不会在应该触发的时候触发。

您可以通过我在[jsfiddle](http://jsfiddle.net/RLj3W/2/)上的原型亲自查看。

知道我能做些什么来解决这个问题吗？

**更新**

事实上，如果我填充（）弧线，它会显示真正发生事件的区域。它反应灵敏，尽管我想我现在需要找到一种方法使它不考虑填充...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T13:22:39.657

你正在画一条线，因此你只会在这条线的中间得到一个事件。改用形状

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T19:02:44.250

填充弧线显示真实区域（参见[jsfiddle](http://jsfiddle.net/RLj3W/3/)））。所以它是完全准确的，虽然不是我需要达到的效果。但是这个问题解决了°-)

# iphone - 您将如何在目标 c 中动态创建类实例

> ID：11182208
> 
> 赞同：0
> 
> 时间：2012-06-25T00:13:11.110
> 
> 标签：iphone, objective-c

我不确定我是否使用了错误的词汇来搜索这个，但我找不到任何似乎与我正在尝试做的事情有关的东西。

我有一门课是为了输入费用。我有 Name、amount 和 dueDate 成员变量。我正在使用命令行工具来创建这个类并对其进行测试。我的问题是，当用户需要增加费用时，我将如何从我的班级创建一个对象。这就是我为使其工作所做的工作。我不喜欢它。

我的 while 循环创建了我的类的一个新实例，然后获取用户输入，设置费用类的成员变量，最后将该对象添加到数组中以供以后使用。

一切正常我只是不喜欢每个对象基本上都具有相同的名称。我本来想根据用户输入的名称创建对象的名称，但我发现让用户输入类的名称并不好。所以请有任何建议。而且我对编程还很陌生，所以代码可能很乱。

```
 NSMutableArray *myExpenses = [[NSMutableArray alloc] init];

    while (enterMore == 1) 
    {
        Expense *anExpense = [[Expense alloc]init];

        NSLog(@"Enter an expense:\n\nName: ");
        scanf("%s", expenseName);
        billName = [NSString stringWithUTF8String: expenseName];
        anExpense.name = billName;

        NSLog(@"\nEnter the amount of the expense: ");
        scanf("%lf", &expenseAmount);
        anExpense.amount = expenseAmount;

        NSLog(@"\nEnter the day of the month the expense is due: ");
        scanf("%d", &dateDue);
        anExpense.dayOfMonthDue = dateDue;

        [myExpenses addObject:anExpense];

        NSLog(@"Enter 1 to enter more expenses anything else to quite: ");
        scanf("%d", &enterMore);

    }
for (int i = 0; i < [myExpenses count]; i++) 
{
    NSLog(@"%@", [[myExpenses objectAtIndex:i] name]);
    NSLog(@"%f", [[myExpenses objectAtIndex:i] amount]);
    NSLog(@"%d", [[myExpenses objectAtIndex:i] dayOfMonthDue]);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:38:43.563

为此，您可以将实例添加到字典对象 (NSMutableDictionary) 中，您可以使用该对象通过键 (NSString) 访问每个对象。这是一种方法。以下是有关字典的更多信息的参考：

[http://www.techotopia.com/index.php/Objective-C_Dictionary_Objects](http://www.techotopia.com/index.php/Objective-C_Dictionary_Objects)

**更新**：要回答评论，我的意思是添加实例。字典对象是一个数组，它使用键而不是数字来访问对象。问题是，你不能动态地创建实例。无法访问，因为编译器不知道这些变量是否存在并且不会编译。这就是不允许的原因。您可以做的是使用字典对象。它更容易访问，因为如果用户输入费用名称，由于输入将是一个字符串，因此会更自动地找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T05:02:36.143

它在另一个答案中有所说明（所以我赞成那个），但也许一个例子会有所帮助。

```
NSMutableDictionary *myExpenses = [[NSMutableDictionary alloc] init];

while (enterMore == 1) 
{
    Expense *anExpense = [[Expense alloc] init];

    NSLog(@"Enter an expense:\n\nName: ");
    scanf("%s", expenseName);
    billName = [NSString stringWithUTF8String: expenseName];
    anExpense.name = billName;

    NSLog(@"\nEnter the amount of the expense: ");
    scanf("%lf", &expenseAmount);
    anExpense.amount = expenseAmount;

    NSLog(@"\nEnter the day of the month the expense is due: ");
    scanf("%d", &dateDue);
    anExpense.dayOfMonthDue = dateDue;

    [myExpenses setObject:anExpense forKey:billName];

    NSLog(@"Enter 1 to enter more expenses anything else to quite: ");
    scanf("%d", &enterMore);

}
NSArray * allValues = [myExpenses allValues];
for (int i = 0; i < [allValues count]; i++) 
{
    Expense * myExpense = [allValues objectAtIndex:i];
    NSLog(@"%@", [myExpense name]);
    NSLog(@"%f", [myExpense amount]);
    NSLog(@"%d", [myExpense dayOfMonthDue]);
} 
```

真正的力量在于，现在您可以*通过 name*引用一个值。例如：

```
Expense * anExpense = [myExpenses objectForKey:@"Expense Name"]; 
```

希望这会有所帮助。

编辑：另外，我注意到你没有打电话`-release`或`-autorelease`在你的实例上。您正在使用 ARC（自动参考计数），或者如果您仍在使用 MRR（手动保留释放），您应该自动释放您的费用。如果您使用 ARC，请不要介意这一点，但如果不是 - 您将有内存泄漏。或者您可以显式调用 release（请参阅：[在将对象添加到集合之前使用 autorelease？](https://stackoverflow.com/questions/1147785/use-autorelease-before-adding-objects-to-a-collection)）

# ruby-on-rails - Rails 路由中的嵌套资源冲突

> ID：11182211
> 
> 赞同：0
> 
> 时间：2012-06-25T00:14:26.723
> 
> 标签：ruby-on-rails, ruby-on-rails-3

通过以下路线，我遇到了冲突问题。似乎两者不能同时存在。如何在不冲突的情况下同时指定两者？谢谢。

```
 resources :colleges do
    resources :departments
 end

 resources :departments do
    resources :professors
 end 
```

路径**new_college_department_path(@college)**产生 url **colleges/1/departments/new**，这又导致以下错误。我不确定为什么要列出控制器教授，因为它甚至不是路线的一部分！

```
 Routing Error

No route matches {:controller=>"professors", :format=>nil, :request_id=>#<department_id: nil, text: nil, goal: nil, accept: nil, post_url: nil, created_at: nil, updated_at: nil, u_id: nil, b_id: 1, active: nil>} 
```

**路线：**

```
blog_requests GET    /blogs/:blog_id/requests(.:format)                  requests#index
                       POST   /blogs/:blog_id/requests(.:format)                  requests#create
      new_blog_request GET    /blogs/:blog_id/requests/new(.:format)              requests#new
     edit_blog_request GET    /blogs/:blog_id/requests/:id/edit(.:format)         requests#edit
          blog_request GET    /blogs/:blog_id/requests/:id(.:format)              requests#show
                       PUT    /blogs/:blog_id/requests/:id(.:format)              requests#update
                       DELETE /blogs/:blog_id/requests/:id(.:format)              requests#destroy
                 blogs GET    /blogs(.:format)                                    blogs#index
                       POST   /blogs(.:format)                                    blogs#create
              new_blog GET    /blogs/new(.:format)                                blogs#new
             edit_blog GET    /blogs/:id/edit(.:format)                           blogs#edit
                  blog GET    /blogs/:id(.:format)                                blogs#show
                       PUT    /blogs/:id(.:format)                                blogs#update
                       DELETE /blogs/:id(.:format)                                blogs#destroy
    request_supporters GET    /requests/:request_id/supporters(.:format)          supporters#index
                       POST   /requests/:request_id/supporters(.:format)          supporters#create
 new_request_supporter GET    /requests/:request_id/supporters/new(.:format)      supporters#new
edit_request_supporter GET    /requests/:request_id/supporters/:id/edit(.:format) supporters#edit
     request_supporter GET    /requests/:request_id/supporters/:id(.:format)      supporters#show
                       PUT    /requests/:request_id/supporters/:id(.:format)      supporters#update
                       DELETE /requests/:request_id/supporters/:id(.:format)      supporters#destroy
              requests GET    /requests(.:format)                                 requests#index
                       POST   /requests(.:format)                                 requests#create
           new_request GET    /requests/new(.:format)                             requests#new
          edit_request GET    /requests/:id/edit(.:format)                        requests#edit
               request GET    /requests/:id(.:format)                             requests#show
                       PUT    /requests/:id(.:format)                             requests#update
                       DELETE /requests/:id(.:format)                             requests#destroy
                       GET    /requests(.:format)                                 requests#index
                       POST   /requests(.:format)                                 requests#create
                       GET    /requests/new(.:format)                             requests#new
                       GET    /requests/:id/edit(.:format)                        requests#edit
                       GET    /requests/:id(.:format)                             requests#show
                       PUT    /requests/:id(.:format)                             requests#update
                       DELETE /requests/:id(.:format)                             requests#destroy
            supporters GET    /supporters(.:format)                               supporters#index
                       POST   /supporters(.:format)                               supporters#create
         new_supporter GET    /supporters/new(.:format)                           supporters#new
        edit_supporter GET    /supporters/:id/edit(.:format)                      supporters#edit
             supporter GET    /supporters/:id(.:format)                           supporters#show
                       PUT    /supporters/:id(.:format)                           supporters#update
                       DELETE /supporters/:id(.:format)                           supporters#destroy
                 users GET    /users(.:format)                                    users#index
                       POST   /users(.:format)                                    users#create
              new_user GET    /users/new(.:format)                                users#new
             edit_user GET    /users/:id/edit(.:format)                           users#edit
                  user GET    /users/:id(.:format)                                users#show
                       PUT    /users/:id(.:format)                                users#update
                       DELETE /users/:id(.:format) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T08:51:32.600

If `professors`is children of `departments`and `departments`if children of `colleges`you 可以定义如下：

```
 resources :colleges do
    resources :departments do
      resources :professors
    end
 end 
```

因此，您的路径将是：

```
colleges/1/departments/1/professors/1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T12:54:14.583

错误出现在 form_for 中。路线还可以。

# twitter-bootstrap - 可折叠手风琴在 dropdpwn-menu Bootstrap 中不起作用

> ID：11182215
> 
> 赞同：0
> 
> 时间：2012-06-25T00:15:13.630
> 
> 标签：twitter-bootstrap, drop-down-menu, collapse

我想将下拉菜单和折叠菜单混合在一起，但是当我在下拉菜单中实现手风琴时，您无法单击手风琴切换。下拉菜单向上滑动。

这是我的代码。

```
<ul class="nav nav-pills">
  <li class="dropdown" id="menu1">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#menu1">
      Dropdown
      <b class="caret"></b>
    </a>

    <ul class="dropdown-menu">

      <li>
        <a href="#">Action</a>
      </li>

      <li class="divider"></li>

      <li>
        <a href="#">Separated link</a>
      </li>

      <li>
        <div class="accordion" id="accordion2">  

          <div class="accordion-group"> 

            <a class="accordion-toggle" 
               data-toggle="collapse" 
               data-parent="#accordion2" 
               href="#demo1">

               aaa

            </a> 

            <div id="demo1" class="accordion-body collapse" style="height: 0px; ">  
              <ul class="index-list">
                 ......
              </ul>              
            </div>                
          </div>   

          <div class="accordion-group">  

            <a class="accordion-toggle" 
               data-toggle="collapse" 
               data-parent="#accordion2" 
               href="#demo2">

               aaa

            </a>   

            <div id="demo2" class="accordion-body collapse">  
              <ul class="index-list">
               ......
              </ul>             
            </div>               
          </div>  
        </div>
      </li>
    </ul>
  </li>
  ...
</ul>​ 
```

这是 jsFiddle 的链接：http: [//jsfiddle.net/DBQU7/26/](http://jsfiddle.net/DBQU7/26/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T10:50:19.233

我不认为手风琴应该包含在下拉列表中。

我认为您必须自己触发手风琴，并避免手风琴通常需要的额外标记。这样你就可以保持下拉样式。

这是我想出的。

现场示例：http: [//jsfiddle.net/Sherbrow/YqsTw/](http://jsfiddle.net/Sherbrow/YqsTw/)

```
<ul class="nav nav-pills">
    <li class="dropdown" id="menu1">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#menu1">
    Dropdown
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
                <a href="#">Action</a>
            </li>
            <li class="divider"/>
            <li>
                <a href="#">Another action</a>
            </li>
            <li class="divider"/>
            <li>
                <a href="#collapsible1" class="accordion-toggle" data-parent="#menu1">Accordion 1</a>
            </li>
            <li class="collapse in" id="collapsible1">
                <a href="#">Collapsible 1</a>
            </li>
            <li class="divider"/>
            <li>
                <a href="#" data-target=".collapse2" class="accordion-toggle" data-parent="#menu1">Accordion 2</a>
            </li>
            <li class="collapse collapse2">
                <a href="#">Collapsible 2</a>
            </li>
            <li class="collapse collapse2">
                <a href="#">Collapsible 2 bis</a>
            </li>
        </ul>
    </li>
</ul> 
```

```
$('.dropdown-toggle').dropdown();
$('.dropdown-menu').each(function() {
    $(this).on('click', '.accordion-toggle', function(event) {
        event.stopPropagation();
        var $this = $(this);

        var parent = $this.data('parent');
        var actives = parent && $(parent).find('.collapse.in');

        // From bootstrap itself
        if (actives && actives.length) {
            hasData = actives.data('collapse');
            if (hasData && hasData.transitioning) return;
            actives.collapse('hide');
        }

        var target = $this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, ''); //strip for ie7

        $(target).collapse('toggle');
    });
}); 
```

# linux - 基本：%{REQUEST_URI} 来自哪里，是什么意思？

> ID：11182219
> 
> 赞同：0
> 
> 时间：2012-06-25T00:16:02.897
> 
> 标签：linux, apache, nginx

我正在尝试了解 nginx 重定向和重写，我很难找到有关重定向具体示例的资源

```
location / {
    proxy_pass http://localhost:3000/GoToNewSubdirectory/
} 
```

（假设“标准” nginx 设置 => 将对 http://yoursite.com 的访问重定向[到](http://yoursite.com/GoToNewSubdirectory)http://yoursite.com/GoToNewSubdirectory [）](http://yoursite.com)。

我的基本问题之一是 %{REQUEST_URI} 来自哪里？你如何找出这些特殊变量的含义，是否有一个带有明确定义和示例的列表？

我真的只是进入 linux 并使用 apache 和 nginx 等工具为网站提供服务，而且我很难找到这些问题的最终来源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T22:22:57.837

这是一个 CGI 环境变量：[http ://en.wikipedia.org/wiki/Common_Gateway_Interface](http://en.wikipedia.org/wiki/Common_Gateway_Interface)

您所指的 %{VAR} 语法是您在 mod_rewrite 中引用变量的方式。它的文档在这里：[http ://httpd.apache.org/docs/current/mod/mod_rewrite.html#RewriteCond](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#RewriteCond)

我对 nginx 不熟悉，但是您所描述的与 apache 相似。对于熟悉 apache 的人来说，他们一定保留了类似的东西。尝试搜索 mod_rewrite 教程。

# python - 如何在 for 循环中组织函数结果？

> ID：11182221
> 
> 赞同：-1
> 
> 时间：2012-06-25T00:16:22.520
> 
> 标签：python, for-loop

我有一个要通过 processTestFile() 函数运行的文件名列表，该函数返回我要存储的结果字典：

```
 # Count success or failure of test cases
  counts = {
    "success": 0,
    "failure": 0 
    } 
```

主流程循环如下所示：

```
for fileName in all_files(fileReferences["testCasesPath"],"*.txt") :
    print "\n\nRunning test case file = ", fileName
    myCounts = processTestFile(fileName) 
```

我在想类似的东西：

```
 myArray = {}
  myArray[fileName] = myCounts 
```

我会引用为：

```
for name in myArray
    print name, myArray[name] ["success"], myArray[name] ["failure"] 
```

我怀疑这段代码会起作用。你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:36:10.177

`myArray`是 a 的奇怪名称`dict`。确保在循环*外*对其进行初始化

```
myArray = {}
for fileName in all_files(fileReferences["testCasesPath"], "*.txt"):
    print "\n\nRunning test case file = ", fileName
    myCounts = processTestFile(fileName)
    myArray[fileName] = myCounts

for name, value in myArray.items()
    print name, value["success"], value["failure"] 
```

# c# - 基于 PowerShell 的程序

> ID：11182229
> 
> 赞同：-1
> 
> 时间：2012-06-25T00:18:09.910
> 
> 标签：c#, winforms, powershell

有谁知道 Lync、Exchange 或 SCVM 等程序的控制台是如何编写的？

他们执行 PowerShell 脚本。有SDK吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T04:55:32.943

您可以在 .NET 程序中嵌入 powershell 空间执行。您可以在从 Microsoft [Windows PowerShell](http://msdn.microsoft.com/en-us/library/dd835506%28v=vs.85%29)站点[编写 Windows PowerShell 主机应用程序](http://msdn.microsoft.com/en-us/library/ee706563%28v=vs.85%29)中找到有关如何执行此操作的详细信息。它也存在于非 Microsoft 站点，例如[How to run PowerShell scripts from C#](http://www.codeproject.com/Articles/18229/How-to-run-PowerShell-scripts-from-C)或[How to Embed PowerShell Within a C# Application](http://www.dougfinke.com/blog/index.php/2010/04/08/how-to-embed-powershell-within-a-c-application/)。

# java - Android 语法错误

> ID：11182232
> 
> 赞同：-1
> 
> 时间：2012-06-25T00:18:42.387
> 
> 标签：java, android, eclipse, syntax-error

我在运行应用程序时收到以下错误消息：

> 说明资源路径位置类型语法错误，插入“;” 完成语句 HelloWorldActivity.java > /HelloWorld/src/com/HelloWorld/test line 55 Java 问题

这是我的代码：

```
 toggleButton1.setOnClickListener(new OnClickListener() {

       public void onClick(View v) {
            if (toggleButton1.isChecked()){
                try {
                    mp.setDataSource("http://audioplayer.wunderground.com/sunsetlakesFL/Melbourne.mp3.m3u");
                    mp.prepare();
                    mp.start();
                } catch (IllegalArgumentException e) {
                    e.printStackTrace();
                    error.setText(e.getMessage());
                    error.show();
                } catch (IllegalStateException e) {
                    e.printStackTrace();
                    error.setText(e.getMessage());
                    error.show();
                } catch (IOException e) {
                    e.printStackTrace();
                    error.setText(e.getMessage());
                    error.show();
                }
            }
            else {
                mp.stop();
            }               
        }
  } //line 55 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:24:07.823

看起来您缺少*setOnClickListener*的右括号和分号。这：

```
 }
  } //line 55 
```

应该是这样的：

```
 }
  }); //line 55 
```

# django - 如何防止页面刷新后数据被额外添加？

> ID：11182234
> 
> 赞同：0
> 
> 时间：2012-06-25T00:18:55.997
> 
> 标签：django, templates, view, model, refresh

我有以下视图，允许用户为给定产品添加评论。用户提交表单后，它会将数据添加到数据库中，然后转到 /view_reviews.html。但是，当我刷新页面时，它会再次添加相同的评论。即使用户碰巧刷新页面，如何确保仅添加一次评论？

```
def add_review(request, product_id):
    if request.method == 'POST':
        form = ReviewForm(request.POST)
        if form.is_valid():
            form.save()
            product = get_object_or_404(Product, pk=product_id)
            reviews = Review.objects.filter(product_id=product_id)
            return render(request,'reserve/templates/view_reviews.html',{'form': form, 'product':product, 'reviews':reviews})
    else:
        form = ReviewForm()
    variables = RequestContext(request, {'form': form})
    return render_to_response('reserve/templates/create_review.html', variables) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T00:21:10.607

您应该只修改 POST 中的数据，当请求成功时，您会重定向到该页面。这样，如果您重新加载，您只是重新加载页面本身，而不是更改数据的 POST。

所以，而不是`return render(...)`，你应该`return HttpReponseRedirect(...)`。

这还具有您不必复制代码的优点。在`form.save()`您的示例之后，您有三行实际上只是您在其他地方已经拥有的视图。

# tomcat - 没有Tomcat Manager时如何使用maven deploy？

> ID：11182238
> 
> 赞同：2
> 
> 时间：2012-06-25T00:19:37.227
> 
> 标签：tomcat, maven, deployment, liferay

我目前正在开发 JSR-268 portlet 并使用 Liferay 作为我的门户。我已阅读有关使用 Tomcat 插件通过管理器应用程序部署到 Tomcat 的所有 maven 教程和帖子。不幸的是，我不相信这适用于 Liferay，因为它接管了 ROOT 应用程序，从而删除了 Tomcat Manager 应用程序。我想知道是否有办法通过 Liferay 部署文件夹部署我的 portlet 应用程序。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T04:02:09.917

Liferay 提供了自己的部署管理器。您可以在 Liferay 中以超级管理员身份登录，然后转到控制面板中的插件安装。

这允许您为 portlet、主题、布局等注入 .war 文件。

插件安装程序还显示已安装的组件。您可以在运行时取消部署它们。

请查看[Liferay 插件安装程序](http://www.liferay.com/community/wiki/-/wiki/Main/Plugin+Installation)

# twitter - 如何在 IE 上修复 twitter-bootstrap？

> ID：11182240
> 
> 赞同：40
> 
> 时间：2012-06-25T00:19:51.823
> 
> 标签：twitter, internet-explorer-9, twitter-bootstrap

导航栏在 IE 中似乎无法正常工作。这是它在 IE 中的屏幕截图。

![截屏](../Images/d386b000e3c2a52d52480f1efbab411c.png)

我一直在查看 stackoverflow.com 上的许多引导主题，但他们给人们的“帮助”对我不起作用。

身体标签后：

```
<div class="container">
    <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="brand" href="?id=home">OnniServer.tk</a>
                    <div class="nav-collapse">
                    <ul class="nav">
                    <li <?php if ((isset($_GET['id'])) && ($_GET['id'] == home)) { echo "class='active'"; } ?>><a href="?id=home">Home</a></li>
                    <li <?php if ((isset($_GET['id'])) && ($_GET['id'] == donate)) { echo "class='active'"; } ?>><a href="?id=donate">Donate</a></li>
                    <li <?php if ((isset($_GET['id'])) && ($_GET['id'] == about)) { echo "class='active'"; } ?>><a href="?id=about">About</a></li>
                    <li <?php if ((isset($_GET['id'])) && ($_GET['id'] == staff)) { echo "class='active'"; } ?>><a href="?id=staff">Staff</a></li>
                    <li <?php if ((isset($_GET['id'])) && ($_GET['id'] == vote)) { echo "class='active'"; } ?>><a href="?id=vote">Vote</a></li>
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown">Play now: <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="minecraft">In browser</a></li>
                                <li><a href="http://minecraft.net">Buy it now</a></li>
                                <li><a href="#">No link for crack</a></li>
                            </ul>
                    </li>
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown">Perms for: <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="?id=citizen">Citizen(s)</a></li>
                                <li><a href="?id=vip">VIP(s)</a></li>
                                <li><a href="?id=vipplus">VIP+(s)</a></li>
                                <li><a href="?id=modjr">Jr. Moderator(s)</a></li>
                                <li><a href="?id=mod">Moderator(s)</a></li>
                                <li><a href="?id=admin">Admin(s)</a></li>
                                <li><a href="?id=owner">Owner</a></li>
                            </ul>
                    </li>
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown">Mail to: <b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a href="mailto:onni.bucht@me.com">Onni (server Owner)</a></li>
                            </ul>
                    </li>
                    <script>
                        $('.dropdown-toggle').dropdown()
                    </script>
                    </ul>
                    </div>
                </div>
            </div>
    </div>
    <p>&nbsp;</p>
    <p>&nbsp;</p>
    <div class="hero-unit">
        <style "text/css">
        </style>
        <?php
        if (((isset($_GET['id'])) &&($_GET['id'] == home)) || (!isset($_GET['id']))) { include('home.php'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == donate)) { include('donate.php'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == about)) { include('about.php'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == staff)) { include('staff.php'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == vote)) { include('vote.php'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == citizen)) { include('permissions/citizen.html'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == vip)) { include('permissions/vip.html'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == vipplus)) { include('permissions/vipplus.html'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == modjr)) { include('permissions/modjr.html'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == mod)) { include('permissions/mod.html'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == admin)) { include('permissions/admin.html'); };
        if ((isset($_GET['id'])) && ($_GET['id'] == owner)) { include('permissions/owner.html'); };
        ?>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-09-12T18:53:07.347

您需要放入`<!DOCTYPE HTML>`html 的第一行。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-06-05T14:15:40.473

您可以添加元标记：

```
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

[**在此链接**](https://stackoverflow.com/questions/6771258/whats-the-difference-if-meta-http-equiv-x-ua-compatible-content-ie-edge)上可以找到关于它是什么以及它是如何工作的简要说明。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-06-25T23:59:00.840

仅出于完整性考虑 - 值得注意的是，使用 Bootstrap 3，[根据文档](http://getbootstrap.com/getting-started/)，确保页面中的以下结构。它解决了我在使用 IE9 和 v3 时遇到的问题。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<!-- content -->
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-12-21T04:54:17.117

IE需要包含这两个脚本

```
<script src="http://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="http://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-02-13T01:52:02.920

不确定它是否会解决您的特定问题，但无论如何值得分享。

我在 IE 中遇到了 Twitter 引导带的问题。没有圆角。导航菜单未折叠。跨度不在正确的位置，甚至有些图像没有显示。

奇怪的是，当通过 Visual Studio 调试器运行时，站点在 IE 中运行良好，一旦部署到出现问题的服务器上。

尝试使用 IE 开发者工具（F12 是键盘快捷键） 检查您的浏览器模式和文档模式。（它位于菜单栏的顶部）

问题发生在我身上，因为文档是 IE7，浏览器是 IE10 兼容性。我在 IIS 中添加了一个 http 标头：Name X-UA-Compatible Value IE=EmulateIE9

现在页面加载为文档 - IE9 标准、浏览器 IE10 兼容性和所有以前的问题都已解决。

希望这可以帮助。

-泰西

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-07-14T07:12:08.810

如果您在 Intranet 中并且设置设置为兼容模式，那么正确的 doctypes 和 respond.js 是不够的。

请参阅此链接以获取更多信息：[强制 IE8 或 IE9 文档模式符合标准](https://stackoverflow.com/questions/13896176/force-ie8-or-ie9-document-mode-to-standards)并查看 Ralph Bacon 的答案。

这将与此相同：

```
<!DOCTYPE html>
<meta http-equiv="X-UA-Compatible" content="IE=edge"> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-03-26T05:14:09.050

我遇到了同样的问题，其他答案都没有。我的问题是一个奇怪的问题，IE9 无法连接到任何 http站点，因此，由于我使用**的**是在线 maxcdn 引导文件，例如，

> [https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css](https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css)

这些css和js都没有被应用。进入 Internet Explorer 选项的“高级”选项卡，我确认没有选中“使用 TLS 1.0”会导致 https 站点和文件出现问题，并且一旦检查，我的引导页面已按预期格式化。

正如其他人所指出的那样，请使用下面的正确文档类型（也许有效的 html4 文档类型会起作用，但如果您重新开始，不妨使用 html5。）

响应 js 和 html5 垫片（如果使用）适用于 IE8。IE9*不需要*那个。下面的代码使用了针对 ie8 及以下的标准方法。

- 艺术

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- content -->
</body>
</html> 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-06-11T23:11:52.483

我最近遇到了这个问题。我更改了这些设置。它对我有用。！

![验证这些设置](../Images/d451cce6a3cc46acbdce94b49f9cdd2e.png)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-23T14:57:46.580

Internet Explorer 具有用于样式表识别的最大代码行数。

这是为导航栏项目设置浮动属性的引导导航栏样式规则：

```
.navbar-nav > li {
    float: left;
} 
```

Bootstrap 3 中的该规则（可能也在早期版本中）位于第 5247 行。

正如这里所说：[Internet Explorer 的 CSS 规则限制](https://stackoverflow.com/questions/9906794/internet-explorers-css-rules-limits)，一个工作表最多可以包含 4095 行。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-10-18T14:08:31.063

我也有类似的问题。我将以下代码行放在布局文件的头部，一切似乎都很好。

```
<meta http-equiv="X-UA-Compatible" content="IE=9"> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-08-28T04:42:13.710

I was having a similar issue. In my case, looking at the CSS i found a `position: initial`.

After some research, i found that mobile IE browser doesn't supports it.

I simply put a `position: relative` instead and everything worked fine.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-04-18T12:15:09.310

如果您使用的是响应式布局，请尝试在您的代码中包含此 js：[https ://github.com/scottjehl/Respond](https://github.com/scottjehl/Respond)

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2018-05-06T07:13:05.660

请将页面放在本地主机中并尝试

# android - RelativeLayout 中的 ScrollView 垂直填充整个对话框，推开其他视图

> ID：11182243
> 
> 赞同：1
> 
> 时间：2012-06-25T00:20:21.590
> 
> 标签：android, android-layout

我有一个包含以下内容的对话框：

```
<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <ScrollView
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_marginBottom="25dp" >
        <LinearLayout
           ...
        </LinearLayout>
    </ScrollView>

    <Button
        android:id="@+id/closebtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/scrollview"
        android:layout_centerHorizontal="true" />

</RelativeLayout> 
```

我希望对话框垂直调整大小以尽可能多地适应 LinearLayout 的内容。但是，我发现，如果 LinearLayout 的内容太高，则 ScrollView 会填充对话框，并且关闭按钮会被推过底部并且不可见。

我尝试的一件事是制作 Button layout_alignParentBottom="true" 并制作 ScrollView layout_above="@+id/closebtn"，但随后对话框总是拉伸以垂直填充整个屏幕，即使 LinearLayout 的内容真的短的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T06:20:19.657

我最终将我的 RelativeLayout 更改为 LinearLayout 以使其正常工作。我最初没有这样做，因为当我尝试它时，它给了我一个非常高而瘦的对话框（内部 LinearLayout 包含 ImageViews 和 TextViews）。但是，令人惊讶的是，将我的所有视图从 width=fill_parent 更改为 wrap_content 会导致对话框水平拉伸以填充屏幕，这正是我想要的，并且高度表现正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T17:15:43.677

在您致电后：

```
AlertDialog dialog = builder.show(); 
```

然后调用：

```
fixScrollViewHeight(scrollView); 
```

//

```
private void fixScrollViewHeight(ScrollView scrollView) {
    int screenHeight = activity.getWindowManager().getDefaultDisplay().getHeight();
    LayoutParams lp = scrollView.getLayoutParams();
    lp.height = screenHeight / 3;
    scrollView.setLayoutParams(lp);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T00:59:08.280

一种解决方案是以编程方式获取屏幕高度并手动指定滚动视图的高度。

获取屏幕尺寸（以像素为单位）：

[以像素为单位获取屏幕尺寸](https://stackoverflow.com/questions/1016896/android-how-to-get-screen-dimensions)

问题是您的按钮的高度将是每个屏幕上不同数量的像素，基于像素密度，但您的按钮将是一定数量的 DP。

在您的 XML 中，为 DP 中的按钮设置高度。

然后计算你的按钮有多少像素高。请参阅：[Android 上的“px”、“dp”、“dip”和“sp”有什么区别？](https://stackoverflow.com/questions/2025282/difference-of-px-dp-dip-and-sp-in-android)

然后，您可以使用屏幕高度减去按钮的高度来确定您可以在按钮的布局参数中设置的大小。

```
LayoutParams params = findViewById(R.id.your_scroll_view).getLayoutParams();
params.height = screenHeight - buttonHeight; 
```

# javascript - 自从我将服务移至亚马逊 S3 后 DOM 未更新

> ID：11182251
> 
> 赞同：0
> 
> 时间：2012-06-25T00:21:45.803
> 
> 标签：javascript, css, amazon-s3, amazon

我有一个非常奇怪的错误。我将一个简单的站点（只是静态 html、javascript css）移到了 Amazon S3。

经过一番折腾后，我可以在[http://resihop.s3-website-eu-west-1.amazonaws.com/#上运行该站点](http://resihop.s3-website-eu-west-1.amazonaws.com/#)

javascript似乎工作。因为如果您未登录，它会要求您登录 facebook (oauth)，并且它会在 console.log 中打印内容。

但是，页面上提供的唯一内容是不使用 javascript 呈现的默认 html。也没有读取 css。所有文件似乎都可以访问并正确链接。我真的不明白为什么他们不会有任何影响。

# c# - 如何将 dd/mm/yyyy 转换为 dd/mm/yyyy

> ID：11182252
> 
> 赞同：2
> 
> 时间：2012-06-25T00:21:55.643
> 
> 标签：c#, datetime, date

我有一个关于字符串转换的问题。我有一个文本框，用户将以这种格式（dd/mm/yy）输入日期。

现在我必须对其进行转换，使其对 MySQL 友好。

到目前为止，这就是我所做的

```
currentExpDate = txtDateStore.txt; //(i.e 25/12/13)
MessageBox.Show(currentExpDate.ToString()); // for debugging
//DateTime dt = DateTime.Parse(currentExpDate);
DateTime dt = DateTime.ParseExact(
    currentExpDate,
    "dd/MM/yyyy",
    CultureInfo.InvariantCulture);
string mySQLDate = dt.ToString("yyyy-MM-dd"); 
```

每当我尝试解析它时，它总是会抛出错误。我得到字符串异常，说字符串格式是一种它无法识别的格式。

如果我尝试使用这种格式 dd/mm/yyyy 输入日期，它就像一个魅力。有什么办法可以解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T00:23:04.020

您应该直接将日期用作 DateTime 以存储在数据库中。没有理由将其转换回字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T02:02:50.990

我可能在这里遗漏了一些东西，但是`DateTime`使用“dd/MM/yy”格式创建您的对象，然后`DateTime`使用“yyyy-MM-dd”将其转换为字符串似乎给了我一个您想要的格式的字符串..

## ![在此处输入图像描述](../Images/e0d0d9c011013e7628f01b754887ab37.png)

为了回答您的评论，我刚刚使用了您在问题中发布的代码，并将第一次转换的格式更改为“dd/MM/yy”。

```
String currentExpDate;
currentExpDate = txtDateStore.Text; //(i.e 25/12/13) 
MessageBox.Show(currentExpDate.ToString()); // for debugging 
//DateTime dt = DateTime.Parse(currentExpDate); 
DateTime dt = DateTime.ParseExact(
    currentExpDate,
    "dd/MM/yy",
    CultureInfo.InvariantCulture);
string mySQLDate = dt.ToString("yyyy-MM-dd"); 
```

# jquery - 从模态窗口回火事件

> ID：11182257
> 
> 赞同：0
> 
> 时间：2012-06-25T00:22:42.970
> 
> 标签：jquery, modal-dialog

我有一个表格 > tr（具有唯一 ID）> td（包含 HTML 格式的数字）> td（包含带有 class=”delete” 的图像 > img 一个 jQuery 脚本以图像为目标并触发请求，更新文件（通过删除 TD 中带有 TR ID 和数字的行）。成功后，通过属性 src 将图像从“ON”更改为“OFF”。

这样可行。没问题。

我的脚本：

```
$(document).ready(function() {

$(‘table td img.delete’).click(function(){

$.get(“deleteRow.php”, {id: $(this).parent().parent().attr(‘id’)} );
$(this).attr(“src”, “img/code_off.gif”);

});
}); 
```

然后，我添加了一个模态窗口（使用 Zebra Dialog）。现在，我的问题是：

当我单击“删除”图像时，它会触发 zebra_dialog。美好的。我可以得到TR的ID。但我绝不可以更新图像 src ！:(

我的代码（我必须承认，我对此很陌生，所以它可能是错误的或不正确的写法......）：

```
$(document).ready(function() {

$(‘table td img.delete’).bind(‘click’, function(e) {

var id = $(this).parent().parent().attr(‘id’);

e.preventDefault();
$.Zebra_Dialog(‘my question ?’, {
‘type’: ‘question’,
‘title’: ‘my title’,
‘buttons’: [
{caption: 'YES', callback: function() { /* ??????? THERE SHOULD BE THE EVENT FIRED, therefore the IMG shall be updated, which is not, and I can't get it to work... I've been working around this : $('#'+id+'', 'this').attr("src", "img/code_off.gif") } */ }},
{caption: 'NO', callback: function() { alert('num : '+id+''); /* HERE, WE DO NOTHING, so just checking the ID, which is OK, then modal self-closes. */ }}
]
});
});

}); 
```

请问有人有提示或解决方案吗？谢谢 ;）

# java - 线程安全的秒表 API

> ID：11182263
> 
> 赞同：0
> 
> 时间：2012-06-25T00:24:02.643
> 
> 标签：java, thread-safety, stopwatch

我想知道如何编写线程安全的秒表。下面是一个简单的秒表实现，它提供了秒表的基本操作，但它不是线程安全的。

现在，我能想到的就是为每个方法（start()、lap()、stop()、reset()）添加同步。是否有其他方法可以在秒表上实现线程安全？

```
import java.util.List;
import java.util.concurrent.CopyOnWriteArrayList;

public class Stopwatch {
    private long startTime;
    private long endTime;
    private boolean isRunning;

    // lapTimes is able to record all the lap time.
    private CopyOnWriteArrayList<Long> lapTimes;

    Stopwatch() {
        isRunning = false;
        lapTimes = new CopyOnWriteArrayList<Long>();
    }

    public void start() {
        if (!isRunning) {
            isRunning = true;
            startTime = System.currentTimeMillis();
        } else {
            throw new IllegalStateException("cannot start when running!");
        }
    }

    public void lap() {
        if (isRunning) {
            endTime = System.currentTimeMillis();
            lapTimes.add(endTime - startTime);
            startTime = endTime;
        } else {
            throw new IllegalStateException("cannot lap when not running!!");
        }
    }

    public void stop() {
        if (isRunning) {
            endTime = System.currentTimeMillis();
            lapTimes.add(endTime - startTime);
            isRunning = false;
        } else {
            throw new IllegalStateException("cannot stop when not running!");
        }
    }

    public void reset() {
        isRunning = false;
        lapTimes.clear();
    }

    public List<Long> getLapTime() {
        return lapTimes;
    } 
```

}

我想要做的是由多个线程共享一个秒表对象。

假设我们有两个线程：线程 A 和线程 B。线程 A 启动秒表，并且晚了几秒钟，它调用了停止。当它刚刚结束 if 语句（stop 方法的第一行）时，线程 B 被调用，它也调用了 stop 方法。后来线程A继续执行stop方法，没有任何异常。

这不是我想要的，因为线程安全的秒表无法停止两次，我只想知道如何摆脱它。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-25T00:55:38.607

您是否希望它是线程安全的，因为... (a) 多个线程可能正在启动秒表并进行圈数，或者 (b) 一个线程可能会启动秒表，而另一个线程可以使用同一个秒表完成一圈？

# ssas - Cube Dimension 加载速度很慢

> ID：11182267
> 
> 赞同：0
> 
> 时间：2012-06-25T00:24:58.663
> 
> 标签：ssas, cube, cube-dimension

我有一个尺寸约为 100,000 行的多维数据集。它运行得非常慢，我不确定要解决这个问题的方向。我为度量创建了分区，聚合似乎运行得很好。但是，我可以在 2008 BIDS 中将一个维度拉到浏览器中，甚至无需任何措施，我将需要 10 分钟来加载。关于我可以解决这个问题的任何方向的建议？我正在使用 SQL Server 2008 企业版。服务器很大，有 196 gig om 内存。
我感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T10:42:02.200

在维度属性上构建层次结构。即使您可以将它们全部带入多维数据集，谁会在 100.000k 个可能值中搜索单个属性？

在某种层次结构中添加大维度并将 AttributeHierarchyVisible 属性设置为 false 是 Microsoft 的最佳实践，因此可以通过层次结构而不是单独浏览该属性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-10T20:48:11.553

处理多维数据集或处理多维数据集后维度是否缓慢？昏暗是如何构成的？它是一个 SQL Server 视图，其中可以连接到下面的其他表，也许是嵌套循环连接而不是合并或散列连接来读取整个 Dim？

您是否使用 Bridge 表来获取事实数据？这些将在运行时进行评估，可能需要一些时间。即使您只在浏览器中返回模糊数据，SSAS 也使用默认度量，这意味着您的浏览查询很可能无论如何都引用了事实数据。

最后，确保在服务器上正确设置内存，确保 SSAS 使用了足够的内存。这台服务器是专门用于 SSAS 的，还是安装了 SQL Server 或其他东西？

# php - 链接与mysql数据库中的其他数据分开保存

> ID：11182272
> 
> 赞同：2
> 
> 时间：2012-06-25T00:26:33.833
> 
> 标签：php, mysql, curl

我正在尝试将网站中的数据保存到 mysql 数据库中。我能够保存我想保存的大部分内容，但我有一个特殊的问题。我提取的链接正在保存，但我希望链接与其他属性在同一行中。下面是我的 CURL 和 mysql 查询，用于提取信息并将其保存到数据库中。

```
$target_url = "http://www.ucc.ie/modules/descriptions/BM.html";
$codeS = "BM";
$html = file_get_contents("http://www.ucc.ie/modules/descriptions/BM.html"); 
@$doc = new DomDocument(); 
@$doc->loadHtml($html); 
//discard white space   
@$doc->preserveWhiteSpace = false; 
$xpath = new DomXPath($doc);

//Read through dd tags
$options = $doc->getElementsByTagName('dd');

//Go into dd tags and look for all the links with class modnav 
$links = $xpath->query('//dd //a[@class = "modnav"]'); 

//Loop through and display the results for links
foreach($links as $link){    
echo $link->getAttribute('href'), '<br><br>';
}   

foreach ($options as $option) { 

    $option->nodeValue;
    echo "Node Value (Module name/title)= $option->nodeValue <br /><br /> <br />"; 

      // save both for each results into database
$query3 = sprintf("INSERT INTO all_modulenames(code,module_name,description_link,gathered_from) 
     VALUES ('%s','%s','%s','%s')",
     mysql_real_escape_string ($codeS),
     mysql_real_escape_string($option->nodeValue),
     mysql_real_escape_string($link->getAttribute('href')),
     mysql_real_escape_string($target_url));
     mysql_query($query3) or die(mysql_error()."<br />".$query3); 

    } 
    echo "<br /> <br /> <br />";

Here is the table
-- ----------------------------
-- Table structure for `all_modulenames`
-- ----------------------------
DROP TABLE IF EXISTS `all_modulenames`;
CREATE TABLE `all_modulenames_copy` (
`code` varchar(255) NOT NULL,
`module_name` varchar(255) NOT NULL,
`description_link` varchar(255) NOT NULL,
`gathered_from` varchar(255) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

-- ----------------------------
-- Records of all_modulenames
-- ---------------------------- 
```

所以问题是“$link->getAttribute('href')”与我试图保存的其他内容分开保存。链接首先保存，然后是其余数据，使一些行为空，但我试图一次保存所有内容，即填充每一行，然后它们移动到第二行，直到 for each 语句完成。请问我该怎么做？任何帮助，将不胜感激 ！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:36:05.237

未经测试（因此需要调试），但我会采用这样的方法：

```
...etc
@$doc->preserveWhiteSpace = false;  

//Read through dd tags 
$options = $doc->getElementsByTagName('dd'); 

foreach ($options as $option) {  

    // Get the links and find the one with the right class
    $href = '';
    $links = $option->getElementsByTagName('a');
    foreach ($link as $link) {
        if ($link->hasAttribute('class') && $link->hasAttribute('href')) {
            $aClasses = explode(' ', $link->getAttribute('class'));
            if (in_array('modnav', $aClasses)) {
                  $href=$link->getAttribute('href');
            }
        }
    }

    Insert in to SQL etc, $href is the link text belonging to the dd ... 
```

# django - Django-imagekit 在 API 中使用时系统崩溃

> ID：11182273
> 
> 赞同：0
> 
> 时间：2012-06-25T00:26:55.147
> 
> 标签：django, imagekit, django-imagekit

我正在利用 Imagekit 调整一些图像的大小并以 JSON 格式导出 3 种不同的变体以进行 api 调用：

```
'image': k.thumbnail_large.url if k.image else '',                                                                                                                                   
'thumb_med': k.thumbnail_medium.url if k.image else '',
'icon': k.thumbnail_icon.url if k.image else '', 
```

问题是，在我的 512mb RAM 的非强大虚拟化服务器上​​，当 Django 应用程序服务器尝试调整超过 50 个图像 * 3 的大小时，我正在崩溃。

现在输入 CMS 的 500 多张图像如何对这些图像进行启动/预处理？

# silverlight - GC 阻塞 Silverlight 应用程序中的 UI 线程

> ID：11182279
> 
> 赞同：0
> 
> 时间：2012-06-25T00:27:50.940
> 
> 标签：silverlight, mvvm, garbage-collection, mvvm-light

我们正在使用 Silverlight 5 和 MVVM Light 开发 Silverlight 应用程序。视图中呈现了 3000 多个图形元素，每个元素都有一个关联的 ViewModel。ItemsControl 用于将这些对象绑定到这些视图模型。首次加载视图时，渲染 3000 个对象需要 7 秒。然而，当我们通过设置一个新的视图模型集合来刷新视图时，渲染需要 17 秒——即使我们这次只渲染较少数量的 ViewModel。这里关注的是不同渲染之间的 10 秒差异。

我们发现，当我们阻止 ViewModel 被 GC 清理时（通过将它们添加到另一个集合并且从不释放它们），随后的渲染时间也都只有 7 秒。所以由此得出的结论是，额外的 10 秒是由旧 ViewModel 的垃圾收集引起的。

从我们上面看到的情况来看，垃圾收集似乎阻塞了 UI 线程。UI 被冻结，直到 GC 完成它的工作（我们认为这是我们在 VM Finalizer 方法中的临时日志记录完成后），然后 UI 将恢复渲染。

总而言之，我们的时间安排是：

初始 3000 个对象 - 约 7 秒。接下来用 500 个对象替换 - 约 17 秒。

初始 500 个对象 - 约 2 秒。接下来用 3000 个对象替换 - 约 7 秒。

初始 3000 个对象 - 约 7 秒。接下来用 3000 个对象替换 - 约 17 秒。

关于我们看到的这个非常奇怪的问题有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:44:24.493

在您的情况下，您可能需要手动调用垃圾收集器。它可能没有任何影响，但我建议调查您的代码并检查您是否可以将其放入代码中的某个巧妙位置，看看它是否对加载时间有任何影响。

[检查此链接以手动调用 GC。](https://stackoverflow.com/questions/233596/best-practice-for-forcing-garbage-collection-in-c-sharp)

# jquery - 重复 html 表单以打开 jquery 对话框

> ID：11182280
> 
> 赞同：0
> 
> 时间：2012-06-25T00:27:52.240
> 
> 标签：jquery, html, jquery-ui

我有几个按钮，我想在 jquery 模态对话框中调出一个 html 表单：

```
<button class="add1">Add1</button>
<button class="add2">Add2</button>

<div id="form1">
<form id='AddForm1' name='' method='post' action='<?php echo htmlspecialchars($_SERVER['REQUEST_URI']); ?>'>
    <label for="Name">Name:&nbsp;</label>
    <input id="Name" name="camera_name" size="24" maxlength="36" value="Enter label for camera" onclick="this.select()" />
    <label for='Quality'>Quality:&nbsp;</label>
    <select id='Quality' name='quality'>
        <option value='HIGH' selected='selected'>High</option>
        <option value='MEDIUM'>Medium</option>
        <option value='LOW'>Low</option>
    </select>
    <label for='Status'>Status:&nbsp;</label>
    <select id='Status' name='status'>
        <option value='ENABLED' selected='selected'>On</option>
        <option value='DISABLED'>Off</option>
    </select>
    <label for='EmailNotice'>Email notice:&nbsp;</label>
    <select id='EmailNotice' name='email_notice'>
        <option value='ENABLED' selected='selected'>On</option>
        <option value='DISABLED'>Off</option>
    </select>
    <label for='Sensitivity'>Sensitivity:&nbsp;</label>
       <select id='Sensitivity' name='sensitivity'>
        <option value='HIGH'>High</option>
        <option value='AVERAGE' selected='selected'>Average</option>
        <option value='LOW'>Low</option>
    </select>
    <input type='hidden' name='type' value='TYPE1' />
    <button type='submit' class='submitme' name='add' value='Add'>Add</button>
    <button type='button' class='cancel_changes' name='cancel_changes' value='Cancel'>Cancel</button>
</form>
</div> 
```

现在我有第二个表单，其中包含名称、质量、状态和电子邮件通知等常见项目，但根据他们选择的按钮，有些事情会有所不同。

```
<div id="form2">
<form id='AddForm2' name='' method='post' action='<?php echo htmlspecialchars($_SERVER['REQUEST_URI']); ?>'>
    <label for="Name">Name:&nbsp;</label>
    <input id="Name" name="camera_name" size="24" maxlength="36" value="Enter label for camera" onclick="this.select()" />
    <label for='Quality'>Quality:&nbsp;</label>
    <select id='Quality' name='quality'>
        <option value='HIGH' selected='selected'>High</option>
        <option value='MEDIUM'>Medium</option>
        <option value='LOW'>Low</option>
    </select>
    <label for='Status'>Status:&nbsp;</label>
    <select id='Status' name='status'>
        <option value='ENABLED' selected='selected'>On</option>
        <option value='DISABLED'>Off</option>
    </select>
    <label for='EmailNotice'>Email notice:&nbsp;</label>
    <select id='EmailNotice' name='email_notice'>
        <option value='ENABLED' selected='selected'>On</option>
        <option value='DISABLED'>Off</option>
    </select>
    <label for='UserName'>User name:&nbsp;</label>
       <input id='UserName' size='14' maxlength='16' name='add_user' value="Enter username" onfocus="if(this.value=='Enter username') this.value='';" />
    <label for='Pass'>Password:&nbsp;</label>
    <input type='password' size='12' maxlength='16' id='Pass' name='add_pass' value='' />
        <label for='IP'>Enter IP:&nbsp;</label>
        <input id='IP' name='add_ip' size='10' value="Enter IP" onfocus="if(this.value=='Enter IP') this.value='';" />
        <label for='Port'>Enter port:&nbsp;</label>
        <input id='Port' name='add_port' size='12' maxlength='6' value="Enter Port" onfocus="if(this.value=='Enter Port') this.value='';" />
    <input type='hidden' name='type' value='TYPE2' />
    <button type='submit' class='submit' name='add' value='Add'>Add</button>
    <button type='button' class='cancel_changes' name='cancel_changes' value='Cancel'>Cancel</button>
</form>
</div> 
```

根据他们单击的按钮，它将打开一个 jquery 对话框。

```
var $dialog1 = $('#form1').dialog({
    modal:true,
    autoOpen: false,
    resizable:false,
    width: 625
}); //init dialog

var $dialog2 = $('#form2').dialog({
    modal:true,
    autoOpen: false,
    resizable:false,
    width: 625
}); //init dialog

//events
$('.add1').click(function(e) {
    $dialog1.dialog('open');
});

$('.add2').click(function(e) {
    $dialog1.dialog('open');
});

$(".cancel_changes").click(function() {
    $dialog1.dialog('close');
    $dialog2.dialog('close');
});

$(".submit_camera").click(function() {
    $("#AddForm1").validate({
    //all validation stuff
}); 
```

最后我的问题是，这会打开带有适当表单的对话框，但我开始在这里复制很多东西。一旦我到达提交中的验证内容，重复的数量就会开始变得疯狂。我的表单需要清理，因为我有同名的 id。我认为必须有比复制所有内容更好的方法。也许以某种方式只有一种形式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:07:13.020

当您为插件创建选项对象时，您还可以将现有对象作为变量传递给插件，而不是在代码中再次复制相同的对象。

对于表单，您可以创建一个包含所有重复规则的对象，然后使用特定于每个表单的规则扩展该对象。

虽然在这种情况下并不能节省大量代码，但向元素添加数据属性也有助于减少代码。一般来说，最好不要为相同的样式使用唯一的类，并使用类似`add1, add2`vs的元素`add_btn`。然后代码中的 css 选择器更容易在一个选择器中聚合多个元素。

使用遍历技术而不是担心 ID，因此过度复杂化或重复代码非常有帮助

简单的 html mod- 通用类和数据属性：

```
 <button class="add1 add_btn" data-form_num="1">Add1</button> 
```

一些 JS 简化，结合了各种方法来简化上述每个注释：

```
/* store dialog options for numerous dialogs*/
var dialogOpts={
    modal:true,
    autoOpen: false,
    resizable:false,
    width: 625
}
/* combine selectors for dialogs - one common class would simplify further*/
$('#form1,#form2 ').dialog(dialogOpts); //init dialog

/* combine selectors by using common class*/
$('.add_btn').click(function(e) {
        /* use attributes to determine which to open */                      
    $('#form'+ $(this).data('form_num') ).dialog('open');
});

$(".cancel_changes").click(function() {
    /* tarverse rather than worry about specific ID's*/                             
    $(this).closest('form').parent().dialog('close');   
});

/*  rules for all forms */
var all_forms_rules={
    'camera_name': 'required',
    'email_notice': 'required'  
}

var form_1_rules={
    'sensitivity': 'required'   
}
/* extend form_1_rules by merging "rules" */
form_1_rules= $.extend({}, form_1_rules,all_forms_rules)

$(".submit_camera").click(function() {
    $("#AddForm1").validate({
            /* pass rules object as variable */             
          rules: form_1_rules

    })
}); 
```

# c - 来自windows的Linux opengl es 2.0

> ID：11182285
> 
> 赞同：0
> 
> 时间：2012-06-25T00:29:01.290
> 
> 标签：c, linux, opengl-es, opengl-es-2.0

我对图像的图形效果很少，我可以在带有 opengl es 2.0 的 Windows 7 Visual Studios 2008 上运行。在 ARM 模拟器上。

现在我想将我的实现移植到嵌入式设备的 linux 上。我对 linux 没有任何想法，直到现在才开始研究它。

是否有人可以提供入门或一些材料，以便我可以开始将 Windows 移植到嵌入式 linux。

其次，它是我只需要从 Windows 复制到 linux 的相同代码吗？

我想在我的系统中安装 Ubuntu，并尝试使用来自 Eclipse的 Linux Opengl es 2.0 Emulator [Emulator for linux在 ubuntu 中运行该项目。](http://www.malideveloper.com/opengl-es-20-emulator.php)

如果我在将代码从 Windows 移植到 Linux 的正确路径上，请帮助我

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T08:17:27.933

拥有完全兼容的 OpenGL ES 2.0（如果需要，也可以是 1.0/1.1）环境的最佳方法是使用 GPU 制造商的 SDK 之一。

最常见且做得最好的一种是来自 Imagination 技术的 PowerVR GPU 系列（Iphones 和许多 Androids [http://en.wikipedia.org/wiki/List_of_PowerVR_products](http://en.wikipedia.org/wiki/List_of_PowerVR_products)）

您可以从此链接下载并安装模拟器和 SDK：

[http://www.imgtec.com/powervr/insider/sdkdownloads/](http://www.imgtec.com/powervr/insider/sdkdownloads/)

您的请求的另一种解决方案是我的首选，即不使用模拟器，研究 ES 世界和标准 OpenGL 库之间的差异，并编写代码以在两个世界上顺利运行（有适当的例外和差异）。

通过这种方式，您将在努力结束时拥有在两个宇宙（移动和桌面）上完全可操作的代码。两只鸟用一块石头。

这是我的 PATRIA 3D 引擎开发所遵循的方式。

干杯毛里齐奥

# javascript - 带有显示整个网页的 src url 的固定大小 iframe

> ID：11182290
> 
> 赞同：0
> 
> 时间：2012-06-25T00:30:26.533
> 
> 标签：javascript, jquery, html, css, iframe

我是使用 iframe 的新手，我一直在尝试找出一种方法，让带有 src 链接的 iframe 在 iframe 中显示网页的全部内容。换句话说，我试图让在固定大小的 iframe 中显示的网页拉伸以适应。我不确定这是否可以单独使用 html/css 来完成，或者我是否需要使用 JQuery？如果可能的话，我更喜欢使用 css/html 来实现这一点。

```
<iframe style="width:150px; height:300px;" src="http://www.google.com/"></iframe> 
```

# c# - 有没有一种方法可以访问 .net 实体属性，而无需使用数组循环直接调用它？

> ID：11182292
> 
> 赞同：2
> 
> 时间：2012-06-25T00:30:44.780
> 
> 标签：c#, .net, asp.net-mvc, entity-relationship

在 Entities 文件夹中，我们有不同类型的实体，例如 User.cs。在 User.cs 中，我们有这个实体的属性，例如：

```
 public string UserName { get; set; }
    public string ProfileImagePath { get; set; } 
```

除了像 User.UserName 一样直接调用这些属性之外，还有其他方法可以访问这些属性吗？

如果我们可以在不知道属性名称的情况下循环浏览属性列表，那就太好了。我们正在考虑对于实体中的第一个属性可能类似于 User[0]。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T00:35:01.330

您可以使用反射：

```
foreach(var property in entity.GetType().GetProperties()){
    var value = property.GetValue(entity, null);
    // do whatever you want to do with the value
} 
```

您可能必须添加一些`BindingFlags`类似`BindingFlag.Instance`和`BindingFlags.Public`（我不太确定默认值）。如果是这种情况，请使用`entity.GetType().GetProperties(BindingFlag.Instance || BindingFlags.Public)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T00:36:27.743

你可能想看看反射。像这样的东西可以让你枚举`yourInstance`类对象的所有字符串属性值`A`：

```
foreach(var propertyInfo in typeof(A).GetProperties())
{
    if(Type.GetTypeCode(propertyInfo.PropertyType) == TypeCode.String)
        Console.WriteLine((string)propertyInfo.GetValue(yourInstance, null));
} 
```

# ruby-on-rails - has_many 通过单选按钮

> ID：11182296
> 
> 赞同：1
> 
> 时间：2012-06-25T00:31:38.193
> 
> 标签：ruby-on-rails, has-many-through

努力获得 has_many :through 关系与具有由单选按钮表示的关系的表单正常工作。

该关系描述了一个作业，该作业可以具有与之关联的各种元数据，并且这些元数据可以是不同的类型。这个模型背后的想法是，我最终将能够将其他元数据添加到其他类型的作业中，例如某种类别或价值的类别，而无需添加新表等。

在这种情况下，我有一个提交工作的表单，其中一个字段是工作类型（全职、兼职、咨询、自由职业），由四个单选按钮表示。

因此，当您保存在数据库中时，您将拥有相应的表：

```
jobs
 id - 1
 title - "Rails Developer"

jobs_metadata
 job_id - 1
 metadata_id - 1

metadata
 id - 1
 description - "Full Time"
 metadatum_type_id - 1

metadatum_types
 id - 1
 description - "Job Type" 
```

以下是我的模型的摘要：

**工作模式**

```
class Job < ActiveRecord::Base
   has_many :jobs_metadata
   has_many :metadata, :through => :jobs_metadata 
```

**元数据（元数据的单数）模型**

```
class Metadatum < ActiveRecord::Base
   has_one :metadata_type
   has_many :jobs_metadata
   has_many :jobs, :through => :jobs_metadata 
```

**JobMetadatum 模型**<-- 我可能会在此表中添加其他字段，因此 :through

```
class JobsMetadatum < ActiveRecord::Base
   belongs_to :job
   belongs_to :metadatum 
```

**MetadataType 模型**<-- 示例中不需要，但为了完整性而包含在内

```
class MetadataType < ActiveRecord::Base
   has_many :metadata 
```

这是表示作业视图中单选按钮的代码

**查看代码**

```
<% @job_types.each do |job_type| %>
  <%= radio_button_tag("job[metadatum_ids]", job_type.id) %>
  <%= job_type.description %>&nbsp;
<% end %> 
```

当我保存表单时 - 一切似乎都正确填充，但是当我切换到编辑模式时，未选中对应于 jobs_metadata 值的单选按钮。

所以我想我的问题是双重的：

1.  我是否在上面正确定义了关系？我在做这种“Rails 方式”吗？
2.  我是否正确定义了表单单选按钮 - 如果是这样，我如何让它们在从数据库读取时正确检查值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:54:36.447

尝试在对 radio_button_tag 的调用中指定第三个选项以使其被选中：

```
<%= radio_button_tag("job[metadatum_ids]", job_type.id, true) %> 
```

有关更多详细信息，请参见此处：http: [//api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-radio_button_tag](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-radio_button_tag)

显然，您希望根据测试它是真实的，因此您可以在作业对象上定义方法，例如

```
def full_time?
  self.metadata.include?(Metadata.find(1))
end 
```

进而：

```
<%= radio_button_tag("job[metadatum_ids]", job_type.id, job.full_time?) %> 
```

我的例子可能不是你想要的，但你希望能明白。

# ios - 复杂对象上的自定义 NSSortDescriptor

> ID：11182297
> 
> 赞同：3
> 
> 时间：2012-06-25T00:32:01.220
> 
> 标签：ios, cocoa, core-data, nssortdescriptor

这是我的第一篇文章，如果我可能不遵守所有惯例，即使我会尽力而为，我深表歉意。我之前一直在 SO 上找到解决问题的方法，但我完全陷入了一个相当复杂的 Cocoa 问题。

我正在尝试对 CoreData 对象列表进行复杂排序。我有一个由 Book 对象组成的目录，它可以是 Saga 的一部分（第一本书及其续集）。简化的结构如下所示：

```
@interface Book : NSManagedObject
@property (nonatomic, retain) NSString * title;
@property (nonatomic, retain) NSNumber * tomaison; //volume numbering
@property (nonatomic, retain) Saga *fromSaga;

@interface Saga : NSManagedObject
@property (nonatomic, retain) NSString * title; 
```

我正在尝试在 Book 上对我的 CoreData 数据库执行查询：

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Book" inManagedObjectContext:context]; 
```

我需要分三个步骤进行排序：

1）按书籍的流派排序（不包含在上面的代码中，因为它不需要），执行如下：

```
NSSortDescriptor* mainSort = [[NSSortDescriptor alloc] initWithKey:@"ofGenre.title" ascending:YES selector:@selector(localizedCaseInsensitiveCompare:)]; 
```

2) 如果书是 Saga 的一部分，则按 Saga 标题排序

```
NSSortDescriptor* secondarySort = [[SagaTitleSortDescriptor alloc] initWithKey:@"fromSaga" ascending:YES]; 
```

自定义排序描述符由以下内容定义：

```
#define NULL_OBJECT(a) ((a) == nil || [(a) isEqual:[NSNull null]])
@interface SagaTitleSortDescriptor : NSSortDescriptor {}
@end
@implementation SagaTitleSortDescriptor
- (id)copyWithZone:(NSZone*)zone
{
    return [[[self class] alloc] initWithKey:[self key] ascending:[self ascending] selector:[self selector]];
}
- (NSComparisonResult)compareObject:(id)object1 toObject:(id)object2
{
    if (NULL_OBJECT([object1 valueForKeyPath:[self key]])) {
        if (NULL_OBJECT([object2 valueForKeyPath:[self key]])) 
            return NSOrderedSame;
        return NSOrderedDescending;        
    }
    if (NULL_OBJECT([object2 valueForKeyPath:[self key]])) {
        return NSOrderedAscending;
    }
    return [super compareObject:[(Saga*)object1 title] toObject:[(Saga*)object2 title]];
}
@end 
```

3) 如果它是 Saga 的一部分，则按卷编号排序，否则，按书名排序。这是我的问题，因为我不知道要发送什么密钥以及要在我的描述符中放入什么（我什至不确定这是否可能）。

```
NSSortDescriptor* thirdSort = [[SagaTomaisonOrBookTitleSortDescriptor alloc] initWithKey:@"self" ascending:YES]; 
```

到目前为止，我发现 @"self" 允许发送被查询的对象，但它似乎不允许在发送的对象中查询参数。作为参考，我尝试了一些代码：

```
- (NSComparisonResult)compareObject:(id)object1 toObject:(id)object2
{
    if (NULL_OBJECT([(Book*)object1 fromSaga]) && NULL_OBJECT([(Book*)object2 fromSaga])) {
        return [super compareObject:[(Book*)object1 title] toObject:[(Book*)object2 title]];
    }
    if (NULL_OBJECT([(Book*)object1 fromSaga])) {
        return NSOrderedDescending;
    }
    if (NULL_OBJECT([(Book*)object2 fromSaga])) {
        return NSOrderedAscending;
    }
    return [super compareObject:[(Book*)object1 tomaison] toObject:[(Book*)object1 tomaison]];
} 
```

知道我能做什么和应该做什么吗？

谢谢 ！

编辑：最后一行有一个类型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:05:09.470

如果您不使用基于 SQL 的存储，则可以通过将 self 作为键并将 compare: 作为选择器来执行此操作，然后实现该自定义选择器。也就是说，在你的 book 类上创建一个名为 compare: 的方法，让它完成你的所有逻辑，而不是使用多个排序描述符。

# android - 实现Android Search Activity，在Eclipse中无法解析SearchManager

> ID：11182301
> 
> 赞同：0
> 
> 时间：2012-06-25T00:32:41.673
> 
> 标签：android, search, android-activity, searchmanager

我正在尝试创建一个可搜索的活动，但是当我到达这一点时，我在 SearchManager （在 Eclipse 中）下有一个红色的波浪线，它说：

```
SearchManager cannot be resolved to a variable 
```

它给了我 8 个快速修复，但如果它们有帮助，则没有。我错过了一些简单的事情吗？我正在构建 4.0，我的 minSDK 是 7，targetSDK 是 13。T

```
private void handleIntent(Intent intent) {
    if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
        // handles a search query
        String query = intent.getStringExtra(SearchManager.QUERY);
        doMySearch(query);
    }
} 
```

[http://developer.android.com/guide/topics/search/search-dialog.html#SearchDialog](http://developer.android.com/guide/topics/search/search-dialog.html#SearchDialog)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:37:50.517

这属于 Google APIs 部分。在 Project Properties > Android 下将构建目标更改为 Google API。

![构建目标](../Images/fa45bd52c1cd1334c133aaa4782f4dd0.png)

# ruby-on-rails - 通过生成名为 Controller 的脚手架来破坏 Rails 应用程序

> ID：11182304
> 
> 赞同：1
> 
> 时间：2012-06-25T00:33:25.493
> 
> 标签：ruby-on-rails, ruby-on-rails-3

自学 Rails 并遇到以下我似乎找不到任何信息的问题。

我似乎通过生成一个名为“Controller”的脚手架破坏了我的 Rails 应用程序。该应用程序跟踪硬件控制器，因此我想创建一个脚手架和数据库来保存有关存储的硬件控制器的所有信息。

我运行了以下内容：

```
rails generate scaffold Controller manufacturer:references model:string controller_type:references 
```

我运行`rake db:migrate`并重新加载了应用程序网站的根路径（它不使用 Controller，但其他几个以前工作正常的模型）并得到以下错误页面：

> 路由错误
> 
> 没有路由匹配 {:action=>"show", :controller=>"controllers"} 尝试运行 rake 路由以获取有关可用路由的更多信息。

我跑了`rails destroy Controller`，所有相关的文件夹和文件都不见了，但我仍然收到错误页面。

我是否不小心覆盖了内置控制器名称？在此先感谢您提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T05:27:46.053

该命令可能将此行添加到您的`config/routes.rb`：

```
 resources :controllers 
```

只需删除该行，重新启动您的服务器*，然后再试一次。

* * *

* 您不需要重新启动，因为路由是按请求重新加载的，但有时会发生奇怪的事情。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T03:36:18.983

你可以设置你的根路由`[rails]/config/routes.rb`

`root :to => 'welcome#index'`

`welcome = controller name`

# javascript - 我正在制作我的作品集，我想使用 Spotify API 来显示我当前正在收听的内容，但不想使用“播放”按钮

> ID：11182307
> 
> 赞同：3
> 
> 时间：2012-06-25T00:34:12.037
> 
> 标签：javascript, css, html, spotify

大部分是不言自明的，但我只想将歌曲标题和艺术家作为 JavaScript 纯文本对象发送，所以我可以自己在 CSS 中设置样式。并且可能有一种方法可以将它链接回 Spotify 上的歌曲也很酷。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-09T14:49:22.113

将您的 spotify 链接到 Last FM - [http://www.spotify.com/uk/about/spotify-on-the-web/spotify-last-fm/](http://www.spotify.com/uk/about/spotify-on-the-web/spotify-last-fm/)

然后在您注册 Last FM 后获取 API 密钥，您可以使用以下脚本（需要 jQuery）和 html 来展示您所听的内容：

```
<ul>
<li class=”artist”&gt;Artist: &nbsp; </li>
<li class=”track”&gt;Track: &nbsp; </li>
</ul>  

$.getJSON('http://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=[USERNAME]&api_key=[KEY]&format=json', function(data) {

var artist = $(".artist"),
track = $(".track"),
artistVal = data.recenttracks.track[0].artist["#text"],
trackVal = data.recenttracks.track[0].name;

artist.append(artistVal);
track.append(trackVal);

}); 
```

将**[Key]**替换为 API 密钥，将**[Username]**替换为您的 Last FM 用户名

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T08:35:32.923

我们没有直接执行此操作的 API，但有两种方法：

1) 如果您使用的是 Mac OS，请编写一个小应用程序以使用 Spotify 的 AppleScript 字典查看正在播放的内容并将其上传到某个地方。

2) 如果没有，请编写一个在 Spotify 内部运行并上传信息的 Spotify 应用程序。但是，您必须保持该应用程序处于活动状态，否则它将被暂停。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T03:04:12.967

另一种选择是将 Spotify 客户端配置为[scrobble](http://www.urbandictionary.com/define.php?term=Scrobble)到 facebook，然后使用[open graph api](http://developers.facebook.com/docs/reference/api/)来查询它。您需要为自己获取一个访问令牌以请求 music.listens 权限，然后通过以下方式访问它：[https ://graph.facebook.com/me/music.listens](https://graph.facebook.com/me/music.listens)

# c# - 在 C# 中，如何停止从其绑定委托之一执行事件？

> ID：11182310
> 
> 赞同：3
> 
> 时间：2012-06-25T00:34:50.240
> 
> 标签：c#, .net, events

我目前正在使用一个事件来触发一组委托，并且我需要能够防止剩余的委托从另一个委托中触发。

以下代码复制了该场景...

```
//nonsense class
public class Foo {
    public string Bar { get; set; }
}

//nonsense event.
public event Action<Foo> SomeEvent;

void BindAndFire() {
    //wire it up.
    SomeEvent += (foo) => { 
        var a = DateTime.Now.Millisecond % 2;
        foo.Bar = (a == 0) ? "Hooray" : "Boo";
    };
    SomeEvent += (foo) => { 
        if(foo.Bar == "Boo") {
            SomeEvent.CANCEL_THE_REST(); //what do I do here?
        }
    };
    SomeEvent += (foo) => { 
        foo.Bar += ", you made it!";
    };

    //fire the event.
    SomeEvent(new Foo());
} 
```

鉴于上述情况，我需要做什么？我 100% 可以更改为操作列表或其他内容，但似乎我应该能够停止执行后续事件。

**注意：显示的代码只是复制问题，而不是我的程序结构。**实际的程序正在处理传入的网络事件，并有一个在它们上运行的任意委托列表......我不想为一个问题发布整个事情。

...也许我只是想以他们不打算使用的方式使用它们，我很好，我只是希望我只需要学习一些关于事件的新事物C＃。

感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:49:47.163

您可以使用 HandledEventArgs 之类的东西（或使用类似的概念），这样，在处理事件时，您可以设置“已处理”属性并在其他委托中检查此属性。

不确定您是否可以强制它取消所有其他调用，如果您稍后再进行调试，可能会有些混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T00:46:07.320

我想我可能已经回答了我自己的问题。

我最终做的是让我的代表返回一个布尔值，然后当我去执行我的事件时，我实际上使用 GetInvocationList() 来获取代表并调用它们，检查返回值......

新代码如下所示：

```
//nonsense class
public class Foo {
    public string Bar { get; set; }
}

//nonsense event.
public event Func<Foo, bool> SomeEvent;

void BindAndFire() {
    //wire it up.
    SomeEvent += (foo) => { 
        var a = DateTime.Now.Millisecond % 2;
        foo.Bar = (a == 0) ? "Hooray" : "Boo";
        return true;
    };
    SomeEvent += (foo) => { 
        return foo.Bar != "Boo";
    };
    SomeEvent += (foo) => { 
        foo.Bar += ", you made it!";
        return true;
    };

    //fire the event.
    var f = new Foo();
    foreach(var s in SomeEvent.GetInvocationList()) {
        if(!s.DynamicInvoke(f)) break;
    }
} 
```

**编辑：我最终结合了我的答案和上面的蓝莓，因为它更适合我的工作。所以在我的例子中，其中一个事件参数有一个 Close() 方法，开发人员可能会在他的委托内部调用该方法，所以在那里，我设置了一个属性，然后我将在循环 GetInvocationList() 时检查并中断该属性。**

```
//nonsense class
public class Foo {
    public string Bar { get; set; }
    public bool IsClosed { get; private set; }
    public void Close() {
        IsClosed = true;
    }
}

//nonsense event.
public event Action<Foo> SomeEvent;

void BindAndFire() {
    //wire it up.
    SomeEvent += (foo) => { 
        var a = DateTime.Now.Millisecond % 2;
        foo.Bar = (a == 0) ? "Hooray" : "Boo";
    };
    SomeEvent += (foo) => { 
        if(foo.Bar != "Boo") {
           foo.Close();
        }
    };
    SomeEvent += (foo) => { 
        foo.Bar += ", you made it!";
    };

    //fire the event.
    var f = new Foo();
    foreach(var s in SomeEvent.GetInvocationList()) {
        s.DynamicInvoke(f);
        if(f.IsClosed) break;
    }
} 
```

# javascript - 如何将使用 getter 检索到的 Ember 数据放入临时变量中进行处理

> ID：11182314
> 
> 赞同：0
> 
> 时间：2012-06-25T00:35:22.827
> 
> 标签：javascript, ember.js

我有一个最好用这里的代码解释的情况[http://jsfiddle.net/sabithpocker/EsF4R/34/](http://jsfiddle.net/sabithpocker/EsF4R/34/) 点击年份查看问题。

这是一个示例视图：

```
App.myView = Ember.View.extend({
date : new Date(),
dateString : function(){
    return this.get('date').getFullYear();
    }.property().cacheable(),
click : function(e){
    this.$().append('<br/>clicked: now this.get("date") = ' + this.get('date').getFullYear());
    var tempDate = this.get('date');
    tempDate.setFullYear(1988);
    this.$().append("<br/>tempDate :" + tempDate.getFullYear() + " & " + "this.get('date') :" + this.get('date').getFullYear());
    }
}); 
```

在点击事件中，我试图将日期存储到临时变量中进行存储，但是当我处理临时变量时，更改会反映在原始变量上。它是我不想要的。

我通过这样做克服了这个问题：

```
var tempDate = new Date(this.get('date')); 
```

但我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:49:13.213

> var tempDate = this.get('date');
> 
> ```
> tempDate.setFullYear(1988); 
> ```

this.get('date') 返回对对象的引用。您正在原始对象本身上设置年份。

当你这样做时：

> var tempDate = new Date(this.get('date'));

您已将原始对象克隆为新对象。所有进一步的操作都不会操纵原始对象。

# python - 从函数的返回值创建表

> ID：11182317
> 
> 赞同：0
> 
> 时间：2012-06-25T00:35:59.723
> 
> 标签：python

我有这个;

```
import operator
cuts = { "Emerald" : (10,125),
         "Oval" : (20,150),
         "Pear" : (35, 175),
         "Plumbbob" : (50,200),
         "Marquis" : (75, 230),
         "Crystal Ball" : (100, 260),
         "Brilliant" : (250, 350),
         "Star Cut" : (400,400),
         "Heart-shaped" : (1000, 500)
         }

def best(amount):
    "Returns most profitable cut's name."
    max_name = ""
    max_value = -10000
    for k,v in cuts.iteritems():
        value = ((float(amount) * (v[1] - 100) / 100)) - v[0]
        if value > max_value:
            max_value = value
            max_name = k
    return max_name

def create_table():
    """Creates a table like

       0-40 emerald
       40-45 Oval
       ...
       2000 + Heart-shaped
    """ 
```

但我坚持写作`create_table`。此代码用于帮助我正在玩的游戏。`best`函数，给定一个数量，返回该数量的最有利可图的切割名称。我想创建一个显示范围的表格。例如，对于 0-40 之间的数量，最佳切工是祖母绿，40-45 之间的最佳切工是椭圆形等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:43:05.933

```
def create_table():
    curname = None
    for amount in xrange(2500):
        name = best(amount)
        if name != curname:
            if curname is not None:
                print "%d-%d %s" % (minamt, amount-1, curname)
            curname = name
            minamt = amount
    print "%d-%d %s" % (minamt, amount-1, curname) 
```

（未测试，顺便说一句）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:24:12.370

分析解决方案无疑是矫枉过正......但是，嘿，我喜欢矫枉过正。

首先，我转化`cuts`为 y=mx+b 格式：

```
cuts = [(k, (v1-100)*0.01,-v0) for k,(v0,v1) in cuts.items()]
cuts.sort() 
```

导致

```
cuts = [
    ('Brilliant',       2.5,    -250),
    ('Crystal Ball',    1.6,    -100),
    ('Emerald',         0.25,    -10),
    ('Heart-shaped',    4.0,   -1000),
    ('Marquis',         1.3,     -75),
    ('Oval',            0.5,     -20),
    ('Pear',            0.75,    -35),
    ('Plumbbob',        1.0,     -50),
    ('Star Cut',        3.0,    -400)
] 
```

对于每对切割，我可以找到交点 - 两个切割值相同的宝石尺寸

```
from itertools import combinations

xints = []
for (na,ma,ba),(nb,mb,bb) in combinations(cuts, 2):
    xint = (bb-ba)/(ma-mb)
    val = ma*xint + ba

    # figure out which cut dominates to the right
    va = ma*(xint+0.01)+ba
    vb = mb*(xint+0.01)+bb
    if vb > va:
        xints.append((xint,val,na,nb))
    else:
        xints.append((xint,val,nb,na)) 
```

这会产生 36 个交叉点，其中大部分是多余的 - 在这一点上，其他一些切割更有价值。所以我们过滤：

```
xints = [(xint,val,na,nb) for xint,val,na,nb in xints if all(nc==na or nc==nb or mc*xint+bc <= val for nc,mc,bc in cuts)]
xints.sort() 
```

留下 10 个有效的交叉点：

```
[
    (40.0, 0.0, 'Emerald', 'Oval'),
    (60.0, 10.0, 'Oval', 'Pear'),
    (60.0, 10.0, 'Oval', 'Plumbbob'),
    (60.0, 10.0, 'Pear', 'Plumbbob'),
    (83.33333333333331, 33.333333333333314, 'Marquis', 'Crystal Ball'),
    (83.33333333333331, 33.333333333333314, 'Plumbbob', 'Crystal Ball'),
    (83.33333333333331, 33.333333333333314, 'Plumbbob', 'Marquis'),
    (166.66666666666669, 166.66666666666674, 'Crystal Ball', 'Brilliant'),
    (300.0, 500.0, 'Brilliant', 'Star Cut'),
    (600.0, 1400.0, 'Star Cut', 'Heart-shaped')
] 
```

通过检查，我们看到 Pear 和 Marquis 切割是多余的——它们仅在交叉点处具有竞争力——因此我们丢弃它们出现的 4 个项目，得到

```
[
    (40.0, 0.0, 'Emerald', 'Oval'),
    (60.0, 10.0, 'Oval', 'Plumbbob'),
    (83.33333333333331, 33.333333333333314, 'Plumbbob', 'Crystal Ball'),
    (166.66666666666669, 166.66666666666674, 'Crystal Ball', 'Brilliant'),
    (300.0, 500.0, 'Brilliant', 'Star Cut'),
    (600.0, 1400.0, 'Star Cut', 'Heart-shaped')
] 
```

哪些是最佳交叉点；然后你的桌子最终看起来像

```
Size      Value      Cut
----      -----     ------------
   0       -10
                    Emerald
  40         0
                    Oval
  60        10
                    Plumbbob
  83.33     33.33
                    Crystal Ball
 166.67    166.67
                    Brilliant
 300       500
                    Star Cut
 600      1400
                    Heart-shaped 
```

严格来说，您可能会丢弃祖母绿切割，因为预期值是负数（对任何小于 40 的宝石进行切割都会让您损失金钱）。

# powerbuilder - 将数据窗口导出为 PDF

> ID：11182320
> 
> 赞同：0
> 
> 时间：2012-06-25T00:36:47.683
> 
> 标签：powerbuilder, datawindow

我正在使用以下代码 ds_data.Object.DataWindow.Export.PDF.Method = Distill 将 DataWindow 导出为 PDF！ds_data.Object.DataWindow.Printer = "Sybase DataWindow PS" ds_data.Object.DataWindow.Export.PDF.Distill.CustomPostScript="Yes"

我可以导出为 PDF，但 DataWindow 的列太多，因为它们不适合 PDF 的单页。即数据窗口的一半列显示在 PDF 的第 1 页，其余列显示在第 2 页。

在这种情况下，any1 可以帮助我吗？我希望将整个 DataWindow 装入单个 PDF（宽度方向）。如果无法将整个 DataWindow 放入 PDF 的单页中，那么我们可以为 PDF 设置水平滚动条吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T04:48:16.447

我得到了同样的解决方案。单击数据窗口的属性。然后选择“打印规范”选项卡。将“PaperOrientation”属性设置为“Landscape”。早些时候它是“默认”。这解决了我的问题

# c# - System.Web.Caching.Cache 是否有望在沙盒中工作？

> ID：11182321
> 
> 赞同：2
> 
> 时间：2012-06-25T00:36:55.260
> 
> 标签：c#, sandbox, code-access-security, partial-trust

我正在尝试在沙箱中运行一段代码。它失败了，问题来自使用缓存的代码部分。

## 它按预期工作的情况：

```
public void Demo()
{
    // Verify that the code is running in a sandbox: the next line is expected to
    // fail, since the sandbox doesn't have enough I/O privileges to access H:\.
    File.WriteAllText(@"H:\Hello.txt", "Hello");
} 
```

按预期工作，即抛出异常，显示“请求权限 [...] FileIOPermission [...] 失败。”。

当我通过调用数据库替换代码时，再次出现预期结果：应用程序抱怨没有足够的权限。

如果我添加请求的权限，代码将毫无例外地执行。

## 失败的情况：

如果我将以前的方法替换为：

```
public void Demo()
{
    Cache cache = HttpRuntime.Cache;
    File.WriteAllText(@"H:\Hello.txt", "Hello");
} 
```

它停止工作：不是预期的异常抱怨 I/O 权限不足，而是抛出的异常是`System.Security.SecurityException`：

> 该程序集不允许部分受信任的调用者。

是否与此问题有关，或者缓存不打算在完全信任以外的场景中使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T15:42:05.153

以部分信任运行的代码内部使用缓存的一种可能方法是将缓存对象移到插件外部。适配器模式可用于使插件仍然能够从缓存中读取和写入数据，同时由调用者在完全信任的上下文中管理缓存。

如果其他人有兴趣，我[在 CodePlex 上发布的项目中说明](http://cacheinsandbox.codeplex.com/)[了原始问题](http://cacheinsandbox.codeplex.com/SourceControl/changeset/changes/17587)和解决方案。

# python - AssertionError：此 AttributeImpl 未配置为跟踪父级

> ID：11182322
> 
> 赞同：1
> 
> 时间：2012-06-25T00:37:02.590
> 
> 标签：python, sqlite, sqlalchemy

我最近遇到了这个问题，我已经坚持了几天了。基本上，这里感兴趣的两个表是“Activity”和“Goal”，其中 Activity 是 Goal 的单亲；一个目标只有一个父级，一个活动有一个或多个目标子级：

```
class Activity(Base, Table):
    __tablename__ = 'activity'

    pk_id = Column(Integer, primary_key=True)
    name = Column(String)
    wave = Column(Integer)
    enabled = Column(Boolean)

    goals = relationship("Goal", backref='activity', single_parent=True, cascade="all,delete-orphan")
    activity_tags = relationship("ActivityTags", backref='tag_activity', cascade="all,delete-orphan") 
```

和

```
class Goal(Base, Table):
    __tablename__ = 'goal'

    pk_id                 = Column(Integer, primary_key=True)
    activity_id           = Column(Integer, ForeignKey('activity.pk_id'))
    category_id           = Column(Integer, ForeignKey('category.pk_id'))

    name                  = Column(String)
    minutes_expected      = Column(Integer)
    date_last_invoked     = Column(Date)
    date_last_invalidated = Column(Date)
    enabled               = Column(Boolean)

    milestones = relationship("Milestone", backref='goal', single_parent=True, cascade="all,delete-orphan") 
```

现在，当我创建一个 Activity 对象（进而创建 1 个 Goal 子对象）时，我遇到了这个错误：

```
Traceback (most recent call last):
  File "unit.py", line 49, in wrapper
    r = func(*args, **kwargs)
  File "unit.py", line 158, in testActivityWaveOverdue
    a = Activity(c, 'Pull-Ups', wave)
  File "<string>", line 4, in __init__
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/state.py", line 98, in initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
  File "/home/me/dev/coach/coach/activity.py", line 64, in __init__
    self.add_goal(category, 'maintenance')
  File "/home/me/dev/coach/coach/activity.py", line 190, in add_goal
    return Goal(self, category, name, minutes_expected)
  File "<string>", line 4, in __init__
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/state.py", line 98, in initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
  File "/home/me/dev/coach/coach/goal.py", line 76, in __init__
    db.session.commit()
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 656, in commit
    self.transaction.commit()
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 314, in commit
    self._prepare_impl()
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 298, in _prepare_impl
    self.session.flush()
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 1583, in flush
    self._flush(objects)
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 1636, in _flush
    is_orphan = _state_mapper(state)._is_orphan(state) and state.has_identity
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/mapper.py", line 1237, in _is_orphan
    state, key, optimistic=bool(state.key)):
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/instrumentation.py", line 331, in has_parent
    return self.get_impl(key).hasparent(state, optimistic=optimistic)
  File "/home/me/dev/coach/.venv/lib/python2.7/site-packages/sqlalchemy/orm/attributes.py", line 349, in hasparent
    assert self.trackparent, "This AttributeImpl is not configured to track parents."
AssertionError: This AttributeImpl is not configured to track parents. 
```

这是活动初始化代码：

```
def __init__(self, category, name, wave):
    self.name = name
    self.wave = wave
    self.enabled = True
    db.session.add(self)
    db.session.commit()

    self.add_goal(category, 'maintenance')

def add_goal(self, category, name, minutes_expected=30):
    return Goal(self, category, name, minutes_expected) 
```

还有目标：

```
def __init__(self, activity, category, name, minutes_expected):
    self.activity_id            = activity.pk_id
    self.category_id            = category.pk_id
    self.name                   = name
    self.minutes_expected       = minutes_expected

    self.date_last_invoked      = START_OF_TIME
    self.date_last_invalidated  = START_OF_TIME
    self.enabled                = True

    db.session.add(self)
    db.session.commit() 
```

如果您希望我在上面包含其他任何内容，请告诉我 - 我不想让帖子变得比需要的大，所以只包含我认为与问题相关的内容。

最后，Activity 和 Goal 继承自的“Table”超类只是提供了辅助/辅助方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:31:38.627

这里有一些非常规的用法，并且您的 _ *init* _s 中存在一些不必要的循环，因为 sqlalchemy 的 ORM 已经为您做了什么，这可能会导致问题。

ORM 已经能够让您的 Activity 和 Goal 实例在逻辑上链接在一起，而无需您在`__init__`方法中强制执行此操作。

尝试以下操作：

1.  不要`Goal.__init__`将活动作为参数。顺便说一句，您甚至*不必为*`__init__`使用 sqlalchemy 的声明性基础的模型类编写方法；你可以，但只有当你真的需要完成一些额外的事情时才有必要。那么您的新 Goal 实例将如何链接到它的一个 Activity 实例呢？Activity.goals 关系及其 backref 会为您处理这些问题。

2.  顺便说一句，由于每个 Goal 仅与单个 Activity 相关联，因此您应该更改 backref 的形式。您的 current`backref='activity'`将生成与每个目标相关联的活动集合（在这种情况下，默认情况下为列表）。给定您的模型描述，您想要的是`backref=backref('activity', uselist=False)`. 这将导致对 somegoal.activity 的引用返回单个对象（在 sqlalchemy 术语中，一个“标量”），而不是列表。

3.  没有`Activity.__init__`添加目标；只需在调用 Activity() 以创建您的活动实例的代码部分中执行此操作。一般来说，建立像你在这里的初始化链是不必要的复杂化，其中在内部实例化一个事物会导致另一个事物的实例化。最好将该活动提升到一个级别并将其放入想要执行这些操作的主程序代码中，并让每个实例化都用自己的代码行明确。比把它藏在`__init__`s 里面要好得多。这也更加pythonic（显式优于隐式，使用更少的“魔法”）。

4.  Notice that in your `Activity.add_goal()` method nothing is actually *done* with the return value. Don't write methods whose return value is thrown away, or where some other method (in this case a constructor) is called only for side effects. And points 1 and 3 above could be summarized as "don't write constructors with side effects".

My point here is not to be dogmatic; I hope you can see that each of these suggestions is for the purpose of creating code that is clearer and accomplishes the desired things with less complication, and which turns out easier to read, to follow, and to debug.

至于对错误回溯中发生的事情的实际分析：我们需要一个实际工作的代码示例才能真正做到这一点，但我的猜测是 sqlalchemy 会按照您的要求创建您的 Activity 对象，并尝试遵循`Activity`该类映射器`relationship`创建从新活动到目标的前向引用，以及从目标到活动的反向引用。`__init__`但是在此过程中，您试图让您的 s 做一些工作的方式让您感到困惑。我认为如果你解开并简化一点，你很可能会得到你想要的。

Final note: If you have not gone through sqlalchemy's ORM tutorial section by section and followed every bit of it directly, that is strongly recommended. Along the way (and in following some of the background references on the side) you would find examples showing situations like the one you want to model here, and other very similar ones, and you'd see the most common (and simplest/clearest/easiest) ways of setting them up.

# java - 使用动作监听器设置目录

> ID：11182325
> 
> 赞同：1
> 
> 时间：2012-06-25T00:38:01.470
> 
> 标签：java

我有一个设置文件夹目录的重命名工具，但是我创建了一些 JCheckBox，我希望他们能够根据选择的目录更改目录。

她是复选框的动作侦听器，它编辑 txt 字段，使其在程序上看起来正确，但实际上并没有更改目录。

```
cbxBlackBerry = new JCheckBox("BlackBerry");
        cbxBlackBerry.addActionListener(
                new ActionListener(){
                    public void actionPerformed(ActionEvent e){
                            if(cbxBlackBerry.isSelected())
                            txtPrefix.setText("x-rimdevice_");
                        else{
                            txtPrefix.setText("");
                        }

                        if(cbxBlackBerry.isSelected())
                            txtDirectory.setText("\\RSASoftToken\\blackberry");
                        else{
                            txtDirectory.setText("");
                        }
                    }
                }
            ); //close addActionListener 
```

这是命令目录设置的代码

```
private boolean chooseDirectory(){

        /* Choose the file Directory
         * this will ensure that the class variable directory get the value
         * only when a directory is chosen, then the button Ok will be enabled
         */

        JFileChooser fc = new JFileChooser();
        fc.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
        fc.setAcceptAllFileFilterUsed(false);

        int returnval = fc.showOpenDialog(this);

        if(returnval == JFileChooser.APPROVE_OPTION){
            directory = fc.getSelectedFile();
            btnOk.setEnabled(true);
            return true;        
        }

        return false;
    }// end chooseDirectory 
```

如何修改此代码以实际更改目录？

```
if(cbxBlackBerry.isSelected())
                            txtDirectory.setText("\\RSASoftToken\\blackberry");
                        else{
                            txtDirectory.setText(""); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:10:41.560

您将使用[ChangeListener](http://java.sun.com/javase/ja/6/docs/ja/api/javax/swing/event/ChangeListener.html)类

```
import javax.swing.JCheckBox;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class JCheckboxApp {
  public static void main(String args[]) {
    JFrame frame = new JFrame("CheckBox Example");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JCheckBox cbxBlackBerry = new JCheckBox("BlackBerry");
    final JTextField txtPrefix = new JTextField("textPrefix");
    final JTextField txtDirectory = new JTextField("txtDirectory");
    cbxBlackBerry.addChangeListener(new ChangeListener() {
        public void stateChanged(ChangeEvent changeEvent) {
            JCheckBox source = (JCheckBox) changeEvent.getSource();
            if (source.isSelected()) {
                txtPrefix.setText("x-rimdevice_");
                txtDirectory.setText("\\RSASoftToken\\blackberry");
            } else {
                txtPrefix.setText("");
                txtDirectory.setText("");
            }
        }
    });

    JPanel p = new JPanel();
    p.add(txtPrefix);
    p.add(txtDirectory);
    p.add(cbxBlackBerry);
    frame.add(p);
    frame.setSize(300, 100);
    frame.setVisible(true);
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T01:28:07.707

你需要这样的方法：

```
private void setDirectory(File dir) {
  directory = dir;
  txtDirectory.setText(dir.getAbsolutePath());
} 
```

如果您有设置目录 JTextField 的代码，请改为调用此方法。因此，例如，而不是

```
if(cbxBlackBerry.isSelected())
   txtDirectory.setText("\\RSASoftToken\\blackberry");
else{
   txtDirectory.setText("");
} 
```

执行以下操作：

```
String dirPath = "";
if (cbxBlackBerry.isSelected())
   dirPath = BLACKBERRY_PATH; // a constant
else {
   dirPath = "";
}
setDirectory(new File(dirPath)); 
```

在类的顶部，如果需要，有一个常量：

```
private static final String BLACKBERRY_PATH = "\\RSASoftToken\\blackberry"; 
```

# css - 通过 CSS 应用 colspan？

> ID：11182334
> 
> 赞同：1
> 
> 时间：2012-06-25T00:40:04.530
> 
> 标签：css, html

因此，我正在制作一个利用`display:table`、`display:table-row`和`display:table-cell`. 但是，我遇到了一个问题：

**我需要对我的一个 DIV 应用 colspan。**

但是，将此属性添加到 DIV 几乎是纯粹的邪恶。我有哪些选择？

见：http: [//jsfiddle.net/RhFz6](http://jsfiddle.net/RhFz6)

* * *

# 编辑：

我找到了一个解决方案：http: [//jsfiddle.net/RhFz6/4](http://jsfiddle.net/RhFz6/4)

我没有把所有东西都做成一张桌子，而是把中心区域做成一张桌子。页眉和页脚被保留为块元素。从那里，我给了表格 100% 的高度和负边距，以便它适合页面。结果很漂亮！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T01:45:42.183

我不明白为什么人们宁愿把他们的生活变成一个活生生的地狱，试图伪造一张桌子，而`<table>`标签仍然在那里并且完全可以使用。使用表格，你可以应用所有你想要`rowspan`的。`colspan`添加`table-layout: fixed`，您可以可靠地指定单元格的宽度和高度，据我所知，没有任何缺点。

表格甚至具有有用的功能，例如`cellIndex`and 、`rowIndex`grouping和together 。通过使用表向我们公开的属性，很多事情变得容易多了。`tHead``tFoot``tBodies[]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:22:10.110

你一定要伪造一张桌子吗？从您的 JSFiddle 来看，您似乎只是想将 #sidebar 和 #content 彼此相邻。这可以用浮点数相当容易地完成。如果您试图让#sidebar 和#content div 具有背景并希望它们的高度相同，请尝试将您放在#sidebar 上的背景放在#main 上。即使#sidebar 不是具有背景的元素，它看起来仍然是一样的。

概念证明：http: [//jsfiddle.net/RhFz6/3/](http://jsfiddle.net/RhFz6/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:34:50.357

我想通了，我的解决方案实际上也不需要包装器，这真的很好。看这里：

[http://jsfiddle.net/RhFz6/4](http://jsfiddle.net/RhFz6/4)

让我的处境变得困难的是，除了页眉和页脚之外，我还需要在主体区域中设置三列。此外，布局是可变宽度的，所以我不能只使用伪列。当然，我也不想使用桌子，因为，好吧，我会感到内疚。:P

我没有将整个布局视为表格，这就是我需要列跨度的原因，我只是将中心区域设置为表格。页眉和页脚被简单地显示为块元素。`html`然后我将和的高度设置`body`为 100%，然后使中心内容区域的高度为 100%。不幸的是，这将最小尺寸的布局推到了窗口区域之外，因为它是 100% 的高度加上页眉和页脚。

为了解决这个问题，我只是在伪表格中添加了一些负边距，在单元格中添加了一些正填充（这样在页眉和页脚与表格重叠后您仍然可以看到内容），以及一些花哨的 z-index 工作（因为标题在桌子下方，而不是在桌子上方）

而且，嗯，达达！适用于所有现代浏览器，但未在旧浏览器中测试。谢谢你的帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T00:48:35.497

不确定这是否是您所指的“邪恶”选项，但有一个[column-span](http://www.w3.org/TR/css3-multicol/#column-span)属性，虽然它看起来目前只有[Chrome 和 Opera](http://www.w3schools.com/cssref/css3_pr_column-span.asp)支持。

**编辑：**

查看小提琴示例，如果仅在第一行和最后一行（表格页眉和页脚）上需要 colspan，那么您应该有一些选择。即使您伪造这些行，它也不会破坏内部行的一致列大小。

# sql - WHERE 子句中的引用别名（在 SELECT 中计算）

> ID：11182339
> 
> 赞同：153
> 
> 时间：2012-06-25T00:41:52.203
> 
> 标签：sql, sql-server, tsql

```
SELECT (InvoiceTotal - PaymentTotal - CreditTotal) AS BalanceDue
FROM Invoices
WHERE BalanceDue > 0 --error 
```

在选定列的列表中设置为变量的计算值`BalanceDue`不能在`WHERE`子句中使用。

有没有办法可以？在这个相关问题（[在 Where 子句中使用 MySQL Select Statment 中的变量](https://stackoverflow.com/q/3567863/264031)）中，答案似乎是，实际上，不，您只需写出计算（*并*在查询中执行该计算）两次，没有这是令人满意的。

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2012-06-25T00:54:29.927

您不能在 ORDER BY 中引用别名，因为 SELECT 是评估的倒数第二个子句。两种解决方法：

```
SELECT BalanceDue FROM (
  SELECT (InvoiceTotal - PaymentTotal - CreditTotal) AS BalanceDue
  FROM Invoices
) AS x
WHERE BalanceDue > 0; 
```

或者只是重复表达式：

```
SELECT (InvoiceTotal - PaymentTotal - CreditTotal) AS BalanceDue
FROM Invoices
WHERE  (InvoiceTotal - PaymentTotal - CreditTotal)  > 0; 
```

我更喜欢后者。如果表达式非常复杂（或计算成本很高），您可能应该考虑使用计算列（并且可能是持久的），特别是如果很多查询都引用同一个表达式。

PS你的担心似乎没有根据。至少在这个简单的例子中，SQL Server 足够聪明，只执行一次计算，即使您已经引用了两次。继续比较计划；你会发现它们是相同的。如果您有一个更复杂的情况，您看到多次评估表达式，请发布更复杂的查询和计划。

以下是 5 个示例查询，它们都产生完全相同的执行计划：

```
SELECT LEN(name) + column_id AS x
FROM sys.all_columns
WHERE LEN(name) + column_id > 30;

SELECT x FROM (
SELECT LEN(name) + column_id AS x
FROM sys.all_columns
) AS x
WHERE x > 30;

SELECT LEN(name) + column_id AS x
FROM sys.all_columns
WHERE column_id + LEN(name) > 30;

SELECT name, column_id, x FROM (
SELECT name, column_id, LEN(name) + column_id AS x
FROM sys.all_columns
) AS x
WHERE x > 30;

SELECT name, column_id, x FROM (
SELECT name, column_id, LEN(name) + column_id AS x
FROM sys.all_columns
) AS x
WHERE LEN(name) + column_id > 30; 
```

所有五个查询的结果计划：

![在此处输入图像描述](../Images/fab8fc9958f87470c297081bcf68273d.png)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-03-29T07:04:37.697

您可以使用`cross apply`

```
SELECT c.BalanceDue AS BalanceDue
FROM Invoices
cross apply (select (InvoiceTotal - PaymentTotal - CreditTotal) as BalanceDue) as c
WHERE  c.BalanceDue  > 0; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-04-17T13:15:32.517

实际上可以有效地定义一个可以在 SELECT、WHERE 和其他子句中使用的变量。

交叉连接不一定允许对引用的表列进行适当的绑定，但是 OUTER APPLY 可以 - 并且更透明地处理空值。

```
SELECT
    vars.BalanceDue
FROM
    Entity e
OUTER APPLY (
    SELECT
        -- variables   
        BalanceDue = e.EntityTypeId,
        Variable2 = ...some..long..complex..expression..etc...
    ) vars
WHERE
    vars.BalanceDue > 0 
```

向[Syed Mehroz Alam 致敬](https://smehrozalam.wordpress.com/2010/01/25/referring-computedcalculated-columns-in-the-where-and-group-by-clause/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-13T00:34:32.823

作为在 WHERE 子句之前强制评估 SELECT 子句的一种解决方法，您可以将前者放在子查询中，而后者保留在主查询中：

```
SELECT * FROM (
  SELECT (InvoiceTotal - PaymentTotal - CreditTotal) AS BalanceDue
  FROM Invoices) AS temp
WHERE BalanceDue > 0 
```

# php - 检查已经过去了多少天

> ID：11182341
> 
> 赞同：2
> 
> 时间：2012-06-25T00:42:05.200
> 
> 标签：php, javascript

我怎样才能正确地写这个？我想检查从 publish_start 日到 publish_end 日已经过去了多少天，当它们超过 30 天时，将显示一条消息。

```
var a = new Date("<?php echo $this->item->publish_start; ?>");
var b = a.getDate();

var c = new Date("<?php echo $this->item->publish_end; ?>");
var d = c.getDate();

var e =  d - b ;

    if( e > 30) {
        alert("<?php echo JText::_('You cant put more than 30 days'); ?>");
                return false;
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T00:48:06.540

**编辑：澄清后更新**

您最好在 PHP 中找到日期之间的差异，然后将该值传递给 JavaScript。

我不知道这两个变量的日期格式是什么，但如果它们是 unix 时间戳，你可以这样做：

```
var e = <?php echo floor(strtotime($this->item->publish_end)-strtotime($this->item->publish_start))/86400); ?>
if( e > 30) {
    alert("<?php echo JText::_('You cant put more than 30 days'); ?>");
            return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T00:47:47.070

使用 getTime() 函数获取毫秒差：

```
if(d.getTime() - b.getTime() > 2592000000) 
```

（30 天有 2 592 000 000 毫秒）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T00:49:37.383

转换 a 和 c 并将它们转换为纪元时间戳（自 1970 年 1 月 1 日以来的秒数，unix 时间戳）。取两者之差。将结果除以（一分钟 60 秒 * 一小时 60 分钟 * 一天 24 小时），那么你就有了天数的差异。

# android - Android Mapview：控制多种类型的OverlayItems的排序？

> ID：11182343
> 
> 赞同：1
> 
> 时间：2012-06-25T00:42:08.487
> 
> 标签：android, android-mapview, itemizedoverlay

我已经在这个问题上搜索了一段时间，但已经找到了王牌。

我有一个简单的地图视图，它使用 ManagedOverlay 上的自定义叠加项目[，](http://code.google.com/p/mapview-overlay-manager/)让我们称它们为`redOverlayItem`and `blueOverlayItem`。ManagedOverlay 所做的只是在我的数据库中查询一组不同类型的位置，然后将它们异步放置在地图上。

我的托管覆盖工作正常，但我似乎无法控制“z”排序。例如，有时我有`redOverlayItem`' 覆盖`blueOverlayItem`'，反之亦然，我真的只是希望`redOverlayItem`' 位于顶部。

我已经用尽了关于如何解决这个问题的想法。如何控制多种叠加项目的排序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T05:08:06.240

好的，伙计们，我想通了。

在您的叠加层中，您需要覆盖 getIndexToDraw

```
//Overriding to return add order rather than latitude order.
protected int getIndexToDraw(int drawingOrder) {
    return drawingOrder;
} 
```

而不是调用 super.getIndexToDraw(int)，它返回按纬度值排序的项目，我现在所做的只是返回添加它们的顺序。然后我为我的覆盖数组所做的就是对它们进行相应的排序（我使用的是 Rob Carmick 的[BeanComparator](http://tips4java.wordpress.com/2008/10/23/bean-comparator/)，但你真的可以使用任何排序函数）

```
BeanComparator bc = new BeanComparator(CustomOverlayItem.class, "getIsRed");
Collections.sort(overlayItemsArray, bc); 
```

# asp.net - 为什么我现在收到有关缺少连接名称的 web.config 错误？

> ID：11182345
> 
> 赞同：1
> 
> 时间：2012-06-25T00:42:39.000
> 
> 标签：asp.net, asp.net-mvc-3, web-config

我的 ASP.NET MVC3 Razor 项目中的 web.config 出现错误，我一直在开发一个新分支：

```
The connection name 'ApplicationServices' was not found in the 
applications configuration or the connection string is empty. 
```

有了这个特定的错误：

```
Line 34:       <providers>
Line 35:         <clear/>
Line 36:         <add name="AspNetSqlMembershipProvider"
type="System.Web.Security.SqlMembershipProvider" 
connectionStringName="ApplicationServices" 
enablePasswordRetrieval="false" enablePasswordReset="true"
requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6"
 minRequiredNonalphanumericCharacters="0" 
passwordAttemptWindow="10" 
applicationName="/"/>
Line 37:       </providers>
Line 38:     </membership> 
```

在`<connectionStrings>`web.config 部分中，没有`ApplicationServices`. 但是，我已经将我的 web.config 与以前工作的版本进行了比较，并且 webconfig 的这一部分根本没有改变。我的后备箱里也有这条线。

我查看了该`<connectionStrings>`部分，该分支和工作主干之间没有任何变化。所以这意味着连接名称没有被删除来触发这个错误。

我想知道我在项目中是否还有其他更改，现在该行出现错误。但我不知道它可能是什么。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T00:49:54.363

该部分可能没有更改，**但**该`<connectionStrings>`部分可能已更改 - 那里曾经有一个“ApplicationServices”连接字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:08:35.530

您的网站是否在嵌套在另一个网站中时运行？如果 web.config 确实没有改变，那么它之前可能还在工作，因为它从父站点继承了连接字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T01:17:09.940

我不确定您的上一个版本和当前版本之间发生了什么变化。但是，如果您不使用表单身份验证，则不需要此“会员资格”部分；删除它应该是安全的。这应该可以解决您看到的错误。（其位置是否会出现其他错误还有待观察……）

# wordpress - 我如何使用 bbp_get_reply_author_role()？（WordPress/bbpress）

> ID：11182352
> 
> 赞同：0
> 
> 时间：2012-06-25T00:44:20.563
> 
> 标签：wordpress, bbpress

无法弄清楚如何使用 bbp_get_reply_author_role()，我真的需要它，在尝试回显它时返回错误，而且我找不到像这样的 bbpress 模板标签的任何文档 =/ 任何帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T15:42:25.323

也许这可以帮助你@Dactyllo [http://bbpress.svn.wordpress.org/branches/plugin/bbp-includes/bbp-reply-template.php](http://bbpress.svn.wordpress.org/branches/plugin/bbp-includes/bbp-reply-template.php)

# java - 标准表单认证 Java servlet

> ID：11182356
> 
> 赞同：10
> 
> 时间：2012-06-25T00:45:25.823
> 
> 标签：java, security, authentication, servlets, jetty

使用 Java Servlet 进行表单身份验证的标准方法是什么？

从现在开始，我自己使用一个简单的 POST HTML 表单实现了这一点：

1.  根据数据库检查发送的参数
2.  如果存在，将用户对象保存到 HttpSession
3.  检查每个 Servlet 是否存在此对象
4.  如果不是：重定向到带有错误消息的登录页面

但是现在我偶然发现了[如何使用嵌入式码头配置安全](http://docs.codehaus.org/display/JETTY/How+to+Configure+Security+with+Embedded+Jetty)性，现在我在想我可以重用已经实现的解决方案来解决这个问题，但是这里的标准方法是什么？我自己在使用 Jetty，但是 Tomcat 或其他 Web 服务器呢？

我还阅读了有关**j_security_check**的内容，这是怎么回事？那是一种传统方法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-25T05:13:08.023

您应该使用 Tomcat、Websphere、Glassfish 等 Servlet 容器提供的 JAAS 安全性。

默认情况下，这些容器支持以下身份验证类型：

*   基本的
*   消化
*   形式
*   客户证书

**HTTP 基本身份验证**

指定 HTTP 基本身份验证要求服务器从 Web 客户端请求用户名和密码，并通过将用户名和密码与指定或默认领域中的授权用户数据库进行比较来验证用户名和密码是否有效。

当您未指定身份验证机制时，基本身份验证是默认设置。

使用基本身份验证时，会发生以下操作：

1.  客户端请求访问受保护的资源。
2.  Web 服务器返回一个对话框，要求输入用户名和密码。
3.  客户端将用户名和密码提交给服务器。4.\服务器在指定领域对用户进行身份验证，如果成功，则返回请求的资源。

下图显示了当您指定 HTTP 基本身份验证时会发生什么。 ![在此处输入图像描述](../Images/0109d1929bddd297c0428d20edc460c3.png)

HTTP基本认证客户端与服务器之间HTTP基本认证的四个步骤图

**基于表单的身份验证**

基于表单的身份验证允许开发人员通过自定义 HTTP 浏览器呈现给最终用户的登录屏幕和错误页面来控制登录身份验证屏幕的外观。声明基于表单的身份验证时，会发生以下操作。

1.  客户端请求访问受保护的资源。
2.  如果客户端未经身份验证，则服务器将客户端重定向到登录页面。
3.  客户端将登录表单提交给服务器。
4.  服务器尝试对用户进行身份验证。
5.  如果身份验证成功，则检查经过身份验证的用户的主体，以确保其处于有权访问资源的角色中。如果用户被授权，则服务器使用存储的 URL 路径将客户端重定向到资源。
6.  如果身份验证失败，客户端将被转发或重定向到错误页面。

下图显示了当您指定基于表单的身份验证时会发生什么。

![在此处输入图像描述](../Images/2c7c723e62db349ab33d49c53c475d8a.png)

创建基于表单的登录时，请务必使用 cookie 或 SSL 会话信息来维护会话。

为了正确进行身份验证，登录表单的操作必须始终为 j_security_check。进行此限制是为了使登录表单无论用于哪个资源都可以工作，并避免要求服务器指定出站表单的操作字段。以下代码片段显示了应如何将表单编码到 HTML 页面中：

```
<form method="POST" action="j_security_check">
  <input type="text" name="j_username">
  <input type="password" name="j_password">
</form> 
```

**摘要式身份验证**

与基本身份验证一样，摘要身份验证基于用户名和密码对用户进行身份验证。但是，与基本身份验证不同，摘要身份验证不会通过网络发送用户密码。相反，客户端发送密码和附加数据的单向加密哈希。尽管密码不会在线发送，但摘要式身份验证要求身份验证容器可以使用明文密码等效项，以便它可以通过计算预期的摘要来验证接收到的身份验证器。

**参考：**

*   [如何保护我的 Web 应用程序](https://stackoverflow.com/questions/9678959/how-to-secure-my-java-web-application/9679055#9679055)
*   [保护 Web 应用程序](http://docs.oracle.com/javaee/6/tutorial/doc/gkbaa.html)
*   [保护 Java EE 5 Web 应用程序](http://java-x.blogspot.in/2007/01/securing-java-ee-5-web-applications.html)
*   [在部署描述符中声明安全要求](http://docs.oracle.com/javaee/5/tutorial/doc/bncbe.html#bncbj)
*   [客户端证书认证](http://docs.oracle.com/javaee/6/tutorial/doc/gjjwx.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T05:41:35.977

尝试使用servlet过滤器，无需配置JAAS等人员

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-25T05:15:32.020

仅当数据库中不存在有关用户的数据时，才尝试转发到错误页面。如果您发现您的用户使用以下代码将他重定向到他的“主页”页面

```
RequestDispatcher dis = request.getRequestDispatcher("relativeURL2Jsp");
dis.forward(request, response); 
```

# asp.net-mvc-3 - WYSIWYG 链接和 MVC 路由协同工作

> ID：11182359
> 
> 赞同：1
> 
> 时间：2012-06-25T00:45:36.977
> 
> 标签：asp.net-mvc-3, asp.net-mvc-routing, href, relative-path

我有一个网址[http://domain.com/shopname](http://domain.com/shopname)并且此页面的内容具有从 CMS 创建的链接，其中之一是`p/101/productname`.

一切都很好，但是我希望在页面呈现时 url 将被评估为[http://domain.com/shopname/p/101/productname](http://domain.com/shopname/p/101/productname)，但事实并非如此，浏览器将链接读取为[http://domain。 com/p/101/产品名称](http://domain.com/p/101/productname)。

[如果构建 url 的初始页面是http://domain.com/shopname/](http://domain.com/shopname/)而不是[http://domain.com/shopname](http://domain.com/shopname)，则可以解决此问题。注意尾部的斜杠。这不是我可以依赖的东西，所以我正在寻找解决方案。

它是一个 ASP.NET MVC 应用程序，路由使用以下模板定义：

`"{shopName}/p/{productId}/{SeoName}"`

一个明显的解决方案是在 WYSIWYG 中添加一个路由名称参数，并在视图中使用帮助程序或当视图模型从控制器内的域模型转换时重写 url。然而，这并不理想，如果我缺少一个明显的解决方案，我会很想知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T02:44:20.720

在这个问题上没有活动几天后，我决定在 WYSIWYG 中使用一个标记，并在我的视图模型转换时将其替换为所需的值。

# android - 自定义列表视图和自定义 ArrayAdapter

> ID：11182362
> 
> 赞同：0
> 
> 时间：2012-06-25T00:47:37.847
> 
> 标签：android, listview, android-arrayadapter

我在这里没有收到任何错误，但我无法在屏幕上显示任何内容我有 2 个 XML 文件 main.xml 有一个带有 id @id/android:list 的列表视图，另一个 xml 有一个带有 3 个文本视图的相对布局我是试图显示数据库中的数据，但似乎什么也没有。我尝试了简单的列表布局，然后我能够显示数据库中一列的内容。但是当我为自定义布局尝试这个时，除了空白行之外什么都没有显示。

这是启动应用程序时启动的主要活动。

```
public class Db extends ListActivity {
private SQLiteDatabase newDb;
DataBaseHelper myDbHelper = new DataBaseHelper(this);
public ListAdapter adapter;
private ArrayList<String> results = new ArrayList<String>();

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

setContentView(R.layout.main);
    openDatabase();
    newDb = myDbHelper.getReadableDatabase();   
    Cursor c = newDb.rawQuery("SELECT _id, organisation, address, postcode FROM shoplist", null);
    int i_organisation = c.getColumnIndex("organisation");
    int i_id = c.getColumnIndex("_id");
    int i_address = c.getColumnIndex("address");
    int i_postcode = c.getColumnIndex("postcode");

    //int count = c.getCount();
    //String data[] = new String[count];
    //int i= 0;
    for (c.moveToFirst(); !c.isAfterLast(); c.moveToNext())
    {
        String i1 = c.getString(c.getColumnIndex("_id"));
        String i2 = c.getString(c.getColumnIndex("organisation"));
        String i3 = c.getString(c.getColumnIndex("address"));
        results.add(i1);

        //i++;
    }
    customAdapter adapter = new customAdapter(getApplicationContext(),
            R.layout.main, results, results, results);
    setListAdapter(adapter);

}

private long inserttodata() {
    // TODO Auto-generated method stub
    ContentValues cv = new ContentValues();
    cv.put("id", "112");
    cv.put("organisation","test" );
     return newDb.insert("shoplist", null, cv);
}

private void openDatabase() {

    try {

        myDbHelper.createDataBase();

    } catch (IOException ioe) {

        throw new Error("Unable to create database");

    }

    try {

        myDbHelper.openDataBase();

    } catch (SQLException sqle) {
System.out.println("failed to open");
        throw sqle;

    }
    //String[] columns= new String[]{"_id", "Organisation"};
    //cursor = newDb.query("Shop", columns, null, null, null, null, null);

}

} 
```

我的数据库助手类

```
public class DataBaseHelper extends SQLiteOpenHelper{

//The Android's default system path of your application database.
private static String DB_PATH = "/data/data/calc.three/databases/";

private static String DB_NAME = "charity.db";

private SQLiteDatabase myDataBase; 

private final Context myContext;

public DataBaseHelper(Context context) {

    super(context, DB_NAME, null, 1);
    this.myContext = context;
}   

public void createDataBase() throws IOException{

    boolean dbExist = checkDataBase();

    if(dbExist){
        //do nothing - database already exist
    }else{

        //By calling this method and empty database will be created into the default system path
           //of your application so we are gonna be able to overwrite that database with our database.
        this.getReadableDatabase();

        try {

            copyDataBase();

        } catch (IOException e) {

            throw new Error("Error copying database");

        }
    }

}

/**
 * Check if the database already exist to avoid re-copying the file each time you open the application.
 * @return true if it exists, false if it doesn't
 */
private boolean checkDataBase(){

    SQLiteDatabase checkDB = null;

    try{
        String myPath = DB_PATH + DB_NAME;
        checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

    }catch(SQLiteException e){

        //database does't exist yet.

    }

    if(checkDB != null){

        checkDB.close();

    }

    return checkDB != null ? true : false;
}

/**
 * Copies your database from your local assets-folder to the just created empty database in the
 * system folder, from where it can be accessed and handled.
 * This is done by transfering bytestream.
 * */
private void copyDataBase() throws IOException{

    //Open your local db as the input stream
    InputStream myInput = myContext.getAssets().open(DB_NAME);

    // Path to the just created empty db
    String outFileName = DB_PATH + DB_NAME;

    //Open the empty db as the output stream
    OutputStream myOutput = new FileOutputStream(outFileName);

    //transfer bytes from the inputfile to the outputfile
    byte[] buffer = new byte[2048];
    int length;
    while ((length = myInput.read(buffer))>0){
        myOutput.write(buffer, 0, length);
    }

    //Close the streams
    myOutput.flush();
    myOutput.close();
    myInput.close();

}

public void openDataBase() throws SQLException{

    //Open the database
    String myPath = DB_PATH + DB_NAME;
    SQLiteDatabase.CursorFactory c = null;
    myDataBase = SQLiteDatabase.openDatabase(myPath, c , SQLiteDatabase.OPEN_READWRITE);

}

@Override
public synchronized void close() {

        if(myDataBase != null)
            myDataBase.close();

        super.close();

}

@Override
public void onCreate(SQLiteDatabase db) {

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

}} 
```

我的自定义适配器类

```
 public class customAdapter extends ArrayAdapter<String> {
static List<String> serialNo = new ArrayList<String>();
static List<String> name = new ArrayList<String>();  
static List<String> address = new ArrayList<String>();

Context myContext;

public customAdapter(Context context, int resource, List<String> c_serialNo,
    List<String> c_name, List<String> c_address) {

super(context, resource, c_serialNo);

myContext = context;
serialNo = c_serialNo;
name = c_name;
address = c_address;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
View v = convertView;
if (v == null) {
    LayoutInflater vi = (LayoutInflater) myContext
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    v = vi.inflate(R.layout.main, null);
}

TextView tv_serialNo = (TextView) v.findViewById(R.id.serialNo);
TextView tv_name = (TextView) v.findViewById(R.id.name);
TextView tv_address = (TextView) v.findViewById(R.id.address);

if (tv_serialNo != null) {
    tv_serialNo.setText(serialNo.get(position));
}
if (tv_name != null) {
    tv_name.setText(name.get(position));
}
if (tv_address!= null) {
    tv_address.setText(address.get(position));
}

return v; }} 
```

main.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

   <ListView android:layout_width="wrap_content" android:layout_height="wrap_content" android:id="@id/android:list"></ListView>

</LinearLayout> 
```

custom_list.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

        <RelativeLayout android:layout_width="fill_parent" android:layout_height="80dp" >
            <TextView android:id="@+id/serialNo"
                android:layout_height="38dp"
                android:layout_width="40dp"
                android:padding="1dip"
                android:gravity="top"                    
                android:text="sn"
                                    />
            <TextView android:id="@+id/name"
                android:layout_height="38dp"
                android:layout_width="240dp"
                android:padding="1dip"
                android:gravity="top"                    
                android:text="name"
                android:layout_toRightOf="@id/serialNo"
                                    />

            <ImageButton
                android:id="@+id/fav"
                android:layout_width="38dp"
                android:layout_height="38dp"
                android:layout_alignParentTop="true"
                android:layout_toRightOf="@+id/name"
                android:src="@drawable/ic_launcher" />
            <TextView android:id="@+id/address"
                android:layout_height="40dp"
                android:layout_width="300dp"
                android:padding="1dip"

                android:text="name"
                android:layout_below="@id/serialNo"
                                    />

            <ImageView
                android:id="@+id/source"
                android:layout_width="40dp"
                android:layout_height="40dp"
                android:layout_alignBottom="@+id/address"
                android:layout_toRightOf="@+id/address"
                android:src="@drawable/pg" />

        </RelativeLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:14:36.897

我看到的几件事...... `R.layout main`是您的主要布局，您正在尝试将其设置为适配器的行布局。两者应该不同。

其次，除非您有一些不明显的原因，否则您正在做很多额外的工作来创建数组......

第三，您似乎正在尝试列出未从光标或您显示的任何其他数组中提取的内容（序列号）。

像这样使用 SimpleCursorAdapter 会简单得多：

```
openDatabase();  
newDb = myDbHelper.getReadableDatabase();    
Cursor c = newDb.rawQuery("SELECT _id, organisation, address, postcode FROM shoplist", null);  

// let the system manage your cursor
getActivity().startManagingCursor(c);      

//  tell the adapter what columns to pull data from
String[] from = new String[] { "_id", "organisation", "address" };      

// tell the adapter what resource ids in your row layout to map the data to     
int[] to = new int[] { R.id.serialNo, R.id.name, R.id.address };      

// create the adapter, specifying the context, the xml file to use for the row layout, the cursor to pull the data from, and the map of where to put the data in the form of from and to arrays 
SimpleCursorAdapter mAdapter = new SimpleCursorAdapter(this, R.layout.your_row_xml, c, from, to);

// set the adapter to your list
setListAdapter(mAdapter); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T00:10:30.457

已解决：我膨胀了错误的 XMl 文件。膨胀 custom_list.xml 并开始显示。

# php - PHP电子邮件表单给出标题错误

> ID：11182365
> 
> 赞同：-3
> 
> 时间：2012-06-25T00:47:55.803
> 
> 标签：php, email, webforms

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我从另一个开发人员那里继承了这个网站 taxquest.com，并且 Web 表单给了我一个关于我不熟悉的标头的错误：警告：无法修改标头信息 - 标头已经发送（输出开始于 /home/taxquest/public_html /includes/header.php:27) 在第 11 行的 /home/taxquest/public_html/mailer2.php

表单正确发送电子邮件，但随后进入重定向循环。

在这里的任何帮助将不胜感激。

真诚的，罗杰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T00:54:13.687

在输出任何内容之前，您需要有 header() 语句，这包括空格。某些文档（例如以 ANSI 保存的文档）有时会在文档的开头放置空格。如果我将在这篇文章中添加的代码对您没有帮助，请尝试使用不同的编码（如 UTF-8）打开它。

错误的：

```
<html>
    <head>
    <title><?="Example"; ?></title>
    </head>
    <?php
    header("location: ../");
    ?> 
```

正确的：

```
<?php
header("location: ../");
?>
    <html>
    <head>
    <title>Example</title>
    </head> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T00:52:11.563

有时 php 文件末尾不需要的/额外的空格/新行会导致此错误。如果它们存在，请尝试删除它们。特别是在第 27 行的 header.php 中。

如果它们不存在，您可能正在尝试在页面已经发送到浏览器的情况下修改/设置新的标头参数。如果您可以发布一些代码，这个答案可以更具体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T01:11:10.063

你的 header() 函数应该在 HTML 标签之前。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T00:53:08.330

警告：无法修改标头信息 - 标头已由第 11 行 /home/taxquest/public_html/mailer2.php 中的（输出开始于 /home/taxquest/public_html/includes/header.php:27）发送

这是因为您在两个文件中都有标题。（session_start 之类的）您可以尝试在 mailer2.php 之后包含 header.php 并在不必要时从 header 中删除这些行。

并且：**在您的 headers 之前应该没有输出**。（对不起我的英语不好。）

# ios - 构建静态库的最佳方法

> ID：11182368
> 
> 赞同：2
> 
> 时间：2012-06-25T00:48:26.327
> 
> 标签：ios, xcode

我即将开始为 iOS 应用程序编写一个静态库，但遇到了几个问题

1.  可以在库中使用纯 C++ 并公开具有接受 std::vector 等方法的公共类吗？
    1.  我来自一个强类型的编程世界，比如 C++ 和 C#，而且我更容易将 C++ 用于这个库。
    2.  一般来说，纯 iOS 开发人员可以使用 C++ 代码并将他们的 .m 文件更改为 .mm 吗？
2.  在 xCode 中，我可以将静态库和演示项目都加载到同一个应用程序中，这样调试起来会更容易吗？
3.  如何为静态库项目进行构建后步骤，以便将 .a 文件复制到所需位置？
4.  如何调试静态库？
5.  一般来说，静态库是 iOS 项目的常见东西，还是每个人都喜欢将源代码嵌入到他们的应用程序中？

非常欢迎任何有关此的文章或书籍。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:13:54.493

这是很多问题，但我有部分答案。

1) 对此不确定，因为我通常不使用 Objective-C++，但第二部分是的，您可以使用 C++（LLVM v3 的 1998 年标准）并将扩展名更改为 .mm 会自动让编译器知道您想使用 Objective-C++ 编译它。

2) 最好的方法是创建一个项目参考。从静态库中创建一个项目，然后将该项目作为另一个项目的子项目拖动。

3) 参见第 2 步，然后在 Build Phases 的 Link With Library 部分添加 .a 文件。

4）由于源代码将显示在您的项目中，我假设您可以简单地放置断点，但我不确定。

5) 是的，制作图书馆很常见。事实上，如果您需要在多个项目中使用相同的代码，那将是愚蠢的。

我敦促您进行跨项目参考，否则我相信您会忘记您需要为每种构建类型（调试/发布和模拟器/设备）编译静态库。跨项目引用将为您解决这个问题。

# asp.net - Win2008R2 ASP.NET 3.5 自定义错误...似乎无法使其正常工作

> ID：11182369
> 
> 赞同：0
> 
> 时间：2012-06-25T00:48:32.640
> 
> 标签：asp.net, windows-server-2008-r2, custom-errors

帮助！

我有一个处理 Application.Error 事件的自定义 HttpModule。该模块正在工作......它将消息记录到事件日志中，我可以看到这些消息......一直到模块的末尾（在它写入自定义响应并调用 response.flush() 之后）。粗略地说，此模块的目的是记录错误并向用户显示礼貌的错误消息（可配置为消息可能/可能不包含有关错误的有用详细信息）。

在应用程序的 web.config 中，我配置了 <httpErrors errorMode="Detailed"> 和 <customErrors mode="Off" />。在 applicationHost.config 我配置了 <section name="httpErrors" overrideModeDefault="Allow" />。同样在 applicationHost.config 中，我在 <location path="default web site/myvdir"> 元素下配置了 <httpErrors errorMode="Detailed"> 。

“黄屏死机”仍然显示（对于本地请求和远程请求）。

这似乎是一个 Win2008R2 问题......这一切都适用于 win2008（我刚刚加载了我的测试环境并尝试了这个）。我怀疑它与 x64 与 x86 相关……但 Win2008R2 仅适用于 x64……而我的 Win2008 测试环境是 x86。

我对此做了更多的探讨。在 Win2008 中，<httpErrors errorMode="Detailed"> 没有任何意义。不显示自定义错误消息。使用它显示自定义错误消息。在 Win2008R2 上，无论 httpErrors/ErrorMode=Detailed 如何，我都会看到相同的问题（黄屏）。

所以......也许我真正的问题是为什么 <customErrors mode="Off" /> 设置在 IIS7.5 上不起作用。如果我将它设置为“开”，我得到短 ysod，设置“关”我得到长 ysod（而不是来自 http 处理程序的自定义消息，就像 IIS7 和 IIS6 中发生的那样），设置为“RemoteOnly”我得到短的 ysod。

半解决：应用程序池设置为托管管道模式：集成。将此切换到经典模式允许显示自定义错误详细信息。这不能解释为什么 IIS7 (win2008 x86) 与集成管道和 IIS7.5 (win2008r2 x64) 需要经典管道一起使用。有什么想法吗？

非常感谢帮助！！！

编辑：修复 xml 标签并添加更多信息和 SEMI-SOLVED

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T03:57:56.253

`<customErrors>`仅适用于 asp.net 文件扩展名，`<httpErrors>`也适用于其他所有配置：[http ://www.iis.net/ConfigReference/system.webServer/httpErrors](http://www.iis.net/ConfigReference/system.webServer/httpErrors)

# c# - 使用 ObserveOn 时如何处理 OnNext 中的异常？

> ID：11182371
> 
> 赞同：12
> 
> 时间：2012-06-25T00:48:47.333
> 
> 标签：c#, system.reactive

当`OnNext`我使用`ObserveOn(Scheduler.ThreadPool)`. 我发现处理这个问题的唯一方法是使用下面的自定义扩展方法（除了确保 OnNext 永远不会引发异常）。然后确保每个`ObserveOn`后跟一个`ExceptionToError`.

```
 public static IObservable<T> ExceptionToError<T>(this IObservable<T> source) {
        var sub = new Subject<T>();
        source.Subscribe(i => {
            try {
                sub.OnNext(i);
            } catch (Exception err) {
                sub.OnError(err);
            }
        }
            , e => sub.OnError(e), () => sub.OnCompleted());
        return sub;
    } 
```

但是，这感觉不对。有没有更好的方法来处理这个问题？

**例子**

该程序由于未捕获的异常而崩溃。

```
class Program {
    static void Main(string[] args) {
        try {
            var xs = new Subject<int>();

            xs.ObserveOn(Scheduler.ThreadPool).Subscribe(x => {
                Console.WriteLine(x);
                if (x % 5 == 0) {
                    throw new System.Exception("Bang!");
                }
            }, ex => Console.WriteLine("Caught:" + ex.Message)); // <- not reached

            xs.OnNext(1);
            xs.OnNext(2);
            xs.OnNext(3);
            xs.OnNext(4);
            xs.OnNext(5);
        } catch (Exception e) {
            Console.WriteLine("Caught : " + e.Message); // <- also not reached
        } finally {

            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-25T09:16:45.150

我们在 Rx v2.0 中解决了这个问题，从 RC 版本开始。您可以在我们的博客[http://blogs.msdn.com/rxteam](http://blogs.msdn.com/rxteam)上阅读所有相关信息。它基本上归结为管道本身中更严格的错误处理，结合了 SubscribeSafe 扩展方法（将订阅期间的错误重定向到 OnError 通道）和 IScheduler 上的 Catch 扩展方法（将调度程序与异常处理逻辑包装在调度行动）。

关于这里提出的 ExceptionToError 方法，它有一个缺陷。回调运行时，IDisposable 订阅对象仍然可以为空；有一个基本的竞争条件。要解决此问题，您必须使用 SingleAssignmentDisposable。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-25T03:07:33.753

订阅错误和可观察错误之间存在差异。快速测试：

```
var xs = new Subject<int>();

xs.Subscribe(x => { Console.WriteLine(x); if (x % 3 == 0) throw new System.Exception("Error in subscription"); }, 
             ex => Console.WriteLine("Error in source: " + ex.Message)); 
```

运行这个，你会在源代码中得到一个很好的处理错误：

```
xs.OnNext(1);
xs.OnNext(2);
xs.OnError(new Exception("from source")); 
```

运行此命令，您将在订阅中收到未处理的错误：

```
xs.OnNext(1);
xs.OnNext(2);
xs.OnNext(3); 
```

**您的解决方案所做的是在订阅中出错并在源中使它们出错**。而且您已经在原始流上完成了此操作，而不是基于每个订阅。您可能打算也可能不打算这样做，但这几乎肯定是错误的。

做到这一点的“正确”方法是将您需要的错误处理直接添加到它所属的订阅操作中。如果不想直接修改订阅功能，可以使用一个小帮手：

```
public static Action<T> ActionAndCatch<T>(Action<T> action, Action<Exception> catchAction)
{
    return item =>
    {
        try { action(item); }
        catch (System.Exception e) { catchAction(e); }
    };
} 
```

现在使用它，再次显示不同错误之间的区别：

```
xs.Subscribe(ActionAndCatch<int>(x => { Console.WriteLine(x); if (x % 3 == 0) throw new System.Exception("Error in subscription"); },
                                 ex => Console.WriteLine("Caught error in subscription: " + ex.Message)),
             ex => Console.WriteLine("Error in source: " + ex.Message)); 
```

现在我们可以（分别）处理源中的错误和订阅中的错误。当然，这些动作中的任何一个都可以在一个方法中定义，使上面的代码很简单（可能）：

```
xs.Subscribe(ActionAndCatch(Handler, ExceptionHandler), SourceExceptionHandler); 
```

**编辑**

在评论中，我们开始讨论订阅中的错误指向流本身的错误，并且您不希望该流上的其他订阅者。这是一个*完全不同类型的问题*。我倾向于编写一个可观察的`Validate`扩展来处理这种情况：

```
public static IObservable<T> Validate<T>(this IObservable<T> source, Predicate<T> valid)
{
    return Observable.Create<T>(o => {
        return source.Subscribe(
            x => {
                if (valid(x)) o.OnNext(x);
                else       o.OnError(new Exception("Could not validate: " + x));
            }, e => o.OnError(e), () => o.OnCompleted()
        );
    });
} 
```

然后简单易用，无需混合隐喻（仅在源代码中出现错误）：

```
xs
.Validate(x => x != 3)
.Subscribe(x => Console.WriteLine(x),
             ex => Console.WriteLine("Error in source: " + ex.Message)); 
```

如果您仍然想要抑制异常，`Subscribe`您应该使用其他讨论的方法之一。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-25T04:31:05.863

您当前的解决方案并不理想。正如[这里](http://social.msdn.microsoft.com/Forums/en-US/rx/thread/ee5dba5d-eea9-4d85-8f58-c2e1c71ef33a)的一位 Rx 人所说：

> Rx 运算符不会捕获在调用 OnNext、OnError 或 OnCompleted 时发生的异常。这是因为我们期望 (1) 观察者实现者最清楚如何处理这些异常，我们不能对它们做任何合理的事情； (2) 如果发生异常，那么我们希望它冒泡而不被 Rx 处理.

您当前的解决方案让 IObservable 来处理 IObserver 抛出的错误，这没有意义，因为语义上 IObservable 应该不知道观察它的事物。考虑以下示例：

```
var errorFreeSource = new Subject<int>();
var sourceWithExceptionToError = errorFreeSource.ExceptionToError();
var observerThatThrows = Observer.Create<int>(x =>
  {
      if (x % 5 == 0)
          throw new Exception();
  },
  ex => Console.WriteLine("There's an argument that this should be called"),
  () => Console.WriteLine("OnCompleted"));
var observerThatWorks = Observer.Create<int>(
    x => Console.WriteLine("All good"),
    ex => Console.WriteLine("But definitely not this"),
    () => Console.WriteLine("OnCompleted"));
sourceWithExceptionToError.Subscribe(observerThatThrows);
sourceWithExceptionToError.Subscribe(observerThatWorks);
errorFreeSource.OnNext(1);
errorFreeSource.OnNext(2);
errorFreeSource.OnNext(3);
errorFreeSource.OnNext(4);
errorFreeSource.OnNext(5);
Console.ReadLine(); 
```

此处源或observerThatWorks没有问题，但由于与另一个Observer无关的错误，将调用其OnError。要阻止不同线程中的异常结束进程，您必须在该线程中捕获它们，因此在您的观察者中放置一个 try/catch 块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-30T07:52:41.157

我查看了[`SubscribeSafe`](https://github.com/dotnet/reactive/blob/0e14e288bcfbe97f47ddf915d57f1acd20a61a5b/Rx.NET/Source/src/System.Reactive/Observable.Extensions.cs#L365)应该解决此问题的本机方法，但我无法使其工作。此方法有一个接受 的重载`IObserver<T>`：

```
// Subscribes to the specified source, re-routing synchronous exceptions during
// invocation of the IObservable<T>.Subscribe(IObserver<T>) method to the
// observer's IObserver<T>.OnError(Exception) channel. This method is typically
// used when writing query operators.
public static IDisposable SubscribeSafe<T>(this IObservable<T> source,
    IObserver<T> observer); 
```

我尝试传递由工厂方法创建的观察者[`Observer.Create`](https://docs.microsoft.com/en-us/previous-versions/dotnet/reactive-extensions/hh211985(v=vs.103))，但`onNext`处理程序中的异常继续使进程崩溃¹，就像它们对正常的`Subscribe`. 所以我最终编写了自己的`SubscribeSafe`. `onNext`这个接受三个处理程序作为参数，并将由和`onCompleted`处理程序抛出的任何异常集中到`onError`处理程序。

```
/// <summary>Subscribes an element handler, an error handler, and a completion
/// handler to an observable sequence. Any exceptions thrown by the element or
/// the completion handler are propagated through the error handler.</summary>
public static IDisposable SubscribeSafe<T>(this IObservable<T> source,
    Action<T> onNext, Action<Exception> onError, Action onCompleted)
{
    // Arguments validation omitted
    var disposable = new SingleAssignmentDisposable();
    disposable.Disposable = source.Subscribe(
        value =>
        {
            try { onNext(value); } catch (Exception ex) { onError(ex); disposable.Dispose(); }
        }, onError, () =>
        {
            try { onCompleted(); } catch (Exception ex) { onError(ex); }
        }
    );
    return disposable;
} 
```

请注意，处理程序中未处理的异常`onError`仍会使进程崩溃！

¹[只有在`ThreadPool`.]

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-25T01:11:45.553

你是对的 - 它应该感觉不好。像这样使用和返回主题不是一个好方法。

至少你应该像这样实现这个方法：

```
public static IObservable<T> ExceptionToError<T>(this IObservable<T> source)
{
    return Observable.Create<T>(o =>
    {
        var subscription = (IDisposable)null;
        subscription = source.Subscribe(x =>
        {
            try
            {
                o.OnNext(x);
            }
            catch (Exception ex)
            {
                o.OnError(ex);
                subscription.Dispose();
            }
        }, e => o.OnError(e), () => o.OnCompleted());
        return subscription;
    });
} 
```

请注意，没有使用任何主题，并且如果我发现错误，然后我会处理订阅以防止序列继续超过错误。

但是，为什么不在`OnError`订阅中添加一个处理程序。有点像这样：

```
var xs = new Subject<int>();

xs.ObserveOn(Scheduler.ThreadPool).Subscribe(x =>
{
    Console.WriteLine(x);
    if (x % 5 == 0)
    {
        throw new System.Exception("Bang!");
    }
}, ex => Console.WriteLine(ex.Message));

xs.OnNext(1);
xs.OnNext(2);
xs.OnNext(3);
xs.OnNext(4);
xs.OnNext(5); 
```

此代码在订阅中正确捕获错误。

另一种方法是使用`Materialize`扩展方法，但这可能有点矫枉过正，除非上述解决方案不起作用。

# shopify - Shopify api - 以编程方式卸载应用程序

> ID：11182372
> 
> 赞同：2
> 
> 时间：2012-06-25T00:49:09.427
> 
> 标签：shopify

我想让商家选择取消他们的帐户与我的应用程序的关联。有没有办法通过 shopify api 发出删除/取消链接请求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-10-27T19:39:27.143

刚刚添加了此功能：http: [//docs.shopify.com/api/authentication/uninstalling-applications](http://docs.shopify.com/api/authentication/uninstalling-applications)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T03:42:34.560

据我所知，Shopify API 不提供应用程序自行卸载的方法。

Shopify 管理界面已经为商家提供了一种以统一方式卸载应用程序的方式。您可以链接到商家可以删除应用程序的此网址。

`https://#{shop_name}.myshopify.com/admin/applications`

或者要直接链接到您的应用程序，请通过在合作伙伴界面中访问您的应用程序来获取您的应用程序的 ID，其格式为`https://app.shopify.com/services/partners/api_clients/#{application_id}`. 然后您可以使用片段在应用程序页面上将商家自动滚动到您的应用程序：

`https://#{shop_name}.myshopify.com/admin/applications#application-#{application_id}`

# iphone - 从后台线程访问 NSManagedObject

> ID：11182376
> 
> 赞同：1
> 
> 时间：2012-06-25T00:49:38.583
> 
> 标签：iphone, objective-c, ios, cocoa, core-data

所以我知道`NSManagedObjects`这不是线程安全的，从后台线程获取对象的最佳方法是使用`[context objectWithId:id];`，因此传递对象 id 而不是实际对象。

假设我有一个全球性`NSManagedObject`的`AppDelegate`（不是最好的设计模式，但只是举例）`NSManagedObject *myObject;`

`objectId`从后台线程访问该对象是否安全？像这样：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
        objectId = appDelegate.myObject.objectId;
        //is this thread safe?
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T00:55:48.820

这是不安全的，因为不能保证调用`objectID`是`myObject`安全的。您应该在块之外（例如在主线程上）访问 objectID，然后在块中使用它。就像是：

```
NSManagedObjectID *objectID = appDelegate.myObject.objectId;
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
    // use objectID here.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T01:08:39.130

您需要为您使用的每个线程（历史上）有一个单独的上下文。由于 dispatch_async 不能保证在任何给定线程上运行，因此您需要在块内创建上下文。或者，在 iOS 5.0 或更高版本上，NSManagedContext 带有新的并发模式。上下文将创建自己的私有串行队列，供您将块传递给。如果您需要支持 iOS 4.x，那么您可以模仿这种行为。创建一个串行队列，并且只访问该队列的上下文。

您可能不会做任何导致来自两个不同线程的查询或上下文更改的事情，因为它可能会创建竞争条件。

# javascript - 如何将变量加载到 .search

> ID：11182378
> 
> 赞同：1
> 
> 时间：2012-06-25T00:49:51.360
> 
> 标签：javascript, jquery, css, jquery-selectors

我正在拉一个网址，然后将其转换为大写。我想将该变量加载到 .search 函数中以过滤结果。

这是我到目前为止所拥有的，但它无法正常工作：

```
$(function() {
    var search_name = location.search;
    var ucSearch = search_name.toUpperCase();

    if (search_name.search("airports")  > 0) {
        $("div.more a:contains("+ ucSearch +")").addClass("active");
    }

}); 
```

我认为这可能只是一个语法问题。

我想最终我会想要这样的东西：

```
$(function() {
   var search_name = location.search;
   var ucSearch = search_name.toUpperCase();

   if (search_name.search("+ ucSearch +")  > 0) {
       $("div.more a:contains("+ ucSearch +")").addClass("active");
   }
}); 
```

这样，它将 url 中的变量与锚 html 中的变量匹配。

更新：

这是我的html

```
<div class="more">
<ul>
  <a class="static" href="#">ALL</a>
  <li><a class="static" href="#">AIRPORTS</a></li>
</ul>
</div> 
```

所以我希望 jquery 抓取 url 并将该 url 文本与锚标记中的 html 文本匹配。在这种情况下，“机场”。我想让它更流畅的原因是，锚标签是什么，“机场”和“车库”。然后它可以将传递给 url 的内容与相应的锚标记匹配，并添加“活动”类。

这是[小提琴](http://jsfiddle.net/DCyJq/)

网址是 site/?type=AIRPORTS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:02:43.430

前提是[`window.location.search`](https://developer.mozilla.org/en/DOM/window.location)将为您提供 GET 查询字符串（在您的示例中，这将包含`?type=AIRPORTS`），我们需要从过滤它开始以仅获取搜索词。一种**非常**原始的方法是只使用[`substr`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/substr). 例如

```
var term = window.location.search.substr('?type='.length); 
```

现在`term`包含`AIRPORTS`. 为了确保它是大写的，我们可以调用[`ToUpperCase`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/toUpperCase)它。例如

```
var term = window.location           // "http://somesite.com/?type=AIRPORTS"
           .search                   // "?type=AIRPORTS"
           .substr('?type='.length)  // "AIRPORTS"
           .toUpperCase();           // "AIRPORTS" 
```

现在，转到 jQuery 并找到其中包含此搜索词的所有链接，并将它们的类设置为活动：

```
$('div.more a:contains("' + term + '")').addClass('active'); 
```

而且，一起：

```
$(function(){ // document.ready
  var term = window.location.search.substr('?type='.length).toUpperCase();
  $('div.more a:contains("' + term + '")').addClass('active');
}); 
```

# c++ - 为什么一个文件中没有错误而另一个文件中没有错误 - “非静态成员引用必须与特定对象相关”

> ID：11182382
> 
> 赞同：0
> 
> 时间：2012-06-25T00:51:15.823
> 
> 标签：c++, static, singleton

我有一个纹理管理器，我作为单例运行，并希望以同样的方式制作一个对象管理器..

无论如何..我复制了在纹理管理器中 100% 工作的 EAXACT 代码，但在对象管理器中它给了我这个错误“非静态成员引用必须与特定对象相关”

我认为这与`std::map`?

这是我 100% 工作的 textureManager 头文件和 cpp 文件。 [http://ideone.com/6bZQG](http://ideone.com/6bZQG) | [http://ideone.com/jjo2M](http://ideone.com/jjo2M)

这是不工作的 ObjectManager 的开始... [http://ideone.com/rhSim](http://ideone.com/rhSim) | [http://ideone.com/uLj4X](http://ideone.com/uLj4X)

现在，基本上指向的指针`std::map`是我得到错误的地方..（ObjectManager.cpp 的第 23 行）`delete`调用在`destroy()`给我那个错误和其他任何地方（如果我创建一个新函数。但是计时器变量按预期工作.

有什么花哨的方法我应该做一个指向 a 的指针`std::map`吗？据我所知，此代码与纹理管理器的代码 100% 相同？

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:16:16.210

大致重复我在 IRC 上所说的话：

*   您不需要指向的指针`std::map`——它不会为您保存任何副本，并且可能会花费更多的内存和维护工作。
*   如果您不关心各种单例被销毁的顺序，`unique_ptr`请为它们使用 a ：请参阅[header](http://ideone.com/LwuNv)和[implementation](http://ideone.com/0XWaW)。
*   Boost 有一个非常好的不可复制，使用它（例如，您的实现仍然允许分配）。

至于为什么您的版本不起作用：在您的实现文件的第 23 行，您指的是`gameObjects`没有指定您的意思的实例。你可能的意思是`instance->gameObjects`。

# java - AppEngine 网站中的在线用户

> ID：11182383
> 
> 赞同：0
> 
> 时间：2012-06-25T00:51:28.613
> 
> 标签：java, google-app-engine, session, struts2

用户可以使用他们的 Google、Facebook 或 Twitter 帐户登录在 Google App Engine 中运行的网站。用户会话已经实现，三个身份验证提供程序（Google、Facebook、Twitter）已经工作。

我的下一个任务是检查用户在查看其个人资料时是否在线。如何实现这一点？如果您有一些想法，请告诉我。

此外，当用户登录该站点时，我将其电子邮件保存到会话中，如下所示：

```
session.put("email", email); 
```

要考虑的另一件事是用户的会话何时超时。如果用户的会话由于长时间没有在网站上进行交互而自动超时（不使用网站中提供的注销菜单/按钮），我们可以做些什么吗？

使用的框架是 Struts2，在 Google App Engine 中运行。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T03:37:01.377

由于 HTTP 是基于请求的，而不是基于会话的，因此无法知道用户是否“在线”——简单地说，HTTP 没有“在线”用户的概念。

执行此操作的过于复杂和高开销的方法是使用 Channel API 之类的东西在用户离开页面（或您的站点）时通知您，但这对于一个简单的功能来说是很多开销。您还可以让用户的浏览器在打开页面时定期对您进行 ping 操作，但这同样会导致大量开销和额外流量。

一种更常见的方法是将针对用户的记录存储在数据存储中（或者仅存储在内存缓存中，如果用户被错误地标记为离线，这不是非常重要的话），记录他们上次加载页面的时间，并在他们获取时更新来自您网站的页面。然后，如果用户在某个合理的时间间隔（例如半小时）内检索到页面，则显示用户为“在线”，否则显示为“离线”。

# jquery - 一次无限滚动一页

> ID：11182384
> 
> 赞同：1
> 
> 时间：2012-06-25T00:51:50.593
> 
> 标签：jquery, ajax, json, infinite-scroll

我有一个脚本可以在用户滚动到底部时加载新产品。该脚本有效，但我有两个问题。那是a）脚本加载page1两次b）脚本一次加载所有页面而不是一次加载一个

有谁知道解决方案？我的知识有限，因此非常感谢任何帮助。

我的剧本

```
<script type="text/javascript">
$(document).ready(function(){

  // var pageSize = {{ collection.limit }};
  var currentPage = 1;
  var collectionPages = {{ collection.pages }};
  var category = '{{ collection.internal.url }}';

  // Appends the new product to the UI
  var appendProduct = function(product, id) {

  $('<div class="product"></div>')
    .html(product)
    .appendTo($(".productsGrid"));

  var i = 1;
  $('.product').each(function() {
    if(i++ % 3 == 0)
      $(this).addClass('last');
   });
  };

  // Load the next products page
  var loadProducts = function() {

    var url = "http://shop.com/"+category+"/page"+currentPage+".ajax";

    $.getJSON(url,function(data) {

      $.each(data.products, function(index, product) {
        appendProduct('<a href="'+product.url+'" title="'+product.fulltitle+'">' +
                    '<img src="'+product.image+'" width="180" height="150" alt="'+product.fulltitle+'" title="'+product.fulltitle+'"'+'</a>' +
                    '<div class="info"><h3><a href="'+product.url+'" title="'+product.fulltitle+'">'+product.fulltitle+''+'</a></h3>' +
                    '<div class="price">'+product.price.price_money+''+'</div>' +
                    '<div class="gridAddToCart"><a class="button grey" href="'+product.url+'" title="'+product.fulltitle+'" rel="nofollow">'+'<span>{{ 'Details' | t }}</span></a>' +
                    '<div style="margin-top:2px;"></div>' +
                    '<a class="opener button blue" href="http://meules1.webshopapp.com/cart/add/'+product.vid+'" title="'+product.fulltitle+'" rel="nofollow"><span>{{ 'Add to cart' | t }}</span></a>'
                   + '<div class="clear"></div>' +
                    '</div><div class="clear"></div></div>'      
        );
      });

    // We're done loading the products, so hide the overlay and update the UI
    $("#overlay").fadeOut();
    });
  };

  // First time, directly load the products
  loadProducts();

  // Append a scroll event handler to the container
  $(window).scroll(function() {
    // activate new load when scrollbar reaches 150 pixels or less from the bottom
    if($(window).height() + $(window).scrollTop() >= $(document).height() - 350) {

      if(currentPage <= collectionPages) {
        $("#overlay").fadeIn();
        loadProducts();
        currentPage++;
      }

    }
  });

});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:23:20.963

## 问题A

运行该函数*后*，您将增加页码：`loadProducts`

```
if(currentPage <= collectionPages) {
  $("#overlay").fadeIn();
  loadProducts();
  currentPage++
} 
```

你应该试试这个：

```
if(currentPage <= collectionPages) {
  $("#overlay").fadeIn();
  currentPage++; //Moved this ABOVE loadProducts()
  loadProducts();
} 
```

## 问题 B

当用户到达底部时，您执行的代码`window.scroll`可能会触发多次，这意味着所有页面都会立即加载。解决此问题的一种方法可能是仅在您的叠加层不可见时才运行代码：

```
// Append a scroll event handler to the container
$(window).scroll(function() {
  // activate new load when scrollbar reaches 150 pixels or less from the bottom
  if(($(window).height() + $(window).scrollTop() >= $(document).height() - 350) && $("#overlay").is(":hidden")) { 
```

或者，您可以设置一个全局变量，例如`var loading_page = false`. 开始加载页面时将其切换为 true，当新页面完全加载后将其切换回 false，并且仅当`loading_page`变量为 false 时才允许执行滚动代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T09:40:05.240

发生这种情况是因为脚本触发了两次，即您的 ajax 调用必须进行多次。检查 HttpFox，您将能够观察到这一点。当我实现虚拟滚动时，我面临同样的问题。

使用某种标志来监控这一点。检查以下 URL/问题。这包含我避免此问题的虚拟滚动脚本。 [https://stackoverflow.com/questions/19049088/page-clicks-not-working-during-virtual-scroll](https://stackoverflow.com/questions/19049088/page-clicks-not-working-during-virtual-scroll)

# php - 存储通过网络接收的文本块的最快方法

> ID：11182396
> 
> 赞同：0
> 
> 时间：2012-06-25T00:55:29.070
> 
> 标签：php

我有一个 php 脚本，它接收一些带有数据的文本块。将它们存储在服务器上供以后使用的最有效方法是什么？

我正在考虑使用 mysql 数据库，但这不会太耗时吗？

客户端将每 20 秒将文本块发送到 phpscript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:58:31.190

严格来说，最快的存储方式是使用 Memcache。然而，这可能远非最好的方式。

将它存储到一个文件中会很好地工作并且实现起来非常简单。如果您只需要一个存储/检索系统，文件是比数据库更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T00:57:26.450

您不应该为此使用数据库，而是使用文件系统。您也可以考虑使用[AWS S3](http://aws.amazon.com/s3/)。看看[[将文件存储在数据库中而不是文件系统]](https://stackoverflow.com/questions/8952/storing-a-file-in-a-database-as-opposed-to-the-file-system)和[[将文件存储在数据库与文件系统中]](https://stackoverflow.com/questions/6939049/storing-files-in-database-vs-file-system)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T00:58:23.997

鉴于时间延迟为 20 秒，答案完全取决于您要如何检索文本。如果检索很容易，您可以将其存储在平面文件中，或者如果您需要对其执行关系查询，则可以将其存储在 MySQL 数据库中，或者存储在内存数据结构中，例如备份到磁盘的 Zope 对象数据库，或者如果您不需要长时间存储它，只需像 Memcached 这样的内存缓存。

对于这些方式中的任何一种来说，20 秒都是很长的时间，因此请选择一种最容易以您需要的方式检索它的方式。

# c# - 您如何获取两个数据表并匹配值，然后在匹配的行值中的列中添加一些内容？

> ID：11182399
> 
> 赞同：0
> 
> 时间：2012-06-25T00:55:40.450
> 
> 标签：c#, datatable, datarow, datacolumn

我有两个数据表，我需要匹配每个数据表的邮政编码，每次程序找到匹配项时，我都需要将匹配行中的列设置为字符串。这是我的代码。

我不知道在foreach循环中该做什么，或者如果有更简单的方法可以做到这一点，请说出来。

```
 //Datatable for entire list of zipcodes
        DataTable datat = new DataTable("DATA");
        DataColumn state = new DataColumn();
        DataColumn county = new DataColumn();
        DataColumn zipcode = new DataColumn();
        DataColumn latitude = new DataColumn();
        DataColumn longitude = new DataColumn();
        DataColumn salesperson = new DataColumn();
        DataColumn originalrec = new DataColumn();

        //Add the columns to the datatable
        datat.Columns.Add(state);
        datat.Columns.Add(county);
        datat.Columns.Add(zipcode);
        datat.Columns.Add(latitude);
        datat.Columns.Add(longitude);
        datat.Columns.Add(salesperson);
        datat.Columns.Add(originalrec);

        return datat;
    }

    private static DataTable InitData2()
    {
        //Datatable for entire list of zipcodes
        DataTable datat2 = new DataTable("DATA");
        DataColumn ctype = new DataColumn();
        DataColumn csalesperson = new DataColumn();
        DataColumn czipcode = new DataColumn();

        //Add the columns to the datatable
        datat2.Columns.Add(ctype);
        datat2.Columns.Add(csalesperson);
        datat2.Columns.Add(czipcode);

        return datat2;
    }       

    private static String InitPath()
    {
        string path = "C:/Documents and Settings/Andre/Desktop/SalesMap/data.csv";
        return path;
    }

    private static String InitPath2()
    {
        string path2 = "C:/Documents and Settings/Andre/Desktop/SalesMap/CUSTOMER_PROSPECT_SALESPERSON.csv";
        return path2;
    }

    public static void Main()
    {
        try
        {
            DataTable dt = InitData1();
            DataTable dt2 = InitData2();
            StreamReader sr = new StreamReader(InitPath());
            StreamReader sr2 = new StreamReader(InitPath2());
            String csvData = string.Empty;
            String csvData2 = string.Empty;

            while ((csvData = sr.ReadLine()) != null)
            {
                String[] data = csvData.Split(',');
                //dt.Rows.Add(data);
                DataRow newRow1 = dt.NewRow();
                newRow1[0] = data[0].ToString();
                newRow1[1] = data[1].ToString();
                newRow1[2] = data[2].ToString();
                newRow1[3] = data[3].ToString();
                newRow1[4] = data[4].ToString();
                newRow1[5] = "";
                newRow1[6] = "";
                dt.Rows.Add(newRow1);

                Console.WriteLine("Row added for: dt");
            }
            dt.WriteXml(@"c:\test\dt1.xml");
            sr.Close();

            while ((csvData2 = sr2.ReadLine()) != null)
            {
                String[] data2 = csvData2.Split(',');
                DataRow newRow2 = dt2.NewRow();
                newRow2[0] = data2[0].ToString();
                newRow2[1] = data2[1].ToString();
                newRow2[2] = data2[2].ToString();
                dt2.Rows.Add(newRow2);

                Console.WriteLine("Row added for: dt2");
            }

            dt2.WriteXml(@"c:\test\dt2.xml");
            sr2.Close();

            foreach (DataRow row1 in dt.Rows)
            {
                //Dont know what to do here
            }
        }

        catch (Exception e)
        {
            //Console.WriteLine("The files could not be read:");
            //Console.WriteLine(e.Message);
            StreamWriter sw = new StreamWriter(@"c:\test\error.txt");
            sw.WriteLine(e.Message);
            sw.Close();

        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T01:17:45.710

不知道我是否完全理解。但正如我可以想象的那样，它应该是这样的：

```
 DataTable dtSampleOne = new DataTable();
            DataTable dtSampleTwo = new DataTable();

            foreach (DataRow rowSampleOne in dtSampleOne.Rows)
            {
                string zipCodeSampleOne = rowSampleOne["zipCodeToMatchOne"].ToString();

                foreach (DataRow rowSampleTwo in dtSampleTwo.Rows)
                {
                    if (rowSampleTwo["zipCodeToMatchTwo"].ToString().Equals(zipCodeSampleOne))
                    {
                        // Do your stuff here
                    }                            
                }
            } 
```

如果您有任何需要，我会保持联系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:18:42.250

最简单的方法是在存储过程中完成所有操作。所以你的存储过程做一个简单的匹配（可能使用相交）并返回结果。如果你不能使用存储过程，我会选择这两个集合并加载到列表中，然后你可以使用 LINQ 命令来进行相交。不需要 foreach 循环。

```
List<string> list1 = // load list from db
List<string> list2 = // load second list from db

var result = list1.Intersect(list2); 
```

就是这个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-07T16:22:03.047

使用 LINQ，我们可以进一步改进 Luis Hernández 给出的代码，尽管它可以完成这项工作。

在给定的解决方案（Luis Hernández）中，我们有 2 个循环。假设 SampleOne 为 100 行，SampleTwo 为 200 行。我们最终会循环 100 X 200 次！

相反，我们可以获得匹配的记录，并且我们可以只使用这些记录进行循环。这将避免不必要的循环。

```
 var sampleOne = new DataTable();
        var sampleTwo = new DataTable();

        // TODO : I assume these two table have the common column "ZipCode".
        // TODO : Add your sample data here!

        var matchingRows = from s1 in sampleOne.AsEnumerable()
                           join s2 in sampleTwo.AsEnumerable() on s1.Field<string>("ZipCode") equals s2.Field<string>("ZipCode")
                           select s1;

        foreach (var row in matchingRows)
        {
            // Do your stuff here !
        } 
```

如果我的解决方案不符合要求，请随时通知我！

# coffeescript - 内联迭代键，数组中对象的值

> ID：11182414
> 
> 赞同：0
> 
> 时间：2012-06-25T00:57:32.993
> 
> 标签：coffeescript, iteration, inline

在咖啡脚本中，我们可以这样做：

```
rows = [
    {a: 1}
    {b: 2}
]

for row in rows
    for k,v of row
        alert "#{k}: #{v}" 
```

那么为什么我们不能这样做呢？：

```
for k,v of row for row in rows
    alert "#{k}: #{v}" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T01:50:35.260

你不能那样做，但你可以反转内部循环并将循环结构放在表达式之后：

```
for row in rows
  alert "#{k}: #{v}" for k,v of row 
```

而且，由于该内循环也是一个表达式，您也可以以相同的方式反转外循环：D

```
alert "#{k}: #{v}" for k,v of row for row in rows 
```

与您尝试编写的内容最相似的可能是：

```
for row in rows then for k,v of row 
  alert "#{k}: #{v}" 
```

可以使用另一个进一步内联`then`（`then`关键字通常相当于换行符并添加一级缩进）：

```
for row in rows then for k,v of row then alert "#{k}: #{v}" 
```

所有这些替代方案都会生成相同的 JS 代码，因此选择一个或另一个不会导致性能下降或类似情况：D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T00:59:39.140

因为这种复合语法不是 Coffeescript 语言的一部分。编程语言不像人类语言那样流畅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T09:20:19.250

当您尝试运行时，`for k,v of row for row in rows`您会在第 1 行收到*Parse 错误： Unexpected 'FOR'*。

那是因为你放东西的那一刻`for row in rows`，它一定是一种*表达*，而`for k,v of row`不是一种。您可以通过使前缀循环成为实际表达式来验证这一点：

```
row for k,v of row for row in rows 
```

这编译。因此，与使用后缀形式进行迭代的方式相同`rows`，您必须对内部形式进行后缀：

```
alert "#{k}: #{v}" for k,v of row for row in rows 
```

要实现您想要的分隔，您需要使用`then`替换换行符，而不是使用后缀表达式：

```
for row in rows then for k,v of row
    alert "#{k}: #{v}" 
```

# sql - 如何将日期数据类型格式化为 mmm/yyyy？

> ID：11182415
> 
> 赞同：1
> 
> 时间：2012-06-25T00:58:03.733
> 
> 标签：sql, informix

ISQL 执行屏幕：

我有一个用于存储“制造日期”的日期列（格式 =“mmm-dd-yyyy”）。大多数有此日期的物品（例如计算机、电视等）通常只提供制造的月份和年份。我在 Perform 的属性部分尝试使用“mmm-yyyy”，但编译器不喜欢它！.. 是否有替代方法无需使用 CHAR 或 DATETIME YEAR TO MONTH 列？

编辑：DBDATE=MDY4-

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T14:51:58.447

要在 ISQL 屏幕中输入 DATE，您必须按某种顺序指定年月日（在广泛的范围内，您可以控制顺序）。但是，DATE 必须是完整的。如果你只想要年和月，那么你应该使用 DATETIME YEAR TO MONTH；根据定义，它不接受日值。

剩下的唯一选择是使用当月的第一天并让表单自动提供日期值。您可以尝试使用 PICTURE 和/或 FORMAT 子句，但我不相信它们会有所帮助。

# java - Java：如何获取 xml 节点路径

> ID：11182420
> 
> 赞同：2
> 
> 时间：2012-06-25T00:58:49.257
> 
> 标签：java, xml

我有以下xml：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<RootNode>
 <Node_11>LEVEL_1-Value_1</Node_11>
 <Node_12>LEVEL_1-Value_2</Node_12>
 <Node_13>
    <Node_121>LEVEL_2-Value_1</Node_121>
 </Node_13>
 <Node_14>
    <Node_121>
        <Node_1231>
            <Node_12341>LEVEL_4-Value_1</Node_12341>
            <Node_12342>LEVEL_4-Value_2</Node_12342>
            <Node_12343>LEVEL_4-Value_3</Node_12343>
        </Node_1231>
    </Node_121>
 </Node_14>
 <Node_15>
    <Node_25>
        <Node_251>Value_251</Node_251>
        <Node_252>Value_252</Node_252>
    </Node_25>
    <Node_25>
       <Node_251>Value_253</Node_251>
       <Node_252>Value_254</Node_252>
    </Node_25>
    <Node_25>
        <Node_251>Value_255</Node_251>
        <Node_252>Value_256</Node_252>
    </Node_25>
    <Node_25>
        <Node_251>Value_257</Node_251>
        <Node_252>Value_258</Node_252>
    </Node_25>
 </Node_15>
</RootNode> 
```

我必须使用 java 打印带有值的节点路径。这是我必须得到的输出样本：

```
RootNode.Node_11 = LEVEL_1-Value_1
RootNode.Node_12 = LEVEL_1-Value_2
RootNode.Node_13.Node_121 = LEVEL_2-Value_1
RootNode.Node_14.Node_121.Node_1231.Node_12341 = LEVEL_4-Value_1
RootNode.Node_14.Node_121.Node_1231.Node_12342 = LEVEL_4-Value_2
RootNode.Node_14.Node_121.Node_1231.Node_12343 = LEVEL_4-Value_3
RootNode.Node_15.Node_25.Node_251 = Value_251
RootNode.Node_15.Node_25.Node_252 = Value_252
RootNode.Node_15.Node_25.Node_251 = Value_253
RootNode.Node_15.Node_25.Node_252 = Value_254
RootNode.Node_15.Node_25.Node_251 = Value_255
RootNode.Node_15.Node_25.Node_252 = Value_256
RootNode.Node_15.Node_25.Node_251 = Value_257
RootNode.Node_15.Node_25.Node_252 = Value_258 
```

这是我最后的java代码。我无法让它正常工作。

```
public class Read_XML {
 static String rootTag = "";
 static HashMap valueMap = new HashMap();
 public static void main(String arg[]) throws IOException, AxiomRuntimeException
 {

    File inFile = new File("C:/Test.xml");

    FileReader fr = new FileReader(inFile);
    BufferedReader br = new BufferedReader(fr);

    String sXML = "";
    for (String line; (line = br.readLine())!= null;)
    {
        sXML += line;
    }
    Document doc = XMLStringParser.parseString(sXML);
    Element root = doc.getDocumentElement();
    rootTag += root.getTagName();
    NodeList rootList = doc.getElementsByTagName("RootNode");
    Element rootList_node = (Element) rootList.item(0);
    NodeList kids = rootList_node.getChildNodes();
    for(int i = 0; i < kids.getLength(); i++)
    {
        String nextTag = "";
        if(kids.item(i) instanceof Element)
        {
            nextTag = rootTag + "." + kids.item(i).getNodeName();
            int level = 0;
            processChildNode(kids.item(i).getChildNodes(), nextTag, level);
        }
    }
    Iterator it = valueMap.keySet().iterator();
    for (;it.hasNext();)
    {
        String key = it.next().toString();
        String val = valueMap.get(key).toString();
        System.out.println(key + " = " + val );
    }
}

public static void processChildNode(NodeList listOfNodes, String tags, int level)
{
    String tagPath = tags;
    int curLevel = 0;
    for(int i = 0; i < listOfNodes.getLength(); i++)
    {
        System.out.println("Node Name = " + listOfNodes.item(i).getNodeName());
        if(listOfNodes.item(i) instanceof Element)
        {
            if(curLevel == level + 1)
            {
                tagPath = tags;
            }
            else
            {
                curLevel = level +1;
                tagPath += "." + listOfNodes.item(i).getNodeName();
            }
            if(listOfNodes.item(i).getChildNodes().getLength() >= 1)
            {
                processChildNode(listOfNodes.item(i).getChildNodes(), tagPath, curLevel);
            }

        }
        else if(listOfNodes.item(i) instanceof Text && listOfNodes.getLength() == 1)
        {
            String value = listOfNodes.item(i).getNodeValue();
            valueMap.put(tagPath, value);
        }

    }
 }
} 
```

这是当前输出：

```
RootNode.Node_15.Node_25.Node_251 = Value_251
RootNode.Node_14.Node_121.Node_1231.Node_12341 = LEVEL_4-Value_1
RootNode.Node_12 = LEVEL_1-Value_2
RootNode.Node_15 = Value_258
RootNode.Node_14.Node_121.Node_1231 = LEVEL_4-Value_3
RootNode.Node_15.Node_25 = Value_252
RootNode.Node_11 = LEVEL_1-Value_1
RootNode.Node_15.Node_251 = Value_257
RootNode.Node_13.Node_121 = LEVEL_2-Value_1 
```

请帮助我使它工作。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:15:14.933

你有这个问题是因为你使用 a`HashMap`来存储你的值。例如路径`RootNode.Node_15.Node_25.Node_252`多次出现，当您在地图中放置一个新值时，旧值将被删除。

您可以将您的替换`HashMap`为 a`List`以查看所有找到的路径。看这个例子：

```
static List<String []> valueList = new ArrayList<String []>(); 
```

并且您以这种方式添加值：

```
valueList.add(new String [] {tagPath, value}); 
```

最后，您可以按如下方式显示路径：

```
Iterator<String []> it = valueList.iterator();
for (;it.hasNext();) {
    String [] val = it.next();
    System.out.println(val[0] + " = " + val[1] );
} 
```

**已编辑**

路径构造也有一个错误，并且变量`level`和`curLevel`不是必需的。这是一个有效的代码示例：

```
public static void processChildNode(NodeList listOfNodes, String tags) {
    for (int i = 0; i < listOfNodes.getLength(); i++) {
        if (listOfNodes.item(i) instanceof Element) {
            String tagPath = tags + "." + listOfNodes.item(i).getNodeName();
            if (listOfNodes.item(i).getChildNodes().getLength() >= 1) {
                processChildNode(listOfNodes.item(i).getChildNodes(),
                        tagPath);
            }

        } else if (listOfNodes.item(i) instanceof Text
                && listOfNodes.getLength() == 1) {
            String value = listOfNodes.item(i).getNodeValue();
            valueList.add(new String[] { tags, value });
        }
    }
} 
```

# c# - 动态填充复选框列表控件

> ID：11182422
> 
> 赞同：3
> 
> 时间：2012-06-25T00:59:08.147
> 
> 标签：c#, asp.net, ajax, asp.net-ajax

对于下一个场景，我已经搞砸了几个小时：

*   当用户在文本框中键入一些文本（某种自动完成扩展器）时，动态填充复选框列表。

正如我之前告诉过你的，我已经搞砸了几个小时（几乎一整天），仍然找不到正确的方法。起初我想到的是使用动态填充控件和网络方法，但无法使其工作。有什么建议么？

提前致谢。

已编辑：我正在尝试做的是一种 hotmail 功能。当您点击新电子邮件然后点击“收件人：”按钮时，它会弹出一个小窗口。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T03:40:25.583

这是代码：

首先，我使用以下函数创建了名为 Lookup.asmx 的 asmx Web 服务：

```
[WebMethod]
public GetUsersResponse[] LoadUsers()
{
    if (HttpContext.Current.Session["Users"] != null) 
    {
        return (List<GetUsersResponse>)HttpContext.Current.Session["Users"];
    }

    return new List<GetUsersResponse>();

}

[WebMethod]
public GetUsersResponse[] GetUsers(string query)
{
    var users = new List<string>
    {
        "Brad Pitt",
        "Brad Pitt2",
        "Brad Pitt3",
        "Angelina Jolie",
        "Jeniffer Aniston",
        "Tom Cruise",
        "Katie Holmes",
        "Tom Hanks",
        "Sean Pen",
        "Jude Law",
        "Bruce Willis"
    };

    var returnUsers = users.Where(s => s.ToLower().Trim().StartsWith(query.ToLower().Trim()))
                     .Select(s => new GetUsersResponce { Name = s })
                     .ToArray();

    HttpContext.Current.Session["Users"] = returnUsers;
    HttpContext.Current.Session["Query"] = query;
    return returnUsers;
}

public class GetUsersResponse
{
    public string Name { get; set; } 
} 
```

确保在 web 服务中取消注释 [System.Web.Script.Services.ScriptService] 注释。然后我使用了这个 jquery/html（不要忘记引用 jquery）：

```
<script type="text/javascript">
    $(function () {
        $.ajaxSetup({ type: 'POST', dataType: 'json', contentType: 'application/json', data: {} });

        $.ajax({
            url: 'Lookup.asmx/LoadUsers',
            data: '',
            success: function (data) {
                var responseJson = data.d; 
                if (responseJson.length > 0) {
                    $.each(responseJson, function () {
                        $("#result").append("<li><input type='checkbox'>" + this.Name + "</input></li>")                                    
                    });
                }
            }
        });

        $("#txtType").keyup(function () {
            var input = $(this).val();
            $("#result").html("");
            if (input && input.length > 3) {
                $.ajax({
                    url: 'Lookup.asmx/GetUsers',
                    data: '{ "query": "' + input + '" }',
                    success: function (data) {
                        var responseJson = data.d; 
                        if (responseJson.length > 0) {
                            $.each(responseJson, function () {
                                $("#result").append("<li><input type='checkbox'>" + this.Name + "</input></li>")                                    
                            });
                        }
                    }
                });

            }
        });
    });
</script>
<table cellpadding="5">
    <tr>
        <td>Search</td>
        <td><asp:TextBox ID="txtType" runat="server" ClientIDMode="Static" /></td>
    </tr>
    <tr>            
        <td colspan="2">
            <ul id="result" style="list-style: none;">
            </ul>
        </td>
    </tr>
</table> 
```

然后您可以轻松地使用 jquery 查看选中了哪些复选框。

# php - 将 timediff 添加到输出

> ID：11182424
> 
> 赞同：0
> 
> 时间：2012-06-25T00:59:08.473
> 
> 标签：php, mysql

我正在 php 中为 mysql 数据库运行一个查询，并成功运行了一个循环来检索我需要的信息。但是，我的部分输出需要一个额外的查询来输出两个字段的时间差异，我无法让它正确回显。$billable 工作正常，只是无法回显附加行以将时差添加到表中

```
$billable = mysql_query("SELECT * FROM responses WHERE company ='XXXXXX' && date  BETWEEN '$start_date' AND '$end_date' && time_arrived >0 && TIMEDIFF(time_arrived, time_received)< 2500", $connection); 
$num_rows = mysql_num_rows($billable);

$time_diff = mysql_query("SELECT TIMEDIFF('time_received',time_arrived')FROM alarmresponses WHERE company ='XXXXXXX' && date BETWEEN '$start_date' AND '$end_date' && time_arrived >0 && TIMEDIFF(time_arrived, time_received)< 2500 AS value_sum
", $connection); 
$elapsed = mysql_num_rows($time_diff);

while ($bill = mysql_fetch_array($billable)){

echo"<p style='page-break-before: always'>
<table>

<tr><td><p style='text-align: right;'>SCHEDULE B</p></td></tr>
<tr><td><p style='text-align: right;'>Page 1 of 1</p></td></tr>
<tr><td><p style='text-align: center;'>XXXXXXX</p></td></tr>
<tr><td><p style='text-align: center;'>SERVICE RESPONSE REPORT</p></td></tr>

<tr><td>Property Owner's Name</td</td>".$bill['name']."</td><td>DATE</td><td>".$bill['date']."</td></tr>
<tr><td>Address</td><td>".$bill['address']."</td></tr>
<tr><td>Type of SERVICE</td><td>".$bill['type']."</td></tr>
<tr><td>Time Received:</td><td>".$bill['time_received']."</td><td>Time Arrived<td><td>".$bill['time_arrived']."Time Clear:</td><td>".$bill['time_cleared']."</td></tr>";

echo"<tr><td>Total Time Elapsed:"***.$elapsed['value_sum'].***"Minutes00:00</td></tr>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T11:17:56.477

您需要在查询中选择它，否则它不会成为您的结果集的一部分：

```
$billable = mysql_query("SELECT *, TIMEDIFF(time_arrived, time_received) AS time_elapsed FROM responses WHERE company ='XXXXXX' && date  BETWEEN '$start_date' AND '$end_date' && time_arrived >0 && TIMEDIFF(time_arrived, time_received)< 2500", $connection); 

echo $bill['time_elapsed']; // get the value and print it 
```

仅供参考，不要将 mysql_* 函数用于新代码。它们不再被维护并且社区已经开始了[弃用过程](http://goo.gl/KJveJ)。看到[红框](http://goo.gl/GPmFd)了吗？相反，您应该了解[准备好的语句](http://goo.gl/vn8zQ)并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)。如果你不能决定，[这篇文章](http://goo.gl/3gqF9)将有助于选择。如果你想学习，这里有[很好的 PDO 教程](http://goo.gl/vFWnC)。

# jquery - 单击时如何使用jquery从列表项中获取数据值

> ID：11182428
> 
> 赞同：1
> 
> 时间：2012-06-25T01:00:27.573
> 
> 标签：jquery

我有一些像这样的 HTML：

```
<div id="adiv">
    <ul>
            <li data-id="3">Cat</li>
            <li data-id="4">Dog</li>
        </ul>
</div> 
```

我想要的是在用户单击列表项时提醒 data-id 值。

在jquery中我试过：

```
$('li').click(function () {
        alert(this.attr('data-id'));
    }); 
```

虽然抛出异常。谁能告诉我我做错了什么以及如何解决？

例外是：Microsoft JScript 运行时错误：对象不支持属性或方法“文本”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T01:02:29.097

该`attr`函数是`jQuery`对象的成员，这意味着您需要`$()`调用`this`：

```
$('li').click(function () {
    alert($(this).attr('data-id'));
}); 
```

**编辑**：正如评论中指出的那样，这可能是一个更好的方法：

```
$('li').click(function () {
    alert($(this).data('id'));
}); 
```

# jquery - 与多个选择器一起使用的变量

> ID：11182429
> 
> 赞同：0
> 
> 时间：2012-06-25T01:00:48.913
> 
> 标签：jquery

好的，对我来说又是一个 jquery 选择器的噩梦！我已经阅读了大约 20 个类似主题的问题，但我找不到一个与我的问题有关的问题……抱歉，如果它确实存在（可能在某处存在），它似乎毫无意义地简单，但不知何故我无法让它工作。

我有一个 img 列表，当你点击一个时，我会得到它的第二类。一旦我有了第二堂课，我想隐藏或显示其他有该堂课的元素

继承人一些代码来澄清：

```
<ul id="thumbail_list">
   <li class="image fantome"><img src="images/fantome.png"/></li>
<ul> 
```

假设我点击我的幻影图像我希望在其他地方看到默认隐藏的文本和幻影类的段落变得可见。

```
$('#thumbail_list li').click(function() {

    var Chosenclass = $(this).attr('class').split(' ')[1];  
    var texte = '.text .' + Chosenclass ;
    var image = '.image .' + Chosenclass ;

    $('.image').fadeIn('slow', function(){
        $(image).fadeOut('slow', function(){
            $(texte).fadeIn('slow');            
        });

    });
} 
```

但我无法让它工作，控制台没有向我显示任何错误，而且我已经在任何地方都发出警报，它总是向我显示我想要的......但是不可见的文本不会显示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T01:06:34.900

如果文本同时具有*.text*和 .fantome 类，则必须链接选择器：

```
.text.fantome <- without space 
```

所以摆脱空间：

```
var texte = '.text.' + Chosenclass ;
                ^^^^ 
```

*使用*空格，您将选择类 ChosenClass 的对象，该对象是类 .text 元素的**子**（或后代）。

# c++ - 结构继承自身

> ID：11182430
> 
> 赞同：6
> 
> 时间：2012-06-25T01:01:03.840
> 
> 标签：c++, templates

我从朋友那里得到了一段代码。但我真的很困惑，一个结构怎么能从自己继承呢？继承有意义吗？

```
template<class TYPELIST>
struct Field : public Field<typename TYPELIST::Tail> {
  typedef TYPELIST TypeListType;
  typename TypeListType::Head item_;
};

template<>
struct Field<TypeListEnd> {
}; 
```

我不知道这里发生了什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-25T01:05:31.280

`Field`不从自身继承；相反，`template<typename TYPELIST> Field`继承自`Field<typename TYPELIST::Tail>`. 只要两个模板参数列表是不同的就可以了。

[在可变参数模板](http://en.wikipedia.org/wiki/Variadic_template#section_1)被添加到语言之前，类型列表是一种允许模板（实际上）采用可变数量的类型参数的古老方法。他们实现了一个简单的单链表结构，相当于 LISP 的 cons 单元，其中`Head`“有效负载”类型和`Tail`列表的其余部分是类型列表或`TypeListEnd`类型，相当于 LISP `nil`。

假设我们有

```
typename TypeList<int, TypeList<char, TypeList<float, TypeListEnd> > > MyTypeList; 
```

这里我假设`TypeList`是一个模板定义`Head`和`Tail`typedef 成员分别对应于它的第一个和第二个模板参数：

```
template<typename Head, Tail> struct TypeList { typedef Head Head; typedef Tail Tail; }; 
```

请注意，我必须用空格分隔右尖括号，因为这可能必须在 C++03 编译器上编译，`>>`即使在模板上下文中也总是被解释为右移运算符。

然后你的`Field`元函数，当调用 on 时`MyTypeList`，将扩展为

```
Field<MyTypeList>;

Field<typename TypeList<int, TypeList<char, TypeList<float, TypeListEnd> > > >;

struct Field<...>: TypeList<int, TypeList<char, TypeList<float, TypeListEnd> > >::Tail {
    TypeList<int, TypeList<char, TypeList<float, TypeListEnd> > >::Head item;
};

struct Field<...>: TypeList<char, TypeList<float, TypeListEnd> > {
    int item;
};

...

struct Field<...>: struct Field<...>: struct Field<...>: struct Field<TypeListEnd> {
} {
    float item;
} {
    char item;
} {
    int item;
}; 
```

这为您提供了`struct`通过公共继承包含类型列表中的所有类型。当然，用这样的 a 做任何有用的事情`struct`是另一回事，留给读者作为练习。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T01:31:58.317

当你有一个类模板`template <typename X> class SomeTemplate`时，类类型`SomeTemplate<A>`和`SomeTemplate<B>`是两个完全不同的、不相关的类类型（假设`A`和`B`是不同的）。由于它们是两种完全不同的类型，因此其中一种继承自另一种并没有错。`SomeTemplate<A>`可以继承自`SomeTemplate<B>`，而后者又可以继承自`SomeTemplate<C>`等等，只要它在某些时候不会成为自引用的。

换句话说，在你的例子`struct`中并不像你所相信的那样从自身继承。你的例子中根本没有`struct`。相反，您的示例有几个s *模板*`struct`。`struct`当且仅当它们被*专门*化时，即当所有模板参数都被替换为实际类型时，这些模板才变为s。由于继承，该专业化可能会变成合法或非法，具体取决于其他详细信息（您没有提供）。

# sql - 将结束日期添加到记录，即下一条记录的开始日期

> ID：11182442
> 
> 赞同：1
> 
> 时间：2012-06-25T01:04:52.573
> 
> 标签：sql

我有一个表，其中包含链接到另一个表的优先级记录。

`FK - Priority - PriorityUpdateDateTime`

我要做的是向该表添加结束日期，但仅作为临时表。

所以我需要的是`FK - Priority - StartDate - EndDate`

其中 EndDate 是下一个 PriorityUpdateDateTime

IE

`FK - Priority - PriorityUpdateDateTime`

`123 - 4 - 2011-02-25`

`123 - 2 - 2011-02-30`

`123 - 3 - 2011-03-10`

变成

`FK - Priority - StartDate - EndDate`

`123 - 4 - 2011-02-25 - 2011-02-30`

`123 - 2 - 2011-02-30 - 2011-03-10`

`123 - 3 - 2011-03-10 - NULL`

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:40:33.043

好的，您可以使用这样的子选择：

```
-- nasty sub select, lets see if we can do better
SELECT  T1.[FK], 
        T1.[Priority], 
        T1.[PriorityUpdateDateTime] AS 'StartDate', 
        (
            SELECT MAX(T2.[PriorityUpdateDateTime]) AS MP
            FROM @test AS T2
            WHERE T2.[FK] = T1.[FK]
                AND T2.[Priority] < T1.[Priority] 
        ) AS 'EndDate'
FROM @test AS T1 
```

这是我创建测试表和数据的临时脚本

```
DECLARE @test AS TABLE
(
    [FK] INT NOT NULL,
    [Priority] INT NOT NULL,
    [PriorityUpdateDateTime] DATETIME NOT NULL
)

INSERT INTO @test VALUES(123, 4, '20110225')
INSERT INTO @test VALUES(123, 3, '20110228') -- there are only 28 days in Feb in 2011 (not 30)
INSERT INTO @test VALUES(123, 2, '20110310')

-- nasty sub select, lets see if we can do better
SELECT  T1.[FK], 
        T1.[Priority], 
        T1.[PriorityUpdateDateTime] AS 'StartDate', 
        (
            SELECT MAX(T2.[PriorityUpdateDateTime]) AS MP
            FROM @test AS T2
            WHERE T2.[FK] = T1.[FK]
                AND T2.[Priority] < T1.[Priority] 
        )
FROM @test AS T1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T03:21:31.127

@马特@凯恩

凯恩做得很好，只是他选择了错误的不等式列。我只是做了一些更正。如果有人能想出一个更快的方法，而不是“古怪的更新”，我会感到惊讶，这可能会让相关的子查询和 CROSS APPLY 方法大开眼界。

这是构建更多测试数据的代码，而不是出于性能测试目的而动摇的数据。

```
--===== Conditionallly drop the test table to make reruns in SSMS easier
     IF OBJECT_ID('tempdb..#Test','U') IS NOT NULL
        DROP TABLE #Test
;
--===== Create and populate the test table on-the-fly
     -- using a "Pseudo Cursor" which is many times 
     -- faster than a WHILE loop.
 SELECT TOP 100000
        FK = ABS(CHECKSUM(NEWID()))%100+100, -- 100 thru 199
        Priority = ABS(CHECKSUM(NEWID()))%100+1, -- 1 thru 100
        PriorityUpdateDateTime = DATEADD(dd,
                                    ABS(CHECKSUM(NEWID()))%DATEDIFF(dd,'2000','2010')
                                 ,'2000') --20000101 thru 20091231
   INTO #Test
   FROM sys.all_columns ac1 --has more than 4000 rows even on a new system
  CROSS JOIN sys.all_columns ac2
;
--===== Create a clustered index to improve performance by about 10 times in this case
 CREATE INDEX IX_#Test ON #Test (FK,PriorityUpdateDateTime)
; 
```

这是凯恩的代码的两种不同的演绎方式。详细信息在代码中。两者在大约相同的时间内返回相同的结果。

```
--===== Kane's correlated subquery works just fine here once we 
     -- flip it around and use a different column name in the 
     -- inequality part.
 SELECT t1.FK,  
        t1.Priority,  
        StartDate = t1.PriorityUpdateDateTime, 
        EndDate =  
            ( 
             SELECT MIN(t2.PriorityUpdateDateTime)
               FROM #Test t2 
              WHERE t2.FK = t1.FK 
                AND t2.PriorityUpdateDateTime > t1.PriorityUpdateDateTime  
            ) 
   FROM #Test t1 
  ORDER BY t1.FK, t1.PriorityUpdateDateTime, t1.Priority
;
--===== Or, you could use a CROSS APPLY and get the same thing because
     -- a CROSS APPLY isn't much more than a correlated sub-query.
 SELECT t1.FK,  
        t1.Priority,  
        StartDate = t1.PriorityUpdateDateTime,  
        d.EndDate
   FROM #Test t1 
  CROSS APPLY 
        ( 
         SELECT MIN(t2.PriorityUpdateDateTime)
           FROM #Test t2 
          WHERE t2.FK = t1.FK 
            AND t2.PriorityUpdateDateTime > t1.PriorityUpdateDateTime  
        ) d (EndDate)
  ORDER BY t1.FK, t1.PriorityUpdateDateTime, t1.Priority
; 
```

# php - 显然是无意义的 404 跨浏览器错误

> ID：11182444
> 
> 赞同：0
> 
> 时间：2012-06-25T01:05:17.543
> 
> 标签：php, facebook, wordpress, http-status-code-404

我通过 WP-FB-AutoConnect wordpress 插件遇到了一个全浏览器错误。成功登录（通过日志和会话测试确认）后，表单的 callback_function.submit() 会导致 404 错误。但是，当我刷新页面时，该文件确实存在。好像元素的 action 属性中存在某种编码错误，但是，我尝试了所有明显的修复，从 urlencode() 到 htmlentities()。

由于我无法提供示例，因为它位于受保护的开发环境中，请允许我描述插件的工作原理。我有一种强烈的感觉，这与特定的插件无关，而是我根本不熟悉的东西的结果。

1.  用户点击 Facebook 登录。 ![](../Images/4ffa25da6a681502912871c82f420c08.png)
2.  Facebook 登录提示按预期出现，用户点击“允许”
3.  会话开始。在日志中确认，并通过访问网站检查会话确认。
4.  但是，当通过回调 [document.callback_function.submit() 包含在提供给 Facebook API 的函数中] 提交表单时，结果页面是“链接似乎已损坏 [chrome]”。 ![](../Images/d27d6a7127d289460764bf328aac3111.png)
5.  文件存在。这可以通过刷新浏览器所说的页面不存在来确认。 ![](../Images/c6cec02d7d819186b8f456e070ba5a6f.png)

一些注意事项：

1.  权限是正确的。页面在刷新时加载。该文件存在。
2.  这个错误出现在 Webkit 和 Moz 中，我没有为 IE 烦恼，因为那是一组完全不同的头痛。
3.  该链接是正确的，并且 URL 中的所有字符似乎都没有被错误地编码。
4.  同样，任何日志中的错误为零。

请注意：我很难描述这个错误，因为它非常不起眼。在我 13 年的 Web 开发中，我从未遇到过这样的事情。

我希望有人经历过这样的事情并对此事有任何意见。我真的希望这对我来说只是一个谦卑的时刻。经过数小时调试一个看不见的错误，并且由于我缺乏描述问题的能力而拒绝来到这里，我别无选择。我找不到任何此错误的发生，无论是 Facebook 登录特定错误，还是通常在 Javascript、浏览器问题或通过 Google 或 Stack Overflow 等途径的服务器端问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:25:21.547

仔细检查脚本，从浏览器发送的错误来看，似乎脚本本身存在错误，导致它失败。如果在站点加载完成之前发生错误，PHP 将无法解析它们。

# php - 我可以使用 PHP、MySQL 和 Javascript 在我的网站上创建即时消息系统吗？

> ID：11182445
> 
> 赞同：0
> 
> 时间：2012-06-25T01:05:29.800
> 
> 标签：php, javascript, mysql, cron, chat

我可以只使用这些技术为我的网站创建类似 Facebook 的即时消息/聊天功能，还是需要调用其他技术，例如 cron？我正在运行 Linux 服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:08:08.847

PHP、MySQL 和 Javascript（使用 AJAX）将为您提供创建消息传递系统所需的工具。

[一些详尽的信息](http://www.ibm.com/developerworks/web/tutorials/wa-aj-imclient/index.html)，但请记住，这是一个很长的教程。

[这也应该证明有帮助](http://www.pixel2life.com/forums/index.php?/topic/42552-ajaxphp-instant-messaging-system/)并相应地满足您的需求。教程也不长，但是很透彻。

不过，我建议您对这些教程中的任何一个都持保留态度。构建自己的或使用已经构建的将被证明是最有效的。如果这对您来说也是全新的，那么为自己构建它当然会教给您一些东西，所以如果您决定这样做，这是一个双赢的局面。

但是考虑一下这样一个事实，即使用别人的逻辑并不可耻。使用教程获取其他人可能如何完成它的文档，并阅读我为您发布的主题中的回复。

祝你好运！

# ruby - 如何在 Ruby 中合并为一行？

> ID：11182447
> 
> 赞同：3
> 
> 时间：2012-06-25T01:05:42.263
> 
> 标签：ruby, iterator, each

下面的代码工作正常。但它看起来很笨拙。

您如何将以下代码合并为一行？

```
data = Array.new
@results.each{ |result| data.push(result.get_output) }
data.join("\n") 
```

红宝石 1.9.3

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-25T01:12:45.383

[映射](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-map)原始集合而不是先创建新数组：

```
@results.map(&:get_output).join("\n") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T01:13:18.750

我还没有检查这个，但尝试类似：

```
data = @results.map{ |result| result.get_output }.join("\n") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-25T01:16:29.340

```
data = @results.collect(&:get_output).join("\") 
```

1.  使用`collect`（或映射）创建数组
2.  (&:get_output)，相当于`collect{|result| 结果.get_output}
3.  链连接到结果的末尾以对其进行格式化

如果您得到空行，请`compact`在加入前添加。这有助于清理结果。

# registrar - 不需要签协议只要一本书的域名注册商

> ID：11182449
> 
> 赞同：-5
> 
> 时间：2012-06-25T01:06:04.457
> 
> 标签：registrar

大多数域名注册商都要求您阅读并签署一份数万字的协议，并通过引用进一步包含其他文件。有谁知道有短期协议或没有协议的注册商？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2014-12-03T18:00:09.153

多年来，我使用过许多域名注册商。TOS 通常很复杂（对于我们这些阅读它们的人来说......呃，略读它们......有时）。我目前认为 Namecheap 是最直接和公平的。我从不喜欢他们的名字，但他们似乎保持了一定程度的社区信任并减少了不必要的负担。

过去，我喜欢 Moniker，因为他们保持专业；但是，我的看法发生了变化。他们变得越来越复杂，他们的协议似乎给了他们所有的保护，而我几乎没有——如果有的话。示例：现在这是关于他们如何使用您的个人数据的协议的顶部（限制他们的数据）：

[“请注意，我们可以自行决定将个人信息用于任何法律允许的目的。”](https://www.moniker.com/legal/privacy-policy)

不错吧？这太厚颜无耻了，以至于我一直在从他们那里转移我的域名。此外，网络解决方案似乎同样糟糕，但由于协议的长度和行话，很难说清楚。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-25T01:13:10.720

如果您有，请使用当地的互联网服务提供商或有线电视公司。这可能是您通向极简主义 22 条的道路。

# php - SVG onClick 与 PHP

> ID：11182452
> 
> 赞同：0
> 
> 时间：2012-06-25T01:06:49.557
> 
> 标签：php, database, svg, onclick

我可以在 SVG onclick 事件中插入 PHP 数据库编码吗？

我尝试使用 onclick 事件在被点击时清除数据库。我是编码新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:08:51.750

制作一个清除数据库的 php 脚本，然后在单击 SVG 元素后让 javascript 通过 AJAX 调用 PHP 脚本的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:13:01.420

在 HTML 中有表单。您可以使用这些来将输入数据发送到例如 PHP 文件。

如果您想要的是非刷新页面请求，您可以合并 AJAX。

# ios - GCD dispatch_after 调用导致 SIGBUS 信号

> ID：11182453
> 
> 赞同：2
> 
> 时间：2012-06-25T01:06:53.933
> 
> 标签：ios, grand-central-dispatch, uiapplicationdelegate

`dispatch_after`当我的应用程序被加载以执行某些行为时，我正在使用 GCD 的方法。预期的行为是在结束后等待 3 秒`applicationDidFinishLaunchingWithOptions`以执行在后台队列中运行的选择器。

我的测试设备上没有遇到任何崩溃，但我有未捕获的 SIGBUS 信号的用户崩溃报告，原因是 BUS_ADRALN 异常。根据我对这段代码的理解，BUS_ADRALN 错误表示地址对齐错误。

这就是我创建计时器的方式：

```
double delayInSeconds = 3.0;
dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
dispatch_after(popTime, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0),
                     ^(void){
                         [self methodToPerformInBackground];
                     }); 
```

什么可能导致此崩溃？

由于多线程错误可能是一种奇怪的野兽，因此我将抛出一些我一直在脑海中折腾的想法。

*   我在对`[self performSelectorOnMainThread:withObject:waitUntilDone]`. 在以这种方式调用的选择器中执行此操作是否有问题？
*   由于我是调用`dispatch_get_global_queue`而不是调用，因此`dispatch_create_queue`我不需要保留此方法返回的队列。这个推理正确吗？
*   在此代码中，`self`是应用程序委托。应用程序进入后台或终止后尝试执行块是否会导致崩溃？应用程序会在关闭时自动清理任何分派的块吗？
*   被调用的方法内部的某些东西导致了崩溃，但 GCD 没有提供堆栈跟踪。

**编辑：**我宁愿不包含在块中调用的代码，因为我不相信这是主要问题。这是堆栈跟踪。线程 0 上的崩溃看起来好像问题出在 GCD 中，而不是块中调用的代码。

**编辑#2：**在查看了更多崩溃报告后，我有一个奇怪的消息要分享。只有运行 iOS 4.2.X 及更低版本的用户才会出现此崩溃。由于 iOS 4.0 及更高版本支持 GCD，我猜想在 4.3 中修补了一个错误。

```
Thread 0 Crashed:
0  libSystem.B.dylib                  0x35e5fb10 _dispatch_retain + 0
1  libSystem.B.dylib                  0x35e5df8c dispatch_after_f + 80
2  libSystem.B.dylib                  0x35e5e070 dispatch_after + 72
3  MyApplication                              0x0000466c -[MyApplicationDelegate applicationDidFinishLaunchingPart2:] (MyApplicationDelegate.m:366)
4  CoreFoundation                      0x37538f79 -[NSObject(NSObject) performSelector:withObject:] + 25
5  Foundation                          0x35171e6d __NSThreadPerformPerform + 273
6  CoreFoundation                      0x375518d1 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 15
7  CoreFoundation                      0x37521ecd __CFRunLoopDoSources0 + 385
8  CoreFoundation                      0x375216f9 __CFRunLoopRun + 265
9  CoreFoundation                      0x3752150b CFRunLoopRunSpecific + 227
10  CoreFoundation                      0x37521419 CFRunLoopRunInMode + 61
11  GraphicsServices                    0x33e76d24 GSEventRunModal + 196
12  UIKit                              0x3591d57c -[UIApplication _run] + 588
13  UIKit                              0x3591a558 UIApplicationMain + 972
14  MyApplication                              0x00003024 main (main.m:113)

Thread 1:
0  libSystem.B.dylib                  0x35d8f974 kevent + 24
1  libSystem.B.dylib                  0x35e5dd70 _dispatch_queue_invoke + 104
2  libSystem.B.dylib                  0x35e5d790 _dispatch_worker_thread2 + 128
3  libSystem.B.dylib                  0x35de6978 _pthread_wqthread + 400

Thread 2:
0  libSystem.B.dylib                  0x35de72fc __workq_kernreturn + 8

Thread 3:
0  libSystem.B.dylib                  0x35d5b3b0 mach_msg_trap + 20
1  CoreFoundation                      0x37521f83 __CFRunLoopServiceMachPort + 95
2  CoreFoundation                      0x37521787 __CFRunLoopRun + 407
3  CoreFoundation                      0x3752150b CFRunLoopRunSpecific + 227
4  CoreFoundation                      0x37521419 CFRunLoopRunInMode + 61
5  WebCore                            0x3318bd1c _ZL12RunWebThreadPv + 532
6  libSystem.B.dylib                  0x35de5b4c _pthread_start + 372

Thread 4:
0  libSystem.B.dylib                  0x35d5b3b0 mach_msg_trap + 20
1  CoreFoundation                      0x37521f83 __CFRunLoopServiceMachPort + 95
2  CoreFoundation                      0x37521787 __CFRunLoopRun + 407
3  CoreFoundation                      0x3752150b CFRunLoopRunSpecific + 227
4  CoreFoundation                      0x37521419 CFRunLoopRunInMode + 61
5  Foundation                          0x3517ec55 +[NSURLConnection(NSURLConnectionReallyInternal) _resourceLoadLoop:] + 217
6  Foundation                          0x3515cb91 -[NSThread main] + 49
7  Foundation                          0x35155b97 __NSThread__main__ + 915
8  libSystem.B.dylib                  0x35de5b4c _pthread_start + 372 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T23:46:49.530

DISPATCH_QUEUE_PRIORITY_BACKGROUND 是 iOS 5.0+ 的一项功能。如果您尝试在 iOS 4.x 上使用它，它将为 NULL（当您尝试保留它时会崩溃，因为 GCD 是一个 C 库并且使用它在 Objective-c 中的使用`NULL`方式是不安全的`nil`）。有关更多信息，请参阅[此答案](https://stackoverflow.com/questions/8420599/concurrent-queue-with-gcd-ios-4-2-1)。解决方案是改用低优先级，或者使用预处理器指令在两者之间切换。

# actionscript-3 - 如何在 Flash CS4 AS3 中从屏幕上删除所有一类孩子？

> ID：11182457
> 
> 赞同：3
> 
> 时间：2012-06-25T01:07:45.870
> 
> 标签：actionscript-3

好的，所以我已经坚持了大约三个小时了，我终于想寻求帮助。

基本上，当我的玩家飞船与其中一个接触时，我试图从屏幕上移除所有敌人对象实例，因为他随后失去了生命并被放回屏幕上的安全位置。

编辑：这是我的 Enemy Dude .as 文件中的所有代码，可能有点过火，但尽管如此。

```
package
{
    import flash.display.MovieClip;
    import flash.events.*;
    import flash.media.Sound;
    import flash.media.SoundChannel;
    public class Enemydude extends MovieClip
    {
        private var _root:Object;
        private var speed:int = 6;
        private var shipps = this
        public function Enemydude()
        {
            addEventListener(Event.ADDED, beginclass);
            addEventListener(Event.ENTER_FRAME, entFrame);
        }

        private function beginclass(event:Event):void
        {
            _root = MovieClip(root);
        }

        private function entFrame(event:Event):void
        {
            x -= speed;
            if(this.x < -64)
            {
                removeEventListener(Event.ENTER_FRAME, entFrame);
                _root.removeChild(this)
            }
            if(_root.gameover)
            {
                x = -700
                removeEventListener(Event.ENTER_FRAME, entFrame);
                removeEventListener(Event.ADDED, beginclass);
            }
            for (var i:int = 0; i<_root.playerBulletContainer.numChildren; i++)
            {
                var bulletTarget:MovieClip = _root.playerBulletContainer.getChildAt(i)
                if (hitTestObject(bulletTarget))
                {
                    removeEventListener(Event.ENTER_FRAME, entFrame);
                    _root.removeChild(this);
                    _root.playerBulletContainer.removeChild(bulletTarget);
                    bulletTarget.removeListeners();
                    _root.Score += 10
                    makeExplosion();
                }
            }
            if(hitTestObject(_root.mcship))
            {
                makeExplosion();
                shipPos();
                removethis();
            }

        }
        private function makeExplosion() 
        {
            var sndExplode:snd_explosion1;
            var sndExplodeChannel:SoundChannel;
            sndExplode=new snd_explosion1();
            sndExplodeChannel=sndExplode.play();
            var newExplosion01:explosionEffect=new explosionEffect  ;
            newExplosion01.x=this.x;
            newExplosion01.y=this.y;
            _root.explosionContainer.addChild(newExplosion01);

        }
        private function shipPos()
        {
            _root.lives -= 1;
            _root.mcship.x = 80;
            _root.mcship.y = 225;
            for each(var i:Enemydude in _root.enemies)
        {
            removethis();
        }

        _root.enemies.length = 0;
        }
        public function removethis():void
        {
            if(parent) parent.removeChild(this)
            removeEventListener(Event.ENTER_FRAME, entFrame);
        }
    }
} 
```

编辑：这是我现在拥有的与我的主要时间线中的 Enemydude 相关的代码，对这一切感到非常抱歉。

```
var enemies:Array = [];
var Shipheight:Number = 300;
var Enemytime:int = 0;
var Enemylimit:int = 16;

    if (Enemytime<Enemylimit)
        {
            Enemytime ++;
        }
        else
        {
            var newEnemy01 = new Enemydude();
            newEnemy01.y = Shipheight;
            newEnemy01.x = stage.stageWidth + 64;
            addChild(newEnemy01);
            enemies.push(newEnemy01);
            Enemytime = 0

function shipY(event:Event):void
{
    Shipheight = Math.ceil(Math.random()* 250) + 80;
} 
```

提前感谢您的帮助，感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:19:47.060

我建议将你的敌人存储在一个数组中。

例如，创建数组`enemies`：

```
var enemies:Array = []; 
```

然后将您的代码修改为：

```
else
{
    var newEnemy01 = new Enemydude();

    newEnemy01.y = Shipheight;
    newEnemy01.x = stage.stageWidth + 64;

    addChild(newEnemy01); 
    enemies.push(newEnemy01);

    Enemytime = 0;
} 
```

这样你就可以使用这个新数组移除所有敌人：

```
for each(var i:Enemydude in enemies)
{
    i.remove(); // Or whatever function Enemydude has to remove itself.
}

// Empty the enemies Array.
enemies.length = 0; 
```

* * *

这是`.remove()`您可以使用的方法`Enemydude`：

```
public function remove():void
{
    if(parent) parent.removeChild(this);

    // Remove any event listeners etc from this object.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T01:55:54.347

一种常见且简单的方法是创建一个子容器来保存对象并销毁该对象。它也使一些碰撞检查变得容易，因为您可以使用持有者对象对玩家进行一次检查。

如果您不想创建它，您可以使用数组或向量来存储对此对象的引用，这样可以轻松遍历列表。

我个人推荐[矢量](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Vector.html)aprouch：

```
var enemyList:Vector.<Enemy> = new Vector.<Enemy>(); 
```

然后你可以像一个数组一样循环（正如 Marty Wallace 在他的回答中所展示的那样）：

```
for each(var e:Enemy in enemyList) {
    container.removeChild(e);
}
enemyList.length = 0; // empty vector 
```

向量比普通数组慢一点，但类型安全。在大多数情况下，性能差异几乎可以忽略不计。

# java - 当我调用 repaint() 时 JFrame 没有更新

> ID：11182462
> 
> 赞同：2
> 
> 时间：2012-06-25T01:08:41.513
> 
> 标签：java, swing, jframe, jlabel, repaint

我有一个我正在尝试制作的国际象棋游戏，我正在尝试`repaint()`在游戏循环中调用我的一个 JFrame 上的方法。这个特殊的 JFrame 显示了每个玩家的总击杀数。我很确定`repaint()`实际上是在调用它，但由于某种原因，它似乎没有正确更新我的 JLabels，它应该保存每个玩家的击杀数。

这是我的自定义 JFrame 扩展类的代码，其中包含代表杀戮的 JLabel。

```
private ChessGame game;
private JPanel killsPanel;
private String p1kills;
private String p2kills;
private JLabel kills;
private JLabel p1, p2;
private JLabel p1NumKills = new JLabel();
private JLabel p2NumKills = new JLabel();

//the player's kill values are increasing and registering, just not within the jlabels representing them
public KillsFrame(ChessGame game){
    this.game = game;
    killsPanel = new JPanel(new MigLayout("", "[center][right][left][c]", "[top][center][b]"));
    kills = new JLabel("KILLS");
    p1 = new JLabel(game.getCurrentPlayer().getName() + " - ");
    p2 = new JLabel(game.getOtherPlayer().getName() + " - ");

    //this is the part that should be working but isn't.
    //p1kills and p2kills aren't being updated or something.
    p1kills = "" + game.getCurrentPlayer().getKills();
    p2kills = "" + game.getOtherPlayer().getKills();
    p1NumKills.setText(p1kills);
    p1NumKills.setText(p2kills);

    killsPanel.add(kills, "span");
    killsPanel.add(p1);
    killsPanel.add(p1NumKills, "wrap");
    killsPanel.add(p2);
    killsPanel.add(p2NumKills, "wrap");

    killsPanel.setBackground(Color.lightGray);
    add(killsPanel);
    pack();
    setTitle("Scoreboard");
    setDefaultCloseOperation(DISPOSE_ON_CLOSE);
    setResizable(true);
    setVisible(true);
    setLocationRelativeTo(null);
} 
```

然后我只是在不同类的 main 方法中调用这个框架的 repaint() ：

```
public static void main(String[] args) throws InterruptedException {

    JFrame gameFrame = new ChessMain();
    gameFrame.setDefaultCloseOperation(DISPOSE_ON_CLOSE);
    gameFrame.pack();
    gameFrame.setResizable(true);
    gameFrame.setLocationRelativeTo(null);
    gameFrame.setVisible(true); 
    gameFrame.setTitle("Chess X");

    LoginFrame loginFrame = new LoginFrame(((ChessMain) gameFrame).getGame());

    System.out.println(((ChessMain) gameFrame).getGame().toString());
    System.out.println(((ChessMain) gameFrame).getGame().currentPlayer.getName()+ ", it's your turn.");

    //this is what creates the kills frame.
    KillsFrame kf = new KillsFrame(((ChessMain) gameFrame).getGame());

    while(true){

        ((ChessMain) gameFrame).getGame().run();
        kf.repaint();//*************************************
        Thread.sleep(1);

    }

} 
```

非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T08:23:26.510

当您尝试“睡眠”您的主线程时，您的错误就出现了。如果不使您的 GUI 无响应，这势必会导致错误。您最好的选择是使用 swing.Timer 类（此处为教程[http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)）。定期触发事件以重新绘制（）。这将产生流畅的动画。

如果由于某种原因您**必须**在 Swing 程序中休眠一个线程，请使用 SwingWorker 类创建一个新线程（**而不是其他**）。见[http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html#process(java.util.List](http://docs.oracle.com/javase/7/docs/api/javax/swing/SwingWorker.html#process(java.util.List) )

# mysql - 此查询未按我想要的方式排序结果

> ID：11182466
> 
> 赞同：2
> 
> 时间：2012-06-25T01:09:22.463
> 
> 标签：mysql

```
SELECT DISTINCT u.first, u.last FROM users u, user_friends f 
WHERE f.userId = 1 AND u.id = f.friendId 
ORDER BY u.first ASC, u.last ASC 
```

本质上，我要做的是获取当前用户（在本例中其 id 为 1）的所有用户的列表，按名字和姓氏的升序排列。

所以 Alice Anna 会显示在 Alice Zanna 的上方。

然而，现在只订购了第一个名字，即 Alice Anna 和 Alice Zanna 都显示在 Bob Anna 上方，但如果 Alice Zanna 被添加到她之前的数据库中，则 Alice Zanna 将显示在 Alice Anna 上方。

关于如何正确排序名字和姓氏的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:11:57.817

如何对连接的[名字](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat)和姓氏进行排序：

```
SELECT DISTINCT u.first, u.last FROM users u, user_friends f 
WHERE f.userId = 1 AND u.id = f.friendId 
ORDER BY CONCAT(u.first, u.last) ASC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T01:11:31.343

按连接值排序，例如

```
Order by u.First + ' ' + u.Last Asc 
```

# image-processing - 边缘检测后的形状识别

> ID：11182472
> 
> 赞同：6
> 
> 时间：2012-06-25T01:11:04.870
> 
> 标签：image-processing, opencv, computer-vision

我正在做我的第一个计算机视觉项目，我在其中拍摄图表并检测其上的符号。有 5 种不同的形状需要检测。

这是我的边缘检测算法的结果：http: [//i.imgur.com/mh9Ol.jpg](http://i.imgur.com/mh9Ol.jpg)。5 个符号是一个点、4 个点组合在一起、一个矩形和 2 个形状奇特的符号。

在这一点上，我不确定我应该看哪些算法才能让我挑选出这些形状并将它们彼此区分开来。任何想法都会非常有帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:13:07.987

对于这类问题，[Shape Context](http://en.wikipedia.org/wiki/Shape_context)似乎是一个自然的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:40:01.147

几年前，我尝试使用 OpenCV 进行模板匹配，[这里有描述。](http://opencv.itseez.com/doc/tutorials/imgproc/histograms/template_matching/template_matching.html?highlight=template%20matching)

它工作得很好，我认为这就是你要找的；但是我记得它很慢，所以如果您正在编写实时应用程序，它可能不太适合。如果是这种情况，您可能不得不玩弄形状的几何形状，并尝试使用[线](http://opencv.itseez.com/modules/imgproc/doc/feature_detection.html?highlight=hough#CvSeq%2a%20cvHoughLines2%28CvArr%2a%20image,%20void%2a%20line_storage,%20int%20method,%20double%20rho,%20double%20theta,%20int%20threshold,%20double%20param1,%20double%20param2%29)和[圆的](http://opencv.itseez.com/modules/imgproc/doc/feature_detection.html?highlight=hough#CvSeq%2a%20cvHoughCircles%28CvArr%2a%20image,%20void%2a%20circle_storage,%20int%20method,%20double%20dp,%20double%20min_dist,%20double%20param1,%20double%20param2,%20int%20min_radius,%20int%20max_radius%29)[Hough 变换](http://en.wikipedia.org/wiki/Hough_transform)来找到它们，这两者都在 OpenCV 中实现。

玩得开心 ！

# python - 金字塔错误：AttributeError：未注册会话工厂

> ID：11182476
> 
> 赞同：3
> 
> 时间：2012-06-25T01:11:34.697
> 
> 标签：python, pyramid

我正在尝试学习 Pyramid 并且在让消息闪烁工作时遇到问题。我是全新的，但阅读了文档并完成了教程。

我完成了有关创建 wiki 的教程（此处为教程，[此处为](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/tutorials/wiki2/index.html)[代码](https://github.com/Pylons/pyramid/tree/1.3-branch/docs/tutorials/wiki2/src)）。它工作得很好而且非常简单，所以我决定尝试应用我在我做的待办事项列表教程中看到的 flash 消息（[教程在这里](http://docs.pylonsproject.org/projects/pyramid_tutorials/en/latest/single_file_tasks/single_file_tasks.html)，完整代码在页面底部的单个文件中）。基本上，当创建待办事项列表时，页面会刷新并显示一条消息“新任务已成功添加！”。每当有人在 wiki 教程中更新 wiki 文章时，我都想这样做。

所以我重新阅读了文档中的会话部分，它说我真的只需要这样做：

```
from pyramid.session import UnencryptedCookieSessionFactoryConfig
my_session_factory = UnencryptedCookieSessionFactoryConfig('itsaseekreet')
from pyramid.config import Configurator
config = Configurator(session_factory = my_session_factory) 
```

然后在我的代码中我需要添加：`request.session.flash('New wiki was successfully added!')`但我每次都会收到错误：金字塔错误：AttributeError：没有注册会话工厂

这是我的功能（除了 request.session.flash 部分外，它与教程完全相同）：

```
@view_config(route_name='edit_page', renderer='templates/edit.pt', permission='edit')
def edit_page(request):
    name = request.matchdict['pagename']
    page = DBSession.query(Page).filter_by(name=name).one()
    if 'form.submitted' in request.params:
        page.data = request.params['body']
        DBSession.add(page)
        request.session.flash('page was successfully edited!')
        return HTTPFound(location = request.route_url('view_page',
                                                      pagename=name))

    return dict(
        page=page,
        save_url = request.route_url('edit_page', pagename=name),
        logged_in=authenticated_userid(request),
        ) 
```

（注意：我认为我可能做错的一件事是在 todo 示例中，所有数据都在一个文件中，但在 wiki 示例中有几个文件。我在 view.py 文件中添加了会话导入，因为flash 消息是由视图本身生成的）。

我究竟做错了什么？有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T05:34:49.833

您提供的代码只是一个示例，当然您需要在正确的地方应用它。在 Pyramid 中，您应该（在简单的情况下；）在您的代码中只有 1 个位置创建 1 个`Configurator`实例，在教程中它位于 main 函数中。A`Configurator`自己不做任何事情，除了用`make_wsgi_app`.

因此，要在那里添加会话，修改`wiki2/src/views/tutorial/__init__.py`如下：

```
from pyramid.config import Configurator
from sqlalchemy import engine_from_config
from pyramid.session import UnencryptedCookieSessionFactoryConfig

from .models import DBSession

def main(global_config, **settings):
    """ This function returns a Pyramid WSGI application.
    """
    engine = engine_from_config(settings, 'sqlalchemy.')
    DBSession.configure(bind=engine)
    my_session_factory = UnencryptedCookieSessionFactoryConfig('itsaseekreet')
    config = Configurator(settings=settings, session_factory=my_session_factory)
    ... 
```

# javascript - 性能：CSS3 动画 vs. HTML5 Canvas

> ID：11182478
> 
> 赞同：18
> 
> 时间：2012-06-25T01:11:50.457
> 
> 标签：javascript, jquery, html, css, canvas

我正在开发一个当前使用 CSS3 转换构建的 web 应用程序（**仅**在 Chrome 19+ 中运行）。更具体地说，我使用[Jquery Transit](http://ricostacruz.com/jquery.transit/)通过 Jquery 本身来触发 CSS3 动画。这里的原因是一些动画被画了几秒钟，jquery *animate* 不够流畅，但 Transit 是一个很好的解决方案。Jquery Transit 运行良好，但我很好奇 HTML5 Canvas 是否会使事情变得更流畅？如果是这样，考虑到我目前正在为 DIV 使用 AJAX 和基于百分比的位置这一事实，是否值得追求？如果这里有人知道 CSS3 动画与 Chrome 中的 HTML5 Canvas 性能相比如何并且愿意提供他们的意见，我将不胜感激！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-25T03:30:02.890

CSS3 会给你带来更少的麻烦，并且你可以在未来轻松地对其进行更改，并且它可以在不支持画布的系统上正常工作。

如果您使用的是文本，那么您绝对应该坚持使用 CSS，如果您可以摆脱它的话。Canvas 破坏了您的应用程序的可访问性，并禁止用户使用克拉或突出显示文本或使用文本转语音。

如果您只是制作一个有趣的滑动按钮或其他东西，那么您也应该只使用 CSS，因为它可能更容易实现和维护。重做 CSS 比在（可能很复杂的）JavaScript 上苦苦挣扎更容易。

我不能诚实地告诉你画布渲染是否会更平滑。画布的一个优点是您可以将事物设置为看似更大的尺寸（同时保持画布尺寸相同），而无需重新布局 DOM。在大多数现代系统上，这确实不是问题。

此外，如果它*已经*用 CSS3 完成了，你真的有性能问题吗？如果还没有人抱怨过性能，为什么还要为画布重写它呢？如果到目前为止您还没有遇到任何真正的性能问题，为什么要重新发明您的应用程序？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T04:10:49.570

我认为画布可能会遇到的问题是它是基于位图的。因此，在页面初始呈现后放大和缩小将是一个问题。此外，换行可能会很痛苦。编写您网站内容的人可能会发现插入换行符具有挑战性，因为没有使用 canvas、svg 或 vml 的换行符之类的东西。事实上，您需要预先计算换行符。"\n" 使用 raphael.js 有效，但效果不佳。此外，如果您在 svg 图形中，则不能使用选择器来定位各个部分。你也许可以使用画布，也许……画布可能有很多相同的陷阱。

在图像前面，如果缩放图像，您将看到模糊的图像，并且处理画布图像大小调整的库较少。这在未来可能会改变，但仍将是一个考验。对于旧版浏览器，我会坚持使用带有 jquery 后备的 divs/css3。

从纯粹的性能角度来看，请查看对您问题的第一条评论。它有一些不错的基准。

# php - 使用 javascript 加载/显示图像并下载百分比

> ID：11182481
> 
> 赞同：2
> 
> 时间：2012-06-25T01:12:39.783
> 
> 标签：php, javascript, html

所以一些背景：我正在做的是创建一个画廊，动态显示服务器目录中所有图片的缩略图（它缓存缩略图，不用担心）。当用户单击缩略图时，会显示加载 gif，直到图像准备好，然后显示图像。实际图片尺寸非常大，可能需要相当长的时间才能下载到用户计算机。

我想做的是显示加载 gif 正在播放时下载的图片的百分比。

我意识到还有其他类似的问题，从我目前所做的研究来看，我也意识到如果没有一些服务器端技巧，这可能无法完成。

根据我在最后一点中遇到的情况，我收集到（我可能是错的，所以请纠正我）是客户端代码知道接收到多少字节，但不知道接收到多大文件是。

那么是否有可能使用一些 php/javascript 技巧进行配置，以便客户端 javascript 可以从 Web 服务器目录加载图像并能够计算下载百分比？

可能是 php 代码向客户端发送了一个带有文件大小或其他内容的额外标头？或者甚至向 Web 服务器打开第二个请求以获取文件大小？你怎么能得到当前下载的字节？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:26:45.763

您可以使用它[`XMLHttpRequest2`](http://caniuse.com/#feat=xhr2)来加载数据并挂钩到进度事件。加载的数据转换为 base64 并添加到数据 URI。加载完成后，您可以为构建的 URI 分配一个新的图像源。

更多信息可以在这里找到：http: [//blogs.adobe.com/webplatform/2012/01/13/html5-image-progress-events/](http://blogs.adobe.com/webplatform/2012/01/13/html5-image-progress-events/)

# ms-access - 主报告中的子报告 - 访问报告

> ID：11182489
> 
> 赞同：0
> 
> 时间：2012-06-25T01:13:34.667
> 
> 标签：ms-access, ms-access-2007, ms-access-2003

我有一个包含 4 个子报告/表格的访问报告。这些子报告中的每一个都旨在显示从特定病房入院、转入、转出和出院的患者。我有 4 个不同的查询来执行任务。当我单独运行查询时，它们工作正常。查询提示用户输入开始和结束日期并显示结果。

问题是当我将这些查询中的每一个附加到每个子报告并运行报告时，它会要求开始日期 4 次，这在逻辑上是正确的，因为它分别运行 4 个子报告。

我无法将所有内容合并到一个查询中，因为即使从 1 个表中提取数据，条件也不同。我还受限于创建表单和按钮以根据用户提供的开始日期提取报告，因为我需要直接运行报告。

**有什么方法可以通过仅输入一次日期来显示所有 4 个子报告的数据。**

我使用女士 Access 2003

任何帮助，将不胜感激。感谢和问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T04:14:27.847

在报告打开事件上，弹出一个输入框询问日期。使用该日期作为每个查询的参数。

没有时间对其进行测试，因此这个想法的一个可能障碍是打开事件是否在报告开始运行查询之后发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-26T17:22:18.180

如果您使用 Sub-rpt 向导，它会自动连接并且只需要一组触发器。我在 1 个主窗体上有 6 个 Sub-rpts，并且都使用一个数字来启动查询。我只输入数字 1x 并运行所有查询和报告。它将连接已创建的报告作为子 rpt。

# parameters - 高级参数中不提供画布高度

> ID：11182492
> 
> 赞同：0
> 
> 时间：2012-06-25T01:14:05.090
> 
> 标签：parameters, facebook-apps

我创建了一个新应用程序，并对参数进行了一些调整。现在我想更改画布的高度，但是当我转到“参数”>“高级”时，我没有找到与画布相关的任何内容。

如果我没记错的话，当我创建应用程序时它就在那里。会不会是我更改了一个参数，导致此更改现在不可用？

谢谢你的帮助！

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T08:39:12.133

您必须将您的应用程序设置为画布或页面选项卡应用程序（意思是为其中至少一个提供 URL），才能在高级选项卡上使用画布选项。

# jquery - JQuery：执行功能后隐藏 Div（奇怪的选择器）

> ID：11182493
> 
> 赞同：0
> 
> 时间：2012-06-25T01:14:29.687
> 
> 标签：jquery, css, selector

我有一段相当复杂的代码（JQuery 和 HTML5 Web SQL）从数据库中删除信息。但是，虽然数据库删除工作正常，但我想让信息同时从视图中消失（直到页面刷新并再次查询数据库时才会消失）。

我很确定这只是让选择器正确的问题

目前我有

```
$('.remove_event').live('click', function() {
    //TRIGGERS SQL REMOVE
    mbffdb.webdb.deleteevent($(this).attr('id')),
    //MAKES INFO DISSAPPEAR
    $(this).attr('id').addClass('displaynone');
});//END CLICK 
```

该信息包含在一个 div 中，该 div 具有一个动态 id ：（`$(this).attr('id')`该 ID 在 SQL 语句中用于删除）。

如果有人可以帮助我，那真是太棒了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:20:35.907

问题是，您将一个类...添加到一个字符串中。跟我来：

```
$(this) 
```

是一个元素

```
$(this).attr("id") 
```

是它的属性“id”的值，即一个字符串，所以你不能给它添加一个类。

顺便说一句，您要添加*id*还是*class*？目前还不清楚。如果要添加 id，请使用`.attr("id","mynewid")`. 如果要添加类，请使用`$(this).addClass("class")`

* * *

编辑：您可能被 JQuery 的可链接性误导了，即在 JQUery 元素或元素集上运行的许多函数返回另一个元素或元素集。

例如：

```
$("div.mydiv").parent().next().find("p").removeClass("otherclass");
              ^        ^      ^         ^ 
```

在每次调用 (^) 中，函数都会返回*其他*元素，因此您可以附加*另一个*函数来对这些元素进行操作，从而产生更多元素等等。但对于某些功能来说，情况并非如此：

```
.val() .text() .html() 
```

它返回“纯”值，而不是元素，因此在它们之后使用`addClass()`仍然操作 con 元素的函数是没有意义的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T01:20:54.317

改成`$(this).attr('id').addClass('displaynone');`这个`$(this).addClass('displaynone');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T01:32:34.720

```
$('.remove_event').live('click', function() {
    // $(this) refers to the element that was clicked.
    // $(this).attr('id') will return the attribute "id" of the element

    // TRIGGERS SQL REMOVE
    // the line below will execute the "deleteevent" function
    // passing the attribute id of $(this) as a parameter.
    mbffdb.webdb.deleteevent($(this).attr('id')),

    // MAKES INFO DISSAPPEAR
    // the line below will not work because you're trying to add a class 
    // to a non-element. ($(this).attr('id') returns the attribute! 
    // you can't chain!)
    // $(this).attr('id').addClass('displaynone');

    // Instead you should use this line 
    // which will add a class "displaynone" to the element $(this)
    $(this).addClass('displaynone');
    // or you can also set 'style="display:none;"' by doing
    $(this).css('display', 'none');
});//END CLICK 
```

# git - 如何在已更改的旧提交上创建分支？

> ID：11182497
> 
> 赞同：1
> 
> 时间：2012-06-25T01:14:47.710
> 
> 标签：git

这就是我正在做的事情。我的主分支中有一个错误，我已经确定了一个旧的提交`git bisect`，它是最新的提交，它没有出现这个错误。

我已经检查了这个提交并进行了一些修复以消除编译器警告，所以我希望这些更改（与原始错误无关）最终被包含在内。

此时我想做的是在这里创建一个新分支，它将这个旧提交（最后一个非错误提交）作为父提交。

我怀疑答案是在这里提交，使用`-b branchname`. 那是对的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T01:21:19.553

没有`commit -b`。你应该`git checkout -b branchname`，然后`git commit`像往常一样。这将为您留下一个新分支，其中包含一个新提交，您之前签出的提交作为其父提交。

# javascript - 在 Javascript 中构建“任务完成”工作流

> ID：11182502
> 
> 赞同：1
> 
> 时间：2012-06-25T01:16:51.450
> 
> 标签：javascript, events, javascript-events

我有一个 XML 文件，它定义了必须如何完成任务。

基本上

每个任务输出（1）可视数据（2）下一个任务的参数（3）或可视数据和参数

现在，我的想法是，我将采用这个 XML，并为它生成 JS 代码，即（对于上面的示例）：

```
 task1(); 
```

```
 function task1() { ... task2(); task3(); } 
```

问题：如果例如 Task4 依赖于 Task2(); 我该怎么做？和任务3（）；

似乎我需要某种信号，表明任务 4 已准备好被调用。我可以在这里依赖 Javascript 中的一些事件 API 吗？

# php - Xampp localhost/phpmyadmin 错误

> ID：11182503
> 
> 赞同：0
> 
> 时间：2012-06-25T01:16:52.640
> 
> 标签：php

每次我尝试访问我的 localhost/phpmyadmin 时，它都会给我这个错误 ---> 错误 MySQL 说：

# 2002 - 服务器没有响应（或者本地 MySQL 服务器的套接字没有正确配置）

配置中定义的 controluser 连接失败。

拜托，我真的需要你的帮助，我一无所知。下面是我的 config.inc.php 文件非常感谢您的帮助！

```
<?php
/*
* This is needed for cookie based authentication to encrypt password in
* cookie
*/
$cfg['blowfish_secret'] = 'xampp'; 

/*
*Servers configuration
*/
$i = 0;

/*
* First server
*/
$i++;

/* Authentication type and info */
$cfg['Servers'][$i]['auth_type'] = 'config';
$cfg['Servers'][$i]['user'] = 'root';
$cfg['Servers'][$i]['password'] = '**********'; 
$cfg['Servers'][$i]['extension'] = 'mysql';
$cfg['Servers'][$i]['AllowNoPassword'] = false;

/* User for advanced features */
$cfg['Servers'][$i]['controluser'] = 'pma';
$cfg['Servers'][$i]['controlpass'] = '';

/* Advanced phpMyAdmin features */
$cfg['Servers'][$i]['pmadb'] = 'phpmyadmin';
$cfg['Servers'][$i]['bookmarktable'] = 'pma_bookmark';
$cfg['Servers'][$i]['relation'] = 'pma_relation';
$cfg['Servers'][$i]['table_info'] = 'pma_table_info';
$cfg['Servers'][$i]['table_coords'] = 'pma_table_coords';
$cfg['Servers'][$i]['pdf_pages'] = 'pma_pdf_pages';
$cfg['Servers'][$i]['column_info'] = 'pma_column_info';
$cfg['Servers'][$i]['history'] = 'pma_history';
$cfg['Servers'][$i]['designer_coords'] = 'pma_designer_coords';
$cfg['Servers'][$i]['tracking'] = 'pma_tracking';
$cfg['Servers'][$i]['userconfig'] = 'pma_userconfig';

/*
* End of servers configuration
*/

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:24:51.923

来自[Mysql 文档](http://dev.mysql.com/doc/refman/5.5/en/can-not-connect-to-server.html)：
错误 (2002) Can't connect to ... 通常意味着系统上没有运行 MySQL 服务器，或者您在尝试连接时使用了不正确的 Unix 套接字文件名或 TCP/IP 端口号连接到服务器。您还应该检查您正在使用的 TCP/IP 端口是否未被防火墙或端口阻止服务阻止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:20:32.900

在 linux 系统上，您应该将以下内容添加到您的 config.inc.php

```
$cfg['Servers'][$i]['socket'] = '/var/run/mysql/mysql.sock';
    or
$cfg['Servers'][$i]['connect_type'] = 'tcp'; 
```

在 Windows 系统上，

```
 $cfg['Servers'][$i]['socket'] = "c:/tmp/mysql.sock" 
```

相同的更改也必须反映在您的 xampp\mysql\bin\my.ini 文件中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T06:51:28.633

当我尝试打开 phpmyadmin 时，我也遇到了同样的错误，我从系统中删除了 mecafee，然后我重新启动了系统，从那时起它工作正常，可能是 mecafee（anit 病毒）是问题......希望它对你有用。 ..

# jquery - 高级jQuery | 滚动导航选择

> ID：11182505
> 
> 赞同：0
> 
> 时间：2012-06-25T01:17:38.607
> 
> 标签：jquery

当用户滚动到页面上的特定部分时，我需要帮助来选择 li 元素：

请参阅此处了解我的进度：http: [//jsfiddle.net/FvBqA/349/](http://jsfiddle.net/FvBqA/349/)

如果您单击“服务”链接，文本颜色应变为红色，就像您在页面的该部分一样，如果您单击“主页”或“联系人”，则再次相同。

我对 jquery 有一个想法，即您需要能够向 LI 添加和删除类，以便 css 可以拾取选定的类并按其进行渲染。

该功能可以在这里查看：http: [//demicreative.com/#capabilities](http://demicreative.com/#capabilities)

如果您向下滚动并查看工作部分，您会注意到导航项被选中 - 我追求相同的功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:41:35.537

尝试这个：

```
var header_height = $('#nav').outerHeight();
var sections = [];
$('#nav a').each(function(){    
    var section = $(this.hash).offset()
    sections.push({
        'link':$(this).parent(),
        'top' : $(this.hash).offset().top-header_height,
        'bottom' : $(this.hash).offset().top + $(this.hash).outerHeight() -header_height
    });
});

$('#nav a').click(function(e) {
    e.preventDefault();
    $('html,body').animate({
        scrollTop: $(this.hash).offset().top - header_height
    }, 500);
});

$(window).scroll(function(){   
    for(var i = 0; i < sections.length; i++)
        if($(window).scrollTop() >= sections[i].top &&
           $(window).scrollTop() <= sections[i].bottom){
            sections[i].link.addClass('selected')
                .siblings().removeClass('selected');
        }
});​ 
```

我将事件直接附加到`#nav`. 我将选定的类添加到父元素并从父元素的兄弟姐妹中删除它。我还将滚动偏移量减少了 70 px，导航的高度和它的填充。

**更新：**没有对任何特定部分的引用，只有部分，这意味着如果您扩展、添加新链接或部分，它仍然可以工作，而无需更新 JavaScript。

小提琴：http: [//jsfiddle.net/iambriansreed/5Ta8j/](http://jsfiddle.net/iambriansreed/5Ta8j/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:45:56.277

尝试这个：

```
$(".scroll").click(function(e){
    e.preventDefault();
    $('html,body').animate({scrollTop:$($(this).attr('href')).offset().top - $('#nav').outerHeight()}, 500);
   $('.scroll').removeClass('selected')  
   $(this).addClass('selected');
}); 
```

[http://jsfiddle.net/FvBqA/354/](http://jsfiddle.net/FvBqA/354/)

* * *

尝试这个：

```
$(".scroll").click(function(e){
    e.preventDefault();
    $('html,body').animate({scrollTop:$($(this).attr('href')).offset().top - $('#nav').outerHeight()}, 500);
   $('.scroll').removeClass('selected')  
   $(this).addClass('selected');
});

$(window).scroll(function(){
   var hdr = $('#header').offset().top - $('#nav').outerHeight();  
   var svc = $('#services').offset().top - $('#nav').outerHeight();
   var ctt = $('#contact').offset().top - $('#nav').outerHeight();

    if ($(window).scrollTop() >= svc) {
        $('.scroll').removeClass('selected')  
        $('a[href="#services"]').addClass('selected');  
    }    

    if ($(window).scrollTop() >= ctt) {
       $('.scroll').removeClass('selected')  
       $('a[href="#contact"]').addClass('selected');  
    }   

}) 
```

[http://jsfiddle.net/FvBqA/357/](http://jsfiddle.net/FvBqA/357/)

# marionette - 骨干木偶中的视图如何知道与之关联的模型是什么？

> ID：11182506
> 
> 赞同：0
> 
> 时间：2012-06-25T01:17:44.503
> 
> 标签：marionette

[https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.view.md](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.view.md)

在这个例子中：

```
<script id="my-template" type="text/html">
  I think that <%= showMessage() %>
</script> 

MyView = Backbone.Marionette.ItemView.extend({
  template: "#my-template",

  templateHelpers: {
    showMessage: function(){
      return this.name + " is the coolest!"
    }
  }

});

model = new Backbone.Model({name: "Backbone.Marionette"});
view = new MyView();
view.render(); //=> "I think that Backbone.Marionette is the coolest!"; 
```

我已经尝试分析此代码，并且根据我对 Backbone 的理解，您必须指定视图与哪个模型相关联。我尝试理解 Marionette 视图，但我不知道文档的哪一部分或在此示例中显示视图如何知道`this`指的是新创建的模型。或者这只是一个错字？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T12:45:58.617

该示例中有一个错误。它应该显示：

```
 model = new Backbone.Model({name: "Backbone.Marionette"});

view = new MyView({
  model: model
});

view.render(); //=> "I think that Backbone.Marionette is the coolest!"; 
```

我将更新文档以解决此问题

# jquery-mobile - jQuery Validation 不显示消息

> ID：11182511
> 
> 赞同：1
> 
> 时间：2012-06-25T01:18:11.777
> 
> 标签：jquery-mobile, jquery-validate

我正在为我的 jQuery 移动网站使用 jQuery Validation 插件。验证成功，但未显示错误消息。需要帮助找出问题所在。这是我的代码。

```
<script language="javascript" type="text/javascript" >
    $(document).ready(function () {
        $("#LoginForm").validate();
    });
</script>

<form id="LoginForm" class="validate" action="~/Home/Search" method="get">
<ul data-role="listview" data-inset="true">
    <li data-role="list-divider"><div class="center-wrapper">Secure Login</div></li>

     <li data-role="fieldcontain">
        <label for="FirmKey">FirmKey</label>
        <input type="text" id="FirmKey" name="FirmKey" class="required" />
    </li>

    <li data-role="fieldcontain">
        <label for="UserName">User Name</label>
        <input type="text" id="UserName" name="UserName" class="required" />
    </li>

    <li data-role="fieldcontain">
        <label for="Password">Password</label>
        <input type="password" id="Password" name="Password" class="required" />
    </li>

    <li data-role="fieldcontain">
        <input type="submit" id="submit" value="LOGIN" />
    </li>
</ul>
</form> 
```

CSS：

```
label.error {
    float: none; 
    color: red; 
    font-size: 16px;
    font-weight: normal;
    line-height: 1.4;
    margin-top: 0.5em;
    width: 100%;
    display: block;
    margin-left: 22%;
}

@media screen and (orientation: portrait){
    label.error { margin-left: 0; display: block; }
}
@media screen and (orientation: landscape){
    label.error { display: inline-block; margin-left: 22%; }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-14T15:53:37.547

如果您碰巧包含 jquery.validation.unobtrusive 脚本，它会在您有机会之前 .validate() 您的表单。您需要从表单中删除自动添加的验证对象，然后才能手动调用 .validate() 以使其正常运行......类似于

```
 $("#theForm").removeData("validator")
    $("#theForm").removeData("unobtrusiveValidation"); 
```

# c - C InternetGetConnectedState 循环

> ID：11182516
> 
> 赞同：0
> 
> 时间：2012-06-25T01:18:59.953
> 
> 标签：c, winapi, wininet

我想等到互联网来了，所以我用 InternetGetConnectedState 函数创建了一个循环。我在禁用互联网时启动了程序。然后我启用了互联网。但它仍然不存在。我该怎么办？

```
 LPWORD bur;
int abc;
    abc = InternetGetConnectedState(bur,0);
    while (abc==0){
    printf ("zzz");
    if (abc==1)
    break;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:21:14.273

尝试将调用置于循环中，abc 永远不会改变。

此外，您不应该将结果分配给 abc ....而且，它是一个 DWORD ...

```
DWORD abc = 0;
printf ("Waiting for an internet connection.");
 while ((abc & 0x40)){
    InternetGetConnectedState(&abc,0);
    printf (".");
} 
```

然后将其与 1 或 0 进行比较并不能真正告诉您任何信息，请查看它可以返回的标志：-

```
INTERNET_CONNECTION_CONFIGURED
0x40
Local system has a valid connection to the Internet, but it might or might not be currently connected.
INTERNET_CONNECTION_LAN
0x02
Local system uses a local area network to connect to the Internet.
INTERNET_CONNECTION_MODEM
0x01
Local system uses a modem to connect to the Internet.
INTERNET_CONNECTION_MODEM_BUSY
0x08
No longer used.
INTERNET_CONNECTION_OFFLINE
0x20
Local system is in offline mode.
INTERNET_CONNECTION_PROXY
0x04
Local system uses a proxy server to connect to the Internet.
INTERNET_RAS_INSTALLED
0x10
Local system has RAS instal 
```

# jquery - jQuery Validation - 用户输入更正的输入后错误消息不会消失

> ID：11182517
> 
> 赞同：1
> 
> 时间：2012-06-25T01:19:01.663
> 
> 标签：jquery

屏幕截图： [http](http://cangicodo.com/project/pic.png) ://cangicodo.com/project/pic.png ； [http://cangicodo.com/project/pic1.png](http://cangicodo.com/project/pic1.png)

HTML：

```
<form id="form1">
<input type="text" id="date" name="date" placeholder="YYYY-MM-DD">
.......
</form> 
```

脚本：

```
$( "#date" ).datepicker();
$( "#date" ).datepicker("option", "dateFormat", "yy-mm-dd" );

$("#form1").validate({ 
    rules: {
        date: {required: true,},
    },
    messages: {
        date: {required: " 'Date' can't be blank.",},               
    },
}) 
```

我正在使用最新版本的 jquery validate 插件。它适用于普通文本输入、单选、复选框等。除了验证 datePicker 文本输入和多选输入外，用户输入更正信息后错误消息不会消失。如果我再次选择文本框或选择列表，它们就会消失消息。我想让它像其他人一样消失。你能给我一些建议吗？

# c# - 键盘状态比较失败

> ID：11182518
> 
> 赞同：0
> 
> 时间：2012-06-25T01:19:16.510
> 
> 标签：c#, xna

我遇到了一个奇怪的问题，最明显的原因是我作为 XNA 游戏程序员的新身份，但这里有。我制作了一个 KeyboardManager 类，非常简单：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Content;
using Microsoft.Xna.Framework.Graphics;
using Microsoft.Xna.Framework.Input;

namespace CrazyCoders.XYZ.Framework
{
    public class Keyboard
    {

        public KeyboardState previousState = Microsoft.Xna.Framework.Input.Keyboard.GetState();
        public KeyboardState newState;

        public void begin()
        {
            //Get the new state
            KeyboardState newState = Microsoft.Xna.Framework.Input.Keyboard.GetState();
        }

        public Keys[] detectKeyDowns()
        {
            return newState.GetPressedKeys().Except(previousState.GetPressedKeys()).ToArray();
        }

        public Keys[] detectKeyUps()
        {
            return previousState.GetPressedKeys().Except(newState.GetPressedKeys()).ToArray();
        }

        public void end()
        {
            //Save the new state for the next pass
            previousState = newState;
        }

    }
} 
```

此类保存以前的键盘状态并在您调用 begin() 时采用新的键盘状态。然后使用 newState 和 previousState，detectKeyDowns 和 detectKeyUps 计算数组异常以返回最近真正按下或取消按下的内容。

问题是，事情不工作......

我试着自己添加

```
if (newState.IsKeyDown(Keys.I))
{
    Console.WriteLine(
} 
```

在 newState 获取开始并中断它之后，它工作正常，例如，我看到我的“I”键被按下。但是当我调用detectKeyDowns 时，我似乎可以正确地除外。

你们看到我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:41:42.160

在您的`begin()`方法中，您正在重新定义`newState`变量。从行的开头删除“KeyboardState”，一切都应该开始工作了。

# c# - C#调用调用Windows API函数的VB函数传递NULL

> ID：11182519
> 
> 赞同：1
> 
> 时间：2012-06-25T01:19:45.897
> 
> 标签：c#, windows, vb.net, winapi

我正在尝试使用一个库来连接 Windows 调度程序。 [http://www.emoreau.com/Entries/Articles/2004/08/Interfacing-the-Windows-Task-Scheduler.aspx](http://www.emoreau.com/Entries/Articles/2004/08/Interfacing-the-Windows-Task-Scheduler.aspx)

该库是用 VB.NET 编写的，我使用 C# 来调用它。

所以我的 c# 调用这个

**otask.SetAccountInfo(null,null)**

在 VB 中，这被定义为

**Public Sub SetAccountInfo(ByVal accountName As String, ByVal password As String) m_ITaskObj.SetAccountInformation(accountName, password) End Sub**

并且 vb 代码正在调用这样定义的函数

**Sub SetAccountInformation(<In, MarshalAs(LPWStr)> ByVal wszAccountName As String, <In, MarshalAs(LPWStr)> ByVal pwszPassword As String)**

所以我的问题是如何将 NULL 传递给函数，因为它失败如下，具有不同的值

**otask.SetAccountInfo(null,null)**

**vb 调用 m_ITaskObj.SetAccountInformation(accountName, password) 时值不在预期范围内**

编辑

这是我要调用的函数

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa381276%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa381276%28v=vs.85%29.aspx)

克里斯

# ruby-on-rails - 使用带有提交按钮的复选框更新数据库上的字段

> ID：11182526
> 
> 赞同：0
> 
> 时间：2012-06-25T01:21:05.167
> 
> 标签：ruby-on-rails, checkbox

我想用真假更新字段。但是，当它已经是假的或真的，并且我用它的反向更新它时，它不会填充更新的那个。它怎么可能和解决方案？

这是我在视图上的代码：

```
<div>
  <%= check_box_tag "group[group_type][]", {:class => "checkbox"} %><%= " show" %>
</div> 
```

这是我在控制器上的代码

```
def update
    params[:group][:group_type] ||= []

    respond_to do |format|
      if @group.update_attributes(params[:group])
        format.html { redirect_to admin_group_path(@group), :notice => 'Group updated' }
      else
        format.html { render :action => "edit"}
      end
    end
end 
```

当我选中复选框时，数据库填充为 false，当它未选中时，仍然为 false，当它没有给出任何内容时，尚未进行检查或未选中，它是 nil。以及如何根据数据库给它一个默认的选中或取消选中？

任何的想法？感谢您的帮助。

解决方案 ：

在视图中更改如下：

```
<%= f.check_box :group_type %> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T03:38:18.313

解决方案是

```
<%= f.check_box :group_type %> 
```

# c# - OnKeyDown 中字母的当前索引

> ID：11182533
> 
> 赞同：0
> 
> 时间：2012-06-25T01:23:30.173
> 
> 标签：c#, richedit, richedit-control

我正在尝试获取在 OnKeyDown 事件期间输入的字母的当前索引。

例如，如果我在 RichEdit 控件中有一个文本为“MOVS,21”

当我在事件“OnKeyDown”中将字符串更改为“MOV(S,21”时，我想知道“(”的索引。

有什么办法可以得到这个索引吗？感谢你的帮助。

问候， 巴兰辛尼亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:55:38.953

Richedit 在接收到 KeyDown 事件时的一般行为是将相应的 char 插入到当前 carret 位置。

您应该能够使用richedit 的 selectionStart 和 selectionEnd 属性来获得这个位置。

```
private void richTextBox1_KeyDown(object sender, KeyEventArgs e)
    {
        MessageBox.Show(richTextBox1.SelectionStart.ToString());
    } 
```

您需要处理一些边缘情况，例如，当按下的键是删除时。

# javascript - 在 javascript 中将逻辑操作数与对象一起使用

> ID：11182534
> 
> 赞同：0
> 
> 时间：2012-06-25T01:23:55.683
> 
> 标签：javascript

我遇到了将逻辑操作数`&&`与对象一起使用，但是想知道表达式是否仅在处理对象时才以下面的方式进行评估。

**代码示例**

```
var sampleObject = {
            size: 10, 
            shoe: {
                make: "nike",
                model: "air jordon"
            },
            color: "red"
            }

    console.log(sampleObject.size && sampleObject.shoe.model); 
```

出的`console.log(sampleObject.size && sampleObject.shoe.model);`回报`air jordon`。我的理解是，因为第一个条件 ie`sampleObject.size`评估为 true 而不是`falsely`返回 object 中包含的值`sampleObbject.shoe.model`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:27:01.387

Javascript`&&`运算符首先计算其左操作数。如果它是一个假值，它是整个表达式的值。如果它是一个真值，则计算正确的操作数，并返回它。

零、空字符串、未定义和假都是假值。您的 sampleObject.size 值为 10，这是一个真实值，因此计算正确的操作数并将其用作整个表达式的值。

请注意，这些都不取决于作为对象的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T01:27:46.170

和运算`||`符`&&`从左到右运行。在 的情况下`||`，返回第一个真值。对于`&&`，它是第一个假值。在这两种情况下，如果没有找到合适的返回值，则返回最后一个。

因此，在这种情况下，它为表达式返回了一个真实值这一事实意味着`sampleObject.size`和`sampleObject.show.model`都是真实值。

# c# - 使用 C# 检索存储为明文和密文的盐

> ID：11182535
> 
> 赞同：1
> 
> 时间：2012-06-25T01:24:12.640
> 
> 标签：c#, string, encryption, salt

我正在编写一个 C# 应用程序，旨在使用 Rijndeal（块大小 128，密钥大小 256，换句话说 AES256）加密文本文件。我使用用户提供的密码和随机盐来使用 PBKDF2 生成密钥。（IV也来源于password和salt）

我想将盐存储为密文前面的明文。换句话说，第 1 行将包含类似`>>>SALTGOESHERE`. 第 3 行及以后的行将存储密文。

我应该如何检索盐进行解密？

我对 C# 很陌生，这是我的第一个真正的应用程序，所以请原谅我的无知。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:54:55.843

`yourString.Substring(0, yourString.IndexOf(Environment.NewLine));`

如果“>>>”不只是占位符，则将 0 更改为 3

# css - 将各种图像居中到一个 div

> ID：11182537
> 
> 赞同：1
> 
> 时间：2012-06-25T01:24:19.377
> 
> 标签：css, image, html

我有一个 div，比如 200px x 200px。我正在制作所有不同尺寸的图像幻灯片。我希望图片都以 div 为中心，但只有 200 x 200 可见。因此，如果图片较大，则仅显示其中的一部分。

我怎么做？

谢谢库沙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:46:51.200

`overflow: hidden;`div 上的用户样式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T01:52:13.260

以下将使所有图像居中。大于 div 宽度和高度的图像将被裁剪。

在您的样式表中：

```
div {
    overflow: hidden;
    background: #fff center center no-repeat;
} 
```

在您的 HTML 中：

```
<div style="background-image: url('url_of_image.jpg')"></div> 
```

# c# - mvc3 c#streamreader文件未读取

> ID：11182539
> 
> 赞同：1
> 
> 时间：2012-06-25T01:24:59.193
> 
> 标签：c#, asp.net-mvc-3

我有一个文件，用户浏览并点击上传按钮，我将文件保存在服务器上，appdata/uploads 在应用程序目录中。然后我尝试使用流阅读器读取它，然后解析它。在我的本地开发环境中它工作正常，但是当我将它部署在服务器上时它根本不起作用。有什么建议么？？谢谢你

```
//Save LoadList File:
            DateTime uploadDate = DateTime.Now;
            string destinationPath = string.Format("{0}\\{1}\\{2}\\{3}\\", Server.MapPath("~/App_Data/uploads"), uploadDate.ToString("yyyy"), uploadDate.ToString("MMM"), uploadDate.ToString("dd"));
              if (!Directory.Exists(destinationPath))
                    Directory.CreateDirectory(destinationPath);

              string storedFileName = string.Format("{0}{1}.json", destinationPath, System.Guid.NewGuid());
                file.ElementAt(0).SaveAs(storedFileName);

           //FileImport is a static class
          var Pair = FileImport.CyclesCompleted(storedFileName);

           private static string LoadTextFromFile(string fileName)
                {
                    StreamReader streamReader = new StreamReader(fileName);
                    string text = streamReader.ReadToEnd();
                    streamReader.Close();
                    return text;
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T02:01:32.837

在服务器上保存文件通常会导致权限错误，因为大多数帐户无法写入服务器上的默认位置。您可以使用[Path.GetTempFileName](http://msdn.microsoft.com/en-us/library/system.io.path.gettempfilename.aspx)，但即使在这种情况下，某些帐户（即请求为“匿名用户”运行的帐户）也无权读取/写入该位置。

如果您只需要解析上传的文件，您可以将流复制到 MemoryStream 并在此内存流上创建 StreamReader。您可能可以直接使用 Stream 上传文件，但它不支持 seaking（可能会在您使用不查找的 StreamReader 时工作）。

# c# - 在c#asp Htmltablerow中将单元格添加到现有表中

> ID：11182540
> 
> 赞同：0
> 
> 时间：2012-06-25T01:25:15.980
> 
> 标签：c#, asp.net

无论如何我可以将列/单元格添加到我从网站上的不同页面拉出的行中

```
System.Web.UI.HtmlControls.HtmlTableRow 
```

另外，有没有办法改变我拉的行的宽度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T07:57:04.917

**创建行和单元格**

```
HtmlTableRow htmlRow = new HtmlTableRow();
HtmlTableCell htmlCell = new HtmlTableCell(); 
```

**将单元格添加到行**

```
htmlCell.InnerHtml  = "your data goes here";
htmlRow.Cells.Add(htmlCell); 
```

**在表格中添加行**

```
HtmlTable htmlTable = new HtmlTable();
htmlTable.Rows.Add(htmlRow); 
```

您可以使用此代码添加 CSS 样式

```
htmlCell.Attributes.Add("style", "width:50px;"); 
```

# matlab - 在结构中动态删除或添加字段

> ID：11182544
> 
> 赞同：2
> 
> 时间：2012-06-25T01:25:51.357
> 
> 标签：matlab, dynamic, structure, field

当文件具有不同的字段时，如何从文件中读取连续的结构，并为每个结构创建适当的字段（标题：值）？我是初学者。我认为这是关于在读取 i-th 结构时动态添加新字段并从 i-1 结构中动态删除字段，在读取结构 i 后仍然为空。但是我以前不知道所有字段的名称怎么能做到呢？为此，我在文档和论坛中都找不到示例。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:34:39.093

如果某些字段出现在每个对象中，请将它们放在您的数组具有实例的通用结构中。对于变量字段，在主结构中创建一个字段“变量”或其他内容，然后在该结构中动态分配字段名称和*值*。例如，您的结构可能是：

```
a.name = 'Name1';
a.value = 'Value1';
a.variable.price = 50;

b.name = 'Name2';
b.value = 'Value2';
b.variable.year = 1996;

data(1) = a; data(2) = b; 
```

其中每个对象都有字段“名称”和“价格”，对象`a`有价格字段但没有年份字段，对象`b`有年份字段但没有价格字段。

这适用于您要读取的数据类型。

# java - 蚂蚁组装的 .jar 找不到 LWJGL 本地人

> ID：11182551
> 
> 赞同：0
> 
> 时间：2012-06-25T01:27:05.783
> 
> 标签：java, ant, lwjgl

为了保持简短和甜蜜，我编写了一个 ant 文件来编译我的源代码，解压缩 slick2d、nifty 等的库，将其压缩到它自己的 jar 中，然后将 lwjgl 本机 dll 复制到同一个文件夹中，所以文件夹布局是这样的：

```
/bin/
 output.jar
 lwjgl.dll
 lwjgl64.dll 
```

但是由于某种原因，output.jar 给了我一个 UnsatisfiedLinkException 说它找不到本地人。关于我能做什么的任何想法？在将本地人打包到 .jar 文件中时，我也得到了相同的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T10:41:19.160

DLL 的路径不在搜索路径中。

这个问题非常接近[Java - Loading dlls by a relative path and hide them inside a jar](https://stackoverflow.com/questions/4691095/java-loading-dlls-by-a-relative-path-and-hide-them-inside-a-jar) if not a direct duplicate。

方法是将 DLL 作为资源嵌入 jar 中，将 DLL 提取到某处，然后加载它。（[JNA](https://github.com/twall/jna)这样做）

# codeigniter - Sha1 或密码加密

> ID：11182553
> 
> 赞同：0
> 
> 时间：2012-06-25T01:27:45.897
> 
> 标签：codeigniter, encryption, hash, passwords, sha1

什么更安全？

我可以使用任何一个，因为我正在使用 CodeIgniter，但是对于 Sha1，如果我出于某种奇怪的原因需要像加密一样使用它，我就无法反转。

但是我对 PHP 还是有点陌生​​，所以如果有办法我可以做一些事情，比如将 sha1 哈希密码显示为星号，所以如果说你的密码是“lala123”，它会向我显示：“ `*******`”并且永远不会曾经能够显示“lala123”，是否可以使用 sha1 做到这一点？如果是这样，请帮助我，否则我将使用加密，但前提是它可以安全地用于密码。请告诉我 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:43:57.003

两者都不。您应该使用散列来保证密码的安全，以防有人获得密码数据库。但一致的答案似乎是使用 bcrypt，在[这个答案](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)中描述。它是一个基于河豚的哈希函数，具有可变成本，因此您可以调整安全性与性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T01:34:54.040

散列被认为更安全，因为即使您也无法恢复密码。如果您的密码数据库被泄露，并且密码加密是可逆的，那么坏人可能会解密它们，尤其是在进行解密的代码也被泄露的情况下。SHA1 在设计上是不可逆的。

您不应该在 UI 中显示密码 - 永远。*****就是这样 - 任意数量的星星。披露用户密码的*长度*本身就对可能的猜测者构成了相当大的提示。

# python - 在python中查找单词的所有组合（大小写和符号）

> ID：11182558
> 
> 赞同：0
> 
> 时间：2012-06-25T01:29:09.017
> 
> 标签：python, iteration, combinations

我希望现在是星期一——现在开始了，但我觉得*应该*很容易——或者至少是优雅的——让我大吃一惊。用例是这样的：

查找特定单词的所有可能组合，其中字母可以是任意大小写或替换为字母。例如：

单词：'Password' 组合：'PASSWORD'、'P@ssw0rd'、'p@55w0rD' ...

我不想写 7 个循环来找出这个问题，即使这是一个我们永远不会再使用的一次性脚本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T01:32:41.260

```
import itertools

places = [
    "Pp",
    "Aa@",
    "Ss5",
    "Ss5",
    "Ww",
    "Oo0",
    "Rr",
    "Dd",
]

for letters in itertools.product(*places):
    print "".join(letters) 
```

如果您需要处理任意单词，则需要编写代码`places`从字符串创建列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T01:36:41.997

这个问题的主要问题是，并非所有字母都可以翻译成符号或数字。您必须创建一个字典，其中键是小写字母，值是该字母所有可能替换的列表：

{'a':['a','A','@'],...,'s':['s','S','5'],...,}

一旦你的字典建立起来，剩下的只是一个简单的笛卡尔乘积的不同列表以正确的顺序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-25T01:36:36.837

我会使用[`itertools.product`](http://docs.python.org/library/itertools.html#itertools.product)：

```
import itertools
symbols = dict(a="@", s="5", o="0")  # char -> str
text = "password"
print list(itertools.product(*[[letter, letter.upper()] + list(symbols.get(letter, "")) for letter in text.lower()]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T05:30:09.753

[itertools.product](http://docs.python.org/library/itertools.html#itertools.product)是您要搜索的内容：

```
#!/usr/bin/python
# -*- coding: utf-8 -*-

from itertools import product

def getAllCombinations(password):
    leet = ["Aa@","Bb","Cc", "Dd","Ee","Ff","Gg","Hh","Ii","Jj","Kk",
            "Ll","Mm","Nn","Oo0","Pp","Qq","Rr","Ss5","Tt","Uu","Vv",
            "Ww","Xx","Yy","Zz"]

    getPlaces = lambda password: [leet[ord(el.upper()) - 65] for el in password]

    for letters in product(*getPlaces(password)):
        yield "".join(letters)

for el in getAllCombinations("Password"):
    print el 
```

如果您对[星号 *](http://en.wikipedia.org/wiki/Asterisk)的含义感到好奇，请查看：[python 中星号上的模糊](https://stackoverflow.com/questions/5239856/foggy-on-asterisk-in-python)

# html - text-align 不适用于 safari 我尝试将 <select>元素中的文本对齐到 Safari 中的右侧或中心。但没有任何效果。文本对齐：居中；在除 safari 之外的所有浏览器中工作。方向：rtl；并且 dir="rtl" 没有做任何事情。该列表在 Safari 中始终与左侧对齐。-webkit 外观：无；也无济于事。请我需要一个解决方案。摘要链接 Web 部件间距 我在 SP2010 页面中使用摘要链接 Web 部件。但是，我想编辑它在每个列表项之前放置的空格 ID：11182559 赞同：22 时间：2012-06-25T01:29:14.030 标签：html, css, mobile-safari, center, text-alignment 回答 #1 赞同：2 时间：2018-02-27T17:31:24.587 是 safari 中的一个错误。 错误 40216 - text-align 不适用于选择标签 https://bugs.webkit.org/show_bug.cgi?id=40216 2010 年提交 回答 #2 赞同：1 时间：2012-06-25T01:31:29.213 对于 Safari text-align: -webkit-center; 然而，分析 HTML/CSS 工作的最佳方法是 Safari 中的 Web-Inspector。 更多>> 回答 #3 赞同：1 时间：2016-03-25T13:37:03.543 如果您没有找到任何解决方案，您可以在 angularjs 上使用此技巧或使用 js 将所选值与 div 上的文本映射，此解决方案在 angular 上完全符合 css，但需要在 select 和 div 之间进行映射： var myApp = angular.module('myApp', []); myApp.controller('selectCtrl', ['$scope', function($scope) { $scope.value = ''; }]); .ghostSelect { opacity: 0.1; /* Should be 0 to avoid the select visibility but not visibility:hidden*/ display: block; width: 200px; position: absolute; } .select { border: 1px solid black; height: 20px; width: 200px; text-align: center; border-radius: 5px; display: block; } <!doctype html> <html lang="en"> <head> <meta charset="UTF-8"> <title>Example - example-guide-concepts-1-production</title> <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script> </head> <body ng-app="myApp"> <div ng-app ng-controller="selectCtrl"> <div class=select> <select ng-model="value" class="ghostSelect"> <option value="Option 1">Option 1</option> <option value="Option 2">Option 2</option> <option value="Option 3">Option 3</option> </select> <div>{{value}} </div> </div> </div> </body> 希望这对某人有用，因为我花了一天时间在 phonegap 上找到这个解决方案。 回答 #4 赞同：1 时间：2020-04-15T10:27:13.027 我遇到了一个非常相似的问题。<select>我的问题是根据text-align样式对齐元素内的文本。这是正确处理media基于样式所必需的。 在 Chrome 中我使用的是text-align-last样式，但是在 Safari 中不支持这种样式（根据MDN）。 这就是为什么我想出了以下 JavaScript 函数（使用text-indent）left和right文本对齐（不是center作为 OP 问题，但在我的辩护中，我认为可以修改此代码以正确计算text-indent居中）： function SELECT_applyTextAlign(element) { let styles = document.defaultView.getComputedStyle(element, ""); if ( styles.textAlign == 'left' || (styles.direction === 'ltr' && styles.textAlign === 'start')) { // Left alignment doesn't require any kind of calculations. element.style.textIndent = 0; return; } if ( styles.textAlign == 'right' || (styles.direction === 'ltr' && styles.textAlign === 'end')) { // Right alignment requires a proper width calculations. let option = element.querySelector('option[value=\'' + element.value + '\']'); if (!option) { return; } // Get original element width let width = element.getBoundingClientRect().width; // Create temporary <select> and <option> elements let sz_select = document.createElement('select'); let sz_option = document.createElement('option'); // This should ensure both <select> have the same styles and <option> have the same text sz_select.style.cssText = styles.cssText; sz_select.style.width = 'auto'; sz_select.value = option.value; sz_option.value = option.value; sz_option.text = option.text; // Append <option> sz_select.appendChild(sz_option); // Append <select> element.parentNode.insertBefore(sz_select, element.nextSibling); // Copy calculated width let sz_width = sz_select.getBoundingClientRect().width; element.style.textIndent = (width - sz_width) + 'px' // Remove unnecessary element sz_select.remove(); } } 然后我附加load了resize事件处理程序，以确保<select>在加载页面和更改窗口大小时处理所有元素： window.addEventListener('load', function() { let selects = document.getElementsByTagName('select'); Array.prototype.filter.call(selects, function(element) { SELECT_applyTextAlign(element); element.addEventListener('change', function () { SELECT_applyTextAlign(element); }, false); }); }, false); window.addEventListener('resize', function () { let selects = document.getElementsByTagName('select'); Array.prototype.filter.call(selects, function(element) { SELECT_applyTextAlign(element); }); }, false); 希望这可以帮助某人（在 chrome、iOS 和 safari 中测试） 回答 #5 赞同：0 时间：2012-06-25T01:40:22.050 正如我在上面的评论中所说，我知道这实际上不是一个 css 解决方案，但如果它对你很重要，如果你愿意使用 jquery，这可以作为一种解决方法......它不能在 chrome 中正确工作，但如果您检查浏览器，您可以将其加载到 safari： http://jsfiddle.net/nEGV4/4/ 回答 #6 赞同：0 时间：2021-08-31T08:56:53.410 对我text-align: -weblit-center来说，不在移动 Safari 上工作。我找到了这个解决方案text-indent: 5px hanging;（根据您的情况更改 5px）。此属性仅适用于 safari。 回答 #7 赞同：0 时间：2021-09-27T08:25:00.883 Vanilla js 方法是使用普通输入来显示隐藏选择框的选定文本，然后您可以将输入设置为您想要的样式，使其看起来像一个选择框。 const inputs = document.getElementsByClassName('js-fake-input'); const selects = document.getElementsByClassName('js-select'); for (let i = 0; i < inputs.length; i++) { getSelected(i); selects[i].addEventListener("change", function() { getSelected(i); }); } function getSelected(index){ inputs[index].value = selects[index].options[selects[index].selectedIndex].text; } .select-holder{ position: relative; width:200px; margin-bottom: 10px; } .select-holder select{ position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0 ; } .select-holder input{ text-align: center; width:100% } <div class="select-holder"> <select class="js-select"> <option> Option 1 </option> <option> Option 2 </option> </select> <input type="text" class="js-fake-input"> </div> <div class="select-holder"> <select class="js-select"> <option> Option 1 </option> <option selected> Option 2 </option> </select> <input type="text" class="js-fake-input"> </div> <div class="select-holder"> <select class="js-select"> <option> Option 1 </option> <option> Option 2 </option> </select> <input type="text" class="js-fake-input"> </div> 回答 #8 赞同：-3 时间：2013-03-24T09:58:52.933 这对我有用。 select { text-align:-moz-center; text-align:-webkit-center; }</select>

# sharepoint-2010 - 摘要链接 Web 部件间距

> ID：11182560
> 
> 赞同：0
> 
> 时间：2012-06-25T01:29:32.347
> 
> 标签：sharepoint-2010, web-parts, hyperlink, summary

我在我们的 SP2010 页面中使用摘要链接 Web 部件。但是，我想编辑它在每个列表项之前放置的空格：

![摘要链接 Web 部件](../Images/c92caf18f2df9a568d187f5ff5a05550.png)

当我查看源代码时，我看到 UL 标记正在使用这个类：dfwp-list。我尝试通过自定义 CSS 代码对其进行修改：

![自定义 CSS 代码](../Images/3c7a281bcefd7f5a352a4fbca88d430d.png)

但这并没有达到预期的效果:(您知道我可以通过什么方式获得预期的效果吗？

**更新：**

这是我在开发者工具中看到的：

![开发者工具](../Images/8c90a9532d43fa496056808891e0c439.png)

# android - 如何改进这个自定义的 Android 小部件

> ID：11182561
> 
> 赞同：0
> 
> 时间：2012-06-25T01:29:50.293
> 
> 标签：android, layout

我有一个与此类似的 XML 布局（XML 和代码要复杂得多，但为简洁起见，我已经简化了）：

```
<merge xmlns:android="http://schemas.android.com/apk/res/android" >
    <TableLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
        <TableRow
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >
            <ImageButton
                android:id="@+id/button01"
                android:src="@drawable/key_01" />
            <ImageButton
                android:id="@+id/button02"
                android:src="@drawable/key_02" />
            <ImageButton
                android:id="@+id/button03"
                android:src="@drawable/key_03" />
        </TableRow>
    </TableLayout>
</merge> 
```

我将此布局作为自定义小部件。

```
public class ThreeButtons extends LinearLayout
{

    public ThreeButtons(Context context, AttributeSet attrs)
    {
        super(context, attrs);
        final LayoutInflater inflator = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        inflator.inflate(R.layout.three_buttons, this);

        if (!isInEditMode())
            setClickListeners();
    }

    ...

    private void setClickListeners()
    {
        ...
    }
} 
```

问题是我有一个我认为不应该存在的额外深度。即：实际的 ThreeButtons 类是一个 LinearLayout，它只有一个子元素，即膨胀的 XML。

我原以为直接从 XML 创建小部件而不是将其作为子项附加会更有意义。我这样做的方式是拥有自定义小部件的唯一方法吗？还是有更清洁的方法？

谢谢，

布拉德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:07:18.873

您可以让小部件扩展 TableLayout，而不是扩展 LinearLayout。

然后，在您的 Merge 标记中，只需包含您希望将其添加到小部件中的行列表。

这消除了额外的线性布局。

例子：

```
<merge ... >
    <TableRow ... />
    <TableRow ... />
    <TableRow ... />
    <TableRow ... />
</merge> 
```

# photo-gallery - 宝丽来照片画廊效果与背景图像/css

> ID：11182563
> 
> 赞同：0
> 
> 时间：2012-06-25T00:51:25.877
> 
> 标签：photo-gallery

我在同一页面上显示照片和相册，并希望为相册创建“宝丽来”样式效果，请参阅![例子](../Images/7dc4a0af8ca24922b61cb76f7ab00cad.png)。

我正在寻找背景图形或一些 css 来做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:39:52.913

你可以查看这个网站：

[http://tympanus.net/Tutorials/PolaroidPhotobarGallery/](http://tympanus.net/Tutorials/PolaroidPhotobarGallery/)

我认为最好搜索 jQuery 版本，因为当你谷歌它时有很多教程。

# iphone - 具有多个参数的 NSURLRequest

> ID：11182564
> 
> 赞同：0
> 
> 时间：2012-06-25T01:30:58.883
> 
> 标签：iphone, ios, nsurlrequest

我正在尝试设置一个 NSURLRequest 来下载一个简单的 index.html 及其外部 style.css 表，但我不太确定如何执行此操作。我只是将请求的 URL 格式化为我想要的文件..但这必须略有不同，我找不到一个很好的例子来说明我正在尝试做的事情。

到目前为止，这是我的代码：

```
#pragma mark - NSURLConnection methods

- (void)htmlRequest
{
    // Create the request.
    NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.mywebsite.com/index.html"]
                                              cachePolicy:NSURLRequestReloadIgnoringCacheData
                                          timeoutInterval:60.0];

    // create the connection with the request
    // and start loading the data
    NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if (theConnection) {
        // Create the NSMutableData to hold the received data.
        // receivedData is an instance variable declared elsewhere.
        receivedData = [NSMutableData data];
    } else {
        // Inform the user that the connection failed.
        NSLog(@"Connection Fail");
    }
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    // This method is called when the server has determined that it
    // has enough information to create the NSURLResponse.

    // It can be called multiple times, for example in the case of a
    // redirect, so each time we reset the data.

    // receivedData is an instance variable declared elsewhere.
    [receivedData setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{

    // Append the new data to receivedData.
    // receivedData is an instance variable declared elsewhere.
    [receivedData appendData:data];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    // inform the developer of error type

}

// This method uses methodName to determin which Initalizer method to send the response data to in EngineResponses.m
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
//    EngineResponses *engineResponses = [EngineResponses sharedManager];

//        [engineResponses GetManufacturers:receivedData];

    NSString *myString = [[NSString alloc] initWithData:receivedData encoding:NSUTF8StringEncoding];
    NSLog(@"%@", myString);

} 
```

如您所见，我只是直接调用 index.html .. 我想知道如何格式化我的请求，所以我得到了 index.html 和 style.css

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:43:04.737

一种或另一种方式，您将不得不提出 2 个请求。即使您直接在网络浏览器中打开网页，浏览器也会对其下载的 HTML 中引用的 CSS 文件发出单独的请求。如果您的应用程序需要 HTML 和 CSS 文件，那么您希望它发出 2 个单独的 URL 请求，首先获取 HTML，然后获取 CSS 文件。

现在，仅仅因为需要发出 2 个请求，这并不意味着您总是需要编写发出这 2 个请求的代码。@Slee 推荐的库可能会自动获取第一个请求的结果，将它们解析出来，并对任何引用的 CSS 文件发出请求。我没有和他们合作过，所以我不确定他们支持什么，或者是否有任何图书馆会为你做这件事。

您可能要考虑的一件事是通过 UIWebView 加载 HTML 和 CSS，而不是手动处理。UIWebView 将尝试将 HTML 文件加载、解析和呈现到 UI 组件中。在此过程中，它将加载引用的 CSS 和 JavaScript 文件并将它们应用于其渲染。如果你想做一些特殊的事情，比如拦截它为加载 CSS 文件所做的调用，你可以实现`UIWebViewDelegate`协议并设置 UIWebView 的委托。在该委托中，您可以实现在`-webView:shouldStartLoadWithRequest:navigationType:`Web 视图加载 CSS 文件时收到通知的方法。您可以使用对该方法的调用来查看为 CSS 发出的请求，并对请求执行其他有趣的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T01:35:58.937

我总是创建一个新的数据结构，它有一个 -connection 属性和一个 -request 属性，就像这样

```
@interface connectionWrapper : NSObject
@property(retain) NSURLRequest *request
@property(retain) NSURLConnection *connection 
```

通过将此数据结构保留在可变数组中，您可以通过迭代数组来区分回调方法中的连接，并将每个 connectionWrapper 实例的 -connection 属性与`connection`回调方法的参数进行比较，如果它们匹配（指向同一个对象），然后您可以检索 connectionWrapper 实例的 -request 属性，然后检索 NSURLRequest 实例的 -url 属性。

由于我不是以英语为母语的人，我认为代码是一个更好的导师。

```
-(NSURLRequest*)getRequestByConnection:(NSURLConnection*)connection
{
    for(connectionWrapper *w in theArrayContainingAllConnectionWrappers)
    {
        if(w == connection)
            return w.request;
    }
} 
```

在回调方法中：

```
-(void)connection:(NSURLConnection*)connection didReceiveResponse(NSURLResponse*)response
{
    NSURLRequest *request = [self getRequestByConnection:connection];
    NSURL *url = [request url];
    /*apply different approach to different url/*
} 
```

PS：很遗憾 NSURLConnection 没有 -request 属性，以便我们可以轻松检索与连接关联的请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T01:36:20.297

你知道 .css 文件的名称吗？

如果是这样，我只会发出 2 个请求，否则您将不得不编写一个解析器来查找指向 css 的链接并发出第二个请求。

我还建议研究一个库来处理东西的下载 - 很多很棒的库可以通过高级功能为您完成繁重的工作。

这是我用过的3个：

[http://blog.mugunthkumar.com/coding/ios-tutorial-advanced-networking-with-mknetworkkit/](http://blog.mugunthkumar.com/coding/ios-tutorial-advanced-networking-with-mknetworkkit/)

[https://github.com/tonymillion/TMHTTPRequest](https://github.com/tonymillion/TMHTTPRequest)

[https://github.com/pokeb/asi-http-request](https://github.com/pokeb/asi-http-request)

# html - 努力摆脱模板上的黑匣子

> ID：11182565
> 
> 赞同：0
> 
> 时间：2012-06-25T00:58:34.060
> 
> 标签：html, css, joomla, templates

我对网页设计很陌生。我对服务器端了解更多。我正在制作一个网络摄像头网站；www.camtheplanet.com。我正在使用 Joomla 中的模板，一旦删除徽标，我无法弄清楚如何摆脱留下的黑框。您可以在上面的 URL 中看到我在说什么。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:26:22.497

如果您的意思是整个网站上的那个大黑框，就在您的导航栏下方。那是一张大图。确切地说，这是在这个文件中设置的`http://camtheplanet.biz.tm/welcome/templates/themza_j15_11/css/blue.css`

线`13`

ID`#page_bg: background: white url(../images/blue/bg_page.png) top repeat-x;`

如果您使用 Chrome 开发工具删除该图像，您会看到该图像非常大，并且还包括蓝色导航栏。

图像为 1x920 像素并重复。所以这是一个便宜又糟糕的设计，因为删除它意味着你必须重做模板中的一些 CSS 和 HTML，以保持你的导航栏背景（蓝色）并再次做主要的 bg 区域。

或更改`page_bg`为`page_bg_1`，您将没有黑色区域。我刚刚看到这个 ID，在您的蓝色导航下方只有一条细黑线

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:29:19.543

CSS

您将需要编辑背景图片

```
#page_bg {
    background-attachment: scroll;
    background-clip: border-box;
    background-color: #FFFFFF;
    background-image: url("../images/blue/bg_page.png");
    background-origin: padding-box;
    background-position: center top;
    background-repeat: repeat-x;
    background-size: auto auto;
} 
```

如果你删除`background-image: url("../images/blue/bg_page.png");`你会看到

# java - Jsoup Parse 的空指针异常

> ID：11182568
> 
> 赞同：0
> 
> 时间：2012-06-25T01:31:03.213
> 
> 标签：java, html, arrays, jsoup

所以我筛选了一些代码，无法解决这个空指针异常错误。

我正在尝试从源代码行 2290 到 3153 [http://pastebin.com/DjGHED5t解析表](http://pastebin.com/DjGHED5t)

但是，在我的一个 CSS 查询中，代码失败了，对我来说原因毫无意义。

```
public void updateCompanyIs()throws IOException{
    investoolsLogin();

    Document doc = Jsoup.connect("http://toolbox.investools.com/graphs/fundamentalAnalysis.iedu?report=BS&symbol="+(Ticker)).get();
    // Elements table = doc.select("table");
/**LINE 72**/ 
    Elements columns = doc.getElementById("fundamentalsForm").children().select("table").get(0).select("tr").get(0).select("td");
    Iterator<Element> columnIterator = columns.iterator();
    int col = 0;
    int row = 0;
        while (columnIterator.hasNext()) {
            Element column = columnIterator.next();
            Elements rows = column.select("table").get(0).select("tr");
            Iterator<Element> rowsIterator = rows.iterator();
            col = col + 1;
            while (rowsIterator.hasNext()){
                row = row + 1;
                //Element rowIterator.next = ;
                incomeStatementInfo[col][row] = rowsIterator.next();
            }
        }
    }

    public void updateCompanyBs()throws IOException{
        investoolsLogin();

        Document doc = Jsoup.connect("http://toolbox.investools.com/graphs/fundamentalAnalysis.iedu?report=BS&symbol="+(Ticker)).get();
        // Elements table = doc.select("table");
        Elements columns = doc.getElementById("fundamentalsForm").children().select("table").get(0).select("tr").get(0).select("td");
        Iterator<Element> columnIterator = columns.iterator();
        int col = 0;
        int row = 0;
        while (columnIterator.hasNext()) {
            Element column = columnIterator.next();
            Elements rows = column.select("table").get(0).select("tr");
            Iterator<Element> rowsIterator = rows.iterator();
            col = col + 1;
            while (rowsIterator.hasNext()){
                row = row + 1;
                //Element rowIterator.next = ;
                balanceSheetInfo[col][row] = rowsIterator.next();
            }
        }
    }   

    public void updateCompanyCf()throws IOException{
        investoolsLogin();

        Document doc = Jsoup.connect("http://toolbox.investools.com/graphs/fundamentalAnalysis.iedu?report=BS&symbol="+(Ticker)).get();
        // Elements table = doc.select("table");
        Elements columns = doc.getElementById("fundamentalsForm").children().select("table").get(0).select("tr").get(0).select("td");
        Iterator<Element> columnIterator = columns.iterator();
        int col = 0;
        int row = 0;
        while (columnIterator.hasNext()) {
            Element column = columnIterator.next();
            Elements rows = column.select("table").get(0).select("tr");
            Iterator<Element> rowsIterator = rows.iterator();
            col = col + 1;
            while (rowsIterator.hasNext()){
                row = row + 1;
                //Element rowIterator.next = ;
                cashFlowsInfo[col][row] = rowsIterator.next();
            }
        }
    }

    public void updateCompanyInfo(String Ticker) throws IOException {
    /** LINE 134**/ 
        updateCompanyIs();
        updateCompanyBs();
        updateCompanyCf();

    }
} 
```

这是错误：

```
Exception in thread "main" java.lang.NullPointerException
    at Company.updateCompanyIs(Company.java:72)
    at Company.updateCompanyInfo(Company.java:134)
    at Company.<init>(Company.java:41)
    at AppGUI.main(AppGUI.java:124) 
```

这是我的 AppGUI：

```
public static void main(String[] args) throws Exception{
    Company company = new Company("KO"); // Creates new Company. Updating methods are called from constructor automatically.
    AppGUI frame = new AppGUI(company); // Creates new App GUI.  Various panes are initialized from constructor.
    frame.retrieveGUI(company);
    frame.setTitle("Financial Calculator | Ratios");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setMinimumSize(new Dimension(1000, 500));
    frame.pack();
    frame.setLocationRelativeTo(null);
    frame.setVisible(true);
} 
```

我认为我的 JSOUP 代码是正确的，但我可能会对 select 和 node 元素以及查询感到困惑。如果有人可以提供帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T15:22:19.640

第 72 行： `Elements columns = doc.getElementById("fundamentalsForm").children().select("table").get(0).select("tr").get(0).select("td");`

从评论来看，似乎`doc.getElementById("fundamentalsForm")`正在生成 NPE。

我怀疑每个有效页面都有“fundamentalsForm”表单，所以这不应该是问题。您是否检查并看到您没有触发错误页面（即股票代码未注册）？

# java - 基于偏航上/下坡的更好方法？

> ID：11182572
> 
> 赞同：1
> 
> 时间：2012-06-25T01:31:48.250
> 
> 标签：java, math, trigonometry

好的，所以我得到了一些运动代码，我想我需要手动输入何时上/下斜坡。我要做的只是斜坡的法线和矢量，以及我当前和以前的位置，以及我的偏航。

有没有更好的方法来根据我的偏航来旋转上坡或下坡？

```
Vector3f move = new Vector3f(0,0,0);
        move.x = (float)-Math.cos(Math.toRadians(yaw));
        move.z = (float)-Math.sin(Math.toRadians(yaw));

        System.out.println("slopeNormal.z: " + slopeNormal.z + "move.z: " + move.z);

        move.normalise();

        float vx = (float) (Math.sqrt(Math.pow(move.y, 2) + Math.pow(move.z, 2)) * move.x);
        float vy = (float) (Math.sqrt(Math.pow(move.x, 2) + Math.pow(move.z, 2)) * move.y);
        float vz = - vx * slopeNormal.x - vy * slopeNormal.y;
        move.scale(movementSpeed * delta); 

        if(vz < 0)
            move.y -= slopeVec.y * 1.5f;

        if(vz > 0)
            move.y += slopeVec.y * 1.5f;

        Vector3f.add(pos, move, pos); 
```

编辑：更新代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:15:58.330

首先，以下是不正确的：

```
move.x = (float)-Math.toDegrees(Math.cos(Math.toRadians(yaw)));
move.z = (float)-Math.toDegrees(Math.sin(Math.toRadians(yaw))); 
```

`Math.toDegrees`将以弧度为单位的角度转换为以度为单位的角度，但 和 的结果`Math.cos`不是`Math.sin`角度.

假设零偏航在正 x 方向...并定义 vx、vy、vz = 沿 3 个轴的运动速率，s = 速度和斜率法线 = nx, ny, nz 其中 nx^2 + ny^2 + nz^2 = 1。所以 nx = ny = 0，nz = 1 将是平坦的。

首先，我定义 x', y' = 相对于平坦地面的轴（运动受限于地面）。然后（以下不是有效的Java，但无论如何我都以代码格式将其括起来）：

```
vx' = cos(yaw) * s
vy' = sin(yaw) * s 
```

然后我需要从 x', y' 坐标旋转到真实世界的坐标。这是使用斜率法线完成的：

```
vx = sqrt(vy^2 + vz^2) vx'
vy = sqrt(vx^2 + vz^2) vy'
vz = - vx' nx - vy' ny 
```

检查此转换：vx^2 + vy^2 + vz^2 必须等于 vx'^2 + vy'^2 = s^2。我认为这行得通。

所以回答你的问题：向上还是向下？vz > 0 向上，vz < 0 向下。

# c - 数组上的链表分配器

> ID：11182573
> 
> 赞同：1
> 
> 时间：2012-06-25T01:31:54.803
> 
> 标签：c, pointers

抱歉，如果只有我在挠头看这段代码，但有人能解释一下这个链表是如何存储的吗？

特别是我对这个操作感到困惑`*((Particle**)p) = (p++)+1;`- 如何解释左侧指针上的操作？

```
#include <stdio.h>

typedef struct Particle_s {
    int myint;
    char test_string[10];
} Particle;

#define maxParticles 10

static Particle particleBuf[maxParticles]; // global static array
static Particle* headParticle;

void initParticleAllocator()
{
    Particle* p = particleBuf;
    Particle* pEnd = particleBuf+maxParticles-1;
    // create a linked list of unallocated Particles
    while (p!=pEnd) 
        *((Particle**)p) = (p++)+1;

    *((Particle**)p) = NULL; // terminate the end of the list

    headParticle = particleBuf; // point 'head' at the 1st unalloc'ed one
}

Particle* ParticleAlloc()
{
    // grab the next unalloc'ed Particle from the list
    Particle* ret = headParticle;
    if (ret)
        headParticle = *(Particle**)ret;
    return ret; // will return NULL if no more available
}

void ParticleFree(Particle* p)
{
    // return p to the list of unalloc'ed Particles
    *((Particle**)p) = headParticle;
    headParticle = p;
}

int main(int argc, char **argv)
{
    int i;

    initParticleAllocator();

    for( i=0; i<maxParticles; i++) {
        Particle* newparticle = ParticleAlloc();
        printf("test cell %d (0x%x - 0x%x)\n", i, &particleBuf[i], newparticle);
    }

    getc(stdin);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:36:06.567

这段代码执行的操作是：数组“particleBuf”的每个成员都被初始化为数组下一个成员的地址——直到最后一个元素被初始化为空。

这样，每当需要向链表添加新成员时，只需通过读取数组元素来获取下一个要放入的 ParticleBuf，然后更新 headParticle 以指向数组的下一个成员。

# java - 如何在 Java 程序中查找和消除随机源

> ID：11182580
> 
> 赞同：0
> 
> 时间：2012-06-25T01:33:09.407
> 
> 标签：java, random

我目前正在研究 Java 中的遗传编程算法。对于我的实验，我尝试了几种设置组合并了解所需的时间，我多次运行每个设置组合，以便我可以取平均值等。

但是，即使有时我只启动一个具有恒定值的 Random rng 实例作为种子（不幸的是，并非总是如此），但对于使用相同设置的运行，我会得到不同的结果。

所以，我的问题是，除了在我自己的代码中显式创建新的随机数生成器之外，其他随机性来源可能是什么？

会不会是集合、散列等工作的方式？？？我怎样才能使这些工作可预测？

我已经检查了对 Collections.shuffle 的调用，并用我的单个 Random 实例将它们作为种子......

任何建议都非常感谢。

一些评论建议发布代码。但是，我不是在寻求具体的反馈，但我更感兴趣的是一般来说（不希望的）随机性来源可能是什么。我忘了提到的一个当然是使用多线程。

当然，我强制让我的代码运行单线程，以防止来自该源的任何随机性

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:17:15.743

一旦你消除了随机和多线程作为非确定性的来源，接下来要看的地方是忘记在集合中使用的某些对象上实现 hashCode() 和 equals()。我从不将 Random 用于任何事情，但我有许多非确定性程序，其恶意行为可以追溯到 Object.hashCode()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:00:49.840

使用 java.util.Random 生成的随机数序列保证对于用于初始化它的任何特定种子都是相同的。从[API 文档](http://docs.oracle.com/javase/6/docs/api/java/util/Random.html)：

> 如果使用相同的种子创建 Random 的两个实例，并且为每个实例进行相同的方法调用序列，它们将生成并返回相同的数字序列。

所以简短的回答是，只有当您更改对 RNG 进行的方法调用的数量或顺序时，才会发生这种情况。正如评论中提到的，最可能的解释是您有多个线程使用 RNG。在这种情况下，非确定性 OS 调度显然有可能导致调用顺序因运行而异。

即使在单线程应用程序中，也可能发生这种情况的另一种方式是，如果您的应用程序直接或间接地使用来自任何未严格排序的事件处理程序的 RNG。例如，如果您（或您使用的库）`Random`从事件处理程序中使用鼠标、键盘或网络事件，则处理这些事件的不确定顺序可能会改变由其他主线代码生成的数字序列。

# c#-4.0 - 创建 Outlook 对象时出错

> ID：11182582
> 
> 赞同：2
> 
> 时间：2012-06-25T01:33:29.310
> 
> 标签：c#-4.0, outlook-addin, runtime-error

当我在 Windows 7 x64 机器上的 Visual Studio 2010 中想要与 Outlook 2010 集成时，我会收到此错误：

```
System.Runtime.InteropServices.COMException was unhandled by user code
  Message=Retrieving the COM class factory for component with CLSID {0006F03A-0000-0000-C000-000000000046} failed due to the following error: 80080005 Server execution failed (Exception from HRESULT: 0x80080005 (CO_E_SERVER_EXEC_FAILURE)).
  Source=mscorlib
  ErrorCode=-2146959355
  StackTrace:
       at System.Runtime.Remoting.RemotingServices.AllocateUninitializedObject(RuntimeType objectType)
       at System.Runtime.Remoting.Activation.ActivationServices.CreateInstance(RuntimeType serverType)
       at System.Runtime.Remoting.Activation.ActivationServices.IsCurrentContextOK(RuntimeType serverType, Object[] props, Boolean bNewObj)
       at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandleInternal& ctor, Boolean& bNeedSecurityCheck)
       at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache)
       at System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean skipCheckThis, Boolean fillCache)
       at System.Activator.CreateInstance(Type type, Boolean nonPublic)
       at System.Activator.CreateInstance(Type type)
       at SpatialExcelAddIn.MapBrowserUI.AddAttachment() in C:\Userdata\Projects2010\ExcelAddin\ExcelAddin-branch\UIandExcelLayer\MapBrowserUI.cs:line 105
       at SpatialExcelAddIn.MapBrowserUI.emailToolStripMenuItem_Click(Object sender, EventArgs e) in C:\Userdata\Projects2010\ExcelAddin\ExcelAddin-branch\UIandExcelLayer\MapBrowserUI.cs:line 86
       at System.Windows.Forms.ToolStripItem.RaiseEvent(Object key, EventArgs e)
       at System.Windows.Forms.ToolStripMenuItem.OnClick(EventArgs e)
       at System.Windows.Forms.ToolStripItem.HandleClick(EventArgs e)
       at System.Windows.Forms.ToolStripItem.HandleMouseUp(MouseEventArgs e)
       at System.Windows.Forms.ToolStripItem.FireEventInteractive(EventArgs e, ToolStripItemEventType met)
       at System.Windows.Forms.ToolStripItem.FireEvent(EventArgs e, ToolStripItemEventType met)
       at System.Windows.Forms.ToolStrip.OnMouseUp(MouseEventArgs mea)
       at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
       at System.Windows.Forms.Control.WndProc(Message& m)
       at System.Windows.Forms.ScrollableControl.WndProc(Message& m)
       at System.Windows.Forms.ToolStrip.WndProc(Message& m)
       at System.Windows.Forms.MenuStrip.WndProc(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
       at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
  InnerException: 
```

我添加了对 Outlook 版本 14 组件的引用，并且正在使用以下代码：

OL.Application app = new OL.Application(); <-- 这会导致错误

它仅在 Outlook 运行时发生，如果我停止 Outlook 应用程序并再次运行代码，我工作得很好。

，请指教！

# java - 如何从由 Java 类执行的 Jython 调用 Java 方法？

> ID：11182584
> 
> 赞同：1
> 
> 时间：2012-06-25T01:33:51.230
> 
> 标签：java, parent, jython

我是（Java/C++/C#）的新手程序员，我也知道 Python。我正在尝试用 Java 创建一个可以调用 Jython 脚本的 GameEngine，它可以访问 Java 引擎中的方法。

我不知道如何处理这个问题。我已经进行了数周的研究，但没有人回答我的问题；那是：

如何从我的父类执行的 JythonScript 调用我的父类中的方法？

- - - - - - - - - - - - - - - - - -更新 - - - - - - - -------------------------------------

好的，这里的答案帮助我理解了一些事情，但它并没有解决我的问题。我想知道这样的事情是否可行：

```
class MyJavaClass
{
    Public MyJavaClass()
    {
        PythonInterpreter interp = new PythonInterpreter;
        interp.execfile("MyJythonScript.py");
        interp.exec("InGameCommand");
    }

    public void SpawnPlayer()
    {}

    public void KillPlayer()
    {}

} 
```

MyJythonScript.py

```
Def InGameCommand():
    SpawnPlayer()
    KillPlayer() 
```

这甚至可能吗？有办法做到这一点吗？

- - - - - - - - - - - - - - - - - -更新 - - - - - - - -------------------------------------

Jython 的位置：“C:\jython2.7a2\jython.jar” 我工作的位置：“C:\Documents and Settings\PC\Desktop\Jython*.java” 我本地 JtyhonJar 的位置：“C:\Documents and设置\PC\桌面\Jython\jython.jar"

我的编译器我写了：“@echo off”“javac -classpath C:\jython2.7a2\jython.jar *.java”“echo done”“pause >nul”

现在它甚至没有编译......（我在我的代码中改变了一些小东西，看看它是否改变了，它没有！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:49:13.377

需要jython.jar

1.  在java中执行python代码。

    ```
    import org.python.util.PythonInterpreter;  
    public class PythonScript{  
        public static void main(String args[]){  
            PythonInterpreter interpreter = new PythonInterpreter();  
            interpreter.exec("days=('One','Two','Three','Four'); ");  
            interpreter.exec("print days[1];");    
        }
    } 
    ```

2.  在java中调用python脚本方法。

    python 脚本文件，名为 test.py

    ```
    def add(a, b):  
        return a + b 
    ```

    爪哇代码：

    ```
    import org.python.core.PyFunction;  
    import org.python.core.PyInteger;  
    import org.python.core.PyObject;  
    import org.python.util.PythonInterpreter;  

    public class PythonScript {  
        public static void main(String args[]) {  

            PythonInterpreter interpreter = new PythonInterpreter();  
            interpreter.execfile("/home/XXX/XXX/test.py");  
            PyFunction pyFuntion = (PyFunction)interpreter.get("add",PyFunction.class);  

            int a = 10, b = 20 ;  
            PyObject pyobj = pyFuntion.__call__(new PyInteger(a), new PyInteger(b));  
            System.out.println("result = " + pyobj.toString());  
       }
    } 
    ```

3.  在java中运行python脚本

    python脚本文件，名为test.py：

    ```
    number=[1,10,4,30,7,8,40]  
    print number  
    number.sort()  
    print number 
    ```

    爪哇代码：

    ```
    import org.python.util.PythonInterpreter;

    public class FirstJavaScript {

        public static void main(String args[]) {
             PythonInterpreter interpreter = new PythonInterpreter();
             interpreter.execfile("/home/XXX/XXX/test.py");
        }
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T04:03:42.843

是的，这种方式很好，但是您不能在构造函数方法中运行 python 脚本，如果是这样，它将在您的代码中死递归。请看下面的代码。你运行 PythonScriptTest 类，它会先运行 python 脚本，然后 python 脚本会调用 PythonScriptTest.SpawnPlayer() 方法。

爪哇代码：

```
package com.xxx.jython;
import org.python.core.PyFunction;
import org.python.util.PythonInterpreter;

public class PythonScriptTest {

    public static void main(String[] args) {
        PythonScriptTest f = new PythonScriptTest();
        f.executePythonScript();
    }

    public PythonScriptTest(){
    }

    public void executePythonScript() {
            PythonInterpreter interpreter = new PythonInterpreter();
            interpreter.execfile("/home/XXX/XXX/util.py");
            PyFunction pyFuntion = (PyFunction) interpreter.get("InGameCommand", PyFunction.class);

            pyFuntion.__call__();
    }

    public void SpawnPlayer() {
            System.out.println("Run SpawnPlayer method ##################");
    }
} 
```

Python 脚本，名为 util.py：

```
import sys.path as path
# the following path is eclipse output class dir
# does not contain java class package path.
path.append("/home/XXX/XXX/Test/bin")
from com.xxx.jython import PythonScriptTest

def add(a, b):  
    return a + b  

def InGameCommand():
    myJava = PythonScriptTest()
    myJava.SpawnPlayer() 
```

# python - 访问字典Python中元组中的元素

> ID：11182585
> 
> 赞同：1
> 
> 时间：2012-06-25T01:33:53.260
> 
> 标签：python

我正在编写一个代码来识别给定数字的子前缀。我有一堆`if`语句来找出子前缀。但是我认为更优雅的解决方案是字典。所以我有以下字典：

问题是，如果我写`9 in subfix`，结果是假的。如何访问字典中元组中的元素？

```
 subfix = {(0, 4, 5, 6, 7, 8, 9, 11, 12, 13): 'th', 1: 'st', 2: 'nd', 3: 'rd'} 
```

例如，我想写一些简单的东西，例如：

```
def subf(a):
     if a in subfix:
           ending = subfix.get(a)
     print('We met on the ',a,ending,'.'sep='') 
```

这将打印“我们在 1 日见面”。（但不适用于 0,4,5,6,7,8,9,11,12,13）我如何让它适用于这些元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T01:37:52.810

由于其内部实现为哈希表，字典将单个键映射到单个值。虽然您*可以*动态构建具有所需格式的字典，但我认为考虑这个问题的一个很好的替代方法如下：

*   对于特殊情况和`1`，我们使用字典中的特殊值`2``3`
*   对于所有其他情况，我们将`th`其用作后缀。

幸运的是，这里的`default`参数[`dict.get()`](http://docs.python.org/library/stdtypes.html#dict.get)来救援：

```
subfix = {1: 'st', 2: 'nd', 3: 'rd'}
def subf(a):
    ending = subfix.get(a, 'th')
    print('We met on the {}{}.'.format(a, ending)) 
```

如果它有键，这将使用字典中的值，否则它将使用`th`.

**编辑**：至于如何构建具有必要格式的字典，我们可以使用：

```
subfix = { 1: 'st', 2: 'nd', 3: 'rd'}
for k in (0, 4, 5, 6, 7, 8, 9, 11, 12, 13):
    subfix[k] = 'th' 
```

请注意，为了完整起见，我只是将其包括在内，我不认为这很优雅。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T01:50:03.857

你需要知道你正在使用的操作实际上是做什么的。`something in some_dictionary`不是您当时碰巧想要的任意定义的“in”测试概念。它测试是否`something`是 的键`some_dictionary`。`9`不是一键的，所以**在**正确返回。`subfix``9``subfix``False`

退后一步，想想`subfix`它有什么作用？它是干什么用的？在这样的定义中：

```
subfix = {1: 'st', 2: 'nd', 3: 'rd'} 
```

我会说这`subfix`表示从数字到用于每个数字的序数版本的后缀的映射。OTOH这个定义：

```
subfix = {(0, 4, 5, 6, 7, 8, 9, 11, 12, 13): 'th', 1: 'st', 2: 'nd', 3: 'rd'} 
```

表示类似于“从共享一个共同的序数后缀或单个数字到它们的序数后缀的数字元组的映射”。这个定义所代表的要复杂*得多*，因此使用它要复杂得多。如果你有一个任意数字并且你想找到它的序数后缀，你需要找出它是否是字典中的键或者它是否是字典中任何键的元素。这意味着字典不允许您直接从数字跳转到序数后缀，也不允许您快速检查映射中是否有任何数字。所以我认为在这种情况下使用错误的数据结构；从数字到后缀的直接映射会更容易使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T01:38:43.393

您需要单独使用数字作为键。您可以手动创建字典，或执行以下操作：我不确定哪个更好：

```
suffixes_list = [
    ((0, 4, 5, 6, 7, 8, 9, 11, 12, 13), "th"),
    ((1,), "st"),
    ((2,), "nd"),
    ((3,), "rd"),
]

suffixes = {}
for nums, suffix in suffixes_list:
    for num in nums:
        suffix[num] = suffix 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T01:41:54.883

最简单的：

```
 subfix = {1: 'st', 2: 'nd', 3: 'rd'}
 subfix.get(num, 'th') 
```

get 命令将返回 st 表示 1，nd 表示 2，rd 表示 3，th 表示其他任何值。

另一种选择是使用元组，在这里你真的不需要字典。

```
subfix = ('','st','nd','rd','th','th','th','th','th','th',) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T01:55:19.323

要将您的多键字典解压缩为将单键映射到值的字典：

```
subfix = subfix((key, value) for key in keys if isinstance(keys, tuple) else (keys,) 
                for keys in subfix.items()) 
```

请注意，这并不意味着您的原始数据结构是一个好主意（正如 Ben 所说，它有一个混淆类型），但最好知道如何做到这一点，特别是如何使用嵌套生成器（或列表）推导.

# javascript - 使用javascript从视频流中提取音频

> ID：11182587
> 
> 赞同：0
> 
> 时间：2012-06-25T01:34:31.423
> 
> 标签：javascript, html, audio, video, stream

我想使用 javascript 从视频文件中提取音频，是否可以制作 mp3 文件或任何格式，以便我可以在 html5 的音频标签中播放它？如果是的话怎么办？或者我应该使用什么 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:36:38.993

JavaScript 是在客户端运行的脚本，通常用于处理用户交互。长时间的计算会导致浏览器暂停脚本，并可能使页面无响应。此外，它不适合视频编码/解码。

您应该使用 Java 小程序进行视频处理/音频提取。这样，处理仍然被卸载到客户端。服务器上的处理在内存和处理器周期方面是昂贵的。不建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T03:56:23.993

Sooo，这不是最佳解决方案。这实际上有点可怕，因为您将强迫用户在没有看到视频的情况下下载视频。您可以做的是将文件作为 HTML5 视频播放，然后隐藏视频显示然后显示控件，就好像它只是音频一样。这有点像播放视频，但只是在听音频的同时不看视频。

结帐 jPlayer：http: [//jplayer.org/](http://jplayer.org/)

它可以让您基本上在任何浏览器上播放 MP4，方法是告诉它使用 flash，然后在需要时回退到 HTML5。然后你可以使用 CSS/HTML/Images 来设置你想要的样式。

您可能想先尝试一个小测试，看看`display:none;`css 样式是否也会阻止视频的音频播放。如果是这种情况，您也可以使用`height:0;`;

再一次，这是次优的，因为您正在占用用户的带宽。还有其他解决方案可能会在流媒体环境中为您删除音频。

# c - C：一个分配块用于多个不同类型的结构

> ID：11182588
> 
> 赞同：0
> 
> 时间：2012-06-25T01:34:37.043
> 
> 标签：c

尝试使用一个 malloc()ed 块在其中存储多个不同类型的结构。成员出于演示目的是虚构的。不能对它们的类​​型、顺序等做出任何假设，除非它们构成了完全合法的 C 结构（完全为 C 编译器所知并为 C 编译器定义）。这一次是这个，另一次是那个。我追求这个概念。创建自己的组合，但想法必须相同 - 标头结构具有指向其他结构的指针：

```
typedef struct
{
    int    a;
} s1_t;

typedef struct
{
    int    b;
} s2_t;

typedef struct
{
    int    c;
} s3_t;

typedef struct
{
    s1_t*    s1;
    s2_t*    s2;
    s3_t*    s3;
} hdr_t;

int
main( int argc, char* argv[] )
{
    void*    mem = malloc( sizeof( hdr_t ) + 
                           sizeof( s1_t ) + 
                           sizeof( s2_t ) + 
                           sizeof( s3_t ) );

    hdr_t    hdr = ( hdr_t* )mem;

    hdr->s1 = (s1_t* ) ( hdr + sizeof( hdr ) );
    hdr->s2 = (s2_t* ) ( hdr->s1 + sizeof( s1_t ) );
    hdr->s3 = (s3_t* ) ( hdr->s2 + sizeof( s2_t ) );

    /* etc. */
} 
```

上面的（幼稚的）代码是希望不要用小的 malloc 将堆碎片化，而是为整个（在键盘时间已知）集合获得一个块。

问题：对于尽可能便携的解决方案，我是否必须在我的方案中手动对齐结构？

换句话说，我是否需要（伪代码），ALSZ = 此芯片的对齐大小：

```
mem = malloc( hdrsz + ALSZ + s1sz + ALSZ + s2sz + ALSZ + s3sz );

hdr = ( hdr_t* )hdr;

s1 = align( hdr + sizeof( hdr_t ), ALSZ );

s2 = align( s1 + sizeof( s1 ), ALSZ );

s3 = align( s2 + sizeof( s2 ), ALSZ ); 
```

align(mem, boundary) 是我计算对齐地址的例程。

谢谢你的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:39:23.803

而不是使用

```
typedef struct
{
    s1_t*    s1;
    s2_t*    s2;
    s3_t*    s3;
} hdr_t; 
```

利用

```
typedef struct
{
    s1_t    s1;
    s2_t    s2;
    s3_t    s3;
} hdr_t;

main( int argc, char* argv[] )
{
    void*    mem = malloc( sizeof( hdr_t ));

    hdr_t*    hdr = ( hdr_t* )mem;
} 
```

这正是您正在寻找的：为一组结构连续分配内存，并保证其成员`hdr_t`指向正确的位置，而无需担心芯片内存对齐填充；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:13:57.980

你的指针算法有问题。将 1 加到指针上并不是将其前移一个字节，而是将其前移到下一个元素；通过尖类型的大小。

如果你有

```
struct foo {
    ...
};

struct bar {
    ...
};

struct baz {
    ...
};

struct header {
    ...
    struct foo *foo;
    struct bar *bar;
    struct baz *baz;
    ...
}; 
```

您可以使用单个内存块分配结构

```
struct header *ptr;

ptr = malloc (sizeof (struct header) + sizeof (struct foo) + sizeof (struct bar) + sizeof (struct baz));
if (!ptr) {
    /* out of memory */
    exit(1);
}

ptr->foo = (struct foo *)(ptr + 1);
ptr->bar = (struct bar *)(ptr->foo + 1);
ptr->baz = (struct baz *)(ptr->bar + 1); 
```

或者，如果您希望使用字节偏移量（例如，如果结构的大小是动态的——在 C99 中非常合法），您可以使用

```
struct header *ptr;
char          *tmp;

tmp = malloc (sizeof (struct header) + sizeof (struct foo) + sizeof (struct bar) + sizeof (struct baz));
if (!tmp) {
    /* out of memory */
    exit(1);
}

ptr = (struct header *)tmp;
ptr->foo = (struct foo *)(tmp + sizeof (struct header));
ptr->bar = (struct bar *)(tmp + sizeof (struct header) + sizeof (struct foo));
ptr->baz = (struct baz *)(tmp + sizeof (struct header) + sizeof (struct foo) + sizeof (struct bar)); 
```

在这两种情况下，`struct header`结构中的指针都将获得相对于`struct header`自身指针的相同值。在后一种情况下，如果您使用任意结构大小，您还必须记住根据 ABI 要求对齐新指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:13:07.100

如果你能用，Dancrumb 的解决方案绝对是最好的。如果不是（例如，如果您需要的结构的数量是可变的，或者有太多的组合或特殊情况的成本过高），您可以自己进行对齐：

由于任何类型的对齐要求总是除以类型的大小，因此从获取结构中可能出现的所有类型的 LCM 开始。如果你想偷懒，就拿`sizeof(short)*sizeof(int)*sizeof(long)*...`所有类型的产品。或者只是使用 64 之类的 2 的大幂，您确定它大于它们中任何一个的大小。

然后，在对 malloc 获得的块进行指针运算时，将每个结构的大小四舍五入到您上面选择的对齐值的下一个倍数。例如

```
#define ROUND_UP(n, a) (((n)+((a)-1))/(a)*(a))
ps2 = (void *) ( (char *)ps1 + ROUND_UP(sizeof(*ps1), ALIGNMENT) ); 
```

where`ps1`是指向 malloc'd 块中第一个结构的指针，`ps2`是指向第二个结构的指针。

当然，您需要在进行分配时进行相同的舍入以确保有足够的空间。

**编辑：**我在我的一个旧答案中发现了对此的改进。由于试图找出最大可能的对齐要求是很痛苦的，特别是如果你想 100% 可移植，只需使用**任何类型**（包括结构）的对齐要求必须除以类型的大小的事实，并假设他们是平等的。那是：

```
ps2 = (void *) ( (char *)ps1 + ROUND_UP(sizeof(*ps1), sizeof(*ps2)) ); 
```

它将第一个结构的大小四舍五入到第二个结构大小的下一个倍数。这可能有点浪费，但它很简单并且应该始终有效。

# ios - 如何针对特定目标文件大小优化 UIImage 调整大小？

> ID：11182591
> 
> 赞同：1
> 
> 时间：2012-06-25T01:34:57.180
> 
> 标签：ios, optimization, uiimage, compression, nsdata

对于任何给定的文件数据大小，我希望能够调整（或压缩） UIImage 的大小以适应该数据限制。这个问题**不是**关于如何调整大小或如何检查文件大小......它是关于一种以高性能方式获得它的算法。

已经在这里搜索，我发现[这个线程](https://stackoverflow.com/questions/2655769/uiimagejpegrepresentation-memory-release-issue)讨论了以线性或二进制算法降低图像 jpeg 质量。这不是很高效，最多需要几十秒。

我在 iOS 上工作，所以图像可以接近 10MB（来自 iPhone 4S）。我的目标虽然可变，但目前是 3145728 字节。

我目前正在使用`UIImageJPEGRepresentation`压缩一点，但要达到我的低目标，对于这么大的照片，我似乎不得不损失很多质量。`UIImage`大小和`NSData`大小之间有关系吗？是否有一些功能我可以说：

```
area * X = dataSize 
```

...并解决比例因子，以便我可以一次性调整大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:10:02.640

在查看您链接到的线程后，我有一个想法：压缩 10MB 图像会相对较慢。如何将大小调整为更小（以便压缩更快），然后执行压缩算法（来自链接）。那么这可以作为压缩10MB图像大小的指导吗？这个想法是相同图像的压缩率应该相似，与大小无关。

假设 1000x1000 像素压缩为 10MB，目标大小为 3MB。

然后说以相同质量压缩的较小的 100x100 像素（例如）是*C* MB。然后在 100x100 图像上执行二分搜索算法，直到 size = C * (3/10)。然后对 1000x1000 图像使用此压缩质量以获得约 3MB 图像。

注意：我不知道这会有多好——这只是一个建议。为较小尺寸的图像选择什么尺寸（我使用 100x100）也只是一个猜测，需要进行一些试验。

# android - 从 Android 布局文件调用空函数会导致 App 崩溃

> ID：11182599
> 
> 赞同：0
> 
> 时间：2012-06-25T01:36:22.397
> 
> 标签：android, function, layout

我在 Android 布局文件中有一个复选框。单击复选框时，我会在活动类中调用一个空函数。这会导致应用程序停止工作。为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:44:47.637

我假设您在 XML 中使用“onclick”属性。

如果您收到 MethodNotFound 异常，它可能是以下两种情况之一：

您的 Activity 的方法名称或 XML 的方法名称有错字，或者...

您的方法在 Activity 中的可见性是不公开的。

在 XML 中指定 onclick 值时，该方法在您的活动中应如下所示：

```
public void myOnClickMethod(View v) { ... } 
```

# android - Android中的视频录制只录制一次视频

> ID：11182600
> 
> 赞同：0
> 
> 时间：2012-06-25T01:36:27.057
> 
> 标签：android

我发现这个工作代码将捕获视频并稍作修改。是的，代码运行良好，但它只允许用户只录制一次视频。当用户在我点击“开始录制”的那一刻点击菜单中的“停止录制”时，它将不再录制视频。

我想要发生的是，当我点击“停止录制”时，它将再次准备相机，然后当我点击“开始录制”时，它将录制新视频。

如何解决这个问题？

顺便说一下这里的主要代码：

```
package com.tcs.video; 
import android.app.Activity;
import android.content.Context;
import android.content.pm.ActivityInfo;
import android.media.MediaRecorder;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.view.Surface;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.Window;

public class VideoRecorder extends Activity{

private MediaRecorder recorder;
private Preview mPreview;

boolean flag=false; 
boolean startedRecording=false;

public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    recorder = new MediaRecorder();
    recorder.setVideoSource(MediaRecorder.VideoSource.DEFAULT);
    recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
    recorder.setVideoEncoder(MediaRecorder.VideoEncoder.MPEG_4_SP);
    mPreview = new Preview(VideoRecorder.this,recorder);
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);
    setContentView(mPreview);

}

@Override
public boolean onPrepareOptionsMenu(Menu menu) 
{
    super.onPrepareOptionsMenu(menu);
    menu.clear(); 
    menu.add(0, 0, 0, "Start Recording"); 
    menu.add(1, 1, 0, "Stop Recording");

    menu.setGroupVisible(0, false);
    menu.setGroupVisible(1, false);

    if(startedRecording==false){
        menu.setGroupVisible(0, true);
        menu.setGroupVisible(1, false);
    }else if(startedRecording==true){
        menu.setGroupVisible(1, true);
        menu.setGroupVisible(0, false);
    }

    return true;
}

 /*!
    <p>
    This method receives control when Item in menu option is selected. It contains implementations
    to be performed on selection of menu item. 
    </p>*/

@Override
public boolean onOptionsItemSelected(MenuItem item) 
{
    switch (item.getItemId()) 
    {
    case 0:
        //start the recorder
        recorder.start();
        startedRecording=true;
        break;

    case 1: 
        //stop the recorder
        recorder.stop();
        recorder.release();
        recorder = null;
        startedRecording=false;
        break;

    default:
        break;
    }
    return super.onOptionsItemSelected(item);
}

class Preview extends SurfaceView implements SurfaceHolder.Callback
{
    //Create objects for MediaRecorder and SurfaceHolder.
    SurfaceHolder mHolder;
    MediaRecorder tempRecorder;

    //Create constructor of Preview Class. In this, get an object of 
    //surfaceHolder class by calling getHolder() method. After that add   
    //callback to the surfaceHolder. The callback will inform when surface is 
    //created/changed/destroyed. Also set surface not to have its own buffers.
    public Preview(Context context,MediaRecorder recorder) {
        super(context);
        tempRecorder=recorder;
        mHolder=getHolder();
        mHolder.addCallback(this);
        mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        // TODO Auto-generated constructor stub
    }

    public Surface getSurface()
    {
        return mHolder.getSurface();
    }

    // Implement the methods of SurfaceHolder.Callback interface

    // SurfaceCreated : This method gets called when surface is created.
    // In this, initialize all parameters of MediaRecorder object.
    //The output file will be stored in SD Card.

    public void surfaceCreated(SurfaceHolder holder){
        tempRecorder.setOutputFile("/sdcard/recordvideooutput.3gpp");
        tempRecorder.setPreviewDisplay(mHolder.getSurface());
        try{
            tempRecorder.prepare();
        } catch (Exception e) {
            String message = e.getMessage();
            tempRecorder.release();
            tempRecorder = null;
        }
    }

    public void surfaceDestroyed(SurfaceHolder holder) 
    {
        if(tempRecorder!=null)
        {
            tempRecorder.release();
            tempRecorder = null;
        }
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) 
    {

    }
    }   
} 
```

请帮忙！

谢谢

杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T02:36:42.320

当您按下停止按钮时，它会释放记录器并将其分配给 null。除非有什么我没有在这里看到，否则没有什么可以再次为另一次录音做准备。

尝试使用`recorder.reset()`代替`release()`and `= null`。[官方文档](http://developer.android.com/reference/android/media/MediaRecorder.html)中对生命周期有很好的解释。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-02T05:08:40.687

这个Geobits

```
@Override
public boolean onOptionsItemSelected(MenuItem item) 
{
    switch (item.getItemId()) 
    {
    case 0:
       //start the recorder
       recorder.start();
       startedRecording=true;
       break;

    case 1: 
       //stop the recorder
       recorder.stop();
       recorder.prepare();
       startedRecording=false;
       break;

   default:
        break;
    }
    return super.onOptionsItemSelected(item);
} 
```

# iphone - 内存泄漏。仪器认为一切都很好

> ID：11182604
> 
> 赞同：1
> 
> 时间：2012-06-25T01:36:50.207
> 
> 标签：iphone, ios, memory-leaks, uiimage, cgimageref

我是相当有经验的 C 程序员，但 IOS 对我来说是新的。我确实有内存泄漏（我认为这是因为我收到 MemoryWarning 并且很快我的应用程序就会被毫不留情地杀死）。但是 Instruments 内存泄漏检测器说一切都很好。是的，我每 X 秒运行一次内存快照。同时，如果我运行 VM Tracker，我会看到内存使用量正在上升。大部分记忆被“CG Image”占据，这似乎是线索。我使用“if 0”-s 缩小到发生泄漏的位置，所以就是这样：

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer fromConnection:(AVCaptureConnection *)connection { 

    UIImage *image = [self imageFromSampleBuffer:sampleBuffer];
#if 1
    /****** Draw stuff on every frame screen *******/
    CGImageRef imageRef = image.CGImage;

    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = CGBitmapContextCreate(NULL, image.size.width, image.size.height, 8, image.size.width * 4, colorSpaceRef,kCGImageAlphaPremultipliedLast | kCGBitmapByteOrderDefault);    
    CGContextDrawImage(context, CGRectMake(0, image.size.height*-0.1, image.size.width, image.size.height*1.2 ),imageRef);
#endif

#if 0
    if (backgroundJobRunning1 == NO) {
        backgroundJobRunning1 = YES;

        NSValue *value1 = [NSValue valueWithPointer:image];
        // start1 = [NSDate timeIntervalSinceReferenceDate];
        NSArray *array = [NSArray arrayWithObjects:value1, nil];
//        [self performSelectorInBackground:@selector(cleverStuffWithImage:) withObject:array ];
        [self cleverStuffWithImage:(array)];
    }
#endif
    if(sum>0) {
        CGPoint p1= CGPointMake(image.size.height-mycorners[0].y ,image.size.width-mycorners[0].x );
        CGPoint p2= CGPointMake(image.size.height-mycorners[1].y ,image.size.width-mycorners[1].x );
        CGPoint p3= CGPointMake(image.size.height-mycorners[2].y ,image.size.width-mycorners[2].x );
        CGPoint p4= CGPointMake(image.size.height-mycorners[3].y ,image.size.width-mycorners[3].x );
        [_layer setpoints:p1 withArg2:p2 withArg3:p3 withArg4:p4];
    }

    /***** Release everything we allocated */
#if 0
    CGImageRef cgImage = CGBitmapContextCreateImage( context );
 //   imageRef = (CGImageRef)[[(id)imageRef retain] autorelease];

    UIImage *image2 = [[UIImage alloc] initWithCGImage:cgImage];
    if(_settingImage == NO) {
        _settingImage = YES;
        [self performSelectorInBackground:@selector(setImageToView:) withObject:image2];
    } else {
        CCLOG(@"missed frame");
    }

    CGImageRelease(cgImage);
#endif

#if 1
    CGColorSpaceRelease( colorSpaceRef );
    CGContextRelease( context );
#endif
}
#if 0
- ( IplImage * )createGrayIplImage: ( UIImage * )image {
    CGImageRef imageRef  = image.CGImage;
    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    IplImage * iplImage  = cvCreateImage( cvSize( image.size.width, image.size.height ), IPL_DEPTH_8U, 4 );
    CGContextRef context = CGBitmapContextCreate(iplImage->imageData,
                                          iplImage->width,
                                          iplImage->height,
                                          iplImage->depth,
                                          iplImage->widthStep,
                                          colorSpaceRef,
                                          kCGImageAlphaPremultipliedLast | kCGBitmapByteOrderDefault
                                          );

    CGContextDrawImage( context, CGRectMake(0, 0, image.size.width, image.size.height), imageRef);
    CGContextRelease( context );
    CGColorSpaceRelease( colorSpaceRef );

    IplImage * returnImage = cvCreateImage( cvGetSize( iplImage ), IPL_DEPTH_8U, 1 );
    cvCvtColor( iplImage, returnImage, CV_RGBA2GRAY );
    cvReleaseImage( &iplImage );
    return returnImage;
}
#endif
- (void)dealloc {
    [[CCDirector sharedDirector] end];
    [window release];
    [super dealloc];
} 
```

当“#if 1”-s 像现在这样时，就会发生泄漏。我没有发布什么？

实际上我有更多类似的问题，我认为关于 UIImage 和 CGI​​mage 关系我不知道一些事情。例如，如果“CGImageRef imageRef = image.CGImage;”我不清楚 分配一些东西以及它何时被释放。试图释放它会导致双重释放错误。同时，我有时将其中一个传递给后台线程并出现内存泄漏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:41:57.473

嗯，好像加了

```
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init]; 
```

开始和

```
[pool release] 
```

使问题消失。我不知道它像线程一样处理这个。

# c# - 如何将 .Where() 条件与 .Include() 一起使用？

> ID：11182605
> 
> 赞同：0
> 
> 时间：2012-06-25T01:37:00.277
> 
> 标签：c#, linq, .net-4.0

这应该很简单，但我在这个问题上没有取得任何进展。我想编写一个 LINQ 语句，它返回与给定 ID 匹配的人并包含一组访问。我能做到的。现在，我只需要包含活动访问，即仅当 IsActive 标志为真时才包含访问。我的查询包括在下面。我究竟做错了什么？

```
var inmate = this.db.Inmates.Where(p => p.Id == id).Include(p => p.Visits.Where(v => v.IsActive)).FirstOrDefault(); 
```

更新 #1 - 我也试过这个说法：

```
var inmate = this.db.Inmates.Include(p => p.Visits).Where(p => p.Id == id && p.Visits.Any(v => v.IsActive)).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:58:04.220

尝试这个：

```
var inmate = this.db.Inmates.Where(i => i.Visits.Any(x => x.IsActive)) 
```

注意：代码假定`IEnumerable<Visits>`是`Inmate`对象的属性。

# c# - 检查英语语法

> ID：11182606
> 
> 赞同：5
> 
> 时间：2012-06-25T01:37:00.633
> 
> 标签：c#, nlp, grammar

我正在寻找一个简单的 C# 库，它执行以下操作：获取一个表示单个句子的字符串，并返回一个布尔值，说明它在语法上是否正确。

经过大量搜索后，我无法找到一个独立的库来执行此操作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T02:45:18.087

如果您安装了 MS Word，您可以在项目中包含对 COM 库“Microsoft Word 12.0 对象库”的引用。（我认为可能还有一个 .NET 互操作库，但我还没有测试过）。

然后在您的代码中，您可以简单地调用：

```
Microsoft.Office.Interop.Word.Application myWord = new Microsoft.Office.Interop.Word.Application();

...

return myWord.CheckGrammar("Your string here"); 
```

那应该这样做。

# python - Python函数缓存？

> ID：11182607
> 
> 赞同：2
> 
> 时间：2012-06-25T01:37:37.833
> 
> 标签：python, function, caching, return

我在Python中遇到了一个非常奇怪的情况。

我`while True:`在脚本中有一个循环，不断获取实时数据。数据仅用于在工作时间获取，因此我在名为`lib/date.py`.

这是功能：

```
def isTime(utc_now=datetime.datetime.utcnow()): 
    '''
    9:00 AM UTC - 5:00 PM UTC Mon - Fri.

    The parameter utc_now can be used to specify a specific     
    datetime to be checked instead of the utcnow(). 
    '''

    week_day = utc_now.weekday()

    # no good on Saturdays and Sundays
    if 5 == week_day or 6 == week_day:
        return False

    now_int = (utc_now.hour * 60) + utc_now.minute

    if (17 * 60) >= now_int >= (9 * 60):
        return True

    return False 
```

我意识到检查时间的方式太过分了，但这是我功​​能的简化版本。我的实际功能还包括一堆时区转换，这使得上述操作变得必要。

这是我的主要脚本（简化）：

```
def main():
    while True:
        do_ten_seconds()

def do_ten_seconds():
    log.info("alive")

    for i in xrange(10):   
        if isTime():
            log.info("its time")
            # do data grabbing
        sleep(1) 
```

这在一周内非常有效，每周晚上停止并在第二天早上继续。然而，在周末，它并没有从长时间的休息中“恢复”。换句话说，永远不会在星期一早上`isTime`回来。`True`

我检查了日志，脚本每 10 秒打印一次“活动”，但数据抓取部分从未发生（并且“它的时间”从未打印）。因此，我假设这意味着`isTime`正在返回`False`。

会不会是因为这个函数在周末被频繁调用，并且因为它`False`连续返回了很多次，所以 Python 缓存了结果并且永远不会从中恢复？

当我在主脚本仍在`isTime`返回的错误模式下运行时生成相同的代码实例`False`时，新实例将从中获取`True`并`isTime`开始完美运行。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T01:42:56.807

第一次导入 date.py 时，会运行一次以下行：

```
def isTime(utc_now=datetime.datetime.utcnow()): 
```

运行时，默认值`utc_now`设置为该时刻的时间，并且永远不会重新计算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T01:42:57.207

默认参数是在**编译时**计算的。设置默认值`None`，并使用`is None`.

# c# - c#获取List上的属性导致堆栈溢出

> ID：11182610
> 
> 赞同：0
> 
> 时间：2012-06-25T01:38:29.930
> 
> 标签：c#, .net, list, naked-objects

你好，我对 C# 很陌生，所以我不完全确定我想要做的事情是可能的，

我基本上是在尝试在列表上设置 get 属性，当加载此列表时，它将从另一个列表中读取信息，方法是：

如果父列表为空，则创建一个新列表，否则遍历父列表元素并相应地处理每个

然而，get 方法导致堆栈溢出，通过调试器运行它似乎一遍又一遍地运行，直到堆栈被炸毁，即使它已经命中并处理了我的 return 语句

这是代码：

```
public ICollection<History> History
    {
      get {
            if (HistoryKeyCount == 0)//HistoryKeyCount = Count of Parent List
            {
                    History = new List<Histories>();
            }
            else
            {
                History = new List<Histories>();//Created again because after each read object is dropped from memory
                foreach (HistoryKey x in ParentList)
                {
                    if (x.Key == null)
                    {
                        // Do nothing
                    }
                    else
                        History.Add(ObjectFinder.FindObject<ParentList>(x.Key));
                }

            }
            return History;
        }
        set {
            //Not implemented yet
            }
      } 
```

发生的情况是它进入 get 方法，到达 if 语句，创建新对象，返回它然后一遍又一遍，直到发生 stackoverflow 异常

问题不在于 ObjectFinder 类或创建新方法，错误发生时甚至没有达到这些方法。

我最初认为它是在 if 语句的每个实例之后创建的一个新对象，但是在添加了一个标志之后，以便只有在问题仍然存在时才会创建它。

有没有人遇到过这个问题？因为它把我难住了！！

----编辑---我忘了提到我正在使用.NET的裸对象框架，这很可能是问题的根源

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T01:51:49.637

你在历史中调用历史，所以它变成递归的。

```
History.Add(ObjectFinder.FindObject<ParentList>(x.Key)); 
```

将回调您的财产，并再次在同一行结束，然后再次调用自身......直到您用完堆栈

最后，您再次调用历史......它无法逃脱:)

我有一种感觉，您要么想要一个局部变量来保存要返回的集合，要么您想要一个私有字段来保存列表。无论哪种方式，不要在历史中调用历史

# android - Android 结合 ImageDownload 和 CursorLoader

> ID：11182612
> 
> 赞同：0
> 
> 时间：2012-06-25T01:39:14.717
> 
> 标签：android, android-gridview, android-loadermanager, android-cursor, android-loader

我正在使用带有 ImageDownloader 的非常简单的 CursorLoader。ImageDownloader 正在运行，除了 CursorLoader 之外的所有内容都完成了，然后 ImageDownloader 开始下载图像，但 GridView 没有使用下载的图像进行更新。

在我的 ListFragment 中，我有以下**onActivityCreated**方法：

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    Log.d(TAG, "onActivityCreated");

    super.onActivityCreated(savedInstanceState);

    cursorAdapter = new OURSVPImageAdapter(getActivity(), null);

    // set the adapter on the gridview
    mGridView.setAdapter(cursorAdapter);

    // load the data
    getActivity().getSupportLoaderManager().initLoader(2, null, this);
} 
```

我的 CursorLoader 如下：

```
public static final class PhotoCursorLoader extends SimpleCursorLoader {

    Context mContext;

    public PhotoCursorLoader(Context context) {
        super(context);

        Log.d("PhotoCursorLoader", "Constructor");

        mContext = context;
    }

    @Override
    public Cursor loadInBackground() {
        Log.d("PhotoCursorLoader", "loadInBackground");

        PhotosDataSource datasource = new PhotosDataSource(mContext);

        # STEP 1
        return datasource.getAllPhotos(((EventActivity) mContext).getEventId());
    }

} 
```

检索所有照片的标记为**# STEP 1**的行只是检索光标的方法，如下所示：

```
public Cursor getAllPhotos(long event_id) {
    Log.d(TAG, "getAllPhotos");

    Cursor mCursor = getWritableDatabase().query(true, TABLE_NAME, COLUMNS_PHOTOS, DatabaseConstants.KEY_EVENT_ID + "=" + event_id, 
            null, null, null, null, null);

    return mCursor; 
} 
```

因此，这是 ListFragment 的 CursorLoader，当返回该 Cursor 时，它假定它是完整的，这是正确的。据我了解，**setAdapter()**方法实际上会触发**getView**方法。

我遇到的麻烦是一切似乎都运行良好，我的日志输出正在正确输出图像的 url，断点都显示合法数据，**但问题是我的网格视图永远不会用图像更新ImageDownloader 检索。**

**编辑** 这是`SimpleCursorLoader`我正在使用的：[https ://gist.github.com/1217628](https://gist.github.com/1217628)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T17:42:10.160

再一次，问题很可能是您正在`Fragment`从 parent 管理您的加载程序`Activity`。和生命周期彼此不同步（至少不是以可预测的方式），因此您调试问题的尝试实际上并没有让您有任何收获`Activity`。`Fragment`保证可预测行为的最简单方法是让每个单独的组件都使用自己的组件`LoaderManager`（而不是让您`Fragment`的 s 访问`getActivity().getSupportLoaderManager()`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T16:31:52.757

与我的另一个问题一样.. 不应该强制刷新，并且在使用提供程序时，您可以让提供程序通知 contentresovler 更新。我有一个插入新照片的方法，该方法使用数据提供程序。数据提供者需要

```
getContext().getContentResolver().notifyChange(uri, null); 
```

实际更新光标。

# aptana - 如何将 Aptana Studio 更新到最新版本？

> ID：11182618
> 
> 赞同：0
> 
> 时间：2012-06-25T01:40:48.877
> 
> 标签：aptana, aptana3, updates

我安装了 Aptana 3.1.1 并希望将其更新到最新版本 3.1.3。我怎么能这样做？

我试过“帮助”菜单下的“检查更新”，它说“没有找到更新”。我想需要添加一个更新站点，是吗？

希望我不必下载最新版本来更新 Aptana ......

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-02T04:05:51.370

问题是更新站点列表为空。要添加列表，只需在[此处](http://aptanastudio.tenderapp.com/discussions/problems/2791-available-software-sites-list-is-empty-on-aptana3 "aptana3 上的可用软件站点列表为空")导入 Aaron K 提供的 .xml 文件中的列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T04:12:39.623

请尝试[此处](https://wiki.appcelerator.org/display/tis/Errors+While+Updating)的建议，特别**是未找到更新**部分下的步骤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-12T18:39:31.920

官方说的是[http://update.aptana.com/update/studio/3.4](http://update.aptana.com/update/studio/3.4)但是什么都没有。

其中之一对我有用。但是版本太旧了。

*   [http://download.aptana.com/studio3/plugin/update/](http://download.aptana.com/studio3/plugin/update/)
*   [http://download.aptana.com/studio3-rcp/plugin/update/](http://download.aptana.com/studio3-rcp/plugin/update/)

所以找到[了这个](https://wiki.appcelerator.org/display/guides2/Changing+the+Update+Type)

**Aptana Studio 测试版更新：** [http://preview.appcelerator.com/aptana/studio3/plugin/update/beta/](http://preview.appcelerator.com/aptana/studio3/plugin/update/beta/) **Aptana Studio 每晚更新： http:** [//preview.appcelerator.com/aptana/studio3/plugin/update/nightly/](http://preview.appcelerator.com/aptana/studio3/plugin/update/nightly/)

现在，我使用测试版。:-)

# php - 如何使用 PHP 从数据库中正确获取标志值？

> ID：11182619
> 
> 赞同：0
> 
> 时间：2012-06-25T01:41:08.460
> 
> 标签：php, mysql, database, select, flags

想象它是这样的。我的数据库中有一个名为的字段，`flags`其中添加或删除了如下数据：

```
UPDATE people SET flags=flags|16 WHERE ....
UPDATE people SET flags=flags|128 WHERE ....
UPDATE people SET flags=flags&~16 WHERE ....
UPDATE people SET flags=flags&~128 WHERE .... 
```

例如，该字段的值可以是 65536 或更多或更少。我的问题是 - 如何使用 PHP 代码从该字段中获取特定标志？我的意思是这样的：

```
SELECT * FROM people WHERE flags=16; 
```

但是结果将返回所有字段中不仅有数字 16 的人，还会返回带有标志 65536 的人，有 16 的人，但不是有 2 或 1的人。`SELECT`我应该在我的 php 代码中使用哪个查询，或者可能是一些特定的 PHP 集成功能？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:53:17.967

假设`flags`是一个位域，并且您想要选择`10000`设置了位 #4 ( ) 的行

```
SELECT * FROM people WHERE flags & 16; 
```

这并不理想，因为您正在失去数据库所擅长的所有参考优势。

你应该有两个新表；`flags`和`people_flags`。前者包含所有标志（`id`并且`name`列应该足够了）。后者包含`flag_id`和`people_id`列，创建*多对多*关系（请参阅[联结表](http://en.wikipedia.org/wiki/Junction_table)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:50:27.767

虽然逻辑不正确。您不能只有一个包含 16 的标志，因为它不是唯一的。

假设您有具有此行的数据库

```
name:Jhon tel:012345 email:test@test.com flags:16
name:Mike tel:012344 email:mike@test.com flags:16
name:Sarah tel:012346 email:sarah@test.com flags:2442 
```

使用 Select 语句从此表中选择标志 16，您将获得两行数据，您可以使用 Distinct 或使标志唯一

# python - Python - __eq__ 方法未被调用

> ID：11182624
> 
> 赞同：4
> 
> 时间：2012-06-25T01:41:43.797
> 
> 标签：python

我有一组对象，并且有兴趣从集合中获取特定对象。经过一番研究，我决定使用这里提供的解决方案：http: [//code.activestate.com/recipes/499299/](http://code.activestate.com/recipes/499299/)

问题是它似乎不起作用。

我有两个这样定义的类：

```
class Foo(object):
    def __init__(self, a, b, c):
        self.a = a
        self.b = b
        self.c = c
    def __key(self):
        return (self.a, self.b, self.c)
    def __eq__(self, other):
        return self.__key() == other.__key()
    def __hash__(self):
        return hash(self.__key())

class Bar(Foo):
    def __init__(self, a, b, c, d, e):
        self.a = a
        self.b = b
        self.c = c
        self.d = d
        self.e = e 
```

注意：这两个类的相等性应该只定义在属性 a、b、c 上。

[http://code.activestate.com/recipes/499299/](http://code.activestate.com/recipes/499299/)中的包装器`_CaptureEq`也定义了自己的方法。问题是这个方法永远不会被调用（我认为）。考虑，`__eq__`

```
bar_1 = Bar(1,2,3,4,5)
bar_2 = Bar(1,2,3,10,11)
summary = set((bar_1,))
assert(bar_1 == bar_2)
bar_equiv = get_equivalent(summary, bar_2) 
```

`bar_equiv.d`应该等于 4，同样`bar_equiv .e`应该等于 5，但它们不是。就像我提到的那样，执行`__CaptureEq` `__eq__`语句时似乎没有调用该方法`bar_2 in summary`。

是否有某些原因导致该`__CaptureEq` `__eq__`方法未被调用？希望这不是一个太晦涩难懂的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T04:40:38.790

布兰登的回答内容丰富，但不正确。实际上有两个问题，一个是配方依赖于`_CaptureEq`编写为旧式类（因此，如果您在 Python 3 上使用基于哈希的容器尝试它，它将无法正常工作），另一个是您自己的`Foo.__eq__`定义声称当它应该说“我不知道，问另一个对象我们是否相等”时，这两个对象肯定是不相等的。

配方问题很容易解决：只需`__hash__`在比较包装类上定义：

```
class _CaptureEq:
    'Object wrapper that remembers "other" for successful equality tests.'
    def __init__(self, obj):
        self.obj = obj
        self.match = obj
    # If running on Python 3, this will be a new-style class, and
    # new-style classes must delegate hash explicitly in order to populate
    # the underlying special method slot correctly.
    # On Python 2, it will be an old-style class, so the explicit delegation
    # isn't needed (__getattr__ will cover it), but it also won't do any harm.
    def __hash__(self):
        return hash(self.obj)
    def __eq__(self, other):
        result = (self.obj == other)
        if result:
            self.match = other
        return result
    def __getattr__(self, name):  # support anything else needed by __contains__
        return getattr(self.obj, name) 
```

您自己`__eq__`定义的问题也很容易解决：`NotImplemented`在适当的时候返回，这样您就不会声称为与未知对象的比较提供明确的答案：

```
class Foo(object):
    def __init__(self, a, b, c):
        self.a = a
        self.b = b
        self.c = c
    def __key(self):
        return (self.a, self.b, self.c)
    def __eq__(self, other):
        if not isinstance(other, Foo):
            # Don't recognise "other", so let *it* decide if we're equal
            return NotImplemented
        return self.__key() == other.__key()
    def __hash__(self):
        return hash(self.__key()) 
```

通过这两个修复，您会发现 Raymond 的`get_equivalent`配方完全可以正常工作：

```
>>> from capture_eq import *
>>> bar_1 = Bar(1,2,3,4,5)
>>> bar_2 = Bar(1,2,3,10,11)
>>> summary = set((bar_1,))
>>> assert(bar_1 == bar_2)
>>> bar_equiv = get_equivalent(summary, bar_2)
>>> bar_equiv.d
4
>>> bar_equiv.e
5 
```

**更新：**阐明了`__hash__`仅需要显式覆盖才能正确处理 Python 3 案例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T01:55:36.973

问题在于，`set`比较两个对象的方式是“错误的”，以使这种模式拦截对`__eq__()`. 2006 年的配方显然是针对容器编写的，当被问及是否`x`存在时，会检查容器中已经存在的候选`y`值：

```
x == y 
```

比较，在这种情况下`__eq__()`on`x`可以在搜索期间执行特殊操作。但是`set`对象正在以相反的方式进行比较：

```
y == x 
```

对于集合中的每个 y。因此，当您的数据类型为`set`. 您可以通过这样的检测来确认这`Foo.__eq__()`一点：

```
def __eq__(self, other):
    print '__eq__: I am', self.d, self.e, 'and he is', other.d, other.e
    return self.__key() == other.__key() 
```

然后，您将看到如下消息：

```
__eq__: I am 4 5 and he is 10 11 
```

确认相等比较是对*集合中已经存在*的对象提出相等问题- 唉，*不是*用 Hettinger 的对象包裹的`_CaptureEq`对象。

**更新：**

而且我忘了建议前进的方向：您是否考虑过使用字典？由于您在这里对作为对象内部数据子集的键有一个概念，您可能会发现将键的概念从对象本身的概念中分离出来可能会减轻尝试这种复杂的对象拦截的需要. 只需编写一个新函数，给定一个对象和您的字典，计算键并在字典中查找，如果键存在则返回字典中已经存在的对象，否则在键处插入新对象。

**更新 2：**好吧，看看那个——尼克的答案`NotImplemented`在一个方向上使用 a 来*强制*在另一个方向`set`上进行比较。给这个人几个+1！

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-25T02:35:07.807

这里有两个问题。第一个是：

```
t = _CaptureEq(item)
if t in container:
    return t.match
return default 
```

不做你想的。特别是，`t`将*永远不会*in `container`，因为`_CaptureEq`没有定义`__hash__`. 这在 Python 3 中变得更加明显，因为它会向您指出这一点，而不是提供默认的`__hash__`. 的代码`_CaptureEq`似乎相信提供 an`__getattr__`将解决这个问题 - 它不会，因为 Python 的特殊方法查找不能保证通过与普通属性查找相同的所有步骤 - 这与`__hash__`（和其他各种）需要的相同原因被定义在一个类上，不能被猴子修补到一个实例上。因此，解决此问题的最直接方法是这样定义`_CaptureEq.__hash__`：

```
def __hash__(self):
   return hash(self.obj) 
```

但这仍然不能保证工作，因为第二个问题：`set`查找不能保证测试相等性。`set`s 基于哈希表，只有在哈希桶中有多个项目时才进行相等性测试。您不能（也不想）强制将散列不同的项目放入同一个存储桶中，因为这都是`set`. 解决这个问题的最简单方法，并且巧妙地避开第一个问题，是使用一个列表来代替：

```
summary = [bar_1]
assert(bar_1 == bar_2)
bar_equiv = get_equivalent(summary, bar_2)
assert(bar_equiv is bar_1) 
```

# java - 使用 JSCH (java) 在关闭的端口下隧道套接字

> ID：11182627
> 
> 赞同：1
> 
> 时间：2012-06-25T01:42:44.250
> 
> 标签：java, ssh, tunnel

我找到了用于 SSH 访问的 JSCH 库，我有一个套接字：Socket socket = new Socket(irc.dba.biz, 6667)，必须在端口 22 上使用 tunnel.shellmix.com 隧道服务进行隧道传输...

我该怎么做？我没有找到可以让我通过隧道连接到外部隧道服务器的文档......！（我是一个菜鸟，因为我两天前发现了这个过程）......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T08:05:03.780

参考[http://www.jcraft.com/jsch/examples/PortForwardingL.java.html](http://www.jcraft.com/jsch/examples/PortForwardingL.java.html)

如果您将“6667:irc.dba.biz:6667”作为本地端口转发的参数，您将获得以下套接字连接，

```
 Socket socket = new Socket("127.0.0.1", 6667); 
```

# c++ - OpenMP - 在每次循环迭代中启动一个新线程

> ID：11182628
> 
> 赞同：4
> 
> 时间：2012-06-25T01:42:45.597
> 
> 标签：c++, openmp

我很难调整我的想法以适应 OpenMP 的做事方式。

大致来说，我想要的是：

```
for(int i=0; i<50; i++)
{
   doStuff();
   thread t;
   t.start(callback(i)); //each time around the loop create a thread to execute callback
} 
```

我想我知道这将如何在 c++11 中完成，但我需要能够用 OpenMP 完成类似的事情。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-25T08:37:17.207

与您想要的最接近的是 OpenMP 任务，它在 OpenMP v3.0 和更高版本的兼容编译器中可用。它是这样的：

```
#pragma omp parallel
{
    #pragma omp single
    for (int i = 0; i < 50; i++)
    {
        doStuff();
        #pragma omp task
        callback(i);
    }
} 
```

此代码将使循环仅在一个线程中执行，它将创建 50 个 OpenMP 任务，这些任务将`callback()`使用不同的参数进行调用。然后它会在退出并行区域之前等待所有任务完成。任务将被空闲线程选择（可能是随机的）来执行。OpenMP 在每个并行区域的末尾强加了一个隐式屏障，因为它的 fork-join 执行模型要求只有主线程在并行区域之外运行。

这是一个示例程序（`ompt.cpp`）：

```
#include <stdio.h>
#include <unistd.h>
#include <omp.h>

void callback (int i)
{
   printf("[%02d] Task stated with thread %d\n", i, omp_get_thread_num());
   sleep(1);
   printf("[%02d] Task finished\n", i);
}

int main (void)
{
   #pragma omp parallel
   {
      #pragma omp single
      for (int i = 0; i < 10; i++)
      {
         #pragma omp task
         callback(i);
         printf("Task %d created\n", i);
      }
   }
   printf("Parallel region ended\n");

   return 0;
} 
```

编译和执行：

```
$ g++ -fopenmp -o ompt.x ompt.cpp
$ OMP_NUM_THREADS=4 ./ompt.x
Task 0 created
Task 1 created
Task 2 created
[01] Task stated with thread 3
[02] Task stated with thread 2
Task 3 created
Task 4 created
Task 5 created
Task 6 created
Task 7 created
[00] Task stated with thread 1
Task 8 created
Task 9 created
[03] Task stated with thread 0
[01] Task finished
[02] Task finished
[05] Task stated with thread 2
[04] Task stated with thread 3
[00] Task finished
[06] Task stated with thread 1
[03] Task finished
[07] Task stated with thread 0
[05] Task finished
[08] Task stated with thread 2
[04] Task finished
[09] Task stated with thread 3
[06] Task finished
[07] Task finished
[08] Task finished
[09] Task finished
Parallel region ended 
```

请注意，任务的执行顺序与创建它们的顺序不同。

GCC 不支持 4.4 之前版本的 OpenMP 3.0。无法识别的 OpenMP 指令将被静默忽略，生成的可执行文件将串行地执行该代码部分：

```
$ g++-4.3 -fopenmp -o ompt.x ompt.cpp
$ OMP_NUM_THREADS=4 ./ompt.x
[00] Task stated with thread 3
[00] Task finished
Task 0 created
[01] Task stated with thread 3
[01] Task finished
Task 1 created
[02] Task stated with thread 3
[02] Task finished
Task 2 created
[03] Task stated with thread 3
[03] Task finished
Task 3 created
[04] Task stated with thread 3
[04] Task finished
Task 4 created
[05] Task stated with thread 3
[05] Task finished
Task 5 created
[06] Task stated with thread 3
[06] Task finished
Task 6 created
[07] Task stated with thread 3
[07] Task finished
Task 7 created
[08] Task stated with thread 3
[08] Task finished
Task 8 created
[09] Task stated with thread 3
[09] Task finished
Task 9 created
Parallel region ended 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T06:57:22.230

例如看看[http://en.wikipedia.org/wiki/OpenMP](http://en.wikipedia.org/wiki/OpenMP)。

`#pragma omp for`

是你的朋友。OpenMP 不需要您考虑线程。您只需声明（！）您想要并行运行的内容，OpenMP 兼容编译器会在编译期间在您的代码中执行所需的转换。

OpenMP 的规格也很有趣。他们很好地解释了可以做什么以及如何做：http: [//openmp.org/wp/openmp-specifications/](http://openmp.org/wp/openmp-specifications/)

您的示例可能如下所示：

```
#pragma omp parallel for
for(int i=0; i<50; i++)
{
   doStuff();
   thread t;
   t.start(callback(i)); //each time around the loop create a thread to execute callback
} 
```

for 循环中的所有内容都是并行运行的。您必须注意数据依赖性。'doStuff()' 函数在您的伪代码中按顺序运行，但在我的示例中将并行运行。您还需要指定哪些变量是线程私有的，以及类似的变量也将进入#pragma 语句。

# smalltalk - 在 Squeak Smalltalk 中撤消删除方法

> ID：11182629
> 
> 赞同：8
> 
> 时间：2012-06-25T01:42:53.243
> 
> 标签：smalltalk, squeak

如何撤消 Squeak Smalltalk 中删除的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-25T02:51:29.030

1.  '世界菜单'->'打开'->'简单的更改排序器'
2.  在右上角的窗格中，选择从中删除方法的类。
3.  在中间窗格中，选择已删除的方法。
4.  右键单击方法名称，弹出菜单
5.  选择“版本”
6.  当版本工具出现时，选择顶部（最新）版本，即您删除的版本。
7.  单击“还原”按钮

当您浏览您的类时，您将看到该方法已恢复。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T05:14:36.420

如果您使用 OmniBrowser 和重构工具，您可以像在任何其他现代编辑器中一样，对所有代码更改进行无限制的撤消/重做。在上下文菜单中选择*Refactor* > *Undo*。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-25T09:40:13.090

您可以打开更改文件：

*   屏幕顶部的工具菜单。
*   文件列表（应该在正确的位置打开）。
*   在右上角的窗格中选择更改文件（给定一个名为 Foo.image 的图像，您将查找 Foo.changed）。
*   点击“最近更改”按钮，浏览至最新（顶部）快照。
*   所有方法的添加、更改、删​​除、DoIt 都会在弹出的列表中列出。
*   选择您想要的方法，右键单击（我*永远不*记得鼠标按钮的颜色）和“fileIn selections”。

# opengl - glBlitFramebuffer 导致 OpenGL 错误

> ID：11182632
> 
> 赞同：0
> 
> 时间：2012-06-25T01:43:14.823
> 
> 标签：opengl, graphics

我想使用多重采样抗锯齿并将我绘制的内容保存到 BMP。我使用 FBO 进行多重采样和普通 FBO。我参考了这篇文章：[GL_framebuffer_multisample](http://www.opengl.org/wiki/GL_EXT_framebuffer_multisample)。

但是当我使用**glBlitFramebuffer**将数据从 FBO 复制以进行多重采样到普通 FBO 时，会发生 OpenGL 错误。现在我在这里发布部分代码：

首先，创建两个 FBO：

```
glGenFramebuffers(1,&m_frameBuffer);
glBindFramebuffer(GL_FRAMEBUFFER,m_frameBuffer);

glGenRenderbuffers(1,&m_renderBufferColor);
glBindRenderbuffer(GL_RENDERBUFFER,m_renderBufferColor);
//在FBO里开启多重采样
glRenderbufferStorageMultisample(GL_RENDERBUFFER,4,
    GL_RGB,m_subImageWidth,m_subImageHeight);
glFramebufferRenderbuffer(GL_FRAMEBUFFER,GL_COLOR_ATTACHMENT0,
    GL_RENDERBUFFER,m_renderBufferColor);

glGenRenderbuffers(1,&m_renderBufferDepth);
glBindRenderbuffer(GL_RENDERBUFFER,m_renderBufferDepth);
glRenderbufferStorageMultisample(GL_RENDERBUFFER,4,
    GL_DEPTH_COMPONENT24,m_subImageWidth,m_subImageHeight);
glFramebufferRenderbuffer(GL_FRAMEBUFFER,GL_DEPTH_ATTACHMENT,
    GL_RENDERBUFFER,m_renderBufferDepth);

glBindFramebuffer(GL_FRAMEBUFFER,0);//解除绑定

//generate standard FBO for blitting
glGenFramebuffers(1,&m_frameBufferBlit);
glBindFramebuffer(GL_FRAMEBUFFER,m_frameBufferBlit);

glGenRenderbuffers(1,&m_renderBufferColorBlit);
glBindRenderbuffer(GL_RENDERBUFFER,m_renderBufferColorBlit);
glRenderbufferStorage(GL_RENDERBUFFER,GL_RGB,
    m_subImageWidth,m_subImageHeight);
glFramebufferRenderbuffer(GL_FRAMEBUFFER,GL_COLOR_ATTACHMENT0,
    GL_RENDERBUFFER,m_renderBufferColorBlit);

glGenRenderbuffers(1,&m_renderBufferDepthBlit);
glBindRenderbuffer(GL_RENDERBUFFER,m_renderBufferDepthBlit);
glRenderbufferStorage(GL_RENDERBUFFER,GL_DEPTH_COMPONENT24,
    m_subImageWidth,m_subImageHeight);
glFramebufferRenderbuffer(GL_FRAMEBUFFER,GL_DEPTH_ATTACHMENT,
    GL_RENDERBUFFER,m_renderBufferDepth);

glBindFramebuffer(GL_FRAMEBUFFER,0);//解除绑定 
```

然后画点东西：

```
glBindFramebuffer(GL_FRAMEBUFFER,m_frameBuffer);
GLenum status = glCheckFramebufferStatus(GL_FRAMEBUFFER);
if (status != GL_FRAMEBUFFER_COMPLETE)
{
    cout << "The frame buffer status is not complete!" << endl;
    return;
}

drawing();//draw something
glBindFramebuffer(GL_FRAMEBUFFER,0);

    int temp1 = GLUtils::checkForOpenGLError(__FILE__,__LINE__);
    //blitting
    glBindFramebuffer(GL_DRAW_FRAMEBUFFER,m_frameBufferBlit);
    glBindFramebuffer(GL_READ_FRAMEBUFFER,m_frameBuffer);

    int temp2 = GLUtils::checkForOpenGLError(__FILE__,__LINE__);
    glBlitFramebuffer(0,0,m_subImageWidth,m_subImageHeight,
        0,0,m_subImageWidth,m_subImageHeight,
        GL_COLOR_BUFFER_BIT,GL_LINEAR);
    int temp3 = GLUtils::checkForOpenGLError(__FILE__,__LINE__);
    glBindFramebuffer(GL_READ_FRAMEBUFFER,0);
    glBindFramebuffer(GL_DRAW_FRAMEBUFFER,0);

    //glBindFramebuffer(GL_FRAMEBUFFER,m_frameBuffer);
    glBindBuffer(GL_PIXEL_PACK_BUFFER,m_subImageBuffer[i]);
    glPixelStorei(GL_PACK_ALIGNMENT,1);

    glBindFramebuffer(GL_FRAMEBUFFER,m_frameBufferBlit);
    //注意：以BGR的顺序读取
    glReadPixels(0,0,m_subImageWidth,m_subImageHeight,
        GL_BGR,GL_UNSIGNED_BYTE,bufferOffset(0));
    int temp4 = GLUtils::checkForOpenGLError(__FILE__,__LINE__);
    m_subPixels[i] = static_cast<GLubyte*>(glMapBuffer(GL_PIXEL_PACK_BUFFER,GL_READ_ONLY));
    if (m_subPixels[i] == NULL)
    {
        cout << "NULL pointer" << endl;
    }
    gltGenBMP(subImageFile[i],GLT_BGR,m_subImageWidth,m_subImageHeight,m_subPixels[i]);
    glUnmapBuffer(GL_PIXEL_PACK_BUFFER);
    glBindBuffer(GL_PIXEL_PACK_BUFFER,0);

    glBindFramebuffer(GL_FRAMEBUFFER,0); 
```

函数**GLUtils::checkForOpenGLError**用于检查是否发生 OpenGL 错误（返回 1 表示发生错误）。**绘图**是渲染东西。函数**gltGenBMP**是将数据保存为BMP。它们都工作得很好。我发现temp1和temp2是0，temp3和temp4是1。所以我得出一个结论：有问题使用函数**glBlitFramebuffer**。但是为什么呢？是否有任何设置错误？

* * *

**更新：** 当我检查正常的 FBO m_frameBufferBlit 时：

```
glBindFramebuffer(GL_DRAW_FRAMEBUFFER,m_frameBufferBlit);
status = glCheckFramebufferStatus(GL_DRAW_FRAMEBUFFER);
if (status != GL_FRAMEBUFFER_COMPLETE)
{
    cout << "The frame buffer status is not complete!" << endl;
    return;
} 
```

我发现它不完整。所以我没有正确创建 FBO？

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T17:40:04.763

回忆一下帧缓冲区完整性的条件可能很有用：

*   必须至少有一个图像附加到帧缓冲区
*   所有附件必须是附件完整的
*   所有活动的绘图缓冲区都必须有一个关联的图像
*   读取缓冲区（如果处于活动状态）必须具有关联的图像
*   所有附加图像必须具有相同数量的样本

以及附件图像完整性的条件：

*   图像的宽度和高度必须非零
*   图像内部格式必须与附件点匹配（*例如：深度图像必须附加到深度附件*）

请注意，这些规则是[实际规则](http://www.opengl.org/wiki/Framebuffer_Object#Completeness_Rules)的简化，稍微复杂一些。

# android - 如何在未完成加载上下文的情况下显示 toast

> ID：11182633
> 
> 赞同：1
> 
> 时间：2012-06-25T01:43:28.223
> 
> 标签：android, notifications, toast

我的游戏需要很长时间才能从后台加载。在加载期间，屏幕是黑色的（大约 5-7 秒，所以用户可能会认为它崩溃了）。

我决定在进入前台时显示祝酒词。

```
 protected void onResume() {

        System.out.println("onResume method called");
        Context context = getBaseContext();
//      Context context = getApplicationContext();
        CharSequence text = "i appreciate your patience";

        Toast toast = Toast.makeText(context, text, Toast.LENGTH_LONG);

        toast.show();

        super.onResume();
        wl.acquire();
        if (accelerometerEnabled) {
            accelerometer.enable();
        }
    } 
```

但是吐司只有在它完成恢复后才会出现（这使得它无用）我已经尝试过 getApplicationContext、getBaseContext 以及 Activity 本身。那么是否可以在没有我的应用程序上下文的情况下直接在窗口上添加吐司？（可能在系统级上下文中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T01:49:23.733

我认为这与您从后台返回时在 UI 线程上加载的游戏有关

尝试将所有非 UI 线程相关逻辑移动到 AsyncTask 中。

这应该让您的 toast 消息在您的游戏加载时可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:25:46.563

这是启动屏幕可能有用的地方。只需在 xml 中放置一个覆盖所有 UI 的启动屏幕，然后在异步任务中启动加载过程。在 asynctask 的 onPostExecute 上，将启动布局的可见性设置为 Gone。

不要忘记处理方向变化。

# cassandra - Cassandra 中的数据与 Quorum 配置不一致

> ID：11182637
> 
> 赞同：4
> 
> 时间：2012-06-25T01:44:06.883
> 
> 标签：cassandra, hector, consistency

当我们有 Quorum 进行读写时，我在使用 Hector 和 Cassandra 时遇到了一致性问题。

我使用 MultigetSubSliceQuery 从超级列限制大小 100 中查询行，然后读取它，然后将其删除。并开始另一个。

我发现应该由我之前的查询删除的行仍然显示在下一个查询中。

并且同样从一个普通的Column Family，我将一列的值从status='FALSE'更新为status='TRUE'，下次查询时，status还是'FALSE'。

更多详情：

1.  并非每次都发生（1/10,000）
2.  两个查询之间的时间大约是 500 毫秒（但我们发现一对查询之间已经过去了 2 秒，仍然表明存在一致性问题）
3.  我们使用 ntp 作为我们的集群时间同步解决方案。
4.  我们有 6 个节点，复制因子为 3

我知道 Cassandra 应该是“最终一致的”，并且在 Cassandra 内部写入之前可能不会发生读取。但是两秒钟？！如果是这样，那么拥有 Quorum 或其他一致性级别配置是否毫无意义？

那么首先，Cassandra 的行为是否正确，如果不是，我们需要分析哪些数据来进一步投资？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T06:54:01.423

用系统日志查看源代码后，找到了不一致的根本原因。导致问题的三个因素：

*   **从不同节点**创建和更新相同的记录
***   本地系统**时间同步**不够准确（虽然我们使用 NTP）*   一致性级别是**QUORUM****

 **这就是问题所在，以following为事件序列

```
 seqID   NodeA         NodeB          NodeC
 1\.      New(.050)     New(.050)      New(.050)
 2\.      Delete(.030)  Delete(.030) 
```

首先**创建**请求来自**节点 C**，本地时间戳为**00:00:00.050**，假设请求首先记录在**节点 A**和**节点 B**中，然后再与**节点 C**同步。

然后**删除**请求来自**节点 A**，本地时间戳为**00:00:00.030**，并记录在**节点 A**和**节点 B**中。

当**读取**请求来时，Cassandra 会进行版本冲突合并，但合并**只依赖于时间戳**，所以虽然**Delete**发生在**Create**之后，但由于本地时间同步问题，合并最终结果是“ **New** ”，它具有最新的时间戳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-03T16:05:03.097

我也面临类似的问题。出现此问题是因为 cassandra 驱动程序默认使用服务器时间戳来检查哪个查询是最新的。然而，在最新版本的 cassandra 驱动程序中，他们对其进行了更改，现在默认情况下他们使用客户端时间戳。

我在[这里描述了问题的细节](http://www.amandeepkamboj.com/index.php/2015/12/03/cassandra-db-query-timestamp-sync/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T21:35:00.437

由于分布式删除的工作方式，已删除的行可能显示为“范围幽灵”：请参阅[http://wiki.apache.org/cassandra/FAQ#range_ghosts](http://wiki.apache.org/cassandra/FAQ#range_ghosts)

如果您在 CL_QUORUM 读取*和*写入单个列，那么无论时间间隔如何，您都应该始终获得完全一致性（假设仍然遵守严格的顺序，即您确定读取始终在写入之后）。如果您没有看到这一点，那么某处某处是错误的。

首先，我建议 a) 验证客户端是否正确同步到 NTP，和/或以某种方式在客户端之间交叉检查时间重现问题，以及 b) 可能尝试使用 CL_ALL 重现问题。

另一个想法 - 您的*客户端*是与 NTP 同步，还是仅与 Cassandra 服务器节点同步？请记住，Cassandra 使用*客户端*时间戳来确定哪个值是最新的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-26T11:49:46.387

我的一个客户端/节点遇到了这个问题。我正在测试的其他 2 个客户端（和 2 个其他节点）运行顺利。我有一个在所有读取和所有写入中都使用 QUORUM 的测试，它很快就失败了。实际上，某些进程看不到其他进程的任何内容，而其他进程即使在我 QUORUM 删除数据后也可能始终看到数据。

在我的例子中，我打开了日志并打算使用 tail -F 命令测试这个壮举：

```
tail -F /var/lib/cassandra/log/system.log 
```

看看我是否遇到了这里提出的一些错误。令我惊讶的是，尾部进程本身返回了一个错误：

```
tail: inotify cannot be used, reverting to polling: Too many open files 
```

从另一个线程这意味着某些进程将无法打开文件。换句话说，Cassandra 节点可能没有按预期响应，因为它无法正确访问磁盘上的数据。

我不太确定这是否与发布问题的用户有关，但 tail -F 肯定是确定是否达到文件限制的好方法。

（仅供参考，我有 5 台相对较重的服务器在同一台机器上运行，所以我对此事实并不感到惊讶。我将不得不考虑增加 ulimit。如果我以这种方式修复它，我会再次在这里报告.)

有关文件限制和 ulimit 命令行选项的更多信息：[https ://askubuntu.com/questions/181215/too-many-open-files-how-to-find-the-culprit](https://askubuntu.com/questions/181215/too-many-open-files-how-to-find-the-culprit)

--------- 更新 1

为了以防万一，我首先使用 Oracle 的 Java 1.7.0-11 进行了测试（如下所述，我第一次使用了 3,000 的限制但没有成功！）在运行我的 Cassandra 测试时会在大约同一时间弹出相同的错误（甚至在 ulimit 为 3,000 的情况下，仍会出现 tail -F 错误...）

--------- 更新 2

好的！那行得通。我将 ulimit 更改为 32,768，问题就消失了。请注意，我必须扩大每个用户的限制`/etc/security/limits.conf`并运行`sudo sysctl -p`，然后才能将最大值提高到如此高的数字。不知何故，默认的上限 3000 是不够的，即使旧的限制*只有*1024。**

# python - Python中的Google应用引擎数据存储日期时间？

> ID：11182638
> 
> 赞同：4
> 
> 时间：2012-06-25T01:44:13.993
> 
> 标签：python, google-app-engine, datetime, date, time

我一直讨厌管理日期、时间、日期时间以及它们所需的各种格式和转换的头痛。我正在参加有关使用 google app 引擎的在线课程，它说要使用 datetime 属性，该属性以以下格式返回日期：

`2012-06-25 01:17:40.273000`

我试过

`datetime.strptime('2012-06-25 01:17:40.273000','%y-%m-%d %H:%M:%S')`

但它没有用..

我只想在`2012-06-25`不使用 hacky 正则表达式或字符串切片解决方案的情况下提取部分。

如何解析并将其转换为正确的格式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T01:51:33.477

终于找到了（在提出问题后不久，但我过去一个小时一直在尝试）

```
datetime.strptime('2012-06-25 01:17:40.273000','%Y-%m-%d %H:%M:%S.%f') 
```

我想要什么：

```
datetime.strptime('2012-06-25 01:17:40.273000','%Y-%m-%d %H:%M:%S.%f').strftime('%m-%d-%Y') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-25T04:05:05.373

如果您使用的是 datetime 属性，那么您返回的对象是 datetime 实例而不是字符串。

在控制台上

```
>>> from datetime import datetime
>>> x = datetime.now()
>>> print x
2012-06-25 12:03:15.835467
>>> x.date()
datetime.date(2012, 6, 25)
>>> 
>>> print x.date()
2012-06-25
>>> 
```

请参阅打印声明。它执行到字符串的隐式转换。如果您在模板中输出 datetime 属性值，这可能就是正在发生的事情。

因此，在您的代码中，您应该只在 datetime 对象上使用 .date() 方法。

# scala - 使用 Scala 案例类建模

> ID：11182642
> 
> 赞同：6
> 
> 时间：2012-06-25T01:44:39.363
> 
> 标签：scala, pattern-matching, case-class, extractor

我正在尝试将来自 REST API 的响应建模为可以使用模式匹配的案例类。

我认为假设继承会很合适，但我发现这已被弃用。我知道已经存在与案例类和继承相关的问题，但我的问题更多是关于如何在*没有*继承的情况下在此处按照“正确方式”建模。

我从以下两个案例类开始，它们工作正常：

```
case class Body(contentType: String, content: String)
case class Response(statusCode: Int, body: Body) 
```

即 REST 调用将返回类似以下内容：

```
Response(200, Body("application/json", """{ "foo": "bar" }""")) 
```

我可以像这样进行模式匹配：

```
response match {
  case Response(200, Body("application/json", json)) => println(json)
  case Response(200, Body("text/xml", xml)) => println(xml)
  case Response(_,_) => println("Something unexpected")
} 
```

等等，效果很好。

我遇到麻烦的地方是：我想要这些案例类的辅助扩展，例如：

```
case class OK(body: Body) extends Response(200, body)
case class NotFound() extends Response(404, Body("text/plain", "Not Found"))

case class JSON(json: String) extends Body("application/json", json)
case class XML(xml: String) extends Body("text/xml", xml) 
```

这样我就可以像这样进行简化的模式匹配：

```
response match {
  case OK(JSON(json)) => println(json)
  case OK(XML(xml)) => println(xml)
  case NotFound() => println("Something is not there")

  // And still drop down to this if necessary:
  case Response(302, _) => println("It moved")
} 
```

并且还允许我的 REST 代码直接使用和返回：

```
Response(code, Body(contentType, content)) 
```

这更容易动态地建立响应。

所以...

我可以通过以下方式编译它（带有弃用警告）：

```
case class OK(override val body: Body) extends Response(200, body) 
```

但是，这似乎不适用于模式匹配。

```
Response(200, Body("application/json", "")) match {
  case OK(_) => ":-)"
  case _ => ":-("
}
res0: java.lang.String = :-( 
```

关于这如何工作的任何想法？我对不同的方法持开放态度，但这是我为案例类寻找实际用途的尝试

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-25T02:08:29.840

[案例类不应该被子类化](https://stackoverflow.com/questions/4653424/what-are-the-disadvantages-to-declaring-scala-case-classes)有几个原因。在您的情况下，问题变成`OK`了 (a subtype of) 之外的另一种类型`Response`，因此匹配失败（即使参数匹配，类型也不匹配）。

相反，您将需要[自定义提取器](http://www.scala-lang.org/node/112)。例如：

```
case class Response(code: Int, body: String)
object OK {
  def apply(body: String) = Response(200, body)
  def unapply(m: Response): Option[String] = m match {
    case Response(200, body) => Some(body)
    case _                   => None
  }
}

def test(m: Response): String = m match {
   case OK(_) => ":-)"
   case _     => ":-("
}

test(Response(300, "Hallo"))  // :-(
test(Response(200, "Welt"))   // :-)
test(OK("Welt"))              // :-) 
```

[此线程](https://stackoverflow.com/questions/6738577/matching-with-custom-combinations-operators?lq=1)中还有一些自定义提取器的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T08:02:13.837

你看过未经过滤的 scala 库吗？ [http://unfiltered.lessis.me/](http://unfiltered.lessis.me/) 它可以帮助您解决问题。高温高压

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T17:20:48.303

虽然 0__ 提到的自定义提取器当然可以使用，但您将失去密封类型层次结构的详尽保证。虽然在您在问题中给出的示例中没有任何内容`sealed`，但问题非常适合他们。

在这种情况下，我的建议是简单地确保`case class`始终位于类型层次结构的底部，并使上层类正常。例如：

```
sealed class Response(val statusCode: Int, val body: Body) sealed
case class Ok(override val body: Body) extends Response(200, body)
sealed class NotOk(statusCode: Int, body: Body) extends Response(statusCode, body)
case object NotFound extends NotOk(404, "Not found")
// and so on... 
```

# javascript - 如何将 javascript yml 字符串移动到数据库到 ruby 数组

> ID：11182645
> 
> 赞同：0
> 
> 时间：2012-06-25T01:45:50.187
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, yaml

我有一个可以创建 yaml 字符串的 javascript 函数。然后，我将该 yaml 字符串放入表单中的 hidden_​​field 中，以便在提交表单时将字符串加载到数据库列中。然后我的问题是干净地读取该列并将 yml 表示形式放入一个 ruby​​ 哈希数组。我必须处理的部分内容是 \r\n 以文本形式存储在 db 列中。是的，我玩过序列化列，但由于 hidden_​​field 是文本......

我找不到一个干净的方法来做到这一点。我的 yaml 字符串大致如下所示：

```
chapter:
  title: foo
    rating: awful
    words: 1000
  title: bar
    rating: fun
    words: 3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T01:57:41.887

这不是一个好的架构。您的 YAML 代表一个对象，应存储为具有属性的对象。存储序列化数据（是的 YAML 算作序列化）是一种不好的做法。

Ruby 轻松处理 YAML

如果您使用的是 ruby​​ 1.8.X，则需要 psych gem

[http://rubygems.org/gems/psych](http://rubygems.org/gems/psych)

例子：

```
require 'rubygems' #necessary only for 1.8.X
require 'yaml'

##Load a YAML string into a ruby Hash
ruby_hash = YAML.load(my_yaml_string)

##Get YAML string from ruby Hash
yaml_string = YAML.dump(ruby_hash) 
```

# many-to-many - CRM 允许重复记录 N:N 关系

> ID：11182646
> 
> 赞同：0
> 
> 时间：2012-06-25T01:45:51.907
> 
> 标签：many-to-many, entity, duplicates, crm

我有两个实体“A”和“B”，其中 B 是与父 A 相关的实体。关系类型是 N:N 关系，我想从“B”添加记录的多个实例。例如，我想要“A”记录下的“B_1”记录的两个实例。我怎样才能做到这一点？

CRM 不允许并给出错误：“具有这些值的记录已存在。无法创建重复记录。选择一个或多个唯一值并重试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T09:08:05.197

我刚刚发布了一篇关于此的文章，您可以在此处阅读：[在 N:N-Relations 中添加重复项](http://jonasrapp.cinteros.se/2012/07/adding-duplicates-in-nn-relations.html)

# android - Android上的CDMA PDU解析

> ID：11182650
> 
> 赞同：2
> 
> 时间：2012-06-25T01:48:18.313
> 
> 标签：android, sms, cdma, pdu

我编写了一个程序来解码 CDMA 3GPP2 点对点 SMS 消息。我在网上找到的几个 CDMA PDU 十六进制字符串上对其进行了测试，效果很好。但是，当我尝试在 Android 平台上的所有传入短信上实现它时，它总是失败。

我查看了传入的 PDU，它似乎没有遵循我习惯看到的相同模式。谁能解释这个 PDU 是什么格式，或者我缺少什么来正确解码这个 PDU？是否有我没有考虑的其他标题或字段？

从我手机上的传入短信中提取的 PDU 示例：

```
000000000000100200000000000000000A36373839313031363734000000000000000000001B000310864D000306120624205611010B104C2CF9F3F5EBD73E7000 
```

我发现并测试了我的解析器的所有 CDMA pdus 看起来更像：

```
00000210020207028CE95DCC65800601FC08150003168D3001061024183060800306101004044847 
```

运营商：`Verizon` 电话：`Samsung Galaxy S Fascinate`跑步`Android 2.3.3`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T19:05:36.863

请参阅 $SDK/sources/android-16/com/android/internal/telephony/cdma/SmsMessage 中的 javadoc：

```
/**
 * Creates byte array (pseudo pdu) from SMS object.
 * Note: Do not call this method more than once per object!
 */ 
```

...所以它没有遵循任何特定的 CDMA 标准。但是，您可以对其进行解码；所以在精美的 ASCII 艺术中：-

```
000000000000100200000000000000000A36373839313031363734000000000000000000001B000310864D000306120624205611010B104C2CF9F3F5EBD73E7000
--------messageType     --digitMode                   --------bearerReply   ------------------------------------------------------bearer data
        --------teleService --ton --------------------src     --replySeqNo  --messageID --msts          --userdata
                --------serviceCategory                         --errorClass  --len   --XX--len           --len
                          --numberMode                            --causeCode   ------      ------------2012/06/24 20:56:11
                              --npi                                 --------bearerDataLength                ----------------------userdata
                                --len 
```

请注意，我认为您在消息中犯了剪切/粘贴错误 - 我认为标记为“XX”的 00 字节不应该存在 - 幸运的是，很容易发现日期并向后工作。所以这是来自 6789101674 的带有用户数据的消息：

104C2CF9F3F5EBD73E7000，前五位表示它是7位编码的（0x02）。将用户数据的剩余部分向左移动了 5 位，我们得到了：

```
09859f3e7ebd7ae7ce00
--len(septets) 9 septets == 63 bits, so we expect 8 bytes of body
  ----------------7bit-body 
```

所以你解码的 7 位体是“Bggguuugg”。

# wpf - 如何强制对窗口进行垃圾收集？

> ID：11182651
> 
> 赞同：4
> 
> 时间：2012-06-25T01:48:22.540
> 
> 标签：wpf, memory-leaks

我正在尝试通过保持对对象的额外弱引用来主动确保我不会导致代码中的内存泄漏，并在应该释放它时检查它是否不再活动（这是条件代码，因此它仅在我运行时运行正在测试）。

为了简单地重现我看到的效果，创建一个新的 WPF 应用程序并在主窗口上放置一个按钮。创建另一个窗口，并在其上放置一个 TextBox。在按钮的单击处理程序中，输入以下代码：

```
 Window1 w = new Window1();
  WeakReference weak = new WeakReference(w);
  w.ShowDialog();
  w = null;
  // Equivalent to Application.DoEvents() just in case...
  Application.Current.Dispatcher.Invoke(DispatcherPriority.Background, new Action(delegate { }));
  GC.Collect();
  GC.WaitForPendingFinalizers();
  if (weak.Target != null)
    MessageBox.Show("Memory Leak"); 
```

当你运行它时，单击按钮，当窗口显示时，只需单击“x”将其关闭，什么都没有发生——一切都很好。现在做同样的事情，但是当窗口显示时，单击文本框，然后单击“x”。我每次都会收到“内存泄漏”消息。

Ants Profiler 显示 System.Windows.Documents.TextEditor 具有对 TextBox 的引用（可能仅在您聚焦 TextBox 时才设置），并且 TextBox 具有对窗口的引用。它不是真正的内存泄漏，因为如果您多次执行该过程，则会收集以前的窗口，而不是最新的。但是，这意味着我无法编写确认内存没有泄漏的测试。

我是唯一需要这种程度的保证的人，还是有其他方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T08:50:13.093

我想有些人错过了你的问题的重点。您不是试图强迫 GC 的手，而是先发制人地发现任何内存泄漏，为此我为您鼓掌。

在这种特殊情况下，似乎`TextEditor`（即`internal`）正在添加事件处理程序，并且在您的检查运行时还没有机会分离。您是否尝试过在启动调度程序之前明确地将焦点从关闭的窗口中移出？

我认为如果您尝试在您的应用程序中进行这些测试，而不是在更受控制的集成测试环境中进行这些测试，您将继续遇到此类问题，因此您可能需要重新考虑您的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:01:10.680

如果以前的实例被收集，这不是内存泄漏。垃圾收集器并不总是获取最新的项目，这是设计使然。如果您尝试事后猜测，您可能会遇到问题。

在真正的内存泄漏中，项目会累积而不会被回收。这是使用探查器最好检测到的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:18:09.457

Windows 不仅由您的代码管理，还由一些 WPF 类（如`Application`. 调用`Collect`并不能保证或证明任何事情，窗口最终会被收集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:58:24.357

尝试使用 DispatcherPriority。**上下文空闲**

```
Dispatcher.CurrentDispatcher.Invoke( DispatcherPriority.ContextIdle, new System.Action(delegate { })); 
```

# mysql - 非常大的字段对 MySQL 数据库有负面影响吗？

> ID：11182652
> 
> 赞同：2
> 
> 时间：2012-06-25T01:48:54.523
> 
> 标签：mysql, database, django

我目前正在使用 Django 构建一个网站，并希望托管可能高达数 KB 的用户生物样式页面。这些字段不一定需要搜索，但需要在查找用户名时提供。

将这些数据存储在数据库中会产生负面影响吗？如果我在数据库中使用带有链接的静态文本文件，我的服务器会运行得更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T01:50:57.640

您可以将它们存储在数据库中，它们可能不会成为您性能的瓶颈。确保列类型设置为[TEXT](http://dev.mysql.com/doc/refman/5.0/en/blob.html)，MySQL 将尽可能智能地处理该数据以避免性能问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T01:56:34.537

您问题的基本答案是“将数据存储在 MySql 中”（相对于外部文本文件）：将数据存储在数据库中绝对是这里最好的方法。

“BLOB”可以是一个通用术语——在这种情况下，Oleksi 是绝对正确的（我将他标记为 +1，而不是向下！）。

但是你要的具体MySql类型确实是TEXT：

*   [http://dev.mysql.com/doc/refman/5.0/en/blob.html](http://dev.mysql.com/doc/refman/5.0/en/blob.html)

在您的 mySql 数据库中存储为 TEXT 将有很多好处（包括但不限于“性能”）。

将文本存储在我能想到的外部文件中没有任何好处。

PS：

我有一个旧的 PHP/MySQL Web 应用程序，它使用一个非常旧的版本，该版本早于 MySQL 中的自由文本搜索。如果我不能将它移植到新服务器，我正在认真考虑将所有“笔记”数据保存在外部文件中，这样我就可以针对文本运行像“Lucene”这样的索引器。但这是规则的例外。几乎可以肯定，在您的情况下，存储在数据库中是最佳选择。恕我直言...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T03:43:54.823

正如@Oleksi 和@paulsm4 所讨论的，出于他们讨论的所有原因，将数据存储在数据库中可能是有益的。但是，他们没有提到您可能不想这样做的原因：

1.  如果在查询优化期间 BLOB 或 TEXT 列最终出现在临时表中，则该表最终会在磁盘上，即使它足够小，它本来应该在内存中。因此，除非您知道自己需要，否则应尽量避免选择 BLOB 或 TEXT 列；绝对应该避免`select *`（无论如何这是一个好习惯）。

2.  BLOB/TEXT 列存储在数据库中。假设它是相对静态的内容，您可以通过在专用的低开销 httpd 服务/缓存后面将它们作为静态文件来提供性能/可扩展性/成本优势。

3.  在 BLOB 表示媒体的情况下，最好将其存储在外部的专用流服务后面。

4.  在内容发生更改的情况下，将数据存储在外部比存储在数据库中更容易合并版本控制。

5.  BLOB/TEXT 列将与表的其余部分存储在同一台服务器上。BLOB/TEXT 访问通常具有与表/索引访问非常不同的读取模式。这意味着对 BLOB/TEXT 的访问会污染您的缓冲区缓存，从而影响您的数据库性能；并且，表/索引访问会干扰顺序读取调度，影响 BLOB/TEXT 性能。

现在当然 2 和 5 仅适用于您达到数据库服务器的性能限制的情况；3和4是比较特殊的情况；并且，1通常可以通过拆分表或重写相关查询来解决。因此，大多数情况下这些都不适用，从问题来看，它们也不适用于您的情况；但是，通常正确的建议“使用 BLOB/TEXT”确实有其例外，理解它们是什么是非常值得的。

# iphone - [UILabel setImage:]：发送到实例的无法识别的选择器

> ID：11182656
> 
> 赞同：1
> 
> 时间：2012-06-25T01:49:30.903
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我已经使用调试器和断点来确定我收到错误的代码行，我将向您展示...

```
for (NSString *s in golferFourIconCounter) {

        if(s != nil) {
            int sint = [s intValue];
            switch (sint) {
                case 1:
                    iconNum = @"Num1.png";
                    break;
                case 2:
                    iconNum = @"Num2.png";
                    break;
                case 3:
                    iconNum = @"Num3.png";
                    break;
                case 4:
                    iconNum = @"Num4.png";
                    break;
                case 5:
                    iconNum = @"Num5.png";
                    break;
                case 6:
                    iconNum = @"Num6.png";
                    break;
                case 7:
                    iconNum = @"Num7.png";
                    break;
                case 8:
                    iconNum = @"Num8.png";
                    break;
                case 9:
                    iconNum = @"Num9.png";
                    break;

                default:
                    break;
            }

            switch (ids) {
                case 0:
                    imageTitle = @"GolfEagle.jpg";
                    break;
                case 1:
                    imageTitle = @"Birdie.png";
                    break;
                case 2:
                    imageTitle = @"Par.png";
                    break;
                case 3:
                    imageTitle = @"Bogey.png";
                    break;
                case 4:
                    imageTitle = @"Double-Bogey.png";
                    break;
                case 5:
                    imageTitle = @"Triple-Bogey.png";
                    break;
                case 6:
                    imageTitle = @"GolfSandie.png";
                    break;
                case 7:
                    imageTitle = @"Greenie.png";
                    break;
                case 8:
                    imageTitle = @"Polie.png";
                    break;
                case 9:
                    imageTitle = @"Dart.png";
                    break;
                case 10:
                    imageTitle = @"Three-Jack.png";
                    break;
                case 11:
                    imageTitle = @"Arnie.png";
                    break;
                case 12:
                    imageTitle = @"Ladie.png";
                    break;
                case 13:
                    imageTitle = @"Barkie.png";
                    break;
                case 14:
                    imageTitle = @"Hole-In-One.png";
                    break;
                case 15:
                    imageTitle = @"Fairway.png";
                    break;
                default:
                    break;
            }

            iid = iid+41;

            NSLog(@"%d --- %@",iid, iconNum);
            [(UIImageView*)[self.view viewWithTag:iid] setImage:[UIImage imageNamed:iconNum]];

            iid = iid-41;
            int rr = 401900;
            rr++;
            rr = rr+iid;

            [(UIImageView*)[self.view viewWithTag:rr] setImage:[UIImage imageNamed:imageTitle]];
            iid++;
        }

        ids++;
    } 
```

代码在此特定代码行上失败...（在 for 循环结束时）

```
[(UIImageView*)[self.view viewWithTag:iid] setImage:[UIImage imageNamed:iconNum]]; 
```

这没有任何意义，因为当我在代码中明确使用 UIImageView 时出现错误 - (UILabel setImage)？

这是调试器中记录的内容...

```
2012-06-24 21:41:58.518 Dot Golf Scoring[2811:15203] 57 --- (null)
2012-06-24 21:41:58.519 Dot Golf Scoring[2811:15203] 58 --- (null)
2012-06-24 21:41:58.520 Dot Golf Scoring[2811:15203] 59 --- (null)
2012-06-24 21:41:58.522 Dot Golf Scoring[2811:15203] 60 --- (null)
2012-06-24 21:41:58.549 Dot Golf Scoring[2811:15203] 61 --- (null)
2012-06-24 21:41:58.561 Dot Golf Scoring[2811:15203] 62 --- (null)
2012-06-24 21:41:58.562 Dot Golf Scoring[2811:15203] 63 --- (null)
2012-06-24 21:41:58.563 Dot Golf Scoring[2811:15203] 64 --- (null)
2012-06-24 21:41:58.564 Dot Golf Scoring[2811:15203] 65 --- (null)
2012-06-24 21:41:58.565 Dot Golf Scoring[2811:15203] 66 --- (null)
2012-06-24 21:41:58.566 Dot Golf Scoring[2811:15203] 67 --- (null)
2012-06-24 21:41:58.567 Dot Golf Scoring[2811:15203] 68 --- (null)
2012-06-24 21:41:58.567 Dot Golf Scoring[2811:15203] 69 --- (null)
2012-06-24 21:41:58.568 Dot Golf Scoring[2811:15203] 70 --- (null)
2012-06-24 21:41:58.569 Dot Golf Scoring[2811:15203] 71 --- (null)
2012-06-24 21:41:58.569 Dot Golf Scoring[2811:15203] -[UILabel setImage:]: unrecognized selector sent to instance 0x7f98b30
2012-06-24 21:41:58.570 Dot Golf Scoring[2811:15203] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[UILabel setImage:]: unrecognized selector sent to instance 0x7f98b30'
*** First throw call stack:
(0x153b022 0x30e2cd6 0x153ccbd 0x14a1ed0 0x14a1cb2 0xcbcd 0xabce 0x1c4a1e 0x1cd9bc 0x1c8818 0x3e4565 0x1cb857 0x1cb9bc 0x1cb9fc 0x533f4a 0x5284d0 0x153ce99 0x10014e 0x33ea0e 0x153ce99 0x10014e 0x1000e6 0x1a6ade 0x1a6fa7 0x1a6266 0x1253c0 0x1255e6 0x10bdc4 0xff634 0x16ceef5 0x150f195 0x1473ff2 0x14728da 0x1471d84 0x1471c9b 0x16cd7d8 0x16cd88a 0xfd626 0x288d 0x27f5 0x1)
terminate called throwing an exception(lldb) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:03:06.520

我会检查您的情节提要或笔尖以查找带有标签 71 或 72 的 UILabel。如果您真的遇到问题，您还可以通过编程方式对其进行跟踪，以便更容易找到：

```
UILabel *labelToChange = (UILabel *)[self.view viewWithTag:71];
labelToChange.backgroundColor = [UIColor greenColor]; 
```

当您使用它时，为什么不将第一个大长开关更改为简单的单线呢？

```
if (sint > 0 && sint < 10) iconNum = [NSString stringWithFormat:@"Num%d.png", sint]; 
```

# c# - 绑定前数据网格冻结

> ID：11182660
> 
> 赞同：0
> 
> 时间：2012-06-25T01:49:47.973
> 
> 标签：c#, asp.net, sql

我有一个带有旧数据网格的简单 ASP.net 页面。当用户单击按钮时，会运行一个 select 语句并将数据绑定到网格。问题是页面加载后，屏幕只是挂起。表中只有 1 条记录。

ASP页面

```
<asp:Button ID="buttonclick" OnClick="clickit" runat="server" Text="GO" /> 

<asp:DataGrid ID="mygrid"  runat="server" 
AutoGenerateColumns="true"></asp:DataGrid> 
```

代码背后

```
 public void clickit(Object sender, EventArgs e)
    {
         string sql = "SELECT a from table1";
        SqlConnection connection = new SqlConnection(connectionstring);
        SqlDataAdapter adap= new SqlDataAdapter(sql, connection);
        DataTable table = new DataTable();
        connection.Open();
        adap.Fill(table); //page reloads here, but hangs
        mygrid.DataSource = table;
       connection.Close();
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:16:46.000

我已经重构了你的代码，现在它应该可以工作了。

```
public void clickit(Object sender, EventArgs e)
{
    //call the function
    this.bindGrid();
}

 //function to populate the datagrid with the data from the datasource
   private void bindGrid()
   {
    string sql = "SELECT a from table1";
    SqlConnection connection = new SqlConnection(connectionstring);
    SqlDataAdapter adap= new SqlDataAdapter(sql, connection);
    DataTable table = new DataTable();
    connection.Open();
    adap.Fill(table); //page reloads here, but hangs
    mygrid.DataSource = table;
    //bind the control with the data in the datasource
    mygrid.DataBind();
   connection.Close();
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:26:25.050

分配 DataSource 后是否需要调用 mygrid.DataBind()？它可能不会挂。它可能只是没有显示带有数据绑定的网格。

# java - 这个链表反向实现是如何工作的？

> ID：11182666
> 
> 赞同：1
> 
> 时间：2012-06-25T01:50:47.143
> 
> 标签：java, list, linked-list

我试图了解下面的反向`LinkedList`代码是如何工作的......

```
public void reverse(Node<T> h) {
  Node<T> d = new Node<T>();
  Node<T> t;
  while (h.next != null) {
     t = h.next; //temp nodes points to h.next (1st item in list)
     h.next = t.next; //h.next bypasses first node in list.
     t.next = d.next; //t.next points to d.next.. where is d.next pointing to?
     d.next = t; //d.next now points to t.
  }
   h.next = d.next;
  } 
```

这个过程是如何工作的？

图表会很棒。似乎一个列表中的节点被弹出并推入一个新列表？在这种情况下，是否`h`指向正在反转的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:34:49.027

更新我自己，以及对挑战的修订：

该算法确实有效，它只是以一种令人困惑的方式编写并且*不*包括第一个节点（它仅用于副作用），这本身就是一个......有问题的设计。

重写它以避免无用`d.next`和`t`更好的范围，使其更容易（并且对我来说可能）遵循：

```
public void reverse(Node<T> h) { // draw H under first node
  Node<T> d = null
  while (h.next != null) {
     Node<T> t = h.next;  // draw T under box at end of H arrow (remove any previous T)
     h.next = t.next;     // change arrow from H to end where arrow from box above T ends (no arrow for last element)
     t.next = d;          // draw arrow from box above T to box D is under (no arrow for first element)
     d = t;               // draw D under box (remove any previous D)
   }
   h.next = d;            // draw arrow from H to box D is under
} 
```

上箱子！

（我建议查看[Reverse a Linked-List](http://www.mytechinterviews.com/reverse-a-linked-list)中的代码，它是相同的概念，但更容易理解并且没有此实现的假头节点。）

* * *

~~我知道我说过“只画盒子”。所以，在你的更多评论之后，我画了盒子。（我假装我回到了大学;-)~~

~~但是，**我也无法让它工作**。我什至尝试过圈子。~~

~~我怀疑发布的代码*不是*一个有效的实现（现在其他人现在证明我错了这是一个公开的挑战；至少它可以让这个问题保持开放;-)~~

~~I have not been able to use it to reverse a list of 2, 3 or 4 elements in length after several attempts (although I have been able to successfully use the [much more intuitive] code presented in [Reverse a Linked-List](http://www.mytechinterviews.com/reverse-a-linked-list)).~~

~~I believe there is a flaw in using `h.next` instead of `h` as the "root" node. Perhaps the author is accounting for a `void` return with a dummy-node and side-effect? But in that case the line `h.next = t.next` still seems to break the algorithm.~~

# android - Android 4.0 ICS 奇怪行为中的 HTML5 Canvas onmousedown 事件

> ID：11182667
> 
> 赞同：0
> 
> 时间：2012-06-25T01:50:54.260
> 
> 标签：android, html, html5-canvas, onmousedown

我有一个使用 jQuery lib [Sketch.js](http://intridea.github.com/sketch.js/)的基本 HTML 绘图应用程序（它使用 <canvas>，在所有桌面浏览器上的 IE、Opera、Chrome、Firefox 上运行良好。在 Opera Mobile、Chrome Mobile、Firefox Mobile 上运行良好, Dolphin HD, Android股票浏览器2.2.4。

*但是，当我在平板电脑或手机上的 Android 4.0 股票浏览器上对其进行测试时，当我按下 <canvas> 元素时，框会以蓝色突出显示，并且触摸事件从中心开始，而不管手指实际在哪里是，然后它会像往常一样返回并跟踪手指。显然，每次触摸元素时，在该特定浏览器上都会绘制一条不需要的线。*

为了进行测试，我尝试禁用sketch.js，并制作了一个带有警报的通用 onmousedown 事件。当这种情况发生时，整个画布再次以蓝色突出显示，我想会发生同样的行为。当我访问[Sketch.js](http://intridea.github.com/sketch.js/)网站时，会发生完全相同的行为......

**这种行为是否有任何已知的解决方法？**或者有没有不表现出这种行为的[Sketch.js](http://intridea.github.com/sketch.js/)的替代品？（我想所有带有 onmousedown 事件的 <canvas> 元素都是完全相同的）

为了完整起见，这是 HTML+JS：

```
<canvas  style="border:1pt solid black;margin:auto;cursor:crosshair;clear:both;"  width="450px" height="200px" id="colors_sketch" ></canvas>
<script type="text/javascript">
   $(function() {
        $('#colors_sketch').sketch();
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T21:08:06.640

出于某种原因，即使在触摸屏中，浏览器也会处理鼠标事件。

要解决这个问题，只需在 ontouchstart 事件中将 mousedown、mouseup、mousemove 事件设置为未定义。

# tridion - 如何将参数传递给组件 (Dreamweaver) 模板？

> ID：11182669
> 
> 赞同：3
> 
> 时间：2012-06-25T01:51:04.960
> 
> 标签：tridion

我有一个页面模板，它在页面底部的 div 中输出三个组件演示文稿。所有这三个组件演示文稿都使用相同的架构和 Dreamweaver 组件模板。

我想根据它们是该 div 中的第一个组件还是最后一个组件来稍微不同地设置这些组件表示的样式 - 基本上我想为每个组件表示添加“第一个”和“最后一个”CSS 类。

我正在尝试在模板构建块中为组件演示动态设置“参数”。以下是我到目前为止所得到的（不起作用，只是为了让您了解我正在尝试做的事情）：

```
public override void Transform(Engine engine, Package package)
{
    var page = GetPage();
    var wantComponents =
        from c in page.ComponentPresentations
        where c.ComponentTemplate.Title == "Content highlight"
        select c;
    if (wantComponents.Count() > 0)
    {
        // pseudocode - won't compile!
        wantComponents.First().ComponentTemplate.Parameters["myCssClass"] = "first";
        wantComponents.Last().ComponentTemplate.Parameters["myCssClass"] = "last";
    }
    ... 
```

在我的 Dreamweaver 模板中（同样，不起作用，只是为了让您了解我正在尝试做什么）：

```
<div class="block @@Parameters.myCssClass@@">
    ...
</div> 
```

如何将“第一个”CSS 类动态添加到页面上的第一个组件表示中，并将“最后一个”CSS 类添加到页面上的最后一个组件表示中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T04:20:51.360

乔治这个问题一点也不坏。

如果您将 div 从组件模板中取出并将它们放入页面模板中，那么您不需要将页面模板中的参数传递到组件模板中。然后将 CSS 类设置为第一个组件表示很容易：

```
<div class="<!-- TemplateBeginIf cond="TemplateRepeatIndex==0" -->myFirstCssClass<!-- TemplateEndIf -->"></div> 
```

在最后一个 Component Presentation 上设置一个类更有趣，有几种方法可以实现：

1.  自定义 Dreamweaver 函数，例如 TemplateRepeatCount()。然后你可以在你的页面模板中做这样的事情： `<!-- TemplateBeginRepeat name="Components" --><div class="<!-- TemplateBeginIf cond="TemplateRepeatIndex==TemplateRepeatCount()-1" -->lastCssClass<!-- TemplateEndIf -->">@@RenderComponentPresentation()@@</div><!-- TemplateEndRepeat -->`.
2.  另一种方法是编写一个基本的 TBB，对组件表示进行计数并将总数放到包中，然后您可以将 TemplateRepeatIndex 与此数字进行比较。

上面的 #1 和 #2 在我的文章中都有描述：[http ://www.tridiondeveloper.com/more-fun-with-dreamweaver-templates-templaterepeatcount](http://www.tridiondeveloper.com/more-fun-with-dreamweaver-templates-templaterepeatcount)

最后，这是一种更符合您所询问的具体方法，即组件模板在何处实际查找页面范围以确定它是否是列表中的最后一个组件表示。这不是我最喜欢的，因为使用 TemplateBuilder 调试并不容易（因为当您通过 CT 运行时，您没有 PT，因此此范围内不存在组件表示计数）。

```
public class IsLastCP : TemplateBase
{
    private string MY_SCHEMA = "My Component's Schema Title";

    public override void Transform(Engine engine, Package package)
    {
        this.Initialize(engine, package);

        //in the page template.
        Page page = this.GetPage();
        if (page == null)
        {
            //this TBB is being executed either in Template Builder or a dynamic component presentation.
            // so we just don't do anything.
        }
        else
        {
            IList<ComponentPresentation> cpList = page.ComponentPresentations;

            int cpCount = 0;
            int thisCPIndex = -1;

            Component thisComponent = this.GetComponent();

            foreach (ComponentPresentation cp in cpList)
            {
                Component comp = cp.Component;
                if (comp.Schema.Title == MY_SCHEMA)
                {
                    if (comp.Id.Equals(thisComponent.Id))
                        thisCPIndex = cpCount;
                    cpCount++;
                }
            }

            if (thisCPIndex == cpCount-1)
            {
                package.PushItem("IsLastCP", package.CreateStringItem(ContentType.Text, "true"));
            }
        }
    } 
```

为此，您需要 Will 著名的 TemplateBase 类，您可以从 SDLTridionWorld 提供的“有用的构建块”扩展中获得该类。显然，您需要调整我提供给您的架构名称等的代码。

在组件模板中将此 TBB 放在 Dreamweaver TBB 之前，然后像这样使用它的输出： `<!-- TemplateBeginRepeat name="IsLastCP" -->class="myLastCSSClass"<!-- TemplateEndRepeat -->`

注意：您不需要在此处执行 TemplateBeginIf 并在 IsLastCP 上明确检查真/假。如果有问题的 CP 是最后一个，那么这个变量将出现在包中，并且 TemplateBeginRepeat 子句将进入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:20:52.493

你也可以使用上下文变量来做这种事情。您不能直接从 DWT 执行此操作，因此这可能意味着可能编写函数源，或者可能将 DWT 替换为写入输出的程序集 TBB。如果这种方法适合您的设计，您可以`engine.PublishingContext.RenderContext.ContextVariables`从页面模板中写入一个变量，指示组件渲染是否是第一个，然后让组件模板读取它以确定要生成的输出。

一般来说，想法是在页面模板中写入变量并在组件模板中读取它们。这应该足以让您避免将组件模板关注点移动到页面模板中，当然，管道数量可能会让您望而却步。对于更极端的情况，可以[从组件模板获取值到页面模板](http://code.google.com/p/tridion-practice/wiki/PassContextFromOneComponentRenderToAnother)，但是你有更多的管道，所以想要这样做可能是一种设计味道。

# javascript - 关于模拟jquery选择器方法

> ID：11182670
> 
> 赞同：0
> 
> 时间：2012-06-25T01:51:17.143
> 
> 标签：javascript, jquery

在输入 `$("div")`类似的数组时，它会`[<div>1</div><div>2</div><div>3</div>]`从中
获取一堆方法`jQuery.fn`，我对模拟它很感兴趣，但我不能让它“顺利”
，我参考了 zepto.js：

```
  zepto.Z = 函数（dom，选择器）{
    dom = dom || []
    dom.__proto__ = arguments.callee.prototype
    dom.selector = 选择器 || ''
    返回域
  }

```

但由于它不是跨浏览器，我写了一些片段如下：

```
var query=function(selector){    
  return new query.init(selector);    
};
query.init=function(selector){
   var found=document.querySelectorAll(selector);
   this.length=found.length;
   for(var i=0,len=this.length;i<len;i++){
     this[i]=found[i];
    }
  return this;
};
query.init.prototype={
  method1:function(){},
  method2:function(){}
} 
```

打字时`query("#id")`，虽然它可以在功能上进行操作，但它看起来还不够好，
![在此处输入图像描述](../Images/da80c0080c8b1db1ce4f90c483aacb9b.png)
如您所见，如何编写一个看起来像 jQuery 的查询函数？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:47:57.463

您可能想从简单的事情开始，例如：

```
function MaterObject(selector) {
  this.selector = selector;
  this.elements = document.querySelectorAll(selector);
} 
```

现在通过 MasterObject.prototype 添加功能：

```
MasterObject.prototype = {
  getLength: function() {
    return this.elements.length;
  },

  refresh: function() {
    this.elements = document.querySelectorAll(this.selector);
    return this;
   },

  addMore: function(selector) {
    this.selector = this.selector + ',' + selector;
    this.refresh();
    return this;
   }
} 
```

等等。要启动它：

```
function $(selector) {
  return new MasterObject(selector);
} 
```

以上缺乏功能测试，因此很脆弱。

请注意，大部分 jQuery 都是重载的，因此它需要测试给出的内容，然后决定处理结果（想到著名的“isArray”案例）。调用方法可能会对选择器选择的所有元素或仅第一个元素执行某些操作。向方法传递字符串、对象或任何内容都可能完全改变方法的作用。

请注意，函数可以返回`this`，因此可以链接方法。但问题是（对于库设计者和用户来说）是确定哪些应该是可链接的，哪些不应该，例如

```
var $x = $('div');

// addMore is chainable, getLength isn't
$x.addMore('p').getLength(); 
```

### 编辑

如果您希望您的“jQuery”对象成为一个数组，那么您必须将所有要继承的方法添加到 Array.prototype，这不是一个好主意。没有其他办法，你不能创建一个数组对象并将你自己的原型对象插入到它的`[[Prototype]]`链中，一个数组实例将直接继承自 Array.prototype。

您可以做的最好的是将元素 NodeList 转换为数组（就像您在 OP 中所做的那样）并在其上调用类似数组的方法（注意，因此，选择器可能不代表元素数组的内容）：

```
function MasterObject(selector) {
  this.selector = selector;
  this.elements = [];
}

MasterObject.prototype = {
  ...

  refresh: function() {
    this.elements = [];
    var els = document.querySelectorAll(this.selector);
    for (var i=0, iLen=els.length; i<iLen; i++) {
      this.elements[i] = els[i];
    }
    return this;
  },

  pop: function() {
    return this.elements.pop();
  }, 
```

此类更改可能会反映在 DOM 中（在这种情况下，选择器应该与内容同步，而不必通过 qSA 再次选择它）：

```
 popElement: function() {
    var el = this.elements.pop();
    el.parentNode.removeChild(el);
    return el;
  },

  ...
};

function $(selector) {
  var newObj = new MasterObject(selector); 
  newObj.refresh();
  return newObj;
} 
```

# mongodb - 在 MongoDB 中存储非常大的文档

> ID：11182671
> 
> 赞同：15
> 
> 时间：2012-06-25T01:51:27.007
> 
> 标签：mongodb, gridfs, nosql

简而言之：如果您有大量不同大小的文档，而达到最大对象大小的文档相对较少，那么将这些文档存储在 MongoDB 中的最佳实践是什么？

我有一组文件，例如：

```
{_id: ...,
  values: [12, 13, 434, 5555 ...]
} 
```

值列表的长度因文档而异。对于大多数文档来说，它会有一些元素，对于少数文档来说，它会有数千万个元素，我会达到 MongoDB 中的最大对象大小限制。问题是我为那些非常大（并且相对较少）的文档提出的任何特殊解决方案都可能会影响我存储小文档的方式，否则这些小文档会愉快地生活在 MongoDB 集合中。

据我所知，我有以下选择。我将不胜感激有关这些优点和缺点的任何意见，以及我错过的任何其他选项。

1）使用另一个数据存储：这似乎太激烈了。我喜欢 MongoDB，而且我没有达到许多对象的大小限制。在单词的情况下，我的应用程序可以区别对待非常大的对象和其他对象。它似乎并不优雅。

2) 使用 GridFS 存储值：就像传统数据库中的 blob 一样，我可以将值的前几千个元素保留在文档中，如果列表中有更多元素，我可以将其余元素保留在 GridFS 对象中作为二进制文件。我无法在这部分进行搜索，但我可以忍受。

3) 滥用 GridFS：我可以将每个文档都保存在 gridFS 中。对于大多数（小）文档，二进制块将是空的，因为文件集合将能够保留所有内容。其余的我可以将多余的元素保留在块集合中。与选项 #2 相比，这会带来开销吗？

4）真正滥用GridFS：我可以使用GridFS文件集合中的可选字段来存储值中的所有元素。GridFS 是否也对文件集合进行智能分块？

5）使用一个额外的“关系”集合来存储一对多关系，但是这个集合中的文档数量很容易超过一千亿行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-05-06T06:02:38.070

如果您有大型文档，请尝试将有关它们的一些元数据存储在 MongoDB 中，并将其余数据（您不会查询的部分）放在外面。

# javascript - Highchart - 仅更改一个 x 轴标签的颜色

> ID：11182681
> 
> 赞同：16
> 
> 时间：2012-06-25T01:53:41.183
> 
> 标签：javascript, highcharts

所以我知道如何在 Highchart 中改变 x 轴标签的颜色，这里有描述。

[http://jsfiddle.net/gh/get/jquery/1.7.1/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/labels-style/](http://jsfiddle.net/gh/get/jquery/1.7.1/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/labels-style/)

但是，如果我只想更改一个标签的颜色，而不是所有标签的颜色怎么办？如何将样式应用于单个标签？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-25T07:46:15.053

您还可以使用 label-formatter 设置样式。[关于jsfiddle](http://jsfiddle.net/tDSrd/)的完整示例：

```
labels: {
    formatter: function () {
        if ('Jun' === this.value) {
            return '<span style="fill: red;">' + this.value + '</span>';
        } else {
            return this.value;
        }
    }
} 
```

![在此处输入图像描述](../Images/0f5ba57be61c360986b8b006c6befca1.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-25T02:50:03.533

我了解到您想更改 x 轴内特定项目的颜色。

我查看了 API，但没有找到一种简单的方法。

由于您可以为“图表就绪事件”设置回调：

> 图表（对象选项，函数回调）：
> 
> 参数
> 
> options: Object 图表选项，如左侧菜单中“选项对象”标题下所述。
> 
> **回调：函数**
> 
> 当图表对象完成加载和渲染时执行的函数。在大多数情况下，图表是在一个线程中构建的，但在 Internet Explorer 版本 8 或更低版本中，有时会在文档准备好之前启动图表，在这些情况下，图表对象不会在调用 new Highcharts.Chart() 后直接完成. 因此，依赖于新建 Chart 对象的代码应始终在回调中运行。定义一个 chart.event.load 处理程序是等效的。
> 
> 返回： 对创建的 Chart 对象的引用。

你可以用*肮脏的方式*做到这一点：

```
$(function () {
    var chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            marginBottom: 80
        },
        xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            labels: {

                style: {
                    color: 'red'
                }
            }
        },

        series: [{
            data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]        
        }]
    },
    function(c){

        // this relies in that te xAxis is before the yAxis
        // also, setting the color with color: #ABCDEA didn't work
        // you have to use fill.
        $(".highcharts-axis:first text").each(function(i, label){
            var $label = $(label);
            if($label.children().text() === "Jun") {
                $label.css({fill: "blue"});                        

            }

        });

        // You also can to something like:
        $(".highcharts-axis:first text:eq(6)").css({fill: "green"});

    })
});​ 
```

希望这可以帮助你

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-06T09:09:51.130

请注意，当您使用 exporting.highcharts.com 上的 highcharts 导出服务器为您的图表呈现图像时，不会执行 javascript 格式化程序。

幸运的是，highcharts[将个别标签和标题字符串的一些 html 标记和样式属性](http://www.highcharts.com/docs/chart-concepts/labels-and-string-formatting)转换为等效的 SVG 样式，但它对如何解析 html 非常挑剔。它将剥离使用单引号属性的标签，您需要使用双引号。此外，将`<br/>`标签嵌套在另一个标签中也不起作用。

因此，例如，如果您想要两行红色的文本，您会得到：

```
<span style="color: #ff0000">First line</span> <br/> 
<span style="color: #ff0000">Second line</span> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-22T21:37:16.840

我在甜甜圈饼图中使用 dataLabels。我想根据条件逻辑更改单个饼图的标签文本颜色，比较值。

只是分享，因为我的搜索把我带到了这里。

```
data: outerData,
dataLabels: {
    formatter:
        function () {
            if ((outerData[this.point.x].y > innerData[this.point.x].y) && (this.point.x != 0)) {
                return this.y > 0.1 ? '<span style="fill: red;">' + this.point.name + ': ' + this.y + '% ' + '</span>' : null;
            } else {
                return this.y > 0.1 ? '<span style="fill: #006400;">' + this.point.name + ': ' + this.y + '% ' + '</span>' : null;
           }
        }
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-04T06:38:16.510

```
 xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        labels: {
            formatter: function () {
                if ('Jan' === this.value) {
                    return '<span style="fill: blue;">' + this.value + '</span>';
                } else {
                    return this.value;
                }
            }
        }
    }, 
```

# sql-server - 在 SELECT 语句中使用 UDF

> ID：11182685
> 
> 赞同：2
> 
> 时间：2012-06-25T01:54:28.937
> 
> 标签：sql-server, tsql, user-defined-functions

我为营业时间计算做了一个用户定义的函数。

这是我的UDF。

```
CREATE FUNCTION  fn_GetBusinessHour (@date datetime, @addHours int)
RETURNS datetime
AS
BEGIN 
    DECLARE @CalcuatedDate datetime;
    DECLARE @addDayCount int, @addHourCount int, @addMinCount int;

    SET @addDayCount = @addHours / 8.5;
    SET @addHourCount = @addHours - (@addDayCount * 8.5);
    SET @addMinCount =  @addHours - (@addDayCount * 8.5) - @addHourCount;

    IF(@addDayCount != 0) 
        SET @CalcuatedDate = DATEADD(DD, @addDayCount, @date); 

    SET @CalcuatedDate = DATEADD(HH, @addHourCount, @CalcuatedDate);

    IF(@addMinCount != 0) 
        SET @CalcuatedDate = DATEADD(MM, @addMinCount, @CalcuatedDate); 

    RETURN @CalcuatedDate;
END 
```

当我使用以下语句进行测试时，

```
SELECT dbo.fn_GetBusinessHour(GETDATE(), 40) 
```

它显示了正确的结果。

但是，我像这样使用我的功能，

```
SELECT TicketID
     , DateTimeLogged --Type: Datetime
     , Priority       --Type: int
     , [dbo].[fn_GetBusinessHour](DateTimeLogged, Priority)
  FROM TicketHeader 
```

结果仅显示 NULL 值。

```
TicketID    DateTimeLogged  Priority    (No column name)
1   2011-07-04 11:26:19.510     30  NULL
2   2011-07-04 13:58:45.683     30  NULL
3   2011-07-05 10:09:16.923     10  NULL
4   2011-07-05 13:13:30.237     30  NULL
5   2011-07-05 16:50:34.033     20  NULL 
```

我尝试了 CONVERT，因为它在我给出值 40 时有效，但它也显示空值。

```
SELECT TicketID
         , DateTimeLogged --Type: Datetime
         , Priority       --Type: int
         , [dbo].[fn_GetBusinessHour](DateTimeLogged, CONVERT(int, Priority))
      FROM TicketHeader 
```

如何解决此问题以使用我的 UDF？为什么会发生这种事情？我不明白优先级和 40 之间有什么不同。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T02:22:49.887

对于优先级 > 8.5 的值，这对我来说似乎很好：

```
DECLARE @t TABLE(TicketID INT, DateTImeLogged DATETIME, Priority INT);

INSERT @t SELECT 1,'20110704 11:26:19.510',30
UNION ALL SELECT 2,'20110704 13:58:45.683',30
UNION ALL SELECT 3,'20110705 10:09:16.923',10
UNION ALL SELECT 4,'20110705 13:13:30.237',30
UNION ALL SELECT 5,'20110705 16:50:34.033',20;

SELECT TicketID
     , DateTimeLogged --Type: Datetime
     , Priority       --Type: int
     , [dbo].[fn_GetBusinessHour](DateTimeLogged, Priority)
  FROM @t; 
```

产量：

```
TicketID  DateTimeLogged           Priority  (No column name)
--------  -----------------------  --------  -----------------------
1         2011-07-04 11:26:19.510  30        2011-07-07 15:26:19.510
2         2011-07-04 13:58:45.683  30        2011-07-07 17:58:45.683
3         2011-07-05 10:09:16.923  10        2011-07-06 11:09:16.923
4         2011-07-05 13:13:30.237  30        2011-07-08 17:13:30.237
5         2011-07-05 16:50:34.033  20        2011-07-07 19:50:34.033 
```

如果我添加另一行优先级 < 8.5，例如：

```
INSERT @t SELECT 6,'20110705 13:13:30.237',5; 
```

然后将此行添加到结果中：

```
TicketID  DateTimeLogged           Priority  (No column name)
--------  -----------------------  --------  -----------------------
6         2011-07-05 13:13:30.237  5         NULL 
```

换句话说，如果函数逻辑未分配@CalculatedDate，则函数将输出NULL，如果@addDayCount = 0，则会发生这种情况。在函数中你说：

```
IF(@addDayCount != 0) 
    SET @CalcuatedDate = DATEADD(DD, @addDayCount, @date); 
```

由于 @addDayCount 是一个 INT，试试这个：

```
DECLARE @addDayCount INT;
SET @addDayCount = 5 / 8.5;
SELECT @addDayCount; 
```

结果：

```
0 
```

因此，由于最初没有为 @CalculatedDate 分配值，因此以下所有 DATEADD 操作都在执行 DATEADD(interval, number, NULL) 仍然产生 NULL。

所以也许你需要为函数中的变量使用不同的数据类型......

# python - 在索尼电视上扎根？

> ID：11182691
> 
> 赞同：0
> 
> 时间：2012-06-25T01:55:40.497
> 
> 标签：python, root, busybox, sony

我最近在 Hack a Day [Getting root on a Sony TV 上](http://hackaday.com/2012/06/20/getting-root-on-a-sony-tv/)阅读了这篇文章，它使用的脚本可以在[此处](https://github.com/CFSworks/nimue)找到，用于 Sony Bravia 电视。该脚本使用 BusyBox，我的问题基于[此处](https://github.com/CFSworks/nimue/tree/master/busybox)找到的 README 。我对此有两个问题： 1\. 为了为 mipsel 架构编译 BusyBox，我必须采取哪些步骤？2\. 如何在我的 BusyBox 二进制文件中包含适用于您电视的 GLibc / Linux 内核版本？

有没有其他人成功地使用了这个技巧？

提前感谢您的帮助和时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T07:17:13.100

为另一种体系结构进行编译称为*交叉编译*，但您当然会在[Busybox 常见问题解答](http://www.busybox.net/FAQ.html)中阅读该内容。更不用说那里提供的针对您可能要求的所有架构的交叉编译器的链接。

您可以尝试找到一个预先构建的 MIPS 二进制文件，如果有疑问，最好直接询问 Busybox 列表 :)

# ruby-on-rails-3 - Rails 资产管道找不到某个图像

> ID：11182696
> 
> 赞同：4
> 
> 时间：2012-06-25T01:56:25.770
> 
> 标签：ruby-on-rails-3, asset-pipeline

我有一个名为`ui-icons_ffffff_256x240.png`. 在生产中，它可以在其他地方找到`public/assets/images/ui-icons_ffffff_256x240.png`。

当我尝试在生产中查看此图像时，我收到以下错误：

```
ActionController::RoutingError (No route matches [GET] "/assets/images/ui-icons_ffffff_256x240.png"): 
```

我觉得这非常奇怪，因为图像肯定在那里：

```
$ find . -name ui-icons_ffffff_256x240.png
./vendor/assets/stylesheets/jquery-ui/images/ui-icons_ffffff_256x240.png
./public/assets/jquery-ui/images/ui-icons_ffffff_256x240.png
./public/assets/images/ui-icons_ffffff_256x240.png 
```

我的应用程序中的所有其他图像都可以正常工作并且永远存在。不过，我最近升级了我的 jQuery UI 版本，而这个特定的图像无法正常工作。（我认为这是我实际使用的唯一 jQuery UI 图像。）

我在 Rails 3.2.1 上。可能是什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T06:43:23.400

您的 js 插件请求具有无效资产 url 的图像。资产图像可以通过以下方式访问

```
/assets/ui-icons_ffffff_256x240.png 
```

但请求的网址是

```
/assets/images/ui-icons_ffffff_256x240.png 
```

因此，在您的 javascript 或样式表中，您需要手动更正资产 url。

# cassandra - Cassandra 多数据中心、WAN 故障和复制弹性

> ID：11182701
> 
> 赞同：0
> 
> 时间：2012-06-25T01:58:02.723
> 
> 标签：cassandra

我有两个 DC。我的 Cassandra 戒指跨越两个 DC。我使用复制因子 = 3 的本地仲裁。我在 DC1 中使用本地仲裁进行写入。数据被写入 DC1 中的多个节点。对于传播到 DC2 的相同写入，只有一个副本从 DC1 中的协调器节点发送到 DC2 中的协调器节点，以优化 WAN 上的流量（来自我在 Cassandra 文档中阅读的内容）

想象一下有几秒钟的轻微打嗝。

关于复制弹性的问题：

1.  这个 Wan 打嗝会导致在 DC1 的协调器中创建一个提示切换 (HH)，以便在 Wan 链路再次启动时交付 DC2？

2.  我读过 HH 仅在故障检测器识别出副本不可用时才启动。这几秒钟的打嗝会导致一些数据在下一次 nodetool 修复运行之前未被检测到 DC2 吗？

3.  如果 Wan 打嗝持续几秒钟/分钟，是否建议运行 nodetool 修复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-26T17:33:49.693

1.  是的

2.  这在 Cassandra 1.0 中已经过时，所以没有。（见[http://www.datastax.com/dev/blog/whats-new-in-cassandra-1-0-windows-service-new-cql-clients-and-more](http://www.datastax.com/dev/blog/whats-new-in-cassandra-1-0-windows-service-new-cql-clients-and-more)）

3.  如上，没有。

# java - 检查是否在android中按下了返回键？

> ID：11182703
> 
> 赞同：23
> 
> 时间：2012-06-25T01:58:12.493
> 
> 标签：java, android, back-button

假设我正在进行主要活动并开始一项新活动

```
MainActivity > NewActivity 
```

然后从`NewActivity`我按后退键

```
MainActivity < NewActivity 
```

`MainActivity`如果它在`NewActivity`关闭后显示，我想做一些事情，但不是在`MainActivity`正常运行时显示，例如在第一次运行应用程序时。有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-25T02:06:58.757

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if ((keyCode == KeyEvent.KEYCODE_BACK)) {
        Log.d(this.getClass().getName(), "back button pressed");
    }
    return super.onKeyDown(keyCode, event);
} 
```

@更新。如果你想在 NewActivity 完成时收到通知，你必须通过 startActivityForResult(Intent, requestCode) 来启动它。然后，您必须覆盖 MainActivity 上的 onActivityResult()。在这里检查requestcode参数，如果返回码等于提交码（当你启动childActivity时），放一些代码来做你的业务。

```
int MYCODE=1000;
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // Result OK.d.
    if (requestCode == MYCODE) {
        // do something good
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-06-23T12:00:20.493

I try the below method to detect the back button pressed on the action bar in activity by the first method and the second one is used to detecting the mobile hardware button back or kill activity button.

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()){
        case android.R.id.home:
            onBackPressed();
            return true;
        default:
            return super.onOptionsItemSelected(item);
    }
}

@Override
public void onBackPressed() {
    setResult(RESULT_CANCELED);
    super.onBackPressed();
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-06-25T05:02:55.987

您可以覆盖 NewActivity 中的 onBackPressed() 方法，该方法将检测何时按下后退按钮。然后为了通知 MainActivity，您可以在包中发送一个布尔标志，以便 MainActivity 在 NewActivity 之后检测到它的打开。

在新活动中：

```
 @Override
       public void onBackPressed() {
                boolean fromNewActivity=true;

        Intent mainIntent = new Intent(view.getContext(), MainActivity.class);
        Bundle bundleObj = new Bundle();
        bundleObj.putString("fromNewActivity", Boolean.toString(fromNewActivity));
        mainIntent.putExtras(bundleObj);
        startActivityForResult(mainIntent, 0);
           } 
```

在 onCreate() 方法的 MainActivity 中：

```
 Bundle extras = getIntent().getExtras();
       boolean fromNewActivity =Boolean.parseBoolean( extras.getString("fromNewActivity")); 
```

现在您可以检查 MainActivity 是否在 NewActivity 之后打开。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-25T02:04:43.383

几个想法：

*   你可以在`MainActivity`它启动时设置一个标志`NewActivity`。
*   您可以调用`startActivityForResult`并`MainActivity`安排`NewActivity`设置结果，完成后您将收到该`MainActivity.onActivityResult()`结果`NewActivity`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T02:03:32.877

开始时，`NewActivity`您需要使用`startActivityForResult`并使用有效的`requestId`. 一旦完成，这些`requestId`将传回给您。`onActivityResult``NewActivity`

# sublimetext2 - 在 Sublime Text 2 中对命令面板叠加层中的项目进行排序

> ID：11182708
> 
> 赞同：4
> 
> 时间：2012-06-25T01:59:35.317
> 
> 标签：sublimetext2

[在fraxel](https://stackoverflow.com/users/1175101/fraxel)的帮助下：[Assigning multiple snippets to a single key binding](https://stackoverflow.com/questions/11043695/assigning-multiple-snippets-to-a-single-key-binding)我能够创建一个方便的弹出菜单，以 Textmate 的工作方式组织我的所有片段。

是否可以告诉 ST2 我希望它们出现在叠加命令面板中的顺序？现在它们似乎是随机的，我希望能够为它们设置一些顺序。

我不知道 ST2 如何订购它们。

**更多**：

我所有的片段都有表明它们的语言的文件名：例如

*   PHP_mySQLLoop.sublime-snippet
*   PHP_mySQLi.sublime-snippet
*   HTML_basePage.sublime-snippet
*   jQuery_ajax.sublime-snippet

我使用的`<description>`也是标准的：

*   JMR PHP, mySQL 循环
*   JMR PHP, mySQLi
*   JMR HTML，基本页面
*   JMR jQuery, $ajax

将 PHP_mySQLi.sublime-snippet 更改为 PHP_1_mySQLi.sublime-snippet 或 1_PHP_mySQLi.sublime-snippet 没有任何效果，也没有更改它的描述。

在他的观点上，我没有`<scope>`任何片段的集合......也许我应该......？（这是在 OS X 上，不确定这是否与此有关......）

# html - 为什么我们使用 Strict doctype

> ID：11182710
> 
> 赞同：4
> 
> 时间：2012-06-25T01:59:36.697
> 
> 标签：html, doctype

我正在阅读关于 doctypes 的内容，并且我阅读了关于 Strict 和 Transitional doctypes 的内容。它们之间有一些区别：比如严格的 doctype 不支持字体等标签，但是，Transitional 支持。现在我很困惑如果过渡支持所有标签，为什么我们使用严格的文档类型。那为什么我们需要使用 Strict doctype？有什么理由吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T02:06:18.347

如果您开始一个新项目，只需使用 html5，它只有一个 DOCTYPE：

`<!DOCTYPE html>`

回到你原来的问题，这是一篇好文章：

[http://24ways.org/2005/transitional-vs-strict-markup](http://24ways.org/2005/transitional-vs-strict-markup)

> 当您有很多不能轻易转换为符合严​​格 DOCTYPE 的遗留标记时，可以使用过渡 DOCTYPE。但严格是您应该瞄准的目标。它鼓励并在某些情况下强制执行结构和表示的分离，将表示方面从标记转移到 CSS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T05:49:22.440

就浏览器行为（和搜索引擎等）而言，Transitional 和 Strict doctype 之间没有区别，只要您使用 HTML 4.01 规范中指定的版本即可。它们都触发了“标准模式”，就浏览器而言。

因此，差异仅在验证方面很重要（以及作为阅读标记的人的文档）。标记验证器使用 doctypes，因此当使用 Strict doctype 时，它​​们会将 Strict 版本中不允许的任何构造标记为错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T02:08:47.897

> 使用 Strict DTD，无论是 HTML 4.01 Strict 还是 XHTML 1.0 Strict，对于未来 Web 的质量而言，远比名称前面是否有 X 重要得多。Strict DTD 促进了结构和表示的分离，这使得站点更容易维护。

阅读[**这个**](http://24ways.org/2005/transitional-vs-strict-markup)和[**这个**](http://24ways.org/2005/transitional-vs-strict-markup)。

# ajax - 使用 Google Chrome 的 xmlHttpRequest 时拒绝设置不安全的标头“Origin”

> ID：11182712
> 
> 赞同：25
> 
> 时间：2012-06-25T02:00:40.410
> 
> 标签：ajax, xmlhttprequest, comet, cors

收到此错误消息： `Refused to set unsafe header "Origin"`

使用此代码：

```
 function getResponse() {
            document.getElementById("_receivedMsgLabel").innerHTML += "getResponse() called.<br/>";
            if (receiveReq.readyState == 4 || receiveReq.readyState == 0) {
                receiveReq.open("GET", "http://L45723:1802", true, "server", "server123");  //must use L45723:1802 at work.
                receiveReq.onreadystatechange = handleReceiveMessage;
                receiveReq.setRequestHeader("Origin", "http://localhost/");
                receiveReq.setRequestHeader("Access-Control-Request-Origin", "http://localhost");
                receiveReq.timeout = 0;
                var currentDate = new Date();
                var sendMessage = JSON.stringify({
                    SendTimestamp: currentDate,
                    Message: "Message 1",
                    Browser: navigator.appName
                });
                receiveReq.send(sendMessage);

            }
        } 
```

我究竟做错了什么？为了使这个 CORS 请求正常工作，我在标题中缺少什么？

我尝试删除`receiveReq.setRequestHeader("Origin", ...)`呼叫，但 Google Chrome 在我的`receiveReq.open()`呼叫中引发访问错误...

为什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-25T02:39:19.180

这只是一个猜测，因为我将 jquery 用于 ajax 请求，包括 CORS。

我认为浏览器应该设置标题，而不是你。如果您能够设置标题，那将破坏安全功能的目的。

在不设置这些标头的情况下尝试请求，看看浏览器是否为您设置了它们。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-07-21T06:56:27.683

在 CORS 中，调用代码不需要做任何特殊的配置。一切都应该由浏览器处理。决定是否允许请求是服务器的工作。因此，每当您发出违反 SOP 政策的请求时，浏览器都会尝试为您发出 CORS 请求（它会自动添加 Origin 标头，如果您使用一些不安全的标头/方法/内容类型，可能会发出预检请求）。如果服务器支持 CORS，它将正确响应并通过提供 CORS 特定的响应标头来允许/禁止请求，例如

```
Access-Control-Allow-Origin: * 
```

请记住，Chrome 对“localhost”主机名的限制非常严格。（至少在我使用它的时候是这样）。而是使用您的计算机名称或在“主机”文件中为其分配另一个别名。因此，例如不要访问您的网站，例如：

```
http://localhost:port/myappname 
```

而是使用：

```
http://mymachinename:port/myappname 
```

或者

```
http://mymachinealias:port/myappname 
```

有关更多详细信息，请查看[规格](http://www.w3.org/TR/cors/)。

* * *

## 回答 #3

> 赞同：-8
> 
> 时间：2012-07-31T17:36:03.000

你是跨域工作吗？

试试 Brian S 解决方案或试试这个：

而不是设置为 localhost 只是传递任何东西......看看会发生什么。

```
receiveReq.setRequestHeader("Origin", "*"); 
```

# android - 位图工厂示例

> ID：11182714
> 
> 赞同：4
> 
> 时间：2012-06-25T02:00:57.593
> 
> 标签：android

我想创建一个动态图像视图，其中我画廊中的每个图像都将使用 bitmapfactory 而不是绑定在图像视图中的图像可绘制。是否有一些网站有这方面的 bitmapfactory 教程？我相信使用 bitmapfactory 将图像绑定到图像视图中使用更少的内存？这是正确的吗？我还想尽量减少内存泄漏的风险，这就是我想使用 bitmapfactory 的原因。请帮忙。我找不到教授位图工厂的基本示例。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-25T02:27:38.387

**构建位图对象**

1)*从文件*

使用带有 push 选项的 adb 工具将 test2.png 复制到 sdcard

这是从 sdcard 加载位图的最简单方法。只需将图像的路径传递给 BitmapFactory.decodeFile() 并让 Android SDK 完成剩下的工作。

```
public class TestImages extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        ImageView image = (ImageView) findViewById(R.id.test_image);
        Bitmap bMap = BitmapFactory.decodeFile("/sdcard/test2.png");
        image.setImageBitmap(bMap);
    }
} 
```

这段代码所做的只是加载我们之前复制到 sdcard 的图像 test2.png。BitmapFactory 使用此图像创建一个位图对象，我们使用该`ImageView.setImageBitmap()`方法更新 ImageView 组件。

2)*从输入流*

用于`BitmapFactory.decodeStream()`将 BufferedInputStream 转换为位图对象。

```
public class TestImages extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        ImageView image = (ImageView) findViewById(R.id.test_image);
        FileInputStream in;
        BufferedInputStream buf;
        try {
            in = new FileInputStream("/sdcard/test2.png");
            buf = new BufferedInputStream(in);
            Bitmap bMap = BitmapFactory.decodeStream(buf);
            image.setImageBitmap(bMap);
            if (in != null) {
            in.close();
            }
            if (buf != null) {
            buf.close();
            }
        } catch (Exception e) {
            Log.e("Error reading file", e.toString());
        }
    }
} 
```

此代码使用基本的 Java FileInputStream 和 BufferedInputStream 为`BitmapFactory.decodeStream()`. 文件访问代码应该被一个 try/catch 块包围，以捕获 FileInputStream 或 BufferedInputStream 抛出的任何异常。此外，当您完成流句柄时，它们应该被关闭。

3)*来自您的 Android 项目的资源*

用于`BitmapFactory.decodeResource(res, id)`从 Android 资源中获取位图。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    ImageView image = (ImageView) findViewById(R.id.test_image);
    Bitmap bMap = BitmapFactory.decodeResource(getResources(), R.drawable.icon);
    image.setImageBitmap(bMap);
} 
```

# algorithm - 计数每个位在整数范围内设置的次数

> ID：11182723
> 
> 赞同：7
> 
> 时间：2012-06-25T02:03:05.020
> 
> 标签：algorithm, bit-manipulation

给定从 M 到 N 的整数范围，其中 M 和 N 可能不是 2 的幂。有没有一种有效的方法来计算每个位被设置的次数？

例如范围 0 到 10

```
0   0000
1   0001
2   0010
3   0011
4   0100
5   0101
6   0110
7   0111
8   1000
9   1001
10  1010 
```

我想计算每列中每个位设置的次数，在这种情况下为 3,4,5,5。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T03:24:31.933

每个位级别都有一个由`2^power`0 和`2^power`1 组成的模式。

所以分三种情况：

1.  何时`M`和`N`是这样的`M = 0 mod 2^(power+1)`和`N = 2^(power+1)-1 mod 2^(power+1)`。在这种情况下，答案很简单`(N-M+1) / 2`

2.  当整数除以 时，M 和 N = 相同的`M`数。在这种情况下，有几个子情况：`N``2^(power+1)`

    1.  两者`M`和`N`都是这样，当整数除以 时，两者`M`和= 相同的数字。在这种情况下，如果那么答案是，否则答案是`N``2^(power)``N < 2^(power) mod 2^(power+1)``0``N-M+1`
    2.  否则它们是不同的，在这种情况下，答案是`N - (N/2^(power+1))*2^(power+1) + 2**(power)`（整数除法） if `N > 2^(power) mod 2^(power+1)`，否则答案是`(M/2^(power+1))*2^(power+1) - 1 - M`
3.  最后一种情况是 M 和 N = 整数除以 时的不同数字`2^(power+1)`。在这种情况下，您可以结合 1 和 2 的技术。求 和 之间的数字`M`个数`(M/(2^(power+1)) + 1)*(2^(power+1)) - 1`。然后在`(M/(2^(power+1)) + 1)*(2^(power+1))`和之间`(N/(2^(power+1)))*2^(power+1)-1`。最后在`(N/(2^(power+1)))*2^(power+1)`和之间`N`。

如果这个答案有逻辑错误，请告诉我，它很复杂，我可能稍微搞砸了一些东西。

更新：

蟒蛇实现

```
def case1(M, N):
  return (N - M + 1) // 2

def case2(M, N, power):
  if (M > N):
    return 0
  if (M // 2**(power) == N // 2**(power)):
    if (N % 2**(power+1) < 2**(power)):
      return 0
    else:
      return N - M + 1
  else:
    if (N % 2**(power+1) >= 2**(power)):
      return N - (getNextLower(N,power+1) + 2**(power)) + 1
    else:
      return getNextHigher(M, power+1) - M

def case3(M, N, power):
  return case2(M, getNextHigher(M, power+1) - 1, power) + case1(getNextHigher(M, power+1), getNextLower(N, power+1)-1) + case2(getNextLower(N, power+1), N, power)

def getNextLower(M, power):
  return (M // 2**(power))*2**(power)

def getNextHigher(M, power):
  return (M // 2**(power) + 1)*2**(power)

def numSetBits(M, N, power):
  if (M % 2**(power+1) == 0 and N % 2**(power+1) == 2**(power+1)-1):
    return case1(M,N)
  if (M // 2**(power+1) == N // 2**(power+1)):
    return case2(M,N,power)
  else:
    return case3(M,N,power)

if (__name__ == "__main__"):
  print numSetBits(0,10,0)
  print numSetBits(0,10,1)
  print numSetBits(0,10,2)
  print numSetBits(0,10,3)
  print numSetBits(0,10,4)
  print numSetBits(5,18,0)
  print numSetBits(5,18,1)
  print numSetBits(5,18,2)
  print numSetBits(5,18,3)
  print numSetBits(5,18,4) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T08:08:20.310

它可以保持简单 -

取 x1 = 0001（用于在最右列找到 1）、x2 = 0010、x3 = 0100 等等。

现在，在一个循环中 -

```
n1 = n2 = n3 = 0
for i=m to n:
    n1 = n1 + (i & x1)
    n2 = n2 + (i & x2)
    n3 = n3 + (i & x3) 
```

其中 - ni = 第 i 列中 1 的数量（从右开始）

# node.js - HTTP 请求流在请求处理程序之外不可读

> ID：11182725
> 
> 赞同：3
> 
> 时间：2012-06-25T02:03:09.387
> 
> 标签：node.js

我正在编写一个相当复杂的多节点代理，有一次我需要处理一个 HTTP 请求，但是在“http.Server”回调之外从该请求中读取（我需要从请求数据中读取并对其进行排列）在不同的时间有不同的反应）。问题是，流不再可读。下面是一些重现问题的简单代码。这是正常现象还是bug？

```
function startServer() {
    http.Server(function (req, res) {
        req.pause();

        checkRequestReadable(req);

        setTimeout(function() {
        checkRequestReadable(req);
        }, 1000);

        setTimeout(function() {
        res.end();
        }, 1100);
    }).listen(1337);
    console.log('Server running on port 1337');
}

function checkRequestReadable(req) {
    //The request is not readable here!
    console.log('Request writable? ' + req.readable);
}

startServer(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T09:44:55.080

它在 v0.8.22 中工作

```
server$ node http_test.js 
Server running on port 1337
Request writable? true
Request writable? true
Request writable? true
Request writable? true
^Cserver$ node -v
v0.8.22
server$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T03:11:49.047

这适用于 0.8.0。我没有在 0.6.11+ 中尝试

# asp.net - 十六进制值 0x1F，是无效字符

> ID：11182729
> 
> 赞同：0
> 
> 时间：2012-06-25T02:03:30.170
> 
> 标签：asp.net, xml, vb.net, rss

我收到以下错误：

' '，十六进制值 0x1F，是无效字符

这是我的功能。第一次点击“reader.MoveToContent()”时出现此错误。谁能指出我正确的方向？

```
Public Function GetSyndicationFeedData(ByVal urlFeedLocation As String) As SyndicationFeed

    Dim settings As New XmlReaderSettings() With { _
      .IgnoreWhitespace = True, _
      .CheckCharacters = True, _
      .CloseInput = True, _
      .IgnoreComments = True, _
      .IgnoreProcessingInstructions = True _
    }

    If [String].IsNullOrEmpty(urlFeedLocation) Then
        Return Nothing
    End If

    Using reader As XmlReader = XmlReader.Create(urlFeedLocation, settings)
        If reader.ReadState = ReadState.Initial Then
            reader.MoveToContent()
        End If

        ' Now try reading...
        Dim atom As New Atom10FeedFormatter()
        Dim rss20 As New Rss20FeedFormatter()

        ' Atom
        If atom.CanRead(reader) Then
            atom.ReadFrom(reader)
            Return atom.Feed
            'Rss 2.0
        ElseIf rss20.CanRead(reader) Then
            rss20.ReadFrom(reader)
            Return rss20.Feed
        Else
            Return Nothing
        End If
    End Using
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T04:28:11.807

您可以使用以下代码（抱歉，它在 c# 中）下载提要并替换有问题的字符。

```
var client = new WebClient();
var feedAsString = client.DownloadString(urlFeedLocation).Replace((char)(0x1F), Convert.ToChar(""));
using (XmlReader reader = XmlReader.Create(new MemoryStream(Encoding.Default.GetBytes(feedAsString)), settings))
{
    // remainder of your code here
} 
```

# rally - 将默认值传递给 AddNew 组件

> ID：11182732
> 
> 赞同：0
> 
> 时间：2012-06-25T02:04:09.050
> 
> 标签：rally

我正在尝试预先填充创建缺陷弹出窗口，但我不清楚我可以传递哪些键/值。文档说密钥应该是“名称”和“描述”，但它们没有被拾取。但是，环顾四周后，我注意到它正在选择“defaultName”。任何帮助表示赞赏！

`

```
 function onAddNewPreCreate(addNew, eventArgs)
       {
           eventArgs.item["defaultName"] = "name";
           eventArgs.item["Description"] = "description";
           eventArgs.item["defaultDescription"] = "description123";
       } 
       function onLoad() {

       var rallyDataSource = new rally.sdk.data.RallyDataSource('__WORKSPACE_OID__',
                 '__PROJECT_OID__',
                 '__PROJECT_SCOPING_UP__',
                '__PROJECT_SCOPING_DOWN__');

       var addNewConfig = {
         types : ["Defect"]
       };

       var addNew = new rally.sdk.ui.AddNewArtifact(addNewConfig, rallyDataSource);
      addNew.addEventListener('onPreCreate', onAddNewPreCreate);;
       addNew.display("addNewDiv");
   }

    rally.addOnLoad(onLoad); 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T00:03:16.813

不幸的是，AddNewArtifact（以及 rally.sdk.util.Navigation.popupCreatePage）支持的字段列表没有很好的记录。描述不是预填充到编辑器窗口中支持的字段之一。预填充支持的字段有：

```
User Story:
defaultName
rank
iteration
release
parent
dpyOid {dependency}

Defect:
defaultName
defectSuiteOid {Defect Suites}
testCaseResult
testCase
requirement
iteration

Defect Suite:
defaultName
rank
iteration

Portfolio Item:
defaultName
rank
parent

Task:
workProduct

Test Case:
testfolderOid {Test Folder}
artifactOid {Artifact}

Test Set:
iteration
release 
```

# xcode - 带有视网膜显示的 xcode 模拟器中画布的性能

> ID：11182733
> 
> 赞同：1
> 
> 时间：2012-06-25T02:04:23.440
> 
> 标签：xcode, ipad, html, canvas, ios-simulator

我有一个 html5 画布游戏，限制为 30FPS。当设置为 iPad2 时，这在 iPad2 和 xcode 模拟器上运行良好（@30FPS）。

但是，当我将模拟器设置为“Retina”并运行应用程序时，FPS 降至 11FPS。当我执行以下操作时，我得到大致相同的结果：

*   让模拟器放大我的 iPad2 图像。
*   当我使用 CSS transorms 来放大我的图像时。
*   当我 JS 放大我的图像时（使用像素比）。

有趣的是，当我在 iPhone 视网膜模拟器中测试它时，也看到了这个 11FPS（即使这个应用程序不是为 iPhone 构建的，所以它只是被切断了）。

canvas 和 xcode 模拟器是否存在任何已知问题？是否有任何修复或我做错了什么？

我的硬件是配备 i7CPU 和 8GB 内存的 Macbook Pro（2012 年中）。

谢谢J。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T03:37:36.067

它是一个模拟器而不是模拟器，永远不要期望它得到准确的结果，尤其是在涉及硬件性能相关问题时。在真实设备上测试您的应用程序，如果您在真实设备上获得所需的帧速率，那才是最重要的。

现在，为什么你的模拟器会这样做有点有趣。我最好的猜测是，计算机在缩小窗口中以比屏幕更高的分辨率运行游戏时遇到了困难……再一次，这只是我的最佳猜测。

# objective-c - NSTextField 添加行距

> ID：11182735
> 
> 赞同：4
> 
> 时间：2012-06-25T02:04:34.897
> 
> 标签：objective-c, cocoa, nstextfield, nsattributedstring

我使用 NSTextField 而不是 NSTextView 来接收用户输入，但我需要自定义字体和 textColor 以及行距。我使用下面的代码，字体和颜色都可以，但我不知道如何设置行距。

```
[self.titleField setTextColor:textColor];
[self.titleField setFont:bold14]; 
```

而且我还使用 NSAttributedString 来解决问题：

```
NSFont *bold14 = [NSFont boldSystemFontOfSize:14.0];
NSColor *textColor = [NSColor redColor];
NSMutableParagraphStyle *textParagraph = [[NSMutableParagraphStyle alloc] init];
[textParagraph setLineSpacing:10.0];

NSDictionary *attrDic = [NSDictionary dictionaryWithObjectsAndKeys:bold14, NSFontAttributeName, textColor, NSForegroundColorAttributeName, textParagraph, NSParagraphStyleAttributeName, nil];
NSAttributedString *attrString = [[NSAttributedString alloc] initWithString:title attributes:attrDic]; 
[self.titleField setAllowsEditingTextAttributes:YES];
[self.titleField setAttributedStringValue:attrString]; 
```

上面的代码可以显示属性字符串，但是当我删除文本字段中的字符串并开始输入时，单词没有任何属性。

如何在 NSTextField 中输入具有自定义字体、颜色和行距的字符串？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T06:03:33.953

最好使用`NSTextField's`属性设置方法而不是 an，`NSAttributedString`因为这样它可以将设置发送到字段编辑器。每个文本字段都有一个`NSTextView`（大部分时间）“[字段编辑器](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/TextEditing/Tasks/FieldEditor.html)”；字段编辑器是在做编辑。

你`NSAttributedString`没有坚持，因为你只是告诉文本字段暂时显示那个字符串。当字段编辑器弹出文本字段（单元格）时，它会传递它自己的属性`textField.font`，`textField.textColor`但绝不会传递`NSAttributedString`'s 属性。

最好使用 an`NSTextView`以便能够使用`-setDefaultParagraphStyle`，因为据我所见，无论如何您都在编辑多行。如果由于性能问题或其他原因不能，那么：

* * *

Subclass `NSTextFieldCell`，因为这就是所有的`NSTextField`工作，并覆盖

```
- (NSText *)setUpFieldEditorAttributes:(NSText *)textObj 
```

（在 中声明`NSCell`）以您想要的方式为您的字段编辑器设置属性，因此您可以`-setDefaultParagraphStyle`自己通过（和字体等）向它发送行高值。（`textObj`是要设置的字段编辑器）。

# php - PHP 文件列表生成的 div 框和前 2 个为空

> ID：11182736
> 
> 赞同：1
> 
> 时间：2012-06-25T02:04:38.970
> 
> 标签：php, html, file, include

这是我的代码。

前 2 个 div 为空且无序，如何使用包含的 php 文件做正确的 div 框

```
<html>
    <head></head>
    <body>
    <?php
    $dir    = 'folder/';
    $files = scandir($dir);
    $count=0;
    foreach($files as $file){
        $count++;
        echo '<div style="float:left; margin: 0 0 10px 10px;border:1px solid       #50A4AB;  width:200px"><br>';
        if(strpos($file,".php")){
            include($dir.$file);
        }
        echo '</div><br>';
        if($count==7){echo'<div style="clear:both;"></div><br>';}
    }
    ?>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T02:12:05.313

scandir 函数返回 '.' 和“..”，您必须将其从结果中排除。这就是前两个 div 为空的原因。

您还应该查看[scandir 函数的文档以](http://us3.php.net/manual/en/function.scandir.php)获取有关订单的信息。

您的 html 格式错误，导致 StackOverflow 代码高亮显示中断并且您的缩进不一致。当您寻求帮助时，您应该更加努力地使您的示例易于阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:32:22.053

1.  @mqsoh 所说的一切都是正确的。(+1)
2.  您的代码存在巨大的安全风险。将文件夹中的所有 php 文件作为包含自动加载是危险的。您应该只加载已知的命名文件。
3.  我已经编辑了您的问题，以便代码更相关。
4.  您应该包含一个 if 语句，其效果是：

`if ($file != "." && $file !="..") {
// Do stuff here
}`

在您的代码中，如下所示：

```
foreach($files as $file){
    if ($file != "." && $file !="..") {
        $count++;
        echo '<div style="float:left; margin: 0 0 10px 10px;border:1px solid       #50A4AB;  width:200px"><br>';
        if(strpos($file,".php")){
            // This is a big security vulnerability
            include($dir.$file);
        }
        echo '</div><br>';
        if($count==7){echo'<div style="clear:both;"></div><br>';}
    }
} 
```

# regex - 查看正则表达式重复是否可减少的算法

> ID：11182738
> 
> 赞同：5
> 
> 时间：2012-06-25T02:04:53.967
> 
> 标签：regex, algorithm, language-agnostic

我正在寻找一种可以检查嵌套正则表达式重复是否可减少的算法。假设解析正则表达式已经完成。

### 例子：

```
(1{1,2}){1,2} === 1{1,4}
    It matches 1, 11, 111, 1111 which can be rewritten as a single repeat

(1{2,2}){1,2} can not be reduced
    It matches 11 and 1111 which can not be rewritten as a single repeat.

(1{10,11}){1,2} can not be reduced

(1{10,19}){1,2} === 1{10,38}

(1{1,2}){10,11} === 1{10,22}

(1{10,11})* can not be reduced

(1*){10,11} === 1* 
```

我一直在尝试为这种类型的操作找到一种模式，而不必匹配所有可能的解决方案并寻找可以防止它被减少的漏洞。必须有一个简单的函数 ( `f( A, B, C, D ) -> ( E, F )`) 可以解决这样的任意输入：

```
(1{A,B}){C,D} -> 1{E,F} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T05:50:15.697

```
// (x{A,B}){C,D} -> x{E,F}
bool SimplifyNestedRepetition(int A, int B,
                              int C, int D,
                              out int E, out int F)
{
    if (B == -1 || C == D || A*(C+1) <= B*C + 1)
    {
        E = A*C;

        if (B == -1 || D == -1) F = -1;
        else F = B*D;

        return true;
    }
    return false;
} 
```

*   如果`x{A,B}`是无限的，它可以重复任意次数。
*   `(x{A,B}){C}`总是可约的。
*   如果，您可以减少它，因为在最长的重复序列和最短的重复`A*(C+1) <= B*C + 1`序列之间没有间隙。`C``C+1`

`B = -1`or`D == -1`表示无限，比如`x*`or `x{5,}`。

* * *

## 测试用例：

```
Input           Reducible?
(x{0,0}){0,0}   Yes - x{0,0}
(x{0,1}){0,0}   Yes - x{0,0}
(x{0,2}){0,0}   Yes - x{0,0}
(x{1,1}){0,0}   Yes - x{0,0}
(x{1,2}){0,0}   Yes - x{0,0}
(x{1,3}){0,0}   Yes - x{0,0}
(x{2,2}){0,0}   Yes - x{0,0}
(x{2,3}){0,0}   Yes - x{0,0}
(x{2,4}){0,0}   Yes - x{0,0}
(x{0,0}){0,1}   Yes - x{0,0}
(x{0,1}){0,1}   Yes - x{0,1}
(x{0,2}){0,1}   Yes - x{0,2}
(x{1,1}){0,1}   Yes - x{0,1}
(x{1,2}){0,1}   Yes - x{0,2}
(x{1,3}){0,1}   Yes - x{0,3}
(x{2,2}){0,1}   No 
(x{2,3}){0,1}   No 
(x{2,4}){0,1}   No 
(x{0,0}){0,2}   Yes - x{0,0}
(x{0,1}){0,2}   Yes - x{0,2}
(x{0,2}){0,2}   Yes - x{0,4}
(x{1,1}){0,2}   Yes - x{0,2}
(x{1,2}){0,2}   Yes - x{0,4}
(x{1,3}){0,2}   Yes - x{0,6}
(x{2,2}){0,2}   No 
(x{2,3}){0,2}   No 
(x{2,4}){0,2}   No 
(x{0,0}){1,1}   Yes - x{0,0}
(x{0,1}){1,1}   Yes - x{0,1}
(x{0,2}){1,1}   Yes - x{0,2}
(x{1,1}){1,1}   Yes - x{1,1}
(x{1,2}){1,1}   Yes - x{1,2}
(x{1,3}){1,1}   Yes - x{1,3}
(x{2,2}){1,1}   Yes - x{2,2}
(x{2,3}){1,1}   Yes - x{2,3}
(x{2,4}){1,1}   Yes - x{2,4}
(x{0,0}){1,2}   Yes - x{0,0}
(x{0,1}){1,2}   Yes - x{0,2}
(x{0,2}){1,2}   Yes - x{0,4}
(x{1,1}){1,2}   Yes - x{1,2}
(x{1,2}){1,2}   Yes - x{1,4}
(x{1,3}){1,2}   Yes - x{1,6}
(x{2,2}){1,2}   No 
(x{2,3}){1,2}   Yes - x{2,6}
(x{2,4}){1,2}   Yes - x{2,8}
(x{0,0}){1,3}   Yes - x{0,0}
(x{0,1}){1,3}   Yes - x{0,3}
(x{0,2}){1,3}   Yes - x{0,6}
(x{1,1}){1,3}   Yes - x{1,3}
(x{1,2}){1,3}   Yes - x{1,6}
(x{1,3}){1,3}   Yes - x{1,9}
(x{2,2}){1,3}   No 
(x{2,3}){1,3}   Yes - x{2,9}
(x{2,4}){1,3}   Yes - x{2,12}
(x{0,0}){2,2}   Yes - x{0,0}
(x{0,1}){2,2}   Yes - x{0,2}
(x{0,2}){2,2}   Yes - x{0,4}
(x{1,1}){2,2}   Yes - x{2,2}
(x{1,2}){2,2}   Yes - x{2,4}
(x{1,3}){2,2}   Yes - x{2,6}
(x{2,2}){2,2}   Yes - x{4,4}
(x{2,3}){2,2}   Yes - x{4,6}
(x{2,4}){2,2}   Yes - x{4,8}
(x{0,0}){2,3}   Yes - x{0,0}
(x{0,1}){2,3}   Yes - x{0,3}
(x{0,2}){2,3}   Yes - x{0,6}
(x{1,1}){2,3}   Yes - x{2,3}
(x{1,2}){2,3}   Yes - x{2,6}
(x{1,3}){2,3}   Yes - x{2,9}
(x{2,2}){2,3}   No 
(x{2,3}){2,3}   Yes - x{4,9}
(x{2,4}){2,3}   Yes - x{4,12}
(x{0,0}){2,4}   Yes - x{0,0}
(x{0,1}){2,4}   Yes - x{0,4}
(x{0,2}){2,4}   Yes - x{0,8}
(x{1,1}){2,4}   Yes - x{2,4}
(x{1,2}){2,4}   Yes - x{2,8}
(x{1,3}){2,4}   Yes - x{2,12}
(x{2,2}){2,4}   No 
(x{2,3}){2,4}   Yes - x{4,12}
(x{2,4}){2,4}   Yes - x{4,16} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T08:00:14.340

如果您不使用反向链接等“高级”正则表达式功能，那么正则表达式只是有限状态自动机，是状态机的简单版本。它们具有非常好的特性，即对于所有 FSA，都存在*一个唯一的*最小 FSA，甚至很容易找到它：[Wikipedia](http://en.wikipedia.org/wiki/Finite-state_machine)

虽然您的问题似乎更具体，但我相信查看其中描述的一些最小化算法可能会很有用。

# android - 在 IIS 上部署 WCF 数据服务和在 localhost 上运行它之间的区别

> ID：11182739
> 
> 赞同：0
> 
> 时间：2012-06-25T02:05:16.900
> 
> 标签：android, iis, localhost, wcf-data-services

我正在学习一个教程（http://anindita9.wordpress.com/2012/01/02/sumption-sql-serversql-azure-data-in-windows-phone-7-1-android-through-odata-wcf- data-services-entity-frameworks/) 表示我必须通过 IIS 部署我的 .net WCF 数据服务，然后在 Android 上使用它。在 IIS 上部署 web 服务时，我遇到了一些问题。所以我需要知道当 WCF 数据服务在 localhost 上运行时，Android 是否可以使用 Web 服务？所以我可以跳过解决 IIS 部署的问题吗？谢谢。

# actionscript-3 - 如何将 Gaia Framework 与 Facebook Graph API 连接起来？

> ID：11182740
> 
> 赞同：0
> 
> 时间：2012-06-25T02:05:17.190
> 
> 标签：actionscript-3, facebook-graph-api, gaia

我正在尝试将 Facebook 应用程序包含在使用 GAIA 框架开发的 Flash 网站的一部分中。我遵循了许多示例和教程，并尝试在导航页面上进行简单的登录。

我导入的类（所有的 facebook api？）：

```
import com.adobe.serialization.json.JSON;
import com.facebook.graph.Facebook;
import com.facebook.graph.controls.*;
import com.facebook.graph.core.*;
import com.facebook.graph.data.*;
import com.facebook.graph.net.*;
import com.facebook.graph.utils.*; 
```

我的 var 和 facebook id：

```
private var FB_app_id:String = 'my app id goes here :)'; 
```

我的构造函数：

```
 public function NavPage()
    {
        super();
        alpha = 0;          
        init();
        Facebook.init(FB_app_id);
    } 
```

所以，每次我尝试发布时，都会出现以下错误：

> C:\PROJECT ZERO\1 - Proyectos\2p - WEB\src\com\facebook\graph\data\FQLMultiQuery.as，第 80 1061 行：通过静态类型 Class 的引用调用可能未定义的方法编码。

FQLMultiQuery.as 的第 80 行引用了以下代码：

```
 public function toString():String {
        return JSON.encode(queries);            
    } 
```

有什么问题？我究竟做错了什么？我开始认为这可能是 GAIA 和 Facebook API 之间的不兼容问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T08:58:59.927

您似乎与本机 JSON（自 flash player 11 起）和 com.adobe.serialization.json 包中的 JSON 存在冲突。

我的解决方案是重命名第二个。或者开始使用新的 JSON 并从项目中排除 com.adobe.serialization.*。

参考：
[http ://www.pippoflash.com/index.php/2012/06/20/flash-player-10-and-flash-player-11-json-json-conflict-solved/](http://www.pippoflash.com/index.php/2012/06/20/flash-player-10-and-flash-player-11-json-json-conflict-solved/)

# unix - 将 unix 可执行文件转换为纯文本

> ID：11182741
> 
> 赞同：1
> 
> 时间：2012-06-25T02:05:42.553
> 
> 标签：unix

我看到很多人将文本转换为 unix 文件。有什么方法可以做相反的事情`unix executable file`吗`.txt`？

（我需要在mac os下读取unix可执行文件。如果无法转换文件，有没有办法可以读取它们？`UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa0 in position 468: invalid start byte` ）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-05-28T15:07:29.267

我注意到它`nano`似乎会自动转换为文本，尽管我希望能够在文本编辑器中查看它，所以我仍在尝试寻找另一种方式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T02:53:11.433

如果您尝试在 Python 中读取文件，则需要将“b”附加到模式以避免换行符替换。

# javascript - 放大地图图像，带有突出显示的部分

> ID：11182755
> 
> 赞同：2
> 
> 时间：2012-06-25T02:09:31.033
> 
> 标签：javascript, html, css, map, imagemap

我必须对我正在创建的网站的图像做 4 件事。

1.  您应该能够放大和缩小图像。
2.  当您翻转图像的某个部分时，它应该突出显示该部分。
3.  翻转图像时，应显示工具提示。
4.  单击其中一个翻转部分时，它应该链接到不同的页面

这是图像![在此处输入图像描述](../Images/f4b300ad8e6c0debbe156ebe31ea2ac6.png)

如您所见，它非常复杂。我有一个非常 hq 版本的图像，我将用于该站点。

这是一个零售公园的形象，所以当你翻转某个零售时。要么整个​​图像变暗并显示您所在零售店的工具提示，否则它只会变得更加突出并显示工具提示。

我将如何在 html、css 和 jquery 中执行此操作？像[这样](http://davidlynch.org/projects/maphilight/docs/demo_world.html#)的东西会很完美，尽管我需要能够放大图像

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T04:03:40.773

我建议你找一些像谷歌地图这样的东西，它可以让你指定你自己的图像。在线快速搜索显示：

谷歌地图教程：
- [http://forevermore.net/articles/photo-zoom/](http://forevermore.net/articles/photo-zoom/)
- [http://blog.mikecouturier.com/2011/07/create-zoomable-images-using-google.html](http://blog.mikecouturier.com/2011/07/create-zoomable-images-using-google.html)
第 3 方库：
- [http://www.maplib.net/](http://www.maplib.net/) （*链接已过期*）
- [http://mashupforge.com/](http://mashupforge.com/)（*链接已过期*）

我相信还有更多。基本上，这些应该为您提供谷歌地图的所有功能，但不必自己重新编码。您可以指定边界并执行所有正常的谷歌地图工作，并使用其各种 api 功能将其链接出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T21:55:39.263

[Mashupforge](http://mashupforge.com)的开发者在这里。您可以使用 Mashupforge 轻松完成所有操作，但第 2 项除外。当您将鼠标悬停在标记上时，我们不支持突出显示。除此之外，您只需上传您的源图像，该应用程序基本上会为您创建一个可缩放、可拖动的地图。如果您有任何问题，请随时与我联系！

# c - C中变量的位置

> ID：11182759
> 
> 赞同：2
> 
> 时间：2012-06-25T02:11:26.853
> 
> 标签：c, operating-system, osdev

我试图了解 C 如何将内存分配给全局变量。

我正在研究一个简单的内核。到目前为止，除了打印到屏幕和启用中断之外，它不能做更多的事情。我现在正在开发一个基本的物理内存管理器。

我的内存管理器是一个位图，如果内存已分配或可用，则设置为 1 或 0。我需要将我的内核正在使用的内存作为“已分配”添加到位图中，因此没有任何内容会覆盖它。

我可以很容易地找到内核的开始，因为它被静态加载到 0x100000。弄清楚长度也不应该太难。我不确定的部分是全局变量在内存中的位置？

假设我的内核是 12K，然后我可以将这些 3x 4K 内存块分配给它以进行保护。我需要分配更多来覆盖它使用的变量吗？或者变量是 12K 的一部分？

谢谢你的帮助，我希望我有足够的意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:13:22.570

看一下

[http://www.geeksforgeeks.org/archives/14268](http://www.geeksforgeeks.org/archives/14268)

你的全局变量大多在 BSS 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T12:55:04.523

正如前面的答案所说，大多数变量都存储在 .bss 部分中，但它们也可以存储在 .data 或 .rodata 部分中，具体取决于您将全局变量定义为 static 还是 const。编译后，您可以使用 readelf -S kernel.bin 查看每个部分将使用多少空间。对于 .bss 部分，仅当二进制文件加载到内存中时才会占用内存，并且不占用磁盘空间。这意味着您编译的内核二进制文件将小于它稍后放入内存时使用的实际大小（通常通过 grub）。

除了使用 readelf 之外，确定内核将使用多少数据的简单方法是将 .bss 部分放在链接描述文件的 .data 部分中。然后内核二进制文件的大小在磁盘上和内存中的大小相同（或者实际上它在内存中会小一点，因为并非所有部分都被 grub 复制）但是至少你知道你的最小内存量需要分配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T17:26:46.130

我建议使用自定义链接器脚本（假设您使用`gcc`）：它使内核部分的布局明确且可定制（要了解有关链接器脚本的更多信息，请阅读`info ld`）。[您可以在此处](https://github.com/EarlGray/COSEC/blob/master/vmcosec.lds.S)查看我的操作系统链接器脚本的示例。

要查看默认链接描述文件，请使用`-v`/`--verbose`选项`ld`。

大部分全局变量位于`.data.*`和`.rodata.*`节中，用 0 初始化的变量进入`.bss`.

# php - Chrome 将 CSS 样式表解释为图像

> ID：11182762
> 
> 赞同：4
> 
> 时间：2012-06-25T02:12:06.833
> 
> 标签：php, css, codeigniter, http-headers

在我的 CodeIgniter 网站中，当在 Chrome 中查看时，控制台显示警告

`style.css interpreted as IMAGE but transferred with MIME type text/css`

该页面按我的预期呈现，但是当我右键单击并检查任何元素时，它的“计算样式”显示为空白，使调试变得困难。

这就是我提供 CSS 文件的方式

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title><?php echo $title; ?></title>        
        <link rel="icon" type="image/png" href="<?= base_url('assets/images/favicon.png'); ?>" />       
        <link rel="stylesheet" type="text/css" media="all" href="<?= base_url('assets/css/style.css');?>" />
        <link href='http://fonts.googleapis.com/css?family=Oswald:400,700|Open+Sans+Condensed:300,300italic,700' rel='stylesheet' type='text/css'>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>        
    </head> 
```

使用 Chrome 扩展程序，我在请求 style.css 时监控了标头的发送，这就是我得到的：

![在此处输入图像描述](../Images/1bcf96c3cafd86e2ffd0c4295f0c5796.png)

**编辑**

这是在共享的 Godaddy 主机上的 LAMP 服务器上。我的重写 htaccess 仅包含以下重写规则：

```
RewriteEngine On
RewriteCond  %{REQUEST_FILENAME} !-f
RewriteCond  %{REQUEST_FILENAME} !-d
RewriteBase /
RewriteRule ^(.*)$ /index.php?$1 [L] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T02:31:35.580

这很可能是由 css 文件中的无效相对路径引起的。

例如*，在 html 中*`<img src="" />`，可以通过添加将被解析为相对路径并解析为 *current_page_url*来复制类似的消息- 提示“...但使用 MIME 类型文本/html 传输”错误。

# python - 如何在 Python 中使用 MinGW-w64 构建我的 C 扩展？

> ID：11182765
> 
> 赞同：26
> 
> 时间：2012-06-25T02:12:27.997
> 
> 标签：python, c, compilation, 64-bit

所以我有一些 Python C 扩展，我之前构建并用于在 Win7 中运行的 32 位 Python。但是，我现在已经切换到 64 位 Python，并且在使用 MinGW-w64 构建 C 扩展时遇到了问题。

我根据[这篇文章](http://bugs.python.org/issue11723)对 distutils 进行了更改，但我收到了一些奇怪的错误，表明有问题：

```
$ python setup.py build
running build
running build_ext
building 'MyLib' extension
c:\MinGW64\bin\x86_64-w64-mingw32-gcc.exe -mdll -O -Wall -Ic:\Python27\lib\site-packages\numpy\core\include -Ic:\Python27\include -Ic:\Python27\PC -c MyLib.c -o build\temp.win-amd64-2.7\Release\mylib.o
MyLib.c: In function 'initMyLib':
MyLib.c:631:5: warning: implicit declaration of function 'Py_InitModule4_64' [-Wimplicit-function-declaration]
writing build\temp.win-amd64-2.7\Release\MyLib.def
c:\MinGW64\bin\x86_64-w64-mingw32-gcc.exe -shared -s build\temp.win-amd64-2.7\Release\mylib.o build\temp.win-amd64-2.7\Release\MyLib.def -Lc:\Python27\libs -Lc:\Python27\PCbuild\amd64 -lpython27 -o build\lib.win-amd64-2.7\MyLib.pyd
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x13d): undefined reference to `__imp_PyExc_ValueError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x1275): undefined reference to `__imp_PyExc_ValueError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x1eef): undefined reference to `__imp_PyExc_ImportError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x1f38): undefined reference to `__imp_PyExc_AttributeError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x1f4d): undefined reference to `__imp_PyCObject_Type'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x1f61): undefined reference to `__imp_PyExc_RuntimeError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x1fc7): undefined reference to `__imp_PyExc_RuntimeError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x1ffe): undefined reference to `__imp_PyExc_RuntimeError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x2042): undefined reference to `__imp_PyExc_RuntimeError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x206c): undefined reference to `__imp_PyExc_RuntimeError'
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x208a): more undefined references to `__imp_PyExc_RuntimeError' follow
build\temp.win-amd64-2.7\Release\mylib.o:MyLib.c:(.text+0x20a7): undefined reference to `__imp_PyExc_ImportError'
collect2.exe: error: ld returned 1 exit status
error: command 'x86_64-w64-mingw32-gcc' failed with exit status 1 
```

我用谷歌搜索了很多信息，但要找到明确的答案并不容易。有人可以对此有所了解吗？为了能够在 Win7 中为 64 位 Python 成功构建 C 扩展，我应该做哪些进一步的更改？

编辑：

在下面 cgohlke 的评论中提供了一些有用的指示后，我设法生成了`libpython27.a`. 但是，在遵循[这篇文章](https://groups.google.com/forum/?fromgroups#!topic/cython-users/r_0A5AHwiak)的建议（倒数第二个）之后，我仍然遇到了`__imp_Py_InitModule4_64`错误。在经过一番严肃的 Google-fu 之后，我设法绊倒了[这篇文章](http://deeplearning.net/software/theano/_sources/install.txt)，告诉我将`Py_InitModule4`行重命名为`Py_InitModule4_64`. 在那之后，一切都顺利进行。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-03T19:38:20.187

这对我使用 Python 3.3 有用：

1.  从 dll 创建静态 python 库

    python dll通常在C:/Windows/System32；在 msys 外壳中：

    ```
    gendef.exe python33.dll

    dlltool.exe --dllname python33.dll --def python33.def --output-lib libpython33.a

    mv libpython33.a C:/Python33/libs 
    ```

2.  使用 swig 生成包装器

    例如， `swig -c++ -python myExtension.i`

3.  wrapper 必须用 MS_WIN64 编译，否则当你在 Python 中导入类时你的电脑会崩溃

    ```
    g++ -c myExtension.cpp -I/other/includes

    g++ -DMS_WIN64 -c myExtension_wrap.cxx -IC:/Python33/include 
    ```

4.  共享库

    ```
    g++ -shared -o _myExtension.pyd myExtension.o myExtension_wrap.o -lPython33 -lOtherSharedLibs -LC:/Python33/libs -LC:/path/to/other/shared/libs 
    ```

5.  确保所有共享库（gdal、OtherSharedLibs）都在您的 PATH 中（Windows 不使用 LD_LIBRARY_PATH 或 PYTHONPATH）

6.  在 Python 中，只需：导入 myExtension

瞧！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2019-07-19T09:09:13.347

我意识到这是一个老问题，但它仍然是最热门的搜索结果。今天，在 2019 年，我能够做到这一点：

[https://github.com/PetterS/quickjs/commit/67bc2428b8c0716538b4583f4f2b0a2a5a49106c](https://github.com/PetterS/quickjs/commit/67bc2428b8c0716538b4583f4f2b0a2a5a49106c)

简而言之：

1.  确保 64 位版本的 mingw-w64 在 PATH 中。
2.  猴子补丁 distutils：

    ```
    import distutils.cygwinccompiler
    distutils.cygwinccompiler.get_msvcr = lambda: [] 
    ```

3.  shell wrt 转义的一些差异。

4.  `extra_link_args = ["-Wl,-Bstatic", "-lpthread"]`为了静态链接并且没有额外的运行时依赖。

5.  `pipenv run python setup.py build -c mingw32`现在工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-27T11:16:08.610

我为 setuptools 创建了一个猴子补丁，让您可以轻松地在 Windows 上使用 mingw64 构建_ext。见[https://github.com/imba-tjd/mingw64ccompiler](https://github.com/imba-tjd/mingw64ccompiler)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-19T14:56:34.320

这是 VC++ 构建工具的示例代码 [https://github.com/starnight/python-c-extension/tree/master/00-HelloWorld](https://github.com/starnight/python-c-extension/tree/master/00-HelloWorld)

你可以试试：

```
python setup.py -c mingw32 
```

但是，这对我不起作用。

我的解决方案是：

1.  安装 Anaconda 64 位 python 3.6

2.  安装[mingw64](https://sourceforge.net/projects/mingw-w64/)

3.  将 mingw64/bin 添加到 PATH
4.  从c文件编译dll

    ```
    gcc -c libmypy.c -IC:\Users\{user_name}\Anaconda3\pkgs\python-3.6.4-h6538335_1\include  
    gcc -shared -o libmypy.dll libmypy.o  -LC:\Users\{user_name}\Anaconda3\pkgs\python-3.6.4-h6538335_1\libs -lPython36 
    ```

5.  在 .py 脚本中加载 dll 文件

    ```
    from ctypes import *  
    m = cdll.LoadLibrary(r"C:\{path_to_dll}\libmypy.dll")  
    print(m.hello()) 
    ```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-03-26T14:30:41.827

我使用这个线程来学习如何制作 C 扩展，并且由于我学到的大部分内容都在其中，我想我也将最后的发现放在这里，以便其他人在寻找时可以找到它。

我并没有试图编译一些大的东西，只是 Hetland's Starting Python 中的示例。这是我所做的（示例 C pgm 称为 palindrome.c）。我正在使用带有 python 3.7 的 Anaconda，以及 MinGW64 的 TDM-GCC 版本。我将所有使用的工具放入我的 Path 中，并将 PYTHONPATH 中所需的所有路径以及 ..\Anaconda3 目录放入 PYTHON_HOME。我最终还是在某些事情上使用了显式路径。

如上所述，我使用 gendef.exe 和 dlltool.exe 创建了 libpython37.a 库，并将其放在 ..\Anaconda3\libs 中。

我按照赫特兰的处方：

gcc -c palindrome.c

gcc -I$PYTHON_HOME -I$PYTHON_HOME/包含 -c palindrome_wrap.c

第二次失败，编译器找不到 Python.h，以下工作：

gcc -I[一些目录]\Anaconda3\Include -c palindrome_wrap.c

然后我做了，正如许多人所说，包括 Hetland 3rd ed.，

gcc -shared palindrome.o palindrome_wrap.o [一些目录]/Anaconda3/libs/libpython37.a -o _palindrome.dll

这没有用。即使使用了加载库 cswu（我也在其他地方找到）。

所以我gendef'd _palindrome.dll 并且在导出中找不到函数“is_palindrome”。我浏览了一些 SWIG 文档，并在 %{ %} 部分及其下方（均为 extern）中声明了该函数，最终在 palindrome_wrap.c 中获得了应有的函数 extern。但是没有导出，所以我回到 palindrome.c 并将函数重新声明为：

declspec(dllexport) extern int __stdcall is_palindrome(char* text)

并在上面的两个地方用这个签名在 palindrome.i 中重新声明它。

部分成功！当我 gendef'd _palindrome.dll 时，它被列在导出部分，我可以使用 Load Library 进行 cswu 的调用。但仍然不按赫特兰所说和做的

导入_回文

在 Python 中。

再次回到所有来源，我无法弄清楚这一点。我终于从一开始就开始阅读 SWIG 文档，不遗余力——通过手册搜索并没有找到找到的地方。

在介绍部分结束时。2.7 并入构建系统，在示例 Make 过程下，它说：

“上面的示例将生成本机构建文件，例如 makefile、nmake 文件和 Visual Studio 项目，它们将调用 SWIG 并将生成的 C++ 文件编译为 _example.so (UNIX) 或 _example.pyd (Windows)。对于 Windows 上的其他目标语言通常会生成一个 dll，而不是 .pyd 文件。”

这就是最后一个问题的答案：

dll 的编译步骤应为：

gcc -shared palindrome.o palindrome_wrap.o [一些目录]/Anaconda3/libs/libpython37.a -o **_palindrome.pyd**

（我没有回去更改我的 declspec 声明，所以我不知道它们是否有必要，所以它们也仍然存在）。

我有一个文件，_palindrome.pyd

如果在 PYTHONPATH 中（我的是本地的）工作，然后可以做

导入_回文

从 _palindrome 导入 is_palindrome

并按照承诺在 python 中使用导出、正确包装和打包的 C 函数，使用 TDM-GCC 编译。gcc，它是 MinGW64 在不同的安装，知道如何做 .pyd 文件。我区分了 dll 和 pyd，因为它们的字节长度相同。它们在数百个点上**都不相同。**

希望这对其他人有帮助。

# c# - 哈希函数的简单实现

> ID：11182767
> 
> 赞同：0
> 
> 时间：2012-06-25T02:12:55.813
> 
> 标签：c#, .net, hash

我正在研究哈希算法。我已经学会了如何使用散列函数和在许多框架中实现的方法，但我需要知道如何自己实现散列函数或实现一个简单散列函数的基本步骤。

我在哪里可以找到这方面的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:32:31.063

有许多哈希算法可以实现，.Net 库本身提供了一堆。但是，如果你想实现一个，你需要先选择一个算法。以下是[Tiger Hash](http://www.codeproject.com/Articles/149061/A-Tiger-Hash-Implementation-for-C)的实现。另一个哈希函数实现是由[Davy Landman](http://landman-code.blogspot.com.au/2009/02/c-superfasthash-and-murmurhash2.html)实现的。查看代码可能会帮助您入门。

# c# - 如何在工具提示 C# 上禁用视觉样式

> ID：11182772
> 
> 赞同：0
> 
> 时间：2012-06-25T02:13:22.100
> 
> 标签：c#, .net, winforms, controls, tooltip

如何仅为工具提示禁用视觉样式，而不是为所有应用程序禁用视觉样式，因为如果这样做会改变我的工具条视觉样式并且看起来很难看？

**是）我有的：**

![愚蠢的工具提示](../Images/d96cc889e0aeea80d52d1e7bb6374e60.png)

**我想要的是：**

![更好的工具提示](../Images/76039379a426e1003d383c5fb7ef3bd7.png)

出于某种原因，它只是行不通。谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:35:53.547

我相信您会想要研究使用[Tooltip.OwnerDraw](http://msdn.microsoft.com/en-us/library/system.windows.forms.tooltip.ownerdraw.aspx)属性。MSDN 链接中的示例程序具有您想要的样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:41:58.247

如果您正在寻找 WPF 解决方案，您需要覆盖工具提示的默认模板。如果您正在寻找 WinForms 解决方案，Mark Hall 的回答是正确的。

**更新：** 在添加评论之前发布此问题，并将问题重新标记为 WinForms。我把它留给任何寻找 WPF 解决方案的人。

XAML：

```
<ToolTip>
    <ToolTip.Style>
        <Style TargetType="{x:Type ToolTip}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Border Background="LightGoldenrodYellow" BorderBrush="DimGray" BorderThickness=".5" Padding="5">
                            <TextBlock Text="This is text"/>
                        </Border>
                    </ControlTemplate>                                  
                </Setter.Value>
            </Setter>
        </Style>
    </ToolTip.Style>
</ToolTip> 
```

# php - 表格到电子邮件联系表格

> ID：11182774
> 
> 赞同：1
> 
> 时间：2012-06-25T02:15:40.203
> 
> 标签：php, forms, email, send

嗨，我的 PHP 代码在通过联系表格发送电子邮件时遇到问题。该表格过去可以工作，但它停止发送电子邮件。我是 php 新手，所以请帮忙。我没有收到任何错误，并且在彻底研究后看不出代码有任何问题，有人可以帮助我吗？这是我的代码...

```
<?php
if(isset($_POST['email'])) {

    // EDIT THE 2 LINES BELOW AS REQUIRED
    $email_to = "#@gmail.com";
    $email_subject = "##";

    function died($error) {
        // your error code can go here   
        echo "<img src=\"../images/errors.found.png\"/>";
        echo "<br /><img src=\"../images/errors.below.png\"/><br /><br />";
        echo $error."<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;               &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href='/home/form/contactform.htm'><img src=\"../images/back.png\"/></a>"; 
        die();
    }

    // validation expected data exists
    if(!isset($_POST['first_name']) ||
        !isset($_POST['last_name']) ||
        !isset($_POST['email']) ||
        !isset($_POST['telephone']) ||
        !isset($_POST['guests']) ||
        !isset($_POST['comments'])) {
        died('');       
    }

    $first_name = $_POST['first_name']; // required
    $last_name = $_POST['last_name']; // required
    $email_from = $_POST['email']; // required
    $telephone = $_POST['telephone']; //  required
    $guests = $_POST['guests']; //  required
    $comments = $_POST['comments']; // required

    $error_message = "";

    $string_exp = "/^[A-Za-z .'-]+$/";
  if(!preg_match($string_exp,$first_name)) {
    $error_message .= '<img src="../images/fname.valid.png" width="744" height="26" /><br />';
  }
  if(!preg_match($string_exp,$last_name)) {
    $error_message .= '<img src="../images/lname.valid.png" width="744" height="26" /><br />';
  }
    $email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
  if(!preg_match($email_exp,$email_from)) {
    $error_message .= '<img src="../images/email.vaild.png" width="744" height="26" /><br />';
  }
    $string_exp = "/^[0-9 .'-]+$/";
  if(!preg_match($string_exp,$telephone)) {
    $error_message .= '<img src="../images/phone.valid.png" width="744" height="26" /><br />';
  }  
    $string_exp = "/^[0-9 .'-]+$/";
  if(!preg_match($string_exp,$guests)) {
    $error_message .= '<img src="../images/guests.valid.png" width="744" height="26" /><br />';
  }
  if(strlen($comments) < 0) {
    $error_message .= '<img src="../images/comments.valid.png" width="744" height="26" /><br />';
  }
  if(strlen($error_message) > 0) {
    died($error_message);
  }
    $email_message = "Form details below.\n\n";

    function clean_string($string) {
      $bad = array("content-type","bcc:","to:","cc:","href");
      return str_replace($bad,"",$string);
    }

    $email_message .= "First Name: ".clean_string($first_name)."\n";
    $email_message .= "Last Name: ".clean_string($last_name)."\n";
    $email_message .= "Email: ".clean_string($email_from)."\n";
    $email_message .= "Telephone: ".clean_string($telephone)."\n";
    $email_message .= "Number of guests: ".clean_string($guests)."\n";
    $email_message .= "Comments: ".clean_string($comments)."\n";

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers);  
?>

<!-- include your own success html here -->

<br /><br /><br /><br /><br /><br /><br /><img src="../images/email_sent.gif" width="685" height="51" />
<?php
}
?> 
```

# css - 如何在 html 列表中设置数字样式？

> ID：11182775
> 
> 赞同：20
> 
> 时间：2012-06-25T02:15:43.953
> 
> 标签：css, html-lists

**是否可以仅**在有序列表上设置样式或增加数字的大小？

我打算将有序列表`ol`变成仅使用 CSS的[wikihow步骤之类的东西。](http://www.wikihow.com/Create-CSS)

这是一个可以玩的例子：http: [//jsfiddle.net/ejRzy/1/](http://jsfiddle.net/ejRzy/1/)

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-25T03:02:47.490

它可以使用 CSS3 但不是 100% 跨浏览器（即 IE7）来完成。使用伪 :before 元素和 counter-reset 和 counter-increment 您可以隐藏列表样式并创建自己的样式。

这是一篇概述如何的文章：[样式化有序列表编号](http://www.456bereastreet.com/archive/201105/styling_ordered_list_numbers/)

[这](http://jsfiddle.net/rlemon/YLw3k/)是从那篇文章构建的演示。

同样在可怕的链接腐烂的情况下 - 这是所需的主要 CSS 代码（这可以应用于任何有序列表）

```
ol {
    counter-reset:li; /* Initiate a counter */
    margin-left:0; /* Remove the default left margin */
    padding-left:0; /* Remove the default left padding */
}
ol > li {
    position:relative; /* Create a positioning context */
    margin:0 0 6px 2em; /* Give each list item a left margin to make room for the numbers */
    padding:4px 8px; /* Add some spacing around the content */
    list-style:none; /* Disable the normal item numbering */
    border-top:2px solid #666;
    background:#f6f6f6;
}
ol > li:before {
    content:counter(li); /* Use the counter as content */
    counter-increment:li; /* Increment the counter by 1 */
    /* Position and style the number */
    position:absolute;
    top:-2px;
    left:-2em;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
    box-sizing:border-box;
    width:2em;
    /* Some space between the number and the content in browsers that support
       generated content but not positioning it (Camino 2 is one example) */
    margin-right:8px;
    padding:4px;
    border-top:2px solid #666;
    color:#fff;
    background:#666;
    font-weight:bold;
    font-family:"Helvetica Neue", Arial, sans-serif;
    text-align:center;
}
li ol,
li ul {margin-top:6px;}
ol ol li:last-child {margin-bottom:0;}​ 
```

此代码将生成一个自定义排序列表；尽管不是您要求的样式。我将把定制工作留给你 :) 干杯

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-25T02:23:15.797

有点....用您想要的数字字体大小为您的有序列表设置样式，然后将所有列表项包装在跨度中，并为它们提供不同的样式。

[http://jsfiddle.net/keith_nicholas/MEHXj/](http://jsfiddle.net/keith_nicholas/MEHXj/)

# android - Fb个人资料图片质量不高

> ID：11182780
> 
> 赞同：0
> 
> 时间：2012-06-25T02:16:22.693
> 
> 标签：android

我使用了以下代码，能够获取图像，但是当我尝试将其放在布局背景（线性布局）上时，图像质量会降低并且显示图像模糊。

```
URL img_value = null;

    try {
        img_value = new URL("http://graph.facebook.com/"+userId+"/picture?type=large");

    } catch (MalformedURLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    Bitmap mIcon1 = null;
    try {
        BitmapFactory.Options opt=new BitmapFactory.Options(); 
        opt.inSampleSize=1;
        // mIcon1 = BitmapFactory.decodeFile(pathoffile,opt);

        mIcon1 = BitmapFactory.decodeStream(img_value.openConnection().getInputStream(),null,opt);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    ll=(LinearLayout) findViewById(R.id.ll);
    BitmapDrawable background = new BitmapDrawable(mIcon1);
    ll.setBackgroundDrawable(background); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:21:50.457

看起来您正试图将该图像设置为 LinearLayout 的背景。我将假设这个背景大约是手机屏幕的大小。

我刚刚尝试了那个 facebook URL，我得到的图像大小是 180x195。

考虑到我所知道的最小的 Android 屏幕是 240x320，因此必须在每部 Android 手机上放大该图像。这将导致图像看起来模糊，因为图像的分辨率远低于 Android 屏幕的分辨率。

我建议您为您的背景找到更高分辨率的图像。

# actionscript-3 - Actionscript 3：在影片剪辑分组中引用数据

> ID：11182781
> 
> 赞同：0
> 
> 时间：2012-06-25T02:16:30.993
> 
> 标签：actionscript-3, inheritance, reference, movieclip

我是一个非常新的程序员。我正在为我朋友的游戏制作一个角色计算器，但主要是为了自己练习。

我正在使用 Actionscript 进行编程，并且一直在尝试引用列表中的数据，这一直运行良好，除非我的列表与其他任何东西组合在一起作为一个符号 (MovieClip)。

我浏览了互联网并尝试了 getChild() （尽管我不是其他符号中的正符号意味着它们是它们的孩子），以及将 MovieClip(parent).ListName.Data 尝试引用它。我也简单地尝试将 ListParent.ListName.Data 引用它，但恐怕我不知所措。

我确信答案很明显，但谷歌似乎并没有查明我的问题。这是代码——我的列表的 dataProvider 对于我的数据点几乎只有 1、2、3、4、5，所以在这里我试图引用列表选择 2：

```
earthponyRacials.earthponyList1.addEventListener(Event.CHANGE, testText);

function testText(event:Event) {
    if(earthponyRacials.earthponyList1.data == 2){
        trace("Function working?");
    }
} 
```

这是我的参考错误：

```
ReferenceError: Error #1069: Property data not found on fl.controls.List and there is no default value.
at CharacterCalculator_fla::MainTimeline/testText()
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at fl.controls::SelectableList/handleCellRendererClick() 
```

如果这是一个非常明显的问题，我很抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T02:29:11.817

您必须使用以下方式访问列表数据：

```
YourList.dataProvider.getItemAt( ItemsIndex ).data; 
```

您还可以通过将 .data 替换为 .label 来获取其标签。项目索引与访问数组相同，因此项目 2 是索引 1 项目 1 是索引 0

希望这可以帮助！

# python - NameError：未定义全局名称“hello”Python

> ID：11182783
> 
> 赞同：-3
> 
> 时间：2012-06-25T02:16:52.110
> 
> 标签：python

嗨，我正在尝试学习 Python 并且有一个我能理解的错误，

```
[Call.py]
CODE:
-------------------------------------
def intro():
    print "Function Works !";
------------------------------------

ERROR:
-------------------------
into();
NameError: name 'into' is not defined
[Finished]
-------------------------------

[main.py]

CODE:
-------------------------
import call

# Do Some Stuff
call();

-----------------------

ERROR:
------------------------
into();
NameError: name 'into' is not defined
-----------------------
[Finished] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-25T02:19:13.080

您定义了一个名为 的函数`intro`，然后尝试将其调用为`into`。选择一个名字并坚持下去。

更新：如果你有一个`intro`在 call.py 中命名的函数，那么在之后`import call`，你需要将它调用为`call.intro()`.

# orchardcms - 使用通配符匹配的形状放置

> ID：11182785
> 
> 赞同：1
> 
> 时间：2012-06-25T02:18:13.467
> 
> 标签：orchardcms

使用 Orcahrd CMS 1.3 是否可以使用多个通配符或类似的东西来更改形状的位置？例如，我想为我的新模块提供以下placement.info 文件。

```
<Match Path="/products/*/purchase/*">

</Match> 
```

使用以下路线“/products/{category}/purchase”我想更改某些形状的位置，而不管类别如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T07:06:18.030

不，这是不可能的。但是您可以使用形状表提供程序获得类似的结果，因为您可以从那里编写任意代码。

# php - 如何从 php mysql 获取父级名称

> ID：11182788
> 
> 赞同：0
> 
> 时间：2012-06-25T02:18:56.947
> 
> 标签：php, mysql

我有一个样本数据：

```
table(id, parent_id, name)
       1| 0| Apple
       2| 1| Iphone
       3| 1| Ipad
       4| 1| Macbook 
```

和mysql：

```
SELECT *
FROM `table` AS brand
WHERE brand.parent_id = brand.id 
```

但结果为空，如何修复此查询

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T02:20:45.217

你必须做一个自我加入：

```
SELECT
    a.*,
    b.name AS parent_name
FROM
    tbl a
LEFT JOIN
    tbl b ON a.parent_id = b.id 
```

结果集将类似于：

```
id  |  parent_id  |    name       |    parent_name
--------------------------------------------------
1   |  0          |    Apple      |    NULL
2   |  1          |    Iphone     |    Apple
3   |  1          |    Ipad       |    Apple
4   |  1          |    Macbook    |    Apple 
```

# android - Android OpenGL ES纹理TextImage2D错误

> ID：11182790
> 
> 赞同：0
> 
> 时间：2012-06-25T02:19:02.720
> 
> 标签：android, opengl-es, bitmap, textures

由于一些深不可测的原因，纹理不会加载。

这是方法

```
 public static void loadGLTexture(GL10 gl, Context context){

     BitmapFactory.Options options = new BitmapFactory.Options();
     options.inDensity = 240;// needed so that the image will be 512x512

    Bitmap bitmap = BitmapFactory.decodeResource(context.getResources(), R.drawable.glasstexture, options); 
    int width = bitmap.getWidth();
    int height = bitmap.getHeight();

    Log.i("GridLoginSquare.loadGLTexture 96", "Bitmap:{w:" + width + " h:" + height + "}");

    gl.glGenTextures(1, textures, 0);
    gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);

    // create nearest filtered texture
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_NEAREST);
    gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_LINEAR);

    // Use Android GLUtils to specify a two-dimensional texture image from our bitmap
    GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, bitmap, 0);  //error is on this line

    Log.e("GridLoginSquare.loadGLTexture 102", " ERR "+gl.glGetError()); 
    // Clean up

    bitmap.recycle();           
} 
```

我的纹理图像的大小是 405 x 512

该行`Log.e("GridLoginSquare.loadGLTexture 102", " ERR "+gl.glGetError());`给了我一个 1281 错误（在调查了其他有类似问题的人之后）意味着 `INVALID_VALUE`

上面的代码是整个`GridLoginSquare`类的一部分，在[这里](https://gist.github.com/f1d98be8ce8345674519)

**注意**`BitmapFactory.Options`在包含密度以缩放图像之前，此问题已经存在。类似地，当它包含在 gist 代码中时，纹理 uv 除以 405 和 512。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T02:35:14.863

我在 textImage2D 遇到了完全相同的错误，glGetError 返回 0，而 WindyB 使用宽度和长度为 2 次方的图像的解决方案......我工作了！非常感谢！:)

此错误仅发生在 Android 2（确切地说是 Android 2.3.3）中。在 Android 4 中它总是运行良好（我喜欢在不同的 Android 版本中测试我的应用程序）。

顺便说一句，我不需要创建文件夹“drawable-nodpi”，我把它全部堆叠在“drawable”中

如果有帮助：在“声明 OpenGL 要求”下的[http://developer.android.com/guide/topics/graphics/opengl.html#manifest](http://developer.android.com/guide/topics/graphics/opengl.html#manifest)，它说某些纹理压缩格式与某些设备不兼容。也许你的问题与此有关吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:25:16.243

当我没有将纹理放入 drawable-nodpi 文件夹时，我遇到了这个问题。尝试将纹理移动到该文件夹​​中。

此外，OpenGL 更喜欢您的纹理具有 2 次方的维度。我不确定这是否会导致纹理根本不出现，但您不妨尝试将纹理图像设置为 512x512 或 256x256 以查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-21T20:25:42.827

我在drawable-nodpi文件夹（我们必须创建）上有我的纹理，并且在调用此函数后得到相同的错误1281：**GLUtils.texImage2D（GLES20.GL_TEXTURE_2D，0，bmp，0）;** 这是因为**我的纹理不是 2 的幂**，所以在我修复它之后（让它保持 2 的幂），它工作正常，只留下纹理流血（当纹理的一小部分不想要的部分出现在边界），但这可以通过调整 uvs 坐标的值来解决。

# iphone - UIScrollView 没有正确加载/更新

> ID：11182791
> 
> 赞同：0
> 
> 时间：2012-06-25T02:19:08.950
> 
> 标签：iphone, ios, xcode

我的问题`UISCrollView`，`UIScrollVIew`在我的`View2Controller`，我`UIScrollView`有图像的缩略图，这是我从我`ImagePicker`挑选的图像（多张/单张图像）中导入的。我已经把我`[self createScrollView];`的`viewDidAppear`，所以在我第一次加载视图时`UIScrollView`，显然是因为我还没有选择图像。因此，在我选择它之后，我认为它没有更新。但是我的 images.count 正在我的调试器中更新。它没有在视图中更新，但是当我转到另一个`ViewController`然后再次返回时`View2Controller`，它会将图像加载到我的视图中`UIScrollView`，然后当我再次添加图像时它不会更新。为什么会这样？。

```
- (void)addImage:(UIImage *)image {
    [_images addObject:image];
    [_thumbs addObject:[image imageByScalingAndCroppingForSize:CGSizeMake(60, 60)]];
}

- (void) createScrollView {

    [scrollView setNeedsDisplay];
    int row = 0;
    int column = 0;
    for(int i = 0; i < _thumbs.count; ++i) {

        UIImage *thumb = [_thumbs objectAtIndex:i];
        UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.frame = CGRectMake(column*60+10, row*60+10, 60, 75);
        [button setImage:thumb forState:UIControlStateNormal];
        [button addTarget:self 
                   action:@selector(buttonClicked:) 
         forControlEvents:UIControlEventTouchUpInside];
        button.tag = i; 

        [scrollView addSubview:button];

        if (column == 4) {
            column = 0;
            row++;
        } else {
            column++;
        }

    }
   [scrollView setContentSize:CGSizeMake(300, (row+1) * 60 + 10)];
}

- (void)viewDidAppear:(BOOL)animated
{
    [self createScrollView];
}

- (void)viewDidLoad
{ 
     [super viewDidLoad];
        self.slotBg = [[UIView alloc] initWithFrame:CGRectMake(43, 370, 310, 143)];
        CAGradientLayer *gradient = [CAGradientLayer layer];
        gradient.frame = self.slotBg.bounds;
        gradient.colors = [NSArray arrayWithObjects:(id)[[UIColor grayColor] CGColor], (id)[[UIColor whiteColor] CGColor], nil];
        [self.slotBg.layer insertSublayer:gradient atIndex:0];
        [self.view addSubview:self.slotBg];

        self.scrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0.0f,0.0f,300.0f,130.0f)];
        [slotBg addSubview:self.scrollView];
            for(int i = 0; i <= 100; i++) 
            { 
                NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
                NSString *documentsDir = [paths objectAtIndex:0];

                NSString *savedImagePath = [documentsDir stringByAppendingPathComponent:[NSString stringWithFormat:@"oneSlotImages%d.png", i]]; 
                NSLog(@"savedImagePath=%@",savedImagePath);
                if([[NSFileManager defaultManager] fileExistsAtPath:savedImagePath]){ 
                    [self addImage:[UIImage imageWithContentsOfFile:savedImagePath]]; 
                    NSLog(@"file exists");
                } 
            } 
            NSLog(@"Count : %d", [_images count]);
} 
```

编辑：（在这部分，图像不能从视图中删除。但在我的`NSDocumentDirectory`它被删除了，）

```
- (IBAction)buttonClicked:(id)sender {

        _clickedButton = (UIButton *)sender;
        UIAlertView *saveMessage = [[UIAlertView alloc] initWithTitle:@""
                                                              message:@"DELETE IMAGE？"
                                                             delegate:self
                                                    cancelButtonTitle:@"NO"
                                                    otherButtonTitles:@"YES", nil];
        [saveMessage show];  
}

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    NSString *title = [alertView buttonTitleAtIndex:buttonIndex];

    if([title isEqualToString:@"YES"]) {
        NSLog(@"YES was selected.");
        UIButton *button = _clickedButton1;
        [button removeFromSuperview];
        [_images1 objectAtIndex:button.tag];
        [_images1 removeObjectAtIndex:button.tag];

        NSFileManager *fileManager = [NSFileManager defaultManager];
        NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
        NSString *documentsDirectory = [paths objectAtIndex:0];
        NSString *fullPath = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"firstSlotImages%lu.png", button.tag]];
        [fileManager removeItemAtPath: fullPath error:NULL];
        NSLog(@"image removed");       
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T02:27:35.063

`viewDidAppear:`仅在您查看视图时才调用。因此，当您“添加”图像时，您只是将它们添加到`_images`数组中，它们不会显示，因为您没有将它们添加到屏幕上。当您离开视图并返回时显示它们，因为`viewDidAppear:`再次被调用。

要解决此问题，请使用`addImage:`也将其添加到当前视图。

```
- (void)addImage:(UIImage *)image {
    int row = ?;
    int column = ?;
    [_images addObject:image];
    [_thumbs addObject:[image imageByScalingAndCroppingForSize:CGSizeMake(60, 60)]];
    UIImage *thumb = [_thumbs objectAtIndex:_thumbs.count-1];
    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    button.frame = CGRectMake(column*60+10, row*60+10, 60, 75);
    [button setImage:thumb 
            forState:UIControlStateNormal];
    [button addTarget:self 
               action:@selector(buttonClicked:) 
     forControlEvents:UIControlEventTouchUpInside];
    button.tag = _thumbs.count-1; 
    [scrollView addSubview:button];
} 
```

唯一的问题当然是如何确定位置，也就是列和行。您可以通过获取最后一个拇指的框架并根据屏幕边界确定放置它的位置来做到这一点。

**另一个修复**

```
- (void)addImage:(UIImage *)image {
    [_images addObject:image];
    [_thumbs addObject:[image imageByScalingAndCroppingForSize:CGSizeMake(60, 60)]];
    [self createScrollView];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:27:44.223

您需要`createScrollView`在更新图像数组后调用。也许尝试移动`[self createScrollView];`到您的`viewDidLoad`方法的末尾？无论哪种方式，您都需要`createScrollView`在添加所有图像后调用。

# xml - Delphi XML 绑定对象 - 导出节点

> ID：11182797
> 
> 赞同：2
> 
> 时间：2012-06-25T02:19:42.747
> 
> 标签：xml, delphi, delphi-xe

我有以下场景：使用 XML 数据绑定，我有一个从架构 A 创建的对象，以及一个使用架构 B 创建的不同对象。但是，架构 B**导入**架构 A 以定义 A 类型的子节点。

所以，现在我有：

*   unit1，`objectA`（来自模式 A）
*   unit2，`objectB`（来自模式 B），`objectA`（来自导入模式 A 的模式 B）

当然，该类`unit2.objectA`与`unit1.objectA`. unit2 中的定义也不同，因为它不包含一些命名空间属性（这很重要：我认为这些是隐含的，因为父节点也有它们。）

这是我的问题：鉴于这些只是`IXMLDocument`对象，我可以做很多事情，但我希望能够`unit1.objectA`从`unit2.objectA`.

我最初的想法是应该能够从文档中导出节点，并且应该有一个选项可以根据正确的模式使这个导出的节点“洁净”（因此，文档 B 中的类型 A 的节点应该导出并针对模式 A 进行验证。）我知道这可能希望太多，所以我的问题可能会被改写：

**如何**在导出的节点/文档中添加/覆盖命名空间属性 ( , , ) 时将节点从`IXMLDocument`对象导出到新对象？`IXMLDocument``xmlns``xmlns:xsi``xsi:schemaLocation`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T17:52:53.303

原来是一个非常棘手的问题。求助于我的 XML 库中的低级 DOM 函数和大量的肘部油脂；必须导出想要的片段，并手动调整架构和命名空间，然后重新格式化所有内容。

# jquery - 将评论部分添加到 Fancybox

> ID：11182799
> 
> 赞同：1
> 
> 时间：2012-06-25T02:20:06.347
> 
> 标签：jquery, fancybox, image-gallery

我正在创建一个 jquery 图像库，并且在单击缩略图时使用花哨的框来生成模态图像覆盖。您能否建议如何将评论部分与缩放图像一起添加到精美的框叠加层（就像 Facebook 如何在模态叠加层的右上角有评论部分一样）？花哨的盒子有这个功能吗？如果没有，你能建议如何做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T06:17:52.913

Fancybox 不提供开箱即用的功能，但您可以自定义自己的解决方案。

你也可以考虑我的fancybox "a la" Facebook：

[http://www.picssel.com/playground/jquery/fancyboxALAfacebook_26Mar12.html](http://www.picssel.com/playground/jquery/fancyboxALAfacebook_26Mar12.html)

它需要fancybox v2.x

# php - 邮件，无法发送到同一邮箱

> ID：11182800
> 
> 赞同：0
> 
> 时间：2012-06-25T02:20:08.127
> 
> 标签：php, email, header

出于某种奇怪的原因，如果用户尝试向自己发送电子邮件，成功函数会运行但用户从未收到电子邮件。如果`$toAddress`和`$fromAddress`相同，则用户永远不会收到电子邮件。如果他们是不同的用户。

在这里阅读了几个问题，说如果电子邮件与服务器位于同一域中，则会因垃圾邮件而被阻止。但是用户的电子邮件与服务器不在同一个域中？正在用我的 gmail 帐户对此进行测试。`Reply-to`不是我实际使用的电子邮件，它只是愚蠢的文本。

```
$to = $toAddress;
$subject = 'This is an email';
$message = $message;
$headers = 'From: '. $fromAddress . "\r\n" .
    'Reply-To:do-not-reply@gmail.com' . "\r\n" .
    'X-Mailer: PHP/' . phpversion() . "\r\n" .
    'MIME-Version: 1.0' . "\r\n" .
    'Content-Type: text/html; charset=UTF-8';

if(mail($to, $subject, $message, $headers)){
    echo '{"status": "success", "senderAddress": "' . $_SERVER['REMOTE_ADDR'] . '", "content": "' . $_POST['toAddress'] . '"}';
} else {
    echo '{"status": "fail", "toAddress": ' . $toAddress . '", "fromAddress": "' . $fromAddress . '"}';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:23:29.860

排除函数中的标题`mail()`并尝试。标题正在触发 GMail 的过滤系统。如果邮件是从 Gmail 发送的，则会有一个基于域密钥的身份验证来验证发件人的身份。

您可能需要创建包含此文本的 TXT DNS 记录：

```
v=spf1 include:_spf.google.com ~all 
```

在您的 DNS 服务器中，授权您的域发送电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T21:27:38.150

由于使用 Gmail 和 Hotmail 的过滤系统，当您将自己用作接收者时，它的发件人会直接进入 Gmail 和 Hotmail 中的垃圾邮件。对于 Gmail，如果这两个值不同，它将进入您的收件箱，而 hotmail 仍会将其视为垃圾邮件。

# url - 为什么 require.js 忽略配置 baseUrl 和路径

> ID：11182801
> 
> 赞同：11
> 
> 时间：2012-06-25T02:20:14.997
> 
> 标签：url, path, requirejs

我遇到了一个问题，几乎相同的 require.js 配置调用似乎工作方式不同，在一种情况下无法设置`baseUrl`和`path`.

**文件夹结构**

```
 - /js
 - - app/
 - - libs/
 - - - hogan.js
 - - - backbone
 - - - - backbone.js
 - - - - etc.
 - - - boostrap
 - - - jquery
 - - - - jquery.js
 - - - - etc.
 - - - require
 - - - - require.js
 - - - - etc.
 - - templates/
 - - require.config.js 
```

**脚本标签**

`<script data-main="/resources/js/require.config" src="/resources/js/libs/require/require.js"></script>`

**需要配置**

```
require.config(
    {
        baseUrl: "/resources/js/libs",
        shim: {
            "underscore": {
                exports: "_"
            },
            "backbone": {
                deps: [
                    "json2",
                    "underscore",
                    "jquery"
                ],
                exports: "Backbone"
            }
        },
        paths: {
            "app": "/resources/js/app",
            "backbone": "backbone/backbone",
            "jquery": "jquery/jquery",
            "templates": "/resources/js/templates",
            "templateEngine": "hogan"
        }
    }
);

require(
    [
        "app/router"
    ],
    function( AppRouter ){
        AppRouter.execute();
    } 
); 
```

在这两种情况下，都会附加一个脚本标记，显示 require.config.js 的全部内容，开头是：

`<script type="text/javascript" charset="utf-8" data-requirecontext="_" data-requiremodule="require.config" src="/resources/js/require.config.js">`

**应用程序/路由器中的定义**

```
define(
    [
        'backbone',
        'templateEngine'
    ],
// etc
); 
```

但是，在出现问题的地方，永远不会加载应用程序/路由器，只有以下内容（没有 404，什么都没有）：

```
GET require.js 200 OK 180ms     
GET require.config.js 200 OK 69ms 
```

如果我进入`require(["app/router"]);`Firebug 控制台，我会得到以下信息：

```
"NetworkError: 404 Not Found - /resources/js/backbone.js
"NetworkError: 404 Not Found - /resources/js/templateEngine.js" 
```

当我期望看到的是：

*   /resources/js/libs/backbone/backbone.js
*   /resources/js/libs/hogan.js

**尝试的解决方案**

*   我尝试对 和 使用相对路径和绝对路径的各种`baseUrl`组合`paths`。例如`baseUrl: libs`, 和`paths: { "app" : "../app" }`等。
*   我试过`deps`，`callback`而不是使用`require`below `config`。
*   我已经添加了属性`context`，匹配`baseUrl`。
*   我已将*require.config.js*移到*libs*目录中（根据需要进行编辑`baseUrl`；`paths`仍然遇到相同的忽略配置问题，例如，它只是尝试加载*/resources/js/libs/backbone.js*）。

**笔记**

这个文件夹结构和配置文件在我的本地主机上工作，我从上面显示的路径中删除*/resources/*。相反，所有相对路径（没有以 / 开头）用于`baseUrl`和`paths`。但在实际服务器上，这不是一个选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-24T14:34:35.620

解决方案是没有任何 . （句点）在配置文件的文件名中。将文件重命名为 require-config.js 后，一切都按预期工作。其他文件都可以，名称中带有点，而不是主配置文件。

# node.js - 带有 nodejs 和 Symfony 2 的 Websockets

> ID：11182802
> 
> 赞同：2
> 
> 时间：2012-06-25T02:20:18.830
> 
> 标签：node.js, symfony, websocket

我正在运行一个在后端使用 Symfony 2 PHP 框架的实时 Web 应用程序。我想为我的实时交互实现 websockets。是否可以在与我的 Symfony 2 服务器相同的机器上安装 node.js 服务器来处理 websocket 连接？如果是这样，打开另一个端口（比如 81）来处理 websocket 连接是标准的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T05:33:43.427

是的，有可能。为什么不？这只是另一个应用程序。

至于第二个问题。您可以打开另一个易于处理的端口（WebSockets 不受跨域策略的限制），但您可能会丢失一些数据（cookie），或者您可以放置​​一个代理，它将 HTTP 请求发送到 Web 服务器并将 WS 请求发送到Node.JS 服务器。后者可以通过具有特殊的 header 来识别`Upgrade: websocket`。无论哪种方式，WebSocket 服务器都必须监听不同的端口（除非您完全在 Node.JS 中开发应用程序）。

# asp.net - 为什么在 web.config 中声明的缓存破坏规则被忽略？

> ID：11182803
> 
> 赞同：1
> 
> 时间：2012-06-25T02:20:22.540
> 
> 标签：asp.net, html, web-config, html5boilerplate

我正在尝试使用[HTML 5 Boilerplate 项目](https://github.com/h5bp/server-configs/wiki/web.config)中的重写规则来绕过浏览器缓存（又名缓存破坏）：

```
<rewrite>
    <rules>
        <rule name="Cachebusting">
            <match url="^(.+)\.\d+(\.(js|css|png|jpg|gif)$)" />
            <action type="Rewrite" url="{R:1}{R:2}" />
        </rule>
        <rule name="Remove WWW" stopProcessing="true">
            <match url="^(.*)$" />
            <conditions>
              <add input="{HTTP_HOST}" pattern="^(www\.)(.*)$" />
            </conditions>
            <action type="Redirect" url="http://chewsy.com{PATH_INFO}" redirectType="Permanent" />
        </rule>
    </rules>
</rewrite> 
```

如果我尝试使用 访问我的 css `/css/all.123456.css`，它无法找到带有它正在寻找的错误报告的文件`/css/all.123456.css`（不重写）。我试过注释掉`"Remove WWW"`规则，看看这是否是冲突，但行为相同。

有什么想法为什么不应用此规则并重写 URL？

**更新：**我在 VS2010 中为我的 Web 服务器使用这些设置： ![在此处输入图像描述](../Images/be3c1c2292527d6d3da5e60b5f560557.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T02:27:20.260

```
<match url="^(.+)\.\d+\.(js|css|png|jpg|gif)$" />
<action type="Rewrite" url="{R:1}.{R:2}" /> 
```

我认为您想获得`/css/all.css`，如果没有，请发布所需的结果...

**编辑：** VS内部开发服务器（Cassini）不支持IIS URL重写模块，你必须使用IIS（Express），或者一些第三方组件（[http://urlrewriter.net/](http://urlrewriter.net/)）......

# c++ - c++ 在该类中声明一个类的变量

> ID：11182806
> 
> 赞同：1
> 
> 时间：2012-06-25T02:21:26.283
> 
> 标签：c++, class, variables

我有以下代码：

```
template <typename T>
class Node{
public: 
    Node<T>(T data){
        this->data = data;
    }
    T data;
    Node<T> left; 
    Node<T> right;
}; 
```

但它不喜欢我如何拥有与它们所在的类相同类型的成员变量，因为编译器不知道“节点”是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T02:22:57.477

您要声明`left`and`right`为`Node<T> *`：

```
Node<T> *left;
Node<T> *right; 
```

问题不仅在于编译器还没有完整的定义，还在于您试图说一个节点包含两个其他节点，因此对于节点的大小没有合理的定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T16:14:30.080

这--->`Node<T> left,right`导致编译器错误。要修复它，您可以将 left 和 right 声明为指针、引用或`static`节点：

```
template<typename T>
class Node {
public:
    Node(T data) : data(data){}
    T data;
    Node<T> *left, *right; // Ok
              /* OR */
    Node<T> &left, &right; // Ok
              /* OR */
    static Node<T> left, Node<T> right; // also Ok

    Node<T> left, right; // No way, causes error 
```

};

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:28:05.767

创建转发类声明：

```
template<typename T>
class Node;

template<typename T>
class Node {
public:
   T data;
   Node<T> left, right;
   // implementation here
} 
```

# api - Instagram 标签搜索 - 在特定时间或 id 后过滤图像和标签

> ID：11182807
> 
> 赞同：5
> 
> 时间：2012-06-25T02:21:37.237
> 
> 标签：api, instagram

我正在使用 Instagram API 来获取带有特定主题标签的照片列表。我设置了实时订阅，因此每当发布新照片时它都会通知我。但是，我必须自己获取新结果。

我的问题：当我请求最近标记的照片列表时，我得到一个大列表，我不想每次执行此操作时都处理最近列表中的所有结果。api 文档说我可以传递这些可选参数，但它们似乎违反直觉。它们似乎与我的预期相反：

```
MIN_ID  Return media before this min_id.
MAX_ID  Return media after this max_id. 
```

如果我跟踪我在最近的请求中看到的最新媒体 ID，我如何构造我的下一个请求以仅返回比该 ID 更新的结果？

我发布了两张带有测试标签的照片。当我使用以下 url（其中包含我的真实 access_token）时，我会返回一个列出这两张照片的 json 响应：

```
https://api.instagram.com/v1/tags/weirdtest/media/recent?access_token=xxx 
```

这两张照片有这些ID：

```
221201236060507271_179249322
221190263853517857_179249322 
```

如何构建只返回这两张照片中较新的查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T21:50:04.350

`MAX_ID`使用请求参数添加您最后看到的最新 ID ：

```
https://api.instagram.com/v1/tags/weirdtest/media/recent?access_token=xxx&MAX_ID=221201236060507271_179249322 
```

这应该告诉 Instagram，*“我看到的最新照片是 221201236060507271_179249322，只返回较新的照片”*。

# iphone - CISoftLightBlendMode 不以图像为中心

> ID：11182808
> 
> 赞同：1
> 
> 时间：2012-06-25T02:21:41.523
> 
> 标签：iphone, objective-c, ios, ios5, core-image

嘿，当我将过滤器应用于图像时，CISoftLightBlendMode 出现问题，叠加图像不在另一个图像的中心，它只是停留在左下角，因此只有很小一部分图像被叠加覆盖质地。

这是我的代码：

```
UIImage* bg = [UIImage imageNamed:@"Texture.png"];
CIImage* beginImage = [CIImage imageWithCGImage:[image_view.image CGImage]];
CIImage* bgImage = [CIImage imageWithCGImage:bg.CGImage];
context = [CIContext contextWithOptions:nil];
filter = [CIFilter filterWithName:@"CISoftLightBlendMode" keysAndValues: kCIInputImageKey, beginImage,@"inputBackgroundImage",bgImage, nil];
CIImage *outputImage = [filter outputImage];
CGImageRef cgimg = [context createCGImage:outputImage fromRect:[outputImage extent]];
UIImage *newImg = [UIImage imageWithCGImage:cgimg];
[Image_View setImage:newImg]; 
```

# c++ - 在 c++ 中，vs2010 的 typeid 名称与 cocoa 不同。为什么？哪一个是对的？

> ID：11182813
> 
> 赞同：0
> 
> 时间：2012-06-25T02:22:33.677
> 
> 标签：c++, visual-studio-2010, cocoa

```
int _tmain(int argc, _TCHAR* argv[])
{
    cout<<typeid(.01).name()<<endl;
    cout<<typeid(1).name()<<endl;
    cout<<typeid("ASDF").name()<<endl;
    //printing double, int, const char[5]

    /*
    CCLog("%s",typeid(.1).name());
    CCLog("%s",typeid(1).name());
    CCLog("%s",typeid("SDF").name());
    //but in cocoa: it is d, i, A4_c
    */

    system("pause");
    return 0;
} 
```

返回类型在注释中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-25T02:29:52.973

返回的字符串的内容`type_info::name`是实现定义的。对于不同的编译器，它可能（并且可能会）不同。所以他们俩都是对的。

# mysql - MySQL SELECT 行增量按组

> ID：11182817
> 
> 赞同：1
> 
> 时间：2012-06-25T02:23:15.990
> 
> 标签：mysql, select

我想从多个表中选择数据，如下所示。我希望每组“dID”都有“gID”自动递增。我查询的多个表没有自动增量值。所以必须动态创建 gID 字段。

```
dID     gID     bID     data
===     ===     ===     ====
400     1       20     data1
400     2       21     data2
401     1       28     data3
402     1       52     data4
402     2       74     data5
402     3       75     data6
402     4       89     data7 
```

我无法弄清楚如何实现这一目标。

我试过这样做，但它似乎没有工作：

```
SELECT t1.dID, @i:=@i+1 AS gID, t2.bID, t2.data
FROM table1 t1, table2 t2, (SELECT @i:=0) m
WHERE t1.mID = t2.mID
ORDER BY t1.dID 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:28:52.373

不需要“@”变量...试试这个：

```
SELECT 
    a.dID, 
    COUNT(*) AS gID, 
    b.bID, 
    b.data
FROM 
    table1 a
INNER JOIN 
    table2 b ON a.mID = b.mID
INNER JOIN
    (
        SELECT a.dID, b.bID
        FROM table1 a
        INNER JOIN table2 b ON a.mID = b.mID
    ) c ON a.dID = c.dID AND b.bID >= c.bID
GROUP BY 
    a.dID,
    b.bID
ORDER BY
    a.dID,
    gID 
```

此解决方案还允许`bID`具有重复值（`dID`每组唯一）。

# alfresco - 从 alfresco-global.properties 导入另一个属性文件？

> ID：11182821
> 
> 赞同：0
> 
> 时间：2012-06-25T02:23:45.377
> 
> 标签：alfresco

[Alfresco](http://www.alfresco.com)的属性可以在[alfresco-global.properties](http://wiki.alfresco.com/wiki/Repository_Configuration#alfresco-global.properties_.28V3.2.2B.29)中设置。

我有一个包含 5 个节点的集群，每当我必须更改设置（= 每天几次）时，我都需要对 5 个节点中的每一个进行修改。

我只想修改共享 NFS 驱动器上的单个文件。我曾想过让 alfresco-global.properties 成为一个符号链接，`/nfs/nico/alfresco-global.properties`但不幸的是每个节点都有不同的`alfresco.jgroups.bind_address`.

我想将配置拆分为两个文件：一个特定于每个集群节点的 CONF1 文件，以及一个通过 NFS 共享的通用 CONF2 文件。

问题：如何从 CONF1 “导入” CONF2？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T12:21:02.880

属性文件中没有“导入”机制。要解决您的问题，您确实需要将节点特定属性从集群范围的属性中外部化。您设想的通过网络连接的 FS 从所有应用服务器访问相同文件的策略是最简单的解决方案。如果您查看，`core-services-context.xml`您会发现以下内容：

```
<!-- Global properties used in property expansion throughout the container, overridable via JNDI or System properties -->
<bean id="global-properties" class="org.alfresco.config.JndiPropertiesFactoryBean">
    <property name="locations">
        <list>
            <value>classpath:alfresco/repository.properties</value>
            <value>classpath:alfresco/domain/transaction.properties</value>
            <!-- <value>classpath:alfresco/jndi.properties</value> -->
            <!--  Overrides supplied by modules -->
            <value>classpath*:alfresco/module/*/alfresco-global.properties</value>
            <!--  Installer or user-provided defaults -->
            <value>classpath*:alfresco-global.properties</value>
        </list>
    </property>
    <property name="systemPropertiesModeName">
        <value>SYSTEM_PROPERTIES_MODE_OVERRIDE</value>
    </property>
    [...]
</bean> 
```

您可以`JndiPropertiesFactoryBean`在自定义 Spring 上下文中声明一个新的，该上下文从方便的共享位置加载属性文件，或者您可以利用模块属性加载机制并确保您`alfresco/module/cluster-defaults/alfresco-global.properties`的类路径中指向这样的共享位置。

# python - 使用python检测网页更新

> ID：11182825
> 
> 赞同：1
> 
> 时间：2012-06-25T02:24:14.800
> 
> 标签：python, html, parsing, text, web

检查网页更改的最简单方法是什么？我想每隔一段时间扫描一次网页，并将其与较旧的扫描进行比较。一个问题是我还需要扫描以忽略某些更改，例如一天中的时间等。我只想检查相关更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T02:29:37.937

我不会写代码，但我会给你我解决这个问题的过程：

1.  检索页面的来源
2.  替换掉页面中我们不想监控的所有部分
3.  替换后计算源的 md5 或 sha1 哈希
4.  将哈希与存储的哈希进行比较，看看它是否不同，如果页面已更新，则执行您需要执行的任何操作
5.  存储新的哈希

# objective-c - 在数据记录中使用时间间隔？

> ID：11182829
> 
> 赞同：1
> 
> 时间：2012-06-25T02:25:22.193
> 
> 标签：objective-c, macos, core-data

我正在编写一个数据记录应用程序。我需要能够存储用户使用输入的时间间隔`Core Data`。例如，如果用户在 7 分 23 秒内完成了一项任务，他/她可以输入`7:28`“`NSTextField`和”，这将成为数据的一部分。

我应该使用什么类来存储时间？`NSDate`似乎是正确的做法，但它似乎没有存储时间间隔。我看到有一个`NSTimeInterval`类。但是，没有特别的参考，我不知道如何使用它。

此外，当这个时间间隔存储在 Core Data 中的对象中时，我需要能够检索这些项目并对它们进行排序（使用`NSSortDescriptor`）；为了检索记录最低时间间隔的条目。这只是帮助弄清楚我需要在这里做什么的附加信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:02:32.380

如果用户输入 7:28，您能否将其转换为秒（448 秒）并将其存储在 NSUInteger 中？这将使排序变得容易，因为您不必处理单独的分钟和秒值。

这是我认为你应该做的：

*   有两个字段供用户输入：一个用于分钟，一个用于秒。
*   有一些这样的代码：

    `NSInteger totalTime1 = 0;`

    `totalTime += [minuteField.text integerValue]*60;`

    `totalTime += [secondField.text integerValue];`

现在`totalTime1`使用 Core Data 存储。要检索时间并对其进行排序，请执行以下操作：

```
//Retrive times
NSArray *retrievedTimes = [NSArray arrayWithObjects: time1FromCoreDataAsNSNumber, time2FromCoreDataAsNSNumber, etc, nil];
NSArray *sortedRetrievedTimes = [retrievedTimes sortedArrayUsingSelector:@selector(compare:)];

//Now the array is sorted from lowest to highest
NSInteger lowestValue = [[sortedRetrievedTimes objectAtIndex:0] integerValue]; 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T03:09:21.387

来自文档：`NSDate`对象代表一个时间点。

从您的用例看来，您希望用户记录一个*相对*时间，然后能够按哪个时间最小进行排序。在这种情况下，NSDate 不是一个好的选择。最好的解决方案是将时间间隔存储为 NSUInteger，其中整数表示以秒为单位的值，然后在任一端进行适当的转换。

# neo4j - 返回由一组公共节点连接的节点

> ID：11182830
> 
> 赞同：1
> 
> 时间：2012-06-25T02:25:44.847
> 
> 标签：neo4j, cypher, gremlin

Neo4j 中有没有一种方法，使用 cypher 或 gremlin，返回一个节点列表，这些节点之间有一组公共节点？

一个例子是

```
Person1-[KNOWS]->Friend1
Person1-[KNOWS]->Friend2
Person1-[KNOWS]->Friend3

Person2-[HATES]->Friend2
Person2-[HATES]->Friend3 
```

我想开始`Person1`说，“找到我讨厌所有我认识的人的人”，这应该返回，`Person2`因为`Person1`知道`Friend2,Friend3`和`Person2`讨厌`Friend2,Friend3`。

我从寻找联系开始，

```
START
    person=node(1)
MATCH
    person-[KNOWS]->friend<-[HATES]-enemy
RETURN 
    enemy 
```

但我似乎无法找到一种方式来表达它，以至于这个人不得不恨所有的朋友。

这可以在 Cypher 中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-03T08:05:00.867

语法应如下所示，但我无法摆脱聚合错误消息

```
START
    person=node(1)
MATCH
    person-[r1:KNOWS]->friend<-[r2:HATES]-enemy
WHERE
    count(distinct r1)=count(distinct r2)
RETURN 
    enemy 
```

编辑：也许这更接近：

```
START
    person=node(1)
MATCH
    person-[r1:KNOWS]->friend<-[r2:HATES]-enemy, person-[r3?:KNOWS]-enemy
WITH
    person, enemy, count(distinct r1) as  rk1, count(distinct r2) as rk2,r3
WHERE 
    r3 is null
    AND
    r1=r2 
RETURN 
    enemy 
```

# php - 在 PHP 错误中实现抽象方法

> ID：11182836
> 
> 赞同：2
> 
> 时间：2012-06-25T02:26:40.387
> 
> 标签：php, oop, abstract

我在这里创建了一个包含抽象方法的类，即使该方法被声明为抽象，它也总是将这个错误返回给我。这是我的整个代码

```
<?php
interface Validator{
    public function isValid($input);
    public function getErrors();
}

class Validator_AbstractValidator
{
    protected $_errors = array();

    abstract public function isValid($input);

    public function getErrors()
    {
        return $this->_errors;
    }

    protected function _addError($message){
        $this_errors[] = $message;
    }
}

class Validator_MinimumLength extends Validator_AbstractValidator
{
    protected  $_minLength;

    public function __construct($minLength)
    {
        $this_minLength = $minLength;
    }

    public function isValid($input){
         if (strlen($input) > $this->_minLength) {
            return true;
        } else {
            $this->_addError("Input must be at least {$this_minLength}");
            return false;
        }
    }
}

class Validator_NoSpaces extends Validator_AbstractValidator{

    public function isValid($input) {
        if (preg_match('/\s/', $input)){
            $this->_addError("Spaces are not allowed");
            return false;
        }
        return true;
    }
}

interface Form_ElementInterface extends Validator{ }

class Form_Element_AbstractElement extends Validator_AbstractValidator implements Form_ElementInterface
{

    protected $_validators = array();

    public function addValidator(Validator $validator)
    {
        $this->_validators[] = $validator;
    }

    public function getValidators()
    {
        return $this->_validators;
    }

    protected function _addErrors(array $errors)
    {
        foreach ($errors as $error) {
            $this->_addError($error);
        }
    }

    public function hasErrors()
    {
        return (count($this->getErrors()) !== 0);
    }

    public function isValid($input)
    {
        foreach ($this->_validators as $validator) {
            if (!$validator->isValid($input)) {
                $this->_addErrors($validator->getErrors());
            }
        }
        return !$this->hadErrors();
    }
}

class Form_Element extends Form_Element_AbstractElement
{
    public function __construct($value,$minLength = 8)
    {
        $this->addValidator(new Validator_NoSpaces($value));
        $this->addValidator(new Validator_MinimumLength($minLength));
        //...
    }
} 
```

错误是这个致命错误：类 Validator_AbstractValidator 包含 1 个抽象方法，因此必须在第 21 行的 C:\xampp\htdocs\beatbeast\includes\Db\Validator.php 中声明为抽象方法或实现其余方法 (Validator_AbstractValidator::isValid)

但第 21 行只包含这个

```
} 
```

有什么我错过的吗？

即使我在 Class Validator_AbstractValidator 类中添加了关键抽象，我也遇到了这个问题

```
Fatal error: Can't inherit abstract function Validator::isValid() (previously declared abstract in Validator_AbstractValidator) in C:\xampp\htdocs\beatbeast\includes\Db\Validator.php on line 57 
```

但是第 57 行再次只包含这个

```
{ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T02:42:11.890

> PHP 5 引入了抽象类和方法。不允许创建已定义为抽象的类的实例。任何包含至少一个抽象方法的类也必须是抽象的。定义为抽象的方法只是声明了方法的签名，它们无法定义实现。

如果一个类没有被声明为抽象的，它就不能包含任何抽象方法。

```
abstract class Validator_AbstractValidator
{
    //...
} 
```

**更新：**

```
class Form_Element_AbstractElement extends Validator_AbstractValidator implements Form_ElementInterface 
```

您正在扩展一个抽象类（Validator_AbstractValidator）并同时实现接口`Validator`，这是不可能的。

扩展类并单独实现接口并`Validator`在单独的类中实现接口，而不是`Validator_AbstractValidator`因为它是您之前已经声明的抽象类。

**接口验证器的实现：**

```
class from_validator_interface implement Validator{
    // you have to implement all the methods declared in the interface, in your case
    // `isValid` and `getErrors` both methods have to be implemented
} 
```

**抽象类Validator_AbstractValidator的扩展：**

```
class someClass extends Validator_AbstractValidator{
    // you don't need to implement all the abstract methods like interface
} 
```

**[**一些**](http://www.sunilb.com/php-tutorial)**有用的链接：**[**php.net**](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGEQFjAA&url=http://php.net/manual/en/language.oop5.inheritance.php&ei=-mXoT5gFgqusB8jEnOsI&usg=AFQjCNEHRkWLi053BRt1HwvEGdBm8FgH3g&sig2=zwYNB1Wf62sZV_G82XV4bQ)，[**其他**](http://blog.motane.lu/2012/01/21/multiple-inheritance-in-php/)等等。[](http://www.sunilb.com/php-tutorial)**

 ***** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:45:46.630

一旦我添加`abstract`到`Validator_AbstractValidator`，您的代码对我来说就可以正常工作，您说您已经这样做了。

```
abstract class Validator_AbstractValidator
{ ... 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-04T20:55:28.943

我对以下代码有同样的错误：

```
Interface Fruit
{
   public function getCalories() ;
   public function countSeeds() ;
}

Interface Vegetable
{
   public function getVitamins() ;
   public function getCalories() ;
}

class Tomato implements Fruit, Vegetable
{
   ...
} 
```

这是我的解决方案，我添加了第三个父界面。

```
Interface Food 
{
    public function getCalories() ;
}

Interface Fruit extends Food
{

   public function countSeeds() ;
}

Interface Vegetable extends Food
{
   public function getVitamins() ;
}

class Tomato implements Fruit, Vegetable
{
   ...
} 
```****

# scala - AJAX POST 问题 - [[NoSuchElementException: None.get]]

> ID：11182837
> 
> 赞同：1
> 
> 时间：2012-06-25T02:26:42.133
> 
> 标签：scala, playframework

我似乎无法从 AJAX javascript POST 中获取 POST 参数。错误是：

```
@6angl7689 - Internal server error, for request [POST /myRoute] ->

play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[NoSuchElementException: None.get]] 
```

路线：

```
POST    /myRoute  controllers.Application.testPost 
```

控制器代码：

```
def myForm = Form(
    tuple(
      "valOne" -> text,
      "valTwo" -> text))

def testPost() = Action { implicit request =>

    val (valOne, valTwo) = myForm.bindFromRequest.get // Errors here

    println("valOne: " + valOne)
    println("valTwo: " + valTwo)

    Ok
} 
```

CoffeeScript 客户端：

```
params = 
   valOne: 'valOne'
   valTwo: 'valTwo'

$.ajax
   type: 'POST'
   url: '/myRoute'
   data: params 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T06:50:34.760

更新您的客户端代码，

```
$.ajax(
   type: 'POST'
   url: '/myRoute'
   data: {valOne: 'valOne', valTwo: 'valTwo'}
); 
```

这应该工作

# php - 使用一个字段值确定另一个字段值

> ID：11182838
> 
> 赞同：1
> 
> 时间：2012-06-25T02:26:43.947
> 
> 标签：php

我正在用 php 构建一个时间线站点。时间线上的条目通过 html 输入表单输入到数据库中。

下面是我用来从 html 表单中获取输入值并将它们存储在数据库中的 php：

```
// Collects information from the forms //
$year = mysql_prep($_POST['year']);
$concept = mysql_prep($_POST['concept']);
$author = mysql_prep($_POST['author']);
$text = mysql_prep($_POST['text']);
$century = mysql_prep($_POST['century']);
$file_under = mysql_prep($_POST['file_under']);
$pic=($_FILES['photo']['name']);

$query = "INSERT INTO fields (year, concept, author, text, century, 
                              file_under, photo, created, modified) 
          VALUES ('{$year}', '{$concept}', '{$author}', '{$text}', '{$century}',
                             '{$file_under}', '{$pic}', NOW(), NOW())";
$result = mysql_query($query, $connection);
    if ($result) {
        redirect_to("index.php");
    } else {
    //display error message
    echo "<p>Yikes!</p>";
    echo "<p>" . mysql_error() . "</p>";
    } 
```

现在这对我的目的来说很好，但我仍然需要输入一个世纪值。我希望 php 根据 4 位数年份确定世纪。

我想获取 4 位`year`值并使用它来确定`century`将存储在数据库中的值。

例如，如果输入的年份是 2002 年，我需要将“21”作为“世纪”数据库中的值。现在，我必须手动输入“21”（或任何一个世纪），因为这个值对于内容如何在时间轴上显示很重要（即，`$query = "SELECT * FROM fields WHERE century = '21' ORDER by year ASC";`）

最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T02:31:09.493

> $ Century = substr($year, 0, 2) + 1;

应该做的伎俩。也许添加一些验证以确保 $year 是数字（也许它已经完成）。

# python - 在 ruby 、python 或 node.js 脚本中基于文件结构创建 JSON

> ID：11182839
> 
> 赞同：0
> 
> 时间：2012-06-25T02:26:56.940
> 
> 标签：python, ruby, json, node.js

我有文件夹结构，我想根据根文件夹中的文件夹名称和文件树中的以下文件创建 JSON 对象。文件名结构良好，如下所示：

```
objectNNN.xyz 
```

其中 NNN 是 001、002 ... 之类的数字，xyz 可以是 .png、.jpg、.eps 或 .mp3

文件夹结构是这样的（脚本的输入）：

水果

*   图片

    *   苹果001.jpg
    *   apple002.jpg
    *   apple003.jpg
    *   橙色001.jpg
    *   橙色002.png
    *   橙色003.jpg
*   声音

    *   苹果001.mp3
    *   苹果002.mp3
    *   橙色001.mp3

动物

*   ... ETC

食物

*   ... ETC

...基于此文件夹结构，我想阅读所有“集合”（水果、动物等）并为每个集合创建一个 JSON 对象，如下所示：（请注意，“单词”键取自所有图像目录中的对象名称）。

```
sets = {
animals: [ // this is from the folder name in the root folder
{
  word: "cat", // this is from the filename in the images directory eg cat001.jpg
  images: [
    {
      path: "images/basic/cat001.jpg"
    }, {
      path: "images/basic/cat002.jpg"
    }
  ],
  sounds: [ // based on all the images look for sounds
    {
      path: "sounds/basic/cat001.mp3"
    }, {
      path: "sounds/basic/cat002.mp3"
    }
  ]
}, // etc more sets and words 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:35:12.710

这个问题的定义相当不明确，但这是我解释你想要什么的最佳方式。将此扩展到添加文件路径和更多项目组作为练习留给读者。

```
from re import split
from itertools import groupby, izip

fruits = set(["apple", "pear"])
animals = set(["bear", "cat"])

json_structure = {}

text_input = ["apple001.png", "apple002.jpg", "bear001.png", "pear001.png", "cat001.png"]

def check(filename):
"""Checks which group a filename is in and returns an integer for ordering"""
    n = split(r'[0-9]', filename)[0]
    if n in fruits:
        return 0
    else:
        return 1

grouped = groupby(sorted(text_input, key=check), key=check)

for objects, object_type in izip(grouped, ["fruits", "animals"]):
    items = objects[1]
    json_structure[object_type] = list(items)

print json_structure 
```

# php - 如何保留选择字段中的选项？

> ID：11182840
> 
> 赞同：1
> 
> 时间：2012-06-25T02:27:11.867
> 
> 标签：php, html, html-select

我有一个`<select>`：

```
<select id="countries">
<option value="1">USA</option>
<option value="2">Spain</option>
</select> 
```

用户选择一个选项，然后按下发送按钮通过 PHP 进行查询。查询结果出现在同一页面中，因此页面重新加载。我如何保留选定的选项？当页面重新加载？

我的意思是，如果他们选择西班牙，当页面重新加载时，我如何才能再次看到西班牙？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T02:30:57.840

您需要首先为您的选择下拉列表命名。

例如：

```
<select id="countries" name="countries"> 
```

然后，您将可以在提交表单时访问 PHP 中的值。在 PHP 中可以像这样检索该值（提交后）：

```
$countries = $_POST['countries']; 
```

然后，您可以通过使用 PHP 设置 selected 属性来执行 @JohnConde 所做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:29:46.490

这是一个*非常*基本的方法：

```
<option value="1"<?php if (1 === (int) $_POST['countries']) echo ' selected="selected"'; ?>>USA</option>
<option value="2"<?php if (2 === (int) $_POST['countries']) echo ' selected="selected"'; ?>>Spain</option> 
```

# php - .htaccess url 根据 url 的长度重写任何 url

> ID：11182842
> 
> 赞同：0
> 
> 时间：2012-06-25T02:27:26.587
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

我正在尝试重写所有 4 个字符的所有 url，但允许将其他 url 重写为它的名称 +.php

```
domain.com/a4Lv/ to domain.com/file.php?id=a4Lv
domain.com/longerThan4Chars/ to domain.com/longerThan4Chars.php 
```

是否可以根据长度重写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:35:39.263

这应该有效。我更喜欢指定允许哪些字符（第一个选项），但如果您想允许任何内容，请使用第二个

```
RewriteRule ^([a-zA-Z0-9]{4})(/?)$ /file.php?id=$1 [QSA,L]
RewriteRule ^(.{4})(/?)$ /file.php?id=$1 [QSA,L] 
```

分解：

```
[a-zA-Z0-9]  limits it to letters and numbers
{4}          the length of the id
(/?)         optional trailing slash 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:42:18.510

是的，您可以制作正则表达式来处理匹配中的字符数：

```
# for exactly 4 characters:
RewriteRule ^(.{4})/?$ /file.php?id=$1 [L]

# for more than 4 (need to exclude things ending with php)
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule ^(.{4}[^/]+)/?$ /$1.php [L] 
```

# ruby - 从另一个调用一个 Ruby 脚本

> ID：11182846
> 
> 赞同：3
> 
> 时间：2012-06-25T02:27:38.623
> 
> 标签：ruby, paypal

我有一个令人困惑的问题。我想从另一个调用一个 ruby​​ 脚本。

考虑到这一点，我创建了一个 testscript.rb 并执行了它，它包含这段代码，

```
 require './paypal.rb'
 puts paypal['L_AMT0'] 
```

此代码返回一个数字，这是我的贝宝余额。它依赖于使用 ruby​​-paypal gem 的 paypal.rb 文件。当我执行 ruby​​ testscript.rb 时，我得到了我的贝宝余额的输出，这意味着它工作正常。这告诉我，我从另一个 RB 调用一个 RB 的方法没问题，因为在上述场景中，testscript.rb 正在获取一个从 paypal.rb 返回的变量。

使用相同的逻辑，我将上述代码插入到另一个名为 SiriProxy 的程序中。这是一个红宝石程序。我需要它来获得我的贝宝余额。

所以在那个程序里面，我做了一个require paypal.rb，它失败了，因为它找不到它，所以我在require中设置了一个绝对路径来修复它。

但是，当 SiriProxy（另一个 ruby​​ rb 给我一个问题）尝试运行 puts paypal['L_AMT0'] 时，它会导致错误并结束程序。

这是错误，

```
[Info - Plugin Manager] Say: Checking Paypal Balance
/home/siriproxy/.rvm/gems/ruby-1.9.3-p194@SiriProxy/gems/siriproxy-0.3.0/plugins/siriproxy-example/lib/siriproxy-example.rb:47:in `block in <class:Example>': undefined local variable or method `paypal' for #<SiriProxy::Plugin::Example:0x931a228> (NameError)
    from /home/siriproxy/.rvm/gems/ruby-1.9.3-p194@SiriProxy/bundler/gems/cora-1edcfb9073d5/lib/cora/plugin.rb:47:in `instance_exec'
    from /home/siriproxy/.rvm/gems/ruby-1.9.3-p194@SiriProxy/bundler/gems/cora-1edcfb9073d5/lib/cora/plugin.rb:47:in `block (2 levels) in process' 
```

在上面的输出中，问题似乎是它不理解“paypal”，如下所示：

> 未定义的局部变量或方法“paypal”

但是，我不明白为什么，因为在 testscript.rb 我做了完全相同的事情并且它有效。

任何人都可以帮忙吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T03:29:59.143

似乎@CodeGnome 是对的。

[从内核文档：](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-require)

**要求（名称）→真或假**

> 加载给定的名称，如果成功则返回 true，如果已加载功能则返回 false。

**require_relative(string) → true or false**

> Ruby 尝试相对于所需文件的路径加载名为 string 的库。如果无法确定文件的路径，则会引发 LoadError。如果加载了文件，则返回 true，否则返回 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:41:19.853

### 从当前目录加载文件

我对您的库或其内部结构一无所知，但看起来您的 require 语句可能是错误的。如果你想从 Ruby 1.9.3 的当前目录加载文件，你应该使用：

```
require_relative 'paypal' 
```

### 捆绑器和宝石

如果它是您作为捆绑包的一部分安装的 gem（例如 gem 是在 Gemfile 中定义的），那么在您的 require 语句中提供路径是错误的。相反，您需要按如下方式要求捆绑的 gem：

```
require 'bundler/setup'
require 'paypal' 
```

# mongodb - MongoDB：保存文档会重写整个文档吗？

> ID：11182850
> 
> 赞同：7
> 
> 时间：2012-06-25T02:28:41.290
> 
> 标签：mongodb

我有`domain`包含域信息的文档的集合。其中一部分是历史 whois 记录，它可能是零个或多个，并且到目前为止占据了文档的大部分空间。

如果我加载整个文档，更改一些小的内容（例如更新数字字段）并使用该`save()`方法将 mongo 将整个文档刷新到磁盘或仅更新已更改的 BSON？最终我的问题是，我应该费心用`update()`'s 使我的代码复杂化以节省 I/O 还是应该只使用 's `save()`？

这不仅仅是因为懒惰，文档（在完整阅读之后）会经过一系列步骤来修改/处理文档，如果进行了任何更改，则保存整个文档。但是如果保存文档的成本很高，那么也许我必须换一种方式考虑......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T02:46:20.460

您可以使用 更新文档中的单个字段[`$set`](http://www.mongodb.org/display/DOCS/Updating#Updating-%24set)。这将修改磁盘上的字段。但是，[如果文档的大小超过了更新前的大小，则可能必须将文档重新定位到磁盘上](http://www.mongodb.org/display/DOCS/Padding+Factor)。

同时，[以下是文档中有关`save`vs`update`](http://www.mongodb.org/display/DOCS/Updating#Updating-update%28%29)的内容：

```
>// x is some JSON style object
>db.mycollection.save(x); // updates if exists; inserts if new
>
>// equivalent to:
>db.mycollection.update( { _id: x._id }, x, /*upsert*/ true ); 
```

**参考**

*   [保存与更新](http://www.mongodb.org/display/DOCS/Updating#Updating-update%28%29)
*   [`$set`修改器操作](http://www.mongodb.org/display/DOCS/Updating#Updating-%24set)
*   [填充因子](http://www.mongodb.org/display/DOCS/Padding+Factor)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T07:51:24.203

这取决于您使用的客户端库。例如，Mongoid（红宝石中的 ODM）足够聪明，只发送更改的字段（使用`$set`命令）。它有时太聪明了，无法捕捉到我对嵌套哈希所做的更改。但我从未见过它发送未更改的字段。

其他库/驱动程序的行为可能不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-11-09T20:52:56.343

我知道这个问题很老，但是了解它如何帮助您设计数据库结构非常有用。以下是有关 MongoDB 存储引擎的详细信息： [https ://docs.mongodb.com/v3.2/faq/storage/](https://docs.mongodb.com/v3.2/faq/storage/)

该文件回答了这个问题。基本上，如果您更新 MongoDB 中的整数字段，它会将整数所在的内存中的页面（通常为 4k）标记为脏，并且它将在下一次磁盘刷新时将内存页面写入磁盘。因此，如果您的文档非常大，它可能只会将您的部分文档写入磁盘。

但是，还有许多其他情况。如果您要向文档填充更多数据，MongoDB 可能需要将整个文档移动到新位置以使文档增长。在这种情况下，整个文档将被写入磁盘。

# php - 从mysql中拉取今天输入的数据

> ID：11182852
> 
> 赞同：1
> 
> 时间：2012-06-25T02:29:06.157
> 
> 标签：php, mysql

我在这里没有看到明显的东西吗，似乎无法使其正常工作...

```
if (($_GET['date']=='today'))
{ 
    $today = date('Y-m-d', strtotime('today'));     
    $query = "SELECT * FROM contacts WHERE (contacttype = 'Buyer' OR "
           . "contacttype = 'Seller' OR contacttype = 'Buyer / Seller' OR "
           . "contacttype = 'Investor') AND date = '$today' ORDER BY date DESC";
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:43:49.743

你甚至不需要用 PHP 告诉 MySQL 今天是什么，它已经知道了！

```
SELECT * FROM contacts WHERE (contacttype = 'Buyer' OR contacttype = 'Seller' OR contacttype = 'Buyer / Seller' OR contacttype = 'Investor') AND date = DATE(NOW()) ORDER BY date DESC 
```

假设 WHERE 子句中的所有其他条件都是正确的，它将起作用。请参阅 MySQL 的[date()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date)和[now()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_now)参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T07:09:15.377

```
SELECT *
FROM contacts
WHERE (contacttype = 'Buyer'
        OR contacttype = 'Seller'
        OR contacttype = 'Buyer / Seller'
        OR contacttype = 'Investor')
    AND DATE = CUR_DATE()
ORDER BY DATE DESC` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:51:46.343

请尝试以下方法：

```
where DATE(dt) = DATE(NOW()) 
```

# asp.net - 从网站发送电子邮件的智能方式

> ID：11182854
> 
> 赞同：2
> 
> 时间：2012-06-25T02:29:18.530
> 
> 标签：asp.net, vb.net

我目前正在使用 SmtpClient 向注册或注册活动的用户发送电子邮件。

当他们点击注册时，它会保存信息并调用发送电子邮件功能，但发送一封太长的电子邮件需要不到一秒钟的时间。

有没有办法保存用户信息，并且在页面加载后它会在后台从 vb 调用发送电子邮件功能。

我考虑过使用 winform 发送电子邮件，但是当我使用 Godaddy 进行托管时，你在哪里运行它？

谢谢你们的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:35:28.043

您可以保存用户信息，当页面加载时，您可以对服务器页面进行 ajax 调用，该页面将向用户发送电子邮件。这样做的好处是，由于它是异步的，用户不需要等待这个动作完成来继续站点导航中的一些其他动作。但它不会比你拥有的方法更快。

您可以使用 dom`ready`函数在（重新？）加载的页面中进行这样的 ajax 调用。

```
$(function(){

  //Whatever code inside this will be executed only after the DOM finishes loading
   var userId=45;  //replace this with your new userId
   $.post("Emailer.aspx?userId="+userId,function(data){
      alert("Some alert message if you really want!");
   });

}); 
```

假设您有一个名为的页面`Emailer.aspx`，它将读取查询字符串参数并执行操作（发送电子邮件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T05:53:28.663

我只会使用 SmtpClient 的 SendAsync() 方法与 Send() 方法。这将允许代码继续发送电子邮件，因为它会产生一个新线程来处理发送。这为用户节省了等待时间。只是不要以这种方式循环发送 1000 封电子邮件。它可能会导致您的服务器产生过多的线程并影响性能。

您还可以研究 Smtp 服务“Pickup Directory”选项。如果您对 SMTP 服务器所在的位置具有文件写入权限，则可以将邮件“投递”到该位置以便稍后发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T19:50:16.337

我的第一个答案是 nbushnell 建议的 SendAsync

如果您担心 1000 封电子邮件，您可以在数据库记录中为用户设置一个“位”字段，然后编写一个 Windows 服务，读取位为 0 的用户表，发送电子邮件，然后将该位设置为 1

这消除了用户等待页面加载的等待时间，但是他们接收实际电子邮件会有延迟。

# c - 使用数组检查错误

> ID：11182861
> 
> 赞同：0
> 
> 时间：2012-06-25T02:30:53.053
> 
> 标签：c, arrays

我正在编写一个程序，它使用数组来显示最小值、最大值和平均值。在我的函数 getNumbers 中，我允许用户输入要存储的值。一旦以这种方式处理用户不能超出数组大小，我该如何进行错误检查。

```
int getNumbers(int array[ARRAY_SIZE], int minimumValue, int maximumValue, sumValue, avgValue)
{
    int i;
    printf("Enter integers to store inside the array :");
    for(i = 0; i<= ARRAY_SIZE-1; i++)
    {
        scanf("%d", &array[i]);
    }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T02:39:56.423

也许你可以尝试用 if 来“冒泡”你的 getNumber 函数。如果检查你是否越界，就这样做。

# objective-c - 如何设置默认方向

> ID：11182866
> 
> 赞同：0
> 
> 时间：2012-06-25T02:32:35.030
> 
> 标签：objective-c, ios, cocoa-touch, device-orientation

> **可能重复：**
> [如何在 iPhone 上启动后设置方向](https://stackoverflow.com/questions/9060019/how-to-set-orientation-after-launch-on-iphone)

我将如何设置应用程序的默认方向，例如初始屏幕所在的方向，以及应用程序在自动旋转之前所在的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T03:47:57.850

只需执行以下操作：

- 在 info.plist 中添加“Initial Interface Orientation”键。

- 将值更改为所需的方向（作为字符串；有关可能的字符串值，请参见“支持的界面方向”）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T05:16:00.927

在`-(void)shouldAutoRotateInterfaceOrientation`委托中，如果您希望将景观设置为默认值，请这样输入：

```
return UIInterfaceOrientationLandscapeLeft 
```

# java - JPA - 无效的重复插入

> ID：11182867
> 
> 赞同：0
> 
> 时间：2012-06-25T02:32:38.137
> 
> 标签：java, hibernate, jpa

这是我的代码

```
@Entity
class Parent extends Person {
    @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, orphanRemoval = true, mappedBy = "father")
    private List<Child> children;

    // ...

    public void addChild(Child c) {
        children.add(c);
    }

}

@Entity
class Child extends Person {
    @ManyToOne(cascade=CascadeType.ALL)
    @JoinColumn(name = "id")
    private Parent father;

    public Child() {
        this(NoParent.getInstance());//
    }

    public Child(Parent p) {
        super();
        setParent(p);
    }

    // ...
}

@MappedSuperclass
class Person {
    @Id
    private Integer id;
    private String name;
}

class MyParentService {

    public void addChild(String name, Parent parent) {
        Child c = new Child(parent);
        c.setName(name);
        parent.addChild(c);

        em.getTransaction.begin();
        em.merge(parent);
        em.getTransaction.commit();// Here two children with same name but different ids are created ...
    }
} 
```

每次我运行它时，数据库中都会添加两个孩子，而我只想要一个！
我究竟做错了什么 ？

**Java 6**
**JPA 2**
**休眠 3.6.8.GA**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T10:12:32.633

您是否有机会在父母之后坚持孩子？此外，最佳实践是仅在关系的拥有方管理对象的链接（在一种方法中同时使用 parent.addChild 和 child.setParent），但这在您的情况下似乎并不重要，因为在“合并”发生时，对象已正确链接。如果这些都不起作用，那么您可能会遇到这个问题：[https ://hibernate.onjira.com/browse/HHH-5855](https://hibernate.onjira.com/browse/HHH-5855)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T16:12:35.793

我阅读了 Hibernate 文档，这确实令人困惑并且对我没有多大帮助。

请注意，我发现 ObjectDB 最近遇到并修复[了完全相同的错误](http://www.objectdb.com/database/issue/110)。（Hibernate 伙计们，你们为什么要等这么久？？）

尽管如此，我想出的解决方案是：

**步骤 1：**
创建一个新的子节点（即处于分离状态）并调用其 setParent 方法以链接到其父节点。

**第2步：**
坚持这个孩子。

**第 3 步：**
根据需要对子项进行更改，然后将其合并。

该解决方案并不优雅，但它确实有效！接下来，您将获取您的父对象，它将手动将先前的子对象链接到它。

# drupal-7 - 在 drupal 7 中发布东西而不发布它

> ID：11182869
> 
> 赞同：-2
> 
> 时间：2012-06-25T02:32:56.780
> 
> 标签：drupal-7

所以我的drupal模块中有以下功能。我想提交未发布的产品。我想我需要把

```
->condition('n.status', '1') 
```

我只是不知道把它放在哪里。

这是我的方法。

```
 function products_add(){
           global $user;
           $products = create('products');
           return drupal_get_form('products_form', $products);
   } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T08:11:11.020

```
->condition('n.status', '1') 
```

仅该代码不会发布节点。要了解为什么需要阅读[http://drupal.org/node/310069](http://drupal.org/node/310069)

此外，函数 product_add() 无论如何都不是你应该这样做的地方。您需要在 products_form 表单上使用[hook_form_alter()](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_form_alter/7)，然后默认发布状态为 TRUE。或者，您可以通过**$node->status = NODE_PUBLISHED;来设置它。**在[hook_node_presave()](http://api.drupal.org/api/drupal/modules!node!node.api.php/function/hook_node_presave/7)中。[或者，您也可以在hook_entity_presave()](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_entity_presave/7)中做类似的事情。

# php - 确定函数内 NULL 默认值和 NULL 参数之间的差异

> ID：11182870
> 
> 赞同：0
> 
> 时间：2012-06-25T02:32:57.937
> 
> 标签：php, null, memcached, pass-by-reference, optional-parameters

我正在开发一个 PHP 类，该类用作通过 PECL 扩展提供的 Memcached 类的包装器。我在处理调用该[`get`](http://www.php.net/manual/en/memcached.get.php)方法的方法时遇到了困难。get 方法中的第三个参数默认为 null 并通过引用传递一个变量。我在`get`用我的包装器镜像 Memcached 方法的功能时遇到了困难。

通过直接使用 Memcached 类，会发生以下情况：

```
$m = new Memcached();
$m->addServer( '127.0.0.1', 11211 );

$m->add( 'my-key', 'my-value' );

$m->get( 'my-key', null, $cas_token );

var_dump( $cas_token ); // (float) 3212 
```

这里的重点是我可以将一个未初始化的 null var 传递给 get 函数，它通过将 CAS 令牌设置为该 var 来工作，以后可以访问该 var。

在我的课堂上，我想提供将这个 CAS 令牌与我的包装方法一起使用的能力；但是，我希望能够根据是否使用第三个变量调用该方法来做一些不同的事情。当我使用包装器方法时，我找不到区分第三个变量是否被显式调用的方法。我正在尝试的骨架如下：

```
class MyMemcached {

    ...

    public function get( $key, $cache_cb = NULL, &$cas_token = NULL ) {
        if ( is_callable( $cache_cb ) || ! is_null( $cas_token ) ) {
            $this->m->get( $key, $cache_cb, $cas_token );
        } else {
            // Do something differently
        }
    }
}

$myMemcached = new Memcached();
$myMemcached->addServer( '127.0.0.1', 11211 );

$myMemcached->add( 'my-key', 'my-value' );

$myMemcached->get( 'my-key', null, $cas_token );

var_dump( $cas_token ); // NULL 
```

同样，在 MyMemcached::get 中，我无法区分用户是否使用 NULL var 调用它。你知道我有什么方法可以区分这两个事件吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T20:44:41.607

[http://www.php.net/manual/en/function.func-num-args.php](http://www.php.net/manual/en/function.func-num-args.php)

您可以通过此函数确定函数中传递了 2 个或 3 个参数。如果 number 为 3，则传递了实际的 null 值，如果不是，则函数中只传递了两个参数。

# android - 有人可以帮我在操作栏中创建一个向上按钮吗

> ID：11182872
> 
> 赞同：2
> 
> 时间：2012-06-25T02:33:31.957
> 
> 标签：android

我正在开发一个应用程序，其中主视图将使用仪表板设计。我在 android 设计模式中看到他们引入了使用向上按钮的新概念。我有点困惑，因为向上按钮和返回按钮总是相同的，除了你可以使用向上按钮直接进入你的主视图。有人能告诉我如何在动作栏夏洛克中创建一个向上按钮吗？请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-25T04:36:42.200

如果您已经实现了操作栏，您应该可以使用以下代码设置主页按钮。

**这在 onCreate**

```
getActionBar().setHomeButtonEnabled(true);
getActionBar().setDisplayHomeAsUpEnabled(true); 
```

**这是一个单独的方法**

```
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {

        case android.R.id.home:
            // app icon in action bar clicked; go home
            Intent intentHome = new Intent(this, TargetActivity.class);
            intentHome.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(intentHome);
            return true;

        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

如果您尝试做同样的事情，这应该可以。

# javascript - 单击时试图让图像在两个不同的源文件之间切换

> ID：11182873
> 
> 赞同：0
> 
> 时间：2012-06-25T02:33:49.187
> 
> 标签：javascript, onclick

我是 JS 的新手。

我正在尝试编写一些javascript，这样当我单击图像时，它将切换到另一个图像。然后，当我再次单击它时，我希望图像切换回原始图像，依此类推。这是我写的一个简单的 Javascript 函数，希望能实现这一点。

```
function diffImage(item) 
{
if(document.getElementById(item).src == "blank.jpg")
    {
        document.getElementById(item).src = "black.jpg";
    }
else
    {
        document.getElementById(item).src = "blank.jpg";
    }

} 
```

这是相关图像的标签：

```
<img src="black.jpg" id="image1" onclick=diffImage("image1")> 
```

可悲的是，它不起作用。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:37:33.920

除了dragon66 和snies 在评论中提到的引用问题外，您的`if`条件语句可能无法满足您的要求，因为`element.src`在javascript 中调用会返回完整的URL，而不仅仅是图像名称。所以你需要使用[split](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/split)和[pop](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/pop)来获得如下的图像名称。

```
function diffImage(me){
    if(me.src.split("/").pop() === "blank.jpg"){
        me.src = "black.jpg";
    }
    else {
        me.src = "blank.jpg";
    }
} 
```

你的 HTML 就变成了……

```
<img src="black.jpg" id="image1" onclick="diffImage(this);"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T04:02:18.723

```
function diffImage(img) 
{
    if(img.src.match(/blank/)) img.src = "black.jpg";
    else img.src = "blank.jpg";
} 
```

**HTML**

```
<img src="black.jpg" id="image1" onclick=diffImage(this) />​ 
```

[**演示。**](http://jsfiddle.net/heera/fnQ28/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T03:48:36.757

试试这个：http: [//jsfiddle.net/soparrissays/7PxFH/](http://jsfiddle.net/soparrissays/7PxFH/)

# java - 支持 Bean 未获取 javascript 发送的值

> ID：11182875
> 
> 赞同：1
> 
> 时间：2012-06-25T02:33:56.873
> 
> 标签：java, javascript, jsf, facelets, managed-bean

我有三个下拉列表，其值`<h:inputHidden>`通过以下 JavaScript 函数复制到组件中：

```
function getBirthDate() {
    var months = document.getElementById("months")
    var hidden1 =  document.getElementById("formsignup:monthField");
    hidden1.value = months.options[months.selectedIndex].text;
    var days = document.getElementById("days");
    var hidden2 = document.getElementById("formsignup:dayField");
    hidden2.value = days.options[days.selectedIndex].value;
    var years = document.getElementById("years");
    var hidden3 = document.getElementById("formsignup:yearField");
    hidden3.value = years.options[years.selectedIndex].value;
} 
```

以下是三个`<h:inputHidden>`组件：

```
<h:inputHidden value="#{signupBean.month}" id="monthField"/>
<h:inputHidden value="#{signupBean.day}" id="dayField"/>
<h:inputHidden value="#{signupBean.year}" id="yearField"/> 
```

这是一个命令按钮，它应该调用将值复制到输入然后将它们提交给支持 bean 的函数。

```
<h:commandButton image="images/images/signup1.png" 
     styleClass="joinnow" 
     id="joinus" action="#{signupBean.save}"
     onclick="getBirthDate()" /> 
```

但它们就像`null`在支持 bean 中一样到达。这是如何引起的，我该如何解决？

编辑：当我尝试从 JSF 组件中选择元素时，jQuery 冻结。元素的 ID 有问题吗？

编辑：下面是与 HTTP 请求一起发送的变量的屏幕截图，证明这些值已正确发送。豆子会有什么问题？

![在此处输入图像描述](../Images/669c0b389ad9159e2a278b6d45581643.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T18:41:06.270

你能检查你的bean的范围，如果它在你的提交过程中被重新初始化。在这种情况下，无论这些值是否是从客户端发送的，隐藏字段都会获得它的初始值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T07:10:58.730

**您可以使用警报**语句检查对象是否存在。例子

```
function getBirthDate() {
var months = document.getElementById("months")
var hidden1 =  document.getElementById("formsignup:monthField");
alert(months);alert(months.value);
alert(hidden1);alert(hidden1.value); 
```

如果 Object 值为 null，则您为获取元素而提供的 Id 不正确..还要检查您从对象中获得的值..我认为这可能会有所帮助

# linux - 将头文件添加到 Linux 内核

> ID：11182893
> 
> 赞同：0
> 
> 时间：2012-06-25T02:37:10.930
> 
> 标签：linux, linux-kernel, header-files

我最近创建了一个新的头文件，我想将它包含在 Linux 内核中。我将 .h 文件放在 usr/src/linux/include/linux 中。我将 .c 文件放在 usr/src/linux/lib 中。我更新了 lib 目录中的 Makefile 并重新编译了内核，没有错误。但是，当我尝试使用头文件中的函数时，我收到一条错误消息，提示未定义函数。我假设（错误地）内核会知道标头用于哪个 c 文件。我该如何正确设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T11:41:08.427

您尝试在哪里使用这些功能？

如果在内核（外部模块）中尝试了您的功能。您需要添加 EXPORT_SYMBOL(); 到定义函数的模块。

否则（从用户空间）它是不同的（并且更复杂）。

# javascript - 如何在 dojo.grid.DataGrid 中创建具有不同小部件的列？

> ID：11182894
> 
> 赞同：1
> 
> 时间：2012-06-25T02:37:13.390
> 
> 标签：javascript, datagrid, dojo

我不确定尝试在 dojo.grid.DataGrid 的列中创建不同类型的单元格小部件是否是个好主意，如果我错了，请纠正我。

这是我的问题：我需要显示并让用户编辑一组键值对，所以我选择 DataGrid 来做。key很简单，都是字符串，只是根据某个key值不同。其中一些具有“1-100”之类的范围，其中一些只是具有“真/假”值的开关，其中一些具有多个值可供选择，例如“简单/中/硬”。

所以我认为对于不同类型的值，我应该使用不同的小部件来表示用户可以执行的某些操作。对于第一个，我在值更改时使用带有一些值检查的文本 aera。第二个我应该使用复选框，第三个我应该使用组合框。

在阅读了一些官方的 dojo 1.7 文档后，我发现 dojo.grid.DataGrid 没有提供直接的方法来做我想做的事情，DataGrid 假设一列中的单元格应该具有相同的类型。谁能帮我解决这个问题？给我一些示例代码给我一个方向。谢谢！我也在考虑另一个解决方案，“值”列中的单元格都是文本区域，当单击它时，会出现一个弹出窗口，上面有正确的小部件，在那里更改值。谁能告诉我这种方式是否更容易实施？

谢谢！
克里斯

使用格式化程序代码：

```
<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>test different widgets in one column</title>
    <link rel="stylesheet" href="lib/1.7.2/dojo/resources/dojo.css">
    <link rel="stylesheet" href="lib/1.7.2/dijit/themes/claro/claro.css">
    <link rel="stylesheet" href="lib/1.7.2/dojox/grid/resources/Grid.css">
    <link rel="stylesheet" href="lib/1.7.2/dojox/grid/resources/claroGrid.css">

    <!-- <link rel="stylesheet" href="style.css" media="screen">
    <link rel="stylesheet" href="../../../resources/style/demo.css" media="screen"> -->
    <!-- load dojo and provide config via data attribute -->
    <script src="lib/1.7.2/dojo/dojo.js"
        data-dojo-config="isDebug: true, async: true">
    </script>
    <script>

        var grid, dataStore;
        require(["dojox/grid/DataGrid", 
                 "dojo/store/Memory",
                 "dojo/data/ObjectStore", 
                 "dojo/_base/xhr",
                 "dojo/domReady!",
                 "dijit/form/Button",
                 "dijit/form/ComboButton",
                 "dijit/Menu",
                 "dijit/MenuItem",
                 "dojox/grid/cells/dijit",
                 "dijit/form/ComboBox",
                 "dijit/form/ValidationTextBox"
                 ], function(DataGrid, Memory, ObjectStore, xhr, Button, ComboButton, Menu, MenuItem, ComboBox, ValidationTextBox) {
                 var gridCellsDijit = dojox.grid.cells;

            xhr.get({
                url: "jsondata",
                handleAs: "json"
            }).then(function(data){
                    dataStore =  new ObjectStore({ objectStore:new Memory({ data: data.items }) });

                    grid = new DataGrid({
                    store: dataStore,
                    query: { id: "*" }, 
                    escapeHTMLInData : false,
                    structure: [

                        {
                            name: "Setting Name", field: "setting_name", width: "50%", editable : false
                        },

                        {
                            name: "value", field: "_item", width: "50%", type: dojox.grid.cells._Widget, editable: false,
                            formatter: function(item, rowIndex, cell){
                                var store = cell.grid.store;
                                if (store.getValue(item, 'type') == 'enum') {
                                    var stateStore = new Memory({
                                            data: [
                                                {name:"setting1", id:"1"},
                                                {name:"setting2", id:"2"},
                                                {name:"setting3", id:"3"},
                                            ]
                                        });

                                    var comboBox = new dijit.form.ComboBox({
                                                name: "state",
                                                value: "setting1",
                                                store: stateStore,
                                                searchAttr: "name"
                                            });
                                    return comboBox;

                                }
                                else {
                                    var tb = new dijit.form.ValidationTextBox({promptMessage:'testtest'});
                                    return tb;
                                }

                            }
                            }
                         ]
                }, "grid");

                grid.startup();
            });
        });
    </script>
</head>
<body class="claro">
    <h1>test different widgets in one column</h1>

    <br/>
    <div id="grid"></div>
</body> 
```

json数据样本是这样的：

```
{
"items": [
    {
        "setting_name": "setting1", 
        "value": "YES",
        "type":"enum",
        "candidates" : ["YES", "NO"]

    }, 
    {
        "setting_name": "setting2", 
        "value": "Disable",
        "type":"enum",
        "candidates" : ["Disable", "Enable"]

    } ,
    {
        "setting_name": "setting3", 
        "value": "19200",
        "type":"enum",
        "candidates" : ["9600", "19200", "38400", "57600"]
    }, 
    {
        "setting_name": "setting4", 
        "value": "25",
        "type":"decimal",
        "min" : "1",
        "max" : "99"
    }, 
    {
        "setting_name": "setting5", 
        "value": "1A",
        "type":"hex",
        "min" :"0" ,
        "max" :"FF"
    }
   ] 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T09:07:23.797

您可以使用格式化程序或 get 函数来执行此操作。然后根据值显示一种 dijit。我不确定它会起作用，但我认为在触发格式化程序或获取时仍可能更改 cellType。

# amazon-web-services - 跟踪 SQS 队列中的消息

> ID：11182896
> 
> 赞同：1
> 
> 时间：2012-06-25T02:37:46.717
> 
> 标签：amazon-web-services, boto, amazon-sqs

我有一个请求队列和一个响应队列。我想将消息从请求队列中取出并放入响应队列。我希望能够确定从请求队列中取出的相同消息已放入响应队列。

我在 GAE 上使用 Boto。

首先，我假设消息 id 是不变的。所以我从请求队列中读取消息，将相同的消息对象添加到响应队列并查询 id - SQS 生成了一个新的。

其次，我的消息正文是一个 json 对象，所以我添加了一个自定义字段“messageId”并生成了我自己的 id 以存储在队列中。但后来我看到，一次从队列中读取 10 条消息是有限制的。另外，由于 SQS 的分布式特性，不保证消息一定会被返回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T16:47:41.193

您的消息将被传递，只是不一定在任何给定的请求中获取它，因为您将与后端服务器的随机子集交谈。SQS 没有办法说，“我知道有 3 条消息给我，现在就给我。” 你能做的最好的就是轮询，直到你最终收到它们。SQS 非常简洁，但它并不是所有事情的正确选择，如果您想要具有更少延迟、更高可预测性和有序消息的东西，请查看 RabbitMQ。Rabbit 的唯一问题是规模现在是您的问题。

# javascript - 从字符串中获取元素

> ID：11182897
> 
> 赞同：0
> 
> 时间：2012-06-25T02:37:51.503
> 
> 标签：javascript, jquery

我在一个包含一大堆 HTML 标记的变量中有一个大字符串。

我想获取字符串中隐藏输入字段的值并将其存储在自己的 var 中。

```
<input type="hidden" value="WantThis" /> 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:42:06.030

您可以使用 jQuery 解析 HTML 以获取值：

```
var theValue = $(myString).find('input[name=something]').val(); 
```

我假设隐藏字段有一个名字。如果没有，您需要`input[type=hidden]`使用其相对于其余内容的位置来指定和查找它。

如果您的字符串还没有根元素并且`<input>`没有嵌套，您可能希望使用它`$('<div>' + myString + '</div>')`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T02:42:50.157

像这样获取隐藏的输入：

```
$(html).find("input[type=hidden]").val() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:41:50.737

为隐藏的输入创建一个 ID 并像往常一样调用它

`<input type="hidden" value="WantThis" id="myInput" />`

然后调用它

`var myval = $('#myInput').val();`

# api - Evernote API - 获取共享笔记本的内容

> ID：11182903
> 
> 赞同：0
> 
> 时间：2012-06-25T02:39:38.590
> 
> 标签：api, evernote

我正在寻找一种无需身份验证即可检索共享笔记本内容的方法。我浏览了官方的 api 文档，但找不到。

示例提要：[https ://www.evernote.com/pub/karis612/foods/feed](https://www.evernote.com/pub/karis612/foods/feed)

访问上面的链接。这是我自己的笔记本上公开分享的 RSS 提要。在 RSS 内容中，我们可以找到两个文章链接。有没有办法从这些网址获取文章内容？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T00:22:37.853

我通过查看共享笔记本页面的来源找到了共享笔记本的内容。它可以在类似于下面的块中找到：

```
<link rel="alternate" type="application/rss+xml"
  title="[Name of Notebook]"
  href="http://www.evernote.com/shard/s31/pub/5145629/[Evernote Username]/[Name of Notebook]/rss.jsp?max=25&sort=2&search=" /> 
```

然后，如果您放弃`?max=25&sort=2&search=`链接末尾的

不确定这是否对您有任何帮助，但祝您好运！

# ios - 如何访问从同一级别的实例方法调用的实例方法中的实例变量

> ID：11182906
> 
> 赞同：0
> 
> 时间：2012-06-25T02:40:17.270
> 
> 标签：ios, cocoa-touch, cocoa

我有一个连接到滑块的 IBAction 实例方法，并在名为 datacellR1 的文本字段中显示滑块值。下面是代码的副本，后面是一个问题。这两种方法都在 View2Controller.m 文件的 @implementation 部分中。

```
- (IBAction)slider1Change:(id)sender 
{

    float pctVal1 = [slider1 floatValue];  // this works
    [datacellR1 setFloatValue:pctVal1];         

   [View2Controller CalculateUpdatedTotal ]; // This method needs to work with the datacellR1 contents, but I can’t access it.

}

-(void)CalculateUpdatedTotal  
{  

    // -------- do some work with datacellR1 ----
    // This function fails with an error

    float newValue = [datacellR1 floatValue];

    //some other code goes here   

} 
```

slider1Change 中的错误是未找到 CalculateUpdatedTotal 方法。如果我将 CalculateUpdatedTotal 从实例方法更改为类方法，则错误是实例变量 datacellR1 在类方法中访问。

关于如何完成这项工作的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T02:44:10.707

`CalculateUpdatedTotal`，正如所写，也是一个实例方法。因此，要调用它，您应该将消息传递给`self`，而不是类 ( `View2Controller`)：

```
[self CalculateUpdatedTotal]; 
```

By the way, it's conventional to begin method names in Objective-C with a lower-case letter.

# mysql - MySQL Union 和 ORDER BY

> ID：11182907
> 
> 赞同：1
> 
> 时间：2012-06-25T02:40:25.143
> 
> 标签：mysql, select, union-all

```
(SELECT * FROM Test1 WHERE (date >= '2012-06-28'AND date < '2012-06-30') AND (Avail > '0'))
UNION 
(SELECT * FROM Test2 WHERE (date >= '2012-06-28'AND date < '2012-06-30') AND (Avail > '0'));

MySQL results

Alpha   Price        date         Avail     description
A           165.00       2012-06-28     10  Something
D           200.00       2012-06-28     10  Something
D           200.00       2012-06-29     10  Something 
```

问题：

```
Alpha = A --> date 2012-06-29 Avail = 0 
```

如何让 MYSQL 仅获得 Alpha=D 的结果，其中日期从 2012 年 6 月 28 日到 2012 年 6 月 30 日，Avail = 10。Alpha=A 仅适用于 2012 年 6 月 28 日

# android - 在钛中解析文件 JSON

> ID：11182910
> 
> 赞同：0
> 
> 时间：2012-06-25T02:41:13.950
> 
> 标签：android, json, titanium

我有一个 JSON 文件，想要解析其中的变量第二个值的值（我想在这个文件 JSON 中获取值“Open”..

{“菜单”：{“id”：“文件”，“值”：“文件”，“弹出”：{“菜单”：[{“值”：“新建”，“onclick”：“CreateNewDoc（）” },{"value": "Open", "onclick": "OpenDoc()"},{"value": "Close", "onclick": "CloseDoc()"} ] } }}

我使用以下代码进行解析，但它是错误的：

```
 for(var i in itemList)
    {
    var thisItem = itemList[i];             
    var itemList1=JSON.parse(thisItem.popup);
    for(var j in itemList1)
    {
        var thisItem1=itemList1[0];
        label.text=thisItem1.value;
    }
    } 
```

你能帮助我吗。！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:51:34.563

这是您如何解析json。工作演示：http: [//jsfiddle.net/epinapala/B5J5C/3/](http://jsfiddle.net/epinapala/B5J5C/3/)

JSON 文本格式在语法上与创建 JavaScript 对象的代码相同。​ 如果这是来自你服务器的 JSON 响应，则无需解析，直接访问对象的属性即可。

```
var jsonObject = {
   "menu":{
      "id":"file",
      "value":"File",
      "popup":{
         "menuitem":[
            {
               "value":"New",
               "onclick":"CreateNewDoc()"
            },
            {
               "value":"Open",
               "onclick":"OpenDoc()"
            },
            {
               "value":"Close",
               "onclick":"CloseDoc()"
            }
         ]
      }
   }
};

alert(jsonObject.menu.popup.menuitem[1].value); 
```

如果您正在处理 Json 字符串，请使用 JSON.parse 检索 Object ，然后对其进行解析。工作演示：http: [//jsfiddle.net/epinapala/B5J5C/2/](http://jsfiddle.net/epinapala/B5J5C/2/)

```
 var jsonText = '{"menu": { "id": "file", "value": "File", "popup": { "menuitem": [{"value": "New", "onclick": "CreateNewDoc()"},{"value": "Open", "onclick": "OpenDoc()"},{"value": "Close", "onclick": "CloseDoc()"} ] } }}';

    alert(JSON.parse(jsonText).menu.popup.menuitem[1].value);

​ 
```

# c++ - 在 protobuf 列表的开头插入一个项目

> ID：11182916
> 
> 赞同：3
> 
> 时间：2012-06-25T02:41:49.957
> 
> 标签：c++, list, protocol-buffers

我正在尝试在 protobuf 消息列表的开头插入一个项目。`add_foo`将项目附加到结尾。有没有一种简单的方法可以在开头插入它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-25T23:43:36.840

使用协议缓冲区AFAIK没有内置方法可以做到这一点。当然，[文档](https://developers.google.com/protocol-buffers/docs/reference/cpp-generated#fields)似乎没有表明任何此类选项。

一种相当有效的方法可能是像往常一样在末尾添加新元素，然后反向迭代元素，将新元素交换到前一个元素的前面，直到它位于列表的前面。例如，对于 protobuf 消息，例如：

```
message Bar {
  repeated bytes foo = 1;
} 
```

你可以这样做：

```
Bar bar;
bar.add_foo("two");
bar.add_foo("three");

// Push back new element
bar.add_foo("one");
// Get mutable pointer to repeated field
google::protobuf::RepeatedPtrField<std::string> *foo_field(bar.mutable_foo());
// Reverse iterate, swapping new element in front each time
for (int i(bar.foo_size() - 1); i > 0; --i)
  foo_field->SwapElements(i, i - 1);

std::cout << bar.DebugString() << '\n'; 
```

# javascript - 如何检查 JavaScript 对象是否为 JSON

> ID：11182924
> 
> 赞同：108
> 
> 时间：2012-06-25T02:42:22.730
> 
> 标签：javascript, json

我有一个需要循环的嵌套 JSON 对象，每个键的值可以是字符串、JSON 数组或另一个 JSON 对象。根据对象的类型，我需要执行不同的操作。有什么方法可以检查对象的类型以查看它是字符串、JSON 对象还是 JSON 数组？

我尝试使用`typeof`，`instanceof`但两者似乎都不起作用，因为`typeof`将为 JSON 对象和数组返回一个对象，并`instanceof`在我这样做时给出错误`obj instanceof JSON`。

更具体地说，在将 JSON 解析为 JS 对象后，有什么方法可以检查它是普通字符串，还是带有键和值的对象（来自 JSON 对象），还是数组（来自 JSON 数组)?

例如：

JSON

```
var data = "{'hi':
             {'hello':
               ['hi1','hi2']
             },
            'hey':'words'
           }"; 
```

示例 JavaScript

```
var jsonObj = JSON.parse(data);
var path = ["hi","hello"];

function check(jsonObj, path) {
    var parent = jsonObj;
    for (var i = 0; i < path.length-1; i++) {
        var key = path[i];
        if (parent != undefined) {
            parent = parent[key];
        }
    }
    if (parent != undefined) {
        var endLength = path.length - 1;
        var child = parent[path[endLength]];
        //if child is a string, add some text
        //if child is an object, edit the key/value
        //if child is an array, add a new element
        //if child does not exist, add a new key/value
    }
} 
```

如上所示，如何进行对象检查？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2012-06-25T02:57:38.073

我会检查构造函数属性。

例如

```
var stringConstructor = "test".constructor;
var arrayConstructor = [].constructor;
var objectConstructor = ({}).constructor;

function whatIsIt(object) {
    if (object === null) {
        return "null";
    }
    if (object === undefined) {
        return "undefined";
    }
    if (object.constructor === stringConstructor) {
        return "String";
    }
    if (object.constructor === arrayConstructor) {
        return "Array";
    }
    if (object.constructor === objectConstructor) {
        return "Object";
    }
    {
        return "don't know";
    }
}

var testSubjects = ["string", [1,2,3], {foo: "bar"}, 4];

for (var i=0, len = testSubjects.length; i < len; i++) {
    alert(whatIsIt(testSubjects[i]));
} 
```

编辑：添加了一个空检查和一个未定义的检查。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-25T02:53:36.060

您可以使用**Array.isArray**来检查数组。然后**typeof obj == 'string'**和**typeof obj == 'object'**。

```
var s = 'a string', a = [], o = {}, i = 5;
function getType(p) {
    if (Array.isArray(p)) return 'array';
    else if (typeof p == 'string') return 'string';
    else if (p != null && typeof p == 'object') return 'object';
    else return 'other';
}
console.log("'s' is " + getType(s));
console.log("'a' is " + getType(a));
console.log("'o' is " + getType(o));
console.log("'i' is " + getType(i)); 
```

> 's' 是字符串
> 'a' 是数组
> 'o' 是对象
> 'i' 是其他

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2017-10-10T16:12:14.917

JSON 对象**是**一个对象。要检查类型是否为对象类型，请评估构造函数属性。

```
function isObject(obj)
{
    return obj !== undefined && obj !== null && obj.constructor == Object;
} 
```

这同样适用于所有其他类型：

```
function isArray(obj)
{
    return obj !== undefined && obj !== null && obj.constructor == Array;
}

function isBoolean(obj)
{
    return obj !== undefined && obj !== null && obj.constructor == Boolean;
}

function isFunction(obj)
{
    return obj !== undefined && obj !== null && obj.constructor == Function;
}

function isNumber(obj)
{
    return obj !== undefined && obj !== null && obj.constructor == Number;
}

function isString(obj)
{
    return obj !== undefined && obj !== null && obj.constructor == String;
}

function isInstanced(obj)
{
    if(obj === undefined || obj === null) { return false; }

    if(isArray(obj)) { return false; }
    if(isBoolean(obj)) { return false; }
    if(isFunction(obj)) { return false; }
    if(isNumber(obj)) { return false; }
    if(isObject(obj)) { return false; }
    if(isString(obj)) { return false; }

    return true;
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-06-25T02:55:30.097

`object`如果您在解析字符串后尝试检查 an 的类型`JSON`，我建议检查构造函数属性：

```
obj.constructor == Array || obj.constructor == String || obj.constructor == Object 
```

这将是比 typeof 或 instanceof 更快的检查。

如果**JSON 库**不返回使用这些函数构造的对象，我会非常怀疑它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-06-25T02:57:31.557

您可以为 JSON 解析创建自己的构造函数：

```
var JSONObj = function(obj) { $.extend(this, JSON.parse(obj)); }
var test = new JSONObj('{"a": "apple"}');
//{a: "apple"} 
```

然后检查 instanceof 看它是否需要解析

```
test instanceof JSONObj 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-05-22T23:16:24.947

@PeterWilkinson 的答案对我不起作用，因为“类型化”对象的构造函数是根据该对象的名称定制的。我不得不使用[typeof](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/typeof)

```
function isJson(obj) {
    var t = typeof obj;
    return ['boolean', 'number', 'string', 'symbol', 'function'].indexOf(t) == -1;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-07-07T14:55:34.020

您还可以尝试解析数据，然后检查是否有对象：

```
var testIfJson = JSON.parse(data);
if (typeof testIfJson == "object"){
    //Json
} else {
    //Not Json
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-02-13T19:18:15.533

我写了一个 npm 模块来解决这个问题。它在[这里](https://github.com/dawsonbotsford/object-types)可用：

`object-types`: 一个用于查找对象的字面量类型的模块

## 安装

```
 npm install --save object-types 
```

## 用法

```
const objectTypes = require('object-types');

objectTypes({});
//=> 'object'

objectTypes([]);
//=> 'array'

objectTypes(new Object(true));
//=> 'boolean' 
```

看一下，它应该可以解决您的确切问题。如果您有任何问题，请告诉我！[https://github.com/dawsonbotsford/object-types](https://github.com/dawsonbotsford/object-types)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-07-09T10:32:19.650

为什么不检查 Number - 更短一点，并且可以在 IE/Chrome/FF/node.js 中使用

```
function whatIsIt(object) {
    if (object === null) {
        return "null";
    }
    else if (object === undefined) {
        return "undefined";
    }
    if (object.constructor.name) {
            return object.constructor.name;
    }
    else { // last chance 4 IE: "\nfunction Number() {\n    [native code]\n}\n" / node.js: "function String() { [native code] }"
        var name = object.constructor.toString().split(' ');
        if (name && name.length > 1) {
            name = name[1];
            return name.substr(0, name.indexOf('('));
        }
        else { // unreachable now(?)
            return "don't know";
        }
    }
}

var testSubjects = ["string", [1,2,3], {foo: "bar"}, 4];
// Test all options
console.log(whatIsIt(null));
console.log(whatIsIt());
for (var i=0, len = testSubjects.length; i < len; i++) {
    console.log(whatIsIt(testSubjects[i]));
}
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-04-17T10:27:46.833

我将 typeof 运算符与构造函数属性的检查结合起来（由 Peter 编写）：

```
var typeOf = function(object) {
    var firstShot = typeof object;
    if (firstShot !== 'object') {
        return firstShot;
    } 
    else if (object.constructor === [].constructor) {
        return 'array';
    }
    else if (object.constructor === {}.constructor) {
        return 'object';
    }
    else if (object === null) {
        return 'null';
    }
    else {
        return 'don\'t know';
    } 
}

// Test
var testSubjects = [true, false, 1, 2.3, 'string', [4,5,6], {foo: 'bar'}, null, undefined];

console.log(['typeOf()', 'input parameter'].join('\t'))
console.log(new Array(28).join('-'));
testSubjects.map(function(testSubject){
    console.log([typeOf(testSubject), JSON.stringify(testSubject)].join('\t\t'));
}); 
```

结果：

```
typeOf()    input parameter
---------------------------
boolean     true
boolean     false
number      1
number      2.3
string      "string"
array       [4,5,6]
object      {"foo":"bar"}
null        null
undefined 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-02-26T06:45:29.323

我知道这是一个非常古老的问题，答案很好。但是，似乎仍然可以将我的 2¢ 添加到其中。

假设您尝试测试的不是 JSON 对象本身，而是格式化为 JSON 的字符串（您的 似乎就是这种情况`var data`），您可以使用以下返回布尔值的函数（是或不是 ' JSON'）：

```
function isJsonString( jsonString ) {

  // This function below ('printError') can be used to print details about the error, if any.
  // Please, refer to the original article (see the end of this post)
  // for more details. I suppressed details to keep the code clean.
  //
  let printError = function(error, explicit) {
  console.log(`[${explicit ? 'EXPLICIT' : 'INEXPLICIT'}] ${error.name}: ${error.message}`);
  }

  try {
      JSON.parse( jsonString );
      return true; // It's a valid JSON format
  } catch (e) {
      return false; // It's not a valid JSON format
  }

} 
```

以下是使用上述函数的一些示例：

```
console.log('\n1 -----------------');
let j = "abc";
console.log( j, isJsonString(j) );

console.log('\n2 -----------------');
j = `{"abc": "def"}`;
console.log( j, isJsonString(j) );

console.log('\n3 -----------------');
j = '{"abc": "def}';
console.log( j, isJsonString(j) );

console.log('\n4 -----------------');
j = '{}';
console.log( j, isJsonString(j) );

console.log('\n5 -----------------');
j = '[{}]';
console.log( j, isJsonString(j) );

console.log('\n6 -----------------');
j = '[{},]';
console.log( j, isJsonString(j) );

console.log('\n7 -----------------');
j = '[{"a":1, "b":   2}, {"c":3}]';
console.log( j, isJsonString(j) ); 
```

当您运行上面的代码时，您将得到以下结果：

```
1 -----------------
abc false

2 -----------------
{"abc": "def"} true

3 -----------------
{"abc": "def} false

4 -----------------
{} true

5 -----------------
[{}] true

6 -----------------
[{},] false

7 -----------------
[{"a":1, "b":   2}, {"c":3}] true 
```

请尝试下面的代码段，让我们知道这是否适合您。:)

重要提示：本文中介绍的函数改编自[https://airbrake.io/blog/javascript-error-handling/syntaxerror-json-parse-bad-parsing](https://airbrake.io/blog/javascript-error-handling/syntaxerror-json-parse-bad-parsing)，您可以在其中找到有关 JSON.parse 的更多有趣的详细信息（ ） 功能。

```
function isJsonString( jsonString ) {

  let printError = function(error, explicit) {
  console.log(`[${explicit ? 'EXPLICIT' : 'INEXPLICIT'}] ${error.name}: ${error.message}`);
  }

  try {
      JSON.parse( jsonString );
      return true; // It's a valid JSON format
  } catch (e) {
      return false; // It's not a valid JSON format
  }

}

console.log('\n1 -----------------');
let j = "abc";
console.log( j, isJsonString(j) );

console.log('\n2 -----------------');
j = `{"abc": "def"}`;
console.log( j, isJsonString(j) );

console.log('\n3 -----------------');
j = '{"abc": "def}';
console.log( j, isJsonString(j) );

console.log('\n4 -----------------');
j = '{}';
console.log( j, isJsonString(j) );

console.log('\n5 -----------------');
j = '[{}]';
console.log( j, isJsonString(j) );

console.log('\n6 -----------------');
j = '[{},]';
console.log( j, isJsonString(j) );

console.log('\n7 -----------------');
j = '[{"a":1, "b":   2}, {"c":3}]';
console.log( j, isJsonString(j) );
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-09-18T14:54:12.143

试试这个

```
if ( typeof is_json != "function" )
function is_json( _obj )
{
    var _has_keys = 0 ;
    for( var _pr in _obj )
    {
        if ( _obj.hasOwnProperty( _pr ) && !( /^\d+$/.test( _pr ) ) )
        {
           _has_keys = 1 ;
           break ;
        }
    }

    return ( _has_keys && _obj.constructor == Object && _obj.constructor != Array ) ? 1 : 0 ;
} 
```

它适用于下面的示例

```
var _a = { "name" : "me",
       "surname" : "I",
       "nickname" : {
                      "first" : "wow",
                      "second" : "super",
                      "morelevel" : {
                                      "3level1" : 1,
                                      "3level2" : 2,
                                      "3level3" : 3
                                    }
                    }
     } ;

var _b = [ "name", "surname", "nickname" ] ;
var _c = "abcdefg" ;

console.log( is_json( _a ) );
console.log( is_json( _b ) );
console.log( is_json( _c ) ); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-11-24T02:02:24.823

基于@Martin Wantke 的回答，但有一些建议的改进/调整...

```
// NOTE: Check JavaScript type. By Questor
function getJSType(valToChk) {

    function isUndefined(valToChk) { return valToChk === undefined; }
    function isNull(valToChk) { return valToChk === null; }
    function isArray(valToChk) { return valToChk.constructor == Array; }
    function isBoolean(valToChk) { return valToChk.constructor == Boolean; }
    function isFunction(valToChk) { return valToChk.constructor == Function; }
    function isNumber(valToChk) { return valToChk.constructor == Number; }
    function isString(valToChk) { return valToChk.constructor == String; }
    function isObject(valToChk) { return valToChk.constructor == Object; }

    if(isUndefined(valToChk)) { return "undefined"; }
    if(isNull(valToChk)) { return "null"; }
    if(isArray(valToChk)) { return "array"; }
    if(isBoolean(valToChk)) { return "boolean"; }
    if(isFunction(valToChk)) { return "function"; }
    if(isNumber(valToChk)) { return "number"; }
    if(isString(valToChk)) { return "string"; }
    if(isObject(valToChk)) { return "object"; }

} 
```

**注意：**我发现这种方法非常具有指导意义，所以我提交了这个答案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-08-20T20:05:52.897

彼得的回答是额外的检查！当然，不是100%保证！

```
var isJson = false;
outPutValue = ""
var objectConstructor = {}.constructor;
if(jsonToCheck.constructor === objectConstructor){
    outPutValue = JSON.stringify(jsonToCheck);
    try{
            JSON.parse(outPutValue);
            isJson = true;
    }catch(err){
            isJson = false;
    }
}

if(isJson){
    alert("Is json |" + JSON.stringify(jsonToCheck) + "|");
}else{
    alert("Is other!");
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-25T10:40:45.957

我对此有一个非常懒惰的答案，如果您尝试解析字符串/其他值，它不会引发错误。

```
const checkForJson = (value) => {
    if (typeof value !== "string") return false;

    return value[0] === "{" && value[value.length - 1] === "}";
} 
```

您可以在进行一些递归函数时使用它来检查键的值；抱歉，如果这不能完全回答问题

Ofc 这不是最优雅的解决方案，并且当字符串实际上以“{”开头并以“}”结尾时会失败，尽管这些用例很少见，如果你真的想要，你可以检查是否存在引号或其他废话...无论如何，请自行决定使用。

TLDR：它不是万无一失的，但它很简单，适用于绝大多数用例。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-10-17T10:40:40.043

**lodash**也是检查这些东西的最佳选择。

```
function Foo() {
  this.a = 1;
}

_.isPlainObject(new Foo);
// => false

_.isPlainObject([1, 2, 3]);
// => false

_.isPlainObject({ 'x': 0, 'y': 0 });
// => true

_.isPlainObject(Object.create(null));
// => true 
```

[https://www.npmjs.com/package/lodash](https://www.npmjs.com/package/lodash)
[https://lodash.com/docs/#isPlainObject](https://lodash.com/docs/#isPlainObject)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-01-02T12:18:43.557

试试看，Catch 块会帮你解决这个问题

**做一个函数**

```
function IsJson(str) {
    try {
        JSON.parse(str);
    } catch (e) {
        return false;
    }
    return true;
} 
```

**例子：**

```
console.log(IsJson('abc')) // false
console.log(IsJson('[{"type":"email","detail":"john@example.com"}]')) // true 
```

* * *

## 回答 #18

> 赞同：-5
> 
> 时间：2017-03-24T16:34:32.973

试试这种肮脏的方式

```
 ('' + obj).includes('{') 
```

# windows - 在 Windows 8 Metro 应用程序中包含资源文件

> ID：11182925
> 
> 赞同：3
> 
> 时间：2012-06-25T02:42:23.643
> 
> 标签：windows, windows-8, microsoft-metro

我正在将一个应用程序移植到 Windows 8 Metro，它有许多资源文件（例如位图文件、xml 文件、二进制文件），它们是运行所必需的。如何在应用程序中包含这些以及如何从 C++ 访问它们？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:47:44.513

只需添加资源并将其构建操作设置为“内容”。之后，您可以直接使用引用 XAML 中的图像。

```
<Image Source="images/logo.png" /> 
```

在 C# 中

```
var uri = new Windows.Foundation.Uri('ms-appx:///images/logo.png');
var file = Windows.Storage.StorageFile.getFileFromApplicationUriAsync(uri); 
```

[更多>>](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/hh965325.aspx)

# php - 如何从mysql中的parent_id获取值？

> ID：11182926
> 
> 赞同：3
> 
> 时间：2012-06-25T02:42:29.533
> 
> 标签：php, mysql

我有一个样本数据

```
game(id, name)
      1 | Avatar
      2 | Angry Bids
brand(id, parent_id, name)
      1 | 0 | Apple
      2 | 0 | Samsung
      3 | 1 | Iphone 4
      4 | 2 | Galaxy Tab
game_brand(game_id, brand_id)
              1   | 4
              2   | 3 
```

并查询：

```
SELECT game.name, 
       game_brand.brand_id, 
       (SELECT brand.parent_id 
        FROM   brand AS brand 
        WHERE  brand.brand_id = game_brand.brand_id) AS brand_father_id 
FROM   game AS game 
       LEFT JOIN game_brand AS game_brand 
              ON game_brand.game_id = game.id 
WHERE  game.id = 2 
```

和结果：

```
name       | brand_id |    brand_father_id
Angry Bids |    3     |       1 
```

如何从`brand_id`,中获取值`brand_father_id`，例如：

```
game       | brand    | brand parent
Angry Bids | Iphone 4 | Apple 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:53:57.080

```
SELECT game.name, child.name AS brand_name, parent.name AS brand_father_name
FROM game_brand INNER JOIN game ON game_brand.game_id = game.id
INNER JOIN brand AS child ON game_brand.brand_id = child.id
INNER JOIN brand AS parent ON child.parent_id = parent.id
WHERE game.id = 2 
```

**更新**

```
SELECT game.name, child.name AS brand_name, (SELECT name FROM brand AS parent WHERE child.parent_id = parent.id) AS brand_father_name
FROM game_brand INNER JOIN game ON game_brand.game_id = game.id
INNER JOIN brand AS child ON game_brand.brand_id = child.id
WHERE game.id = 2 
```

**再次更新**

**又一次又一次**注意到，OP不仅想要父亲的名字，还想要孩子的名字（也不是他们的身份证），所以更新了他们两个......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T08:27:44.560

试试这个

```
SELECT
  game.name,    
  brand.name          AS brand_father_name,
  brndName.name       AS brand_name
FROM game AS game
  LEFT JOIN game_brand AS game_brand
    ON game_brand.game_id = game.id
  LEFT JOIN brand AS brand
    ON brand.id = game_brand.brand_id
  LEFT JOIN brand AS brndName
    ON brndName.id = brand.parent_id
WHERE game.id = 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T08:32:57.090

显然，如果您的模型和查询的约束被视为纯粹抽象的，那么 Nikola 的答案就是正确的。但是对于任何找到解决这个问题的方法的人，因为他们有相似的模型和相似的目标，这里有一种不同的方法：

通过将品牌表拆分为两个单独的表来消除品牌层次结构的不必要限制：

```
brand(id, manufacturer_id, name)
      1 | 1 | Iphone 4
      2 | 2 | Galaxy Tab

manufacturer(id, name)
      1 | Apple
      2 | Samsung 
```

这是基于我从示例数据模型中推断出的某些假设：

1.  游戏永远不会与“母品牌”直接相关
2.  “子品牌”永远不会是“母品牌”

如果上述情况属实，则该`manufacturer`表更合适/规范化并将查询减少到：

```
SELECT 
     game.name AS game, 
     brand.name AS brand, 
     manufacturer.name AS manufacturer
FROM game 
     JOIN game_brand ON (game.id = game_id)
     JOIN brand ON (brand_id = brand.id)
     JOIN manufacturer ON (brand.manufacturer_id = manufacturer.id) 
```

以上将返回所有与品牌有关系的游戏，这些品牌与制造商有关系。要获取所有游戏，即使它们只有一个品牌，您可能希望至少在最后一个连接中使用左连接。

# mysql - 蒙古语的 MySQL 连接排序规则是什么？

> ID：11182931
> 
> 赞同：1
> 
> 时间：2012-06-25T02:43:43.557
> 
> 标签：mysql, collation

蒙古语的 MySQL 连接排序规则是什么？utf8_unicode_ci? 还是ut8_general_ci？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:55:26.027

它们都应该涵盖蒙古语。

主要区别仅在于性能和分拣准确性。utf8_general_ci 比 utf8_unicode_ci 快一点。另一方面，utf8_unicode_ci 对排序更准确一些。

# javascript - Split Flap文本动画Jquery

> ID：11182934
> 
> 赞同：1
> 
> 时间：2012-06-25T02:44:10.653
> 
> 标签：javascript, jquery, jquery-plugins, jquery-animate

您能否建议我一个 Jquery 插件，它与此演示具有相同的文本动画：[http ://www.youtube.com/watch?v=1sn5FCSIfuE&feature=youtu.be](http://www.youtube.com/watch?v=1sn5FCSIfuE&feature=youtu.be)

这是用 Flash 制作的文本动画（在此处查看：http: [//ae.tutsplus.com/tutorials/motion-graphics/create-a-split-flap-type-display/](http://ae.tutsplus.com/tutorials/motion-graphics/create-a-split-flap-type-display/)）但我想要在纯 Javascript、CSS 和 HTML 中的效果相同。

谢谢你的建议，狮子座

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-25T03:16:33.313

使用一些 CSS3 3D 变换是可行的。虽然它不适用于所有浏览器，但可以做到。

这是一个非 css3 版本（天赋较少且没有 3D）： http: [//net.tutsplus.com/tutorials/html-css-techniques/learn-how-to-create-a-retro-animated-flip-down -钟/](http://net.tutsplus.com/tutorials/html-css-techniques/learn-how-to-create-a-retro-animated-flip-down-clock/)

这里有一个（少数）CSS3 演示：[http](http://rupey.org/demo/css3-clock/) : //rupey.org/demo/css3-clock/，http: [//mathieujouhet.com/demos/flipping-clock/](http://mathieujouhet.com/demos/flipping-clock/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-31T07:15:52.513

我在 Javascript 中找到了这个解决方案：http: [//cnanney.com/journal/demo/apple-counter-revisited/](http://cnanney.com/journal/demo/apple-counter-revisited/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T04:32:13.057

不是 3D - 但相同的原则：

[http://keith-wood.name/flightBoard.html](http://keith-wood.name/flightBoard.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-30T09:32:24.327

我不确定这是您要查找的内容，但您可以随时查看：

[Textillate.js - 一个用于 CSS3 文本动画的 jQuery 插件](http://www.functionn.in/2013/01/textillatejs-jquery-plugin-for-css3.html)

Textillate.js 让您可以更轻松地为文本设置动画效果，如闪光、反弹、摇晃等。我已经尝试过了，它非常棒，并且建立在提供的 JavaScript 库之上。

# c# - Response.Redirect 不起作用

> ID：11182940
> 
> 赞同：0
> 
> 时间：2012-06-25T02:45:43.737
> 
> 标签：c#, asp.net, excel-2007, response.redirect

我有一个页面将大量数据导出为 excel 2007 启用宏的格式。在创建 excel 文件后，我最后有 Response.Redirect 以重定向到另一个页面，但是当我有大量数据（即大约 60,000 多行）时，重定向不起作用。下面是我用来保存 excel 文件的代码片段：

```
Response.Clear();
Response.AppendHeader("content-disposition", "attachment; filename=RegionData.xlsm");
Response.ContentType = "application/octet-stream";
wbRegionData.Save(Response.OutputStream);//();
Response.End();
Response.Redirect("RegionData.aspx?PALID=" + AVListID, true); 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:02:47.857

您不能在同一服务器响应中进行文件下载和重定向。如果您需要在成功下载文件后执行重定向，您将需要以某种方式告诉客户端文件下载成功发生，据我所知，这只能通过写入 cookie 来完成。

我创建了 jQuery 文件下载插件 ( [Demo](http://jqueryfiledownload.apphb.com/) ) ( [GitHub](https://github.com/johnculviner/jquery.fileDownload) ) [(Blog Posts](http://johnculviner.com/category/jQuery-File-Download.aspx) )，它简化了很多这样的东西，使用插件你的代码可能是这样的：

ASP.NET 代码：

```
Response.Clear();
Response.AppendHeader("content-disposition", "attachment; filename=RegionData.xlsm");
Response.ContentType = "application/octet-stream";
Response.SetCookie(new HttpCookie("fileDownload", "true"){Path = "/"});
wbRegionData.Save(Response.OutputStream);//();
Response.End(); 
```

JavaScript：

```
$.fileDownload("/urltofiledownload/", {
    successCallback: function (url) {
        window.location = "/redirecturl/";
    }
}); 
```

如果没有更多代码，我无法为您提供完整的解决方案（请查看[演示](http://jqueryfiledownload.apphb.com/)示例），但我认为使用该插件将是您最简单和最好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T02:50:50.313

您不能，因为您正在通过调用关闭响应[`Response.End();`](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.end.aspx)您必须分别添加定义这两个操作（下载和重定向）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:51:25.560

它不起作用，因为 Respose.End() 方法停止了页面的正常执行，我已经重新编写了您的代码并删除了 de Response.End() 方法，现在它可以工作了。

```
 Response.Clear();
    Response.AppendHeader("content-disposition", "attachment; filename=RegionData.xlsm");
    Response.ContentType = "application/octet-stream";
    wbRegionData.Save(Response.OutputStream);//();
    Response.Redirect("RegionData.aspx?PALID=" + AVListID, true); 
```

# c - 在 C 中组合字符串

> ID：11182942
> 
> 赞同：-2
> 
> 时间：2012-06-25T02:45:48.593
> 
> 标签：c

我正在尝试向小通知系统 dunst 添加一些功能。我从来没有真正在 C 语言中做过任何事情，但我确实设法在一个小文件中基本上完成了我想要的事情：

```
#include<stdio.h>
#include<string.h>

main()
{
    char str1[128];
    char str2[128];
    sprintf(str1,"Hello");
    sprintf(str2,"world!");

    printf("%s %s\n",str1,str2);
} 
```

strcat 更改给定的第一个字符串，这不是我想要的。在程序中，它通过给定的文本计算窗口的宽度，我想在通知消息（cur_msg->msg）上附加一些文本（隐藏）。

代码如下所示：

```
#define MAX(a,b)                ((a) > (b) ? (a) : (b))

void
drawmsg(void) {
    int width, x, y, height, drawn_msg_count, i;
    unsigned int len = list_len(msgqueue);
    msg_queue_t *cur_msg = msgqueue;
    char hidden[128];
    int hidden_count = 0;
    int hidden_color_idx = NORM;
    dc->x = 0;
    dc->y = 0;
    dc->h = 0;
    /* a height of 0 doesn't make sense, so we define it as 1 */
    if(geometry.h == 0) {
        geometry.h = 1;
    }

    height = MIN(geometry.h, len);
    drawn_msg_count = height;
    hidden_count = len - height;
    hidden_count = indicate_hidden && hidden_count > 0 ? hidden_count : 0;
    sprintf(hidden, "(%d more)", hidden_count);
    if(hidden_count && !single_line)
        height++;

    if(geometry.mask & WidthValue) {
        if(geometry.w == 0) {
            width = 0;
            for(i = 0; i < height; i++){
                width = MAX(width, textw(dc, cur_msg->msg));
                if(hidden_count && !single_line)
                    width = MAX(width, textw(dc,("%s %s",cur_msg->msg,hidden)));
                cur_msg = cur_msg->next;
            }
        } else {
            width = geometry.w;
        }
    } else {
        width = scr.dim.w;
    }

    cur_msg = msgqueue;

    if(geometry.mask & XNegative) {
        x = (scr.dim.x + (scr.dim.w - width)) + geometry.x;
    } else {
        x = scr.dim.x + geometry.x;
    }

    if(geometry.mask & YNegative) {
        y = (scr.dim.h + geometry.y) - height*font_h;
    } else {
       y = 0 + geometry.y;
    }

    resizedc(dc, width, height*font_h);
    XResizeWindow(dc->dpy, win, width, height*font_h);
    drawrect(dc, 0, 0, width, height*font_h, True, colors[NORM]->BG);

    for(i = 0; i < drawn_msg_count; i++) {
        if(cur_msg->start == 0)
            cur_msg->start = now;

        drawrect(dc, 0, dc->y, width, font_h, True, cur_msg->colors->BG);
        if(hidden_count && single_line){
            drawtext(dc, ("%s %s",cur_msg->msg,hidden), cur_msg->colors);
        } else {
            drawtext(dc, cur_msg->msg, cur_msg->colors);
        }

        dc->y += font_h;
        hidden_color_idx = cur_msg->urgency;
        cur_msg = cur_msg->next;
    }

    if(hidden_count && !single_line) {
        drawrect(dc, 0, dc->y, width, font_h, True, colors[NORM]->BG);

        drawtext(dc, hidden, colors[hidden_color_idx]);
        dc->y += font_h;
    }

    XMoveWindow(dc->dpy, win, x, y);

    mapdc(dc, win, width, height*font_h);
} 
```

这是根据我的猜测将它用作逗号运算符，我想像 printf 一样使用它，用字符串替换 %s ：/

我怎样才能让它正确地做到这一点？如果我能得到它，我想我可以得到我想要工作的改变。

随意缩短代码，我不知道我真正需要保留什么以及如果我需要一些帮助可以删除什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:49:11.067

没有真正阅读您的代码，但对我来说确实听起来很像`sprint`。

`int sprintf ( char * str, const char * format, ... );`基本上 printf 用于字符串。将采用格式运算符并将其全部放入 str 中。

[文档](http://www.cplusplus.com/reference/clibrary/cstdio/sprintf/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T03:00:51.187

请注意，应该使用 snprintf() 而不是 sprintf() （设置缓冲区大小以防止溢出很重要）。

理想情况下，根据两个原始字符串的长度分配一个缓冲区，然后使用组合它们的格式；例如 snprintf(buffer, length, "%s%s", str1, str2)。

调用 snprintf() 或任何类似函数时，请务必检查返回值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T02:49:27.697

不太确定您要做什么，但是据我所知，您要的是

sprintf.....就像printf一样，除了首先你指定你希望结果进入什么字符串

`sprintf(s, "%s %s", str1, str2);`

# javascript - GreaseMonkey 和 JQuery AJAX 响应在任何形式的回调中都不存在

> ID：11182943
> 
> 赞同：-1
> 
> 时间：2012-06-25T02:46:09.977
> 
> 标签：javascript, jquery, ajax, greasemonkey

在大家发现之前，之前或多或少地有人问过这个问题：[Load remote URL with Greasemonkey and jQuery](https://stackoverflow.com/questions/728138/load-remote-url-with-greasemonkey-and-jquery)

然而，那是3年前的事了。我尝试了答案中提出的各种方法，但都没有奏效。

基本上，我的问题是这样的：我正在编写一个greasemonkey脚本，目前应该是A）获取页面上的链接，B）请求链接链接到的页面（它在同一主机上）， C) 在该页面上找到某个值。我正在使用 jQuery 1.7.2 和最新版本的 Greasemonkey 来尝试完成此操作。

问题是，虽然我可以成功请求页面，但我无法对响应做任何事情。我尝试将响应分配给回调之外的变量，但它最终为空。我已经尝试将响应 html 附加到我在页面上插入的 div 中，但是在 div 上使用 console.log 显示它是空的（即使 firebug 实际上显示了 html）。就像回调一结束，检索到的 html 不仅不存在，而且根本不存在。

所以基本上，我想问如何检索html，以便在请求完成后我可以实际使用它。这是我现在得到的（我已经删除了上述尝试将响应附加到页面上的 div）：

```
function getLink(url){
    var resp;
    GM_xmlhttpRequest({
        method: 'GET',
        url: url,
        onload: function(response){
            resp = response.responseText;
        }
    });
    console.log(resp) //nothing here...

    //failed code :(
    /*$.ajax(url, {success: function(data){resp = data})
    console.log(data)*/
} 
```

我需要编写什么魔术代码才能使上述内容按预期工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T03:02:28.017

`GM_xmlhttpRequest()`默认情况下异步操作。这意味着`onload`火灾在`console.log(resp) //nothing here...`线路之后很长时间。

虽然[`GM_xmlhttpRequest()`now 需要一个`synchronous: true`](http://wiki.greasespot.net/GM_xmlhttpRequest)参数，[但它非常有问题](https://stackoverflow.com/q/8778267/331508)，我暂时不建议尝试使用它。

做事的正确方法（以及更好的编程和 UI 实践）是将所有内容放在`onload`处理程序中：

```
function getLink (url) {
    GM_xmlhttpRequest ( {
        method: 'GET',
        url: url,
        onload: function (response) {
            var resp = response.responseText;
            console.log (resp);

            // DO EVERYTHING THAT REQUIRES resp HERE.
        }
    } );
} 
```

这可能需要改变您对某些操作的看法，但这是非常值得的。

# c# - C# 保存大图像

> ID：11182948
> 
> 赞同：9
> 
> 时间：2012-06-25T02:47:04.860
> 
> 标签：c#, .net, image, png, large-files

尝试使用 C# 保存大图像时遇到困难（我说的是超过 1 GB）。

基本上我正在尝试部分地执行此操作 - 我有大约 200 个位图源，我需要一种方法在将它们编码为 .png 文件之前或之后将它们组合起来。

我知道这将需要大量 RAM，除非我以某种方式直接从硬盘驱动器流式传输数据，但我也不知道如何做到这一点。

每个位图源都是 895x895 像素，因此在编码后组合图像似乎并不容易，因为 C# 不允许您创建大小为 13425 x 13425 的位图。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T14:39:41.927

这个[PngCs 库](http://code.google.com/p/pngcs/)（免责声明：我是作者）让您可以逐行读取和写入巨大的 PNG 图像，这样您就不需要将完整的图像保存在内存中；也许你觉得它很有用。

# matlab - MATLAB，如何在一行中评估多个索引？

> ID：11182953
> 
> 赞同：0
> 
> 时间：2012-06-25T02:47:44.707
> 
> 标签：matlab

我不知道如何比给你一个例子更好地解释这一点。

假设我有以下数组：

```
a = magic(6) 
```

然后我像这样取一个“切片”：

```
a(:,1) 
```

它将打印：

```
35
 3
31
 8
30
 4 
```

现在我想要第一个数字，所以我想写：

```
a(:,1)(1) 
```

代替：

```
b = a(:,1)
b(1) 
```

此外，有没有办法做这样的事情（分配和比较，即设置 b，然后评估它）：

```
(b = a(:,1))(1) 
```

* * *

好的，这是一个函数的更新，其中使用 a(1, 1) 并非易事

```
come_on = sprintf('%i, ', magic(3));
come_on(1:end-2)
8, 3, 4, 1, 5, 9, 6, 7, 2 
```

另外，如果我只想要 magic(3) 的前 4 个数字怎么办？最好写

```
sprintf('%i, ', magic(3)(1:4))(1:end-2) 
```

而不是几十行，MHO。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T02:54:41.280

您不能将索引连接为`foo(1)(2)(3)`. 但是，您可以一次索引多个维度。所以在这种情况下，`a(1,1)`会给你你想要的。

# javascript - HTML 5 页面的视频播放器未加载

> ID：11182955
> 
> 赞同：-2
> 
> 时间：2012-06-25T02:47:50.617
> 
> 标签：javascript, css, html

我正在使用[VideoJS](http://videojs.com/#setup)作为我一直在从事的项目的视频播放器。基本上我有一个 div，并且我想在该 div 中有视频播放器，但是当我加载页面时没有任何反应，并且视频永远不会播放。事实上，视频从未加载过，也不会显示在页面中。我基本上从 VideoJS 的页面复制了这个例子。有什么想法吗？

```
 <div class="video-js-box">
            <!-- Using the Video for Everybody Embed Code http://camendesign.com/code/video_for_everybody -->
         <div style="position: absolute; top: 50px; left: 600px; display:none">
            <video id="example_video_1" class="video-js vjs-default-skin"  
              controls preload="auto" width="640" height="264"  
              poster="http://video-js.zencoder.com/oceans-clip.png"  
              data-setup='{"example_option":true}'>  
             <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4'></source>
             <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm'>></source>  
             <source src="http://video-js.zencoder.com/oceans-clip.ogv" type='video/ogg'></source>  
            </video>
            <!-- Download links provided for devices that can't play video in the browser. -->
            <p class="vjs-no-video"><strong>Download Video:</strong>
              <a href="http://video-js.zencoder.com/oceans-clip.mp4">MP4</a>,
              <a href="http://video-js.zencoder.com/oceans-clip.webm">WebM</a>,
              <a href="http://video-js.zencoder.com/oceans-clip.ogv">Ogg</a><br>
              <!-- Support VideoJS by keeping this link. -->
              <a href="http://videojs.com">HTML5 Video Player</a> by VideoJS
            </p>
          </div>    
        <div style="clear:both;"></div>
    </div><!--main--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:11:19.707

您已设置 div 显示：无。因此，即使在播放器加载后，它所在的 div 也被隐藏了。更改您的 div`<div style="position: absolute; top: 50px; left: 600px; display:none"> to <div style="position: absolute; top: 50px;">`以正确显示播放器！

工作演示：http: [//jsfiddle.net/epinapala/YsXTu/1/](http://jsfiddle.net/epinapala/YsXTu/1/)

```
<div class="video-js-box">
        <!-- Using the Video for Everybody Embed Code http://camendesign.com/code/video_for_everybody -->
     <div style="position: absolute; top: 50px;">
        <video id="example_video_1" class="video-js vjs-default-skin"  
          controls preload="auto" width="640" height="264"  
          poster="http://video-js.zencoder.com/oceans-clip.png"  
          data-setup='{"example_option":true}'>  
         <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4'></source>
         <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm'>></source>  
         <source src="http://video-js.zencoder.com/oceans-clip.ogv" type='video/ogg'></source>  
        </video>
        <!-- Download links provided for devices that can't play video in the browser. -->
        <p class="vjs-no-video"><strong>Download Video:</strong>
          <a href="http://video-js.zencoder.com/oceans-clip.mp4">MP4</a>,
          <a href="http://video-js.zencoder.com/oceans-clip.webm">WebM</a>,
          <a href="http://video-js.zencoder.com/oceans-clip.ogv">Ogg</a><br>
          <!-- Support VideoJS by keeping this link. -->
          <a href="http://videojs.com">HTML5 Video Player</a> by VideoJS
        </p>
      </div>    
    <div style="clear:both;"></div>
</div><!--main-->​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:29:03.437

I have come across another problem. video.js removes any onload functions in the hosting page. So if you have an onload call in either or window.onload then it won't fire.

# css - 如何在 Wordpress 中编辑 CU3ER 字幕的样式？

> ID：11182957
> 
> 赞同：0
> 
> 时间：2012-06-25T02:48:16.920
> 
> 标签：css, wordpress, stylesheet

我可以知道如何在 wordpress 的 CU3ER 中编辑图像描述的样式吗？我找到了几个地方，但仍然无法编辑，还是可以直接通过物理文件代码进行编辑？

网站链接：http: [//jprivateeyes.com/](http://jprivateyes.com/)

插入图像的方法是为页面添加特征图像 ![在此处输入图像描述](../Images/4d29f829462d63fdb57265b6bd22a97b.png)

这是图像，我想编辑图像文本的样式... ![在此处输入图像描述](../Images/8c2b1d9e7b3fa551aeffba06b6702669.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T13:48:40.990

[您应该使用官方 CU3ER 插件 - wpCU3ER ...您可以在 Wordpress 插件目录或从https://getcu3er.com/account/plugins](https://getcu3er.com/account/plugins)免费获得它

# javascript - 如何使用onclick通过id调用脚本？

> ID：11182958
> 
> 赞同：2
> 
> 时间：2012-06-25T02:48:21.320
> 
> 标签：javascript, html, onclick

可能很明显，但我尝试搜索但无法弄清楚。我正在使用具有脚本的第三方工具。该脚本有一个 id，但脚本中的函数没有名称。我有一个 javascript onclick 函数，我想做的就是通过onClick 函数*的 id调用脚本。*

IE。脚本是

```
<script id="feed" type="text/javascript">(function(){...}())</script> 
```

我需要调用这个脚本

```
$('#searchBox').html("<li onClick=\"$(\"#feed\");\">Click to contact us</li>"); 
```

我试图像上面那样调用'feed'脚本，但没有运气。如果重要，“提要”脚本位于页面正文中，#searchBox 是该页面搜索字段中的自动建议框。将不胜感激任何帮助！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:07:59.570

我会试试这个：

```
$("#searchbox").html("<li onClick=\"eval($(\"#feed\").html())\">Click to contact us</li>") 
```

假设 #feed 中的脚本自行执行，看起来像这样：`(function(){...})()`

但是，如果该函数看起来与您发布的完全一样`(function(...){})`，则应该可以：

```
$("#searchbox").html("<li onClick=\"eval($(\"#feed\").html())()\">Click to contact us</li>") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-25T03:49:54.217

您可以尝试将未命名的函数变成命名函数。通过在头部添加一个新的脚本标签。

```
$('<script></scr' + 'ipt>', {
    html: 'function feedback(){' + $('#feed').html() + ' }',
    type: 'text/javascript'
}).appendTo('head'); 
```

或者更好的是，通过使用[`new Function`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function)：

```
var feedback = new Function($('#feed').html()); 
```

然后在新 DOM 元素的点击处理程序中使用该函数。

```
$('#searchBox').html($('<li></li>',{
    text: 'Click to contact us'
}).click(feedback)); 
```

（我讨厌使用内联 JavaScript。）

# sql - sqlite 在视图中插入新值

> ID：11182959
> 
> 赞同：5
> 
> 时间：2012-06-25T02:48:57.497
> 
> 标签：sql, sqlite, view, triggers

我想确保我以正确的方式做每一件事。

我要分析一个 3Gb 的日志文件。为了在 ":memory:" 中执行所有查询以提高性能，我将每行日志的 10 个文本列替换为整数 id。

```
create table if not exists app (
    id Integer primary key autoincrement,
    value text unique
);

create table if not exists secret (
    id integer primary key autoincrement,
    value text unique
);

and 10 more tables

create table if not exists raw_log
(
    id Integer primary key autoincrement,
    app_id INTEGER,
    secret_id INTEGER,
    and 10 more _id columns
 ); 
```

并创建一个查询视图和一个插入触发器。

```
create view if not exists log as 
    Select 
        raw_log.id,
        app.value as app,

        secret.value as secret,
        and 10 more ...

        from raw_log, app, secret, ..... x 10
        where raw_log.app_id = app_id.id and raw_log.secret = secret.id and ... x 10

CREATE TRIGGER insert_log 
    INSTEAD OF INSERT ON log 
    FOR EACH ROW BEGIN 
INSERT OR IGNORE INTO app(value) VALUES(NEW.app);
INSERT OR IGNORE INTO secret(value) values(NEW.secret);
... x 10

INSERT INTO raw_log(app_id,secret_id, .... x 10)
select app.id, secret.id, x 10
from app, secret, x 10
where app.value = NEW.app 
and secret.value = NEW.secret 
and ... x 10
END; 
```

# 问题：

通过触发器插入看起来不起作用。日志表中的实体数量远少于应有的数量，而秘密和应用程序中的实体数量看起来正确。

我认为这是因为当一个新的应用程序和秘密出现在日志中时。它们可以毫无问题地插入表中。但是，由于这些更改尚未提交，因此以下查询无法成功引用这些值。

如果是这样，我该如何解决这些查询？

```
INSERT INTO raw_log(app_id,secret_id, .... x 10)
        select app.id, secret.id, x 10
            from app, secret, x 10
            where app.value = NEW.app 
                and secret.value = NEW.secret 
                and ... x 10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-02T10:18:43.067

要获得插入的 id 使用 last_insert_rowid()，但如果我不确定你是否在冲突时获得 id，所以你必须使用 ifnull 来获取 id 以插入 raw_log。
您在下一次插入之前保存 last_insert_rowid() 的值，这就是为什么您必须使用变量...

```
CREATE TEMP TABLE IF NOT EXISTS _Variables (Name TEXT PRIMARY KEY, Value TEXT);
...
INSERT OR IGNORE INTO app(value) VALUES(NEW.app);
INSERT OR REPLACE INTO _Variables(Key, Value) VALUES('app_id', ifnull((SELECT app.id from app where app.value = NEW.app), last_insert_rowid());
...
INSERT INTO raw_log(app_id, secret_id, ... x 10)
values((SELECT Value FROM _Variables WHERE Key = 'app_id')
, (SELECT Value FROM _Variables WHERE Key = 'secret_id'), ... x 10 );
END; 
```

# delphi - 不会释放所有内存的 TStringList 和 TThread

> ID：11182963
> 
> 赞同：4
> 
> 时间：2012-06-25T02:49:47.990
> 
> 标签：delphi, memory, ram, tstringlist, tthread

**使用的版本：** Delphi 7。

我正在开发一个在 Virtual ListView 上执行简单*for*循环的程序。数据存储在以下记录中：

```
type TList=record
  Item:Integer;
  SubItem1:String;
  SubItem2:String;
end; 
```

*项目*是索引。*SubItem1*操作的状态（成功与否）。*SubItem2*文件的路径。*for*循环加载每个文件，执行一些操作，然后保存它。操作发生在 TStringList 中。每个文件大约 2mb。

现在，如果我在主窗体上进行操作，它会完美运行。

多线程，存在巨大的内存问题。不知何故， TStringList 似乎没有被完全释放。在 3-4k 个文件之后，我得到一个 EOutofMemory 异常。有时，软件卡在 500-600mb，有时则没有。在任何情况下，TStringList 总是返回一个 EOutofMemory 异常并且不能再加载任何文件。在具有更多内存的计算机上，获取异常需要更长的时间。

其他组件也会发生同样的事情。例如，如果我使用Synapse 的*THTTPSend* ，那么一段时间后，软件无法创建任何新线程，因为内存消耗太高。它大约是 500-600mb，而最大应该是 100mb。在主窗体上，一切正常。

我想错误在我这边。也许我对线程的了解不够。我试图在*Destroy*事件中释放所有东西。我尝试*了 FreeAndNil*程序。我一次只尝试一个线程。我尝试手动释放线程（没有*FreeOnTerminate* ...）

没运气。

所以这里是线程代码。这只是基本的想法；不是所有操作的完整代码。如果我删除*LoadFile* prodecure，一切正常。根据线程池为每个文件创建一个线程。

```
unit OperationsFiles;

interface

uses Classes, SysUtils, Windows;

type
 TOperationFile = class(TThread)
 private
  Position : Integer;
  TPath, StatusMessage: String;
  FileStringList: TStringList;
  procedure UpdateStatus;
  procedure LoadFile;
 protected
  procedure Execute; override;
 public
  constructor Create(Path: String; LNumber: Integer);
 end;

implementation

uses Form1;

procedure TOperationFile.LoadFile;
begin
 try
  FileStringList.LoadFromFile(TPath);
  // Operations...
  StatusMessage := 'Success';
 except
  on E : Exception do StatusMessage := E.ClassName;
 end;
end;

constructor TOperationFile.Create(Path : String; LNumber: Integer);
begin
 inherited Create(False);
 TPath := Path;
 Position := LNumber;
 FreeOnTerminate := True;
end;

procedure TOperationFile.UpdateStatus;
begin
 FileList[Position].SubItem1 := StatusMessage;
 Form1.ListView4.UpdateItems(Position,Position);
end;

procedure TOperationFile.Execute;
begin
 FileStringList:= TStringList.Create;
 LoadFile;

 Synchronize(UpdateStatus);

 FileStringList.Free;
end;

end. 
```

可能是什么问题呢？

我一度认为，可能创建了太多线程。如果用户加载 100 万个文件，那么最终将创建 100 万个线程——尽管只有 50 个线程**同时被创建和运行**。

感谢您的输入。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-25T06:23:33.890

您在问题中显示的代码中（可能）没有泄漏。

我说可能是因为在此期间引发的异常`Execute`可能导致泄漏。字符串列表的生命周期应该由一个`finally`块来保护。

```
FileStringList:= TStringList.Create;
try
  LoadFile;
  Synchronize(UpdateStatus);
finally
  FileStringList.Free;
end; 
```

也就是说，我希望异常吞入`LoadFile`意味着您不会泄漏字符串列表。

您说可能创建了数千个线程。每个线程为其堆栈保留内存，默认堆栈大小为 1MB。一旦您保留了数千个 1MB 堆栈，您就可以轻松耗尽或分割地址空间。

由于过去创建线程的随意性，我已经看到了问题。例如，我有一个程序在创建和销毁线程时失败，存在的线程不超过 256 个。这是在具有 4GB 地址空间的 16 核机器上。您可能有 2GB 的可用地址空间。

尽管您声明任何时候都存在不超过 50 个线程，但我不确定您如何确定这一点。尤其重要的是，因为您已经设置`FreeOnTerminate`并`True`因此放弃了对线程生命周期的控制。

我的猜测是您的问题与您创建的线程数有关。每个处理器一个线程就足够了。重复使用你的线程。为小任务创建和销毁线程的成本很高。

如果这还不足以解决您的问题，那么您将需要展示管理线程生命周期的代码。

最后，我想知道你将从线程化这个应用程序中获得多少好处。如果它是 IO 绑定的，那么线程版本可能会更慢！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T20:48:10.117

根据提供的信息，无法重现您的错误。Remy 和 David 提供的一些提示可能会对您有所帮助。

查看您的程序的结构，流程可以分为两个经典解决方案。

将任务委派给不同线程的第一部分是一个`Single-Producer-Multiple-Consumer`问题。在这里，可以通过创建少量线程，将线程安全的对象队列传递给它们来解决。然后主线程将任务对象推入队列。消费者线程负责单个文件检查任务。

将结果传输到主线程的第二部分是一个`Multiple-Producer-Single-Consumer`问题。如果在初始化时将第二个线程安全对象队列传递给线程，它们可以轻松地将结果放入队列中。在计时器事件中从主线程中排出结果队列。

# objective-c - NSMutableArray 到 NSString 并将 NSString 传递到另一个视图 IOS5.1

> ID：11182966
> 
> 赞同：2
> 
> 时间：2012-06-25T02:50:28.573
> 
> 标签：objective-c, ios, nsstring, nsmutablearray

我有一个 NSMutableArray 的名字。我希望将 NSMutableArray 内的数据（选定名称）作为文本传递给另一个视图的标签。

FriendsController.m:

```
- (void)viewDidLoad {
    [super viewDidLoad];
    arrayOfNames=[[NSMutableArray alloc] init];
    arrayOfIDs=[[NSMutableArray alloc] init];
    userName=[[NSString alloc] init];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    long long fbid = [[arrayOfIDs objectAtIndex:indexPath.row]longLongValue];
    NSString *user=[NSString stringWithFormat:@"%llu/picture",fbid];
    [facebook requestWithGraphPath:user andDelegate:self];

    userName=[NSString stringWithFormat:@"%@",[arrayOfNames objectAtIndex:indexPath.row]];
    FriendDetail *profileDetailName = [[FriendDetail alloc] initWithNibName: @"FriendDetail" bundle: nil];

    profileDetailName.nameString=userName;

    [profileDetailName release];
}

- (void)request:(FBRequest *)request didLoad:(id)result  {
    if ([result isKindOfClass:[NSData class]]) {
        transferImage = [[UIImage alloc] initWithData: result];
        FriendDetail *profileDetailPicture = [[FriendDetail alloc] initWithNibName: @"FriendDetail" bundle: nil];

        [profileDetailPicture view];
        profileDetailPicture.profileImage.image= transferImage;

        profileDetailPicture.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
        [self presentModalViewController:profileDetailPicture animated:YES];

        [profileDetailPicture release];
    }   
} 
```

在 FriendDetail.h 中

```
NSString nameString;
IBOutlet UILabel *profileName;
@property (nonatomic, retain) UILabel *profileName;
@property (nonatomic, retain) NSString *nameString; 
```

在 FriendDetail.m 中

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    profileName.text=nameString;
} 
```

`nameString`在第二个控制器（FriendDetail）返回`nil`。当我在 firstcontroller 中设置断点时，我看到里面的字符串`nameString`是正确的，但之后它会以`nil`某种方式返回。

- - - - - - - - - - - -编辑 - - - - - - - - - - - - - --------------

根据答案，我已经稍微改进了我的代码 FriendsController.h

```
 FriendDetail *friendController;
@property (strong, nonatomic) FriendDetail *friendController; 
```

FriendsController.m

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    arrayOfNames=[[NSMutableArray alloc] init];
    arrayOfIDs=[[NSMutableArray alloc] init];
    arrayOfThumbnails=[[NSMutableArray alloc] init];
    userName=[[NSString alloc] init];

    friendController= [[FriendDetail alloc] initWithNibName: @"FriendDetail" bundle: nil];
}

-(void)request:(FBRequest *)request didLoad:(id)result{
    if ([result isKindOfClass:[NSData class]])
    {
        transferImage = [[UIImage alloc] initWithData: result];
        friendController.nameString=userName;

        [friendController view];
        friendController.profileImage.image= transferImage;

       friendController.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
        [self presentModalViewController:friendController animated:YES];
    }
   //this is how i take facebook friends list
         if ([result isKindOfClass:[NSDictionary class]]){
             items = [[(NSDictionary *)result objectForKey:@"data"]retain];
             for (int i=0; i<[items count]; i++) {
            NSDictionary *friend = [items objectAtIndex:i];
            long long fbid = [[friend objectForKey:@"id"]longLongValue];
            NSString *name = [friend objectForKey:@"name"];
            NSLog(@"id: %lld - Name: %@", fbid, name);
            [arrayOfNames addObject:[NSString stringWithFormat:@"%@", name]];
            [arrayOfIDs addObject:[NSNumber numberWithLongLong:fbid]];

        }
    }
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    long long fbid = [[arrayOfIDs objectAtIndex:indexPath.row]longLongValue];
    NSString *user=[NSString stringWithFormat:@"%llu/picture",fbid];

    userName=[NSString stringWithFormat:@"%@",[arrayOfNames objectAtIndex:indexPath.row]];

    [facebook requestWithGraphPath:user andDelegate:self]; 
    [username retain]
} 
```

现在，当我第一次选择行时，它会发送名称。当我回到 tableview 并选择另一个名称时，它会显示旧名称。

如果我删除 它仍然发送`[username retain]`到`didSelectRowAtIndexPath:``nil``nameString`

`didSelectRowAtIndexPath:`当我在 ` 行设置断点时

```
userName=[NSString stringWithFormat:@"%@",[arrayOfNames objectAtIndex:indexPath.row]]` 
```

我可以看到`userName = @"Adam Dart"`哪个是正确的

在我的第二个断点中，`friendController.nameString=userName;`我看到`nameString =nil`了`userName = Variable is not CFString`

ARC 设置为 NO

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:22:13.390

该值为 nil 因为您没有在`request:didLoad:`函数中传递该值。

在 function`didSelectRowAtIndexPath`中，您创建了另一个 ViewController 的本地实例并设置了 nameString 的值，但您没有呈现视图并立即释放 ViewController。你实际上在这几行代码中什么都不做：

```
FriendDetail *profileDetailName = [[FriendDetail alloc] initWithNibName: @"FriendDetail" bundle: nil];
profileDetailName.nameString = userName;
[profileDetailName release]; 
```

在 function`request:didLoad:`中，您再次使用图像创建另一个 ViewController 的本地实例。但是这个实例只是这个函数的本地实例，这意味着与创建的那个没有关系`didSelectRowAtIndexPath`。

您需要做的是，首先记住单击行的名称`didSelectRowAtIndexPath`，这里您不必创建 ViewController 实例。请求完成后，将图像和名称都设置给控制器，然后呈现。但是您应该避免用户同时单击不同的行，因为您不知道请求何时完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T03:17:28.723

You have two instances of FriendDetail called profileDetailPicture. Both of theses profileDetailPicture are not the same. So in your didSelectRowAtIndexPath method, the value that you assigned to the nameString will not be visible/available to the nameString of the profileDetailPicture In the request:(FBRequest *)request didLoad method.

Edit for solution:

1.  Create an iVar or property (profileDetailPicture) in the FriendController.
2.  Only do one allocation in the request:(...) method.
3.  Remove the allocation statement in the didSelectRowAtIndexPath.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T02:59:46.873

任何机会与您分配`profileDetailName`然后立即释放它的事实有关吗？

```
profileDetailName.nameString=userName;
[profileDetailName release]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T03:01:30.060

您必须在“second_controller”中分配“first_controller”来传递字符串等对象。你会以不同的方式调用 nameString 。

例子：

**second_controller.h**

```
#import "first_controller.h"
...
@interface second_controller : UIViewController{
   first_controller* firstController;
} 
```

**second_controller.m**

```
- (void)viewDidLoad {
    [super viewDidLoad];
    firstController = [[first_controller alloc] init];
    profileName.text = firstController.nameString;
} 
```

您必须正确初始化它，因为它的两个视图共享信息。

# javascript - 使用 Html5 文件 api 确定未知的内容类型

> ID：11182968
> 
> 赞同：12
> 
> 时间：2012-06-25T02:50:57.787
> 
> 标签：javascript, html, file-upload

我正在处理一个小文件上传脚本（学习经验），我注意到在选择 microsoft office 相关文件（`.doc`或`.docx`例如）时，文件对象没有指定类型：

![文件列表](../Images/c8b1f7c19738fc49469dffb94bc09306.png)

对于 .doc 文件，我曾期望该类型是`"application/msword"`.docx 并且遵循相同的思路`"application/vnd.openxmlformats-officedocument.wordprocessingml.document"`。

在无法确定类型的情况下，查看文件扩展名并将其与“预期”内容/mime 类型匹配的正确做法是什么？

示例脚本：

```
<div id="fileUpload">
    <input type="file" id="fileElem" style="display:none;" onchange="handleFiles(this.files)"/>
    <a href="#" id="fileSelect">Select some files</a>
</div>

<script type="text/javascript">
    var fileSelect = document.getElementById("fileSelect"),
        fileElem = document.getElementById("fileElem");

    fileSelect.addEventListener("click", function (e) {

        if (fileElem) {
            fileElem.click();
        }

        e.preventDefault();
    }, false);

    function handleFiles(files) {
        console.log(files);
    }

</script> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-25T03:10:46.403

根据 W3 File Api Draft 类型属性：

> 小写的 ASCII 编码字符串，表示 Blob 的媒体类型，表示为 RFC2046 MIME 类型 [RFC2046]。在获取时，符合标准的用户代理应该返回 Blob 的 MIME 类型，如果它是已知的。如果符合标准的用户代理无法确定 Blob 的媒体类型，它们必须返回空字符串。如果字符串与 RFC 2616 的第 3.7 节“媒体类型”中定义的媒体类型令牌匹配，则该字符串是有效的 MIME 类型

所以基本上，如果它不是 HTTP/1.1 的有效或媒体类型，它将是空的。无论如何。

是的，你应该这样做：

```
if(type === "") {
  //Get extension and match to a MIME-types list. (http://www.htmlquick.com/es/reference/mime-types.html)
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-12-11T06:01:58.547

同意接受的答案，但作为对某人（如我）的仅供参考，他们对为什么某些特定文件类型会发生这种情况而不是其他特定文件类型会发生这种情况，请注意，在 Windows 中，如果未正确设置 mime用户注册表，您将得到空字符串。那是一个有趣的几个小时:)

# ruby-on-rails - 负载测试期间独角兽 CPU 使用率飙升，优化方法

> ID：11182975
> 
> 赞同：6
> 
> 时间：2012-06-25T02:52:12.120
> 
> 标签：ruby-on-rails, ruby, optimization, load, unicorn

我对优化我的 Ruby on Rails 3.1.3 应用程序的 Unicorn 设置的方法很感兴趣。我目前在 High-CPU Extra Large Instance 上生成 14 个工作进程，因为我的应用程序在负载测试期间似乎受 CPU 限制。在模拟负载测试中，每秒大约有 20 个请求重播请求，我的实例上的所有 8 个内核都达到峰值，并且盒子负载峰​​值高达 7-8。每个独角兽实例使用大约 56-60% 的 CPU。

我很好奇有什么方法可以优化这个？我希望能够每秒将更多请求集中到这种大小的实例上。内存和所有其他 I/O 一样完全正常。在我的测试过程中，CPU 正在下降。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T07:39:18.943

如果您受 CPU 限制，您希望使用的独角兽进程不超过您拥有的内核数，否则您会超载系统并减慢调度程序。您可以使用 ab 在开发盒上进行测试。您会注意到 2 个独角兽将优于 20 个（数量取决于核心，但这个概念将成立）。

此规则的例外是您的 IO 绑定。在这种情况下，尽可能多地添加内存可以容纳的独角兽。

一个好的性能技巧是将 IO 绑定请求路由到托管许多独角兽的不同应用服务器。例如，如果您有一个使用慢速 sql 查询的请求，或者您正在等待外部请求，例如信用卡交易。如果使用 nginx，为 IO 绑定请求定义一个上游服务器，将这些 url 转发到一个有 40 个独角兽的盒子。CPU 限制或非常快的请求，转发到一个有 8 个独角兽的盒子（你说你有 8 个内核，但在 aws 上你可能想尝试 4-6 个，因为他们的调度程序是超监控的并且已经很忙）。

另外，我不确定您是否可以依靠 aws 为您提供可靠的 CPU 使用率，因为您获得的百分比是一个模糊百分比。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T03:21:57.680

First off, you probably don't want instances at 45-60% cpu. In that case, if you get a traffic spike, all of your instances will choke.

Next, 14 Unicorn instances seems large. Unicorn does not use threading. Rather, each process runs with a single thread. Unicorn's master process will only `select` a thread if it is able to handle it. Because of this, the number of cores isn't a metric you should use to measure performance with Unicorn.

A more conservative setup may use 4 or so Unicorn processes per instance, responding to maybe 5-8 requests per second. Then, adjust the number of instances until your CPU use is around 35%. This will ensure stability under the stressful '20 requests per second scenario.'

Lastly, you can get more gritty stats and details by using [`God`](http://godrb.com/).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T01:48:01.517

对于高 CPU 超大实例，每秒 20 个请求是*非常*低的。很可能是代码有问题。独角兽特有的问题似乎不太可能。如果您有疑问，您可以尝试不同的应用服务器并确认它仍然会发生。

在这种情况下，我会考虑的问题......

1 - 你是否在代码中做一些 CPU 密集型的事情——也许真的应该在数据库中。例如，如果您要带回一个大型记录集并在 ruby​​/rails 中循环遍历它以对其进行排序或执行一些其他操作，这将解释此级别的 CPU 瓶颈，而不是数据库中的瓶颈。在这种情况下，建议是修改查询以做更多事情并减轻负担。例如，如果您在控制器中对结果集进行排序，而不是通过 sql，则会导致这样的问题。

2 - 与 vanilla crud 应用程序相比，您是否在做任何不寻常的事情，例如访问共享资源，或者任何可能成为争用问题的事情？

3 - 您是否有任何可能烧毁 CPU 的循环，尤其是在争用资源的情况下？

4 - 尝试解开有问题的控制器逻辑的各个部分。例如，如果你修改你的代码只返回一个静态的 hello world 响应，它的扩展性如何？我敢打赌，独角兽会突然变得异常快。然后尝试重新添加部分代码，直到发现缓慢的根源。

# validation - XHTML 1.0 严格验证错误

> ID：11182976
> 
> 赞同：0
> 
> 时间：2012-06-25T02:52:17.290
> 
> 标签：validation, xhtml

在下面验证我的 XHTML 严格输入类型时出现 2 个错误：

```
<form action="" method="post" id="frm">
   <input type="text" id="searchtext" name="search" value="Suchen" />
   <input type="image" id="searchbutton" name="search" src="images/search-icon.png" />
</form> 
```

错误是： ![在此处输入图像描述](../Images/1fbbd26701b4478b6b526e930dfa8d6f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T02:54:36.333

如果您尝试将输入直接放入没有容器元素的表单中，并在 XHTML 1.0 strict 下进行验证，就会发生这种情况。把它放到一个div中，它就消失了。

参考：[解释](https://stackoverflow.com/questions/5865963/w3c-validator-gives-document-type-does-not-allow-element-input-here-error)

[为什么会发生](https://stackoverflow.com/questions/2982590/strict-doctype-form-and-input-element)

# matlab - MATLAB，多重相等“快捷方式”

> ID：11182979
> 
> 赞同：0
> 
> 时间：2012-06-25T02:52:58.477
> 
> 标签：matlab

我有以下数组：

```
a = magic(12);
a = a(:,1); 
```

这是这十二个数字的列表：

```
144
 13
 25
108
 96
 61
 73
 60
 48
109
121
 12 
```

现在，如果我想“过滤掉”25、61 和 109 的值，我可以这样写：

```
m = (a == 25) | (a == 61) | (a == 109) 
```

但是，有没有更容易写的方法？就像是：

```
m = a IN(25, 61, 109) 
```

最好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:10:09.897

```
m = ismember(a, [25 61 109]); 
```

[ismember](http://www.mathworks.com/help/techdoc/ref/ismember.html)的文档在这里。

# node.js - 在 socket.io 中使用代理时未获取远程地址

> ID：11182980
> 
> 赞同：12
> 
> 时间：2012-06-25T02:53:07.130
> 
> 标签：node.js, proxy, socket.io

在我的 socket.io 代码中，

```
socket.sockets.on('connection', function(client){ 
    var ip = client.handshake.address.address;
    ..
} 
```

ip 总是返回 127.0.0.1，这是因为服务器位于代理后面。如何正确获取远程地址？

编辑：我正在使用 http-proxy

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-25T09:54:44.957

是的，这对我有用。

```
client.handshake.headers['x-forwarded-for'] || client.handshake.address.address; 
```

我正确获取远程 IP 地址而不是 127.0.0.1

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-05-22T04:41:27.887

在 > 1.0 版本中，语法类似：

```
socket.handshake.headers['x-forwarded-for'] || socket.request.connection.remoteAddress; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-30T18:59:29.853

对于可能来自 Google，使用 NGINX 的人：这些都不适合我，我按照[另一个问题中](https://stackoverflow.com/a/37474244/7163811)的答案并修改了我的`proxy_pass`, 以创建一个节点可以使用的新标头。之后别忘了打电话`sudo systemctl restart nginx`。

# scala - PlayFramework 2.0 Json 到 List[String] 的转换

> ID：11182986
> 
> 赞同：0
> 
> 时间：2012-06-25T02:54:32.940
> 
> 标签：scala, playframework, playframework-2.0

将 json 转换为其他类型应该很容易。从戏剧！[文档](http://www.playframework.org/documentation/api/2.0.1/scala/index.html#play.api.libs.json.Json%24)：

```
var str = "{\"next_cursor\":0,\"ids\":[123123,345345],\"previous_cursor\":0}"
var fol = Json.parse(str)
var fin = Json.fromJson[List[String]].fromJson(fol) 
```

应该可以正常工作。它编译得很好，但因以下错误而失败：

```
[RuntimeException: List expected] 
```

相反，这有效：

```
var str = "{\"next_cursor\":0,\"ids\":[123123,345345],\"previous_cursor\":0}"
var fol = Json.parse(str)
var fin = (fol \ "ids") match {
    case ids: JsArray => ids.value.map(_.toString)
    case _ => JsArray()
} 
```

为什么？我是否理解 API 有问题？我正在 PlayFramework 2.0.1 中尝试这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T07:01:13.863

您不能`List[String]`直接将其解析为 a，因为它是数字列表，而不是字符串。您的匹配示例有效，因为您之后将 id 映射到字符串。使用你的例子，你会写得更像：

```
val str = "{\"next_cursor\":0,\"ids\":[123123,345345],\"previous_cursor\":0}"
val fol = Json.parse(str)
val fin = Json.fromJson[List[Int]](fol \ "ids") 
```

为了使语法更易于阅读，我将使用`JsValue.as[T]`，它相当于`Json.fromJson[T]`：

```
val fin = (fol \ "ids").as[List[Int]] 
```

如果您需要将 ID 转换为字符串：

```
val fin = (fol \ "ids").as[List[Int]].map(_.toString) 
```

# node.js - 有没有办法使用express nodejs打开一个新窗口

> ID：11182988
> 
> 赞同：5
> 
> 时间：2012-06-25T02:54:36.323
> 
> 标签：node.js

我正在使用`express`.
我知道有 `res.send`， `res.render`和`res.redirect`方法。

但是有没有办法打开一个新窗口？

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-11-23T11:44:31.437

ExpressJS 是 NodeJS 的网络框架

以下函数用于提供对传入请求的响应

```
res.send(), res.render()  res.redirect(), res.json(), res.download() 
```

在浏览器中打开一个新窗口不是 expressJS 的一部分

你需要为像[Puppeteer这样的](https://www.npmjs.com/package/puppeteer)**无头浏览器使用不同的 npm**

示例代码：

```
const puppeteer = require('puppeteer');

(async () => {
  const browser = await puppeteer.launch({headless: false});
  const page = await browser.newPage();
  await page.goto('https://google.com');

  await browser.close();
})(); 
```

注意：`headless: false`将显示您在浏览器中打开的选项卡，

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-06-25T03:23:00.683

这需要在客户端通过

```
window.open("link", "_blank") 
```

# email - 为什么发送电子邮件需要多个邮件服务器跃点？

> ID：11182990
> 
> 赞同：7
> 
> 时间：2012-06-25T02:54:37.360
> 
> 标签：email, networking, xmpp, network-protocols

当我向某人发送电子邮件时，（我认为）我的电子邮件被发送到我的家庭服务器，然后电子邮件被发送到目标服务器，然后最终发送给我想发送给的人。

有时，这需要多跳，这让我感到困惑。为什么这需要多个跃点？为什么邮件不能直接发送到目标服务器？例如，XMPP 不需要多跳。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-05-22T20:07:33.453

典型的电子邮件交易使用出站邮件服务器，该服务器查找收件人的传入服务器，将其发送到那里，然后该服务器将其交给收件人的邮箱服务器。那是3跳：

![SMTP→IMAP 邮件流](../Images/048f1ffc1eee5a818e24d7792d85b6d2.png)

当您发送消息时，您从您的电子邮件客户端（更准确地说：邮件用户代理，MUA）连接到您的出站[SMTP](https://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol)服务器。这是第一个跃点，您的 SMTP 服务器会创建一个`Received`标头来表示它，以便稍后进行审核。这将包括它看到您连接的 IP、该特定服务器内部的消息 ID，有时还包括一些其他信息。

然后，您的出站 SMTP 服务器在 DNS 中查找每个收件人的域的 MX（邮件交换）记录，并连接到它可以为他们找到的最高优先级中继（数字上最低的 MX 优先级）。这是第二跳。与任何跃点一样，`Received`会添加一个标头。

MX 中继通常进行反垃圾邮件过滤，可能会在 SMTP 连接期间拒绝邮件。这就是生成退回邮件的原因，您的出站 SMTP 服务器会直接向您发送该邮件（如果它是通过 Internet 发送的，则可能会被[反向散射](https://en.wikipedia.org/wiki/Backscatter_(email))，一种垃圾邮件形式，因为无法证明退回邮件是合法的）。通常，反垃圾邮件过滤会在稍后完成，邮件会被静默丢弃或使用标记传递。

然后，MX 中继在内部将消息传递到您的邮箱 (IMAP/Exchange) 服务器（跃点 #3）。有时，本地邮箱服务器过滤器用于处理模式（或来自 MX 服务器的标记）并促进各种操作，例如将可疑垃圾邮件归档到您的垃圾文件夹中。

如果您使用邮件转发服务，则 MX 中继会将您的邮件传递给转发目标（另一个 MX 中继）。这理论上可以持续很长时间甚至无限循环，但它最终应该在邮箱服务器中结束。

另请参阅正式的 SMTP 规范[RFC 5321](https://www.rfc-editor.org/rfc/rfc5321)。

如果您使用 webmail，则 web 邮件服务器就是您的电子邮件客户端。一些 web 邮件服务器添加类似于`Received`header 的 header 来跟踪连接，因此垃圾邮件过滤器可以将其信誉检查扩展到用户而不是 webmail 系统，这可能被描述为另一个跃点。

在企业级环境中，多层服务器通常用于各种目的。这些额外的跃点发生在 MX 中继和邮箱服务器之间，可能与额外的反垃圾邮件或反病毒处理、高级邮件别名、电子邮件归档、校园之间的内部邮件路由或任何其他事情有关。例如，这些可以简化从一个邮件系统到另一个邮件系统的转换（例如在 Exchange 版本之间迁移，这可能需要大量测试和缓慢迁移，因此问题不会影响整个公司）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-25T02:58:14.640

从根本上说，这与 Internet 的最初目的有关，或者更确切地说，它的前身[ARPANET](http://en.wikipedia.org/wiki/ARPANET)旨在在网络部分丢失的情况下幸存下来（流行的普遍误解，这个设计目标的存在不是为了在核攻击中幸存下来，而是因为当时的网络组件相当不可靠）。

数据包交换网络旨在找到一条或多条从数据包开始（您的电子邮件客户端）到它需要到达的位置（您要发送到的人的电子邮件客户端）的路由。

为了实现这种灵活性，系统不仅设计为直接从 A 点路由到 B 点，还设计了一条当前正在运行的可用路线（从可能非常大的一组可能路线中）。

如果您的电子邮件客户端必须知道如何直接发送到世界上的所有其他设备，而无需干预子网管理流量，那么您的计算机将需要直接连接到世界上的所有其他计算机。那将是非常昂贵的。相反，中间的路由器接受来自您和您所在地区其他人的数据包，并找出如何将每个数据包路由到更接近其目的地的位置。这类似于航空公司使用区域航班为枢纽提供服务的方法。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-06-25T02:58:05.480

当一个数据包通过互联网路由时，它会进行多次跳跃从源到目的地。

# eclipse - 无法在 Eclipse 中检查 scala 代码中的变量

> ID：11182992
> 
> 赞同：6
> 
> 时间：2012-06-25T02:55:19.840
> 
> 标签：eclipse, scala, scala-ide

当我在 Eclipse 中调试 Scala 应用程序时，我在启动时收到一个包含以下消息的对话框：由于缺少行号工件，无法在 Main 中设置断点。

当我尝试检查变量时，我在表达式窗口中收到此错误：“ [in Main [in [Working copy] Main.scala [in [in src [in Scala1]]]]] 不存在”

我尝试为 Scala 编译器设置各种调试级别设置，包括“line”和最高设置，但似乎没有任何区别。在弄乱设置后，我能够看到一次内容，但无法再次这样做，所以我想知道是否存在与某处缓存状态错误有关的错误。

我正在使用带有 Scala 插件版本 2.0.0v2_09 的 Eclipse 的 Indigo 服务版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-03T09:47:43.253

您应该**升级**到新版本的 Scala IDE！

（严格）在 3.0.0 之前，调试器是*Java*调试器，没有特别的 Scala 支持。但是 ScalaIDE 3.0.0 附带了一个 Scala 调试器，它应该可以缓解您提到的问题，特别是定位良好的断点。您可以阅读[描述调试器的 3.0.0 发行说明](http://scala-ide.org/blog/3.0-final-announcement.html)。

您甚至应该尝试[发布候选版本 3.0.1，](http://scala-ide.org/download/milestone.html)它包含对调试器的修复，特别是跳过断点。试一试，如果仍有任何问题，您可以[在邮件列表](https://groups.google.com/forum/#!forum/scala-ide-user)中与 IDE 团队联系，或[提出问题](https://www.assembla.com/spaces/scala-ide/tickets)，或提出另一个 SO 问题！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T19:10:51.003

您可以从以下 URL 下载预安装了 Scala Worksheet 的 Scala IDE for eclipse：

[在此处输入链接描述](http://typesafe.com/stack/scala_ide_download) //URL 来自 coursera 的 scala 课程

使用 Scala 工作表，您可以在编写代码的同时创建工作表并查看变量

# php - 当用户对表的输入可以任意组合时，如何构建 SQL 语句？

> ID：11182996
> 
> 赞同：0
> 
> 时间：2012-06-25T02:55:38.720
> 
> 标签：php, mysql, database

示例：用户填写除产品名称以外的所有内容。

我需要搜索提供的内容，所以在这种情况下，除了`productName=`

此示例可以用于任何输入组合。

有没有办法做到这一点？

谢谢。

```
 $name = $_POST['n'];
    $cat = $_POST['c'];
    $price = $_POST['p'];

if( !($name) )
{
    $name = some character to select all?
}

$sql = "SELECT * FROM products WHERE productCategory='$cat' and   
productName='$name' and productPrice='$price' "; 
```

**EDIT**
解决方案不必保护免受攻击。具体来看它的动态部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T03:06:32.190

就像是

```
$where_array = array();

if( isset($_POST['n']) )$where_array[] = "productName = '{$_POST['n']}'";
if( isset($_POST['c']) )$where_array[] = "productCategory '{$_POST['c']}'";
if( isset($_POST['p']) )$where_array[] = "productPrice = '{$_POST['p']}'";

    $where_stmt = implode( ' and ', $where_array  );
    if( $where_stmt )  
    {
    $sql = "SELECT * FROM products WHERE $where_stmt ";
//run query
    } 
```

# java - 在 libgdx 中，如何向 box2d Body 对象添加摩擦力？

> ID：11182997
> 
> 赞同：2
> 
> 时间：2012-06-25T02:55:58.430
> 
> 标签：java, box2d, libgdx

我对 libgdx 非常满意，喜欢使用它。但是，我是 box2d 的新手，所以我希望比我更聪明的人能帮助我。

我有一个简单的测试屏幕，其中一堆静态方形瓷砖组成一个地板，一个动态的身体（一个圆圈）四处弹跳。

我想做的是增加地板的摩擦力，这样球就不会滚动太多。就像地板是草而不是木头。

我在网上找到了一些东西，但似乎都没有。我尝试过的最有希望的事情是：

```
tileBody.getFixtureList().get(0).setFriction(0.9f); 
```

但它似乎什么也没做。

阅读 box2d 文档表明，当我最初定义对象时，我应该在夹具 def 上设置摩擦：

```
FixtureDef fdef = new FixtureDef();
fdef.shape = wallshape;
fdef.density = 1.0f;
fdef.friction = 0.9f; 
```

然而，这似乎也不能阻止球滚动。

有没有更好的方法来做到这一点？我可以减少恢复原状，但这只会阻止它反弹，对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-03T01:38:03.453

```
 Body groundBody = world.createBody(groundBodyDef);  
    PolygonShape groundshape = new PolygonShape();  
    groundshape.setAsBox(30, 1.0f);   
    FixtureDef groundFixture = new FixtureDef();
    groundFixture.density=0.0f;
    groundFixture.shape = groundshape;
    groundFixture.restitution = .5f;
    groundFixture.friction=0f;
    groundBody.createFixture(groundFixture);
    groundshape.dispose(); 
```

这对我有用。如果沿着地面移动的物体有摩擦并且不是由暗物质构成的，它们应该会减速。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T05:29:39.377

这听起来更像是您想根据当前接触的内容来更改圆体的角阻尼。角阻尼会抑制物体的旋转，但不会对直线运动产生任何影响。您可以通过执行 body->SetAngularDamping( aHighValueLikeSay2to5 ) 并查看您获得的效果来检查这是否是您想要的。

如果看起来不错，那么您需要跟踪圆圈何时接触应该改变角阻尼的东西。您可以通过使用联系侦听器来执行此操作，它会为您提供 BeginContact 和 EndContact 通知。当您收到 BeginContact 事件时，如果您的圆圈与应该影响滚动的事物之间发生接触，则将计数器加一。在 EndContact 中执行相同的检查并减少计数器。这将为您提供一个值，您可以随时检查以确定是否应更改角阻尼。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T18:31:19.743

我在 cocos2d 论坛上找到了一个答案。

[http://www.cocos2d-iphone.org/forum/topic/17762](http://www.cocos2d-iphone.org/forum/topic/17762)

似乎圆形不受 box2d 中摩擦的影响。

因此，要正确地将摩擦力应用于圆，您最好用多边形近似圆。

# perl - 将 2 行合并为 1

> ID：11182998
> 
> 赞同：5
> 
> 时间：2012-06-25T02:56:01.833
> 
> 标签：perl, sed, awk, grep

我有一个以 9 位大学代码开头并以 5 位课程代码结尾的文本文件。

```
512161000 EN5121 K. K. Jorge Institute of Engineering Education and Research, Nashik 61220 Mechanical Engineering [Second Shift] XOPENH 1 116 16978
517261123 EN5172 R. C. Rustom Institute of Technology, Shirpur 61220 Mechanical Engineering [Second Shift] YOPENH 1 100 29555
617561234 EN6175 abc xyz Education Trust, abc xyz College of Engineering,
Pune 61220 Mechanical Engineering [Second Shift] ZOPENH 2 105 25017 
```

如上面的 3 示例所示，有一些条目有换行符。我需要将第 3 行和第 4 行合并为一个，就像第 1 行和第 2 行一样，以便我可以轻松地使用 grep、awk 等命令。

更新：

凯文的回答似乎不起作用。

```
cat todel.txt
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,
Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531

cat todel.txt | perl -ne 'chomp; if (/^\d{9}/) { print "\n$_" } else { print "$_\n" }' 
Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531ege of, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T03:12:20.660

假设您的数据在“file.txt”中，这是一个扫描，可以将这些行重新组合在一起：

```
cat file.txt | perl -ne 'chomp; if (/^\d{9}/) { print "\n$_" } else { print "$_\n" }' 
```

这假定所有有效记录都以 9 位数字开头。“chomp”最初会删除换行符，并且模式决定换行符应该出现在输出中的哪个位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T03:39:48.850

关于分割线：此`sed`脚本假设您在前导数字后至少有一个空格（在分割的第一行），在尾随数字之前有一个空格（在分割的最后一行），并且只有每个分割线一个分割。

修改为接受带有 Windows CRLF 换行符**或***nix LF 的输入。但请注意，输出是 *nix `\n`

```
sed -nr 's/\r?$// # allow for '\r\n' newlines
         /^([0-9]{9}) .* ([0-9]{5})$/{p;b}
         /^([0-9]{9}) /{h;b}
         / ([0-9]{5})$/{x;G; s/\n//; p}' 
```

或者，更短，但可能不太可读：

```
sed -nr 's/\r?$//; /^([0-9]{9}) /{/ ([0-9]{5})$/{p;b};h;b};/ ([0-9]{5})$/{x;G; s/\n//; p}' 
```

我确实希望第一个更快，因为最频繁的测试（对于整行）只涉及一个正则表达式，而第二个（较短的）脚本需要两个正则表达式测试来进行最频繁的测试。

这是我得到的输出；使用`GNU sed 4.2.1`

```
512161000 EN5121 K. K. Jorge Institute of Engineering Education and Research, Nashik 61220 Mechanical Engineering [Second Shift] XOPENH 1 116 16978
517261123 EN5172 R. C. Rustom Institute of Technology, Shirpur 61220 Mechanical Engineering [Second Shift] YOPENH 1 100 29555
617561234 EN6175 abc xyz Education Trust, abc xyz College of Engineering,Pune 61220 enter code hereMechanical Engineering [Second Shift] ZOPENH 2 105 25017
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-25T03:54:32.717

这可能对您有用：

```
sed ':a;$!N;/ [0-9]\{5\}\n[0-9]\{9\} /!s/\n//;ta;P;D' file 
```

解释：

*   如果该行没有以空格结尾，后跟五位数字，然后是九位数字，然后是空格，请删除换行符。

编辑：

测试数据：

```
cat <<\! >/tmp/codel.txt
> 112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,
> Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531
> !
sed ':a;$!N;/\s[0-9]\{5\}\n[0-9]\{9\}\s/!s/\n//;ta;P;D' /tmp/codel.txt 
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531
sed ':a;$!N;/\s[0-9]\{5\}\n[0-9]\{9\}\s/!s/\n//;ta;P;D' /tmp/{codel.txt,codel.txt,codel.txt} 
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T03:01:49.780

也许尝试删除逗号后出现的所有换行符，如下所示：

```
perl -i -pe 's/,\n/,/g' file.txt 
```

也许您想在逗号后留出空格：

```
perl -i -pe 's/(,\s*)\n/$1/g' file.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-25T04:26:56.643

试试这个

```
sed '/^[0-9]\{9\}/{h;};/^[0-9]\{9\}/!{x;G;s/\n//g;}' test | grep -E '[0-9]{5}$' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-25T04:55:22.693

```
awk '! ($1 ~ /^[[:digit:]]/) {$0 = save " " $0} $1 ~ /^[[:digit:]]/ {save = $0} $NF ~ /[[:digit:]]$/ {print}' inputfile 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-25T05:18:45.843

```
cat todel.txt |awk 'BEGIN {i=0} {first[i]=$1; lines[i++] = $0;} END {for (x=0; x<i; x++) { if ( x==(i - 1) || (first[x + 1] ~ /^[0-9]+$/ && length(first[x + 1])==9) ) {printf("%s: %s\n", x, lines[x]);} else {printf("%s: %s%s\n", x, lines[x], lines[x + 1]); x++;} } }' 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-25T05:37:47.887

通过假设有效记录以五位数字结尾，这适用于包含的数据集：

```
use Modern::Perl;

my $data = do{local $/; <DATA>};
$data =~ s/([^\d]{5})\n/$1 /sg;
say $data;

__DATA__
512161000 EN5121 K. K. Jorge Institute of Engineering Education and Research, Nashik 61220 Mechanical Engineering [Second Shift] XOPENH 1 116 16978
517261123 EN5172 R. C. Rustom Institute of Technology, Shirpur 61220 Mechanical Engineering [Second Shift] YOPENH 1 100 29555
617561234 EN6175 abc xyz Education Trust, abc xyz College of Engineering,
Pune 61220 Mechanical Engineering [Second Shift] ZOPENH 2 105 25017
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of,
Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 93531 
```

输出：

```
512161000 EN5121 K. K. Jorge Institute of Engineering Education and Research, Nashik 61220 Mechanical Engineering [Second Shift] XOPENH 1 116 16978
517261123 EN5172 R. C. Rustom Institute of Technology, Shirpur 61220 Mechanical Engineering [Second Shift] YOPENH 1 100 29555
617561234 EN6175 abc xyz Education Trust, abc xyz College of Engineering, Pune 61220 Mechanical Engineering [Second Shift] ZOPENH 2 105 25017
112724510 EN1127 Jagadambha Bahuuddeshiya Gramin Vikas Sanstha's Jagdambha College of, Engineering and Technology, Yavatmal 24510 Computer Engineering LSCO 1 55 935315 
```