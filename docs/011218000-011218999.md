# StackOverflow 问答 11218000-11218999

# asp.net-mvc - 将 ServiceStack 的 AuthService 与 Controller 和 AuthorizeAttribute 一起使用

> ID：11218004
> 
> 赞同：2
> 
> 时间：2012-06-27T01:02:24.980
> 
> 标签：asp.net-mvc, authentication, servicestack

没有像经典 ASP.NET MVC 那样简单的 ServiceStack 示例。AppHarbor 和 SocialBootStrap api 都基于 SinglePage 应用程序。如何使用 Servicestack 的身份验证实现经典的 Asp.net MVC 应用程序。

我已将 AuthService 属性添加到 BaseController (Autowired)。然后我在实施时遇到了奇怪的“对象引用”异常。（AuthService 第 135 行 base.RequestContext 为空）

为什么我会收到此错误？或者任何人都可以发送简单的用法。（像 Asp.net Mvc Membership Starter）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T20:35:52.170

使用 RequestContext 的服务需要注入当前的 Request Context，例如：

```
authService.RequestContext = new HttpRequestContext(
    HttpContext.Current.Request.ToRequest(),
    HttpContext.Current.Response.ToResponse(),
    null
); 
```

这使用[SessionExtensions.cs](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/SessionExtensions.cs)中的扩展方法。

您还需要从 IOC 解析任何服务 - 这是[在 ServiceStack 和 MVC 之间共享功能](https://stackoverflow.com/questions/10571450/should-servicestack-be-the-service-layer-in-an-mvc-application-or-should-it-call/10572977#10572977)的一个很好的示例。

# c++ - 为什么在这种情况下编译器没有省略复制构造

> ID：11218007
> 
> 赞同：0
> 
> 时间：2012-06-27T01:02:36.403
> 
> 标签：c++, visual-studio-2010

```
class test
{

public:

    int data;
    test(int var = 0):data(var){cout<<"constructor"<<endl;}
    ~test(){ cout<<"destructor"<<endl; }

    test(const test& var)
    {
        cout<<"copy constructor"<<endl;
        this->data = var.data;

    }
    test& operator=( const test& var)
    {
        cout<<"assignment op"<<endl;
        this->data = var.data;
        return *this;
    }

};

test passByref_returnByVal(test& obj)    
{    
    return obj;    
}

int main()
{

    test o1(5);
    test o2 = passByref_returnByVal(o1);
    cout<<"=========================="<<endl;
    test o3;
    o3 = passByref_returnByVal(o1);   
} 
```

输出：

```
constructor

copy constructor

constructor

copy constructor

assignment op

destructor 
```

在给定的示例中，对象`o2`是直接复制构造的，不使用任何临时对象。

但是在第二种情况下，我想`o3`分配函数的返回值，首先使用复制构造函数创建一个临时值，然后调用赋值运算符进行值赋值。

我的问题是，当我的赋值运算符参考时，这个临时的需要是什么。我找到了相关的问题，但他们没有回答这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:24:37.670

```
test o3; 
```

将导致调用构造函数来创建对象。C++ 不是 Java，其中对象类型声明仅声明引用但不实例化对象。

```
test passByref_returnByVal(test& obj) {....} 
```

导致复制构造函数调用，因为当您在其中执行时`return obj;`，编译器需要创建一个临时对象，因为该函数的返回类型是`test`（而不是`test&`or `test*`）。

最后，因为`o3`已经存在

```
test o3; 
```

声明时，调用赋值运算符将 的返回值赋给`passByref_returnByVal`已经存在的`o3`.

因此，复制构造函数调用发生在 中`passByref_returnByVal`，而不是在您的`operator=`.

# java - 从属性文件读取文件路径的问题

> ID：11218009
> 
> 赞同：3
> 
> 时间：2012-06-27T01:02:49.927
> 
> 标签：java, properties

我正在开发一个 Swing 应用程序，它允许用户查看（主要是本地存储的）文件集。我可以将文件列表（以及其他首选项）作为文本存储在属性文件中，但是当我尝试将文件值拉回时，使用

`myProperties.getProperty("File")`

它会丢弃文本中的*一些“\”。*我确认写入属性文件是这样的：

`myPrintWriter.println("File = " + myFile.toString().replaceAll("\\\\", "/"))`

或这个：

`myPrintWriter.println("File = " + myFile.toString().replaceAll("\\\\", "\\\\\\\\"))`

将允许`getProperty()`像我预期的那样工作，但我不喜欢在没有 API 解释的情况下将我的数据转换为 Java 特定格式，所以我决定将它写在 Stack Overflow 上。

* * *

但是当我在帖子中达到这一点时，我开始感到尴尬；我正要在 Stack Overflow 上发帖，甚至没有咨询 Java 源代码`java.util.Properties`（随 JDK 一起分发）。我发现 Javadoc 注释`Properties.load()`表明这是一个设计决策，例如，它允许 Properties 值包含换行符。如果我发现我需要这种语言独立性，我想我会考虑用 XML 编写我的属性文件。

* * *

结语：所以这是我在 Stack Overflow 上的第一篇文章，我已经回答了我自己的问题，但我还是决定发布它，希望有人（或者，也许是一些人工的自然语言处理智能）可以找到它有用（或有启发性）。另外，我很好奇人们可能会在回复中发布的任何想法或建议。TL；博士？谢谢阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:23:23.087

如果适用，您可以使用双反斜杠 - `c:\\test\\test.txt`：

```
Properties props = new Properties();
props.setProperty("test", "c:\\test\\test.txt");
System.out.println(props.getProperty("test")); 
```

在 Windows 系统上，您还可以使用正斜杠 - `c:/test/test.txt`：

```
Properties props = new Properties();
props.setProperty("test", "c:/test/test.txt");
System.out.println(props.getProperty("test")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:35:00.507

你可以`Properties.store()`用来写出你的属性。`store()`被记录为以可以读取的格式写入属性`load()`，因此它将处理需要完成的任何按摩。

# jquery - jQuery如果哈希有一个附加值

> ID：11218010
> 
> 赞同：0
> 
> 时间：2012-06-27T01:03:00.090
> 
> 标签：jquery, hash, split

这里的逻辑很简单，我不知道如何将值与`window.location.hash`. 类似的东西`.split('=')[0]`，但删除它之前的所有内容而不是之后的所有内容。

一些潜在的哈希：`/#work` `/#work=video1`

我想说：

```
var hash = window.location.hash,
    val  = hash.split('=')[0];

    if (val != ''){
        do some stuff because there IS a value
        i.e. once split, the value is something
    } else {
        do some other stuff because there IS a value
        i.e. once split, the value is nothing
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:07:19.470

```
var hash = window.location.hash,
    val  = hash.substr( hash.indexOf('=') + 1 );

if(val.length) {  // val
  // do something
} else {
  // do something else
} 
```

# ios - iOS 推送通知噩梦，提供应用 ID 和证书

> ID：11218012
> 
> 赞同：3
> 
> 时间：2012-06-27T01:03:06.833
> 
> 标签：ios, apple-push-notifications

嘿 Apple 开发人员，我正在努力弄清楚 iOS 配置文件、证书和应用程序 ID 如何与推送通知配合使用。我以为我快要让它发挥作用了，但也许不是。

当我运行我的应用程序并尝试注册推送通知时，我在控制台中收到此错误：

```
2012-06-26 17:52:29.380 Grouped[1732:707] badgeNumber: 0
2012-06-26 17:52:30.089 Grouped[1732:707] [INFO] device is ready
2012-06-26 17:52:32.654 Grouped[1732:707] JSLOG: Registering with APNS via the App Delegate
2012-06-26 17:52:32.655 Grouped[1732:707] Register success callback set
2012-06-26 17:52:32.661 Grouped[1732:707] didFailToRegisterForRemoteNotificationsWithError:Error 
Domain=NSCocoaErrorDomain Code=3000 "no valid 'aps-environment' entitlement string found for 
application" UserInfo=0x18a0c0 {NSLocalizedDescription=no valid 'aps-environment' 
entitlement string found for application} 
```

我现在已经做了几个小时的研究，无法弄清楚我做错了什么。我创建了一个链接到我的应用 ID 的新配置文件。我可以在我的手机上看到它。

有任何想法吗？

额外的问题：为什么正确地为推送通知配置 iOS 应用程序如此复杂？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T01:20:54.380

有几件事要检查：

*   您的设备上是否有此应用程序的任何其他配置文件？我会删除它们。
*   您的 App ID 是否在供应门户中启用了推送？
*   您确定您使用正确的个人资料签名吗？它必须是非通配符开发证书。
*   您是否指定了自己的 entitlements.plist 文件？现代 Xcode 会生成一个，所以你不需要这样做。确保您的“代码签名权利”构建设置为空。

如果您还没有找到它，Apple 有一个很好的常见问题解答：

[http://developer.apple.com/library/ios/#technotes/tn2265/_index.html](http://developer.apple.com/library/ios/#technotes/tn2265/_index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:24:01.573

```
"no valid 'aps-environment' entitlement string found for 
application" 
```

您的配置文件未启用推送通知。确保您在配置门户中启用了它们，生成一个新的配置文件，但更重要的是确保您*在 Xcode 中实际安装了它并使用该配置文件为您的应用程序签名*。最后一部分咬了我几次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T14:42:41.780

确保在为应用创建推送证书后创建新的 adhoc/appstore 配置文件。为推送消息启用应用程序后，分发配置文件会发生变化。

# captcha - 另类验证码服务

> ID：11218014
> 
> 赞同：0
> 
> 时间：2012-06-27T01:03:39.627
> 
> 标签：captcha

什么网站提供类似验证码的服务？

正确读取验证码可能很困难。在某些情况下，这些字母被过度拉伸，以至于很难辨别这些字母是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:06:41.710

[Recapcha](http://www.google.com/recaptcha)是最好的之一。易于实施，难以绕过

# iphone - 当我返回我的应用程序而不检查状态栏框架时，如何判断手机何时通话？

> ID：11218023
> 
> 赞同：0
> 
> 时间：2012-06-27T01:04:44.813
> 
> 标签：iphone, ios, ios4, ios5

我正在使用 UIApplicationWillChangeStatusBarFrameNotification 来判断状态栏何时会更改，这确实有助于我确定正在进行的呼叫何时消失，并且行为如我所愿。

但是，我的应用程序中有一个场景是全屏显示，其中包括隐藏状态栏……除了我不想在通话时隐藏状态栏。

我的理解是，这个状态栏首先出现的唯一方法是如果我（a）接到电话，然后（b）返回我的应用程序。

所以……当我接到电话后返回我的应用程序时……没有绿色状态栏。（fwiw，当我点击我的应用程序以使状态栏和导航栏和标签栏重新出现时，确实会出现绿色状态栏，所以并不是它完全消失了；只是因为我告诉它隐藏而隐藏。在模拟器，执行“硬件->切换通话状态栏”按我的意愿工作，但我认为这种行为在现实世界中不会真正以这种方式发生。）

[我找到了当用户在通话中打开我的 iPhone 应用程序时如何获得通知](https://stackoverflow.com/questions/2618799/how-do-i-get-notified-when-a-user-opens-my-iphone-app-while-in-a-phone-call)的答案？…但这只有在我的应用程序重新打开时状态栏可见时才有效。

我想知道当我返回我的应用程序时如何告诉我正在通话，以便我可以在用户查看我的场景时手动取消隐藏绿色状态栏，否则会隐藏状态栏。

因此，我的问题是：是否有一个界面可以告诉我这些信息，当我在 applicationDidBecomeActive: 中返回应用程序时可以查询这些信息：或通过某种其他类型的通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:46:26.573

您可以使用 CTCallCenter 来查看当前是否有手机通话。您还向此类注册了一个处理程序，以便收到有关单元状态更改的通知。

```
 CTCallCenter *callCenter = [[CTCallCenter alloc] init];

    // If no calls are in progress, the value of this property is nil.
    if ([callCenter currentCalls] != nil) {
        ... call present...
    }
    [callCenter release]; 
```

# haml - 我怎样才能在 Haml 中转义 & 以使其编译为 & 而不是 &？（哈姆菜鸟）

> ID：11218025
> 
> 赞同：2
> 
> 时间：2012-06-27T01:04:49.360
> 
> 标签：haml

我正在尝试将 Icomoon 图标字体与 Haml 一起使用，但似乎无法找到一种方法来逃避它，`&`以便它保持只是一个`&`而不是`&amp;`.

Icomoon 字体允许您使用带有 data-icon="" 属性的 HTML 实体。如果我只是做一个直接的 HTML 链接，那么在 HTML 甚至在 Haml 文件中都可以像黄油一样流畅地工作。

但是，由于我正在学习 Haml，我想我会看看这里是否有人愿意推荐解决此问题的最佳方法。

这是发生的事情的一个示例。

这是原始的Haml：

```
%a(href='/posts' data-icon="&#x0026" aria-hidden='true') 
```

这是它的编译方式：

```
<a aria-hidden='true' data-icon='&amp;#x0026' href='/posts'> 
```

这是图标字体工作所需的编译方式：

```
<a aria-hidden='true' data-icon='&#x0026' href='/posts'> 
```

这是一个代码笔，您可以在其中查看由于放大器而导致的图标呈现方式；补充：[http ://codepen.io/dandenney/pen/3/6](http://codepen.io/dandenney/pen/3/6)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T10:02:58.130

我不喜欢顶级发帖人完成这个问题的方式。到目前为止，我发现最好的方法是：

```
- foo = "&#x0026".html_safe
%a(href='/posts' data-icon=foo aria-hidden='true') 
```

我对此并不完全满意，但认为这对 Rails 应用程序来说比关闭到处转义的 HTML 更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:38:51.967

您可以使用该[`:escape_attrs`选项](http://haml.info/docs/yardoc/file.HAML_REFERENCE.html#options)来控制是否对属性中的 HTML 敏感字符进行转义：

```
require 'haml'

haml = "%a(href='/posts' data-icon=\"&#x0026\" aria-hidden='true')"

puts Haml::Engine.new(haml, :escape_attrs => false).to_html 
```

输出：

```
<a aria-hidden='true' data-icon='&#x0026' href='/posts'></a> 
```

请注意，这将适用于您的 Haml 模板中的所有属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-08T11:58:55.800

在我看来，我不喜欢禁用该功能以通常转义字符的想法。也许您在应用程序中的某个时候使用中继。

对我来说，最好的方法是：

```
%a{ href: '/', 'data-icon' => "&#10000;".html_safe } 
```

# javascript - 是否有一种安全的方法可以在页面中允许使用 3rd-party javascript？

> ID：11218032
> 
> 赞同：1
> 
> 时间：2012-06-27T01:05:58.323
> 
> 标签：javascript

是否有一种安全的方式可以将不受信任的 javascript 加载到页面中并信任不会造成伤害？

我想创建一个包含用户贡献的 javascript 的可执行 wiki。但是，我担心恶意 javascript 可能会劫持页面并危及我系统上的用户帐户。

是否有可行的方法来隔离 javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:08:05.460

是的。试试[Google Caja](http://code.google.com/p/google-caja/)，这正是你想要的（我认为）。

# iphone - 如何在 iPhone 中按比例裁剪图像？

> ID：11218033
> 
> 赞同：2
> 
> 时间：2012-06-27T01:06:00.377
> 
> 标签：iphone, ios, graphics, scale

我有一个大尺寸的图像（2048*2048px），这个图像在 iPhone 屏幕上显示为 320*320。我想做这个：

在我的APP中，用户可以打开大尺寸图片（例如2048*2048），图片在iPhone屏幕上显示为320*320，并且图片上方有一个矩形，用户可以在iPhone屏幕上将矩形移动到图片内的任意位置，例如矩形（100、100、300、200），然后我想在矩形区域内按比例裁剪原始大小的图像。

我尝试了很多方法，

```
UIImageView *originalImageView = [[UIImage View alloc] initWithImage:originalImage]];

CGRect rect = CGRectMake(100, 100, 300, 200);

UIImage *cropImage = [UIImage imageWithCGImage:CGImageCreateWithImageInRect([originalImageView.image CGImage], rect)]; 
```

但我得到的cropImage 只是300*200 大小的图像，不能正确缩放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:50:54.633

首先使用此方法调整大小为 320*320 的图像：

```
+(UIImage *)resizeImage:(UIImage *)image width:(float)width height:(float)height
{
  CGSize newSize;
  newSize.width = width;
  newSize.height = height
  UIGraphicsBeginImageContext(newSize);
  [image drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];
  UIImage* newImage = UIGraphicsGetImageFromCurrentImageContext();
  UIGraphicsEndImageContext();
} 
```

现在在 imageView 中设置调整大小的图像

```
UIImage *resizeImage = [YourControllerName resizeImage:originalImage width:320 height:320];
UIImageView *originalImageView = [[UIImage View alloc] initWithImage:resizeImage]]; 
```

您现在可以裁剪

```
CGRect rect = CGRectMake(100, 100, 300, 200);
UIImage *cropImage = [UIImage imageWithCGImage:CGImageCreateWithImageInRect([originalImageView.image CGImage], rect)]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:51:20.047

这样做怎么样，它会保留原始图像质量

```
CGSize bounds = CGSizeMake(320,320) // Considering image is shown in 320*320
CGRect rect = CGRectMake(100, 100, 220, 200); //rectangle area to be cropped

float widthFactor = rect.size.width * (originalImage.size.width/bounds.size.width);
float heightFactor = rect.size.height * (originalImage.size.height/bounds.size.height);
float factorX = rect.origin.x * (originalImage.size.width/bounds.size.width);
float factorY = rect.origin.y * (originalImage.size.height/bounds.size.height);

CGRect factoredRect = CGRectMake(factorX,factorY,widthFactor,heightFactor);
UIImage *cropImage = [UIImage imageWithCGImage:CGImageCreateWithImageInRect([originalImage CGImage], factoredRect)]; 
```

最重要的是，如果您想裁剪 imagePickerController 返回的图像，则可以通过以下内置函数来完成，

```
imagePickerController.allowsEditing = YES; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:59:32.133

为什么不计算比例因子（例如 originalImageWidth/smallImageWidth）？如果矩形`(100,100,300,200)`在您的小图像中，您应该将拉格图像裁剪为 size `(100*factor,100*factor,300*factor,200*factor)`。

# jquery - 如何从 ajax 获取选定的下拉列表，html 结果？

> ID：11218034
> 
> 赞同：0
> 
> 时间：2012-06-27T01:06:02.973
> 
> 标签：jquery

我有一个 ajax get ，我想在该响应 html 中获取下拉列表的选定值。

这是html中返回的html。

```
<select id="f_pic1" name="f_pic1">
<option selected="selected" value="1">My Pic</option>
</select> 
```

ajax成功函数的一部分

```
success: function (html)
{
    var ddlId = 'f_pic1';
    var outResult = $(html);

    // listed here are different attempts.
    // attempt 1
    var ddl = outResult.find('#' + ddlId + ' option:selected'); //undefined

    // attempt 2
    var ddl = outResult.find('#' + ddlId); //object
    var val1 = ddl.val(); //undefined
    var text = ddl.text(); //undefined
    var id = ddl.attr('id'); //undefined
} 
```

如何从返回的 html 中的下拉列表中获取选定的值和文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:12:05.700

问题是你试图找到一个没有 id 的元素`f_pic1`，`#f_pic1`所以只需找到选定的选项。

```
var ddl = outResult.find('option:selected'); 
```

# css - 图片div上的强制透明边框？

> ID：11218036
> 
> 赞同：0
> 
> 时间：2012-06-27T01:06:24.063
> 
> 标签：css, wordpress, overlay, transparency, transparent

我有一个`div`包含将在 WordPress 上经常更新的图片。我想避免编辑每个图像的边框。这是我使用 Photoshop 上的剪贴蒙版创建的一组 8 张照片周围的圆顶形边框。

有没有我可以使用的 CSS 技巧来使`border.png`文件`div`与图片重叠并变得透明并阻止它在图片上覆盖的区域`div`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T18:52:12.413

使用`border: none`将删除边框，但也会从该边框的宽度中删除人为的“填充”。如果您希望间距保持不变，您可以执行`border-color: transparent`. 但是请注意，[IE6 和更早版本](http://www.w3schools.com/cssref/pr_border-color.asp)不支持边框颜色的透明属性。

# javascript - 按子元素的数据ID排序li - jQuery

> ID：11218043
> 
> 赞同：1
> 
> 时间：2012-06-27T01:07:15.330
> 
> 标签：javascript, jquery, html

所以我试图通过每个`<li>`. 如何定位此元素以按其值排序？

这是我当前的代码：

```
 $("#sort_popularity").live("click", function() {
        var listitems = list.children('li').get();

        listitems.sort(function(a, b) {
            var compA = $(a).("#subject_popularity");
            var compB = $(b).("#subject_popularity");
            return compA < compB;
        });

        $.each(listitems, function(index, item) {
            list.append(item); // (List is defined elsewhere in my code)
        });
    }); 
```

HTML：

```
<a href="#" id="sort_popularity">Sort</a>

<ul>
    <li><span id="popularity" data-id="10">10</li>
    <li><span id="popularity" data-id="20">20</li>
    <li><span id="popularity" data-id="5">5</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:16:00.897

```
// for ASC.
var lis = $('ul li');

lis.sort(function(a, b) {
    return parseInt($('span', a).data('id'), 10) > parseInt( $('span', b).data('id'), 10);
});

$('ul').html(lis); 
```

**和**

```
// for DESC.
var lis = $('ul li');

lis.sort(function(a, b) {
    return parseInt( $('span', a).data('id'), 10) < parseInt( $('span', b).data('id'), 10);
});

$('ul').html(lis); 
```

### 笔记

更改`id`s 的`span`s，`id`多个不同`span`并关闭您的`span`标签（可能是拼写错误）。

# wcf - C# UploadStringAsync 不起作用

> ID：11218045
> 
> 赞同：1
> 
> 时间：2012-06-27T01:07:47.970
> 
> 标签：wcf, asynchronous, webclient, uploadstring

我有一个 wcf 服务，我正在调用这样的方法：

```
public static void f5()
    {
        var client = new WebClient();
        client.UploadStringCompleted += new UploadStringCompletedEventHandler(client_UploadStringCompleted);
        var data = File.ReadAllText("request.xml");
        client.Headers.Add("Content-Type", "text/xml;charset=utf-8");
        client.Headers.Add("SOAPAction", "some string");            
        client.UploadStringAsync(new Uri("http://differentdomain/wcf/Service.svc"), data);
    }

    public static void client_UploadStringCompleted(object sender, UploadStringCompletedEventArgs e)
    {
        Console.WriteLine(e.ToString());
        int cow = 0;
        cow++;
    }

    static void Main(string[] args)
    {
        f5();
    } 
```

当我不使用异步方法时，该程序可以完美运行，但是由于某种原因，处理程序没有被调用。Web 服务托管在不同域的不同计算机上，但客户端和服务器连接到同一网络。最重要的是，如果我改用 UploadString，一切正常。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T04:51:19.693

与其尝试让 Async 方法工作，不如尝试使用非异步方法，但使用[Task Parallel Library](http://msdn.microsoft.com/en-us/library/dd537609.aspx)使其异步工作：

```
var client = new WebClient();
var data = File.ReadAllText("request.xml");
client.Headers.Add("Content-Type", "text/xml;charset=utf-8");
client.Headers.Add("SOAPAction", "some string");

Task.Factory.StartNew(() =>
{
    string returnVal = client.UploadString(new Uri("http://differentdomain/wcf/Service.svc"), data);
    Console.WriteLine(returnVal);
}); 
```

这是一个整体上更好的策略，因为它适用于所有长时间运行的操作，而不仅仅是那些具有 Async 方法和事件处理程序的操作。

它还应该使发生的任何通信/传输错误更容易被发现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T15:59:32.010

您的程序在调用 UploadStringAsync 后立即退出，因此没有时间获得响应。`Thread.Sleep`在下面的代码中，如果我在 Main 方法的末尾删除调用，它也不会打印任何内容。在退出程序之前尝试等待响应到达。

```
public class StackOverflow_11218045
{
    [ServiceContract]
    public interface ITest
    {
        [OperationContract]
        string Echo(string text);
    }
    public class Service : ITest
    {
        public string Echo(string text)
        {
            return text;
        }
    }
    public static void Main()
    {
        string baseAddress = "http://" + Environment.MachineName + ":8000/Service";
        ServiceHost host = new ServiceHost(typeof(Service), new Uri(baseAddress));
        host.AddServiceEndpoint(typeof(ITest), new BasicHttpBinding(), "");
        host.Open();
        Console.WriteLine("Host opened");

        string data = @"<s:Envelope xmlns:s=""http://schemas.xmlsoap.org/soap/envelope/"">
                            <s:Header/>
                            <s:Body>
                                <Echo xmlns=""http://tempuri.org/"">
                                    <text>Hello</text>
                                </Echo>
                            </s:Body>
                        </s:Envelope>";
        var client = new WebClient();
        client.UploadStringCompleted += new UploadStringCompletedEventHandler(client_UploadStringCompleted);
        client.Headers[HttpRequestHeader.ContentType] = "text/xml; charset=utf-8";
        client.Headers.Add("SOAPAction", "http://tempuri.org/ITest/Echo");

        ManualResetEvent evt = new ManualResetEvent(false);
        client.UploadStringAsync(new Uri(baseAddress), "POST", data, evt);
        evt.WaitOne();
    }

    static void client_UploadStringCompleted(object sender, UploadStringCompletedEventArgs e)
    {
        Console.WriteLine(e.Result);
        ((ManualResetEvent)e.UserState).Set();
    }
} 
```

# javascript - JavaScript 中的基本排序

> ID：11218050
> 
> 赞同：0
> 
> 时间：2012-06-27T01:08:15.100
> 
> 标签：javascript

我是 JavaScript 新手，所以请耐心等待...

我有一个链接到我的 HTML 的外部 JavaScript 文档（在 HTML 文档的头部调用）。

在我的 JavaScript 文档中，我对`window.onload`事件调用了两个函数：

```
window.onload = function() {
    selected_state();
    viewer();
};

function selected_state() {
    var titleAr = document.getElementsByTagName("title");
    var aAr = document.getElementsByTagName("a");
    // Take the first element of title array. Check if it matches
    // the first element of link array.
    for (i = 0; i <= titleAr.length; i++) {
        for (l = 0; l <= aAr.length; l++) {
            if (titleAr[i].innerHTML === aAr[l].innerHTML) {
                aAr[l].style.color = "#C33";
                break;
            }
        }
    }
};

function viewer() {
    var imgAr = document.getElementsByTagName("img");
    for (var i = 0; i < imgAr.length; i++) {
        imgAr[i].onmouseover = function() {
            this.style.border = "1px solid #CCC";
        }
    }
};​ 
```

第一个函数运行没有问题，但第二个函数没有运行。如果我切换它们，那么`viewer()`首先，然后`selected_state()`就不会执行。我知道这个问题可能是非常简单的逻辑明智的......任何接受者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:14:02.380

Looks like `selected_state` is breaking when the inner loop finishes in the outer loop's first run; your loop condition is incorrect *(must be throwing something like "index out of bounds")*.

Arrays use a *zero-based index*:

Change:

```
for (i=0; i <= titleAr.length; i++) {
    for (l=0; l <= aAr.length; l++) { 
```

To:

```
for (i=0; i < titleAr.length; i++) {
    for (l=0; l < aAr.length; l++) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:11:23.563

The only explanation is that both functions throw exceptions after doing whatever it is that makes you think they've run without trouble. Barring their throwing exceptions, first the first one will run, then the second one will run. There's no basic logic error you're missing. But if the first function throws an exception, that transfers control out to the next exception catching frame, which (if you haven't defined one via `try...catch`) will be outside of your code.

Your best bet is to use a decent debugger to find out what's going on. All major browsers now have decent debuggers built in. In IE and Chrome, press F12 to open the debugger; in other browsers, look at the menus. The debugger will have a "console" where it reports errors. You can also set breakpoints and walk through the code statement-by-statement.

* * *

*(Edit now you've posted the code.)*

Note that your code in `selected_state` falls prey to [*The Horror of Implicit Globals*](http://blog.niftysnippets.org/2008/03/horror-of-implicit-globals.html). You need to declare `i` and `l` with `var`.

# c++ - 有人可以用 open mpi 解释这个 valgrind 错误吗？

> ID：11218056
> 
> 赞同：0
> 
> 时间：2012-06-27T01:09:11.583
> 
> 标签：c++, memory-management, memory-leaks, valgrind, openmpi

我的基本问题是关于抑制文件如何在 valgrind 中工作。我查看了很多文档，这些文档指向在 mpi 版本 > 1.5（我的是 1.6）上使用以下内容：

```
 mpirun -np 2 valgrind --suppressions=/usr/share/openmpi/openmpi-valgrind.supp --track-origins=yes ./myprog 
```

但是，当我这样运行它时，文件有超过 600 个错误！我得到的错误是这两个一遍又一遍。以我目前对 valgrind 和 mpi 的理解，我不知道如何解释其中任何一个。

```
==8821==  Address 0xad5e4d7 is 87 bytes inside a block of size 128 alloc'd
==8821==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==8821==    by 0x6348C52: ??? (in /usr/lib/openmpi/lib/libopen-pal.so.0.0.0)
==8821==    by 0x6349AF1: ??? (in /usr/lib/openmpi/lib/libopen-pal.so.0.0.0)
==8821==    by 0x6349B81: ??? (in /usr/lib/openmpi/lib/libopen-pal.so.0.0.0)
==8821==    by 0x7DA5B9C: ??? (in /usr/lib/openmpi/lib/openmpi/mca_grpcomm_bad.so)
==8821==    by 0x7DA52F4: ??? (in /usr/lib/openmpi/lib/openmpi/mca_grpcomm_bad.so)
==8821==    by 0x5082AF2: ??? (in /usr/lib/openmpi/lib/libmpi.so.0.0.2)
==8821==    by 0x50A33FA: PMPI_Init (in /usr/lib/openmpi/lib/libmpi.so.0.0.2)
==8821==    by 0x408AB5: main (test_send-receive.cpp:8)
==8821==  Uninitialised value was created by a heap allocation
==8821==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==8821==    by 0x635FE2B: ??? (in /usr/lib/openmpi/lib/libopen-pal.so.0.0.0)
==8821==    by 0x6360634: opal_ifcount (in /usr/lib/openmpi/lib/libopen-pal.so.0.0.0)
==8821==    by 0x81B36AA: ??? (in /usr/lib/openmpi/lib/openmpi/mca_oob_tcp.so)
==8821==    by 0x5C01EE2: mca_oob_base_init (in /usr/lib/openmpi/lib/libopen-rte.so.0.0.0)
==8821==    by 0x7FA97FB: ??? (in /usr/lib/openmpi/lib/openmpi/mca_rml_oob.so)
==8821==    by 0x5C083E4: orte_rml_base_select (in /usr/lib/openmpi/lib/libopen-rte.so.0.0.0)
==8821==    by 0x5BF5EC4: orte_ess_base_app_setup (in /usr/lib/openmpi/lib/libopen-rte.so.0.0.0)
==8821==    by 0x7BA1EAE: ??? (in /usr/lib/openmpi/lib/openmpi/mca_ess_env.so)
==8821==    by 0x5BDDB72: orte_init (in /usr/lib/openmpi/lib/libopen-rte.so.0.0.0)
==8821==    by 0x50822E0: ??? (in /usr/lib/openmpi/lib/libmpi.so.0.0.2)
==8821==    by 0x50A33FA: PMPI_Init (in /usr/lib/openmpi/lib/libmpi.so.0.0.2) 
```

产生这些错误的代码是：

```
int main(int argc, char *argv[]) {

  /* init MPI */
  MPI_Init(&argc, &argv);

  int myid;
  MPI_Comm_rank(MPI_COMM_WORLD, &myid);
  int i;
  if(myid == 0){
    double * d = new double [10];
    for(i = 0; i<10; i++){
      d[i] = i + 1.0;
    }
    MPI_Send(d,
             10,
         MPI_DOUBLE,
         1,
         1,
         MPI_COMM_WORLD);
    delete[] d;
  } else {
    MPI_Status status;
    double * c = new double [10];
    MPI_Recv(c,
         10,
         MPI_DOUBLE,
             0,
         MPI_ANY_TAG,
         MPI_COMM_WORLD,
         &status);

    for(i = 0; i<10; i++){
      printf("%f\n", c[i]);
    }
    delete[] c;
  }
  MPI_Finalize();
  return 0;
    } 
```

此外，此代码运行良好并输出预期结果。我是否误解了数据是如何通过网络发送的，还是这里发生了我不明白的其他事情？

很抱歉这篇文章的长度，你们甚至为读到这里而感到震惊。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-08T14:47:11.363

很有可能我们的抑制文件在 OMPI v1.6 中不是最新的。:-\

您应该在 OMPI 邮件列表中报告此情况。请参阅[http://www.open-mpi.org/community/lists/ompi.php](http://www.open-mpi.org/community/lists/ompi.php)。

# google-chrome-extension - 使用 chrome 扩展将 iframe 附加到用户的当前页面

> ID：11218058
> 
> 赞同：1
> 
> 时间：2012-06-27T01:09:16.533
> 
> 标签：google-chrome-extension

我正在尝试将 iframe 页面附加到用户使用 chrome 扩展程序访问的页面。例如，iframe 将放置在页面顶部。我已经成功地使用以下代码（myscript.js）附加了 iframe：

```
var iframe = document.createElement("iframe");
iframe.src = chrome.extension.getURL("./myIframe.html");
document.body.insertBefore(iframe, document.body.firstChild); 
```

但是，在我的 iframe 页面中，我使用了几个也需要 jquery (.js) 库的 javascripts (.js)。似乎没有一个脚本以这种方式使 iframe 页面不起作用。在我的 content_scripts 中，我包含了 lib：

```
 "content_scripts": [
{
  "matches" : ["http://*/*", "https://*/*"],
  "js": ["jquery.js", "myscript.js"],
  "all_frames" : true
} 
```

],

我还尝试包含 iframe 使用但仍然无效的每个 (.js) 文件。我实际上想要做的是通过一个界面让用户在页面上执行一些看起来像改变背景颜色的操作。我怀疑在用户的当前页面上通过 iframe 页面的 javascripts 执行某些操作是不可能的。有谁知道我需要做什么才能解决这个问题，或者是否有任何其他方法可以实现我在这里尝试的目标？谢谢。

# c++ - 如何在 Ubuntu 上运行 Code::Blocks 创建的可执行文件？

> ID：11218060
> 
> 赞同：2
> 
> 时间：2012-06-27T01:09:38.313
> 
> 标签：c++, command-line, terminal, ubuntu-12.04, codeblocks

我已经写了一个小程序`hello the world`，当我在 Code::Blocks IDE 中运行它时一切正常。但我无法运行在 Code::Blocks 之外创建的文件。在 it's`Properties`中，我发现它的类型是`executable(application/x-executable)`.

我的另一个问题是，为什么 Code::Blocks 创建的文件不是该`.exe`类型。当然，我不想像在 Windows 上那样在 Ubuntu 上运行该文件。而且我觉得还有另外一种方式可以在Ubuntu上编译调试程序，那就更好了，呵呵。请帮我！谢谢你！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T01:18:41.637

您会看到，在 Ubuntu 和 Linux 上，可执行文件没有扩展名（与使用`.exe`and的 Windows 不同`.com`）。还有另一件事：要运行文件，必须设置可执行位。因此，要执行应用程序（我假设您使用的是 Unity），请打开破折号并搜索“终端”。开始第一个结果。在这里，您将处于控制台中，您可以在其中键入系统命令。该文件夹开始于您的主目录。首先，使用`cd`命令进入该目录：

```
cd Documents/Programing/HelloWorld/ 
```

然后像这样执行程序：

```
./hello 
```

（`hello`替换为您的程序的文件名）。如果这不适用于有关权限的错误消息，请先执行此操作：

```
chmod +x hello 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-25T09:55:45.947

经过一番研究，我得出结论，[Linuxios的答案](https://stackoverflow.com/a/11218128/2932052)可以更集中。

*   您从 IDE 中运行程序，这意味着我假设设置了可执行标志
    （我尝试了相同的方法，发现它已经由 CodeBlocks 设置，如属性对话框中所示）
*   我假设您正确导航到包含该程序的文件夹。
*   **您唯一错过**的是从命令外壳[应用](https://askubuntu.com/a/320657/213118)[**您的 PATH**](https://askubuntu.com/a/320657/213118)以搜索可执行命令。并且此 PATH 不包含当前文件夹。

为程序添加前缀`./`将覆盖路径搜索。

# asp.net-mvc - 实体框架代码优先多对多 NullReference

> ID：11218068
> 
> 赞同：2
> 
> 时间：2012-06-27T01:10:45.363
> 
> 标签：asp.net-mvc, entity-framework-4, entity-framework-4.1, ef-code-first, entity-relationship

我在 su.Companies.Add(co); 上不断收到 NullReferenceException；线。我认为按照我定义模型的方式，它应该可以工作。自动完成，听起来像一个新手，可以很好地完成这个。我显然是 EntityFramework 的新手。

帮助？

```
using (var db = new TicketdocketEntities())
{
  var su = new SiteUser { UserName = model.UserName };
  db.SiteUser.Add(su);
  var co = new Company { Name = "Hello" };
  su.Companies.Add(co);
  db.SaveChanges();
} 
```

楷模

```
public class Company
{
  [Key]
  public int CompanyId { get; set; }
  public string Name { get; set; }

  public virtual ICollection<SiteUser> SiteUsers { get; set; }
}

public class SiteUser
{
  [Key]
  public int SiteUserID { get; set; }
  public string UserName { get; set; }

  public virtual ICollection<Company> Companies { get; set; }
}

public class TicketdocketEntities : DbContext
{
    public DbSet<Company> Companies { get; set; }
    public DbSet<SiteUser> SiteUser { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T01:12:56.560

您仍然需要使用实际列表初始化属性：

```
public class SiteUser 
{ 
    public SiteUser()
    {
        Companies = new List<Company>();
    }

    [Key] 
    public int SiteUserID { get; set; } 
    public string UserName { get; set; } 

    public virtual ICollection<Company> Companies { get; set; } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-26T22:27:38.560

对于其他可能遇到这个问题的人（就像我刚刚做的那样）......

使用实际列表初始化属性是修复 NullReferenceException 的正确方法。但是，正如 marek_lani 指出的那样，它不应该在模型本身内完成，因为所有 SiteUser 对象都将有一个空的 Companies 列表，然后需要填充。正确的方法，或者对我更有效的方法，是将相同的代码放在 su.Companies.Add() 语句之前的控制器操作中。

```
using (var db = new TicketdocketEntities())
{
    var su = new SiteUser 
        { 
            UserName = model.UserName,
            Companies = new List<Company>()
        };
    db.SiteUser.Add(su);
    var co = new Company { Name = "Hello" };
    su.Companies.Add(co);
    db.SaveChanges();
} 
```

# git - 票证的版本控制？

> ID：11218069
> 
> 赞同：-4
> 
> 时间：2012-06-27T01:10:51.130
> 
> 标签：git, version-control, agile

*[从概念上讲，这里](https://stackoverflow.com/questions/11007679/how-can-i-host-git-repositories-and-manage-my-content-hosting-myself)与 Git 的独立内容托管有关。*

我想将三件事分开：票务-版本控制（管理），编程-版本控制和结构-版本控制（更多[here](https://stackoverflow.com/questions/11253615/structure-of-projects-in-version-control-something-like-maven-for-non-java-pro)）。现在每个人都应该能够看到票证以及他们如何从一个想法演变成一个代码/产品。目前，我遇到了很大的问题，因为门票在 Bitbucket 和 Github 的专有棺材中，显然是他们锁定用户的商业策略。我想在一些存储库中管理我的票——相关票[在这里](https://github.com/jeffWelling/ticgit/issues/51)、[这里](https://github.com/jeffWelling/ticgit/issues/57)和[这里](https://github.com/jeffWelling/ticgit/issues/52)。如果我做票，我想承诺。我还想跟踪我的票，因为我希望以后能够轻松更改提供者。Github 有一些很好的特性，比如打孔卡（更多[在这里](https://stackoverflow.com/questions/11251941/how-can-i-see-github-style-things-such-as-punchcards-and-timeline-of-git-repo)) 但在 Bitbucket 上更难使用。我想随时控制我的工单并添加功能。那么我怎样才能对票进行版本控制呢？

```
 |---> tickets' version-control (Ticgit -version-not-yet-exist)
   |
---|---> code's VC (git)
   |
   |---> structural VC (? maven ?? runs, deployes, ??)
   | 
   |---> perms' VC (Gitolite) 
```

**也许相关**

> 1.  [版本控制的版本控制？](https://stackoverflow.com/questions/437247/version-control-for-version-control)
>     
>     
> 2.  [版本控制中的项目结构](https://stackoverflow.com/questions/16829/structure-of-projects-in-version-control)
>     
>     
> 3.  [https://stackoverflow.com/questions/4952/database-version-control](https://stackoverflow.com/questions/4952/database-version-control)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:16:05.813

我不确定你的问题到底是什么：它读起来更像是一份意向声明，而不是一个问题。但是假设您正在寻找一个可以让您这样做的系统，您可能会对[ticgit](https://github.com/jeffWelling/ticgit "提吉特")感兴趣，这是一个使用 Git 分支作为后端的错误跟踪系统，让您可以同时分叉和分支错误跟踪数据分叉代码。

# php - 从 Flash 发送邮件（使用 Actionscript 3.0）

> ID：11218071
> 
> 赞同：0
> 
> 时间：2012-06-27T01:11:04.923
> 
> 标签：php, actionscript-3, email, flash-cs5

我有一个 flash 项目，要添加的功能是，从 flash (.swf/.exe) 发送电子邮件**而不重定向**。仅提供发件人的电子邮件 ID，点击后，表单应发送电子邮件。我为此搜索了很多，给出了php解决方案，我无法解决可能是因为指导水平低。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:26:39.000

使用纯 ActionScript [SMTP 邮件程序](http://www.bytearray.org/?p=27)，例如：

[http://www.bytearray.org/wp-content/projects/smtpmailer/SMTPMailer%200.6.zip](http://www.bytearray.org/wp-content/projects/smtpmailer/SMTPMailer%200.6.zip)

ZIP 中包含的库和 FLA 示例。

示例实现：

![邮递员](../Images/c6fc4b8daaf58030f7e2e383342ecd18.png)

```
import org.smtp.mailer.SMTPMailer;
import org.smtp.encoding.JPEGEncoder;
import org.smtp.encoding.PNGEnc;
import org.smtp.events.SMTPEvent;
import flash.utils.ByteArray;
import flash.display.BitmapData;
import flash.display.Bitmap;
import flash.events.*;

// create the socket connection to any SMTP socket
// use your ISP SMTP

var myMailer:SMTPMailer = new SMTPMailer (smtp_txt.text, 25);

// register events
// event dispatched when mail is successfully sent
myMailer.addEventListener(SMTPEvent.MAIL_SENT, onMailSent);
// event dispatched when mail could not be sent
myMailer.addEventListener(SMTPEvent.MAIL_ERROR, onMailError);
// event dispatched when SMTPMailer successfully connected to the SMTP server
myMailer.addEventListener(SMTPEvent.CONNECTED, onConnected);
// event dispatched when SMTP server disconnected the client for different reasons
myMailer.addEventListener(SMTPEvent.DISCONNECTED, onDisconnected);
// event dispatched when the client has authenticated successfully
myMailer.addEventListener(SMTPEvent.AUTHENTICATED, onAuthSuccess);
// event dispatched when the client could not authenticate
myMailer.addEventListener(SMTPEvent.BAD_SEQUENCE, onAuthFailed);

// take the snapshot
var myBitmap:BitmapData = new BitmapData ( stage.stageWidth, stage.stageHeight );

// encode as JPEG with quality 100
var myEncoder = new JPEGEncoder( 100 );

send_btn.addEventListener (MouseEvent.CLICK, onClick);

message_txt.text = "<img src='http://www.google.com/images/logo_sm.gif'</img><br><b>Picture file attached!</b>";

function onClick ( pEvt:MouseEvent )
{
    // replace this by any DisplayObject
    myBitmap.draw ( this );

    var myCapStream:ByteArray = myEncoder.encode ( myBitmap );

    // sends HTML email
    //myMailer.sendHTMLMail ( from_txt.text, to_txt.text, subject_txt.text, "<img src='http://www.google.com/images/logo_sm.gif'</img><br><b>Picture from HTML :)</b>");

    // send HTML email with picture file attached
    myMailer.sendAttachedMail ( from_txt.text, to_txt.text, subject_txt.text, message_txt.text, myCapStream, "image.jpg");
}

function onAuthFailed ( pEvt:SMTPEvent ):void
{
    status_txt.htmlText = "Authentication Error";
}

function onAuthSuccess ( pEvt:SMTPEvent ):void
{
    status_txt.htmlText = "Authentication OK !";
}

function onConnected ( pEvt:SMTPEvent ):void 
{
    status_txt.htmlText = "Connected : \n\n" + pEvt.result.message;
    status_txt.htmlText += "Code : \n\n" + pEvt.result.code;
}

function onMailSent ( pEvt:SMTPEvent ) 
{
    // when data available, read it
    status_txt.htmlText = "Mail sent :\n\n" + pEvt.result.message;
    status_txt.htmlText += "Code : \n\n" + pEvt.result.code;
}

function onMailError ( pEvt:SMTPEvent ):void 
{
    status_txt.htmlText = "Error :\n\n" + pEvt.result.message;
    status_txt.htmlText += "Code : \n\n" + pEvt.result.code;
}

function onDisconnected ( pEvt:SMTPEvent ):void 
{
    status_txt.htmlText = "User disconnected :\n\n" + pEvt.result.message;
    status_txt.htmlText += "Code : \n\n" + pEvt.result.code;
}

function socketErrorHandler ( pEvt:IOErrorEvent ) 
{
    // when data available, read it
    status_txt.htmlText = "Connection error !";
} 
```

# android - 如何获取 Listview 中由 Checkbox 选中的edittext的值？

> ID：11218073
> 
> 赞同：2
> 
> 时间：2012-06-27T01:11:31.030
> 
> 标签：android, checkbox, android-edittext

我有一个 ListView，如下所示：-

*（复选框）* TEXT **[EditText]**

*（复选框）* TEXT **[EditText]**

*（复选框）* TEXT **[EditText]**

**...**

我真正想要的是获取在复选框中选中的所有编辑文本的值。

我使用了一个类`MyItem`来获取和设置值，类`MyAdpater`来设置适配器和项目布局以及`MyView`活动的类。布局不允许`onItemClick`/`onItemSelected`方法工作，因为布局具有复选框和编辑文本，因此它没有被单击为列表项。

如果需要，我会添加更多信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:31:29.990

当您使用适配器构建 ListView 时，为每个元素创建一个包含新 CheckBox 视图的数组列表。

```
ArrayList<CheckBox> a = new ArrayList<CheckBox>(16);
ArrayList<EditText> e = new ArrayList<EditText>(16);

public class Adapterwhatever extends asdljbg {

public View getChildVieworsomething(AdapterView<> viwe, int position..ydadayda) {

 //make sure you reset these
 a.add(new (CheckBox) findViewById(R.id.whateverman));
 b.add(new (EditText) findViewById(R.id.anEditText));

} 
```

调用后使用 arrayLists 检查值

```
adapter.notifyDataSetChanged(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T04:05:01.060

我以以下方式做了类似的事情（用作对话框）。我不使用复选框，我只是处理列表并查找所有非空编辑文本。

**适配器**

```
public class CursorAdapter_EditText extends SimpleCursorAdapter {

private static Cursor c;
private Context context;
public static String[] quantity;
private int layout;

public CursorAdapter_EditText(Context context, int layout, Cursor c,
        String[] from, int[] to) {
    super(context, layout, c, from, to);
    CursorAdapter_EditText.c = c;
    this.context = context;
    this.layout = layout;
    initializeQuantity();     // set array to hold contents od list edit text boxes
}

public static void initializeQuantity() {
    quantity = new String[c.getCount()];
    int i = 0;
    while (i < c.getCount()) {
        quantity[i] = "0";     // set all array quantities to 0
        i++;
    }
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    if (convertView == null)
        convertView = View.inflate(context, layout, null);
    final int pos = position;
    View row = convertView;
    c.moveToPosition(position);
    TextView name = (TextView) row.findViewById(R.id.ListItem1);
    TextView unit = (TextView) row.findViewById(R.id.ListItem2);
    EditText qty = (EditText) row.findViewById(R.id.qty);
    qty.setOnFocusChangeListener(new View.OnFocusChangeListener() {    //  save changes to the array when the user leaves an edit box
        @Override
        public void onFocusChange(View v, boolean hasFocus) {
            if (!hasFocus) {
                LinearLayout parent = (LinearLayout) v.getParent();
                EditText qtyTemp = (EditText) parent.findViewById(R.id.qty);
                quantity[pos] = qtyTemp.getText().toString();
            }
        }
    });
    name.setText(c.getString(1));
    unit.setText(c.getString(3));
    qty.setText(quantity[position]);  //  set the value in the edit box to the value stored in the array
    return (row);
}
} 
```

然后，我在布局中有一个按钮，用于保存列表视图，以便在用户编辑他们想要的内容后处理列表。

**按钮代码**

```
 commit.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {

            int i = 0;
            itemCursor.moveToFirst();
            while (itemCursor.isAfterLast() == false) {
                if (CursorAdapter_EditText.quantity[i].equals("")) {
                    CursorAdapter_EditText.quantity[i] = "0";
                }
                ;
                int tempQty = Integer
                        .parseInt(CursorAdapter_EditText.quantity[i]);
                if (tempQty != 0) {
                    mDbHelper.createListItem(listId, itemCursor
                            .getInt(itemCursor
                                    .getColumnIndex(GroceryDB.ITEM_ROWID)),
                            tempQty, 0);
                }
                i++;
                itemCursor.moveToNext();
            }
            dismiss();
        }
    }); 
```

您可以添加一个数组来跟踪复选框状态，然后使用它而不是 edittext 中的值来运行您的`if`语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:24:43.613

您可能需要 setItemsCanFocus 才能访问您在该行中的视图点击。

在 ListView 中查看这篇文章[Focusable EditText](https://stackoverflow.com/questions/2679948/focusable-edittext-inside-listview)

# javascript - href里面的小胡子

> ID：11218075
> 
> 赞同：11
> 
> 时间：2012-06-27T01:11:38.907
> 
> 标签：javascript, templates, mustache

我有这样的 JSON：

```
 { "something": "http://something.com" } 
```

和这样的HTML：

```
 <a href="{{something}}">{{something}}</a> 
```

当我申请 Mustache 时，我得到

```
 <a href="%7B%7Bsomething%7D%7D">http://something.com</a> 
```

但我想要得到的是

```
 <a href="http://something.com">http://something.com</a> 
```

我已经尝试过`{{{ something}}}`, `{{& something}}`，单引号，双引号......我什至阅读了文档。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-27T01:20:39.780

我认为你需要`&`结合使用 for escaping 并用模板脚本包围你的模板：

```
<script type="text/template" id="tmpl">
    <a href="{{& something }}">{{ something }}</a>
</script> 
```

[在这里](https://stackoverflow.com/a/8137794/74757)找到了这个例子。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-27T01:21:48.923

确保您的模板源是纯文本 - 不要尝试将已解析的 HTML 源作为您的模板。浏览器将对链接href中的那些字符进行urlencode/escape，并生成这些字符，`%7Bs`您`%7Ds`可以在代码中看到这些字符。小胡子不会承认这一点。

不过，我想取消传递给 mustache 的来源可能会起作用。

```
Mustache.render(unescape(source),view) 
```

# asp.net - 在我的 asp:menu 中更改链接的 CSS

> ID：11218082
> 
> 赞同：0
> 
> 时间：2012-06-27T01:12:29.390
> 
> 标签：asp.net, html, css

![我的菜单](../Images/400fa162ced36fee7b4d18dfc35746a2.png)

我改变了我的 asp.net 菜单样式。但我无法更改 <a href> 样式。看上图，链接的大小并没有得到<td>元素的所有大小。

有没有办法做到这一点？

这是我的 CSS

```
.menuItem
{
    height: 50px;
    font-weight: normal;
    font-style: normal;
    font-variant: normal;
    text-transform: none;
    background-color: #F5F5F5;
    width: 220px;
}

.menuItem a
{
    width:220px;
    height:50px;
} 
```

还有我的 HTML

```
<table class="menuItem MnuMain_4" width="100%" cellspacing="0" cellpadding="0" border="0">
   <tbody>
     <tr>
       <td style="white-space:nowrap;width:100%;">
         <a class="MnuMain_1 menuItem MnuMain_3" style="border-style:none;font-            size:1em;" target="main" href="Pages/Cadastro/CadPrograma.aspx">
         <img style="border-style:none;vertical-align:middle;" alt="" src="Imagens/Menu/btn-programa.png">
&nbsp;&nbsp;IDs
         </a>
      </td>
    </tr>
   </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:15:38.437

尝试将 display:block 添加到锚的 css。

```
.menuItem a
{
    display:block;
    width:220px;
    height:50px;
} 
```

# mysql - MYSQL 中的 NULL 和 NOT NULL

> ID：11218084
> 
> 赞同：-1
> 
> 时间：2012-06-27T01:12:44.860
> 
> 标签：mysql

我是mysql的新手。感谢您提前回答。

NULL 用于可以插入非值的字段，例如“拥有驾驶执照？” ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:17:52.993

A`NULL`通常用于表明该值未知，或者该字段没有值。

如果您问某人是否有驾照，他们可能会说是 ( `TRUE`) 或否 ( `FALSE`)。但是，如果您还没有问他们，或者他们没有回答问题，那么您不知道 ( `NULL`)。

很多时候，您希望禁止列包含`NULL`. 这可以通过将列声明为 来完成`NOT NULL`。

的用法`NULL`是一个非常有争议的话题。在数据库范式的原始定义中，具有可为空的列意味着您的设计不在[1NF](http://en.wikipedia.org/wiki/First_normal_form)中。较新的定义通常会放宽此约束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:15:58.450

是的，这是正确的。一些[进一步的阅读](http://dev.mysql.com/doc/refman/5.0/en/working-with-null.html)。

编辑：由于您的问题的措辞有点含糊，这是我对问题的解释：您想知道列定义中 NULL 与 NOT NULL 的语义。在您的示例中，“有驾驶执照”，似乎 NULL 是一个合理的值，例如，如果尚未回答问题，那么您希望允许 NULL。在这种情况下，是的，使用 NULL（虽然它是隐含的，所以不使用 NOT NULL 就足够了）。

# jquery-plugins - 带有数据表插件的 ember js

> ID：11218090
> 
> 赞同：1
> 
> 时间：2012-06-27T01:13:41.320
> 
> 标签：jquery-plugins, datatables, ember.js

我正在尝试使用 EMber JS 的数据表 jquery 插件。看起来 Ember 尝试使用一些新数据更新 DOM 的那一刻，在 datatable 设置样式并插入一些元素（如搜索栏、twitter 引导分页页脚等）后出现问题。代码如下

```
App.TableView = Em.View.extend({
    classNames:['table','table-striped','table-bordered','dataTable'],
    tagName:'table',
    didInsertElement:function (){
       this.$().dataTable({

           "sPaginationType": "bootstrap",
           "oLanguage": {
               "sLengthMenu": "_MENU_ records per page"
           }
       });
    }
}); 
```

车把中的用法如下：

```
{{#view App.TableView }}
        {{view App.ListStaffView}}
 {{/view}} 
```

App.ListStaffView 包含以下内容

```
App.ListStaffView = Ember.View.extend({
  templateName:    'list',
  staffBinding: 'App.staffController',

  showNew: function() {
    this.set('isNewVisible', true);
  },

  hideNew: function() {
    this.set('isNewVisible', false);
  },

  refreshListing: function() {
    App.staffController.findAll();
  }
}); 
```

列表模板如下

```
<thead>
                        <tr>
                        <th>Name</th>
                        <th>Email</th>
                        </tr>
                        </thead>
                        <tbody>
                        {{#each staff}}
                        {{view App.ShowStaffView staffBinding="this"}}
                        {{/each}}
                        </tbody>

                        <tfoot>
                        <div class="commands">

                        <a class="btn btn-inverse" href="#"{{action "showNew"}}>
                            <i class="icon-plus"></i>
                        </a>
                        <a class="btn btn-inverse" href="#"{{action "refreshListing"}}>
                            <i class="icon-refresh"></i>
                        </a>

                        </div>
                        </tfoot> 
```

加载后的错误是这样的

错误：无法对 Metamorph 执行操作

我使用零配置进行了数据表集成，但失败了。由于 Ember 无法将数据插入 DOM，因此 JQuery 数据表一直说“没有数据”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:56:45.307

数据表可以在一些预期的 DOM 结构上正常工作，Ember 也是如此。如果你同时使用两者，一个会修改另一个预期的 DOM 结构。这就是问题的原因。

如果您决定使用 Ember，请使用 Ember 小部件库（如 Flame.js）用于 TableViews。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T14:04:52.000

我遇到了同样的问题，并且能够通过在包含表的视图上调用 rerender() 来解决这个问题。

例如，在我看来，我有一个名为 editRow() 的方法，它将表格文本更改为输入框。这是我的做法：

```
    编辑行：函数（事件）
    {
        var obj = event.context;
        obj.setIsEditing(true);
        this.rerender();
    }

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-02T09:02:52.457

您不能`#each`在将被 DataTables 表“覆盖”的表中使用 Helper。

# jquery - 使用 JQuery 隐藏元素失败

> ID：11218092
> 
> 赞同：0
> 
> 时间：2012-06-27T01:13:56.473
> 
> 标签：jquery

有人能告诉我在这个使用 JQuery 的简单隐藏元素脚本中我做错了什么吗？当我单击按钮时，它意味着隐藏免责声明标签中的文本。谢谢。

索引.html：

```
<!DOCTYPE HTML">
<html>
<head>
<title></title>
<meta name="" content="">
<script src="script.js" type="text/javascript"></script>
<script type='text/javascript' src='jquery.js'></script>
</head>
<body>
<input type="button" id="hideButton" value="hide"/>

<div id="disclaimer">
<p>This is a disclaimer</p>

</div>

</body>
</html> 
```

脚本.js：

```
$('#hideButton').click(function() {

    $('#disclaimer').hide();

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:15:41.887

等到你的dom加载然后加载脚本

演示：http: [//jsfiddle.net/epinapala/Pm2k6/3/](http://jsfiddle.net/epinapala/Pm2k6/3/)

```
<!DOCTYPE HTML">
<html>
<head>
<title></title>
<meta name="" content="">
<script src="script.js" type="text/javascript"></script>
<script type='text/javascript' src='jquery.js'></script>
</head>
<body>
<input type="button" id="hideButton" value="hide"/>

<div id="disclaimer">
<p>This is a disclaimer</p>

</div>
    <script>
    $('#hideButton').click(function() {

    $('#disclaimer').hide("slow");

});
    </script>
</body>
</html> 
```

或者，您可以使用

```
$(document).ready(function(){
//this will be executed after dom is loaded.
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:15:53.190

```
$(document).ready(function(){
$('#hideButton').click(function() {

    $('#disclaimer').hide();

});
}); 
```

您应该将其附在准备好的文档中，也可以在之前
参考`jquery.js``script.js`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T01:24:19.610

另一种方式

```
<div id="disclaimer" style="block">
<p>This is a disclaimer</p>

</div>

<script>
$('#hideButton').click(function() {

   $('#disclaimer').css('display','none');

});
 </script> 
```

# php - PHP 扩展至 MySQLI 类

> ID：11218094
> 
> 赞同：0
> 
> 时间：2012-06-27T01:13:59.780
> 
> 标签：php, mysqli

我创建了一个类，将我的类扩展到 PHP 中的 mysqli 类，看到这些错误我真的很震惊

```
Warning: Missing argument 1 for BeatBeast_Database::__construct(), called in C:\xampp\htdocs\beatbeast\login.php on line 11 and defined in C:\xampp\htdocs\beatbeast\includes\Db\BeatBeast_Db.php on line 6

Warning: Missing argument 2 for BeatBeast_Database::__construct(), called in C:\xampp\htdocs\beatbeast\login.php on line 11 and defined in C:\xampp\htdocs\beatbeast\includes\Db\BeatBeast_Db.php on line 6

Warning: Missing argument 3 for BeatBeast_Database::__construct(), called in C:\xampp\htdocs\beatbeast\login.php on line 11 and defined in C:\xampp\htdocs\beatbeast\includes\Db\BeatBeast_Db.php on line 6

Warning: Missing argument 4 for BeatBeast_Database::__construct(), called in C:\xampp\htdocs\beatbeast\login.php on line 11 and defined in C:\xampp\htdocs\beatbeast\includes\Db\BeatBeast_Db.php on line 6 
```

这是 BeatBeast_Db.php

```
<?php
    class BeatBeast_Database extends mysqli
    {

        protected $r = 'Something';
        public function __construct($db_host,$db_username,$db_password,$db_name)
        {
            parent::__construct($db_host,$db_username,$db_password,$db_name);

            if(mysqli_connect_error())
            {
                die('Connect Error (' . mysqli_connect_errno() . ')' . mysqli_connect_error());
            }
        }

        public function close()
        {
            $this->close();
        }

    }

    require_once("db_constants.inc.php");
    $conn = new BeatBeast_Database("localhost", "root", "myPass", "beatbeast"); 
```

这是我的 login.php

```
<?php require_once("./includes/Utilities.php") ;?>
<?php require_once("./includes/Db/DatabaseUtilities.php"); ?>
<?php require_once("./includes/Db/Accounts.php");?>
<?php require_once("./includes/Db/BeatBeast_Db.php"); ?>

<?php 
    if(isset($_POST['submit'])){
        require_once("./includes/process_form.inc.php");

        $hashedPass = crypt($password,$username);
        $accounts = new Accounts();
        $accounts->showMessage(); 
```

第 11 行是

```
$accounts = new Accounts(); 
```

如果你们有兴趣，这里是我的 Accounts 课程

require_once("BeatBeast_Db.php");

```
Class Accounts extends BeatBeast_Database
{
    private $accnt_id;
    private $username;
    private $email;

    function info()
    {

        echo "{$this->accnt_id} {$this->username} {$this->email}";
    }

    public static function getIdByUsername($username)
    {
        global $conn;
        $sql = "SELECT accnt_id FROM accounts WHERE username = '{$username}'";
        $rs = $conn->query($sql);
        $found = $rs->fetch_array();
        return $found;
    }

    public function showMessage(){
        echo "{$this->r}";
    }

    public static function getUsernameById($id)
    {
        global $conn;
            $sql = "SELECT username FROM accounts WHERE accnt_id = $id ";
        $rs = $conn->query($sql);
        $found = $rs->fetch_array();
        return $found;
    }

    public function getAccntId()
    {
        return $this->accnt_id;
    }

    public function getUsername()
    {
        return $this->username;
    }

    public function getEmail()
    {
        return $this->email;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:23:19.553

如果您查看 MySQLi 的 PHP 参考（http://www.php.net/manual/en/class.mysqli.php），原始类构造函数包含 6 个参数：

```
__construct ([ string $host = ini_get("mysqli.default_host") [, string $username = ini_get("mysqli.default_user") [, string $passwd = ini_get("mysqli.default_pw") [, string $dbname = "" [, int $port = ini_get("mysqli.default_port") [, string $socket = ini_get("mysqli.default_socket") ]]]]]] ) 
```

扩展 MySQLi 时，您必须定义所有这些，即使您不使用。但是，这不是导致警告错误的原因。

在您的情况下，您在调用`$accounts = new Accounts();`时没有定义任何参数。虽然，`Accounts`类范围`BeatBeast_Database`。因此，您需要传递所有`BeatBeast_Database`构造函数参数 ( `$db_host,$db_username,$db_password,$db_name`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:34:18.670

让我们从 login.php 第 11 行开始

```
$accounts = new Accounts(); 
```

这调用了`Accounts`类的构造函数——没有定义。自从

```
Class Accounts extends BeatBeast_Database 
```

PHP 回退到类的构造函数`BeatBeast_Database`：

```
public function __construct($db_host,$db_username,$db_password,$db_name) 
```

它需要 4 个参数，但没有得到 - 正是错误消息中的内容。您需要将第 11 行更改`login.php`为

```
$accounts = new Accounts(DB_HOST, DB_USER, DB_PASSWD, DB_NAME); 
```

或者但是您定义的常量`db_constants.inc.php`已被清除。

# security - GDB 调试特定崩溃

> ID：11218096
> 
> 赞同：1
> 
> 时间：2012-06-27T01:14:23.003
> 
> 标签：security, gdb

假设我正在尝试为某个软件开发一个漏洞利用程序，它可以以两种不同的行为做出响应：一种是由于不正确的变量分配导致进程崩溃，另一种是我获得了 EIP 的控制权并返回到无效地址。这两种不同行为的原因是由于 ASLR，并且因为我只有部分信息泄漏，所以我被迫进行一些暴力破解。我希望程序仅在修改 EIP 时中断。但是，由于进程不断崩溃和重生，我无法告诉程序只有在修改 EIP 时才停止；无论如何，该进程将始终在 GDB 中崩溃。我怎样才能克服这个困难？（考虑将其发布在 IT Security 中，但决定在这里会更好，因为这与 GDB 有更多关系）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:19:46.433

您应该在内存损坏发生之前[设置断点。](http://www.unknownroad.com/rtfm/gdbtut/gdbbreak.html)在崩溃的那一刻，gdb 将中断，您可以使用该命令`show stack`告诉您希望它认为调用堆栈是，但是如果您已经损坏了 EIP，那么您已经部分损坏了函数的堆栈框架，`show stack`并将部分损坏（取决于你粉碎了多少堆栈！）。但是，此过程可以帮助缩小发生内存损坏的位置，并且您始终可以在调用堆栈的较高位置设置断点并逐步执行程序。

GDB 还具有[反向调试](http://sources.redhat.com/gdb/news/reversible.html)，这可能是一种更简单的方法，因为您可以在崩溃后向后退一步。但是，此功能是相当新的。通常黑客必须使用上述技术。

# c++ - “容器”和“数据结构”有什么区别？

> ID：11218100
> 
> 赞同：11
> 
> 时间：2012-06-27T01:15:31.510
> 
> 标签：c++, algorithm, data-structures

什么是容器？据我了解：

*   抽象数据类型只是数据存储方式的逻辑描述，以及允许对该数据执行的操作。例如，堆栈被定义为具有推送、弹出等操作和 LIFO 访问的数据类型。

*   数据结构是这个抽象定义的实际实现，在某些计算机编程语言中，例如，C++ 中的堆栈在标准库中实现为 std::stack。

首先，请纠正/增强我目前对上述区别的理解。

其次，究竟什么是容器？我经常听到这个词。和我对数据结构的定义一样吗？

此外，维基百科为这些术语提供了三个单独的条目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:19:41.247

真的没什么。正如我们人类喜欢做的那样，它们只是同一个词的两个词。但是，afaik，官方的 CS 术语是数据结构，而 C++ 标准对 Container 有特定的 C++ 要求。但是，一般来说，它们是等价的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:26:45.927

您对 ADT 与数据结构的印象是正确的——尽管它们在很大程度上是可以互换的。ADT 是*明确*抽象的，数据结构是一个更通用的术语，可以是完全抽象的，也可以指实现细节。

容器是一个非常抽象的概念，但通常它意味着（无论如何对我而言）某种形式的封装——从某种意义上说，它可能掩盖底层对象的复杂性，或者可能为一系列不同的可能底层对象提供统一的接口。这是一个深深植根于程序员词汇中的词，人们一直在使用它，因此它的含义非常模糊。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T01:37:05.987

容器是数据结构的子集。C++ 对容器提出了特殊要求，容器是不同数据结构的实现。

根据维基百科，数据结构是“一种存储和组织数据的特定方式”。容器是一个 C++ 结构，它是记录的集合，它本身就是一个数据结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T14:56:56.867

正如其他人所说，这些术语使用如此广泛，以至于它们具有各种含义，但这是我最常遇到的用法。

数据结构是计算机科学中的一个术语，它可以用于理论讨论而无需参考任何特定语言。在有关算法的书籍中讨论了许多数据结构，例如队列、树、哈希表……数据结构几乎可以用任何语言实现。

容器是一个术语，而是在特定语言的背景下使用，当程序员可以立即使用已经实现的容器的可用库时。几个不同的库可以实现相同的（抽象的）数据结构（例如，简单的链表），但具有不同的容器，即不同的源代码和不同的名称（一个可以称为“队列”，另一个可以称为“fifo”，以及第三个“堆栈”）。

此外，容器必须是存储其他类型的一种方式，例如向量存储整数。举个例子，在内存中表示一个图有几种方式：邻接矩阵、邻接表、前向星...这些都是数据结构，但它们不是容器，因为它们不包含其他类型，它们只是表示图的节点和链接。这些数据结构存储的数据是节点和链接。

# c - 链接列表未正确打印

> ID：11218106
> 
> 赞同：3
> 
> 时间：2012-06-27T01:16:14.150
> 
> 标签：c, linked-list

我一直在尝试制作一个简单的程序来接受用户输入，直到他们按下完成。当他们这样做时，程序将打印出他们输入的所有内容。我觉得我已经完成了大部分工作，并且程序编译得很好，但是当我输入输入然后按完成时，它将输出完成的行数与输入输入的行数一样多。我已经画出来了，感觉这段代码应该可以工作。我对 C 也很陌生。所以如果有人可以让我知道什么是错的，甚至给我建议。

```
#include <stdio.h>
#include <stdlib.h>

struct llist {          
struct llist* nxt; 
char* string;
};              

void add(struct llist **tail, char* str) { 
    struct llist* n_ptr = (struct llist*)malloc(sizeof(struct llist));
    (**tail).string = str; 
    (**tail).nxt = n_ptr;   
        (*tail) = n_ptr; 
    n_ptr->nxt = (struct llist*)0;
};

void print(struct llist *Head) {
    struct llist* ptr;
    ptr = Head;
    while(ptr->nxt){ 
        printf("%s\n", ptr->string);
        fflush(stdout);
        (ptr = (ptr->nxt)); }
}

int main() {
    char* line = NULL;
    size_t size = 100; 
    char* done = "done";

    struct llist head; 
    struct llist* tail = (struct llist*)malloc(sizeof(struct llist));

    tail = &head; 

    do { 
    getline(&line, &size, stdin); 
    add( &tail , line ) ;   
    } while ( strncmp(line, done, 4) != 0 );

    print(&head);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:24:42.297

您的列表仅包含*指向*数据的指针，而不包含数据本身。因此，如果添加到列表中的数据发生变化，则列表中的数据*也会*发生变化。每次调用`add`,`str`都是一样的。因此，您只是一遍又一遍地将相同的指针添加到列表中。

为了快速而丑陋的修复，请更改：

```
(**tail).string = str; 
```

到：

```
(**tail).string = strdup(str); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:33:46.783

一些笔记给你。

*   `getline()`接受一个指向缓冲区的指针。文本将存储在指针所说的任何位置。你的文字会去哪里？你应该这样做：

`line = malloc(size);`

也许

`char line[100];`

这些中的任何一个都可以解决问题。但是由于`getline()`如果缓冲区不够大，它将动态增长缓冲区，因此该`malloc()`解决方案可能更可取。（我不知道当它动态增长缓冲区时是否`getline()`会尝试调用`free()`；如果是，那么这个`malloc()`是非常可取的。）

编辑：您可以忽略以上几点！事实证明这`getline()`很聪明，如果你从一个空指针开始，它会为你分配一个缓冲区。所以你的代码是正确的。对于那个很抱歉; 我不熟悉`getline()`。

*   您的链表代码主要调用`malloc()`以创建新节点。但是由于某种原因，您`head`静态地声明了一个单独的节点 to be 。像这样的小程序没问题，但如果你写过一个大程序，那会很混乱；当你去释放链表时，你需要小心不要释放第一个节点（因为它不是使用 分配的`malloc()`）。就我个人而言，我会将两者`head`都`tail`设置为指针，并将它们都设置为`NULL`（对于长度为零的链表）。最简单的方法是让你的`add()`函数接受`head`指针的参数，并设置它`head`将第一个结构添加到链表时。您还需要小心一点，因为当您将第一个结构添加到链表时，您`tail`的尚未设置，因此您不应该尝试在有一个节点之前将新节点链接到前一个节点. 因此，您的第一次调用`add()`应该设置`head`并`tail`指向您的结构的全新实例，并且新实例的`next`指针应该设置为 null；然后其他调用`add()`应该将新结构链接到现有的链表。

*   在实际程序中，您总是会检查函数的返回值。有可能`malloc()`失败；你不应该只是假设它总是有效的。但如果你是为一堂课做这个，而且你不必做那些错误检查，我想你可以跳过它。不过，尽早学习谨慎的习惯永远不会有坏处。

*   正如@David Schwartz 的回答中所述，您应该致电`strdup()`获取每个字符串的副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T01:38:22.673

```
struct llist head; 
struct llist* tail = (struct llist*)malloc(sizeof(struct llist));

tail = &head; 
```

我还想指出，这里的 malloc 是不必要的。无论如何，您都会丢弃它，第三行的分配会导致内存泄漏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T02:40:36.943

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef enum {FAILURE, SUCCESS} ReturnType;

typedef struct node_t Node;
struct node_t {
    Node* next;
    char* data;
};

Node* nodeCreate(char* str) {
    Node* res = (Node*) malloc(sizeof(Node));
    if (res == NULL) {
        return NULL;
    }

    res->data = (char*) malloc(strlen(str) + 1);
    if (res->data == NULL) {
        free(res);
        return NULL;
    }

    strcpy(res->data, str);
    res->next = NULL;

    return res;
}    

void nodeDestroy(Node* node) {
    free(node->data);
    free(node);
}    

typedef struct list_t {
    Node* head;
    Node* tail;
} List;

List* listCreate() {
    List* res = (List*) malloc(sizeof(List));
    if (res == NULL) {
        return NULL;
    }

    res->head = (Node*) malloc(sizeof(Node));
    if (res->head == NULL) {
        free(res);
        return NULL;
    }
    res->head->next = NULL;
    res->head->data = NULL;
    res->tail = res->head;

    return res;
}

void listDestroy(List* list) {
    if (list == NULL) {
        return;
    }

    Node* curr = list->head;
    Node* next = NULL;

    while (curr != NULL) {
        next = curr->next;
        nodeDestroy(curr);
        curr = next;
    }
    free(list);
}

ReturnType listAdd(List* list, char* str) {
    if (list == NULL) {
        return FAILURE;
    }

    Node* newNode = nodeCreate(str);
    if (newNode == NULL) {
        return FAILURE;
    }

    list->tail->next = newNode;
    list->tail = list->tail->next;

    return SUCCESS;
};

void listPrint(List* list) {
    if (list == NULL) {
        return;
    }

    Node* curr = list->head->next;
    while(curr != NULL){
        printf("%s\n", curr->data);
        curr = curr->next;
    }
}

#define MAX_LINE_SIZE 100

int main() {
    setvbuf(stdout, NULL, _IONBF, 0);
    char line[MAX_LINE_SIZE];
    char* done = "done";

    List* list = listCreate();
    if (list == NULL) {
        fprintf(stderr, "Failure!\n");
        return 0;
    }

    do {
        scanf("%s", line);
        if (listAdd(list , line) == FAILURE) {
            fprintf(stderr, "Failure!\n");
            listDestroy(list);
            return 0;
        }
    } while (strncmp(line, done, 4) != 0);

    listPrint(list);

    listDestroy(list);

    return 0;
} 
```

# javascript - 在 Knockout.js 模板中保留 Razor 语法突出显示

> ID：11218107
> 
> 赞同：1
> 
> 时间：2012-06-27T01:16:15.163
> 
> 标签：javascript, asp.net-mvc, visual-studio, razor, knockout.js

我的 Web 应用程序是带有 Razor 和 Knockout.js 的 ASP.NET MVC4。视图模型层次结构变得相当深和复杂，我更倾向于为相应的视图使用嵌套的 Knockout 模板（每个视图都有一个 for/each 用于其子模板等），而不是单一的 HTML 板。

让我烦恼的是，当使用内容的 Knockout 模板定义语法时，`<script type="text/html" id="scary-template">`它会在 Visual Studio 中失去其 Razor 语法突出显示，因为它被解释为脚本。模板足够复杂，没有文本也都是纯黑色的。

我考虑过的一些方法是使用 Html.Raw 来输出开始和结束脚本标签，或者像 Html.BeginKOTemplate(id) 这样的 HtmlHelper 扩展。

我很想听听其他 ASP.NET MVC 人员如何处理这个问题。我是不是很迂腐？无论如何，下一个需要选择此解决方案的开发人员可能会感谢我的关心。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T01:56:46.050

我不使用 Visual Studio，但我有一些对你有用的建议。

从 Knockout 2.1 开始，您可以使用`textarea`标签定义模板，这将支持许多编辑器中的语法高亮（包括我使用的两个，phpDesigner 和 Notepad++）。为了确保`textarea`它实际上没有显示在页面上，它必须具有`display:none`样式（或位于具有该样式的容器中）。

```
<textarea id="mytemplate" style="display:none">
    <div>template content</div>
</textarea> 
```

或者

```
<div style="display:none">
    <textarea id="mytemplate">
        <div>template content</div>
    </textarea>
</div> 
```

您还可以使用任何标签，例如`div`定义模板。但这增加了一些开销。首先，模板内容将被浏览器解析（并且可能修改）。其次，除非您另有指示，否则它将由 Knockout 解析。您可以通过将容器节点传递给`applyBindings`不包含模板节点的容器节点，或者通过创建绕过模板绑定的自定义绑定来做到这一点（参见`allowBindings` [此处](http://knockoutjs.com/documentation/custom-bindings-controlling-descendant-bindings.html)）。当然，你仍然需要这种`display:none`风格。

```
<div style="display:none" data-bind="allowBindings:false">
    <div id="mytemplate">
        <div>template content</div>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T03:20:53.820

我已经创建了一个 HtmlHelper 扩展，它返回一个实现 IDisposable 的 KnockoutTemplate 类：

```
public static KnockoutTemplate KnockoutTemplate(this HtmlHelper htmlHelper, string templateID)
    {
        return new KnockoutTemplate(templateID, htmlHelper.ViewContext.Writer);
    }

public class KnockoutTemplate: IDisposable
{
    private TextWriter _textWriter;
    private bool _disposed;

    public KnockoutTemplate(string templateID, TextWriter textWriter)
    {
        _textWriter = textWriter;

        _textWriter.WriteLine(String.Format("<script type=\"text/html\" id=\"{0}\">", templateID));
    }

    public void EndTemplate()
    {
        Dispose(true);
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (!_disposed)
        {
            _disposed = true;
            _textWriter.WriteLine("</script>");
        }
    }
} 
```

像这样使用：

```
@using (Html.KnockoutTemplate("sum-assured-template"))
{
<div>Template markup...</div>
} 
```

进一步考虑，我不喜欢使用 div 的想法，模板本身的标记将被浏览器解释为模板实例，所以我现在坚持使用脚本块方法，但至少我可以如果我愿意，可以稍后在一个地方更改所有实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T13:12:44.577

就个人而言，我使用[淘汰赛外部模板引擎](https://github.com/ifandelse/Knockout.js-External-Template-Engine)从其他文件动态加载模板。这有其自身的优点和缺点，但一个很好的副作用是模板可以存储在 .html 文件中并且根本不需要包装 - 保留所有语法突出显示。外部模板引擎不仅使用脚本标签的 id，还将在您告诉它的模板名称（例如 mytemplate.html）的任何目录中查找文件。

根据我的经验，这也倾向于使项目更有条理，并有助于促进项目之间的代码重用。唯一的缺点是下载更多文件会增加延迟 - 这实际上可以通过延迟加载来提高性能，因为它只会在需要时加载模板（并且不会对同一个模板发出多个请求）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T03:24:50.323

只是一个快速的建议，像我在这里描述的那样分开 JavaScript 和 Razor：[https ://stackoverflow.com/a/11109799/538387](https://stackoverflow.com/a/11109799/538387)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-21T00:00:36.273

使用 Razors 局部视图来克服这个问题。

```
<script type="text/html" id="launchTemplate">
   @Html.Partial("Templates/_LaunchView", null)
</script> 
```

上述语法允许您将模板保存在单独的文件中。在该文件中，您将获得完整的 razor 语法突出显示（更不用说重新格式化）

# jquery - 使用 emberjs didInsertElement 显示两个单独的日历或两个实例一个 jquery fullcalendar 插件对象

> ID：11218108
> 
> 赞同：2
> 
> 时间：2012-06-27T01:16:19.243
> 
> 标签：jquery, fullcalendar, ember.js

我有一个使用 jquery fullcalendar 和 emberjs 可以正常显示的日历对象。但是，我需要显示一个单独的第二个日历或另一个 jquery fullcalendar 实例，但第二个日历迄今未能显示。这是显示它的小提琴：http: [//jsfiddle.net/uUWqf/4/](http://jsfiddle.net/uUWqf/4/)。你会在小提琴中看到我尝试调用 didInsertElement: function() {} 两次，但它仍然只显示一个日历。但是，当我使用没有 emberjs 的 jquery fullcalendar 时，会显示两个单独的日历：http: [//jsfiddle.net/CH4qa/2/](http://jsfiddle.net/CH4qa/2/)。

有没有办法让它工作。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T03:20:25.957

我用你的小提琴制作了一个叉子，可以渲染两个日历。[http://jsfiddle.net/duHfN/7/](http://jsfiddle.net/duHfN/7/)

一般来说，使用模板实例化视图而不是创建视图实例并在它们上调用 append 会更好。小提琴还有许多其他问题，我清理了一些。

# asp.net-mvc-3 - 在对话框中打开局部视图，执行控制器操作，然后关闭

> ID：11218110
> 
> 赞同：0
> 
> 时间：2012-06-27T01:16:24.970
> 
> 标签：asp.net-mvc-3, jquery-ui

我有一个带有索引、编辑、创建和详细信息视图的案例模型。我有一个案例控制器。当用户在案例的编辑视图中时，我希望他们能够单击一个按钮，该按钮打开一个带有部分视图的 jQuery 对话框，以将投诉代码添加到案例中。这是部分视图：

```
@model IEnumerable<cummins_db.Models.ComplaintCode>

@{
    ViewBag.Title = "Case Complaint Codes";
}

<h2>Select a complaint code</h2>

<table>
    <tr>
        <th></th>
        <th>
            Complaint Code Name
        </th>
        <th>
            Complaint Type
        </th>
    </tr>

@try
    {
    foreach (var item in Model)
        {
    <tr>
        <td>
            @Html.ActionLink("Select", "SelectForCase", new { id = item.ComplaintCodeID})
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ComplaintCodeName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ComplaintType)
        </td>
    </tr>
        }
    }
catch
{
}

</table> 
```

用户可以选择部分视图列表中显示的数据，并将其作为多对多关系添加到他们打开的编辑记录中。我正在使用局部视图中的这个控制器方法来添加 MTM 记录。

```
public void SelectForCase(int id)
        {
        int cid;
        cid = casesid;

        if (ModelState.IsValid)
            {
            CaseComplaint c = new CaseComplaint
            {
                CasesID = cid,
                ComplaintCodeID = id
            };
            db.CaseComplaints.Add(c);
            db.SaveChanges();
            }
        } 
```

问题是这个动作触发后，jQuery 模式对话框和编辑视图关闭。我只想关闭 jQuery 对话框并允许用户继续编辑案例记录。

部分视图正在做它需要做的事情，但我需要保持编辑视图打开。

这是从编辑视图操作链接调用并在对话框中打开部分视图的 jQuery：

```
$(document).ready(function () {
    $('.addComplaintLink').button();

    $('#AddComplaintDialog').dialog(
    {
        autoOpen: false,
        width: 400,
        resizable: false,
        modal: true,
        buttons:
        {
            "Cancel": function () {
                $(this).dialog('close');
            }
        }
    });

    $('.addComplaintLink').click(function () {
        linkObj = $(this);
        var dialogDiv = $('#AddComplaintDialog');
        var viewUrl = linkObj.attr('href');
        $.get(viewUrl, function(data) {
            dialogDiv.html(data);
        //open dialog
        dialogDiv.dialog('open');
        });
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T15:27:59.407

如果我理解正确，您需要`AJAX`在您的部分中使用。

所以不要使用：

```
@Html.ActionLink("Select", "SelectForCase", new { id = item.ComplaintCodeID}) 
```

尝试：

```
@Ajax.ActionLink("linkText", "SelectForCase", new { id = item.ComplaintCodeID},
                   new AjaxOptions() {...}) 
```

[阅读更多：http://msdn.microsoft.com/en-us/library/dd493139]

或者尝试使用 jQuery.Ajax 更新您的模型，而不是回发整个视图。

# java - Java - JDBC 在 Eclipse 而非 CL 中工作

> ID：11218114
> 
> 赞同：0
> 
> 时间：2012-06-27T01:17:10.383
> 
> 标签：java, jdbc

因此，下面的代码在 Eclipse 中有效，但在 CL 中无效。我认为它与 JDBC 连接器有关，但我不确定。它没有给我任何错误，只是没有执行。例如，它甚至不会打印“EDF”。有什么建议么？

```
 //Connection conn = null;
    String url = "jdbc:mysql://localhost/";
    String db = "db";
    String driver = "com.mysql.jdbc.Driver";
    String table = "order_queue";
    Connection conn = null;

    // Upload trade data to order_queue table
    try {
        Class.forName(driver);
        System.out.print("EDF");
        try {
            conn = DriverManager.getConnection(url+db,"root","");
            Statement st = conn.createStatement();
            String sql = "INSERT INTO " + table + " (name) VALUES("APPLE");
            st.executeUpdate(sql);
            conn.close();

        } catch (SQLException s) {
            s.printStackTrace();
            orderMessage = "ERROR: Problem executing order.  Please try again!";
        }
    } catch (ClassNotFoundException cnfe){
        orderMessage = "ERROR: Problem connecting to OMS database.  Contact technical support or try again later."; 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:33:29.227

试试：java -cp /path/to/jdbc/driver.jar:。你的主类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:21:11.977

原因是这一行：

```
Class.forName(driver); 
```

MySQL JDBC 驱动程序不在您的类路径中。如果您想确保这是原因，请在代码中添加一行：

```
 } catch (ClassNotFoundException cnfe){
        orderMessage = "ERROR: Problem connecting to OMS database.  Contact technical support or try again later."; 
        cnfe.printStackTrace();

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:54:17.817

如果它不打印 EDF，则说明您在加载库时遇到问题。您是否添加了对该库的引用？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T02:16:06.277

我建议您在外部 try catch 块中捕获异常。因此，任何其他您不知道的异常都会被捕获并打印出来。您是否在 CL 类路径中加载了 mysql 连接器 java jar 文件？（顺便问一下，什么是 CL？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T02:28:22.963

这在 eclipse 中起作用的原因可能是因为您已将其添加到项目的 eclipse 类路径中，因此它会自动包含在您运行的任何主程序中。

对于命令行，请确保您的类路径设置正确：

```
java -cp classes:/path/to/driver.jar MainClass 
```

这里重要的部分是“-cp /path/to/driver.jar”。“-cp”参数应该包括所有的 jars（在 *NIX 上用 : 分隔，在 windows 上用 ; 分隔）以及存储类的目录。

或者，使用您的 jar 文件在某处创建一个“lib”目录，然后执行以下操作：

```
java -cp "classes:lib/*"  MainClass 
```

当 java 看到类似 * 时，它假定您要查找指定目录中的所有 jar 文件。

# c# - ASP.NET 如何在应用程序请求模块中访问 User.Identity.IsAuthenticated？

> ID：11218117
> 
> 赞同：2
> 
> 时间：2012-06-27T01:17:37.203
> 
> 标签：c#, asp.net, c#-2.0, asp.net-2.0, form-authentication

我在 ASP.Net 中使用表单身份验证方法，问题是它只保护“ *.aspx”文件。我正在尝试保护“* kcfinder”文件夹中的“.php”文件免受未经身份验证的用户的侵害。

我在“App_Code”文件夹中实现了这个类。

```
public class KCChecker
{
        public static void Process(HttpApplication Application)
    {
           HttpRequest Request = Application.Context.Request;
           HttpResponse Response = Application.Context.Response;
           string url = Request.Path.ToLower();
           if (url.IndexOf("/kcfinder/") == 0 && !HttpContext.Current.User.Identity.IsAuthenticated)
            {
            Response.Redirect("/");
            }
        }
} 
```

问题是它总是说“对象引用未设置为对象的实例”。上`HttpContext.Current.User.Identity.IsAuthenticated`。我尝试将其更改为，`Application.Context.User.Identity.IsAuthenticated`但仍然显示相同的错误。

有什么方法可以在这个自定义模块的 Process 函数中访问用户对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T08:50:24.803

将以下内容添加到您的 web.config 文件中：

```
<modules runAllManagedModulesForAllRequests="true" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:39:40.833

[HttpApplication.PostAuthenticateRequest 事件](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.postauthenticaterequest)

将 PostAuthenticateRequest 的事件处理程序添加到您的 HttpModule 并从那里调用您的 Process(HttpApplication) 方法。

```
public class AuthModule : IHttpModule
{
    public void Init(HttpApplication context)
    {
        context.PostAuthenticateRequest += new EventHandler(context_PostAuthenticateRequest);
    }

    public void Dispose() { }

    void context_PostAuthenticateRequest(object sender, EventArgs e)
    {
        var isAuthenticated = ((HttpApplication) sender).Context.User.Identity.IsAuthenticated;
    }
} 
```

# iphone - UITableViewCell 出队的内存被保留

> ID：11218121
> 
> 赞同：0
> 
> 时间：2012-06-27T01:17:58.230
> 
> 标签：iphone, ios, memory, uitableview, reusability

我有一个项目，其中一个 UITableView 可以有数百个条目（我保证出于测试目的）。我正在测试如何使用 UITableViews，因为我对它们非常陌生，并且遇到了一些我不喜欢的东西。

如果您使用 dequeueReusableCell 它的威严，它工作得很好！例如，我有一个将 100 个自定义单元格添加到自定义表格视图的按钮。一切都很完美

问题是当我删除这些单元格时！我从数据库中删除信息，然后从 tableView 和 reloadData 中删除单元格。一切都很好，除了 CustomTableViewCells 永远不会被释放！！！问题？我认为不是因为我使用的是出队系统，而是因为数百个单元格正在进入和退出表格视图，并且没有一个单元格被释放，因此未使用的 TableViewCells 内存在 inf 堆积！

哦，诺兹！

有人找到解决这个问题的方法吗？以某种方式限制重用单元格的数量，以便说在 50 个重用单元格之后，他们为了内存而开始解除分配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T15:30:46.643

1.  您提到您“从 tableView 中删除单元格”，然后`reloadData`. 但是你不应该删除单元格。您只需`reloadData`和 iOS 负责清理您的表格并重用您的表格视图单元格（当然，假设您`cellForRowAtIndexPath`的调用正确`dequeueReusableCellWithIdentifier`）。或者你只是想说你`reloadData`和你让 iOS 发挥它的魔力？

2.  无论如何，如果您包含您的代码，我们可以帮助您找到您的问题。

3.  我建议通过静态分析器 ( `shift`++ `command`)运行您的代码`B`，这可能会帮助您找到问题。使用静态分析仪可以立即发现许多简单的泄漏。您应该有来自静态分析器的*零*警告。

4.  如果您仍在泄漏，请使用分析器[查找您的泄漏](https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/ViewingandAnalyzingData/ViewingandAnalyzingData.html#//apple_ref/doc/uid/TP40004652-CH5-SW22)。

# c# - 已经有一个打开的数据阅读器 - Mysql - C# 我处理连接

> ID：11218122
> 
> 赞同：0
> 
> 时间：2012-06-27T01:18:15.567
> 
> 标签：c#, mysql

这让我发疯，我不知道为什么它会抛出这个错误。

这是我的 Program.cs

```
MySQLProcessor.Connection = MySQLProcessor.OpenCon();
        MySQLProcessor.ThreadingConnection = MySQLProcessor.OpenCon();
        DataTable All_Websites_DataTable =  MySQLProcessor.DTTable("select BaseURL,subURL from CouponExtractor.tblUrls where GroceryStoreBit = b'0'",MySQLProcessor.Connection);
        MySQLProcessor.Connection.Dispose();
Semaphore _pool = new Semaphore(1, 50);
        Parallel.ForEach(All_Websites_DataTable.AsEnumerable(), website_DataRow =>
        {
            _pool.WaitOne();
            //additional_subURL is used to crawl threw additional URLs until unqiue value is hit
            int additional_subURL = 0;
            Catch_Old_Values = false;

            string baseURL = All_Websites_DataTable.ItemArray[0].ToString();
            string subURL = All_Websites_DataTable.ItemArray[1].ToString();
            string complete_url = string.Empty;

            //need a bool to check homepage without crawling subpages
            bool check_homepage = true;
            complete_url = baseURL + "/" + subURL.Replace("@", additional_subURL.ToString());
            string mysqlquery_siteprocesslog = "insert into tbllogs(message,timestampcolumn) Values('Processing: " + complete_url + "',Now())";
            MySQLProcessor.MySQLInsertUpdate(mysqlquery_siteprocesslog,MySQLProcessor.ThreadingConnection);

            //as long as catch_old_values is false, the app will continue crawling the website until it hits an old value
            while (Catch_Old_Values == false)
            {
                additional_subURL++;

                if (additional_subURL >= 7)
                {
                    Catch_Old_Values = true;
                    break;
                }
                else if (check_homepage == true)
                {
                    //set check_homepage to false because we will crawl the homepage and dont want to do it again.
                    check_homepage = false;
                    SiteProcessing.ProcessSite(baseURL, baseURL);

                }
                else
                {
                    complete_url = baseURL + "/" + subURL.Replace("@", additional_subURL.ToString());
                    SiteProcessing.ProcessSite(complete_url, baseURL);
                }

            }
            _pool.Release();
        }); 
```

对于帖子的长度，这里是 SiteProcessing 访问 MysqlProcessor 的唯一部分

```
 if (hotitem == true)
                    {
                        string mysqlquery_InserthotResults = "insert into couponextractor." + targetTable + " (BaseURL,Description,realURL,TimeStampcolumn,uniqueKey,hotkey) Values ('" + baseURL + "','" + description.Replace("'", "") + "','" + realURL + "',Now(),'" + uniqueKey.Replace("'", "") + "','" + hotitemkey + "')";
                        MySQLProcessor.MySQLInsertUpdate(mysqlquery_InserthotResults, MySQLProcessor.ThreadingConnection);
                    }
                    else
                    {
                        string mysqlquery_InsertResults = "insert into couponextractor." + targetTable + " (BaseURL,Description,realURL,TimeStampcolumn,uniqueKey) Values ('" + baseURL + "','" + description.Replace("'", "") + "','" + realURL + "',Now(),'" + uniqueKey.Replace("'", "") + "')";
                        MySQLProcessor.MySQLInsertUpdate(mysqlquery_InsertResults, MySQLProcessor.ThreadingConnection);
                    } 
```

这是Mysqlprocessor

```
public static MySqlConnection Connection { get; set; }
    public static MySqlConnection ThreadingConnection { get; set; }
    public static MySqlConnection OpenCon()
    {
        MySqlConnection masterOpenCON = new MySqlConnection("removed for privacy");
        masterOpenCON.Open();
        return masterOpenCON;
    }

    public static DataTable DTTable(string mysqlQuery, MySqlConnection MysqlCon)
    {
        DataTable DTTableTable = new DataTable();
        using (MysqlCon)
        {
            using (MySqlDataAdapter DataDTTables = new MySqlDataAdapter(mysqlQuery, MysqlCon))
            {
                DataDTTables.SelectCommand.CommandTimeout = 2500;
                using (DataTable DataDTTablesDT = new DataTable())
                {
                    DataDTTables.Fill(DataDTTablesDT);
                    DTTableTable = DataDTTablesDT;
                    DataDTTablesDT.Dispose();
                }

            }
        }

        return DTTableTable;
    }

    public static void MySQLInsertUpdate(string MySQLCommand, MySqlConnection MysqlCon)
    {
        try
        {
            using (MysqlCon)
            {
                MySqlCommand MySQLCommandFunc = new MySqlCommand(MySQLCommand, MysqlCon);
                MySQLCommandFunc.CommandTimeout = 2500;
                MySQLCommandFunc.ExecuteNonQuery();
            }
        }
        catch (Exception ex)
        {
            if (ex.Message.ToString().Contains("Duplicate entry"))
            {
                //SiteController.Catch_Old_Values = true;
            }
            else if (ex.Message.ToString().Contains("Data too long for column"))
            {

            }
            else
            {
                EventLog.WriteEntry("CouponCrawler", ex.Message.ToString(), EventLogEntryType.Error);
            }
        }
    } 
```

我很困惑，我什至在进入线程之前就清楚地在 Program.CS 中处理了 MySQLProcessor.Connection。然后我从不在应用程序的其余部分调用数据读取器。欢迎任何帮助我要疯了..

这里抛出异常：

```
using (MysqlCon)
            {
                MySqlCommand MySQLCommandFunc = new MySqlCommand(MySQLCommand, MysqlCon);
                MySQLCommandFunc.CommandTimeout = 2500;
                MySQLCommandFunc.ExecuteNonQuery();
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:31:46.363

一旦执行离开 using 语句的主体，“using”语句将释放对象。在您的 foreach 循环中，您将在第一次调用 MySQLInsertUpdate 时处理您的连接。

此外（以及您的例外的原因）是，通过执行并行 foreach 您将在同一连接上同时执行两个查询。

# javascript - 如何为 JavaScript 中的嵌套脚本标记附加注册回调

> ID：11218124
> 
> 赞同：1
> 
> 时间：2012-06-27T01:18:23.850
> 
> 标签：javascript, include, dom-events

我正在尝试破解第 3 方 JavaScript 弹出窗口，我需要以某种方式注册回调，以便在加载后采取行动。我的页面上有如下代码：

```
document.write('<' + 'script type="text/javascript"
  src="https://www.notmydomain.com/include.js"><\/script>'); 
```

include.js 的源代码如下所示：

```
document.write('<' + 'script type="text/javascript" 
  src="https://www.notmydomain.com/anotherinclude.js?id=uniqueidicantreplicate"><\/script>'); 
```

anotherinclude.js 将一些新的 div 写入 DOM，我想与它们进行交互。

我没有在我的域之外提供任何 .js 文件，我无法控制它们的内容，它们的内容可能偶尔会发生变化，并且每次下载文件时，js 中的一些唯一标识符都会改变，我不能恶搞。

如何注册回调，以便在加载新的 DOM 元素时采取行动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:40:42.890

嗯，DOM2 和 DOM4 提供了一些工具来监听树的变化，你可以使用这些工具，但是浏览器的支持是不一致的。具体来说，我说的是[MutationEvent](http://www.w3.org/TR/2012/WD-DOM-Level-3-Events-20120614/#events-MutationEvent) (DOM2) 和[MutationObserver](http://www.w3.org/TR/dom/#mutationobserver) (DOM4) 接口。除了有限的浏览器支持外，您还需要注意 MutationEvent 的性能问题。

# javascript - 成功调用带参数的简单函数后出现消息“未定义”的意外警报

> ID：11218125
> 
> 赞同：0
> 
> 时间：2012-06-27T01:18:24.350
> 
> 标签：javascript

谁能告诉我为什么下面的代码会产生我期望的警报框（RyeTofuRye），但随后会产生第二个带有“未定义”消息的警报框？至少那是它在我的 Windows 7 机器上的最新 FireFox 中所做的。

```
function makeSandwich(bread, meat) {
alert(bread + meat + bread);
}
var mySandwich = makeSandwich('Rye', 'Tofu');
alert(mySandwich); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:22:36.957

当您返回 Nothing 时，第二个警报未定义！
下面的流程：

```
function makeSandwich(bread, meat) {//step-3
    alert(bread + meat + bread); // alerting RyeTofuRy, step-4
    // am i returnign anything? nope!
    //adding a return (bread + meat + bread); resolves teh problem though
    }

var mySandwich = makeSandwich('Rye', 'Tofu');//start here step-1
alert(mySandwich);//step-2, step-5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:20:30.473

因为您不从 中返回值，`makeSandwich()`所以.`mySandwich``undefined`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:20:49.170

将其更改为：

```
function makeSandwich(bread, meat) {
return(bread + meat + bread);
}
var mySandwich = makeSandwich('Rye', 'Tofu');
alert(mySandwich); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T01:20:55.693

`makeSandwich`什么都不返回。将其更改为：

```
function makeSandwich(bread, meat) {
    return(bread + meat + bread);
} 
```

# django - django modeltranslation - 默认字段？

> ID：11218131
> 
> 赞同：6
> 
> 时间：2012-06-27T01:19:09.003
> 
> 标签：django, internationalization

Django 的模型翻译应用程序通常是一个出色的国际化工具。然而，有一件事让我很烦恼。当我定义我的语言集时，modeltranslation 会生成 n 个字段，每种语言一个。问题是，我最终得到了一个冗余字段（我的默认语言是英语）。

所以我有：

field_en field_fr field_jp

和字段 == field_en。我是在滥用模型翻译，还是有办法解决这个问题？

编辑：所以为了澄清，我想摆脱 field 或 field_en。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T04:50:40.380

我认为您错过了文档[中翻译字段访问的规则](http://code.google.com/p/django-modeltranslation/wiki/InstallationAndUsage#Rules_for_translated_field_access)，如果您想删除 admin 中的主要字段，请参阅[Django admin backend integration](http://code.google.com/p/django-modeltranslation/wiki/InstallationAndUsage#Django_admin_backend_integration)部分。

在模板文件中，您只需像这样编写主要字段

```
{{obj.field}} 
```

如果您当前的语言环境是英语，它将复制其他语言的`field_en`to`field`和相同的。

# javascript - 升级脚本以使用 jquery_1.7.2

> ID：11218132
> 
> 赞同：0
> 
> 时间：2012-06-27T01:19:26.240
> 
> 标签：javascript, jquery

我刚刚将我们的 jquery 库从 v1.3.2 更新到 1.7.2，这是唯一需要修复的脚本 (endless_page.js)。我假设这里的语法已被贬值或其他什么，但任何帮助将不胜感激！！！

```
 var currentPage = 1;
 var path = window.location.pathname;
 var ajax_path;

function checkScroll() {
  if (nearBottomOfPage()) {
    call_ajax();
}  else {
   setTimeout("checkScroll()", 100);
 }
}

function call_ajax() {

    $("#loading-or-more").fadeOut(100, function() {
    $(this).replaceWith('<p class="headline" id="loading-or-more" style="display:none;text-align:center;margin-left:20px;"><img src="../../images/newlajaxoader.gif" style="float:left;margin-top:-10px;" > 10 more items on the way</p>');
    $("#loading-or-more").fadeIn(10);
    });
    currentPage ++;
    ajax_path = full_path(currentPage);
    $.ajax({
    url: ajax_path ,
    success: function(data) { 

        if (data=="false") { 
            $("#loading-or-more").replaceWith('<p class="headline" id="end-of-scroll" style="display:none;text-align:center;">  <a href="#"  class="submit gradientBGRed morecategories"> Back to top &uarr;  </a> </p>'); 
            $("#end-of-scroll").fadeIn(10);
            }
        else {
                $(".mb-lot-items").append(data); 
                // $(".ajax-results-list").slideDown('slow');
                checkScroll();                                                  
                $("#loading-or-more").replaceWith('<a  id="loading-or-more" class="headline gradientBGRed morecategories" href="#items-ajax-mobile"><span>More items</span></a>');  }

          } 
    });
}

function nearBottomOfPage() {
  return scrollDistanceFromBottom() < 400;
}

function scrollDistanceFromBottom(argument) {
  return $(document).height() - ($(window).height() + $(window).scrollTop());
}

function full_path(currentPage) {
    return (path+"?page=" + currentPage+"&format=js") ;
}

$(document).ready(function() { 
     // checks if "MORE" exists, if so calls checkscroll
     if ($("#loading-or-more").length) { checkScroll(); }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T14:40:38.023

我必须将数据类型指定为文本，然后她开始获取数据。谢谢@Ohgodwhy

```
 dataType: "text", 
```

# c# - 我想设置“下次登录时必须更改密码”标志

> ID：11218136
> 
> 赞同：6
> 
> 时间：2012-06-27T01:19:56.427
> 
> 标签：c#, active-directory

在我的应用程序中，我正在做的事情是用户可以从我的应用程序控制他/她的本地 Windows 用户帐户，即创建用户、设置/删除密码、更改密码以及可以从我的应用程序调用密码过期策略。现在，在这一点上，我需要弄清楚如果用户想在下次登录时更改他的密码，那么会发生什么。正如许多论坛和博客所说的那样，我做了相应的编码：

**下次登录时调用密码过期**

```
 public bool InvokePasswordExpiredPolicy()
    {
        try
        {
            string path = GetDirectoryPath();
            string attribute = "PasswordExpired";
            DirectoryEntry de = new DirectoryEntry(path);
            de.RefreshCache(new string[] { attribute });
            if(de.Properties.Contains("PasswordExpired"))
            de.Properties[attribute].Value = 1;
            de.CommitChanges();
            return true;
        }
        catch (Exception)
        {
            return false;
        }
    } 
```

**下次登录时触发密码过期。重置标志**

```
public bool ProvokePasswordExpiredPolicy()
    {
        try
        {
            string path = GetDirectoryPath();
            string attribute = "PasswordExpired";
            DirectoryEntry de = new DirectoryEntry(path);
            de.RefreshCache(new string[] { attribute });
            de.Properties[attribute].Value = -1;
            de.CommitChanges();
            return true;
        }
        catch (Exception)
        {
            return false;
        }
    } 
```

**检查是否设置了相关标志**

```
public bool isPasswordPolicyInvoked()
    {
        try
        {
            string path = GetDirectoryPath();
            string attribute = "PasswordExpired";
            DirectoryEntry de = new DirectoryEntry(path);
            de.RefreshCache(new string[] { attribute });
            int value = Convert.ToInt32(de.Properties[attribute].Value);

            if (value == 1)
                return true;
            else
                return false;
        }
        catch (Exception)
        {
            return false;
        }
    } 
```

我使用 WinNT 来获取目录路径而不是 LDAP。我使用以下方法**获取目录路径。**

```
private String GetDirectoryPath()
    {
        String uName = this.userName;
        String mName = this.userMachine;

        String directoryPath = "WinNT://" + mName + "/" + uName;

        return directoryPath;
    } 
```

有什么我想念的吗？帮帮我。

**注意：**首先，我使用**pwdLastSet**属性设置为 0（表示开启）和 -1（表示关闭）抛出异常“在属性缓存中找不到目录属性”，后来我发现 WinNT 不支持这个属性而是它支持**PasswordExpired**，它需要为 1 才能设置标志。这就是我所做的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T02:00:03.083

如何改用 System.DirectoryServices.AccountManagement，在这种情况下，您可以调用以下代码：

```
UserPrincipal.Current.ExpirePasswordNow(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-02-20T13:28:46.170

下面的代码应该可以工作：

```
de.Properties["pwdLastSet"][0] = 0; 
```

来自[用户下次登录时必须更改密码（LDAP 提供者）](https://msdn.microsoft.com/en-us/library/aa746510(VS.85).aspx)：

> 要强制用户在下次登录时更改密码，请将 pwdLastSet 属性设置为零 (0)。要删除此要求，请将 pwdLastSet 属性设置为 -1。pwdLastSet 属性不能设置为系统以外的任何其他值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-19T15:29:11.520

我追踪到了这一点。这对应于`UserPrincipal.LastPasswordSet`属性。

该属性是只读的，因此您必须使用以下方法进行设置：

```
 public bool UserMustChangePasswordNextLogon
    {
        get
        {
            return (_userPrincipal.LastPasswordSet == null);
        }
        set
        {
            if (value)
                _userPrincipal.ExpirePasswordNow();
            else
                _userPrincipal.RefreshExpiredPassword();
        }
    } 
```

在我的情况下，我将变量设置为在下次保存时过期或刷新密码，而不是在属性设置器中。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-01-09T06:29:08.627

```
de.Properties["passwordExpired"][0] = 1; <br>
de.CommitChanges(); 
```

# javascript - 捕获脚本生成的 mailto URI

> ID：11218139
> 
> 赞同：4
> 
> 时间：2012-06-27T01:20:19.890
> 
> 标签：javascript, events, selenium, automated-tests, mailto

**概括：**

我正在为 web 应用程序（使用 Selenium）进行一些自动化测试，并且我正在尝试捕获在 onclick 事件期间由 javascript 生成的 mailto:link （特别是它的查询参数之一）。目前我能想到的唯一方法是将逻辑复制到我的测试函数中。这并不理想，因为这意味着如果 webapp 中的逻辑发生变化，我将不得不更新测试中的逻辑。我的问题是：你能想出更好的方法吗？

**细节：**

以下是 web 应用程序的工作方式：

*   侦听 div 上的点击事件
*   如果事件的目标是“电子邮件按钮”，则根据当前状态生成一个 mailto: URI
*   `window.location = [generated URI]`在 JavaScript 中设置

不幸的是，如您所见，此 URI 生成是由于 onclick 事件而发生的，并且只是将 window.location 设置为该 URI，因此它没有将其设置为锚点上的 href 属性（或任何其他元素上的任何属性）我可以查询 DOM。

我也没有任何运气找到一个由于`window.location`设置为 mailto: URI 而触发的事件，它可能将 URI 作为其属性之一......我可能忘记了一个吗？

有任何想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2015-01-21T22:52:02.670

您是否尝试过使用 storeEval 手动调用 onclick 上的函数并分析返回值？

# java - 是否可以同时使用变换和图像绘制坐标？

> ID：11218142
> 
> 赞同：0
> 
> 时间：2012-06-27T01:20:37.970
> 
> 标签：java

我正在尝试将移动的动画精灵转换为自身的反转。我知道这样做的唯一方法是：

```
AffineTransform transform = new AffineTransform();
transform.scale(-1, 1);
transform.translate(-sprite.getWidth(), 0);
g.drawImage(imageFromSprite, transform, null); 
```

因为似乎没有方法可以通过变换输入坐标，这意味着我无法继续运行在屏幕上移动动画精灵的代码。

**有没有办法转换图像并在指定的坐标处绘制它？**

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:40:35.157

变换图像不会影响您定位图像的能力，如图所示：

```
BufferedImage reversedImage = new BufferedImage(imageFromSprite.getWidth(),
        imageFromSprite.getHeight(), imageFromSprite.getType());

AffineTransform transform = new AffineTransform();
transform.scale(-1, 1);
transform.translate(-imageFromSprite.getWidth(), 0);

Graphics2D reversedImageGraphic = reversedImage.createGraphics();
reversedImageGraphic.drawImage(imageFromSprite, transform, null);

// top left is drawn at (0,60)
g.drawImage(imageFromSprite, 0, 60, null); 
```

如果你想做动画 a `BufferedImage`，这些链接应该是有趣的：

[http://web.mit.edu/1.124/LectureNotes/images.html](http://web.mit.edu/1.124/LectureNotes/images.html) http://www.permadi.com/tutorial/javaImgObserverAndAnimGif/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:26:59.980

为自己编写一个执行转换并接受坐标作为参数的方法。

前任：

```
public void doTransformAndDraw(int x, int y)
{
    AffineTransform transform = new AffineTransform();
    //transform.scale(-1, 1);
    transform.translate(-sprite.getWidth(), 0);
    g.drawImage(sprite, x, y, null);
} 
```

我假设 transform.translate() 方法实际上是在进行图像反转。

# jquery - 使用 jquery 根据选中的单选按钮显示 div

> ID：11218146
> 
> 赞同：0
> 
> 时间：2012-06-27T01:20:52.290
> 
> 标签：jquery

这是我无法正常工作的简单页面的代码：

```
 <head>
<script src="js/jquery-1.7.min.js"></script>

<script type="text/javascript">
<!--
$("input[type=radio]").on('click', function(){
    if ($('#radio1').is(':checked')){
        $("#grid_9.omega").slideDown("slow");
    } else { 
        $("#grid_9.omega").slideUp("slow");
    }
});
//-->
</script>
</head>

<body>
<form id="form1" name="form1" method="post" action="">
  <p>
    <label>
      <input type="radio" name="RadioGroup1" value="radio1" id="radio1" />
      Radio 1</label>
    <br />
    <label>
      <input type="radio" name="RadioGroup1" value="radio2" id="radio2" />
      Radio 2</label>
    <br />
    <label>
      <input type="radio" name="RadioGroup1" value="radio3" id="radio3" />
      Radio 3</label>
    <br />
  </p>
</form>
<div id="grid_9" class="omega" style="display:none">show me when Radio 1 is chosen​&lt;/div>
</body> 
```

我的目标是在选择“radio1”时使用 jquery 显示 div“grid_9.omega”，但在未选择“radio1”时隐藏该 div。

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:13:57.543

只需您可以：

```
$("input[type=radio]").on('click', function(){
    if(this.id == 'radio1')
        $("#grid_9.omega").slideDown("slow");
    else
       $("#grid_9.omega").slideUp("slow");
}); 
```

**[工作样本](http://jsfiddle.net/9369U/2/)**

如果您的收音机是动态的，即在页面加载后附加到 DOM，那么您需要委托事件处理程序，如下所示：

```
$('body').on('click', 'input[type=radio]', function() {
  if(this.id == 'radio1')
      $("#grid_9.omega").slideDown("slow");
  else
     $("#grid_9.omega").slideUp("slow");
}); 
```

而不是`input[type=radio]`您只能`:radio`用作选择器。IE

```
$(':radio').on('click', ...) 
```

或者

```
$('body').on('click', ':radio',..) 
```

* * *

### 笔记

在委托事件的情况下，最好使用任何其他静态元素而不是`body`. 假设，如果您`form1`对 DOM 是静态的，即在页面加载时属于 DOM，那么而不是

```
$('body').on('click', 'input[type=radio]', function() {..}) 
```

你应该使用

```
$('#form1').on('click', 'input[type=radio]', function() {..}) 
```

* * *

### 余

将所有代码放入

```
$(document).ready(function() {
  // your code
}); 
```

是短

```
$(function() {
  // your code
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T01:54:32.980

试试这个：[jsFiddle](http://jsfiddle.net/nejj/9369U/)

```
<script type="text/javascript">
$(function() {
$("input[type=radio]").on('click', function(){
    if ($('#radio1').is(':checked')){
        $("#grid_9.omega").slideDown("slow");
    } else { 
        $("#grid_9.omega").slideUp("slow");
    }
});
});
</script>
<form id="form1" name="form1" method="post" action="">
  <p>
    <label>
      <input type="radio" name="RadioGroup1" value="radio1" id="radio1" />
      Radio 1</label>
    <br />
    <label>
      <input type="radio" name="RadioGroup1" value="radio2" id="radio2" />
      Radio 2</label>
    <br />
    <label>
      <input type="radio" name="RadioGroup1" value="radio3" id="radio3" />
      Radio 3</label>
    <br />
  </p>
</form>
<div id="grid_9" class="omega" style="display:none">show me when Radio 1 is chosen</div> 
```

我对您的代码所做的所有更改是在脚本的开头添加了准备好的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T01:23:59.223

试试这个

```
<script type="text/javascript">
<!--
$(function(){
    $(document).on('change','input:radio', function(){
        if ($('#radio1').is(':checked')){
            $("#grid_9.omega").slideDown("slow");
        } else { 
            $("#grid_9.omega").slideUp("slow");
        }
    });
}
//-->
</script> 
```

[jsFiddle 演示](http://jsfiddle.net/fHxRZ/1/)

# android - 是否需要 /system/bin 中的 init.rc 中的服务路径

> ID：11218157
> 
> 赞同：0
> 
> 时间：2012-06-27T01:22:24.303
> 
> 标签：android, android-emulator, android-ndk

从通用的 init.c 中，我可以看到所有服务的路径都在 /system/bin 下。而且，我构建了我的本机代码并将其放在 /data 下。此外，我在 init.rc 中将其注册为服务。但是，当android启动时它无法自动运行。所以，我想知道是否需要将服务放在/system/bin下？而且，更重要的是，由于我们没有在/system/bin下创建文件的权限，我们是否需要从源代码重新构建整个操作系统才能在/system/bin中构建我的代码？或者，那里是另一种实现我的目标的方法吗？我为这样的问题苦恼了好几天。

# algorithm - 动态规划子集算法

> ID：11218159
> 
> 赞同：2
> 
> 时间：2012-06-27T01:22:38.173
> 
> 标签：algorithm, dynamic-programming

我正在编写一些动态编程的复习材料。我需要想出应该如何划分子问题，计算出基本情况，并想出递归公式。

给定 n 个正整数 a1,a2,...,an、一个数字 k 和一个目标 W，我们想要选择一个子集 T，其中恰好有 k 个元素的总和最接近 W。每个元素只能选择一次。用 3 个参数定义一个子问题（即 C[x,y,z] = ...）。

我只使用过一些动态编程示例，并且从未使用过需要 3 个参数来定义子问题的示例。我真的迷路了。如果有人能发光，那就太好了。

我对子问题应该是什么的最佳猜测是：

C[x,y,z] = x 来自 {a1,...ay} 的元素数，其中总和正好是 z

但我不知道这是否正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:35:17.830

将其分解为三个参数的一种方法是：

```
x: maximum index of item considered for inclusion in subset
n: number of items in subset
s: sum of subset 
```

基本情况是 C[0,0,0] = true，C[0,i > 0,j > 0] = false

递归情况是：

```
C[i,n+1,s+a_i] = C[i-1,n,s]  // use item i
C[i,n,s] = C[i-1,n,s] // dont use item i 
```

这使用空间 O(n^2 * max(a_i)) （可以通过丢弃使用时的 C[i, *,* ] 减少到 O(n*max(a_i))）

然后只需在 z 附近搜索 C[n,i,j] 以获得最终答案。

作为一个循环...

```
for (int i = 1; i <= n; i++)
{
    C[i,n+1,s+a_i] ||= C[i-1,n,s];
    C[i,n,s] ||= C[i-1,n,s];
} 
```

作为递归函数：

```
bool C(int maxindex, int size, int sum)
{
    if (memoize(maxindex, size, sum))
         return cached;

    if (maxindex == 0)
        return (size == 0 && sum == 0);

    return
         C(maxindex-1, size-1, sum - A[maxindex]) ||  // version using A[maxindex]
         C(maxindex-1, size, sum); // version not using A[maxindex]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:28:32.943

在这种情况下，我会让 C(x,y,z) 是一个布尔值，表示是否可以使用来自 {a1 ... ax} 的恰好 y 得到恰好 z 的总和。

虽然它不是完全相同的问题[Wikipedia](http://en.wikipedia.org/wiki/Knapsack_problem#Subset-Sum_Problem)，但具有针对各种类似问题的动态编程解决方案和解释。也许这会给你一些想法。

# wcf - 如何保护在 Windows Azure 中运行且由 Windows 窗体应用程序访问的 WCF 服务

> ID：11218160
> 
> 赞同：2
> 
> 时间：2012-06-27T01:23:04.847
> 
> 标签：wcf, security, azure, enterprise

伙计们，

我们正在开发一个应用程序，它是可下载的 WinForms 应用程序的一部分，该应用程序连接到一组 Azure 托管的 WCF 服务。

我们现在的主要问题是如何正确保护这些服务以防止 DoS 攻击和其他安全问题。

WinForms 应用程序将安装在世界任何地方的最终用户 PC 上（他们将能够从我们的网站下载），因此我们无法控制最终用户对我们的应用程序所做的事情。

我们已经尽可能地保护了应用程序，但我们知道没有什么是牢不可破的。我们现在的主要目标是确保这些 Web 服务的方法仅由我们的应用程序调用，并且我们可以保护自己免受攻击。

我们从 Microsoft 找到了一份最佳实践白皮书，指出对于我们拥有的某些场景，我们可以使用 GateKeeper 场景（例如用于存储）。我们还没有为我们的队列选择任何东西。

另一个问题是如何最好地控制从我们的 WinForms 应用程序到云服务的身份验证。

这里有没有人开发或从事过任何类似的项目并想分享一些想法？

干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:36:48.413

> 我们现在的主要目标是确保这些 Web 服务的方法仅由我们的应用程序调用，并且我们可以保护自己免受攻击。

替换为：我们现在的主要目标是确保这些 Web 服务的方法仅由我们的应用程序调用，**或者**我们可以保护自己免受攻击。

这有点现实:) 根本没有办法保证服务会从客户端调用，除非你绝对信任他们并开始为他们颁发证书。（他们会丢失，他们的电脑会被黑客入侵，等等）

如果你想保护服务，你必须为每一种可能的攻击场景做好准备，除非你可以 100% 肯定地排除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T23:05:04.453

这个问题已经被问了一遍又一遍。如果 Web 服务托管在任何具有公共 IP 的服务器上，则阻止客户端的唯一方法是首先对其进行身份验证，如果身份验证顺利，他们可以使用该方法，如果失败则无法使用。身份验证和授权是托管在 Internet 上的任何服务的关键，否则请保持服务的私密性。

为了对 WCF 服务进行身份验证，已经有可用的模式和实践，而且您似乎已经处理了这一点。

# windows-8 - 媒体扩展示例 Metro 错误？

> ID：11218164
> 
> 赞同：0
> 
> 时间：2012-06-27T01:23:40.450
> 
> 标签：windows-8, microsoft-metro, ms-media-foundation

媒体扩展示例 此示例演示如何使用媒体扩展将效果应用于视频、解码视频以及使用方案处理程序创建媒体流。

我只是调试示例。我选择了一个mpg文件，文件时长为4分钟。sdk 应用程序运行正常，显示两个重叠块。但大约 1 分钟 40 秒后，sdk 应用程序崩溃。像这样的信息：“MediaExtensionsCPP.exe 中 0x68A95B94 (mfcore.dll) 处的未处理异常：0xC0000005：访问冲突读取位置 0x68A26A38。”

我替换另一个文件，同样的错误。所以我认为微软样本有一些错误。有人有同样的问题吗？可以分享一下解决方法。非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T01:24:15.830

媒体团队有一个修复程序，将在新版本的示例中解决此问题。这些是修复当前样本的说明：

我们在媒体示例中发现了一个导致 DLL 过早卸载的错误。同时，您可以将这些行添加到 MSDN 示例中源/流类的构造函数/析构函数中： 注意：从 RuntimeClass<> 派生的类不需要这样做（例如：方案处理程序）。

构造函数：自动模块 = ::Microsoft::WRL::GetModuleBase(); if (module != nullptr) { module->IncrementObjectCount(); }

析构函数：自动模块 = ::Microsoft::WRL::GetModuleBase(); if (module != nullptr) { module->DecrementObjectCount(); }

# android - 如何将多个项目传递到 ArrayAdapter？

> ID：11218173
> 
> 赞同：0
> 
> 时间：2012-06-27T01:24:36.523
> 
> 标签：android, listview, android-arrayadapter

目前我有一个扩展的自定义适配器`ArrayAdapter`。在我的`ListView`中，我有一个`ImageView`要求`photo`联系人照片、**3 个** `TextViews`联系人姓名 ( `contactName`)、消息 ( `contactMSG`) 和一个计数器 ( `contactMSGcounter`)。传递给我的 Activity 的构造函数`ListView`到目前为止看起来像这样：

```
// newlist contains all queried contacts
CustomAdapter cAdapt = new CustomAdapter(this,
            android.R.layout.simple_list_item_1, newlist); 
```

这只需要一个`ArrayList`联系人姓名。

在开发者网站上，我可以使用许多不同的构造函数：

[http://developer.android.com/reference/android/widget/ArrayAdapter.html](http://developer.android.com/reference/android/widget/ArrayAdapter.html)

如何将上述所有对象传递给我的构造函数？我假设`T[] objects`是可能的解决方案，但如果这是真的，我该如何使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:36:03.750

1.  使用您提到的按您希望的方式格式化的那些文本和图像视图创建一个 XML 资源。
2.  传入 XML id，例如。R.id.myXml，然后就可以了。
3.  在 CustomAdapter 中，通过使用 findByViewId 调用视图来处理业务，一切就绪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T07:11:08.203

辣味的，

要为您的适配器提供某些数据，您可以使用*POJO*。

创建一个具有一些属性和功能的简单类，并列出该对象。

```
ArrayList<MyContactObject> myList = new ArrayList<MyContactObject>(); 
```

要使用联系人填写您的列表，您可以使用[Contacts](http://developer.android.com/reference/android/provider/Contacts.html)（Android 2.0 以下）或[ContactsContract](http://developer.android.com/reference/android/provider/ContactsContract.html)（Android 2.0 及以上）类。有关如何读出您的联系人的示例，您可以在此处找到：[链接](http://www.higherpass.com/Android/Tutorials/Working-With-Android-Contacts/)

就像 jack57 所说，您可以为自己制作一个自定义 XML 来提供您想要的布局。我认为您可能会发现有用的另一个链接如下：[logc.at](http://logc.at/2011/10/10/handling-listviews-with-multiple-row-types/)。他们有一个伟大而干净的 ListView 实现。尽量遵循结构，因为它简单且易于维护。

祝你好运！

# asp.net-mvc - 使用带有 mvc3 的 jquery 移动单选按钮

> ID：11218177
> 
> 赞同：1
> 
> 时间：2012-06-27T01:24:44.337
> 
> 标签：asp.net-mvc, jquery-mobile

我正在尝试使用 mvc 让 jquery mobile 来创建单选按钮组。

这就是我所拥有的

```
 <li data-role="fieldcontain">
        <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
            <legend>Gender:</legend>
        @*   <input type="radio" name="radio-choice-b" id="radio-choice-c" value="on" checked="checked" />
            <label for="radio-choice-c">Male</label>
            <input type="radio" name="radio-choice-b" id="radio-choice-d" value="off" />
            <label for="radio-choice-d">Female</label>
         *@
             @Html.LabelFor(model=>model.Consumer.IsMale,"Male")
             @Html.RadioButtonFor(model => model.Consumer.IsMale, "True",new {value="on",@checked = "checked"})
             @Html.LabelFor(model=>model.Consumer.IsMale,"Female")
             @Html.RadioButtonFor(model => model.Consumer.IsMale, "False", new {value="off"})
            </fieldset>
    </li> 
```

看起来像

![在此处输入图像描述](../Images/903314f40c14c466690089e39ab98819.png)

它不可点击，您可以看到“男性”按钮中有一个单选按钮。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T22:19:16.907

我绑定了我的单选按钮列表错误。如果其他人有同样的问题，这是正确的方法

```
@Html.RadioButtonFor(model => model.Consumer.IsMale, true,new {value="on",@checked = "checked",id="Consumer_IsMale_true"})
<label for="Consumer_IsMale_true">Male</label>

@Html.RadioButtonFor(model => model.Consumer.IsMale, false, new {value="off",id="Consumer_IsMale_false"})
<label for="Consumer_IsMale_false">Female</label> 
```

# r - 通过将答案插入数据框或向量来收集答案

> ID：11218178
> 
> 赞同：1
> 
> 时间：2012-06-27T01:24:45.503
> 
> 标签：r

我想知道是否可以将一堆不同的计算答案分组到一个向量中？我有 30 次计算（我在这里显示了前 3 次的答案），并且我想将它们全部分组到一个向量甚至数据框中，以便保留股票名称。目标是按降价对它们进行排序

```
 AXP.Close
2002-06-20 0.008553863 
```

第二个答案我想插入向量甚至数据框中

```
 BA.Close
2002-06-20 0.01553576 
```

第三个答案我想插入向量甚至数据框中

```
 DIS.Close
2002-06-20 0.01073620 
```

更多细节

谢谢你们的回答，你说得对，我应该提供更多细节：

所以基本上我试图计算和排序道琼斯指数中 30 只股票的收益率，我不能使用 yahooQF("Dividend Yield") 因为它没有选择 2002 年收益率的选项例子

```
x = c("AAPL","ADBE","ADP")
Yield<-getQuote(x, what = yahooQF("Dividend Yield")) 
```

所以我试图通过分别获得一年时间跨度的股息和期末的价格来获得它，而不是进行除法

```
s = c("VOD","ADP", etc)
getSymbols(s, from="2009-06-20", to="2009-06-22")
ClosePrices <- do.call(merge, lapply(s, function(x) Cl(get(x))))
sum(getDividends("ADP",from = "2008-06-29", to="2009-06-20")) /ClosePrices[,1] 
```

现在的目标是将所有计算出的收益率放在一个向量中（股票名称应该保留）并按降序排列！非常感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:37:57.180

首先，我会做一些看起来像你描述的东西：

```
s <- c("AXP", "BA", "DIS")
getSymbols(s, src='yahoo', from='2012-06-19', to='2012-06-20')
L <- lapply(s, function(x) ROC(Cl(get(x)), na.pad=FALSE))
L
[[1]]
             AXP.Close
2012-06-20 0.008742843

[[2]]
              BA.Close
2012-06-20 0.001233468

[[3]]
             DIS.Close
2012-06-20 0.004619916 
```

现在，按列组合结果

```
do.call(cbind, L)
             AXP.Close    BA.Close   DIS.Close
2012-06-20 0.008742843 0.001233468 0.004619916 
```

这等效于`cbind(L[[1]], L[[2]], L[[3]])`但适用于任何长度的列表。

* * *

解决您的编辑问题。我认为这将满足您对道指 30 的要求

```
# make a simple function to get the names of the DJIA components
DJIcomponents <- function() {
    require("XML")
    djicomp <- readHTMLTable('http://finance.yahoo.com/q/cp?s=^DJI+Components', 
                             stringsAsFactors=FALSE)
    data.frame(djicomp[[tail(grep("Symbol", djicomp), 1)]])
}
s <- DJIcomponents()$Symbol

getSymbols(s, src='yahoo', from="2009-06-20", to="2009-06-22")
out <- do.call(cbind, lapply(s, function(sym) {
    sum(getDividends(sym, from = "2008-06-29", to="2009-06-20"))/Cl(get(sym, pos=.GlobalEnv))
})) 
```

现在，按降序排列

```
out[1, order(out[1, ], decreasing=TRUE)]
             GE.Close  BAC.Close  PFE.Close   DD.Close    T.Close
2009-06-22 0.08940972 0.08207705 0.07572684 0.06804979 0.06708075
            MRK.Close   VZ.Close   AA.Close  CAT.Close  CVX.Close
2009-06-22 0.06036537 0.06029314 0.05389222 0.05191595 0.03953771
             HD.Close  JPM.Close INTC.Close  MMM.Close   BA.Close
2009-06-22 0.03870968 0.03620322 0.03571429 0.03514877 0.03496802
            KFT.Close  JNJ.Close   KO.Close  MCD.Close   PG.Close
2009-06-22 0.03445545 0.03369977 0.03292353 0.03277972 0.03243671
           AXP.Close  TRV.Close  UTX.Close  XOM.Close MSFT.Close
2009-06-22 0.0309944 0.02922552 0.02805249 0.02353283 0.02147766
            WMT.Close  IBM.Close  DIS.Close   HPQ.Close CSCO.Close
2009-06-22 0.02103313 0.01961347 0.01544572 0.008479067          0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:33:11.223

这取决于生成这些答案的代码类型。将它们全部放入向量中的最简单方法是：

```
v = c(AXP.Close=AXP.Close, BA.Close=BA.Close...) 
```

*但是*，基于您的计算之间的相似性，看起来它们都是股票的收盘价，我猜每个计算几乎完全相同。在这种情况下，你当然不应该使用单独的代码生成它们，然后将它们全部放入一个向量中——你应该使用循环来生成它们`for`——或者更好的是，调用`sapply`.

你能提供更多关于你的计算的细节吗？

另外：目前的数据是什么形式的？看起来它们与日期和股票名称相关联。

# php - 在 txt 中每行选择 1 个随机关键字

> ID：11218179
> 
> 赞同：2
> 
> 时间：2012-06-27T01:25:09.267
> 
> 标签：php

```
$kw=explode("\n",file_get_contents("keyword.txt"));
shuffle($kw); 
```

keyword.txt 只是关键字，例如：

```
keyword1
keyword2
keyword3
keyword4
keyword5
keyword6
keyword7
keyword8
keyword9 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:36:19.187

要从该文件中选择一个随机关键字：

```
<?php
//$keywords = file('keyword.txt'); OR
$keywords = explode("\n", file_get_contents('keyword.txt'));
echo $keywords[ array_rand($keywords) ];
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:37:03.267

我不确定我是否正确理解了这个问题，但是如果您想用每行随机关键字替换当前的关键字选择，您需要更改：

```
$kwd=$kw[$i]; 
```

有类似的东西：

```
$kwds = explode(" ", $kw[$i]);    // although I would use foreach to loop through the lines array...
$kwd = reset(shuffle($kwds));    // shuffle the keywords in that line and pick the first one 
```

# javascript - 通过 jQuery 验证日期字符串格式的最佳方法

> ID：11218181
> 
> 赞同：4
> 
> 时间：2012-06-27T01:25:40.997
> 
> 标签：javascript, jquery, jquery-validate

我发现了很多链接来验证字符串是否是日期。

喜欢[这里](https://stackoverflow.com/questions/7760032/how-to-validate-if-string-is-date-with-jquery)和[这里](https://stackoverflow.com/questions/2587345/javascript-date-parse)。

但无论如何我不知道如何验证我们是否有这个东西：

**2012**年 6 月 6 日，其中前**6**是月份，后 **6**是天

如果用户这样输入：

**2012 年 6 月 6 日**

任何线索如何以正确的方式完成？

谢谢！！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-27T01:40:23.553

在这里，这应该适用于任何具有 4 位数年份和任何分隔符的日期格式。我从我的插件[Ideal Forms](https://github.com/elclanrs/jq-idealforms)中提取了它，该插件可以验证日期等等。

```
var isValidDate = function (value, userFormat) {
  var

  userFormat = userFormat || 'mm/dd/yyyy', // default format

  delimiter = /[^mdy]/.exec(userFormat)[0],
  theFormat = userFormat.split(delimiter),
  theDate = value.split(delimiter),

  isDate = function (date, format) {
    var m, d, y
    for (var i = 0, len = format.length; i < len; i++) {
      if (/m/.test(format[i])) m = date[i]
      if (/d/.test(format[i])) d = date[i]
      if (/y/.test(format[i])) y = date[i]
    }
    return (
      m > 0 && m < 13 &&
      y && y.length === 4 &&
      d > 0 && d <= (new Date(y, m, 0)).getDate()
    )
  }

  return isDate(theDate, theFormat)

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-27T01:51:02.840

使用正则表达式。

```
var dateRegEx = /^(0[1-9]|1[012]|[1-9])[- /.](0[1-9]|[12][0-9]|3[01]|[1-9])[- /.](19|20)\d\d$/

console.log("06/06/2012".match(dateRegEx) !== null) // true
console.log("6/6/2012".match(dateRegEx) !== null) // true
console.log("6/30/2012".match(dateRegEx) !== null) // true
console.log("30/06/2012".match(dateRegEx) !== null) // false 
```

[了解正则表达式。](http://www.regular-expressions.info/regexbuddy/datemmddyyyy.html)

## 编辑 - 免责声明

正如@elclanrs 指出的那样，这仅验证字符串的**格式**，而不是实际日期，这意味着像 2 月 31 日这样的日期将会过去。但是，由于 OP 只要求“*验证日期字符串格式*”，因此我将在此处保留此答案，因为对于某些人来说，这可能就是您所需要的。

请注意，OP 使用的[jQuery Validation 插件](http://docs.jquery.com/Plugins/Validation/Methods/date)也只验证格式。

最后，对于那些想知道，如果您需要验证日期而不仅仅是格式，这个正则表达式在*(1-12)/(1-31)/(* **1900-** *2099)*日期字符串。请不要在 JPL 的关键任务代码中使用它。

# html - 是否有物理街道地址的链接格式？

> ID：11218182
> 
> 赞同：6
> 
> 时间：2012-06-27T01:26:03.413
> 
> 标签：html, mobile, hyperlink

移动设备已经开始很好地进行链接检测。他们现在检测链接、电子邮件地址、电话号码和实际街道地址。

问题是链接检测不是 100% 正确的。所以更明确地说，对于其中的大多数，我们可以使用链接。

```
<a href="tel:+1-408-555-5555">1-408-555-5555</a> 
```

物理街道地址是否有等效的链接格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T01:43:39.443

[根据 IANA 的说法，](http://www.iana.org/assignments/uri-schemes.html)似乎没有一个定义。这是关于创建一个的[讨论](http://lists.w3.org/Archives/Public/uri/2001Mar/0012.html)，但它似乎并没有去任何地方。我能找到的最接近的是[geo](http://www.rfc-editor.org/rfc/rfc5870.txt)，它只是纬度和经度，而不是邮政地址。我从更新中看到您想要显示地图，因此您想要对地址进行[地理编码](http://en.wikipedia.org/wiki/Geocoding)以获取地理 URI。您可以使用[Google 的 API](https://developers.google.com/maps/documentation/geocoding/)，但我不知道此时是否需要地理 URI。

# javascript - WinJS.Promise 没有像我预期的那样工作

> ID：11218183
> 
> 赞同：1
> 
> 时间：2012-06-27T01:26:05.173
> 
> 标签：javascript, windows-8, commonjs

我正在使用 Windows 8 JavaScript 应用程序，但 WinJS.Promise 没有按预期工作。这是我的异步方法...

```
function MyFiveSecondFunctionAsync() {
    return new WinJS.Promise(function (c, e, p) {
        var start = new Date().getTime();
        var delay = 5000;
        while (new Date().getTime() < start + delay) p();
        c();
    });
} 
```

这就是我所说的......

```
document.querySelector("#status").innerText = "working";
MyFiveSecondFunctionAsync().done(function () {
    document.querySelector("#status").innerText = "done";
});
document.querySelector("#status").innerText = "free"; 
```

这是在按钮单击中。我希望我的状态 div 在单击按钮后非常简短地说“工作”，然后说“空闲”5 秒，最后在 5 秒延迟完成时说“完成”。相反，UI 线程阻塞了 5 秒，然后状态 div 显示“空闲”。

我认为执行将返回到将状态设置为“free”的行，但调试表明它在此之前达到了 promise 函数。因此状态在 5 秒后设置为“完成”，然后设置为“空闲”。换句话说，我的异步函数只是没有异步执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T17:40:06.067

正如 Raymond 在评论中提到的那样，我认为承诺会创建一个新线程，但事实并非如此。Promise 仅仅提供了一种方便的方法来“在其他事情完成时做某事”作为指定回调函数并可能进入嵌套回调的圣诞树问题的替代方法。

# paypal - Paypal Payments Pro 是否与 Paypal 的 Adaptive Payments API 兼容？

> ID：11218187
> 
> 赞同：2
> 
> 时间：2012-06-27T01:26:38.173
> 
> 标签：paypal, paypal-adaptive-payments

我正在使用 Paypal 的[Adaptive Payments API](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_api_APIntro)来处理从一个发送者/买家到两个接收者的并行付款。例如，发送者/购买者以 10 美元购买数字商品，并使用自适应支付 API，将 7 美元发送给接收者 A，将 3 美元发送给接收者 B。

我有兴趣使用[Paypal Payments Pro](https://www.paypal.com/webapps/mpp/website-payments-pro)来设计和托管结帐页面，而不是将发件人/买家踢到 Paypal.com。有谁知道 Paypal Payments Pro 是否与 Adaptive Payments API 兼容，以及通过 Payments Pro 使用 API 是否有任何限制？Paypal 的文档对此并不十分清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T02:54:18.323

我已经联系了 PayPal 商家技术服务，因为我正在考虑在我们的网站上使用 paypal payment pro。但是，我还需要使用 CHAINED 支付，这是一种自适应支付。

据他们说，Paypal Payments Pro 不能与 Adaptive 一起使用，因为它们是不同类型的集成。他们建议使用嵌入式流程，让客户使用灯箱或迷你浏览器登录；因此，不需要您的客户离开您的网站。

有关这种集成的更多信息，请查看此处：

[https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_AdaptivePayments.pdf#page=25](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_AdaptivePayments.pdf#page=25)

我不知道我是否已经回答了你的问题，但我希望在某种程度上对你有所帮助。

# javascript - DFP 渲染后回调

> ID：11218194
> 
> 赞同：29
> 
> 时间：2012-06-27T01:27:49.660
> 
> 标签：javascript, google-dfp

我需要在 DFP 完成页面上的所有广告的呈现**之后**触发一些 JavaScript - 或者至少在它触发了*collapseEmptyDivs*（它隐藏了不包含任何订单项的广告单元）时。

有谁知道在这些事件中的任何一个之后让 DFP 触发回调的方法？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2014-04-01T10:21:48.623

GPT API 现在有一个在每个插槽被填满后触发的回调。

例如：

```
googletag.pubads().addEventListener('slotRenderEnded', function(event) {
 console.log('Creative with id: ' + event.creativeId +
  ' is rendered to slot of size: ' + event.size[0] + 'x' + event.size[1]);
}); 
```

请参阅[https://developers.google.com/doubleclick-gpt/reference#googletag.events.SlotRenderEndedEvent](https://developers.google.com/doubleclick-gpt/reference#googletag.events.SlotRenderEndedEvent)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-12T19:05:06.933

我破解了 googletag 的 debug_log.log 函数并通过 jQuery 推送它来触发许多 DFP 操作的事件。hack 确实需要 jQuery。

[https://github.com/mcountis/dfp-events](https://github.com/mcountis/dfp-events)

*   gpt-google_js_loaded
*   gpt-gpt_fetch
*   gpt-gpt_fetched
*   gpt-page_load_complete
*   gpt-queue_start
*   gpt-service_add_slot
*   gpt-service_add_targeting
*   gpt-service_collapse_containers_enable
*   gpt-service_create
*   gpt-service_single_request_mode_enable
*   gpt-slot_create
*   gpt-slot_add_targeting
*   gpt-slot_fill
*   gpt-slot_fetch
*   gpt-slot_receiving
*   gpt-slot_render_delay
*   gpt-slot_rendering
*   gpt-slot_rendered

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-08-21T06:18:00.957

在页面的一部分中加载脚本：

```
// set global variable if not already set
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];

// load asynchronously the GPT JavaScript library used by DFP,
// using SSL/HTTPS if necessary
(function() {
  var gads   = document.createElement('script');
  gads.async = true;
  gads.type  = 'text/javascript';

  var useSSL = 'https:' === document.location.protocol;
  gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
  var node =document.getElementsByTagName('script')[0];
  node.parentNode.insertBefore(gads, node);
})(); 
```

使用以下脚本初始化 google 发布者标签，最好在页面的部分中：

```
// can be moved as well in the body
// if using async mode, wrap all the javascript into googletag.cmd.push!
googletag.cmd.push(function() {
  // set page-level attributes for ad slots that serve AdSense
  googletag.pubads().set("adsense_background_color", "FFFFFF");
  googletag.pubads().setTargeting("topic","basketball");

  // enables Single Request Architecture (SRA)
  googletag.pubads().enableSingleRequest();

  // Disable initial load, we will use refresh() to fetch ads.
  // Calling this function means that display() calls just
  // register the slot as ready, but do not fetch ads for it.
  googletag.pubads().disableInitialLoad();

  // Collapses empty div elements on a page when there is no ad content to display.
  googletag.pubads().collapseEmptyDivs();

  // Enables all GPT services that have been defined for ad slots on the page.
  googletag.enableServices();
}); 
```

单独注册插槽（可以使用 foreach 循环生成）并渲染它们。事件侦听器也可以按插槽注册。这里是重要的部分：确保一起刷新它们以避免在两个插槽上出现相同的广告（如果广告分配给两个插槽）=> googletag.pubads().refresh([slot1, slot2]]) ;

```
// this code can be moved externally to improve performance
googletag.cmd.push(function() {
  // define slot1
  slot1 = googletag.defineSlot(
    "/1234/travel/asia/food",
    [728, 90],
    "banner1"
  )
  .addService(googletag.pubads())
  .setTargeting(
    "interests",
    ["sports", "music", "movies"]
  );
  // prerender the slot but don't display it because of disableInitialLoad()
  googletag.display("banner1");

  // define slot2    
  slot2 = googletag.defineSlot(
    "/1234/travel/asia/food",
    [[468, 60], [728, 90], [300, 250]],
    "banner2"
  )
  .addService(googletag.pubads())
  .setTargeting("gender", "male")
  .setTargeting("age", "20-30");

  // prerender the slot but don't display it because of disableInitialLoad()
  googletag.display("banner2");  

  // add event to sign the slot as redered or not
  googletag.pubads().addEventListener('slotRenderEnded', function(event) {
    if (event.slot === slot1 || event.slot === slot2) {
      // do something related to the slot
    }
  });

  // refresh all container ads and show them
  // very important to call refresh with an array to avoid 
  // multiple callback to the registered event 
  googletag.pubads().refresh([slot1, slot2]);
}); 
```

```
<div id="banner1" style="width:300px; height:250px;"></div>

<div id="banner2" style="width:300px; height:250px;"></div> 
```

广告呈现后，将触发回调。

有关更多信息，请查看此文件： [https ://github.com/davidecantoni/googletag](https://github.com/davidecantoni/googletag)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-13T21:08:45.843

我很确定 DFP 在广告呈现后不会提供回调。我已经使用以下代码来执行此操作。它在发生以下情况之一后调用回调函数：

- 广告已加载且 iframe 已呈现

-没有加载广告，广告单元被collapseEmptyDivs()隐藏

- 已经过了一定时间（在本例中为 2 秒），但都没有发生。就像连接到 DFP 时出现某种网络错误一样。

adId 将是您的广告容器的 id

假设您正在使用 jQuery

```
function callback() {
   //your callback function - do something here
}

function getIframeHtml(iframe) {
   if(iframe.contentWindow && iframe.contentWindow.document && iframe.contentWindow.document.body && iframe.contentWindow.document.body.innerHTML) {
       return iframe.contentWindow.document.body.innerHTML;
   }
   return null;
}

var dfpNumChecks = 20;
var dfpCheckCount = 0;
var dfpCheckTimer = 100;

function dfpLoadCheck(adId) {
   var nodes = document.getElementById(adId).childNodes;

   if(nodes.length && nodes[0].nodeName.toLowerCase() == 'iframe' && getIframeHtml(nodes[0])) {
       //the iframe for the ad has rendered
       callback();
       return;
   } else if($('#' + adId).css('display') == 'none' || (dfpCheckCount >= dfpNumChecks)) {
       //the ad unit has been hidden by collapseEmptyDivs()
       callback();
       return;
   } else {
       dfpCheckCount++;
       setTimeout(function() { dfpLoadCheck(adId) }, dfpCheckTimer); 
   }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-09T22:25:45.123

查看我正在开发的[jQuery DFP](https://github.com/coop182/jquery.dfp.js)扩展...它仍在进行中，但提供了您所追求的回调。

如何使用它的一个例子在[这个文件](https://github.com/coop182/jquery.dfp.js/blob/master/example-bootstrap.js)中。

您将看到两个可用的回调......在每个广告加载后和所有广告加载后。广告单元容器元素上还设置了一个类，它可以是 display-none（未找到广告时）、display-block（找到广告时）或 display-original（未找到广告但容器 div 一开始就包含内容，我在需要时使用它来覆盖带有广告内容的网站的某些部分）。在回调中使用这些类当然很有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-26T10:01:32.903

如果您需要识别特定广告位的渲染结束（如果您对多个广告位使用相同的广告素材，这很有用），您可以执行以下操作

```
googleAd =  googletag.defineSlot('/xxxxx/web_top_AAAxAAA', [xxx, xxx], 'div-id').addService(googletag.pubads());    

googletag.pubads().addEventListener('slotRenderEnded', function(event) {
                    if( event.slot.W == googleAd.W ){
                        // your code here
                    }
                }); 
```

# mysql - 无法在 MySQL 5.0 中创建存储过程。不知道怎么了

> ID：11218201
> 
> 赞同：1
> 
> 时间：2012-06-27T01:28:34.680
> 
> 标签：mysql, stored-procedures, rank

下面是我创建 SP 的代码，该 SP 将从表中检索高分列表。MySQL 一直告诉我它无法创建存储过程并检查我的语法，即使我可以在没有存储过程的情况下在表上正常运行查询。任何帮助将不胜感激

```
USE `froggame`;
DROP procedure IF EXISTS `sp_GetHighScores`;
DELIMITER $$
USE `froggame`$$
CREATE PROCEDURE `froggame`.`sp_GetHighScores` (
IN p_StartFrom     INT)
BEGIN
SELECT
    h.PlayerName,
    h.Score,
    h.Accuracy,
    h.TimePlayed,
     @rownum := @rownum + 1 as Rank
FROM
    HighScores h
    JOIN
        (SELECT @rownum := 0) r
ORDER BY
    h.Score DESC
LIMIT 50 OFFSET p_StartFrom;
END
$$
DELIMITER ; 
```

谢谢，

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:43:30.913

我刚刚复制了你的 SQL，它在 Mysql 5.5 中对我有用。mysql报什么错误？（我正在使用 HeidiSQL 7 进行测试）

# ruby-on-rails - 使用 Tanker 和 Searchify 搜索帖子的用户

> ID：11218203
> 
> 赞同：0
> 
> 时间：2012-06-27T01:28:43.640
> 
> 标签：ruby-on-rails, post, indextank, searchify

如标题所述，我正在`tankit`我的模型中寻找允许为帖子用户建立索引的索引方法。在我的模型中，我有：

```
 tankit 'idx' do 
      indexes :title
      indexes :content
      indexes :post_loc
      indexes :user_id   
    end 
```

但是，这只允许搜索用户的 id。这不是我想要的。所有用户都有一个用户名，我希望能够通过该用户名进行搜索以显示该用户的所有报告。我想做类似的事情`indexes :(User.find(user_id).username)`或沿着那条线做一些事情，但这不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-12T15:15:36.423

假设您有一个名为“用户”的关联，您需要添加这种方法来索引关联值：

```
tankit 'idx' do 
  indexes :title
  indexes :content
  indexes :post_loc
  indexes :username do 
     user.username
  end
end 
```

您甚至可以为一对多关联映射多个值：

```
indexes :userlocations
    user.locations.map {|l| l.cityname }
end 
```

# android - 我们可以在 init.rc 中更改 /system 或 /data 的模式吗

> ID：11218204
> 
> 赞同：0
> 
> 时间：2012-06-27T01:28:44.257
> 
> 标签：android, android-emulator, android-ndk

在 init.rc 中，我可以看到以下代码：

```
 mkdir /system
 mkdir /data 0771 system system 
```

所以，我想知道我们可以通过重写这样的命令来改变 init.rc 中 /system 或 /data 的模式。Acutally，我已经做了一个测试。我将上面的代码更改为以下代码：

```
mkdir /system 0777 
mkdir /data 0777 system system 
```

但是，不幸的是，它失败了。所以，我想到了两个问题。

1.  是否有任何其他初始化脚本会改变这两个目录的模式？
2.  我的代码是否以正确的语言形式正确书写？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T07:03:02.100

我想仅更改 init.rc 文件是不够的。`system/core/include/private/android_filesystem_config.h`Android还在镜像创建过程中内置的文件中指定了一些目录和文件的权限。

# javascript - 在画布内呈现的 HTML

> ID：11218205
> 
> 赞同：1
> 
> 时间：2012-06-27T01:29:03.203
> 
> 标签：javascript, css, html, canvas

我正在寻找一种解决方法来即兴`-moz-element()`使用`-vendor-canvas()`本质上“快照”一个元素，以便在不需要实际克隆 DOM 的情况下克隆它。有没有办法将实际的 HTML 元素放置在画布中以在其中呈现或再现？如果不是，您将如何处理这样的任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:55:42.640

HTML2Canvas 真的是你最好的选择：http: [//html2canvas.hertzen.com/](http://html2canvas.hertzen.com/)

这可能是未来的画布功能。规范内容如下：

> 2D 上下文 API 的未来版本可能会提供一种将使用 CSS 渲染的文档片段直接渲染到画布的方法。这将优先于进行多行布局的专用方式提供。

...但不是今天，而且可能*至少*几个月都不会。最近在画布规范中添加了更多内容（独立路径`drawEllipse`、、、、 ） `currentTransform`，`resetClip`并且 hixie 喜欢批量添加东西，首先等待主要浏览器采用最后一批的 ~90%。所以会有一段时间。

# php - 在编辑页面中显示选定的单选按钮

> ID：11218207
> 
> 赞同：1
> 
> 时间：2012-06-27T01:29:20.657
> 
> 标签：php, mysql

在我的编辑页面上，如果 $subscribedrips 等于是或否，我将如何显示正确的单选按钮？这是我所拥有的，但它不起作用：

```
 if ($row['subscribedrips'] == Yes) { 
  echo 
  '<input type="radio" name="subscribedrips" value="Yes" CHECKED /> Yes 
  <input type="radio" name="subscribedrips" value="No" /> No';
  }
  elseif ($row['subscribedrips'] == No) {
  echo 
  '<input type="radio" name="subscribedrips" value="Yes" /> Yes 
  <input type="radio" name="subscribedrips" value="No" CHECKED/> No';
  }
  elseif (empty($row['subscribedrips'])) {
  echo 
  '<input type="radio" name="subscribedrips" value="Yes" CHECKED/> Yes 
  <input type="radio" name="subscribedrips" value="No" /> No';
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:42:18.053

像这样的东西

```
printf('<input type="radio" name="subscribedrips" value="Yes" %s /> Yes'."\n", 
    ($subscribedrips == 'Yes' ? 'CHECKED' : ''));
printf('<input type="radio" name="subscribedrips" value="No" %s /> No'."\n",   
    ($subscribedrips == 'No'  ? 'CHECKED' : '')); 
```

作品。它使用三元运算符`'CHECKED'`根据 的值将或空字符串插入到输入标签中`$subscribedrips`。

您还可以以更详细的方式进行操作，例如使用 switch：

```
$sel_y = '';
$sel_n = '';
switch($subscribedrips)
{
    case 'Yes':
        $sel_y = 'CHECKED';
        break;
    case 'No':
        $sel_n = 'CHECKED';
        break;
    default:
        // Neither need to be changed, so we dont even need this branch
        break;
}

printf('<input type="radio" name="subscribedrips" value="Yes" %s /> Yes'."\n", $sel_y);
printf('<input type="radio" name="subscribedrips" value="No" %s /> No'."\n",   $sel_n); 
```

个人喜好真的。

* * *

***更新片段 1***

```
printf('<input type="radio" name="subscribedrips" value="Yes" %s /> Yes'."\n", 
    ((array_key_exists('subscribedrips', $row) && $row['subscribedrips'] == 'Yes') ? 'CHECKED' : ''));
printf('<input type="radio" name="subscribedrips" value="No" %s /> No'."\n",   
    ((array_key_exists('subscribedrips', $row) && $row['subscribedrips'] == 'No')  ? 'CHECKED' : '')); 
```

***更新片段 2***

```
$sel_y = '';
$sel_n = '';
if(array_key_exists('subscribedrips', $row))
{
    switch($row['subscribedrips'])
    {
        case 'Yes':
            $sel_y = 'CHECKED';
            break;
        case 'No':
            $sel_n = 'CHECKED';
            break;
        default:
            // Neither need to be changed, so we dont even need this branch
            break;
    }
}

printf('<input type="radio" name="subscribedrips" value="Yes" %s /> Yes'."\n", $sel_y);
printf('<input type="radio" name="subscribedrips" value="No" %s /> No'."\n",   $sel_n); 
```

* * *

关于您的最后一个问题，我们的方法之间的区别非常简单，但再一次（啊！）它是一种风格选择，两者都实现了相同的目标，两种方法都用于“生产”PHP 代码。

我的示例在 PHP 中构建了整个输入标记并打印出来。Valentinas 的方法将静态文本从 PHP 字符串中提取出来，并将其直接放入 HTML。

例如，以下行都将产生相同的输出：

```
<?php printf("<strong>%s</strong>", $some_string); ?>

<?php echo "<strong>$some_string</strong>"; ?>

<?php echo "<strong>".$some_string."</strong>"; ?>

<strong><?php echo $some_string; ?></strong> 
```

我怀疑这两种方法之间是否存在任何显着的性能差异，但我将强调一个外观差异。

*   **语法高亮**- 如果您使用带有语法高亮功能的编辑器，valentinas 的方法将允许语法高亮器适当地高亮`input`标签及其属性。使用我的方法，整个字符串将被突出显示。 [这是一个屏幕截图](http://i.imgur.com/hnKNv.png)，显示了 notepad++ 如何突出显示这两种方法。

    正如您所看到的，valentinas 的方法产生了更加丰富多彩的显示，这有助于识别和追踪错误。

如果您想有条件地打印整个标签，那么在如何格式化您的代码时会有一些细微的差异，但它们并不值得讨论——在我看来，最大的差异是语法突出显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T05:49:21.957

上面介绍的所有代码都可以工作，但它们看起来很大或没有更多的行，如果我们像上面那样使用可能有很好的方法我有一个更好和简单的方法来显示单选按钮的值页

添加形式的代码：

```
<td>Gender</td>
              <td><input type="radio" name="emp_gender" id="emp_gender" value="M" />Male
              <input type="radio" name="emp_gender" id="emp_gender" value="F" />Female</td> 
```

现在如果你想编辑性别字段那么你必须带上之前选择的值

为此，我的代码是

```
<td>Gender</td>
              <td><input type="radio" name="emp_gender" id="emp_gender" value="M" <?php echo ($emp_gender == 'M')? "CHECKED" : " " ?> />Male
              <input type="radio" name="emp_gender" id="emp_gender" value="F" <?php echo ($emp_gender == 'F')? "CHECKED" : " " ?> />Female</td> 
```

以上粗体线对于将单选按钮的值带到编辑表单中很重要

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:42:45.567

它会在值附近缺少“”吗？

```
if ($subscribedrips == "Yes") { 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T01:59:21.900

也许是这样的：

```
<?php $subscribedrips = $row['subscribedrips']; ?>
<input type="radio" name="subscribedrips" value="Yes" <?php echo ($subscribedrips == 'Yes') ?  "checked" : "" ;  ?>/> Yes 
<input type="radio" name="subscribedrips" value="No" <?php echo ($subscribedrips == 'No') ? "checked" : "" ;  ?>/> No 
```

我喜欢从 PHP 标记中提取标记 - 使其更具可读性。

# java - Java 包可以与 .NET 中的什么进行比较？

> ID：11218208
> 
> 赞同：1
> 
> 时间：2012-06-27T01:29:30.857
> 
> 标签：java, naming-conventions, packages

我已经使用 .NET 多年，但最近我遇到了一个简单的 Java 项目。语法很容易学习 - 非常简单和常见。然而，最让我困惑的是项目结构。

在 .NET 中，我非常习惯于使用类来包含我的不同内容，但是，这`Packages`让我感到困惑。它们看起来几乎像 .NET 命名空间，只是它们实际上会影响项目目录布局。

不仅如此，命名约定对我来说绝对是陌生的。我被告知要使用公司网站反向命名软件包，并在末尾加上应用程序名称（例如`com.company.www.applicationname`）。不仅如此，我还被告知将主类命名为应用程序的名称。现在看起来几乎是多余的（类名、包名和项目名）。

那么这一切是怎么回事呢？我可以将这些包与 .NET 中的哪些包进行比较，我该如何理解它们？*- 命名约定是什么？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:41:43.710

`packages`在 Java 中是一种实现方式，以便不同的库可以重用类名而不会相互冲突。包就像语言提供的另一个范围规则。例如：

```
public class Example {
    String exampleString = "example";
}

public class Another {
    String exampleString = "This would never work with a global name space";
} 
```

我们可以在同一个程序中拥有两个`String`具有标识符的对象，`exampleString`因为它们位于不同的`scope`. 相似地，

```
package example;
public class Example { } 
```

并在一个单独的文件中

```
package separateexample;
public class Example {} 
```

我们可以有一个同名的类名，因为它是不同的作用域。我们仍然可以唯一地指定对象：

`example.Example`或`separaeteexample.Example` 这些是这些类的完全限定类名。

有关更多信息，请查看[java 教程](http://docs.oracle.com/javase/tutorial/java/package/packages.html)

至于 Java 包的约定：如果你想写一个库并且有很多人使用它，你需要确保没有命名冲突。可以像上面那样使用包来避免它们 - 但为了确保不会发生冲突，例如包名称本身，您需要一个完全全球唯一的包名称，您可以确保在尝试使用时没有其他公司会使用使用您的产品。域名恰好是全球唯一的字符串，因此将您的公司域名用作包名是惯例，相反。

```
com.example.myapp.Example 
```

只要您真正拥有 example.com，就永远不会发生冲突（并且没有人违反惯例）

因此，在 Java 中回答您的主要问题与.Net`packages`中的概念相同`namespaces`

# java - 将公共构造函数添加到 JPA 字段注释的 POJO

> ID：11218211
> 
> 赞同：0
> 
> 时间：2012-06-27T01:30:13.860
> 
> 标签：java, hibernate, jpa

我对字段访问 JPA 注释的 POJO 感到非常困惑。

当它们是私有的时，你应该如何设置（或获取）这些字段？我更喜欢使用字段注释（我没有使用 getter/setter 方法），但我对它的工作方式有点困惑。

我可以向我的 POJO 添加一个公共构造函数，以便我可以轻松设置字段吗？我应该为我知道需要访问的字段添加 getter 方法吗？我应该只公开所有字段吗？

现在，我想我预见我的 POJO 看起来像这样：字段访问、公共构造函数和 @Transient 注释对修改原始 DB 数据的函数 - 例如将日期包装到 Date 对象（从存储的 MS 值转换）等。

我的 POJO 和 DAO 即将进行我的第一次测试。我以前从未运行过休眠代码，只是学习了几个星期。我很兴奋，这个问题的答案应该让我克服困难。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:54:18.267

我也是hibernate的初学者..根据我读过的内容，你无法避免拥有getter或setter，并且可以拥有公共构造函数。我使用公共构造函数来填充 bean。

# php - 如何使用 .ajax 提取 mysql 数据并用它填充表单

> ID：11218213
> 
> 赞同：1
> 
> 时间：2012-06-27T01:30:21.597
> 
> 标签：php, javascript, mysql, ajax

我有一个用户创建返回码的字段。表单数据存储在 MySQL 数据库中，如果该用户返回并使用相同的返回代码，它将从数据库中提取记录并填满大部分数据库以节省用户时间。我不知道该怎么做。我正在为数据库使用 MySQL 和 PHP，但我不知道如何在 JavaScript 中使用 .ajax 来进行拉取或如何获取该数据并填写表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:45:49.967

在 PHP 中，通过 JSON 对数据进行编码`json_encode()`，然后`$.get`在客户端进行编码。然后，您可以像访问任何其他 JSON 对象一样访问数据。要设置表单值，你会做`$('#formfield').val( myobj.property1 );`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:03:20.727

正如大卫所说，使用 jquery ajax api 可能会让你更容易。因此，您的客户端代码可能类似于：

```
var request = $.ajax(url: 'your_php_script.php', 
                     datatype: 'json',
                     success: function() {
                     request = $.parseJSON(request.responseText);

                     ...The rest of your javascript code to read the 
                     ...json and fill in the form.
                     ...
               }); 
```

这是一个有用的[链接](http://www.w3schools.com/ajax/default.asp)

# mysql - SQL Server 自动递增下一个 INSERT 查询

> ID：11218214
> 
> 赞同：1
> 
> 时间：2012-06-27T01:30:21.653
> 
> 标签：mysql, sql, sql-server, null, auto-increment

我在 MySQL 方面有很好的背景，但我对 SQL Server 的来龙去脉还很陌生。我将通过在 MySQL 中设置和解决完全相同的问题来问我的问题：

* * *

创建表：

```
CREATE TABLE IF NOT EXISTS `example` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `stuff` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ; 
```

在表中插入一个值：

```
INSERT INTO `example` (
  `id`, `stuff`
) VALUES (
  NULL, 'Hello World'
) ; 
```

通过执行上面的查询，该`id`列将自动接收下一个可用整数用作主键，我不参与任何工作。

但是，在类型的 SQL Server 表中插入行时尝试相同的想法`int`会给我这个错误：

```
Cannot insert the value NULL into column 'id', table 'database.user.example'; column does not allow nulls. INSERT fails. (severity 16) ... 
```

在 SQL Server 查询中可以使用什么来`INSERT`自动增加主键，就像 MySQL 对`NULL`值所做的那样？

感谢您的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T01:34:40.490

您是否在列定义中将该列设置为 IDENTITY 列？

```
CREATE TABLE example (ID int IDENTITY(1,1), Stuff VARCHAR(255))

INSERT INTO example (Stuff) VALUES ('Hello World!') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T01:34:38.493

那是您需要的身份列。@Mark Byers 是正确的。只需省略列

# url - 为什么我的网站布局通过添加 www 会发生如此巨大的变化。

> ID：11218217
> 
> 赞同：1
> 
> 时间：2012-06-27T01:31:11.460
> 
> 标签：url, layout, web

当我使用 url 查看我的网站时

## 例子.com

我得到这样的东西： ![在此处输入图像描述](../Images/d3ad517f8b8a9842bb21051f6228ca62.png)

但是当我使用网址时

## www.example.com

我得到了这场灾难： ![在此处输入图像描述](../Images/724b10c3438e83799dec01e780b31294.png)

谁能解释我做错了什么？

问候。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:34:34.617

这没有任何意义。您是否有 .htaccess 规则阻止通过 www.example.com 主机名访问某些资源？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T01:43:56.297

实际上一个可能的答案...从您的屏幕截图的外观..检查您的页面“缩放”设置在浏览器设置中..这是按域保存的，因此请确保其 100%

# javascript - 使用 js sdk 触发 facebook 动作“点赞”

> ID：11218218
> 
> 赞同：4
> 
> 时间：2012-06-27T01:31:22.660
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk

通过 FB 的 js sdk 触发“喜欢”动作的正确语法是什么？自定义操作如下所示：

```
FB.api('/me/recipebox:cook', 'post', 
  { recipe : 'http://www.example.com/pumpkinpie.html' }); 
```

根据：[https ://developers.facebook.com/docs/opengraph/actions/#create](https://developers.facebook.com/docs/opengraph/actions/#create)

* * *

*编辑* - 这是我最终使用的：

```
 $("#testLink").click(function(){
                    $.post("https://graph.facebook.com/<?php echo $user_profile[id]; ?>/og.likes", 
                        {
                            access_token: FB.getAuthResponse()['accessToken'], 
                            object: "http://www.matrym.com/fb/temp.php" 
                        },
                        function(data) {
                            alert("Data Loaded: " + data);
                        }
                    );
                }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T01:38:51.283

一旦满足以下条件...

> 只要满足以下条件，应用程序就可以代表用户发布内置的 Like 操作：
> 
> *   应用内内容的查看者是拥有 Facebook 身份验证并授予应用 publish_actions 权限的 Facebook 用户
> *   应用内内容具有使用 Open Graph 元标记正确标记的 Open Graph 对象页面
> *   观看者故意点击了与应用内内容相关的应用内“点赞按钮”

你像这样调用 API：

```
FB.api('/{object id}/likes', 'post'); 
```

参考：[https ://developers.facebook.com/docs/opengraph/actions/builtin/likes/](https://developers.facebook.com/docs/opengraph/actions/builtin/likes/)

“喜欢”必须由网站管理员预先配置，否则 Facebook 不知道您实际“喜欢”什么。每个赞都有一个与之关联的对象 ID。如果是您自己的网站，您必须设置您网站上的哪些内容可以被点赞（FB 会为其关联一个 ID），然后您可以代表用户为该对象提交一个赞。

# c# - 有没有办法在c#中指定运行时的方法

> ID：11218223
> 
> 赞同：1
> 
> 时间：2012-06-27T01:32:32.720
> 
> 标签：c#

我有一个我想调用的方法列表，命名为 Method1、Method2 等。有没有办法我可以输入那个数字然后调用等效的方法？代表是我想到的一件事。这行得通吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T01:35:45.890

您可以使用反射：

```
MyClass myObj = ...;
var method = typeof(MyClass).GetMethod("Method"+num);
var res = method.Invoke(myObj, new object[] {arg1, arg2}); 
```

您还可以使用代表字典：

```
var byNumber = new Dictionary<int,Func<MyClass,int>> {
    {1, (c) => c.Method1()}
,   {2, (c) => c.Method2()}
,   {3, (c) => c.Method3()}
};

var res = byNumber[1](myObj); 
```

# c# - C# 结构中的数组是否会破坏性能优势？

> ID：11218224
> 
> 赞同：3
> 
> 时间：2012-06-27T01:32:33.613
> 
> 标签：c#, performance, optimization

据推测，C# 结构相对于轻量级数据对象的类具有一些性能优势，因为它们完全存储在堆栈上，而不是分配堆内存。

如果该结构的成员之一是 int[] 或结构数组，那么这对分配有什么影响以及我可能从中获得的任何其他性能优势？

例子：

```
struct A
{
    int foo;
    int bar;
}

struct B
{
   int[] foos;
   A[] bars;
} 
```

struct A 在性能、内存使用等方面与 struct B 有何不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:38:55.497

由于大小不是类型的一部分，因此必须动态分配数组。所以你的结构只包含一个指向数组的指针。

结构本身是堆栈分配的*，但数组内容仍在堆上。

*通常。在某些情况下，值类型是堆分配的，例如作为匿名方法中使用的外部变量。当然，如果它是堆分配的对象的一部分，则结构会在堆上内联分配。可能还有其他一些极端情况，但这并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T15:29:44.287

结构中的数组不会破坏结构的堆栈与堆分配带来的性能优势。如果你真的有好处;)。创建数组实例时，结构中的数组将在堆上分配。

# hibernate - 尽管设置了方言，但“没有可用连接时必须设置'hibernate.dialect'”错误

> ID：11218230
> 
> 赞同：0
> 
> 时间：2012-06-27T01:33:18.093
> 
> 标签：hibernate, ant, code-generation, hibernate-tools, hbm2java

我曾尝试运行 hibernatetool Ant 任务，但一直未成功。Help。这些罐子来自我的 eclipse(3.7.2) 休眠工具插件(3.4)。我得到一个 org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available 尽管设置了方言

这是我的 build.xml：

```
<project>
<target name="genero">
    <path id="toolslib">
        <path location="mylibs/hibernate-tools.jar" />
        <path location="mylibs/hibernate3.jar" />
        <path location="mylibs/freemarker.jar" />
        <path location="mylibs/postgresql-9.0-802.jdbc4.jar" />
        <path location="mylibs/dom4j-1.6.1.jar" />
        <path location="mylibs/commons-logging-1.0.4.jar" />
        <path location="mylibs/slf4j-api-1.5.8.jar" />
        <path location="mylibs/slf4j-log4j12-1.5.8.jar" />
        <path location="mylibs/log4j-1.2.15.jar" />
        <path location="mylibs/cglib-2.2.jar" />
        <path location="mylibs/asm.jar" />
        <path location="mylibs/commons-collections-3.1.jar" />

        <path location="mylibs/slf4j-api-1.5.8.jar" />          

    </path>

    <taskdef name="hibernatetool" classname="org.hibernate.tool.ant.HibernateToolTask" classpathref="toolslib" />

    <hibernatetool>
        <jdbcconfiguration propertyfile="src/hibernate.cfg.xml" packagename="demo" revengfile="src/hibernate.reveng.xml" />

        <hbm2hbmxml destdir="${build.dir}/src" />
        <hbm2java jdk5="true" destdir="${build.dir}/src" />

    </hibernatetool>
</target> 
```

还有我的 hibernate.cfg.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</property>
        <property name="hibernate.connection.driver_class">org.postgresql.Driver</property>
        <property name="hibernate.connection.password">blablabla</property>
        <property name="hibernate.connection.url">jdbc:postgresql://localhost:5432/projteste</property>
        <property name="hibernate.connection.username">postgres</property>

    </session-factory>
</hibernate-configuration> 
```

和堆栈跟踪：

```
 Apache Ant(TM) version 1.8.2 compiled on December 20 2010
Buildfile: C:\Users\mrtykop\workspace2\testjavahib\build.xml
parsing buildfile C:\Users\mrtykop\workspace2\testjavahib\build.xml with URI = file:/C:/Users/mrtykop/workspace2/testjavahib/build.xml
Project base dir set to: C:\Users\mrtykop\workspace2\testjavahib
Build sequence for target(s) `genero' is [genero]
Complete build sequence is [genero, ]
genero:
parsing buildfile jar:file:/E:/jave/eclipse/plugins/org.apache.ant_1.8.2.v20120109-1030/lib/ant.jar!/org/apache/tools/ant/antlib.xml with URI = jar:file:/E:/jave/eclipse/plugins/org.apache.ant_1.8.2.v20120109-1030/lib/ant.jar!/org/apache/tools/ant/antlib.xml from a zip file
Property "build.dir" has not been set
Property "build.dir" has not been set
[hibernatetool] Executing Hibernate Tool with a JDBC Configuration (for reverse engineering)
[hibernatetool] 1\. task: hbm2hbmxml (Generates a set of hbm.xml files)
[hibernatetool] log4j:WARN No appenders could be found for logger (org.hibernate.cfg.Environment).
[hibernatetool] log4j:WARN Please initialize the log4j system properly.
[hibernatetool] An exception occurred while running exporter #2:hbm2hbmxml (Generates a set of hbm.xml files)
[hibernatetool] To get the full stack trace run ant with -verbose
[hibernatetool] org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available

BUILD FAILED
C:\Users\mrtykop\workspace2\testjavahib\build.xml:26: org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available
    at org.hibernate.tool.ant.HibernateToolTask.reportException(HibernateToolTask.java:226)
    at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:189)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:390)
    at org.apache.tools.ant.Target.performTasks(Target.java:411)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    at org.eclipse.ant.internal.launching.remote.EclipseDefaultExecutor.executeTargets(EclipseDefaultExecutor.java:32)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.eclipse.ant.internal.launching.remote.InternalAntRunner.run(InternalAntRunner.java:424)
    at org.eclipse.ant.internal.launching.remote.InternalAntRunner.main(InternalAntRunner.java:138)
Caused by: org.hibernate.HibernateException: 'hibernate.dialect' must be set when no Connection available
    at org.hibernate.dialect.resolver.DialectFactory.buildDialect(DialectFactory.java:107)
    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:142)
    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2163)
    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2155)
    at org.hibernate.cfg.JDBCMetaDataConfiguration.readFromJDBC(JDBCMetaDataConfiguration.java:41)
    at org.hibernate.tool.ant.JDBCConfigurationTask.doConfiguration(JDBCConfigurationTask.java:83)
    at org.hibernate.tool.ant.ConfigurationTask.getConfiguration(ConfigurationTask.java:55)
    at org.hibernate.tool.ant.HibernateToolTask.getConfiguration(HibernateToolTask.java:302)
    at org.hibernate.tool.ant.HibernateToolTask.getProperties(HibernateToolTask.java:318)
    at org.hibernate.tool.ant.ExporterTask.configureExporter(ExporterTask.java:94)
    at org.hibernate.tool.ant.ExporterTask.execute(ExporterTask.java:39)
    at org.hibernate.tool.ant.HibernateToolTask.execute(HibernateToolTask.java:186)
    ... 16 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T14:30:47.240

这太不可思议了。阅读文档时的一个小错误会毁了你一整天。
我不得不用 propertyfile="hibernate.properties" 替换 propertyfile="src/hibernate.cfg.xml"。
（指定我也可以使用 hibernate.cfg 文件，但像这样：**configurationfile** =“src/hibernate.cfg.xml”）我还添加了另一个 jar。新的 build.xml

```
<project>
    <target name="genero">
        <path id="toolslib">
            <path location="mylibs/hibernate-tools.jar" />
            <path location="mylibs/hibernate3.jar" />
            <path location="mylibs/freemarker.jar" />
            <path location="mylibs/postgresql-9.0-802.jdbc3.jar" />
            <path location="mylibs/dom4j-1.6.1.jar" />
            <path location="mylibs/commons-logging-1.0.4.jar" />
            <path location="mylibs/slf4j-api-1.5.8.jar" />
            <path location="mylibs/slf4j-log4j12-1.5.8.jar" />
            <path location="mylibs/log4j-1.2.15.jar" />
            <path location="mylibs/cglib-2.2.jar" />
            <path location="mylibs/asm.jar" />
            <path location="mylibs/commons-collections-3.1.jar" />

            <path location="mylibs/jtidy-r8-20060801.jar"/>         
        </path>

        <taskdef name="hibernatetool" classname="org.hibernate.tool.ant.HibernateToolTask" classpathref="toolslib" />

        <hibernatetool>
            <jdbcconfiguration configurationfile="src/hibernate.cfg.xml"  revengfile="hibernate.reveng.xml" packagename="demo"  />
            <hbm2hbmxml destdir="src" />

            <hbm2java jdk5="true" destdir="src" />

        </hibernatetool>
    </target>
</project> 
```

reveng.xml 文件只需使用 hibernatetools 插件对其进行编辑

有趣的是没有人注意到这个错误（不知道有多少人看过它）

顺便说一句，我的灵感来自这篇文章：[Dialect not getting set in hibernate](https://stackoverflow.com/questions/6818978/dialect-not-getting-set-in-hibernate)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T17:05:18.940

试试这个

```
Configuration config = new Configuration();
config.configure("hibernate.cfg.xml"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:40:43.953

对真正的问题一无所知，但我们很久以前就有了，据我所知，获取更新的 JDBC 驱动程序有所帮​​助。

编辑：

似乎这不是这个问题的正确答案。不过，我不会删除它，因为不久前我们遇到了同样的问题，而这个解决方案对此有所帮助。

对不起@geogeorge，我帮不上忙:(

# java - 如果数字像 $12.5，则添加 0 结束

> ID：11218231
> 
> 赞同：3
> 
> 时间：2012-06-27T01:33:30.870
> 
> 标签：java, android

> **可能重复：**
> [Java 中的美元货币格式](https://stackoverflow.com/questions/3075743/usd-currency-formatting-in-java)

全部-我有一个小问题，我的应用程序在输入经过一个方程式后输出答案，并在小数点后四舍五入到小数点后两位。我的问题是，如果这个数字甚至像 12.80 美元，那么输出看起来像 12.8 美元。我希望它看起来像 12.80 美元。不是最大的交易，但我正处于开发的最后阶段，并且想清理它以看起来不错。这是我的一些代码：

```
 Float result2 = result / l3;

    double data2 = result2; 

    int decimalPlaces2 = 2;
    double roundBase2 = Math.pow(10, decimalPlaces2);
    data2 = (double)(Math.round(data2 * roundBase2)) / roundBase2;

    answer.setText("$" + Double.toString(data2)); 
```

谢谢你的时间！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T01:35:52.480

```
DecimalFormat format = new DecimalFormat("$#");
format.setMinimumFractionDigits(2);
answer.setText(format.format(data2)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:42:19.163

我喜欢这样做：

```
float a = 12.5;

String money = String.format("$%.2f", a); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:37:26.403

这不是专门针对 Android 的，但您可以使用 DecimalFormat 自定义显示的小数位数和类型。

[例子](http://www.javaprogrammingforums.com/java-programming-tutorials/297-how-format-double-value-2-decimal-places.html)

# objective-c - 使用自省restkit的对象映射

> ID：11218246
> 
> 赞同：0
> 
> 时间：2012-06-27T01:35:53.500
> 
> 标签：objective-c, ios, restkit, introspection

我正在尝试使用 RestKit 解析 SOAP 响应。如果我自己定义映射和关系，我就能够成功地将 SOAP XML 响应转换为对象。但是，我想知道是否可以使用自省（或其他方法）将 SOAP XML 响应自动转换为 Objective-C 对象。

示例 XML：

```
<return>
    <userId xsi:type="xsd:int">1113050187</userId>
    <location xsi:type="ns1:Location">
       <city xsi:type="xsd:string">San Francisco</city>
       <state xsi:type="xsd:string">California</state>
    </location>
</return> 
```

我想将此 XML 转换为此对象：

```
@interface Return : NSObject

@property (strong, nonatomic) NSInteger userId; // attribute
@property (strong, nonatomic) Location *location; // relation

@end 
```

我能想到的最接近的事情是在 Return 类上使用自省来获取所有属性，并对每个属性使用类似的东西：[mapping addAttributeMapping:[RKObjectAttributeMapping mappingFromKeyPath:@"userId.text" toKeyPath:@"userId"]] ;

对于关系，我可以再次使用自省来找出我所有的类对象并在每个对象上使用 mapRelationship:withMapping:

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T00:41:42.427

我最终定义了一个方法，如果它们的名称匹配，则递归地将属性映射到 XML 节点。命名约定和属性的数据类型对此很重要。

在将其发布到此处之前，我已尽力清理此内容，但如果您需要任何帮助，请告诉我。

```
- (RKObjectMapping *)mapMe:(Class)class
{
    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    RKObjectMapping *mapping = [RKObjectMapping mappingForClass:class];
    id classType = objc_getClass([NSStringFromClass(class) UTF8String]);
    unsigned int outCount, i;
    objc_property_t *properties = class_copyPropertyList(classType, &outCount);
    for (i = 0; i < outCount; i++) {
        objc_property_t property = properties[i];
//        fprintf(stdout, "%s\n", property_getName(property));

        const char *type = property_getAttributes(property);
        NSString *typeString = [NSString stringWithUTF8String:type];
        NSArray *attributes = [typeString componentsSeparatedByString:@","];
//        NSLog(@"attributes = %@", attributes);
        NSString *typeAttribute = [attributes objectAtIndex:0];
//        NSLog(@"typeAttribute = %@", typeAttribute);
        NSString *propertyType = [typeAttribute substringFromIndex:1];

        if ([propertyType hasPrefix:@"@"] && [propertyType length] > 1) {
            NSString * typeClassName = [propertyType substringWithRange:NSMakeRange(2, [propertyType length]-3)];  //turns @"NSDate" into NSDate
            Class typeClass = NSClassFromString(typeClassName);
            if (typeClass != nil && ![typeClassName hasPrefix:@"NS"]) {
//            my custom class detected.
                RKObjectMapping *subMapping = [self mapMe:typeClass forObjectManager:objectManager];
                [mapping mapRelationship:[NSString stringWithUTF8String:property_getName(property)] withMapping:subMapping];
                [objectManager.mappingProvider setMapping:subMapping forKeyPath:[NSString stringWithUTF8String:property_getName(property)]];
            } else {
                [mapping addAttributeMapping:[RKObjectAttributeMapping mappingFromKeyPath:[NSString stringWithFormat:@"%@.text", [NSString stringWithUTF8String:property_getName(property)]] toKeyPath:[NSString stringWithUTF8String:property_getName(property)]]];
            }
        }
    }
    free(properties);
    return mapping;
} 
```

然后映射它自动调用它：

```
[self mapMe:[Myclass class]]; 
```

# solr - SOLR 和词干

> ID：11218249
> 
> 赞同：1
> 
> 时间：2012-06-27T01:36:34.373
> 
> 标签：solr, stemming

有没有一种简单的方法可以简单地从 solr 中排除某些单词？我们有一个充满食物的数据库，每次我们搜索“炸虾”之类的东西时，它都会返回“炸虾配薯条”之类的结果

对于我们近 98% 的搜索，词干在所有其他情况下都可以正常工作，我们希望保持词干不变。

我们只需要从词干处理过程中省略某些词，例如“fries”和“fried”，这样它们是独一无二的，而不是彼此的变体。因此，当我们搜索“薯条”时，它只会找到“薯条”，而不是“炸鲶鱼”或任何带有“炸”字的东西。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T01:42:05.760

`solr.KeywordMarkerFilterFactory`应该保护单词不被阻塞。有关 SnowballPorterStemmer，请参阅[此页面。](http://wiki.apache.org/solr/LanguageAnalysis#Notes_about_solr.SnowballPorterFilterFactory)

# c# - Ajax 从多个 JSON 源加载数据

> ID：11218256
> 
> 赞同：0
> 
> 时间：2012-06-27T01:37:50.177
> 
> 标签：c#, javascript, asp.net, asp.net-mvc, razor

我正在使用带有 Razor2 的 ASP MVC4。我正在尝试使用 Javascript 来检索 JSON 数据并选择要显示的属性。每个线程都有自己的 JSON 文件，我一次显示 15 个线程。我无法一次获取所有数据，它会减慢页面加载时间。所以我认为客户端会很好，因为它不是敏感数据。

这是我的代码：

```
 public static PagedList<PiFDetailsModel> GetPagedThreads(int skip, int take)
    {
        using (var context = new PiFDbDataContext())
        {
            // refactor consideration...make this a pre-compiled query
            var threads = context.Threads
              .OrderBy(c => c.CreatedDate).Skip(skip).Take(take).ToList();

            var threadsCount = threads.Count();

            var details = new List<PiFDetailsModel>();
            foreach (Thread thread in threads)
            {
                var model = new PiFDetailsModel();

                var games = new List<Game>();
                // Make this AJAX instead.
                string text;
                try
                {
                    text = Utilities.GetThreadInfo(thread.ThingID)[0].data.children[0].data.selftext_html;
                    text = text.Replace("\n\n", "<br /><br />").Replace("\n", "<br />");
                }
                catch
                {
                    // TODO Handle exceptions better.
                    text = "Reddit is currently down or too busy, cannot retrieve information at this time";
                }

                foreach (ThreadGame game in thread.ThreadGames)
                {
                    if (games.Any(x => x.Name == game.Game.Name))
                    {
                        games.Find(x => x.Name == game.Game.Name).Count += 1;
                    }
                    else
                    {
                        var simpleGame = game.Game;
                        simpleGame.Count = 1;
                        games.Add(simpleGame);
                    }
                }

                model.Games = games;
                model.GameCount = thread.ThreadGames.Count;
                model.ThreadTitle = thread.Title;
                model.Username = thread.User.Username;
                model.CreatedDate = thread.CreatedDate;
                model.ThreadID = thread.ThingID;

              //  model.SelfText = new HtmlString(text);

                details.Add(model);
            }

            return new PagedList<PiFDetailsModel>
            {
                Entities = details,
                HasNext = skip + 10 < threadsCount,
                HasPrevious = skip > 0
            };
        }
    }

[OutputCache(Duration = 60 * 5)]
        public static dynamic GetThreadInfo(string thingID)
        {
            string uri = string.Format("http://www.reddit.com/{0}/.json", thingID);
            var connect = WebRequest.Create(new Uri(uri)) as HttpWebRequest;

            connect.UserAgent = "r/playitforward site by /u/sevenalive";

            // Do the actual connection
            WebResponse response = connect.GetResponse();

            string resp;
            using (var reader = new StreamReader(response.GetResponseStream()))
            {
                resp = reader.ReadToEnd();
            }

            return new JavaScriptSerializer().Deserialize<dynamic>(resp);
        } 
```

指数：

```
@foreach (var item in Model)
{
    <div class="pif">
        <div class="left">
            <div class="title"><a href="/PiF/@item.ThreadID">@item.ThreadTitle</a></div>
            <div class="description">
                <div class="expandable">
                    <p>@item.SelfText</p>
                </div>
            </div>
            <div class="createdTime">
                <strong>@Html.TimeAgo(@item.CreatedDate)</strong>
            </div>
            <div class="createdBy">
                @if (item.Games.Count() == 1)
                {
                   @item.Games.Single().Name
                }
                else
                {
                    <text>@item.GameCount games</text>
                }
                being given by <a href="@string.Format("http://reddit.com/u/{0}", item.Username)">@item.Username</a>
            </div>
        </div>
        <div class="left">
            <ul class="games">
                      @foreach (var game in item.Games)
                      {
                          <li>
                              <a href="@game.StoreUrl" title="@game.Name">@game.Name</a> <span style="color:#b5b8be; font-weight:600">@string.Format("({0}P)", game.PointWorth)</span>
                              @if (game.Count > 1)
                              {
                                  <span style="color:#b5b8be; font-weight:600">(@game.Count copies)</span>
                              }
                          </li>
                      }
                  </ul>
        </div>
        <div class="clearBoth"></div>
    </div>
} 
```

我尝试进行一些搜索，但找不到任何我正在寻找的示例。我认为 javascript，可能是 JQuery，将是最好的方法。我是 Web 开发的新手，因此非常感谢您提供详细的示例。整个代码库是开源的，我可以使用帮助，所以如果你想请叉！[https://github.com/sevenalive/PlayItForward](https://github.com/sevenalive/PlayItForward)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T08:50:02.347

```
function GetSelfText(thingId) {
    $.getJSON("http://www.reddit.com/r/playitforward/comments/" + thingId + "/.json?jsonp=?", { id: thingId }, function (data) {
        var tempHtml = $('<div/>').html(data[0].data.children[0].data.selftext_html).text();
        $("#selfText-" + thingId).html(tempHtml);
    })
}

<div class="description" id="selfText-@item.ThreadID">
                        <script type="text/javascript">
                            $(document).ready(function () { GetSelfText('@item.ThreadID'); });
                        </script>
            </div> 
```

# sql - PostgreSQL 在选择查询中重用计算结果

> ID：11218257
> 
> 赞同：7
> 
> 时间：2012-06-27T01:37:54.860
> 
> 标签：sql, postgresql

例如使用 SQL 我可以这样做：

```
SELECT (a+b) as c FROM table WHERE c < 5 AND (c*c+t) > 100; 
```

有没有办法使用 Postgres 做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T02:07:11.813

你不能这样做。在 PostgreSQL 和标准 SQL 中都没有。[手册：](https://www.postgresql.org/docs/current/sql-select.html#SQL-SELECT-LIST)

> 输出列的名称可用于在 `ORDER BY`and`GROUP BY`子句中引用列的值，但不能在`WHERE`or`HAVING`子句中；在那里你必须写出表达式。

可以就这方面的标准进行辩论。Hugh Darwen 在我最近提到的[这篇文章](https://www.dcs.warwick.ac.uk/~hugh/TTM/HAVING-A-Blunderful-Time.html)中竭尽全力做到了这一点。

您可以使用像[Federico 建议](https://stackoverflow.com/a/11218355/939860)的子查询，或者像这样的[公用表表达式 (CTE)](https://www.postgresql.org/docs/current/queries-with.html)：

```
WITH cte AS (SELECT a + b AS c FROM x)
SELECT c
FROM   cte
WHERE  c < 5
AND    (c*c+t) > 100; 
```

CTE 对于更复杂的操作或如果您想在多个（子）查询中重用中间结果特别有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T01:54:15.270

这可能是您可能使用的替代方法：

```
SELECT foo.c
FROM (
    SELECT (a+b) as c FROM table
) as foo
WHERE foo.c < 5 
AND (foo.c*foo.c+t) > 100 
```

从性能的角度来看，我认为这不是一个最优的解决方案（因为缺少*foo*子查询的 WHERE 子句，因此返回所有*表*记录）。我不知道 Postgresql 是否在那里做了一些查询优化。

# ruby-on-rails - 为什么在 Ruby on Rails 控制台中无法识别“Delayed::Job.all”？

> ID：11218262
> 
> 赞同：0
> 
> 时间：2012-06-27T01:39:04.483
> 
> 标签：ruby-on-rails, mongoid, delayed-job

我目前正在尝试检查延迟作业队列中的内容，但是当我`Delayed::Job.all`在控制台中运行时，出现`NameError: uninitialized constant Delayed`错误。根据github页面上的自述文件，我应该可以运行正常的delayed_job命令。

我目前正在使用`delayed_job_mongoid`gem 版本 1.0.8。

这是我的宝石文件：

```
gem 'rails', '3.2.6'
gem 'unicorn'
gem 'mongoid', '3.0.0.rc'
gem 'bson_ext' # mongoid-related

gem 'bcrypt-ruby' # encryption
gem 'jquery-rails'
gem 'haml'

gem 'delayed_job_mongoid', :git => 'https://github.com/asavartsov/delayed_job_mongoid.git'

group :assets do
  gem 'uglifier', '>= 1.0.3'
end

group :development do
  gem 'rspec-rails'
  gem 'guard-rspec'
end

group :test do
  gem 'cucumber-rails', require: false
  gem 'capybara'
  gem 'database_cleaner'
  gem 'factory_girl_rails'
  gem 'mongoid-rspec'
  gem 'spork'
  gem 'guard-spork'
end 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T06:29:33.373

我复制粘贴了您的 Gemfile，它对我有用：

```
加载开发环境（Rails 3.2.6）
1.9.3p194:001 > 延迟::Job.all
 => #<Mongoid::Criteria
   选择器：{}，
   选项： {}，
   类：Delayed::Backend::Mongoid::Job，
   嵌入：假>

```

您可以尝试包含 DelayedJob 本身（尽管 delay_job_mongoid 在其 gemspec 中需要它），例如

```
gem 'delayed_job' 
```

因此，要么您在 config/initializers/*.rb 或 config/application.rb 或 config/environments/production.rb 中有一些奇怪的东西

# wcf - WCF：如何设置 AnnouncementService 只接收本地主机上/下线消息

> ID：11218265
> 
> 赞同：0
> 
> 时间：2012-06-27T01:40:04.803
> 
> 标签：wcf, discovery

我创建了一个 wcf-lib，我只想要一个进程间通信。当我打开一个使用lib的应用程序时，会互相宣布。我使用 UdpAnnouncementEndpoint，它可以工作。但它会收到来自 Intranet 的通知。我能做些什么 ？

我通过这样的代码创建端点：

```
 private void ActionInitClientService()
    {
        // Create ClientSelt ServiceHost
        _clientServiceHost = new ServiceHost(_clientInstance);
        _clientServiceHost.AddServiceEndpoint((typeof (IClientService)), new NetNamedPipeBinding(), Info.Address);

        // Make the client discoverable via Udp
        // and Broadcast itself to Online announcement
        _clientServiceHost.AddServiceEndpoint(new UdpDiscoveryEndpoint());
        var discoveryBehavior = new ServiceDiscoveryBehavior();
        discoveryBehavior.AnnouncementEndpoints.Add(new UdpAnnouncementEndpoint());
        _clientServiceHost.Description.Behaviors.Add(discoveryBehavior);

        _clientServiceHost.Opened += OnOpenedClientServiceHost;
        _clientServiceHost.Closed += OnClosedClientServiceHost;
    } 
```

并在主机中添加一个 AnnouncementsListener：

```
 private void ActionInitAnnouncementsListener()
    {
        var announcementService = new AnnouncementService();
        announcementService.OnlineAnnouncementReceived += OnOnlineAnnouncementReceived;
        announcementService.OfflineAnnouncementReceived += OnOfflineAnnouncementReceived;

        _announcementsListener = new ServiceHost(announcementService);
        _announcementsListener.AddServiceEndpoint(new UdpAnnouncementEndpoint());
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:49:46.557

不，它不会。您使用的 NetNamedPipeBinding 仅在客户端和服务都在同一台机器上运行时才有效。根据其定义，NetNamePipeBinding 提供了一种安全可靠的绑定，该绑定针对机器上的通信进行了优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T07:45:16.827

抱歉，我查看了您代码的错误部分。您没有使用命名管道来使您的客户端可被发现。

这是您如何获取传入消息的 IP 地址的方法（我假设基于该 IP 地址，您可以使用一些代码逻辑推断您的消息是否来自您的 Intranet）。

```
OperationContext context = OperationContext.Current;
MessageProperties messageProperties = context.IncomingMessageProperties;
RemoteEndpointMessageProperty endpointProperty = messageProperties[RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty; 
```

上述代码位于以下链接：[http ://social.msdn.microsoft.com/Forums/en-US/wcf/thread/f14520be-d77d-401f-b339-9c58585857f7/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/f14520be-d77d-401f-b339-9c58585857f7/)

[您还可以在http://www.danrigsby.com/blog/index.php/2008/08/20/observableservicehost-an-instancecontext-creation-aware-wcf-servicehost/](http://www.danrigsby.com/blog/index.php/2008/08/20/observableservicehost-an-instancecontext-creation-aware-wcf-servicehost/)上找到更多详细信息。

# javascript - Titanium createHttpClient 在其他变量声明之后运行

> ID：11218266
> 
> 赞同：0
> 
> 时间：2012-06-27T01:40:05.940
> 
> 标签：javascript, mobile, titanium-mobile, appcelerator-mobile

我在 Titanium 中有这段代码，它调用服务器上的 PHP 文件，打印与 id 匹配的用户名：

```
var myString;
var request = Titanium.Network.createHTTPClient();
var url = "http://localhost/myPhp.php?id=1";
request.open("GET", url, false);
request.onload = function(){
    var newString = this.responseText;
    Ti.API.info(newString);
    myString = newString;
}

request.send();
Ti.API.info("result " + myString); 
```

钛控制台打印我这个：

*   结果未定义
*   用户名

Titanium 似乎在请求之后首先调用代码，然后再调用请求。所以我不能用 responseText 改变 var 的值。我该怎么做？为什么会这样？

抱歉，如果有人之前在这里发布过，但我无法在关键字中考虑在 StackOverflow 中搜索它

提前感谢=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T15:59:26.523

Titanium createHttpClient 请求具有异步和同步模式。

您的行执行第一个打印“未定义” Ti.API.info("result " + myString);

然后响应来了，它会打印出 nameOfUser 的名称。

如果你想让你的代码内联运行，那么你必须让你的 createHttpClient 调用同步。您必须为其设置 createHttpClient 的参数

使第三个参数为真。

request.open("GET", url, true);

现在它会运行良好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T03:15:49.837

将您的代码更改为：

```
var myString;
var request = Titanium.Network.createHTTPClient();
var url = "http://localhost/myPhp.php?id=1";
request.open("GET", url, false);
request.onload = function(){
    var newString = this.responseText;
    Ti.API.info(newString);
    myString = newString;
    Ti.API.info("result " + myString);
}

request.send(); 
```

只需将 Ti.API.info("result" + myString) 日志放入 onload 函数即可。一旦获取请求，就会动态调用 onload 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:06:17.997

该请求是异步的，当您调用`request.send()`它时不会阻塞执行。当请求完成时，将`onload`调用事件处理程序。

# svn - Subversion HTTP 文件链接不尊重 peg 修订，有什么解决方法吗？

> ID：11218268
> 
> 赞同：0
> 
> 时间：2012-06-27T01:40:14.717
> 
> 标签：svn

问题是：当通过带有选项的网络浏览器访问 SVN 目录时`?p=NNN`，它会根据需要列出该修订版的文件。但是，Web 服务器提供的文件链接没有`?p=NNN`附加，因此可能会导致链接断开，或者更糟糕的是，随着时间的推移，用户会不自觉地获取不一致或不想要的版本。

`?p=NNN`是一个很棒的功能，它可以让我们永久链接到历史文件，我喜欢它。希望有解决此问题的解决方案或解决方法。

![在此处输入图像描述](../Images/57f0b70cfa3b9d19a46fec995861d297.png)

[[详细补充]]

SVN 服务器环境：

*   视窗服务器 2003 SP3
*   SVN 和 apache http 服务器来自 CollabNet，安装程序名为 CollabNetSubversion-server-1.6.4-1.win32.exe 。Httpd.exe 版本 2.2.11 。
*   httpd.conf 中 svn 相关的配置如下：

-

```
<Location /svnreps/WebApps/>
  DAV svn

  SVNParentPath D:/SvnReps/WebApps
  AuthzSVNAccessFile D:/SvnReps/WebApps/svn-authz-file

  Satisfy Any
  Require valid-user
</Location> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T16:24:12.533

我同意 Peter Parker 的观点，你的问题似乎适用于我的 SVN 版本。你也可以试试这个 URL 格式，看看是否可行，这是我过去经常使用的 URL 格式

`<REPO_URL>/!svn/bc/<REVISION_NUMBER>/<FILE_LOCATION>`

例子

```
http://svnbox/repository/!svn/bc/13/trunk/my_file 
```

这适用于文件和目录。

话虽如此，我原以为它会检索与`?p=`在您的情况下不起作用的功能相同的输出。总之，值得一试！

**例子**

```
$ svn info http://svn.apache.org/repos/asf/httpd/site/trunk/content/index.mdtext
Path: index.mdtext
Name: index.mdtext
URL: http://svn.apache.org/repos/asf/httpd/site/trunk/content/index.mdtext
Repository Root: http://svn.apache.org/repos/asf
Repository UUID: 13f79535-47bb-0310-9956-ffa450edef68
Revision: 1435013
Node Kind: file
Last Changed Author: jim
Last Changed Rev: 1384287
Last Changed Date: 2012-09-13 04:51:01 -0700 (Thu, 13 Sep 2012) 
```

要按名称获取修订版 1435013：

*   [http://svn.apache.org/repos/asf/!svn/bc/1435013/httpd/site/trunk/content/index.mdtext](http://svn.apache.org/repos/asf/!svn/bc/1435013/httpd/site/trunk/content/index.mdtext)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T14:28:49.237

省略最后的斜线。

所以而不是`https://example.com/svn/folder/?p=9`

使用网址`https://example.com/svn/folder?p=9`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T07:32:14.737

我检查了 Apache 的 SVN repo 并进行了 peg 修订：

[http://svn.apache.org/repos/asf/subversion/branches/?p=999999](http://svn.apache.org/repos/asf/subversion/branches/?p=999999)

它确实显示`?p=999999`了网页上的每个文件/目录链接。

然后，我尝试了 Collabnet Subversion Edge 2.3.0（svn 1.7.3，2012 年 2 月）。好吧，很好，挂钩修订确实出现在所有链接上。

所以，对于一些旧的 Subversion 版本来说，这可能是一个问题。

![在此处输入图像描述](../Images/963e2fa95cd142b8acf3b4a00f4330ec.png)

在 Sourceforge 上：[https](https://gnumakeuniproc.svn.sourceforge.net/svnroot/gnumakeuniproc/trunk/?p=999) ://gnmakeuniproc.svn.sourceforge.net/svnroot/gnumakeuniproc/trunk/?p= 999（Subversion 1.6.9，也很好）

[2012-09-03]**找到解决方案**

现在，我几乎可以确认这是由于旧的颠覆版本造成的。我将问题 Apache+SVN 实例从 CollabNet 升级到 1.7.6。[http://www.open.collab.net/downloads/subversion](http://www.open.collab.net/downloads/subversion)。现在我得到了想要的结果。

我使用**Subversion 1.7.6 + Apache Server（Windows 32 位）**软件包，它提供升级我现有服务器的功能。我接受升级，升级过程中 httpd.conf 没有改变。

![在此处输入图像描述](../Images/d4f13c1d23beedae33eb0b6b7130ac92.png)

# jquery - 逻辑下降 z-index

> ID：11218270
> 
> 赞同：1
> 
> 时间：2012-06-27T01:40:19.380
> 
> 标签：jquery, css, z-index

```
<div id="crumbs">

<a href="#" style="z-index: 4;">Workplace Standards</a> &#62;
<a href="#" style="z-index: 3;">Resources</a> &#62;
<a href="#" style="z-index: 2;">Guides</a> &#62;
<a href="#" style="z-index: 1;">Public holidays</a>

</div> 
```

我有一个简单的面包屑导航，JQuery 可以像上面的代码一样为 div 中的每个链接分配一个降序的 z-index 吗？当前打印没有 z-index 的链接，因此它们看起来很糟糕。

我希望它看起来如何：

![我希望它看起来如何](../Images/ac7882f0f483cf6905e3562797c01af2.png)

它目前的外观：

![在此处输入图像描述](../Images/ab9541cbaf1bf2ade2ce41c2287f3eda.png)

CSS

CSS 中唯一真正的关键角色是 position 和 margin-left，但这里是完整的 :)

```
#crumbs a {
    display: inline-block;
    position: relative;
    padding: .5em 1em;
    background: #e3e3e3;
    border: 1px solid #c9c9c9;
    box-shadow: inset 0px 1px 0px #f6f6f6;
    border-radius: 1em 2em 2em 1em;
    margin-left: -.6em;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T01:54:48.843

你可以这样做：

```
$($('#crumbs > a').get().reverse()).css('z-index', function(index) {
    return index+1;
}); 
```

或者，如果您更喜欢循环`.each()`：

```
$($('#crumbs > a').get().reverse()).each(function(index) {
    $(this).css('z-index', index+1);
});​​ 
```

请注意，要使其正常工作，您需要确保您的`a`元素具有`position: relative`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:13:38.970

没有定位 z-index 几乎没用

```
<div id="crumbs">

    <a href="#" style="position:relative;z-index: 4;">Workplace Standards</a> &#62;
    <a href="#" style="position:relative;z-index: 3;">Resources</a> &#62;
    <a href="#" style="position:relative;z-index: 2;">Guides</a> &#62;
    <a href="#" style="position:relative;z-index: 1;">Public holidays</a>

</div> 
```

[例子](http://jsfiddle.net/HtFWL/1/)

[MDN](https://developer.mozilla.org/en/CSS/Understanding_z-index/Adding_z-index)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T02:55:52.320

**状态更新：**   如果**CSS**和**JavaScript**被禁用，则将发生适当的*回退*`breadcrumbs`。

**参考：**   [**jsFiddle**](http://jsfiddle.net/qWWyP/)

**启用 CSS 和 JavaScript 的屏幕截图：** ![在此处输入图像描述](../Images/55169cab838d5aa47cec00c93dc5356e.png)

**禁用 CSS 和 JavaScript 的屏幕截图：**

        ![在此处输入图像描述](../Images/86061a87180ec955be7d753bb68fb4c4.png)

*[**额外：如果 CSS3 版本是可以接受的，我受到启发，在这个SO Answer**](https://stackoverflow.com/a/11282225/1195891)中制作了一个带有箭头的版本。*

* * *

**编辑：**

额外的[**jsFiddle与**](http://jsfiddle.net/rfsLE/)[*Simon Sarris*](https://stackoverflow.com/a/14034513/1195891)的替代风格。

[![在此处输入图像描述](../Images/4edc3edc0522e538c8a02a1b32d68372.png)](http://jsfiddle.net/rfsLE/ "西蒙·萨里斯 (Simon Sarris) 的 CSS3 样式")

# python - Plone：对物体移除做出反应

> ID：11218272
> 
> 赞同：4
> 
> 时间：2012-06-27T01:40:33.297
> 
> 标签：python, plone

我想在删除其中的项目后重定向到容器的父级。为此，我尝试订阅`zope.lifecycleevent's IObjectRemovedEvent`：

```
@grok.subscribe(ISite, IObjectRemovedEvent)
def redirect_to_trial_on_delete(obj, event):
    request = getattr(obj, 'REQUEST', None)
    if request:
        trial_url = obj.aq_parent.aq_parent.absolute_url()
        request.response.redirect(trial_url) 
```

删除是通过单击触发的，`container/id/delete_confirmation`但是这会触发比我预期的更多的事件。我的订阅函数被调用了两次：一次是当我点击链接时，另一次是当我确认删除时。更令人困惑的是，如果我*取消删除，它**也会*被调用。*我希望只有当*一个对象被从容器中*移除*时才会引发该事件。

 ***在*所有三种情况下*，事件对象都是相同的，oldName、oldParent 等具有相同的属性值。

如何区分请求删除项目、取消请求和实际删除项目？

**更新：**所以似乎调用了初始事件，因为从容器中删除了对象以检查链接完整性，此时有回滚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T04:33:01.110

一位同事想出了一个可行的解决方案：

```
import transaction

def redirect_to_trial(trans, obj=None, parent=None):
    if obj.id not in parent:
        request = getattr(obj, 'REQUEST', None)
        if request:
            trial_url = obj.__parent__.__parent__.absolute_url()
            request.response.redirect(trial_url)

@grok.subscribe(ISite, IObjectRemovedEvent)
def on_site_delete(obj, event):
    kwargs = dict(
        obj = obj,
        parent = event.oldParent,
    )
    transaction.get().addAfterCommitHook(redirect_to_trial, kws=kwargs) 
```

这会在提交之后检查以确保在执行重定向之前实际已删除对象。

不过，我们将不胜感激确认这是否是一种合适的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T05:17:03.613

这是另一种可能性，同样来自同一个天才同事：

```
from zope.interface import implements
from transaction.interfaces import ISavepointDataManager
from transaction._transaction import AbortSavepoint
import transaction

class RedirectDataManager(object):

    implements(ISavepointDataManager)

    def __init__(self, request, url):
        self.request = request
        self.url = url
        # Use the default thread transaction manager.
        self.transaction_manager = transaction.manager

    def tpc_begin(self, transaction):
        pass

    def tpc_finish(self, transaction):
        self.request.response.redirect(self.url)

    def tpc_abort(self, transaction):
        self.request.response.redirect(self.url)

    def commit(self, transaction):
        pass

    def abort(self, transaction):
        pass

    def tpc_vote(self, transaction):
        pass

    def sortKey(self):
        return id(self)

    def savepoint(self):
        """
        This is just here to make it possible to enter a savepoint with this manager active.
        """
        return AbortSavepoint(self, transaction.get())

def redirect_to_trial(obj, event):
    request = getattr(obj, 'REQUEST', None)
    if request:
        trial_url = obj.__parent__.__parent__.absolute_url()
        transaction.get().join(RedirectDataManager(request, trial_url)) 
```

我现在使用 zcml 进行订阅，以便更轻松地将其绑定到多种内容类型：

```
<subscriber
    zcml:condition="installed zope.lifecycleevent"
    for=".schema.ISite zope.lifecycleevent.IObjectRemovedEvent"
    handler=".base.redirect_to_trial"
/> 
```

这是我最终采用的解决方案，因为我发现它比手动检查更明确地了解正在发生的事情，以确定我捕获的事件是否是我真正想要的事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T11:45:56.000

*您可以*自定义操作，而不是使用事件处理程序`delete_confirmation`；这些甚至可以通过网络进行更改，并且可以根据*类型*进行定制。该`delete_confirmation`脚本是一个[CMF 表单控制器脚本](http://plone.org/documentation/manual/developer-manual/forms/using-cmfformcontroller)，有几个选项可以改变它的行为。

目前，动作定义如下：

```
[actions]
action.success=redirect_to:python:object.aq_inner.aq_parent.absolute_url()
action.confirm=traverse_to:string:delete_confirmation_page 
```

例如，您可以通过定义来添加特定于类型的操作`action.success.TypeName`。

要通过网络执行此操作，请访问 ZMI 并找到该`portal_form_controller`工具，然后单击`Actions`选项卡：

![突出显示“操作”选项卡的表单控制器概览屏幕](../Images/c2d04c0438369635e195e23883897b35.png)

正如您在此屏幕截图中所见，此处还提供有关该工具的文档。

在操作选项卡上有一个添加新操作的表单：

![添加新的操作覆盖表单，预填充示例](../Images/7f65f1966fac53b5d4a045842f16ace0.png)

如您所见，上下文类型是一个包含所有现有类型注册的下拉列表，以便更轻松地指定特定于类型的操作。我已经复制了常规操作（`redirect_to`由表达式指定的操作，`python:`并添加了一个额外`.aq_parent`的选项来选择容器父级。

`.addFormAction`您还可以使用工具上的方法添加这样的操作：

```
fctool = getToolByName(context, 'portal_form_controller')
fctool.addFormAction('delete_confirmation', 'success', 'Event', None,
     'redirect_to',
     'python:object.aq_inner.aq_parent.aq_parent.absolute_url()') 
```

最后但同样重要的是，您可以`cmfformcontroller.xml`在 GenericSetup 配置文件的文件中指定此类自定义操作；这是基于上述操作的示例：

```
<?xml version="1.0" ?>
<cmfformcontroller>
  <action
      object_id="delete_confirmation" 
      status="success"
      context_type="Event"
      action_type="redirect_to"
      action_arg="python:object.aq_inner.aq_parent.aq_parent.absolute_url()"
      />
</cmfformcontroller> 
```

这种格式是 Plone 中记录不足的内容之一；我从[GS 导入和导出代码的 CMFFormController 源代码中](https://github.com/plone/Products.CMFFormController/blob/master/Products/CMFFormController/exportimport/formcontroller.py)得到了这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-31T14:06:36.543

我也面临着我认为必须是一个常见用例的情况，其中本地 Plone 对象正在代理远程对象。删除 Plone 对象后，但仅在实际删除时，我想删除远程对象。

对我来说， addAfterCommitHook() 并没有避免任何问题，所以我采用了自定义 IDataManager 方法，它为类似的用例提供了一个很好的通用解决方案......

```
from transaction.interfaces import IDataManager
from uuid import uuid4

class FinishOnlyDataManager(object):

    implements(IDataManager)

    def __init__(self, callback, args=None, kwargs=None): 

        self.cb = callback
        self.args = [] if args is None else args
        self.kwargs = {} if kwargs is None else kwargs

        self.transaction_manager = transaction.manager
        self.key = str(uuid4())

    def sortKey(self): return self.key
    abort = commit = tpc_begin = tpc_vote = tpc_abort = lambda x,y: None

    def tpc_finish(self, tx): 

        # transaction.interfaces implies that exceptions are 
        # a bad thing.  assuming non-dire repercussions, and that
        # we're not dealing with remote (non-zodb) objects,  
        # swallow exceptions.

        try:
            self.cb(*self.args, **self.kwargs)
        except Exception, e:
            pass 
```

以及相关的处理程序...

```
@grok.subscribe(IRemoteManaged, IObjectRemovedEvent)
def remove_plan(item, event): IRemoteManager(item).handle_remove()

class RemoteManager(object):     ... 

    def handle_remove(self):

        obj = self._retrieve_remote_object()

        def _do_remove():
            if obj:
                obj.delete()

        transaction.get().join(FinishOnlyDataManager(_do_remove)) 
```***

# multithreading - 强制 WaitForDebugEvent 执行某个线程

> ID：11218277
> 
> 赞同：2
> 
> 时间：2012-06-27T01:40:45.963
> 
> 标签：multithreading, debugging, winapi

我正在编写一个 Windows 调试器，所以我有通常的 ContinueDebugEvent/WaitForDebugEvent 循环：

```
while (true)
{
 ContinueDebugEvent(hTargetProcessId, hTargetThreadId, lastDebugResult);
 WaitForDebugEvent(&evt, INFINITE);
 ...
 hTargetThreadId = evt.dwThreadId;
} 
```

这很好用，但我正在添加一个需要能够在调试过程中执行特定线程的功能。为此，我暂停了所有我不感兴趣的线程，就像这样（为简洁起见，我省略了一些代码 - 希望这足够清楚！）：

```
while (true)
{
 if (onlyACertainThread)
 {
  for (int n=0; n<threadcount; n++)
   if(threads[n] != certainThread)
    SuspendThread(threads[n]);
 }

 ContinueDebugEvent(hTargetProcessId, hTargetThreadId, lastDebugResult);
 WaitForDebugEvent(&evt, INFINITE);

 if (onlyACertainThread)
 {
  for (int n=0; n<threadcount; n++)
   if(threads[n] != certainThread)
    ResumeThread(threads[n]);
 }
 ...
 (code to add to 'threads', update threadcount, decide if we want to restrict to a certain thread, etc)
 ...
 hTargetThreadId = evt.dwThreadId;
} 
```

但是，我经常看到来自错误线程的调试事件。例如：

*   线程 A 正在运行
*   决定我们要观察线程B；挂起线程 A，调用 continue/waitfordebugevent(.. A.pid..)
*   从线程 A 获取调试通知（断点、异常）。

我想要的是最后一步是“从 B 获取通知”。我试过调用 WaitForDebugEvent(..B.pid..) 不起作用。

这是预期的行为吗？

我怀疑线程挂起/恢复计数器仅在线程被调度时被内核观察到；即，在时间片结束时。这将导致线程 A 继续运行，直到其当前时间片结束。任何人都可以确认/否认这个想法吗？如果是这样..我将如何解决它？目前我最好的想法是在暂停线程后“注入”对 Sleep(0) 的人工调用，但我真的不想这样做，除非我必须这样做！

如果有什么不同的话，我运行的机器是一个单线程的 XP 机器。

# mysql - 在 MySQL 中，当 col2 和 col3 的值不为 NULL 时，如何将 col1 的值设置为 col2 的值？

> ID：11218279
> 
> 赞同：-2
> 
> 时间：2012-06-27T01:41:02.913
> 
> 标签：mysql, sql, copy

在 MySQL 中，当 col2 和 col3 的值不为 NULL 时，如何将 col1 的值设置为 col2 的值？

```
UPDATE t SET col1=col2 WHERE col2 IS NOT NULL AND col3 IS NOT NULL; 
```

这行得通吗？

### 解决方案

1）使用事务

2）使用临时表

3) 在 sqlfiddle 测试简单案例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:46:34.230

是的，这是完全合法的。将来尝试在 SQL Fiddle 中运行东西，[http: //www.sqlfiddle.com/#!2/6fb42/1](http://www.sqlfiddle.com/#!2/6fb42/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:50:02.610

好的，您正在管理一个数据库，但没有沙箱环境可以测试...... :(

> 创建数据库沙箱；
> 
> mysqldump realdb 表名 > dump.sql
> 
> mysql 沙箱 < dump.sql

瞧，你的沙盒环境可以玩了:)

编辑：

我刚刚看到你不能创建新的数据库。您是否考虑过临时表？

> 创建表时可以使用 TEMPORARY 关键字。TEMPORARY 表仅对当前连接可见，并在连接关闭时自动删除。这意味着两个不同的连接可以使用相同的临时表名称，而不会相互冲突或与现有的同名非临时表冲突。（在删除临时表之前，现有表是隐藏的。）要创建临时表，您必须具有 CREATE TEMPORARY TABLES 特权。

[http://dev.mysql.com/doc/refman/5.1/en/create-table.html](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)

编辑2：

我忘记了最简单的解决方案：（***不要对 MYISAM 表执行此操作，只在 INNODB 上执行此操作！！！***）禁用自动提交，尝试您想要的，做一些选择以检查这是否是您想要的，如果它不起作用，则简单地回滚。

# asp.net-mvc - 图表结果中没有电子邮件，但在 Graph API Explorer 中显示

> ID：11218280
> 
> 赞同：0
> 
> 时间：2012-06-27T01:41:09.600
> 
> 标签：asp.net-mvc, facebook

我的范围内有电子邮件，我看到该应用程序具有电子邮件权限，但结果中没有电子邮件，但是如果我将资源管理器与应用程序访问令牌一起使用，我会收到电子邮件。这让我发疯，我相信我一切都是正确的。

```
 Return Redirect(String.Format("https://www.facebook.com/dialog/oauth?client_id={0}&scope=email&redirect_uri={1}&state={2}", My.Resources.FacebookApiKey, My.Resources.FacebookRedirectUrl, Session.SessionID))

Dim webRequest As System.Net.HttpWebRequest
        Dim targetURI As New Uri(String.Format("https://graph.facebook.com/oauth/access_token?client_id={0}&redirect_uri={1}&client_secret={2}&code={3}&scope=email", My.Resources.FacebookApiKey, My.Resources.FacebookRedirectUrl, My.Resources.FacebookApiSecret, code))
        webRequest = DirectCast(System.Net.HttpWebRequest.Create(targetURI), System.Net.HttpWebRequest)
        If (webRequest.GetResponse().ContentLength > 0) Then
            Dim str As New System.IO.StreamReader(webRequest.GetResponse().GetResponseStream())
            reply = str.ReadToEnd
            str.Close()
        End If

        Dim replies As String() = Split(reply, "=")
        targetURI = New Uri(String.Format("https://graph.facebook.com/me?access_token={0}", replies(1)))
        webRequest = DirectCast(System.Net.HttpWebRequest.Create(targetURI), System.Net.HttpWebRequest)
        If (webRequest.GetResponse().ContentLength > 0) Then
            Dim str As New System.IO.StreamReader(webRequest.GetResponse().GetResponseStream())
            reply = str.ReadToEnd
            str.Close()
        End If 
```

如果你能发光，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T09:40:21.720

我不是 .net 程序员，但如果电子邮件是唯一缺少的东西，您可以尝试在请求 URL 中添加查询字符串，如下所示：

```
https://graph.facebook.com/me?access_token={0}&fields=email 
```

它应该可以正常工作并在 JSON 对象中返回电子邮件地址：

```
{
  "email": "user.name@gmail.com",
  "id": "12312312312313123123",
  "type": "user"
} 
```

# sql-server - 我可以在 MERGE 语句中对目标应用 WHERE 子句吗？

> ID：11218282
> 
> 赞同：14
> 
> 时间：2012-06-27T01:41:27.930
> 
> 标签：sql-server, tsql, merge

我有一个目标表，其中包含一个带有`IsActive`标志的项目，并且我正在使用`MERGE`语句从源表中插入和更新。如果源表中存在某些内容，则它处于活动状态，如果不存在，则它不处于活动状态。逻辑很简单：

*   如果它存在于源和目标中，则该行应为`IsActive`true
*   如果它仅存在于源中，则应将新行插入到目标中，并且为`IsActive`true
*   如果它仅存在于目标中，`IsActive`则应设置为 false。

一切都非常简单，除了目标表还有一个`SourceId`与源表相关的区分列。因此，对于给定的源表，我只想`MERGE`针对具有相应`SourceId`.

（我的规范化表包含来自多个系统的相同数据类型的行 - 我分别从这些系统中检索数据，因此需要一次从一个源合并）

这是一个例子：

```
IF OBJECT_ID('tempdb..#target') IS NOT NULL DROP TABLE #target    
IF OBJECT_ID('tempdb..#source') IS NOT NULL DROP TABLE #source

CREATE TABLE #target  ( Id INT, SourceId INT, IsActive BIT )   
INSERT #target VALUES (1, 1, 0)
INSERT #target VALUES (2, 1, 1)
INSERT #target VALUES (3, 2, 1)

CREATE TABLE #source ( Id INT )    
INSERT #source VALUES (1)
INSERT #source VALUES (4)

DECLARE @SourceId INT = 1;    
SELECT * FROM #target

MERGE INTO #target t
USING
(
    SELECT [Id] FROM #source
) AS s
ON t.[Id] = s.[Id] AND t.[SourceId] = @SourceId
WHEN MATCHED THEN UPDATE SET [IsActive] = 1
WHEN NOT MATCHED BY TARGET THEN INSERT VALUES ([Id], @SourceId, 1)
WHEN NOT MATCHED BY SOURCE THEN UPDATE SET [IsActive] = 0;

SELECT * FROM #target 
```

我最初的尝试是`AND t.[SourceId] = @SourceId`在合并条件中包含 ，但显然这不起作用 - 它限制了要合并的项目，但不是目标表。目标行 ID = 3 将不匹配，因此无论是否包含该附加条件，它将被设置为非活动状态。

最终结果是，每当为源系统运行该过程时，所有其他系统都将设置为非活动状态。

到目前为止，我的解决方案是运行`MERGE`唯一的`MATCHED`and `NOT MATCHED BY TARGET`，然后`UPDATE`为不匹配的行运行后续

```
UPDATE #target
SET [IsEnabled] = 0 
WHERE [SourceId] = @SourceId
AND [ID] NOT IN (SELECT [ID] FROM #source) 
```

有没有办法在`MERGE`语句中包含这个过滤条件？有没有其他聪明的方法来实现这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-25T19:01:32.307

所以你的结果集应该是

```
1 1 1
2 1 0    
3 2 1
4 1 1 
```

在这种情况下，您的合并语句应该是

```
merge #target as t
using #source as source
on (t.id=source.id)
when matched then update set isactive=1
when not matched by target then insert values (id, @sourceid,1)
when not matched by source and SourceID=@sourceID then update set isactive=0 
```

全面测试：

```
CREATE TABLE #target  ( Id INT, SourceId INT, IsActive BIT )    
INSERT #target VALUES (1, 1, 0) 
INSERT #target VALUES (2, 1, 1) 
INSERT #target VALUES (3, 2, 1) 

CREATE TABLE #source ( Id INT )     
INSERT #source VALUES (1) 
INSERT #source VALUES (4) 

DECLARE @SourceId INT 
select @SourceId = 1;     

merge #target as t 
using #source as source 
on (t.id=source.id) 
when matched then update set isactive=1 
when not matched by target then insert values (id, @sourceid,1) 
when not matched by source and SourceID=@SourceID then update set isactive=0;

SELECT * FROM #target 

drop table #target;
drop table #source 
```

结果...

```
Id          SourceId    IsActive
----------- ----------- --------
1           1           1
2           1           0
3           2           1
4           1           1 
```

# ios - UIImagePickerViewController 与 UIImagePickerControllerSourceTypeCamera 方向问题

> ID：11218289
> 
> 赞同：1
> 
> 时间：2012-06-27T01:42:20.813
> 
> 标签：ios, uiview, uiimagepickercontroller

只是感兴趣，如果有人有任何示例代码，请使用 UIImagePicker 在全屏模式下使用横向/纵向旋转的相机视图。

代替

```
[self presentModalViewController:imagePicker animated:NO]; 
```

我将 imagepicker.view 添加为子视图，如下所示：

```
[cameraView addSubview: imagePicker.view]; 
```

问题是，当这种情况发生时，imagePicker.view 的框架被添加了 90 度旋转。执行仿射平移会很好，除非这样做会改变实际相机馈送的旋转。

做类似的事情，效果很好，

```
[imagePicker.view setFrame: CGRectMake(0, 0, 480, 320)]; 
```

直到用户旋转。

我可以用这个来收听旋转通知：

```
- (void) didRotate:(NSNotification *)notification 
```

但是应用仿射翻译会破坏相机覆盖层及其子视图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T00:17:36.773

结果是，将 UIImagePicker 用于模态相机弹出窗口仅适用于基本的 AVCamera 使用。我仍然用它来挑选现有的照片，但最终使用了示例代码

我的主要 VC 标头保留：

```
UIImagePickerController *_imagePicker;
AVCameraView *avCameraView; 
```

AVCameraView 保留：

```
@property (retain) CaptureSessionManager *captureManager; 
```

[如果设备是 4+ https://github.com/mrdavenz/CaptureSessionManager](https://github.com/mrdavenz/CaptureSessionManager)，则用于拍照以及前后摄像头之间的交换

# django - 标记为“可编辑=假”的字段如何工作

> ID：11218294
> 
> 赞同：1
> 
> 时间：2012-06-27T01:43:42.673
> 
> 标签：django, django-forms, django-models

当一个字段在模型中被标记为“editable=False”时，它不会出现在生成的表单上。字段如何初始化并保存到数据库中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T02:19:50.190

由你，在 python 代码中。例如，如果您的对象有一个不可编辑的`user`字段：

```
form = MyForm(request.POST)
if form.is_valid():
    myobj = form.save(commit=False)
    myobj.user = request.user
    myobj.save() 
```

# scala - 如何在 Play 2.0 应用程序中初始化全局

> ID：11218295
> 
> 赞同：1
> 
> 时间：2012-06-27T01:43:55.683
> 
> 标签：scala, playframework-2.0

Play 2.0 应用程序中的 Global 对象在第一次加载应用程序页面之前不会被初始化。

我可以想到在部署/启动/重新启动应用程序时检索应用程序页面的黑客攻击，但我正在寻找一种更清洁的方法。

如何确保全局对象初始化不会等到第一页加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T16:15:51.770

感谢[viktornk](https://stackoverflow.com/users/830928/viktortnk)的回复，这仅在运行“play run”时发生在开发模式下。如果您通过“sbt start”或“play start”在生产模式下启动应用程序，它会立即初始化。希望当您构建和应用程序并部署到容器中时也会发生这种情况。

# backbone.js - 不能在 CoffeeScript 中使用作为函数参数传递的构造函数？

> ID：11218297
> 
> 赞同：2
> 
> 时间：2012-06-27T01:44:26.620
> 
> 标签：backbone.js, coffeescript

编辑了更多上下文。当 $CONSTRUCTOR = pass_in 时，它会在 Firefox 和 Chrome 中抛出“passed_in is not a constructor”。当 $CONSTRUCTOR = not_passed_in 时，它不

```
 initialize: (options) ->
    @collection.bind 'all', @render
    $('.search_box').parent('form').submit (event) => 
      @loading()
      event.preventDefault()
      query = $(event.target).find('.search_box').val()
      window.app.navigate('?query=' + query, trigger: true)
    passed_in = PaginationView
    @render(passed_in)

  render: (passed_in)=> 
    if @collection.isEmpty() && @collection.query
      @$el.html(JST['users/no_results'](query: @collection.query))
    else if @collection.isEmpty() # Not loaded yet
      @$el.html("<div class='loading'></div>")
    else
      html = JST['users/user_list'](@viewData())
      @$el.html(html)
      for user in @collection.models
        html = new UserListItemView(model: user).render().el
        @$('tbody.users').append(html)

      not_passed_in = PaginationView
      new $CONSTRUCTOR(
        type: "user"
        el: @$('.paginate')
        model: @collection
        data: {}
        onError: @onError
      ).bind('change', @loading) 
```

这是 CoffeeScript 的已知（错误|功能）吗？还是我做错了什么？

（这些在 Backbone.coffee 视图中。我怀疑这是否相关）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T07:57:30.193

为了简化问题：

```
MyView = Backbone.View.extend

    initialize: (options) ->
        passed_in = PaginationView
        @render(passed_in)

    render: (passed_in) => 
          not_passed_in = PaginationView
          new passed_in(
            type: "user"
            el: @$('.paginate')
            model: @collection
            data: {}
            onError: @onError
          ).bind('change', @loading) 
```

1) 通常@render 的最后一行是`@`或`this`而不是另一个视图。

2)**最可能的问题**是有一些其他代码`@render()`在没有参数的情况下调用。建议您提供一个默认参数，例如：

```
render: (passed_in=PaginationView) => 
```

3）如果`PaginationView`创建一个`MyView`，你可能会得到一个堆栈溢出错误：

*   MyView.initialize 调用渲染，
*   调用 PaginationView.initialize
*   调用 MyView.initialize
*   .. 环形。

4) JSON.stringify`passed_in`在任何时候都会被调用吗？如果是这样，它会将函数转换为`undefined`：

```
passed_in = JSON.stringify(passed_in)
undefined == passed_in
# always true if passed_in is a function 
```

# javascript - 为什么下面语句中变量名后面的速记算术运算符++不返回2？

> ID：11218299
> 
> 赞同：5
> 
> 时间：2012-06-27T01:44:33.567
> 
> 标签：javascript

我有一个非常简单的算术运算符，但我不知道为什么它不返回 2。下面的代码返回 1。我认为 x++ 等于 x = x + 1;

**代码**

```
var x = 1;
document.write(x++); 
```

但是，如果我按如下方式运行代码，它将按预期返回 2

**代码**

```
var x = 1;
document.write(++x); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-27T01:46:08.083

## PostIncrement(variable++) & PostDecrement(variable--)

当您在变量后使用`++`or`--`运算符时，变量的值不会递增/递减，直到计算表达式并返回原始值之后。例如`x++`转换为类似于以下内容：

```
document.write(x);
x += 1; 
```

## PreIncrement(++variable) & PreDecrement(--variable)

当您在变量之前使用`++`or`--`运算符时，变量的值会在计算表达式之前递增/递减并返回新值。例如`++x`转换为类似于以下内容：

```
x += 1;
document.write(x); 
```

postincrement 和 preincrement 运算符在 C、C++、C#、Java、javascript、php 中可用，我相信还有其他语言。根据[why-doesnt-ruby-support-i-or-i-increment-decrement-operators](https://stackoverflow.com/questions/3660563/why-doesnt-ruby-support-i-or-i-increment-decrement-operators)，Ruby 没有这些运算符。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-27T01:53:40.870

我认为`x++`和`++x`（非正式地）是这样的：

**`x++`**：

```
function post_increment(x) {
  return x; // Pretend this return statement doesn't exit the function
  x = x + 1;
} 
```

**`++x`**：

```
function pre_increment(x) {
  x = x + 1;
  return x;
} 
```

这两个操作做同样的事情，但它们*返回*不同的值：

```
var x = 1;
var y = 1;

x++; // This returned 1
++y; // This returned 2

console.log(x == y); // true because both were incremented in the end 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-27T02:20:38.363

如果您查看[javascript 规范](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)第 70 和 71 页，您可以看到它应该如何实现：

**字首：**

> > 1.  令 expr 为计算 UnaryExpression 的结果。
> > 2.  如果以下条件都为真，则抛出 SyntaxError 异常：72 © Ecma International 2011
> >     *   Type(expr) is Reference 为真
> >     *   IsStrictReference(expr) 为真
> >     *   Type(GetBase(expr)) 是环境记录
> >     *   GetReferencedName(expr) 是“eval”或“arguments”
> > 3.  设 oldValue 为 ToNumber(GetValue(expr))。
> > 4.  令 newValue 为将值 1 与 oldValue 相加的结果，使用与 + 运算符相同的规则（参见 11.6.3）。
> > 5.  调用 PutValue(expr, newValue)。
> > 6.  返回新值。

或者更简单地说：

1.  增量值
2.  返回值

**后缀：**

> > 1.  令 lhs 为计算 LeftHandSideExpression 的结果。
> > 2.  如果以下条件都为真，则抛出 SyntaxError 异常：
> >     *   类型（lhs）是参考是真的
> >     *   IsStrictReference(lhs) 为真
> >     *   Type(GetBase(lhs)) 是环境记录
> >     *   GetReferencedName(lhs) 是“eval”或“arguments”
> > 3.  设 oldValue 为 ToNumber(GetValue(lhs))。
> > 4.  令 newValue 为将值 1 与 oldValue 相加的结果，使用与 + 运算符相同的规则（参见 11.6.3）。
> > 5.  调用 PutValue(lhs, newValue)。
> > 6.  返回旧值。

或者更简单地说：

1.  为 temp 赋值
2.  增量值
3.  返回温度

# c# - 是什么导致 RunWorkerCompleted 被调用？

> ID：11218300
> 
> 赞同：0
> 
> 时间：2012-06-27T01:44:36.273
> 
> 标签：c#, winforms, backgroundworker

d我有一个winforms系统托盘应用程序，它通过数据库监控作业状态。我单击系统托盘，打开当前活动作业的菜单，如果单击作业，我将创建一个应该显示消息和进度条的表单。

表单的构造函数是

```
 public JobStatusForm()
    {
        InitializeComponent();

        activeJobsBGWorker = new BackgroundWorker();
        activeJobsBGWorker.DoWork += new DoWorkEventHandler(activeJobsBGWorker_DoWork);
        activeJobsBGWorker.ProgressChanged += new ProgressChangedEventHandler(activeJobsBGWorker_ProgressChanged);
        activeJobsBGWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(activeJobsBGWorker_RunWorkerCompleted);
    } 
```

然后，上下文方法的单击事件处理程序调用 JobStatusForm.Show()。在表格中，我有：

```
 private void JobStatusForm_Shown(object sender, EventArgs e)
    {
        activeJobsBGWorker.RunWorkerAsync();
    } 
```

启动工人。

我发现工人开始了，然后引发了 RunWorkerCompleted 事件。发送者是后台工作者，事件参数为空。

如何找出引发此事件的原因，以及如何使其停止/重新启动？

谢谢，

编辑：

目前，Do_Work 代码如下所示：

```
private void activeJobsBGWorker_DoWork(object sender, DoWorkEventArgs e)
    {

        //while (!e.Cancel)
        while (true)
        {
            _clr.JobStatus status = _clr.SystemDataHelper.GetCurrentJobActivity(_clr.SystemDataHelper.GetLocation(), this.job_ID);

            //if (activeJobsBGWorker.CancellationPending)
            //    continue;

            activeJobsBGWorker.ReportProgress(status.pc, status);

            Thread.Sleep(250);
        }
    } 
```

我在 ReportProgress 行上设置了一个断点，它永远不会被击中。

对 _clr 的调用是对构建为 dll 的 C++ 项目，并调用调用数据库的静态方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:35:09.077

Do_Work 方法中的异常也会导致 RunWorkerCompleted 被触发。

# iphone - 隔离大数位 (iOS-Xcode)

> ID：11218302
> 
> 赞同：0
> 
> 时间：2012-06-27T01:45:02.013
> 
> 标签：iphone, ios

我在分隔 9 位数字中的数字时遇到问题。我正在使用以下方法执行此操作：

注意：将 thuis 粘贴到 Xcode 中以更容易地“查看”它可能更容易：

```
int firstDigit = currentValue *.00000001; // = 3.7 = 3
firstDigitLabel.text = [NSString stringWithFormat:@"%d",firstDigit];
int secondDigit = (currentValue *.0000001) - (firstDigit *10); // = 7.2 = 7
secondDigitLabel.text = [NSString stringWithFormat:@"%d",secondDigit];
int thirdDigit = (currentValue *.000001) - ((firstDigit *100)+(secondDigit*10)); // = 2.8 = 2
thirdDigitLabel.text = [NSString stringWithFormat:@"%d",thirdDigit];
int fourthDigit = (currentValue *.00001) - ((firstDigit *1000)+(secondDigit*100)+(thirdDigit*10)); // = 2.8 = 2
fourthDigitLabel.text = [NSString stringWithFormat:@"%d",fourthDigit];
int fifthDigit = (currentValue *.0001) - ((firstDigit *10000)+(secondDigit*1000)+(thirdDigit*100)+(fourthDigit*10));
fifthDigitLabel.text = [NSString stringWithFormat:@"%d",fifthDigit];
int sixthDigit = (currentValue *.001) - ((firstDigit *100000)+(secondDigit*10000)+(thirdDigit*1000)+(fourthDigit*100)+(fifthDigit*10));
sixthDigitLabel.text = [NSString stringWithFormat:@"%d",sixthDigit];
int seventhDigit = (currentValue *.01) - ((firstDigit *1000000)+(secondDigit*100000)+(thirdDigit*10000)+(fourthDigit*1000)+(fifthDigit*100)+(sixthDigit*10));
seventhDigitLabel.text = [NSString stringWithFormat:@"%d",seventhDigit];
int eighthDigit = (currentValue *.1) - ((firstDigit *10000000)+(secondDigit*1000000)+(thirdDigit*100000)+(fourthDigit*10000)+(fifthDigit*1000)+(sixthDigit*100)+(seventhDigit*10));
eighthDigitLabel.text = [NSString stringWithFormat:@"%d",eighthDigit];

int ninthDigit = (currentValue *1) - ((firstDigit *100000000)+(secondDigit*10000000)+(thirdDigit*1000000)+(fourthDigit*100000)+(fifthDigit*10000)+(sixthDigit*1000)+(seventhDigit*100)+(eighthDigit*10)+1);
ninthDigitLabel.text = [NSString stringWithFormat:@"%d",ninthDigit]; 
```

虽然这可以找到前 7 位数字，但我在找到第 8 位和第 9 位时遇到了问题（它们相互依赖）。这很奇怪，因为当我自己使用第 8 位和第 9 位方程式进行数学运算时，它们起作用了，而且只有当我将它们添加到应用程序时，它们才开始搞砸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:34:06.627

您似乎不知道除法 ( `/`) 和模 ( `%`) 运算符。您可以使用模运算符 ( `%`) 获取值的个位，然后使用除法运算符 ( `/`) 删除该数字并将所有其他数字向下移动。

```
int digits[9];
int value = currentValue;
BOOL isNegative = value < 0;
if (isNegative) {
    value = -value;
}
for (int i = 0; i < 9; ++i) {
    digits[8 - i] = value % 10;
    value /= 10;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:04:25.377

我相信这是一种更有效（和可读）的方法：

```
int currentValue = someNineDigitNumber;
NSString *currentValueString = [NSString stringWithFormat: @"%i",currentValue];

NSString *firstDigit = [currentValueString substringWithRange: NSMakeRange(0,1)];
NSString *secondDigit = [currentValueString substringWithRange: NSMakeRange(1,1)];
NSString *thirdDigit = [currentValueString substringWithRange: NSMakeRange(2,1)];
NSString *fourthDigit = [currentValueString substringWithRange: NSMakeRange(3,1)];
NSString *fifthDigit = [currentValueString substringWithRange: NSMakeRange(4,1)];
NSString *sixthDigit = [currentValueString substringWithRange: NSMakeRange(5,1)];
NSString *seventhDigit = [currentValueString substringWithRange: NSMakeRange(6,1)];
NSString *eighthDigit = [currentValueString substringWithRange: NSMakeRange(7,1)];
NSString *ninthDigit = [currentValueString substringWithRange: NSMakeRange(8,1)];

firstDigitLabel.text = firstDigit;
secondDigitLabel.text = secondDigit;
thirdDigitLabel.text = thirdDigit;
fourthDigitLabel.text = fourthDigit;
fifthDigitLabel.text = fifthDigit;
sixthDigitLabel.text = sixthDigit;
seventhDigitLabel.text = seventhDigit;
eighthDigitLabel.text = eighthDigit;
ninthDigitLabel.text = ninthDigit; 
```

如果您对代码有任何疑问，请在评论中提问。希望这可以帮助！

# python - 如何从 DateTimeField 中提取年、月、日、小时和分钟？

> ID：11218305
> 
> 赞同：7
> 
> 时间：2012-06-27T01:45:20.423
> 
> 标签：python, django

我想知道如何从 DateTimeField 中提取年、月、日、小时和分钟？

我要提取信息的 datimefield 称为“redemption_date”，模型的代码是这样的：

```
from django.db import models
from datetime import datetime, timedelta
   class Code(models.Model):
        id = models.AutoField(primary_key=True)
        code_key = models.CharField(max_length=20,unique=True)
        redemption_date = models.DateTimeField(null=True, blank=True)
        user = models.ForeignKey(User, blank=True, null=True)

        # ...
        def is_expired(self):
            expired_date = datetime.now() - timedelta( days=2 )
            my_redemtion_date = self.redemption_date
            if self.redemption_date is None:
                return False
            if my_redemtion_date  < expired_date:
                    return True
            else:
                return False 
```

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T05:04:07.787

[从日期时间文档](http://docs.python.org/library/datetime.html)：

```
[...]
class datetime.datetime
A combination of a date and a time. Attributes: year, month, day, hour, 
minute, second, microsecond, and tzinfo.
[...] 
```

因此，您可以通过直接访问`redemption_date`的属性来提取您想要的信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-27T01:48:16.183

```
redemption_date.year
redemption_date.month
etc... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-27T01:57:59.310

不要忘记您的第一个信息来源应该是 python 本身。导入日期时间后，您只需输入您的 shell：

```
dir(datetime)
# even more detail on
help(datetime) 
```

# android - android SQLite外键错误

> ID：11218308
> 
> 赞同：1
> 
> 时间：2012-06-27T01:46:20.113
> 
> 标签：android, sqlite, error-handling, foreign-keys

我一直在为以下错误磨牙：

我正在定义几个表，其中两个必须共享一个值“task_id”。我在我的代码中使用以下创建语句：

```
// SQL Statement to create new Tasks table
private static final String TASKS_TABLE_CREATE = "create table " + TASKS_TABLE
    + (" (" + KEY_TASKS_TASKID + " integer primary key autoincrement, ")
    + (KEY_TASKS_TASK + " TEXT, ")
    + (KEY_TASKS_SESSION + " TEXT, ")
    + (KEY_TASKS_CONDITION + " TEXT);");
// SQL Statement to create new RAT table
private static final String RAT_TABLE_CREATE = "create table " + RAT_TABLE
    + (" (" + KEY_ID + " integer primary key autoincrement, ")
    + (KEY_RAT_TIMESTAMP + " DATETIME DEFAULT null, ")
    + (KEY_RAT_TASKID + " INTEGER NOT NULL, ")
    + ("FOREIGN KEY(" + KEY_RAT_TASKID + ") REFERENCES ")
    + (TASKS_TABLE + "(" + KEY_TASKS_TASKID + "), ")
    + (KEY_RAT_SESSION + " TEXT DEFAULT null, ")
    + (KEY_RAT_RAT_A + " TEXT DEFAULT null, ")
    + (KEY_RAT_RAT_B + " TEXT DEFAULT null, ")
    + (KEY_RAT_RAT_C + " TEXT DEFAULT null, ")
    + (KEY_RAT_ANSWER + " TEXT DEFAULT null, ")
    + (KEY_RAT_CONDITION + " TEXT DEFAULT null);"); 
```

我收到一个 SQL 异常，上面写着：

06-26 20:24:49.759: E/Database(17404): 0x25afb0 上的失败 1（接近“会话”：语法错误）在准备“创建表大鼠（_id 整数主键自动增量，timeStamp DATETIME DEFAULT null，taskId INTEGER NOT NULL, FOREIGN KEY (taskId) REFERENCES tasks (taskId), session TEXT DEFAULT null, ratA TEXT DEFAULT null, ratB TEXT DEFAULT null, ratC TEXT DEFAULT null, answer TEXT DEFAULT null, condition TEXT DEFAULT null);'。

我已经浏览过了，找不到任何可以解决我的具体问题的东西。在“创建”语句中可以引用外键的位置是否有限制？感谢您在此问题上提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:56:40.760

我认为该声明的格式应如下：

```
col_name1 TEXT REFERENCES table_name ( col_name2 ) 
```

所以你可以尝试：

```
KEY_RAT_TASKID + " REFERENCES " + TASKS_TABLE + "(" + KEY_TASKS_TASKID + ")" 
```

# seo - 子域作为托管服务器和 SEO

> ID：11218309
> 
> 赞同：0
> 
> 时间：2012-06-27T01:46:23.650
> 
> 标签：seo, hosting, subdomain

我们有一个网站 site.com，希望其他国家/地区的用户能够更快地访问该网站。想法是在每个大陆都有一个主机，并通过 GeoIP 重定向到该主机，例如：eu.site.com - 欧洲、us.site.com - 北美、au.site.com - 澳大利亚等。每个站点将具有完全相同的内容和文件，因此 eu.site.com/fr 将显示与 au.site.com/fr 完全相同的内容

问题是它将如何影响页面排名和搜索引擎优化。

site.fr、site.au、site.uk - 太难管理，所以不可接受。

fr.site.com、au.site.com、uk.site.com - 同样的问题。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:49:25.757

这是重复的内容，被 Google 视为低质量。这是[Panda 算法](http://en.wikipedia.org/wiki/Google_Panda)从搜索结果中剔除的内容。您需要做的是选择要在 Google 搜索结果中显示的主域，然后为其余网站使用[规范 URL 。](http://googlewebmastercentral.blogspot.com/2009/02/specify-your-canonical.html)然后在访问者访问该主要网站后，您可以检测他们的位置并将他们重定向到他们的本地站点。

# mysql - mysql 触发器和 phpmyadmin

> ID：11218313
> 
> 赞同：0
> 
> 时间：2012-06-27T01:46:55.527
> 
> 标签：mysql, triggers

我刚刚找到了查看触发器的命令：SHOW TRIGGERS

使用 phpmyadmin 是否有一个区域可以查看我创建的触发器？

谢谢，

垫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-09-30T18:32:56.983

虽然当时接受的答案是正确的，但较新版本的 phpmyadmin 现在确实提供了几种查看/编辑在给定数据库中创建的触发器的方法。

在数据库表列表中，展开带有触发器的表下的对象列表，以及列和索引，您将看到触发器。展开触发器并单击您要检查的触发器，您会看到一个对话框来检查和编辑触发器的属性。

只要在左列中选择了数据库或表时，还有一个名为“触发器”的选项卡，该选项卡在左列中选择了数据库或表时，在选中，将显示与侧面中选择的数据库或表相关联的触发器列表柱子。单击列表项也会弹出该触发器的查看/编辑对话框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:55:16.997

目前phpMyAdmin只能浏览数据库、表、视图、列和索引。查看触发器列表的唯一方法是运行您提到的 sql SHOW TRIGGERS。

# perl - 使用 Class::MOP::Class 创建动态数据模型不起作用

> ID：11218315
> 
> 赞同：1
> 
> 时间：2012-06-27T01:47:10.297
> 
> 标签：perl, dynamic, instance, creation

我在 JSON 文件中有模式定义，我想使用 Class::MOP::Class 动态读取和生成类。例如，有 JSON 文件 A.json、B.json、C.json 被翻译为 A、B、C 类。

现在我想从其他数据源实例化 A、B、C 的对象。

```
sub generate_classes_from_schema {
    my $self = shift;
    foreach my $cname('A', 'B', 'C') {
        my $class_def = Class::MOP::Class->create($cname); 

        foreach my $att_name(get_attrib_list($cname)) {
            $class_def->add_attribute($att_name);
        }
        $self->{class_defs}->{$cname} = $class_def;
     }
 }
...
...
sub generate_object_map {
    my $self = shift;
    my $query_key = shift;
    my $obj_map = {};

    foreach my $cname('A', 'B', 'C') {
        my $row = get_rowfor_entity($cname, $query_key);
        my $entity_object = $self->{class_defs}->{$cname}->new_object(%{$row});         
        push(@{$obj_map->{$cname}, $entity_object);
    }
    return $obj_map;
} 
```

当我转储 obj_map 时，它只有每个属性的键值对散列......

```
 'A' =>
                 bless( {
                              'att_name' => 'my-att1',
                              'att1' => '4',
                              'att2' => 'false',
                              'att2' => 'true',
                            }, 'A' ) 
```

我希望该对象至少应该具有自动生成的属性访问器方法。此外，当尝试向 class_def [$class_def->add_method(...) ] 添加方法时，这些方法也不会反映在来自 obj_map 的 Object 实例中。

有人可以解释一下我哪里出错了或者应该是什么正确的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T15:09:31.253

如果要为属性创建访问器，则必须定义访问器的名称。有关属性和方法创建和自省的更多信息，请参阅[`Class::MOP::Class`](http://metacpan.org/module/Class%3a%3aMOP%3a%3aClass)文档。

```
my $class = Class::MOP::Class->create('Foo');

# Attribute & method creation.
$class->add_attribute(bar => (accessor => 'bar'));
$class->add_method(buz => sub { return 'buz'; });

# Attribute & method introspection.
$class->get_all_attributes();
$class->get_all_methods(); 
```

# emacs - emacs dired 和 openwith

> ID：11218316
> 
> 赞同：6
> 
> 时间：2012-06-27T01:47:11.783
> 
> 标签：emacs, elisp, dired

当我从 dired 模式打开图像文件时，我想将 emacs 配置为使用外部应用程序。

另一方面，我也想在 emacs 缓冲区中使用内联图像。

要在外部应用程序中打开文件，我使用[**openwith.el**](http://web.student.tuwien.ac.at/~e0225855/misc/openwith.el) 包[http://www.emacswiki.org/emacs/OpenWith](http://www.emacswiki.org/emacs/OpenWith)

openwith 次要模式的问题在于它是全局的，并且当它由 dired-mode-hook 启用时

```
(add-hook 'dired-mode-hook
          (lambda ()
            (setq truncate-lines t)
            (openwith-mode t)
            )) 
```

它无处不在，emacs 缓冲区中的所有内联图像都在外部应用程序中打开。

我试图改变

```
:global t 
```

至

```
:global nil 
```

在[**openwith.el**](http://web.student.tuwien.ac.at/~e0225855/misc/openwith.el)中，但它以某种方式完全禁用了 openwith 模式。

所以，我的问题是：如何告诉 emacs 只在 dired 缓冲区而不是其他任何地方使用 openwith 次要模式？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T09:56:03.187

openwith-mode 的工作方式有点奇怪：它确实假设您在全局范围内使用它或根本不使用它。但是，您在这里想要的是在本地使用它，即仅在 dired 缓冲区内使用。

这不是很容易实现的，但这是一种方法。

打开你的 openwith-mode 源文件*openwith.el*。然后一直向下滚动，直到找到实际次要模式的定义。然后通过在每行的开头放置一个分号来*注释掉该定义：*

```
;;;###autoload
; (define-minor-mode openwith-mode
;   "Automatically open files with external programs."
;   :lighter ""
;   :global t
;   (if openwith-mode
;       (progn
;         ;; register `openwith-file-handler' for all files
;         (put 'openwith-file-handler 'safe-magic t)
;         (put 'openwith-file-handler 'operations '(insert-file-contents))
;         (add-to-list 'file-name-handler-alist '("" . openwith-file-handler)))
;     (setq file-name-handler-alist
;           (delete '("" . openwith-file-handler) file-name-handler-alist)))) 
```

然后在此代码下方（但在 之前`(provide 'openwith)`），插入以下代码：

```
(defvar openwith-mode nil)

(mapc (lambda (function) 
        (ad-add-advice function 
                       '(dired-openwith nil t (advice . (lambda () (let ((openwith-mode t)) ad-do-it))))
                       'around 0))
      '(dired-find-alternate-file 
        dired-find-file 
        dired-find-file-other-window
        dired-mouse-find-file-other-window
        dired-view-file))

(put 'openwith-file-handler 'safe-magic t)
(put 'openwith-file-handler 'operations '(insert-file-contents))
(add-to-list 'file-name-handler-alist '("" . openwith-file-handler)) 
```

这段代码做了一些事情。

首先，它定义了一个名为 openwith-mode 的变量。此变量用于决定是否使用外部应用程序的 openwith-mode 函数之一。通常，当你定义一个次要模式时，Emacs 会自动提供一个这样的变量——但是由于我们刚刚注释掉了上面实际次要模式的定义，所以我们在这里明确地重新引入了这个变量。

变量的目的是作为一种开关，通过它我们可以控制图像文件是否应该内联或传递给外部查看器。

接下来我们有`(mapc ...)`表达式。我们在这里所做的是遍历五个函数的列表：

*   dired-find-alternate 文件
*   目录查找文件
*   dired-查找文件-其他窗口
*   dired-mouse-find-file-other-window
*   目录视图文件

哪些是 dired 提供的用于打开文件的函数。我们向这些函数中的每一个添加少量代码，这种技术称为[advising](http://www.gnu.org/software/emacs/manual/html_node/elisp/Advising-Functions.html)：每当调用这五个函数中的一个时，`(ad-add-advice...)`将变量设置`openwith-mode`为。`t`在函数调用之外，变量仍然设置为`nil`.

这样做的效果是，每当您使用 dired 的函数之一打开文件时，负责调用外部应用程序的 openwith-mode 函数会看到设置为的变量，`t`并在知道外部应用程序的情况下立即尝试打开一个外部应用程序。我们必须跳过这些环节的原因是，每当您使用打开图像文件时，也会调用相同的 openwith-mode 函数`C-x C-f`——这正是 openwith-mode 的实现方式。

（注意：不幸的是，我们不能只使用当前的主模式作为开关，因为这将是已经为文件打开而创建的新缓冲区的主模式。它总是`fundamental-mode`。）

最后，最后三行只是从我们之前注释掉的次要模式定义中复制和粘贴。他们说我已经提到了很多并且负责调用外部应用程序的函数——被称为`open-with-filehandler`——是一个所谓的文件处理程序。它对于实际访问文件并没有做任何特别的事情，因此我们`safe-magic`将该函数设置为`t`. 此外，我们声明该操作`insert-file-contents`由我们的函数以非平凡的方式处理。（有关这些属性的更多信息，请参见[此处](http://www.gnu.org/software/emacs/manual/html_node/elisp/Magic-File-Names.html)。）

最后，我们实际安装文件处理程序。

* * *

**重要提示**：openwith-mode 文档建议您将以下两行放入 .emacs 文件中：

```
(require 'openwith)
(openwith-mode t) 
```

现在不再存在次要模式`openwith-mode`（在我们注释掉它的定义之后），请确保删除第二行，例如也将其注释掉：

```
;; (openwith-mode t) 
```

重新启动 Emacs 后，如果你用 dired 打开一个图像文件，它应该在外部应用程序中打开；如果您通过`C-x C-f`它打开它，它将被内联在缓冲区中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T12:49:59.440

我不使用`openwith`. 我使用定义的函数

[http://ergoemacs.org/emacs/emacs_dired_open_file_in_ext_apps.html](http://ergoemacs.org/emacs/emacs_dired_open_file_in_ext_apps.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:17:20.060

一种方法是在 openwith.el 中将 emacsclient 设置为您喜欢的文件类型的首选程序，`openwith-associations`然后开始使用 emacsclient。

您可以每次都启动新的 emacs 会话，但这听起来比以前的建议更难看。

# ios - 在 iOS SDK 中逐行读取文件

> ID：11218318
> 
> 赞同：3
> 
> 时间：2012-06-27T01:47:51.487
> 
> 标签：ios, xcode, sdk

我有一个texfile如下：

```
line1
line2
line3
line4
line5
 .... 
```

我想从文件中读取两个字符串数组，以便`line1, line3, line 5,...`进入`array1`并`line 2, line 4, line 6,...`进入`array2`. 数组的每个元素存储一行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T01:55:38.437

步骤 1) 读取文件 ( `[NSString stringWithContentsOfFile:encoding:error:]`)

步骤 2) 拆分字符串 ( `[NSString componentsSeparatedByCharactersInSet:[NSCharacterSet newlineCharacterSet]]`)

步骤 3) 遍历数组并插入到您的 2 个数组中

# ios - UITableView - 从单独的类中重新加载数据

> ID：11218321
> 
> 赞同：1
> 
> 时间：2012-06-27T01:48:40.500
> 
> 标签：ios, uitableview, ios5, uipopovercontroller, reloaddata

我搜索并查看了许多类似的问题，但仍然找不到答案。如何在不初始化它的另一个实例的情况下引用不同的类？如何从单独的类中调用“reloadData”以反映 MOC 的数据。MOC 似乎正在保存，因为我已经通过 NSNotification 验证了它。

弹出框类：

```
-(void)actionSave:(id)sender {
     MainContent *entityContent =
         [NSEntityDescription insertNewObjectForEntityForName:@"MainContent"
              inManagedObjectContext:self.mDoc.managedObjectContext];
     entityContent.date = [NSDate date];
     entityContent.title = self.titleName.text;

     //Main Question: How do I call the ViewController's function that is in a separate class?
     [ViewController reloadTableView]; //???

     //Separate Question: How do I dismiss this popover from inside of this function?
} 
```

视图控制器类：

```
-(void)setupTable {
    self.tableView = [[UITableView alloc] initWithFrame:CGRectMake(gridV1, 140, column1_width, 768-170) style:UITableViewStylePlain];
    [self.tableView setBackgroundColor:[UIColor clearColor]];

    self.tableView.autoresizesSubviews = YES;

    self.tableView.delegate = self.tableViewController;
    self.tableView.dataSource = self.tableViewController;
    [self.view addSubview:self.tableView];
}
-(void)reloadTableView{
    [self.tableView reloadData];
} 
```

TableViewController 类：（self.tableView 的委托和数据源）

```
- (void)setupFetchedResultsController
{
    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"MainContent"];

    // I want to sort them by the "date" attribute input by [NSDate date].
    request.sortDescriptors = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"date" ascending:YES]];

    // no predicate because we want ALL of the data in the "MainContent" entity.

    self.fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request                                                                
        managedObjectContext:self.mDoc.managedObjectContext sectionNameKeyPath:nil cacheName:nil];
}
- (void)setMDoc:(UIManagedDocument *)mDoc {
    if (_mDoc != mDoc) _mDoc = mDoc;
}
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    if (!self.mDoc) {
        [[globalMDoc sharedDocumentHandler] performWithDocument:^(UIManagedDocument *coreDatabase) {
            self.mDoc = coreDatabase;
            [self setupFetchedResultsController];
        }];
    }
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Overview Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }
    MainContent *content = [self.fetchedResultsController objectAtIndexPath:indexPath];
    cell.textLabel.text = content.title;
    cell.detailTextLabel.text = [NSString stringWithFormat:@"%d", [content date]];

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T01:51:29.250

我个人使用 NSNotifcations，我有几个异步发生的事件，然后我发回通知。

也就是说，我所做的是在后台线程上下载图片，并在完成后重新加载表格。我通过向 tableviewclass 发送通知来做到这一点，并且 table view 类重新加载它自己的 tableview。

~ 丹

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T04:09:22.787

好的，像这个链接中的例子一样制作一个单身人士：[http ://www.galloway.me.uk/tutorials/singleton-classes/](http://www.galloway.me.uk/tutorials/singleton-classes/)

然后在你的 UITableView 所在的 UIViewController 的 Singleton 中创建一个 ivar。然后在 UITableView 视图的 VDL 中，执行类似的操作

`[Singleton sharedSingleton].theViewController = self;`

然后在另一个视图中做类似的事情

```
 Singleton *singleton = [Singleton sharedSingleton];
    [singleton.mytableview reloadData]; 
```

但是，对于 (= self) 行，您可能希望更早地在 applicationDidFinishLaunching 之类的地方执行此操作，以便在您尝试访问时 theViewController 变量不为零。

# eclipse - 设置 Aspectj 工具

> ID：11218326
> 
> 赞同：1
> 
> 时间：2012-06-27T01:49:35.490
> 
> 标签：eclipse, resources, runtime, aspectj

这个问题必须有一个简单的答案，但我无法得到它。

我需要将 org.eclipse.core.resources 和 org.eclipse.core.runtime 库与 IResources,IProject,IWorkspace,... 类一起使用。为此，我下载了包含它们的 aspectjtools.jar。我已经将 aspectjtools.jar 添加到了 eclipse 项目中的项目类路径中。

该项目包含一个简单的 JSP 页面，该页面导入 org.eclipse.core.resources 和 org.eclipse.core.runtime 库，但是当我尝试使用例如 IWorkspace 类时，我得到一个异常（IWorkspace 无法解析为一个类型），因为类 IWorkspace 不存在。

我已经读到需要另一个步骤。关于编辑 aspectjtools.jar/META-INF/MANIFEST.MF 的东西，但我不知道在里面写什么。

如果需要，请询问更多详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T12:16:32.530

我已经解决了 Viktor Stolbin 答案的问题。

1.  将 .jar 文件放入项目子目录中。
2.  将 .jar 文件添加到类路径： Project>Properties>Java Build Path>Add Jar>Project jar 文件的子目录
3.  按照以下说明进行操作：[使用 Eclipse/Tomcat 自动将 3rd 方 jars 添加到 WEB-INF/lib](https://stackoverflow.com/questions/5467038/adding-3rd-party-jars-to-web-inf-lib-automatically-using-eclipse-tomcat)

# lua - 如何通过引用分配lua变量

> ID：11218330
> 
> 赞同：6
> 
> 时间：2012-06-27T01:50:07.660
> 
> 标签：lua

如何通过 Lua 中的引用将变量分配给另一个变量？

例如：想要做等价于“a = b”，其中 a 将是指向 b 的指针

背景：有一个案例，我实际上有这样的事情：

```
local a,b,c,d,e,f,g   -- lots of variables

if answer == 1 then
  -- do stuff with a
elsif answer == 1 then
  -- do stuff with b
.
.
. 
```

PS。例如在下面，显然 b=a 是按值计算的。注意：我正在使用 Corona SDK。

```
a = 1
b = a
a = 2
print ("a/b:", a, b)

-- OUTPUT: a/b: 2   1 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-27T02:16:06.030

编辑：关于您澄清的帖子和示例，在 Lua 中没有您想要的参考类型。您希望一个变量引用另一个变量。在 Lua 中，变量只是值的名称。就是这样。

以下内容有效，因为`b = a`两者都保留`a`并`b`引用相同的表值：

```
a = { value = "Testing 1,2,3" }
b = a

-- b and a now refer to the same table
print(a.value) -- Testing 1,2,3
print(b.value) -- Testing 1,2,3

a = { value = "Duck" }

-- a now refers to a different table; b is unaffected
print(a.value) -- Duck
print(b.value) -- Testing 1,2,3 
```

* * *

您可以将 Lua 中的所有变量赋值视为引用。

这在技术上适用于表、函数、协程和字符串。数字、布尔值和 nil*可能也是*如此，因为它们是不可变类型，所以就您的程序而言，没有区别。

例如：

```
t = {}
b = true
s = "testing 1,2,3"
f = function() end

t2 = t -- t2 refers to the same table
t2.foo = "Donut"
print(t.foo) -- Donut

s2 = s -- s2 refers to the same string as s
f2 = f -- f2 refers to the same function as f
b2 = b -- b2 contains a copy of b's value, but since it's immutable there's no practical difference
-- so on and so forth -- 
```

* * *

简短版本：这只对可变类型有实际意义，在 Lua 中是 userdata 和 table。在这两种情况下，赋值都是复制引用，而不是值（即不是对象的克隆或副本，而是指针赋值）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-03T23:14:35.710

确实，变量只是值的名称。但是，如果您正在处理表中的键，则可以计算变量名。这意味着您可以使用键名来执行条件逻辑。

```
myvars = { a=1, b=2, c=3.14 }

function choose(input)
    print(myvars[input])
end

choose('a')
choose('b')
a = 'a'
choose(a)
b = a
choose(b)
a = 'c'
choose(a)
choose(b) 
```

输出：

```
1
2
1
1
3.14
1 
```

# objective-c - 如何正确初始化 RestKit 的 objectStore 以使用 Documents 以外的目录

> ID：11218334
> 
> 赞同：0
> 
> 时间：2012-06-27T01:51:07.157
> 
> 标签：objective-c, ios, rest, core-data, restkit

所以我看到 RestKit 的参考中有一个 init 方法：[objectStoreWithStoreFilename:inDirectory:usingSeedDatabaseName:managedObjectModel:delegate](http://restkit.org/api/master/Classes/RKManagedObjectStore.html#//api/name/objectStoreWithStoreFilename%3ainDirectory%3ausingSeedDatabaseName%3amanagedObjectModel%3adelegate%3a)假设在指定的目录中初始化 objectStore。“inDirectory”参数接受 NSString。我已经尝试过@"Library/Caches" 和 [self.applicationCachesDirectory absoluteURL]，其中 self.applicationCachesDirectory 返回 Caches 目录的 URL，但我遇到了异常。

请告诉我如何在此方法中指定“库/缓存”以便将 sqlite DB 保存在缓存目录而不是文档中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:14:11.413

得到它的工作。我创建了辅助方法来获取 Caches 文件夹路径作为 NSString

```
 - (NSString *)applicationCachesDirectoryString
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);
    NSString *cachePath = [paths objectAtIndex:0];
    BOOL isDir = NO;
    NSError *error;
    if (! [[NSFileManager defaultManager] fileExistsAtPath:cachePath isDirectory:&isDir] && isDir == NO) {
        [[NSFileManager defaultManager] createDirectoryAtPath:cachePath withIntermediateDirectories:NO attributes:nil error:&error];
    }
    return cachePath;
} 
```

然后将其传递给 objectStore init 方法：

```
self.objectManager.objectStore = [RKManagedObjectStore objectStoreWithStoreFilename:databaseName inDirectory:[self applicationCachesDirectoryString] usingSeedDatabaseName:seedDatabaseName managedObjectModel:managedObjectModel delegate:self]; 
```

# php - PHP : Post get 方法，需要一些建议

> ID：11218336
> 
> 赞同：2
> 
> 时间：2012-06-27T01:51:29.143
> 
> 标签：php

我是 php 新手，需要了解 post get 方法如何对我的代码有用。我的情况是，我有 3 个网页，第一个网页是 html 表单，我在这里使用 post 方法，然后我从表单中获取名字和姓氏，并`$_POST[firstname]`在第二个网页上输入一个 sql 查询（例如），它会为我生成一些数据我正在打印这些数据。

现在我需要将相同的参数传递给第三页，它会根据在第一个 HTML 表单中输入的名字和姓氏生成一些图表？

如何在第三个 php 页面上保留这些值？我在页面上引用了第 3 页的 url，我认为这还不够，我尝试了 Google 搜索，发现 post get 可能有用，但需要一些专家建议。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:26:07.367

你可以使用这样的东西：

**第 1 页 (page1.php)**

```
<form action="page2.php" method="post">
    <input type="text" name="firstname" value="" />
    <input type="text" name="lastname" value="" />
    <input type="submit" value="Submit" />
</form> 
```

**第二（page2.php）**

检索和验证`$_POST['firstname']`，`$_POST['lastname']`然后使用所需数据创建输出，您可以根据需要使用隐藏字段或创建链接。例如：

```
$firstname = $_POST['firstname'];
$lastname  = $_POST['lastname'];

// Output with links can pass data by GET method
echo '<a href="page3.php?firstname='.$firstname.'&lastname='.$lastname.'"></a>';

// Output with hidden fields, you can use POST or GET method or even Javascript/Ajax
echo '
<form action="page3.php" method="get">
    <input type="hidden" name="firstname" value="'.$firstname.'" />
    <input type="hidden" name="lastname" value="'.$lastname.'" />
    <input type="submit" value="Submit" />
</form>'; 
```

**第三页（page3.php）**

如果您将解决方案与链接或带有 GET 方法的表单一起使用，则`page3.php`只需执行以下操作即可检索数据：

```
$firstname = $_GET['firstname'];
$lastname  = $_GET['lastname']; 
```

希望它可以帮助你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T01:53:31.307

使用 PHP 会话在 PHP 页面之间存储数据。或者，您可以只提取已添加到数据库中的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T01:55:19.530

您将要使用该`$_SESSION`变量。

[在这里阅读](http://www.tizag.com/phpT/phpsessions.php/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T01:57:44.850

我能想到的一种方法是将第一页中的值放入第二页上的隐藏字段中，该字段将与第二页上的表单一起提交：

```
<form action="page3.php" method="post">
    <input type="hidden" name="firstname" value="<?php echo $_POST['firstname']; ?>" />
    <input type="hidden" name="lastname" value="<?php echo $_POST['lastname']; ?>" />
    <input type="submit" value="Submit" />
</form> 
```

当然，如果其中任何内容进入数据库或可能影响站点的安全性和持久性，您当然要确保验证和清理您的输入等。

# iphone - 如何在 UITextView 中内联添加令牌

> ID：11218341
> 
> 赞同：3
> 
> 时间：2012-06-27T01:51:56.393
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uitextview

我想在 UITextView 中添加内联标记或按钮。我正在考虑尝试将 NSTokenFields 嵌入到 UITextView 中？我不知道这是否是解决问题的最佳方式。我会感谢任何关于如何实现这一目标的方向。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T01:59:06.907

NSTokenField 在 iOS 上不存在。

看看[https://github.com/jasarien/JSTokenField——](https://github.com/jasarien/JSTokenField)它并不完美，但它是一个公平的模拟。

# xslt - 如何在 Umbraco CMS 的某些页面上只显示模板的一部分？

> ID：11218345
> 
> 赞同：0
> 
> 时间：2012-06-27T01:53:25.750
> 
> 标签：xslt, umbraco

我有一个使用 Umbraco 构建的站点，该站点有一个带有多个小部件设置的侧边栏。我需要设置它，以便其中一个小部件（作为 XSLT 完成）仅显示在某个页面上。我看过使用 xsl:if 测试和匹配但无法弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T11:46:43.270

您走在正确的轨道上，但要养成在问题中包含您已经尝试过的内容（代码等）的习惯。

**快速+肮脏的方法**

找出您页面的 ID（在内容部分的节点的属性选项卡上找到）并使用以下代码：

```
<xsl:if test="$currentPage/@id = 1234">
    <!-- your widget here -->
</xsl:if> 
```

**更清洁的方法**

始终尝试将代码构建为可扩展的，例如，您可能会发现将来希望将小部件包含在另一个页面上，或者将内容从登台部署到生产可能涉及节点 ID 在您没有意识到的情况下更改（不经常，但可能发生）。

将属性添加到相关页面（让我们称之为`showMyFancyWidget`）作为真/假数据类型，在内容部分中轻弹它，然后使用以下代码：

```
<xsl:if test="$currentPage/showMyFancyWidget = 1">
    <!-- your widget here -->
</xsl:if> 
```

*此代码适用于 Umbraco v4.5.1 及更高版本。对 v5 不太确定，但无论如何它已经停止支持 v4.7*

# ruby - 有没有办法让这个 Ruby 三元运算正确评估？

> ID：11218347
> 
> 赞同：3
> 
> 时间：2012-06-27T01:53:35.833
> 
> 标签：ruby, ternary-operator

以下代码行

```
<% invite.accepted ? { @going, @not_going = 'selected', '' } : { @going, @not_going = '', 'selected' } %> 
```

是我尝试将几个操作（评估表达式并相应地设置两个变量的值）压缩成一行。

它引发了一个错误，声称有一个意外的逗号。

有没有办法使这项工作，或者我只是重载可怜的三元运算符？

（顺便说一句，这只是一个个人实验。我不介意使用简单的 -- 尽管很麻烦 -- if/else 语句）

编辑：以下代码行有效！我会尽快检查正确的答案！

```
<% invite.accepted ? ( @going, @not_going = 'selected', '' ) : ( @going, @not_going = '', 'selected' ) %> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T02:03:10.947

怎么样：

```
@going, @not_going = invite.accepted ? ['selected', ''] : ['', 'selected'] 
```

`w, x = y, z`与 相同`w, x = [y, z]`，因此可以正常工作并且没有重复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T01:57:59.637

您似乎是分配`true`给`invite.accepted`它而不是对其进行测试，试试这个：

```
<% (invite.accepted == true) ? (@coming, @not_coming = 'coming', '') : (@going, @not_going = 'not coming', 'selected') %> 
```

这会更好，因为您不需要测试 if `true == true`：

```
<% (invite.accepted) ? (@coming, @not_coming = 'coming', '') : (@going, @not_going = 'not coming', 'selected') %> 
```

**编辑**

您也可以尝试将其包装在一个函数中，以便它评估为单个实体：

```
<% (invite.accepted) ? assign(@coming, @not_coming, 'coming', '') : assign(@going, @not_going, 'not coming', 'selected') %>

def assign(a,b,c,d)
   a, b = c,d;
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T02:09:22.120

父母*和* `;`工作：

```
irb(main):018:0> foo = true ? (a=:a ; b=:b) : :foo
=> :b
irb(main):019:0> a
=> :a
irb(main):020:0> b
=> :b
irb(main):021:0> 
```

* * *

请注意，这`,`不是语句分隔符：

```
irb(main):001:0> a=:a, b=:b
=> [:a, :b]
irb(main):002:0> a
=> [:a, :b]
irb(main):003:0> b
=> :b
irb(main):004:0> 
```

A`;`是语句分隔符：

```
irb(main):004:0> a=:a; b=:b
=> :b
irb(main):005:0> a
=> :a
irb(main):006:0> b
=> :b
irb(main):007:0> 
```

但这并不能立即帮助您，因为解释器不是在寻找语句分隔符——只有`:`：

```
irb(main):014:0> foo = true ? a=:a, b=:b : :foo
SyntaxError: (irb):14: syntax error, unexpected ',', expecting ':'
foo = true ? a=:a, b=:b : :foo
... 
```

Parens 并`,`不会引发错误，但它不能按预期工作：

```
irb(main):021:0> foo = true ? (a=:a , b=:b) : :foo
=> [:a, :b]
irb(main):022:0> a
=> [:a, :b]
irb(main):023:0> b
=> :b
irb(main):024:0> 
```

我希望`do .. end`工作，但这也失败了：

```
irb(main):024:0> foo = true ? do a=:a ; b=:b end : :foo
SyntaxError: (irb):24: syntax error, unexpected keyword_do
foo = true ? do a=:a ; b=:b end : :foo
... 
```

# c# - c# 相当于 \x php 转义序列？

> ID：11218350
> 
> 赞同：1
> 
> 时间：2012-06-27T01:53:48.840
> 
> 标签：c#, php, escaping

c# 中是否有任何等效的 \x PHP 转义序列？
看我的例子：

```
<?php  
$a = "\xC1";  
$b = "\x82";  
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:00:47.897

这可能以前已经回答过，请查看以前的帖子以查看是否有帮助：

[C# 构建十六进制符号字符串](https://stackoverflow.com/questions/284093/c-sharp-build-hexadecimal-notation-string)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:01:18.597

你可以用 \u 来做。这将在字符串中插入一个*unicode*字符。.Net 中的字符串是 unicode，因此您不能像在其他语言中那样输入单字节值。

请参阅[http://msdn.microsoft.com/en-us/library/aa664669(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa664669(v=vs.71).aspx)。

# ios - 许多 UIImageView 的内存管理

> ID：11218351
> 
> 赞同：0
> 
> 时间：2012-06-27T01:53:59.747
> 
> 标签：ios, memory, memory-management, uiscrollview, uiimageview

我正在制作一个 iOS 应用程序，如果内存不是问题，屏幕上会同时加载数千张图像。显然，这不是一个好方法，所以我想做的是“取消渲染”其中一些图像，以便在任何给定点上只有少数图像出现在屏幕上，然后在用户采取某些操作时“重新渲染”它们。所以我的问题是，我该怎么做？

或者，如果更简单的话，所有图像都是相同的；我知道这听起来可能有点奇怪，但是是的，我的应用程序可能需要在屏幕上加载数千张相同的图像。既然是这种情况，内存管理是否真的不是一个问题，因为它们都将引用同一个文件？（这不是问题，我的意思是我可以使用该`hidden`属性来更改屏幕上的内容和不在屏幕上的内容）。如果我能做到这一点，我正在做

```
UIImage *image = [[UIImage alloc] initWithContentsOfFile:@"image.png"];
UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
[scrollView addSubview:imageView]; 
```

（scrollView 是`UIScrollView`我用来为 提供捏缩放功能的一个`UIImageView`）。但是，问题是，当我这样做时，根本`UIImageView`不会渲染。

当然，任何其他想法或建议都会受到赞赏，并在此先感谢：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:38:07.520

答案取决于您的 UI。当您说数千张图像时，一次可见多少张。它是不是有点像一个巨大的照片库，在任何特定时间实际上只有少数几个是可见的？在这种情况下，您可能只为当时可见的图像维护视图，而那些从可见屏幕滚动出来的视图在滚动之前不会有任何与之关联的视图（以及那些可见但现在滚动关闭将被释放）。

但是，如果您正在处理一个不同的问题，大量的小图像，其中许多可能同时可见，那就是一个不同的问题（通过 qegal 提供的[链接解决）。](https://stackoverflow.com/questions/2507441)

我假设您正在尝试做一些更像后者的事情，但无论如何，您必须让我们对图像的性质以及我们在这里处理的用户体验有一个更好的了解。

**更新：**

听起来你正在做一些更像前者的事情。在这种情况下...

查看[PhotoScroller](http://developer.apple.com/library/ios/#samplecode/PhotoScroller/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010080)，这是 Apple 在大量图像集合中导航的示例（应用程序中只有三个图像，但您明白了）。

就个人而言，我有一个低技术实现，我有一个照片浏览器，我在其中水平平移（UIPanGestureRecognizer）通过大量图像（大约 100，但也可以很容易地很多很多）。但是，我的视图控制器只有三个 UIImageView 控件，一个用于显示主图像，一个用于上一个图像（它的框架设置在屏幕左侧），一个用于下一个图像（和它的框架设置在屏幕右侧）。当我收到来自 UIPanGestureRecognizer 的持续反馈时，我通过手势识别器的 translateInView 的水平部分调整所有三个帧（我见过其他使用滚动视图来协调图像移动的实现，但想法仍然是相同的）。当我放手时，我的手势识别器确定我是否成功滑动到下一个或上一个图像，完成该动画，完成后，它重新定位三个 UIImageViews（上一个离屏到左侧，当前在屏幕上，下一个离屏到右侧）并重新加载具有适当“当前”、“上一个”和“下一个”图像的三个图像视图。此时，您已准备好使用手势识别器再次滑动。

# c# - 从列表视图中提取数据

> ID：11218352
> 
> 赞同：0
> 
> 时间：2012-06-27T01:54:00.187
> 
> 标签：c#, sql-server-2008, listview, web-applications, asp.net-4.0

我有一个列表视图“ListView1”，它链接到我的客户 mssql 数据库上的客户表。现在，我已添加`OnItemDeleting= "ArchiveBeforeDelete"`到 Listview 中，因为我希望在将客户从普通数据库中删除之前对其进行存档（移动到我存档客户的数据库客户表中）。我已经能够使用索引来检索 selectedindex，`e.ItemIndex`但现在我无法弄清楚如何使用索引提取数据，更具体地说，只是 CustomerID 部分。我查看了属性和方法，但找不到有效的方法。

**编辑：** 这是列表视图的 .aspx 页面中的代码

```
<asp:ListView ID="ListView1" runat="server" DataKeyNames="CustomerId" 
    DataSourceID="SqlDataSource1" OnItemDeleting= "ArchiveBeforeDelete">
    <AlternatingItemTemplate>
        <tr style="background-color: #FAFAD2;color: #284775;">
            <td>
                <asp:Button ID="ArchiveButton" runat="server" CommandName="Delete"
                    Text="Archive" />
                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
            </td>
            <td>
                <asp:Label ID="CustomerIdLabel" runat="server" 
                    Text='<%# Eval("CustomerId") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerStatusLabel" runat="server" 
                    Text='<%# Eval("CustomerStatus") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerFirstNameLabel" runat="server" 
                    Text='<%# Eval("CustomerFirstName") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerLastNameLabel" runat="server" 
                    Text='<%# Eval("CustomerLastName") %>' />
            </td>
            <td>
                <asp:Label ID="CompanyNameLabel" runat="server" 
                    Text='<%# Eval("CompanyName") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerEmailLabel" runat="server" 
                    Text='<%# Eval("CustomerEmail") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerTypeLabel" runat="server" 
                    Text='<%# Eval("CustomerType") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPhoneNumberLabel" runat="server" 
                    Text='<%# Eval("CustomerPhoneNumber") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerSubscriptionTypeLabel" runat="server" 
                    Text='<%# Eval("CustomerSubscriptionType") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPaymentMethodLabel" runat="server" 
                    Text='<%# Eval("CustomerPaymentMethod") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPickUpDayLabel" runat="server" 
                    Text='<%# Eval("CustomerPickUpDay") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPickUpDay2Label" runat="server" 
                    Text='<%# Eval("CustomerPickUpDay2") %>' />
            </td>
        </tr>
    </AlternatingItemTemplate>
    <EditItemTemplate>
        <tr style="background-color: #FFCC66;color: #000080;">
            <td>
                <asp:Button ID="UpdateButton" runat="server" CommandName="Update" 
                    Text="Update" />
                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                    Text="Cancel" />
            </td>
            <td>
                <asp:Label ID="CustomerIdLabel1" runat="server" 
                    Text='<%# Eval("CustomerId") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerStatusTextBox" runat="server" 
                    Text='<%# Bind("CustomerStatus") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerFirstNameTextBox" runat="server" 
                    Text='<%# Bind("CustomerFirstName") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerLastNameTextBox" runat="server" 
                    Text='<%# Bind("CustomerLastName") %>' />
            </td>
            <td>
                <asp:TextBox ID="CompanyNameTextBox" runat="server" 
                    Text='<%# Bind("CompanyName") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerEmailTextBox" runat="server" 
                    Text='<%# Bind("CustomerEmail") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerTypeTextBox" runat="server" 
                    Text='<%# Bind("CustomerType") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPhoneNumberTextBox" runat="server" 
                    Text='<%# Bind("CustomerPhoneNumber") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerSubscriptionTypeTextBox" runat="server" 
                    Text='<%# Bind("CustomerSubscriptionType") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPaymentMethodTextBox" runat="server" 
                    Text='<%# Bind("CustomerPaymentMethod") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPickUpDayTextBox" runat="server" 
                    Text='<%# Bind("CustomerPickUpDay") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPickUpDay2TextBox" runat="server" 
                    Text='<%# Bind("CustomerPickUpDay2") %>' />
            </td>
        </tr>
    </EditItemTemplate>
    <EmptyDataTemplate>
        <table runat="server" 
            style="background-color: #FFFFFF;border-collapse: collapse;border-color: #999999;border-style:none;border-width:1px;">
            <tr>
                <td>
                    No data was returned.</td>
            </tr>
        </table>
    </EmptyDataTemplate>
    <InsertItemTemplate>
        <tr style="">
            <td>
                <asp:Button ID="InsertButton" runat="server" CommandName="Insert" 
                    Text="Insert" />
                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                    Text="Clear" />
            </td>
            <td>
                &nbsp;</td>
            <td>
                <asp:TextBox ID="CustomerStatusTextBox" runat="server" 
                    Text='<%# Bind("CustomerStatus") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerFirstNameTextBox" runat="server" 
                    Text='<%# Bind("CustomerFirstName") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerLastNameTextBox" runat="server" 
                    Text='<%# Bind("CustomerLastName") %>' />
            </td>
            <td>
                <asp:TextBox ID="CompanyNameTextBox" runat="server" 
                    Text='<%# Bind("CompanyName") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerEmailTextBox" runat="server" 
                    Text='<%# Bind("CustomerEmail") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerTypeTextBox" runat="server" 
                    Text='<%# Bind("CustomerType") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPhoneNumberTextBox" runat="server" 
                    Text='<%# Bind("CustomerPhoneNumber") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerSubscriptionTypeTextBox" runat="server" 
                    Text='<%# Bind("CustomerSubscriptionType") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPaymentMethodTextBox" runat="server" 
                    Text='<%# Bind("CustomerPaymentMethod") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPickUpDayTextBox" runat="server" 
                    Text='<%# Bind("CustomerPickUpDay") %>' />
            </td>
            <td>
                <asp:TextBox ID="CustomerPickUpDay2TextBox" runat="server" 
                    Text='<%# Bind("CustomerPickUpDay2") %>' />
            </td>
        </tr>
    </InsertItemTemplate>
    <ItemTemplate>
        <tr style="background-color: #FFFBD6;color: #333333;">
            <td>
                <asp:Button ID="ArchiveButton" runat="server" CommandName="Delete"
                    Text="Archive" />
                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
            </td>
            <td>
                <asp:Label ID="CustomerIdLabel" runat="server" 
                    Text='<%# Eval("CustomerId") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerStatusLabel" runat="server" 
                    Text='<%# Eval("CustomerStatus") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerFirstNameLabel" runat="server" 
                    Text='<%# Eval("CustomerFirstName") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerLastNameLabel" runat="server" 
                    Text='<%# Eval("CustomerLastName") %>' />
            </td>
            <td>
                <asp:Label ID="CompanyNameLabel" runat="server" 
                    Text='<%# Eval("CompanyName") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerEmailLabel" runat="server" 
                    Text='<%# Eval("CustomerEmail") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerTypeLabel" runat="server" 
                    Text='<%# Eval("CustomerType") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPhoneNumberLabel" runat="server" 
                    Text='<%# Eval("CustomerPhoneNumber") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerSubscriptionTypeLabel" runat="server" 
                    Text='<%# Eval("CustomerSubscriptionType") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPaymentMethodLabel" runat="server" 
                    Text='<%# Eval("CustomerPaymentMethod") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPickUpDayLabel" runat="server" 
                    Text='<%# Eval("CustomerPickUpDay") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPickUpDay2Label" runat="server" 
                    Text='<%# Eval("CustomerPickUpDay2") %>' />
            </td>
        </tr>
    </ItemTemplate>
    <LayoutTemplate>
        <table runat="server">
            <tr runat="server">
                <td runat="server">
                    <table ID="itemPlaceholderContainer" runat="server" border="1" 
                        style="background-color: #FFFFFF;border-collapse: collapse;border-color: #999999;border-style:none;border-width:1px;font-family: Verdana, Arial, Helvetica, sans-serif;">
                        <tr runat="server" style="background-color: #FFFBD6;color: #333333;">
                            <th runat="server">
                            </th>
                            <th runat="server">
                                Id</th>
                            <th runat="server">
                                Status</th>
                            <th runat="server">
                                First Name</th>
                            <th runat="server">
                                Last Name</th>
                            <th runat="server">
                                Company Name</th>
                            <th runat="server">
                                E-mail</th>
                            <th runat="server">
                                Type</th>
                            <th runat="server">
                                Phone Number</th>
                            <th runat="server">
                                Subscription Type</th>
                            <th runat="server">
                                Payment Method</th>
                            <th runat="server">
                                Pick-Up Day</th>
                            <th runat="server">
                                Second Pick-Up Day</th>
                        </tr>
                        <tr ID="itemPlaceholder" runat="server">
                        </tr>
                    </table>
                </td>
            </tr>
            <tr runat="server">
                <td runat="server" 
                    style="text-align: center;background-color: #FFCC66;font-family: Verdana, Arial, Helvetica, sans-serif;color: #333333;">
                    <asp:DataPager ID="DataPager1" runat="server">
                        <Fields>
                            <asp:NextPreviousPagerField ButtonType="Button" ShowFirstPageButton="True" 
                                ShowNextPageButton="False" ShowPreviousPageButton="False" />
                            <asp:NumericPagerField />
                            <asp:NextPreviousPagerField ButtonType="Button" ShowLastPageButton="True" 
                                ShowNextPageButton="False" ShowPreviousPageButton="False" />
                        </Fields>
                    </asp:DataPager>
                </td>
            </tr>
        </table>
    </LayoutTemplate>
    <SelectedItemTemplate>
        <tr style="background-color: #FFCC66;font-weight: bold;color: #000080;">
            <td>
                <asp:Button ID="DeleteButton" runat="server" CommandName="Delete" 
                    Text="Delete" />
                <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
            </td>
            <td>
                <asp:Label ID="CustomerIdLabel" runat="server" 
                    Text='<%# Eval("CustomerId") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerStatusLabel" runat="server" 
                    Text='<%# Eval("CustomerStatus") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerFirstNameLabel" runat="server" 
                    Text='<%# Eval("CustomerFirstName") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerLastNameLabel" runat="server" 
                    Text='<%# Eval("CustomerLastName") %>' />
            </td>
            <td>
                <asp:Label ID="CompanyNameLabel" runat="server" 
                    Text='<%# Eval("CompanyName") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerEmailLabel" runat="server" 
                    Text='<%# Eval("CustomerEmail") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerTypeLabel" runat="server" 
                    Text='<%# Eval("CustomerType") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPhoneNumberLabel" runat="server" 
                    Text='<%# Eval("CustomerPhoneNumber") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerSubscriptionTypeLabel" runat="server" 
                    Text='<%# Eval("CustomerSubscriptionType") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPaymentMethodLabel" runat="server" 
                    Text='<%# Eval("CustomerPaymentMethod") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPickUpDayLabel" runat="server" 
                    Text='<%# Eval("CustomerPickUpDay") %>' />
            </td>
            <td>
                <asp:Label ID="CustomerPickUpDay2Label" runat="server" 
                    Text='<%# Eval("CustomerPickUpDay2") %>' />
            </td>
        </tr>
    </SelectedItemTemplate>
</asp:ListView>
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConflictDetection="CompareAllValues" 
    ConnectionString="<%$ ConnectionStrings:tcc_customersConnectionString %>" 
    DeleteCommand="DELETE FROM [Customers] WHERE [CustomerId] = @original_CustomerId AND [CustomerStatus] = @original_CustomerStatus AND [CustomerFirstName] = @original_CustomerFirstName AND [CustomerLastName] = @original_CustomerLastName AND [CompanyName] = @original_CompanyName AND [CustomerEmail] = @original_CustomerEmail AND [CustomerType] = @original_CustomerType AND [CustomerPhoneNumber] = @original_CustomerPhoneNumber AND [CustomerSubscriptionType] = @original_CustomerSubscriptionType AND [CustomerPaymentMethod] = @original_CustomerPaymentMethod AND [CustomerPickUpDay] = @original_CustomerPickUpDay AND [CustomerPickUpDay2] = @original_CustomerPickUpDay2" 
    InsertCommand="INSERT INTO [Customers] ([CustomerStatus], [CustomerFirstName], [CustomerLastName], [CompanyName], [CustomerEmail], [CustomerType], [CustomerPhoneNumber], [CustomerSubscriptionType], [CustomerPaymentMethod], [CustomerPickUpDay], [CustomerPickUpDay2]) VALUES (@CustomerStatus, @CustomerFirstName, @CustomerLastName, @CompanyName, @CustomerEmail, @CustomerType, @CustomerPhoneNumber, @CustomerSubscriptionType, @CustomerPaymentMethod, @CustomerPickUpDay, @CustomerPickUpDay2)" 
    OldValuesParameterFormatString="original_{0}" 
    SelectCommand="SELECT [CustomerId], [CustomerStatus], [CustomerFirstName], [CustomerLastName], [CompanyName], [CustomerEmail], [CustomerType], [CustomerPhoneNumber], [CustomerSubscriptionType], [CustomerPaymentMethod], [CustomerPickUpDay], [CustomerPickUpDay2] FROM [Customers] ORDER BY [CustomerLastName], [CustomerFirstName], [CustomerId]" 
    UpdateCommand="UPDATE [Customers] SET [CustomerStatus] = @CustomerStatus, [CustomerFirstName] = @CustomerFirstName, [CustomerLastName] = @CustomerLastName, [CompanyName] = @CompanyName, [CustomerEmail] = @CustomerEmail, [CustomerType] = @CustomerType, [CustomerPhoneNumber] = @CustomerPhoneNumber, [CustomerSubscriptionType] = @CustomerSubscriptionType, [CustomerPaymentMethod] = @CustomerPaymentMethod, [CustomerPickUpDay] = @CustomerPickUpDay, [CustomerPickUpDay2] = @CustomerPickUpDay2 WHERE [CustomerId] = @original_CustomerId AND [CustomerStatus] = @original_CustomerStatus AND [CustomerFirstName] = @original_CustomerFirstName AND [CustomerLastName] = @original_CustomerLastName AND [CompanyName] = @original_CompanyName AND [CustomerEmail] = @original_CustomerEmail AND [CustomerType] = @original_CustomerType AND [CustomerPhoneNumber] = @original_CustomerPhoneNumber AND [CustomerSubscriptionType] = @original_CustomerSubscriptionType AND [CustomerPaymentMethod] = @original_CustomerPaymentMethod AND [CustomerPickUpDay] = @original_CustomerPickUpDay AND [CustomerPickUpDay2] = @original_CustomerPickUpDay2">
    <DeleteParameters>
        <asp:Parameter Name="original_CustomerId" Type="Int32" />
        <asp:Parameter Name="original_CustomerStatus" Type="String" />
        <asp:Parameter Name="original_CustomerFirstName" Type="String" />
        <asp:Parameter Name="original_CustomerLastName" Type="String" />
        <asp:Parameter Name="original_CompanyName" Type="String" />
        <asp:Parameter Name="original_CustomerEmail" Type="String" />
        <asp:Parameter Name="original_CustomerType" Type="String" />
        <asp:Parameter Name="original_CustomerPhoneNumber" Type="String" />
        <asp:Parameter Name="original_CustomerSubscriptionType" Type="String" />
        <asp:Parameter Name="original_CustomerPaymentMethod" Type="String" />
        <asp:Parameter Name="original_CustomerPickUpDay" Type="String" />
        <asp:Parameter Name="original_CustomerPickUpDay2" Type="String" />
    </DeleteParameters>
    <InsertParameters>
        <asp:Parameter Name="CustomerStatus" Type="String" />
        <asp:Parameter Name="CustomerFirstName" Type="String" />
        <asp:Parameter Name="CustomerLastName" Type="String" />
        <asp:Parameter Name="CompanyName" Type="String" />
        <asp:Parameter Name="CustomerEmail" Type="String" />
        <asp:Parameter Name="CustomerType" Type="String" />
        <asp:Parameter Name="CustomerPhoneNumber" Type="String" />
        <asp:Parameter Name="CustomerSubscriptionType" Type="String" />
        <asp:Parameter Name="CustomerPaymentMethod" Type="String" />
        <asp:Parameter Name="CustomerPickUpDay" Type="String" />
        <asp:Parameter Name="CustomerPickUpDay2" Type="String" />
    </InsertParameters>
    <UpdateParameters>
        <asp:Parameter Name="CustomerStatus" Type="String" />
        <asp:Parameter Name="CustomerFirstName" Type="String" />
        <asp:Parameter Name="CustomerLastName" Type="String" />
        <asp:Parameter Name="CompanyName" Type="String" />
        <asp:Parameter Name="CustomerEmail" Type="String" />
        <asp:Parameter Name="CustomerType" Type="String" />
        <asp:Parameter Name="CustomerPhoneNumber" Type="String" />
        <asp:Parameter Name="CustomerSubscriptionType" Type="String" />
        <asp:Parameter Name="CustomerPaymentMethod" Type="String" />
        <asp:Parameter Name="CustomerPickUpDay" Type="String" />
        <asp:Parameter Name="CustomerPickUpDay2" Type="String" />
        <asp:Parameter Name="original_CustomerId" Type="Int32" />
        <asp:Parameter Name="original_CustomerStatus" Type="String" />
        <asp:Parameter Name="original_CustomerFirstName" Type="String" />
        <asp:Parameter Name="original_CustomerLastName" Type="String" />
        <asp:Parameter Name="original_CompanyName" Type="String" />
        <asp:Parameter Name="original_CustomerEmail" Type="String" />
        <asp:Parameter Name="original_CustomerType" Type="String" />
        <asp:Parameter Name="original_CustomerPhoneNumber" Type="String" />
        <asp:Parameter Name="original_CustomerSubscriptionType" Type="String" />
        <asp:Parameter Name="original_CustomerPaymentMethod" Type="String" />
        <asp:Parameter Name="original_CustomerPickUpDay" Type="String" />
        <asp:Parameter Name="original_CustomerPickUpDay2" Type="String" />
    </UpdateParameters>
</asp:SqlDataSource> 
```

然后在我的代码隐藏文件中

```
 protected void ArchiveBeforeDelete(object sender, ListViewDeleteEventArgs e)
    {
        int listIndex = (int)e.ItemIndex;
    } 
```

这就是我所拥有的，它得到了索引。然后我尝试了@itsme86 建议的方法，但都无济于事......我真正想要的是CustomerID，这样我就可以从表中调用该特定ID，然后插入其他存档客户桌子...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:31:17.853

您应该将 CustomerId 放在“tr”标签上，这样您就可以在事件处理程序中将其取回。见下文...

```
<asp:ListView ID="ListView1" runat="server" DataKeyNames="CustomerId" 
DataSourceID="SqlDataSource1" OnItemDeleting= "ArchiveBeforeDelete">
<AlternatingItemTemplate>
    <tr id="<%# Eval("CustomerId") %>"
        style="background-color: #FAFAD2;color: #284775;">
        <td>
            <asp:Button ID="ArchiveButton" runat="server" CommandName="Delete"
                Text="Archive" />
            <asp:Button ID="EditButton" runat="server" CommandName="Edit" Text="Edit" />
        </td>
        <td>
            <asp:Label ID="CustomerIdLabel" runat="server" 
                Text='<%# Eval("CustomerId") %>' />
        </td>
        <td>
            <asp:Label ID="CustomerStatusLabel" runat="server" 
                Text='<%# Eval("CustomerStatus") %>' />
        </td>
etc. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T05:56:43.937

因此，正如我在之前的评论中所建议的，可以在 .aspx 页面中编辑 DeleteCommand，如下所示：

```
INSERT INTO ArchivedCustomers SELECT CustomerStatus, CustomerGroup, CustomerFirstName, CustomerLastName, CompanyName, CustomerAddress, CustomerCity, CustomerState, CustomerZipcode, CustomerEmail, CustomerEmail2, CustomerPhoneNumber, CustomerPhoneNumberExt, CustomerType, CustomerSubscriptionType, CustomerCost, CustomerPaymentMethod, CustomerSignUpDate, CustomerPickUpDay, CustomerPickUpDay2, CustomerNotes FROM Customers WHERE CustomerID = @original_CustomerID; DELETE FROM Customers WHERE CustomerId = @original_CustomerId" 
```

如您所见，首先将其插入到 ArchivedCustomers 表中，然后在我完成后将其删除。不过需要注意的一件事是，我必须将属性 ConflictDetection 从 CompareAllValues 更改为 OverwriteChanges 以停止出现错误。如果有人愿意解释，请做，但现在我只关心它的工作原理！:) 非常感谢@Jake1164，如果您没有让我发布该代码，我认为我不会像我一样快速地看到编辑该命令的能力。

# mysql - Jython 连接到 mysql，找不到驱动程序错误

> ID：11218358
> 
> 赞同：1
> 
> 时间：2012-06-27T01:54:18.643
> 
> 标签：mysql, driver, jython

我正在尝试将 Jython 与 mysql 连接。我下载了“zxJDBC.jar”、“mm.mysql-2.0.4-bin.jar”和“mysql-connector-java-5.1.20-bin.jar”，并将它们的路径设置为CLASSPATH。

在我的 Jython 脚本中，两者

```
$from com.ziclix.python.sql import zxJDBC
$from org.gjt.mm.mysql import Driver 
```

通过了。

但当

```
$conn = zxJDBC.connect("jdbc:mysql://localhost/automobile2", "root", "nihaonlp", "org.gjt.mm.mysql.Driver") 
```

翻译告诉我

```
$zxJDBC.DatabaseError: driver [org.gjt.mm.mysql.Driver] not found 
```

如何解决？

H

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T20:23:32.567

看看这里：

[http://glasblog.1durch0.de/?p=846](http://glasblog.1durch0.de/?p=846)

基本上，这个技巧将使用[ClassLoader](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html)加载您的类，以便您可以从 jython 使用它

[http://www.jython.org/jythonbook/en/1.0/appendixB.html#using-the-classpath-steve-langer](http://www.jython.org/jythonbook/en/1.0/appendixB.html#using-the-classpath-steve-langer)

我建议稍微修改一下脚本：

```
class classPathHacker:
    ##########################################################
    # from http://forum.java.sun.com/thread.jspa?threadID=300557
    #
    # Author: SG Langer Jan 2007 translated the above Java to this
    #       Jython class
    # Modified 2012 by Malte Vesper
    # Purpose: Allow runtime additions of new Class/jars either from
    #       local files or URL
    ######################################################
    import java.lang.reflect.Method
    import java.io.File
    import java.net.URL
    import java.net.URLClassLoader
    import jarray

    def addFile (self, path):
        #############################################
        # Purpose: If adding a file/jar call this first
        #       with path = path_to_jar
        #############################################

        return self.addURL (self.java.io.File (path).toUrl())

    def addURL (self, url):
        ##################################
        # Purpose: Call this with u= URL for
        #       the new Class/jar to be loaded
        #################################

        parameters = self.jarray.array([self.java.net.URL], self.java.lang.Class)
        sysloader =  self.java.lang.ClassLoader.getSystemClassLoader()
        sysclass = self.java.net.URLClassLoader
        method = sysclass.getDeclaredMethod("addURL", parameters)
        jar_a = self.jarray.array([url], self.java.lang.Object)
        method.invoke(sysloader, jar_a)
        return url 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-17T09:45:03.493

我来到这里寻找相同错误的解决方案。问题是我在 Eclipse Luna plus pydev + jython 中运行。从我在其他地方读到的内容来看，IDE 忽略了类路径环境变量，这被认为是缺乏可移植性的不好做法。

无论如何，eclipse/pydev 对于初学者来说相当繁重，我花了一些时间来找出解决方案，我想分享一下。

因此，在安装驱动程序后，它可以去任何地方，但当前的 Windows 版本有一个 msi 安装程序，它将把它放在 Program Files (x86)\Mysql 下。

在 Eclipse 中，转到 Window->Prefences->PyDev->Interpreters->Jython Interpreter。

在这里，查找面板库（通常默认打开）并选择 New Jar 按钮。浏览以找到已安装驱动程序的 jar 并选择它。这应该将 jar 添加到列表中，然后将在运行时找到驱动程序。

# android - 触摸特定图像时放大更近的图片

> ID：11218361
> 
> 赞同：1
> 
> 时间：2012-06-27T01:54:32.527
> 
> 标签：android, android-layout, android-intent, android-widget, android-ndk

在此先感谢。我正在做一个类似于 Coverflow 示例的应用程序。它看起来像这样。

[http://www.somesoundswelike.com/wp-content/CoverFlowScreenSnapz001.jpg](http://www.somesoundswelike.com/wp-content/CoverFlowScreenSnapz001.jpg)。当特定图像

单击后，该图像应放大并全屏查看。请指导我

如何进行..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T13:21:32.033

使用 gl_Position 进行缩放并使用 MvpMatrix 进行构图并创建看起来像放大和缩小的远近效果。我想你可以继续

您可以继续使用此[代码](http://www.khronos.org/assets/uploads/books/openglr_es_20_programming_guide_sample.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:00:48.233

看起来您可能会使用 openGL-es 进行放大/缩小和滑动。因此，您要做的是将图像作为纹理绘制到表面上并操纵表面大小和距离。

# sql-server-2005 - 带有批处理脚本的 SQL Server 查询

> ID：11218363
> 
> 赞同：2
> 
> 时间：2012-06-27T01:54:39.923
> 
> 标签：sql-server-2005, batch-file

我需要在我的 Windows SQL Server 2005 上执行这个 sql 查询，我可以使用批处理脚本来执行此操作吗？

sql查询

```
UPDATE VI_CURR_INFO SET 
    ends_days = '2005', 
    check_code = '1', 
    memb_name = '123132', 
    memb_guid = '1', 
    sno__numb = '1', 
    Bill_Section = '6', 
    Bill_Value = '3', 
    Bill_Hour = '6', 
    Surplus_Point = '6', 
    Increase_Days = '0' 
```

数据库名称是“test1”。如何执行批处理脚本来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:10:08.583

创建一个如下所示的脚本文件：

```
use test1
go

UPDATE VI_CURR_INFO
SET ends_days = '2005', 
    check_code = '1', 
    memb_name = '123132', 
    memb_guid = '1', 
    sno__numb = '1', 
    Bill_Section = '6', 
    Bill_Value = '3', 
    Bill_Hour = '6', 
    Surplus_Point = '6', 
    Increase_Days = '0' 
```

将此保存为脚本文件（`Script1.sql`例如）。然后使用 SQLCMD 对实例运行脚本：

```
sqlcmd -S YourServerName[\YourInstanceName] -i C:\YourScriptFileDir\Script1.sql 
```

# javascript - “this”在引用另一个对象的函数时在 javascript 中丢失

> ID：11218369
> 
> 赞同：3
> 
> 时间：2012-06-27T01:55:59.960
> 
> 标签：javascript, window, this

> **可能重复：**
> [JavaScript 丢失带有私有/公共属性的“this”对象引用](https://stackoverflow.com/questions/3322417/javascript-losing-this-object-reference-with-private-public-properties)

为什么第二个警报显示窗口对象，而不是 O（甚至 P）对象？

```
window.name = "test window";

O = {
    name : 'object O',
    f : function() {
        alert(this.name); // 2nd alert
    }
}

P = {
    name : 'object P',
    f : function() {
        alert(this); // 1st alert
        var of = O.f;
        of();
    }
}

P.f(); 
```

换句话说，直接调用对象的函数怎么能在窗口的上下文中呢？我想这是一个关闭的问题，但我不知道切换发生在哪里。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:01:15.657

当你这样做时：

```
var of = O.f;
of(); 
```

你`this`在这里被破坏了，因为`this`它并没有真正锁定在 JavaScript 中。它非常具有延展性，在你的情况下，你可以做一些事情来让它更好地工作。

您可以执行以下任何操作来正确绑定它：

```
var of = O.f.bind(this);
of(); 
```

或者

```
var of = O.f
of.call(this); 
```

要不就

```
O.f.call(this); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:06:02.417

如果你想保持范围`O`然后试试这个

```
window.name = "test window";

O = {
    name : 'object O',
    f : function() {
        alert(this.name); // 2nd alert
    }
}

P = {
    name : 'object P',
    f : function() {
        alert(this.name); // 1st alert
        var of = O.f;
        of(); // loses scope since this.of does not exist it calls using anonymous window scope
        of.call(O); // passes O as scope
        of.call(P); // passes P as scope

        this.of = O.f;
        this.of(); // maintains current P scope

    }
}

P.f();​ 
```

这是一个小提琴：http: [//jsfiddle.net/QVSDA/](http://jsfiddle.net/QVSDA/)

# java - EclipseLink 延迟加载挂在引用类上

> ID：11218379
> 
> 赞同：1
> 
> 时间：2012-06-27T01:57:09.433
> 
> 标签：java, jpa, eclipselink, lazy-loading

我正在尝试查询`a person by id`，并且在下面的架构中，我在人和学校之间有一个`@OneToMany`参考`Address`和`Person`一个参考。`ManyToOne`我使用命名查询和查询提示来获得这个简单任务的最佳性能查询，但是查看堆栈跟踪（发布的相关部分），当我想要的只是 id 的人员对象时，EclipseLink 会生成三个 Select 语句？使用急切获取会降低性能，所以我的问题是如何简单地使用 JPQL 创建一个查询，该查询通过 ID 获取一个人对象而不引用其他类？

```
@NamedQuery(
        name="findPersonById",
        query="SELECT p FROM Person as p  WHERE p.id = :id",
                hints={@QueryHint(name="eclipselink.batch.type", value="JOIN"),
                @QueryHint(name="eclipselink.batch", value="p.address")
                }
)
public class Person {

    @Id
    @TableGenerator(name = "TABLE_GEN", table = "PERSON_SEQUENCE_TABLE", pkColumnName = "SEQ_NAME", valueColumnName = "SEQ_COUNT", pkColumnValue = "PER_SEQ", allocationSize = 1, initialValue = 10000)
    @GeneratedValue(strategy = GenerationType.TABLE, generator = "TABLE_GEN")
    @Column(name = "personID")
    private Long id;

    @ManyToOne(cascade = CascadeType.PERSIST,fetch = FetchType.LAZY)
    @JoinColumn(name = "addressID")
    private Address address;

    @ManyToOne(cascade = CascadeType.PERSIST, fetch = FetchType.LAZY)
    @JoinColumn(name = "schoolID")
    private School school;

} 
```

地址实体

```
public class Address {

    @Id
    @TableGenerator(name = "ADDRESS_TABLE_GEN", table = "ADDRESS_SEQUENCE_TABLE", pkColumnName = "SEQ_NAME", valueColumnName = "SEQ_COUNT", pkColumnValue = "ADDR_SEQ", allocationSize = 1, initialValue = 1)
    @GeneratedValue(strategy = GenerationType.TABLE, generator = "ADDRESS_TABLE_GEN")
    @Column(name = "addressID")
    private Long id;

    @OneToMany(cascade = CascadeType.ALL, mappedBy = "address")
    private Set<Person> persons = new HashSet<Person>(); 
```

命名查询实现

```
public Person getPersonQueryBatch(Long id){

    EntityManager entityManager = factory.createEntityManager();
    Person person = null;

    try {

         List<Person> results = entityManager.createNamedQuery("findPersonById")
        .setParameter("id", id)
        .getResultList();
        if(!results.isEmpty()){
            // ignores multiple results
            person = results.get(0);
        }
    } catch (NoResultException e) {
        e.printStackTrace();
    }

    entityManager.close();
    return person;

} 
```

堆栈跟踪：它搜索`addressID`等于 1 的最后一位正在挂起

```
[EL Finest]: jpa: 2012-06-26 20:47:29.78--ServerSession(1259621282)--Thread(Thread[main,5,main])--Begin deploying Persistence Unit persistenceUnit; session file:/Users/warz07/Documents/workspace-sts-2.8.0.RELEASE/dugsimanager/target/classes/_persistenceUnit; state Deployed; factoryCount 2
[EL Finest]: jpa: 2012-06-26 20:47:29.781--ServerSession(1259621282)--Thread(Thread[main,5,main])--End deploying Persistence Unit persistenceUnit; session file:/Users/warz07/Documents/workspace-sts-2.8.0.RELEASE/dugsimanager/target/classes/_persistenceUnit; state Deployed; factoryCount 2
[EL Finer]: connection: 2012-06-26 20:47:29.787--ServerSession(1259621282)--Thread(Thread[main,5,main])--client acquired: 67158058
[EL Finer]: transaction: 2012-06-26 20:47:29.788--ClientSession(67158058)--Thread(Thread[main,5,main])--acquire unit of work: 1296566131
[EL Finest]: query: 2012-06-26 20:47:29.788--UnitOfWork(1296566131)--Thread(Thread[main,5,main])--Execute query ReadObjectQuery(name="findPersonById" referenceClass=Person sql="SELECT personID, TYPE, DATEADDED, FIRSTNAME, LASTNAME, MIDDLENAME, ACTIVE, BIRTHDAY, EMAILADDRESS, GENDER, IMAGEPATH, MARITAL, PRIMARYTELEPHONE, SECONDARYTELEPHONE, version, addressID, schoolID, ETHNICITY, HISPANIC, MAJOR, NATIVELANGUAGE, RELIGIOUSAFFILIATION, studentId FROM PERSON WHERE (personID = ?)")
[EL Finest]: connection: 2012-06-26 20:47:29.789--ServerSession(1259621282)--Connection(65769329)--Thread(Thread[main,5,main])--Connection acquired from connection pool [read].
[EL Finest]: connection: 2012-06-26 20:47:29.789--ServerSession(1259621282)--Thread(Thread[main,5,main])--reconnecting to external connection pool
[EL Fine]: sql: 2012-06-26 20:47:29.79--ServerSession(1259621282)--Connection(1578517945)--Thread(Thread[main,5,main])--SELECT personID, TYPE, DATEADDED, FIRSTNAME, LASTNAME, MIDDLENAME, ACTIVE, BIRTHDAY, EMAILADDRESS, GENDER, IMAGEPATH, MARITAL, PRIMARYTELEPHONE, SECONDARYTELEPHONE, version, addressID, schoolID, ETHNICITY, HISPANIC, MAJOR, NATIVELANGUAGE, RELIGIOUSAFFILIATION, studentId FROM PERSON WHERE (personID = ?)
    bind => [10000]
[EL Finest]: connection: 2012-06-26 20:47:29.798--ServerSession(1259621282)--Connection(65769329)--Thread(Thread[main,5,main])--Connection released to connection pool [read].
2012-06-26 20:47:29,802 [main] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.Student': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.Person.entityManager
2012-06-26 20:47:29,803 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
[EL Finest]: query: 2012-06-26 20:47:29.821--ServerSession(1259621282)--Thread(Thread[main,5,main])--Execute query ReadAllQuery(name="address" referenceClass=Address sql="SELECT DISTINCT t0.addressID, t0.CITY, t0.COUNTRY, t0.STATE_US, t0.STREETADDRESS, t0.STREETADDRESS2, t0.version, t0.ZIPCODE FROM ADDRESS t0, PERSON t1 WHERE ((t0.addressID = t1.addressID) AND (t1.personID = ?))")
[EL Finest]: connection: 2012-06-26 20:47:29.821--ServerSession(1259621282)--Connection(420965983)--Thread(Thread[main,5,main])--Connection acquired from connection pool [read].
[EL Finest]: connection: 2012-06-26 20:47:29.821--ServerSession(1259621282)--Thread(Thread[main,5,main])--reconnecting to external connection pool
[EL Fine]: sql: 2012-06-26 20:47:29.822--ServerSession(1259621282)--Connection(1364143063)--Thread(Thread[main,5,main])--SELECT DISTINCT t0.addressID, t0.CITY, t0.COUNTRY, t0.STATE_US, t0.STREETADDRESS, t0.STREETADDRESS2, t0.version, t0.ZIPCODE FROM ADDRESS t0, PERSON t1 WHERE ((t0.addressID = t1.addressID) AND (t1.personID = ?))
    bind => [10000]
[EL Finest]: connection: 2012-06-26 20:47:29.825--ServerSession(1259621282)--Connection(420965983)--Thread(Thread[main,5,main])--Connection released to connection pool [read].
2012-06-26 20:47:29,826 [main] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.Address': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.Address.entityManager
2012-06-26 20:47:29,827 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
2012-06-26 20:47:29,830 [main] DEBUG org.springframework.beans.factory.annotation.InjectionMetadata - Processing injected method of bean 'org.bixin.dugsi.domain.Student': PersistenceElement for transient javax.persistence.EntityManager org.bixin.dugsi.domain.Person.entityManager
2012-06-26 20:47:29,831 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Returning cached instance of singleton bean 'entityManagerFactory'
[EL Finest]: transaction: 2012-06-26 20:47:29.832--UnitOfWork(1296566131)--Thread(Thread[main,5,main])--[EL Finest]: query: 2012-06-26 20:47:29.844--ServerSession(1259621282)--Thread(Thread[main,5,main])--Execute query ReadAllQuery(name="persons" referenceClass=Person )
[EL Finest]: connection: 2012-06-26 20:47:29.845--ServerSession(1259621282)--Connection(36219749)--Thread(Thread[main,5,main])--Connection acquired from connection pool [read].
[EL Finest]: connection: 2012-06-26 20:47:29.845--ServerSession(1259621282)--Thread(Thread[main,5,main])--reconnecting to external connection pool
[EL Fine]: sql: 2012-06-26 20:47:29.845--ServerSession(1259621282)--Connection(1007449342)--Thread(Thread[main,5,main])--SELECT personID, TYPE, DATEADDED, FIRSTNAME, LASTNAME, MIDDLENAME, ACTIVE, BIRTHDAY, EMAILADDRESS, GENDER, IMAGEPATH, MARITAL, PRIMARYTELEPHONE, SECONDARYTELEPHONE, version, addressID, schoolID, ETHNICITY, HISPANIC, MAJOR, NATIVELANGUAGE, RELIGIOUSAFFILIATION, studentId FROM PERSON WHERE (addressID = ?)
    bind => [1] 
```

运行查询的测试用例

```
public void testSavingPersonSchool(){

        PersonService personService = new PersonService();
        System.out.println("here\n");
        Person cPerson = personService.getPersonQueryBatch(Long.valueOf("10000"));
        System.out.println("not here\n");
        School school = new School();
        Address address = new Address();
        address.setStreetAddress("eer street");
        address.setCity("hiokins");
        address.setZipCode("34343");
        address.setState_us("MN");
        address.setCountry("usa");

        school.setName("Maui");
        school.setDescription("Thinking of dropping a summer class?");
        school.setAddress(address);
        school.setPrimaryPhone("3242342342");
        school.setAdmissionsPhone("3242342342");
        school.setAdmissionsEmailAddress("ads@d.com");
        school.setActive(true);
        cPerson.setSchool(school);
        school.persist(); 
```

学生.java

```
package org.bixin.dugsi.domain;

import java.util.HashSet;
import java.util.Set;
import javax.persistence.Basic;
import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.DiscriminatorValue;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.OneToMany;
import javax.persistence.PostPersist;
import javax.validation.constraints.NotNull;
import org.eclipse.persistence.annotations.BatchFetch;
import org.eclipse.persistence.annotations.BatchFetchType;
import org.eclipse.persistence.annotations.JoinFetch;
import org.eclipse.persistence.annotations.JoinFetchType;
import org.springframework.roo.addon.javabean.RooJavaBean;
import org.springframework.roo.addon.jpa.activerecord.RooJpaActiveRecord;
import org.springframework.roo.addon.tostring.RooToString;

@RooJavaBean
@RooToString
@RooJpaActiveRecord
@DiscriminatorValue("S")
public class Student extends Person {

    @Basic
    @Column(name = "studentId")
    private String studentIdentifier;

    @OneToMany(cascade = CascadeType.ALL, mappedBy = "student", fetch = FetchType.LAZY)
    private Set<Registration> registrations = new HashSet<Registration>();

    @PostPersist
    public void generateCode() {
        studentIdentifier = ("S-000-");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:35:24.480

从这些行：

> 2012-06-26 20:47:29,802 [main] 调试 org.springframework.beans.factory.annotation.InjectionMetadata - 处理 bean 'org.bixin.dugsi.domain.Student' 的注入方法：瞬态 javax.persistence 的 PersistenceElement。 EntityManager org.bixin.dugsi.domain.Person.entityManager

您似乎正在对实体类进行一些注入。需要查看实体的完整来源才能确定。尽管如此，如果你这样做..好吧..不要:)在*每个*实体上创建spring代理或执行DI是一种过大的杀伤力，也几乎肯定会破坏整个惰性初始化，因为Spring将在执行DI时访问ManyToOne集合，也为这些实体触发数据库加载。

*作为旁注：您的实体不应包含业务逻辑，因此没有理由对它们进行任何依赖注入。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T12:56:47.753

With the fetch set to LAZY access to the Person should not trigger queries to the address or school. Do you have weaving enabled (using agent or Java EE/Spring weaving)? You may need to enable dynamic weaving or use static weaving.

It may be something else is triggering the relationships, you could put a breakpoint, or dump the stack trace (using a SessionEvent) in the EclipseLink Session query execution.

Your batch fetch on the address does not make sense, batch fetching is for when the query returns many results, but you are finding by id. You could use a join fetch (in the JPQL or through the join fetch hint).

I'm not sure how this could hang, break the process to get the stack trace to see what it is waiting on.

# javascript - 为按钮动态添加点击功能

> ID：11218380
> 
> 赞同：0
> 
> 时间：2012-06-27T01:57:29.560
> 
> 标签：javascript, jquery, html

我在表上有一个删除按钮，在单击事件监听器上有一个 jquery 按钮。这是代码

```
$(".delbtn").click(function () { 
    var count = 0;
    var $row = jQuery(this).closest('tr'); 
    var $columns = $row.find('td'); 

    var values = ""; 

    jQuery.each($columns, function(i, item) { 
        if( count == 0 ){delFund = item.innerHTML}
        if( count == 1) {delOrg  = item.innerHTML}
        if( count == 2) {stat = item.innerHTML }    
        count++
    }); 

//the below lines of codes would display how to show values on a browser like 
// firefox or chrome.
//console.log(delFund, delOrg);

    $(this).closest("tr").fadeTo(500, 0, function () {  
        $(this).remove(); 
    }); 

//update the item on the database table for deletion.
  $.ajax({type: "POST",
          url: "dbfunctions.jsp",  
          data: {TYPE:'D', fundval: delFund, orgval: delOrg, tuidval:tuid, status:stat }}).done(function( msg )
          {  
            //alert(msg);
          });

}); 
```

这一切都很好，我的问题是我查询了一个数据库，然后我用这个数据更新了 html 表，并在表的最后一行添加了一个新按钮。但是，当我单击它时，该按钮没有响应。我相信是因为没有附加事件侦听器。所以我的问题是如何更新按钮，以便我已经添加到所有先前按钮的事件侦听器也附加到新的动态生成按钮？

这是我如何将项目添加到表格末尾的代码片段。

```
$("#thisTable > tbody").append( 
                                        "<tr><td>"+thisfund.value+"</td>"+
                                        "<td>"+thisorg.value+"</td>"+
                                        "<td>"+'PENDING ACCESS'+"</td>" +
                                        "<td>"+"<a class='delbtn' href='#'>X</a>"+"</td></tr>");
        thisfund.value = "";// set the input boxes back to null
            thisorg.value  = "";

          }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:06:49.577

.delbtn 上的单击事件不是实时事件，不会应用于新附加的元素。

根据您使用的 JQuery 版本，您可以使用以下方法之一来添加实时事件。

```
$(selector).live(events, data, handler);                // jQuery 1.3+
$(document).delegate(selector, events, data, handler);  // jQuery 1.4.3+
$(document).on(events, selector, data, handler);        // jQuery 1.7+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:02:31.553

试试这个人：

接口：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

.on() 方法将事件处理程序附加到 jQuery 对象中当前选定的元素集。

任何事件名称都可用于 events 参数。jQuery 会通过浏览器的标准 JavaScript 事件类型，在浏览器由于点击等用户动作产生事件时调用处理函数。

在您的情况下，即使带有事件的新 tr`class='delbtn'`将`.on`接管它。

希望这可以帮助，

**代码**

```
$(document).on('click','.delbtn',function () { 
    var count = 0;
    var $row = jQuery(this).closest('tr'); 
    var $columns = $row.find('td'); 

    var values = ""; 

    jQuery.each($columns, function(i, item) { 
        if( count == 0 ){delFund = item.innerHTML}
        if( count == 1) {delOrg  = item.innerHTML}
        if( count == 2) {stat = item.innerHTML }    
        count++
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:03:29.457

试试这个

```
$(newButton).bind('click',function(){...}) 
```

# java - 是否使用 switch 语句中的所有情况...？

> ID：11218382
> 
> 赞同：1
> 
> 时间：2012-06-27T01:57:45.910
> 
> 标签：java

您好，我正在使用 Bukkit 为游戏 minecraft 编写插件。基本上，当玩家右键单击鸡蛋时，该鸡蛋具有特定的耐久度。持久性根本不会改变，因为每次有人这样做时都会调用该事件及其个人。我目前的代码还没有完成，但基本上就是这样：

```
if (e.getItem().getTypeId() == 383) {
        if (!worldguardPlugin.canBuild(e.getPlayer(), loc)) {
            e.setCancelled(true);
            e.getPlayer().sendMessage(
                    ChatColor.YELLOW
                            + "You cant use spawner eggs in this region!");
            return;
        }
        switch (e.getItem().getDurability()) {
        case 2:
            expOrb(e);
            break;
        case 9:
            painting(e);
            break;
        case 20:
            primedTnt(e);
            break;
        case 40:
            minecart(e);
            break;
        case 41:
            boat(e);
            break;
        case 50:
            creeper(e);
            break;
        case 51:
            skeleton(e);
            break;
        case 52:
            spider(e);
            break;
        case 53:
            giant(e);
            break;
        case 54:
            zombie(e);
            break;
        case 55:
            slime(e);
            break;
        case 56:
            ghast(e);
            break;
        case 57:
            pigman(e);
            break;
        case 58:
            enderman(e);
            break;
        case 59:
            cavespider(e);
            break;
        case 60:
            silverfish(e);
            break;
        case 61:
            blaze(e);
            break;
        case 62:
            cube(e);
            break;
        case 63:
            dragon(e);
            break;
        case 90:
            pig(e);
            break;
        case 91:
            sheep(e);
            break;
        case 92:
            cow(e);
            break;
        case 93:
            chicken(e);
            break;
        case 94:
            squid(e);
            break;
        case 95:
            wolf(e);
            break;
        case 96:
            moosh(e);
            break;
        case 97:
            snowGolem(e);
            break;
        case 98:
            ocelot(e);
            break;
        case 99:
            ironGolem(e);
            break;
        case 120:
            villager(e);
            break;
        case 200:
            crystal(e);
            break;
        default:
            break;
        }
    }
} 
```

由于我使用的是break，我所做的所有方法都不会被称为正确吗？这会导致大量无意义的代码被执行并浪费性能，而这个设计的全部目的是为了更好的工作流程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T01:59:45.707

你的假设是正确的。只有满足特定`switch`情况的代码才会被执行。毕竟，switch语句是一个巨大的`if-else if-else`块的替代品。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:10:33.007

在您的情况下，由于中断，只有与切换语句特别匹配的项目才会执行。如果没有休息，则将调用第一场比赛，然后是所有比赛。例如，代码：

```
System.out.println("starting");

int i = 2;
switch (i) {
    case 1:
        System.out.println(1);
    case 2:
        System.out.println(2);
    case 3:
        System.out.println(3);
}

System.out.println("finished"); 
```

产生以下输出：

```
starting
2
3
finished 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:06:55.950

效率低下是您需要检查所有案例的地方，除非您最终找到那些案例，例如在这种情况下为 200 个。您需要重新组织决策过程，使其至少在更频繁的情况下运行得更快。虽然 switch 语句是经过编译器优化的，但是如果要比较的东西太多的话，也做不了什么。

从 switch 语句的角度来看，你是对的：如果它到达 break 语句，它就会短路。

# meteor - 如何从 Meteor Spacebars #with Template Helper 访问文档字段？

> ID：11218391
> 
> 赞同：0
> 
> 时间：2012-06-27T01:59:25.660
> 
> 标签：meteor, coffeescript, spacebars

此代码应显示文档字段 first_name 和 last_name，而不是生成“未捕获错误：未知帮助器 'first_name'”错误：

```
# In Template.
{{#with doc}}
<p>{{first_name}} {{last_name}}</p>
{{/with}}

# Template 'doc' property.
_.extend Template.doc,
  doc: -> Docs.findOne {_id: Session.get 'doc_id'} 
```

如果我用 #each 和 find() 替换 #with 和 findOne() 它可以正常工作：

```
# In Template.
{{#each doc}}
<p>{{first_name}} {{last_name}}</p>
{{/each}}

# Template 'doc' property.
_.extend Template.doc,
  doc: -> Docs.find {_id: Session.get 'doc_id'} 
```

这篇文章建议#with 应该工作[将返回单个对象的流星方法转换为车把的上下文](https://stackoverflow.com/questions/10160455/turn-a-meteor-method-returning-a-single-object-into-a-context-for-handlebar)

我正在使用流星 0.3.7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T16:09:36.587

`doc`需要成为结果中的关键（请原谅我的 js，我已将其转换为咖啡，我不知道如何直接在咖啡中那么好）。不过，最好只使用直接引用。

试试这个（使用 findOne）：

```
_.extend Template.doc,
doc: ->
doc: Docs.findOne(_id: Session.get("doc_id")) 
```

# python - django 将文件上传到自定义位置

> ID：11218393
> 
> 赞同：0
> 
> 时间：2012-06-27T01:59:30.027
> 
> 标签：python, django, django-file-upload

是否可以使用 django 将 django 中的文件上传到与 django`model.FileField()`不相关的位置`/media`？在我的情况下，将 .html 文件上传到`myproject/templates`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:56:04.053

如果我没记错的话，你不能，这种操作是不安全的。文件存储后端会警告它。
您可以自定义存储后端，也可以上传到类似目录`/media/user_template`并将其设置为`TEMPLATE_DIRS`.

如果您只想使用动态模板，请检查[django-dbtemplates](https://github.com/jezdez/django-dbtemplates)作为基于 DB 的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:09:54.390

尝试：`models.FileField(upload_to = '...')`

# php - php - switch 总是比很多 elseif 更好吗？

> ID：11218399
> 
> 赞同：1
> 
> 时间：2012-06-27T01:59:58.950
> 
> 标签：php, switch-statement, if-statement

我对php中的switch不是很熟悉，但是我听说如果你的代码有很多elseif，最好用switch来代替。我试图将下面的代码更改为 switch，但由于我在每个 elseif 处检查两个或三个值，因此使用 elseif 而不是 switch 对我来说似乎更合乎逻辑（也许我错了）。

所以我的问题是，你对下面的代码有什么建议？Elseif 还是 switch？

如果我想把代码改成switch，你能给我一些提示吗？

非常感谢您！

（顺便说一句，block_check 和 report_check 是复选框，reported_msg 是文本）

```
public function block_user(){
    if(isset($_POST['submitted'])){

        $block_check = $_POST['block_check'];
        $report_check = $_POST['report_check'];     
        $reported_msg = $_POST['reported_msg']);

        if((!($block_check)) && (!($report_check))){
            echo "dont send, both not checked";

        }elseif(($report_check) && ($reported_msg == '')){
            echo "dont send, msg box is empty";

        }elseif((!($report_check)) && ($reported_msg != '')){
            echo "dont send, report_check is not checked";

        }elseif(($block_check) && (!($report_check)) && ($reported_msg == '')){
            echo "just process block";

        }elseif((!($block_check)) && ($report_check) && ($reported_msg != '')){
            echo "just process report";

        }elseif(($block_check) && ($report_check) && ($reported_msg != '')){
            echo "process both block and report";
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T02:06:44.313

Switch 在某些情况下非常好，但在其他情况下却非常糟糕。在您的具体情况下，我会使用 if/elseif 条件。

我`switch`在条件简单且表达式简单时使用。如果条件有多个变量并且表达式长于大约三行，我不会使用开关。

这是一个好的开关的好例子：

```
switch ( $type ) {
    case 'banana': 
        $valid = true;
        $price = 1;
        break;
     case 'apple': 
        $valid = false;
        $price = 2.52;
        break;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:28:12.833

老实说，这在很大程度上是关于可读性和品味的。我更喜欢 elseif 语句，因为如果条件变得更复杂，它可以提供更大的灵活性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T02:06:02.097

为了优化您的代码，您希望将最常用的`if`语句放在语句块的顶部`elseif`。否则，唯一的区别在于代码的可读性，这实际上是使用`switch`语句的一个重要原因。

# html - DIV 没有正确嵌套？

> ID：11218403
> 
> 赞同：0
> 
> 时间：2012-06-27T02:00:38.597
> 
> 标签：html, nested

在本页面，

[http://lumn.net/index.shtml](http://lumn.net/index.shtml)

我的 DIV 有一些我无法解释（或找到）的问题。“博客”应该嵌套在“焦点”中。结果，“焦点”应该伸展到“博客”的高度，并将蓝色条推到底部。然而，“focal”正在运行不足，显然默认为 440 像素的最小高度，尽管“博客”要高得多。

它在我的其他页面上很好。我知道人们更喜欢问题包括代码，但我什至不确定问题出在我的 css 还是我的 html 中。1000 谢谢，如果你能帮我解决这个问题。我敢肯定这很简单，但我没有看到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:16:05.790

尝试将其放在“焦点”结束标记之前：

```
<div style="clear:both;"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:17:44.437

在您的“蓝色页脚”div 上使用以下 CSS：

```
clear: left; 
```

此 CSS 指定元素的哪些边不允许其他浮动元素。

# ruby-on-rails - Rails - HTTP 到 HTTPS（反之亦然）重定向添加额外参数

> ID：11218413
> 
> 赞同：1
> 
> 时间：2012-06-27T02:01:37.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, redirect

我正在使用 Sslrequirements.rb（并对其进行了修改以满足我的需要），现在当页面转到 HTTP 到 HTTPS 时，它会添加额外的参数。问题是如何保留正在传递的正确参数以及如何确保正在传递的控制器和操作名称不与 URL 一起使用。

当调用以下块时

```
redirect_to :protocol => "https://", :controller => controller_name.to_sym, :action => action_name.to_sym, :params => params 
```

使用这些参数调用注册页面。

```
https://mydomain.com/signup?account=free&action=new&controller=users 
```

如何摆脱调用的 URL `&action=new`。`controller=users`

我正在使用 Rails 3.2.6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:56:43.550

转换 to_sym 的行没有将字符串转换为

> '动作名称'

尝试删除控制器名称，以便您的代码看起来像这样

```
redirect_to :protocol => "https://", :action => 'action_name', :params => [params:id] 
```

根据[此处](http://api.rubyonrails.org/classes/ActionController/Redirecting.html)的 rails 文档，重定向将您的第二个参数视为 URL 的状态代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:57:11.477

这个怎么样...

```
redirect_to url_for params.merge({:protocol => 'https://'}).
  except(:controller_name, :action_name, ... ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T05:18:42.190

经过大量研究，我发现：

```
request.query_parameters 
```

这解决了这个问题。

# c# - C# 流读取器到文件

> ID：11218418
> 
> 赞同：1
> 
> 时间：2012-06-27T02:02:17.087
> 
> 标签：c#, .net, filestream, streamreader

> **可能重复：**
> [如何将流保存到文件？](https://stackoverflow.com/questions/411592/how-do-i-save-a-stream-to-a-file)

我想将数据从读取流写入 C# 中的文件。
如下所示：

```
StreamReader log = myexe.StandardOutput;

FileStream logfile = File.Create(LogFileName);

// write log to the logfile 
```

请有任何建议。

# python - 如何在bottlepy中安全地检查上传文件的大小？

> ID：11218422
> 
> 赞同：6
> 
> 时间：2012-06-27T02:03:02.647
> 
> 标签：python, bottle

我真的很害怕那个`read()`操作，因为它使用内存。例如，任何人都可以通过上传 1gb 文件对我的服务器进行 DDoS 攻击，对吗？

```
name = request.forms.get('name')
data = request.files.get('data')
if name and data.file:
    raw = data.file.read() # This is dangerous for big files
    filename = data.filename
    return "Hello %s! You uploaded %s (%d bytes)." % (name, filename, len(raw)) 
```

是否有任何安全的解决方案来获取上传的文件大小？一种猜测是从文件系统中获取文件大小；`request.files.get('data')`可能存储在临时文件中的某个地方吧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:29:20.237

你能检查一下你是否可以一次读取大块数据。

如果这是可能的，那么：

```
name = request.forms.get('name')
data = request.files.get('data')
raw = ""
if name and data.file:
    while True:
        datachunk = data.file.read(1024)
        if not datachunk:
            break
        raw = raw + datachunk

    filename = data.filename
    return "Hello %s! You uploaded %s (%d bytes)." % (name, filename, len(raw)) 
```

如果这是可能的，那么您应该还可以添加一个跟踪机制来跟踪您想要读取的文件大小，如果超出则中止此操作。

但是，这仅解决了 DDOS 的一种可能方式。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-27T02:55:23.607

这是个有趣的问题。通常，您要么获取文件对象的统计信息，要么使用 os.path 获取大小。[这个问题](https://stackoverflow.com/questions/2104080/how-to-check-file-size-in-python)之前已经讨论过了。

但是您问的是如何在我们花时间上传之前从服务器告诉客户端文件大小。我认为最好的方法是[使用 JavaScript](http://www.kavoir.com/2009/01/check-for-file-size-with-javascript-before-uploading.html)。[这个问题](https://stackoverflow.com/questions/6978603/how-to-load-a-javascript-or-css-file-into-a-bottlepy-template)可以让您开始了解如何将一些 JavaScript 代码放入您的 BottlePy 应用程序。

使用 JavaScript 验证您的输入，以便您可以在服务器代码中假设该文件在您的限制范围内。一旦你弄清楚了，我建议你让 BottlePy 人员直接将对此的支持添加到 BaseRequest.files 支持中。

# ios - 需要几秒钟来创建 UIView 和子视图是否正常？

> ID：11218425
> 
> 赞同：0
> 
> 时间：2012-06-27T02:03:13.877
> 
> 标签：ios, ios5, uiview

我有一个`UIViewController`动作，当被调用时，会创建（完全在代码中）a`UITableView`可能有 2 或 3 行（没什么花哨的），带有页眉和页脚，并使 2 或 3 简单`UILabels`。然后`UITableView`将其添加为 active 上主视图的子视图`UIViewController`。在模拟器上执行此操作并实际显示此 UITableView 大约需要 3 秒。

这是正常的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:23:34.920

不，这绝对不正常。您需要准确地隔离所有这些时间占用的内容。一种非常简单的方法是在代码中的不同位置添加 NSLog 调用，这样你就可以看到什么时候被调用了。这可能足以让你开始。

最终，您可能需要一些更复杂的时序代码来分析事物。为此，我使用了[此代码](http://wafflesoftware.net/machtimer/documentation.html)的变体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:24:11.937

没有。如果您分享您的代码，我们可能会帮助您弄清楚发生了什么。但是如果你只是及时响应[UITableViewDataSource](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UITableViewDataSource)协议中列出的方法，你应该不会有这样的问题：

*   [numberOfRowsInSection](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/numberOfRowsInSection%3a) ;
*   [numberOfSections](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/numberOfSections) ; 和
*   [cellForRowAtIndexPath](http://developer.apple.com/library/ios/documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/cellForRowAtIndexPath%3a)。

# codeigniter - Codeigniter：获取干净的 url 并删除 index.php

> ID：11218429
> 
> 赞同：0
> 
> 时间：2012-06-27T02:03:29.557
> 
> 标签：codeigniter, codeigniter-2

好吧，我不太确定你们如何使用 codeigniter 实现 mod_rewrite，我什至不确定我现在是否需要这样做。我想要的是摆脱根目录后面的 index.php ，所以从 www.mydomain.com/index.php/mycontroller 中删除它，只需要 www.mydomain.com/mycontroller/

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T21:50:48.077

除了上面每个人所说的关于.htaccess的内容之外，您还必须设置

```
$config['index_page'] = 'index.php'; 
```

到

```
$config['index_page'] = ''; 
```

在您的 /application/config/config.php 文件中

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:07:47.763

您可以通过修改 .htaccess 文件来隐藏 index.php。例如，

```
RewriteEngine on
RewriteCond $1 !^(index\.php|images|robots\.txt)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

您可以在此处找到有关 CodeIgniter URL 的更多信息：http: [//codeigniter.com/user_guide/general/urls.html](http://codeigniter.com/user_guide/general/urls.html)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-27T03:39:39.177

您可以将其放在 .htaccess 中以从 url 中删除 index.php

```
 #### Remove index.php ###
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /index.php?/$1 [L]
    #### index.php ### 
```

# events - MS Access 2007 表单加载事件未触发

> ID：11218430
> 
> 赞同：4
> 
> 时间：2012-06-27T02:03:48.737
> 
> 标签：events, ms-access, vba, onload-event

A2007 应用程序中的两个表单在 OnOpen 事件之后停止触发其**OnLoad**事件。这些事件已经运行了多年，我无法确定为什么 OnLoad 事件现在没有运行。

相反，单击窗体上的**任何**控件都会触发 OnLoad 事件 - 包括窗口的关闭按钮。

表单是未绑定的，子表单由 OnLoad 事件中调用的公共函数过滤。还有许多其他类似的形式，它们仍然可以正常工作。

我通过单击事件旁边的“属性”中的省略号（[事件过程]）检查了**该事件是否仍然链接到代码，这将我正确地带到代码。**

已反编译/重新编译。检查参考。导入到新数据库。

尝试添加一个 RecordSource (SELECT anyField FROM anyTable LIMIT 1)，但它不起作用，然后我找到了一种**解决**方法，方法是将 Me.RecordSource=Me.RecordSource 添加为 OnOpen 事件的最后一行 -*然后*触发OnLoad 事件。

这是我在 Access 开发近 20 年来第一次遇到这种情况，而且每当 Access 出现“行为不端”时我都会感到非常紧张，我真的很想找出问题所在。任何建议都将受到欢迎！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T01:25:55.357

我在开发的表单中遇到了同样的问题，但是我在 Open 事件中没有任何代码，但是突然我的 Load 事件代码在打开表单时停止运行。

在 Open 事件中添加“Me.RecordSource = Me.RecordSource”代码然后解决了问题？

我知道这不是答案，但它确实证明 Max 的代码不可能在 Open 事件中挂起。

唯一的其他重要信息是我正在两台 PC 上开发它，一台使用 Access 2007，另一台使用 2010，但我不记得在我将代码移回 Access 2007 PC 后 Load 事件是否停止运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-11T14:24:38.460

在 MS Access 2016 中遇到了相同症状的问题。但是添加“Me.RecordSource = Me.RecordSource”并没有帮助我，反而让情况变得更糟。

在成功尝试其他建议的解决方案并从头开始构建全新的表单后，我再次构建它，并在每一步检查它是否仍然有效之后。

结果表明，访问无法处理调用函数（带返回值）作为可选参数的默认值。（这适用于表单模块中定义的所有过程）

由于我对 VBA 和 Access 开发相当陌生，这可能是初学者的错误，但也许它可以帮助某人在这里发布它。

# php - 如何在php mysql中获取father_id中的所有产品

> ID：11218433
> 
> 赞同：2
> 
> 时间：2012-06-27T02:04:27.853
> 
> 标签：php, mysql

```
brand(id, parent_id, name)
      1 |     0    | Apple
      2 |     0    | Samsung
      3 |     1    | Iphone 3S
      4 |     1    | Iphone 4S
product(id, name)
        1 | OS
        2 | Andriod
product_brand(product_id, brand_id)
                  1     |    3
                  1     |    4 
```

和 mysql：如何获取`product name`何时`brand name = Apple`

```
SELECT * FROM product_brand
LEFT JOIN brand ON brand.id = product_brand.brand_id
WHERE brand.id = 1 // Apple 
```

例如：如果得到 Apple(id=1) 是结果 => 操作系统，如果得到三星(id=2) 是结果 => Andriod

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:18:19.137

如果您想获取未存储在 product_brand 中的 Apple 和 Samsung 的产品名称（请参见示例数据）。您可以按如下方式修复查询：

```
 SELECT *,
    CASE b.name WHEN 'Apple' THEN 'iOS'
    WHEN 'Samsung' THEN 'Android' ELSE '-' END  
   FROM
    brand b 
```

编辑2：如果要根据parent_id获取所有产品名称。可以试试下面的：

```
SELECT *,
    CASE b.name WHEN 'Apple' THEN 'iOS'
    WHEN 'Samsung' THEN 'Android' ELSE '-' END as type_of_os
FROM
    brand b 
WHERE parent_id=0
UNION
SELECT
    b.*,
    CASE b2.name WHEN 'Apple' THEN 'iOS'
    WHEN 'Samsung' THEN 'Android' ELSE '-' END as type_of_os
FROM
    brand b
INNER JOIN
    brand b2 ON b.parent_id = b2.id 
```

[http://sqlfiddle.com/#!2/1f573/18](http://sqlfiddle.com/#!2/1f573/18)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:10:07.403

尝试这个：

```
SELECT
  p.name
FORM product p
LEFT JOIN product_brand pb ON p.id = pb.product_id
LEFT JOIN brand b ON pb.brand_id = b.id
LEFT JOIN brand b1 ON b.id = b1.parent_id
WHERE b1.name = 'Apple' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T02:13:59.493

你的意思是像

```
SELECT
  childbrand,name AS child_brand_name
  product.name AS product_name
FROM brand AS childbrand
INNER JOIN brand AS parentbrand ON parentbrand.id=childbrand.parent_id
INNER JOIN product_brand ON product_brand.brand_id=childbrand.id
INNER JOIN product ON product_brand.product_id=product.id
WHERE parentbrand.name='Apple'; 
```

# delphi - 如何查看 OutputDebugString 的输出？

> ID：11218434
> 
> 赞同：12
> 
> 时间：2012-06-27T02:04:56.737
> 
> 标签：delphi, debugview, outputdebugstring

我想`OutputDebugString()`在我的应用程序中使用，然后可以选择在现场部署应用程序时在单独的查看器中显示它。

也就是说，我不想更改标志并重建我的 .exe 来打开和关闭调试。

谷歌搜索，似乎[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)应该处理这个问题，但它和[TraceTool](http://www.codeproject.com/Articles/5498/TraceTool-12-4-The-Swiss-Army-Knife-of-Trace)都没有显示此代码的任何输出。

```
unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;

type
  TForm1 = class(TForm)
    procedure FormCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender: TObject);
begin
   OutputDebugString(PChar('Hello, wurld'));
end;

end. 
```

我已阅读文档，但无济于事，并且看到其他人也遇到过类似的问题，但尚未发布解决方案。

有解决办法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-27T02:16:34.217

该[`DebugView`](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)工具工作正常；只需确保直接启动您的应用程序（不附加 Delphi IDE 或其他调试器）。

无论如何，查看 Delphi 应用程序的[OutputDebugString](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363362%28v=vs.85%29.aspx)输出的自然方法是使用 Delphi IDE 和`Event Log`Window。

![在此处输入图像描述](../Images/ec8140a7497c5dad948ef653bdd6718a.png)

![在此处输入图像描述](../Images/217634f4cbec0cd91b8c4fff8e940e9e.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-27T11:00:12.010

[GExperts](http://www.gexperts.org)有一个调试查看器和一个您添加到应用程序的单元，即使在 XE2 Starter 中也可以为您执行此操作。查看`DebugIntf`单元及其`GExpertsDebugWindow.exe`包含的应用程序。这些在 XE2 Starter（以及几乎所有其他版本的 Delphi）下工作。

GExperts 还包括大量其他很棒的 IDE 和编辑器增强功能，当然它们一直存在，因此它们是非常可靠的工具。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-27T06:11:36.473

CnWizards 包含一个工具 CnDebugViewer.exe，它可以捕获 OutputDebugString（应在 Windows 7 中以管理员身份运行）。

与 DbgView 不同，CnDebugViewer 可以为不同的应用程序创建单独的选项卡。

CnPack 包含一个单元，CnDebug.pas。使用该单元，您可以跟踪类型化对象、集合、异常、memdump 等。通过 CnDebug.pas，您还可以设置是否自动启动 CnDebugViewer、是否在发送调试消息时转储到文件等。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-27T12:23:06.127

使用 OutputDebugString 的一个问题是其他程序也可能在使用它，从而使您的日志变得混乱：[在 Delphi 中调试 OutputDebugString 调用](https://stackoverflow.com/questions/4258848/debugging-outputdebugstring-calls-in-delphi/4262268#4262268)。

您可以使用我们在日常使用中非常满意的 CodeSite Express：[http](http://www.raize.com/devtools/codesite/Default.asp) ://www.raize.com/devtools/codesite/Default.asp 。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-07-11T22:11:36.980

在我的 XE5 版本中，我必须在以下位置启用“输出消息”选项：

工具 > 选项 > 调试器选项 > 事件日志

我不记得禁用它。

# ajax - scala lift：如何提交ajaxbutton添加和删除

> ID：11218435
> 
> 赞同：0
> 
> 时间：2012-06-27T02:05:15.173
> 
> 标签：ajax, scala, submit, lift

我的编辑页面中有两个列表和保存按钮。

左边的列表是每行带有add的ajaxbutton的总区域列表，右边的列表是每行带有delete的ajaxbutton的选定区域列表。

操作如下：

1.  单击左侧列表的添加按钮时，所选区域将添加到右侧列表的末尾并显示。
2.  单击右侧列表的删除按钮时，将显示确认消息，如果单击确定，将从右侧列表中删除所选区域。
3.  单击保存按钮时，所选区域列表将保存到数据库中。

我的来源如下：

```
// Left list
def showTotalArea: CssBindFunc = {
    ".totalArea *" #> totalAreaList.map(values => 
        ".areaImage [src]" #> values(6) &
        ".areaName *" #> values(4) &
        ".areaComment *" #> values(5) &
        ".copy" #> ajaxButton(S.?("add"), () => doCopy(values(1), "new")) 
    )
}

// Right list
def liftForm(xhtml: NodeSeq): NodeSeq = {  
    var areaList = newOrderList.map(values =>{
        <li id={values(1)} class="items currentOrder">
            <table >
                <thead></thead>
                <tbody>
                    <tr>
                        <td class="listImage">
                            <img class="areaImage" src={values(6)}/>
                        </td>
                        <td >
                            <tr><p class="areaName">{values(4)}</p></tr>
                            <tr><p class="areaComment">{values(5)}</p></tr>
                        </td>
                        <td class="listCheck" >
                            {ajaxButton("delete", () => doConfirm(values(1)), "class" -> "button delete")}
                        </td>
                    </tr>       
                    <tr class = "auto">
                        <td></td>
                        <td class="listSelect" >
                            {
                            val it = ajaxRadio[String](radioList, Box.legacyNullTest(values(2)), doRadioChange(values(1), _)).toForm.grouped(4)
                            for(i <- it)yield(<tr>{i.flatMap(y => <td> {y} </td>)}</tr>)
                            }
                        </td>
                    </tr>                   
                </tbody>
            </table>
        </li>})
    areaList1 = areaList.toString   
    SHtml.ajaxForm(
    bind("list",xhtml,"areaList" -> <ul class="sortable">{areaList}</ul>)
    )
}

// save button
def showFormButton = {
    ".post" #> submit("save", doCompose) &
    ".cancel" #> submit("cancel", doCancel) &
    "#result" #> text("", result = _ )
}

// add button
def doCopy(areaId: String, areaType: String): JsCmd = {
    println("+++++++addArea: " + areaId)
    println("+++++++areaType: " + areaType)
    // check
    if (isExist(areaId)) {
        Alert("The selected area is already in the list.")
    } else {
    val addList = selectedList(totalAreaList, areaId)
    newOrderList = newOrderList:::List(addList)
    println("+++++++newOrderList: " + newOrderList)
    JsRaw("alert(’ButtonAdd clicked’);") &
    JsRaw("""$("liftForm").submit();""")            
    }
}

def selectedList(areaList: List[List[String]], areaId: String): List[String] = {
    var returnList: List[String] = Nil 
    areaList.map(values => 
        if (values(1) ==  areaId) {
            returnList = values
        }
    )
    return returnList
}

// delete button
def doConfirm(areaId: String): JsCmd = {
    Confirm("Are you sure to delete?", SHtml.ajaxInvoke(() => doDelete(areaId))._2.cmd)
}
def doDelete(areaId: String): JsCmd = {
    println("+++++++deleteArea: " + areaId)
    newOrderList.map(values => 
        if (values(1) ==  areaId) {
            newOrderList = newOrderList - values
        }
    )
    println("+++++++newOrderList: " + newOrderList)
    JsRaw("""$("liftForm").submit();""")            
}

// save button 
private def doCompose() {
    println("++++++newOrderList: " + newOrderList.toString)
    //save newOrderList to database
} 
```

我的问题是：

1.  单击添加按钮时，所选区域将添加到 newOrderlist 的末尾，但在单击保存按钮之前不会显示。
2.  单击删除按钮时，所选区域将从 newOrderList 中删除，但在单击保存按钮之前它不会从显示中消失。

我的问题是：

```
How to display the operation result without clicking save button? 
```

我已经阅读了一些关于 ajaxbutton 并提交的线程，但我不太理解。有没有什么简单的方法可以解决这个问题？

感谢您的任何建议

詹姆士

* * *

我曾尝试使用 JsCmds.SetHtml(theID, theContent)。但我不知道如何编辑第二个参数的“theContent”。因为在我的源代码中，它被定义为“def liftForm（xhtml：NodeSeq）：NodeSeq = {”并绑定到html。

如何调用绑定到 scala 的 html 的函数 liftForm？

谢谢詹姆斯W

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-01T15:58:57.597

我认为最好的解决方案可能是使用`JsCmds.SetHtml`（[doc](http://scala-tools.org/mvnsites/liftweb-2.4-M4/#net.liftweb.http.js.JsCmds%24%24SetHtml)）与新元素一起显示在`doCopy`方法中的 ID 处。蛮力方法只是用更新的表格替换完整的表格，但他们可能是这样做的更好方法。

因此，您主要必须在方法末尾添加：

```
& JsCmds.SetHtml(theID, theContent) 
```

我希望它有帮助

# haskell - 使用 foldr 和 bind 终止任何内容

> ID：11218436
> 
> 赞同：2
> 
> 时间：2012-06-27T02:05:18.130
> 
> 标签：haskell, functional-programming

所以，基本上我有一些单子函数包装在`MaybeT`我想`Nothing`用作递归的终止案例

我的理解`foldr`是，如果它可以在不消耗整个列表的情况下产生结果，那么它可以安全地用于无限列表，即`foldr (&&) True $ repeat False`仍然能够返回`False`。

目前我有：

```
repeaterM a f = foldr (=<<) (return a) $ repeat f 
```

这种类型检查，但实际上不起作用。谁能向我解释为什么我不能使用这个函数重复地将一个函数应用于它自己的结果，直到它返回`Nothing`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T02:35:41.547

```
foldr            :: (a -> b -> b) -> b -> [a] -> b
foldr k z = go
          where
            go []     = z
            go (y:ys) = y `k` go ys 
```

所以

```
foldr (&&) True $ repeat False
   = go (repeat False) where go [] = True ; go (y:ys) = y && go ys
   = False && go (repeat False) where go [] = True ; go (y:ys) = y && go ys
   = False 
```

如你所料。

但

```
foldr (=<<) (return a) $ repeat f
   = go (repeat f) where go [] = return a ; go (y:ys) = y =<< ys
   = f =<< go (repeat f) where go [] = return a ; go (y:ys) = y =<< ys
   = f =<< f =<< go (repeat f) where go [] = return a ; go (y:ys) = y =<< ys
   = f =<< f =<< f =<< go (repeat f) where go [] = return a ; go (y:ys) = y =<< ys
   ... 
```

您在这里所做的*不是*重复将函数应用于它自己的结果，直到它返回`Nothing`。

您正在从头开始构建计算：`=<<`必须先计算每个的 RHS，然后才能执行 LHS。但是你有一个无限的列表，所以你永远不会开始计算。

您可以尝试定义

```
repeaterM a f = foldl (>>=) (return a) $ repeat f 
```

反而。这也不起作用（感谢 is7s）。

# java - ArrayList.add() 无法正常工作

> ID：11218439
> 
> 赞同：0
> 
> 时间：2012-06-27T02:05:47.510
> 
> 标签：java, android, arraylist

所以我有一个函数可以从 sql 数据库中获取一些坐标并将它们存储在 arraylist 中。当我从光标读取它们时，我正在打印这些值，它们很好。但是，当我立即循环并打印出存储在数组列表中的值时，所有值似乎都设置为我添加到数组列表中的最后一个值。我在这里做错了什么？

代码：

```
public ArrayList<Coord> getCoordMarkers(int myUserId)
{
    Log.d("getCoordMarkers()", "Called");
Coord myCoord = new Coord();
ArrayList<Coord> markerArray = new ArrayList<Coord>();
String sql = "SELECT "+ userId + " , " + timestamp + " , " + coordX + " , " +
                 coordY + " , " + coordType + " , " + coordId + " , " + coordTypeTable+ "." +
                 coordTypeDesc + " FROM " + coordTable + " JOIN " + coordTypeTable + " ON " +
                 coordTable + "." + coordType + " = " + coordTypeTable + "." + coordTypeAbbr +
                 " WHERE " + userId + " = '" + myUserId + "' AND " + coordTypeTable + "." +
                 coordTypeDesc + " != 'User Location';";
    // AND it is a marker
    SQLiteDatabase db = this.getWritableDatabase();
    Cursor cur = db.rawQuery(sql, null);
    if( cur.moveToFirst()) {
        do {
            myCoord.userId = cur.getInt(0);
            myCoord.timestamp = cur.getLong(1);
            myCoord.x = cur.getDouble(2);
            myCoord.y = cur.getDouble(3);
            myCoord.coordType = cur.getInt(4);
            myCoord.id = cur.getInt(5);
            myCoord.coordTypeDesc = cur.getString(6);
            markerArray.add(myCoord);
            Log.d("getCoordMarkers()", "X: " + myCoord.x + " Y: " + myCoord.y);
        } while( cur.moveToNext());
    }
    cur.close();
    db.close();
    for( int i = 0; i < markerArray.size(); i++ )
    {
        Coord myCoord2 = markerArray.get(i);
        Log.d("Test Marker", "I: "+ i + " X: " + myCoord2.x + " Y: "+ myCoord2.y);

    }
    return markerArray;
} 
```

以下是上述代码的日志打印输出

```
06-27 01:46:06.588: DEBUG/getCoordMarkers()(541): Called
06-27 01:46:06.638: DEBUG/getCoordMarkers()(541): X: -122.093451 Y: 37.420599
06-27 01:46:06.638: DEBUG/getCoordMarkers()(541): X: -122.093451 Y: 37.420599
06-27 01:46:06.648: DEBUG/getCoordMarkers()(541): X: -122.094695 Y: 37.419679
06-27 01:46:06.648: DEBUG/getCoordMarkers()(541): X: -122.094695 Y: 37.419679
06-27 01:46:06.648: DEBUG/getCoordMarkers()(541): X: -122.090104 Y: 37.423633
06-27 01:46:06.658: DEBUG/getCoordMarkers()(541): X: -122.090104 Y: 37.423633
06-27 01:46:06.658: DEBUG/getCoordMarkers()(541): X: -122.092078 Y: 37.420464
06-27 01:46:06.658: DEBUG/getCoordMarkers()(541): X: -122.092078 Y: 37.420464
06-27 01:46:06.658: DEBUG/getCoordMarkers()(541): X: -122.091992 Y: 37.420668
06-27 01:46:06.668: DEBUG/getCoordMarkers()(541): X: -122.091992 Y: 37.420668
06-27 01:46:06.668: DEBUG/getCoordMarkers()(541): X: -122.09594 Y: 37.42077
06-27 01:46:06.678: DEBUG/getCoordMarkers()(541): X: -122.09594 Y: 37.42077
06-27 01:46:06.678: DEBUG/getCoordMarkers()(541): X: -122.09255 Y: 37.42118
06-27 01:46:06.678: DEBUG/getCoordMarkers()(541): X: -122.09255 Y: 37.42118
06-27 01:46:06.688: DEBUG/getCoordMarkers()(541): X: -122.095897 Y: 37.423633
06-27 01:46:06.698: DEBUG/getCoordMarkers()(541): X: -122.095897 Y: 37.423633
06-27 01:46:06.708: DEBUG/Test Marker(541): I: 0 X: -122.095897 Y: 37.423633
06-27 01:46:06.708: DEBUG/Test Marker(541): I: 1 X: -122.095897 Y: 37.423633
06-27 01:46:06.708: DEBUG/Test Marker(541): I: 2 X: -122.095897 Y: 37.423633
06-27 01:46:06.708: DEBUG/Test Marker(541): I: 3 X: -122.095897 Y: 37.423633
06-27 01:46:06.718: DEBUG/Test Marker(541): I: 4 X: -122.095897 Y: 37.423633
06-27 01:46:06.718: DEBUG/Test Marker(541): I: 5 X: -122.095897 Y: 37.423633
06-27 01:46:06.728: DEBUG/Test Marker(541): I: 6 X: -122.095897 Y: 37.423633
06-27 01:46:06.739: DEBUG/Test Marker(541): I: 7 X: -122.095897 Y: 37.423633
06-27 01:46:06.739: DEBUG/Test Marker(541): I: 8 X: -122.095897 Y: 37.423633
06-27 01:46:06.739: DEBUG/Test Marker(541): I: 9 X: -122.095897 Y: 37.423633
06-27 01:46:06.748: DEBUG/Test Marker(541): I: 10 X: -122.095897 Y: 37.423633
06-27 01:46:06.748: DEBUG/Test Marker(541): I: 11 X: -122.095897 Y: 37.423633
06-27 01:46:06.748: DEBUG/Test Marker(541): I: 12 X: -122.095897 Y: 37.423633
06-27 01:46:06.748: DEBUG/Test Marker(541): I: 13 X: -122.095897 Y: 37.423633
06-27 01:46:06.758: DEBUG/Test Marker(541): I: 14 X: -122.095897 Y: 37.423633
06-27 01:46:06.758: DEBUG/Test Marker(541): I: 15 X: -122.095897 Y: 37.423633 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T02:10:14.313

尝试重新实例化 myCord。它看起来像一个简单的重新分配问题。学习指针是值得的，即使是使用 Java！

```
 do {
        myCoord = new Coord(); //**********
        myCoord.userId = cur.getInt(0);
        myCoord.timestamp = cur.getLong(1);
        myCoord.x = cur.getDouble(2);
        myCoord.y = cur.getDouble(3);
        myCoord.coordType = cur.getInt(4);
        myCoord.id = cur.getInt(5);
        myCoord.coordTypeDesc = cur.getString(6);
        markerArray.add(myCoord);
        Log.d("getCoordMarkers()", "X: " + myCoord.x + " Y: " + myCoord.y);
        myCoord = null; //for the garbage collector *******
    } while( cur.moveToNext()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T02:10:41.273

每次迭代都需要构造新对象，而不是修改同一个对象，如下：

```
do {
     myCoord = new Coord(); 
```

**不要在每次循环迭代时声明它，只重新实例化**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:13:13.417

那是因为你一遍又一遍地将同一个对象添加到数组中，每次都覆盖它的值！每次尝试创建一个新对象，如果可以的话，一个[不可变的对象。](http://www.javapractices.com/topic/TopicAction.do?Id=29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-30T20:34:16.703

请您错误地初始化此代码。使用此代码

```
ArrayList<Uri> ImageList = new ArrayList<Uri>(); 
```

里面

```
@Override
    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
        super.onActivityResult(requestCode, resultCode, data);

        ArrayList<Uri> ImageList = new ArrayList<Uri>();
        if(requestCode == PICK_FILE)
        {
            if(resultCode == RESULT_OK)
            {
                if(data.getClipData()!=null)
                {
                    int countClipData = data.getClipData().getItemCount();
                    int currentImageSelected = 0;

                    while (currentImageSelected < countClipData)
                    {
                        ImageUri = data.getClipData().getItemAt(currentImageSelected).getUri();
                        ImageList.add(ImageUri);
                        currentImageSelected = currentImageSelected +1;
                    }

                    Alert.setVisibility(View.VISIBLE);
                    Alert.setText("You Have Selected"+ImageList.size()+"Images");
                    Btn_Choose.setVisibility(View.GONE);
                }

                else
                    {
                        Toast.makeText(this, "Please select your car images", Toast.LENGTH_SHORT).show();
                    }
            }
        }
    }
} 
```

# javascript - 电子表格中的 Google Apps 脚本错误

> ID：11218440
> 
> 赞同：2
> 
> 时间：2012-06-27T02:05:48.413
> 
> 标签：javascript, google-apps-script, google-sheets

截至昨天，我们在将 REST API (urlfetch) 放入 Zendesk 时开始在 Google 电子表格中出现错误。我们已经使用了 1.5 年，并没有真正遇到任何问题。它给出的错误是通用的 - “遇到错误：很抱歉，发生了服务器错误。请稍等，然后重试。” 错误截图 - [http://support.prontomarketing.com/attachments/token/j1bjrnw1cpfu4tu/?name=2012-06-27_08-56-19.jpg](http://support.prontomarketing.com/attachments/token/j1bjrnw1cpfu4tu/?name=2012-06-27_08-56-19.jpg)

Google Apps 脚本电子表格服务 API 最近是否有任何更改？

有没有人有任何想法？

这是我们的脚本：（注意 * zendesk 的 url 和令牌已被删除）

```
function onOpen() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
   var menuEntries = [ {name: "Create Tickets", functionName: "oneToMany"},{name: "Reset Form", functionName: "resetForm"} ];
   ss.addMenu("Actions", menuEntries);
}
function resetForm(){

  var doc = SpreadsheetApp.getActiveSpreadsheet();
  var currentIndex = doc.getActiveSelection().getRowIndex();

  var totalRow = findThelastRow('a',0);

  for (var count=2;count<totalRow;count++)
  {
      doc.getSheets()[0].getRange('a'+count).clear({contentsOnly:true});
      doc.getSheets()[0].getRange('h'+count).clear({contentsOnly:true});
      doc.getSheets()[0].getRange('h'+count).setBackgroundColor('#ffffff');
      doc.getSheets()[0].getRange('i'+count).clear({contentsOnly:true});
      doc.getSheets()[0].getRange('i'+count).setBackgroundColor('#ffffff');
      //doc.getSheets()[0].getRange('c'+count).setValue(clearA(doc.getSheets()[0].getRange('c'+count).getValue()));
  }

}
function continueRest(){
   var doc = SpreadsheetApp.getActiveSpreadsheet();
   var app = UiApp.createApplication().setTitle('Please Input Your Zendesk Username');
   app.setHeight('75');
   app.setWidth('400');
   // Create a grid with 3 text boxes and corresponding labels
   var grid = app.createGrid(1, 2);

   // Text entered in the text box is passed in to userName
   grid.setWidget(0, 0, app.createLabel('Username:'));
   var inputTextBox1 =  app.createTextBox().setName('username');
   inputTextBox1.setWidth('300px');
   grid.setWidget(0, 1,inputTextBox1 ); 

   // Create a vertical panel..
   var panel = app.createVerticalPanel();

   // ...and add the grid to the panel
   panel.add(grid);

   // Create a button and click handler; pass in the grid object as a callback element and the handler as a click handler
   // Identify the function b as the server click handler

   var button = app.createButton('submit').setId('button');
   var handler = app.createServerClickHandler('continueSentTheRest');
   handler.addCallbackElement(grid);
   button.addClickHandler(app.createServerClickHandler('pauseUI'));
   button.addClickHandler(handler);
   //button.setStyleAttribute('display', 'none');

   // Add the button to the panel and the panel to the application, then display the application app in the Spreadsheet doc
   panel.add(button);
   app.add(panel);
   doc.show(app);

}
function oneToMany(){
var doc = SpreadsheetApp.getActiveSpreadsheet();
   var app = UiApp.createApplication().setTitle('Please Input Your Zendesk Username');
   app.setHeight('75');
   app.setWidth('400');
   // Create a grid with 3 text boxes and corresponding labels
   var grid = app.createGrid(1, 2);

   // Text entered in the text box is passed in to userName
   grid.setWidget(0, 0, app.createLabel('Username:'));
   var inputTextBox1 =  app.createTextBox().setName('username');
   inputTextBox1.setWidth('300px');
   grid.setWidget(0, 1,inputTextBox1 ); 

   // Create a vertical panel..
   var panel = app.createVerticalPanel();

   // ...and add the grid to the panel
   panel.add(grid);

   // Create a button and click handler; pass in the grid object as a callback element and the handler as a click handler
   // Identify the function b as the server click handler

   var button = app.createButton('submit').setId('button');
   var handler = app.createServerClickHandler('authHandler');
   handler.addCallbackElement(grid);
   button.addClickHandler(app.createServerClickHandler('pauseUI'));
   button.addClickHandler(app.createServerClickHandler('mapValue'));
   button.addClickHandler(handler);
   //button.setStyleAttribute('display', 'none');

   // Add the button to the panel and the panel to the application, then display the application app in the Spreadsheet doc
   panel.add(button);
   app.add(panel);
   doc.show(app);
}
function pauseUI(e) {
  var app = UiApp.getActiveApplication();
  // try 'pausing' the app while we process the info
  app.setTitle('Please wait...');
  app.getElementById("button").setEnabled(false);
  return app;
}

var table = SpreadsheetApp.getActive().getSheets()[1].getDataRange().getValues();

function selectByIndex( index ) {
  Logger.log(table);
  for( var i in table )
    if( table[i][0] == index )
      return table[i];
  return null; //or throw exception
}

function mapValue(){
  //Get the key value sheet.
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheets()[1];
  Logger.log('on the loop');
  if (sheet != null) {

    for (var i in table){
      var groupKey =table[i][0];
      var groupValue = table[i][1];
      //Logger.log(groupKey+' '+groupValue);
      if(groupKey!=''&&groupValue!='')
        ScriptProperties.setProperty(groupKey,groupValue.toString());

      var assigneeKey = table[i][2];
      var assigneeValue = table[i][3];
      if(assigneeKey!=''&&assigneeValue!='')
        ScriptProperties.setProperty(assigneeKey,assigneeValue.toString());
    }
    //Priority
    ScriptProperties.setProperty('P: Low','1');
    ScriptProperties.setProperty('P: Normal','2');
    ScriptProperties.setProperty('P: High','3');
    ScriptProperties.setProperty('P: Urgent','4');
    //Browser.msgBox(ScriptProperties.getProperty('Development'));
  }
  else
  {
    Browser.msgBox('There is no sheet contain id for the assignee and group.');
  }
  //Browser.msgBox(ScriptProperties.getProperty('P: Urgent'));
}
function createPayLoad(count){
  var doc = SpreadsheetApp.getActiveSpreadsheet();
  var requester = doc.getSheets()[0].getRange('a'+count).getValue();
  var ticketTitle = doc.getSheets()[0].getRange('b'+count).getValue().toString().replace('&','&#38;');
  var ticketComment = doc.getSheets()[0].getRange('c'+count).getValue().toString().replace('&','&#38;');
  ticketComment = replaceBR(ticketComment);
  ticketComment = replaceA(ticketComment);
  var assignee = ScriptProperties.getProperty(doc.getSheets()[0].getRange('d'+count).getValue());
  var group = ScriptProperties.getProperty(doc.getSheets()[0].getRange('e'+count).getValue());
  Logger.log(doc.getSheets()[0].getRange('f'+count).getValue());
  var priority = ScriptProperties.getProperty('P: '+doc.getSheets()[0].getRange('f'+count).getValue().trim());
  var tags = 'internal '+doc.getSheets()[0].getRange('g'+count).getValue();

        var payLoad  =  '\n';
        payLoad +=  '<ticket>'+'\n';
    payLoad +=  '<requester-email>'+requester+'</requester-email>'+'\n';
    payLoad +=  '<subject>'+ticketTitle+'</subject>'+'\n';
    payLoad +=  '<description>'+ticketComment+'</description>'+'\n';
    payLoad +=  '<assignee-id>'+assignee+'</assignee-id>'+'\n';
    payLoad +=  '<group-id>'+group+'</group-id>'+'\n';
    payLoad +=  '<priority-id>'+priority+'</priority-id>'+'\n';
    payLoad +=  '<set-tags>'+tags+'</set-tags>'+'\n';
    payLoad +=  '</ticket>';
  //Browser.msgBox(payLoad) 
  return payLoad;
}

function findThelastRow(column,index){
  var doc = SpreadsheetApp.getActiveSpreadsheet();
  var lastRow = doc.getLastRow();
  for(var i=2;i<=lastRow+1;i++)
  {
       if(doc.getSheets()[index].getRange(column+i).getValue()=="")
       {
         return i;
         break;
       }
  }
  return 0;
}
function authHandler(e){
  if(e.parameter.username=="")
  {
    Browser.msgBox('Username is required!');
    return;
  }
  var app = UiApp.getActiveApplication();

  var doc = SpreadsheetApp.getActiveSpreadsheet();
  var currentIndex = doc.getActiveSelection().getRowIndex();
  var username = e.parameter.username;
  var encode = Utilities.base64Encode(username+'/token:SECRET);
  var totalRow = findThelastRow('a',0);

  for (var count=2;count<totalRow;count++)
  {
    if(doc.getSheets()[0].getRange('a'+count).getValue()=='')
    {
       Browser.msgBox('Requester is required!');
       return;
    }
    var isCreate =  doc.getSheets()[0].getRange('i'+count).getValue();
    var isNormalUpdate = false;
    if(isCreate=='')
    {
      var payLoad = createPayLoad(count);

      var options =
          {
            "method" : "post",
            "headers" : {"Content-type":"application/xml","Authorization":  "Basic "+encode},
            "payload" : payLoad
          };

      var result = UrlFetchApp.fetch("http://SECRET/tickets.xml",options);

      if(result.getResponseCode()==201) //This means success.
      {
        var mytool_array=result.getHeaders().toSource().split(",");
        Logger.log(mytool_array);
        //var ticketNumber=mytool_array[2].split("Location:");
         var ticketNumber=result.getHeaders().toSource().split("Location:");
        Logger.log(ticketNumber);
        var valueTicket=ticketNumber[1].split('.xml')[0].split('tickets/')[1];
        doc.getSheets()[0].getRange('h'+count).setValue('=hyperlink("http://SECRET/tickets/'+valueTicket+'";"'+valueTicket+'")');
        doc.getSheets()[0].getRange('h'+count).setBackgroundColor('#1BE039');
        doc.getSheets()[0].getRange('i'+count).setValue('OK');
        doc.getSheets()[0].getRange('i'+count).setBackgroundColor('#1BE039');
      }
      else
      {
        doc.getSheets()[0].getRange('i'+count).setValue('FAIL');
        break;
        return;
      }
    }
  }
  // Clean up - get the UiApp object, close it, and return
  app.close();
  // The following line is REQUIRED for the widget to actually close.
  return app;
}

function continueSentTheRest(e){
  var app = UiApp.getActiveApplication();
  var doc = SpreadsheetApp.getActiveSpreadsheet();
  var indexOfA = findThelastRow('h',0);

  if(doc.getSheets()[0].getRange('a'+indexOfA).getValue()=="")
  {
    Browser.msgBox('Requester is required!');
    doc.getSheets()[0].setActiveSelection('a'+indexOfA);
    return;
  }

  var username = e.parameter.username;
  username += ':'+e.parameter.password;
  var encode = Utilities.base64Encode(username);
  var totalRow = findThelastRow('a',0);

  for (var count=indexOfA;count<totalRow;count++)
  {
    var payLoad = createPayLoad(count);

    var options =
        {
          "method" : "post",
          "headers" : {"Content-type":"application/xml","Authorization":  "Basic "+encode},
          "payload" : payLoad
        };

    var result = UrlFetchApp.fetch("http://SECRET/tickets.xml",options);

    if(result.getResponseCode()==201) //This means success.
    {
      var mytool_array=result.getHeaders().toSource().split(",");
      var ticketNumber=mytool_array[2].split("Location:");
      var valueTicket=ticketNumber[1].split('.xml')[0].split('tickets/')[1];
      doc.getSheets()[0].getRange('h'+count).setValue('=hyperlink("http://SECRET/tickets/'+valueTicket+'";"'+valueTicket+'")');
      doc.getSheets()[0].getRange('h'+count).setBackgroundColor('#1BE039');
      doc.getSheets()[0].getRange('i'+count).setValue('OK');
      doc.getSheets()[0].getRange('i'+count).setBackgroundColor('#1BE039');
    }
    else
    {
      doc.getSheets()[0].getRange('i'+count).setValue('FAIL');
      break;
      return;
    }
  }
  // Clean up - get the UiApp object, close it, and return
  app.close();
  // The following line is REQUIRED for the widget to actually close.
  return app;
}

String.prototype.ReplaceAll = function(stringToFind,stringToReplace){
    var temp = this;
    var index = temp.indexOf(stringToFind);
        while(index != -1){
            temp = temp.replace(stringToFind,stringToReplace);
            index = temp.indexOf(stringToFind);
        }
        return temp;
}

function replaceBR(input)
{
   return input.ReplaceAll('<br>','&#xD;');
}

function replaceA(input)
{
  input = input.ReplaceAll('<a>',' ');
  input = input.ReplaceAll('</a>',' ');
  return input;
}

function clearA(input)
{
  return input.replace(/<a>.*<\/a>/g,'<a></a>');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T07:10:45.690

您的原始`findThelastRow(column,index)`函数具有从 0 到活动工作表的*lastRow*的循环，但随后使用此循环值处理（最终）其他工作表中的范围。此其他工作表中可能不存在行索引。
根据不同工作表中存在多少行，您可能多年来对此没有任何问题，但也许现在这种情况正在发生......

为了防止这种风险，我建议在`findThelastRow`函数中尝试这个：

```
function findThelastRow(column,index){
  var doc = SpreadsheetApp.getActiveSpreadsheet();
  var lastRow = doc.getSheets()[index].getLastRow();// check last row on the appropriate sheet
  for(var i=2;i<=lastRow+1;i++)
  {
       if(doc.getSheets()[index].getRange(column+i).getValue()=="")
       {
         return i;
         break;
       }
  }
  return 0;
} 
```

编辑：可以[更有效地编写](https://developers.google.com/apps-script/best_practices#OptimizeScripts)此函数，而无需`getValue()`在相当慢的循环中使用......这是使用数组的兼容版本：（您可以在不进行任何更改的情况下替换它）

```
function findThelastRow(column,index){
          var doc = SpreadsheetApp.getActiveSpreadsheet();
          var lastRow = doc.getSheets()[index].getLastRow()+1;// check last row on the appropriate sheet
          var coldata = doc.getSheets()[index].getRange(column+2+':'+column+lastRow).getValues();// I begin on Row 2 just as you did
      for(i=coldata.length-1;i>=0;i--){
         if(coldata[i][0]!=''){return i+2;break}
      }
      return 0;
    } 
```

# c# - 封装对象的创建和完成的好方法是什么？

> ID：11218448
> 
> 赞同：2
> 
> 时间：2012-06-27T02:06:49.770
> 
> 标签：c#

我正在使用带有一堆类的第三方程序集，以分层方式组织。`CreateXxx()`它们具有私有构造函数，并通过在另一个更高级别的类的实例上调用方法来实例化。在层次结构的顶部，使用了一个单例类。例如，应用程序代码如下所示：

```
TopClass top = TopClass.GetInstance();
SecondLevelClass secondLevel = top.CreateSecondLevelElement();
ThirdLevelClass thirdLevel = secondLevel.CreateThirdLevelElement(); 
```

类似地，终结是使用一种`DeleteXxx()`方法完成的，该方法必须发生在用于`CreateXxx()`.

我不会详细说明采用这种特殊方法的原因。但是，我想用我自己的一组具有公共构造函数的类来封装这些类的创建，这样代码看起来会更好，如下所示：

```
// No TopClass anymore, see explanation below
MySecondLevelClass secondLevel = new MySecondLevelClass();
MyThirdLevelClass thirdLevel = new MyThirdLevelClass(secondLevel); 
```

我最初的方法是让`MyXxx`类在构造函数中调用相关`CreateXxx()`方法并维护对结果的引用。此外，需要对构造函数参数的引用才能`DeleteXxx()`在完成时调用方法。为此，我正在考虑在内部实现`IDisposable`和调用。`DeleteXxx()``Dispose()`

使用这种方法，`TopClass`对于应用程序开发人员来说就变得多余了，因为它的唯一目的是创建和销毁 SecondLevelClass 实例。这现在发生在`MySecondLevelClass`构造函数的内部。

总而言之，我认为这在技术上是合理的。我遇到的唯一问题是原始类实现了具有很多方法的接口，我仍然希望通过我的`MyXxx`类公开这些方法。我不期待在我自己的类上重新定义所有这些方法，只是将所有调用转发到对“原始”类实例的封装引用。如果我能做一些像重载点运算符这样的事情会很好。或者，最好告诉编译器对原始类实例的封装引用实际上实现了接口——有点像在 VMT 中添加了一个额外的间接。

当然不支持这些选项，我还没有找到解决所有方法重复的方法。有没有人知道如何以更聪明的方式做到这一点？任何反馈表示赞赏，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:52:03.673

也许，您可以使用构建器模式之类的东西来包装它们的*构造，而不是包装现有的类。*您不会得到 'TopClass o = new TopClass()' 语法，但这样的构造模式很好理解，应该可以提高对代码的理解。

（基本）构建器可能看起来像；

```
public class OtherAssemblyBuilder
{
    public TopClass Build()
    {
        return TopClass.GetInstance();
    }

    public SecondLevelClass Build()
    {
        TopClass top = TopClass.GetInstance();
        return top.CreateSecondLevelElement();
    }

    public ThirdLevelClass Build()
    {
        TopClass top = TopClass.GetInstance();
        SecondLevelClass secondLevel = top.CreateSecondLevelElement();
        return secondLevel.CreateThirdLevelElement();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:18:22.740

你可以做到这一点（据我所知）的唯一方法是执行以下操作 -

* * *

```
public class Concrete : SomeInterface
{
    private Concrete()
    {
        //instantiate other classes here
    }
    public string GetAString()
    {
        return string.Empty;
    }

    public static Concrete GetInstance()
    {
        return new Concrete();
    }

}

public class Wrapper : SomeInterface
{
    public Wrapper()
    {
        this.concrete = Concrete.GetInstance();
    }
    Concrete concrete { get; set; }
    public string GetAString()
    {
        this.concrete.GetAString();
    }
}

public interface SomeInterface
{
    string GetAString();
} 
```

我知道这不是最好的方法，因为您必须手动调用要包装的类上的每个接口成员，但它会实现目标。

也许试试 T4 代码模板？如果您经常遇到这种情况（并且界面发生变化），将来可能会节省您的时间吗？

# jquery - Jquery选项卡，从选项卡内的链接打开选项卡

> ID：11218449
> 
> 赞同：0
> 
> 时间：2012-06-27T02:06:51.507
> 
> 标签：jquery, tabs

我正在使用jquery标签显示一些内容，并且我需要在标签内制作一个链接才能打开另一个标签，我的jquery知识非常有限，所以我发布我的代码，所以你可以检查一下我能做什么？

这是jquery代码：

```
$(document).ready(function() {
    //$(".tab_content").hide(); 
    $(".tab_content").css({
        'display':'block',
        'position':'absolute',
        'top':'-999em',
        'left':'-999em'
    });
    //$(".tab_content:first").show(); 
    $(".tab_content:first").css({
        'top':'350px',
        'left':'50px',
        'width':'660px'
    });
    firstTabHeight = $(".tab_content:first").height();
    $(".tab_content:first").parent().css('height',firstTabHeight);

    $("#nav-portfolio ul li").click(function() {
        $("#nav-portfolio ul li").removeClass("active"); //Remove any "active" class
        $(this).addClass("active"); //Add "active" class to selected tab
        //$(".tab_content").hide(); //Hide all tab content
        $(".tab_content").css({
            'display':'block',
            'position':'absolute',
            'top':'-999em',
            'left':'-999em'
        });

        var activeTab = $(this).find("a").attr("href"); //Find the rel attribute value to identify the active tab + content
        $(activeTab).hide(); 
        //$(".tab_content").css({
        //  'opacity':'0',
        //});
        //var tabHeight = $(activeTab).height();
        //$('#colLeft').height(tabHeight);
        $(activeTab).fadeIn(); //Fade in the active content
        thisTabHeight = $(activeTab).height();
        $(activeTab).css({
            'display':'block',
            'position':'relative',
            'top':'0',
            'left':'0',
            'width':'660px'
        });
    activeTabHeight = $(activeTab).height();
    $(".tab_content:first").parent().css('height',activeTabHeight);

   return false;

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T04:47:08.903

将点击函数绑定到标签内的链接，以调用您要转到的标签的点击函数。例如，如果您希望链接触发第二个选项卡：

```
$('#this_is_the_link').click(function(e) {
    e.preventDefault(); //stop the normal link function from happening
    $("#nav-portfolio ul li:nth-child(2)").click() // call click event on the second tab
}); 
```

# drupal - Drupal 重用模块

> ID：11218454
> 
> 赞同：0
> 
> 时间：2012-06-27T02:07:18.443
> 
> 标签：drupal, drupal-7, drupal-modules

我是 Drupal 的新手，但是我一直在研究模块开发，并且我设法使用块和 jQuery 完成了一些功能。但是需求变得更大了，在某些情况下，用户想要上传和图像，并裁剪它以创建将在其他块中呈现的缩略图。我知道这个确切的行为已经在一些社区模块中完成，特别是 ImageFieldCrop，所以我想使用它......但是我想将上传的图像和裁剪的图像保存在我的自定义模块内的文件夹中。那么问题来了？我该如何扩展该模块？...是否有必要重写代码以指向正确的路径？？？或者有没有办法拦截钩子方法？由于我是drupal开发的新手，如果这听起来像是一个基本问题，我深表歉意...... 无论如何，如果有人能给我提供一些链接或教程来展示如何拦截钩子或在我创建的模块上使用其他模块代码，那就太好了。非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T16:37:44.983

如果您希望允许用户上传图像和文件，这可能最好使用“文件字段”来实现，它在 D7 中成为其核心模块集的一部分。当您添加和配置字段时（作为内容类型创建过程的一部分），您有机会设置您希望文件保存到的路径。

**JS 裁剪和图像样式**

在作物解决方案方面，我可以推荐[EPSA Crop](http://drupal.org/project/epsacrop)模块。这允许您的用户为每个上传的图像定义多个不同的裁剪区域，并使用交互式 JS 小部件来实现。它符合 D7 的“图像样式”（D6 中的正式图像缓存）的约定，允许有效地重用和操作图像；例如，您的用户上传了一张高分辨率图像，并且可以创建变体以在您网站的各个地方使用。

创建样式后，您可以使用 API 主题调用 ( [theme_image_style](http://api.drupal.org/api/drupal/modules!image!image.module/function/theme_image_style/7) )以编程方式添加它们

**避免忽略既定的约定**

然而，Drupal 作为一个系统设置了许多约定，理想情况下应该遵循这些约定。

对于用户创建的文件，最好将它们存储在站点的文件目录中。Drupal 使用两种类型的文件访问——公共的，它不关注任何类型的访问权限和私有的——它允许应用访问限制。通过选择将文件存储在模块目录中，您可能会给自己或任何未来的开发人员带来问题。

我建议不要将这些文件保存在您的模块目录中，除非您有*充分*的理由这样做。

# facebook - FB：喜欢给定的对象（如果它有 /likes 连接）

> ID：11218457
> 
> 赞同：0
> 
> 时间：2012-06-27T02:08:12.413
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

如何根据 fb 要求授予对象“喜欢”连接？

[https://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:10:31.453

您需要使用 Facebook Graph API 代表用户发布点赞。有关如何完成的，请参阅[http://developers.facebook.com/docs/reference/api/#publishing](http://developers.facebook.com/docs/reference/api/#publishing)。

# java - 如何将 UTF 字符串转换为 ANSI 并使用 JAVA-ANDROID 在 ExternalSD 中创建 ANSI 文本文件

> ID：11218461
> 
> 赞同：4
> 
> 时间：2012-06-27T02:09:03.413
> 
> 标签：java, android, utf-8, cp1252

我用java编写了一个android应用程序来获取用户答案并将它们保存在一个文件中。问题是这个文件保存在 utf-8 中。最终用户将在 IBM SPSS 中打开这些文件，这是一个只能读取 ANSI (windows-1252) 文件的 windows 应用程序。

**如何在 ANSI 代码中创建文件以从 java-android 应用程序保存在 SD 卡中？**

我想我知道要将字符串转换为 ANSI，我应该使用：

```
String unicode = new String(asciiBytes, "windows-1252"); 
```

**那是对的吗？**

我保存文件的代码是这样的：

```
File interviewFile = new File(placeOfSDD, fileName);
FileWriter writer = new FileWriter(interviewFile, true);
writer.append(textBody);
writer.flush();
writer.close(); 
```

“textBody”是要转换为ANSI的String，“interviewFile”也是要保存为ANSI的文件。

谢谢您的帮助！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T02:17:33.560

字符串在 JVM 中表示为 Unicode。当你把它写出来时，你需要把它转换成合适的字符集。

为此，请使用[`OutputStreamWriter`](http://docs.oracle.com/javase/6/docs/api/java/io/OutputStreamWriter.html#OutputStreamWriter%28java.io.OutputStream,%20java.nio.charset.Charset%29)并指定`Charset`.

```
OutputStreamWriter writer = new OutputStreamWriter(new FileOutputStream(file, true), 
                                                   "windows-1252");
writer.append(textBody);
writer.close(); 
```

* * *

关于你的第一个问题：

> 我想我知道要将字符串转换为 ANSI 我应该使用：
> `String unicode = new String(asciiBytes, "windows-1252");`
> 对吗？

给定一个表示“windows-1252”字符集中字符的字节数组，此代码将为您构造适当的 Java 字符串（在 JVM 内部表示为 Unicode）。这*不是*“将字符串转换为 ANSI”......它正在做相反的事情：将“windows-1252”转换为 Unicode。

# javascript - 一段时间后下拉的信息栏

> ID：11218472
> 
> 赞同：1
> 
> 时间：2012-06-27T02:11:10.580
> 
> 标签：javascript, jquery, html, css, drop-down-menu

在用户查看页面一段时间后，如何从浏览器窗口顶部下拉到下拉条？说 5 秒。然后，此栏将向下推动页面上的所有内容，直到栏完成出现。该栏将用于显示单行文本，通知用户某事。也许在栏的右侧有一个小 X 来关闭它。

目前这是CSS：

```
#infobar {
    border-bottom: 5px solid;
    height: 25px;
    position: fixed;
    width: 100%;
    border-bottom-color: #F00;
    background-color: #9C9;
    margin-top:-16px;
}
#infobar .text {
    color: #FFFFFF;
    float: left;
    font-family: arial;
    font-size: 12px;
    padding: 5px 0;
    position: relative;
    text-align: center;
    width: 100%;
}
#infobar .text a {
    color: #FAFAFA;
}
#infobar .text a:hover {
    color: #FFE2A0;
}

</style> 
```

和 HTML：

```
<div id="infobar">
<div class="text">
....this is the bar text....
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:38:38.457

仅使用 HTML/CSS 是不可能的，因为它需要动画和时间控制，您需要额外的技术，例如 Javascript/JQuery 或 Flash。

**编辑 1**

我认为下面的代码会做你想要的。

**CSS**

```
<style type="text/css">

#infobar {
    display:none;
    border-bottom: 5px solid;
    height: 25px;
    position: fixed;
    width: 100%;
    border-bottom-color: #F00;
    background: #9C9;
    margin-top:-16px;
}
#infobar .text {
    color: #FFFFFF;
    float: left;
    font:12px arial;
    padding: 5px 0;
    position: relative;
    text-align: center;
    width: 100%;
}
#infobar .text a {
    color: #FAFAFA;
}
#infobar .text a:hover {
    color: #FFE2A0;
}

#close {
    color: red;
    float:right;
}

</style> 
```

**Javascript/JQuery**

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript">

    $(window).load( function() {

         setTimeout( function() {

             $("#infobar").slideToggle("fast");

         }, 5000);

        $("#close").click( function() {

            $("#infobar").slideToggle("fast");
            return false;

        });

    });

</script> 
```

**HTML**

```
<div id="infobar">
    <div class="text">
        ....this is the bar text....
        <a href="#" id="close">close</a>
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T04:00:41.720

非常草稿样本（无 jquery）：

对 CSS 的更改

```
body { 
    margin:0; padding: 10px
}
#infobar {
    border-bottom: 5px solid;
    height: 25px;
    position: fixed;
    width: 100%;
    border-bottom-color: #F00;
    background-color: #9C9;
    top: -30px;
    left: 0;
} 
```

最小的 JavaScript

```
var topMargin = 0;

function letsgo()
{
    setTimeout("showinfo()", 5000);
}

function showinfo()
{
    document.body.style.marginTop = (topMargin++) + 'px';
    document.getElementById('infobar').style.top = (topMargin - 30) + 'px';
    if (topMargin < 30) setTimeout("showinfo()", 10);
}

function hideinfo()
{
    document.body.style.marginTop = (--topMargin) + 'px';
    document.getElementById('infobar').style.top = (topMargin - 30) + 'px';
    if (topMargin > 0) setTimeout("hideinfo()", 10);
}

window.onload = letsgo; 
```

最后是一些 HTML

```
<div id="infobar" onclick="hideinfo()">infobar content</div> 
```

# python - 如何使用 pickle 保存字典（或任何其他 Python 对象）？

> ID：11218477
> 
> 赞同：546
> 
> 时间：2012-06-27T02:12:44.003
> 
> 标签：python, dictionary, pickle

我已经查看了[Python 文档](https://docs.python.org/3/library/pickle.html)提供的信息，但我仍然有点困惑。有人可以发布示例代码来编写一个新文件，然后使用 pickle 将字典转储到其中吗？

* * *

## 回答 #1

> 赞同：1065
> 
> 时间：2012-06-27T02:16:11.663

试试这个：

```
import pickle

a = {'hello': 'world'}

with open('filename.pickle', 'wb') as handle:
    pickle.dump(a, handle, protocol=pickle.HIGHEST_PROTOCOL)

with open('filename.pickle', 'rb') as handle:
    b = pickle.load(handle)

print(a == b) 
```

上述解决方案没有任何特定于`dict`对象的内容。这种相同的方法将适用于许多 Python 对象，包括任意类的实例和任意复杂的数据结构嵌套。例如，用这些行替换第二行：

```
import datetime
today = datetime.datetime.now()
a = [{'hello': 'world'}, 1, 2.3333, 4, True, "x", 
     ("y", [[["z"], "y"], "x"]), {'today', today}] 
```

也会产生一个结果`True`。

有些物体由于其性质而不能腌制。例如，腌制包含打开文件句柄的结构是没有意义的。

* * *

## 回答 #2

> 赞同：144
> 
> 时间：2015-10-20T19:49:21.840

```
import pickle

your_data = {'foo': 'bar'}

# Store data (serialize)
with open('filename.pickle', 'wb') as handle:
    pickle.dump(your_data, handle, protocol=pickle.HIGHEST_PROTOCOL)

# Load data (deserialize)
with open('filename.pickle', 'rb') as handle:
    unserialized_data = pickle.load(handle)

print(your_data == unserialized_data) 
```

的优点`HIGHEST_PROTOCOL`是文件变小。这使得解酸有时更快。

**重要提示**：pickle 的最大文件大小约为 2GB。

## 替代方式

```
import mpu
your_data = {'foo': 'bar'}
mpu.io.write('filename.pickle', data)
unserialized_data = mpu.io.read('filename.pickle') 
```

## 替代格式

*   CSV：超级简单的格式（[读写](https://stackoverflow.com/a/41585079/562769)）
*   JSON：非常适合编写人类可读的数据；非常常用（[读写](https://stackoverflow.com/a/37795053/562769)）
*   YAML：YAML 是 JSON 的超集，但更易于阅读（[读写](https://stackoverflow.com/a/42054860/562769)，[JSON 和 YAML 的比较](https://stackoverflow.com/a/1729545/562769)）
*   pickle：一种 Python 序列化格式（[读写](https://stackoverflow.com/a/33245595/562769)）
*   [MessagePack](http://msgpack.org/)（[Python 包](https://pypi.python.org/pypi/msgpack-python)）：更紧凑的表示（[读写](https://stackoverflow.com/q/43442194/562769)）
*   [HDF5](https://en.wikipedia.org/wiki/Hierarchical_Data_Format)（[Python 包](http://docs.h5py.org/en/latest/quick.html)）：适用于矩阵（[读写](https://stackoverflow.com/a/41586571/562769)）
*   XML: 也存在 *sigh* ([读](https://stackoverflow.com/a/1912483/562769)&[写](https://stackoverflow.com/a/3605831/562769))

对于您的应用程序，以下内容可能很重要：

*   其他编程语言的支持
*   读/写性能
*   紧凑性（文件大小）

另见：[数据序列化格式的比较](https://en.wikipedia.org/wiki/Comparison_of_data_serialization_formats)

如果您正在寻找一种制作配置文件的方法，您可能需要阅读我的短文[Python 中的配置文件](https://martin-thoma.com/configuration-files-in-python/)

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2014-03-27T14:54:48.930

```
# Save a dictionary into a pickle file.
import pickle

favorite_color = {"lion": "yellow", "kitty": "red"}  # create a dictionary
pickle.dump(favorite_color, open("save.p", "wb"))  # save it into a file named save.p

# -------------------------------------------------------------
# Load the dictionary back from the pickle file.
import pickle

favorite_color = pickle.load(open("save.p", "rb"))
# favorite_color is now {"lion": "yellow", "kitty": "red"} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2015-06-08T22:35:56.730

一般来说，腌制 a`dict`会失败，除非你只有简单的对象，比如字符串和整数。

```
Python 2.7.9 (default, Dec 11 2014, 01:21:43) 
[GCC 4.2.1 Compatible Apple Clang 4.1 ((tags/Apple/clang-421.11.66))] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> from numpy import *
>>> type(globals())     
<type 'dict'>
>>> import pickle
>>> pik = pickle.dumps(globals())
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 1374, in dumps
    Pickler(file, protocol).dump(obj)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 224, in dump
    self.save(obj)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 649, in save_dict
    self._batch_setitems(obj.iteritems())
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 663, in _batch_setitems
    save(v)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 306, in save
    rv = reduce(self.proto)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/copy_reg.py", line 70, in _reduce_ex
    raise TypeError, "can't pickle %s objects" % base.__name__
TypeError: can't pickle module objects
>>> 
```

即使是**非常**简单的`dict`也经常会失败。这仅取决于内容。

```
>>> d = {'x': lambda x:x}
>>> pik = pickle.dumps(d)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 1374, in dumps
    Pickler(file, protocol).dump(obj)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 224, in dump
    self.save(obj)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 649, in save_dict
    self._batch_setitems(obj.iteritems())
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 663, in _batch_setitems
    save(v)
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 286, in save
    f(self, obj) # Call unbound method with explicit self
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/pickle.py", line 748, in save_global
    (obj, module, name))
pickle.PicklingError: Can't pickle <function <lambda> at 0x102178668>: it's not found as __main__.<lambda> 
```

但是，如果您使用更好的序列化程序，例如`dill`or `cloudpickle`，那么大多数字典都可以腌制：

```
>>> import dill
>>> pik = dill.dumps(d) 
```

或者，如果您想将您`dict`的文件保存到文件中...

```
>>> with open('save.pik', 'w') as f:
...   dill.dump(globals(), f)
... 
```

后一个示例与此处发布的任何其他好的答案相同（除了忽略内容的可腌制性之外`dict`）。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2018-08-16T11:21:39.303

将 Python 数据（例如字典）转储到 pickle 文件的简单方法。

```
import pickle

your_dictionary = {}

pickle.dump(your_dictionary, open('pickle_file_name.p', 'wb')) 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-06-27T02:16:23.533

```
>>> import pickle
>>> with open("/tmp/picklefile", "wb") as f:
...     pickle.dump({}, f)
... 
```

通常最好使用 cPickle 实现

```
>>> import cPickle as pickle
>>> help(pickle.dump)
Help on built-in function dump in module cPickle:

dump(...)
    dump(obj, file, protocol=0) -- Write an object in pickle format to the given file.

    See the Pickler docstring for the meaning of optional argument proto. 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-11-19T20:49:09.330

如果您只想将字典存储在单个文件中，请`pickle`像这样使用

```
import pickle

a = {'hello': 'world'}

with open('filename.pickle', 'wb') as handle:
    pickle.dump(a, handle)

with open('filename.pickle', 'rb') as handle:
    b = pickle.load(handle) 
```

如果要在多个文件中保存和恢复多个字典以进行缓存和存储更复杂的数据，请使用[anycache](https://pypi.python.org/pypi/anycache)。它可以完成您需要的所有其他事情`pickle`

```
from anycache import anycache

@anycache(cachedir='path/to/files')
def myfunc(hello):
    return {'hello', hello} 
```

Anycache`myfunc`根据不同文件的参数存储不同的结果`cachedir`并重新加载它们。

有关更多详细信息，请参阅[文档](http://anycache.readthedocs.io)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-12-05T12:40:49.223

```
import pickle

dictobj = {'Jack' : 123, 'John' : 456}

filename = "/foldername/filestore"

fileobj = open(filename, 'wb')

pickle.dump(dictobj, fileobj)

fileobj.close() 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-05-11T07:31:48.627

仅供参考，熊猫现在有一种保存泡菜的方法。

我觉得更容易。

```
pd.to_pickle(object_to_save,'/temp/saved_pkl.pickle' ) 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2021-08-04T14:38:09.470

如果您想在不打开文件的情况下在一行中处理写入或读取：

```
 import joblib

  my_dict = {'hello': 'world'}

  joblib.dump(my_dict, "my_dict.pickle") # write pickle file
  my_dict_loaded = joblib.load("my_dict.pickle") # read pickle file 
```

* * *

## 回答 #11

> 赞同：-11
> 
> 时间：2014-06-17T14:03:30.347

我发现腌制令人困惑（可能是因为我很厚）。不过，我发现这行得通：

```
myDictionaryString=str(myDictionary) 
```

然后您可以将其写入文本文件。我放弃了尝试使用 pickle，因为我收到错误告诉我将整数写入 .dat 文件。我很抱歉没有使用泡菜。

# android - sencha touch package build - 只显示命令提示符不显示任何错误

> ID：11218482
> 
> 赞同：3
> 
> 时间：2012-06-27T02:13:45.603
> 
> 标签：android, sencha-touch, native, packaging

我已经解决这个问题好几天了，我无法解决..请帮忙？

[我遵循了http://docs.sencha.com/touch/2-0/#!/guide/getting_started](http://docs.sencha.com/touch/2-0/#!/guide/getting_started)上的入门教程

我成功创建了 GS 项目 .. sencha generate app GS ../GS

现在我正在尝试创建一个 .apk 文件，所以我安装在我的 Android 手机上进行测试。

问题：当我输入以下 c:\sencha-touch-2> sencha package build c:\GS\packager.json

什么都没有发生，光标只是转到命令提示符

下面是我的 packager.json 文件。

如果有人有任何想法或可以提供帮助，我将不胜感激

```
{
    "applicationName":"GS",
    "applicationId":"com.steve.GS",
    "versionString":"1.0",
    "iconName":"Icon.png",
    "inputPath":"c:\GS",
    "outputPath":"c:\Build",
    "configuration":"Debug",
    "platform":"Android",
    "deviceType":"Universal",
    "certificatePath":"c:\debug.keystore",
    "certificateAlias":"",
    "sdkPath":"c:\Program Files\Android\android-sdk",
    "androidAPILevel":"15",
    "orientations": [
        "portrait",
        "landscapeLeft",
        "landscapeRight",
        "portraitUpsideDown"
    ]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T08:24:32.040

尝试在 c:\GS 中运行“sencha package build packager.json”

如果这不起作用：

*   你安装了最新的 Sencha-Cmd 吗？
*   你用的是什么煎茶触摸 2.0.1？（我没有找到关于 2.1.1 的 android 包装的任何信息）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-20T12:49:32.127

要构建 sencha touch 应用程序，请确保使用以下属性更新 sencha touch 项目中的 packager.json 文件：

*   "applicationId":"com.test.projectname",(这里要遵循的包格式)

*   "platform":"Android", （如果您正在为 android 设备构建）

*   "platform":"AndroidEmulator", （如果您正在为 android 模拟器构建）

*   "certificatePath":"../", （证书的路径 - 可以使用用于签署 android 应用程序的密钥）

*   "certificatePassword":" ****** ", (你的密钥的密码)

*   "sdkPath":"../../../../../../android-sdk_r16-windows/android-sdk-windows", （如果你正在为 android 构建，则为 android sdk 的路径）

*   **确保您提供 packager.json 文件夹的相对路径，这与提供 sdk 和密钥的物理位置的问题不同**

# html - 检查url中的字符串并根据写入html

> ID：11218490
> 
> 赞同：1
> 
> 时间：2012-06-27T02:14:22.313
> 
> 标签：html

可以使用什么语言来检查字符串或链接，然后相应地编写 html？这是在用户加载页面时。我需要这个，以便在加载视频播放器之前检查链接是 .mp4 还是 .flv。如果它具有包含的视频格式，那么它将加载播放器的代码，否则它将显示一条消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:18:22.717

可以使用 PHP、perl、python、asp、asp.net 和许多其他语言。到目前为止，最常见的服务器端语言是 PHP。它使服务器端编码相对容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T02:23:54.283

> “如果不是，它将显示一条消息。”

通常在纯 HTML 中所做的事情是这样的：

```
<embed src="video.flv">
We're sorry, but your browser does not have the necessary plug-ins to display FLV video files.
</embed> 
```

错误消息始终存在，但如果视频实际加载，则它会被掩盖。

# c# - C# .NET 传递动态 在方法中

> ID：11218491
> 
> 赞同：0
> 
> 时间：2012-06-27T02:14:35.117
> 
> 标签：c#, .net, windows-phone-7

这就是我想要做的。

Class1：基类

```
 private void Update()
    {
       base.Update(Updated);
    }

    private void Updated(IRestResponse<thisClass> response)
    { 
        ....
    } 
```

...

基类：

```
public void Update(<T> callback)
    {
        RestClient client = new RestClient("https://www.googleapis.com");
        client.Authenticator = new OAuth2AuthorizationRequestHeaderAuthenticator(App.AuthenticationResult.access_token);
        var request = new RestRequest(path, Method.GET);
        client.ExecuteAsync<...T...>(request, callback);
    } 
```

本质上，我希望能够在遵循相同结构的多个类中重用基类中的更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:24:11.597

目前您的基类`Update`方法有一些语法错误。

```
public void Update<T>(T callback)
{
    RestClient client = new RestClient("https://www.googleapis.com");
    client.Authenticator = new OAuth2AuthorizationRequestHeaderAuthenticator(App.AuthenticationResult.access_token);
    var request = new RestRequest(path, Method.GET);
    client.ExecuteAsync<T>(request, callback);
} 
```

如果参数是回调，它不应该是委托吗？

它不需要如此通用，但您可以执行以下操作：

```
public delegate T CallbackDelegate<T>();
public void Update<T>(CallbackDelegate<T> callback)
    {
        RestClient client = new RestClient("https://www.googleapis.com");
        client.Authenticator = new OAuth2AuthorizationRequestHeaderAuthenticator(App.AuthenticationResult.access_token);
        var request = new RestRequest(path, Method.GET);
        client.ExecuteAsync<T>(request, callback);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T04:36:09.443

我从您的问题中收集到的是您想要共享/重用`Update()`但`Updated()`在扩展类中有一个自定义......？

可能最简单的方法是在基类中创建一个虚拟方法，该方法在扩展类中被覆盖：

```
public class BaseClass
{
    public virtual void Updated() { }
    public void Update()
    {
        RestClient client = new RestClient("https://www.googleapis.com");
        client.Authenticator = new OAuth2AuthorizationRequestHeaderAuthenticator(App.AuthenticationResult.access_token);
        var request = new RestRequest(path, Method.GET);

        //implement whatever logic you want with the response.

        this.Updated(); //include whatever parameters you need to pass.
    }
}

public class Class1 : BaseClass
{
    public override void Updated()
    {
        //implement logic specific to Class1...
    }
} 
```

# ember.js - 如何在非 Rails 应用程序上组织 Ember JS 应用程序

> ID：11218492
> 
> 赞同：2
> 
> 时间：2012-06-27T02:14:42.657
> 
> 标签：ember.js, requirejs

我需要为 Ember 应用程序组织我的 JS 文件。我没有 Rails 后端。我正在运行基于 Java 的 Glassfish 服务器。使用 loader.js 对此有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T10:23:16.107

您可以使用托管在[interline/ember-skeleton](https://github.com/interline/ember-skeleton)的项目模板。它使用 Rake Pipeline 并将您的代码编译到`assets`文件夹中。如果您执行`bundle exec rackup`，您可以访问应用程序`http://localhost:9292/index.html`。

也可以通过`RAKEP_MODE=production bundle exec rakep`.

的布局与`ember-skeleton`尚未发布的 emberjs gem 中使用的布局基本相同，可以在[这里](https://github.com/emberjs/ember-gem)找到。

# c# - 如何防止 https 响应在 Fiddler 运行时抛出 AuthenticationException？

> ID：11218494
> 
> 赞同：0
> 
> 时间：2012-06-27T02:15:20.393
> 
> 标签：c#, https, httpwebrequest, fiddler

这里是 C# 的相对新手 :)

我目前正在创建一个网络链接抓取工具，并且在尝试通过我的程序登录该网站时遇到问题。我正在尝试使用 Fiddler 来查看我的程序是否发送了正确的数据，但是当我的程序尝试从运行 Fiddler 的站点获取响应时，我的程序抛出了 AuthenticationException。请求通过 HTTPS 发送，Fiddler 的证书是引发异常的原因。

我的问题是，我可以在我的程序中实施什么以使其忽略证书身份验证？就我的程序而言，请求和响应由 HttpWebRequest 和 HttpWebResponse 类处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:13:57.913

你有没有做到以下几点： [Fiddler https解密](http://www.fiddler2.com/Fiddler/help/httpsdecryption.asp)

# javascript - 对easyslider 1.7的淡入淡出效果？

> ID：11218495
> 
> 赞同：0
> 
> 时间：2012-06-27T02:15:23.580
> 
> 标签：javascript, fade, effect, easyslider

在 EasySlider 1.7 上可以有淡入淡出效果（如 www.outspark.com 上所见）而不是滑块效果吗？我希望滑块图像褪色而不是幻灯片。

我无法通过此处的 javascript 代码，但这是粘贴： http: [//pastebin.com/B8j7wKX9](http://pastebin.com/B8j7wKX9)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T18:54:19.793

寻找这条线

```
if(!options.vertical) {
                    p = (t*w*-1);
                    $("ul",obj).animate(
                        { marginLeft: p }, 
                        { queue:false, duration:speed, complete:adjust }
                    );              
                } 
```

并将其更改为

```
if(!options.vertical) {
                    p = (t*w*-1);
                    $("ul",obj).animate(
                        { opacity: 0 }, 
                        { queue:false, duration:'slow', complete:adjust }
                    );  
} 
```

然后寻找这条线

```
if(!options.vertical) {
                $("ul",obj).css("margin-left",(t*w*-1));
            } 
```

并将其更改为

```
if(!options.vertical) {
                $("ul",obj).css("margin-left",(t*w*-1));
                $("ul",obj).animate(
                        { opacity: 1 }, 
                        { queue:false, duration:'slow'}
                    );  
            } 
```

我希望这对你有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T18:15:01.400

EasySlider 不包括褪色，但它有一个修改版本：http: [//bogojoker.com/easySlide/](http://bogojoker.com/easySlide/)

试试看。

# r - 将多个文件读入多个数据帧

> ID：11218498
> 
> 赞同：3
> 
> 时间：2012-06-27T02:15:49.450
> 
> 标签：r, for-loop, stata

在d:\folder，我有很多Stata文件，如data_aa_1.dta、data_aa_2.dta、data_aa_3.dta、data_bb_1.dta、data_bb_2.dta、data_bb_3.dta、data_cc_1.dta....我想转换这些文件并获得与 R 中的 dta 文件一样多的数据帧。所以，我相信我必须遍历 c("aa"、"bb"、"cc") 和 c(1:3)。我尝试了类似以下的方法：

```
library(foreign)

for(i in c("aa","bb","cc"){
    for (j in 1:3){
        data_[i]_[j] <-read.dta("d:/folder/data_[i]_[j].dta")
    }
} 
```

但是，这看起来是错误的——绝对是。

任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T03:28:38.890

试试这个，

```
fl = list.files(pattern = "dta", path = "d:/folder", 
                full.names = TRUE)
dl = lapply(fl, foreign::read.dta)
names(dl) = tools::file_path_sans_ext(fl)
str(dl) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-27T02:28:30.060

然而，无疑有一个更优雅的解决方案

```
library(foreign)

for(i in c("aa","bb","cc"){
    for (j in 1:3){
      obj_name <- paste('data', i, j, sep ='_')
      file_name <- file.path('d:/folder',paste(obj_name,'dta', sep ='.'))
      input <- read.dta(file_name)
      assign(obj_name, value = input)

    }
} 
```

**编辑**

避免`for`循环，并使用@joran 的建议`list.files`

```
dta_files <- list.files('d:/folder', pattern = '.dta', full.names = T)

lapply(dta_files, function(fname){
  input <- read.dta(fname) 
  obj_name <- tools::file_path_sans_ext(basename(fname))
  assign(obj_name, value input, env = .GlobalEnv)}) 
```

# windows - 如何使用 powershell 配置 msdtc 远程协调器主机名？

> ID：11218505
> 
> 赞同：0
> 
> 时间：2012-06-27T02:16:20.023
> 
> 标签：windows, powershell, powershell-2.0, msdtc

我正在尝试使用作为我们部署脚本的一部分的 powershell 在 17 个 Web 服务器上配置 msdtc 远程协调器主机名。但我不知道怎么做。我可以使用 comexp.msc 手动完成

以下是其他人提出的类似问题，但标记为答案的重播对我来说根本没有意义。

[http://social.technet.microsoft.com/Forums/en-US/ITCG/thread/571daa14-8180-4c79-a9de-80c628b38539#a08504e4-42cc-4de5-9262-76b3f2296536](http://social.technet.microsoft.com/Forums/en-US/ITCG/thread/571daa14-8180-4c79-a9de-80c628b38539#a08504e4-42cc-4de5-9262-76b3f2296536)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T15:20:36.413

有一堆命令可以实际帮助您在 powershell 中设置 MSDTC。看看[指南](http://msdn.microsoft.com/en-us/library/windows/desktop/hh829474%28v=vs.85%29.aspx)，如果您有任何问题，请告诉我，我会尽快回复您。

认为这是[您](http://technet.microsoft.com/en-us/library/jj128015%28v=vs.85%29)可能想要用来设置默认事务协调器的那个。

# wpf - 是否可以查询为类型注册的依赖属性？

> ID：11218508
> 
> 赞同：0
> 
> 时间：2012-06-27T02:16:31.667
> 
> 标签：wpf, dependency-properties

我想在类的静态构造函数中动态注册一些依赖属性。使用该类的类型，是否可以查询依赖属性系统以获取已注册属性的列表？

**我没有为每个依赖属性提供相应的 CLR 属性**，因为我试图将代码量保持在最低限度。

`DependencyPropertyDescriptor.GetChildProperties()`看起来它可能会有所帮助，但它是一个实例方法，并且没有用于`DependencyPropertyDescriptor`. 看起来这无论如何都会查询我没有的类型的 CLR 属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T07:54:48.647

你说 ...

> 我想在类的静态构造函数中动态注册一些依赖属性。

恐怕这是不可能的。

但是，如果您想使用反射查看依赖对象中现有的 deendency 属性，那么这是可能的......

[如何枚举控件的所有依赖属性？](https://stackoverflow.com/questions/4794071/how-to-enumerate-all-dependency-properties-of-control)

# wordpress - Wordpress - 如何将缩略图链接到管理员中分配的链接

> ID：11218516
> 
> 赞同：1
> 
> 时间：2012-06-27T02:17:02.813
> 
> 标签：wordpress

我正在尝试让我的缩略图链接到我在上传功能图像时在管理员中分配的链接。到目前为止，缩略图似乎根本没有链接。这是我拥有的代码。

```
<?php $pages = get_pages(array('child_of' => 9)); ?> 

<?php foreach ($pages as $page): ?>

     <div class="leftimage">   <?php echo get_the_post_thumbnail($page->ID, 'thumbnail'); ?></div>
     <div class="textright"><h4><b><?php echo $page->post_title; ?></b></h4>
        <?php echo $page->post_content; ?> <p></p>

        </div> 
```

任何帮助，将不胜感激！我只是不知道如何让缩略图链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T20:15:13.850

您可以创建一个`your_link_url`在编辑帖子时调用的自定义字段。然后，在您的循环中，您可以使用该自定义字段创建一个链接来包装您的特色图像。见下文：

```
<?php $pages = get_pages(array('child_of' => 9)); ?> 
<?php foreach ($pages as $page): ?>

     <div class="leftimage">
        <a href="<?php echo get_post_meta($post->ID, 'your_link_url', true) ?>">
            <?php echo get_the_post_thumbnail($page->ID, 'thumbnail'); ?>
        </a>
     </div>
     <div class="textright">
         <h4><strong><?php echo $page->post_title; ?></strong></h4>
         <?php echo $page->post_content; ?>
     </div> 
```

我还将您的`<b>`标签替换为`<strong>`并删除了一个空`<p>`标签。

# ruby-on-rails - 使用 MongoDB 进行 Rails 日志记录 - 无法运行

> ID：11218520
> 
> 赞同：1
> 
> 时间：2012-06-27T02:17:39.550
> 
> 标签：ruby-on-rails, mongodb, logging

晚上好，

我正在尝试使用“central_logger”gem 在我的 Heroku 应用程序上保存 MongoDB 中的日志。

我已经做好了：

```
gem 'central_logger'  # gemfile
include CentralLogger::Filter  # application controller 
```

我已经通过自制软件在本地机器（Mac OS X）上安装了 MongoDB。我可以进入 mongo 命令行工具。

启动应用程序时出现以下错误：

```
/Users/brandon/.rvm/gems/ruby-1.9.3-p194@myapp/gems/central_logger-0.3.3/lib/central_logger/railtie.rb:12:in `block in <class:Railtie>': undefined method `log' for #<Rails::Paths::Root:0x007fa536f1d550> (NoMethodError) 
```

有谁知道我该如何解决这个问题？

此外，当通过工头启动应用程序时，我假设我不必加载 mongo 进程（它只会连接到数据库本身，就像我假设的 Postgres 一样？）

谢谢！

# iphone - 为 Core Data 对象创建初始化程序

> ID：11218522
> 
> 赞同：0
> 
> 时间：2012-06-27T02:18:00.897
> 
> 标签：iphone, core-data

我是 Core Data 的新手，正在编写一个小测试应用程序。我想要做的是有一个可以保存到 sqlite 数据库中的对象。

我的属性看起来像：

```
@property (nonatomic, retain) NSString * address;
@property (nonatomic, retain) NSString * city;
@property (nonatomic, retain) NSNumber * latitude;
@property (nonatomic, retain) NSNumber * longitude;
@property (nonatomic, assign) CLLocationCoordinate2D coordinate;
@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSString * notes;
@property (nonatomic, retain) NSString * state;
@property (nonatomic, retain) NSString * street;
@property (nonatomic, retain) NSString * zip; 
```

这些都是 .m 文件中的@dynamic。

我最初是这样做的：

```
+ (AddressAnnotation *)initWithPlacemark:(CLPlacemark *)placemark inContext:(NSManagedObjectContext *)context {
    AddressAnnotation *anAddress = [NSEntityDescription insertNewObjectForEntityForName:@"AddressAnnotation" inManagedObjectContext:context];

    anAddress.address = placemark.subThoroughfare;
    anAddress.street = placemark.thoroughfare;
    anAddress.city = placemark.locality;
    ....
    return anAddress;
} 
```

但是，我不知道如何覆盖

```
- (NSString *)title;
- (NSString *)subtitle; 
```

对于协议，以便显示我的标注。其中一个看起来像：

```
- (NSString *)title {
    if (self.name) {
        return self.name;
    }
    else {
        return @"";
    }
} 
```

字幕非常相似，但具有其他属性。但是，这不起作用，因为这些是针对实例而不是针对类对象的，对吧？

所以我改变了我的初始化程序看起来像：

```
- (AddressAnnotation *)initWithPlacemark:(CLPlacemark *)placemark inContext:(NSManagedObjectContext *)context {

    AddressAnnotation *anAddress = [NSEntityDescription insertNewObjectForEntityForName:@"AddressAnnotation" inManagedObjectContext:context];
    NSLog(@"placemark: %@", [placemark description]);
    anAddress.address = placemark.subThoroughfare;
    anAddress.street = placemark.thoroughfare;
    ...

    return anAddress;
} 
```

但是，当我这样做时，我所有的值都是空的。在这种情况下编写初始化程序的正确方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T10:03:43.440

# oracle10g - Oracle 10G 在表中所有记录的最后添加新记录

> ID：11218523
> 
> 赞同：0
> 
> 时间：2012-06-27T02:18:04.107
> 
> 标签：oracle10g

我在oracle 10g中创建了一个表..但是在插入记录时，新插入的记录正在添加到记录中间..我只想在所有记录中最后插入新插入的记录..有什么补救措施.. .???

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:21:34.990

堆组织的表本质上是无序的。谈论“第一”行、“最后”行或“中间”行是没有意义的。行是行。只有在您指定了`ORDER BY`子句时才讨论查询中结果的顺序才有意义。否则，Oracle 以任何顺序返回结果、顺序随时间变化等都是完全正确的。

如果要按插入顺序显示行，则需要标识（或添加）提供此信息的列。然后您需要在`ORDER BY`查询中添加一个子句，即

```
SELECT *
  FROM table_name
 ORDER BY insert_date 
```

# visual-studio - 什么时候是布尔而不是布尔（编译器警告 C4800）

> ID：11218529
> 
> 赞同：2
> 
> 时间：2012-06-27T02:18:23.490
> 
> 标签：visual-studio, visual-c++

考虑这是在 MS Visual Studio 2005（可能还有其他）中编译的：

```
CPoint point1( 1, 2 );
CPoint point2( 3, 4 );
const bool point1And2Identical( point1 == point2 );            // C4800 warning
const bool point1And2TheSame( ( point1 == point2 ) == TRUE );  // no warning 
```

什么……？MSVC 编译器是不是脑死了？据我所知，TRUE 是#defined 为 1，没有任何类型信息。那么这两条线之间有什么不同呢？在这两种情况下，括号内的表达式类型肯定是相同的吗？[这部分问题现在在下面的评论中得到了令人满意的回答]

就个人而言，我认为通过使用 == TRUE 选项来避免警告是丑陋的（尽管比 != 0 替代方案更丑陋，尽管更严格正确），最好使用 #pragma warning( disable:4800 )暗示“我的代码很好，编译器是个混蛋”。同意？

注意 - 我已经看到关于 C4800 的各种讨论，讨论将整数分配给布尔值，或者将带有大薯条（拿着洋葱）的汉堡组合投射到布尔值，并想知道为什么会有奇怪的结果。对于一个看起来简单得多的问题，我找不到明确的答案……总的来说，这可能只是 C4800 的亮点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:37:38.597

[看看这个](http://msdn.microsoft.com/en-us/library/b6801kcy%28v=vs.71%29.aspx)

> 通常，此消息是由将 int 变量分配给 bool 变量引起的

`TRUE`并且`BOOL`是整数，而不是布尔值。

您还可以检查是否`(point1 == point2) != 0`或使用`!!(point1 == point2)`

**编辑**

这 ！！操作只是将结果转换为布尔值，并且由于它是双重否定的，因此您将收到相同的结果。

[之前在这里](https://stackoverflow.com/questions/206106/is-a-safe-way-to-convert-to-bool-in-c)和[这里](https://stackoverflow.com/questions/206564/what-is-the-performance-implication-of-converting-to-bool-in-c)都对此进行过讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:34:52.013

实际上你不会使用 ASSERT(point1 == point2) 吗？CPoint 类上的运算符显式重载，如果点相等则返回*非零值，否则返回 0。*著名的 ASSERT 宏让我很生气，但是如果你看看 ASSERT 宏是如何扩展的，它几乎类似于在代码中添加上面的 == TRUE。[在 msdn 上](http://msdn.microsoft.com/en-us/library/dt6813yz%28v=vs.80%29)查看此链接。请注意示例代码明确声明不直接对两个 CPoint 对象使用相等运算符。我同意您的代码看起来最正确，但这就是我们喜欢 C++ 的原因。啊...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:13:30.513

现在让我满意的答案是：

在内置类型上，运算符 == 返回 bool（根据 C++ 标准的要求）。

对于 CPoint 和许多其他 Microsoft 类型，operator == 返回 Microsoft 的 BOOL，它是 typedef'd 到一个 int。

所以...第一个 const bool 分配行尝试将一个 int 分配给一个 const bool，从而导致 C4800。

第二个 const bool 赋值行将一个 int 与值 TRUE 进行比较，该值的类型定义为 1（编译器假定为一个 int），因此 int == int 比较的结果是一个布尔值。这会在没有警告的情况下分配给 const bool。

至于屏幕上看起来最好的东西，#pragma 是丑陋且不必要的。如果你不喜欢额外的 != 0 的外观，那么试试这个：

```
#define ISTRUE( x )  ( (x) != 0 )

const bool point1And3Identical( ISTRUE( point1 == point2 ) );    // no warning 
```

从语义和句法上看，这似乎是美化代码的更好方法。您可以悄悄地将 ISTRUE() 的#define 放入头文件中，使其看起来更漂亮。

# ruby-on-rails - 为具有参考的模型创建表格

> ID：11218530
> 
> 赞同：1
> 
> 时间：2012-06-27T02:18:33.100
> 
> 标签：ruby-on-rails

我有一个引用另一个模型的模型，如下所示：

```
class Message < ActiveRecord::Base
  belongs_to :category
  attr_accessible :content
end 
```

我的表格如下所示：

```
<%= form_for(Message.new) do |f|%>
  <%= f.hidden_field :category, :value => Category.first.id %>
  <%= f.text_area :content %>
  <%= f.submit %>
<%end%> 
```

提交这个给了我：

```
ActiveRecord::AssociationTypeMismatch in MessagesController#create
Category(#70229327985340) expected, got String(#70229321568640) 
```

我该如何正确地做到这一点，以便使用正确的参考创建模型？

我已经通过将表单字段更改为`category_id`，并在模型中添加到来`category_id`使其工作。`attr_accessible`这是正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:40:14.453

使用您当前的代码，表单字段应该是`category_id`，因为这就是您要存储的内容。您没有存储对类别的引用，这是您应该做的。

它应该只是`Category.first`, 来存储类别，并保持原样。我认为这会奏效，距离我上次玩 Rails 已经有一周左右的时间了，而且我的知识并不丰富。

此外，ID 不应为`attr_accessible`，因为它们是自动分配的，不应更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:58:40.190

是的，我认为你在正确的轨道上。表单字段名称应该`category_id`并且`attr_accessible :category_id`允许您通过“批量分配”设置此值。当你这样做时使用的是哪种技术`Message.create(params[:message])`。如果没有`attr_accessible`， category_id 将被设置为 nil。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T05:00:58.353

如果您的模型定义了关联

```
 <%= form_for([@category, @message]) do |f| %>
      ...
      ...
   <% end %> 
```

其中@category = Category.find(params[:id]) 和@message = Message.new。（这些应该在您的控制器中）。这将分配外键，并且不需要隐藏字段。

# php - 我是在做梦还是回车会 阻止 PHP 版本看到代码行？

> ID：11218538
> 
> 赞同：3
> 
> 时间：2012-06-27T02:19:58.847
> 
> 标签：php, carriage-return

我最近发现在行尾只有“CR”而不是“CRLF”或“LF”的代码行导致 PHP 行为怪异，即将 2 行视为一个，忽略 CR，或者更准确地说，将其解释为：回车而不是换行。

我以前从来没有遇到过这个问题，但是最近，我发现当我按“Enter”移动到新行时，notepad++ 有时只会放一个 CR……它会导致脚本表现不佳。

例如，当使用 LF 或 CRLF 启用行但仅使用 CR 崩溃时，此 Hello World 脚本可以正常工作（至少我在 peer1 和 hostgator 服务器上都复制了该问题——其他人有不同的体验吗？）...

```
<?php
Header( "HTTP/1.1 301 Moved Permanently" );
Header( "Location: http://www.cnn.com/" );
?> 
```

我得到这个错误：

致命错误：在第 1 行的 /home/bernatch/public_html/test-redir-cr.php 中调用未定义函数 phpheader()

显然，PHP 将`<?php`代码和 Header 函数视为在同一行...

我的问题是：a) 有没有办法强制 PHP 将单个 CR 解释为真正不同的行

或者

b) 有没有办法强制记事本++ 在我按 Enter 时输入 CRLF 或 LF？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T02:43:38.607

Mac 使用 CR。Linux 使用 LF。Windows 使用 CR-LF，因此 Windows 操作系统在 CR 之后不插入 LF 会很奇怪。也许我在这里遗漏了一些东西。

在 Windows 上编辑 -> 在 Linux 上查看 = OK

在 Windows 上编辑 -> 在 Mac 上查看 = OK

所以我猜它可能是你的FTP客户端。确保将纯文本文件上传为 ASCII，而不是二进制文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:26:58.103

在 Notepad++ 中，您应该能够将 EOL 转换为 Windows 格式，如[SuperUser.com answer](https://superuser.com/q/220472)中所述。

# c - 是否有命令行工具可以从 C 或 C++ 文件中提取 typedef、结构、枚举、变量、函数？

> ID：11218539
> 
> 赞同：12
> 
> 时间：2012-06-27T02:20:00.133
> 
> 标签：c, refactoring, automation, code-generation, program-transformation

我想要一个命令行工具来从 C 或 C++ 源文件中*提取*定义或声明（typedef、结构、枚举、变量或函数）。*替换*现有定义/声明的方法也很方便（在通过用户提交的脚本转换提取的定义之后）。是否有这样的通用工具可用，或者是否有这种工具的合理近似？

编写脚本的能力和与用户创建的脚本或程序挂钩的能力在这里很重要，尽管我在学术上也对 GUI 程序感到好奇。Unix/Linux 阵营的开源解决方案是首选（尽管我也对 Windows 和 OS X 工具感到好奇）。主要语言兴趣是 C 和 C++，但更通用的解决方案会更好（我认为我们不需要超精确的解析功能来查找、提取和替换程序源文件中的定义）。

**示例用例**（额外 - 对于好奇的头脑）：

1.  给定这些类型的深度嵌套`struct`的 s 和变量（数组）初始化，假设需要通过添加或重新排序字段或以更易读的格式重写变量/数组定义来更改结构定义，而不会引入人工导致的错误。这将通过提取旧的初始化，然后使用脚本/程序编写新的初始化来替换旧的初始化来工作。
2.  为了实现代码浏览工具 - 提取定义。
3.  装饰性代码生成（例如记录函数条目/返回）。
4.  脚本代码结构（例如，提取这个和那个东西并放在不同的地方而不做任何更改 - 版本控制提交注释可以记录执行此操作的命令，以使其明显且可验证，没有任何更改）。

**替代问题：**如果有一个工具可以告诉定义的位置（开始和结束行就足够了 - 我们甚至可以假设我们感兴趣的所有定义/声明都在它们自己的行中），那么它只是一个简单的练习编写程序的手指灵巧度

1.  提取定义，
2.  替换定义，甚至
3.  提取定义，运行由命令行选项（或编辑器）指定的程序以

    *   `stdin`从（或从临时文件）接收所需的提取定义，
    *   执行转换（编辑），以及
    *   将新定义输出到`stdout`（或将它们保存到给定的临时文件）

    由正在执行的程序替换。

因此，主要的、更具挑战性的问题将是找到定义的开始和结束行。

**关于标签的注意事项：**`code-generation`比本来更准确的标签，`code-transformation`但它不存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T03:42:53.213

我们的[DMS 软件再造工具包](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)正在努力成为您想要的工具。但它正在推动最先进的技术，并不是一种必杀技工具。做真正有趣的工作就足够了。

DMS 为解析、分析和转换源代码提供了通用工具。

它使用显式语法来定义语言（例如 C 和 C++）；语法驱动构建抽象语法树（AST）的解析器。各种分析原语提供 a) 设施 [“属性语法”ATG] 用于沿着树状信息流路径收集信息，这些路径与 AST 的形状很好地匹配，b) 符号定义映射的符号使用构造 [“符号表”] , c)使用 ATG 提取的事实进行[控制和数据流分析，d) 范围分析，e) 局部和全局点分析。](http://www.semanticdesigns.com/Products/DMS/FlowAnalysis.html)这些原始分析器可用于组合来自 AST 的事实，以得出关于由 AST 表示的代码的结论（例如，“此语句修改这些变量”）。语言[前端](http://www.semanticdesigns.com/Products/FrontEnds)将语法和特定于语言的分析器打包在一个可重用的包中。DMS 具有针对各种语言的不同深度和成熟度的语言前端。

[编辑 6/27：C 和 C++ 前端支持 C 和 C++ 的特定方言：ANSIC、C99、GCC3/4 C、MS Visual C、ANSI C++98、ANSI C++11、GCC3/4 C++，MS Visual C++ 2005/2008/2010。如果你想准确分析代码，你应该使用“正确”的方言来处理你的代码。]

但“分析”不是重点。分析的目的是推动变革。DMS 提供了额外的支持以在程序上修改 AST，通过以语言的表面语法编写的[源到源重写规则](http://www.semanticdesigns.com/Products/DMS/ProgramTransformation.html)来修改 AST （均以某些选择的分析结果为条件），或对程序集和源到组集进行分组-源代码一起重写以进行复合，复杂的重写，可以进行大量代码更改，例如重新架构等。转换 AST 后，它们可用于在相应的前端重新生成（“漂亮”）语法正确的代码-结束语言/方言。[通过分段修改一种语言的 AST 直到你有另一种语言的 AST，你可以构建翻译器，但这并不像这句话所暗示的那么容易]。

这一切都在很大程度上起作用，但仍然受到某些语言复杂性的阻碍。对于 C 和 C++，一个著名的复杂性是预处理器。通过任意编辑程序文本，预处理器条件可以使源代码无法被任何类似于标准解析技术的东西解析。DMS 的 C 和 C++ 前端在一定程度上改善了这一点，并且可以使用结构良好的预处理器指令解析代码，包括一些大多数人不会称之为结构化但通常会发生的奇怪情况：

```
 #IF  cond
        if (abc)  {
   #ELSE
        if (def)  {
   #ENDIF 
```

我们在使用预处理器条件的任意位置解析代码方面取得了有趣的进展。但是一旦你这样做了，现在你所有的分析器突然不得不考虑预处理器条件，我们突然都在人们没有真正访问过的编译器的地盘上。

DMS 已被用于在大型 C++ 程序中进行重大架构转变，从非 CORBA 样式转换为具有大量代码改组的 CORBA 样式，以沿任意控制流路径提取代码以生成现有 C 代码的 SOW 样式 API，在大型 C 程序中插入工具以检测指针错误等。[它已应用于许多其他语言的其他任务]。

根据我们自己的经验，它仍然很难使用。在我们看来，这与民主是所有其他政府制度中最糟糕的制度是同一意义上的。YMMV。该网站有很多 DMS 衍生工具和讨论。

事实上，它已被用于提取函数（SOW 练习比这更通用）和插入函数（这是检测的一般情况）。

像 GCC-XML 这样的工具是 DMS 功能的影子。GCC-XML 解析、构建符号表并转储*数据*声明（不是代码），但它不能进行任何代码更改。Clang更好；它将 C 和 C++ 解析为 AST，可以对 LLVM 中间表示进行分析，并具有某种机制，用于将待应用的补丁吐出到受所需树更改启发的源文本。我不知道 Clang 是否可以进行大规模的代码转换，尤其是那些转换的结果再次转换的情况（如何修改树以获取延迟的文本补丁？）。DMS 可以整天这样做，并且可以为除 C 和 C++ 之外的许多语言执行此操作，并且可以针对它所知道的任意混合语言执行此操作。

在条件语句的预处理器问题得到解决之前，分析/转换 C 和 C++ 代码并不容易。我们只有凭借绝对的意志力和使用我们可以构建的最强大的工具才能在这些语言上成功完成这些任务。（Java 不存在这些问题，而 DMS 相应地更擅长分析/转换它）。

冒着狂妄自大的严重风险，我相信 DMS 是用于通用分析和转换的最佳工具。作为它的架构师，我将其视为我的长期工作，以使其更强大地完成这项任务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T02:49:50.483

您可能会考虑将[GCC-XML](http://www.gccxml.org/)作为开发工具的基础，就像您正在谈论的那样。我已经将它与[pygccxml](http://pypi.python.org/pypi/pygccxml)结合使用来自动提取深度嵌套的结构成员。它不会让你的工作变得轻而易举，但你肯定会比其他情况更好。

我还听到其他人提到[clang](http://clang.llvm.org/)作为编写此类工具的基础，但我自己没有机会深入研究它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T04:26:53.503

你可以看看[Clang](http://clang.llvm.org/)。他们有非平凡的源代码处理库。

# javascript - Chrome中的奇怪div溢出

> ID：11218541
> 
> 赞同：0
> 
> 时间：2012-06-27T02:20:18.380
> 
> 标签：javascript, html, css, wordpress

出于某种原因，仅在 Chrome 中，当您刷新此投资组合页面时，缩略图会中断并向下移动到页脚中。

我可以复制它的唯一方法是刷新页面。

很奇怪..可能是JS问题吗？

之前：[http ://cl.ly/463x3d0y1D1k3535162C](http://cl.ly/463x3d0y1D1k3535162C)

刷新后：[http ://cl.ly/3Y3Q1A2u3N373s0r210s](http://cl.ly/3Y3Q1A2u3N373s0r210s)

现场直播：[http ://atavist.baltimoredrew.com/?post_type=portfolio](http://atavist.baltimoredrew.com/?post_type=portfolio)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:34:20.850

看起来您正在为#portfolio 中的文章元素应用高度。

我的猜测是，在图像加载之前，您正在运行的“等高”代码运行得太早，因此您无法获得准确的高度。

在实现等高位之前，请尝试确保页面已准备就绪（已加载图像、准备好 dom 等）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:37:11.210

最奇怪的第一件事是底部的这段 html？页面：

```
<style type="text/css" class="fluid-images">img{max-width:100%;height:auto;}</style> 
```

样式标签没有类属性，所有样式都应该放在文档的顶部。

它也可能与此有关：

```
.fix::before, .fix::after, .col-full::before, .col-full::after {
    content: "\0020";
    display: block;
    height: 0;
    overflow: hidden;
} 
```

上面的代码显然是一个 css hack，但我不认识它或它的目的。

# asp.net - 在 aspx 代码中从 C# 变量设置验证器控件的文本？

> ID：11218543
> 
> 赞同：2
> 
> 时间：2012-06-27T02:20:40.393
> 
> 标签：asp.net

我的 aspx 页面中有许多 asp.net 验证控件，我不想在那里硬编码错误消息。

我想在 C# 中放置一个变量，在那里设置错误消息并设置所需字段验证的文本属性。不幸的是我不知道该怎么做。

请指导我是否可能以及如何可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:35:09.087

ASP.Net 验证控件通常派生自[BaseValidator](http://msdn.microsoft.com/en-us/library/fczazdzk)，它同时具有[Text](http://msdn.microsoft.com/en-us/library/ytkayke0)属性和[ErrorMessage](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.basevalidator.errormessage)属性。

您可以在后面的代码中设置其中任何一个。所以给定这个验证器：

```
<asp:RequiredFieldValidator id="myValidator"
   ControlToValidate="TextBox1"
   Display="Static"
   Width="100%" runat=server /> 
```

在你后面的代码中，你可以这样做：

```
var errorText = "Some Text";
var errorMessage = "It's broken yo!";

myValidator.Text = errorText;
myValidator.ErrorMessage = errorMessage; 
```

Text 属性是直接在控件中显示的内容，而 ErrorMessage 是在[ValidationSummary中显示的内容](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.validationsummary)

# php - 在新的数据库条目上播放声音

> ID：11218547
> 
> 赞同：0
> 
> 时间：2012-06-27T02:21:08.183
> 
> 标签：php, sql, ajax, jquery

所以我发现只有 1 个问题与我的类似，而答案并没有真正帮助，所以我希望用我自己的代码提问可能会帮助我找到我正在寻找的答案。

我想在发布新帖子时为我的喊话箱添加声音。我相信播放声音功能的那段代码会在这里

```
function shouts() {
                clearTimeout(getshout);
                var xmlHttp = (window.XMLHttpRequest) ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP");
                xmlHttp.open("GET", "shoutbox/shouts.php?i=" + Math.random());
                xmlHttp.onreadystatechange = function() {
                    if (this.readyState == 4) {
                        if (parseInt(this.responseText) > current_shouts) {
                            getshouts();
                            current_shouts = parseInt(this.responseText);
                        }
                        getshout = setTimeout("shouts()", 1000);
                    }
                }
                xmlHttp.send(null);
            } 
```

但我不是 100% 确定，我知道这是它检查数据库中新条目的地方，该函数调用的相应 php 代码是

```
<?php
    require_once("../config.php");
    echo implode(mysql_fetch_assoc(mysql_query("SELECT COUNT(id) FROM shout")));
?> 
```

我很确定不必为了执行此操作而触摸此代码。我已经在 Google 上进行了搜索，并检查了多个论坛，但我还没有找到真正有效的方法，我并不是要求你们为我编写代码，只是给我一个正确的方向推动！

如果还有其他需要，请告诉我，我会编辑我的帖子。

谢谢，凯西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:33:12.540

您页面上的某处有

```
<audio id="myaudio" src="shout.mp3"></audio> 
```

并在获得新的呼声时（可能在致电之前`getshouts()`）做

```
document.getElementById('myaudio').play(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T03:06:44.350

我会`audio.play()`在里面打电话`getshouts()`。

请记住，音频标签仅在最新的浏览器上受支持。查看此页面以了解您的音频标签的后备机制：http: [//code.coneybeare.net/getting-html5-audio-tag-and-flash-fallback-to](http://code.coneybeare.net/getting-html5-audio-tag-and-flash-fallback-to)

HTML

```
<audio id="audioplayer" preload>
    <source src="audio.mp3">
</audio> 
```

Javascript

```
var audioTag = document.createElement('audio');
if (!(!!(audioTag.canPlayType) && ("no" != audioTag.canPlayType("audio/mpeg")) && ("" != audioTag.canPlayType("audio/mpeg")))) {
    AudioPlayer.embed("audioplayer", {soundFile: "audio.mp3"});
}

function getshouts(){
    ... // your code

    if(success){
        audioTag.play();
    }
} 
```

这段代码未经测试，但会给你一个基本的想法。

更多资源：

*   [http://html5doctor.com/native-audio-in-the-browser/](http://html5doctor.com/native-audio-in-the-browser/)
*   [http://wpaudioplayer.com/standalone/](http://wpaudioplayer.com/standalone/)

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:35:42.990

继续 Eugene 的帖子，编辑您的 php 文件，将回复添加到 mysql 数据库并播放音乐。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-17T06:55:57.393

我的设计是显示来自单行 MySQL 表的声音文件名，并让用户可以选择播放它们。列名代表在最终应用程序中促成声音播放的事件。这是PHP代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"

  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

  <head>

    <title>Event Sounds</title>

    <link rel="stylesheet" type="text/css" href="common.css" />

  </head>

  <body>

    <h1><b>AZ Science Bowl</b> -- Back Room Operations</h1>
    <h2>Event Sounds Selected -- and Test Play</h2>

<?php
$dsn = "mysql:dbname=SciBwl_Operation_TestI";
$username = "********";

$password = "********";

try {

  $conn = new PDO( $dsn, $username, $password );

  $conn->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );

} catch ( PDOException $e ) {

  echo "Connection failed: " . $e->getMessage();

}

$sql = "SELECT * FROM SoundsSelect";

echo "<ul>";

try {

  $rows = $conn->query( $sql );

  foreach ( $rows as $row ) {

    echo "<li>For <b>Program Start:</b> " . $row["ProgStart"] . "\t<audio controls><source src=\"./sounds/" . $row["ProgStart"] . "\" type=\"audio/wav\"></audio></li>";
    echo "<li>For <b>Break & Round Start:</b> " . $row["BrkRndStart"] . "\t<audio controls><source src=\"./sounds/" . $row["BrkRndStart"] . "\" type=\"audio/wav\"></audio></li>";
    echo "<li>For <b>Toss & Bonus Start:</b> " . $row["TossBonusStart"] . "\t<audio controls><source src=\"./sounds/" . $row["TossBonusStart"] . "\" type=\"audio/wav\"></audio></li>";
    echo "<li>For <b>5 Second Warning:</b> " . $row["5SecWarn"] . "\t<audio controls><source src=\"./sounds/" . $row["5SecWarn"] . "\" type=\"audio/wav\"></audio></li>";
    echo "<li>For <b>Toss & Bonus End:</b> " . $row["TossBonusEnd"] . "\t<audio controls><source src=\"./sounds/" . $row["TossBonusEnd"] . "\" type=\"audio/wav\"></audio></li>";
    echo "<li>For <b>30 Second End of Break Warning:</b> " . $row["30SecWarn"] . "\t<audio controls><source src=\"./sounds/" . $row["30SecWarn"] . "\" type=\"audio/wav\"></audio></li>";
    echo "<li>For <b>Round End:</b> " . $row["RoundEnd"] . "\t<audio controls><source src=\"./sounds/" . $row["RoundEnd"] . "\" type=\"audio/wav\"></audio></li>";

  }

} catch ( PDOException $e ) {

  echo "Query failed: " . $e->getMessage();

}

echo "</ul>";

$conn = null;

?>

<br><br>
    </body>

</html> 
```

# javascript - Onchange 事件运行不正常

> ID：11218553
> 
> 赞同：3
> 
> 时间：2012-06-27T02:22:05.343
> 
> 标签：javascript, html, events, onchange

我创建了以下 html 页面。

```
<html>
    <head></head>
    <body>
        <input type="text" value="" id="Textbox" onchange="alert('text change');" />
        <input type="button" value="" onclick="document.getElementById('Textbox').value = 'Hello';" />
    </body>
</html> 
```

当输入的文本输入到文本框中时，onchange 事件运行良好。我编写了一个代码，当单击按钮时，“Hello”文本被输入到文本框中。但是文本框的 onchange 事件运行不佳。我怎样才能捕捉到变化事件？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T02:29:33.590

以编程方式更改值不会触发[更改事件](http://www.w3.org/TR/html401/interact/scripts.html#adef-onchange)，仅当用户聚焦元素、更改值然后将焦点放在其他位置时才会发生这种情况。

选项是手动调用 onchange 侦听器，在元素上[分派 change 事件](http://www.w3.org/TR/2011/WD-DOM-Level-3-Events-20110531/#events-EventTarget-dispatchEvent)，或者通过向上 DOM 查找具有 onchange 侦听器的父级并调用它们来手动冒泡更改事件。

这是一个似乎符合要求的答案：[手动触发 onchange 事件](https://stackoverflow.com/questions/2856513/trigger-onchange-event-manually?rq=1)

一些链接：

1.  MDN dispatchEvent（符合标准）：[https ://developer.mozilla.org/en/DOM/element.dispatchEvent](https://developer.mozilla.org/en/DOM/element.dispatchEvent)
2.  MSDN fireEvent（IE 专有）： http: [//msdn.microsoft.com/en-us/library/ie/ms536423 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/ms536423%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:32:51.630

如果要捕获每个更改，请使用 keydown 事件。如果我没记错的话，onChange 只会在输入模糊后触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:35:22.777

```
function codeThatAltersTextFieldProgrammatically() {
    /* ... code ...  */

    textFieldChangeEventHandler();
};

function textFieldChangeEventHandler(){
    /* .... */
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-27T02:31:54.130

目前根据您的代码，当您离开文本框时，该事件有效，

您需要尝试 OnKeyPress 在这里查看[http://jsfiddle.net/EBMyy/](http://jsfiddle.net/EBMyy/)

看到这个代码

```
$(document).ready(function(){
    $("#Textbox").keypress(function(){
        alert("Text Changed");
    });
});​ 
```

# grails - grails中不可预测的“无法将数据库状态与会话同步”异常

> ID：11218554
> 
> 赞同：7
> 
> 时间：2012-06-27T02:22:52.733
> 
> 标签：grails, grails-orm

我开始在我的日志中看到“无法将数据库状态与会话同步”异常，并且我很难重现它。有时它工作正常......我看到两个例外（它们发生在不同的时间）：

> 错误 JDBCExceptionReporter - 尝试获取锁时发现死锁；尝试重新启动事务错误 PatchedDefaultFlushEventListener - 无法将数据库状态与会话 org.hibernate.exception.LockAcquisitionException 同步：无法更新：[com.myapp.School#1911]

和

> 错误 PatchedDefaultFlushEventListener - 无法将数据库状态与会话 org.hibernate.StaleObjectStateException 同步：行已被另一个事务更新或删除（或未保存的值映射不正确）：[com.myapp.School#1905]

这是它们被抛出的方法：

```
def populateFriends(ArrayList<FriendView> friends, User user) {

    friends.eachWithIndex { friendView, index ->

        def friend = Friend.findByFriendId(friendView.id) ?: new Friend()
        def schoolName = friendView.schoolName
        def school = null
        if (schoolName) {
            school = School.findByName(schoolName) ?: new School(name: schoolName).save(flush:true)
        }
        if (school) {
            // add to user's school list
            user = User.get(user.id)
            user.addToSchools(school)
            user = user.merge(flush: true)
            user.save(flush: true)

            friend.school = school
        }
        friend.save(flush: true)
    }
} 
```

我整天都在这，我真的很感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T19:18:09.820

这里的答案是使用 lock:true。

```
School.findByName(name, [lock: true]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-14T17:00:54.140

尝试：

```
User.withTransaction {
    ...
    user.save(flush:true)
    sessionFactory.currentSession.flush()
    sessionFactory.currentSession.clear()
} 
```

# php - .htaccess 重定向循环，添加多个 .php 扩展名

> ID：11218555
> 
> 赞同：0
> 
> 时间：2012-06-27T02:22:53.750
> 
> 标签：php, .htaccess, mod-rewrite

我为我的学校建立了一个小型家长/教师社交网络。我使用我的`.htaccess`文件使指向教师资料的链接更清晰，并在所有 url 中添加尾部斜杠。转到`/teachers/teacher-name/`链接（有时）重定向到`/teachers/teacher-name.php.php.php.php.php.php.php.php...`以下是我的`.htaccess`文件时，我遇到了这个问题。有时，如果我在 Chrome 中清除浏览器缓存，它会暂时修复它。我不能完全正确的`.htaccess`语法，但我很熟悉它。任何建议表示赞赏！

```
RewriteEngine on
RewriteBase /

#remove php ext
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/]+)/$ $1.php
RewriteRule ^([^/]+)/([^/]+)/$ $1/$2.php

#force trailing slash/
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteRule ^(.*)([^/])$    /$1$2/ [L,R=301]

#other rewrites
RewriteRule ^teachers/([^/\.]+)/$ /teachers/profile.php?u=$1
RewriteRule ^teachers/([^/\.]+)/posts/$ /teachers/posts.php?u=$1
RewriteRule ^teachers/([^/\.]+)/posts/([^/\.]+)/$ /teachers/post.php?u=$1&p=$2

RewriteRule ^gallery/([^/\.]+)/$ /gallery/album.php?n=$1
RewriteRule ^gallery/([^/\.]+)/slideshow/$ /gallery/slideshow.php?n=$1
RewriteRule ^gallery/([^/\.]+)/([^/\.]+)/([^/\.]+)/$ /gallery/photo.php?a=$1&p=$2&e=$3 
```

**编辑**：我附上了我在说什么的截图。 ![在此处输入图像描述](../Images/3eac77da5eceb49fb71fa6924d4b5156.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:33:39.437

这应该是因为您决定添加斜杠：

```
#force trailing slash/
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteRule ^(.*)([^/])$    /$1$2/ [L,R=301] 
```

而不是这个，你可能想写这个：

```
#force trailing slash/
RewriteCond %{REQUEST_FILENAME} !-f
#the following rule only works for .php obviously, so add other rules
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule ^(.*)([^/])$    /$1$2/ [L,R=301] 
```

并且因为你使用了 301 重定向，浏览器最有可能缓存重定向，所以你可能需要在它工作之前清除浏览器缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:31:20.243

在 .php 规则的末尾添加一个`[L]`以确保 mod_rewrite 停止处理。

通常，当您找到与规则匹配的类型时，它是您唯一希望根据您的请求运行的匹配项。您的最后六个规则也是这方面的示例，除了您可以在它们上不使用它，因为它们不会相互重叠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T19:18:50.327

再看一遍，我看到了一个不同的错误。您显然有两条规则试图共享条件。这不起作用。每个规则必须有自己的条件

```
#remove php ext
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/]+)/$ $1.php
RewriteRule ^([^/]+)/([^/]+)/$ $1/$2.php #this rule will always run 
```

应该改为

```
#remove php ext
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/]+)/$ $1.php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/]+)/([^/]+)/$ $1/$2.php #this rule will always run 
```

但是，除此之外，您是否要添加`.php`到以 ? 结尾的 URL 中`/`？

```
RewriteRule ^([^/]+)/$ $1.php 
```

# django - 使用 django 将通过“www.domain.com”连接到“domain.com”的客户端重定向

> ID：11218556
> 
> 赞同：0
> 
> 时间：2012-06-27T02:22:58.010
> 
> 标签：django

似乎指向我页面的谷歌链接包含“www”。在域之前，这会导致安全错误，因为我正在从画布读取数据，如果图像来自“www.x.com”而不是“x.com”，它们将被标记为跨域。

所以我想知道将人们从带有www的url重定向的最好方法是什么。在它对一个没有？

（或者，我可以让谷歌在没有 www 的情况下链接吗？）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T04:18:59.737

最好的方法是让您的网络服务器（apache/nginx）处理重定向，而不是在 Django 中进行。

在 nginx 中，它可能看起来像这样：

```
server {
        listen 80;
        server_name www.example.com;
        rewrite ^(.*) http://example.com:80$1 permanent;
} 
```

当然你可以在 Django 中做，只需检查子域的存在，`www`然后重定向到没有这个子域的相同 URL。在这种情况下，您需要将此逻辑添加到所有视图中（例如，可能是装饰器）。尽管如此，它还是很难维护，而更好更简单的方法是我上面提到的方法。

# jquery - 通过jquery将元素添加到表中

> ID：11218558
> 
> 赞同：0
> 
> 时间：2012-06-27T02:23:06.370
> 
> 标签：jquery

我有一张桌子，有一排。我想用 jquery 将我的脚本的可能条件添加到行中。这是我的示例代码：

```
<script type="text/javascript" language="javascript">
  function loadContent() {
    var $parent = $("#productlist").empty(); //empty div
    $parent.append('<br /><table id="myTable" cellpadding="0" cellspacing="0" width="100%" class="productlist" style="margin-left:4px; padding-top:2px;"><tbody></tbody></table>');
    if (k % 3 == 0 && k == 0) {
        var $table = $parent.find("#myTable > tbody");
        var htmlRow = [
                      '<tr align="center">',
                      '<td align="center" id="colunm-product">',
                       //some data
                       '</td>'];
        $table.append(htmlRow.join(''));
    } else if ((k % 3 == 0) && (k != 0)) {
       //add more <td>
    } else {
       //close </tr>
    }
</script> 
```

我可以创建`<tr>`和添加更多`<td>`，在可能的情况下，我会追加`</tr>`吗？

请问有什么意见吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:37:20.780

`<td>`您应该将该行构造为一个 jQuery 对象，然后在需要时附加其他对象。

然后最后将该行附加到表中。

```
if (k % 3 == 0) {
  var $table = $parent.find("#myTable > tbody");
  // htmlRow as jQuery object.
  var htmlRow = $([
    '<tr align="center">',
       '<td align="center" id="colunm-product">',
           //some data
       '</td>',
    '</tr>'].join('')
   );

  if(k != 0) {
    htmlRow.append([
       '<td>',
        // More Data
       '</td>'
       ].join(''));
  }

  // Add completed row here
  $table.append(htmlRow);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:39:33.067

```
var htmlRow = [];
if (k % 3 == 0 && k == 0) {
    var $table = $parent.find("#myTable > tbody");
   htmlRow.push(
       '<tr align="center">',
       '<td align="center" id="colunm-product">some data</td>');
    } else if ((k % 3 == 0) && (k != 0)) {
        htmlRow.push('<td align="center" id="colunm-product-2">Data 1</td>',
                     '<td align="center" id="colunm-product-3">Data 2</td>',
                     '<td align="center" id="colunm-product-2">Data 3</td>');
    } else {
        htmlRow.push('</tr>');
        $table.append(htmlRow.join(''));
    } 
```

或者你的字符串连接

```
var htmlRow = '';
if (k % 3 == 0 && k == 0) {
    var $table = $parent.find("#myTable > tbody");
    htmlRow += '<tr align="center">'+
                '<td align="center" id="colunm-product">some data</td>';
} else if ((k % 3 == 0) && (k != 0)) {
    htmlRow +=
        '<td align="center" id="colunm-product-2">Data 1</td>'+
        '<td align="center" id="colunm-product-3">Data 2</td>'+
        '<td align="center" id="colunm-product-2">Data 3</td>';
} else {
    htmlRow += '</tr>';
    $table.append(htmlRow);
} 
```

**[工作样本](http://jsfiddle.net/QStkd/503/)**

# android - 无论如何在android应用程序上模拟谷歌地图？

> ID：11218560
> 
> 赞同：0
> 
> 时间：2012-06-27T02:23:49.567
> 
> 标签：android, google-maps, gps

我正在做关于地图导航的项目。目前，我可以很好地使用带有 GPS 和信号路线指示的地图视图。但无论如何我都找不到，在地图上显示所有可能的选择，比如网络上的谷歌地图。

例如，我喜欢搜索我所在地区周围的餐馆，所以我在搜索栏中输入“餐馆”并搜索它，地图会显示我当前的位置（我已经这样做了）并显示我所在地区附近的所有可能餐馆. 之后我选择了一家餐厅，地图会绘制从我的位置到餐厅的路线（我也这样做过）

我花了很多时间在互联网上搜索，但找不到任何关于此的关键示例，有没有我可以参考的教程？

我应该使用“webview”直接在应用程序上显示谷歌地图网页吗？

我也遇到其他问题，我使用下面的方式在地图上指示我的路线，它假设在我的应用程序上绘制路线，但是手机会直接打开谷歌地图并在谷歌地图上绘制路线，我这样做这错了吗？有没有更好的办法？

```
Intent intent = new Intent();
intent.setAction(android.content.Intent.ACTION_VIEW);
intent.setData(
Uri.parse("http://maps.google.com/maps?f=d&saddr="
+GeoPointToString(fromGeoPoint)
+"&daddr="
+GeoPointToString(toGeoPoint)
+"&hl=cn")
);
startActivity(intent); 
```

我是android编程的新手，希望这不是一个愚蠢的问题，希望你能帮助我。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:34:50.157

如果您尝试使用 Google Maps 制作应用程序，您应该使用 Google Maps API！

[https://developers.google.com/maps/documentation/android/](https://developers.google.com/maps/documentation/android/)

您应该能够通过 Eclipse 中的 SDK 管理器下载它，或者手动安装它。我现在在工作中使用它，但请注意，您不能使用这些地图制作商业应用程序进行导航。

# voip - 是否有针对 TTS 和 ASR 的行业接口标准？

> ID：11218563
> 
> 赞同：2
> 
> 时间：2012-06-27T02:24:04.080
> 
> 标签：voip, text-to-speech

我被要求在我们的产品中开发一个文本到语音模块，它应该支持各种文本到语音引擎。

是否有标准描述如何与第三方 TTS（文本到语音）服务或 ASR（自动语音识别）服务交互？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T13:12:20.703

大多数 ASR 使用[媒体资源控制协议 (MRCP)](https://datatracker.ietf.org/doc/html/draft-ietf-speechsc-mrcpv2-27)作为其接口的标准。它也可以用于 TTS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-13T05:55:44.463

这取决于您的目的或您将使用 ASR 和 TTS 的领域。

如果您将在呼叫中心等 IVR（交互式语音响应）应用程序中使用 MRCP，则可以使用 MRCP 来控制 ASR、TTS 媒体资源，在这种情况下，您可以将 MRCP 服务器与语音网关（如 CISCO 和 VXML 服务器）连接起来。一个著名且常见的 MRCP 实现是[unimrcp](http://www.unimrcp.org/)，它是协议的 C 实现，它是一个良好且稳定的开源项目。

但最后，正如我所说，这取决于您的目的，您可能永远不需要使用 MRCP，如果它可以单独工作，您可以将 TTS 引擎用作独立服务器。

著名的开源 TTS 引擎是用 Java 编写的[Mary TTS](http://mary.dfki.de/) ，用 C++ 编写的[Festival 。](http://www.cstr.ed.ac.uk/projects/festival/)

著名的开源 ASR 引擎是用 Java 编写的[cmu Sphinx4](http://cmusphinx.sourceforge.net/sphinx4/) ，用 C 编写的[Julius 。](http://julius.sourceforge.jp/en_index.php/)

# javascript - 如何强制 jQuery Mobile 在每次加载页面时运行我的 js 代码？

> ID：11218567
> 
> 赞同：0
> 
> 时间：2012-06-27T02:24:12.720
> 
> 标签：javascript, jquery-mobile

我注意到在某些时候我的某些页面的行为不像我预期的那样。似乎没有运行我的 js 代码，它是这样的：

```
 // DB
 db_manager = new DB_MANAGER();
 db_manager.open(function(){
    if(db_manager.db){
       db_manager.activitati.getAllByStatus(0, function(list){
        uiHelper.showActivitati(list, $('#listView'));
        $('#listView').listview("refresh");
       })   
    }           
 }); 
```

我怎样才能强制它运行？

# java - 如何使用 Shiro 创建基于密码的密码？

> ID：11218568
> 
> 赞同：1
> 
> 时间：2012-06-27T02:24:16.403
> 
> 标签：java, security, shiro

我创建了一种方法，可以让我使用密码加密和解密对象。但是，我使用的是 Java 的本机加密库，但这些库不是很安全。（对于我试图序列化的对象的微小变化，我从总共 243 个加密字节中得到 208 个相同的字节。）我认为[Shiro](http://shiro.apache.org/cryptography-features.html)有替代品，但我似乎找不到它们（至少在 1.1.0用于基于密码的加密）。这是我的加密代码。我将密码值注入到类中，并省略了任何异常处理以使事情变得更简单：

```
public String encryptToString(Serializable object) {
    SecretKeyFactory keyFactory =
            SecretKeyFactory.getInstance(ALGORITHM);
    KeySpec keySpec = new PBEKeySpec(password.toCharArray());
    SecretKey secretKey = keyFactory.generateSecret(keySpec);
    PBEParameterSpec paramSpec = new PBEParameterSpec(SALT, ITERATIONS);

    Cipher cipher = Cipher.getInstance(ALGORITHM);
    cipher.init(Cipher.ENCRYPT_MODE, secretKey, paramSpec);
    // Serialize map
    final ByteArrayOutputStream byteArrayOutputStream =
            new ByteArrayOutputStream();
    CipherOutputStream cout =
            new CipherOutputStream(byteArrayOutputStream, cipher);
    ObjectOutputStream out = new ObjectOutputStream(cout);
    out.writeObject(object);
    out.close();
    cout.close();
    byteArrayOutputStream.close();
    return new String(
            Base64.encode(byteArrayOutputStream.toByteArray()));
} 
```

我的解密代码：

```
public Object decryptToObject(String encodedString) {
    SecretKeyFactory keyFactory =
            SecretKeyFactory.getInstance(ALGORITHM);
    KeySpec keySpec = new PBEKeySpec(password.toCharArray());
    SecretKey secretKey = keyFactory.generateSecret(keySpec);
    PBEParameterSpec paramSpec = new PBEParameterSpec(SALT, ITERATIONS);
    Cipher decipher = Cipher.getInstance(ALGORITHM);
    decipher.init(Cipher.DECRYPT_MODE, secretKey, paramSpec);
    final ByteArrayInputStream byteArrayInputStream =
            new ByteArrayInputStream(Base64.decode(encodedString
                    .getBytes()));
    CipherInputStream cin =
            new CipherInputStream(byteArrayInputStream, decipher);
    ObjectInputStream in = new ObjectInputStream(cin);
    Object result = in.readObject();
    in.close();
    cin.close();
    byteArrayInputStream.close();
    return result;
} 
```

# tfs - TFS 构建定义未将 Web 应用程序部署到 IIS

> ID：11218577
> 
> 赞同：4
> 
> 时间：2012-06-27T02:25:57.247
> 
> 标签：tfs, tfsbuild, visual-studio-2012, webdeploy, build-definition

我目前正在尝试获取 TFS 构建定义以自动将我的 Web 应用程序部署到服务器。构建定义只是一个标准的手动构建定义。

我已经在团队资源管理器中为我的项目正确创建了构建定义，并且当我将构建排队时，它成功完成。

我已将 Build process parameters 部分中的 MSBuild Arguments 属性设置为：

```
/p:DeployOnBuild=True 
/p:Configuration="Release" 
/p:DeployTarget=MSDeployPublish 
/p:MSDeployPublishMethod=WMSVC 
/p:MsDeployServiceUrl=myserver.com 
/p:DeployIISAppPath="Default Web Site" 
/p:username=username 
/p:password=password 
/p:AllowUntrustedCertificate=True 
/p:SkipExtraFilesOnServer=True 
```

但是，当我在 IIS 中查看我的 Web 应用程序时，应该存在的文件丢失了，例如 web.config 文件。

在 Visual Studio 中右键单击我的 Web 应用程序并通过 Web Deploy 发布，使用上述设置可以正常工作，并且已发布的 web.config 和其他文件显示在 Web 根目录中。

这只是一个开发服务器，所以 TFS 和 IIS 安装在同一台机器上，将 /p:MsDeployServiceUrl 更改为 localhost 也没有效果。

构建定义中是否缺少某些内容，或者是获取 TFS 构建以部署我的 Web 应用程序所需的参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T00:14:00.747

您声明的所有属性看起来都不错，但服务 URL 除外。它需要指向目标服务器上管理服务的完整路径。

```
/p:MsDeployServiceUrl=https://yourserver:8172/msdeploy.axd 
```

管理服务的默认端口是 8172，但如果您的目标设置不同，则需要进行调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T00:22:00.230

我会说摆脱这`/p:Configuration="Release"`部分。

然后去`Process > 1\. Required > Items to Build > Configurations to Build`那里设置配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T19:40:17.520

例如，您是否尝试为 IIS 使用完整路径`/p:DeployIISAppPath="Default Web Site/mywebapp`

# mysql - 无法连接到本地主机之外的 MySQL 客户端

> ID：11218580
> 
> 赞同：0
> 
> 时间：2012-06-27T02:26:31.703
> 
> 标签：mysql

由于某种原因，我无法连接到服务器外部的 mysql 数据库。服务器上运行的 PHP 应用程序能够通过 localhost 进行连接，但不能通过我家用计算机上的 mysql 客户端进行连接。下面是我的配置。你能告诉我我做错了什么吗？

```
#
# The MySQL database server configuration file.
#
# You can copy this to one of:
# - "/etc/mysql/my.cnf" to set global options,
# - "~/.my.cnf" to set user-specific options.
#
# One can use all long options that the program supports.
# Run program with --help to get a list of available options and with
# --print-defaults to see which it would actually understand and use.
#
# For explanations see
# http://dev.mysql.com/doc/mysql/en/server-system-variables.html

# This will be passed to all mysql clients
# It has been reported that passwords should be enclosed with ticks/quotes
# escpecially if they contain "#" chars...
# Remember to edit /etc/mysql/debian.cnf when changing the socket location.
[client]
port            = 3306
socket          = /var/run/mysqld/mysqld.sock

# Here is entries for some specific programs
# The following values assume you have at least 32M ram

# This was formally known as [safe_mysqld]. Both versions are currently parsed.
[mysqld_safe]
socket          = /var/run/mysqld/mysqld.sock
nice            = 0

[mysqld]
#
# * Basic Settings
#
user            = mysql
pid-file        = /var/run/mysqld/mysqld.pid
socket          = /var/run/mysqld/mysqld.sock
port            = 3306
basedir         = /usr
datadir         = /var/lib/mysql
tmpdir          = /tmp
lc-messages-dir = /usr/share/mysql
skip-external-locking
#
# Instead of skip-networking the default is now to listen only on
# localhost which is more compatible and is not less secure.
bind-address            = 0.0.0.0
#
# * Fine Tuning
#
key_buffer              = 16M
max_allowed_packet      = 16M
thread_stack            = 192K
thread_cache_size       = 8
# This replaces the startup script and checks MyISAM tables if needed
# the first time they are touched
myisam-recover         = BACKUP
#max_connections        = 100
#table_cache            = 64
#thread_concurrency     = 10
#
# * Query Cache Configuration
#
query_cache_limit       = 1M
query_cache_size        = 16M
#
# * Logging and Replication
#
# Both location gets rotated by the cronjob.
# Be aware that this log type is a performance killer.
# As of 5.1 you can enable the log at runtime!
#general_log_file        = /var/log/mysql/mysql.log
#general_log             = 1
#
# Error logging goes to syslog due to /etc/mysql/conf.d/mysqld_safe_syslog.cnf.
#
# Here you can see queries with especially long duration
#log_slow_queries       = /var/log/mysql/mysql-slow.log
#long_query_time = 2
#log-queries-not-using-indexes
#
# The following can be used as easy to replay backup logs or for replication.
# note: if you are setting up a replication slave, see README.Debian about
#       other settings you may need to change.
#server-id              = 1
#log_bin                        = /var/log/mysql/mysql-bin.log
expire_logs_days        = 10
max_binlog_size         = 100M
#binlog_do_db           = include_database_name
#binlog_ignore_db       = include_database_name
#
# * InnoDB
#
# InnoDB is enabled by default with a 10MB datafile in /var/lib/mysql/.
# Read the manual for more InnoDB related options. There are many!
#
# * Security Features
#
# Read the manual, too, if you want chroot!
# chroot = /var/lib/mysql/
#
# For generating SSL certificates I recommend the OpenSSL GUI "tinyca".
#
# ssl-ca=/etc/mysql/cacert.pem
# ssl-cert=/etc/mysql/server-cert.pem
# ssl-key=/etc/mysql/server-key.pem

[mysqldump]
quick
quote-names
max_allowed_packet      = 16M

[mysql]
#no-auto-rehash # faster start of mysql but no tab completition

[isamchk]
key_buffer              = 16M

#
# * IMPORTANT: Additional settings that can override those from this file!
#   The files must end with '.cnf', otherwise they'll be ignored.
#
!includedir /etc/mysql/conf.d/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:30:21.853

主要有两点需要检查：

*   中间是否有防火墙阻止连接？从您的客户端，您可以尝试`telnet myServerName 3306`查看是否可以连接。请参阅[http://dev.mysql.com/doc/refman/5.5/en/can-not-connect-to-server.html](http://dev.mysql.com/doc/refman/5.5/en/can-not-connect-to-server.html)
*   您尝试连接的用户是否允许从您的主机连接？有关这方面的更多信息，请参阅[http://dev.mysql.com/doc/refman/5.1/en/create-user.html](http://dev.mysql.com/doc/refman/5.1/en/create-user.html)和[http://dev.mysql.com/doc/refman/5.1/上的 MySQL 文档en/account-names.html](http://dev.mysql.com/doc/refman/5.1/en/account-names.html)，特别是`Syntax for account names is 'user_name'@'host_name'.` 如果您希望能够从*任何*计算机连接给定帐户，则帐户名称将遵循类似的语法`'user_name'@'%'`，其中`%`是与任何主机名匹配的通配符。

# php - PHP - 多次显示随机输出，防止重复

> ID：11218585
> 
> 赞同：0
> 
> 时间：2012-06-27T02:27:50.840
> 
> 标签：php, arrays, random, include

我有以下代码用于随机显示文件夹中的 PHP 小部件：

```
<?php 
function random_widget($dir = 'wp-content/themes/zonza/elements')
{
    $files = glob($dir . '/*.*');
    $file = array_rand($files);
    return $files[$file];
}
?>

<?php include random_widget();?>
<?php include random_widget();?>
<?php include random_widget();?> 
```

随机小部件（）；输出一个 URL，然后我在 include 函数中使用它来显示小部件。

代码在 6 个 php 文件中随机选择并随机显示一个。我将它包含 3 次以获得 3 个小部件。但是，有时我会多次显示相同的小部件。

我可以做些什么来修改代码以防止这种情况发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:32:11.223

试试这个：

```
<?php 
function random_widget($dir = 'wp-content/themes/zonza/elements')
{
    static $files = false;
    if(!$files) $files=glob($dir . '/*.*');
    $key = array_rand($files);
    $file=$files[$key];
    unset($files[$key]);
    return $file;
}
?> 
```

它的工作原理是删除从 $files 返回的文件，并在多个函数调用中维护 $files（它仅在您第一次调用该函数时使用 globs()）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:32:50.773

在页面开头声明文件`$files = glob($dir . '/*.*');` 在 random_widget 中，`unset($files[$file])`在拉取值后执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T02:34:57.920

`array_rand`将数字`$num_req`作为可选的第二个参数，它指定要选择的条目数。因此，将此参数添加到`random_widget`，将其传递给以`array_rand`获取键数组而不是单个键，返回文件数组，然后遍历该数组以包含小部件（而不是调用`random_widget`三次）。

```
<?php 
function random_widget($num_req, $dir = 'wp-content/themes/zonza/elements')
{
    $files = glob($dir . '/*.*');
    $keys = array_rand($files, $num_req);

    $chosen = array();

    foreach($keys as $key) {
        $chosen[] = $files[$key];
    }

    return $chosen;
}

$widgets = random_widget(3);
foreach($widgets as $widget) {
    include $widget;
}

?> 
```

与其他答案中提出的解决方案相比，此解决方案的一个优点是它是无状态的：您可以根据需要在不同的上下文中重用该函数。

来源： http: [//php.net/manual/en/function.array-rand.php](http://php.net/manual/en/function.array-rand.php)

# java - 使用 java 连接到远程数据库

> ID：11218588
> 
> 赞同：0
> 
> 时间：2012-06-27T02:28:21.270
> 
> 标签：java, database

我计划使用一个网络托管包来托管一个网站，该网站向将在该网站注册的客户显示客户详细信息。我有一个在本地计算机上运行的 java 应用程序，我将更新托管网站的数据库。需要知道的是，是否可以从我们本地运行的 java 应用程序连接到我们从网络托管包卖家那里购买的数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:40:22.207

问：是否可以从我们本地运行的 Java 应用程序连接到我们从网络托管包卖家那里购买的数据库？

A：不：通常不会。

在*MINIMUM*中，您至少需要*两*件事：

1) 加载到*每台*客户端 PC上的 RDBMS 特定客户端软件（包括但不一定限于相关的 JDBC 驱动程序）

... 和 ...

2) 远程 RDBMS 服务器和您的每台客户端 PC 之间的所有防火墙都必须对您的 RDBMS 协议开放（例如，MS Sql Server 的端口 1433）。

您的 Web 应用程序、Web 服务器和 RDBMS 位于同一位置更为常见，您的客户端只需通过 HTTPS 进行通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T02:40:22.003

是的，可以使用 java 应用程序连接到远程数据库。这`JDBC API`将帮助您创建表、插入值、查询表、检索查询结果以及更新表。

就远程连接而言，这里有两个很好的链接：

1)[链接 1](https://www.ibm.com/developerworks/mydeveloperworks/blogs/738b7897-cd38-4f24-9f05-48dd69116837/entry/programmatically_connecting_to_remote_systems2?lang=en)

2)[链接 2](http://docstore.mik.ua/orelly/java-ent/dist/ch07_02.htm)

您尚未指定需要连接的数据库类型。根据这些，您可以了解如何创建数据源、数据库角色等，如此[处所示](http://docs.oracle.com/cd/E11882_01/java.112/e10589/urls.htm)。

# git - 使用现有文件的工作树创建裸仓库

> ID：11218591
> 
> 赞同：1
> 
> 时间：2012-06-27T02:28:42.097
> 
> 标签：git, deployment, ssh

我的远程服务器上有一个已经在工作的非 git 目录 ( `/var/www/site1`)，我使用 ftp 对其进行了更改，但我想使用 git。所以这就是我所做的：

```
cd ~/git/site1.git
git init --bare
cat > hooks/post-receive
#!/bin/sh
GIT_WORK_TREE=/var/www/site1 git checkout -f
$ chmod +x hooks/post-receive 
```

如何将文件添加到 git repo 以便我可以将文件拉到本地目录？我试过：

```
git remote add ssh://root@remote:3756/git/site1.git site1
git pull site1 +master:refs/heads/master
fatal: Couldn't find remote ref master 
```

我也试过：

```
git clone ssh://root@remote:3756/git/site1.git site1
Cloning into 'site1'...
warning: You appear to have cloned an empty repository. 
```

我正在关注本教程：[http ://toroid.org/ams/git-website-howto](http://toroid.org/ams/git-website-howto)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:45:11.457

将文件下载到您的计算机，克隆存储库，将文件复制到存储库文件夹，提交文件，然后推送到服务器。但是，如果您要使用 git 将文件上传到网站，请不要使用它，因为这些文件不是直接可见的。

# c++-cli - 用于 istream 的 C++/CLI 包装器

> ID：11218592
> 
> 赞同：1
> 
> 时间：2012-06-27T02:28:42.950
> 
> 标签：c++-cli, wrapper, iostream

我有一个本地 C++ 库，我需要用 C++/CLI 进行包装，以便现有的 C# 应用程序可以看到 .NET 接口。到目前为止，我一直做得很好，但我不知道如何处理以 an`istream`作为参数的方法。

是否有现有的包装器`istream`？也许（最好）到`System::IO::Stream`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T15:13:43.520

我发现包装 istream 通常是不必要的。我只是创建一个 System::StringBuilder 缓冲区并存储所有输入，直到它准备好。然后，我转换 System::StringBuilder^ -> System::String^ -> std::string -> std::stringstream 并将 stringstream 作为 arg 发送。

# eclipse - egit替换单个文件-git索引中的HEAD修订与文件

> ID：11218596
> 
> 赞同：15
> 
> 时间：2012-06-27T02:29:26.480
> 
> 标签：eclipse, git, egit, git-reset

在 egit git eclipse 插件中，我知道我可以通过右键单击单个文件并选择 Replace With > HEAD Revision 来“重置”单个文件。用 HEAD 版本替换与 git index 中的文件有什么区别？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-27T02:38:54.690

`HEAD`是已经提交的文件的版本。

索引是已暂存（添加）以准备提交但尚未提交的文件版本。

# php - (Redbean) 无法访问链接表值

> ID：11218598
> 
> 赞同：0
> 
> 时间：2012-06-27T02:29:33.373
> 
> 标签：php, orm, redbean

我正在测试 Redbean ORM。我喜欢它的工作方式，对我来说工作量少:) 我正在使用他们网站上的 redbean books 示例。我已经能够创建带有作者和标题的新书，并将它们毫无问题地显示到页面上。我添加了另一个维度来学习如何将页面链接到我的书籍。

我可以在书表中添加一个条目，也可以使用以下代码在页表中添加一个条目：

```
----------- dbmgmt.php ---------------------------------

function AddNewBook($FORMINFO){
   $newBook = R::dispense('book');
   $newBook->title = $FORMINFO['title'];
   $newBook->author = $FORMINFO['author']; 
   $newBook->create_date = R::isoDateTime();

   $newPage = R::dispense('page');
   $newPage->pagetext = $FORMINFO['pagetext'];
   $newBook->ownPage = $newPage; 

   $id = R::store($newBook);

   return R::load('book', $id);
} 
```

两个表都显示了正确的条目（新的 id 和填充的字段）。但是，我很难从页表中访问 pagetext 字段。这是我一直在使用的代码：

```
----------- dbmgmt.php ---------------------------------

function GetBooks($id){
  if($id == ""){
     return R::find('book');
  }
  else{
     return R::find('book','id = ?', array($id));
  }
}

----------- GetBooks.php ---------------------------------

 $id = "";
 if(isset($_GET['id'])){
   $id = $_GET['id'];
 }

 $books = GetBooks($id);
 $booklist = "";

 foreach($books as $book){
    $pagetext = "";

    foreach($book->ownPage as $page){
         $pagetext .= $page->pagetext;   //Errors with "Notice: Trying to get property of non-object"
    }

    $booklist .=  "<tr id='$book->id'><td><a class='linkEdit' href='edit.php?id=$book->id'><img src='http://cdn1.iconfinder.com/data/icons/ledicons/page_white_edit.png' /></a> <span class='book-title'>$book->title</span></td><td><span class='book-author'>$book->author</span></td><td><span class='page-text'>$pagetext</span></td></tr>";    
 }

 echo $booklist;
 ------------------------------------------------------------ 
```

当我 print_r($book->ownPage) 时，我什至看不到通过 phpmyadmin 在页表中可以清楚看到的页条目。我已经尝试了许多不同的方法来通过上面的脚本访问 pagetext 字段，但无法使用它。

任何见解都将受到欢迎。否则我将不得不尝试不同的，尽管更大更麻烦的 ORM。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T19:01:57.360

我不是 100% 确定，因为我自己还没有遇到这个问题，但我几乎是肯定的，`$book->ownPage`需要是一个数组：

```
$newPage = R::dispense('page');
$newPage->pagetext = $FORMINFO['pagetext'];
$newBook->ownPage[] = $newPage; 

$id = R::store($newBook); 
```

# python - Scrapy 处理 cookie/会话/代理

> ID：11218600
> 
> 赞同：2
> 
> 时间：2012-06-27T02:29:48.023
> 
> 标签：python, session-cookies, scrapy

我正在研究一个在经过身份验证时抓取网站的蜘蛛，它使用多个用户和多个代理。无论如何我可以处理 cookie、代理和会话，以便每个用户使用特定的 cookie 和特定的代理，这样抓取东西就没有问题吗？

目前，我能够在经过身份验证和单个 IP 的情况下与一个用户一起爬网，但希望对更多用户执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:03:05.513

这是可能的，尽管它需要一些工作。

我可以想到两种方法来实现这一点：

1.  手动调整每一个`Request`，`Response`这似乎更简单
2.  写一个中间件，比较复杂，但是比较通用

在这两种情况下，此信息都应该有帮助：

*   使用[dont_merge_cookies](http://doc.scrapy.org/en/latest/topics/request-response.html#request-meta-special-keys)和[CookieJar](https://stackoverflow.com/a/6437196/248296)
*   您可以为每个请求[设置一个代理](https://stackoverflow.com/a/10849429/248296)

# rabbitmq - 在 RabbitMQ 中处理消费者取消通知

> ID：11218603
> 
> 赞同：4
> 
> 时间：2012-06-27T02:30:44.687
> 
> 标签：rabbitmq

我们按照[http://www.rabbitmq.com/ha.html](http://www.rabbitmq.com/ha.html)中的说明设置了一个具有 3 个节点 rabbit1、rabbit2 和 rabbit3 的主动-主动集群。为了创建镜像队列，我们​​使用 x-ha-policy 并获取消费者取消通知，我们在 clientProperties 中为 consumer_cancel_notify 设置了 true。现在，我们以 rabbit2 为 master 将消息发布到队列，并让消费者从 rabbit3 消费。当 rabbit2 停止时，连接到 rabbit3 的消费者不会收到取消通知。

我们使用的是 rabbitmq 2.8.2-1，我们的 java 消费者 POC 代码在这里 - [https://gist.github.com/2990146](https://gist.github.com/2990146)

不确定我们做错了什么。任何指针将不胜感激。

有没有人尝试使用 php-amqplib 处理取消通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-31T02:31:55.913

你的要点第 22 行是个问题。consumer_cancel_notify 需要位于 clientProperties 的功能表中，而不是顶级键。

```
clientProperties.put("consumer_cancel_notify", Boolean.valueOf(true)); 
```

> AMQP 0-9-1 客户端默认不期望从代理异步接收 basic.cancel 方法，因此为了启用此行为，客户端必须在其 **客户端属性中提供一个****功能表**，其中有一个键**consumer_cancel_notify**和一个布尔值 true。有关这方面的更多详细信息，请参阅功能部分。 [http://www.rabbitmq.com/extensions.html#consumer-cancel-notify](http://www.rabbitmq.com/extensions.html#consumer-cancel-notify)

 ****Handwaving pseudo-java（请在测试后编辑此答案）

```
Map<String, Object> clientProperties = new HashMap<String, Object>();
Map<String, Object> clientCapabilities = new HashMap<String, Object>();
clientCapabilities.put("consumer_cancel_notify", Boolean.valueOf(true));
clientProperties.put("capabilities", clientCapabilities); 
```

至于您最初的问题，“有没有人尝试使用 php-amqplib 处理取消通知？” 看起来答案是坚定的“也许”==> [http://grokbase.com/t/rabbitmq/rabbitmq-discuss/11cynv8zkz/active-active-implementation-in-php](http://grokbase.com/t/rabbitmq/rabbitmq-discuss/11cynv8zkz/active-active-implementation-in-php)****

# php - 在客户端 (JQuery) 和服务器 (PHP) 之间同步表单验证 - 最佳方法

> ID：11218607
> 
> 赞同：0
> 
> 时间：2012-06-27T02:31:43.223
> 
> 标签：php, javascript, jquery, jquery-validate

考虑重构和重组一个非常大的 PHP 项目的场景，该项目包含*许多*带有表单的页面。

我已经编写了一个非常灵活和紧凑的 JS 验证函数（使用正则表达式、自定义表达式等），但我想迁移到**JQuery 的验证**，因为它更结构化和更简洁的方法。

客户端验证很好，因为它可以立即响应并给 UI 带来很好的感觉，但这也给我留下了客户端验证很容易被篡改的问题，所以我也想**“镜像”验证规则在 PHP（服务器）端使事情变得均匀**（如果可能的话，集成过滤器和数据清理以解决注入和其他恶意行为）。

你觉得这种方法是最好的吗？有什么一般性的建议来实现这个吗？

是否有某种工具、框架或 PHP 类可以负责这种重复，避免重写 PHP 中的每条规则？

* * *

如果没有，我考虑编写自己的 PHP 类，使用逐条添加规则的方法和`echo`一个 JQuery 验证迷你脚本或函数的方法，但我不确定这是否是一个好方法以及如何使用它有效率的。对我有什么建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:39:56.217

我曾经做过类似的客户端验证，在服务器端镜像相同的规则。

几年前，我决定放弃客户端验证，因为我不关心对服务器的额外点击。我现在在服务器端进行所有验证，然后在 javascript 中使用 ajax 调用它，这样您就不必担心页面重新加载和丢失表单上的输入。加上只做 1/2 的验证编码是一个加号。

我从未使用过它，但看起来 Yii 框架有一个验证类，可以同时执行服务器端和客户端 [http://www.yiiframework.com/doc/api/1.1/CActiveForm#enableClientValidation-detail](http://www.yiiframework.com/doc/api/1.1/CActiveForm#enableClientValidation-detail)

# asp.net - 防止用户在 .NET MVC3 中提交默认表单值

> ID：11218612
> 
> 赞同：0
> 
> 时间：2012-06-27T02:32:27.813
> 
> 标签：asp.net, asp.net-mvc-3, validation, unobtrusive-validation

我有以下模型：

```
public class Contact
{
    public Contact()
    {
        Name = "Your Name";
        Email = "Your Email";
        Message = "Your Message";
    }

    [Required]
    [StringLength(60,MinimumLength = 3)]
    public string Name { get; set; }

    [Required]
    [DataType(DataType.EmailAddress)]
    [RegularExpression(@"\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b")]
    public string Email { get; set; }

    [Required]
    [StringLength(2200, MinimumLength = 10)]
    [DataType(DataType.MultilineText)]
    public string Message { get; set; }
} 
```

对于 Message 和 Name，它们的默认值（在构造函数中）实际上通过了验证，显然这很糟糕。我知道我可以检查这一点并在控制器中抛出一个错误，但我正试图找到一种在模型中执行这些操作的方法（因为我认为这是正确的执行位置）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:50:09.640

我不会在服务器端这样做。使用文本框水印是 ex 的众多方法之一。

[http://code.google.com/p/jquery-watermark/](http://code.google.com/p/jquery-watermark/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:40:53.133

这些看起来像提示，而不是默认值。您应该使用 javascript 来实现这些，而不是将它们设置为输入值。

# dynamics-crm-2011 - 插件中的 Crm DateTime 问题

> ID：11218620
> 
> 赞同：1
> 
> 时间：2012-06-27T02:33:56.770
> 
> 标签：dynamics-crm-2011, dynamics-crm-online

我有一个与 CRM DateTime 问题有关的问题。在机会表单中具有自定义日期时间字段（投标提交日期），该字段显示在“仅日期”格式上。以及其他字符串字段（Tender Date），用于在 Tender 提交日期更改时修改日期。假设... 投标日期是 29/06/2011 12:00:00 投标日期应该是 29/06/2012

我为 Create Post-operation 和 Update Pre-operation 创建插件。我检索 TenderSubDate.Day、Month 和 Year。
Crm 时区是 (GMT+08:00) 吉隆坡，新加坡然后想更改 (GMT-06:00) 中部时间（美国和加拿大）。

问题是，当我根据投标提交日期更新投标日期时，程序返回比投标子日期少或多一天。说吧。。

**第一节**

投标提交日期为 29/06/2012 12:00:00am

程序返回**28/06/2012**（错误，应该是 29/06/2012）

**第二种情况**

投标提交日期为 1/08/2012 12:00:00am

程序返回**32/07/2012**（错误，应该是 1/08/2012）

我应该在我的程序中做什么。请给我一些想法。这是我的插件代码

```
public class TenderSubDateChange : IPlugin
{
    #region Class Level Variables
    //IServiceProvider _serviceProvider;
    //IOrganizationServiceFactory _serviceFactory = null;
    //IOrganizationService _service = null;
    //IPluginExecutionContext _context = null;

    Entity _target = null;
    Entity _preImage = null;
    Entity _postImage = null;
    Guid _currentUser;
    #endregion

    #region  IPlugin Members
    public void Execute(IServiceProvider serviceProvider)
    {
        try
        {
            string message = null;
            IPluginExecutionContext _context = (IPluginExecutionContext)serviceProvider.GetService(typeof(IPluginExecutionContext));

            #region Organization Services
            // Obtain the organization service reference.
            IOrganizationServiceFactory serviceFactory = (IOrganizationServiceFactory)serviceProvider.GetService(typeof(IOrganizationServiceFactory));
            IOrganizationService service = serviceFactory.CreateOrganizationService(_context.UserId);
            #endregion

            var ServiceContext = new OrganizationServiceContext(service);

            _currentUser = _context.UserId;
            message = _context.MessageName.ToLower();

            if (message == "create")//message == "create" || 
            {
                if (_context.InputParameters.Contains("Target") && _context.InputParameters["Target"] != null)
                    _target = (Entity)_context.InputParameters["Target"];

                if (_context.PreEntityImages.Contains("PreImage") && _context.PreEntityImages["PreImage"] != null)
                    _preImage = (Entity)_context.PreEntityImages["PreImage"];

                if (_context.PostEntityImages.Contains("PostImage") && _context.PostEntityImages["PostImage"] != null)
                    _postImage = (Entity)_context.PostEntityImages["PostImage"];

                DateTime hm_tenderdate;
                if (_target.Attributes.Contains("hm_tendersubmissiondate"))
                {
                    hm_tenderdate = (DateTime)_target.Attributes["hm_tendersubmissiondate"];
                    _target.Attributes["hm_tendersubdate"] = (hm_tenderdate.Day) + "/" + hm_tenderdate.Month + "/" + hm_tenderdate.Year;
                    service.Update(_target);
                }
            }
            if (message == "update")//message == "create" || 
            {
                if (_context.InputParameters.Contains("Target") && _context.InputParameters["Target"] != null)
                    _target = (Entity)_context.InputParameters["Target"];

                if (_context.PreEntityImages.Contains("PreImage") && _context.PreEntityImages["PreImage"] != null)
                    _preImage = (Entity)_context.PreEntityImages["PreImage"];

                if (_context.PostEntityImages.Contains("PostImage") && _context.PostEntityImages["PostImage"] != null)
                    _postImage = (Entity)_context.PostEntityImages["PostImage"];

                DateTime hm_tenderdate;
                if (_target.Attributes.Contains("hm_tendersubmissiondate"))
                {
                    hm_tenderdate = (DateTime)_target.Attributes["hm_tendersubmissiondate"];
                    _target.Attributes["hm_tendersubdate"] = (hm_tenderdate.Day) + "/" + hm_tenderdate.Month + "/" + hm_tenderdate.Year;
                }
            }
        }
        catch (Exception ex)
        {
            throw new InvalidPluginExecutionException(ex.Message, ex);
        }
    }
    #endregion
} 
```

![在此处输入图像描述](../Images/e67e40da2a0bd1a152da14f3fc883b7a.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T05:39:14.950

我之前遇到过这个问题，让我发疯，解决方案是将UTC时间转换为当地时间

```
DateTime tenderDate = ((DateTime)target["new_tender"]).ToLocal(); 
```

# xcode - 不知道为什么插入 sqlite sql 语句没有被执行，Xcode

> ID：11218622
> 
> 赞同：1
> 
> 时间：2012-06-27T02:34:16.337
> 
> 标签：xcode, sqlite

一切对我来说都很好，但是 prepare_v2 没有得到 SQLITE_OK

sql 指令非常基本，如果我将其复制并粘贴到 sqlite 管理器上，它会很好地插入

有什么我想念的吗？

```
//from view controller

- (void)viewDidLoad
{
[super viewDidLoad];

DBConnection* dbCon = [DBConnection alloc];
[dbCon init];
[dbCon InsertDataRollNo:@"888"]; 
```

}

```
-(id)init
{
//[super init];

DBName = @"FoodDB2.sqlite";

NSArray* documentsPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

NSString* documentsDir = [documentsPath objectAtIndex:0];
DBPath = [documentsDir stringByAppendingPathComponent:DBName];

return self; 
```

}

```
-(void)InsertDataRollNo:(NSString*)theName
{
[self CheckAndCreateDB];

sqlite3* database;

if(sqlite3_open([DBPath UTF8String], &database)== SQLITE_OK)
{
    NSString* statement;
    sqlite3_stmt* compliedStatement;

    //statement = [[NSString alloc]initWithFormat:@"insert into Category(TheName)values('%d')",@"epa"];
    statement = @"insert into Category(TheName)values('aaa')";
    const char* sqlStatement = [statement UTF8String];

    if(sqlite3_prepare_v2(database, sqlStatement, -1, &compliedStatement, NULL) == SQLITE_OK)
    {
        if(SQLITE_DONE!=sqlite3_step(compliedStatement))
        {
            NSAssert1(0,@"Error by inserting '%s' ", sqlite3_errmsg(database));

        }
        else
        {
            NSAssert1(0,@"cool '%s' ", @"ope");
        }
    }           
    sqlite3_finalize(compliedStatement);
}
sqlite3_close(database); 
```

}

```
-(void)CheckAndCreateDB

{

  BOOL success;

NSFileManager* fileManager = [NSFileManager defaultManager];

success = [fileManager fileExistsAtPath:DBPath];

if(success) return;

NSString* databasePathFromApp = [[[NSBundle mainBundle]resourcePath]stringByAppendingPathComponent:DBName];

[fileManager copyItemAtPath:databasePathFromApp toPath:DBPath error:nil];

//[fileManager release]; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T00:46:00.220

我想通了，实际上我并没有将 sqlite 文件复制到 iPhone 项目中，现在运行良好

# django - Django - 如何重新创建或导入 django admin 绿色加号以添加新的相关实例？

> ID：11218640
> 
> 赞同：3
> 
> 时间：2012-06-27T02:36:29.743
> 
> 标签：django

例如我有一个这样的模型：

```
class Wheel(models.Model):
    wheel = models.CharField(max_length=20)

class Vehicle(models.Model):
    wheel = models.ForeignKey(Wheel) 
```

当我制造一辆新车辆时，我希望绿色加号出现在我的车轮字段旁边，并允许我添加新的车轮实例。我对 django 很陌生，所以我不知道这是否可能。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-21T20:38:02.440

如果您在管理部分之外实现您的表单，您将需要一个类似于 django.contrib.admin.widgets.RelatedFieldWidgetWrapper 的自定义小部件包装器。用法示例：

```
from .models import Owner
from .widgets import AddAnotherWidgetWrapper   # our custom widget wrapper

class PickOwnerForm(forms.Form):
    owner = forms.ModelChoiceField(
    queryset=Owner.objects.all().order_by('name'),
    widget=AddAnotherWidgetWrapper(forms.Select(),Owner, )
) 
```

在您的实现中，将“所有者”替换为您链接到的模型。

[您可以在https://gist.github.com/ebrelsford/5263306](https://gist.github.com/ebrelsford/5263306)找到自定义小部件包装器以及完整示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T05:20:17.277

检查小部件`django.contrib.admin.widgets.RelatedFieldWidgetWrapper`。这是 Django Admin 用来添加功能性“+”标记的小部件，[在这里](https://github.com/django/django/blob/master/django/contrib/admin/options.py#L120)。
为了在您的自定义表单中使用小部件，您需要提供为`admin_site`Wheel 添加页面提供服务的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:12:25.847

默认情况下，只有具有“editable=True”的字段才会添加到管理页面：

[ModelAdmin.fields](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.fields)

**模型.py**

```
class Wheel(models.Model):
    wheel = models.CharField(max_length=20, editable=True)

class Vehicle(models.Model):
    wheel = models.ForeignKey(Wheel, editable=True) 
```

# android - 在钛中创建密码文本字段

> ID：11218642
> 
> 赞同：0
> 
> 时间：2012-06-27T02:36:54.790
> 
> 标签：android, titanium-mobile

我在钛中创建了一个密码文本字段，如下所示，但它仅适用于 Iphone，但在 Android 中不起作用。我该怎么做？

```
var textfield_password=Ti.UI.createTextField({
top:290,
left:50,
right:50,
hintText:'Enter your password',
passwordMask:true, 
```

})

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T10:25:05.780

此问题已修复： [https ://jira.appcelerator.org/browse/TC-608?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel](https://jira.appcelerator.org/browse/TC-608?page=com.atlassian.jira.plugin.system.issuetabpanels%3aall-tabpanel)

你的代码也在我的电脑上给出了正确的输出。我正在使用钛 sdk 2.0 和 android 2.3.3

# xpages - 在 xpinc 中打开新文档。如何关闭窗口或重定向到父文档？

> ID：11218648
> 
> 赞同：0
> 
> 时间：2012-06-27T02:37:36.127
> 
> 标签：xpages, xpinc

我正在一个大型经典笔记应用程序中对表单进行 XPage 处理，并且我正在努力寻找一种方法来结束与呈现良好 UI 的表单的交互。这是我的场景：

1) 从视图中打开父文档（经典笔记） 2) 父文档上的按钮使用 notes:/// 链接在 XPiNC 中打开子文档。3) 子文档 XPage 上的取消按钮......

我尝试了以下方法：

**a) 使用 window.close()** 我在这方面做了很多谷歌搜索，但各种方法似乎对我不起作用。如果您从使用 window.open 打开的窗口调用它，window.close() 应该可以工作，所以我尝试了 window.open("closeMe.xsp", "_self") 看看这是否会给我一个窗口可以在 onClientLoad 客户端事件中由带有 window.close() 的 xpage 关闭。那里没有运气。以下问题提出建议但不提供解决方案（第三方产品除外）

[如何在 Xpage 中关闭我的窗口？](https://stackoverflow.com/questions/9682492/how-do-i-close-my-window-in-xpage) [如何在notes客户端关闭xpages？我使用 CSJS window.close 但它不起作用](https://stackoverflow.com/questions/11093639/how-to-close-xpages-in-notes-client-i-use-csjs-window-close-but-its-not-workin)

**b) 重定向到父文档** 我的下一个想法是重定向到父文档——它已经在 Notes 客户端中打开了。但是，我发现当我重定向时（使用 facesContext.getExternalContext().redirect("Notes:///url" ）它确实会跳转到父文档，但它会在 XPage 所在的选项卡中打开一个空白窗口.

我的下一个尝试是关闭原始调用 LotusScript 中的父级，然后在取消按钮中重定向到父级。这也有效 - 您进入父文档，但是如果您按下退出键或关闭父文档的选项卡，它会再次为您留下一个空窗口。

有任何想法吗？我喜欢能够返回到新打开的父文档的想法，因为我可以期望我的新子文档会刷新嵌入式视图，但目前我会采取任何有效的方法。:)

干杯，

布伦丹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:44:36.677

你被困在岩石和坚硬的地方之间。XPiNC 和经典 Notes 不会那么容易混合。但有希望。前往[Composite Application Wiki](http://www-10.lotus.com/ldd/compappwiki.nsf/)。在那里你会发现你可以打开一个[合成而不是一个文档](http://www-10.lotus.com/ldd/compappwiki.nsf/dx/opening-notes-documents-on-pages)，它允许你在合成中包含选项卡和东西。

这也是经典应用程序和 XPage（使用属性代理发布/订阅）交换数据的方式。确保你也阅读了评论。Karsten 有很好的进一步链接。

对于您真正想做的事情，我没有一个可行的示例，但 Composite 感觉是您拥有的最佳选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T03:05:49.387

我找到了部分解决方案，Java 是你的朋友。它适用于按钮也应该适用于链接。唯一的问题是当从像 onClose 这样的事件调用时，当前 xpage 失去焦点并且当前页面保持打开状态。我试图模拟发送键，它按下了 ESC 键。它可以从一个按钮中正常工作。 CLick 事件上的按钮

```
<xp:button value="Label" id="button1">
    <xp:eventHandler event="onclick" submit="true"
        refreshMode="complete">
        <xp:this.action><![CDATA[#{javascript:var robot:java.awt.Robot= new java.awt.Robot;var event:java.awt.event.KeyEvent=java.awt.event.KeyEvent; 
```

机器人.keyPress(event.VK_ESCAPE); 机器人.keyRelease(event.VK_ESCAPE); `enter code here`}]]>

```
 </xp:eventHandler>
</xp:button> 
```

# c++ - g ++忽略头文件

> ID：11218652
> 
> 赞同：0
> 
> 时间：2012-06-27T02:37:59.347
> 
> 标签：c++, macos, g++

所以我正在尝试用 g++ 创建一个 exec。我的命令如下：

```
g++ -o project21  main.cpp tools.hpp file.hpp FileInfo.cpp file.cp tools.cpp 
```

我收到一个错误

```
ld: warning: ignoring file tools.hpp, file was built for unsupported file format which is not the architecture being linked (x86_64)
ld: warning: ignoring file file.hpp, file was built for unsupported file format which is not the architecture being linked (x86_64) 
```

这里的行为很奇怪，我可以在 XCode 中编译它并使用 exec 就好了，它只是在我遇到问题的 shell 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:15:10.633

您不需要编译 hpp 文件。将它们包含在您的 .cpp 文件中。

即使您在项目中包含 hpp，Xcode 也不会编译它们，除非您明确要求它（我的 mac 正在工作，但如果我记得单击项目（左侧树的根），单击目标并检查选项卡构建阶段，有一个包含要编译的文件的列表）。

关于分段错误，如果它缺少源文件（即，您在 .hpp 文件中添加了确实应该在 .cpp 文件中的代码），那么您将收到链接错误，而不是分段错误。分段错误还有其他原因，在 GDB 上运行并调试它（使用 -g 编译以便能够调试）。以下是一些可能性：

*   如果您正在为不同的平台构建，问题可能是某些平台特定的代码。
*   编译器不兼容：假设您将 Xcode 与 LLVM 一起使用，您可能有一些代码可以与 LLVM 一起使用，但与 gcc 的行为不同。非常不可能（根据我对这些编译器的经验，我可以说它们非常兼容），但仍然可能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:42:34.527

在尝试您的命令之前，请尝试删除任何`*.gch`可能由 Xcode 构建创建的文件。`g++`

但是，一般来说，我会尝试在不先预编译头文件的情况下让事情正常工作，然后在必要时添加预编译的头优化（即，不要将`.hpp`文件显式传递给编译器，直到你得到其他一切工作，只有当你真的需要时）。

# php - 带有内部连接的 DISTINCT

> ID：11218665
> 
> 赞同：1
> 
> 时间：2012-06-27T02:39:39.860
> 
> 标签：php, join

我目前正在为摄影师制作一个网站，每张照片都带有多个关键字，这些关键字在上传时会被提取出来。

我的数据库看起来像这样（简化）

```
TAGS
-------------------
|     |           |
|     |           |
| ID  |   TAG     |
|     |           |
|     |           |
-------------------

IMAGES
-------------------
|     |           |
|     |           |
| ID  |   URL     |
|     |           |
|     |           |
-------------------

TAGS_IMAGES
-------------------
|     |           |
| TAG |   IMAGE   |
| ID  |    ID     |
|     |           |
|     |           |
------------------- 
```

因此，所有标签都存储在一个单独的表中以防止重复，图像也是如此，然后标签和图像在另一个表中链接在一起。

搜索标签时，我执行此 SQL 以查找基于给定标签的所有图像

```
SELECT DISTINCT SQL_CALC_FOUND_ROWS tags.tag, tags_image.imageID, images.src FROM tags INNER JOIN tags_image ON tags.tagID = tags_image.tagID INNER JOIN images ON tags_image.imageID = images.id WHERE tag LIKE ? ORDER BY id DESC LIMIT ?, ? 
```

但问题是我仍然得到多个重复项，因为 DISTINCT 似乎只适用于 tag.id。

正如您在此处看到的：http: [//pastebin.com/MWt5B0Aq](http://pastebin.com/MWt5B0Aq)，基于标签“水”，一些图像具有诸如“水”、“水沃格尔”、“水环”之类的关键字。

有没有办法让 DISTINCT 在 images.id 上工作？

我试过这个，但这没有帮助

```
SELECT DISTINCT images.id SQL_CALC_FOUND_ROWS tags.tag, tags_image.imageID, images.src FROM tags INNER JOIN tags_image ON tags.tagID = tags_image.tagID INNER JOIN images ON tags_image.imageID = images.id WHERE tag LIKE ? ORDER BY id DESC LIMIT ?, ? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:49:35.210

会帮助做一个小组吗？

```
SELECT DISTINCT SQL_CALC_FOUND_ROWS tags.tag, tags_image.imageID, images.src FROM tags INNER JOIN tags_image ON tags.tagID = tags_image.tagID INNER JOIN images ON tags_image.imageID = images.id WHERE tag LIKE ? GROUP BY images.id ORDER BY id DESC LIMIT ?, ? 
```

# flash - 从 Flash 导出 SWC 以用于 Flash Builder Actionscript 项目

> ID：11218667
> 
> 赞同：1
> 
> 时间：2012-06-27T02:39:43.917
> 
> 标签：flash, apache-flex, actionscript, swc

我在我的 Flash Builder Actionscript 项目中创建了一个类。

然后，我为该类创建了一个带有图形的 FLA，为其制作了一个符号并将其链接到该类。然后我发布了一个swc。

如果我尝试在另一个 fla 中使用 swc，然后实例化该对象并将其添加到显示列表中，则没有问题。

但是，当我运行我的 flash builder 项目时，对象的图形不显示。尽管类的构造函数中的跟踪语句运行正常。

这是怎么回事？很确定我过去没有问题让它工作。不知道我是否不记得该怎么做或什么。

这是我的符号导出设置：

![符号设置](../Images/b9538a072851034a98eae1c7189c052c.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T05:05:38.817

如果在您的 Flash Builder 代码库以及从 Flash Pro 发布的 SWC 中都定义了该类，则可能与包发生冲突。

闪存生成器

*   定义 TitlePopup 的基类
*   `new TitlePopup()`可能会在您的 Flash Builder 项目中实例化该类，并且不会使用从 Flash Pro SWC 发布的 UI 实例化定义。

闪光临

*   在 AS Linkage 中使用 TitlePopup 基类
*   定义用户界面
*   `new TitlePopup()`使用 Flash Pro 定义的 UI 以及基类 AS Linkage 代码实例化类。

从 Flash Pro SWC 实例化类定义具有您的 UI 以及基类。

从 Flash Builder 实例化时，它可能使用代码库中的基类，而不是 SWC 中带有 UI 的类。

如果 TitlePopup 类是从 Flash Pro 的 SWC 发布的，那么您应该从 Flash Builder 代码库中删除该类并仅从 SWC 定义中引用它。

![闪存-swc](../Images/07583f27c2f6e4910096be1f5f54ee18.png)

如果您只想使用 Flash Builder 作为 Flash Pro 的代码编辑器，您可以随时为您的类“在 Flash Builder 中编辑”。右键单击库中的符号并选择 Flash Builder：

![在 Flash Builder 中编辑](../Images/e431b3f6054aa05a48bd742524c002b1.png)

Flash Builder 项目是为您自动生成的。

Flash Builder 可能无法解析 Flash Pro 的 playerglobal.swc，您可以在其中添加定义到自动生成的 Flash Builder .actionScriptProperties 中：

```
<libraryPathEntry kind="3" linkType="1" path="${FLASHPRO_APPCONFIG}/ActionScript 3.0/FP10.2/playerglobal.swc" useDefaultLinkType="false"/> 
```

同样，如果您依赖 Flash Pro 组件，您可以通过 SWC 添加它们。

视窗：

> C:\Program Files (x86)\Adobe\Adobe Flash CS5.5\Common\Configuration\ActionScript 3.0\libs\flash.swc

苹果电脑：

> /Applications/Adobe Flash CS5/Common/Configuration/ActionScript 3.0/libs/flash.swc

或者，您可以添加组件源路径：

视窗：

> C:\Program Files (x86)\Adobe\Adobe Flash CS5.5\Common\Configuration\Component Source\ActionScript 3.0\User Interface

苹果电脑：

> /Applications/Adobe Flash CS5.5/Common/Configuration/组件源/ActionScript 3.0/用户界面

也许您可以在 Flash Builder 中创建一个 ActionScript 库项目，将该库项目用作 Flash Pro 中的源路径（不是每个项目，而是全局源路径）。

然后从 Flash Pro 发布 SWC，并在 Flash Builder 中实现纯 ActionScript 项目时使用 SWC。

这对您的统一代码库没有帮助；但是，这也是将所有代码保存在 Flash Builder 中的工作流程。

![闪光源](../Images/f4cf072b650820b096ad90e531d8b169.png)

# javascript - 为什么 numberArray.sort() 在 JavaScript 中不能正确排序数字？

> ID：11218670
> 
> 赞同：2
> 
> 时间：2012-06-27T02:39:53.263
> 
> 标签：javascript, sorting

我正在练习数据可视化库 d3.js，我正在使用与以下内容相同的随机数据生成器：

```
function generateRandomData() {
    var i,
        data = [];
    for (i = 0; i < 100; i += 1) {
        data.push(Math.random() * 100);
    }
    return data;
} 
```

我存储该值并尝试对其进行排序，如下所示：

```
var data = generateRandomData();
data.sort(); 
```

不幸的是，排序后的数据集没有完全排序——一些值实际上是不正确的。例如，我会有 [12, 15, 18, 21, 3, 18 ...] 这样的数字。排序函数不准确的原因是什么？

注意：我找到了一个合适的解决方案，解决了我的问题：

```
data.sort(function (a, b) { return b - a; }); 
```

我只是想知道为什么 sort() 不可靠。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:43:53.080

`sort()`如果在没有自定义排序函数的情况下调用该函数，则该函数将数组中的所有内容视为字符串。

唯一的例外是`undefined`，它从 Javascript 1.2 开始始终是排序数组中的“最大”项。

```
[void(0),342,4.5,"ahahaha",null,"zzz", "nen", "nup", 0/0, "KDSFL", "-sdfh",-3324, "-%",Array.prototype.sort,window,Array.zzz,"[oooooo]", "undefined",0].sort() 
```

参考：

[https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/sort)

# cookieless - 提供来自不同域的静态内容（JS、CSS、媒体）时要小心吗？

> ID：11218672
> 
> 赞同：0
> 
> 时间：2012-06-27T02:40:04.953
> 
> 标签：cookieless, static-content

让我试着举例说明。假设网站托管在`example.com`（NOT `www.example.com`）。为了提供无 cookie 的静态内容，我选择使用不同的域`example-static.com`。

现在，让我们考虑一下我的静态内容目前是这样提供的：

```
http://example.com/js/script.js
http://example.com/css/style.css
http://example.com/media/image.jpg 
```

`example-static.com`** 现在我创建一个别名为我的主域的 CNAME 记录，即`example.com`这样静态内容就可以这样提供：

```
http://example-static.com/js/script.js
http://example-static.com/css/style.css
http://example-static.com/media/image.jpg 
```

** 这就是我所要做的吗？***所有***浏览器都会执行 JavaScript 文件并加载 Web 字体而没有任何安全问题吗？或者我应该使用一些 .htaccess 规则来修改标头信息等吗？

**PS：**如果需要的话，如果你能提供应该添加的规则，那就太好了。

**编辑：**我向这个问题添加赏金的原因是我认识的人建议我不要从不同的域提供 JS。他们也无法给我一个明确的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:55:23.820

它可以在没有额外配置的情况下工作。然而：这值得痛苦吗？如果您使用一些真正的内容交付网络，这很好，但只是伪造一个，没有 cookie？一个更好的方法是最小化 cookie 大小恕我直言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:14:24.803

Gergely 的回答回答了我的问题。而且我还找到了替代方案。由于我的网站是从 提供的`example.com`，而不是从不同的域提供静态内容，我计划`cookies`从不同的子域为自己提供服务`www.example.com`。

简单，应该做的工作。

# html - 空的 [if IE] 会提高网站性能吗？

> ID：11218673
> 
> 赞同：2
> 
> 时间：2012-06-27T02:40:08.503
> 
> 标签：html, internet-explorer

我正在浏览网页上的一些 HTML 并看到了这个：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--[if IE]><![endif]--><!--Empty IE conditional comment to improve site performance-->
<html lang="en">
  <head> 
```

有一个空的 IE 条件真的可以提高网站的性能吗？它对提高性能有什么作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:49:48.237

根据一些在线文章，如果你有一个 IE 条件**css**要加载，它就可以了。见[http://www.phpied.com/conditional-comments-block-downloads/](http://www.phpied.com/conditional-comments-block-downloads/)

如果您的页面中有此内容，例如：

```
<!--[if IE 6 ]>
<link type="text/css" rel="stylesheet"
      href="styles/ie6.css">
<![endif]--> 
```

它将在加载主 CSS 之前阻止进一步下载。

如果您在页面开头添加此内容：

```
<!--[if IE]><![endif]--> 
```

这不会发生。

**PS当我读到这篇文章时，我真的很惊讶。所以这是IE的一个笑话。**

# javascript - 使用 jQuery Mobile 卸载预取页面

> ID：11218674
> 
> 赞同：3
> 
> 时间：2012-06-27T02:40:10.297
> 
> 标签：javascript, jquery, jquery-mobile

使用 jQuery Mobile，我可以手动预取外部页面，如下所示：

```
$.mobile.loadPage(
  "content.html",
  { showLoadMsg: true }
); 
```

但是我应该手动从内存中删除那个页面吗？从某种意义上说，“卸货”了吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:47:32.353

在您的 jqm 页面上，如果有`id`指定，您可以执行此操作。

```
$('#page2').remove(); 
```

[例子](http://jsbin.com/ituket)

[另一种方法是在这里](http://jquerymobile.com/demos/1.1.0/docs/api/methods.html)使用`$.fn.jqmData(), $.fn.jqmRemoveData()` 参考

# html - CSS下拉菜单在悬停时不起作用

> ID：11218676
> 
> 赞同：1
> 
> 时间：2012-06-27T02:40:15.423
> 
> 标签：html, css, drop-down-menu, menu

我有一个工作菜单，但是当我将鼠标悬停在博客的下拉菜单上时，它就会消失。我怎样才能解决这个问题？

[http://jsfiddle.net/vkcja/](http://jsfiddle.net/vkcja/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:44:43.960

修复：

[http://jsfiddle.net/vkcja/4/](http://jsfiddle.net/vkcja/4/)

我还在菜单中添加了 onMouseOver 和 onMouseOut。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:51:15.223

检查这个 [http://jsfiddle.net/7MYag/](http://jsfiddle.net/7MYag/)

您需要将 onMouseOver 和 onMouseOut 添加到 li 元素

# algorithm - 凸壳误解？

> ID：11218687
> 
> 赞同：3
> 
> 时间：2012-06-27T02:41:11.783
> 
> 标签：algorithm, convex-hull, grahams-scan

我写了一个格雷厄姆扫描凸包算法的实现，对于测试数据，我使用了这些点

```
[(2.0,2.0),(4.0,2.0),(0.5,2.5),(3.0,3.5),(1.0,4.0),(0.0,4.0),(1.0,1.0),(3.0,2.5),(4.0,4.0),(3.5,1.5),(0.5,1.0)] 
```

根据我的程序，凸包是

```
[(0.0,4.0),(1.0,4.0),(4.0,4.0),(3.0,2.5),(4.0,2.0),(3.5,1.5),(1.0,1.0),(0.5,1.0)] 
```

但是，我希望凸包是

```
[(0.0,4.0),(1.0,4.0),(4.0,4.0),(4.0,2.0),(3.5,1.5),(1.0,1.0),(0.5,1.0)] 
```

我也用[https://github.com/shadwstalkr/GrahamScanDemo/](https://github.com/shadwstalkr/GrahamScanDemo/)尝试了我的一组点，这也给出了相同的解决方案。经过多次抱怨和抱怨后，我在维基百科上读到“如果对象内的每一对点，连接它们的直线段上的每个点也在对象内，则该对象是凸的。”

在画出我的观点和船体之后。看来我的程序在该定义内生成了一个对象，但这是否意味着仅按角度排序就会给出一个凸包，而在包中没有任何点？

我是否不了解凸包实际上是什么并且我正在解决一个不同的问题，或者我的实现和 shadwstalkr 都不正确？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T09:02:12.657

通过使用`wolframalpha` [`Polygon{}`](http://reference.wolfram.com/mathematica/ref/Polygon.html)命令，您可以看到您的解决方案与真实解决方案之间的差异：
您的：

![在此处输入图像描述](../Images/6392041ba7eacb748f5d64a9be37d477.png)

真实的：

![在此处输入图像描述](../Images/d7d1127c62d1676c239a789ec78bb9fd.png)

所以你的多边形既不是`convex`，因为根据凸多边形的定义，多边形内的所有点对必须形成仅包含来自该多边形的点的线段。例如，从`{4,4}`到的线`{4,2}`形成了多边形之外的线段。其次 - 你的多边形既不是`convex hull`因为橡胶不能弯曲到多边形内部来指向`{3., 2.5}`。所以你需要修复你的算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T04:31:01.197

您的直观解决方案是正确的，只是它有一点太多：`(1, 4)`. 凸包通常定义为*最小*凸集。包括`(1, 4)`，集合是凸的，但它不是最小的，因为它位于`(1, 4)`集合中其他两个点之间的线上：`(0,4)`和`(4,4)`。如果去掉`(1, 4)`，假想的橡皮筋的形状不会改变。

看起来您的程序中存在错误。

# css - 垂直自动时如何使用css保持水平可见？

> ID：11218688
> 
> 赞同：1
> 
> 时间：2012-06-27T02:41:13.183
> 
> 标签：css, html, overflow

有三个 div，d1，d2 和 d3，我希望 d1 可以垂直包装内容，但水平可见。

如果 d2 和 d3 没有浮动属性，则 d1 会给我想要的结果。

但是 d2 和 d2 具有浮动属性，我需要添加 overflow-y:auto 以使其垂直包装。

我添加了溢出-x：可见，但它仍然有一个滚动条。

那么如何保持水平可见？

```
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
#d1
{
    background-color:red;
    padding:10px;
    width:100px;

    overflow-x:visible;
    overflow-y:auto;
}
#d2
{
    background-color:blue;
    float:left;

    width:150px;
    height:30px;
}
#d3
{
    background-color:green;
    float:left;

    width:50px;
    height:230px;
}
</style>
</head>
<body>
<div id="d1">
    <div id="d2">in</div>
    <div id="d3">
        out
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:01:54.097

如果我理解你的问题，你可以使用“清晰”的 DIV 来解决这个问题。编辑代码：

**CSS**

```
<style>
#d1
{
    background-color:red;
    padding:10px;
    width:100px;

    overflow-x:visible;

}
#d2
{
    background-color:blue;
    float:left;

    width:150px;
    height:30px;
}
#d3
{
    background-color:green;
    float:left;

    width:50px;
    height:230px;
}

.clear{
    clear:both;
}
</style> 
```

**HTML**

```
<div id="d1">
    <div id="d2">in</div>
    <div id="d3">out</div>
    <div class="clear"></div>
</div> 
```

# c# - MFC 应用程序中的 .NET Activex 控件访问冲突

> ID：11218694
> 
> 赞同：1
> 
> 时间：2012-06-27T02:42:00.310
> 
> 标签：c#, c++, .net, mfc, activex

背景：我在 .NET 中开发了一个 Activex 控件，但发现它在使用它的各种应用程序中引起了稳定性问题。我设法从示例应用程序中找到了一系列步骤，下面列出了类似的不稳定性。

我有一个从 Dev-Center 网站下载的示例 Activex 控件，名为“CSActivex”（http://code.msdn.microsoft.com/windowsdesktop/CSActiveX-b86194f8）

构建起来相当容易，我只是在 VS2010 Express (C#) 中加载了项目并将其编译为 .dll

然后，我从 VS2008 C++ 创建了一个示例 MFC 应用程序来为遗留应用程序建模（它不使用任何 .NET）。目标是一个简单的基于对话框的 GUI，它有一个 About 框。

我用 regasm 注册了 csactivex.dll 并将 dll 复制到 VS IDE 文件夹中，这样我就可以在设计时插入 Activex 控件，然后插入到 Debug 文件夹中，这样就可以在运行时找到它。

在设计时，我将 CSActivex 控件插入到 About 对话框中，它毫无意外地出现。在构建并将 dll 复制到 Debug 文件夹并运行调试会话后，如果我不断导航到 about 框，单击控件上的各个位置，关闭 about 对话框并重复几次，我开始在输出有关访问冲突的日志，它开始看起来像这样：

```
'CSActivexMFC.exe': Loaded 'C:\WINDOWS\assembly\NativeImages_v2.0.50727_32\System.Windows.Forms\63406259e94d5c0ff5b79401dfe113ce\System.Windows.Forms.ni.dll'
'CSActivexMFC.exe': Loaded 'C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorjit.dll'
'CSActivexMFC.exe': Loaded 'C:\WINDOWS\WinSxS\x86_Microsoft.Windows.GdiPlus_6595b64144ccf1df_1.0.2600.5581_x-ww_dfbc4fc4\GdiPlus.dll'
'CSActivexMFC.exe': Loaded 'C:\WINDOWS\assembly\NativeImages_v2.0.50727_32\Accessibility\11eb4f6606ba01e5128805759121ea6c\Accessibility.ni.dll'
First-chance exception at 0x00000000 in CSActivexMFC.exe: 0xC0000005: Access violation reading location 0x00000000.
First-chance exception at 0x00000000 in CSActivexMFC.exe: 0xC0000005: Access violation reading location 0x00000000.
First-chance exception at 0x79f4c2f7 in CSActivexMFC.exe: 0xC0000005: Access violation reading location 0x0000000b.
First-chance exception at 0x79f4c2f7 in CSActivexMFC.exe: 0xC0000005: Access violation reading location 0x0000000b. 
```

虽然它在调试器中没有崩溃，但我不禁认为这不好，我感觉这可能与其他 .NET Activex 控件的不稳定性有关。如果我能想出解决这个问题的方法，同样的解决方法可能有助于原来的控制。

我尝试打破异常，但它似乎发生在几个不同的地方。我关闭应用程序时的一个堆栈跟踪如下：

> mscorwks.dll!79f4c2f7() [下面的帧可能不正确和/或丢失，没有为 mscorwks.dll 加载符号]
> mscorwks.dll!79f4c370() mscorwks.dll!79faaa91()
> mscorwks.dll!79faa858() mscorwks.dll !79faa9ad()
> mscorwks.dll!79faa9d9() mscorwks.dll!7a079480()
> mscorwks.dll!7a0798e8() mscorwks.dll!7a043f25()
> ole32.dll!77525834() rpcrt4.dll!77e799f4()
> rpcrt4.dll! 77ef421a() ntdll.dll!7c915239()
> ntdll.dll!7c91542b() ntdll.dll!7c91534a()
> ntdll.dll!7c915239() ntdll.dll!7c91542b()
> ntdll.dll!7c91534a() ntdll.dll!7c915f75 ()
> ntdll.dll!7c9155ed() ntdll.dll!7c915ce9()
> ntdll.dll!7c96f07c() ole32.dll!77600c15()
> ole32.dll!77600bbf() ole32.dll!7752ad31()
> ole32.dll!7752ac56() ole32.dll!7752b771()
> ole32.dll!77600e1f() ole32 .dll!7752b7ab()
> ole32.dll!7752b5e1() ole32.dll!7752b54e()
> user32.dll!7e418734() ole32.dll!7752b54e()
> ole32.dll!7752b54e() ole32.dll!7752b54e()
> ole32。 dll!7752b54e() ole32.dll!7752f2d0()
> ole32.dll!7752f23e() ole32.dll!77557237()
> mscorwks.dll!79f9e14d() mscorwks.dll!79f9e0b4()
> mscorwks.dll!79f9e018() mscorwks.dll !79f4c879()
> mscorwks.dll!79f3bb76() mscoreei.dll!603cc966()
> mscoreei.dll!603d1f25() mscoree.dll!790186ad()
> 
> > msvcr90d.dll!_ *crtCorExitProcess(int status=2) 第 716 行 C msvcr90d.dll！*_crtExitProcess(int status=2) Line 722 + 0x9 bytes C msvcr90d.dll!doexit(int code=2, int quick=0, int retcaller=0) Line 644 + 0x9 bytes C msvcr90d.dll!exit(int code=2 ) 第 412 行 + 0xd 字节 C CSActivexMFC.exe!__tmainCRTStartup() 第 595 行 C CSActivexMFC.exe!wWinMainCRTStartup() 第 399 行 C kernel32.dll!7c817077()

我希望以前有人可能遇到过这个问题，我在多台机器（家庭和工作中）上遇到过这个问题，至少把它缩小到 CSActivex 没有做它应该做的事情的问题，或者 MFC 中的事情。

所以我的问题是如何让这些样本在没有访问冲突的情况下工作？

编辑：

只是打开关于窗口并反复关闭它最终会导致调试器崩溃（未处理的异常），下面有一个堆栈跟踪，对我来说，它看起来像一个被破坏的对象又被破坏了？

```
First-chance exception at 0x00400003 in CSActivexMFC.exe: 0xC0000005: Access violation writing location 0x00000000.
First-chance exception at 0x00400003 in CSActivexMFC.exe: 0xC0000005: Access violation writing location 0x00000000.
First-chance exception at 0x003a005c in CSActivexMFC.exe: 0xC0000096: Privileged instruction.
First-chance exception at 0x00460020 in CSActivexMFC.exe: 0xC0000005: Access violation reading location 0x00460020.
First-chance exception at 0x78b6ba1d (mfc90ud.dll) in CSActivexMFC.exe: 0xC0000005: Access violation writing location 0x00000018.
Unhandled exception at 0x78b6ba1d (mfc90ud.dll) in CSActivexMFC.exe: 0xC0000005: Access violation writing location 0x00000018.

    mfc90ud.dll!CDataSourceControl::~CDataSourceControl()  Line 2431 + 0x2d bytes   C++
mfc90ud.dll!CDataSourceControl::`scalar deleting destructor'()  + 0x11 bytes    C++
mfc90ud.dll!COleControlSite::~COleControlSite()  Line 77 + 0x22 bytes   C++
mfc90ud.dll!COleControlSite::`scalar deleting destructor'()  + 0x11 bytes   C++
mfc90ud.dll!COleControlSiteOrWnd::~COleControlSiteOrWnd()  Line 161 + 0x24 bytes    C++
mfc90ud.dll!COleControlSiteOrWnd::`scalar deleting destructor'()  + 0x11 bytes  C++
mfc90ud.dll!COleControlContainer::~COleControlContainer()  Line 199 + 0x1c bytes    C++
mfc90ud.dll!COleControlContainer::`scalar deleting destructor'()  + 0x11 bytes  C++
mfc90ud.dll!CWnd::OnDestroy()  Line 786 + 0x24 bytes    C++
mfc90ud.dll!CWnd::OnWndMsg(unsigned int message=2, unsigned int wParam=0, long lParam=0, long * pResult=0x0012f510)  Line 2042  C++
mfc90ud.dll!CWnd::WindowProc(unsigned int message=2, unsigned int wParam=0, long lParam=0)  Line 1755 + 0x20 bytes  C++
mfc90ud.dll!AfxCallWndProc(CWnd * pWnd=0x0012f88c, HWND__ * hWnd=0x002c04fc, unsigned int nMsg=2, unsigned int wParam=0, long lParam=0)  Line 240 + 0x1c bytes  C++
mfc90ud.dll!AfxWndProc(HWND__ * hWnd=0x002c04fc, unsigned int nMsg=2, unsigned int wParam=0, long lParam=0)  Line 403   C++
mfc90ud.dll!AfxWndProcBase(HWND__ * hWnd=0x002c04fc, unsigned int nMsg=2, unsigned int wParam=0, long lParam=0)  Line 441 + 0x15 bytes  C++
user32.dll!7e418734()   
[Frames below may be incorrect and/or missing, no symbols loaded for user32.dll]    
user32.dll!7e418816()   
mfc90ud.dll!CThreadSlotData::GetThreadValue(int nSlot=6623744)  Line 268    C++
user32.dll!7e428eec()   
ntdll.dll!7c90e473()    
user32.dll!7e42b1a8()   
mfc90ud.dll!CWnd::DestroyWindow()  Line 1007 + 0xd bytes    C++
90909090() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T02:48:44.257

查看[David Kline](http://blogs.msdn.com/b/davidklinems/archive/2005/07/12/438061.aspx)的 MSDN 博客，了解什么是第一次机会异常。

来自博客

> 第一次机会异常是否意味着我的代码存在问题？
> 
> 首次机会异常消息通常并不意味着代码中存在问题。对于优雅地处理异常的应用程序/组件，第一次机会异常消息让开发人员知道遇到并处理了异常情况。
> 
> 对于没有异常处理的代码，调试器将收到第二次机会异常通知，并会因未处理的异常而停止。

通过查看[David Kline 的另一个 MSDN 博客，](http://blogs.msdn.com/b/davidklinems/archive/2005/07/18/440150.aspx)它将告诉您如何在第一次机会异常上停止以查看导致它的原因。

而这个[MSDN 论坛发帖](http://social.msdn.microsoft.com/forums/en-US/netfxbcl/thread/da1eedcd-50d3-46b0-bfd8-f3c840d72b55)

# asp.net - 防止重复提交表单，同时在 asp.net 中保持视图状态

> ID：11218695
> 
> 赞同：1
> 
> 时间：2012-06-27T02:42:00.843
> 
> 标签：asp.net, postback, post-redirect-get

我有一个人们可以用来上传文件的表单，我想确保在上传后按下刷新按钮不会触发重复上传。我正在考虑的方法是会话变量和页面重定向（post/redirect/get 模式），但它们都有问题

**会话变量**

问题是它们在页面之间共享，因此如果用户使用相同的逻辑打开了多个页面，或者他们在不同的记录上打开了同一页面的多个副本，则可能会错误地检测到刷新。另一个问题是会话状态过期，所以它不太可靠。但是，如果它对某人有帮助，我会发布代码。此函数应在页面 on_load 事件中调用，并将其返回值分配给在表单的提交事件中检查的变量。

```
Private Function checkForRefreshOnLoadAfterPostback() As Boolean
    Dim refreshed As Boolean = (Page.IsPostBack AndAlso Session("GuidOnloadPostbackRefreshCheck") <> ViewState("GuidOnloadPostbackRefreshCheck"))
    Session("GuidOnloadPostbackRefreshCheck") = Guid.NewGuid().ToString()
    ViewState("GuidOnloadPostbackRefreshCheck") = Session("GuidOnloadPostbackRefreshCheck")
    Return refreshed
End Function 
```

**发布/重定向/获取**

选项 2 是在处理表单提交后重定向页面，但是我的页面有带有其他表单控件的选项卡，如果可能的话，我想保留它们的值。所以我的问题是，如何在刷新后防止再次提交表单的同时维护页面的 viewState？有什么方法可以选择性地从页眉中删除数据？

# css - 根据计算复杂度选择有效的选择器

> ID：11218698
> 
> 赞同：6
> 
> 时间：2012-06-27T02:42:47.910
> 
> 标签：css, performance, css-selectors

鉴于 CSS 处理细节，最显着的是[RTL 匹配](https://stackoverflow.com/q/5797014/1081234)和[选择器效率](https://developers.google.com/speed/docs/best-practices/rendering#UseEfficientCSSSelectors)，应该如何纯粹从渲染引擎性能的角度编写选择器？

这应该涵盖一般方面，包括使用或避免使用伪类、伪元素和关系选择器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T02:42:48.753

在运行时，HTML 文档被解析为包含`N`具有平均深度的元素的 DOM 树`D`。应用的样式表中还有一共有`S`CSS 规则。

1.  元素的样式是单独应用的，这意味着它们**与整体复杂性****之间存在直接关系`N`**。值得注意的是，这可能会被浏览器逻辑所抵消，例如引用缓存和来自相同元素的回收样式。例如，以下列表项将应用相同的 CSS 属性（假设没有`:nth-child`应用诸如此类的伪类）：

    ```
    <ul class="sample">
      <li>one</li>
      <li>two</li>
      <li>three</li>
    </ul> 
    ```

2.  选择器从右到左匹配单个规则资格 - 即，如果最右边的键与特定元素不匹配，则无需进一步处理选择器并将其丢弃。这意味着**最右边的键应该匹配尽可能少的元素**。下面，描述符将匹配更多元素，包括目标容器*之外*`p`的段落（当然，不会应用该规则，但仍会导致对该特定选择器的资格检查进行更多迭代）：

     *```
    .custom-container p {}
    .container .custom-paragraph {} 
    ```* 
**   关系选择器：**后代选择器最多`D`需要迭代的元素**。例如，如果元素处于父子关系中，成功匹配可能只需要一个步骤，但在确认元素不匹配并安全丢弃规则之前，`.container .content`需要遍历 DOM 树。`html`这也适用于链式后代选择器，但有一些限制。

    另一方面，`>`子选择器、`+`相邻选择器或`:first-child`仍需要评估附加元素，但隐含深度仅为 1，并且永远不需要进一步的树遍历。

    *   伪元素的[行为定义](http://www.w3.org/TR/CSS21/generate.html#before-after-content)`:before`和`:after`暗示它们不是 RTL 范式的一部分。假设的逻辑是，在规则指示将其插入元素内容之前或之后之前，本身没有伪元素（这反过来需要额外的 DOM 操作，但不需要额外的计算来匹配选择器本身）。

    *   我找不到任何关于伪类的信息，例如`:nth-child()`or `:disabled`。验证元素状态需要额外的计算，但从规则解析的角度来看，只有将它们排除在 RTL 处理之外才有意义。* 

 *考虑到这些关系，计算复杂性`O(N*D*S)`应该主要通过最小化 CSS 选择器的深度和解决上面的点 2 来降低。与单独减少 CSS 规则或 HTML 元素的数量相比，这将带来可量化的更强改进^

**浅层的，最好是一级的，特定的选择器处理得更快。**这被谷歌带到了一个全新的水平（以编程方式，而不是手动！），例如很少有三键选择器，搜索结果中的大多数规则看起来像

```
#gb {}
#gbz, #gbg {}
#gbz {}
#gbg {}
#gbs {}
.gbto #gbs {}
#gbx3, #gbx4 {}
#gbx3 {}
#gbx4 {}
/*...*/ 
```

*^ - 虽然从渲染引擎性能的角度来看这是正确的，但总会有额外的因素，例如流量开销和 DOM 解析等。*

来源：[1](http://www.terrainformatica.com/2008/07/css-selectors-and-computational-complexity/) [2](https://developers.google.com/speed/docs/best-practices/rendering) [3](https://developer.mozilla.org/en/Writing_Efficient_CSS) [4](http://habrahabr.ru/post/140399/) [5](http://www.stevesouders.com/blog/2009/03/10/performance-impact-of-css-selectors/)*

# android - 带有 Android 4.0 SDK 的 ScrollView 中的 GridView

> ID：11218700
> 
> 赞同：2
> 
> 时间：2012-06-27T02:42:49.933
> 
> 标签：android, gridview, focus, scrollview, android-4.0-ice-cream-sandwich

我在 ScrollView 中使用 GridView。众所周知，肯定有一些问题。所以我使用一个类扩展 GridView，并使用以下方法覆盖 onMeasure 方法：

```
int expandSpec = MeasureSpec.makeMeasureSpec(Integer.MAX_VALUE >> 2, MeasureSpec.AT_MOST);   
super.onMeasure(widthMeasureSpec, expandSpec); 
```

因此可以**使用 Android 2.2 SDK**解决 gridview 问题。无论如何，gridview**可以正常聚焦。**

**我的问题**是：当我使用 Android 4.0 SDK 时，问题是：我也在 ScrollView 中使用了扩展的 GridView。ScrollView 正在填充父级。当 GridView 的尺寸小于现有的 ScrollView 时，GridView 可以通过正常触摸获得焦点。但是，当 GridView 的子视图数量增加时，ScrollView 的大小会变大。**换句话说，ScrollView 现在可以滚动了。GridView 无法再获得焦点。**

谁能帮我解决这个棘手的问题？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T05:12:25.410

GridView 本身包含滚动条，因此无需放在 ScrollView 内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T05:10:56.663

Romain Guy 在 Android 团队工作，他[建议](https://stackoverflow.com/questions/3495890/how-can-i-put-a-listview-into-a-scrollview-without-it-collapsing#comment3653232_3496042)不要在.`ListView``GridView``ScrollView`

# javascript - HTML 音乐应用不支持 iPhone 后台播放

> ID：11218703
> 
> 赞同：0
> 
> 时间：2012-06-27T02:43:29.810
> 
> 标签：javascript, iphone, html, xcode

我使用 html 和 js 创建了一个音乐应用程序。当我在 safari (iOS) 中运行时，它在后台运行，但是当我在 iPhone 中本地运行时，它不支持多任务和后台。有什么建议么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:07:49.970

我假设您谈论的是在 Safari 中访问网站与独立访问网站之间的区别（即从主屏幕访问它，假设存在`mobile-web-app-capable`元标记）。

目前，只有 iOS5 支持独立网络应用程序的背景音频播放。在那之前的任何事情都行不通。

# php - PHP：带有未定义常量的切换语句

> ID：11218704
> 
> 赞同：3
> 
> 时间：2012-06-27T02:43:42.843
> 
> 标签：php, constants, switch-statement

只是一个关于 PHP 如何处理 switch 语句的快速问题。

如果我有以下代码

```
switch (APPLICATION_ENVIRONMENT) {
    case 'production':
        echo 'production';
        break;
    case 'stage':
        echo 'stage';
        break;
    default: //dev
        echo 'dev';
} 
```

如果 APPLICATION_ENVIRONMENT 没有在任何地方定义，这仍然会评估为默认值吗？还是会抛出错误？查看正在运行的应用程序中的现有源代码，之前做过此操作的人首先对常量执行了 if(defined()) 以检查它是否存在，如果 switch 可以为我正确评估它，这是一种浪费

谢谢 DJ

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T02:47:07.843

它会评估开关，但会引发错误。

试试这个：

```
$env = defined('APPLICATION_ENVIRONMENT') ? APPLICATION_ENVIRONMENT : null;

switch($env) {
  ..
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T02:45:34.417

如果未定义，`APPLICATION_ENVIRONMENT`PHP 会将其解释为 string `"APPLICATION_ENVIRONMENT"`，因此将采用默认值，因为 string`"APPLICATION_ENVIRONMENT"`不是您定义的 switch 案例之一。

```
echo APPLICATION_ENVIRONMENT; 
```

> PHP 注意：使用未定义的常量 APPLICATION - 在第 1 行的 php shell 代码中假定为“APPLICATION_ENVIRONMENT”

PHP 将在遇到未定义的常量时发出通知，并且无论好坏，都会在您打算将其引用为字符串的假设下对其进行处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T04:22:23.567

如果`APPLICATION_ENVIRONMENT`在代码中未定义，它将简单地充当字符串并打印默认开关值。

switch 语句需要一个变量。因此，即使您`APPLICATION_ENVIRONMENT`在代码中的某处定义，也可以将其用作`switch($APPLICATION_ENVIRONMENT){..cases}`而不是 `switch(APPLICATION_ENVIRONMENT){..cases}`

# c - gcc 一个没有 main 的程序试图插入断点进行分析

> ID：11218708
> 
> 赞同：2
> 
> 时间：2012-06-27T02:44:21.823
> 
> 标签：c, gdb, breakpoints

我得到了一个需要分析的文件。它没有定义的 main，我试图让它读取断点。

我正在使用 gdb 并使用电源来解决问题，但这似乎有所不同。我如何能够创建一个断点，这样循环就不会等待用户输入，而是允许我检查输入的比较内容？

```
 (gdb) run
 Starting program: [directory here]
 Reading symbols from shared object read from target memory...(no debugging symbols found)...done.
 Loaded system supplied DSO at 0xffffe000
 (no debugging symbols found)
 (no debugging symbols found) 
```

# android - Android 手机使用错误的可绘制文件夹

> ID：11218709
> 
> 赞同：0
> 
> 时间：2012-06-27T02:44:22.873
> 
> 标签：android, android-emulator, drawable, android-screen

我目前在 2.3.3 上为我的应用程序设置了所有标准可绘制文件夹。(ldpi hdpi mdpi xhdpi) 但是，每当我在 240dpi 屏幕 (hdpi) 上运行应用程序时，它都会使用在 drawable-mdpi 而不是 drawable-hdpi 中找到的资源。当我删除 mdpi 文件夹时，一切正常。在其他屏幕密度上进行测试效果很好。只是不是 hdpi 屏幕。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T23:37:49.987

我的清单文件中缺少一些声明。添加这些解决了我的问题。

```
 <uses-sdk android:minSdkVersion="4" /> 
```

和

```
 <supports-screens
    android:smallScreens="true"
    android:normalScreens="true"
    android:largeScreens="true"
    android:anyDensity="true" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T05:08:51.510

240dpi 屏幕仅采用 ldpi drawable 文件夹，如果没有 ldpi drawable，它将自动获得 mdpi drawable.... hdpi drawable 意味着高密度像素（480dpi）

# mysql - 带有 TINYTEXT 列的 CREATE TABLE 语句中的语法错误 1064？

> ID：11218713
> 
> 赞同：0
> 
> 时间：2012-06-27T02:44:52.513
> 
> 标签：mysql, command-line, mysql-error-1064, create-table

这是我到目前为止的 MySQL 代码：

```
CREATE DATABASE bankbase;

USE bankbase;

CREATE TABLE clienttable(
ClientID SMALLINT(15) NOT NULL DEFAULT 0,
ClientFirstName VARCHAR(30) NOT NULL DEFAULT "first name",
ClientLastName VARCHAR(30) NOT NULL DEFAULT "last name",
ClientPhone CHAR(10) NOT NULL, ClientEmail 

TINYTEXT(30) NULL,
ClientAddress TINYTEXT(128) NOT NULL,
PRIMARYKEY(ClientID)
);

CREATE TABLE branchtable(
BranchID SMALLINT(15) NOT NULL DEFAULT 0,
BranchCity TINYTEXT(30) NOT NULL DEFAULT city, 

BranchManagerFName VARCHAR(30) NULL DEFAULT "Branch Manager's First Name",
BranchManagerLName VARCHAR(30) NULL 

DEFAULT "Branch Manager's LAst Name",
BranchPhone CHAR(10) NOT NULL,
BranchEmail TINYTEXT(30) NULL DEFAULT @bank.com,
PRIMARYKEY(BranchID)
);

CREATE TABLE transactiontable(
TypeID SMALLINT(15) NOT NULL DEFAULT 0,
Type ENUM('CHEQUING','SAVINGS') NOT NULL,
TransAmount DECIMAL NOT NULL,
TransDate TIMESTAMP NOT NULL,
Balance DOUBLE NOT NULL,
PRIMARYKEY(TypeID)
); 
```

在命令行上在 MySQL 中运行此代码会给我这个错误：

> ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 7 行的 '(TypeID) )' 附近使用正确的语法

我尝试创建不同的测试表，忽略 NULL/NOT NULL，但似乎没有任何效果。任何帮助将非常非常感谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T02:51:12.823

以下是我在您的原始脚本中看到的问题：

1.  `BLOB`并且`TEXT`列不能有`DEFAULT`值。

2.  `TINYTEXT`与 相同`VARCHAR(255)`，因此您不能为`TINYTEXT`字段声明最大长度，因为已经隐含了一个。

3.  您需要在单词之间留一个空格`PRIMARYKEY`。应该是`PRIMARY KEY`。

4.  最后，这本身不是问题，但在您的第一个`CREATE TABLE`陈述中，您有奇数间距。将行更改`ClientEmail`为以下内容使其更具可读性：

好多了：

```
ClientPhone CHAR(10) NOT NULL,
ClientEmail TINYTEXT NOT NULL, 
```

有关更多信息，请参阅[MySQL 文档](https://dev.mysql.com/doc/refman/5.0/en/blob.html)。在所有这些更正之后，这些是有效的 MySQL 查询：

```
CREATE DATABASE bankbase;
USE bankbase;

CREATE TABLE clienttable(
ClientID SMALLINT(15) NOT NULL DEFAULT 0,
ClientFirstName VARCHAR(30) NOT NULL DEFAULT "first name",
ClientLastName VARCHAR(30) NOT NULL DEFAULT "last name",
ClientPhone CHAR(10) NOT NULL,
ClientEmail TINYTEXT NULL,
ClientAddress TINYTEXT NOT NULL,
PRIMARY KEY(ClientID)
);

CREATE TABLE branchtable(
BranchID SMALLINT(15) NOT NULL DEFAULT 0,
BranchCity TINYTEXT NOT NULL,
BranchManagerFName VARCHAR(30) NULL DEFAULT "Branch Manager's First Name", 
BranchManagerLName VARCHAR(30) NULL DEFAULT "Branch Manager's LAst Name",
BranchPhone CHAR(10) NOT NULL,
BranchEmail TINYTEXT NULL,
PRIMARY KEY(BranchID)
);

CREATE TABLE transactiontable(
TypeID SMALLINT(15) NOT NULL DEFAULT 0,
Type ENUM('CHEQUING','SAVINGS') NOT NULL,
TransAmount DECIMAL NOT NULL,
TransDate TIMESTAMP NOT NULL,
Balance DOUBLE NOT NULL,
PRIMARY KEY(TypeID)
); 
```

如果您单击[此 SQL fiddle](http://sqlfiddle.com/#!2/40854)`Build Schema`，您会发现它有效！

## 有关如何有条不紊地修复此类错误的更多信息

如果你有条不紊，这些问题很容易解决，尤其是使用`CREATE TABLE`语句。例如，当您调试第一`CREATE TABLE`条语句时，一次移动一个列声明。

尝试只用第一列制作一个表格：

```
CREATE TABLE clienttable(
ClientID SMALLINT(15) NOT NULL DEFAULT 0); 
```

该代码有效，因此删除表并一一添加列，直到添加引发错误的列：

```
DROP TABLE clienttable;
CREATE TABLE clienttable(
ClientID SMALLINT(15) NOT NULL DEFAULT 0,
ClientFirstName VARCHAR(30) NOT NULL DEFAULT "first name",
ClientLastName VARCHAR(30) NOT NULL DEFAULT "last name",
ClientPhone CHAR(10) NOT NULL, ClientEmail 

TINYTEXT(30) NULL); 
```

我们收到您询问的错误：

> ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 7 行的 '(30) NULL)' 附近使用正确的语法

现在您确切地知道哪一行有错误。我什至偶尔会看到这样编写的代码（这与上一个示例中的代码相同）：

```
CREATE TABLE clienttable(
ClientID
SMALLINT(15) 
NOT NULL 
DEFAULT 0,
ClientFirstName 
VARCHAR(30) 
NOT NULL 
DEFAULT "first name",
ClientLastName 
VARCHAR(30) 
NOT NULL 
DEFAULT "last name",
ClientPhone 
CHAR(10) 
NOT NULL,
ClientEmail 
TINYTEXT(30) //Line 18 <- This is where the error occurs 
NULL); 
```

是的，它的可读性不高，但是如果我们运行它，我们会得到一个语法错误`at line 18`，即该`TINYTEXT(30)`行。阅读文档、在线询问等会告诉你这是错误的。修复所有错误后，再次使代码可读，然后就可以了。

# android - Android中的通用点击事件

> ID：11218714
> 
> 赞同：0
> 
> 时间：2012-06-27T02:45:05.617
> 
> 标签：android, imagebutton, onclicklistener

最近我能够为我的脑瘫女孩创建一个平板电脑软件来和我“说话”，因为她不会说话。

好吧，我的一个朋友患有肌萎缩侧索硬化症 (ALS)。他能动一根手指，他愿意用我女儿的软件再次“说话”。

由于他只能移动一根手指，因此我创建了一个版本，其中每个项目“闪烁”（黄色）一段时间（仅一秒钟），如果他按下鼠标按钮，则激活聚焦的项目（黄色）。

见下文：

![通讯软件](../Images/f62b5deb32fb68095fde41e916e922e8.png)

如果您将鼠标放在屏幕的黑色部分上，它会起作用。如果鼠标在按钮上，它将不起作用，它将单击鼠标所在的按钮。

此外，如果他使用键盘并按下 ENTER 键，它将激活第一个按钮，然后，如果他单击左箭头然后再次按下 ENTER，它将激活第二个按钮，依此类推。

所以，我希望我可以创建一个通用事件，如果他按下 ENTER 键，则只会激活选定的（黄色）项目。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T02:56:06.800

那么你可以制作两种不同的模式。一种是每张图片都有点击监听器，另一种是只需点击屏幕上的任意位置即可识别（例如，找到最大的布局 id 并设置一个监听器）。然后在第二种模式下，使用

[http://developer.android.com/reference/android/view/KeyEvent.html](http://developer.android.com/reference/android/view/KeyEvent.html)

检测 Enter 等 KeyEvent，并根据突出显示的 View 处理它们。

# javascript - 检查值是否存在于数组位置

> ID：11218718
> 
> 赞同：1
> 
> 时间：2012-06-27T02:45:36.710
> 
> 标签：javascript

我有一个名为“数据”的大数组。

在第 10 个数组位置，我的数据值为：

```
[10] => 1,2 
```

现在我试图在 JS 中做的是这样的：

```
 i = 1;
 if(i in data[10]){
   //great success, very nice!
 } 
```

我认为逗号分隔的数据可能像一个带有“IN”方法的数组，但它不起作用。我收到此错误：

```
 Uncaught TypeError: Cannot use 'in' operator to search for '1' in 1,2 
```

我的问题的正确解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T02:54:26.470

您没有显示分配`1,2`给`data[10]`. 的值`1,2`很简单`2`，正如您在 JavaScript 外壳/控制台中执行以下命令所看到的那样。有关逗号运算符的工作原理，请参阅[参考资料](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Comma_Operator)。

但是，您收到的错误消息表明您有 string `"1,2"`。要将其转换为数组，您应该使用`split()`如下：

```
> data[10] = "1,2"
1,2
> data[10].split(',')
[ "1", "2" ] 
```

要迭代值，您可以`in`在结果数组上使用运算符，如下所示：

```
var data = new Array();
data[10] = '1,2';
var valueArray = data[10].split(',');
for (var i in valueArray) {
  alert('valueArray[' + i + '] is ' + valueArray[i]);
} 
```

您可以在浏览器控制台中运行它，它`alert`会显示两条消息：

*   valueArray[0] 为 1
*   valueArray[1] 为 2

请注意，您不需要`i`在循环开始之前进行初始化。操作员将自动执行此`in`操作。此外，使用局部变量是一种很好的做法，因此`var i`在上面的代码中。

附带说明一下，如果您是 JS 新手，但需要处理大量数据结构操作，那么值得学习[underscore.js](http://underscorejs.org/)。特地来看看`_.each()`。下划线可以使您免于编写大量循环逻辑。

但是，如果您想进行成员资格检查，则需要使用 not `in`but `Array.indexOf()`。请参阅 [http://jsfiddle.net/nRS9m](http://jsfiddle.net/nRS9m)以获取评论中从您的 jsfiddle 分叉的示例。更多示例：

```
> valueArray
[ "1", "2" ]
> valueArray.indexOf("3")
-1
> valueArray.indexOf("1")
0
> valueArray.indexOf("2")
1
> valueArray.indexOf(1)
-1
> valueArray.indexOf((1).toString())
0 
```

# expressionengine - 表达式引擎限制分页和反向相关条目

> ID：11218719
> 
> 赞同：0
> 
> 时间：2012-06-27T02:45:52.717
> 
> 标签：expressionengine

我有一个运行 EE 1.7 的 EE 站点。这是一个杂志网站，每月都有“版本”，每个版本可能有也可能没有书评。在网站上，我需要按版本按时间倒序列出书评。这是我的代码：

```
{exp:weblog:entries weblog="editions" orderby="edition-date" sort="desc" disable="categories|member_data|trackbacks" limit="10" paginate="bottom"}
 {reverse_related_entries weblog="book-reviews"}
  .... 
```

我的问题是分页是根据版本博客工作的，因此分页不包含任何书评的版本。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T18:44:32.683

有点棘手，您需要为此使用嵌入（或者您可以创建一个小插件以类似的方式执行此操作）。

在您的模板中尝试此设置。将查询中的 weblog_ids 替换为您自己的（在此示例中，**1**是**editions**，**2**是**book-reviews**）。

```
{embed="embeds/reviews" entry_ids="{exp:query 
    sql="SELECT DISTINCT r.rel_child_id FROM exp_relationships r, exp_weblog_titles t  WHERE r.rel_parent_id  IN( SELECT entry_id  FROM exp_weblog_titles  WHERE weblog_id = 2 )  AND r.rel_child_id = t.entry_id  AND t.weblog_id = 1" 
    backspace="1"}{rel_child_id}|{/exp:query}"} 
```

然后，在**嵌入/评论**中：

```
{exp:weblog:entries weblog="editions" entry_id="{embed:entry_ids}" orderby="edition-date" sort="desc" disable="categories|member_data|trackbacks" limit="10" paginate="bottom"}
    {reverse_related_entries weblog="book-reviews"}
    ... 
```

# java - 与另一个任务并行运行一个任务

> ID：11218720
> 
> 赞同：3
> 
> 时间：2012-06-27T02:46:00.330
> 
> 标签：java, multithreading, threadpool, executor

我有以下`Foo`使用类的`FooProcessor`类。所以我想做的是，在运行 cp1 实例进程方法时，我想并行运行`cp2.process()`.

```
public class Foo {

    public static void main(String [] args){

        FooProcessor cp1 = new FooProcessor();
        FooProcessor cp2 = new FooProcessor();

        cp1.process();
        // in parallel process cp2.process();
    }

}

public class FooProcessor {
    public void process(){
        System.out.println("Processing..");
    }
} 
```

但是，我希望 cp1 按顺序运行，所以我希望它运行并完成，如果 cp2 没有完成或失败，那很好。如果它没有失败，我想加入结果。它没有返回此示例中的任何内容，但我想返回结果。

为此，应该使用TaskExecutor吗？还是线程？

我只希望 cp2 与 cp1 并行运行。或者如果我添加更多让我们说 cp3，我希望它也与 cp1 并行运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T15:41:53.857

总之，我将实现它的方式：

*   例如，通过[ExecutorService运行您的不同进程](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)`ExecutorService executor = Executors.newFixedThreadPool(nThreads);`
*   [将所有任务的Futures](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html)存储在列表中（由 ExecutorService#submit 返回）
*   等待[`future1.get()`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html#get%28%29)完成，`future1`cp1链接的future在哪里
*   一旦`get`返回（cp1 已完成）[取消](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Future.html#cancel%28boolean%29)所有其他期货，（[`shutdownNow`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html#shutdownNow%28%29)如果您不再需要执行程序，则取消执行程序服务）
*   为了使取消过程正常工作，您的 cp2、cp3 等需要实施中断政策，使他们尽快停止正在做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:32:18.280

您当然可以使用简单明了的线程
如果您知道需要向处理器类添加更多方法，并且对于它的给定实例以保持执行顺序 - 假设您首先运行方法 foo，然后运行方法 bar，然后您希望它们异步运行，但保持执行顺序（首先是 foo，然后是 bar），我会考虑使用[Active Object](http://en.wikipedia.org/wiki/Active_object)模式。
我也推荐使用这种方法，因为对于处理器类的用户来说，它会隐藏实现细节。
另外，考虑提供一个[装饰器](http://en.wikipedia.org/wiki/Decorator_pattern)/wrapper 将为您的对象提供这种异步能力 - 这样您将能够控制哪些对象异步运行，哪些不是，并且您不必使用异步调用所需的代码“污染”您的处理器类。
在这种情况下的使用示例将是 -

```
AsyncProcessor ap  = new AsyncProcessor(p1);
ap.process();  //executed asynchronously
Proccessor p2 = new Processor();
p2.process(); //executed synchronously 
```

另一种方法是使用您提到的执行器 - 这可以通过实现线程池并将“执行单元推送给它”来实现。
一个执行单元将包含目标对象（cp1，cp2，...）和执行方法（当前 - 仅进程）
线程将从队列中获取“一个执行单元”并运行它们。
实现类似于活动对象，但用户的“接口”不同，因为它使用“TaskExecutor”类为其提供“执行单元”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:35:25.907

线程将是一个不错的选择...类似于接受新线程并启动它们的方法...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T03:35:49.137

根据[https://stackoverflow.com/a/2269177/454167](https://stackoverflow.com/a/2269177/454167)，

你可以使用类似`AsyncTaskExecutor`[1] 的东西，它返回一个`Future`对象。然后，您可以等待 Future 知道 cp2 是否返回成功。

[1] [http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/core/task/AsyncTaskExecutor.html#submit%28java.lang.Runnable%29](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/core/task/AsyncTaskExecutor.html#submit%28java.lang.Runnable%29)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T04:46:50.880

如果您正在编写自己的独立应用程序，那么使用线程可能是最简单的方法。如果您在 Java EE 环境中，则不应创建自己的 Thread 对象，而应使用其他一些机制（例如发送消息并让消息侦听器处理您发送的信号）。这是为了让 Java EE 容器控制资源利用，例如线程池。

使用线程的示例：

```
Thread t1 = new Thread(new Runnable() {
    @Override
    public void run() {
         executeSomeCodeInP1();
    }
});

Thread t2 = new Thread(new Runnable() {
    @Override
    public void run() {
         executeSomeCodeInP2();
    }
});

t1.start();
t2.start();

// if you want to wait for both threads to finish before moving on, 
// "join" the current thread
t1.join();
t2.join(); 
```

# android - 有条件地禁用 Android Beam

> ID：11218721
> 
> 赞同：2
> 
> 时间：2012-06-27T02:46:04.740
> 
> 标签：android, nfc, android-beam

这个问题几乎是[重复](https://stackoverflow.com/questions/9020901/disable-android-beam-for-selected-activities)的，但链接的问题从未真正解决，而且该线程已有几个月的历史，所以我不想复活它。

在打开 Android Beam 的 ICS 设备上运行的应用程序的默认行为是使用应用程序 Uri 推送消息，该消息将由 Google Play 在接收端处理。

我正在尝试开发一个活动，如果条件 A 为真，它将推送 NdefMessage，否则将禁用推送消息。的 API 文档[`setNdefPushMessage(...)`](http://developer.android.com/reference/android/nfc/NfcAdapter.html#setNdefPushMessage%28android.nfc.NdefMessage,%20android.app.Activity,%20android.app.Activity...%29)似乎表明这可以通过传入空消息来实现：

> 传递空 NDEF 消息以禁用指定活动中的前台 NDEF 推送。

但是，尝试通过以下代码简单地禁止所有推送仍然会导致“Touch to Beam” UI 出现并发送应用程序 Uri ......

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    getNfcAdapter().setNdefPushMessage(null, this);
} 
```

有谁知道是否真的可以禁用来自活动的推送？一些系统应用程序可以做到这一点，但我无法找到实现这一点的代码。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-09T09:38:49.257

这似乎是 Android ICS 中的一个错误。尽管文档说您应该能够通过将 NDEF 消息设置为 null 来禁用它，但这根本不起作用。好消息是它已经修复，现在可以在 Android 4.1 Jellybean 中使用。

# mysql - 用于组合两个表和洗牌结果的 Sql 查询创建

> ID：11218722
> 
> 赞同：0
> 
> 时间：2012-06-27T02:46:15.773
> 
> 标签：mysql, sql

我想创建一个 SQL 查询，在我的数据库中选择女性的图片，然后在选择男性图片之后随机化这些图片，而不是随机化它们。例如，有 40 张女孩的照片和 60 张男孩的照片。我想要选择第 40 张女孩的照片（洗牌，然后选择剩余的男孩照片（洗牌）

希望我很清楚。我有两个表，“userID”字段是链接两个表的字段。

> 用户表（年龄、用户ID、性别）| 图片表（ UserID , numberoflikes , picure_location ）

无论如何我可以生成这个查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T02:54:46.097

```
SELECT picure_location
FROM Picture
  INNER JOIN User ON Picture.UserID=User.UserID
ORDER BY gender,RAND() 
```

`ORDER BY GENDER DESC, RAND()`根据您代表性别的方式，您可能需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:48:55.657

请尝试以下方法：

```
SET @num1=0, @num2=0;
SELECT t1.*, p1.picturelocation,t2.*, p2.picturelocation 
FROM (
    SELECT UserID,gender, @num1:=@num1+1 AS num
    FROM UserTable WHERE gender='Female'
) AS t1
INNER JOIN (
    SELECT UserID,gender, @num2:=@num2+1 AS num
    FROM (
        SELECT *
        FROM UserTable WHERE gender='Male'
        ORDER BY RAND()
        LIMIT 40
    ) AS t
) AS t2
ON t1.num = t2.num 
INNER JOIN PictureTable p1 on t1.userid=p1.userid 
INNER JOIN PictureTable p2 on t2.userid=p2.userid; 
```

# timezone - GMail 对内部 IMAP 邮件存储使用什么时区？

> ID：11218727
> 
> 赞同：1
> 
> 时间：2012-06-27T02:47:34.727
> 
> 标签：timezone, gmail, imap

我们的实验表明，GMail 在其邮件存储中的内部日期不使用 UTC。有人知道它使用什么偏移量吗？我们已将其缩小到比 UTC 晚 3 到 7 小时（不包括），我们可以通过进一步的实验来解决这个问题，但也许有人知道。如果您假设 UTC，则 UID SEARCH 等不是很准确，但事实并非如此。:-)

此外，我们想知道无论您在世界上的哪个地方连接到 gmail，它是否都是一致的。

更新：第一次测试显示 UTC-4 或 UTC-5，我做的第二次测试（发送每小时电子邮件）显示我的帐户是 UTC-7。我们想知道它是否在您注册时根据您的源 IP 设置（我还注册了一个 UTC-10 时区的帐户，内部存储仍然是 UTC-7。稍后更改您的帐户时区不会更改内部存储IMAP 客户端看到的日期，我认为是明智的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T18:33:54.357

我编写了一个 python IMAP lib 客户端并确认 Gmail 时区是 UTC-07:00，我已经一遍又一遍地确认它。因此，您获得的任何搜索结果（更准确地说是 after：startDate 和 before：endDate 查询）都会根据您当地的时区移动这么多量。这是因为邮件存储根据发件人 SMTP 服务器使用本地时间，如果是 gmail，则恰好是 UTC-07:00。

# jpa - JPA - 使用多个数据源来定义访问控制

> ID：11218728
> 
> 赞同：1
> 
> 时间：2012-06-27T02:47:49.470
> 
> 标签：jpa, glassfish, eclipselink, persistence-unit

我对 JPA 和 JSF 完全陌生，希望您能帮助我解决我的问题。我的应用程序是使用 JSF 2.0 框架构建的，使用在 Glassfish 3+、MySQL 上运行的 JPA 2.0/EclipseLink。

我使用数据源设置了一个名为“loginPU”的持久性单元：“jdbc/loginDataSource”“jdbc/loginDataSource”使用“login1”（在 .table 中定义）连接到 MySQL，`mysql`并且`user`只能访问`customer`. `user`和`customer`。`roles`表，只有选择权限。

我在 Glassfish JDBC 资源中创建了 2 个其他数据源“jdbc/admin”和“jdbc/staff”，并且都具有不同的权限

登录/认证场景是：

1.  使用基于表单的身份验证（用户名和密码）的用户登录
2.  使用持久性单元“loginPU”和“jdbc/loginDataSource”创建 EntityManageFactory
3.  创建查询以检索用户角色
4.  如果用户角色是管理员，则使用“jdbc/admin”数据源进行连接
5.  如果用户角色是人员，则使用“jdbc/staff”数据源进行连接

我上面第 2 项的代码如下所示：

```
Map properties = new HashMap(); 
properties.put(TRANSACTION_TYPE, "JTA");

// Configure the internal EclipseLink connection pool
properties.put(JDBC_DRIVER, "com.mysql.jdbc.Driver");
properties.put(JDBC_URL, "jdbc:mysql://localhost:3306/customer");
properties.put(JDBC_USER, "login1");
properties.put(JDBC_PASSWORD, "login1");
properties.put(JTA_DATASOURCE, "jdbc/loginDataSource");

EntityManageFactory emf = Persistence.createEntityManagerFactory("loginPU",properties); 
```

我什至将我的 EntityManagerFactory 保存在会话属性中并在 JpaController 类中检索它

```
//save into session
session.setAttribute("entityManagerFactory", emf);

//retrieved in JpaController
public EntityManagerFactory getEmf() {

        HttpServletRequest request = (HttpServletRequest) FacesContext.getCurrentInstance().getExternalContext().getRequest();
        HttpSession s = request.getSession(true);
        try {
            emf = (EntityManagerFactory) s.getAttribute("entityManagerFactory");
        } catch(NullPointerException ne){
            System.out.println("EMF Exception: "+ne);
        }

        return emf;
    } 
```

> 问题：我怎样才能达到 4 号或 5 号？那有可能吗？是否可以将任一数据源分配给“loginPU”持久性单元？我设法使用 loginPU 和 jdbc/loginDataSource 建立连接，然后使用 jdbc/admin 数据源进行连接，但是当我访问其他实体时，它会抛出错误并默认为 jdbc/loginDataSource

注意：我使用由 netbeans 创建的 JpaController 类，以及会话 bean 来管理实体。我的 JpaController 类使用

```
@Resource private UserTransaction utx;
@PersistenceUnit private EntityManagerFactory emf; 
```

我的会话 bean 都是 @Stateless，我尝试使用 @PersistenceContext 和 unitName 和没有 unitName 但没有运气

```
@PersistenceContext
private EntityManager em; 
```

我尝试在persistence.xml中使用多个持久性单元，希望使用基于角色的持久性单元名称连接用户，但是在部署到服务器时它给了我错误。

我阅读了有关[应用程序管理的持久性](http://docs.oracle.com/javaee/6/tutorial/doc/bnbqw.html)和[容器管理的](http://docs.oracle.com/javaee/6/tutorial/doc/bnbqw.html)内容，我想我想要实现的是使用应用程序管理，但不知道该怎么做。

如果我要使用容器管理的持久性，是否可以使用多个数据源？非常感谢任何建议。

感谢您提前提出任何意见或建议。

**[解决了]**

1.  首先，我将我的 persistence.xml 定义如下：

    ```
    <persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
        <persistence-unit name="mdbAdminPU" >
            <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
            <jta-data-source>jdbc/login</jta-data-source>
            <exclude-unlisted-classes>false</exclude-unlisted-classes>
        </persistence-unit>
    </persistence> 
    ```

2.  我的会话 bean 中没有使用任何 @PersistenceUnit 或 @PersistenceContext。（我使用的是 Netbeans，这些 bean 是在我从实体类创建 JSF 页面时创建的）

3.  在所有会话 bean 中，它们看起来像这样：

    ```
    @Stateless
    public class UserFacade extends AbstractFacade<User> {

        @Override
        protected EntityManager getEntityManager() {
            HttpSession session = (HttpSession) FacesContext.getCurrentInstance().getExternalContext().getSession(false);
            EntityManagerFactory emf = (EntityManagerFactory) session.getAttribute("entityManagerFactory");
            EntityManager em = emf.createEntityManager(); 
            return em;
        }

        public UserFacade() {
            super(User.class);
        }
    } 
    ```

4.  上面的登录场景（5项）变成了7个：

> 1.  使用基于表单的身份验证（用户名和密码）的用户登录
> 2.  使用持久性单元“loginPU”和“jdbc/loginDataSource”创建 EntityManageFactory
> 3.  创建查询以检索用户角色
> 4.  如果用户角色是管理员，则使用“jdbc/admin”数据源进行连接
> 5.  如果用户角色是人员，则使用“jdbc/staff”数据源进行连接

加

> 1.  使用 emf.close() 删除或清除在第 2 项中创建的 EntityManagerFactory；
> 2.  保持在 HttpSession 的第 4 项或第 5 项中创建的新 EntityManagerFactory

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T12:37:27.457

如果您需要三个不同的登录名，您最好在 persistence.xml 中使用三个独立的持久性单元。或者只需一个具有完全访问权限的登录并验证您的应用程序中的安全性（无论如何您似乎都在做部分工作）。

你在部署时遇到了什么错误？

您可以使用 EclipseLink 中的一个持久性单元来完成此操作，但涉及更多，并且您不能使用容器管理的实体管理器。您将注入一个@PersistenceUnit (EntityManagerFactory) 而不是@PersistenceContext (EntityManager)，然后您需要将新的登录参数传递给createEntityManager()。您需要将“eclipselink.jdbc.exclusive-connection.mode”属性设置为“始终”（或“隔离”并使安全数据隔离）。

见， [http://wiki.eclipse.org/EclipseLink/Examples/JPA/Auditing](http://wiki.eclipse.org/EclipseLink/Examples/JPA/Auditing)

# haskell - 为什么我被迫用小写的第一个字母写（数据构造函数）名称？

> ID：11218730
> 
> 赞同：4
> 
> 时间：2012-06-27T02:48:23.890
> 
> 标签：haskell

为什么我被迫`liOfLi`代替写作`LiOfLi`？请指导。

baby.hs 中的代码

> LiOfLi = [ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ]

ghci 回复：

> ghci> :l baby
> [1 of 1] 编译 Main（baby.hs，解释）
> 失败，加载模块：无。
> 
> ghci> baby.hs:29:1：不在范围内：数据构造函数“LiOfLi”

将首字母改为小写时

baby.hs 中的代码

> liOfLi = [ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ]

ghci 回复：

> ghci> :l baby
> [1 of 1] 编译 Main（baby.hs，解释）
> 好的，加载的模块：Main。

以下是我提到的 SO 问题，但我无法理解规则/逻辑并得到（我的）上述问题的答案。

[为什么 Haskell 强制数据构造函数的第一个字母大写？](https://stackoverflow.com/questions/6237775/why-does-haskell-force-data-constructors-first-letter-to-be-upper-case)

变量名需要小写。与此相关的官方文档位于[haskell.org/onlinereport/intro.html#namespaces – （由](http://www.haskell.org/onlinereport/intro.html#namespaces)[Chris Kuklewicz](https://stackoverflow.com/questions/8010850/haskell-not-in-scope-data-constructor#comment9803452_8010850)发表的 SO 评论）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T03:14:46.337

数据构造函数（也包括类型构造函数）必须以大写字母开头。在实际编译的第二个示例中，`liOfLi`它不是数据构造函数，而是一个变量（以小写字母开头）。

这：

```
liOfLi = [ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ] 
```

声明一个变量`liOfLi`等于`[ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ]`.

另一方面，这是：

```
LiOfLi = [ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ] 
```

是模式与`LiOfLi`表达式的模式匹配`[ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ]`。作为模式匹配，它相当无用，因为它不包含任何变量，所以即使它有效，它也不会做任何事情。它无法编译`LiOfLi`，因为模式正在寻找与`LiOfLi`应用于 0 参数的构造函数匹配的所有表达式；因为在`LiOfLi`您的程序无法编译的任何地方都没有定义构造函数。

您可以成为 0 参数构造函数的唯一方法`LiOfLi`是引入一个新类型，如下所示：

```
data MyNewType = LiOfLi 
```

但`LiOfLi = [ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ]`仍然行不通，因为它试图将 pattern `LiOfLi`（这是 type 值的模式`MyNewType`）与`[ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ]`value （列表类型的值）相匹配。

基本上，这个方程意味着两个不同的东西，这取决于左边的术语`=`是被解释为模式还是变量。Haskell 的设计者选择让（对于人类读者和编译器）总是很容易通过首字母的大小写来判断给定标识符是构造函数还是变量，这反过来又允许您判断方程是否是模式绑定或变量定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T03:11:59.387

当你写

```
liOfLi = [ [1,3,4,5,6,8], [ 12, 13, 15, 16, 19, 20], [23, 24, 25, 45, 56] ] 
```

您定义**变量** `liOfLi`以产生列表列表给出的值。相反，[数据构造](http://www.haskell.org/haskellwiki/Constructor#Data_constructor)器用于定义代数数据类型，例如，您可以定义以下数据类型：

```
data Tree a = Nil | Node a (Tree a) (Tree a) 
```

在这里，`Nil`and`Node`都是 type 的数据构造函数`Tree a`。您可以在 ghci 中查看它们的类型，这将显示：

```
Node :: a -> Tree a -> Tree a -> Tree a
Nil  :: Tree a 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T03:15:59.373

Haskell 中的“数据构造函数”连接到自定义类型。它给数据一个特定的上下文，它实际上不是数据。类型和数据构造函数必须是大写的。

小写字母表示函数或变量的名称。当您在示例中使用该小写名称时，可以将其替换为右侧的列表。

在这种情况下，数据构造函数是`[]`（实际上是其他东西的简写）。

# ruby - 我可以从哪里获得 Fedora 16 的 nsslowhash 库？最好来源

> ID：11218734
> 
> 赞同：0
> 
> 时间：2012-06-27T02:48:48.713
> 
> 标签：ruby, gem, mysql2

在 Fedora 16 上尝试使用 ruby​​ 1.9.2-p320 构建 mysql2 gem 时，我遇到了这个错误，可以像这样重现：

```
gremlin:mysql2 $ cat conftest.c
    #include "ruby.h"

    /*top*/
    int main() {return 0;}
    int t() {
      void ((*volatile p)());
      p = (void ((*)()))rb_thread_blocking_region;
      return 0;
    }

gremlin:mysql2 $ gcc -o conftest -I/usr/local/include/ruby-1.9.1/i686-linux \
    -I/usr/local/include/ruby-1.9.1/ruby/backward 
    -I/usr/local/include/ruby-1.9.1 -I. 
    -I/usr/local/include/ruby-1.9.1/  
    -D_FILE_OFFSET_BITS=64   -O3 -ggdb -Wextra -Wno-unused-parameter 
    -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-missing-field-initializers
    -Wno-long-long conftest.c  -L. -L/usr/local/lib -Wl,-R/usr/local/lib -L.  
    -rdynamic -Wl,-export-dynamic     -Wl,-R -Wl,/usr/local/lib -L/usr/local/lib 
    -lruby-static  -lpthread -lrt -ldl -lnss3 -lcrypt -lm   -lc

    /usr/lib/gcc/i686-redhat-linux/4.6.3/../../../libcrypt.a(md5-crypt.o): 
    In function `__md5_crypt_r':
            (.text+0x96): undefined reference to `NSSLOW_Init'

    /usr/lib/gcc/i686-redhat-linux/4.6.3/../../../libcrypt.a(md5-crypt.o): 
    In function `__md5_crypt_r':
            (.text+0xb1): undefined reference to `NSSLOWHASH_NewContext' 
```

...以及 nsslowhash 库中其他全局函数的更多消息，它看起来像 /usr/lib/libcrypt.a 期望可用，但我没有安装它，也找不到源.

实际上，这并不完全正确。我发现 nsslowhash 作为 Firefox 的 Mozilla-Central 构建的一部分，但是当我在已编译的 .a 和 .so 文件上运行 nm 时，它们都没有定义任何与 NSSLOW 匹配的内容。那么这些名字是从哪里来的呢？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-30T06:26:12.347

通过将 -lfreebl3 添加到 LIBS CONFIG 设置解决了问题。

# java - 将 Java 应用程序与 HTML 页面集成

> ID：11218736
> 
> 赞同：0
> 
> 时间：2012-06-27T02:49:07.313
> 
> 标签：java, html, web-services, file-io, integration

我创建了一个 java 应用程序，它将发现文件夹中的所有文件并告诉我哪个是最新的。如何让网页每 5 秒左右运行一次 java 应用程序并在网页上显示指向最新文件的链接？

谢谢大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:45:34.073

您应该创建一个 Java 小程序并将其集成到 Html 页面。

# ruby-on-rails - Rails / HAML将字符串提取到语言环境文件中？

> ID：11218742
> 
> 赞同：1
> 
> 时间：2012-06-27T02:49:40.370
> 
> 标签：ruby-on-rails, internationalization, haml

我有一堆haml，我需要从语言环境文件中提取字符串以供非开发人员审查和翻译。

有没有一种自动化的方法来做到这一点？找到所有字符串并将它们组织到语言环境文件中的脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T06:25:25.473

刚刚开始研究这个：

[https://github.com/shaiguitar/haml-i18n-extractor](https://github.com/shaiguitar/haml-i18n-extractor)

现在是WIP。欢迎投稿。

# algorithm - 连通图中的桥梁

> ID：11218746
> 
> 赞同：32
> 
> 时间：2012-06-27T02:50:25.303
> 
> 标签：algorithm, graph

我有一个编程任务（不是家庭作业。）我必须在图中找到桥梁。我自己做了一些工作，但无法提出任何令人满意的结果。所以我用谷歌搜索了它，我确实找到了一些东西，但我无法理解它所呈现的算法。有人可以看看这段代码并给我一个解释吗？

```
public Bridge(Graph G) {
    low = new int[G.V()];
    pre = new int[G.V()];
    for (int v = 0; v < G.V(); v++) low[v] = -1;
    for (int v = 0; v < G.V(); v++) pre[v] = -1;

    for (int v = 0; v < G.V(); v++)
        if (pre[v] == -1)
            dfs(G, v, v);
}

public int components() { return bridges + 1; }

private void dfs(Graph G, int u, int v) {
    pre[v] = cnt++;
    low[v] = pre[v];
    for (int w : G.adj(v)) {
        if (pre[w] == -1) {
            dfs(G, v, w);
            low[v] = Math.min(low[v], low[w]);
            if (low[w] == pre[w]) {
                StdOut.println(v + "-" + w + " is a bridge");
                bridges++;
            }
        }

        // update low number - ignore reverse of edge leading to v
        else if (w != u)
            low[v] = Math.min(low[v], pre[w]);
    }
} 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-06-27T07:38:01.550

Def：Bridge 是一条边，当移除时，将断开图（或将连接组件的数量增加 1）。

关于图中桥梁的一项观察；属于循环的所有边都不能是桥。所以在诸如 的图中`A--B--C--A`，去掉任何一条边`A--B`，`B--C`并`C--A`不会断开该图。但是，对于无向图，边`A--B`意味着`B--A`; 这个边缘仍然可能是一座桥，它所在的唯一循环是`A--B--A`. 因此，我们应该只考虑由后边缘形成的那些循环。这就是您在函数参数中传递的父信息有帮助的地方。它将帮助您不使用循环，例如`A--B--A`.

现在要识别后边缘（或循环），`A--B--C--A`我们使用`low`and`pre`数组。数组`pre`就像`visited`dfs算法中的数组；但我们不仅仅将顶点标记为已访问，而是用不同的数字标识每个顶点（根据它在 dfs 树中的位置）。该`low`数组有助于识别是否存在循环。数组标识当前顶点可以到达的最小编号（来自数组）顶点`low`。`pre`

让我们通过这个图表`A--B--C--D--B`。

从 A 开始

```
dfs:   ^                 ^                 ^                 ^              ^
pre:   0 -1 -1 -1 -1  0--1 -1 -1  1  0--1--2 -1  1  0--1--2--3  1  0--1--2--3--1
graph: A--B--C--D--B  A--B--C--D--B  A--B--C--D--B  A--B--C--D--B  A--B--C--D--B
low:   0 -1 -1 -1 -1  0--1 -1 -1  1  0--1--2 -1  1  0--1--2--3  1  0--1--2--3->1 
```

此时，您在图中遇到了一个循环/循环。这次在您的代码`if (pre[w] == -1)`中将是错误的。因此，您将进入 else 部分。if 语句检查是否`B`是 的父顶点`D`。不是，所以`D`会吸收`B`'`pre`值到`low`. 继续举例，

```
dfs:            ^
pre:   0--1--2--3
graph: A--B--C--D
low:   0--1--2--1 
```

这个`low`值通过代码`D`传播回来。`C``low[v] = Math.min(low[v], low[w]);`

```
dfs:         ^           ^           ^
pre:   0--1--2--3--1  0--1--2--3--1  0--1--2--3--1
graph: A--B--C--D--B  A--B--C--D--B  A--B--C--D--B
low:   0--1--1--1--1  0--1--1--1--1  0--1--1--1--1 
```

现在，循环/循环已被识别，我们注意到顶点`A`不是循环的一部分。所以，你打印出来`A--B`作为一个桥梁。该代码意味着将成为桥梁`low['B'] == pre['B']`的边缘。`B`这是因为，我们可以到达的最低顶点`B`就是`B`它自己。

希望这个解释有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-08T18:10:27.390

这不是一个新的答案，但我在 Python 中需要这个。以下是无向 NetworkX Graph 对象的算法翻译`G`：

```
def bridge_dfs(G,u,v,cnt,low,pre,bridges):
    cnt    += 1
    pre[v]  = cnt
    low[v]  = pre[v]

    for w in nx.neighbors(G,v):
        if (pre[w] == -1):
            bridge_dfs(G,v,w,cnt,low,pre,bridges)

            low[v] = min(low[v], low[w])
            if (low[w] == pre[w]):
                bridges.append((v,w))

        elif (w != u):
            low[v] = min(low[v], pre[w])

def get_bridges(G):
    bridges = []
    cnt     = 0
    low     = {n:-1 for n in G.nodes()}
    pre     = low.copy()

    for n in G.nodes():
         bridge_dfs(G, n, n, cnt, low, pre, bridges)

    return bridges # <- List of (node-node) tuples for all bridges in G 
```

小心 Python 对大图的递归深度限制器......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-05T23:10:41.883

这不是一个新的答案，但我需要这个用于 JVM/Kotlin。这是一个依赖于`com.google.common.graph.Graph`.

```
/**
 * [T] The type of key held in the [graph].
 */
private class BridgeComputer<T>(private val graph: ImmutableGraph<T>) {
    /**
     * Counter.
     */
    private var count = 0
    /**
     * `low[v]` = Lowest preorder of any vertex connected to `v`.
     */
    private val low: MutableMap<T, Int> =
        graph.nodes().map { it to -1 }.toMap(mutableMapOf())
    /**
     * `pre[v]` = Order in which [depthFirstSearch] examines `v`.
     */
    private val pre: MutableMap<T, Int> =
        graph.nodes().map { it to -1 }.toMap(mutableMapOf())

    private val foundBridges = mutableSetOf<Pair<T, T>>()

    init {
        graph.nodes().forEach { v ->
            // DO NOT PRE-FILTER!
            if (pre[v] == -1) {
                depthFirstSearch(v, v)
            }
        }
    }

    private fun depthFirstSearch(u: T, v: T) {
        pre[v] = count++
        low[v] = checkNotNull(pre[v]) { "pre[v]" }
        graph.adjacentNodes(v).forEach { w ->
            if (pre[w] == -1) {
                depthFirstSearch(v, w)
                low[v] =
                    Math.min(checkNotNull(low[v]) { "low[v]" }, checkNotNull(low[w]) { "low[w]" })
                if (low[w] == pre[w]) {
                    println("$v - $w is a bridge")
                    foundBridges += (v to w)
                }
            } else if (w != u) {
                low[v] =
                    Math.min(checkNotNull(low[v]) { "low[v]" }, checkNotNull(pre[w]) { "pre[w]" })
            }
        }
    }

    /**
     * Holds the computed bridges.
     */
    fun bridges() = ImmutableSet.copyOf(foundBridges)!!
} 
```

希望这能让某人的生活更轻松。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-10T12:07:37.490

假设你有一个优势（c，d），你必须找出它是否是一座桥
。有几种方法可以解决这个问题，但让我们专注于一个。

*   从 c 开始，你必须做一个[BFS](https://en.wikipedia.org/wiki/Breadth-first_search)。
*   如果有边缘 cd，则不要访问它。
*   通过访问布尔值来跟踪顶点。

最后，如果你发现 d 被访问了，这意味着通过删除 cd 我们仍然可以从源 c 访问 d，因此 cd 不是桥。这是上述的简短实现：

```
int isBridge(int V, ArrayList<ArrayList<Integer>> adj,int c,int d)
{
    Queue<Integer> q = new LinkedList<>();
    boolean visited[] = new boolean[V];
    ArrayList<Integer> ls = new ArrayList<>();

    q.add(c);

    while(!q.isEmpty()) {

        Integer v = q.remove();

        if(visited[v])
            continue;

        visited[v] = true;
        ls.add(v);

        for(Integer e: adj.get(v)) {

            if(visited[e] || (c == v && d == e))
                continue;
            q.add(e);
        }
    }

    if(visited[d] == true)
        return 0;
    return 1;

} 
```

# hibernate - 如何在 Hibernate 会话中管理未保存实体的映射？

> ID：11218747
> 
> 赞同：0
> 
> 时间：2012-06-27T02:50:26.360
> 
> 标签：hibernate, map, revert, hibernate-session

在我的实体 ( `myGroup : Group`) 上，我有一个集合属性 ( `members : HashMap<Long, GroupMember>`)，我希望允许用户向地图添加多个新的（未持久化`GroupMember`的） `myGroup.members`。

*   我为集合属性使用哈希图的原因是为了确保集合的使用是高性能的（即`GroupMember`在业务逻辑执行期间必须能够通过其 ID 快速多次获取 a）。

*   我不想立即保留它们的原因是支持添加的还原。用户必须能够操作`myGroup.members`映射，添加和删除成员直到满意，然后再持久化（在 Hibernate 会话中保存实体并刷新）。

**问题**是`GroupMember`必须为 new 分配一个 ID 为零，以便 Hibernate 检测到它们未保存。(*) 因为成员位于映射中，由 ID 键入，这意味着只能添加一个新成员保存或还原。添加第二个 ID 为 0 的新成员会简单地覆盖（引用）第一个成员。

**我的问题**是如何最好地调整我的代码解决方案以支持将多个未保存的实体添加到集合（`myGroup.members`）中，同时保持使用哈希映射或其他映射/字典的性能优势？

注意：我已经尝试过一种 hack，其中 ID 来自`GroupMember`实例中数据的唯一组合，然后，在保存之前，ID 设置为零，以便 Hibernate 检测到它需要被持久化，但它是不优雅，我还没有找到让它可靠工作的方法。

* 我不完全理解 Hibernate 在这方面的行为。

`Group`以下实体的缩写代码：

```
@Entity
@Table (name="GROUP")
public class Group
{
    private Map<Long,GroupMember> members = new HashMap<Long,GroupMember>();

    @OneToMany(fetch = FetchType.LAZY, mappedBy = "ownerGroup", cascade = { CascadeType.ALL })
    @MapKey(name="id")
    public Map<Long,GroupMember> getMembers() { return this.members; }

    public void setMembers(Map<Long,GroupMember> members) { this.members = members; }

    // ...other properties and methods...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:27:44.163

我对你要达到的目标有点困惑。未持久化的成员没有任何 ID。当您使用 ID 作为键时，您期望这些成员的“查找”行为是什么？对我来说，您可以通过 ID 查找新成员似乎不合理，因为他们还没有任何身份。

如果不需要查找新成员，我会建议你：

1.  存储“新成员”的单独属性
2.  在您的实体中有方法 commit() 和 revert()
3.  用户将在完成更新后调用 commit()，然后将新实体移动到实际的“映射”映射/列表以实现实际持久性

如果需要查找新成员，并且从您的段落来看，您似乎能够自己生成经过验证的唯一密钥，您是否会考虑不让休眠来为您生成 ID？您可以在 Hibernate 中选择该 ID 是由 Hibernate 生成（作为代理键）还是由您提供（一种自然键）。我相信自行提供的 ID 更适合您的情况，因为您似乎没有将 ID 视为代理键。

* * *

编辑：关于OP关于无法单独存储它的原因的评论，可以通过这种方法轻松解决（我认为它也更有意义）：

（普塞多代码）

```
class Group {
  private List<Member> members;  // mapped in hibernate
  private List<Member> unsavedMembers;  // unmapped

  public Map<Long, Member> getProposedMemberMap() {
    // returned the combined "view" members and unsavedMembers
  }

  @PreUpdate  // you may consider running it it pre-update too
  public void commit() {
    members.addAll(unsavedMembers);
    unsavedMembers.clear();
  }

  public void revert() {
    unsavedMembers.clear();
  }
} 
```

通过这样做，您可以查看“建议的成员”以进行迭代，同时分别存储实际和未保存的成员。

# javascript - 为什么这个 unicode 字符的警报不成功？

> ID：11218748
> 
> 赞同：2
> 
> 时间：2012-06-27T02:50:49.870
> 
> 标签：javascript

我尝试使用“A”弹出警报：

```
var a = \u0041;
alert(a);​ 
```

[jsfiddle](http://jsfiddle.net/Tht2X/)

但是，我在 Chrome 控制台中收到错误消息：`Uncaught ReferenceError: A is not defined.`

这意味着什么？我没有在`A`任何地方调用的变量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T02:52:00.883

\u0041 是大写字母 A 的 unicode。解释器按原样翻译它，而不是假设它是一个字符串。

要提醒该值而不是查找具有该名称的变量，请执行`alert("\u0041")`

按照您的代码样式，修改后的代码将如下所示：

```
var a = "\u0041";
alert(a); 
```

# objective-c - 找出添加到 NSMutableArray 的对象是 nil

> ID：11218749
> 
> 赞同：0
> 
> 时间：2012-06-27T02:50:51.463
> 
> 标签：objective-c, cocoa, nsmutablearray, runtime-error

我使用 ARC 开始了一个项目，并将一些对象插入到`NSMutableArray`. 这些对象都以`NSString`s 开始，当尝试将这些对象添加到数组中时，我收到以下错误：

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[__NSArrayM insertObject:atIndex:]: object cannot be nil

该数组包含多个对象。有没有一种快速的方法可以让我找到我试图放入数组中的对象是`nil`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T05:03:27.787

1.  对 Objective-C 异常启用中断
2.  在调试器中运行您的代码，然后它将停止并向您显示插入 nil 值的确切行

如何打破 Objective-C 异常？好吧，这取决于您的 Xcode 版本：

1.  Xcode 3：运行菜单 -> 在 Objective-C 异常时停止
2.  Xcode 4：在断点视图 (Cmd-6) 中，点击 + 按钮并添加异常断点...，然后将类型设置为 Objective-C 并点击完成

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:17:26.160

如果没有看到代码，我帮不了你太多，但你可以将`NSLog()`插入对象的语句放入 NSMutableArray，然后查看打印的最后一条消息。您将`NSLog()`最后一条消息放入的位置是错误所在的位置。

希望这可以帮助！

# node.js - 节点 + Coffeescript + Zappa

> ID：11218750
> 
> 赞同：1
> 
> 时间：2012-06-27T02:50:53.350
> 
> 标签：node.js, frameworks, coffeescript

我一直在寻找最好的 nodejs 框架。我开始倾向于二分法[扎帕](http://zappajs.org/)。我正在对其进行测试，一切正常，直到我开始一个新项目并使用 npm 重新安装它。

现在任何时候我用它做任何事情，它都会抛出这个错误。

这个

```
require('zappa') ->
    console.log "Hello World!" 
```

变成

```
TypeError: Cannot read property 'prototype' of undefined
at Object.<anonymous> (/home/giodamelio/Projects/node-boilerplate/node_modules/zappa/lib/zappa.js:65:15)
at Object.<anonymous> (/home/giodamelio/Projects/node-boilerplate/node_modules/zappa/lib/zappa.js:702:4)
at Module._compile (module.js:446:26)
at Object..js (module.js:464:10)
at Module.load (module.js:353:31)
at Function._load (module.js:311:12)
at Module.require (module.js:359:17)
at require (module.js:375:17)
at Object.<anonymous> (/home/giodamelio/Projects/node-boilerplate/src/app.coffee:3:3)
at Object.<anonymous> (/home/giodamelio/Projects/node-boilerplate/src/app.coffee:52:4) 
```

发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-29T19:01:04.860

Recently I just had a similar problem with **zappa 0.3.3**

Apparently the creator of **zappa** is on vacation and doesn't update to the current versions of **node.js**, but you may use **zappajs** instead. It's a fork that is a little more up-to-date.

```
npm install zappajs 
```

And use `require('zappajs')` instead of `require('zappa')`.

# ruby - 正则表达式 - 匹配前导和尾随空格、左括号和右括号和单词之间的空格，但不匹配单词之间的空格

> ID：11218755
> 
> 赞同：5
> 
> 时间：2012-06-27T02:51:20.123
> 
> 标签：ruby, regex

如果这个问题已经得到解答，我深表歉意，但我已经搜索并找不到答案。我正在尝试编写一个正则表达式，它将匹配所有前导和尾随空格、左括号和右括号与单词之间的空格，但不匹配单词之间的空格。以下是我正在解析的数据的字符串格式示例：

```
[Header]  
   [  SomeSpace]     
      [  Some1 More Space 15  ] 
```

*   没有前导和尾随空格，括号之间没有空格，只有一个单词。

*   一些前导和尾随空格，左括号和尾随空格之间的空格。

*   一些前导空格，单词和数字之间的空格，左括号和右括号之间的空格以及尾随空格。

我想出的最接近的单个正则表达式是：

```
/[^\[\]a-zA-Z\d]/ 
```

但我似乎不能只匹配单词和数字之间的空格......

我目前用作解决方法的 ruby​​ 代码是：

```
line.gsub!(/^\s*/, "")
line.gsub!(/\[/, "")
line.gsub!(/\]/, "")
s = line.gsub!(/^\s*|\s*$/, "")
s = "[" + s + "]\n" 
```

显然，不是很漂亮……

非常感谢任何有助于将其简化为优雅的 gsub 行的帮助。

谢谢！

李

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T03:17:32.540

如果我正确理解了您的问题，您正试图将这段文字

```
[Header]  
   [  SomeSpace]     
      [  Some1 More Space 15  ] 
```

进入这个：

```
[Header]
[SomeSpace]
[Some1 More Space 15] 
```

这个正则表达式将完成这项工作。`?`这里的关键添加是内部字符类上的非贪婪量词。这使得字符类匹配尽可能少，并将括号内的尾随空格（如果有的话）留给后面的 greedy `\s*`。

```
s/^\s*\[\s*([\w\s]*?)\s*\]\s*$/[$1]/g 
```

红宝石：

```
line.gsub! /^\s*\[\s*([\w\s]*?)\s*\]\s*$/, '[\\1]' 
```

`sed`（丑陋，很可能表现不佳..我不是`sed`大师！）

```
sed -Ee "s/^ *\[([a-zA-Z0-9 ]+)\] *$/\\1/g" -e "s/^ */[/g" -e "s/ *$/]/g" infile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:27:11.980

正则表达式匹配所有额外的空格进行替换：

```
/(?<=^|\[)\s+|\s+(?=$|\])|(?<=\s)\s+/ 
```

*   第一部分将匹配开头和括号内的所有前导空格。
*   第二部分将匹配末尾和括号内的所有尾随空格。
*   最后一部分将检测 2 个或更多空格的序列并删除多余的空格。

只需用空字符串替换匹配项。

**测试数据**

```
 [Header]  
   [  SomeSpace]     
      [  Some1 More Space 15  ]       
   [    Super    Space     ]     
  [    ]
  [ ]
   []
[a]
[a ]
[ a]
[   a   ]
[a a]
[a   a   a      a a  b]   [   dasdasd   dsd   ] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:50:48.050

我不知道优雅但最简单的可能是：

```
line.gsub /^\s*(\[)\s*|\s*(\])\s*$/, '\\1\\2' 
```

# c++ - “未在范围内声明”C++ 问题

> ID：11218761
> 
> 赞同：1
> 
> 时间：2012-06-27T02:52:09.467
> 
> 标签：c++, oop, scope

我正在用 C++ 为一个类（学校，而不是代码）编写一个简单的类。我有一点 C++ 经验，但是已经有一段时间了，所以我正在重新学习我忘记的东西并学习了很多新语法（我在 Java 方面有更多经验）。这是代码：

```
#include <iostream>
#include <string>

using namespace std;
class Project112
{
private:
    string romanNumeral;
    int decimalForm;
public:
    Project112()
    {
        romanNumeral = "";      
        decimalForm = 0;
    }
    int getDecimal()
    {
        return decimalForm;
    }
}; 
```

这是驱动程序：

```
include cstdlib
include <iostream>

using namespace std;
int main() 
{
    Project112 x;
    int value2 = x.getDecimal();
    return 0;
} 
```

这是一个更大程序的一部分，但我已将其简化为这一点，因为这就是问题所在。每次我尝试运行该程序时，都会出现以下错误：

```
main.cpp:10: error: 'Project112' was not declared in this scope
main.cpp:10: error: expected `;' before 'x'
main.cpp:14: error: 'x' was not declared in this scope 
```

有人可以解释这个问题吗？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T02:54:25.973

```
#include "Project112.h" 
```

添加上面的主要。您忘记包含头文件。和：

```
using namespace std; 
```

Don't do that in a header file. That imports the everything from the `std` namespace into the global namespace of any file which includes your header. Just fully qualify the type in a header, i.e., `std::string`, and I would avoid that in implementation files as well in a large project (though something like `using std::string` is ok IMO in an implementation file).

# c# - C# form X close 和 btnclose 功能相同

> ID：11218766
> 
> 赞同：0
> 
> 时间：2012-06-27T02:53:55.707
> 
> 标签：c#, winforms

如何为表单 X（在右上角）和关闭按钮提供相同的功能。这两个需要表现得相似这就是我在 btnClose_Click 中所拥有的

```
 private void btnClose_Click(object sender, EventArgs e)
            {
                DialogResult result;
                int fileId = StaticClass.FileGlobal;
                if (DataDirty)
                {
                    string messageBoxText = "You have unsaved data. Do you want to save the changes and exit the form?";
                    MessageBoxButtons button = MessageBoxButtons.YesNo;
                    string caption = "Data Changed";
                    MessageBoxIcon icon = MessageBoxIcon.Question;
                    result = MessageBox.Show(messageBoxText, caption, button, icon);
                    if (result == DialogResult.No)
                    {
                        Program.fInput = new frmInputFiles(gtId, gName);
                        Program.fInput.Show();
                        this.Close();
                    }
                    if (result == DialogResult.Yes)
                    {
                        return;

                    }
                }
                else
                {
                    Program.fInput = new frmInputFiles(gPlantId, gPlantName);
                    Program.fInput.Show();
                    this.Close();

                }

            }

    Even on clicking the X to close the form,it should behave the same way as btnClose_Click

      private void frmData_FormClosing(object sender, FormClosingEventArgs e)
            {

        btnClose_Click(sender,e);//this doesnt seem to be working.
} 
```

它正在无限循环中。我知道它正在这样做.. btnClose_Click() 有 this.Close() 调用 frmData_FormClosing.. 这反过来又调用 btnclose..

感谢你

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T02:59:25.470

只需将 this.Close() 放在 btnClose_Click() 事件中。然后将所有其余逻辑（您需要对其进行一些编辑）移动到 frmData_FormClosing() 事件中，`e.Cancel = true;`如果您想取消关闭表单（在您的情况下，如果有未保存的更改并且用户单击 Yes on提示。

这是一个例子（我只是在记事本中剪切并粘贴，所以公平警告）：

```
private void btnClose_Click(object sender, EventArgs e)
{
    this.Close();
}

private void frmData_FormClosing(object sender, FormClosingEventArgs e)
{
    if (DataDirty)
    {
        if (MessageBox.Show("You have unsaved data. Do you want to save the changes and exit the form?",
                            "Data Changed", MessageBoxButtons.YesNo, MessageBoxIcon.Question) == DialogResult.No)
        {
            Program.fInput = new frmInputFiles(gtId, gName);
            Program.fInput.Show();
        }
        else
            e.Cancel = true;
    }
    else
    {
        Program.fInput = new frmInputFiles(gPlantId, gPlantName);
        Program.fInput.Show();
    }
} 
```

# vb.net - 通过 Vb.net 访问 mysql 数据库

> ID：11218767
> 
> 赞同：0
> 
> 时间：2012-06-27T02:54:09.950
> 
> 标签：vb.net

我真的很困惑我试图实现的目标是否可行以及是否有更好的替代方案，所以这里是：

我为企业创建了 Web 应用程序，它允许客户查看详细信息等，最重要的是进行预订。

这些预订存储在一个 mysql 数据库中，该数据库全部由我的网络托管服务提供。

到目前为止一切都很好，没有问题

我试图实现的下一件事引入了复杂性：

所以我正在尝试制作一个只能在一台机器上运行的应用程序，它应该连接到该数据库并检索所有这些保留。这就是我尝试实现 Visual Basic 应用程序的地方。

最简单的方法是每次进行业务预订时都通过电子邮件发送，但这会使最终用户的事情变得复杂。拥有一个检索数据的应用程序会容易得多，只需在他们的桌面或本地驱动器上，而不是电子邮件。

我对 vb.net 和 Net Connectors 进行了研究，但后来遇到了我的主机不允许远程连接到数据库的问题。

这就是我现在停留的地方，我不知道如何完成任务

在此先感谢您的任何指导或帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T04:31:36.487

如果您的 Web 主机不允许远程连接到数据库，那么您将无法使 WinForms 应用程序坐在客户桌面上 - 正如您所制定的那样。

> 最简单的解决方案是在网站中有一个受限的 Admin.aspx 网页。该网页将显示所有预订，允许按开始和结束日期搜索，甚至可能允许批准或拒绝预订。这是一种非常常见的方法 - 我还建议您为手机网络浏览器使用特殊的 CSS，以便您的客户可以通过手机查看预订。

# programming-languages - 什么是咖喱编程语言列表？

> ID：11218772
> 
> 赞同：9
> 
> 时间：2012-06-27T02:54:28.000
> 
> 标签：programming-languages, functional-programming, currying, partial-application

我刚刚从另一个问题中了解到 Haskell 被称为柯里化编程语言，因为它默认应用函数柯里化。显示此行为的其他语言是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T07:22:15.670

在不太深奥的语言中，主要是 Haskell：

```
f x y z = x + y * z
g = f 4
r = g 7 8 
```

OCaml 和 F#：

```
let f x y z = x + y * z
let g = f 4
let r = g 7 8 
```

并且在较小程度上 SML（图书馆使用较少的柯里化）：

```
fun f x y z = x + y * z
val g = f 4
val r = g 7 8 
```

# java - 简单的 Swing 程序即使在空闲时也使用 ~200MB？

> ID：11218774
> 
> 赞同：0
> 
> 时间：2012-06-27T02:54:47.780
> 
> 标签：java, swing, memory-management, jvm, jconsole

我知道 JVM 是一个囤积者，但这让我感到震惊：使用 netbean 的非常基本的“联系人编辑器”GUI 启动时使用了 180MB，并添加了一些基本的通用实例？

我没有制作 1998 年的第一人称射击游戏。我请求 SO 社区在这方面给我启发。这是一个 JConsole 打印屏幕：

![在此处输入图像描述](../Images/e0d83e1973cc2f793be7e0af2c6bbd34.png)

另外：我在启动时有 18 个线程永远不会死。除了初始线程和 Swing 的调度线程之外，是否还有其他线程始终存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:46:27.020

我不熟悉`Contact Editor`，但嵌入式数据库或模拟器可能负责。我最喜欢的 JVM 为典型的 Swing GUI 运行 10 个线程，但只有 3 个线程处于活动状态，没有一个能真正发挥作用。这个[例子](https://stackoverflow.com/a/5918785/230513)描述了一个视觉上“忙碌”的[程序](https://sites.google.com/site/drjohnbmatthews/buttons)，这个[例子](https://stackoverflow.com/a/6310284/230513)使用了一个人为的*小*堆来突出显示范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T10:54:57.850

线程并不是真正的内存问题（这 18 个线程中约有一半只是因为您处于调试模式 IIRC）。其他的有很明显的名字（我的猜测）：AWT-Shutdown（检查是否所有窗口都被处理，然后退出 JVM）、AWT-Windows（从操作系统获取事件）、Java2D 处理程序（图像数据清理）。

我不知道您正在运行的程序，但如果它基于 Netbeans*平台*，可能会增加一些额外的内存需求，但不是 180MB。我猜大部分内存要么未使用（只是保留），要么是实际数据占用内存。

为了比较：

*   一个带有标签和按钮的简单 JFrame 只需要 ~2MB（使用 -Xmx2MB 运行，尽管 visualvm 显示它保留了 8MB（在 64 位 Windows 上最少？），使用 <2MB）。
*   我用 70MB 的库（jar）开发的一个复杂的 GUI 程序是在启动 ~35MB（我的猜测是 ~5-10MB 只是图标/图像）和使用所有功能之后（所以几乎所有的库代码都加载了，包括非 GUI 的） ~100MB，但其中包括一些数据。

分解：

1.  java.awt.image.BufferedImage#156 7.056.378
2.  java.awt.image.BufferedImage#415 6.639.738
3.  sun.misc.Launcher$AppClassLoader#1 3.386.545
4.  class com.ces.core.gui.help.WelcomeTab 627.256（此处为静态图片数据）
5.  class com.ces.util.resources.Translator 408.146（基本上所有的文本都显示在 UI 中）
6.  sun.awt.AppContext#1 389.760
7.  java.awt.image.BufferedImage#161 326.120

大约一半看起来像缓存图像（大背景图像:)）我省略了 int[]/Object[]/HashMap.Entry[] ，它指的是相同的数据）

如果您想查看示例应用程序的细分 -> VisualVM -> 监视器 -> 堆转储 -> 按保留大小查找 x 个最大对象。

# c# - 如何使用 C# 获取当前项目目录路径

> ID：11218776
> 
> 赞同：14
> 
> 时间：2012-06-27T02:54:49.327
> 
> 标签：c#, .net

好的，这是问题。我有两个项目，一个是 C# 控制台，另一个是类库。我正在从控制台应用程序访问/调用类库方法。类库项目中有一个名为 Files 的文件夹。

我需要获取类库文件夹的路径，但每当我使用

```
System.IO.Directory.GetCurrentDirectory(); 
```

和

```
Environment.CurrentDirectory; 
```

它给了我用来调用该方法的控制台项目的路径。

以上方法给了我这样的路径

```
C:\\ConsolePro\\bin\\Debug 
```

但我需要类库项目的路径

```
C:\\ClassLibPro\\bin\\Debug 
```

请指教

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-27T03:04:58.657

一旦代码编译并运行，“项目路径”就没有意义了。您只能确定已编译程序集的文件位置。如果您的控制台项目直接引用构建的“类库”DLL，而不是通过项目引用，您只能按照您的要求进行操作。

然后，您可以利用反射来获得装配路径，例如；

```
string path = Assembly.GetAssembly(typeof (SomeClassInOtherProject)).Location; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T03:33:30.883

我相信问题是：

由于控制台项目具有 DLL 文件引用，因此它使用 DLL 来调用任何方法。此时它返回的是类库项目的DLL位置，它位于控制台项目的bin目录中，它不知道类库项目的物理位置。

所以本质上它是返回相同的项目路径。为了解决这个问题，我必须将两个项目移动到同一个目录中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-27T02:59:03.347

您应该能够使用`Directory.GetParent(Directory.GetCurrentDirectory())`几次来获取更高级别的目录，然后将 lib 目录的路径添加到该目录的末尾。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-27T08:40:19.183

我希望我能正确理解你：

```
Path.GetDirectoryName(typeof(Foo.MyFooClass).Assembly.Location); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-06-27T03:01:27.763

如果您从另一个程序集中加载类库。

```
string Path = System.Reflection.Assembly.GetAssembly(typeof({LibraryClassName})).Location;

string PathToClassLibPro = Path.GetDirectoryName( Path); 
```

替换`{LibraryClassName}`为您的库的类名。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-27T04:50:52.470

我会推荐两个选项之一。

1.  如果文件很小，请将它们包含在类库中，并在需要时将它们流式传输到临时位置

2.  其他选项是在构建期间将文件复制到输出目录并以这种方式使用它们。在多个共享项目的情况下，最好有一个公共 bin 文件夹，您可以将程序集复制到该位置并从该位置运行。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-09-27T18:24:22.423

我也遇到了这个确切的问题，我无法访问命名空间的 bin/debug 文件夹中的文件。我的解决方案是使用`Split()`然后构造一个新字符串来操作字符串，该字符串是我在命名空间中拥有的 json 文件的绝对路径。

```
private static string GetFilePath()
        {            
            const char Escape = '\\'; //can't have '\' by itself, it'll throw the "Newline in constant" error
            string directory = Environment.CurrentDirectory;
            string[] pathOccurences = directory.Split(Escape);            
            string pathToReturn = pathOccurences[0] + Escape; //prevents index out of bounds in upcoming loop
            for(int i = 1; i < pathOccurences.Length; i++)
            {
                if (pathOccurences[i] != pathOccurences[i - 1]) //the project file name and the namespace file name are the same
                    pathToReturn += pathOccurences[i] + Escape;
                else
                    pathToReturn += typeof(thisClass).Namespace + Escape; //In the one occurrence of the duplicate substring, I replace it with my class Namespace name
            }
            return pathToReturn + "yourFile.json";
        } 
```

我个人不喜欢这个解决方案，但这是我能想到的唯一答案。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-28T09:14:19.453

尽管我找不到一个好的解决方案，但我使用了这个技巧：只要你想回到你的理想路径，你应该添加**Directory.GetParent()**而不是**...**

```
 Directory.GetParent(...(Directory.GetParent(Directory.GetCurrentDirectory()).ToString()...).ToString() 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-12-23T11:48:58.130

我使用以下方法在运行时获取当前项目路径：

```
public static class ProjectInfo {
   public static string appDirectory = AppDomain.CurrentDomain.BaseDirectory;
   public static string projectPath = appDirectory.Substring(0, appDirectory.IndexOf("\\bin"));
} 
```

# java - 程序如何定位数组的索引？

> ID：11218777
> 
> 赞同：6
> 
> 时间：2012-06-27T02:55:13.673
> 
> 标签：java, arrays

我知道数组查找有 O(1) 时间，所以它不能循环。程序是否存储数组索引的内存位置，或者它如何立即查看索引？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T02:57:28.730

数组元素在内存中的间距总是相等的，因此在给定索引的情况下查找元素需要乘以元素的大小并加上数组在内存中的基数。通过采用适当的寻址模式，这两种操作通常在硬件中的单个指令空间内完成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T02:57:20.603

下面......它是一个内存地址+（索引位置*数组中事物的大小）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:24:40.240

数组元素存储在连续的块中，如果它们增长，则需要将它们移动到新位置。然后使用数组开始处的偏移量访问元素。

在 C 中，您可以使用两种不同的方法访问名为*a*的数组中索引*i的元素：*

 **   `int arrayElement = a[i];`
*   `int arrayElement = (int)(a + i * sizeof(int));`

这或多或少是如何在 Java 中完成的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T03:11:13.290

尝试这个，

`1\. Arrays are consecutive memory locations which are stored in Heap, as Arrays are` `objects in java.`

`2\. Assume i have an Array of String as an instance variable`

字符串[] arr = {1,2,3,4,5};

现在是这样的

arr[0] = 1

arr[1] = 2

arr[2] = 3

arr[3] = 4

arr[4] = 5

`{1,2,3,4,5} are stored over the heap, and Considering array "arr" as instance` `variable, will lives within the object on the heap.`

`Now` **arr 将保存 Array 的第一个元素的地址 1**。**“arr”是一个对象引用数组变量，将在对象内部，而 {1,2,3,4,5} 在堆的某个位置之外。***

# php - 卷曲没有反应

> ID：11218783
> 
> 赞同：1
> 
> 时间：2012-06-27T02:55:57.057
> 
> 标签：php, curl

我正在尝试使用 curl 将我的用户名和密码传递给网站 www.licindia.in，但我可能遇到了 cookie 问题，我无法继续我的会话并且网站响应 302 错误，文档已被暂时移动，现在我没有得到这个代码的回应： -

```
<?php
    $username="myusername";
    $password="password";
    $url="http://onlinelic.in/LICEPS/Login/webLogin.do";
    //echo "praveenpuglai";
    $postdata = "portlet_5_6{actionForm.userName}=".$username."&portlet_5_6{actionForm.password}=".$password;
    $cookie = "JSESSIONID";
    ch = curl_init();
    curl_setopt ($ch, CURLOPT_URL, $url);
    curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, true);
    curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0");
    curl_setopt($ch,CURLOPT_COOKIESESSION,true);
    curl_setopt ($ch, CURLOPT_TIMEOUT, 60);
    curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 0);
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt ($ch, CURLOPT_REFERER, $url);
    //var_dump($ch);
    curl_setopt ($ch, CURLOPT_COOKIEJAR, $cookie);
    curl_setopt ($ch, CURLOPT_POSTFIELDS, $postdata);
    curl_setopt ($ch, CURLOPT_POST, 1);
  //  $result = curl_exec ($ch);
    //echo $result;
    /*if($result != null)
    {
    header('Location: http://onlinelic.in/LICEPS/appmanager/Customer/CustomerHome');
    } */
//    curl_close($ch);
    $response = curl_exec($ch);
    $info = curl_getinfo($ch);
    curl_close($ch);
    if($info['http_code'] == 301 || $info['http_code'] == 302) {
        preg_match_all('|Location: (.*)\n|U', $response, $results);
        $location = implode(';', $results[1]);
        header("Location: $location");
        exit;
    } else {
        $response = substr_replace($response, '', 0, strpos($response, '<', 0));
        echo $response;
    }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:00:10.620

您已指定您不愿意使用此声明遵循任何重定向：

```
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 0); 
```

将值设置得更高或不指定它将使 cURL 跟随重定向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-04T11:36:11.043

```
<?php
    $username="XXXXXX";
    $password="YYYYYY";
    $url="url"; 
    $capt="ZZZZZ"; 

    $postdata = "?{actionForm_userName}=".$username."&{actionForm_password}=".$password."&{actionForm_qreply}=".$capt;
    $cookie = "JSESSIONID";

    $ch = curl_init();
    curl_setopt ($ch, CURLOPT_URL, $url);

    curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, true);
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0");
    curl_setopt($ch,CURLOPT_COOKIESESSION,true);
    curl_setopt ($ch, CURLOPT_TIMEOUT, 60);
    curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 0);

    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt ($ch, CURLOPT_HEADER, 0);   
    curl_setopt ($ch, CURLOPT_REFERER, $url);
    curl_setopt ($ch, CURLOPT_COOKIEJAR, $cookie);
    curl_setopt ($ch, CURLOPT_POSTFIELDS, $postdata);
    curl_setopt ($ch, CURLOPT_POST, 1); 

      //echo $cookie;
      //echo $postdata;
echo curl_error($ch);
    $result = curl_exec ($ch);
    print($result);

curl_close($ch);

    $response = curl_exec($ch);
    $info = curl_getinfo($ch);
    curl_close($ch);
    if($info['http_code'] == 301 || $info['http_code'] == 302) {
        preg_match_all('|Location: (.*)\n|U', $response, $results);
        $location = implode(';', $results[1]);
        header("Location: $location");
        exit;
    } else {
        $response = substr_replace($response, '', 0, strpos($response, '<', 0));
        echo $response;
    }  

?> 
```

# javascript - 如何覆盖 ajax=false 以便它切换到加载的 dom 页面（如果存在）

> ID：11218787
> 
> 赞同：6
> 
> 时间：2012-06-27T02:56:42.060
> 
> 标签：javascript, jquery, jquery-mobile

我有几个项目 html，每个项目都包含一个 JQM 页面。我也有一个索引页。它是一个多 JQM 页面的 html，每个 JQM 页面作为一个类别列出项目。

```
 index.html                  item1.html           item2.html
  +------------------+        +--------+--------+  +--------
  |+-------+         |     +--|Cat.    |    Next|->|Cat.
  ||.cont- |         |     |  +--------+--------+  |--------
  ||ent    |+-------+|<----+  |                 |  |
  |+-------+|#cat1  ||        |                 |  |
  |         |       ||        |bla bla bla      |  |bla bla
  |         |link1+---------->|                 |  |
  |         |link2  ||        |                 |  |
  |         +-------+|        +-----------------+  +--------
  |+-------++-------+|
  ||#cat2  ||#cat3  ||
  ||       ||       ||
  ||link4  ||link3  ||
  ||       ||       ||
  |+-------++-------+|
  +------------------+ 
```

目前，我可以通过平滑的 ajax 加载从索引链接到项目。但是我意识到，如果我想从 item 链接回 index#cat1，我需要使用`data-ajax='false'`index 是一个多页 html。（我不能使用`data-rel='back'`，因为上一页并不总是 index.html）。

如果我使用`ajax='false'`，如果我经常在列表和项目之间切换（每次切换回列表都是完全重新加载），我将失去平滑过渡。例如：

*-full-load->* index#cat1 *-ajax-load->* item2 *-full-load(再次)->* index#cat1

**问题**

我想：

*-full-load->* index#cat1 *-ajax-load->* item2 *-ajax-switch-to-already-loaded->* index#cat1

如何覆盖 jquery 移动逻辑，以便在`data-ajax='false'`单击链接时首先搜索该 index#cat1 页面是否已经在 dom 中？如果是，那么只需切换到该 JQM 页面。如果它不存在，请在没有 ajax 的情况下完全加载 index#cat1（如默认行为）。

**请记住，用户可以从 item1.html 开始并导航到 index.html#cat1。**

我知道我需要用一些自定义属性来标记每个 JQM 页面，比如`data-full-url="index.html#cat1"`让搜索现有页面变得更容易。但是我的主要弱点是如何更改现有的 Jquery Mobile 链接逻辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-29T11:16:27.637

jsfiddle似乎失败了，这接近你的例子吗？

我把它放在本地服务器

对于 item1 的后退按钮，您可以输入完整的 url: `http://localhost/home.html#cat1`，它也可以使用

主页.html：

```
<!doctype html>
<html manifest="">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<link type="text/css">

</link>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
</head>

<body>

<div data-role="page" id="home">
    <div data-theme="b" data-role="header" data-position="fixed">
        <h3>home</h3>
    </div>
    <div data-role="content">
        hello home
        <a href="home.html#cat1" type="button">cat1</a>
        <a href="home.html#cat2" type="button">cat2</a>
    </div>
</div>

<div data-role="page" id="cat1">
    <div data-theme="b" data-role="header" data-position="fixed">
        <h3>cat1</h3>
    </div>
    <div data-role="content">
        hello cat1
        <a href="#home" type="button">home</a>
        <a href="item1.html" type="button">see item1</a>
    </div>
</div>

<div data-role="page" id="cat2">
    <div data-theme="b" data-role="header" data-position="fixed">
        <h3>"cat2</h3>
    </div>
    <div data-role="content">
        hello cat2
        <a href="#home" type="button">home</a>
    </div>
</div>

    </body>
</html>​​​​​​​​​​​​ 
```

item1.html

```
 <!doctype html>
<html manifest="">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" />
<link type="text/css">

</link>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
</head>

<body>

<div data-role="page" id="item1Home">
    <div data-theme="b" data-role="header" data-position="fixed">
        <h3>item1's home</h3>
    </div>
    <div data-role="content">
        hello item1
        <a href="home.html#cat1" type="button" rel="external">back?</a>
    </div>
</div>

    </body>
</html>​​​​​​​​​​​​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T05:40:05.957

我在以下小提琴中创造了你的情况。

1）索引页面： http: [//jsfiddle.net/nachiket/RpZW7/](http://jsfiddle.net/nachiket/RpZW7/)
2）详细项目页面：http: [//jsfiddle.net/nachiket/cHmhW/](http://jsfiddle.net/nachiket/cHmhW/) （这个已经链接在索引页面小提琴中）

我没用过data-ajax='false'，能解决你的问题吗？如果没有，请根据您的具体情况更新此小提琴，以便更好地提供帮助。

# c++ - C++ 中的运算符重载 <<

> ID：11218790
> 
> 赞同：0
> 
> 时间：2012-06-27T02:56:54.013
> 
> 标签：c++, io, operator-overloading

我写了这个简单的程序来练习重载。

这是我的代码：

```
#include <iostream>
#include <string>
using namespace std;

class sex_t
{
    private:
        char __sex__;

    public:
        sex_t(char sex_v = 'M'):__sex__(sex_v)
        {
            if (sex_v != 'M' && sex_v != 'F')
            {
                cerr << "Sex type error!" << sex_v << endl;
                __sex__ = 'M';
            }
        }

        const ostream& operator << (const ostream& stream)
        {
            if (__sex__ == 'M')
                cout << "Male";
            else
                cout << "Female";
            return stream;
        }
};

int main(int argc, char *argv[])
{
    sex_t me('M');
    cout << me << endl;
    return 0;
} 
```

当我编译它时，它会打印很多错误消息：

错误消息一团糟。

我很难找到有用的信息。

```
sex.cpp: 在函数‘int main(int, char**)’中:
sex.cpp:32:10: 错误： ‘operator<<’在‘std::cout << me’中没有匹配
sex.cpp:32:10: 附注： 备选是：
/usr/include/c++/4.6/ostream:110:7: 附注： std::basic_ostream<_CharT, _Traits>::__ostream_type& std::basic_ostream<_CharT, _Traits>::operator<<(std::basic_ostre 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T03:02:55.427

参数和返回`operator<<`是非常量的。此外，它必须是非成员 - 您已经为`me << cout`，而不是编写了重载`cout << me`。此外，以两个下划线开头的标识符是为实现保留的，使用它们是未定义的行为。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T03:11:48.267

《C++ Primer 4th Edition》第14章第14.2节输入输出运算符：

IO 操作符必须是非成员函数，我们不能让操作符成为我们自己类的成员。如果我们这样做了，那么左边的操作数必须是我们类类型的对象：

```
// if operator<< is a member of Sales_item
     Sales_item item;
     item << cout; 
```

重载输出运算符的一般框架是

```
 // general skeleton of the overloaded output operator
     ostream&
     operator <<(ostream& os, const ClassType &object)
     {
         // any special logic to prepare object

         // actual output of members
         os << // ...

         // return ostream object
         return os;
     } 
```

第一个参数是对将在其上生成输出的 ostream 对象的引用。ostream 是非常量的，因为写入流会更改其状态。该参数是一个引用，因为我们无法复制 ostream 对象。

第二个参数通常应该是对我们要打印的类类型的 const 引用。参数是避免复制参数的引用。它可以是 const 因为（通常）打印一个对象不应该改变它。通过使参数成为 const 引用，我们可以使用单个定义来打印 const 和 nonconst 对象。

返回类型是 ostream 引用。它的值通常是应用输出运算符的 ostream 对象。

**编辑**：

我试图修改你的代码，如果你使用`__sex__`as`sex_t`的私有成员，你应该写另一个`get function`来获取'M'或'F'，如果你在你的`operator<<`函数中调用它，你可能会得到一个错误，因为const 引用只能调用一个 const 函数，所以你应该让你`get function`的一个 const 函数，只是为了提醒:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T03:17:08.443

为流重载时，您可以全局声明一个 << 运算符和/或作为`friend`（有好处）您的类，以便它可以访问其“私有成员”（哦...）。您可以`friend`在类中声明 a 以全局声明它。不要`const`在溪流上使用。

接下来，在重载中使用传递的流。在您的方法中，您可以`cout`通过仅使用`stream`参数来使用它。

我没有测试过这个，但看看它是否适合你。

```
class sex_t
{
private:
    char __sex__;
public:
    sex_t(char sex_v = 'M'):__sex__(sex_v)
    {
        if (sex_v != 'M' && sex_v != 'F')
        {
            cerr << "Sex type error!" << sex_v << endl;
            __sex__ = 'M';
        }
    }

    friend ostream& operator << (ostream& stream, sex_t& sex);
};

ostream& operator << (ostream& stream, sex_t& sex)
{
    if (__sex__ == 'M')
        stream << "Male";
    else
        stream << "Female";
    return stream;
} 
```

# ios - Monotouch AMDeviceInstallApplication 返回：0xe8008018

> ID：11218791
> 
> 赞同：2
> 
> 时间：2012-06-27T02:56:55.023
> 
> 标签：ios, xamarin.ios, monodevelop

我最近在我的设备上安装了 iOS 6 测试版并更新到最新的单声道开发版本。因此，我现在在尝试部署到我的设备时收到以下错误，“安装失败：AMDeviceInstallApplication 返回：0xe8008018” - 无法上传到设备。

我尝试过其他项目并得到同样的错误。据我所知，没有代码签名问题 - 日志中一切正常。在我安装 IOS6 之前它运行良好。我没有另一台装有 iOS 5 的设备来测试。

关于我为什么会收到此错误的任何想法？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T14:33:01.537

如果您对 Xcode 可执行文件使用任何非标准名称，请查看 Xamarin 的博客文章以了解如何修复它：

[http://blog.xamarin.com/2012/06/15/xcode-4-5-ios-6-and-mountain-lion/](http://blog.xamarin.com/2012/06/15/xcode-4-5-ios-6-and-mountain-lion/)

或者更好的是，联系 support@xamarin.com

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:22:29.667

当我的开发人员证书在我的构建机器上到期时，我每年都会收到一次此消息。是的，我的 Macbook Pro 是 2010 年的。所以只需在 iOS 开发者控制台中的证书下查看。如果它说您没有，那么您需要完成创建一个新的过程。我还在 KeyChain 中查看是否有一个红色 X 表示它已过期。我希望这有帮助。

# eclipse - 无法访问 JD-Eclipse 站点：http://java.decompiler.free.fr/?q=jdeclipse

> ID：11218792
> 
> 赞同：5
> 
> 时间：2012-06-27T02:57:07.200
> 
> 标签：eclipse, decompiler

我无法访问 java 反编译器站点： http://java.decompiler.free.fr/?q= [jdeclipse](http://java.decompiler.free.fr/?q=jdeclipse)。

它显示 403 错误：

> Erreur 403 - Refus de traitement de la requête (Interdit - Forbidden)**。

我正在从中国访问它。中国以外的人可以正常访问吗？还是服务器问题？

**编辑：**
Eclipse 更新站点托管在[jd.benow.ca](http://jd.benow.ca)上。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T20:14:04.070

很抱歉给您带来不便：我的 Webhost 在 JD-Eclipse 中检测到病毒！

* * *

Votre page personsle a été suspendue pour la/les raisons suvantes:

==> 您的个人页面已被暂停/因为：

病毒：http: [//java.decompiler.free.fr/jd-eclipse/update/plugins/jd.ide.eclipse.win32.x86_0.1.3.jar](http://java.decompiler.free.fr/jd-eclipse/update/plugins/jd.ide.eclipse.win32.x86_0.1.3.jar)

* * *

这个文件两年没有变过！它包含一个用 UPX 压缩和修改的 DLL 库。黑客和杀毒软件有一些解压的方法。

嗯，这种情况真的很不舒服。我会尝试恢复我的网站。

Emmanuel Dupuy，JD Projects。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T17:55:49.290

我得到了同样的 403 错误。

您可以从archive.org 查看该站点的[早期版本](http://web.archive.org/web/20110720221237/http://java.decompiler.free.fr/?q=jdeclipse)。

如果您想安装 Eclipse 插件，您也可以从 archive.org下载并解压缩[更新站点。](http://web.archive.org/web/20110720221237/http://java.decompiler.free.fr/jd-eclipse/update/jdeclipse_update_site.zip)

eclipse 更新站点也托管在[jd.benow.ca](http://jd.benow.ca/)上。

# iphone - 我希望我的故事板的初始视图控制器是当前控制器

> ID：11218793
> 
> 赞同：1
> 
> 时间：2012-06-27T02:57:11.193
> 
> 标签：iphone, ios, storyboard

如果应用程序以前在后台，当`applicationDidBecomeActive`被调用时，我希望我的故事板的初始视图控制器是当前控制器。

我用了：

```
- (void)applicationDidBecomeActive:(UIApplication *)application
{
    [self.window makeKeyAndVisible];
} 
```

当我重新启动应用程序时，`loginAciton`内部`rootViewController`仍然被调用，但无法呈现下一个控制器。没有错误，就像什么都没发生一样。

```
- (IBAction)loginAciton:(id)sender
{
    id controller = [self.storyboard instantiateViewControllerWithIdentifier:@"Navigation"];
    [self presentModalViewController:controller animated:YES];   
} 
```

为什么？

PS。我的 rootViewController 不是 UINavigationController。

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-29T06:53:00.973

更好的方法是添加`UIApplicationExitsOnSuspend`到您的`Info.plist`并将其设置为`YES`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T04:37:23.023

我得到了它 ！

如果您希望故事板的初始视图控制器每次都成为当前控制器，您可以尝试一下：

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{
   exit(EXIT_SUCCESS);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-29T13:34:41.283

您也可以使用通知，将此代码放入 *applicationDidBecomeActive：*

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"appActivated" object:nil]; 
```

并在当前视图中添加观察者......

```
[[NSNotificationCenter defaultCenter] addObserver:self 
                                     selector:@selector(updateView:)        
                                         name:@"appActivated" 
                                       object:nil]; 
```

并且不要忘记删除您当前视图的*dealloc:中的观察者...*

```
[[NSNotificationCenter defaultCenter] removeObserver:self]; 
```

这可能会帮助你..

# php - 我需要从一些文本文件中获取带有一些规范的句子，然后将它们存储到数据库中

> ID：11218796
> 
> 赞同：0
> 
> 时间：2012-06-27T02:57:17.047
> 
> 标签：php, text

我有由一些句子组成的文本。我必须解析用点分隔的句子并计算每个句子中的单词。超过 5 个单词的句子将被插入数据库。这是我的代码：

```
<?php

require_once 'conf/conf.php';// connect to database

function saveContent ($text) {
  //I have to get every sentence without lose the dot
  $text1 = str_replace('.', ".dot", $text);
  $text2 = explode ('dot',$text1); 

  //Text that contain ' cannot be inserted to database, so i need to remove it 
  $text3 = str_replace("'", "", $text2); 

  //Selecting the sentence that only consist of more than words
  for ($i=0;$i<count($text3);$i++){
    if(count(explode(" ", $text3[$i]))>5){
      $save = $text3[$i];

      $q0 = mysql_query("INSERT INTO tbdocument VALUES('','$files','".$save."','','','') ");
    }
  }
}

$text= "I have some text files in my folder. I get them from extraction process of pdf journals files into txt files. here's my code";
$a = saveContent($text);

?> 
```

结果只有1句（第一句）可以插入数据库。我需要你的帮助，非常感谢：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:05:10.887

有很多方法可以改善这一点（并使其正常工作）。

而不是替换`.`为`.dot`，您可以简单地爆炸`.`并记住稍后替换它。但是，如果您的判决类似于*史密斯先生去了华盛顿怎么办。*? 您无法以非常可靠的方式区分这些时期。

`$files`您的变量`INSERT`未在此函数的范围内定义。我们不知道它来自哪里或您期望它包含什么，但在这里，它将为 NULL。

```
function saveContent ($text) {
  // Just explode on the . and replace it later...
  $sentences = explode(".", $text);

  // Don't remove single quotes. They'll be properly escaped later...

  // Rather than an incremental loop, use a proper foreach loop:
  foreach ($sentences as $sentence) {
    // Using preg_split() instead of explode() in case there are multiple spaces in sequence
    if (count(preg_split('/\s+/', $sentence)) > 5) {
      // Escape and insert
      // And add the . back onto it
      $save = mysql_real_escape_string($sentence) . ".";

      // $files is not defined in scope of this function!
      $q = mysql_query("INSERT INTO tbdocument VALUES('', '$files', '$sentence', '', '', '')");
      // Don't forget to check for errors.
      if (!$q) {
        echo mysql_error();
      }
    }
  }
} 
```

从长远来看，考虑远离`mysql_*()`函数并开始学习支持预准备语句的 API，例如 PDO 或 MySQLi。旧`mysql_*()`功能很快就会被弃用，并且缺乏准备好的语句提供的安全性。

# c++ - 将日期和时间数字转换为 time_t 并指定时区

> ID：11218797
> 
> 赞同：10
> 
> 时间：2012-06-27T02:57:18.277
> 
> 标签：c++, datetime, timezone, time-t

我有以下整数：

```
int y, mon, d, h, min, s; 
```

它们的值分别是：`2012`、`06`、`27`、`12`、。如果我在我的应用程序的其他地方选择了“UTC”，我想表示“2012/06/27 12:47:53 UTC”的日期时间，或者如果我选择了“2012/06/27 12:47:53 AEST”的日期时间在我的应用程序的其他地方选择了“AEST”。`47``53`

我想将其转换为`time_t`，这是我目前用来执行此操作的代码：

```
struct tm timeinfo;
timeinfo.tm_year = year - 1900;
timeinfo.tm_mon = mon - 1;
timeinfo.tm_mday = day;
timeinfo.tm_hour = hour;
timeinfo.tm_min = min;
timeinfo.tm_sec = sec;
//timeinfo.tm_isdst = 0; //TODO should this be set?

//TODO find POSIX or C standard way to do covert tm to time_t without in UTC instead of local time
#ifdef UNIX
return timegm(&timeinfo);
#else
return mktime(&timeinfo); //FIXME Still incorrect
#endif 
```

所以我正在使用`tm struct`and `mktime`，但是这不能很好地工作，因为它总是假设我的本地时区。

这样做的正确方法是什么？

所以下面是我到目前为止提出的解决方案。它基本上做三件事之一：

1.  如果是 UNIX，只需使用`timegm`
2.  如果不是 UNIX
    1.  或者，使用 UTC 纪元和本地纪元之间的差异作为偏移量进行数学运算
        *   保留：数学可能不正确
    2.  或者，将“TZ”环境变量临时设置为 UTC
        *   保留：如果/当此代码需要多线程时会出错

```
namespace tmUtil
{
    int const tm_yearCorrection = -1900;
    int const tm_monthCorrection = -1;
    int const tm_isdst_dontKnow = -1;

#if !defined(DEBUG_DATETIME_TIMEGM_ENVVARTZ) && !(defined(UNIX) && !defined(DEBUG_DATETIME_TIMEGM))
    static bool isLeap(int year)
    {
        return
            (year % 4) ? false
            : (year % 100) ? true
            : (year % 400) ? false
            : true;
    }

    static int daysIn(int year)
    {
        return isLeap(year) ? 366 : 365;
    }
#endif
}

time_t utc(int year, int mon, int day, int hour, int min, int sec)
{
    struct tm time = {0};
    time.tm_year = year + tmUtil::tm_yearCorrection;
    time.tm_mon = mon + tmUtil::tm_monthCorrection;
    time.tm_mday = day;
    time.tm_hour = hour;
    time.tm_min = min;
    time.tm_sec = sec;
    time.tm_isdst = tmUtil::tm_isdst_dontKnow;

    #if defined(UNIX) && !defined(DEBUG_DATETIME_TIMEGM) //TODO remove && 00
        time_t result;
        result = timegm(&time);
        return result;
    #else
        #if !defined(DEBUG_DATETIME_TIMEGM_ENVVARTZ)
            //TODO check that math is correct
            time_t fromEpochUtc = mktime(&time);

            struct tm localData;
            struct tm utcData;
            struct tm* loc = localtime_r (&fromEpochUtc, &localData);
            struct tm* utc = gmtime_r (&fromEpochUtc, &utcData);
            int utcYear = utc->tm_year - tmUtil::tm_yearCorrection;
            int gmtOff =
                (loc-> tm_sec - utc-> tm_sec)
                + (loc-> tm_min - utc-> tm_min) * 60
                + (loc->tm_hour - utc->tm_hour) * 60 * 60
                + (loc->tm_yday - utc->tm_yday) * 60 * 60 * 24
                + (loc->tm_year - utc->tm_year) * 60 * 60 * 24 * tmUtil::daysIn(utcYear);

            #ifdef UNIX
                if (loc->tm_gmtoff != gmtOff)
                {
                    StringBuilder err("loc->tm_gmtoff=", StringBuilder((int)(loc->tm_gmtoff)), " but gmtOff=", StringBuilder(gmtOff));
                    THROWEXCEPTION(err);
                }
            #endif

            int resultInt = fromEpochUtc + gmtOff;
            time_t result;
            result = (time_t)resultInt;
            return result;
        #else
            //TODO Find a way to do this without manipulating environment variables
            time_t result;
            char *tz;
            tz = getenv("TZ");
            setenv("TZ", "", 1);
            tzset();
            result = mktime(&time);
            if (tz)
                setenv("TZ", tz, 1);
            else
                unsetenv("TZ");
            tzset();
            return result;
        #endif
    #endif
} 
```

NB`StringBuilder`是一个内部类，对于这个问题来说并不重要。

更多信息：

我知道这可以使用 boost 等轻松完成。但这不是选项。我需要它以数学方式完成，或者使用 ac 或 c++ 标准函数，或它们的组合。

`timegm`似乎解决了这个问题，但是，它似乎不是 C / POSIX 标准的一部分。这段代码目前在多个平台（Linux、OSX、Windows、iOS、Android (NDK)）上编译，所以我需要找到一种方法让它在所有这些平台上工作，即使解决方案涉及`#ifdef $PLATFORM`类型的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T00:10:14.303

这让我有点想吐在嘴里，但您可以将其转换为字符串 with `strftime()`，替换字符串中的时区，然后将其转换回 with`strptime()`并转换为`time_t`with `mktime()`。详细地：

```
#ifdef UGLY_HACK_VOIDS_WARRANTY
time_t convert_time(const struct tm* tm)
{
    const size_t BUF_SIZE=256;
    char buffer[BUF_SIZE];
    strftime(buffer,256,"%F %H:%M:%S %z", tm);
    strncpy(&buffer[20], "+0001", 5); // +0001 is the time-zone offset from UTC in hours
    struct tm newtime = {0};
    strptime(buffer, "%F %H:%M:%S %z", &newtime);
    return mktime(&newtime);
}
#endif 
```

但是，我强烈建议您说服权力毕竟增强是一种选择。Boost 对自定义时区有很好的支持。还有其他库也可以优雅地做到这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T17:54:54.373

如果您只想将`struct tm`UTC 中的给定转换为 a，`time_t`那么您可以这样做：

```
#include <time.h>

time_t utc_to_time_t(struct tm* timeinfo)
{
    tzset(); // load timezone information (this can be called just once)

    time_t t = mktime(timeinfo);
    return t - timezone;
} 
```

这基本上将 UTC 时间转换`time_t`为好像给定时间是本地时间，然后对结果应用时区校正以将其恢复为 UTC。

在 gcc/cygwin 和 Visual Studio 2010 上测试。

我希望这有帮助！

**更新**：正如您很好指出的那样，当查询日期的夏令时状态与当前时间不同时，我上面的解决方案可能会返回一个小时的 time_t 值。

该问题的解决方案是有一个附加函数，它可以告诉您日期是否在 DST 区域内，并使用该日期和当前 DST 标志来调整返回的时间`mktime`。这实际上很容易做到。当您打电话时，`mktime()`您只需将`tm_dst`成员设置为-1，然后系统将尽力为您计算给定时间的 DST。假设我们对此信任系统，那么您可以使用此信息进行更正：

```
#include <time.h>

time_t utc_to_time_t(struct tm* timeinfo)
{
    tzset(); // load timezone information (this can be called just once)

    timeinfo->tm_isdst = -1; // let the system figure this out for us
    time_t t = mktime(timeinfo) - timezone;

    if (daylight == 0 && timeinfo->tm_isdst != 0)
        t += 3600;
    else if (daylight != 0 && timeinfo->tm_isdst == 0)
        t -= 3600;
    return t;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T05:15:49.133

如果您在 Linux 或其他 UNIX 或类似 UNIX 的系统上，那么您可能有一个[`timegm`](http://linux.die.net/man/3/timegm)功能可以满足您的需求。链接的手册页具有可移植的实现，因此您可以自己制作。在 Windows 上，我知道没有这样的功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-29T18:53:59.827

经过几天的努力，试图获得一个`timegm(1)`可以在 Android 上运行的功能（不附带一个），我终于发现了这个简单而优雅的解决方案，它工作得很好：

```
time_t timegm( struct tm *tm ) {
  time_t t = mktime( tm );
  return t + localtime( &t )->tm_gmtoff;
} 
```

我不明白为什么这不是一个合适的跨平台解决方案。

我希望这有帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2022-02-04T20:37:28.090

```
time_t my_timegm2(struct tm *tm)
{
    time_t ret = tm->tm_sec + tm->tm_min*60 + tm->tm_hour*3600 + tm->tm_yday*86400;
    ret += ((time_t)31536000) * (tm->tm_year-70);
    ret += ((tm->tm_year-69)/4)*86400 - ((tm->tm_year-1)/100)*86400 + ((tm->tm_year+299)/400)*86400;
    return ret;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-08T21:50:04.713

似乎有一个更简单的解决方案：

```
#include <time64.h>
time_t timegm(struct tm* const t) 
{
  return (time_t)timegm64(t);
} 
```

实际上，如果它真的有效，我还没有 testet，因为我还有一些移植工作要做，但它可以编译。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-08-30T14:02:04.353

这是我的解决方案：

```
#ifdef WIN32
#   define timegm _mkgmtime
#endif

struct tm timeinfo;
timeinfo.tm_year = year - 1900;
timeinfo.tm_mon = mon - 1;
timeinfo.tm_mday = day;
timeinfo.tm_hour = hour;
timeinfo.tm_min = min;
timeinfo.tm_sec = sec;

return timegm(&timeinfo); 
```

这应该适用于unix和windows

# java - 访问文件的 Jar Manifest 时出错

> ID：11218802
> 
> 赞同：0
> 
> 时间：2012-06-27T02:58:17.893
> 
> 标签：java, eclipse, web

我在 Eclipse 中创建了一个动态 Web 项目，但是当我设置服务器并部署它时，服务器总是在日志中报告警告级别消息，说明

> 访问文件的 Jar Manifest 时出错 .../WEB-INF/classes/META-INF/MANIFEST.MF：文件不存在！

但应用程序运行良好！为什么会出现此警告？这是什么意思，我怎样才能避免 id？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T10:26:25.247

它的意思正是它所说的，该路径下没有清单文件。

应用程序使用清单文件来找出各种东西，主要是类路径中所需的库。

为了解决这个问题，只需转到 Webcontent/META-INF 并使用以下行创建一个 MANIFEST.MF 文件：

```
Manifest-Version: 1.0
Class-Path: 
```

# linux - GNU 与 Linux 有什么关系？

> ID：11218807
> 
> 赞同：1
> 
> 时间：2012-06-27T02:59:15.813
> 
> 标签：linux, gnu

我想知道 Linux 和 GNU 是如何相互关联的。任何人都可以消除我的疑问吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T03:03:13.687

GNU 由 Richard Stallman 创立，是一组工具，或多或少有助于创建功能齐全的操作系统。GNU 的目标是创建一个完全免费的、开源的 UNIX 替代品。

Linux 是由 Linus Torvalds 创建的，与 GNU 没有任何联系。Linux 用作操作系统内核。在创建 Linux 时，已经创建了许多 GNU 组件，但 GNU 缺少内核，因此将 Linux 与 GNU 组件一起使用以创建完整的操作系统。现在有一个由正在开发中的 GNU 团队 (GNU Hurd) 创建的内核，它可以用来代替 Linux 生成一个完全基于 GNU 的操作系统。然而，GNU Hurd 仍处于开发阶段（已经有 20 年了），Linux 是一个更成熟的内核。

也有可能（例如在 Android 的情况下）拥有一个没有 GNU 组件的基于 Linux 的操作系统。

但通常一个完整的操作系统将由 Linux + 许多 GNU 组件组成，有时也称为 GNU/Linux。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T03:13:52.327

最初，GNU 是一个逐步构建完整的与 Unix 兼容的操作系统的项目。

计划是根据规范重写每个小型实用程序，通过替换原始的 Unix 在工作的 Unix 上对其进行测试。进展非常顺利，除了内核，进展特别缓慢，可能是因为几个优秀的开发人员无法就绝对最佳的设计达成一致。

计划中的 HURD 内核其实设计得很先进，有很多创新，但似乎不会很快完成。

与此同时，Linus Torvalds 正在编写自己的内核，主要是为了自学如何控制 Intel 80386 处理器的低级方面。起初它只是一个任务切换器，但他很快实现了大部分旧的系统调用规范，直到他设法在新内核之上运行大部分 MINIX（另一个类 Unix 系统，主要用于教育）环境。

很快，其他人建议使用 GNU 实用程序而不是 MINIX 实用程序，并得到了一个更完整的系统。它运行得非常好，以至于大多数 GNU 开发人员只是采用了 Linux 内核，而不是永远等待 HURD 内核。

由此产生的操作系统通常被称为“Linux”，但 Linux 确实只是内核。所有 GNU 实用程序的代码行数都多得多，因此更恰当地称为 GNU/Linux。

# css - 双正斜杠是否指示 IE 使用特定的 css？

> ID：11218808
> 
> 赞同：5
> 
> 时间：2012-06-27T02:59:17.360
> 
> 标签：css, internet-explorer, browser, comments, compatibility

我刚刚在开发网站时发现了一些非常奇怪的东西。在尝试让 div 元素显示在屏幕顶部时，我注意到除了旧版本的 IE 之外，我在任何浏览器中都没有达到预期的效果。为了测试一些不同的代码，我没有删除错误的行，而是使用“//”将其注释掉（我什至不确定这是否适用于 css）但发生的事情是，兼容的浏览器使用了未注释的代码，而IE使用'//'标记的代码。这是代码：

```
#ban-menu-div{
position:fixed;top:0;
//position:relative; //<-- IE keeps the banner with rel pos while the other
display:block;       //    browsers used fixed
margin:auto;
padding:0px;
width:100%;
text-align:center;
background:black;
} 
```

所以基本上，似乎 // 可以用来指示较新的浏览器忽略特定的代码行，并指示旧版本的 IE 使用它？如果这是常见的做法，请告诉我。它确实使为旧浏览器的开发变得容易得多

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T03:12:56.177

`//`不是[有效的 CSS 注释](http://www.w3.org/TR/CSS21/syndata.html#comments)。

正确解析 CSS 的浏览器将忽略`//position`，因为`//position`它不是有效的属性名称（详细信息在[这里](http://www.w3.org/TR/CSS21/grammar.html#grammar)，`property`-> `IDENT S*`->[跟随它](http://www.w3.org/TR/CSS21/grammar.html#scanner)）。

这仅在 IE7 中有效，因为它众所周知的错误是接受带有垃圾的属性。

不仅`//`如此。IE7 将在此处显示红色文本：

```
body {
    !/!*//color: red;
} 
```

这是最常见的利用`*`，例如`*display: inline;`作为[`display: inline-block`IE7 解决方法的](https://stackoverflow.com/questions/5838454/inline-block-doesnt-work-in-internet-explorer-7-6/5838575#5838575)一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-17T13:13:56.377

不要陷入注释掉单行或块而不使用正确的 /* */ 对的诱惑。有权访问网站文件夹的客户只是自己选择使用以下命令注释掉一行：

```
//*  comment here   *// 
```

实际上，Chrome 和 Safari 将忽略此行之后的任何内容。我称之为“css杀手”。:D

# .net - 如果当前 LifeTimeScope 中有另一个组件，我如何才能仅解析一个组件？

> ID：11218809
> 
> 赞同：0
> 
> 时间：2012-06-27T02:59:18.190
> 
> 标签：.net, dependency-injection, autofac

我这里的情况看起来很像 NHibernate 世界中的“SELECT N+1”。

我正在创建一个应用程序 ASP.NET MVC 应用程序，而**HomeController**需要一个**IUserSignUpService**。IUserSignUpService “**存在**”在*应用程序服务层*中，它绑定到具体类**UserSignUpService**。

UserSignUpService 有 2 个依赖项：

```
public IUserRepository UserRepository { get; set; }
public Domain.Services.IUserSignUpService SignUpService { get; set; }

public UserSignUpService(IUserRepository userRepository, Domain.Services.IUserSignUpService signUpService)
{
    this.UserRepository = userRepository;
    this.SignUpService = signUpService;
} 
```

当 Autofac 解析位于应用程序服务层中的**IUserSignUpService**时，它​​需要解析位于持久层中的**IUserRepository依赖****项**和位于域并在执行 INSERT SQL 到数据库之前执行几个操作。

IUserRepository接口由 UserRepository 类实现，**该类****需要**通过构造函数注入**ISession实例。**

我的观点是：

如果我继续使用这种方法，每次我收到 HomeController 的 HttpRequest 时，我都会启动一个新的 ISession（因为它是 UserRepository 的构造函数依赖项，它是 IUserSignUpController 的构造函数依赖项，它是 HomeController 的构造函数依赖项） .

我不需要每次都需要。也许我可以指示 Autofac 仅在当前 LifeTimeScope 中有 IUnitOfWork 接口的实例时才解析 ISession。

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:05:14.880

测试是否为不构造 ISession 做额外的工作是过早的优化。是否有显着的性能影响？

如果是这样，您可以将“每次都不需要”的任何构造函数依赖包装在 Lazy<> 中，[Autofac 将延迟实例化](https://code.google.com/p/autofac/wiki/RelationshipTypes)。

# jquery - 为jquery动态创建复选框

> ID：11218812
> 
> 赞同：0
> 
> 时间：2012-06-27T02:59:37.690
> 
> 标签：jquery, html

如何为 jquery 创建多个复选框以识别它？

例如我有一个 html 页面调用 new.html

```
<div id =new> <input type=checkbox"></div> 
```

在 create.html 我想使用 jquery 加载多个复选框

```
<div id=load> <div>
$("#load).load(new.html) 
```

因此，如果我使用 for 循环循环 10 次以创建 10 个复选框，我如何唯一地识别每个复选框？

```
for(var i = 0;i<10;i++){
$("#load).load(new.html)} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:04:30.943

给他们唯一的 id，将你的标记缓存在一个变量中，最后附加所有内容以获得最佳性能。

```
var inputs = [], i
for(i = 0; i < 10; i++)
  inputs.push('<input type="checkbox" id="ck'+ i +'"/>')
$('#load').append(inputs.join('')) 
```

**编辑：**
辅助功能：

```
var makeCkBoxes = function (n) {
  var inputs = [], i
  for(i = 0; i < n; i++)
    inputs.push('<input type="checkbox" id="ck'+ i +'"')
  return inputs.join('')  
}

$('#load').append(makeCkBoxes(10)) 
```

# sql - 传入日期变量或检查是否没有传入日期然后使用 getdate()

> ID：11218813
> 
> 赞同：-1
> 
> 时间：2012-06-27T03:00:00.600
> 
> 标签：sql, variable-assignment

我想使用 sqlcmd 传入一个日期变量并做一个检查条件，如果没有传入日期，则将该变量设置为 getdate()。谁能给我建议？谢谢你。下面是我的 sql 脚本。（ getdate() 部分应该修改）

```
--Declare variable to store back up file location
DECLARE @DBBackupFile as nvarchar(128);

SET @DBBackupFile = N'C:\sqlbackup\MOL_POSHistory\MOL_POSHistory_backup_' + convert(varchar(12),(year(GETDATE()) * 10000) + (month(GETDATE()) * 100) + Day(GETDATE()) -4 ) + N'0201.bak';

--Retrive the Logical file name of the database from backup.
RESTORE FILELISTONLY
FROM DISK = @DBBackupFile
GO

--Make Database to single user Mode
ALTER DATABASE [MOL_POSHistory]
SET SINGLE_USER WITH
ROLLBACK IMMEDIATE

--Restore Database
DECLARE @DBBackupFile as nvarchar(128);

SET @DBBackupFile = N'C:\sqlbackup\MOL_POSHistory\MOL_POSHistory_backup_' + convert(varchar(12),(year(GETDATE()) * 10000) + (month(GETDATE()) * 100) + Day(GETDATE()) -4 ) + N'0201.bak';

USE master;

RESTORE DATABASE [MOL_POSHistory] FROM DISK = @DBBackupFile WITH FILE = 1,

MOVE N'MOL_POSHistory' TO N'D:\SQLData01\MOL_POSHistory.mdf',

MOVE N'MOL_POSHistory_log' TO N'F:\SQLLog\MOL_POSHistory.ldf',

NOUNLOAD, REPLACE, STATS = 10

--Set database to multi user mode
ALTER DATABASE [MOL_POSHistory] SET MULTI_USER
GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T05:38:22.277

您需要使用 –v 参数像这样调用 SQLCMD：

```
// Date format is YYYYMMDD

sqlcmd -S YOUR_SERVER -v inputDate="20010101" -i "YOUR_INPUT_FILE" -E 
```

您可以访问 SQLCMD 传入的参数（`inputDate`在此示例中），如下所示：

```
DECLARE @inputDate NVARCHAR(50)

DECLARE @date DATETIME

SET @inputDate = '$(inputDate)'

IF (LEN(ISNULL(@inputDate, '')) = 0) BEGIN

        SET @date = GETDATE()

       PRINT 'Using default date'

END

ELSE BEGIN

        SET @date = @inputDate

        PRINT 'Using varaible date'

END 
```

# couchdb - CouchDB-Ektorp 中的批量更新 - 不应该返回更新冲突吗？

> ID：11218816
> 
> 赞同：0
> 
> 时间：2012-06-27T03:00:31.040
> 
> 标签：couchdb, ektorp

我一直在使用 Ektorp (1.3.0) 框架连接到我的 CouchDB 数据库。但是，当存在更新冲突时会出现问题。我正在使用 `executeAllOrNothing`批量更新的方法。如文档所述，此方法（以及等效的 HTTP API `_bulk_docs?all_or_nothing":true`不会对冲突进行任何检查。来自[HTTP API 文档](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API#Transactional_Semantics_with_Bulk_Updates)：

> 但是，如果 id 为 0 的文档发生冲突，则两个版本都将出现在数据库中，并且可以任意选择哪个版本出现在视图中。您可以使用带有 ?conflicts=true 的 GET 检查此状态

还：

> 依赖此功能的应用程序应该能够容忍某些文档丢失或处于冲突状态，直到发生冲突解决。

但是，该方法的 Ektorp 的 javadocs 说：

> 该列表（返回）将仅包含具有从 CouchDB 返回的任何类型的错误代码的文档的条目。即如果一切都成功完成，列表将为空。

我发现事实并非如此。当发生冲突时，Ektorp 仍然返回一个空列表。我发现获取失败操作列表的唯一方法是使用`executeBulk`而不是`executeAllOrNothing`，但这并不令人满意，因为我需要这是一个事务。

有什么方法可以知道调用是否`executeAllOrNothing`成功，如果没有成功，哪些文档有冲突问题（无需重复使用`GET with conflicts=true`每个文档，因为我可能会尝试一次保存数千个文档，所以这个不切实际）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T23:09:51.327

您提到的 ektorp 文档中描述的行为不是 CouchDB 行为。使用`all_or_nothing:true`CouchDB 时，只需在数组中返回成功对象（`ok`和`id`new `rev`），根本没有任何迹象表明它们存在冲突。

因此，这种行为（从该数组中删除成功的对象）是 ektorp 必须（应该）做的事情。所以这听起来像是 ektorp 中的一个错误。您应该查看[他们的 github 项目](https://github.com/helun/Ektorp)以了解如何报告错误。

# android - Monkeyrunner.sleep() 总是发送新闻事件时出错

> ID：11218818
> 
> 赞同：1
> 
> 时间：2012-06-27T03:00:36.963
> 
> 标签：android, eclipse, monkeyrunner

我使用 android MonkeyRunner 做一些测试

每次运行 Monkeyruuner.sleep() 都会失败

像这样

```
from com.android.monkeyrunner import MonkeyRunner
device = MonkeyRunner.waitForConnection()
device.press('KEYCODE_ENTER', 'DOWN_AND_UP')
MonkeyRunner.sleep(10)
device.press('KEYCODE_ENTER', 'DOWN_AND_UP') 
```

在第二

```
device.press('KEYCODE_ENTER', 'DOWN_AND_UP') 
```

总是失败

```
[main] [com.android.chimpchat.adb.AdbChimpDevice] Error sending press event: KEYCODE_ENTER DOWN_AND_UP 
```

请帮忙谢谢'谢谢大家的回复！

但即使使用 time.sleep() 或 MonkeyDevice.DOWN_AND_UP 总是有错误

我的分数代码

```
from com.android.monkeyrunner import MonkeyRunner
import time 
device = MonkeyRunner.waitForConnection()
device.press('KEYCODE_DPAD_RIGHT', device.DOWN)
device.press('KEYCODE_DPAD_RIGHT', device.UP)
time.sleep(2)
device.press('KEYCODE_DPAD_RIGHT', device.DOWN)
device.press('KEYCODE_DPAD_RIGHT', device.UP)
time.sleep(2)
device.press('KEYCODE_DPAD_RIGHT', device.DOWN)
device.press('KEYCODE_DPAD_RIGHT', device.UP)
time.sleep(2) 
```

三下下来，上来总是错的

日志

```
120718 09:50:51.744:S [main] [com.android.chimpchat.adb.AdbChimpDevice] Error sending press event: KEYCODE_DPAD_RIGHT DOWN
120718 09:50:51.744:S [main][com.android.chimpchat.adb.AdbChimpDevice]java.net.SocketException: Software caused connection abort: recv failed
120718 09:50:51.744:S [main] [com.android.chimpchat.adb.AdbChimpDevice] at java.net.SocketInputStream.socketRead0(Native Method)
120718 09:50:51.744:S [main] [com.android.chimpchat.adb.AdbChimpDevice] at java.net.SocketInputStream.read(Unknown Source)
120718 09:50:51.744:S [main] [com.android.chimpchat.adb.AdbChimpDevice] at 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-03T12:24:35.357

您的关键代码是根据 API。

但是，我对 MonkeyRunner.sleep 函数有类似的问题（在某些 android 版本中可能是一个错误）。

作为一种解决方法，我使用如下所述的 time.sleep 函数。

```
import time
from com.android.monkeyrunner import MonkeyRunner
device = MonkeyRunner.waitForConnection()
device.press('KEYCODE_ENTER', 'DOWN_AND_UP')
time.sleep(10)
device.press('KEYCODE_ENTER', 'DOWN_AND_UP') 
```

谢谢你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T17:54:23.980

它没有失败，因为`Monkeyruuner.sleep()`实际上`device.press` `'DOWN_AND_UP'`应该是`MonkeyDevice.DOWN_AND_UP`

# windows - Windows ReadDirectoryChangesW() -- 处理重复事件

> ID：11218819
> 
> 赞同：0
> 
> 时间：2012-06-27T03:00:44.530
> 
> 标签：windows, winapi, pywin32, inotify, pywin

我正在使用 Python win32 模块监视 Windows 中的目录更改。任务是在指定目录中递归地捕获文件和目录的`CREATE`、`DELETE`和`MODIFY`事件。NotifyFlag 设置如下：

```
FILE_NOTIFY_CHANGE_FILE_NAME | FILE_NOTIFY_CHANGE_DIR_NAME | FILE_NOTIFY_CHANGE_LAST_WRITE 
```

问题是可能会返回重复的事件，我不知道为什么，例如，对文件的简单修改会导致 3 个文件更新通知——确切地说，发出了两组通知：第一组只包含 1 个更新通知和其他 2 - 都在同一个文件中。

另外，有什么方法可以消除重复事件？

谢谢和最好的问候！

# jquery - magento中的同步jquery ajax调用

> ID：11218821
> 
> 赞同：2
> 
> 时间：2012-06-27T03:01:17.780
> 
> 标签：jquery, ajax, magento, synchronous

我有一个用户正在输入帐号的表单，我需要在单击保存按钮时检查输入的帐号是否唯一，但在提交表单之前。这是在 magento 后端，ajax 调用指向`acctnumAction()`indexController 中的函数。

帐号的数量是动态的，最多可以有 5 个，但少至 1 个，所以我需要对项目进行每个循环。我给了帐号字段他们自己的类并循环了它。

这就是我所拥有的。

```
 function acctCheck(){
        jQ.each(jQ(".acctnum"), function(x, y){
            var acct = jQ(this).val();
            var field = this;
            jQ.get("'.Mage::helper('core/url')->getHomeUrl().'dealerlocator/index/acctnum", {acctnum: acct}, function(data){
                var items = JSON.parse(data);
                if(items != ""){
                    $(field).addClass("validation-failed");
                    return false;
                }
            });
        });
    }
    function saveAndContinueEdit(){
        if(acctCheck() !== false){ editForm.submit(); }
    } 
```

点击保存按钮点击`saveAndContinueEdit()`并运行检查帐号的功能。

我知道这行不通，ajax 将异步运行并且在返回 false 之前什么也不返回，只要它不是 false，它就会提交。但是我尝试将 ajax 调用包装在 $.when 中无济于事，我将 if 包装在`saveAndContinueEdit()`$.when 中，就像这样

```
 function saveAndContinueEdit(){
        jQ("#continueEdit").val("1");
        jQ.when(acctCheck()).done(function(valid){
            if(valid !== false){
                editForm.submit();
            }
        });
    } 
```

但这也没有成功，甚至可能不是它应该如何工作，我只是在尝试我能想到的任何东西。

将它放在 each 中的目的是，如果帐号无效，我可以将变量设置为 false，但仍会遍历其余部分，以便在无效时仍将类添加到字段中，因此用户会知道，而不是修复一个然后另一个弹出为无效，即使我的示例不是这样编码的。我知道 get 返回的数据是有效的，它只是不会同步运行。

有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T16:23:28.813

我使用延迟让它工作。

```
 function eachAcctChk(elem){
        return jQ.get("'.Mage::helper('core/url')->getHomeUrl().'dealerlocator/index/acctnum", {account: jQ(elem).val(), dealer: '.$data["id"].'}, function(data){
            if(data != "none"){
                jQ(elem).addClass("validation-failed");
                valid = false;
            }
        });
    }
    function saveAndChk(){
        jQ("#continueEdit").val("0");
        AcctChk();
    }
    function saveAndContinueChk(){
        jQ("#continueEdit").val("1");
        AcctChk();
    }
    function AcctChk(){
        var deferreds = [];
        jQ(".acctnum").each(function(){
            deferreds.push(eachAcctChk(this));
        });
        jQ.when.apply(null, deferreds).then(function(){
            if(valid){
                editForm.submit();
            } else {
                valid = true;
                alert("The highlighted dealer account numbers are already in use by another company. Unique account numbers are required.");
            }
        });
    } 
```

返回整个 ajax (get) 调用作为延迟调用，我将它们全部放入一个数组中并将其传递给 when()。因此，当所有 ajax 调用完成时，它会点击 then()，然后瞧。

# c# - AddUrlSegment 在 RestSharp 中抛出 NullReferenceException

> ID：11218823
> 
> 赞同：3
> 
> 时间：2012-06-27T03:01:28.733
> 
> 标签：c#, .net, restsharp

我正在尝试使用 RestSharp 的 AddUrlSegment 在 URL 中子令牌

例如：“www.test.com/{someToken}/Testing”

我正在使用这段代码：

```
string theToken = "someStringToken";
restRequest.AddUrlSegment("someToken",theToken); 
```

当我尝试执行请求时，这会引发 NullReferenceException。

任何想法我做错了什么。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T04:20:42.287

好吧，我想通了。我拥有的RestSharp版本（NUGET），显然不支持上面的方法。此外，Resource 属性应该是获取将被替换的 url 的属性，因此最终代码是这样的。

```
string _baseUrl = "www.test.com";

RestClient client = new RestClient(_baseUrl);
RestRequest restRequest = new Request();
restRequest.Resource = "/{someToken}/Testing";
restRequest.AddParameter("someToken", theToken , ParameterType.UrlSegment); 
```

这段代码适用于我从 NUGET 获得的版本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-23T10:43:27.160

我遇到了同样的问题。

这是一些**替代解决方案代码**，使用**RestSharp v.104.4.0**在构造函数中传递资源和简化方法调用：

```
string _baseUrl = "www.test.com";

var client = new RestClient(_baseUrl);
var req = new RestRequest("/{someToken}/Testing", Method.GET);
req.RequestFormat = DataFormat.Json;
req.AddUrlSegment("someToken", theToken); 
```

# html - 在主 div（或主体）上获得 100% 的高度/宽度边框

> ID：11218827
> 
> 赞同：3
> 
> 时间：2012-06-27T03:03:12.187
> 
> 标签：html, css

[http://designobvio.us/vodka/](http://designobvio.us/vodka/)现场演示

我已经设置了我的 html、container、main 和 100% 但是无论我做什么我都无法在没有滚动条的情况下让边框达到 100% 的高度？

我怎样才能达到效果？

HTML

```
 <div id="main">

  </div> 
```

CSS（目前不是实时代码，但这是我尝试过的）

```
html, body{height:100%; width:100%;} 
#main{height:100%; position:absolute; top:0px; bottom:0px; left:0px; right:0px; border:5px solid #000;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T07:10:09.250

默认情况下，边框、边距和填充不是宽度/高度的一部分，而是添加在顶部。这就是为什么你会得到滚动条，因为盒子的全尺寸是 100% 的高度和宽度加上边框宽度。

您可以将`box-sizing`属性设置为`border-box`，这会告诉浏览器在宽度/高度属性中包含边框和填充的计算（与`content-box`默认值相反）：

```
#main {
    box-sizing: border-box;
    [...]      
} 
```

由于特别是 IE8 和其他浏览器系列的早期版本不支持此 css 属性，因此添加一些特定于浏览器的定义也是一个好主意：

```
#main {
   -moz-box-sizing:    border-box;
   -webkit-box-sizing: border-box;
   -ms-box-sizing:     border-box;
    box-sizing:        border-box;
} 
```

查看[mozilla doku 以获取有关 box-sizing 的详细信息](https://developer.mozilla.org/En/CSS/Box-sizing)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-09-26T14:48:04.823

我知道这是一篇旧帖子，但是当它出现在 Google 第一页时……这是我的解决方案，似乎可以在跨浏览器上正常工作：

```
height: 0:
border-style: solid;
border-width: 8vw 0 0 100vw;
border-color: transparent transparent transparent red; 
```

只是将它用于 :after 伪元素，以便将其变成三角形，它工作得很好（测试到 ie10）。

只需使用`100vw`而不是`100%`它应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T06:58:20.303

您在寻找固定边框还是动态边框？您的代码的问题是 W3C 盒子模型。在默认模型中，填充、边距和边框被添加到元素的大小中。因此，在您的代码中，您真正要告诉它的是“将框设为 100%，然后添加 10px 的边框”。

通常一个简单的改变是手动切换盒子模型，但不幸的是，该属性与`height: 100%`. 所以你有几个选择：

1）如果您正在寻找固定边框，这是一个好技巧：[http](http://css-tricks.com/body-border/) ://css-tricks.com/body-border/ 2）如果您需要动态边框，您需要以某种方式绕过额外的高度边框添加。这是一种方法：

```
html,body { height:100%; padding: 0; margin: 0; }
#container {
    min-height:100%;
    border-right: 5px solid #000;
    border-left: 5px solid #000;
    position: relative; /* relative postion so we can absolutely position footer within it */
}
#header {
    height: 100px;
    border-top: 5px solid #000;
    background-color: red;
}
#content { padding: 0 0 100px 0; } /*padding must be equal to the height of the footer*/
#footer {
    height: 100px;
    border-bottom: 5px solid #000;
    background-color: blue;
    position: absolute;
    bottom: 0;
    width: 100%; /* with absolute position, a width must be declared */
} 
```

HTML

```
<div id="container">
    <div id="header"></div>
    <div id="content"></div>
    <div id="footer"></div>
</div> 
```

jsfiddle在这里：http: [//jsfiddle.net/Qw2cb/](http://jsfiddle.net/Qw2cb/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-26T14:59:19.357

你可以给`box-size:border-box;`'main'，比如

```
#main{
    box-size:border-box;
} 
```

这样做边框将被添加到 main 的 100% 高度。[在此处了解有关盒子尺寸的更多信息](https://www.w3schools.com/cssref/css3_pr_box-sizing.asp)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-27T03:08:55.820

所以，你是说你不想显示滚动条？

CSS：

```
#main
{
    overflow: hidden;
    height: 100%;
    position: absolute;
    margin: 0px;
} 
```

# vb.net - 关闭网站后保存数据？

> ID：11218829
> 
> 赞同：0
> 
> 时间：2012-06-27T03:03:47.990
> 
> 标签：vb.net

我正在使用 vb.net，我想在关闭[www.example.com](http://www.example.com)的网站后保存购物车的数据。然后当我去重新运行[www.example.com](http://www.example.com)时，购物车的数据仍然存在。

那可能吗？

* * *

**编辑**

谢谢 AVD。在这里编辑了答案。这适用于对代码放置位置有疑问的任何人

将此代码放在 web.config 中

```
<profile>
  <properties>
    <add name="PostalCode" />
  </properties>
</profile> 
```

查看[个人资料](http://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx)了解更多信息。正如 AVD 所说。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:21:02.603

您必须使用[配置文件](http://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx)状态。该`Profile`州使用数据库，因此即使在用户离开后您也可以保留用户会话数据。

# ninject - 请举例说明 Ninject 基础知识

> ID：11218830
> 
> 赞同：4
> 
> 时间：2012-06-27T03:03:59.957
> 
> 标签：ninject, ninject-2

设想：

对 DI 和 Ninject 很陌生，但我很想掌握它，以便我知道在做什么以及为什么。

在浏览一些示例和文档时，我注意到以下内容：

```
1\. ToConstructor.
2\. ToMethod
3\. Self 
```

如果有人可以帮助我了解何时以及如何使用上述内容，那就太好了。一个例子会很好。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T22:09:12.453

嗨，

**自**绑定声明某种类型的绑定到自身。具有无参数构造函数的类型不需要自绑定。Ninject 可以自己实例化这些类型。如果您声明一个自绑定，即`Bind<Sword>().ToSelf();`只能执行一个`Get<Sword>`. 例如`Get<ISword>`会抛出一个 ActivationException。

**方法**绑定允许您指定负责创建绑定类型实例的方法。例如，您可以执行以下操作：`Bind<ISword>().ToMethod(() => new Sword(strength = 12));`您可以在此处的 ninject wiki 上查看更多示例：[https ://github.com/ninject/ninject/wiki/Dependency-Injection-With-Ninject](https://github.com/ninject/ninject/wiki/Dependency-Injection-With-Ninject)

# backbone.js - 在 Backbone.Router.navigate() 之后运行函数

> ID：11218833
> 
> 赞同：1
> 
> 时间：2012-06-27T03:04:10.487
> 
> 标签：backbone.js, coffeescript

我想在backbone.navigate 调用之后运行一个函数（以呈现flash 消息）。是否可以？我目前连接到所有事件并检查事件名称是否以“路由：”开头。但这触发得太早了，在我的消息被添加之前......所以我正在考虑在路线完成后运行

```
# intercept all router navigate and render flash messages if any
renderFlashMessengesOnNavigate = (evt) =>
  if evt.indexOf("route:") is 0 
    console.log "rendering messages after route ..."
    @flashMessenger.render()
window.appRouter.bind "all", renderFlashMessengesOnNavigate
window.authRouter.bind "all", renderFlashMessengesOnNavigate
window.userRouter.bind "all", renderFlashMessengesOnNavigate 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-27T04:45:24.507

试试这个：

```
var originalNavigate = Backbone.history.navigate;
Backbone.history.navigate = function(fragment, options){
    originalNavigate.apply(this, arguments);

    //your code here
} 
```

# java - 无法在 doInbackground() 方法中执行 AlertDialog

> ID：11218839
> 
> 赞同：4
> 
> 时间：2012-06-27T03:05:00.197
> 
> 标签：java, android, android-asynctask, httpurlconnection

我在 postexecute() 上执行 AlertDialog 时遇到问题。引发此异常 原因：java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare() 或者，当我将 AlertDialog.Builder 放入其中时，它不起作用请帮忙。此外，在输入了错误密码的情况下，该过程终止。在用户名或密码无效的情况下如何调用 Toast 方法下面是代码片段

```
public void Login() {

    // Toast.makeText(getBaseContext(), pass.getText() + " "
    // +user.getText(),
    // Toast.LENGTH_SHORT).show();

    String url = "http://107.20.195.151/mcast_ws/" + "?user="
            + user.getText().toString() + "&password="
            + pass.getText().toString();

    result = getHttpResponse(url);  
}

String result;
private String getHttpResponse(String location) {
    result = "";
    URL url = null;
    Log.d(LOGTAG, " " + "location " + location);
    try {
        url = new URL(location);
    } catch (MalformedURLException e) {
        Log.e(LOGTAG, " " + "error" + e.getMessage());
    }
    if (url != null) {
        try {
            HttpURLConnection connection = (HttpURLConnection) url
                    .openConnection();
            BufferedReader in = new BufferedReader(new InputStreamReader(
                    connection.getInputStream()));
            String inputLine;
            int lineCount = 0;
            while ((inputLine = in.readLine()) != null) {
                result += inputLine.trim();
            }

            in.close();
            connection.disconnect();
        } catch (Exception e) {

            Log.e(LOGTAG, " " + "IOError " + e.getMessage());
            Toast.makeText(getBaseContext(), "No Internet Access",
                    Toast.LENGTH_SHORT);
        }
    } else {
        Log.e(LOGTAG, " " + "url" + url);
    }
    return result;
}

class PostToTwitter extends AsyncTask<String, Void, String> {

    @Override
    protected String doInBackground(String... params) {

        Login();
        Log.d(LOGTAG, "Success");
        Log.d(LOGTAG, result);
        Log.d(LOGTAG, result.substring(0, 16).trim());
        // Log.d(TweetActivity.getLogtag(),"Successfully Posted: " +
        // params[0]);

        return "success";
    }

    @Override
    protected void onPostExecute(String r) {
        // TODO Auto-generated method stub
        super.onPostExecute(result);
        String msg = "Login successful";

        if (result.substring(0, 16).trim().equals(msg)) {
            // System.out.println(result.substring(0, 16).trim());
            Log.d(LOGTAG, " " + "Connection Test" + result);
            AlertDialog.Builder builder = new AlertDialog.Builder(getApplicationContext());
            builder.setMessage("Are you sure send this SMS?")
                   .setCancelable(false)
                   .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                       public void onClick(DialogInterface dialog, int id) {
                            //...Attach another thread event to send the sms
                       }
                   })
                   .setNegativeButton("No", new DialogInterface.OnClickListener() {
                       public void onClick(DialogInterface dialog, int id) {
                            dialog.cancel();
                       }
                   });
            Log.e(LOGTAG, "Error detected 2");
            AlertDialog alert = builder.create();
            alert.show();
            //return  "success";
            // Toast.makeText(getBaseContext(),
            // "Login Succesful",Toast.LENGTH_SHORT).show();

        } else {
            Toast.makeText(getBaseContext(),
                    "Login UnSuccesful. Check Username or password",
                    Toast.LENGTH_SHORT).show();
            //return null;
        }
        // Toast.makeText(getApplicationContext(), result
        // ,Toast.LENGTH_SHORT).show();
        Log.e(LOGTAG, "Error detected");

        /*
        Intent i = new Intent("com.sms.subsahara.COMPOSESMS");
        startActivity(i);
        //Log.e(LOGTAG, " " + "error2");*/

    }

} 
```

在应用 Alex 的建议时，我修改了上面的原始代码，但仍然出现错误。下面是 logcat 的异常

```
E/AndroidRuntime(  326): Uncaught handler: thread main exiting due to uncaught exception
E/AndroidRuntime(  326): android.view.WindowManager$BadTokenException: Unable to add window -- token null is not for an application
E/AndroidRuntime(  326):        at android.view.ViewRoot.setView(ViewRoot.java:472)
E/AndroidRuntime(  326):        at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:177)
E/AndroidRuntime(  326):        at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:91)
E/AndroidRuntime(  326):        at android.app.Dialog.show(Dialog.java:239)
E/AndroidRuntime(  326):        at com.sms.subsahara.WebMessengerActivity$PostToTwitter.onPostExecute(WebMessengerActivity.java:216)
E/AndroidRuntime(  326):        at com.sms.subsahara.WebMessengerActivity$PostToTwitter.onPostExecute(WebMessengerActivity.java:1)
E/AndroidRuntime(  326):        at android.os.AsyncTask.finish(AsyncTask.java:417)
E/AndroidRuntime(  326):        at android.os.AsyncTask.access$300(AsyncTask.java:127)
E/AndroidRuntime(  326):        at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
E/AndroidRuntime(  326):        at android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(  326):        at android.os.Looper.loop(Looper.java:123)
E/AndroidRuntime(  326):        at android.app.ActivityThread.main(ActivityThread.java:4363)
E/AndroidRuntime(  326):        at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(  326):        at java.lang.reflect.Method.invoke(Method.java:521)
E/AndroidRuntime(  326):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
E/AndroidRuntime(  326):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
E/AndroidRuntime(  326):        at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T03:27:30.800

`doInBackground`不与 UI 线程同步，这意味着您不能从方法内直接操作 UI 元素、启动对话框等。修复很容易。只需将`AlertDialog`代码移动到`onPostExecute`方法（*与*UI 线程同步）。

使用`AsyncTask`s 时，请记住：

1.  `doInBackground`旨在执行潜在的昂贵操作（网络访问、套接字连接、数据库查询等）
2.  `onPostExecute`如果您愿意，可以对结果进行一些处理（此方法与 UI 线程同步，因此您可以直接操作 UI 元素）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T03:53:24.740

DoInBackground() 仅在与主 UI 线程不同的线程上执行。这就是 AsyncTask 的重点。

有 3 种方法可以将结果发布到 UI（几乎......到 UI 线程）

1.  使用 onPostExecute 方法。你得到传入的 doInBackground 方法的返回值，你可以用它做任何事情。（我认为这符合您的用例。）

2.  如果您的任务正在进行中，并且您希望在 UI 上获得少量信息，例如进度条更新，请使用 doInBackground 方法中的 publishProgress(...)，然后将其传递给您的 onProgressUpdate(...) 方法在 AsyncTask 中，它将在 UI 线程上运行。

3.  与 2 类似，但您可以使用 RunOnUiThread(...) 便捷方法抛出一个 runnable 以在 UI 线程中运行。当您有多个匿名方法时，可能不是最漂亮的代码，但它是一种快速而肮脏的方式。请注意，此方法在 Activity 类上可用，而不是在 Context 类上可用，这在某些情况下可能会破坏交易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T03:20:39.513

我猜是因为你的Login()是在AsyncTask里面执行的，而不是在mainUI里面执行的。可以在onPostExecute handler里面出来，回到主线程执行；也可以在 onPostExecute UIThread 中使用：

```
runOnUiThread(new Runnable() {
                 @Override
                    public void run() {
                    Login();    
                   }
                }); 
```

我希望它可以帮助你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-18T19:36:47.153

@亚历克斯洛克伍德

`AsyncTask.doInBackground(Void..params)`不*适合*非常长时间和重复的操作，更好的替代品是`HandlerThread`.

原因：

在 android 3.2 中，AsyncTask 以一种重要的方式改变了它的实现。从 Android 3.2 开始，AsyncTask**不再为 AsyncTask 中的每个实例创建一个线程，而是使用执行器在单个后台线程上为所有 AsyncTask 运行后台工作！**这意味着每个 AsyncTask 线程必须一个接一个地运行。因此，例如，如果您有一个长的 AsyncTask 线程（来自 REST 的图像提取器），我建议使用 HandlerThread 代替，**因为长任务运行线程可能会延迟整个链。**

***但***

可以通过使用*线程池执行器来**安全地并行运行 AsyncTask*，但我不知道确切原因，程序员不建议这样做，背后有几个与本文无关的原因。但如果你这样做，我建议你做自己的线程，**在必要时使用处理程序与主线程通信。**

# php - 从匹配变量中将“选定”添加到选项中

> ID：11218844
> 
> 赞同：-3
> 
> 时间：2012-06-27T03:05:32.353
> 
> 标签：php, option, selected

> **可能重复：**
> [在 <select> 标记内而不是在 <option> 上定义选择的任何方式](https://stackoverflow.com/questions/10431581/any-way-to-define-selected-inside-select-tag-rather-than-on-option)

我有 $country 存储用户的 2 个字母的国家代码。以美国为例。

```
<select id="countries">                     
    <option value="US">United States</option>
    <option value="EN">England</option>
    <option value="AU">Australia</option>
    <option value="CA">Canada</option>
    etc.
</select> 
```

将“选定”添加到用户国家代码选项的最佳做法是什么？

我反对增加一百万如果。另请注意，国家/地区是用 HTML 硬编码的，因此没有数组。:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:18:00.620

在 PHP 中：

```
$options = '<option value="US">United States</option>
    <option value="EN">England</option>
    <option value="AU">Australia</option>
    <option value="CA">Canada</option>';

$code = "CA";
$pattern = sprintf('/value="%s"/m', $code);
$replace = sprintf('value="%s" SELECTED', $code);
$out = preg_replace($pattern, $replace,$options);

printf('<select id="countries">%s</select>', $out); 
```

输出：

```
<select id="countries">
    <option value="US">United States</option>
    <option value="EN">England</option>
    <option value="AU">Australia</option>
    <option value="CA" SELECTED>Canada</option>
</select> 
```

基本上，您只需将所有标签转储`option`到一个巨大的 PHP 字符串中，然后运行正则表达式搜索并替换以`SELECTED`在适当的地方添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:18:30.043

除非您使用数组来填充选项，否则 PHP 中的解决方案不可能以您想要的方式实现。

在 JavaScript 中，您可以编写一个小函数来设置所选值（假设您没有使用 jQuery）：

```
function setOption(id, value)
{
    var selectBox = document.getElementById(id),
    options = selectBox.options;

    for (var i in options) {
        if (options[i].value == value) {
            selectBox.selectedIndex = i;
            return;
        }
    }
} 
```

然后，使用 PHP 在您的选择框后创建一个脚本标签：

```
<script>setOption('countries', '<?php echo 'US'; ?>');</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:21:32.837

忽略这个答案：我没有阅读所有问题:(

我处理这个问题的方法是构建一个包含所有国家/地区的数组，然后根据 foreach 循环中的值测试 $_POST 或存储的值：

```
$countries = array("US" => "United States", "EN" => "England"); 
```

然后以以下形式：

```
<?php foreach ($countries as $abbr => $display): ?>
  <?php if (array_key_exists($result['country'], $countries)): ?>
    <option value="<?php echo $abbr; ?>" selected="selected"><?php echo $display; ?></option>
  <?php else: ?>
    <option value="<?php echo $abbr; ?>"><?php echo $display; ?></option>
  <?php endif; ?>
<?php endforeach; ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T03:08:30.823

你最好的选择是用javascript来做

```
$('#countries').val('<?=$country?>'); 
```

这需要 jquery，但可以在 vanilla javascript 中完成

```
document.getElementById('countries').value = '<?=$country?>'; 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-06-27T03:12:06.427

我不是这方面的专家，但我想这可能是一个解决方案

```
<select id="countries">                     
    <option value="US" <?php if($country=='US') echo 'selected'; ?> >United States</option>
    <option value="EN" <?php if($country=='EN') echo 'selected'; ?> >England</option>
    <option value="AU" <?php if($country=='AU') echo 'selected'; ?> >Australia</option>
    <option value="CA" <?php if($country=='CA') echo 'selected'; ?> >Canada</option>
    etc.
</select> 
```

# android - 如何在Android中获取联系人的电话号码

> ID：11218845
> 
> 赞同：29
> 
> 时间：2012-06-27T03:05:35.853
> 
> 标签：android, android-cursor

我的代码如下：

```
String[] columns = {ContactsContract.Contacts._ID, ContactsContract.Contacts.DISPLAY_NAME, ContactsContract.Contacts.HAS_PHONE_NUMBER};
Cursor cursor = getContentResolver().query(ContactsContract.Contacts.CONTENT_URI, columns, null, null, null);

int ColumeIndex_ID = cursor.getColumnIndex(ContactsContract.Contacts._ID);
int ColumeIndex_DISPLAY_NAME = cursor.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME);
int ColumeIndex_HAS_PHONE_NUMBER = cursor.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER);

while(cursor.moveToNext()) 
{   
    String id = cursor.getString(ColumeIndex_ID);
    String name = cursor.getString(ColumeIndex_DISPLAY_NAME);
    String has_phone = cursor.getString(ColumeIndex_HAS_PHONE_NUMBER);

    if(!has_phone.endsWith("0")) 
    {
        System.out.println(name);
        GetPhoneNumber(id);
    }           
}

cursor.close();

public String GetPhoneNumber(String id) 
{
    String number = "";
    Cursor phones = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null, ContactsContract.CommonDataKinds.Phone._ID + " = " + id, null, null);

    if(phones.getCount() > 0) 
    {
        while(phones.moveToNext()) 
        {
            number = phones.getString(phones.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
        }
        System.out.println(number);
    }

    phones.close();

    return number;
} 
```

我获得联系人姓名成功，但获得电话号码失败`GetPhoneNumber()`。总是等于0。我
该 如何修改？ `phones.getCount()`

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-06-27T03:46:21.277

**适用于 2.0 的 Android 联系人 API**

```
//
//  Find contact based on name.
//
ContentResolver cr = getContentResolver();
Cursor cursor = cr.query(ContactsContract.Contacts.CONTENT_URI, null,
    "DISPLAY_NAME = '" + NAME + "'", null, null);
if (cursor.moveToFirst()) {
    String contactId =
        cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts._ID));
    //
    //  Get all phone numbers.
    //
    Cursor phones = cr.query(Phone.CONTENT_URI, null,
        Phone.CONTACT_ID + " = " + contactId, null, null);
    while (phones.moveToNext()) {
        String number = phones.getString(phones.getColumnIndex(Phone.NUMBER));
        int type = phones.getInt(phones.getColumnIndex(Phone.TYPE));
        switch (type) {
            case Phone.TYPE_HOME:
                // do something with the Home number here...
                break;
            case Phone.TYPE_MOBILE:
                // do something with the Mobile number here...
                break;
            case Phone.TYPE_WORK:
                // do something with the Work number here...
                break;
        }
    }
    phones.close();
}
cursor.close(); 
```

有关更多信息，请参阅此[链接](http://www.higherpass.com/Android/Tutorials/Working-With-Android-Contacts/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-27T05:00:59.080

试试这个。

```
 ContentResolver cr = getContentResolver();
    Cursor cur = cr.query(ContactsContract.Contacts.CONTENT_URI, null,
            null, null, null);
    if (cur.getCount() > 0) {
        while (cur.moveToNext()) {
            String id = cur.getString(cur.getColumnIndex(ContactsContract.Contacts._ID));
            String name = cur.getString(cur.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
            Log.i("Names", name);
            if (Integer.parseInt(cur.getString(cur.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER))) > 0) 
            {
                // Query phone here. Covered next
                Cursor phones = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI,null,ContactsContract.CommonDataKinds.Phone.CONTACT_ID +" = "+ id,null, null); 
                while (phones.moveToNext()) { 
                         String phoneNumber = phones.getString(phones.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
                         Log.i("Number", phoneNumber);
                        } 
                phones.close(); 
            }

        }
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-02-27T10:58:00.253

你需要像这样的许可 -

```
 android:name="android.permission.READ_CONTACTS"/> 
```

然后，调用联系人选择器

```
 Intent intent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI); 
```

然后，

```
@Override
public void onActivityResult(int reqCode, int resultCode, Intent data) {
super.onActivityResult(reqCode, resultCode, data);

switch (reqCode) {
case (PICK_CONTACT) :
   if (resultCode == Activity.RESULT_OK) {
   Uri contactData = data.getData();
   Cursor c =  managedQuery(contactData, null, null, null, null);
    if (c.moveToFirst()) {
     String name = c.getString(c.getColumnIndexOrThrow(People.NAME));
     // TODO Whatever you want to do with the selected contact name.
   }
 }
 break;
 }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-01-15T11:46:13.753

老问题，但我在这里看不到以下答案。

```
private static final String[] PROJECTION ={
        ContactsContract.Contacts._ID,
        ContactsContract.CommonDataKinds.Phone.NUMBER,
        ContactsContract.Contacts.DISPLAY_NAME_PRIMARY,
        ContactsContract.Contacts.PHOTO_THUMBNAIL_URI,
        ContactsContract.Contacts.LOOKUP_KEY,
};

new CursorLoader(
        this,
        ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
        PROJECTION,
        null,
        null,//mSelectionArgs,
        ContactsContract.Contacts.DISPLAY_NAME_PRIMARY
); 
```

使用列索引 ContactsContract.CommonDataKinds.Phone.NUMBER 从光标中检索电话号码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-17T22:34:13.077

> 你可以使用联系人选择器。
> 
> 在任何按钮上调用联系人选择器并使用以下代码：

|*| 添加：AndroidManifest.xml

```
<uses-permission android:name="android.permission.READ_CONTACTS"/> 
```

|*| 添加：activity_name.java

```
void calContctPickerFnc()
{
    Intent calContctPickerIntent = new Intent(Intent.ACTION_PICK, ContactsContract.Contacts.CONTENT_URI);
    calContctPickerIntent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
    startActivityForResult(calContctPickerIntent, 1);
}

@Override
public void onActivityResult(int reqCode, int resultCode, Intent data)
{
    super.onActivityResult(reqCode, resultCode, data);

    switch (reqCode)
    {
        case (1) :
            if (resultCode == Activity.RESULT_OK)
            {
                Uri contctDataVar = data.getData();

                Cursor contctCursorVar = getContentResolver().query(contctDataVar, null,
                        null, null, null);
                if (contctCursorVar.getCount() > 0)
                {
                    while (contctCursorVar.moveToNext())
                    {
                        String ContctUidVar = contctCursorVar.getString(contctCursorVar.getColumnIndex(ContactsContract.Contacts._ID));

                        String ContctNamVar = contctCursorVar.getString(contctCursorVar.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));

                        Log.i("Names", ContctNamVar);

                        if (Integer.parseInt(contctCursorVar.getString(contctCursorVar.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER))) > 0)
                        {
                            // Query phone here. Covered next
                            String ContctMobVar = contctCursorVar.getString(contctCursorVar.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
                            Log.i("Number", ContctMobVar);
                        }

                    }
                }
            }
            break;
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-01-29T10:34:59.493

您可以在 Activity 类中添加此代码：

```
 private final int PICK_CONTACT = 5;

    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.your_layout);

    Intent intent = new Intent(Intent.ACTION_PICK,
                    ContactsContract.Contacts.CONTENT_URI);
            intent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
            startActivityForResult(intent, PICK_CONTACT);

    //Your code
   }

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {

    if (requestCode == PICK_CONTACT && resultCode == RESULT_OK) {
        Uri contactData = data.getData();

        Cursor phones = getContentResolver()
                .query(contactData,
                        null,
                        null,
                        null,
                        null);

        String name = "", phoneNumber = "";

        while (phones.moveToNext()) {
            name = phones.getString(phones.getColumnIndex(
                    ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));
            phoneNumber = phones.getString(phones.getColumnIndex(
                    ContactsContract.CommonDataKinds.Phone.NUMBER));

        }
        phones.close();
    }
  } 
```

# javascript - 更改 Firefox 输入文件标签中的光标样式

> ID：11218846
> 
> 赞同：0
> 
> 时间：2012-06-27T03:05:53.947
> 
> 标签：javascript, firefox, cursor, twitter-bootstrap

我一直在尝试将光标样式更改为看起来像指针而不是 I 光束，但看起来 FF 不尊重输入文件字段中的光标规范。例如，我做了这个小小提琴： http: [//jsfiddle.net/jDZtn/4/](http://jsfiddle.net/jDZtn/4/)当用户将鼠标悬停在光标上时，我希望光标看起来像一个指针而不是 Ibeam。我的最终计划是引入 opacity==0 并在其上使用可点击按钮。

我不确定这种行为是否是错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:12:58.890

更好的解决方案是 display:none 文件输入，并让你的按钮 .click() 它。

编辑：经过一些测试，我注意到 safari 不会让我 .click() 文件输入，因为它被设置为 display:none，所以我创建了这个似乎在所有浏览器中都可以使用的[小提琴。](http://jsfiddle.net/Jvafd/2/)我只是通过定位/可见性而不是 display:none 隐藏文件输入。

参考：[https ://developer.mozilla.org/en/Using_files_from_web_applications#Using_hidden_​​file_input_elements_using_the_click()_method](https://developer.mozilla.org/en/Using_files_from_web_applications#Using_hidden_file_input_elements_using_the_click()_method)

# mysql - 为其他人替换数据库中字符串中的所有字符？

> ID：11218849
> 
> 赞同：0
> 
> 时间：2012-06-27T03:06:48.673
> 
> 标签：mysql

我想将表`Cities`和列中的所有“á”替换`Domain`为“a”。

例如：

```
ID   Domain
1    árbol
2    megá 
```

结果：

```
ID   Domain
1    arbol
2    mega 
```

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:10:33.040

```
UPDATE Cities
   SET Domain = REPLACE(Domain,'á','a'); 
```

# scala - 有条件地增强 ScalaQuery 查询

> ID：11218850
> 
> 赞同：1
> 
> 时间：2012-06-27T03:06:53.243
> 
> 标签：scala, scalaquery

我有一个查询，我有条件地根据计数和偏移参数的存在与否进行增强。

```
val retrieveCustomer: (Option[String], Option[Int], Option[Int]) => List[Customer] = { ( customerId : Option[String], count : Option[Int], offset : Option[Int] ) =>
    val initialQ: Query[CustomerTable.type, Customer] = customerId.map( c => CustomerTable.where(_.id === c) ).getOrElse( CustomerTable.map { c => c } )
    val qPlusOffset = offset.map ( offset => initialQ.drop(offset) ).getOrElse(initialQ)
    val qoPlusLimit = count.map( count => qPlusOffset.take(count) ).getOrElse(qPlusOffset)

    DBGlobal.db.withTransaction { qoPlusLimit.list } 
```

}

与这种方法相比，我很好奇是否有更简洁的方法来编写此方法。

请说。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T11:34:02.837

写这个有什么意义？

```
val retrieveCustomer: (Option[String], Option[Int], Option[Int]) => List[Customer] = { ( customerId : Option[String], count : Option[Int], offset : Option[Int] ) 
```

当你可以写这样的东西时：

```
def getCustomer(id: String, count: Option[Int], offset: Option[Int]): List[Customer] 
```

这显然更简洁，尽管可能与您所追求的简洁无关。我倾向于在 for{...} 块中的每个操作上使用 Either Right 投影，“失败”Left 结果执行基本或非完全优化的查询，成功的 Right 结果执行完全 drop + take 改进.

```
def getCustomer(id: String, count: Option[Int], offset: Option[Int]): List[Customer] = { 
    val base = Customers.createFinder(_.id)
    val q = for{
      cust    <- base(id) toRight( List[Customer]() )
      dropped <- cust.drop(offset) toRight(cust)
      taken   <- dropped.take(count) toRight(dropped)
    } yield taken
    DBGlobal.db.withTransaction { q.list map { _.fold(_,_) } }
} 
```

这不太可能编译;-)，但一般原则是遍历左/右查询结果，它们都返回客户列表。

注意：我倾向于以 case class 的复数形式命名映射器伴生对象，因此在这种情况下，我使用了 Customer，而不是 CustomerTable。此外，`Customers.createFinder(_.id)`脱糖：

```
for{
  id <- Parameters[String]
  c  <- Customers if c.id is id
} yield c 
```

它懒惰地为底层 DBMS 生成一个有效的准备好的语句。

当然，您所拥有的作品对于一次性案例来说看起来不错。就个人而言，我正在挖掘{} + 任何一个正确的预测，都可以吃掉你的蛋糕 - 即同时获得失败点的左结果和成功的右结果，而不是通过选项 for{...} ，它只产生一个成功的事件，根本不提供关于哪个步骤实际出错的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T15:48:05.517

这是一个班轮。

```
val qFinal = initialQ.drop(offset.getOrElse(0)).take(count.getOrElse(Int.MaxValue)) 
```

# sql-server-2008 - 对表上的所有 Select 语句隐式应用函数 - SQL Server

> ID：11218851
> 
> 赞同：1
> 
> 时间：2012-06-27T03:07:05.400
> 
> 标签：sql-server-2008, sql-server-2008-r2

是否可以自动将某些功能（用户定义/系统）应用于选定的列，可能会在模式级别绑定它。

我的场景是我在每个表中自动保存记录保存的时间戳，我已将其用作`getdate()` 这些列的默认值，在我们拥有自己的主机之前它工作正常。但是由于现在我们正在转向共享主机并且不知道服务器将来应该放置在哪个时区，所以我正在使用`GETUTCDATE()`获取 GMT 时间。

由于已经有很多程序/功能，我正在寻找不需要将这个 UTC 时间显式转换为我的本地时间的东西。

这样我`Select * from MyTable`就可以使用我创建的功能在我的固定时区给我时间。

让我知道它是否可能以任何方式。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T16:02:02.460

不清楚你想做什么，但没有办法用其他东西代替`SELECT`语句要求的东西：你在查询中要求的就是你得到的。除非您用同名视图替换表，但这可能不是最好的方法。

使用视图或函数仍然意味着无论如何您都必须更改代码，那么为什么不`UPDATE`将所有数据都转换为 UTC 时间，然后在应用程序代码中进行转换呢？SQL Server 不知道客户端所在的时区，因此不可能在服务器端可靠地进行转换。除非客户端将本地时区作为参数或 in 发送到服务器，否则[`CONTEXT_INFO`](http://msdn.microsoft.com/en-us/library/ms187768%28v=sql.105%29.aspx)没有多大意义，因为无论如何在客户端中执行此操作会更简单。

当然，在应用程序中处理这一切将为您提供更灵活、更强大的解决方案。

# c# - 如何在 ASP.NET MVC 模型中添加 IList<>？

> ID：11218852
> 
> 赞同：0
> 
> 时间：2012-06-27T03:07:22.513
> 
> 标签：c#, asp.net, asp.net-mvc, model

我正在尝试创建一个问答页面。我正在通过文本框添加一个问题，并希望添加 4 个文本框来获得答案选项。我正在使用这个模型。

```
public class Question
    {
        public virtual int ID { get; set; }
        public virtual QPad QPad { get; set; }
        [Display(Name = "Add Question")]
        public virtual string QuestionText { get; set; }        
        [Display(Name = "Add Options")]
        public virtual IList<string> AnswerOption { get; set; }
    } 
```

但现在在 QuestionController 的创建操作视图中

我的控制器是：

```
[HttpPost]
        public ActionResult Index(int qId, Question ques )
        {
            if (ModelState.IsValid)
            {
                var QPads = _db.QPads.Single(r => r.ID == qId);
                QPads.Questions.Add(ques);
                _db.SaveChanges();
                return RedirectToAction("Index", "QPad");
            }
            else
            {
                return View(ques);
            }
        } 
```

我想为问题文本和选项添加编辑器，我使用

```
<div class="editor-label">
            @Html.LabelFor(model => model.QuestionText)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.QuestionText)
            @Html.ValidationMessageFor(model => model.QuestionText)
        </div>
/// ?????What for  4 Options boxes///////? 
```

我无法添加选项框。我是在模型中使用正确的方法还是应该改变一些东西？

或者我可以自定义该用户自己选择他想要添加多少选项？

请建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:26:13.133

如果始终允许使用添加四个选项，那么我可以尝试这样的事情。

```
<div class="editor-label">
  @Html.LabelFor(model => model.QuestionText)
</div>
<div class="editor-field">
  @Html.EditorFor(model => model.QuestionText)
   @Html.ValidationMessageFor(model => model.QuestionText)
</div>
@for(int i = 0; i < 4; i++)
{
  <div class="editor-field">
     @Html.EditorFor(model => model.AnswerOption[i])
     @Html.ValidationMessageFor(model => model.AnswerOption[i])
  </div>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T04:29:48.700

当您说“选项框”时，我假设您的意思是单选按钮。如果是这样，那么您可以使用 RadioButton Html 帮助程序，就像这样。

```
<div class="editor-field">
    @foreach(var myValue in Model.AnswerOptions) {
        @Html.RadioButton("NAME_OF_LIST_FOR_ANSWERS", myValue)
    }
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T06:53:44.470

您可能会考虑将 AnswerOption 实体添加到您的数据模型中，这样您就可以定义每个问题有多少个选项。

然后你可以做类似的事情

```
foreach(var option in model.options){
 @Html.EditorFor(option);
 @Html.ValidationMessageFor(option);
} 
```

# xml - xml解密问题

> ID：11218853
> 
> 赞同：1
> 
> 时间：2012-06-27T03:07:32.057
> 
> 标签：xml, security

我有一个包含需要解密的加密元素的 xml 文档。从下面的 xml 和我读到的关于 xmlenc 的内容，这个元素是使用 AES256-CBC 加密的，发送者生成的对称密钥（加密数据在第二个 CipherValue 元素中）。然后，发送者使用 RSA 加密了 AES 密钥。发件人应使用我的公钥来执行此 RSA 加密。加密的密钥放在下面 xml 中的第一个 CipherValue 中。

因此，要解密数据，我必须执行以下操作： 1\. Base64 解码然后使用我的 RSA 私钥解密 AES 密钥，该密钥对应于发送者使用的我的公共 RSA 密钥。2\. Based64 解码，然后使用步骤 1 中解密的 AES 密钥对第二个 CipherValue 元素中的加密数据进行解密。

这个对吗？

现在，这是我的问题……我没有给发件人我的公钥。相反，发件人给了我一个包含他们的公钥的证书，他们声称我可以使用它们进行解密 - 我猜这暗示他们用他们的私钥加密，所以我可以用他们的公钥解密。从我读过的所有内容来看，这不是它的工作方式。相反，他们应该用我的公钥加密，这样我就可以用我的私钥解密数据。

谁是正确的？可以用私钥加密然后用公钥解密吗？

对于它的价值，我尝试使用 JCE 执行此操作，但是当我尝试使用他们的公钥解密 AES 密钥（第一个 base64 解码）时，我得到了一个 BadPadding 异常。

这是 XML 元素减去一些细节......

```
<xenc:EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element" xmlns:xenc="http://www.w3.org/2001/04/xmlenc#">
  <xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes256-cbc"/>
  <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
    <e:EncryptedKey xmlns:e="http://www.w3.org/2001/04/xmlenc#">
      <e:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p">
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
      </e:EncryptionMethod>

      <KeyInfo>
        <X509Data>
          <X509IssuerSerial>
            <X509IssuerName> // issuer name removed </X509IssuerName>
            <X509SerialNumber>11411601377033481249</X509SerialNumber>
          </X509IssuerSerial>
        </X509Data>
      </KeyInfo>

      <e:CipherData>
        <e:CipherValue>
          LLq+NfgwVF/qbMzTPtVnGfaaBxIFc5fmNeAk2dBHaPqb+Hti9Nre7dK+3MOyzucNSYwF76Be0zKZnIeAsQQoKgiU34/BZURq9uFHt8uUYA4dPtcYOIg6F5KR3r7KXBilT/QXYP3UicIcsY2NCA6g0Mp4PrF8b2Yi80Gn2oyZd30=
        </e:CipherValue>
      </e:CipherData>
    </e:EncryptedKey>
  </KeyInfo>

  <xenc:CipherData>
    <xenc:CipherValue>
      // encrypted data removed
    </xenc:CipherValue>
  </xenc:CipherData>
</xenc:EncryptedData> 
```

谢谢，特洛伊

# javascript - Firefox 扩展中的 javascript 字符串（没有 eval()、setTimeout 或 new 函数）

> ID：11218854
> 
> 赞同：1
> 
> 时间：2012-06-27T03:07:41.203
> 
> 标签：javascript, firefox-addon

根据用户打开的页面，我正在传递字符串，例如远程服务器`"getElementById('div1')"`或来自远程服务器。`"getElementsByName('div2')"`如何在不使用上述任何功能的情况下在页面中将这些作为 javascript 运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:16:01.180

```
var head = document.getElementsByTagName('head')[0],
    script = document.createElement('script');
script.innerHTML = 'alert("hello");';
head.appendChild(script); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:14:53.300

您也许可以使用 document.write。我不知道您是否可以将其用于 javascript，但我建议服务器应将代码和元素名称传递给客户端，然后基于此执行某种方法。

# lua - 使用 update_with_media - Lua 将图像上传到 Twitter

> ID：11218855
> 
> 赞同：1
> 
> 时间：2012-06-27T03:07:41.637
> 
> 标签：lua, twitter, twitter-oauth

我正在尝试使用 update_with_media.json 将图像发布到 Twitter。

以下是使用 statuses/update.json 更新推文的工作代码

```
local url = "http://api.twitter.com/1/statuses/update.json"
local consumer_key = ""
local consumer_secret = ""
local token = ""
local token_secret = ""

local post_data = 
    {
    oauth_consumer_key = consumer_key,
    oauth_nonce        = get_nonce(),
    oauth_signature_method = "HMAC-SHA1",
    oauth_token        = token,
    oauth_timestamp    = get_timestamp(),
    oauth_version      = '1.0',
    oauth_token_secret = token_secret

    }

post_data["status"] = "Hello Twitter!"      
post_data = oAuthSign(url, "POST", post_data, consumer_secret)

r,c,h = http.request
   {
   url = url,
   method = "POST",
   headers = 
         {
         ["Content-Type"] = "application/x-www-form-urlencoded", 
         ["Content-Length"] = string.len(rawdata)
         },
   source = ltn12.source.string(post_data),
   sink = ltn12.sink.table(response)
   } 
```

现在如何修改上面的代码来上传图片？url 为“http://api.twitter.com/1/statuses/update_with_media.json”，headers[“Content-Type”] 为“multipart/form-data”

但是我在哪里以及如何指定要上传的图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T11:18:33.447

Ok I got this working some time back.. This post [by velluminteractive](http://velluminteractive.com/upload-images-to-twitter-from-corona-sdk/) provides a good library to deal with twitter.

Admittedly the code is for a game engine called Corona SDK. But it shouldn't be too hard for others to use by removing Corona-specific elements from it.

# map - 根据自定义数据在地图上创建路线

> ID：11218863
> 
> 赞同：1
> 
> 时间：2012-06-27T03:08:57.677
> 
> 标签：map, overlay, routes, directions

所以我想做的是以下几点：

1.  拥有地图（例如 Google Maps 或 questMaps）。我需要使用哪个 API 并不重要。
2.  在那张地图上，街道上有一个叠加层。所以说（例如）街道晚上有不好的闪电，它会被涂成红色。如果它有良好的闪电，它将有一个绿色的覆盖层。
3.  基于叠加，地图创建了一条自定义路线（例如，用户只想在绿色/光线充足的街道上行走）。

我不知道如何做到这一点（尤其是第 3 步）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:26:54.367

首先，您必须决定需要哪些数据。您如何将某些街道分类为有灯或无灯？如果街道的某些部分光线充足而有些地方没有灯怎么办？您需要知道您所在地区每个路灯的位置吗？如果灯烧坏了怎么办？

在弄清楚你需要什么数据之后，你需要构建你的数据集。如果这些数据已经存在，我会感到非常惊讶，因此您可能需要自己收集。要么去城里做笔记，要么众包项目，要么想出其他方法。

收集数据后，学习您希望使用的任何映射工具的绘图 API。它们都应该在其 API 中具有用于在现有地图上绘制彩色线（用于街道）或点（用于路灯）的功能。

最后，学习您选择的地图工具的导航 API。你是对的，这是一个艰难的步骤。我知道谷歌地图允许您在请求路线时指定某些航点；也许您的应用程序可以计算出光线充足的航路点并将它们提供给 Google 地图的路线服务，以影响它生成的路线。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T08:03:33.710

对于自定义路由，您需要阅读“图论”。这忽略了街道地图的地理，并将其视为由边连接的一组连接点（图论术语中的节点或顶点）。您可以为边缘分配权重 - 这些可以是长度、行程时间、1 和 0 等。任何东西。它们可以与地图上的位置无关。

因此，对于您的应用程序，您需要为未照明的街道分配较大的权重，为已照明的街道分配较小的权重，然后使用标准的最小权重算法来获取从一个节点到另一个节点的路线。

# node.js - node.js 与 Azure Storage TableQuery where colName like

> ID：11218865
> 
> 赞同：0
> 
> 时间：2012-06-27T03:09:06.117
> 
> 标签：node.js, azure-sql-reporting

我将 node.js 与 Azure sql 一起使用。我正在尝试做一个简单的搜索。我不断收到“InvalidInput”：“其中一个请求输入无效。”。

```
function getItems(callback){
   var query = azure.TableQuery
     .select()
     .from('Employee')
     .where(['Email like ?', 'test%']);

  tableService.queryEntities(query, function(error, items){
    if(error == null){
       callback(items);
    }
  });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T20:22:35.560

尝试对百分比符号进行 url 编码；用“test%25”替换“test%”

# javascript - 统一渲染 Highcharts.js 图表，而不是从左到右

> ID：11218866
> 
> 赞同：1
> 
> 时间：2012-06-27T03:09:12.353
> 
> 标签：javascript, svg, highcharts

我想知道您是否可以更改 highcharts.js 图表的呈现方式。我不想通过[这个jsfiddle从左到右](http://jsfiddle.net/KFKQt/)渲染图表，我想在页面加载时均匀地渲染图表。

意思是，我希望整个图表立即出现，而不是左->右“绘制”。

这可能是我找不到的[众多选项之一。](http://www.highcharts.com/ref/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T03:18:07.863

您可以设置以下内容：

```
 plotOptions: {
      series: {
           animation: false
      }
  } 
```

[**演示**](http://jsfiddle.net/KFKQt/1/)

# c# - 错误 - 具有多个数据库连接的 LINQ/TransactionScope

> ID：11218867
> 
> 赞同：4
> 
> 时间：2012-06-27T03:09:22.033
> 
> 标签：c#, sql-server, winforms, linq-to-sql

我在同一个 SQL Server 上将几个事务包装到 2 个不同的数据库中度过了愉快的时光。我最初在访问网络 DTC 时遇到问题，我解决了这个问题。现在，我继续得到的错误是“与底层事务管理器的通信失败”。

我们在数据库中有一些客户资料，当这些资料过时时，我们希望将它们移动到“存档”数据库进行存储。移动只是（幽默的斜体）将它们添加到存档数据库并从主/实时数据库中删除它们。我为每个数据库都有一个 DataContext。下面的代码在尝试使用第二个 DataContext 时执行 Add，然后在 Delete 上出现错误。我只使用 LINQ 几个月，过去几天我一直在搜索文章。我想知道我的代码是否有问题，或者 DTC 是否仍然存在未正确配置的内容？

我们在 VMware 上运行我的工作站和服务器。- 工作站是 Windows 7 SP1 - 服务器是 Windows 和 SQL Server 2008R2

“移动”的常规：

```
private int MoveProfileToArchiveDB( int iProfileId )
{
    int rc = RC.UnknownError;

    // get new Archive profile object
    ProfileArchive.ProfileInfo piArchive = new ProfileArchive.ProfileInfo();

    // 'Live' DataContext
    using ( ProfileDataContext dbLive = new ProfileDataContext() )
    {
        // get Live profile
        ProfileInfo piLive = ProfileInfo.GetProfile( dbLive, iProfileId );

        // copy Live data to Archive profile object... including the id
        ProfileArchive.ProfileInfo.CopyFromLive( piLive, piArchive, true );
    }

    bool bArchiveProfileExists = ProfileArchive.ProfileInfo.ProfileExists( piArchive.id );

    // make the move a transaction... 
    using ( TransactionScope ts = new TransactionScope() )
    {
        // Add/Update to Archive db
        using ( ProfileArchiveDataContext dbArchive = new ProfileArchiveDataContext() )
        {
            // if this profile already exists in the Archive db...
            if ( bArchiveProfileExists )
            {
                // update the personal profile in Archive db
                rc = ProfileArchive.ProfileInfo.UpdateProfile( dbArchive, piArchive );
            }
            else
            {
                // add this personal profile to the archive db
                int iArchiveId = 0;
                piArchive.ArchiveDate = DateTime.Now;
                rc = ProfileArchive.ProfileInfo.AddProfile( dbArchive, piArchive, ref iArchiveId );
            }

            // if Add/Update was successful...
            if ( rc == RC.Success )
            {
                // Delete from the Live db
                using ( ProfileDataContext dbLive = new ProfileDataContext() )
                {
                    // delete the personal profile from the Profile DB
                    rc = ProfileInfo.DeleteProfileExecCmd( dbLive, iProfileId );    // *** ERROR HERE ***
                    if ( rc == RC.Success )
                    {
                        // Transaction End (completed)
                        ts.Complete();
                    }
                }
            }
        }

    }

    return rc;
} 
```

笔记：

1.  我有几种不同的删除方法，它们都在 TransactionScope 之外工作。
2.  ProfileInfo 是主要的配置文件表，对于 Live 和 Archive 数据库大致相同。

任何帮助是极大的赞赏！非常感谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T20:22:54.223

我没有继续交叉评论，而是决定将其发布为答案。

*   不要使用错误代码。这就是例外的原因。代码流更难阅读，错误代码返回邀请被忽略。异常使代码更容易阅读并且更不容易出错。

*   如果您使用 TransactionScope，请记住始终明确设置隔离级别。请参阅[使用新的 TransactionScope() 被认为是有害](https://docs.microsoft.com/en-us/archive/blogs/dbrowne/using-new-transactionscope-considered-harmful)的。SERIALIZABLE 的隐式隔离级别几乎从未被要求，并且具有巨大的负面规模影响。

*   交易升级。每当在事务范围内打开多个连接时，它们都可以将事务升级为分布式事务。行为因版本而异，有些人试图记录它，例如。[TransactionScope：事务升级行为](http://pieterderycke.wordpress.com/2012/01/22/transactionscope-transaction-escalation-behavior/)：

> SQL Server 2008 比 SQL Server 2005 智能得多，可以自动检测某个事务中的所有数据库连接是否都指向同一个物理数据库。如果是这种情况，事务仍然是本地事务，并且不会升级为分布式事务。不幸的是，有一些警告：
> 
> *   如果打开的数据库连接是嵌套的，事务仍会升级为分布式事务。
> *   如果在事务中与另一个持久资源建立了连接，则事务会立即升级为分布式事务。

由于您的连接（来自使用的两个数据上下文）指向不同的数据库，因此即使在 SQL Server 2008 上，您的 TransactionScope 也会升级为分布式事务。

将您的应用程序加入 DTC 至少在两个方面是有害的：

*   吞吐量将通过地板下沉。一个数据库每秒可以支持几千个本地事务，但每秒只能支持几十个（可能低到几百个）分布式事务。这主要是因为[两阶段提交](http://en.wikipedia.org/wiki/Two-phase_commit_protocol)的复杂性。
*   DTC 需要协调员：MSDTC。[对 MSDTC 进行的安全性增强] 使配置更具挑战性，开发人员发现他们的应用程序中需要 MSDTC 肯定是出乎意料的。**链接的文章中描述的步骤可能是您现在所缺少的**。对于 Windows Vista/Windows 7/Windows Server 2008/Windows Server 2008R2 [，Windows Vista 和 Windows Server 2008 中的 MSDTC](http://blogs.msdn.com/b/chrisforster/archive/2008/02/19/msdtc-in-windows-vista-and-windows-server-2008.aspx)、[如何在 Windows 2008 上配置 DTC](http://itknowledgeexchange.techtarget.com/sql-server/how-to-configure-dtc-on-windows-2008/)和其他类似文章中描述了这些步骤。

现在，如果您按照上述文章修复 MSDTC 通信，您的代码应该可以正常工作，但我仍然认为在运行 EF 的客户端代码中不应发生此*归档*。有更好的工具，[SSIS](http://msdn.microsoft.com/en-us/library/ms141026.aspx)就是一个很好的例子。运行 SSIS 的夜间计划作业将更有效地传输那些未使用的配置文件。

# delphi - 定时器进程影响delphi中的用户界面

> ID：11218868
> 
> 赞同：2
> 
> 时间：2012-06-27T03:09:49.873
> 
> 标签：delphi, timer, background, delphi-7

我开发了从读卡器读取信息的应用程序。在这里，我使用计时器每五秒获取一次信息，因此每五秒用户界面就会变慢，因为它从阅读器获取信息。如何在不影响用户界面的情况下在后台运行计时器

```
unit frmVistorreg;

interface

uses
 Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms;

type
 thread1=class(TThread)
 private
 FEvent: THandle;
 protected
 procedure Execute; override;
 public
 procedure MyTerminate;
end;

TForm3 = class(TForm)     
txt_name: TEdit;   
txt_cardno.Text  TEdit;        

private

public

end;

var
Form3: TForm3;

implementation

{$R *.dfm}

procedure thread1.Execute;
var
idcard_info :array[0..1024*5] of byte;
flag :Integer;
portflag :Integer;
st :TStrings;
str :string;  
begin

FEvent:= CreateEvent(nil, False, false, nil);
try
while not Terminated do begin
if  MainForm.PortFlag=0 then
begin

 Form3.Label11.Caption:='port has been successfully opened';
 Form3.Label11.Font.Color :=32768;
 flag := GetIdCardInfo(@idcard_info[0],1024*5,5);
 str := byteArray2Str(@idcard_info[0],1024*5);

        if(flag=0) then
        begin
           st := TStringList.Create;
           try
              SplitStr('^_^',str,st);
              Form3.txt_name.Text := st.Strings[0]; 
              Form3.txt_cardno.Text := st.Strings[5]; 
          finally
        st.Free;
          end;
        end;

end
else
begin 

Form3.Label11.Caption:='Please open the port';
Form3.Label11.Font.Color:=clRed;
end;

if WaitForSingleObject(FEvent, 500) <> WAIT_TIMEOUT // 5 seconds timeout
then Terminate;
end;

finally
CloseHandle(FEvent);
end;
end;

procedure thread1.MyTerminate;
begin
 SetEvent(FEvent);
end;

procedure TForm3.FormClose(Sender: TObject; var Action: TCloseAction);
var
Objthread1:thread1;
begin   
Objthread1.MyTerminate;
Action := caFree;
end;

procedure TForm3.FormCreate(Sender: TObject);
var
Objthread1:thread1;
begin
Objthread1:=thread1.Create(false);  
end;

end. 
```

当我关闭表单时出现错误

```
Project MDIAPP.exe raised exception class EAccessViolation with message 'Access violation at address 0051B9F1 in module 'MDIAPP.exe'. Read of address 00000198'. 
```

我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T06:21:36.623

你不需要一个计时器组件，你需要一个后台线程。`Sleep`一个最简单的解决方案是在线程中使用函数：

```
unit Unit2;

interface

uses
  Classes;

type
  TMyThread = class(TThread)
  protected
    procedure Execute; override;
  end;

implementation

procedure TMyThread.Execute;
begin
  while not Terminated do begin
// do your processing here
    Sleep(5000);   // wait 5 seconds
  end;
end;

end. 
```

更好的方法是使用`WaitForSingleObject`一个事件而不是`Sleep`能够立即终止您的后台线程而无需 5 秒延迟：

```
unit Unit2;

interface

uses
  Windows, Classes;

type
  TMyThread = class(TThread)
  private
    FEvent: THandle;
  protected
    procedure Execute; override;
  public
    procedure MyTerminate;
  end;

implementation

procedure TMyThread.Execute;
begin
  FEvent:= CreateEvent(nil, False, False, nil);
  try
    while not Terminated do begin
// do your processing here
// ..
      if WaitForSingleObject(FEvent, 5000) <> WAIT_TIMEOUT // 5 seconds timeout
        then Terminate;
    end;
  finally
    CloseHandle(FEvent);
  end;
end;

procedure TMyThread.MyTerminate;
begin
  SetEvent(FEvent);
end;

end. 
```

在从表单的事件处理程序`TMyThread`关闭表单调用`MyTerminate`方法时终止实例。`OnClose`

是的，知道您收到什么错误消息很有趣，而不仅仅是“显示错误”。

# google-app-engine - Passport.js 等效于 Python？

> ID：11218869
> 
> 赞同：12
> 
> 时间：2012-06-27T03:09:57.737
> 
> 标签：google-app-engine, node.js, authentication, login

是否有一个库可以让我快速将登录选项添加到我的 Python (Google AppEngine) 应用程序中，类似于 Passport.js？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-07-25T10:04:58.583

我认为 Python 的 Passport.js 等效项是[Authlib](https://github.com/lepture/authlib/)。

Authlib 还附带了 Django 和 Flask 的集成。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-26T22:22:38.157

试试：EngineAuth [https://github.com/scotch/engineauth](https://github.com/scotch/engineauth)

或 SimpleAuth [https://github.com/crhym3/simpleauth](https://github.com/crhym3/simpleauth)

或 AppEngine oAuthLibrary [https://github.com/mikeknapp/AppEngine-OAuth-Library](https://github.com/mikeknapp/AppEngine-OAuth-Library)

# c# - 使用多个数据库表的 ASP.NET MVC 模型

> ID：11218871
> 
> 赞同：4
> 
> 时间：2012-06-27T03:10:15.100
> 
> 标签：c#, asp.net-mvc, model

我是使用 MVC 的新手，我正在尝试制作一个使用其他模型的模型。

假设我的数据库中有 2 个表，为了这个问题，我将它们称为 Table1 和 Table2。在我的 MVC 项目中，这些对应于 Model1 和 Model2。现在我想要 Model 3，就像：

```
public class Model3
{
    public Model1 model1 { get; set; }
    public Model2 model2 { get; set; }
    public string someString { get; set; }
} 
```

我想使用如下所示的 T-SQL 查询来创建它：

```
SELECT * FROM Table1 t1
LEFT JOIN Table2 t2
    ON t1.fk = t2.pk 
```

现在，为了运行这个查询，我使用了[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-中描述的技术一个-mvc-web-应用程序](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/advanced-entity-framework-scenarios-for-an-mvc-web-application)

相关代码为：

```
public virtual IEnumerable<TEntity> GetWithRawSql(string query, params object[] parameters)
{
    return dbSet.SqlQuery(query, parameters).ToList();
} 
```

我在其中输入上述查询。

问题（终于！）是实体框架需要一个密钥。这不会有问题，但在这种情况下，key 是 Table1.table1KeyPart 和 Table2.table2KeyPart，对应于 Model1.model1Keypart 和 Model2.model2keypart。

所以我在这里尝试使用第二种技术： [首先在实体框架代码中，如何在多个列上使用 KeyAttribute](https://stackoverflow.com/questions/4950245/in-entity-framework-code-first-how-to-use-keyattribute-on-multiple-columns)

也就是使用 HasKey 的那个，用`u.Model1.model1KeyPart`,`u.Model2.model2KeyPart`代替 userID 和 userName。像这样：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<Model3>().HasKey(u => new
        {
            u.Model1.model1KeyPart,
            u.Model2.model2keyPart
        });
    } 
```

我得到错误：

> 属性表达式 '[u => new <>f__AnonymousType1`2(model1KeyPart = u.Model1.model1KeyPart, model2KeyPart = u.Model2.model2KeyPart)]' 无效。该表达式应表示一个属性：C#: 't => t.MyProperty' VB.Net: 'Function(t) t.MyProperty'。指定多个属性时使用匿名类型：C#: 't => new { t.MyProperty1, t.MyProperty2 }' VB.Net: 'Function(t) New From { t.MyProperty1, t.MyProperty2 }'。

这是可以修复的吗？还是我这样做完全错误？我想我可以在 Model3 中列出 Model1 和 Model2 的所有成员，但这会引入我真的不想要的冗余，但如果这是唯一的方法，那么我会这样做。

抱歉，如果有任何不清楚的地方，如果需要，我会尽力解决问题。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T04:20:56.553

我认为您需要定义复合键，如果您首先使用实体​​框架代码，您可以在这样`dbContext.cs`的`OnModelCreating`方法中执行此操作

```
modelBuilder.Entity<Model3>().HasKey(s => new { s.Model1Key, s.Model2Key }); 
```

# image - Mediawiki 无法显示图像或样式

> ID：11218873
> 
> 赞同：2
> 
> 时间：2012-06-27T03:10:34.757
> 
> 标签：image, apache, permissions, mediawiki

我正在使用 MediaWiki v1.19.1。

当我在本地使用它时，我的 wiki 运行良好。但是当我通过网络（从另一台计算机或不同的 IP）访问它时，它只显示文本。没有图像。

它看起来像一个经典的皮肤，但它不是。原因是我的 wiki 上没有布局（其他公共 wiki 页面显示正常）。

我的 wiki 现在使用 monobook 皮肤，但我只能看到页面上的文本。

我已将权限更改为 777，包括所有目录 ( `/var/www/kj/*`)，但仍然没有图像。

请帮帮我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T11:01:05.690

没有足够的信息给出明确的答案，但针对这种情况的一般建议是：

*   如果您使用任何 Apache 重写规则（例如，[使 URL 更漂亮](https://www.mediawiki.org/wiki/Manual:Short_URL)），请尝试禁用它们。
*   *   特别是如果您使用`http://example.com/Page_title`样式 URL，您应该知道它们不受开发人员的支持，并且需要认真的 MediaWiki/Apache 技能（即使那样它们也可能会引入细微的错误）。
*   安装[Firebug](http://getfirebug.com/)并检查图像的 HTTP 错误是什么：是因为访问被拒绝 (HTTP 403) 还是网络服务器根本看不到它们 (HTTP 404) - 这应该让您知道发生了什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-14T15:16:44.010

前段时间我遇到了同样的问题，以下对我来说很好。该问题可能与**LocalSettings.php**文件和常规设置**$wgServer 相关**。

以下链接可以为您提供更多详细信息：[$wgServer 手册](http://www.mediawiki.org/wiki/Manual%3a%24wgServer)

从 1.18 开始，MediaWiki 还支持将**$wgServer**设置为相对协议的 URL。

例如，*//www.mediawiki.org*

这用于通过使用在两种协议下工作的链接来支持具有相同缓存的 HTTP 和 HTTPS。

因此，请尝试删除**localhost**并提供您的 URL；例如；**$wgServer = "//mywebsite.com";**

# android - 在android清单中指定可挂载为可移动磁盘的SD卡

> ID：11218877
> 
> 赞同：0
> 
> 时间：2012-06-27T03:11:24.490
> 
> 标签：android

我的 android 应用程序要求设备具有 SD 卡，并且 SD 卡可以作为文件系统（可移动磁盘）安装在 PC 或 MAC 上。这是因为有一个 Windows 程序，我的移动应用程序将其写入 sd 卡，用户必须从他的 PC 上运行该程序，并且该程序适用于从 Windows 安装的 SD 卡上的文件和 PC 上的磁盘。

这是大多数平板电脑的问题，因为并非所有平板电脑都可以将其 SD 卡作为可移动磁盘安装在 PC 上，而无需在 PC 上为该平板电脑安装特殊驱动程序。但对于大多数 ICS 手机，PC 似乎将磁盘安装为可移动存储，所以我想将我的应用程序限制为 API 8 - API15（仅限手机）

有没有办法在 android 应用程序的清单中指定该应用程序应与 ICS android 手机而不是 ICS 平板电脑一起使用，以便拥有平板电脑的用户无法从 android 市场下载它？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:58:42.427

[您可以尝试在 Manifest 文件http://developer.android.com/guide/topics/manifest/supports-screens-element.html](http://developer.android.com/guide/topics/manifest/supports-screens-element.html)中指定屏幕尺寸。难以区分的原因是平板电脑和手机本质上运行相同的软件。您可能想了解这些设备不作为可移动磁盘安装的确切原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T06:21:51.943

如果您想排除某些设备，在开发者中心的应用程序页面上有一个“支持的设备”选项卡，您可以在其中勾选您不想与您的软件一起支持的型号前面的复选框。除此之外，您无能为力，因为现在手机和平​​板电脑非常相似，我仍然不确定三星 Galaxy Note 是手机还是平板电脑 =)

# hbase - 预计区域服务器的数量不符合配置

> ID：11218882
> 
> 赞同：0
> 
> 时间：2012-06-27T03:12:00.510
> 
> 标签：hbase, region

在我的hbase集群中，我在文件中设置了5个hadoop datanode `s1,s2,s3,s4,s5`，在`regionservers`文件中设置了hadoops namenode `m1`，但是当我启动hbase集群时，我在hbase-status页面上`master`只能看到2个regionservers ？`s1,s3`有什么问题？到目前为止，hbase 集群工作正常。我检查了 DNS，但没有发现问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T19:48:47.820

通过在每个主机上执行“sudo jps”检查是否所有区域服务器都已启动，如果没有，则从 init 脚本启动单个 RS

# generics - If I use a facade class with generic methods to access the JPA API, how should I provide additional processing for specific types?

> ID：11218883
> 
> 赞同：1
> 
> 时间：2012-06-27T03:12:02.827
> 
> 标签：generics, jakarta-ee, jpa, dao, service-layer

Let's say I'm making a fairly simple web application using JAVA EE specs (I've heard this is possible). In this app, I only have about 10 domain/data objects, and these are represented by JPA Entities. Architecturally, I would consider the JPA API to perform the role of a DAO. Of course, I don't want to use the EntityManager directly in my UI (JSF) and I need to manage transactions, so I delegate these tasks to the so-called service layer.

More specifically, I would like to be able to handle these tasks in a single DataService class (often also called CrudService) with generic methods. See this article by Adam Bien for an example interface: [http://www.adam-bien.com/roller/abien/entry/generic_crud_service_aka_dao](http://www.adam-bien.com/roller/abien/entry/generic_crud_service_aka_dao)

My project differs from that article in that I can't use EJBs, so my service classes are essentially just named beans and I handle transactions manually. Regardless, what I want is a single interface for simple CRUD operations on my data objects because having a different class for each data type would lead to a lot of duplicate and/or unnecessary code.

Ideally, my views would be able to use a method such as

```
public <T> List<T> findAll(Class<T> type) { ... } 
```

to retrieve data. Using JSF, it might look something like this:

```
<h:dataTable value="#{dataService.findAll(data.class)}" var="d">
  ...
</h:dataTable> 
```

Similarly, after validating forms, my controller could submit the data with a method such as:

```
public <T> void add(T entity) { ... } 
```

Granted, you'd probably actually want to return something useful to the caller.

In any case, this works well if your data can be treated as homogenous in this manner. Alas, it breaks down when you need to perform additional processing on certain objects before passing them on to JPA.

For example, let's say I'm dealing with Books and Authors which have a many-to-many relationship. Each Book has a set of IDs referring to its authors, and each Author has a set of IDs referring to their books. Normally, JPA can manage this kind of relationship for you, but in some cases it can't (for example, the google app engine JPA provider doesn't support this). Thus, when I persist a new book for example, I may need to update the corresponding author entities.

My question, then, is if there's an elegant way to handle this or if I should reconsider the sanity of my whole design. Here's a couple ways I see of dealing with it:

1.  The instanceof operator. I could use this to target certain classes when special processing is needed. Perhaps maintainability suffers and it isn't beautiful code, but if there's only 10 or so domain objects it can't be all that bad... could it?

2.  Make a different service for each entity type (ie, BookService and AuthorService). All services would inherit from a generic DataService base class and override methods if special processing is needed. At this point, you could probably also just call them DAOs instead.

As always, I appreciate the help. Let me know if any clarifications are needed, as I left out many smaller details.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T07:36:33.093

The service layer is mainly justified by the need for transactions, and by the need of specific business logic for every use-case. Making it generic doesn't make much sense, IMHO. And having a service per entity doesn't make much sense either, still IMHO: some entities are tightly linked together, and can't just be created or updated independently by a service. And most of the services involve several entities.

The service layer, as its name indicates, is there to provide services to the above layer (the presentation layer). So it should not have some generic interface disconnected from the reality of what the application needs to do. It should provide the services that the UI layer needs. I find it much more logical to split the services based on use-cases or groups of related use-cases rather than entities. And I also find it more logical to start implementing the UI layer, see what services it needs, and implement those services, rather than designing generic services, then start implementing the UI layer, and fall in one of those commonly seen traps:

*   a whole lot of services don't have any use and are implemented but never used
*   the UI layer start calling N low-lever services for each button click, forgets about transactional integrity, and contains the logic that should be in the service layer.

# css - Twitter Bootstrap 导航栏已修复

> ID：11218886
> 
> 赞同：4
> 
> 时间：2012-06-27T03:12:12.883
> 
> 标签：css, twitter-bootstrap

当屏幕尺寸低于 940 像素时，我必须更改哪些内容才能使导航栏固定？我不想让它响应。如果你将浏览器窗口调整到940px以下，你会看到scrollbar-x（底部滚动条）出现，但是当你向右滚动时，导航栏位置仍然固定，一些菜单不会出现。

![推特](../Images/c7673be61a300940067a1197c665348d.png)![Facebook](../Images/05fb823750b8f7b23153d4762e06be6a.png)

也许一些图片可以解释我的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T04:18:34.697

这不能仅在 CSS 中完成。

您给出的示例（Twitter）在所有屏幕尺寸下都有固定位置和固定尺寸的导航栏。固定位置意味着滚动条不会影响导航栏的位置，这就是为什么您不能使用 x-scrollbar 看到导航栏的部分，一旦它小于 940px 宽，就会隐藏在“下方”浏览器窗口的右边框。

所以你必须选择，要么

1.  有一个*固定位置*，*固定大小*的导航栏，无论用户向下滚动多远，它都会出现在顶部，并接受在足够小的屏幕下他们将无法水平滚动以查看全部内容，或者
2.  有一个*固定位置*、*流动大小*的导航栏，它可以调整其宽度以适应不同的屏幕尺寸，这有望首先减轻水平滚动的需要，特别是如果你让它垂直增长，如果它的内容不适合一行，或者
3.  有一个*非固定位置*、*固定大小*的导航栏，它将响应水平滚动，但在用户向下滚动页面时不会一直存在。

实际上，您不能`position`在 x 方向上以一种方式工作而在 y 方向上以另一种方式工作。

您可以通过使用 CSS 检查器在 Twitter 页面中编辑以下类来了解我所说的选项 2：

```
.global-nav .container {
    width: auto;
    max-width: 865px;
}
.global-nav, .global-nav-outer {
    height: auto;
} 
```

一旦内容不能放在一行中，第二个选择器就会实现垂直流动性。

您可以通过进行以下更改来了解我所说的选项 3 的含义：

```
.topbar {
    position: absolute;
    /* ... the rest as is */
} 
```

* * *

## 编辑

当然，不能在 CSS 中完成并不意味着它根本不能完成。这是一个实现您提到的脚本的jsfiddle。这使用 MooTools 而不是 jQuery，我通常在 bootstrap 中使用它。

小提琴： http: [//jsfiddle.net/uadDW/4/](http://jsfiddle.net/uadDW/4/)
全屏版更好看效果：http: [//jsfiddle.net/uadDW/4/show/](http://jsfiddle.net/uadDW/4/show/)

*（感谢@Sherbrow 提供了我制作这个的基础小提琴）。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-31T02:08:12.900

遇到同样的问题并对建议的解决方案感到兴奋，但后来我努力在自己的代码中实现（是的，noobie）。

事实证明，这里与 jquery.js 存在冲突，我在代码的其他地方需要它。

[http://jsfiddle.net/uadDW/83/](http://jsfiddle.net/uadDW/83/)

```
/* code as before .. only added jquery.js link */ 
```

从上面小提琴中的外部资源中删除 jquery.js ，您将获得原始所需的行为。老鼠！

# c# - DirectX 未出现在参考资料中

> ID：11218888
> 
> 赞同：0
> 
> 时间：2012-06-27T03:12:34.117
> 
> 标签：c#, directx

我刚刚安装了 DirectX SDK，但是当我尝试添加对它的引用时，它并没有出现在我的列表中。所以，我需要知道如何将所有 DX 引用添加到列表中，或者我需要浏览哪个 DLL。我正在尝试获取 Microsoft.DirectX.AudioVideoPlayback

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T04:32:04.947

现在，无论如何，我已经下载了托管代码仍然存在的 DirectX9，这解决了我的问题。我考虑过使用 SharpDX，但它的文档为零。

# java - 如何使用 GPU 库 (Jogamp JOCL) 运行已编译的 Java 类？

> ID：11218896
> 
> 赞同：0
> 
> 时间：2012-06-27T03:14:08.797
> 
> 标签：java, runtime, gpu

在这种情况下，有谁知道如何从命令行运行依赖于 GPU 库的 java 代码 Jogamps JOCL。

我已经编译了一个测试程序 HelloJOCL.java，但在运行时出现错误。

我试过 javac -classpath "./lib/jocl.jar:./lib/jocl-natives-macosx-universal.jar:./lib/jocl-natives-linux-i586.jar:./lib/jocl-natives- linux-amd64.jar:./lib/gluegen-rt.jar:./lib/gluegen-rt-natives-linux-amd64.jar:./lib/gluegen-rt-natives-macosx-universal.jar:./ lib/gluegen-rt-natives-linux-i586.jar" ./HelloJOCL.java

java -classpath "./lib/jocl.jar:./lib/jocl-natives-macosx-universal.jar:./lib/jocl-natives-linux-i586.jar:./lib/jocl-natives-linux- amd64.jar:./lib/gluegen-rt.jar:./lib/gluegen-rt-natives-linux-amd64.jar:./lib/gluegen-rt-natives-macosx-universal.jar:./lib/胶水-rt-natives-linux-i586.jar:." 你好JOCL

但在线程“main”java.lang.NoClassDefFoundError: com/jogamp/opencl/CLContext at java.lang.Class.getDeclaredMethods0(Native Method) 中出现此错误异常

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T06:13:22.150

您是否尝试使用 try/catch 添加代码，例如：

```
try {
} catch (NoClassDefFoundError x) {
    x.printStackTrace();
} 
```

我承认我从来没有这样做过。

# python - 降落伞分段错误 - pygame 到 py2exe

> ID：11218897
> 
> 赞同：0
> 
> 时间：2012-06-27T03:14:17.423
> 
> 标签：python, python-2.7, pygame, py2exe, gui2exe

我正在使用 GUI2Exe 将我的 python/pygame 游戏编译为 .exe

我的字体模块有问题。

在 GUI2Exe 中使用 python 2.7 和 py2exe 选项我已经用 2.7 版本更新了 python、pygame 和 py2exe。我的程序运行良好，但是在我用 py2exe 编译它之后，我得到了这个。

这是我得到的错误：

```
Fatal Python error: (pygame parachute) Segmentation Fault

This application has requested the Runtime to terminate it in an unusual way.
Please contact the application's support team for more information. 
```

我的游戏从控制台开始，然后运行该部分。但是一旦显示开始，我就会崩溃。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T05:06:38.663

Had similar problems and that one too. Found a way to solve them:

After few weeks (had this problem even before) I'm happy to say that I solved this problem! :)

**1st part of my problem** ([http://i.stack.imgur.com/WpkjR.png](http://i.stack.imgur.com/WpkjR.png)): I solved it by editing setup.py script with adding "excludes" part in it. That resulted in successful making of executable file!

Modified setup.py script:

```
from distutils.core import setup
import py2exe
setup(windows=['source_static.py'], options={
          "py2exe": {
              "excludes": ["OpenGL.GL", "Numeric", "copyreg", "itertools.imap", "numpy", "pkg_resources", "queue", "winreg", "pygame.SRCALPHA", "pygame.sdlmain_osx"],
              }
          }
      ) 
```

So, if you have similar issues, just put those "missing" modules into this "excludes" line.

**2nd part:**

After I succeeded in making of executable file, I had next problem: *"**The application has requested the Runtime to terminate it in unusual way. Please contact...**"*. After days and days of searching and thinking how to solve this another problem, I found a way to do it. I couldn't believe that the problem was so absurd. The problem was in my code, with font definition:

```
font1 = pygame.font.SysFont(None, 13) 
```

After changing "**None**" to some system font name (for an example "Arial" (must be a string)), and compiling, I couldn't believe that my .exe file worked!

```
font1 = pygame.font.SysFont("Arial", 13) 
```

Of course, you can use your own font, but you must specify its path and define it in your program.

So for all of you who are experiencing this issues, try this steps and I hope that you will succeed. I really hope that this will help you, because I've lost days and weeks trying to solve these problems. I even tried making my .exe file with all versions of python and pygame, with many other .exe builders and setup scripts, but without luck. Besides these problems, I had many other problems before but I found answers to them on stackoverflow.com.

I'm happy that I found a way to solve this problems and to help you if you are faced with the same ones.

**Small tips (things I've also done):**

> > 1st: update your Microsoft Visual C++ library to the latest one.
> > 
> > 2nd: if you have images or fonts similar that your executable program needs, include them to **dist** folder (where your .exe file has been created).
> > 
> > 3rd: when you are making your .exe file, include all needed files to the folder where your setup.py script is (all files and directories that your main script uses).

Used **Python 2.7 x64**, **pygame** and **py2exe**.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T23:38:56.383

不要使用 gui2exe 使用此链接中的此文件：http: [//pygame.org/wiki/Pygame2exe](http://pygame.org/wiki/Pygame2exe)

按照说明操作并根据需要修改文件。将文件放在与“游戏”主目录相同的目录中，然后从控制台运行文件。

# python - Python 从抛出异常的地方继续

> ID：11218898
> 
> 赞同：2
> 
> 时间：2012-06-27T03:14:18.437
> 
> 标签：python, exception, try-catch, continue

嗨，有没有办法从抛出异常的地方继续？例如，我有以下伪代码

```
unique code 1
unique code 2
unique code 3 
```

如果我想忽略任何唯一代码语句的异常，我将不得不这样做：

```
try:
  #unique code 1
except:
  pass

try:
  #unique code 2
except:
  pass

try:
  #unique code 3
except:
  pass 
```

但这对我来说并不优雅，对于我的生活，我不记得上次我是如何解决这种问题的......我想要的是

```
try:
  unique code 1
  unique code 2
  unique code 3
except:
  continue from last exception raised 
```

更新： 原因：我问这个的原因是上面的 3 行代码共享同一种异常，比如说，从数组中提取信息，在这个特定的场景中，我并不真正关心 value 的异常不在数组中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:17:20.917

将每个代码部分包装成一个函数，然后尝试在 for 循环中调用每个部分：

```
def code1():
    #unique code 1

def code2():
    #unique code 2

def code3():
    #unique code 3

for section in [code1, code2, code3]:
    try:
        section()
    except:
        pass 
```

编辑：如果您仍在寻找另一种方式，您可以使用装饰器使每个调用“安全”购买返回任何错误而不是抛出它们。不确定这是否真的是pythonic或做事的好方法，但它是一种方式：

```
def safe_call(fn):
    def wrapper(*args, **kwargs):
        try:
            return fn(*args, **kwargs)
        except Exception as error:
            return error
    return wrapper

@safe_call
def code1():
    #unique code 1

@safe_call
def code2():
    #unique code 2

@safe_call
def code3():
    #unique code 3

code1()
code2()
code3() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T10:58:01.550

我们可以使用一个**while**循环：

```
#!/urs/bin/env python 

 check = 0
 while True:
     try:
         if check == 0:
             #unique_code_one ()  
             check += 1
         if check == 1:
             #unique_code_two () 
             check += 1 
         if check == 2:
             #unique_code_three() 
     except: 
         check = 2 
```

# javascript - 同一 DIV 上的 jQuery 悬停/单击事件（移动设备）

> ID：11218900
> 
> 赞同：2
> 
> 时间：2012-06-27T03:14:29.373
> 
> 标签：javascript, jquery, mobile, click, hover

我编写了一个简单的脚本，在图像上显示圆圈。

1.  当您将鼠标悬停在一个圆圈上时，它会扩展为一个工具提示。

    ```
    $('div.tooltip').live({mouseenter:function(e){
    ... animate tooltip open;
    },mouseleave:function(e){
    ... animate tooltip closed;
    }}); 
    ```

2.  当您单击打开的工具提示时，它会显示一个包含更多信息的灯箱。

    ```
    $('div.tooltip').live('click',function(e){
    ... open related lightbox
    }); 
    ```

除移动设备外，一切正常。当我点击圆圈打开工具提示时，它会触发`click`事件并完全绕过`mouseenter/mouseexit`事件。任何想法将不胜感激:)谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T03:17:41.640

由于触摸屏设备的性质，它们根本不支持悬停事件。在这方面你能做的最好的事情是使用一个支持手势的 jquery 插件并使用单击和双击事件，否则你需要将工具提示放在其他地方并使其始终可见或有一个单独的按钮激活提示...或者您可以这样做，以便第一次单击激活压力机，然后下一次单击激活第二个功能。

# ruby-on-rails - 从另一个目录运行 Rails

> ID：11218901
> 
> 赞同：2
> 
> 时间：2012-06-27T03:14:39.780
> 
> 标签：ruby-on-rails

有谁知道是否可以从另一个目录运行 rails。IE

```
ruby ../another_directory/script/rails s 
```

它只会让我的生活更轻松。

# clojure - 是否可以对 Lisp 系列语言实现自动柯里化？

> ID：11218905
> 
> 赞同：15
> 
> 时间：2012-06-27T03:15:49.143
> 
> 标签：clojure, lisp, scheme, common-lisp, currying

也就是说，当您调用一个只有一个参数且数量大于 1 的函数时，它应该不显示错误，而是对该参数进行 curry 并返回具有减少的数量的结果函数。使用 Lisp 的宏可以做到这一点吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-27T03:47:34.643

如果你想要一个有用的结果，这是可能的，但并不容易。

*   如果您想要一种总是进行简单柯里化的语言，那么实现很容易。您只需将多个输入的每个应用程序转换为嵌套应用程序，对于多个参数的函数也是如此。借助[Racket 的](http://racket-lang.org/)语言功能，这是一个非常简单的练习。（在其他 lisps 中，您可以通过围绕要使用它的代码的一些宏来获得类似的效果。）

    （顺便说一句，我在 Racket 之上有一种语言可以做到这一点。它具有自动柯里化语言的全部可爱之处，但它并不实用。）

    但是，它并不太有用，因为它仅适用于一个参数的函数。您可以通过一些黑客攻击使其变得有用，例如，将围绕您的语言的 lisp 系统的其余部分视为外语，并提供使用它的表单。另一种选择是为您的语言提供有关周围 lisp 函数的数量信息。其中任何一个都需要更多的工作。

*   另一种选择是只检查每个应用程序。换句话说，你转动每一个

    ```
    (f x y z) 
    ```

    到检查 arity 的代码中，`f`如果没有足够的参数，将创建一个闭包。这本身并不太难，但会导致显着的间接费用。您可以尝试使用类似的技巧，了解您将在宏级别使用的函数的一些信息，以了解应该在哪里创建此类闭包——但这基本上以相同的方式困难。

但是有一个更严重的问题，在你想做的事情的高层次上。问题是可变参数函数不能很好地与自动柯里化配合使用。例如，采用如下表达式：

（+ 1 2 3）

您将如何决定是否应该按原样调用它，或者是否应该将其翻译为`((+ 1 2) 3)`？似乎这里有一个简单的答案，但是这个呢？（翻译成你最喜欢的 lisp 方言）

```
(define foo (lambda xs (lambda ys (list xs ys)))) 
```

在这种情况下，您可以通过多种方式拆分 a `(foo 1 2 3)`。另一个问题是您如何处理以下内容：

```
(list +) 
```

在这里你有`+`一个表达式，但你可以决定这与将它应用于适合`+`sarity 的零输入相同，但是你如何编写一个计算加法函数的表达式？（旁注：ML 和 Haskell 通过没有无效函数来“解决”这个问题......）

这些问题中的一些可以通过决定每个“真实”应用程序必须具有它的括号来解决，因此 a`+`本身永远不会被应用。但这失去了自动咖喱语言的可爱之处，你仍然有问题要解决......

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-27T03:25:47.690

在 Scheme 中，可以使用以下`curry`过程对函数进行 curry：

```
(define (add x y)
  (+ x y))

(add 1 2)           ; non-curried procedure call
(curry add)         ; curried procedure, expects two arguments
((curry add) 1)     ; curried procedure, expects one argument
(((curry add) 1) 2) ; curried procedure call 
```

从球拍的[文档](http://docs.racket-lang.org/reference/procedures.html)：

> [curry] 返回一个过程，它是 proc 的柯里化版本。当第一次应用结果过程时，除非给定它可以接受的最大参数数量，否则结果是一个接受附加参数的过程。

`curry`您可以轻松实现定义新过程时自动使用的宏，如下所示：

```
(define-syntax define-curried
    (syntax-rules ()
      ((_ (f . a) body ...)
       (define f (curry (lambda a (begin body ...))))))) 
```

`add`现在将柯里化以下定义：

```
(define-curried (add a b)
  (+ a b))

add
> #<procedure:curried>

(add 1)
> #<procedure:curried>

((add 1) 2)
> 3

(add 1 2)
> 3 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T03:26:44.730

简短的回答是肯定的，但并不容易。

您可以将其实现为**将每个调用都包含在 中的宏`partial`**，尽管仅在有限的上下文中。Clojure 有一些特性会使这变得相当困难，例如可变参数函数和动态调用。Clojure 缺乏正式的类型系统来具体决定调用何时不能有更多参数并且应该实际调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T03:26:00.557

Lisp 已经有了函数式柯里化：

```
* (defun adder (n)
    (lambda (x) (+ x n)))
ADDER 
```

[http://cl-cookbook.sourceforge.net/functions.html](http://cl-cookbook.sourceforge.net/functions.html)

这是我读到的关于 Lisp 宏的内容：[https ://web.archive.org/web/20060109115926/http://www.apl.jhu.edu/~hall/Lisp-Notes/Macros.html](https://web.archive.org/web/20060109115926/http://www.apl.jhu.edu/~hall/Lisp-Notes/Macros.html)

可以在纯 Lisp 中实现这一点。也可以使用宏来实现它，但是似乎宏会使非常基本的东西变得更加混乱。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-27T19:57:14.103

正如 Alex W 所指出的，Common Lisp Cookbook[确实给出了](http://cl-cookbook.sourceforge.net/functions.html)Common Lisp的“curry”函数的示例。具体示例在该页面的下方：

```
(declaim (ftype (function (function &rest t) function) curry)
         (inline curry)) ;; optional
(defun curry (function &rest args)
  (lambda (&rest more-args)
    (apply function (append args more-args)))) 
```

自动柯里化应该不难实现，所以我尝试了一下。请注意，以下内容没有经过广泛测试，也没有检查是否有太多 args（当有该数量或更多时，该函数才完成）：

```
(defun auto-curry (function num-args)
  (lambda (&rest args)
    (if (>= (length args) num-args)
        (apply function args)
        (auto-curry (apply (curry #'curry function) args)
                    (- num-args (length args)))))) 
```

似乎工作，但：

```
* (auto-curry #'+ 3)
#<CLOSURE (LAMBDA (&REST ARGS)) {1002F78EB9}>

* (funcall (auto-curry #'+ 3) 1)
#<CLOSURE (LAMBDA (&REST ARGS)) {1002F7A689}>

* (funcall (funcall (funcall (auto-curry #'+ 3) 1) 2) 5)
8

* (funcall (funcall (auto-curry #'+ 3) 3 4) 7)
14 
```

上面的一些宏语法糖的原始版本（不能正确处理完整的 lambda 列表，只是简单的参数列表）：

```
(defmacro defun-auto-curry (fn-name (&rest args) &body body)
  (let ((currying-args (gensym)))
    `(defun ,fn-name (&rest ,currying-args)
       (apply (auto-curry (lambda (,@args) ,@body)
                          ,(length args))
              ,currying-args)))) 
```

似乎有效，尽管对 funcall 的需求仍然很烦人：

```
* (defun-auto-curry auto-curry-+ (x y z)
    (+ x y z))
AUTO-CURRY-+

* (funcall (auto-curry-+ 1) 2 3)
6

* (auto-curry-+ 1)
#<CLOSURE (LAMBDA (&REST ARGS)) {1002B0DE29}> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-28T16:34:46.337

当然，你只需要为你的语言确定准确的语义，然后实现你自己的*加载器*，它将你的源文件翻译成实现语言。

例如，您可以将每个用户函数调用`(f a b c ... z)`转换为`(...(((f a) b) c)... z)`，并将每个`(define (f a b c ... z) ...)`转换`(define f (lambda(a) (lambda(b) (lambda(c) (... (lambda(z) ...) ...)))))`为 Scheme 的顶部，以拥有一个自动柯里化 Scheme（这当然会禁止 varargs 函数）。

您还需要定义自己的原语，将 varargs 函数（如 eg `(+)`）转换为二进制，并将其应用程序转换为使用[`fold`](http://en.wikipedia.org/wiki/Fold_%28higher-order_function%29)eg `(+ 1 2 3 4)`==>`(fold (+) (list 1 2 3 4) 0)`或其他东西 - 或者可能只是在*您的新语言*`(+ 1 2 3 4)`中将此类调用视为非法，期望其用户自己写表格。*`fold`*

 *这就是我所说的“为你的语言决定……语义”的意思。

加载器可以像将文件内容包装到*对宏*的调用一样简单——然后根据您的问题，您必须实现该宏。*

# c# - 应用程序调用了为窗口 8 中的不同线程编组的接口

> ID：11218911
> 
> 赞同：4
> 
> 时间：2012-06-27T03:17:20.637
> 
> 标签：c#, windows, windows-8

在项目中，我使用 HttpWebRequest 来下载 Feed：

```
HttpWebRequest request;
        public void getFeeds()
        {
            request = (HttpWebRequest)WebRequest.Create("http://vnexpress.net/rss/gl/trang-chu.rss");
            request.BeginGetResponse(ResponseCallBack, request);
        }
        SampleDataGroup group1;
        private void ResponseCallBack(IAsyncResult result)
        {
            var request = (HttpWebRequest)result.AsyncState;
            var response = request.EndGetResponse(result) as HttpWebResponse;

            if (response != null && response.StatusCode == HttpStatusCode.OK)
            {
                var stream = response.GetResponseStream();
                using (StreamReader reader = new StreamReader(stream))
                {
                    string strReaderReader = reader.ReadToEnd();

                    XDocument doc = XDocument.Parse(strReaderReader);
                    var element = doc.Root.Element("channel").Elements("item");
                    group1 = new SampleDataGroup("Group-1",
                    "Hot News",
                    "Group Subtitle: 1",
                    "Assets/DarkGray.png",
                    "");
                    foreach (XElement x in element)
                    {

                        group1.Items.Add(new SampleDataItem("", x.Element("title").Value, "", "", "", "", group1));

                    }
                    request.Abort();

                    request = null;
                    _allGroups.Add(group1);

                    onComplete1();
                }
            }
        } 
```

onComplete1() 是委托，我用来在解析 XMl 完成时更新布局。但它错误：

```
System.Exception: The application called an interface that was marshalled for a different thread. (Exception from HRESULT: 0x8001010E (RPC_E_WRONG_THREAD)) 
```

请帮我 ！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T22:14:54.053

最有可能的是，您的`onComplete1()`方法进行了一些 UI 访问。

尝试将其包含在[Dispatcher.RunAsync](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.core.coredispatcher.runasync)方法中：

```
this.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =>
    {
      onComplete1();
    }); 
```

或将其作为任务等待，具体取决于您的需要：

```
this.Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =>
    {
      onComplete1();
    }).AsTask().Wait(); 
```

# ruby-on-rails - 使用 Rails.cache.fetch 混淆缓存 Active Record 查询

> ID：11218917
> 
> 赞同：11
> 
> 时间：2012-06-27T03:17:37.893
> 
> 标签：ruby-on-rails, caching

我的版本是：

*   导轨：3.2.6
*   达利：2.1.0

我的环境是：

*   config.action_controller.perform_caching = true
*   config.cache_store = :dalli_store, 'localhost:11211', {:namespace => 'MyNameSpace'}

当我写：

```
 Rails.cache.fetch(key) do
     User.where('status = 1').limit(1000)
 end 
```

无法缓存用户模型。如果我使用

```
 Rails.cache.fetch(key) do
     User.all
 end 
```

它可以被缓存。如何缓存查询结果？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-27T07:21:11.923

原因是因为

```
User.where('status = 1').limit(1000) 
```

返回`ActiveRecord::Relation`实际上是一个范围，而不是一个查询。Rails 缓存范围。

如果要缓存查询，则需要在末尾使用查询方法，例如`#all`.

```
Rails.cache.fetch(key) do
  User.where('status = 1').limit(1000).all
end 
```

请注意，**缓存 ActiveRecord 对象绝不是一个好主意**。缓存对象可能会导致不一致的状态和值。如果适用，您应该始终缓存原始对象。在这种情况下，请考虑缓存 id。

```
ids = Rails.cache.fetch(key) do
  User.where('status = 1').limit(1000).pluck(:id)
end
User.find(ids) 
```

`User.find`您可能会争辩说，在这种情况下，总是会执行对它的调用。确实如此，但是使用主键的查询速度很快，并且您可以解决我之前描述的问题。此外，缓存活动记录对象可能会很昂贵，并且您可能很快就会用一个缓存条目填满所有 Memcached 内存。缓存 id 也可以防止这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T07:14:31.897

`Rails.cache.fetch`准确缓存块评估的内容。

```
User.where('status = 1').limit(1000) 
```

只是一个范围，所以缓存的只是 ActiveRecord::Relation 对象，即查询，而不是它的结果（因为查询尚未执行）。

如果你想缓存一些有用的东西，你需要在块内强制执行查询，例如通过做

```
User.where('status = 1').limit(1000).all 
```

请注意，在 rails 4 上，`all`不会强制加载关系 -`to_a`改为使用

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-16T15:54:32.333

除了选定的答案：对于 Rails 4+，您应该使用`load`而不是`all`获取范围的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T06:51:15.470

使用

```
User.where("status = 1").limit(1000).all 
```

应该管用。

# php - 如何将我的自定义聊天添加到我的所有网页

> ID：11218919
> 
> 赞同：-1
> 
> 时间：2012-06-27T03:17:52.837
> 
> 标签：php, include, chat

我创建了一个基于 php/mysql 的聊天页面。它就像 gmail 聊天。一旦我点击在线成员，聊天框将在右下方打​​开。我有一个单独的聊天页面，其中包括 javascripts 和 css。它运作良好。

我遇到的问题是，我需要将该聊天页面添加到我的所有网页中。因为我的网站中有一些不同的区域。我希望我的会员即使访问我网站的另一个页面也能继续他们的聊天。

问题就在此时出现。我 `<?php include('pathtomychat.php');?>`在所有网页中都使用过。在线朋友显示正确。但如果我开始与某人聊天并突然访问另一个页面，则打开的聊天框在新页面中不再可见。如果我再次点击我已经聊天的成员，会出现聊天框，但我的聊天消息将不会收到该成员。

我已经尝试了数千次使用谷歌搜索来寻找答案，但我做不到。

我看到有这么多聊天脚本，只需使用小的 javascript 片段就可以在多个页面中运行良好。他们是如何做到的？我无法解决这个问题。如果您能说出为什么会发生这种情况以及我应该做些什么来克服这种情况，我将不胜感激。

非常感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:41:04.797

我无法回答为什么有人会否定。我猜是因为你没有显示任何代码......

无论如何，关于你的问题。当您转到新页面时，您正在重新加载您的`include "pathytomychat.php";`哪个会杀死打开的任何内容并重新加载它。你必须包括一些方法来检查那个窗口是否打开，然后检查它是否打开......

马上，我会在你的 pathtomychat.php 中做这样的事情

```
//Check to see if any windows are open
if(isset($_SESSION['window_open']) && $_SESSION['window_open'] == 'yes') {
    openChatWindow();
}

function openChatWindow() {
    $_SESSION['window_open'] = 'yes';
    //the rest of the code that actually opens the window
} 
```

当然，如果您使用 JS 打开窗口，您需要确保也以这种方式设置会话。您还可以使用 Cookie...

# android - 什么是 AudioFlinger，为什么它会失败 TONE_PROP_ACK？

> ID：11218923
> 
> 赞同：19
> 
> 时间：2012-06-27T03:18:20.620
> 
> 标签：android, android-audiomanager, dtmf, audioflinger

在我的申请中，我发出以下声明：

```
toneGenerator.startTone(ToneGenerator.TONE_PROP_ACK, 600); 
```

这在运行 Android 2.3.3 的廉价 LG LS670 上运行良好，但在我拥有的所有其他手机（从 Android 2.2.1 到 Android 2.3.4）上完全没有声音。

所以我知道操作系统版本在这里不起作用（我还在文档中验证了它从 API 1 开始就受到支持）。

此外，铃声音量和媒体音量都设置为最大值，并且toneGenerator 初始化为：

```
toneGenerator = new ToneGenerator(ToneGenerator.TONE_DTMF_1, 100); 
```

我验证了`Settings.System.DTMF_TONE_WHEN_DIALING`它设置为 1。

对这种不一致的行为（在不同的手机上）感到困惑，我检查了发生这种情况时的系统日志，我能够发现的唯一可疑的区别是那些**无法**发声的手机`TONE_PROP_ACK`在他们的日志中有这条线：

```
AudioFlinger    setParameters(): io 25, keyvalue routing=0, tid 155, calling tid 121 
```

[AudioFlinger](http://androidaudio.blogspot.com/2010/06/so-what-is-audioflinger.html)的目的是什么，它与静音有什么联系`TONE_PROP_ACK`？

[知道](https://stackoverflow.com/questions/2413426/playing-an-arbitrary-tone-with-android)如何修复我的代码，以便无论手机型号如何，TONE_PROP_ACK 总是响起吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T21:49:48.057

一种解决方法是在 Audacity 之类的东西中生成音调，并通过 SoundPool 或您选择的 api 播放它。

根据 Android 文档 ToneGenerator.TONE_PROP_ACK 是：

1200Hz，100ms ON，100ms OFF 2 个脉冲

如果您选择 SoundPool，我建议保存为 ogg 文件格式并循环播放音调直到完成。这同时以非常小的剪辑提供无缝音频，并且不使用大量资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-02T04:00:48.653

解析/解码由媒体播放器服务使用的 Stage fright 处理。解码后的数据通过 Audio Sink 写入 Audio Track，然后由 Audio Flinger 的混音器线程混合音轨并写入输出流（音频硬件）。输出流对象填满自己的缓冲区，然后将数据写入 PCM 输出设备文件（可能是也可能不是 ALSA 驱动程序）。

# php - PHP 异步任务

> ID：11218924
> 
> 赞同：3
> 
> 时间：2012-06-27T03:18:28.673
> 
> 标签：php, asynchronous

我正在处理可能涉及长时间运行任务的 php 脚本。过程是这样的，用户（在我的情况下使用 iOS 应用程序）将数据提交到我的 Web 服务。部分过程需要我的 php 脚本联系第三方来验证一些提交的数据。客户端（在 iPad 上）无需等待第三方的响应。

伪代码：

```
Pull values from _POST[]
some simple validation
if _POST[] values are good
    return success to client
    further process submitted data with thrd party
    update database
else
    return error code and message 
```

怎么可能从我的服务器返回一个简单的 JSON 对象仅作为收据，并让我的 php 脚本进一步处理提交的数据。众所周知，我使用的第三方响应速度很慢（跳了几跳，并且已知需要几分钟才能响应）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T03:26:53.680

虽然您*可以*提前发送输出缓冲区并继续处理（请参阅[关闭连接后继续处理](https://stackoverflow.com/questions/4806637/continue-processing-after-closing-connection)），但它是一个 hacky 解决方案，不适合 PHP 请求生命周期。

更好的方法是创建处理队列。当客户端点击您的服务时，您返回成功状态并在队列中插入处理请求（例如，在数据库表/键值存储等中）。一个单独的进程（例如，运行 CLI 脚本的 cron 作业）获取任务并先入先出地执行它们。这允许长时间运行的脚本在带外执行——甚至可能在不同的服务器上执行。

顺便说一句，即使客户端需要检查长时间运行的进程的结果，这也允许您释放 Web 服务器以处理更多请求。客户端可以轮询服务器以检查作业是否完成，并在准备好时获得完整的响应。

# logging - 求自定义/聊天记录分析器

> ID：11218927
> 
> 赞同：1
> 
> 时间：2012-06-27T03:18:59.340
> 
> 标签：logging, analyzer

我有一个 Flash 聊天程序，它输出聊天日志，如果不进行处理，几乎不可能查看。我花了很长时间寻找一个 Windows 程序（最好），它将采用以下类型的数据并以人类可读的格式输出：

```
<r>ROOMNAME</r><f>USERID-From</f><to>USERID-to</to><w>WHISPER-false</w><dt>1.340758262E9</dt><c><![CDATA[how are you?]]></c></m><m> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T02:41:38.277

> 以下类型的数据并以人类可读的格式输出

我想这有点主观，什么是“人类可读的”。SGML/XML 通常就是这样设计的。但这里有一些建议：

*   [`xmllint`](https://code.google.com/p/xmllint/)有一台漂亮的打印机
*   XPath 是一种从 XML 文件中提取特定内容的非常好的方法。使用您喜欢的语言的 XPath 支持（Java 的 JAXP、python 的 libxml 等）。
*   一些 Java 源代码的漂亮打印示例，来自[http://ig2600.blogspot.com/2009/12/pretty-printing-xml-on-windows.html](http://ig2600.blogspot.com/2009/12/pretty-printing-xml-on-windows.html)：

这是示例：

```
namespace xmllint
{
    using System;
    using System.Xml;
    using System.Xml.Linq;

    class Program
    {
        static void Main(string[] args)
        {
            var xml = XDocument.Parse(Console.In.ReadToEnd());
            var output = new XmlTextWriter(Console.Out);
            output.Indentation = 4;
            output.Formatting = Formatting.Indented;
            xml.WriteTo(output);
            output.Flush();
        }
    }
} 
```

顺便说一句，如果不是很明显，“ `dt`”标签包含自纪元以来秒数的浮点表示。

# python - 使用索引拆分列表

> ID：11218928
> 
> 赞同：0
> 
> 时间：2012-06-27T03:19:24.007
> 
> 标签：python, list

我正在努力在某些索引处将列表切成碎片。虽然我可以一次只做一件，但我还没有找到一个可以让我跳过分段做的表达方式。

```
import re

#   Creating list to split

list = ['Leading', 'text', 'of', 'no', 'interest', '1.', 'Here', 'begins', 'section', '1', '2.', 'This', 'is', 'section', '2', '3.', 'Now', 'we', `enter code here`'have', 'section', '3']

#   Identifying where sections begin and end

section_ids = [i for i, item in enumerate(list) if re.search('[0-9]+\.(?![0-9])', item)]

#   Simple creation of a new list for each section, piece by piece

section1 = list[section_ids[0]:section_ids[1]]
section2 = list[section_ids[1]:section_ids[2]]
section3 = list[section_ids[2]:]

#   Iterative creation of a new list for each claim - DOES NOT WORK

for i in range(len(section_ids)):
     if i < max(range(len(section_ids))):
          section[i] = list[section_ids[i] : list[section_ids[i + 1]]
     else:
          section[i] = list[section_ids[i] : ]
     print section[i]

#   This is what I'd like to get

#   ['1.', 'Here', 'begins', 'section', '1']
#   ['2.', 'This', 'is', 'section', '2']
#   ['3.', 'Now', 'we', 'have', 'section', '3'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:37:09.663

```
for i,j in map(None, section_ids, section_ids[1:]):
    print my_list[i:j] 
```

如果 section_ids 很大，itertools 版本会更有效

```
from itertools import izip_longest, islice
for i,j in izip_longest(section_ids, islice(section_ids, 1, None)):
    print my_list[i:j] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:39:52.087

我能够使用以下代码产生所需的输出：

```
section=[]
for i,v in enumerate(section_ids+[len(list)]):
    if i==0:continue
    section.append(list[section_ids[i-1]:v]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:43:24.467

你是否试图实现这样的目标：

```
>>> section = [] # list to hold sublists ....
>>> for index, location in enumerate(section_ids):
...     if location != section_ids[-1]: # assume its not the last one
...         section.append(list[location:section_ids[index + 1]])
...     else:
...         section.append(list[location:])
...     print section[-1]
...
['1.', 'Here', 'begins', 'section', '1']
['2.', 'This', 'is', 'section', '2']
['3.', 'Now', 'we', 'have', 'section', '3']
>>> 
```

或者：

```
>>> import re
>>> from pprint import pprint
>>> values = ['Leading', 'text', 'of', 'no', 'interest', '1.', 'Here', 'begins', 'section', '1', '2.', 'This', 'is', 'section', '2', '3.', 'Now', 'we', 'have', 'section', '3']
>>> section_ids = [i for i, item in enumerate(values) if re.search('[0-9]+\.(?![0-9])', item)] + [len(values)]
>>> section = [values[location:section_ids[index + 1]] for index, location in enumerate(section_ids) if location != section_ids[-1]]
>>> pprint(section)
[['1.', 'Here', 'begins', 'section', '1'],
 ['2.', 'This', 'is', 'section', '2'],
 ['3.', 'Now', 'we', 'have', 'section', '3']] 
```

# asp.net - 将 C# 变量传递到 aspx Source Sql Query

> ID：11218930
> 
> 赞同：0
> 
> 时间：2012-06-27T03:19:52.090
> 
> 标签：asp.net, sql, gridview

我正在尝试做一个消息传递系统，其中收件箱是与用户 ID 关联的所有消息的网格视图。我在 C# 中有一个全局 get 方法来获取当前登录的用户。我想知道如何将其绑定，以便数据库只显示我想要的数据。

在我的 .aspx.cs 文件中，我有类似的内容：

```
 protected void Page_Load(object sender, EventArgs e)
      {
          int userInSess = getLoggedInUser();
          Session["user"] = user;

    } 
```

在源文件中，我有类似的内容：

```
 <asp:SqlDataSource ID="ProjectDB" runat="server" 
    ConnectionString="<%$ ConnectionStrings:ProjectConnectionString %>" 
    SelectCommand="SELECT [SentByUserName], [Subject], [CreateDate] FROM [Messages] WHERE (ReceivedByUserID = @user) ORDER BY [CreateDate] DESC">
    <SelectParameters>
        <asp:SessionParameter Name = "user" />
    </SelectParameters>
</asp:SqlDataSource> 
```

我知道这是错误的，但我似乎无法找到关于如何准确执行此操作的明确答案。任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:49:28.797

您需要引用存储在会话中的值：

```
<asp:SessionParameter Name="User" SessionField="user" /> 
```

注意`SessionField`属性的添加。

SqlDataSource 控件仅使用`Name="User"`Parameter 对象来匹配 SQL 查询中的 @user 占位符

# python - Google App Engine Python django TemplateSyntaxError：无效的块标签：'endif'

> ID：11218932
> 
> 赞同：0
> 
> 时间：2012-06-27T03:20:07.447
> 
> 标签：python, django, google-app-engine

在 Google App Engine 中使用 django 模板时，我不断收到此错误：

TemplateSyntaxError：无效的块标签：'endif'

蟒蛇代码：

```
class SuperAdmin(webapp.RequestHandler):
def get(self):

    #set the user object
    user = users.get_current_user()

    # See if user is logged in
    if user:  # signed in already
        #Create Logout URL
        logoutUrl = users.create_logout_url(self.request.uri)
        template_values['logoutUrl'] = logoutUrl

        #is this user a super admin
        isSuperAdmin = acl_authentication.AuthenticateUserViaAcl().isUserSuperAdmin(user.email(), user.user_id())
        template_values['isSuperAdmin'] = isSuperAdmin

        #Use our auth object to see if the user is allowed on this page
        if acl_authentication.AuthenticateUserViaAcl().IsUserPermitted(user.user_id(), user.email(), '0', '0', 50): #User is allowed
            self.response.out.write("This user is in the acl db and a super admin<br/>")

            #Add action1 to template_values
            template_values['action1'] = self.request.get('action1')

            #Write the Header
            path = os.path.join(os.path.dirname(__file__), 'adminHeader.html')
            self.response.out.write(template.render(path, template_values))

            #Write the Login Page
            path = os.path.join(os.path.dirname(__file__), 'SuperAdmin.html')
            self.response.out.write(template.render(path, template_values))

            #Write the Header
            path = os.path.join(os.path.dirname(__file__), 'adminFooter.html')
            self.response.out.write(template.render(path, template_values))

        else: #User is not allowed
            #Log to DB that we hit access denied page
            acl_authentication.AuthenticateUserViaAcl().LogToDbAccessDeniedHit(user.user_id(), user.email(), self.request.url)
            #Redirect to Access Denied Page
            self.redirect("/AccessDeniedPage")

    else: #User is not logged in
        self.redirect("/LoginPage?destUrl=" + self.request.url) 
```

.html 模板代码

```
<!-- Begin If action1==manage_companies -->
                {% if action1 == "manage_companies" % }
                    <tr>
                      <td>Manage Companies</td>
                    <tr>
                      <td>&nbsp;</td>
                    </tr>
                    <tr>
                      <td>&nbsp;</td>
                    </tr>
                {% endif %}
<!-- /End If action1==manage_companies --> 
```

我对 django 不熟悉，所以我在这里迷路了。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T04:35:30.023

此行中的 '%' 和 '}' 之间有一个额外的空格，
`{% if action1 == "manage_companies" % }` 请尝试将其更改为
`{% if action1 == "manage_companies" %}`

# scala - 如何存储纯scala代码

> ID：11218934
> 
> 赞同：2
> 
> 时间：2012-06-27T03:20:09.803
> 
> 标签：scala, serialization, akka

我想使用纯 scala 代码（没有副作用）作为 akka 演员系统的不可变消息。我应该将scala代码翻译成什么形式？字符串表示是唯一正确的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-27T08:04:05.783

您可以简单地发送一个 scala.FunctionX 作为消息。

```
object Foo {
  val f = (s: String) => s.toInt
}

someActor ! Foo.f 
```

# node.js - Redis 缓存和 Mongo 的持久性架构

> ID：11218941
> 
> 赞同：44
> 
> 时间：2012-06-27T03:20:58.750
> 
> 标签：node.js, mongodb, caching, redis

设置：
想象一个“类似推特”的服务，用户提交一个帖子，然后被许多（数百、数千或更多）用户阅读。

我的问题是关于构建缓存和数据库以优化快速访问和多次读取的最佳方式，但仍保留历史数据，以便用户（如果他们愿意）可以看到较旧的帖子。这里的假设是 90% 的用户只会对新内容感兴趣，并且偶尔会访问旧内容。这里的另一个假设是我们想要优化 90%，如果较旧的 10% 需要更长的时间来检索，那也没关系。

考虑到这一点，我的研究似乎强烈地指向了使用 90% 的缓存的方向，然后还将帖子存储在另一个更长期的持久系统中。所以到目前为止我的想法是使用 Redis 作为缓存。优点是 Redis 速度非常快，而且它内置了 pub/sub，非常适合向多人发布帖子。然后我正在考虑使用 MongoDB 作为更永久的数据存储来存储相同的帖子，这些帖子将在 Redis 过期时被访问。

问题：
1\. 这种架构是否成立？有一个更好的方法吗？
2\. 关于在 Redis 和 MongoDB 中存储帖子的机制，我正在考虑让应用程序执行 2 次写入：第一次 - 写入 Redis，然后立即可供订阅者使用。2nd - 成功存储到 Redis 后，立即写入 MongoDB。这是最好的方法吗？我应该让 Redis 将过期的帖子推送到 MongoDB 本身吗？我想过这个，但是我找不到太多关于直接从 Redis 推送到 MongoDB 的信息。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-06-27T10:02:19.120

将 Redis 和 MongoDB 联系起来其实是明智的：他们是优秀的团队成员。您将在此处找到更多信息：

[带有 redis 的 MongoDB](https://stackoverflow.com/questions/10696463/mongodb-with-redis/10721249#10721249)

一个关键点是您需要的弹性级别。Redis 和 MongoDB 都可以配置为实现可接受的弹性级别，这些注意事项应在设计时讨论。此外，它可能会限制部署选项：如果您想要 Redis 和 MongoDB 的主/从复制，您至少需要 4 个盒子（Redis 和 MongoDB 不应部署在同一台机器上）。

现在，保留 Redis 用于队列、发布/订阅等可能会更简单一些……并且仅将用户数据存储在 MongoDB 中。基本原理是您不必为具有不同范例的两个商店设计相似的数据访问路径（这项工作的困难部分）。此外，MongoDB 具有内置的水平可伸缩性（副本集、自动分片等），而 Redis 仅具有自己动手的可伸缩性。

关于第二个问题，写信给两家商店将是最简单的方法。没有将 Redis 活动复制到 MongoDB 的内置功能。设计一个监听 Redis 队列（将发布活动）并写入 MongoDB 的守护进程并不难。

# java - 如何正常添加用户配置文件变量 %userprofile%

> ID：11218943
> 
> 赞同：2
> 
> 时间：2012-06-27T03:21:16.287
> 
> 标签：java

我需要在 java 中添加一个用户配置文件变量，显然 %userprofile% 不起作用。当我尝试将其输入到代码底部的目录中时，它不接受它。但是我可以在命令行中回显我的 %userprofile%

userprofile+"\Downloads\file.txt");

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-27T03:24:55.573

```
String System.getenv(String var) 
```

所以

```
String userprofile = System.getenv("USERPROFILE"); 
```

然后像 defired 一样操作（例如附加路径的其余部分......）

或者，获取整个环境 `Map<String,String> System.getenv()`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-27T03:36:16.907

您可能正在寻找当前用户的主目录。在 Java 中，您通常通过调用`System.getProperty("user.home")`. 但在 Windows 中，这可能会分配给 %USERPROFILE%，这会使事情变得有点复杂。看到[这个错误](http://bugs.sun.com/view_bug.do?bug_id=4787931)。作为一种解决方法，您可能想要执行 John3136 建议的操作：`System.getenv("USERPROFILE")`但它不能移植到其他环境。

# android - 仅获取 onTouch 事件（Android）

> ID：11218944
> 
> 赞同：1
> 
> 时间：2012-06-27T03:21:23.400
> 
> 标签：android, ontouchlistener

我试图在这里分开一些东西。

我有一个带有 Imagebuttons 的程序。他们附加了 onTouchListeners。

我希望触摸事件仅通过触摸触发，而不是单击触发。我的意思是，例如，如果我使用鼠标单击，我不希望附加到 ImageButton 的 onTouch 事件被触发。但是，当您在按钮上单击鼠标时会触发它。

是否可以在触摸发生时触发事件？

我的代码：

```
myImageButton.setOnTouchListener(new Button.OnTouchListener() {
            @Override
            public boolean onTouch(View v, MotionEvent arg1) {
                 if (arg1.getAction() == android.view.MotionEvent.ACTION_DOWN) {    
                    Toast.makeText(LiVoiceActivity.this,
                                    "You touched me!",
                                    Toast.LENGTH_LONG).show();
                }
                 return true;
            }
    }); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:30:52.070

MotionEvent 类中有一个称为 Tool_Type 的字段。我在这里实现了对鼠标类型的检查：

**API 14 又名简单模式**

```
myImageButton.setOnTouchListener(new Button.OnTouchListener() {
                @Override
                public boolean onTouch(View v, MotionEvent arg1) {
                     if (arg1.getAction() == android.view.MotionEvent.ACTION_DOWN
                              && (MotionEvent.TOOL_TYPE_MOUSE != arg1.getToolType(0)) {    
                        Toast.makeText(LiVoiceActivity.this,
                                        "You touched me!",
                                        Toast.LENGTH_LONG).show();
                    }
                     return true;
                }
        }); 
```

**API 9**

```
myImageButton.setOnTouchListener(new Button.OnTouchListener() {
                @Override
                public boolean onTouch(View v, MotionEvent arg1) {
                     if (arg1.getAction() == android.view.MotionEvent.ACTION_DOWN
                              && (arg1.getSize() > 1) {    
                        Toast.makeText(LiVoiceActivity.this,
                                        "You touched me!",
                                        Toast.LENGTH_LONG).show();
                    }
                     return true;
                }
        }); 
```

现在这会检查收到的 MotionEvent 的大小。据推测，鼠标点击的大小为 1，因此，只能识别大于 1 的大小。玩弄这个数字，看看你是否能区分鼠标和手指触摸。

# java - 内置搜索对话框中的应用程序图标可以点击吗？

> ID：11218951
> 
> 赞同：4
> 
> 时间：2012-06-27T03:22:12.600
> 
> 标签：java, android

当用户单击内置搜索对话框中的应用程序图标时，是否有任何捕捉？请注意，我指的不是自定义对话框，而是 android 内置的搜索对话框。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-03T19:15:21.053

不，没有办法使`SearchDialog`的应用程序图标可点击。

但只是为了好玩，让我们假设存在一些可以完成工作的 hacky 解决方法。酷，我们已经得到了想要的行为......但现在我们有两个问题：

1.  的行为`SearchDialog`与其他 Android 设备不一致。这会降低用户体验，因为用户希望搜索界面在所有 Android 设备上都一样。

2.  您的应用现在使用内部 API，这些 API 在新 SDK 发布时可能保持一致，也可能不一致。如您所知，Android 团队可以将[**应用程序图标`id`**](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/frameworks/base/core/res/res/layout/search_bar.xml)从更改`@+id/search_app_icon`为`@+id/search_home_icon`。您的 hack*取决于*内部 API……因此，此类更改将导致运行您的应用程序的较新设备崩溃（因为任何运行时搜索`search_app_icon`都会返回`null`）。

    此外，三星和 HTC 等公司在向公众发布新设备之前可以自由更改内部 API。下一个三星 Galaxy 可能会完全重新实现`SearchDialog`该类，更新其 UI/主题等……你永远无法确定。

所以基本上，你不能......而且你不应该尝试这样做。

* * *

只是因为我很无聊，这是导致我回答的源代码：

1.  查看 的源代码[`SearchManager.java`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/SearchManager.java)，并注意将`SearchManager`保留`SearchDialog`为私有实例变量[`mSearchDialog`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/SearchManager.java#SearchManager.0mSearchDialog)。

2.  查看 的源代码[`SearchDialog.java`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/SearchDialog.java#SearchDialog.createContentView%28%29)，并注意`SearchDialog`将应用程序图标引用为私有实例变量[`mAppIcon`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/SearchDialog.java#SearchDialog.0mAppIcon)。另请注意，`SearchDialog`通过调用 来初始化变量`findViewById`，如此[处所示](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/app/SearchDialog.java#SearchDialog.createContentView%28%29)。

3.  查看源代码[`search_bar.xml`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/frameworks/base/core/res/res/layout/search_bar.xml)并注意默认情况下`ImageView`未设置为`clickable`。由于公共 SDK 中没有 ( 方法可以改变 this 的行为`View`，因此没有可靠的方法使其可点击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T11:51:32.200

我确信使用 Android 的公共 SDK 是不可能做到这一点的。

我认为唯一的解决方案是编写您自己的自定义对话框，但我担心使用内置对话框您无法做到这一点。

# css - css 背景图片 调整宽度 裁剪高度

> ID：11218952
> 
> 赞同：7
> 
> 时间：2012-06-27T03:22:15.453
> 
> 标签：css

我正在使用 css 提示和技巧中的这段代码来覆盖背景图像。问题在于它会重新缩放图像以适应宽度和高度并改变纵横比。我希望背景图像重新缩放到全屏宽度，然后仅裁剪高度（从图像顶部开始，而不是中心）以覆盖视口。这样，图像纵横比将保持不变。

我遇到的第二个问题是，除非我对图像使用 FQDN 而不仅仅是下面的 url，否则它似乎不起作用。

```
html {
  background: url(images/bg.jpg) no-repeat center center fixed; 
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-27T03:38:16.260

代替

```
background-size: cover; 
```

你会想要使用

```
background-size: 100% auto; 
```

Cover 会将图像拉伸到最小尺寸，使其宽度和高度都可以适合内容区域，因此是您的问题。[在这里](https://developer.mozilla.org/en-US/docs/Web/CSS/background-size)查看更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-27T03:53:19.947

使用时图像纵横比不会改变`cover`。但是，我相信您想要修复图像的底部，因为您告诉过您希望从顶部而不是中心裁剪它，我认为您不想从顶部和底部说。

如果您想将底部保持在底部，（也许是一片可以避免大天空的草原？）那么您需要将位置更改为`center bottom`from `center center`。

如果您按照 Nit 的建议将其设为 100% 自动，那么，在 html 元素的高度/宽度比大于图像的窗口上，您将在顶部看到空白区域，这可能是您想要的，尤其是在您是使用在顶部淡入相同颜色的图像...

对于您的第二个问题，它不是 fqdn，而是您的路径的相对/绝对引用。根据您的 css，您的 css 文件所在的图像文件夹中应该有一个 bg.jpg。

```
index.html
main.css
images/
    bg.jpg 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:46:29.300

我会为此使用 JS。CSS 似乎还不能很好地处理纵横比。

尝试这样的事情：

首先，创建一个 div 并在其中放置一个图像

```
<div class="big-image">
   <img src="path.jpg" width="1000" height="1000" alt="whatever">
</div> 
```

然后在您的 CSS 中执行此操作：

```
.featuredImage img {
  position: fixed;
  top: 0;
  left: 0;
  z-index: -10;
}
/* this class will be added via JS */
.bgwidth { width: 100%; }
.bgheight { height: 100%; } 
```

最后，你的 JS

```
 var theWindow = $(window),
  $bg = $(".big-image img"), // Use your image selector here.
  aspectRatio = $bg.width() / $bg.height();

  $bg.removeAttr('width');
  $bg.removeAttr('height');

  function resizeBg() {
    if ( (theWindow.width() / theWindow.height()) < aspectRatio ) {
      $bg
        .removeClass()
        .addClass('bgheight');
    } else {
      $bg
        .removeClass()
        .addClass('bgwidth');
    }
  }
  theWindow.resize(function() {
    resizeBg();
  }).trigger("resize"); 
```

让我知道这是否有意义。不仅仅是我知道的 CSS，而是一个解决方案

# c++ - 我应该总是在 C++ 中初始化一个类的每个数据成员吗？

> ID：11218955
> 
> 赞同：0
> 
> 时间：2012-06-27T03:22:35.677
> 
> 标签：c++

这是一个好的做法，还是取决于？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T04:13:16.343

唯一不初始化可能有意义的情况是，如果您要在性能关键代码中默认构造大量 POD 对象，然后用有效数据填充它们——例如，如果您要创建一个一百万个对象，然后用有效数据填充数组的对象。在这种情况下，您可能希望避免初始化，因为当您之后只需要再次覆盖它时，将所有内容归零是浪费 CPU 周期。

但是如果你这样做了，一定要在你的类的 .h 文件中放**/* LOTS OF EYE-GRABING COMMENTS */**警告用户你在做什么以及为什么，并在你维护的任何其他程序员的文档中彻底记录它。追踪未初始化值的错误并不是很有趣......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T04:13:50.317

经验法则是一个对象永远不应该以未初始化的状态存在。实现这一点的唯一方法是在构造过程中初始化所有成员变量。处于未初始化状态和无效状态的对象是有区别的。当成员变量在构造过程中未初始化对象时，会出现未初始化状态。由于变量可能包含未知值，任何依赖它们的成员函数可能会间歇性地表现不同。无效状态将变量初始化为默认值，提供一些期望对象在构造后始终表现相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:32:25.457

在书中：Andrew Koenig 和 Barbara Moo 的“Ruminations on C++”，第 4 章

每个 ctor 都需要初始化每个数据成员吗？并非总是如此，有时您的数据成员在您的对象存在一段时间时才有意义，这真的取决于。

我的书不是英文原版，所以我翻译了一下。如果您想了解更多，请阅读整个第 4 章：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T04:31:18.807

永远不要说总是。

初始化每个数据成员是一个非常非常好的做法。但有时，在非常特殊的情况下，如果您要创建大量对象，您可能需要跳过一些初始化 - 这将花费比您想要的更多的 CPU 周期 - 您稍后会初始化它们，您可以保证在初始化之前不会使用任何数据成员。

# php - 为什么变量说未定义？

> ID：11218965
> 
> 赞同：2
> 
> 时间：2012-06-27T03:24:02.477
> 
> 标签：php, variables, undefined

这表示 $total 和 $sub 对于 $total += $sub 是未定义的。$sub 是在 while 循环中声明的，并且两个 $sub 都在函数内，所以它应该是一个局部变量。为什么我不能使用它？

```
public function cart() {
    foreach($_SESSION as $name=>$value){
        if (substr($name, 0, 5) == 'cart_') {
            if((int)$value > 0){
                $id = substr($name, 5, (strlen($name)-5));

                $st = $this->db->prepare("select id, name, price from deals where id=?");
                $st->bindParam(1, $id);
                $st->execute();

                while($cart_item = $st->fetch(PDO::FETCH_OBJ)){
                    $sub = $cart_item->price*$value;
                    echo $cart_item->name.' x '.$value.' @ '.$cart_item->price.' = '.$sub.' <a href="cart.php?add='.$id.'">[+]</a> <a href="cart.php?remove='.$id.'">[-]</a> <a href="cart.php?delete='.$id.'">[Delete]</a><br/>';
                }
            }
        }
        $total += $sub;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:27:10.907

如果有的话就会有问题

```
 $st = $this->db->prepare("select id, name, price from deals where id=?");
            $st->bindParam(1, $id);
            $st->execute(); 
```

返回 0 个结果。

定义`$sub`之前`foreach`和安全，`$total`以及：

```
$sub = $total = 0;
foreach(...) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:25:50.997

未定义的变量是 $total，而不是 $sub。添加 $total=0; 到你的函数的顶部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-27T03:26:41.007

您从未初始化 $total，因此出现错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-27T03:28:43.523

该`$total`变量应在您的`foreach`. 该`$sub`变量应`foreach`在顶部的 , 内初始化。

```
$total = 0;
foreach ($_SESSION as $name => $value) {
    $sub = 0;
    ... 
```

此外，您可以向上移动更高的位置，使其位于内部循环`$total += $sub;`的正下方。`while`

# android - search.h-在 Android-tiff 4.0.1 上移植 libtiff 时没有这样的文件或目录

> ID：11218967
> 
> 赞同：5
> 
> 时间：2012-06-27T03:24:18.250
> 
> 标签：android, linux, ubuntu, tiff, libtiff

我正在尝试在 Android 上移植 libtiff。我使用的源版本是 tiff 4.0.1。我正在 u1 android OS 中构建这个源代码。当我运行 mmm external/tiff 4.0.1/ 时出现以下错误

```
In file included from external/tiff-4.0.1/libtiff/tiffiop.h:33,
                 from external/tiff-4.0.1/libtiff/tif_dirread.c:42:
external/tiff-4.0.1/libtiff/tif_config.h:93:1: warning: "HAVE_MALLOC_H" redefined
In file included from <command-line>:0:
./system/core/include/arch/linux-arm/AndroidConfig.h:221:1: warning: this is the location of the previous definition
In file included from external/tiff-4.0.1/libtiff/tif_dirread.c:42:
external/tiff-4.0.1/libtiff/tiffiop.h:54:21: error: search.h: No such file or directory 
```

我尝试在互联网上搜索很多但无法解决问题。谁能给我一个大概的想法可能是什么问题或缺少哪个包。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-27T11:44:53.433

我终于解决了这个问题。我希望这对将来从事这项工作的人有所帮助。我们只需要从 libtiff/tiffiop.h 中删除引用头文件的行。这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-22T10:11:20.437

根据您的 libtiff 版本，您还可以在配置文件*tif_config.h*中取消定义 HAVE_SEARCH_H ，然后将不再包括`<search.h>`：

在*tif_config.h 中*：

```
#ifndef ANDROID
/* Define to 1 if you have the <search.h> header file. */
#define HAVE_SEARCH_H 1
#endif 
```

# python - 自定义 python 模块中的分层命名空间

> ID：11218968
> 
> 赞同：3
> 
> 时间：2012-06-27T03:24:22.557
> 
> 标签：python, module, namespaces

尝试搜索该站点，但找不到我的问题的答案：

假设我有一个名为 mymodule.py 的模块，其中包含：

```
def a():
    return 3

def b():
    return 4 + a() 
```

然后以下工作：

```
import mymodule
print(mymodule.b()) 
```

但是，当我尝试动态定义模块内容时：

```
import imp

my_code = '''
def a():
    return 3

def b():
    return 4 + a()
'''

mymodule = imp.new_module('mymodule')
exec(my_code, globals(), mymodule.__dict__)
print(mymodule.b()) 
```

然后它在函数 b() 中失败：

```
Traceback (most recent call last):
File "", line 13, in <module>
File "", line 6, in b
NameError: global name 'a' is not defined 
```

我需要一种方法来保留模块中的分层命名空间搜索，除非模块驻留在磁盘上，否则这似乎会失败。

关于有什么区别的任何线索？

谢谢，罗伯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T03:59:02.237

你很近。您需要告诉 exec 像这样在不同的命名空间中工作（参见 python 3.x 底部的注释）：

```
exec my_code in mymodule.__dict__ 
```

完整示例：

```
import imp

my_code = '''
def a():
    return 3

def b():
    return 4 + a()
'''

mymodule = imp.new_module('mymodule')

exec my_code in mymodule.__dict__
print(mymodule.b()) 
```

这就是说，我以前没有使用过这个，所以我不确定这是否有任何奇怪的副作用，但它看起来对我有用。

此外，这里的 python 文档中有一个关于 'exec in ...' 的简短说明：http: [//docs.python.org/reference/simple_stmts.html#the-exec-statement](http://docs.python.org/reference/simple_stmts.html#the-exec-statement)

**更新**

您最初的尝试无法正常工作的原因是您传递了*当前*模块的 globals() 字典，该字典与新模块应使用的 globals() 不同。

这条 exec 行也有效（但不如 'exec in ...' 风格漂亮）：

```
exec(my_code, mymodule.__dict__, mymodule.__dict__) 
```

**更新 2：**由于 exec 现在是 python 3.x 中的一个函数，它没有 'exec in ...' 样式，所以必须使用上面的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T03:45:25.083

这不是`exec()`设计使用的方式。`exec()`实际上并没有将它运行的代码“放入”任何模块 - 它在`exec()`从中调用的模块空间中运行它。

# php - 解析错误：语法错误，意外的 T_ELSE，我不知道为什么

> ID：11218975
> 
> 赞同：2
> 
> 时间：2012-06-27T03:25:18.110
> 
> 标签：php

这是我的php代码：

```
<?php if($user->uid == '1'){ ?>
    <h3 class="info">Upcoming Games</h3>    <!--MY CHANGE -from Athletics Events -->
    <?php } ?>
    <?php else { ?> <h3 class="info">Athletic Events</h3>     <?php }?> 
```

为什么我会收到此错误？我有我需要的所有括号，不是吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-27T03:33:34.830

和不能以您拥有的方式与 PHP 标记分开`}`。`else {`把它想象成你正在尝试做的事情：

```
<?php
if($some_condition) {
    //do something
}
echo '     ';
else {
    //something else
} 
```

这会给你一个解析错误。因为您要关闭 PHP 标记，然后有效地输出空格，然后重新打开，所以您的代码的行为与此类似。如果你也要做同样的事情，这同样适用`<?php }?><?php else {?>`，只是它的行为就像你`echo '';`在两者之间做的那样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-27T03:35:01.010

一种更清洁且不易出错的方法是使用`:`

```
<?php if($user->uid == '1'): ?>
<h3 class="info">Upcoming Games</h3>    <!--MY CHANGE -from Athletics Events -->

<?php else: ?>
<h3 class="info">Athletic Events</h3>     

<?php endif; ?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-27T03:30:20.730

像这样重写，让我们看看

```
<?php if($user->uid == '1'){ ?>
   <h3 class="info">Upcoming Games</h3>    <!--MY CHANGE -from Athletics Events -->
<?php 
   } else { 
 ?>
   <h3 class="info">Athletic Events</h3>     
<?php 
   }
?> 
```

**这也有效**

```
<?php if($user == '1'){ ?>
<h3 class="info">Upcoming Games</h3>    <!--MY CHANGE -from Athletics Events -->
<?php } else ?>
<?php  { ?> <h3 class="info">Athletic Events</h3>     <?php }?> 
```

那是您的代码的副本，但是`else`向上移动了。所以很明显`else`不应该在一开始

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-27T03:31:31.090

像这样试试

```
<?php if($user->uid == '1'){ ?>
    <h3 class="info">Upcoming Games</h3>    <!--MY CHANGE -from Athletics Events -->
    <?php } else { ?> <h3 class="info">Athletic Events</h3>     <?php }?> 
```

# javascript - AIR HTMLLoader window.open 不起作用

> ID：11218978
> 
> 赞同：1
> 
> 时间：2012-06-27T03:25:32.910
> 
> 标签：javascript, actionscript-3, air

我有一个用 Flex 开发的 web 项目，我必须使用 AIR 独立工作。

我创建了 Air 项目并使用 flash.html.HTMLLoader 加载了 Web 应用程序。内容加载正常且工作正常。

有几个按钮可以使用 javascript 函数 window.open 打开不同的链接。

链接打不开。使用 ExternalInterface 调用 javascript 函数，我在显示的内容中放置了警报。

该函数包含简单的 window.open

```
window.open("http://www.google.co.in","Google"); 
```

我尝试了几种提到的解决方案，但都没有奏效。

```
http://digitaldumptruck.jotabout.com/?p=672
http://soenkerohde.com/2008/09/air-html-with-_blank-links/
http://cookbooks.adobe.com/index.cfm?event=showdetails&postId=9243 
```

我什至尝试使用 window.open 方法在 HTMLLoader 组件中加载一个简单的页面，但它仍然无法正常工作。在按钮单击时，仅警报有效，但 window.open 未打开链接。

```
<html>
<head>
<title>Test</title>
<body scroll="no">
<input type="button" value="Click" onClick="window.open('http://www.google.co.in');">
</body>
</html> 
```

有人可以帮我吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T05:24:48.723

`window.open`AIR Webkit 环境对该方法的支持非常严格。[请参阅有关调用 JavaScript window.open() 方法的限制的](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118666ade46-7f11.html#WS5b3ccc516d4fbf351e63e3d118666ade46-7e91)Adob​​e 文档。

处理这个问题的最简单方法就是让系统的默认浏览器打开链接。[Adobe 记录了这个问题](http://help.adobe.com/en_US/air/html/dev/WS5b3ccc516d4fbf351e63e3d118666ade46-7cba.html)，并展示了如何从 AIR 中弹出打开的 url：

```
var url = "http://www.adobe.com"; 
var urlReq = new air.URLRequest(url); 
air.navigateToURL(urlReq); 
```

概括这一点：

```
function openExternalLink(href:String):void {
  var urlReq = new air.URLRequest(href);
  air.navigateToURL(urlReq);
} 
```

一种选择：假设您在页面上运行 jQuery，您可以在外部打开所有链接，如下所示：

```
var html:HTMLLoader = new HTMLLoader(); 
var urlReq:URLRequest = new URLRequest("whatever.html"); 
html.load(urlReq); 
html.addEventListener(Event.COMPLETE,
  function completeHandler(event:Event):void { 
    html.window.jQuery('a').click(clickHandler); 
  });

function clickHandler( e:Object ):void { 
  if (e.target && e.target.href) {
    openExternalLink(e.target.href);
  }
  e.preventDefault();
} 
```

有关在 ActionScript 中处理 DOM 事件的更多信息，请参阅[相关的 Adob​​e 文档](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118666ade46-7ecf.html#WS5b3ccc516d4fbf351e63e3d118666ade46-7e84)。

这些都没有经过测试，但希望它给出一个粗略的轮廓。

* * *

否则，如果你想做一些花哨的事情，比如弹出带有 HTMLLoader 框架的 AIR 窗口，我确实找到了一篇博客文章讨论这个问题：[Open links in AIR's HTML loader](http://digitaldumptruck.jotabout.com/?p=672)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-27T17:26:14.710

这是一个激进的建议，可能有效，也可能无效，但我认为值得一试。

**覆盖`window.open`方法本身**

和以前一样，等到`Event.COMPLETE`被解雇，然后从那里拿走它：

```
var html:HTMLLoader = new HTMLLoader();
var urlReq:URLRequest = new URLRequest("whatever.html");
var oldWindowOpen:Object; // save it, just in case

html.load(urlReq);

html.addEventListener(Event.COMPLETE,
  function (event:Event):void {
    oldWindowOpen = html.window.open;

    html.window.open = asWindowOpen;
  });

function asWindowOpen(href:String, name:String="_blank", specs:Object=null, replace:Object=null):void { 
  var urlReq = new air.URLRequest(href); 
  air.navigateToURL(urlReq);
} 
```

您可能应该填写一些函数来处理[W3Schools Reference for Window open() Method](http://www.w3schools.com/jsref/met_win_open.asp)中指定的其他输入。为了安全起见，您可能必须（或想要）将所有参数类型更改为`Object`，因为与 ExternalInterface 交互不同，JavaScript-ActionScript 类型不会在 AIR-WebKit 交换中自动进行类型转换。

# ruby - 将 ruby 数组的元素转换为字符串

> ID：11218983
> 
> 赞同：2
> 
> 时间：2012-06-27T03:26:16.420
> 
> 标签：ruby

我得到一个包含单个元素的数组，`["http://i.foobar.com/This-Is-The-Remainder-Of-The-Link.jpg"]`我试图将它呈现为只是显示图像的 URL。对最好的方法有什么想法吗？目前，当我用 HTML 渲染它时，我得到了`[&quot;http://i.foobar.com/This-Is-The-Remainder-Of-The-Link.jpg&quot;]`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-27T04:02:08.833

您应该能够拉出第一个元素。您可以通过执行以下操作来做到这一点。

```
a = ['http://someurl.com/somepath']
a.first 
```

或者

```
a = ['http://someurl.com/somepath']
a[0] 
```

# jquery - 如何跟踪传递给其他网页的 id？

> ID：11218984
> 
> 赞同：-3
> 
> 时间：2012-06-27T03:26:21.063
> 
> 标签：jquery

我对html和js相当陌生。假设我在 index.html 中有以下代码：

```
<a href='edit.html?id=1>item1</a>
<a href='edit.html?id=2>item2</a>
<a href='edit.html?id=3>item3</a> 
```

然后我创建了一个名为 edit.html 的页面，但是如何使用 jquery 或 js 跟踪传递给 edit.html 的 id（1 或 2 或 3）？

请帮忙..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T03:28:34.353

```
function getId() {
    var href = window.location.href,
        id = href.substr( href.indexOf('?') + 1 ).replace('id=',''); // 1, 2 , 3..
    return id;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T03:28:45.827

您传递的参数称为查询字符串。有关如何检索它们，请参阅有关堆栈溢出的此答案

代码：

```
function getParameterByName(name)
{
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(window.location.search);
  if(results == null) 
    return "";
  else
    return decodeURIComponent(results[1].replace(/\+/g, " "));
} 
```

信用：

[如何在 JavaScript 中获取查询字符串值？](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-27T03:29:13.893

你想在页面edit.html上用jQuery获取查询字符串吗？

请参阅：[如何在 JavaScript 中获取查询字符串值？](https://stackoverflow.com/questions/901115/get-query-string-values-in-javascript)

```
function getParameterByName(name)
{
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(window.location.search);
  if(results == null)
    return "";
  else
    return decodeURIComponent(results[1].replace(/\+/g, " "));
} 
```

在edit.html上：`getParameterByName('id');`

# asp.net-mvc - mvc 正则表达式验证数字为 00-99

> ID：11218985
> 
> 赞同：0
> 
> 时间：2012-06-27T03:26:23.290
> 
> 标签：asp.net-mvc

我正在研究 asp.net mvc3，我想要一个特殊要求，即 mvc 验证使用 0-99 之间的数字，以便我将正则表达式作为

[RegularExpression("[0-9]{1,2}$")]

现在我想要一个特殊的要求，如果输入为 01,02,....,09，0-9 中的数字必须通过验证，而 10-99 之间的其余数字应该作为两位数通过验证.

请帮我解决这个正则表达式。我已经用谷歌搜索但无济于事。

任何人都可以为这种类型建议一个正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T03:30:18.510

只是匹配

```
"[0-9][0-9]" 
```

应该完全符合您的要求。仅当单个数字以 01 的形式输入时才匹配；02; 03 等并匹配所有两位数

# android - 如何使用 GPG 制作的私钥签署 apk？

> ID：11218998
> 
> 赞同：6
> 
> 时间：2012-06-27T03:28:16.283
> 
> 标签：android, gnupg, jarsigner

这甚至可能吗？我有一个我已经用 GPG 制作的密钥对，但我找不到用那个密钥对其进行签名的方法。我真的不想用 keytool 或其他任何东西制作一个新密钥；我宁愿使用我现在拥有的密钥。有人知道我该怎么做吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-27T04:38:33.970

我非常怀疑 GPG 会生成 jarsigner 可以使用的密钥。*可能*可以编写一个转换器来执行此操作，但硬着头皮生成新密钥的工作要少得多。执行此操作的命令很简单

```
keytool -genkey -alias mynickname -validity 20000 -keystore ~/.android/my-keystore 
```

（ps对密钥进行备份，并确保您不会忘记密钥库密码或密钥密码。关于将应用程序投放市场然后忘记或丢失密码的人的悲伤故事太多了.)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-14T10:46:59.410

我也只想管理 OpenPGP 密钥。所以这是我的方式。

## 打开pgp2ssh

首先从monkeysphere安装它。

```
sudo apt install monkeysphere 
```

注意：`openpgp2ssh`仅当密钥不受密码保护和 RSA 密钥时才有效。因此，可能有必要删除保护。

现在，导出 PGP 密钥并将其交给 openpgp2ssh：

```
gpg --list-keys # show your keys with keyid.
gpg --export-secret-subkeys your@email | openpgp2ssh $SubKeyId > id_rsa
openssl rsa -in id_rsa -outform pem > key.pem
openssl req -new -key key.pem -out request.pem
openssl x509 -req -days 9999 -in request.pem -signkey key.pem -out certificate.pem
openssl pkcs8 -topk8 -outform DER -in key.pem -inform PEM -out key.pk8 -nocrypt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-11T13:44:47.933

您确实需要使用 jarsigner 签名。但是 jarsigner 实际上比你想象的要灵活一点。如果您已经有要使用的签名密钥，则可以将其从 gpg 导出并将其导入 java 密钥库，然后以这种方式签名。[如果您想尝试这样做，您可以尝试 keytool 但获取Keytool Explorer](https://sourceforge.net/projects/keystore-explorer/)要容易得多， 因为 keytool 有很多选项。

Jarsigner 实际上非常灵活。 [本文档](https://docs.oracle.com/javase/8/docs/technotes/guides/security/p11guide.html)描述了您可以创建自己的提供程序的过程。我很惊讶还没有一个使用 GPG 密钥库的人。 [有一种使用 Yubikey 的方法，](https://developers.yubico.com/PIV/Guides/Android_code_signing.html)这是我知道所有这些的唯一原因 - 我的签名密钥被安全地锁定在我的 yubikey 中，即使我无法获得它们（是的，我在某处有安全备份） .