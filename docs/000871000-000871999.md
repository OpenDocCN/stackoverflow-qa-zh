# StackOverflow 问答 000871000-000871999

# svn - 颠覆.tmpl

> ID：871006
> 
> 赞同：0
> 
> 时间：2009-05-15T21:49:39.913
> 
> 标签：svn

好的，这是我对钩子的疑问。.tmpl 是否打算在 hooks 文件夹中的非 Windows PC 上运行，并且您必须创建自己的 .bat 文件才能在 Windows 上运行用于 subversion 的挂钩？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T21:56:07.603

是的，您可以将 .tmpl 重命名为 .bat。挂钩脚本需要在 Windows 中可执行。您也可以提供 .exe 文件。

示例脚本非常基本，不会造成太大麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T21:55:29.323

是的..`.tmpl`文件是样本。你将不得不在窗户下滚动你自己的。不过，我建议在批处理文件上使用 Perl 或 Python 之类的东西。

# ajax - Ajax 调用中的异常处理

> ID：871007
> 
> 赞同：2
> 
> 时间：2009-05-15T21:49:40.443
> 
> 标签：ajax, exception, exception-handling, error-handling

我有一个使用大量 AJAX 请求的应用程序（通过 XHR 请求触发不同的操作）。其中一些调用可能会导致异常。每次我必须向用户显示一条错误消息。在这种情况下如何组织错误处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T21:56:07.777

我可以建议您使用 jQuery 之类的东西吗？他们已经把你所有的艰难思考都带走了。他们在我们和多个浏览器之间添加了一个很好的层。他们 99% 的时间都做对了。无论如何，您可以非常简单地进行 ajax 调用：

```
jQuery.ajax({
    type: "POST",
    url: "saveuser.do",
    dataType:"html",
    success:function(response){},
    error:function (){
      alert("error");
    }
}); 
```

抱歉，如果语法不是 100%，请从内存中执行

# postgresql - 从 PostgreSQL 中的存储过程中获取返回值

> ID：871008
> 
> 赞同：0
> 
> 时间：2009-05-15T21:49:58.040
> 
> 标签：postgresql, stored-procedures, ado.net, plpgsql

我在 PostgreSQL 中有一个存储过程：

```
CREATE OR REPLACE FUNCTION dosmth()
RETURNS boolean AS
$BODY$
BEGIN

RETURN FALSE;

 END;
 $BODY$
 LANGUAGE 'plpgsql' VOLATILE 
```

从 ado.net 我需要检索返回值。我尝试执行以下操作：

```
 DbCommand cmd = DBTemplate.CreateStoredProcedureCommand(dbConnection, "dosmth");

   cmd.Parameters.Add(DBTemplate.CreateParameter(System.Data.DbType.Boolean,
                "@RETURN_VALUE", System.Data.ParameterDirection.ReturnValue));

   DBTemplate.ExecuteNonQuery(cmd);
   Boolean bl = Convert.ToBoolean(cmd.Parameters["@RETURN_VALUE"].Value); 
```

不幸的是，这不起作用告诉我该类型`DBNull`无法转换为`Boolean`.
有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T22:35:02.050

尝试使用`ExecuteScalar`而不是`ExecuteNonQuery`. 我似乎记得那`ExecuteNonQuery`也不`return`是结果。

# ruby-on-rails - 使用 Git 在 Rails 上跟踪 Ruby

> ID：871010
> 
> 赞同：1
> 
> 时间：2009-05-15T21:51:03.530
> 
> 标签：ruby-on-rails, git, version-control

除了数据库和日志文件之外，出于安全原因，还有其他文件不应该在存储库中吗？

该项目将主要由我自己完成，但是代码将存储在共享存储库中，如果他们想从中提取，其他一些用户也可以使用该存储库。该项目相当简单，因此我不太担心实际代码中的安全性 - 这更多是为了保护任何测试数据等并在此类项目中建立“良好实践”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T21:57:08.227

“ruby on rails”上下文中的典型`.gitignore`文件可能类似于：

```
config/database.yml  
db/*.sqlite3
log/*.log
log/*.pid
tmp/**/*" 
```

[但是，正如文章“ rorgitignore : .gitignore files specific for Ruby on Rails](http://rha7dotcom.blogspot.com/2008/08/rorgitignore.html) ”所指出的，您也可以使用`.gitignore`添加空目录。

> 因为 git 跟踪的是内容，而不是文件，所以它不会保存任何空目录，因为没有要跟踪的内容。
> 
> 这意味着当您从存储库克隆项目时`git`，它缺少`log`、`tmp`和`lib`其他目录。
> 
> 这个小脚本解决了这个问题，因此`git`甚至添加了空目录

```
for DIR in `find . -type d | sed -re 's/\.\///g' | grep -v '^\.git'`; do
    [ `ls -a $DIR | wc -l` -le 2 ] && \
    echo Creating and git-adding $DIR/.gitignore && \
    touch $DIR/.gitignore && \
    git add -f $DIR/.gitignore
done 
```

> 这只是输出命令以将空`.gitignore`文件添加到`git`项目中的所有空目录并将它们添加`git add -f`到 repo。

* * *

如果您仍然只关注主 .gitignore 文件，这里有一个更完整的文件，来自[iCoreTech Research Labs](http://www.icoretech.org/2008/07/24/my-rails-gitignore)

```
config/database.yml
*~
*.cache
*.log
*.pid
tmp/**/*
.DS\_Store
db/cstore/**
doc/api
doc/app
doc/plugins
coverage/*
db/*.sqlite3
*.tmproj
Capfile 
```

# vb.net - 从 VB.Net 应用程序复制到 excel 在某些环境中会导致 0x800A03EC 错误

> ID：871012
> 
> 赞同：1
> 
> 时间：2009-05-15T21:53:16.300
> 
> 标签：vb.net, excel, ms-office

这是错误：

System.Runtime.InteropServices.COMException，粘贴，来自 HRESULT 的异常：0x800A03EC

所有机器都是 Windows XP 和相同版本的 Excel (2003)。有些机器得到错误，有些没有。我们还没有找到模式。

这是代码：

```
Public Shared Sub ExportToExcel(ByVal dt As System.Data.DataTable)
        Dim app As New Microsoft.Office.Interop.Excel.Application
        app.Visible = False
        Dim Book = app.Workbooks.Add
        Try
            Dim Sheet = CType(Book.Worksheets(1), Microsoft.Office.Interop.Excel.Worksheet)
            With Sheet
                Dim c As Long = Asc("A")
                For Each dc As DataColumn In dt.Columns
                    .Range(Chr(CInt(c)) & "1").Value = dc.ColumnName.ToString
                    .Range(Chr(CInt(c)) & "1").Font.Bold = True
                    c += 1
                Next

                Sheet.Activate()
                Sheet.Range("A2:A2").Select()
                Sheet.Paste()
                .Columns.AutoFit()
                CType(app.ActiveWorkbook.Sheets(2), Microsoft.Office.Interop.Excel.Worksheet).Delete() 
                CType(app.ActiveWorkbook.Sheets(2), Microsoft.Office.Interop.Excel.Worksheet).Delete()
            End With
            app.Visible = True
            app.UserControl = True
        Catch ex As Exception
            ExceptionManager.HandledException(ex, "Unable to Copy to Excel.", "You are SOL", , False)
        Finally
            Book = Nothing
            System.Runtime.InteropServices.Marshal.ReleaseComObject(app)
            app = Nothing
            GC.Collect()
            GC.WaitForPendingFinalizers()
        End Try

    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T23:26:32.053

COM 是引用计数的。系统会为您每次使用的东西保留一个计数器，因此您应该在退出之前清理这些引用，如下所示：

```
Marshal.ReleaseComObject(myVaraible); 
```

您可能不需要 WaitForPendingFinalizers，即使 GC.Collect 也是一个昂贵的调用，如果您使用上面的代码释放每个 com 对象以降低引用计数，则不需要它。

此外，我不确定您是否使用主互操作程序集，但您需要确保针对您的目标 Excel 版本使用它们的正确版本，否则您可能会遇到错误，例如您遇到的错误。

# cookies - 如何在 c# 中向文本模式设置为“密码”的文本框显示值

> ID：871025
> 
> 赞同：1
> 
> 时间：2009-05-15T21:56:41.940
> 
> 标签：cookies

下面给出的代码是通过cookie检查用户名n显示密码。它工作得很好。因为我希望密码.text 中显示的值被屏蔽，所以我将 password.text 的文本模式更改为“密码”。结果值没有传递给文本框。

我该如何解决这个问题？

```
 String cookiename = TextBox1.Text;

        //grab cookie
        HttpCookie cookie = Request.Cookies[cookiename];

        //exists?
        if (null == cookie)
        {
            Label1.Text = "cookie not found";
        }
        else 
        { 
            password.Text=cookie.Value.ToString();

        } 
```

谢谢你，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T22:32:22.930

TextBox2.Attributes.Add("值", cookie.Value.ToString());

# .net - vb.net 树视图中的 cmd 提示

> ID：871026
> 
> 赞同：0
> 
> 时间：2009-05-15T21:56:44.747
> 
> 标签：.net, treeview

我正在构建一个自定义资源管理器树视图，它只有我的代码存储库、我的 Visual Studio 项目文件夹和其他类似的东西，以便快速访问，并可能最终进行动态版本比较。我希望能够右键单击此资源管理器中的文件夹并在此处获得 cmd.exe 提示，就像在带有 powertoy 的 Windows 资源管理器中一样。有任何想法吗？cmd.exe /k 打开一个提示并使其保持打开状态，但我找不到任何标志或文本可以通过管道输入它以从特定驱动器或文件夹开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:06:28.907

似乎应该有另一种方法可以做到这一点，但您可以将要作为命令行参数执行的命令传递给 cmd：

```
cmd /k "cd c:\myDirectory" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T22:10:14.013

您只需要设置工作目录：

```
Dim psi As New ProcessStartInfo("c:\Windows\System32\cmd.exe", "/k")
psi.WorkingDirectory = "<path of the selected directory>"
Process.Start(psi) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T22:04:29.317

尝试将 treenode 的 tag 属性设置为包含整个文件夹路径。

然后，您可以轻松构建打开命令提示符窗口以注入正确文件位置的代码。这也将允许您轻松地动态添加/编辑节点。

# user-interface - 键/值属性框用户友好吗？

> ID：871035
> 
> 赞同：0
> 
> 时间：2009-05-15T21:58:58.800
> 
> 标签：user-interface, properties, usability

假设我有一个带有可笑的糟糕 GUI 设置屏幕的应用程序。我可以满足我需要的 90% 的属性，让用户使用其中一个看起来像的框进行设置

```
·····················································································································
▪高度 ▪ 1.3 英寸 ▪
▪宽度 ▪ 3.0英寸 ▪
▪顶部 ▪ 3.2 英寸 ▪
▪左 ▪ 2.3 英寸 ▪
▪标题 ▪ '真棒'▪
▪订单 ▪ 第三 ▪
·····················································································································

```

但是，这些真的很好而且有用吗，还是我只是假设它们是因为作为程序员我一直在我的 IDE 中使用它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:16:03.610

使其更加用户友好的一个关键项目是类别。正如 Oddthinking 在他的回复中指出的那样，四五个项目是正确的。

虽然，只要您非常简洁和仔细地对它们进行分组，您就可以逃脱更多。例如，高度和宽度可以而且应该组合在一起，因为每当用户指定一个时，他们就被用来指定另一个。

如果您的类别布局非常好并且其中只有四到五个项目，那么您的设置屏幕可以包含更多选项而不会显得混乱，因为标题会告诉他们在他们尝试之前他们需要什么样的信息部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T22:02:26.980

这实际上将取决于正在创建的应用程序的类型以及访问它的用户类型。

如果它们是技术类型并且对应用程序进行了一些分析，我可以看到它非常适合。如果应用程序更面向操作或工作流，我不确定这是否适合。

同样，这一切都取决于最终用户的最高生产力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T22:03:38.803

理想情况下，您将拥有良好的默认值，因此用户无需更改任何内容……但如果这是不可避免的，并且您对此很聪明，我认为可以做到。

一些提示：

*   将它们分解为类别（“用户界面”、“数据库”、“文件格式”或其他）
*   首先放置最相关的选项
*   记录每一个设置：除非它真的非常明显（对于不是开发人员的人），包括一两句话来描述它的作用。
*   例子真的很好
*   描述哪些值是可接受的（在过去，我已经包含了用于验证设置的正则表达式......但这是针对技术受众的）

您可能无法使用默认控件执行此操作……所以请自己编写。这需要一些时间，但恕我直言，这是值得的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T22:08:03.520

这里的属性数量是一个相关因素。

我的直觉是，四五个可能是可以原谅的。七可能正在推动它。

我的经验是，当它达到几十或几百时，它变得不可行。人们不再能够简单地阅读所有条目以找到他们想要的功能，而无需从经验丰富的用户传递给经验丰富的用户的秘诀。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T22:12:16.957

作为主要的用户，我有时会在带有配置屏幕的应用程序中使用它们，但是在使用一定数量（通常大约 5 或 6 个）之后，我开始觉得程序制作得很糟糕。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T22:12:54.087

你骑什么样的自行车？单速巡洋舰？简单的！有 6 个齿轮的旧 10 速旧车能用吗？基本可以用。21 速需要高于平均水平的技能，然后大多数人使用一个子集。80速？嗯。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T04:34:21.220

它当然可以使用。

对于简单的概念来说就足够了。我发现我经常试图让用户输入他不理解的内容。有时，这是我不理解的数据。

然后我觉得很好地理解你的数据到底代表什么是非常重要的，然后不是要求一个数字表，而是找到一种方法来告诉你的用户他正在输入什么，同时他正在输入它。

例如，在您给出的非常简单的示例中（假设它很复杂），您实际上可以在屏幕上显示一个框的图片以及数据。当您输入数据时，框可能会稍微移动或明显调整自身大小。

然后，您可以通过允许他们拖动框的边缘并让拖动更新字段来进一步实现这一点。

虽然这是一个简单的例子，无法保证这种努力，但我已经取得了很多成功——例如，设置一个电路，您必须在 DS1 或 T1 中的一组 DS0 中包含一个 DS0 OC-3 中的 T1 束，位于光纤环路的 3 个通道之一上。

它实际上比这要复杂得多，一旦他们弄清楚我在问什么，就需要 10 名工程师 2 天的时间才能正确记录。有一次，我们有 4 个充满排列的白板，然后我们将它们重构为一张（非常拥挤的）纸。

一旦我能理解这一点，我就为它制作了一个很棒的用户界面。

而且那张纸本身也变成了一份营销文件——他们以前从未描述过他们的盒子实际上做了什么（这正是他们的营销经理在查看该文件时所说的）。

所以较短的外卖版本：对于任何不明显的事情，尝试全面分析和理解您向客户展示/请求客户的数据背后的业务问题。当你摸索它时，找出导致突破的确切原因并将其变成一个 GUI。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T22:01:47.653

通过对细节的大量关注，您可以使其可用。但是，如果您有许多嵌套对象，它很快就会变得笨拙。我会看一下您当前 GUI 的重新设计。截图怎么样？

# python - Django：覆盖自定义表单的 __init__

> ID：871037
> 
> 赞同：26
> 
> 时间：2009-05-15T22:00:04.927
> 
> 标签：python, django

我正在 Django 中创建一个自定义表单对象，它有一个重写的 __init__ 方法。重写该方法的目的是根据新参数动态生成下拉框。

例如，

```
class TicketForm(forms.Form):
    Type = Type.GetTicketTypeField()

    def __init__(self, data=None, files=None, auto_id='id_%s', prefix=None,
                  initial=None, label_suffix=':', empty_permitted=False, 
                  ticket=None):

        if ticket:
           self.__class__.State = State.GetTicketStateField(ticket.Type)
           super(forms.BaseForm, self ).__init__(data=data, files=files, 
                  auto_id=auto_id, prefix=prefix, initial=initial, 
                  label_suffix=label_suffix, empty_permitted=empty_permitted) 
```

此解决方案不起作用。似乎这些字段是在调用 __init__ 之前创建的。我认为这个问题会很常见。处理这些问题的 Django 方式是什么。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-15T22:13:03.633

您可以使用`self.fields`dict 动态修改表单。这样的事情可能对你有用：

```
class TicketForm(forms.Form):

  Type = Type.GetTicketTypeField()

  def __init__(self, ticket, *args, **kwargs):
    super(TicketForm, self).__init__(*args, **kwargs)
    self.fields['state'] = State.GetTicketStateField(ticket.Type) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-15T22:14:05.783

我在[这里](http://www.b-list.org/weblog/2008/nov/09/dynamic-forms/)找到了解决方案。如果有更好的解决方案，请回复。

```
class TicketForm(forms.Form):
    Type = Type.GetTicketTypeField()

    def __init__(self, ticket=None, *args, **kwargs):   
        super(TicketForm, self ).__init__(*args, **kwargs)
        if ticket:
            self.fields['State'] = State.GetTicketStateField(ticket.Type) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-02-07T22:51:58.617

不要修改`__init__()`参数。您可能会破坏与 Django 未来版本的兼容性，并使您的代码更难维护。

我建议使用`kwargs`来传递你的变量。

```
class TicketForm(forms.Form):
    type = Type.GetTicketTypeField()

    def __init__(self, *args, **kwargs):
        ticket = kwargs.pop('ticket')
        super().__init__(*args, **kwargs)
        if ticket:
            self.fields['state'] = State.GetTicketStateField(ticket.Type) 
```

# php - 通过 PEAR 在 OSX 上安装的 PhpDocumentor 无法正常工作 - 缺少文件？

> ID：871038
> 
> 赞同：8
> 
> 时间：2009-05-15T22:00:54.100
> 
> 标签：php, macos, terminal, pear, phpdoc

我基本上是 PEAR（和 PhpDocumentor）的新手；我使用 PEAR CLI 安装了 PhpDocumentor，一切似乎都很顺利......直到我开始使用它，此时我收到以下错误：

```
Warning: require(PhpDocumentor/phpDocumentor/phpdoc.inc): 
failed to open stream: No such file or directory in 
/usr/local/bin/phpdoc on line 40

Fatal error: require(): Failed opening required 
'PhpDocumentor/phpDocumentor/phpdoc.inc' (include_path='.:/usr/share/pear') 
in /usr/local/bin/phpdoc on line 40 
```

我在网上找不到任何有关该错误的信息，因此我再次通过命令行卸载/重新安装而没有错误，但我遇到了同样的问题。我忽略了什么吗？正如我所说，我对 PEAR 很陌生 :)

谢谢。D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T12:42:49.563

要弄清楚 PEAR 把东西放在哪里，运行`pear config-show`. 如果 PEAR 之前说过它已经为您成功安装了 PhpDocumentor，那么您要查找的文件应该在`php_dir`设置的值中找到（在我的 Mac 上，这是`/usr/lib/php/PEAR`）。

`php_dir`为了使大多数 PEAR 包正常运行，必须在您的 include_path 中设置此值。由于`/usr/share/pear`DOES 似乎在您的 include_path 中，根据您上面包含的错误，我不得不猜测您的 PEAR 安装已将其`php_dir`设置为其他位置。

现在，如果您想将您的 PEAR 安装更改为指向`/usr/share/pear`，您需要了解有关 PEAR 如何安装的一些信息。许多包使用`install-time text replacement`，它将您的安装设置放入包的代码本身。如果您回头查看您的`pear config-show`输出，您会看到其他几个 *_dir 设置（data_dir、bin_dir、www_dir 等）。所以，在你安装你的包之前，按照你想要的方式设置这些是很重要的。不过不要担心，对于您已经安装的软件包*来说还为时不晚。*

要更改 PEAR 设置，请使用`pear config-set (setting name) (setting value)`，如`pear config-set php_dir /usr/share/pear`。由于只有 php_dir 是绝对必要的，所以您可以保留其他设置。我通常确保它们都指向同一个根目录，只是为了将所有内容保存在一个整体位置。

一旦您更改了这些设置中的任何一个，您应该运行`pear update`您已经安装的每个包。这将执行`install-time text replacement`我之前提到的执行，但这次将使用当前设置，即您刚刚完成设置的设置。首先在 PEAR 主包上运行它，`pear update --force pear`...您必须包含该`--force`标志，因为 PEAR 会意识到*您要求我在包已经“当前”时更新包*并自行停止。一旦你`update`为所有已安装的包运行了这个，你的 PEAR 安装将把它的文件放在你当前`include_path`期望找到它们的地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-01-24T19:18:57.750

好吧，这个问题已经很老了，但是我也遇到了同样的问题，并且在费了很多脑筋之后解决了它，所以我想分享一下。

我`pear config-show`按照@ashnazg 的详细信息运行，我`php_dir`的设置为`/usr/lib/php`. 我试着`phpdoc -h`从那里跑——瞧！ - 有效。所以对我来说问题是 PHP 需要知道这条路径。我编辑了 php.ini（对我来说位于 /private/etc/php.ini 中）并编辑`include_path`为包含`/usr/lib/php`. 我的然后看起来像：

```
include_path = ".:/usr/lib/php" 
```

之后，它就像一个魅力！希望这对其他人有帮助。FWIW，我在 Snow Leopard 上，我通过运行`sudo pear install phpdocumentor`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T22:14:27.467

PhpDocumentor/phpDocumentor/phpdoc.inc 是否存在？它是否存在于 /usr/share/pear 中？如果答案分别是“是”和“否”，那么您需要将 PhpDocumentor 所在的任何目录添加到您的包含路径中。

长话短说，找到 phpdoc.inc，然后从那里开始工作。

# apache-flex - 组件之间的选项卡

> ID：871039
> 
> 赞同：0
> 
> 时间：2009-05-15T22:01:16.627
> 
> 标签：apache-flex, flex3

我正在玩[Doug Mccune 博客中的物理登录表单](http://dougmccune.com/blog/2008/02/26/examples-from-my-360flex-session-using-open-source-community-projects/)

我正在尝试这样做，以便在我完成输入用户名后，我可以按 Tab 键进入密码字段，然后再次进入登录按钮。我有点喜欢使用 flex，所以我认为设置 tabIndex 属性可以解决这个问题，但事实并非如此。

有任何想法吗？

**编辑：** 经过进一步调查，问题似乎出在 PhysicsContainer 上。如果物理容器被移除，则标签可以正常工作。不幸的是，这也破坏了整个项目的意义

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:06:09.687

您可能还需要设置 loginBtn 的 tabEnabled 属性。

如果这不能解决问题，我会尝试查看 FocusManager：

[http://livedocs.adobe.com/flex/2/langref/mx/managers/FocusManager.html](http://livedocs.adobe.com/flex/2/langref/mx/managers/FocusManager.html)

# asp.net-mvc - 控制器或模型中的存储库？

> ID：871044
> 
> 赞同：5
> 
> 时间：2009-05-15T22:02:28.197
> 
> 标签：asp.net-mvc, model, controller, repository-pattern

我一直在研究 NerdDinner 教程，其中大部分内容都很有意义。我不确定的是为什么直接在控制器中使用存储库而不是模型对象。例如，如果我们想实现自己的会员系统，并且它有一个带有 Login 方法的 AccountController，那么连接它的最佳解决方案是什么？例如

```
Login(username,password){

    repo = AccountRepository

    account = repo.getLogin(username,password)

    //check account isn't locked

    //check account has been verified etc etc 

    //throw error or proceed to secure area

} 
```

或者

```
Login(username,password){

    repo = AccountRepository

    account = repo.getLogin(username,password)

    account.login() //business logic is handled in Account (Model)

} 
```

或者

```
Login(username,password){

    //no reference to repository

    account = Account

    //Account (Model) uses repository and handles business logic
    account.login(username,password) 

} 
```

我建议让 Account 对象直接使用 AccountRepository，而不是 AccountController 从 AccountRepository 获取信息，然后将其传递给 Account 对象，例如

书呆子风格：

1 登录请求进来
2 AccountController 使用 AccountRepository 根据请求获取登录详细信息
3 AccountController 使用 Account 对象并传入来自步骤 1 的信息
4 Account 对象处理请求并通知 AccountController

我的建议是：

1 登录请求进来
2 AccountController 使用 Account 对象根据请求处理登录
3 Account 对象使用 AccountRepository 获取登录详细信息
4 Account 对象处理请求并通知 AccountController

后一种风格的原因是，在从 AccountRepository 返回登录详细信息后，将遵循业务规则，例如帐户锁定、帐户验证等如果使用第一种风格，则获取详细信息然后使用它们的逻辑是拆分的超过2个步骤。后一种风格将所有逻辑保持在一起，同时仍然使用 AccountRepository 例如

```
Account.Login(username,password){
    repo = AccountRepository

    account = repo.GetLogin(username,password)

    //check account isn't locked

    //check account has been verified etc etc

    //throw error or proceed to secure area
} 
```

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T22:19:01.310

mvc 中的“模型”是表示模型而不是域模型。您可以将 MVC 中的模型视为控制器用来为视图引擎提供数据的数据传输对象。控制器是与服务层连接的唯一参与者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-04T22:04:17.807

您至少应该有另一层（不是控制器）负责与存储库接口进行交互。Thil 允许将 de UI（控制器是它的一部分）更改为另一个。这样，无论是命令行、桌面还是 Web 界面都没有关系。

在 ASP.NET MVC 中，我更喜欢将模型（不是我的域模型，MVC 模型）放在单独的项目中，而不是放在 MVC 中。这允许与其他类型的 UI 共享 DTO（MVC 模型）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T22:19:51.870

存储库是一个基础设施问题。你正在做的是让你的模型依赖于你的基础设施。这是一种落后的做法。这意味着如果您想做诸如使用依赖注入之类的事情，那么您将不得不从您的容器中解析您的模型，这对我来说没有多大意义。

此外，重点并不是真正将所有东西都放在一个地方。您应该努力将您的关注点分成逻辑单元。通过这种方式，您可以轻松识别应用程序的哪些部分做了什么。它也适用于测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T22:21:04.080

我会说不是帐户执行登录，而是您*使用该帐户登录应用程序*，因此在该帐户上调用 Login 方法似乎有点不自然。

在领域驱动设计中，有一个业务逻辑不适合 Account 类的地方：这称为服务。您可以阅读更多关于 DDD 服务的信息，例如[这里](http://java.dzone.com/articles/domaindrivendesign-domain-serv)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T22:20:08.327

我会避免将您的数据访问权限放在您的模型中。这很可能导致模型依赖于存储机制。我通常会将此逻辑放在服务/业务逻辑层中，该层将与数据层和模型进行对话。在您只有模型和控制器的情况下，它将是执行此工作的控制器。

我认为域模型是一组玩具或工具，你可以拿起、使用、操作等。玩具并不真正关心它们的存储位置，也不应该关心它们。您应该能够将玩具放在架子上或工具箱中。不影响玩具。

# web-applications - 在 Web 应用程序中应该如何处理业务错误？

> ID：871050
> 
> 赞同：3
> 
> 时间：2009-05-15T22:03:45.183
> 
> 标签：web-applications, error-handling, spring-mvc

假设我有一个可以将 Persons 存储在数据库中的 Web 应用程序。每个人都必须有一个唯一的电子邮件地址（或用户名或其他）。如果用户尝试使用已存在的电子邮件地址添加人员，则应返回表单并显示错误消息（就像在典型的验证失败期间一样）。

这种错误通常是如何从服务层冒泡到控制器然后到视图的？服务方法应该抛出异常让控制器捕获，还是返回一个值或某种结果对象？

如果我最终想使用我的服务层来生成 Web 服务，这是否会改变我的操作方式？

任何建议或最佳实践/示例应用程序的链接将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T22:39:04.460

基本上有两种方法：异常和返回业务规则验证的结果。每种方式都有其优点和缺点，但基本上：

例外：

*   您一次只能返回一个失败的结果
*   异常易于实现且不会使您的业务逻辑复杂化 - 只需检查条件并抛出业务异常
*   例外仅适用于阻止规则
*   打开的事务可以很容易地回滚

业务规则验证：

*   您可以检查多个业务规则并将损坏的列表返回给用户
*   多个规则会使您的逻辑流程复杂化，因为它们往往会弄乱方法的返回类型
*   它们允许处理更多场景，例如非阻塞信息规则

我认为这在很大程度上取决于应用程序更适合哪种方法，因此没有简单的答案。很长一段时间以来，我成功地将例外用于业务规则，现在我倾向于利用第二种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T22:10:47.693

处理此问题的一种方法是为您的`addPerson`操作创建一个具有状态代码的响应对象。例如：

```
class AddPersonResponse {
    private Person person;
    private AddPersonStatus status;
    private AddPersonFailureReason failureReason;
}

enum AddPersonStatus {
    SUCCESS, FAILURE
}

enum AddPersonFailureReason {
    DUPLICATE_EMAIL_ADDRESS,
    DUPLICATE_USER_NAME
} 
```

您发送给用户的视图可以绑定到服务返回的响应对象并给出适当的反馈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T22:17:09.443

我想我会选择抛出一个异常。您可以创建从 Exception 类派生的自定义异常。这样，您可以使用类中的“消息”字段作为最终用户友好的消息，同时仍然能够从基础的“innerException”字段记录实际的异常详细信息。这样，您可以选择向用户隐藏您的方法为何失败的丑陋细节，同时仍保持基础异常描述的详细程度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T22:17:44.200

这个讨论由来已久，你会发现不同的阵营。我对此的看法是，如果您有一个具有明确独立功能的后端系统，您应该首先使用 API 和所有内容开发它，然后从您的视图层使用该 API。在这种情况下，分层是必要的。一个例子是您正在为您已经开发的自定义软件编写一个 Web 前端。

然而，在大多数 web 应用程序中，使用单一配置源更容易、更直接。Django、RoR、JBoss Seam 等都采用这种方法。他们使用以一组域类为中心的概念，其中放置了所有验证逻辑和约束。模型异常（例如 NoSuchObject）直接映射到视图异常（404 Not Found），所有这些都由框架处理。使用这种方法，没有层，主要思想是避免分层，直到真正需要它。Django 文档是关于这个主题的一个很好的信息来源，Seam 文档更技术性但也更详细。

将某些逻辑公开为 Web 服务的决定并不能自动保证构建完整的分层解决方案的决定，很容易重构，这里我会说 YAGNI 和 DRY 规则。

分层确实增加了来回传播信息的另一个维度，我想说除非它很好地适合您的问题，否则不要使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T22:28:09.820

我必须说我不是“验证错误是异常”模式的忠实拥护者。

我的模型 Save() 方法只是创建并返回一个损坏的规则列表（或一个空列表）。然后，我的 ControllerBase（或服务层）的工作就是处理那些他们认为合适的损坏的规则。

对于我的 ControllerBase，我通过 AddModelError 将它们一一添加到 MVC 验证处理程序中。在服务层，它最终就像在我的 JSON 结果中添加一个“isValid”标志。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T23:02:54.700

我在 Spring MVC 中使用的方法是在我的 Validator 类中执行所有验证。因此，在我的验证方法中，我会调用服务上的一个方法来检查电子邮件地址是否已被使用。如果它是重复的，我会将该绑定的错误添加到 Errors 对象以显示在表单上。如果 Person 对象是有效的，那么您就不必担心在将其添加到服务时会引发期望。

# jquery - 如何使用 jQuery 设置选中的单选选项

> ID：871063
> 
> 赞同：313
> 
> 时间：2009-05-15T22:07:46.920
> 
> 标签：jquery, radio-button

如何使用 jQuery 设置选中的单选选项？

需要检查是否没有设置默认值，然后设置一个默认值

* * *

## 回答 #1

> 赞同：588
> 
> 时间：2009-05-15T22:12:32.137

假设您有这样的单选按钮，例如：

```
 <input type='radio' name='gender' value='Male'>
    <input type='radio' name='gender' value='Female'> 
```

如果没有检查收音机，您想检查值为“Male”onload 的那个：

```
 $(function() {
        var $radios = $('input:radio[name=gender]');
        if($radios.is(':checked') === false) {
            $radios.filter('[value=Male]').prop('checked', true);
        }
    }); 
```

* * *

## 回答 #2

> 赞同：115
> 
> 时间：2010-07-23T09:23:46.280

一个班轮怎么样？

```
$('input:radio[name="gender"]').filter('[value="Male"]').attr('checked', true); 
```

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2011-08-06T04:58:14.453

这将导致 form.reset() 失败：

```
$('input:radio[name=gender][value=Male]').attr('checked', true); 
```

但这一个有效：

```
$('input:radio[name=gender][value=Male]').click(); 
```

* * *

## 回答 #4

> 赞同：41
> 
> 时间：2013-12-28T01:16:11.437

JQuery 实际上有两种方法来设置单选和复选框的选中状态，这取决于您是否在 HTML 标记中使用 value 属性：

### 如果它们具有 value 属性：

```
$("[name=myRadio]").val(["myValue"]); 
```

### 如果他们没有 value 属性：

```
$("#myRadio1").prop("checked", true); 
```

## 更多细节

在第一种情况下，我们使用 name 指定整个无线电组，并告诉 JQuery 使用 val 函数查找要选择的无线电。val 函数采用 1 元素数组并找到具有匹配值的收音机，将其设置为 checked=true。其他同名的将被取消选择。如果没有找到具有匹配值的收音机，则将取消选择所有收音机。如果有多个具有相同名称和值的无线电，则将选择最后一个，而取消选择其他无线电。

如果您没有使用收音机的值属性，那么您需要使用唯一 ID 来选择组中的特定收音机。在这种情况下，您需要使用 prop 函数来设置“checked”属性。许多人不将 value 属性与复选框一起使用，因此＃2 更适用于复选框而不是收音机。另请注意，当复选框具有相同名称时，它们不会形成组，您可以`$("[name=myCheckBox").prop("checked", true);`为复选框做。

您可以在此处使用此代码：http: [//jsbin.com/OSULAtu/1/edit ?html,output](http://jsbin.com/OSULAtu/1/edit?html,output)

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2012-10-08T23:18:55.340

我喜欢@Amc 的回答。我发现表达式可以进一步压缩以不使用 filter() 调用（@chaiko 显然也注意到了这一点）。此外，对于 jQuery v1.6+，prop() 是与 attr() 比较的方法，有关该主题的官方最佳实践，请参阅[prop() 的 jQuery 文档。](http://api.jquery.com/prop/)

考虑来自@Paolo Bergantino 答案的相同输入标签。

```
<input type='radio' name='gender' value='Male'>
<input type='radio' name='gender' value='Female'> 
```

更新后的单行代码可能如下所示：

```
$('input:radio[name="gender"][value="Male"]').prop('checked', true); 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2013-04-24T12:31:47.577

我认为您可以假设，该名称是唯一的，并且组中的所有收音机都具有相同的名称。然后你可以像这样使用 jQuery 支持：

```
$("[name=gender]").val(["Male"]); 
```

*注意：*传递数组很重要。

有条件的版本：

```
if (!$("[name=gender]:checked").length) {
    $("[name=gender]").val(["Male"]);
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-06-15T00:57:00.133

**原生 JS 解决方案：**

```
 document.querySelector('input[name=gender][value=Female]').checked = true; 
```

[http://jsfiddle.net/jzQvH/75/](http://jsfiddle.net/jzQvH/75/)

HTML：

```
<input type='radio' name='gender' value='Male'> Male
<input type='radio' name='gender' value='Female'>Female 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-11-08T19:32:25.943

如果您希望它是真正动态的并选择与传入数据相对应的无线电，则可以使用。它使用传入的数据的性别值或使用默认值。

```
if(data['gender'] == ''){
 $('input:radio[name="gender"][value="Male"]').prop('checked', true);
}else{
  $('input:radio[name="gender"][value="' + data['gender'] +'"]').prop('checked', true);
}; 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-04-15T10:52:33.573

如果你想从你的模型中传递一个值，并且想根据值从加载组中选择一个单选按钮，那么使用：

查询：

```
var priority = Model.Priority; //coming for razor model in this case
var allInputIds = "#slider-vertical-" + itemIndex + " fieldset input";

$(allInputIds).val([priority]); //Select at start up 
```

和html：

```
<div id="@("slider-vertical-"+Model.Id)">
 <fieldset data-role="controlgroup" data-type="horizontal" data-mini="true">
    <input type="radio" name="@("radio-choice-b-"+Model.Id)" id="@("high-"+Model.Id)" value="1" checked="checked">
    <label for="@("high-"+Model.Id)" style="width:100px">@UIStrings.PriorityHighText</label>

    <input type="radio" name="@("radio-choice-b-"+Model.Id)" id="@("medium-"+Model.Id)" value="2">
    <label for="@("medium-"+Model.Id)" style="width:100px">@UIStrings.PriorityMediumText</label>

    <input type="radio" name="@("radio-choice-b-"+Model.Id)" id="@("low-"+Model.Id)" value="3">
    <label for="@("low-"+Model.Id)" style="width:100px">@UIStrings.PriorityLowText</label>
 </fieldset>
</div> 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-11-12T12:59:43.560

不需要这一切。使用简单而旧的 HTML，您可以实现您想要的。如果你让你想要的收音机默认检查是这样的：
`<input type='radio' name='gender' checked='true' value='Male'>`
当页面加载时，它会被选中。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-12-16T13:10:57.927

```
 $("form input:[name=gender]").filter('[value=Male]').attr('checked', true); 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-09-14T11:46:40.483

以下是上述方法的示例：

```
<div class="ui-field-contain">
<fieldset data-role="controlgroup" data-type="horizontal">    <legend>Choose a pet:</legend>
    <input type="radio" name="radio-choice-2" id="radio-choice-1" value="choice1">
    <label for="radio-choice-1">Cat</label>

    <input type="radio" name="radio-choice-2" id="radio-choice-2" value="choice2">
    <label for="radio-choice-2">Dog</label>

    <input type="radio" name="radio-choice-2" id="radio-choice-3" value="choice3">
    <label for="radio-choice-3">Hamster</label>

    <input type="radio" name="radio-choice-2" id="radio-choice-4" value="choice4">
    <label for="radio-choice-4">Lizard</label>
  </fieldset>
</div> 
```

在 JavaScript 中：

```
$("[name = 'radio-choice-2'][value='choice3']").prop('checked', true).checkboxradio('refresh'); 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-11-13T23:23:38.550

**获取无线电输入值时请注意此行为：**

```
$('input[name="myRadio"]').change(function(e) { // Select the radio input group

    // This returns the value of the checked radio button
    // which triggered the event.
    console.log( $(this).val() ); 

    // but this will return the first radio button's value,
    // regardless of checked state of the radio group.
    console.log( $('input[name="myRadio"]').val() ); 

}); 
```

所以`$('input[name="myRadio"]').val()`不会像您所期望的那样返回单选输入的检查值——它返回第一个单选按钮的值。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-09-24T15:44:53.110

//如果你是在 javascript 或骨干网之类的框架上做的，你会经常遇到这种情况，你可能会遇到这样的事情

```
$MobileRadio = $( '#mobileUrlRadio' ); 
```

尽管

```
$MobileRadio.checked = true; 
```

不管用，

```
$MobileRadio[0].checked = true; 
```

将要。

您的选择器也可以像上面推荐的其他人一样。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-05-09T13:49:19.513

**De esta forma Jquery obtiene solo el elemento 检查**

```
$('input[name="radioInline"]:checked').val() 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-02-06T09:22:09.880

这适用于多个单选按钮

```
$('input:radio[name="Aspirant.Gender"][value='+jsonData.Gender+']').prop('checked', true); 
```

# .net - 为什么这个数据绑定不起作用？

> ID：871069
> 
> 赞同：4
> 
> 时间：2009-05-15T22:10:07.400
> 
> 标签：.net, wpf, data-binding, binding

我有一个包含点列表的 ViewModel 类，我正在尝试将它绑定到折线。折线选择初始点列表，但即使我实现了 INotifyPropertyChanged，也不会注意到何时添加了其他点。怎么了？

```
<StackPanel>
    <Button Click="Button_Click">Add!</Button>
    <Polyline x:Name="_line" Points="{Binding Pts}" Stroke="Black" StrokeThickness="5"/>
</StackPanel> 
```

C# 方面：

```
// code-behind
_line.DataContext = new ViewModel();
private void Button_Click(object sender, RoutedEventArgs e)
{
    // The problem is here: NOTHING HAPPENS ON-SCREEN!
    ((ViewModel)_line.DataContext).AddPoint();
}

// ViewModel class
public class ViewModel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    public PointCollection Pts { get; set; }

    public ViewModel()
    {
        Pts = new PointCollection();
        Pts.Add(new Point(1, 1));
        Pts.Add(new Point(11, 11));
    }

    public void AddPoint()
    {
        Pts.Add(new Point(25, 13));
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs("Pts"));
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T22:23:39.940

很有可能因为它绑定到集合，所以它需要类似`ObservableCollection<T>`. 如果你从 切换`PointCollection`到会发生什么[`ObservableCollection<Point>`](http://msdn.microsoft.com/en-us/library/ms668604.aspx)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T22:37:08.817

将您的 PointCollections 属性更改为依赖项属性：

```
public PointCollection Pts
        {
            get { return (PointCollection)GetValue(PtsProperty); }
            set { SetValue(PtsProperty, value); }
        }

        // Using a DependencyProperty as the backing store for Pts.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty PtsProperty =
            DependencyProperty.Register("Pts", typeof(PointCollection), typeof(ViewModel), new UIPropertyMetadata(new PointCollection())); 
```

顺便说一句，您不需要触发 PropertyChanged 事件。

哦，对不起，您的对象需要从 DependencyObject 继承

```
 public class ViewModel : DependencyObject 
{ 
//... 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-14T21:21:10.227

我通过实现 INotifyCollectionChanged 而不是 INotifyPropertyChanged 让它作为 POCO 工作。

# flash - 创建嵌套影片剪辑

> ID：871072
> 
> 赞同：0
> 
> 时间：2009-05-15T22:11:04.900
> 
> 标签：flash, flash-cs3, flashdevelop

我需要创建 2 个影片剪辑：clipA 是一个包装影片剪辑。clipB 是一个容器影片剪辑。它们之间大约有 15 个像素的间距。然后将 clipB 传递给另一个函数，该函数向其中添加其他元素（按钮、图形等）。完成这项工作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-15T22:17:29.753

```
var clipA:MovieClip = new MovieClip();
var clipB:MovieClip = new MovieClip();

clipB.x = clipA.x + clipA.width + 15;

this.addChild(clipA);
this.addChild(clipB);

otherFunction(clipB); 
```

不过，我不太确定您要解决这个问题，这似乎是一个基本的问题。

# law-of-demeter - 这个编程规则的名称是什么？

> ID：871090
> 
> 赞同：1
> 
> 时间：2009-05-15T22:16:59.397
> 
> 标签：law-of-demeter

有一个编程“规则”说，当一个方法需要知道'xyz'时，应该直接询问'z'，而不是询问'x'。我只是不记得名字了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T22:20:44.130

我不确定这是否正是您所追求的，但这听起来与得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)非常相似。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-15T22:24:08.113

它被称为得墨忒耳定律（又名最少知识原理）。见[http://en.wikipedia.org/wiki/Law_of_Demeter](http://en.wikipedia.org/wiki/Law_of_Demeter)。

我听过的最生动、最难忘的例子是*“当你在商店购物时，店员不是要你的钱包来取钱，而是要你要钱！ "*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-15T22:20:48.280

你在想得墨忒耳法则吗？

# apache-flex - 在 FlexBuilder 中输入完成？

> ID：871094
> 
> 赞同：1
> 
> 时间：2009-05-15T22:17:52.687
> 
> 标签：apache-flex, flexbuilder

是否可以要求 FlexBuilder 自动填写语句的类型？

例如：

```
var g = this.graphics; 
```

将抛出一个“无类型声明”警告 Eclipse 的魔法“请修复此行”将无法修复......那么除了手动输入“g：Graphics”之外，还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T15:54:35.063

至少直到并包括 FlexBuilder 3，唉，如果你想遵守编译器的严格类型规则，你必须声明类型，而且我不知道那里现有的“推断这个变量的类型”功能任何地方，要么。

不过，我确信这是设计使然——那些想要严格类型的好处的人可以通过显式声明来获得它们，而那些可能更喜欢在运行时更改“g”所指的内容的人可以欣赏能够关闭编译器警告的功能（项目 > 属性 > Flex 编译器）并这样做。

希望我有一个更好的答案给你！也许其他人知道一些事情并且可以提出更令人满意的解决方案。:)

如果只是多余的字符让您烦恼，您可以尝试使用 Eclipse/FlexBuilder 快捷方式（例如，用于类型自动完成的 Ctrl+Space）——[这里有一个很好的列表](http://allyourflex.wordpress.com/2008/04/26/flex-builder-shortcuts/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T20:18:41.570

有一个插件可以为eclipse即时编写代码片段，也许你可以创建一些解决你问题的东西：

[更多在这里：](http://www.flashfuck.it/2008/10/21/auto-generate-getters-setters-and-custom-code-in-flex-builder/)

# .net - 合并 GUI 更改

> ID：871097
> 
> 赞同：2
> 
> 时间：2009-05-15T22:19:37.970
> 
> 标签：.net, winforms, version-control, merge

在我工作的项目中，合并更改的最大问题似乎在于 Windows 窗体/GUI 更改。我们使用 Araxis Merge 来比较更改，但每个文件可能有数百个更改。你必须做笔记和/或重命名项目，以确保你知道你正在合并什么。

一个大问题是开发人员是否允许新控件使用默认名称。然后将结束，例如，2 个 Label220。然后merge会将一半的代码合并到一起，但其他部分分开；这基本上只是破坏了 GUI。

是否有任何工具可以比在代码级别更好地合并 .NET（Windows 窗体）GUI？

我们使用颠覆。Mercurial 在这方面做得更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T22:36:19.880

我使用 subversion 并在一个使用 Windows 窗体 GUI 应用程序的小团队中工作，这里有一些建议：

1) 将复杂的用户界面组件拆分为多个用户控件。这具有清理 UI 代码和促进重用的额外好处。

2) 首先需要锁定对受影响文件的 UI 的更改。只要您的复杂表单被拆分为不同的用户控件，您就可以使用锁定并且仍然有多个开发人员在一个表单上工作。

3）花更多的时间在 UI 原型上，以减少更改的数量。此外，先进行多次 UI 设计迭代将大大提高成品的质量。

# testing - 在 Lotus Notes 8.5 上自动测试

> ID：871105
> 
> 赞同：6
> 
> 时间：2009-05-15T22:21:56.187
> 
> 标签：testing, automated-tests, lotus-notes

我工作的公司正在寻找一种方法来自动化 Lotus Notes 8.5 上的功能测试。我们尝试了不同的工具，包括 Testcomplete 6 和 Rational Robot 7。但我们发现了识别对象和实施验证的问题。

有没有人尝试自动化这种类型的测试？您为此推荐哪些工具（方法）？

我想知道是否可以在 Domino/LotusScript 上创建代码来自动化这些测试，可能使用代理（有没有人成功实施过这种方法）？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-28T20:41:57.890

我认为您最好的选择是 Smart Toucan Software 开发的 Lotus Notes 的 AutoUser：[Smart-Toucan.com](http://smart-toucan.com/)

它是一个功能齐全的 Lotus Notes 自动化测试工具，我不知道有任何其他工具提供相同的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T08:11:41.643

很久没做Notes开发了，既然Notes已经有了丰富的Java API，为什么不直接用JUnit呢？

甚至还有一个插件可以将测试结果输出到文档：

[http://www.junit.org/node/205](http://www.junit.org/node/205)

此外，这里有人尝试为 Domino 测试编写更多定制的东西：

[http://palmerweb.blogspot.com/2007/12/sntt-unit-testing-in-domino.html](http://palmerweb.blogspot.com/2007/12/sntt-unit-testing-in-domino.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-18T06:49:34.843

通过查看您尝试过的工具，我猜您想要测试 UI 而不是代码的内部细节。

我还没有为 Notes 8 做过开发，但如果它是像 R7 这样的东西，**我肯定认为你应该寻找一个非 Notes 工具**来测试 Notes 应用程序 UI。Notes UI 类充满了奇怪的陷阱，我认为您会遇到表达诸如切换选项卡、在文档中移动、触发热点、验证消息和对话框的可见性、代理运行等内容的问题。

我最初的想法是在[AutoIt](http://www.autoitscript.com/autoit3/)中实现测试，但我认为您尝试过的工具对测试更友好，并且同样能够识别窗口元素并与之交互。

如果你发现有什么效果，我很想听听！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-23T07:00:11.443

到目前为止，团队发现的最佳方法是使用 Domino/Lotus Scripts 和 Aggents 为不同的进程运行自动化测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-16T19:12:30.430

我认为 Rational Robot 不再是受支持的程序。[Rational Functional Tester](http://www.ibm.com/software/awdtools/tester/functional/index.html "Rational 功能测试器")是最新的化身，它可能是您正在寻找的。它将在 GUI 级别工作。

GUI 级别测试的问题在于它不是性能测试。一台机器驱动 1 个 GUI。问题是关于功能测试的，所以我认为这不是问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-04T22:32:17.897

Original Software 有一个名为 TestDrive 的产品，它声称专门支持 Lotus Notes 客户端应用程序测试。我没有使用该工具的任何经验。他们的网站位于[http://www.origsoft.com/products/testdrive/](http://www.origsoft.com/products/testdrive/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-26T03:55:06.013

如果您正在开发 XPages 应用程序，我相信您可以使用那些流行的测试框架，例如：JUnit、WebDriver，甚至是 Concordium。

# ruby - 无法运行 ruby 脚本/控制台

> ID：871108
> 
> 赞同：2
> 
> 时间：2009-05-15T22:22:43.890
> 
> 标签：ruby, macos, console, rubygems, terminal

尝试 ruby​​ 脚本/控制台时出现此错误

> Rails 需要 RubyGems >= 。请安装 RubyGems 并重试

我正在运行 ruby​​ 1.8.6 和 rails 2.3.2 并且安装了 RubyGems，所以这可能是 $PATH 问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T23:32:10.337

好吧，看起来好像您没有安装 Gems，或者它不像您建议的那样在 $PATH 中。

您为您的问题提供的信息很少，更多信息会有所帮助： - 在您收到此消息之前发生了什么 - 以前在这台机器上运行过 ruby​​ 或 gems 吗？

等等

一些潜在的尝试 -

1.  宝石安装了吗？您可以尝试“哪个宝石”，但显然我们不希望它出现在您的路径中。但是，您可以检查 /usr/bin/gem 如果安装了它，它应该在 OS X 上的位置。我不确定它在其他系统上的位置。[在gems 指南](http://rubygems.org/read/chapter/3)上有一个很好的关于如何安装 gems 的说明列表 （请注意，这是谷歌搜索“安装 ruby​​ gems”的第一个链接
2.  你的 $PATH 中有宝石吗？安装 gem 后，您应该检查 PATH $ echo $PATH 以及 gem 的父目录是否在其中。如果不是，您应该在您的 shell 的登录脚本中更新您的路径。在 OS X 上，该脚本默认为 ~/.profile。谷歌应该让你轻松完成这项任务。

我的猜测是，尽管您没有向我们提供足够的信息来说明这一点，但您更换了机器。当您从另一台机器下载代码时，您下载的是没有安装 gems 的机器或用户帐户。

祝你好运，这应该不会太难。

# frameworks - 小型、简单的网络应用程序的框架/建议

> ID：871114
> 
> 赞同：2
> 
> 时间：2009-05-15T22:24:33.510
> 
> 标签：frameworks

我正在寻找创建有趣的社交玩具的小型简单应用程序。它们不会很复杂，通常是一种 CRUD 类型的交易。例如，

1.  生成一个随机句子（来自源/算法）
2.  将其存储在数据库中
3.  将这句话呈现给用户
4.  显示一个文本框，让他们输入自己的句子。
5.  在数据库中记录与第一句相关的句子

那么这个网站的另一部分将

1.  从数据库中获取条目
2.  通过关系以有趣的方式呈现它们。

好的，这只是一个示例，但其中大多数都符合此要求。现在我是一名 drupal 开发人员，我可以在 drupal 中完成它们，但是：

*   它将它们与我的站点或一个主要的 drupal 基础联系起来（它们在概念上和视觉上是独立的）
*   每个站点安装一个 drupal 是不现实的。
*   我想使用 PHP 以外的东西，最好是函数式语言。

所以我有兴趣了解有利于

*   小型、灵活和快速 CRUD 的快速原型设计。
*   最好是功能语言或其他具有**有趣和新**功能的语言（对于 php 开发人员）。
*   提供足够的结构来不重新发明轮子，但如果我需要，提供足够的控制来重新发明。

谢谢！- 不是 PHP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:37:59.673

这是一个非常通用的答案，但也许您可以尝试以下任何适合您口味的方法：

*   Ruby + Rails

*   Python + Django

*   基于 Erlang 的 Web 框架称为
    Erlyweb

*   web.py 一个简单的基于 python 的
    框架。

如果你倾向于使用函数式语言，它并没有比 Erlang 更好，而是一个警告——你可能需要一些时间来习惯语法。我认为 ROR 和 Django 框架应该是你的前 2 名。我会选择 Django，如果你觉得 Ruby“可爱”，你可能会看 ROR。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T22:32:16.270

我最近一直在使用 AppJet ( [http://appjet.com](http://appjet.com) )。它是客户端-服务器，客户端和服务器都使用简单的 Javascript 编写脚本。该系统非常简单，但功能强大，足以创建一些简单的玩具。它还支持基于表的小空间持久存储（即不是 MySQL，但足够简单）。

使用它的唯一缺点是（a）您非常受限于 Javascript 以及您可以在其中做什么以及（b）您的源代码（客户端和服务器）可以被其他人查看。

如果您想尝试使用 Python，Google App Engine ( [http://code.google.com/appengine/](http://code.google.com/appengine/) ) 也很方便。它更复杂，但您不必向人们展示您的源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T22:39:48.513

Django/Python 应该值得一看。来自 php，我发现使用它更加有趣和高效，并且它有很多非常好的特性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T22:32:28.577

导轨。

如果你想要功能，你可以玩 Erlyweb ......

# c# - 使用 C# 写入 Excel 文件的最佳和最快方法是什么？

> ID：871115
> 
> 赞同：6
> 
> 时间：2009-05-15T22:24:54.947
> 
> 标签：c#, excel, oledb

我正在尝试使用 OLEDB（没有自动化）写入 excel 文件。我有大约 500 行数据，这些数据是从其他应用程序获取的，然后使用“INSERT INTO..”查询一一写入 Excel 文件。我确信从其他应用程序读取数据没有延迟。我检查了那个。在大约 3 分钟内写入 500 行的 excel 文件所需的总时间。这太多了。这肯定是因为文件写入操作。

什么是最好的方法来做到这一点？我应该使用其他一些写作技巧吗？我应该尝试自动化技术吗？

[http://support.microsoft.com/kb/306023](http://support.microsoft.com/kb/306023) 此链接显示了许多技术，但不确定使用哪一种。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-15T22:47:56.717

如果可以 COM 入 excel，则可以通过 COM 直接从 excel 中查询，或者创建一个数据数组并将其直接放入与数组大小相等的范围内。尽管 excel 对小型 COM 调用不是很好，但它在一些大型 COM 调用中效果很好:)

```
DataSet ds = new DataSet();
          da.Fill(ds);
          int width = ds.Tables[0].Columns.Count;
          int height = ds.Tables[0].Rows.Count;
          object[,] retList = new object[height, width];
          for (int i = 0; i < height; i++)
          {
            DataRow r = ds.Tables[0].Rows[i];
            for (int j = 0; j < width; j++)
              retList[i, j] = r.ItemArray[j];
          }
          Excel.Range range = mWs.get_Range(destination, mWs.Cells[destination.Row + height - 1, destination.Column + width - 1]);
          range.set_Value(Missing.Value, retList);
          System.Runtime.InteropServices.Marshal.ReleaseComObject(range);
          range = null; 
```

这是在一次 COM 调用中获取数据并将其作为数组插入 excel 的示例

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-15T22:36:22.530

**Excel 已经提供了在 XML 中读取/写入数据所需的一切。**

我有时会使用[SpreadsheetML](http://msdn.microsoft.com/en-us/library/bb226687(office.11).aspx)格式，它对我来说效果很好。使用它，您可以写出一个 xml 格式的文档，并使用 .xls 扩展名对其进行命名。大多数excel功能都可用。Microsoft 的参考文档在[此处](http://msdn.microsoft.com/en-us/library/aa140066.aspx)。谷歌各种语言的教程，如[Rails](http://arydjmal.com/2008/6/8/export-to-excel-in-rails-2)、[PHP](http://www.ibm.com/developerworks/opensource/library/os-phpexcel/index.html)。[Excel Hacks](https://rads.stackoverflow.com/amzn/click/com/0596528345)一书也谈到了这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-15T22:37:24.587

如果只是数据，则可以导入 CSV 文件。在代码中创建文件并使用自动化使 Excel 导入文件。

更新：写完这篇文章后，我喜欢[@MicTech 的](https://stackoverflow.com/questions/871115/what-is-the-best-and-fastest-way-to-write-into-excel-file-using-c/871142#871142)我不知道的建议。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T12:13:27.427

我们使用[SpreadsheetGear](http://www.spreadsheetgear.com/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T22:35:57.510

我推荐[了 FlexCel](http://www.tmssoftware.com/site/flexcelnet.asp)库，但它不是免费的 :(

但是如果你想要 Office Open XML 格式，你可以使用[http://excelpackage.codeplex.com/](http://excelpackage.codeplex.com/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T23:18:13.447

您是否正在寻找一次性转储到 Excel 或保持连接并将数据多次推送到 Excel？

如果您希望多次将数据推送到 Excel，您应该研究制作 RTD 服务器，我已经多次使用它们并且它们可以使用[RTD 服务器](http://msdn.microsoft.com/en-us/library/aa140061.aspx)

如果您希望一次性推送到 Excel，则需要使用 COM。[使用 COM 和 C#](http://support.microsoft.com/kb/302084)

C# 版本 4 对托管 COM 进行了一些很好的改进，并且在使用 Excel 时不再需要主互操作程序集。C# 4 尚未投入生产，但如果它适合您，您可以下载它的测试版。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T22:34:53.220

嗯，编写 Excel 的最基本（但也是最复杂）的方法是创建一个遵循 BIFF 格式的二进制文件。对于 BIFF 格式，您需要概述 Excel 文件的结构。它非常复杂，但是您可以在每个单元格的基础上控制要写的内容。

还有其他关于将 DataSet 导出到 Excel 文件的 CodeProject 示例。考虑创建一个遵循 Excel XML 格式的 XML 文件。它还以每个单元格为基础进行写入。看着：

[http://www.codeproject.com/KB/office/ExportDataSetToExcel.aspx](http://www.codeproject.com/KB/office/ExportDataSetToExcel.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-15T22:46:35.080

“写入”到 Excel 的另一种方法是将数据创建为 HTML 页面并加载。Excel实际上可以读取html。通过 html 执行此操作的一个好处是，您可以比使用 CSV 更好地格式化数据。

但也就是说，如果您只导出简单数据（小文本字段和数字），请使用 CSV。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-15T22:50:28.753

我一直在使用[Aspose.Cells](http://aspose.com)库来编写 Excel 文件取得了巨大成功。不过远不便宜。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-19T13:22:59.547

我们使用 aspose 细胞。它非常易于使用，速度快，没​​有明显的问题。

[http://www.aspose.com/categories/.net-components/aspose.cells-for-.net/default.aspx](http://www.aspose.com/categories/.net-components/aspose.cells-for-.net/default.aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-16T05:31:38.010

这个库是免费的，创建 xls 文件的速度非常快，如果你没有安装 MS Office，它也可以工作。 [http://code.google.com/p/excellibrary/downloads/list](http://code.google.com/p/excellibrary/downloads/list)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-04T14:13:04.500

快速而肮脏的方法是创建一个包含表格数据的 HTML 表格，然后使用 .xls 扩展名保存它。它可以正常工作，并且可以在 Excel 中正常打开。

# google-app-engine - Google App Engine：针对域名定向到 Google 站点

> ID：871119
> 
> 赞同：1
> 
> 时间：2009-05-15T22:28:29.180
> 
> 标签：google-app-engine

尝试按照此处的说明进行操作：

[如何在我自己的裸域（不是子域）中使用 Google 应用引擎？](https://stackoverflow.com/questions/817809/how-to-use-google-app-engine-with-my-own-domain-not-subdomain)

我可以在哪里使用我的谷歌应用程序引擎网站和我自己的域名但是在设置它时，它似乎显示我的谷歌应用程序网站而不是我的谷歌应用程序引擎网站......知道我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T23:16:42.060

你能详细说明你经历的步骤吗？为应用添加域有两种不同的方法 - 从应用控制面板开始，或从 App Engine 控制面板开始 - 您可能做错了几件事。

此外，请确保您没有在您希望您的应用程序所在的子域（例如，“www”）上提供任何其他服务。

最后，请注意 App Engine 不支持“裸”域 - foo.com 而不是 www.foo.com。始终需要子域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T22:31:36.850

谷歌应用网站可用时，应用引擎绑定不起作用。所以，禁用谷歌应用程序网站，它应该可以工作！

# c# - 启动时需要少量 99% 静态数据的最佳存储方法？

> ID：871121
> 
> 赞同：0
> 
> 时间：2009-05-15T22:29:36.603
> 
> 标签：c#, xml, database, serialization, binary

我有一些（少量）数据需要在初始加载时快速访问，但在那之后就不需要了。

现在，我已将数据（通用列表）序列化为 Xml 文件，并根据需要在加载时对其进行反序列化。

我的问题是我应该使用 XmlSerializer 还是 BinaryFormatter？我不担心文件大小，而是序列化速度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:31:22.810

`BinaryFormatter`比 快`XmlSerializer`。它必须处理不那么臃肿的格式，而不会出现字符串解析问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T22:40:51.850

有趣的答案。我将建议将数据保存为代码，并将其构建到一个程序集中，该程序集将被应用程序的其余部分引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T22:35:47.120

“我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。” ——唐·克努特

如果数量很少，请使用 XmlSerializer，即使它肯定更慢。这是当有人试图查看文件以诊断崩溃时可能会导致咒骂的那些小效率之一。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T22:32:28.593

XML 很慢，要检查的语法太多。您可以使用制表符分隔或 CSV 文件吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T22:47:28.013

由于 John Saunders 没有建议，我建议将您的静态数据序列化为代码。作为对可维护性的微弱点头，您可以将其驻留在外部程序集中。这应该是性能最高、初始复杂度最低的解决方案。

如果数据有任何规律性的变化，或者是业务逻辑，那么忽略这个答案。免得你们被警告！

# php - 铸造去除前导零

> ID：871123
> 
> 赞同：1
> 
> 时间：2009-05-15T22:30:05.823
> 
> 标签：php, casting

有人能告诉我为什么当我输入一串 00332 时我只得到 332 吗？它会删除前导零并以相同的格式保存数据。

谢谢

* * *

```
this->_gate   = (string) $this->_linkID->QuoteSmart($gate); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T22:38:27.270

不要将字符串转换为字符串，或将任何类型转换为相同的类型。类型转换用于将某些内容从一种类型更改为另一种类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T22:33:48.013

我会说因为前导零在转换为整数时没有任何重要性。

如果您需要那些前导零，也许您应该将其保留为字符串，并且只`(int)`对需要执行的任何数学进行强制转换（尽管您也可以只使用字符串，PHP 会弄清楚）

**编辑**

看到这个例子后，我想在你转换为字符串之前回显这个值（这样我就可以确认你的 QuoteSmart 方法没有发生可疑的事情（或者你作为参数发送的值，$gate）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T23:03:40.953

```
$ php -r 'var_dump((string)"00123");'
string(5) "00123" 
```

看起来演员不是你的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T22:33:15.753

你把它投射到什么地方，为什么？让我们看看代码。如果你转换为整数，是的，整数没有前导零，所以它们消失了。没有惊喜。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-15T23:40:23.907

好的，这就是它丢弃前导零的原因。它不是铸造也不是加斜线。我所做的是引用变量（quotesmart 无论如何都应该这样做，但由于某种原因没有这样做）一旦我引用了变量，我就得到了正确保存的值。如果我没记错的话，quotesmart 只适用于字符串而不是整数。

# sql - 汇总值的概览

> ID：871157
> 
> 赞同：1
> 
> 时间：2009-05-15T22:40:52.270
> 
> 标签：sql, mysql

我想获得用于案例的时间，以便创建概述。

案例的 SELECT 查询如下所示：

```
SELECT bc.id, bc.title, bc.estimateCurrent FROM cases bc 
```

对于一种情况，我可以获得这样的使用时间：

```
SELECT SUM(TIME_TO_SEC(TIMEDIFF(dateEnding, dateBeginning))) AS calculatedTime FROM timesheet WHERE `#case` = ? 
```

如何将两者连接起来，以便为概览 SELECT 查询提供一个值？基本上我希望表格看起来像这样：

```
id|title|estimateCurrent|timeusedinsec
 1|案例1| 20| 2000
 2|案例2| 40| 2500
 3|案例3| 70| 0

```

那可能吗？我不想在 php 端对每个查询都有一个，这会导致多个查询。视图会有帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T22:45:23.617

假设时间表列`#case`引用 bc.id，您可以使用如下连接：

```
SELECT 
    bc.id, bc.title, bc.estimateCurrent,
    SUM(TIME_TO_SEC(TIMEDIFF(dateEnding, dateBeginning)))
FROM cases bc
JOIN timesheet ts on ts.`#case` = bc.id
GROUP BY bc.id, bc.title, bc.estimateCurrent 
```

GROUP BY 定义了 SUM() 的工作方式。在这里，它将使 SUM() 将具有相同#case 编号的所有行相加。

# python - django模板中的转义问题

> ID：871163
> 
> 赞同：10
> 
> 时间：2009-05-15T22:43:45.617
> 
> 标签：python, html, django, django-templates, rendering

假设我有这个字符串：

```
s = '<p>Hello!</p>' 
```

当我将此变量传递给模板时，我希望将其呈现为原始 html。查看文档，我发现我可以使用安全过滤器：

```
{{s|safe}} 
```

或禁用自动转义：

```
{%autoescape off}
{{s}}
{%endautoescape%} 
```

或在 python 代码中声明它是安全的：

```
from django.utils.safestring import mark_safe
s = mark_safe(s) 
```

这些选项都不适合我。无论我做什么，字符串都显示为：

```
<p>Hello!</p> 
```

我一定错过了什么，只是不知道是什么。某处是否有一些安全设置不允许转义？

编辑：奇怪的是，我重新启动计算机后问题似乎消失了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-12-10T03:04:01.957

我认为你应该写如下

```
{{s|escape|safe}} 
```

我没问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T22:56:45.400

您几乎涵盖了它，这些确实是禁用自动转义的所有方法。

你确定你所说的价值实际上是`s = '<p>Hello!</p>'`？

我的预感是你在那个字符串的某个地方有额外的转义......

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2010-01-21T13:37:43.177

看HTML源码，是不是转义了！？？？我不这么认为。它应该是一个字母一个字母地打印，就像这样：

```
<
p
>
H
E
L
L
O
<
/
> 
```

# sql - mySQL Performant 请求在另一个请求的每一行的列中进行计数请求

> ID：871175
> 
> 赞同：0
> 
> 时间：2009-05-15T22:48:05.017
> 
> 标签：sql, mysql

我有一张桌子，上面有设备、他们购买的国家和购买日期。我想检索： - 按国家/地区划分的设备总数 - 以及每个国家/地区自 1 个月以来购买的设备数量。

我用这个请求来做这个：

```
SELECT countryCode, COUNT(*) AS sinceBeginning, (
SELECT COUNT(*) 
FROM mytable 
WHERE countryCode = table1.countryCode
AND buyedDate >= DATE_SUB( CURDATE( ) , INTERVAL 1 MONTH )
) AS sinceOneMonth
FROM mytable AS table1
GROUP BY countryCode
ORDER BY countryCode ASC"; 
```

但是每行的“sinceOneMonth”列的内部计数对于性能来说非常昂贵。有没有办法让这个请求更好？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T23:21:11.223

使用 countrycode 和 buyeddate 的复合索引可能会提高您的性能，如果您在不传递 countrycode 的情况下从不直接查询 buyeddate，那么您可能会删除 countrycode 上的索引并将其替换为复合索引。

以下查询可能会执行得更好，但不一定如此，它一如既往地取决于您的数据模式。

```
SELECT countrycode, 
       SUM(in_month) AS this_month, 
       COUNT(*)      AS all_time
FROM  ( 
         SELECT countrycode, 
                buyedDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AS in_month 
         FROM mytable
      ) AS summary 
GROUP BY countrycode; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T22:53:26.093

(countrycode,buyedDate) 上是否有索引？

编辑：Steve Weet 的查询进一步简化：

```
SELECT 
  countrycode
, SUM(buyedDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) AS this_month
, COUNT(*) AS all_time
FROM  mytable
GROUP BY countrycode 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T09:41:53.650

谢谢史蒂夫和安多玛，

随着请求：

> SELECT countrycode, COUNT( * ) AS sinceBeginning, SUM(buyedDate >= DATE_SUB( CURDATE( ) , INTERVAL 1 MONTH ) ) AS sinceOneMonth FROM mytable WHERE model =1 GROUP BY countrycode;

性能更好：原始请求需要 4 秒，现在需要 2 秒。测试结果：countrycode sinceBeginning sinceOneMonth 1 500101 20184，表中有 600.000 行

# javascript - 通过Javascript强制改变页面内容

> ID：871184
> 
> 赞同：0
> 
> 时间：2009-05-15T22:52:09.233
> 
> 标签：javascript, jquery, ajax

我想在 ajax 请求期间向用户展示一些视觉进度。例如，当他单击向服务器端脚本发出 AJAX 请求的“进程”按钮时，他会看到“正在加载...”消息和图形，但我也想向他展示一些处理进度完毕。比如`5/10 processed, 6/10 processed...`等等。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T23:02:10.817

我不知道您的服务器端进程实际上是什么，但是将其分解为一系列 Ajax 调用是否有意义，每个调用都执行该进程的一部分？然后你可以在每一步增加你的显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T09:11:17.447

是的，有，但有点复杂。我发现的唯一方法是在客户端上使用 iframe，并在服务器上使用 response.writeing 将 javascript 块发送回客户端，该 javascript 在父窗口上调用以处理状态消息。

这是一些示例代码。它可能有问题，我正在从一个更大的应用程序中删除它。

html:

```
<button id="doStuff">
<div id="status"></div>
<div id="iframeHolder"></div> 
```

javascript:

```
//This one will be called from the HTML the javascript is streaming back
function updateStatus(message) {
    $('#status').html(message);
}
$('#doStuff').click(function(event) {
    event.preventDefault();
    var url="your.page.html";
    $('#iframeHolder').html('<iframe src="' + url + '"></iframe>');
} 
```

服务器端（这是 vb asp.net，但你应该可以用你选择的语言来做）：

```
dim message as string = "hello world"
dim script = String.Format("<script type='text/javascript'>parent.updateStatus('{0}');</script>",message)
Response.Write(script)
Response.Flush() 
```

一些观察

*   Querystring 将成为您的朋友。我不确定您是否可以以编程方式回发到 iframe
*   您可能必须向查询字符串添加一些缓存清除垃圾，否则浏览器很可能会缓存内容。它会非常非常快，但错误:-)
*   在浏览器开始处理 iframe 内容之前，您可能需要发送“一些”html。我发现发送大约 1k 垃圾的 HTML 评论会有所帮助
*   为避免 FF 中的刷新问题以及 chrome 和 safari 中的“永远加载”问题，完成后将 iframe 的 src 设置为 about:blank ( `$('#iframeHolder iframe').attr('src','about:blank')`)
*   jQuery UI 进度条在显示处理百分比方面看起来很时髦

希望有帮助。几个月前，我为此撕毁了我的头:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T23:02:32.967

进度条实现的 jQuery + PHP 示例，轮询服务器端脚本以获取剩余百分比。[点击这里](http://t.wits.sg/misc/jQueryProgressBar/demo.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-15T23:08:04.513

`XMLHttpRequest`在 Safari 4 和 Firefox 3.5 中，您可以按如下方式确定 an 的进度：

```
var url = "[URL to file]";
var request = new XMLHttpRequest();

request.onprogress = function(e) {
    if (e.lengthComputable) {
        var percentComplete = (e.loaded / e.total) * 100;
        console.log("Progress: " + percentComplete + "%");
    }
    else {
        // Code to execute when we can't get the progress
    }
};

request.open("GET", url, true);
request.send(""); 
```

有关更多信息，请参阅Mozilla 开发人员网络上的[此页面](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Monitoring_progress)

# ruby - Ruby中的“对象”命名类

> ID：871185
> 
> 赞同：3
> 
> 时间：2009-05-15T22:52:14.507
> 
> 标签：ruby, class

如果我在模块内使用 Object 作为我的类的名称，它有什么缺点吗？

```
module Some
  class Object; end
end 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T23:40:19.757

实际上，这段代码应该没有问题，因为它在一个模块中，因此是命名空间的。对于一个简单的测试：

```
module Some
  class Object
    def foo
      "bar"
    end
  end
end

Some::Object.new.foo # "bar"
Some::Object.new.class # "Some::Object"

# And it doesn't pollute the global namespaced Object class:
Object.new.respond_to?(:foo) # false 
```

但是，如果您在另一个类或模块中包含 Some，它可能会令人困惑或模棱两可，其中 Object 将引用 Some::Object。但是，它仍然不会影响该类或模块之外的任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T06:44:50.933

有一些陷阱，但它有效。如果这样做，您将扩展 Ruby 中已有的 Object 类。

```
class Object
  def hello
  end
end 
```

但是，当您为其命名空间时，您将在该命名空间中创建一个新类。

```
module Foo
  class Object
    # ...
  end
end 
```

从技术上讲，这不是问题。

一个缺点是`::Object`当你想引用内置`Object`类时必须使用。不过，你不会经常这样做，所以这不是一个大问题。

另一个问题是这可能会让其他开发人员感到非常困惑，您应该考虑到这一点。很难从你的代码片段中看出你的这个`Some::Object`类做了什么，但也许`Some::Record`，`Some::Entity`更有意义。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-15T22:58:58.313

`Object`是 Ruby 中的保留字，因此不应将其用作类的名称。

# eclipse - 将 Eclipse 与大型工作区一起使用

> ID：871187
> 
> 赞同：4
> 
> 时间：2009-05-15T22:52:42.210
> 
> 标签：eclipse, eclipse-rcp

我们当前的产品基于 Eclipse RCP。当我们尝试将整个代码库放在一个 Eclipse 工作区中时，我们开始遇到问题，我们想知道其他人在做什么。

这是我们的设置：

1.  ~225 个 Eclipse 项目（全部在主干/项目中）
2.  约 30 个 Eclipse 功能（全部在主干/功能中）
3.  约 90 万行代码

我们发现了一些不同的瓶颈：

1.  Windows 上的 SVN 非常慢（尝试过 TortoiseSVN、SmartSVN、命令行 svn），更新可能需要 5-8 分钟以上，并且只更新 10 个小文件。唯一合理的客户是 subclipse/subversive，但是这些还有其他问题，我们遇到了一些麻烦。
2.  Eclipse Refresh 可能需要 3-5 分钟
3.  Eclipse 构建可能需要 5-15 分钟

我相信该解决方案限制了任何开发人员在任何给定时间都需要签出并处于活动状态的项目数量，我只是想看看其他人是否有任何对他们有用的良好实践/政策。

例如，我的第一个想法是将目标平台设置为来自主干的最后一个“安全”构建，然后在此之上检查项目。这有效，但不会告诉您是否破坏了任何依赖于您有效覆盖的项目的项目。

另一个想法是使用项目集并以这种方式检查您需要的内容。

有没有其他人遇到过这个问题？如果是这样，你在做什么来绕过它？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T23:13:14.800

我们为这种配置采用的策略是以**部署**概念为中心的。

任何项目都负责构建并*对其*要交付的文件集进行版本控制（jar、war、ear 等）。

这意味着：

*   任何负责测试所有系统的“集成团队”都可以在向 VCS 的一个请求中快速更新所有交付，而无需全部重建。因此出现了“部署”一词：这种方法有助于实现这一点。

*   更重要的是，对于您的问题，任何项目只需要查询它需要编译的交付，以便工作和进行代码演变。

因此，对于任何给定的项目，实际上只有一个在 eclipse 中打开，它指的是来自其他项目的各种库。

这也迫使我们：

*   重新考虑我们所有项目之间的各种依赖关系（检测某些要删除的循环依赖关系），
*   重新检查我们的应用架构，当我们意识到几个项目过于“小粒度”并且需要聚合在一起时。

* * *

基本上有两种方法：

*   基于系统，所有应用程序的每个部分都可以一起开发，并且您对所需的每个项目都有源依赖关系
*   基于组件，您的项目没有源依赖，仅依赖于库。

在 eclipse-plugin 方法上，需要找到一个中间地带：
来自同一域的所有项目（如“ `com.mycorp.fileutil[.XXX]`”）可以由 eclipse 项目表示，它们之间具有源依赖关系。但是“ `com.mycorp.fileutil`”需要的任何其他不属于该域的组件都应该作为库导入，而不是作为源依赖项。因此我们的“以部署为中心，首先发布”的观点。

# python - XPath - 如何查询满足属性存在条件的父节点？

> ID：871188
> 
> 赞同：1
> 
> 时间：2009-05-15T22:52:42.803
> 
> 标签：python, xml, xpath

我需要查询一个节点以确定它是否有一个包含指定属性的父节点。例如：

```
<a b="value">
    <b/>
</a> 
```

从 b 作为我的焦点元素，我想执行一个 XPath 查询：

```
..[@b] 
```

这将返回元素**a**。返回的元素*必须是***a**的父节点，并且不应包含**a**的任何兄弟节点。

lxml.etree 库声明这是一个无效的 XPath 表达式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-15T23:05:54.863

您不能将`.`or`..`速记与谓词结合使用。相反，您需要使用全`parent::`轴。以下内容应该适合您：

```
parent::*[@b] 
```

这将选择父节点（无论其本地名称如何），IFF 它具有“b”属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T23:00:38.010

我不了解 lxml.etree 库，但`..[@b]`它是~~完全有效的 XPath~~（**更新**：请参阅 Ben Blank 的评论）。与 相同`parent::a[@b]`，它将在`a`元素处返回上下文。

# ruby-on-rails - 设置 Capistrano 任务以仅在部署时运行，而不是部署：冷

> ID：871191
> 
> 赞同：1
> 
> 时间：2009-05-15T22:53:39.587
> 
> 标签：ruby-on-rails, ruby, installation, capistrano, deployment

我正在使用 craken 在我的 aws 机器实例上运行 cron 进程。我在 Capistrano 中定义了以下自定义任务：

```
namespace :craken do
  desc "Install raketab"
  task :install, :roles => :cron do
    set :rails_env, "production" unless exists?(:rails_env)
    set :env_args, (exists?(:env_args) ? env_args : "app_name=#{application} deploy_path=#{current_path}")
    run "cd #{current_path} && rake #{env_args} RAILS_ENV=#{rails_env} craken:install"
  end
  task :uninstall, :roles => :cron do
    set :rails_env, "production" unless exists?(:rails_env)
    set :env_args, (exists?(:env_args) ? env_args : "app_name=#{application} deploy_path=#{current_path}")
    run "cd #{current_path} && rake #{env_args} RAILS_ENV=#{rails_env} craken:uninstall"
  end
end

before "deploy:symlink", "craken:uninstall"
after "deploy:symlink", "craken:install" 
```

问题是之前的 "deploy:symlink", "craken:uninstall" 导致 deploy:cold 在第一次运行时失败，因为 craken raketab 尚未安装。我如何将其配置为仅在它是部署而不是部署时运行：冷？有我可以检查的环境变量吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-12T21:04:43.280

不再推荐使用 deploy:cold 任务。

[http://www.capify.org/index.php/From_The_Beginning#About_deploy:cold](http://www.capify.org/index.php/From_The_Beginning#About_deploy:cold)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T23:11:18.297

快速破解，将破解：卸载更改为

运行“cd #{current_path} && rake #{env_args} RAILS_ENV=#{​​rails_env} craken:uninstall; true”

或者在 deploy:update 上挂钩破解任务

# php - PostgreSQL 未显示在 phpconfig() 函数上（在 Windows 上）

> ID：871195
> 
> 赞同：1
> 
> 时间：2009-05-15T22:55:43.950
> 
> 标签：php, postgresql

我刚刚安装了 Apache 2.2.11 并下载了 PHP5.2.9-2 的 zip

我没有评论

> 扩展=php_pdo_pgsql.dll

和

> 扩展=php_pgsql.dll

但是当我调用 phpinfo() 函数时，postgresql 没有出现。我忘记了什么？

另外，在 PHP 网站上，我发现了这个：

> 为了启用 PostgreSQL 支持，编译 PHP 时需要 --with-pgsql[=DIR]。DIR 是 PostgreSQL 基本安装目录，默认为 /usr/local/pgsql。如果共享对象模块可用，可以使用 php.ini 或 dl() 函数中的扩展指令加载 PostgreSQL 模块。我知道这是为 Linux 准备的，但是这里是否写了一些东西，告诉我做一些我忘记的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T23:25:32.227

在您`php.ini`确保该`extension_dir`指令指向包含 php_pgsql.dll 文件的文件夹。

还要检查您的 HTTP 错误日志是否有错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T23:34:09.553

更改 php.ini 后是否重新启动 Apache？在执行重新启动之前，Apache 中的 PHP 模块不会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T01:57:50.757

您仍然需要 pgsql 的“客户端库”部分来加载 php_pgsql.dll 或 php_pdo_pgsql.dll。此外，为了将来参考，您可以使用[Dependency Walker](http://www.dependencywalker.com/)之类的工具来加载 PHP dll 文件并查看缺少的运行时链接。

# cocoa - 从 dmg 安装 OS X 应用程序时创建拖放图形

> ID：871199
> 
> 赞同：5
> 
> 时间：2009-05-15T22:58:23.367
> 
> 标签：cocoa, macos, installation, dmg

最初打开安装程序 DMG 时，mac 上的许多应用程序会显示一个小图形 - 该图形基本上允许您将应用程序拖放到该窗口中，而无需在 finder 中进行（我不是在谈论包管理器） ）。

知道是否有创建这种体验的标准方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-15T23:06:10.010

这些“图形”只是背景图片和应用程序文件夹的别名。

通过转到视图选项并选择图片，可以将背景图像添加到文件夹中。请注意，要使其在 DMG 上工作，图片必须位于该磁盘映像上（通常不可见）

如果您需要更多选项，也可以查看[DMG Maker 。](http://www.versiontracker.com/dyn/moreinfo/mac/10622)

编辑：

似乎该链接不再有效。您还可以使用磁盘实用程序并按照[本](http://murphymac.com/slib/customized-dmg-container.htm)教程进行操作。本教程将引导您创建磁盘映像并添加您自己的自定义背景图片。

[EDIT PART DEUX：这里](http://www.ploem.be/blog/?page_id=26)有另一个教程

# wpf - 嵌套的 WPF 数据网格

> ID：871205
> 
> 赞同：7
> 
> 时间：2009-05-15T22:59:02.837
> 
> 标签：wpf, xaml, wpftoolkit

我有一个 DataGrid（来自工具包），我想在 DataGrid.RowDetailsTemplate 中嵌套另一个 DataGrid。诀窍是我想从主网格中的一个表中取回数据，然后根据行选择从另一个表中获取附加详细信息，并将其显示在详细信息模板的 DataGrid 中。

这很容易在 2 个单独的 DataGrids 中完成，但我无法让它与嵌套版本一起使用。

这甚至可能吗？如果是这样，有人可以指出我正确的方向。我应该注意我正在使用 LinqToSql 类来填充数据。

感谢您的考虑。-乔尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-10-29T19:03:07.430

如果您使用的是 LinqToSQL，您可以使用关联轻松完成此操作。在我的实践中，我创建了两个表：

盖伊表

*   名
*   姓
*   唯一身份

GuyActions表

*   唯一身份
*   盖伊ID
*   动作描述

我创建了一个从 GuyTable.UniqueID 到 GuyActionsTable.GuyID 的一对多关系，称为“GuyActions”

然后我像这样绑定我的 DataGrid。请原谅我手动执行此操作时出现的任何错误：

```
<w:DataGrid ItemsSource={Binding Source={StaticResource YourDataSource}}>
<w:DataGrid.RowDetailsTemplate>
    <DataTemplate>
        <w:DataGrid ItemsSource={Binding GuyActions}>
            <w:DataGrid.Columns>
                <w:DataGridTextColumn Header="Action" DisplayMemberBinding="{Binding Action_Description}" />
            </w:DataGrid.Columns>
        </w:DataGrid>
    </DataTemplate>
</w:DataGrid.RowDetailsTemplate>
<w:DataGrid.Columns>
    <w:DataGridTextColumn Header="First Name" DisplayMemberBinding="{Binding First_Name}" />
    <w:DataGridTextColumn Header="Last Name" DisplayMemberBinding="{Binding Last_Name}" />
</w:DataGrid.Columns> 
```

# java - JUnit：可能“期望”一个包装的异常？

> ID：871216
> 
> 赞同：49
> 
> 时间：2009-05-15T23:04:20.747
> 
> 标签：java, exception, junit

我知道可以在 JUnit 中定义一个**“预期的”**异常，这样做：

```
@Test(expect=MyException.class)
public void someMethod() { ... } 
```

但是，如果总是抛出相同的异常，但具有不同的“嵌套” **原因**怎么办。

有什么建议么？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-12-24T11:04:25.523

从 JUnit 4.11 开始，您可以使用`ExpectedException`规则的[`expectCause()`](http://junit.czweb.org/apidocs/org/junit/rules/ExpectedException.html#expectCause(org.hamcrest.Matcher))方法：

```
import static org.hamcrest.CoreMatchers.*;

// ...

@Rule
public ExpectedException expectedException = ExpectedException.none();

@Test
public void throwsNestedException() throws Exception {
    expectedException.expectCause(isA(SomeNestedException.class));

    throw new ParentException("foo", new SomeNestedException("bar"));
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-15T23:34:43.030

您可以将测试代码包装在 try / catch 块中，捕获抛出的异常，检查内部原因，记录 / 断言 / 任何内容，然后重新抛出异常（如果需要）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-16T03:28:31.893

如果您使用的是最新版本的 JUnit，您可以扩展默认测试运行器来为您处理此问题（无需将每个方法包装在 try/catch 块中）

ExtendedTestRunner.java - 新的测试运行器：

```
public class ExtendedTestRunner extends BlockJUnit4ClassRunner
{
    public ExtendedTestRunner( Class<?> clazz )
        throws InitializationError
    {
        super( clazz );
    }

    @Override
    protected Statement possiblyExpectingExceptions( FrameworkMethod method,
                                                     Object test,
                                                     Statement next )
    {
        ExtendedTest annotation = method.getAnnotation( ExtendedTest.class );
        return expectsCauseException( annotation ) ?
                new ExpectCauseException( next, getExpectedCauseException( annotation ) ) :
                super.possiblyExpectingExceptions( method, test, next );
    }

    @Override
    protected List<FrameworkMethod> computeTestMethods()
    {
        Set<FrameworkMethod> testMethods = new HashSet<FrameworkMethod>( super.computeTestMethods() );
        testMethods.addAll( getTestClass().getAnnotatedMethods( ExtendedTest.class ) );
        return testMethods;
    }

    @Override
    protected void validateTestMethods( List<Throwable> errors )
    {
        super.validateTestMethods( errors );
        validatePublicVoidNoArgMethods( ExtendedTest.class, false, errors );
    }

    private Class<? extends Throwable> getExpectedCauseException( ExtendedTest annotation )
    {
        if (annotation == null || annotation.expectedCause() == ExtendedTest.None.class)
            return null;
        else
            return annotation.expectedCause();
    }

    private boolean expectsCauseException( ExtendedTest annotation) {
        return getExpectedCauseException(annotation) != null;
    }

} 
```

ExtendedTest.java - 用于标记测试方法的注释：

```
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.METHOD})
public @interface ExtendedTest
{

    /**
     * Default empty exception
     */
    static class None extends Throwable {
        private static final long serialVersionUID= 1L;
        private None() {
        }
    }

    Class<? extends Throwable> expectedCause() default None.class;
} 
```

ExpectCauseException.java - 新的 JUnit 语句：

```
public class ExpectCauseException extends Statement
{
    private Statement fNext;
    private final Class<? extends Throwable> fExpected;

    public ExpectCauseException( Statement next, Class<? extends Throwable> expected )
    {
        fNext= next;
        fExpected= expected;
    }

    @Override
    public void evaluate() throws Exception
    {
        boolean complete = false;
        try {
            fNext.evaluate();
            complete = true;
        } catch (Throwable e) {
            if ( e.getCause() == null || !fExpected.isAssignableFrom( e.getCause().getClass() ) )
            {
                String message = "Unexpected exception cause, expected<"
                            + fExpected.getName() + "> but was<"
                            + ( e.getCause() == null ? "none" : e.getCause().getClass().getName() ) + ">";
                throw new Exception(message, e);
            }
        }
        if (complete)
            throw new AssertionError( "Expected exception cause: "
                    + fExpected.getName());
    }
} 
```

用法：

```
@RunWith( ExtendedTestRunner.class )
public class MyTests
{
    @ExtendedTest( expectedCause = MyException.class )
    public void someMethod()
    {
        throw new RuntimeException( new MyException() );
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-15T23:41:33.310

你总是可以手动完成：

```
@Test
public void someMethod() {
    try{
        ... all your code
    } catch (Exception e){
        // check your nested clauses
        if(e.getCause() instanceof FooException){
            // pass
        } else {
            Assert.fail("unexpected exception");
        }
    } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-06-30T00:05:43.370

您可以为异常创建一个[匹配器。](http://kentbeck.github.com/junit/javadoc/latest/org/hamcrest/Matcher.html)即使您使用像[Arquillian](http://arquillian.org/)这样的另一个测试运行器，这也有效，`@RunWith(Arquillian.class)`因此您不能使用`@RunWith(ExtendedTestRunner.class)`上面建议的方法。

这是一个简单的例子：

```
public class ExceptionMatcher extends BaseMatcher<Object> {
    private Class<? extends Throwable>[] classes;

    // @SafeVarargs // <-- Suppress warning in Java 7\. This usage is safe.
    public ExceptionMatcher(Class<? extends Throwable>... classes) {
        this.classes = classes;
    }

    @Override
    public boolean matches(Object item) {
        for (Class<? extends Throwable> klass : classes) {
            if (! klass.isInstance(item)) {
                return false;
            }   

            item = ((Throwable) item).getCause();
        }   

        return true;
    }   

    @Override
    public void describeTo(Description descr) {
        descr.appendText("unexpected exception");
    }
} 
```

然后将它与[@Rule](http://kentbeck.github.com/junit/javadoc/latest/org/junit/Rule.html)和[ExpectedException](http://kentbeck.github.com/junit/javadoc/latest/org/junit/rules/ExpectedException.html)一起使用，如下所示：

```
@Rule
public ExpectedException thrown = ExpectedException.none();

@Test
public void testSomething() {
    thrown.expect(new ExceptionMatcher(IllegalArgumentException.class, IllegalStateException.class));

    throw new IllegalArgumentException("foo", new IllegalStateException("bar"));
} 
```

**Craig Ringer 在 2012 年添加的编辑：**增强且更可靠的版本：

*   基本用法与上面没有变化
*   可以传递可选的第一个参数`boolean rethrow`来抛出不匹配的异常。这保留了嵌套异常的堆栈跟踪，以便于调试。
*   使用[Apache Commons Lang](http://commons.apache.org/lang/) ExceptionUtils 处理原因循环并处理一些常见异常类使用的非标准异常嵌套。
*   自我描述包括接受的例外情况
*   失败的自我描述包括遇到异常的原因堆栈
*   处理 Java 7 警告。删除`@SaveVarargs`旧版本。

完整代码：

```
import org.apache.commons.lang3.exception.ExceptionUtils;
import org.hamcrest.BaseMatcher;
import org.hamcrest.Description;

public class ExceptionMatcher extends BaseMatcher<Object> {
    private Class<? extends Throwable>[] acceptedClasses;

    private Throwable[] nestedExceptions;
    private final boolean rethrow;

    @SafeVarargs
    public ExceptionMatcher(Class<? extends Throwable>... classes) {
        this(false, classes);
    }

    @SafeVarargs
    public ExceptionMatcher(boolean rethrow, Class<? extends Throwable>... classes) {
        this.rethrow = rethrow;
        this.acceptedClasses = classes;
    }

    @Override
    public boolean matches(Object item) {
        nestedExceptions = ExceptionUtils.getThrowables((Throwable)item);
        for (Class<? extends Throwable> acceptedClass : acceptedClasses) {
            for (Throwable nestedException : nestedExceptions) {
                if (acceptedClass.isInstance(nestedException)) {
                    return true;
                }
            }
        }
        if (rethrow) {
            throw new AssertionError(buildDescription(), (Throwable)item);
        }
        return false;
    }

    private String buildDescription() {
        StringBuilder sb = new StringBuilder();
        sb.append("Unexpected exception. Acceptable (possibly nested) exceptions are:");
        for (Class<? extends Throwable> klass : acceptedClasses) {
            sb.append("\n  ");
            sb.append(klass.toString());
        }
        if (nestedExceptions != null) {
            sb.append("\nNested exceptions found were:");
            for (Throwable nestedException : nestedExceptions) {
                sb.append("\n  ");
                sb.append(nestedException.getClass().toString());
            }
        }
        return sb.toString();
    }

    @Override
    public void describeTo(Description description) {
        description.appendText(buildDescription());
    }

} 
```

典型输出：

```
java.lang.AssertionError:  Expected: Unexpected exception. Acceptable (possibly nested) exceptions are:
   class some.application.Exception
Nested exceptions found were:
   class javax.ejb.EJBTransactionRolledbackException
   class javax.persistence.NoResultException
     got: <javax.ejb.EJBTransactionRolledbackException: getSingleResult() did not retrieve any entities.> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-16T00:46:06.837

为此，我编写了一个小小的 JUnit 扩展。静态辅助函数采用函数体和预期异常数组：

```
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import java.util.Arrays;

public class AssertExt {
    public static interface Runnable {
        void run() throws Exception;
    }

    public static void assertExpectedExceptionCause( Runnable runnable, @SuppressWarnings("unchecked") Class[] expectedExceptions ) {
        boolean thrown = false;
        try {
            runnable.run();
        } catch( Throwable throwable ) {
            final Throwable cause = throwable.getCause();
            if( null != cause ) {
                assertTrue( Arrays.asList( expectedExceptions ).contains( cause.getClass() ) );
                thrown = true;
            }
        }
        if( !thrown ) {
            fail( "Expected exception not thrown or thrown exception had no cause!" );
        }
    }
} 
```

您现在可以检查预期的嵌套异常，如下所示：

```
import static AssertExt.assertExpectedExceptionCause;

import org.junit.Test;

public class TestExample {
    @Test
    public void testExpectedExceptionCauses() {
        assertExpectedExceptionCause( new AssertExt.Runnable(){
            public void run() throws Exception {
                throw new Exception( new NullPointerException() );
            }
        }, new Class[]{ NullPointerException.class } );
    }
} 
```

这可以节省您一次又一次地编写相同的样板代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-22T16:12:14.913

最简洁的语法由[catch-exception](http://code.google.com/p/catch-exception/)提供：

```
import static com.googlecode.catchexception.CatchException.*;

catchException(myObj).doSomethingNasty();
assertTrue(caughtException().getCause() instanceof MyException); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-07-28T12:20:45.447

在 JUnit5 中，您可以使用`assertThrows`除了断言抛出的异常之外还返回它的方法，以便您可以对其执行额外的断言。

```
@Test
void test() {
    // Assert that parent exception is thrown and retrieve it
    ParentException parentException = assertThrows(ParentException.class, () -> methodThatThrowsException());
    // Perform assertions on the cause
    Throwable cause = parentException.getCause();
    assertThat(cause, ...);
}

void methodThatThrowsException() {
    throw new ParentException("foo", new SomeNestedException("bar"));
} 
```

# linq - 如何在 OS X 上的 MonoDevelop 2.0 中使用 Linq？

> ID：871230
> 
> 赞同：12
> 
> 时间：2009-05-15T23:09:33.823
> 
> 标签：linq, mono, monodevelop

我在我的 Mac 上安装了 MonoDevelop 2.0。

我创建了一个新的控制台应用程序。

“Hello World”程序运行良好。

但我不能使用Linq。

`using System.`不显示`Linq`选项。

我该怎么办？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-17T23:05:44.513

您可能需要在解决方案视图中右键单击您的项目，执行`Options`、`Build`、`General`，并将您的目标运行时设置为`Mono / .Net 3.5`或更大。

然后您可以右键单击引用，执行编辑引用，并将对 System.Core 的引用添加到您的项目中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T13:16:47.470

我在 Ubuntu 9.04 上运行 Monodevelop 2.0 和 Mono 2.0，而 lambda 和 Linq 工作正常。

与 Thomas Levesque 所说的相反，`System.Core`Mono 中确实存在。扩展方法，lambda's et al 都支持。

你需要使用`using System.Linq`.

```
public static void Example1()    
{

    List<string> people = new List<string>() 
    { 
        "Granville", "John", "Rachel", "Betty", 
        "Chandler", "Ross", "Monica" 
    };

    IEnumerable<string> query = from p in people where p.Length > 5 
    orderby p select p;

    foreach (string person in query) 
    {
        Console.WriteLine(person);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-15T23:22:53.077

您的控制台应用程序是否引用了`System.Core.dll`? 您需要引用它才能使用`System.Linq`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T02:34:17.687

Mono Develop 的最新版本确实支持 linq。在项目中，您必须在 Build/General/RuntimeVersion 下选择 3.5。之后，您可以添加 System.Core 引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T12:22:35.050

检查您的项目是否引用了 System. **Xml.Linq**库也是

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-16T13:10:03.367

不确定 LINQ 是否在当前版本中完全实现[http://www.mono-project.com/Roadmap](http://www.mono-project.com/Roadmap)

# c++ - 圆形无锁缓冲区

> ID：871234
> 
> 赞同：78
> 
> 时间：2009-05-15T23:11:25.427
> 
> 标签：c++, algorithm, multithreading, concurrency, lock-free

我正在设计一个连接到一个或多个数据馈送流的系统，并对数据进行一些分析，而不是根据结果触发事件。在典型的多线程生产者/消费者设置中，我将有多个生产者线程将数据放入队列，多个消费者线程读取数据，消费者只对最新的数据点加上 n 个点感兴趣。如果慢的消费者跟不上生产者线程将不得不阻塞，当然当没有未处理的更新时消费者线程将阻塞。使用带有读/写锁的典型并发队列会很好地工作，但数据进入的速度可能会很大，所以我想减少我的锁定开销，尤其是生产者的写锁。我认为我需要一个循环无锁缓冲区。

**现在有两个问题：**

1.  循环无锁缓冲区是答案吗？

2.  如果是这样，在我推出自己的产品之前，你知道任何符合我需要的公共实施吗？

任何实现循环无锁缓冲区的指针总是受欢迎的。

顺便说一句，在 Linux 上用 C++ 执行此操作。

**一些附加信息：**

响应时间对我的系统至关重要。理想情况下，消费者线程将希望尽快看到任何更新，因为额外的 1 毫秒延迟可能会使系统一文不值，或者价值大大降低。

我倾向于的设计思想是一个半无锁循环缓冲区，其中生产者线程尽可能快地将数据放入缓冲区中，让我们调用缓冲区 A 的头部，除非缓冲区已满，否则不会阻塞，当A 与缓冲区 Z 的末端相遇。消费者线程将分别持有两个指向循环缓冲区的指针 P 和 P [n]，其中 P 是线程的本地缓冲区头，P [n]是 P 之后的第 n 项。每个消费者线程将推进其 P和 P [n]一旦它完成处理当前 P 并且缓冲区指针 Z 的末尾以最慢的 P [n前进]. 当 P 赶上 A 时，这意味着不再需要处理新的更新，消费者旋转并忙于等待 A 再次前进。如果消费者线程旋转时间过长，它可以进入睡眠状态并等待条件变量，但我可以接受消费者占用 CPU 周期等待更新，因为这不会增加我的延迟（我将拥有更多的 CPU 内核比线程）。想象一下你有一个环形轨道，生产者跑在一堆消费者前面，关键是调系统，让生产者通常跑在消费者前面几步，而这些操作大部分都可以使用无锁技术完成。我知道要正确执行实施的细节并不容易……好吧，非常难，这就是为什么我想在自己犯一些错误之前从别人的错误中吸取教训。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-20T21:09:38.507

在过去的几年里，我对无锁数据结构进行了特别的研究。我已经阅读了该领域的大部分论文（只有大约 40 篇左右 - 尽管只有大约 10 到 15 篇真正有用:-)

AFAIK，尚未发明无锁循环缓冲区。问题将是处理读者超过作者或反之亦然的复杂情况。

如果您至少有六个月的时间没有学习无锁数据结构，请不要尝试自己编写。你会弄错，并且在你的代码在新平台上部署后失败之前，你可能并不明显存在错误。

但是我相信有一个解决方案可以满足您的要求。

您应该将无锁队列与无锁空闲列表配对。

free-list 将为您提供预分配，因此消除了对无锁分配器的（财政上昂贵的）要求；当空闲列表为空时，您可以通过立即从队列中取出一个元素并使用它来复制循环缓冲区的行为。

（当然，在基于锁的循环缓冲区中，一旦获得锁，获得一个元素非常快——基本上只是一个指针解引用——但在任何无锁算法中你都不会得到它；他们经常不得不去很好地做事；失败的自由列表弹出然后出队的开销与任何无锁算法需要做的工作量相当）。

早在 1996 年，Michael 和 Scott 就开发了一个非常好的无锁队列。下面的链接将为您提供足够的详细信息来追踪他们论文的 PDF；[迈克尔和斯科特，先进先出](http://www.cs.rochester.edu/research/synchronization/pseudocode/queues.html)

无锁空闲列表是最简单的无锁算法，实际上我认为我没有看过关于它的实际论文。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-05-16T01:09:29.683

您想要的艺术术语是无**锁队列**。有一组很棒的笔记，其中包含Ross Bencina[的代码和论文链接。](http://www.audiomulch.com/~rossb/code/lockfree/)我最信任他的工作的人是[莫里斯·赫利希](http://www.cs.brown.edu/people/mph/)（对于美国人来说，他的名字发音为“莫里斯”）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-16T00:44:33.503

如果缓冲区为空或已满，则生产者或消费者阻塞的要求建议您应该使用正常的锁定数据结构，使用信号量或条件变量使生产者和消费者阻塞，直到数据可用。无锁代码通常不会在这种情况下阻塞 - 它会旋转或放弃无法完成的操作，而不是使用操作系统进行阻塞。（如果你可以等到另一个线程产生或消费数据，那为什么还要等待另一个线程完成更新数据结构的锁更糟糕呢？）

在 (x86/x64) Linux 上，如果没有争用，使用互斥锁的线程内同步相当便宜。专注于最大限度地减少生产者和消费者需要锁定的时间。鉴于您已经说过您只关心最后 N 个记录的数据点，我认为循环缓冲区可以很好地做到这一点。但是，我真的不明白这如何符合阻塞要求以及消费者实际消费（删除）他们读取的数据的想法。（您是否希望消费者只查看最后 N 个数据点而不删除它们？您是否希望生产者不关心消费者是否跟不上，而只是覆盖旧数据？）

此外，正如 Zan Lynx 评论的那样，当您有大量数据进入时，您可以将数据聚合/缓冲成更大的块。您可以缓冲固定数量的点，或者在一定时间内接收到的所有数据. 这意味着将有更少的同步操作。不过，它确实会引入延迟，但如果您不使用实时 Linux，那么无论如何您都必须在一定程度上处理它。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-09-13T17:49:00.917

boost库中的实现值得考虑。它易于使用且性能相当高。我编写了一个测试并在一台四核 i7 笔记本电脑（8 个线程）上运行它，每秒获得约 4M 的入队/出队操作。到目前为止未提及的另一个实现是[http://moodycamel.com/blog/2014/detailed-design-of-a-lock-free-queue](http://moodycamel.com/blog/2014/detailed-design-of-a-lock-free-queue)上的 MPMC 队列。我在有 32 个生产者和 32 个消费者的同一台笔记本电脑上对这个实现做了一些简单的测试。正如宣传的那样，它比 boost 无锁队列更快。

由于大多数其他答案表明无锁编程很难。大多数实现都很难检测到需要大量测试和调试才能修复的极端情况。这些通常通过在代码中仔细放置内存屏障来解决。您还将在许多学术文章中找到正确性证明。我更喜欢使用蛮力工具测试这些实现。您计划在生产中使用的任何无锁算法都应使用[http://research.microsoft.com/en-us/um/people/lamport/tla/tla.html](http://research.microsoft.com/en-us/um/people/lamport/tla/tla.html)之类的工具检查其正确性。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-16T00:02:06.617

[在 DDJ 上](http://www.ddj.com/hpc-high-performance-computing/210604448)有很多关于此的系列文章。作为这个东西有多难的标志，它是对[早期文章](http://www.ddj.com/hpc-high-performance-computing/208801974;jsessionid=RHHIHFIMCY2COQSNDLRSKH0CJUNN2JVN?_requestid=266833)的更正，它弄错了。确保在自己动手之前了解错误）-;

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-16T23:31:58.130

萨特的队列是次优的，他知道这一点。The Art of Multicore programming 是一个很好的参考，但不要相信内存模型上的 Java 人。罗斯的链接不会给你明确的答案，因为他们的图书馆有这样的问题等等。

做无锁编程是自找麻烦，除非你想在解决问题之前花很多时间在你明显过度设计的事情上（从它的描述来看，这是一种“寻求完美”的常见疯狂' 在缓存一致性中）。这需要数年时间，导致不能先解决问题，然后再优化，这是一种常见病。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-16T03:37:43.227

减少争用的一种有用技术是将项目散列到多个队列中，并让每个消费者专注于一个“主题”。

对于您的消费者感兴趣的最新数量的项目 - 您不想锁定整个队列并遍历它以找到要覆盖的项目 - 只需在 N 元组中发布项目，即所有 N 个最近的项目。实现的奖励点，生产者将阻塞完整队列（当消费者无法跟上时）超时，更新其本地元组缓存 - 这样您就不会对数据源施加背压。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-06-17T14:30:00.860

我不是硬件内存模型和无锁数据结构的专家，我倾向于避免在我的项目中使用它们，我使用传统的锁定数据结构。

但是我最近注意到视频： [基于环形缓冲区的无锁 SPSC 队列](https://skillsmatter.com/skillscasts/6163-high-performance-single-producer-single-consumer-in-memory-queue)

这是基于交易系统使用的名为 LMAX distruptor 的开源高性能 Java 库：[LMAX Distruptor](https://lmax-exchange.github.io/disruptor/)

根据上面的介绍，您可以使头指针和尾指针原子化，并以原子方式检查头从后面抓住尾巴的情况，反之亦然。

您可以在下面看到一个非常基本的 C++11 实现：

```
// USING SEQUENTIAL MEMORY
#include<thread>
#include<atomic>
#include <cinttypes>
using namespace std;

#define RING_BUFFER_SIZE 1024  // power of 2 for efficient %
class lockless_ring_buffer_spsc
{
    public :

        lockless_ring_buffer_spsc()
        {
            write.store(0);
            read.store(0);
        }

        bool try_push(int64_t val)
        {
            const auto current_tail = write.load();
            const auto next_tail = increment(current_tail);
            if (next_tail != read.load())
            {
                buffer[current_tail] = val;
                write.store(next_tail);
                return true;
            }

            return false;  
        }

        void push(int64_t val)
        {
            while( ! try_push(val) );
            // TODO: exponential backoff / sleep
        }

        bool try_pop(int64_t* pval)
        {
            auto currentHead = read.load();

            if (currentHead == write.load())
            {
                return false;
            }

            *pval = buffer[currentHead];
            read.store(increment(currentHead));

            return true;
        }

        int64_t pop()
        {
            int64_t ret;
            while( ! try_pop(&ret) );
            // TODO: exponential backoff / sleep
            return ret;
        }

    private :
        std::atomic<int64_t> write;
        std::atomic<int64_t> read;
        static const int64_t size = RING_BUFFER_SIZE;
        int64_t buffer[RING_BUFFER_SIZE];

        int64_t increment(int n)
        {
            return (n + 1) % size;
        }
};

int main (int argc, char** argv)
{
    lockless_ring_buffer_spsc queue;

    std::thread write_thread( [&] () {
             for(int i = 0; i<1000000; i++)
             {
                    queue.push(i);
             }
         }  // End of lambda expression
                                                );
    std::thread read_thread( [&] () {
             for(int i = 0; i<1000000; i++)
             {
                    queue.pop();
             }
         }  // End of lambda expression
                                                );
    write_thread.join();
    read_thread.join();

     return 0;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-16T05:29:44.923

我同意[这篇文章](http://queue.acm.org/detail.cfm?id=1454462)并建议不要使用无锁数据结构。一篇相对较新的关于无锁fifo队列的论文是[this](http://www.cs.chalmers.se/~tsigas/papers/latest-spaa01.ps.gz)，搜索相同作者的更多论文；还有一篇关于 Chalmers 的关于无锁数据结构的博士论文（我失去了链接）。但是，您并没有说您的元素有多大——无锁数据结构仅适用于字大小的项目，因此如果元素大于机器字（32 或 64），则必须动态分配元素位）。如果您动态分配元素，则将（假设，因为您没有分析您的程序并且您基本上正在进行过早优化）瓶颈转移到内存分配器，因此您需要一个无锁内存分配器，例如[Streamflow](http://people.cs.vt.edu/~scschnei/streamflow/)，并将其与您的应用程序集成。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-04-19T08:54:01.030

这是一个旧线程，但由于尚未提及 - 在 JUCE C++ 框架中有一个无锁、循环、1 个生产者 -> 1 个消费者、FIFO 可用。

[https://www.juce.com/doc/classAbstractFifo#details](https://www.juce.com/doc/classAbstractFifo#details)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2017-09-15T19:41:03.083

虽然这是一个老问题，但没有人提到[DPDK](http://dpdk.org/ "DPDK")的无锁环形缓冲区。它是一个高吞吐量的环形缓冲区，支持多个生产者和多个消费者。它还提供了单消费者和单生产者模式，并且在SPSC模式下环形缓冲区是免等待的。它是用 C 语言编写的，支持多种架构。

此外，它支持 Bulk 和 Burst 模式，其中项目可以批量入队/出队。该设计让多个消费者或多个生产者同时写入队列，只需通过移动原子指针来保留空间。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2019-12-31T03:32:51.220

前段时间，我找到[了一个很好的解决](https://github.com/bittnkr/uniq)这个问题的方法。我相信它是迄今为止发现的最小的。

存储库有一个示例，说明如何使用它创建 N 个线程（读取器和写入器），然后共享一个席位。

我在测试示例上做了一些基准测试，得到了以下结果（以百万次操作/秒为单位）：

**按缓冲区大小**

[![吞吐量](https://i.stack.imgur.com/TgkKs.png)](https://i.stack.imgur.com/TgkKs.png)

**按线程数**

[![在此处输入图像描述](https://i.stack.imgur.com/laMSX.png)](https://i.stack.imgur.com/laMSX.png)

请注意线程数如何不改变吞吐量。

我认为这是这个问题的最终解决方案。它的工作原理令人难以置信的快速和简单。即使有数百个线程和单个位置的队列。它可以用作线程之间的管道，在队列内分配空间。

你能打破它吗？

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-03-11T15:22:22.317

只是为了完整性：在[OtlContainers](http://code.google.com/p/omnithreadlibrary/source/browse/trunk/OtlContainers.pas)中有经过良好测试的无锁循环缓冲区，但它是用 Delphi 编写的（TOmniBaseBoundedQueue 是循环缓冲区， TOmniBaseBoundedStack 是有界堆栈）。在同一单元（TOmniBaseQueue）中还有一个无界队列。无界队列在[动态无锁队列中进行了描述——做对了](http://17slon.com/blogs/gabr/2010/02/dynamic-lock-free-queue-doing-it-right.html)。有界队列（循环缓冲区）的初始实现在[无锁队列中有所描述，终于！](http://17slon.com/blogs/gabr/2010/02/dynamic-lock-free-queue-doing-it-right.html)但此后代码已更新。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-03-21T08:53:08.663

查看[Disruptor](http://lmax-exchange.github.io/disruptor/)（[如何使用它](http://code.google.com/p/disruptor/wiki/BlogsAndArticles)），它是一个可供多个线程订阅的环形缓冲区：

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-20T21:33:38.333

这是我的做法：

*   将队列映射到数组
*   使用下一次读取和下一次写入索引保持状态
*   保留一个空的完整位向量

插入包括使用具有增量的 CAS 并在下一次写入时翻转。一旦你有一个插槽，添加你的值，然后设置与之匹配的空/满位。

删除需要在测试下溢之前检查该位，但除此之外，与写入相同，但使用读取索引并清除空/满位。

被警告，

1.  **我不是这些方面的专家**
2.  当我使用原子 ASM 操作时，它们似乎非常慢，因此如果您最终使用的操作不止几个，那么使用嵌入/删除函数中的锁可能会更快。理论是，单个原子操作来获取锁，然后（非常）少数非原子 ASM 操作可能比几个原子操作完成的相同操作更快。但是要完成这项工作需要手动或自动内联，所以这只是 ASM 的一小部分。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2018-11-29T09:39:05.203

在某些情况下，您不需要锁定来防止竞争条件，尤其是当您只有一个生产者和消费者时。

考虑LDD3中的这段：

> 如果仔细实施，循环缓冲区在没有多个生产者或消费者的情况下不需要锁定。生产者是唯一允许修改写入索引及其指向的数组位置的线程。只要写入器在更新写入索引之前将新值存储到缓冲区中，读取器将始终看到一致的视图。反过来，阅读器是唯一可以访问读取索引及其指向的值的线程。稍加注意以确保两个指针不会相互溢出，生产者和消费者可以同时访问缓冲区，而不会出现竞争条件。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-07-24T14:32:51.390

你可以试试[lfqueue](https://github.com/Taymindis/lfqueue)

使用简单，圆形设计无锁

```
int *ret;

lfqueue_t results;

lfqueue_init(&results);

/** Wrap This scope in multithread testing **/
int_data = (int*) malloc(sizeof(int));
assert(int_data != NULL);
*int_data = i++;
/*Enqueue*/
while (lfqueue_enq(&results, int_data) != 1) ;

/*Dequeue*/
while ( (ret = lfqueue_deq(&results)) == NULL);

// printf("%d\n", *(int*) ret );
free(ret);
/** End **/

lfqueue_clear(&results); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-07-17T20:14:39.197

如果您以缓冲区永远不会变满为先决条件，请考虑使用此无锁算法：

```
capacity must be a power of 2
buffer = new T[capacity] ~ on different cache line
mask = capacity - 1
write_index ~ on different cache line
read_index ~ on different cache line

enqueue:
    write_i = write_index.fetch_add(1) & mask
    buffer[write_i] = element ~ release store

dequeue:
    read_i = read_index.fetch_add(1) & mask
    element
    while ((element = buffer[read_i] ~ acquire load) == NULL) {
        spin loop
    }
    buffer[read_i] = NULL ~ relaxed store
    return element 
```

# java - 为了重构庞大的代码库，我应该记住什么？

> ID：871238
> 
> 赞同：12
> 
> 时间：2009-05-15T23:15:20.533
> 
> 标签：java, architecture, refactoring, layer

我将在一个庞大的代码库（18000 多个 Java 类）中重构某些部分。目标是能够将较低层提取为独立的库，以便在当前使用此代码库副本的其他项目中重用。特别是有一部分值得重构为独立于业务逻辑的框架。最终我希望代码有一个干净的架构分层。

我使用名为 Structure 101 for java 的工具查看了代码，发现了很多（！）架构分层问题，其中低层引用了上层。

我不想简单地开始弄乱代码，而是尝试提出一个合理的策略来解决这个问题。我应该记住什么？

我正在考虑至少采取一些小步骤。我也在考虑进行单元测试，但这需要创建它们，因为没有。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T00:10:42.243

您还应该看看 Michael Feathers 的使用遗留代码：

[http://www.amazon.com/Working-Effectively-Legacy-Robert-Martin/dp/0131177052/ref=sr_1_1?ie=UTF8&s=books&qid=1242430219&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0131177052)

我认为你可以用来促进这一点的最重要的事情之一是测试，以确保在重构​​/拉出到单独的模块后一切仍然有效。通过引入一个持续集成系统来添加这一点，该系统会在您签入某些内容时运行您的测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T00:05:31.723

18,000 个班级真的正在走向“巨大”的结局。这会给您带来明显的问题，包括构建/编译时间以及启动 ide 时计算机冒烟。

我的第一个假设是，对于这么多类，有很多重复的通用功能，可能还有未使用的类，甚至可能是子系统。我希望这是因为当事情变得那么大时，开发人员越来越有可能不了解整个系统，或者不知道那些 Util 函数在哪里，并且发现编写一个新函数更容易。寻找要删除的冗余将有助于简化。

另一个可能的冗余来源是无用的深层类层次结构，或者一堆毫无意义的接口（一个例子——我工作的地方有一个大约 50 个类的目录，大多数 > 1000 行（不是我的，不是我的！）。这些实现中的每一个一个接口，它只不过是它自己的方法骨架。这些接口没有其他实现。所有 50 个可以毫无问题地删除）。还有一些开发人员刚刚发现了面向对象并且非常热衷于它——你知道的，扩展了 5 个抽象类和 3 个接口链的单个具体实现。

除此之外，我会尝试获取一段代码（最多几百个类）并将它们移动到一个子项目，然后我将其作为 jar 链接到主项目。然后，您可以稍微平静地工作，并有合理的希望能够理解整个事情-这也有心理方面的影响-如果您觉得自己在工作，就没有做好工作的动力处理一个巨大的、难以理解的混乱，而不是在你自己完全理解的干净子项目上工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-15T23:29:36.773

第一件事：祝你好运，你会需要它。这可能是你遇到的一项巨大的工作。这对我来说听起来很熟悉；我过去做过类似的事情。

需要考虑的一件事；在你开始重构之前，我真的强烈考虑建立一个广泛的测试框架。原因是这样的：通过良好的单元测试和回归测试，您可以开始进行更改，而不必过多担心破坏现有功能。（也就是说，总是有一个问题，但是......）

也就是说：我会考虑切掉不同的“垂直”功能切片，看看你是否可以为它们编写不同的单元和集成测试；完成后，我会加入并开始进行重构。虽然一开始它可能非常小，但是仅仅隔离垂直部分的功能，然后为它编写集成和单元测试代码的过程会让你对现有的代码库有很多经验。如果你一开始设法让它变得更好一点，那么你就领先了那么多。

完成之后，开始查看可能更大的功能块进行重构。如果无法获得干净的功能块来重构，我会开始研究小块；如果你能找到一小块（有时非常小）的代码来提取、单元测试和重构，那么你就在前进。有时这可能看起来非常非常缓慢，如果你有一个非常大的项目，它会，但你会有所作为。

但总的来说，首先考虑进行测试以确认预期的功能。一旦这些测试到位，你就可以自信地重构（不是完全自信，但总比没有好）你没有破坏任何东西。从小处着手，并建立在现有代码库之外的技术之上。这是一个漫长的过程，但你最终会到达那里，并且代码库会更好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-15T23:22:01.643

在我的脑海中：

*   识别*功能*域，这将有助于在庞大的代码库中定义应用程序。
*   反过来，确定这些应用程序之间的依赖关系：底部的那些（所有其他应用程序都使用）通常是技术框架或库。

*   创建[场景测试](https://stackoverflow.com/questions/351983/are-scenario-tests-groups-of-sequential-unit-tests)（而不是单元测试，在这个阶段太多“本地化”）来识别重要的运行时过程及其输出。场景测试更关注集成，也可以用于非回归测试。

*   准备一个当前的生产环境并确定当前的错误，因为当您开始重构时将需要并行运行（以确保您仍然保持相同的功能正常工作），并且您不希望您的并行运行是 100% 兼容的（因为这意味着你已经成功地重现了这些错误！）

*   确保创建适当的[合并工作流](https://stackoverflow.com/questions/216212#216228)来管理代表不同（并且可能是并行的）重构工作的不同分支。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-15T23:25:32.740

如果您要提取类组并将它们变成独立的库，请确定组的成员并开始将它们变成一个有凝聚力的整体，限制它们与外部世界的交互。尽可能减少依赖。完成后，拉出那个组，把它变成一个库，重新插入库，然后开始一个新的组。你清理的垃圾越多，就越容易理解剩下的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T23:45:13.537

尝试使您的依赖关系树尽可能平坦。

做到这一点的一种好方法是使用反向依赖，其他代码可以依赖于接口/服务，但不依赖于该服务的提供者。这对我们帮助很大。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T23:38:35.410

只是一些想法：

*   寻找常见的设计模式——尝试查看哪些类用于核心工作，哪些是工厂，哪些是外观或适配器。
*   将代码拆分为依赖于或共享应用程序状态的类组。
*   确定哪些类具有持久对象，以及那些在数据库中序列化的对象（应该是最容易隔离的，提供最干净的事务接口，然后可以在项目之间移植）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T00:32:08.760

我的想法是，在设置好测试基础设施之后，如果可以将测试代码的共同特征抽象出来，你可以为测试用例编写代码生成工具，也许静态代码分析工具可以作为可视化工具之外的附加组件。对不起，这是一个想法。我什至无法命名这些工具。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-16T00:32:59.083

我与我正在处理的代码库处于类似的位置。swing UI 和业务逻辑之间非常紧密的集成。重构是一个微妙而耗时的项目。

我强烈推荐 Martin Fowler 的[Refactoring](http://books.google.com/books?id=1MsETFPD3I0C&dq=refactoring&printsec=frontcover&source=bn&hl=en&ei=IgkOSrOqH5GatAOJqNTrAg&sa=X&oi=book_result&ct=result&resnum=4)。这是我发现的最重要的工具，它帮助我改进了处理糟糕代码库的方法。他概述了重构任何代码的逻辑和直接的过程。从多次这样做的人那里阅读它会有所帮助。

# iphone - 是否可以同时拥有多个动画代表？

> ID：871242
> 
> 赞同：1
> 
> 时间：2009-05-15T23:18:03.507
> 
> 标签：iphone, cocoa-touch, uikit, core-animation

我担心这是不可能的，因为 UIView 的 +setAnimationDelegate: 是一个类方法。但也许我错了？

背景：问题是，我有很多同一个类的对象，我想实现一个方法，专门为那个对象做一些漂亮的动画。这些动画有点复杂，由几个阶段组成。所以我需要在动画停止时得到通知。现在，该类中的 10 个对象可能会同时开始动画。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T23:48:50.843

每个动画块都有自己的委托。`+[UIView setAnimationDelegate:]`并且仅在和`+[UIView setAnimationDidStopSelector:]`之间调用时才执行任何操作，并且仅影响该块设置的动画。`+[UIView beginAnimations:context:]``+[UIView commitAnimations]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T23:43:36.410

为多个对象设置不同的动画代理的唯一方法是让它们成为 UIView 的单独子类。如您所想，由于`+setAnimationDelegate:`是类方法，因此您不能为同一类的不同实例设置单独的动画委托。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T04:54:41.733

该`+[UIView beginAnimations:context:]`方法允许您传递一个特定`context`的传递给完成方法。当调用完成方法时，您可以使用该上下文来消除各种实例之间的歧义。

由于上下文被键入为a `(void *)`，它几乎可以是您想要的任何内容，即指向对象实例、唯一ID 或自定义结构的指针。

如果您的对象都实现了一个通用协议，您可以将它们作为上下文传递并在`animationDidStop`方法中，只需调用协议定义的方法。因此，即使您只有一个类范围的`animationDidStop`方法，它也可以充当扇出方法调度程序。

# firefox - Firefox 扩展需要多长时间才能通过审核以进行公开发布？

> ID：871244
> 
> 赞同：0
> 
> 时间：2009-05-15T23:19:33.597
> 
> 标签：firefox, firefox-addon

大约 2 周前，我提名了一个我为公开发布而制作的 Firefox 扩展。它似乎足够稳定并获得了许多积极的评价，所以时间感觉是对的。

我还没有收到 Mozilla 的任何消息。在事情进展之前我应该​​等待多长时间？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T23:53:46.387

根据您的附加组件的功能，我已经看到它需要几个月的时间。不过，这个较长的时间框架通常适用于特定于站点的附加组件。

您最好的选择是发送电子邮件至 amo-editors@mozilla.org 以索取估价，并附上您的附加组件的链接。

# excel - 星战队如何压制消息

> ID：871252
> 
> 赞同：1
> 
> 时间：2009-05-15T23:23:47.270
> 
> 标签：excel, compare, starteam

在比较 Excel 文件时，我收到以下消息：

```
---------------------------
StarTeam
---------------------------
One or more files are not text only!  Do you still want to use alternative compare utility C:\Program Files\Beyond Compare 3\BComp.exe?
---------------------------
Yes   No   Cancel   
--------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T23:31:25.177

Excel 2007 文件实际上是包含多个 XML“部分”文件的压缩档案。这个错误很明显。压缩档案不是文本文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-01T21:35:03.007

不幸的是，您不能禁用此弹出消息框。我从来没有找到任何设置或破解方法来绕过它。

# javascript - jQuery 忽略响应

> ID：871260
> 
> 赞同：1
> 
> 时间：2009-05-15T23:31:10.373
> 
> 标签：javascript, jquery, html, ajax

嗨，有人知道为什么我的警报不起作用吗？

```
<script type="text/javascript">
    function SubmitForm(method) {
        var login = document.form.login.value;
        var password = document.form.password.value;
        $.post("backend.php", { 
            login: login, 
            password: password, 
            method: method},
            function(data){
            alert(data.message); 
            console.log(data.refresh); 
        }, "json");
    }
</script> 
```

来自 backend.php 的响应是

```
backend{"message":"Log in credentials are not correct","refresh":"false"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T23:37:01.887

为什么你的回复开头是“后端”？我将从删除它开始。从 { 到 } 的一切看起来都不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T23:38:00.293

虽然我不认为这是您的问题，但回调函数确实采用了第二个参数（jQuery 文档将其称为“textStatus”），它是 HTTP 状态的文本表示。为您的回调指定第二个参数。

```
function(data, textStatus) { ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T23:54:33.357

Great_llama 是对的，出于某种原因，我有一个“后端”在脚本中进一步回响。删除这个，一切都过去了。

# c++ - “运算符 = 必须是非静态成员”是什么意思？

> ID：871264
> 
> 赞同：26
> 
> 时间：2009-05-15T23:33:13.940
> 
> 标签：c++, class, operator-overloading, non-static

我正在创建一个双链表，并重载了 operator= 以使列表等于另一个：

```
template<class T>
void operator=(const list<T>& lst)
{
    clear();
    copy(lst);
    return;
} 
```

但是当我尝试编译时出现此错误：

```
container_def.h(74) : error C2801: 'operator =' must be a non-static member 
```

此外，如果有帮助，第 74 行是定义的最后一行，带有“}”。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-15T23:40:34.233

正是它所说的：运算符重载必须是成员函数。（在类内声明）

```
template<class T>
void list<T>::operator=(const list<T>& rhs)
{
    ...
} 
```

此外，从 = 返回 LHS 可能是个好主意，这样您就可以将它链接起来（如`a = b = c`） - 所以让它 `list<T>& list<T>::operator=....`

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-15T23:44:32.663

将该运算符放在您的类定义中。它必须是一个成员，因为它`operator=`很特别，无论如何你都不会通过将它写成非成员来获得什么。非会员运营商有两个重要的主要好处：

*   *运算符调用右侧和*左侧的隐式转换
*   无需了解班级的内部情况。功能可以实现为非会员非好友。

对于`operator=`，两者都不可用。分配给转换的临时结果没有意义，并且`operator=`在大多数情况下需要访问内部。此外，`operator=`如果您不提供，C++ 会自动提供一个特殊的（所谓的复制赋值运算符）。使`operator=`作为非成员重载成为可能会引入额外的复杂性，而显然没有实际收益，因此这是不允许的。

因此，更改您的代码，使其看起来像这样（这假设`operator=`不是复制赋值运算符，而是从 a 分配*给*`list<T>`其他东西。这从您的问题中不清楚）：

```
class MyClass {
...
    template<class T>
    MyClass& operator=(const list<T>& lst)
    {
        clear();
        copy(lst);
        return *this;
    }
...
}; 
```

`operator=`a 再次返回对自身的引用是非常标准的。我建议你坚持这种做法。它对程序员来说看起来很熟悉，如果它`void`突然返回，可能会引起意外。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-15T23:40:34.577

如果将运算符重载为成员函数，则应使用此模板：

```
class A {
  A& operator=(const A& other) {
    if (this != &other) {
      ...
    }
    return *this;
  }
} 
```

需要注意的三点：

1.  使用赋值运算符检查自赋值（如上）；
2.  参数应该是一个常量引用；和
3.  将运算结果作为非常量引用返回，您可以在其中返回 *this 以允许链接运算符。

您还可以重载类外部的运算符。这与此示例无关，因为您不能使用赋值运算符来执行此操作，但值得注意的是，因为在许多情况下它优于成员函数。典型的形式是：

```
class A {
  friend const A& operator+(const A& a, const A& b);
  ...
}
const A& operator+(const A& a, const A& b) {
  A& ret = ...
  return ret;
} 
```

这个返回一个 const 引用，所以你不能这样做：

```
(a + b) = c 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-15T23:47:40.597

来自 C++ 标准，“二元运算符”：

“二元运算符应由具有一个参数的非静态成员函数或具有两个参数的非成员函数实现”

它希望您在类中将其定义为成员，或使其成为静态方法（在这种情况下，它应该采用两个参数（对于 lval 和 rval）。

# c++ - 你如何转移 boost::ptr_vector 元素的所有权？

> ID：871267
> 
> 赞同：7
> 
> 时间：2009-05-15T23:34:28.337
> 
> 标签：c++, boost

```
#include <boost/ptr_container/ptr_vector.hpp>
#include <iostream>

using namespace std;
using namespace boost;

struct A {
    ~A() { cout << "deleted " << (void*)this << endl; }
};

int main() {
    ptr_vector<A>   v;
    v.push_back(new A);
    A   *temp = &v.front();
    v.release(v.begin());
    delete temp;
    return 0;
} 
```

输出：

> ```
> deleted 0x300300
> deleted 0x300300
> c(6832) malloc: *** error for object 0x300300: double free 
> ```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-16T02:10:29.427

`ptr_vector<A>::release`返回 a `ptr_vector<A>::auto_type`，这是一种轻量级的智能指针，当一个`auto_type`项目超出范围时，它指向的东西会被自动删除。要恢复指向该事物的原始指针，并防止它被`auto_ptr`持有它的人删除，您也需要调用`release`它：

```
int main() {
    ptr_vector<A> v;
    v.push_back(new A);
    A *temp=v.release(v.begin()).release();
    delete temp;
    return 0;
} 
```

第一个`release`告诉`ptr_vector`放弃它；第二个告诉`auto_ptr`它也放弃它。

# c++ - MSVC++ 中的“Ch”是什么？

> ID：871277
> 
> 赞同：1
> 
> 时间：2009-05-15T23:39:30.930
> 
> 标签：c++, visual-c++, lines

我正在考虑我的代码，我不小心点击`Ln 74`了 MSVC++ 窗口底部的 。我得到一个屏幕，`Line number (1 - 136):`上面写着 ，它把光标跳到我输入的行。当我单击`Col 1`或时，`Ch 1`我得到相同的屏幕。

我知道`Ln 74`意味着我在第 74 行，并且`Col 1`意味着我在第 1 列，但这是什么`Ch 1`意思？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-15T23:42:36.383

人物1？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T01:28:17.640

正如保罗所写，这可能是性格。列和字符之间的差异是由于制表符的宽度。制表符是一个可以占据多列的字符。

# cookies - 跟踪 cookie 是如何工作的？

> ID：871283
> 
> 赞同：5
> 
> 时间：2009-05-15T23:41:30.347
> 
> 标签：cookies

我们试图弄清楚常见的网络跟踪软件是如何工作的，比如谷歌分析。

我们注意到，来自网络的许多跟踪 Javascript 代码会在访问者的系统上创建多个 cookie，通常是三个 cookie——一个在一天结束时到期，一个在周末到期，一个在在月底。

我们的团队一直在争论为什么这很普遍，我们一直在努力弄清楚为什么有人会这样做。

我们唯一能想到的就是性能：通过这种方式，您可以计算访问者是否每天、每周或每月重复访问，而无需一直在 OLTP 数据库上进行繁重的查询。但是我们可以想办法让它发挥作用。

以这种方式创建跟踪 cookie 有什么优势，您认为其他人如何使用它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T23:51:41.930

他们可能正在以这种方式使用 cookie 来确定访问域的频率。如果您访问该网站并且它指出您仍然有过期的 cookie，那么这对您的访问频率而言非常重要。如果您只有每周和每月，那么很明显您至少有一天没有访问该站点，并且持续一周内。

没有规则说这是执行此操作的唯一方法。可以使用单个 cookie 进行跟踪并将统计信息存储在服务器上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T00:42:10.903

非常有趣的问题。我认为这是解决[酒店问题](http://en.wikipedia.org/wiki/Web_analytics#The_hotel_problem)的方法。让我们从数据库查询的角度来看看。如果将单个 cookie 发送给用户（到期日期例如等于一年），则该站点的每日访问次数将如下所示：

```
SELECT COUNT(DISTINCT CookieId) FROM Visits 
WHERE VisitDate = '2009-01-01' AND SiteId = 548 
```

使用多 cookie 系统，您只需存储每个站点每天发出的 cookie 数量，并在每次发送新 cookie 时递增：

```
SELECT NoOfVisits FROM Visits 
WHERE VisitDate = '2009-01-01' AND SiteId = 548 
```

当每年发布数亿个 cookie 时，这是一个明显的性能优势。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T11:54:09.853

每天、每周和每月使用 3 个 cookie 意味着客户端会针对每个请求向您发送 3 个 cookie，从网络带宽和延迟的角度来看，这显然是不好的。

所以，你显然应该有一个平衡的行为......如果你更关心用户延迟而不是数据库中的服务器 cpu 使用率，则只使用一个 cookie，如果你更关心服务器 cpu 使用率而不是用户延迟，则使用 3 cookie 方法。

真正的解决方案是进行混合：仅使用一个 cookie，然后在每天结束时执行第一个查询并将结果存储在单独的表或列中，这样您的统计界面只需查询该单独的结果。

# ruby - 如何通过 ssh 在远程机器上使用 ffmpeg

> ID：871296
> 
> 赞同：2
> 
> 时间：2009-05-15T23:48:05.543
> 
> 标签：ruby, linux, ffmpeg

我的局域网上有三台计算机，

一台运行*ubuntu*，
一台运行*openSuse*
，我的服务器运行*Archlinux*。

我只设法让**ffmpeg**在我的服务器上正常工作。

我想编写一个脚本，假装是本地机器上的**ffmpeg**安装，但实际上只是使用服务器的**ffmpeg**。

**例子：**

> 在我想调用的 openSuse 电脑上：
> 
> `ffmpeg -i file.avi out.flv`
> 
> 然后得到预期的正常输出，
> 但我希望它在archlinux上使用ffmpeg。

关于如何让它发挥作用的任何建议。
（最好在 Ruby 中）

编辑：我已将此问题扩展到[如何通过 ssh 从 shell 命令显示进度条](https://stackoverflow.com/questions/872380)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T00:59:25.450

这里有一些选项，首先是最简单的：

*   在 LAN 上设置 NFS，远程安装服务器上的所有磁盘，然后`ssh`使用远程安装的名称运行命令。使用奇怪名称的负担在于用户。

*   设置 NFS，但解析 ffmpeg 选项以识别输入和输出文件，然后使用`realname`包（或简单的 shell 脚本）之类的东西首先将名称转换为绝对路径名，然后再转换为远程安装的名称。

*   不要使用 NFS，而是解析 ffmpeg 选项并用于`scp`复制输入文件和输出文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T06:31:20.893

我没有很多红宝石，但这似乎有效！

先决条件，

```
sudo yum install rubygems
sudo gem install net-ssh net-sftp highline echoe 
```

代码（带注释），

```
#!/usr/bin/env ruby

require 'rubygems'
require 'net/ssh'
require 'net/sftp'
require 'highline/import'

file = ARGV[ 0 ]                  # filename from command line
prod = file + "-new"              # product filename (call it <file>-new)
rpath = "/tmp"                    # remote computer operating directory
rfile = "#{rpath}/#{file}"        # remote filename
rprod = "#{rpath}/#{prod}"        # remote product
cmd  = "mv #{rfile} #{rprod}"     # remote command, constructed

host = "-YOUR REMOTE HOST-"
user = "-YOUR REMOTE USERNAME-"
pass = ask("Password: ") { |q| q.echo = false }  # password from stdin

Net::SSH.start(host, user, :password => pass) do |ssh|
        ssh.sftp.connect do |sftp|
                # upload local 'file' to remote 'rfile'
                sftp.upload!(file, rfile)

                # run remote command 'cmd' to produce 'rprod'
                ssh.exec!(cmd)

                # download remote 'rprod' to local 'prod'
                sftp.download!(rprod, prod)
        end
end 
```

然后我可以这样运行，

```
dylan@home ~/tmp/ruby) ls
bar  remotefoo.rb*
dylan@home ~/tmp/ruby) ./remotefoo.rb bar
Password: 
dylan@home ~/tmp/ruby) ls
bar  bar-new  remotefoo.rb* 
```

# svn - 如何从 Subversion 存储库 (Apache) 以纯文本形式提供 VBS 和其他文件类型？

> ID：871297
> 
> 赞同：1
> 
> 时间：2009-05-15T23:48:23.840
> 
> 标签：svn, text, apache2, mime-types, apache-config

我只想浏览我的 Subversion 代码存储库并查看文件。某些文件类型（如 .VBS）会提示我打开或保存文件，但我只想在浏览器中以纯文本形式查看它。可以修改 Apache 的 httpd.conf 文件来执行此操作吗？我认为它不会在客户端（IE7）上改变，因为那样它在所有站点上的工作方式都是一样的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T14:26:25.977

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T23:55:30.330

将以下内容放入您的 httpd.conf

```
<IfModule mime_module>
AddType text/plain .vbs
</IfModule> 
```

# c++ - 需要帮助理解 C 函数

> ID：871300
> 
> 赞同：1
> 
> 时间：2009-05-15T23:49:48.207
> 
> 标签：c++, c

这是交易：作为学习经验，我正在尝试将 C 程序转换为 C++。[该程序](http://www.zompist.com/sounds.htm)采用文本文件并根据用户输入的规则对其进行修改。具体来说，它使用格式为“s1/s2/env”的规则将声音更改应用于一组单词。s1 表示要更改的字符，s2 表示要更改的内容，env 是应用更改的上下文。

很抱歉我没有更深入地描述这个问题，但是这个问题太长了，作者的网站已经解释过了。

我遇到问题的功能是 TryRule。我知道它应该查看给定规则是否适用于给定字符串，但我无法准确理解它是如何做到的。参数的糟糕解释让我感到困惑：例如，我不明白为什么必须将字符串“s1”和“s2”传回，或者“i”代表什么。

这是代码：

```
/*
**  TryRule
**
**  See if a rule s1->s2/env applies at position i in the given word.
**
**  If it does, we pass back the index where s1 was found in the
**  word, as well as s1 and s2, and return TRUE.
**
**  Otherwise, we return FALSE, and pass garbage in the output variables.
*/
int TryRule( char *word, int i, char *Rule, int *n, char **s1, char **s2, char *varRep )
    {
        int j, m, cont = 0;
        int catLoc;
        char *env;
        int  optional = FALSE;
        *varRep = '\0';

        if (!Divide( Rule, s1, s2, &env ) || !strchr( env, '_' ))
            return(FALSE);

        for (j = 0, cont = TRUE; cont && j < strlen(env); j++)
        {
            switch( env[j] )
            {
                case '(':
                    optional = TRUE;
                    break;

                case ')':
                    optional = FALSE;
                    break;

                case '#':
                    cont = j ? (i == strlen(word)) : (i == 0); 
                    break;

                case '_':
                    cont = !strncmp( &word[i], *s1, strlen(*s1) );
                    if (cont)
                    {
                        *n = i;
                        i += strlen(*s1);
                    }
                    else
                    {
                        cont = TryCat( *s1, &word[i], &m, &catLoc );
                        if (cont && m)
                        {
                            int c;
                            *n = i;
                            i += m;

                            for (c = 0; c < nCat; c++)
                                if ((*s2)[0] == Cat[c][0] && catLoc < strlen(Cat[c]))
                                    *varRep = Cat[c][catLoc];
                        }
                        else if (cont)
                            cont = FALSE;
                    }
                    break;

                default:
                    cont = TryCat( &env[j], &word[i], &m, &catLoc );
                    if (cont && !m)
                    {
                        /* no category applied */
                        cont = i < strlen(word) && word[i] == env[j];
                        m = 1;
                    }
                    if (cont)
                        i += m;
                    if (!cont && optional)
                        cont = TRUE;
            }
        }
        if (cont && printRules)
            printf( "   %s->%s /%s applies to %s at %i\n", 
            *s1, *s2, env, word, *n );

    return(cont);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T01:41:44.113

这段代码......很难阅读。我查看了原始文件，它确实可以使用一些更好的变量名。我特别喜欢其中一个功能评论中的这一部分：

```
/*
** (Stuff I removed)
**
** Warning: For now, we don't have a way to handle digraphs. 
**
** We also return TRUE if (<- It really just stops here!)
*/ 
```

我可以看到挑战。我同意 wmeyer 关于变量的观点。我想我明白了，所以我将尝试将函数转换为伪代码。

Word：我们正在查看的字符串
i：我们正在查看的字符串中的索引
Rule：规则的文本（即“v/b/_”）
n：一个变量，用于返回我们找到的字符串的索引_ 的匹配，我认为
s1：返回规则的第一部分，从规则中解码
s2：返回规则的第二部分，从规则中解码
varRep：返回类别中匹配的字符，如果类别匹配， 我认为

```
int TryRule( char *word, int i, char *Rule,
                int *n, char **s1, char **s2, char *varRep ) {
        Prepare a bunch of variables we''ll use later
        Mark that we''re not working on an optional term
        Set varRep''s first char to null, so it''s an empty string

        if (We can parse the rule into it''s parts
              OR there is no _ in the environment (which is required))
            return FALSE // Error, we can't run, the rule is screwy

        for (each character, j, in env (the third part of the rule)) {
            if (cont is TRUE) {
                switch (the character we''re looking at, j) {
                    if the character is opening paren:
                        set optional to TRUE, marking it''s an optional character
                    if the character is closing paren:
                        set optional to FALSE, since we''re done with optional stuff
                    if the character is a hash mark (#):
                        // This is rather complicated looking, but it's not bad
                        // This uses a ? b : c, which means IF a THEN b ELSE c
                        // Remember i is the position in the word we are looking at
                        // Hash marks match the start or end of a word
                        // J is the character in the word

                        if (j >= 0) {
                            // We're not working on the first character in the rule
                            // so the # mark we found is to find the end of a word

                            if (i == the length of the word we''re looking at) {
                                // We've found the end of the word, so the rule matches

                                continue = true;   // Keep going
                            } else {
                                // We're not at the end of a word, but we found a hash
                                // Rule doesn't match, so break out of the main loop by setting
                                //     continue to false

                                continue = false;
                            }
                        } else {
                            // OK, the hash mark is the first part of env,
                            // so it signifies the start of a word

                            continue = (i == 0);   // Continue holds if we
                                                   // are matching the first
                                                   // character in *word or not
                        }
                    if the character is an _ (the match character):
                        // This gets complicated

                        continue = if word starting at character i ISN''T s1, the search string;

                        if (continue == TRUE) {
                            // There was no match, so we'll go look at the next word
                            n = the index of the word start that didn''t match   // Not sure why
                            i = i (start index to look) + length of s1 (word we just matched)
                            // This means i now holds the index of the start of the next word
                        } else {
                            // TryCat sees if the character we're trying to match is a category

                            continue = s1 is a category in the program
                                          && the category contains the character at word[i]

                            // If continue holds false, s1 was a category and we found no match
                            // If continue holds true, s1 either wasn't a category (so m = 0)
                            //     or s1 WAS a category, m contains 1, and catLoc holds which
                            //     character in the category definition was matched

                            if (we found a match of some sort
                                   && s1 was a category (indicated by m == 1)) {
                                n = index of the character in the word we found a match
                                i = the index of the next character (m is always 1, so this is ugly)

                                for (each category defined) {
                                    if (first character of s2
                                           == the category''s name
                                        && where in the category definition we matched
                                              is less than the length of the category we''re on) {
                                           varRep = the character matched in the category
                                        }
                                }

                                // Now the above seems EXACTLY like the TryCat function. You'd
                                // think varRep would always hold the same value as catLoc. I
                                // believe this loop is so that later rules also get applied?
                            } else {
                                continue = FALSE; // Because we didn't match a letter or category
                            }
                        }
                    Any other character:
                        continue = the character we''re looking at is a category in the program
                                      && the category contains the character at word[i]

                        if (there was a match AND it wasn''t a category (m == 0, just a letter)) {
                            m = 1;
                            continue if and only if there are characters left in the word
                                 (i < strlen()) && the current character is at word[i]
                                 (we matched a literal character, instead of a category)
                        }

                        if (continue)
                            i = i + m // Remember, M is always 1 or 0
                                      // So this is basically IF continue THEN i++ END IF
                        if ((continue == FALSE) && (optional == TRUE))
                            // We didn't find a match, but we're working on an optional part
                            // So continue anyway
                            continue = TRUE;
                end switch
             end if continue == true
        }
    }

    if (continue && printRules)
        print out a little debug statement showing what we matched

    return continue;   // At this point, if continue is false we can't keep matching
} 
```

我希望这有帮助。你可能需要多读几遍。我花了 45 多分钟来写这篇文章，几乎完全是因为试图准确地解读 TryCat 周围的一些案例中发生了什么。添加大约 5 分钟，以不断尝试按 Tab 键并将光标发送到下一个字段（愚蠢的 HTML 文本框）。

抱歉，它太大了，你可能不得不做一堆水平滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T00:26:00.770

鉴于您正在从 C 转换为 C++，您应该重构代码以使其更具可读性。

这段代码的一个主要问题是变量的名字很糟糕，我敢打赌，即使是例程的原始作者也需要花一些时间来分析它。

只需将变量重命名为更精确，就可以更好地理解代码的作用。

看看在[重构下标记的一些问题以](https://stackoverflow.com/questions/tagged/refactoring)获得一些帮助。还有[Martin Fowler 的 Refactoring](https://rads.stackoverflow.com/amzn/click/com/0201485672)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T00:35:03.730

我认为你需要[整个代码](http://www.zompist.com/sounds.c.htm)来理解这个片段。

看起来“word”、“i”和“Rule”是输入变量，其余的都是纯输出变量。

“i”是“word”中的当前索引，即 TryRule 只查看从“word[i]”开始的“word”。

在“s1”中，函数返回所应用规则的左侧。在“s2”该规则的右侧。

在“n”中，该函数返回规则适用的“word”中的位置。

不知道“varRep”是什么。

# algorithm - 如何创建 MEME 算法？

> ID：871311
> 
> 赞同：0
> 
> 时间：2009-05-15T23:56:36.083
> 
> 标签：algorithm, aggregate-functions, blogs

如果你不知道 meme 是什么意思，你可以阅读这篇文章 [readwriteweb](http://www.readwriteweb.com/archives/news_aggregation_methods.php)

我的问题是如何创建一个 meme 算法，我有一个网站，汇集了数千篇博客文章，我想找出最受关注的故事。

从上面的文章中看到这个引用

> “模因聚合试图通过找出最受关注的新闻（因此，希望是最重要的）来降低信噪比。”

有谁知道如何做到这一点？，

他们有简单的教程吗？

因为我数学不太好。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T02:31:47.550

没有“正确”的方式来做这样的事情。有不同的方法可以实现这一点，您需要选择一种可以实现/运行并以您喜欢的方式运行的方法。从你理解的简单的事情开始，然后从那里开始。

例如：

Ben Reeves 建议“（带有特定标签的博客文章数量/博客文章总量）”和 pagerank 方法。如果这些以适合您的方式选择主题，请与他们一起去。

这里有几个其他的建议，

您可以根据托管网站的受欢迎程度为帖子添加权重。例如，发布在纽约时报上的内容可能应该被认为比 Joe Shmoes 博客上的内容更受欢迎，并且应该获得更多的权重。这类似于页面排名方法，在实践中可能几乎没有区别。

您可以添加时间因素，因此主题的发布速度有多快很重要。例如，如果主题 B 从上周有 30 个帖子，而主题 C 从今天有 10 个帖子，您可能希望认为主题 C 更受欢迎。如果主题 D 在过去一年中每周有 2 个帖子怎么办？过去一小时有 5 个帖子的主题 E 怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-28T04:26:03.223

获取 T. Segaran 的《编程集体智能》一书

[http://shop.oreilly.com/product/9780596529321.do](http://shop.oreilly.com/product/9780596529321.do)

它介绍并很好地解释了流行度和排名算法的关键概念，并在 Python 中提供了全面的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T08:03:21.530

变量：

*   数数
*   时间
*   内容

计算内容出现的次数。如果它发生得足够频繁，那么它就符合条件。它也需要最近发生，否则计数不相关。内容需要很好地相关以避免误报。

看看雅虎上下文搜索和关键字 API 供初学者使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T00:43:45.003

假设您想找到最受欢迎的主题？实际计算可能很简单，但是需要处理的数据量会很大。

*（带有特定标签的博文数量/博文总量）=标签的流行度*

显然，您需要一个要忽略的常见标签/单词列表

然后与该标签相关的最受欢迎的帖子 =*包含该标签的其他帖子中最常链接的博客帖子。*

此外，更复杂的是，您可以使用 pagerank 样式计算来计算链接的权重。[http://www.webworkshop.net/pagerank.html](http://www.webworkshop.net/pagerank.html) - 这实际上是随机浏览时您将登陆特定页面的概率，即最受欢迎的页面

/我的 2 美分

# linux - 读取和写入 cron 脚本使用的数据的好地方？

> ID：871316
> 
> 赞同：1
> 
> 时间：2009-05-16T00:04:15.660
> 
> 标签：linux, bash, ubuntu, cron

我正在编写一个每小时执行一次的脚本。它基本上可以作为：

1.  读取数据文件（如果存在）。
2.  如果数据文件具有某些内容，则执行操作。
3.  改写或创建数据文件。

我将把脚本放在 Ubuntu 上的 /etc/cron.hourly/ 中，让它每小时执行一次。

存储数据文件的好地方是什么？该脚本以 root 身份运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T00:56:18.420

首先，数据文件和 cron 作业都应该以您的应用程序命名。其次，如果我理解正确，您的数据正在由 cron 作业更改，而不是由人工编辑。因此，[文件系统层次结构标准规定](http://www.pathname.com/fhs/)，如果应用程序被命名`foo`，那么 cron 作业应该是`/etc/cron.hourly/foo`，数据文件应该是`/var/lib/foo`. 原因在于，`/var/lib`给出的目的如下：

> 此层次结构保存与应用程序或系统有关的状态信息。状态信息是程序在运行时修改的数据，属于特定主机。用户永远不需要修改文件`/var/lib`来配置包的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T00:06:35.933

`/opt`和/或`/var`通常是这样做的好地方。显然从那里缩小范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T00:55:30.560

的子目录[`/var`](http://www.pathname.com/fhs/pub/fhs-2.3.html#PURPOSE31)是系统读取和修改数据的正确位置。有关更多信息，请参阅[文件系统层次标准](http://www.pathname.com/fhs/pub/fhs-2.3.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T00:21:16.523

如果是只读数据：

```
/usr/local/share/program_name 
```

如果它是一个配置文件（或多个文件）：

```
/usr/local/etc/program_name 
```

除非它是非常具体的东西，应该进入 /var/spool、/var/run 或其他地方。还有`/opt/XXX`学校...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T00:59:35.353

如果是临时数据，那么 /tmp 或 /var/tmp 是标准目录。持久数据可以放置在文件系统中进程可以读取和写入的任何区域中。我通常在树中的某个位置创建一个“数据”目录，该目录的进程具有写入权限，例如 ~/data、/app/data 等。

# iphone - 我可以在 UIView +beginAnimations:context: 的 context 参数中设置什么样的值？

> ID：871318
> 
> 赞同：1
> 
> 时间：2009-05-16T00:06:18.820
> 
> 标签：iphone, cocoa-touch, uikit, core-animation

我不明白这一点：

```
+ (void)beginAnimations:(NSString *)animationID context:(void *)context 
```

(void *) ----> 我可以在这里提供什么样的数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T05:16:14.147

使用它来传递指向您正在制作动画的对象的指针。当你调用时，`setAnimationDidStopSelector`你必须给它一个方法选择器来调用。该方法的签名必须采用以下形式：

```
- (void)animationDidStop:(NSString *)animationID 
                finished:(NSNumber *)finished 
                 context:(void *)context 
```

您在其中定义的上下文值`beginAnimations`原封不动地传递给此方法。它只是一个 (void *)，它是“指向任何你想要的任何东西的指针”的简写。一个对象，一个整数，一个结构。任何。

将其视为“userData”，而不是“上下文”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T01:36:53.127

`void *`表示任何类型的指针数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T02:48:25.763

传递你想要的任何东西；`void *`意味着它是一个没有类型的缓冲区，所以系统会忽略它的内容。

下次谷歌搜索“void *”可能会帮助你弄清楚它的含义——我假设你只是不明白为什么它会被系统忽略（这只是为了你的方便）。

# .net - 如何限制 .Net 程序集在特定机器上运行

> ID：871322
> 
> 赞同：0
> 
> 时间：2009-05-16T00:10:50.510
> 
> 标签：.net, policy

我们有一个服务器应用程序，我们希望限制非用户从其他机器触发它，甚至通过双击任何共享。

但是，开发人员应该很容易在他们的盒子上运行它。

执行此政策的各种方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T00:21:42.420

有几种方法可以控制程序集的访问。

我们在许可的基础上保护我们的程序集，因此只有拥有许可的工作站才能运行程序集。

我们允许开发人员在未选中的情况下运行调试版本。我们当然会严格控制调试版本。如有必要，您可以在调试版本中进行额外检查以提高安全性。或向开发人员颁发许可证。

对于我们的调试版本，我们在包含在“#IF DEBUG”中的调试代码中添加了一个许可证，以确保它不会被编译到发布版本中。

我并不是说这是最好的方法，但这是我们使用的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T00:34:01.047

我想你正在寻找一个简单的故障保护，而不是一个气密的访问控制......

将机器名称放在配置文件中，并在应用程序启动时将其与机器名称进行比较。这样您就不会在其他任何地方错误地运行它，并且在开发时或移动应用程序时很容易更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T00:42:29.717

一个想法：可以使用需要存在才能运行的注册表项。

另一种：可能需要在密钥库中安装 X509 证书才能运行

另一种：使用 System.Security.Permissions 并将操作限制为一组用户或一组。

等等

# perl - 如何在 Perl 中记住匹配及其在数组中的位置？

> ID：871324
> 
> 赞同：1
> 
> 时间：2009-05-16T00:14:40.017
> 
> 标签：perl, position, match

请帮忙

我正在处理一个文件，其数据行如下所示。可以看出，数据被 ' `|||`' 分成了 4 个，所以我会有四个数组（如果我把它分开的话）。我想要的是这个：

1.  我想检查第一个数组中是否有标点符号，如果有，请记住数组中的位置。
2.  转到第三个数组中的相同位置，并读取括号中的数字。
3.  检查数字的数组索引处的值是否是标点符号。

我的问题是我不记得比赛及其位置！你能帮忙吗？

```
Ãºtil por la uniÃ³n europea , 一个 ||| 由欧盟，||| () (0) (1) (3) (2) (4) () ||| (1) (2) (4) (3) (5)

```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T00:36:42.883

除了[`pos()`](http://perldoc.perl.org/functions/pos.html)，还有[`@-`](http://perldoc.perl.org/perlvar.html#%40-)和[`@+`](http://perldoc.perl.org/perlvar.html#%40+)：

```
#!/usr/bin/perl

use strict;
use warnings;

my $string = "foo bar baz";

if ($string =~ /(foo) (bar) (baz)/) {
    print "the whole match is between $-[0] and $+[0]\n",
        "the first match is between $-[1] and $+[1]\n",
        "the second match is between $-[2] and $+[2]\n",
        "the third match is between $-[3] and $+[3]\n";
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T00:26:12.487

该[`pos()`](http://perldoc.perl.org/functions/pos.html)函数可用于报告匹配的（结束）位置。例子：

```
my $string = 'abcdefghijk';

if($string =~ /e/g)
{
  print "There is an 'e' ending at position ", pos($string), ".\n";
} 
```

此代码将打印，“在位置 5 处有一个 'e' 结尾。” （位置从 0 开始。）将此与捕获括号的正常使用结合起来，您应该能够解决您的问题。

除了 之外[`pos()`](http://perldoc.perl.org/functions/pos.html)，还有特殊的全局数组[`@-`](http://perldoc.perl.org/perlvar.html#%40-)，[`@+`](http://perldoc.perl.org/perlvar.html#%40+)它们提供每个匹配的子模式的开始和结束偏移量。例子：

```
my $string = 'foo bar baz';

if($string =~ /(foo) (bar) (baz)/)
{
  print "The whole match is between $-[0] and $+[0].\n",
        "The first match is between $-[1] and $+[1].\n",
        "The second match is between $-[2] and $+[2].\n",
        "The third match is between $-[3] and $+[3].\n";
} 
```

（*感谢 Chas. Owens 让我记忆犹新；我在寻找[`perlre`](http://perldoc.perl.org/perlre.html)它们而不是在[`perlvar`](http://perldoc.perl.org/perlvar.html)*寻找它们）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T00:41:33.683

当你在代码中做一些不简单的事情时，最好把它分解成离散的步骤和变量，以便于理解。

所以我首先将数据字符串分成四个部分：

```
#The data record
my $dataRec = "Ãºtil por la uniÃ³n europea , a ||| by the european union , ||| () (0) (1) (3) (2) (4) () ||| (1) (2) (4) (3) (5)";

#split it into four parts
my ($Native, $English, $data1, $data2) = split(/\|\|\|/,$dataRec);

#Store the position of the punctuation mark
my $puncPos = index($Native, ",");

#If we found the punctuation mark, parse the data
my @dataList;
my $dataValue;
if ( $puncPos != -1 )
   {
   @dataList = split(/[)( ]/,$data1);

   # use the punctuation position as the index into the array of values parsed
   $dataValue = $dataList[$puncPos];
   } 
```

类似的东西...

# apache-flex - Flex：如何从 htmlText 锚点调用动作脚本函数

> ID：871325
> 
> 赞同：3
> 
> 时间：2009-05-16T00:15:07.303
> 
> 标签：apache-flex, actionscript-3, textarea, htmltext

有什么方法可以从 TextArea 组件的 htmlText 属性中定义的锚点调用动作脚本函数。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T14:35:21.010

如果此锚点是来自标签的 href，您可以分派事件并像这样处理它们：

```
<mx:Script>
    <![CDATA[
        private function linkHandler(e:TextEvent):void
        {
            if (e.text == "test")
                trace("test called")
        }
    ]]>
</mx:Script>
<mx:creationComplete>
    <![CDATA[
        textArea.htmlText="<a href='event:test'>Link!</a>";
    ]]>
</mx:creationComplete>

<mx:TextArea id="textArea" link="linkHandler(event)" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T01:31:05.653

我在[这里](http://blog.circlecube.com/2008/12/portfolio/asfunction-texteventlink-tutorial-for-as3-flash-html-link-to-call-actionscript-function-tutorial/)得到了答案..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T00:33:46.260

ExternalInterface 类将为您提供 Javascript 和 Actionscript 之间的通信渠道。使用这个类，您可以侦听来自页面 Javascript 的调用，以及发送消息和返回数据。

下面的链接引用 AS 3.0。希望有帮助！

[外部接口文档](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)

[使用说明](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000340.html)

[示例代码](http://flexion.wordpress.com/2007/08/21/external-interface-tip/)

# c++ - Visual Studio：如何在修改成员变量时停止调试器？

> ID：871328
> 
> 赞同：8
> 
> 时间：2009-05-16T00:17:44.660
> 
> 标签：c++, windows, visual-studio

我的程序有一个永远不会改变的变量。然而，不知何故，它正在改变。当特定的成员变量被修改时，有没有办法让调试器停止？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-16T00:28:40.343

设置数据断点以在某些变量更改时停止执行。

中断变量的初始化，或者变量可见的地方——你需要能够在内存中获取它的地址。然后，从菜单中选择 Debug -> New Breakpoint -> New Data Breakpoint。输入“ `&var`”（`var`替换为您的变量名称。）

这将在修改变量的确切代码行上进入调试器。

更多文档在这里：

[http://msdn.microsoft.com/en-us/library/350dyxd0.aspx](http://msdn.microsoft.com/en-us/library/350dyxd0.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T00:22:09.547

您可以在使用变量的地方设置条件断点。

在 Visual Studio 中，当光标位于要设置断点的行时按 F9 设置断点。
接下来，右键单击断点并选择条件。
输入您的条件，例如

```
n != 5 
```

祝你好运。

这是[来自 MSDN 的链接](http://msdn.microsoft.com/en-us/library/aa290718(VS.71).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T01:23:32.177

如果通过赋值或其他直接更新对其进行修改，则数据断点将起作用。但是，如果它正在通过其他方式进行修改——例如缓冲区覆盖——我不确定它是否会准确地告诉你它何时发生。只是要记住的事情。

# java - 如何从 ServletFilter 中的 HttpServletReqest 获取带有参数的 POST URL？（对于代理应用程序）

> ID：871330
> 
> 赞同：0
> 
> 时间：2009-05-16T00:18:56.607
> 
> 标签：java, post, proxy, servlet-filters, openlayers

由于浏览器限制，我需要使用代理来使 openlayers 地图工作。

OpenLayers.ProxyHost javascript 对象处理 URL 的生成，例如：

[http://webhost:8080/app/proxy/?url=http://WFS_server/options/](http://webhost:8080/app/proxy/?url=http://WFS_server/options/) ...

一些请求将是 GET，而其他请求将是 POST。

我编写了一个 Servlet 过滤器，它将接收请求，然后使用公共 HttpClient 将其分派到“url”参数指定的主机。

一切都适用于 GET，但我在获取 POST 的“url”参数值时遇到了困难。

根据我在 Eclipse 中看到的 javadoc，它应该是 request.getRequestURI() 但这只是返回帖子的值减去 url 参数值（即[http://webhost:8080/app/proxy/](http://webhost:8080/app/proxy/)）

事实上，我可以获得数据的唯一方法是调用 request.toString() 方法并解析出 url。

我正在部署到 Jetty 6.1.11 服务器，所以我想知道这是否可能是一个 Jetty 错误，或者我是否遗漏了从哪里获取此详细信息的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T00:30:56.500

如果 url 参数在 POST 正文中发送，您可以使用：

```
request.getParameter( "url" ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T00:26:34.687

这是因为 getRequestURI 提供的正是您所要求的——URI。

在您的帖子中， url 参数不是 URI 的一部分。尔格、QED 等

因此，简单地说，您需要编写一个例程来构建您自己的 URL。该请求不会在这里为您提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T00:40:20.953

对于 POST，您需要使用类似于下面的内容来获取各个参数。

```
Map params = request.getParamterMap();
String value = (String) params.get("url"); 
```

# php - 什么是加快 PHP/Javascript 速度的最佳方式？

> ID：871331
> 
> 赞同：2
> 
> 时间：2009-05-16T00:19:54.920
> 
> 标签：php, javascript

我已经使用 Python/Django 构建了网站，并使用 Objective-C/Cocoa 构建了桌面应用程序，因此我不需要学习编程。对于我这种情况的人，学习 PHP 和 Javascript 的最佳方式（特定书籍或网站）是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T00:26:00.270

对于 PHP，我推荐[官方教程](http://ie.php.net/tut.php)，然后[是手册](http://ie.php.net/manual/en/index.php)。PHP 有很好的文档记录，文档页面上的用户评论也非常有用。

对于 JavaScript，我推荐[JavaScript: The Definitive Guide](http://oreilly.com/catalog/9780596101992/)。这本书从头开始教授语言，然后介绍了特定于浏览器的问题，例如 DOM API。

![JavaScript：权威指南](https://covers.oreilly.com/images/9780596000486/cat.gif)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T00:29:42.040

Ayman 推荐了一本好书和两个很好的资源。除此之外，PHP 有一些你会通过经验掌握的陷阱。

一旦熟悉了 PHP 和 Javascript，我建议您查看一些 javascript 库，例如[JQuery](http://jquery.com/)或[YUI](http://developer.yahoo.com/yui)，并查看您喜欢的库的源代码，然后看看[Zend Framework](http://framework.zend.com/)或[Symfony](http://www.symfony-project.org/) for PHP 之类的东西。

# passwords - 什么是密码应用程序的好拼音字母？

> ID：871332
> 
> 赞同：1
> 
> 时间：2009-05-16T00:20:14.263
> 
> 标签：passwords, alphabet, phonetics

我正在编写一个为用户创建“困难”密码的应用程序。用户只会看到一次密码，他们会将其复制到客户端中，该客户端将永远记住它。

在成熟的 PC 上运行良好，我可以在浏览器中显示整个密码时选择整个密码，然后将其粘贴到将使用它的客户端中。

当我在我的 PC 上生成密码时效果不太好，然后需要手动将其转换到我的移动设备上。因此，对于这种情况，我想以某种清晰明确的方式显示密码，以帮助用户在复制过程中牢记密码。

例如： At6Pq = **A** lpha **t** ango 6 **P** apa **q** uebec

我可以将字母组件翻译成什么好的拼音字母？理想情况下，我想要一些对说英语的人（少数用户）和英语作为第二语言的用户都有意义的东西？

生成的密码格式为 [a-zA-Z0-9]{20}

我目前正在考虑使用[NATO 字母表](http://en.wikipedia.org/wiki/NATO_phonetic_alphabet)，但由于某种原因，“papa”和“india”等一些条目对我来说并不合适。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T00:27:52.000

我会采用国际标准，这就是您所指的“北约字母表”。我不认为它仅限于“北约”；例如，它被航空公司使用。这些名称经过仔细选择，以便在嘈杂的电路中区分开来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T00:28:25.477

您是否看到[此 Wikipedia 页面](http://en.wikipedia.org/wiki/Spelling_alphabet#Examples)，该页面概述了各个组织/国家使用的常见拼写字母表？*British Forces* / *NY Police*看起来很简单（都是非常常见的词，因此大多数非母语人士可能也很熟悉） - 所以你可能想要其中一个。一般来说，我不会太担心它们的发音——任何常见的拼写字母都可以。如果您想创建自己的一个（或现有的混合体），这可能不是什么大问题，尽管我看不出有什么特别的理由不选择该页面上列出的一个。

希望有帮助。

# mysql - UTF-8 仅在 Grails 1.1 数据库表中

> ID：871335
> 
> 赞同：2
> 
> 时间：2009-05-16T00:21:49.440
> 
> 标签：mysql, unicode, grails, utf-8

将 Grails 1.1 与 MySQL 一起使用时，自动生成的数据库表的字符集似乎默认为 ISO-8859-1。我宁愿将所有内容都存储为纯 UTF-8。那可能吗？

从自动生成的数据库定义中：

```
ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1; 
```

注意“latin1”部分。

[此处](https://stackoverflow.com/questions/481541/utf-8-only-in-grails-database-tables)描述了适用于 Grails 1.0 的解决方法。在使用 Grails 1.1 时，这种变通方法似乎不起作用。dataSource.dialect 参数似乎被忽略了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T00:37:07.733

似乎使用了数据库的默认字符集。

我通过使用 utf8 作为默认字符集创建数据库来解决这个问题：

```
CREATE DATABASE name_of_database DEFAULT CHARACTER SET utf8; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-12T21:38:47.403

嗨，我遇到了类似的问题，从 MySQL 读取很好，但写入将一些字符转换为“？” （问号）。这解决了它： url = "jdbc:mysql://localhost:3306/your-db-name?useUnicode=true&characterEncoding=utf-8

MH23

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-17T14:18:55.173

这是 StackOverflow 上相同问题的解决方案： [UTF-8 only in Grails database tables](https://stackoverflow.com/questions/481541/utf-8-only-in-grails-database-tables)

它对我有用，但它并不优雅......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-17T11:28:30.783

您还可以在 DataSource.groovy 文件中向 Hibernate / JDBC url 添加一些属性。例如

> url = "jdbc:mysql://localhost:3306/your-db-name?useUnicode=true"

MySQL 还有其他与字符集相关的参数。我不太确定您需要哪些以及多少个才能获得预期的行为。

# c++ - 有没有办法结合 Qt-Creator + Boost 库？

> ID：871336
> 
> 赞同：4
> 
> 时间：2009-05-16T00:22:02.793
> 
> 标签：c++, qt, boost, qt-creator

我想知道是否有办法在 Qt-creator（Qt 的 IDE 版本）中使用 boost 库。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T00:30:50.323

我很确定 Qt Creator 不需要在您的应用程序中使用 Qt。如果您不想链接到任何 Qt 库，或在任何头文件上运行 MOC（您只需要为 QObject 的子类执行此操作），那么只需执行[`QT -= core gui`](https://doc.qt.io/archives/qt-4.8/qmake-project-files.html#declaring-qt-libraries)（从链接命令中删除 Qt 库。也许`QT =`会也可以工作），并且不要指定任何[`HEADERS`](https://doc.qt.io/archives/qt-4.8/qmake-project-files.html#variables).

祝你好运，如果有效，请回帖。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T00:32:09.850

Boost 不仅仅是一个库，它是它们的集合。有些只是头文件，在这些情况下，您只需像往常一样将它们#include 到您的源代码中。您需要哪种 Boost 功能？

# iphone - perfomSelector: withObject: afterDelay: 我可以要求低优先级吗？

> ID：871340
> 
> 赞同：1
> 
> 时间：2009-05-16T00:24:51.430
> 
> 标签：iphone, cocoa-touch, nsobject

发送此消息时是否有某种方法可以指定我宁愿在所有待处理的 UI 事件（如果有）之后执行我的选择器？IE。在事件队列中给我的 aterDelay 计时器一个较低的优先级。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T04:24:45.533

实际上，`performSelector:withObject:afterDelay:`不一定要发生在主线程上；这就是为什么有一个单独的方法`performSelectorOnMainThread:withObject:waitUntilDone:`。文档`performSelector:withObject:afterDelay:`说

> 在延迟后使用默认模式在**当前**线程上调用接收者的方法。

如果您想在后台执行任务，您可以查看`+[NSThread detachNewThreadSelector:toTarget:withObject:]`，它将启动一个新线程来执行您的任务，并使 UI 保持响应。使用单独的线程来执行可能会锁定 UI 的长时间运行的任务通常是一个好主意，但它确实增加了复杂性。如果您不熟悉线程，您最终可能会遇到毫无意义的错误。

在上面的评论中，您提到您认为动画可能导致您的 UI 无响应。如果您使用内置动画支持（Core Animation 或 Cocoa 包装器之一），动画不应使您的 UI 无响应。无响应的 UI 通常意味着您的程序在让运行循环返回服务 UI 事件之前在主线程上做了很多工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T02:46:05.613

不是直接的。如果您使用`performSelector:withObject:afterDelay:`选择器在**主线程**上执行，那么根据定义，它将在所有当前“待处理”的 UI 事件都已执行之后发生——但这可能是在滚动或动画的中间，您可能会认为这是一个连续的事件，但实际上是数百个独立的事件。

但是，您可以使用`performSelectorInBackground:withObject:`, 然后调用`[NSThread setThreadPriority:0.01]`被调用的方法来实现类似的功能。小心——你正在打开一个后台线程，所以你不能做任何 UI 调用。但是，这将允许您在优先级低于主 UI 线程的后台线程上执行工作。（记得设置一个自动释放池，因为它在自己的线程中！）

# java - 3D相机缩放并在java中跟随物理？

> ID：871345
> 
> 赞同：0
> 
> 时间：2009-05-16T00:26:02.580
> 
> 标签：java, math, camera, physics

我正在努力做到这一点，以便无论两个对象相距多远，它们都将保留在屏幕上。我正在使用 JOGL，但这并不重要，因为我只需要数学方面的帮助。这是我到目前为止所拥有的：

```
float distance = (float) ((Math.sqrt((p1.x - p2.x) + (p1.y - p2.y))));
float camx = (float)((p1.x + p2.x) * 0.5);
float camy = (float)((p1.y + p2.y) * 0.5);
float camz = (float) (distance * 5); 
```

我需要什么数学才能正确放大和缩小 Z？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T03:08:48.460

如果两个对象的 z=0，并且您的屏幕视角（从屏幕*中心*到边缘）是水平角和垂直角的 ax 和 ay，则：

```
zx = abs((p1.x-p2.x)*0.5)/tan(ax)
zy = abs((p1.y-p2.y)*0.5)/tan(ay) 
```

和

```
camz = max(zx, zy) 
```

这里 zx 和 zy 是使对象在屏幕的水平和垂直维度上的距离，而 camz 是同时满足这两个标准的距离。还要注意 ax 和 ay 的单位是弧度（例如，如果你假设你的屏幕是 40 度宽，那么 ax 就是 20 度，或者 ax =20*(pi/180)=0.3419 弧度）。

您对 camx 和 camy 的值是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T00:31:32.457

也许我误解了你的情况，但你不能这样做

```
float camx = (p1.x + p2.x) * 0.5;
float camy = (p1.y + p2.y) * 0.5;
float camz = (p1.z + p2.z) * 0.5; 
```

这会将相机直接定位在两个物体之间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T01:58:52.373

如果需要更正，

> 浮动距离 = (float) ((Math.sqrt((p1.x - p2.x)^2 + (p1.y - p2.y)^2)));

我不太确定语法。我只是告诉您在添加向量之前需要获得 2 的幂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-17T18:53:56.540

```
float distance = (float) ((Math.sqrt(Math.pow((p1.x - p2.x),2.0) + Math.pow((p1.y - p2.y), 2.0))));
float camx = (float)((p1.x + p2.x) * 0.5);
float camy = (float)((p1.y + p2.y) * 0.5);
float camz = (float) Math.abs(distance); 
```

# design-patterns - 向用户返回数据（良好的 API 设计）

> ID：871351
> 
> 赞同：0
> 
> 时间：2009-05-16T00:28:13.620
> 
> 标签：design-patterns, api, named-pipes

所以现在我已经开发了一个我正在尝试为其编写 API 的应用程序。理想情况下，应用程序会将字符串返回给用户。API 无法以正常的编程方式“返回”数据，因为可能从应用程序发送的字符串数量未知。在 Unix 系统上，通过命名管道将此数据传递给用户是一个坏主意吗？我很难找到有关创建 API 的详细信息的任何信息。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T00:33:23.733

> API 无法以正常的编程方式“返回”数据，因为可能从应用程序发送的字符串数量未知。在 Unix 系统上，通过命名管道将此数据传递给用户是一个坏主意吗？

在 Unix 上，程序通常通过将数据写入“标准输出”来输出其数据，尽可能多的数据，也许是大量数据。用户可以将此输出通过管道传送到屏幕或文件，或将其作为输入传送到另一个程序（例如，可能过滤数据）。

> 我很难找到有关创建 API 的详细信息的任何信息。

[http://www.faqs.org/docs/artu/](http://www.faqs.org/docs/artu/)非常有名，fwiw： http: [//www.faqs.org/docs/artu/ch07s02.html#plumbing](http://www.faqs.org/docs/artu/ch07s02.html#plumbing)说了一些关于使用管道的事情（有一些例子），将数据从一个程序输出到另一个程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T03:06:10.697

取决于应用程序。如果它是一个短命的命令行工具，那么 read-from-stdin/write-to-stdout 模型效果很好。grep/sed/awk/perl 将负责数据后处理。如果它是一个守护进程，那么 fifo 或套接字可能是一个好主意，尽管您必须考虑该流上的某种客户端-服务器协议。更进一步，提供一个知道该协议的库，并为应用程序编写者提供一些一致的函数集来与您的应用程序对话，这将是一个真正的 API。这是经典的客户端-服务器，例如，大多数数据库都是这样工作的。

# c++ - 添加！运算符和 sqrt()、pow() 等到计算器示例应用程序

> ID：871354
> 
> 赞同：29
> 
> 时间：2009-05-16T00:28:55.553
> 
> 标签：c++

我正在 Stroustrup 的新书[《Programming Principles and Practice Using C++》](http://www.stroustrup.com/Programming/)中做练习，想知道 Stack Overflow 上是否有人做过这些练习并愿意分享知识？

特别是关于第6章和第7章开发的计算器。例如关于添加`!`运算符和sqrt（），pow（）等的问题。我已经做了这些，但我不知道我的解决方案是否是“好”的做事方式，并且 Bjarne 的网站上没有发布的解决方案。我想知道我是否走在正确的轨道上。也许我们可以为练习制作一个维基？

基本上我有一个令牌解析器。它一次从 cin 读取一个字符。它旨在标记 5*3+1 之类的表达式，并且非常适合。练习之一是添加一个 sqrt() 函数。所以我修改了标记化代码以检测“sqrt(”，然后返回一个表示 sqrt 的 Token 对象。在这种情况下，我使用 char 's'。其他人会这样做吗？如果我需要实现 sin() 怎么办？案例陈述会变得混乱。

```
char ch;
cin >> ch;    // Note that >> skips whitespace (space, newline, tab, etc.)

switch (ch) {
    case ';':    // For "print"
    case 'q':    // For "quit"
    case '(':
    case ')':
    case '+':
    case '-':
    case '*':
    case '/':
    case '!':
        return Token(ch);        // Let each character represent itself
    case '.':
    case '0': case '1': case '2': case '3': case '4':
    case '5': case '6': case '7': case '8': case '9':
        {
            cin.putback(ch);         // Put digit back into the input stream
            double val;
            cin >> val;              // Read a floating-point number
            return Token('8', val);   // Let '8' represent "a number"
        }
    case 's':
        {
            char q, r, t, br;
            cin >> q >> r >> t >> br;
            if (q == 'q' && r == 'r' && t == 't' && br == '(') {
                cin.putback('(');    // Put back the bracket
                return Token('s');   // Let 's' represent sqrt
            }
        }

    default:
        error("Bad token");
} 
```

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2009-05-20T13:45:52.523

1.  There are a few solutions posted on [Stroustrup - Programming](http://www.stroustrup.com/Programming/) and more will be coming over time.

2.  Try solving exercises only with the language features and the library facilities presented so far in the book -- real novice users can't do anything else. Then return later to see how a solution can be improved.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-19T00:41:14.483

我认为字符串到函数指针的映射可能是一种简洁的方式来表示像 sqrt、sin、cos 等采用单个双精度并返回双精度的事物：

```
map<std::string, double (*)(double)> funcs;
funcs["sqrt"] = &sqrt;
funcs["sin"] = &sin;
funcs["cos"] = &cos; 
```

然后，当解析器检测到正确的字符串 (str) 时，它可以使用参数 () 调用函数，`arg`如下所示：

```
double result = funcs[str](arg); 
```

使用此方法，单个调用可以处理（该类型的）函数的所有情况。

实际上我不确定这是否是正确的语法，有人可以确认吗？

这看起来像一个可用的方法吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-19T14:35:57.077

使用派生类和虚函数更容易：每个专门的类都读取自己的输入......

```
class base {
    public:
        virtual double calc() = 0;
};

class get_sqrt : public base {
    int useless;

    public:
        virtual double calc() {
            cin >> number;
            return sqrt(number);
        }
}

get_sqrt; 
```

现在我们将它们组织在一个地图中，我们将只使用它们的指针：

```
map<string,base*> func;
func["sqrt"] = &get_sqrt; 
```

还有一个专门的方法只查看下一个字符：peek();

```
char c = cin.peek(); 
```

`!`如果将, `+`,`-`等放入`func`;则可以使用 1 摆脱开关。（为简单起见，它们应该在 left_param 上操作）：

```
 if (c>='0' && c<='9')
     cin >> right_param; // Get a number, you don't have to put the
                         // character back as it hasn't been removed
 else {
     string s;
     cin >> s;
     right_param = func[s]->calc();
 } 
```

所以基本上是某种函数指针，但没有杂乱的语法，你可以在其中存储计算之间的数据。

我想到了空格问题；它可以在开始计算之前添加，我也认为可以设置不同的分隔符，比如数字，但我不知道如何。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T23:42:48.987

我会将“sqrt”检测转移到另一种功能检测方法中。本质上，我会删除“s”检测并在默认情况下添加一些内容，将字符串读取到“（”。

如果没有检测到'('，则错误。

如果您成功读取了字符串，请将其传递给函数名称解析器，该解析器使用字符串比较来生成表示对 sqrt 或 sin 或任何您喜欢的函数的调用的标记。如果它读取一个它无法识别的字符串，检查函数名称的方法也会出错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-06T09:49:44.277

我现在已经完成了这个任务，所以我是这样做的。（下面的大部分代码最初是由 Stroustrup 编写的，只有我对有效 sqrt() 计算的看法）

首先，需要分配一个符号常量，这将表明有一个 sqrt() 调用。 `const char root = 's';`

现在让我们对您的代码进行一些更改：

```
switch (ch) {
// here were your case: blocks of code
default:
        if (isalpha(ch)) { 
            string s;
            s += ch;
            while (cin.get(ch) && (isalpha(ch) || isdigit(ch) || ch == '_')) s += ch;
            cin.putback(ch);

            if (s == "sqrt") return Token(root); // sqrt() define
            return Token(var_name, s); 
        }
        error("Bad token");
    }
} 
```

一般来说，这个代码块负责定义变量，但是我们`sqrt`通过输入一系列字符`s`, `q`, `r`,来创建“关键字” `t`。如果有那个关键字，我们返回一个代表 a 的标记`sqrt`。

现在，我们只需要在语法和`primary()`功能上做一些改变。

```
double primary() 
{
    Token t = ts.get();
    switch (t.kind) {
    case root:
    case '(':
    {   
    double d = expression();
    if (t.kind == root) {
        if (d < 0) error("sqrt(): non-positive argument");
        return sqrt(d); // calculate square root otherwise
    }
    t = ts.get();
    if (t.kind != ')') error("')' expected"); 
    return d;
    }
    // further case blocks
} 
```

可以看到，如果`root`遇到keychar，我们需要定义一个`d`变量作为函数`expression()`值。计算时`expression()`会遇到`(`字符，可以输入任意序列作为用户`sqrt()`函数的参数，得到合理的答案。

一些例子：

```
> let a = 5;
= 5
> sqrt(100);
= 10
> sqrt(a+20-a/2);
= 4.74342
> 1+2/3+sqrt(9);
= 4.66667
> sqrt(a/0);
divide by zero
> sqrt(-1);
sqrt(): non-positive argument 
```

# c# - 轻量级灵活的数据持久性选项

> ID：871361
> 
> 赞同：1
> 
> 时间：2009-05-16T00:32:03.377
> 
> 标签：c#, persistence

本来我是用SQLCE，先从LINQ to SQL开始，然后转到Entity Framework，但是好像SQLCE太不灵活了。（现在我什至不能删除一个表来重新创建它，因为它说我不能删除 PrimaryKeyA，因为 PrimaryKeyA 正在引用它......所以我对以后能够修改它没有多大信心）

我需要灵活性，因为应用程序将在多次迭代中发布，并且数据需要能够相当容易地更改。较新版本的应用程序需要能够直接或通过转换从旧版本读取数据。

它需要轻量级的部署，小于 10MB，但最好小于 5。用户将（不应该）在应用程序之外修改数据，他们不需要知道或关心数据是如何存储的。

高性能不是问题，它只是单个用户的数据。现在我很想说只使用 XML 来利用 LINQ to XML。但我想知道是否还有其他建议。我想要一些可以很容易地与普通对象相互转换的东西，XML 序列化可以为此工作吗？

我想我正在寻找的是一种简单的方法来持久化对象，这些对象可以通过对象更改轻松更新到新版本。性能不是一个大问题，但至少对于中小数据量来说应该是可以容忍的。（基本上是单个用户食谱的电子形式的食谱）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T00:48:01.717

文件总是有二进制序列化。它并不性感，但它可以工作，并且不需要任何第三方工具或软件。只需确保在**每个**数据分组之前都有一个版本号（通常称为模式号）。当您更改数据模型时，这将减轻您的头痛。

在 OOP 设置中，通常需要持久化的每个对象都有一个 Serialize() 方法，该方法接受一个方向参数（保存与加载）和一个表示二进制文件的对象。写出时，您只需要确保每个对象都被序列化。阅读时，您需要随时创建对象。知道如何将对象序列化进出的容器通常会使这个过程变得更容易。

转换由各种 Serialize() 方法动态处理。例如，如果当前使用 Schema 版本 5 的对象遇到使用 Schema 版本 4 写入的数据，它将知道如何处理。

但是，如果您需要类似 SQL 的查询功能，这可能不是您的最佳选择。当您要读入所有数据时，这最有效。

**例子：**

假设您有一个 Foo 类，它有 2 个要序列化的成员变量：

```
class Foo
{
public:
  const unsigned int SCHEMA = 1;
  int i;
  double d;

  void Serialize(bool bSaving, CBinaryFile file)
  {
    if (bSaving)
    {
      // Serialize everything out
      file << SCHEMA << i << d;
    }
    else
    {
      // Read in the schema number first
      unsigned int nSchema;
      file >> nSchema;

      // Validate the schema number
      if (nSchema > SCHEMA)
      {
        // We're reading in data that was written with a newer version of the program
        // Since we don't know how to handle that let's error out
        throw exception;
      }

      // Read everything in
      file >> i >> d;
    }
  }
} 
```

现在假设一年后您向 Foo 添加了另一个成员。你会这样处理它：

```
class Foo
{
public:
  const unsigned int SCHEMA = 2;
  int i;
  double d;
  string s;

  void Serialize(bool bSaving, CBinaryFile file)
  {
    if (bSaving)
    {
      // Serialize everything out
      file << SCHEMA << i << d << s;
    }
    else
    {
      // Read in the schema number first
      unsigned int nSchema;
      file >> nSchema;

      // Validate the schema number
      if (nSchema > SCHEMA)
      {
        // We're reading in data that was written with a newer version of the program
        // Since we don't know how to handle that let's error out
        throw exception;
      }

      // Read everything in
      file >> i >> d;
      if (nSchema > 1)
        file >> s;
    }
  }
} 
```

只要您将所有内容都包装在 Schema numbers 中，转换就很简单了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T06:00:34.913

我建议使用[System.Data.SQLite](http://sqlite.phxsoftware.com/)。它通过 ADO.net 接口为您提供简单、高性能的 SQL，而且它是轻量级的。使用命令行 sqlite.exe 客户端和其他工具，它也有很好的文档记录并且很容易排除故障。SQLite 的一个重要优点是它的类型相对松散，因此您不必花费太多时间来处理模式。

我不能说它是否支持 LINQ，但它非常好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T06:16:32.317

我建议您正在考虑的 XML 路线可能是一个合理的想法。虽然比二进制序列化更冗长，但如果需要，它更容易调试；如果需要较少的磁盘使用量，则可以很好地（即时）压缩。

# javascript - 为什么 document.write 不再为我工作？

> ID：871368
> 
> 赞同：0
> 
> 时间：2009-05-16T00:34:12.733
> 
> 标签：javascript, dotnetnuke-module, dotnetnuke-5

我在 DotNetNuke 工作，但这似乎并不是严格意义上的 DNN 问题。

我在我的名为 FormatEmail 的模块中使用了 DNN 提供的方法，它使用 document.write 来写出一封电子邮件，如下所示：

```
<script language="text/javascript">

<!--
  document.write(String.fromCharCode(60,97,32,104,114,101,102,61,34,109,97,105,108,116,111,58,119,101,98,109,105,110,64,97,116,101,110,118,101,108,100,116,46,111,114,103,34,62,119,101,98,109,105,110,64,97,116,101,110,118,101,108,100,116,46,111,114,103,60,47,97,62))
// -->

</script> 
```

我刚刚安装了 DNN 5，我知道它包括 jQuery 以及代码库的其他附加功能。jQuery 会阻止 document.write 代码工作吗？

DNN 是否应该使用另一种方法来隐藏机器人的文本？

我应该停止使用这种方法来隐藏我的电子邮件地址吗？

更新：该页面未使用 xhtml。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T00:47:40.250

我不知道这是否发生了，但是如果您的站点告诉浏览器它是严格的 XHTML，那么它将无法工作`document.write`。`document.writeln`我相信要发生这种情况，您必须使用严格的 DOCTYPE 并将`Content-Type`标头设置为`application/xml+xhtml`而不是`text/html`（许多服务器下的默认值）。这是因为以这种方式操作 DOM 可能会破坏它。例如，如果我将以下内容放在经过验证的网页的中途：

```
<script type="text/javascript">
<!--
    document.write("</body>");
// -->
</script> 
```

该文档将验证并符合 XHTML，但不能在大多数浏览器中工作。

另一种方法是创建一个 DOM 节点，应该在其中插入电子邮件地址，并在页面加载时插入它。例如：

```
<p>My email address is <span id="email"></span>.</p>
<script type="text/javascript">
<!--
    document.body.onload = function() {
        document.getElementById("email").textContent = String.fromCharCode(60,97,32,104,114,101,102,61,34,109,97,105,108,116,111,58,119,101,98,109,105,110,64,97,116,101,110,118,101,108,100,116,46,111,114,103,34,62,119,101,98,109,105,110,64,97,116,101,110,118,101,108,100,116,46,111,114,103,60,47,97,62);
    };
// -->
</script> 
```

或者，当您设置了 jQuery 时：

```
<p>My email address is <span id="email"></span>.</p>
<script type="text/javascript">
<!--
    $( function() {
        $("#email").text(String.fromCharCode(60,97,32,104,114,101,102,61,34,109,97,105,108,116,111,58,119,101,98,109,105,110,64,97,116,101,110,118,101,108,100,116,46,111,114,103,34,62,119,101,98,109,105,110,64,97,116,101,110,118,101,108,100,116,46,111,114,103,60,47,97,62));
    } );
// -->
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T01:29:26.517

我想我在 DNN 错误跟踪器中找到了具体答案：

输出应该是：

```
<script type="text/javascript">

//<![CDATA[
 document.write(String.fromCharCode(60,97,32,104,114,101,102,61,34,109,97,105,108,116,111,58,84,101,115,116,64,106,101,102,102,109,97,114,116,105,110,46,99,111,109,34,62,84,101,115,116,64,106,101,102,102,109,97,114,116,105,110,46,99,111,109,60,47,97,62))
//]]>

</script> 
```

这似乎解决了我的网站（没有运行 XHTML）的问题。

该错误位于[此处](http://support.dotnetnuke.com/issue/ViewIssue.aspx?id=9467&PROJID=2)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T01:46:55.303

杰夫，

您确实找到了正确的解决方案，但老实说，我不确定这样做的好处。是的，电子邮件可能会被删除，但至少在我看来，这个过程实在是太过分了。无需运行 javascript，只需呈现电子邮件链接。

对于您手头的非常具体的问题，这只是我的 0.02 美元。

# textbox - 当用户使用c#在网站中的文本框上设置焦点时如何触发设置命令

> ID：871383
> 
> 赞同：0
> 
> 时间：2009-05-16T00:44:40.227
> 
> 标签：textbox, focus

我在网页中有一个用户名文本框和一个密码文本框。

我希望用户名文本框在失去焦点/当用户单击密码文本框时读取以下代码？使密码自动显示在密码文本框中。

```
 String cookiename = usernameTextBox.Text;

    //grab cookie
    HttpCookie cookie = Request.Cookies[cookiename];

    //exists?
    if (null == cookie)
    {
        Label1.Text = "cookie not found";
    }
    else
    {
        passwordTextBox.Attributes.Add("value", cookie.Value.ToString());
    } 
```

焦点是我发现的唯一可用的东西，我知道它很相似，但我似乎无法弄清楚。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T00:49:05.800

这里有两个问题：

一，**您为什么将用户密码以纯文本形式存储在 cookie 中？那是极不安全的！**这根本不安全，**您还不如没有密码**。有很多方法可以处理这个问题。这是一个简单的例子：

如果您希望站点“记住”用户的密码，请生成唯一令牌（例如 GUID）并将 GUID 与他们的帐户信息一起存储在服务器上作为“活动会话”，并将 GUID 存储在 cookie 中。当用户访问该站点时，检查令牌 cookie 是否存在，如果存在，您可以将其与服务器端的用户登录信息相匹配，并完全绕过登录页面。还有其他需要考虑的事情，但这是基本概念。

第二，您当前的设计需要类似 AJAX 的回调。您用 c# 编写的代码在服务器上运行，但焦点/模糊事件发生在客户端。

从纯粹的技术角度来看，您应该编写 JavaScript 来处理整个过程。JS 函数可以运行`onblur()`，JS 可以像 .NET 一样读取 cookie：

```
var usernameBox = document.getElementById('usernameBox');
usernameBox.onblur = handleBlur;

function handleBlur() {
    var passwordBox = document.getElementById('passwordBox');
    passwordBox.value = readCookie(cookieName);
}

function readCookie(cookieName) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return "";
} 
```

（请注意，`getElementById`使用**客户端 ID**，而不是 ASP.NET ID）

您的安全问题是一个更大的问题。没有办法解决你想要完成的事情；从根本上说，这只是一个坏主意。

# ssl - 如果 SSL/TLS 证书没有真正的签名/CA，为什么还要自签名？

> ID：871388
> 
> 赞同：11
> 
> 时间：2009-05-16T00:48:14.197
> 
> 标签：ssl, cryptography, ssl-certificate

我了解通常 SSL（或更准确地说是 X.509）证书应该由某个认证机构签署，以确保它是真实的。

在某些情况下，不存在这样的签名，例如，如果您为测试目的生成证书，或者您*是*认证机构（根证书）。在这些情况下，使用自签名证书。

我的问题：为什么要使用这种奇怪的自签名结构？为什么证书不能简单地没有任何签名？包括一个自签名的签名增益是什么意思？

或者仅仅是因为在每个证书中始终都有一个签名在技术上更容易（没有签名的特殊情况），即使它是一个无意义的签名？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T01:20:25.493

证书包含三个主要部分

1.  身份信息
2.  公钥
3.  数字签名

证书通过使用私钥加密前两部分进行签名，然后将该加密信息附加到证书的末尾。如果您可以使用证书中包含的公钥解密签名，那么您就知道该证书是由持有匹配私钥的人签署的。签名将身份信息与公钥绑定。我用我的私钥签署我的证书，这样你就知道只有我可以阅读你可能用我的公钥加密的消息。

现在，除非你真的亲自见过我并且我把我的证书交给你，否则你无法真正知道身份信息是合法的我的。*证书的最初目的是通过首先获取您亲自*遇到的人的证书来建立信任网络，然后信任拥有这些人签署的证书的人，然后是那些人......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-04T21:45:26.333

如果您对证书进行自签名，则向某人证明您实际上控制了该签名的密钥 - 即，它是您的证书。

否则，您可以创建一个随机数并符合证书格式的公钥，但不是真正的证书。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T01:19:19.083

想象一下，您正在建立自己的证书颁发机构，第一个：谁签署您的证书？

理解整个认证过程的方法是将其视为一系列含义：您有一个证书呈现给您。你应该相信它吗？您可以信任颁发者，或者查看证书并同意您信任签名者。如果您不知道签名者，您可以按照它回到那个签名者的签名者，依此类推。不过，最终您将获得自签名证书。

但是，获得证书相对昂贵且可能很复杂，因此有些人直接建立自己的签名权限。由您决定是否可以信任它们。

* * *

一些关于此的评论变得有点愚蠢。您不能制作没有签名的证书，因为要成为有效的证书，必须有签名。这就是它们的定义方式。您不妨问为什么没有指数就不能有浮点数。证书的存在是为了收集一些身份信息*和一种用于识别发行者以确定信任的加密机制*。没有签名，对证书的“证书性”至关重要的东西就会丢失。

* * *

好吧，让我们问一些其他问题：

*   为什么社保号有9位数字？为什么你不能有一个 5 位数的社会安全号码？
*   为什么邮寄地址有那个愚蠢的邮政编码？
*   我们真的需要保留一个人的名字*和*姓氏吗？

* * *

让我们再试一次。什么是证书？它是一种将名称绑定到非对称加密密钥的公共端的数据结构。该结构是“签名的”，这意味着您可以检测它是否被签名密钥所有者以外的任何人更改。因为您可以验证该签名，所以您对证书的真实性有一定程度的信任。因此，有效的证书必须具有可验证的签名。

在这种情况下，“信任”意味着您愿意冒险在他人的授权下无法执行您负责的事情。如果您拥有由 Verisign 等知名 CA 签署的证书，那么您信任的实体就是 Verisign；您以某种值得信赖的方式使用从他们那里获得的证书来验证他们是否签署了您正在考虑的证书。

如果您拥有自签名证书，而不是由知名机构签名的证书，那么您就是说如果您接受证书，您愿意信任自签名者。您愿意接受的唯一权威是您对自签名者的直接信任。但是您至少可以确信证书没有损坏，因为您可以验证签名。

所以，现在考虑一个没有任何签名的证书。（从技术上讲，这称为“数据项”。）我可能包含名称和公钥之间的关联，但是如果没有签名，您就无法确信它没有被**第三方修改。**

看到不同？使用签名证书，您就有了双方都接受的双方同意的可信第三方。使用自签名证书，没有第三方，但您可以确信证书没有被第三方损坏。它可以像您信任证书的颁发者一样被信任：您可以验证它是由拥有适当密钥另一面的人颁发的。

使用未签名的“证书”，您既不能从受信任的第三方保证证书已颁发给正确的人，也不能保证“证书”一旦颁发，没有被恶意修改第三者。这就是为什么，**根据定义**，证书*必须*具有签名。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T01:23:44.610

您需要了解 RSA 加密的工作原理。签名者生成两个加密密钥，一个是私有的，一个是公共的。他们为您提供公钥，并使用私钥加密数据。有了公钥，您就可以验证数据是否由正确的人加密，因为没有其他人拥有他们的私钥。在签名证书的情况下，有一个信任网络，您可以在其中验证相对较少的个人（证书颁发机构）的身份，并且在第三方验证方面您信任他们。每个证书都必须根据系统的工作方式进行签名。任何人都可以对证书进行签名，当您不关心签名者的可验证性时，“自签名”证书是最简单的方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T00:53:07.553

我想这是为了确保你不能用证书“撒谎”——即，除非私钥持有者同意，否则你不能创建证书。这可以通过 CA 验证证书命名的实体是私钥持有者来确保，或者在自签名的情况下，通过让密钥持有者自己签署证书来确保。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T04:41:14.137

The difference between the two is who ran the program to generate the certificate. Some big corporation or some joe in his living room. The whole 'signed certificate' business is nonsense. A certificate allows you to encrypt data but large companies with something to sell you would have you believe that implies trustworthiness and identity. Encryption does not guarantee identity, and even more importantly, that you can trust the originator. Even assuming they have 100% good intentions just look in the news. How many big corporations have had data breaches this year?

I self signed my own certificate so I could encrypt the web traffic between my server and any users. I believe all traffic should be encrypted because no third party should be able to see what you do. I believe you should have a reasonable expectation of privacy. You should never completely trust anyone, particularly anyone who wants to sell you something.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T07:28:29.617

证书为您提供有关已签名密钥的实体的信息，但不会为您提供有关正在签署密钥的实体的信息。因此，自签名证书至少有一个目的：它们告诉您根密钥的所有者是谁，而无需实现特殊的数据结构。

在我看来，这些东西不应该被称为证书，因为它们具有不同的属性。普通证书不需要安全存储/传输。如果攻击者设法用假证书替换合法证书，那么证书验证应该会失败。自签名证书并非如此。如果攻击者有机会替换自签名证书，他/她可以用使用他/她的私钥签名的证书替换该证书，并且无法通过验证证书来检测伪造。

另请注意，自签名证书的逻辑有些倒退。您要做的第一件事是相信某些公钥是真实的。如果这样做，您可以了解公钥属于谁。通常人们会想要相反的。您决定可以信任一个实体。然后，您尝试了解属于该实体的公钥。

在我看来，应该放弃自签名证书。例如，我希望 Internet Explorer 中的所有根密钥都由 Microsoft 签名。毕竟是 Microsoft 验证了证书属于合法 CA，并且是 Microsoft 决定普通用户应该能够信任这些 CA。现在，如果我担心有人篡改了我的证书，我所要做的就是检查 Microsoft 的密钥是否仍然是他们的，然后验证每个证书上的签名。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-16T05:16:09.903

证书包含服务器的公钥。自签名是证明生成证书的人也拥有私钥的证明。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-03T21:15:21.743

证书的目的是验证身份。证书的签署者向证书的所有接收者断言，他们已经验证了身份信息的真实性以及它与证书中包含的公钥的关联。如果证书未签名，则没有身份验证，因此没有理由使用证书。在这种情况下，您可以使用不需要身份验证的密码，因此不严格要求身份信息。我认为 RC4 符合这个描述。

您的问题意味着您不需要自签名证书，因为您知道自己信任自己。因此，您可以在服务器和客户端之间预先共享证书。从可行的假设密码学角度来看；您的身份验证信息将受到保护。然而，非对称密钥加密工具和证书格式都不支持这种使用，因为它与具有预共享秘密的对称密钥密码相比没有任何好处。

# .net - 如何将新流程实例附加到现有流程？

> ID：871391
> 
> 赞同：0
> 
> 时间：2009-05-16T00:52:08.040
> 
> 标签：.net, process

我有一些进程正在运行。我知道它的processId。我需要创建一个新的 Diagnostics.Process 实例以附加到该已知进程。怎么做？语言 - VB.Net 或 C#

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T01:12:22.547

答案很简单：

```
Process p = Process.GetProcessById(procId) 
```

# javascript - 在 DOM 中记录或绘制自定义事件模型的正确方法

> ID：871398
> 
> 赞同：8
> 
> 时间：2009-05-16T01:00:53.107
> 
> 标签：javascript, dom-events, diagram

想象一下，您的 Web 应用程序中有一堆组件和子组件。您想要跟踪您添加的所有自定义事件的行为方式。是否有既定的方法来绘制或记录这些行为？

以下是文档应显示的一些内容：

1.  各种组件的相关 DOM 元素的实际嵌套。
2.  事件的名称以及它们被触发的位置。
3.  附加到自定义事件的任何有效负载（例如，`memo`原型自定义事件中的内容。）
4.  观察事件的地方。
5.  指示哪些事件被触发以响应其他事件。
6.  允许事件在哪里冒泡，在哪里停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T13:16:57.223

我从未听说过针对 Web 应用程序前端的既定文档标准。

也就是说，由于您已经确定了要跟踪的应用程序的不同方面，您可以将此信息保存在每个事件处理程序的 docblock 中，并使用[jsdoc 工具包](http://code.google.com/p/jsdoc-toolkit/)生成一些内联文档。

恕我直言，我认为既然您已经知道要记录什么，您应该随意以对您最有意义的任何格式创建文档，即使它对于您的应用程序/组织来说完全是独一无二的。在 stackoverflow 上 8 小时没有答案一定意味着没有标准答案；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-21T13:31:15.027

老实说，我曾经很喜欢视觉建模器，当 MS 将它转给 Visio 时，我有点失望。

也就是说，Visio 仍然是一个很棒的工具，您可以使用它来创建组件的对象模型并定义事件、属性、方法等。它具有一些用于 UML 设计等的内置功能。

但最后我不得不说，我通常以记事本或 MS word 结尾。根据您希望文档的详细程度，输入注释或组件描述永远不会真正适合任何类型的 DOM 工具，但您可以像 Word 文档中的疯子一样加粗、制表符、列出和斜体。

听起来很悲伤，但这是真的！

# javascript - 检测浏览器窗口scrollTop的跨浏览器方法

> ID：871399
> 
> 赞同：63
> 
> 时间：2009-05-16T01:01:08.393
> 
> 标签：javascript, cross-browser

检测浏览器窗口的 scrollTop 的最佳跨浏览器方法是什么？我不喜欢使用任何预先构建的代码库，因为这是一个非常简单的脚本，而且我不需要所有这些无谓的东西。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-05-16T14:32:00.643

```
function getScrollTop(){
    if(typeof pageYOffset!= 'undefined'){
        //most browsers except IE before #9
        return pageYOffset;
    }
    else{
        var B= document.body; //IE 'quirks'
        var D= document.documentElement; //IE with doctype
        D= (D.clientHeight)? D: B;
        return D.scrollTop;
    }
}

alert(getScrollTop()) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-05-16T07:25:31.537

或者只是简单的：

```
var scrollTop = document.body.scrollTop || document.documentElement.scrollTop; 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-16T02:16:24.920

如果您不想包含整个 JavaScript 库，通常可以从其中提取所需的部分。

例如，这本质上是[jQuery 实现](http://jqueryjs.googlecode.com/svn/tags/1.3.2/src/offset.js)跨浏览器滚动（Top|Left）的方式：

```
function getScroll(method, element) {
  // The passed in `method` value should be 'Top' or 'Left'
  method = 'scroll' + method;
  return (element == window || element == document) ? (
    self[(method == 'scrollTop') ? 'pageYOffset' : 'pageXOffset'] ||
    (browserSupportsBoxModel && document.documentElement[method]) ||
    document.body[method]
  ) : element[method];
}
getScroll('Top', element);
getScroll('Left', element); 
```

注意：您会注意到上面的代码包含一个`browserSupportsBoxModel`未定义的变量。[jQuery](http://jqueryjs.googlecode.com/svn/tags/1.3.2/src/support.js)通过临时添加一个 div 到页面然后测量一些属性以确定浏览器是否正确实现了盒子模型来定义这一点。你可以想象这个标志检查 IE。[具体来说，它在 quirks mode 中](http://docs.jquery.com/Utilities/jQuery.support)检查IE 6 或 7 。由于检测相当复杂，我将其作为练习留给您；-)，假设您已经在代码的其他地方使用了[浏览器](http://peter.michaux.ca/articles/feature-detection-state-of-the-art-browser-scripting) [功能](http://yura.thinkweb2.com/cft/) [检测。](http://www.jibbering.com/faq/faq_notes/not_browser_detect.html)

编辑：如果您还没有猜到，我强烈建议您使用库来处理这些事情。开销是为健壮且面向未来的代码付出的很小的代价，并且任何人都可以通过构建跨浏览器框架来提高工作效率。（而不是花费无数个小时来敲击 IE）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-12-15T19:38:41.833

我一直在使用`window.scrollY || document.documentElement.scrollTop`。

`window.scrollY`涵盖除 IE 以外的所有浏览器。
`document.documentElement.scrollTop`涵盖 IE。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-03T17:04:47.893

```
function getSize(method) {
  return document.documentElement[method] || document.body[method];
}
getSize("scrollTop"); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-02T18:46:00.313

**YUI 2.8.1**代码执行此操作：

```
function getDocumentScrollTop(doc) 
{
   doc = doc || document;

   //doc.body.scrollTop is IE quirkmode only
   return Math.max(doc.documentElement.scrollTop, doc.body.scrollTop);
} 
```

我认为**jQuery 1.4.2**代码（有点为人类翻译）并假设我正确理解它会这样做：

```
function getDocumentScrollTop(doc) 
{
   doc = doc || document;
   win = doc.defaultView || doc.parentWindow; //parentWindow is for IE < 9

   result = 0;
   if("pageYOffset" in win) //I'don't know why they use this, probably they tested it to be faster than doing: if(typeof win.pageYOffset !== 'undefined')
      result = win.pageYOffset;
   else
      result = (jQuery.support.boxModel && document.documentElement.scrollTop) || 
               document.body.scrollTop;

   return result;
} 
```

不幸的是，提取 的值`jQuery.support.boxModel`几乎是不可能的，因为您必须在文档中添加一个临时子元素并执行 jQuery 所做的相同测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-29T13:24:02.990

我知道自从这个线程更新以来已经有一段时间了，但这是我创建的一个函数，它允许开发人员找到实际托管的根元素，它具有一个有效的“scrollTop”属性。在 Mac OS X (10.9.5) 的 Chrome 42 和 Firefox 37 上测试：

```
function getScrollRoot(){
    var html = document.documentElement, body = document.body,
        cacheTop = ((typeof window.pageYOffset !== "undefined") ? window.pageYOffset : null) || body.scrollTop || html.scrollTop, // cache the window's current scroll position
        root;

    html.scrollTop = body.scrollTop = cacheTop + (cacheTop > 0) ? -1 : 1;
    // find root by checking which scrollTop has a value larger than the cache.
    root = (html.scrollTop !== cacheTop) ? html : body;

    root.scrollTop = cacheTop; // restore the window's scroll position to cached value

    return root; // return the scrolling root element
}

// USAGE: when page is ready: create a global variable that calls this function.

var scrollRoot = getScrollRoot();

scrollRoot.scrollTop = 10; // set the scroll position to 10 pixels from the top
scrollRoot.scrollTop = 0; // set the scroll position to the top of the window 
```

希望这个对你有帮助！干杯。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-15T14:55:11.657

这适用于 IE5 到 IE11。它还支持所有主要的新浏览器。

```
var scrollTop = (document.documentElement && document.documentElement.scrollTop) ||
                (document.body.scrollTop) || (document.scrollingElement); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-07-25T13:16:03.407

不需要额外的库，使用这个片段：

```
const scrollTop = 
    (window.pageYOffset !== undefined) ? 
     window.pageYOffset :
    (document.documentElement || document.body.parentNode || document.body).scrollTop; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-02-03T08:47:05.560

我相信在现代浏览器中获取 scrollTop 的最佳方法是使用

```
const scrollTop = document.scrollingElement.scrollTop 
```

如果这不起作用，您也可以尝试

```
const scrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop, document.scrollingElement.scrollTop) 
```

* * *

## 回答 #11

> 赞同：-6
> 
> 时间：2009-05-16T01:20:28.050

为了省去所有麻烦，请使用 jquery 或 mootools 之类的框架，在 mootools 的 $('element').getTop(); 中的一行（跨浏览器）中计算所有这些值；如果我没记错的话，在 jquery 中你将需要一个名为 dimensions 的插件，尽管大多数时候即使没有框架你也可以实际使用 element.getScrollTop(); 获得你需要的唯一问题是在 IE7 上，并且低于这个计算有点错误，因为它没有考虑元素的位置值，例如如果你有一个位置：该元素的绝对 css 属性计算是在该元素的父元素上执行

# c# - 异步实现

> ID：871401
> 
> 赞同：0
> 
> 时间：2009-05-16T01:02:38.030
> 
> 标签：c#, multithreading, asynchronous

我正在尝试开发一个支持异步方法调用的类。到目前为止，这是我想出的，但是，我不确定这是否是“正确的方法”。

我只希望异步方法执行一次，它不必支持多次执行，所以我没有使用`AsyncOperationManager`该类。

了解异步模式的人可以给我一些反馈吗？我这样做对吗？

任何帮助将不胜感激，因为我无法找到有关单次调用异步方法的任何信息。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.ComponentModel;

namespace ConsoleApplication1 {

    public delegate void WorkerDelegate();

    class Program {

        static void Main(string[] args) {

            String taskId = new Guid().ToString();

            AsyncTest test = new AsyncTest();
            test.DoSomethingLongAsyncCompleted += new AsyncCompletedEventHandler(test_DoSomethingLongAsyncCompleted);
            test.DoSomethingLongProgressChanged += new ProgressChangedEventHandler(test_DoSomethingLongProgressChanged);
            test.DoSomethingLongAsync(ItsOver, taskId);

            // Cancel after 2 seconds
            Thread.Sleep(2000);
            test.DoSomethingLongCancelAsync();

            Console.ReadLine(); //Pause the console window
        }

        static void test_DoSomethingLongProgressChanged(object sender, ProgressChangedEventArgs e) {
            Console.WriteLine("Percent complete: " + e.ProgressPercentage);
        }

        static void test_DoSomethingLongAsyncCompleted(object sender, AsyncCompletedEventArgs e) {
            Console.WriteLine("Cancelled? " + e.Cancelled);
            Console.WriteLine("Task ID: " + (String)e.UserState);
        }

        static void ItsOver(IAsyncResult r) {
            Console.WriteLine("Task ID: " + (String)r.AsyncState);
        }
    }

    class AsyncTest {

        IAsyncResult _asyncResult = null;
        Object _stateObj = null;
        AsyncCallback _callBackDelegate;

        public event ProgressChangedEventHandler DoSomethingLongProgressChanged;
        public event AsyncCompletedEventHandler DoSomethingLongAsyncCompleted;

        public IAsyncResult DoSomethingLongAsync(AsyncCallback userCallback, Object userState) {

            if (_stateObj != null)
                throw new InvalidOperationException("Method already started");

            WorkerDelegate worker = new WorkerDelegate(DoSomethingLong);

            _callBackDelegate = userCallback;
            _asyncResult = worker.BeginInvoke(null, userState);

            return _asyncResult;
        }

        public void DoSomethingLongCancelAsync() {
            _stateObj = null;
        }

        public void DoSomethingLong() {

            // Set state object if method was called synchronously
            if (_stateObj == null)
                _stateObj = new Object();

            for (int i = 0; i < 10; i++) {

                //If state object is null, break out of operation
                if (_stateObj == null) break;

                Thread.Sleep(1000);
                Console.WriteLine("Elapsed 1sec");

                if (DoSomethingLongProgressChanged != null) {
                    // Percentage calculation for demo only :-)
                    DoSomethingLongProgressChanged(this, new ProgressChangedEventArgs(i+1 * 10, _stateObj));
                }
            }

            // Only execute if method was called async
            if (_callBackDelegate != null) {
                _callBackDelegate(_asyncResult);

                DoSomethingLongAsyncCompleted(
                    this,
                    new AsyncCompletedEventArgs(null, (_stateObj == null), _asyncResult.AsyncState)
                );
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T01:28:42.117

处理异步模型有两种主要方法，请查看这篇关于[异步编程模型](http://msdn.microsoft.com/en-us/library/ms228969.aspx)的 MSDN 文章。您似乎正在尝试使用 IAsyncResult 技术。我倾向于仅将其用于低级系统 IO 操作。

对于 UI 或 API，我倾向于使用事件模型，因为我认为它更容易处理。对于您的情况，您可以向[QueueUserWorkItem](http://msdn.microsoft.com/en-us/library/kbf0f1ct.aspx)发送一个事件，跟踪 SynchronizationContext 并在触发完成的事件时使用它。（如果您使用的是 WPF，则可以改用 DispatchObject）。

这是我之前使用过的 ContactLoader 类。

```
public class ContactLoader
{
    public List<Contact> Contacts { get; private set; }
    private readonly IRepository<Contact> contactsRepository;

    public ContactLoader(IRepository<Contact> contactsRepository)
    {
        this.contactsRepository = contactsRepository;
    }

    public event AsyncCompletedEventHandler Completed;
    public void OnCompleted(AsyncCompletedEventArgs args)
    {
        if (Completed != null)
            Completed(this, args);
    }

    public bool Cancel { get; set; }

    private SynchronizationContext _loadContext;
    public void LoadAsync(AsyncCompletedEventHandler completed)
    {
        Completed += completed;
        LoadAsync();
    }
    public void LoadAsync()
    {
        if (_loadContext != null)
            throw new InvalidOperationException("This component can only handle 1 async request at a time");

        _loadContext = SynchronizationContext.Current;

        ThreadPool.QueueUserWorkItem(new WaitCallback(_Load));
    }

    public void Load()
    {
        _Load(null);
    }

    private void _Load(object state)
    {
        Exception asyncException = null;
        try
        {
            Contacts = contactsRepository.GetAll();

            if (Cancel)
            {
                _Cancel();
                return;
            }
        }
        catch (Exception ex)
        {
            asyncException = ex;
        }

        if (_loadContext != null)
        {
            AsyncCompletedEventArgs e = new AsyncCompletedEventArgs(asyncException, false, null);
            _loadContext.Post(args =>
            {
                OnCompleted(args as AsyncCompletedEventArgs);
            }, e);
            _loadContext = null;
        }
        else
        {
            if (asyncException != null) throw asyncException;
        }
    }

    private void _Cancel()
    {
        if (_loadContext != null)
        {
            AsyncCompletedEventArgs e = new AsyncCompletedEventArgs(null, true, null);
            _loadContext.Post(args =>
            {
                OnCompleted(args as AsyncCompletedEventArgs);
            }, e);
            _loadContext = null;
        }
    }
} 
```

# java - 在 Eclipse 中，在调试时，如何访问交互式顶层（又名“显示控制台”）？

> ID：871403
> 
> 赞同：61
> 
> 时间：2009-05-16T01:04:55.030
> 
> 标签：java, eclipse

在我使用的大多数编程语言中，在调试时，当我遇到断点时，我能够执行任意代码（无论我在断点被命中后在控制台中键入什么）。

如何在 Eclipse 中执行此操作？默认情况下，调试模式有一个显示控制台，但没有交互式控制台（我可以在其中输入 Java 代码以立即执行）

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2009-05-16T01:18:12.813

您可以使用 Display 视图执行任意代码，通过以下方式访问它：

> 窗口->显示视图->显示

然后键入您要执行的代码（您可以`CTRL+SPACE`用于自动完成）。

要执行代码，然后选择它：

> CTRL+SHIFT+D

那应该根据您命中的断点执行代码。

[![替代文字](https://i.stack.imgur.com/sXKyU.gif)](https://i.stack.imgur.com/sXKyU.gif)

注意：截至 2018 年，Display View 已重命名为[Debug Shell View](https://help.eclipse.org/photon/index.jsp?topic=%2Forg.eclipse.jdt.doc.user%2Freference%2Fviews%2Fdisplay%2Fref-debug_shell_view.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T01:10:24.097

Eclipse 确实有。窗口->显示视图->交互式控制台。请注意，您还可以在 Watch 视图中执行表达式（例如 result=false、exception.printStackTrace() 等）。

# dependency-injection - 为什么我需要 IoC 容器而不是直接的 DI 代码？

> ID：871405
> 
> 赞同：598
> 
> 时间：2009-05-16T01:06:18.070
> 
> 标签：dependency-injection, inversion-of-control, ioc-container

我一直在使用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)(DI)，在构造函数、属性或方法中注入。我从来没有觉得需要使用[控制反转](http://en.wikipedia.org/wiki/Inversion_of_control)(IoC) 容器。然而，我读得越多，我就越觉得来自社区的使用 IoC 容器的压力越大。

我使用过 .NET 容器，例如[StructureMap](http://docs.structuremap.net)、[NInject](http://www.ninject.org)、[Unity](http://unity.codeplex.com)和[Funq](http://funq.codeplex.com)。我仍然看不到 IoC 容器将如何使我的代码受益/改进。

我也害怕在工作中开始使用容器，因为我的许多同事会看到他们不理解的代码。他们中的许多人可能不愿意学习新技术。

请说服我我需要使用 IoC 容器。当我与工作中的开发人员同事交谈时，我将使用这些论点。

* * *

## 回答 #1

> 赞同：441
> 
> 时间：2009-10-07T15:10:50.297

哇，不敢相信乔尔会喜欢这个：

```
var svc = new ShippingService(new ProductLocator(), 
   new PricingService(), new InventoryService(), 
   new TrackingRepository(new ConfigProvider()), 
   new Logger(new EmailLogger(new ConfigProvider()))); 
```

对此：

```
var svc = IoC.Resolve<IShippingService>(); 
```

许多人没有意识到您的依赖链可以嵌套，并且手动连接它们很快就会变得笨拙。即使有工厂，重复代码也是不值得的。

IoC 容器可能很复杂，是的。但是对于这个简单的案例，我已经证明它非常简单。

* * *

好吧，让我们进一步证明这一点。假设您有一些想要绑定到智能 UI 的实体或模型对象。这个智能 UI（我们称之为 Shindows Morms）希望您实现 INotifyPropertyChanged，以便它可以进行更改跟踪并相应地更新 UI。

“好吧，这听起来不那么难”，所以你开始写作。

你从这个开始：

```
public class Customer
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime CustomerSince { get; set; }
    public string Status { get; set; }
} 
```

..最终得到**这个**：

```
public class UglyCustomer : INotifyPropertyChanged
{
    private string _firstName;
    public string FirstName
    {
        get { return _firstName; }
        set
        {
            string oldValue = _firstName;
            _firstName = value;
            if(oldValue != value)
                OnPropertyChanged("FirstName");
        }
    }

    private string _lastName;
    public string LastName
    {
        get { return _lastName; }
        set
        {
            string oldValue = _lastName;
            _lastName = value;
            if(oldValue != value)
                OnPropertyChanged("LastName");
        }
    }

    private DateTime _customerSince;
    public DateTime CustomerSince
    {
        get { return _customerSince; }
        set
        {
            DateTime oldValue = _customerSince;
            _customerSince = value;
            if(oldValue != value)
                OnPropertyChanged("CustomerSince");
        }
    }

    private string _status;
    public string Status
    {
        get { return _status; }
        set
        {
            string oldValue = _status;
            _status = value;
            if(oldValue != value)
                OnPropertyChanged("Status");
        }
    }

    protected virtual void OnPropertyChanged(string property)
    {
        var propertyChanged = PropertyChanged;

        if(propertyChanged != null)
            propertyChanged(this, new PropertyChangedEventArgs(property));
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

那是令人作呕的管道代码，我坚持认为，如果你手动编写这样的代码，**你就是在从你的客户那里偷东西**。有更好、更智能的工作方式。

听说过这个词，更聪明地工作，而不是更努力地工作吗？

想象一下，您团队中的某个聪明人走过来说：“这是一个更简单的方法”

如果您将您的属性虚拟化（冷静下来，这没什么大不了的），那么我们可以自动*编织*该属性行为。（这叫做AOP，不过不用管名字，专注于它会为你做什么）

根据您使用的 IoC 工具，您可以执行如下所示的操作：

```
var bindingFriendlyInstance = IoC.Resolve<Customer>(new NotifyPropertyChangedWrapper()); 
```

**噗！** 现在，所有手动 INotifyPropertyChanged BS 都会在相关对象的每个虚拟属性设置器上为您自动生成。

这是魔法吗？ **是的**！如果您可以相信此代码可以完成其工作这一事实，那么您可以安全地跳过所有包装 mumbo-jumbo 的属性。你有业务问题需要解决。

使用 IoC 工具执行 AOP 的其他一些有趣用途：

*   声明式和嵌套数据库事务
*   声明式和嵌套的工作单元
*   日志记录
*   前置/后置条件（按合同设计）

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2009-05-16T01:21:30.480

我和你在一起，瓦迪姆。IoC 容器采用了一个简单、优雅且有用的概念，并通过一本 200 页的手册将其变成你必须学习两天的东西。

[我个人对 IoC 社区如何将Martin Fowler 的一篇漂亮、优雅的文章](http://www.martinfowler.com/articles/injection.html)转化为一堆复杂的框架感到困惑，这些框架通常有 200-300 页的手册。

我尽量不去评判（哈哈！），但我认为使用 IoC 容器的人（A）非常聪明，（B）对不如他们聪明的人缺乏同理心。一切对他们来说都很有意义，所以他们很难理解许多普通程序员会发现这些概念令人困惑。这[是知识的诅咒](http://www.nytimes.com/2007/12/30/business/30know.html)。了解 IoC 容器的人很难相信有人不了解它。

使用 IoC 容器最有价值的好处是您可以在一个地方进行配置切换，让您可以在测试模式和生产模式之间进行切换。例如，假设您有两个版本的数据库访问类……一个版本积极记录并进行大量验证，您在开发过程中使用它，另一个版本没有记录或验证，这对于生产来说非常快。很高兴能够在一个地方在它们之间切换。另一方面，这是一个相当简单的问题，可以通过更简单的方式轻松处理，而无需 IoC 容器的复杂性。

我相信，如果您使用 IoC 容器，坦率地说，您的代码会变得更难阅读。为了弄清楚代码试图做什么，你必须查看的地方的数量至少增加了一个。在天堂的某个地方，一位天使在呼喊。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-09-19T02:32:38.257

大概没有人强迫您使用 DI 容器框架。您已经在使用 DI 来解耦您的类并提高可测试性，因此您获得了很多好处。简而言之，您喜欢简单，这通常是一件好事。

如果您的系统达到了手动 DI 变得繁琐（即增加维护）的复杂程度，请将其与 DI 容器框架的团队学习曲线进行权衡。

如果您需要对依赖生命周期管理进行更多控制（也就是说，如果您觉得需要实现单例模式），请查看 DI 容器。

如果您使用 DI 容器，请仅使用您需要的功能。如果足够，请跳过 XML 配置文件并在代码中对其进行配置。坚持构造函数注入。Unity 或 StructureMap 的基础知识可以浓缩为几页。

Mark Seemann 有一篇很棒的博文：[When to use a DI Container](http://blog.ploeh.dk/2012/11/06/WhenToUseADIContainer.aspx)

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-05-16T01:13:12.653

在我看来，IoC 的第一大好处是能够集中配置依赖项。

如果您当前正在使用依赖注入，您的代码可能如下所示

```
public class CustomerPresenter
{
  public CustomerPresenter() : this(new CustomerView(), new CustomerService())
  {}

  public CustomerPresenter(ICustomerView view, ICustomerService service)
  {
    // init view/service fields
  }
  // readonly view/service fields
} 
```

如果您使用静态 IoC 类，而不是更令人困惑的配置文件，恕我直言，您可能会有这样的东西：

```
public class CustomerPresenter
{
  public CustomerPresenter() : this(IoC.Resolve<ICustomerView>(), IoC.Resolve<ICustomerService>())
  {}

  public CustomerPresenter(ICustomerView view, ICustomerService service)
  {
    // init view/service fields
  }
  // readonly view/service fields
} 
```

然后，您的静态 IoC 类将如下所示，我在这里使用 Unity。

```
public static IoC
{
   private static readonly IUnityContainer _container;
   static IoC()
   {
     InitializeIoC();
   }

   static void InitializeIoC()
   {
      _container = new UnityContainer();
      _container.RegisterType<ICustomerView, CustomerView>();
      _container.RegisterType<ICustomerService, CustomerService>();
      // all other RegisterTypes and RegisterInstances can go here in one file.
      // one place to change dependencies is good.
   }
} 
```

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2009-05-16T02:12:21.357

IoC 容器也适用于加载深度嵌套的类依赖项。例如，如果您有使用依赖注入的以下代码。

```
public void GetPresenter()
{
    var presenter = new CustomerPresenter(new CustomerService(new CustomerRepository(new DB())));
}

class CustomerPresenter
{
    private readonly ICustomerService service;
    public CustomerPresenter(ICustomerService service)
    {
        this.service = service;
    }
}

class CustomerService
{
    private readonly IRespository<Customer> repository;
    public CustomerService(IRespository<Customer> repository)
    {
        this.repository = repository;
    }
}

class CustomerRepository : IRespository<Customer>
{
    private readonly DB db;
    public CustomerRepository(DB db)
    {
        this.db = db;
    }
}

class DB { } 
```

如果您将所有这些依赖项加载到 IoC 容器中，您可以 Resolve CustomerService 并且所有子依赖项将自动得到解决。

例如：

```
public static IoC
{
   private IUnityContainer _container;
   static IoC()
   {
       InitializeIoC();
   }

   static void InitializeIoC()
   {
      _container = new UnityContainer();
      _container.RegisterType<ICustomerService, CustomerService>();
      _container.RegisterType<IRepository<Customer>, CustomerRepository>();
   }

   static T Resolve<T>()
   {
      return _container.Resolve<T>();
   }
}

public void GetPresenter()
{
   var presenter = IoC.Resolve<CustomerPresenter>();
   // presenter is loaded and all of its nested child dependencies 
   // are automatically injected
   // -
   // Also, note that only the Interfaces need to be registered
   // the concrete types like DB and CustomerPresenter will automatically 
   // resolve.
} 
```

* * *

## 回答 #6

> 赞同：28
> 
> 时间：2009-05-16T01:41:16.813

我是声明式编程的粉丝（看看我回答了多少 SQL 问题），但是我看过的 IoC 容器对于它们自身来说似乎太神秘了。

...或者也许 IoC 容器的开发人员无法编写清晰的文档。

...否则两者在某种程度上都是正确的。

我不认为 IoC 容器的*概念*不好。但是实现必须足够强大（即灵活）以在各种应用程序中有用，而且简单且易于理解。

它可能是一个和六个中的六个。一个真正的应用程序（不是玩具或演示）必然是复杂的，需要考虑许多极端情况和规则例外。要么将这种复杂性封装在命令式代码中，要么封装在声明性代码中。但是你必须在某个地方代表它。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2009-05-16T01:19:48.723

使用容器主要是将初始化和配置的*命令式/脚本式风格转变为**声明*式风格。这可能会产生一些不同的有益效果：

*   减少[毛球](http://catb.org/jargon/html/H/hairball.html)主程序启动例程。
*   启用相当深入的部署时重新配置功能。
*   使依赖注入风格成为新工作阻力最小的路径。

当然，也可能有困难：

*   需要复杂的启动/关闭/生命周期管理的代码可能不容易适应容器。
*   您可能必须解决任何个人、流程和团队文化问题——但是，这就是您问...
*   一些工具包本身正在迅速成为重量级工具，鼓励了许多 DI 容器开始时反对的那种深度依赖。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2009-09-19T02:15:38.623

在我看来，**您已经构建了自己的 IoC 容器**（使用 Martin Fowler 描述的各种模式）并在问为什么其他人的实现比您的更好。

所以，你有一堆已经可以工作的代码。并且想知道为什么您想用其他人的实现来替换它。

**考虑第三方 IoC 容器的**优点****

 ***   您可以免费修复错误
*   图书馆设计可能比你的更好
*   人们可能已经熟悉特定的库
*   图书馆可能比你的更快
*   它可能有一些您希望实现但从未有时间实现的功能（您有服务定位器吗？）

**缺点**

*   您会免费获得错误介绍:)
*   库设计可能比你的差
*   你必须学习一个新的 API
*   太多你永远不会使用的功能
*   调试不是你写的代码通常更难
*   从以前的 IoC 容器迁移可能很乏味

因此，权衡利弊并做出决定。

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2009-05-16T04:40:52.733

我认为 IoC 的大部分价值是通过使用 DI 获得的。由于您已经这样做了，其余的好处是增量的。

您获得的价值将取决于您正在处理的应用程序类型：

*   对于多租户，IoC 容器可以处理一些用于加载不同客户端资源的基础架构代码。当您需要特定于客户端的组件时，请使用自定义选择器来处理逻辑，而不必担心客户端代码中的逻辑。您当然可以自己构建它，但[这里有一个 IoC 可以提供帮助的示例](http://mikehadlow.blogspot.com/2008/11/multi-tenancy-part-2-components-and.html)。

*   由于具有许多可扩展性，IoC 可用于从配置中加载组件。这是一种常见的构建方式，但工具由容器提供。

*   如果你想使用 AOP 处理一些横切关注点，[IoC 提供了钩子](http://ayende.com/Blog/archive/2008/07/31/Logging--the-AOP-way.aspx)来拦截方法调用。这在项目中不太常见，但 IoC 使它更容易。

我以前写过这样的功能，但如果我现在需要这些功能中的任何一个，我宁愿使用一个预先构建和测试过的工具，如果它适合我​​的架构。

正如其他人所提到的，您还可以集中配置要使用的类。虽然这可能是一件好事，但它的代价是误导和复杂化。大多数应用程序的核心组件并没有被太多替换，因此权衡取舍有点困难。

我使用 IoC 容器并欣赏其功能，但不得不承认我注意到了权衡：我的代码在类级别变得更加清晰，而在应用程序级别变得不那么清晰（即可视化控制流）。

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2013-01-10T18:30:08.390

我是一个正在恢复的国际奥委会瘾君子。这些天来，我发现在大多数情况下很难证明将 IOC 用于 DI 是合理的。IOC 容器牺牲了编译时间检查，据推测作为回报，您可以“轻松”设置、复杂的生命周期管理以及在运行时动态发现依赖项。我发现在绝大多数情况下，编译时间检查的损失和由此产生的运行时间魔法/异常是不值得的。在大型企业应用程序中，它们会使跟踪正在发生的事情变得非常困难。

我不赞成集中化论点，因为您也可以很容易地集中静态设置，方法是为您的应用程序使用抽象工厂，并虔诚地将对象创建推迟到抽象工厂，即进行适当的 DI。

为什么不做这样的静态无魔法 DI：

```
interface IServiceA { }
interface IServiceB { }
class ServiceA : IServiceA { }
class ServiceB : IServiceB { }

class StubServiceA : IServiceA { }
class StubServiceB : IServiceB { }

interface IRoot { IMiddle Middle { get; set; } }
interface IMiddle { ILeaf Leaf { get; set; } }
interface ILeaf { }

class Root : IRoot
{
    public IMiddle Middle { get; set; }

    public Root(IMiddle middle)
    {
        Middle = middle;
    }

}

class Middle : IMiddle
{
    public ILeaf Leaf { get; set; }

    public Middle(ILeaf leaf)
    {
        Leaf = leaf;
    }
}

class Leaf : ILeaf
{
    IServiceA ServiceA { get; set; }
    IServiceB ServiceB { get; set; }

    public Leaf(IServiceA serviceA, IServiceB serviceB)
    {
        ServiceA = serviceA;
        ServiceB = serviceB;
    }
}

interface IApplicationFactory
{
    IRoot CreateRoot();
}

abstract class ApplicationAbstractFactory : IApplicationFactory
{
    protected abstract IServiceA ServiceA { get; }
    protected abstract IServiceB ServiceB { get; }

    protected IMiddle CreateMiddle()
    {
        return new Middle(CreateLeaf());
    }

    protected ILeaf CreateLeaf()
    {
        return new Leaf(ServiceA,ServiceB);
    }

    public IRoot CreateRoot()
    {
        return new Root(CreateMiddle());
    }
}

class ProductionApplication : ApplicationAbstractFactory
{
    protected override IServiceA ServiceA
    {
        get { return new ServiceA(); }
    }

    protected override IServiceB ServiceB
    {
        get { return new ServiceB(); }
    }
}

class FunctionalTestsApplication : ApplicationAbstractFactory
{
    protected override IServiceA ServiceA
    {
        get { return new StubServiceA(); }
    }

    protected override IServiceB ServiceB
    {
        get { return new StubServiceB(); }
    }
}

namespace ConsoleApplication5
{
    class Program
    {
        static void Main(string[] args)
        {
            var factory = new ProductionApplication();
            var root = factory.CreateRoot();

        }
    }

    //[TestFixture]
    class FunctionalTests
    {
        //[Test]
        public void Test()
        {
            var factory = new FunctionalTestsApplication();
            var root = factory.CreateRoot();
        }
    }
} 
```

您的容器配置是您的抽象工厂实现，您的注册是抽象成员的实现。如果您需要一个新的单例依赖项，只需将另一个抽象属性添加到抽象工厂即可。如果您需要临时依赖，只需添加另一个方法并将其作为 Func<> 注入。

好处：

*   所有设置和对象创建配置都是集中的。
*   配置只是代码
*   编译时间检查使维护变得容易，因为您不会忘记更新您的注册。
*   没有运行时反射魔法

我建议持怀疑态度的人尝试下一个绿地项目，并诚实地问自己在什么时候需要容器。稍后很容易考虑到 IOC 容器，因为您只是用 IOC 容器配置模块替换工厂实现。

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2009-10-08T21:22:15.390

对我来说（就我个人而言，我使用 Ninject）使用 IoC 容器的最大好处是消除了设置和其他类型的全局状态对象的传递。

我不是为网络编程，我的是一个控制台应用程序，在对象树深处的许多地方，我需要访问由用户指定的设置或元数据，这些设置或元数据是在对象树的一个完全独立的分支上创建的。使用 IoC，我只是告诉 Ninject 将设置视为单例（因为它们总是只有一个实例），在构造函数中请求设置或字典并 presto ......当我需要它们时它们会神奇地出现！

如果不使用 IoC 容器，我将不得不将设置和/或元数据向下传递到 2、3、...、n 个对象，然后才能被需要它的对象实际使用。

DI/IoC 容器还有许多其他好处，正如其他人在此处详述的那样，从创建对象到请求对象的想法可能令人费解，但使用 DI 对我和我的团队非常有帮助，所以也许你可以添加它到你的武器库！

* * *

## 回答 #12

> 赞同：14
> 
> 时间：2009-10-13T09:20:29.140

如果你想的话，IoC 框架非常好……

*   ...扔掉类型安全。如果您想确定一切都正确连接，许多（全部？）IoC 框架会强制您执行代码。“嘿！希望我把所有东西都设置好了，这样我对这 100 个类的初始化就不会在生产中失败，抛出空指针异常！”

*   ...用全局变量乱扔代码（IoC 框架都是*关于*改变全局状态的）。

*   ...编写依赖不明确且难以重构的蹩脚代码，因为您永远不知道什么依赖于什么。

IoC 的问题在于使用它们的人曾经编写过这样的代码

```
public class Foo {
    public Bar Apa {get;set;}
    Foo() {
        Apa = new Bar();
    }
} 
```

这显然是有缺陷的，因为 Foo 和 Bar 之间的依赖是硬连线的。然后他们意识到写这样的代码会更好

```
public class Foo {
    public IBar Apa {get;set;}
    Foo() {
        Apa = IoC<IBar>();
    }
} 
```

这也是有缺陷的，但不那么明显。在 Haskell 中，类型`Foo()`是，`IO Foo`但你真的不想要`IO`-part 并且 is 应该是一个警告信号，表明你的设计有问题，如果你得到它。

要摆脱它（IO 部分），获得 IoC 框架的所有优点并且没有它的缺点，您可以改用抽象工厂。

正确的解决方案是

```
data Foo = Foo { apa :: Bar } 
```

或许

```
data Foo = forall b. (IBar b) => Foo { apa :: b } 
```

并注入（但我不会称之为注入）吧。

另外：请看 Erik Meijer（LINQ 的发明者）的视频，他说 DI 适合不懂数学的人（我完全同意）：[http ://www.youtube.com/watch?v =8Mttjyf-8P4](http://www.youtube.com/watch?v=8Mttjyf-8P4)

与 Spolsky 先生不同，我不相信使用 IoC 框架的人非常聪明——我只是相信他们不懂数学。

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2010-06-17T22:50:13.630

我发现正确实现依赖注入往往会迫使程序员使用各种其他有助于提高代码的可测试性、灵活性、可维护性和可扩展性的编程实践：单一职责原则、关注点分离和编码等实践针对 API。感觉就像我被迫编写更多模块化、一口大小的类和方法，这使得代码更易于阅读，因为它可以被分成一口大小的块。

但它也倾向于创建相当大的依赖树，通过框架（特别是如果您使用约定）比手动管理更容易。今天我想在 LINQPad 中快速测试一些东西，我认为创建内核并加载到我的模块中会很麻烦，最后我手工编写了这个：

```
var merger = new SimpleWorkflowInstanceMerger(
    new BitFactoryLog(typeof(SimpleWorkflowInstanceMerger).FullName), 
    new WorkflowAnswerRowUtil(
        new WorkflowFieldAnswerEntMapper(),
        new ActivityFormFieldDisplayInfoEntMapper(),
        new FieldEntMapper()),
    new AnswerRowMergeInfoRepository()); 
```

回想起来，使用 IoC 框架会更快，因为模块按照惯例定义了几乎所有这些东西。

在花了一些时间研究这个问题的答案和评论之后，我确信反对使用 IoC 容器的人并没有练习真正的依赖注入。我看到的示例是通常与依赖注入混淆的实践。有些人抱怨难以“阅读”代码。如果操作正确，您的绝大多数代码在手动使用 DI 时应该与使用 IoC 容器时相同。差异应该完全存在于应用程序中的几个“启动点”中。

换句话说，如果您不喜欢 IoC 容器，那么您可能没有按照应有的方式进行依赖注入。

另一点：如果你在任何地方使用反射，依赖注入真的不能手工完成。虽然我讨厌反射对代码导航的作用，但您必须认识到在某些领域确实无法避免。例如，ASP.NET MVC 尝试通过对每个请求的反射来实例化控制器。要手动进行依赖注入，您必须使*每个控制器*成为“上下文根”，如下所示：

```
public class MyController : Controller
{
    private readonly ISimpleWorkflowInstanceMerger _simpleMerger;
    public MyController()
    {
        _simpleMerger = new SimpleWorkflowInstanceMerger(
            new BitFactoryLog(typeof(SimpleWorkflowInstanceMerger).FullName), 
            new WorkflowAnswerRowUtil(
                new WorkflowFieldAnswerEntMapper(),
                new ActivityFormFieldDisplayInfoEntMapper(),
                new FieldEntMapper()),
            new AnswerRowMergeInfoRepository())
    }
    ...
} 
```

现在将此与允许 DI 框架为您执行此操作进行比较：

```
public MyController : Controller
{
    private readonly ISimpleWorkflowInstanceMerger _simpleMerger;
    public MyController(ISimpleWorkflowInstanceMerger simpleMerger)
    {
        _simpleMerger = simpleMerger;
    }
    ...
} 
```

使用 DI 框架，请注意：

*   我可以对这个类进行单元测试。通过创建一个 mock `ISimpleWorkflowInstanceMerger`，我可以测试它是否按照我预期的方式使用，而不需要数据库连接或任何东西。
*   我使用的代码少得多，而且代码更容易阅读。
*   如果我的依赖项的依赖项之一发生更改，我不必对控制器进行任何更改。当您考虑到多个控制器可能使用某些相同的依赖项时，这尤其好。
*   我从不从我的数据层明确引用类。我的 Web 应用程序可以只包含对包含`ISimpleWorkflowInstanceMerger`接口的项目的引用。这使我可以将应用程序分解为单独的模块，并维护一个真正的多层架构，这反过来又使事情变得更加灵活。

一个典型的 Web 应用程序会有很多控制器。随着应用程序的增长，在每个控制器中手动执行 DI 的所有痛苦都会真正叠加起来。如果您有一个只有一个上下文根的应用程序，它从不尝试通过反射来实例化服务，那么这不是一个大问题。然而，任何使用依赖注入的应用程序一旦达到一定大小，管理起来就会变得非常昂贵，除非你使用某种框架来管理依赖图。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2009-10-07T19:22:05.347

每当您使用“new”关键字时，您都在创建一个具体的类依赖项，并且您的脑海中应该会响起一个小警钟。孤立地测试这个对象变得更加困难。解决方案是对接口进行编程并注入依赖项，以便可以使用任何实现该接口的对象（例如模拟）对对象进行单元测试。

问题是你必须在某处构造对象。工厂模式是将耦合从您的 POXO 中转移出来的一种方式（普通旧的“在此处插入您的 OO 语言”对象）。如果您和您的同事都在编写这样的代码，那么 IoC 容器是您可以对代码库进行的下一个“增量改进”。它会将所有讨厌的 Factory 样板代码从您的干净对象和业务逻辑中移出。他们会得到它并喜欢它。哎呀，让公司谈谈你为什么喜欢它，让每个人都兴奋不已。

如果你的同事还没有做 DI，那么我建议你先关注它。传播有关如何编写易于测试的干净代码的信息。干净的 DI 代码是最困难的部分，一旦你到了那里，将对象连接逻辑从工厂类转移到 IoC 容器应该是相对微不足道的。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2009-05-16T01:19:13.420

因为所有依赖项都清晰可见，它促进了创建松散耦合的组件，同时在应用程序中易于访问和重用。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2009-12-17T05:56:48.050

您*不需要*IoC 容器。

但是，如果您严格遵循 DI 模式，您会发现拥有一个会删除大量冗余、无聊的代码。

无论如何，这通常是使用库/框架的最佳时机 - 当您了解它在做什么并且可以在没有库的情况下做到这一点时。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2009-10-07T18:38:57.010

我恰好正在抽出自制的 DI 代码并用 IOC 替换它。我可能已经删除了 200 多行代码，并用大约 10 行代码替换了它。是的，我必须学习一些关于如何使用容器 (Winsor) 的知识，但我是一名在互联网技术领域工作的工程师21世纪，习惯了。我可能花了大约 20 分钟来查看操作方法。这非常值得我花时间。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2009-10-07T15:10:20.563

随着您继续解耦类并反转依赖项，类继续保持较小，“依赖关系图”的大小继续增长。（这还不错。）使用 IoC 容器的基本功能使得连接所有这些对象变得微不足道，但是手动完成会变得非常繁重。例如，如果我想创建一个“Foo”的新实例，但它需要一个“Bar”。一个“酒吧”需要一个“A”、“B”和“C”。而且每一个都需要其他 3 件东西，等等（是的，我想不出好的假名 :)）。

使用 IoC 容器为您构建对象图可以大大降低复杂性并将其推送到一次性配置中。我只是说“为我创建一个'Foo'”，它会弄清楚构建一个'Foo'需要什么。

有些人将 IoC 容器用于更多的基础设施，这对于高级场景来说很好，但在这些情况下，我同意它可能会混淆并使新开发人员难以阅读和调试代码。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2009-10-08T16:50:26.343

关于 Unity 的同上。太大了，你可以听到椽子的吱吱声。

当人们开始谈论 IoC 代码看起来多么干净时，我永远不会感到惊讶，这与那些曾经谈论 C++ 中的模板是如何回到 90 年代的优雅方式的人是同一类人，但如今却将它们谴责为晦涩难懂. 呸！

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-05-16T05:01:44.727

在 .NET 世界中，AOP 并不太流行，因此对于 DI，框架是您唯一真正的选择，无论您是自己编写还是使用另一个框架。

如果您使用 AOP，则可以在编译应用程序时进行注入，这在 Java 中更为常见。

DI 有很多好处，例如减少耦合，因此单元测试更容易，但是您将如何实现它呢？你想自己用反射来做吗？

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-07-21T23:37:50.470

所以，已经快3年了吧？

1.  评论支持 IoC 框架的人中有 50% 不了解 IoC 和 IoC 框架之间的区别。我怀疑他们是否知道您可以编写代码而无需部署到应用服务器

2.  如果我们以最流行的 Java Spring 框架为例，它是将 IoC 配置从 XMl 转移到代码中，现在看起来像这样

`@Configuration 公共类 AppConfig {

```
public @Bean TransferService transferService() {
    return new TransferServiceImpl(accountRepository());
}

public @Bean AccountRepository accountRepository() {
    return new InMemoryAccountRepository();
} 
```

` 我们需要一个框架来做到这一点，为什么？

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2013-03-08T18:52:46.920

老实说，我发现在很多情况下都不需要 IoC 容器，而且大多数情况下，它们只是增加了不必要的复杂性。

如果您只是将它用于简化对象的构造，我不得不问，您是否在多个位置实例化该对象？单身人士会不适合您的需求吗？您是否在运行时更改配置？（切换数据源类型等）。

如果是，那么您可能需要一个 IoC 容器。如果没有，那么您只是将初始化从开发人员可以轻松看到的地方移开。

谁说接口比继承好？假设您正在测试一项服务。为什么不使用构造函数 DI，并使用继承创建依赖项的模拟？我使用的大多数服务只有几个依赖项。以这种方式进行单元测试可以防止维护大量无用的接口，并且意味着您不必*使用*Resharper 来快速找到方法的声明。

我相信对于大多数实现来说，说 IoC 容器删除不需要的代码是一个神话。

首先，首先要设置容器。然后你仍然需要定义每个需要初始化的对象。因此，您不要在初始化时保存代码，而是移动它（除非您的对象被多次使用。作为 Singleton 是否更好？）。然后，对于您以这种方式初始化的每个对象，您必须创建并维护一个接口。

有人对此有任何想法吗？

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-08-12T23:34:35.133

如果您需要集中配置依赖项，那么您将需要一个 IoC 容器，以便可以轻松地将它们大量换出。这在 TDD 中最有意义，其中许多依赖项被换出，但依赖项之间几乎没有相互依赖关系。这样做的代价是在一定程度上混淆了对象构造的控制流程，因此组织良好且文档合理的配置很重要。有理由这样做也不错，否则就是[抽象的镀金](http://xkcd.com/974/ "抽象镀金")。我已经看到它做得很差，以至于它被拖到相当于构造函数的 goto 语句。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-09-10T13:26:39.637

[这](https://github.com/gridmaster/IOC-with-Ninject)就是为什么。该项目称为 IOC-with-Ninject。您可以下载并使用 Visual Studio 运行它。此示例使用 Ninject，但所有“新”语句都在一个位置，您可以通过更改要使用的绑定模块来完全更改应用程序的运行方式。该示例已设置，因此您可以绑定到服务的模拟版本或真实版本。在小型项目中可能无关紧要，但在大型项目中却很重要。

需要明确的是，我所看到的优势：1）*所有* **新**语句都位于代码根目录的一个位置。2) 一次更改就完全重构代码。3）“酷因素”的加分，因为它......好吧：酷。:p

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2014-02-11T15:42:31.213

我将尝试从我的角度找出为什么 IOC 可能不适合。

与其他所有内容一样，IOC 容器（或爱因斯坦所说的 I=OC^2）是一个概念，您必须自己决定是否在代码中需要它。最近时尚界对国际奥委会的强烈抗议仅止于此，时尚。不要迷恋时尚，这是第一。您可以在代码中实现无数概念。首先，自从我开始编程以来，我就一直在使用依赖注入，并且当它以该名称流行时就学会了这个术语本身。依赖控制是一个非常古老的主题，到目前为止，它已经以数万亿种方式解决，具体取决于与什么脱钩。将一切与一切脱钩是无稽之谈。IOC 容器的问题在于它试图与实体框架或 NHibernate 一样有用。当您必须将任何数据库与系统耦合时，编写对象关系映射器只是必须的，但 IOC 容器并不总是必需的。所以当 IOC 容器有用时：

1.  当您遇到需要组织许多依赖项的情况时
2.  当您不关心将代码与第三方产品耦合时
3.  当您的开发人员想要学习如何使用新工具时

1：您的代码中并不经常有如此多的依赖关系，或者您在设计早期就意识到它们。当抽象思维到期时，抽象思维是有用的。

2：将您的代码与第三方代码耦合是一个巨大的问题。我使用的代码已经有 10 多年的历史了，并且当时遵循的是 ATL、COM、COM+ 等花哨的高级概念。您现在无法使用该代码执行任何操作。我要说的是，一个先进的概念会带来明显的优势，但从长远来看，这会因为过时的优势本身而被取消。它只是让这一切变得更加昂贵。

3：软件开发已经够难了。如果您允许将一些高级概念裁剪到您的代码中，则可以将其扩展到无法识别的级别。IOC2 有问题。尽管它是解耦依赖关系，但它也解耦了逻辑流。想象一下，您发现了一个错误，您需要设置一个休息时间来检查情况。与任何其他先进概念一样，IOC2 使这变得更加困难。修复概念中的错误比修复更简单的代码中的错误更困难，因为当您修复错误时，必须再次遵守概念。（举个例子，C++ .NET 不断地改变语法，以至于在重构一些旧版本的 .NET 之前，您需要认真思考。）那么 IOC 的问题是什么？问题在于解决依赖关系。解析的逻辑通常隐藏在 IOC2 本身中，可能以您需要学习和维护的不常见方式编写。你的第三方产品会在 5 年内出现吗？微软不是。

关于IOC2，“我们知道如何”综合症到处都是。这类似于自动化测试。乍一看很花哨的术语和完美的解决方案，您只需将所有测试放在晚上执行，然后在早上查看结果。一个接一个地解释自动化测试的真正含义真的很痛苦。自动化测试绝对不是减少您可以在一夜之间引入以提高产品质量的错误数量的快速方法。但是，时尚正在让这个概念变得恼人地占据主导地位。IOC2 患有同样的综合症。相信您需要实现它才能使您的软件变得更好。最近的每一次采访都被问到我是否正在实施 IOC2 和自动化。这是一种时尚的标志：公司有一部分代码是用 MFC 编写的，他们不会放弃。

您需要像学习软件中的任何其他概念一样学习 IOC2。是否需要使用 IOC2 的决定权在团队和公司内部。但是，在做出决定之前，至少必须提及所有上述论点。只有当你看到积极的一面超过消极的一面，你才能做出积极的决定。

IOC2 没有任何问题，只是它确实只解决了它解决的问题并引入了它引入的问题。没有其他的。然而，逆潮流而动是很困难的，他们嘴里有汗，什么都追随者。奇怪的是，当他们的幻想问题变得明显时，他们都不存在。软件行业中的许多概念都受到了捍卫，因为它们创造了利润、编写了书籍、召开了会议、制造了新产品。那就是时尚，通常是短暂的。一旦人们找到其他东西，他们就会完全放弃它。IOC2 很有用，但它显示出与我见过的许多其他已消失的概念相同的迹象。不知道能不能活下来。没有规则。你认为如果它有用，它就会存活下来。不，它不会那样做。一家有钱的大公司就足够了，而这个概念可能会在几周内消失。我们拭目以待。NHibernate 幸存下来，EF 位居第二。也许 IOC2 也会幸存下来。不要忘记，软件开发中的大多数概念都没什么特别的，它们非常合乎逻辑、简单明了，有时记住当前的命名约定比理解概念本身更难。IOC2 的知识会让开发者成为更好的开发者吗？不，因为如果开发人员无法提出本质上与 IOC2 相似的概念，那么他或她将很难理解 IOC2 正在解决哪个问题，使用它会显得人为，他或她可能会开始使用它为了某种政治正确。不要忘记，软件开发中的大多数概念都没什么特别的，它们非常合乎逻辑、简单明了，有时记住当前的命名约定比理解概念本身更难。IOC2 的知识会让开发者成为更好的开发者吗？不，因为如果开发人员无法提出本质上与 IOC2 相似的概念，那么他或她将很难理解 IOC2 正在解决哪个问题，使用它会显得人为，他或她可能会开始使用它为了某种政治正确。不要忘记，软件开发中的大多数概念都没什么特别的，它们非常合乎逻辑、简单明了，有时记住当前的命名约定比理解概念本身更难。IOC2 的知识会让开发者成为更好的开发者吗？不，因为如果开发人员无法提出本质上与 IOC2 相似的概念，那么他或她将很难理解 IOC2 正在解决哪个问题，使用它会显得人为，他或她可能会开始使用它为了某种政治正确。IOC2 的知识会让开发者成为更好的开发者吗？不，因为如果开发人员无法提出本质上与 IOC2 相似的概念，那么他或她将很难理解 IOC2 正在解决哪个问题，使用它会显得人为，他或她可能会开始使用它为了某种政治正确。IOC2 的知识会让开发者成为更好的开发者吗？不，因为如果开发人员无法提出本质上与 IOC2 相似的概念，那么他或她将很难理解 IOC2 正在解决哪个问题，使用它会显得人为，他或她可能会开始使用它为了某种政治正确。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-10-07T17:53:51.013

就个人而言，我使用 IoC 作为我的应用程序的某种结构图（是的，我也更喜欢 StructureMap ;)）。它使得在测试期间用 Moq 实现替换我通常的接口实现变得很容易。创建测试设置可以像对我的 IoC 框架进行新的 init-call 一样简单，用模拟替换作为我的测试边界的任何类。

这可能不是 IoC 的用途，但这是我发现自己最常使用它的用途。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-11-25T00:47:02.573

IOC 容器解决了您可能没有的问题，但这是一个很好的问题

[http://kozmic.net/2012/10/23/ioc-container-solves-a-problem-you-might-not-have-but-its-a-nice-problem-to-have/](http://kozmic.net/2012/10/23/ioc-container-solves-a-problem-you-might-not-have-but-its-a-nice-problem-to-have/)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-02-07T05:13:28.380

你不需要一个框架来实现依赖注入。您也可以通过核心 Java 概念来做到这一点。 [http://en.wikipedia.org/wiki/Dependency_injection#Code_illustration_using_Java](http://en.wikipedia.org/wiki/Dependency_injection#Code_illustration_using_Java)

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-03-27T19:41:25.977

我意识到这是一篇相当老的帖子，但它似乎仍然相当活跃，我想我会贡献一些其他答案中尚未提到的观点。

我会说我同意依赖注入的好处，但我更喜欢自己构造和管理对象，使用的模式与 Maxm007 在他的回答中概述的模式不同。我发现使用 3rd 方容器有两个主要问题：

1）让第 3 方库“自动”管理对象的生命周期可能会产生意想不到的结果。我们发现，特别是在大型项目中，您可以拥有比您预期更多的对象副本，并且比手动管理生命周期时更多。我确信这取决于所使用的框架，但问题仍然存在。如果您的对象拥有资源、数据连接等，这也可能会出现问题，因为该对象的寿命有时可能比您预期的要长。因此不可避免地，IoC 容器往往会增加应用程序的资源利用率和内存占用。

2) 在我看来，IoC 容器是“黑盒编程”的一种形式。我发现特别是，我们经验不足的开发人员倾向于滥用它们。它允许程序员不必考虑对象应该如何相互关联或如何将它们解耦，因为它为他们提供了一种机制，他们可以凭空简单地抓取他们想要的任何对象。例如，可能有一个很好的设计理由，即 ObjectA 永远不应该直接知道 ObjectB，但与其创建工厂、桥接或服务定位器，没有经验的程序员会简单地说“没问题，我会从 IoC 容器中获取 ObjectB ”。这实际上会导致对象耦合增加，而这正是 IoC 应该帮助防止的。

* * *

## 回答 #30

> 赞同：-8
> 
> 时间：2009-10-07T15:20:05.177

ASP.NET 项目中的依赖注入可以通过几行代码来完成。我想当您有一个使用多个前端并需要单元测试的应用程序时，使用容器有一些优势。

# c++ - 您将如何制作一个在 C++ 中执行文件读取功能的标头

> ID：871411
> 
> 赞同：0
> 
> 时间：2009-05-16T01:16:17.827
> 
> 标签：c++, file, io

这听起来可能是新手，但是，我正在尝试制作一个外部头文件，该头文件执行一个函数，该函数从文件中读取一个名称，如 joey，并将其作为变量保存到它读取的其他代码中，但我无法弄清楚......会是这样...一个代码将获得这个名称并将其写入文件...然后我想使用此标头读取此文件而无需再次编写完整代码但我似乎找不到方法将读取的名称保存到变量..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T01:21:59.373

好吧，这个不是很清楚。你能列出一些类似伪代码的东西来解释它吗？

如果我完全理解你的话，你想在一个地方将数据写入文件，然后从其他地方读取它，并且你希望读取它的代码位于头文件中。没有什么特别不可能的，但是有很多更简单更好的方法来处理它。

# php - 循环一个 SimpleXML 对象，或者把整个对象变成一个数组

> ID：871422
> 
> 赞同：19
> 
> 时间：2009-05-16T01:22:12.600
> 
> 标签：php, amazon-web-services, simplexml, amazon-simpledb

我正在尝试解决如何通过返回的 SimpleXML 对象进行迭代。

我正在使用一个名为[Tarzan AWS](http://tarzan-aws.com/)的工具包，它连接到 Amazon Web Services（SimpleDB、S3、EC2 等）。我专门使用 SimpleDB。

我可以将数据放入 Amazon SimpleDB 服务，然后我可以取回它。我只是不知道如何处理返回的 SimpleXML 对象。

Tarzan AWS 文档是这样说的：

> 查看响应以浏览响应的标头和正文。请注意，这是一个对象，而不是数组，并且主体是一个 SimpleXML 对象。

以下是返回的 SimpleXML 对象的示例：

```
[body] => SimpleXMLElement 对象
        (
            [QueryWithAttributesResult] => SimpleXMLElement 对象
                (
                    [项目] => 数组
                        (
                            [0] => SimpleXMLElement 对象
                                (
                                    [名称] => 消息12413344443260
                                    [属性] => 数组
                                        (
                                            [0] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 活跃
                                                    [值] => 1
                                                )

                                            [1] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 用户
                                                    [价值] => 约翰
                                                )

                                            [2] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 消息
                                                    [值] => 这是一条消息。
                                                )

                                            [3] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 时间
                                                    [价值] => 1241334444
                                                )

                                            [4] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 身份证
                                                    [价值] => 12413344443260
                                                )

                                            [5] => SimpleXMLElement 对象
                                                (
                                                    [名称] => ip
                                                    [值] => 10.10.10.1
                                                )

                                        )

                                )

                            [1] => SimpleXMLElement 对象
                                (
                                    [名称] => 消息12413346907303
                                    [属性] => 数组
                                        (
                                            [0] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 活跃
                                                    [值] => 1
                                                )

                                            [1] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 用户
                                                    [价值] => 弗雷德
                                                )

                                            [2] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 消息
                                                    [值] => 这是另一条消息
                                                )

                                            [3] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 时间
                                                    [价值] => 1241334690
                                                )

                                            [4] => SimpleXMLElement 对象
                                                (
                                                    [名称] => 身份证
                                                    [价值] => 12413346907303
                                                )

                                            [5] => SimpleXMLElement 对象
                                                (
                                                    [名称] => ip
                                                    [值] => 10.10.10.2
                                                )

                                        )

                                )

                        )

```

那么我需要什么代码来遍历每个对象项？我想遍历它们中的每一个并像返回的 mySQL 查询一样处理它。例如，我可以查询 SimpleDB，然后通过 SimpleXML 循环，这样我就可以在页面上显示结果。

或者，你如何将整个 shebang 变成一个数组？

我是 SimpleXML 的新手，所以如果我的问题不够具体，我深表歉意。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-16T01:34:28.000

您可以在循环中使用`SimpleXML`对象（或其属性） 。`foreach`如果您想遍历所有“记录”，可以使用类似这样的方法来访问和显示数据：

```
//Loop through all the members of the Item array 
//(essentially your two database rows).
foreach($SimpleXML->body->QueryWithAttributesResult->Item as $Item){
    //Now you can access the 'row' data using $Item in this case 
    //two elements, a name and an array of key/value pairs
    echo $Item->Name;
    //Loop through the attribute array to access the 'fields'.
    foreach($Item->Attribute as $Attribute){
        //Each attribute has two elements, name and value.
        echo $Attribute->Name . ": " . $Attribute->Value;
    }
} 
```

请注意，$Item 将是一个 SimpleXML 对象，$Attribute 也是如此，因此它们需要作为对象而不是数组来引用。

虽然上面的示例代码循环遍历 SimpleXML 对象（$SimpleXML->body->QueryWithAttributesResult->Item）中的数组，但您也可以循环遍历 SimpleXML 对象（例如 $SimpleXML->body->QueryWithAttributesResult->Item[ 0])，这将为您提供每个对象的属性。

SimpleXML 对象的每个子元素都是一个 XML 实体。如果 XML 实体（标签）不是唯一的，那么该元素只是表示每个实体的 SimpleXML 对象数组。

如果您愿意，这应该从您的 SimpleXML 对象创建一个更常见的行/字段数组（或让您关闭）：

```
foreach($SimpleXML->body->QueryWithAttributesResult->Item as $Item){
    foreach($Item->Attribute as $Attribute){
        $rows[$Item->Name][$Attribute->Name] = $Attribute->Value;
    }
}

//Now you have an array that looks like:
$rows['message12413344443260']['active'] = 1;
$rows['message12413344443260']['user'] = 'john';
//etc. 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-02-10T12:28:58.623

```
get_object_vars($simpleXMLElement); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-04-05T14:25:10.503

PHP 5.2 修复的一个小补充。

```
$response_array = json_decode(json_encode($response),true); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-19T01:47:12.690

对于不包含 CDATA 部分的 XML 响应（如 Amazon's/Tarzan's），假设您有 PHP 5.2 或更高版本，您可以使用以下内容。

```
// Get a SimpleXML response back from Tarzan
$s3 = new AmazonS3();
$response = $s3->list_buckets();

// Convert SimpleXML to Array in PHP 5.2.
$response_array = json_decode(json_encode($response)); 
```

这将是下一个主要版本 Tarzan (CloudFusion 2.5) 中所有对象都可以使用的标准实用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-26T11:50:57.587

我发现的几乎所有示例都指的是您已经知道节点的特定示例。以下函数将在不知道节点名称或它们是否有子节点的情况下将 SimpleXMLElement 转换为数组。也可以与 CDATA 部分一起正常工作。

```
function parseXML(SimpleXMLElement $xml) : array
{
    $array = [];

    foreach(iterator_to_array($xml, TRUE) as $key => $value)
        $array[$key] = ($value->count() > 1) ? parseXML($value) : (string)$value;

    return $array;
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-08-28T19:59:38.767

这有效：

```
// $result is a Simple XML object

$result = convertSimpleXMLToArray($result);

function convertSimpleXMLToArray($xml)
{
    if(class_basename($xml) == 'SimpleXMLElement')
    {
        $xml = get_object_vars($xml);
        foreach($xml as $key => $value)
        {
            if(class_basename($value) == 'SimpleXMLElement') $xml[$key] = convertSimpleXMLToArray($value);
        }
    }

    return $xml;
} 
```

# c++ - 跨平台获取 CPU/内存利用率的方法

> ID：871423
> 
> 赞同：5
> 
> 时间：2009-05-16T01:22:14.037
> 
> 标签：c++, c, windows, linux, macos

寻找库或相当跨平台的方法来获取 C/C++ 中的 CPU 利用率、内存利用率等。除了 getrusage() 之外，我需要整个系统，而不是一个进程。我已经检查了周围，但没有找到太多。我在 Linux、Mac Os X 和 Windows 上确实需要它，但如果有针对 *nix 系统（包括 OS X）而不是 Windows 的解决方案，我可以解决这个问题。

如果一切都失败了，那么在上述任何平台上执行此操作的任何方法都会很高兴知道，我可以自己弄清楚如何打包它们！

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T03:26:36.407

[跨平台](http://www.cs.wustl.edu/~schmidt/ACE-versions-i.html) 框架[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)有一个用于[getrusage](http://www.dre.vanderbilt.edu/Doxygen/Micro/ace/a01964.html#ab633890ce8dc4935e5317974e852a08)的包装器，它应该适用于大多数（如果不是所有）受支持的平台。

# apache-flex - 跨许多 RSL 的 AS3 混淆

> ID：871424
> 
> 赞同：1
> 
> 时间：2009-05-16T01:23:02.177
> 
> 标签：apache-flex, flash, actionscript-3, obfuscation

我正在开发一个非常大的 Flash 项目，该项目在运行时库中广泛共享代码。我正在评估是否要混淆我们的代码，以及使用哪个混淆器，但我很难找到一个符合要求的混淆器。

- 许多 RSL、许多源代码树和项目。- 我们使用了一些动态属性，所以我希望能够很好地控制哪些符号被重命名。- 可集成到构建系统中

我查看了 Amayeta，但我不相信它具有我需要的细粒度控制。我查看了 irrfuscator，但它似乎很不成熟，并且似乎不能很好地扩展到大型项目。

还有其他建议吗？我知道混淆或加密不会提供完整的保护，我只是想让人们更难惹我们。

另一方面，如果不存在可接受的混淆器，我只会争辩说我们不需要这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T03:40:43.500

似乎由于您要使用许多共享库，因此您不必混淆变量、方法甚至某些字符串——因为其他 swf 需要能够访问它们。这使得它的用处大大降低，并且反编译器更容易产生可读的结果。

去除空格可能也不会做太多，因为反编译器也都从头开始格式化代码。

缩小它会稍微缩小编译大小，加密字符串可能会有所帮助，但前提是它们不会妨碍 SWF (RSL) 互操作性。

我要问的底线问题是，那些拼命反编译代码的人不会拼命“解开”本质上是组合函数和短变量名称的东西吗？

# php - 在 PHP 中使用 cURL 的 RAW POST

> ID：871431
> 
> 赞同：147
> 
> 时间：2009-05-16T01:28:27.283
> 
> 标签：php, post, curl, put

如何使用 cURL 在 PHP 中进行 RAW POST？

未经任何编码的原始帖子，我的数据存储在一个字符串中。数据格式应如下所示：

```
... usual HTTP header ...
Content-Length: 1039
Content-Type: text/plain

89c5fdataasdhf kajshfd akjshfksa hfdkjsa falkjshfsa
ajshd fkjsahfd lkjsahflksahfdlkashfhsadkjfsalhfd
ajshdfhsafiahfiuwhflsf this is just data from a string
more data kjahfdhsakjfhsalkjfdhalksfd 
```

一种选择是手动编写要发送的整个 HTTP 标头，但这似乎不太理想。

无论如何，我可以只将选项传递给 curl_setopt() 说使用 POST、使用 text/plain 并从 a 发送原始数据`$variable`吗？

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2009-05-16T01:36:41.757

我刚刚找到了解决方案，有点回答我自己的问题，以防其他人偶然发现它。

```
$ch = curl_init();

curl_setopt($ch, CURLOPT_URL,            "http://url/url/url" );
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1 );
curl_setopt($ch, CURLOPT_POST,           1 );
curl_setopt($ch, CURLOPT_POSTFIELDS,     "body goes here" ); 
curl_setopt($ch, CURLOPT_HTTPHEADER,     array('Content-Type: text/plain')); 

$result=curl_exec ($ch); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-05-23T20:50:29.467

使用 Guzzle 库实现：

```
use GuzzleHttp\Client;
use GuzzleHttp\RequestOptions;

$httpClient = new Client();

$response = $httpClient->post(
    'https://postman-echo.com/post',
    [
        RequestOptions::BODY => 'POST raw request content',
        RequestOptions::HEADERS => [
            'Content-Type' => 'application/x-www-form-urlencoded',
        ],
    ]
);

echo(
    $response->getBody()->getContents()
); 
```

PHP CURL 扩展：

```
$curlHandler = curl_init();

curl_setopt_array($curlHandler, [
    CURLOPT_URL => 'https://postman-echo.com/post',
    CURLOPT_RETURNTRANSFER => true,

    /**
     * Specify POST method
     */
    CURLOPT_POST => true,

    /**
     * Specify request content
     */
    CURLOPT_POSTFIELDS => 'POST raw request content',
]);

$response = curl_exec($curlHandler);

curl_close($curlHandler);

echo($response); 
```

[源代码](https://github.com/andriichuk/php-curl-cookbook#post-raw-request)

# java - Java 实用程序类与服务

> ID：871434
> 
> 赞同：43
> 
> 时间：2009-05-16T01:29:48.323
> 
> 标签：java, static, service, utility

实用程序类（具有静态方法的类）和服务类（具有提供“服务”的公共方法的类）之间的 Java 有什么区别。例如，有人可能会争辩说加密对象（提供加密、解密、散列或获取盐值的方法）是服务提供者，但许多人将此功能分组到具有静态方法的实用程序类中，例如 CryptoUtil.encrypt(.. .)。我试图弄清楚哪种方式遵循更好的“设计”。想法？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-16T01:57:44.013

使用不同的服务对象可以获得不同的行为。实用程序类中的静态方法不能被换出。这对于测试、更改实现和其他目的非常有用。

例如，你提到了`CryptoUtil`一个`encrypt`方法。拥有可以支持不同加密策略、不同消息接收者等的不同对象将非常有用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-16T01:36:20.897

不同之处在于服务类可能具有状态。我所说的状态是指会话状态。考虑一个名义排序系统。

```
interface OrderSystem {
  void login(String username, String password);
  List<Item> search(String criteria);
  void order(Item item);
  void order(Item item, int quantity);
  void update(Item item, int quantity);
  void remove(Item item);
  void checkout();
  Map<Item, Integer> getCart();
  void logout();
} 
```

这样的事情可以用有状态的会话 bean 来完成（作为一个例子），尽管在这种情况下，身份验证可能会涵盖更传统的 EJB 机制。

这里的要点是存在会话状态，即一次调用的结果会影响后续调用。您可以将静态方法视为一组在本地执行的简单无状态服务。

服务具有更广泛的含义，包括但不限于：

*   有状态的；
*   偏僻的; 和
*   依赖于实现（即通过接口）。

我认为的最佳实践是简单地使用静态方法作为便利方法（特别是考虑到 Java 缺乏扩展方法）。服务比这丰富得多。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-17T12:37:30.787

您不能覆盖静态方法，如果您想以两种不同的方式实现服务并在它们之间切换，这可能是一个大问题。出于这个原因，我会将静态实用程序类的使用限制为“从不”（对于“从不”的足够长的值 :)）需要以多种方式完成的简单事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T01:41:08.470

我认为没有硬性规定。

对于需要很少参数的功能，我通常使用静态方法，并且可以在单个方法调用中完成。例子：

*   计算字符串的哈希值
*   将日期转换为标准表示

如果一个功能需要很多参数，并且如果要创建多个相关结果，那么在其构造函数中拥有一个可以接受共享参数的类，以及执行实际操作的多个方法会更实用。

典型例子：一个数据库连接，你先连接，然后用来做查询，然后用来获取结果……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T03:13:22.740

我之前在某个地方回答过这个问题，但我发现改变服务的行为非常容易——将其重构为多个服务——如果使用静态类，则需要进行相当大的重构。

如果这是唯一的区别（我相信是），那么使用静态类就没有任何意义。

任何时候有人说“永远不会超过 1 个”，为其中的 n 个编码。

# c++ - OS X 上的奇数/错误 sem_getvalue 信号量行为

> ID：871435
> 
> 赞同：3
> 
> 时间：2009-05-16T01:29:57.030
> 
> 标签：c++, macos, posix, mutex, semaphore

我有一些非常基本的信号量代码，在 Linux 上运行良好，但我一辈子都无法让它在 OS X 上正常运行......它返回最奇怪的结果......

```
#include <iostream>
#include <fcntl.h>
#include <stdio.h>
#include <semaphore.h>

int main()
{
    sem_t* test;
    test = sem_open("test", O_CREAT, 0, 1);

    int value;
    sem_getvalue(test, &value);
    printf("Semaphore initialized to %d\n", value);
} 
```

在 OS X 上使用 g++ 编译它会返回以下输出：

```
iQudsi:Desktop mqudsi$ g++ test.cpp
iQudsi:Desktop mqudsi$ ./a.out 
Semaphore initialized to -1881139893 
```

而在 Ubuntu 上，我得到了明显更理智的结果：

```
iQudsi: Desktop mqudsi$ g++ test.cpp -lrt
iQudsi:Desktop mqudsi$ ./a.out 
Semaphore initialized to 1 
```

我已经连续 3 个小时了，无法弄清楚为什么 OS X 会返回如此奇怪的结果......

我尝试使用文件路径作为信号量名称，但没有任何区别。

我会很感激我能得到的任何帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T02:02:06.453

你在测试错误吗？尝试：

```
#include <iostream>
#include <fcntl.h>
#include <stdio.h>
#include <semaphore.h>

int main()
{
    sem_t* test;
    test = sem_open("test", O_CREAT, 0, 1);
    if (test == SEM_FAILED) {
        perror("sem_open");
        return 1;
    }

    int value;
    if (sem_getvalue(test, &value)) {
        perror("sem_getvalue");
        return 1;
    }
    printf("Semaphore initialized to %d\n", value);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T05:47:33.617

```
$ g++ sem-testing.cc -Wall
$ ./a.out 
sem_getvalue: Function not implemented
$ man sem_getvalue
No manual entry for sem_getvalue 
```

You are using a function that is not currently implemented in Mac OS X, and the integer you are printing out contains the default data that the integer was initialised with which was probably random data that was still in memory. Had you zero'd it out, by setting it with `int value = 0;` you might have caught this mistake sooner.

This is the code I used (thanks to [bdonlan](https://stackoverflow.com/questions/871435/odd-incorrect-semaphore-behavior-on-os-x/871501#871501)):

```
#include <iostream>
#include <fcntl.h>
#include <stdio.h>
#include <semaphore.h>

int main()
{
    sem_t* test;
    test = sem_open("test", O_CREAT, 0, 1);
    if (test == SEM_FAILED) {
        perror("sem_open");
        return 1;
    }

    int value;
    if (sem_getvalue(test, &value)) {
        perror("sem_getvalue");
        return 1;
    }
    printf("Semaphore initialized to %d\n", value);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T02:21:40.213

好吧，也许 sem_open() 失败了——你没有测试。

或者，也许 OSX 不默认支持共享 posix sem - 如果 /dev/shm 未安装，通常系统将不支持 sem_open()。

您可能想要使用 SysV 信号量。

此处询问了有关 Slackware 的类似问题：[how-do-i-stop-semopen-failing-with-enosys](https://stackoverflow.com/questions/270113/how-do-i-stop-semopen-failing-with-enosys)

然而，进一步的搜索显示 OSX 命名的信号机是建立在马赫信号量之上的，当你完成时你可能需要 sem_unlink() （不仅仅是 sem_close()，或者可能相反），你应该小心权限 -我建议从 0777 或 0700 开始，而不是 0。参见[Darwin 中的 posiz semaphores](http://forums.macnn.com/79/developer-center/237556/posix-semaphores-in-darwin/)

# iphone - Three20 TTTableViewController 和一个 TTThumbsTableViewCell

> ID：871440
> 
> 赞同：1
> 
> 时间：2009-05-16T01:35:33.240
> 
> 标签：iphone, cocoa-touch

看来您必须使用 TTThumbsViewController 来完成此操作。但是，在示例代码中，TTThumbsViewController 仅用于管理拇指的滚动视图。您如何将其配置为显示单元格？

_________原始问题_________

有没有人使用 Three20 源并制作了一个表格视图（不是字段）？

我试图弄清楚如何将 TTThumbTableViewCell 插入表中，并且没有一个示例甚至解决了 tableviewcell 类（只是 tablefields）。

如果你知道如何设置一个表格来使用这些单元格类，你能发布你是如何完成它的吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T11:46:07.827

我自己并没有真正使用过 Three20，但快速查看了源代码。

似乎 Three20 在通用 TTTableViewDataSource 中抽象了表格视图单元格的创建。它通过 tableView:cellClassForObject: 查询要创建的表格视图单元格的类。TTThumbsViewController.m 中的[TTThumbsDataSource](http://github.com/joehewitt/three20/blob/3274e6d0515bbbcbdbabe8ef2a411ae1efded092/src/TTThumbsViewController.m)然后覆盖它以返回 TTPhoto 对象的 TTThumbTableViewCell 类。

所以，如果你不使用 TTThumbsViewController，你应该使用 TTThumbsDataSource 作为你的表视图的数据源或者创建你自己的类似类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T00:47:33.200

我在设置 Three20 时弄错了。TTThumbsViewController 已经是 TTThumbTableViewCells 的表格视图。您只是看不到单元格之间的线条。

您可以通过继承 TTThumbTableViewCells 来更改单元格的行为方式。

# javascript - Javascript 框架的自定义事件日志记录

> ID：871442
> 
> 赞同：3
> 
> 时间：2009-05-16T01:35:45.720
> 
> 标签：javascript, event-handling, prototypejs, dom-events, custom-eventlog

想象一下，我有一个 Web 应用程序，其中包含使用您最喜欢的 Javascript 库编写的漂亮组件。我大量使用自定义事件来减少这些组件之间的依赖关系，因此您可以轻松地将它们放置在多个上下文中，在页面上重复它们，和/或按照我认为合适的方式嵌套它们。

这是一张可爱的图片，但调试可能会很痛苦，因为我还没有找到一种方法来记录我的自定义事件。理想情况下，我希望能够在我选择的框架中打开日志记录（我目前使用 Prototype），然后在 DOM 中的任何一个或多个点获取触发和观察到的事件的运行日志。

我一直在与其他 F2E 讨论这个问题，并尝试了一些方法：

*   [Visual Event](http://www.sprymedia.co.uk/article/Visual+Event)是一个小书签，可以很好地可视化事件绑定的位置，但不提供运行时日志。
*   [Antenna](http://crossbrowser.blogspot.com/2009/05/prototypejs-decoupling-solution-antenna.html)就是这样一个日志，但是看起来有点bug，需要修改原型库本身，感觉就像是hack。

如何获得我想要的自定义日志记录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T03:38:03.697

您可能使用了一些在 Object.prototype 中定义的 X.fireEvent 方法（可能不熟悉您的固件）。我将研究用您的版本覆盖这一方法的方法，该版本将执行日志内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-17T13:39:42.933

如果你使用 Prototype，我[会](http://www.prototypejs.org/api/function/wrap)在`document.fire`.

# c++ - 是否可以在 C++ 中创建“朋友类”？

> ID：871444
> 
> 赞同：1
> 
> 时间：2009-05-16T01:36:31.180
> 
> 标签：c++, class

我知道可以在 C++ 中创建一个友元函数：

```
class box
{
friend void add(int num);
private:
int contents;
};

void add(int num)
{
box::contents = num;
return;
} 
```

但是有没有办法创建朋友类？

注意：我知道这段代码可能有很多错误，我不使用友元函数，而且对这门语言还是很陌生；如果有的话，请告诉我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-16T01:39:48.253

是的 - 在`class Box`, do的声明中

```
friend class SomeOtherClass; 
```

的所有成员函数`SomeOtherClass`将能够访问`contents`任何`Box`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T01:56:32.690

顺便说一句，设计准则是，如果一个类足够接近可以被声明为友元，那么它就足够接近可以在同一个头文件中声明为嵌套类，例如：

```
class Box
{
  class SomeOtherClass
  {
    //some implementation that might want to access private members of box
  };
  friend class SomeOtherClass;
private:
  int contents;
}; 
```

如果您不想在同一个头文件中将另一个类声明为嵌套类，那么也许您不应该（尽管您可以）将其声明为朋友。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T02:17:34.700

在您的代码中，您当前正在使用 box 成员 'contents' 作为 add 函数中的静态成员（ box::contents = num; ）

您应该将内容声明为静态，如下所示：（您还必须初始化它......）

```
class box
{
    friend void add(int num);
    private:
      static int contents;
};

int box::contents;

void add(int num)
{
    box::contents = num;
    return;
} 
```

或者，更改您的 add 函数以接受一个框对象和一个 int：

```
class box
{
    friend void add(box *b, int num);
    private:
      int contents;
};

void add(box *b, int num)
{
    b->contents = num;
    return;
} 
```

# python - 使用 os.pipe 和 os.fork() 问题的 Python 程序

> ID：871447
> 
> 赞同：13
> 
> 时间：2009-05-16T01:36:53.283
> 
> 标签：python, pipe, fork

我最近需要编写一个脚本来执行**os.fork()**以拆分为两个进程。**子进程成为服务器进程并使用使用os.pipe()**创建的管道将数据传递回父进程。像往常一样，孩子关闭`'r'`管道的末端，父母关闭管道的`'w'`末端。**我使用os.fdopen**将 pipe() 的返回转换为文件对象。

我遇到的问题是：进程成功分叉，孩子成为服务器。一切正常，孩子尽职尽责地将数据写入`'w'`管道的开放端。不幸的是，管道的父端做了两件奇怪的事情：
A）它阻塞了管道末端的`read()`操作`'r'`。其次，除非末端完全关闭
，否则它无法读取放在管道上的任何数据。`'w'`

我立即认为缓冲是问题并添加了**pipe.flush()**调用，但这些没有帮助。

谁能解释为什么在写入端完全关闭之前数据不会出现？是否有使`read()`呼叫非阻塞的策略？

这是我第一个分叉或使用管道的 Python 程序，如果我犯了一个简单的错误，请原谅我。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-16T15:30:19.490

您是在使用 read() 时未指定大小，还是将管道视为迭代器 ( `for line in f`)？如果是这样，那可能是您的问题的根源- read() 被定义为在返回之前读取到文件末尾，而不仅仅是读取可读取的内容。这意味着它将阻塞，直到孩子调用 close()。

在链接到的示例代码中，这是可以的 - 父级以阻塞方式行事，并且仅将子级用于隔离目的。如果您想继续，请使用您发布的代码中的非阻塞 IO（但要准备处理半完整的数据），或者分块读取（例如 r.read(size) 或 r.readline() ) 这只会阻塞直到读取了特定的大小/行。（你仍然需要在孩子身上调用flush）

看起来将管道视为迭代器也在使用一些进一步的缓冲区，因为`for line in r:`如果您需要立即使用每一行，“”可能不会给您想要的东西。可以禁用此功能，但仅在 fdopen 中为缓冲区大小指定 0 似乎还不够。

下面是一些应该工作的示例代码：

```
import os, sys, time

r,w=os.pipe()
r,w=os.fdopen(r,'r',0), os.fdopen(w,'w',0)

pid = os.fork()
if pid:          # Parent
    w.close()
    while 1:
        data=r.readline()
        if not data: break
        print "parent read: " + data.strip()
else:           # Child
    r.close()
    for i in range(10):
        print >>w, "line %s" % i
        w.flush()
        time.sleep(1) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T02:14:38.577

使用

`fcntl.fcntl(readPipe, fcntl.F_SETFL, os.O_NONBLOCK)`

在调用 read() 之前解决了这两个问题。read() 调用不再阻塞，数据仅在写入端的 flush() 之后出现。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-16T02:56:06.683

我看到你已经解决了阻塞 i/o 和缓冲的问题。

如果您决定尝试不同的方法，请注意： subprocess 是 fork/exec 习语的等价物/替代品。看起来这不是您正在做的事情：您只有一个 fork（不是 exec）并在两个进程之间交换数据——在这种情况下，[`multiprocessing`](http://docs.python.org/library/multiprocessing.html)模块（在 Python 2.6+ 中）会更合适。

* * *

## 回答 #4

> 赞同：-10
> 
> 时间：2009-05-16T02:05:01.860

Python 应用程序中 fork 的“父”与“子”部分是愚蠢的。这是 16 位 unix 时代的遗产。当 fork/exec 和 exec 是充分利用一个很小的处理器的重要事情时，这是一种矫揉造作。

将您的 Python 代码分成两个独立的部分：父级和子级。

父部件应该使用[子进程](http://docs.python.org/library/subprocess.html)来运行子部件。

一个 fork 和 exec 可能会发生在那里的某个地方——但你不需要关心。

# algorithm - 有多少种方法可以判断一个数是否为偶数，哪一种最快最清晰？

> ID：871448
> 
> 赞同：1
> 
> 时间：2009-05-16T01:36:57.277
> 
> 标签：algorithm, math

给定任何数字，确定它是偶数的最佳方法是什么？你能想到多少种方法，最快最清晰的方法是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-16T01:45:07.663

```
bool isEven = ((number & 0x01) == 0) 
```

这个问题说“任何数字”，所以可以丢弃浮点数或以另一种方式处理它们，也许首先将它们缩放到一个整数值 - 注意溢出 - 即将 2.1 更改为 21（乘以 10 并转换为int) 然后测试。然而，可以合理地假设提出问题的人提到“任何数字”实际上是指整数值。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-16T01:42:01.353

```
bool isEven = number % 2 == 0; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-17T06:30:15.903

答案取决于申请的职位。如果您正在申请**企业架构师**职位，那么以下可能是合适的：

首先，您应该创建一个适当**的面向服务的体系结构**，因为肯定奇偶服务不会是您企业中唯一可重用的组件。**SOA**由服务、接口和服务消费者组成。服务是可以通过网络调用的功能。它公开了一个接口契约，并且通常在目录服务中注册。

然后，您可以创建一个**简单对象访问协议**(SOAP) **HTTP** Web 服务来公开您的服务。

接下来，您应该阻止客户端直接调用您的 Web 服务。如果你允许这样做，那么你最终会得到一团糟的点对点通信，这很难维护。客户端应通过**企业服务总线**(ESB) 访问 Web 服务。

除了提供标准的可插入架构外，总线上还可以出现 **服务编排等附加组件。**

通常，应避免编写定制的偶数/奇数服务。您应该编写一份**提案请求**(RFP)，并让几家供应商向您展示他们的偶数/奇数服务。供应商的产品应该能够插入您的**ESB**，并且还为您提供**服务级别协议**(SLA)。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-16T02:07:42.070

```
isEven(n) = ((-1) ^ n) == 1 
```

其中 ^ 是您的语言的求幂/pow 函数。

我没有说它快速或清晰，但它具有新奇价值。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-16T01:52:18.927

这在 ruby​​ 中更容易：

```
isEven = number.even? 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-16T01:59:51.950

如果您的类型“a”是整数类型，那么我们可以定义，

```
even :: Integral a => a -> Bool
even n =  n `rem` 2 == 0 
```

根据 Haskell Prelude。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-16T02:39:50.247

对于浮点数，当然在合理范围内。

```
modf(n/2.0, &intpart, &fracpart)
return fracpart == 0.0 
```

使用其他一些随机数学函数：

```
return gcd(n,2) == 2

return lcm(n,2) == n

return cos(n*pi) == 1.0 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-16T01:48:03.897

是的..最快的方法是检查1位，因为它为所有奇数设置而为所有偶数取消设置..

按位与非常快。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-11-16T18:02:18.647

如果 int 是 32 位，那么你可以这样做：

```
bool is_even = ((number << 31) >> 31) == 0; 
```

通过使用位移，您会将最右边的位移动到最左边的位置，然后再返回，从而使所有其他位为 0。然后你剩下的数字是 0 或 1。这个方法有点类似于“数字和 1”方法，你再次将除第一个之外的所有位设为 0。

与此类似的另一种方法是：

```
bool is_even = (number << 31) == 0; 
```

或者

```
bool is_odd = (number << 31) < 0; 
```

如果数字是偶数（最右边的位为 0），则将其移动 31 个位置将使整数为 0。如果该位为 1，即数字为奇数，则结果数将为负数（每个整数与最左边的位 1 为负数，除非该数字是无符号类型，否则它将不起作用）。要修复签名/未签名的错误，您可以测试：

```
bool is_odd = (number << 31) != 0; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-26T05:09:14.090

类似于 DeadHead 的评论，但更高效：

```
#include <limits.h>

bool isEven(int num)
{
    bool arr[UINT_MAX] = { 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1,
                           0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
                           // ...and so on
    };
    return arr[num];
} 
```

与数组索引一样快，它可能比按位计算快也可能不快（很难测试，因为我不想编写此函数的完整版本）。对于它的价值，上面的那个函数只填充了足够的内容来查找最多 442 的偶数，但必须转到 4294967295 才能在我的系统上工作。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-05-26T04:44:45.070

实际上我认为 (n % 2 == 0) 就足够了，这很容易理解，大多数编译器也会将其转换为位操作。

我用 gcc -O2 标志编译了这个程序：

```
#include <stdio.h>

int main()
{
    volatile int x = 310;
    printf("%d\n", x % 2);
    return 0;
} 
```

生成的汇编代码是

```
main:
    pushl   %ebp
    movl    %esp, %ebp
    andl    $-16, %esp
    subl    $32, %esp
    movl    $310, 28(%esp)
    movl    28(%esp), %eax
    movl    $.LC0, (%esp)
    movl    %eax, %edx
    shrl    $31, %edx
    addl    %edx, %eax
    andl    $1, %eax
    subl    %edx, %eax
    movl    %eax, 4(%esp)
    call    printf
    xorl    %eax, %eax
    leave
    ret 
```

我们可以看到 %2 操作已经转换为 andl 指令。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-17T05:46:03.963

a2。

1.  很明显
2.  在每个体面的编译器上它都很快。

每个喊“但是！但是！如果编译器不优化它怎么办”的人都应该找到正常的编译器，闭嘴并阅读有关过早优化的内容，再读一遍，再读一遍。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-16T05:25:34.263

保留有限的堆栈空间。;) （这可能是尾声的候选人吗？）

```
public static bool IsEven(int num) {
    if (num < 0)
        return !IsEven(-num - 1);

    if (num == 0)
        return true;

    return IsEven(-num);
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-16T03:57:27.330

If it's low level check if the last (LSB) bit is 0 or 1 :)

0 = Even
1 = Odd

Otherwise, +1 @sipwiz: "bool isEven = number % 2 == 0;"

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-16T04:36:15.240

Assumming that you are dealing with an integer, the following will work:

if ((testnumber & -2)==testnumber) then testnumber is even.

basically, -2 in hex will be FFFE (for 16 bits) if the number is even, then anding with with -2 will leave it unchanged. ** Tom **

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-17T06:27:37.997

延续“有多少种方式……”的精神：

```
function is_even (n positive_integer) returns boolean is
  i := 0
  j := 0
  loop
    if n = i then
       return (j = 0)
    end if;
    i := i + 1
    j := 1 - j
  end loop
end 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-06-17T05:54:00.220

递归！

```
function is_even (n number) returns boolean is
  if n = 0 then
     return true
  elsif n = 1 then
     return false
  elsif n < 0 then
     return is_even(n * -1)
  else
     return is_even(n - 2)
  end if
end 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-16T01:43:23.160

您可以使用整数除法并将其除以二并检查余数，或者使用模运算符并将其除以二并检查余数。“最快”的方式取决于语言、编译器和其他因素，但我怀疑是否有许多平台存在显着差异。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-09-21T13:05:33.653

作为对 Chris Lutz 的回应，数组查找比 BITWISE_AND 操作慢得多。在数组查找中，您正在执行内存查找，由于内存延迟，它总是比按位运算慢。当然，这甚至不考虑将所有可能的 int 值放入具有 O(2^n) 内存复杂度的数组中的问题，其中 n 是您的总线大小 (8,16,32,64)。

奇/偶属性仅以整数定义。所以任何处理浮点数的答案都是无效的。这个问题的抽象表示是 Int -> bool （使用 Haskell 表示法）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-09-06T13:59:19.780

另一个无用的新奇解决方案：

```
if (2 * (n/2) == n)
    return true;
else
    return false; 
```

只有整数，这取决于语言如何处理整数除法。

n/2 == n/2 如果它是偶数或 n/2-.5 如果它是奇数。所以 2*(n/2) == n 如果它是偶数或 n - 1 如果它是奇数。

# javascript - Webkit JavaScript 参考

> ID：871460
> 
> 赞同：32
> 
> 时间：2009-05-16T01:41:44.287
> 
> 标签：javascript, webkit

对于 Gecko，有 Mozilla 开发者网络

对于 IE，有 MSDN。

对于 webkit，有...Apple Developer Connection？

ADC 上有[一些](https://developer.apple.com/library/safari/#documentation/AppleApplications/Conceptual/SafariJSProgTopics/WebKitJavaScript.html)与 JavaScript 相关的文档，但没有 MDN 或 MSDN 那样全面。没有参考。没有办法为 webkit 查找数组或字符串的方法，或者有什么办法吗？那么，我们是否只是假设它与 Gecko 相同？IE？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-21T22:15:29.053

WebKit DOM 参考怎么样？

[http://developer.apple.com/safari/library/documentation/AppleApplications/Reference/WebKitDOMRef/index.html](http://developer.apple.com/safari/library/documentation/AppleApplications/Reference/WebKitDOMRef/index.html)

**更新**

感谢您的评论 - 是的，现在重定向。

也许正如其他人所说，其他浏览器的参考之一将是一个很好的起点 - 然后对于 Safari 自己的 DOM 扩展/添加，有“Safari DOM 添加参考”：

[https://developer.apple.com/documentation/webkitjs](https://developer.apple.com/documentation/webkitjs)

否则，看起来就像是在 Safari 开发人员库中令人困惑的一组文档中找到自己的出路：

[http://developer.apple.com/library/safari/navigation/](http://developer.apple.com/library/safari/navigation/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T02:17:33.530

我使用[quirksmode.org](http://quirksmode.org/)来满足我所有的 JavaScript 需求。MDC 是我的参考资源、基本操作方法和 quirksmode，向我展示了事实上，我什至不能在 IE 中使用它。无论如何，WebKit 和 Gecko 在 JavaScript 方面似乎表现得非常相似。

但除了您列出的内容之外，我从未遇到过任何特定于 WebKit 的内容。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-16T02:27:50.120

我不知道像 MDN 或 MSDN 这样的 WebKit JavaScript 参考。当我需要查找某些内容时，我会使用 Mozilla 开发者网络，因为 Gecko 和 WebKit 似乎正朝着大致相同的方向前进。

史蒂夫

# ruby - 我在 Vim 中编辑 Ruby 文件时出现此窗口。它是什么？

> ID：871465
> 
> 赞同：2
> 
> 时间：2009-05-16T01:46:13.870
> 
> 标签：ruby, vim, text-editor

当我在 VIM 中编辑 Ruby 文件时，我通常会突然打开这个新窗口。这很烦人，因为在处理过程中我无法输入任何内容。它通常是任意发生的。这里有人知道哪个插件可以做到这一点吗？或者这是某种VIM的过程？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-10T18:57:49.503

我的工作桌面上也有同样的问题，但我的家用机器上没有。设置几乎相同。

在寻找可能的原因时，我注意到当我将光标放在 Ruby 符号上时`File`，Vim 会弹出 File 类的简短描述。在比较了我能找到的所有各种 vim 脚本和`ri`相关文件之后，我最终确定了唯一可行的解​​决方案......

打开`$HOME/_vimrc`并添加以下行：

```
autocmd FileType ruby,eruby set noballooneval 
```

`$VIMRUNTIME/ftplugin/ruby.vim`之前，[我](https://stackoverflow.com/users/23070/brian-carper)注释掉了`:set noballooneval`. 我添加了这一`autocmd`行，因此它只使用 Ruby 文件执行。

如果有人想出真正的解决方案，请与我联系。:(

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T01:59:26.880

当您`K`在正常模式下点击时会发生这种情况。

```
     K 运行一个程序来查找下面的关键字
          光标。该程序的名称与
          'keywordprg' (kp) 选项（默认为 "man"）。这
          关键字由字母、数字和
          'iskeyword' 中的字符。or 下的关键字
          使用光标右侧。也可以这样做
          使用命令 >
            :!{程序} {关键字}
          有一个在工具中使用的程序示例
          Vim 目录。它被称为'ref'并执行
          简单的拼写检查。
          特别案例：
          - 如果 'keywordprg' 为空，":help" 命令为
            用过的。包含更多字符是个好主意
            然后在'iskeyword'中，能够找到更多帮助。
          - 当 'keywordprg' 等于 "man" 时，前一个计数
            在“man”命令之后和之前插入“K”
            关键字。例如，使用“2K”，而
            光标在“mkdir”上，结果：>
            !man 2 mkdir
          - 当 'keywordprg' 等于 "man -s" 时，计数
            在“-s”之后插入“K”之前。如果有
            没有计数，“-s”被删除。
          {Vi 无此功能}

```

如果您注意到，它正在`ri`打开的窗口中运行，这是 ruby​​ 文档应用程序。在 Unixy 环境中，帮助程序通常内联运行，只是将 vim 输出替换一分钟。

这是使用 gvim 还是命令行 vim？

在任何一种情况下，您都可以尝试使用`'keywordprg'`来修复弹出窗口

或者，如果您无法训练自己不键入它，您可以使用`:nnoremap K k`来更改键入的内容`K`（在这种情况下，只需将其视为正常`k`命令并上升一行）。

# c++ - Is it possible to declare a class without implementing it? (C++)

> ID：871475
> 
> 赞同：10
> 
> 时间：2009-05-16T01:50:35.577
> 
> 标签：c++, class, declaration, definition, forward-declaration

I know the questions seems ambiguous, but I couldn't think of any other way to put it, but, Is it possible to do something like this:

```
#include<iostream>

class wsx;

class wsx
{
public:
wsx();
}

wsx::wsx()
{
std::cout<<"WSX";
} 
```

?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-16T01:55:20.773

Yes, that is possible. The following just declares `wsx`

```
class wsx; 
```

That kind of declaration is called a forward declaration, because it's needed when two classes refer to each other:

```
class A;
class B { A * a; };

class A { B * b; }; 
```

One of them needs to be forward declared then.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T01:55:44.550

In your example,

```
class wsx; // this is a class declaration

class wsx  // this is a class definition
{
public:
wsx();
} 
```

So yes, by using `class wsx;` it is possible to declare a class without defining it. A class declaration lets you declare pointers and references to that class, but not instances of the class. The compiler needs the class definition so it knows how much memory to allocate for an instance of the class.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T01:56:17.637

This is the definition of the class

```
class wsx
{
public:
wsx();
} 
```

This is the definition of the constructor

```
wsx::wsx()
{
std::cout<<"WSX";
} 
```

THis is a forward declaration that says the class WILL be defined somewhere

```
class wsx; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T02:32:15.257

Yes. But it is **not** possible to define a class without declaring it.

Because: *Every definition is also a declaration.*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T01:53:44.727

You did define the class. It has no data members, but that's not necessary.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-16T01:52:51.297

I'm not sure what you mean. The code you pasted looks correct.

# uml - 在 UML 中，您是否必须显示抽象方法的具体实现？

> ID：871476
> 
> 赞同：5
> 
> 时间：2009-05-16T01:51:00.317
> 
> 标签：uml, abstract, concrete

我正在绘制一些 UML，其中具体类继承自定义纯虚拟方法的抽象类。是否也需要在具体类中显示此方法？它是通过从抽象类继承来暗示的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-16T02:01:04.520

不，你不需要。事实上，一般来说，不要在 UML 中添加任何内容*，*除非你（上帝保佑）试图从中生成代码。

我所知道的关于 UML 的最佳指南是Martin Fowler 的[UML Distilled](https://rads.stackoverflow.com/amzn/click/com/0321193687)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T02:01:45.813

UML 的有趣之处在于它有一个非常松散和多变的定义。大多数被称为 UML 的东西实际上并没有比框图多多少。在任何 UML 实现中都存在很多歧义。

我会说，如果您是为演示文稿或架构图执行此操作，您可以处理很多可能与“单词”相关的歧义。如果您将使用某个应用程序从中生成代码，则应查看该特定应用程序的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T10:48:13.317

这是隐含的，事实上，许多 CASE 工具会在单击类查看其属性时将继承的方法显示为子类方法列表的一部分（有些 CASE 工具甚至可以选择显示继承的图中的方法）

# c++ - MSVC++ 的属性选项卡上的 Items 是什么意思？

> ID：871504
> 
> 赞同：1
> 
> 时间：2009-05-16T02:05:09.923
> 
> 标签：c++, visual-c++, class, sealed

我在玩我的 MSVC++ 编译器，我的点类的属性选项卡说：

```
IsAbstract  - false
IsInjected  - false
IsManaged   - false
IsSealed    - false
IsTemplate  - false
IsValue     - false 
```

这些是什么意思，为什么除了 IsAbstract 和 IsSealed 之外所有这些都是灰色的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T02:07:33.337

密封类是您无法继承的。我假设 IsSealed - false 意味着您可以继承它。

# javascript - 为什么有“while(1);” 在 XmlHttpRequest 响应中？

> ID：871505
> 
> 赞同：46
> 
> 时间：2009-05-16T02:05:41.640
> 
> 标签：javascript, ajax, json, xmlhttprequest

> **可能重复：**
> [为什么 Google 在前面加上 while(1)；到他们的 JSON 响应？](https://stackoverflow.com/questions/2669690/why-does-google-prepend-while1-to-their-json-responses)

我正在用谷歌日历玩萤火虫。我碰巧发现一些 XHR 请求的响应如下：

```
while(1);[['us','bW9yZ2FuLmNoZW5nbW9AZ21haWwuY29t 20090320/20090904 63378122163']] 
```

它看起来像一个带有前缀死循环 javascript 语句的 JSON。

我不确定为什么 Google 日历会有这样的 XHR 响应。是否有任何已知的 AJAX 实践？

# .htaccess - 301 基于 .htaccess 中的 GET 变量重定向 URL

> ID：871511
> 
> 赞同：3
> 
> 时间：2009-05-16T02:11:11.673
> 
> 标签：.htaccess, mod-rewrite, query-string, http-status-code-301

我有一些乱七八糟的旧网址，例如...

[http://www.example.com/bunch.of/unneeded/crap?opendocument&part=1](http://www.example.com/bunch.of/unneeded/crap?opendocument&part=1)

[http://www.example.com/bunch.of/unneeded/crap?opendocument&part=2](http://www.example.com/bunch.of/unneeded/crap?opendocument&part=2)

...我想重定向到更新，更清洁的形式...

[http://www.example.com/page.php/welcome](http://www.example.com/page.php/welcome)

[http://www.example.com/page.php/prices](http://www.example.com/page.php/prices)

我知道我可以通过简单的重定向将一个页面重定向到另一个页面，即

重定向 301 /bunch.of/unneeded/crap [http://www.example.com/page.php](http://www.example.com/page.php)

但是源页面没有改变，只是 GET vars。我不知道如何将重定向基于这些 GET 变量的值。有人可以帮忙吗！？我对旧的正则表达式相当方便，所以如果必须的话，我可以使用 mod-rewrite，但我不清楚重写 GET vars 的语法，我宁愿避免性能下降并使用更清洁的重定向指令。有办法吗？如果没有，任何人都可以告诉我正确的mod-rewrite语法吗？

干杯，

罗杰。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T08:27:01.973

由于 URL 查询中的参数可能具有任意顺序，因此您需要对每个要检查的参数或每个可能的排列使用一个[`RewriteCond`指令。](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)

`RewriteCond`以下是每个参数的指令示例：

```
RewriteCond %{QUERY_STRING} ^([^&]&)*opendocument(&|$)
RewriteCond %{QUERY_STRING} ^([^&]&)*part=1(&|$)
RewriteRule ^bunch\.of/unneeded/crap$ /page.php/welcome? [L,R=301]

RewriteCond %{QUERY_STRING} ^([^&]&)*opendocument(&|$)
RewriteCond %{QUERY_STRING} ^([^&]&)*part=2(&|$)
RewriteRule ^bunch\.of/unneeded/crap$ /page.php/prices? [L,R=301] 
```

但正如你所看到的，这可能会变得一团糟。

因此，更好的方法可能是使用[`RewriteMap`](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritemap). 最简单的是带有*键值**对*的纯文本文件：

```
1 welcome
2 prices 
```

要定义您的地图，请在您的服务器或虚拟主机配置中编写以下指令（在每个目录上下文中不允许此指令）：

```
RewriteMap examplemap txt:/path/to/file/map.txt 
```

那么你只需要一个规则：

```
RewriteCond %{QUERY_STRING} ^([^&]&)*opendocument(&|$)
RewriteCond %{QUERY_STRING} ^([^&]&)*part=([0-9]+)(&|$)
RewriteRule ^bunch\.of/unneeded/crap$ /page.php/%{examplemap:%2}? [L,R=301] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-24T00:25:34.493

```
RewriteCond %{QUERY_STRING} option=com_content&task=view&id=70&Itemid=82
RewriteRule ^index.php http://www.example.com/business/banks/? [R=301,L] 
```

这 ？将防止用户被发送到的 url 具有与原始页面相同的查询字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T02:17:17.290

总之，您可以使用`RedirectMatch`匹配完整 URL 的正则表达式，包括查询字符串。这将让您重新排列 URL 的各个部分，但如果您必须将“opendocument&part=1”转换为“welcome”（新 URL 与原始 URL 完全不同），您可能需要一个`RewriteMap`- 或者可能更好，只需将所有 URL 发送到`page.php`并解析 PHP 中的查询字符串。

*编辑*：如果只是您要重定向的几个 URL，您可能会写出单独的规则，例如

```
RedirectPermanent http://www.example.com/bunch.of/unneeded/crap?opendocument&part=1 http://www.example.com/page.php/welcome
RedirectPermanent http://www.example.com/bunch.of/unneeded/crap?opendocument&part=2 http://www.example.com/page.php/prices 
```

# facebook - Facebook Connect 实施问题

> ID：871512
> 
> 赞同：1
> 
> 时间：2009-05-16T02:11:23.513
> 
> 标签：facebook

我希望这是允许的，但我有很多关于 Facebook Connect 的问题，我很不确定我应该如何实现它。

我正在开发一个现场音乐类型的服务，并且目前有用户注册等。如果我要同时实现 Facebook Connect，我是否仍然可以通过电子邮件向 Facebook Connect 用户发送电子邮件，就好像他们在我的数据库中一样？

此外，是否可以让拥有 Facebook 的用户在注册后“链接”他们的帐户，这样我就可以为他们提供通过 Facebook 分享和邀请朋友的好处，同时在我的系统上仍然有一个实际的注册用户。

我试图阅读上述问题的答案，但我发现的内容很模棱两可。

谢谢，期待您的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T04:17:13.117

Facebook 的文档流程很差，所以不要因为入门困难而感到难过。他们的 wiki 风格的文档方法没有任何真正的官方文档，往往会使“流程”难以掌握，并且需要将一堆随机分散的文档拼凑在一起。

Facebook 有义务保护隐私，因此他们永远不会通过 Connect 或普通应用程序向应用程序开发人员提供用户的实际电子邮件地址。他们确实有一个您可以使用的代理电子邮件系统，但是，您必须获得用户的明确许可才能向他们发送电子邮件。[这里有一份关于代理电子邮件](http://wiki.developers.facebook.com/index.php/Proxied_Email)的不错的文档。 您可以通过提示获得许可；该文档中链接了几种方法。

关于链接 Facebook 和本地帐户，这肯定是要走的路。Connect 用户登录后，您希望为该用户存储该事实，以便您可以提供 Facebook 特定的功能。我只需在数据库中为每个新的 Connect 用户创建一个普通用户帐户，并使用它自己的本地 ID，这样您就不必对整个站点上的两种不同类型的用户帐户进行特殊处理。话虽如此，该帐户显然必须被标记为 Facebook 用户的帐户（我`externalId`在用户表中使用一列），并且网站的任何依赖于您在本地可能拥有的信息的部分都必须处理 Facebook 方面正确（例如使用代理电子邮件而不是普通电子邮件）。

对于现有用户，您可以安排一个“帐户链接”，让他们在登录网站后登录 FB Connect，您可以检测到这一点，只需将他们的 FB id 添加到您的用户表中。之后，他们以后可以通过 Connect 登录，也可以通过您的正常流程登录。我从来没有这样做过，但它应该是可能的。

如果您编写的帐户处理代码足够通用，那么无论您向它提供什么样的用户，您的网站都能够正常运行。

# java - Java 泛型放在 Map 上 >

> ID：871521
> 
> 赞同：6
> 
> 时间：2009-05-16T02:17:34.667
> 
> 标签：java, generics, list, collections, map

有没有办法以类型安全的方式进行以下实现？

```
public void myMethod( Map<String, ? extends List<String>> map )
{
   map.put("foo", Collections.singletonList("bar");
} 
```

上述实现不起作用。它需要正确`Map<String, ? super List<String>>`编译该方法`map.put()`。但是 myMethod 不会以这种方式接受 List 的任何子类型。所以，我必须`Map<String, ? extends List<String>>`改用。如何以类型安全的方式解决此问题？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-16T02:52:23.727

```
public void myMethod( Map<String, List<String>> map ) {
    map.put("foo", Collections.singletonList("bar") );
} 
```

您不能将 a `List`(的返回类型`Collections.singletonList()`放入 a `Map`of，`? extends List`因为实际类型可以是 的任何实现`List`。例如，将泛型放入 a是*不安全*的，因为a可能不是 a 。但是，我们可以轻松地将一个变成一个。`List``Map<String,LinkedList>``List``LinkedList``LinkedList``Map``<String,List>`

我认为你在考虑你的泛型。您不必使用`? extends`非泛型类。例如，`List<Object>`将持有 any `Object`，`? extends`不需要添加对象。A`List<List<Foo>>`只会接受`List<Foo>`对象而不接受`List<FooSubclass>`对象[泛型类不会根据它们的参数继承]。这就是`? extends`发挥作用的地方。要将`List<Foo>`和都添加`List<FooSubclass>`到 a`List`中，类型必须是`List<List<? extends Foo>>`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T02:53:08.763

行不通`Map<String, List<String>`？有什么特别的原因你必须在那里有一个通配符吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-10-06T09:44:49.290

将集合和泛型一起使用时，有一个非常简单的原则。它被称为“获取和放置原则”：

当你只从集合中获取值时使用“扩展”通配符，当你只将值放入集合时使用“超级”通配符，当你想要获取和放置时不要使用任何通配符。

所以，如你所见，根据这个原则，最初的例子是无效的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T03:43:10.360

想象一下，如果有人给你一个`Map<String, ArrayList<String>>`. 您输入的值是 Collections.singletonList 的结果，它*不是*`ArrayList`.

您不能在 Map 中接受 List 的任何子类型，然后期望能够添加您自己的，可能不兼容的子类型。

# crystal-reports - 如何在 Crystal Xcelsius 报表中添加面包屑？

> ID：871528
> 
> 赞同：0
> 
> 时间：2009-05-16T02:23:20.973
> 
> 标签：crystal-reports

如何在 Crystal Xcelsius 报表中添加面包屑？我需要跟踪我在图表上的点击导航。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-07-11T06:59:37.427

[BDI Systems](http://www.bdisys.com/index.php?option=com_content&view=article&id=89&Itemid=80)的工作人员有一个免费的面包屑添加，理论上应该可以满足您的需求。我这样说是因为在我短暂的使用它的时间里我无法弄清楚它并且文档几乎不存在。

制作面包屑类型的另一种可能性是通过实现本机过滤器组件作为视觉层次结构的基础。

第三种可能的选择是在 excel 中创建状态机模式，使用从仪表板上随时存在的条件逻辑派生的列表。

最后的路线是使用 Xcelsius 的 flex 2 sdk 开发您自己的组件。

如果您想进一步深入了解上面发布的 4 个解决方案之一，请告诉我们，这样我们就可以将您带到您想去的地方。

# c# - if 语句出错 - 无法将类型隐式转换为“bool”

> ID：871530
> 
> 赞同：4
> 
> 时间：2009-05-16T02:25:22.763
> 
> 标签：c#, if-statement, types, casting

我在转换类型时遇到问题。我正在尝试这样的代码（稍后会使用最少的详细代码）：

```
string cityType = "City1";
int listingsToSearch = 42;
if (cityType = "City1") // <-- error on this line
{
    listingsToSearch = 1;
} 
```

但是“如果”声明转换城市但我不断得到：

> 无法将类型“字符串”隐式转换为“布尔”

* * *

我想要实现的目标：我有一个搜索引擎，它有一个用于搜索文本的文本框和两个用于搜索位置的单选按钮（IE City1 或 City2）

当我收到搜索文本和单选按钮时，它们是字符串的形式

```
string thesearchtext, thecitytype;
thesearchtext = HttpContext.Current.Request.QueryString["s"].ToString();
thecitytype = HttpContext.Current.Request.QueryString["bt"].ToString(); 
```

当我收到城市单选按钮时，它们将采用“city1”或“city2”的格式。

我需要做的是将城市单选按钮转换为 int，以便我可以在搜索数据集中使用它们。我需要转换`"city"`为 integer`1`和`"city2"`integer `2`。

我知道这可能是一个简单的类型转换，但是我无法弄清楚。到目前为止，`if`上面的代码给了我错误：

```
int listingsToSearch;
if (thecitytype = "City1")
{
    listingsToSearch = Convert.ToInt32(1);
}
else
{
    listingsToSearch = Convert.ToInt32(2);
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-16T02:28:43.690

[c# 相等运算符](https://msdn.microsoft.com/en-us/library/53k8ybth.aspx)is`==`和 not `=`：

```
if (thecitytype == "City1") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T17:56:11.153

这里有一些代码可以与 NUnit 一起使用，它演示了另一种计算listingToSearch 的技术——你还会注意到，使用这种技术，你不需要添加提取 if/else 等，因为你添加了更多城市——下面的测试演示了该代码将尝试读取单选按钮标签中“城市”之后开始的整数。另外，请参阅最底部以了解您可以在主代码中编写的内容

```
[Test]
public void testGetCityToSearch()
{

    // if thecitytype = "City1", listingToSearch = 1
    // if thecitytype = "City2", listingToSearch = 2

    doParseCity(1, "City1");
    doParseCity(2, "City2");
    doParseCity(20, "City20");        
}

public void doParseCity(int expected, string input )
{
    int listingsToSearch;
    string cityNum = input.Substring(4);
    bool parseResult = Int32.TryParse(cityNum, out listingsToSearch);
    Assert.IsTrue(parseResult);
    Assert.AreEqual(expected, listingsToSearch);
} 
```

在您的常规代码中，您可以编写：

```
string thecitytype20 = "City20";
string cityNum20 = thecitytype20.Substring(4);
bool parseResult20 = Int32.TryParse(cityNum20, out listingsToSearch);
// parseResult20 tells you whether parse succeeded, listingsToSearch will give you 20 
```

# ruby - 你如何在 Ruby 中做一个安全的、向后兼容的“reverse-monkeypatch”？

> ID：871548
> 
> 赞同：4
> 
> 时间：2009-05-16T02:41:50.023
> 
> 标签：ruby, reverse, monkeypatching

如果您的同事在 Ruby 中“打开”（“monkeypatches”）一个类并重新定义了一些您需要使用的重要功能，您如何访问原始的预猴子补丁功能而不破坏已经依赖/依赖于他的猴子补丁定义的系统?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T05:02:30.247

给定方法覆盖的示例，如果您可以在加载他的猴子补丁之前加载一些代码，那么您可以为该方法设置别名。

```
class Fixnum
  alias_method :original_plus, :+
end

class Fixnum
  def +(x)
    self - x
  end
end

>> 5 + 3
=> 2
>> 5.original_plus(3)
=> 8 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T04:15:29.207

[我最近在 ruby​​flow 提要中看到了这一点 - 它是一个简单的库，可让您命名名为aikidoka](http://www.flyingmachinestudios.com/2009/05/10/aikidoka-prevents-ruby-namespace-collisions/)的顶级常量。如果没有关于如何/什么被猴子修补的任何细节，很难提供帮助。理论上，尽管您可以使用这样的方法来命名该类的猴子补丁版本，以便您可以独立访问它和原始版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T02:48:19.273

完全取决于更改了哪些功能以及以何种方式更改，但是像 Jim Wienrich 的 BlankSlate 类这样的实现[可能](http://onestepback.org/index.cgi/Tech/Ruby/BlankSlate.rdoc)会有所帮助：

# powershell - 如何使用 PowerShell 读取/写入 App.config 设置？

> ID：871549
> 
> 赞同：28
> 
> 时间：2009-05-16T02:42:24.233
> 
> 标签：powershell, app-config

我想在我们的自动化构建过程中使用 PowerShell 来更新 App.config 文件，同时部署到我们的测试环境中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-16T03:02:44.933

鉴于此示例 App.config：C:\Sample\App.config：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <connectionStrings>
        <add name="dbConnectionString" 
             connectionString="Data Source=(local);Initial Catalog=Northwind;Integrated Security=True"/>
    </connectionStrings>
</configuration> 
```

以下脚本 C:\Sample\Script.ps1 将读取和写入设置：

```
# get the directory of this script file
$currentDirectory = [IO.Path]::GetDirectoryName($MyInvocation.MyCommand.Path)
# get the full path and file name of the App.config file in the same directory as this script
$appConfigFile = [IO.Path]::Combine($currentDirectory, 'App.config')
# initialize the xml object
$appConfig = New-Object XML
# load the config file as an xml object
$appConfig.Load($appConfigFile)
# iterate over the settings
foreach($connectionString in $appConfig.configuration.connectionStrings.add)
{
    # write the name to the console
    'name: ' + $connectionString.name
    # write the connection string to the console
    'connectionString: ' + $connectionString.connectionString
    # change the connection string
    $connectionString.connectionString = 'Data Source=(local);Initial Catalog=MyDB;Integrated Security=True'
}
# save the updated config file
$appConfig.Save($appConfigFile) 
```

执行脚本：

```
PS C:\Sample> .\Script.ps1 
```

输出：

```
name: dbConnectionString  
connectionString: Data Source=(local);Initial Catalog=Northwind;Integrated Security=True 
```

更新 C:\Sample\App.config：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <connectionStrings>
    <add name="dbConnectionString" 
         connectionString="Data Source=(local);Initial Catalog=MyDB;Integrated Security=True" />
  </connectionStrings>
</configuration> 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-05-16T17:02:41.233

代码可以更短（基于 Robin 的 app.config）：

```
$appConfig = [xml](cat D:\temp\App.config)
$appConfig.configuration.connectionStrings.add | foreach {
    $_.connectionString = "your connection string"
}

$appConfig.Save("D:\temp\App.config") 
```

# c# - 做这个。减慢代码？

> ID：871550
> 
> 赞同：2
> 
> 时间：2009-05-16T02:42:29.773
> 
> 标签：c#, coding-style

我们在成员变量上进行了（永无止境的）下划线前缀与没有下划线前缀的辩论，有人提到你使用“this”。而不是“-”，由于“。”，您的代码会变慢。在“这个”。这是真的吗？任何人都可以量化吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-16T02:46:34.130

不，这根本没有意义。看看 IL，然后把那个开发者踢到屁股上。

FWIW，我喜欢成员变量中的下划线。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T02:54:09.870

使用 this 关键字时似乎没有区别。如果您有以下代码：

```
class Class3
{
    private long id;

    public void DoWork()
    {
        id = 1;
        this.id = 2;
    }
} 
```

当您通过反射器运行它时，您将看到以下输出：

```
internal class Class3
{
    // Fields
    private long id;

    // Methods
    public void DoWork()
    {
        this.id = 1L;
        this.id = 2L;
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-16T05:01:38.237

在我看来，“这个”。是编译时的消歧器。它告诉编译器变量的范围。这可能是不必要的，因为编译器在任何情况下都需要确定范围。但我无法想象会有任何性能下降，甚至可能是你“暗示”的微观上升。

一旦代码被编译（即在运行时），我想象“这个”。是完全无关的。

所以这是一种风格选择。有些人喜欢简洁。我喜欢这个。” 因为如果使用得当，它会增加清晰度。它告诉其他开发人员函数或属性所在的位置。我将它用于任何公共方法或属性。我通常不与私人成员一起使用它。

Juval Lowy 在这里有一个非常好的 C# 风格指南：[http ://www.idesign.net/](http://www.idesign.net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T09:56:44.347

变量代表内存中的位置。编译时，100 个字符的变量和一个字母的变量都被转换为数字。以同样的方式翻译特殊字符并且不会对速度产生任何影响。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T05:25:45.217

当你得到camelCasing时，谁需要下划线？我也有人说你在做什么听起来像是一个疯狂的想法。

# macos - 使用 hdiutil 或其他工具将背景图像/颜色添加到 DMG？

> ID：871551
> 
> 赞同：6
> 
> 时间：2009-05-16T02:43:09.443
> 
> 标签：macos, installation, dmg

> **可能重复：**
> [如何使用命令行工具为 Mac OS X 创建漂亮的 DMG？](https://stackoverflow.com/questions/96882/how-do-i-create-a-nice-looking-dmg-for-mac-os-x-using-command-line-tools)

似乎使用 Finder UX 或某种 UI 工具（[从 dmg 安装 OS X 应用程序时创建拖放图形](https://stackoverflow.com/questions/871199/create-drag-drop-graphic-when-installing-os-x-application-from-dmg)）是自定义 DMG 打开时外观的唯一方法。这不能很好地扩展并且不够自动化。

任何人都知道实现相同目标的方法，但使用 Mac 上的 hdiutil 或 Linux 上的 mkfs.hfsplus 等工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T08:17:07.830

OS X Finder 将有关窗口大小、类型、位置、背景图像和图标排列（每个目录）的数据存储在一个名为 .DS_Store 的隐藏文件中。如果您遵循另一个问题的一般思路，那么您应该能够将 .DS_Store 文件从生成的磁盘映像复制到部署脚本生成的新映像中。

# ruby-on-rails - 在生产 Rails 应用程序中是否应该将 raise_delivery_errors 设置为 true？

> ID：871552
> 
> 赞同：16
> 
> 时间：2009-05-16T02:44:25.337
> 
> 标签：ruby-on-rails, actionmailer

Ruby on Rails 中的默认设置是将此设置为 false（在生产和开发中）。

```
config.action_mailer.raise_delivery_errors = false 
```

似乎很奇怪。我肯定会在开发中打开它，这很有帮助。但是为什么在生产中似乎没有人开启这个功能呢？如果电子邮件没有通过，我们不应该得到通知吗？这似乎相当重要。

production.rb 中的 rails 评论指出

> 错误的电子邮件地址将被忽略

但我有一些验证来检查不正确的电子邮件地址。似乎我仍然想知道（通过异常通知器或其他方式）用户多久没有收到电子邮件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-16T02:57:41.997

真正的问题是您是否希望一封失败的电子邮件向您的最终用户抛出错误？也许邮件服务器已关闭或其他一些原因阻止发送电子邮件。你想让这给你的用户抛出 50 倍的错误吗？

就个人而言，我以异步方式发送所有电子邮件，因此我可以监控此类内容（而且它对响应时间有很大帮助）

# c# - XDocument.Save(string filename) 是重新保存整个文件还是只是更改？

> ID：871557
> 
> 赞同：1
> 
> 时间：2009-05-16T02:49:40.770
> 
> 标签：c#, xml, save, linq-to-xml

基本上，如果我执行 Xdoc.Load(filename)，进行一些更改，然后执行 Xdoc.Save(filename) 是否只保存更改的内容，例如插入或删除的元素等，还是重新保存所有内容？

根据答案，我正在考虑确定我的应用程序是要保存每次更改还是要在显式保存和退出时保存。还要考虑是写入多个 xml 文件还是将所有内容保存在一个大文件中。我不知道一个大文件有多大，但我怀疑它可能是 10 的 MB，所以如果它重新保存整个文件，那么我绝对不能在保存一个大文件的同时保存所有更改。

如果它确实保存了整个文件，是否有人认为每个实体（可能有数百个）都有一个单独的 xml 文件，这是否是一个好主意？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T03:22:00.583

它保存整个文件。这就是基于文本的格式的本质。文本文件不能在不重写未更改部分的情况下覆盖自身。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T06:43:20.160

Yes, saving a document saves the whole document.

What's the use case for the "per change" save? Is it just in case the application crashes? If so, I suggest you save these incremental changes in a temporary directory as small files, but when the user explicitly says to save the file, save it in one big file. (That's easier to copy around etc.) Delete the temporary directory on exit.

I do wonder whether you really need the temporary directory at all though. It sounds like quite a lot of work for little benefit.

# artificial-intelligence - How does Wolfram Alpha work?

> ID：871560
> 
> 赞同：14
> 
> 时间：2009-05-16T02:53:07.530
> 
> 标签：artificial-intelligence, machine-learning

Behind the tables and tables of raw data, how does Wolfram Alpha work?

I imagine there are various artificial intelligence mechanisms driving the site but I can't fathom how anyone would put something like this together. Are there any explanations that would help a programmer understand how something like this is created? Does the knowledge base learn on its own or is it taught very specific details in a very organized manner? What kind of structure and language is used to store this type of data?

Obviously this is a huge question and can't fully be answered here but some of the general concepts would be nice to know so I can build off of them and do my own research.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T20:38:06.723

> Does the knowledge base learn on its own or is it taught very specific details in a very organized manner?

AI systems are usually something distinctly in between. The system will usually learn in a directed way, where the developers can apply a metric that measures the quality of the learning, and the system learns by attempting to maximise that metric. Where the expertise comes in is in developing efficient and effective representations of the data, so that it lends itself to this learning process and to the measurement of how well the learning is going.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T03:00:57.763

Take a look [at the API](http://tinyurl.com/wolfram-api)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T03:20:20.947

[This official blog post](http://blog.wolframalpha.com/2009/05/01/the-secret-behind-the-computational-engine-in-wolframalpha/) has some portion of the explanation: the language Mathematica.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T09:20:39.783

Looks like a large number of algorithms from which some that might be relevant are selected by pattern matching.

# obfuscation - 你为什么要混淆你的代码？

> ID：871566
> 
> 赞同：12
> 
> 时间：2009-05-16T02:57:29.517
> 
> 标签：obfuscation

你以前是否混淆过你的代码？是否有正当理由这样做？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-16T03:09:23.593

我混淆了我的 JavaScript。它使它更小，从而减少了下载时间。此外，由于代码已交给客户，我公司不希望他们能够阅读它。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-16T02:58:52.120

是的，让逆向工程变得更加困难。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-16T03:20:25.500

当然是为了确保终身工作（开玩笑）。

这是非常有趣和有教育意义的：[如何编写不可维护的代码](http://freeworld.thc.org/root/phun/unmaintain.html)。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-16T05:17:38.323

它被称为“工作保障”。这也是使用 Perl 的原因——不需要将混淆作为单独的任务进行，因此可以提高生产力，而不会失去工作安全性。

如果您愿意，可以将其称为“通过可混淆性实现的安全性”。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-16T03:09:36.760

我不认为让逆向工程变得更难是一个正当的理由。

混淆代码的一个很好的理由是减少编译后的占用空间。例如，J2ME 应用程序需要尽可能小。如果您通过混淆器（和优化器）运行您的应用程序，那么您可以将 jar 从几 Mb 减少到几百 Kb。

上面提到的另一点是，大多数混淆器也是可以提高应用程序性能的优化器。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T04:18:41.133

这不是也被用作默默无闻的安全吗？当您的源代码是公开可用的（javascript 等）时，您可能希望至少更难理解客户端实际发生的情况。

安全总是充满妥协。但我认为默默无闻的安全是最不有效的方法之一。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T04:14:35.213

我相信所有的有线电视机顶盒都会混淆 java 代码。这确实使事情更难破解，并且由于有线电视盒将在您的家中，因此理论上它们是可以破解的。

我不确定这有多重要，因为有线卡仍将控制信号加密并直接从视频源而不是 Java 代码指南或 Java 应用程序获得授权，但它们非常专注于这个概念。

顺便说一句，跟踪从混淆堆栈中抛出的异常并不容易！实际上，我曾经记得 aH 表示特定构建的“空指针异常”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T03:17:31.170

我记得创建了一个在 .NET 中构建的用于在线备份应用程序的 Windows 服务。我可以轻松地使用 Visual Studio 或 .NET Reflector 等工具来查看其中的类和源代码。

我创建了一个新的 Visual Studio 测试应用程序并向它添加了 Windows 服务引用。双击引用，我可以看到所有的类、命名空间（虽然不是源代码）。任何人都可以通过查看类名来了解模块的内部工作。在我的例子中，一个这样的类是 FTPHandler，它清楚地告诉了备份的去向。

.NET Reflector 通过显示实际代码超越了这一点。它甚至可以选择导出整个项目，这样你就可以得到一个 VS 项目，其中包含与开发人员所拥有的所有类和源代码相似的所有类和源代码。

我认为混淆是有道理的，如果不是不可能的话，至少让某人更难拆卸。此外，我认为这对于涉及大量客户群的产品是有意义的，因为您不希望竞争对手对您的产品了解太多。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-16T03:17:36.443

如果我将 Java Swing 应用程序交付给客户端，我总是在分发之前混淆类文件。

你永远不会太小心 - 我曾经在我的类文件中指出了一个不错的 Java 反编译器（我使用了 JD Java 反编译器 - [http://www.djjavadecompiler.com/](http://www.djjavadecompiler.com/)），并获得了几乎完美地再现原始代码的奖励。那是相当令人不安的，所以从那以后我开始混淆我的生产代码。我自己使用 Klassmaster ( [http://www.zelix.com/klassmaster/](http://www.zelix.com/klassmaster/) )

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-16T04:56:23.633

查看我为磁盘驱动程序项目编写的一些代码让我质疑混淆的含义。

```
 ((int8_t (*)( int32_t, void * )) hdd->_ctrl)( DISK_CMD_REQUEST, (void *) dr ); 
```

或者这只是 C 中的系统编程？还是应该以不同的方式编写该行？问题...

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-22T15:41:59.137

是的，不是的，我还没有使用易于反编译的工具交付应用程序。

我确实为旧的 Basic 和 UCSD Pascal 解释器运行了类似混淆器的东西，但这是出于不同的原因，优化了运行时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-02-28T17:58:17.693

我主要混淆了我的 Android 应用程序的代码。我使用 ProGuard 工具来混淆代码。当我从事 C# 项目时，我们的团队使用了 ArmDot。它是许可和混淆系统。现代混淆器不仅用于使黑客攻击过程变得困难。他们能够保护程序和游戏免受作弊，检查许可证/密钥，甚至优化代码。但我认为没有必要在每个项目中都使用混淆器。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-05-16T03:06:27.203

当您*需要*在源代码中提供某些东西时（通常是由于它正在构建的环境，例如没有共享库的系统，特别是如果您作为卖方没有要构建的确切系统），最常见的是这样做），但是您不希望您提供给它的人能够显着（或根本）修改或扩展它。

这过去比今天普遍得多。它还导致了（已停止？）混淆 C 竞赛。

合法的（尽管可以说不是“合法的”）用途可能是为您以模糊方式与 GPL 代码链接的应用程序发布“源代码”。是源码，*可以*修改，就是很难。这将是一个更极端的版本，即不加注释地发布它，或者在所有空白修剪后发布，或者（这可能会推动法律依据）发布从 C 生成的汇编源代码（并且可能是手动调整的，所以你可以说它不是**只是**中间代码）。

# c++ - 从同一个指针构造两个 shared_ptr 对象

> ID：871574
> 
> 赞同：4
> 
> 时间：2009-05-16T03:02:05.683
> 
> 标签：c++, shared-ptr, tr1

我有一个来自“C++ 标准库扩展”的问题：

> 练习 6
> 我在 2.4.2 节中说过，你不应该从同一个指针构造两个 shared_ptr 对象。危险在于 shared_ptr 对象或其后代最终都会尝试删除资源，这通常会导致麻烦。事实上，如果你小心的话，你可以做到这一点。它不是特别有用，但是编写一个程序，从同一个指针构造两个 shared_ptr 对象，并且只删除一次资源。

以下是我的回答：

```
template <typename T>
void nonsence(T*){}
struct SX {
     int data;
     SX(int i = 0) :
              data(i) {
              cout << "SX" << endl;
     }
     ~SX() {
              cout << "~SX" << endl;
     }
};
int main(int argc, char **argv) {
    SX* psx=new SX;
    shared_ptr<SX> sp1(psx),sp2(psx,nonsence<SX>);
    cout<<sp1.use_count()<<endl;
    return 0;
} 
```

但我认为这不是一个好的解决方案——因为我不想通过使用构造函数来解决它。谁能给我一个更好的？thx，请原谅我糟糕的英语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T20:58:58.190

您需要做的就是`shared_ptr`从第一个构造第二个`shared_ptr`。

```
shared_ptr<SX> sp1( new SX );
shared_ptr<SX> sp2( sp1 ); 
```

只有当所有指向它的共享指针都被销毁时，创建的 SX 才会被正确删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T03:54:29.710

您发现的技巧是有效的，尽管没用。的核心功能`shared_ptr`是引用计数，您在这里颠覆了它。删除器（第二个构造函数参数）用于`shared_ptr`与普通指针以外的资源一起使用。您可以将其与文件一起使用，例如：

```
 typedef boost::shared_ptr FilePtr;
void FileClose( FILE* pf ) { if ( pf ) fclose( pf ); }
FilePtr pfile( fopen( "filename" ), FileClose ); 

```

与数据库连接、套接字等以及一般的[RAII](http://en.wikipedia.org/wiki/RAII)相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T03:09:00.863

您可以查看 boost 如何使用[shared_from_this](http://www.boost.org/doc/libs/1_39_0/libs/smart_ptr/enable_shared_from_this.html)解决它。这是[代码](http://www.boost.org/doc/libs/1_39_0/boost/smart_ptr/enable_shared_from_this.hpp)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T06:56:21.727

我从 boost doc 得到了“标准”的答案：http: [//www.boost.org/doc/libs/1%5F38%5F0/libs/smart%5Fptr/sp%5Ftechniques.html#another_sp](http://www.boost.org/doc/libs/1%5F38%5F0/libs/smart%5Fptr/sp%5Ftechniques.html#another_sp)

# wpf - WPF 按钮、命令目标、绑定问题

> ID：871577
> 
> 赞同：1
> 
> 时间：2009-05-16T03:03:36.383
> 
> 标签：wpf

我有一个 DesignerCanvas（从画布派生），我可以将 UIElements 添加到其中，然后拖动\drop\move\group 并将它们移动。

在工具栏上，我有一个绑定到组命令的按钮。

```
<Button Margin="0,3,0,3" Padding="5" HorizontalContentAlignment="Left"
        Command="{x:Static s:DesignerCanvas.Group}"
        CommandTarget="{Binding ElementName=DesignerCanvas}"> 
```

我遇到的问题是我可以拥有一个还包含 DesignerCanvas 的控件。所以有嵌套的画布，我希望工具栏上的 GroupCommand 应用于焦点所在的画布。在上面的绑定中，它只绑定到根画布。

我想我可以跟踪当前画布并将其公开在视图模型中以进行绑定，但我更愿意避免跟踪活动画布。

对这里的创意绑定有什么建议吗？

谢谢，杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T12:00:27.280

GroupCommand 是 RoutedCommand 吗？假设是这样，我希望您可以通过删除 CommandTarget 属性分配来获得所需的行为。

# sql - 如何在忽略大小写的sql中比较字符串？

> ID：871578
> 
> 赞同：47
> 
> 时间：2009-05-16T03:03:54.963
> 
> 标签：sql, oracle

如何在 Oracle 中编写查询而忽略正在比较的字符串的大小写？例如，“angel”、“Angel”、“ANGEL”、“angel”、“AngEl”在比较时都是相等的。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-16T03:07:40.447

如果您匹配字段的完整值，请使用

```
WHERE UPPER(fieldName) = 'ANGEL' 
```

编辑：根据您要使用的评论：

```
SELECT 
    RPAD(a.name, 10,'=') "Nombre del Cliente"
    , RPAD(b.name, 12,'*') "Nombre del Consumidor" 
FROM 
    s_customer a, 
    s_region b 
WHERE 
    a.region_id = b.id 
    AND UPPER(a.name) LIKE '%SPORT%' 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-16T03:08:34.797

您可以使用[UPPER](http://www.techonthenet.com/oracle/functions/upper.php)关键字：

```
SELECT *
FROM Customers
WHERE UPPER(LastName) = UPPER('AnGel') 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-16T03:08:05.453

您可以使用：

```
select * from your_table where upper(your_column) like '%ANGEL%' 
```

否则，您可以使用：

```
select * from your_table where upper(your_column) = 'ANGEL' 
```

**如果您正在寻找在your_column**字段之前或之后没有其他字符的匹配项，这将更有效，正如 Gary Ray 在他的评论中所建议的那样。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-07-25T06:12:26.963

在比较两个或多个字符串之前先执行以下命令

```
alter session set NLS_COMP=LINGUISTIC;
alter session set NLS_SORT=BINARY_CI; 
```

在执行这两个语句之后，您可以比较字符串并且不区分大小写。例如，您有两个字符串 s1='Apple' 和 s2='apple'，如果您想在执行上述语句之前比较这两个字符串，那么这两个字符串将被视为两个不同的字符串，但是当您在执行两个 alter 语句后比较字符串时，这两个字符串 s1 和 s2 将被视为相同的字符串

使用这两个语句的原因

**我们需要设置 NLS_COMP=LINGUISTIC 和 NLS_SORT=BINARY_CI 以使用 10gR2 不区分大小写。由于这些都是会话可修改的，所以并不像在初始化参数中设置它们那么简单。我们可以在初始化参数中设置它们，但它们只影响服务器而不影响客户端。**

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-17T22:42:37.470

有关 Dredel 先生的回答和 tuinstoel 评论的更多详细信息。列中的数据将以其特定的大小写存储，但您可以更改会话的区分大小写以进行匹配。

您可以更改会话或数据库以使用语言或不区分大小写的搜索。您还可以设置索引以使用特定的排序顺序。

例如

```
ALTER SESSION SET NLS_SORT=BINARY_CI; 
```

一旦您开始使用带有口音等的非英语语言，就会额外支持不区分口音。某些功能因版本而异，因此请查看您的特定 Oracle 版本的全球化文档。最新款（11g）来[了](http://download.oracle.com/docs/cd/B28359_01/server.111/b28298/ch5lingsort.htm#i1009059)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-17T18:53:48.637

要避免字符串转换比较，请使用**[COLLATE SQL_Latin1_General_CP1_CI_AS](https://stackoverflow.com/a/5039321/2117037)**。

例子：

```
SELECT UserName FROM Users
WHERE UserName COLLATE SQL_Latin1_General_CP1_CI_AS = 'Angel' 
```

这将返回任何用户名，无论是 ANGEL、angel 还是 Angel 等。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-10-20T12:06:08.600

选择 STRCMP("string1", "string2");

如果字符串相等，则返回 0。

*   如果string1 = string2，此函数返回0（忽略大小写）
*   如果 string1 < string2，此函数返回 -1
*   如果 string1 > string2，此函数返回 1

[https://www.w3schools.com/sql/func_mysql_strcmp.asp](https://www.w3schools.com/sql/func_mysql_strcmp.asp)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T03:27:43.393

我不记得确切的语法，但您可以将表格列设置为不区分大小写。但要小心，因为那样你将无法再根据大小写进行匹配，如果你想“酷”不匹配“酷”，那将不再可能。

# c++ - 这段代码在哪里取消引用无效的迭代器？(C++)

> ID：871579
> 
> 赞同：3
> 
> 时间：2009-05-16T03:04:58.313
> 
> 标签：c++, vector, iterator

我有一个循环

```
for(aI = antiviral_data.begin(); aI != antiviral_data.end();)
{
    for(vI = viral_data.begin(); vI != viral_data.end();)
    {
        if((*aI)->x == (*vI)->x && (*aI)->y == (*vI)->y)
        {
            vI = viral_data.erase(vI);
            aI = antiviral_data.erase(aI);
        }
        else
        {
            vI++;
            aI++;
        }
    }
} 
```

但是，当 antiviral_data 包含一个项目时，我会收到一个错误“vector iterator not dereferencable”。为什么我会收到此错误，我在哪里取消引用无效的迭代器？

注意：到目前为止，仅当 if() 语句为假时才会发生错误。我不知道如果 if() 语句为真会发生什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T03:11:52.337

向量的大小是多少？

如果viral_data 比antiviral_data 有更多的元素，那么，由于你以相同的速率递增aI 和vI，aI 会在vI 循环结束之前超出界限。

在这里举一个简短的例子：

```
for(int i = 0; i < 5;)
{
    for(int j = 0; j < 10;)
    {
        i++;
        j++;
    }
} 
```

如果您查看 for 循环，您会注意到内部循环不会结束，直到 j**和**i 都为 10，但根据您的外部循环，i*不*应该超过 5。

您将希望在外部循环中增加 i （或在您的情况下为 aI），如下所示：

```
for(int i = 0; i < 5;)
{
    for(int j = 0; j < 10;)
    {
        j++;
    }
    i++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-01T14:29:15.420

取消引用发生在

```
((*aI)->x == (*vI)->x && (*aI)->y == (*vI)->y) 
```

当该语句对于`antiviral_data`列表中的最后一个元素为真时，就会发生这种情况。在这种情况下，在内部 for 循环的下一次迭代中，您将取消引用`antiviral_data.end()`，这是不允许的。

# java - Java同步和性能方面

> ID：871582
> 
> 赞同：5
> 
> 时间：2009-05-16T03:07:10.807
> 
> 标签：java, performance, synchronization, aspectj

我刚刚意识到我需要在一个方面同步大量数据收集代码，但性能是一个真正的问题。如果性能下降太多，我的工具将被淘汰。我将分别编写整数和长整数以及各种数组、ArrayLists 和 Maps。应用程序的多个线程将进行函数调用，这些调用将被我的方面拾取。我应该注意哪些会对性能产生负面影响的事情？哪些代码模式更有效？

特别是我有一个调用许多其他数据记录方法的方法：

```
void foo() {
    bar();
    woz();
    ...
} 
```

这些方法主要是添加方面字段的增量

```
void bar() {
    f++; // f is a field of the aspect
    for (int i = 0; i < ary.length; i++) {
        // get some values from aspect point cut
        if (some condiction) {
            ary[i] += someValue; // ary a field of the aspect
        }
     }
 } 
```

我应该单独同步 foo 或 bar、woz 等，还是应该将 bar、woz 等中的所有代码移动到 foo 中并同步它？我应该在`this`, 上同步一个专门创建的同步对象：

```
private final Object syncObject = new Object(); 
```

（见[这篇](https://stackoverflow.com/questions/416183/in-java-critical-sections-what-should-i-synchronize-on)文章），或方法中的单个数据元素：

```
ArrayList<Integer> a = new ArrayList<Integer>();

void bar() {    
    synchronize(a) {
        // synchronized code
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T03:20:58.680

并发非常棘手。做错很容易，做对也很难。在这一点上，我不会太担心性能。我首先关心的是让并发代码安全地工作（没有死锁或竞争条件）。

但是在性能问题上：如有疑问，请说明。很难说不同的同步方案将如何影响性能。我们更难给你建议。我们需要查看更多您的代码，并更深入地了解应用程序的功能，以便为您提供真正有用的答案。相比之下，分析为您提供了确凿的证据，证明一种方法是否比另一种方法慢。它甚至可以帮助您确定减速的位置。

现在有很多很棒的 Java 分析工具。Netbeans 和 Eclipse 分析器很好。

另外，我建议完全远离原始同步。尝试使用包中的一些类`java.util.concurrency`。它们使编写并发代码变得更加容易，并且更不容易出错。

另外，我建议您阅读Brian Goetz 等人的[Java Concurrency in Practice 。](http://www.javaconcurrencyinpractice.com/)它写得很好，涵盖了很多领域。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T13:42:49.263

经验法则是不要同步`this`——大多数时候它会影响性能——所有方法都在一个对象上同步。

考虑使用锁——它们是一个非常好的抽象和许多优秀的特性，比如尝试锁定一段时间，然后放弃：

```
if(commandsLock.tryLock(100, TimeUnit.MILLISECONDS)){
     try { 
         //Do something
     }finally{
          commandsLock.unlock();
     }
}else{
     //couldnt acquire lock for 100 ms
} 
```

我对使用`java.util.concurrent`. 我会做两级同步

*   同步集合访问（如果需要）
*   同步字段访问

## 收藏访问

如果您的集合`read-only`即没有元素被删除-插入（但元素可能会更改），我会说您应该使用同步集合（但这可能不需要......）并且不要同步迭代：

*只读：*

```
for (int i = 0; i < ary.length; i++) {
    // get some values from aspect point cut
    if (some condiction) {
        ary += someValue; // ary a field of the aspect
    }
 } 
```

ary 是由 获得的实例`Collections.synchronizedList`。

*读写*

```
synchronized(ary){
    for (int i = 0; i < ary.length; i++) {
        // get some values from aspect point cut
        if (some condiction) {
            ary += someValue; // ary a field of the aspect
        }
     }
 } 
```

或者使用一些本质上是安全的并发集合（如[CopyOnWriteArrayList ）。](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)

主要区别在于 - 在第一个只读版本中，任何数量的线程都可以迭代这个集合，而在第二个中，一次只能迭代一个。在这两种情况下，一次只有一个拉德应该增加任何给定的字段。

## 现场访问

与同步迭代分开同步字段的增量。

喜欢：

```
 Integer foo = ary.get(ii); 
  synchronized(foo){
      foo++;
  } 
```

# 摆脱同步

1.  使用并发集合（来自`java.util.concurrent`- 而不是来自 `Collections.synchronizedXXX'，后者仍然需要在遍历时同步）。
2.  使用`java.util.atomic`它使您能够以原子方式递增字段。

### 你应该看的东西：

[Java 内存模型](https://www.youtube.com/watch?v=WTVooKLLVT8)- 它的演讲很好地理解了 JAVA 中的同步和数据对齐是如何工作的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-10-26T08:16:20.720

内置语言结构和库之间应该存在性能差异，但经验告诉我在性能方面不要猜测。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-16T04:13:31.270

**Upadte:** since writing the below, I see you've updated the question slightly. Forgive my ignorance-- I have no idea what an "aspect" is-- but from the sample code you posted, you could also consider using atomics/concurrent collections (e.g. AtomicInteger, AtomicIntegerArray) or [atomic field updaters](http://www.javamex.com/tutorials/synchronization_concurrency_7_atomic_updaters.shtml). This could mean quite a re-factoring of your code, though. (In Java 5 on a dual-proc hyperthreading Xeon, the [throughput of AtomicIntegerArray](http://www.javamex.com/tutorials/synchronization_concurrency_8_copy_on_write.shtml) is significantly better than a synchronized array; sorry, I haven't got round to repeating the test on more procs/later JVM version yet-- note that performance of 'synchronized' has improved since then.)

Without more specific information or metrics about your particular program, the best you can do is just **follow good program design**. It's worth noting that the performance and optimisation of synchronization locks in the JVM has beed one of the areas (if not, the area) that has received most research and attention over the last few years. And so in the latest versions of JVM's, it ain't all that bad.

So in general, I'd say **synchronize minimally without "going mad"**. By 'minimally', I mean so that you hold on to the lock for as less time as possible, and so that only the parts that need to use that specific lock use that specific lock. But only if the change is easy to do and it's easy to prove that your program is still correct. For example, instead of doing this:

```
synchronized (a) {
  doSomethingWith(a);
  longMethodNothingToDoWithA();
  doSomethingWith(a);
} 
```

consider doing this *if and only if* your program will still be correct:

```
synchronized (a) {
  doSomethingWith(a);
}
longMethodNothingToDoWithA();
synchronized (a) {
  doSomethingWith(a);
} 
```

But remember, the odd simple field update with a lock held unnecessarily probably won't make much tangible difference, and could actually improve performance. Sometimes, holding a lock for a bit longer and doing less lock "housekeeping" can be beneficial. But **the JVM can make some of those decisions**, so you don't need to be tooo paranoid-- just do generally sensible things and you should be fine.

In general, try and have a separate lock for each set of methods/accesses that together form an "independent process". Other than that, having a separate lock object can be a good way of *encapsulating* the lock within the class it's used by (i.e. preventing it from being used by outside callers in a way you didn't predict), but there's probably no performance difference per se from using one object to another as the lock (e.g. using the instance itself vs a private Object declared just to be a lock within that class as you suggest), provided the two objects would otherwise be used in exactly the same way.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T04:28:42.887

If you compile the aspect into the application then you will have basically no performance hit, if you do it at runtime (load-type weaving) then you will see a performance hit.

If you have each aspect be perinstance then it may reduce the need for synchronization.

You should have as little synchronization as possible, for as short a time as possible, to reduce any problems.

If possible you may want to share as little state as possible between threads, keeping as much local as possible, to reduce any deadlock problems.

More information would lead to a better answer btw. :)

# ruby-on-rails - ActiveRecord 和 SELECT AS SQL 语句

> ID：871584
> 
> 赞同：1
> 
> 时间：2009-05-16T03:07:46.327
> 
> 标签：ruby-on-rails, activerecord

我正在 Rails 中开发一个应用程序，我想根据他们的当前点对用户列表进行排名。该表如下所示：user_id:string, points:integer。由于我不知道如何做到这一点“Rails 方式”，我编写了以下 SQL 代码：

```
self.find_by_sql ['SELECT t1.user_id, t1.points, COUNT(t2.points) as user_rank FROM registrations as t1, registrations as t2 WHERE t1.points <= t2.points OR (t1.points = t2.points AND t1.user_id = t2.user_id) GROUP BY t1.user_id, t1.points ORDER BY t1.points DESC, t1.user_id DESC'] 
```

事情是这样的：访问别名列“user_rank”的唯一方法是执行ranking[0].user_rank，如果我想轻松显示结果表，这让我很头疼。

有更好的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-08T02:17:07.063

怎么样：

```
@ranked_users = User.all :order => 'users.points' 
```

那么在你看来你可以说

```
<% @ranked_users.each_with_index do |user, index| %>
  <%= "User ##{index}, #{user.name} with #{user.points} points %>
<% end %> 
```

如果由于某种原因您需要将该数字索引保留在数据库中，则需要添加`after_save`回调以在任何人的点数发生更改时更新完整的用户列表。您可能会考虑使用该`acts_as_list`插件来帮助解决这个问题，或者这可能完全是矫枉过正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T04:01:22.157

Try adding user_rank to your model.

```
class User < ActiveRecord::Base

  def rank
   #determine rank based on self.points (switch statement returning a rank name?)
  end

end 
```

Then you can access it with @user.rank.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T04:02:03.777

What if you did:

```
SELECT t1.user_id, COUNT(t1.points) 
FROM registrations t1 
GROUP BY t1.user_id 
ORDER BY COUNT(t1.points) DESC 
```

If you want to get all rails-y, then do

```
cool_users = self.find_by_sql ['(sql above)']

cool_users.each do |cool_user|
  puts "#{cool_user[0]} scores #{cool_user[1]}"
end 
```

# c# - Bitmap.Save，巨大的内存泄漏

> ID：871610
> 
> 赞同：0
> 
> 时间：2009-05-16T03:22:02.017
> 
> 标签：c#, memory-leaks, bitmap

我有一个应用程序，我在其中获取位图并使用 GZipStream 压缩它并通过套接字发送它，所有这些都在内存中。我已经将肮脏的垃圾内存泄漏追踪到以下行：

```
frame.Save(inStream, jpegCodec, parameters); 
```

浏览良好的信息高速公路，我发现了许多关于图像类在各种编解码器的保存方法中泄漏内存的主题。问题是我真的找不到任何修复程序。所以我的问题如下：

1.  这是什么原因造成的
2.  我怎样才能解决这个问题

这是泄漏所在的 FrameStream 类中的完整 Write() 方法。

```
/// <summary>
    /// Writes a frame to the stream
    /// </summary>
    /// <param name="frame">The frame to write</param>
    public void Write(Bitmap frame) {
        using (EncoderParameter qualityParameter = new EncoderParameter(Encoder.Quality, 50L)) {
            using (EncoderParameters parameters = new EncoderParameters(1)) {
                parameters.Param[0] = qualityParameter;

                ImageCodecInfo[] codecs = ImageCodecInfo.GetImageEncoders();
                ImageCodecInfo jpegCodec = null;

                foreach (ImageCodecInfo codec in codecs) {
                    if (codec.MimeType == "image/jpeg") {
                        jpegCodec = codec;
                        break;
                    }
                }

                using (MemoryStream inStream = new MemoryStream()) {
                    frame.Save(inStream, jpegCodec, parameters); // HUUUGE Memory Leak
                    Byte[] buffer = new Byte[inStream.Length];
                    inStream.Read(buffer, 0, buffer.Length);

                    using (MemoryStream outStream = new MemoryStream()) {
                        using (GZipStream gzipStream = new GZipStream(outStream, CompressionMode.Compress)) {
                            gzipStream.Write(buffer, 0, buffer.Length);
                        }

                        Byte[] frameData = outStream.ToArray();
                        Byte[] packet = new Byte[15 + frameData.Length];
                        Byte[] frameLength = BitConverter.GetBytes(frameData.Length);

                        Array.Copy(frameLength, 0, packet, 0, frameLength.Length);
                        Array.Copy(frameData, 0, packet, 15, frameData.Length);

                        m_Socket.Send(packet);
                    }
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T05:28:05.257

我建议在 CLR Profiler 下运行代码来定位泄漏源。如果它是任何类型的托管对象（甚至是非托管资源），只要该错误不是由于托管类型泄漏了非托管句柄，您就可以看到泄漏的位置。如果它在框架代码中，您可能可以使用反射和 P/Invoke 来解决它。

例如，该类型在某些情况下会`Icon`泄漏 Win32 。`HICON`解决方法是`HICON`通过 PInvoking`DeleteObject`函数使用`Icon`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T06:22:55.733

好的，在尝试了每个人的想法和想法以及许多其他方法之后。我终于尝试了简单的：

```
using (frame) {
    frame.Save(outStream, jpegCodec, parameters);
} 
```

好吧，这行得通，内存泄漏已修复。我尝试强制调用垃圾收集器，手动处理位图，使用 P/Invoke DeleteObject，没有任何效果，但使用 using 语句可以。所以这让我想知道在我错过的 using 语句的底层会发生什么......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T05:25:09.227

处理完毕后，您应该将位图设置为空。

此外，您可能希望在处理位图后调用垃圾收集器（即使这是一项昂贵的操作）：`GC.Collect();`

位图拥有非托管资源 - GC 并不总是与这些“在球上”。这是一个关于 Bitmap 类的有趣链接（从紧凑框架的角度来看）：[http ://blog.opennetcf.com/ctacke/PermaLink,guid,987041fc-2e13-4bab-930a-f79021225b74.aspx](http://blog.opennetcf.com/ctacke/PermaLink,guid,987041fc-2e13-4bab-930a-f79021225b74.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T03:43:44.743

我对插座了解不多。但是，我知道阻止 Image 类内存泄漏的一种方法是冻结位图。希望[这篇文章](http://blogs.msdn.com/jgoldb/archive/2008/02/04/finding-memory-leaks-in-wpf-based-applications.aspx)可以为您提供更多信息。MemoryStream.Dispose 会失败吗？从而造成内存泄漏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T03:44:52.197

您是否正在调用 Graphics 对象的 .Dispose() 方法？这*将*导致内存泄漏。编辑：一旦你写了字节[]，你现在就可以清楚地看到 Bitmap 对象的 .Dispose() 了。

# sql - 为 t-sql 命名存储过程的最佳实践是什么？

> ID：871612
> 
> 赞同：25
> 
> 时间：2009-05-16T03:24:28.907
> 
> 标签：sql, sql-server, tsql, stored-procedures

我使用过几个大型数据库，存储过程的名称非常不同：

```
SP_PrefixXXX
PrefixYyyXxx
Prefix: Rep, Act 
```

命名的最佳做法是什么？我怎样才能以适当的方式组织它们？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-05-16T05:05:32.207

`sp_`前缀代表系统过程，不应**用作**常规过程的前缀。如果这样做，它`master`每次都会先额外访问数据库以查找过程，如果它与那里的过程之一具有相同的名称，则将执行该过程而不是您的过程。

除此之外，您可以自由制定任何您喜欢的命名约定。我们公司使用的一种是`subsystem_object_action`，例如`main_Customer_Get`。这使得列表中的程序彼此靠近。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-16T05:19:30.893

我喜欢给它们加上前缀，以便 SP 处理特定对象的内容被组合在一起。因此，而不是类似的东西：

```
    插入用户
    更新用户
    删除用户
    获取用户

```

我这样做：

```
    AppName_User_GetUser
    AppName_User_InsertUser
    AppName_User_UpdateUser
    AppName_User_DeleteUser

```

我发现这对我来说更容易在我的 SQL 管理应用程序和我的代码中进行管理。

就像其他人说的那样，不要前缀**sp_**

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-16T03:31:00.157

最好的命名约定是在整个数据库中保持一致的命名约定 :)

真的，这取决于你和你的团队。只要它是清晰和明智的，你就有相当大的余地。只要确保无论您做出什么决定，每个人都遵守它。比公约本身更重要的是每个人都坚持这一事实。

我倾向于避免使用 sp_、usp_ 等，因为我发现它们是多余的。例如，一个名为 InsertCustomer 的 sproc 显然是一个 sproc，绝不会与表、视图或任何其他类型的对象混淆。sp_ 特别应该避免。

我更喜欢 CamelCase，但同样，这是一个偏好问题。我喜欢我的 proc 名称来很好地说明 proc 的作用 - 例如：

InsertSalesOrder PopulateItemStagingTables CalculateOrderSummary PrepareCustomerStatements

等等

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-16T14:53:37.517

我不知道在这种情况下是否真的有特定的“最佳实践”。对于我现在所在的公司，标准是 usp[ProcedureName]（没有下划线）。我个人更喜欢没有前缀，但如果你是新加入公司或项目并且他们有预先存在的标准，除非他们使用 sp_ 有技术原因不使用它，它可能不是值得辩论的问题，因为我当然不认为在这种情况下它是一个令人震惊的标准。

一般会重新命名约定，如果你确实有争论，其他团队成员不同意你的意见，共识标准不同，最好的策略是迅速放下，接受共识；一致性通常比实际标准本身更重要，与其他团队成员相处融洽，不要因“难”而名声大噪。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-16T03:33:26.030

不是“sp_”，也不是“usp_”。我们*知道*它们是存储过程，命名方案不需要告诉我们。

我通常只是根据它们的作用来命名它们，可能在模式上对它们进行分区。例外情况是，我将对存储过程使用“ssis_”前缀，这些存储过程不直接用作“正常”数据库操作的一部分，而是由 SSIS 包用于引用数据库。我可以使用“fn_”来表示一个函数，以将其与存储过程区分开来。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T03:32:30.073

好吧，在名称前加上“SP_”几乎是多余的：它是实现的命名（它是一个 SP，而不是表或视图）。还有很多其他方法（系统、信息模式、使用方式）可以告诉你它是如何实现的。

相反，您应该根据它的接口来命名它，因为它为您做了什么。为方便起见（因为很多东西最终都是按字母顺序排列的），我喜欢将类似的东西放在类似的名称下，可能使用相同的前缀。

但同样，以它的作用命名它*，*而不是*它碰巧是如何实现*的。

一般来说，我发现数据库对象的通用命名约定使用下划线而不是 CamelCase；这只是惯例问题。不仅仅是约定，还有对数据库对象使用全小写字母的常见约定。这允许您忽略可能不区分大小写的服务器设置。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-16T04:35:03.310

I tend to try to give names that not only give an idea what the function is for, but what the input variables will be.

For example: ProcessMathEquationWithFieldIdPlantId

This will help give information immediately to anyone else using it, I believe.

I also avoid sp_ and usp_ to limit any chance of name collisions.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-05-04T07:57:49.057

我不是专业人士，但我喜欢这种方式

应用前缀 = XY; 视图 = v; 存储过程 = p; 函数 = f

```
Table: XY_Name
View: vXY_Name
Procedure: sXY_Name
Function: fXY_Name 
```

你怎么看 ？我知道有些人使用这两个字符来识别对象类型，但大多数情况下一个字符就足够了，对吧？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-22T04:52:50.060

更好地为单独的模块创建模式。

然后给有意义和简单的名字。

例如：如果你正在工作的学校项目。

创建**学生**模式

程序名称：**AddStudent**

所以它看起来像程序列表中的**Student.AddStudent**

教师模块也一样

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-17T20:49:45.780

这可能会有所帮助。由于我是前端/后端程序员，我对 MySQL 和 SQLServer 使用以下内容：

```
SPx_PAGE/MODULE_ACTION_OBJECT 
```

x：R 表示读取，I 表示插入，U 表示更新，W 表示写入（如果索引不存在则组合插入或如果存在则更新）和 D 表示删除。

page/module：调用过程的地方

例子：

```
SPR_DASHBOARD_GET_USERS //reads users data
SPW_COMPANIES_PUT_COMPANY //creates or modifies a company 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-05-12T02:44:15.283

我们使用了这个约定：*Prefix_Factory_Action*

**字首**

*   up：用户过程的缩写，用于命名空间
*   ap：Administrator Procedure 的缩写，仅供数据库管理员使用
*   sp：系统过程的缩写。仅应由 Microsoft 使用，因为首先检查 master
*   xp：外部过程的缩写。由 Microsoft 和其他开发人员使用

**工厂**

在我们的命名空间中使用的名称，或任何其他逻辑结构。它不是一张桌子，尽管它通常与一张桌子同名。示例包括论文、教职员工和学生

**行动**

正在执行的操作类型，例如获取、设置、插入、更新、删除、保存、填充、重新填充等。

Action 有时后跟一个限定符，例如 For/By/In

**例子**

*   ap_Paper_Repopulate
*   up_Staff_Save
*   up_Enrolment_GetForStudent

# c# - 为什么此 WPF 代码不生成上下文菜单？

> ID：871617
> 
> 赞同：7
> 
> 时间：2009-05-16T03:27:12.630
> 
> 标签：c#, .net, wpf, brushes

也许我正在经历一个[后鲍尔默高峰时刻](http://xkcd.com/323)。我希望有人可以帮助指出对我来说显而易见的事情。

为什么此代码在右键单击时生成上下文菜单：

```
<Canvas Background="Transparent">
  <Canvas.ContextMenu>
    <ContextMenu>
      <TextBlock>WTF?</TextBlock>
    </ContextMenu>
  </Canvas.ContextMenu>
</Canvas> 
```

并且此代码不会生成上下文菜单：

```
<Canvas>
  <Canvas.ContextMenu>
    <ContextMenu>
      <TextBlock>WTF?</TextBlock>
    </ContextMenu>
  </Canvas.ContextMenu>
</Canvas> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-16T03:45:02.697

这是因为`Transparent`画笔允许一个区域是可点击的，因此可以接收和响应鼠标点击，而默认`null`画笔不允许。换句话说，在没有定义任何画笔的情况下，该区域将变为“空心”并且点击通过；使用定义的画笔（甚至是透明的画笔），它们是“实心的”并且可以接收到点击。

有关更多信息，请参阅这篇关于**[WPF 画笔](http://msdn.microsoft.com/en-us/library/aa970904.aspx)**的有用文章。

# wpf - 将 enter 解释为选项卡 WPF

> ID：871619
> 
> 赞同：23
> 
> 时间：2009-05-16T03:27:35.077
> 
> 标签：wpf, keyboard-input

我想在我的整个 WPF 应用程序中将 Enter 键解释为 Tab 键，也就是说，当用户按下 Enter 时，我的应用程序中的任何地方我都想关注下一个可聚焦的控件，除非按钮被聚焦。在应用程序生命周期中有没有办法做到这一点？谁能给我一个例子？
非常感谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-16T04:06:34.640

如果您愿意，可以使用我的[EnterKeyTraversal 附加属性](http://www.madprops.org/blog/enter-to-tab-as-an-attached-property/)代码。将其添加到 WPF 窗口的顶级容器中，其中的所有内容都将 enter 视为选项卡：

```
<StackPanel my:EnterKeyTraversal.IsEnabled="True">
    ...
</StackPanel> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-07-31T21:01:13.197

基于 Richard Aguirre 的回答，它比所选的易于使用的答案更好，恕我直言，您可以通过简单地将 Grid 更改为 UIElement 来使其更通用。

要在整个项目中更改它，您需要这样做

*   在 App.xaml.cs 中：

    ```
     protected override void OnStartup(StartupEventArgs e)
     {           
         EventManager.RegisterClassHandler(typeof(UIElement), UIElement.PreviewKeyDownEvent, new KeyEventHandler(Grid_PreviewKeyDown));
         base.OnStartup(e);
     }

     private void Grid_PreviewKeyDown(object sender, System.Windows.Input.KeyEventArgs e)
     {
         var uie = e.OriginalSource as UIElement;

         if (e.Key == Key.Enter)
         {
             e.Handled = true;
             uie.MoveFocus(
             new TraversalRequest(
             FocusNavigationDirection.Next));
         }
     } 
    ```

*   编译。并做到了。现在你可以使用像标签一样的输入。注意：这适用于网格中的元素

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-21T18:51:32.843

我通过将 FrameworkElement.Tag（其值为 IgnoreEnterKeyTraversal）添加到我的 XAML 中的某些元素（按钮、组合框或任何我想忽略输入键遍历的东西）来解决 woodyiii 的问题。然后我在附加属性中寻找这个标签和值。像这样：

```
 if (e.Key == Key.Enter)
    {
        if (ue.Tag != null && ue.Tag.ToString() == "IgnoreEnterKeyTraversal")
        {
            //ignore
        }
        else
        {
            e.Handled = true;
            ue.MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-04T12:45:54.247

`UIElement`woodyiii，被调用中有一个函数，`PredictFocus()`其名称知道它的功能，然后您可以检查该元素是否启用，以便将焦点移至它...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-22T16:53:05.260

这是马特汉密尔顿的代码，如果有人想知道，因为他的网站显然已经关闭：

```
public class EnterKeyTraversal
{
    public static bool GetIsEnabled(DependencyObject obj)
    {
        return (bool)obj.GetValue(IsEnabledProperty);
    }

    public static void SetIsEnabled(DependencyObject obj, bool value)
    {
        obj.SetValue(IsEnabledProperty, value);
    }

    static void ue_PreviewKeyDown(object sender, System.Windows.Input.KeyEventArgs e)
    {
        var ue = e.OriginalSource as FrameworkElement;

        if (e.Key == Key.Enter)
        {
            e.Handled = true;
            ue.MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
        }
    }

    private static void ue_Unloaded(object sender, RoutedEventArgs e)
    {
        var ue = sender as FrameworkElement;
        if (ue == null) return;

        ue.Unloaded -= ue_Unloaded;
        ue.PreviewKeyDown -= ue_PreviewKeyDown;
    }

    public static readonly DependencyProperty IsEnabledProperty =
        DependencyProperty.RegisterAttached("IsEnabled", typeof(bool),

        typeof(EnterKeyTraversal), new UIPropertyMetadata(false, IsEnabledChanged));

    static void IsEnabledChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var ue = d as FrameworkElement;
        if (ue == null) return;

        if ((bool)e.NewValue)
        {
            ue.Unloaded += ue_Unloaded;
            ue.PreviewKeyDown += ue_PreviewKeyDown;
        }
        else
        {
            ue.PreviewKeyDown -= ue_PreviewKeyDown;
        }
    }
} 
```

# java - 是否可以在事务中使用多个持久性单元，而不是 XA？

> ID：871625
> 
> 赞同：3
> 
> 时间：2009-05-16T03:31:00.903
> 
> 标签：java, hibernate, jpa, transactions, jta

我们的应用程序需要使用（只读）几个指向不同数据库（不同的商业供应商）的不同持久性单元。

我们没有预算在其中之一（Sybase）上启用 2pc。有没有办法在事务中使用它们而不必是 XA 事务？

我们使用 Websphere 6.1、Sybase 12.5.3、Oracle 10g、Java EE 5 和带有 Hibernate Entity Manager 的 JPA。

**更新：** oracle PU 每月很少更新 1 或 2 次，sybase PU 更新非常频繁——每天很多次。隔离绝对是后者的关注点，两者之间的一致性没有必要强制执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T10:43:41.830

小心。
只读并不总是意味着 2PC 不适用。如果您有两个数据库，并且都读取了两个数据库但只更新了一个，那么您需要一个事务来保证一致的结果。假设您有一个场景，您读取数据库 A，然后使用这些结果来读取和更新数据库 B。如果您无法对数据库 A 使用事务，那么当您的操作处于活动状态时，您读取的数据可能数据库 A 可以被另一个应用程序*读取和更新。*在这种情况下，您可能会在数据库 B 中获得不一致的数据。

如果您确实同时读取了两个数据库并且都不更新，那么您可能再次认为分布式事务及其伴随的锁定是不必要的。再一次，也许不是。在这种情况下，如果其他应用程序正在更新相同的数据库，您也可能会得到不一致的读取。这取决于您的要求和数据库的其他用户。

我建议[阅读隔离级别](http://www.oracle.com/technology/oramag/oracle/05-nov/o65asktom.html)，以深入了解适用于所有持久存储（如数据库）的锁定，即使在读取操作期间也是如此。事务锁定可能是不必要的；例如，如果您正在处理实际上不会改变的数据（*任何*应用程序都没有写入），则没有必要。

也许这里有一个商业解决方案 - 与您的供应商协商以降低 XA 启用的价格，并支付它。随着经济的发展，你可能会得到一笔你能负担得起的交易。旁注：我很惊讶您可以许可数据库而不获取交易。我不知道以这种方式许可 Sybase 是可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T20:21:34.020

[Atomikos TransactionsEssentials](http://www.atomikos.com/Main/TransactionsEssentials)是一个免费的开源 JTA/XA，带有用于 JDBC（和 JMS）的连接池。

它的功能之一是增加了对非 xa 数据源的支持。如果只读（您的情况），使用我们的非 xa 数据源将您的 Sybase 包含到 JTA 事务中是安全且容易的。

最好的家伙

# java - 面向 Java 初学者的免费视频播客/教程

> ID：871637
> 
> 赞同：4
> 
> 时间：2009-05-16T03:40:49.540
> 
> 标签：java, podcast

Java 和 J2ME 的视频教程/播客有哪些？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T03:52:57.187

[我通常发现Parley's](http://www.parleys.com/display/PARLEYS/Home)或[InfoQ](http://www.infoq.com/)的播客很有帮助。来自 Joshua Bloch 或 Neal Gafter 的任何东西（即使他们不同意关闭）都具有一流的质量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-30T16:01:33.907

斯坦福的 YouTube 频道有一个非常好的 Java 入门课程：

*[编程方法论 (CS106A)](http://www.youtube.com/view_play_list?p=84A56BC7F4A1F852)*

其他视频教程

*   [http://www.javaomatic.com/](http://www.javaomatic.com/)
*   [http://www.javavideotutes.com/index/lessons/](http://www.javavideotutes.com/index/lessons/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T04:06:59.820

我从未见过只针对“教 Java”的人，但我认为这是一个好主意。

在您在这里评估答案后，请发布满足您需求的内容和缺少的内容。我一直认为做一个视频播客会很有趣，你从简单的语法开始，经历 OO 设计、重构、模式等。基本上只是在播客中教授核心 Java。

如果这就是您所追求的，但您没有找到它，请务必回复此消息。这是我考虑过的一个播客——多年来我一直在考虑这样做，我只是不确定它是否有价值。

如果您想了解一般的 Java 信息​​——JavaPossee 很不错。

# c++ - Windows 中的 Eclipse Ganymede 和 MinGW

> ID：871644
> 
> 赞同：2
> 
> 时间：2009-05-16T03:48:28.427
> 
> 标签：c++, windows, eclipse, mingw

我试图让 eclipse 与 MinGW 一起工作。我做了以下事情：

*   为 Eclipse 下载了 CDT。
*   安装了 MinGW。
*   将 C:\MinGW\bin 添加到我的路径中。
    打开命令提示符（CMD）并输入 g++ 或类似的工作正常。
*   我运行 eclipse，创建一个“新 C++ 项目”，然后只得到“其他工具链”的选项。

那里有一**百万**个教程说 eclipse 应该自己识别 MinGW。它没有，我不知道该怎么办。我已经尝试在几乎所有可能的订单中重新安装所有内容。仍然没有运气。

我还注意到一些教程提到了有关创建“托管 C++ 项目”的内容。我没有这样的选择，我得到的只是“C++ 项目”和“C 项目”

编辑：我有 eclipse ganymede，windows x86_64，版本 3.4.2
[http://download.eclipse.org/eclipse/downloads/drops/R-3.4.2-200902111700/index.php](http://download.eclipse.org/eclipse/downloads/drops/R-3.4.2-200902111700/index.php)

运行“C/C++ 开发人员的 Eclipse IDE”失败，因为 Windows 没有 x64 版本。x86版本也需要安装x86 JAVA，而且安装两个版本的java，过去只给麻烦。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T09:33:40.610

在 Ganymede 中设置 MinGW 的说明位于[此处](http://help.eclipse.org/ganymede/topic/org.eclipse.cdt.doc.user/concepts/cdt_c_before_you_begin.htm)。

> 以下是有关如何安装当前版本的 MinGW 的说明和链接。请注意，随着新版本的 MinGW 组件的引入，这些链接可能会随着时间的推移变得不准确。请查看 MinGW 文件发布部分以获取最新版本。
> 
> 1.  下载并运行 MinGW 安装程序 MinGW-5.1.3.exe。
> 2.  选择下载并安装 MinGW 基础工具和 g++ 编译器。您可以选择这些工具的当前或候选版本。您也可以安装任何其他可用的编译器。
>     
>     
>     
>     不要安装 MinGW Make 功能，因为步骤 5 中的 MSYS 版本是更完整的 make 实现。
>     
>     
> 3.  MinGW 安装程序当前不安装 gdb 调试器。要安装调试器，请从以下位置下载文件：gdb-6.6.tar.bz2
> 4.  将文件 gdb-6.6.tar.bz2 的内容提取到安装 MinGW 的相同位置。
> 5.  如果要使用 Makefile 项目，请从以下位置下载并运行安装程序：MSYS-1.0.10.exe。MSYS 提供了 make 和相关命令行工具的实现。对于其他类型的带有 MinGW 工具链的项目，这不是必需的，它们使用 CDT 的内部构建工具来执行构建。

按照这个过程解决了我遇到的任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-27T15:38:58.283

我对 Eclipse Galileo 和 CDT 6.0.1 有同样的问题。事实证明，CDT 只有在位于 c:\mingw 下时才识别 MinGW。我在 c:\msys\mingw 中有它，所以这就是问题所在。在我改变后一切正常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T08:21:08.477

我认为在 CDT 4.x 中删除了托管 make 项目和 makefile 项目之间的区别。现在只有一种类型的项目，但您可以选择不同的构建器。CDT 包括一个不使用makefile 的内部构建器和另一个使用makefile 的内部构建器。

首先，省去“按每个可能的顺序重新安装”的工作量。这也被称为试错法，只会让你更加沮丧。应用您作为程序员所拥有的正常问题解决技能。

鉴于您已经安装了 MinGW，如果您下载“[面向 C/C++ 开发人员的 Eclipse IDE](http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/ganymede/SR2/eclipse-cpp-ganymede-SR2-win32.zip) ”，启动 eclipse.exe，并尝试使用 MinGW 工具链创建一个 C++ 项目，会发生什么情况？

编辑：请记住：获得此类问题帮助的**关键**是生成一个失败的**最小示例。**此外，如果您提供了已安装软件包（MinGW、Eclipse 等）的 URL，也会有所帮助。

[编辑：我刚刚使用 Ganymede 更新站点安装了 CDT，从这里](http://sourceforge.net/project/downloading.php?group_id=2435&filename=MinGW-5.1.4.exe&a=95543156)下载并安装了 MinGW ，然后重新启动了 Eclipse，一切正常。我知道这对您没有帮助，但它确实证明了工具链检测并没有完全破坏。你这边有些奇怪。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T23:22:24.877

你可以试试[Wascana Desktop Developer](http://wascana.sourceforge.net/)。它是专为在 Windows 上开发而配置的 Eclipse CDT 发行版。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T21:39:06.247

在我从 MinGW 中删除了一些未使用的文件/文件夹后，我遇到了同样的问题（即 Eclipse 在 PATH 上找不到 MinGW）。它大约为 600 MB，我的任务是在添加到源代码控制之前对其进行修剪。我把它降低到一个可行的~200 MB。之后当我尝试重新创建 Eclipse 工作区时，MinGW 从可用的工具链中消失了。在我将原始 MinGW 安装放在路径上后，它再次出现。

高温高压

# debugging - 我需要在我的用户态代码中找到使我的内核崩溃的点

> ID：871649
> 
> 赞同：0
> 
> 时间：2009-05-16T03:53:19.447
> 
> 标签：debugging, gdb

我有一个大系统，使我的系统很难崩溃。当我启动时，我什至没有核心转储。如果我记录在我的系统出现故障之前执行的每一行。我会找到那个邪恶的代码。

我可以将 GDB 中的每个源代码行记录到文件中吗？

更新：

好的，我发现了错误。这很糟糕。我启动的应用程序没有关闭系统。在了解了使用 mdb 进行 coredump 检查和一些 gdb 步进之后，我发现导致转储的系统调用没有实现。将系统更新到最新内核将解决我的问题。感谢大家。

我的教训：

确保您知道导致核心转储的过程。它并不总是你开始的那个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T04:04:41.697

听起来像一个棘手的小问题。

我经常尝试通过注释掉大块代码，将系统配置为不运行某些部分（如果它允许你这样做）等来尽可能多地消除可能的嫌疑人。这相当于在问题，并且是一种相对快速地放大违规代码的令人惊讶的有效方法。

日志记录的一个潜在问题是在系统锁定之前日志可能不会命中磁盘 - 如果您没有获得核心转储，您可能无法获得日志。

说到核心转储，请确保您的核心转储大小没有限制（man ulimit。）

您可以尝试使用 objdump 获取代码中所有函数的列表，对其进行一点处理并在这些函数上创建一堆 GDB 跟踪语句 - 基本上是自动创建 GDB 脚本。如果这被证明是多余的，那么使用跟踪点对代码进行二进制搜索也可以帮助您放大问题。

不要惊慌。你比虫子更聪明——你会发现它的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-17T03:21:57.017

您无法使用 GDB 合理地跟踪源代码的每一行（太慢）。此外，系统崩溃很可能是系统调用的结果，而 libc 可能正在代表您进行系统调用。即使您找到导致操作系统崩溃的应用程序行，您仍然什么都不知道。

您应该首先澄清哪个操作系统正在崩溃。对于 Linux，您可以尝试以下方法：

```
strace -fo trace.out /path/to/app 
```

重新启动后，trace.out 将包含应用程序在崩溃前正在执行的系统调用。如果你幸运的话，你会看到最后的死亡系统调用，但我不会指望它。

或者，尝试在[用户模式 ​​Linux](http://user-mode-linux.sourceforge.net/)或编译[KGDB的内核上重现崩溃。](http://kgdb.linsyssoft.com/)

这些将告诉您内核中的问题出在哪里。在您的应用程序中找到匹配的系统调用可能很简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T05:46:16.693

请澄清您的问题：系统的哪个部分崩溃了？

是应用程序吗？如果是这样，哪个应用程序？这是您自己编写的应用程序吗？这是您从其他地方获得的应用程序吗？如果您使用调试器，您可以获得干净的中断吗？您能否获得一个回溯，显示哪些函数正在调用崩溃的代码部分？

它是一个新的硬件驱动程序吗？它是基于旧驱动程序的吗？如果是这样，发生了什么变化？它是基于制造商的数据表吗？该数据表是最新且最正确的吗？

它在内核中的某个地方吗？哪个内核？

什么是操作系统？我假设它是 linux，看到您使用的是 GNU 调试器。但当然，不一定如此。

你说你没有核心转储。您是否在您的机器上启用了核心转储？如今，大多数系统默认情况下都没有启用核心转储。

关于记录 GDB 输出，您可能取得了一些成功，但这取决于问题出在哪里，您是否会在系统崩溃之前记录正确的输出。写入磁盘有很多延迟。您可能无法及时捕捉到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T04:14:08.350

我不熟悉执行此操作的 gdb 方式，但使用 windbg 的方法是将调试器连接到内核并通过第二个调试器的串行电缆（或火线）远程控制调试器。我很确定 gdb 具有类似的功能，我可以在这里快速找到一些提示：[http ://www.digipedia.pl/man/gdb.4.html](http://www.digipedia.pl/man/gdb.4.html)

# asp.net - 开发不依赖于 JavaScript 的 ASP.NET 应用程序的技巧

> ID：871650
> 
> 赞同：5
> 
> 时间：2009-05-16T03:54:13.657
> 
> 标签：asp.net, javascript

不确定这是否属于社区维基...

有人可以就如何成功构建不依赖于 JavaScript 的 ASP.NET 网站提供一些一般性指导吗？我的理解是，我最初应该在没有 JavaScript 的情况下构建一个功能性网站，并使用它来增强用户体验。说起来容易做起来难......我如何确保我的网站在没有 JavaScript 的情况下工作，除非禁用 JavaScript 并尝试它？或者这是经验带来的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T07:57:19.377

试试 ASP.NET MVC！确保大多数示例使用 JavaScript 来实现 AJAX 功能，但是很容易构建一个不使用 JavaScript 的功能齐全的网站。

由于 ASP.NET MVC 不使用所有嵌入 JavaScript 的服务器控件，因此它是构建具有极少和轻量级 HTML 的站点的好方法，同时仍使用 C#、VB.NET 或任何语言编写数据访问和业务逻辑其他 .NET 语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T04:04:17.970

如果您想使用许多 ASP.NET 控件（即 DataGridView），则使用大量 JavaScript 生成 ASP.NET 页面以处理控件上的事件（即在 DataGridView 中选择一行）。我认为您将失去很多 ASP.NET，以至于在不启用 JavaScript 的情况下尝试让 ASP.NET 工作是不切实际的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T04:10:10.030

禁用 Javascript 是测试网站在没有它的情况下如何运行的最佳方法。好消息，IE8 的开发人员工具提供了一种快速简便的方法来做到这一点。现在，话虽如此，通常您唯一能做的就是发布带有 noscript 标签的消息，以表明您的网站需要 javascript 才能获得最佳功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T04:32:17.417

禁用 JavaScript 后，许多 ASP.NET 功能和控件将无法工作。想想 LinkBut​​ton 的 onclick 事件，它包含对 JavaScript 函数的调用。

LinkBut​​ton 只是一个例子。但是还有很多其他的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-12T06:25:32.740

我已经用很少或没有 JavaScript 构建了可工作的 ASP.Net 站点，所以这绝对是可能的（只是一个皇家痛苦。）诀窍，这听起来很傻，是尽可能少地使用`<ASP:>`类型标签。这些都产生了不同级别的 JavaScript。常规的老式 HTML 元素无需编写脚本即可正常工作。

因此，在极端情况下，您可以使用所有普通 HTML 元素编写表单，然后将该表单提交点放在另一个页面上，该页面接受表单提交并将其交给您的服务器端脚本。

换句话说，假设您使用 ASP.NET 获得的只是一种时髦的服务器端编程语言，而您正在编写 1998 年的 HTML。

现在，完成了这个，我可以告诉你，这最终是一个具有更简洁编程语法的经典 ASP 网页。;) 使 ASP.NET 比经典 ASP“更好”的大多数功能都依赖于 JavaScript，因此编写一个无 JavaScript 的 ASP.NET 系统是一种反复射击自己的练习。

但是，您绝对应该做的一件事是确保第一页或第二页在没有 JavaScript 的情况下也能正常工作。与 10 年前不同，您可以放心地假设访问您页面的任何浏览器都有 JavaScript，并且与大约 8 年前不同，您的访问者可能出于速度原因没有关闭 JavaScript，*但是*他们很可能有类似 Firefox 的 NoScript 插件一直拨到 11。因此，您的前几页需要运行良好，以便 a) 告诉新访问者他们需要 JavaScript，并且 b) 仍然可以查看和工作足以让它看起来像将您的网站添加到白名单是值得的。（根据我的经验，大多数人完成了第一个，但是以这样的方式完全放弃了第二个。换句话说 - 如果你的超级花哨的 web 2.0 大型网站开始看起来像 craigslist 如果 noScript 被解雇起来，我可能不会费心让你在我的机器上运行脚本。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T04:13:45.420

如果您担心 JavaScript 在用户浏览器中被禁用，那么您可以检查并相应地处理您的网站。

如果您决定在没有 JavaScript 的情况下构建站点，那么您最终将构建一个有点静态的网站。如果您的需要只是建立一个静态网站，那么您可以继续使用这种方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T04:31:53.893

使用基本的 html 表单和 css 编写所有内容，然后您就会知道它可以在没有 javascript 的情况下工作。

一旦你对它感到满意，然后看看不显眼的 javascript，这样你就可以在启用 javascript 时修改应用程序的工作方式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-12T06:40:37.667

上次我查看了一些关于 1% 禁用 JavaScript 的统计数据，那么当你应该做的是显示一条消息告诉用户你的网站需要 javascript 时，为什么要花费数小时和数小时。

利用你的时间来提高工作效率，而不是试图围绕感知的限制进行写作。

# .net - 带有 .Net 1.1 的 Hudson 持续集成服务器

> ID：871660
> 
> 赞同：2
> 
> 时间：2009-05-16T04:03:39.233
> 
> 标签：.net, msbuild, continuous-integration, hudson, msbee

有没有人成功使用 hudson 构建 .Net 1.1 项目？如果可以，能否分享一下配置。我遇到了麻烦。

Hudson 使用随 .Net 2.0 引入的 MSBuild。我找到**[了 MSBee](http://www.codeplex.com/MSBee)**，它是 1.1 的 MSBuild 工具包，但到目前为止我还没有让它与 Hudson 一起使用。安装 MSBee 后，我将 Hudson 指向 2.0 MSbuild，并尝试了以下参数（除其他外）

```
/t:Rebuild /p:TargetFX1_1=true 

/p:TargetFX1_1=true /p:CustomAfterMicrosoftCommonTargets=D\SCM\MSBuild\MSBee\MSBuildExtras.Fx1_1.CSharp.targets 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T14:40:49.297

我将 NAnt 用于 1.1 项目，这对我来说比 MSBuild 更易于集成。你有一个哈德逊[插件](http://wiki.hudson-ci.org/display/HUDSON/NAnt+Plugin)。

# c++ - 为什么在向量循环中使用 '!=" 比使用 '<' 更好？ (C++)

> ID：871666
> 
> 赞同：10
> 
> 时间：2009-05-16T04:07:26.980
> 
> 标签：c++, vector, loops

为什么在向量循环中使用 '!=" 比使用 '<' 更好？我只是看不出有什么区别。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-16T04:11:24.240

因为您使用的是迭代器，它会使循环看起来与其他容器完全相同，如果您选择切换到其他容器类型，例如 set、list、unordered_set 等，其中 < 没有任何意义。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-16T04:16:38.720

我假设你的意思是使用`!=vector.end()`而不是`<vector.size()`你的问题并不清楚。

更喜欢 end() 版本的一个原因是，您真正想要做的是检查您是否到达了结尾。

在 C 中对数组进行这种检查的习惯用法是检查索引与大小的比较，但这是一种“遗留”行为。In 随后在 Java 世界中传播（如 < `array.length`），直到人们意识到数组是邪恶的并且 Java 最终支持泛型。然而，在 C++ 中，当您有一个很好的集合类（例如 vector）可以使用时，没有理由使用这个习惯用法。它更具可读性和可维护性。例如，如果需要，它可以更轻松地切换到其他集合，因为您仍在谈论结尾。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-16T04:15:24.713

一些迭代器类型不支持小于运算符——它们只支持不等运算符。这就是为什么您经常会看到小于运算符被遗弃的原因。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-16T05:39:04.980

一般来说，我喜欢将这样的代码放在类似于 STL 算法的模板函数中，这样它们就可以不知道底层容器是什么。

由于 < 仅对向量有意义，因此它不适合泛型函数。如果您使用 <，则您将自己锁定在使用向量中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-16T04:40:52.313

可能是程序员记住了一个防御性编码技巧：如果在循环执行期间出现问题，并且索引/指针/迭代器超出了结尾，则循环将在检查“<”时安静地停止，而不会注意到错误。使用 != 可能会出现混乱和崩溃，因为循环继续处理不良数据，从而允许更早的修复。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-16T04:14:19.427

对于向量迭代器，它没有任何区别。一般来说，迭代器可能不支持 '<' 只是 '==' 和 '!='。因此，测试您是否尚未到达集合末尾的最通用方法是检查迭代器是否 != container.end()

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-16T04:48:02.683

另一个原因：当翻译成程序集时，分支相等或分支不相等通常比比较分支快得多*。*

# c++ - Loading image into an array

> ID：871667
> 
> 赞同：-1
> 
> 时间：2009-05-16T04:08:52.887
> 
> 标签：c++, playstation-portable

How would I load certain images into an array set like

```
Map = ( ( 1, 1, 1 ), ( 2, 2, 2 ), ( 3, 3, 3 ) ) 
```

I can put

images into variables like so

one = oslLoadImageFile("one.png", OSL_IN_RAM, OSL_PF_5551);

so whould I be able to do something like Map = ( ( one, one, one ) )

and if each image was 32x32 would it be able to be side by side rather then a pixal ahead

Sorry im still learning and trying to go over some basics in my hea

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-11T14:25:26.863

似乎是您使用 C++ [OldSchool Library](http://oslib.playeradvance.org) for PSP。根据其[文档](http://oslib.playeradvance.org/doku.php?id=day8#day_8_display_maps)，您应该创建一个包含一组图像的图像文件，然后您就可以使用它创建地图。

```
//definition of the pointers towards our image
OSL_IMAGE *Zora_tileset;

//definition of the pointers towards our map
OSL_MAP *zora;

 Zora_tileset = oslLoadImageFile("tileset.png", OSL_IN_RAM, OSL_PF_5551);

 //check
 if (!Zora_tileset)
  oslDebug("Check if all the files are copied in the game folder.");

 //configuration of the map
 zora = oslCreateMap(
  Zora_tileset,     //Tileset
  Zora_map,     //Map
  16,16,      //Size of tiles
  64,65,      //Size of Map
  OSL_MF_U16);     //Format of Map 
```

[看起来这个库的用途非常有限，在它的论坛](http://www.playeradvance.org/forum/forumdisplay.php?f=58)上提问是个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T01:16:43.990

听起来您想为 2D 游戏构建平铺地图。在这种情况下，您可能希望拥有一个包含所有图块的精灵。然后地图将包含特定图块的索引。

在绘制图块时，您将根据图块索引复制部分精灵。

如果您有一个精灵图像，其索引如下：

```
+---+---+---+---+
| 0 | 1 | 2 | 3 |
+---+---+---+---+
| 4 | 5 | 6 | 7 |
+---+---+---+---+
| 8 | 9 |
+---+---+ 
```

您可以使用类似这样的方法来计算要为每个图块索引复制的矩形：

```
const int TILE_SIZE = 32;
const int TILES_PER_ROW = 10;

int xCoordinate = TILE_SIZE * (tileIndex % TILES_PER_ROW);
int yCoordinate = TILE_SIZE * (tileIndex / 10);

Draw(tileSet, xCoordinate, yCoordinate, TILE_SIZE, TILE_SIZE); 
```

# jquery - 为什么这个 JQuery 函数在 FF 中不起作用？

> ID：871678
> 
> 赞同：0
> 
> 时间：2009-05-16T04:14:33.733
> 
> 标签：jquery, firefox

以下 JQuery 函数不能完全正常工作。IE 7 处理这两个警报，但 FF 3.0.10 只触发第一个警报。我做错了什么？

```
function submitClick() {
    var submitButton = '#<%=SubmitButton.ClientID%>';
    alert('got here');

    $(submitButton).click(function() {
        alert('got here too');
        $.blockUI({ message: $('#process-message') });
    });
} 
```

另外，我调用了 alert($(submitButton)); 这确实在FF中返回了一个“对象对象”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T04:38:54.750

你似乎并没有在那里做你认为你正在做的事情。

您实际上在做的是在 submitClick() 方法中，您将单击事件处理程序添加到按钮。但是您没有调用该处理程序。在您实际单击按钮之前，不会发生这种情况。

您是否尝试以编程方式单击该按钮？如果是这样，你没有这样做。这将单击按钮：

```
function submitClick() {
    var submitButton = '#<%=SubmitButton.ClientID%>';
    alert('got here');

    $(submitButton).click();
    alert('got here too');
    $.blockUI({ message: $('#process-message') });
} 
```

# .net - 是否有用于解析相关网址的 .net 库？

> ID：871681
> 
> 赞同：3
> 
> 时间：2009-05-16T04:14:43.857
> 
> 标签：.net, url, parsing, relative-path

我正在编写一个搜索引擎（为什么不呢？）并且需要处理导航相对 url，例如“../about.aspx”、“/about.aspx”、“about.aspx”等

那里或.Net 库中是否有任何东西可以将这些转换为绝对地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T04:18:40.977

看一下[System.Uri](http://msdn.microsoft.com/en-us/library/system.uri.aspx)类、[System.UriBuilder](http://msdn.microsoft.com/en-us/library/system.uribuilder.aspx)类和[System.HttpStyleUriParser](http://msdn.microsoft.com/en-us/library/system.httpstyleuriparser.aspx)类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T18:16:11.587

是的，您可以使用`system.uri`.

# c# - 如何从数组中唯一地获取元素

> ID：871689
> 
> 赞同：0
> 
> 时间：2009-05-16T04:20:12.143
> 
> 标签：c#

如何从数组中唯一地获取元素

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T04:48:40.890

```
using System.Linq;
class Program
{
   static void Main()
   {
      var array = new int[] { 1, 2, 2, 3 };
      var distinctArray = array.Distinct().ToArray();
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T04:47:32.623

使用 LINQ 可以轻松解决您的问题：

```
class Program
{
    static string[] ar = new[] { "a", "b", "c", "d", "a", "a", "f", "g",  
        "d", "i", "j", "a","d", "c", "g" };

    static void Main(string[] args)
    {
        var dist = (from a in ar select a).Distinct();// distinct;
        foreach (var v in dist)
            Console.Write(v);
        Console.ReadLine();
    }
} 
```

它产生这个输出：

```
abcdfgij 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T04:25:43.080

```
GenericList.Distinct() 
```

# maven-2 - Maven插件无法加载类

> ID：871708
> 
> 赞同：18
> 
> 时间：2009-05-16T04:40:05.823
> 
> 标签：maven-2, maven-plugin

我正在尝试制作一个需要使用反射的 Maven 插件。我想要一个项目来运行插件，并给它一个项目中一个类的全名，插件会通过反射加载它以从中获取信息。

但是类加载器有些奇怪，因为当我使用它时找不到类

```
Class.forName("package.MyClass"); 
```

查看[“ *Maven 类加载指南*”](http://maven.apache.org/guides/mini/guide-maven-classloading.html)，我不太清楚我的插件的类加载器在不同项目中运行时是否可以访问该项目的类。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-19T14:44:31.617

我确信有更好的方法，但这是我如何让它工作的：

在 mojo 顶部的 javadoc 中添加以下内容：@requiresDependencyResolution 运行时

添加一个 MavenProject 参数：

```
/**
 * @parameter expression="${project}"
 * @required
 * @readonly
 */
private MavenProject project; 
```

然后你可以在运行时获取依赖，并制作你自己的类加载器：

```
List runtimeClasspathElements = project.getRuntimeClasspathElements();
URL[] runtimeUrls = new URL[runtimeClasspathElements.size()];
for (int i = 0; i < runtimeClasspathElements.size(); i++) {
  String element = (String) runtimeClasspathElements.get(i);
  runtimeUrls[i] = new File(element).toURI().toURL();
}
URLClassLoader newLoader = new URLClassLoader(runtimeUrls,
  Thread.currentThread().getContextClassLoader()); 
```

然后你可以使用这个新的类加载器来加载你的类：

```
Class bundle = newLoader.loadClass("package.MyClass"); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-02-07T13:02:25.433

您应该考虑使用它来将运行时类路径元素添加到当前类领域。（您可以使用`PluginDescriptor`检索类领域。

```
List<String> runtimeClasspathElements = project.getRuntimeClasspathElements();
ClassRealm realm = descriptor.getClassRealm();

for (String element : runtimeClasspathElements)
{
    File elementFile = new File(element);
    realm.addURL(elementFile.toURI().toURL());
} 
```

这对我来说非常有效！

正如戴夫所问，这是获得的方法`PluginDescriptor`：

```
/**
 * The plugin descriptor
 * 
 * @parameter default-value="${descriptor}"
 */
private PluginDescriptor descriptor; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-04T15:37:18.833

我今天遇到了这个确切的问题。上述建议对我不起作用，以为我会将我的解决方案提交到列表中。我使用了 HibernateExporter mojo 源，可以在以下位置查看： http: [//grepcode.com/file/repo1.maven.org/maven2/org.codehaus.mojo/hibernate3-maven-plugin/2.2/org/codehaus/mojo/ hibernate3/HibernateExporterMojo.java?av=f](http://grepcode.com/file/repo1.maven.org/maven2/org.codehaus.mojo/hibernate3-maven-plugin/2.2/org/codehaus/mojo/hibernate3/HibernateExporterMojo.java?av=f)

```
/**
 * @parameter expression="${project}"
 * @required
 * @readonly
 */
private MavenProject project;

private ClassLoader getClassLoader() throws MojoExecutionException
{
  try
  {
    List<String> classpathElements = project.getCompileClasspathElements();
    classpathElements.add(project.getBuild().getOutputDirectory() );
    classpathElements.add(project.getBuild().getTestOutputDirectory() );
    URL urls[] = new URL[classpathElements.size()];

    for ( int i = 0; i < classpathElements.size(); ++i )
    {
      urls[i] = new File( (String) classpathElements.get( i ) ).toURI().toURL();
    }
    return new URLClassLoader(urls, getClass().getClassLoader() );
  }
  catch (Exception e)//gotta catch em all
  {
    throw new MojoExecutionException("Couldn't create a classloader.", e);
  }
}

public void execute() throws MojoExecutionException
{
  ClassLoader oldClassLoader = Thread.currentThread().getContextClassLoader();
  Thread.currentThread().setContextClassLoader(getClassLoader());

   //... your code here ...
} 
```

还要确保您使用的是正确的 MavenProject 类。将此添加到您的 pom

```
<dependency>
  <groupId>org.apache.maven</groupId>
  <artifactId>maven-core</artifactId>
  <version>3.0.3</version>
</dependency>

<dependency>
  <groupId>org.apache.maven</groupId>
  <artifactId>maven-plugin-api</artifactId>
  <version>3.0.3</version>
</dependency> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-19T14:43:39.737

这对我和 maven3 可以将依赖项放入插件类路径中。

诀窍是使用@Component 注入 PluginDescriptor。否则将无法正确设置。

```
@Component
private MavenProject project;
@Component
private PluginDescriptor descriptor;

private void addDependenciesToClasspath(String artifactId) {
    for (Artifact artifact : project.getDependencyArtifacts()) {
        if (artifact.getArtifactId().equals(artifactId)) {
            try {
                final URL url = artifact.getFile().toURI().toURL();
                final ClassRealm realm = descriptor.getClassRealm();
                realm.addURL(url);
            }
            catch (MalformedURLException e) {
                throw new RuntimeException(e);
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-16T06:53:54.570

没关系，我们需要自己制作类 加载器[Custom Classloaders](http://maven.apache.org/guides/mini/guide-maven-classloading.html#4-custom-classloaders)

# asp.net - 将 JavaScript 对象数组传递给 PageMethod

> ID：871709
> 
> 赞同：3
> 
> 时间：2009-05-16T04:40:47.227
> 
> 标签：asp.net, javascript, pagemethods

情况如下：我想遍历带有输入控件的表，收集值，然后将它们提交到 ASP.NET`PageMethod`以将数据保存到数据库中。我已经弄清楚了所有集合，但收到一个错误，即字符串无法转换为`Dictionary<string, object>`.

所以我最终得到这样的东西被传递给具有以下签名的方法

```
[
{ 'id': '383840923', 'name': 'fred', 'car':'honda' },
{ 'id': '243', 'name': 'joe', 'car':'honda' },
{ 'id': '4323423', 'name': 'paul', 'car':'honda' },
{ 'id': '38384234230923', 'name': 'ted', 'car':'honda' },
]

public static bool SaveData(Dictionary<string, object>[] items) {...} 
```

我知道如果正确声明，我可以来回传递整个类对象，并且 ASP.NET 将为我处理转换，但我不需要传递整个类，只需要传递几个属性。

编辑：我正在使用 jQuery 将帖子发送回服务器。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T04:59:19.460

[如果您使用 DTO，ASP.NET AJAX 将自动为您反序列化](http://encosia.com/2009/04/07/using-complex-types-to-make-calling-services-less-complex/)。服务器端的类似内容将匹配您发送的 JSON 数组：

```
public class PeopleAndCarsDTO
{
  public int id { get; set; }
  public string name { get; set; }
  public string car { get; set; }
}

public static bool SaveData(List<PeopleAndCarsDTO> items) {...} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T05:14:46.317

我弄清楚了问题所在。在将其作为调用的一部分发送之前，我将数组用引号括起来，`$.ajax`因此它被视为字符串而不是数组。

```
$.ajax({
    type: "POST",
    url: "<%= Response.ApplyAppPathModifier(Request.Path) %>/UpdateAcademicItems",
    dataType: "json",
    contentType: "application/json; charset=utf-8",
    data: "{'items': **'**" + $.toJSON(items) + "**'**}",
    success: function(data) {
        if(false != data.d) {
            alert('we did it');
        } else {
            alert ('flop');
        }
    },
    error: function() {
        alert('Failed to save Program Items');
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T04:54:13.200

@Jared 传递的对象是一个 JSON 数组。您可以使用[**json sharp**](http://james.newtonking.com/projects/json-net.aspx)在服务器端对其进行处理。[**这**](http://www.nateirwin.net/2008/11/20/json-array-to-c-using-jsonnet/)是一篇关于将 json 数组转换为 C# 的好文章。

# windows - Can VS_VERSION_INFO be added to non-exe files?

> ID：871710
> 
> 赞同：2
> 
> 时间：2009-05-16T04:40:48.270
> 
> 标签：windows, visual-studio

My windows co-workers were asking me if I could modify my non-windows binary files such that when their "Properties" are examined under Windows, they could see a "Version" tab like that which would show for a Visual Studio compiled exe.

Specifically, I have some gzipped binary files and was wondering if I could modify them to satisfy this demand. If there's a better way, that would be fine, too.

Is there a way I could make my binaries appear to be exe files?

I tried simply appending the VS_VERSION_INFO block from notepad.exe to the end of one of my binaries in the hope that Windows scans for the block, but it didn't work.

I tried editing the other information regarding Author, Subject, Revision, etc. That doesn't modify the file, it just creates another data fork(what's the windows term?) for the file in NTFS.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-16T17:21:47.933

Windows 不支持它，因为每种文件类型都有自己的文件格式。但这并不意味着你不能完成它。存储在 dll 和 exe 中的资源是文件格式的一部分。

**向用户展示：**

如果您希望向用户显示此信息，最好使用属性页外壳扩展来完成。您将创建一个外观相似的页面，但它不会使用完全相同的页面。有一个[关于 shell 扩展的非常好的多部分教程](http://www.codeproject.com/KB/shell/shellextguide1.aspx)，包括以该链接开头的属性页。

**实际存储资源的位置：**

您可以将资源存储到同一文件上的单独[备用数据流中，而不是将块附加到文件中。](http://www.securityfocus.com/infocus/1822)这将使磁盘上的原始文件流未损坏，并且不会导致其主文件大小发生变化。

备用数据流允许多个数据流与一个文件名相关联。`:`每个流由文件名末尾的冒号和标识符标识。

例如，您可以通过以下方式创建它们：

> 记事本 test.txt:adsname1
> 记事本 test.txt:adsname2
> 记事本 test.txt

**让正常的 Win32 API 工作：**

如果您想要正常的 API 工作，您必须[拦截 Win32 API](http://www.codeproject.com/KB/system/hooksys.aspx)：LoadLibraryEx、FindResource、LoadResource 和 LockResource。不过，这可能不值得麻烦，因为您已经在创建自己的属性页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T04:57:03.053

Can't think of any way to do this short of a shell extension. The approach I've taken in the past is a separate "census" program that knows how to read version information from any kind of file.

Zip files can be converted into exe files by using a program that turns a zip file into a self-extracting zip (I know that WinZip does this, there are most likely free utilities for this also; [here's one that came up on a search](http://www.chilkatsoft.com/ChilkatSfx.asp) but I haven't actually tried it). Once you've got an exe, you should be able to use a tool like [Resource Hacker](http://www.angusj.com/resourcehacker/) to change the version information.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T04:59:53.827

它行不通。要么 Windows 必须知道每种文件格式，要么如果附加了版本信息，文件格式不会受到干扰。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T05:16:41.523

不，资源部分只能在[PE](http://en.wikipedia.org/wiki/Portable_Executable)（便携式可执行文件；exe、dll、sys）中使用。
不仅仅是将数据放入文件中，您还有一个指向文件头中数据的表。

如果您有 NTFS 驱动器，您可以做的是使用[NTFS 流来存储自定义属性](http://www.forensicfocus.com/dissecting-ntfs-hidden-streams)，这样二进制文件的联系人将保持不变，但您需要使用自定义 shell 扩展来显示流的内容。

# struts2 - struts2：在jsp中访问动作类的getter而不创建对象

> ID：871714
> 
> 赞同：0
> 
> 时间：2009-05-16T04:41:24.697
> 
> 标签：struts2

我正在研究struts2。在我的动作类中，我编写了一些访问器（setter-getter）。现在，假设这个动作类正在返回 SUCCESS，并且在 struts.xml 中，我针对结果“SUCCESS”打开了一个 jsp 页面（比如 abc.jsp）。我需要在动作类中编写的所有getter 方法的值，而无需在我的jsp（即abc.jsp）中创建动作类的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T05:25:31.440

如果您的控制器具有 getPostalCode 属性，您可以执行以下操作：

```
<s:textfield name="postalCode"/> 
```

这会将值绑定到控制器字段。外面的s:标签也可以用jsp-el；表达式 ${postalCode} 也会这样做。阅读[本文档](http://struts.apache.org/2.0.14/docs/tag-syntax.html)

# objective-c - 保存对 UITableViewCell 的引用

> ID：871728
> 
> 赞同：0
> 
> 时间：2009-05-16T04:55:28.127
> 
> 标签：objective-c, iphone, cocoa-touch, uitableview

我在 tableview 中有 5 个单元格都是自定义的。意思是，我创建了一个带有 tableviewcell 的 xib 并创建了一个相应的 cellController。xib 有两个名为 name 和 size 的标签。用户点击一行，触发 didSelectRowAtIndexPath。从那里开始一个计时器。在某些时候，计时器结束。在这里，我需要将文本分配给所选单元格的名称标签。如何获取选定的单元格引用并保留它以进行分配？或者，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T05:24:13.923

UITableView 实例方法

```
-(UITableViewCell*) cellForRowAtIndexPath: (NSIndexPath*)indexPath 
```

将允许您获得指向单元格的指针。

只需存储 didSelectRowAtIndexPath 事件的 NSIndexPath 参数中的行+部分信息。然后，当计时器结束时，构建一个新的 NSIndexPath 并调用 cellForRowAtIndexPath。如果单元格不再可见，也要准备好返回 nil 。

# eclipse - 在 Eclipse / Aptana 中关闭工具提示

> ID：871732
> 
> 赞同：16
> 
> 时间：2009-05-16T04:58:47.713
> 
> 标签：eclipse

我不知道是否有人注意到 Eclipse 有这个烦人的特性，它需要在悬停任何东西时显示一个无用的工具提示。

我想知道是否有人知道一种完全杀死 Eclipse / Aptana 中所有工具提示行为的方法？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-15T00:53:12.670

我在 Window > Preferences > Pydev > Editor > Hovers 中找到了我的

看起来它是模块级功能（Java、Pydev、C++），而不是平台级（Eclipse 本身）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-16T08:09:35.290

窗口 > 首选项 > Java > 编辑器 > 悬停

禁用组合悬停。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-07-15T00:48:50.043

我同意，提示可能真的很烦人，但有时它们可​​以成为一个非常有用的快速参考 - 例如在调试期间查找 var 值，或方法所需的参数类型等。

因此，我没有完全禁用它们，或者通过首选项不断启用/禁用，而是转到窗口 > 首选项 > Java > 编辑器 > 悬停 > 组合悬停，并**在悬停下方字段时将 Alt 添加到按下键修饰符**。

这样，如果您想快速查看提示，只需按住 Alt 键即可。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-02T20:27:12.490

我对 Aptana 在我的代码上的提示工具文本感到非常恼火。我想出了如何禁用它：

**Window > Preferences > Aptana Studio > Content Assist > Show information on hover > Off**

我正在使用 Aptana 3。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-11-09T10:39:01.553

在 Eclipse 上真正让我烦恼的另一件事是左侧的灯泡隐藏了断点，而且真的没用。

要抑制这些，请转到 windows>preference>java>editor，然后取消选中“Lightbulk for quick assistants”。

如果您的 Eclipse 版本中没有此功能，请尝试使用“灯泡”进行帮助搜索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-03T15:30:34.507

这就是答案。更改 Windows 注册表。HKEY_CURRENT_USER ->Control Panel -> Mouse -> mouse -> MouseHoverTime 将其值更改为 400（延迟 4 秒）

[http://untamedmind.wordpress.com/2008/11/08/changeing-the-mousehovertime-add-delay-on-the-tooltips-pop-up/](http://untamedmind.wordpress.com/2008/11/08/changing-the-mousehovertime-add-delay-on-the-tooltips-pop-up/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-16T06:58:49.203

在 Mouse > Hover 下查找 TweakUI 设置。尽量减少敏感度并增加时间，在大多数情况下，你会没事的。

请注意，这是在 windows 下。无论如何，搜索“悬停”，您应该能够找到正确的位置。祝你好运！

# haskell - 这是编写 Haskell foldr 函数的正确方法吗？

> ID：871745
> 
> 赞同：1
> 
> 时间：2009-05-16T05:11:57.230
> 
> 标签：haskell, fold, combinators

我在[YAHT 的 Recursive Datatype](http://en.wikibooks.org/wiki/Haskell/YAHT/Type_basics#Recursive_Datatypes)部分做练习，发现编写`listFoldr`函数有点挑战性（主要是因为我一开始并没有真正理解和之间的区别`foldl`）`foldr`。当我最终确切地意识到该`foldr`函数是如何工作的时，我决定只需简单地交换函数参数即可将我`listFoldl`的函数更改为`listFoldr`函数：

```
listFoldl f i [] = i
listFoldl f i (x:xs) = listFoldl f (f i x) xs

listFoldr f i [] = i
listFoldr f i (x:xs) = listFoldr f (f x i) xs 
```

这似乎有效（我做了比这更多的测试）：

```
Main> foldr (-) 4 [1, 2, 3]
-2
Main> listFoldr (-) 4 [1, 2, 3]
-2 
```

但是为练习给出的[解决方案与我的大不相同。](http://en.wikibooks.org/wiki/Haskell/YAHT/Type_basics/Solutions#Recursive_Datatypes)他们`listFoldl`和我的完全一样，但是看看他们的`listFoldr`：

```
listFoldr f i [] = i
listFoldr f i (x:xs) = f x (listFoldr f i xs) 
```

哪种解决方案更好，我的还是他们的？其中之一不正确吗？（在我的测试中，它们最终都得到完全相同的结果......）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T05:35:28.950

您的解决方案绝对不正确。您已经简单地实现了 a `foldl`，其中函数`f`以相反的顺序接受参数。例如，什么是错误的，`foldr (:) []`应该是列表上的识别函数，但您的函数反转列表。您的函数 not 的原因还有很多`foldr`，例如`foldr`在无限列表上的工作方式而您的不工作。在您的示例中它们相同纯属巧合，因为`3 - (2 - (1 - 4)) == 1 - (2 - (3 - 4))`. 我认为你应该从头开始，看看`foldr`应该如何工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T05:21:11.637

我认为你正在以“相反的顺序”处理元素，所以你的不正确。

您应该能够通过“顺序很重要”的示例来证明这一点。例如，像

```
listfoldr f "" ["a", "b", "c"] 
```

其中'f'是一个函数

```
f s1 s2 = "now processing f(" @ s1 @ "," @ s2 @ ")\n" 
```

其中 '@' 是一个字符串附加运算符（我忘记了它在 Haskell 中的含义）。重点只是“检测”该函数，以便您可以查看使用各种参数调用它的顺序。

（请注意，这没有出现在您的示例中，因为数学“4-1-2-3”产生与“4-3-2-1”相同的答案。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-16T05:27:05.307

你的坏了。尝试使用不会以单个数字结果结尾的东西。

```
eg: listFoldr (++) "a" ["b", "c", "d"] 
```

你正在处理错误的方向。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T14:39:27.240

在列表中`[x1, x2, ..., xk]`，您的`listFoldr`计算机

```
 f xk (... (f x2 (f x1 i)) ...) 
```

而`foldr`应该计算

```
 f x1 (f x2 (... (f xk i) ...)) 
```

（相比之下，`foldl`计算

```
f (... (f (f i x1) x2) ...) xk 
```

本质上，`listFoldr f = foldl (flip f)`.)

你的测试用例很不幸，因为

```
3 - (2 - (1 - 4)) = 1 - (2  - (3 - 4)) 
```

当你在测试这样的函数时，一定要传入一个`f`非交换和非关联的（即，参数和应用程序顺序很重要），这样你就可以确保表达式被正确评估。当然，减法是非交换和非关联的，你只是运气不好。

# php - 启动和关闭 PHP 语句的“正确”方式是什么？

> ID：871755
> 
> 赞同：5
> 
> 时间：2009-05-16T05:18:57.900
> 
> 标签：php

以下 PHP 变体是否存在任何差异或相关风险？

```
<? echo "hello world!"; ?>

<?php echo "hello world!"; ?>

<?="hello world!"?> 
```

另外，是否有必要关闭所有脚本`?>`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-16T05:21:51.870

不同之处在于某些服务器可能通过禁用第一个和最后一个示例[`short_open_tag`](http://www.php.net/ini.core)。因此，如果您希望代码尽可能可移植，您应该使用 full `<?php`，否则当您将代码移动到新服务器时，您可能会发现它无法按预期工作。`<?xml`如果您尝试进行类型声明，也使用短标签可能会导致冲突。就安全性而言，如果有人决定关闭，使用短标签理论上是很危险`short_open_tag`的；然后使用该标签的代码将是纯文本并向所有人广播（查看评论以获取更多信息）

至于您的另一个问题，省略结束标签是为了防止空格意外输出到浏览器，因为这会弄乱一些脚本，特别是那些试图输出任何类型的标题的脚本。这就是[Zend Programming Guide](http://framework.zend.com/manual/en/coding-standard.php-file-formatting.html)建议不要关闭 PHP 标记的原因。

现在我已经解决了所有这些问题，除非我正在开发一些开源的东西，否则我 *个人*会使用简短的开放标签并关闭我所有的 PHP 标签。这是因为我通常可以控制我的环境，而且我认为 a)`<?=`太方便了，b) 如果你打开某些东西，你应该关闭它。然而，“最佳实践”并不真正同意这一点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T05:26:43.200

当您不控制托管时，可移植性可能很重要。例如，当我编写一些托管在我大学主机上的 PHP 程序时，它们运行良好，直到他们更改配置以禁止语法，从而破坏了一堆页面。

即使它当时有效，如果您无法控制托管，也无法保证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T05:29:22.210

短开放标签。经常提到此选项可能未启用。我从来没有真正看到过这种情况，但我想这是可能的。您可能需要移动托管服务提供商或其他东西。不过一般来说，我只会使用简短的形式。如果我需要更改它，那么这是一个相当简单的搜索和替换来更改

更重要的是，您编写的 PHP 需要多长时间是可移植的，而不仅仅是在您的特定应用程序上工作？

唯一真正的考虑因素（恕我直言）是 XML 处理指令，如果您输出 XHTML，这可能是一个问题，尽管我从未见过这样做的理由，而不是严格或过渡的 HTML。

# language-agnostic - 依赖隐藏的输入和查询字符串

> ID：871788
> 
> 赞同：1
> 
> 时间：2009-05-16T05:42:18.373
> 
> 标签：language-agnostic

假设我有一个接受参数的请求处理程序：key

让请求为：

[http://example.com/2323](http://example.com/2323)

当处理程序接收到 GET 时，会根据此键从 db 中获取相关数据，并将其馈送到表单并显示。在这个过程中，key 的值被放入一个隐藏的输入中。

当它收到一个 POST 时，它具有来自查询字符串的 key 参数，以及来自隐藏输入的 key，只要用户没有篡改它们，它们是相同的。

我想知道当表单上的数据将保存到数据库时我应该依赖的隐藏输入或查询字符串参数。问题是查询字符串可能在发布之前被用户修改，就像隐藏的输入也可能被修改，因为源对用户是开放的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-16T06:00:42.353

好吧，您发送给客户端的任何数据都有可能被修改（它可能不是微不足道的，但这种可能性仍然存在）。

有很多选择；查询字符串、隐藏字段、cookie 等等。它们中的每一个都受到这个缺点的影响——恶意用户可能会修改这些实体中的数据。

最好的选择是使用强加密。无论是隐藏字段中的数据还是cookie，都可以轻松加密。然后当接收到请求时，可以将其与较早响应之前存在的值进行比较，并且可以合理地相信数据没有被篡改来解密。作为一个很好的例子，您应该研究[ASP.NET Viewstate 的](http://msdn.microsoft.com/en-us/library/ms972976.aspx#viewstate_topic12)工作原理。

因此，要回答您的问题，您应该在没有额外安全实现的情况下依赖这两种状态持久性方法。正如他们所说，***[通过默默无闻](http://en.wikipedia.org/wiki/Security_through_obscurity)的安全根本不是安全。***

# asp.net-mvc - MVC - 如何在同一页面上构建搜索表单的视图

> ID：871790
> 
> 赞同：1
> 
> 时间：2009-05-16T05:44:14.377
> 
> 标签：asp.net-mvc

我在 VS2008 上有 MVC 1.0 应用程序。

我有一个具有搜索表单字段的网页，然后当单击搜索按钮时使用 Ajax.BeginForm 将结果加载到 div 中。效果很好！

但是结果有一个寻呼机，它只使用带有 href 的锚点将页面索引传递给控制器​​操作。

当然，与单击搜索按钮时使用的操作相同。

因此，结果会自行显示在新页面中。因为链接不是使用 Ajax 调用的。

那么如何构建我的视图和操作，以便当在寻呼机中单击链接时，表单被提交到操作以及结果的页面索引？

你了解我吗？？

马尔科姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T14:19:56.850

我想我明白你在说什么。

目前，您正在使用 Ajax 将结果动态更新为 div。科尔。

这里的诀窍是确保寻呼机中的每个“页面”都在 onclick 事件中定义了类似的 javascript 函数。这样，寻呼机不会对服务器进行“回发”，而是运行 javascript 方法......它调用了一些 ajax。

这是一些示例html...

```
<a href="#" onclick="DoPagedSearch(1)>1</a> | 
<a href="#" onclick="DoPagedSearch(2)>2</a> .. etc 
```

这有意义吗？确保寻呼机不在表单内并注意“#”字符？这确保当您单击文本时，它不会尝试转到其他地方的另一个 HTML 页面。

您知道如何将任何 javascript 连接到 html 元素吗？您如何为寻呼机创建 html 代码？

试试看，让我们随时了解情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T14:40:08.457

使用 jquery 让页面锚点对控制器进行 ajax 调用。以 JSON 或 xhtml 或任何让您感到高兴的格式返回结果，并使用它来替换 div 的内容，或者构建并替换 JSON 的内容。

如果你还没有研究过 jquery，我*强烈*推荐它。文档相当出色。让我为您提供一些有用的链接：

[JSON.net 序列化程序](http://james.newtonking.com/projects/json-net.aspx)

[jQuery 文档](http://docs.jquery.com/Main_Page)

[使用 jquery 进行分页的公平示例](http://encosia.com/2008/08/20/easily-build-powerful-client-side-ajax-paging-using-jquery/)

该示例使用 rss 提要 (xml) 作为源，但它应该能让你继续前进。

# php - 如何知道表格来自哪里？

> ID：871795
> 
> 赞同：2
> 
> 时间：2009-05-16T05:49:09.497
> 
> 标签：php, forms

我想知道PHP中有没有一种方法可以告诉您提交表单的位置而不使用隐藏字段或用户只需要稍微篡改html的任何类似内容？例如，我正在尝试确定提交的表单是否实际上在我的网站上，或者该表单是否离线保存并以这种方式提交。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T06:02:14.830

如果隐藏字段包含 UID，则不容易被欺骗（如果您加密时间戳，您将能够判断用户在页面上停留了多长时间）

当然，用户可以在该字段中输入他想要的任何内容，但除非他可以生成有效的 UID，否则他不能让您的 php 脚本相信它来自其他地方。

您还可以通过 $_SESSION 跟踪用户访问过的页面，并使用它而不是 HTTP 引荐来源网址（将每个访问过的页面存储在 $_SESSION 内的数组中，当您的脚本被调用时，您只需检查最后一页是否是您的？这取决于您的需要）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T05:55:52.303

您可以尝试在 HTTP 请求中使用引用标头集，但请注意，并非所有浏览器都正确设置了这些标头，或者用户已将其关闭，或者它们很容易被欺骗。

如果没有包含唯一标识符的隐藏字段，该标识符用于识别单个提交的表单，则没有很好的方法来识别表单是否是伪造的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T05:55:37.607

我可能是错的，但推荐人标题不会告诉你这个吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T07:09:30.113

这会让你得到你所追求的：

```
$referer = ($SERVER["HTTP REFERER"] == null); 
```

这实际上是从 HTTP Header 中获取的，如下所示：

```
...
Referer: http://foobar.com/page.php
... 
```

任何人都很容易欺骗这一点，但对于大多数目的来说，这是合理的。

琐事：`Referer`实际上应该拼写为**referrer**，这是正确的拼写，但拼写错误已进入 HTTP 规范并一直存在。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-16T05:50:46.480

你真的说不出来。为什么会很重要？如果你试图检测是否有人伪造了请求，你就做不到。

**修改**：上面的绿色解决方案确实解决了一些问题，但它没有解决它是否来自您的站点或是否被修改的问题。

# php - Objective-C Default Argument Value

> ID：871796
> 
> 赞同：14
> 
> 时间：2009-05-16T05:49:13.647
> 
> 标签：php, objective-c, function, class, methods

Hey there, quick question here. I'm sure there's a simple answer.

Coming from PHP, I'm used to declaring a function with a default argument value like this:

```
function myFunction ($array, $sort = FALSE)  {

} 
```

I the sort parameter wasn't filled, the function would continue with the default value of false. In Obj-C, is there a similar thing?

I'm working through the exercises in my "Programming In Objective-C 2.0" book, and it wants me to re-write a fraction class print function to default-ly not reduce the fraction, but if the value TRUE for reduce is given, go ahead and reduce the fraction, then print. The chapter (Nor nowhere in the book) gives any information on this.

Thanks for your help guys :D

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-16T06:40:53.833

Default arguments don't exist in Objective-C, per se. They can't really, because the argument count is inextricably tied to the method name — each colon corresponds to one argument.

Objective-C programmers accomplish a similar goal, though, by creating "convenience" methods that just call to a more "primitive" method with some of the arguments filled in with default values. For example, `-[NSArray indexOfObject:]` could be implemented as version of `-[NSArray indexOfObject:inRange:]` with an argument of `NSMakeRange(0, [self count])` for the `inRange:` part.

In this case, though, I don't think your book is talking about that. I think it simply means to reduce the fraction if YES is given for the `reduce:` argument and not reduce it if NO is given.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-16T16:24:40.950

有两种标准模式可以实现您想要的。

(1) 编写方法的多参数形式，然后提供较少的参数方便版本。例如，考虑 NSString 上的以下方法：

```
- (NSComparisonResult)compare:(NSString *)string;
- (NSComparisonResult)compare:(NSString *)string options:(NSStringCompareOptions)mask;
- (NSComparisonResult)compare:(NSString *)string options:(NSStringCompareOptions)mask
            range:(NSRange)compareRange;
- (NSComparisonResult)compare:(NSString *)string options:(NSStringCompareOptions)mask
            range:(NSRange)compareRange locale:(id)locale; 
```

前三个在概念上 [并且可能具体来说，我没有检查] 实现为对第四个版本的调用。那就是 -compare: 调用 -compare:options:range:locale: 并为三个附加参数使用适当的默认值。

(2) 另一种模式是实现方法的多参数版本，并在参数为 NULL/nil 或设置为指示需要默认值的某个值时提供默认值。NSData 具有使用此模式实现的方法。例如：

```
+ (id)dataWithContentsOfFile:(NSString *)path options:(NSDataReadingOptions)readOptionsMask
            error:(NSError **)errorPtr; 
```

如果为 readOptionsMask 参数传递 0，则 NSData 将使用内部定义的默认配置读取文件的内容。该默认配置可能会随着时间而改变。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-12-13T21:12:06.587

这个问题非常古老，但如果有人找到它，PHP 代码的 Objective-C 版本（假设这是在一个类中）可能是这样的：

```
-(id)myFunction:(NSArray*)array {
  return [self myFunction:array withSort:FALSE];
}

-(id)myFunction:(NSArray*)array withSort:(BOOL)useSort {
   // CODE
} 
```

我使用 (id)s 因为您的 PHP 代码中没有数据类型信息。用实际数据类型替换 (id) 是明智的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-29T21:04:12.573

可怕的 necro 但对于任何在谷歌上搜索的人来说，Xcode 4.5 支持（通过[Clang](http://clang.llvm.org/docs/LanguageExtensions.html#function-overloading-in-c)）使用`__attribute__((overloadable))`.

重载函数允许具有不同数量的参数，因此如果 C 函数适合您尝试执行的操作，您可以使用它来获取默认参数值。

这是一个人为的 .h 文件示例，其中包含两个函数，都称为`PrintNum`：

```
// Prints a number in the decimal base
__attribute__((overloadable)) extern void PrintNum(NSNumber *number);

// Prints a number in the specified base
__attribute__((overloadable)) extern void PrintNum(NSNumber *number, NSUInteger base); 
```

在 .m 文件中：

```
__attribute__((overloadable)) 
void PrintNum(NSNumber *number) {
    PrintNum(number, 10);
}

__attribute__((overloadable))
void PrintNum(NSNumber *number, NSUInteger base) {
    // ...
} 
```

请注意，必须在函数的所有定义和声明中指定属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T05:53:19.953

No, default arguments are a feature of C++, not C or Objective-C.

What you would have to do in objective-c is the following (using your psuedo code above):

```
function myFunction ($array, $sort)

function myFunction ($array)
// call myFunction($array, FALSE) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-09T06:26:27.397

您可以使用 轻松实现相同的效果`#define`。

头文件中的函数：

```
+(NSDate*)getDateFromYear:(NSUInteger)year month:(NSUInteger)month day:(NSUInteger)day; 
```

在头文件中添加一个`#define`for参数函数：

```
#define GetDateFromYearOnly(year) [YourClassName getDateFromYear:year month:1 day:1] 
```

然后您可以使用以下功能：

```
NSDate* 2015Date = GetDateFromYearOnly(2015); 
```

你会得到一个`NSDate`日期为 2015/01/01 的对象。

如果函数不是`static`，请像这样构建一个新函数：

```
-(NSDate*)GetDateFromYearOnly:(NSUInteger)year; 
```

并调用：

```
[self getDateFromYear:year month:1 day:1] 
```

# c# - Textbox control in DataGridView

> ID：871809
> 
> 赞同：0
> 
> 时间：2009-05-16T05:57:10.723
> 
> 标签：c#, winforms, datagridview

I am working on a datagridview in C# in windows application. I want to add textbox controls in DataGridView. So, when we run it then textbox should be shown in gridview and we can put value in it and My grid has 3 columns and I want to add new row in grid when I press tab on 3rd column of gridview.

How do I do this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T06:22:31.333

It's hard to provide a precise answer since your question is lacking in detail and pretty general, but to get textboxes in your `DataGridView`, you're going to want to add some instances of [`DataGridViewTextBoxColumn`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewtextboxcolumn.aspx) to the `DataGridView`'s `Columns` collection. This will cause them to be populated with textboxes in each row.

To detect when the user presses tab on the 3rd column, you can add a 1-2 pixel wide fourth column and detect that it has recieved focus (almost definitely from a tab keystroke) using the `OnCellEnter` event.

Good luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T17:11:28.813

因此，对于问题的“默认显示文本框”部分，这里是瘦的：

在 GridView->Edit Columns 上，添加要显式使用的列。然后单击链接“将此字段转换为模板字段”。这将允许您调整为这些单元格生成的 HTML。说OK。然后转到 GridView-> 编辑模板。对于您最喜欢的 Column，将 ItemEditTemplate 复制到 ItemTemplate 中。（ItemTemplate 是默认值。ItemEditTemplate 包含正确绑定的编辑控件。）现在您的所有数据字段都将默认为“可编辑”。

我猜你有一个提交按钮。您需要告诉 GridView 在提交时更新行，如下所示：

```
 For Each r As GridViewRow In GridView1.Rows
        Dim mon = System.Int32.Parse(CType(r.FindControl("TextBox1"), TextBox).Text)
        If mon <> 0 Then GridView1.UpdateRow(r.RowIndex, False)
    Next 
```

显然，您需要在其中使用不同的逻辑，但应该应用基本的循环/findControl/updateRow 逻辑。

微软在这里有一个演练：[Performing Bulk Updates to Rows Bound to a GridView](http://msdn.microsoft.com/en-us/library/aa992036(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-25T21:34:16.877

试试这个，例如，如果您想将第一列设置`datagridview`为`textbox`控件：

```
private void dtgrdview_CellClick(object sender, DataGridViewCellEventArgs e)
{
    if (e.ColumnIndex == 0)
    {
        TextBox txtbox1=new TextBox();
        dtgrdview.Controls.Add(txtbox1);
        Rectangle rectangle = dtgrdview.GetCellDisplayRectangle(0, e.RowIndex, true);
        txtbox1.Location = rectangle.Location;
        txtbox1.Size = rectangle.Size;                
        txtbox1.TextChanged += txtbox1_TextChanged; 
        txtbox1.Leave += txtbox1_Leave;                
        txtbox1.Visible = true;
    }

} 
```

并且不要忘记将此事件添加到如下所示的同一类中，以便在单元格具有焦点时调用它：

```
private void txtbox1_Leave(object sender, EventArgs e)
{
    txtbox1.Visible = false;
}

private void txtbox1_TextChanged(object sender, EventArgs e)
{
    dtgrdview.CurrentCell.Value = txtbox1.Text;
} 
```

如果您有任何其他问题，请随时问我 :)

# c# - 重定向到“谢谢”页面并立即提供下载文件的保存对话框

> ID：871810
> 
> 赞同：5
> 
> 时间：2009-05-16T05:57:33.297
> 
> 标签：c#, asp.net, redirect, download

我正在使用 ASP.NET2.0。我创建了一个带有一些输入字段和一个下载按钮的下载表单。单击下载按钮时，我想将用户重定向到“感谢您下载...”页面并立即为他/她提供要保存的文件。

我有以下代码来显示保存文件对话框：

```
public partial class ThankYouPage : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        Response.Clear();
        Response.AddHeader("Content-Disposition", 
                          "attachment; filename=\"downloadedFile.zip\"");
        Response.ContentType = "application/x-zip-compressed";
        Response.BinaryWrite(this.downloadedFileByteArray);
        Response.Flush();
        Response.End();
    }
} 
```

显然，此代码不允许显示任何“谢谢”消息。是否有“AfterRender”事件或类似的页面，我可以移动这个下载代码并让页面有机会向用户呈现“谢谢”消息？毕竟，我真的很感谢他们，所以我确实想表达这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T06:24:41.283

您可以使用 IFrame 从感谢页面引用下载页面

```
<iframe src="DownloadFile.aspx" style="display:none;" /> 
```

在这种情况下，DownloadFile.aspx 将包含您示例中的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T06:49:43.610

在感谢页面的头部使用 META REFRESH 标签：

```
<META http-equiv="refresh" content="1;URL=http://site.com/path/to/downloadedFile.zip"> 
```

或者，您可以使用 body onLoad 函数将当前位置替换为下载 URL。

```
<body onLoad="document.location='http://site.com/path/to/downloadedFile.zip'"> 
```

在这种情况下，重定向将*在当前页面完成加载后*开始，并且只有在客户端启用了 JavaScript 时才会开始，所以请记住包含一个带有下载链接的链接（“如果您的下载在几秒钟内没有开始......”等等）。

您也可以按照 Phil 的建议使用 IFRAME，甚至可以使用 FRAME 或完整的弹出窗口（请注意，可阻止）。你的旅费可能会改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T06:59:42.477

您编写的代码实际上应该从“谢谢”页面重定向到（使其成为第二个重定向）。因为您已将内容处置设置为附件，所以此页面实际上不会替换现有的“谢谢”页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T07:03:57.070

如果您想提供“谢谢”页面和文件，客户端必须调用两次服务器。因此，您可以只创建thankyou.aspx 页面来显示消息（并且可能将直接下载链接放置到该文件）。您可以使用元标记或仅使用 js 开始下载（甚至 ms 对其下载页面也是如此）。

然后为了提​​供文件，您应该创建一个直接链接以避免在服务器上运行另一个页面；否则你应该创建一个 HttpHandler 来隐藏文件系统。

该文件应使用[Response.TrasmitFile发送给客户端](http://msdn.microsoft.com/en-us/library/12s31dhy.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-16T07:10:27.040

请检查以下链接，这可能会帮助您解决问题。

[在 Asp.net 中，单击按钮时，如何打开下载对话框，然后将用户重定向到另一个页面？](https://stackoverflow.com/questions/3232830/in-asp-net-on-button-click-how-to-open-a-download-dialog-and-then-redirect-th/16580386#16580386)

# java - 所有 Java 标准类和方法的简单列表？

> ID：871812
> 
> 赞同：6
> 
> 时间：2009-05-16T05:58:52.170
> 
> 标签：java, python, parsing

我正在构建一个非常简单的 Java 解析器，以寻找一些特定的使用模型。这绝不是用于运行代码的 lex/yacc 或任何其他形式的解释器/编译器。

当我遇到一个单词或由一个点分隔的两个单词（“word.word”）时，我想知道这是一个标准的 Java 类（和方法），例如“Integer”，还是某个用户定义的名称。我对代码中是否包含/导入了正确的类不感兴趣（即，如果代码编译良好），并且覆盖标准 Java 类名称的用户定义类的极端情况也让我不感兴趣。换句话说：我可以接受假阴性，我只对“大部分”正确感兴趣。

如果有一个地方我可以找到所有 Java 标准类和方法的所有名称的简单列表，并且可以轻松地保存到文本文件或数据库中？（J2SE 还可以，但 J2EE 更好）。我熟悉[http://java.sun.com/j2se/](http://java.sun.com/j2se/)等，但似乎我需要大量的手工工作才能从那里提取所有名称。此外，最新的 JDK 不是必需的，我可以使用 1.4 或 1.5。

澄清：我不是在 Java 中工作，而是在 Python 中工作，所以我不能在我的解析机制中使用 Java 特定的命令。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T06:03:45.640

[javadoc](http://java.sun.com/javase/6/docs/api/allclasses-frame.html)有什么问题？该[索引](http://java.sun.com/javase/6/docs/api/allclasses-frame.html)列出了所有类、方法和静态变量。您可能可以用 grep 查找括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T06:06:25.837

要获取所有类和方法，您可以查看 [http://java.sun.com/javase/6/docs/api/index-files/index-1.html上的索引](http://java.sun.com/javase/6/docs/api/index-files/index-1.html)

这将是数以千计的类和方法中的 10 种，可能是压倒性的。

我建议您在 IDE 中使用自动完成功能。这将根据上下文向您显示所有匹配的类/方法。例如说你有一个变量

长时间=系统。

这将向您显示 System 中返回长值的所有方法，例如

长时间 = System.nanoTime();

即使您知道很多方法/类，这也可以为您节省大量打字时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T07:25:01.217

如果您只想创建 Java 中所有类及其方法的列表（以便您可以填充数据库或 XML 文件），您可能需要编写一个 Eclipse 插件来查看整个 JavaCore 模型，并扫描所有它的类（例如，通过搜索 Object 的所有子类型）。然后枚举所有方法。您可以通过将其包含在您的上下文中来从技术上对任何库执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T07:26:22.460

如果我没记错的话，IBM 有一个从 JavaDocs 创建 XML 的工具：http: [//www.ibm.com/developerworks/xml/library/x-tipjdoc/index.html](http://www.ibm.com/developerworks/xml/library/x-tipjdoc/index.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-16T07:41:11.647

还有一个选项可以`classlist`从 jre/lib 文件夹解析文件或打开`jsse.jar`文件，列出那里的所有类，并自己以点分隔的形式列出它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T07:16:18.710

> 当我遇到一个单词或由一个点分隔的两个单词（“word.word”）时，我想知道这是一个标准的 Java 类（和方法），例如“Integer”，还是某个用户定义的名称。

如果这就是你所追求的，你可以通过使用一些简单的反射来做一个（有限的）Java类列表：http: [//java.sun.com/developer/technicalArticles/ALT/Reflection/](http://java.sun.com/developer/technicalArticles/ALT/Reflection/)

```
try {
  Class.forName("word.word");
  System.out.println("This is a valid class!");
} catch (ClassNotFoundException e) {
  System.out.println("This is not a valid class.");
} 
```

像这样的东西对于您的目的应该足够了，他的额外好处是不限于类的子集，并且可以通过类路径上的任何库进行扩展。

# objective-c - 用于在 Cocoa 中从 Mac 捕获音频并保存到文件的代码示例？

> ID：871819
> 
> 赞同：19
> 
> 时间：2009-05-16T06:04:16.620
> 
> 标签：objective-c, macos, cocoa, audio

我要开发一个小型应用程序，该应用程序从 Mac 的音频队列中捕获音频，并需要以某种合理的音频格式将其保存到磁盘。

有没有人可以分享一些不错的示例代码（Cocoa / Objective-C）？

我特别需要捕获正在传递给内置输出设备的音频以便记录它。有什么见解吗？到目前为止的答案很有帮助，但并没有帮助我理解如何捕获到输出的数据，而与输入源无关。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-16T08:34:51.860

在 Mac OS X 中处理音频涉及到与 Core Audio 的接口。如需快速概览，请查看[Core Audio 概览](https://developer.apple.com/library/content/documentation/MusicAudio/Conceptual/CoreAudioOverview/Introduction/Introduction.html)。

您将需要与 AUHAL 交互以执行输入和输出；存在一份[技术说明](http://developer.apple.com/technotes/tn2002/tn2091.html)，详细说明了这样做所需的步骤。这段代码似乎通常是用 C++ 编写的，因为这是[SimplePlayThru 演示](http://www.musicednet.com/downloads/SimplePlayThru.sit)中采用的过程。

这不包括捕获该音频输入所需的实际步骤。但是，这些链接应该为您提供足够的示例代码来开始与您的输入设备交互。如果我遇到它们，我会在这个答案中发布更多链接。

* * *

看看`/Developer/Example/CoreAudio/Services/AudioFileTools`。具体来说，看`afrecord.cpp`。诚然，这不是 Cocoa*本身*；Cocoa 本身似乎没有任何特定的录制功能。如果您想与那里的 C++ 文件交互，您可能需要像在 SimplePlayThru 中那样编写一些 Objective C++。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-17T15:44:33.147

Ulli Kusterers [Github Repository](https://github.com/uliwitness/UKSoundFileRecorder)
有一个很好的示例代码 Cocoadev 也有[一篇](http://www.cocoadev.com/index.pl?HowToRecordSound)关于该主题的文章。页面底部的源代码使用 QuickTimes Sequence Grabber API。我会选择Core Audio。

# tfs - Update TFS Build Quality when unit tests pass

> ID：871822
> 
> 赞同：3
> 
> 时间：2009-05-16T06:15:39.480
> 
> 标签：tfs

Im trying to update the build quality of a build when the unit tests pass.. I figured how to update the quality of the build using a statement like this...

```
<Target Name="AfterEndToEndIteration">
<SetBuildProperties
  TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
  BuildUri="$(BuildUri)"
  Quality="Unit Test Passed" /> 
```

But i cant seem to isolate the Target when the unit tests SUCCESSFULLY pass.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T10:25:33.730

根据 Aaron Hallberg 的博客文章，您应该能够使用 TestStatus 属性使目标成为条件：http: [//blogs.msdn.com/aaronhallberg/archive/2008/05/12/orcas-sp1-tfs-build-changes -part-2.aspx](http://blogs.msdn.com/aaronhallberg/archive/2008/05/12/orcas-sp1-tfs-build-changes-part-2.aspx)

```
<Target Name="AfterEndToEndIteration" Condition="'$(TestStatus)'=='Succeeded'">
  ...
</Target> 
```

# flash - IE7 and 8 smaller font-size issues with SIFR

> ID：871823
> 
> 赞同：0
> 
> 时间：2009-05-16T06:15:53.487
> 
> 标签：flash, internet-explorer, sifr

my website [http://tweetMP.org.au](http://tweetMP.org.au) uses SIFR to render the flash font h2 headings.

If you compare the site between Firefox and IE7/8 you'll notice the headings are noticably smaller in IE (7 and 8 only - IE6 looks fine).

Adjusting the font-size on my ie(7 and 8 specific css) does nothing.

Any ideas why this is the case?

-V

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T14:41:57.200

您的问题可能来自使用像素 (px) 作为字体大小。尽管 ems (em) 是调整字体大小的现代方式，但百分比 (%) 在浏览器中的显示更加一致。试试这个，然后再次测试 sIFR。有关更多信息，请阅读以下文章，其中一篇（在 A List Apart 上）引用：

> 修复 IE6 和 IE7 夸大文本大小的方法是使用百分比调整正文大小

[CSS 字体大小：em vs. px vs. pt vs. percent](http://www.kyleschaeffer.com/?p=18)

[如何在 CSS 中调整文本大小](http://www.alistapart.com/articles/howtosizetextincss/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T18:08:07.453

我建议在 sifr 配置文件中设置字体大小，类似于以下内容：（记下 font-size 元素）。这样可以确保字体大小在 sifr 中执行，并且可能会帮助您。如果它不让我知道我还能想到另一种解决方案:)

sIFR.replace({
选择器: '.din-20-bold',
src: 'fonts/din.swf',
highsrc: 'fonts/din.swf',
css: {
'.sIFR-root' : { 'text-变换'：'大写'，'颜色'：'#FFFFFF'，'文本对齐'：'right'，'宽度'：'484px'，'**字体大小'：'20px** '，'字体粗细'： '粗体'},
},
wmode: '透明',
paddingTop: 0
});

# terminology - “数据只是愚蠢的代码，代码只是智能数据”是什么意思？

> ID：871833
> 
> 赞同：24
> 
> 时间：2009-05-16T06:29:16.670
> 
> 标签：terminology, sicp

[我刚刚在计算机程序的结构和解释中](https://rads.stackoverflow.com/amzn/click/com/0262011530)遇到了一个想法：

> 数据只是愚蠢的代码，代码只是智能数据

我不明白这意味着什么。有人可以帮助我更好地理解它吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-05-16T07:50:27.410

这是 SICP 的基本课程之一，也是计算机科学最强大的思想之一。它是这样工作的：

我们认为的“代码”实际上并没有自己做任何事情的能力。代码仅在解释的上下文中定义程序——在该上下文之外，它只是一个字符流。（实际上是比特流，实际上是电脉冲流。但让我们保持简单。）代码的*含义*是由运行它的系统定义的——这个系统只是把你的代码当作数据来告诉你它是你想做的。C 源代码被 C 编译器解释为描述您希望它创建的目标文件的数据。加载器将目标文件视为描述要排队执行的某些机器指令的数据。

解释型语言通常包含将数据视为代码的机制，这意味着您可以将代码以某种形式传递给函数，然后执行它——甚至在运行时生成代码：

```
#!/usr/bin/perl
# Note that the above line explicitly defines the interpretive context for the
# rest of this file.  Without the context of a Perl interpreter, this script
# doesn't do anything.
sub foo {
    my ($expression) = @_;
    # $expression is just a string that happens to be valid Perl

    print "$expression = " . eval("$expression") . "\n";
}

foo("1 + 1 + 2 + 3 + 5 + 8");              # sum of first six Fibonacci numbers
foo(join(' + ', map { $_ * $_ } (1..10))); # sum of first ten squares 
```

像 scheme 这样的一些语言有一个“一等函数”的概念，这意味着你可以把一个函数当作数据来传递，而不用评估它，直到你真的想要。

结果是“代码”和“数据”之间的划分几乎是任意的，只是透视的功能。抽象级别越低，代码必须越“智能”：它必须包含更多关于如何执行的信息。另一方面，解释器提供的信息越多，代码就越愚蠢，直到它开始看起来像完全没有智能的数据。

编写代码最有效的方法之一是简单地描述您需要什么：数据将转换为代码，描述如何通过解释性上下文为您提供所需的内容。我们称之为[“声明式编程”](http://en.wikipedia.org/wiki/Declarative_programming)。

举一个具体的例子，考虑 HTML。HTML 没有描述图灵完备的编程语言。它只是结构化数据。它的结构包含一些智能，可以让它控制其解释上下文的行为——但不是很多智能。另一方面，它比普通网页上出现的文本段落包含更多的智能：那些是非常愚蠢的数据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-16T09:25:14.657

在安全方面：由于缓冲区溢出，您认为是数据并因此无害的内容（例如图像）可以作为代码执行并 p0wn 您的机器。

在软件开发的背景下：许多开发人员非常害怕“硬编码”的东西，并且非常热衷于提取可能必须更改为配置文件的参数。这通常基于配置文件只是“数据”的想法，因此可以轻松更改（可能由客户），而不会引发更改代码中任何内容的问题（编译、部署、测试）。

这些开发人员没有意识到，既然这些“数据”会影响程序的行为，那么它确实是代码；它可能会破坏程序，并且在这种更改之后不需要进行完整测试的唯一原因是，如果正确完成，可配置值具有非常具体、有据可查的效果，任何无效值或损坏的文件结构都将被该程序。

然而，经常发生的情况是，配置文件结构本身就变成了一种编程语言，包含控制流和所有东西——文档记录很差，有一个古怪的语法和解析器，只有团队中最有经验的开发人员才能使用它可以触摸而不会完全破坏应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T06:36:17.340

因此，在像 Scheme 这样的语言中，甚至代码也被视为一等数据。您可以像对待其他代码一样对待函数和 lambda 表达式，比如将它们传递给其他函数和 lambda 表达式。我建议继续阅读文本，因为这一切都会变得非常清楚。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-16T08:27:34.297

这是您应该通过在编译器中编写来理解的。

编译器中的一个常见步骤是将程序转换为抽象语法树。表示通常类似于树，例如 [+, 2, 3]，其中 + 是根，2, 3 是孩子。

Lisp 语言只是将其视为其数据。因此，数据和代码之间没有分离，它们都是看起来像 AST 树的列表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-24T04:23:14.340

代码绝对是数据，但数据绝对**不总是**代码。让我们举一个基本的例子——客户名称。它与代码无关，它是**功能性**（必要的），而不是应用程序的**技术**（偶然）方面。

您可能会说任何技术/意外数据都是代码，而功能/基本数据不是。

# php - 介绍 PHP 中的测试驱动开发

> ID：871837
> 
> 赞同：5
> 
> 时间：2009-05-16T06:32:19.813
> 
> 标签：php, testing, process, tdd, testing-strategies

我的工作场所由很多牛仔编码员组成。他们中的许多人都是小学生。这恰好导致了很多代码质量问题。

我正在寻找有关如何让我的团队最好地使用 TDD 的建议（我们可以从单元测试开始，然后进入回归测试，然后是更多的自动化测试）。

最终，我希望我们从错误中更快地学习，并产生更好的代码并培养更好的开发人员。

我希望有一些关于如何将 TDD 引入团队的实用建议。具体来说，在 LAMP (php) 堆栈中最好选择哪些工具。

对不起，如果这个问题太开放了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-06T19:10:43.643

在经历了这个过程四次之后，我发现如果没有一定程度的强制执行，任何 TDD 的引入都会失败。程序员不想切换风格，也不会编写他们的第一个单元测试并突然看到曙光。

您可以在管理级别上强制执行，但这对所有相关人员来说都是耗时的。无论如何，这在开始时是必要的，但最终您将需要自动执行。答案是引入持续集成。

我发现 CI 服务器是任何 TDD 环境的终极基石。除非开发人员知道如果他们不编写测试会发生一些不好的事情，否则总会有牛仔觉得这在他们之下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T09:36:20.917

使编写测试**变得容易**并且结果**可见**。

*   使用具有良好文档的 TestFramework。像[SimpleTest](http://simpletest.sf.net)
*   如果测试依赖于数据库内容，请创建一个将在脚本开头删除和创建的参考数据库。
*   制作一个运行所有测试并在独立监视器上显示结果的脚本，或者使测试可见/易于访问的东西。（运行命令提示符不是一种选择）

我个人不会为应用程序中的每一块代码编写测试。
专注于应用程序中的领域对象。在我的情况下，这些是“价格计算”和“库存变化”

提醒他们，他们可能已经在编写测试，但是他们在创建之后就删除了他们的工作。示例：在开发函数期间，您将拥有一个带有*echo*或*var_dump* () 结果的页面/测试脚本。在手动验证结果后，您将修改函数的参数并再次检查。

通过一些额外的努力，这些测试可以在 UnitTest 中自动化。哪个程序员不喜欢自动化的东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T08:00:28.323

至于团队问题以及关于软件开发和测试的普遍想法，我会建议 Joel Spolski 的网站和书籍：http://joelonsoftware.com/[我](http://joelonsoftware.com/)从他那里得到了很多见解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T08:10:48.127

[SimpleTest](http://www.simpletest.org/) - 优秀的 php 测试文档和解释

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T08:15:29.957

启动 TDD 的另一种方法是尝试使用 PHP 框架。没有框架，很难有效地实现单元测试。

# visual-c++ - How to use stdext::hash_map?

> ID：871838
> 
> 赞同：7
> 
> 时间：2009-05-16T06:32:56.537
> 
> 标签：visual-c++, hashmap

I would like to see a simple example of how to override stdext::hash_compare properly, in order to define a new hash function and comparison operator for my own user-defined type. I'm using Visual C++ (2008).

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T07:40:20.757

这是你可以做到的

```
class MyClass_Hasher {
     const size_t bucket_size = 10; // mean bucket size that the container should try not to exceed
     const size_t min_buckets = (1 << 10); // minimum number of buckets, power of 2, >0
     MyClass_Hasher() {
          // should be default-constructible
     }
     size_t operator()(const MyClass &key) {
             size_t hash_value;
             // do fancy stuff here with hash_value
             // to create the hash value. There's no specific
             // requirement on the value.
             return hash_value;
     }

     bool operator()(const MyClass &left, const MyClass &right) {
            // this should implement a total ordering on MyClass, that is
            // it should return true if "left" precedes "right" in the ordering
     }
 }; 
```

然后，您可以使用

```
stdext::hash_map my_map<MyClass, MyValue, MyClass_Hasher> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T07:38:00.997

给你，来自[MSDN的示例](http://msdn.microsoft.com/en-us/library/8zz3703d(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-16T11:28:36.743

我更喜欢使用非成员函数。

Boost 文档文章[Extending boost::hash for a custom data type](http://www.boost.org/doc/libs/1_40_0/doc/html/hash/custom.html)中阐述的方法似乎有效。

# asp.net - What is default session timeout in ASP.NET?

> ID：871839
> 
> 赞同：112
> 
> 时间：2009-05-16T06:33:19.313
> 
> 标签：asp.net, session, timeout, asp.net-2.0

What is the default session timeout value in ASP.NET?

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2009-05-16T06:38:17.647

It is 20 Minutes according to [MSDN](http://msdn.microsoft.com/en-us/library/h6bb9cz9(v=vs.80).aspx)

From MSDN:

> Optional TimeSpan attribute.
> 
> Specifies the number of minutes a session can be idle before it is abandoned. The timeout attribute cannot be set to a value that is greater than 525,601 minutes (1 year) for the in-process and state-server modes. The session timeout configuration setting applies only to ASP.NET pages. Changing the session timeout value does not affect the session time-out for ASP pages. Similarly, changing the session time-out for ASP pages does not affect the session time-out for ASP.NET pages. **The default is 20 minutes.**

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2011-06-02T07:29:22.217

**这取决于*配置*或*程序更改***。
因此，检查当前值最可靠的方法是在*运行时*通过代码。

请参阅**[HttpSessionState.Timeout](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.timeout.aspx)**属性；默认值为 20 分钟。

您可以通过[HttpContext](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx)在 ASP.NET 中访问此属性：

```
this.HttpContext.Session.Timeout // ASP.NET MVC controller
Page.Session.Timeout // ASP.NET Web Forms code-behind
HttpContext.Current.Session.Timeout // Elsewhere 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2015-04-29T13:27:23.557

1.  The Default Expiration Period for **Session is 20 Minutes**.
2.  The Default Expiration Period for **Cookie is 30 Minutes**.
3.  Maximum Size of **ViewState is 25% of Page Size**

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2012-12-12T06:48:07.490

默认值为 20 分钟。 [http://msdn.microsoft.com/en-us/library/h6bb9cz9(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/h6bb9cz9(v=vs.80).aspx)

```
<sessionState 
mode="[Off|InProc|StateServer|SQLServer|Custom]"
timeout="number of minutes"
cookieName="session identifier cookie name"
cookieless=
     "[true|false|AutoDetect|UseCookies|UseUri|UseDeviceProfile]"
regenerateExpiredSessionId="[True|False]"
sqlConnectionString="sql connection string"
sqlCommandTimeout="number of seconds"
allowCustomSqlDatabase="[True|False]"
useHostingIdentity="[True|False]"
stateConnectionString="tcpip=server:port"
stateNetworkTimeout="number of seconds"
customProvider="custom provider name">
<providers>...</providers>
</sessionState> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-07-25T11:45:29.650

会话的默认有效期为 20 分钟。

您可以更新会话状态并配置超时下的分钟数

```
<sessionState 
timeout="30">
</sessionState> 
```

# variable-names - 对于描述对象位置和大小的矩形来说，什么是一个好的变量名？

> ID：871841
> 
> 赞同：2
> 
> 时间：2009-05-16T06:35:23.533
> 
> 标签：variable-names

标题是不言自明的，但我会重申：对于描述对象位置和大小的矩形来说，什么是一个好的变量名。

**编辑**- 该对象是类似 Pong 游戏的球拍，并且已经有一个名为“边界”的矩形来限制球拍可以移动到的位置。

我最终为桨的位置和大小设置了“界限”，并使用“movableArea”来限制桨可以移动的位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T07:03:13.157

如果它是一个桨，那么为什么不是 paddleBound？这不是火箭科学，它描述了对象及其属性，应该足以将它与其他任何东西区分开来，除了另一个桨（然后你可以使用 paddel1Bound 或 userPaddleBound 进一步区分）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T07:06:41.930

鉴于您的问题的上下文，为什么不使用 Paddle？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T06:38:10.127

`BoundingBox`可能很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T06:38:34.620

boundingBox 或 boundsRect 怎么样？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T06:39:25.880

Apple 的 Cocoa 框架使用`frame`and `bounds`（含义略有不同）来表示这种变量。我一直觉得他们很好。如果你只需要一个，我投票赞成`frame`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-16T06:39:38.673

好吧，如果变量是 Foo 类型，我会选择

> foo矩形

或者类似的东西。它还取决于语言和约定是什么，也许还有上下文。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-16T07:03:38.803

我更喜欢短的。xybox怎么样？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-16T07:10:36.307

周长呢？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-16T14:39:35.430

那这个呢 ？

矩形下一个边界；// 桨可以移动到的边界

矩形边界；// 当前边界

# c - c中的并发变量访问

> ID：871855
> 
> 赞同：5
> 
> 时间：2009-05-16T06:50:53.513
> 
> 标签：c, multithreading, concurrency, multicore

我对 C 中的并发编程有一个相当具体的问题。我对此进行了相当多的研究，但看到了几个相互矛盾的答案，所以我希望得到一些澄清。我有一个类似于以下的程序（抱歉，代码块过长）：

```
typedef struct {
  pthread_mutex_t mutex;
  /* some shared data */
  int eventCounter;
} SharedData;

SharedData globalSharedData;

typedef struct {
  /* details unimportant */
} NewData;

void newData(NewData data) {
  int localCopyOfCounter;

  if (/* information contained in new data triggers an
         event */) {
    pthread_mutex_lock(&globalSharedData.mutex);
    localCopyOfCounter = ++globalSharedData.eventCounter;
    pthread_mutex_unlock(&globalSharedData.mutex);
  }
  else {
    return;
  }

  /* Perform long running computation. */

  if (localCopyOfCounter != globalSharedData.eventCounter) {
    /* A new event has happened, old information is stale and
       the current computation can be aborted. */
    return;
  }

  /* Perform another long running computation whose results
     depend on the previous one. */

  if (localCopyOfCounter != globalSharedData.eventCounter) {
    /* Another check for new event that causes information
       to be stale. */
    return;
  }

  /* Final stage of computation whose results depend on two
     previous stages. */
} 
```

有一个线程池为传入数据的连接提供服务，因此可以同时运行多个 newData 实例。在多处理器环境中，我知道在正确处理此代码的计数器部分时存在两个问题：阻止编译器将共享计数器副本缓存在寄存器中，以便其他线程看不到它，并强制CPU 及时将计数器值的存储写入内存，以便其他线程可以看到它。我不希望在计数器检查周围使用同步调用，因为可以接受部分读取计数器值（它将产生与本地副本不同的值，这应该足以得出事件已发生的结论）。将 SharedData 中的 eventCounter 字段声明为 volatile 是否足够？还是我需要在这里做其他事情？还有更好的方法来处理这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T07:08:56.917

不幸的是，C 标准很少提及并发性。但是，大多数编译器（无论如何，gcc 和 msvc）都会将 volatile 读取视为具有[获取语义](http://blogs.msdn.com/kangsu/archive/2007/07/16/volatile-acquire-release-memory-fences-and-vc2005.aspx)- 每次访问时都会从内存中重新加载 volatile 变量。这是可取的，您现在的代码可能最终会比较缓存在寄存器中的值。如果这两个比较都被优化了，我什至不会感到惊讶。

所以答案是肯定的，让`eventCounter`易变的。或者，如果您不想过多限制编译器，可以使用以下函数来执行`eventCounter`.

```
int load_acquire(volatile int * counter) { return *counter; }

if (localCopy != load_acquire(&sharedCopy))
    // ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T07:20:59.820

> 防止编译器将本地计数器副本缓存在寄存器中，以便其他线程看不到它

您的本地计数器副本是“本地的”，在执行堆栈上创建并且仅对正在运行的线程可见。每个其他线程都在不同的堆栈中运行，并具有自己的本地计数器变量（无并发）。

您的全局计数器应声明为 volatile 以避免寄存器优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T10:14:02.353

您还可以使用手动编码的程序集或编译器[内在函数](http://www.codeproject.com/KB/cpp/lockfreeq.aspx)，这将保证对您的互斥体进行原子检查，它们也可以原子地++和 - 您的计数器。

这些天volatile[没用](http://software.intel.com/en-us/blogs/2007/11/30/volatile-almost-useless-for-multi-threaded-programming/)了，在大多数情况下，您应该查看内存屏障，它们是其他低级 CPU 工具，可帮助解决多核争用问题。

然而，我能给出的最好建议是让您了解各种托管和本机多核支持库。我猜一些老的像 OpenMP 或 MPI（基于消息的），仍然在踢，人们会继续谈论他们有多酷……但是对于大多数开发人员来说，比如英特尔的[TBB](http://software.intel.com/en-us/intel-tbb/)或[微软的](http://blogs.msdn.com/nativeconcurrency/)新 API，我也只是挖了在这篇代码项目[文章中](http://www.codeproject.com/KB/cpp/lockfreeq.aspx)，他显然在使用 cmpxchg8b 这是我最初提到的低级硬件路线......

祝你好运。

# php - PHP 将变量传递到下一页

> ID：871858
> 
> 赞同：221
> 
> 时间：2009-05-16T06:58:45.773
> 
> 标签：php, variables, session

这似乎很简单，但我找不到一个好的方法来做到这一点。

说在第一页我创建了一个变量

```
$myVariable = "Some text"; 
```

该页面的表单操作是“Page2.php”。那么在 Page2.php 中，我如何才能访问该变量？我知道我可以通过会话来做到这一点，但我认为这对于一个简单的字符串来说太多了，我只需要传递一个简单的字符串（文件名）。

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：491
> 
> 时间：2009-05-16T14:24:19.303

HTML / HTTP 是无状态的，换句话说，你在上一页所做/看到的，与当前页面完全无关。*除非*您使用会话、cookie 或 GET / POST 变量之类的东西。会话和 cookie 非常易于使用，会话比 cookie 安全得多。更安全，但并不完全安全。

**会议：**

```
//On page 1
$_SESSION['varname'] = $var_value;

//On page 2
$var_value = $_SESSION['varname']; 
```

`session_start();`请记住在尝试访问`$_SESSION`数组之前以及将任何输出发送到浏览器之前在这两个页面上运行该语句。

**曲奇饼：**

```
//One page 1
$_COOKIE['varname'] = $var_value;

//On page 2
$var_value = $_COOKIE['varname']; 
```

会话和 cookie 之间的最大区别在于，如果您使用会话，变量的值将存储在服务器上，如果您使用 cookie，则存储在客户端。我想不出使用 cookie 代替会话的任何充分理由，除非您希望数据在会话之间持久存在，但即便如此，最好将其存储在数据库中，并根据用户名或 id 检索它。

**获取和发布**

您可以在下一页的链接中添加变量：

```
<a href="page2.php?varname=<?php echo $var_value ?>">Page2</a> 
```

这将创建一个 GET 变量。

另一种方法是在提交到第二页的表单中包含一个隐藏字段：

```
<form method="get" action="page2.php">
    <input type="hidden" name="varname" value="var_value">
    <input type="submit">
</form> 
```

然后在第二页：

```
//Using GET
$var_value = $_GET['varname'];

//Using POST
$var_value = $_POST['varname'];

//Using GET, POST or COOKIE.
$var_value = $_REQUEST['varname']; 
```

只需将表单的方法更改为`post`如果您想通过邮寄进行。两者同样不安全，尽管 GET 更容易破解。

当我第一次开始使用 PHP 编码时，除了会话数据之外，每个新请求都是一个全新的脚本实例这一事实吸引了我。一旦你习惯了它，它虽然很简单。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-11-23T12:59:36.310

谢谢楼上的回答。以下是我的做法，希望对关注的人有所帮助。我希望将注册号从一个页面传递到另一个页面，因此*regName*和*regValue*：

创建您的第一页，将其命名为**set_reg.php**：

```
<?php

session_start();

$_SESSION['regName'] = $regValue;

?>

<form method="get" action="get_reg.php">
    <input type="text" name="regName" value="">
    <input type="submit">
</form> 
```

创建您的第二个页面，将其命名为**get_reg.php**：

```
<?php

session_start();

$regValue = $_GET['regName'];

echo "Your registration is: ".$regValue.".";

?>

<p><a href="set_reg.php">Back to set_reg.php</a> 
```

尽管不如上面的答案全面，但出于我的目的，这以简单的方式说明了各种元素之间的关系。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-16T07:04:01.827

## 在请求中传递数据

您可以将其作为隐藏字段嵌入到表单中，也可以将其添加到表单操作 URL

```
 echo '<input type="hidden" name="myVariable" value="'.
     htmlentities($myVariable).'">'; 
```

或者

```
echo '<form method="POST" action="Page2.php?myVariable='.
    urlencode($myVariable).'">"; 
```

请注意，这也说明了在传递数据时使用[htmlentities](http://php.net/htmlentities)和[urlencode 。](http://php.net/urlencode)

## 在会话中传递数据

如果数据不需要传递到客户端，那么会话可能更合适。只需在每个页面的开头调用[session_start() ，您就可以获取数据并将其设置到 $_SESSION 数组中。](http://php.net/session_start)

## 安全

由于您声明您的值实际上是一个文件名，因此您需要注意安全后果。如果文件名是从客户端到达的，则假定用户篡改了该值。检查它的有效性！当用户将路径传递给重要的系统文件或他们控制的文件时会发生什么？您的脚本可以用于“探测”服务器以查找存在或不存在的文件吗？

由于您显然才刚刚开始，因此值得提醒的是，这适用于 $_GET、$_POST 或 $_COOKIE 中的任何数据 - 假设您最大的敌人制作了这些数组的内容，并相应地编码！

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-01-24T11:23:30.750

在 php 中传递值有 3 种方法。

*   邮寄
*   通过获取
*   通过使会话变量

这三种方法用于不同的目的。例如，如果我们想在下一页接收我们的值，那么我们可以使用 'post' ($_POST) 方法：-

```
$a=$_POST['field-name']; 
```

如果我们需要不止一页上的变量值，那么我们可以使用会话变量：-

```
$a=$_SESSION['field-name]; 
```

在使用这个语法创建 SESSION 变量之前，我们首先必须在我们的 php 页面的最开始添加这个标签

```
session_start(); 
```

GET 方法通常用于在同一页面上打印数据，该页面用于从用户那里获取输入。它的语法如下：

```
$a=$_GET['field-name']; 
```

POST 方法通常比 GET 更安全，因为当我们使用 Get 方法时，它可以在 URL 栏中显示数据。如果数据是密码等更敏感的数据，那么它可能是 inggeris。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-06-08T07:21:28.093

试试这个代码

使用隐藏字段，我们可以将 php 变量传递到另一个页面

page1.php

```
<?php $myVariable = "Some text";?>
<form method="post" action="page2.php">
 <input type="hidden" name="text" value="<?php echo $myVariable; ?>">
 <button type="submit">Submit</button>
</form> 
```

将 php 变量传递给隐藏字段值，以便您可以将此变量访问到另一个页面

page2.php

```
<?php
 $text=$_POST['text'];
 echo $text;
?> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-16T07:05:54.927

会话将是唯一的好方法，您也可以使用 GET/POST 但这可能不安全。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-01-27T12:52:25.130

```
**page 1**
<form action="exapmple.php?variable_name=$value" method="POST"> 
    <button>
        <input  type="hidden" name="x">
    </button>
</form>` 
```

**第2页**

```
if(isset($_POST['x'])) {
    $new_value=$_GET['variable_name'];
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-05T16:38:48.217

> `It works.` 发送数据抛出 URL，不带表单。

```
$upit = "SELECT * FROM usluga";

            $data = $mysql->query($upit);

            while ($row = mysqli_fetch_object($data)) 
            {
                echo "<a href='"."index.php?tretmanId=$row->tretman_id"."'>$row->naziv</a>";
                echo "<br><br>";
            } 
```

> 并且您可以使用“$_GET['name from URL']”在目标页面上获取此值，如下所示

```
$TrermanIdFromUrl = $_GET['tretmanId']; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-23T10:23:22.480

例如，您可以通过在 url 中包含变量来调用所需的页面：

```
header("Location: ../signup.php?newpwd=passwordupdated"); 
```

在您的 signup.php 页面上，您将拥有

```
if (isset($_GET['newpwd']) && $_GET['newpwd'] == "passwordupdated") {
        //code here
    } 
```

# java - 如何将数据写入套接字通道

> ID：871870
> 
> 赞同：5
> 
> 时间：2009-05-16T07:08:04.207
> 
> 标签：java, nio

是否有任何小型工作程序用于使用 java nio 从客户端接收和发送数据。

实际上我无法写入套接字通道，但我能够读取传入数据如何将数据写入套接字通道

谢谢迪帕克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T07:21:02.520

您可以像这样将数据写入套接字通道：

```
import java.nio.*;
import java.nio.channels.*;
import java.nio.charset.*;

public class SocketWrite {

  public static void main(String[] args) throws Exception{

    // create encoder
    CharsetEncoder enc = Charset.forName("US-ASCII").newEncoder();  

    // create socket channel
    ServerSocketChannel srv = ServerSocketChannel.open();

    // bind channel to port 9001   
    srv.socket().bind(new java.net.InetSocketAddress(9001));

    // make connection
    SocketChannel client = srv.accept(); 

    // UNIX line endings
    String response = "Hello!\n";

    // write encoded data to SocketChannel
    client.write(enc.encode(CharBuffer.wrap(response)));

    // close connection
    client.close();
  }
} 
```

[InetSocketAddress](http://java.sun.com/j2se/1.4.2/docs/api/java/net/InetSocketAddress.html)可能会因您连接的内容而异。

# php - 为什么 PHP 不解析我的脚本？

> ID：871882
> 
> 赞同：0
> 
> 时间：2009-05-16T07:19:22.557
> 
> 标签：php, parsing, executable

我试图让 php 可执行文件来解析脚本，但它不起作用。我运行这样的东西：

> php c:\test.php

并且 test.php 包含以下内容：

```
<?
echo 'hello!';
?> 
```

这正是运行命令返回的内容。它返回原始代码。我怎样才能让它真正解析代码并返回“你好！” 反而？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T07:23:09.007

确保在 php.ini 中启用了[short_open_tag设置。](http://us3.php.net/ini.core#ini.short-open-tag)如果做不到这一点，请使用稍微长一点的时间`<?php`来启动您的脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T07:33:58.603

另一种选择可能是尝试使用 -f 命令行选项。

```
php -f c:\test.php 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T07:23:11.703

自从我从命令行运行 php 已经有一段时间了，但试试这个：

```
<?php
echo 'hello!';
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T07:25:04.023

还要确保您的网络服务器配置正确。如果未将其配置为通过 php 解释器运行 .php 页面，则它可能仅显示为文本文件。

# c# - 实体框架：多对多计数和求和

> ID：871883
> 
> 赞同：2
> 
> 时间：2009-05-16T07:19:39.903
> 
> 标签：c#, entity-framework, linq-to-entities

我正在使用实体框架。我有一个多对多的关系文章 <-> 类别。每篇文章可以属于多个分类，每个分类可以属于多篇文章。我可以获得每个类别中的文章计数：

```
public IEnumerable<MenuCategory> GetMenuCategories()
{
   return (from c in db.CategorySet.Include("Articles")
     orderby c.CategoryName
     select new MenuCategory
     {
        CategoryID = c.CategoryID,
        CategoryName = c.CategoryName,
        CountOfCategory = c.Articles.Count()
      });

} 
```

但我还需要获取文章总数，以便计算每个类别中文章的百分比。谁能告诉我如何通过扩展上面的代码而不单独调用数据库来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T08:09:17.817

代码需要知道文章的总数才能做到这一点。

如果您想避免第二次数据库调用，那么您可以在数据库中进行计算并将其作为结果集中的额外列返回。有不同的方法可以实现这一点，但一种是使用视图并具有 SQL 函数 TotalArticles，然后您的计算就是 articleCount / TotalArticles。我对实体框架了解不多，所以我不确定这是否可行。

如果您不能在数据库中进行计算，那么我想第二次数据库调用是不可避免的，尽管它只是文章的计数，​​因此几乎不会增加太多开销。您可以在主调用之前进行此调用，然后以与上述类似的方式将值添加到结果中，即`PercentageOfArticles = c.Articles.Count() / articleCount`

# python - 将 exec() 与递归函数一起使用

> ID：871887
> 
> 赞同：8
> 
> 时间：2009-05-16T07:21:25.750
> 
> 标签：python, recursion, exec

我想执行一些 Python 代码，在运行时输入，所以我得到了字符串并调用

> 执行（pp，全局（），本地（））

其中**pp**是字符串。它工作正常，除了递归调用，例如，这个代码是好的：

```
def horse():
    robot.step()
    robot.step()
    robot.turn(-1)
    robot.step()

while True:
    horse() 
```

但这不是：

```
def horse():
    robot.step()
    robot.step()
    robot.turn(-1)
    robot.step()
    horse()

horse() 
```

> NameError：未定义全局名称“马”

有没有办法运行递归代码？

更新

```
a = """\
def rec(n):
    if n > 10:
        return
    print n
    return rec(n+1)

rec(5)"""

exec(a) 
```

如果放在顶层就可以工作。但如果在函数内部移动：

```
def fn1():
    a = """\
def rec(n):
    if n > 10:
        return
    print n
    return rec(n+1)

rec(5)"""

    exec(a)

fn1() 
```

发生同样的错误： NameError: global name 'rec' is not defined

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T09:45:06.793

一开始这也让我感到惊讶，并且似乎是一个奇怪的极端情况，其中 exec 的行为既不像顶级定义，也不像封闭函数中的定义。看起来正在发生的事情是函数定义正在您传入的 locals() dict中执行。但是，定义的函数实际上并没有访问这个 locals dict。

通常，如果您在顶层定义函数，则局部变量和全局变量是相同的，因此函数在内部可见，因为它们可以在全局变量中看到函数。

当一个函数在另一个函数的作用域内定义时，python 会注意到它在函数内被访问，并创建一个闭包以便“马”映射到外部作用域中的绑定。

在这里，这是一个奇怪的中途案例。exec 就像定义在顶级一样，因此不会创建任何闭包。但是，由于局部变量与全局变量不同，因此定义不会出现在函数可以访问它的地方——它仅在不可访问的外部局部字典中定义。

你可以做几件事：

1.  对本地人和全局人使用相同的字典。即“ `exec s in locals(),locals()`”（或者更好，只需使用您自己的字典）。仅提供 globals() dict 具有相同的效果 - 即 " `exec s in mydict`" #
2.  将 func 放在它自己的函数中，这样就创建了一个闭包。例如

    ```
    s="""
    def go():
        def factorial(x):
            if x==0: return 1
            return x*factorial(x-1)
        print factorial(10)
    go()""" 
    ```

3.  [正如斯蒂芬的回答](https://stackoverflow.com/questions/871887/using-exec-with-recursive-functions/871983#871983)所建议的那样，通过放置“全局 funcname”指令来强制函数进入 globals() 而不是 locals

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-16T07:30:48.567

这个对我有用：

```
a = """\
def rec(n):
    if n > 10:
        return
    print n
    return rec(n+1)

rec(5)"""

exec(a)
5
6
7
8
9
10 
```

我只能说您的代码中可能存在错误。

**编辑**

干得好

```
def fn1():
    glob = {}
    a = """\
def rec(n):
    if n > 10:
        return
    print n
    return rec(n+1)

rec(5)"""
    exec(a, glob)

fn1() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-16T08:30:27.423

这对我有用（添加`global rec`）。`rec(5)`调用 local `rec`，但`rec(n+1)`在没有它的情况下调用全局 rec （不存在）。

```
def fn1():
    a = """global rec
def rec(n):
    if n > 10:
        return
    print n
    return rec(n+1)

rec(5)"""

    exec(a) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T08:05:53.113

“NameError: global name 'rec' is not defined”意味着它在全局范围内寻找rec，而不是在本地范围内。看起来它是在本地范围内定义 rec ，然后尝试在全局范围内执行。尝试在您正在执行的字符串中打印 locals() 和 globals()。

[更多信息。](http://www.python.org/doc/2.5.2/ref/exec.html)

# c++ - 从函数返回对象时是否有任何临时创建？

> ID：871888
> 
> 赞同：1
> 
> 时间：2009-05-16T07:21:49.180
> 
> 标签：c++, function

当一个函数有一个按值传递的对象时，它使用复制构造函数或按位复制来创建一个临时放置在堆栈上以在函数内部使用，从函数返回的一些对象怎么样？

```
//just a sample code to support the qn
rnObj somefunction()
{
return rnObj();
} 
```

并解释如何将返回值传递给被调用的函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T08:45:52.597

正如其他答案所判断的那样 - 编译器可以对此进行优化。

使用 MSVC 生成的具体示例，以解释这是*如何*实现的（如评论之一所述） -

上课——

```
class AClass
{
public:
   AClass( int Data1, int Data2, int Data3 );

   int GetData1();

private:
   int Data1;
   int Data2;
   int Data3;
}; 
```

通过以下简单的实现 -

```
AClass::AClass( int Data1, int Data2, int Data3 )
{
    this->Data1 = Data1;
    this->Data2 = Data2;
    this->Data3 = Data3;
}

int AClass::GetData1()
{
    return Data1;
} 
```

以下调用代码 -

```
AClass Func( int Data1, int Data2, int Data3 )
{
    return AClass( Data1, Data2, Data3 );
}

int main()
{
    AClass TheClass = Func( 10, 20, 30 );
    printf( "%d", TheClass.GetData1() );
} 
```

（添加 printf() 只是为了确保编译器不会优化所有内容......）。
在未优化的代码中，我们希望 Func() 在其堆栈上创建一个本地 AClass，在那里构造它并将其复制为它的返回变量。

但是，生成的程序集实际上看起来像（删除不需要的行） -

```
_TEXT SEGMENT
___$ReturnUdt$ = 8   ; size = 4
_Data1$ = 12         ; size = 4
_Data2$ = 16         ; size = 4
_Data3$ = 20         ; size = 4

mov     eax, DWORD PTR _Data3$[esp-4]
mov     ecx, DWORD PTR _Data2$[esp-4]
mov     edx, DWORD PTR _Data1$[esp-4]
push    esi
mov     esi, DWORD PTR ___$ReturnUdt$[esp]
push    eax
push    ecx
push    edx
mov     ecx, esi
call    ??0AClass@@QAE@HHH@Z    ; AClass::AClass
mov     eax, esi
pop     esi
ret     0 
```

从栈中取出3个函数变量，放入eax、ecx、edx。
另一个第四个值被放入 esi（并传递给 ecx）。
使用堆栈上的 3 个参数调用构造函数，并且 ecx 仍然包含第四个值。

让我们看一下构造函数——

```
_TEXT SEGMENT
_Data1$ = 8    ; size = 4
_Data2$ = 12   ; size = 4
_Data3$ = 16   ; size = 4

mov    edx, DWORD PTR _Data2$[esp-4]
mov    eax, ecx
mov    ecx, DWORD PTR _Data1$[esp-4]
mov    DWORD PTR [eax], ecx
mov    ecx, DWORD PTR _Data3$[esp-4]
mov    DWORD PTR [eax+4], edx
mov    DWORD PTR [eax+8], ecx

ret    12   ; 0000000cH 
```

3 个构造函数参数被读入 eax 的偏移量 - eax 是 ecx 的副本，即上面调用的第四个参数。
因此，构造函数在它被告知的位置构建对象 - Func() 的第四个参数。

而且，您猜对了，Func() 的第四个参数实际上是整个程序中存在构造的 AClass 的真正单个位置。让我们看一下 main() 的相关部分 -

```
_TEXT SEGMENT
_TheClass$ = -12    ; size = 12
_main PROC

sub    esp, 12

push   30
push   20
lea    eax, DWORD PTR _TheClass$[esp+20]
push   10
push   eax
call   ?Func@@YA?AVAClass@@HHH@Z    ; Func 
```

为 AClass 保留 12 个字节，并传递 Func() 的三个参数，以及指向这 12 个字节的第四个参数。

这是具有特定编译器的特定示例。其他编译器以不同的方式执行此操作。但这就是事物的精神。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-16T07:24:54.227

C++ 标准规定编译器可以选择使用复制构造函数创建临时对象，也可以选择优化掉临时对象。

有一篇关于这个主题的维基百科文章，[这里](http://en.wikipedia.org/wiki/Return_value_optimization)有很多参考资料。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T07:25:59.717

允许编译器在返回时执行复制。大多数编译器不会。但是，您必须确保它`rnObj`具有可访问的复制构造函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T07:31:31.870

如果打开优化，大多数现代编译器将能够避免创建临时对象。有关详细信息，请参阅[命名返回值优化。](http://msdn.microsoft.com/en-us/library/ms364057(VS.80).aspx)

# javascript - jquery ui.slider：添加点击事件以显示/隐藏句柄

> ID：871893
> 
> 赞同：3
> 
> 时间：2009-05-16T07:23:31.657
> 
> 标签：javascript, jquery, jquery-ui

我对 javascript 和 jquery 完全陌生。我的编程知识......不存在，我几天前刚开始做一些简单的任务，比如替换 CSS 类或切换 div。因此，如果我在这里问新手问题会踩到别人的脚趾，我想道歉。但我希望有人可以帮助我并解决我的问题。

我需要为调查实施某种视觉模拟量表；ui.slider 非常适合那个。但我需要默认隐藏句柄。当用户点击滑块时，手柄应出现在正确的位置。这应该相当简单——至少我希望如此——只需用 CSS 隐藏句柄并通过滑块上的单击事件来更改它。

我使用以下代码将一个普通的 div （在我的理解中需要一个 div 来应用 jquery slider.js）包装到我的输入元素（它们应该 - 至少在视觉上 - 被滑块替换）并传递值滑块到输入元素（需要将值传递给表单）。正常工作。（我这样做而不是默认在我的 DOM 中放置一个 div，因为我无法影响一些 PHP 脚本，这些脚本将生成调查的表单元素等等）

```
$(function () {
    $.each($('.slider'),
        function () {
            obj = $(this);
            obj.wrap('<div></div>');
            obj.parent().slider({
                change: function (event, ui) {
                    $('input', this).val(ui.value);
                }
            });
        });
}); 
```

隐藏滑块句柄可以通过 CSS 来完成，如上所述，通过更改`a.ui-slider-handle`. 但是当我向滑块添加一个普通的单击事件来`(.ui-slider)`更改句柄的 CSS 属性时，什么也没有发生。就我的基本知识而言，它应该与单击事件对生成的 DOM 元素不起作用有关。我说得对吗？如果是的话：我该如何解决这个问题？有人可以为我的功能提供一段代码并解释它，以便我可以理解到底发生了什么吗？

我在 learningjquery.com 上阅读了有关事件的教程，但自从我开始使用 JS/jquery 来理解这些步骤并将其转化为我的示例/问题以来，过去几天我没有取得足够的进展。而且我的时间不多了（我需要这个来进行一项我必须尽快进行的调查，这就是为什么我希望有人能给我一个提示，以便我能以某种方式解决这个小问题）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-17T18:36:51.473

有什么理由不能只在更改事件中包含节目而不是点击？它在代码方面更简洁，而不是包含一个全新的事件。

```
$(function() {
  $('.slider').wrap('<div></div>').parent().slider({
    change: function(event, ui) {
      $('input', this).val(ui.value);
      $('.ui-slider-handle').show();
    }
  });
}); 
```

此外，代码中存在一些冗余——大多数 jQuery 函数返回对象本身，因此您可以将它们链接起来。而且您不需要每个函数，因为大多数 jQuery 函数在应用于集合时也会在所有函数上运行:)

# javascript - 条件运算符中的多个语句

> ID：871904
> 
> 赞同：0
> 
> 时间：2009-05-16T07:29:05.607
> 
> 标签：javascript

嗨，我需要在条件运算符中编写多个语句。

if 条件与条件运算符等效的是什么

```
var name;
var age;
var passed;

if ( arg == "first" )
{
     name = "John";
     age = "25";
     passed = false;
}
else
{
     name = "Peter";
     age = "29";
     passed = true;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T07:32:17.297

嗯，你的意思是三元运算符吗？

```
var passed = arg == "first"
    ? (name = "John", age = "25", false) 
    : (name = "Peter", age = "29", true); 
```

我对 embedjs 的快速检查表明它或多或少地工作。但为什么？你为什么需要那个？它将有资格成为主要的 WTF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T07:46:45.517

如果您处于需要基于布尔条件执行语句的情况，您应该真正使用 if-else。条件运算符实际上是为了从表达式返回一个值，而不是执行完整的语句。通过使用条件运算符，您使您的代码更难阅读和更危险的调试。

如果您坚持使用条件运算符，alamar 的解决方案似乎非常适合您的需要。但是，我建议您大力注释您的代码。下次您需要修改代码时，该注释可能是花 60 秒理解和花 0.6 秒理解之间的区别。

而且，如果您确实对其进行了评论，那么在 if-else 语句上使用按字符较短的条件运算符确实不会节省带宽。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-18T17:15:07.767

Javascript 支持对象文字 - 如果您只想实例化一组变量或另一组变量，请尝试以下操作：

```
var obj = arg == "first" ? 
            { name : "John", age : "25", passed : false } : 
            { name : "Peter",  age : "29", passed : true }; 
```

Afterwards, you could refer to name, age, and passed as obj.name, obj.age, and obj.passed. Depending on how commonly you use these three variables together, you might wish to choose to make them a real class.

Compared to [alamar](https://stackoverflow.com/users/36498/alamar)'s solution, this does without side effects (beyond the setting of obj, which will likely make your code easier to maintain in the long run.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T07:59:21.990

如果您需要执行多个操作作为条件检查的一部分，请考虑为您列出的代码创建一个函数，并在您需要检查的代码中调用该函数。这将使您的代码保持整洁并且您的功能易于理解。

# sql - 在 UPDATE 查询中使用 SELECT

> ID：871905
> 
> 赞同：14
> 
> 时间：2009-05-16T07:30:18.690
> 
> 标签：sql, ms-access-2007, sql-update

如何在 Microsoft Access 2007`UPDATE`中使用查询结果来获取表的字段。`SELECT`

这是选择查询：

```
SELECT Min(TAX.Tax_Code) AS MinOfTax_Code
FROM TAX, FUNCTIONS

WHERE (((FUNCTIONS.Func_Pure)<=[Tax_ToPrice]) AND ((FUNCTIONS.Func_Year)=[Tax_Year]))

GROUP BY FUNCTIONS.Func_ID; 
```

这是更新查询：

```
UPDATE FUNCTIONS

 SET FUNCTIONS.Func_TaxRef = [Result of Select query] 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-16T10:16:37.293

好吧，看起来 Access 无法在 UPDATE 查询中进行聚合。但它可以在 SELECT 查询中进行聚合。因此，使用如下定义创建一个查询：

```
SELECT func_id, min(tax_code) as MinOfTax_Code
FROM Functions
INNER JOIN Tax 
ON (Functions.Func_Year = Tax.Tax_Year) 
AND (Functions.Func_Pure <= Tax.Tax_ToPrice) 
GROUP BY Func_Id 
```

并将其保存为 YourQuery。现在我们必须解决另一个访问限制。UPDATE 查询不能对查询进行操作，但可以对多个表进行操作。因此，让我们将查询转换为带有 Make Table 查询的表：

```
SELECT YourQuery.* 
INTO MinOfTax_Code
FROM YourQuery 
```

这将视图的内容存储在名为 MinOfTax_Code 的表中。现在您可以执行 UPDATE 查询：

```
UPDATE MinOfTax_Code 
INNER JOIN Functions ON MinOfTax_Code.func_id = Functions.Func_ID 
SET Functions.Func_TaxRef = [MinOfTax_Code].[MinOfTax_Code] 
```

在 Access 中执行 SQL 有点牵强，我会为您的项目研究 Sql Server Express Edition！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-16T09:46:16.913

不久前，我写了关于Access/JET SQL[中相关子查询](http://ewbi.blogs.com/develops/2004/07/accessjet_sql_u.html)的一些限制，并指出了为 SQL UPDATE 连接多个表的语法。基于该信息和一些快速测试，我认为没有任何方法可以在单个 SQL UPDATE 语句中使用 Access/JET 执行您想要的操作。如果可以的话，该声明将如下所示：

```
UPDATE FUNCTIONS A
INNER JOIN (
  SELECT AA.Func_ID, Min(BB.Tax_Code) AS MinOfTax_Code
  FROM TAX BB, FUNCTIONS AA
  WHERE AA.Func_Pure<=BB.Tax_ToPrice AND AA.Func_Year= BB.Tax_Year
  GROUP BY AA.Func_ID
) B 
ON B.Func_ID = A.Func_ID
SET A.Func_TaxRef = B.MinOfTax_Code 
```

或者，Access/JET 有时会让您将子查询保存为单独的查询，然后以更传统的方式将其加入 UPDATE 语句中。因此，例如，如果我们将上面的 SELECT 子查询保存为名为 FUNCTIONS_TAX 的单独查询，那么 UPDATE 语句将是：

```
UPDATE FUNCTIONS
INNER JOIN FUNCTIONS_TAX
ON FUNCTIONS.Func_ID = FUNCTIONS_TAX.Func_ID
SET FUNCTIONS.Func_TaxRef = FUNCTIONS_TAX.MinOfTax_Code 
```

但是，这仍然行不通。

我相信完成这项工作的唯一方法是将最小 Tax_Code 值的选择和聚合移到带外。您可以使用 VBA 函数或更轻松地使用 Access DLookup 函数来执行此操作。将上面的 GROUP BY 子查询保存到名为 FUNCTIONS_TAX 的单独查询中，并将 UPDATE 语句重写为：

```
UPDATE FUNCTIONS
SET Func_TaxRef = DLookup(
  "MinOfTax_Code", 
  "FUNCTIONS_TAX", 
  "Func_ID = '" & Func_ID & "'"
) 
```

请注意，DLookup 函数可防止此查询在 Access 之外使用，例如通过 JET OLEDB。此外，这种方法的性能可能会非常糟糕，具体取决于您定位的行数，因为正在为每个 FUNCTIONS 行执行子查询（因为，当然，它不再相关，这是顺序的重点让它工作）。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-29T21:08:09.523

我有一个类似的问题。我想在一列中找到一个字符串，然后将该值放在同一张表的另一列中。下面的 select 语句查找括号内的文本。

当我在 Access 中创建查询时，我选择了所有字段。在该查询的 SQL 视图中，我将 mytable.myfield 替换为我想要从括号内获取值的字段

```
SELECT Left(Right(OtherField,Len(OtherField)-InStr((OtherField),"(")), 
            Len(Right(OtherField,Len(OtherField)-InStr((OtherField),"(")))-1) 
```

我运行了一个生成表查询。生成表查询具有上述替换的所有字段，并以`INTO NameofNewTable FROM mytable`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T07:50:32.777

这行得通吗？未经测试，但应该明白这一点。

```
UPDATE FUNCTIONS
SET Func_TaxRef = 
(
  SELECT Min(TAX.Tax_Code) AS MinOfTax_Code
  FROM TAX, FUNCTIONS F1
  WHERE F1.Func_Pure <= [Tax_ToPrice]
    AND F1.Func_Year=[Tax_Year]
    AND F1.Func_ID = FUNCTIONS.Func_ID
  GROUP BY F1.Func_ID;
) 
```

基本上，对于 FUNCTIONS 中的每一行，子查询确定最小的当前税码并将 FUNCTIONS.Func_TaxRef 设置为该值。这是假设 FUNCTIONS.Func_ID 是主键或唯一键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-03T22:16:21.297

我确实想再添加一个使用 VBA 函数的答案，但它确实可以在一个 SQL 语句中完成工作。虽然，它可能很慢。

```
UPDATE FUNCTIONS
SET FUNCTIONS.Func_TaxRef = DLookUp("MinOfTax_Code", "SELECT
FUNCTIONS.Func_ID,Min(TAX.Tax_Code) AS MinOfTax_Code
FROM TAX, FUNCTIONS
WHERE (((FUNCTIONS.Func_Pure)<=[Tax_ToPrice]) AND ((FUNCTIONS.Func_Year)=[Tax_Year]))
GROUP BY FUNCTIONS.Func_ID;", "FUNCTIONS.Func_ID=" & Func_ID) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-17T17:13:19.660

我知道这个话题很老，但我想我可以添加一些东西。

我无法在 MS Access 2010 中使用 SQL 进行选择查询更新。我使用了 Tomalak 的建议来完成这项工作。我有一个截图，但显然这个网站上的新手太多了，无法发布它。

我可以使用查询设计工具来做到这一点，但即使我正在查看一个确认成功的更新查询，Access 也无法向我展示实现它的 SQL。所以我不能单独使用 SQL 代码来完成这项工作。

我创建了我的选择查询并将其保存为单独的查询。在查询设计工具中，我添加了我正在尝试更新我保存的选择查询的表（我将唯一键放在选择查询中，因此它们之间有一个链接）。正如 Tomalak 所建议的，我将查询类型更改为更新。然后我只需要选择我试图更新的字段（并指定表）。在“更新至”字段中，我输入了来自我带来的选择查询的字段名称。

此格式成功并更新了原始表。

# php - 带有 curl 的 xpath 给出空结果？

> ID：871908
> 
> 赞同：0
> 
> 时间：2009-05-16T07:31:32.480
> 
> 标签：php, xml, xpath, curl

这段代码给了我一个空的结果。我希望它能从 XML 文件中打印出标题。我需要使用 Curl 来获取文件。

```
<?php    
function get_url($url)
{
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_URL, $url);
    $data = curl_exec($ch);
    curl_close($ch);

    return $data;
}

$xml_content = get_url("http://www.e24.se/?service=rss&type=latest");

$dom = new DOMDocument();
@$dom->loadXML($xml_content);
$xpath = new DomXPath($dom);
$results = $xpath->query('//channel//title/text()');

foreach ($results as $result) 
{
    echo $result->title . "<br />";
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T07:57:55.147

我已经找到了。循环是错误的。它应该是...

```
foreach ($results as $result) 
{
    echo $result->nodeValue . "<br />";
} 
```

# security - 存储私人数据时的安全风险

> ID：871914
> 
> 赞同：2
> 
> 时间：2009-05-16T07:37:31.717
> 
> 标签：security, privacy

我必须在我的应用程序中处理一些敏感数据，例如密码、信用卡信息等。我可能会遇到哪些安全风险以及如何避免它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T07:45:06.393

*   不要存储信用卡信息（在某些司法管辖区，您这样做可能会触犯法律，或者至少违反商业协议）

*   你没有说你的敏感数据存储在哪里，但加密它是通常的方法。有对称和不对称两种形式。对称意味着您使用相同的密钥进行加密和解密。非对称由公钥/私钥对组成。

*   密码：仅存储密码的加盐散列（即不可逆），并与输入密码的类似加盐散列进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T07:53:26.467

请注意，您真的不应该将信用卡信息以任何形式或形式存储在 Web 服务器上。

关于在 Web 环境中执行此操作的一些信息，这是我的背景：

如果网站（或任何应用程序）需要存储卡信息，则应符合 PCI DSS（支付卡行业数据安全标准）。除其他外，它要求将数据加密保存在不可公开访问的单独服务器上（IE：不托管该站点），并且在它和网络服务器之间有一个单独的防火墙。如果发生安全漏洞后的任何欺诈活动，对不遵守规定的处罚可能会非常大，并且可能包括他们停止与您合作 - 它几乎保留他们向您收取欺诈造成的任何损失的权利（来自我的作为非法人的解释）

更多信息在这里：[https ://www.pcisecuritystandards.org/security_standards/pci_dss.shtml](https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml)

显然，与共享主机相比，这可能会很昂贵，因为您立即需要两台服务器和大量网络设备。这就是为什么人们不经常这样做的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T07:44:10.577

我倾向于在存储信息时对信息执行某种形式的可逆加密，例如：

```
$card = myEncryptionFunction($input); 
```

不过，有关您的应用程序性质的更多信息不会受到伤害。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T07:48:25.950

我将对数据库数据使用可逆加密。确保这些数据也不会渗入日志文件，而是记录派生信息。考虑一下你将如何处理不同的环境——通常你不想在*你*的测试环境中使用生产数据。因此，即使您可能考虑将生产数据复制回测试系统，您也应该为敏感部分生成虚假数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-16T09:00:36.900

已经说过，您不应该在数据库中存储 CC 尤其是 CVV2 信息，尽可能避免。

如果您存储 CC + CVV2，请考虑使用非对称加密并将您的私钥存储在另一台服务器中。否则，可以访问 99% 数据的攻击者可以访问密钥，整个加密将毫无意义。

密码应以一种散列方式存储。

毕竟，您需要确保您的应用程序能够抵御 SQL 注入、远程代码执行等漏洞。

不要忘记即使攻击者无法读取以前的数据，他们也可以为下一个数据植入后门。

# c++ - C ++中的Web访问身份验证？

> ID：871917
> 
> 赞同：0
> 
> 时间：2009-05-16T07:38:20.280
> 
> 标签：c++

我正在尝试使用 Qt 框架编写一个简单的 GUI 应用程序。

这个应用程序的目的是从我的 isp 检索数据并解析它们以进行演示。

我如何通过网络服务器验证我的用户/密码并检索有问题的 html 页面？

是否有任何实用程序库使这项任务变得微不足道？

我想我需要与服务器 php 脚本交互并以某种方式模拟表单输入。

我在正确的轨道上吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T07:41:10.723

你在正确的轨道上，我建议看看[curl](http://curl.haxx.se/libcurl/c/)。那应该会容易得多。

*   编辑：嗯，认为它不仅仅是文件传输。否则[这里有更多有趣的库](http://curl.haxx.se/libcurl/competitors.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T09:13:21.457

身份验证的方式完全取决于服务器使用的身份验证方法。如果是某种形式的登录，您需要检索它并将正确的数据发送到表单`action`目标（通常作为`POST`请求）。您可以通过使用[QHttpRequestHeader](http://doc.trolltech.com/4.5/qhttprequestheader.html)构造您的请求然后简单地将其发送到服务器来做到这一点。如果您甚至知道表单，您甚至可能不需要检索登录页面。如果网站使用 HTTP 身份验证，您应该能够使用[QAuthenticator](http://doc.trolltech.com/4.5/qauthenticator.html)。

# javascript - Google Chrome JavaScript 错误 - 无法调用 null 的方法“加入”

> ID：871926
> 
> 赞同：0
> 
> 时间：2009-05-16T07:42:52.093
> 
> 标签：javascript, google-chrome

我开始在谷歌浏览器上测试我的网站和

> '不能调用 null 的方法'join''

执行此操作时出现：

```
var sChoices = oQuestion.aChoiceRand.join(""); 
```

在 IE 和 FF 中运行良好。我试图用这段代码做的是将所有`aChoiceRand`数组元素加入一个字符串中，而不使用任何分隔符。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-16T09:16:36.143

问题的原因必须更早，当`oQuestion.aChoiceRand`被分配时：您认为它已分配给一个数组（显然 IE 和 FF 同意您的观点），Chrome 告诉您它是空的。如果没有看到应该分配其值的代码，我们真的无能为力`oQuestion.aChoiceRand`......

# c# - 我应该在哪里以及如何保存许可证相关信息？

> ID：871943
> 
> 赞同：0
> 
> 时间：2009-05-16T07:56:06.663
> 
> 标签：c#, .net, licensing, copy-protection

我有一个应用程序 (C#)，我的任务是在其中放入一些简单的许可方案。这样做时，我需要将该信息保存在计算机中的某个位置以限制使用。

我需要保存一个日期和一个计数器。

我应该如何以及在何处保存在 Windows Vista 上不需要管理权限即可运行的信息？（这意味着将其保存在 System32、Program Files、HKEY_LOCAL_MACHINE 不是一个选项。）

请不要用“不要这样做”或“无论如何它都会被破解”来淹没答案。我确实理解这些逻辑。我只需要为此目的做任何可以做到的最好的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T08:03:58.860

考虑使用第三方许可组件，例如[XHEO](http://www.xheo.com/) - 无需重新发明轮子。

如果您仍然需要编写自己的许可证系统，请考虑使用用户的配置文件目录或`HKEY_CURRENT_USER`分支。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-16T15:33:09.577

我们使用签名的 XML 许可文件。这是一个简单的 XML 文件，显示用户购买的内容。

这样做的好处是它是未来的兼容。您可以轻松添加产品功能或产品线、到期日期和功能属性。

我们的商业网站很容易按需创建和打包许可证，只要确保您的私钥永远不会泄露。对我们来说，优点胜过缺点，而我们无法规避的最大问题就是简单地处理许可证文件。

这是一个示例 xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<ProductName>
  <License>
    <LicenseId>20025fb9-5349-46d4-a530-55b0295beaaa</LicenseId>
    <CustomerName>Scott.Cate@Example.com</CustomerName>
    <MajorVersion>2008</MajorVersion>
    <Product>Friendly Display Name</Product>
    <ProductType>Enterprise</ProductType>
    <Features>
      <!--Add features here-->
    </Features>
    <Expires>0001-01-01T00:00:00</Expires>
  </License>
  <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
    <SignedInfo>
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" />
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
      <Reference URI="">
        <Transforms>
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" />
        </Transforms>
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
        <DigestValue>u3{..........}U2jo=</DigestValue>
      </Reference>
    </SignedInfo>
    <SignatureValue>QFg1kI{...............}DwDIE=</SignatureValue>
  </Signature>
</ProductName> 
```

我们使用简单的 .NET 内置 API 来进行 XML 签名，并确认它已签名且有效。

我喜欢的事 ...

.. 这很容易阅读。（用于技术支持） .. 易于更换 .. 易于存储在文件系统中，或者在我们的例子中，在数据库中，便于访问和退出 UI。（我们有一个适当的更新/升级系统）.. 升级很容易。我们有一项服务可以获取您的旧许可证，并在验证后根据已购买的内容提供升级定价。然后商务系统记录新旧许可证文件以供参考。

我不喜欢的东西...

..可以复制，容易被盗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T10:20:37.410

对于企业，我们总是使用 app_root/LICENSE 目录。

我们还使用自己的自定义解决方案，但加密这些数据并验证许可证日志以进行操作是相当简单的。

# asp.net - 自定义 RoleProvider：无法在 UsersInRole 表中插入记录

> ID：871951
> 
> 赞同：0
> 
> 时间：2009-05-16T08:00:53.983
> 
> 标签：asp.net, linq-to-sql, exception, roleprovider

我已经实现了一个基于 LINQ to SQL 的方法`RoleProvider`，当我将角色分配给用户时，在`AddUsersToRoles`调用方法时抛出异常。我在这张表上定义了一个复合主键`userid`& ，它仍然抛出这个异常：`roleId`

> 无法对“表（UsersInRole）”执行创建、更新或删除操作，因为它没有主键。

我的 LinQ to SQL 实现`AddUsersToRoles`方法如下。它在`db.UsersInRoles.InsertOnSubmit(userInRole);`

```
using (RussarmsDataContext db = new RussarmsDataContext())
{
  List<UsersInRole> usersInRole = new List<UsersInRole>();
  foreach (string username in usernames)
  {
    foreach (string rolename in rolenames)
    {
      UsersInRole userInRole = new UsersInRole();
      object userId = ProvidersUtility.GetUserIdByUserName(username,applicationName);
      object roleId = ProvidersUtility.GetRoleIdByRoleName(rolename,applicationName);
      if (userId != null && roleId != null)
      {
        userInRole.UserId = (Guid)userId;
        userInRole.RoleId = (Guid)roleId;
        db.UsersInRoles.InsertOnSubmit(userInRole);
      }
    }
  }
  try
  {
    //  db.UsersInRoles.InsertAllOnSubmit(usersInRole);
    db.SubmitChanges();
  }
  catch (ChangeConflictException)
  {
    db.ChangeConflicts.ResolveAll(RefreshMode.OverwriteCurrentValues);
    db.SubmitChanges();
  }
} 
```

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-10T03:32:22.540

LINQ to SQL 本身并不支持多对多...连接表必须有两个外键列加上 1 个具有`IDENTITY`属性的主键列。

# c++ - GCC 构建问题 (#include_next limits.h)

> ID：871952
> 
> 赞同：12
> 
> 时间：2009-05-16T08:01:25.513
> 
> 标签：c++, linux, gcc, g++, gnu-make

当我尝试

```
$ 使依赖 -f gcc.mak
```

我的 Ubuntu 机器上的中间件我得到了这个

```
/usr/include/../include/limits.h:125:26：错误：没有搜索limits.h的包含路径
```

这是limits.h:125周围的内容：

```
/* 获取编译器的limits.h，它定义了几乎所有的ISO 常量。

    我们把这个#include_next 放在双重包含检查之外，因为
    应该可以多次包含这个文件并且仍然得到
    gcc 标题中的定义。*/
#if 定义 __GNUC__ && !defined _GCC_LIMITS_H_
/* `_GCC_LIMITS_H_' 是 GCC 文件定义的。*/
# include_next <limits.h>
＃万一

```

我试过设置

```
$ export INCLUDE=/usr/lib/gcc/x86_64-linux-gnu/4.3/include-fixed/
$ export C_INCLUDE_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.3/include-fixed/
$ export CPLUS_INCLUDE_PATH=/usr/lib/gcc/x86_64-linux-gnu/4.3/include-fixed/

```

（这是我在我的系统上找到另一个 limits.h 的地方）。我已经安装了 libc6-dev，会不会是它的 limits.h 被另一个包覆盖了？我需要另一个 -dev 包吗？或者是否需要环境变量；也许这可以通过其他方式规避？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-22T19:32:39.047

我在进行交叉编译时遇到了这个问题。当您执行“makedepend”时，Makefile 将调用 makedepend 程序，从这个分配中可以看出：

```
MAKEDEPPROG=makedepend 
```

makedepend 只搜索一些以`/usr/include`

由于该`#include_next`指令意味着在搜索路径中包含命名包含文件的下一个找到的实例，如果没有找到另一个实例，这将失败。

对我来说，解决方案是先让 makedepend 搜索我的交叉编译器包含目录。我通过更改`MAKEDEPPROG`分配以包含`-I`指令来做到这一点：

```
MAKEDEPPROG=makedepend -I < path/to/cross-compiler/include-fixed > 
```

我建议阅读 makedepend 程序（我以前对此一无所知）。例如，makedepend 不会使用环境搜索路径对我来说并不明显。该`-I`指令将指定的搜索路径放在 makedepend 的默认路径之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-16T05:21:42.450

我在使用 STLport 5.1.5 进行编译时遇到了问题，但看起来问题已解决是 STLport 5.2.0。该问题记录在 STLport [Release Notes](http://stlport.sourceforge.net/News.shtml)中。获得 STLport 5.2.1 的副本后，编译成功，没有出现任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-26T13:24:50.487

这很可能是这个问题：[https](https://jira.apache.org/jira/browse/STDCXX-768) ://jira.apache.org/jira/browse/STDCXX-768 。我的解决方法是添加编译器选项-I/usr/lib/gcc/x86_64-linux-gnu/4.3/include-fixed（此路径包含limits.h）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T08:13:25.890

考虑使用`#include_next <limits.h>`(gcc extension) 以强制 gcc 查看`limits.h`包含路径中的下一个（应该是工具集的副本）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-26T21:39:18.900

您需要的软件包是 glibc。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-08-10T09:35:01.893

我不再完全记得这个决议了，但它与一些丢失的包裹有关。在获得更多东西之后，它对我有用。

# wix - Building Wix 3.0 升级和补丁

> ID：871957
> 
> 赞同：-1
> 
> 时间：2009-05-16T08:06:30.990
> 
> 标签：wix, upgrade, patch, wix3

1）构建补丁的最佳实践是什么？

2）是否可以在主要升级（更改产品代码）构建之间构建补丁？

3）如何为产品发送内容（静态文件）更新我们试图通过补丁来做到这一点，但是只更新了 200 个文件就花了很多时间，基本上我们的要求是我们希望在他之后定期向用户发送内容更新已安装产品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-08T10:30:45.890

WiX 文档包含有关创建补丁的信息。我强烈建议在旧的 PatchCreation 元素上使用 WiX v3.0 Patch 元素。可以仅针对您想要的片段进行修补。

# xml - XML 文件中的特殊字符 - 使用 DOM API 处理

> ID：871963
> 
> 赞同：5
> 
> 时间：2009-05-16T08:13:04.937
> 
> 标签：xml, dom, special-characters

我有一个 XML 格式的文件（仅包含根开始和结束标记，以及根的子项）。子元素的文本元素包含 & 符号。在 XML 中，不允许使用此符号以使文档有效，当我尝试使用 Java 中的 DOM API 和 XML 解析器处理文件时，我得到了解析错误。因此，我将 & 替换为`&amp;`，并成功处理了文件：我必须提取不同纯文本文件中文本元素的值。

当我打开这些新创建的文本文件时，我希望看到`&amp;`，但是有 & 。为什么是这样？我已将文本存储在没有任何扩展名的文本文件中（我的 XML 格式的原始文件也没有 .xml 扩展名），并且无论我如何打开文件，我在新文件的文本中都只有 &：作为 txt 或 xml 文件（这些是我的 XML 编辑器中的一些选项）。究竟会发生什么？Java (?)`&amp;`会自动转换为 & 吗？还是有一些默认编码？好吧，`&amp;`代表&，我想有一些“不可见的”自动转换，但我很困惑何时以及如何发生这种情况。以下是我使用 Java 处理原始文件后收到的原始文件和提取文件的示例：

这是我的 XML 格式的“negative.review”文件：

```
<review>
<review_text>
I will not wear it as it is too big &amp; looks funny on me. 
</review_text>
</review> 
```

这是我提取的文件“negative_1”：

```
I will not wear it as it is too big & looks funny on me. 
```

对我来说，保留原始数据很重要（不进行任何转换/替换），所以我认为我必须处理提取的文件“negative_1”转换回`&amp;`&。如您所见，看来我不必这样做。但我不明白为什么:(。

先感谢您！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-16T08:24:43.990

原因很简单：XML 文件*确实包含*一个`"&"`字符。

它只是以不同的方式表示（即它是“转义的”），因为`"&"`正如您所见，它自己会破坏 XML 文件。阅读 XML 1.0 规范中的相关部分：[“2.4 Character Data and Markup”](http://www.w3.org/TR/REC-xml/#syntax)。这只是几行，但它很好地解释了这个问题。

XML 是数据的表示（！）。不要将其视为文本文件。例子：

您希望将字符串“17 < 20”存储在 XML 文件中。最初，您不能，因为“<”被保留为开始标签括号。所以这将是无效的：

```
<xml>17 < 20</xml> 
```

解决方案：您在特殊/保留字符上使用字符转义，只是为了保持文件的有效性：

```
<xml>17 &lt; 20</xml> 
```

出于所有实际目的，上述代码段包含以下数据（这次以 JSON 表示）：

```
{
  "xml": "17 < 20"
} 
```

这就是为什么您`"&"`在后期处理中看到真实的原因。它以同样的方式被逃脱，但它的*意义*一直保持不变。

上面的例子也解释了为什么`"&"`必须特别对待它：它本身就是 XML 转义机制的一部分。它标志着转义序列的开始，如`"&lt;"`. 因此，它必须自行转义（使用`"&amp;"`，就像您所做的那样）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T08:23:26.863

作为解析文件过程的一部分，任何 XML 解析器都会将诸如`&amp;`、`&lt;`、 、 等实体隐式转换为相应的字符。`&gt;`

# php - PHP：从 javascript 重新加载验证码图像

> ID：871966
> 
> 赞同：2
> 
> 时间：2009-05-16T08:14:20.160
> 
> 标签：php, captcha

我在 PHP 中有一个用户注册表单。我在页面中放置了验证码图像检查。我像这样使用它

```
<img src="captcha.php" alt="Enter this text in the adjacent text box" id="imgCaptcha" /> 
```

在我的 javascript 中，我将使用图像中生成的相同数字（来自 captcha.php 页面）来验证这一点。该数字也在会话变量中设置。现在我想从我的 javascript 将图像重新加载到另一个图像，如果验证失败。有什么办法吗？

在我的 captcha.php 页面中，我随机创建一个数字，然后使用 imagejpeg 创建一个图像。我也将此数字（在图像中）设置为会话变量

请指导我解决这个问题

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-16T08:36:53.540

您需要`captcha.php`使用 ajax 注入页面。做这件事有很多种方法：

*   javascript 使用 XHR，但这可能会很痛苦。[这](http://developer.apple.com/internet/webcontent/xmlhttpreq.html)是一个例子。
*   [jQuery](http://jquery.com)提供了一种简单的方法来做到这一点，例如：

    $('#someButton').click(function() { $('#someDiv').load('captcha.php'); });

*   [prototype.js](http://prototypejs.org)有点冗长，但可以完成工作。[例子](http://www.petefreitag.com/item/515.cfm)。

我建议使用 jQuery，文档中有[很好的示例](http://docs.jquery.com/Ajax)。

如果您的注册页面返回验证错误，则无需使用 javascript 来重新加载验证码，这应该会自动发生。

# java - Java中的线程

> ID：871968
> 
> 赞同：2
> 
> 时间：2009-05-16T08:16:26.693
> 
> 标签：java, multithreading, interrupt

我试图让我的主线程产生一个新线程，并在一段时间后引发中断标志。当它这样做时，生成的线程应该看到该标志并自行终止。

主线程看起来像这样：

```
final Thread t = new Thread()
{
    @Override
    public void run()
    {
        f();
    }
};
t.start();
try
{
    t.join(time);
    t.interrupt();
    if(t.isAlive())
    {
        t.join(allowance);
        if(t.isAlive())
            throw new Exception();
    }
}
catch(Exception e)
{
    System.err.println("f did not terminate in the alloted time");
} 
```

生成的线程在其代码中散布着以下内容：

```
if(Thread.interrupted()) return; 
```

当我处于调试模式时，一切正常。中断标志由主线程引发并被衍生线程捕获。但是，在常规运行模式下，无论我设置多长时间，生成的线程似乎都没有收到中断标志。

有谁知道我做错了什么？

注意：我使用的是 Ubuntu，而且我对任何 Linux 都是新手。问题可能出在操作系统上吗？我没有在任何其他操作系统上测试过代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-16T08:42:41.980

以下是我的猜测：

*   当主线程调用`t.interrupt();`时，t 线程已经完成执行。
*   当主线程`t.interrupt();`在 t 线程中调用时，不再调用检查`interrupted()`标志。
*   由于运行代码，您得到了异常？您是否在“允许”时间之后在代码中抛出异常，或者您有其他类似`ThreadInterruptedException`或类似的异常？尝试编写捕获异常的消息...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T08:25:27.390

看起来好像在 f() 中没有达到 Thread.interrupted() 调用。

您在 Debug 和 Run 模式下看到的不同行为可能是由于竞态条件造成的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T08:58:38.980

你有 Thread.interrupted() 的嵌套检查吗？该方法清除中断标志，因此第二次调用返回 false。您可以改用 isInterrupted() 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-16T19:25:58.737

我建议您考虑使用 ExecutorService，它旨在执行此类操作，并且可以通过其他方式帮助您。

```
ExecutorService service = Executors.newCachedThreadPool();
Future<ResultType> future = service.submit(new Callable<ResultType() {
   public ResultType call() throws Exception {
      // do soemthing
      return (ResultType) ...;
   }
);
// do anything you like until you need to result.
try {
   ResultType result = future.get(5, TimeUnit.SECONDS);
} catch (TimeoutException timedOut) {
  // handle exception
  // cancel the task, interrupting if still running.
  result.cancel(true);
} catch (ExecutionException taskThrewAnException) {
  // handle exception
}
// when you have finished with the service, which is reusable.
service.shutdown(); 
```

# ms-access - NetBeans IDE 6.5 和 Microsoft Access

> ID：871970
> 
> 赞同：0
> 
> 时间：2009-05-16T08:18:08.453
> 
> 标签：ms-access, netbeans6.5

我想知道是否有人以前使用过NetBeansIDE 6.5，并且将MS Access 2007 数据库连接到使用NetBeans 平台中的java Application 选项开发的系统。我将非常感谢帮助，尤其是如果它是发送给我的教程（alanzomo@yahoo.com）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T08:37:35.817

[Netbeans 网站上的本教程](http://wiki.netbeans.org/DemoOnJDBC_ODBC)展示了如何使用 JDBC-ODBC 桥将 Netbeans 连接到 ODBC 数据源。这将适用于 Access 数据库。

或者，您可以使用[Sun 网站上的该工具](http://developers.sun.com/product/jdbc/drivers)来查找 Microsoft Access 的 JDBC 驱动程序。

# javascript - 保留条件注释的缩小器？

> ID：871971
> 
> 赞同：1
> 
> 时间：2009-05-16T08:18:10.667
> 
> 标签：javascript, minify

我尝试了在线[JS Minifier](http://fmarcia.info/jsmin/test.html)，但它删除了条件注释，例如：

```
 var u = navigator.userAgent;var e=/*@cc_on!@*/false;

                           BECOMES

 var u=navigator.userAgent;var e=false; 
```

这会影响代码的操作，因此我不是手动添加删除的注释，而是寻找一个能够智能地保留这些注释和任何此类注释的压缩器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-16T08:37:47.920

据报道，YUICompressor 可以做到这一点。以下是博客的摘录：

...
但不要担心，它并没有你想象的那么糟糕。不幸的是，JSMin 删除了条件编译注释，但我相信这是由于一段时间没有更新，并且没有跟上现代 Web 开发实践的速度。

*使用YUI 压缩器*或打包器等其他工具确实可以很好地处理条件编译。...

[您可以在http://robertnyman.com/2008/05/26/conditional-compilation-in-javascript/](http://robertnyman.com/2008/05/26/conditional-compilation-in-javascript/)阅读整篇文章

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-07T02:28:49.807

YUI Compressor还有[一个 .NET 端口，](http://yuicompressor.codeplex.com/)可让您：-

*   将缩小/文件合并到 Visual Studio 构建后事件中
*   集成到 TFS 构建（包括 CI）
*   如果您只想在自己的代码中使用 dll（例如即时缩小）。

因为这是上面提到的 Vinnie 和 Crescentfresh 提到的（原始）java 版本 YUI Compressor 的一个端口，它应该在 .NET 环境中为您提供相同的结果——不需要 java。

HTH。

# c++ - 引用你没有的类#include'd (C++)

> ID：871982
> 
> 赞同：1
> 
> 时间：2009-05-16T08:30:20.450
> 
> 标签：c++, include, header-files

我现在正在玩 Box2D 以获得乐趣，在掌握了一些概念之后，我决定为测试平台进行自己的测试（Box2D 带有一组示例，并且有一个简单的可扩展测试类用于制作你自己的测试）。我首先抓取了其他测试之一，删除了除函数签名之外的所有内容，并插入了一些我自己的代码。

但是，Box2D 的任何库都没有#includes，因此它不会编译（但只有我的文件错误，删除我的测试文件并且它编译得很好）。我想我一定是在移动东西时不小心删除了它们，但是在检查其他测试文件时，任何地方都看不到#includes。每个文件都使用在各种 Box2D 头文件中声明的数据结构和函数。这到底是如何编译的？

例如，这是剥离构造函数主体和顶部注释的预打包测试之一：

```
#ifndef CHAIN_H
#define CHAIN_H

class Chain : public Test
{
public:
    Chain()
    {
        // Since b2BodyDef isn't defined in this file, and no 
        // other files are included how does this even compile?
        b2BodyDef bd; 

        // rest of constructor...
    }

    static Test* Create()
    {
        return new Chain;
    }
};
#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-16T08:33:21.537

也许定义 b2BodyDef 的标头在此标头之前的 .cpp 中#included ？显然还涉及其他标头，否则您将无法引用 Test 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T09:19:37.883

开头是一个常见的`#ifndef CHAIN_H`模式，向我表明这是来自一个名为`chain.h`.

像您引用的头文件`chain.h`并不打算独立编译。您很可能需要创建一个简单的 C++ 文件，其中包括此文件和之前的必要其他文件：

### 测试.cpp：

```
#include "box2d.h"
#include "chain.h"

// more code here. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-16T13:36:57.843

每个 cpp 文件都会被编译。但是，在编译之前，预处理器会运行。预处理器处理所有以# 开头的关键字，例如#include。预处理器获取任何#include'd 文件的文本并将#include 语句替换为它包含的文件中的所有文本。如果#include'd 文件包含其他文件，它们的文本也会被获取。

预处理器运行后，您会得到一个称为翻译单元的大文本文件。这就是编译的内容。

所以..可能正如其他人所说。某处的 cpp 文件在包含 chain.h 之前包含 Box2D 的东西，所以一切正常。编译器或项目设置中通常有一个选项可以让预处理器创建一个包含翻译单元中所有文本的文件，以便您可以看到它。这有时对于使用#includes 或宏跟踪错误很有用。

# .net - 为什么 Visual Studio 的“添加引用”对话框中的 .NET 选项卡没有列出 GAC 的内容？

> ID：871984
> 
> 赞同：3
> 
> 时间：2009-05-16T08:33:13.547
> 
> 标签：.net, visual-studio-2008, gac

**重复**：[让程序集显示在“添加引用”的 .NET 选项卡中](https://stackoverflow.com/questions/495973/getting-assemblies-to-show-in-the-net-tab-of-add-reference)

所以，我使用的是 Visual C# 2008 Express Edition，我只是走了一点弯路，因为我发现我假设“添加引用”对话框的 .NET 选项卡列出了 GAC 的内容是不正确的.

这对我来说有点问题，因为我想从我的项目中引用的程序集仅在 GAC 中可用。（它是从 XNA 2.0 redistributalbe 获得的 Microsoft.XNA.Framework v2.0，据我所知，它只安装到 GAC 中）。

我通过在 .csproj 文件中手动设置对 Microsoft.XNA.Framework 的引用来解决这个问题，然后从缓存中获取 dll 的副本。然后我能够为 DLL 创建一个目录，将其添加到注册表中 Visual Studio 的程序集目录列表中，然后瞧！我可以在 .NET 选项卡中看到它。

这一切对我来说似乎有点小题大做，我不认为我最初的假设（.NET 选项卡显示 GAC 的内容）有那么不合理或不常见。比我了解更多的人可以告诉我吗

*   为什么没有显示 GAC 的内容？文档只是说它们不是，但是有充分的理由吗？
*   实际上有没有办法让 GAC 的全部内容被列出？我在某处错过的复选框？

非常感谢任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T06:14:46.753

您假设 .NET 选项卡意味着 GAC，但事实并非如此。这意味着已安装的程序集，可能在也可能不在 GAC 中。一些安装在 Program Files 下，然后这些程序集在 .NET 选项卡中可见。

当您添加对项目的引用时（忽略网站项目，因为它们是混蛋子异常并且需要 DIAF），.NET 运行时将使用从可执行目录开始的级联搜索来定位该程序集，检查 PATH 环境变量并以 GAC 结尾。我没有链接，但是 MSDN 上至少有一篇很好的文章专门解释了这一点。

上面的内容在这里似乎没有直接关联，但在某种意义上，当您进行开发时，您可以在开发机器上的某处引用程序集，但是当您将应用程序分发到另一台机器以供生产使用时，该程序集不一定必须与它在您的开发机器上的位置相同。当您开发时，您可以将程序集放在本地或程序文件中，但是如果该程序集在 GAC 中，那么您的程序应该可以在另一台机器上运行。

（通常，当您安装 SDK 时，安装程​​序将足够智能，可以创建在 .NET 选项卡中显示 dll 所需的注册表项。您的 XNA 框架示例可能归结为您安装运行时包而不是 SDK 或其他东西。）

希望有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-04-29T19:05:48.203

下载并使用**Muse** VSReferences 扩展。它会自动为您完成所有这些

s

# c++ - C++ 传递对象的副本与传递指向对象的指针？

> ID：871993
> 
> 赞同：4
> 
> 时间：2009-05-16T08:39:50.177
> 
> 标签：c++, pointers, class, constructor

这是我的 Game 类的构造函数：

```
// Construct a Game to be played with player on a copy of the board b.
Game(const Board& b, Player* player)
{
  ...
} 
```

这是我使用构造函数的方式：

```
Player p("Player Name");
Board b(6,3);
Game g(b, &p); 
```

这是如何运作的？b被复制了吗？

如果我想保存一个指向播放器的指针，我应该像下面这样创建一个私有 ivar 吗？

```
private:
  Player* _player;

...
// In Game constructor
_player = player; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-16T08:42:02.030

如果您通过引用或指针传递，则不会复制。如果你想保存一个指针，那么是的，你需要在某个地方保存它。

请注意，使用构造函数初始化列表而不是赋值通常是更好的做法。更喜欢：

```
Game( const Board& b, Player * player ) : _player( player )
{
    // do something with Board
} 
```

至：

```
Game( const Board& b, Player * player )
{
    _player = player;
    // do something with Board
} 
```

对于指针，没有太大的区别，但对于更复杂的对象，使用初始化避免了赋值可能出现的语义和性能问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-16T08:53:06.230

如前所述，参数不会被复制，因为它是通过引用传递的。
但我想指出一些风格问题。

不要混合你的风格。没有玩家可以玩游戏吗？如果不是，则通过引用传递播放器。

另一种混合。您将一个参数作为整个单词传递，另一个作为一个字母传递。

```
Game(const Board& board, Player& player):
    _player(player)    
{
  ...
}

private:
  Player& _player; 
```

并且可能你也会想要存储 Board，因为它是有意义的。游戏可以“了解”棋盘。

```
private:
    const Board& _board; 
```

那么你的构造函数将是

```
Game(const Board& board, Player& player):
    _board(board),
    _player(player)
{
  ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-16T08:44:20.433

您通过[参考](http://www.parashift.com/c++-faq-lite/references.html)传递董事会，所以不，它没有被复制。

如果您稍后有一些代码，例如：

```
Board _privateBoard = b; 
```

然后你正在复制**b**。但它没有被复制到函数中。

至于你的问题，是的，如果你想取回指针，你需要将指针存储在某个地方。

# clojure - 使用和需要的区别

> ID：871997
> 
> 赞同：161
> 
> 时间：2009-05-16T08:43:03.430
> 
> 标签：clojure

谁能解释 and 之间的区别`use`，`require`无论是直接使用还是作为`:use`and`:require`在`ns`宏中使用？

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2009-05-16T09:24:49.710

`require`加载库（尚未加载），`use`做同样的事情，*加上*它引用它们的命名空间`clojure.core/refer`（所以你也可以`:exclude`像 with 一样使用 etc `clojure.core/refer`）。两者都建议用于`ns`而不是直接使用。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2013-05-07T22:23:01.887

`require`用和包含外部函数是惯用的`refer`。您可以避免命名空间冲突，只包含您实际使用/需要的函数，并且明确声明每个函数的位置：

```
(ns project.core
    (:require [ring.middleware.reload :refer [wrap-reload]])) 
```

我不必通过为其命名空间添加前缀来调用此函数：

```
(wrap-reload) ; works 
```

如果您不使用`refer`，则需要在其前面加上命名空间：

```
(ring.middleware.reload/wrap-reload) ; works if you don't use refer in your require 
```

如果您选择`use`，（几乎）总是使用`only`：

```
(ns project.core
    (:use [ring.middleware.reload :only [wrap-reload]])) 
```

否则，您将包含所有内容，使其成为不必要的大型操作，并且使其他程序员很难找到函数所在的位置。

另外，我强烈推荐[这个博客](https://8thlight.com/blog/colin-jones/2010/12/05/clojure-libs-and-namespaces-require-use-import-and-ns.html)作为学习更多关于 Clojure 命名空间的资源。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-06-20T00:37:08.800

使用 sure 确实更容易，因为它不需要您在每次要调用函数时都拼出命名空间，尽管它也可能通过创建命名空间冲突而使事情变得一团糟。“use”和“require”之间的一个很好的中间立场是仅“使用”您实际使用的命名空间中的函数。

例如：

```
（使用 '[clojure-contrib.duck-streams :only (writer reader)])

```

或者更好的是，在命名空间定义中的文件顶部指定它：

```
（ns com.me.project
   (:use [clojure.contrib.test-is :only (deftest is run-tests)]))

```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-06-18T04:42:10.403

正如已经提到的，最大的区别在于`(require 'foo)`，您可以像这样引用 lib 命名空间中的名称：`(foo/bar ...)`如果这样做，`(use 'foo)`那么它们现在位于您当前的命名空间中（无论可能是什么，只要没有冲突），您可以调用他们喜欢`(bar ...)`。**