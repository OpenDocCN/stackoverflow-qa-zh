# StackOverflow 问答 10623000-10623999

# magento - magento 中产品页面的微格式

> ID：10623001
> 
> 赞同：0
> 
> 时间：2012-05-16T16:43:52.317
> 
> 标签：magento, microformats, rich-snippets

我在 Magento 商店中有一个产品页面，我正在尝试在此页面中使用微格式实现丰富的片段。

我遵循了本指南：http: [//yoast.com/rich-snippets-magento/](http://yoast.com/rich-snippets-magento/)，但是当我尝试此页面上的 Rich Snippets 测试工具时：[http](http://wfltp.zone1global.com/bulb/3m/new_compactview_sx30_basic.html) ://wfltp.zone1global.com/bulb/3m/new_compactview_sx30_basic.html 我明白了

> “在预览生成过程中发现以下错误：空白页面。此页面不包含作者身份或丰富的片段标记。”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:00:33.700

乍一看，您没有修改正确的模板文件。您是否尝试过查看页面的来源以查看标签是否确实在其中？

如果你的标签在那里，你做的不对。使用 Google Rich Snippets Testing Tool 进行测试（毕竟使用这些片段的主要是 Google）。[http://www.google.com/webmasters/tools/richsnippets](http://www.google.com/webmasters/tools/richsnippets)

# c# - 如何在 C# 中从 mysql 结果中读取某些数据

> ID：10623002
> 
> 赞同：1
> 
> 时间：2012-05-16T16:43:59.570
> 
> 标签：c#, mysql, database

我想从 C# 对 mysql 进行某些查询，以便我可以返回例如姓名和姓氏。

我不知道如何在 c# 中处理这个问题，我想尽量减少 sqlinjection。

这是我的代码：

```
con = new MySqlConnection("server=localhost;database=Customers;uid=root;pwd=******");
con.Open();
cmd = new MySqlCommand("SELECT name,lastname FROM customer WHERE ID_customer= ?Parname;", con);
cmd.Parameters.Add("?Parname", MySqlDbType.Float).Value = customer_card;
cmd.ExecuteNonQuery();
con.Close(); 
```

例如，我希望能够读取结果，并且它只是一个结果，在 2 个字符串变量中。如何获取数据并保存？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:50:22.483

您需要一个 DataReader 来遍历记录，而不是使用 cmd.ExecuteNonQuery(); 使用 cmd.ExecuteReader();

```
try 
  { 
    MySqlDataReader myReader = cmd.ExecuteReader(); 

    // Always call Read before accessing data. 
    while (myReader.Read())  
    { 
      //This will get the value of the column "name"
      Console.WriteLine(myReader.GetString(myReader.GetOrdinal("name"))); 
    } 

    // always call Close when done reading. 
    myReader.Close(); 

    // Close the connection when done with it. 
    } 
  finally 
  { 
    con.Close(); 
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T16:55:21.817

从返回一行的查询中获取多个字符串的一种欺骗但快速的方法如下：

```
con = new MySqlConnection("server=localhost;database=Customers;uid=root;pwd=******");
try {
    con.Open();
    cmd = new MySqlCommand("SELECT concat(name,'|',lastname) FROM customer WHERE ID_customer= ?Parname;", con);
    cmd.Parameters.Add("?Parname", MySqlDbType.Float).Value = customer_card; // Are you sure that the ID is float? That's the first time I see anything like that!
    var tokens = ((String)cmd.ExecuteScalar()).Split('|');
    var firstName = tokens[0];
    var lastName = tokens[1];
    Console.Writeln("First={0}, Last={1}", firstName, lastName);
} finally {
    con.Close();
} 
```

这个想法是在 MySql 端将两个字符串组合成一个，然后在 C# 端将它们拆分回来。这个技巧可以让你避免循环通过阅读器，关闭它等等。它假定名称不包含`'|'`字符。

# shell - Bourne Shell：当内壳命令返回非零退出代码时如何终止？

> ID：10623003
> 
> 赞同：1
> 
> 时间：2012-05-16T16:44:06.607
> 
> 标签：shell, exit-code, sh

我有以下简单的 shell 脚本：

```
#   get all servers from config
sshservers=`node $scriptDir/readconfig.js --command cluster.sshservers`

#for each server
for server in sshservers
do

    #run deployserver with server (server:port format) argument
    if ! sh deployserver --server $server
    then
        exit 1 #failure
    fi

done 
```

现在，获取 sshservers 的 node 命令可能会返回一个非零的退出代码。发生这种情况时，事情变得非常糟糕，所以我想退出并显示错误消息。

我该怎么做？这会是最合适的方式吗？

```
sshservers=`node $scriptDir/readconfig.js --command cluster.sshservers`
if ! $?
then
    echo "Error: node readconfig tool failed."
    exit 1
fi 
```

另外，当事情发生如此可怕的错误时，我如何输出这个节点命令的标准错误？

最后，当 sh deployserver 失败时我退出的方式是正确的，还是应该以不同的方式完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:55:28.497

要查看最后一个命令是否成功，您可以这样做：

```
if [ "$?" != "0" ]
    then
        //do something
    fi 
```

stderr 应该可以找到您自己运行脚本的控制台的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:19:48.100

看起来有点奇怪，但这样做是合法的：

```
sshservers=$( node ... ) || exit 1 
```

请注意，您不需要发出错误消息，因为 node 命令应该在退出之前打印出有用的错误诊断信息。您也可以简单地`set -e`在脚本开头添加，如果此表单的任何分配终止，这将导致您的脚本中止。赋值的返回值是“inner”命令的返回值，所以通常的技术都适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T16:56:22.117

使用`$?`，其中包含上次运行命令的退出代码。所以你可以这样做：

```
sshservers=`node $scriptDir/readconfig.js --command cluster.sshservers`
[[ "$?" == "0" ]] || exit 1 
```

你退出`sh deployserver`的方式就是我会做的方式。您可以`$?`根据需要使用，但恕我直言，您拥有它的方式更短更清洁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T17:22:20.217

您还可以将分配放入`if`语句中：

```
if ! sshservers=$(node $scriptDir/readconfig.js --command cluster.sshservers)
then
  echo "oops, node command returned non-zero"
  exit 1
fi

for server in $sshservers; do ... 
```

# html - 显示高度错误：Opera 中的表格 - 盒子模型问题？

> ID：10623006
> 
> 赞同：0
> 
> 时间：2012-05-16T16:44:19.633
> 
> 标签：html, opera, css

在 Opera 中，似乎高度`display: table`是错误的。在下面的例子中，div 的*外部*高度是 100px，而它应该是 160px：

```
#a1 {
        background-color: #66f;
        padding: 30px;
        height: 100px;
        width: 100px;
        display: table;
}

<div id="a1"></div> 
```

看起来像 IE 的旧盒子模型？但是在这种情况下 IE7/8 可以正常工作。

随意玩[http://jsfiddle.net/mpGqU/](http://jsfiddle.net/mpGqU/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:41:32.290

这是 Opera 中的一个已知错误 (CORE-10163)。删除`display:table;`将在此期间解决问题。

# html - 网站在 Mac 上显示不同

> ID：10623008
> 
> 赞同：0
> 
> 时间：2012-05-16T16:44:29.593
> 
> 标签：html, css, browser

[http://www.ab-mobile-apps.com/wp/absbm/](http://www.ab-mobile-apps.com/wp/absbm/)

我正在处理的这个网站在 Windows 上的 chrome 和 firefox 中显示良好（在 3 台计算机上测试）。但是菜单在 chrome 和 firefox 的 mac 上显示错误（在 3 台计算机上测试）。有谁知道为什么会发生这种情况？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:12:06.330

我假设您的意思是背景红色图像不在整个菜单的后面。尝试在您的 Windows 和 Mac Firefox 中使用 FireBug 插件，以找出您需要更改的内容以使两者都能正常工作。还要确保为所有平台使用相同（最新）的浏览器版本，以消除由于版本差异导致的错误。

# mysql - Mysql INSERT数据在表2中为表1中的每一行

> ID：10623010
> 
> 赞同：0
> 
> 时间：2012-05-16T16:44:32.803
> 
> 标签：mysql

我有两张桌子。

表 A 是需要按问题类型过滤的问题列表。例如 SELECT * from TableA WHERE Qtype = "whatever"

然后，我需要为 TableA 上的查询提取的每条记录添加四个新记录到表 B。

表 A 和表 B 在 ID 号上连接 - TableA.id = TableB.questionid

我假设我需要运行它四次，每添加一条记录一次。

我对 FOR EACH 命令和 INNER JOIN 感到困惑

将不胜感激任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T21:12:07.470

恐怕我仍然不完全理解您的问题，但这将为`TableB`的每个记录插入三个记录`TableA`，其中三个不同的值用于`newfield`：

```
INSERT INTO TableB (ID, newfield) (
  SELECT a.ID, n.newfield
  FROM (
    SELECT 'Excellent' AS newfield UNION ALL
    SELECT 'Something' UNION ALL
    SELECT 'Something else'
  ) n
  CROSS JOIN TableA a
) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T16:46:32.880

试试这个 4 次：

```
INSERT INTO TableB (questionid, otherfieldB)
VALUES (
    SELECT id, otherfieldA
    FROM TableA
    WHERE Qtype = "whatever"
) 
```

# java - 如何在 CSV 导出期间保留日期格式

> ID：10623017
> 
> 赞同：3
> 
> 时间：2012-05-16T16:45:04.877
> 
> 标签：java, gwt, date, csv, export

导出到 CSV 时有没有办法保留日期格式？我有一个 GWT 应用程序。例如，我的日期数据是 03-01-2012 和 02-2012。成功将其导出为 CSV 后，当我打开 CSV 文件时，这些日期现在分别看起来像 2012 年 3 月 1 日和 2012 年 2 月 1 日。有没有办法控制它们在 CSV 中的外观？我在它们被导出并且日期正确之前调试并遵循了代码。我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T16:49:01.620

你应该看看 java.text.SimpleDateFormat

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-12T10:33:24.713

您不能（据我所知）在 CSV 文件中传递元信息。因此，要以发送方式查看日期，可以通过以下方式之一传递（数据值在逗号之间）：

, 03-01-2012, ,="03-01-2012",

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:29:07.620

每当您处理约会并希望在工作时保持微笑时，请使用[Joda Time](http://joda-time.sourceforge.net/)

```
DateTimeFormatter formatter = new DateTimeFormatterBuilder().appendMonthOfYear(2)
                          .appendDayOfYear(2).appendYear(4, 4).toFormatter();
LocalDate d = LocalDate.parse(dateStr, formatter);
Date yourJavaDate = d.toDate();
... // work with java date (if needed! :( 
LocalDate outgoing = new LocalDate(yourJavaDate.getTime());
String myOutStr = outgoing.toString(formatter); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T17:00:40.487

据我所知，使用 CSV 时无法控制日期在 Excel 中的显示方式（只能由 Excel 用户的设置控制）。我们遇到了类似的问题（电话号码），唯一可靠的解决方法是使用 Excel 格式。我们使用[Apache POI](http://poi.apache.org/)编写 .xls 文件^([*])，我们可以在其中将单元格类型设置为文本。

至少对于电话号码，这是必要的 - 否则 Excel 会丢弃前导 0，并将它们视为数字（使得无法区分国内和国际电话号码）。然而，对于日期，也许值得考虑，如果让用户决定日期的显示方式会更好吗？

^([*] 我们还提供下载 .csv 文件的功能，并警告说它们在使用 Excel 打开时并不理想。)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-14T07:11:22.617

只需在日期值之前使用一个空格

即，下面的示例查询

```
select ' '||to_char(mydatecolumn,'YYYY-MM-DD HH:MI:SS AM') DATEVALUE from mytable; 
```

尝试将数据导出为 CSV，它将以与导出为 TEXT 的格式相同的格式保存，EXCEL 会将其视为 TEXT，因此不会将其更改为默认的 EXCEL 日期格式。

# .htaccess - htaccess 允许访问特定用户

> ID：10623019
> 
> 赞同：8
> 
> 时间：2012-05-16T16:45:16.407
> 
> 标签：.htaccess

我试图通过 htaccess 限制特定用户对每个文件的访问。
甚至可能吗？
我无法弄清楚如何仅在用户名不是特定用户名时才允许每个文件访问，我使用 PHP 的 HTTP 登录（$_SERVER 的REMOTE_USER）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-16T16:58:11.943

您需要使用 htpasswd 实用程序创建要允许的用户数据库/特定用户。从那里，在您要限制的目录中的 htaccess 文件中，使用：

```
AuthUserFile /path/to/.htpasswd
AuthName "Authorization Form Title"
AuthType Basic

#Allow any valid user
require valid-user

#Allow only one user with specified username
require user username 
```

更多信息可以在大量在线参考资料中找到，这是最早出现的资料之一：http: [//www.apacheweek.com/features/userauth](http://www.apacheweek.com/features/userauth)

# c# - 模型的命名空间（ASP MVC3）在 WorkerRole 中不可见

> ID：10623020
> 
> 赞同：2
> 
> 时间：2012-05-16T16:45:22.497
> 
> 标签：c#, visual-studio-2010, azure, azure-worker-roles, azure-web-roles

我正在 Windows Azure 中制作我的第一个应用程序，但遇到了一些问题。

这是我所做的想法列表：

*   添加新的解决方案
*   添加新的 MyApp.WebPage (asp.net mvc3) 项目
*   添加 Windows Azure 项目，并为其添加一个 WorkerRole
*   将我的 asp.net mvc3 项目作为新的 Web 角色从解决方案添加到 Windows Azure 项目
*   将 MyClass.cs 类添加到我的 WorkerRole

...并添加 MyClass：

```
using MyApp.WebPage.Models; 
```

所以我有这个错误：

```
The type of namespace name 'WebPage' does not exist in the namespace 'MyApp' (are you missing an assemblu reference?) 
```

我是 Azure 的初学者，所以我不知道如何解决这个问题。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:57:29.880

您的辅助角色是一组完全独立于您的 Web 角色代码的代码，并最终部署到不同的 Windows Server 2008 VM 集（都在同一个部署中，并且能够通过 tcp 或 http 在 vm 实例之间进行通信）。您的 web 角色包含您的所有 asp.net mvc 代码，因此可以访问其所有库。

Web Role 和 Worker Role 只定义了与 Windows Server 2008 VM 一起部署的代码，Web Roles 启用了 IIS。如果您将所有代码放入与 Web 角色关联的项目中，那么所有代码​​都将可见。如果您需要在 web 和 worker 角色之间共享代码，您应该将该代码放在其自己的 dll 中，并将其包含在两个项目中。

# c - 如何从 C 和 Igraph 中的两个 id 顶点获取边的 id？

> ID：10623023
> 
> 赞同：1
> 
> 时间：2012-05-16T16:45:26.223
> 
> 标签：c, igraph

如何获取具有两个顶点的特定边的 id？

例子：

egde id=4 与顶点 2 和 3，使用 id 2 和 3 顶点如何获得该边的 id=4？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:17:07.200

[`igraph_get_eid`](http://igraph.sourceforge.net/doc/html/ch04s02s02.html#igraph_get_eid)是您正在寻找的功能。

# php - 在 while 循环中执行 api，给出 500 内部服务器错误

> ID：10623026
> 
> 赞同：1
> 
> 时间：2012-05-16T16:45:53.740
> 
> 标签：php, api, curl

我在一个while循环中用curl执行someapi。如果我不执行 api 而只是回显 api 正在执行的内容，则输出很好......如果我执行那个 api，让我们在一个 while 循环中说 1000 次......它在中途给出 500 内部服务器错误。

我希望 api 应该一个接一个地执行（同步），如果它得到任何错误，它应该忽略它并继续。

这是我的代码：

```
while($res = mysqli_fetch_array($allDetail)){
    $resulter = myCurl($res['var1'],$res['var2']);
}

function myCurl($var1,$var2){
            $ch = curl_init('some_api_url_with_var1_var2');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
    $response = curl_exec($ch);
    curl_close($ch);
} 
```

这是我第一次使用 curl，我也是 php 新手。api返回true或json格式的任何错误，但我不想关心它，只是api继续执行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:35:40.520

HTTP错误分为几类：

*   2xx 是成功消息
*   3xx 是重定向消息
*   4xx 是客户端错误消息
*   5xx 是服务器错误消息

“500 内部服务器错误”是您遇到的 API 上的错误。你可能打得太快了，他们无法处理。如果 API 是您的，请尝试调试那里发生的事情。例如，当 PHP 发出致命错误（内存使用或超时可能导致致命错误）时，Apache 会自动发送 500。其他语言也有类似的行为。

在 while 循环的每次迭代中尝试 a `sleep(1)`。代码应该运行得更慢，但如果一切顺利，这意味着在你用力打击它们之前。还有一个`usleep()`以毫秒而不是秒为单位睡眠的功能。

卷曲有一个`CURLOPT_FAILONERROR`选择。当它设置为 true 时，它​​会忽略错误。如果您想在请求失败时继续循环，应该会有所帮助。该`curl_error()`功能也很有用。

# .net - e.Row.Cells[x] 没有正确索引

> ID：10623027
> 
> 赞同：0
> 
> 时间：2012-05-16T16:45:53.893
> 
> 标签：.net, data-binding, gridview

我目前在我的 asp.net 应用程序中有这个 gridview OnRowDataBound 方法：

```
protected void gvwStatus_OnRowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        string excsCost = e.Row.Cells[3].Text.ToString();
        //do stuff//
    }
} 
```

标记：

```
 <asp:GridView ID="gvwStatus" runat="server" CssClass="gridview" ShowHeaderWhenEmpty="True"
                                        AllowPaging="True" BackColor="Control" OnSorting="gvw_OnSorting" OnPageIndexChanging="gvwStatus_PageIndexChanging"
                                        OnRowDataBound="gvwStatus_OnRowDataBound" AllowSorting="True" AutoGenerateColumns="False"
                                        Width="98%" PageSize="100" Style="margin-left: 10px;">
                                        <Columns>
                                            <asp:TemplateField HeaderText="Item" SortExpression="ITEM_NO">
                                                <ItemTemplate>
                                                    <asp:LinkButton ID="lbtnItemNo" runat="server" CssClass="app_hyperlink" Text='<%#Eval("ITEM_NO") %>'
                                                        OnCommand="lbtnItemNo_OnClick" CommandArgument='<%#Eval("ITEM_NO") %>' />
                                                </ItemTemplate>
                                            </asp:TemplateField>
                                            <asp:BoundField DataField="ITEM_OBS_STATUS" HeaderText="Obs Status" SortExpression="ITEM_OBS_STATUS" />
                                            <asp:BoundField DataField="MIP_NO" HeaderText="MIP" SortExpression="MIP_NO" />
                                            <asp:BoundField DataField="LOT_FROM_EFF_DATE" HeaderText="Chgovr Date" SortExpression="LOT_FROM_EFF_DATE" />
                                            <asp:BoundField DataField="TRGT_CHGOVR_DATE" HeaderText="Target Date" SortExpression="TRGT_CHGOVR_DATE" />
                                            <asp:TemplateField HeaderText="Excess Cost" SortExpression="EXCS_ITEM_COST_TOT">
                                                <ItemTemplate>
                                                    <asp:Label ID="lblExcessCostStatus" runat="server" CssClass="app_label" Text='<%#string.Format("{0:C}", Eval("EXCS_ITEM_COST_TOT")) %>' />
                                                </ItemTemplate>
                                                <ItemStyle HorizontalAlign="Right" />
                                            </asp:TemplateField>
                                            <asp:BoundField DataField="SENT_TS" HeaderText="Sent to Plants/Vndrs" SortExpression="SENT_TS" />
                                        </Columns>
                                        <AlternatingRowStyle BackColor="White" />
                                        <PagerStyle HorizontalAlign="Left" />
                                        <PagerSettings Mode="NumericFirstLast" />
                                        <HeaderStyle CssClass="gvLinkNoUnderline" />
                                    </asp:GridView> 
```

索引在此处无法正常运行。对于我的字符串 excsCost，我指定我想要索引 3（或单元格 4）中的值，但我从索引 5（单元格 6）中获取值。当我指定索引 2 时，我从索引 0 中获取值。似乎完全未对齐。

有人熟悉这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T11:35:19.937

实际上您正在使用`ItemTmplate`，因此您可以通过编程方式获取 Control 并在您的代码中对其进行操作

```
 protected void gvwStatus_OnRowDataBound(object sender, GridViewRowEventArgs e)
    {

      if (e.Row.RowType == DataControlRowType.DataRow)
      {
         Label lblExcsCost = new Label();
         lblExcsCost = e.Row.FindControl("lblExcessCostStatus") as Label;
         string excsCost = lblExcsCost.Text();
      }
    } 
```

# c# - prnadminlib 在以 SYSTEM 身份运行时无法在 winxp 上设置处理器，在域用户时工作

> ID：10623028
> 
> 赞同：0
> 
> 时间：2012-05-16T16:45:54.577
> 
> 标签：c#, .net, winapi, printing

我有一个安装打印机驱动程序的可执行文件，然后使用所述驱动程序创建打印机。我使用从 server 2003 资源工具包中生成的 tlbimp 托管版本的 prnadmin。

在 Windows XP 上，我必须将打印处理器设置为 MS_XPS。默认处理器是 WINPRINT。这个片段就是这样做的。

```
 static string winxpPrinterProcessor = "MS_XPS";
  if (isWinXP() && pPrinter.PrintProcessor != winxpPrinterProcessor)
  {
    Console.WriteLine("Oh No, the printer exists, but the processor isn't XPS. Setting now. It's currently " + pPrinter.PrintProcessor);
    pPrinter.PrintProcessor = winxpPrinterProcessor;
    Console.WriteLine("Set the processor to " + winxpPrinterProcessor);
    if (updateOnly)
    {
      pMaster.PrinterSet(pPrinter);
    } else { //else we're adding
      pMaster.PrinterAdd(pPrinter);
    } 
```

当我自己运行程序时，通过双击，它可以完美运行。当它作为 MSI 自定义操作运行时，它不起作用。一切正常（安装打印机、驱动程序、设置端口）但设置打印处理器。Windows 只是忽略处理器设置。

MSI 以 SYSTEM 用户身份启动自定义操作（它是一个控制台应用程序）进程。当我手动启动它时，它在我的域管理员帐户下运行。

我还应该注意手动安装打印机也可以正常工作，因为 xp 从 INF 文件中获取处理器。使用 prnadmin dll 时它会忽略该设置。

我度过了一个非常令人沮丧的早晨。有什么想法吗？或者更好的方法来安装打印机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T22:32:20.837

好的，从来没有弄清楚为什么它在那种特定情况下会失败，但我确实想出了一个更好的解决方法。如果有人可以回答我最初的问题，我会给你答案。

背景：我们选择使用 prnadmin 包装器来做所有事情，因为我们必须创建一个端口，而这似乎是最简单的方法。

我们现在不再使用托管代码创建打印机，而是向 PrintUI 发送命令。我们可以用PrintUI设置端口，windows XP在使用PrintUI时会选择INF文件中指定的处理器，所以一石二鸟。

```
public static string PrinterDriverName = "MyPrinter.INF";
public static string portOutputFileName = "nul:";

/// <summary>
/// Installs a printer and driver from an INF file, setting the 
/// port to portOutputFileName ('nul:' in this case)
/// </summary>
private static void CreatePrinterPrintUI()
{
  string sCommand = String.Format(@"rundll32 printui,PrintUIEntry /if /K /m '{0}' /n '{0}' /r '{2}' /f '{1}'"
    ,PrinterDriverName,Path.Combine(Application.StartupPath,PrinterDriverInf)
    ,portOutputFileName).Replace("'","\""); //it fails on single quotes
  execCmd(sCommand);
}

public static void execCmd(string _sCmd)
{
  try
  {
    System.Diagnostics.ProcessStartInfo p = new ProcessStartInfo("cmd", "/c " + _sCmd);
    p.RedirectStandardOutput = true;
    p.UseShellExecute = false;
    p.CreateNoWindow = true;
    System.Diagnostics.Process proc = new System.Diagnostics.Process();
    proc.StartInfo = p;
    proc.Start();
    string sResult = proc.StandardOutput.ReadToEnd();
    Console.WriteLine(sResult);
  }
  catch (Exception e)
  {
    sErr += e.ToString();
  }
} 
```

# asp.net - 在 UpdatePanel 中对我的 GridView 进行分页会导致完整的回发。

> ID：10623030
> 
> 赞同：0
> 
> 时间：2012-05-16T16:46:03.440
> 
> 标签：asp.net, sql-server, ajax, asp.net-mvc-3, visual-studio-2010

我想在 Web 母版页中使用 AJAX 更新面板，但它不起作用我尝试打开另一个 proget 来执行相同的步骤，它运行良好，但在此页面中它无法工作这是代码：

```
<%@ Page Title="" Language="VB" MasterPageFile="~/GIAC/Accueil/GiacMasterPage.master" AutoEventWireup="false" CodeFile="Les_Dossiers_Finance.aspx.vb" Inherits="GIAC_Gestion_des_dossiers_Les_Dossiers_Finance" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
</asp:Content>
<asp:Content ID="Gestion_Dossier_Finance" ContentPlaceHolderID="Corps" Runat="Server">
      <center> <div id="Bar_Nav_Gestion_Dossier_Inter">
            <p id="p1"><a href="Tous_Les_Dossiers.aspx">Consulter <br /> Tous les dossiers</a></p>          
            <ul>
                <li id="li1"><a href="Les_Dossiers_Finance.aspx">Les dossiers qui sont prêts a remplir avec les information de finance</a></li>
                <li id="li2"><a href="Les_Dossiers_Rembourse.aspx">Les dossiers qui sont prêts a remplir avec les information de remboursement</a></li>
                <li id="li3"><a href="Prete_Envoyer_OFPPT.aspx">Les dossiers qui sont prêts a envoyer au OFPPT</a></li>
                <li id="li4"><a href="Deja_Envoyer_OFPPT.aspx">Les dossiers qui sont déja envoyer a OFPPT</a></li>
                <li id="li5"><a href="Retour_OFPPT.aspx">Retour de L’OFPPT  </a></li>                                                
            </ul>
            <p id="p2">Nouveau dossier</p>
       </div></center>
       <div id="BarRecherche">
            Filtrer les dossiers par : 
           <asp:DropDownList ID="RecherhcerComboBox" runat="server" ONCHANGE="Recherche()">
               <asp:ListItem Selected="True" Value="Rien">--Sélectionner le type--</asp:ListItem>
               <asp:ListItem Value="CNSS">CNSS d&#39;entreprise</asp:ListItem>
               <asp:ListItem Value="Date">Date de dépôt des dossiers</asp:ListItem>
               <asp:ListItem Value="ID">Identifiant d&#39;entreprise</asp:ListItem>
           </asp:DropDownList>

       </div>        
        <asp:Panel ID="SearchPanel" runat="server">

           <div id="CNSSRech">
               <asp:Panel ID="PanelCNSS" runat="server" >
                     Saisir la CNSS : 
                     <asp:TextBox ID="CNSSTxt" runat="server" Height="23px" placeholder="CNSS" style="font-family : Comic Sans MS, Arial, Tahoma; color:Red;"></asp:TextBox>
                   <asp:Button ID="RechercherCNSS" runat="server" Text="Rechercher" />
               </asp:Panel>  
            </div>

         <div id="IDRech">
               <asp:Panel ID="PanelID" runat="server" >
                     Saisir l'identifiant d'entreprise : 
                     <asp:TextBox ID="IDTxt" runat="server" Height="23px" 
                         placeholder="identifiant" 
                         style="font-family : Comic Sans MS, Arial, Tahoma; color:Red;" 
                         Width="91px"></asp:TextBox>
                   <asp:Button ID="RechercherID" runat="server" Text="Rechercher" />
               </asp:Panel> 
            </div> 

            <div id="DateRech">
               <asp:Panel ID="PanelDate" runat="server" >
                     Entre :  
                     <asp:TextBox ID="Date_Debut" runat="server">
                     </asp:TextBox>
                     Et :
                     <asp:TextBox ID="Date_Fin" runat="server">
                     </asp:TextBox> 
               </asp:Panel>  
            </div>
           </asp:Panel>
    <asp:ScriptManager ID="ScriptManager1" runat="server">
    </asp:ScriptManager>
            <div class="GridViewDiv">
          <asp:UpdatePanel ID="UpdatePanel1" runat="server">
          <ContentTemplate>
              <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
                  ConnectionString="<%$ ConnectionStrings:NorthwindConnectionString %>" 
                  SelectCommand="SELECT * FROM [Products]"></asp:SqlDataSource>
              <asp:GridView ID="GridView1" runat="server" AllowPaging="True" 
                  AllowSorting="True" AutoGenerateColumns="False" DataKeyNames="ProductID" 
                  DataSourceID="SqlDataSource1">
                  <Columns>
                      <asp:CommandField ShowSelectButton="True" />
                      <asp:BoundField DataField="ProductID" HeaderText="ProductID" 
                          InsertVisible="False" ReadOnly="True" SortExpression="ProductID" />
                      <asp:BoundField DataField="ProductName" HeaderText="ProductName" 
                          SortExpression="ProductName" />
                      <asp:BoundField DataField="SupplierID" HeaderText="SupplierID" 
                          SortExpression="SupplierID" />
                      <asp:BoundField DataField="CategoryID" HeaderText="CategoryID" 
                          SortExpression="CategoryID" />
                      <asp:BoundField DataField="QuantityPerUnit" HeaderText="QuantityPerUnit" 
                          SortExpression="QuantityPerUnit" />
                      <asp:BoundField DataField="UnitPrice" HeaderText="UnitPrice" 
                          SortExpression="UnitPrice" />
                      <asp:BoundField DataField="UnitsInStock" HeaderText="UnitsInStock" 
                          SortExpression="UnitsInStock" />
                      <asp:BoundField DataField="UnitsOnOrder" HeaderText="UnitsOnOrder" 
                          SortExpression="UnitsOnOrder" />
                      <asp:BoundField DataField="ReorderLevel" HeaderText="ReorderLevel" 
                          SortExpression="ReorderLevel" />
                      <asp:CheckBoxField DataField="Discontinued" HeaderText="Discontinued" 
                          SortExpression="Discontinued" />
                  </Columns>
              </asp:GridView>
              </ContentTemplate>
          </asp:UpdatePanel>
      </div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T16:47:05.000

您缺少 UpdatePanel 的 ContentTemplate。

以下是对 UpdatePanel 的详细阅读：[UpdatePanel 类](http://msdn.microsoft.com/en-us/library/system.web.ui.updatepanel.aspx)

# javascript - 在 IF 语句中创建变量

> ID：10623032
> 
> 赞同：1
> 
> 时间：2012-05-16T16:46:09.320
> 
> 标签：javascript

该代码应该将用户带到一个网站，但我不知道如何将变量放入 if 语句中。例如，在他们输入“Can you go to [http://www.google.com](http://www.google.com) ”后，它会转到 Google，如果他们输入“Can you go to [http://www.yahoo.com](http://www.yahoo.com) ”，它会去雅虎

```
<script type="text/javascript">
        var question=prompt ("Type in a question");
        if (question==("Can you go to " /*a website*/ )){
            window.location.href = /*the website that the person typed in after to*/;
        }
    }
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T16:58:29.183

正如 Oleg 所说，使用 JavaScript 的“正则”表达式。为了说明，这是您使用正则表达式制作的示例：

```
<script type="text/javascript">
    var question=prompt ("Type in a question");
    var match = /^Can you go to (.*)/.exec(question);
    if (match) {
        window.location.href = match[1];
    }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T16:54:52.523

当您想将字符串与模式匹配或从中提取数据时，JavaScript 中最好的选择是[正则表达式](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。用于[`String.match`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/match)测试您的字符串是否符合所需的模式并在同一检查中提取您需要的数据，然后在您的作业中使用提取的 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T16:55:54.690

这不是最好的方法，因为用户可以在提示符下写其他东西，而不是从“你能去吗”开始。

但是您可以选择访问哪个网站的提示的答案：

```
var question = prompt("Which website to go to", "");
//first test if not empty:
if (question != null && question != "") {
    window.location.href = question;
} 
```

显然你应该测试它是否是一个有效的网站等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T16:56:44.360

您想要解析字符串并提取 URL 部分。在原始字符串上检查 == 也会失败，因为它将包含一个 url，因此它不会匹配。并且该脚本上有一个额外的 }。

使用 javascript 函数 .substr(start,length) 处理部分字符串，请参见[http://www.w3schools.com/jsref/jsref_substr.asp上的示例](http://www.w3schools.com/jsref/jsref_substr.asp)

请注意，此比较将区分大小写，因此您可以考虑使用 .toUpperCase()

在匹配时使用 .substr(start) 没有长度来获得包含 URL 的字符串的其余部分

```
<script type="text/javascript">
    var question=prompt("Type in a question");
    if (question.toUpperCase().substr(0,14)==("CAN YOU GO TO " /*a website*/ )){
        window.location.href = question.substr(14)/*the website that the person typed in after to*/;
    }
</script> 
```

# jquery-ui - 使用jqueryui时IE9“兼容模式”中的白屏

> ID：10623033
> 
> 赞同：1
> 
> 时间：2012-05-16T16:46:10.897
> 
> 标签：jquery-ui, cross-browser, ie8-compatibility-mode

我正在对网页进行一些浏览器测试，并且在兼容模式下遇到了 IE9 的问题。仅包含 jqueryui，主 jquery 代码中会发生错误。这会导致 IE9 在兼容模式下出现“白屏”。

查看错误控制台，我看到了：

```
SCRIPT87: Invalid argument. 
jquery.js, line 1061 character 4 
```

这导致了 jquery 中的“attr”方法：

```
l060: if ( set )
1061:      elem[ name ] = value; 
```

我已将代码减少到重现此问题所需的最低限度。如您所见，我什至还没有定义或执行我自己的任何 javascript。是否像“jqueryui 在 IE 中中断，处理它”一样简单？

最好的方法是什么。我希望我正在编写的代码能够被使用各种浏览器的大量用户访问。

```
<html>
    <head>
        <title>I am a web page</title>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    </head>
    <body>
        I am content
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:54:29.157

jQuery UI 1.8.18 旨在与 jQuery 1.7+ 一起使用。我能够重新创建您的问题，当我切换到最新版本的 jQuery 时，问题就消失了。

`<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>`

现场示例 - [http://jsfiddle.net/Cd9JC/1/](http://jsfiddle.net/Cd9JC/1/)

# javascript - 将现有 div 放在现有 div 上，然后在它们之间切换

> ID：10623034
> 
> 赞同：2
> 
> 时间：2012-05-16T16:46:11.893
> 
> 标签：javascript, jquery, html, css

考虑以下 HTML：

```
<body>
    <div id="div1" onclick="toggleDivs();">
        div1 content
    </div>
    <div id="div2" onclick="toggleDivs();" style="visibility:hidden">
        div2 content
    </div>
</body> 
```

我想要的是，当用户单击当前可见的 div 时，另一个 div 将变为可见，而当前 div 将变为隐藏。

我尝试使用`jquery.toggle()`，`jquery.css("visibility":"hidden/visible")`但这些技术都没有奏效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T16:54:58.637

`toggle`*^([[API Ref]](http://api.jquery.com/toggle/))*会起作用，但它作用于`display`CSS 属性，而不是`visibility`. 只需使用`display`：

```
<div id="div1" onclick="toggleDivs();">
    div1 content
</div>
<div id="div2" onclick="toggleDivs();" style="display: none;">
    div2 content
</div>​ 
```

和脚本：

```
function toggleDivs() {
    $('#div1, #div2').toggle();
}​ 
```

这是一个[工作示例](http://jsfiddle.net/LrVUM/)。

* * *

## 附录：

与以前的解决方案相比，我不太关心这个解决方案，但是如果根据下面的 OP 评论，您想使用 完成此任务`z-index`，您可以这样[做](http://jsfiddle.net/MkdLE/)：

### HTML：

```
<div id="div1" class="cycle">
    div1 content
</div>
<div id="div2" class="cycle">
    div2 content
</div> 
```

### CSS：

```
.cycle {
    position: absolute; /* The important thing is that the element 
                           is taken out of the document flow */
    background: #fff;
    width: 100px;
    height: 20px;
    border: solid 1px #000;
}​ 
```

### JavaScript：

```
$(function() {
   var cycleClick = function(e) {
        var $cycle = $('.cycle');
        $cycle.each(function() {
            var $this = $(this);
            var newZIndex = ($this.css('z-index') + 1) % $cycle.length;
            $this.css('z-index', newZIndex);
        });
        return false;
    };

    $('.cycle').click(cycleClick).each(function(idx) {
        $(this).css('z-index', idx);
    });​
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T16:55:03.963

这是一个有效的jsfiddle：

[http://jsfiddle.net/g5chb/1/](http://jsfiddle.net/g5chb/1/)

修改后的代码如下：

```
<body>
    <div id="div1" >
         div1 content
    </div>
    <div id="div2" style="display:none">
         div2 content
    </div>
</body>​ 
```

和相关的jQuery：

```
$("div").click(function(){
  $("#div1").toggle();   
  $("#div2").toggle();                    
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T17:51:49.960

一个更简单的`z-index`解决方案是从可见 z-index 中减去 1。您只需要将 div 以相反的顺序放在页面上。

```
$('.cycle').click(function() {
    $(this).css('z-index', $(this).css('z-index')-1);
});
​ 
```

JSFiddle：http: [//jsfiddle.net/lucuma/jr7tR/3/](http://jsfiddle.net/lucuma/jr7tR/3/)

# drupal - 使用 drupal 参数（又名“if 语句”）显示特定字段

> ID：10623036
> 
> 赞同：0
> 
> 时间：2012-05-16T16:46:20.323
> 
> 标签：drupal, if-statement, drupal-6, views, arguments

您好，我试图通过争论来实现这一点，但没有取得太大的成功。我确定这是我做错了什么。这是我的场景

我有一个“新闻”的基本内容类型，内容类型包含标准标题字段和一个称为备用标题的 CCK 字段。目标是创建一个可以打印备用标题（如果有）的块视图，如果用户没有输入备用标题，那么标准标题应该像 if 语句一样打印，但只能使用这两个字段。我对 Drupal 还很陌生，所以想知道这是否可能。如果我能指出正确的方向，那就太好了。我感谢这个社区可以提供的任何帮助。

问候

使用 Drupal 6 和最新版本的视图

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T04:31:10.340

到目前为止，我认为最好的方法是使用[Views customfield](http://drupal.org/project/views_customfield)。

将您的两个字段都添加到视图字段列表中，并从显示中排除这两个字段。

添加自定义字段：标记并在输入格式中选择php代码。

现在在这里写下你的 if else 条件，你就完成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T21:34:23.853

在视图 UI 中添加这两个字段。字段的顺序应如下所示。

1.  核心标题
2.  CCK 标题

你肯定可以在这些字段的上方和下方有额外的东西。只是保持秩序。现在，在标题字段的设置下，将其排除在显示之外（有一个复选框。）

然后，在 cck 标题字段的设置下，将空文本更改为上述标题字段的标记（`[title]`在大多数情况下）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T16:51:46.267

可以使用[Views CustomFeild](http://drupal.org/project/views_customfield)或[Views PHP](http://drupal.org/project/views_php)

来实现 只需在视图中添加两个字段，将它们从显示中排除，添加第三个字段：自定义字段，您可以在其中使用 php 条件。

# c++ - 通过非静态方法访问静态成员

> ID：10623037
> 
> 赞同：3
> 
> 时间：2012-05-16T16:46:26.627
> 
> 标签：c++

这一定很琐碎，但我找不到：

```
struct Test {
  static int n;
  void Save(int val) {
    Test::n = val;
  }
};

int main() {
  Test t;
  t.Save(2);
  return 0;
} 
```

为什么在第 4 行有未定义的引用`Test::n`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T16:47:16.183

您需要定义静态：

```
struct Test {
  static int n;
  void Save(int val) {
    Test::n = val;
  }
};

int Test::n = 0; 
```

请注意，定义必须出现在实现文件中，而不是头文件中，否则会出现多重定义错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T16:49:27.050

您需要*定义*静态数据成员（不一定要*初始化*它）。它将自动初始化为 0。我想您遇到了链接器错误。这是因为由于缺少定义，尚未分配数据成员。这与它的价值无关。

# android - Java 类有没有类似 xml-include 的东西？

> ID：10623043
> 
> 赞同：0
> 
> 时间：2012-05-16T16:46:44.127
> 
> 标签：android

当我们在 XML 中制作 Android 布局时，我们可以使用`include`其他一些布局来制作主机布局的一部分。Java类有这样的东西吗？

我将顶部栏布局附加到每个屏幕，它包含按钮。现在，在每个 Java 类中，我都必须复制/粘贴初始化代码。

这种情况有什么捷径吗？`Application`无论如何上课可以方便吗？如果有人有可行的解决方案，请与我分享。

例如，在 XML 中我可以使用

```
//...xml layout elements
<include layout="@layout/topbar" />
//...some other xml layouts 
```

所以能够在 Java 代码中使用我可以立即启动按钮、注册`onClick`事件并为这些事件设置操作的东西会很酷。毕竟，这都是我正在使用的同一段代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T16:53:10.377

使用您想要的实现创建一个活动（BaseActivity），并在您的其他活动中扩展此类。

# wcf - Windows 工作流程 - 使用 Pick 活动公开多个服务接收

> ID：10623050
> 
> 赞同：0
> 
> 时间：2012-05-16T16:47:29.573
> 
> 标签：wcf, workflow, workflow-foundation-4

我正在构建一个需要不止一种方法的 WF4 工作流。我正在使用选择活动，因此每个接收都可以激活工作流，并以任何顺序工作（就像普通的 WCF 服务功能一样）。但是，每次我调用其中一个 Web 服务时，无论我调用什么方法，最终都会调用两个触发器（这两个方法具有相同的签名）。

我应该使用除了挑选活动之外的东西来完成这个吗？也许是并行活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T08:47:16.613

如果您有 x 个不同的消息传递活动，并且您希望所有这些活动都被调用，那么并行活动是最好的，但没有特定的顺序。

嗯...您是说这两种方法具有相同的签名并且它们处于挑选活动中吗？那你为什么有两种方法呢？您应该在选择之前有一个 Receive 活动，然后根据来自 Receive 调用的参数有一个规则去特定的分支。

希望能帮助到你。

# html - 静态左列

> ID：10623052
> 
> 赞同：1
> 
> 时间：2012-05-16T16:47:42.770
> 
> 标签：html, css

我无法让我的网站上的左栏保持静态：bartzjosh.com

我最初将其设置为流动站点，然后一直在对其进行修改。仍在清理它，如果代码混乱，非常抱歉。

任何帮助表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T16:51:37.423

你目前有

```
position: absolute 
```

设置侧边栏；切换到

```
position: fixed 
```

该`fixed`属性确定元素在视口而不是文档中的位置。无论文档偏移如何，这都会使其保持冻结状态。

进一步阅读：[http ://www.w3.org/TR/CSS2/visuren.html#fixed-positioning](http://www.w3.org/TR/CSS2/visuren.html#fixed-positioning)

# java - 我在将数据从一项活动的共享首选项检索到另一项活动时遇到问题

> ID：10623053
> 
> 赞同：0
> 
> 时间：2012-05-16T16:47:42.717
> 
> 标签：java, android, sharedpreferences

```
public class LoginActivity extends Activity{

final String defaultPassword = "123456";
Button login, cancel;
EditText input;

@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.security);

    //SharedPreferences from other Activity
    final String LOGIN_PASSWORD = "Login_Password";
    SharedPreferences loginPassword = getSharedPreferences(LOGIN_PASSWORD, 0);
    final String storedPass = loginPassword.getString("loginPassword", "");

    input = (EditText) findViewById(R.id.password);

    cancel = (Button) findViewById(R.id.cancel);
    cancel.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {                
            finish();
        }
    });

    login = (Button) findViewById(R.id.login);
    login.setOnClickListener(new View.OnClickListener() {

        public void onClick(View view) {

            String inputPass = input.getText().toString();

            if (!inputPass.equals("")){

                if (storedPass.equals("")){

                    if (inputPass.equals(defaultPassword)){
                        Toast.makeText(LoginActivity.this, "Success", Toast.LENGTH_SHORT).show();
                        Intent intent = new Intent(LoginActivity.this, ActivateActivity.class);
                        startActivity(intent);
                    }
                    else{
                        Toast.makeText(LoginActivity.this, "Failed", Toast.LENGTH_SHORT).show();
                        input.setText("");
                    }
                }
                else{

                    if (inputPass.equals(storedPass)){
                        Toast.makeText(LoginActivity.this, "Success", Toast.LENGTH_SHORT).show();
                        Intent intent = new Intent(LoginActivity.this, ActivateActivity.class);
                        startActivity(intent);
                    }
                    else{
                        Toast.makeText(LoginActivity.this, "Not matched", Toast.LENGTH_SHORT).show();
                        input.setText("");
                    }
                }   
            }
            else{
                Toast.makeText(LoginActivity.this, "Nothing", Toast.LENGTH_SHORT).show();
                input.setText("");
            }
        }
    });
} 
```

我正在设计一个访问应用程序的登录页面，最初用户第一次使用应用程序时，没有设置密码，所以使用默认密码“123456”访问应用程序，用户设置密码后，默认密码不能用于访问应用程序...所以现在我必须检索存储在另一个活动共享首选项中的用户设置密码。所以下次用户访问应用程序时，我可以将用户输入与存储的密码进行比较，但我该如何实现呢？我的编码有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T16:49:53.327

使用 时`getSharedPreferences(LOGIN_PASSWORD, 0)`，请确保`LOGIN_PASSWORD`两个活动中的值相同。否则，您将打开两个不同的首选项。

# css - 从 IE8 到 IE9 兼容模式的复选框大小不同？

> ID：10623056
> 
> 赞同：0
> 
> 时间：2012-05-16T16:47:46.197
> 
> 标签：css, internet-explorer, input, checkbox

所以我有一个工作项目，我正在查看客户端在 IE8 中使用的项目。我们正在测试以确保一切在 IE9 兼容模式下看起来都不错，以便我们转向该模式。我在 IE9 中遇到复选框对齐问题。我有两个并排嵌套在另一个 div 中的 div。左边的有一个复选框，右边的有一个标签。问题是在 IE9 中，复选框/标签对齐完全关闭，并且标签由于某种原因高于复选框。

起初我以为我可以用填充/边距解决这个问题，但是当单击开发人员工具中的复选框时，似乎在 IE9 中输入复选框区域实际上大于 IE8 复选框的区域。有没有其他人遇到过这种情况，你知道有什么方法可以在 IE8/9 中使它相同吗？

# c# - 在 C# 的列表框中显示文件

> ID：10623058
> 
> 赞同：-1
> 
> 时间：2012-05-16T16:47:50.950
> 
> 标签：c#, visual-c#-express-2010

我需要过滤掉整台电脑，只找到 .sto 文件。我希望这些文件显示在列表框中。我需要它们像这样显示：“text.sto”。我正在使用 Visual C# Express。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:52:54.457

确保在代码文件的顶部有这个 using 指令：

```
using System.IO; 
```

使用此方法获取目录：

```
string[] dirs = Directory.GetFiles(@"c:\", "*.sto", SearchOption.AllDirectories); 
```

它需要第二个参数，允许您过滤结果。可以在此处找到有关该方法的更多信息：http: [//msdn.microsoft.com/en-us/library/ms143316.aspx](http://msdn.microsoft.com/en-us/library/ms143316.aspx)

如果您不想为此使用内置的 .Net 函数（因为它可能会引发访问错误并且不提供任何结果），这里有一个问题的答案，显示了以不同的方式进行操作：[https ://stackoverflow.com /a/929418/184746](https://stackoverflow.com/a/929418/184746)

参考上述文章，这里有一个方法可以捕获并且不会给您添加为 *.sto 的过滤错误：

```
public static IEnumerable<string> GetFiles(string path)
{
    Queue<string> queue = new Queue<string>();
    queue.Enqueue(path);
    while (queue.Count > 0)
    {
        path = queue.Dequeue();
        try
        {
            foreach (string subDir in Directory.GetDirectories(path))
            {
                queue.Enqueue(subDir);
            }
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine(ex);
        }
        string[] files = null;
        try
        {
            files = (from f in Directory.GetFiles(path)
                     where f.EndsWith(".sto")
                     select f).ToArray();
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine(ex);
        }
        if (files != null)
        {
            foreach (string t in files)
            {
                yield return t;
            }
        }
    }
} 
```

你可以像这样使用它：

```
string[] dirs = GetFiles(@"c:\").ToArray(); 
```

之后，在设计器中创建一个列表框，并遍历并添加项目

```
foreach(var f in dirs)
{
    listBox1.Items.Add(String.Format("\"{0}\"", f));
} 
```

出于好奇，您在研究这个时的搜索参数是什么？因为一个简单的谷歌搜索揭示了你所需要的一切：`"get list of files C#"`[https ://www.google.ca/search?sourceid=chrome&ie=UTF-8&q=get+list+of+files+C%23](https://www.google.ca/search?sourceid=chrome&ie=UTF-8&q=get+list+of+files+C%23)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T16:53:09.673

一种搜索`sto`文件的解决方案，但我不能说它有多快

```
string[] filePaths = Directory.GetFiles(@"c:\", 
                         "*.sto", 
                         SearchOption.AllDirectories); 
```

# javascript - 如何通过 node-mongo-native 将变量传递给 MongoDB？

> ID：10623061
> 
> 赞同：0
> 
> 时间：2012-05-16T16:48:00.497
> 
> 标签：javascript, node.js, mongodb

我需要找到一个文档并将其子对象设置为 3。

```
{
  doc_id = 'dock_id1',
  update = events{a:{b:3}}
} 
```

如何将其传递给 node-mongo-native 查询以`events.a.b = 3`在具有 id 的文档上设置`doc_id1`？

我不是说`events.a.b`每次都设置。我的意思是从那个对象传递一个变量，这样我就可以得到一个带有新数据的新对象，并以同样的方式应用它。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T00:33:24.243

您可以传递一个对象文字：

```
 collection.insert( { foo: 'bar' }, function( error, documents ) { console.log( 'error', error, 'documents', documents ) } ); 
```

.. 或传递现有对象：

```
 var obj = { foo: 'bar' };
  collection.insert( obj, function( error, documents ) { console.log( 'error', error, 'documents', documents ) } ); 
```

如果您尝试创建一个对象，这不是正确的语法：

> 事件{a:{b:3}}

# maven-release-plugin - 是否有由 maven-release-plugin 生成的带有标签名称的变量？

> ID：10623063
> 
> 赞同：1
> 
> 时间：2012-05-16T16:48:09.910
> 
> 标签：maven-release-plugin

我想使用`completionGoals`maven-release-plugin 的选项运行自定义 maven 步骤。此步骤需要知道 maven-release-plugin 用于标记发布提交的标记名称。是否有访问此标签名称的变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T13:03:25.243

发布插件将“tagNameFormat”作为配置参数。您可以将其设置为变量并将其用于您自己的目的吗？

默认值为“@{project.artifactId}-@{project.version}”（参见[http://maven.apache.org/plugins/maven-release-plugin/prepare-mojo.html#tagNameFormat](http://maven.apache.org/plugins/maven-release-plugin/prepare-mojo.html#tagNameFormat)）所以你可以如果您知道人们不使用该参数，请这样猜。

因为发布的 pom.xml 将在 ${project.scm.developerconnection} 中包含标签 url，这也可能是一个选项。

# c# - 如何在 ASP.NET MVC 中提交禁用的下拉列表？

> ID：10623069
> 
> 赞同：0
> 
> 时间：2012-05-16T16:48:48.193
> 
> 标签：c#, asp.net, .net, asp.net-mvc-3

我使用以下语法显示下拉菜单：

```
@Html.DropDownListFor(model => model.Country, new SelectList(Model.CountryOptions, "Key", "Value")) 
```

我有一个基于复选框禁用 dd 的 Jquery 语句：

```
$(document).ready(function () {
    $("#lockRecord").click(function () {
        if ($(this).attr('checked')) {
            $("#Country").attr('disabled', true);
        } else {
            $("#Country").attr("disabled", false);
        }
    })
}); 
```

但是，当它被提交时，该值返回为 null。已尝试只读，但它不适用于下拉列表。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:51:17.943

当下拉菜单被禁用时，获取该值并将其提交到隐藏字段中。当然，您的服务器代码需要修改以获取该值，但这是一个很小的代价。

# javascript - jQuery 验证插件 addMethod 可通过属性访问

> ID：10623070
> 
> 赞同：0
> 
> 时间：2012-05-16T16:48:49.603
> 
> 标签：javascript, jquery, html, validation

我使用 bassistance jQuery 验证插件来验证我的输入。我想用 addMethod 添加一个验证方法。问题是是否有可能使这个新添加的方法可以通过输入属性访问，就像它适用于其他方法一样 - type="email"。我不想将它与这样的规则选项一起使用：

```
rules: {
    myField: { lettersonly: true }
 } 
```

请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:02:13.210

我不确定输入类型，但最简单的方法是使用类添加它，如下所示：

```
$.validator.addMethod('emailValidator', functiuon(val, elt) {
    // Your validation logic
}, 'Your error message'); 
```

这可能是您的标记：

```
<input type="email" class="emailValidator" value="" /> 
```

然后像往常一样调用 .validate() 方法。

# javascript - 想要上传和解析 json 文本，并通过使用 ajax 的单击按钮将其加载到我的索引页面

> ID：10623071
> 
> 赞同：0
> 
> 时间：2012-05-16T16:48:50.823
> 
> 标签：javascript, html, ajax, asp.net-mvc, json

我在我的内容文件夹下创建了一个名为 Name 的文本。我用 Json 格式写的。我正在尝试获取该 Name.text 并在单击按钮的结果后显示它。我想出了一些解析代码来解析 json。我只是不知道把它放在哪里。我认为它在我的成功：某处的功能（数据）区域。请帮帮我。

```
<p>
  <script type ="text/jscript">
      $(document).ready(function () {
          $.ajax({
              url: "/MvcApplication1/Content/Name.txt",
              success: function (data) {
                  var jsnObj=$parseJSON(data);
                  $("#button").click(function(){
                       $("p").append(jsonObj.First);
                       $("P".append(jsonObj.Last);

                   });

              },
              error: function () {
                  alert("error");
              }
          });
      });

  </script>
</p>
<div id="nameDiv"></div>
<button id ="button><Get Name</button> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:02:47.660

是的，创建 2 个函数，一个执行 Ajax，一个执行解析，您需要将“数据”传递给解析函数。

```
 function doParse(jsondata) {

     var jsonobj = $.parseJSON(jsondata);

     /*  ... next stuff */

    /* UPDATE ( as comment ): say jsonobj  is {"pizzatype":"ham"} */
    /* output examples */
     alert(jsonobj.pizzatype);
     $("#mydivonthepage").html("My favourite pizza is"+jsonobj.pizzatype);

    }

     $(document).ready(function () {
      $.ajax({
          url: "/MvcApplication1/Content/Name.txt",
          success: function (data) {
              doParse(data);
          },
          error: function () {
              alert("error");
          }
      });
  }); 
```

注意*您可以进一步简化 - 请参阅 getJSON 示例 - [http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

# wpf - ListBox 和 ContentControl 之间的 WPF TextWrapping 差异

> ID：10623080
> 
> 赞同：0
> 
> 时间：2012-05-16T16:49:20.533
> 
> 标签：wpf, listbox, word-wrap

我有一个列表框，其数据模板包含一个网格。在网格内我有一个 TextBlock，但我无法让 TextWrapping 属性正常工作：我编写了一个示例来说明行为：

**XAML：**

```
<Window x:Class="MyTest.Test"
    xmlns:my="clr-namespace:MyTest"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Test" >
<Window.Resources>
    <DataTemplate DataType="{x:Type my:Task}">
        <Border BorderThickness="2" BorderBrush="Red">
            <Grid ShowGridLines="True">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <TextBlock MaxWidth="50" Margin="3" Grid.Column="0" TextWrapping="Wrap" Text="{Binding Path=Description}"></TextBlock>
                <TextBlock Margin="3" Grid.Column="1" TextWrapping="Wrap"  Text="{Binding Path=LongDescription}"></TextBlock>
            </Grid>
        </Border>
    </DataTemplate>
</Window.Resources>
<StackPanel>

    <TextBlock FontWeight="Bold" TextWrapping="Wrap">ContentControl: the textwrapping works as expected (select a row in the first listbox)</TextBlock>
    <ContentControl MinHeight="10" Content="{Binding ElementName=lsTask, Path=SelectedItem}" />

    <TextBlock FontWeight="Bold" TextWrapping="Wrap">ListBox: I can't get the textwrapping work properly</TextBlock>
    <ListBox MinHeight="10" Name="lsTask" ItemsSource="{Binding Path=TaskList}" ></ListBox>

    <TextBlock FontWeight="Bold" TextWrapping="Wrap">ListBox 2 : I tried with HorizontalContentAlignment="Stretch": similar but doesn't wrap</TextBlock>
    <ListBox MinHeight="10" Name="lsTask2" ItemsSource="{Binding Path=TaskList}" HorizontalContentAlignment="Stretch" ></ListBox>

    <TextBlock FontWeight="Bold" TextWrapping="Wrap">ListBox 3: I can wrap only setting Width in the datatemplate</TextBlock>
    <ListBox MinHeight="10" Name="lsTask3" ItemsSource="{Binding Path=TaskList}" HorizontalContentAlignment="Stretch" >
        <ListBox.ItemTemplate>
            <DataTemplate>
                <Border BorderThickness="2" BorderBrush="Green">
                    <Grid ShowGridLines="True">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Margin="3" Grid.Column="0" TextWrapping="Wrap" Text="{Binding Path=Description}"></TextBlock>
                        <TextBlock  Width="200"  Margin="3" Grid.Column="1" TextWrapping="Wrap"  Text="{Binding Path=LongDescription}"></TextBlock>
                    </Grid>
                </Border>
            </DataTemplate>
        </ListBox.ItemTemplate>

    </ListBox>
</StackPanel> 
```

这是我的 **代码隐藏：**

```
namespace MyTest
{

public class Task
{
    public string Description { get; set; }
    public string LongDescription { get; set; }

}

public class MyContext
{
    public List<Task> TaskList { get; set; }

    public MyContext()
    {
        TaskList = new List<Task>();
        TaskList.Add(new Task() { Description = "description1", LongDescription = "long long long long long long long long description1" });
        TaskList.Add(new Task() { Description = "description2", LongDescription = "long long long long long long long long description2" });
        TaskList.Add(new Task() { Description = "description3", LongDescription = "long long long long long long long long description3" });
    }

}

public partial class Test : Window
{

    public Test()
    {   
        DataContext = new MyContext();
        InitializeComponent();

    }
}
} 
```

在 ContentControl 和前 2 个 ListBoxes 中，我使用相同的数据模板；在 ContentControl 中，WordWrapping 按预期工作（每当我调整窗口大小时），而在 ListBoxes 中则没有。有什么不同？

我发现使 TextWrapping 在 ListBox 中工作的唯一方法是修复 TextBlock 的宽度（或 MaxWidth），但这不是所需的行为。

谢谢，亚历山德罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:10:08.630

ListBox 包含一个 ScrollViewer，因此当内容想要比 ListBox 更宽时，滚动条会自动出现。解决方案是禁用水平滚动条。

```
<ListBox ... ScrollViewer.HorizontalScrollBarVisibility="Disabled"/> 
```

# regex - URL 重定向规则问题中的 BackReferences、R1、R2

> ID：10623081
> 
> 赞同：1
> 
> 时间：2012-05-16T16:49:26.177
> 
> 标签：regex, url-rewriting, iis-7.5, url-redirection

我试图寻找更多关于反向参考的信息。但是我发现的不是很清楚。所以我真的很困惑。我在 web.config 中有这个

```
 <system.webServer>
<rewrite>
  <rules>
    <clear />

    <rule name="CTVNews Articles" stopProcessing="true">
      <match url="(.*?)CTVNews(/?)(.*)" />
      <action type="Redirect" url="http://www.ctvnews.ca{R:2}{R:3}" appendQueryString="true" redirectType="Permanent" />
    </rule> 
```

所以，我知道这是正则表达式的规则。这很容易理解，但是 url="http://www.ctvnews.ca/generic{R:2}{R:3} 呢。有人可以请解释什么是 R2 和 R3？为什么我们有 R2，R3，而不是 R1 和 R2？

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:07:51.560

在您提供的 XML 片段中，正则表达式具有三个“捕获组” - 即使用括号（“（”和“）”）。这些“捕获”它们内部的任何东西，然后可以通过数字来引用。从左到右编号，从 1 开始。

然后在上面的`<action>`标签中，`{R:2}`部分是指正则表达式中的组捕获的内容。有三个这样的组，但`<action>`只使用第二个和第三个。第一个正在被捕获但未被使用。

# sql - Oracle：将两个不同的查询合并为一个，LIKE & IN

> ID：10623088
> 
> 赞同：2
> 
> 时间：2012-05-16T16:49:49.760
> 
> 标签：sql, oracle, sql-like

我需要实现一个搜索查询，其中我们有多个过滤器（值）用于数据库（oracle）中的单个列。但是这些多个过滤器（值）是`LIKE`查询参数。我不确定我是否正在考虑使用这种方法来获得正确的结果。

我想要一些应该像这样工作的东西：

```
departmentname IN ( LIKE '%Medi%', LIKE '%Ciga%') 
```

我知道这行不通，只是我想展示我的愿景。

尽管我们都知道在查询之间使用`foreach`和手动添加它很简单，例如：`'OR'`

```
WHERE DEPARTMENTNAME LIKE '%Medi%' OR '%Ciga%' OR '%Tobacc%' 
```

但是有什么方法可以同时使用 IN() AND LIKE 来实现它？

也欢迎其他建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:38:57.310

正如已经评论过的，仅仅连接几个条件会更好更简单：

```
where departmentName like '%Medi%'
   or departmentName like '%Ciga%'
   or departmentName like '%Tabacc%'; 
```

另一种方法是将这些值 '%Medi%'、'%Ciga%' 和 '%Tabacc%' 插入到条件表中，然后运行以下查询：

```
select department.*
  from department
 cross join conditionTable
 where department.departmentName like conditionTable.value; 
```

我在这里假设您的 table 是`department`并且 conditionTable 有一个 column `value`。如果您实施此解决方案，您应该关心并发性，并通过类似的方式过滤条件表

```
select department.*
  from department
 inner join conditionTable on conditionTable.session = yourSessionId
 where department.departmentName like conditionTable.value; 
```

最后，如果您不想使用条件表，第三种可能很方便的解决方案是生成一个字符串`select <cond1> as value from dual union select <cond2> from dual...`并将其放入动态查询中

```
select department.*
  from department
 cross join
   (select '%Medi%' as value from dual
     union
    select '%Ciga%' from dual
     union
    select '%Tabacc%' from dual) conditionTable
 where department.departmentName like conditionTable.value; 
```

# sql - 将一列中的随机数据插入到另一表的列中

> ID：10623090
> 
> 赞同：1
> 
> 时间：2012-05-16T16:50:01.563
> 
> 标签：sql

我想将一个字段中的随机数据插入另一个字段。我完全不确定它的语法，所以我在想

icdtbl.icd_id = 主键 icdjxn.icd_id = 外键

```
 insert into icdjxn (icd_id,patiendID)

    select top 5000 icd_id from icdtbl order by newid(),select top 5000 patientID from patientTbl order by newid() 
```

编辑了我正在寻找的全部内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:56:56.260

```
insert into icdjxn (icd_id)  
select top 5000 icd_id from icdtbl order by newid() 
```

使用选择时不要使用单词值。

# c# - c# 错误时执行存储过程

> ID：10623092
> 
> 赞同：0
> 
> 时间：2012-05-16T16:50:05.477
> 
> 标签：c#, sql-server-2008

我正在尝试在 c# 上执行 SP 并得到该错误

```
 System.Data.SqlClient.SqlException: Procedure or function 'usp_Registrations_Insert' expects parameter '@RegistrationID', which was not supplied.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at C2DMwebService.C2DM.RegisterDevice(String DeviceID, String RegistrationId) in c:\users\eyal\documents\visual studio 2010\Projects\C2DMwebService\C2DMwebService\C2DM.asmx.cs:line 52 
```

我执行的代码是

```
SqlCommand cmd = new SqlCommand();
                string connStr = ConfigurationManager.ConnectionStrings["myConnectionString"].ConnectionString;
                SqlConnection con = new SqlConnection(connStr);
                //cmd.Parameters.Add("@RegistrationID", SqlDbType.NVarChar).Value = RegistrationId;
                //cmd.Parameters.Add("@DeviceID", SqlDbType.NVarChar).Value = DeviceID;

                //cmd.Parameters.Add(new SqlParameter("@RegistrationID", RegistrationId));
                //cmd.Parameters.Add(new SqlParameter("@DeviceID", DeviceID));

                SqlParameter myParm1 = cmd.Parameters.Add("@RegistrationID", SqlDbType.NVarChar, 200);
                myParm1.Value = RegistrationId;

                SqlParameter myParm2 = cmd.Parameters.Add("@DeviceID", SqlDbType.NVarChar, 200);
                myParm2.Value = DeviceID;

                cmd = new SqlCommand("usp_Registrations_Insert", con);
                cmd.CommandType = CommandType.StoredProcedure;
                con.Open();
                cmd.ExecuteNonQuery();
                con.Close(); 
```

我的SP

```
ALTER PROCEDURE dbo.usp_Registrations_Insert
    (
    @RegistrationID NVarChar(200),
    @DeviceID NVarChar(200)
    )
AS
    /* SET NOCOUNT ON */

    INSERT INTO Registrations
                         (RegistrationID, DeviceID)
VALUES        (@RegistrationID,@DeviceID)
    RETURN @@rowcount; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T16:52:04.393

您在执行它之前创建一个新命令。这将处理您刚刚添加到您创建的第一个命令的所有参数。

将线`cmd = new SqlCommand("usp_Registrations_Insert", con);`移到顶部，就`SqlConnection con = new SqlConnection(connStr);`在线之后，你应该没问题。您可以删除第一`cmd = new SqlCommand();`行。

# python - python：UnboundLocalError：分配前引用的局部变量'open'

> ID：10623093
> 
> 赞同：4
> 
> 时间：2012-05-16T16:50:12.413
> 
> 标签：python

```
def read_lines():
    readFileName = "readfile.txt"
    f = open(readFileName, 'r+')
    contents = f.read()
        ... # and so on 

read_lines() 
```

当我运行它时，我得到一个错误：

```
f = open(readFileName, 'r+')
UnboundLocalError: local variable 'open' referenced before assignment 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-16T16:51:11.203

这意味着在您的函数中进一步向下创建一个名为的变量`open`：

```
open = ... 
```

重命名它，使其不与内置函数冲突。

# html - 确保内联项目始终出现在最后

> ID：10623094
> 
> 赞同：1
> 
> 时间：2012-05-16T16:50:12.597
> 
> 标签：html, css

我正在实现一个 HTML 消息对话框。

![在此处输入图像描述](../Images/ad45524d75d0de2f642d8d835f216b48.png)

收件人输入面板如上所示 - 多个收件人，以及末尾的文本框（将不可见），用于通过自动完成菜单添加新收件人。

我现在已经将它实现为内联显示的无序列表：

```
<ul class="recipients inline clearfix">
    <li class="recipient"><span>recipient 1<a href="#" class="remove">x</a></span></li>
    <li class="recipient"><span>recipient 2<a  href="#" class="remove">x</a></span></li>
    <li class="recipient last"><span>recipient 3<a  href="#" class="remove">x</a></span></li>
    <li class="searchbox"><input type="text" class="search-recipient"></li>
</ul>

ul.inline li {
    display: inline;
    list-style-type: none;
} 
```

问题是当收件人进入多行时，文本框会向上移动以填充可用空间：

![在此处输入图像描述](../Images/675b763969eed202882423d7b78fcb05.png)

如何使文本框始终出现在收件人之后？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:06:09.460

您提供的代码应该按预期工作。您可能在输入框上设置了某种浮点数。

查看**[实时示例](http://dabblet.com/gist/2712246)**

# php - 使用 PHP 从各种终端读取数据

> ID：10623096
> 
> 赞同：4
> 
> 时间：2012-05-16T16:50:20.223
> 
> 标签：php

我想知道是否有任何方法可以与 POS 设备、收银机和磁卡读卡器与 PHP 进行通信。我所说的通信是指读取该设备的输出。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T16:54:13.143

这些设备通常支持串行通信。据我所知，PHP 没有内置的串行终端支持，但[这里有一个可以促进它的类](http://code.google.com/p/php-serial/)。

除此之外，根据您运行的平台，读取和写入串行端口可能仅包括从字符设备读取和写入正确的字节流，例如在设备的文件描述符上`/dev/ttyS0`使用。`fopen() fread() fwrite()`

# ruby-on-rails - 在 formtastic url 中传递可选参数

> ID：10623097
> 
> 赞同：1
> 
> 时间：2012-05-16T16:50:20.353
> 
> 标签：ruby-on-rails, ruby, formtastic

我有一个新动作的 Rails 视图。我正在使用 formtastic 生成表单，并且我可以选择有一个可能已传递给控制器​​的形式模板。

我想要做的是确保在提交表单时将这个 proforma_id 传递给 create 方法

我找到了一种方法来做到这一点，但我想知道这是否有点骇人听闻，以及是否没有更清洁、更像红宝石的方法：

```
<% params = {:proforma_id => @proforma.id} unless @proforma.nil? %>
<%= semantic_form_for @document, :url => documents_path(params) do |f| %> 
```

也许我应该把参数线放在控制器中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:31:11.653

您可以通过两种方式传递它，具体取决于您是希望在 URL 中还是在 POST 数据中...

正如您所发现的，第一种方法是在 url 参数中传递它。您可以在控制器中设置该变量，但您可能会逃脱

```
<%= semantic_form_for @document, :url => documents_path(:proforma_id => @proforma.try(:id)) do |f| %> 
```

如果额外的参数为零，它就不会出现，IIRC。

另一种选择是将其作为隐藏变量放入表单中：

```
<%= hidden_field_tag :proforma_id, @proforma.try(:id) %> 
```

# html - 在 div 问题中将边距设置为单个标题标签

> ID：10623098
> 
> 赞同：0
> 
> 时间：2012-05-16T16:50:21.260
> 
> 标签：html, css

下面我在 div 中有一个 h3 标签。

```
#one {
  width:300px;
  height:200px;
  background-color:black;
  color:white;
}

h3 {
 margin-top:20px;
}

    <div id="one">
<h3>Coming Soon My Tools</h3>
</div>​ 
```

渲染时，div 的上边距被移动，而不是 h3 标签的上边距。见演示[http://jsfiddle.net/EnigmaMaster/aZnjx/1/](http://jsfiddle.net/EnigmaMaster/aZnjx/1/)

有谁知道为什么会这样？

如果我在 h3 标签之前的 div 中放置一些东西，那么边距会正确调整，如果我将 display: inline-block 添加到 h3 标签，它也会正确呈现。**我不是在寻找解决我的问题的方法。我正在寻找有关该问题的信息。以前有没有其他人遇到过这个问题？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:00:31.733

我现在找不到支持我的想法的信息，但据我所知，div 是一个没有边距的框。所以你会得到 div 边距和 h3 边距的“边距崩溃”。如果您在 div 和 h3 标签之间添加任何文本，您实际上创建了一个新块，并且 h3 边距作为偏移量添加到该块。向 div 添加 1px 边框也是如此。然后“崩溃”行为消失。如前所述，我找不到支持这一点的信息，但摆弄你的网址可以证明这种行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T16:55:30.950

只需将其插入您的小提琴。我建议你这样做：

```
#one {
  width:300px;
  height:200px;
  background-color:black;
    color:white;
    border: 1px solid 0000ff;
}

h3 {
 margin-top:20px;
 border: 1px solid #00ff00;
} 
```

保证金似乎工作正常（我在这里使用 IE7）。距离是在顶部`h3`和 div 边界之间创建的。那是保证金。

# jqgrid - postData 未发送到 jqgrid 中的服务器

> ID：10623103
> 
> 赞同：1
> 
> 时间：2012-05-16T16:50:45.900
> 
> 标签：jqgrid

为什么 PostData 值永远不会发送到服务器？如果我使用固定值 postData: {test: "3"} 它可以工作，但是在使用函数时没有任何东西传递给服务器..... Firebug 不会显示任何测试变量的痕迹

```
$("#tblgrid").jqGrid({
            datatype: 'json',
            ajaxGridOptions: { contentType: "application/json" },
            ajaxRowOptions: { contentType: "application/json", type: "POST" }, //row inline editing
            serializeGridData: function(postData) { return JSON.stringify(postData); },
            jsonReader: {
                repeatitems: false,
                id: "0",
                cell: "",
                root: function(obj) { return obj.d.rows; },
                page: function(obj) { return obj.d.page; },
                total: function(obj) { return obj.d.total; },
                records: function(obj) { return obj.d.records; }
            },
            url: 'orthofixServices.asmx/GetProductList',
            postData: { test: function() { return $("#tid").val(); } },
            datatype: 'json',
            colNames: ['id', 'Product Description', 'Commission Rate'],
            colModel: [
            { name: 'id', width: 50 },
            { name: 'description', index: 'desc', width: 380, editable: true },
            { name: 'commissionrate', index: 'com', width: 120, editable: true, unformat: percentUnFormatter, formatter: percentFormatter, editrules: { number: true} }
            ],
            serializeRowData: function(data) {

                var params = new Object();
                params.id = 0;
                params.prdid = 4;
                params.description = data.description;
                params.commissionrate = data.commissionrate;
                var result = JSON.stringify({ 'passformvalue': params, 'oper': data.oper, 'id': data.id });
                return result;
            },
            mtype: "POST",

            rowNum: 4,
            width: 500,
            height: 80,
            pager: '#pager',
            editurl: "orthofixServices.asmx/ModifyProductList"
        });
        $("#tblgrid").jqGrid('navGrid', '#pager', { add: false, edit: false, del: true }, {
        //edit options

    }, {
    //add options     

}, {
//delete options 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:08:57.663

该[`postData`](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aoptions)字段表示要发送到服务器的数据：

> 该数组直接传递给 url。这是关联数组，可以这样使用：`{name1:value1...}`.

您的代码的问题是您试图将函数（代码）传递给服务器。相反，您需要直接传递数据：

```
postData: { test: $("#tid").val() } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T18:15:00.447

您需要实际执行已将 postData 设置为的函数。

将此添加到您的 serializeRowData 中：

```
 for (propertyName in data) {
                        if (data.hasOwnProperty(propertyName)) {
                            propertyValue = data[propertyName];
                            if ($.isFunction(propertyValue)) {
                                dataToSend[propertyName] = propertyValue();
                            } else {
                                dataToSend[propertyName] = propertyValue;
                            }
                        }
                    } 
```

# android - 在 monodroid 上自定义复合控件

> ID：10623105
> 
> 赞同：2
> 
> 时间：2012-05-16T16:50:47.953
> 
> 标签：android, controls, xamarin.android, customization

我试图创建自己的自定义复合控件并开始在 Activity 上开发它，然后我将相同的代码放在从 LinearLayout 扩展的类中，如 Android 文档中所示。这是我的活动代码，其中我实例化了我自己的自定义控件：

```
[Activity (Label = "GridControl", MainLauncher = true)]
public class Main : Activity
{       
    private GridDataView<Customer> gridDataView;

    private int fieldsCount;
    private List<Customer> customers;

    protected override void OnCreate (Bundle bundle)
    {
        base.OnCreate (bundle);

        // Set our view from the "main" layout resource
        SetContentView (Resource.Layout.Main);

        customers = Customer.GetCustomers();

        int customizeFieldsCount = typeof(Customer).GetProperties().Length;
        string[] columnItems = {"Customer Number", "Customer Name", "City", "Address", "Credit Limit", "Contact Name", "Telephone Number", "Mail"};

        gridDataView = new GridDataView<Customer>(this, customers, customizeFieldsCount, columnItems);    }    } 
```

这是自定义复合控件的代码：

```
 public class GridDataView<T> : LinearLayout
{
    private ScrollView sc;
    private HorizontalScrollView hsc;
    private RelativeLayout rl1, rl2;
    private TableLayout tl1, tl2;

    private List<T> dataObject;
    private int fieldsCount;
    private string[] columnItems;

    public GridDataView(Context context, List<T> dataObject, int fieldsCount, string[] columnItems)
        : base (context) 
    {
        try
        {   
             this.Orientation = Android.Widget.Orientation.Vertical;
             sc = new ScrollView(context);
             rl1 = new RelativeLayout(context);
             hsc = new HorizontalScrollView(context);
             tl1 = new TableLayout(context);
             tl2 = new TableLayout(context);

            //Create a new row to be added.
             TableRow trHeader = new TableRow(context);
             TableRow trLeftHeader = new TableRow(context);

                //Create text views to be added to the row.
                for (int i = 0; i < fieldsCount; i++) 
                {
                    TextView tvHeader = new TextView(context);
                    if(i==0)
                    {
                        CreareHeader(trLeftHeader, tvHeader, columnItems[i]);
                    }
                    else 
                        CreareHeader(trHeader, tvHeader, columnItems[i]);
                }

                tl1.AddView(trLeftHeader);
                tl2.AddView(trHeader);

              var dataProperties = typeof(T).GetProperties(System.Reflection.BindingFlags.Public | System.Reflection.BindingFlags.Instance);

              for(int i = 0; i<dataObject.Count(); i++)
              {
                 //Create a new row to be added
                 TableRow trData = new TableRow(context);
                 TableRow trLeftData = new TableRow(context);

                for (int j = 0; j < fieldsCount; j++) {

                 TextView tv = new TextView(context);
                 if(j==0)
                 {
                    CreateLeftColumn(trLeftData, tv, dataProperties[j].GetValue(dataObject[i], null).ToString());
                 }
                 else 
                    CreateView(trData, tv, dataProperties[j].GetValue(dataObject[i], null).ToString());
                 }

                 //Add the new row to our tableLayout tl
                 tl1.AddView(trLeftData);
                 tl2.AddView(trData);
              }     

            RelativeLayout.LayoutParams parameters = new RelativeLayout.LayoutParams(LayoutParams.WrapContent, LayoutParams.WrapContent);
            parameters.AddRule(LayoutRules.RightOf, tl1.Id);
            hsc.AddView(tl2, parameters);;
            rl1.AddView(tl1);
            rl1.AddView(hsc);
            sc.AddView(rl1);
        }
        catch(Exception ex )
        {
            Toast.MakeText(context, ex.ToString(), ToastLength.Long).Show();
        }
    }

    public void SetDataObject(List<T> mDataObject)
    {
        dataObject = mDataObject;
    }

    public void SetFieldsCount(int mFieldsCount)
    {
        fieldsCount = mFieldsCount;
    }

    public void SetColumnItems(string[] mColumnItem)
    {
        columnItems = mColumnItem;
    }

    private void CreareHeader(TableRow tr, TextView t, string viewdata)
    {
        t.SetText(viewdata, TextView.BufferType.Editable);

        //You have to use Android.Graphics.Color not System.ConsoleColor;
        t.SetTextColor(Android.Graphics.Color.White);
        t.SetBackgroundColor(Android.Graphics.Color.Black); 
        t.SetTypeface(null, Android.Graphics.TypefaceStyle.Bold);
        t.SetPadding(10, 10, 10, 10);
        t.Gravity = GravityFlags.CenterHorizontal;

        tr.SetPadding(0, 1, 0, 1); 
        tr.SetBackgroundColor(Android.Graphics.Color.Gray);

        tr.AddView(t); // add TextView to row.
    }

    private void CreateLeftColumn(TableRow tr, TextView t, string viewdata) 
    {
        t.SetText(viewdata, TextView.BufferType.Editable);

        //You have to use Android.Graphics.Color not System.ConsoleColor;
        t.SetTextColor(Android.Graphics.Color.White);
        t.SetBackgroundColor(Android.Graphics.Color.Black); 
        t.SetPadding(5, 0, 0, 0);
        t.Gravity = GravityFlags.Left;

        tr.SetPadding(0, 1, 0, 1); 
        tr.SetBackgroundColor(Android.Graphics.Color.Gray);

        tr.AddView(t); // add TextView to row.

    }   

    private void CreateView(TableRow tr, TextView t, string viewdata) 
    {
        t.SetText(viewdata, TextView.BufferType.Editable);

       //adjust the porperties of the textView
       //t.SetLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT));

        //You have to use Android.Graphics.Color not System.ConsoleColor;
        t.SetTextColor(Android.Graphics.Color.Blue);
        t.SetBackgroundColor(Android.Graphics.Color.Black); 
        t.SetPadding(5, 0, 0, 0);

        tr.SetPadding(0, 1, 0, 1); 
        tr.SetBackgroundColor(Android.Graphics.Color.Black);

        tr.AddView(t); // add TextView to row.

    }
} 
```

它没有出现。有人能知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-19T02:46:09.807

您的滚动视图对象是您的所有内容的容器视图，但您没有将其添加到对象的视图中，请将以下内容添加到 GridDataView 构造函数的末尾：

```
AddView(sc); 
```

之后为我工作。

# google-app-engine - 保存 key_name 值 GAE 和 WTforms

> ID：10623106
> 
> 赞同：1
> 
> 时间：2012-05-16T16:50:59.823
> 
> 标签：google-app-engine, wtforms

我正在将 WTforms 与 GAE 一起使用，并试图找出设置 key_name 值的最佳方法。这有效，但不是很干净。具体来说， p = Posts(key_name... 行似乎是多余的。

```
class CreatePost(BaseHandler):
def post(self):
    form = MyForm(self.request.POST)
    if form.validate():
        p = Posts()
        p.author = users.get_current_user()
        p.title = form.title.data
        p.path = format_post_path(p)
        p.content = form.content.data
        p = Posts(key_name=p.path, author=p.author, 
                       title=p.title, content=p.content, path=p.path)
        p.put()
        return webapp2.redirect('/admin/')
    else: 
        self.render_template('create.html', {'form':form}) 
```

我试过这样做，但它不起作用。

```
class CreatePost(BaseHandler):
def post(self):
    form = MyForm(self.request.POST)
    if form.validate():
        p = Posts()
        p.author = users.get_current_user()
        p.title = form.title.data
        p.path = format_post_path(p)
        p.content = form.content.data
        p.key_name = p.path
        p.put()
        return webapp2.redirect('/admin/')
    else: 
        self.render_template('create.html', {'form':form}) 
```

我的问题：写这个的最好方法是什么？为什么 p.key_name = p.path 不起作用？

**更新 1**

以下是相关代码：

```
from models import Posts
import fix_path
import wtforms
from wtforms.ext.appengine.db import model_form
from wtforms import Form, TextField, validators

MyForm = model_form(Posts, Form, field_args = {
    'title' : {
        'validators' : [validators.Length(min=1, max=25)]
    },
    'content' : {
        'validators' : [validators.Length(min=4, max=100000)]
    }
})

def slugify(s):
    s = unicodedata.normalize('NFKD', s).encode('ascii', 'ignore').lower()
    return re.sub('[^a-zA-Z0-9-]+', '-', s).strip('-')

def format_post_path(p):
    slug = slugify(p.title)
    return config.post_path_format % {
        'slug': slug,
        'year': p.date_create.year,
        'month': p.date_create.month,
        'day': p.date_create.day,
   }

class BaseHandler(webapp2.RequestHandler):

    @webapp2.cached_property
    def jinja2(self):
        return jinja2.get_jinja2(app=self.app)

    def render_template(
        self,
        filename,
        template_values,
        **template_args
        ):
        template = fix_path.jinja_environment.get_template(filename)
        self.response.out.write(template.render(template_values))  

class CreatePost(BaseHandler):
    def post(self):
        form = MyForm(self.request.POST)
        if form.validate():
            p = Posts()
            p.author = users.get_current_user()
            p.title = form.title.data
            p.path = format_post_path(p)
            p.key_name = p.path #this part doesn't work. 
                                #No error. Just not value
                                #passed to datastore.
            p.content = form.content.data
            p.put()
            return webapp2.redirect('/admin/')
        else: 
            self.render_template('create.html', {'form':form})

    def get(self):  

        MyForm = model_form(Posts, Form)
        self.render_template('create.html', {'form':MyForm()}) 
```

从配置文件

```
post_path_format = '/%(year)d/%(month)02d/%(slug)s' 
```

我只是不明白为什么我可以使用 p.key_name = p.path 格式（如第一个片段）。为什么我必须这样做 p = Posts(key_name=path, author=p.author..... (就像第二个片段)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:29:32.747

看起来您正在创建一个临时的 Posts 实体，然后使用它的“路径”创建另一个 Posts 实体，您实际保存了它。这在很多方面都搞砸了。

```
class CreatePost(BaseHandler):
    def post(self):
        form = MyForm(self.request.POST)
        if form.validate():
            p = Posts(key_name=???, users.get_current_user(), title=p.title, content=form.content.data, path=???)
            p.put()
            return webapp2.redirect('/admin/')
        else: 
            self.render_template('create.html', {'form':form}) 
```

这就留下了一个问题，什么是“路径”？您需要在不使用现有实体的情况下生成“路径”。

此外，如果“路径”是实体祖先路径，我认为这不是您真正想要的键名。

# c - 对 ... 的操作可能未定义？

> ID：10623114
> 
> 赞同：49
> 
> 时间：2012-05-16T16:51:25.347
> 
> 标签：c, undefined-behavior

我有以下代码

```
FRAME frameArray[5][10]; // Create the array of frames
int trackBufferFull[5] = {0, 0, 0, 0, 0};// Keeps track of how full the buffer for each node is
int trackFront[5] = {0, 0, 0, 0, 0}; // Array to keep track of which is the front of the array
int trackTail[5] = {0, 0, 0, 0, 0};

// Function to add to the array (CHANGE int frame)
void addFrame (int nodeNumber, FRAME frame)
{
    //Calc tail
    int tail = trackTail[nodeNumber-1];

    // Calc frames in buffer
    int framesinBuffer = trackBufferFull[nodeNumber-1];

    if (framesinBuffer == 10)
    {
        printf("Buffer is full\n");
    }
    else
    {

        // Add frame to frameArray
        frameArray[nodeNumber-1][tail] = frame; 
        printf("\nAdded a frame in node: %i to the buffer\n", nodeNumber);

        // Increment the count
        trackBufferFull[nodeNumber-1]++;
        trackTail[nodeNumber-1] = ++trackTail[nodeNumber-1] % 10;

    }  
} 
```

我用于 frameArray 的数组是长度为 10 的环绕/循环数组，因此我有代码

```
trackTail[nodeNumber-1] = ++trackTail[nodeNumber-1] % 10; 
```

一切都在独立文件中完美运行，但是在更大的文件中运行时，出现以下编译错误：

```
$ cnet GARETH -m 30
compiling gareth.c
gareth.c: In function ‘addFrame’:
gareth.c:77:27: error: operation on ‘trackTail[nodeNumber + -0x00000000000000001]’ may be undefined [-Werror=sequence-point]
gareth.c: In function ‘removeFirstFrame’:
gareth.c:98:28: error: operation on ‘trackFront[nodeNumber + -0x00000000000000001]’ may be undefined [-Werror=sequence-point]
gareth.c:105:1: error: control reaches end of non-void function [-Werror=return-type]
cc1: all warnings being treated as errors 
```

77号线是线

```
trackTail[nodeNumber-1] = ++trackTail[nodeNumber-1] % 10; 
```

帮助。

为了并排查看带有行号的代码和错误，我将图片上传到：http: [//i.imgur.com/wyO5a.png](https://i.imgur.com/wyO5a.png)

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-05-16T16:55:01.357

> 77号线是线
> 
> ```
> trackTail[nodeNumber-1] = ++trackTail[nodeNumber-1] % 10; 
> ```

您在[序列点](http://c-faq.com/expr/seqpoints.html)`trackTail[nodeNumber-1]`之间更改了两次：一次通过，一次通过分配。`++`

这是[未定义的行为](http://en.wikipedia.org/wiki/Undefined_behavior)。

补救措施是改写语句，例如：

```
trackTail[nodeNumber-1] = (trackTail[nodeNumber-1] + 1) % 10; 
```

或者像这样：

```
trackTail[nodeNumber-1]++;
trackTail[nodeNumber-1] %= 10; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-16T16:54:46.660

您正在`trackTail[nodeNumber - 1]`序列点之间进行修改。就像你在分配

```
i = ++i; 
```

这也是未定义的行为。

将您的代码更改为以下内容：

```
trackTail[nodeNumber - 1] = (trackTail[nodeNumber - 1] + 1) % 10; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-16T16:55:47.433

```
trackTail[nodeNumber-1] = ++trackTail[nodeNumber-1] % 10; 
```

是的，正如错误消息所说，这是未定义的行为。在没有序列点的情况下，您不能两次修改相同的值。在这种情况下，这意味着您不能同时`trackTail[nodeNumber-1]`使用递增`++`和重新分配它`=`。

如果您只使用`+ 1`而不是`++`，它将正常工作。

# javascript - 有没有办法从 javascript 中调用 Gmaps4rails.geocode(address) ？

> ID：10623118
> 
> 赞同：2
> 
> 时间：2012-05-16T16:51:43.217
> 
> 标签：javascript, gmaps4rails

我想在javascript中做这样的事情：

```
var latLngMatches = Gmaps4rails.geocode(address);
... 
```

这在嵌入式 javascript 中不起作用。事实上，如果我进入 Chrome 控制台并键入`Gmaps4Rails`，则 javascript 中的对象没有函数`geocode`（请参见下文）。

问题：有没有办法`Gmaps4rails.geocode(address)` 从 javascript 中调用？

JAVASCRIPT 控制台输出：

```
function Gmaps4Rails() {
      this.map = null;
      this.visibleInfoWindow = null;
      this.userLocation = null;
      this.geolocationFailure = function() {
        return false;
      };
      this.callback = function() {
        return false;
      };
      this.customClusterer = function() {
        return false;
      };
      this.infobox = function() {
        return false;
      };
      this.jsTemplate = false;
      this.default_map_options = {
        id: 'map',
        draggable: true,
        detect_location: false,
        center_on_user: false,
        center_latitude: 0,
        center_longitude: 0,
        zoom: 7,
        maxZoom: null,
        minZoom: null,
        auto_adjust: true,
        auto_zoom: true,
        bounds: [],
        raw: {}
      };
      this.default_markers_conf = {
        title: "",
        picture: "",
        width: 22,
        length: 32,
        draggable: false,
        do_clustering: false,
        randomize: false,
        max_random_distance: 100,
        list_container: null,
        offset: 0,
        raw: {}
      };
      this.markers = [];
      this.boundsObject = null;
      this.polygons = [];
      this.polylines = [];
      this.circles = [];
      this.markerClusterer = null;
      this.markerImages = [];
    } 
```

# javascript - 根据行数限制文本区域？

> ID：10623125
> 
> 赞同：1
> 
> 时间：2012-05-16T16:52:07.080
> 
> 标签：javascript, jquery, html, textarea

当我的 textarea 充满内容时，我不希望它再接受超出其`rows`and的内容`cols`。

插图：

Textarea 默认（第 1 部分）：

![在此处输入图像描述](../Images/173ee72b9cf0a4437da98af81b07b67d.png)

文本区域完整（第 2 部分）：

![在此处输入图像描述](../Images/ab6305f1467c386a909b5fa7520808ba.png)

文本区域超过高度（第 3 部分）：

![在此处输入图像描述](../Images/87cc6cefa369556b340c0b8d73aed7a9.png) ![在此处输入图像描述](../Images/412318142fa3026a0dc31083153901b9.png)

我不想`part 3`发生这种情况，它保持高度，但在输入换行符时内容会移动。我已经尝试了[限制 textarea 中的行数和使用 jQuery 显示行数](https://stackoverflow.com/questions/6501043/specify-and-limit-number-of-lines-in-textarea-and-display-line-count-using-jquer)的答案，但它只会在我按下时停止我的输入`Enter`，但在输入长单词时它会继续接受输入：

例子：`aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`

我尝试了另一种使用方式，`AutoGrow textarea Plugin`因为它得到了`Line and Characters per Line`，所以当文本行等于`row`textarea 时，它会增加它的`rows`. 这是我能想到的最接近的解决方案，但它也失败了。

# jquery - 如何使用 jQuery 在 Chrome 中拖动 SVG 元素而不会获得偏移量？（火狐没问题）

> ID：10623127
> 
> 赞同：3
> 
> 时间：2012-05-16T16:52:31.630
> 
> 标签：jquery, svg, jquery-svg

我正在尝试编写一些允许拖动 SVG 元素的代码。这对于 jQuery、jQuery UI 和 jQuery SVG 来说非常简单，并且在 Firefox 中运行良好，但在 Chrome 中，当我拖动 SVG 元素时，显然会在其坐标中添加一个偏移量。我看不到我做错了什么，也没有发现这方面的任何已知错误。

我构建了一个小例子来说明这个问题：

```
<html>
  <head>
    <title>Foo</title>
    <style type="text/css">
    </style>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://keith-wood.name/js/jquery.svg.js"></script>
    <script type="text/javascript">
$(function() {
    var svgOnLoad = function () {
        var svg = $('#canvas').svg('get');
        $('#piece')
            .draggable()
            .bind('drag', function (event, ui) {
                // Update transform manually, since top/left style props don't work on SVG
                var t = event.target.transform.baseVal;
                if (t.numberOfItems == 0) {
                    t.appendItem(svg.root().createSVGTransform());
                }
                t.getItem(0).setTranslate(ui.position.left, ui.position.top);
            });
    }
    $('#canvas').svg({loadURL: "foo.svg", onLoad: svgOnLoad});
});
    </script>
  </head>
  <body>
    <div id="canvas" style="width: 100%; height: 100%;"></div>
  </body>
</html> 
```

其中 foo.svg 只是：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    width="450" height="450">
    <rect id="piece" width="50" height="50" x="100" y="100" />
</svg> 
```

在线版本可以在以下位置找到：

[http://jsfiddle.net/rrthomas/v477X/2/](http://jsfiddle.net/rrthomas/v477X/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T23:01:50.663

问题是您不是从 svg 画布的位置 0, 0 开始的。您可以通过从对象中减去 x 和 y 属性来获得所需的结果。当您计算手动拖动时，您正在重新定位整个 svg 元素，而不仅仅是矩形。

见这里：http: [//jsfiddle.net/v477X/6/](http://jsfiddle.net/v477X/6/)

**注意：**不同的浏览器似乎为您尝试翻译的元素返回不同的对象。此解决方案适用于 Webkit 浏览器。此时，您似乎有两个选择。修改您的选择器以选择相同的元素（特别是 t.getItem(0) 行），或者确定用户当前在哪个浏览器上查看，如果是 webkit，则添加偏移量。就个人而言，我会选择后者，因为这样你就可以设置一个变量并检查它。

请参阅此处了解如何检测浏览器引擎：[How to detect if a browser is Chrome using jQuery?](https://stackoverflow.com/questions/6339480/how-to-detect-if-a-browser-is-chrome-using-jquery)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-19T11:54:32.917

这里的 jQueryUI 似乎有一个错误：在非 Webkit 浏览器中，ui.position 对象使用绝对坐标，而在其他浏览器中，它是 ui.originalPosition 的偏移量。我不知道哪个是正确的；错误是行为不一致。我已在以下位置提交了错误报告：

[http://bugs.jqueryui.com/ticket/8335](http://bugs.jqueryui.com/ticket/8335)

因此，解决方法是存储顶级元素的原始坐标，并在 Webkit 浏览器中设置翻译转换时将坐标设置为 (ui.position - ui.originalPosition + origCoords)。（Jlange 的答案使用了我的最小示例中使用的 rect 的 x 和 y 属性，在那里可以正常工作，但不适用于更复杂的对象 a）可能没有 x 和 y 属性（例如，如果顶级元素是ag元素）和b）返回的坐标似乎不是顶级元素的坐标（恐怕我不知道为什么）。）最小代码如下：

```
var svgOnLoad = function () {
var svg = $('#canvas').svg('get');
    $('#piece')
        .draggable()
            .on({
                dragstart: function (event, ui) {
                    var tlist = this.transform.baseVal;
                        if (tlist.numberOfItems == 0) {
                            tlist.appendItem(svg.root().createSVGTransform());
                        }
                        var tm = tlist.getItem(0).matrix;
                        var pos = {left: tm.e, top: tm.f};
                        $.data(this, 'originalPosition', pos);
                    },
                    drag: function (event, ui) {
                        // Update transform manually, since top/left style props don't work on SVG
                        var tlist = this.transform.baseVal;
                        var CTM = this.getCTM();
                        var p = svg.root().createSVGPoint();
                        p.x = ui.position.left + CTM.e;
                        p.y = ui.position.top + CTM.f;
                        if ($.browser.webkit) { // Webkit gets SVG-relative coords, not offset from element
                            var origPos = $.data(this, 'originalPosition');
                            p.x -= ui.originalPosition.left - origPos.left;
                            p.y -= ui.originalPosition.top - origPos.top;
                        }
                        p = p.matrixTransform(CTM.inverse());
                        tlist.getItem(0).setTranslate(p.x, p.y);
                    }});
};
$('#canvas').svg({onLoad: svgOnLoad}); 
```

​​现场版在：http: [//jsfiddle.net/rrthomas/v477X/](http://jsfiddle.net/rrthomas/v477X/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-21T17:56:17.870

我最近花了几天时间来解决这个问题，我想出了一个对我来说效果很好的解决方案。这绝对是一个 hack，并且不会在所有情况下都有效。

[这个链接](http://www.codedread.com/blog/archives/2005/12/21/how-to-enable-dragging-in-svg/)对如何解决一般问题有很好的描述，这绝对是“更好”的解决方案。但是，我想继续使用 JQuery 出色的 Draggable API。

[你可以在这里](http://jsfiddle.net/BFU6F/1/)看到我在小提琴中所做的快速模型。关键思想是使用代理 div，您可以将其精确地悬停在要拖动的 svg 元素上。然后在拖动代理 div 时更改 svg 元素的 x 和 y 坐标。像这样的东西：

```
$('#proxy').on('drag', function(e)
    {
        t = $('#background');
        prox = $('#proxy');
        t.attr('x', t.attr('x')*1
                   + prox.css('left').slice(0,-2)*1
                   - prox.data('position').left)
            .attr('y', t.attr('y')*1
                      + prox.css('top').slice(0,-2)*1
                      - prox.data('position').top);
        prox.data('position',{top : prox.css('top').slice(0,-2)*1,
                              left: prox.css('left').slice(0,-2)*1}
                  );
    }); 
```

在我的例子中，我想要拖动的 SVG 元素总是会填充屏幕上的某个正方形，因此将代理 div 定位在目标上非常容易。在其他情况下，这可能要困难得多。使用“遏制”选项来确保您不会将背景拖到框架之外也不是太难……它只需要一些仔细的数学运算，并且您必须在每次拖动之间重置遏制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-19T11:19:33.950

用这个：

```
<html>
<head>
    <title>Foo</title>
    <style type="text/css">
    </style>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/ui/1.8.18/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://keith-wood.name/js/jquery.svg.js"></script>
    <script type="text/javascript">
        $(function ()
            {
            var svg = $('#canvas').svg().svg('get');
            $('#piece')
                    .draggable()
                    .on({
                        dragstart: function (event, ui)
                            {
                            var t = this.transform.baseVal;
                            if (t.numberOfItems == 0)
                                { t.appendItem(svg.root().createSVGTransform()); }
                            var tm = t.getItem(0).matrix;
                            var dx = tm.e - ui.position.left;
                            var dy = tm.f - ui.position.top;
                            $.data(this, 'dragTo', function dragTo(newPos)
                                {
                                tm.e = newPos.left + dx;
                                tm.f = newPos.top + dy;
                                });
                            },
                        drag: function (event, ui)
                            { $.data(this, 'dragTo')(ui.position); }});
            });
    </script>
</head>
<body>
<div id="canvas" style="width: 100%; height: 100%;">
    <svg version="1.1"
         xmlns="http://www.w3.org/2000/svg"
         width="450" height="450">
        <rect id="piece" width="50" height="50" x="0" y="0" style="position:absolute"/>
    </svg>
</div>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-09T03:24:48.203

我有一个类似的问题。我发现由于某种原因，Chrome 将转换属性转换为 CSS 样式属性。所以它创建了一个 CSS 样式 - CSS 引擎调整坐标 - 然后 SVG 引擎*尝试*应用变换：翻译。然后两人互相干扰。

CSS 似乎有优先权。这是一个显示这一点的代码笔。
[http://codepen.io/dax006/pen/ONNWXv](http://codepen.io/dax006/pen/ONNWXv)

我的理论是，当 Chrome 更新 CSS 样式时，它会不断地被破坏和重新创建，有时在这些时刻之间，SVG 会潜入 tranform:translate()。然后 Chrome 获取新的变换值并将其应用到 CSS，现在您的变换将无法正常工作，因为 CSS 挡住了路。

理论上，transform:translate 应该在创建 CSS 的同一时刻被销毁，但事实并非如此。只需检查元素，您就会看到改变坐标的 CSS 样式和变换属性的存在。

```
<rect y="100" x="100" height="50" width="50" id="piece" style="position: relative; left: -15px; top: -13px;" transform="translate(-15, -13)"/> 
```

请务必查看本文和底部的链接。 [https://css-tricks.com/svg-animation-on-css-transforms/](https://css-tricks.com/svg-animation-on-css-transforms/)

# textmate2 - Textmate 2命令行支持未安装

> ID：10623128
> 
> 赞同：2
> 
> 时间：2012-05-16T16:52:37.577
> 
> 标签：textmate2

![首选项 -> 终端](../Images/b642b04943a6999ee689ac5c38795f69.png)

TextMate2 (Alpha 9090) 终端支持不会在任何目录中安装任何东西。

有没有办法在任何地方手动抓取这个脚本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-12T17:27:05.403

解决方案：（通过 Michael Sheets）

“确保您在首选项中安装了 'Bundle Support' 捆绑包。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:48:07.933

您可以尝试几件事。`shift`单击以重新安装您选择的任何版本时按住不放`Check now`（因此您可以选择正常版本并按住 shift+单击以降级）。我已经检查过，它在 9113 上对我来说很好。要获得最前沿的版本，`alt`请改为单击。这些修饰键协同工作，因此您可以 alt+shift+click 重新安装较新版本。

这些较新的版本可能包含额外的调试并且可能不稳定，所以 YMMV 但到目前为止这对我来说不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-01T04:39:43.680

我猜你可能有 /usr/local/bin 的权限问题。尝试打开终端并执行以下操作：

```
ls -al /usr/local/bin/mate
touch  /usr/local/bin/mate
ls -al /usr/local/bin/mate
rm     /usr/local/bin/mate 
```

看看你是否得到任何错误。

关于您的第二个问题，请参阅 SuperUser 上的此线程：[TextMate 2 的应用程序包中“伙伴”可执行文件的路径是什么？](https://superuser.com/questions/471877/what-is-the-path-to-the-mate-executable-in-textmate-2s-app-bundle/472589). 找到它后，您可以对其进行符号链接：

```
for cmd in mate mate_wait; do
    ln -s /path/to/mate /usr/local/bin/$cmd;
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-08T14:11:26.517

您可能不需要获取任何代码，因为“安装”似乎只是为了更改一些参数，而不是安装任何新代码。诀窍是无论如何都单击“安装”按钮......然后将所需的代码行（见下文）粘贴到您的.bashrc中。

今天晚上早些时候，我在使用 TextMate 时遇到了问题。我在当天早些时候安装了 TextMate ......但是终端中的“mate”命令不起作用（即它什么也没做）。此外，当我在`which mate`终端中输入代码（以尝试查找其他信息）时，我收到了一个空白响应。

导航到 TextMate | 后 偏好 | 终端 我看到了您现在看到的消息。然后我按照显示的说明进行操作。

(a) 首先，我点击“安装”按钮。虽然没有明显的安装过程，但想必发生了一些事情。

(b) 其次，我将下面的行复制到我的 .bashrc 文件中。

```
 export EDITOR="/usr/local/bin/mate -w" 
```

最后，我关闭并重新打开终端（重置）......并且“伙伴”命令起作用了！

# php - 努力在数据库字段中存储加密信息

> ID：10623129
> 
> 赞同：6
> 
> 时间：2012-05-16T16:52:46.727
> 
> 标签：php, mysql, encryption

我在 mysql 数据库中存储加密信息时遇到了巨大的问题，引擎 mySam

我像这样加密信息：

```
function in($plaintext) {
 $cipher = 'rijndael-256';
 $mode = 'cbc';
 $key = 'key';

    $td = mcrypt_module_open($cipher, '', $mode, '');
    $iv = mcrypt_create_iv(mcrypt_enc_get_iv_size($td), MCRYPT_RAND);
    mcrypt_generic_init($td, $key, $iv);
    $crypttext = mcrypt_generic($td, $plaintext);
    mcrypt_generic_deinit($td);
    return $iv.$crypttext;
} 
```

然后将数据存储在一个 blob 中。当我开始对信息进行解密时，似乎大约 10% 的时间由于数据库中的存储而损坏。

我可以验证数据库是问题所在，因为我已经运行脚本来大规模加密和解密数据而没有问题。

有任何想法吗？提前致谢...

[编辑解密例程]

```
function decrypt($crypttext)
{   
 $cipher = 'rijndael-256';
 $mode = 'cbc';
 $key = '$key';

    $plaintext = ''; 
    $td        = mcrypt_module_open($cipher, '', $mode, '');
    $ivsize    = mcrypt_enc_get_iv_size($td);
    $iv        = substr($crypttext, 0, $ivsize);
    $crypttext = substr($crypttext, $ivsize);
    if ($iv)
    {   
        mcrypt_generic_init($td, $key, $iv);
        $plaintext = mdecrypt_generic($td, $crypttext);
    }   
    return $plaintext;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:34:48.243

我*非常*怀疑您是否遇到过 mysql 数据库错误...“损坏”如何？我们可以看看你的解密程序和测试脚本吗？您遇到的不仅仅是块大小的填充？

填充：加密算法通常适用于数据块（使用 128 位的 aes） - 输入（因此输出！）数据将被填充到这个长度，并且您需要存储整个填充的输出字符串 - 并且可能是您的长度- 填充输入，如果您的输入数据是一种无法确定填充并在解密后自动删除的表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:37:44.130

在 MySQL 中保护明文密码不是一个好主意……还有为什么不使用 SHA1 或 MD5 哈希……您将获得更多简洁的响应，然后根据需要更改算法。

基本上

SELECT SHA1("SecretPassword") will = 08cd923367890009657eab812753379bdb321eeb 或 blabityboo

SHA1 将存储 40 个字符，这意味着您可能应该将数据类型从 BLOB 更改为 varchar，或者 nvarchar() <---可能是 varchar...

如果没有您的算法的构造，我们无法判断该字段将持续多长时间，因此有关于填充的评论。

当您使用 SELECT CHARACTER_LENGTH("SecretPassword") 选择通行证时，您将获得加密字段的长度。然后您可以创建适当的约束。

希望这可以帮助。

# php - 如何在不重定向到该表单操作页面的情况下处理表单操作的结果？

> ID：10623133
> 
> 赞同：4
> 
> 时间：2012-05-16T16:53:04.383
> 
> 标签：php, forms

请原谅我缺乏 100% 特定的技术语言……我有点笨拙……

后端开发人员（在我无权访问的服务器上工作）为我设置了表单操作，我想知道使用该表单操作的响应作为用户的错误或成功消息的最佳方法是什么。例如，当我使用 GET 变量（例如 remote-server.com/action.cfm?email=nothing）点击表单操作时，远程 cfm 页面将仅显示“-3”，这是“bad”的错误代码电子邮件”。开发人员设置了一系列与其他错误/成功案例相对应的错误/成功代码。

所以我正在寻找一个基本上可以做到的解决方案：

1.  获取表单数据并将其传递给 remote-server.com/action.cfm，而不将用户定向到该页面。

2.  从 remote-server.com/action.cfm 读取响应，这将是一系列以逗号分隔的数字。

3.  在 PHP 中将这些数字分配为字符串，这样我就可以嗅出错误/成功代码并在我的前端代码中显示适当的消息。

再说一遍，简而言之，问题是我想使用表单 action="remote-server.cfm"... 但没有将用户重定向到该 cfm 页面的页面。相反，它应该将 cfm 页面的输出输入到我的表单的 PHP 页面中，以便我可以处理它。这有意义吗？我环顾四周，人们似乎说 AJAX 是做到这一点的唯一方法。还有其他想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T16:59:40.600

没错，好像你需要使用 Javascript 和 AJAX。通过 AJAX 调用，您可以在后台向该服务器发送异步后查询，而无需将用户重定向到任何其他页面，并解析响应变量。

如果提交有错误，您可以显示正确的错误（如果您知道服务器期望什么，甚至在提交之前不知道什么，甚至可以添加表单验证），如果 AJAX 调用成功，只需将用户重定向到不同的页面（并且不再发布表单，因为它已经提交过一次）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T16:57:44.600

为什么不使用 AJAX？让 JavaScript/jQuery 在表单上附加一个提交处理程序，并使用 AJAX 悄悄地提交它，然后读取适当的响应和诸如此类的内容，并为用户很好地显示它。

如果 JavaScript 被禁用，表单将正常提交，这不是很漂亮，但应该仍然可以使用。

# c++ - 只有“双”元素的结构会有填充吗？

> ID：10623137
> 
> 赞同：2
> 
> 时间：2012-05-16T16:53:18.160
> 
> 标签：c++, padding, memory-alignment

假设我有一个 C/C++ 结构

```
struct ABCTYPE
{
  double A;
  double B;
  double C;
}; 
```

是否确保在任何类型的现代平台上都没有额外的填充？

更具体地说，如果我使用

```
std::vector<ABCTYPE> storage;
// add some elements

// now i need some C routines to the data
double* param=&(storage[0]);
c_routine(param);  // Tested OK on Win/Linux, but will it work on any platforms? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T16:55:22.727

从技术上讲，这样的结构有填充是可能的。即使是仅包含一个成员的结构的简单情况也可以有填充：

[C++ sizeof 包装类](https://stackoverflow.com/questions/5994302/c-sizeof-wrapper-class)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:00:03.180

在 Visual C++ 中，可以`#pragma pack`用来改变结构的填充；该值可以设置为大于`sizeof(double)`8。文档显示了将其设置为 16 的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:18:40.427

就您的*具体*问题`std::vector`而言，您在上面询问的等价是否有效的答案可以[在此 stackoverflow 帖子](https://stackoverflow.com/questions/849168/are-stdvector-elements-guaranteed-to-be-contiguous)中找到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:21:15.777

理论上是可以的。实际上，看到它我会有些惊讶（尽管例如，如果您将类型从 更改`double`为`short`，填充将变得不那么令人惊讶）。

使用 MS VC，`#pragma pack`只会导致（最多）对象的大小对齐：来自[MSDN](http://msdn.microsoft.com/en-us/library/2e70t5y1.aspx)：

> n（可选）
> 
> 指定用于打包的值（以字节为单位）。n 的默认值为 8。有效值为 1、2、4、8 和 16。成员的对齐方式将位于 n 的倍数或成员大小的倍数的边界上，**以两者为准更小。**[重点补充]

这意味着包含多个相同类型成员的结构将永远不会在它们之间插入填充。`#pragma pack`控制可以插入的*最大填充量，而不是最小值。*

# php - 网页导航（粗体有问题）

> ID：10623140
> 
> 赞同：1
> 
> 时间：2012-05-16T16:53:32.660
> 
> 标签：php, mysql, css

我正在构建一个网页，并试图让我的导航正确。我正在使用 mysql 将“主题”存储在一个表中，将“页面”存储在网站的另一个表中。它工作得很好，但我只是用粗体来表示一个被选中的页面或主题，出于某种原因，当我选择一个主题时，它会加粗该主题下的整个页面列表。这些页面按我的预期工作（它加粗了我选择的页面）。这是我的 PHP 页面，它们是我的 CSS 页面。（我怀疑它的 html 类“选择”正在被继承，但我看不出如何）。任何帮助都会很棒。

PHP

```
 while ($subject = mysql_fetch_array($subject_set)){
                    echo "<li";
                    if ($subject["id"] == $sel_subj){ echo " class=\"selected\""; }
                    echo"><a href=\"content.php?subj=".urlencode($subject['id']).
                            "\">{$subject["menu_name"]}</a></li>";
                    $page_set = get_pages_for_subject($subject['id']);
                    echo "<ul class=\"pages\">";
                    while ($page = mysql_fetch_array($page_set)){
                        echo "<li";
                        if ($page['id'] == $sel_page){ echo " class=\"selected\""; }
                        echo"><a href=\"content.php?page=".urlencode($page['id']).
                        "\">{$page["menu_name"]}</a></li>";
                    }
                    echo "</ul>";
                }
                ?>
                    </ul>
                </td>
                <td id="page">
                    <h2>Content Area</h2>
                    <?php echo $sel_subj;?>
                    <?php echo $sel_page;?>
                </td>
            </tr>
        </table> 
```

CSS

```
/*Navigation*/
#navigation { width: 225px; height: 600px; padding: 5% 5%;
             color: #0D8800; background: #44EE44; }
#navigation a { color: #8D0D19; text-decoration: none; }
ul.subjects { padding-left: 0; list-style: none; }
ul.pages { padding-left: 0; list-style: square; }
.selected { font-weight: bold; } 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:08:57.013

将“选定”类移动到“a”标签可能会更好。

如果这不是一个选项，那么您将需要阻止继承：

```
.selected ul li { font-weight: normal; } 
```

# xpages - “计算字段”控制和 disableOutputTag="true" 不起作用？

> ID：10623143
> 
> 赞同：1
> 
> 时间：2012-05-16T16:53:46.293
> 
> 标签：xpages

> **可能重复：**
> [XPages disableOutput 标记问题](https://stackoverflow.com/questions/9700830/xpages-disableoutput-tag-issue)

我的 xpage 上有一个计算字段控件，它生成 HTML (escape=false)。默认情况下，计算字段会在内容周围生成跨度标签，这会导致 IE 中的一些视觉不一致。所以我为这个计算域设置了 disableOutputTag="true" 但在这种情况下，计算域不会生成任何东西。我有重复控件 disableOutputTag="true" ，它工作正常，但可以让它为计算文本工作。这是一些错误还是我的误解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T07:45:07.903

如上所述， [XPages disableOutput 标记问题](https://stackoverflow.com/questions/9700830/xpages-disableoutput-tag-issue)讨论了相同的问题，但仍未解决......

# mysql - #1005 - 无法使用 MySQL 创建表 'testt.rating' (errno: 150)

> ID：10623145
> 
> 赞同：1
> 
> 时间：2012-05-16T16:53:51.593
> 
> 标签：mysql

我正在`errorno:150`使用 MySQL。当我尝试创建第三个表时，它显示**Can't create table**。以下是完整的查询。

```
CREATE DATABASE `test`;
USE `test`;

-- --------------------------------------------------------

--
-- Table structure for table `product`
--

CREATE TABLE IF NOT EXISTS `product` (
  `product_no.` int(10) NOT NULL AUTO_INCREMENT COMMENT 'This number represent a unique product',
  `name` varchar(50) NOT NULL ,
  `price` decimal(5,2) NOT NULL COMMENT 'Price should have a fomat like 25.90',
  `max_Rating` int(10) NOT NULL COMMENT 'Maximum available rating for each product (n)',
  PRIMARY KEY (`product_no.`)
);

-- --------------------------------------------------------

--
-- Table structure for table `user`
--
CREATE TABLE IF NOT EXISTS `user` (
  `user_id` int(10) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `password` varchar(20) NOT NULL,
  PRIMARY KEY (`user_id`)
);

-- --------------------------------------------------------

--
-- Table structure for table `rating`
--
CREATE TABLE IF NOT EXISTS `rating` (
  `s.n.` int(10) NOT NULL AUTO_INCREMENT,
  `product_no.` int(10) NOT NULL,
  `user_id` int(10) DEFAULT NULL,
  `given_rating` int(10) DEFAULT NULL,
  PRIMARY KEY (`s.n.`),
  foreign key (`user_id`) references `user(user_id)`,
  foreign key (`product_no.`) references `product(product_no.)`
); 
```

是否发生任何字段不匹配？我现在被困住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T16:56:16.963

它看起来与您的外键定义中的引用有关。

```
CREATE TABLE IF NOT EXISTS `rating` (
  `s.n.` int(10) NOT NULL AUTO_INCREMENT,
  `product_no.` int(10) NOT NULL,
  `user_id` int(10) DEFAULT NULL,
  `given_rating` int(10) DEFAULT NULL,
  PRIMARY KEY (`s.n.`),
  /* Remove the backquotes surrounding user(user_id) and product(product_no.) */
  foreign key (`user_id`) references user (user_id),
  /* Inside the parens, `product_no.` should be quoted because of the period */
  foreign key (`product_no.`) references product (`product_no.`)
); 
```

我只想指出，您不会经常遇到以特殊字符命名的表，例如`s.n`or `product_no.`。尽管它们在引用时被允许并起作用，但由于它们引入了引用需要，因此使用它们有些不常见。否则就没有必要引用`product_no`没有`.`.

# c++ - 在 Windows 上从用户模式程序发送和接收 ARP 数据

> ID：10623153
> 
> 赞同：3
> 
> 时间：2012-05-16T16:54:23.927
> 
> 标签：c++, windows, winapi, network-programming, windows-networking

（ARP = 地址解析协议 - RFC 826）有没有办法通过用户世界程序在 Windows 上发送和接收 ARP 流量？在 Linux 上，我们可以只创建原始套接字来发送 ARP 流量，但在 Windows 上，我的研究表明我们需要编写一个可用于发送此类流量的驱动程序。我考虑过使用 WinPcap，但它在内部安装了一个可用于发送/接收此类流量的驱动程序。

我的问题是：在不安装驱动程序的情况下，Windows 是否有任何方式允许传输/接收 ARP 数据包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:04:39.093

发送 ARP 数据包的最简单方法*可能是*使用[`SendARP`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366358.aspx).

然后，您可以使用[`GetIpNetTable`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365956.aspx)从 IP 堆栈的 ARP 表中检索地址。为确保您获得当前地址，您通常需要[`DeleteIpNetEntry`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365882.aspx)删除该地址，然后`SendARP`，然后等待一段时间`GetIpNetTable`（如果需要重复几次，直到您获得一个包含所需地址条目的条目）。

或者，对于 Vista 或更新版本，您可以[`ResolveIpNetEntry2`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa814455.aspx)更直接地检索数据。这会自动刷新地址的当前条目（如果有），发送 ARP 数据包，并返回当前结果（如果我没记错的话，它也用于更新堆栈的 ARP 表）。

# asp.net-mvc - 从 MVC 3 升级到 4 后，Razor 辅助方法不起作用

> ID：10623154
> 
> 赞同：6
> 
> 时间：2012-05-16T16:54:29.970
> 
> 标签：asp.net-mvc, asp.net-mvc-migration

我在 App_Code 目录下的文件中有一个辅助方法。该方法在 MVC 3 中运行良好，但在升级到 MVC 4 后就不行了。它在第一个 @if() 块上失败了......

[编辑] 这看起来像是 Razor 引擎中的解析错误。当我的所有对象及其属性都不为空时，我收到“对象引用未设置为对象的实例”错误。我想我得直接去微软。

[编辑] 错误消息是旧的“对象引用未设置为对象的实例”。这很奇怪，因为条件中的每个对象 AND 属性都是有效的且不为空。

```
@helper RenderConnectButton(System.Web.Mvc.HtmlHelper helper, ContactTwitterHandleDto contactTwitterHandle, ContactFacebookAccountDto contactFacebookAccount) {
    <ul class="socialMedia inlineList">           
        @if (contactTwitterHandle != null && contactTwitterHandle.IsValid.HasValue && contactTwitterHandle.IsValid.Value)
        {
            var tHandle = "@" + contactTwitterHandle.Handle;
            <li class="twitter">
                <a class="btn" href="http://www.twitter.com/@contactTwitterHandle.Handle" target="_blank">
                    <i></i>
                    <span class="label">@tHandle</span> 
                </a>
                @if(contactTwitterHandle.FollowerCount.HasValue)
                {
                    <div class="count" id="c">
                        <i></i>
                        <u></u>
                        <span class="followers" title="@contactTwitterHandle.FollowerCount.Value followers">@FollowerCount(contactTwitterHandle.FollowerCount.Value)</span>
                    </div>
                }                    
            </li>
            <script type="text/javascript">
                $("#twitter").click(function () {
                    window.location.href = '@(helper.BuildUrlFromExpression<TenantController>(t => t.LinkTwitterAccount()))';
                })
            </script>
        }

        @if (contactFacebookAccount != null && contactFacebookAccount.IsValid.HasValue && contactFacebookAccount.IsValid.Value)
        {
            <li class="facebook">
                <a class="btn" href="@contactFacebookAccount.Url" target="_blank">
                    <i></i>
                    <span class="label">@contactFacebookAccount.Name</span> 
                </a>
                @if(contactFacebookAccount.FriendCount.HasValue)
                {
                    <div class="count" id="c">
                        <i></i>
                        <u></u>
                        <span class="followers" title="@contactFacebookAccount.FriendCount.Value friends">@FriendCount(contactFacebookAccount.FriendCount.Value)</span>
                    </div>
                }
            </li>                
        }
    </ul> } 
```

[更新] 我稍微改变了代码，现在它更奇怪了。我在该行遇到与上述相同的错误：

```
var tLink = "http://www.twitter.com/" + contactTwitterHandle.Handle; 
```

contactTwitterHandle 和 contactTwitterHandle.Handle 都不是空的。

```
@helper RenderConnectButton(System.Web.Mvc.HtmlHelper helper, ContactTwitterHandleDto contactTwitterHandle, ContactFacebookAccountDto contactFacebookAccount) {
    <ul class="socialMedia inlineList">           
        @if (contactTwitterHandle != null && contactTwitterHandle.IsValid.HasValue && contactTwitterHandle.IsValid.Value)
        {
            var tHandle = "@" + contactTwitterHandle.Handle;
            var tLink = "http://www.twitter.com/" + contactTwitterHandle.Handle;
            <li class="twitter">
                <a class="btn" href="@tLink" target="_blank">
                    <i></i>
                    <span class="label">@tHandle</span> 
                </a>
                @if(contactTwitterHandle.FollowerCount.HasValue)
                {
                    <div class="count" id="c">
                        <i></i>
                        <u></u>
                        <span class="followers" title="@contactTwitterHandle.FollowerCount.Value followers">@FollowerCount(contactTwitterHandle.FollowerCount.Value)</span>
                    </div>
                }                    
            </li>
            <script type="text/javascript">
                $("#twitter").click(function () {
                    window.location.href = '@(helper.BuildUrlFromExpression<TenantController>(t => t.LinkTwitterAccount()))';
                })
            </script>
        }

        @if (contactFacebookAccount != null && contactFacebookAccount.IsValid.HasValue && contactFacebookAccount.IsValid.Value)
        {
            <li class="facebook">
                <a class="btn" href="@contactFacebookAccount.Url" target="_blank">
                    <i></i>
                    <span class="label">@contactFacebookAccount.Name</span> 
                </a>
                @if(contactFacebookAccount.FriendCount.HasValue)
                {
                    <div class="count" id="c">
                        <i></i>
                        <u></u>
                        <span class="followers" title="@contactFacebookAccount.FriendCount.Value friends">@FriendCount(contactFacebookAccount.FriendCount.Value)</span>
                    </div>
                }
            </li>                
        }
    </ul>
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T15:17:00.217

我找到了解决这个问题的方法，但首先是一点历史。对于这个特殊的 MVC 项目，我们决定逐步开始实施 Razor。该应用程序有很多“模态”区域，这些区域通过 AJAX 调用来填充以获取局部视图。这些局部视图是第一个作为 Razor 视图实现的。后来，我们想使用 Razor 局部视图在标准 ASPX 视图页面中实现一个新功能，但是 ASPX 视图引擎无法渲染局部 Razor 视图，因此我没有使用 Razor 视图，而是在 App_Code 文件夹中添加了一个 MVC 帮助文件呈现特征的方法。此方法是升级到 MVC4 后导致错误的原因。具有此方法呈现的功能的页面就是我的 **这解决了问题，但是，*我仍然认为这是 Razor 引擎中的一个错误，用于使用辅助方法进行渲染。***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:37:23.790

我将方法简化为：

```
@helper RenderConnectButton(System.Web.Mvc.HtmlHelper helper, ContactTwitterHandleDto contactTwitterHandle, ContactFacebookAccountDto contactFacebookAccount) {

    <ul class="socialMedia inlineList">
        @if (contactTwitterHandle != null && contactTwitterHandle.IsValid.HasValue && contactTwitterHandle.IsValid.Value)
        {
            var tHandle = contactTwitterHandle.Handle;

            <li class="twitter">
                <a class="btn" href="http://twitter.com/@tHandle" target="_blank">
                    <i></i>
                    <span class="label">@tHandle</span> 
                </a>
            </li>
        }

    </ul>
} 
```

如果我从该行中删除 @tHandle：

```
 <a class="btn" href="http://twitter.com/@tHandle" target="_blank"> 
```

它会解析得很好。如果我将上面的 Url 放在变量中，则会出现错误。

**尝试解析作为 Url 的字符串时失败。**

堆栈跟踪：

```
 at System.Web.WebPages.HelperPage.WriteAttributeTo(TextWriter writer, String name, PositionTagged`1 prefix, PositionTagged`1 suffix, AttributeValue[] values)
   at ASP.MvcSocialMediaHelpers.<>c__DisplayClass1.<RenderConnectButton>b__0(TextWriter __razor_helper_writer) in c:\OberonScrum\Branches\RazorUpgrade\Source\Web\App_Code\MvcSocialMediaHelpers.cshtml:line 83
   at System.Web.WebPages.HelperResult.ToString()
   at System.String.Concat(Object arg0, Object arg1)
   at ASP.views_contact_detail_aspx.__RenderMainContent(HtmlTextWriter __w, Control parameterContainer) in c:\OberonScrum\Branches\RazorUpgrade\Source\Web\Views\Contact\Detail.aspx:line 13
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at ASP.views_shared_twocolumnleftmain_master.__Render__control1(HtmlTextWriter __w, Control parameterContainer) in c:\OberonScrum\Branches\RazorUpgrade\Source\Web\Views\Shared\TwoColumnLeftMain.Master:line 109
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.Mvc.ViewPage.Render(HtmlTextWriter writer)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

[更新] 尝试使用 TagBuilder 解决该问题并使用 Html.Raw(); 得到了同样的结果。

```
@helper RenderConnectButton(System.Web.Mvc.HtmlHelper helper, ContactTwitterHandleDto contactTwitterHandle, ContactFacebookAccountDto contactFacebookAccount) {
    <ul class="socialMedia inlineList">
        @if (contactTwitterHandle != null && contactTwitterHandle.IsValid.HasValue && contactTwitterHandle.IsValid.Value)
        {
            var tHandle = contactTwitterHandle.Handle;
            var a = new TagBuilder("a");
            a.Attributes.Add("href", "http://twitter.com/" + @tHandle);
            a.Attributes.Add("target", "_blank");
            a.Attributes.Add("class", "btn");
            a.InnerHtml = string.Format("<i></i><span class=\"label\">{0}</span>", @tHandle);

            <li class="twitter">
                @Html.Raw(a.ToString())
            </li>
        }
    </ul>
} 
```

# java - 以“+0100”（例如）格式获取时区

> ID：10623158
> 
> 赞同：4
> 
> 时间：2012-05-16T16:54:36.770
> 
> 标签：java, timezone, datetime-format

我在文档和谷歌发现的众多与时间相关的问题之间迷失了方向。

我想要的非常简单：一个以“[+/-] [number] [number] [number] [number]”格式（例如“+0100”）表示运行时区的字符串。

我目前的代码是：

```
 Calendar cal = Calendar.getInstance();
    TimeZone tz = cal.getTimeZone();
    String gmt = "" + tz.getID(); 
```

它在我的位置返回“GMT”，我假设它是时区的简短版本（3 个字母）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-18T17:00:01.940

这是我最终使用的代码，希望对某人有所帮助。

```
Date today = Calendar.getInstance().getTime();
SimpleDateFormat sdf = new SimpleDateFormat("Z");
String gmt = sdf.format(today); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T17:02:44.827

你应该尝试以下事情。

```
Calendar c = Calendar.getInstance();
        System.out.println("current: " + c.getTime());

        TimeZone z = c.getTimeZone();
        int offset = z.getRawOffset();
        if (z.inDaylightTime(new Date())) {
            offset = offset + z.getDSTSavings();
        }
        int offsetHrs = offset / 1000 / 60 / 60;
        int offsetMins = offset / 1000 / 60 % 60;

        System.out.println("offset: " + offsetHrs);
        System.out.println("offset: " + offsetMins);

        c.add(Calendar.HOUR_OF_DAY, (-offsetHrs));
        c.add(Calendar.MINUTE, (-offsetMins));

        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

        System.out.println("GMT Time: " + sdf.format(c.getTime()) + " +"
                + offsetHrs + ":" + offsetMins); 
```

**输出**

```
current: Wed May 16 22:32:14 IST 2012
offset: 5
offset: 30
GMT Time: 2012-05-16 17:02:14 +5:30 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T17:00:02.783

似乎您想要 SimpleDateFormat 中的“Z”或“X”

```
Z 时区 RFC 822 时区 -0800
X 时区 ISO 8601 时区 -08；-0800; -08:00

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-05-07T22:58:14.757

# *java.time*

旧的日期时间 API（`java.util`日期时间类型及其格式化 API `SimpleDateFormat`）已过时且容易出错。建议完全停止使用它并切换到`java.time`现代[日期时间 API](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html) ^*。

**使用现代 API 的解决方案：**

```
import java.time.ZoneId;
import java.time.ZonedDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Locale;

public class Main {
    public static void main(String[] args) {
        // Replace ZoneId as applicable e.g. ZoneId.of("America/New_York")
        ZonedDateTime now = ZonedDateTime.now(ZoneId.systemDefault());

        DateTimeFormatter dtf = DateTimeFormatter.ofPattern("XX", Locale.ENGLISH);
        String offset = dtf.format(now);
        System.out.println(offset);
    }
} 
```

**输出：**

```
+0100 
```

从**[Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关[现代日期时间 API](https://www.oracle.com/technical-resources/articles/java/jf14-date-time.html) ^*的更多信息。

* * *

来自 Ole VV 的反馈：

> 您可能希望使用小写字母`xx`，这样您也可以获得偏移量零`+0000`而不是 `Z`偏移量零。

谢谢，Ole VV 的增值将使寻找`+0000`而不是`Z`零时区偏移的人受益。我建议严格根据具体要求使用它。[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Time_zone_designators)建议使用`Z`零时区偏移作为时区指示符。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

# android - android中的单例问题

> ID：10623160
> 
> 赞同：3
> 
> 时间：2012-05-16T16:54:52.430
> 
> 标签：android, singleton

我有一个 android 应用程序，其中有几个活动。每个活动都会下载一个 xml/json 提要，对其进行解析并将其推送到通常作为数组列表的单例中。

然而，在经历了各种活动之后，单例似乎正在消亡，并且大多数早期下载的数组列表现在都是空的。为什么会这样？单例不是跨活动共享数据的推荐做法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:10:02.560

添加我的评论作为答案

> 如果要跨活动保留全局变量，请将其保留在应用程序中。从 Application 扩展一个类并将其添加到您的 AndroidManifest 文件中。

来自@rekaszeru 分享的 Android API FAQ

> 单例类
> 
> 您可以通过使用单例来利用您的应用程序组件在同一进程中运行这一事实。这是一个设计为只有一个实例的类。它有一个名为 getInstance() 的静态方法，它返回实例；第一次调用此方法时，它会创建全局实例。因为所有调用者都获得相同的实例，所以他们可以将其用作交互点。例如，活动 A 可以检索实例并调用 setValue(3)；稍后的活动 B 可能会检索实例并调用 getValue() 以检索最后设置的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:03:21.927

请参阅此线程[Android API FAQ](http://developer.android.com/resources/faq/framework.html#3)，在这里您一定会找到最适合您的问题的解决方案（无论您需要短期数据还是长期数据）。

单例用于短生命周期的对象。

**编辑**：请记住，对于大量数据，使用数据库/结构化本地文件总是一个更好的主意（尽管后者是读/写资源消耗）。如果您正在处理非常复杂的对象，那么选择`SharedPreferences`也可能会引起一些头痛。

存储/加载列表的示例`SharedPreferences`：

```
// the name with which to store the shared preference
public static final String PERSON_LIST = "my.personlist";

// a sample data structure that will be stored
public static final class Person
{
    private String name;
    private int age;

    public String toString() 
    {
        return name + "|" + age;
    }

    // splits the passed String parameter, and retrieves the members
    public static Person loadPersonFromString(final String personString)
    {
        final Person p = new Person();
        final String[] data = personString.split("|");
        p.name = data[0];
        p.age = Integer.parseInt(data[1]);
        return p;
    }
}

/**
 * Saves the current list of Persons in SharedPreferences 
 * @param persons: the list to save
 */
public void savePersonList(final ArrayList<Person> persons) 
{
    final SharedPreferences prefs = PreferenceManager.
        getDefaultSharedPreferences(getApplicationContext());
    final Editor editor = prefs.edit();
    final StringBuilder builder = new StringBuilder();
    for (final Person person : persons)
    {
        if (builder.length() > 0)
            builder.append("-Person-");
        builder.append(person.toString());
    }
    editor.putString(PERSON_LIST, builder.toString());
    editor.commit();
}

/**
 * Loads the list of Persons from SharedPreferences
 * @return the loaded list
 */
public ArrayList<Person> loadPersonList()
{
    final SharedPreferences prefs = PreferenceManager.
        getDefaultSharedPreferences(getApplicationContext());
    final ArrayList<Person> persons = new ArrayList<Menu.Person>();
    final String[] array = prefs.getString(PERSON_LIST, "").split("-Person-");
    for (final String personString : array) 
    {
        if (personString.length() > 0)
            persons.add(Person.loadPersonFromString(personString));
    }
    return persons;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T17:00:20.457

您可以通过 Application 类进行初始化。此类存在于所有活动中。您必须在 Manifest 文件中声明它，并且具有类似于 Activity 的生命周期。

此处的文档：[应用程序](http://developer.android.com/reference/android/app/Application.html)

希望能帮助到你。

JQcorreia

# c# - 将 NSData 转换为 base64 编码和 C# 中的字节数组

> ID：10623162
> 
> 赞同：10
> 
> 时间：2012-05-16T16:54:52.700
> 
> 标签：c#, ios, xamarin.ios, in-app-purchase, storekit

我正在为我们的 iOS 应用程序实施应用程序内购买，以获取各种自动更新订阅。付款完成后，我们需要将交易信息发送到我们的服务器（云）以记录信息，以便我们可以在设定的时间间隔内验证收据，以确保订阅有效、未取消/退款或续订。我们将在设定的时间间隔内从服务器调用 JSON 以通过应用内购买指南和我们的共享密钥执行此操作，但尚未实现，但在我们这样做之前，我们需要从购买中获取相关数据，即作为 NSData 对象的 TransactionReceipt。

我们希望向我们的 Web 服务发送 TransactionReceipt 的两个参数（以及其他项目，例如购买的 ProductID 等）。我们希望将其作为 base64 编码值发送，这是我们认为需要在 JSON 请求中发送以进行验证的值，因此我们将其存储在 SQL Server 中。

如何，使用 MonoTouch / C# 我们可以将 NSData“TransactionReceipt”转换为 base64 编码以及一个字节 []？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T17:08:11.207

有两种简单的方法可以从 中获取数据`NSData`，使用 a`Stream`或`Bytes`and`Length`属性。流版本看起来像：

```
public byte[] ToByte (NSData data)
{
    MemoryStream ms = new MemoryStream ();
    data.AsStream ().CopyTo (ms);
    return ms.ToArray ();
} 
```

和`Bytes`版本`Length`将是：

```
public byte[] ToByte (NSData data)
{
    byte[] result = new byte[data.Length];
    Marshal.Copy (data.Bytes, result, 0, (int) data.Length);
    return result;
} 
```

获取 base64 输出字符串保持不变：

```
public string ToBase64String (NSData data)
{
    return Convert.ToBase64String (ToByte (data));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-21T11:25:59.913

这也有效：

```
string yourDataInBase64 = Convert.ToBase64String(yourData.ToArray()); 
```

# php - Node.js 或 PHP 中的模式识别算法？

> ID：10623163
> 
> 赞同：20
> 
> 时间：2012-05-16T16:54:55.163
> 
> 标签：php, algorithm, node.js, nlp, pattern-recognition

我想开始尝试识别数据模式的算法。我处理多种类型的序列（图像像素、文本输入、用户移动），使用[模式识别](http://en.wikipedia.org/wiki/Pattern_recognition)尝试从不同的数据集中提取有意义的数据会很有趣。像大多数网络一样，我的数据主要是基于文本或整数键的。

它们是否提供了用于检查/创建 PHP 或 Nodejs 模式的基本框架的类？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-16T17:23:51.773

我从来没有找到一个封装不同分析模式的库。不过，您可以轻松找到特定的解决方案。

例如，N-Gram 分析可以通过这个 PHP 扩展来完成：http: [//pecl.php.net/package/TextCat](http://pecl.php.net/package/TextCat)

还有几个贝叶斯实现，甚至是教程。

我从来没有发现用 PHP 实现的 Kohonen-nets 或自组织地图，但是多层感知器是微不足道的。IA 可以很好地进行模式分析。

有些项目将 PHP 绑定到 OpenCV（用于实时图像/视频分析的库）。目前，我知道的唯一实现是用于检测图片中的人脸。源是开放的[https://github.com/infusion/PHP-Facedetect](https://github.com/infusion/PHP-Facedetect)，所以应该很容易绑定其他 OpenCV 优点（OpenCV 可以用图像做很多事情）。

PHP 本身是解释型的，大多数模式分析的重型解决方案在此限制下都不会很好地执行。这就是为什么 PHP 中的大多数解决方案都是用 C 作为扩展编写的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-25T08:30:56.593

对于机器学习，您可能会考虑使用更“在家”的语言，因为它更容易表达模型。

例如，用**R**编写的新的“黑客机器学习”一书的源代码可以在 Github [https://github.com/johnmyleswhite/ML_for_Hackers中找到](https://github.com/johnmyleswhite/ML_for_Hackers)

然后，还有 Google Prediction API，非常适合进行实验[https://developers.google.com/prediction/docs/developer-guide](https://developers.google.com/prediction/docs/developer-guide)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-04T16:07:21.263

我意识到这是一个老问题，但由于它位于谷歌查询的顶部，它认为它应该包含对 opencv 的节点绑定[node-opencv](https://github.com/peterbraden/node-opencv "节点opencv")的引用。

# javascript - 是否有完全实现的 REST javascript 客户端？

> ID：10623170
> 
> 赞同：6
> 
> 时间：2012-05-16T16:55:23.953
> 
> 标签：javascript, json, rest, schema

我一直在试验和研究用于 RESTful Web 服务的 javascript 客户端。我所看到的几乎所有内容似乎都仅限于在客户端中重新创建模型定义并在简单（非相关）模型上执行 CRUD。

我在寻找什么

*   能够在给定服务器 API 提供的 JSONREST 模式的 URI 的情况下在客户端中动态创建模型（和/或代理和/或存储）
*   能够本地处理关系（即，无需创建一堆自定义函数或覆盖许多内置功能）。我说的是 1->n、1->1、n->1 和 n->m 关系。
*   能够与 ExtJS 或 Dojo 等功能齐全的客户端框架一起工作得相当好。

我试过的

*   ExtJS 4.1：很棒的小部件集，能够进行完全程序化的布局，'ajax'/'rest' 代理可以开箱即用地用于简单模型。我找不到 IRC 或开发社区，GPL 论坛上的响应有限。
*   Dojo [current]：需要自定义覆盖到 JsonRestStore 才能使用基本模型。很棒的小部件，很难完全避免使用 html。
*   我还查看了各种基于 jquery 的工具和一些在主干.js （http://backbonejs.org 目前已关闭。）。jquery 的东西对我来说似乎完全脱节。如果有好的 jquery REST 工具，我对它们持开放态度，我只需要指向有关如何使用它们开发连贯且可管理的应用程序的文档的指针。

基本目标

*   开发随时间推移可维护且“干燥”的 Web 客户端应用程序。也就是说，在相关“类”中几乎没有复制粘贴 {param1: 'asdf', param2: 30, ...}。理想情况下，如果它是在服务器上定义的，那么客户端应该从 REST API 中获取它。如果它在客户端中定义，客户端的其他部分应该能够继承/扩展该定义。

另一种说法：

*   大多数 JS 框架都遵循 MVC 模式。对我来说，这很愚蠢，因为我的“M”和一些“C”已经在服务器上。我希望我的客户端成为“Vc”，只重新创建尽可能多的服务器端模型，以实现专注于 UI 呈现和用户操作的异步操作。这意味着理想情况下，“MVC”中的“M”都不会被硬编码到客户端中。

是否有一个功能齐全的 javascript REST 客户端可以指点我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:11:05.037

您最可能想查看的几个链接：

**Backbonejs.org 的替代 URL**：[http ://documentcloud.github.com/backbone/](http://documentcloud.github.com/backbone/)

您可能知道，Backbone 根据您的数据创建对象，例如集合和模型。

**关系映射**：[https ://github.com/PaulUithol/Backbone-relational/](https://github.com/PaulUithol/Backbone-relational/)

如果您想在 Backbone 中进行关系数据映射，请点击上面的链接

**JSON 模式验证器**：[https ://github.com/garycourt/JSV](https://github.com/garycourt/JSV)

如果您担心确保遵守某个 JSON Schema，这很方便，您可以扩展 Backbone.js 以通过覆盖该`validate`方法来验证模型客户端。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-24T21:54:26.950

查看我的 Javascript JSON-Hyper-Schema 客户端。它通过使用 OPTIONS 方法解析在给定资源端点提供的模式，使用 Angular 动态构建 HTML 客户端应用程序。

[https://github.com/bpanahij/passportedu_schema/tree/master/client](https://github.com/bpanahij/passportedu_schema/tree/master/client)

我一直在使用 JSON Hyper Schema 研究 HATEOAS（作为应用程序状态引擎的超媒体）API。您可以转到下面的 URL，浏览、注册、登录并执行一些操作。

在这里查看： [http ://direct.psprt.com:8081/](http://direct.psprt.com:8081/)

到目前为止，我还开源了我的实际 API 代码： [https ://github.com/bpanahij/passportedu_schema](https://github.com/bpanahij/passportedu_schema)

随意看看，借用和评论。

[JSON 超模式][1]（另见 [JSON 模式][2]）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T17:15:41.437

试试[https://github.com/avoidwork/abaaso](https://github.com/avoidwork/abaaso)，我听说过很好的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T18:48:41.817

我认为找到一个好的客户端库的问题在于我们（就像在 Web 社区中一样）还没有对 REST 以及如何构建 SERVER 库有一个完全充实和完整的理解。

HAL ( [http://stateless.co/hal_specification.html](http://stateless.co/hal_specification.html) ) 等技术可能会提供最好的前进方向。当您拥有一组提交给 HATEOAS ( [http://en.wikipedia.org/wiki/HATEOAS](http://en.wikipedia.org/wiki/HATEOAS) ) 的 API 并且真正以允许超链接驱动应用程序的方式工作时，您就有了构建 VERY 的方法无需重新构建每个对象并重新考虑每个业务规则的轻量级前端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-10T14:41:36.010

试试[restful.js](https://github.com/marmelab/restful.js)。富有表现力的语法允许资源嵌套，建立在 Promise 之上，并且不会妨碍您。它的灵感来自 Restangular，只是它是独立的。

免责声明：我们写的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-18T12:33:47.603

如果你不想要一个完整的框架，试试这个：[https](https://github.com/jpillora/jquery.rest) ://github.com/jpillora/jquery.rest它很新，所以请发布问题、错误、功能请求！

# position - 跨不同浏览器定位

> ID：10623171
> 
> 赞同：1
> 
> 时间：2012-05-16T16:55:27.733
> 
> 标签：position, absolute

我遇到了一个问题，即页面上自身级别的元素在不同浏览器中的位置不同。这是幻灯片； [http://nevillebeandesign.com/Tattoo/bobShaw.html](http://nevillebeandesign.com/Tattoo/bobShaw.html) 在 Safari 中，它比 Firefox 和 Chrome 高几个像素，而在 Opera 中显着降低。我不得不减小它的大小，这样它就不会与背景图像中的红线重叠（最初在 Safari 中，它紧贴在两条红线之间）。我可以在文档头中放置某种修复程序来调整不同浏览器的定位吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:39:56.823

该问题与您正在使用的 <object> 元素有些相关，该元素被插入到单元格中。此外，由于您依赖于过时的标记结构（表格），因此许多旧的怪癖开始发挥作用。基本上，您的元素在 CSS 中称为内联块。这意味着它可以接受垂直对齐属性。但是，在您的情况下，您强制浏览器使用其内部算法，因为您使用了 align 属性（已弃用）。这就是为什么您会在各种浏览器中看到不同的垂直对齐方式。要解决此问题，请为对象的元素提供规定的高度，并尝试将“vertical-align: middle”CSS 声明应用于对象本身。您还可以尝试在对象的容器上设置适当的“行高”。

# objective-c - 如何到达包含任何日期的午夜的 NSDates？

> ID：10623176
> 
> 赞同：2
> 
> 时间：2012-05-16T16:55:34.320
> 
> 标签：objective-c, ios, nsdate

给定任何 NSDate，我将如何获得最后一个午夜和下一个午夜的日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:06:45.010

这非常复杂，但可行：

```
NSDate *date = ...;
NSUInteger componentFlags = NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit;
NSDateComponents *parts = [[NSCalendar currentCalendar] components:componentFlags fromDate:date];
NSDateComponents *midnightComponents = [[NSDateComponents alloc] init];
[midnightComponents setDay:[parts day]];
[midnightComponents setMonth:[parts month]];
[midnightComponents setYear:[parts year]];
NSCalendar *cal = [[NSCalendar currentCalendar];
NSDate *midnight = [cal dateFromComponents:midnightComponents];

NSDateComponents *offsetComponents = [[NSDateComponents alloc] init];
[offsetComponents setDay:1];
NSDate *nextMidnight = [cal dateByAddingComponents:offsetComponents toDate: midnight options:0]; 
```

我认为与 .NET 甚至 Java 相比，Apple 的设计有点过于复杂，但它是易于管理的。

# java - 在小程序上画一个旋转的矩形

> ID：10623180
> 
> 赞同：0
> 
> 时间：2012-05-16T16:55:51.540
> 
> 标签：java, applet, drawing

我必须在我的小程序上制作一个旋转矩形，它是如何完成的？矩形应围绕其在平面上的一个角旋转。这是我到目前为止所拥有的：

```
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics;
import javax.swing.JApplet;

public class MainApplet extends JApplet {
    Font bigFont;
     Color redColor; 
     Color weirdColor; 
     Color bgColor;

    @Override
     public void init()  
     { 
          bigFont = new Font("Arial",Font.BOLD,16);
          redColor = Color.red;
          weirdColor = new Color(60,60,122);
      setBackground(bgColor);
     }

    @Override
     public void stop() { }

    @Override
     public void paint(Graphics g)  
     { 
      g.setFont(bigFont); 
      g.drawString("Shapes and Colors",80,20);     
      g.setColor(redColor);
      g.drawRect(100,100,100,100);
      g.fillRect(100,100,100,100);
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:23:17.743

我不会为你编写你的小程序，但我会给你一些步骤来帮助你开始：

在您的初始化中：

*   设置一个计时器，每次都会调用刷新方法。
*   将全局计数器设置为 0

在您的刷新方法中：

*   将计数器增加 1（可能是 mod 360 以使其保持在 0-359 范围内）
*   调用重绘方法

在您的绘画方法中：

*   转动 Canvas 计数器打开的度数（可能使用 AffineTransform 对象）
*   画你的图像/正方形/形状/任何东西

祝你好运 ：）

# liferay - 识别 portlet 的第一个呈现阶段

> ID：10623182
> 
> 赞同：0
> 
> 时间：2012-05-16T16:56:00.557
> 
> 标签：liferay, render, portlet

我如何知道渲染阶段是否是 portlet 的第一个渲染阶段？

我想在 Liferay 中显示我所有组织用户的列表，并能够通过在文本字段中写入名称来过滤结果。

在文本字段中插入用户名时出现了我的问题。我想在他/她的某些属性中搜索具有该名称的用户，并仅显示这些用户。我不知道为什么，尽管我将生成的重新搜索作为属性存储在 actionRequest 中，但仍会再次显示所有用户：

actionRequest.setAttribute("usersList", users);

并尝试仅打印这些用户。此操作阶段之后的渲染阶段不会使用我的属性来仅渲染已创建的用户。

因此，我的意图是以某种方式确定我的渲染阶段是否是第一个阶段，或者它是否在操作阶段之后，以便我可以创建一个条件来打印所有用户或打印存储在 actionRequest.setAttribute 中的列表中的用户。

非常感谢您，希望您能提供帮助，顺便说一句，我继续自己研究。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-04T07:09:27.580

让我详细介绍一下请求的类型

1）动作请求：这些用于向服务器提供数据，如发布、提交表单、提交时的更多处理（数据存储）

2) 渲染请求：他们绘制你的 html 部分，在这里你可以从数据库中检索数据，排列它，对它进行分类并存储在请求属性中，从表示层，获取它并绘制它。

如果你想直接使用render请求，请创建一个render URL而不是action URL，比如说，如果你有表单的提交按钮，那么你的html表单的action属性应该有“”，这将直接调用render方法并且不会采取行动。

希望这可以帮助。

——菲利克斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:33:36.360

我有个坏消息，你不能将类似的参数从动作请求传递到渲染请求，因为动作请求只存在于动作阶段。因此，您无法从渲染阶段检索这些值。

将属性从动作传递到渲染的唯一方法（据我所知）是使用

```
actionResponse.setRenderParameter("name", "value") 
```

注意值必须是字符串！因此，您不能传递例如对象列表。

你的选择是

1）在渲染阶段进行实际搜索。2）将结果放在会话中，因此它们也可以在渲染阶段使用。

如果您选择选项 1，则完全忘记操作阶段并将您的搜索表单发布到渲染阶段方法。这就是我在这些情况下经常做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T09:59:40.993

尝试使用 ActionResponse.setRenderParameter。渲染参数将在 Render 阶段存在，您可以使用 RenderRequest 类中的 getParameter 方法访问它们。

# ssas - SSAS 分区，多少太多

> ID：10623188
> 
> 赞同：3
> 
> 时间：2012-05-16T16:56:28.203
> 
> 标签：ssas, partitioning

我正在向我的 SSAS 多维数据集添加分区，并且我想知道是否有多个分区需要保留？多少是太多，最佳实践限制是 20 还是 200？有没有人可以分享任何现实世界的知识？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:28:38.967

这是[另一篇文章](https://web.archive.org/web/20140228063441/http://duncansutcliffe.wordpress.com:80/2010/10/15/handling-and-tuning-really-large-analysis-services-cubes/)（由 Duncan Sutcliffe 撰写），其中有一节是关于分区的。

此外，您还需要考虑管理不同分区策略所需的开销。如果您最终有很多分区，那么它可能是一个真正需要管理的 PITA，因此您可能希望实现某种 SSIS/脚本解决方案来自动化创建分区的过程。

您最终决定做的将是特定于环境的，但是在您发布的文章和 Duncan 的文章（上图）之间，您应该对决策中的考虑因素以及哪些杠杆有一个很好的（高级）想法由你处置。

# macos - 是否可以以编程方式打开 iSight 摄像头？

> ID：10623190
> 
> 赞同：0
> 
> 时间：2012-05-16T16:56:31.977
> 
> 标签：macos, isight

我想在我的 Mac 上设置自动相机捕捉，我正在使用`isightcapture`程序。

但是，我需要打开相机，你知道我该怎么做吗？我的技能非常有限，`Objective-C`并且`RubyCocoa`无法在我的环境中工作（安装了 ruby​​ 1.9）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T23:40:41.560

我不完全确定你打算用自动相机捕捉做什么，但[EyeSight](http://www.klieme.com/EyeSight.html)可能值得一看。它将允许您以预定义的时间间隔以多种格式进行捕获，甚至会生成所拍摄图像的日志（这在您的脚本中可能有用吗？）。

# c# - C# 应用程序中 where 子句中的未知列

> ID：10623192
> 
> 赞同：4
> 
> 时间：2012-05-16T16:56:39.093
> 
> 标签：c#, mysql

我正在尝试开发 C# 应用程序，我希望将登录表单连接到远程服务器。我连接到服务器，但是当我尝试登录时，该行： MySqlDataReader reader = cmd.ExecuteReader(); 给我一个错误：`where clause`你知道问题出在哪里吗？这是我的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace ECBSRecruitmentAgencySoftware
{
    public partial class LogIn : Form
    {
        public LogIn()
        {
            InitializeComponent();
        }  

        public bool tryLogin(string username , string password)
        {
             MySqlConnection con = new MySqlConnection("host=aaaaaaaa.baaadsg;user=saaaaaak;password=2333333336;database=soaaaaaaaa2;");
             MySqlCommand cmd = new MySqlCommand("Select * FROM niki WHERE user_name = `" + username + "` AND user_password = `" + password + "`;");
             cmd.Connection = con;
             con.Open();
             MySqlDataReader reader = cmd.ExecuteReader();
             if (reader.Read() != false)
             {
                 if (reader.IsDBNull(0) == true)
                 {
                     cmd.Connection.Close();
                     reader.Dispose();
                     cmd.Dispose();
                     return false;
                 }
                 else
                 {
                     cmd.Connection.Close();
                     reader.Dispose();
                     cmd.Dispose();
                     return true;
                  }
             }
             else 
             {
                 return false;
             }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            if (tryLogin(user.Text, pass.Text) == true)
            {
                MainScreen F2 = new MainScreen();
                F2.Show();
                this.Hide();
            }            
            else 
                MessageBox.Show("Wrong details!");             
        } 
    }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:01:00.300

在您的查询引用字符串中使用`'`而不是 ( ` )

```
Select * FROM niki WHERE user_name = '" + username + "' AND user_password = '" + password + "' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T17:01:19.790

尝试这个：

```
MySqlCommand cmd = new MySqlCommand("Select * FROM niki WHERE user_name = '" + username + "' AND user_password = '" + password + "'"); 
```

如果名称是保留名称，则 ` 将引用表和列名称。例如 tbl.`from` 将引用一个名为“from”的列，而不是 SQL 保留字 FROM。

这就是您收到错误消息的原因，指出列名无效“admin”，因为 MySQL 在命令中查找“admin”时认为您正在引用名为“admin”的列。猜测您在登录表单中输入“admin”作为用户名当然没有奖品！:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T17:02:48.150

使用命名参数而不是您的解决方案：

```
MySqlCommand cmd = new MySqlCommand("Select * FROM niki WHERE user_name = @username AND user_password = @password");
cmd.Parameters.AddWithValue("@username", username);
cmd.Parameters.AddWithValue("@password", password); 
```

UPD：如 UnhandledException 所说，更新为 AddWithValue

# asp.net - jqGrid从c#后面的代码中选择行？

> ID：10623195
> 
> 赞同：1
> 
> 时间：2012-05-16T16:56:51.713
> 
> 标签：asp.net, jqgrid

有没有办法在后面的代码中选择 c# 中的 jqGrid 行？在代码项中，代码项是从代码隐藏过程中从网格中删除的，所以我希望它选择网格中的第一行。我没有看到像 SelectedIndex 这样我可以轻松调用的东西。

如果有人有建议那就太好了。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:45:42.560

我也没有在文档中看到任何内容。由于选择一行是客户端 (JavaScript) 操作而不是面向数据的操作——它跨越客户端和服务器——这似乎不太可能通过 C# 代码隐藏来完成。我认为您至少需要编写一些 JavaScript 代码来完成您正在尝试做的事情。

# c# - 使用信号量进行线程化

> ID：10623199
> 
> 赞同：2
> 
> 时间：2012-05-16T16:57:10.587
> 
> 标签：c#, threadpool

我在线程中使用 Semaphore 时遇到问题.. 这是我的情况，我想在当前 3 个线程中更改**ListViewItem的背景颜色，然后在使用****PauseForMilliSeconds**一段时间后变成另一种颜色，然后在 1 完成后释放另一个线程所以我可以将最大线程执行限制为 3 个线程，但问题是应用程序不会响应。

这是我的代码

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;
using System.Threading;

namespace _Sample__Using_Semaphore
{
public partial class frmMain : Form
{
    Semaphore semaphore = new Semaphore(0, 3);

    public frmMain()
    {
        InitializeComponent();
    }

    private void frmMain_Load(object sender, EventArgs e)
    {
        for (int i = 1; i <= 10; i++)
        {
            ListViewItem lvi = new ListViewItem(new string[] { i.ToString(), "Ready", "0" });
            lvItems.Items.Add(lvi);
        }
    }        

    private void btnStartStop_Click(object sender, EventArgs e)
    {
        semaphore.Release(3);

        for (int i = 0; i < lvItems.Items.Count; i++)
        {
            WorkerThread(i);
        }
    }

    private Thread WorkerThread(int startNum)
    {
        Thread t = new Thread(() => WorkerProcess(startNum));
        t.Start();

        return t;
    }

    private void WorkerProcess(int startNum)
    {
        Invoke((MethodInvoker)delegate()
        {
            ProcessMe(startNum);
        });
    }

    private void ProcessMe(int index)
    {
        Random rand = new Random();

        semaphore.WaitOne();

        lvItems.Items[index].BackColor = Color.Red;

        PauseForMilliSeconds(rand.Next(500, 5000));

        lvItems.Items[index].BackColor = Color.Yellow;

        semaphore.Release(1);
    }

    public DateTime PauseForMilliSeconds(int MilliSecondsToPauseFor)
    {
        DateTime ThisMoment = DateTime.Now;
        TimeSpan duration = new TimeSpan(0, 0, 0, 0, MilliSecondsToPauseFor);
        DateTime AfterWards = ThisMoment.Add(duration);

        while (AfterWards >= ThisMoment)
        {
            System.Windows.Forms.Application.DoEvents();
            ThisMoment = DateTime.Now;
        }

        return DateTime.Now;
    }
}
} 
```

对我的问题有任何帮助或解决方案吗？

**解决方案：**

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;
using System.Threading;

namespace _Sample__Using_Semaphore
{
public partial class frmMain : Form
{
    Semaphore semaphore = new Semaphore(0, 3);

    public frmMain()
    {
        InitializeComponent();
    }

    private void frmMain_Load(object sender, EventArgs e)
    {
        for (int i = 1; i <= 10; i++)
        {               
            ListViewItem lvi = new ListViewItem(new string[] { i.ToString(), "Ready", "0" });
            lvItems.Items.Add(lvi);
        }
    }        

    private void btnStartStop_Click(object sender, EventArgs e)
    {
        semaphore.Release(3);

        foreach (ListViewItem lvi in lvItems.Items)
        {
            WorkerThread(lvi.Index);
        }            
    }

    private Thread WorkerThread(int startNum)
    {
        Thread t = new Thread(() => WorkerProcess(startNum));
        t.Start();

        return t;
    }

    private void WorkerProcess(int startNum)
    {
        ProcessMe(startNum);            
    }

    private void ProcessMe(int index)
    {
        Random rand = new Random();

        semaphore.WaitOne();

        Invoke((MethodInvoker)delegate()
        {
            lvItems.Items[index].BackColor = Color.Red;
        });           

        PauseForMilliSeconds(rand.Next(500, 5000));

        Invoke((MethodInvoker)delegate()
        {
            lvItems.Items[index].BackColor = Color.Yellow;
        });

        semaphore.Release(1);
    }

    public DateTime PauseForMilliSeconds(int MilliSecondsToPauseFor)
    {
        DateTime ThisMoment = DateTime.Now;
        TimeSpan duration = new TimeSpan(0, 0, 0, 0, MilliSecondsToPauseFor);
        DateTime AfterWards = ThisMoment.Add(duration);

        while (AfterWards >= ThisMoment)
        {
            System.Windows.Forms.Application.DoEvents();
            ThisMoment = DateTime.Now;
        }

        return DateTime.Now;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:31:56.533

我认为您的问题来自放错位置的 Invoke。通过这样做，您实际上是在被睡眠调用阻塞的主线程中执行 Process me 代码。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{

    public partial class Form1 : Form
    {
        Semaphore semaphore = new Semaphore(0, 3);
        public Form1()
        {
            InitializeComponent();
            myDelegate = new ChangeBack(ChangeBackMethod); 
        }

         private void frmMain_Load(object sender, EventArgs e)
    {
        for (int i = 1; i <= 10; i++)
        {
            ListViewItem lvi = new ListViewItem(new string[] { i.ToString(), "Ready", "0" });
            lvItems.Items.Add(lvi);
        }
    }        

    private void btnStartStop_Click(object sender, EventArgs e)
    {
        semaphore.Release(3);

        for (int i = 0; i < lvItems.Items.Count; i++)
        {
            WorkerThread(i);
        }
    }

    private Thread WorkerThread(int startNum)
    {
        Thread t = new Thread(new ParameterizedThreadStart(WorkerProcess));
        t.Start(startNum);

        return t;
    }

    private void WorkerProcess(object startNum)
    {

            ProcessMe((int)startNum);

    }

    private void ProcessMe(int index)
    {
        Random rand = new Random();

        semaphore.WaitOne();

        lvItems.BeginInvoke(myDelegate, index, Color.Red);

        Thread.Sleep(rand.Next(500, 5000));

        lvItems.BeginInvoke(myDelegate, index, Color.Yellow);

        semaphore.Release();

    }
    public delegate void  ChangeBack(int index, Color c);
    private ChangeBack myDelegate;
    private void ChangeBackMethod(int index, Color c)
    {

        lvItems.BeginUpdate();
        ((ListViewItem)(lvItems.Items[index])).BackColor = c;
        lvItems.EndUpdate();
    }

    public DateTime PauseForMilliSeconds(int MilliSecondsToPauseFor)
    {
        DateTime ThisMoment = DateTime.Now;
        TimeSpan duration = new TimeSpan(0, 0, 0, 0, MilliSecondsToPauseFor);
        DateTime AfterWards = ThisMoment.Add(duration);

        while (AfterWards >= ThisMoment)
        {
            //System.Windows.Forms.Application.DoEvents();
            ThisMoment = DateTime.Now;
        }

        return DateTime.Now;
    }
    }
} 
```

# html - 如何在其他元素中设置链接样式

> ID：10623203
> 
> 赞同：2
> 
> 时间：2012-05-16T16:57:52.010
> 
> 标签：html, css

我有这个结构

```
<nav>
  <ul id="nav" class="sf-menu sf-navbar sf-js-enabled sf-shadow">
  <li id="level1-home" class="current sfHover sf-breadcrumb">
     <a href="/Admin/Home/Index">
  ... 
```

而且我想在`<a>`不影响站点中任何其他链接的情况下对标签进行样式设置。最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T16:59:01.177

```
nav a { /*affect only links in the navbar */ } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:03:31.143

### 按 ID 定位

在您提供的代码中，您的元素`id`上有一个“导航” 。`ul`这可用于指定您要定位的锚点的容器：

```
#nav a {
  color: orange;
} 
```

这将影响具有“导航”`a`的元素内的所有元素（无论嵌套深度如何） 。`id`

### 按唯一路径定位

检查您的链接的父母的唯一性。落在一个`nav`元素内的链接，在一个元素内`header`可以是这样的样式：

```
header nav a {
  color: red;
} 
```

`nav`包含在 a 中的链接`footer`可以这样处理：

```
footer nav a {
  color: green;
} 
```

### 免责声明

、`header`和标签`footer`都是`nav`HTML5 结构。要广泛支持旧版浏览器，请确保在使用这些标签时包含[HTML5Shiv 。](https://code.google.com/p/html5shiv/)

# gmail - 如何使用 JavaMail 阅读 gmail 中电子邮件的最新线程？

> ID：10623204
> 
> 赞同：2
> 
> 时间：2012-05-16T16:57:54.850
> 
> 标签：gmail, jakarta-mail

为了在我们的应用程序中测试通知，我正在使用 JavaMail 验证这些通知。我测试了带有和不带有附件的通知。对于没有附件的电子邮件，第一个测试运行良好。验证后，我会删除该电子邮件并从应用程序中发送另一个带有附件的通知。现在我面临这个问题。因为我的收件箱有 1 封电子邮件，但有两个线程（第一封没有附件的电子邮件和最新的带有附件的电子邮件都有相同的主题，因此最终在同一封电子邮件中有两个线程）。我的代码会引发错误，因为它需要一封带有附件的电子邮件，但读取的是没有附件的电子邮件。这意味着之前的通知没有被正确删除？我是这样做的：

```
//If all messages are read, mark the latest read message as deleted
if(folder.getUnreadMessageCount() == 0){
    message.setFlag(Flags.Flag.DELETED, true);
}

//If any message is marked deleted, delete that message from folder
if(message.isSet(Flags.Flag.DELETED)){
    folder.expunge();
} 
```

我还添加了以下内容以 100% 确保第一个通知被永久删除：

```
folder.close(true); 
```

我错过了什么吗？或者有没有办法区分电子邮件中的线程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:35:57.687

看起来您正确地删除了消息，但最好打开会话调试并查看协议跟踪以了解实际情况。有关说明，请参阅[JavaMail 常见问题解答](http://www.oracle.com/technetwork/java/javamail/faq/index.html#debug)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T20:16:16.087

试过这个，就像一个魅力。

```
//Get Trash folder to copy messages that are read 
Folder trash = store.getFolder("[Gmail]/Trash");
trash.open(folder.READ_WRITE);

//If all messages are read, delete the latest message 
if(folder.getUnreadMessageCount() == 0)
{
    folder.copyMessages(new Message[] {message}, trash);
} 
```

# jquery - 在 IE8 中离开窗口时的 jQuery 焦点

> ID：10623211
> 
> 赞同：0
> 
> 时间：2012-05-16T16:58:43.943
> 
> 标签：jquery

我试图在离开浏览器时给用户一个模态窗口，然后单击任务栏或其他东西。

以下代码适用于 FF、Chrome、IE9 等，但不适用于 IE8。我在这里想念什么？

```
 $(document).ready(function () {
            $(window).focus(function () {
                $("#dialog-message").dialog("close");
            })
                    .blur(function () {                           
                        var options = {};
                        $("#dialog-message").dialog({
                                modal: true,
                            position: 'center',
                            resizable: false,
                            closeOnEscape: true,
                            open: function (event, ui) {
                                $(".ui-dialog-titlebar-close", ui.dialog).hide();
                            },
                            show: "explode",
                            hide: "explode"
                        });
                    }).trigger('focus');

                }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:01:42.680

它可能很简单，比如在 .blur 之前有空白

# sql - 在 Oracle 中搜索哪个更快

> ID：10623212
> 
> 赞同：2
> 
> 时间：2012-05-16T16:58:59.850
> 
> 标签：sql, performance, oracle, query-optimization

我正在尝试加速数据库应用程序，我目前正在寻找对应用程序影响较小的简单事物。

我想知道什么是搜索字符串是否满足条件的最有效方法。使用第一个选项是否有任何正当理由。

所以说有一个字段调用状态，它只会将值存储为 Discontinued。

*   状态 NOT LIKE 'Disc%'
*   status != '停产'
*   状态 <> '停产'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:02:06.603

没有理由使用`NOT LIKE`. 是否使用不等式运算符`!=`的`<>`形式完全取决于个人喜好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T19:06:17.263

出于讨论的目的，我假设 STATUS 字段可以为空，因此将包含两个值，“Discontinued”或 NULL。如果是这种情况，您上面的任何查询都不会产生预期的结果。`STATUS <> 'Discontinued'`当 NULL 与任何东西比较时，它返回 NULL 而不是 TRUE 或 FALSE，因此当谓词 is或其他时，不会返回 STATUS 为 NULL 的行。为了得到结果，我认为你期望你必须说`STATUS IS NULL`。

分享和享受。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:01:45.170

我会投票给第二个。第一个将强制进行表扫描。

写两个，解释计划，然后看看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T12:18:47.270

包含单个值或空值的列不太可能对您对该表运行的任何查询的性能产生任何影响，尤其是在您搜索*不*等于该值的行时。

因此，无论该列是否被索引，这些选项中的任何一个都将表现得同样好。然而，作为一种意图的表达——无论是对你的开发人员和数据库优化器——最好将其编码为：

```
status is null 
```

# java - Java泛型编译错误

> ID：10623219
> 
> 赞同：0
> 
> 时间：2012-05-16T16:59:25.100
> 
> 标签：java, generics, compiler-errors

我不明白为什么编译器不接受这段代码

```
import javax.swing.event.EventListenerList;

import java.util.EventListener;

public class GenericEventsManager {

   EventListenerList listeners = new EventListenerList();

   public <T extends EventListener> void addListener(T listener) {
      listeners.add(listener.getClass(), listener);
   }
} 
```

我得到的错误是

```
The method add(Class<T>, T) in the type EventListenerList is not applicable for the arguments (Class<capture#1-of ? extends EventListener>, T) 
```

addListener 中的参数是扩展 EventListener 的类型，因此 listener.getClass() 返回`Class<? extends EventListener>`，这正是 EventListenerList.add 方法所期望的

有人可以解释一下吗？我有一种感觉，它与 getClass() 在编译时没有被解决有关，但对我来说仍然没有意义

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:08:56.343

> 没有通配符的通用参数不是变体，因此需要完全相同的类型（不是子类型，不是超类型）。（[来源](http://www.artima.com/weblogs/viewpost.jsp?thread=222021)）

编译器根本不会让你这样做。正如错误信息所暗示的那样，参数上的类型`Class`参数必须与第二个参数的类型**完全相同**，这在上面的代码中是不正确的。

* * *

> 他们怎么可能不一样？

因为返回类型`listener.getClass()`是`Class<? extends EventListener>`，不是`Class<T>`。你可以——但我**不建议这样做**——将返回的值`Class`转换为编译：

```
listeners.add((Class<T>)listener.getClass(), listener); 
```

这样做时您会收到编译器警告：

```
Type safety: Unchecked cast from Class<capture#1-of ? extends EventListener> to Class<T> 
```

因为这**不是（类型）安全的演员表。**

* * *

造成这种情况的根本原因可能（我真的不确定）只是`EventListenerList#add()`. 通常[在这种情况下使用PECS](https://stackoverflow.com/questions/2723397/java-generics-what-is-pecs)；可能有一个`add()`没有通配符的充分理由。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:03:34.407

是的，但是在您的 add 方法中，您指定的是 a `Class<T>`，而不是 a`Class<EventListener>`

# dns - 设置 Solaris 11 名称服务器来管理域

> ID：10623221
> 
> 赞同：0
> 
> 时间：2012-05-16T16:59:46.017
> 
> 标签：dns, solaris, bind

我如何设置我的名称服务器来管理域，然后为其包含一个区域。

我以前从未管理过域，我希望有人能指出正确的方向。

我必须设置文件吗？如果是这样怎么办？：

```
resolv.conf 
```

提前致谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T10:28:07.387

`resolv.conf`用于 DNS 客户端；我的理解是你想设置一个 DNS 服务器，设置文件是`/etc/named.conf`.

有关详细信息，请查看[Solaris 11 DNS 管理文档](http://docs.oracle.com/cd/E23824_01/html/821-1455/dnsref-31.html)：

# parsing - 如何使用 Excel 查看专有的分隔文件

> ID：10623223
> 
> 赞同：0
> 
> 时间：2012-05-16T16:59:50.943
> 
> 标签：parsing, excel, vba

我有逗号分隔格式的文本文件。然而，数据的格式使得 Excel 无法推断如何格式化对用户有意义的数据（即内置的导入向导是不够的）。正因为如此，我想我需要构建一个插件/脚本/宏/等来解析数据，然后在 Excel 中显示它。

当一切都说完了，我的目标是：

1.  打开 Excel
2.  从桌面导入文本文件
3.  解析数据
4.  以对用户有意义的格式在 Excel 中显示数据。

此外，无论我最终制作什么解决方案，我都想将解决方案分发给其他 Excel 用户（即我想我可以给他们发送一个 Excel 插件或者一个 Excel 模板）

我以前从未以编程方式与 Excel 进行过交互——无论是宏、VBA 脚本还是 .NET Office 插件等。所以，我不确定如何实现我的目标。

我不是在问如何以编程方式解析数据，也不是在问数据应该如何显示给用户。我的问题是关于这类问题的“正常”Excel 解决方案是什么——这个问题最好由宏、VBA 脚本或 .NET Office 工具等解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T17:25:12.027

我记得大多数文本文件记录以记录类型开头并且多记录类型文件很常见。只是 Excel 等软件包的局限性使这种做法不常见。

使用导入向导，您是否尝试过接受默认的常规格式，这应该导致 Excel 分别解析每个字段？

如果这不起作用，则单独读取行并使用 VBA 将其解析为字段并不困难。我有一个我很乐意分享的例程。显示数据是否有意义取决于数据的性质。请提供详细信息。

作为过去的示例，一个包可能会将一批发票共享为具有记录类型的文本文件：

```
1  Batch header
2  Invoice header            \
3  Invoice line     Repeats  | Repeats as group
4  Invoice trailer           /
5  Batch trailer 
```

这些记录中的每一个都有自己的规范。

我假设你的文件是这样的。格式化这些数据并不难，因此它看起来像 Excel 工作表一样。如果您提供更多信息，我相信人们会很乐意提出建议。

# java - 递增和显示双精度值时明显不精确

> ID：10623231
> 
> 赞同：-1
> 
> 时间：2012-05-16T17:00:26.720
> 
> 标签：java, double

> **可能的重复：**
> [在java中使用双精度保持精度](https://stackoverflow.com/questions/322749/retain-precision-with-doubles-in-java)
> [将小数位移动到双精度](https://stackoverflow.com/questions/4937402/moving-decimal-places-over-in-a-double)

班级不言自明。如果您执行此代码，则双精度值似乎有些溢出，但并非所有值都发生这种情况，此外，如果您直接打印数字，则输出正常。

```
public class test {
    public static void main(String[] args){

        for (double f=1.36; f<1.40; f+=0.01) System.out.println(f); 
             //Prints 1.36
             //       1.37
             //       1.3800000000000001   ???????
             //       1.3900000000000001   ???????

            System.out.println(1.36); //Prints 1.36
            System.out.println(1.37); //Prints 1.37
            System.out.println(1.38); //Prints 1.38
            System.out.println(1.39); //Prints 1.39
    }
} 
```

有人可以解释一下吗？如果这是一个错误，那么在代码中修复它的最佳方法是什么？有什么神奇的解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:06:56.367

如果您像这样格式化打印输出，您将看不到所有这些小数位：

```
System.out.printf("%.2f",yourVariable); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:18:10.253

尝试

```
for (int i= 136; i <= 140; i++) 
    System.out.println(i / 100.0); 
```

印刷

```
1.36
1.37
1.38
1.39
1.4 
```

当您打印出 double 时，它​​会补偿表示错误，因此您看不到它。当您对浮点值执行多个算术运算时，您可能会增加舍入误差，这变得很明显（需要纠正很多）

# ruby-on-rails - ActiveModel::MassAssignmentSecurity::PostsController#create 中的错误

> ID：10623233
> 
> 赞同：2
> 
> 时间：2012-05-16T17:00:32.230
> 
> 标签：ruby-on-rails, ruby

我几乎完成了[http://guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)上的第 11 步。虽然我的标签有问题，但我在尝试创建新帖子时不断收到此问题。

**ActiveModel::MassAssignmentSecurity::PostsController#create 中的错误**

无法批量分配受保护的属性：tags_attributes Rails.root: /Users/david/blog

应用程序跟踪 | 框架跟踪 | Full Trace app/controllers/posts_controller.rb:46:in `new' app/controllers/posts_controller.rb:46:in`create' 请求

参数：

```
 {"post"=>{"name"=>"David",
    "content"=>"Foobar",
    "title"=>"Programmer",
    "tags_attributes"=>{"0"=>{"name"=>"Tea,
    Cake"}}},
    "utf8"=>"✓",
    "commit"=>"Create Post",
    "authenticity_token"=>"MhvAkAPcAey1Z4YXy7nKFmW/wETlu+USSvWOEBBN4po="} 
```

我一遍又一遍地检查了包含标签实现的每一行代码，但我无法弄清楚。关于我应该寻找什么的一些指导？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:03:29.143

在您的模型中，您需要添加`tag_attributes`到`attr_accessible`调用中。

例如 ：

```
class User < ActiveRecord::Base
  attr_accessible :tags_attributes
end 
```

如果您已经调用过一次，则可以将此字段添加为方法的参数，或者进行第二次调用。这两个选项是等效的。

直到几个月后，必须指定所有可访问的参数才成为默认设置。
本指南已更新以反映默认值的更改。但是新版本还没有部署，所以没有具体说明。

请参阅[安全性：批量分配](http://guides.rubyonrails.org/security.html#countermeasures)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T12:48:07.970

您可以试试这个，
在您的 PostsController 模型中添加表单中使用的所有属性，例如，

```
 class PostsController < ActiveRecord::Base
   attr_accessible :name, :content, :title
   ...
   ...
 end 
```

这个对我有用。

# java - 无法填充 ArrayList

> ID：10623235
> 
> 赞同：-1
> 
> 时间：2012-05-16T17:00:33.943
> 
> 标签：java, arraylist

我无法理解为什么我的代码表现得如此。我所做的是创建一个自定义类的 ArrayList。填充类对象，然后将其添加到 ArrayList。然后我重用类对象并用新值填充它并将其添加到 ArrayList 除了第一个被第二个覆盖？是否有某种内部指针或尚未提交的数组列表可能导致这种情况？

在这里我声明我的 ArrayList

```
private ArrayList<LiftData> arrylst_LiftData = new ArrayList<LiftData>(); 
```

然后我创建我的自定义数据对象（只是一个具有一些属性的类）

```
LiftData obj_LData = new LiftData(); 
```

一些未显示的代码用有效数据填充它，我将它添加到 ArrayList

```
arrylst_LiftData.add(obj_LData); 
```

现在，代码通过循环使用新值填充 obj_LData，然后它被添加到 arraylist 但第一个消失了？？？

如果我添加 ArrayList 下显示的第二行，则添加一切正常？？？

```
arrylst_LiftData.add(obj_LData);
obj_LData = new LiftData(); 
```

有人可以告诉我发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:04:59.200

您只是在 ArrayList 中添加对对象的引用。您稍后会修改该对象，因此数组列表中的那个当然会被修改（它是同一个对象）。

使用 obj_LData = new LiftData(); 您正在创建一个与 ArrayList 中的不同的新对象，这就是它起作用的原因。

```
LiftData obj_LData = new LiftData();
LiftData obj_LData2 = obj_LData; 
```

这里，obj_LData 和 obj_LData2 指向同一个对象。如果您更改其中一个的属性，另一个也将被更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T17:05:26.070

与`ArrayList`所有 Java 集合一样——实际上，Java 中的所有变量——都包含对对象的引用，而不是对象本身。听起来您只创建了一个`LiftData`对象，并且正在填充`ArrayList`对它的多个引用。每次更改其数据时，其中的每个对象`ArrayList`都会发生变化——因为它们都是同一个对象。

这与您在 C++ 中使用基本相同的语法所得到的结果形成鲜明对比。插入 a`vector`将创建对象的副本，您确实可以修改对象，重新添加它，并在`vector`. 但是 Java 不是这样工作的：所有对象类型的变量本质上都是指针。

`LiftData`在填充列表的循环中，您每次都需要创建一个新对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T17:07:59.083

我认为发生的事情如下：因为您没有“新建”自定义对象，所以您正在更改的变量（对于 ArrayList 的第二个元素）实际上是数组列表中的第一个元素，因为它指向内存中的相同位置（通过引用）。

当你“新建”它时，你会在内存中创建一个新空间，并给它一个新指针。因此，您添加的第一个元素现在指向与您为第二个元素编辑的位置不同的位置。

重用变量很好，但在更改和添加之前需要更新，因为否则指针将相同。

```
LiftData toAdd;
ArrayList<LiftData> list = new ArrayList<LiftData>();
for (int i=0;i<5;i++) {
   //Without this line here, the pointers to all the elements of the array list will the same.
   //This means that they will have the same values too
   toAdd = new LiftData();
   //init lift data values
   list.add(toAdd);
} 
```

# mysql - MySQL在另一个表中选择具有多行的行

> ID：10623237
> 
> 赞同：0
> 
> 时间：2012-05-16T17:00:36.707
> 
> 标签：mysql

我有这两张表：

画廊 -`{id,title,description}`
图片 -`{id,gallery_id,file}`

每个画廊在图像表中有多个图像。

如何最好地解决这个问题：

**A.**选择所有画廊而不是运行一个 for 循环，并为每个画廊重新查询与它相关的每个图像的数据库。

```
 $sql='select * from galeries';
$result=mysql_query($sql);
while($row=mysql_fetch_assoc($result))
{
    $sql2='select * from images where gallery_id='.$row['id'];
    //etc
} 
```

**B.**使用左连接选择所有画廊和图像，从而多次获得画廊信息，与画廊拥有图像的次数一样多。

```
$sql='select * from galleries left join images on galleries.id=images.gallery_id';`
```

或者，还有更好的方法？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:27:57.913

(A) 是一种简单的方法，但需要对数据库进行多次查询。如果您的数据库服务器很忙，因此会更忙。

(B) 是工程师的出路，使用较少的数据库调用，通常是最有效的数据库调用。但是，这将要求您使用我们在大学中学到的分组休息逻辑。

当我编码时，我采用 (B) 方式。当我周围的人编码时，他们大多 (99%+) 以 (A) 方式编码！当我告诉这些人我使用 (B) 的理由时，他们说如果需要，他们的客户有钱购买更好的硬件！

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:57:50.057

我认为 B 是最好的选择，因为在 A 中，您需要为每个查询获取到数据库的连接，然后多次向数据库发送几乎相同的查询（仅在 where 子句中使用不同的 id），并获取并处理结果再次出现，因此您有不必要的流程和数据传输开销。
许多程序员不使用连接语句，因为他们认为这会使他们的查询过于繁重！但除非您的连接表有大量的行，否则我认为像 B 这样的简单连接不会导致任何问题。只需注意使用连接以避免选择未使用的行或列。
因此，我可以保证 B 是您的最佳解决方案！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T21:38:54.243

我不喜欢A，因为重复。我不喜欢 B，因为您运行的每个查询都有开销。

如果我从两个表中存储数据。我会在一个查询中获取画廊并将它们存储在一个数组中。然后我会在循环中获取最少数量的画廊所需的图像，可能会缓存它们以避免再次出现，但这取决于许多考虑因素

再说一次，如果它不是一个大容量，我可能会耸耸肩并使用 A 或 B 中的任何一个使我的代码更具可读性。它们都以自己的方式效率低下，但工作会增加设计的复杂性。值得吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-23T13:29:44.833

```
# you want to get latest 10 galleries, I assume
$query = 'SELECT * FROM `galleries` ORDER BY `id` DESC LIMIT 10';
$result = mysql_query($query);

while($row = mysql_fetch_object($result)) {
    $ids = isset($ids) ? ', '.$row->id : $row->id;
}

# you really don't want to get all the images
# limit amount to some number, ex: 200
$query = 'SELECT * FROM `images` WHERE `gallery_id` IN('.$ids.') ORDER BY `id` DESC LIMIT 200';
... 
```

# ios - NSXML 解析图像

> ID：10623240
> 
> 赞同：0
> 
> 时间：2012-05-16T17:00:48.110
> 
> 标签：ios, xml-parsing, nsxml

有人可以帮我从这段代码中获取 href 属性吗？通过使用 NXMLParser .. 谢谢

```
"<content:encoded><![CDATA[<p><a class="lightbox"  title ="1" href="http://www.enlacejudio.com/wp-content/uploads/2012/05/12.jpg"><img src="http://www.enlacejudio.com/wp-content/uploads/2012/05/12.jpg" alt="" title="1" width="448" height="188" class="aligncenter size-full wp-image-59393" /></a></p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:04:40.250

将其视为字符串，您可以使用 -

```
NSString *urlString = nil;
NSString *htmlString = //Your string;

NSScanner *scanner = [NSScanner scannerWithString:htmlString];

[scanner scanUpToString:@"href=" intoString:nil];
if (![scanner isAtEnd]) {
    [scanner scanUpToString:@"http" intoString:nil];
    NSCharacterSet *charset = [NSCharacterSet characterSetWithCharactersInString:@">"];
    [scanner scanUpToCharactersFromSet:charset intoString:&urlString];
} 
```

编辑 -

```
-(id) loadXMLByURL:(NSString *)urlString { 
    noticias = [[NSMutableArray alloc] init];
    NSURL *url = [NSURL URLWithString:urlString];
    NSData *data = [[NSData alloc] initWithContentsOfURL:url];

    NSStringEncoding encoding;
    NSString *xmlString = [NSString stringWithContentsOfURL:url usedEncoding:&encoding error:&error];
    parser = [[NSXMLParser alloc] initWithData:[xmlString dataUsingEncoding:encoding allowLossyConversion:YES]];
    parser.delegate = self; 
    [parser parse]; 
    return self;
} 
```

# php - 自定义平面链接的 mod_rewrite apache 卡住了

> ID：10623241
> 
> 赞同：4
> 
> 时间：2012-05-16T17:00:48.407
> 
> 标签：php, mod-rewrite, relative-path

我想为我的网站创建平面链接。`.htaccess`代码如下：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^([0-9A-Za-z]+)?$ /index.php?page=$1 [L]
    RewriteRule ^([0-9A-Za-z]+)/?$ /index.php?page=$1 [L]
</IfModule>` 
```

现在我的网站正在运行，可以看到`print_r($_GET)`并获得所有价值。

我的网站有这样的代码：`<img src="images/icons/image.png" />`，图像位于路径：`/images/icons/up.png`。

现在我可以访问我的网站：`http://somedomain.com/home`一切正常。但是当我放: 时`http://somedomain.com/home/`，它会卡住。

图像为浏览器获取这样的路径：`http://somedomain.com/home/images/icons/image.png`这是不可用的，它应该是：`http://somedomain.com/images/icons/image.png`。

如何解决这个问题？

如果通过修改**.htaccess**有任何解决方案会很有帮助，因为我想对所有链接使用相对路径而不是完整路径。

* * *

感谢本·克利福德的帮助。据他说，如果我将第二条规则重定向到第一个规则而不是 index.php 的格式。然后它应该工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:06:25.493

您可以更改第二个重写规则以将用户重定向到路径的非/版本，而不是 index.php；然后，当加载该重定向页面时，它将使用正确的基本路径命中第一条规则。

问题是图像名称替换了 URL 中最后一个 / 之后的所有内容：当您说 somedomain.com/home 时，图像文件名将附加到 somedomain.com/ 但在第二种情况下，最后一个 /*在*home 之后。我认为，使用重写规则来修剪这个/关闭会解决这个问题。

# c# - 从模型中获取一定的十进制长度

> ID：10623242
> 
> 赞同：1
> 
> 时间：2012-05-16T17:00:53.040
> 
> 标签：c#, model

我正在创建一个模型，我希望所有的十进制值最终都是 2 位小数（货币）。这是我的想法，但显然行不通。

```
public class Fees
{
    public decimal permitFee { set; get { return Math.Round(permitFee, 2); } }
    public decimal planReviewFee { set; get { return Math.Round(planReviewFee, 2); } }
    public decimal surchargeFee { set; get { return Math.Round(surchargeFee, 2); } }
    public decimal totalFee { get { return permitFee + planReviewFee + surchargeFee; } }
} 
```

我应该如何设置我的对象以便获得正确的输出值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T17:09:25.313

我不相信你可以使用这样的属性（返回自身）。尝试对属性使用基础变量，看看是否能解决您的问题。

[C# set/get 中的堆栈溢出错误](https://stackoverflow.com/questions/2398219/stack-overflow-error-in-c-sharp-set-get)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:17:34.713

请参阅我上面的评论并考虑将值存储为整数

```
public class Fees {  

private int permit;  
private int planReview;  
private int surcharge;  
public decimal permitFee { set { permit = (int) (value * 100); }; 
                           get { return permit / 100; } }  
public decimal planReviewFee { set { planReview = (int) (value * 100); } 
                               get { return planReview / 100; } }
public decimal surchargeFee { set { surcharge = (int) (value * 100); } 
                              get { return surcharge / 100; } }
public decimal totalFee { get { return permitFee + planReviewFee + surchargeFee; } }  }  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:18:04.360

这是我最终接受@tom_yes_tom 的建议的结果。

```
public class Fees
{
    private decimal permit;
    private decimal planReview;
    private decimal surcharge;

    public decimal permitFee
    {
        set { permit = Math.Round(value, 2); }
        get { return permit; }
    }
    public decimal planReviewFee 
    {
        set { planReview = Math.Round(value, 2); }
        get { return planReview; } 
    }
    public decimal surchargeFee 
    {
        set { surcharge = Math.Round(value, 2); }
        get { return surcharge; } 
    }
    public decimal totalFee 
    { 
        get { return permitFee + planReviewFee + surchargeFee; } 
    }
} 
```

# c# - 将 Windows 控件添加到 Excel 2007 工作表时出现 SerializationException

> ID：10623251
> 
> 赞同：0
> 
> 时间：2012-05-16T17:01:30.973
> 
> 标签：c#, user-controls, excel-2007, appdomain, excel-interop

将控件直接添加到工作表时，我不断收到异常。代码放置在表单内，而不是功能区的一部分。

这是我的代码：

```
// using TExcel = Microsoft.Office.Tools.Excel;
// MyGlobalsWrapper references the Globals object, which has been passed across an
// AppDomain barrier

Excel.Worksheet activeWorksheet = MyGlobalsWrapper.Application.ActiveSheet;
TExcel.Worksheet toolsSheet = MyGlobalsWrapper.Factory.GetVstoObject(activeWorksheet);
var range = activeWorksheet.Range["A1:F20"];

var button = new System.Windows.Forms.Button();
button.Text = "HELLO!";
button.Visible = true;

// Both of these fail with the same exception

// Add manually (as the Range object might be the problem
toolsSheet.Controls.AddControl(button,10,10,button.Width,button.Height,id);

// Add using a range (which is more ideal for my usage)
toolsSheet.Controls.AddControl(button,range ,id); 
```

例外情况如下：

```
System.Runtime.Serialization.SerializationException occurred
  Message=Type 'Microsoft.Office.Tools.Excel.ControlCollectionImpl' in Assembly 'Microsoft.Office.Tools.Excel.Implementation, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a' is not marked as serializable.
  Source=mscorlib
  StackTrace:
    Server stack trace: 
       at System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type)
       at System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context)
       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo()
       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter, SerializationBinder binder)
       at System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter, SerializationBinder binder)
       at System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck)
       at System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck)
       at System.Runtime.Remoting.Channels.CrossAppDomainSerializer.SerializeMessageParts(ArrayList argsToSerialize)
       at System.Runtime.Remoting.Messaging.SmuggledMethodReturnMessage..ctor(IMethodReturnMessage mrm)
       at System.Runtime.Remoting.Messaging.SmuggledMethodReturnMessage.SmuggleIfPossible(IMessage msg)
       at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoDispatch(Byte[] reqStmBuff, SmuggledMethodCallMessage smuggledMcm, SmuggledMethodReturnMessage& smuggledMrm)
       at System.Runtime.Remoting.Channels.CrossAppDomainSink.DoTransitionDispatchCallback(Object[] args)
    Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at Microsoft.Office.Tools.Excel.Worksheet.get_Controls() 
```

我的参考资料如下：

Microsoft.Office.Interop.Excel
   v12 - CLR：v1.1.4322

Microsoft.Office.Interop.Excel.Extensions
   v12 - CLR：2.0.50727

Microsoft.Office.Tools
Microsoft.Office.Tools.Common
Microsoft.Office.Tools.Common。 v4.0.Utilities
Microsoft.Office.Tools.Excel
Microsoft.Office.Tools.Excel.v4.0.Utilities
   v10 - CLR：4.0.30919

我曾尝试将其包装在 中`System.Windows.Forms.UserControl`，但我有同样的问题。

**注意：**我想使用 Windows 控件，因为我打算在工作表中嵌入一个用户控件，而不仅仅是一个按钮。我从一个简单的控制开始，然后开始工作。所以我需要一个使用 Windows 窗体控件（最好是 UserControl）而不是 Excel 框架提供的任何控件的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T09:44:43.787

您是否在单独的 AppDomain 中运行此代码？

如果您是，那么 ControlsCollection 将需要跨 AppDomain 屏障进行编组。与大多数编组一样，这将通过序列化来实现。

是否可以在主 Excel AppDomain 中运行此代码？

# c# - 上传文件 HTTP Post

> ID：10623257
> 
> 赞同：0
> 
> 时间：2012-05-16T17:02:04.897
> 
> 标签：c#, asp.net, post, file-upload

我正在使用带有文件输入的表单，以将目标作为 iframe POST 到不同的页面。我正在用 C# ASP.NET 进行编码。我的文件发布得很好，但不知道如何在服务器端处理它。我使用什么代码来获取 POST 数据并将其保存为服务器上的文件？之后，我可以使用 System.IO 对其进行操作和删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:14:29.243

在 iframe 的回发中，枚举`Request.Files`并调用`Request.Files[index].SaveAs(string filename)`以将其写入磁盘中您选择的位置。

# c# - 如何在 Entity Framework 4.3 中禁用模型兼容性检查？

> ID：10623260
> 
> 赞同：40
> 
> 时间：2012-05-16T17:02:17.633
> 
> 标签：c#, .net, entity-framework, entity-framework-4.3

我正在使用 EF 4.3 并且有一个需要与另一个库使用 EF Code First 4.3 生成的数据库对话的上下文。上下文抛出异常说明

> 自创建数据库以来，支持“上下文”上下文的模型已更改。考虑使用 Code First 迁移来更新数据库

在 EF 4.1 中，这可以通过`IncludeMetadataConvention`从模型构建器中删除来禁用。但是，在 4.3 中，此约定已被弃用，不再有效。

如何让 EF 4.3 上下文与*由不同上下文构建*的 EF 4.3 生成的数据库对话？我发现的唯一选择（远非理想）是删除元数据表，从而导致*两个*上下文都假定数据库不是由 EF 构建的。

**PS：**我知道这种情况可能会引发我*为什么*需要这样做的问题；我知道这远非理想，但请放心，这是我需要解决的问题，并且横向处理的选择有限。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-05-16T18:06:56.090

将初始化程序设置为`null`将跳过模型兼容性检查。

```
Database.SetInitializer<MyContext>(null); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-06T12:28:31.233

对于 EF 4.3 或更高版本

```
Database.SetInitializer<MLTServerWatcherContext>(null); 
```

或者如果使用旧版本的 EF

```
modelBuilder.Conventions.Remove<IncludeMetadataConvention>(); 
```

（我知道他说他使用的是 EF 4.3，但我认为显示这个选项也很好）

# git - 使用 Xcode 版本编辑器查看分支中的更改？

> ID：10623261
> 
> 赞同：2
> 
> 时间：2012-05-16T17:02:24.483
> 
> 标签：git, version-control, xcode4.3

我启动了一个启用 Git 的项目来试用该功能，在“主”主干中，我添加了两个名为`feature_ONE`并`feature_TWO`提交更改的方法。然后我去了组织者并在主干中添加了一个名为**feature_THREE_Branch**的分支。然后我切换到这个分支并`feature_THREE`在再次提交更改之前实施。

在下图中，我已切换回“主”主干，并尝试根据 feature_THREE_branch 查看当前主干，以便查看**进行**了**哪些**更改。我的问题是，无论我在版本编辑器中做什么，我似乎都看不到 feature_THREE。它是否应该不显示在 feature_TWO 下的右侧（如果您切换到**feature_THREE_Branch**，那就是它的位置，我错过了什么？

![在此处输入图像描述](../Images/134071f0c9107f76017b710b431532f7.png)

Xcode 版本 4.3.2 (4E2002)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T14:57:51.483

我转载了你的问题；这肯定令人困惑，但我能够看到差异。我的观察：

*   单击底部的分支+修订信息时，确实显示了分支，但修订被弄乱了。例如，在“master”分支下，提交将显示来自“feature_THREE_Branch”的内容。然后，当您从“feature_THREE_Branch”中选择提交时，它不会显示。
*   如上所示，当左侧具有“master”而右侧具有“feature_THREE_Branch”时，您**无法选择**提交（来自 feature_THREE_Branch）并显示它。
*   中间的黑色“local, base, ...”列显示来自左侧选定分支的提交。如果您想查看您的差异，您需要首先选择左侧（底部）的“feature_THREE_Branch”，然后在黑色列的右侧“滚动”回到“主”分支的提交。
*   使文件内容始终显示的唯一方法是单击中心黑色条的左侧或右侧。

【上面不是很清楚……很难描述这个UI……】

# nhibernate - Session.Query 返回空列表 (nHibernate)

> ID：10623262
> 
> 赞同：0
> 
> 时间：2012-05-16T17:02:25.310
> 
> 标签：nhibernate, session, fluent-nhibernate

我是 Fluent 和 Nhibernate 的新手，所以也许有一个我在这里没有看到的简单问题。以下是我的映射

```
public class DriverStatusChangeMapping : ClassMap<DriverStatusChange>
{
    public DriverStatusChangeMapping()
    {
        Id(x => x.Id).GeneratedBy.GuidComb();
        Map(x => x.CreateReceivedAt);
        Map(x => x.RemoveReceivedAt);
        Map(x => x.Status);
        Component<AuditAction>(x => x.Created, m =>
        {
            m.Map(x => x.ActionByUser).Column("CreatedByUser");
            m.Map(x => x.ActionByUserType).Column("CreatedByUserType");
            m.Map(x => x.ActionOccurredAt).Column("CreatedAt");
        });
        Component<AuditAction>(x => x.Removed, m =>
        {
            m.Map(x => x.ActionByUser).Column("RemovedByUser");
            m.Map(x => x.ActionByUserType).Column("RemovedByUserType");
            m.Map(x => x.ActionOccurredAt).Column("RemovedAt");
        });

        References(c => c.DriverLogEntry)
            .Column("DriverLogEntryID")
            .Access.Property()
            .Cascade.All();

        Table("tblDriverStatusChange");

    }
} 
```

我正在使用内存测试来验证存储库返回正确的数据。我的 RespositoryTestBase 如下。

```
public class RepositoryTestBase : IDisposable
{
    private static NHConfiguration.Configuration _configuration;
    private static ISessionFactory _sessionFactory;

    protected ISession Session { get; set; }

    public RepositoryTestBase()
    {
        _sessionFactory = CreateSessionFactory();
        Session = _sessionFactory.OpenSession();
        BuildSchema(Session);
    }

    private static ISessionFactory CreateSessionFactory()
    {
        return Fluently.Configure()
          .Database(SQLiteConfiguration.Standard.InMemory().ShowSql())
          .Mappings(m => m.FluentMappings.AddFromAssemblyOf<Driver>())
          .ExposeConfiguration(cfg => _configuration = cfg)
          .BuildSessionFactory();

    }

    public void BuildSchema(ISession session)
    {
        var export = new SchemaExport(_configuration);
        export.Execute(true, true, false, Session.Connection, null);
    }

    public void Dispose()
    {
        Session.Dispose();
    }
} 
```

现在，当我在会话中执行 get 时......我有 DriverStatusChange 记录

```
_session.Get<DriverStatusChange>(new Guid("6c9b5d4d-986d-4ff7-86ae-a05300d34a8b")); 
```

但是如下的简单查询总是返回一个空列表。

```
_session.Query<DriverStatusChange>().Select(d => d).ToList(); 
```

以下是我使用 RepositoryTestBase 的测试类

```
public class DriverStatusChangeRepositoryTests:RepositoryTestBase
{
    private IDriverStatusChangeRepository _driverStatusChangeRepository;

    [SetUp]
    public void Init()
    {

        var mockLogger = new Mock<ILogger>();
        _driverStatusChangeRepository = new DriverStatusChangeRepository(Session, mockLogger.Object);

    }

    [TearDown]
    public void TearDown()
    {
        Session.Clear();
    }

    [TestFixtureTearDown]
    public void TestFixtureTearDown()
    {
        Dispose();
    }

    [Test]
    public void get_where_removed_at_is_null()
    {
      var driverStatusChanges = CreateDriverStatusChanges(4);
               var removedDriverStatusChange = driverStatusChanges[1];
                removedDriverStatusChange.Removed = new AuditAction()
                                                {
                                                    ActionByUser = "John Doe",
                                                    ActionByUserType = "User Type",
                                                    ActionOccurredAt = DateTime.UtcNow
                                                };
                removedDriverStatusChange.RemoveReceivedAt = DateTime.UtcNow;
                _driverStatusChangeRepository.Update(removedDriverStatusChange);

                var actual = _driverStatusChangeRepository.GetCurrent(10001, DateTime.MinValue, DateTime.UtcNow).Count;
                Assert.AreEqual(3,actual, "Get current did not match");

    }

    private List<DriverStatusChange> CreateDriverStatusChanges(int number)
    {

        var driverStatusChanges = new List<DriverStatusChange>();
        for (int i = 0; i < number; i++)
        {
            var driverStatusChange = new DriverStatusChange()
            {
                Created = GetCreated(i),
                CreateReceivedAt = DateTime.UtcNow,
                DriverLogEntry = new DriverLogEntry() {CreateReceivedAt = DateTime.UtcNow, Id = Guid.NewGuid(), Driver = new Driver() { DriverID = i+10000}},
                Removed = null,
                RemoveReceivedAt = null
            };
            _driverStatusChangeRepository.Add(driverStatusChange);
            driverStatusChanges.Add(driverStatusChange);

        }
        return driverStatusChanges;
    }

    private AuditAction GetCreated(int number)
    {
        return
            new AuditAction()
                {
                    ActionByUser = "Jane Doe" + number.ToString(CultureInfo.InvariantCulture),
                    ActionByUserType = "User Type",
                    ActionOccurredAt = DateTime.UtcNow
                };

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:17:26.387

尝试

```
_session.Query<DriverStatusChange>().ToList(); 
```

_session.Query 返回一个 IQueryable，您可以直接在其上调用“ToList()”。

**编辑：（**请忽略我上面的愚蠢）。

是因为您的会话在您获得记录之前就关闭并重新打开了吗？我很确定如果会话关闭，SQLite InMemory 就会下降。它将在下一次读取时重新创建，并且此时将为空。

一种解决方案是使用数据库连接提供程序来防止连接被关闭，这也将防止 InMemory 数据库丢失：

```
public class DatabaseConnectionProviderThatCachesTheConnection : DriverConnectionProvider
{
    static IDbConnection _databaseConnection;

    public override void CloseConnection(IDbConnection conn)
    {
        // Deliberately override to do nothing.
    }

    public override IDbConnection GetConnection()
    {
        if (_databaseConnection == null)
        {
            _databaseConnection = base.GetConnection();
        }

        return _databaseConnection;
    }
} 
```

然后你可以在你的会话工厂中使用它：

```
 private static ISessionFactory CreateSessionFactory()
{
    return Fluently.Configure()
      .Database(SQLiteConfiguration
          .Standard
          .InMemory()
          .Raw(Environment.ConnectionProvider, 
               typeof(DatabaseConnectionProviderThatCachesTheConnection)
               .AssemblyQualifiedName)
          .ShowSql())
      .Mappings(m => m.FluentMappings.AddFromAssemblyOf<Driver>())
      .ExposeConfiguration(cfg => _configuration = cfg)
      .BuildSessionFactory();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T19:07:26.987

我没有看到任何交易或`Session.Flush`，所以我相信这就是您没有返回任何结果的原因，因为您的更改未提交。在`CreateDriverStatusChanges`, 之后

```
_driverStatusChangeRepository.Add(driverStatusChange); 
```

添加

`Session.Flush()`

# sql - 根据列值对行进行排名/计数

> ID：10623263
> 
> 赞同：3
> 
> 时间：2012-05-16T17:02:39.020
> 
> 标签：sql, oracle, analytic-functions

我有一些在这个 sqlfiddle 中描述的格式的数据：[http ://sqlfiddle.com/#!4/b9cdf/2](http://sqlfiddle.com/#!4/b9cdf/2)

基本上，一个带有用户 ID 和事件发生时间的表。我想做的是根据用户发生的时间来计算事件。所以，一个看起来像这样的表：

```
UID    Timestamp
-----------------
01     01-APR-12
01     01-APR-12     
02     02-APR-12     
03     05-APR-12     
01     10-APR-12     
02     11-APR-12     
03     15-APR-12     
01     20-APR-12 
```

我希望它根据事件发生的顺序为事件分配一个数字等级。因此，这意味着上表将变为：

```
UID    Timestamp     Rank
--------------------------
01     01-APR-12     1
02     02-APR-12     1
03     05-APR-12     1
01     10-APR-12     2
02     11-APR-12     2
03     15-APR-12     2
01     20-APR-12     3 
```

有没有办法在 Oracle SQL 中做到这一点？还是我必须将它吐出到脚本语言并从那里获取？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:06:47.710

看起来你想要分析功能`rank`

```
SELECT uid, timestamp, rank() over (partition by uid order by timestamp) rnk
  FROM your_table 
```

如果可以存在关联（两行具有相同的`UID`和`Timestamp`），则根据您想要处理关联的方式，您可能需要`dense_rank`or`row_number`分析函数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-09T01:24:20.227

以防万一其他人遇到这种情况，在 MSSQL 中也可以使用 RANK、DENSE_RANK、ROW_NUMBER。

# objective-c - 如何检测当前位置是否在具有 CoreLocation 的区域内

> ID：10623265
> 
> 赞同：3
> 
> 时间：2012-05-16T17:02:41.233
> 
> 标签：objective-c, geolocation, core-location, region

我希望我的应用程序知道用户是否在特定区域内。我一直在学习地理围栏，但我不希望设备不断检查它是否进入或离开一个区域，我只想知道它是否在那个具体时刻就在上面。另外，我读到地理围栏的精度（似乎）很低，而且我需要的不仅仅是蜂窝塔的精度。
所以想法是使用“标准”类型的位置来执行此操作，但我不知道如何在给定新的当前位置的情况下检查它是否在（圆形、矩形、多边形？）区域内。
它可能必须使用纯数学来完成，检查高度是否在 2 个参数之间，以及经度？有没有更简单的方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:06:48.643

使用 CLLocations 的 distanceFromLocation

[http://developer.apple.com/library/ios/#DOCUMENTATION/CoreLocation/Reference/CLLocation_Class/CLLocation/CLLocation.html](http://developer.apple.com/library/ios/#DOCUMENTATION/CoreLocation/Reference/CLLocation_Class/CLLocation/CLLocation.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-28T09:19:34.853

这是我的乔丹曲线定理的 Swift 代码。`CLLocationCoordinate2D`只需提供一个可以制作正方形、多边形等任何东西的数组。

更深入的答案我翻译自： [如何确定 2D 点是否在多边形内？](https://stackoverflow.com/questions/217578/how-can-i-determine-whether-a-2d-point-is-within-a-polygon/2922778#2922778)

原始网站：[PNPOLY - 多边形测试中的点包含 W. Randolph Franklin (WRF)](https://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html)

```
extension CLLocationCoordinate2D {

    func liesInsideRegion(region:[CLLocationCoordinate2D]) -> Bool {

        var liesInside = false
        var i = 0
        var j = region.count-1

        while i < region.count {

            guard let iCoordinate = region[safe:i] else {break}
            guard let jCoordinate = region[safe:j] else {break}

            if (iCoordinate.latitude > self.latitude) != (jCoordinate.latitude > self.latitude) {
                if self.longitude < (iCoordinate.longitude - jCoordinate.longitude) * (self.latitude - iCoordinate.latitude) / (jCoordinate.latitude-iCoordinate.latitude) + iCoordinate.longitude {
                    liesInside = !liesInside
                    }
            }

            i += 1
            j = i+1
        }

        return liesInside
    }

} 
```

*编辑*

安全数组项

```
extension MutableCollection {
    subscript (safe index: Index) -> Iterator.Element? {
        get {
            guard startIndex <= index && index < endIndex else { return nil }
            return self[index]
        }
        set(newValue) {
            guard startIndex <= index && index < endIndex else { print("Index out of range."); return }
            guard let newValue = newValue else { print("Cannot remove out of bounds items"); return }
            self[index] = newValue
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-18T00:30:07.897

如果您使用 Google Map SDK 并想检查一个点是否在多边形内，您可以尝试使用`GMSGeometryContainsLocation`. 如果多边形不是凸的，@Magoo 的答案效果很好。但是如果它是凹的，那么@Magoo 的方法就没有帮助。

```
if GMSGeometryContainsLocation(point, polygon, true) {
    print("Inside this polygon.")
} else {
    print("outside this polygon")
} 
```

这是参考：[https ://developers.google.com/maps/documentation/ios-sdk/reference/group___geometry_utils#gaba958d3776d49213404af249419d0ffd](https://developers.google.com/maps/documentation/ios-sdk/reference/group___geometry_utils#gaba958d3776d49213404af249419d0ffd)

# iphone - 如何以结构方式阅读PLIST

> ID：10623270
> 
> 赞同：0
> 
> 时间：2012-05-16T17:03:13.450
> 
> 标签：iphone, objective-c, cocos2d-iphone

这就是我构建我的 PLIST 的方式。

```
<dict>
<key>level1</key>
<dict>
<key>formation</key>
<dict>
    <key>height</key>
    <integer>34</integer>
    <key>width</key>
    <integer>12</integer>

</dict>
</dict>
</dict> 
```

水平>形成>数据

这是我使用的示例代码，但它没有工作。

```
//init loading from PLIST here, and then associate value.
NSString *pathString=[NSString stringWithFormat:@"%@Levels",targetWorld];
NSString *path = [[NSBundle mainBundle] pathForResource:pathString ofType:@"plist"];
NSString *levelNameNumber = [[NSString alloc] initWithFormat:targetLevel];

NSDictionary *levelsList = [[NSDictionary alloc] initWithContentsOfFile:path];
NSDictionary *level = [levelsList objectForKey:levelNameNumber];

NSEnumerator *levelFormations = [level objectEnumerator];

for( NSDictionary *worldSize in levelFormations )
{
    worldWidth = [[worldSize objectForKey:@"width"] intValue];
    worldHeight = [[worldSize objectForKey:@"height"] intValue];

    NSLog(@"height is %d",worldHeight);
    NSLog(@"width is %d",worldWidth);

}

[levelNameNumber release];
[levelsList release]; 
```

这段代码的问题是它运行了第二个 for 循环并将高度和宽度都返回为零。

任何想法？或者我该如何以正确的方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T07:57:48.177

由于您使用的是levelsList 中的对象，并且最后要释放levelsList，因此您从字典中获得的级别对象也将被释放。你要么不需要发布levelsList，保留level，要么最好开始使用ARC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:36:06.513

使用 plutil 检查您的 plist 并确保它具有有效的语法。

更多详细信息：[http ://www.askdavetaylor.com/can_i_check_my_plist_files_in_mac_os_x_for_problems.html](http://www.askdavetaylor.com/can_i_check_my_plist_files_in_mac_os_x_for_problems.html)

# c++ - 用于 C++ 开发的 VS2008 SP1 热修复：在哪里可以找到完整列表？

> ID：10623277
> 
> 赞同：0
> 
> 时间：2012-05-16T17:03:33.250
> 
> 标签：c++, visual-studio-2008

我仍在使用 VS2008 SP1 进行 C++ 开发，主要是因为 IDE 比 VS2010 SP1 快。

我想要一份针对 VS2008 的 SP1 后修补程序的完整列表，重点是 C++ 开发。

我在这篇博文中找到了其中一些：**[VC2005-SP1 / VC2008 RTM / VC2008-SP1 的可用修补程序](http://blog.kalmbach-software.de/2008/04/30/available-hotfixes-for-vc2005-sp1-vc2008-rtm/)**。

然而，这份清单似乎并不全面。例如，我偶然发现了 Visual C++ Team 的这篇博文：**[Visual C++ Precompiled Header Errors on Windows 7](http://blogs.msdn.com/b/vcblog/archive/2009/11/12/visual-c-precompiled-header-errors-on-windows-7.aspx)**，其中包含指向另一个针对 VS2008 的 SP1 后修补程序的链接：[KB976656](http://connect.microsoft.com/VisualStudio/Downloads/DownloadDetails.aspx?DownloadID=25785)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:05:46.530

这个页面是我所知道的唯一一个类似于任何综合性的页面：

[https://connect.microsoft.com/VisualStudio/downloads/](https://connect.microsoft.com/VisualStudio/downloads/)

# cakephp-2.1 - CakePHP 在 app/tmp/sessions 只有几个用户创建数百个会话文件是正常行为吗？

> ID：10623279
> 
> 赞同：3
> 
> 时间：2012-05-16T17:03:37.227
> 
> 标签：cakephp-2.1

我让系统（CakePHP 2.1）运行了大约两个星期，不得不删除成千上万的会话文件。在我删除它们后，它们又开始滚动了。我已经让它运行了几个小时，最多有 426 个文件。这对于系统中的 10 个用户是否正常？我有一个`robot.txt`文件告诉引擎生气，我在所有页面的 https 上都有 auth 和 acl。任何人都可以为我解释一下吗？

```
Configure::write('Session', array(
    'defaults' => 'cake',
    'cookie' => 'scsys',
    'timeout' => 600
)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-03T17:52:30.567

这对我来说也是一个问题。我们每秒获得 1000 个会话文件。

原因是我们将 Session 组件加载到 AppCONtroller 中，并且每隔几秒钟就有许多 cron 作业从远程服务器访问我们站点上的 url。由于服务器 userAgent 上禁用了 Cookie，因此每次 cron 运行时都必须创建一个新会话（启用 cookie 的普通 userAgent 将使用相同的会话文件）。

有两种解决方法。一种是将 Session 组件移出 AppController 并移到您需要的特定控制器中。另一个是我选择的解决方案，是在每个运行的 cron 之后使用 php 命令 session_destroy() 。为了更进一步，我制作了一个插件 Cron，其中包含 Cotroller/CronAppController.php：

```
 /**
    * class to extend if you want the session destroyed after an action has completed. 
    * Useful for limiting cake session file storage overload
    *  
    */

    class CronAppController extends AppController {

        /**
         * set this to true in a controller action if you want the session destroyed 
         */
        public $cronAction = false;

        function afterFilter(){
            parent::afterFilter();
            if($this->cronAction){
                session_destroy();
            }
        }
    } 
```

然后使用 Cron.CronAppController 扩展包含 cron 操作的控制器，然后在您的操作中设置 $this->cronAction = true; 你可以走了！

# php - 数组不是数组？

> ID：10623280
> 
> 赞同：-4
> 
> 时间：2012-05-16T17:03:42.000
> 
> 标签：php, arrays, object, var-dump

关于 php 的非常简单且可能是菜鸟的问题。我运行以下命令；

```
var_dump($this->criteria); 
```

返回我：

```
object(SimpleXMLElement)[24]
public 'id' => string '3C222489-4BE4-47BB-A731-EFCF98B9979F' (length=36)
public 'parentId' => string '_001' (length=4)
public 'template' => string '_100' (length=4)
public 'name' => string 'New Report' (length=10)
public 'description' => 
object(SimpleXMLElement)[23]
public 'breakdown' => string 'talkgroup' (length=9)
public 'selectedColumns' => 
array
  0 => string 'talkgroup' (length=9)
  1 => string 'id' (length=2)  
public 'dc' => string '1337185046621' (length=13) 
```

伟大的！所以现在我可以看到 selectedColums 是一个数组.. 所以

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:16:37.520

假设您的问题是：

> 如何确定是否`selectedColums`是数组？

尝试这个：

```
is_array($this->criteria->description->selectedColumns) 
```

# c# - 什么是从这种文件类型中提取数据的方法？

> ID：10623283
> 
> 赞同：1
> 
> 时间：2012-05-16T17:04:04.160
> 
> 标签：c#, .net, winforms, parsing, text

我必须从文本文件中提取时间和坐标（东和北）数据。我想遍历它并使用包含的所有数据填充 3 个并行数组，直到我到达 EOF。我已经用 XML 完成了这项工作，但这次有点不同。我可以补充一下，这是一个用于 CC 视频文件的 SMI 文件。我将在下面发布一个示例：

```
<SAMI>
<HEAD>
    <STYLE TYPE="Text/css">
    <!--
        P {margin-left: 29pt; margin-right: 29pt; font-size: 24pt; text-align: center; font-family: Tahoma; font-weight: bold; color: #FF0000; background-color: #000000;}
        .SUBTTL {Name: 'Subtitles'; Lang: en-US; SAMIType: CC;}
    -->
    </STYLE>
</HEAD>
<BODY>
    <SYNC START=0>
        <P CLASS=SUBTTL>E: 4444444 N: 4444444 Time: 13:42:07
    <SYNC START=10>
        <P CLASS=SUBTTL>E: 44444444 N: 3333330 Time: 13:42:08
    <SYNC START=1010>
        <P CLASS=SUBTTL>E: 33333333 N: 4444444 Time: 13:42:09
    <SYNC START=2010>
        <P CLASS=SUBTTL>E: 2222222 N: 3333333 Time: 13:42:10
</BODY>
</SAMI> 
```

谢谢，凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:53:47.053

将以下模式与 .NET Regex 一起使用

```
@"^(?:\s+<P CLASS=SUBTTL>E:)\s+(\d+)\s+N:\s+(\d+)\s+Time:\s+(\d\d:\d\d:\d\d)" 
```

坐标和时间将在 Group[1], [2], [3] 中

我对此进行了测试。

```
 Regex r = new Regex(pat, RegexOptions.IgnoreCase);

        // Match the regular expression pattern against a text string.
        Match m = r.Match(input);
        if (m != null)
        {
            Debug.WriteLine(m.Groups[1].Value);
            Debug.WriteLine(m.Groups[2].Value);
            Debug.WriteLine(m.Groups[3].Value);
        } 
```

# string - csh eval 语句？

> ID：10623284
> 
> 赞同：0
> 
> 时间：2012-05-16T17:04:06.037
> 
> 标签：string, eval, csh

我试图了解 eval 语句的工作原理。这是我正在查看的一段我不明白的代码：

```
 eval `$SOME_DIR/util/dbget.pl \
          VARIABLE1 \
          VARIABLE2 \
          VARIABLE3 \
          VARIABLE4 ` 
```

无论如何，经过一些研究，我最初的想法是 eval 只是在命令行中输入这些字符串，这意味着它运行 .pl 脚本，然后......我不确定它对这些变量做了什么。此代码上方的注释说“获取一些参数”，但我不确定这是什么意思。

eval 'VARIABLE' 是否初始化变量？这似乎是这种情况，因为在 eval 之后代码继续使用这些变量，就好像它们现在已初始化（是否执行 if 语句检查等）。

我显然对这种脚本很陌生，只是跳进了一个大型存储库。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:19:22.027

好的，反引号被替换为它们之间的命令输出。

获取该`eval`输出并像输入一样执行它。

在这种情况下，我假设 perl 正在打印出一些变量赋值，比如`set VARIABLE1=value1`or `setenv VARIABLE1 value1`。在这种情况下，在上述之后`eval`，您应该可以`$VARIABLE1`使用以后的 csh 代码。

只运行 .pl 脚本（我假设是 Perl）`eval`不会影响 csh 进程的环境。通过使用`eval`，您授予 Perl 代码修改该环境的权限。

这意味着 Perl 必须知道它的输出是为 csh 准备的，顺便说一句。在 sh/bash 中，变量赋值的语法是不同的。

**ETA**更多尝试澄清：

如果你这样做：

```
$SOME_DIR/util/dbget.pl 
```

您会在屏幕上打印出一堆变量赋值语句。这没有用，并且对 shell 中的实际变量没有任何影响。

如果你这样做：

```
echo `$SOME_DIR/util/dbget.pl` 
```

您以更迂回的方式得到相同的结果：不是将 perl 代码直接打印到屏幕上，而是打印到传递给 csh`echo`命令的表达式中，然后`echo`才是实际打印到屏幕上的内容。这种区别很微妙，但很重要：反引号将控制权从 perl 手中夺回，并将其放回 shell 手中。一旦 shell 捕获了输出，它就可以将它存储在一个变量中，将它写入一个文件，或者用它做很多其他的事情，而无需重写 Perl 代码来处理。Perl 仍然只是打印。

如果你这样做：

```
eval `$SOME_DIR/util/dbget.pl` 
```

然后，shell 所做的就是执行 Perl 的输出，就好像它是在提示符下键入的一样。这是非常强大的。这也很危险，因为周围的程序最终会执行编写该程序的人从未见过的代码。因此，您必须相信该代码的来源（在这种情况下是 perl 脚本）不会产生任何破坏性的东西（有意或无意地）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T20:00:33.343

两者`eval`和反引号语法都在 csh 手册页中进行了解释。

如果您使用的是 Linux 系统，那么它很可能`csh`真的是原始C-shell`tcsh`的增强版本。`csh`这些特殊功能在 csh 和 tcsh 中是相同的。反引号语法调用所谓的“命令替换”。

引用我系统上的 tcsh 手册页（进行了一些小的调整以避免降价对反引号字符的特殊处理）：

> **命令替换**
> 
> 命令替换由包含在 [反引号] 中的命令显示。这种命令的输出通常在空格、制表符和换行符处分成单独的单词，空单词被丢弃；此文本然后替换原始字符串。在双引号 (") 内，只有换行符强制新词；保留空格和制表符。
> 
> 在任何情况下，最后一个换行符都不会强制输入一个新单词。请注意，即使命令输出完整的行，命令替换也可能仅产生单词的一部分。

和：

> **评估**参数 ...
> 
> （如在 sh(1) 中。）参数被读取为 shell 的输入，并在当前 shell 的上下文中执行生成的命令。这通常用于执行作为命令或变量替换结果生成的命令，因为解析发生在这些替换之前。有关使用 eval 的示例，请参见 tset(1)。

# php - mod_rewrite 和 GET 参数

> ID：10623286
> 
> 赞同：0
> 
> 时间：2012-05-16T17:04:14.213
> 
> 标签：php, apache, .htaccess, mod-rewrite

我有一个使用以下样式的页面的网站：

```
index.php?page=X&id=Y 
```

例如，对于博客，它将是

```
index.php?page=blog&id=65 
```

, 对于一张图片它可能是

```
index.php?page=picture&id=26 
```

我正在尝试设置一个重写规则，以便人们可以使用 mysite.com/page 或 mysite.com/page/id 但在传递两个参数时会出现问题。

出于某种原因，它会将我重定向到正确的页面，然后立即重新加载不带参数的同一页面，即它会加载`index.php?page=blog&id=65`然后立即重新加载`index.php?page=blog`，这是没有用的。

我正在使用的代码：

```
Options +FollowSymLinks
RewriteEngine on
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)$ /index.php?page=$1 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/([^/]+)$ index.php?page=$1&id=$2 [L] 
```

任何建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:13:01.857

**解决此问题的最佳方法是将所有**请求重定向到路由器页面（通常是`index.php`文件），并让它包含从那里实际请求的文件。它使您可以**更好**地控制重定向到哪里，并允许比 RegEx 可以轻松实现的更复杂的规则。

至于你的具体问题。它可能是重新加载窗口的 JavaScript，或者您`Location:`的 PHP 代码中某处有一些标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:03:46.423

阅读 mod_rewrite 文档，特别是 [QSA]（查询字符串附加）标志。如果没有这个，如果您在替换字符串中指定新参数，重写引擎将转储现有参数。有了它，它将附加旧的。

# android - 使用经度和纬度的 Android 地图活动

> ID：10623289
> 
> 赞同：0
> 
> 时间：2012-05-16T17:04:31.687
> 
> 标签：android, google-maps-mobile

我想使用经度和纬度在我的应用程序内绘制地图。这在android中可能吗？

我只能在开发人员的文档中找到[这个](http://developer.android.com/resources/tutorials/views/hello-mapview.html)

如果您能对此有所了解，那就太好了。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:34:24.303

这是代码，可以满足您的所有需求以及更多功能-它实际上按名称搜索位置，将其转​​换为纬度/经度，然后对其进行映射：
[https ://github.com/bricolsoftconsulting/GeocoderPlusExample](https://github.com/bricolsoftconsulting/GeocoderPlusExample)

# ssl - 通过 https(SSL) 访问部署在 JBoss7.1 上的 OSGi 包

> ID：10623290
> 
> 赞同：1
> 
> 时间：2012-05-16T17:04:36.683
> 
> 标签：ssl, jboss, https, osgi

我在 JBoss 7.1
JBoss 上部署了一个简单的 java webapp(SSO-server)，配置为使用 SSL thrue 443 端口、selfsignet 证书和密钥库

```
 <connector name="https" protocol="HTTP/1.1" scheme="https" socket-binding="https" secure="true">
            <ssl name="https" password="12345678" certificate-key-file="../standalone/configuration/sso.keystore"/>
 </connector>
   ...
 <socket-binding name="https" port="443"/> 
```

一切正常，我可以使用访问 servlet（使用“sso-service/auth”映射）

“https://localhost/sso-service/auth”

但现在我将我的应用程序分成 OSGi 包（serviseApi、serviseImpl、web），

注册 servlet 我使用“org.osgi.service.http.HttpService”

```
httpService = (HttpService) context.getService(context
    .getServiceReference(HttpService.class.getName()));

AuthenticationServlet authServlet = new AuthenticationServlet();

httpService.registerServlet(SSO_AUTH_URL, authServlet, null, null); 
```

我也将此配置添加到 JBoss Standalone.xml：

```
<socket-binding name="osgi-http" interface="management" port="8080"/> 
```

当我部署所有捆绑包时，我会通过 http 从我的 servlet 获得响应

“http://localhost:8080/sso-service/auth”

但是当我尝试“https://localhost:443/sso-service/auth”时，我收到了我的 selfsignet sert，但没有来自 servlet 的 unsver。据我了解，我的 servlet 仅在“osgi-http”- 8080 端口上运行

那么，我可以获得对这个捆绑包的 https 访问权限吗，需要哪些额外的配置？

# sql - Heroku SQL 查询超时时会发生什么？

> ID：10623291
> 
> 赞同：0
> 
> 时间：2012-05-16T17:04:39.927
> 
> 标签：sql, heroku, console, timeout

Heroku 没有内置 SQL 控制台，所以我使用了第三方插件：

```
heroku plugins:install git://github.com/ddollar/heroku-sql-console.git 
```

当我在此控制台中运行简单查询时，一切正常，但是当我运行复杂查询时，控制台超时。

当控制台显示“超时”时实际发生了什么？查询是继续运行还是中断？如何增加超时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T08:10:14.080

现在我有一个答案，会发生什么：查询继续运行到最后。Heroku 家伙昨天增加了 sql 控制台超时。

# php - 警告：fopen() [function.fopen]: 文件名不能为空

> ID：10623296
> 
> 赞同：2
> 
> 时间：2012-05-16T17:04:53.770
> 
> 标签：php, caching, fopen

我使用本教程[http://papermashup.com/caching-dynamic-php-pages-easily/](http://papermashup.com/caching-dynamic-php-pages-easily/)来缓存页面

```
<?php {
$cachefile = $_SERVER['DOCUMENT_ROOT'].'cache.html';
$cachetime = 4 * 60;
// Serve from the cache if it is younger than $cachetime
if (file_exists($cachefile) && time() - $cachetime < filemtime($cachefile)) {
    include($cachefile);
} else {
ob_start(); // Start the output buffer
 ?>

/* Heres where you put your page content */

<?php 
// Cache the contents to a file
$cached = fopen($cacheFile, 'w');
fwrite($cached, ob_get_contents());
fclose($cached);
ob_end_flush(); // Send the output to the browser
}
?> 
```

但我收到以下错误

```
Warning: fopen() [function.fopen]: Filename cannot be empty in

Warning: fwrite(): supplied argument is not a valid stream resource in

Warning: fclose(): supplied argument is not a valid stream resource in 
```

文件的路径是正确的。如果我编辑我自己的文件，但我再次收到错误

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T17:07:19.737

您的变量名的大小写有问题。PHP 变量名区分大小写。改为（`cacheFile`用`cachefile`小**F**代替）。

改变这个：

```
$cached = fopen($cacheFile, 'w'); 
```

对此：

```
$cached = fopen($cachefile, 'w'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T17:07:05.713

您遇到拼写错误：`$cachefile`!= `$cacheFile`PHP 标识符区分大小写。所以决定一个版本并纠正其他出现。

更正的代码：

```
$cached = fopen($cachefile, 'w'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-16T17:07:14.597

你第一次参考`$cachefile`。你第二次参考`$cacheFile`。将外壳固定在一个地方或另一个地方，你应该很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-17T04:40:11.380

对我来说，这是因为我对文件的权限不足，所以我用`chmod`

# python - 分配如何与列表切片一起使用？

> ID：10623302
> 
> 赞同：118
> 
> 时间：2012-05-16T17:05:14.113
> 
> 标签：python, list, slice

Python 文档说切片列表会返回一个新列表。
现在，如果返回“新”列表，我有以下与“分配给切片”相关的问题

```
a = [1, 2, 3]
a[0:2] = [4, 5]
print a 
```

现在输出将是：

```
[4, 5, 3] 
```

1.  正在返回的东西怎么会出现在表达式的左侧？
2.  是的，我阅读了文档，它说这是可能的，现在既然切片列表返回一个“新”列表，为什么要修改原始列表？我无法理解其背后的机制。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-05-16T17:09:24.783

您混淆了两个使用非常相似语法的不同操作：

**1）切片：**

```
b = a[0:2] 
```

这会复制 的切片`a`并将其分配给`b`。

**2）切片分配：**

```
a[0:2] = b 
```

这会将的切片*替换*`a`为的内容`b`。

尽管语法相似（我想象中的设计！），但这是两种不同的操作。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2012-05-16T17:12:12.483

当您`a`在运算符的左侧指定时`=`，您使用的是 Python 的**正常赋值**，它将`a`当前上下文中的名称更改为指向新值。这不会更改`a`指向的先前值。

通过`a[0:2]`在运算符的左侧指定`=`，您是在告诉 Python 您要使用**切片赋值**。切片赋值是列表的一种特殊语法，您可以在其中插入、删除或替换列表中的内容：

**插入**：

```
>>> a = [1, 2, 3]
>>> a[0:0] = [-3, -2, -1, 0]
>>> a
[-3, -2, -1, 0, 1, 2, 3] 
```

**删除**：

```
>>> a
[-3, -2, -1, 0, 1, 2, 3]
>>> a[2:4] = []
>>> a
[-3, -2, 1, 2, 3] 
```

**更换**：

```
>>> a
[-3, -2, 1, 2, 3]
>>> a[:] = [1, 2, 3]
>>> a
[1, 2, 3] 
```

笔记：

> 如果目标序列允许，切片的长度可能与指定序列的长度不同，因此会改变目标序列的长度。-[*来源*](https://docs.python.org/3/reference/simple_stmts.html#assignment-statements)

[切片分配提供了与元组解包](https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences)类似的功能。例如，`a[0:1] = [4, 5]`等价于：

```
# Tuple Unpacking
a[0], a[1] = [4, 5] 
```

通过元组解包，您可以修改非顺序列表：

```
>>> a
[4, 5, 3]
>>> a[-1], a[0] = [7, 3]
>>> a
[3, 5, 7] 
```

但是，元组解包仅限于替换，因为您不能插入或删除元素。

在所有这些操作之前和之后，`a`是完全相同的列表。Python 只是提供了很好的语法糖来就地修改列表。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2016-02-25T16:26:07.157

我之前遇到过同样的问题，它与语言规范有关。根据[assignment-statements](http://docs.python.org/reference/simple_stmts.html#assignment-statements)，

1.  如果赋值的左侧是订阅，Python 将调用[`__setitem__`](https://docs.python.org/2/reference/datamodel.html#object.__setitem__)该对象。`a[i] = x`相当于`a.__setitem__(i, x)`。

2.  如果赋值的左边是 slice，Python 也会调用`__setitem__`，但参数不同： `a[1:4]=[1,2,3]`等价于 `a.__setitem__(slice(1,4,None), [1,2,3])`

这就是为什么'='左侧的列表切片表现不同的原因。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-16T17:08:30.810

通过在赋值操作的左侧切片，您可以指定要分配给哪些项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-10-10T17:29:47.723

当您这样做时，您将（切片）的`a[0:2] = [4,5]`左侧分配了 ,右侧 的值。`=``a[0:2]``=``[4,5]`

# c# - 在 IIS 中重新启动应用程序池时立即运行 Application_Start

> ID：10623303
> 
> 赞同：11
> 
> 时间：2012-05-16T17:05:17.660
> 
> 标签：c#, .net, iis, iis-7

我们在应用程序的 application_start 阶段做一些缓存操作。因此，当应用程序池重新启动时，所有缓存都将消失。是否可以在应用程序池重新启动时触发 application_start 或者您有更好的想法来解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:00:55.560

您可以使用[Application Initialization for IIS 7.5](http://forums.iis.net/t/1176740.aspx)，它借用 IIS8 的功能，或者如果您使用的是 ASP.NET 4.0 +，则[应用程序自动启动](http://weblogs.asp.net/scottgu/archive/2009/09/15/auto-start-asp-net-applications-vs-2010-and-net-4-0-series.aspx)。

对于 ASP.NET 2.0 i 3.5 有一个 IMO 有点骇人听闻的解决方案，您可以在事件日志中记录应用程序池回收，然后在事件日志中设置将在该事件上执行的任务，这里是[详细信息](http://blogs.msdn.com/b/vijaysk/archive/2009/03/10/iis-7-tip-4-application-pool-recycling-events-has-an-ui.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:26:14.467

Application_Start 仅在第一次请求时调用。如果没有请求，我不确定缓存一些东西是个好主意。

我会在第一个请求时简单地加载缓存。
您的 CacheManager 可以决定是否需要自动加载它的数据。

你害怕第一个请求会慢吗？

# iphone - 在哪里存储下载的图像在应用程序中？

> ID：10623308
> 
> 赞同：0
> 
> 时间：2012-05-16T17:05:36.790
> 
> 标签：iphone, objective-c, ios

我有一个应用程序，我在其中将图像从网络下载到 iphone 应用程序。这部分正在工作。

有问题的部分是在哪里存储它？

对于商店位置，我使用以下代码：

```
...
NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *pngFilePath = [NSString stringWithFormat:@"%@%@", docDir, imageName];
... 
```

但是当我在 iPhone 模拟器中启动应用程序时，没有加载图像。

当我将图像存储到桌面时，我看到图像但仍未加载。

```
NSString *docDir = @"/Users/username/Desktop/MyProject/"; 
```

在哪里以及如何存储图像然后加载它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:23:33.873

也许这个网站会帮助你：

[http://guerratopia.com/en/how-to-saveload-or-remove-images-in-iphoneipad-documents-directory](http://guerratopia.com/en/how-to-saveload-or-remove-images-in-iphoneipad-documents-directory)

如果你按照他的指示，它会工作。

干杯马克斯

编辑：我认为 dasblinkenlight 是对的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:05:31.543

试试这个：

```
NSString *pngFilePath = [docDir stringByAppendingPathComponent:imageName]; 
```

# ios - iOS Mapkit - 如何过滤注释（显示/隐藏）？

> ID：10623310
> 
> 赞同：2
> 
> 时间：2012-05-16T17:05:47.160
> 
> 标签：ios, annotations, mapkit, pins

所以我有 4 种不同类型的注释来显示特定的引脚（即颜色）。我希望能够有一个分段控件，允许用户按类型显示/隐藏这些注释。

有没有一种简单的方法来隐藏命令中的特定注释？还是我真的必须删除，然后只用我想要显示的注释重建注释？

这个应用程序可能有成百上千个 pin，所有这些都是 4 种不同类型的 pin 之一。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T19:09:31.050

弄清楚了。

基本上在创建注释时，我将它们存储在不同的数组中（对于每种类型）。

```
//Store Annotation in Array
    [type1Array addObject:annotation]; 
```

然后，当我的按钮被按下来过滤它们时，我使用以下内容：

```
 [_mapView removeAnnotations:type1Array];
    [_mapView addAnnotations:type2Array]; 
```

这似乎工作正常，并且不会导致复制注释的问题。我使用 NSLog 输出 _mapView.annotations.count 以验证注释是否重复。

希望这对其他人有帮助！

# jquery - 如何找到 Jqgrid 索引号？

> ID：10623312
> 
> 赞同：3
> 
> 时间：2012-05-16T17:05:54.323
> 
> 标签：jquery, jqgrid

我正在使用 Jqgrid 显示一个表，并且我有一个自动增量主键作为表主键。数据按 orderDate 分组，但我不知道如何通过 Jqgrid 访问相同 orderDate 的值。

我用它来查找选定的行

```
var rowKey = grid.getGridParam("selrow"); 
```

它返回一个值，如果数据整洁，我只需添加 1 即可获得所需数据的正确索引，但这些值通常彼此相距甚远。

我可以通过修改 SQL 将表中的数据组合在一起，但表似乎仍然保留 orderDate 作为索引。

有没有一种简单的方法可以选择网格的下一行？或者至少找到它的索引？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:35:19.433

您可以使用“getInd”方法来查找您正在使用的行的索引，如下所示：

```
var idx = grid.getInd(rowKey); 
```

您还可以像这样从网格中获取 ID 值数组（按网格显示中的顺序排列）：

```
var dataIDs = grid.getDataIDs(); 
```

一起，您可以获得网格中下一行的 id：

```
var nextID = (dataIDs.length < idx+1) ? dataIDs[idx+1] : dataIDs[0]; 
```

（在这里我假设如果你到达列表的末尾，你想回到开头 - 你明白了）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T18:28:49.080

也许您可以考虑使用 CellSelect(gets rowId) 和 BeforeEditCell(iRow and iCol) 在我的情况下，我将值增加 1 或减少并使用它通过箭头键浏览网格。IRow 和 ICol 是你的行和列索引

但这意味着您不会使用表单进行编辑（我猜），而是像逐个单元格编辑一样

然后在编辑时你可以做 rowEdited[e.AllKeys[0]] = e.AllKeys[0]; 在会话中分配值和存储 ID，然后在服务器按钮“Complete_Click”上保存

或者可能像“clientArray”一样通过 SAVENOW！（仍在尝试）在点击内联保存按钮时保存到saveToDb。只是一个想法:)

# actionscript-3 - 使用预签名的 url 从 AS3 上传到 S3

> ID：10623326
> 
> 赞同：2
> 
> 时间：2012-05-16T17:07:28.143
> 
> 标签：actionscript-3, amazon-s3

我想将图像从闪存直接从闪存上传到 S3。我需要发出的请求似乎需要是我认为 flash 不支持的 PUT 请求。有没有人使用预签名的 url 让 flash 与 S3 一起工作？尝试添加 X-HTTP-Method-Override 似乎没有用。认为可能有一种方法可以使用套接字？

[http://docs.amazonwebservices.com/AmazonS3/latest/dev/UploadObjectPreSignedURLDotNetSDK.html](http://docs.amazonwebservices.com/AmazonS3/latest/dev/UploadObjectPreSignedURLDotNetSDK.html)

[http://verveguy.blogspot.co.uk/2008/07/truth-about-flex-httpservice.html](http://verveguy.blogspot.co.uk/2008/07/truth-about-flex-httpservice.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T13:23:05.180

使用名为**as3httpclient的库让它工作**

[https://github.com/gabriel/as3httpclient](https://github.com/gabriel/as3httpclient)

源代码中包含的测试用例之一是上传到 S3，非常简单：）

[https://github.com/gabriel/as3httpclient/blob/master/test/s3/HttpsTest.as](https://github.com/gabriel/as3httpclient/blob/master/test/s3/HttpsTest.as)

更新：

一切都很顺利，直到 html 页面位于网络服务器上，然后遇到沙盒问题，导致一切停止。似乎该库仅适用于 AIR，而不适用于 html 页面。最后不得不保存使用发布请求并从闪存设置标题。Flash 代码的示例在此处[http://aws.amazon.com/code/1092](http://aws.amazon.com/code/1092)。

# java - CXF 返回元素列表

> ID：10623327
> 
> 赞同：2
> 
> 时间：2012-05-16T17:07:39.020
> 
> 标签：java, cxf, jax-rs

这工作正常：

```
@GET
@Path("elements")
public List<Element> getElements(@HeaderParam(SESSION_TOKEN) String token) {
    try {
        if (token != null) {
            Session session = new Session();
            if (session.initWithToken(token)) {
                ElementFacade sf = ElementFacade.getInstance();
                return sf.getElements(session.getUser());
            }
        }
    } catch (Throwable th) {
        log.error("", th);
    }
    return new ArrayList<Element>();
} 
```

我得到了一个非常好的带有对象的 JSON 数组。

现在的问题是我喜欢将我的数据作为有效负载放入响应中，以便能够设置标头和状态，或者将错误对象作为有效负载返回。但它不起作用。

```
@GET
@Path("elements2")
public Response getElements2(@HeaderParam(SESSION_TOKEN) String token) {
    try {
        if (token == null) {
            return ResponseFactory.createResponse(401, 4007);
        }
        Session session = new Session();
        if (session.initWithToken(token)) {
            ElementFacade sf = ElementFacade.getInstance();
            return Response.status(200)
                    .header(Endpoint.SESSION_TOKEN, session.getToken())
                    .entity(sf.getElements(session.getUser())).build();
        }
        return ResponseFactory.createResponse(403, 4006);
    } catch (InvalidTokenException e) {
        return ResponseFactory.createResponse(401, 4005);
    } catch (SessionTimeoutException e) {
        return ResponseFactory.createResponse(401, 4004);
    } catch (Throwable th) {
        log.error("", th);
        return ResponseFactory.createResponse(500, 5099);
    }
} 
```

Mai 16, 2012 7:00:35 PM org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor writeResponseErrorMessage 警告：没有找到响应类 ArrayList 的消息正文编写器。

如何使用与第二个函数中的第一个函数相同的现有功能？

我读了一些关于编写自己的 MessageBodyWriter 的内容，但是在那个类中，我需要将整个 JSON 写入 OutputStream 并且似乎需要大量工作和开销......

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T12:51:16.480

这太他妈容易了。但是在任何文档中都没有找到它...

我尝试了很多然后baammm ...

```
@GET
@Path("elements2")
public Response getElements2(@HeaderParam(SESSION_TOKEN) String token) {
      try {
          if (token == null) {
              return ResponseFactory.createResponse(401, 4007);
          }
          Session session = new Session();
          if (session.initWithToken(token)) {
              ElementFacade sf = ElementFacade.getInstance();
              List<Element> list = sf.getElements(session.getUser());
              return Response.status(200)
                      .header(Endpoint.SESSION_TOKEN, session.getToken())
                      .entity(new GenericEntity<List<Element>>(list) {}).build();
          }
          return ResponseFactory.createResponse(403, 4006);
      } catch (InvalidTokenException e) {
          return ResponseFactory.createResponse(401, 4005);
      } catch (SessionTimeoutException e) {
          return ResponseFactory.createResponse(401, 4004);
      } catch (Throwable th) {
          log.error("", th);
          return ResponseFactory.createResponse(500, 5099);
      }
} 
```

就是这样......你只需要创建一个GenericEntity......

# extjs - Sencha JSON 到 SelectField 选项

> ID：10623329
> 
> 赞同：1
> 
> 时间：2012-05-16T17:07:41.580
> 
> 标签：extjs, sencha-touch-2

我调用了我的数据层，它带回了 json 对象。我需要获取这个对象并将其转换为我的 selectField 中的选项数组。这个 json 对象有一个地区名称和一个地区 ID——这就是对象中的全部内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:58:53.180

在 selectfield 配置中，将 valueField 设置为 'DistrictID' 并将 displayField 设置为 'District'
然后只需 selectField.setOptions(json)

# .net - WPF下以CSS的方式重复图片

> ID：10623330
> 
> 赞同：1
> 
> 时间：2012-05-16T17:07:43.463
> 
> 标签：.net, wpf, silverlight, xaml

我正在考虑在 WPF UserControl 下创建一些背景并将所有图像保留为嵌入式资源。

我猜想是**最小化图像大小**并保持 1 像素宽度的图像，然后以某种方式重复它，就像我们在 CSS 下拥有它一样。

```
background-image: url(http://s11.postimage.org/ufpdknvjz/left.png);
background-repeat: repeat-x; 
```

有什么方法可以用 XAML 做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:21:08.850

猜测您想使用 an[`ImageBrush`](http://msdn.microsoft.com/en-us/library/system.windows.media.imagebrush.aspx)并指定正确的[`TileMode`](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.tilemode.aspx). 不知道你是否可以只做X...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:25:54.187

使用 ImageBrush 的 Stretch 属性

```
<Grid>
    <Grid.Background>
        <ImageBrush ImageSource="http://s11.postimage.org/ufpdknvjz/left.png" Stretch="UniformToFill" />
    </Grid.Background>
    <!-- Other content -->
</Grid> 
```

# actionscript-3 - 拼写检查错误：null 无法解析为波浪形字典

> ID：10623338
> 
> 赞同：0
> 
> 时间：2012-05-16T17:08:12.700
> 
> 标签：actionscript-3, air, filesystems, directory

我在我的应用程序 ( [http://labs.adobe.com/technologies/squiggly/](http://labs.adobe.com/technologies/squiggly/) ) 的帮助下组织了一个拼写检查器。

```
_newdict.addEventListener(Event.COMPLETE, handleLoadComplete);
_newdict.load("dictionaries/en_EN/en_EN.aff", "dictionaries/en_EN/en_EN.dic"); 
```

当字典文件与应用程序位于同一文件夹中时，一切正常。但是字典很大（超过 5MB）。因此根据用户需求加载它。文件不能保存程序文件夹，而只能保存应用程序存储目录。

但是，初始化字典时出现错误：null 无法解析为波浪形字典。我已经尝试了两种方法：file1.nativePath 和 file1.url，它仍然是错误。

```
var file1:File = File.applicationStorageDirectory.resolvePath("dictionaries/en_EN/en_EN.aff");
var file2:File = File.applicationStorageDirectory.resolvePath("dictionaries/en_EN/en_EN.dic");
if (!file1.exists || !file2.exists){
    //download files from the server
} else {
    _newdict.addEventListener(Event.COMPLETE, handleLoadComplete);
    _newdict.load(file1.nativePath,file2.nativePath);
   //_newdict.load(file1.url,file2.url);
} 
```

请告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T20:51:42.933

使用您的代码示例和 Squiggly 附带的字典文件`.nativePath`可以正常工作。[但是，当文本文件采用ANSI（Windows-1252）](http://en.wikipedia.org/wiki/Windows-1252)`dictionaryURL`以外的编码时，我会收到“无法解析 null”错误。使用文本编辑器可以很容易地转换文件。

但是，如果您尝试对使用超出该编码范围的字符的语言进行拼写检查，则标准加载方法将不起作用。我能想到的唯一解决方法是`_newDict.squigglyDictionary.addWord`，它似乎接受所有字符。

当字典文件为空白时，我也收到错误消息。所以这也可能是问题所在。

# visual-studio-2010 - 从 VS2010 VsPackage 签出文件

> ID：10623340
> 
> 赞同：0
> 
> 时间：2012-05-16T17:08:26.623
> 
> 标签：visual-studio-2010, version-control, vsix, vs-extensibility, vspackage

我有一个 VS2010 VsPackage，它为某种基于 XML 的文件格式实现了一个编辑器。

目前，如果文件是只读的，我会显示错误。我想在编辑之前检查文件是否受源代码控制，并提出签出文件或取消编辑操作。

如何从我的扩展包代码中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:40:32.570

在这里查看我的答案： [调用标准“文件在 Visual Studio 之外更改”对话框](https://stackoverflow.com/questions/10413086/invoking-standard-file-changed-outside-visual-studio-dialog/10667845#10667845)

特别是，`IVsQueryEditQuerySave2`可能对你有用。

# knockout.js - 推迟更新 knockoutjs 模型，直到验证/保存

> ID：10623345
> 
> 赞同：2
> 
> 时间：2012-05-16T17:08:44.403
> 
> 标签：knockout.js

有没有办法为 valueUpdate 创建自定义事件，以便我可以推迟更新模型，直到对象被验证/保存？

[文档](http://knockoutjs.com/documentation/value-binding.html#!s!valueUpdate)说：

> 以下字符串值是最常用的选择：
> 
> “改变”......，“keyup”......，“keypress”......，“afterkeydown”......

暗示其他值是可能的，但没有说明我可以在哪里找到完整列表。

我想要一个带有取消按钮的弹出表单（在需要之前在隐藏的 div 中），导致表单被删除而不更新模型。模型应该只在用户按下保存按钮时更新。

（我从[这里](https://groups.google.com/forum/?fromgroups#!topic/knockoutjs/UWwsTQrQfZ0)稍微复制了这个问题- 似乎我不是唯一想要这个的人，但他们没有得到答案）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T03:42:06.510

可以选择从 observable 订阅“beforeChange”通知流。这使您有机会在值更改之前对其进行检查。

真正解决模型验证的最明显方法是使用“可写”计算值。这些允许您合并您的验证逻辑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T10:06:50.547

与文档所暗示的相反，该`valueUpdate`参数没有“定义 KO 应该使用哪个浏览器事件来检测更改”，默认值为“更改”，它允许您提供一个事件或应该捕获的可能事件列表，除了总是被抓住的“变化”。

相关[代码](https://github.com/SteveSanderson/knockout/blob/master/src/binding/defaultBindings.js#L121)为：

```
// Always catch "change" event; possibly other events too if asked
var eventsToCatch = ["change"];
var requestedEventsToCatch = allBindingsAccessor()["valueUpdate"];
if (requestedEventsToCatch) {
    if (typeof requestedEventsToCatch == "string") // Allow both individual event names, and arrays of event names
        requestedEventsToCatch = [requestedEventsToCatch];
    ko.utils.arrayPushAll(eventsToCatch, requestedEventsToCatch);
    eventsToCatch = ko.utils.arrayGetDistinctValues(eventsToCatch);
} 
```

这种行为实际上是在：[https](https://github.com/SteveSanderson/knockout/issues/102) ://github.com/SteveSanderson/knockout/issues/102 https://github.com/SteveSanderson/knockout/commit/843420a6f801b17dd357880b359a67fa53647999

看起来文档还没有更新。我希望人们在需要时必须要求更改，并且文档告诉他们以下内容：

“事件列表，我们建议包括'change'，通过[]禁用自动更新模型”

# wix - 使用 WiX 卸载后重新启动

> ID：10623346
> 
> 赞同：2
> 
> 时间：2012-05-16T17:08:47.630
> 
> 标签：wix, uninstallation, wix3.5, reboot

卸载后是否可以重新启动？我正在使用 WiX 创建我的安装程序。

我知道我们可以在安装后重新启动使用

```
<InstallExecuteSequence>
  <ScheduleReboot After="InstallFinalize"/>
</InstallExecuteSequence> 
```

但我想在卸载后重新启动。请指教。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-14T11:32:44.940

使用条件表：

```
<ScheduleReboot After="InstallFinalize">REMOVE='ALL'</ScheduleReboot> 
```

在节点内部，即使此操作是否执行也是一个条件。删除它是 Windows 安装程序的标准属性。当安装程序从系统中删除产品时，它会设置 REMOVE=ALL。查看 msdn.microsoft.com/en-us/library/windows/desktop/...、msdn.microsoft.com/en-us/library/windows/desktop/...。

# javascript - 分页表的动态索引

> ID：10623348
> 
> 赞同：4
> 
> 时间：2012-05-16T17:08:53.217
> 
> 标签：javascript, css, html, dynamic

我正在创建一个分页的表（每页仅显示 10 个元素）。我不确定表有多大，因为用户是动态添加的。我想要与表格中的页面相对应的数字，当用户单击其中一个页面时，它会加载该页面的元素。我还想显示用户当前在哪个页面上。目前，我有一个整数来跟踪用户所在的页面、下一个返回、第一个和最后一个按钮。我真正需要知道的是如何创建一组可点击的动态数字。我正在使用 chrome 浏览器、HTML5 和 JS。

提前谢谢

Java 脚本

```
 function display(){//shows the Status Table
            document.getElementById("DStatusTable").hidden='';
            document.getElementById("buttons").hidden='';
            var table = document.getElementById('statusTable');
            for(var i =1; i<table.rows.length; i++){
                var x =table.rows[i].cells;
                table.rows[i].id ='notselected';
                table.rows[i].hidden='';
                if (!((pageCUR*10+i)>fileLIST.length)){
                    x[0].innerHTML = fileLIST[pageCUR*10+(i-1)]
                                            [0].name;
                    x[1].innerHTML = fileLIST[pageCUR*10+
                                            (i-1)][1];  
                                    }
                else{   
                    table.rows[i].hidden='hidden';
                                    }

    function nextPage(){//shows next page
       pageCUR++;
       if (pageCUR>=parseInt(pageMAX)){//checks if on last page
        document.getElementById('Next').hidden='hidden';
        document.getElementById('Last').hidden='hidden'; }
       else {
        document.getElementById('Next').hidden='';
        document.getElementById('Last').hidden=''; 
               }
       document.getElementById('Back').hidden='';
       document.getElementById('First').hidden='';
       display(); 
    }

    function backPage(){//shows previous page
       pageCUR--;
       if (pageCUR==0){//checks if on first page
        document.getElementById('Back').hidden='hidden';
        document.getElementById('First').hidden='hidden';
               }        
       else{ 
        document.getElementById('Back').hidden='';
        document.getElementById('First').hidden='';
               }
       document.getElementById('Next').hidden=''    
       document.getElementById('Last').hidden=''    
       display();
     }

     function firstPage(){//shows first page
       pageCUR =0;
       document.getElementById('First').hidden='hidden';
       document.getElementById('Back').hidden='hidden';
       document.getElementById('Next').hidden='';
       document.getElementById('Last').hidden='';
       display();
     }

     function lastPage(){//shows last page
       pageCUR =parseInt(pageMAX);
       document.getElementById('First').hidden='';
       document.getElementById('Back').hidden='';
       document.getElementById('Next').hidden='hidden';
       document.getElementById('Last').hidden='hidden';
       display();
    } 
```

HTML5

```
 <div class="StatusTable" id="DStatusTable" hidden>
        <table id='statusTable' border='1'>
        <thead><tr>
                <th> NAME</th>
                <th>STATUS</th>
            </tr>
        </thead>
        <tbody>
            <tr id="row1">
                <td onclick = "play(0)">video 1</td>
                <td onclick="SET(this,0)" ></td></tr>
            <tr id="row2">
                <td onclick = "play(1)">video 1</td>
                <td onclick="SET(this,1)" ></td></tr>
            <tr id="row3">
                <td onclick = "play(2)">video 1</td>
                <td onclick="SET(this,2)" ></td></tr>
            <tr id="row4">
                <td onclick = "play(3)">video 1</td>
                <td onclick="SET(this,3)" ></td></tr>
            <tr id="row5">
                <td onclick = "play(4)">video 1</td>
                <td onclick="SET(this,4)" ></td></tr>
            <tr id="row6">
                <td onclick = "play(5)">video 1</td>
                <td onclick="SET(this,5)" ></td></tr>
            <tr id="row7">
                <td onclick = "play(6)">video 1</td>
                <td onclick="SET(this,6)" ></td></tr>
            <tr id="row8">
                <td onclick = "play(7)">video 1</td>
                <td onclick="SET(this,7)" ></td></tr>
            <tr id="row9">
                <td onclick = "play(8)">video 1</td>
                <td onclick="SET(this,8)" ></td></tr>
            <tr id="row10">
                <td onclick = "play(9)">video 1</td>
                <td onclick="SET(this,9)" ></td></tr>
        </tbody>
        </table>
    </div> 
```

以及我有 2 个全局变量 pageCUR 和 pageMAX 保存当前页面的索引和最大（最后）页面的索引

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:24:41.617

这是在 JavaScript 中生成分页的方式（使用 jQuery）：[JSFiddle-Example](http://jsfiddle.net/3U9sB/1/)

请注意，这`window.changePage = function ...`只是 JSFiddle 中使该函数全局化的一种解决方法。加载下一页的 JScript-Code 直接进入其中。

```
function changePage (page){
 alert('change page to ' + page);   
}

function makePagination(n){
    for(var i=0; i<=5; i++){
        $("<a onclick='changePage("+i+");'>"+i+"</a>").appendTo('#pagination'); 
        if(i!=5) $('#pagination').append(' | ');
    }
}

$(document).ready(function () {
    makePagination(5); // Number of pages
}); 
```

和

```
<div id='pagination'></div>​ 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T12:40:55.803

这就是我最终用来改变我的页面的东西

JS

```
 function makePagination(){
        var x = document.getElementById('pagination');
        var y='|';
        for(var i=0; i<=(pageMAX); i++){
            y= y+"<a id ='pageNumber"+i+"' onclick='changePage("+       (i+1)+");'>"+(i+1)+"</a>\n ";
           if(i!=(fileLIST.length/10)) y=y+' | ';
        }
        x.innerHTML=y   
    }
    function changePage(k){
        pageCUR = k-1;
        display();
    } 
```

连同 HTML div

```
 <div id='pagination'></div> 
```

# imagemagick - Imagemagick：一次生成多个文件

> ID：10623359
> 
> 赞同：-1
> 
> 时间：2012-05-16T17:10:02.793
> 
> 标签：imagemagick, jpeg, file-generation

我使用 ImageMagick 来生成预览。在大图像（> 3mb）上，它的工作速度非常慢（通话大约需要 1-3 秒）。我可以一次生成多个预览吗？我认为这会更快。

我这样做：

```
convert file.jpg -thumbnail 800x480 preview_800x480.jpg
convert file.jpg -thumbnail 700x400 preview_700x400.jpg
convert file.jpg -thumbnail 72x72 preview_800x480.jpg 
```

...

我想做这样的事情：

```
convert file.jpg -thumbnail 800x480 preview_800x480.jpg 700x400 preview_700x400.jpg 
```

但是这样的命令只生成最后一个文件 preview_700x400.jpg。应该如何编写才能正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:41:07.817

这是使用 php，但你没有说你是如何运行代码的，你应该能够将它转换为你正在使用的方法。

```
$cmd = " file.jpg \( -clone 0 -thumbnail 800x480 -write preview_800x480.jpg +delete \)". 
" \( -clone 0 -thumbnail 700x400 -write preview_700x400.jpg +delete \) ". 
" -thumbnail 72x72 null: ";
exec("convert $cmd preview_800x480.jpg "); 
```

有时 null: 会导致问题；如果是这样，请尝试不使用。

# php - Drupal 表单——无输出

> ID：10623362
> 
> 赞同：0
> 
> 时间：2012-05-16T17:10:19.623
> 
> 标签：php, drupal

我在正文部分的页面上有以下代码。

```
<?php
function test_myform($form, &$form_state) {

  $form['description'] = array(
    '#type' => 'item', 
    '#title' => t('A form with nothing but a textfield'),
  );
  // This is the first form element. It's a textfield with a label, "Name"
  $form['name'] = array(
    '#type' => 'textfield', 
    '#title' => t('Name'),
  );
  return $form;
}
function test_page() {
  return drupal_get_form('test_myform');
}

test_page();

?> 
```

这不会返回任何东西。没发生什么事。页面是空白的。我错过了什么？谁能帮我一把？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T21:25:49.893

欢迎使用 SO 和 Drupal Form API（很高兴将其称为 FAPI，但您知道 Internet 模因）。首先，让我们知道您需要使此表单工作的 Drupal 版本，以及您需要在哪里显示此表单。

有关不错的启动教程，请参见[http://drupal.org/node/751826](http://drupal.org/node/751826)。不要忘记它是针对 Drupal 6 的。

如果您想在特定页面中显示表单（例如 /myform），您必须使用 hook_menu() 来注册您的路径。然后，只要您有 drupal_get_form 作为回调函数，您就不必打印/回显表单。

建立表单的最简单方法是将 PHP 代码放在一个块中（没有人说它更容易 - 只是我的想法。）您不需要参数来**构建**表单。

```
function test_myform(){
$form['description'] = array(
    '#type' => 'item', 
    '#title' => t('A form with nothing but a textfield'),
  );
  // This is the first form element. It's a textfield with a label, "Name"
  $form['name'] = array(
    '#type' => 'textfield', 
    '#title' => t('Name'),
  );
  return $form;
} 
```

现在你有了一个可以从 test_myform() 调用的表单数组。酷吧？

使用它来显示表单。

```
return drupal_get_form('my_form'); 
```

然后您会看到这与您已经尝试过的代码相同。这就是版本有用的地方。这在 D6 中有效，但在 D7 中不再有效。现在试试这个：

```
return drupal_render(drupal_get_form('my_form')); 
```

看 ？

请注意，此代码将在 php 块中使用。不建议启用 php 过滤器模块，但您必须这样做才能获取表单。

最好的方法是定义自己的块或菜单回调来获取表单。请参阅[http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_menu/7](http://api.drupal.org/api/drupal/modules!system!system.api.php/function/hook_menu/7)了解如何注册路径。现在，请注意，您需要使`test_myform()`函数接受参数作为代码。页面回调应该是 drupal_get_form 并且不需要`drupal_render()`获取显示的表单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:12:47.933

你实际上并没有输出任何东西。您在函数中创建`$form`数组或对象并返回它，但您不会在任何其他代码中回显或输出任何内容。

更新

快速查看此函数的文档似乎表明该函数返回了表单标记。因此，如果您省略了测试页面功能，请尝试以下操作：

```
echo drupal_get_form('test_myform'); 
```

基本上，`drupal_get_form`是返回表单内容，并由您以某种方式输出它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:25:25.033

希望这可以帮助：

```
更改功能行如下：
function test_myform() { //如果不使用，则无需添加任何参数

其次，要么使用下面的行直接打印表格
打印 drupal_get_form('test_myform');

或者使用函数返回表单html并打印
打印 test_page();

```

# c# - 在 .NET 中作为 TrustedInstaller 运行进程

> ID：10623364
> 
> 赞同：1
> 
> 时间：2012-05-16T17:10:26.897
> 
> 标签：c#, .net, vb.net

`TrustedInstaller`有没有一种方法/API 可以在 .NET的服务下运行进程？

我不想使用像[devxexec](http://developex.com/custom-software/devxexec.html)这样的命令行工具。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:14:58.413

我认为任何设置和部署项目/流程都将被视为 TrustedInstaller。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T20:31:19.953

进一步阅读 DevXExec 页面 - 他们大致了解了他们的策略。

1.  获取现有进程的令牌 - `OpenProcessToken`。
2.  复制它 - `DuplicateTokenEx`。
3.  修改副本的会话 id - `SetTokenInformation`.
4.  使用复制的令牌创建一个新进程 - `CreateProcessAsUser`。

所有这些 Win32 API 都是 PInvoke'able - 在 MSDN 上做的一堆阅读。

# cordova - 集成相机时出现错误/警告

> ID：10623365
> 
> 赞同：0
> 
> 时间：2012-05-16T17:10:37.490
> 
> 标签：cordova, sencha-touch, extjs, sencha-touch-2

为什么我会收到此错误/警告

```
[INFO] Error in success callback: Camera1 = TypeError: Result of expression 'image1' [undefined] is not an object. 
```

**`Use`注意：当我单击按钮从相机拍照后，我收到此错误/警告**

我的代码如下；我直接从 PhoneGap 文档中复制了它。但是为什么这个错误仍然存​​在？

```
 navigator.camera.getPicture(onSuccess, onFail, { quality: 50,
                                       destinationType: Camera.DestinationType.FILE_URI
                                       }); 

           function onSuccess(imageData) {
           var image1 = Ext.getCmp('myImageId');
           image1.setSrc("data:image/jpeg;base64," + imageData);
           }

           function onFail(message) {
           alert('Failed because: ' + message);
           } 
```

**代码**

这称为 Image.js 及其视图。我也需要在屏幕上显示图像

```
Ext.define('app.view.Image',{

           extend:'Ext.Panel',

           xtype:'myImageId',

           id:'myImageId',

           config: {

           title:'Image',

           fullscreen: true,

           scrollable: false,

           } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:14:00.047

> 表达式 'image1' [undefined] 的结果不是对象。

它表明你的 " `image1`" 不是一个对象。即你在那个变量中的任何东西都不是一个对象。它的价值是`undefined`。

只需确保您在代码中获得对适当`image`组件`SenchaTouch`的引用，然后将其引用`image1`

# javascript - 更改按钮文本 jQuery

> ID：10623366
> 
> 赞同：2
> 
> 时间：2012-05-16T17:10:38.677
> 
> 标签：javascript, jquery, html, button, text

我遇到了一个奇怪的问题，我无法使用 jQuery 更改按钮的显示文本。这个想法是能够在密码<=>文本之间切换一个字段，并带有一个关联的按钮，其文本在“显示”和“隐藏”之间切换。

这是按钮：

```
<input type="button" id="login-form-showchars" value="Show" onclick="showCharsClicked();"/> 
```

这是 showCharsClicked 函数：

```
function showCharsClicked() {
var passwordField = document.getElementById("login-form-password");
if (passwordField.type == "password") {
    passwordField.type = "text";
    //TODO: change text of button to 'Hide'
} //if
else {
    passwordField.type = "password";
    //TODO: change text of button to 'Show'
} //else
passwordField.value = value;
} //showCharsClicked 
```

该功能有效，但无论我将什么代码插入 TODO 区域，按钮上的文本都保持不变。我已经尝试了以下所有“输入”和“按钮”类型：

```
document.getElementById('login-form-showchars').value = 'Hide';
$("#login-form-showchars").prop('value', 'Hide');
$("#login-form-showchars").html('Hide');
$("#login-form-showchars").attr('value', 'Hide');
$("#login-form-showchars").val('Hide');
$("#login-form-showchars").text('Hide'); 
```

有谁知道可能出了什么问题？通过检查按钮，我看到它的值正在发生变化，但这种变化永远不会在视觉上反映出来。

谢谢！

# =====================================

编辑：我找到了一种让它工作的方法，并认为我会在这里记录它以供后代使用。感谢您的所有回答，我现在认为问题是由于我的程序使用的特定 jQuery 界面引起的；这就是为什么它对很多其他人有效，但对我无效。

问题是程序在运行时在按钮下方创建了一些嵌套的“span”标签，因此在程序执行期间它看起来像这样：

```
<a data-role="button" href="#" id="login-form-showchars" data-theme="v" class="ui-btn ui-btn-corner-all ui-shadow ui-btn-up-v" data-transition="pop" data-direction="reverse">
  <span class="ui-btn-inner ui-btn-corner-all">
     <span class="ui-btn-text">Hide</span>
  </span>
</a> 
```

当我试图编辑按钮的值时，真正需要改变的是按钮的'span class="ui-btn-text"'标签内的文本。

我将按钮声明更改为：

```
<a data-role="button" href="#" id="login-form-showchars">Show</a> 
```

以及函数内部的命令：

```
$("#login-form-showchars .ui-btn-text").text("Hide"); 
```

这很好用。希望这可以帮助某人不必经历我所做的事情！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:23:43.933

使用您的代码似乎可以正常工作

`document.getElementById('login-form-showchars').value = 'Hide';` `document.getElementById('login-form-showchars').value = 'Show';`

确切的演示显示/隐藏密码 + 切换按钮文本以显示/隐藏
[源](http://jsbin.com/evinev/2/edit#javascript,html,live)| [演示](http://jsbin.com/evinev/2/edit#preview)

浏览器问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:24:40.693

```
$('#login-form-showchars').on('click', function() {
  var target = $('#login-form-password'),
      $this = $(this);
  target.attr('type', function(i, oldType) {
     this.type = oldType == 'password' ? 'text' : 'password';
     $this.val(this.type == 'text' ? 'Hide' : 'Show');
  });
}); 
```

**[工作演示](http://jsfiddle.net/thesystemrestart/yH27g/1/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:25:23.983

这会是你想要的吗？

```
$('#login-form-showchars').click(
    function(e){
        var typ = $('#inp').attr('type');
        $('#inp')[0].type = typ === 'password' ? 'text' : 'password';
        this.value = (typ === 'password' ? 'Hide' : 'Show');
    }
)​; 
```

看到这个[jsfiddle](http://jsfiddle.net/KooiInc/HVGHf/)

# c# - 你如何从命令行调用多个文件到你的应用程序中？

> ID：10623370
> 
> 赞同：6
> 
> 时间：2012-05-16T17:10:57.020
> 
> 标签：c#, windows, command-line, registry

我正在向 Windows 注册表添加一个上下文菜单项，因此当我单击一个文件时，我可以调用我的应用程序并将该文件设置为我的应用程序作为 arg。但是，如何将多个文件发送到我的应用程序（我选择的所有文件）？

现在我的命令为：

```
"C:/test.dll" "%1" 
```

但这似乎分别调用了每个文件。输入我选择的所有文件的命令是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:29:29.200

使用“%*”将所有元素从命令行传递到另一个应用程序。

# javascript - 在 iframe 中中断 JS

> ID：10623371
> 
> 赞同：0
> 
> 时间：2012-05-16T17:10:58.377
> 
> 标签：javascript, iframe, qunit

我正在创建一个基于 QUnit 的自动化测试框架，如果测试时间过长（超时），我希望能够终止测试。现在，我当前的实现非常简单：在测试开始时，我设置了一个计时器并等待。如果到那时测试尚未完成，我将其标记为失败并重新加载`<iframe>`正在运行的测试。

如果它正在等待 AJAX 调用，或者异步测试永远不会返回，这将非常有用。但是，该`setTimeout`函数将始终在当前执行线程之后运行，因此如果测试进入无限循环，或者在其标准执行中花费的时间过长，它不会真正停止它，而是坐下来等待它的转动而不打断它。**有没有办法取消子代码`<iframe>`（在同一个域中）中的代码执行，即使它卡在循环中？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:16:01.800

在父窗口中定义您的计时器 - 当 IFrame 加载时，让它在父窗口中启动计时器 - 当计时器用完时，让父窗口重新加载 IFrame。

在您的父页面中

```
<script> 

function startTimer(duration) {     
    setTimeout("timedOut()",duration);
} 

function timedOut() {
       // handle time out
}

</script>  

<iframe id=myFrame></iframe> 
```

在您的 IFrame 中

```
<script> 
    parent.startTimer(duration);
</script> 
```

每个页面都在不同的线程上运行，因此它*应该*适合您，但是有些事情会锁定整个浏览器系统（无限循环/无限递归），您必须让任务管理器参与其中以重新启动浏览器，但它应该涵盖大部分情况。

# excel - 在 Excel 中查找 2 列中的数据之间的差异

> ID：10623373
> 
> 赞同：0
> 
> 时间：2012-05-16T17:11:19.597
> 
> 标签：excel, vba

我的数据集如下所示：

col1：1,4,5,6,24,6

col2：1,5,4,2,45,6

我想找到：

(col1[0] - col2[0]) 然后粘贴到 col3[0]

然后

(col1[1] - col2[1]) 然后粘贴到 col3[1]

大约 4000 个条目，直到没有更多的值。

我将如何在 excel 中使用宏或 VB 来做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:28:01.657

我才刚开始。做这个悉达多的正确方法是什么？

```
Option Explicit

Sub minus()
Dim lastRow As Integer, i As Integer
lastRow = 7

With ActiveSheet
For i = 1 To lastRow
Range("C" & i).Formula = "=A" & i & "-B" & i
Next i

End With
End Sub 
```

# codeigniter - 带有加密 URL 的 CodeIgniter

> ID：10623374
> 
> 赞同：2
> 
> 时间：2012-05-16T17:11:20.750
> 
> 标签：codeigniter, url, encryption

我想为我的项目使用 codeigniter 框架，但我不希望它可读，所以我必须像这样加密 url：

> [http://myproject.com/index.php/indexcontroller/myaction/](http://myproject.com/index.php/indexcontroller/myaction/)

进入：

> [http://myproject.com/as79d8a7sd9a8sd7a98d7a9s8d790akmwmwm97aw](http://myproject.com/as79d8a7sd9a8sd7a98d7a9s8d790akmwmwm97aw)

我不知道如何实现这种情况。如何调用控制器和方法以及如何执行。请指导我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:29:05.390

这听起来像是[URI 路由](http://codeigniter.com/user_guide/general/routing.html)的工作！

将此添加到您的`config/routes.php`：

```
$route['(:any)'] = "MyController/MyFunc/$1"; 
```

现在当你去：

```
http://myproject.com/as79d8a7sd9a8sd7a98d7a9s8d790akmwmwm97aw 
```

它将被“重定向”到：

```
http://myproject.com/MyController/MyFunc/as79d8a7sd9a8sd7a98d7a9s8d790akmwmwm97aw 
```

从那里，您可以“解码” URL，并重定向到您想去的地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:30:11.273

你可以通过玩来解决这个问题：application/config/routes.php

```
$route['(:any)'] = "controller/myaction/$1"; 
```

有关更多信息 [URI 路由文档](http://codeigniter.com/user_guide/general/routing.html)

# c++ - 在 DLL 中打开共享文件

> ID：10623378
> 
> 赞同：1
> 
> 时间：2012-05-16T17:11:43.137
> 
> 标签：c++, windows, file, dll, shared-memory

我正在使用 Windows Hooks 制作键盘记录器。代码位于 DLL 中。键入的字符将写入文件。但是问题是，除了焦点在我的应用程序窗口上的字符之外，没有字符被记录到文件中。FILE * 已在共享内存段中声明。

```
 #pragma data_seg("SHARED")
    .
    .
    FILE* iFile = NULL;
    #pragma data_seg() 
```

如果我在钩子函数中打开文件，一切似乎都很好。

```
 EXPORT LRESULT CALLBACK KHookProc(int nCode, WPARAM wparam, LPARAM lparam)
    {
                    .
                    .
                    .
        iFile =  fopen("c:\\games\\log.txt","a+");
        fwrite((char *)(&c),1,1,iFile);
        fclose(iFile);

    }
} 
```

如果我在设置钩子（所有进程通用）时打开它，除了我的应用程序击键被捕获。

```
EXPORT void SetKBHook()
{
if(hhook==NULL)
{   
    hhook = SetWindowsHookEx(WH_KEYBOARD,(HOOKPROC)KHookProc,g_hinstance,NULL);
    if(hhook == NULL)
    {
        DWORD err = GetLastError();
        err;
    }

    iFile =  fopen("c:\\games\\log.txt","a+");
}
} 
```

帮助。任何人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:19:38.157

我建议不要将 FILE 指针放在共享内存段中，而是建议挂钩的每个实例使用命名互斥锁分别写入文件，以确保它们不会相互破坏。如果你想变得花哨（可能提高性能），你可以创建一个单独的日志进程，它接收来自钩子的输入，除了写入文件之外什么都不做。

我忽略了您正在编写键盘记录器的面孔，因为这实际上更多是关于多进程挂钩的问题。请不要对键盘记录器做任何邪恶的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:43:20.680

虽然指针变量可以在进程之间共享（如果您将正确的参数传递给链接器），但 FILE* 指向的堆分配数据结构和底层 Win32 文件句柄（以及相关的内核模式文件对象) 是共享的。

您最好在单个进程（启动键盘记录器的进程）中打开文件句柄，然后使用 IPC 机制将数据传输回该进程，然后该进程将处理（正确同步的）写入。

这对于任何类型的合法键盘记录目的都可以正常工作，并且可以避免很多令人头疼的尝试将文件句柄共享到您没有启动自己的进程中......更不用说同步忧郁，如果您成功完成第一个任务。

# rendering - 如何使用 povray 渲染 3d 刚性物体的运动

> ID：10623387
> 
> 赞同：1
> 
> 时间：2012-05-16T17:12:33.563
> 
> 标签：rendering, mesh, povray, rigid-bodies

我运行了几个对象的刚体模拟，我想使​​用 povray 渲染这个模拟。

对象的网格保持不变，所改变的只是每个对象的位置和方向。在 povray 中迭代生成电影图像的最佳方法是什么？我可以在每次迭代中编写一个完整的 pov 文件，然后将它们全部发送到 povray，但由于每个网格非常大，我希望只编写一次。可能吗？

如果有更好的方法可以做到这一点，请告诉我......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-17T02:15:51.820

使用 #define 将网格写入 inc 文件并为其命名。在您的主 .pov 文件中，您应该能够定义包含旋转和平移的数组或样条线，然后使用时钟变量对其进行索引并渲染动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T15:09:45.163

这是一种充实 David Buck 建议的方法，使用单个 .pov 文件，呈现为动画。

```
#include "transforms.inc"
#declare myOriginalObj = /* you do the work here, with mesh aligned to "y axis"*/
#declare newDirection =  /* you do the work here: make new alignment vector,
     as a function of clock  */
#declare newPosition =   /*you do the work here: create vector for new position,
     as a function of clock  */
#declare newObj=object{
    myOriginalObj
    Reorient_Trans(y,newDirection)
    translate newPosition
    }
object{newObj} 
```

进一步阅读： http: [//povray.tashcorp.net/tutorials/dd_makesnow/](http://povray.tashcorp.net/tutorials/dd_makesnow/)

# java - 用数据库值覆盖 Spring:message 标记

> ID：10623388
> 
> 赞同：10
> 
> 时间：2012-05-16T17:12:34.640
> 
> 标签：java, spring, properties, messages

我正在使用 Spring 来显示来自属性文件的消息。我希望能够覆盖`<spring:message>`标签以使用基于登录用户的数据库中的值。如果此值不存在，我希望它像现在一样默认为属性文件中当前的值。

有人可以帮我处理这段代码吗？我读过关于 AbstractMessageSource 但我不清楚如何实现它。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-16T17:54:36.663

您必须实现自定义消息源。它是一个扩展`AbstractMessageSource`和实现抽象`resolveCode(java.lang.String, java.util.Locale)`方法的类。关于 SO（它是 Grails 的解决方案）几乎有[相同的问题](https://stackoverflow.com/questions/8100312/grails-i18n-from-database-but-default-back-to-file)，但我认为从...开始是个好主意

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T21:56:54.660

我最终创建了一个名为 DatabaseMessageSource 的类，包含在下面。我仍然需要实现某种缓存，这样我就不会在每次调用时都访问数据库。这个[链接](http://graemerocher.blogspot.com/2010/04/reading-i18n-messages-from-database.html)也很有帮助。感谢 skaffman 和 PrimosK 为我指明了正确的方向。

```
public class DatabaseMessageSource extends ReloadableResourceBundleMessageSource {

    @Autowired
    private MyDao myDao;

    protected MessageFormat resolveCode(String code, Locale locale) {

        MyObj myObj = myDao.findByCode(code);

        MessageFormat format;

        if (myObj!= null && myObj.getId() != null) {

            format = new MessageFormat(myObj.getValue(), locale);

        } else {

            format = super.resolveCode(code, locale);

        }

        return format;

    }

    protected String resolveCodeWithoutArguments(String code, Locale locale) {

        MyObj myObj = myDao.findByCode(code);

        String format;

        if (myObj != null && myObj.getId() != null) {

            format = myObj.getValue();

        } else {

            format = super.resolveCodeWithoutArguments(code, locale);

        }

        return format;

    }

} 
```

我更新了我的 applicationContext 以指向新创建的类。我将其更改为：

```
<bean id="messageSource" class="com.mycompany.mypackage.DatabaseMessageSource">
    <property name="basenames">
        <list>
            <value>classpath:defaultMessages</value>
        </list>
    </property>
    <property name="defaultEncoding" value="UTF-8"/>    
</bean>`enter code here` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T18:01:50.120

您无需更改 的行为`<spring:message>`，只需更改它从中获取消息的位置。

默认情况下，它`messageSource`在上下文中使用 bean，它是 type`MessageSource`或其某个子类。您可以编写自己的类来实现并将其作为bean`MessageSource`添加到您的上下文中。`messageSource`

`AbstractMessageSource`只是编写自己的`MessageSource`. 它为你做了一些工作，只是子类化它。

# android - 如何知道该设备是 Galaxy Note（或任何其他特定的手机型号）

> ID：10623392
> 
> 赞同：0
> 
> 时间：2012-05-16T17:12:51.327
> 
> 标签：android, galaxy, imei

我正在创建一个使用 SPen sdk 的应用程序。sdk 仅兼容 Galaxy Note。我想在运行时知道运行我的应用程序的手机是否是 Galaxy Note，如果是，我想使用 SPen SDK 类，否则我想使用 Simple Canvas。**有什么方法可以确保手机是 Galaxy Note 。**

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:36:15.780

S Pen SDK 有一个方法：

SDrawLibrary.isSupportedModel()

如果它是受支持的设备，它应该返回 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:29:27.573

您可能应该避免专门检查该设备是否是 Galaxy Note。很可能还有其他三星设备支持笔，您的​​应用程序可能支持得很好。

最好检查一下 1) 设备是否有手写笔，以及 2) 是由三星制造的。只有当这两个都为真时，您才会使用三星的 SDK 调用。

Google 的 Dianne Hackborn 在此线程中讨论了如何检查 1)：

[https://groups.google.com/d/msg/android-developers/2Lckyn8-B8M/EGo00XPhXewJ](https://groups.google.com/d/msg/android-developers/2Lckyn8-B8M/EGo00XPhXewJ)

至于如何判断设备是不是三星制造的，可以这样查看BUILD值：

```
/**
 * Returns TRUE if the current device is built by Samsung.
 * 
 * @return
 */
public static boolean isSamsung() {
    return ( "samsung".equalsIgnoreCase(Build.MANUFACTURER)  );
} 
```

其他人会建议您完全远离三星的 SDK，并使用 ICS 中已有的笔事件支持来开发您的应用程序。这将打开您的应用程序以支持来自其他制造商（如 HTC、华硕和联想）的有源触控笔设备。

# asp.net - 向某些用户呈现不使用 CSS 的页面

> ID：10623394
> 
> 赞同：1
> 
> 时间：2012-05-16T17:12:56.430
> 
> 标签：asp.net, caching, gzip

我有一个大问题，我不知道如何解决它。我做了一个结合、缩小、gzip 和缓存我的样式和脚本的类。它工作正常。2 天前，我收到报告说有些人看到的网站没有 CSS。我怎样才能看到完美的网站而有些人却没有？有朋友告诉我，可能是这些人的浏览器不接受gzip。

另一件事可能是，我创建了自己的扩展名（.cssh 和 .jsh），但我随后使用内容类型 text/css 和 text/javascript 进行传输，所以我想这不是问题。

任何帮助都将不胜感激。对不起，我的英语不好 ：/

网站链接：[http ://www.curriculoautentico.com.br](http://www.curriculoautentico.com.br)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T15:29:59.440

我找到了答案。问题在于使用 gzip 进行压缩。我已经对缓存进行了 gzip 压缩，因此拥有不接受 gzip 的浏览器的用户无法看到 css。我必须缓存缩小但不压缩的 CSS 和 JS。

# html - 托管用户上传的视频是否值得？

> ID：10623398
> 
> 赞同：0
> 
> 时间：2012-05-16T17:13:11.610
> 
> 标签：html, video, upload, uploading

我正在编写一个博客平台，理想情况下希望允许用户上传视频以在他们的博客上显示。但是，尽管我已经开发 Web 应用程序多年，但我对视频托管、转换等并不熟悉。我的问题是，这有多难，涉及的成本是多少？有没有简单的方法可以做到这一点？我是否必须编写转换例程并动态创建对象以嵌入到我的 html 中，或者是否有 3rd 方解决方案可以使这更容易？我正在尝试确定这是否可行，或者我是否应该遗憾地只允许嵌入视频。任何输入或入门指南将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:19:21.267

实施您自己的视频托管基础设施很可能会花费比以往任何时候都更多的金钱和时间。一个更好的主意是使用 YouTube 的 API 之类的东西从您的服务器上传视频。使用 API，您可以允许用户将文件上传到您的网站，然后将视频交给 YouTube 并动态生成适当的嵌入代码。

[https://developers.google.com/youtube/2.0/developers_guide_protocol_direct_uploading](https://developers.google.com/youtube/2.0/developers_guide_protocol_direct_uploading)

# widget - 在插件中定义 wordpress 页面，而不是在侧边栏中

> ID：10623401
> 
> 赞同：0
> 
> 时间：2012-05-16T17:13:17.627
> 
> 标签：widget, wordpress

我即将在 wordpress 中编写一个简单的门户网站，因此它将比博客更多的是网站。我将以正常方式创建一些静态页面和菜单。但是，我想以编程方式控制其中一些页面上显示的内容。例如，一页将显示“图书建议”。该页面将填充用户推荐的书籍列表。该列表将从 MySQL 数据库中读取。另一个页面将用于填写表单中的某些字段，这些字段将被提交并保存到数据库中。

我是 wordpress 插件/小部件开发的新手，但我能够在 drupal 中为另一个项目执行此操作。

所以换句话说，我想要的是开发一个插件/小部件，它将生成一些页面的内容。

我希望你能帮助我提供任何建议或参考:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T13:07:08.117

我建议您创建一个插件并使用[简码 API](http://codex.wordpress.org/Shortcode_API) 例如创建两个简码，

```
add_shortcode( 'book-suggestions', 'book_suggestions_function' );
add_shortcode( 'book-suggest', 'book_suggest_func' ); 
```

然后创建一个名为“Book Suggestions”的页面并添加短代码

```
[book-suggestions limit=x type=y hotbooks=0] 
```

当 Book Suggestions 页面呈现时，使用 book_suggestions_function() 的返回值替换短代码 [book-suggestions]。

```
function book_suggestions_function($atts) {

    // Parse $atts to determine limit, type, etc.
    return '<p>Book1</p><p>Book2</p>';
} 
```

显然你从数据库返回数据。

类似地，[book-suggest] 提供一个表单并将数据发布到数据库

# java - 使用 Java 解密 3Des 中的值

> ID：10623402
> 
> 赞同：1
> 
> 时间：2012-05-16T17:13:18.957
> 
> 标签：java, encryption, cryptography, private-key, 3des

我在解密来自使用 3Des 的第三方的值时遇到问题。他们给了我一个密钥、一个加密值、使用的模式以及解密后的值应该是什么，但到目前为止我一直无法弄清楚如何从 a 点到 b 点。我相信问题与他们给我的密钥有关——他们说这是明文密钥，但我认为它仍然需要以某种方式进一步转换。

下面的代码是我最初尝试了解如何解密该值的示例（在这种情况下为 AC9C5A46A63FC9EA）

任何见解将不胜感激。

```
import java.security.spec.KeySpec;
import javax.crypto.Cipher;
import javax.crypto.SecretKey;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.DESedeKeySpec;

public class TripleDes2 {

private static final String UNICODE_FORMAT = "UTF8";
private static final String DESEDE_ENCRYPTION_SCHEME = "DESede";
private static final String CIPHER_ALG = "DESede/ECB/Nopadding"; //assuming no padding
private KeySpec ks;
private SecretKeyFactory skf;
private Cipher cipher;
private byte[] arrayBytes;
private String myEncryptionKey;
private SecretKey key;

public static void main(String args []) throws Exception {
    TripleDes2 td= new TripleDes2();

    String decrypted = td.decrypt("AC9C5A46A63FC9EA");
    System.out.println("expecting: 04286EDDFDEA6BD7");
    System.out.println("found: " + decrypted);
}

public TripleDes2() throws Exception {
    myEncryptionKey = "1032FD2CD64A9D7FA4D061F76B04BFEA";
    arrayBytes = myEncryptionKey.getBytes(UNICODE_FORMAT);
    ks = new DESedeKeySpec(arrayBytes);
    skf = SecretKeyFactory.getInstance(DESEDE_ENCRYPTION_SCHEME);

    cipher = Cipher.getInstance(CIPHER_ALG);
    key = skf.generateSecret(ks);
}

public String decrypt(String encryptedString) {
    String decryptedText=null;
    try {
        cipher.init(Cipher.DECRYPT_MODE, key);
        byte[] encryptedText = encryptedString.getBytes();
        byte[] plainText = cipher.doFinal(encryptedText);
        decryptedText= new String(plainText);
    } catch (Exception e) {
        e.printStackTrace();
    }
    return decryptedText;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:52:27.687

您使用 等 使其变得比您需要的更复杂`SecretKeyFactory`。但主要问题是您没有正确转换十六进制数字。

```
class TripleDES
{

  private final String key;

  public static void main(String... args)
    throws Exception
  {
    TripleDES td = new TripleDES("1032FD2CD64A9D7FA4D061F76B04BFEA");
    String decrypted = td.decrypt("AC9C5A46A63FC9EA");
    System.out.println("expecting: 04286EDDFDEA6BD7");
    System.out.println("found: " + decrypted);
  }

  TripleDES(String key)
  {
    this.key = key;
  }

  public String decrypt(String input)
    throws Exception
  {
    byte[] tmp = h2b(this.key);
    byte[] key = new byte[24];
    System.arraycopy(tmp, 0, key, 0, 16);
    System.arraycopy(tmp, 0, key, 16, 8);
    Cipher cipher = Cipher.getInstance("DESede/ECB/NoPadding");
    cipher.init(Cipher.DECRYPT_MODE, new SecretKeySpec(key, "DESede"));
    byte[] plaintext = cipher.doFinal(h2b(input));
    return b2h(plaintext);
  }

  private static byte[] h2b(String hex)
  {
    if ((hex.length() & 0x01) == 0x01)
      throw new IllegalArgumentException();
    byte[] bytes = new byte[hex.length() / 2];
    for (int idx = 0; idx < bytes.length; ++idx) {
      int hi = Character.digit((int) hex.charAt(idx * 2), 16);
      int lo = Character.digit((int) hex.charAt(idx * 2 + 1), 16);
      if ((hi < 0) || (lo < 0))
        throw new IllegalArgumentException();
      bytes[idx] = (byte) ((hi << 4) | lo);
    }
    return bytes;
  }

  private static String b2h(byte[] bytes)
  {
    char[] hex = new char[bytes.length * 2];
    for (int idx = 0; idx < bytes.length; ++idx) {
      int hi = (bytes[idx] & 0xF0) >>> 4;
      int lo = (bytes[idx] & 0x0F);
      hex[idx * 2] = (char) (hi < 10 ? '0' + hi : 'A' - 10 + hi);
      hex[idx * 2 + 1] = (char) (lo < 10 ? '0' + lo : 'A' - 10 + lo);
    }
    return new String(hex);
  }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:43:20.577

主要问题似乎是使用包含通过 getBytes() 转换为字节数组的十六进制数据的字符串。

要将十六进制字符串转换为其字节数组表示，您需要一个外部库，例如[apache.commons.codec.binary](http://commons.apache.org/codec/download_codec.cgi)：

```
 myEncryptionKey = "1032FD2CD64A9D7FA4D061F76B04BFEA";
 arrayBytes = Hex.decodeHex(myEncryptionKey.toCharArray()); 
```

# c# - 我在使用 LINQ 中的 SQL 查询时遇到问题

> ID：10623403
> 
> 赞同：1
> 
> 时间：2012-05-16T17:13:20.390
> 
> 标签：c#, asp.net, sql, sql-server, linq

我正在尝试提出一个 LINQ 查询，它将返回命中次数最多的第一行，然后是按日期 desc 排序的其余行。这可以在 SQL 中完成还是我需要 2 个单独的查询？我的表看起来与此类似。

后端：SQL Server 2008

表名称：产品

产品ID 产品名称 命中日期 添加

1 咖啡 600 2012年 5 月
2 日 2 香草 800 2012 年 4 月 19 日
3 巧克力 3000 2012 年 3 月 25 日
4 奥利奥 200 2012 年 2 月
10 日 5 希思 250 2012年 5 月 13
日 6 果子露 550 2012年 4 月 20
日 7 摩卡2000 2012 年 3 月 22 日

我希望查询的结果可以这样返回：（巧克力首先 - 基于点击，其余 - 按日期降序排列）

3 巧克力 3000 2012 年 3 月 25 日
5 希思 250 2012年 5 月 13
日 1 咖啡 600 2012年 5 月 2 日
6 果子露 550 2012年 4 月
20 日 2 香草 800 2012 年 4 月 19 日
7 摩卡 2000 年3 月 22 日 2012
4 奥利奥200 2012 年 2 月 10 日

任何帮助将不胜感激。我是 LINQ 菜鸟。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:24:55.777

```
int maxHits = Products.Max( p => p.Hits );

var query = Products.OrderByDescending( 
                p => p.Hits == maxHits ).ThenByDescending( p => p.DateAdded ); 
```

# php - 为什么我的 Wordpress 小部件没有保存？

> ID：10623404
> 
> 赞同：0
> 
> 时间：2012-05-16T17:13:50.180
> 
> 标签：php, wordpress, wordpress-theming

我有一个使用 XWidgets 插件的 3.3 Wordpress 安装。小部件（尤其是文本小部件）不会保存新实例，Wordpress 在侧边栏中显示默认小部件。

显然，这是一个普遍存在的问题，并且与在小部件 ID 中使用大写字符有关。我发现的最佳解决方法（[http://core.trac.wordpress.org/attachment/ticket/6949/widget_id.diff](http://core.trac.wordpress.org/attachment/ticket/6949/widget_id.diff)）是让widgets.php 文件全部包含小写。上面的链接包含一个补丁。据我了解，我不再希望 widgets.php 检查 id 是否全部为小写。

不幸的是，我不知道如何实施补丁。它只是注释掉以“$id =”开头的行吗？我可以使用 Notepad++ 编辑文件并通过 FTP 访问。

下面是来自 widgets.php 的代码：

```
function wp_register_sidebar_widget($id, $name, $output_callback, $options = array()) { 
global $wp_registered_widgets; 

$id = strtolower($id); 

if ( empty($output_callback) ) { 
unset($wp_registered_widgets[$id]); 
return; 

function wp_register_widget_control($id, $name, $control_callback, $options = array())     { 
global $wp_registered_widget_controls; 

$id = strtolower($id); 

( empty($control_callback) ) { 
unset($wp_registered_widget_controls[$id]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T09:50:27.553

注意：此补丁所指的票证 ( [#6949](http://core.trac.wordpress.org/ticket/6949) ) 已在 4 年前集成到 WordPress 中，因此您不太可能需要应用该补丁。

要手动应用[补丁](http://core.trac.wordpress.org/attachment/ticket/6949/widget_id.diff)，请添加绿线（某些补丁有需要删除的红线）。如果您对命令行感到满意，那么您可以使用[patch 命令](http://en.wikipedia.org/wiki/Patch_%28Unix%29)自动执行此操作。

# php - MySQLi 在 PHP 中准备更新语句

> ID：10623405
> 
> 赞同：7
> 
> 时间：2012-05-16T17:13:50.450
> 
> 标签：php, sql, mysqli, xss

您如何编写准备好的更新语句？参考：[mysqli::prepare](http://php.net/manual/en/mysqli.prepare.php)

我已经尝试按照描述编写它：

```
 if ($stmt = $mysqli->prepare("UPDATE tblFacilityHrs SET title =? description = ? WHERE uid = ?")){
            $stmt->bind_param('sss', $title, $desc, $uid2);

            //Get params
            $title=$_POST['title'];
            $desc=$_POST['description'];
            $uid2=$_GET['uid'];     

$stmt->execute();
            $stmt->close();
    }
    else {
        //Error
        printf("Prep statment failed: %s\n", $mysqli->error);
    } 
```

错误：

> Prep 语句失败：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 'description = ? 哪里 uid = ？在第 1 行编辑的行。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-16T17:16:12.523

您只是在设置的列之间缺少一个逗号：

```
UPDATE tblFacilityHrs SET title = ?, description = ? WHERE uid = ?
                                ^^^^^^ 
```

当 MySQL 报告错误时，例如*检查手册以了解在 'something 附近使用的语法*，最常查看紧接在*'something*之前的字符，因为那是您的错误发生的地方。

注意：您可能需要`bind_param()`在设置输入变量之后而不是之前调用。我不记得 MySQLi 如何解析它们以及它们何时被绑定，但从逻辑上讲，在代码中先设置它们然后再绑定更有意义。

```
//Get params
$title=$_POST['title'];
$desc=$_POST['description'];
$uid2=$_GET['uid'];   

$stmt->bind_param('sss', $title, $desc, $uid2); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:17:30.353

您可能需要添加逗号：

```
$stmt = $mysqli->prepare("UPDATE tblFacilityHrs SET title = ?, description = ? WHERE uid = ?" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T17:18:01.023

您在将参数分配给变量之前绑定参数：

```
$title=$_POST['title'];
$desc=$_POST['description'];
$uid2=$_GET['uid']; 

$stmt->bind_param('sss', $title, $desc, $uid2); 
```

**编辑**：从头开始，在定义变量之前或之后是否绑定参数似乎没有区别（您每天都会学到新东西！），但就像迈克尔说的那样，从逻辑上讲，定义它们是有意义的第一的。

# php - PHP：gethostbyname 错误

> ID：10623408
> 
> 赞同：6
> 
> 时间：2012-05-16T17:13:59.673
> 
> 标签：php, ip, gethostbyname

我`gethostbyname()`用来获取应用程序中域的 IP 地址。

在某些情况下，还会检查诸如“50.9.49”之类的无效地址。

```
echo gethostbyname('50.9.49'); // returns 50.9.0.49 
```

在这种情况下`gethostbyname`应该返回 false 或未修改的无效 ip 地址。但是函数返回修改后的 IP 地址`50.9.0.49`。

看起来像 php 中的一个错误。快速修复似乎是之前检查无效的数字地址，还有其他建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T17:38:21.220

PHP`gethostbyname`实际上[使用](http://gcov.php.net/PHP_5_4/lcov_html/standard/dns.c.gcov.php)底层操作系统的结果`gethostbyname`，例如来自 Linux`netdb.h`或 Windows 的结果`Winsock2.h`。真正产生返回值的是那些函数，而不是 PHP。

```
/* {{{ php_gethostbyname */
static char *php_gethostbyname(char *name)
{
    struct hostent *hp;
    struct in_addr in;

    hp = gethostbyname(name);

    if (!hp || !*(hp->h_addr_list)) {
        return estrdup(name);
    }

    memcpy(&in.s_addr, *(hp->h_addr_list), sizeof(in.s_addr));

    return estrdup(inet_ntoa(in));
}
/* }}} */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T17:39:12.840

似乎这是 IP 如何工作的未记录功能。正如您问题的评论中提到的那样，`ping 50.9.49`在 Windows 中实际上是 pings `50.9.0.49`。如果您输入一个地址`a.b.d`，它会自动插入一个零作为`c`：`a.b.0.d`。如果您只是输入`a.d`，则会插入两个零：`a.0.0.d`。

这已经在 Windows 7 和 Debian Linux 上进行了测试。

# plugins - 使用Phonegap-BarcodeScanner-Plugin 不带相机扫描现有图片

> ID：10623410
> 
> 赞同：0
> 
> 时间：2012-05-16T17:14:12.873
> 
> 标签：plugins, cordova, barcode, barcode-scanner

是否有可能以这种方式修改PhoneGap-BarcodeScanner-Plugin（在我的情况下适用于iOS），它可以扫描来自iPhone-Photolibrary的现有图片而不是用相机拍摄的照片？

由于它会拍照并在拍摄后扫描，因此应该非常容易。但我不是 object-c-speaker，所以，看这段代码，我什么都不懂:(

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:02:08.643

好吧，对不起，但我认为不可能从电话库中扫描现有图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T05:31:10.837

您可以通过将 ZBarSDK 添加到您的项目来做到这一点

这是它的[下载链接](http://sourceforge.net/projects/zbar/files/iPhoneSDK/ZBarSDK-1.2.dmg/download)

[在此处](http://zbar.sourceforge.net/iphone/sdkdoc/picker.html)查看文档

# jquery - 如何使用 jQuery 控制移动浏览器的滚动行为？

> ID：10623413
> 
> 赞同：1
> 
> 时间：2012-05-16T17:14:35.020
> 
> 标签：jquery, mobile, scroll, swipe

我正在制作一个使用向左滑动和向右滑动手势来切换触摸设备上的对象的画廊。当用户似乎正在尝试滑动时，我需要禁用页面滚动并在很明显这是用户希望的情况下启用页面滚动。

禁用页面滚动以提供更好的滑动体验非常简单。我只是使用`preventDefault()`并存储坐标以供将来使用：

```
this.touchMove = function( event )
{
    event.preventDefault();

    this.finalCoord.x = event.targetTouches[0].pageX;
    this.finalCoord.y = event.targetTouches[0].pageY;

}; 
```

问题是当用户通过某些公差时能够重新启动滚动。关键困难是在相同的触摸事件中执行此操作。

这是我让它工作的最接近的方法，但它会导致滚动不顺畅，并且（可能）阻止用户查看 URL 栏：

```
this.touchMove = function( event )
{
    event.preventDefault();

    this.finalCoord.x = event.targetTouches[0].pageX;
    this.finalCoord.y = event.targetTouches[0].pageY;

    var changeY = this.originalCoord.y - this.finalCoord.y;

    if (changeY > this.config.threshold.y || changeY < ( this.config.threshold.y * -1 ) )
    {
        var move = window.pageYOffset + changeY;

        window.scrollTo( 0, move );
    }
}; 
```

我尝试过但没有奏效的事情：

1.  有条件地调用`preventDefault()`. 这是最明显的，但不幸的是，一旦调用 preventDefault 似乎没有办法否定它。
2.  使用`stopPropigation()`. 这不会阻止页面滚动。
3.  使用`return false`. 这也不会阻止页面滚动。
4.  使用 3D CSS 变换来执行滚动。实际上，这有可能，但也引起了一些令人头疼的行为。
5.  附加透明覆盖`div`以劫持事件。添加`div`工作正常，但它不会劫持事件。

有没有办法完成我想要做的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T13:56:50.847

我通过[对另一个问题的评论找到了](https://stackoverflow.com/a/8107060/819538)[touchSwipe 插件](http://labs.skinkers.com/touchSwipe/)。通过查看该代码，这似乎是我尝试应用的方式的逻辑问题。`preventDefault()`

无论如何，该插件非常适合我的需求。

# php - PHP 和 ZIP 创建：可以应用标准 zip“选项”

> ID：10623415
> 
> 赞同：4
> 
> 时间：2012-05-16T17:14:45.883
> 
> 标签：php, zip, options

有谁知道在创建 zip 文件时如何使用 PHP ZIP 函数来应用标准**zip** “**选项”。**到目前为止，我所有的搜索都没有发现任何东西。

特别是我对应用“ **-ll** ”和“ **-l** ”选项感兴趣，这样我就可以从 nix 网站提供基于压缩文本的文件（ *cgi 和 php 和文本文件等*）的WIN 或 NIX 版本。内容将被即时压缩，其中包含为每个特定客户添加的一些文件。

我知道构建和使用命令行'back-ticked'（*Perl*）或“passthru（。）”（*php*）方法，但我希望有一个使用纯php的技巧，即ZipArchive（）。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T02:19:32.263

您最终可能会退回到 shell_exec 并仅使用本机系统执行 zip，然后您可以根据需要传递 -ll 或 -l 。[http://php.net/manual/function.shell-exec.php](http://php.net/manual/function.shell-exec.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-20T03:00:22.773

我认为 str_replace() 非常明显。但是，这对大文件来说是内存密集型的。

我不会显示所有代码，但是 php 有一个很少使用的功能，您可以将“过滤器”应用于流，并且可以将过滤器指定为文件 url 的一部分。它提供了一种很好的方式来挂钩某些文件系统操作，否则这些操作不会让您轻松调整行为。

一旦你用[stream_filter_register](http://www.php.net/stream_filter_register) () 定义了一个过滤器，那么你应该能够将一个文件 url 传递`php://filter/string.to_unix_line_endings/resource=/path/to/the/file.txt`给该`ZipArchive::addFile()`方法。

最终，您也可以只创建一个临时文件，并将文件内容以块的形式复制到其中，然后进行 str_replacing，然后将临时文件名称也传递给`ZipArchive::addFile()`方法。这将更容易编码。

# c++ - Zaber 设备的示例 C++ 代码

> ID：10623417
> 
> 赞同：1
> 
> 时间：2012-05-16T17:14:50.200
> 
> 标签：c++, zaber

看起来[Zaber 设备的串行协议实现起来](http://www.zaber.com/wiki/Manuals/T-NA#Control_Through_The_RS-232_Serial_Port)非常简单，但是有没有可用的 C++ 示例代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-19T18:07:21.437

小心使用 Zaber 协议的陷阱：如果微控制器与 Zaber 电机失去同步，它可能会卡住读取一个数据包的后半部分和下一个数据包的前半部分（您应该使用计时器来检测数据包间计时重置协议状态机的间隙）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:15:09.123

如果您正在编写托管 C++，则可以像在 C# 或 Visual Basic 项目中一样使用我们的 .NET 库 DLL。[您可以通过Zaber 控制台源代码](http://www.zaber.com/wiki/Software/Zaber_Console/Source_Code)找到更多信息。这些示例都在 C# 或 Visual Basic 中，但您可以在托管 C++ 中执行相同的操作。

如果您不编写托管 C++，则必须直接写入串行端口。我们有一些[示例 C 代码](http://www.zaber.com/software/Zaber_C_Win32_Demo.zip)将向您展示如何将命令转换为字节流。此代码段准备六个字节以写入串行端口。

```
txBuffer[0] = deviceNum;
txBuffer[1] = command;
// Position 2 is LSB; Position 5 is MSB
txBuffer[2] = ( data        & 0x000000FF);
txBuffer[3] = ((data >>  8) & 0x000000FF);
txBuffer[4] = ((data >> 16) & 0x000000FF);
txBuffer[5] = ((data >> 24) & 0x000000FF); 
```

此代码段处理从串行端口接收到的六个字节。

```
deviceNum = rxBuffer[0];
command = rxBuffer[1];
// Position 2 is LSB; Position 5 is MSB
data = ( rxBuffer[2]        & 0x000000FF)
     + ((rxBuffer[3] <<  8) & 0x0000FF00)
     + ((rxBuffer[4] << 16) & 0x00FF0000)
     + ((rxBuffer[5] << 24) & 0xFF000000); 
```

您连接到串行端口的方式可能与我们的示例不同，但 C++ 编译器文档应该能够帮助您。下载示例代码以查看更多详细信息，例如在协议不同步时重置协议的计时器。

有关串行通信协议的更多说明，请参见[用户手册](http://www.zaber.com/wiki/Manuals/T-NA#Control_Through_The_RS-232_Serial_Port)。

您也可以使用 C++ 编写[Zaber 控制台脚本](http://www.zaber.com/wiki/Software/Zaber_Console#Scripting_for_non-programmers)，尽管我们尚未创建 C++ 脚本模板。

# iphone - AVQueuePlayer 不播放声音

> ID：10623418
> 
> 赞同：0
> 
> 时间：2012-05-16T17:15:02.277
> 
> 标签：iphone, ios, ipad, audio, avqueueplayer

我似乎无法使用`AVQueuePlayer`. 应用程序编译并运行良好，但是当调用 `imageTouched' 方法时我没有收到任何音频。任何人都可以帮忙吗？

```
-(void) imageTouched
{
    NSString * path1 = [[NSBundle mainBundle] pathForResource:@"sound1" ofType:@"wav"];
    NSString * path2 = [[NSBundle mainBundle] pathForResource:@"sound2" ofType:@"wav"];
    NSURL *url1 = [NSURL fileURLWithPath:path1];
    NSURL *url2 = [NSURL fileURLWithPath:path2];

    AVPlayerItem *firstSound = [AVPlayerItem playerItemWithURL:url1];
    AVPlayerItem *secondSound = [AVPlayerItem playerItemWithURL:url2];

    NSArray *sounds = [NSArray arrayWithObjects:firstSound, secondSound, nil];
    AVQueuePlayer *player = [AVQueuePlayer queuePlayerWithItems:sounds];

    [player play];
    NSLog(@"%d",player.status);

} 
```

**编辑 1：**我检查了文件名（大小写、拼写等）是否有任何问题，但似乎没有。我已经能够使用以下代码播放声音，但我真的需要开始`AVQueuePlayer`工作。请帮忙！

```
NSString *path;
SystemSoundID soundId;
path = [[NSBundle mainBundle] pathForResource:@"sound1" ofType:@"wav"];
NSURL *url = [NSURL fileURLWithPath:path];
AudioServicesCreateSystemSoundID( (CFURLRef)objc_unretainedPointer( url), &soundId);
AudioServicesPlaySystemSound(soundId); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T06:20:00.850

我意识到现在对你来说可能为时已晚，但我怀疑原因是 AVQueuePlayer 正在立即自动释放，所以没有播放声音。试试`[[AVQueuePlayer alloc] initWithItems:sounds]`吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T14:45:23.763

我做了几乎相同的想法，但我没有`AVQueuePlayer *player`在函数中声明，而是在`interface`.

# ruby-on-rails - 向 <%= @quest.text %> 添加一个 css 类

> ID：10623421
> 
> 赞同：0
> 
> 时间：2012-05-16T17:15:37.830
> 
> 标签：ruby-on-rails, css, erb

应该是一个相对简单的问题——我正在尝试在这一行中添加一个 CSS 类（“测验问题”）：

```
<%= @question.text  %> 
```

如果我之后直接添加

```
<%= @question.text :class => "quiz-question" %> 
```

我收到一个参数错误，说明参数数量错误（0 个中的 1 个），我尝试用逗号分隔或将类放在大括号内。在这里包含的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:20:39.957

它不起作用，因为您试图将参数传递给显示的项目。
`@question.text`不是标签、块、助手等。它只是文本。因此，你不能给它上课。

你为什么不做`<span class="quizz-question"><%= @question.text %></span>`？

# haskell - Haskell 如何将 Char 转换为 Word8

> ID：10623424
> 
> 赞同：23
> 
> 时间：2012-05-16T17:15:57.407
> 
> 标签：haskell, bytestring

我想拆分`ByteString`成这样的词：

```
import qualified Data.ByteString as BS

main = do
    input <- BS.getLine
    let xs = BS.split ' ' input 
```

但似乎 GHC 无法自行将字符文字转换为`Word8`，所以我得到了：

```
Couldn't match expected type `GHC.Word.Word8'
            with actual type `Char'
In the first argument of `BS.split', namely ' '
In the expression: BS.split ' ' input 
```

Hoogle 没有找到任何具有类型签名的内容，`Char -> Word8`并且`Word.Word8 ' '`是无效的类型构造函数。关于如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-05-16T17:20:33.187

Data.ByteString.Char8模块允许您将[字节](http://hackage.haskell.org/packages/archive/bytestring/0.9.2.1/doc/html/Data-ByteString-Char8.html)`Word8`字符串中的值视为`Char`. 只是

```
import qualified Data.ByteString.Char8 as C 
```

然后参考例如[C.split](http://hackage.haskell.org/packages/archive/bytestring/0.9.2.1/doc/html/Data-ByteString-Char8.html#g:13)。它在底层是相同的字节串，但`Char`提供了面向 - 的函数以方便字节/ascii 解析。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-19T17:28:47.930

如果您*真的*需要 Data.ByteString（不是 Data.ByteString.Char8），您可以执行 Data.ByteString 本身所做的将 Word8 转换为 Char 的操作：

```
import qualified Data.ByteString as BS
import qualified Data.ByteString.Internal as BS (c2w, w2c)

main = do
    input <- BS.getLine
    let xs = BS.split (BS.c2w ' ') input 
    return () 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-03T16:24:03.563

人们正在寻找一个简单`Char -> Word8`的基础库：

```
import Data.Word

charToWord8 :: Char -> Word8
charToWord8 = toEnum . fromEnum 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-03-09T17:02:23.630

我想直接解决主题行中的问题，这首先导致我来到这里。

您可以使用以下命令将单曲转换为**`Char`**单曲：**`Word8`****`fromIntegral.ord`**

```
λ> import qualified Data.ByteString as BS
λ> import Data.Char(ord)

λ> BS.split (fromIntegral.ord $ 'd') $ BS.pack . map (fromIntegral.ord) $ "abcdef"

["abc","ef"] 
```

请记住，这种转换很容易出现**溢出**，如下所示。如果您不希望发生这种情况，**您**必须确保您**`Char`**适合**8 位。**

```
λ> 260 :: Word8

4 
```

当然，对于您的特定问题，最好使用已接受的答案中已指出的[Data.ByteString.Char8模块。](http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString-Char8.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-11-13T20:07:32.897

另一种可能的解决方案如下：

```
charToWord8 :: Char -> Word8
charToWord8 = fromIntegral . ord
{-# INLINE charToWord8 #-} 
```

在哪里`ord :: Chat → Int`，其余的可以推断。

# c# - 平滑顶点之间的颜色

> ID：10623428
> 
> 赞同：1
> 
> 时间：2012-05-16T17:16:08.060
> 
> 标签：c#, xna-4.0, minecraft

我用 C# XNA 制作了一个类似于我的世界的引擎。它提供了高 fps 并加载了没有 fps 的块，但是当涉及到全局灯光和阴影时 - 我有问题。

基本上 - 在块的模型创建循环中

```
for (i = 0; i < 16; i++) 
{ 
    for(int j = 0; j < chunk_height; j++) 
    { 
        for(int k = 0; k < 16; k++) 
        {
            // check if block (and 4 blocks around 
            // a current one (i, j, k), (i + 1, j, k), 
            // (i - 1, j, k), (i, j, k + 1), (i, j, k -1)) 
            // are covered and put shadows to block face's vertex colors. 
        }
    }
} 
```

结果是老式的 minecraft 风格的阴影：

![](../Images/f61efa12a9cc70c85bf2070c3b4319ac.png)

（在开启垂直同步的情况下，与之前的屏幕截图具有相同的良好性能，*没有它的 fps 为 ~ 350*）

但我正在尝试实现我的世界的阴影、生物群系颜色和光线平滑 ->

我正在使用三角形列表，因为它不可能使用三角形条来处理这些东西。但是在这种情况下，任何立方体面之间的顶点颜色都不平滑。

所以问题是平滑这些顶点。颜色 -s 看起来像我的世界。

我做了一个简单的算法，但它加载 cpu 太难了`(vertices.Count ^ 2 - sized loop)`，所以当你环游世界并计算新加载的块的阴影时，pc 每次都会滞后 1-2 秒，而在 mc 中没有这样的减速。

（我需要平滑算法是实时和运行的，因为主要目标是超越我的世界的性能（在我的世界当前的最小/中等图形中，达到了结果（~ 300 fps 与 minecraft 的 70））

Chunk 的类（主要问题），Helper 类（杂项，在项目中使用），Block 类（Block-Type Base（用于创建和注册块类型），块的模型生成器）：

[http://pastebin.com/GB1QqtdQ](http://pastebin.com/GB1QqtdQ)

PS对不起，如果我的英语不好，那不是我的主要语言。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:05:27.927

您似乎根本没有共享顶点。如果您要使用共享顶点构建地板，您会得到正确的结果。请记住，仅仅因为它是一个三角形列表而不是三角形条并不意味着索引缓冲区不能为两个或多个三角形引用相同的顶点。

# c# - 数据网格组合框控件中的线程错误

> ID：10623431
> 
> 赞同：0
> 
> 时间：2012-05-16T17:16:25.270
> 
> 标签：c#, datagrid

我的项目中有一个 datagrid 控件，它有一个手动填充数据的组合框控件，但是问题是当我尝试在添加新行时编辑此值时，我得到一个线程状态异常：

![数据网格错误](../Images/7be1e33dc7fab13d5db6c952fe710068.png)

程序入口点方法是用STAThread属性设置的，我什至把属性放在用控件调用表单的方法上，还是没有用。有谁知道我该如何解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:36:36.047

> 程序入口点方法是使用 STAThread 属性设置的...

这仅适用于应用程序的主线程。您还必须注意您创建的显示此对话框的线程。例如：

```
 Thread t = new Thread(new ThreadStart(ThreadProc));
    t.SetApartmentState(ApartmentState.STA);
    t.Start(); 
```

如果您没有直接创建线程，则需要更彻底地更改代码。例如，如果您在 Delegate.BeginInvoke() 调用中显示对话框，该线程将是应用程序的默认线程池。由于您无法控制该线程的创建，因此您无法将其创建为 STA 线程。相反，您需要像上面那样创建自己的线程来显示对话框。

# python - 使高斯受 FWHM 约束

> ID：10623448
> 
> 赞同：0
> 
> 时间：2012-05-16T17:17:51.633
> 
> 标签：python, matplotlib, gaussian

首先我的数学有限，所以这个问题可能有一个简单的答案。因此，我使用以下等式来制作高斯分布：

```
height * np.exp( - ((x-mean)/width)**2 ) 
```

当我用上面的方程做 gussians 时，峰的宽度在哪里应用？是全宽半高吗？我用以下值制作了以下高斯：

```
height = 5
mean = 100
width = 10 
```

![在此处输入图像描述](../Images/9fafe5181edd733e380955b31532bcd5.png)

然后当我计算 FWHM 时`16.6510941453`，峰宽不能应用于 FWHM。它应用在哪里？

我试图限制 FWHM，使 FWHM 比平均值小 10 倍。所以在上面的例子中，我希望高斯的 FWHM 为 10，平均为 100，峰值高度为 5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:02:36.647

在您的等式中，宽度参数实际上是`sigma`，这是高斯的标准偏差，而不是 FWHM。以下是在这两个属性之间进行转换的函数

```
from numpy import sqrt, log

def sigma2Gamma(sigma):
    '''Function to convert standard deviation (sigma) to FWHM (Gamma)'''
    return sigma * sqrt(2 * log(2)) * 2 / sqrt(2)

Gamma = sigma2Gamma(10)
print Gamma
# prints 16.651092223153956, which is what you saw in your graph

def Gamma2sigma(Gamma):
    '''Function to convert FWHM (Gamma) to standard deviation (sigma)'''
    return Gamma * sqrt(2) / ( sqrt(2 * log(2)) * 2 )

sigma = Gamma2sigma(10)
print sigma
# prints 6.0056120439322491, which is the standard deviation that will
# give a FWHM of 10 
```

我建议将您的方程式更改为

```
height * np.exp( - ((x-mean)/Gamma2sigma(width))**2 ) 
```

如果你想输入 FWHM 而不是标准偏差

# java - 如何实现内部类？

> ID：10623449
> 
> 赞同：3
> 
> 时间：2012-05-16T17:17:53.777
> 
> 标签：java, inner-classes

在这里，

我有这种情况：

```
public class A{
  //attributes and methods
}

public class B{
  //attributes and methods

}

public class C{
  private B b;
  //other attributes and methods
}

public class D{
  private C c1, c2, c3;
  private List<A> a;
  //other attributes and methods
} 
```

每个类都有自己的文件。但是，我希望将 A、B 和 C 类作为 D 类的内部类，因为我没有在整个程序中使用它们，只是在其中的一小部分中使用它们。我应该如何实施它们？我已经读过它，但我仍然不确定什么是最好的选择：

选项 1，使用静态类：

```
public class D{
  static class A{
    //attributes and methods
  }

  static class B{
    //attributes and methods
  }

  static class C{
    private B b;
    //other attributes and methods
  }

  private C c1, c2, c3;
  private List<A> a;
  //other attributes and methods
} 
```

选项 2，使用接口和实现它的类。

```
public interface D{
  class A{
    //attributes and methods
  }

  class B{
    //attributes and methods
  }

  class C{
    private B b;
    //other attributes and methods
  }

}

public class Dimpl implements D{
  private C c1, c2, c3;
  private List<A> a;
  //other attributes and methods
} 
```

我想知道哪种方法更好，以便使用原始场景获得相同的行为。如果我使用选项 1 并使用这样的类可以吗？

```
public method(){
  List<D.A> list_A = new ArrayList<D.A>();
  D.B obj_B = new D.B();
  D.C obj_C1 = new D.C(obj_B);
  D.C obj_C2 = new D.C(obj_B);
  D.C obj_C3 = new D.C(obj_B);

  D obj_D = new D(obj_C1, obj_C2, obj_C3, list_A);
} 
```

基本上，我关心的是内部类的创建将如何影响外部类。在原始场景中，我首先创建类 A、B 和 C 的实例，然后创建类 D 的实例。我可以用我提到的选项做同样的事情吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T17:20:06.377

如果你只打算在类中使用它们，你没有理由使用接口，因为接口是用来`public`访问的。使用您的第一种方法（并使类**私有**静态）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:16:38.223

内部类有 2 种类型：

1.  静态内部类（称为顶级类）

2.  内部类

静态内部类示例：

```
 public class A {

                static int x = 5;

                int y = 10;

                static class B {

              A a = new A();       // Needed to access the non static Outer class data

              System.out.println(a.y);

              System.out.println(x); // No object of outer class is needed to access static memeber of the Outer class

    } 
```

}

内部类示例：

```
 public class A {

                      int x = 10;

                    public class B{

                      int x = 5;

               System.out.println(this.x);
               System.out.println(A.this.x);  // Inner classes have implicit reference to the outer class

              }
          } 
```

要从外部创建内部类（NOT STATIC INNER CLASS）的对象，首先需要创建外部类对象。

A a = 新 A();

AB b = a.new B();

# java - 从 JDeveloper 运行 Weblogic 并从远程访问

> ID：10623454
> 
> 赞同：2
> 
> 时间：2012-05-16T17:18:14.787
> 
> 标签：java, weblogic, jdeveloper

在 JDeveloper 11.1.1.5.0 中，我可以在我的机器上运行一个应用程序，并且我可以使用 192.168.XXX.XXX:7010/myapp/ 之类的 URL 从连接在同一网络中的另一台机器访问该应用程序。但是在升级到 Jdeveloper 11.1.1.6.0 之后，我失去了这个功能。我可能需要做一些配置。那么如何从 JDeveloper 运行 Weblogic，以便可以从连接在同一网络中的不同机器上查看 localhost(192.168.XXX.XXX)？

我真的很感谢你的帮助。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-17T09:09:45.787

我找到了解决方案。你需要做两件事。

首先从 JDeveloper 运行服务器。转到管理控制台：[http://your.current.address:7101/console](http://your.current.address:7101/console)。使用凭据登录。从域结构树中选择服务器，然后单击您需要配置的服务器并将您的 IP 插入到侦听地址旁边的文本框中。登出。

从 JDeveloper 停止服务器。

从 JDeveloper 转到应用程序服务器属性。要获得此信息，请转到 View->Application Server Navigator。打开树应用程序服务器并右键单击您正在运行并要配置的服务器。就我而言，它的名称是 IntegratedWeblogicServer。从上下文菜单中选择属性。转到配置选项卡。在 Weblogic 主机名字段中输入您的 IP。按确定。

再次运行您的服务器并运行您的应用程序。从连接在同一网络中的不同机器上浏览 URL [http://new.address:7101/AppName 。](http://new.address:7101/AppName)

就这样。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T20:11:08.540

> 我找到了解决方案。你需要做两件事。
> 
> 首先从 JDeveloper 运行服务器。转到管理控制台： [http://your.current.address:7101/console](http://your.current.address:7101/console)。使用凭据登录。从域结构树中选择服务器，然后单击您需要配置的服务器并将您的 IP 插入到侦听地址旁边的文本框中。登出。
> 
> 从 JDeveloper 停止服务器。
> 
> 从 JDeveloper 转到应用程序服务器属性。要获得此信息，请转到 View->Application Server Navigator。打开树应用程序服务器并右键单击您正在运行并要配置的服务器。就我而言，它的名称是 IntegratedWeblogicServer。从上下文菜单中选择属性。转到配置选项卡。在 Weblogic 主机名字段中输入您的 IP。按确定。
> 
> 再次运行您的服务器并运行您的应用程序。从连接在同一网络中的不同机器上浏览 URL [http://new.address:7101/AppName 。](http://new.address:7101/AppName)
> 
> 就这样。:)

我做了所有这些，但我仍然无法连接，但如果我只在浏览器上写 IP，它会说：它可以工作！但不是整个 url，服务器是 windows server 2008 R2 64bit，请帮忙

FORGET IT! I FIXED IT: I ADDED A NEW INBOUND RULE(Control panel), ALLOWING THE PORT 7101 AND 7102 ! TCP, THANKS ANYWAYS! HOPE MY info helps

# servlets - 有没有办法只运行一次 servlet 过滤器？

> ID：10623455
> 
> 赞同：0
> 
> 时间：2012-05-16T17:18:16.363
> 
> 标签：servlets, servlet-filters, web.xml

有没有办法在 中定义`web.xml`某个 servlet 过滤器必须只执行一次？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:21:37.983

不，这`Filter`不是为了。无论`Filter`做什么，都应该由 a[`ServletContextListener`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContextListener.html)代替。

```
@WebListener
public class Config implements ServletContextListener {

    @Override
    public void contextInitialized(ServletContextEvent event) {
        // Do stuff during server startup.
    }

    @Override
    public void contextDestroyed(ServletContextEvent event) {
        // Do stuff during server shutdown.
    }

} 
```

当您还没有使用 Servlet 3.0时，请以旧的方式`@WebListener`将其删除并注册，`web.xml`如下所示：

```
<listener>
    <listener-class>com.example.Config</listener-class>
</listener> 
```

如果您真的坚持使用 a `Filter`，您可能会滥用该`init()`工作的方法并调用`chain.doFilter(request, response)`该`doFilter()`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:21:57.797

一个回合的方法是拥有类变量并在首次访问时设置它，并将所有功能代码放在一个检查这个变量的“if”块中。

# java - 如何使用 Hamcrest 检查双精度数组中的每个元素是否与另一个数组中的每个元素“接近”？

> ID：10623458
> 
> 赞同：12
> 
> 时间：2012-05-16T17:18:43.493
> 
> 标签：java, junit, hamcrest

我想比较两个双打数组。使用香草 JUnit，我可以这样做：

```
double[] a = new double[]{1.0, 2.0, 3.0};
double[] b = new double[]{1.0, 2.0, 3.0};
assertEquals(a, b, 1e-10); 
```

我想知道如何使用 Hamcrest 来做到这一点，最好不要创建自定义匹配器（如果可能的话）。类似于对数组中的每个元素使用“关闭”匹配器。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-16T18:28:40.977

如果您更改`a`为 a`Double[]`那么您可以`assertThat(a, arrayCloseTo(b, .2));`使用此辅助方法：

```
public static Matcher<Double[]> arrayCloseTo(double[] array, double error) {
    List<Matcher<? super Double>> matchers = new ArrayList<Matcher<? super Double>>();
    for (double d : array)
        matchers.add(closeTo(d, error));
    return arrayContaining(matchers);
} 
```

您也可以使用原始数组来执行此操作，但您需要一个自定义匹配器。

# javascript - MVC - html.dropdownlist - 直接调用javascript或控制器/方法？

> ID：10623460
> 
> 赞同：3
> 
> 时间：2012-05-16T17:18:50.587
> 
> 标签：javascript, asp.net, asp.net-mvc, asp.net-mvc-3, drop-down-menu

在我的 MVC 应用程序中，我的视图中有一个 html.dropdownlist。在选择更改时 - 我希望将值传递给控制器​​中的方法（返回类似列表或 JsonResult 的东西）。

Q1：我该怎么做？

```
 <%=Html.DropDownList("title", Model.Titleitems, "" )%> 
```

Q2：这是一个好的做法（直接在视图中使用控制器/方法名称）还是我应该编写一个 JavaScript 函数并从该 JavaScript 函数内部调用适当的控制器/方法？在这种情况下，如何为上述 html.dropdownlist 控件编写 Onchange 或 OnSelectionChanged 事件？

编辑：

par1 是我要传递给此控制器/方法的下拉列表选择值。

```
 public ActionResult GetMethod(string Par1)
        {
            //My code here 

            return Json(varValue, JsonRequestBehavior.AllowGet); 
        } 
```

现在我有一个关于更改的下拉列表，将我带到一个 JavaScript 函数（根据 marteljn 的建议），在 JavaScript 函数中，我有 .ajax 调用指定 URL 和类型等，它将我带到控制器/方法代码；但仍然无法弄清楚如何将选定的值传递给控制器​​？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T17:31:41.037

Q2 是 Q1 的答案。使用 MVC 时没有像 Web 表单中那样的事件，因此您将编写一些 JavaScript 来向服务器发出请求。
有（至少）两种方法可以解决它：

1.  内联事件处理程序（不推荐）

    `<%=Html.DropDownList("title", Model.Titleitems, new{@onchange = "YourJsFuncHere()"} )%>`

2.  jQuery方式，

    ```
    $("#title").bind("change",function(){
         //Your Code  
         //Use .on instead of bind if you are using JQuery 1.7.x or higher   
         //http://api.jquery.com/on/ 
    }); 
    ```

**编辑 - AJAX 代码**

```
$.ajax({
  "url": "/Controller/Action/" + $("#title").val(),
  "type": "get",
  "dataType" : "json",
  "success": function(data){
    //Your code here
    //data should be your json result
  }
}); 
```

更改或`GetMethod(string Par1)`更改`GetMethod(string id)`您的默认路由以反映`Par1`参数。

此外，如果它没有达到您的断点，则可能是 1）没有启动 AJAX 请求（使用 firebug 来查看是否启动）2）您的路由配置不正确（如果您有，请查看 Global.asax.cs '没有将路由移动到其他地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:03:42.603

```
$(function(){
  $("#title").change(function(){
   var selectedVal=$(this).val();
   $.getJSON("UserController/YourAction",{ id: selectedVal} , function(result ){
       //Now you can access the jSon data here in the result variable
   });

 });

}); 
```

`YourAction`假设您在您的中调用了一个 Action 方法，`UserController`该方法返回 JSON

```
public ActionResult YourAction(int id)
{
  //TO DO : get data from wherever you want. 

   var result=new { Success="True", Message="Some Info"};
   return Json(result, JsonRequestBehavior.AllowGet); 

} 
```

# c# - 在 WPF 中，我可以以某种方式使用 TemplateBinding 来设置模板化按钮的 CornerRadius 吗？

> ID：10623461
> 
> 赞同：1
> 
> 时间：2012-05-16T17:18:52.157
> 
> 标签：c#, wpf, button, controltemplate, cornerradius

我有一个我想重用的 Button ControlTemplateemplate，除了它的 Border 的 CornerRadius，我想从 TemplatedParent 获取它，以便我可以在 Button 声明中指定它。

不幸的是，CornerRadius 不是 Button 的属性，所以编译器不喜欢它。

我看到了几种方法可以实现它，但我真的不喜欢它们。

1.  滥用我没有使用的字段（例如，MinWidth？）来传达这个新的半径。不确定这是否可行，因为 int 不完全是 CornerRadius。
2.  创建 Button 的子类以添加 CornerRadius 并使用它。

我可能会错过另一种方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:24:53.683

我唯一能想到的另一件事是为 CornerRadius 创建一个 AttachedProperty 并将其附加到按钮上，然后绑定到该按钮上。我不确定绑定到 AttachedProperty 是否可以通过 TemplatedParent 工作。

此外，与创建 AttachedProperty 相比，创建派生 Button 类的代码可能更少。所以可能不值得。

# javascript - 如何在 JavaScript 中对对象集合进行排序而不将其转换为数组

> ID：10623463
> 
> 赞同：12
> 
> 时间：2012-05-16T17:18:59.380
> 
> 标签：javascript, underscore.js

我试图避免为以下用例编写自己的排序算法：

```
avatars = {};
avatars[102] = {userInfo: {buddy_name: 'Avatar102', is_online: 1}};
avatars[100] = {userInfo: {buddy_name: 'Avatar100', is_online: 1}};
avatars[101] = {userInfo: {buddy_name: 'Avatar101', is_online: 1}};

console.log(_.keys(avatars));
avatars = _.sortBy(avatars, function(avatar) {return avatar.userInfo.buddy_name.toLowerCase();});
console.log(_.keys(avatars)); 
```

这是控制台输出：

*   [“102”、“100”、“101”]
*   [“0”，“1”，“2”]

如您所见，使用 undescore 的 sortBy 我丢失了关键数据。这个结构可以变得非常大，所以我试图避免转换为数组然后返回集合之类的事情。有没有办法在不滚动我自己的排序功能的情况下做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-05-16T18:33:54.337

你`avatars`不是一个数组，它只是一个对象：

```
avatars = {}; 
```

所以[它的元素没有定义的顺序](http://es5.github.io/#x12.6.4)：

> 未指定枚举属性的机制和顺序（第一个算法中的步骤 6.a，第二个算法中的步骤 7.a）。

和[15.2.3.7](http://es5.github.io/#x15.2.3.7)（和[15.2.3.14](http://es5.github.io/#x15.2.3.14)）：

> 如果实现为 for-in 语句定义了特定的枚举顺序，则必须使用相同的枚举顺序来对该算法的步骤 3 中的列表元素进行排序。

您还可以查看[第 8.6 节](http://es5.github.io/#x8.6)，看看是否有提及对象中属性的顺序。对象属性排序的唯一要求是，如果实现在任何地方定义了一个顺序，那么它必须在任何地方使用相同的排序，但这是一个很大的*if*。大多数实现可能对对象的键使用插入顺序，但我找不到任何需要它们的东西（如果有人能指出规范中定义对象键的任何特定顺序的任何内容，我将不胜感激）。

也就是说，Underscore[`sortBy`](http://underscorejs.org/#sortBy)基本上是一个[Schwartzian Transform](http://en.wikipedia.org/wiki/Schwartzian_Transform)，结合了标准的 JavaScript[`sort`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort)和 Underscore[`pluck`](http://underscorejs.org/#pluck)来解开 Schwartzian Transform 备忘录包装器；`pluck`返回一个数组，所以`sortBy`也返回一个数组。因此，您的最终`_.keys(avatars)`调用实际上是调用[`_.keys`](http://underscorejs.org/#keys)一个数组；数组的键（AKA 可枚举属性）是数组的索引，它们是从零开始的连续整数。

您使用了错误的数据结构。如果您需要一个稀疏数组但还需要像数组一样操作它（即对其进行排序），那么您应该将索引放在对象内并使用普通数组而`pluck`不是`keys`：

```
var avatars = [
    {idx: 102, userInfo: {buddy_name: 'Avatar102', is_online: 1}},
    {idx: 100, userInfo: {buddy_name: 'Avatar100', is_online: 1}},
    {idx: 101, userInfo: {buddy_name: 'Avatar101', is_online: 1}}
];
console.log(_(avatars).pluck('idx'));
avatars = _(avatars).sortBy(function(avatar) {
    return avatar.userInfo.buddy_name.toLowerCase();
});
console.log(_(avatars).pluck('idx')); 
```

演示：http: [//jsfiddle.net/ambiguous/UCWL2/](http://jsfiddle.net/ambiguous/UCWL2/)

如果您还需要快速访问，`idx`那么您可以设置一个并行对象以进行直接`idx`访问：

```
var avatars_by_idx = { };
for(var i = 0; i < avatars.length; ++i)
    avatars_by_idx[avatars[i].idx] = avatars[i]; 
```

然后`avatars_by_idx`提供您正在寻找的直接访问。当然，你必须保持`avatars`和`avatars_by_idx`同步，但如果你把它们都隐藏在一个对象后面，那并不是很困难。

# java - java FileChannel 写入文件并在末尾添加 \n

> ID：10623467
> 
> 赞同：1
> 
> 时间：2012-05-16T17:19:10.013
> 
> 标签：java, file-io, file-processing, filechannel

我正在尝试使用 FileChannel 制作日志。由于某种原因，它没有在我的文件中获得 \n 字符。

我的功能：

```
private void serverLog(String status, String message)
    {           
        currentTime = new Date().getTime();
        String date = dateFormat.format(currentTime);
        String time = timeFormat.format(currentTime);
        String log = logFileName + date + "-" + time;
        String path = new File(".").getAbsolutePath();
        String logLine = date + "|" + time + "|" + status + "|" + message + "|" + Runtime.getRuntime().freeMemory() + "\n"; 
        File file = new File(path,log);

        try {
            if (!file.exists())                 
                file.createNewFile();
            fileChannel = new RandomAccessFile(file, "rw").getChannel();                
            FileLock lock = fileChannel.tryLock();

            while (!lock.isValid())
                lock = fileChannel.tryLock();

            if (lock.isValid())
            {
                fileChannel.position(fileChannel.size());
                ByteBuffer buf = ByteBuffer.allocate(logLine.length());
                buf.clear();
                buf.put(logLine.getBytes());
                buf.flip();
                while (buf.hasRemaining())
                    fileChannel.write(buf);     
                lock.release();
                fileChannel.close();
            }   

        } catch (FileNotFoundException e) {         
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }           
    } 
```

这是我的输出文件：

```
16-05-2012|20-17-27|Success|New user connected: Id: 12345 Name: asaf IP: /0:0:0:0:0:0:0:1|8154448016-05-2012|20-17-27|Count|Current users online: 1, Current ghosts connections: 0|81544480 
```

# apache-flex - 在 Flex 4 中手动拖放，同时避免与其他可拖动对象发生碰撞

> ID：10623468
> 
> 赞同：1
> 
> 时间：2012-05-16T17:19:14.923
> 
> 标签：apache-flex, drag-and-drop, flex4, collision-detection

我有一个生成的应用程序，其中一部分是用户必须拖动一个或多个项目（主要是文本，但也可能是图像）并将其放入一个框的练习，如下所示。

[http://eastblue.org/dragdropexample.png](http://eastblue.org/dragdropexample.png)

该框是 的自定义子类`BorderContainer`。每个可拖动项目（ 的子类）都在using`RichText`中被拾取。当它被释放时，它会检查它是否击中了盒子，如果没有击中，则动画回到起始位置。如果它确实击中，我们会`MouseEvent.MOUSE_DOWN``startDrag()``MOUSE_UP``this.hitTestObject(box)`

```
stopDrag();
this.x = e.stageX; // e is the MouseEvent
this.y = e.stageY; 
```

效果很好。这种方法的问题是可拖动的项目可能会相互碰撞，这看起来不太漂亮。

我想防止可拖动的项目相互碰撞，同时确保它们保持在盒子内。

我考虑通过两种方式解决这个问题：

*   在框内创建某种网格，确保每个网格方块足够大以包含最大的可拖动项目，并让项目出现在最近的空闲网格方块中。

    这样做的问题是盒子和每个可拖动项目可以是任意大小，并且可以有任意数量的可拖动项目，因此确保用户可以将每个项目放入盒子中并仍然保留它有点麻烦它看起来不错。

*   将每个掉落的物品与已经在掉落中的所有其他物品进行检查，如果它们发生碰撞，请将新掉落的物品向其中一个方向移动一点，直到它们不再碰撞。

    这里的问题是把所有东西都放在盒子里，而不是陷入一个试图朝着不可能的方向移动的循环中。如果没有办法移动它*怎么*办？

我错过了一些明显的方法，还是更简单的方法？如果没有，我怎样才能尽可能简单地实现这个？

一些碰撞可能没问题，因为用户不会在其中一个练习上花费太多时间，但现在它的工作方式几乎似乎在寻找彼此并可怕地崩溃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T02:50:58.170

使用 Flex 帮助中记录的 DragManager。只将接受代码放在您的 BorderContainer 上。然后将项目创建为 BorderContainer 的子项，并为其提供所需的布局。

# php - Crontab 正在工作，但 PHP 脚本没有按计划工作？

> ID：10623473
> 
> 赞同：0
> 
> 时间：2012-05-16T17:19:33.410
> 
> 标签：php, cron, crontab

我不确定如何调试它，我设置了 crontab 并早点离开，然后没有结果回来。刚才，我最终使用了这个线程：[Using CronTab to run php scripts](https://stackoverflow.com/questions/5134068/using-crontab-to-run-php-scripts) and have it set to run every minute。我的 PHP 脚本没有运行。我试过`wget`了`php`。当我在浏览器中访问它时它可以工作，但在 crontab 运行它时却不行。

更新：

```
May 16 10:39:01 strawberry /USR/SBIN/CRON[12283]: (root) CMD (  [ -x /usr/lib/php5/maxlifetime ] && [ -d /var/lib/php5 ] && find /var/lib/php5/ -type f -cmin +$(/usr/lib/php5/maxlifetime) -print0 | xargs -n 200 -r -0 rm) 
```

所以它开始了，但我仍然没有得到预期的结果。但是，当我访问网站 url 时它可以工作。我在我的crobtab中使用它：[https ://stackoverflow.com/a/5134125/170365](https://stackoverflow.com/a/5134125/170365)

`* * * * * wget http://mysite.com/myscript >/dev/null 2>&1`

我还尝试将其运行为`www-data`：`root`如何[使用 php 设置 crontab？](https://stackoverflow.com/questions/5051464/how-to-set-a-crontab-using-php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:24:03.833

您可以通过在机器上为 root 创建一个电子邮件帐户来检查 cron 日志文件。如果这对您来说太多了，您可以在 crontab 中尝试以下操作：

```
# m h dom month dow command
0,15,30,45 * * * * touch /home/strawberry/crontest 
```

（使用 /15 也可能有效，但我还没有测试过）

等待 15 分钟标记，然后检查 crontest 文件是否已创建。这将告诉您它是否正在运行。

如果您需要输出，请执行以下操作：

```
# m h dom month dow command
(the time parameters you want) /path/to/command args args args > /blah/blah/cronlogfile 2>&1 
```

另外，尝试将“/ 1”作为分钟标记，这应该让它每分钟都运行一次

# python - Python csv.reader 自动转换 ISO 日期？

> ID：10623474
> 
> 赞同：1
> 
> 时间：2012-05-16T17:19:36.900
> 
> 标签：python, date, csv, iso

我正在使用 Python 的 csv.reader 将文件中的一组日期和坐标带入列表中。这是 .csv 和代码中的示例行：

> 2012-05-06,2012-05-13,165,35.20068,-89.79318

```
 with open('innovation.csv', 'rb') as f:
       reader = csv.reader(f)
       for row in reader:
         parseMe.append(row) 
```

问题是，由于某种原因，将日期放入列表时，字符串正在从 ISO 格式更改为日历格式：

> ['5/6/2012', '5/13/2012', '35.20068', '-89.79318']

对这里发生的事情有什么想法吗？是 csv.reader 正在改变字符串吗？我可以做些什么来防止它或将其更改回 ISO 格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:33:22.963

`csv.reader`没有改变任何东西。您认为正在打开的文件可能与实际打开的文件不同。

为了证明这个运行：

```
with open('innovation.csv', 'r') as f:
    print f.read() 
```

最可能的原因是您正在查看的文件与您的程序正在打开的`'inovation.csv'`文件位于不同的目录中。`'inovation.csv'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:44:23.230

刚刚在 Python 2.7.3 中进行了快速测试（如果您得到不同的结果，请说明您使用的是哪个版本，因为这可能是不同版本中的“功能”或错误）。

```
data = "2012-05-06,2012-05-13,165,35.20068,-89.79318\n2012-05-06,2012-05-13,165,35.20068,-89.79318\n"
import csv
import StringIO
infile = StringIO.StringIO(data)
reader = csv.reader(infile)
for row in reader:
    print row 
```

输出以确认 csv 对日期没有做任何事情：

```
['2012-05-06', '2012-05-13', '165', '35.20068', '-89.79318']
['2012-05-06', '2012-05-13', '165', '35.20068', '-89.79318'] 
```

csv 基本上只是在做一个 string.split(',') （至少在这个简单的输入上）它没有对数据进行任何其他处理。我还注意到您的输出缺少我的测试中的“165”数据，ParseMe 是否在做除了附加行之外的内部操作？

# css - WebKit：是否有任何 css 技巧可以将元素放在前面而不缩放它？

> ID：10623479
> 
> 赞同：1
> 
> 时间：2012-05-16T17:20:04.023
> 
> 标签：css, webkit, z-index, rotation

从图片中，我使用 rotate3d() 到红色矩形，所以它的一半在黑色矩形的前面，另一个在后面。

![在此处输入图像描述](../Images/f5e0dc1b40cbb811b322415bcf7413cd.png)

我希望黑色矩形在红色矩形的前面所以我必须使用 translateZ() 所以它变成

![在此处输入图像描述](../Images/263f19310ccb8210dc8747a5bc56951d.png)

问题是我希望黑色矩形在前面而不缩放它。我希望黑色矩形仍然是相同的大小。有什么诀窍吗？我尝试了 z-index 但它没有用。我猜是因为我使用 rotate3d()。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-20T11:18:01.150

我目前无法访问 Safari 来测试它，所以我把它留给你（让我知道它是否有效），但我相信以下应该有效。

由于浏览器解释`-webkit-perspective`似乎是[我在回答这个问题时指出的问题](https://stackoverflow.com/questions/10339623/why-does-transform-origin-z-distort-on-safari-ios/10420268#10420268)，因此将其删除`#container`并替换为`-webkit-transform: perspective(500)`，然后将相同的东西 ( `-webkit-transform: perspective(500)`) 添加到两者中`#parent`，`#parent2`这就是我[在这个小提琴](http://jsfiddle.net/TPB7A/15/embedded/result/)中所做的。

问题似乎是 Safari 在使用时没有应用视角，而 Chrome 则`#container`在使用。[正如我在回答另一个问题](https://stackoverflow.com/questions/10339623/why-does-transform-origin-z-distort-on-safari-ios/10420268#10420268)`-webkit-perspective`时所讨论的那样，这似乎是对规范的解释问题。

# python - mysql 加密在 INSERT 和 UPDATE 上的行为是否不同？

> ID：10623481
> 
> 赞同：0
> 
> 时间：2012-05-16T17:20:12.093
> 
> 标签：python, mysql, encryption

我正在编写一个快速 REST 服务来管理我们域的电子邮件帐户，并且遇到了我无法解释的奇怪行为。

我正在使用 mysql 对电子邮件帐户进行身份验证，我们的 REST 服务管理邮件目录并使用 Web 界面插入或更新身份验证凭据。插入用户和更新密码的查询都使用`encrypt`mysql 命令。

奇怪的是，在 REST 界面上至少更改一次密码之前，插入的用户将无法进行身份验证。这意味着`encrypt`为更新设置了正确的值，但为插入设置了错误的值。

我已尝试在其余服务端的 GET/POST 参数中记录所有内容，但似乎数据库层出现了问题。REST 服务在两个端点记录正确的密码参数。执行查询的过程有所不同。

我的查询看起来像这样（在 Python 中使用 MySQLdb）：

`ADD_USER = "INSERT INTO users (id,name,maildir,crypt) VALUES (%s,%s,%s,encrypt(%s));"`

`CHANGE_PASS = "UPDATE users SET crypt = encrypt(%s) WHERE id=%s"`

再次，`ADD_USER`输入一个错误的哈希值，`CHANGE_PASS`成功地使用完全相同的 HTTP 参数`crypt`传递给它们（作为字符串）。数据层是否有任何理由会进行不同的加密，或者我是在吠叫错误的树吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:58:06.053

如果您使用不加盐的加密，它将根据当前时间使用盐，因此每次调用它时，您都会得到不同的哈希：

```
mysql> select encrypt('test');
+-----------------+
| encrypt('test') |
+-----------------+
| 92SErC2PadiaQ   |
+-----------------+

mysql> select encrypt('test');
+-----------------+
| encrypt('test') |
+-----------------+
| A2jgxXgOJx7ls   |
+-----------------+ 
```

前两个字符（在标准情况下）是盐。如果你想检查它，你使用旧密码作为盐，除了前两个字符之外的所有内容都被忽略：

```
mysql> select encrypt('test', 'A2jgxXgOJx7ls');
+----------------------------------+
| encrypt('test', 'A2jgxXgOJx7ls') |
+----------------------------------+
| A2jgxXgOJx7ls                    |
+----------------------------------+ 
```

如果你想要更强的密码，你必须使用特殊的盐：

```
mysql> select encrypt('test', '$1$12345678$') as md5;
+------------------------------------+
| md5                                |
+------------------------------------+
| $1$12345678$oEitTZYQtRHfNGmsFvTBA/ |
+------------------------------------+

mysql> select encrypt('test', '$5$0123456789abcdef$') sha256;
+-----------------------------------------------------------------+
| sha256                                                          |
+-----------------------------------------------------------------+
| $5$0123456789abcdef$Wm4jf6bGxEoelzY0H/fTvcw8Qcshq0hyLaRfZWtN8q. |
+-----------------------------------------------------------------+

mysql> select encrypt('test', '$6$0123456789abcdef$') as sha512;
+------------------------------------------------------------------------------------------------------------+
| sha512                                                                                                     |
+------------------------------------------------------------------------------------------------------------+
| $6$0123456789abcdef$vNATSYYTivQfXwPTUT4q.sRFLs/sgxDXaPipzRlX3WOO4r1NcR.Og5OoU2Cd2agm1WA3pCJ30JU4EKMxpZaDy/ |
+------------------------------------------------------------------------------------------------------------+ 
```

所以这一切都取决于你使用什么盐。永远不要使用无盐哈希。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:39:12.313

首先：`ENCRYPT()`如果可以，请不要使用密码。它有点受限（例如：它忽略密码前 8 个字符之外的所有内容），而且它不是特别安全，尤其是因为这意味着 MySQL 查询日志记录将记录您用户的密码！你最好在 Python 中进行密码散列——这意味着 MySQL 不仅不需要知道任何关于实际密码的信息，而且还允许你使用更强大的密码散列算法。

话虽如此，请记住这`ENCRYPT()`不是一个纯粹的哈希函数。除非您将盐作为第二个参数传递，否则其结果不是恒定的。你如何检查密码？正确的解决方案如下所示：

```
SELECT * FROM users WHERE <...> AND crypt = ENCRYPT(%s, crypt) ... 
```

或者，在 Python 中：

```
row.crypt == crypt.crypt(users_input_password, row.crypt) 
```

# java - 我应该修改 JPA 生成的 bean 还是那是不好的做法？

> ID：10623485
> 
> 赞同：0
> 
> 时间：2012-05-16T17:20:30.277
> 
> 标签：java, database, hibernate, jpa, dali

我用 XML 模式和 JAXB 做了很多工作来生成 java bean。我从未接触过生成的 bean，只是在其他 bean 中扩展它们，否则如果重新生成 bean，我可能会丢失代码。实际上，在允许任何构建发生之前，我会自动新生成我的 bean。这保证了我永远只有一个真理。

相同的想法是否适用于 JPA bean 生成，或者 JPA bean 生成意味着一次性的事情？

您应该触摸生成的 JPA bean 还是它们不可触摸？我找不到任何风格或最佳实践建议...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:39:53.080

将代码（getter 和 setter 除外）放入 JPA 实体中实际上是一种最佳实践。不这样做会导致[领域模型贫乏](http://martinfowler.com/bliki/AnemicDomainModel.html)。

从模式生成 JPA 实体对于启动您很有用，但是一旦完成，您应该微调这些实体的代码和设计，并在其中添加业务逻辑。从头开始编写实体并不难，没有任何生成阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-12T16:56:39.737

厚域模型最终会产生一个单一的域和有限的系统——也很慢。保持它们的精益，并且可以进行一些优化。让它们变厚，你最终会失去控制。具有良好中间 API 的古老且经过验证的 DTO 模式仍然是正确的方法——您甚至可能想要废弃 ORM。Entity2Gui“模式”将所有东西都固定在两个方向。有害且极其昂贵。

# c# - 使用 C# 从 HTTP 响应中获取图像

> ID：10623490
> 
> 赞同：1
> 
> 时间：2012-05-16T17:20:43.640
> 
> 标签：c#, javascript, html, http, rest

我正在尝试从 C# 中的 HTTP 响应中获取图像，但它不是图像，而是这些重定向之一。以下是相关代码：

```
String url = "my image URL that's actually a redirect URL"
Image img = null;
HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;
using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
{
    using (Stream str = response.GetResponseStream())
    {
        img = Image.FromStream(str);
    }
} 
```

但是，它一直告诉我，我无法通过响应来寻求。我将响应流保存在 byte[] 中，然后将其打印出来，结果发现响应流实际上是重定向页面的，而不是图像本身的，并且浏览器正在通过 Javascript 处理这一点。

如果它从未作为对我的初始请求的响应而实际传输，我应该如何捕获此图像？我不知道如何监视浏览器的后续请求，即使我将流指向它重定向到的图像 URL，它仍然给我同样的问题并打印出相同的重定向页面 HTML。

编辑：这是正在加载的 Javascript 页面（而不是图像）（还有标准的东西，但这是页面上唯一的脚本）：

```
<script>
var escapedHash = '';
var url = 'https://login.salesforce.com/?ec=302&startURL=%2Fcontent%2Fsession%3Furl%3Dhttps%253A%252F%252Fc.na9.content.force.com%252Fprofilephoto%252F005%252FF';
if (window.location.hash) {
   escapedHash = '%23' + window.location.hash.slice(1);
}
if (window.location.replace){ 
window.location.replace(url + escapedHash);
} else {;
window.location.href = url + escapedHash;
} 
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:49:54.447

一些网站会采取措施阻止人们使用他们托管的图像。基本上，您必须声明请求站点（引用 URL）在他们的域中。

如果您使用浏览器使用的相同链接会发生什么？如果您右键单击图像可以“复制图像 URL”或查看“属性”吗？如果是这样，如果将 URL 复制到新的浏览器窗口会发生什么？如果您使用新浏览器窗口（显示图像）中的 URL 作为您尝试下载的 URL，会发生什么情况？

根据我的经验，重定向由浏览器和 .NET 类处理，没有问题。不过，您可能必须指定一个参数或设置一个属性以自动跟随重定向。

是否可以获取您尝试下载的 URL？

**更新**：
您的桌面应用程序在哪里登录？该站点不允许我直接访问该图像，因为我没有登录。这对您的应用程序来说也是一个问题。

您的应用程序未登录，这就是您将重定向到登录页面的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T19:09:53.273

原来问题的根源只是我愚蠢。代码工作得很好，我只是忘记了我之前已经注释掉了 OpenAuth 身份验证功能以进行调试。

所以问题是所有这些图像请求都是在没有 OAuth 标头的情况下发送的，这导致服务器返回“登录”页面而不是图像（显然无法读入 C# 图像）。

故事的寓意：确保您验证您发送的每个请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:46:09.797

您必须遵循第一个请求中的重定向（由 HTTP 状态 301 和响应中的标头传输标识）。然后，您可以对来自重定向位置的响应使用当前方法。

# php - 这是什么时间格式，如何将其转换为标准化的 dd/mm/yyyy 日期？

> ID：10623492
> 
> 赞同：5
> 
> 时间：2012-05-16T17:20:56.190
> 
> 标签：php, time, timestamp

我正在使用 YouTube/Google API，对于特定视频的上传日期，将返回以下格式的时间/日期：

`2012-05-16T17:15:29.000Z`

我不确定这是什么格式，但我想知道是否有一种简单的方法（例如使用`DateTime()`）将其转换为 dd/mm/yyyy 格式？

任何提及时间格式的内容也将不胜感激；）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T17:24:09.503

那将是UTC时间

```
date_format($date, 'd/m/Y'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T17:26:45.683

除了@web_bod 写的，你还可以做

`date('d/m/Y', strtotime('2012-05-16T17:15:29.000Z') );`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:43:09.237

是的，当然有。

```
$date = new DateTime("2012-05-16T17:15:29.000Z");
echo $date->format("d/m/Y"); 
```

# javascript - Jquery在悬停时可以排序

> ID：10623493
> 
> 赞同：4
> 
> 时间：2012-05-16T17:20:58.293
> 
> 标签：javascript, jquery, jquery-ui-sortable

我正在使用 Jquery 的可排序插件，我的问题如下：

当我拖动一个元素时，一旦我将一个指定的元素悬停在我拖动的那个元素上，我希望启动一个函数。请记住，不是当我用鼠标悬停元素时，而是当我拖动元素时。

非常感谢我在这个问题上得到的任何帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:30:44.220

[`sortstart`](http://jqueryui.com/demos/sortable/#event-start)在触发a 后绑定事件

```
$( ".selector" ).sortable({
   start: function() { 
      $('#elementThatWillBeHoveredOver').hover(hoverStart, hoverEnd);
   }
   stop: function() { $('#elementThatWillBeHoveredOver').off('hover') }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-16T12:46:07.227

我和你有同样的问题。我尝试了几种替代方法，一种是使用“Droppable”方法，有一个 jQuery 插件 Droppable。

[https://api.jqueryui.com/droppable/](https://api.jqueryui.com/droppable/)

```
$( ".Permissoes > div" ).droppable({
    over: function(event, ui){
        console.log('fn:over',event,ui);
    },
    out: function(event, ui){
        console.log('fn:out',event,ui);
    },
    drop: function(event, ui){
        console.log('fn:drop',event,ui);
    }
); 
```

# java - 线程锁定在 if 语句中

> ID：10623494
> 
> 赞同：3
> 
> 时间：2012-05-16T17:21:05.910
> 
> 标签：java, multithreading

我有一个这样的代码块：

```
if(supportsSomeStuff()){
     .....
     .....
}
else {
     .....
     .....
} 
```

现在我想把这段代码放在一个多读单写锁中。在这种情况下，是不是最好先在if语句中加锁，在if之后释放锁，然后在else语句中加锁，完成后再释放？

或者，我可以只为这种 if-else 情况设置一个锁，并在完成后释放它吗？

如果我需要对此做出决定，我需要考虑哪些因素？

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:28:35.980

您是否正在考虑以下两种变体？

```
synchronized(lock) {
    if(supportsSomeStuff()){
         .....
    }
    else{
         .....
    }
} 
```

对比

```
if(supportsSomeStuff()){
    synchronized(lock) {
     .....
    }
}
else{
    synchronized(lock) {
     .....
    }
} 
```

它们之间唯一（巨大的）区别是`if`语句内部的条件在后一种情况下不同步。此外（如果`supportsSomeStuff()`可以在多个线程中执行）它们是等效的，尽管前一种情况持有锁的时间*稍长*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:31:30.330

您实际上并没有提供足够的信息来提供比一般答案更多的信息。

但总的来说，您应该尝试在以下各项之间找到最佳折衷方案：

*   尽可能少地抓住锁；
*   但是，请锁定需要原子的整个操作代码。

这些竞争因素之间的最佳折衷究竟在哪里取决于您的情况。

顺便说一句，许多人建议内置“同步”锁，但由于您提到您只需要一个写入线程，那么根据您的情况，您可能会使用 ReentrantReadWriteLock 获得更好的吞吐量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:28:38.430

如果在此方法中您正在更改状态，则锁定该状态

假设您正在更改 StringBuilder 然后在您的 StringBuilder 上锁定名为 changedvalue 并且 supportsSomeStuff 是无状态的

```
if(supportsSomeStuff()){
     //Considering that if will be executed when write needs to be done and else when read to be done 
     copyOnWriteStringBuilder = new StringBuilder(changingvalue.toString());//This will ensure that before every write you have taken a backup so concurrent read will see the last updated values
     synchronized(changingvalue) {
        //doSomething and then place the updated value in copyOnWriteStringBuilder too
     }
  }
else{
    return copyOnWriteStringBuilder; // This piece for read no locking
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:29:16.880

我会说：

*   当然，只能通过 if 或 else 部分锁定和解锁*一次。*
*   使用`lock(); try { ... } finally { unlock(); }`模型来帮助您做出决定。如果代码更简洁，只需将整个 if 包装在该模型中，那么就可以使用它。

我认为以下内容是最干净的，除非我遗漏了什么。

```
lock.lock();
try {
   if(supportsSomeStuff()){
      ...
   } else {
      ...
   }
} finally {
   lock.unlock();
} 
```

如果您担心`if`测试被锁定并且不需要被锁定，那么不要被锁定。您唯一*应该*担心的是测试本身是否调用了其他可能会影响您不需要并且不想被锁定的性能的方法。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-16T17:28:03.093

读不是独占的，但写是独占的；这意味着可以有多个同时读取，但写入只能是一个，并且当写入发生时不允许读取。

这取决于你在哪里做什么。将您写入的块限制为最小。

# ruby-on-rails - 一种 github ruby gem？

> ID：10623497
> 
> 赞同：1
> 
> 时间：2012-05-16T17:21:10.980
> 
> 标签：ruby-on-rails, ruby-on-rails-3, svn

我正在使用带有 Subversion 的 Ruby on Rails 3.1，我想知道是否有一个工具可以查看项目的更改历史记录。我想要[GitHub](http://github.com)之类的东西，它有一个时间线图，显示在选定日期所做的更改。

有这样的吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-16T17:25:15.930

[Gitlab](http://gitlabhq.com/)可能是您正在寻找的。
但它只适用于 Git。您可以将您的项目移植到 Git，并使用*git-svn*。

# git - 什么会导致 git 混淆字符编码？

> ID：10623498
> 
> 赞同：25
> 
> 时间：2012-05-16T17:21:11.397
> 
> 标签：git, encoding, character-encoding, git-svn, git-extensions

***编辑：*** git 不会混淆字符编码。这仍然是为了分享知识并避免其他人犯同样的错误。

* * *

**上下文**：我的企业使用 svn 存储库。我使用 git-svn 作为客户端来与这个存储库进行交互。项目中的所有文本文件都（并且必须）使用 Windows 默认编码 (cp-....) 进行编码。我使用 git 扩展，有时使用命令行来引导 git。

**我做**了什么：在过去的 3 天里，我正在开发一个新功能，并且我做了一些本地提交。最后，我使用交互式 rebase 将所有这些提交压缩为一个，然后我使用 git svn dcommit 在单个提交中推送 svn 存储库中的所有内容。

**然后发生了什么**：一位同事告诉我，我修改的文件以及提交后的新文件中的所有口音都搞砸了。我之前已经在安装 git + svn 的同一个存储库中提交了带有重音符号的文本文件，这是我第一次遇到这个问题。

**我的调查**：我做了以下事情来调查：用notepad++打开文件，并尝试了最新的编码（包括windows默认和UTF-8）来查看它们：它们都不能正确显示重音，并且总是呈现不同的重音通过相同的奇怪字形序列。

**临时解决方法**：我快速创建了一个带有 git 扩展的还原提交并“dcommited”它。

**问题**：我的企业svn存储库还可以，但是现在我有以下两个问题要解决：

1.  了解带有重音符号的字符发生了什么
2.  从 SVN 历史记录中检索我的工作并以适当的方式提交（如果可能，无需手动查看所有带重音符号的字符）

谁能提供一些线索（我对 git 很陌生）？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-18T08:41:02.447

现在让我们揭示一个痛苦的事实（让我的自尊心痛，而不是 git 用户）：***我确实弄乱了口音，而不是 git。***

我本可以删除让我们错误地认为 git 会弄乱口音的问题，但考虑到赞成票的数量，我认为很多人都犯了和我一样的错误，所以我选择回答我自己的问题确定真相，并可能在同样的情况下帮助人们：

1.  Git 不会触及除换行符以外的字符。
2.  *我在提交之前*打破了口音，我没有注意到它，因为我没有给予足够的关注。为此，我使用 eclipse 编辑了一些文件。Eclipse 无法识别编码，并且重音在保存时都被一个奇怪的字节序列替换。就这样。

再次感谢[Dmitry Pavlenko](https://stackoverflow.com/users/1212681/dmitry-pavlenko)为我提供了有关如何调查此问题的指示。

+1 到“git reflog”

快乐的口音修复;=）

# java - 在 Groovy 中将可变长度字符串散列为 12 位数字的一种方法函数

> ID：10623500
> 
> 赞同：1
> 
> 时间：2012-05-16T17:21:15.650
> 
> 标签：java, random, groovy, hash

我有由字母、数字和特殊字符（电子邮件地址）组成的唯一可变长度字符串列表。列表中的每个电子邮件地址都是唯一的。

我需要一个单向哈希函数（我不需要能够从生成的数字中检索原始值），它将用盐对字符串进行哈希处理并生成一个 12 位数字。

我想确保唯一性，因此我将检查先前生成的值列表以检测冲突，然后在发生冲突时生成一个新数字。可预测性不是问题。

理想情况下，我希望这个函数用 Groovy 编写，但 Java 也可以。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T17:23:32.483

> 我需要保证每个生成的数字都是唯一的。

那么这显然会是一个问题。可能的输入字符串多于可能的输出值。特别是，每个可能的输出值（12 位字符串）都是可能的输入值。因此，如果所有这些都获得唯一的输出值，则不可能为任何*其他*输入值留下任何输出值。

当然，您总是可以*记录*您遇到的每个电子邮件地址（因此第一个以 000000000000 结尾，第二个以 000000000001 等结尾），但这是一个存储问题，而不是散列本身。如果没有后备存储，您无法仅从输入获得输出*。*

# php - 在数组内回显 foreach 循环

> ID：10623502
> 
> 赞同：-5
> 
> 时间：2012-05-16T17:21:20.400
> 
> 标签：php

我有以下代码，当我尝试`$test_array`用“111 222”这样的空格打印下面数组中的值时：

```
$test_array= array('111', '222');

// output headers so that the file is downloaded rather than displayed
header('Content-Type: text/csv; charset=utf-8');
header('Cache-Control: no-store, no-cache'); 
header('Content-Disposition: attachment; filename=data.csv');

$output = fopen('php://output', 'w');

$test_data = array(  
    array('Invoice #', 'Name', 'Email'),  
    array( $test_array, 'John', 'test@yahoo.com')  
);

foreach( $test_data as $row )  
{  
   fputcsv($output, $row, ',', '"');     
}  

fclose($output); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T17:23:36.997

`$test_data`您将在每次循环迭代中覆盖整个内容。也许您的意思是通过以下方式添加到它`[]`：

```
// Initialize it before the first loop.
$test_data = array();

// Inside the inner loop...
foreach($test as $x){ 
  // Append to the $test_data array with []
  $test_data[] = array(  
   array('Invoice #', 'Name', 'Email'),  
   array( $x, 'Jhon', 'test@yahoo.com')  
  );
} 
```

现在，第二个循环中的每个值`$row`应该是一个包含两个子数组的数组，第二个具有不同的值`$x`。

注意：实际上不需要循环遍历每个元素的内容`$test_data`。`var_dump()`只需转储整个多维数组：

```
echo '<pre>'; 
var_dump($test_data);
echo '</pre>'; 
```

### 输出：

```
Array(2) {
  [0]=>
  array(2) {
    [0]=>
    array(3) {
      [0]=>
      string(9) "Invoice #"
      [1]=>
      string(4) "Name"
      [2]=>
      string(5) "Email"
    }
    [1]=>
    array(3) {
      [0]=>
      string(3) "111"
      [1]=>
      string(4) "Jhon"
      [2]=>
      string(14) "test@yahoo.com"
    }
  }
  [1]=>
  array(2) {
    [0]=>
    array(3) {
      [0]=>
      string(9) "Invoice #"
      [1]=>
      string(4) "Name"
      [2]=>
      string(5) "Email"
    }
    [1]=>
    array(3) {
      [0]=>
      string(3) "222"
      [1]=>
      string(4) "Jhon"
      [2]=>
      string(14) "test@yahoo.com"
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:25:33.483

使用内爆：

```
echo implode(" ", $test); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:28:26.557

您总是在循环中覆盖 $test_data 变量。

使用 $test_data[] = array();

```
$test= array('111','222');

foreach($test as $x)
{ 
    $test_data[] = array(  
        array('Invoice #', 'Name', 'Email'),  
        array( $x, 'Jhon', 'test@yahoo.com')  
    );
}

foreach( $test_data as $row )  
{  
    echo '<pre>'.var_dump($row);  
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:29:07.403

每次循环发生时，您都在重写 $test_data 。尝试将其退出循环并使用 [] 代替：

```
$test= array('111','222');
$test_data = array();
foreach($test as $x){ 
    $test_data[] = array(
        'Invoice #' => $x,
        'Name' => 'Jhon',
        'Email' => 'test@yahoo.com'
    );
}
foreach($test_data as $row) {  
    echo "<pre>";
    print_r($row);
    echo "</pre>";
} 
```

您还可以将这两个数组合并为一个（如上例所示）。

# asp.net - 在更改密码期间锁定用户

> ID：10623504
> 
> 赞同：0
> 
> 时间：2012-05-16T17:21:21.820
> 
> 标签：asp.net, security, asp.net-membership

假设我是管理员。我想为用户重置密码。（Asp.net 网络表单）。在我更改密码之前，我想阻止用户登录网络，因为理论上他/她也可以登录更改密码。

我正在考虑将 IsLockedOut 设置为“true”，但我听说它在数据库中是只读的。有什么办法可以赶走这个人吗？我的意思是，如果用户名是“test”，我想在我的运营期间阻止“test”登录。

```
MembershipUser user = Membership.GetUser(userName);
if (user.IsLockedOut == false)
{
   // kick out user
} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:51:08.763

您总是可以编写自己的方法来访问数据库，假设您在 MS SQL 服务器上使用默认的 ASP.NET 成员资格提供程序，您可以访问该`aspnet_Membership`表。

在这里，您可以在工作时将`IsLockedOut`or更改`IsApproved`为 False / 0，然后在完成后再次返回。

这可以是 Web GUI 中的一个按钮，您只需要将用户名映射到他们的`UserId`.，但如前所述，您需要编写自己的方法来访问数据库中的这些表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:45:38.233

“最好的方法”是固执己见的，但根据您的要求，这是我将如何做到的。在您的运营期间，我会将`test`的用户名更改为（或类似）。`test_reset`在您的运营期间，最终用户`test`将无法使用他的用户名登录（并且作为最终用户，将不知道他的用户名被更改为什么）。期限结束后，将用户名改回原来的。

**一般注意事项**：只要您是管理员并且有权访问，我就会深入研究具体细节，而不是依赖 Web GUI 来这样做......

# postgresql - 如何在 PostgreSQL 8.3 中执行窗口函数

> ID：10623505
> 
> 赞同：0
> 
> 时间：2012-05-16T17:21:33.943
> 
> 标签：postgresql, window-functions

我已经编写了一个要部署到 heroku 的 Web 应用程序。我使用 PostgreSQL 9.1.2 编写它。但是似乎heroku上的免费共享数据库只有postgres 8.3。他们正在升级到 9。很快就会有一些东西，但在那之前，我的一个 SQL 查询不起作用。这是：

```
SELECT id, route_id, location_id, order_id, blogtext,
  lead(id) over (PARTITION BY route_id ORDER BY order_id ASC) AS next_id,
  lead(location_id) over (PARTITION BY route_id ORDER BY order_id ASC) AS next_location_id,
  lag(id) over (PARTITION BY route_id ORDER BY order_id ASC) as previous_id,
  lag(location_id) over (PARTITION BY route_id ORDER BY order_id ASC) AS previous_location_id,
  row_number() over (PARTITION BY route_id ORDER BY order_id ASC) AS indx 
```

是否可以重写它以在 PostgreSQL 8.3 上工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:18:04.710

请注意，[在 8.4 之前](http://www.postgresql.org/docs/8.4/static/release-8-4.html#AEN96166)的 PostgreSQL[中不存在 Window 函数](http://www.postgresql.org/docs/8.3/static/functions.html)。

* * *

**编辑2：**

你让我非常好奇，我玩弄了这些查询。

首先需要注意的一些事项：

1.  为了达到预期的结果，您必须多次加入表。鉴于 PostgreSQL 8.3 不支持 CTE，我创建了一个视图。幸运的是，您的情况只需要一个视图，因为您`OVER ()`对所有窗口函数使用相同的条件；

2.  `row_number`应该用于对数据子集进行操作，所以我在视图中添加了这个字段；

3.  要形成`PARTITION`，您应该在子句`=`中的所有字段的连接表上使用运算符；`PARTITION`

4.  `row_number`是使用子查询（无连接）形成的，并计算与分区匹配且`ORDER BY`字段小于或等于当前行的所有行。**请注意，如果`ORDER BY`字段不是唯一的，则此方法将不起作用！** 如果不是这种情况，则创建这样的字段。

5.  要模拟`ORDER BY`非函数的子句`row_number`，您可以加入`row_number`字段，使其成为`+1`, `-1`,`min()`或`max()`在加入的一侧，分别匹配,`lead()`和函数。`lag()``first_value()``last_value()`

请考虑以上第**4**点！

您的查询可以通过以下方式更改（使用前比较输出）：

```
-- First, create a support view
CREATE VIEW table_v AS
SELECT id, route_id, location_id, order_id, blogtext,
       (SELECT count(*) FROM table
         WHERE route_id = t.route_id AND order_id <= t.order_id) AS row_number
  FROM table t;

-- Now, the query
SELECT t.id, t.route_id, t.location_id, t.order_id, t.blogtext,
       tlead.id AS next_id, tlead.location_id AS next_location_id,
       tlag.id AS previous_id, tlag.location_id AS previous_location_id,
       t.row_number AS indx
  FROM table_v t
  LEFT JOIN table_v tlead
    ON tlead.route_id = t.route_id AND tlead.row_number = t.row_number + 1
  LEFT JOIN table_v tlag
    ON tlag.route_id = t.route_id AND tlag.row_number = t.row_number - 1
  -- 
  -- proceed with the query here
  -- ... 
```

我使用了来自[Window 函数和更多“本地”聚合](https://stackoverflow.com/questions/10614505/window-functions-and-more-local-aggregation)的修改后的示例数据，并创建了一个沙箱来展示它在[SQL Fiddle](http://www.sqlfiddle.com/#!1/bcbc0/1)上的工作方式。

尽管如此，鉴于所有开发都是在 9.1.2 上完成的，我会在走这条路之前三思而后行。

# mysql - 将设置为 varchar 的主键字段转换为 int 字段

> ID：10623506
> 
> 赞同：3
> 
> 时间：2012-05-16T17:21:35.657
> 
> 标签：mysql

我之前的开发人员创建了一个名为“Tools”的数据库表，它包含两个字段，toolid - varchar(255) 和 toolname - varchar(100)。

toolid 字段的类型是 varchar，它是主键。表中有数据。

我想将 varchar toolid 字段转换为 int 类型，同时使用它们的键保存数据，我也希望该字段自动递增。

当前键是数字，例如 12 或 22 或 3。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T09:29:39.083

如果您只想将 varchar 字段更改为 int 字段，当然不会因为数据类型不匹配而让您这样做，但是，一个非常简单的解决方法是：

创建第二个表，其中将包含主表中的所有字段。

```
CREATE TABLE `Tools2` SELECT * FROM `Tools`; 
```

清空数据，因为我们需要将工具名从 varchar 更改为 int 并且在它已满时无法执行此操作。

```
TRUNCATE TABLE `Tools2`; 
```

好的，让我们更改字段类型。

```
ALTER TABLE `Tools2` CHANGE `toolname` `toolname` INT(11) NOT NULL; 
```

现在让我们重新插入原始表中的数据。

```
INSERT INTO `Tools2` SELECT * FROM `Tools`; 
```

Tools2 现在是正确版本的 Tools，因此请删除 Tools。

```
DROP TABLE `Tools`; 
```

最后，将 Tools2 重命名为 Tools，这样您就可以开始使用了。

```
RENAME TABLE `Tools2` TO `Tools`; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:36:56.813

Try these three separate commands:

```
ALTER TABLE `Tools` CHANGE `toolid` `toolid` INT( 11 ) NOT NULL;
ALTER TABLE `Tools` ADD PRIMARY KEY ( `toolid` );
ALTER TABLE `Tools` CHANGE  `toolid`  `toolid` INT( 11 ) NOT NULL AUTO_INCREMENT; 
```

If you need to adjust the `AUTO_INCREMENT` value:

```
ALTER TABLE `Tools` AUTO_INCREMENT = 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:38:58.077

如果未将其设置为主键：

```
alter table tools add primary key (toolid); 
```

将 Auto Increment 值设置为您希望 NEXT 值的值（比您当前的值高 1：

```
alter table tools AUTO_INCREMENT=[value]; 
```

更改表定义：

```
Alter Table Tools Change Column toolid toolid integer NOT NULL AUTO_INCREMENT; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T18:50:04.680

它被设置为主键，解决这个问题的唯一方法是：使用

SQL Server 并上至类似的数据库选项卡下至选项或首选项或其他内容：从那里您可以告诉数据库更新所有其他表中的主键，只需使用 GUI 更改数据类型。您必须确保首先选择该选项，否则将不允许您保存更改。

无论主键与数据类型相关的任何表都需要更改。

因此，如果您更改表格工具，您将不得不更改它链接到的表格，如果是这种情况。

您可能必须删除并重新创建表，在这种情况下，您可以在使用的任何编辑器中轻松完成此操作。您实际上可以使用 IDENTITY(1,1) 函数为每个工具 ID 创建唯一标识符。

如果要保留相同的工具ID，则必须使用正确的列约束创建一个新表，通过按升序运行插入语句或类似的方法来填充表...

# c# - 用 C# 编写时如何让 SQL 代码发送错误消息

> ID：10623510
> 
> 赞同：0
> 
> 时间：2012-05-16T17:21:39.223
> 
> 标签：c#, sql

我有代码可以为每个用户上传一个 Excel 电子表格，然后上传后，我让它根据另一个 SQL 表更新 SQL 中的一个列。我想验证 Excel 电子表格中的数据是否与 SQL 表中要更新的选项之一匹配。最简单的方法是什么？即如果返回 NULL 值，我可以添加一条 SQL 语句在网站上给我一条错误消息，还是我必须在 C# 中编写一个复杂的 IF 语句？这是我到目前为止所拥有的（参见 SQL 语句）：

```
try
    {

        FileUpload.SaveAs(path);
        if (TextBox.Text != "")
        sheetname = TextBox.Text;
        System.Data.OleDb.OleDbConnection MyConnection;
        System.Data.DataSet DtSet;
        System.Data.OleDb.OleDbDataAdapter MyCommand;  //check sheet name
        MyConnection = new System.Data.OleDb.OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + path + ";Extended Properties=Excel 12.0;");
        MyCommand = new System.Data.OleDb.OleDbDataAdapter("select * from [" + sheetname + "$]", MyConnection);
        //MyCommand = new System.Data.OleDb.OleDbDataAdapter("select * from [July Noms$]", MyConnection);
        MyCommand.TableMappings.Add("Table", "TestTable");
        DtSet = new System.Data.DataSet();
        MyCommand.Fill(DtSet);
        SqlConnection curConnection = new SqlConnection(@"Data Source=1tc-Techcomm2;Initial Catalog=EventRegistration;Integrated Security=True");
        curConnection.Open();
        SqlCommand curCommand;
        SqlParameter param;
        string str;

        for (int i = 0; i < DtSet.Tables[0].Rows.Count; i++)
        {
            if (DtSet.Tables[0].Rows[i][1] == DBNull.Value)
                continue;
            curCommand = curConnection.CreateCommand();
            curCommand.CommandText = @"Insert into TestSP (SessionHead_EventId, SessionHead_Title, SessionHead_TypeId, SessionHead_Description, SessionHead_Status, SessionHead_Presenter, SessionHead_Champion, SessionHead_AnnounceDate, SessionHead_Objectives, SessionHead_LaunchDate, SessionHead_Notes, SessionHead_Schedule, SessionHead_SpecialNeeds, SessionHead_Equipment, SessionHead_CDA) Values (@a,@b,@c,@d,@e,@f,@g,@h,@i,@j,@k,@l,@m,@n,@o)";
            for (int j = 0; j < 15; j++)
            {
                param = new SqlParameter();
                str = "@";
                str += (char)('a' + j);
                param.ParameterName = str;
                param.SqlDbType = SqlDbType.VarChar;
                param.Value = DtSet.Tables[0].Rows[i][j];
                curCommand.Parameters.Add(param);

            }
            Label1.Text = "THE EXCEL DATE HAS SUCCESSFULLY BEEN SENT TO THE DATABASE";
            curCommand.ExecuteNonQuery();
            curCommand.CommandText = "UPDATE TestSP SET SessionHead_TypeId = ( SELECT SessionType.SessionType_Id FROM SessionType WHERE SessionType.SessionType_Title = TestSP.SessionHead_TypeId) WHERE EXISTS ( SELECT SessionType.SessionType_Id FROM SessionType WHERE SessionType.SessionType_Title = TestSP.SessionHead_TypeId)"; 
//****Can I add a statement here stating that if a NULL value is returned, to give me an error message on the website?****

        curCommand.ExecuteNonQuery();

        }

        MyConnection.Close();
        curConnection.Close();

    }
    catch (Exception ex)
    {
        //Response.Write(ex.ToString());
        Label1.Text = ex.Message;
        Label2.Text = ex.Message; 

    }

} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:30:47.123

我建议你使用存储过程来返回一个 sql 错误信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:39:45.787

如果查询为假，catch of`System.Data.SqlClient.SqlException`会给你错误信息。`ExecuteNonQuery`还将为您提供受影响行的整数。因此，`0`如果没有受影响的行，并且`-1`出现回滚等错误。

# zend-framework - 将对象附加到 Zend 表单

> ID：10623511
> 
> 赞同：0
> 
> 时间：2012-05-16T17:21:39.357
> 
> 标签：zend-framework, zend-form-element

我开始创建 Zend 表单：

```
$form = new Form_ChangePersonalDetails(
                     array( 'person'=>$person,
                            'emailvalidator'=>$validator,
                              )); 
```

人是一个物体。它有效，尽管它显示警告：

```
Warning: htmlspecialchars() expects parameter 1 to be string, object given 
```

是否有可能以某种方式删除此警告？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:15:09.113

默认情况下，传递给构造函数的任何无法识别的选项都`Zend_Form`将被视为添加到`<form>`标签的附加表单属性。

如果可能，`__toString()`向类添加一个方法，`Person`以便可以将其转换为字符串，或者根据您尝试对该对象执行的操作，您可能需要重写`Zend_Form::__construct()`以便它识别您已传递一个特殊对象，并且它可以在调用`Zend_Form::__construct()`处理传递给表单构造函数的任何其他选项之前处理它。

通过将该对象传递给表单构造函数，您特别想做什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T21:37:32.673

You need to implement your own constructor! :) Say

```
public function __construct($person, $emailValidator, $options) {
    parent::__construct($options);
    $this->_person = $person;
    //or if you want to fill the form with the object's data
    $this->populate($person->toArray());
    $this->emailField->addValidator($emailValidator);
} 
```

# c - 如何确定确切原因，为什么 berkeley db 在 db->open 上返回 EINVAL？

> ID：10623512
> 
> 赞同：5
> 
> 时间：2012-05-16T17:21:45.587
> 
> 标签：c, database, berkeley-db, verbosity

在 berkeley db 文档中，说明原因可能有以下几种：

> 指定了无效的标志值或参数（例如，未知的数据库类型、页面大小、散列函数、填充字节、字节顺序）或与指定数据库不兼容的标志值或参数。指定了 DB_THREAD 标志，并且快速互斥体不适用于此体系结构。
> 
> DB_THREAD 标志被指定给 DB->open，但没有被指定给 DB_EN​​V->open 调用，用于创建 DB 句柄的环境。
> 
> 使用 DB_THREAD 标志或提供的数据库环境支持事务处理指定了支持平面文本文件。

我使用的唯一标志是 DB_CREATE，数据库类型是 DB_BTREE。

我想知道导致 EINVAL 的确切原因，但我没有找到任何可以在“DB”结构中帮助我的详细配置（在 DB_EN​​V 中，他们有 set_verbose 方法，但我不使用 DB_EN​​V）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T16:05:29.873

你可以试试[DB->err()](http://docs.oracle.com/cd/E17076_02/html/api_reference/C/dberr.html)和[这些例子。](http://docs.oracle.com/cd/E17076_02/html/programmer_reference/am_misc_error.html)如果我没记错的话，可以设置一个环境变量（`export X=Y`可以设置的 shell 环境变量），并且库会开始将错误消息打印到 stderr，但它可能是 DB Env 的事情......抱歉，找不到信息现在。

# c# - 从 FileSystemWatcher 事件更新 ListBox

> ID：10623513
> 
> 赞同：2
> 
> 时间：2012-05-16T17:21:47.600
> 
> 标签：c#, wpf, xaml

我想更新`ListBox`一个`FileSystemWatcher`事件。事件运行时，我收到此错误：

```
Unhandled Exception: System.InvalidOperationException: The calling thread cannot access this object because a different thread owns it.
   at System.Windows.Threading.Dispatcher.VerifyAccess()
   at System.Windows.DependencyObject.GetValue(DependencyProperty dp)
   at System.Windows.Controls.Panel.get_IsItemsHost()
   at System.Windows.Controls.Panel.VerifyBoundState()
   at System.Windows.Controls.Panel.OnItemsChanged(Object sender, ItemsChangedEventArgs args)
   at System.Windows.Controls.ItemContainerGenerator.OnItemAdded(Object item, Int32 index)
   at System.Windows.Controls.ItemContainerGenerator.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args)
   at System.Windows.Controls.ItemContainerGenerator.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, Eve
ntArgs e)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.Windows.WeakEventManager.DeliverEvent(Object sender, EventArgs args)
   at System.Collections.Specialized.CollectionChangedEventManager.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args)

   at System.Collections.Specialized.NotifyCollectionChangedEventHandler.Invoke(Object sender, NotifyCollectionChangedEventArgs e)
   at System.Windows.Data.CollectionView.OnCollectionChanged(NotifyCollectionChangedEventArgs args)
   at System.Windows.Controls.ItemCollection.System.Windows.IWeakEventListener.ReceiveWeakEvent(Type managerType, Object sender, EventArgs e
)
   at System.Windows.WeakEventManager.DeliverEventToList(Object sender, EventArgs args, ListenerList list)
   at System.Windows.WeakEventManager.DeliverEvent(Object sender, EventArgs args)
   at System.Collections.Specialized.CollectionChangedEventManager.OnCollectionChanged(Object sender, NotifyCollectionChangedEventArgs args)

   at System.Windows.Data.CollectionView.OnCollectionChanged(NotifyCollectionChangedEventArgs args)
   at MS.Internal.Controls.InnerItemCollectionView.Add(Object item)
   at System.Windows.Controls.ItemCollection.Add(Object newItem)
   at DirectoryBinding.MainWindow.<.ctor>b__2(Object s, FileSystemEventArgs e) in C:\Users\dharmatech\Documents\DirectoryBinding\DirectoryBi
nding\MainWindow.xaml.cs:line 35
   at System.IO.FileSystemWatcher.OnCreated(FileSystemEventArgs e)
   at System.IO.FileSystemWatcher.NotifyFileSystemEventArgs(Int32 action, String name)
   at System.IO.FileSystemWatcher.CompletionStatusChanged(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* overlappedPointer)
   at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP) 
```

这是演示问题的代码：

xml:

```
<Window x:Class="DirectoryBinding.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow"
        Height="350"
        Width="525">
    <DockPanel>
        <ListBox DockPanel.Dock="Top" Name="listBox"/>
    </DockPanel>
</Window> 
```

C＃

```
using System.Linq;
using System.Windows;
using System.IO;

namespace DirectoryBinding
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            new DirectoryInfo("c:/users/dharmatech").GetFileSystemInfos().ToList().ForEach(
                info => listBox.Items.Add(info.FullName));

            var fileSystemWatcher = new FileSystemWatcher("c:/users/dharmatech") 
            { EnableRaisingEvents = true };

            fileSystemWatcher.Created += (s, e) => listBox.Items.Add(e.FullPath);
        }
    }
} 
```

关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T17:25:57.263

这里的问题是`FileSystemWatcher`在线程池而不是 UI 线程上引发它的事件，但 UI 只能从 UI 线程修改。您需要在修改之前将事件处理代码移回 UI 线程

处理此问题的一种方法是使用`SynchronizationContext`

```
var context = SynchronizationContext.Current;
fileSystemWatcher.Created += (s, e) => {
  context.Post(val => listBox.Items.Add(e.FullPath), s);
}; 
```

# android - 在android中显示来自sqlite数据库的图像？

> ID：10623515
> 
> 赞同：0
> 
> 时间：2012-05-16T17:21:59.960
> 
> 标签：android

我想在我的应用程序中显示来自 sqlite 数据库的图像。我的要求是显示一个文本视图及其相关图像。我将数据库文件保存在资产文件夹中。但实际上我的图像存储在服务器的“allimages”文件夹中。

我的数据库列（我保留的资产文件夹中的 db）如下：

S.No 描述

1 div style="text-align: justify;">甘地是一位伟大的领袖 img height="194" width="281" src="/allimages/img.png" alt="" div

2 div style="text-align: justify;">Subash 是一个伟大的领导者 img height="194" width="281" src="/allimages/img.png" alt="" />
- ---- --------- - ------------ - ------------ -- ------------ - -----------------

**现在我的问题是在我的数据库中，图像路径存储在描述列中。在android中，我们不能在drawable文件夹中创建一个新文件夹并引用图像的路径。我的数据库包含 2000 到 3000 条记录。现在我无法更改本地数据库中图像的路径。那么我应该在我的项目文件夹中的哪里创建“allimages”文件夹以及如何引用这些图像？任何人都请帮我解决这个问题......我正在努力解决这个问题......**

提前致谢.....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:42:11.057

根据您上面的评论：

**您可以通过循环更新数据库中的所有元素**

看起来您的描述是独一无二的，所以不幸的是，您需要从数据库中提取数据，将其放入某种列表中，修改列表以更改路径，然后使用修改后的值更新数据库。

注意：您只需要这样做一次，但如果您有数千条记录要更新，则需要一些时间。

以下是更新所有路径所需执行的步骤的一些伪代码。

*获取所有记录，提取数据并修改路径*

```
//Get all the records
Cursor allRecords = database.query(Table_Name, null, null, null, null, null, null);

//Extract the data from the Cursor and create a list
List<SomeDataObject> listOfModifiedDataObjects = new ArrayList<SomeDataObject>();

allRecords.moveToFirst();

while(!allRecords.isAfterLast())
{
    int id = allRecords.getInt(allRecords.getColumnIndex("NameOfIDColumn"));
    String description = allRecords.getString(allRecords.getColumnIndex("NameOfDescriptionColumn"));

    //Modify the description to change the path of the src...
    description = description.replace("allimages", "some/other/path/allimages");

    //Create the data object and store it in the list
    SomeDataObject tempObj = new SomeDataObject();
    tempObj.ID = id;
    tempObj.Description = description;

    listOfModifiedDataObjects.add(tempObj);

} 
```

*使用修改后的数据更新数据库* 注意：这应该在一些可以访问 SQLiteDatabase 对象的数据库帮助器类中完成

```
//Iterate through all the modified data objects
for(SomeDataObject curObj: listOfModifiedDataObjects)
{
    ContentValues values = new ContentValues();

    //Set the new description into the content values object
    values.put("NameOfDescriptionColumn", curObj.Description);

    //Update the table with the new value. The record that gets updated is based on the curObj.ID.
    //In this case, I'm guessing your id column is named "_id"
    database.update(TABLE_NAME, values, "_id = ?", new String[]{String.ValueOf(curObj.ID)});
} 
```

我没有编译任何这段代码，也没有手边的 IDE，所以可能有一些小错别字。但希望这能让您大致了解如何更新每条记录。

# wpf - 附加 WPF 资源字符串

> ID：10623518
> 
> 赞同：5
> 
> 时间：2012-05-16T17:22:13.313
> 
> 标签：wpf, xaml, localization, resources

我想为 WPF 对象的单个内容或标头附加两个静态字符串。像这样的东西：

```
<MenuItem 
    Header="{x:Static properties:Resources.SEARCH_FOR_DAYS} + 
            {x:Static properties:Resources.ELLIPSES}" /> 
```

我玩过 ContentStringFormat 等，但无法让它接受两个资源。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T17:26:39.840

```
<MenuItem>
    <MenuItem.Header>
        <StackPanel Orientation="Horizontal">
            <TextBlock Text="{x:Static properties:Resources.SEARCH_FOR_DAYS}" />
            <TextBlock Text="{x:Static properties:Resources.ELLIPSES}" />
        </StackPanel>
    </MenuItem.Header>
</MenuItem> 
```

或者（更接近您的要求）：

```
<MenuItem>
    <MenuItem.Header>
        <MultiBinding StringFormat="{}{0}{1}">
            <Binding Path="{x:Static properties:Resources.SEARCH_FOR_DAYS}"/>
            <Binding Path="{x:Static properties:Resources.ELLIPSES}"/>
        </MultiBinding>
    </MenuItem.Header>
</MenuItem> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T17:27:07.333

在我的脑海中，你也许可以这样做：

```
<MenuItem>
    <MenuItem.Header>
        <TextBlock>
            <Run Text="{x:Static properties:Resources.SEARCH_FOR_DAYS}" />
            <Run Text="{x:Static properties:Resources.ELLIPSES}" />
        </TextBlock>
    </MenuItem.Header>
</MenuItem> 
```

# iphone - 无法从 Tapku 导入 .h 文件

> ID：10623522
> 
> 赞同：1
> 
> 时间：2012-05-16T17:22:45.857
> 
> 标签：iphone, ios, tapku

我正在尝试使用 Tapku，我完全按照官方说明进行操作，但是每当我导入 .h 文件时，Xcode 都会说找不到它？

这有什么可能的原因吗

[https://github.com/devinross/tapkulibrary/wiki/Adding-tapku-to-your-project-in-xcode-4](https://github.com/devinross/tapkulibrary/wiki/Adding-tapku-to-your-project-in-xcode-4)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:12:41.757

确保其头文件的路径位于 Xcode 中目标的“头文件搜索路径”中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T05:13:38.497

Check your folder name. When you put `$(SRCROOT)` in the `Header Search Paths`, it will show you the actual path.

**And if there is any space in the folder name, it will cause the problem.**

I was almost giving up to add the library, then I tried this method and it worked like charm. :) In my case, my project was under `iPhone Apps` folder, and I had to change it to `iPhoneApps` by removing the space.

# jquery - 如何让这个细节视图动画到正确的高度？

> ID：10623524
> 
> 赞同：1
> 
> 时间：2012-05-16T17:23:00.773
> 
> 标签：jquery

我有一个巨大的可滚动区域。在一个部分中，我有一个缩略图网格。单击时，拇指将被克隆并动画到屏幕中心。克隆的图像然后淡出，框变大，然后将相关文章加载到使用 (eq)index 单击的拇指中。

文章加载良好，所以我知道我的目标是正确的，但是因为每篇文章根据其内容具有不同的高度，我需要该框在相应文章出现之前调整其高度。我似乎无法让它工作。我试图将高度传递给一个变量并将高度设置为该值，但它似乎返回 0，因为框将其高度设置为 0。如果我设置一个像素值，那很好，但这给我留下了很多白色底部的空间。\我使用的代码是：

```
var index = newsover.index($(this)); //cycle through read more links
    var offset = $(this).offset();  //Get the thumb position to animate from
    var animFinished = false;  //Create boolean to check when ani finishes
    $('#news-articles .news-article').hide().eq(index).show(); // show the article for the corresponding link and hide the others
    var article = $('#news-articles .news-article').eq(index);
    var articleClone = article.clone(true);  // clone the article for the corresponding link
    var articleHeight = article.height(); 
```

然后将其编码为动画到中心并淡出拇指图像，这一切都很好。然后：

```
//expand the box further from the center
    expandFurther = function() {
        expandedItem.animate({
            width: 875,
            height: articleHeight,
            marginTop: -articleHeight/2,
            marginLeft: -875/2,
            }, {
                duration: DDBR.constant.ITEM_ANIMATION_SPEED,
                easing: DDBR.constant.ITEM_ANIMATION_EASING,
                queue: false,
                complete: function() {
                    animFinished = true;
                    if (animFinished) {
                    loadContent();
                    }
                }
            })              
        }; //END expandFurther function 
```

任何帮助将不胜感激。提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:31:33.110

我无法从您的描述中完全看出，但听起来您的高度为零，因为在动画完成之前您实际上并没有加载文章内容，所以您正在查看的容器当然有高度为零 - 它是空的。

要动画到正确的高度，您需要以某种方式加载文章内容——在实际容器中或在（可能不可见的）虚拟容器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T08:21:27.353

我已经通过使用一个名为actual 的jquery 插件来实现它。直接整理好了。这是链接： [http ://dreamerslab.com/blog/en/get-hidden-elements-width-and-height-with-jquery/](http://dreamerslab.com/blog/en/get-hidden-elements-width-and-height-with-jquery/)

非常感谢所有为此提供帮助的人。

# c# - 系统试运行报错信息

> ID：10623526
> 
> 赞同：0
> 
> 时间：2012-05-16T17:23:23.590
> 
> 标签：c#

我正在尝试运行此系统测试。我确保设备信息在数据库中。

当我运行测试时，它不断给我一条错误消息：

> 测试方法 SystemTests.Tests.EmailNotification.TestAddDeviceToAccount 抛出异常：System.InvalidOperationException：序列不包含任何元素。

请有任何帮助

```
public void TestAddDeviceToAccount()//Test to AssDeviceToAccount
{
    //string Fccid = "OPS2";
    //string SerialNumber = "101";
    //string emailAddress = "m.koneru2@spectrumBridge.com";

    using (WSPlusEntities dc = WSPlusEntities.GetContext())
    {
         Device d1 = dc.Devices.Where(d => d.FCCID == "OPS2" && d.SerialNumber == "101").Single();
         d1.NetworkId = 1;
         //var deviceList = dc1.Devices.Where(d => d.FCCID == "OPS2" && d.SerialNumber == "102").ToList();
         //foreach (var d2 in deviceList)
         //d2.NetworkId = 1;
         dc.SaveChanges();
    } 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:29:50.427

从您的错误消息看来，您的 linq 查询没有从数据库返回任何元素。您已检查设备信息在其中，但序列 ( `dc.Devices`) 返回为空。

检查这些事情：

*   数据肯定在正确的数据库表中
*   删除`Where()`子句，因为这可能过滤错误
*   检查 app.config 以确保您指向正确的数据库

# mod-rewrite - Glassfish 3.1.2 - 创建集群和部署应用程序 j_security_check 循环之后

> ID：10623527
> 
> 赞同：0
> 
> 时间：2012-05-16T17:23:28.457
> 
> 标签：mod-rewrite, glassfish, glassfish-3, mod-jk, j-security-check

我终于将我的应用程序部署到了 apache/mod_jk 负载平衡前面的 2 实例单节点测试集群。

在非集群环境中，我多年来一直使用 JDBCRealm 的容器安全性，并且它工作可靠。

在集群环境中，我在浏览器中获取登录页面，输入有效的用户名和密码，单击提交按钮，j_security_check 将响应头中的位置页面设置为登录页面，而不是欢迎文件。它转发到我们刚刚访问的登录页面。

我启用了 MySQL 常规查询日志，可以看到正在从正确的表中为正确的用户读取密码和组名。

我尝试设置 javax.enterprise.system.core.security.level=FINEST 但服务器日志中仍然没有输出。

使用部署到本地服务器而不是集群的相同应用程序，我可以访问 localhost:8080/ 并登录正常。如果我只是输入“localhost”并通过负载平衡器，它将无法工作。

我知道 j_security_check 可以转发到触发身份验证的页面（这可能是这里发生的事情），但是当没有“触发身份验证的页面”时，它何时转发到欢迎文件？**编辑：**我现在看到，它总是 302 重定向到引用者，在这种情况下是上下文根。容器必须有一些规则来确定实际显示哪个页面。在我的集群示例中，它不是来自 web.xml 的欢迎文件。

我还在集群配置中设置了我的身份验证领域：

```
asadmin> create-auth-realm --target c1 --classname com.sun.enterprise.security.auth.realm.jdbc.JDBCRealm --property jaas-context=jdbcRealm:datasource-jndi=jdbc/sportquest:user-table=users:user-name-column=username:password-column=password:group-table=users:group-name-column=groupname:digest-algorithm=SHA-256:encoding=Base64 
```

我能想到的两个环境之间的唯一区别是，在集群设置中，我有一个从 http -> https (httpd.conf) 转发的 mod_rewrite 规则：

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# This redirects from thingy.com to www.thingy.com
#
RewriteCond %{HTTP_HOST} !^thingy\.com$ [NC]  
RewriteRule ^(.*)$ %{HTTPS}://thingy.com/$1 [R=301,L] 
```

编辑：在 chrome 开发工具网络跟踪下方添加

部署为 /MyApp 的工作场景：

```
GET http://localhost:8080/MyApp - 301 Moved Permanently (from cache)
GET http://localhost:8080/MyApp/ - 200 Ok
 ... login page loads ...
POST http://localhost:8080/MyApp/j_security_check - 302 Moved Temporarily
  the form data contains user/pass as expected & response header Location:
  http://localhost:8080/MyApp/
GET http://localhost:8080/MyApp/ - 200 Ok
 ... welcome-file page loads ... 
```

部署为 root / 的不工作场景（集群）：

```
GET http://localhost/ - 301 Moved Permanently (from cache)
GET https://localhost/ - 200 Ok
 ... login page loads ...
POST https://localhost/j_security_check - 302 Moved Temporarily
  the form data contains user/pass as expected & response header Location:
  https://localhost/
GET https://localhost/ - 200 Ok
 ... the login page loads ... 
```

如果我输入了无效的登录凭据，那么在这两种情况下，我都会成功重定向到表单错误页面。

有人有什么建议吗？我只是没看到。谢谢。

ps 我确实尝试过清理浏览器缓存，没有帮助！

**更新：**问题在于，在 clustered/mod_jk 环境中，来自 j_security_check 的回发具有带有新 sessionid 的 Set-Cookie，因此下一个请求来自不同的会话。似乎这与粘性会话有关，但是我仍然不知道如何解决它。我尝试将负载均衡器sticky_sessions 设置为true 和false，但都没有帮助。

jvmRoute 为工作人员的两个实例设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T14:56:53.717

你为什么不直接使用 mod_proxy 和 mod_proxy_balancer 呢？这样，您可以为不同的上下文根设置反向 cookie 路径。如果您需要一些配置示例，请告诉我（在 iPhone atm 上）

# c++ - 从 boost::property_tree 读取数组出现空白

> ID：10623537
> 
> 赞同：2
> 
> 时间：2012-05-16T17:23:55.283
> 
> 标签：c++, boost, boost-propertytree

我正在尝试使用[此问题](https://stackoverflow.com/questions/4986052/boost-property-tree-working-with-simple-arrays-or-containers)`boost::property_tree`中显示的方法从 a 中读取数组数据。在该示例中，数组首先作为字符串读取，转换为字符串流，然后读入数组。在实施该解决方案时，我注意到我的字符串是空的。

示例输入（json）：

```
"Object1"
{
  "param1" : 10.0,
  "initPos" :
  {
    "":1.0,  
    "":2.0, 
    "":5.0 
  },
  "initVel" : [ 0.0, 0.0, 0.0 ]
} 
```

这两种数组表示法都被 boost json 解析器解释为数组。我确信数据存在于属性树中，因为在调用 json writer 时，数组数据存在于输出中。

这是失败的示例：

```
std::string paramName = "Object1.initPos";
tempParamString = _runTree.get<std::string>(paramName,"Not Found");
std::cout << "Value: " << tempParamString << std::endl; 
```

我什么时候`paramName`得到`"Object1.param1"`“10.0”作为字符串输出，什么时候得到一个空字符串，如果`paramName`是树中不存在的东西，则返回。`"Object1.initPos"``paramName``"Not Found"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T12:38:38.943

首先，确保提供的 JSON 是有效的。它看起来有一些问题。接下来，您不能将 Object1.initPos 作为字符串。它的类型是 boost::property_tree::ptree。您可以使用 get_child 获取它并进行处理。

```
#include <algorithm>
#include <string>
#include <sstream>

#include <boost/property_tree/ptree.hpp>
#include <boost/property_tree/json_parser.hpp> 

using namespace std;
using namespace boost::property_tree;

int _tmain(int argc, _TCHAR* argv[])
{
    try
    {
        std::string j("{ \"Object1\" : { \"param1\" : 10.0, \"initPos\" : { \"\":1.0, \"\":2.0, \"\":5.0 }, \"initVel\" : [ 0.0, 0.0, 0.0 ] } }");
        std::istringstream iss(j);

        ptree pt;
        json_parser::read_json(iss, pt);

        auto s = pt.get<std::string>("Object1.param1");
        cout << s << endl; // 10

        ptree& pos = pt.get_child("Object1.initPos");
        std::for_each(std::begin(pos), std::end(pos), [](ptree::value_type& kv) { 
            cout << "K: " << kv.first << endl;
            cout << "V: " << kv.second.get<std::string>("") << endl;
        });
    }
    catch(std::exception& ex)
    {
        std::cout << "ERR:" << ex.what() << endl;
    }

    return 0;
} 
```

输出：

```
10.0
K:
V: 1.0
K:
V: 2.0
K:
V: 5.0 
```

# objective-c - UIColor SetFill 不起作用

> ID：10623545
> 
> 赞同：1
> 
> 时间：2012-05-16T17:24:20.510
> 
> 标签：objective-c, ios, core-graphics, uicolor

在这段代码中

```
for (int i=0;i<3;i++) {
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*(i+1), self.yShift+self.rectLen*10);
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*(i+1), self.yShift+self.rectLen*10+self.rectLen);
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*i, self.yShift+self.rectLen*10+self.rectLen);
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*i, self.yShift+self.rectLen*10);
    CGContextMoveToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*i, self.yShift+self.rectLen*10);
}
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*4, self.yShift+self.rectLen*10);
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*4, self.yShift+self.rectLen*10+self.rectLen);
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*3, self.yShift+self.rectLen*10+self.rectLen);
    CGContextAddLineToPoint(context, self.xShift+15+self.rectLen*self.width+self.rectLen*3, self.yShift+self.rectLen*10);
    [[UIColor cyanColor] setFill];
    [[UIColor blackColor] setStroke];
    CGContextSetLineWidth(context, 1);
    CGContextDrawPath(context, kCGPathStroke); 
```

使用 setFill 方法行不通。这可能是什么问题？代码位于drawRect:方法中

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T17:52:19.293

setFill 不是用于 Core Graphics 绘图，而是用于像 [myUIBezierPath fill] 这样的绘图；

而是使用以下方法设置填充颜色和描边颜色：

```
CGContextSetFillColorWithColor(context, [[UIColor cyanColor] CGColor]);
CGContextSetStrokeColorWithColor(context, [[UIColor blackColor] CGColor]); 
```

此外，以下行：

```
CGContextDrawPath(context, kCGPathStroke); 
```

只会*描边*路径，因为绘图模式设置为 kCGPathStoke。要填充它，您应该将其替换为

```
CGContextDrawPath(context, kCGPathFillStroke); 
```

如果您的路径中有洞或交叉，您应该使用奇偶填充和描边

```
CGContextDrawPath(context, kCGPathEOFillStroke); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:19:13.877

您不仅需要`CG*`像 David 建议的那样调用适当的方法来设置填充，还需要在设置填充和描边属性后使用以下内容实际执行填充：

```
CGContextSetFillColorWithColor(context, [UIColor cyanColor].CGColor);
CGContextSetStrokeColorWithColor(context, [UIColor blackColor.CGColor);
CGContextFillPath(context);
CGContextStrokePath(context); 
```

# php - 结合两个查询：从朋友表中选择朋友并加入用户表

> ID：10623546
> 
> 赞同：0
> 
> 时间：2012-05-16T17:24:27.073
> 
> 标签：php, mysql

我有两张桌子，一张供用户使用，用于保存用户信息，另一张供朋友使用

```
users_table   :  id , username , avatar
friends_table :  id , u1_id , u2_id 
```

现在我想在他的个人资料中显示每个用户的朋友

我想用一个查询来做

所以在朋友表中，我的用户可能在 u1_id 或 u2_id 中，这取决于谁请求了友谊

因为我想将每个朋友加入 users_table 并获取他的用户名和头像，我不能简单地做

```
select * from friends_table where u1_id = $profile_id || u2_id = $profile_id 
```

所以我必须运行两个查询

```
select f.u1_id , u.username , u.avatar from friends_table f join users_table u on f.u1_id = u.id
where f.u2_id = $profile_id 

select f.u2_id , u.username , u.avatar from friends_table f join users_table u on f.u2_id = u.id
where f.u1_id = $profile_id 
```

有没有办法用一个查询来做到这一点？

或类似的东西

```
select f.u1_id ,  f.u2_id , u.username , u.avatar from friends_table where u1_id = $profile_id || u2_id = $profile_id

if( u1_id = $profile_id )
join users_table u on f.u2_id = u.id

if( u2_id = $profile_id )
join users_table u on f.u1_id = u.id 
```

**我的问题是在加入部分，我想在朋友 ID 上加入 Friends_table 和 usres_table，而不是个人资料 ID 的当前所有者**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:28:33.230

```
select u.id,
    u.username,
    u.avatar
from friends_table f
join users_table u on f.u1_id = u.id || f.u2_id = u.id
where u.ID <> $profile_id
    and (f.u1_id = $profile_id || f.u2_id = $profile_id) 
```

# php - 填充下拉列表

> ID：10623547
> 
> 赞同：0
> 
> 时间：2012-05-16T17:24:27.780
> 
> 标签：php, ajax

我有三个下拉列表：国家、州和城市。

我想根据国家列表中的选择填充州列表，并根据州列表中的选择填充城市列表。

这是我尝试过的方法

1.  从国家列表中，我使用 onchage 事件调用 java 脚本函数。

    ```
    <select name="country" id="id1" onchange="onCountryChange(this.value)"> 
    ```

2.  然后我向服务器发送请求以获取与国家相关联的州名。

    ```
    function onCountryChange(str){
        if (window.XMLHttpRequest){ 
            xmlhttp=new XMLHttpRequest();
        }
        else{
             xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function(){
        if (xmlhttp.readyState==4 && xmlhttp.status==200){
                document.getElementById("statenames").innerHTML=xmlhttp.responseText;
        }
    }
    xmlhttp.open("GET","./view/countrychange.php?countryname="+str,true);
    xmlhttp.send();
     } 
    ```

3.  我使用以下代码获取状态值。

    ```
    <?php
    $countryname=$_GET["countryname"];
    $connection = pg_connect("host=localhost port=5432 dbname=STAGE2 user=postgres password=jssate");
    if (!$connection){
        echo "<H1>Error in connection to Database</H1>";
        echo "<H2>Please try again</H2>.";
    }
    else{
        $query1="Select distinct(state) from master_table where country='$countryname'";
    $result = pg_query($connection,$query1);
    $numrows = pg_numrows($result);     
    if ($numrows>0){
    echo "State <select name="state" id="stateid">;
    for ($row_index=0;$row_index<$numrows;$row_index++)
    {
        $state_name=pg_result($result,$row_index,0);
        echo "<option value="$state_name\">$state_name</option>";
            }
    echo "</select>";
    }

    }
    pg_close($connection);
    ?> 
    ```

3 .在我的客户端使用以下代码来显示结果。

```
 <div id="statenames">
    //Original select list placed here is replaced by the one returned by server.
    </div> 
```

这对我有用，并且州是根据国名填充的。现在我如何填充第三个列表。我选择的显示状态列表的方法是否正确？因为我无法控制我现在得到的状态选择列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:59:33.487

在您的 html 页面中创建 3 个选择国家、城市和州的选择

*   只有国家选择元素将有选项，州和城市将为空。
*   在更改国家/地区发送事件和 ajax 请求以获取状态时，作为响应仅发送选项元素**不要**像您所做的那样将它们包装在 SELECT 中
*   将这些选项推送到 state 的 select 元素中

    document.getElementById('state').innerHTML(state_ajax_response);

然后在您的 html 文件中创建将在状态选择更改时调用的函数，并再次为城市选择重复该过程

希望你能明白。

只需发送选项元素作为响应。

# c - 数组索引的散列

> ID：10623549
> 
> 赞同：3
> 
> 时间：2012-05-16T17:24:36.633
> 
> 标签：c, hash

在我的 C 程序中，我在一个结构中分配了四个 8 位 ( *char ) 变量。*如果我想对这些数字进行哈希处理以创建索引数组的键（代表整个结构），我该怎么办？（在程序中有很多这样的结构；因为我经常需要在符号表中搜索它们是否存在，如果我不想创建其他的，我不知道使用哪种哈希算法，如果我'想要做一个键索引搜索）。

我考虑过一种散列方法，它采用四个数字，将它们转换为十六进制数字，将它们连续放置，然后将输出的数字转换为十进制数字。

但是我需要一些不那么“沉重”的东西……这种方法似乎太虚荣了，我认为它不太适合创建数组索引。

是吗？如果可能的话，是否还有另一种哈希函数，它占用的内存也少于 32 位？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:29:33.713

一种可能性（我不认为 OP 正在描述）是将 4 个 char 值组合成一个 32 位整数，然后用哈希表的大小（可能是质数）对其进行修改：

```
unsigned int combined = (c1 << 24 ) | (c2 << 16 ) | (c3 << 8 ) | (c4);
unsigned int hashval = combined % hashtablesize; 
```

它当然取决于 4 个单独字节的实际预期值，但这种类型的散列相当有效并且通常具有良好的分布。最好用预期的数据集测试生成的哈希值，以确保分布有点均匀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T19:11:07.367

您可能想看看这个[散列函数列表](http://en.wikipedia.org/wiki/List_of_hash_functions)。

为了实现哈希表（我想这是您的目标），您需要一个具有[雪崩效应](http://en.wikipedia.org/wiki/Avalanche_effect)的哈希函数来避免类似输入值的过多哈希冲突。

当然，您可以使用任何函数将您的字符转换为任意整数表示，但如果此表示对于不同的输入没有变化，则您实际上具有链表的性能（想象使用表大小为的其他建议之一256 并且没有任何结构在字节 4 上变化）。您对 32 位哈希有什么顾虑？当然你会使用`hash%tablesize`索引？

通常您也不会使用加密散列函数（例如 md5、sha-1）。只需选择一种非加密散列函数（例如 Pearson/Jenkins 散列）。

```
/* jenkins hash, copied from http://en.wikipedia.org/wiki/Jenkins_hash_function */
uint32_t jenkins_one_at_a_time_hash(char *key, size_t len)
{
  uint32_t hash, i;
  for(hash = i = 0; i < len; ++i)
  {
    hash += key[i];
    hash += (hash << 10);
    hash ^= (hash >> 6);
  }
  hash += (hash << 3);
  hash ^= (hash >> 11);
  hash += (hash << 15);
  return hash;
} 
```

旁注：当您拥有良好的哈希值分布时，还要确保哈希表的大小足够大。随着数组的占用率（负载因子）接近 1，您将观察到性能下降，因为哈希冲突的可能性会增加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:36:21.657

为什么不将结构放入数组中？

```
#include <stdio.h>

typedef struct {
  char a,b,c,d;
} item;
item items[20];

int main(int argc, char *argv[])
{
  items[0].a = 4;
  items[0].b = 6;
  items[0].c = 1;
  items[0].d = 3;
  // ...
  items[4].a = 12;
  // ...
  printf("%d %d %d %d\n", items[0].a, items[0].b, items[0].c, items[0].d);
  return 0;
} 
```

显然，这是内存占用较少的解决方案，因为数据直接存储在主数组中，因此不需要散列索引，因为数组的索引可以在不消耗内存的情况下完成这项工作。

当然，您可以使用指针、一些 C++ 向量功能等。但这是最简单有效的方法。

唯一需要注意的是，您必须知道数组的大小（您将拥有多少项目）或不超过 XXX 的最大值......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:54:45.297

> 如果可能的话，是否还有另一种哈希函数，它占用的内存也少于 32 位？

这是一个虚幻的问题。键是一个数组索引——它不存储在任何地方，它是在查找时计算的。C 中的数组是连续的块，根据数组的开头和类型的大小乘以索引来访问各个元素。

对于键，只需将值转换为无符号的 32 位类型（不要只使用`int`或`unsigned int`，因为大小不一定是 32 位）：

```
#include <inttypes.h>
char x[4] = { 'A', 'B', 'C', 'D' };
uint32_t *key = (uint32_t*)&x; 
```

然后根据表格大小做模数。

# java - (java) 确保插件工厂存在特定的构造函数

> ID：10623553
> 
> 赞同：1
> 
> 时间：2012-05-16T17:24:52.367
> 
> 标签：java, design-patterns, reflection, factory

接口和抽象类都不能规定子类要实现的构造函数类型（请参阅[如何强制在我的抽象类的所有子类中定义构造函数](https://stackoverflow.com/questions/3164334/how-can-i-force-a-constructor-to-be-defined-in-all-subclass-of-my-abstract-class)）

现在我有一个由许多子类实现的接口。程序通过反射在运行时发现这些子类。
我想要一个插件工厂来实例化它们（[参见这里](http://www.javapractices.com/topic/TopicAction.do;jsessionid=19B52069B08BD3E7055D5C8AE67C8AE7?Id=237)的例子）。

问题是所有示例都假定所有子类都具有特定类型的构造函数（例如，没有参数）。但我不能确定这一点。由于我不能强制子类具有特定的构造函数，我应该怎么做才能避免运行时错误？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:35:44.800

因此，由于您使用反射，您可以使用[getConstructor(java.lang.Class...)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Class.html)（抱歉，无法粘贴指向方法 JavaDoc 的链接）来查看 ctor 是否存在，如果存在，则使用特定的调用它论据。

# java - 循环中的 BufferedReader 错误

> ID：10623557
> 
> 赞同：0
> 
> 时间：2012-05-16T17:24:57.130
> 
> 标签：java, input, console, buffered

这个循环第一次迭代效果很好，但是在我按下 char 'y' 以重复之后，下次它显示时，它不会让我输入另一个名字。我不知道是什么原因造成的，但是当您需要清除输入缓冲区时，它让我想起了 C。

任何帮助都将不胜感激。

```
byte counter = 1;
boolean myCondition = false;
List<String> myList = new ArrayList();
BufferedReader objReader = new BufferedReader(new InputStreamReader(System.in));

do{
    System.out.println("Enter the #" +counter +" person's name:");
    // low quality validation
    String dude = objReader.readLine();

    while (myList.contains(dude)){
        System.out.println("Man, this dude:" +dude +" is already loaded into the List! Pick another name:\n");
        dude = objReader.readLine();            
    }

    myList.add(dude);
    counter++;
    System.out.println("Would you like to add another name to the list? yes/no");

    char myChar = (char) System.in.read();

    if (myChar == 'y' || myChar == 'Y')
        myCondition = true;
    else
        myCondition = false;

    } while (myCondition); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:36:59.747

Look at your code:

1.  You read character 'y'
2.  The `char myChar = (char) System.in.read();` waits until you press `Enter`
3.  myChar is now 'y'. This leaves '\n' (`Enter') in buffer
4.  Next `String dude = objReader.readLine();` reads line ended by '\n' that is present already in buffer.

You should read whole line instead simple `read()`

If you want better resolution of y:

```
String line = objReader.readLine();
myCondition = line.startsWith("Y") || line.startsWith("y"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:48:07.003

尝试这个，

```
System.out.println("Would you like to add another name to the list? yes/no");
Scanner scan = new Scanner(System.in);
String myChar = scan.nextLine();

if (myChar.equals("y") || myChar.equals("Y"))
    myCondition = true;
else
    myCondition = false; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:56:05.177

使用扫描仪和其他一些小的代码更改可以正常工作。

```
 byte counter = 1;
            boolean myCondition = false;
            Scanner scan = new Scanner(System.in);
            List<String> myList = new ArrayList();

            do{
                  System.out.println("Enter the #" + counter + " person's name:");
                  // low quality validation
                  String dude = scan.nextLine();
                  while (myList.contains(dude)) {
                    System.out.println("Man, this dude:" + dude + " is already loaded into the List! Pick another name:\n");
                  }
                  myList.add(dude);
                  counter++;
                  System.out.println("Would you like to add another name to the list? yes/no");
                  String choice = scan.nextLine();
                  if (choice.equalsIgnoreCase("Y")) {
                    myCondition = true;
                  } else {
                    myCondition = false;
                  }

             } while (myCondition); 
```

在退出程序之前，我运行它并输入了总共七个名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:27:43.437

尝试`BufferedReader objReader = new BufferedReader(new InputStreamReader(System.in));`在你的 do/while 循环中移动。每次都应该重新初始化它，那样。

# ios - iOS - 无法将图像对象添加到 NSMutableArray

> ID：10623559
> 
> 赞同：1
> 
> 时间：2012-05-16T17:25:15.697
> 
> 标签：ios

我正在尝试添加已存储到 NSMutableArray 的图像。在循环中，我可以看到每个图像，但是当我尝试将它们添加到我的图像数组中时，我得到的计数为 0。

我有以下代码：

。H

```
#import <UIKit/UIKit.h>

@class Schedule;

@interface PMCViewController : UIViewController  <UITableViewDelegate, UITableViewDataSource>

@property (weak, nonatomic) NSMutableArray *images;
@property (weak, nonatomic) IBOutlet UIScrollView *scrollView;
@property (weak, nonatomic) Schedule *schedule;

- (IBAction)OpenAdmin:(id)sender;
- (IBAction)OpenSchedules:(id)sender;

@end 
```

并将它们放在我的实现文件中：

.m

```
- (void)viewWillAppear:(BOOL)animated {

[super viewWillAppear:animated];
[self.navigationController setNavigationBarHidden:YES];

NSArray *schedules = [[ScheduleStore sharedStore] allSchedules];

scrollView.delegate = self;
scrollView.scrollEnabled = YES;
scrollView.pagingEnabled = YES;

int scrollWidth = 120;
scrollView.contentSize = CGSizeMake(scrollWidth,80); 

int xOffset = 0;

for (int i=0; i < [schedules count]; i++) {

    Schedule *selectedSchedule = [schedules objectAtIndex:i];
    NSString *ik = [selectedSchedule imageKey];

    UIImageView *img = [[UIImageView alloc] init];
    //img.bounds = CGRectMake(10, 10, 50, 50);
    //img.frame = CGRectMake(5+xOffset, 0, 50, 50);
    //img.backgroundColor = [UIColor blackColor];
    //img.image = [[ScheduleImageStore sharedStore] imageForKey:ik];

    [img setBounds:CGRectMake(10, 10, 50, 50)];
    [img setFrame:CGRectMake((5+xOffset), 0, 50, 50)];
    [img setBackgroundColor:[UIColor blackColor]];
    [img setImage:[[ScheduleImageStore sharedStore] imageForKey:ik]];

    [images addObject:img];
    scrollView.contentSize = CGSizeMake(scrollWidth+xOffset,50); 
    [scrollView addSubview:[images objectAtIndex:i]];

    xOffset += 70;

}
NSLog(@"Number of img added: %i",[images count]);

[[self scheduleView] reloadData];
} 
```

我尝试了点表示法和常规表示法，但这并没有什么不同。我似乎无法将项目添加到图像数组中。这可能是内存问题吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:33:32.580

你需要初始化`images`数组。

# user-interface - 可以将填充水平设置为低于 Gtk::Scale 的值吗？

> ID：10623566
> 
> 赞同：2
> 
> 时间：2012-05-16T17:25:33.923
> 
> 标签：user-interface, gtk, gtkmm

虽然使用`set_fill_level`将填充水平设置在比例值以下来将填充水平设置在比例值之上是很简单的，但似乎不起作用。

为了澄清我想，例如，能够在滑块为 50% 时将填充水平设置为 25%

```
FFFF----S------- 
```

*   我错过了一些明显的东西吗？

或者：

*   有谁知道一个聪明的黑客来让它工作？

额外细节：

*   libgtk2.0-dev
*   libgtkmm-2.4-dev
*   Ubuntu 10.04.4
*   默认主题（氛围）

不良行为的图像：

![在此处输入图像描述](../Images/392b3bac8a7a3e81f3e43ae346bf18d0.png)

![在此处输入图像描述](../Images/1b1c790d4b3fd440fcd9a957d4ae61d3.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T10:53:53.910

您只需要禁用限制：

> 此外，可以将范围的滑块位置限制为小于填充水平的值。这是控制器*[原文如此]*，[`gtk_range_set_restrict_to_fill_level()`](http://developer.gnome.org/gtk3/unstable/GtkRange.html#gtk-range-set-restrict-to-fill-level)默认情况下启用。

（[来源](http://developer.gnome.org/gtk3/unstable/GtkRange.html#gtk-range-set-fill-level)）

**更新：**示例：

![GtkHScale 填充级别 = 3 和值 = 5](../Images/4245195b2e4af7223ea6f2e332ecce79.png)

```
import gtk

s = gtk.HScale()
s.set_show_fill_level(True)
s.set_restrict_to_fill_level(False)  # <=====
s.set_range(0, 10)
s.set_fill_level(3)
s.set_value(5)

w = gtk.Window()
w.connect('destroy', lambda *x: gtk.main_quit())
w.add(s)
w.show_all()
gtk.main() 
```

**更新 2：**您的屏幕截图中看到的问题很可能是 GTK+ 主题中的错误。我测试的大约一半的主题（包括 GTK+ 2 和 3）都有这个问题。作为记录，我的截图是使用 Adwaita (GTK+ 3) 主题拍摄的。

# android - 使用另一个按钮或控件调用微调器的 onClickListener

> ID：10623569
> 
> 赞同：1
> 
> 时间：2012-05-16T17:25:48.887
> 
> 标签：android, android-widget, android-spinner

是否可以从另一个调用 a （使`Spinner`'项目列表出现的那个）？如果是这样，我该怎么做？我正在按照 iOS 的思路进行思考，如果我想从其他地方调用控件的操作，我可以引用该控件并发送适当的回调消息。`onClickListener``Spinner``Button`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:29:09.273

```
spinner.performClick(); 
```

您可以使用按钮的 onclick 显示微调器。因此，将上面的行放在按钮的 clicklistener 中。

# android - 如何以编程方式将 9-patch 图像重新应用到 ImageView？

> ID：10623570
> 
> 赞同：5
> 
> 时间：2012-05-16T17:25:52.237
> 
> 标签：android, android-layout, android-widget, android-imageview, nine-patch

我有一个在 Horizo​​ntalScrollView 中定义的 ImageView 的活动。图像源是一个 9-patch 文件，它被限制为仅拉伸右边缘以填充屏幕。我已经实现了一个简单的缩放功能，它允许用户通过调整位图大小并将新位图分配给视图来放大和缩小。我当前的问题是，当我双击以缩小时，当我将新的调整大小的位图分配给视图时，不会应用 9-patch。换句话说，它不是仅拉伸 9-patch 文件中定义的右边缘，而是拉伸了整个图像。

这是我的 XML：

```
<HorizontalScrollView
            android:id="@+id/hScroll"
            android:fillViewport="true"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:fadingEdge="none" >

            <RelativeLayout
                android:id="@+id/rlayoutScrollMap"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent" >

                <ImageView
                    android:id="@+id/imgResultMap"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:scaleType="fitXY"
                    android:src="@drawable/map_base"/>

            </RelativeLayout>
        </horizontalScrollView> 
```

这是我的代码的相关部分，在 onDoubleTap() 调用中：

```
public boolean onDoubleTap(MotionEvent e)  
                {  
                    if (zoom == 1) {
                        zoom = 2; // zoom out
                    } else {
                        zoom = 1; // zoom in
                    }
                    Bitmap image = BitmapFactory.decodeResource(getResources(),R.drawable.map_base);            
                    Bitmap bmp = Bitmap.createScaledBitmap(image, image.getWidth() * zoom, image.getHeight() * zoom, false);
                    ImageView imgResultMap = (ImageView)findViewById(R.id.imgResultMap);
                    imgResultMap.setImageBitmap(bmp);

                    return false; 
                } 
```

**编辑**：在做了一些研究之后，我想通了。我不仅需要操作位图，还需要包含 9-patch 块，它不是位图图像的一部分，以重新构造一个新的 9-patch 可绘制对象。请参阅下面的示例代码：

```
 ...
 else {
        // Zoom out
        zoom = 1;
        Bitmap mapBitmapScaled = mapBitmap; 
        // Load the 9-patch data chunk and apply to the view
        byte[] chunk = mapBitmap.getNinePatchChunk();
        NinePatchDrawable mapNinePatch = new NinePatchDrawable(getResources(), 
            mapBitmapScaled, chunk, new Rect(), null);
        imgResultMap.setImageDrawable(mapNinePatch);
 }

  .... 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-17T16:45:54.223

**编辑**：在做了一些研究之后，我想通了。我不仅需要处理位图，还需要包含 9-patch 块，它不是位图图像的一部分，以重新构造一个新的 9-patch 可绘制对象。请参阅下面的示例代码：

```
 ...
 else {
        // Zoom out
        zoom = 1;
        Bitmap mapBitmapScaled = mapBitmap; 
        // Load the 9-patch data chunk and apply to the view
        byte[] chunk = mapBitmap.getNinePatchChunk();
        NinePatchDrawable mapNinePatch = new NinePatchDrawable(getResources(), 
            mapBitmapScaled, chunk, new Rect(), null);
        imgResultMap.setImageDrawable(mapNinePatch);
 }

  .... 
```

**编辑#2**：对于那些在此处查看我的解决方案的人，还请查看 Kai 下面关于内存管理的建议。非常有用的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-17T02:01:32.027

为什么不只包含两个不同的缩放图像并`imgResultMap.setImageResource(resId)`在缩放时在它们之间切换？另请注意，您正在 UIThread 中加载和创建位图，这不是提供流畅用户体验的好方法，至少在 onCreate() 期间仅预加载位图一次并缓存它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:53:21.260

将 this: 移动 `ImageView imgResultMap = (ImageView)findViewById(R.id.imgResultMap);` 到 onCreate 方法中的全局初始化。否则，设备必须在每次点击时搜索视图并找到它。

并尝试`imgResultMap.invalidate();`在从 onDoubleTap 方法返回之前调用（[http://developer.android.com/reference/android/view/View.html#invalidate()](http://developer.android.com/reference/android/view/View.html#invalidate%28%29)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-19T11:40:08.713

另一种解决方案是以编程方式将图像设置为 ImageResource 并设置 scaleType

```
imageView.setImageResource(R.drawable.favorite_driver_icon);
imageView.setScaleType(ScaleType.FIT_XY); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-01T18:42:12.107

9-patch 图片似乎只在设置为 a`View`的背景图片时才有效。所以：

*   而不是`android:src`,`android:background`在您的布局 XML 中设置，并且
*   `setBackgroundResource()`当您想更改图像时调用。

如果你愿意，你也可以使用 plain`View`而不是 an ；`ImageView`这并不重要。

# couchdb - 启动 Couchdb 时出错

> ID：10623572
> 
> 赞同：1
> 
> 时间：2012-05-16T17:25:55.800
> 
> 标签：couchdb

我正在使用 MacOS 并使用自制软件安装了 couchdd。我能够成功运行它，但是当我更改 bind_address 时，它似乎已经停止工作。我尝试更改 .ini 文件上的设置，还尝试卸载和重新安装，但仍然无济于事。这是我得到的错误

```
Apache CouchDB 1.2.0 (LogLevel=info) is starting.
[error] [<0.92.0>] {error_report,<0.30.0>,
                       {<0.92.0>,supervisor_report,
                        [{supervisor,{local,couch_secondary_services}},
                         {errorContext,start_error},
                         {reason,
                             {'EXIT',
                                 {{badmatch,{error,einval}},
                                  [{mochiweb_socket_server,parse_options,2,
                                       [{file,"mochiweb_socket_server.erl"},
                                        {line,91}]},
                                   {mochiweb_socket_server,start,1,
                                       [{file,"mochiweb_socket_server.erl"},
                                        {line,39}]},
                                   {couch_httpd,start_link,2,
                                       [{file,"couch_httpd.erl"},{line,148}]},
                                   {supervisor,do_start_child,2,
                                       [{file,"supervisor.erl"},{line,303}]},
                                   {supervisor,start_children,3,
                                       [{file,"supervisor.erl"},{line,287}]},
                                   {supervisor,init_children,2,
                                       [{file,"supervisor.erl"},{line,253}]},
                                   {gen_server,init_it,6,
                                       [{file,"gen_server.erl"},{line,304}]},
                                   {proc_lib,init_p_do_apply,3,
                                       [{file,"proc_lib.erl"},{line,227}]}]}}},
                         {offender,
                             [{pid,undefined},
                              {name,httpd},
                              {mfargs,{couch_httpd,start_link,[]}},
                              {restart_type,permanent},
                              {shutdown,brutal_kill},
                              {child_type,worker}]}]}}
{"init terminating in do_boot",{{badmatch,{error,{bad_return,{{couch_app,start,[normal,["/usr/local/etc/couchdb/default.ini","/usr/local/etc/couchdb/local.ini"]]},{'EXIT',{{badmatch,{error,shutdown}},[{couch_server_sup,start_server,1,[{file,"couch_server_sup.erl"},{line,98}]},{application_master,start_it_old,4,[{file,"application_master.erl"},{line,274}]}]}}}}}},[{couch,start,0,[{file,"couch.erl"},{line,18}]},{init,start_it,1,[]},{init,start_em,1,[]}]}} 
```

# android - Android 开发，SDK 版本

> ID：10623575
> 
> 赞同：0
> 
> 时间：2012-05-16T17:26:12.630
> 
> 标签：android

第一次为安卓开发。

我注意到最新的 SDK 是 v4.x 但我非正式地注意到大多数人都在运行 v2.3

如果我使用 4.x SDK 开发应用程序。它会拒绝在 2.3 手机上运行吗？还是会禁用某些功能？

我应该改用 2.3 SDK 开发吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T17:37:47.170

在回答问题之前，应该澄清一些事情：Android 版本（2.3、4.x 等）与其运行的 API 版本之间存在差异（始终是整数：10、11、12、 ETC）。Android 平台及其各自 API 版本之间的关系可以[在此页面上](http://developer.android.com/resources/dashboard/platform-versions.html)找到。例如，Android 2.3 使用 API 10，Android 4.0 使用 API 15。

此外，只有一个 SDK，它具有可下载的模块，用于针对各种版本的 API 进行编码。因此，并不是您使用的是 SDK 的 v4.x，而是您使用的是 SDK、周期和针对 API 15 版的编码:)。

也就是说：最好将 minSdkVersion 设置为您的应用程序将运行的最低 Android 版本，并将 targetSdkVersion 设置为最新的 Android 版本。然后您可以使用 Build.VERSION_CODES 在运行时检查平台的新版本，并根据需要激活新的平台功能。关于如何做到这一点的一个很好的教程在 Android 开发者博客上，标题为[How to have your cupcake, and eat it too](http://android-developers.blogspot.com/2010/07/how-to-have-your-cupcake-and-eat-it-too.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:49:52.557

我什至建议以 2.2 为目标，因为我仍有大量用户 (16%) 运行 Android 2.2。这是我的一个应用程序的细分，它显示了用户当前正在运行的版本。（[见附图](http://www.matthew-moses.com/images/active_installs_by_android_version.png)）。就像 J. Maes 所说的那样，您可以构建的越低，您可以捕获的用户就越多。尽管您必须通过使用旧版 SDK 进行权衡。对于大多数目的，我没有太多针对 2.2 的问题。它使我能够接触到更大的客户群。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:27:44.237

您应该使用支持您要在应用程序中使用的所有功能的最低版本。如果您认为 4.x 功能在您的应用程序中是绝对必要的，那么您应该使用它。如果没有，请使用 2.3，以便更多人可以运行它，因为 Android 向后兼容。

# mongodb - 如何使用 mongodb 从教义 ODM 中的引用文档数组中删除文档

> ID：10623577
> 
> 赞同：3
> 
> 时间：2012-05-16T17:26:15.290
> 
> 标签：mongodb, symfony, doctrine, doctrine-orm

我有一个 php 对象映射到具有结构的 mongodb 文档（称为节点）

```
use Doctrine\ODM\MongoDB\Mapping\Annotations as MongoDB;

class Node{
    /**
    * @MongoDB\Id
    */
    protected $id;

    /**
    * @MongoDB\String
    */
    protected $domain;

    /**
    * @MongoDB\ReferenceMany(targetDocument="NodeItem",cascade=     
    * {"persist"},simple="true")
    */
    protected $items = array();

    //getter and setters below
} 
```

还有一个名为 NodeItem 的参考文档，

```
class NodeItem {

  /**
  * @MongoDB\Id
  */
  protected $id;

  /**
  * @MongoDB\String
  */
  protected $name;

  /**
   * @MongoDB\ReferenceOne(targetDocument="Node", cascade={"persist"},    
   *  simple="true")
   */
   protected Node;

   //setter and getters 
} 
```

正如上面的注释所反映的，“节点”引用了存储在 $items 数组中的许多“节点项”，而“节点项”引用了一个“节点”。所以这些是双向引用的集合。

我的问题是如何有效地从其集合中删除一些'NodeItem'文档（基于可用ID的数组），以便删除的NodeItem文档也从'Node'中的$items数组引用中删除（我认为级联删除是我要的吗？）。

我写了一个函数，代码如下：

```
 $qb = $this->dm->createQueryBuilder('SomeBundleBundle:NodeItem');
    /*
     * deletes from NodeItem collection
     */
    foreach($NodeItemsArray as $itemId){
        $qb->remove()->field('id')->equals($itemId)->getQuery()->execute();
    } 
```

但是上面的函数只是从 NodeItem 集合中删除了文档，而 'Node' 的 $items 数组中的关联项并没有被删除。此外，注释中的 {cascade:persist} 似乎没有帮助。代码在 Symfony 2 框架中实现

一些帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T07:36:54.143

实现这一点的唯一方法是使用 onRemove 事件的侦听器。

但是@jmikola 已经提到，您必须使用 $dm->remove() 方法，而不是 QueryBuilder （因为它还不支持事件）。

* * *

所以，**要删除项目**：

```
//Get the NodeItem you want in the items array and delete it:
$items = $node->getItems();
$dm->remove($items->get(2)); //Remove the third item as an example 
```

* * *

并**注册事件**：

```
class CascadeNodeDeleterListener {
        public function preRemove(LifecycleEventArgs $eventArgs) {

        $odm = $eventArgs->getDocumentManager(); /* @var $odm DocumentManager */
        $object = $eventArgs->getDocument();
        if($object instanceOf NodeItem) {
                $node = $object->getNode();
                $items = $node->getItems();
                $items->removeElement($object);
                $class = $dm->getClassMetadata(get_class($node));
                $dm->getUnitOfWork()->recomputeSingleDocumentChangeSet($class, $node);
            }

        }
} 
```

在`services.yml`：

```
 <service id="listener" class="CascadeNodeDeleterListener">
      <tag name="doctrine.common.event_listener" event="onRemove" />
 </service> 
```

请参阅更多信息中的[Doctrine ODM 事件。](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/events.html#implementing-event-listeners)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T22:18:54.240

ODM 中的级联行为仅受 UnitOfWork 操作的尊重。MongoDB 本身并不支持级联和触发器（无论如何）。在您的情况下，查询构建器将构造并执行如下查询：

```
db.node_items.remove({"_id": ObjectId("...")}) 
```

根本不涉及 UnitOfWork（没有分阶段操作或刷新），也没有触发级联。

另一方面，假设您有一个托管`$nodeItem`对象。将其传递给`DocumentManager::remove()`将调用 UnitOfWork 并导致映射的任何引用文档`cascade=REMOVE`也`cascade=ALL`被删除。当然，您必须调用`flush()`才能在 MongoDB 中执行操作。

根据您当前的代码，将级联的唯一操作是`DocumentManager::persist()`. 在实践中，我假设您将创建一个节点，构造并向其添加一些 NodeItem，然后持久化该节点（允许其项目自动持久化）。

如果 NodeItems 只属于单个节点，您可能希望避免`cascade=REMOVE`并`$nodeItem->getNode()->getItems()->removeElement($nodeItem)`在删除`$nodeItem`自身之后但在`flush()`.

另外，我注意到您正在将您的集合字段初始化为一个数组。稍后，ODM 将把这个领域作为一个`Doctrine\ODM\MongoDB\PersistentCollection`实例进行水化，这可能会导致模棱两可。作为最佳实践，您应该`Doctrine\Common\Collections\ArrayCollection`在构造函数中初始化此类字段。这样，您总是可以期望它们成为`Collection`实例。

# jquery - 如何在jquery幻灯片中添加点击下一张图片

> ID：10623578
> 
> 赞同：0
> 
> 时间：2012-05-16T17:26:15.870
> 
> 标签：jquery, slideshow

我正在使用 Jon Raasch (http://jonraasch.com/blog/a-simple-jquery-slideshow) 的 Simple jQuery Slideshow Script 并且想知道如何让用户单击图像以转到下一个图像，同时还保持幻灯片的自动播放模式。第一次尝试建立网站，所以我对源代码/ css/jquery有非常基本的了解。

我是否也必须同时修改 js 文件和源代码？我将如何修改它？如果有人可以提供帮助，将不胜感激。

谢谢！

> ```
> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html 
> ```
> 
> xmlns="http://www.w3.org/1999/xhtml">
> 
> csutoras+liando
> 
> /*** 由 Jon Raasch (jonraasch.com) 在 FreeBSD 许可下发布的简单 jQuery 幻灯片脚本：免费使用或修改，不对任何事情负责，等等。如果你喜欢它，请给我链接 :) ***/ 功能slideSwitch() { var $active = $('#slideshow DIV.active');
> 
> ```
> if ( $active.length == 0 ) $active = $('#slideshow DIV:last');
> 
> // use this to pull the divs in the order they appear in the markup
> var $next =  $active.next().length ? $active.next()
>     : $('#slideshow DIV:first');
> 
> // uncomment below to pull the divs randomly
> // var $sibs  = $active.siblings();
> // var rndNum = Math.floor(Math.random() * $sibs.length );
> // var $next  = $( $sibs[ rndNum ] );
> 
> $active.addClass('last-active');
> 
> $next.css({opacity: 0.0})
>     .addClass('active')
>     .animate({opacity: 1.0}, 1000, function() {
>         $active.removeClass('active last-active');
>     }); } 
> ```
> 
> $(function() { setInterval( "slideSwitch()", 5000 ); });
> 
> / ***设置宽度和高度以匹配您的图像 **/
> 
> # 幻灯片{位置：相对；高度：350 像素；宽度：500px；边距：0 自动；}
> 
> # 幻灯片DIV {位置：绝对；顶部：0；左：0；z-索引：8；不透明度：0.0；高度：400px；背景颜色：#FFF；最小宽度：
> 
> 100%；过滤器：阿尔法（不透明度= 0）；}
> 
> # 幻灯片 DIV.active {
> 
> ```
> z-index:10;
> opacity:1.0;  filter: alpha(opacity=100); } 
> ```
> 
> # 幻灯片 DIV.last-active {
> 
> ```
> z-index:9; } 
> ```
> 
> # 幻灯片DIV IMG {高度：350px；显示：块；边框：0；边距底部：10px；宽度：500px；}
> 
> # 测试
> 
> ## [信息](http://jonraasch.com/blog/)
> 
> ```
>  Caption for image 1   </div>
> 
> <div>
>     <img src="../../Images/images/photo (9).jpg" alt="Slideshow Image 2" /></a>
>     Caption for image 2   </div>
> 
> <div>
>     <img src="../../Images/images/photo (8).jpg" alt="Slideshow Image 3" /></a>
>     Caption for image 3   </div>
> 
> <div>
>     <img src="../../Images/images/photo (7).jpg" alt="Slideshow Image 4" /></a>
>     Caption for image 4
> </div>
>  </div> 
> ```
> 
> 关于
> 
> `enter code here`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:37:22.007

看起来他的布局只是执行 slideSwitch() 以前进到下一张幻灯片。但是，后台有一个正在运行的计时器；无限期地每 5 秒发射一次。您需要清除该超时并可能再次设置它。这是一般的想法：

```
// What you should already have:
$(function() {
    setInterval( "slideSwitch()", 5000 );
});

// what you need to change it into:
var intervalID = ""; // keep track of the timeout going on in the background so you can cancel it
$(function() {
    intervalID = setInterval( "slideSwitch()", 5000 );
});

// On any image that is clicked, execute the following
$("img").on("click", function() {
    clearInterval(intervalID); // stop the current slideshow changes
    slideSwitch(); // switch now
    intervalID = setInterval( "slideSwitch()", 5000); // set up the next change
}); 
```

有关 setInterval/clearInterval 的详细说明，请参阅[这些讨论](https://stackoverflow.com/a/3823199/469643)

**更新**：为了正确掌握您要进入的内容，请务必阅读 jQuery 的文档。有很多非常棒的教程，但[jQuery 自己的页面](http://docs.jquery.com/Main_Page)也很有用。如果某些东西似乎没有按您的预期触发，请检查浏览器的“开发人员工具”（或 Firefox 的 firebug 安装）。您可以在代码中设置断点，以便在 javascript 执行时设置断点，或者如果您想简单地测试某些内容，可以在代码中执行 javascript 警报。

您可能需要在内部设置图像单击事件处理程序，`$(document).ready(function() {...}`以便它知道您的所有图像。[jQuery](http://docs.jquery.com/How_jQuery_Works)的工作原理页面将非常有助于理解它的作用/可以做什么。

```
// make sure the page has been fully loaded when the following executes
$(document).ready(function() {
    // On any image that is clicked, execute the following
    $("img").on("click", function() {
        clearInterval(intervalID); // stop the current slideshow changes
        slideSwitch(); // switch now
        intervalID = setInterval( "slideSwitch()", 5000); // set up the next change
    });
}); 
```

一定要开始熟悉[api](http://api.jquery.com/)；您会在[`.on()`](http://api.jquery.com/on/)那里找到文档、[选择器](http://api.jquery.com/category/selectors/)、如何获取[DOM 元素的属性](http://api.jquery.com/category/attributes/)以及 jQuery 在 javascript 之上构建的所有其他内容。

大量阅读，但你会很高兴你花时间了解你试图运用的力量。

# rest - 如何在 JIRA API 中获取用户的时区？

> ID：10623584
> 
> 赞同：3
> 
> 时间：2012-05-16T17:26:58.130
> 
> 标签：rest, jira

我正在使用 JIRA API（没有库），我需要找出当前用户的配置时区。我看到[JIRA 有一个库，它有一个方法 getUserTimeZoneInfo](http://docs.atlassian.com/software/jira/docs/api/latest/com/atlassian/jira/timezone/TimeZoneService.html#getUserTimeZoneInfo%28com.atlassian.jira.bc.JiraServiceContext%29)。什么是等效的 http 调用？

我在谷歌搜索和搜索......什么都没有出现。我希望这只是我选择的搜索词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T12:24:46.087

使用[JIRA REST API](https://developer.atlassian.com/display/JIRADEV/JIRA+REST+API+Version+2+Tutorial)，您只需进行以下调用即可实现此目的：

```
https://YourJiraServerAddress/rest/api/latest/user?username=YourUsername 
```

您将在响应消息中找到加载的“timeZone”字段。

是的，别忘了验证自己的身份......

# mysql - 在游标循环中调用存储过程，而不触发 Continue 处理程序

> ID：10623588
> 
> 赞同：2
> 
> 时间：2012-05-16T17:27:07.963
> 
> 标签：mysql, stored-procedures, cursor, handler

我试图在游标的循环中调用 MySQL 中的存储过程。在循环中执行 INSERT 时光标行为正常；但是如果我尝试调用存储过程，则 continue Handler '设置完成 = 1' 并在处理第一条记录后过早退出循环。关于如何解决这个问题的任何想法？谢谢。

```
declare test_cursor cursor for 
       select projectid, projectdesc
         from tblProjects
        order by projectdesc;          

DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done = 1;

set done = 0;  
open test_cursor;

repeat

  fetch test_cursor into wprojectid, wprojectdesc;

  if not done then  

    insert into tblTest (a, b) values (wprojectid, wprojectdesc);   <--this would work
    call spTest(wprojectid, wprojectdesc, @retrn);                                    <--this trips the Handler after first loop

  end if;      

until done end repeat;

close test_cursor; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:03:17.557

我不确定，但试着看看这段代码是否有效？

```
declare test_cursor cursor for 
       select projectid, projectdesc
         from tblProjects
        order by projectdesc;          

DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done = 1;
DECLARE done_holder INT;

set done = 0;
open test_cursor;

repeat

  fetch trade_cursor into wprojectid, wprojectdesc;

  if not done then  

    set done_holder = done;
    insert into tblTest (a, b) values wprojectid, wprojectdesc;
    call spTest(a, b, @retrn);
    set done = done_holder;

  end if;      

until done end repeat;

close test_cursor; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T07:01:00.223

我认为问题出在这里 - 'call spTest(a, b, @retrn);'，尝试用这个来改变它 -

```
CALL spTest(wprojectid, wprojectdesc, @retrn); 
```

所以，你的代码可以是这样的 -

```
 DECLARE done INT DEFAULT 0;
  DECLARE wprojectid, wprojectdesc  INT;
  DECLARE test_cursor CURSOR FOR SELECT projectid, projectdesc FROM tblProjects ORDER BY projectdesc;
  DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done = 1;

  SET done = 0;
  OPEN test_cursor;

  REPEAT
  FETCH test_cursor INTO wprojectid, wprojectdesc;
    IF NOT done THEN
      INSERT INTO tblTest (a, b) VALUES (wprojectid, wprojectdesc);
      CALL spTest(wprojectid, wprojectdesc, @retrn);
    END IF;
  UNTIL done
  END REPEAT;
  CLOSE test_cursor; 
```

# entity-framework - EF不在数据库上创建表

> ID：10623590
> 
> 赞同：0
> 
> 时间：2012-05-16T17:27:14.157
> 
> 标签：entity-framework, code-first

我首先遇到了实体框架代码的问题，当我执行我的应用程序并将数据保存到我的控制器中的数据库时，它不会为我的域类创建表，我已经创建了上下文，并为我的模型添加了一个 Dbset 变量，我验证了所有这些我们需要与 EF 合作，但我不明白这是怎么回事，这是我将数据保存到数据库的代码：

```
 foreach (var data in my_friends) {
            entity.Friends.Add(data);

        } 
```

my_friends 包含一个“UserFriend”列表，它是我的域类，实体是上下文，如果你过去遇到过这个问题，我喜欢你帮助我！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:28:56.530

尝试以下操作：

```
foreach (var data in my_friends) {
    entity.Friends.Add(data);        
}
entity.SaveChanges(); 
```

# python - 将二维字典转换为 numpy 矩阵

> ID：10623592
> 
> 赞同：21
> 
> 时间：2012-05-16T17:27:20.317
> 
> 标签：python, numpy

我有一本像这样的大字典：

```
d[id1][id2] = value 
```

例子：

```
books["auth1"]["humor"] = 20
books["auth1"]["action"] = 30
books["auth2"]["comedy"] = 20 
```

等等..

每个“auth”键都可以有任何一组与之关联的“流派”。关键项目的价值是他们写的书的数量。

现在我想要的是将它转换为矩阵的形式......就像：

```
 "humor"       "action"        "comedy"
      "auth1"         20            30               0
      "auth2"          0            0                20 
```

我该怎么做呢？谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-17T01:12:16.317

[熊猫](http://pandas.pydata.org/)做得很好：

```
books = {}
books["auth1"] = {}
books["auth2"] = {}
books["auth1"]["humor"] = 20
books["auth1"]["action"] = 30
books["auth2"]["comedy"] = 20

from pandas import *

df = DataFrame(books).T.fillna(0) 
```

输出是：

```
 action  comedy  humor
auth1      30       0     20
auth2       0      20      0 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-16T17:42:56.717

使用列表推导将 dict 转换为列表列表和/或 numpy 数组：

```
np.array([[books[author][genre] for genre in sorted(books[author])] for author in sorted(books)]) 
```

*编辑*

显然，每个子词典中有不规则数量的键。列出所有类型：

```
genres = ['humor', 'action', 'comedy'] 
```

然后以正常方式遍历字典：

```
list_of_lists = []
for author_name, author in sorted(books.items()):
    titles = []
    for genre in genres:
        try:
            titles.append(author[genre])
        except KeyError:
            titles.append(0)
    list_of_lists.append(titles)

books_array = numpy.array(list_of_lists) 
```

基本上我正在尝试将每个键中的值附加`genres`到列表中。如果密钥不存在，则会引发错误。我发现了错误，并将 0 附加到列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-02T23:25:47.957

在 2018 年，我认为 Pandas 0.22[开箱即用](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.from_dict.html)。具体请查看 的`from_dict`类方法`DataFrame`。

```
books = {}
books["auth1"] = {}
books["auth2"] = {}
books["auth1"]["humor"] = 20
books["auth1"]["action"] = 30
books["auth2"]["comedy"] = 20

pd.DataFrame.from_dict(books, orient='columns', dtype=None) 
```

# jquery - ASP.Net MVC 在 ajax 发布后刷新另一个视图中的其他元素

> ID：10623593
> 
> 赞同：2
> 
> 时间：2012-05-16T17:27:27.387
> 
> 标签：jquery, ajax, asp.net-mvc

我有 2 个部分视图，两者可能同时在同一页面上，但并非总是如此。

在通过 jQuery ajax 返回其他帖子之后，刷新其中一个视图中的元素的最有效方法是什么？

我不希望页面的一部分与另一部分之间存在依赖关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:33:22.073

ajax 加载完成后触发一个事件。当然，您必须将容器或相关元素绑定到事件，以便在事件触发时更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:35:00.003

在 jquery .ajax onsuccess 处理程序中触发另一个 ajax 调用以更新第二个屏幕区域。这保持了完全独立。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-23T16:32:55.183

Mantorok 如果您正在进行 ajax 调用，那么将会有一个成功功能。只需添加下面给出的以下代码。

```
location.reload(true); 
```

希望它会工作......

# jquery - 无法让右手 jQuery 选项卡正确设置动画

> ID：10623596
> 
> 赞同：0
> 
> 时间：2012-05-16T17:27:35.877
> 
> 标签：jquery, html, css

我正在使用 CSS 和 jQuery 的组合在浏览器的右侧创建一组选项卡，它的工作原理与它应该有的一个缺陷差不多。出现在右侧的图像供用户单击并使选项卡的其余部分滑入视图，只是“弹出”到它们应该在的位置而不是滑动，而实际内容正确滑入。

我尝试在 tab-handle-container 类上使用 .animate 和其他效果，但没有成功。我在下面发布了我的 HTML、jQuery 和 CSS 代码，供您提供任何提示。另外，我希望在 IE8 和 9 中进行这项工作，目前并不真正关心其他浏览器。谢谢！

# HTML 和 jQuery

```
<script>
$(document).ready(function(){
    $(".content").hide();
    $(".myhandle").click(function(){
    $(".content", $(this).parents("li")).toggle('slide',{direction: "right"}, 1000);
    });
});

</script>

<html>
<body>
<div class="Container">
    <ul class="tab-list">
        <li>
            <div class="content">
            <h3>Contact Information</h3>
            <p>If you need technical assistance, please</p>
        </div>
        <div class="tab-handle-container">
        <img class="myhandle" src="contacttab.bmp"></img>
        </div>
    </li>
    <li>
        <div class="content">
        <h3>Some more stuff</h3>
        <p>This will be where more content is displayed</p>
        </div>
        <div class="tab-handle-container">
        <img class="myhandle" src="email.jpg"></img>
        </div>
    </li>
</ul> 
```

# CSS

```
html {margin: 0px;}

.myhandle { 
    cursor: hand;
}
.container {
right: -210px;
width: 240px;
height: 240px;
}
.tab-handle-container {
margin: 0px;
border: 0px;
width: 40px;
float: left;
}
.content{
padding: 5px;
float: left;
width: 200px;
background-color: #ffffff;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T12:12:45.027

在 MrSlayer 的帮助下解决了这个问题，`.toggle`在 div 中使用 Threw 两个元素，通过 CSS 关闭滚动，然后使用这个

```
$(document).ready(function(){
    $(".myhandle").toggle(function(){
        $(".slider", $(this).parents("li")).animate({right: "+=200"}, 700);
     },
    function() {
        $(".slider", $(this).parents("li")).animate({right: "-=200"}, 700);
      }
    );
}); 
```

# c - yacc文件解析

> ID：10623599
> 
> 赞同：1
> 
> 时间：2012-05-16T17:27:47.463
> 
> 标签：c, yacc

我正在为汇编编译器制作 ac，我希望我的程序从给他 2 个参数开始： - 包含代码的源文件 (.c) - 包含编译器生成的汇编代码的目标文件。启动示例：./compiler sum_test.c result.asm

这实际上有效： echo "int main(){int a; int b; int c; a = 2; b=3; c=a+b;}" | ./编译器

但我真的很想从文件中读取代码。

我无法将 sum_test.c 中的所有内容解析为 STDIN，我的程序卡住并等待输入..

这是我的主要功能和我尝试过的：

```
 int main(int argc, char** argv)
{

   extern FILE * yyin;
   yyin = fopen( argv[1], "r");
   yyin = stdin;

  labelVrai = labelFaux = labelFin = labelDebut = labelSuite = labelWhileDebut = labelWhileFin = n_labels = labelN_else = 0;
  dico_global = dictionnaire_create();
  dico_local = creer_piledico();

  if ( yyparse() != 0 )
    { fprintf(stderr,"Syntaxe incorrecte\n"); return 1; }

  dictionnaire_destroy(dico_global);
  destroy_piledico(dico_local);
  return 0;
} 
```

如果你能帮助我，那就太好了，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T17:55:31.777

我不确定是否还有其他问题，但您需要删除该行`yyin = stdin;`。它正在覆盖您打开的文件的文件指针。

# ruby - Ruby 数组哈希键

> ID：10623602
> 
> 赞同：2
> 
> 时间：2012-05-16T17:28:16.317
> 
> 标签：ruby

基本上我正在使用二维矩阵。我可以通过指定 (x,y) 对来访问矩阵的元素，以获取该位置的相应值。

现在我还希望能够跟踪在运行时任意确定的某些对。例如，也许我需要跟踪 (1,2)、(3,4) 和 (5,6) 处的值，并且可能需要经常检索该位置的值。

所以我在想如何做一个 hash 。

```
like_elements = {[1,2] => M[1,2], [3,4] =>M[3,4], [5,6]=>M[5,6]}

```

或类似的东西。

然后我可以快速迭代哈希并获得我喜欢的元素。

使用数组作为哈希键有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:43:14.447

只是不要在之后修改数组（或者如果你这样做，请记住重新散列哈希）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T22:01:57.163

如果它真的是一个矩阵（数组的数组），那么你可以像这样传入坐标

```
matrix = [[:a, :b, :c],[:d, :e, :f], [:g, :h, :i]]
matrix[0][1] # returns :b
matrix[1][2] # returns :f
matrix[2][3] # returns nil, since 3 is out of bounds 
```

是的，您可以创建一个数组作为哈希键。

```
h = Hash[[0,1], matrix[0][1]]
h[[0,1]] # returns :b 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-10T02:28:23.740

我目前正在制作一个二维数组，其中每个数组都指向一个特定的哈希映射。每个地图都有自己的特定数据，我想检索键和值信息。但是，当我引用一个数组（即 A[0][1] 时，我无法访问散列函数。

我使用 A.class 检查了类类型，以验证它是一个 Hash 并且确实是它返回的内容。这是 Ruby 1.9.3 的固有问题还是我做错了什么？

# solr - Solr 查询和双引号

> ID：10623611
> 
> 赞同：3
> 
> 时间：2012-05-16T17:28:38.757
> 
> 标签：solr

当我在 solr 中传递查询时，我将它们作为字符串传递（“blah blah”）。我这样做是因为我有希腊语的编码问题（我的输入字段只接受希腊字符作为字符串）。但是 solr 将引号内的字符视为“完全匹配”术语。有没有办法从 Solr 中删除双引号？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T07:43:00.197

如果您在架构中使用 solr.StrField，则获得完全匹配是有意义的，请参阅： [http ://azeckoski.blogspot.com/2009/06/tricky-solr-schema-issue-with-strfield.html](http://azeckoski.blogspot.com/2009/06/tricky-solr-schema-issue-with-strfield.html)

您应该真正使用 solr.TextField，这将允许您使用希腊语分析器。我不太明白为什么它只接受希腊字符作为字符串。你可以解释吗 ？

关于希腊语小写和词干： [http](http://wiki.apache.org/solr/LanguageAnalysis#Greek) ://wiki.apache.org/solr/LanguageAnalysis#Greek 另一方面，请注意，如果您使用词干，您将无法再进行完全匹配...

# php - 根据提交的ID显示多个项目？

> ID：10623613
> 
> 赞同：1
> 
> 时间：2012-05-16T17:29:05.763
> 
> 标签：php, mysql, select

希望有人可以在这里帮助我。我的数据库中有以下结构。

```
id   nav      title   content                      date
1    2,3      nav a   askdajsdjasdasdfajsdfasd     12 june, 2012
2    2,40     nav e   askdajsdjasdasdfajsdfasd     12 june, 2012
3    12,3,14  nav b   askdajsdjasdasdfajsdfasd     12 june, 2012
4    3,4      nav c   askdajsdjasdasdfajsdfasd     12 june, 2012 
```

我的问题是，如何根据我提交的导航 id 显示项目？？？例如，如果我想在提交 nav id 2 时显示所有项目（nav a、nav e）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:37:39.690

```
SELECT * FROM TABLE_NAME WHERE FIND_IN_SET(2,nav) 
```

或者

```
SELECT *
FROM Table
WHERE nav LIKE '2,%'
OR nav LIKE '%,2'
OR nav LIKE '%,2,%'
OR nav = '2' 
```

但第一个是很多击球手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:44:44.587

假设 X 是您想要的导航 id，因此您可能想要使用以下查询：

```
SELECT title FROM table WHERE nav REGEXP '([0-9]+,)*X(,[0-9]+)*'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:31:58.470

如果导航列的值范围从 0 到 9 即单个数字，如您的示例中所示，那么您可以安全地使用以下内容：

```
select * from table where nav like '%2%' 
```

如果您的值大于 9，即 10 以后，并且数据可以是 2、5、10、123，那么您将需要创建一个存储过程并将查询值作为参数传递给它。然后，该 SP 将创建一个游标并循环遍历结果集，并使用字符串函数检查数字是否存在，如果找到则返回该行作为结果。

另一种方法是在 PHP 结果对象中获取结果，然后遍历结果行并检查参数值是否存在。但是，如果表中有几行，那么 SP 方式会更好、更有效。

# java - com.ibm.ws.webcontainer.webapp.WebAppErrorReport 中的空 stackTrace

> ID：10623614
> 
> 赞同：1
> 
> 时间：2012-05-16T17:29:07.270
> 
> 标签：java, spring-mvc, websphere

此问题出现在 Websphere 6.1 上部署的 Spring MVC 应用程序中。当我尝试访问应用程序中不存在的 URL 时，我收到 404 错误。我有一个错误控制器类，它将记录所有异常并重定向到错误页面。Throwable 实例是从此控制器中的请求中检索到的，这是 com.ibm.ws.webcontainer.webapp.WebAppErrorReport 的一个实例。当我尝试通过 getStackTrace() 方法访问时，我发现堆栈跟踪元素为 null，导致日志记录期间 log​​back API 类中出现 NullPointerException。结果，屏幕不会重定向到错误页面，并且整个堆栈跟踪都显示在屏幕上。除了 404 错误之外，它对于其他异常都可以正常工作。

我注意到 printStackTrace 在 WebAppErrorReport 中没有被覆盖，并且正在使用它将堆栈跟踪写入字符串以进行日志记录。

但是，我对这个解决方案不太满意，想知道是否还有其他更好的出路。另外，我很好奇为什么堆栈跟踪仅针对此错误为空？

# facebook - 如何验证外部网络应用程序以发布到 Facebook 应用程序的页面？

> ID：10623621
> 
> 赞同：0
> 
> 时间：2012-05-16T17:29:23.313
> 
> 标签：facebook, api, authentication, oauth, token

有没有人能够弄清楚如何验证外部网站以发布到 Facebook 应用程序的页面（墙）？

我们有一个外部 Rails 站点，我要做的就是在创建新资源时发布到我们的 facebook 应用程序页面。我现在对所有这些令牌和过期感到很困惑！！！

前任。我可以手动访问： [https](https://www.facebook.com/dialog/oauth?client_id=(our) ://www.facebook.com/dialog/oauth? client_id=(our client id)&redirect_uri=(our redirect uri)&scope=manges_pages,publish_stream&response_type=token

（无括号）

获取帐户访问令牌，但这种方法是手动的，只有当我通过浏览器并登录 FB 时它才有效（因此它使用 cookie）。如何自动化我的外部 Web 应用程序的身份验证过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T21:41:29.783

我会尝试对 URL 使用跨域 AJAX GET 请求（带参数）。这将允许请求利用当前用户的 cookie。对于这种情况，jQuery 是相当合理的。$.ajax(); 使用 JSONP 应该可以做到。

像这样的东西：

```
$.ajax({
    type: 'GET',
    url: 'https://www.facebook.com/dialog/oauth',
    data: {
        client_id: '(our client id)',
        redirect_uri: '(our redirect uri)',
        scope: 'manges_pages',
        publish_stream: '',
        response_type: 'token',
        format: 'jsonp'
    },
    dataType: 'jsonp',
    success: function(data)
    {
        // Do stuff.
    }
}); 
```

**编辑：** 应该注意的是，我从来没有专门用 Facebook 的 API 做过这个。在进行一些挖掘时，我不知道这是否可能仅与 GET 请求有关： [https ://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

似乎您需要在服务器端进行某种身份验证，然后才能发布到他们的 API。

# java - Java：如何检查计算机是否已更改

> ID：10623625
> 
> 赞同：1
> 
> 时间：2012-05-16T17:29:35.190
> 
> 标签：java, security, authentication, ip

> **可能重复：**
> [如何在 Java 中获取唯一的计算机标识符（如磁盘 ID 或主板 ID）](https://stackoverflow.com/questions/1986732/how-to-get-a-unique-computer-identifier-in-java-like-disk-id-or-motherboard-id)

我正在创建一个小型 Java 程序。在那里，我正在创建一个名为“James.txt”的文件。我正在使用此文件来检查程序是否已从 James 计算机中移出。我在那里所做的是，将 Jame 的计算机的 IP 地址写入该文件。因此，当他在控制台中启动程序时，它会首先检查文件并说“Hey James！Suprise!!!”，如果 IP 不属于 james，它会打印“Sorry, This is for James聚会”。

但是，情况是，即使在同一台PC上也可以更改IP地址，对吗？那么，如何才能唯一标识詹姆斯电脑呢？请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:50:48.350

如果 NIC 更改，MAC 地址将更改。主板可能会出现故障并被更换。这同样适用于处理器 ID、硬盘 ID 和其他东西。

底线——

*   为您的应用程序开发标识符
*   让您的应用程序在用户的计算机上维护一个标识符
*   当您的应用程序要求用户使用 userid/password/biometrics 来识别他/她自己时，也要验证标识符，*然后*显示您必须的消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:58:12.123

从技术上讲，您无法唯一识别任何计算机，因为一切都可能被“欺骗”。如果您知道如何操作，您甚至可以像更改 IP 一样轻松更改 MAC 地址。

话虽如此，一些系统试图计算可用于定义半唯一实例的值组合。通常这些来自硬件标识符，例如：

*   MAC地址
*   硬盘标识符
*   CPUID

然后将它们以某种方式混合在一起，以提供具有一定更改容错性的唯一密钥（如硬件升级）。在某些系统中还有一个生成的标识符，称为 UUID，它是在构建文件系统时创建的。

要访问其中的一些，您可能需要使用 JNI。其中一些是有争议的（CPUID），因为它们可用于跟踪互联网上的人，从而降低他们的匿名性。

某些应用程序（如 Web 浏览器）经常无法访问这些内容。建立登录/密码形式的安全性可能更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T17:48:01.380

IP 地址可能会经常更改（例如使用 DHCP 分配） 我建议使用磁盘或主板的序列号进行识别。

如何在 WINDOWS 上获取这些序列号的示例可以在这里找到：

[http://www.rgagnon.com/javadetails/java-0580.html](http://www.rgagnon.com/javadetails/java-0580.html)（包括源代码，平台相关）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T17:39:50.703

您可以使用 Java 注册表将一个简单的值写入系统注册表。这将适用于 Linux 和 Windows，并且是一种非常基本的方法。不安全且很容易破解，但至少它是便携的。

您可以参考[使用 Java 读取/写入 Windows 注册表以](https://stackoverflow.com/questions/62289/read-write-to-windows-registry-using-java)获得一些很好的示例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-16T17:42:07.153

无法保证计算机没有变化。您最好的选择是在首次运行时将密钥文件写入机器，然后您可以使用该文件进行检查。虽然这可以被删除，但只要您使用合理的哈希算法来生成您的密钥（即您可以确信没有其他人可以生成它），它就会看起来有所不同，那么您可以很高兴保证您得到正确的匹配当密钥匹配时。这种方法会让你对肯定的识别充满信心，但会让你容易接受假阴性，这通常不是问题。您应该根据一些可用作参考的加盐输入来使用类似于 SHA 算法的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-16T17:43:51.870

用纯 Java 可以做的任何事情都不会对故意想要“破坏系统”的精通技术的用户非常有效。

但是，尽管如此，您可以在纯 Java 中做一些低技术含量的事情：

*   继续并存储 MAC 地址；它并不完全可靠，但实际上大多数用户不会更改他们的 MAC 地址；
*   分配一个随机的 UUID 并使用 Preferences 架构将其存储在机器上；然后，将该 UUID 或其安全哈希存储在程序的本地目录中。

这些系统中的任何一个都很容易被精明的用户使用。但归根结底，精明的用户可能会篡改您的课程文件以绕过您采取的任何措施。

MAC 地址的缺点是程序外部存在“合法”情况，MAC 地址可能会更改，因为用户可能会更改他们的网络设备。

# javascript - 将2个数组组合成一个多维数组？

> ID：10623635
> 
> 赞同：7
> 
> 时间：2012-05-16T17:30:45.700
> 
> 标签：javascript

这是基于我的最后一个问题。

我有这些数组：

```
var array1 = new Array ("Pepsi", "Coke", "Juice", "Water");
var array2 = new Array ("35",    "17",   "21",    "99"); 
```

我想将它们组合成一个多维数组，如下所示：

```
[
    ["Pepsi","35"]
    ["Coke", "17"]
    ["Juice","21"]
    ["Water","99"]
] 
```

我试过这个脚本：

```
Values=[];

for (i = 0; i < array1.length; i++) {
    Values[i] = Array(array1[i], array2[i]);
} 
```

但它给出了这样的结果（正确的值，错误的名称）：

```
[
    ["a","35"]
    ["c","17"]
    ["E","21"]
    ["I","99"]
] 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-16T17:34:43.720

```
var array1 = ["Pepsi", "Coke", "Juice", "Water"],
    array2 = ["35", "17", "21", "99"],
    result = [], i = -1;

while ( array1[++i] ) { 
  result.push( [ array1[i], array2[i] ] );
} 
```

如所写，此解决方案假定您将只使用字符串。正如@ajax333221 在下面的评论中指出的那样，如果您要参与`boolean`或`int`重视此解决方案，这将导致问题。因此，我想提出一项改进，以实现您的目标，同时不会因困难的值和类型而绊倒：

```
var array1 = [false, 0, "Juice", -1],
    array2 = ["35", "17", "21", "99"],
    result = [];

for ( var i = 0; i < array1.length; i++ ) {
  result.push( [ array1[i], array2[i] ] );
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-16T17:43:14.470

您可以`.map()`在数组上使用。

```
var Values = array1.map(function(v,i) {
    return [v, array2[i]];
}); 
```

* * *

请参阅旧版浏览器的[MDN shim](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/map#Compatibility)。

***现场演示：http:*** [//jsfiddle.net/D9rjf/](http://jsfiddle.net/D9rjf/)

* * *

如果你打算做这个操作相当多，你可以做一个可重用的功能。

在这个例子中，我扩展`Array.prototype`了 ，但如果你不喜欢，那就没有必要了。

```
Array.prototype.combine = function(arr) {
    return this.map(function(v,i) {
        return [v, arr[i]];
    });
}; 
```

* * *

```
var Values = array1.combine(array2); 
```

***现场演示：http:*** [//jsfiddle.net/D9rjf/1/](http://jsfiddle.net/D9rjf/1/)

# macos - 无法在 vim 中安装 FuzzyFinder

> ID：10623640
> 
> 赞同：5
> 
> 时间：2012-05-16T17:31:19.010
> 
> 标签：macos, vim, plugins, osx-lion, fuzzyfinder

我下载`vim-fuzzyfinder`到我的下载文件夹。我移动文件夹（包含`autoload/`、、`doc/`和`plugin/`到`~/.vim/bundle/`（顺便说一下，我正在使用 Pathogen）。我启动 vim 并收到以下错误：

```
Error detected while processing /Users/archio/.vim/bundle/vim-fuzzyfinder/plugin/fuf.vim  
line   13:
***** L9 library must be installed! ***** 
```

发生了什么？我怎样才能让它工作？我对 vim 插件相当陌生。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-16T17:47:14.847

有问题的插件似乎依赖于[L9 library](http://www.vim.org/scripts/script.php?script_id=3252)，到目前为止我还没有遇到过。只需安装 L9 库并重试。

啊，还有一个叫做[CtrlP 插件](http://www.vim.org/scripts/script.php?script_id=3736)的替代品，它非常好，尤其是，至少对我来说，当按照这个[MangoldSchinkenCannelloni 消息](https://groups.google.com/d/msg/vim_use/U6L33ZWvfj4/103elwelSc0J)中 Vim 邮件列表档案中给出的说明进行直接匹配时。

# .net - POCO 和验证应用程序块错误

> ID：10623642
> 
> 赞同：0
> 
> 时间：2012-05-16T17:31:30.723
> 
> 标签：.net, poco

创建此对象后

```
ClassName obj = new ClassName
{
  Currency = "eur",
  DateStart = DateTime.Now.AddDays(-1),
  DateEnd = DateTime.Now.AddDays(-1)
}; 
```

并试图验证它

```
var validationResults = Validation.Validate<ClassName>(obj); 
```

我看到了这个错误，但我不知道在哪里寻找和解决这个问题：

```
An unhandled exception of type 'System.ArgumentException' occurred in
Microsoft.Practices.EnterpriseLibrary.Validation.dll

Additional information: Object must be of type Int32. 
```

任何帮助表示赞赏。

谢谢。

**编辑**

这里似乎是问题：

```
[RangeValidator(0f, RangeBoundaryType.Inclusive, 0f, RangeBoundaryType.Ignore, MessageTemplate = "...")]
public virtual double Price
{
    get;
    set;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:36:46.577

您必须使用属性修饰了某些字段或`ClassName`属性`Validator`。我假设某些属性不适用，或者您错过了一些参数...

# macos - Mac SSH 终端

> ID：10623644
> 
> 赞同：0
> 
> 时间：2012-05-16T17:31:30.580
> 
> 标签：macos, terminal

所以我在一台旧的（全铝制的）macbook pro 上运行雪豹并使用终端连接到我工作网络上的远程主机。当我在终端中复制和粘贴内容时，我注意到一件奇怪的事情。

例如，我将在文件中 grep 查找类似的内容：

```
samtools view sorted-616.bam | grep 'SOLEXA9:1:1:30:3316:10211' | head -n 1 
```

它给了

SOLEXA9:1:1:30:3316:10211 69 k26_179705 159 0 * = 159 0 TATGCCGCCAAACGCTTCCGCAAAGCTCTGTGTTTGACTATGTAGCGACTA CBCCCCCC@CCCCCCCC?@CC?CC##################### #### RG:Z:1

但是现在当我选择它时，按 command+c 复制，然后按 command+v 粘贴，结果如下：

SOLEXA9:1:1:30:3316:1021169k26_1797051590*=1590TATGCCGCCAAACGCTTCCGCAAAGCTCTGTGTTTGACTATGTAGCGACTACBCCCCCC@CCCCCCCCC?@CC?CC########################RG:Z :1

注意现在字段之间没有空格。有没有一种特殊的方法可以完全按照原样复制和粘贴内容？为什么终端会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:06:57.407

使用 pbcopy 时会发生什么？

```
samtools view sorted-616.bam | grep 'SOLEXA9:1:1:30:3316:10211' | head -n 1 | pbcopy 
```

这应该与复制命令执行相同的操作，但不必选择所需的输出。

您是否尝试过另一个终端模拟器？我使用[iTerm2](http://www.iterm2.com/)是因为它会在选择时复制到剪贴板，而无需按 Command-c。

**编辑：**您可能必须安装 Apple 的开发人员工具才能获得 pbcopy/pbpaste 工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:35:30.423

不知道为什么粘贴的文本中缺少空格，但我会尝试将输出写入文件，在编辑器中打开文件并尝试查看它是否不是标准空格/换行符。你似乎知道你的管道方式，但无论如何：

```
samtools view sorted-616.bam | grep 'SOLEXA9:1:1:30:3316:10211' | head -n 1 > file.txt 
```

这可能取决于主机正在运行的系统。在与 linux/unix 主机进行 ssh 连接时，我遇到了一些问题，而 Mac 到 Mac 通常工作得很好。

# sql - SQL通配符问题

> ID：10623645
> 
> 赞同：1
> 
> 时间：2012-05-16T17:31:31.647
> 
> 标签：sql

我有一个数据库，我们的用户可以通过界面对其进行修改。对于一个字段（companyID），他们应该能够在字符串中放置一个星号作为通配符。

例如，他们可以输入 G378* 来代表以 G378 开头的任何公司 ID。

现在在我的客户程序中，我提供了一个“完整”的 companyID 作为参数：

```
SELECT * FROM table WHERE companyID = '" + myCompanyID + "' 
```

但是我必须检查通配符，有什么可以添加到我的查询中来检查的。我不知道如何解释它，但它与我习惯的有点倒退。我可以修改我提供的值（完整的 companyID）以匹配查询本身中的通配符值吗？

我希望这是有道理的。

谢谢！

编辑：用户没有使用`SELECT`. 用户只使用`INSERT`或`UPDATE`，他们是在字段中放置 * 的人。我的程序正在使用`SELECT`，我只有完整的 companyID（没有星号）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:36:29.037

This is a classic [SQL Injection](http://xkcd.com/327/) target! You should be glad that you found it now.

Back to your problem, when users enter `'*'`, replace it with `'%'`, and use `LIKE` instead of `=` in your query.

For example, when end-users enter `"US*123"`, run this query:

```
SELECT * FROM table WHERE companyID LIKE @companyIdTemplate 
```

set `@companyIdTemplate` parameter to `"US%123"`, and run the query.

I used .NET's `@` in the example, but query parameters are denoted in ways specific to your hosting language. For example, they become `?` in Java. Check any DB programming tutorial on use of parameterized queries to find out how it's done in your system.

**EDIT :** If you would like to perform an insert based on a wildcard *that specifies records in another table*, you can do an insert-from-select, like this:

```
INSERT INTO CompanyNotes (CompanyId, Note)
   SELECT c.companyId, @NoteText
   FROM Company c
   WHERE c.companyId LIKE 'G378%' 
```

This will insert a record with the value of the `@NoteText` parameter into `CompanyNotes` table for each company with the ID matching `"G378%"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:36:14.407

This is somewhat implementation dependant and you did not mention which type of SQL you are dealing with. However, looking at MS SQL Server wildcards include % (for any number of characters) or _ (for a single character). Wildcards are only evaluated as wildcards when used with "like" and not an = comparison. But you can pass in a paramater that includes a wildcard and have it evaluated as a wildcard as long as you are using "like"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:38:06.097

在 TSQL 中，我会使用 replace 和 like。IE：

```
select * from table where companyid like replace(mycompanyid,'*','%'); 
```

# html - 我可以使用什么样的示例 url 会立即导致请求失败？

> ID：10623650
> 
> 赞同：4
> 
> 时间：2012-05-16T17:31:39.670
> 
> 标签：html, http, url, ip

如果我只想指出一个尽快失败的资源，我应该使用什么“官方”网址？

我不想使用 www.example.com，因为它是一个接受和响应请求的实际站点，我不希望某些东西永远需要并且因超时而失败（例如使用随机的私有 IP 地址键入可能会导致）。

我想过写一个无效的地址或只是一些随机文本，但我认为它看起来不像“www.example.com”那么漂亮和清晰。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:44:32.100

如果您想要一个无效的 IP，请尝试使用`0.0.0.0`.

IP 的第一个八位字节不能是`0`，所以`0.0.0.0`to`0.255.255.255`将是无效的。

有关更多信息，请参阅此问题：[什么是用于单元测试的好的无效 IP 地址？](https://stackoverflow.com/q/10456044)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:47:19.087

[https://www.rfc-editor.org/rfc/rfc5735](https://www.rfc-editor.org/rfc/rfc5735)：

> 192.0.2.0/24 - 此块被分配为“TEST-NET-1”，用于文档和示例代码。在供应商和协议文档中，它通常与域名 example.com 或 example.net 结合使用。如 [RFC5737] 中所述，此块中的地址不会合法地出现在公共互联网上，并且可以在没有与 IANA 或互联网注册机构进行任何协调的情况下使用。见[RFC1166]。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-12-13T03:12:01.930

`.invalid`根据[RFC 6761](https://www.rfc-editor.org/rfc/rfc6761#section-6.4)使用：

> 域“无效”。以及任何属于“.invalid”的名称。是特殊的 [...] 用户可以假设对“无效”名称的查询将始终返回 NXDOMAIN 响应。

因此，假设 DNS 表现良好，对[https://foo.invalid/bar](https://foo.invalid/bar)的请求将始终失败。

相关问题：[什么是保证不可解析（但有效）的 URL？](https://stackoverflow.com/a/39286127/320036)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:34:07.640

如果它在浏览器中，那么**about:**相当没用 - 但如果您的服务返回正确的 HTTP 状态代码会更好 - 例如 200 = 好，404 = 未找到等。

[http://en.wikipedia.org/wiki/List_of_HTTP_status_codes](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)

# c# - 锁定问题 - 多线程使 LOOP 乱序

> ID：10623653
> 
> 赞同：2
> 
> 时间：2012-05-16T17:31:42.813
> 
> 标签：c#, multithreading, locking, task-parallel-library

我有一个示例应用程序，想知道是否有人可以对此有所了解。当我在 for 循环上设置断点时，进入调试器中的代码，为什么它会从一个线程切换到另一个线程？它在运行时运行应用程序时这样做......请参见下面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace TPLSample
{
    class Program
    {

        static void Main(string[] args)
        {
           Management m = new Management();

           Task a = new Task(() => m.Operation1());
           a.Start();
           Task b = new Task(() => m.Operation2());
           b.Start();

            Console.ReadLine();
        }
    }
    public class Management
    {
        A a = null;
        B b = null;

        public void Operation1()
        {
            a = new A();

        }
        public void Operation2()
        {
            b = new B();
        }
    }
    public class A
    {  Client a = new Client();
        public A()
        {
            while (true)
            {
                a.Test("Im AAAAA");
            }
        }
    }
    public class B
    {
        Client a = new Client();
        public B()
        {
            while (true)
            {
                a.Test("Im BBBBB");
            }
        }
    }
    public class Client
    {
        Object ibj = new Object();

        public void Test(string item)
        {
            lock (ibj)
            {
                for (int i = 0; i < 200000; i++)
                {
                    Console.WriteLine(item);
                }
            }

        }
    }
} 
```

其结果是 As 和 Bs 的混合。锁不是应该阻塞线程以使结果按顺序结束吗？我正在编写的应用程序中也发生了同样的情况，除了 WHILE 循环永远运行（每个任务都需要连续轮询）。请注意，我正在启动两项任务，因为如果 WHILE 循环要永远运行，我不希望一个 WHILE 循环阻止另一个运行。如何使它们按顺序执行 CLIENT 类中的该功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T17:36:17.430

This happens because if you trace your object creation tree carefully you will notice that each thread is using a different lock object, thus rendering your `lock` statement useless.

Your object creation happens like this:

```
 new A() -> new Client() -> new Object()
                / 
new Management()
                \
                 new B() -> new Client() -> new Object() 
```

You are using the last two objects on the right as locks, and you can clearly see that they are different objects.

Try to make the lock static:

```
public class Client
{
    static Object ibj = new Object();
    ... 
```

or otherwise rethink your hierarchy to pass the same lock to both Tasks.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:38:53.643

每个对象都必须能够访问同一个对象才能使锁起作用。您可以通过将 ibj 对象设为静态或将其传递给 Client 类来实现此目的。

```
public class Client
{
    static Object ibj = new Object();

    public void Test(string item)
    {
        lock (ibj)
        {
            for (int i = 0; i < 200000; i++)
            {
                Console.WriteLine(item);
            }
        }

    }
} 
```

# http - 为什么浏览器不缓存我的 http 响应？

> ID：10623654
> 
> 赞同：0
> 
> 时间：2012-05-16T17:31:44.813
> 
> 标签：http, caching, browser

我有一个用`django-tastypie`. 我有几个非常重但不可变的资源，所以我希望浏览器缓存它们以避免不必要的请求。

我已将`HTTP Expire`标题设置为两年后的日期，这就是浏览器得到的：

```
HTTP/1.1 200 OK

Date: Wed, 16 May 2012 17:29:33 GMT
Server: Apache/2.2.14 (Ubuntu)
Vary: Cookie,Accept-Encoding,User-Agent
Expires: Tue, 06 May 2014 17:29:33 GMT
Cache-Control: no-cache, public
Content-Encoding: gzip
Access-Control-Allow-Origin: *
Content-Length: 1051
Keep-Alive: timeout=15, max=82
Connection: Keep-Alive
Content-Type: application/json; charset=utf-8 
```

我`jQuery.ajax`用来发出请求。expires 标头看起来不错，但每次刷新页面时都会发出请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:34:29.947

这是你的问题：

`Cache-Control: no-cache`

从[规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9.1)：

> 这允许源服务器阻止缓存，即使缓存已配置为向客户端请求返回陈旧响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:38:25.673

如果此内容可以更改，请尝试在 jQuery.ajax 中使用 ifModified: true

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:39:03.683

在您的 .ajax 调用中，将 cache: 属性设置为 true，如下所示：

$.ajax({ url: postUrl, type: 'POST', cache: true, /* 默认情况下应该是 true，但在你的情况下我会检查这个 */ data: stuff });

# c# - Streamreader 到相对文件路径

> ID：10623656
> 
> 赞同：11
> 
> 时间：2012-05-16T17:31:45.450
> 
> 标签：c#, .net, filestream

我想知道，是否有人能告诉我如何将 StreamReader 指向程序当前工作目录中的文件。

例如：假设我将程序 Prog 保存在目录“C:\ProgDir\”中。我将“\ProgDir”提交到共享文件夹。在 ProgDir 内部是另一个包含我想导入 Prog 的文件的目录（例如“\ProgDir\TestDir\TestFile.txt”）目录已更改；

（例如，在我的电脑上，Testfiles 的路径是

> C:\ProgDir\TestDir\TestFile.txt

但在其他人的计算机上，目录是

> C:\dev_code\ProgDir\TestDir\TestFile.txt

）。

我如何让 StreamReader 能够从其他人的计算机上的 TestFile.txt 中读取？（澄清一下，文件名没有改变，唯一的改变是路径 ProgDir）

我尝试了以下方法：

```
string currentDir = Environment.CurrentDirectory;
DirectoryInfo directory = new DirectoryInfo(currentDir);
FileInfo file = new FileInfo("TestFile.txt");

string fullDirectory = directory.FullName;
string fullFile = file.FullName;

StreamReader sr = new StreamReader(@fullDirectory + fullFile); 
```

***（从：[获取相对于当前工作目录的路径？](https://stackoverflow.com/questions/703281/getting-path-relative-to-the-current-working-directory)）***

但是我得到“当前上下文中不存在TestFile”。任何人都知道我应该如何处理这个问题？

谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-16T17:43:41.003

文件夹“TestDir”总是在可执行目录中吗？如果是这样，试试这个

```
 string dir =System.IO.Path.GetDirectoryName(
      System.Reflection.Assembly.GetExecutingAssembly().Location);

    string file = dir + @"\TestDir\TestFile.txt"; 
```

这将为您提供 exe 的路径以及其中的文件夹和文本文件

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-16T17:37:39.417

您可以使用该`GetFullPath()`方法。尝试这个：

```
 string filePath = System.IO.Path.GetFullPath("TestFile.txt");
 StreamReader sr = new StreamReader(filePath); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-16T17:44:45.507

一些东西：

首先，`FileInfo.FullName`给出文件的绝对路径，因此您不需要在 StreamReader 实例中的文件之前添加完整的目录路径。

其次，`FileInfo file = new FileInfo(TestFile.txt);`除非您实际上有一个使用属性调用的类，否则应该`TestFile`失败`txt`。

最后，几乎每`File`一种方法，他们都已经使用了相对路径。所以你应该能够在相对路径上使用流阅读器。

试试这几件事，让我们知道。

编辑：这是你应该尝试的：

```
FileInfo file = new FileInfo("TestFile.txt");
StreamReader sr = new StreamReader(fullFile.FullName);
//OR
StreamReader sr = new StreamReader("TestFile.txt"); 
```

但是，我注意到的一件事是 TestFile 位于`TestDir`. 如果您的可执行文件位于`ProgDir`您所说的位置，那么这仍然会失败，因为您的相对路径不正确。

尝试将其更改为`TestDir\TestFile.txt`。IE：`StreamReader sr = new StreamReader("TestDir\TestFile.txt");`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-16T17:42:44.720

[FileInfo](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.aspx) [构造函数](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.fileinfo.aspx)采用字符串类型的单个参数。尝试在 TestFile.txt 周围加上引号。

改变

`FileInfo file = new FileInfo(TestFile.txt);`

至

`FileInfo file = new FileInfo("TestFile.txt");`

除非 TestFile 是一个具有`txt`字符串类型属性的对象，在这种情况下，您必须在尝试使用它之前创建该对象。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-10-02T20:02:00.437

我有一个类似的问题并通过使用此方法解决了它：

```
StreamReader sr = File.OpenText(MapPath("~/your_path/filename.txt")) 
```

如果您需要更相对的文件路径来处理不同的环境，这可能是一个不错的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-19T07:39:55.523

最简单的方法是只使用文件名（不是完整路径）和“TestDir”，并给 StreamReader 一个相对路径。

```
var relativePath = Path.Combine(".","TestDir",fileName);
using (var sr = new StreamReader(relativePath))
{
   //...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-19T07:19:38.403

您可以使用 path.combine 获取当前目录来构建，然后组合您需要的文件路径

```
 new StreamReader(Path.Combine(Environment.CurrentDirectory, "storage")); 
```

# macos - Mac 上的 Mercurial。hg commitabort：未提供用户名（请参阅“hg help config”）

> ID：10623660
> 
> 赞同：2
> 
> 时间：2012-05-16T17:32:07.237
> 
> 标签：macos, mercurial

我在我的 Mac 上安装了 Mercurial 和 BitBucket。我创建了一个存储库并能够添加文件。但是我在尝试提交时没有提供用户名。该解决方案涉及编辑 .hgrc 文件。但这在我的机器上不存在。我需要创建它吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T17:52:53.057

是的，您需要创建`~/.hgrc`. 例如，仅包含必要用户名的最小版本：

```
[ui]
username = John Doe <jdoe@acme.com> 
```

username 属性的值是自由格式的文本，但约定如 ( `Full Name <emailaddress>`) 所示。

作为替代方案，您可以`.hg/hgrc`在存储库中创建/编辑。在这种情况下，`username`您设置的将仅适用于该存储库。 `~/.hgrc`是针对每个用户的配置，而`.hg/hgrc`在存储库中是针对应该仅适用于该存储库的配置。如果两者中都存在给定属性，则特定于存储库的`hgrc`值将覆盖全局中的值`~/.hgrc`。不管怎样，语法都是一样的。`/etc/mercurial/hgrc`用于系统全局配置，但通常不是定义`username`.

使用`man hgrc`以获取更多信息。

# objective-c - 通过在 Xcode 中选择 Behavior 来运行 Uncrustify 不会执行任何操作

> ID：10623661
> 
> 赞同：0
> 
> 时间：2012-05-16T17:32:15.177
> 
> 标签：objective-c, ios, xcode, uncrustify

我按照此处的说明安装了 Uncrustify：

[http://noiseandheat.com/blog/2012/01/uncrustifying-objective-c-source-in-xcode-4/](http://noiseandheat.com/blog/2012/01/uncrustifying-objective-c-source-in-xcode-4/)

使用 brew 进行安装并在 Xcode(4.3.2) 首选项中添加了新行为。

但是，从菜单中运行该行为无济于事。我可能会错过什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:52:46.230

对我来说[https://github.com/tonyarnold/Xcode-4-Uncrustify-Automator-Services](https://github.com/tonyarnold/Xcode-4-Uncrustify-Automator-Services)工作：Automator 用于创建工作流，它可以在 Xcode 中用于格式化所选代码（上面的链接可以描述更好的方式 - 我只是说什么对我有用......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-01T11:19:27.220

谢谢 Thomas，您提供的资源非常有用，让我可以将 automator 工作流程添加到 Xcode 中。唯一的问题是脚本“Uncrustify Document then Re-Indent”显示错误“系统事件出错：辅助设备的访问被禁用”。最初我`sudo touch /private/var/db/.AccessibilityAPIEnabled`启用辅助设备，但这没有帮助。我在这里找到了一个关于类似问题的线程：[AppleScript - 系统事件错误：辅助设备的访问被禁用](https://stackoverflow.com/questions/10140334/applescript-system-events-error-access-for-assistive-devices-is-disabled)

fanaugen 说：

问题不在于辅助设备。当 AppleScript 尝试访问永远不会有任何窗口的进程的窗口时，它似乎错误地返回了该错误代码

他建议通过一些更改来重写脚本。我不确定这是否真的是同一个问题，这是我第一次不得不处理这种类型的脚本，所以我在这里缺乏知识。你有什么建议吗？你有类似的问题吗？

# facebook - facebook 将 youtube 视频发布到 stream.publish

> ID：10623667
> 
> 赞同：0
> 
> 时间：2012-05-16T17:32:54.063
> 
> 标签：facebook, facebook-ios-sdk

我正在使用适用于 iOS 的 facebook SDK，但我认为这并不重要，因为每个 facebook 平台都有发布选项`stream.publish`

我可以发送常规帖子就好了，但是当我发布 YouTube 视频时，它会显示为链接而不是 YouTube 视频。`stream.publish`除了我应该用来完成发布视频之外，还有其他选择吗？

我试过`video.upload`and `video.publish`，但都没有奏效。我应该怎么办？***谢谢。***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T16:34:45.400

我对 C# SDK 更熟悉，但应该不会有什么不同。

您是否将帖子类型指定为链接？前任。

```
args["message"] = msg_txt;
args["title"] = title;
args["type"] = "link";
args["link"] = "http://www.youtube.com/watch?v=blahblah";
args["source"] = "http://www.youtube.com/v/" + YouTubeVideoID + "?version=3&rel=0"; 
```

你能提供你正在做什么的代码片段吗？

# javascript - HTML5 Canvas - 如何在图像背景上画一条线？

> ID：10623678
> 
> 赞同：18
> 
> 时间：2012-05-16T17:33:43.470
> 
> 标签：javascript, html, animation, canvas, html5-canvas

我正在尝试在图像背景上画一条线 - 在 HTML5 Canvas 中。然而，总是在图像后面画线。实际上，首先绘制线条，然后绘制图片 - 无论我如何调用函数。

如何将线条置于图像顶部？

```
var canvas = document.getElementById("myCanvas");
        var context = canvas.getContext("2d");
            context.clearRect(0, 0, canvas.width, canvas.height);
drawbackground(canvas, context); 
drawlines(canvas, context); 

function drawbackground(canvas, context){

    var imagePaper = new Image();

        imagePaper.onload = function(){

            context.drawImage(imagePaper,100, 20, 500,500);
        };

      imagePaper.src = "images/main_timerand3papers.png";
}

function drawlines(canvas, context){

            context.beginPath();
            context.moveTo(188, 130);
            context.bezierCurveTo(140, 10, 388, 10, 388, 170);
            context.lineWidth = 10;
            // line color
            context.strokeStyle = "black";
            context.stroke();
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-16T17:38:36.547

完全未经测试的代码，但你尝试过这样的事情吗？

```
function drawbackground(canvas, context, onload){

    var imagePaper = new Image();

        imagePaper.onload = function(){

            context.drawImage(imagePaper,100, 20, 500,500);
            onload(canvas, context);
        };

      imagePaper.src = "images/main_timerand3papers.png";
} 
```

然后像这样调用方法...

```
 drawbackground(canvas, context, drawlines); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-16T18:47:32.947

为了提高效率，假设您要对这条或多条线进行多次重绘，请将`background-image`画布的 CSS 设置为您的图像。

```
<canvas style="background-image:url('images/main_timerand3papers.png');"></canvas> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-16T17:46:29.253

将您的图像 onload 更改为以下内容：

```
imagePaper.onload = function () {
    context.drawImage( imagePaper, 100, 20, 500, 500 );
    drawLines( canvas, context );
}; 
```

然后确保删除之前对`drawLines`.

该解决方案的重要内容是该`onload`函数将在将来的某个时间执行，而 drawLines 函数将立即执行。您必须始终小心构建回调的方式，尤其是在嵌套它们时。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-26T08:54:32.677

或者你可以试试这个：

```
drawbackground(canvas, context);
context.globalCompositeOperation = 'destination-atop';
drawlines(canvas, context); 
```

# java - 使用 int 与 Integer

> ID：10623682
> 
> 赞同：64
> 
> 时间：2012-05-16T17:34:18.280
> 
> 标签：java, integer, int, primitive

我遇到了一个使用整数变量来捕获要在 for 循环中使用的大小的类。这是一种好的做法还是我们应该使用 int 原始数据类型？

```
Integer size = something.getFields().size();
for (Integer j = 0; j < size - 1; ++j) 
```

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2012-05-16T17:38:58.660

提供了 Integer 类，以便可以以纯 OO 方式对值进行装箱/拆箱。在适当的情况下使用 int ，除非您特别需要以 OO 方式使用它；在这种情况下，整数是合适的。

[Java 整数与整数](http://illegalargumentexception.blogspot.com/2008/08/java-int-versus-integer.html)

> 但是，这里的幕后正在发生非常不同的事情。int 是一个数字；an > Integer 是可以引用包含数字的对象的指针。
> 
> ...
> 
> int 不是对象，不能传递给任何需要对象的方法。一个常见的情况是使用提供的集合类（ List 、 Map 、 Set ）——尽管可以编写这些类的版本来提供与对象版本类似的功能。每当使用自省（例如在反射 API 中）时，经常需要包装类（ Integer 、 Double 等）。

关于何时使用一个与另一个的更好描述：

在 int 和 Integer 之间进行选择

> 在详细说明原因之前，我将从如何使用这些类型开始。
> 
> *   `int`出于性能原因更喜欢
> *   采用对象的方法（包括泛型类型，如`List<T>`）将隐含地需要使用 Integer
> *   `Integer`对于低值（-128 到 127），使用相对便宜，因为实习 - 使用`Integer.valueOf(int)`而不是 new Integer(int)
> *   不要使用`==`或`!=`与整数类型一起使用
> *   考虑`Integer`在需要表示不存在值时使用（null）
> *   小心将整数值拆箱为具有空值的 int

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2012-05-16T17:36:47.983

如果可以使用`int`，请这样做。如果该值可以`null`或用作对象，例如泛型，请使用`Integer`

通常，您使用哪一个并不重要，但通常`int`性能稍好一些。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-05-16T17:37:03.813

这种方法在实践中并不好，`int`尽可能使用。的用法`Integer`表明这个特定的变量可以是`null`（或者它在一个集合中，该死的泛型......） - 事实并非如此。

使用还`Integer`引入了装箱和拆箱的额外开销。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-16T17:38:24.337

这是在大型项目中等待发生的潜在灾难。这里的编码器忘记了每个 Integer 实际上是一个新对象，并且，要将其用作 int，必须一直进行装箱和拆箱。它不仅效率低下，而且也不会按预期运行。最好建议您始终尽可能使用 int，并且仅使用 Integer 将这些值放入列表、容器或用于数据库存储。请记住，使用 >、< 和 == 比较对象的含义与使用相同的运算符比较原语不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-16T17:36:54.530

总是尽可能地提升原始类型。

原始类型不能用作 GenericArgument 或 null。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-16T17:38:54.060

不要只用它来循环。使用原始类型 int（性能更好），它与 Class Integer 不同。

> Integer 类将原始类型 int 的值包装在一个对象中。Integer 类型的对象包含一个类型为 int 的字段。
> 
> 此外，该类提供了几种将 int 转换为 String 和 String 转换为 int 的方法，以及在处理 int 时有用的其他常量和方法。

因此，如果您需要调用 Integer 函数或需要为其分配空值，请使用 Integer。

对于 List 等泛型，您还需要使用 Integer 而不是 int

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-16T17:40:10.830

当需要使用对象时，您必须使用 Wrapper 类，如 Integer、Double、Float 等...

例如：

```
 int n = Integer.parseInt("10"); 
```

这里我们将字符串转换为整数（原始类型），但方法 parseInt(String str) 仅适用于 Wrapper 类（即 Object），因此我们使用了它......你会发现它在 java 中的更多用途。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-16T17:41:51.210

由于装箱和拆箱可能会导致性能损失，因为您会产生在原始类型和引用类型之间进行转换的开销。

但是，Integer 类添加了非常有用的其他方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-17T08:38:07.447

由于纯粹的面向对象，我通常使用整数。int 的性能绝对比它的对应对象好得多，但只有当你在循环中循环数百万次时才会注意到它。

恕我直言，如果性能在您的应用程序中至关重要，并且您甚至想压缩一纳秒，那么请使用 int 而无需任何大脑。但是，如果主要关注 OO 和可读性，则使用 Integer。

# ios - UISaveVideoAtPathToSavedPhotosAlbum: 和 writeVideoAtPathToSavedPhotosAlbum: 有什么区别？

> ID：10623688
> 
> 赞同：1
> 
> 时间：2012-05-16T17:34:46.580
> 
> 标签：ios

两者似乎都在做同样的事情。

是否有理由使用其中一个而不是另一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:06:57.520

UISaveVideoAtPath... 是 C API（UIKit 中定义的*函数）*

writeVideoAtPath... 是 Obj-C API（在 ALAssetLibrary 中声明的*实例方法）*

# jquery - 使用 $(window).height 作为动画值

> ID：10623690
> 
> 赞同：1
> 
> 时间：2012-05-16T17:34:49.227
> 
> 标签：jquery

我试图将窗口高度作为动画的值传递，但在这个 jQuery 函数中没有运气。有人可以告诉我我在这里做错了什么吗？

下面是我的代码和小提琴。

```
$("slice").onclick().animate(function() {
    $(this).animate({
        var theHeight = $(window).height();
        top: '+=theHeight',
    });

}); 
```

[http://jsfiddle.net/rH4JJ/1/](http://jsfiddle.net/rH4JJ/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:38:00.463

你需要这样的东西吗？

```
$(".slice").click(function () {
    var theHeight = $(window).height();
    $(this).animate({
        top: '+=' + theHeight
    });
}); 
```

​演示 **：http:** [//jsfiddle.net/rH4JJ/4/](http://jsfiddle.net/rH4JJ/4/)

是的，为了确保，在上面的示例中，`position: relative`样式被添加到`slice`元素中。否则，改变`top`是没有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:41:28.253

不起作用，因为它以大约六种不同的方式完全荒谬。

```
$('.slice').click(function() {
    var theHeight = $(window).height();
    $(this).animate({
        top: '+=' + theHeight
    });
}); 
```

您还必须提供`slice`元素`position: relative`以便能够为它们的位置设置动画。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T17:42:48.443

除了 VisioN 的回答，请注意，您需要为元素提供一个开始的位置（注意他们添加了位置：相对于该小提琴中的 css）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T17:49:12.633

您需要学习 CSS（div 的宽度为 100%）、jQuery 和 jsFiddle（在侧边栏中选择 jQuery）

```
$(".slice").on("click",function(){
    var theHeight = $(window).height();
    $(this).animate({
        top: "+="+theHeight
    });

}); 
```

编辑：我把 Div 放在绝对（通常）中，但从你的例子中相对更好。 [http://jsfiddle.net/rH4JJ/16/](http://jsfiddle.net/rH4JJ/16/)

# objective-c - 比较两个 JSON 文件目标 c

> ID：10623692
> 
> 赞同：1
> 
> 时间：2012-05-16T17:34:59.763
> 
> 标签：objective-c, xcode

这个问题是开放的，但我在网上找不到任何答案。希望不是抄袭：

我必须从 Json 文件在我的应用程序中加载一些数据。每 3 秒，之前加载的所有对象都会被删除，然后重新加载（完全重新分配）。我希望应用程序首先检查是否有变化，并且只有在有变化的情况下，重新加载整个数据，或者更好的是，只重新加载新数据。如何检查文件是否已被修改？例如，我可以从保管箱中获取日期并检查文件更新版本的日期吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:39:19.130

忽略对特定数据更改的检查，您可以在读取文件时存储文件的哈希/校验和，并在重新加载文件之前将校验和/哈希与存储的进行比较。没有变化=>没有重新加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:57:09.727

根据这个讨论，您可以在 Dropbox 上获取文件的*元数据*并检查元数据中的*rev*字段。（代表修订。）因此，您可以跟踪程序中的*rev*，并且仅在文件更改时尝试重新加载文件。

[http://forums.dropbox.com/topic.php?id=48787](http://forums.dropbox.com/topic.php?id=48787)

请注意，有一个较旧的元数据进行修订，但已被弃用。（也包括在讨论中。）

# c# - 在 WinForms WebBrowser 控件中禁用 javascript？

> ID：10623697
> 
> 赞同：8
> 
> 时间：2012-05-16T17:35:23.687
> 
> 标签：c#, javascript, winforms, webbrowser-control

如何在 WinForms 的 WebBrowser 上完全禁用 javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:38:07.070

你不能。客户端应用程序无法在浏览器中禁用 JavaScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T17:41:56.507

有了这个，您可以禁用来自 javascript 的警告

```
webBrowser.ScriptErrorsSuppressed = true; 
```

# ruby-on-rails - 嵌入式多态关联模型形式

> ID：10623700
> 
> 赞同：0
> 
> 时间：2012-05-16T17:35:32.577
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, haml

我有这些模型：

模型1：

```
module Ems  
  class Article < ActiveRecord::Base
    has_many :images, :as => :imageable
    accepts_nested_attributes_for :images 
  end
end 
```

模型 2：

```
module Ems
  class Image < ActiveRecord::Base
    belongs_to :imageable, :polymorphic => true
  end
end 
```

看法：

```
= form_for @article do |f|
  %div
    = f.label :title
    = f.text_field :title
  %div
    - f.fields_for :images do |builder| 
      = builder.label :title
      = builder.text_field :title 
```

我没有收到任何错误，但是我也没有得到嵌入图像表单的表单字段。我得到的只是一个空的 DIV。

谁能指出我正确的方向？
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T09:32:24.217

在你调用 fields_for 的地方用 = 替换 - 后尝试

```
 = f.fields_for :images do |builder| 
```

fields_for 返回表单 HTML，因此您需要在 UI 上呈现它。

# excel - 如何将 VBA 宏绑定到 Excel 中的按钮

> ID：10623704
> 
> 赞同：0
> 
> 时间：2012-05-16T17:35:46.857
> 
> 标签：excel, vba

我已经创建了一个宏和一个按钮，但我看不到在哪里编辑按钮设置来调用宏。我正在使用 Excel 2003。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T18:37:44.963

如果您使用过表单控件。将按钮添加到工作表后，将立即出现分配宏的机会。或者，如果按钮已经在工作表上，您可以右键单击它并选择分配宏。

如果您使用过 ActiveXControl，请右键单击该按钮并选择查看代码。这将打开 VBE

```
Private Sub myCommandButtonName_Click() 

End Sub 
```

从这个子调用你的宏像这样......

```
Private Sub myCommandButtonName_Click() 

Call myMacro

End Sub 
```

# clearcase - Foundation baseline different in snapshot view than when created

> ID：10623710
> 
> 赞同：1
> 
> 时间：2012-05-16T17:36:24.927
> 
> 标签：clearcase, clearcase-ucm

I created a snapshot view, all view access properties show the date i created it, date last modified, last accessd etc.. are all the date it should be April 10 BUT the Configurations tab shows a foundation baseline of the next release up May 10

Now I do it difrent; I create a child stream created with the older baseline and then make a snapshot but I would like to know why this snapshot I made 4/10 has a foundation baseline of 5/10 Weird how it shows a foundation baseline that is newer than the date it was created, Maybe CC just knows this is the foudantion of this next release i guess

I did a compare and the files are still the same as the date I created the snapsot is appears but if not I am in trouble...

I am new to CC and devolpement Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:51:05.223

没有什么可以阻止任何人从*antoehr视图中**更改*您查看的 Stream 所基于的基础。

然后，当您更新快照视图时，ClearCase 将检测到 Stream 的配置更改，并建议将您的视图的配置规范与 Stream 同步。
因此，您的视图配置发生了变化。

您在这种情况下所做的事情是正确的：根据正确的基线创建一个子 Stream，然后从那里开始工作。

请参阅“[变基操作](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/topic/com.ibm.rational.clearcase.cc_proj.doc/images/rebase_details.gif)”：

![变基](../Images/a0b6d98416b7a3eaf641bdcb924cec39.png)

> Pat 的开发流中的一个组件配置了 baseline `BL1`。
> **变基操作将流的配置`BL2`从集成流**更改为基线。
> 变基操作将文件和目录从集成流或特定于功能的开发流合并到开发流。

# xml - How to access an exact XML node and not the value of it in an XSL stylesheet

> ID：10623717
> 
> 赞同：0
> 
> 时间：2012-05-16T17:36:47.620
> 
> 标签：xml, xslt

Ok,

So in my XML file I have an image node:

`<img alt="Green arrow" src="green-arrow-up-icone-5011-48.png"/>`

Now I want to display this in my webpage using XSL:

If I use `<xsl:value-of select = "//img"/>`

(there is only one image), I don't get anything because the "value of" img is nothing as it has no nodes in it. How do I make XSL just take that node as it is and just display it on the webpage?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:40:03.893

```
<xsl:copy-of select="expression"/> 
```

[http://www.w3schools.com/xsl/el_copy-of.asp](http://www.w3schools.com/xsl/el_copy-of.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:41:30.920

分别有`xsl:copy-of`例如。`<xsl:copy-of select="img"/>``<xsl:template match="img"><xsl:copy-of select="."/></xsl:template>`

# java - How Sip or HTTP Listener works in Java

> ID：10623721
> 
> 赞同：1
> 
> 时间：2012-05-16T17:36:55.430
> 
> 标签：java, protocols, listener

I came across a SIP API the other day. What I do not understand is, why I only need to implement the API's listener interface to handle the SIP message? For ex:

```
public void onReInviteSuccessResponse(InviteAgent invite, int code,
            String reason, String body, Message msg);

public void onReInviteFailureResponse(InviteAgent invite, int code,
            String reason, Message msg); 
```

I would be glad if anyone can tell me how the code knows when SIP or HTTP messages are actually received?

# python - Python 间距和对齐字符串

> ID：10623727
> 
> 赞同：64
> 
> 时间：2012-05-16T17:37:19.697
> 
> 标签：python, string, alignment

我正在尝试添加间距以对齐两个字符串 vars 之间的文本而不使用`" "`这样做

试图让文本看起来像这样，第二列对齐。

```
Location: 10-10-10-10       Revision: 1
District: Tower             Date: May 16, 2012
User: LOD                   Time: 10:15 
```

目前有这样的编码，只使用空格......

```
"Location: " + Location + "               Revision: " + Revision + '\n' 
```

我尝试使用`string.rjust`&`srting.ljust`但无济于事。

建议？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-05-16T17:45:17.897

您应该能够使用格式方法：

```
"Location: {0:20} Revision {1}".format(Location, Revision) 
```

您必须根据标签的长度计算出每行的格式长度。该`User`行将需要比`Location`or`District`行更宽的格式宽度。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2012-05-16T17:46:40.217

尝试`%*s`并`%-*s`在每个字符串前面加上列宽：

```
>>> print "Location: %-*s  Revision: %s" % (20,"10-10-10-10","1")
Location: 10-10-10-10           Revision: 1
>>> print "District: %-*s  Date: %s" % (20,"Tower","May 16, 2012")
District: Tower                 Date: May 16, 2012 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2012-05-16T17:47:51.463

您可以使用`expandtabs`来指定制表位，如下所示：

```
print(('Location: ' + '10-10-10-10' + '\t' + 'Revision: 1').expandtabs(30))
print(('District: Tower' + '\t' + 'Date: May 16, 2012').expandtabs(30)) 
```

输出：

```
Location: 10-10-10-10         Revision: 1
District: Tower               Date: May 16, 2012 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2020-07-08T20:17:00.687

从 Python 3.6 开始，我们有一个更好的选择，f-strings！

```
print(f"{'Location: ' + location:<25} Revision: {revision}")
print(f"{'District: ' + district:<25} Date: {date}")
print(f"{'User: ' + user:<25} Time: {time}") 
```

输出：

```
Location: 10-10-10-10     Revision: 1
District: Tower           Date: May 16, 2012
User: LOD                 Time: 10:15 
```

由于大括号内的所有内容都是在运行时评估的，因此我们可以输入`'Location: '`与变量连接的字符串`location`。Using`:<25`将整个连接的字符串放入一个 25 个字符长的框中，并`<`指定您希望它左对齐。这样，第二列总是在为第一列保留的 25 个字符之后开始。

这里的另一个好处是您不必计算格式字符串中的字符。使用 25 将适用于所有这些，前提是 25 的长度足以包含左列中的所有字符。

[https://realpython.com/python-f-strings/](https://realpython.com/python-f-strings/)解释了 f-strings 相对于以前的选项的好处。 [https://medium.com/@NirantK/best-of-python3-6-f-strings-41f9154983e](https://medium.com/@NirantK/best-of-python3-6-f-strings-41f9154983e)解释了如何使用 <、> 和 ^ 进行左对齐、右对齐和居中对齐。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-05-16T18:26:38.667

@IronMensan 的格式方法答案是要走的路。但为了回答您关于 ljust 的问题：

```
>>> def printit():
...     print 'Location: 10-10-10-10'.ljust(40) + 'Revision: 1'
...     print 'District: Tower'.ljust(40) + 'Date: May 16, 2012'
...     print 'User: LOD'.ljust(40) + 'Time: 10:15'
...
>>> printit()
Location: 10-10-10-10                   Revision: 1
District: Tower                         Date: May 16, 2012
User: LOD                               Time: 10:15 
```

编辑注意这个方法不需要你知道你的字符串有多长。.format() 也可能，但我对它还不够熟悉。

```
>>> uname='LOD'
>>> 'User: {}'.format(uname).ljust(40) + 'Time: 10:15'
'User: LOD                               Time: 10:15'
>>> uname='Tiddlywinks'
>>> 'User: {}'.format(uname).ljust(40) + 'Time: 10:15'
'User: Tiddlywinks                       Time: 10:15' 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-07-03T19:48:12.153

复活另一个话题，但这对某些人来说可能会派上用场。

[从https://pyformat.info](https://pyformat.info)获得一点启发，您可以构建一种方法来获取目录 [TOC] 样式的打印输出。

```
# Define parameters
Location = '10-10-10-10'
Revision = 1
District = 'Tower'
MyDate = 'May 16, 2012'
MyUser = 'LOD'
MyTime = '10:15'

# This is just one way to arrange the data
data = [
    ['Location: '+Location, 'Revision:'+str(Revision)],
    ['District: '+District, 'Date: '+MyDate],
    ['User: '+MyUser,'Time: '+MyTime]
]

# The 'Table of Content' [TOC] style print function
def print_table_line(key,val,space_char,val_loc):
    # key:        This would be the TOC item equivalent
    # val:        This would be the TOC page number equivalent
    # space_char: This is the spacing character between key and val (often a dot for a TOC), must be >= 5
    # val_loc:    This is the location in the string where the first character of val would be located

    val_loc = max(5,val_loc)

    if (val_loc <= len(key)):
        # if val_loc is within the space of key, truncate key and
        cut_str =  '{:.'+str(val_loc-4)+'}'
        key = cut_str.format(key)+'...'+space_char

    space_str = '{:'+space_char+'>'+str(val_loc-len(key)+len(str(val)))+'}'
    print(key+space_str.format(str(val)))

# Examples
for d in data:
    print_table_line(d[0],d[1],' ',30)

print('\n')
for d in data:
    print_table_line(d[0],d[1],'_',25)

print('\n')
for d in data:
    print_table_line(d[0],d[1],' ',20) 
```

结果输出如下：

```
Location: 10-10-10-10         Revision:1
District: Tower               Date: May 16, 2012
User: LOD                     Time: 10:15

Location: 10-10-10-10____Revision:1
District: Tower__________Date: May 16, 2012
User: LOD________________Time: 10:15

Location: 10-10-... Revision:1
District: Tower     Date: May 16, 2012
User: LOD           Time: 10:15 
```

# android - 将文件从 apk 复制到内部存储

> ID：10623733
> 
> 赞同：1
> 
> 时间：2012-05-16T17:37:52.257
> 
> 标签：android

我想将一个文本文档从 apk 推送到 /system 目录（是的，它是一个适用于 root 用户的应用程序）并且想知道我将如何做到这一点:) 我的 txt 文件位于 assests 文件夹中，但如果需要可以使用它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:52:38.063

将文本文件放在项目的资产目录中，然后使用以下线程中的代码将其解压缩到文件系统： [如何将文件从“资产”文件夹复制到 sdcard？](https://stackoverflow.com/questions/4447477/android-how-to-copy-files-in-assets-to-sdcard)

编辑：这是我使用的一些代码。对于 sourceFileName，传入相对于资产文件夹的资产文件的名称（例如，如果资产文件夹中有 myFile.txt，则传递 myFile.txt）。对于目标文件，传递完整路径（例如 /data/data/com.mycompany/mypackage/myFile.txt）。context 是当前活动（例如 MyActivity.this）。

```
private boolean copyFile(Context context, String sourceFileName, String destFileName)
{
    AssetManager assetManager = context.getAssets();

    File destFile = new File(destFileName);

    File destParentDir = destFile.getParentFile();
    destParentDir.mkdir();

    InputStream in = null;
    OutputStream out = null;
    try
    {
        in = assetManager.open(sourceFileName);
        out = new FileOutputStream(destFile);

        byte[] buffer = new byte[1024];
        int read;
        while ((read = in.read(buffer)) != -1)
        {
            out.write(buffer, 0, read);
        }
        in.close();
        in = null;
        out.flush();
        out.close();
        out = null;

        return true;
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }

    return false;
} 
```

EDIT2：结果表明 /system 分区以只读方式安装，即使在有根设备上也是如此。这可能会有所帮助：[Android：如何从我的 APK 中将文件系统挂载到 RW 中？（当然是有根的）](https://stackoverflow.com/questions/5481395/android-how-to-mount-filesystem-in-rw-from-within-my-apk-rooted-of-course)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:02:55.230

你可以试试这个功能（在[这里](http://gimite.net/en/index.php?Run%20native%20executable%20in%20Android%20App)找到）：

```
public String runSystemCommand(String cmd)
{
    try {
        // Executes the command.
        Process process = Runtime.getRuntime().exec(cmd);

        // Reads stdout.
        // NOTE: You can write to stdin of the command using
        //       process.getOutputStream().
        BufferedReader reader = new BufferedReader(
                new InputStreamReader(process.getInputStream()));
        int read;
        char[] buffer = new char[4096];
        StringBuffer output = new StringBuffer();
        while ((read = reader.read(buffer)) > 0) {
            output.append(buffer, 0, read);
        }
        reader.close();

        // Waits for the command to finish.
        process.waitFor();

        return output.toString();
    } catch (IOException e) {
        throw new RuntimeException(e);
    } catch (InterruptedException e) {
        throw new RuntimeException(e);
    }       
} 
```

我自己试过这样：

```
 String cmdoutput = this.runSystemCommand("/system/bin/ls .");
    Log.d("SampleAndroidInterfaceActivity", "runSystemCommand() returned: " + cmdoutput); 
```

并且运作良好。这是我的输出：

```
05-16 17:50:10.423: runSystemCommand() returned: acct
05-16 17:50:10.423: cache
05-16 17:50:10.423: config
05-16 17:50:10.423: d
05-16 17:50:10.423: data
05-16 17:50:10.423: default.prop
05-16 17:50:10.423: dev
05-16 17:50:10.423: etc
05-16 17:50:10.423: init
05-16 17:50:10.423: init.goldfish.rc
05-16 17:50:10.423: init.rc
05-16 17:50:10.423: mnt
05-16 17:50:10.423: proc
05-16 17:50:10.423: root
05-16 17:50:10.423: sbin
05-16 17:50:10.423: sdcard
05-16 17:50:10.423: sys
05-16 17:50:10.423: system
05-16 17:50:10.423: ueventd.goldfish.rc
05-16 17:50:10.423: ueventd.rc
05-16 17:50:10.423: vendor 
```

如果你知道你的 txt 文件的绝对路径，你可以很容易地用`cp`.

# linux - 适用于 Linux 上的 REST 和/或 SOAP Web 服务开发的堆栈/框架

> ID：10623735
> 
> 赞同：3
> 
> 时间：2012-05-16T17:37:56.743
> 
> 标签：linux, web-services, rest, soap

我一直在尝试对 CentOS/Redhat 的 REST 和 SOAP Web 服务支持框架进行一些研究，这些框架也能够合理地支持管理 Web 应用程序以及服务本身。

我们尚未确定 REST 或 SOAP 是否会成为服务通信的方式。通信要求非常简单，因此可能不需要更重的 SOAP 接口。（但也不会很复杂）

我过去曾使用过 Ruby on Rails（目前在一边），但我的团队中的其他人并不像 J2EE 那样熟悉这项技术。

ServiceStack 也很有趣（我现在正在研究它），但我过去曾参与过 .Net/Mono 项目，并且遇到过各种 Mono 实现和运行时问题。（我敢肯定在过去 2 年里它已经走了很长一段路，但我想看看是否有更好的选择）

基本上我需要一个支持 REST 或 SOAP（两者都很棒）并且可以支持 MVC 风格的 Web 应用程序的堆栈/框架。这个想法是 Web 服务和 Web 应用程序可以访问同一个数据库。Web 应用程序将是最终用户/管理员管理界面，Web 服务将用于远程系统/自动访问受控数据。

最后，大约 80% 的应用程序数据库模式将被预定义，并且不会遵循任何 MVC 样式建模。因此，一个旨在对仅用于 MVC 的模式数据进行紧密建模的框架（如 Ruby on Rails）并不可取，因为我们最终不得不重新创建模型或编写一个完全独立的数据库查询处理库， Web 服务和 Web 应用程序都必须使用。如果可以更灵活地对现有数据进行建模，那就太好了。（以防现有架构在以后发生更改）

对不起，如果我太笼统了。（或具体）我只是对意见感兴趣。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-16T22:10:22.193

## ServiceStack 服务可以被 REST、SOAP 或 MQ 客户端使用

REST 和 SOAP 是不同的方法，尽管[ServiceStack](http://www.servicestack.net)的基于消息的 DTO-first 方法是唯一允许 REST 和 SOAP 端点调用相同服务**的 .NET 框架。**由于您的 ServiceStack Web 服务是**纯 C# 服务**，因此同样的服务也可以托管在 InMemory 或[Redis MQ Host](https://github.com/ServiceStack/ServiceStack/wiki/Messaging-and-redis)中。（还有一个[RCON](https://developer.valvesoftware.com/wiki/Source_RCON_Protocol)非 http 上下文[主机选项](https://github.com/ServiceStack/ServiceStack/tree/master/src/ServiceStack.Common/Messaging/Rcon)）。

### SOAP 的固有限制

尽管 SOAP 通过**HTTP Post**路由所有内容，但您需要围绕此限制定义您的服务，并为您希望在 SOAP 端点中提供的每个服务使用一个新类。下面是一个示例，说明如何创建[也可通过 SOAP 获得](https://github.com/ServiceStack/ServiceStack/wiki/SOAP-support)的 REST 服务。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-16T17:48:36.897

REST 和 SOAP 在许多方面都非常不同。

REST 是一种架构风格，SOAP 是一种协议。SOAP 定义了事物的通信方式，REST 定义了无状态描述的方式。

我确实更喜欢带有 HATEOAS（超媒体作为应用程序状态引擎）的 REST。具有该架构的应用程序使用内容协商（接受 HTTP 上的标头）公开具有特定 URI（如[http://example.com/users ）和这些资源的表示（以 JSON、XML、HTML 等形式）的资源。](http://example.com/users)

HATEOS 部分是资源之间的链接，例如`<a href=`在 HTML 或`<link href=`ATOM 或 JSON Schema 上用于在 JSON 中链接。

[Netflix API http://api.netflix.com/](http://api.netflix.com/)是一个很好的参考实现。他们太棒了。

RESTful 实现的框架可用于多种语言。在 Ruby 上，Sinatra 可能是最好的选择。Flask 将成为 Python 的人选。在 node.js 上，expressjs 变得非常流行。

我是一个 PHP 人。在我知道的所有框架中（包括 Zend、Symfony、Slim、Code Igniter 和许多其他框架），最好的 REST 实现是这个[http://documentup.com/Respect/Rest](http://documentup.com/Respect/Rest)。它是以理智的方式实现内容协商的唯一方法。（免责声明：我已经对其进行了编码，我的观点可能有偏见。使用诸如 RESTful 框架的石蕊测试[http://code.google.com/p/implementing-rest/wiki/LitmusTestForFrameworks](http://code.google.com/p/implementing-rest/wiki/LitmusTestForFrameworks)之类的东西获取您自己的观点）。

有一种情况我确实更喜欢 SOAP 通信：当使用我的服务的客户端已经将 SOAP 用于其他任何事情时。在这种情况下，一致性获胜。我相信，Java 人可能也会更喜欢 SOAP。

# html - 使用 Internet Explorer 时在 Rails 应用程序视图中显示的 HTML 标记

> ID：10623746
> 
> 赞同：0
> 
> 时间：2012-05-16T17:38:48.700
> 
> 标签：html, ruby-on-rails-3, internet-explorer

当我在 Internet Explorer 中查看我的 Rails (3.1) 应用程序时，由于某种原因，它有时会在我的页面末尾显示一些 html 标记，但在 Chrome 或 Firefox 中却没有。特别是，它显示标签的一部分 - 不是完整的标签，而是部分 - 像`</h`或`</htm`- 在视图中作为文本（在页面底部）。

在我的布局模板中，我确实有这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
     <title><%= title %></title>

     <% if params[:controller] == 'pages' %>
       <%= stylesheet_link_tag "static_pages", "https://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/redmond/jquery-ui.css" %>
     <%  elsif %>
       <%= stylesheet_link_tag "bootstrap", "https://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/themes/redmond/jquery-ui.css" %>  
     <% end %>

     <%= javascript_include_tag "https://ws.sharethis.com/button/buttons.js", "admin.js" %>

     <%= csrf_meta_tag %>

     <script type="text/javascript" charset="utf-8"> 
        //jQuery.noConflict();
        jQuery.extend( jQuery.fn.dataTableExt.oStdClasses, {
                "sSortAsc": "header headerSortDown",
                "sSortDesc": "header headerSortUp",
                "sSortable": "header"
            } );

        jQuery(document).ready(function() {
            jQuery('#datatable').dataTable( {
                    "sDom": "<'row'<'span5'l><'span8'f>r>t<'row'<'span4'i><'span8'p>>",
                    "sPaginationType": "bootstrap"
                     } );
            } );
      </script>

      <%= yield :javascript%>
      <%= yield :script%>

   </head>
   <body>

   </body>
</html> 
```

当我查看为视图生成的 html 源代码时，我注意到源代码以 Chrome/Firefox 结尾`</body>`而不是结尾`</html>`（或任何部分代码，如 IE）。

有人可以让我知道我做错了什么吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:12:55.760

除非包含强制子项（如您正在使用的 doctype 'Transitional' 的 DTD 中定义的那样，否则空的 Head 标记将不会被识别为格式正确（关闭）。）

给它一个标题

```
 <head>
  <title>A Title</title>
 </head> 
```

我认为这对所有文档类型都是强制性的（但不要引用我的话）——但也无声点——每个网页都应该有一个标题。

更新：说标题存在，但听起来仍然像一个“格式良好”的问题..

1）运行，**查看源代码**并将所有代码复制到记事本/simular中并将其保存为test.html（这将突出显示任何不正确的字符，如（“）等..

2) 将您的 test.html 上传到 w3c 验证器服务[w3c 验证器服务](http://validator.w3.org/#validate_by_upload) 这应该会提供一些很好的线索

希望破解它

# python - 如何从python中的参数创建变量

> ID：10623751
> 
> 赞同：0
> 
> 时间：2012-05-16T17:38:57.920
> 
> 标签：python, function, global-variables, local-variables

我想在python中创建一个函数，其中一个参数是稍后的变量......

作为一个例子，它应该是这样的

```
foo=myfunction("var1","var2",otherarguments) 
```

（注意`var1`and`var2`是以前从未使用过的字符串）

那么程序应该使

```
var1=blabla
var2=blabla2/otheraguments 
```

我需要这个才能使用 GNUplot 制作图表，变量将用于设置图表的参数

例如这应该在函数内部

```
var1=Gnuplot.Gnuplot(debug=1)
var1("set terminal gif animate delay 10") #to make animation in gnuplot
var1("set style data lines")
var1.xlabel("name_of_x_axis")
var1("set pm3d")
var1.title("newgraph in 3d")
var1.splot(Gnuplot.GridData(otherarguments,X,Y,binary=0)) 
```

我试过这样的东西

```
example={"var1":"Gnuplot.Gnuplot(debug=1)","var2":[1,2,3,4,5,6,7,8,9]} 
```

进而

```
locals().update(example) 
```

或者

```
globals().update(example) 
```

但我不确定如何在函数中实现它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:44:18.653

`string`从使用中创建变量`vars()`

```
>>> foo="bar"
>>> vars()[foo] = 'qwertry'
>>> print bar  # --> 'qwertry' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:51:55.953

编辑：演示返回对绘图的引用以供以后使用

```
def myfunction():
    var1=Gnuplot.Gnuplot(debug=1)
    var1("set terminal gif animate delay 10") #to make animation in gnuplot
    var1("set style data lines")
    var1.xlabel("name_of_x_axis")
    var1("set pm3d")
    var1.title("newgraph in 3d")
    return var1

myplot = myfunction()
# Now call myplot.splot with whatever arguments you want.
myplot.splot(Gnuplot.GridData(otherarguments, X, Y, binary=0))
myplot.splot(Gnuplot.GridData(morearguments, X, Y, binary=0))
myplot.splot(Gnuplot.GridData(stillmore, X, Y, binary=0))
for args in list_of_arguments:
    myplot.splot( Gnuplot.GridData(args, X, Y, binary=0) ) 
```

# php - Google 电子表格 API 在 Cron 作业中形成 PHP

> ID：10623759
> 
> 赞同：3
> 
> 时间：2012-05-16T17:39:29.457
> 
> 标签：php, oauth, google-sheets, google-data-api

有太多关于谷歌 API 的信息。所以我迷失在所有的研究中。

我的目标：

我的 google 文档帐户下有一个电子表格。我想每天运行一个 cron 作业，从特定单元格中提取单元格值（它每天都会增加到下一行），然后对其他服务进行一些其他 API 调用，然后将结果写入同一行的另一列中。

大多数 oAuth 2.0 的东西都需要询问用户，这在 cron 作业中是不可能发生的。我发现了一些关于服务帐户的信息，但那是一种全新的帐户类型，而且它似乎有自己的凭据。我已经创建了 4 种类型的安全凭证。

问题）如何在不向用户询问任何内容的情况下在 PHP 中验证我的 google 帐户？

身份验证后我想与 cURL 一起使用的 URL 是这个

```
https://spreadsheets.google.com/tq?tqx=out:json&tq=<QUERY>&key=<MY KEY> 
```

感谢任何能提供帮助的人！

# asp.net - 替换 ASPX 文件

> ID：10623761
> 
> 赞同：3
> 
> 时间：2012-05-16T17:39:35.203
> 
> 标签：asp.net, user-interface, overriding

我们希望能够偶尔换出/替换/覆盖 ASPX 文件。这就是场景。

我们有一个用 ASP.NET 编写的门户，其中已经有大量页面 - 用于查看数据、更新记录、报告等。一些客户“非常重要”，因此我们需要能够为他们定制某些页面，这样当他们登录时，他们会看到一个为他们定制的页面。

母版页很棒 - 我们可以自定义页眉、页脚等，但我们可能想要隐藏某些区域，或者完全移动它们。母版页无法做到这一点。

主题/皮肤有利于 CSS 并使控件的行为有所不同，但这同样不允许我完全重新组织特定页面。

所以我希望能够编写代码去“嘿，我作为一个特殊的客户端登录，去看看我所在的那个是否有一个'覆盖'.aspx页面。如果有，使用那个。否则使用已经存在的 .aspx。

这意味着我可以在我的服务器上为我的每个“特殊客户端”创建一个目录，其中包含覆盖默认值的奇数 .aspx 文件。

我怎样才能做到这一点？

非常感谢尼克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:58:54.383

为此，您需要注册一个处理`.aspx`文件的页面工厂。所以首先创建一个扩展的新类`PageHandlerFactory`：

```
public class MyPageFactory : PageHandlerFactory
{
    public override IHttpHandler GetHandler(
        HttpContext httpContext, string requestType, string url, 
        string pathTranslated)
    {
        // Here you can inspect `HttpContext` and perform whatever checks you
        // need to determine whether or not to use your custom overridden page.
        if (shouldOverride) 
        {
            var newVirtualPath = "/Overrides/Foo/MyPage.aspx";
            string newFilePath = httpContext.Server.MapPath(newVirtualPath);

            // Now create the page instance
            IHttpHandler page = PageParser.GetCompiledPageInstance(newVirtualPath, newFilePath, httpContext);
            return page;
        }
        else 
        {
            // If we're not overriding, just return the default implementation
            return base.GetHandler(httpContext, requestType, url, pathTranslated);
        }
    }
} 
```

不要忘记在您的`web.config`(IIs7) 中注册它：

```
<system.webServer>
    <httpHandlers>
        <add verb="*" path="*.aspx" type="MyPageFactory" />
    </httpHandlers>
</system.webServer> 
```

或 < IIS7：

```
<system.web>
    <httpHandlers>
        <add verb="*" path="*.aspx" type="MyPageFactory" />
    </httpHandlers>
</sysetm.web> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:18:19.193

我假设识别客户端类型以显示某些信息的机制在数据库中？

无论哪种方式，对我来说，您所说的似乎是提供一些类似 CMS 的功能，您可以在其中专门针对用户类型等内容进行内容处理。而不是覆盖页面并将其换出，这是可能的，但可能会使它过于复杂，使用 XML 或数据库来存储页面某些区域的内容，并在用户访问页面时拉入这些区域。

然后，您可以将页面的区域与用户的角色联系起来（如果所有内容都在数据库中）。然后，如果需要，您甚至可以允许特定角色自定义内容。

# compiler-construction - 如何处理作为有限自动机实现的词法分析器中的空格？

> ID：10623771
> 
> 赞同：2
> 
> 时间：2012-05-16T17:40:29.730
> 
> 标签：compiler-construction, whitespace, lexer, automata

我为一种简单的编程语言创建了词法分析器。现在我使用确定性有限自动机代替正则表达式（Java 中的 RegEx）。自动机工作得很好，但它不会报告错误，例如，如果我在源代码中有 moduleclouds（模块和云都是关键字）。相反，它将创建两个名为 KW_MODULE 和 KW_CLOUDS 的令牌。有人可能会争辩说，如果自动机处于 KW_MODULE 的最终状态，我可以提前寻找空白。但这并不能解决问题，因为在语言中我可以有类似 8-6 的东西（不被空格分隔），它可以正确地翻译成标记 INT DASH INT。

我知道在解析器的语法中处理空格不是一个好主意。

我的自动机实现为矩阵（行是状态，列是字母表中的字符，单元格是过渡状态）。当自动机进入最终状态时，我将自动机重置为从开始状态开始。

我认为问题在于这种编程语言不使用分号。例如：

模块; 云;

相反，它使用空白来分隔线条：模块云

提前致谢。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:34:47.603

FWIW，我研究过的解析器通过要求关键字也是语法定义的正确标识符来处理这个问题。

因此，例如，如果您将标识符定义为可选地后跟更多字符或数字的字符，则任何关键字也必须适合该模式。然后，词法分析器仅在已被归类为 ident 的情况下才将标记视为潜在关键字。

不过，我很想听听其他人如何处理这个问题。

# android - Android 关于市场上评分的按钮

> ID：10623772
> 
> 赞同：1
> 
> 时间：2012-05-16T17:40:34.530
> 
> 标签：android, button, share, rate

我对这段代码有点困惑，正在寻找类似的东西

```
Button bRate = (Button) findViewById(R.id.button7); 
bRate.setOnClickListener(new View.OnClickListener() { 
    //plus the code on the top here is my idea of the code 
} 
```

Elipse 说有问题，我知道我需要放置我的市场链接，但按钮仍然不起作用

我无法在同一页面上发布它是原始问题的链接

[使用应用程序在市场上对其进行评级](https://stackoverflow.com/questions/6899942/use-application-to-rate-it-on-market)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-16T17:43:43.387

您刚刚添加了您的应用程序包名称...

```
https://play.google.com/store/apps/details?id=your packagename 
```

并调用使用 `Intent.ACTION_VIEW`

```
String str ="https://play.google.com/store/apps/details?id=com.zeustechnocrats.quickfoods";
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(str))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-11T06:33:48.783

这对我使用图像按钮做同样的事情很有帮助。这里是我使用的代码。

```
 final ImageButton mybutton = (ImageButton) findViewById(R.id.imageButton); 
    mybutton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {

            String str ="https://play.google.com/store/apps/details?id=ws.crandell.newspaperpuzzles";
            startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(str)));

        }

    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-03T08:39:41.617

您可以使用的示例代码。

将 your_package_name 更改为 your.package.name。例如 com.example.myapp

Java 文件：

```
public void ratebutton(View v) {
        Intent intent = new Intent(Intent.ACTION_VIEW)
                .setData(Uri
                        .parse("https://play.google.com/store/apps/details?id=your_package_name"));
        startActivity(intent);
    } 
```

布局文件：

```
<Button
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:onClick="ratebutton"
        android:text="@string/rate"
        android:layout_gravity="center_horizontal" /> 
```

字符串.xml：

```
 <string name="rate">Rate with 5 stars please</string> 
```

# java - 如何在 for 循环中保存 jpa 对象

> ID：10623773
> 
> 赞同：1
> 
> 时间：2012-05-16T17:40:38.997
> 
> 标签：java, jpa, playframework

我有一个我想向其发送邀请电子邮件的用户列表，在我发送电子邮件后，我想将该人保存在一个单独的表中，这样万一服务器出现故障，我们就不会发送双重电子邮件，因为我们知道谁是我们发送电子邮件的最后一个人。这是代码：

```
@play.db.jpa.NoTransaction
public void sendInvite() {
    Long lastUser = (Long) User.find("select MAX(id) from User").fetch().get(0);
Long lastId = (Long) Contact.find("select MAX(id) from Contact").fetch().get(0);

    for (i=lastContacted; i < totalNumUsers; i++) {
        UserContact  contact = new UserContact();
        contact.firstName = user.firstName;
        contact.lastName = user.lastName;
        contact.email = user.email;
        if (validateEmail(user) == false) {
            continue;
        }
       sendInviteEmail(user);
       saveContact(contact); //THIS DOESN'T TAKE PLACE UNTIL END OF THE LOOP
       Thread.sleep(2000);
    }
} 
```

问题是保存的联系人直到 for 循环结束才保存在数据库中。我努力了：

```
contact.em().persist(contact);
contact.em().flush(); 
```

但这也不起作用
*我还想补充一点，该方法是从作业而不是从控制器运行的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:53:20.417

如果您在事务中执行所有这些操作，并且服务器出现故障，则不会提交事务，即使您在事务期间刷新，也不会将任何内容写入数据库。面对每个联系人，您需要打开一个新事务，将联系人保存在这个新事务中，然后提交事务。

# algorithm - 使用程序计数器（指令指针）值中的模式检测循环

> ID：10623777
> 
> 赞同：2
> 
> 时间：2012-05-16T17:40:54.637
> 
> 标签：algorithm, parsing, reverse-engineering

我有程序计数器在执行特定代码时采用的值序列。使用它，我想对生成这个可执行文件的原始代码进行一些静态分析（要清楚：原始代码不可用）——特别是那里有多少个循环，以及它们是如何嵌套的。举个例子，

```
A: for()
B:     if () 
C:         ...
D:     else
E:         ...
F:     for () {
G:         ...
H:         ...
I:     } 
```

在这种情况下，程序计数器序列可能是： ABCDF {GHIGHIGHI} ABDEF {GHIGHI} ABDEF {GHIGHIGHIGHI}

从上面的序列中，我怎么知道有两个循环，一个嵌套在另一个循环中？只是指向要使用的适当解析技术的指针也会有所帮助。

可以进行一些简化假设，例如原始代码中没有 goto 和编译器优化的循环展开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:44:36.470

1.  用程序计数器序列制作一个图形，其中每个程序计数器是一个顶点，序列中每对连续的程序计数器是有向边。（如果从一个顶点到另一个顶点有多条边，则只保留其中一条）。
2.  从序列中第一个程序计数器产生的顶点开始，执行深度优先搜索以找到循环。找到每个循环后，将此循环的最后一条边移到单独的列表中。
3.  在找到所有循环并将其移出图后，您就有了一个 DAG（有向无环图）。对此 DAG 执行拓扑排序以恢复程序中的正确语句序列，与源代码中的语句序列完全相同，除了 if/else 块（您无法从程序计数器序列中确定哪个是“if”，哪个是“else” ）。为了得到正确的结果，在拓扑排序没有规定任何特定顺序的情况下，应该使用深度优先搜索排序。为了正确放置 while/for 循环体，可以使用步骤 2 中的一些附加信息：循环检测算法可能会标记每个循环的第二个节点。
4.  要分析 if/else 块，请在图中创建单独的拆分/合并列表。
5.  将循环列表（在步骤 2 中提取）和 if/else 列表（在步骤 4 中提取）组合成一个间隔列表。使用这些间隔的关系（其中一个嵌套在另一个中）为所有 for/if/else 语句构造一棵树。
6.  在某些情况下，'while' 循环结束时的 'if' 块`while{...if{}}`可能会被错误地检测到，如 while{loop{}...}，'while' 和 'loop' 的起始地址相同。由于 'while' 的起始地址不能与任何嵌套循环的起始地址重合，因此可以很容易地将其后处理回`while{...if{}}`. （嵌套的 'do-while' 循环可能具有相同的起始地址，但它们与嵌套的 'if' 没有任何问题）。

* * *

这种方法仅适用于最简单的情况，即没有“goto”、“break”或任何其他跳出循环并且“for”循环仅检查单个条件时。

# spring-security - Spring Security Preauth“过滤器=无”不起作用

> ID：10623778
> 
> 赞同：2
> 
> 时间：2012-05-16T17:40:57.083
> 
> 标签：spring-security, siteminder, pre-authentication

奇怪的一个，

我正在使用带有 siteminder 的 spring security，它工作正常。但是我想要一个不受保护的 url - 我们的 loadBalancer 需要在应用程序本身内有一个“healthCheck” url。这个 url 没有被 siteminder 拦截，但是 spring security 似乎无论如何都对其应用了 preauth ..

如果我使用简单的基于表单的安全配置在本地运行它，则以下工作（不包括过滤器）：

```
<http auto-config="true" use-expressions="true">
    <intercept-url pattern="/html/healthCheck.html" filters="none" />   
    <intercept-url pattern="/css/**" filters="none" />
    <intercept-url pattern="/images/**" filters="none" />
    <intercept-url pattern="/js/**" filters="none" />
    <intercept-url pattern="/login" filters="none" />
    <intercept-url pattern="/favicon.ico" filters="none" />
    <intercept-url pattern="/*" access="hasAnyRole('ROLE_USER')" />
    <form-login login-page="/login" default-target-url="/" authentication-failure-url="/loginfailed" />
    <logout logout-success-url="/logout" />
</http> 
```

在这种情况下，我可以浏览到 localhost/myApp/resources/html/healthCheck.html 而不会遇到授权问题，但任何其他 url 都会显示登录表单。到目前为止一切都很好！

但是，当我部署到服务器时，我使用以下配置：

```
<http auto-config="true" use-expressions="true">
    <intercept-url pattern="/html/healthCheck.html" filters="none" />   
    <intercept-url pattern="/css/**" filters="none" />
    <intercept-url pattern="/images/**" filters="none" />
    <intercept-url pattern="/js/**" filters="none" />
    <intercept-url pattern="/login" filters="none" />
    <intercept-url pattern="/favicon.ico" filters="none" />
    <intercept-url pattern="/*" access="hasAnyRole('ROLE_USER')" />
    <custom-filter position="PRE_AUTH_FILTER" ref="siteminderFilter" />
</http> 
```

当我浏览到： server/myapp/resources/html/healthCheck.html 我收到以下错误：

```
java.lang.IllegalArgumentException: Cannot pass null or empty values to constructor
    org.springframework.security.core.userdetails.User.<init>(User.java:94)
    com.myApp.security.SecuritySBSUserDetailsService.loadUserByUsername(SecuritySBSUserDetailsService.java:119)
    org.springframework.security.core.userdetails.UserDetailsByNameServiceWrapper.loadUserDetails(UserDetailsByNameServiceWrapper.java:53) 
```

我认为这是由于 UserDetailsS​​ervice 在没有任何 SM_USER 的情况下被实例化引起的。然而 filters=none 已经到位..并且在使用表单身份验证时工作..知道是什么可能导致这种情况，或者更好的解决方法吗？

顺便说一下，我的 userdetails 服务配置如下：

```
<beans:bean id="siteminderFilter" class="org.springframework.security.web.authentication.preauth.RequestHeaderAuthenticationFilter">
    <beans:property name="principalRequestHeader" value="SM_USER" />
    <beans:property name="exceptionIfHeaderMissing" value="false" />
    <beans:property name="authenticationManager" ref="authenticationManager" />
</beans:bean> 
```

即我已将 exceptionIfHeaderMissing 设置为 false，如果这有帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T21:33:12.327

我能看到的最明显的事情是`/resources/html/healthCheck.html`不会被`/html/healthCheck.html`. 如果您在某处重写 URL，您可能应该对此进行解释。

如果您启用调试日志记录，它应该详细说明匹配的内容。

我也会省略`auto-config`. 它引起的混乱多于其价值。你应该使用`/**`而不是`/*`通用的蚂蚁模式匹配。

这里可能还值得一提的是，[Spring Security 3.1 有一种更好的方法](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#filter-chains-with-ns)`<http>`来定义空过滤器链，并且还允许您使用语法定义多个过滤器链。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:14:01.453

好的，据我所知，这似乎是弹簧安全性中的一个错误。我通过在 UserDetailsS​​ervice.. 中的 loadUserByName 方法的开头添加一个虚拟返回来解决它。

```
@Override
public UserDetails loadUserByUsername(String userName)
        throws UsernameNotFoundException, DataAccessException {
    logger.trace(">> loadUserByUsername()");
    logger.info("-- loadUserByUsername(): username : {}", userName);

    List<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();             
    if(userName==null || userName.trim().equals("")) {
        return(new User("ANONYMOUS", "", true, true, true, true, authorities));
        }
// rest of auth checks 
```

看起来就像我拥有的​​配置一样，根本不应该触发 UserDetails 检查（就像表单一样..）。如果有人有基于配置的解决方法，我会给你一个加分:-)

# uima - UIMA ConceptMapper 未在文档中找到字典术语

> ID：10623779
> 
> 赞同：0
> 
> 时间：2012-05-16T17:41:02.377
> 
> 标签：uima

我是 UIMA ConceptMapper 的新用户。在调试模式下运行，我可以看到字典加载了一些项目，但是 processTokenList() 的 dict.getEntries(word) 调用总是返回 null。欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T22:40:45.640

一些提示：

*   确保您的字典已加载一些项目
*   创建一个包含 2-3 个术语的较小字典来测试 2-3 个单词

# linux - how to count number of active users in kernel

> ID：10623781
> 
> 赞同：9
> 
> 时间：2012-05-16T17:41:08.690
> 
> 标签：linux, kernel, scheduler

We're using kernel version 2.4-20 and we need to count number of active users, in kernel mode. Objective is to change the scheduler, so we are in sched.c, modifying schedule() function.

What we do is to count the users in list_for_each macro.

```
list_for_each(tmp, &runqueue_head) {
    p = list_entry(tmp, struct task_struct, run_list);
    if (can_schedule(p, this_cpu)) {
        if (unique(p->uid)) add_new_user(p->uid);
        int weight = goodness(p, this_cpu, prev->active_mm);
        if (weight > c)
            c = weight, next = p;
    }
} 
```

which is basically adding unique users to a list. However, we get random results. Is there a concrete way to solve this problem?

Thank you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T18:33:57.207

You may want to try counting the users inside the for_each_task macro. This results in counting the users that have a task which is blocked due to I/O or any other reason. This should provide better results as you can't guarantee being able to count the users who run interactive processes if you use the run queue.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T19:18:44.180

Would this work? who | awk ' { print $1 }' | sort -ud

# ruby-on-rails - Ruby on Rails Webservice - 通过 ajax 请求访问

> ID：10623783
> 
> 赞同：3
> 
> 时间：2012-05-16T17:41:12.443
> 
> 标签：ruby-on-rails, ajax, json, cross-domain

我正在用 ruby​​ on rails 实现服务器。现在我想使用 ajax 请求（客户端在另一个域上，所以它是一个跨域调用）从这个服务器中获取一些数据，并以 JSON 形式接收数据。

我该怎么做才能让它工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:08:42.600

在客户端使用 jquery 发送 ajax 请求：

像这样形成你的参数：

```
var data = {
                    remote: true,
                    myplace:
                    {
                        swlat:lat(),
                        swlng:lng(),
                        nelat:lat(),
                        nelng:lng(),

                    }
                };
    $.getJSON('/location/getNewLocation',data, function(postsData) {
       parseReturnedJsonData(postsData);

   }); 
```

这将向 json 数据的 URL 发送 POST 请求。然后在服务器上，您可以读取参数，然后在`parseReturnedJsonData()`函数中使用 jQuery 渲染 json。从 jQuery 检查 getJson 和 parseJson 函数：http: [//api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:14:45.150

您需要`callback`作为查询参数传递：

```
 $.getJSON('http://some-service.com/some-resource?callback=?',data, function(postsData) {
    parseReturnedJsonData(postsData);
  }); 
```

此外，请确保您查询的 API 支持 JSONP。查看[http://eduvoyage.com/jsonp-explained.html](http://eduvoyage.com/jsonp-explained.html)以更好地了解 JSONP 的工作原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:59:18.533

查看`jsonp`导轨，但请确保您了解其[`jsonp`](http://en.wikipedia.org/wiki/JSONP)工作原理

[http://kevinchiu.org/archives/jsonp-in-rails-3](http://kevinchiu.org/archives/jsonp-in-rails-3)

# solr - 将 Lucene 查询表达到 Solr

> ID：10623785
> 
> 赞同：-1
> 
> 时间：2012-05-16T17:41:25.367
> 
> 标签：solr, lucene

我有以下 Lucene 查询，需要将其转换为 Solr (v 3.5) 查询：

```
final String[] terms = splitInputStringOnSpace(input);

for (final String string : terms) {
    booleanQuery.add(new TermQuery(new Term(DocumentFieldsConstants.HOLIDAY_FIELD, string)), Occur.MUST);
    booleanQuery.add(new TermQuery(new Term(DocumentFieldsConstants.HOLIDAY_FIELD, string)), Occur.MUST);
}

booleanQuery.add(new TermQuery(new Term(DocumentFieldsConstants.DESCRIPTION_FIELD, "1")), Occur.SHOULD);

final String[] exactTerms = splitInputStringOnSpace2(input);

for (final String string : exactTerms) 
{
    final WildcardQuery wildcardQuery = new WildcardQuery(new Term(DocumentFieldsConstants.DESCRIPTION_FIELD, string));
    booleanQuery.add(wildcardQuery, Occur.SHOULD);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:33:27.260

`splitInputStringOnSpace`在不知道和之间的区别的情况下，这有点难以做到`splitInputStringOnSpace2`。无论如何，对于第一部分，假设在 Solr 模式`HOLIDAY_FIELD`中命名`holiday`，等等。您应该能够使用 PHP 或任何您的前端语言来构造查询，如下所示：

对于`word`给定字符串中的每个，添加`+holiday:word`. （为什么这行代码在 Java 代码中出现两次？）然后添加`description:1`. 然后对于每个带有通配符 (`*`或的查询词`?`，也添加它 - 就像它一样，`description:word`.

确保用空格分隔所有这些，并将整个字符串放在`q=`Solr 查询的一部分中。

最后，为什么要做这一切？为什么不直接打印出最终的 Lucene 查询？由于查询语法非常相似，因此它很有可能在 Solr 中开箱即用。

# zend-framework - Zend Feed: How to get the whole feed from a website

> ID：10623786
> 
> 赞同：0
> 
> 时间：2012-05-16T17:41:25.933
> 
> 标签：zend-framework, feed, zend-feed

I'm using Zend Feed to get a feed from a website. When I run it I only get the 10 latest entries. Is there a way to get the whole feed from the website? All the post since the beginning?!

MY code is

```
$feed = new Zend_Feed_Atom('http://www.site.net/atom.xml');

echo 'The feed contains ' . $feed->count() . ' entries.' . "\n\n";
foreach ($feed as $entry) {
    echo 'Title: ' . $entry->title() . "\n <br/>";
    echo 'ID: ' . $entry->id() . "\n <br/>";
    echo 'Link: ' . $entry->link() . "\n <br/>";
    echo 'Subtitle: ' . $entry->subtitle() . "\n <br/>";
    echo 'Author: ' . $entry->author() . "\n <br/>";
    echo 'Content: ' . $entry->content() . "\n <br/>";
    echo 'Published: ' . $entry->published() . "\n <br/>";
    echo 'Summary: ' . $entry->summary() . "\n\n <br /><br /><br />";
} 
```

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T21:40:17.400

> It depends on whether or not that website actually has a feed that returns all items. Chances are there isn't and it sounds like by default it returns the 10 latest entries. There may be some parameters you can provide along with the feed that control how many items to return, but this is specific to that website and their feed. – drew010

*Marked as comunity wiki,because it's not my answer, but it should not stay only in comment*

# c++ - DirectX 11 帧缓冲区捕获（C++，无 Win32 或 D3DX）

> ID：10623787
> 
> 赞同：8
> 
> 时间：2012-05-16T17:41:26.650
> 
> 标签：c++, graphics, directx, directx-11

我想使用 DirectX 11 将我的前缓冲区或后缓冲区的内容捕获到一个字节数组中，然后我可以将其用作纹理或用作创建文件的源。到目前为止，我有一个交换链设置，发生了很多渲染以及以下代码 - 我确保在调用 Present 之后调用它们。

```
ID3D11Texture2D* pSurface;
HRESULT hr = m_swapChain->GetBuffer( 0, __uuidof( ID3D11Texture2D ), reinterpret_cast< void** >( &pSurface ) );
if( pSurface )
{
    const int width = static_cast<int>(m_window->Bounds.Width * m_dpi / 96.0f);
    const int height = static_cast<int>(m_window->Bounds.Height * m_dpi / 96.0f);
    unsigned int size = width * height;
    if( m_captureData )
    {
        freeFramebufferData( m_captureData );
    }
    m_captureData = new unsigned char[ width * height * 4 ];

    ID3D11Texture2D* pNewTexture = NULL;

    D3D11_TEXTURE2D_DESC description =
    {
        width, height, 1, 1, DXGI_FORMAT_R8G8B8A8_UNORM,
        { 1, 0 }, // DXGI_SAMPLE_DESC
        D3D11_USAGE_STAGING,
        0, D3D11_CPU_ACCESS_READ | D3D11_CPU_ACCESS_WRITE, 0
    };

    HRESULT hr = m_d3dDevice->CreateTexture2D( &description, NULL, &pNewTexture );
    if( pNewTexture )
    {
        m_d3dContext->CopyResource( pNewTexture, pSurface );
        D3D11_MAPPED_SUBRESOURCE resource;
        unsigned int subresource = D3D11CalcSubresource( 0, 0, 0 );
        HRESULT hr = m_d3dContext->Map( pNewTexture, subresource, D3D11_MAP_READ, 0, &resource );
        //resource.pData; // TEXTURE DATA IS HERE

        const int pitch = width << 2;
        const unsigned char* source = static_cast< const unsigned char* >( resource.pData );
        unsigned char* dest = m_captureData;
        for( int i = 0; i < height; ++i )
        {
            memcpy( dest, source, width * 4 );
            source += pitch;
            dest += pitch;
        }

        m_captureSize = size;
        m_captureWidth = width;
        m_captureHeight = height;

        return;
    }

    freeFramebufferData( m_captureData );
} 
```

它总是给我零阿尔法的黑色。

我通常可以选择 GDI 互操作来使用 BitBlt 从交换链中复制位图 - 但是我有限制，这意味着这不是一个有效的解决方案。

此外，包含一些功能的 D3DX 库也是不可能的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T18:08:56.263

所以。更多的实验揭示了“问题”。通过获取帧缓冲区纹理的描述并将其用作创建新纹理的基础，问题得到了解决......

```
ID3D11Texture2D* pSurface;
HRESULT hr = m_swapChain->GetBuffer( 0, __uuidof( ID3D11Texture2D ), reinterpret_cast< void** >( &pSurface ) );
if( pSurface )
{
    const int width = static_cast<int>(m_window->Bounds.Width * m_dpi / 96.0f);
    const int height = static_cast<int>(m_window->Bounds.Height * m_dpi / 96.0f);
    unsigned int size = width * height;
    if( m_captureData )
    {
        freeFramebufferData( m_captureData );
    }
    m_captureData = new unsigned char[ width * height * 4 ];

    ID3D11Texture2D* pNewTexture = NULL;

    D3D11_TEXTURE2D_DESC description;
    pSurface->GetDesc( &description );
    description.BindFlags = 0;
    description.CPUAccessFlags = D3D11_CPU_ACCESS_READ | D3D11_CPU_ACCESS_WRITE;
    description.Usage = D3D11_USAGE_STAGING;

    HRESULT hr = m_d3dDevice->CreateTexture2D( &description, NULL, &pNewTexture );
    if( pNewTexture )
    {
        m_d3dContext->CopyResource( pNewTexture, pSurface );
        D3D11_MAPPED_SUBRESOURCE resource;
        unsigned int subresource = D3D11CalcSubresource( 0, 0, 0 );
        HRESULT hr = m_d3dContext->Map( pNewTexture, subresource, D3D11_MAP_READ_WRITE, 0, &resource );
        //resource.pData; // TEXTURE DATA IS HERE

        const int pitch = width << 2;
        const unsigned char* source = static_cast< const unsigned char* >( resource.pData );
        unsigned char* dest = m_captureData;
        for( int i = 0; i < height; ++i )
        {
            memcpy( dest, source, width * 4 );
            source += pitch;
            dest += pitch;
        }

        m_captureSize = size;
        m_captureWidth = width;
        m_captureHeight = height;

        return;
    }

    freeFramebufferData( m_captureData );
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T10:36:27.590

使用 D3D11 可以轻松保存交换链缓冲区，如下所示。

> 1.  创建一个与您尝试保存的交换链的后台缓冲区相同的 Texture2D
> 2.  在设备上下文上调用 CopyResource 以从后台缓冲区复制到新创建的纹理
> 3.  使用文件名调用 D3DX11SaveTextureToFile(...)

人为的代码片段：

```
ID3D11Texture2D* pBuffer;

swapChain->GetBuffer(0, __uuidof(ID3D11Texture2D), (LPVOID*)&pBuffer);

if(texture_to_save == NULL)
{
    D3D11_TEXTURE2D_DESC td;
    pBuffer->GetDesc(&td);
    device->CreateTexture2D(&td, NULL, &texture_to_save);
}

deviceContext->CopyResource(texture_to_save, pBuffer);

D3DX11SaveTextureToFile(deviceContext,texture_to_save,D3DX11_IFF_PNG,filename); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-23T12:56:44.687

要复制正确的尺寸，请使用下面的代码。

```
ID3D11Texture2D* pSurface;
HRESULT hr = m_swapChain->GetBuffer( 0, __uuidof( ID3D11Texture2D ), reinterpret_cast< void** >( &pSurface ) );
if( pSurface )
{
    const int width = static_cast<int>(m_window->Bounds.Width * m_dpi / 96.0f);
    const int height = static_cast<int>(m_window->Bounds.Height * m_dpi / 96.0f);
    unsigned int size = width * height;
    if( m_captureData )
    {
        freeFramebufferData( m_captureData );
    }
    m_captureData = new unsigned char[ width * height * 4 ];

    ID3D11Texture2D* pNewTexture = NULL;

    D3D11_TEXTURE2D_DESC description;
    pSurface->GetDesc( &description );
    description.BindFlags = 0;
    description.CPUAccessFlags = D3D11_CPU_ACCESS_READ | D3D11_CPU_ACCESS_WRITE;
    description.Usage = D3D11_USAGE_STAGING;

    HRESULT hr = m_d3dDevice->CreateTexture2D( &description, NULL, &pNewTexture );
    if( pNewTexture )
    {
        m_d3dContext->CopyResource( pNewTexture, pSurface );
        D3D11_MAPPED_SUBRESOURCE resource;
        unsigned int subresource = D3D11CalcSubresource( 0, 0, 0 );
        HRESULT hr = m_d3dContext->Map( pNewTexture, subresource, D3D11_MAP_READ_WRITE, 0, &resource );
        //resource.pData; // TEXTURE DATA IS HERE

        const int pitch = width << 2;
        const unsigned char* source = static_cast< const unsigned char* >( resource.pData );
        unsigned char* dest = m_captureData;
        for( int i = 0; i < height; ++i )
        {
            memcpy( dest, source, width * 4 );
            source += resource.RowPitch; // <------
            dest += pitch;
        }

        m_captureSize = size;
        m_captureWidth = width;
        m_captureHeight = height;

        return;
    }

    freeFramebufferData( m_captureData );
} 
```

# php - file_get_contents() 遗漏了一些重要数据

> ID：10623791
> 
> 赞同：-1
> 
> 时间：2012-05-16T17:41:32.453
> 
> 标签：php, web-crawler

我正在尝试从此[页面](http://nutritiondata.self.com/facts/fruits-and-fruit-juices/1848/2)读取 html以稍后解析它。问题是当我使用时`file_get_contents($url)`，它错过了一些内容（我真正需要的内容）。例如，它没有得到“每 1 盎司的数量”（只是一个空白）之后的数据，以及“营养信息”表中的所有数据（只有数字，它确实得到了标签）。

这是脚本：

```
<?php
$url = "http://nutritiondata.self.com/facts/fruits-and-fruit-juices/1848/2";
$content = file_get_contents($url);
var_dump($content);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:49:19.210

您请求的 URL 实际上并不包含您要查找的数据。您在浏览器中看到的数据正在通过 javascript 放入页面中。

这是没有 javascript 的页面的样子：

![禁用 javascript 的页面](../Images/97fbf045cc521d3ac787076958c6ff5e.png)

您需要找到 javascript 正在使用的数据源（可能完全是其他一些 URL）并阅读它。

在这种情况下，数据*实际上*在您请求的页面中（只是不在您要查找的位置），在第 3400 行附近的一个大 JSON 对象中。寻找 `foodNutrients = {`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:49:51.860

看来，该页面确实部分是从 javascript 构建的。如果您访问该页面并让您显示 HTML 代码（不是通过 DOM 检查器或其他方式，而是页面的实际来源），您可以看到，您正在搜索的部分不可用。

页面中包含相当多的 javascript，您可能必须找出哪些 javascript 填充了页面以及它从哪里获取数据。

"file_get_contents" 不会帮助你，因为 javascript 部分永远不会被执行。

# c# - 自定义列表属性未从 MVC 视图更新

> ID：10623792
> 
> 赞同：0
> 
> 时间：2012-05-16T17:41:42.897
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, entity-framework

我将 EF 与 MVC3 一起使用。

我有一个带有自定义列表的模型：

```
public List<MarketingModel> Marketing { get; set; } 
```

我在构造函数中将其初始化为：

```
 this.Marketing = new List<MarketingModel>(); 
```

我在视图中查看它：

```
@foreach (MarketingModel m in Model.Marketing)
{

 <td class="title">@Html.DisplayFor(model => m.Name)</td>
 <td>@Html.CheckBoxFor(model => m.Mail)</td>
 <td>@Html.CheckBoxFor(model => m.Email)</td>

} 
```

填充得很好。但是，在保存页面时，无论出于何种原因，它都会将 Marketing 作为空值传递。

真的被这件事难住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:47:04.890

不要使用`foreach`循环。辅助方法使用表达式树，`XXXFor`旨在确定模型中属性的属性路径。此属性路径用于`name`在相应的 HTML 输入元素上构造属性。

由于您没有在 lambda 中使用模型（`model => m.Name`<- 请注意您没有使用`model`），因此属性路径不正确。相反，使用`for`循环：

```
@for (int i = 0; i < Model.Marketing.Count; i++) 
{
    <td class="title">@Html.DisplayFor(model => Model.Marketing[i].Name)</td>
    <td>@Html.CheckBoxFor(model => Model.Marketing[i].Mail)</td>
    <td>@Html.CheckBoxFor(model => Model.Marketing[i].Email)</td>
} 
```

这样，属性的整个路径都包含在表达式树 ( `Model.Marketing[i].Name`) 中，并且相应的`name`属性现在应该包含该完整路径。因此，保存后，数据现在应该在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:46:14.563

查看[Phil Haack 的 MVC binding to a list](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)。它包含您需要的所有信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:50:50.480

因为您有一个将新范围设置为 Model.Marketing 的 foreach，所以您的帖子混淆了 MVC 绑定。我会检查创建的 HTML 并注意那些有问题的字段的名称属性。该名称必须与其他模型属性的模式相同。

对于 List/Collection 对象，您可以使用数组类型的索引来指定特定项目。例如，如果您的字段要绑定到 Model.Marketing.Mail，则名称应该类似：“Marketing[2].Mail”。

每当您使用属性的属性更深入地研究模型时，您需要调整名称，如上所示，或创建一个新的 htmlhelper 扩展来处理您的对象，以便您可以使用类似 @Html.DisplayFor(m => m. Marketing），或者您也可以在控制器中编写自定义模型绑定器来为您修复此名称匹配，您还可以访问控制器上下文中的 Request 对象，这将使您能够挑选出已发布的表单元素。

如果您仍然需要帮助，请发布您生成的 html 片段。

# css - CSS：是否支持 Internet Explorer 的重复线性渐变？

> ID：10623794
> 
> 赞同：3
> 
> 时间：2012-05-16T17:41:53.643
> 
> 标签：css

我知道 IE 6-9（和 10...）支持线性渐变，但我的问题是它是否支持像 Firefox 一样的**重复线性渐变？**火狐示例：

```
 -moz-repeating-linear-gradient(left, #c5ccd4, #c5ccd4 0.31098em, #cbd2d8 0.31536em,  
    #cbd2d8 0.438em); 
```

对于以下 IE 线性渐变等效项，如果可能的话，我可以添加什么使其重复？IE：

```
 filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#c5ccd4',     
    endColorstr='#cbd2d8',GradientType=0 ); 
```

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:00:24.950

您可能需要小心实现重复的线性渐变，因为它们在各种浏览器中存在一些问题。请参阅 Eric Meyer 的文章：

[http://meyerweb.com/eric/css/tests/gradient-repeat.html](http://meyerweb.com/eric/css/tests/gradient-repeat.html)

# ant - Ant：从 **/* 文件集选择器获取文件目录

> ID：10623795
> 
> 赞同：0
> 
> 时间：2012-05-16T17:41:55.690
> 
> 标签：ant, html5boilerplate, build-tools

我正在尝试修复 HTML5 Boilerplate ant 任务中的错误。有一个“清单”目标来自动创建一个 html5 缓存清单文件。

[构建脚本](https://github.com/sengeezer/html5-boilerplate/blob/master/build/build.xml#L715)中的第 717 行是有错误的区域：

```
 <!-- add image files -->
            <echo message="Updating the site.manifest with the images"/>
            <for param="file">
                <path>
                    <fileset dir="./${dir.source}/${dir.images}/" includes="**/*"/>
                </path>
                <sequential>
                    <basename property="filename.@{file}" file="@{file}" />
                    <replaceregexp match="# image files" replace="# image files${line.separator}${dir.images}/${filename.@{file}}" file="${dir.intermediate}/${file.manifest}" />
                </sequential>
            </for> 
```

问题是，给定一个目录结构，如：

```
img/image1.jpg
img/subdir/image2.jpg 
```

输出忽略子目录：

```
img/image1.jpg
img/image2.jpg 
```

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T15:56:03.990

我想到了：

```
 <!-- add image files -->
            <echo message="Updating the site.manifest with the images"/>
            <for param="file">
                <path>
                    <fileset dir="./${dir.source}/${dir.images}/" includes="**/*"/>
                </path>

                <sequential>
                    <path id="fullPath.@{file}">
                        <pathelement location="@{file}" />
                    </path> 
                    <pathconvert property="relPath.@{file}" refid="fullPath.@{file}">
                        <globmapper from="${basedir}/*" to="*" />
                    </pathconvert>
                    <replaceregexp match="# image files" replace="# image files${line.separator}${relPath.@{file}}" file="${dir.intermediate}/${file.manifest}" />
                </sequential>
            </for> 
```

它获取元素的绝对路径，然后使用 globmapper 删除 ${basedir} 部分，留下图像的相对路径。

# javascript - 如何将 Node.js 流的内容读入字符串变量？

> ID：10623798
> 
> 赞同：182
> 
> 时间：2012-05-16T17:42:10.723
> 
> 标签：javascript, node.js, stream

我正在破解一个 Node 程序，该程序用于[`smtp-protocol`](https://www.npmjs.com/package/smtp-protocol)捕获 SMTP 电子邮件并处理邮件数据。该库将邮件数据作为流提供，我不知道如何将其转换为字符串。

我目前正在使用 将其写入标准输出`stream.pipe(process.stdout, { end: false })`，但正如我所说，我需要字符串中的流数据，一旦流结束，我就可以使用它。

如何将 Node.js 流中的所有数据收集到字符串中？

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2018-03-22T12:16:01.277

另一种方法是将流转换为承诺（请参阅下面的示例）并使用`then`（或`await`）将解析的值分配给变量。

```
function streamToString (stream) {
  const chunks = [];
  return new Promise((resolve, reject) => {
    stream.on('data', (chunk) => chunks.push(Buffer.from(chunk)));
    stream.on('error', (err) => reject(err));
    stream.on('end', () => resolve(Buffer.concat(chunks).toString('utf8')));
  })
}

const result = await streamToString(stream) 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2016-02-21T00:02:08.837

以上都不适合我。我需要使用 Buffer 对象：

```
 const chunks = [];

  readStream.on("data", function (chunk) {
    chunks.push(chunk);
  });

  // Send the buffer or you can put it into a var
  readStream.on("end", function () {
    res.send(Buffer.concat(chunks));
  }); 
```

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2014-09-27T15:08:22.453

希望这比上面的答案更有用：

```
var string = '';
stream.on('data',function(data){
  string += data.toString();
  console.log('stream data ' + part);
});

stream.on('end',function(){
  console.log('final output ' + string);
}); 
```

请注意，字符串连接不是收集字符串部分的最有效方法，但它用于简单（也许您的代码不关心效率）。

此外，此代码可能会为非 ASCII 文本产生不可预知的故障（它假定每个字符都适合一个字节），但也许您也不关心这一点。

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2012-05-16T17:51:46.567

（这个答案来自几年前，当时它是最好的答案。现在下面有一个更好的答案。我没有跟上node.js，我无法删除这个答案，因为它被标记为“在这个问题上是正确的” “。如果你想向下点击，你想让我做什么？）

关键是使用[Readable Stream](https://nodejs.org/api/stream.html#stream_readable_streams)[`data`](https://nodejs.org/api/stream.html#stream_event_data)的and[`end`](https://nodejs.org/api/stream.html#stream_event_end)事件。收听这些事件：

```
stream.on('data', (chunk) => { ... });
stream.on('end', () => { ... }); 
```

当您收到`data`事件时，将新的数据块添加到为收集数据而创建的 Buffer 中。

收到`end`事件后，如有必要，将完成的 Buffer 转换为字符串。然后用它做你需要做的事情。

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2020-08-11T15:34:52.500

你怎么看待这件事 ？

```
async function streamToString(stream) {
    // lets have a ReadableStream as a stream variable
    const chunks = [];

    for await (const chunk of stream) {
        chunks.push(Buffer.from(chunk));
    }

    return Buffer.concat(chunks).toString("utf-8");
} 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2015-09-14T12:59:04.027

我通常使用这个简单的函数将流转换为字符串：

```
function streamToString(stream, cb) {
  const chunks = [];
  stream.on('data', (chunk) => {
    chunks.push(chunk.toString());
  });
  stream.on('end', () => {
    cb(chunks.join(''));
  });
} 
```

使用示例：

```
let stream = fs.createReadStream('./myFile.foo');
streamToString(stream, (data) => {
  console.log(data);  // data is now my string variable
}); 
```

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2019-10-06T11:41:04.343

还有一个使用 Promise 的字符串：

```
function getStream(stream) {
  return new Promise(resolve => {
    const chunks = [];

    # Buffer.from is required if chunk is a String, see comments
    stream.on("data", chunk => chunks.push(Buffer.from(chunk)));
    stream.on("end", () => resolve(Buffer.concat(chunks).toString()));
  });
} 
```

用法：

```
const stream = fs.createReadStream(__filename);
getStream(stream).then(r=>console.log(r)); 
```

如果需要，删除`.toString()`以与二进制数据一起使用。

**更新**：@AndreiLED 正确指出这与字符串有关。我无法使用我拥有的节点版本获得返回字符串的流，但[api](https://nodejs.org/api/stream.html#stream_event_data)指出这是可能的。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2014-11-14T15:21:44.473

从 nodejs[文档](http://nodejs.org/api/stream.html#stream_readable_setencoding_encoding)中你应该这样做 - 永远记住一个字符串而不知道编码只是一堆字节：

```
var readable = getReadableStreamSomehow();
readable.setEncoding('utf8');
readable.on('data', function(chunk) {
  assert.equal(typeof chunk, 'string');
  console.log('got %d characters of string data', chunk.length);
}) 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-03-09T13:37:34.623

流没有简单的`.toString()`功能（我理解），也没有类似`.toStringAsync(cb)`功能（我不理解）的东西。

所以我创建了自己的辅助函数：

```
var streamToString = function(stream, callback) {
  var str = '';
  stream.on('data', function(chunk) {
    str += chunk;
  });
  stream.on('end', function() {
    callback(str);
  });
}

// how to use:
streamToString(myStream, function(myStr) {
  console.log(myStr);
}); 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-10-17T12:46:34.940

使用流行（每周超过 500 万次下载）和轻量级**的 get-stream**库的简单方法：

[https://www.npmjs.com/package/get-stream](https://www.npmjs.com/package/get-stream)

```
const fs = require('fs');
const getStream = require('get-stream');

(async () => {
    const stream = fs.createReadStream('unicorn.txt');
    console.log(await getStream(stream)); //output is string
})(); 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2018-05-07T14:59:25.003

我有更多的运气使用这样的：

```
let string = '';
readstream
    .on('data', (buf) => string += buf.toString())
    .on('end', () => console.log(string)); 
```

我使用节点`v9.11.1`，这是来自回调`readstream`的响应。`http.get`

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-03-18T19:26:47.473

最干净的解决方案可能是使用“string-stream”包，它将流转换为带有承诺的字符串。

```
const streamString = require('stream-string')

streamString(myStream).then(string_variable => {
    // myStream was converted to a string, and that string is stored in string_variable
    console.log(string_variable)

}).catch(err => {
     // myStream emitted an error event (err), so the promise from stream-string was rejected
    throw err
}) 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-04-12T15:43:38.357

像流减速器这样的东西呢？

这是一个使用 ES6 类的示例，如何使用一个。

```
var stream = require('stream')

class StreamReducer extends stream.Writable {
  constructor(chunkReducer, initialvalue, cb) {
    super();
    this.reducer = chunkReducer;
    this.accumulator = initialvalue;
    this.cb = cb;
  }
  _write(chunk, enc, next) {
    this.accumulator = this.reducer(this.accumulator, chunk);
    next();
  }
  end() {
    this.cb(null, this.accumulator)
  }
}

// just a test stream
class EmitterStream extends stream.Readable {
  constructor(chunks) {
    super();
    this.chunks = chunks;
  }
  _read() {
    this.chunks.forEach(function (chunk) { 
        this.push(chunk);
    }.bind(this));
    this.push(null);
  }
}

// just transform the strings into buffer as we would get from fs stream or http request stream
(new EmitterStream(
  ["hello ", "world !"]
  .map(function(str) {
     return Buffer.from(str, 'utf8');
  })
)).pipe(new StreamReducer(
  function (acc, v) {
    acc.push(v);
    return acc;
  },
  [],
  function(err, chunks) {
    console.log(Buffer.concat(chunks).toString('utf8'));
  })
); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-10-08T12:05:32.427

这对我有用，并且基于[Node v6.7.0 文档](https://nodejs.org/docs/latest/api/stream.html#stream_event_readable)：

```
let output = '';
stream.on('readable', function() {
    let read = stream.read();
    if (read !== null) {
        // New stream data is available
        output += read.toString();
    } else {
        // Stream is now finished when read is null.
        // You can callback here e.g.:
        callback(null, output);
    }
});

stream.on('error', function(err) {
  callback(err, null);
}) 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-12-10T09:56:57.520

# setEncoding('utf8');

上面的塞巴斯蒂安 J 做得好。

我有几行测试代码的“缓冲区问题”，并添加了编码信息并解决了它，见下文。

## 证明问题

软件

```
// process.stdin.setEncoding('utf8');
process.stdin.on('data', (data) => {
    console.log(typeof(data), data);
}); 
```

输入

```
hello world 
```

输出

```
object <Buffer 68 65 6c 6c 6f 20 77 6f 72 6c 64 0d 0a> 
```

## 演示解决方案

软件

```
process.stdin.setEncoding('utf8'); // <- Activate!
process.stdin.on('data', (data) => {
    console.log(typeof(data), data);
}); 
```

输入

```
hello world 
```

输出

```
string hello world 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-12-01T01:55:15.730

列出的所有答案似乎都以流动模式打开可读流，这不是 NodeJS 中的默认设置，并且可能存在限制，因为它缺乏 NodeJS 在暂停可读流模式下提供的背压支持。这是一个使用 Just Buffers、Native Stream 和 Native Stream Transforms 并支持对象模式的实现

```
import {Transform} from 'stream';

let buffer =null;    

function objectifyStream() {
    return new Transform({
        objectMode: true,
        transform: function(chunk, encoding, next) {

            if (!buffer) {
                buffer = Buffer.from([...chunk]);
            } else {
                buffer = Buffer.from([...buffer, ...chunk]);
            }
            next(null, buffer);
        }
    });
}

process.stdin.pipe(objectifyStream()).process.stdout 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-09-11T04:30:25.717

使用您可能已经在项目依赖项中拥有的[非常流行的`stream-buffers`包，这非常简单：](https://www.npmjs.com/package/stream-buffers)

```
// imports
const { WritableStreamBuffer } = require('stream-buffers');
const { promisify } = require('util');
const { createReadStream } = require('fs');
const pipeline = promisify(require('stream').pipeline);

// sample stream
let stream = createReadStream('/etc/hosts');

// pipeline the stream into a buffer, and print the contents when done
let buf = new WritableStreamBuffer();
pipeline(stream, buf).then(() => console.log(buf.getContents().toString())); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-10-31T11:33:57.040

就我而言，内容类型响应标头是**Content-Type: text/plain**。所以，我已经从 Buffer 中读取了数据，例如：

```
let data = [];
stream.on('data', (chunk) => {
 console.log(Buffer.from(chunk).toString())
 data.push(Buffer.from(chunk).toString())
}); 
```

# c - 哈德逊的 CUnit 失败表明成功

> ID：10623800
> 
> 赞同：4
> 
> 时间：2012-05-16T17:42:14.643
> 
> 标签：c, unit-testing, hudson, cunit

我在 hudson 上运行的 C 中进行了单元测试，但是当我有一个失败的测试时，它显示构建成功，但必须出现失败！

我正在使用 gcc 在 hudson 中编译和运行可执行文件，如下所示：

```
gcc -lcunit test_ctesting.c -o testing
./testing 
```

它在一个shell命令中，我怎样才能得到失败并显示它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T14:56:23.480

您可以按照 Bjerking 的建议告诉 CUnit 自动运行。

默认情况下，它会生成一个名为 CUnitAutomated-Results.xml 的 XML。

此 xml 必须转换为从 Jenkins 中的“发布 JUnit 测试结果报告”任务中读取。

脚步：

*   在您的测试程序（即 test.c）中调用

    CU_automated_run_tests();

*   使用如下命令从 Jenkins 创建并调用您的测试程序：

    。/测试

*   获取[CUnit 到 JUnit 的转换](http://www.van-porten.de/2011/09/cunit-to-junit-transform-now-on-bitbucket/)并将其放在您的构建机器上
*   使用 cunit-to-junit.xsl 将 CUnitAutomated-Results.xml 转换为 Test-Result.xml：

    xsltproc --novalid ../Build/cunit-to-junit.xsl CUnitAutomated-Results.xml > Test-Results.xml

*   添加“发布 JUnit 测试结果报告”任务并指向：

    测试结果.xml

现在，当您构建项目时，您会得到：

*   如果所有测试都是绿色的，则成功
*   如果您至少有一次失败，则不稳定
*   完整的测试结果趋势

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T09:17:01.650

您可以使用 CUnit XML 来报告您的测试结果。然后在 Jenkins 中使用“发布 JUnit 测试结果报告”来显示结果。

有关 XML 输出，请参阅 CUnit 自动化：http: [//cunit.sourceforge.net/doc/running_tests.html#automated](http://cunit.sourceforge.net/doc/running_tests.html#automated)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T02:07:45.120

我不确定这是否是您要查找的内容，但 CUnit 示例代码执行此操作：

```
 CU_basic_set_mode(CU_BRM_VERBOSE);
   CU_basic_run_tests();
   CU_cleanup_registry();
   return CU_get_error(); 
```

我不记得 CU_get_error() 现在返回的确切内容，但是如果您的测试失败，它不会返回非零值。如果你想弄清楚这一点，你需要返回失败的测试数：

```
 unsigned int num_failures;
   CU_basic_set_mode(CU_BRM_VERBOSE);
   CU_basic_run_tests();
   num_failures = CU_get_number_of_failures();
   CU_cleanup_registry();
   return num_failures; 
```

我不确定 Hudson/Jenkins 如何处理这个问题，但非零返回值将使 CMake/CTest 不报告通过的测试。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-16T18:51:44.833

退出代码存储在变量`$?`中，我假设如果测试失败，它被设置为非零值。

......无论如何，如果它是unixy的东西。

# javascript - turn.js 在 iPad 上滑动和捏合

> ID：10623802
> 
> 赞同：2
> 
> 时间：2012-05-16T17:42:36.767
> 
> 标签：javascript, ipad, gestures

我想使用 turn.js 创建在线目录，专门用于 ipad。我想保持缩放的能力（我将用户可缩放属性保留为默认值）。滑动手势翻页也很有用，例如在[http://www.turnjs.com/](http://www.turnjs.com/)上，但是当您尝试缩放时，即使在官方网站上，页面也会在捏合手势后翻页。

我想它的发生是因为捏合手势的开始与滑动一样 - 我的意思是一根手指滑动。只有当 touchmove 事件仅由一根手指（e.originalEvent.touches.length == 1）进行时才有翻页的条件，但我猜在滑动（一根手指）变成捏合（两根手指触摸屏幕）之前浏览器首先看到事件滑动，下一个事件分别捏。当有人将手指从屏幕上移开时也是如此（它永远不会在完全相同的时间发生）。

我尝试将 e.originalEvent.touches 更改为 e.originalEvent.changedTouches 以获取事件中使用的手指数，但它也无法像我想要的那样工作。

任何简单的想法如何解决它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-23T09:12:18.550

[jGestures](https://jgestures.codeplex.com/)可以添加多点触控手势。

有关使用 turn.js 的更多信息：[GitHub-Issue](https://github.com/blasten/turn.js/issues/85#issuecomment-27269292)

# java - 如何在包上使用 NonNullByDefault

> ID：10623805
> 
> 赞同：15
> 
> 时间：2012-05-16T17:42:46.630
> 
> 标签：java, eclipse, compiler-warnings

我的编译器警告我关于`A default nullness annotation has not been specified for the package`. 我正在使用带有 Java 7 的 Juno。

您应该`@NonNullByDefault`作为包选项添加的文档统计信息，但我不知道这意味着什么。

我可以以某种方式设置`NonNullByDefault`整个包裹吗？在 Eclipse 中，我无法右键单击一个包并说出`add option`或类似的内容。

还是我只是添加`@NonNullByDefault`到包中的任何类，然后它对该包中的所有 bean 都有效？还是我必须在包中创建一些元信息文件来添加包选项？我一定是瞎了眼，因为我在网上找不到任何帮助......

一个小例子会很棒。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-06-14T21:29:23.387

**总结：**
让上述建议发挥作用对我来说并不直观。我刚刚想出的实际解决方案也不是。在 package-info.java 文件中
：**将注释放在包声明之上**
b. **将 NonNullByDefault 注释导入包声明之后**

* * *

**详细信息：**
我不知道我是否是唯一一个阅读上述答案并且无法弄清楚如何使其工作的人。因此，为了更加清楚，这是我为使其最终在 Eclipse-Juno 中工作而采取的（不明显也不直观的）步骤：

1.  在包资源管理器中，转到显示警告（或错误）消息的根 Java 包，该消息以“**尚未为包指定默认空值注释...** ” - 对于此示例，请假设包名称为“org.public_domain "
2.  在 Java 包上，激活右键菜单并选择“**新建 -> 包**”选项 - 是的，我知道你的包已经存在，认为它是 Eclipse 特性 - 它不会对你现有的包做任何事情
3.  当“ **New Java Package** ”对话框出现时，选中“ **Create package-info.java** ”复选框并点击“Finish”
4.  您的 Java 编辑器现在将显示一个名为“ **package-info.java** ”的新文件，其中包含以下内容：

    ```
    /**
     * 
     */
    /**
     * @author xyz
     *
     */  
    package org.public_domain; 
    ```

5.  现在，重新排列文件内容，如下所示：

    ```
    /**
     * 
     */
    /**
     * @author xyz
     *
     */  
    @NonNullByDefault  
    package org.public_domain;  
    import org.eclipse.jdt.annotation.NonNullByDefault; 
    ```

    ……或者像这样……

    ```
    /**
     * 
     */
    /**
     * @author xyz
     *
     */  
    @org.eclipse.jdt.annotation.NonNullByDefault
    package org.public_domain; 
    ```

6.  享受 eclipse @NonNullByDefault 的美妙之处

我的挑战是弄清楚我要将**注释放在包声明之上**。并将**NonNullByDefault 注释导入包声明之后**。对我来说，这并不直观。

希望这可以节省其他人的时间，因为我已经结束了追逐这条特殊的道路。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-28T20:00:19.167

如果您只是想摆脱警告并忽略此功能，因为您没有使用它，您可以简单地在 Eclipse 首选项中禁用它：

**Window > Preferences > Java > Compiler > Errors/Warnings > Null analysis > Missing '@NonNullByDefault' annotation on package *= [Ignore]***

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-16T18:31:49.890

请参阅[源代码](http://dev.eclipse.org/svnroot/tools/org.eclipse.objectteams/trunk/contrib/jdt-null-annotations/src/org/eclipse/jdt/annotation/NonNullByDefault.java)或 JavaDocs：

```
Note that for applying an annotation to a package a file by the name
package-info.java is used. 
```

和：

```
@Target({PACKAGE,TYPE,METHOD,CONSTRUCTOR}) 
```

# javascript - 获取元素的边界框以考虑其变换

> ID：10623809
> 
> 赞同：34
> 
> 时间：2012-05-16T17:42:48.663
> 
> 标签：javascript, svg

鉴于此 SVG：

```
<svg xmlns="http://www.w3.org/2000/svg">
  <rect width="50" height="50"
        transform="translate(75,75) rotate(45) translate(-25,-25)" />
  <script>
    var bb = document.querySelector('rect').getBBox();
    console.log([bb.x,bb,y,bb.width,bb.height]);
  </script>
</svg>​ 
```

结果输出是`[0, 0, 50, 50]`。
想要的结果是`[39.645,39.645,70.711,70.711]`。

## 视觉版：http: [//jsfiddle.net/2wpju/7/](http://jsfiddle.net/2wpju/7/)

计算元素相对于其父元素的边界框的最简单、最有效的方法是什么？

* * *

以下是我迄今为止提出的最佳答案，但有两个问题：

1.  似乎需要做很多工作才能更好地处理，并且
2.  正如在**[这个演示](http://jsfiddle.net/2wpju/4/)**中看到的，它不一定是最小边界框（注意上面的圆圈），因为旋转的轴对齐边界框的轴对齐边界框总是会增加大小。

```
// Calculate the bounding box of an element with respect to its parent element
function transformedBoundingBox(el){
  var bb  = el.getBBox(),
      svg = el.ownerSVGElement,
      m   = el.getTransformToElement(el.parentNode);

  // Create an array of all four points for the original bounding box
  var pts = [
    svg.createSVGPoint(), svg.createSVGPoint(),
    svg.createSVGPoint(), svg.createSVGPoint()
  ];
  pts[0].x=bb.x;          pts[0].y=bb.y;
  pts[1].x=bb.x+bb.width; pts[1].y=bb.y;
  pts[2].x=bb.x+bb.width; pts[2].y=bb.y+bb.height;
  pts[3].x=bb.x;          pts[3].y=bb.y+bb.height;

  // Transform each into the space of the parent,
  // and calculate the min/max points from that.    
  var xMin=Infinity,xMax=-Infinity,yMin=Infinity,yMax=-Infinity;
  pts.forEach(function(pt){
    pt = pt.matrixTransform(m);
    xMin = Math.min(xMin,pt.x);
    xMax = Math.max(xMax,pt.x);
    yMin = Math.min(yMin,pt.y);
    yMax = Math.max(yMax,pt.y);
  });

  // Update the bounding box with the new values
  bb.x = xMin; bb.width  = xMax-xMin;
  bb.y = yMin; bb.height = yMax-yMin;
  return bb;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-31T13:09:42.497

您只需要使用这个简单的 Javascript 函数：

```
object.getBoundingClientRect(); 
```

它支持：

```
Chrome  Firefox (Gecko)   Internet Explorer Opera   Safari
1.0           3.0 (1.9)   4.0               (Yes)   4.0 
```

在这里查看更多关于它的信息。[关联](https://developer.mozilla.org/en-US/docs/Web/API/Element.getBoundingClientRect)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-02T19:51:48.817

这似乎是当前方法，除非/直到 getBBox() 将对象上的变换视为直接定义边界框，即使[SVG 1.1 SE 定义](http://www.w3.org/TR/SVG/types.html#__svg__SVGLocatable__getBBox)：

SVGRect getBBox() 返回当前用户空间中所有包含的图形元素几何上的紧密边界框（即，**在应用“变换”属性后，如果有的话），不包括描边、剪切、遮罩和过滤效果）。**请注意，getBBox 必须在调用该方法时返回实际的边界框，即使元素尚未被渲染也是如此。

我想这都是关于你如何定义“*当前用户空间*”的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T20:15:10.307

一种方法是制作一个拉斐尔集并获得它的bb。或者将所有元素包装在 g 中并获得 g 的 bb，我认为 g 应该是最快的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-03T17:18:09.583

这是一个解释旋转椭圆的答案。转换方法适用于矩形，但椭圆返回一个比对象旋转时大得多的边界框。

使用内置 JavaScript 函数的更简单的答案对我来说不是很有用，因为它仍然必须被转换回绘图空间。

此代码不处理椭圆的倾斜或缩放（但对于任何其他对象），但在我的程序中[http://nwlink.com/~geoffrey/svgBuild](http://nwlink.com/~geoffrey/svgBuild)我打算通过绘制一个全新的椭圆来处理倾斜和缩放应用了倾斜或比例。

椭圆的公式来自这里：[How do you calculate the axis-aligned bounding box of an ellipse？](https://stackoverflow.com/questions/87734/how-do-you-calculate-the-axis-aligned-bounding-box-of-an-ellipse)非常感谢那里的帮助。

el 是 d3.js 元素，而不是节点。

```
function toNumberIfNumeric(x) {
    var result = parseFloat(x);
    return isNaN(result) ? x : result;
}

function getAttrs(el, attributes) {
    var result = {};
    attributes.forEach(function (attr) {
        result[attr] = toNumberIfNumeric(el.attr(attr));
    });
    return result;
}    

function getTransformedBbox(el, referenceNode) {

    var node = el.node();

    switch (node.nodeName) {
        case "ellipse":

            var rotate = getTransform(el, "rotate");
            if (rotate.angle === 0) {
                return node.getBBox();
            }
            var attr = getAttrs(el, ["cx", "cy", "rx", "ry"]);
            var radians = rotate.angle / 180 * Math.PI;
            var radians90 = radians + Math.PI / 2;

            var ux = attr.rx * Math.cos(radians);
            var uy = attr.rx * Math.sin(radians);
            var vx = attr.ry * Math.cos(radians90);
            var vy = attr.ry * Math.sin(radians90);

            var halfWidth = Math.sqrt(ux * ux + vx * vx);
            var halfHeight = Math.sqrt(uy * uy + vy * vy);

            return {
                x: attr.cx - halfWidth,
                y: attr.cy - halfHeight,
                width: 2 * halfWidth,
                height: 2 * halfHeight
            };

        default:
            var bb = node.getBBox(),
                svg = node.ownerSVGElement,
                m = node.getTransformToElement(referenceNode);

            // Create an array of all four points for the original bounding box
            var pts = [
                svg.createSVGPoint(), svg.createSVGPoint(),
                svg.createSVGPoint(), svg.createSVGPoint()
            ];
            pts[0].x = bb.x;
            pts[0].y = bb.y;
            pts[1].x = bb.x + bb.width;
            pts[1].y = bb.y;
            pts[2].x = bb.x + bb.width;
            pts[2].y = bb.y + bb.height;
            pts[3].x = bb.x;
            pts[3].y = bb.y + bb.height;

            // Transform each into the space of the parent,
            // and calculate the min/max points from that.    
            var xMin = Infinity, xMax = -Infinity, yMin = Infinity, yMax = -Infinity;
            pts.forEach(function (pt) {
                pt = pt.matrixTransform(m);
                xMin = Math.min(xMin, pt.x);
                xMax = Math.max(xMax, pt.x);
                yMin = Math.min(yMin, pt.y);
                yMax = Math.max(yMax, pt.y);
            });

            // Update the bounding box with the new values
            bb.x = xMin;
            bb.width = xMax - xMin;
            bb.y = yMin;
            bb.height = yMax - yMin;
            return bb;
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-12-12T01:05:07.927

如果您不想处理数学问题，一个好的解决方法是将 SVG 元素包装在一个`<g>`组中，然后调用`getBBox()`新组。

这是它的伪代码

```
 function getBBoxTakingTransformIntoAccount(element) {
        let group = wrapInGroup(element)
        let bBox = group.getBBox()
        unwrapChild(group) // Optionally, you can unwrap the child node
        return bBox
    }

function wrapInGroup(element) {
        let group = document.createElementNS("http://www.w3.org/2000/svg", "g")
        element.parentNode.appendChild(group)
        group.appendChild(element)
        return group
    }

function unwrapChild(element) {
        let child = element.children[0]
        element.parentNode.appendChild(child)
        element.remove()
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-11-19T10:31:42.093

死灵术。

您需要的边界框坐标始终与您要在其中使用坐标的元素的变换相关。

例如，您在 a 中有一条路径

```
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 577">
  <g id="test">
    <path id="e123" d="m906.76 442.4h51.77v39.59h-51.77z" fill="#B3B3B3" fill-rule="evenodd" transform="matrix(1,0,0,0.999749,0,-75.2041)"/>
  </g>
</svg> 
```

现在您要添加另一个组

```
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2000 577">
  <g id="test">
    <path id="e123" d="m906.76 442.4h51.77v39.59h-51.77z" fill="#B3B3B3" fill-rule="evenodd" transform="matrix(1,0,0,0.999749,0,-75.2041)"/>
  </g>

  <g id="e456" data-group-id="AP">
    <rect class="BG" fill="yellow" x="906.760009765625" y="390.5399169921875" width="15.96875" height="16.125"/>
    <text id="foobar" fill="#000" font-size="1.5mm" data-lines-count="4" x="906.760009765625" y="390.5399169921875">
      <tspan x="906.760009765625" dy="1.2em">.</tspan>
      <tspan x="906.760009765625" dy="1.2em">ABC123</tspan>
      <tspan x="906.760009765625" dy="1.2em">Test</tspan>
      <tspan x="906.760009765625" dy="1.2em">123</tspan>
    </text>
  </g>

</svg> 
```

现在您想将新组中的文本元素坐标和矩形坐标放入 id 为“e123”（矩形）的元素的边界框。

所以你拿

```
document.getElementById("e123").getBBox(); 
```

这个边界框考虑了你在 e123 中的变换，**也就是在应用 'transform' 属性之后**。如果你把这些坐标放在 e123 之外（想象 e123 是一个组而不是一个路径），那么坐标将被那个变换关闭。

因此，您需要获取相关元素的边界框（fromSpace），并将它们转换为适合您的目标元素的坐标，例如“e456”。

您获取 fromSpace 边界框的坐标，创建两个点（左上角，右下角），将它们转换为目标空间，然后从这两个点计算新的边界框（**注意它没有当您将 x2 设置为 bbox.width 并将 y2 设置为 bbox.height 时不起作用 - 您需要另一个点，然后在将矩阵应用于每个点后重新计算宽度和高度**）。

在代码中：

```
if (!SVGElement.prototype.getTransformToElement)
{
    SVGElement.prototype.getTransformToElement = function (elem)
    {
        return elem.getScreenCTM().inverse().multiply(this.getScreenCTM());
    };
}

function boundingBoxRelativeToElement(fromSpace, toSpace, bbox)
{
  bbox = bbox || fromSpace.getBBox();

  // var m = fromSpace.transform.baseVal[0].matrix;
  var m = fromSpace.getTransformToElement(toSpace);

  var bbC = document.documentElement.createSVGPoint(); bbC.x = bbox.x; bbC.y = bbox.y;
  var bbD = document.documentElement.createSVGPoint(); bbD.x = bbox.x + bbox.width; bbD.y = bbox.y + bbox.height;
  // console.log("bbC", bbC, "bbD", bbD);
  bbC = bbC.matrixTransform(m);
  bbD = bbD.matrixTransform(m);

  var bb = { x: bbC.x, y: bbC.y, width: Math.abs(bbD.x - bbC.x), height: Math.abs(bbD.y - bbC.y)};
  console.log("bb", bb);
  return bb;
} 
```

所以你像这样使用它：

```
var elFrom = document.getElementById("e123");
var elTo = document.getElementById("e456");
var bbox = boundingBoxRelativeToElement(elFrom, elTo); 
```

如果你只想要 parentElement 坐标中的 boundingBox，这将是：

```
var elFrom = document.getElementById("e123");
var elTo = elFrom.parentElement;
var bbox = boundingBoxRelativeToElement(elFrom, elTo); 
```

又名

```
var elFrom = document.getElementById("e123");
var bbox = boundingBoxRelativeToElement(elFrom, elFrom.parentElement); 
```

或作为辅助功能

```
function boundingBoxRelativeToParent(el)
{
    var bbox = boundingBoxRelativeToElement(el, el.parentElement);
    return bbox;
} 
```

然后很容易使用：

```
var bbox = boundingBoxRelativeToParent(document.getElementById("e123")); 
```

（请注意，这假定 parentElement 不为空）

# php - 使用 PHP Twitter 库发送推文时遇到问题

> ID：10623810
> 
> 赞同：0
> 
> 时间：2012-05-16T17:42:51.150
> 
> 标签：php, twitter, twitter-oauth

作为序言，我对 PHP 了解不多。但是，我不确定这是一个 PHP 问题，但可能更多的是我理解用于连接到 Twitter 的库的问题。

我按照这里的教程[http://140dev.com/twitter-api-programming-tutorials/hello-twitter-oauth-php/](http://140dev.com/twitter-api-programming-tutorials/hello-twitter-oauth-php/)使用了 Matt Harris 的 twitter 库。除了从 twitter 获得的密钥外，我没有更改任何内容。

当我运行以下代码时，我收到未经授权的错误代码 401：

```
 $tweet_text = 'Hello Twitter';
  print "Posting...\n";
  $result = post_tweet($tweet_text);
  print "Response code: " . $result . "\n";

 function post_tweet($tweet_text) {

 require_once('tmhoauth/tmhOAuth.php');

 $connection = new tmhOAuth(array(
'consumer_key' => '******',
'consumer_secret' => '******',
'user_token' => '******',
'user_secret' => '******',
)); 

// Make the API call
$connection->request('POST', 
$connection->url('1/statuses/update'), 
array('status' => $tweet_text));

return $connection->response['code'];
 }
?> 
```

正如我之前所说，我使用的是 twitter 提供的密钥。

有人可以帮助我尝试使用上述库来测试[https://api.twitter.com/1/account/verify_credentials.json](https://api.twitter.com/1/account/verify_credentials.json)上的 twitter 凭据验证器吗？

我还尝试将以下示例与此 SO 帖子[Using basic oauth to send a tweet](https://stackoverflow.com/questions/3633305/using-basic-oauth-to-send-a-tweet)中的 TwitterOAuth 库一起使用：

```
<?php
require_once('twitteroauth.php');
$connection = new TwitterOAuth('app consumer key', 'app consumer secret', 'my access     token', 'my access token secret');
$connection->post('statuses/update', array('status' => 'text to be tweeted')); 
```

它也不起作用。但它确实将页面转发到作者的 github 页面！？！？

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T19:29:48.407

如果您确定密钥是正确的，我建议您检查 twitter 中的应用程序设置，以确保启用了写入模式。

在应用程序设置下确保应用程序类型访问设置为

> 读取、写入和访问直接消息

*（或至少读/写）*

然后也许尝试再次生成访问令牌？

# iphone - 我们如何创建一个干净的 iOS 项目（没有 Interface Builder 文件）？

> ID：10623812
> 
> 赞同：0
> 
> 时间：2012-05-16T17:42:54.103
> 
> 标签：iphone, ios, xcode

一本书描述了没有任何 Interface Builder 文件的项目的以下步骤：

1.  创建单视图应用程序后，删除`.xib`文件
2.  找到该 `ProjectName-Info.plist`文件并删除该`Main nib file base name`属性。（选择它并按删除）
3.  查找`main.m`并更改`UIApplicationMain`to的最后一个参数`@"ProjectNameAppDelegate"`
4.  删除`@property`一行 in`ProjectNameAppDelegate.h`和`@synthesize`in`ProjectNameAppDelegate.m`

我在上面找不到该属性的 (2)，并且由于我使用的是 Xcode 4.3.2，因此它`ProjectNameAppDelegate.h`已经变成`AppDelegate.h`（`.m`以及）...我还在那里看到 a`window`和`viewController`属性...并且看起来不像它们需要像第 4 步一样被删除。如果是 Xcode 4.3.2（或更高版本？）怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:49:49.007

如果你想创建一个全新的项目，Xcode 提供了一个名为*Empty Application*的模板。

标准模板不再包含主窗口 nib，因此不需要更改 #2。但是，您应该确保在创建项目时不启用情节提要。

是的，应用程序委托现在刚刚被调用`AppDelegate`。这只是一个名字。没关系。

**编辑：**

从空的应用程序模板创建带有视图控制器的 iPhone 应用程序的步骤：

1.  *使用Empty Application*模板创建一个新项目。
2.  创建一个新文件，选择*Objective-C 类*模板。使其成为`UIViewController`.
3.  更改`AppDelegate.h`以导入您的视图控制器标头。
4.  为您的应用程序委托创建一个实例变量来保存您的视图控制器。
5.  更改`application:didFinishLaunchingWithOptions:`以实例化您的视图控制器，将其分配给实例变量，并将其视图作为子视图添加到窗口。

# database - 从 Java 中的数据库表生成 XML 模式

> ID：10623816
> 
> 赞同：2
> 
> 时间：2012-05-16T17:43:03.503
> 
> 标签：database, xsd

我是新来的，听说我可以在这里找到好的答案，所以我注册了，现在我写下我的问题。您对 java 类库或任何可以从数据库中的表（如 java 中的 sql server）生成 XML SCHEMA 有任何想法吗？我是java新手，所以如果可能的话，我需要一些基本的指导方针。问候，雪利酒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:49:36.007

表是关系的；XML 是分层的。这不是一项微不足道的任务。

XML 需要一个根。你的会是什么？

您需要提取表定义。我猜想表/实体将是父标签，列将是子标签，值作为子数据。您必须从外键关系中弄清楚如何嵌套父母。如果有多对多的 JOIN 表，您必须决定哪个是主表，哪个是从表。你必须打破循环关系。

您必须对 .xsd 中的类型做出决定。

您可以使用像 Hibernate 这样的 ORM 工具将关系表映射到 Java 对象。您可以使用 JAX-B 将 Java 对象映射到 XML 并返回。传递性会告诉您与 XML 的关系是可能的，但我不知道两者之间的简单直接路径。

# javascript - div高度帮助，子元素位置绝对

> ID：10623819
> 
> 赞同：1
> 
> 时间：2012-05-16T17:43:15.400
> 
> 标签：javascript, html, css

如何在不将 divParents 高度设置为 xxx px 的情况下使 div 的高度为 100%，其中的控件具有绝对位置？我试图将 divParent 中的所有内容包装在另一个 div 中，我得到了相同的结果。

例子。

```
 <div style="border: solid 1px black; position: relative;" id="divParent">

    <span style="position: absolute; top: 177px; left: 41px">Name</span>
    <input type="text" style="position: absolute; top: 253px; left: 36px; height: 18px;
    width: 342px;" />
    <span style="position: absolute; top: 229px; left: 38px">Address</span>
    <input type="text" style="position: absolute; top: 199px; left: 39px; height: 18px;
    width: 342px;"/>

    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:49:46.597

绝对定位的项目不再是布局的一部分。父母不知道它们有多大，也不知道它们在哪里，所以它不能自动调整自己的大小以适应它们。

您可以编写自己的 JavaScript 来计算所有这些，但仅靠 CSS 无法满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:18:42.393

我真的不明白你想做什么，但它看起来像你输出某种 html 表单。无论如何，您也只能在您的母亲 div 内部使用and `margin-top`（您可以随意定位，相对或绝对）......`margin-left``float-left`

# vb.net - VB.NET DragAndDrop 不适用于控件

> ID：10623822
> 
> 赞同：2
> 
> 时间：2012-05-16T17:43:23.027
> 
> 标签：vb.net, drag-and-drop

我正在尝试制作一个使用拖放功能的程序，但是，它仅在我将某些内容拖放到表单而不是控件时才有效。如果我尝试使用控件，我只会得到“不可用”光标。

AllowDrop 属性是在属性栏中设置的，我也是在表单加载时设置的。我不知道为什么我仍然不能放下东西；以前有人遇到过这个问题吗？

当前代码：

```
Public Class Main

Private Sub Main_DragDrop(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles Me.DragDrop
    If e.Data.GetDataPresent("FileDrop", True) = True Then

        Dim Files() As String
        Dim i As Integer

        Files = e.Data.GetData(DataFormats.FileDrop)

        For i = 0 To Files.Length - 1
            FileList.Items.Add(Files(i))
        Next

    End If
End Sub

Private Sub Main_DragEnter(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles Me.DragEnter
    If e.Data.GetDataPresent(DataFormats.FileDrop) Then
        e.Effect = DragDropEffects.All
    End If
End Sub

Private Sub Main_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles     Me.Load
    Me.AllowDrop = True
    FilePath.AllowDrop = True
    FileList.AllowDrop = True
End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-02-07T09:51:34.853

我知道这是一个旧线程，但我会发布我发现的内容，以防其他人像我过去 2 小时一直在做的那样把头发拉出来。

> 如果 VS 在 Administrator mode 下启动，则将文件拖放到表单（或表单的组件）**上不起作用**。

呜呜呜……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-16T20:24:45.393

您必须为相应事件中的每个控件指定 DragDrop-Effect。因此，除了设置`AllowDrop`为之外`True`，您还必须添加一个事件处理程序。例如像这样：

```
Private Sub Main_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles     Me.Load 
    Me.AllowDrop = True 
    FilePath.AllowDrop = True 
    AddHandler FilePath.DragEnter, AddressOf Main_DragEnter
    FileList.AllowDrop = True 
    AddHandler FileList.DragEnter, AddressOf Main_DragEnter
End Sub 
```

也许您应该选择一个更适合 Main_DragEnter 方法的名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-17T13:27:05.980

改变

```
Private Sub Main_DragEnter(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles Me.DragEnter
    If e.Data.GetDataPresent(DataFormats.FileDrop) Then
        e.Effect = DragDropEffects.All
    End If
End Sub 
```

至

```
Private Sub Main_DragEnter(ByVal sender As Object, ByVal e As System.Windows.Forms.DragEventArgs) Handles FilePath.DragEnter, FileList.DragEnter
    If e.Data.GetDataPresent(DataFormats.FileDrop) Then
        e.Effect = DragDropEffects.All
    End If
End Sub 
```

您应该为两个控件而不是表单本身处理 DragEnter 事件。

# .htaccess - .htaccess 重写规则 /directory/ 到 php 文件？

> ID：10623829
> 
> 赞同：2
> 
> 时间：2012-05-16T17:43:42.997
> 
> 标签：.htaccess

我想转：

```
/1/2 
```

进入：

```
/negocio/2.php?shopURL=1 
```

我不太了解 htaccess，而且我的规则不起作用。这是我尝试过的：

```
RewriteRule ^([^/]+)(/.+)? /negocio$2.php/?shopURL=$1 [L,QSA] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T20:33:18.637

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule ^ - [L]

RewriteRule ^([^/]+)(/.+?)/?$ negocio$2.php?shopURL=$1 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:55:36.790

试试这个：

重写引擎开启

RewriteBase /

RewriteRule ^1/2/(.*) [http://www.example.com/negocio/2.php?shopURL=1](http://www.example.com/negocio/2.php?shopURL=1) [L,QSA]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:07:19.273

在 .htaccess 中试试这个

```
重写引擎开启

RewriteBase /

RewriteCond $1 !^(negocio)
RewriteRule ^(.*)$ negocio/$1.php [L,QSA]

```

# orm - 动态改变关系标准

> ID：10623831
> 
> 赞同：0
> 
> 时间：2012-05-16T17:43:45.573
> 
> 标签：orm, yii

有没有办法动态修改 Yii 的关系模型中给出的标准？

例如，我在一个游戏模型中有这种关系，它会给我所有的积分

```
'total_points' => [self::STAT, 'Point', 'game_id', 'select' => 'SUM(earned)'] 
```

这工作得很好。但是，我希望能够根据动态选择的特定用户 ID 来减少它。

我将如何创建一个类似以下的方法，该方法将为特定的、不断变化的用户返回在此游戏中获得的 total_points，其中 user_id 是 Point 模型的属性？

```
function getUserPoints($user_id) {
    return $this->someCriteriaChangingMethod('user_id = $user_id')->total_points;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T23:13:59.473

通过[yii 指南](http://www.yiiframework.com/doc/guide/1.1/en/database.arr#dynamic-relational-query-options)，这应该可以工作：

```
$model->total_points(array(
    'condition' => "user_id = :uId",
    'params' => array(':uId' => $user_id),
)); 
```

这是你想要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:07:26.710

我不认为你能做到这一点。这是另一种方法

```
function getUserPoints($user_id) {

     $row=Yii::app()->db->createCommand()->select("SUM(earned) as total_points")
                    ->from("point")
                    ->where('user_id = :user_id',array(":user_id"=>$user_id))
                    ->queryRow();
    return $row["total_points"];

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:27:39.123

要动态修改关系，您可以使用方法[`CActiveRecord->getRelated()`](http://www.yiiframework.com/doc/api/1.1/CActiveRecord/#getRelated-detail)，它允许我这样做

```
function getUserPoints($user_id) {
    $t = $this->getRelated('total_points', false, [
        'condition' => 'user_id = :user_id',
        'params' => [':user_id' => $user_id],
    ]);

    return $t;
} 
```

# python - /usr/bin/env: python2.6: No such file or directory 错误

> ID：10623833
> 
> 赞同：7
> 
> 时间：2012-05-16T17:43:58.493
> 
> 标签：python

我的里面有 python2.6、python2.7 和 python3`/usr/lib/`

我正在尝试运行一个文件，该文件的第一行包含下面给出的行

```
#!/usr/bin/env python2.6 
```

在尝试运行它之后，它给了我以下错误

```
/usr/bin/env: python2.6: No such file or directory 
```

我在 python 上的默认版本是 2.7。

如何在不更改 python 的默认版本的情况下运行文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-16T18:09:03.733

我认为您可能会对 python 可执行文件的位置与 lib 站点包的位置感到困惑。

你的 python 站点包应该在这里：
/usr/lib/python2.6/site-packages

但是您的可执行文件可能应该在这里：
/usr/bin

如果您运行以下命令，它应该会告诉您当前在哪里找到可执行文件：

```
which python
which python2.7
... 
```

您的 $PATH 环境变量应该包含直接在其下具有可执行文件的路径。IE `$ echo $PATH`
`/usr/bin:/usr/local/bin:/home/aUser/bin`

如果您的可执行文件位于不在您的路径中的另一个位置，并且您不想将该位置添加到您的路径中，您也可以将其符号链接到正常的位置......

```
ln -s /path/to/executable /usr/bin/executable 
```

这是查找所有名为 python 的可执行文件的技巧：

```
find /usr -type f -name 'python*' -perm -a+x 
```

这可能会帮助您找到 python2.6

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T17:49:11.510

你需要`python2.6`在你的`$PATH`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-29T12:58:03.717

您可能希望将 2.7 的别名创建为 2.6

```
sudo ln -s /usr/bin/python2.7 /usr/bin/python2.6 
```

# android - onkeylistener 不适用于 imagebutton

> ID：10623841
> 
> 赞同：0
> 
> 时间：2012-05-16T17:44:42.380
> 
> 标签：android, imagebutton, onclicklistener

我的 onkeylistener 事件有问题，我的代码是这样的

```
public void onCreate(Bundle savedInstanceState) {
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    super.onCreate(savedInstanceState);
    setContentView(R.layout.pnt_articulo);
    imbAgregarArt = (ImageButton)findViewById(R.id.imbAgregarArt);
    imbAgregarArt.setOnKeyListener(key);
}

OnKeyListener key = new OnKeyListener() {
    @Override
public boolean onKey(View v, int keyCode, KeyEvent event) {
    if(event.getAction() == KeyEvent.ACTION_DOWN) {
    Toast.makeText(getApplicationContext(), "Clicked", Toast.LENGTH_SHORT).show();
    return true;
        }
        return false;
    }
}; 
```

我使用调试停止在 Toast 行不输入

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:54:08.107

您正在做的是侦听按键事件，即键盘按下等，为此您的代码非常好。确保`ImageButton`选中并按任意键，您的`Toast`将出现。

由于这是一种非常奇怪的行为，您可能会追求`OnClickListener`：

```
....
    imbAgregarArt.setOnClickListener(click);
}

OnClickListener click = new OnClickListener() {
    @Override
    public void onClick(View v) {
        Toast.makeText(getApplicationContext(), "Clicked", Toast.LENGTH_SHORT).show();
    } 
}; 
```

请注意，我们已将 更改`OnKeyListener`为`OnClickListener`，第一个监听键盘活动，而第二个监听用户通过点击对象与对象的交互，无论是用手指（按下）还是使用触控板或设备可以选择的任何东西做。

作为一个 sido 说明 如果您对为什么即使您按下键盘键也无法正常工作感到好奇，那么问题来自视图没有聚焦的事实。要让视图监听其中的键盘事件，首先需要选择它们，这听起来合乎逻辑吧？

# google-maps - 如何制作这样的带有标记的交互式可点击地图？

> ID：10623846
> 
> 赞同：0
> 
> 时间：2012-05-16T17:44:46.517
> 
> 标签：google-maps, map, interactive

你能告诉我如何制作这样的可点击地图吗？是否可以使用 mysql 将其存储在数据库中。我对这个问题的了解非常少，所以任何教程或一些文章链接，我可以阅读更多关于此的内容，将不胜感激。

[http://www.foxtons.co.uk/search?submit_type=refine&search_form=map&tag=qs&search_type=SS&keyword_value=Postcode%2C+street+or+area&price_from=&price_to=&bedrooms=0&bedrooms_max=&prop_type=&sold=1](http://www.foxtons.co.uk/search?submit_type=refine&search_form=map&tag=qs&search_type=SS&keyword_value=Postcode%2C+street+or+area&price_from=&price_to=&bedrooms=0&bedrooms_max=&prop_type=&sold=1)

[http://www.ralf-wessels.de/Beispiele/Bundesland_Bezirk_Kreise.html](http://www.ralf-wessels.de/Beispiele/Bundesland_Bezirk_Kreise.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:54:15.963

特别针对您的问题，我认为[此页面](https://developers.google.com/maps/articles/phpsqlsearch)从数据库到地图逐步进行。

我主要关注谷歌教程，发现它们很容易理解。如果您是新手，请[从这里开始](https://developers.google.com/maps/documentation/javascript/tutorial)（API 密钥是可选的，除非您希望增加某些配额）

在编写代码时，您几乎肯定会想查看[参考资料](https://developers.google.com/maps/documentation/javascript/reference)

放置[标记](https://developers.google.com/maps/documentation/javascript/overlays#Markers)并添加[事件侦听器](https://developers.google.com/maps/documentation/javascript/events#EventListeners)（如单击）

[我在此页面](http://exploregooglemaps.blogspot.com.br/p/resources.html)中收集了许多其他链接

# html - 为什么在源代码中使用“\n”时浏览器中会显示空格？

> ID：10623848
> 
> 赞同：1
> 
> 时间：2012-05-16T17:45:02.170
> 
> 标签：html, browser

在处理我的项目时，我发现`\n`在 html 源代码中显示为浏览器中这两行之间的空格。例如，

```
a
b 
```

在浏览器中显示为`a b`. 如何在不删除换行符的情况下避免这个“空格”？我想要的结果是`ab`彼此相邻的——不是在单独的行上，也不是在它们之间有空格。

我使用 php 即时生成相当大的表单，为了便于阅读，我使用的格式`PHP_EOL`与 相同`\n`，但在浏览器中会出现额外的空格。我想摆脱他们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T17:48:42.787

**更新答案**：

在下面的评论中，您说您正在寻找的结果是“ab”彼此相邻，它们之间根本没有空格或换行符。

如果 "a" 和 "b" 真的是*text*，我不相信你有任何选择，如果你想让它们彼此相邻，你必须删除换行符。（我意识到你说过你不想那样做，我只是说，我认为你别无选择。）

如果“a”和“b”是元素（你说过你正在输出一个大表单），你可以玩负 CSS 边距的游戏，但它会很快变丑。或者将该换行符*移动*到标签中的旧技巧，例如：

```
<input name="a" type="text"
><input name="b" type="text"
> 
```

不显示标记内的换行符（因为它在标记中，而不是文本中）。

下面关于[元素间空白](http://www.w3.org/TR/html5/content-models.html#inter-element-whitespace)的链接也可能会有所帮助，具体取决于您的整体标记；基本上浏览器有时会忽略元素之间的空白，因此您可以稍微调整一下以使其做到这一点。

您说过您使用它是为了提高可读性。我想另一种选择，虽然它*真的很*冗长，是把换行符放在评论中：

```
form field here<!--
-->next form field here<!--
-->next form field here 
```

...但同样，非常冗长（并且可能对可读性没有太大作用）。

你最好的选择是你说你不想要的：删除换行符。:-)

**原始答案**：

*（从不清楚您是否希望“ab”彼此相邻的时候开始；几乎每个人都认为您希望**显示**换行符。）*

> 为什么在源代码中使用“\n”时浏览器中会显示空格？

因为 HTML 标准规定所有空白字符序列（除了[元素间空白](http://www.w3.org/TR/html5/content-models.html#inter-element-whitespace)）都被视为单个空格。因此对于 HTML，换行符、空格、制表符、回车符和换页符都是完全相同的：它们显示为空格。

> 如何在不删除换行符的情况下避免这个“空格”？

有几种方法：

1.  您可以使用一个[`br`元素](http://www.w3.org/TR/html5/the-br-element.html#the-br-element)：

    ```
    a<br>b 
    ```

2.  您可以将`a`和`b`放在使用块显示的*单独*[`p`](http://www.w3.org/TR/html5/the-p-element.html#the-p-element)容器中（默认情况下两者都[`div`](http://www.w3.org/TR/html5/the-div-element.html#the-div-element)做，您可以使用 CSS 应用`display: block`到其他容器）。

    ```
    <p>a</p>
    <p>b</p> 
    ```

    或者

    ```
    <div>a</div>
    <div>b</div> 
    ```

    ETC

3.  如果您确实希望将该换行符视为换行符，则可以使用一个[`pre`](http://www.w3.org/TR/html5/the-pre-element.html#the-pre-element)元素，该元素对预格式化文本具有特殊处理

    ```
    <pre>a
    b</pre> 
    ```

    [`white-space`...并且您可以使用 CSS 的样式](http://www.w3.org/TR/CSS2/text.html#propdef-white-space)（值`pre`、、`pre-wrap`和）对其他元素应用相同类型的处理`pre-line`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:47:44.847

在 html 中使用空间`</br>`而不是 \n。\n 在代码中用于换行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:05:28.533

\n 可能不是“显示”新行所需的唯一字符。

根据平台 \n 可能只在代码中或在代码和视觉输出中为您提供换行符。某些平台要求 \r 具有可视回车符。在某些情况下，您甚至可能需要 \r\n 才能获得所需的输出。

进一步阅读 SO > [\r 和 \n 有什么区别？](https://stackoverflow.com/questions/1279779/what-is-the-difference-between-r-and-n)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T18:07:34.027

如果您不想在渲染输出中出现空白，请不要将其放入输入中 - 就这么简单。或者，生成可读性极好的 xml 作为中间步骤，并使用 xslt 将其处理为没有不需要的空白的 html。

注意：建议用户在此答案中插入适当`<sarcasm>`的标签；）

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-05-16T17:46:41.927

用一些像这样的内联标记包围它们

```
<span>a</span
><span>b</span> 
```

# ajax - Web 客户端通过消息队列服务与通过 ajax 交互的优缺点是什么？

> ID：10623849
> 
> 赞同：3
> 
> 时间：2012-05-16T17:45:07.877
> 
> 标签：ajax, client-server, message-queue, amazon-sqs

AFAIU 大多数 javascript 应用程序通过 ajax 与服务器交互，ajax 是 http 的一种形式。假设我们要制作一个 javascript 应用程序，通过 Amazon Simple Queue Service 或其他类似的消息队列服务交换消息，从而与服务器交互。与 http 方法相比，它的优缺点是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T13:08:49.633

仅 AJAX 方法与 SQS 之类的方法之间的最大区别在于**持久性**。

在 AJAX 系统中，您的客户端和服务器都必须同时启动，因为如果您的客户端关闭，进行中的消息可能会“丢失”。与许多排队系统一样，SQS 将其解耦，并增加了一层处理灵活性（这可能不是必需的）。

我的应用程序现在可以随时将消息放入队列，服务器可以将它们取出并处理它们，但是虽然它们现在都依赖于*队列*，但它们并不直接*相互依赖*。

一个简单的类比可能是电话——如果我给你打电话而你不接，我们就完了。但是，如果您有留言机，我可以留下一条或多条消息，您可以在方便时收集它们。

# c# - 将代码后面的文本转换为具有不同字体样式的文本块

> ID：10623850
> 
> 赞同：0
> 
> 时间：2012-05-16T17:45:13.753
> 
> 标签：c#, silverlight, user-interface, styles

我有一个文本块，其文本是由转换器从绑定对象生成的。我试图让部分文本的字体与其余部分不同。这在 Silverlight/WPF 中可行吗？

我将如何生成代码来产生这种效果？

示例文本：

-你好，这是一些文字-“更多文字”

其中 -- 中的任何文本是一种字体，而“”表示另一种字体。我查看了内联运行，但在后面的代码中这似乎不可行。

谁能指出我正确的方向？

谢谢，泰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:55:37.370

你做内联是正确的

```
 textBlock.Inlines.Add(new Run
                           {
                               FontFamily = new FontFamily("Comic Sans"),
                               Text = "Your text"
                           });
        textBlock.Inlines.Add(new Run
        {
            FontFamily = new FontFamily("Tahoma"),
            Text = " is different"
        }); 
```

如果您已经知道文本将是什么（您知道将有两部分文本），那么另一种可能的解决方案是准备一些预先准备好的 xaml 并使用 XamlReader.Parse 方法

# fullcalendar - 按类名删除事件

> ID：10623852
> 
> 赞同：0
> 
> 时间：2012-05-16T17:45:22.633
> 
> 标签：fullcalendar

我正在尝试使用 Full Calendars removeEvents 函数来删除一组具有相同类名的事件。我不认为我输入的语法完全正确。

> $('#calendar').fullCalendar('removeEvents', event.className===user);

这是 ajax 脚本的一部分。当 readyState == 4 时，这是最后被执行的代码。

目前它会删除所有日历条目。我知道如何按 ID 删除，但我认为我不太了解过滤器字符串语法。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:08:07.287

您需要将事件对象的 ID**或**过滤器函数作为参数传递。

```
$('#calendar').fullCalendar('removeEvents', myRemove);

function myRemove(event) {
    return "user" === event.className; // ensure your events have this custom class !
} 
```

[文件](http://arshaw.com/fullcalendar/docs/event_data/removeEvents/)

# database - Django：没有数据库完整性检查的“软”ForeignField

> ID：10623854
> 
> 赞同：15
> 
> 时间：2012-05-16T17:45:36.007
> 
> 标签：database, django-models, foreign-keys, constraints

我有一个 Django 项目，它有多个 django“应用程序”。其中一个有模型来表示来自外部源的数据（我不控制这些数据）。

我希望我的其他应用程序能够引用这个“外部应用程序”，但我想避免数据库完整性检查的所有模糊。我不希望数据库对这些“软外键”有任何限制。

你知道我如何编写一个自定义字段来模拟真实的 Django ForeignKey，而不会对数据库产生硬约束吗？

也许这已经存在，但我在谷歌上没有任何运气。

在此先感谢您的帮助 ：-）

注意：我知道带有 content_types的[通用关系系统。](https://docs.djangoproject.com/en/1.4/ref/contrib/contenttypes/#generic-relations)但我不想要泛型关系。我只希望与已识别模型的特定关系没有硬完整性约束。

编辑：

我找到了相关链接：

*   [不需要参照完整性的Django ForeignKey？](https://stackoverflow.com/questions/3558907/django-foreignkey-which-does-not-require-referential-integrity)
*   [理解 / mySQL 又名欺骗 Django 中的 ForeignKey 关系](https://stackoverflow.com/questions/6788558/understanding-mysql-aka-tricking-foreignkey-relationships-in-django)

但是我没有找到我的问题的正确答案。:(

编辑 2012，6 月 4 日：

我已经深入研究了 django 的代码以找到需要做的事情，但我认为仅仅继承 ForeignKey 是不够的。你能给我一些关于如何做到这一点的指导吗？

注意：我使用 South 来管理我的数据库模式，所以我认为我也需要对此做一些事情。但这可能超出了这里的主题:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-06-30T11:49:40.330

如果您只想禁用某个字段的 ForeignKey 约束检查，则只需添加`db_constraint=False`到该字段。

```
user = models.ForeignKey('User', db_constraint=False) 
```

另请参阅： [Django - 如何防止创建数据库外键约束](https://stackoverflow.com/questions/8051556/django-how-to-prevent-database-foreign-key-constraint-creation)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-12T22:42:58.493

借鉴 marianobianchi 的评论，ForeignKey.on_delete 的选项之一是

> DO_NOTHING：不采取任何行动。如果您的数据库后端强制执行引用完整性，这将导致 IntegrityError，除非您手动将 SQL ON DELETE 约束添加到数据库字段（可能使用初始 sql）。

这与在数据库级别禁用外键约束相结合应该可以解决问题。据我所知，有两种方法可以做到这一点。您可以像这样完全禁用 fk 约束：

```
from django.db.backend.signals import connection_created
from django.dispatch import receiver

@receiver(connection_created)
def disable_constraints(sender, connection):
    connection.disable_constraint_checking() 
```

看起来 django db 后端也提供了一个 constraint_checks_disabled 上下文管理器，因此您可以将相关的数据库访问包装在这样的代码中，以避免在整个过程中禁用检查：

```
from django.db import connection
with connection.constraint_checks_disabled():
    do_stuff() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-12T12:36:42.500

各位，

我设法做出了我想要的。

首先，我创建了一个新字段：

```
from django.db.models.deletion import DO_NOTHING
from django.db.models.fields.related import ForeignKey, ManyToOneRel

class SoftForeignKey(ForeignKey):
    """
    This field behaves like a normal django ForeignKey only without hard database constraints.
    """
    def __init__(self, to, to_field=None, rel_class=ManyToOneRel, **kwargs):
        ForeignKey.__init__(self, to, to_field=to_field, rel_class=rel_class, **kwargs)
        self.on_delete = DO_NOTHING

    no_db_constraints = True 
```

由于我使用 South 来管理我的数据库模式，因此我必须添加以下内容：

```
from south.modelsinspector import add_introspection_rules
add_introspection_rules([], [r'^ecm\.lib\.softfk\.SoftForeignKey']) 
```

然后，我不得不向南修补补丁，以便将`no_db_constraints`参数考虑在内。FK 约束的创建涉及两个函数：

```
from django.db.models.deletion import DO_NOTHING
from django.db.models.fields.related import ForeignKey, ManyToOneRel
from django.core.management.color import no_style
from south.db.generic import DatabaseOperations, invalidate_table_constraints, flatten

def column_sql(self, table_name, field_name, field, tablespace='', with_name=True, field_prepared=False):
    """
    Creates the SQL snippet for a column. Used by add_column and add_table.
    """

    # If the field hasn't already been told its attribute name, do so.
...
...
...

        if field.rel and self.supports_foreign_keys:
            # HACK: "soft" FK handling begin
            if not hasattr(field, 'no_db_constraints') or not field.no_db_constraints:
                self.add_deferred_sql(
                    self.foreign_key_sql(
                        table_name,
                        field.column,
                        field.rel.to._meta.db_table,
                        field.rel.to._meta.get_field(field.rel.field_name).column
                    )
                )
            # HACK: "soft" FK handling end

    # Things like the contrib.gis module fields have this in 1.1 and below
    if hasattr(field, 'post_create_sql'):
        for stmt in field.post_create_sql(no_style(), ta
....
....

# monkey patch South here
DatabaseOperations.column_sql = column_sql 
```

和：

```
from django.db.models.deletion import DO_NOTHING
from django.db.models.fields.related import ForeignKey, ManyToOneRel
from django.core.management.color import no_style
from south.db.generic import DatabaseOperations, invalidate_table_constraints, flatten

@invalidate_table_constraints
def alter_column(self, table_name, name, field, explicit_name=True, ignore_constraints=False):
    """
    Alters the given column name so it will match the given field.
    Note that conversion between the two by the database must be possible.
    Will not automatically add _id by default; to have this behavour, pass
    explicit_name=False.

    @param table_name: The name of the table to add the column to
    @param name: The name of the column to alter
    @param field: The new field definition to use
    """

    if self.dry_run:
        if self.debug:
...
...
    if not ignore_constraints:
        # Add back FK constraints if needed
        if field.rel and self.supports_foreign_keys:
            # HACK: "soft" FK handling begin
            if not hasattr(field, 'no_db_constraints') or not field.no_db_constraints:
                self.execute(
                    self.foreign_key_sql(
                        table_name,
                        field.column,
                        field.rel.to._meta.db_table,
                        field.rel.to._meta.get_field(field.rel.field_name).column
                    )
                )
            # HACK: "soft" FK handling end

# monkey patch South here
DatabaseOperations.alter_column = alter_column 
```

这真的很难看，但我没有找到其他方法。

现在，您可以像使用普通 ForeignKey 一样使用 SoftForeignKey 字段，只是您不会执行任何参照完整性强制。

有关完整的猴子补丁，请参见此处：http: [//eve-corp-management.org/projects/ecm/repository/entry/ecm/lib/softfk.py](http://eve-corp-management.org/projects/ecm/repository/entry/ecm/lib/softfk.py)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-11T17:25:29.397

我尝试了类似于 Izz ad-Din Ruhulessin 的建议的方法，但没有奏效，因为除了“假 FK”列之外，我还有其他列。我试过的代码是：

```
class DynamicPkg(models.Model):
    @property
    def cities(self):
        return City.objects.filter(dpdestinations__dynamic_pkg=self)

class DynamicPkgDestination(models.Model):
    dynamic_pkg = models.ForeignKey(DynamicPkg, related_name='destinations')
    # Indexed because we will be joining City.code to
    # DynamicPkgDestination.city_code and we want this to be fast.
    city_code = models.CharField(max_length=10, db_index=True)

class UnmanagedDynamicPkgDestination(models.Model):
    dynamic_pkg = models.ForeignKey(DynamicPkg, related_name='destinations')
    city = models.ForeignKey('City', db_column='city_code', to_field='code', related_name='dpdestinations')

    class Meta:
        managed = False
        db_table = DynamicPkgDestination._meta.db_table

class City(models.Model):
    code = models.CharField(max_length=10, unique=True) 
```

我得到的错误是：

```
Error: One or more models did not validate:
travelbox.dynamicpkgdestination: Accessor for field 'dynamic_pkg' clashes with related field 'DynamicPkg.destinations'. Add a related_name argument to the definition for 'dynamic_pkg'.
travelbox.dynamicpkgdestination: Reverse query name for field 'dynamic_pkg' clashes with related field 'DynamicPkg.destinations'. Add a related_name argument to the definition for 'dynamic_pkg'.
travelbox.unmanageddynamicpkgdestination: Accessor for field 'dynamic_pkg' clashes with related field 'DynamicPkg.destinations'. Add a related_name argument to the definition for 'dynamic_pkg'.
travelbox.unmanageddynamicpkgdestination: Reverse query name for field 'dynamic_pkg' clashes with related field 'DynamicPkg.destinations'. Add a related_name argument to the definition for 'dynamic_pkg'. 
```

但是，我确实通过使用代理模型提出了一个可行的解决方案。我仍然不得不破解一些 Django 验证，以防止字段被包含在代理模型中：

```
class DynamicPkg(models.Model):
    @property
    def cities(self):
        return City.objects.filter(dpdestinations__dynamic_pkg=self)

def proxify_model(new_class, base):
    """
    Like putting proxy = True in a model's Meta except it doesn't spoil your
    fun by raising an error if new_class contains model fields.
    """
    new_class._meta.proxy = True
    # Next 2 lines are what django.db.models.base.ModelBase.__new__ does when
    # proxy = True (after it has done its spoil-sport validation ;-)
    new_class._meta.setup_proxy(base)
    new_class._meta.concrete_model = base._meta.concrete_model

class DynamicPkgDestination(models.Model):
    dynamic_pkg = models.ForeignKey(DynamicPkg, related_name='destinations')
    # Indexed because we will be joining City.code to
    # DynamicPkgDestination.city_code and we want this to be fast.
    city_code = city_code_field(db_index=True)

class ProxyDynamicPkgDestination(DynamicPkgDestination):
    city = models.ForeignKey('City', db_column='city_code', to_field='code', related_name='dpdestinations')

proxify_model(ProxyDynamicPkgDestination, DynamicPkgDestination)

class City(models.Model):
    code = models.CharField(max_length=10, unique=True) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T16:59:25.103

您可以尝试使用非托管模型：

```
from django.db import models

class ReferencedModel(models.Model):
    pass

class ManagedModel(models.Model):
    my_fake_fk = models.IntegerField(
        db_column='referenced_model_id'
    )

class UnmanagedModel(models.Model):
    my_fake_fk = models.ForeignKey(
        ReferencedModel, 
        db_column='referenced_model_id'
    )

    class Meta:
        managed = False
        db_table = ManagedModel._meta.db_table 
```

**在 Model Meta 类中指定`managed=False`不会为其创建 db 表。但是，它的行为与其他模型完全一样。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-23T19:38:11.293

我通过使用 GenericForeignKey 解决了这个问题：

```
thing_content_type = models.ForeignKey(ContentType, on_delete=models.CASCADE, blank=True, null=True)
thing_object_id = models.UUIDField(default=uuid.uuid4, blank=True, null=True)

thing = GenericForeignKey(ct_field='thing_content_type', fk_field='thing_object_id') 
```

从好的方面来说，它是开箱即用的 Django

不利的一面是，您的模型中有三个附加属性。

此外，反向关系不会自动起作用，但就我而言，我可以接受。

# sphinx - 如何在 Sphinx RT 中在预先存在的索引上添加新的 rt_field？

> ID：10623860
> 
> 赞同：5
> 
> 时间：2012-05-16T17:46:16.453
> 
> 标签：sphinx

使用 sphinx RT（实时），我有一个当前的工作设置。

但我想添加一个新字段来跟踪：`rt_field new_field`

在将上述内容添加到我的 sphinx.conf 并发出 a`/etc/init.d/sphinxsearch restart`后，尝试填充 sphinx 会产生一个错误，指出 my`new_field`是未知列。
*（文档没有明确提到 RT 索引。）*

问题：

我是否必须删除索引文件并让 sphinx 重新创建它，或者有没有办法更新一个以及如何更新？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-17T06:55:46.803

从头开始重新创建索引和重新索引所需的 Sphinx RT 索引结构的任何更改。因此，您需要创建新索引并重新索引所有数据。

# php - sqlsvr_connect() 没有连接！？尝试连接php

> ID：10623862
> 
> 赞同：1
> 
> 时间：2012-05-16T17:46:26.693
> 
> 标签：php, database, sql-server-2008

我试图连接到一个 ms sql 数据库，但我遇到了超时错误......

我已经通过添加和启用安装了微软驱动程序，

```
extension=php_sqlsrv_53_ts.dll 
```

在我的 php.ini 文件中，并将 dll 添加到我的 php 扩展中，该扩展位于我的“C:\Program Files\PHP\ext”中......而且，我的 php.ini 中的 extension_dir 也是“C:\程序文件\PHP\ext"

我正在使用此代码连接...

```
phpinfo();

$serverName = "xxx.xxx.xxx.xxx/sqlexpress";

$connectionInfo = array(
     "Database"=>"dbname", 
     "UID"=>"username", 
     "PWD"=>"password");

$conn = sqlsrv_connect( $serverName, $connectionInfo);

if($conn){
     echo "Connection established.\n";
}else{
     echo "Connection could not be established.\n";
     die( print_r( sqlsrv_errors(), true));
} 
```

phpinfo() 显示 sqlsrv 确实在 Registered PHP Streams 中。问题不是一个未定义的函数，而是它一直在加载......它没有超时，它没有给我一个错误，它只是一直在思考......我错过了什么吗？请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T20:47:44.143

```
$serverName = "xxx.xxx.xxx.xxx/sqlexpress"; 
```

应该：

```
$serverName = "xxx.xxx.xxx.xxx\sqlexpress"; 
```

另外，请参阅此问题的答案：[通过 PHP 连接到 SQL Server 2008](https://stackoverflow.com/questions/9254329/connecting-to-sql-server-2008-through-php)

# android - 使用 Android 进行 OAuth

> ID：10623864
> 
> 赞同：3
> 
> 时间：2012-05-16T17:46:30.080
> 
> 标签：android, oauth, signpost, yelp

我正在尝试访问 Yelp API。我已经拿到了我的钥匙，并阅读了大约 40 篇解释我需要做什么的文章，并且我已经尝试了一切。密钥和无效的内容。我得到以下信息：

```
05-16 17:39:54.955: E/AndroidRuntime(538): java.lang.NoClassDefFoundError: oauth.signpost.commonshttp.CommonsHttpOAuthConsumer 
```

我已经导入了 commons-codec-1.6 jar、signpost-commonshttp4-1.2.1.2.jar 和 signpost-core-1.2.1.2.jar。

我仍然收到错误消息。有什么帮助吗？

```
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.HashMap;
import java.util.Map;

import oauth.signpost.OAuth;
import oauth.signpost.OAuthConsumer;
import oauth.signpost.commonshttp.CommonsHttpOAuthConsumer;
import oauth.signpost.exception.OAuthCommunicationException;
import oauth.signpost.exception.OAuthExpectationFailedException;
import oauth.signpost.exception.OAuthMessageSignerException;

/**
 * Example for accessing the Yelp API.
 */
public class Yelp {
  private String consumerKey = "";
  private String consumerSecret = "";
  private String token = "";
  private String tokenSecret = "";

  /**
   * Search with term and location.
   *
   * @param term Search term
   * @param latitude Latitude
   * @param longitude Longitude
   * @return JSON string response
   */
  public String search(String term, double latitude, double longitude) throws OAuthMessageSignerException, OAuthExpectationFailedException, OAuthCommunicationException {

    try {
        OAuthConsumer myConsumer = new CommonsHttpOAuthConsumer(consumerKey, consumerSecret);
        myConsumer.setTokenWithSecret(token, tokenSecret);

        String urlToPost = "http://api.yelp.com/v2/search";
        Map<String, String> myMap = new HashMap<String, String>();
        myMap.put(OAuth.OAUTH_CONSUMER_KEY, consumerKey);
        myMap.put(OAuth.OAUTH_TOKEN, token);
        myMap.put(OAuth.OAUTH_SIGNATURE_METHOD, "HMAC-SHA1");
        myMap.put(OAuth.OAUTH_SIGNATURE, tokenSecret);
        myMap.put(OAuth.OAUTH_TIMESTAMP, Long.toString(System.currentTimeMillis() / 1000L));
        myMap.put(OAuth.OAUTH_NONCE, "asdf");

        urlToPost = OAuth.addQueryParameters(urlToPost, myMap);

        HttpURLConnection myCon = (HttpURLConnection) (new URL(urlToPost)).openConnection();
        myConsumer.sign(myCon);

        myCon.connect();
        return myCon.getResponseMessage();
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T17:48:38.253

转到 Project -> Properties，然后在您的 Java Build Path -> Order and Export 选项卡下确保检查了这些 JAR。

而且，为了将来参考，如果这些是你真正的钥匙，我会确保**不要**把它们放在公共网站上。只是在说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-23T04:25:18.940

我在 Android 应用程序中也面临同样的问题。当我使用signpost **-core-1.2.1.2** 但它无法解析**CommonsHttpOAuthConsumer**。我从[http://www.java2s.com/Code/Jar/s/Downloadsignpostcommonshttp41211jar.htm下载它](http://www.java2s.com/Code/Jar/s/Downloadsignpostcommonshttp41211jar.htm)

有效。

# forms - 从 CurrentRecord 自动填充表单 - MS Access

> ID：10623865
> 
> 赞同：0
> 
> 时间：2012-05-16T17:46:33.110
> 
> 标签：forms, ms-access

上周刚开始访问，所以我对它的编码不是很好，我只知道到目前为止我需要什么。

我正处于有各种子表的地步；特别是我们正在为一些包含水槽、分配器、镜子等的浴室建立数据库。每个包含的项目都有大量的信息，并且可能有很多，所以它们每个都有自己的桌子（tblSinks、tblMirrors 等，以及 tblBathrooms ）。

每个项目都将与一个浴室相关联（多对一；项目到浴室）。我需要知道什么是最好的、最被接受和最常用的方式来链接表单，这样在表单中编辑浴室时，有一个带有按钮的选项卡链接到其他表单（btnOpenMirrorForm 类型的东西）。

我想要的是最佳实践：

1.  打开表单（如果有什么特别之处，否则使用设计的按钮向导）
2.  根据浴室表单中当前记录的 ID 自动填充项目的“AssociatedBathroomID”
3.  确保显示足够的信息以向用户保证他们正在他们想要的浴室内创建镜子（因为记录导航我可以自己做，但确实需要实施）
4.  当 btnOpenMirrorForm 被按下时，它应该打开一个新记录（把它想象成一个“向这个浴室添加一个项目”类型的按钮）

在你说之前，我已经尝试过调查它。有很多方法，有些可能有效，但我想知道什么是最好的方法；这绝对看起来应该很常见。我也不反对子表单，但正如我所说，有很多信息，最终会出现在 Tablet PC 的屏幕上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:03:36.680

首先，您应该确保您的表具有正确的关系。例如，一个浴室可以有多个物品，其中一个物品可以是水槽、镜子等。

然后，Batrhoom 将与 Items 建立一对多的关系。可以使用查找表从接收器、镜子等列表中选择项目中的每个项目。因此，一旦将一个 sing 添加到数据库中，该接收器就可以再次使用多次。

1.  打开表单：向导按钮足以打开表单。但是，您可以在打开表单时提供更多参数。建议使用向导的代码并查看它，看看还有哪些选项（例如，将表单打开为对话框、模式等）
2.  不清楚你的意思
3.  在事物（浴室）有多个子事物且空间有限的情况下，我使用选项卡控件。表单的上半部分包含浴室信息，下半部分有一个选项卡控件，每个子项目都有一个选项卡...在选项卡内，您可以为此放置一个子表单。子表单可以链接到主表单，如果添加了新的子表单项，Access 将负责正确链接。
4.  可以在数据输入中打开表单，但是如果您使用表单-子表单原则，子表单可以显示属于主表单项的所有数据。

希望这可以帮助你

# sql - 使用 select 语句填充 sql 变量是可行的，但是如果我将相同的语句放入变量中并尝试 exec() 它不起作用

> ID：10623870
> 
> 赞同：2
> 
> 时间：2012-05-16T17:47:02.383
> 
> 标签：sql, sql-server, sql-server-2005

我正在尝试用一个值填充一个 sql 变量。当代码如下时它可以工作：

```
declare @num_records int
set @num_records = ( select  distinct count(*) as num_recs 
   from dbo.tbllookup  )
print @num_records 
```

例如，为了让我的查询更简单，但它是一个复杂的查询，我想把它放在变量中，因为我必须在其他地方重用查询的一部分。所以我尝试了这个，但它不起作用。错误提示“关键字 'exec' 附近的语法不正确”。

```
declare @num_records int
declare @sqlstr varchar(200)
set @sqlstr = '( select  distinct count(*) as num_recs 
   from dbo.tbllookup  )'
set @num_records = exec(@sqlstr)
print @num_records 
```

我是一个sql查询新手。所以只是想了解这个概念并想知道我在这里做错了什么。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:51:33.920

正如您所发现的，您不能以这种方式填充变量。您必须使用它`sp_executesql`来执行此操作。

```
Declare @Sql nvarchar(max);
Declare @CountResult int;

Set @Sql = 'Select @Count = Count(*) From SomeTable';
exec sp_executesql @Sql, N'@Count int OUTPUT', @CountResult OUTPUT

Select @CountResult 
```

[sp_executesql (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms188001.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T17:53:10.530

您需要使用带有输出参数的 sp_executeSQL

如果您没有正确使用参数，请参见底部的示例 [将 exec 更改为 sp_executesql 不会提供任何好处](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/changing-exec-to-sp_executesql-doesn-t-p)

```
declare @sqlstr Nvarchar(200)
DECLARE @num_records int
set @sqlstr = '( select  distinct @num_records =  count(*)  
                  from dbo.tbllookup  )'
EXEC SP_EXECUTESQL @sqlstr, N'@num_records INT OUTPUT', @num_records OUTPUT

print @num_records 
```

# wpf - silverlight 控件可以同时具有 DataTemplate 和 ControlTemplate 吗？

> ID：10623875
> 
> 赞同：0
> 
> 时间：2012-05-16T17:47:13.167
> 
> 标签：wpf, silverlight-4.0, controls, controltemplate

我怀疑具有 ContentTemplate 属性的 ContentControl 是 DataTemplate 还是 ControlTemplate 取决于每个派生的 silverlight 控件在其类中声明的内容。

如果是，我怎样才能同时为同一个控件自定义它们？

例如，ListBoxItem 是一个 ContentControl，我可以将其 ContentTemplate 设置为声明式内联的 DataTemplate。我可以为它内联设置自定义 ControlTemplate 吗？还是只能单独设置 ControlTemplate？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:50:31.497

每个控件都有一个`ControlTemplate`定义控件的外观。一个控件可以有多个`DataTemplates`，具体取决于它如何处理数据，`ContentControl`通常只有`Content`一个可以通过`ContentTemplate`. 一些带标题的控件也可能有一个数据模板属性来模板标题，这完全取决于您使用的控件。

# java - 当我们使用它时，线程本地是什么？

> ID：10623881
> 
> 赞同：-6
> 
> 时间：2012-05-16T17:47:48.967
> 
> 标签：java, thread-safety

> **可能重复：**
> [何时以及如何使用 ThreadLocal 变量？](https://stackoverflow.com/questions/817856/when-and-how-should-i-use-a-threadlocal-variable)

我对本地线程的了解是 .

1) Thread Local 必须声明为**public static final**。

2) Thread Local 是当前线程的局部变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:51:46.377

它不需要公开

但它本质上是一个 Map ，您只能将当前 Thread 作为键获取，并且当尚未设置值时它会自动初始化

这实现了线程本地存储，因此您可以拥有“公共静态”变量而无需对其进行同步

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T17:51:34.613

在您的陈述中找不到问题，但让我试试：

> 1) Thread Local 必须声明为 public static final 。

不是真的，事实上`ThreadLocal`可以是私有的，不必是`static`并且可以是非最终的。不知道你在哪里见过这样的要求。

> 2) Thread Local 是当前线程的局部变量。

正确的。您可以想象这`ThreadLocal`是一个映射，其中键是线程，值是实际变量。但它以更好的方式实施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T18:42:46.727

Threadlocal 为每个线程创建您指定的类型的单独实例（它是通用的）。您可以简单地使用它的 get() 方法来访问它。此方法将始终返回当前线程的值。

# c# - WinCE 中的 SystemState.PhoneSignalStrength

> ID：10623887
> 
> 赞同：0
> 
> 时间：2012-05-16T17:48:16.653
> 
> 标签：c#, compact-framework, windows-ce

我是否认为以下内容不适用于 WinCE 6 设备？

```
int signal = SystemState.PhoneSignalStrength; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:32:46.357

正确的。 [SystemState 类](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.status.systemstate.aspx)是 Microsoft.WindowsMo​​bile 命名空间的一部分，顾名思义，它只存在于 Windows Mobile 设备中。它在底层使用[状态和通知代理](http://msdn.microsoft.com/en-us/library/bb154491.aspx)，这在标准 Windows CE 构建中不存在。

# cordova - 警告说“Id”存在并且应该被销毁

> ID：10623890
> 
> 赞同：3
> 
> 时间：2012-05-16T17:48:30.027
> 
> 标签：cordova, sencha-touch, extjs, sencha-touch-2

大多数情况下，当我多次单击同一个按钮时（两次或多次调用同一函数时），我会看到以下警告

```
[WARN] [WARN][Ext.Component#constructor] Registering a component with a id (`name`) which has already been used. Please ensure the existing component has been destroyed (`Ext.Component#destroy()`. 
```

`destroy`正如警告所建议的那样，我应该如何处理？或者我应该如何解决这个问题？

**更新**

```
function onPersonFound(imageData) {
           var image = Ext.create('Ext.Img', {
                                 src: "data:image/jpeg;base64," + imageData,
                                 id: 'logo',
                                 width: 372,
                                 height: 140
                                 }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T18:01:24.487

> `name`[WARN][Ext.Component#constructor]使用已使用的 id ( ) 注册组件。请确保现有组件已被销毁（`Ext.Component#destroy()`.

警告指出您创建和销毁组件的`id:name`速度太快。因此，我建议您删除该`id`组件上的硬编码属性，而是使用`itemId`.

为什么要用`itemId`over `id`？

> 当没有可用的对象引用时，itemId 可用作获取对组件的引用的替代方法。不要使用带有 Ext.getCmp 的 id，而是使用带有 Ext.Container.getComponent 的 itemId，它将检索 itemId 或 id。**由于 itemId 是容器内部 MixedCollection 的索引，因此 itemId 的范围仅限于容器本地 - 避免与需要唯一 id 的 Ext.ComponentManager 发生潜在冲突。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T02:24:34.970

根据您的控制器功能，这是因为在您第一次单击按钮时，Sencha Touch 会创建一个`Ext.Image`带有 id的`logo`。第二次`logo`创建了另一个具有 id 的图像，因此有 2 个组件具有相同的`id`. 如果基于`id`属性会导致错误的查询结果。

当您创建任何组件时，只需在您的`id`配置中更加“具体”，以确保任何时候都没有相同`id`的组件。例如：

```
function onPersonFound(imageData) {
           var image = Ext.create('Ext.Img', {
                                 src: "data:image/jpeg;base64," + imageData,
                                 id: 'logo' + person_id,
                                 width: 372,
                                 height: 140
                                 }); 
```

注意：我写信`person_id`是为了代表您实例的**唯一**字段，以确保没有具有相同`id`. 希望对您有所帮助。

# scala - Scala 类型：最小上限

> ID：10623892
> 
> 赞同：6
> 
> 时间：2012-05-16T17:48:34.333
> 
> 标签：scala, types, polymorphism, type-parameter, subtype

我正在尝试使用非常通用的类型参数参数化一些方法。

例如，在 REPL 中我首先定义：

```
trait Term
case class FunctionalTerm[+T <: Term](t: T) extends Term 
```

直观地说，以下方法接受一个 Term 和一个 FunctionalTerm，并返回类型为传递的 term 类型的最小上限和 FunctionalTerm 的参数类型的东西：

```
def ex1[T1 <: Term, T3 <: X, FunctionalTerm[T1] <: X, X <: R, R <: Term](t1: FunctionalTerm[T1], s: T3): R = sys.error("TODO") 
```

到目前为止，在 REPL 中表现出色。

然后我定义`ex2`为一个便利函数，它执行与 相同的操作`ex1`，但交换了输入参数：

```
def ex2[T2 <: Term, T3 <: X, FunctionalTerm[T2] <: X, X <: R, R <: Term](s: T3, t2: FunctionalTerm[T2]): R = ex1(t2,s) 
```

尝试`ex2`在 REPL 中定义会出现以下错误：

```
error: inferred type arguments [T2,T3,FunctionalTerm,T3,T3] do not conform to method ex1's type parameter bounds [T1 <: Term,T3 <: X,FunctionalTerm[T1] <: X,X <: R,R <: Term]
         ex1(t2,s)
         ^
error: type mismatch;
 found   : FunctionalTerm[T2]
 required: FunctionalTerm[T1]
         ex1(t2,s)
             ^
error: type mismatch;
 found   : T3(in method ex2)
 required: T3(in method ex1)
         ex1(t2,s)
                ^
error: type mismatch;
 found   : R(in method ex1)
 required: R(in method ex2)
         ex1(t2,s)
            ^ 
```

我花了大约两天的时间试图找出解决方案，现在完全被卡住了。我在 Google 上找不到更多信息。

由于 的 类型参数列表与`ex2`的 相同，`ex1`但使用`T1`和`T2`交换，我不明白是错误的，或者如何修复它。

任何帮助将不胜感激！

**更新**

最小的上限是红鲱鱼。这个例子可以进一步提炼。

可以在 REPL 中定义以下两个函数而不会出错：

```
def ex1[T1 <: Term, FunctionalTerm[T1] <: Term](t1: FunctionalTerm[T1]): Term = sys.error("TODO: ex1")
def ex2[T2 <: Term, FunctionalTerm[T2] <: Term](t2: FunctionalTerm[T2]): Term = ex1(t2) 
```

引入额外的参数`X`似乎会导致问题。我可以在 REPL 中定义以下内容：

```
def ex3[T1 <: Term, FunctionalTerm[T1] <: X, X <: Term](t1: FunctionalTerm[T1]): Term = sys.error("TODO: ex3") 
```

但试图随后定义：

```
def ex4[T2 <: Term, FunctionalTerm[T2] <: X, X <: Term](t2: FunctionalTerm[T2]): Term = ex3(t2) 
```

给出错误：

```
error: inferred type arguments [T2,FunctionalTerm,Nothing] do not conform to method ex3's type parameter bounds [T1 <: Term,FunctionalTerm[T1] <: X,X <: Term]
       def ex4[T2 <: Term, FunctionalTerm[T2] <: X, X <: Term](t2: FunctionalTerm[T2]): Term = ex3(t2)
                                                                                               ^
error: type mismatch;
 found   : FunctionalTerm[T2]
 required: FunctionalTerm[T1]
       def ex4[T2 <: Term, FunctionalTerm[T2] <: X, X <: Term](t2: FunctionalTerm[T2]): Term = ex3(t2)
                                                                                                   ^ 
```

所以，我猜问题就变成了：为什么`X`签名中未使用的参数会有这种效果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T19:15:15.497

我不确定你是否遇到了错误，但我很确定你让你的生活变得更加困难。您可以依靠协变和统一为您完成所有艰苦的工作，

```
scala> trait Term
defined trait Term

scala> case class FunctionalTerm[+T <: Term](t: T) extends Term
defined class FunctionalTerm

scala> def ex1[T <: Term](t1 : FunctionalTerm[T], s : T) : T = s
ex1: [T <: Term](t1: FunctionalTerm[T], s: T)T

scala> class A extends Term ; class B extends A ; class C extends A
defined class A
defined class B
defined class C
scala> ex1(new FunctionalTerm(new B), new C)
res0: A = C@4ceeb514 
```

请注意推断的结果类型（相当于`R`原始更复杂定义的 ）......它是and`A`的 LUB 。`B``C`

现在翻转的版本是微不足道的，只是工作，

```
scala> def ex2[T <: Term](s : T, t1 : FunctionalTerm[T]) : T = s
ex2: [T <: Term](s: T, t1: FunctionalTerm[T])T

scala> ex2(new C, new FunctionalTerm(new B))
res1: A = C@522ddcec 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-16T18:20:18.057

我将简化您的示例（我使用的是 2.9.1）：

```
scala> trait Term; case class FunctionalTerm[+T <: Term](t: T) extends Term;
defined trait Term
defined class FunctionalTerm

scala> def ex1[T1 <: Term, T3 <: X, FunctionalTerm[T1] <: X, X <: R, R <: Term](t1: FunctionalTerm[T1], s: T3): R = sys.error("TODO")
ex1: [T1 <: Term, T3 <: X, FunctionalTerm[T1] <: X, X <: R, R <: Term](t1: FunctionalTerm[T1], s: T3)R 
```

现在声明第二种方法：

```
scala> def ex2[T2 <: Term, T3 <: X, FunctionalTerm[T2] <: X, X <: R, R <: Term](s: T3, t2: FunctionalTerm[T2]): R = ex1(t2, s)
<console>:11: error: inferred type arguments [T2,T3,FunctionalTerm,T3,T3] do not conform to method ex1's type parameter bounds [T1 <: Term,T3 <: X,FunctionalTerm[T1] <: X,X <: R,R <: Term]
       def ex2[T2 <: Term, T3 <: X, FunctionalTerm[T2] <: X, X <: R, R <: Term](s: T3, t2: FunctionalTerm[T2]): R = ex1(t2, s)
                                                                                                                    ^ 
```

*可疑*的事情（对我来说）是推断的类型`[T2,T3,FunctionalTerm,T3,T3]`- 特别是`FunctionalTerm`. `FunctionalTerm`是一个*类型构造函数* `* -> *`，但是该方法需要`*`在这个位置有一个类型。

我会说这（可能）是一个错误，因此您应该将其提交给 scala-user 邮件列表（在提出票证之前） - **Adriaan Moors**和**Miles Sabin**更有可能对我是否有详细的答案米对。

# c# - 上传的文件未发布

> ID：10623894
> 
> 赞同：1
> 
> 时间：2012-05-16T17:48:37.900
> 
> 标签：c#, javascript, forms, post, file-upload

我正在使用下面的上传表单发布到使用下面的代码处理文件的页面。但是，该文件未显示。我得到计数​​ 0，没有发布任何文件....我在表单帖子中遗漏了什么吗？我知道上传文件时必须使用什么是相当具体的。我还在下面提供了更多信息。

形式

```
<form id="importform" method="POST" target="uploadframe" enctype="multipart/form-data" action="AJAX/Import_Subprocess_Content/RAC_Connolly_ImportSession.aspx">
                                        <input type="file" id="importfile" onchange="fileselected()"/>
                                        <input type="button" value="Import File" onclick="uploadfile();" />
                                    </form> 
```

服务器端代码

```
 protected void Page_Load()
        {
            Response.Write(Request.Files.Count);
        } 
```

更多信息

该表格是通过 javascript 使用`.submit()`

文件输入是`visibility:hidden`

按钮首先调用`click()`文件输入的

`onchange`文件输入调用`submit()`表单的

**更新**：尝试删除隐藏属性，但没有解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:38:19.297

您实际上并没有进行文件上传。您需要将代码添加到“导入文件”按钮。

此代码查看文件字段，检查它是否有文件，然后说只能上传 CSV 类型。然后它继续将文件保存到 Web 服务器上的 /datafiles 文件夹中。

```
protected void btnUpload_Click(object sender, EventArgs e)
    {
        if (file.HasFile)
        {
            try
            {
                if (file.PostedFile.ContentType == "application/octet-stream")
                {
                    string filename = Path.GetFileName(file.FileName);
                    file.SaveAs(Server.MapPath("~/datafiles/") + filename);
                    lblStatus.ForeColor = Color.Green;
                    lblStatus.Text = "Upload status: File uploaded!";
                }
                else
                {
                    lblStatus.ForeColor = Color.Red;
                    lblStatus.Text = "Upload status: Only .CSV files are accepted! This is a " + file.PostedFile.ContentType + " file";
                }
            }
            catch (Exception ex)
            {
                lblStatus.ForeColor = Color.Red;
                lblStatus.Text = "Upload status: The file could not be uploaded. The following error occured: " + ex.Message;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T16:36:55.763

文件需要名称属性才能上传。当给定 name 属性时，IE7 会出现另一个问题，即在上传文件时无法通过 javascript 发布表单。必须默认使用提交按钮而不是 onchange 事件。

# c# - 使用需要角色在服务中获得权限的功能

> ID：10623899
> 
> 赞同：1
> 
> 时间：2012-05-16T17:48:55.153
> 
> 标签：c#, windows-services

我有很多服务，每个服务都有很多功能。几乎每个功能都需要当前用户执行它所需的特定“角色”。

有没有比将以下代码放在每个方法的开头更好的方法？如果我可以用 Attributes 装饰这些方法，那就太好了，但我不确定如何在这里应用它们。

```
public void CreateTruck(TruckDto dto)
{
    var currentUser = GetCurrentUser();
    if (!currentUser.Can("CreateTruck"))
        throw PermissionException("...");

    // otherwise proceed normally
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:12:04.720

我看到这种情况有两种方式：

1 - 你没有改变任何东西，或者只是让它变得简单：

```
EnsureUserCan("CreateTruck"); 
```

内部有这个方法调用：

```
protected void EnsureUserCan(string role)
{
    if(!GetCurrentUser().Can(role))
       throw PermissionException("...");
} 
```

2 - 您转向调用者模式：

```
var myNewTruck = ServiceInvoker.Invoke<TruckService>(x => x.CreateTruck(dto));

public class ServiceInvoker
{
    public ReturnType Invoke<ServiceType, ReturnType>(Expression<Func<ServiceType, ReturnType>> methodExpression)
    {
        // blah blah
        var myService = IoC.Resolve<ServiceType>();

        return methodExpression.Compile()(myService); // etc
    }
} 
```

并且您的调用方法检查属性的表达式，因此可以基于属性抛出异常。不过，这似乎有点矫枉过正。

# iphone - 表格视图变为水平视图

> ID：10623902
> 
> 赞同：1
> 
> 时间：2012-05-16T17:49:08.830
> 
> 标签：iphone, ios, animation, ios5

我需要在横向模式下将表格视图从状态栏顶部设置为中心，但表格视图会自动转向水平，即从右到左开始。我究竟做错了什么？这是我的代码

```
- (IBAction)pressToGetTableview:(id)sender
{
tableViewhavingOptions.frame =self.view.frame;
tableViewhavingOptions.center = CGPointMake(self.view.center.x -   
CGRectGetWidth(self.view.frame), self.view.center.y );
[self.view.superview addSubview: tableViewhavingOptions];

[UIView beginAnimations: nil context: NULL];
[UIView setAnimationDuration:1.0];
[UIView setAnimationDelegate: self];
[UIView setAnimationDidStopSelector: @selector(pushAnimationDidStop:finished:context:)];
tableViewhavingOptions.center = self.view.center;
self.view.center = CGPointMake(self.view.center.x + CGRectGetWidth(self.view.frame), self.view.center.y );
[UIView commitAnimations];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:27:22.453

检查以查看视图控制器的方向

这可以通过使用来完成

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations.. use specified orientations that you want to see in the view

    return (interfaceOrientation != UIInterfaceOrientationLandscapeLeft || interfaceOrientation != UIInterfaceOrientationLandscapeRight);
} 
```

并且还有一种方法可以在项目属性中执行此操作..您可以在项目设置窗口中设置方向

希望这能解决问题.. :)

# javascript - 如何在页面加载后生成元素上的 jQuery UI 属性？

> ID：10623904
> 
> 赞同：0
> 
> 时间：2012-05-16T17:49:11.807
> 
> 标签：javascript, jquery, jquery-ui

当使用 jQuery 移动框架时，许多简单的元素会在页面加载期间添加特殊属性以使它们看起来更漂亮。我希望能够向我的页面添加新元素，但让这些元素具有所有适当的属性。我目前正在加载页面，然后进行 ajax 调用以检索一些数据并使用该数据在页面上创建新元素，但是当我这样做时，它们不会生成属性。我该如何进行这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:53:29.433

您可以在 AJAX 调用完成后初始化它们。大多数小部件都有关联的 jQuery 插件功能，类似于常规的 jQuery 插件。

示例 - textinput 具有关联的 textinput 函数

```
$('input').textinput(); 
```

# android - 使用文本在按钮中缩放 drawableLeft

> ID：10623906
> 
> 赞同：6
> 
> 时间：2012-05-16T17:49:12.740
> 
> 标签：android, button, drawable, scaling

我有一个带有文本的按钮，左侧有一个drawable。有什么办法可以使可绘制的比例达到适当的大小（填充按钮的高度），同时保持其纵横比？

我的布局的相关摘录：

```
 <Button 
            android:text="@string/add_fav"
            android:id="@+id/event_fav_button"
            android:layout_width="match_parent"
            android:layout_height="40dp"
            android:drawableLeft="@drawable/star_yellow"/> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-21T09:59:38.057

您可以根据按钮的尺寸调整图像的大小，使用`getHeight()`和`getWidth()`方法来获取按钮的大小，并使用以下函数调整按钮的图像大小：

## 调整位图大小：

```
public Bitmap getResizedBitmap(Bitmap bm, int newHeight, int newWidth) {

int width = bm.getWidth();

int height = bm.getHeight();

float scaleWidth = ((float) newWidth) / width;

float scaleHeight = ((float) newHeight) / height;

// create a matrix for the manipulation

Matrix matrix = new Matrix();

// resize the bit map

matrix.postScale(scaleWidth, scaleHeight);

// recreate the new Bitmap

Bitmap resizedBitmap = Bitmap.createBitmap(bm, 0, 0, width, height, matrix, false);

return resizedBitmap;

} 
```

* * *

现在为您的按钮使用这个调整大小的图像。 [参考](http://thinkandroid.wordpress.com/2009/12/25/resizing-a-bitmap/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T09:52:21.193

你可以在图形中创建一个按钮（包含所有）吗？

或者你可以试试这个>> 1.采用宽度和高度与按钮大小相同的布局（相对或线性）。2\. 现在将图像视图和文本视图放入其中。3.使布局可点击..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-09T20:26:22.603

您可以在以下代码中使用由以下代码组成的函数`onCreate()`：

```
 //get left drawable
    Drawable drawable = btn.getCompoundDrawables()[0];
    int imgHeight = drawable.getIntrinsicHeight();
    int imgWidth = drawable.getIntrinsicWidth();
    //for dpToPixel look here: https://stackoverflow.com/a/6327095/2306907
    float scale = (float) (dpToPixel(40)) / imgHeight;
    Rect rect = drawable.getBounds();
    int newWidth = (int)(imgWidth * scale);
    int newHeight = (int)(imgHeight * scale);
    rect.left = rect.left + (int)(0.5 * (imgWidth - newWidth)); 
    rect.top = rect.top + (int)(0.5 * (imgHeight - newHeight));
    rect.right = rect.left + newWidth;
    rect.bottom = rect.top + newHeight;
    drawable.setBounds(rect); 
```

或者看看[这个答案](https://stackoverflow.com/a/32479741/2306907)，它试图给出一个“通用”的解决方案。

# powershell - Powershell中的空值合并

> ID：10623907
> 
> 赞同：140
> 
> 时间：2012-05-16T17:49:16.387
> 
> 标签：powershell, null-coalescing-operator

powershell中是否有空合并运算符？

我希望能够在 powershell 中执行这些 c# 命令：

```
var s = myval ?? "new value";
var x = myval == null ? "" : otherval; 
```

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2012-05-17T19:40:39.630

# 电源外壳 7+

[Powershell 7](https://docs.microsoft.com/en-gb/powershell/scripting/whats-new/what-s-new-in-powershell-70?view=powershell-7#null-coalescing-assignment-and-conditional-operators)在 Powershell 中引入了原生空值合并、空值条件赋值和三元运算符。

**空值合并**

```
$null ?? 100    # Result is 100

"Evaluated" ?? (Expensive-Operation "Not Evaluated")    # Right side here is not evaluated 
```

**空条件赋值**

```
$x = $null
$x ??= 100    # $x is now 100
$x ??= 200    # $x remains 100 
```

**三元运算符**

```
$true  ? "this value returned" : "this expression not evaluated"
$false ? "this expression not evaluated" : "this value returned" 
```

* * *

# 之前的版本：

不需要 Powershell 社区扩展，您可以使用标准的 Powershell if 语句作为表达式：

```
variable = if (condition) { expr1 } else { expr2 } 
```

因此，替换您的第一个 C# 表达式：

```
var s = myval ?? "new value"; 
```

成为以下之一（取决于偏好）：

```
$s = if ($myval -eq $null) { "new value" } else { $myval }
$s = if ($myval -ne $null) { $myval } else { "new value" } 
```

或者根据 $myval 可能包含的内容，您可以使用：

```
$s = if ($myval) { $myval } else { "new value" } 
```

第二个 C# 表达式以类似的方式映射：

```
var x = myval == null ? "" : otherval; 
```

变成

```
$x = if ($myval -eq $null) { "" } else { $otherval } 
```

现在说句公道话，这些都不是很灵活，而且远没有 C# 表单那么舒服。

您也可以考虑将其包装在一个非常简单的函数中以使内容更具可读性：

```
function Coalesce($a, $b) { if ($a -ne $null) { $a } else { $b } }

$s = Coalesce $myval "new value" 
```

或者可能是 IfNull：

```
function IfNull($a, $b, $c) { if ($a -eq $null) { $b } else { $c } }

$s = IfNull $myval "new value" $myval
$x = IfNull $myval "" $otherval 
```

如您所见，一个非常简单的函数可以为您提供相当多的语法自由。

更新：要考虑的一个额外选项是更通用的 IsTrue 函数：

```
function IfTrue($a, $b, $c) { if ($a) { $b } else { $c } }

$x = IfTrue ($myval -eq $null) "" $otherval 
```

然后结合这就是 Powershell 声明看起来有点像运算符的别名的能力，你最终得到：

```
New-Alias "??" Coalesce

$s = ?? $myval "new value"

New-Alias "?:" IfTrue

$ans = ?: ($q -eq "meaning of life") 42 $otherval 
```

显然，这不会符合每个人的口味，但可能是您正在寻找的。

正如 Thomas 所指出的，C# 版本与上述版本之间的另一个细微差别是 C# 执行参数的短路，但涉及函数/别名的 Powershell 版本将始终评估所有参数。如果这是一个问题，请使用`if`表达式形式。

* * *

## 回答 #2

> 赞同：99
> 
> 时间：2013-07-15T06:15:16.653

## PowerShell 7 及更高版本

PowerShell 7 引入了许多新功能并从 .NET Framework 迁移到 .NET Core。截至 2020 年年中，由于对 .NET Core 的依赖，它还没有完全取代旧版本的 PowerShell，但微软表示他们打算让 Core 系列最终取代旧的 Framework 系列。当您阅读本文时，您的系统中可能已预装了兼容版本的 PowerShell；如果没有，请参阅[https://github.com/powershell/powershell](https://github.com/powershell/powershell)。

根据[文档](https://docs.microsoft.com/en-us/powershell/scripting/whats-new/what-s-new-in-powershell-70?view=powershell-7#null-coalescing-assignment-and-conditional-operators)，PowerShell 7.0 支持以下开箱即用的运算符：

1.  [空合并](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_operators?view=powershell-7#null-coalescing-operator-)：`??`
2.  [空合并赋值](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_operators?view=powershell-7#null-coalescing-assignment-operator-)：`??=`
3.  [三元](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_operators?view=powershell-7#ternary-operator--if-true--if-false)：`... ? ... : ...`

这些工作与您对空值合并的期望一样：

```
$x = $a ?? $b ?? $c ?? 'default value'
$y ??= 'default value' 
```

由于引入了三元运算符，现在可以进行以下操作，尽管由于添加了空合并运算符，所以没有必要：

```
$x = $a -eq $null ? $b : $a 
```

[从 7.0 开始，如果启用](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_experimental_features?view=powershell-7)`PSNullConditionalOperators`了可选功能，则以下内容也可用，如文档（[1、2](https://docs.microsoft.com/en-gb/powershell/scripting/whats-new/what-s-new-in-powershell-70?view=powershell-7#null-conditional-member-access-operators--and--experimental) [）](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_operators?view=powershell-7#null-conditional-operators--and-)中所述：

1.  成员的空条件成员访问：`?.`
2.  数组等的空条件成员访问：`?[]`

这些有一些警告：

1.  由于这些是实验性的，因此它们可能会发生变化。当您阅读本文时，它们可能不再被认为是实验性的，并且警告列表可能已更改。
2.  如果变量后面跟有实验运算符之一，则必须将变量括起来，`${}`因为变量名称中允许使用问号。目前尚不清楚如果/当功能从实验状态毕业时是否会出现这种情况（请参阅[问题 #11379](https://github.com/PowerShell/PowerShell/issues/11379)）。例如，`${x}?.Test()`使用 new 运算符，但在名为 的变量上`$x?.Test()`运行。`Test()``$x?`
3.  `?(`如果您来自 TypeScript，则没有您可能期望的运算符。以下将不起作用：`$x.Test?()`

## PowerShell 6 及更早版本

PowerShell 7 之前的版本确实有一个实际的空合并运算符，或者至少有一个能够执行这种行为的运算符。该运算符是`-ne`：

```
# Format:
# ($a, $b, $c -ne $null)[0]
($null, 'alpha', 1 -ne $null)[0]

# Output:
alpha 
```

它比 null 合并运算符更通用，因为它创建了一个包含所有非 null 项的数组：

```
$items = $null, 'alpha', 5, 0, '', @(), $null, $true, $false
$instances = $items -ne $null
[string]::Join(', ', ($instances | ForEach-Object -Process { $_.GetType() }))

# Result:
System.String, System.Int32, System.Int32, System.String, System.Object[],
System.Boolean, System.Boolean 
```

`-eq`类似地工作，这对于计算空条目很有用：

```
($null, 'a', $null -eq $null).Length

# Result:
2 
```

但无论如何，这是一个镜像 C# 运算符的典型案例`??`：

```
'Filename: {0}' -f ($filename, 'Unknown' -ne $null)[0] | Write-Output 
```

### 解释

*此解释基于匿名用户的编辑建议。谢谢，不管你是谁！*

根据操作顺序，这按以下顺序工作：

1.  运算符创建要测试的`,`值数组。
2.  `-ne`运算符从数组中过滤出任何与指定值匹配的项目——在本例中为 null 。结果是一个非空值数组，其顺序与步骤 1 中创建的数组的顺序相同。
3.  `[0]`用于选择过滤数组的第一个元素。

简化：

1.  按首选顺序创建可能值的数组
2.  从数组中排除所有空值
3.  从结果数组中取出第一项

### 注意事项

与 C# 的 null 合并运算符不同，每个可能的表达式都将被计算，因为第一步是创建一个数组。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-01-03T10:50:03.927

这只是问题前半部分的一半答案，所以如果你愿意，可以回答四分之一，但是如果你想要使用的默认值实际上是类型的默认值，那么 null 合并运算符有一个更简单的替代方法：

```
string s = myval ?? ""; 
```

可以在 Powershell 中写为：

```
([string]myval) 
```

或者

```
int d = myval ?? 0; 
```

转换为 Powershell：

```
([int]myval) 
```

在处理可能不存在的 xml 元素时，我发现其中的第一个很有用，如果它确实存在，它周围可能会有不需要的空格：

```
$name = ([string]$row.td[0]).Trim() 
```

强制转换为字符串可防止元素为 null 并防止任何`Trim()`失败的风险。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2017-10-21T13:24:13.767

`$null, $null, 3 | Select -First 1`

返回

`3`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-05-16T18:07:30.593

如果您安装了[Powershell 社区扩展模块](http://pscx.codeplex.com/)，那么您可以使用：

?? 是 Invoke-NullCoalescing 的别名。

```
$s = ?? {$myval}  {"New Value"} 
```

?: 是 Invoke-Ternary 的别名。

```
$x = ?: {$myval -eq $null} {""} {$otherval} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-10-22T16:01:49.573

最后，PowerShell 7 获得了[Null Coalescing 赋值运算符](https://github.com/PowerShell/PowerShell/pull/10636)！

```
PS > $null ?? "a"
a
PS > "x" ?? "y"
x
PS > $x = $null
PS > $x ??= "abc"
PS > $x
abc
PS > $x ??= "xyz"
PS > $x
abc 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-02-07T07:17:26.113

```
@($null,$null,"val1","val2",5) | select -First 1 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-08-29T00:05:20.147

```
function coalesce {
   Param ([string[]]$list)
   #$default = $list[-1]
   $coalesced = ($list -ne $null)
   $coalesced[0]
 }
 function coalesce_empty { #COALESCE for empty_strings

   Param ([string[]]$list)
   #$default = $list[-1]
   $coalesced = (($list -ne $null) -ne '')[0]
   $coalesced[0]
 } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-07-15T16:19:33.910

我经常发现在使用合并时我还需要将空字符串视为 null。我最终为此编写了一个函数，它使用[Zenexer](https://stackoverflow.com/a/17647824/222134)的解决方案来合并简单的空合并，然后使用[Keith Hill](https://stackoverflow.com/a/13747939/222134)的空或空检查，并将其添加为标志，以便我的函数可以同时执行这两项操作。

此函数的优点之一是，它还可以处理所有元素为空（或为空），而不会引发异常。由于 PowerShell 处理数组输入的方式，它还可以用于任意多个输入变量。

```
function Coalesce([string[]] $StringsToLookThrough, [switch]$EmptyStringAsNull) {
  if ($EmptyStringAsNull.IsPresent) {
    return ($StringsToLookThrough | Where-Object { $_ } | Select-Object -first 1)
  } else {
    return (($StringsToLookThrough -ne $null) | Select-Object -first 1)
  }  
} 
```

这会产生以下测试结果：

```
Null coallesce tests:
1 (w/o flag)  - empty/null/'end'                 : 
1 (with flag) - empty/null/'end'                 : end
2 (w/o flag)  - empty/null                       : 
2 (with flag) - empty/null                       : 
3 (w/o flag)  - empty/null/$false/'end'          : 
3 (with flag) - empty/null/$false/'end'          : False
4 (w/o flag)  - empty/null/"$false"/'end'        : 
4 (with flag) - empty/null/"$false"/'end'        : False
5 (w/o flag)  - empty/'false'/null/"$false"/'end': 
5 (with flag) - empty/'false'/null/"$false"/'end': false 
```

测试代码：

```
Write-Host "Null coalesce tests:"
Write-Host "1 (w/o flag)  - empty/null/'end'                 :" (Coalesce '', $null, 'end')
Write-Host "1 (with flag) - empty/null/'end'                 :" (Coalesce '', $null, 'end' -EmptyStringAsNull)
Write-Host "2 (w/o flag)  - empty/null                       :" (Coalesce('', $null))
Write-Host "2 (with flag) - empty/null                       :" (Coalesce('', $null) -EmptyStringAsNull)
Write-Host "3 (w/o flag)  - empty/null/`$false/'end'          :" (Coalesce '', $null, $false, 'end')
Write-Host "3 (with flag) - empty/null/`$false/'end'          :" (Coalesce '', $null, $false, 'end' -EmptyStringAsNull)
Write-Host "4 (w/o flag)  - empty/null/`"`$false`"/'end'        :" (Coalesce '', $null, "$false", 'end')
Write-Host "4 (with flag) - empty/null/`"`$false`"/'end'        :" (Coalesce '', $null, "$false", 'end' -EmptyStringAsNull)
Write-Host "5 (w/o flag)  - empty/'false'/null/`"`$false`"/'end':" (Coalesce '', 'false', $null, "$false", 'end')
Write-Host "5 (with flag) - empty/'false'/null/`"`$false`"/'end':" (Coalesce '', 'false', $null, "$false", 'end' -EmptyStringAsNull) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-09-07T08:59:16.730

我能得到的最接近的是：`$Val = $MyVal |?? "Default Value"`

我为上述实现了[空合并运算符](https://gist.github.com/elonmallin/2cc2ae1b0f59e23451e87a10f4316ecf)，如下所示：

```
function NullCoalesc {
    param (
        [Parameter(ValueFromPipeline=$true)]$Value,
        [Parameter(Position=0)]$Default
    )

    if ($Value) { $Value } else { $Default }
}

Set-Alias -Name "??" -Value NullCoalesc 
```

[条件三元运算符](https://gist.github.com/elonmallin/ed5d912a22481ab9522d816497558d1f)可以以类似的方式实现。

```
function ConditionalTernary {
    param (
        [Parameter(ValueFromPipeline=$true)]$Value,
        [Parameter(Position=0)]$First,
        [Parameter(Position=1)]$Second
    )

    if ($Value) { $First } else { $Second }
}

Set-Alias -Name "?:" -Value ConditionalTernary 
```

并使用如下：`$Val = $MyVal |?: $MyVal "Default Value"`

# java - 我可以覆盖 Java 中的私有方法吗？

> ID：10623913
> 
> 赞同：14
> 
> 时间：2012-05-16T17:49:36.780
> 
> 标签：java, reflection, polymorphism, access-modifiers

我知道我可以使用反射来调用私有方法，并获取或设置私有变量的值，但我想覆盖一个方法。

```
public class SuperClass {

    public void printInt() {
        System.out.println("I am " + getClass() + ". The int is " + getInt());
    }

    private int getInt() {
        return 1;
    }
}

public class SubClass extends SuperClass {

    public static void main(String[] args) {
        (new SubClass()).printInt();
    }

    public int getInt() {
        return 2;
    }
} 
```

我想要 打印出来的`main`方法，但它打印出来。我听说这可以通过反思来完成，但我不知道怎么做。如果不是反射，有没有人知道另一种方法？（除了进行保护，或将方法复制并粘贴到.）如果实际上覆盖私有方法是不可能的，有没有办法在它上面放置某种触发器，它将在我的子类中调用一个方法之前或私有方法执行后？`SubClass``2``1``SuperClass.getInt()``printInt()``SubClass`

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-16T17:53:48.247

您不能覆盖私有方法，因为没有其他类（包括派生类）可以告诉它存在。它是*私人的。*

私有方法是隐式的`final`。

在相关的说明中，子类可以声明与超类中的字段或方法同名的`private`字段或方法，因为从子类的角度来看，这些成员不存在。这些成员之间没有特殊关系。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-05-16T18:09:58.647

私有方法不会被继承，也不能以任何方式被覆盖。谁告诉你你可以通过反思来做到这一点，要么是在撒谎，要么是在谈论其他事情。

`getInt`但是，您可以访问正在调用的任何子类的私有方法，`printInt`如下所示：

```
public void printInt() throws Exception {
    Class<? extends SuperClass> clazz = getClass();
    System.out.println("I am " + clazz + ". The int is " +
                       clazz.getMethod("getInt").invoke(this) );
} 
```

这将具有`getInt`从超类调用子类的方法的效果`printInt`。当然，如果子类*没有*声明 a ，现在这将失败`getInt`，因此您必须添加一个检查以能够处理不尝试“覆盖”私有方法的“正常”子类：

```
public void printInt() throws Exception {
    Class<? extends SuperClass> clazz = getClass();

    // Use superclass method by default
    Method theGetInt = SuperClass.class.getDeclaredMethod("getInt");

    // Look for a subclass method
    Class<?> classWithGetInt = clazz;
    OUTER: while( classWithGetInt != SuperClass.class ){

        for( Method method : classWithGetInt.getDeclaredMethods() )
            if( method.getName().equals("getInt") && method.getParameterTypes().length == 0 ){
                theGetInt = method;
                break OUTER;
            }

        // Check superclass if not found
        classWithGetInt = classWithGetInt.getSuperclass();
    }

    System.out.println("I am " + classWithGetInt + ". The int is " + theGetInt.invoke(this) );
} 
```

您仍然必须更改超类代码才能使其工作，并且由于您必须更改超类代码，您应该只将访问修饰符更改为`getInt`，`protected`而不是进行反射修改。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-05-16T18:20:50.427

不，你不能。您可以构建一个*看起来*应该能够做到这一点的程序，使用外部类中的代码可以访问嵌套类的私有成员这一事实。但是，私有方法实际上仍然不能被覆盖。例子：

```
public class Test {

    public static class Superclass {
        private void foo() {
            System.out.println("Superclass.foo");
        }
    }

    public static class Subclass extends Superclass {
        private void foo() {
            System.out.println("Subclass.foo");
            // Looks like it shouldn't work, but does...
            super.foo();
        }
    }

    public static void main(String[] args) throws Exception {
        Superclass x = new Subclass();
        // Only calls Superclass.foo...
        x.foo();
    }
} 
```

鉴于这将是*唯一*可以覆盖私有方法的情况，因此不支持它并不是什么大损失。

如果你想改变你的超类的私有成员的行为，你的设计基本上就被破坏了。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-27T17:49:52.293

我无法通过反射来做到这一点，但我已经找到了一种通过仪器来做到这一点的方法。[正如Dhruba Bandopadhyay 的博客](http://dhruba.name/2010/02/07/creation-dynamic-loading-and-instrumentation-with-javaagents)上所建议的那样，我使用了 ASM 。有兴趣的可以看一下[我的代码](https://sites.google.com/site/numberslonger/gate_crasher_source)（这里写的太多了）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-16T18:30:39.923

如果您真的想使用反射来做到这一点，您可以：

```
public class SuperClass {

    private final Method getInt;

    public SuperClass() {
        /** Find the appropriate method to call and cache it. **/
        Method getInt = null;
        try {
            getInt = getClass().getDeclaredMethod("getInt");
        }
        catch (NoSuchMethodException e) {
            try {
                getInt = SuperClass.class.getDeclaredMethod("getInt");
            } catch (NoSuchMethodException e1) {
                throw new RuntimeException(e1);
            }
        }
        getInt.setAccessible(true);
        this.getInt = getInt;
    }

    public void print() {
        int val = 0;
        try {
            val = (Integer) getInt.invoke(this);
        } catch (IllegalAccessException e) {
            throw new RuntimeException(e);
        } catch (InvocationTargetException e) {
            throw new RuntimeException(e);
        }
        System.out.println(val);
    }

    private int getInt() {
        return 1;
    }
}

public class SubClass extends SuperClass {
    public int getInt() {
        return 2;
    }

    public static void main(String[] args) throws Exception {
        new SubClass().print();
    }
} 
```

我怀疑您想以不同的方式设计程序，而不是采用这种方法。它不是高性能的，它肯定会让任何扩展 SuperClass 的人大吃一惊。

请注意，如果您以这种方式使用反射，则子类的 getInt() 方法可以是私有的。同样，至少出于上述两个原因，采用这种方法几乎绝对是一个坏主意。您有可能以另一种方式实现您的目标。包保护真的不行吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-05T09:34:19.377

你可以通过引用传递 var -> 使用 java 的类吗？

因为如果可能的话：上面的问题可以重写为：

（请注意，这仅用于规范目的）

VB：

function(ByRef intX as Integer) //值可以显式更改，但方法本身不能：P end function

这么多，我猜...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-10T23:49:32.580

您不能覆盖私有方法。

覆盖方法只能存在于被覆盖方法的子类中。如果您要覆盖的方法被标记为**private**，则无法覆盖它，因为子类不继承任何标记为**private**的东西，从而切断了该私有方法与子类中的任何东西之间的联系，包括任何子类的方法。

“覆盖”意味着允许 JVM 根据您调用它的实例类型来确定要使用的方法。多态性理论解释了是什么使这成为可能。为了让 JVM 能够说“这些方法是连接的，一个覆盖另一个”，JVM 必须能够从包含*覆盖*方法**的子类中查看被***覆盖*的方法。

话虽如此，您提供的案例中的类仍然可以编译，但是这两个方法都不会基于 JVM 独立运行基于实例的调用来调用。它们只是完全不同的方法，无法被 JVM 识别为被覆盖或覆盖。

此外，如果您使用的是诸如 NetBeans 之类的 IDE，则使用 @Override 注释将指示编译器您正在覆盖超类中具有相同签名的方法。如果您不这样做，您将收到一条警告，建议您进行注释。但是，如果在以下情况下应用此注解，则会出现编译错误：

*   超类中没有具有匹配签名的方法

或者

*   您尝试覆盖的超类中的方法被标记为 **私有**或**最终的**

有关以下摘录，请参阅 Oracle 官方文档**[https://docs.oracle.com/javase/tutorial/java/IandI/override.html ：](https://docs.oracle.com/javase/tutorial/java/IandI/override.html)**

> ## **实例方法**
> 
> ...子类覆盖方法的能力允许类从行为“足够接近”的超类继承，然后根据需要修改行为......当覆盖方法时，您可能希望使用 @覆盖注释，指示编译器您打算覆盖超类中的方法。如果由于某种原因，编译器检测到某个超类中不存在该方法，那么它将产生错误。

覆盖可能非常令人困惑，因为它涉及看似独立的 JVM 采取行动。请记住，如果无法访问超类中的方法[s]（换句话说，对于所有标记为**private**的方法），子类就无法调用或覆盖所述方法[s]，因为它无法继承它们来这样做.

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-05-24T17:42:56.407

不，我们不能覆盖私有方法，但是在某些情况下我们也可以覆盖私有方法，即内部类

```
class PrivateTest { 

private String msg = "OuterAndInner";

private void fun() {
     System.out.println("Outer fun()");
}

class Inner extends PrivateTest {
    private void fun()  {
          System.out.println("Accessing Private Member of Outer: " + msg);
    }
}
public static void main(String args[])  {
     PrivateTest o = new PrivateTest();
     Inner  i   = o.new Inner();
     i.fun();
     // o.fun() calls Outer's fun (No run-time polymorphism).
     o = i; 
     o.fun();
} 
```

}

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2016-01-28T21:53:04.150

您不能覆盖私有方法，但可以在派生类中引入/重新定义一个方法。例如：

```
class Super
{
   private void fun()
   {
   }
}

class Child extends Super
{
    private void fun()
    {
    }
} 
```

在这种情况下，您没有在 Child 类中覆盖这个 fun()，而是定义了一个具有相同名称的新方法，但是如果您尝试在 Child 类的 fun() 顶部使用 @override，则会出现编译时错误，因为你被迫覆盖这个 fun() 否则你只是在 Child 类中重新定义新的 fun()

* * *

## 回答 #10

> 赞同：-5
> 
> 时间：2012-05-16T18:01:57.603

仔细阅读本文，

PRIVATE 方法不是继承的......因为它们不是继承的，所以它们不能被覆盖

# c# - 使用 HttpWebRequest 传输到 ftp 站点

> ID：10623919
> 
> 赞同：3
> 
> 时间：2012-05-16T17:49:51.840
> 
> 标签：c#, .net, visual-studio, ftp, sftp

我正在尝试将 Excel 文件传输到 sftp 站点，并且我的代码可以正常执行，但我在站点上看不到该文件。

```
private static void SendFile(string FileName)
{
    FileStream rdr = new FileStream(FileName + ".csv", FileMode.Open);
    HttpWebRequest req = (HttpWebRequest)WebRequest.Create("http://sftp.somesite.com");
    HttpWebResponse resp;
    req.Method = "Post";
    req.Credentials = new NetworkCredential("UN", "PW", "Domain");

    req.ContentLength = rdr.Length;
    req.AllowWriteStreamBuffering = true;
    Stream reqStream = req.GetRequestStream();
    byte[] inData = new byte[rdr.Length];
    int bytesRead = rdr.Read(inData, 0, Convert.ToInt32(rdr.Length));

    reqStream.Write(inData, 0, Convert.ToInt32(rdr.Length));
    rdr.Close();
} 
```

我在上面的代码中做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T17:51:43.007

你为什么不改用 FtpWebRequest 呢？

```
using System.Net;
using System.IO;

public class Ftp
{
  private static void ftpUpload(string filename, string destinationURI)
  {
        FileInfo fileInfo = new FileInfo(filename);
        FtpWebRequest reqFTP = CreateFtpRequest(new Uri(destinationURI));

        reqFTP.KeepAlive = false;

        // Specify the command to be executed.
        reqFTP.Method = WebRequestMethods.Ftp.UploadFile;

        // use binary 
        reqFTP.UseBinary = true;

        reqFTP.ContentLength = fileInfo.Length;

        // Buffer size set to 2kb
        const int buffLength = 2048;
        byte[] buff = new byte[buffLength];

        // Stream to which the file to be upload is written
        Stream strm = reqFTP.GetRequestStream();

        FileStream fs = fileInfo.OpenRead();

        // Read from the file stream 2kb at a time
        int cLen = fs.Read(buff, 0, buffLength);

        // Do a while till the stream ends
        while (cLen != 0)
        {
            // FTP Upload Stream
            strm.Write(buff, 0, cLen);
            cLen = fs.Read(buff, 0, buffLength);
        }

        // Close 
        strm.Close();
        fs.Close();
   }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:07:59.350

正如尤金在[#3中所说](http://sshnet.codeplex.com/)

当您说“SFTP”时，您是指基于 SSL 的 FTP 还是 SSH 文件传输协议。他们需要不同的方法。如果您确实在使用 SFTP，例如在 SSH 文件传输中，我认为您最好使用第三方库（如果可以的话），例如 sharpSSH。（http://sshnet.codeplex.com/）

SFTP 上的 Wiki - [http://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol](http://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T17:59:48.673

1.  Post 不放文件。它将数据发送到服务器端脚本。
2.  这是完整的网址吗？以“http://”开头的域名不是有效的 URI，它必须包含路径和资源名称。
3.  URL 中的“sftp”可能表明必须使用 SSH 文件传输协议 (SFTP)，而不是 FTP 或 HTTP
4.  谁说上传到 FTP 资源会这样工作？

# javascript - 计算下拉列表价格

> ID：10623924
> 
> 赞同：0
> 
> 时间：2012-05-16T17:50:23.490
> 
> 标签：javascript, jquery, html, drop-down-menu

如果我在正确命名事物方面偏离了标准，请原谅我。

我有一个多个下拉列表在选择每个选项后计算价格，在所有列表的末尾，我有一个总金额，每次都加起来，但我希望最后一个下拉列表将总金额折扣 % 不添加给它。

价格来自mysql，折扣也来自mysql，这是我用来获取价格的代码

```
$(function(){
    $(".calculate").on("change", function(){
        var total = 0;
        $('.calculate').each(function() {
            if($(this).val() != 0) {
                total += parseFloat($(this).val());
            }
        });
        $('#total').text('£' + total.toFixed(2));
    });

});//]]> 
```

我认为这与`total += parseFloat($(this).val());`. 我认为通过替换`+`它`/`会起作用，但什么也没有？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T18:04:48.827

可能是这样的：

```
$(function(){
   $(".calculate").on("change", function(){
       var total = 0;
       var discount_amount = define_value;
       $('.calculate').each(function() {
           if($(this).val() != 0) {
               discount_amount = $(this).val() * discount_variable;
               line_total = $(this).val() - discount_amount;
               total += parseFloat(line_total);
           }
       });
       $('#total').text('£' + total.toFixed(2));
});

});//]]> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:29:28.140

首先，我会从将要进行**折扣**`calculate`的课程中删除该课程，并将其分配给，这是一个示例：`<select>`**`id="discount"``<select>`**

 **```
<select id="discount" name="select-3">
    <option value="0">Select Discount Amount</option>
    <option value="10%">10%</option>
    <option value="20%">20%</option>
    <option value="50%">50%</option>
</select> 
```

然后，当`#discount`或任何元素发生更改时，首先循环并在应用折扣之前将`.calculate`所有元素的总数与 class 相加，如下所示：`calculate`

```
$(function(){
    $(".calculate, #discount").on("change", function(){
        var total = 0;
        $('.calculate').each(function() {
            if($(this).val() != 0) {
                total += parseFloat($(this).val());
            }
        });
        if($('#discount').val() != 0) {
          total = total * ((100 - parseFloat($('#discount').val())) / 100);
        }
        $('#total').text('£' + total.toFixed(2));
    });
}); 
```

这是一个[小提琴](http://jsfiddle.net/qCjM2/)**

# java - 字符串的高效索引以进行全文索引

> ID：10623925
> 
> 赞同：0
> 
> 时间：2012-05-16T17:50:26.160
> 
> 标签：java, string, algorithm, data-structures, indexing

我正在寻找一种数据结构来解决以下问题。接收大量相当短的字符串（例如 5000 万，少于 30 个字符）作为输入，并根据需要对它们进行索引。然后，回答我给出一个新字符串的查询，并且您提供与提供的字符串相似的初始集合中的字符串（例如，10 个最好的此类字符串）。“相似性”的概念理想地是类似于编辑距离或 Jaro-Winkler 距离，或其近似值，但它应该能够适应拼写和词序的微小变化，以及添加垃圾词。（例如，与标准索引任务不同，如果请求“foo bar”确实是集合中最接近的字符串，则它应该产生“foo”）。

举个例子，假设字符串集合是 {"Charles Dickens", "Mary Shelley", "Robert Stephenson"}。查询“狄更斯，查尔斯”应该找到“查尔斯狄更斯”。查询“by Shelley”应返回“Mary Shelley”。

逐一计算查询字符串与集合中所有字符串的相似性的简单方法对于大型集合来说太慢了。什么是更有效地回答此类查询的好数据结构？理想情况下，我会寻找一个好的 Java 实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:17:10.227

作为琐碎方法的替代方法，您可以分两步解决问题：

1.  建立一个出现在所有字符串中的单词索引，它允许您找到包含给定单词的句子。这应该远小于 5000 万（如果我们谈论的是自然语言）。而且您可能不关心“foop bar”->“foo”，因为您只有单词。
2.  将您的查询拆分为单词。对于每个单词，找到包含该单词的所有句子。对于每个句子，使用您的指标计算与查询字符串的相似度。

另一个好处是，在许多情况下，您可以在不重建单词索引的情况下更改指标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:47:08.980

想到两个建议：

1）选择一个满足三角不等式的距离函数并使用[http://en.wikipedia.org/wiki/Cover_tree](http://en.wikipedia.org/wiki/Cover_tree) - 可能会提供一些加速但可能不是数量级。

2）猜测最接近的匹配将包括至少一段 k 连续字符，这是两个字符串之间的精确匹配。构建一个数据结构，例如使用哈希表查找可以找到集合中的所有字符串，这些字符串至少具有与查询字符串的某些部分相同的 k 个连续字符，然后使用您的距离函数查看从哪个字符串返回这是最好的比赛。应该很快，但有时会错过正确的答案。

# javascript - 如何在没有 window.location.reload() 的情况下使 JavaScript .load 工作

> ID：10623927
> 
> 赞同：0
> 
> 时间：2012-05-16T17:50:32.557
> 
> 标签：javascript, jquery, vxworks

我正在尝试使用 .load 轮询来自服务器的特定元素 ID，但只有当我使用 window.location.reload() 跟随 .load 时，才会更新该元素。

具体来说，该元素是 vxworks 服务器每秒更新一次的 vxworks windmark 元素*，浏览器应读取并显示该元素。

页面上的元素：

```
<span id="general_response_windmark_id" >$%general_response_windmark#$</span> 
```

在页面末尾我做：

```
setInternval( 'foo()', 1000 )    // to re-display once a second 
```

不工作：...

```
function foo()
{
    windmark_field_id = 'general_response_windmark_id'
    $('#' + windmark_field_id).load(' #' + windmark_field_id);
} 
```

作品：...

```
function foo()
{
    windmark_field_id = 'general_response_windmark_id'
    $('#' + windmark_field_id).load(' #' + windmark_field_id);
    window.location.reload()
} 
```

*   *   vxworks 服务器将“$%general_response_windmark#$”替换为不断变化的数字字符串。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:06:22.420

将您的`<span>`标签放在一个单独的 HTML 文档中（如果您愿意，可以单独放置），然后使用 jQuery 加载它：

```
function foo() {
    var wfid = 'general_response_windmark_id';
    $('#' + wfid).load('external-span-page.html #' + wfid);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T18:02:45.713

我认为

```
 $('#' + windmark_field_id).load(' #' + windmark_field_id); 
```

语句有错误。

因为在`.load()`第一个参数中是一个 url，据我所知，一个 url 不能以`#`符号开头。

重新检查您的 url 分配`.load()`，这将解决您的问题。

[阅读 .load()](http://api.jquery.com/load)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T20:51:10.893

答案：将完成函数参数添加到 .load 中，就在 URL 之后。

问题：我的原始代码正在执行 .load，然后立即从浏览器页面 DOM 中读取元素，即使 .load 尚未完成。使用 .load 的完成功能会等到它完成。

哈哈！

# php - 在一个页面上引用一个 SQL 查询 3 次，然后从该查询创建 3 个单独的循环？

> ID：10623932
> 
> 赞同：0
> 
> 时间：2012-05-16T17:50:51.323
> 
> 标签：php, sql, forms

我想要完成的是一个后端管理面板，有多个表单来编辑数据库中的表。

我想在页面上运行一个 SQL 查询，并多次引用它（**可能从同一个查询中创建 3 个不同的循环，而不必多次查询**）。

*如果可能的话，我无法弄清楚如何使查询在其初始循环之外工作*。

我已经有了适用于所有表单的 SQL 语句（因为基本上我的表单只是一遍又一遍地查询相同的 2 个表），但我不能多次使用它......我已经尝试过了，但是可以不要让它工作。

**我只想运行这个查询一次，并且只要我需要在页面上再次使用它就可以简单地引用它。**（也许通过创建一个新的*while*循环？试过了，不起作用。使用不同的变量？不起作用。我很想知道什么是......）

此管理面板是一个 PHP 页面，根据管理任务按隔间划分。

对于一些想法，它是这样的~

* * *

## // 上传照片 //

*（可用选项是...）*
- 上传照片
- 添加照片标题
**01.**选择类别**|| SQL查询！**LOOP **-**类别下拉列表
**02.**选择子类别**|| SQL查询！**循环**-**类别的复选框列表 + 子类别
- 添加标签
- 添加照片描述/评论

## // 管理类别 //

*（可用的选项是...）*
- 创建一个新的类别
**03.**删除多个类别**|| SQL查询！**LOOP **-**类别的复选框列表 + 每个条目的数量
**04.**重命名类别**|| SQL查询！**LOOP **-**类别列表
**05.**编辑子类别**|| SQL查询！**LOOP **-**子类别列表

* * *

依此类推……
如您所见，所做的所有查询都与类别相关。

我实际上已经完成了一个工作版本，但是一个页面上有太多的 SQL 查询（对于完全相同的表一遍又一遍），这似乎不切实际和轻率。必须有更好的方法...

我只想使用一次的查询（以及我现在正在使用的查询）是：

```
$sql = "SELECT category.id, category.name, COUNT(records.category_id) as number
FROM category
    LEFT OUTER
        JOIN records
        ON category.id = records.category_id
WHERE
    category.active = 1
GROUP
    BY category.id
ORDER
    BY category.name";
$result = mysql_query($sql);

while($rows = mysql_fetch_array($result)) {
    echo "SAMPLE LOOP" . $rows['id'] . $rows['name'] . $rows['number']; } 
```

有没有办法实现我想要实现的目标？
**感谢您的时间和智慧！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:55:28.927

将结果保存到一个新数组中，然后您可以在需要时对其进行迭代：

```
$sql = "SELECT category.id, category.name, COUNT(records.category_id) as number
FROM category
    LEFT OUTER
        JOIN records
        ON category.id = records.category_id
WHERE
    category.active = 1
GROUP
    BY category.id
ORDER
    BY category.name";
$result = mysql_query($sql);
$saved_results = array();
while($rows = mysql_fetch_array($result)) {
    echo "SAMPLE LOOP" . $rows['id'] . $rows['name'] . $rows['number']; 
    array_push($saved_results, $rows);
} 
```

然后随时随地：

```
foreach($saved_results as $res) {
  dostuff();
} 
```

# java - 在 Netbeans 中将 JPanel 添加到 JFrame

> ID：10623935
> 
> 赞同：2
> 
> 时间：2012-05-16T17:51:08.233
> 
> 标签：java, swing, user-interface, netbeans

我`JFrame`在 Netbeans 中创建了类并使用生成器添加了`jPanel`. 我也有类，它扩展了`JPanel`. 现在我想创建这个类的对象，并将他添加到我的面板所在的位置`JFrame`，但我找不到正确的方法，因为我正在尝试的所有内容都没有结果

```
public static void main(String args[]) {

    java.awt.EventQueue.invokeLater(new Runnable() {

        public void run() {
            Frame f  = new Frame();
            jPanel1  = new MyPanel();
            f.pack();
            f.setVisible(true);
        }
    }); 
```

好的，所以也许我会展示更精确的例子我在说什么：

## 第一个文件：

```
class MyPanel extends javax.swing.JPanel {
public MyPanel() {
        initComponents();

    }
} 
```

另一个文件，带有框架：

```
public class Frame extends javax.swing.JFrame {
public Frame() {
        initComponents();
}
public static void main(String args[]) {

        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                Frame f  = new Frame();
                MyPanel p = new MyPanel();
                jPanel1 = p;
            }
        });
    }
private javax.swing.JButton jButton1;
private javax.swing.JPanel jPanel1; 
```

我想在 jPanel1 - object MyPanel 的地方设置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T17:55:28.890

您的问题：您的`MyPanel`实例未添加到主框架。

解决方案：将您的`MyPanel`实例添加到主框架的内容窗格。

就像是：

```
JFrame f  = new JFrame();
MyPanel jPanel1  = new MyPanel();
f.getContentPane().add(jPanel1  );
f.pack();
f.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T18:03:28.860

以上答案是正确的 - 您需要将其实际添加`MyPanel`到 Frame 的 contentPane 中。

此外，您可能应该使用 Swing 而不是普通的 AWT。代码如下所示：

```
SwingUtilities.invokeLater(new Runnable() {

        @Override //annotation if you are using Java >= 1.5
        public void run() {
            JFrame f = new JFrame();
            MyPanel jPanel1 = new MyPanel();
            f.getContentPane().add(jPanel1);
            f.pack();
            f.setVisible(true);
        }
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-09T19:20:30.623

这是一个很棒的教程，它教授有关面板的所有内容。它教你如何创建一个包含 JPanel 的 JFrame。

[转到视频教程](http://www.youtube.com/watch?v=58SxlPK1Qss)

如果您想找出有趣的视频，请访问此频道

[视频教程的完整列表](http://www.youtube.com/iamravikk)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T18:07:51.690

JFrame jframe = new JFrame();

JPanel jpanel = 新 JPanel();

jframe.add(jpanel);

例如：

```
 public Myclass extends JFrame{

   public Myclass(){

    this.setSize(300,300);

    this.add(new Mypanel());

     }

        class Mypanel extends JPanel{

                 // Add what u want to add in panel
              }

   } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-16T17:53:15.597

您需要将面板添加到框架中：

```
f.add(jPanel1) 
```

以下独立代码适用于我：

```
 public static void main(String[] args)
    {

        Frame f  = new Frame();
        Panel jPanel1  = new Panel();
        jPanel1.add(new Button("Hello"));
        f.add(jPanel1  );
        f.pack();
        f.setVisible(true);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-16T18:50:51.153

也许问题是你有一个空的 JPanel，我的意思是，你必须使用 frame.add(MyPanel instance) 但你也必须使用（即在 MyPanel initComponents） add(jButton) 或类似的东西..

您也可以尝试设置布局

setLayout(new GridLayout(1, 1)); //也在initComponents方法中。

你能同时显示 initComponents(); 方法？

* * *

编辑：

如果您使用的是 Netbeans 编辑器

右键单击组件的调色板

转到调色板管理器

从项目（如果它是一个打开的项目）或 jar 添加，无论你想要什么。您可以在那里浏览您的课程并查找您的 MyPanel 文件。

然后您还将选择该组件必须出现在哪个文件夹或菜单中，

然后你应该可以像普通的 JPanel 一样拖动它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-18T18:49:02.620

你们甚至没有一个人理解这个问题。该人有自己的 JPanel，以前创建的，而不是在 netbeans 小部件设计器中。他们在问您如何将您已经在其他时间构建的自定义 JPanel 添加到 JFrame 或 Frame，或者当您在设计器中创建“Frame”时 netbeans 设计器使用的任何东西。

问题是，如何添加您自己之前创建的将 JPanel 扩展至设计器环境的 JPanel。不，这根本不简单。您可以插入您自己的“自定义创建代码”并使用您自己的语句“= new MyExistingCustomJPanel();”分配其中一位设计师 JPanel 并且您的 MyExistingCustomJPanel 的构造函数确实会运行，但是当您运行它时它永远不会绘制 gui，因为您的子类在分配中已被向下转换为常规的旧 JPanel。

那么，如何将自己的 JPanel 插入到想要将其用作 Netbeans 表单设计器环境中的对象的项目中。

没那么容易。从来没有找到一种明确的方法来使用我自己的 JPanel 来实现这一点。只是一些非常丑陋的作弊。

这里提供的所有答案都排除了 OP 试图在它提供的 Netbeans 设计器的“框架”中使用他们自己的 JPanel。一点也不直截了当，甚至没有人理解这个问题。

我做到了，因为我一直在为此苦苦挣扎。

# sql - 似乎无法通过简单的 ID 查询找到记录

> ID：10623940
> 
> 赞同：0
> 
> 时间：2012-05-16T17:51:12.523
> 
> 标签：sql, oracle, oracle10g

我有一些表的看法：

```
SELECT UM00200M.ACCOUNT_NO AS INDEX1,
          CONCAT (CONCAT (TRIM (UM00200M.PERSON_LNM), ' '),
                  TRIM (UM00200M.PERSON_FNM))
             AS INDEX2,
          DECODE (NVL (TRIM (SG00100M.PERSON_ID_CUSTOM), 0),
                  0, UM00200M.PERSON_NO,
                  SG00100M.PERSON_ID_CUSTOM)
             INDEX3,
          NULL AS INDEX4,
          'CONS_ACCTG' AS GROUPNAME
     FROM UM00200M, SG00100M
    WHERE UM00200M.PERSON_NO = SG00100M.PERSON_NO 
```

这给了我（抱歉格式化）：

```
Column_Name DATA_TYPE NULLABLE COLUMNT_ID COMMENTS INSERTABLE UPDATEABLE
INDEX1 NUMBER(14,0) 否 1 是 是 是
INDEX2 VARCHAR2(81) 是 2 否 否 否
索引 3 编号 是 3 否 否 否
INDEX4 VARCHAR2(0) 是 4 否 否 否
GROUPNAME CHAR(10) 是 5 否 否 否
```

我正在寻找所有具有 INDEX3 = 524118914 的记录

```
--Looking for INDEX3 = 524118914

--Fails:  01722\. 00000 -  "invalid number"
Select *
from Cayenta.CAHeader 
where INDEX3 = 524118914;

--Fails:  01722\. 00000 -  "invalid number"
Select *
from Cayenta.CAHeader 
where INDEX3 > 524118000 and INDEX3 < 524118999;

--Works
Select *
from Cayenta.CAHeader 
where INDEX3 > 524118000 and INDEX3 < 524999999; 

--Fails: 01722\. 00000 -  "invalid number"
Select *
from Cayenta.CAHeader 
where INDEX3 > 524118000 and INDEX3 < 524999999 
ORDER BY INDEX3; 
```

执行查询时，我没有得到预期的结果。为什么我会收到“无效号码”？

我认为这与 DECODE 函数有关，SG00100M.PERSON_ID_CUSTOM 是一个 CHAR(15 BYTE) 字段，但填充了所有数字数据。（我知道 - 糟糕的设计，但它是第 3 方产品。）

我感谢任何人可以提供的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:26:14.397

这里发生的是隐式转换。这意味着在 where 子句的条件中，您将列 INDEX3 与一个数字进行比较。

INDEX3 是一个 CHAR 列，因此 Oracle 文档的以下摘录适用于隐式转换：

> 在字符和非字符数据类型的算术运算和比较期间，Oracle 会根据需要从任何字符数据类型转换为数字、日期或 rowid

这意味着 INDEX3 中的所有值都将转换为 NUMBER，以便将它们与您在示例中给出的数字进行比较。

解决此问题的简单方法是在数字周围使用引号并将其视为字符串。

```
where INDEX3 = '524118914' 
```

这将适用于相等条件，但对于使用 >= 和 <= 的范围可能效果不佳，除非它们在开头用零填充。使用正确的数据类型还意味着将使用此列上的任何索引。

如果您认为这应该是一个数字字段，那么至少有一行包含非数字数据。要追踪这一点，您可以尝试使用以下条件检查数据：

```
where regexp_like(INDEX3, '[^[:digit:]]') 
```

这仅检查数字（不是小数点等），因此您可能需要根据您的要求对其进行调整。

我对为什么数据库说该列具有数字数据类型有点困惑。这似乎与评估 DECODE 语句的方式有关，并且数据类型来自第一个结果参数，即使默认参数是 CHAR 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:16:37.800

在字符字段中存储数字总是很痛苦......

请尝试以下 SQL 的视图 - 解码检查 PERSON_ID_CUSTOM 是否有数字。如果是，则转换它，如果不是 - 它将被 NULL 替换：

```
 SELECT UM00200M.ACCOUNT_NO AS INDEX1,
              CONCAT (CONCAT (TRIM (UM00200M.PERSON_LNM), ' '),
                      TRIM (UM00200M.PERSON_FNM))
                 AS INDEX2,
              DECODE (NVL (TRIM (SG00100M.PERSON_ID_CUSTOM), 0),
                      0, UM00200M.PERSON_NO,
decode((
  REPLACE(
   TRANSLATE(
    TRIM(SG00100M.PERSON_ID_CUSTOM),'0123456789','00000000000'
   ),'0' ,NULL
  )
 ),NULL,to_number(trim(SG00100M.PERSON_ID_CUSTOM)))
) INDEX3,
              NULL AS INDEX4,
              'CONS_ACCTG' AS GROUPNAME
         FROM UM00200M, SG00100M
        WHERE UM00200M.PERSON_NO = SG00100M.PERSON_NO 
```

# ruby-on-rails - 找到父母然后创建孩子时正确的路线是什么？

> ID：10623941
> 
> 赞同：0
> 
> 时间：2012-05-16T17:51:21.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在我的应用程序中，我想让用户搜索商店，然后选择他们想要使用的商店。它应该转到一个表单，该表单允许用户向该商店添加新价格，就像对文章的评论一样，但我得到了错误：

```
ActiveRecord::RecordNotFound in PricesController#new

Couldn't find Store without an ID 
```

这些是我的联想：

```
class User
  has_many :prices

class Store
  has_many :prices

class Price
  belongs_to :user
  belongs_to :store 
```

因此，当用户选择一个商店时，它应该去`price/new`并知道正在使用的商店的 ID。也许是这样的：

```
<%= form_for @price, :url => create_price_store_path(@store) do |f| %>
...
<% end %> 
```

然后我正在使用的操作：

```
class PricesController

  def select_store
    # Find the store using sunspot search
    @search = Store.search do |s|
      s.fulltext params[:search] unless params[:search].blank?
      s.paginate(:per_page => 5, :page => params[:page])
    end
    @stores = @search.results
  end

  def new
    @store = Store.find(params[:id])
    @price = Price.new
  end
end 
```

然后我的路线到目前为止：

```
resources :stores do
  member do
   post :create_price
  end
end

resources :prices do
  collection do
    get :select_store
  end
end 
```

为什么我会收到此错误？应该纠正什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T20:54:22.757

实际上，我认为您的路线设置不正确。

如果您想根据商店创建价格（或执行任何其他安静的操作），您应该像这样设置您的路线：

资源：商店做资源：价格结束

因此，您`PricesController`可以通过以下网址访问：

```
stores/:store_id/prices/[:action/[:id]] 
```

在您的设置中，您只是说，您`PricesController`有一个名为的方法`create_price`，可以通过 POST 请求 trhough 触发`stores/:store_id/create_price`。但是您没有在您的`PricesController`（至少没有在您提供的代码段中）定义此方法

因此，如果您正在做嵌套资源，正如我在上面所写的，您可以拥有`PricesController`如下：

```
PricesController
  def new
    @store = Stores.find(params[:store_id])
    @price = @store.build   # this builds the Price object based on the store
  end

  def create
    # depending if your model uses `accepts_nested_attributes_for`
  end
end 
```

希望这是您正在寻找的解释:)

更新：我忘了提到的是，如果您希望在`PricesController`没有给定商店的情况下也可以访问您的商店（因为您在`resources :prices`上面写过，我假设您这样做了），如果在哈希`:store_id`中给出a，您需要检查您的控制器`params`，如果不做你想做的事情，没有给定的商店）

# jquery - 网站无法在 iphone/ipad 上运行 .. 调整大小问题

> ID：10623942
> 
> 赞同：1
> 
> 时间：2012-05-16T17:51:23.367
> 
> 标签：jquery, iphone, css, wordpress

在响应式设计中使用 jquery 插件调整移动 (IOS) 视频的大小是否有替代方法？可能是CSS？我使用的是 wordpress 主题，而我添加的视频搞砸了

[http://speedsociety.com/](http://speedsociety.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:55:12.960

[http://wordpress.org/extend/plugins/wordpress-bootstrap-css/](http://wordpress.org/extend/plugins/wordpress-bootstrap-css/)

[http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)

# c# - FTP 到 MainFrame - 需要返回码

> ID：10623944
> 
> 赞同：0
> 
> 时间：2012-05-16T17:51:33.507
> 
> 标签：c#, asp.net, windows, batch-file, ftp

从我的 asp.net 应用程序中，我正在调用一个批处理作业，它基本上将一些文件通过 FTP 传输到大型机。但是我无法返回 FTP 代码，我需要它以便知道文件是否发送成功？在 StandardOutput 中，我只得到我执行的命令，没有太多信息。请参阅下面的代码。仅供参考，之后我无法使用 GET 进行验证，我想这样做，但有人告诉我这是不可能的！

```
 ProcessStartInfo ProcessInfo;
    Process process;
    string output = string.Empty;
    string error = string.Empty;
    ProcessResult item = new ProcessResult();

    ProcessInfo = new ProcessStartInfo("cmd.exe", "/c" +

        "ftp -n -s:myftpsettings.txt FTP.SERVER.XFHG39"

    ProcessInfo.CreateNoWindow = true;
    ProcessInfo.UseShellExecute = false;
    ProcessInfo.RedirectStandardError = true;
    ProcessInfo.RedirectStandardOutput = true;

    process = Process.Start(ProcessInfo);
    process.WaitForExit();

    output = process.StandardOutput.ReadToEnd();
    error = process.StandardError.ReadToEnd();
    ExitCode = process.ExitCode;
    process.Close();

    FTP Settings
    user *******
    ********
    QUOTE SITE LRECL=80 RECFM=FB CY PRI=100 SEC=10
    BIN
    PUT MYFILE 'NewName'
    QUIT 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:46:33.703

您是否考虑过不为此启动外部可执行文件，而是使用 System.Net 中的类并返回[FtpStatusCode Enumeration](http://msdn.microsoft.com/en-us/library/system.net.ftpstatuscode.aspx)？

```
 private static FtpWebRequest CreateFtpWebRequest(string ftpUrl, string userName, string password, bool useSsl, bool allowInvalidCertificate, bool useActiveFtp)
    {
        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(ftpUrl);
        request.Credentials = new NetworkCredential(userName, password);

        if (useSsl)
        {
            request.EnableSsl = true;

            if (allowInvalidCertificate)
            {
                ServicePointManager.ServerCertificateValidationCallback = ServicePointManager_ServerCertificateValidationCallback;
            }
            else
            {
                ServicePointManager.ServerCertificateValidationCallback = null;
            }
        }

        request.UsePassive = !useActiveFtp;

        return request;
    }

    private static FtpStatusCode UploadFileToServer(string ftpUrl, string userName, string password, bool useSsl, bool allowInvalidCertificate, bool useActiveFtp, string filePath)
    {
        FtpWebRequest request = CreateFtpWebRequest(ftpUrl, userName, password, useSsl, allowInvalidCertificate, useActiveFtp);

        request.Method = WebRequestMethods.Ftp.UploadFile;

        long bytesReceived = 0;
        long bytesSent = 0;
        FtpStatusCode statusCode = FtpStatusCode.Undefined;

        using (Stream requestStream = request.GetRequestStream())
        using (FileStream uploadFileStream = File.OpenRead(filePath))
        {
            // Note that this method call requires .NET 4.0 or higher. If using an earlier version it will need to be replaced.
            uploadFileStream.CopyTo(requestStream);
            bytesSent = uploadFileStream.Position;
        }

        using (FtpWebResponse response = (FtpWebResponse)request.GetResponse())
        {
            bytesReceived = response.ContentLength;
            statusCode = response.StatusCode;
        }

        return statusCode;
    } 
```

请注意，您的 ftp 网址将类似于`ftp://ftphost.com/ftpdirectory/textfile.txt`.

# c++ - 在 main 中包含基类和继承类的标头

> ID：10623947
> 
> 赞同：1
> 
> 时间：2012-05-16T17:51:36.963
> 
> 标签：c++

我有一个类`calendar`和一个`extendedCalendar`继承自的类`calendar`

我希望能够在 main 中创建两个类的对象，因此我将它们的两个标题都包含在`main.cpp`：

```
#include "calendar.h"
#include "extendedCalendar.h" 
```

问题是它的头文件中`extendedCalendar.h`也有`#include "calendar.h"`，所以编译器给了我一个错误：

> “日历”：“类”类型重新定义

我该如何规避这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T17:54:07.890

您需要在标题中使用包含防护。

```
//extendedCalendar.h
#ifndef EXTENDED_CALENDAR
#define EXTENDED_CALENDAR

//body of header

#endif

//calendar.h
#ifndef CALENDAR
#define CALENDAR

//body of header

#endif 
```

如果您使用的是 MSVS，则可以使用

```
#pragma once 
```

# cocoa - 在 OS 10.7 中创建自定义键绑定时，空格键的符号是什么？

> ID：10623954
> 
> 赞同：0
> 
> 时间：2012-05-16T17:51:55.083
> 
> 标签：cocoa, osx-lion, key-bindings

**我想创建自定义键绑定`OS 10.7 Lion`，执行以下操作：**

1.  **`option`+ `space`=`right arrow`**
2.  **`control`+ `space`=`left arrow`**

我在 Textmate 博客中阅读[了这篇文章](http://blog.macromates.com/2005/key-bindings-for-switchers/)，概述了如何通过首先创建以下文件来创建自定义键绑定：`~/Library/KeyBindings/DefaultKeyBinding.dict`，然后在文件中输入您想要执行的键`character code`和。`Cocoa action`

问题是，我似乎无法`character code`在`spacebar`任何地方找到！有没有模仿`right arrow`and的动作`left arrow`？

最后，如果我忽略了一种更简单的方法，请告诉我。我真的只关心 Textmate 中的这种绑定，尽管在整个 Lion 中使用它会很好。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T07:52:16.493

不需要符号。你只是使用一个空间。

因此，例如：

```
{
    /* Modifier keys: start with C-m */
    "^m" = {
        " " = ("insertText:", "Hello world");
    }
} 
```

使用此键绑定字典，如果您按 ctrl-m 然后按空格，它将插入“Hello world”。

# database - Oracle 数据库包编译历史和错误日志记录

> ID：10623955
> 
> 赞同：1
> 
> 时间：2012-05-16T17:51:55.847
> 
> 标签：database, oracle, compilation, compiler-errors, oracle11g

我在 Oracle 11g DB 上编译了一个包，它给了我错误。我尝试获取错误，但同时有人修复了它，现在我无法知道问题到底是什么。

有什么方法可以获取包的编译历史以及每次编译遇到的错误？

谢谢你的帮助。如果需要更多信息，请告诉我。

——席德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-17T05:53:46.780

抱歉，不，该信息的历史不可用。

# google-maps - Google Static Maps api v2 自定义标记偏移错误，没有阴影

> ID：10623958
> 
> 赞同：1
> 
> 时间：2012-05-16T17:52:06.173
> 
> 标签：google-maps, google-maps-api-3, google-static-maps

我在 Google 静态地图 API 中的自定义图标偏移时遇到问题。请注意 javascript api 和静态地图 api 的偏移量差异。自定义图标完全按照此处的描述创建[Google API 文档](https://developers.google.com/maps/documentation/staticmaps/#CustomIcons)

如何修复此偏移量以使图标位于正确的坐标上？（我在管理区域中使用 javascript API 来定位标记，以便使用静态 API 进行演示。）

问题是变焦，我想与众不同，但是如何使用不同的变焦更准确地定位它？

这是定位不正确的静态地图 API：

![谷歌地图 API V3！[][1]](../Images/f0a351182b159b3f4e0c4aeeeb62c9b5.png)

这是带有阴影的静态地图 API：

![有阴影](../Images/41f785a5706c6ca9d3d791705a3c0d05.png)

这是正确定位的 Javascript API v3：

![谷歌静态地图api v2](../Images/a01e56310e73b578539e60a737be2cdb.png)

编辑：所以如果我再次添加阴影，位置是正确的，但是有没有办法在没有阴影的情况下纠正它？

我想让标记居中并正确定位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:44:11.353

因为您没有使用阴影，所以 API 假定标记的“锚点”位于其中心，而不是底部的点。

第一个插图中静态地图图标的中心与第二个图像中的标记点位于同一位置。

由于标记是固定大小的，因此指针将指向具有不同缩放比例的不同位置。

要解决此问题，请`shadow:false`从自定义图标中删除描述符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-29T13:49:51.780

“认为可能有一个解决方法。” - 耶格普斯

实际上，有 - 只需将您的图像设置为两倍的高度并将图像与顶部对齐。当然，图像的高度是浪费的两倍，但至少它解决了问题；）

注意 - 这对于新的 visual_refresh=true 特别有用，因为它忽略了阴影参数！

# c++ - C2712：不能在需要对象展开的函数中使用 __try

> ID：10623960
> 
> 赞同：3
> 
> 时间：2012-05-16T17:52:08.843
> 
> 标签：c++, visual-c++, seh

我正在将使用 VC++ 6.0 编写的软件迁移到 VS 2010/VC++2010。我有一个不能在调试模式下编译的项目。我有：

```
LBSC_AppUserInfoList *          
LBSC_Session::GetUsersInfo( const LBSC_Ticket *pTicket )
{
    TSROut_GetUsersInfo sOut;
    C_Buffer            *pcbRet = NULL;
    TSRIn_TicketPar     InPar;
//...
    ClntFree( (void *)sOut.szBuffer );  // dealoca o que veio do RPC

        return( pList );
} // C2712 - Cannot use __try in functions that require object unwinding 
```

我没有提到__try

你明白吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T17:56:30.277

看起来这里最有可能的问题是，`ClntFree`它实际上是一个扩展为使用 SEH`__try`块的宏。表面上没有其他东西看起来像宏一样有意义，而宏似乎是最可能的原因。

您是否查看过定义`ClntFree`以查看它是否为宏？

# jenkins - Jenkins：在电子邮件正文中报告中间 [windows 批处理] 构建步骤的结果

> ID：10623969
> 
> 赞同：4
> 
> 时间：2012-05-16T17:52:38.417
> 
> 标签：jenkins

作为 Jenkins 构建过程的一部分，我们运行了几个 Windows 批处理脚本，并希望在最后由 Jenkins 发送的电子邮件中报告有关这些中间步骤的一些信息。

我认为一个简单的方法是在批处理步骤中设置一个 Windows 环境变量，我们设法使用 PowerShell 来做到这一点，如下所示：

```
powershell.exe -Command "& {[Environment]::SetEnvironmentVariable('ThisIsATest', 'TestValue', 'Machine')}" 
```

在“执行 Windows 批处理命令”构建步骤中执行时，这会“最终”正确设置环境变量。我的意思是，如果我远程进入构建服务器，我可以验证在每次构建期间是否按预期创建/修改了值。

但是，尝试通过添加在“构建后操作”下的“可编辑电子邮件通知”步骤中使用该值

```
Our test value: ${ENV, var="ThisIsATest"} 
```

到“默认内容”部分没有给出正确的结果。使用

```
Print full environment: ${ENV} 
```

也说明价值已经*？？还没？？*被创建。

更奇怪的是，多次运行根本不会获取有问题的环境变量——即使我可以在远程会话中清楚地看到它（并跟踪它的变化等）。

问题：

*   是否有其他方法可以实现我们的目标：

    “在编译/单元测试成功/失败时报告一般成功/失败，但还报告电子邮件正文中中间步骤的其他信息”？

*   或者也许解释一下关于电子邮件插件没有拾取人们期望的环境变量的*奇怪*行为（至少对我来说）？（也许就在哪里寻找解决方法提供一些新想法）

感谢您抽时间阅读。与往常一样，我们将不胜感激任何建议。

-T

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T20:26:57.460

在“正常”情况下，在构建步骤中设置的环境变量不会传播到外部。您可以执行以下操作：

*   安装[EnvInject 插件](https://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin)
*   设置环境变量并保存到表单中的属性文件中`VAR=VALUE`
*   在下一个构建步骤中，使用 EnvInject 插件导入文件（安装插件后，您将在构建步骤选项中看到“注入环境变量”）。这些变量将在整个构建过程中可用。

# ruby-on-rails - client_side_validations 不起作用 - 验证哈希始终为空:(

> ID：10623978
> 
> 赞同：0
> 
> 时间：2012-05-16T17:53:19.810
> 
> 标签：ruby-on-rails, client-side-validation

我真的不知道我做错了什么。我在 gem 的 3-1-stable 分支上。不知道是bug还是我的愚蠢。client_side_validations 只是无法识别我的验证。

这是我的代码：

```
# model models/fan.rb
class Fan < ActiveRecord::Base
  validates_presence_of :email, :name
  validates_uniqueness_of :email
end

# initializer initializers/client_side_validations.rb
ActionView::Base.field_error_proc = Proc.new do |html_tag, instance|
  unless html_tag =~ /^<label/
    %{<div class="field_with_errors">#{html_tag}<label for="#{instance.send(:tag_id)}"                 class="message">#{instance.error_message.first}</label></div>}.html_safe
  else
    %{<div class="field_with_errors">#{html_tag}</div>}.html_safe
  end
end

# view fans/new.haml
= form_for @fan, validate: true do |f|
    = f.text_field 'name'
    = f.email_field 'email'
    = f.submit

# application.js
//= require jquery
//= require rails.validations

# gemfile
gem 'aws-sdk'
gem 'aws-s3', :require => 'aws/s3'
gem 'client_side_validations', git: 'https://github.com/bcardarella/client_side_validations.git', branch: '3-1-stable'
gem 'coffee-filter'
gem 'devise'
gem 'draper'
gem 'haml'
gem 'haml-rails'
gem 'heroku'
gem 'jquery-rails'
gem 'paperclip', '~> 3.0'
gem 'paperclip-meta', :git => "git://github.com/dce/paperclip-meta.git"
gem 'rails', '~> 3.2.3'
gem 'thin'

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'coffee-rails', '~> 3.2.2'
  gem 'sass-rails',   '~> 3.2.5'
  gem 'uglifier'
end

group :production do
  gem 'pg'
end

group :development, :test do
  gem 'awesome_print'
  gem 'powder'
  gem 'sqlite3'
  gem 'sprite-factory'
end 
```

我可以提交表格（我不应该这样做）。验证工作（rails 让我返回预期的消息）。我尝试通过扫描 gem 代码来调试它，我发现在每个具有验证的表单之后都插入了一个脚本标签。我的问题是 window[form.id].validators 总是空的。

我使用普通的表单生成器。我尝试剥离所有其他脚本/样式/html，直到我只有表单和所需的 javascript（jquery 和 rails.validations），但它不起作用。

任何帮助是极大的赞赏 ：（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T19:56:37.650

这对我有用。

```
<%= form_for @merchants_list, :url => {:controller => 'merchants_lists', :action => 'create'},:html => {:id => "merchants_details_form",:multipart => true},:validate => true do |f| %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T05:42:26.260

如果您正在使用 client_side_validation gem 建议在 Gemfile 中的 client_side_validation 之前编写 Jquery_rails。C_S_V gem 使用 Jquery Ajax 进行验证。没有别的事可做。尽管有小问题，但它还是一颗很棒的宝石。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-10T00:27:49.913

我有类似的问题 - client_side_validations 不起作用，验证器哈希为空。当我尝试将 <%= f.validate %> 添加到表单中时，它开始工作（并且所有验证器都在哈希中），但是没有它它应该可以工作。所以最后我发现你必须在创建输入时使用 :symbol 表示法。例如`f.input "name"`，没有工作，但`f.input :name`它的验证器最终被自动加载。

# android-activity - 跨 Android 应用程序和活动访问数据成员

> ID：10623981
> 
> 赞同：0
> 
> 时间：2012-05-16T17:53:21.203
> 
> 标签：android-activity, android

我们正在为 Android 开发一套相当复杂的软件。为了简化事情（如常见任务），我正在将我们的软件所做的一些事情（如数据库访问）移动到应用程序中，以便各种活动可以在必要时访问它们。

在一个活动中，我可以使用`getApplication()` `to`获取对应用程序数据成员的访问权限，但我无法弄清楚如何从应用程序执行相反的操作。有没有一种简单的方法可以从 Android 应用程序中获得“可见性”到其依赖的活动中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:07:43.807

类`Application`（通常）不应该与任何`Activity`或其他组件有关。

只需创建一个数据库助手（`SQLiteOpenHelper`例如扩展）并让您`Application`创建并保存对它的静态引用。

```
public class MyDBHelper extends SQLiteOpenHelper {
    ...
} 
```

对于`Application`...

```
public class MyApp extends Application {

    protected static MyDBHelper dbHelper = null;

    @Override
    public void onCreate() {

        dbHelper = new MyDbHelper();
        ...
    }
} 
```

然后在任何应用程序组件中......

```
MyApp.dbHelper.someMethod(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T09:16:44.380

我们所做的是创建一个`BaseActivity`类。我们所有的活动都继承自`BaseActivity`该类。我们已经覆盖了大多数生命周期方法，`BaseActivity`以便我们可以自己跟踪活动堆栈。通过这种方式，您可以确定哪个活动是“当前”活动。要从活动中获取信息，您可以`BaseActivity`在继承的活动中提供覆盖的访问方法。

我相信还有其他方法。

这种架构最大的问题是没有真正可靠的方法来确定哪个活动是当前正在运行的活动（即：活动堆栈顶部的活动）。有一些 hacky 方法依赖于访问所有任务的权限，但这确实不好。

Android 需要为应用程序提供一种方法来确定堆栈中的哪些活动以及按什么顺序，但它没有。

当您执行此操作时，请注意 Android 可以（并且将）**随时终止您的进程**（如果它在后台），并且当用户返回应用程序时，它将重新创建进程（和您的应用程序实例）和然后它将仅重新创建位于任务堆栈顶部的活动。它不会**重新**创建顶部活动下方的所有活动，**除非（并且直到）**用户返回它们。

# javascript - EJS（嵌入式javascript）与backbone.js——差异的快速总结

> ID：10623985
> 
> 赞同：0
> 
> 时间：2012-05-16T17:53:46.400
> 
> 标签：javascript, model-view-controller, backbone.js, ejs

EJS和backbone.js在构建客户端javascript应用程序方面的区别总结是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T18:07:58.703

EJS 是一个模板框架，如 JAML、JST、mustache、handlebars ...... Backbone 远不止这些，Backbone 能够使用 EJS 模板来呈现其视图和数据，但围绕它创建一个应用程序框架。Backbone 为您提供了创建事件驱动应用程序的工具，而 EJS 所做的只是获取数据并将其转换为 html。

Backbone 默认使用 underscore.js 的模板功能，您可以在此处查看：[http](http://documentcloud.github.com/underscore/#template) ://documentcloud.github.com/underscore/#template 。您可以轻松地将其切换到任何其他模板引擎。

# sql - 如果值未更改，则折叠日期记录

> ID：10623990
> 
> 赞同：0
> 
> 时间：2012-05-16T17:54:03.473
> 
> 标签：sql, oracle

我正在尝试使用此解决方案来解决如何根据值折叠记录..

表1（输入）

```
 Emp_ID Start_Date  End_Date    Rating  Department  Salary
2000    01012011    12312011    A   HR          10000
2000    01012012    12319999    A   HR          20000
3000    01012011    12312011    B   Operations  50000
3000    01012012    12312012    B   Operations  60000
3000    01012013    12319999    C   Operations  70000 
```

表2（输出）

```
 Emp_ID Start_Date  End_Date    Rating  Department
2000    01012011    12319999    A   HR
3000    01012011    12312012    B   Operations
3000    01012013    12319999    C   Operations 
```

数据库是oracle。我只需要一些关于如何解决这个问题的开始，以便我可以解决它..

提前致谢..

**编辑：**假设表 1 和表 2 有 EMP_NAME 列。但我无法将这一列作为分组加载到 table2 中，不会让我这样做..（我说的是 Pablo Santa Cruz 给出的解决方案）

关于这个的任何解决方案..

**编辑：** 编辑了表结构 agan ..抱歉造成混淆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T17:55:45.707

试试这个：

```
select emp_id, rating, min(start_date), max(end_date)
  from table_1
 group by emp_id, rating 
```

如果您需要将值实际存储在`table_2`表中，请以`create table table_2 as`.

考虑到您的评论，您可以执行以下操作：

```
create table table_2 as
select emp_id, rating, min(start_date), max(end_date), 
       'EMP_DEPT_INFO' as emp_deparment
  from table_1
 group by emp_id, rating 
```

其他可能性可能是首先创建表，然后执行`alter table`以包含新列。

# ruby-on-rails - Rails 3 本地化路线和展示资源

> ID：10623991
> 
> 赞同：3
> 
> 时间：2012-05-16T17:54:03.613
> 
> 标签：ruby-on-rails, ruby-on-rails-3, localization, internationalization, routes

我在 Rails 3.2 服务器上重写我的路由，所以语言是 URL 的一部分。我的 routes.rb 文件是这样的：

```
scope ":lang", :lang => /es|fr|it|pt|en|de/ do
    resources :users
end 
```

通过附加语言字符串，几乎所有 URL 都能完美运行，即：

```
http://mydomain/es/somecontroller/someaction 
```

问题来自显示操作，链接不起作用。这一行：

```
<%= link_to "Show", @my_user %> 
```

导致这样的“路由错误”：

```
No route matches {:action=>"show", :controller=>"users", :lang=>##User serialization##} 
```

我究竟做错了什么？

**编辑**：好的，**找到解决方案**。多亏了 Cage 和一些研究，才有了解决方案。

只需要这样的 ApplicationController 方法：

```
def self.default_url_options
  { :lang => FastGettext.locale }
end 
```

一切都完美无缺！根本不需要重写链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T18:10:06.213

对于显示、编辑、销毁，您应该在路径中传递对象的 :id ，否则它将显示错误。例如

```
 <%= link_to "Show", user_path(@my_user.id) %> 
```

浏览此链接，它会在路由[http://guides.rubyonrails.org/routing.html的情况下为您提供很多帮助](http://guides.rubyonrails.org/routing.html)

# c# - 带有 Comboboxcolumn 的数据网格 - AddNew 错误

> ID：10623998
> 
> 赞同：1
> 
> 时间：2012-05-16T17:54:33.683
> 
> 标签：c#, winforms, entity-framework, datagridview, datagridviewcombobox

使用 EF 4、C# WinForms 和 Northwind 数据库，我将一个数据网格绑定到 Orders 实体，然后在运行时创建了一个新的 Comboboxcolum。

```
 Entities NW;
    private void Form1_Load(object sender, EventArgs e)
    {
        NW = new Entities();
        BindingSource1.DataSource = NW.Orders;

        DataGridViewComboBoxColumn CboCol = new DataGridViewComboBoxColumn()
        {
            HeaderText = "Customer",
            DataPropertyName = " Customer ID",
            DataSource = NW.Customers.Execute(MergeOption.AppendOnly),
            ValueMember = "CustomerID",
            DisplayMember = "CompanyName"
        };
        Datagriview1.Columns.Insert(1, CboCol);
    } 
```

使用上面的代码，我成功地更改了datagridview中的值并删除了行，但是无法通过单击“+”按钮（添加新）来添加新行，错误：“datagridviewcombocell 不是有效值”。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T02:47:29.900

因为您将 DataGridViewComboBoxColumn 与数据绑定，所以当您添加包含一些空值的新行时，在您的数据源中找不到，这就是为什么它提示您不是有效值

我的建议不是直接将新记录添加到 DataGirdViewComboBox 中，而是您绑定到组合框中的数据源。当您从数据源绑定 DataGridViewComboBox 时，最好始终将其保持为只读状态。