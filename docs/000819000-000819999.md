# StackOverflow 问答 000819000-000819999

# java - java中是否有Updatepanel控件（如ASp.net）

> ID：819009
> 
> 赞同：0
> 
> 时间：2009-05-04T06:39:46.163
> 
> 标签：java, jquery, jsp, servlets, updatepanel

我基本上是一个 .net 开发人员，我现在正在开发一个 java web 项目，

在这里，我基本上需要从后端获取值（比如生成一个随机数）并在前端每秒更新该随机数，我想为此使用 jquery，

在 ASP.net 中，我知道我可以有一个 updatepanel 并使用 _doPostBack 更新面板而不刷新整个页面。

这可能是一个愚蠢的问题，但我是一个 java 新手。

任何做同样事情的帮助/示例将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:00:45.910

在 Java 中，您可以使用 JSF 和像[MyFaces](http://www.javaworld.com/javaworld/jw-09-2006/jw-0911-jsf.html)或[IceFaces](http://www.icefaces.org/main/ajax-java/jsf-components.iface)这样的渲染工具包来做类似的事情。.NET 开发人员需要大量时间来学习这些技术。

如果您打算同时使用 .NET 和 Java，我建议您花一些时间来学习 jQuery 和客户端编程。这种知识可以在两个世界中为您服务。使用 jQuery 实现 UpdatePanel 功能是一项微不足道的任务。只需创建一个返回内容的服务并使用 $.load() 加载它。

# listbox - 多个列表框的替代品？

> ID：819011
> 
> 赞同：0
> 
> 时间：2009-05-04T06:40:52.090
> 
> 标签：listbox, asp.net-2.0

我正在处理的当前 ASP.NET 站点调用多个列表框，确切地说是 3 个。第一个是艺术家，第二个是专辑，最后一个是歌曲。如果您从艺术家列表框中选择一个项目，则专辑列表框将显示该艺术家的专辑，歌曲列表框将显示该专辑中的所有歌曲，我相信你们可以理解我在这里谈论的内容。

我一切正常，这不是问题，但我发现列表框控件相当乏味。我正在寻找可以工作的silverlight，但它只支持windows不会有任何帮助，我能想到的唯一其他选择是使用闪光灯，但我也想避免这种情况。

我在这里要问的是，他们的另一个控件是不是我可以用来更好地进行风格化和自定义设计以使其更适合我的网站，同时又像列表框一样让用户保持简单？在我用 flash 冒险进入未知领域之前（没有这方面的经验），我想从社区获得一些意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T06:45:52.437

为什么说 Silverlight 只支持 Windows？在 Mac 上也很棒！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T06:51:15.793

您可以使用 jquery UI 和 scriptaculous 提供的拖放功能，而不是使用多个列表框。这样做的缺点是它不适用于禁用 javascript 的人，因此您可能仍需要多个列表框作为后备机制。

# php - 使用 jquery 和 php 进行排序

> ID：819012
> 
> 赞同：0
> 
> 时间：2009-05-04T06:40:58.673
> 
> 标签：php, jquery, sorting

这段代码有什么问题，它第一次工作，然后当我再次构建标头时出现错误，说 From 未定义

jQuery

```
function sort(tableHeader,sortDir)
{
 $.ajax({
 url: "sort.php",
 type:"get",
 data: "tableHeader="+tableHeader +"&sortdirection="+sortDir,
 success:function(data){
 $("#t1").html(data);}});} 
```

php

```
 $table_Header=$_GET['tableHeader'];
  $sort_Dir=$_GET['sortDir'];

 if ($table_Header == 'From')
 {
   $sort_By = 'player_name';
 }
 else if ($table_Header == 'To')
 {
  $sort_By = 'player_name';
 }   
 else if ($table_Header== 'Gr')
 {
   $sort_By = 'grp_abr';
 }

 if (isset($sort_Dir) && $sort_Dir == 'DESC')
 {
    $sort_Dir = 'DESC';
 }
else
  {
    $sort_Dir = 'ASC';
  }

   $str = stripslashes('From');
   echo $sortBy;
   $result = mysql_query("SELECT * FROM messages,Player
   where player_id = from_user
   ORDER BY player_name ".$sort_Dir);
   echo "<thead>
   <tr>
   <th style='color:royalblue;'>•&lt;/th>
   <th align='center'>Time</th>
   <th align='left' onClick='sort('From',$sort_Dir);'>De:</th>
   <th align='left'>To:</th>
   <th align='left'>Gr</th>
   </tr>
   </thead> ";

  while($row = mysql_fetch_array($result))
  {
  echo "<tbody>
  <tr class='highlight'>
  <td width='30' align='center' style='color:royalblue'>"."•"."</td>
  <td width='70' align='left'>".$row["Time_Date"]."</td>
  <td width='600' align='left'>".$row["player_name"]."</td>
  <td width='600' align='left'></td>
  <td width='100' align='left'></td>
  <tr class='highlight'>
  <td></td>
  <td colspan='4'>".$row["msg_desc"]."</td></tr>
 </tbody>";
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:54:30.060

在查看了您的源代码之后，这里遵循我的观察。

`sort.php:12 >>>`排序方向的 $_GET 数组元素输入错误：`$_GET["sortDir"]`当 javascript`sort()`函数使用名为“sortdirection”的查询字符串中的变量组成 ajax 请求时，您调用它。

`sort.php:28 >>>`您不需要在这里颠倒排序顺序，因为您的 javascript 函数`sortDirection()`已经这样做了。因此，第 28 到 35 行和第 44 行的注释不使用 php 变量`$sort_Dir`，而是使用 javascript 变量`sortDir`。

`user.php:48 >>>` the comparison to determine current sort order is made against the string literal `"Desc"`, while generally you use `"DESC"` as a value for this variable, so the first try was fine but the second simply does nothing, as `"DESC"` is different from `"Desc"` in Javascript, due to binary comparison between strings. So change `"Desc"` to `"DESC"` into your `sortDirection()` function.

This should get your stuff working.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T08:05:04.353

首先，我会尝试将`onClick='sort('From',$sort_Dir);'`切换从单引号更改`sort(...)`为双引号，当您在那里的 php 字符串中时，用反斜杠转义它们，这样：

```
onClick=\"sort('From',$sort_Dir);\" 
```

其次，在同一个代码段中，您传递了 $sort_Dir，它将由 php 转换为 ASC 或 DESC。由于在这样的字符串中，您正在编写一些要插入文档中某处的源 html 代码，因此让单词 ASC 或 DESC 出现时不带引号会混淆 javascript 解析器。

所以你应该像这样改变 onClick 的东西：

```
onClick=\"sort('From','$sort_Dir');\" 
```

但正如我在评论中所说，您应该提供有关第一次（也是唯一一次成功的）调用 sort() 的更多详细信息（何时发生，如何发生等）。

试试这个，看看。

# iphone - iPhone - 如何将图像从我的应用程序嵌入到电子邮件中？

> ID：819021
> 
> 赞同：1
> 
> 时间：2009-05-04T06:46:18.533
> 
> 标签：iphone

是否可以在从我的应用程序发送的电子邮件中嵌入图像？我们可以在我们的应用程序中使用带有源的标签作为图像吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:22:56.747

是的。您可以使用 3.0 的邮件 API。

我不会把代码放在这里，因为它在 NDA 之下。虽然它在 SDK 中有很好的记录。您需要将图像数据放入没有明显记录的 NSData 中：

```
NSData* imageData = UIImagePNGRepresentation(myUIImage); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T11:09:08.520

简短的回答是你不能。

长答案 - 我刚刚遇到了[这个](http://github.com/joehewitt/three20/tree/master)，其中包括 TTMessageController 类。您需要添加一个委托来实际进行发送 - 即实现 SMTP 并与已知的 SMTP 服务器通信。这本身并不太复杂，但在错误处理方面增加了一些复杂性，特别是因为没有后台处理。

例如，如果您的应用在您发送电子邮件之前退出，那么您需要记住您的状态并在下次启动时发送。Apple 邮件应用程序只会在后台发送它。

# jsp - 使用jsp将数据插入数据库

> ID：819022
> 
> 赞同：-1
> 
> 时间：2009-05-04T06:46:21.903
> 
> 标签：jsp

我必须将表单中的数据插入数据库，我尝试了这段代码，它可以工作，但现在它不起作用。我想知道这段代码的问题在哪里

这是代码

连接 con =null;

```
 try{

        String driveName = "com.mysql.jdbc.Driver";

        Class.forName(driveName).newInstance();

        } catch(java.lang.ClassNotFoundException e) {
        System.err.print("ClassNotFoundException: ");
        System.err.println(e.getMessage());
        }
        try{
        con = DriverManager.getConnection("jdbc:mysql://localhost:3306/onlinequiz","root","root");
       Statement statement =con.createStatement();

    //  int id=Integer.parseInt(request.getParameter("T1"));
       int quizID = Integer.parseInt(request.getParameter("quizID")); 
```

String take2=request.getParameter("question_type"); String course=request.getParameter("course"); String level=request.getParameter("level");

int duration=Integer.parseInt(request.getParameter("duration"));

String Title=request.getParameter("Title"); String Description=request.getParameter("Description");

statement.executeUpdate("插入到测验(课程,标题,描述,quizID,question_type,持续时间,级别) values('"+course+"','"+Title+"','"+Description+"','"+quizID+ "','"+take2+"','"+duration+"','"+level+"')");

```
 %>
<%

        statement.close();

    } catch ( Exception e ) {
        out.println( "Exception: " + e.getMessage() );
    }
        // execute the statements even if the exception occurs
        finally{

        }
        %> 
```

我尝试并编辑此代码及其工作，我做了一些更改，我想根据用户在问题类型中选择的内容是包含多项选择或真假的下拉框，我是否应该编写将用户转发给他的 if 语句选择。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-05-04T07:33:45.877

上面的代码在执行时会抛出异常吗？如果是这样，您可以在帖子中复制/粘贴异常消息吗？

此外，您不应该直接将用户输入添加到您的插入查询中，这很容易受到 SQL 注入攻击。改用准备好的语句，并考虑通过对所有数据库事务使用数据访问层来使用适当的模型-视图-控制架构。

# iphone - 在 XCode 中的何处输入应用程序参数？

> ID：819028
> 
> 赞同：3
> 
> 时间：2009-05-04T06:49:00.760
> 
> 标签：iphone

我是 Objective C 和 iPhone 开发的新手。我在新的 iPhone 3.0 平台上使用 CoreData。我的应用程序执行；但是，我没有从 fetchedResultsController 得到任何对象。我想看看传递给 SQLite 的 SQL。

在 Apple 文档中，它说我可以通过将以下参数传递给应用程序来看到这一点

-com.apple.CoreData.SQLDebug 1

我到底在哪里做这个？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-06-08T07:42:12.770

在 XCode 4 中，它的工作方式有所不同。

1.  点击 Schemes 下拉列表（在顶部的 Stop 和 Breakpoints 按钮之间），
2.  然后选择编辑方案并选择您的方案，
3.  然后选择运行选项卡（左侧）和顶部的参数选项卡，
4.  将参数放入“Arguments Passed on Launch”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-05T01:25:36.910

在组和文件列表中左侧窗格的 XCode 编辑器中：

1) 展开“可执行文件”组 2) 选择您的应用程序可执行文件并右键单击 3) 选择获取信息 4) 选择参数选项卡 5) 在参数框中添加必要的参数

# msbuild - 如何减少 MSBuild 时间

> ID：819031
> 
> 赞同：23
> 
> 时间：2009-05-04T06:50:05.233
> 
> 标签：msbuild, build-process, build, build-automation

**我的情况**

在我现在正在处理的 C# 项目中，我们有一个相当大的解决方案（80 多个项目）。[现在，使用Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)中的 MSBuild，5 分钟以上的重建时间确实成为一个相当大的问题。

在我上周所做的分析中，结果证明我的构建时间花费如下：

1.  将文件复制到项目并重新复制到依赖它的项目（CopyToLocal）等（60%）

2.  调用 postbuild 来反编译/编译。(20%)

3.  进行实际编译等（20%）

除了“普通”项目`bin\debug`文件夹输出也被复制到外部目录以设置主“加载器”程序。主程序结构有点像这样：

```
\loader\bin\loader.exe

\loader\plugin\plugin1\plugin1.dll

\loader\plugin\plugin1\somedependency.dll 
```

**我做了什么**

为了让事情进展得更快一点，我想到了以下几点：

1.  将所有文件复制到一个大 bin 目录，不要使用**CopyTolocal**。我不喜欢这样，因为我们不能再使用同一个 DLL 文件的不同版本，而且我的 bin 目录变得一团糟。

2.  [对 MSBuild 使用并行度 (/m)](http://www.hanselman.com/blog/FasterBuildsWithMSBuildUsingParallelBuildsAndMulticoreCPUs.aspx)。这对构建时间的帮助很小。

3.  尝试减少项目之间的依赖关系，这当然总是一件好事。

4.  投资硬件。我发现了一些[关于固态驱动器的研究](http://www.joelonsoftware.com/items/2009/03/27.html)，但这似乎并不乐观。

**我的问题**

我还注意到，当我对位于我的依赖关系树根目录的项目进行更改时，一切都会重新构建。即使改变只是在“私人”部分，项目的界面也没有改变。

MSBuild 是否使用依赖项目的时间戳来确定项目是否需要重建？

这可以更改为不同的条件吗？例如，文件的校验和？

除了这个具体的建议之外，我肯定会感谢所有让构建时间更快的建议。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2011-10-29T23:34:12.367

我正在处理 500 多个 C# 应用程序项目。项目是并行编译的，并且 copylocal 设置为 false。编译时间约为 37 分钟，没有单元测试和代码覆盖。增量构建需要 13 分钟，代码没有任何更改。

如果我关闭并行编译并将 copylocal 设置为 true，编译时间将超过 1 小时 40 分钟。

对于本地构建、门控签入构建和部署阶段的服务器构建（夜间构建），我有不同的配置。

以下是我的经验：

1.  如果您想在没有将 CopyLocal 设置为 false 的情况下并行构建项目，则将输出文件复制到一个目录不是一个好主意。当多个项目引用同一个程序集并且 MSBuild 尝试同时将此引用复制到输出文件夹时，我的程序集有时会被锁定。[这个解决方案](https://stackoverflow.com/questions/1682096/how-do-i-override-copylocal-private-setting-for-references-in-net-from-msbuil)对我很有帮助。我将所有引用的 copylocal 设置为 false，并且我的构建目录大小降低了 10 倍（I/O 减少了 10 倍）。对于本地构建和服务器构建，我有不同的设置。门控签入构建和完整部署构建的不同设置。
2.  如果我启用并行构建，构建会更快，更快。如果你有一个强大的构建服务器，你的`/m:2`构建应该比`/m:1`构建快 2 倍。它与项目之间的依赖关系无关（如果 copylocal 设置为 false）。
3.  如果您想要快速增量构建，您应该减少项目之间的依赖关系。它对完整构建没有影响（copylocal false）。增量编译时间取决于构建树中更改的项目位置。

是的，MSBuild 使用依赖项目的时间戳来确定项目是否需要重建。它将输入文件（代码文件、引用的程序集、临时文件……）时间戳与输出程序集进行比较。如果有什么改变，你的项目会被重新编译。尽量减少项目之间的依赖数量，以尽量减少重新编译。如果您的更改仅在项目的“私有”部分中，您的输出程序集将被更改，程序集时间戳将被更改，并且所有相关项目也将被重建。您对此无能为力。

在不更改代码的情况下以诊断详细程度运行您的构建两次，并像我[在此处](https://stackoverflow.com/questions/7728773/how-to-make-msbuild-do-not-rebuild-all-projects/7784459#7784459)描述的那样检查“完全构建目标“CoreCompile”” 。您的项目文件中可能有问题，并且每次都会重新编译您的项目。如果您不更改任何内容，则构建日志不应包含“完全构建目标“CoreCompile””日志。

我们的构建服务器是一个虚拟机，而不是一个真正的硬件。将 VM 用于构建服务器并不是一个好主意，但这不是我的决定。

如果您有多 GB RAM，请尝试将其中的一部分用作内存硬盘。您的构建应该更快:)

SSD 驱动器对每天的高 I/O 很敏感。它对保修有影响。

我希望它可以帮助某人... ;)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-08T21:19:54.540

我们也有巨大的解决方案。构建和编译都是关于 I/O 的。

**固态硬盘**非常有前途。一位同事在他的笔记本电脑中放置了一个固态驱动器，发现它现在比他巨大的主开发盒快得多。没有细节，但他声称要快很多倍。

我们一直在摆弄**解决方案文件夹**来对项目的各个部分进行分组：这使开发人员可以更轻松地**卸载他们不从事的项目**。

**`/m`很少有助于 .NET 调试构建**。几周前，我对此进行了一系列测试，发现了细微的差异。发现：

*   因为我的构建受 I/O 限制，所以使用**/m:2-4**会使调试构建对我来说**变慢**。
*   发布构建通常要快得多。
*   代码分析会增加很多时间。

大局：实际上，与获取源代码和运行单元测试相比，编译对我来说是一笔很小的成本。在我们的构建服务器上，集成测试和打包几乎一直在进行。对于我的开发箱，我安排了一个批处理文件，在我上班之前和吃午饭的时候获取源代码、构建、运行单元测试。够好了。

在构建服务器上，它更复杂。我们正在考虑在各种机器上建立链式并行[CruiseControl.NET 。](http://en.wikipedia.org/wiki/CruiseControl)我们正在使用 VSTS 构建，但是像这样水平扩展太昂贵（而且耗时）。

我给注重细节的人的数字。从最慢到最快的配置，运行 msbuild "bigsolution.sln" /target:clean - 在每个之间。

1.  /m: 4, Debug with code analysis 1:38
2.  /m: 1, Debug with code analysis 1:30
3.  /m: 4，无代码分析调试 1:30
4.  /m: 1，无代码分析调试 1:30
5.  /m: 1，发布代码分析：1:30
6.  /m：4，发布代码分析：1:05
7.  /m：4，无代码分析发布：0:53

无需重新构建或清理的构建时间：~ 4-10 秒

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-18T05:17:04.147

MSBuild 构建时间是一个多维问题。好消息很容易解决：

与构建机器上运行的大多数进程不同，构建过程因消耗 CPU、RAM 和 I/O 而臭名昭著。加速 MSBuild 构建的一般方法是“获得最好的机器钱可以买到”，特别是：

1.  CPU - 至少两个 Intel 3.0 GHz Core 2 Duo。

2.  RAM - 至少 4 GB DDR3。如果这是一台开发*和*构建机器，64 位操作系统和 8 GB RAM 是更好的选择。

3.  HDD - 最快的选择是带有板载电池和启用写入缓存的高端 3ware RAID-1。快速 SSD 可能是另一个需要考虑的选择。

4.  网络 - 最低 1 Gbit/s 卡。

这种简单的硬件优化可以将您的 MSBuild 加速 2-3 倍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-04T05:19:16.870

如果您有足够的 RAM 并且正在使用 Visual C++（不确定 C#），您可以通过将整个 include 和 lib 目录复制到 RAM 驱动器来加快速度。

您还可以将临时构建项目放置在 RAM 驱动器上。当然，您需要大量的 RAM。包含和库的 2 GB RAM 驱动器就足够了。但是对于临时文件（*.obj 等），它取决于项目。所以它可能会增加 1 到 4 GB 或更多。

# visual-studio - 我无法在 Visual Web Developer 2008 Express 上创建新项目

> ID：819032
> 
> 赞同：1
> 
> 时间：2009-05-04T06:50:22.783
> 
> 标签：visual-studio, visual-studio-express, visual-web-developer

我无法在带有 SP1 的 Visual Web Developer 2008 Express 上创建新项目。
（我只能创建新网站）

我的同事有完全相同的版本（如果你去帮助 - 关于），但他们可以创建新网站和新项目。

我正在尝试在 MVC 上做这个教程，它还说你可以在 Web Developer Express ( [http://www.asp.net/learn/mvc/tutorial-21-cs.aspx](http://www.asp.net/learn/mvc/tutorial-21-cs.aspx) )上做

如何在 Visual Web Developer 2008 Express 上启用新项目？

[http://www.yart.com.au/junk/hardi%20temp/vs1.gif](http://www.yart.com.au/junk/hardi%20temp/vs1.gif) [http://www.yart.com.au/junk/hardi%20temp/vs2.gif](http://www.yart.com.au/junk/hardi%20temp/vs2.gif)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T23:39:48.770

根据这篇[博](http://weblogs.asp.net/scottgu/archive/2008/06/01/asp-net-mvc-support-with-visual-web-developer-2008-express.aspx)文，在 VWD 的 SP 1 中添加了添加 Web 应用程序项目的功能。尝试再次下载并安装它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-18T08:40:27.297

这是如何做到的：

1.  选择文件/新项目

2.  将其添加到您现有的解决方案中

鲍勃是你的叔叔！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T17:19:35.037

转到工具-> 导入和导出设置，然后“重置所有设置”。然后会神奇地出现“新建项目”菜单选项。

# asp.net - 清除文本框和隐藏字段

> ID：819035
> 
> 赞同：-1
> 
> 时间：2009-05-04T06:52:19.237
> 
> 标签：asp.net, vb.net

在 asp 的源代码中，我在文本框中使用 onClick()，即

```
onClick="openpopup('ct100$contentPlaceHolder$hdpackageid',
           'ct100$contentPlaceHolder$txtpackageid','package')" 
```

用于打开包含包详细信息的弹出窗口。并在弹出窗口中的选择中将 packageid 存储到隐藏字段中，并将 packagename 存储在文本框中。如果不需要，我需要在选择后清除隐藏字段和文本框。我使用“this.blur();” 不编辑文本框。我需要用 vb 代码编写这些东西，这意味着在 onClick 中我想清除文本框、隐藏字段，然后调用弹出窗口。谁能帮我解决这个问题。还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:15:38.730

```
onclick = 'document.getElementById("textbox").value = ""; openpopup(........); ' 
```

# c# - 你将如何解决这个数据解析问题？

> ID：819036
> 
> 赞同：1
> 
> 时间：2009-05-04T06:53:14.930
> 
> 标签：c#, f#, protocols, network-protocols

我们正在为同时开发的一个硬件实现一个模拟器。这个想法是为第 3 方提供一个软件解决方案来测试他们的客户端软件，并为硬件开发人员提供一个参考点来实现他们的固件。

为硬件编写协议的人使用了名为 INCA_XDR 的自定义版本的 SUN XDR。它是一个序列化和反序列化消息的工具。它是用 C 语言编写的，我们希望避免使用任何本机代码，因此我们手动解析协议数据。

该协议本质上相当复杂，数据包可以有许多不同的结构，但它始终具有相同的全局结构：

> [头部] [介绍] [数据] [尾部]

```
[HEAD] =
    byte sync 0x03
    byte length X       [MSB]       X = length of [HEADER] + [INTRO] + [DATA]
    byte length X       [LSB]       X = length of [HEADER] + [INTRO] + [DATA]
    byte check X        [MSB]       X = crc of [INTRO] [DATA]
    byte check X        [LSB]       X = crc of [INTRO] [DATA]
    byte headercheck X              X = XOR over [SYNC] [LENGTH] [CHECK]

[INTRO]
    byte version 0x03
    byte address X                  X = 0 for point-to-point, 1-254 for specific controller, 255 = broadcast
    byte sequence X                 X = sequence number
    byte group X        [MSB]       X = The category of the message
    byte group X        [LSB]       X = The category of the message
    byte type X         [MSB]       X = The id of the message
    byte type X         [LSB]       X = The id of the message

[DATA] =
    The actual data for the specified message,
    this format really differs a lot.

    It always starts with a DRCode which is one byte.
    It more or less specifies the general structure of
    the data, but even within the same structure the data
    can mean many different things and have different lengths.
    (I think this is an artifact of the INCA_XDR tool)

[TAIL] =
    byte 0x0D 
```

如您所见，有很多开销数据，但这是因为该协议需要同时使用 RS232（点对多点）和 TCP/IP (p2p)。

```
 name        size    value
    drcode      1       1   
    name        8               contains a name that can be used as a file name (only alphanumeric characters allowed)
    timestamp   14              yyyymmddhhmmss  contains timestamp of bitmap library
    size        4               size of bitmap library to be loaded
    options     1               currently no options 
```

或者它可能具有完全不同的结构：

```
 name        size    value
    drcode      1       2   
    lastblock   1       0 - 1   1 indicates last block. Firmware can be stored
    blocknumber 2               Indicates block of firmware
    blocksize   2       N       size of block to load
    blockdata   N               data of block of firmware 
```

有时它只是一个 DRCode，没有额外的数据。

基于组和类型字段，模拟器需要执行某些操作。因此，首先我们查看这两个字段，并在此基础上了解对数据的期望，并且必须正确解析它。

然后需要生成响应数据，该数据又具有许多不同的数据结构。一些消息只是生成一个 ACK​​ 或 NACK 消息，而另一些则生成一个带有数据的真实回复。

我们决定把事情分成小块。

首先是 IDataProcessor。

实现此接口的类负责验证原始数据并生成 Message 类的实例。他们不负责通信，他们只是传递一个字节[]

原始数据验证意味着检查标头中的校验和、CRC 和长度错误。

生成的消息被传递给实现 IMessageProcessor 的类。即使原始数据被认为是无效的，因为 IDataProcessor 没有响应消息或其他任何东西的概念，它所做的只是验证原始数据。

为了通知 IMessageProcessor 有关错误，向 Message 类添加了一些附加属性：

```
bool nakError = false;
bool tailError = false;
bool crcError = false;
bool headerError = false;
bool lengthError = false; 
```

它们与协议无关，只存在于 IMessageProcessor

IMessageProcessor 是完成真正工作的地方。由于所有不同的消息组和类型，我决定使用 F# 来实现 IMessageProcessor 接口，因为模式匹配似乎是避免大量嵌套 if/else 和 caste 语句的好方法。（我之前没有使用过 F# 甚至是 LINQ 和 SQL 以外的函数式语言）

IMessageProcessor 分析数据并决定它应该在 IHardwareController 上调用哪些方法。拥有 IHardwareController 似乎是多余的，但我们希望能够将它换成不同的实现，而不是被迫使用 F#。当前的实现是一个 WPF 窗口，但它可能是一个 Cocoa# 窗口或只是一个控制台。

IHardwareController 还负责管理状态，因为开发人员应该能够通过用户界面操作硬件参数和错误。

因此，一旦 IMessageProcessor 调用了 IHardwareController 上的正确方法，它就必须生成响应消息。同样......这些响应消息中的数据可以有许多不同的结构。

最终，IDataFactory 用于将 Message 转换为原始协议数据，准备好发送到负责通信的任何类。（例如，可能需要对数据进行额外封装）

编写这段代码并不“难”，但所有不同的命令和数据结构都需要大量代码，而且我们可以重用的东西很少。（至少就我现在所见，希望有人能证明我错了）

这是我第一次使用 F#，所以我实际上是边学边学。下面的代码远未完成，可能看起来像一团糟。它只实现了协议中的所有消息中的一小部分，我可以告诉你有很多很多。所以这个文件会变得很大！

重要提示：字节顺序通过网络反转（历史原因）

```
module Arendee.Hardware.MessageProcessors

open System;
open System.Collections
open Arendee.Hardware.Extenders
open Arendee.Hardware.Interfaces
open System.ComponentModel.Composition
open System.Threading
open System.Text

let VPL_NOERROR = (uint16)0
let VPL_CHECKSUM = (uint16)1
let VPL_FRAMELENGTH = (uint16)2
let VPL_OUTOFSEQUENCE = (uint16)3
let VPL_GROUPNOTSUPPORTED = (uint16)4
let VPL_REQUESTNOTSUPPORTED = (uint16)5
let VPL_EXISTS = (uint16)6
let VPL_INVALID = (uint16)7
let VPL_TYPERROR = (uint16)8
let VPL_NOTLOADING = (uint16)9
let VPL_NOTFOUND = (uint16)10
let VPL_OUTOFMEM = (uint16)11
let VPL_INUSE = (uint16)12
let VPL_SIZE = (uint16)13
let VPL_BUSY = (uint16)14
let SYNC_BYTE = (byte)0xE3
let TAIL_BYTE = (byte)0x0D
let MESSAGE_GROUP_VERSION = 3uy
let MESSAGE_GROUP = 701us

[<Export(typeof<IMessageProcessor>)>]
type public StandardMessageProcessor() = class
    let mutable controller : IHardwareController = null               

    interface IMessageProcessor with
        member this.ProcessMessage m : Message = 
            printfn "%A" controller.Status
            controller.Status <- ControllerStatusExtender.DisableBit(controller.Status,ControllerStatus.Nak)

            match m with
            | m when m.LengthError -> this.nakResponse(m,VPL_FRAMELENGTH)
            | m when m.CrcError -> this.nakResponse(m,VPL_CHECKSUM)
            | m when m.HeaderError -> this.nakResponse(m,VPL_CHECKSUM)
            | m -> this.processValidMessage m
            | _ -> null      

        member public x.HardwareController
            with get () = controller
            and set y = controller <- y                 
    end

    member private this.processValidMessage (m : Message) =
        match m.Intro.MessageGroup with
        | 701us -> this.processDefaultGroupMessage(m);
        | _ -> this.nakResponse(m, VPL_GROUPNOTSUPPORTED);

    member private this.processDefaultGroupMessage(m : Message) =
        match m.Intro.MessageType with
        | (1us) -> this.firmwareVersionListResponse(m)                        //ListFirmwareVersions              0
        | (2us) -> this.StartLoadingFirmwareVersion(m)                     //StartLoadingFirmwareVersion       1
        | (3us) -> this.LoadFirmwareVersionBlock(m)                     //LoadFirmwareVersionBlock          2
        | (4us) -> this.nakResponse(m, VPL_FRAMELENGTH)                       //RemoveFirmwareVersion             3
        | (5us) -> this.nakResponse(m, VPL_FRAMELENGTH)                       //ActivateFirmwareVersion           3        
        | (12us) -> this.nakResponse(m,VPL_FRAMELENGTH)                       //StartLoadingBitmapLibrary         2
        | (13us) -> this.nakResponse(m,VPL_FRAMELENGTH)                       //LoadBitmapLibraryBlock            2        
        | (21us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //ListFonts                         0
        | (22us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //LoadFont                          4
        | (23us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //RemoveFont                        3
        | (24us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //SetDefaultFont                    3         
        | (31us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //ListParameterSets                 0
        | (32us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //LoadParameterSets                 4
        | (33us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //RemoveParameterSet                3
        | (34us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //ActivateParameterSet              3
        | (35us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //GetParameterSet                   3        
        | (41us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //StartSelfTest                     0
        | (42us) -> this.returnStatus(m)                                      //GetStatus                         0
        | (43us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //GetStatusDetail                   0
        | (44us) -> this.ResetStatus(m)                     //ResetStatus                       5
        | (45us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //SetDateTime                       6
        | (46us) -> this.nakResponse(m, VPL_FRAMELENGTH)                      //GetDateTime                       0
        | _ -> this.nakResponse(m, VPL_REQUESTNOTSUPPORTED)

    (* The various responses follow *)

    //Generate a NAK response
    member private this.nakResponse (message : Message , error) =
        controller.Status <- controller.Status ||| ControllerStatus.Nak
        let intro = new MessageIntro()
        intro.MessageGroupVersion <- MESSAGE_GROUP_VERSION
        intro.Address <- message.Intro.Address
        intro.SequenceNumber <- this.setHigh(message.Intro.SequenceNumber)
        intro.MessageGroup <- MESSAGE_GROUP
        intro.MessageType <- 130us
        let errorBytes = UShortExtender.ToIntelOrderedByteArray(error)
        let data = Array.zero_create(5)
        let x = this.getStatusBytes
        let y = this.getStatusBytes
        data.[0] <- 7uy
        data.[1..2] <- this.getStatusBytes
        data.[3..4] <- errorBytes      
        let header = this.buildHeader intro data
        let message = new Message()
        message.Header <- header
        message.Intro <- intro
        message.Tail <- TAIL_BYTE
        message.Data <- data
        message   

    //Generate an ACK response
    member private this.ackResponse (message : Message) =   
        let intro = new MessageIntro()
        intro.MessageGroupVersion <- MESSAGE_GROUP_VERSION
        intro.Address <- message.Intro.Address
        intro.SequenceNumber <- this.setHigh(message.Intro.SequenceNumber)
        intro.MessageGroup <- MESSAGE_GROUP
        intro.MessageType <- 129us
        let data = Array.zero_create(3);
        data.[0] <- 0x05uy
        data.[1..2] <- this.getStatusBytes
        let header = this.buildHeader intro data
        message.Header <- header
        message.Intro <- intro
        message.Tail <- TAIL_BYTE
        message.Data <- data
        message        

    //Generate a ReturnFirmwareVersionList
    member private this.firmwareVersionListResponse (message : Message) =
        //Validation
        if message.Data.[0] <> 0x00uy then
           this.nakResponse(message,VPL_INVALID)
        else
            let intro = new MessageIntro()
            intro.MessageGroupVersion <- MESSAGE_GROUP_VERSION
            intro.Address <- message.Intro.Address
            intro.SequenceNumber <- this.setHigh(message.Intro.SequenceNumber)
            intro.MessageGroup <- MESSAGE_GROUP
            intro.MessageType <- 132us    
            let firmwareVersions = controller.ReturnFirmwareVersionList();
            let firmwareVersionBytes = BitConverter.GetBytes((uint16)firmwareVersions.Count) |> Array.rev

            //Create the data
            let data = Array.zero_create(3 + (int)firmwareVersions.Count * 27)
            data.[0] <- 0x09uy                              //drcode
            data.[1..2] <- firmwareVersionBytes             //Number of firmware versions

            let mutable index = 0
            let loops = firmwareVersions.Count - 1
            for i = 0 to loops do
                let nameBytes = ASCIIEncoding.ASCII.GetBytes(firmwareVersions.[i].Name) |>  Array.rev
                let timestampBytes = this.getTimeStampBytes firmwareVersions.[i].Timestamp |> Array.rev
                let sizeBytes = BitConverter.GetBytes(firmwareVersions.[i].Size) |> Array.rev

                data.[index + 3 .. index + 10] <- nameBytes
                data.[index + 11 .. index + 24] <- timestampBytes
                data.[index + 25 .. index + 28] <- sizeBytes
                data.[index + 29] <- firmwareVersions.[i].Status
                index <- index + 27            

            let header = this.buildHeader intro data
            message.Header <- header
            message.Intro <- intro
            message.Data <- data
            message.Tail <- TAIL_BYTE
            message

    //Generate ReturnStatus
    member private this.returnStatus (message : Message) =
        //Validation
        if message.Data.[0] <> 0x00uy then
           this.nakResponse(message,VPL_INVALID)
        else
            let intro = new MessageIntro()
            intro.MessageGroupVersion <- MESSAGE_GROUP_VERSION
            intro.Address <- message.Intro.Address
            intro.SequenceNumber <- this.setHigh(message.Intro.SequenceNumber)
            intro.MessageGroup <- MESSAGE_GROUP
            intro.MessageType <- 131us

            let statusDetails = controller.ReturnStatus();

            let sizeBytes = BitConverter.GetBytes((uint16)statusDetails.Length) |> Array.rev

            let detailBytes = ASCIIEncoding.ASCII.GetBytes(statusDetails) |> Array.rev

            let data = Array.zero_create(statusDetails.Length + 5)
            data.[0] <- 0x08uy
            data.[1..2] <- this.getStatusBytes
            data.[3..4] <- sizeBytes    //Details size
            data.[5..5 + statusDetails.Length - 1] <- detailBytes

            let header = this.buildHeader intro data
            message.Header <- header
            message.Intro <- intro
            message.Data <- data
            message.Tail <- TAIL_BYTE
            message

    //Reset some status bytes    
    member private this.ResetStatus (message : Message) =
        if message.Data.[0] <> 0x05uy then
            this.nakResponse(message, VPL_INVALID)
        else        
            let flagBytes = message.Data.[1..2] |> Array.rev 
            let flags = Enum.ToObject(typeof<ControllerStatus>,BitConverter.ToInt16(flagBytes,0)) :?> ControllerStatus
            let retVal = controller.ResetStatus flags

            if retVal <> 0x00us then
                this.nakResponse(message,retVal)
            else
                this.ackResponse(message)

    //StartLoadingFirmwareVersion (Ack/Nak)
    member private this.StartLoadingFirmwareVersion (message : Message) =
        if (message.Data.[0] <> 0x01uy) then
            this.nakResponse(message, VPL_INVALID)
        else
            //Analyze the data
            let name = message.Data.[1..8] |> Array.rev |> ASCIIEncoding.ASCII.GetString
            let text = message.Data.[9..22] |> Array.rev |> Seq.map(fun x -> ASCIIEncoding.ASCII.GetBytes(x.ToString()).[0]) |> Seq.to_array |> ASCIIEncoding.ASCII.GetString
            let timestamp = DateTime.ParseExact(text,"yyyyMMddHHmmss",Thread.CurrentThread.CurrentCulture)

            let size = BitConverter.ToUInt32(message.Data.[23..26] |> Array.rev,0)
            let overwrite = 
                match message.Data.[27] with
                | 0x00uy -> false
                | _ -> true

            //Create a FirmwareVersion instance
            let firmware = new FirmwareVersion();
            firmware.Name <- name
            firmware.Timestamp <- timestamp
            firmware.Size <- size

            let retVal = controller.StartLoadingFirmwareVersion(firmware,overwrite)

            if retVal <> 0x00us then
                this.nakResponse(message, retVal) //The controller denied the request
            else
                this.ackResponse(message);

    //LoadFirmwareVersionBlock (ACK/NAK)
    member private this.LoadFirmwareVersionBlock (message : Message) =
        if message.Data.[0] <> 0x02uy then
            this.nakResponse(message, VPL_INVALID)
        else
            //Analyze the data
            let lastBlock = 
                match message.Data.[1] with
                | 0x00uy -> false
                | _true -> true

            let blockNumber = BitConverter.ToUInt16(message.Data.[2..3] |> Array.rev,0)            
            let blockSize = BitConverter.ToUInt16(message.Data.[4..5] |> Array.rev,0)
            let blockData = message.Data.[6..6 + (int)blockSize - 1] |> Array.rev

            let retVal = controller.LoadFirmwareVersionBlock(lastBlock, blockNumber, blockSize, blockData)

            if retVal <> 0x00us then
                this.nakResponse(message, retVal)
            else
                this.ackResponse(message)

    (* Helper methods *)
    //We need to convert the DateTime instance to a byte[] understood by the device "yyyymmddhhmmss"
    member private this.getTimeStampBytes (date : DateTime) =
        let stringNumberToByte s = Byte.Parse(s.ToString()) //Casting to (byte) would give different results

        let yearString = date.Year.ToString("0000")
        let monthString = date.Month.ToString("00")
        let dayString = date.Day.ToString("00")
        let hourString = date.Hour.ToString("00")
        let minuteString = date.Minute.ToString("00")
        let secondsString = date.Second.ToString("00")

        let y1 = stringNumberToByte yearString.[0]
        let y2 = stringNumberToByte yearString.[1]
        let y3 = stringNumberToByte yearString.[2]
        let y4 = stringNumberToByte yearString.[3]  
        let m1 = stringNumberToByte monthString.[0]
        let m2 = stringNumberToByte monthString.[1]
        let d1 = stringNumberToByte dayString.[0]
        let d2 = stringNumberToByte dayString.[1]
        let h1 = stringNumberToByte hourString.[0]
        let h2 = stringNumberToByte hourString.[1]
        let min1 = stringNumberToByte minuteString.[0]
        let min2 = stringNumberToByte minuteString.[1]
        let s1 = stringNumberToByte secondsString.[0]
        let s2 = stringNumberToByte secondsString.[1]

        [| y1 ; y2 ; y3 ; y4 ; m1 ; m2 ; d1 ; d2 ; h1 ; h2 ; min1 ; min2 ; s1; s2 |]

    //Sets the high bit of a byte to 1
    member private this.setHigh (b : byte) : byte = 
        let array = new BitArray([| b |])
        array.[7] <- true
        let mutable converted = [| 0 |]
        array.CopyTo(converted, 0);
        (byte)converted.[0]

    //Build the header of a Message based on Intro + Data
    member private this.buildHeader (intro : MessageIntro) (data : byte[]) =
        let headerLength = 7;
        let introLength = 7;
        let length = (uint16)(headerLength + introLength + data.Length)
        let crcData = ByteArrayExtender.Concat(intro.GetRawData(),data)
        let crcValue = ByteArrayExtender.CalculateCRC16(crcData)
        let lengthBytes = UShortExtender.ToIntelOrderedByteArray(length);
        let crcValueBytes = UShortExtender.ToIntelOrderedByteArray(crcValue);
        let headerChecksum = (byte)(SYNC_BYTE ^^^ lengthBytes.[0] ^^^ lengthBytes.[1] ^^^ crcValueBytes.[0] ^^^ crcValueBytes.[1])
        let header = new MessageHeader();
        header.Sync <- SYNC_BYTE
        header.Length <- length
        header.HeaderChecksum <- headerChecksum
        header.DataChecksum <- crcValue
        header

    member private this.getStatusBytes =
        let l = controller.Status
        let status = (uint16)controller.Status
        let statusBytes = BitConverter.GetBytes(status);
        statusBytes |> Array.rev

end 
```

（请注意，在真实来源中，类有不同的名称，比“硬件”更具体）

我希望得到建议、改进代码的方法，甚至是处理问题的不同方法。例如，使用 IronPython 等动态语言会不会让事情变得更容易，我是不是走错了路。你对这样的问题有什么经验，你会改变什么，避免什么等等......

**更新：**

根据布赖恩的回答，我写下了以下内容：

```
type DrCode9Item = {Name : string ; Timestamp : DateTime ; Size : uint32; Status : byte}
type DrCode11Item = {Id : byte ; X : uint16 ; Y : uint16 ; SizeX : uint16 ; SizeY : uint16
                     Font : string ; Alignment : byte ; Scroll : byte ; Flash : byte}
type DrCode12Item = {Id : byte ; X : uint16 ; Y : uint16 ; SizeX : uint16 ; SizeY : uint16}
type DrCode14Item = {X : byte ; Y : byte}

type DRType =
| DrCode0 of byte
| DrCode1 of byte * string * DateTime * uint32 * byte
| DrCode2 of byte * byte * uint16 * uint16 * array<byte>
| DrCode3 of byte * string
| DrCode4 of byte * string * DateTime * byte * uint16 * array<byte>
| DrCode5 of byte * uint16
| DrCode6 of byte * DateTime
| DrCode7 of byte * uint16 * uint16
| DrCode8 of byte * uint16 * uint16 * uint16 * array<byte>
| DrCode9 of byte * uint16 * array<DrCode9Item>
| DrCode10 of byte * string * DateTime * uint32 * byte * array<byte>
| DrCode11 of byte * array<DrCode11Item>
| DrCode12 of byte * array<DrCode12Item>
| DrCode13 of byte * uint16 * byte * uint16 * uint16 * string * byte * byte
| DrCode14 of byte * array<DrCode14Item> 
```

我可以继续为所有 DR 类型（很多）执行此操作，但我仍然不明白这对我有什么帮助。我已经在 Wikibooks 和 F# Foundations 中读到过它，但我的脑海中还没有出现什么问题。

**更新 2**

所以，我知道我可以执行以下操作：

```
let execute dr =
    match dr with
    | DrCode0(drCode) -> printfn "Do something"
    | DrCode1(drCode, name, timestamp, size, options) -> printfn "Show the size %A" size
    | _ -> ()
let date = DateTime.Now

let x = DrCode1(1uy,"blabla", date, 100ul, 0uy) 
```

但是当消息进入 IMessageProcessor 时，就可以选择它是什么类型的消息，然后调用适当的函数。以上只是附加代码，至少这是理解它的方式，所以我真的在这里错过了这一点......但我没有看到它。

```
execute x 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:26:44.053

我认为 F# 非常适合通过有区别的联合来表示该域中的消息；我在想象例如

```
type Message =
    | Message1 of string * DateTime * int * byte //name,timestamp,size,options
    | Message2 of bool * short * short * byte[]  //last,blocknum,blocksize,data
    ... 
```

以及从/向字节数组解析/解析消息的方法。正如你所说，这项工作很简单，只是乏味。

我对消息的处理不太清楚，但总的来说，根据您的描述，听起来您已经掌握了它。

我有点担心你的“工具灵活性”——你的限制是什么？（例如 .Net，必须由了解 X、Y、Z 技术的程序员维护，必须满足某些性能标准，...）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T09:39:56.013

这是我的 2 美分（警告：我不知道 F#）：您有一个精细指定的输入文件，即使有完整的语法。您希望将文件的内容映射到操作。因此，我建议您解析文件。F# 作为一种函数式语言，它可能适合称为[Recursive Descent Parsing](http://en.wikipedia.org/wiki/Recursive_descent_parser)的解析技术。[“Expert F#”一书](http://books.google.com/books?id=NcrMkjVxahMC&pg=PA477&lpg=PA477&dq=recursive+descent+f%23&source=bl&ots=pkrZIykmgL&sig=iCIYjID1aJII__oNzm1Jy48h6gg&hl=en&ei=rrb-SffmGcKZjAe-2fSRAw&sa=X&oi=book_result&ct=result&resnum=1#PPA475,M1)包含对递归下降解析的讨论。

# sql - 如何知道 Fluent NHibernate 生成的查询

> ID：819040
> 
> 赞同：23
> 
> 时间：2009-05-04T06:54:36.440
> 
> 标签：sql, nhibernate, logging, output

我正在使用 linq to Nhibernate 来触发一些对数据库的选择查询。

我的问题是，我怎么知道 Fluent NHibernate 生成的查询？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-22T12:09:55.897

使用 Fluent NHibernate，您可以像这样打开`show_sql`：

```
Fluently.Configure()
    .Database( MsSqlConfiguration.MsSql2005.ShowSql().ConnectionString(...) )... 
```

NHibernate 现在会将每个 sql 语句打印到`Console.Out`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T13:49:01.110

您可能还会发现这很有用[http://nhprof.com/](http://nhprof.com/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-10-07T15:16:51.753

如果您希望 SQL 在 log4net 中，请确保在配置部分中设置记录器。

我将 NHibernate 包放在“INFO”以减少噪音，并将 NHibernate.SQL 放在所有位置，以便我可以记录所有 SQL 语句。

```

 <logger name="NHibernate">
   <level value="INFO" />
 </logger>

  <logger name="NHibernate.SQL">
    <level value="ALL" />
  </logger>

```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-07-18T12:38:14.653

我找到了 4 个选项来了解 nhibernate 和流利的 nhibernate 中的 sql 查询。

1.  Log - Joey V. 在回答同样的问题时说。
2.  ShowSql - Kevin Berridge 在回答同样的问题时说。
3.  NHProf - 这是一个很棒的分析器。[NHProf](http://www.hibernatingrhinos.com/products/NHProf)
4.  Intercepter - 看到sql真是太好了。我们可以将它放在 Visual Studio 的输出中，甚至放在日志文件中。

    ```
    ISessionFactory sf = Fluently.Configure()
            .Database(MySQLConfiguration.Standard.ConnectionString(ConnectionString).ShowSql())
            .Mappings(m => m.FluentMappings.AddFromAssemblyOf<Stock>())
            .ExposeConfiguration(c => c.SetInterceptor(new ABCInterceptor()))
            .BuildSessionFactory();

    public class ABCInterceptor : EmptyInterceptor
    {
        public override NHibernate.SqlCommand.SqlString OnPrepareStatement(NHibernate.SqlCommand.SqlString sql)
        {
           Trace.WriteLine(sql.ToString());
           return sql;
        }
     } 
    ```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T06:56:45.653

看到[这个](https://www.hibernate.org/hib_docs/nhibernate/html/session-configuration.html)。你需要的是`hibernate.show_sql`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T13:51:34.523

[您也可以使用像这样的](http://anjlab.com/en/projects/opensource/sqlprofiler)sql 分析器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-16T06:11:26.380

绝对购买和使用[NHProf](http://nhprof.com/)。这是一个很棒的产品，它不仅向您展示了正在运行的查询，而且还向您展示了您的 NHibernate 映射和查询的任何潜在性能问题。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-22T18:46:25.230

你也可以挂在 log4net 中。

# sql-server - 如何从 SQL Server 2005 中的本地文件系统获取文件列表？

> ID：819042
> 
> 赞同：0
> 
> 时间：2009-05-04T06:56:26.810
> 
> 标签：sql-server, tsql

标题有点说，但我会详细说明一下。

我使用 SQL Server 2005，并且正在编写一个导出查询，它将返回一个用户列表。有些用户有个人资料图片，有些则没有。配置文件图像根本不存在于数据库中。文件系统上只有一个文件，名为 [username].jpg。所以我需要做的是检查用户是否存在这样的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:07:26.160

好吧，如果您必须这样做，您总是可以执行以下操作

```
DECLARE  @fso int,
         @hr int
EXECUTE @hr = sp_OACreate 'Scripting.FileSystemObject', @fso OUT 
```

从那里你可能（如果 hr=0）得到一个很好的旧[FileSystemObject](http://msdn.microsoft.com/en-us/library/6kxy1a51(VS.85).aspx)。

从那你应该能够做到以下几点

```
EXECUTE sp_OAMethod @fso, 'FileExists', @hr OUT, @FileName 
```

但说真的，因为想要这样做，你会去地狱****笑****

当然，这取决于很多事情，您的 SQL 服务器配置、运行它的用户等。您的里程可能会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T22:10:41.823

如果您必须从 sql 中执行此操作，您可以使用 xp_cmdshell 和“如果存在”。出于安全原因，默认情况下未启用此功能，因此请小心。

启用 xp_cmdshell：

```
sp_configure 'show advanced options', 1
reconfigure
sp_configure 'xp_cmdshell', 1
reconfigure 
```

使用 xp_cmdshell：

```
xp_cmdshell 'if exist c:\blargh.txt echo 1' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T07:20:12.197

是否有*充分*的理由不将图像存储在数据库中？您真的不想从数据库后端访问文件系统，因为授予数据库用户文件系统访问权限具有相当大的安全隐患。这留下了两个选择：将图像存储在数据库中，或仅从您的客户端应用程序访问文件。

# .net - 在 C++ 中实现 GetEnumerator

> ID：819045
> 
> 赞同：4
> 
> 时间：2009-05-04T06:56:43.550
> 
> 标签：.net, visual-c++, list, c++-cli, ienumerable

在 C# 中，我有以下类，它编译得很好：

`class CustomItem { }`

 ````
class CustomList : IList<CustomItem>
{
    public CustomItem this[int index]
    {
        get { return null; }
        set { throw new NotImplementedException(); }
    }
    public void CopyTo(CustomItem[] array, int arrayIndex)
    {
    }

    public int Count { get { return 10; } }
    public int IndexOf(CustomItem item) { throw new NotImplementedException(); }
    public void Insert(int index, CustomItem item) { throw new NotImplementedException(); }
    public void RemoveAt(int index) { throw new NotImplementedException(); }
    public void Add(CustomItem item) { throw new NotImplementedException(); }
    public void Clear() { throw new NotImplementedException(); }
    public bool Contains(CustomItem item) { throw new NotImplementedException(); }
    public bool IsReadOnly { get { return true; } }
    public bool Remove(CustomItem item) { throw new NotImplementedException(); }

    public IEnumerator<CustomItem> GetEnumerator() { throw new NotImplementedException(); }
    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    { throw new NotImplementedException(); }
} 
````  `当我在 C++ 中尝试相同的操作时，我得到了几个编译器错误：

`ref class CustomItemValue { };`

 ````
typedef CustomItemValue^ CustomItem;

ref class CustomList : public IList<CustomItem>
{
public:
    property CustomItem default[int]
    {
        virtual CustomItem get(int index) { return nullptr; }
        virtual void set(int index, CustomItem value) {}
    }
    virtual void CopyTo(array<CustomItem>^ array, int arrayIndex)
    {
    }

    property int Count { virtual int get() { return 10; } }
    virtual int IndexOf(CustomItem item) { throw gcnew NotImplementedException(); }
    virtual void Insert(int index, CustomItem item) { throw gcnew NotImplementedException(); }
    virtual void RemoveAt(int index) { throw gcnew NotImplementedException(); }
    virtual void Add(CustomItem item) { throw gcnew NotImplementedException(); }
    virtual void Clear() { throw new NotImplementedException(); }
    virtual bool Contains(CustomItem item) { throw gcnew NotImplementedException(); }
    property bool IsReadOnly { virtual bool get() { return true; } }
    virtual bool Remove(CustomItem item) { throw gcnew NotImplementedException(); }

    virtual IEnumerator<CustomItem>^ GetEnumerator() { throw gcnew NotImplementedException(); }
    virtual System::Collections::IEnumerator^ GetEnumerator()
    { throw gcnew NotImplementedException(); }
}; 
````  `来自编译器的错误消息是：

`.\mc.cpp(38) : error C2556: 'System::Collections::IEnumerator ^CustomList::GetEnumerator(void)' : overloaded function differs only by return type from 'System::Collections::Generic::IEnumerator ^CustomList::GetEnumerator(void)' with [ T=CustomItem ] .\mc.cpp(36) : see declaration of 'CustomList::GetEnumerator' .\mc.cpp(38) : error C2371: 'CustomList::GetEnumerator' : redefinition; different basic types .\mc.cpp(36) : see declaration of 'CustomList::GetEnumerator'`

谁能帮我这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T08:07:58.573

您需要使用 Microsoft 特定的显式覆盖语法来覆盖两个 GetEnumerator() 方法：

```
virtual System::Collections::IEnumerator^ GetEnumerator2() = System::Collections::IEnumerable::GetEnumerator
{ throw gcnew NotImplementedException(); }

virtual IEnumerator<CustomItem>^ GetEnumerator()
{ throw gcnew NotImplementedException(); } 
```

请注意，我将非泛型 GetEnumerator 方法重命名为 GetEnumerator2，然后指定它覆盖 System::Collections::IEnumerable::GetEnumerator。[您可以在此处](http://msdn.microsoft.com/en-us/library/fw0bbh51.aspx)找到有关显式覆盖的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T07:47:19.760

好吧，您在错误消息中有一个线索。您的 GetEnumerator 方法返回 System::Collections::IEnumerator^ 而该类还有另一个方法返回 System::Collections::Generic::IEnumerator^ ，此方法可能是从 IList 类继承的。

尝试用 System::Collections::Generic::IEnumerator^ 替换返回值。

# c# - 网络服务问题

> ID：819048
> 
> 赞同：-1
> 
> 时间：2009-05-04T06:59:28.847
> 
> 标签：c#

我建立 Web 服务，我定义 IP 连接（一切都很好）

但是，我如何在变量中定义 IP？

现在，我用 VS2008 中的查找和替换进行更改，然后右键单击

Web 服务属性。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T07:02:36.343

我不确定我是否理解您的问题，但我想您是在问如何让您的客户端应用程序在特定 IP 地址上调用 Web 服务？如果是这种情况，您的 App.config（或 web.config，如果它是 Web 客户端）中应该有一个部分，其中指定了 Web 服务的地址。

另一种选择是以编程方式进行（假设 Web 服务称为“MyService”）：

```
MyService serviceInstance = new MyService();
serviceInstance.Url = @"http://myserver/myservice.asmx";
// execute web service method of choice here... 
```

# mod-rewrite - mod_rewrite 如果你到处使用表达式，你能把它放在一个“变量”中吗？

> ID：819054
> 
> 赞同：0
> 
> 时间：2009-05-04T07:02:44.173
> 
> 标签：mod-rewrite

如果我在我的 htaccess 文件中使用以下 50 次：

重写规则 ^(bla|blo|bli|blu|bloi|bkdo|doid|boidi|woekj|dfpo8ds)/?$ /section_index.php?sectionurl=$1 [L]

那么是否可以将 bla|blo|bli|blu|bloi|bkdo|doid|boidi|woekj|dfpo8ds 放入变量中，而不是在每一行中再次使用它？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:07:58.763

您可以设置一个环境变量：

```
RewriteRule ^(bla|blo|bli|blu|bloi|bkdo|doid|boidi|woekj|dfpo8ds)/?$ /section_index.php?sectionurl=$1 [L,E=FOOBAR:$1] 
```

现在可以使用 访问该值`%{ENV:FOOBAR}`。

* * *

**编辑**    另一种方法是分步处理请求并链接规则：

```
# first path segment
RewriteRule ^(bla|blo|bli|blu|bloi|bkdo|doid|boidi|woekj|dfpo8ds)/?([^/].*)?$ $2?sectionurl=$1 [QSA,C]
# second path segment
RewriteRule ^(blog|foo)/?([^/].*)?$ $2?arg1=$1 [QSA,C]
# third path segment
RewriteRule ^(bar|baz)/?([^/].*)?$ $2?arg2=$1 [QSA,C]
# last rule
RewriteRule ^$ section_index.php [L,QSA] 
```

但是当你使用 PHP 时，你也可以使用 PHP 来解析请求路径，例如：

```
$_SERVER['REQUEST_URI_PATH'] = preg_replace('/\?.*/', '', $_SERVER['REQUEST_URI']);
$segments = explode('/', trim($_SERVER['REQUEST_URI_PATH'], '/'));
$argNames = array('sectionurl', 'arg1', 'arg2', 'arg3');
foreach ($segments as $i => $segment) {
    if (isset($argNames[$i])) {
        $_GET[$argNames[$i]] = $segment;
    }
}
var_dump($_GET); 
```

现在您只需使用以下规则将每个请求发送到该 PHP 文件：

```
# exclude requests for existing files
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ index.php [L] 
```

# asp.net - 属性中的 UserControl 默认值

> ID：819068
> 
> 赞同：15
> 
> 时间：2009-05-04T07:07:08.190
> 
> 标签：asp.net, user-controls, default

我有一个带有一些布尔属性的 UserControl。如果没有在 .aspx 页面中明确设置，我希望它们默认设置为 true，或者如果无法设置默认值，至少强制声明它们。我知道有一种方法可以做到这一点，因为许多控件都需要属性，当您尝试运行它并且它们没有被声明时会破坏您的应用程序。

我该怎么做呢？

例子：

```
<je:myControl runat="server" id="myControl" showBox="False"> 
```

如果 showBox 不在此声明中，我希望系统中断或将默认值设置为“true”。

谢谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2011-01-26T17:41:18.163

我知道我迟到了，但我只想提一下

```
[DefaultValue(false)] 
```

不会将该属性设置为 false。请参阅：http: [//msdn.microsoft.com/en-us/library/system.componentmodel.defaultvalueattribute.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.defaultvalueattribute.aspx)。它说：

“DefaultValueAttribute 不会导致成员使用属性值自动初始化。您必须在代码中设置初始值。”

此属性仅用于在 Visual Studio 设计器中指示您认为的默认值。如果有人使用您的控件更改了此值，它将显示为**粗体**，表示此值是非默认值。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-04T07:23:01.350

使用它们的默认值定义您的属性，如下所示：

```
private bool _ShowBox = false;
public bool ShowBox
{
    set { _ShowBox = value; }
} 
```

或在控件的构造函数中，设置默认值：

```
public MyControl()
{
    _ShowBox = false;
} 
```

如果未分配，则抛出异常：

```
private bool _ShowBox = false;
public bool ShowBox
{
    set { _ShowBox = value; }
    get { return _ShowBox; }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T07:22:35.110

声明变量时，只需设置所需的默认值：

```
class myControl
{
    private bool _showBox = true;

    [PersistenceMode(PersistenceMode.Attribute), DefaultValue(false)]
    public bool showBox
    {
        get { return _showBox; }
        set { _showBox = value; }
    }
} 
```

可选，您可以为设计器添加 DefaultValueAttribute。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-08T17:00:43.293

ReSharper 建议使用自动属性，并在构造函数中设置默认值，如下所示：

```
public class MyControl
{
  public MyControl()
  {
    ShowBox = true;
  }

  public bool ShowBox { get; set; }
} 
```

# c# - 下拉组合框样式时选择文本

> ID：819077
> 
> 赞同：0
> 
> 时间：2009-05-04T07:09:04.050
> 
> 标签：c#, .net, winforms, controls, combobox

当样式为下拉时，Windows 组合框出现问题。组合框包含两个值 - “hello”和“Hi”。我想在页面加载时显示我的 Windows 组合框的默认值是“Hello”。现在，当样式为 DropDown 时，它会选择整个文本（“hello”），这会在第一个控件和第三个控件之间造成混淆（因为焦点位于第一个控件（文本框）上，但看起来焦点位于第三个控件中，即组合框）。有人可以告诉我如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-24T16:11:42.223

我想你是说你有一个文本框和一个组合框。当表单加载时，组合框会选择“hello”（第一项）。此外，当表单加载时，实际焦点在文本框上，所以如果用户启动您的应用程序并开始输入，文本会进入文本框，但组合框中的所有文本都会突出显示，所以看起来用户的输入会进入组合框而不是文本框，它实际上最终会去哪里。

这是否描述了您的问题？

如果是这样，我认为您可以在 from_load() 方法中使用以下内容：

```
 comboBox1.SelectedIndex = 0; // Select first item in combo.

        // Uncomment next line if you want no text selected in the 
        // text box and the insertion point and end of textbox text.
        //textBox1.Select(textBox1.Text.Length, 0);

        textBox1.Select(); // Select the textbox. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T07:40:09.623

我会尝试将您的组合框下拉样式设置为 DropDownList ，看看是否可以为您提供您想要的结果

# html - 如何转换为px？

> ID：819079
> 
> 赞同：30
> 
> 时间：2009-05-04T07:10:36.153
> 
> 标签：html, fonts, font-size

我需要转换`<font size="10">`为 px。

仅示例（不正确）：`<font size="10">`相当于 12px。

是否有任何公式或表格转换可以转换`<font size="10">`为 px？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-04T07:25:02.170

```
<font size=1>- font size 1</font><br>
<span style="font-size:0.63em">- font size: 0.63em</span><br>

<font size=2>- font size 2</font><br>
<span style="font-size: 0.82em">- font size: 0.82em</span><br>

<font size=3>- font size 3</font><br>
<span style="font-size: 1.0em">- font size: 1.0em</span><br>

<font size=4>- font size 4</font><br>
<span style="font-size: 1.13em">- font size: 1.13em</span><br>

<font size=5>- font size 5</font><br>
<span style="font-size: 1.5em">- font size: 1.5em</span><br>

<font size=6>- font size 6</font><br>
<span style="font-size: 2em">- font size: 2em</span><br>

<font size=7>- font size 7</font><br>
<span style="font-size: 3em">- font size: 3em</span><br> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-04T07:19:15.663

根据[W3C](http://www.w3.org/TR/html401/present/graphics.html#h-15.2.2)：

> 此属性设置字体的大小。可能的值：
> 
> *   1 到 7 之间的整数。这会将字体设置为某个固定大小，其渲染取决于用户代理。并非所有用户代理都可以呈现所有七种尺寸。
> *   字体大小相对增加。值“+1”表示大一号。值“-3”表示小三个尺寸。所有尺寸都属于 1 到 7 的等级。

因此，您要求的转换是不可能的。浏览器不需要使用具有特定`size`属性的特定尺寸。

另请注意，`font`W3 不鼓励使用元素，而支持[样式表](http://www.w3schools.com/Css/css_font.asp)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-03-25T16:40:29.030

使用已接受答案中的数据点，您可以使用多项式插值来获得公式。

WolframAlpha 输入：插值多项式 {{1,.63},{2,.82}, {3,1}, {4,1.13}, {5,1.5}, {6, 2}, {7,3}}

公式：0.00223611x^6 - 0.0530417x^5 + 0.496319x^4 - 2.30479x^3 + 5.51644x^2 - 6.16717x + 3.14

并在 Groovy 代码中使用：

```
导入 java.math.*
def 转换 = {x -> (0.00223611*x**6 - 0.053042*x**5 + 0.49632*x**4 - 2.30479*x**3 + 5.5164*x**2 - 6.167*x + 3.14)。 setScale(2, RoundingMode.HALF_UP) }
(1..7).each { i -> println(convert(i)) }

```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-11-10T17:32:14.040

字体大小到 em 的映射只有在没有定义字体大小的情况下才是准确的，并且当您的容器设置为不同的大小时会发生变化。

以下对我来说效果最好，但它不考虑 size=7 并且大于 7 的任何东西都只呈现为 7。

```
font size=1 = font-size:x-small
font size=2 = font-size:small
font size=3 = font-size:medium
font size=4 = font-size:large
font size=5 = font-size:x-large
font size=6 = font-size:xx-large 
```

[![在此处输入图像描述](https://i.stack.imgur.com/a112U.png)](https://i.stack.imgur.com/a112U.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T07:14:42.210

一般来说，您不能依赖字体的固定像素大小，用户可能正在缩放屏幕并且默认值并不总是相同（取决于屏幕的 DPI 设置等）。

也许看看[这个](http://homepages.cwi.nl/~steven/vandf/2002.5-pixelpoint.html)（像素到点）和[这个链接](http://style.cleverchimp.com/font_size_intervals/altintervals.html)。

当然，您可以将字体大小设置为 px，这样您就可以知道字体实际是多少像素。如果您确实需要固定布局，这可能会有所帮助，但这种做法会降低您网站的可访问性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-04T06:26:55.843

这真的很旧，但`<font size="10">`大约 `<p style= "font-size:55px">`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-04T07:18:57.707

这不是那么容易回答的。这取决于使用的字体和每英寸点数 (ppi)。[这](http://style.cleverchimp.com/font_size_intervals/altintervals.html#cc)应该给出问题的概述。

# asp.net - asp.net 控件 ID 在单独的 JS 文件中

> ID：819082
> 
> 赞同：2
> 
> 时间：2009-05-04T07:11:25.527
> 
> 标签：asp.net, javascript, user-controls

我有一个带有一堆按钮和输入的自定义控件。我还有一个 JS 文件，我的所有代码都用于方便调试。

如何获取 JS 文件中控件的 ClientID？

我目前的解决方法是在控件顶部放置一个脚本块并将所有 JS 放在那里。不过我想要一些分离。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:15:43.737

将您的控件 ID 作为全局变量放入页面。然后在您的外部 javascript 文件中使用此全局变量作为对您的控件的引用。

在您的自定义控件、页面或用户控件中：

```
string script = "<script>var myButtonID = '" + myButton.ClientID + "';</script>";
if (!Page.ClientScript.IsClientScriptBlockRegistered("myGlobalVariables"))
{
    Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "myGlobalVariables", script);
} 
```

在您的外部 JS 文件中：

```
var myButton = document.getElementById(myButtonID);
//var myButton = $('#' + myButtonID); 
```

**编辑：**这是在您的 aspx/ascx 文件中呈现您的 controlID 的方法：

```
<script language="javascript">
     var myButtonID = '<%= muButton.ClientID %>';
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T20:00:21.200

我通常将对象文字作为参数传递给我的函数。这种方法消除了使用全局变量的需要，并使与 ASP.NET 控件/JavaScript 函数的断开连接变得不那么复杂和冗长：

**JavaScript：**

```
function fn(ids)
{
    var controlOne = ids.controlOne,
        controlTwo = ids.controlTwo,
        controlThree = ids.controlThree;
} 
```

**ASP.NET：**

```
fn({
    controlOne: "<%= ControlOne.ClientID %>",
    controlTwo: "<%= ControlTwo.ClientID %>",
    controlThree: "<%= ControlThree.ClientID %>"
}); 
```

另一种方法是通过类名来定位您的输入：

**ASP.NET：**

```
<asp:TextBox ... CssClass="controlone" />
<asp:TextBox ... CssClass="controltwo" />
<asp:TextBox ... CssClass="controlthree" /> 
```

**JavaScript：**

```
function fn()
{
    var controlOne = document.getElementsByClassName("controlone"),
        controlTwo = document.getElementsByClassName("controltwo"),
        controlThree = document.getElementsByClassName("controlthree");
} 
```

通过使用 jQuery 或其他一些 JavaScript 框架，所有这些都可以大大简化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T08:24:13.743

如果分离对您来说真的很重要，那么您可能需要考虑使用 jQuery，它有很多方法可以找到您的控件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-25T05:49:44.517

或者还有另一种方法，您将定义一个对象正在等待这样的 json 对象

```
this.Collection  = {'controlName': '<%= controlId.ClientID %>' } ; 
```

把它放在你的asp页面的末尾，第一部分将引用任何字符串来记住你的控件名称，第二部分是真正的clientID

在您的 javascript 文件中，您只需使用您分配的控件名称调用您的集合

```
alert(Collection['controlName']) ; // the result will be the clientid for the server side control 
```

希望它和你一起工作，因为它对我来说似乎很简单

# java - Eclipse 和类路径

> ID：819087
> 
> 赞同：-1
> 
> 时间：2009-05-04T07:12:34.087
> 
> 标签：java, eclipse, jdbc, classpath

我发誓我要疯了。

JDeveloper 运行我的项目时没有任何抱怨。

如果我执行“java -cp /usr/share/java/mysql.jar:.MAIN.java”，它就像一个魅力。

但是 Eclipse 说“[*审查*]你”并忽略了我的类路径设置。

我打开“运行”>“运行...”菜单，并在类路径选项卡中添加 mysql jar，但一次又一次，我不断收到“找不到合适的驱动程序”。

现在，我不应该将 jar 添加到构建路径 --- 否则，如果我想更改引擎，我要重建，使用 JDBC 有什么意义---。我也不应该做“ `Class.forName()`”，我不需要以其他方式运行它。

一只手，在这种精神错乱中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T07:15:30.947

当然，只需将您的 JRE 设置为正确的 Java6，而不是依赖 Eclipse 的自动配置。

是的，我在自言自语。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T07:22:00.493

尝试将 jar 添加为运行对话框中的命令行参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T07:36:39.507

这不是我通常将 jars 添加到 Eclipse 项目的方式。尝试按照此[Wiki](http://www.wikihow.com/Add-JARs-to-Project-Build-Paths-in-Eclipse-%28Java%29)中的步骤操作。

# java - 如何在主线程上的 java 中的某些代码周围设置超时？

> ID：819103
> 
> 赞同：7
> 
> 时间：2009-05-04T07:18:18.473
> 
> 标签：java, multithreading, timeout

我正在寻找与 ruby​​ 相同的 java 功能：

SystemTimer.timeout_after(30.seconds) 做某事结束

我可以通过分叉一个线程然后在一段时间后将其杀死来实现这一点，但是有没有更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T07:32:50.170

你不能只使用 Java [Timer](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Timer.html)吗？

> 线程调度任务以供将来在后台线程中执行的工具。任务可以安排为一次性执行，或定期重复执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T07:42:01.413

您可以创建一个[ThreadPoolExecutor](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)，它有一个[invokeAll](http://java.sun.com/javase/6/docs/api/java/util/concurrent/AbstractExecutorService.html#invokeAll(java.util.Collection,%20long,%20java.util.concurrent.TimeUnit))方法，该方法接收超时作为参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-27T21:17:06.083

您正在寻找的是[`CompletableFuture<T>`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html)来自 Java 8 的（链接到官方 JavaDoc）。

用法可能如下所示：

```
public static <V> Optional<V> of(PrivilegedAction<V> action, Duration duration) {

    final CompletableFuture<V> handler = CompletableFuture.supplyAsync(() -> action.run());
    V retval = null;
    try {
        retval = handler.get(duration.toMillis(), TimeUnit.MILLISECONDS);
    } catch (TimeoutException te) {
    } catch (Exception e) {
        try {
            handler.cancel(true);
        } catch (CancellationException ce) {
        }
    }
    return Optional.ofNullable(retval);
} 
```

我创建的一个实用程序类：（德语评论）[DTimeout](http://pastebin.com/Ra7yr9eF)（在 pastebin 中查看）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-04T07:26:44.413

在线程中运行它或执行以下操作：

```
void method() {
    long endTimeMillis = System.currentTimeMillis() + 10000;
    while (true) {
        // method logic
        if (System.currentTimeMillis() > endTimeMillis) {
            // do some clean-up
            return;
        }
    }
} 
```

如您所见，这不适用于所有类型的方法。

# asp.net - 了解 HTML 内容的页面大小 - Word 文档

> ID：819104
> 
> 赞同：0
> 
> 时间：2009-05-04T07:18:23.310
> 
> 标签：asp.net, html, ms-word

我已经生成了 HTML 内容，并且正在将其写入 word 文件。我想知道写入 Word 文档需要多少页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:23:06.293

这不能以一般的方式回答。要考虑字体大小、纸张大小、边距、布局等，并且确切的字体渲染也可能不同（字距调整等）。因此，只需创建 Word 文档（您可以使用 WordML）并让 word 为您计算页数。

# firefox - 如何从其他浏览器中删除 firebug 控制台？

> ID：819109
> 
> 赞同：0
> 
> 时间：2009-05-04T07:20:40.247
> 
> 标签：firefox, firebug

我用 Firefox 和 firebug 插件开发了我的网站，但是当我将它部署到其他浏览器（IE/Chrome）时，控制台窗口出现在屏幕底部（非常烦人）。

我怎样才能禁用它？为什么会出现？

加思

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T07:27:18.670

您的网站是否包含加载[Firebug Lite](http://getfirebug.com/lite.html)的脚本标签/... ？如果是这样，删除它们，萤火虫不应该再出现了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T07:44:54.480

还要确保删除代码中的所有[控制台命令](http://getfirebug.com/console.html)。我不知道这是否是您的原因，但它可能会导致其他浏览器出现错误。

# iphone - 在 UITabBarController 中打开一个视图

> ID：819130
> 
> 赞同：1
> 
> 时间：2009-05-04T07:33:31.200
> 
> 标签：iphone, cocoa-touch, uitabbarcontroller

我需要在我的标签栏中以编程方式打开某个标签。

我尝试从我的 UITabBarController 调用以下方法：

```
self.selectedViewController = myVController; 
```

这是行不通的。

打开标签的正确方法是什么？

谢谢你。

更新：我尝试了以下代码：

```
self.selectedViewController = [ [self viewControllers] objectAtIndex: 0]; 
```

这为我打开了一个理想的选项卡（它正在被选中），但活动视图没有被更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-02-16T22:37:09.393

关于该`selectedIndex`属性，Apple 的文档说：

> 在 3.0 之前的 iPhone OS 版本中，此属性仅反映所选标签栏项目的索引。尝试将此值设置为在选项卡栏中不可见但由更多导航控制器管理的视图控制器的索引没有效果。

也许这是你的问题？

一种可能的解决方法是使用您自己`UITabBar`的视图并处理您自己的视图。然后你可以做这样的事情：

```
[tabBar setSelectedItem:[tabBar.items objectAtIndex:1]]; 
```

只需实现`UITabBarDelegate`并定义此函数即可获取项目选择消息并手动切换视图。（尽管如果您使用的是高级`UITabBarController`功能，则可能不值得您付出努力。）

```
- (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item
{

} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-04T11:07:06.490

我这样做的方式是使用`self.tabBarController.selectedIndex = 1`（第一个选项卡位于索引 0）。

# binary - 远程检查网页以查看其是否为 ASCII 或二进制

> ID：819133
> 
> 赞同：0
> 
> 时间：2009-05-04T07:34:29.497
> 
> 标签：binary, ascii

是否可以远程检查（无本地/FTP 访问）URL 以查看网页（文件）是作为二进制文件还是 ascii 上传/创建的？

谢谢，

罗伊。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T07:38:43.027

不确定问题的价值（或者实际上是意图），但很有可能向网页发送 HTTP GET 请求并检查返回的内容。如果所有字节都在 0x20 到 0x7e 的范围内，您可以放心地假定它是 ASCII。超出该范围的任何内容都不是 ASCII。

也许如果您的问题更多地说明了您*为什么*要这样做，我们可以为您提供进一步的帮助。

如果您想确定该页面是以 ASCII 模式还是二进制模式通过 FTP 传送到服务器，如果服务器和上传它的机器是都是ASCII。

例如，如果您将二进制模式的 EBCDIC 文件上传到 ASCII 服务器，那将立即显而易见 :-)。

# c# - .NET 的 SMS 库

> ID：819134
> 
> 赞同：8
> 
> 时间：2009-05-04T07:35:21.630
> 
> 标签：c#, .net, vb.net, sms

任何人都知道免费的 SMS 库或 .NET 网络服务可以让我向人们的手机发送短信吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T08:03:34.793

你到底在找什么？图书馆或代理？

**库**只是一个 API，您可以以用户友好的方式对其进行编程……那里有数百个，因为您需要添加所有付费代理，它们都为您提供了编程的 API 。

如果您在谈论**代理**，则 98% 的代理不是免费的，并且您需要按月支付每条发送的 SMS 的费用，这取决于您。它们都有试用版（例如，您可以免费发送 100 条短信……通常称为 Credits）。

有一些 SMS 代理的开源项目，但对于 Linux 世界，如[Kannel](http://www.kannel.org/news.shtml)。

您可以使用 COMM 界面**制作自己**的手机，并拥有一个带有卡的旧手机，您可以向该卡片发送命令并基于此制作您自己的 API 界面（有很多免费 SMS 包，您所在的国家/地区可能也有）

现在......试试这个链接：

> [http://email2sms.ru/sms.php](http://email2sms.ru/sms.php)

还有一篇关于如何使用自己的手机发送短信的好文章：

> [http://www.oreillynet.com/pub/a/wireless/2003/10/10/sms.html](http://www.oreillynet.com/pub/a/wireless/2003/10/10/sms.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-17T09:17:09.263

试试[bulksms](http://www.bulksms.com/)，非常便宜，并在几乎每个国家提供本地短信费率的传入和传出服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T07:40:49.747

读写网

[http://www.readwriteweb.com/archives/zeep_mobile_free_sms_gateway.php](http://www.readwriteweb.com/archives/zeep_mobile_free_sms_gateway.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-25T07:50:37.133

其实我找到了一个很好的叫PennySMS。它有一个非常好的和简单的网络服务，我可以使用它，并且似乎适用于所有不同类型的手机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T07:45:22.807

Clickatel 和大多数其他 SMS 网关提供商提供一些试用积分。并且一些服务提供商提供Email2SMS 转换。即您可以发送电子邮件至+94xxxxxxx@yourprovider.com，它将以短信的形式发送。

这些信息不会直接回答您的问题，但它们对您的任务很有用..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-05T09:41:29.977

使用像 clickatell 这样的 SMS 提供商。发送 SMS 只需发送正确的 HTTP GET 请求，其中包含您的帐户信息、消息和收件人。请参阅：http: [//support.clickatell.com/guides/clickatell/api_guide.php](http://support.clickatell.com/guides/clickatell/api_guide.php)。

在 .NET 中，您只需使用`System.Net.WebClient`该类来创建正确的 HTTP GET 请求。文档： http: [//msdn.microsoft.com/en-us/library/system.net.webclient (VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.80).aspx)

# ajax - Web RAD 工具建议？

> ID：819135
> 
> 赞同：2
> 
> 时间：2009-05-04T07:35:45.903
> 
> 标签：ajax, visual-programming

我目前正在寻找好的（如果可能的话是免费的）Web RAD（快速应用程序开发）工具或 Visual Ajax IDE，比如[Morfik](http://www.morfik.com)或[Delphi for PHP](http://www.codegear.com/products/delphi/php)，具有更常用的部署方法（都创建独立的应用程序或 Web 服务器模块）。我的意思是 IDE 支持用于构建 Web 应用程序的拖放组件，结果是标准的 .(x)html 和 .js（可能还有 .php）文件，因此我可以立即将其上传到我最喜欢的 Web 主机。

我已经检查了[VisualWebGui](http://www.visualwebgui.com/)、[Visual Ajax Studio](http://www.wavemaker.com/product/)、[Visual Ajax Builder](http://www.backbase.com/products/visual-ajax-builder/)但都具有与上述相同的部署方法（一些使用 Java 平台）。

然后我看了一下[Sigma Visual](http://www.sigmawidgets.com/products/sigma_visual/)，检查了演示，但它太慢了......

也许更好地等待 Delphi 使用[EXTJS](http://extjs.com/)作为他们的 GUI 包的 PHP

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-03-16T19:27:15.840

我发现了这个：[VisualJS.NET](http://visualjs.net)（非常有趣和有前途）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T07:45:15.977

为什么你不只使用 Visual Studio Web Developer ？或[日食](http://eclipse.org)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-09T16:47:55.333

好好看看 ChrisSoftEng.co.uk。很多免费的东西 - RAD for the Web - Delphi PHP, Delphi VCL for Web, GO-Global for Windows on EC2。还有 Xajax 和 SVG 以及 Silverlight 和 Java Web Start。这是一个免费合作项目的网站。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-11T17:05:49.453

我使用[AlphaFive](http://www.alphafive.com)，查看他们的网站以获取支持和服务。

# java - 对程序或小型项目学习 Java 并发有什么建议吗？

> ID：819138
> 
> 赞同：17
> 
> 时间：2009-05-04T07:36:54.340
> 
> 标签：java, multithreading, concurrency

我的目标是学习Java中的并发性。目前我的知识水平很差。我很确定我知道“易失性”是什么意思。我有点知道“同步”是什么意思。有时。我从未编写过启动线程或管理线程的代码。在这个问题之外，我对使用 Java 工作感到自信和自在。

我正在为需要了解并发才能正确有效地工作的小型项目或程序寻找建议。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-04T20:26:27.020

编写一个矩阵乘法算法。并行化它。优化它。看看它是如何扩展的，特别是如果你有一台多核机器。那将是一个有趣的项目。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-04T07:51:44.103

尝试使用各种策略的数独解析器：

![](https://upload.wikimedia.org/wikipedia/commons/thumb/f/ff/Sudoku-by-L2G-20050714.svg/250px-Sudoku-by-L2G-20050714.svg.png)

*   3 个线程：1 个用于行，1 个用于列，1 个用于子方格
*   9 个线程：行 3 个（每 3 行 1 个线程），列 3 个，子方格 3 个
*   27 线程：9 行（每 1 行 1 线程）等

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-05-04T07:43:11.767

如果您真的刚刚开始，那么生产者-消费者问题可能是一个很好的开始方式：

[http://en.wikipedia.org/wiki/Producer-consumer_problem](http://en.wikipedia.org/wiki/Producer-consumer_problem)

不要阅读太多，因为 Wikipedia 文章也包含问题的解决方案 :-)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-03T14:12:59.650

我同意@Julien 关于 mtrix multiplication 的观点。在这个问题中，线程使用带来的改进会更加明显。
但正如@dfa 所说，我不同意数独。这不够明智
例如这是我在线程中编写 Matrix-Mul 的结果

```
 %        self                        
time    seconds   name    
32.38    10.72    Simple
21.29    7.05     Tiling
15.58    5.16     SimpleThread
9.63     3.19     ThreadTiling 
```

这是 1000*1000 矩阵相乘的结果。您可以很容易地看到，多少线程可以提高您的程序速度。（平铺是一种用于提高缓存命中率的技术）

之后，当您熟悉语法后，您可能会深入研究经典问题。它们可能更具挑战性，但它可以帮助您熟悉解决并发问题的模式。
我建议看一下[关于信号量的小书](http://greenteapress.com/semaphores/)。它如此全面，可以帮助你把握这些问题背后的思路。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T07:41:22.927

这不是一个完整的项目，但它也包含一些源代码。我认为这对于深入了解线程非常有用。

[Java中的线程](http://www.javaworld.com/javaworld/jw-04-1996/jw-04-threads.html?page=1)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T07:42:38.807

[如果您是一位经验丰富的程序员，那么创建一个使用Fix Protocol](http://www.fixprotocol.org/)来规定股价的小型服务器可能会很有趣。它需要能够处理需要并发的多个客户端（然后你可以学习 Swing 或一些 Web 技术）。

如果您是初学者，我建议您使用一些更简单的方法，例如带有几个消费者线程的生产者线程，如果您能以图形方式显示该过程，您将获得加分。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-04T07:51:10.563

并发和网络的一个常见学习项目是编写一个聊天程序。它类似于 FIX 服务器建议，但您只需传递文本。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-04T07:53:25.863

当我在大学阅读并发系统编程时，我们构建了一个视频监控系统 - 一台主 PC 从一台或多台带有网络摄像头的从属 PC 获取视频数据。我记得那个项目，因为它真的让你了解高效的网络编程、实时问题和 JNI :)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-04T13:33:52.050

我强烈推荐[Java Concurrency In Practice](http://www.javaconcurrencyinpractice.com/)一书作为您选择的任何项目的资源。

# php - 从文本中删除 url

> ID：819144
> 
> 赞同：0
> 
> 时间：2009-05-04T07:41:18.323
> 
> 标签：php, regex, url

如何剥离网址并将其放回同一位置？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T07:46:25.940

使用正则表达式..您可以使用正则表达式轻松检测 URL。

[检测 URL](http://www.regexguru.com/2008/11/detecting-urls-in-a-block-of-text/)

[替换模式](http://www.webcheatsheet.com/php/regular_expressions.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T08:43:33.213

正则表达式符合 rfc3986 的 url 的方法并不多

作为 C 字符串，正则表达式将是：

```
"^(([^:/?#]+):)?(//([^/?#]*)|///)?([^?#]*)(\\?[^#]*)?(#.*)?"
enum {
    URL = 0,
    SCHEME_CLN = 1,
    SCHEME  = 2,
    DSLASH_AUTH = 3,
    AUTHORITY = 4,
    PATH    = 5,
    QUERY   = 6,
    FRAGMENT = 7
}; 
```

其中枚举表示哪些捕获索引对应于哪些 url 部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T12:21:20.413

您可能正在寻找 [ `preg_replace_callback`]( [http://www.php.net](http://www.php.net) . /preg_replace_callback)。

它只是匹配正则表达式模式，将结果提供给您提供的函数，并将原始匹配替换为其返回值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T12:56:54.370

Jeff Atwood 有一篇关于您可能面临的问题的[信息性帖子。](https://blog.codinghorror.com/the-problem-with-urls/)

无论您使用哪种编程语言和库，在某些情况下您都会遇到问题，例如——http: [//www.codinghorror.com/blog/archives/001181.html——](http://www.codinghorror.com/blog/archives/001181.html--)在使用简单的正则表达式替换时。

我不经常使用 PHP，但问题归结为试图找出在[preg_replace](https://php.net/preg_replace)调用中使用的模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T07:52:27.690

如果您想将相同的 URL 放回其初始位置，为什么要首先删除它/您到底想做什么。多一点上下文将帮助我们帮助你。

# php - 开始使用 cron 作业和 PHP（Zend 框架）

> ID：819148
> 
> 赞同：3
> 
> 时间：2009-05-04T07:42:26.217
> 
> 标签：php, zend-framework, cron, queue, scheduled-tasks

我对 cron 工作的主题完全陌生，所以我不知道从哪里开始学习它们；何时、为什么或如何将它们与我的 Zend Framework 应用程序或 PHP 一起使用。

谁能用一个例子解释这个过程，或者推荐一些好的资源来开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T07:50:58.130

Cron 作业是一种在 Linux 操作系统中自动执行任务的机制。Zend 框架几乎没有什么可做的。不过，该框架可以帮助您在 php 中开发高级 cron 任务。但是你将不得不在 shell 中设置你的 cron 作业。

谷歌搜索“如何设置 cron 作业”在顶部显示了此链接：

[http://www.adminschoice.com/docs/crontab.htm](http://www.adminschoice.com/docs/crontab.htm)

我相信这篇文章会对你有所帮助。

附言

作为要执行的命令，您应该输入以下内容：

`/usr/local/bin/php -f <path_to_your_php_script>`

其中第一个路径是您的 php cli 可执行文件的完整路径，在您的机器上可能会有所不同。您可以通过发出以下命令来确保：

`which php`

祝 cron 工作好运；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T08:48:36.603

也许一个现实生活中的例子会有所帮助。几年前，我使用 Zend 框架参与了一个事件日历项目。在此日历中，用户可以创建一个事件并将 1 个或多个日期附加到该事件。自然，我在我的数据库中将其实现为多对一连接，但这意味着为了附加日期，事件必须首先存在。但是，我希望允许用户在创建事件时添加日期*，而*不是*在*创建事件之后。换句话说，我希望用户同时编辑事件的所有方面，并且仅在他们单击“保存”时提交。

当用户开始创建事件记录时，我通过将新的空事件记录插入数据库来解决问题。当用户单击“保存”时，该空记录被填充并保存，或者当用户单击“取消”时被删除。问题发生在用户没有点击“取消”就离开，数据库中留下了空的事件记录。最终，数据库会被这些无意义的空事件填满，事情可能会变得很糟糕。

我编写了一个名为“maintenance()”的函数，除其他外，它删除了所有超过 24 小时的未保存记录。我设置了一个每晚运行的 cron 作业并执行一个运行维护（）的命令行 php 脚本。

您可能会使用 cron 作业的其他事情：

*   向新用户发送一批电子邮件。（每 5 分钟一次？）
*   更新用户统计信息（每小时？）
*   在服务器没有流量的情况下执行资源密集型操作（每晚午夜，还是每周日晚上一次？）
*   没有响应用户请求而发生的任何其他事件（Jeff 称之为“带外”）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T07:53:10.510

由于 Zend 框架是某种松散耦合组件的集合，您可以在每个 PHP 脚本（包括 CLI 脚本）中使用您喜欢的组件。不过，您必须确保 PHP 可以找到相关的 Zend Framework 类，因此您必须将 Zend Framework 库路径添加到您的`include_path`. 然后，您可以使用`Zend_Loader_Autoloader`(ZF >= 1.8) 或`Zend_Loader`(ZF < 1.8) 设置自动加载，让生活更轻松。现在，您应该可以访问所有可以随意使用的 Zend Framework 组件。

像所有其他脚本或程序一样，这个 PHP 脚本可以自然地用于 cron 作业。还有一点需要注意的是，您必须确保运行您的 cron 作业的用户对 Zend Framework 库路径具有读取权限，否则 PHP 无法读取 Zend Framework 文件。

如果您的问题是针对在 CLI 脚本中使用 MVC 组件，我必须承认我在这方面没有任何经验。我认为必须付出不可忽视的努力来实现适当的请求、响应、调度程序和路由类。

**编辑：**

请参阅[这篇文章](http://www.ibm.com/developerworks/opensource/library/os-php-fwk5/?ca=dgr-btw01PHP-CRON-Tasks)了解更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T08:09:59.300

您可能还对[如何使用 ZF 存储 cron 作业感兴趣](https://stackoverflow.com/questions/505552/how-do-you-store-your-scripts-for-cron-jobs-in-zend-framework)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-03T15:15:10.933

这是使用 Zend Framework 实现 cron 系统的好方法的链接：

[Zend Framework 应用程序中的 Cron 任务](http://jazzslider.org/2010/01/12/cron-tasks-in-zend-framework-apps)

个人而言，我已经对其进行了调整，因此参数可以是动态的，但基础是相同的:-)

# ruby-on-rails - 如何在 Rails 中对命名范围进行分组/重用？

> ID：819160
> 
> 赞同：0
> 
> 时间：2009-05-04T07:49:11.147
> 
> 标签：ruby-on-rails

如何对命名范围进行分组？例如，我有两个模型，用户和活动。一个用户可以有很多活动。

Activity 有两个命名范围：

```
Activity.ordered_by_created_at
Activity.top_20 
```

我想创建一个新的命名范围`Activity.recent`，这样

```
Activity.recent == Activity.ordered_by_created_at.top_20 
```

这样，我可以打电话给最近`user.activities`。

```
user.activities.recent 
```

这可能吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T13:31:08.203

您可能可以这样做：

```
class Activity < ActiveRecord::Base
  def self.recent
    ordered_by_created_at.top_20
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T20:40:51.413

当您调用 user.activities 时，假设您的 user.rb 文件中有一个 has_many :activities 关系，ActiveRecord 将返回一个包含所有用户活动的数组。

可能要考虑更改方法 la Activtiy.recent.user(UID) 并在您的 activity.rb 文件中编写一个 named_scope 来查找与该活动相关的用户。

# css - ap 元素的默认填充和/或边距是多少（重置 css）？

> ID：819161
> 
> 赞同：40
> 
> 时间：2009-05-04T07:49:14.703
> 
> 标签：css

很长一段时间以来，我一直在使用重置 CSS 样式集，每次创建新网站时，重置最让我烦恼的是重置 ap 标签边距和填充。我明白为什么，但我想知道 ap 元素上的“默认”填充和/或边距应该是什么？

我猜这在浏览器中并不一致，并且通常需要针对每个站点进行调整，但是是否有一组最常见的边距和/或填充值？

短版：它是（例如）5px 的边距*和*顶部*和*底部的填充......还是其他什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-04T08:00:37.717

[CSS 2.1 规范](http://www.w3.org/TR/CSS21/)有一个HTML 4的[默认样式表](http://www.w3.org/TR/CSS21/sample.html)。它只是提供信息而不是规范，因此浏览器可以使用它，但不必这样做。

另一个资源可能是浏览器的 webdeveloper 工具。大多数可以向您显示应用于特定元素的级联规则。一个例子：Firefox 和 Safari (WebKit) 似乎`margin: 1em 0px`用于`p`元素。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-07-28T19:24:38.313

为了在浏览器之间平衡，我使用

```
p{
  margin:0;
}
p + p{
  margin-top:10px;
} 
```

这样我就不会“制动”容器原始的顶部/底部间距，并且如果有多个段落，仍然可以很好地分隔段落。

我只是不喜欢看到 p 像这样推送父容器

```
.container {
  border: 1px solid #ccc;
  padding: 15px;
}
```

```
<div class="container">
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec fringilla, est et ultricies porttitor, augue purus condimentum mi, vel congue nunc est vitae diam. Proin.</p>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec fringilla, est et ultricies porttitor, augue purus condimentum mi, vel congue nunc est vitae diam. Proin.</p>
</div>
```

并将其视为理想的解决方案

```
.container {
  border: 1px solid #ccc;
  padding: 15px;
}
p{
  margin:0;
}
p + p{
  margin-top:10px;
}
```

```
<div class="container">
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec fringilla, est et ultricies porttitor, augue purus condimentum mi, vel congue nunc est vitae diam. Proin.</p>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec fringilla, est et ultricies porttitor, augue purus condimentum mi, vel congue nunc est vitae diam. Proin.</p>
</div>
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-05-26T09:10:10.137

P 标签上下边距为 16px。

这类似于给样式 margin: 16px 0px; 到一个段落。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T07:59:42.680

CSS RESET 将 p 标签的边距和内边距重置为 0px，常见的边距和内边距取决于您的布局和内容类型。

您仍然可以使用 5px 作为您自己的默认边距和填充

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-03T07:52:17.690

我总是用火狐。

通过萤火虫插件，我发现默认的margin-top/bottom

tag 设置为 16px，padding 设置为 0，而 body 元素的 margin-top/bottom/right/left 设置为 8px。

# php - 什么是关键字密度以及如何在 PHP 中创建脚本？

> ID：819166
> 
> 赞同：7
> 
> 时间：2009-05-04T07:50:29.177
> 
> 标签：php, seo, keyword

我正在做一个项目，我必须根据该页面的 URL 找出该页面的关键字密度。我用谷歌搜索了很多，但没有找到帮助和脚本，我找到了一个付费工具[http://www.selfseo.com/store/_catalog/php_scripts/_keyword_density_checker_php_script](http://www.selfseo.com/store/_catalog/php_scripts/_keyword_density_checker_php_script)

但我实际上并不知道“页面的关键字密度”实际上是什么意思？还请告诉我如何创建一个 PHP 脚本来获取网页的关键字密度。

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-03-22T13:58:00.867

“关键字密度”只是单词出现的频率，以单词总数的百分比给出。以下 PHP 代码将输出字符串中每个单词的密度，`$str`. 它表明关键字密度不是一个复杂的计算，它可以在几行 PHP 中完成：

```
<?php
$str = "I am working on a project where I have to find out the keyword density of the page on the basis of URL of that page. But I am not aware actually what \"keyword Density of a page\" actually means? and also please tell me how can we create a PHP script which will fetch the keyword density of a web page.";

// str_word_count($str,1) - returns an array containing all the words found inside the string
$words = str_word_count(strtolower($str),1);
$numWords = count($words);

// array_count_values() returns an array using the values of the input array as keys and their frequency in input as values.
$word_count = (array_count_values($words));
arsort($word_count);

foreach ($word_count as $key=>$val) {
    echo "$key = $val. Density: ".number_format(($val/$numWords)*100)."%<br/>\n";
}
?> 
```

示例输出：

```
of = 5\. Density: 8%
a = 4\. Density: 7%
density = 3\. Density: 5%
page = 3\. Density: 5%
... 
```

要获取网页的内容，您可以使用[file_get_contents](http://php.net/manual/en/function.file-get-contents.php)（或[cURL](http://php.net/manual/en/book.curl.php)）。例如，以下 PHP 代码列出了该网页上所有高于 1% 密度的关键字：

```
<?php
$str = strip_tags(file_get_contents("http://stackoverflow.com/questions/819166"));

$words      = str_word_count(strtolower($str),1);
$word_count = array_count_values($words);

foreach ($word_count as $key=>$val) {
    $density = ($val/count($words))*100;
    if ($density > 1)
        echo "$key - COUNT: $val, DENSITY: ".number_format($density,2)."%<br/>\n";
}
?> 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-10-28T15:32:50.317

或者你可以试试这个：~~[http](http://code.eyecatch-up.de/?p=155)~~
**://code.eyecatch-up.de/?p=155更新：**将课程重新定位到[http://code.google.com/p/php-class-keyword-density-check/](http://code.google.com/p/php-class-keyword-density-check/)

```
<?php
include 'class/class.keywordDensity.php';             // Include class  

$obj = new KD();                                      // New instance
$obj->domain = 'http://code.eyecatch-up.de';          // Define Domain
print_r ($obj->result()); 
?> 
```

上面的代码返回：

```
Array
(
    [0] => Array
        (
            [total words] => 231
        )

    [1] => Array
        (
            [keyword] => display
            [count] => 14
            [percent] => 6.06
        )
and so on... 
```

适用于本地和远程文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-07T10:32:15.030

关键字密度大致为：

（页面上出现关键字的次数）/（其他关键字的总数）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T07:56:13.063

关键字密度仅表示关键字出现在内容中相对于文本其余部分的百分比。一般来说，它也是一个相当无用的 SEO 指标。我不会费心为它构建脚本，因为你最好专注于其他指标。您可能会发现此[参考](http://www.seomoz.org/article/search-ranking-factors)很有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T08:03:09.927

如果给定的关键字是“大象行走”，则关键字密度将是术语“大象行走”相对于其他文本出现在任何给定网页上的频率。正如 VirtuosiMedia 所说，这是（广泛）无用的信息。

要衡量它，您必须从文本中去除所有标记，计算单词同时跟踪关键字出现的频率。

到那时，您就会知道，该文本中所有单词的 xx.xx % 是关键字。xx.xx % 的时间，关键字彼此相邻使用，因此“大象散步”的关键字密度是 xx

同样，这很有用的唯一原因是在 php.ini 中演示模式匹配和字符串函数。

# optimization - 如何优化 PDF 文件大小？

> ID：819180
> 
> 赞同：8
> 
> 时间：2009-05-04T07:57:04.637
> 
> 标签：optimization, pdf, size

我有一个输入 PDF 文件（通常，但并不总是由 pdfTeX 生成），我想将其转换为输出 PDF，它在视觉上是等效的（无论分辨率如何），它具有相同的元数据（Unicode 文本信息、超链接、轮廓等），但文件大小尽可能小。

我知道以下方法：

*   `java -cp Multivalent.jar tool.pdf.Compress input.pdf`（来自[http://multivalent.sourceforge.net/](http://multivalent.sourceforge.net/)）。这将重新压缩所有流、删除未使用的对象、统一等效对象、压缩空格、删除默认值、压缩交叉引用表。
*   使用 jbig2 和 PNGOUT 重新压缩合适的图像。
*   将 Type1 字体重新编码为 CFF 字体。
*   统一等效图像。
*   将相同字体的子集统一为更大的子集。
*   删除可填写的表格。
*   在蒸馏或以其他方式转换（例如`gs -sDEVICE=pdfwrite`）时，请确保它不会降低图像质量，并且不会增加（！）图像大小。

我知道以下技术，但它们不适用于我的情况，因为我已经有一个 PDF：

*   使用更小和/或更少的字体。
*   使用矢量图像而不是位图图像。

您还有其他如何优化 PDF 的想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T07:59:58.623

优化 PDF 文件

避免重制图形

对于必须作为位图插入的图形，为它们准备最大可压缩性和最小尺寸。在 PDF 的输出分辨率下使用质量最好的图像。将压缩的 JPEG 插入 PDF 并提取它们可能会重新压缩 JPEG，这会产生明显的伪影。使用黑白图像和文本而不是彩色图像，以允许使用在单色压缩方面表现出色的新 JBIG2 标准。为 Web 保存 PDF 时，请务必关闭缩略图。使用矢量图形

对于通常会制作成 GIF 的图像，尽可能使用基于矢量的图形。矢量图像完美缩放，看起来很棒，并且它们的数学公式通常比描述每个像素的位图图形占用更少的空间（尽管在某些情况下位图图形实际上小于矢量图形）。您还可以使用 PDF 格式中内置的 ZIP 压缩来压缩矢量图像数据。Acrobat Reader 版本 5 和 6 也支持 SVG 标准。最小化字体

您如何使用字体，尤其是在较小的 PDF 中，会对文件大小产生重大影响。尽量减少您在文档中使用的字体数量，以尽量减少它们对文件大小的影响。每个额外的完全嵌入字体可以轻松占用 40K 的文件大小，这就是为什么大多数作者创建仅包含实际使用的字形的“子集”字体。压扁脂肪形式

Acrobat 表单会占用 PDF 中的大量空间。在 Acrobat 8​​ Pro 中，您可以在“高级”->“PDF 优化器”->“放弃对象”对话框中展平表单域。扁平化表单使表单字段不可用，并且表单数据与页面合并。您还可以使用 Apago 的 PDF Enhancer 通过删除文件中存在但从未实际使用过的信息来减少 50% 的表单。您还可以将重新发布的 PDF 与旧表单页面结合起来，在 Acrobat 中创建混合 PDF（请参阅下面的“重新发布的 PDF”部分）。

见[文章](http://websiteoptimization.com/speed/tweak/pdf/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-04T06:58:19.537

从 PDF 规范版本 1.5 开始，有两种新的压缩方法，对象流和交叉引用流。

您提到`Multivalent.jar`压缩工具压缩交叉引用表。这通常意味着交叉引用表被转换为流，然后被压缩。

此交叉引用流的格式不固定。您可以更改数据的三个“列”的位大小。还可以使用预测函数对流数据进行预处理，这将提高数据的压缩级别。如果您使用文本编辑器查看 PDF，您可能能够`/Predictor`在交叉引用流字典中找到条目，以检查您使用的工具是否利用了此功能。

在压缩上使用预测器对于图像也可能很方便。

提供的第二种压缩方式是使用对象流。

通常在 PDF 中您有许多相似的对象。现在可以将这些组合成一个对象，然后进行压缩。Multivalent Compress 工具的文档提到使用了对象流，但没有关于实际选择将哪些对象组合在一起的详细信息。如果将相似的对象组合到一个对象流中，压缩效果会更好。

# php - 如何在 PHP 中获取网页的 HTML 代码？

> ID：819182
> 
> 赞同：102
> 
> 时间：2009-05-04T07:57:08.880
> 
> 标签：php, html

我想在 PHP 中检索链接（网页）的 HTML 代码。例如，如果链接是

[https://stackoverflow.com/questions/ask](https://stackoverflow.com/questions/ask)

然后我想要提供的页面的 HTML 代码。我想检索此 HTML 代码并将其存储在 PHP 变量中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2009-05-04T08:02:20.193

如果您的 PHP 服务器允许 url fopen 包装器，那么最简单的方法是：

```
$html = file_get_contents('https://stackoverflow.com/questions/ask'); 
```

如果您需要更多控制，那么您应该查看[cURL](http://www.php.net/curl)函数：

```
$c = curl_init('https://stackoverflow.com/questions/ask');
curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
//curl_setopt(... other options you want...)

$html = curl_exec($c);

if (curl_error($c))
    die(curl_error($c));

// Get the status code
$status = curl_getinfo($c, CURLINFO_HTTP_CODE);

curl_close($c); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-04T09:01:07.103

此外，如果您想以某种方式操作检索到的页面，您可能想尝试一些 php DOM 解析器。我发现[*PHP Simple HTML DOM Parser*](http://simplehtmldom.sourceforge.net/) 非常易于使用。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-04T08:45:37.843

您可能想查看 Yahoo 的 YQL 库：http: [//developer.yahoo.com/yql](http://developer.yahoo.com/yql)

手头的任务很简单

```
select * from html where url = 'http://stackoverflow.com/questions/ask' 
```

您可以在控制台中尝试此操作：http: [//developer.yahoo.com/yql/console](http://developer.yahoo.com/yql/console)（需要登录）

另请参阅 Chris Heilmanns 的截屏视频，了解一些不错的想法，您还可以做什么：http: [//developer.yahoo.net/blogs/theater/archives/2009/04/screencast_collat​​ing_distributed_information.html](http://developer.yahoo.net/blogs/theater/archives/2009/04/screencast_collating_distributed_information.html)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-04T08:04:11.093

**简单的方法：**使用[`file_get_contents()`](http://de3.php.net/file_get_contents)：

```
$page = file_get_contents('http://stackoverflow.com/questions/ask'); 
```

请注意，您`allow_url_fopen`必须能够使用 URL 感知 fopen 包装器。`true``php.ini`

**更高级的方法：**如果您无法更改 PHP 配置，默认情况下`allow_url_fopen`是`false`，如果安装了 ext/curl，则使用该[`cURL`库](http://de3.php.net/manual/en/book.curl.php)连接到所需的页面。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-04-03T13:36:44.697

**这是从 URL 获取内容**的两种不同的简单方法：

1）第一种方法

从您的主机（php.ini 或其他地方）启用 Allow_url_include

```
<?php
$variableee = readfile("http://example.com/");
echo $variableee;
?> 
```

或者

2）第二种方法

启用 php_curl、php_imap 和 php_openssl

```
<?php
// you can add anoother curl options too
// see here - http://php.net/manual/en/function.curl-setopt.php
function get_dataa($url) {
  $ch = curl_init();
  $timeout = 5;
  curl_setopt($ch, CURLOPT_URL, $url);
  curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0)");
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($ch, CURLOPT_SSL_VERIFYHOST,false);
  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER,false);
  curl_setopt($ch, CURLOPT_MAXREDIRS, 10);
  curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
  curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $timeout);
  $data = curl_exec($ch);
  curl_close($ch);
  return $data;
}

$variableee = get_dataa('http://example.com');
echo $variableee;
?> 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-04T08:02:21.550

看看这个函数：

[http://ru.php.net/manual/en/function.file-get-contents.php](http://ru.php.net/manual/en/function.file-get-contents.php)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-01-27T02:17:43.197

如果您想将源存储为变量，则可以使用 file_get_contents，但是 curl 是一种更好的做法。

```
$url = file_get_contents('http://example.com');
echo $url; 
```

此解决方案将在您的网站上显示网页。然而 curl 是一个更好的选择。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-12-18T12:20:07.403

```
include_once('simple_html_dom.php');
$url="http://stackoverflow.com/questions/ask";
$html = file_get_html($url); 
```

您可以使用此代码将整个 HTML 代码作为数组（解析形式）在此处下载“simple_html_dom.php”文件 [http://sourceforge.net/projects/simplehtmldom/files/simple_html_dom.php/download](http://sourceforge.net/projects/simplehtmldom/files/simple_html_dom.php/download)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-12-11T10:29:30.970

您也可以使用 DomDocument 方法获取单个 HTML 标记级别变量

```
$homepage = file_get_contents('https://www.example.com/');
$doc = new DOMDocument;
$doc->loadHTML($homepage);
$titles = $doc->getElementsByTagName('h3');
echo $titles->item(0)->nodeValue; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-04-21T17:44:59.117

`$output = file("http://www.example.com");`直到我启用：`allow_url_fopen, allow_url_include,`并`file_uploads`在`php.ini`PHP7中才起作用

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-10-25T11:57:25.343

我尝试了这段代码，它对我有用。

```
$html = file_get_contents('www.google.com');
$myVar = htmlspecialchars($html, ENT_QUOTES);
echo($myVar); 
```

# asp.net - 如何在部署期间显示维护页面？

> ID：819184
> 
> 赞同：20
> 
> 时间：2009-05-04T07:58:17.940
> 
> 标签：asp.net, deployment, infrastructure

我想在 IIS windows server 2003 上托管的一个生产 asp.net 网站上计划一个计划维护停机时间。

我认为这是首选行为：

1.  [所有对http://www.x.com](http://www.x.com)的请求，包括 www.x.com/asb/asd/ 都将被重定向到通知页面（站点当前已关闭。稍后再回来）
2.  维护大约需要一个小时。我如何确保此重定向到维护页面对 SEO/google 排名的影响最小
3.  最好我希望能够在生产站点恢复“现场”之前安静地测试它
4.  最好我不想依赖将 DNS 指向其他地方。
5.  为了简单起见，请假装我在 Web 服务器前面没有任何其他硬件（即负载平衡器、防火墙等）

一个想法是：

1.  在同一 Web 服务器上创建另一个应用程序
2.  创建 httpmodule 或 httphandler 来处理任何 url 请求并 302 将它们重定向到维护页面

谢谢

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-05-04T08:02:56.010

尝试将[App_Offline.htm](http://weblogs.asp.net/scottgu/archive/2005/10/06/426755.aspx)放入根目录。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T08:03:08.163

将 app_offline.htm 文件复制到 webroot

[http://weblogs.asp.net/scottgu/archive/2005/10/06/426755.aspx](http://weblogs.asp.net/scottgu/archive/2005/10/06/426755.aspx)

# c# - 如何制作一个控制台应用程序，让我输入 LINQ 表达式并且我的程序将执行它们？

> ID：819187
> 
> 赞同：1
> 
> 时间：2009-05-04T07:59:00.187
> 
> 标签：c#, linq, console, parsing

如何编写一个控制台应用程序来提示我并让我输入 LINQ 表达式并输出该 LINQ 查询的结果？

将传入字符串解析/评估为 LINQ 表达式的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T08:01:21.973

出于数千个原因，控制台应用程序使用起来很尴尬。试试[LinqPad](http://www.linqpad.net/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-13T23:07:50.383

我写[LinqFilter](http://bittwiddlers.org/?p=141)的目的与此类似。它自己不解析 LINQ 查询表达式，而是通过 Microsoft.CSharp.CSharpCodeProvider 将代码发送到 C# v3.5 编译器以编译成动态程序集并执行包含查询的编译方法。如果您正在寻找一种更具交互性的方法来设计基于数据库的 LINQ 查询，那么 LinqPad 将是更好的工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T08:02:19.430

使用动态 LINQ 查询库，请参阅[此](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

# c# - C++ .NET 正在消亡吗？

> ID：819191
> 
> 赞同：13
> 
> 时间：2009-05-04T08:00:53.537
> 
> 标签：c#, .net, c++-cli

我听说微软将把精力集中在 C# 而不是 .NET 平台的 C++ 上。由于可用于 C# 但不适用于 C++ 的 GUI 设计器，我可以看到这是真的迹象。

所以我想知道 .NET 中的 C++ 是否正在消亡，以及它是否会在未来继续仅次于 C#。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-04T08:11:34.227

如果您在应用程序开发中以 .NET 框架为目标，那么与 C# 相比，C++/CLI 是第二类公民。C# 是专门为 .NET 框架设计*的*语言，同时 C++/CLI 扩展允许开发人员桥接本机代码和托管代码。

但是不要将 C++ 与 C++/CLI 混淆（C++ .NET 是一回事......）。C++ 在内核、游戏、高性能和服务器应用程序（例如 SQL 服务器）等领域都非常活跃，所有这些领域都不太可能发生变化。另一方面，大多数 .NET 的“GUI 东西”不会使用 C++。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-04T08:10:26.243

托管 C++ 从未真正成为 MS 认为的那样。C# 可以（几乎）做同样的事情，但语法更加直观和用户友好。

除此之外，C++/CLI 不会长期不受支持，因为它是在 .NET 程序集和本机 C++ 程序集之间创建互操作的简单方法。这就是它的全部用途（我敢肯定有 0.001% 的 C++/CLI 开发人员不同意 :P ）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-04T09:00:24.687

C++/CLI 正是 Microsoft 将本地 C++ 开发人员吸引到 .NET 的方式。它就像原生 C++ 和 C# 之间的中间层，但我很确定开发人员更喜欢选择原生 C++ 或 C#。

微软不会让 C++/CLI 消亡，至少在不久的将来，但是，如果没有社区的支持，C++/CLI 将无法成长。

在这一代人中，不成长意味着接近死亡。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-04T16:53:52.833

恐怕是。

造成这种情况的原因不是 C#（它没有带来任何特别的东西，虽然它是一种新语言，但它并没有带来新的语言特性，而只是复制了其他语言的特性——泛型）。

这主要是因为 MS 第一次尝试为 .NET 平台启用 C++——托管 C++——是一场灾难。
在此之后，他们聘请了C++ 大师[Herb Sutter](http://gotw.ca)，他出色地设计了名为 C++/CLI 的托管 C++ 替代品。您可以通过阅读Herb 编写的[C++/CLI 设计原理来](http://www.gotw.ca/publications/C++CLIRationale.pdf)了解 C++/CLI 设计为何以及在多大程度上优于托管 C++ 设计。

顺便说一句，Herb 使 vc 编译器成为 Windows 上最好的符合标准的编译器之一，因为它多年来一直是标准一致性方面最差的编译器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-05T03:36:54.970

No. It was born dead. It always has been treated as a second class citezen with no vitality roadmap.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T08:05:41.650

我认为是的，它正在死去，实际上它已经死了；），因为没有很多人使用它，他们使用的是 c++ 还是 c#。看到[这个](http://www.codeguru.com/forum/showthread.php?t=475394)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T03:29:19.013

I don't think it's necessarily going away, but the reason for using it almost always comes down to whether or not you need the performance benefits that come with it. If C# can do the same thing at 90% of the efficiency of C++, isn't that really good enough?

# svn - 是否可以设置可以通过 Internet 访问的个人 SVN 远程存储库？

> ID：819201
> 
> 赞同：1
> 
> 时间：2009-05-04T08:03:10.410
> 
> 标签：svn, tortoisesvn, repository

我想要发生的是在一台计算机上拥有一个 SVN 服务器，并在其他 3 台计算机上拥有 TortoiseSVN，例如，这 3 台计算机将能够从 SVN 服务器提交和签出文件，所有这些都通过 Internet，并且尽可能免费。这可能吗？你能指点我一些好的教程吗？谢谢

到目前为止，我知道这可以通过 LAN 实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T08:28:02.910

[查看SVN 红皮书](http://svnbook.red-bean.com/nightly/en/svn.serverconfig.choosing.html#svn.serverconfig.choosing.apache)中的服务器配置。

您有三个选择 - 使用 svnserve、通过 SSH 使用 svnserve 或 Apache HTTP。每个都有优点/缺点，这些都进行了讨论。另请注意，您需要根据需要配置防火墙（端口转发等）。

来自红皮书文章：

> 如果您尝试为您的组设置最简单的服务器，则 vanilla svnserve 安装是最简单、最快的途径。但是请注意，您的存储库数据将通过网络以明文形式传输。如果您的部署完全在您公司的 LAN 或 VPN 中，这不是问题。**如果存储库暴露在广泛开放的 Internet 中，您可能希望确保存储库的内容不敏感（例如，它仅包含开源代码），或者您在配置 SASL 以进行加密时加倍努力网络通讯。**

（我的重点）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T08:09:03.470

是的，这是可能的，而且设置起来并不困难！

例如，您可以在服务器上安装带有 WebDAV 的 Apache。[您可以在SVN Book](http://svnbook.red-bean.com/)上找到所有详细信息。对于使用 Apache 进行安装，您可以阅读[此](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.httpd.html).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T08:12:02.340

如果您的计算机具有可通过 Internet 访问的 apache 服务器，您可以将 SVn 服务器设置为可通过 Internet 访问。

我假设您在 Windows 上，因此您可以查看： [http ://svn.spears.at/](http://svn.spears.at/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T08:36:05.260

你可以访问[http://opensvn.csie.org](http://opensvn.csie.org) 我用了好几次，服务真的很好。

# c# - 用于格式化货币数字的最佳层是什么？

> ID：819204
> 
> 赞同：2
> 
> 时间：2009-05-04T08:03:57.677
> 
> 标签：c#, javascript, format, currency, oracle9i

我在前端使用 Javascript，C# 作为中间层，Oracle 9i 作为 DB。

将具有 2 位小数精度的数字格式化为货币时的最佳做法是什么？在这三层中的任何一层中应该首选哪些层？

请记住，用户将能够在应用程序的一些屏幕上编辑这些金额。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T08:08:17.183

我会说尽可能接近用户，因为它是实用的。反正不在数据库中，因为数据库不会知道用户的语言环境。

**更新：**在进行货币格式化时请注意，您向用户显示的信息实际上是正确的。货币格式与货币转换不同...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T08:11:58.750

小数点的存储精度可以高于 2 位数字。既然你提到了 C# 和 Javascript，我可以假设你正在使用 ASP.NET 作为你的前端。

货币的显示必须在您的 ASP.NET 代码中处理，以根据用户的区域设置/文化信息显示它。

对于您的网格视图和其他显示控件，在 C# 中，您可以使用字符串格式化选项：`{0:c}`以正确的符号和 2 个小数位显示货币。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-13T08:52:48.770

如果您想对数据执行任何数学运算，最好在 Javascript 中进行格式化并添加货币符号。

# css - 什么做margin:5px 0; 和边距：5px 0 0；意思是？

> ID：819207
> 
> 赞同：34
> 
> 时间：2009-05-04T08:04:45.693
> 
> 标签：css

是`margin:5px 0;`指`margin:5px 0 0 0;`还是？`margin:5px 0 5px 0;`

是什么`margin:5px 0 0;`意思`margin:5px 0 0 0;`？

当然，填充也是如此。

此外，所有浏览器（包括 IE6）是否一致？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-05-04T08:08:37.480

根据[盒子模型](http://www.w3.org/TR/CSS2/box.html)：

> *   如果只有一个值，则适用于所有方面。
> *   如果有两个值，则**顶部**和**底部**边距设置为第一个值，左右**边距** 设置为第二个**值。**
> *   如果有三个值，**top**设置为第一个值，**left**和**right** 设置为第二个值，**bottom** 设置为第三个值。
> *   如果有四个值，它们分别适用于**top**、**right**、 **bottom**和**left**。

```
body { margin: 2em }         /* all margins set to 2em */
body { margin: 1em 2em }     /* top & bottom = 1em, right & left = 2em */
body { margin: 1em 2em 3em } /* top=1em, right=2em, bottom=3em, left=2em */ 
```

这是由 CSS 标准定义的，因此它应该在所有正确实现 CSS 的浏览器中保持一致。有关浏览器兼容性，请查看 blooberry 的[CSS Support History](http://blooberry.com/indexdot/css/properties/margin/margin.htm)和[quirksmode](http://www.quirksmode.org/compatibility.html)。据 blooberry 介绍，`margin`最早是在 IE3 中实现的，所以 IE6 应该没问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-04T08:12:07.750

对于边距和填充，您可以指定一个、两个、三个或四个空格分隔的值：

1.  一个值：**所有四个方面都**使用该值。
2.  两个值：**top/bottom**获取第一个值；**左/右**获得第二个
3.  三个值：**top**获得第一个，**left/right**获得第二个，**bottom**获得第三个
4.  四个值：上、右、下、左（即**从中午顺时针方向**）获取每个值

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-01T13:50:30.650

`margin: 5px 0;`方法`margin: 5px 0 5px 0;`

`margin: 5px 0 0;`方法`margin: 5px 0 0 0;`

所有浏览器都遵循这一点，包括 IE 6。

# java - 如何用j2me在相机屏幕上画一条线？

> ID：819209
> 
> 赞同：1
> 
> 时间：2009-05-04T08:05:05.257
> 
> 标签：java, java-me, barcode

目前我正在开发一个使用手机解码条形码的应用程序。

我对如何在相机屏幕上画一条线或一个正方形以轻松捕获条形码有疑问。

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T08:19:56.390

不幸的是，这并不像听起来那么容易。如果您有来自手机相机的预览图像，那么它通常会呈现为叠加层。这意味着相机预览图像实际上并不构成应用程序画布的任何部分，并且您不能直接与像素交互。手机只是在您的应用程序之上绘制预览，完全不受您的控制。

如果您在屏幕上绘制一条线，那么它将在预览图像下方绘制。

解决这个问题的方法不太漂亮。您需要从相机实际捕获图像。不幸的是，这意味着将 JPEG 或 PNG 文件捕获到字节缓冲区中。然后，您使用 Image.createImage 加载此图像并将其渲染到屏幕上。然后，您可以安全地在此基础上绘图。

这也带来了令人震惊的帧速率。您可能想列举所有可以捕获的可能文件格式，并全部尝试以查看哪一种最快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T06:05:21.870

您可以通过使用[OverlayControl](http://library.forum.nokia.com/topic/Java_Developers_Library/GUID-D3E35E6F-0C45-48ED-B09D-F716E14C1C02/javax/microedition/amms/control/imageeffect/OverlayControl.html)来做到这一点，假设您的目标设备支持它。我想我记得在@索尼爱立信开发者论坛上看到了一个很好的例子。

编辑：[发现这个](http://developer.sonyericsson.com/community/docs/DOC-1706)（不涉及使用 OverlayControl）

# python - 有没有办法使用 Python 对 SQLite 中的 unicode 字符串进行正确排序？

> ID：819211
> 
> 赞同：3
> 
> 时间：2009-05-04T08:05:25.350
> 
> 标签：python, sqlite, unicode

有没有一种简单的方法可以在 SQLite 中使用 unicode 数据对行进行排序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T08:34:17.637

SQLite 有一个 BYOS（自带分拣机）策略。[有关详细信息](http://www.sqlite.org/faq.html#q18)，请参阅常见问题解答。他们选择不包括（默认情况下）任何支持 Unicode 的排序算法，以保持 SQLite 库的简洁和易于静态链接。

但是，您可以[创建一个 collat​​or](http://www.sqlite.org/c3ref/create_collation.html)，随意排序，然后告诉 SQLite 使用它。正如另一张海报所暗示的那样，源树中有使用[ICU](http://site.icu-project.org/)执行此操作的整理器。但是，您也可以使用自己的，如果您使用像 GLib 这样具有自己的 Unicode 感知能力的库，这很有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T08:19:04.973

有一个名为[ICU](http://icu-project.org/)的库可以为您进行正确的 unicode 排序；在另一个问题中有一个很好的描述：

[如何使用指定的语言环境对 sqlite3 中的文本进行排序？](https://stackoverflow.com/questions/611459/how-to-sort-text-in-sqlite3-with-specified-locale)

# javascript - 如何调试 Javascript 错误？

> ID：819213
> 
> 赞同：5
> 
> 时间：2009-05-04T08:06:35.347
> 
> 标签：javascript, firefox, debugging, firebug

如何使用 Firebug 调试 java 脚本错误？

## 复制

[**如何在 Firebug 的外部 JS 脚本中设置断点**](https://stackoverflow.com/questions/32633/how-can-i-set-breakpoints-in-an-external-js-script-in-firebug/)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-04T08:09:25.340

[使用 FireBug 进行调试](http://thecodecentral.com/2007/08/01/debug-javascript-with-firebug)。

只需检查发生错误的行，然后在该行之前编写一个“调试器”调用。

```
debugger; //Will invoke FireBug's debugger.
var err = abcs; //Line containing error 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T08:15:40.380

要调试 firebug 中的错误：

*   1-从菜单中选择检查选项卡
*   2- 在导致错误的行中设置断点
*   3-刷新页面
*   4-使用 F10 逐步调试和 F5 结束调试

这就像视觉工作室的调试

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T08:18:03.243

使用 console.log(yourObject) 函数将任何内容输出到 firebug 控制台。就像运行 var_dump 一样，您可以查看所有对象及其内容。如果您想检查特定变量甚至特定 DOM 对象的内容，这将非常有用。

而不是使用廉价的警报 - console.log() 函数更干净，您可以在控制台窗格中整齐地看到所有输出。

但是请注意，当您部署网站时，您需要删除对 console.log 函数的所有引用，因为它不会在 IE 中运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T08:09:46.243

您可以在代码中放置断点，然后等待执行命中它们。然后你可以走进代码，并使用手表知道变量的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-12T09:06:28.437

您可以使用 Firebug，对于在 chrome 中进行调试，您可以使用 firebug lite

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-04T08:09:00.100

为什么选择 Firebug，试试 Visual Studio，它有丰富的调试功能；）

# c# - 如何在 WPF 中不打开新窗口的情况下加载新的用户控件？

> ID：819216
> 
> 赞同：1
> 
> 时间：2009-05-04T08:08:02.067
> 
> 标签：c#, wpf, user-controls

我把[这个 WPF 应用程序 http://tanguay.info/web/index.php?pg=codeExamples&id=164](http://tanguay.info/web/index.php?pg=codeExamples&id=164)放在一起

[http://tanguay.info/web/index.php?pg=codeExamples&id=164](http://tanguay.info/web/index.php?pg=codeExamples&id=164)

它读取客户的 XML 文件，允许用户对其进行编辑并将其保存回来，**并且一切正常**。

但是，当用户在“管理客户”页面上单击“保存”时，**我希望应用程序“返回”到“显示客户”页面。**

“页面”是在 shell 中动态加载的用户控件，如下所示：

```
using System;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Reflection;
using TestDynamicForm123.View;

namespace TestDynamicForm123
{
    public partial class Shell : Window
    {
        private Dictionary<string, IBaseView> _userControls = new Dictionary<string, IBaseView>();

        public Dictionary<string, IBaseView> GetUserControls()
        {
            return _userControls;
        }

        public Shell()
        {
            InitializeComponent();

            List<string> userControlKeys = new List<string>();
            userControlKeys.Add("WelcomeView");
            userControlKeys.Add("CustomersView");
            userControlKeys.Add("ManageCustomersView");
            Type type = this.GetType();
            Assembly assembly = type.Assembly;
            foreach (string userControlKey in userControlKeys)
            {
                string userControlFullName = String.Format("{0}.View.{1}", type.Namespace, userControlKey);
                IBaseView userControl = (IBaseView)assembly.CreateInstance(userControlFullName);
                _userControls.Add(userControlKey, userControl);
            }

            //set the default page
            btnWelcome.RaiseEvent(new RoutedEventArgs(Button.ClickEvent));
        }

        private void btnGeneral_Click(object sender, RoutedEventArgs e)
        {
            PanelMainContent.Children.Clear();
            Button button = (Button)e.OriginalSource;
            PanelMainWrapper.Header = button.Content;
            Type type = this.GetType();
            Assembly assembly = type.Assembly;

            IBaseView userControl = _userControls[button.Tag.ToString()] as IBaseView;
            userControl.SetDataContext();

            PanelMainContent.Children.Add(userControl as UserControl);
        }
    }
} 
```

因此，当加载**ManageCustomersView**并处理点击时，我会尝试返回**CustomersView**页面，该页面可以正常工作，但它会打开一个新窗口**，因此每次用户编辑客户时，都会弹出一个新窗口**。

```
private void OnSave(object sender, System.Windows.Input.ExecutedRoutedEventArgs e)
{
    Customer customer = e.Parameter as Customer;
    Customer.Save(customer);

    //go back to default back
    Shell shell = new Shell();
    Button btnCustomers = shell.FindName("btnCustomers") as Button;
    btnCustomers.RaiseEvent(new RoutedEventArgs(Button.ClickEvent));
    shell.Show();
} 
```

**如何更改一个 UserControl 中的上述代码，以便*其父*级卸载当前用户控件并加载另一个，而不是像现在那样弹出另一个应用程序实例？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T08:19:25.143

新窗口清楚地弹出，因为每次调用 OnSave 时您都在创建一个新的 Shell 对象。您需要[获取父 Shell 窗口](https://stackoverflow.com/questions/302839/wpf-user-control-parent)。

```
Shell parentShell = Window.GetWindow(this) as Shell; 
```

# python - Python，谁在调用我的 python 模块

> ID：819217
> 
> 赞同：3
> 
> 时间：2009-05-04T08:08:10.367
> 
> 标签：python, cgi

我有一个 Python 模块，可以由 CGI 脚本（从表单传递信息）或命令行（从命令行传递选项和参数）调用。有没有办法确定模块是从 CGI 脚本还是从命令行调用的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T08:15:38.633

这将做到：

```
import os
if os.environ.has_key('REQUEST_METHOD'):
    # You're being run as a CGI script.
else:
    # You're being run from the command line. 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T10:37:06.513

这是一个非常糟糕的设计理念。您的脚本应该设计为独立于它的调用方式。调用程序应提供统一的环境。

如果您将脚本设计为以一种完全一致的方式工作，您会很高兴。建造这样的东西。

*   myscript.py - “真正的工作” - 在函数和类中定义。

*   myscript_cgi.py - 导入 myscript 并使用类和函数的 CGI 接口。

*   myscript_cli.py - 解析命令行选项、导入 myscript 并使用类和函数的命令行界面。

完成所有三件事（实际工作、cgi 界面、cli 界面）的单个脚本通常是错误的。

# expression-blend - 是否可以仅使用 Expression Blend 3 创建 XBAP 应用程序？

> ID：819235
> 
> 赞同：0
> 
> 时间：2009-05-04T08:13:18.543
> 
> 标签：expression-blend, xbap

我想用 blend 创建一个 XBAP 应用程序，但是当点击

*   文件
*   新项目

它问我是否要创建：

*   Silverlight 3 应用程序 + 网站 -- 或 --
*   WPF 应用程序

有没有办法从 Expression Blend 3 创建 XBAP，或者这是否需要 Visual Studio？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T08:34:02.847

基本上，XBAP 页面继承自 System.Windows.Controls.Page，因此您可以创建

```
public partial class Page1 : System.Windows.Controls.Page 
```

因此，您应该能够在 Expression Blend 中创建和设计页面，尝试 WPF 应用程序选项。

对于发布，您需要 Visual Studio....

*   [http://blogs.msdn.com/maximelamure/archive/2007/01/24/create-your-own-pfx-file-for-clickonce.aspx](http://blogs.msdn.com/maximelamure/archive/2007/01/24/create-your-own-pfx-file-for-clickonce.aspx) [http://www.xbap.org/faq.html](http://www.xbap.org/faq.html)
*   [http://msdn.microsoft.com/en-us/visualc/aa700831.aspx](http://msdn.microsoft.com/en-us/visualc/aa700831.aspx)
*   或带有扩展的 C# Express。

# nhibernate - 使用 Fluent NHibernate 映射策略模式

> ID：819236
> 
> 赞同：4
> 
> 时间：2009-05-04T08:13:23.740
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

从本质上讲，这个问题的标题解释了我想要做的事情的本质，但是要创建一个人为的例子......

我有一个班级，叫它员工。员工有一个 IPaymentBehaviour...

```
public class Employee 
{
  IPaymentBehaviour _paymentBehaviour;

  protected internal Employee() { /* required by NH */}

  public Employee(IPaymentBehaviour paymentBehaviour)
  {
    _paymentBehaviour = paymentBehaviour;
  }

} 
```

这对应于这样的数据库表：

dbo.Employees
-> EmployeeId（主键）
-> PaymentBehaviourId（查找表的外键）
-> Field1
-> Field2
-> Field3
-> Field4

根据 PaymentBehaviourId 的值，我需要将 IPaymentBehaviour 的不同实现“注入”到 Employee 对象中。根据使用的 PaymentBehaviour，可能需要 Field1、2、3 或 4 来创建该行为。

谁能告诉我如何使用 Fluent-NHibernate 进行映射？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:45:00.663

表员工

*   EmployeeId（主键）
*   PaymentBehaviourId（PaymentBehaviour 的外键）

表支付行为

*   PaymentBehaviourId (pk)
*   类型（鉴别器）
*   字段1
*   字段2
*   字段3
*   字段4

课程

```
public class Employee 
{
  /* ... */  
  public PaymentBehaviour PaymentBehaviour { get; set; }
}

public class PaymentBehaviourA : IPaymentBehaviour
{
  /* ... */  
  public int Field1 { get; set; }
}

public class PaymentBehaviourB : IPaymentBehaviour
{
  /* ... */  
  public int Field2 { get; set; }
} 
```

我不知道 FluentNHibernate 足以告诉你它的样子，但在 XML 中你会这样指定它：

```
<class name="Employee" table="Employees">
  <many-to-one name="PaymentBehaviour" class="IPaymentBehaviour">
</class>

<class name="IPaymentBehaviour" abstract="true" >
  <discriminator column="type"/>

  <subclass name="PaymentBehaviourA" discriminator-value="A">
    <propert name="Field1"/>
  </subclass>

  <subclass name="PaymentBehaviourB" discriminator-value="B">
    <propert name="Field2"/>
  </subclass>
</class> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T08:30:39.703

NHibernate 使用默认构造函数来实例化实体。不过有[一些](http://nhforge.org/blogs/nhibernate/archive/2008/12/12/entities-behavior-injection.aspx)解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T08:41:23.267

我想我会像这样解决它：

*   在 Employee 对象上创建一个具有 `private`访问修饰符的默认构造函数，以便 NHibernate 可以重建这些类型
*   创建一个拦截器，在其中重载适当的方法（我假设为 OnLoad），确保将正确的 `IPaymentBehaviour`实现注入到实体中。（也许您可以创建一个可以由 Employee 类实现的接口“IPaymentBehaviourInjectable”（显式实现它），这样您就可以将正确的行为注入到实体中......

# html - 元素而不是？ 副本： 为什么不在 HTML 中使用表格进行布局？ DIV 与表格或 CSS 与 问问题 问问题 2009-05-04T08:13:56.763 13768 次 This question shows research effort; it is useful and clear 6 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 副本： 为什么不在 HTML 中使用表格进行布局？ DIV 与表格或 CSS 与愚蠢 最近有很多关于使用 div 而不是 table 标签来使您的页面更适合浏览器的讨论。为什么div更好？ 以下是基于 div 和基于表格设计的优缺点。 htmlcsslayoutcss-tables 4 9 回答 9 This answer is useful 15 这里的关键是使用它们进行布局。请注意，表格数据的表格没有任何问题。这就是他们的目的。 但是，当您使用表格进行布局时，您会创建一个非常僵化的页面结构，通常无法很好地适应不同的屏幕尺寸、用户代理（想想移动浏览器或盲人的屏幕阅读器。尤其是在后一种情况下，您正在破坏任何订单其中内容应该被读给用户）。不幸的是，表格仍然是最强大的页面布局机制之一，因为几乎没有不同的实现，而且它们可以完美地工作十多年——CSS在这里是完全不同的事情。 但基本上归结为： 表 违反内容和表现的区别 从长远来看，笨重且难以维护，尤其是在尝试以类似方式更改多个页面的布局时 没有强烈的语义意义，这对于可能只依赖朗读文本的残障人士来说很重要。表格在此处逐行逐列读取，这在基于表格的布局中几乎总是不是很有帮助 CSS 布局 更难正确（至少对于演示而言） 允许（有时）清晰地分离内容和表示。请注意，有时您必须在 HTML 中使用多个容器元素以允许某些布局和样式正常工作，因为 CSS 有一些限制 如果您不盲目使用<div>and ，则可以为基础标记提供更好的语义含义<span>。有许多标签是有意义的，应该这样使用。例如，<div class="heading1">当你可以使用时不要使用<h1>. 于 2009-05-04T08:23:01.797 回答 This answer is useful 14 几个原因： 1) div 在大多数情况下在语义上更正确。以表格结构对网站进行编码的人并没有将表格用于他们的目的，即表格数据。divs 代表一个“分区”或页面的一部分，因此将项目放在 divs 中更正确。 2) div 更灵活，更易于设计和维护。你不必<table><tr><td>Text here</td></tr></table>每次都写，<div>Text here</div>而你可以写。您可以将 css 钩子（即类或元素）添加到表和 div 中，但是使用 div 会更加灵活。 3) 表格结构的网站简直丑陋:) 于 2009-05-04T08:18:36.363 回答 This answer is useful 6 因为表格传达了语义含义 - 您当前正在显示表格数据，就像 h1 一样意味着您有一个标题。因此，如果您使用表格来格式化您的输出，您就会误导对代码语义的解释。 例如，这可能会导致使用屏幕阅读器的人出现可访问性问题。 于 2009-05-04T08:17:21.623 回答 This answer is useful 2 以下是基于 div 和基于表格设计的优缺点。 于 2009-05-04T08:15:34.000 回答 This answer is useful 1 使用 div 比使用 table 更好，因为在设计中易于控制，它可以是控件的容器而不是 table，并且 table 主要用于对具有类似结构的数据进行分组，因此它的设计是针对此任务的，但 div 被视为容器主要是表。我发现了在收集许多控件时和在我可以控制容器时之间的区别，但在表中我很困惑，因为我必须在里面插入并且它在彼此内部循环。 于 2009-05-04T08:24:04.167 回答 This answer is useful 0 大多数人继续讨论应该如何将表仅用于数据，并且当您将其用于布局目的时会引入性能问题。此外，它应该更灵活，因为您可以使 <div> 向左流动、向右流动并在其他任何地方流动。 但是，恕我直言，这不值得付出努力。尤其是当您有应该与其相应标签正确对齐的控件列时，要使内容正确对齐需要很长时间。 于 2009-05-04T08:17:45.337 回答 This answer is useful 0 使用表格进行布局对于网页设计来说是革命性的，但那是十五年前的事了，没有其他选择。正是由于这段历史，今天的表格甚至被考虑用于布局。 基于 CSS 的布局比基于表格的布局灵活得多。还有一些事情用表格更容易完成，但另一方面，有很多事情很容易用 CSS 完成，而用表格却非常复杂或不可能完成。 于 2009-05-04T09:32:05.483 回答 This answer is useful 0 我告诉你我个人使用 div 的主要原因： 表格只有一个静态网格，而 div 是动态的：表格的第一行定义了所有列（如 MS Excel 中）。在接下来的行中，您可以组合这些列，但您不能更改您在第一行中定义的基本布局。div 是动态的：您可以创建拼凑，让 div 重叠或在它们之间放置一些空间。无论你想要什么。你不会被迫排成一排地思考。你自由了。更多的灵活性。 表格会导致呈现和跨浏览器不兼容问题：表格看起来并不总是相同的。每个浏览器都会为您提供对表格及其内容的自己的解释。因此，许多令人不舒服的惊喜。一个浏览器将您的常规文本显示为粗体。另一个浏览器为您的表格提供或多或少的余量给其他 html 元素，因此，表格没有很好地定位。用复杂的变通方法解决这些问题需要花费数小时的时间。div 在所有浏览器中看起来总是一样的。如果您使用 div，即使是 IE（众所周知，它是 web 程序员的麻烦制造者）也能减少问题。 Div 渲染速度更快： Div 加载速度比表格快。页面之间的浏览速度更快。更好的外观和感觉。 希望能帮助到你。干杯。 于 2013-01-04T11:04:53.807 回答 This answer is useful -3 我使用 CSS 和表格，有时还使用 DIV，但表格非常全面！而且它们在 Dreamweaver 和 Frontpage 中看起来很不错……放弃表格太难了，但似乎我会的，因为有必要让我的页面加载得更快！ 于 2010-10-29T12:56:48.903 回答 Related 4 javascript - 匹配有序数组 1 .net - 外部 C# 函数的复合 C1 部署错误？ 1 module - 如何使用 RequireJS 构建复杂的 Web 应用程序 1 extjs - 编辑窗口在 extjs 中返回 5 c# - 在 c# 中添加到一系列通用列表 0 php - 多语言网站：包括语言文件 1 mysql - HTML5页面用node.js连接mysql数据库 1 php - Codeigniter 嵌入 swf 7 javascript - 一次取消选中所有 JQuery 单选按钮集 3 python - Python中的简单HTML模板 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：819237
> 
> 赞同：6
> 
> 时间：
> 
> 标签：html, css, layout, css-tables

副本：

*   [为什么不在 HTML 中使用表格进行布局？](https://stackoverflow.com/questions/83073/div-vs-table)
*   [DIV 与表格或 CSS 与愚蠢](https://stackoverflow.com/questions/61250/divs-vs-tables-or-css-vs-being-stupid)

* * *

最近有很多关于使用 div 而不是 table 标签来使您的页面更适合浏览器的讨论。为什么div更好？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-04T08:23:01.797

这里的关键是使用它们进行布局。请注意，表格*数据*的表格没有任何问题。这就是他们的目的。

但是，当您使用表格进行布局时，您会创建一个非常僵化的页面结构，通常无法很好地适应不同的屏幕尺寸、用户代理（想想移动浏览器或盲人的屏幕阅读器。尤其是在后一种情况下，您正在破坏任何订单其中内容应该被读给用户）。不幸的是，表格仍然是最强大的页面布局机制之一，因为几乎没有不同的实现，而且它们可以完美地工作十多年——CSS在这里是完全不同的事情。

但基本上归结为：

### 表

*   违反内容和表现的区别
*   从长远来看，笨重且难以维护，尤其是在尝试以类似方式更改多个页面的布局时
*   没有强烈的语义意义，这对于可能只依赖朗读文本的残障人士来说很重要。表格在此处逐行逐列读取，这在基于表格的布局中几乎总是不是很有帮助

### CSS 布局

*   更难正确（至少对于演示而言）
*   允许（有时）清晰地分离内容和表示。请注意，有时您必须在 HTML 中使用多个容器元素以允许某些布局和样式正常工作，因为 CSS 有一些限制
*   *如果*您不盲目使用`<div>`and ，则可以为基础标记提供更好的语义含义`<span>`。有许多标签是有意义的，应该这样使用。例如，`<div class="heading1">`当你可以使用时不要使用`<h1>`.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-04T08:18:36.363

几个原因：

1) div 在大多数情况下在语义上更正确。以表格结构对网站进行编码的人并没有将表格用于他们的目的，即表格数据。divs 代表一个“分区”或页面的一部分，因此将项目放在 divs 中更正确。

2) div 更灵活，更易于设计和维护。你不必`<table><tr><td>Text here</td></tr></table>`每次都写，`<div>Text here</div>`而你可以写。您可以将 css 钩子（即类或元素）添加到表和 div 中，但是使用 div 会更加灵活。

3) 表格结构的网站简直丑陋:)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-04T08:17:21.623

因为表格传达了语义含义 - 您当前正在显示表格数据，就像 h1 一样意味着您有一个标题。因此，如果您使用表格来格式化您的输出，您就会误导对代码语义的解释。

例如，这可能会导致使用屏幕阅读器的人出现可访问性问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T08:15:34.000

以下是[基于 div 和基于表格设计的优缺点](http://www.smashingmagazine.com/2009/04/08/from-table-hell-to-div-hell/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T08:24:04.167

使用 div 比使用 table 更好，因为在设计中易于控制，它可以是控件的容器而不是 table，并且 table 主要用于对具有类似结构的数据进行分组，因此它的设计是针对此任务的，但 div 被视为容器主要是表。我发现了在收集许多控件时和在我可以控制容器时之间的区别，但在表中我很困惑，因为我必须在里面插入并且它在彼此内部循环。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T08:17:45.337

大多数人继续讨论应该如何将表仅用于数据，并且当您将其用于布局目的时会引入性能问题。此外，它应该更灵活，因为您可以使 <div> 向左流动、向右流动并在其他任何地方流动。

但是，恕我直言，这不值得付出努力。尤其是当您有应该与其相应标签正确对齐的控件列时，要使内容正确对齐需要很长时间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T09:32:05.483

使用表格进行布局对于网页设计来说是革命性的，但那是十五年前的事了，没有其他选择。正是由于这段历史，今天的表格甚至被考虑用于布局。

基于 CSS 的布局比基于表格的布局灵活得多。还有一些事情用表格更容易完成，但另一方面，有很多事情很容易用 CSS 完成，而用表格却非常复杂或不可能完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-04T11:04:53.807

我告诉你我个人使用 div 的主要原因：

*   表格只有一个静态网格，而 div 是动态的：表格的第一行定义了所有列（如 MS Excel 中）。在接下来的行中，您可以组合这些列，但您不能更改您在第一行中定义的基本布局。div 是动态的：您可以创建拼凑，让 div 重叠或在它们之间放置一些空间。无论你想要什么。你不会被迫排成一排地思考。你自由了。更多的灵活性。

*   表格会导致呈现和跨浏览器不兼容问题：表格看起来并不总是相同的。每个浏览器都会为您提供对表格及其内容的自己的解释。因此，许多令人不舒服的惊喜。一个浏览器将您的常规文本显示为粗体。另一个浏览器为您的表格提供或多或少的余量给其他 html 元素，因此，表格没有很好地定位。用复杂的变通方法解决这些问题需要花费数小时的时间。div 在所有浏览器中看起来总是一样的。如果您使用 div，即使是 IE（众所周知，它是 web 程序员的麻烦制造者）也能减少问题。

*   Div 渲染速度更快： Div 加载速度比表格快。页面之间的浏览速度更快。更好的外观和感觉。

希望能帮助到你。干杯。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2010-10-29T12:56:48.903

我使用 CSS 和表格，有时还使用 DIV，但表格非常全面！而且它们在 Dreamweaver 和 Frontpage 中看起来很不错……放弃表格太难了，但似乎我会的，因为有必要让我的页面加载得更快！

# c# - 设备模拟器和 FTP，在 ac# 移动应用程序项目中

> ID：819238
> 
> 赞同：1
> 
> 时间：2009-05-04T08:14:42.380
> 
> 标签：c#, visual-studio-2008, windows-mobile, ftp

对于使用 Visual Studio 2008 开发的 C# 移动应用程序，我正在尝试使用 FTP。FTP在真实设备上工作正常，但在我使用设备模拟器时不起作用：连接成功，但在尝试检索数据时失败。两者都使用windows mobile 5。

你们中的一些人是否已经遇到过这个问题？当我用谷歌搜索时，它似乎是反复出现但尚未解决。

这是 ftp 服务器显示的日志。

(000001) 04/05/2009 09:50:59 - (未登录) (127.0.0.1)> 已连接，正在发送欢迎消息...

(000001) 04/05/2009 09:50:59 - (未登录) (127.0.0.1)> 220-FileZilla 服务器版本 0.9.31 beta

(000001) 04/05/2009 09:50:59 - (未登录) (127.0.0.1)> 220 FTP 服务器

(000001) 04/05/2009 09:50:59 - (未登录) (127.0.0.1)> 用户 aa

(000001) 04/05/2009 09:50:59 - (未登录) (127.0.0.1)> 331 aa 需要密码

(000001) 04/05/2009 09:51:00 - (未登录) (127.0.0.1)> PASS **

(000001) 04/05/2009 09:51:00 - aa (127.0.0.1)> 230 登录

(000001) 04/05/2009 09:51:01 - aa (127.0.0.1)> SYST

(000001) 04/05/2009 09:51:01 - aa (127.0.0.1)> 215 由 FileZilla 模拟的 UNIX

(000001) 04/05/2009 09:51:01 - aa (127.0.0.1)> CWD /

(000001) 04/05/2009 09:51:04 - aa (127.0.0.1)> PASV

(000001) 04/05/2009 09:51:04 - aa (127.0.0.1)> 227 进入被动模式 (127,0,0,1,5,22)

(000001) 04/05/2009 09:51:41 - aa (127.0.0.1)> 已断开连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T20:22:11.820

您是否尝试过“拥抱”设备模拟器。

在 Visual Studio 中，转到 Tools 并打开**Device Emulator Manager**。从那里您可以右键单击当前运行的设备模拟器并选择**Cradle**以使用 ActiveSync 模拟设备底座。

我发现当设备模拟器通过“模拟”ActiveSync 连接正确连接到开发 PC 时，我获得了更好的网络结果。此时，您的 PC (169.254.2.2) 和设备 (169.254.2.1) 之间有一个两点 IP 连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T08:37:29.283

自从我使用这个移动设备以来已经有一段时间了，所以我没有真正的解决方案，但也许有一些解释。

如您所见，问题在进入被动模式后立即发生。如您所见，使用的 ip 地址是 127.0.0.1，甚至可以在被动模式下进行通信（使用使用的端口）。我认为模拟的网络堆栈在这里有一些问题要让这个虚拟连接正常工作（使用本地主机地址）。所以也许你应该尝试**不使用被动模式**来让它工作。

另一种深入了解这个问题的方法是记录与[WireShark](http://www.wireshark.org)的通信并尝试检查究竟出了什么问题。但是，如果您对 tcp ip 和所有这些东西有更深入的了解，那将是可行的。

# .net - 获取父网站不是顶级网站

> ID：819242
> 
> 赞同：0
> 
> 时间：2009-05-04T08:16:32.467
> 
> 标签：.net, sharepoint

我创建了一个自定义查找字段，并在我的顶级站点中查找联系人。但我想查找一个子站点。

dataSource.List = site.RootWeb.Lists["Contacts"];

这是我用于查找的代码，但我引用了 rootweb，我不希望这样。有人吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T12:36:37.820

假设“站点”是您当前的 SPWeb，只需查看 site.Webs 或 site.GetSubwebsForCurrentUser()。我相信即使当前用户没有访问权限，前者也会尝试为您提供所有子网站，因此后者可能是首选。

* * *

更新 - 我后来意识到你的问题标题表明你想要父网站，而你的问题文本表明你想要一个子网站。上面是一个子网。父网站只是 site.ParentWeb（再次假设“网站”是您的 SPWeb）。如果您愿意检查，您可以随时检查 IsRootWeb 属性。

* * *

另一个更新 - 根据您的评论，“站点”可能是 SPSite 而不是 SPWeb。要获得一个网络，您需要执行类似 site.OpenWeb() 的操作（现在假设“站点”是一个 SPSite）。最好在 C# using 语句中执行此操作，以便在完成后正确处理 SPWeb。请注意，如果 SPSite 是使用指向您的 SPWeb 的完整 URL 实例化的，则 OpenWeb 方法可以不带任何参数，这可以正常工作。或者 OpenWeb 可以采用 URL 参数。

# wmi - 在 Vista 上通过 WMI 获取 VPN IP 地址

> ID：819251
> 
> 赞同：4
> 
> 时间：2009-05-04T08:21:54.997
> 
> 标签：wmi, windows-vista, vpn

我们如何枚举所有网络连接以便使用 WMI 提取 VPN 连接的 IP 地址？在 XP 上，Win32_NetworkAdapterConfiguration 工作正常，但在 Vista 上，它似乎只枚举物理连接......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-11T18:48:55.097

在 MSFT 课程中找到它！CIM 接口对象的 Windows 特定实现：gwmi msft_netIPAddress -Namespace 'root/standardcimv2' | 格式列表-Property InterfaceAlias,IPAddress

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-19T18:27:14.237

如果您查看[Win32_NetworkAdapterConfiguration](http://msdn.microsoft.com/en-us/library/aa394217%28v=vs.85%29.aspx)文档下的注释，您将在处理 Vista 时看到对[Win32_NetworkAdapter](http://msdn.microsoft.com/en-us/library/aa394216%28v=vs.85%29.aspx)的引用。

```
'Vista only code???
Set colAdapters = objWMIService.Execquery ("SELECT * FROM Win32_NetworkAdapter WHERE NetEnabled = True")
For Each nic in colAdapters
    msg = "nic.DeviceId: " & nic.DeviceId & vbCRLF _
    & "nic.Name: " & nic.Name & vbCRLF _
Next 
```

从这里您应该能够检索**InterfaceIndex并从**[Win32_IP4RouteTable](http://msdn.microsoft.com/en-us/library/aa394162%28v=vs.85%29.aspx)类中查找 IP 地址。

**与使用Win32_NetworkAdapterConfiguration**相比，这无疑是一种获取信息的迂回方式。

# shared-hosting - 当脚本因错误而失败时，mod_security 会阻止 IP？

> ID：819252
> 
> 赞同：0
> 
> 时间：2009-05-04T08:22:33.343
> 
> 标签：shared-hosting, blocking

我在阻止我的 IP 时遇到问题，我在共享主机上安装了 php 应用程序并尝试运行它，但它给出了一些错误，然后我尝试刷新页面，但在第 3 次尝试后，我的 ip 被阻止到所有端口。没有可用的服务（ftp，ssh）。Apache mod_security 会阻止它吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T10:57:57.540

这个问题是否与[这个](https://stackoverflow.com/questions/708337/can-php-code-break-down-shared-hosting-services-for-the-particular-ip "这个")或[那个](https://stackoverflow.com/questions/708163/my-ip-seems-to-be-blocked-by-web-hosting-server)有关？

能否请您*发布*错误，php 版本，网站地址，以便我和人们可以检查它？

您配置了什么应用程序？

# programming-languages - 以多种编程语言创建代码的向导

> ID：819256
> 
> 赞同：0
> 
> 时间：2009-05-04T08:24:13.620
> 
> 标签：programming-languages, wizard

作为我们应用程序的一部分，我需要构建将在 php 和 asp 中输出具有相同功能的代码（可能是后者的 jsp）的组件。我怎样才能将这种组件设计为尽可能通用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T08:26:32.990

我个人会选择**Strategy Pattern**。您可以拥有一个主代码生成器类并使用策略对其进行实例化。

PHPCodeStrategy ASPCodeStrategy

然后每个人都会有一个名为 execute 的方法。然后，您可以添加更多策略并扩展您的应用程序。

安德鲁

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T08:36:55.680

您需要能够从所有输入语言中创建解析树。

对于每种输出语言，您都需要创建一组树转换语法。

您可能还需要一个运行时库来帮助翻译在您的输出语言中不可用的例程。

# ruby-on-rails - 在 Ruby 中获取人的年龄

> ID：819263
> 
> 赞同：132
> 
> 时间：2009-05-04T08:27:12.677
> 
> 标签：ruby-on-rails, ruby

我想从一个人的生日得到他的年龄。`now - birthday / 365`不起作用，因为有些年份有 366 天。我想出了以下代码：

```
now = Date.today
year = now.year - birth_date.year

if (date+year.year) > now
  year = year - 1
end 
```

有没有更 Ruby'ish 的方法来计算年龄？

* * *

## 回答 #1

> 赞同：422
> 
> 时间：2010-03-01T17:43:26.090

我知道我在这里聚会迟到了，但是当试图计算出在闰年 2 月 29 日出生的人的年龄时，公认的答案会非常糟糕。这是因为调用`birthday.to_date.change(:year => now.year)`创建了一个无效的日期。

我改用以下代码：

```
require 'date'

def age(dob)
  now = Time.now.utc.to_date
  now.year - dob.year - ((now.month > dob.month || (now.month == dob.month && now.day >= dob.day)) ? 0 : 1)
end 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-05-04T13:50:37.593

我发现这个解决方案运行良好并且对其他人可读：

```
 age = Date.today.year - birthday.year
    age -= 1 if Date.today < birthday + age.years #for days before birthday 
```

简单，您无需担心处理闰年等。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-05-04T08:33:01.400

用这个：

```
def age
  now = Time.now.utc.to_date
  now.year - birthday.year - (birthday.to_date.change(:year => now.year) > now ? 1 : 0)
end 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2011-09-28T08:44:51.240

Ruby on Rails (ActiveSupport) 中的一个内衬。处理闰年、闰秒等等。

```
def age(birthday)
  (Time.now.to_s(:number).to_i - birthday.to_time.to_s(:number).to_i)/10e9.to_i
end 
```

从这里开始的逻辑 -[用 C# 计算年龄](https://stackoverflow.com/questions/9/how-do-i-calculate-someones-age-in-c/11942#11942)

[假设两个日期都在同一个时区，如果`utc()`之前`to_s()`都没有打电话。]

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-07-11T06:55:25.640

```
(Date.today.strftime('%Y%m%d').to_i - dob.strftime('%Y%m%d').to_i) / 10000 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-10-18T19:46:03.983

我的建议：

```
def age(birthday)
    ((Time.now - birthday.to_time)/(60*60*24*365)).floor
end 
```

诀窍是 Time 的减法运算返回秒

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-04T19:46:40.127

到目前为止的答案有点奇怪。您最初的尝试非常接近执行此操作的正确方法：

```
birthday = DateTime.new(1900, 1, 1)
age = (DateTime.now - birthday) / 365.25 # or (1.year / 1.day) 
```

您将得到一个小数结果，因此请随意将结果转换为整数`to_i`。这是一个更好的解决方案，因为它将日期差异正确地视为事件发生后以天（或在相关 Time 类的情况下以秒为单位）测量的时间段。然后一个简单的除以一年中的天数就可以得出年龄。以这种方式计算年龄时，只要保留原始 DOB 值，闰年就不需要考虑。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-02-22T21:25:53.283

[这个答案](https://stackoverflow.com/a/11427145/538534)是最好的，请改为投票。

* * *

我喜欢@philnash 的解决方案，但条件可能更紧凑。[该布尔表达式所做的是使用字典顺序](http://en.wikipedia.org/wiki/Lexicographical_order)比较 [month, day] 对，因此可以只使用 ruby​​ 的字符串比较：

```
def age(dob)
  now = Date.today
  now.year - dob.year - (now.strftime('%m%d') < dob.strftime('%m%d') ? 1 : 0)
end 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-02-03T14:35:03.433

我喜欢这一个：

```
now = Date.current
age = now.year - dob.year
age -= 1 if now.yday < dob.yday 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-07-02T02:59:11.863

这是[这个答案](https://stackoverflow.com/a/11942/848668)的转换（它收到了很多选票）：

```
# convert dates to yyyymmdd format
today = (Date.current.year * 100 + Date.current.month) * 100 + Date.today.day
dob = (dob.year * 100 + dob.month) * 100 + dob.day
# NOTE: could also use `.strftime('%Y%m%d').to_i`

# convert to age in years
years_old = (today - dob) / 10000 
```

它的方法绝对是独一无二的，但当您意识到它的作用时，它就非常有意义：

```
today = 20140702 # 2 July 2014

# person born this time last year is a 1 year old
years = (today - 20130702) / 10000

# person born a year ago tomorrow is still only 0 years old
years = (today - 20130703) / 10000

# person born today is 0
years = (today - 20140702) / 10000  # person born today is 0 years old

# person born in a leap year (eg. 1984) comparing with non-leap year
years = (20140228 - 19840229) / 10000 # 29 - a full year hasn't yet elapsed even though some leap year babies think it has, technically this is the last day of the previous year
years = (20140301 - 19840229) / 10000 # 30

# person born in a leap year (eg. 1984) comparing with leap year (eg. 2016)
years = (20160229 - 19840229) / 10000 # 32 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-10-23T03:08:59.840

因为 Ruby on Rails 被标记，所以[dotiw](https://github.com/radar/dotiw) gem 会覆盖 Rails 内置的[distance_of_times_in_words](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-distance_of_time_in_words)并提供[distance_of_times_in_words_hash](https://github.com/radar/dotiw#distance_of_time_in_words_hash)可用于确定年龄。闰年的年份部分处理得很好，但请注意，2 月 29 日确实对天数部分有影响，如果需要该级别的详细信息，则需要了解。此外，如果您不喜欢 dotiw 如何更改 distance_of_time_in_words 的格式，请使用 :vague 选项恢复为原始格式。

将 dotiw 添加到 Gemfile：

```
gem 'dotiw' 
```

在命令行上：

```
bundle 
```

在适当的模型中包含 DateHelper 以获得对 distance_of_time_in_words 和 distance_of_time_in_words_hash 的访问。在此示例中，模型为“用户”，生日字段为“生日”。

```
class User < ActiveRecord::Base
  include ActionView::Helpers::DateHelper 
```

将此方法添加到同一模型。

```
def age
  return nil if self.birthday.nil?
  date_today = Date.today
  age = distance_of_time_in_words_hash(date_today, self.birthday).fetch("years", 0)
  age *= -1 if self.birthday > date_today
  return age
end 
```

用法：

```
u = User.new("birthday(1i)" => "2011", "birthday(2i)" => "10", "birthday(3i)" => "23")
u.age 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-03-14T00:20:30.527

我相信这在功能上等同于@philnash 的答案，但 IMO 更容易理解。

```
class BirthDate
  def initialize(birth_date)
    @birth_date = birth_date
    @now = Time.now.utc.to_date
  end

  def time_ago_in_years
    if today_is_before_birthday_in_same_year?
      age_based_on_years - 1
    else
      age_based_on_years
    end
  end

  private

  def age_based_on_years
    @now.year - @birth_date.year
  end

  def today_is_before_birthday_in_same_year?
    (@now.month < @birth_date.month) || ((@now.month == @birth_date.month) && (@now.day < @birth_date.day))
  end
end 
```

用法：

```
> BirthDate.new(Date.parse('1988-02-29')).time_ago_in_years
 => 31 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-10-17T18:58:23.893

```
class User
  def age
    return unless birthdate
    (Time.zone.now - birthdate.to_time) / 1.year
  end
end 
```

可以通过以下测试进行检查：

```
RSpec.describe User do
  describe "#age" do
    context "when born 29 years ago" do
      let!(:user) { create(:user, birthdate: 29.years.ago) }

      it "has an age of 29" do
        expect(user.age.round).to eq(29)
      end
    end
  end
end 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-10-04T06:45:33.760

以下似乎有效（但如果检查过，我将不胜感激）。

```
age = now.year - bday.year
age -= 1 if now.to_a[7] < bday.to_a[7] 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-02-14T09:37:43.193

如果您不关心一两天，这将更短且不言自明。

```
(Time.now - Time.gm(1986, 1, 27).to_i).year - 1970 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-10-30T02:04:15.100

好吧，这个呢：

```
def age
  return unless dob
  t = Date.today
  age = t.year - dob.year
  b4bday = t.strftime('%m%d') < dob.strftime('%m%d')
  age - (b4bday ? 1 : 0)
end 
```

这是假设我们正在使用 rails，`age`在模型上调用方法，并且模型有一个 date 数据库列`dob`。这与其他答案不同，因为此方法使用字符串来确定我们是否在今年生日之前。

例如，如果`dob`是 2004/2/28 并且`today`是 2014/2/28，`age`则将是`2014 - 2004`或`10`。花车将是`0228`和`0229`。`b4bday`将是`"0228" < "0229"`或`true`。最后，我们将减去并`1`得到。`age``9`

这将是比较两次的正常方式。

```
def age
  return unless dob
  t = Date.today
  age = today.year - dob.year
  b4bday = Date.new(2016, t.month, t.day) < Date.new(2016, dob.month, dob.day)
  age - (b4bday ? 1 : 0)
end 
```

这同样适用，但`b4bday`线路太长。`2016`年份也是不必要的。开头的字符串比较就是结果。

你也可以这样做

```
Date::DATE_FORMATS[:md] = '%m%d'

def age
  return unless dob
  t = Date.today
  age = t.year - dob.year
  b4bday = t.to_s(:md) < dob.to_s(:md)
  age - (b4bday ? 1 : 0)
end 
```

如果你不使用rails，试试这个

```
def age(dob)
  t = Time.now
  age = t.year - dob.year
  b4bday = t.strftime('%m%d') < dob.strftime('%m%d')
  age - (b4bday ? 1 : 0)
end 
```

# 

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-08T01:13:44.880

我认为不计算月份要好得多，因为您可以使用`Time.zone.now.yday`.

```
def age
  years  = Time.zone.now.year - birthday.year
  y_days = Time.zone.now.yday - birthday.yday

  y_days < 0 ? years - 1 : years
end 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-06-21T14:39:50.977

想出了这个[解决方案的 Rails 变体](https://stackoverflow.com/a/1404/1837232)

```
def age(dob)
    now = Date.today
    age = now.year - dob.year
    age -= 1 if dob > now.years_ago(age)
    age
end 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-06-09T15:24:42.750

DateHelper 只能用于获取年份

```
puts time_ago_in_words '1999-08-22' 
```

> 近20年

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-11-27T06:28:15.357

```
 def computed_age
    if birth_date.present?
      current_time.year - birth_date.year - (age_by_bday || check_if_newborn ? 0 : 1)
    else
      age.presence || 0
    end
  end

  private

  def current_time
    Time.now.utc.to_date
  end

  def age_by_bday
    current_time.month > birth_date.month
  end

  def check_if_newborn
    (current_time.month == birth_date.month && current_time.day >= birth_date.day)
  end``` 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2010-06-25T18:56:21.017

```
 def birthday(user)
    today = Date.today
    new = user.birthday.to_date.change(:year => today.year)
    user = user.birthday
    if Date.civil_to_jd(today.year, today.month, today.day) >= Date.civil_to_jd(new.year, new.month, new.day)
      age = today.year - user.year
    else
      age = (today.year - user.year) -1
    end
    age
  end 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2011-05-10T14:36:17.263

```
Time.now.year - self.birthdate.year - (birthdate.to_date.change(:year => Time.now.year) > Time.now.to_date ? 1 : 0) 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2013-07-14T08:11:40.853

考虑闰年（并假设积极支持存在）：

```
def age
  return unless birthday
  now = Time.now.utc.to_date
  years = now.year - birthday.year
  years - (birthday.years_since(years) > now ? 1 : 0)
end 
```

`years_since`将正确修改日期以考虑非闰年（当生日为 时`02-29`）。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2018-02-08T14:57:52.420

这是我的解决方案，它还允许计算特定日期的年龄：

```
def age on = Date.today
  (_ = on.year - birthday.year) - (on < birthday.since(_.years) ? 1 : 0)
end 
```

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2012-11-02T13:53:39.940

我也不得不处理这个问题，但是几个月。变得太复杂了。我能想到的最简单的方法是：

```
def month_number(today = Date.today)
  n = 0
  while (dob >> n+1) <= today
    n += 1
  end
  n
end 
```

你可以用 12 个月做同样的事情：

```
def age(today = Date.today)
  n = 0
  while (dob >> n+12) <= today
    n += 1
  end
  n
end 
```

这将使用 Date 类来增加月份，这将处理 28 天和闰年等。

# .net - 如何获取托管 System.IO.FileStream 的底层 stdio FILE*？

> ID：819268
> 
> 赞同：0
> 
> 时间：2009-05-04T08:28:43.343
> 
> 标签：.net, c++, filestream, stdio

我正在为 C/C++ 库编写一个 .NET 适配器，其中方法“bar”采用常规 stdio FILE*。是否可以构建一个接口，以便托管代码用户可以传递托管（文件）流？那就是没有创建中间缓冲区和代码来管道之间的数据。还有 bar() 读取的假设是否会使事情变得更好？

```
// native code
void bar(FILE*);

// interface for managed code
void foo(System::IO::FileStream^ file)
{
    FILE* stdio_handle = ???;

    bar(stdio_handle);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T08:30:42.793

[`System.IO.FileStream.Handle`](http://msdn.microsoft.com/en-us/library/system.io.filestream.handle.aspx)

不一定要`stdio`处理。这是一个 Windows 句柄。我不认为`FileStream`是建立在`stdio`有一个`stdio`句柄的基础上的。

正如 Marc 在 MSDN 链接中指出和提到的，您可能需要考虑使用`SafeFileHandle`属性（如果您使用的是 .NET 2.0+）而不是`Handle`（现在被认为已过时）。不过，仅`Handle`在旧版本中可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T08:38:51.540

> 是否可以构建一个接口，以便托管代码用户可以传递托管（文件）流？

不，不可能将流转换为文件描述符 ( `FILE`*)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T14:59:55.260

如果你必须有一个 stdio 句柄，你总是可以首先使用 fopen 打开文件。[这](http://weblogs.asp.net/ralfw/archive/2006/03/04/439580.aspx)描述了一个用于导出 c stdlib 文件函数的包装器，然后他使用互操作来处理它们。

# c - atomic.h 的操作似乎是非原子的

> ID：819269
> 
> 赞同：10
> 
> 时间：2009-05-04T08:28:44.780
> 
> 标签：c, linux, multithreading

下面的代码为 n 和 v 生成随机值。n 是随机的而没有得到适当的保护也就不足为奇了。但是假设v最终应该为0。我的代码有什么问题吗？或者有人可以为我解释一下吗？谢谢。

我正在开发 x86 架构的 4 核服务器。uname如下。

Linux 2.6.9-22.ELsmp #1 SMP Mon Sep 19 18:00:54 EDT 2005 x86_64 x86_64 x86_64 GNU/Linux

```
#include <stdio.h>
#include <pthread.h>
#include <asm-x86_64/atomic.h>

int n = 0;
atomic_t v;
pthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;

#define LOOP 10000

void* foo(void *p)
{
    int i = 0;
    for(i = 0; i < LOOP; i++) {
//        pthread_mutex_lock(&mutex);
        ++n;
        --n;
        atomic_inc(&v);
        atomic_dec(&v);
//        pthread_mutex_unlock(&mutex);
    }

    return NULL;
}

#define COUNT 50

int main(int argc, char **argv)
{
    int i;
    pthread_t pids[COUNT];
    pthread_attr_t attr;
    pthread_attr_init(&attr);
    atomic_set(&v, 0);

    for(i = 0; i < COUNT; i++) {
        pthread_create(&pids[i], &attr, foo, NULL);
    }

    for(i = 0; i < COUNT; i++) {
        pthread_join(pids[i], NULL);
    }

    printf("%d\n", n);
    printf("%d\n", v);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T09:01:26.137

您应该改用 gcc 内置函数（参见。this ）[这](http://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Atomic-Builtins.html)很好用，也适用于 icc。

```
int a; 
__sync_fetch_and_add(&a, 1); // atomic a++ 
```

请注意，当您修改变量而不锁定时，您应该注意缓存一致性问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T08:34:49.803

[这个旧帖子](http://lkml.indiana.edu/hypermail/linux/kernel/0607.1/0952.html)暗示

*   你应该在用户空间程序中包含这个内核头文件并不明显
*   众所周知，它无法为用户空间程序提供原子性。

所以......也许这就是你所看到的问题的原因？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T08:41:16.200

我们可以看看代码的汇编输出吗（我认为是 gcc -E）。尽管 uname 表明它支持 SMP，但这并不一定意味着它是使用 CONFIG_SMP 编译的。

没有它，汇编代码输出没有`lock`前缀，您会发现您的内核相互干扰。

但无论如何我都会使用 pthread 函数，因为它们可以跨更多平台移植。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-10T08:48:09.373

Linux 内核`atomic.h`不能从用户态使用，而且从来没有。在 x86 上，其中一些可能工作，因为 x86 是相当同步友好的架构，但在某些平台上，它严重依赖能够执行特权操作（旧臂）或至少能够禁用抢占（旧臂和 sparc至少），这在用户态不是这样！

# ruby - rake 的目录依赖关系

> ID：819291
> 
> 赞同：2
> 
> 时间：2009-05-04T08:40:12.613
> 
> 标签：ruby, directory, rake

我正在使用 rake 来复制目录：

```
file copied_directory => original_directory do
#copy directory
end 
```

这工作正常，除非 original_directory 中的某些*内容*发生更改。问题是封闭目录上的 mod 日期没有改变，所以 rake 不知道要再次复制目录。有没有办法处理这个？不幸的是，我当前的设置不允许我为 original_directory 中的每个单独文件设置单独的依赖项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:34:59.510

您可以使用 rsync 使 2 个目录保持同步，如下所示：http: [//asciicasts.com/episodes/149-rails-engines](http://asciicasts.com/episodes/149-rails-engines)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-25T23:13:43.913

您不需要知道依赖于它们的文件：

```
file copied_directory => FileList[original_directory, original_directory + "/**/*"] 
```

# maven-2 - 如何在运行时获取 maven2 的 Mojo 中的目标名称

> ID：819292
> 
> 赞同：0
> 
> 时间：2009-05-04T08:40:39.883
> 
> 标签：maven-2, maven-plugin, mojo

对于 Maven2，如何获取 Mojo 的执行方法中当前正在执行的目标名称？确切地说，我需要 Mojo 的执行方法中的 @goal 属性值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T13:11:42.977

```
public static String getGoalName(PluginDescriptor pluginDescriptor, String mojoClassName) {
        String goalName=null;
        List<MojoDescriptor> mojoDescriptorList = pluginDescriptor.getMojos();
        for (MojoDescriptor mojoDescriptor : mojoDescriptorList) {
            if (mojoDescriptor.getImplementation().equals(mojoClassName)) {
                goalName=mojoDescriptor.getGoal();
                break;
            }
        }
        return goalName;
    } 
```

在这里，可以从 pluginManager.getPluginDescriptorForPrefix("prefix-for-your-plugin") 获取 PluginDescriptor。PluginManager 可用作 @component role="org.apache.maven.plugin.PluginManager"

# excel - 根据 Excel 中的日期对数据求和

> ID：819296
> 
> 赞同：1
> 
> 时间：2009-05-04T08:41:32.080
> 
> 标签：excel, sum

我的问题是以下...

我有一架小飞机，我需要跟踪时间。我必须按部门而不是一天的总数来跟踪时间（这就是为什么有时我在同一天有 2 或 3 个）。

现在这就是问题所在...在 CI 列上需要对过去 7 天的小时数求和。任何给定的 7 天，而不仅仅是上周。手动操作很容易......问题是我需要一个公式，因为我的记录很大......

这里有一个小例子（假设在 15/01/2009 之前没有 HOURS）...

A栏-------B栏-----C栏

日期--------------小时--------小时过去 7 天

15/01/2009--------01:00--------01:00

15/01/2009--------02:15--------03:15

16/01/2009--------01:15--------04:30

17/01/2009--------01:30--------06:00

18/01/2009--------01:30--------07:30

18/01/2009--------01:00--------08:30

18/01/2009--------02:00--------10:30

19/01/2009--------02:30--------13:00

19/01/2009--------03:00--------16:00

20/01/2009-------///////--------16:00

21/01/2009--------01:00--------17:00

22/01/2009--------01:30--------15:15

23/01/2009--------02:00--------16:00

过去几周我一直在努力找出一个公式，但没有运气......有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T15:27:25.770

首先是获取开始日期，这将是以下函数：

```
=Now() - 7 
```

如果您将该单元格重命名为“WeekBegin”，则可以使用以下公式计算总小时数：

```
=SUMIF(A:A,">=" & WeekBegin,B:B) 
```

请注意，我使用了列引用；这既是为了简化公式，也是为了让您可以轻松地将新数据添加到范围的末尾。您需要注意您的 WeekBegin 单元格*不在*该列 A 或 B 列中，否则您将收到循环引用警告。

如果您计划将数值数据置于输入范围之上或之下，则需要显式调用总和和条件范围，如下所示：

```
=SUMIF(A2:A14,">=" & WeekBegin,B2:B14) 
```

此外，您可能会发现您的结果最初以小数形式出现。这是 Excel 的日期序列格式，因此您可能需要将结果格式化为时间。

希望有帮助！

[编辑：在第二次通过时，如果您要根据从和到日期对范围求和（因此您似乎在帖子中暗示的任何 7 天），请查找上一张海报的注释，即：

```
=SUM(B:B) - SUMIF(A:A, "<="& BeginDate, B:B) - SUMIF(A:A, ">"& EndDate, B:B) 
```

Excel 2007 中使用 SumIFS() 函数提供了一个更优雅的解决方案：

```
=SUMIFS(B:B, A:A, ">=" & FromDate,A:A, "<" & ToDate) 
```

请注意，SUMIFS 的参数与标准 SUMIF 的顺序不同。

总结快乐！]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T03:09:37.097

另一个与之前提供的解决方案基本相同的解决方案：

在 C1 中，输入以下公式：

```
{=SUM(IF(($A$1:$A1>=($A1-6))*($A$1:$A1<=$A1), $B$1:$B1, 0))} 
```

然后将公式向下拖动。

如果您不熟悉数组公式，{} 外括号仅表示该公式是数组公式。要使其正确执行，您需要将 {} 括号内的部分复制到公式栏中，然后按 Ctrl+Shift+Enter 表示它是一个数组公式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T08:52:21.040

如果有人想尝试，这里是格式更好的数据：

```
15-Jan-2009 01:00
15-Jan-2009 02:15
16-Jan-2009 01:15
17-Jan-2009 01:30
18-Jan-2009 01:30
18-Jan-2009 01:10
18-Jan-2009 02:00
19-Jan-2009 02:30
19-Jan-2009 03:00
20-Jan-2009 
21-Jan-2009 01:00
22-Jan-2009 01:30
23-Jan-2009 02:00 
```

我得到了这个功能：

```
=SUM($B$1:$B$13)-SUMIF($A$1:$A$13, "<="& (A1- 7), $B$1:$B$13) - SUMIF($A$1:$A$13, ">"& (A1), $B$1:$B$13) 
```

这是基于[迄今为止有条件的命名范围的总和？](http://www.microsoft.com/office/community/en-us/default.mspx?&lang=&cr=&guid=&sloc=en-us&dg=microsoft.public.excel.worksheet.functions&p=1&tid=3838685D-D450-4A16-8B31-79A996125C6C&mid=3838685D-D450-4A16-8B31-79A996125C6C). 这个想法是首先计算总和： `SUM($B$1:$B$13)`

然后减去 7 天前发生的任何值：`SUMIF($A$1:$A$13, "<="& (A1- 7), $B$1:$B$13)`

然后减去将来发生的任何值：`SUMIF($A$1:$A$13, ">"& (A1), $B$1:$B$13)`

关键是使用[SUMIF](http://office.microsoft.com/en-us/excel/HP052092921033.aspx)函数，它“添加由给定条件指定的单元格”。

# php - PHP标签关闭——什么时候需要？

> ID：819297
> 
> 赞同：4
> 
> 时间：2009-05-04T08:41:37.103
> 
> 标签：php

[建议](http://framework.zend.com/manual/en/coding-standard.php-file-formatting.html)不要在文件末尾放置 PHP 结束标记，以避免各种不良错误。但是是否有需要关闭 PHP 标签的情况？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-04T08:45:14.303

如果您想从 PHP 代码块切换到纯文本输出，则需要一个结束标记。

这是一个例子：

```
<?php
    // PHP code block
?>
<!-- plain text output and not processed by PHP -->
</body> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-04T08:55:42.233

顺便说一句，如果您想知道通过跳过结束标记来防止什么错误。由于 Zend 的解释没有详细说明。

> PHP 不需要它，并且省略它可以防止意外地将尾随空格注入响应中。

这意味着如果您想使用 header() 将某人重定向到其他位置或以任何方式更改 HTTP 标头......那么如果某些文件以这种方式结束，您将无法并且会收到错误消息。

```
}
?>
 //space here 
```

因为那时这个空间将作为内容输出到网站，然后你不能修改标题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-04T09:09:16.443

这是我个人的“规则”：

*   仅包含 php 代码的文件：**永不结束标记**
*   与 php 混合的文件（即 HTML）：**始终结束标记**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-04T08:45:35.067

仅当您想在 php 块之后输出非 php 代码时才需要它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T08:46:34.097

当您不只是在脚本中使用 PHP 时 :-)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T09:03:18.767

作为一般规则，我总是添加结束标记，因为这是我的问号手指一整天唯一得到锻炼的时间。那个可怜的问号在 PHP 中没有得到爱 ;-)

但说真的，在不需要时添加结束标签实际上会导致非常混乱的错误。因为这个，我有一次把头发拉了一个下午。问题通常是因为结束标签后面有空格，您不容易看到，但它们被解释为响应正文的一部分。如果您将此文件包含在另一个想要稍后发送自定义标头的脚本中，这将是一个坏消息。在脚本开始发送响应正文后，您无法发送标头信息，因此这些不可见的小空格会导致脚本失败。

# .net - 你会如何在评论中描述数学？

> ID：819300
> 
> 赞同：7
> 
> 时间：2009-05-04T08:43:56.910
> 
> 标签：.net, math, comments

正如问题所说...

数学符号形式的方程式可能比代码形式更有意义。能够将数学放在评论中可以提高我项目的可读性。

在.NET 中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-04T08:50:57.173

我只是使用多行来做到这一点：

```
// Work out average as:  sum (values)
//                      --------------
//                      count (values)
//
// and distance between points as:
//           _______________________
//          /         2            2
//    d = \/ (x1 - x0)  + (y1 - y0)
//
// and the following function:
//
//             3     2   
//    f(x) = ax  + bx  + cx + d 
```

根本不需要魔法。你不只是喜欢 ASCII 艺术吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T09:17:49.310

跟进@pax's answer to use ascii-art/plain text to render your equations (+1 by the way, pax):

以下是与数学相关的字符的快捷键列表：

°（度）- Alt+0176

±（加/减）- Alt+0177

²（平方）- Alt+0178

³（立方）- Alt+0179

¼ (1/4) - Alt+0188

½ (1/2) - Alt+0189

¾ (3/4) - Alt+0190

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-04T14:32:42.877

我使用乳胶：如果它很简单，你无论如何都可以看到它，如果它很复杂 - 将它剪切并粘贴到最近的 wordpress 窗口中，大多数时候它们会正确解析。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-04T08:48:27.650

对于简单的注释，我通常使用 LaTeX 或 Word 的语法。但通常是 Word，因为 e。G。β 比 更具可读性`\beta`。由于我的源文件通常是 Unicode，这不会造成问题。另外，我不喜欢在所有东西上都放太多大括号 :-)

有时我对 Javadoc 感到厌烦，并使用大量 HTML 来漂亮地显示 Javadoc 中的公式，但这无助于源代码的可读性（并且利用了 Javadoc*仅*构建为 HTML 的事实，在 .NET 中没有运气）。

我会把 Pax 的样本写成

```
// Work out average as:
//   ∑(values)/|values|
// and distance between points as:
//   d = √( (x_1 - x_0)²  + (y_1 - y_0)² )
// and the following function:
//   f(x) = ax³  + bx²  + cx + d 
```

不过，我很少使用 Unicode 下标，因为它们并不适用于所有字体，尤其是那些不适合代码的字体 :)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-04T17:13:51.693

这是对马特帖子的评论，但我的声誉太低了。我为 LaTex 做了类似的事情。它是一个 Sandcastle 构建组件，它解析嵌入在 XML 注释中的 LaTeX 并创建添加回文档的图像。它是 mimeTeX 的简单包装器。您可以在以下位置查看 alpha 代码：http: [//github.com/cuda/latex-sandcastle/](http://github.com/cuda/latex-sandcastle/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T08:48:43.793

你知道，对于 ScottGu 在上一次 PDC 上展示的 Visual Studio 可扩展性来说，这将是一个很棒的应用程序（他在那里编写了一个 MEF 插件来以不同的样式显示注释）。

您可以使用[MathML](http://en.wikipedia.org/wiki/MathML)编写数学注释，然后打开一个插件来解析标记并将其显示为适当的方程式。

这更像是一个天上掉馅饼的评论，而不是对你问题的真正答案，但我想我会发布它让人们思考。也许有一天会有人这样做！:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T09:09:09.173

对我来说，理解一个复杂的数学问题的最简单方法是插入一些实数并坚持下去。除非我只是提醒自己它是做什么的，否则阅读它是如何工作的是不够的。

使用 Nunit 测试非常适合给出如何使用复杂数学问题的实际示例。也许只是使用注释来指出他们可以通过单元测试以及在哪里可以找到它们。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-08T14:47:05.423

为了使数学公式的 ASCII 渲染更容易一些，有[asciiTeX](http://asciitex.sourceforge.net/)。asciiTeX 接受 LaTeX 风格的方程并以 ASCII-art 打印出来。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-04T08:51:21.353

记住你的听众是什么。该评论必须对您几个月后的您以及您（现在和未来的）队友现在都有意义。因此，如果数学符号对你们所有人来说都是完全可以理解的，那就没问题了；尽管如此，由于我不知道谁会阅读该评论，因此我会添加文本表示或描述。

# .net - 水晶报表横向生长

> ID：819307
> 
> 赞同：1
> 
> 时间：2009-05-04T08:46:23.160
> 
> 标签：.net, crystal-reports

我们可以设置字段的增长属性，使其随着内容垂直增长，我们如何水平增长它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T15:51:12.110

让领域更广？考虑一个页面。您只能使用页面的宽度。在垂直增长的情况下，您可以继续增长到下一页。

# python - 使用 QString 编码

> ID：819310
> 
> 赞同：1
> 
> 时间：2009-05-04T08:47:22.177
> 
> 标签：python, encoding

是否有一个 Python 库可以检测（也可能是解码）字符串的编码？

我发现[`chardet`](http://pypi.python.org/pypi/chardet)但它给了我一个错误，使用：

```
chardet.detect(self.ui.TextFrom.toPlainText())
got: = chardet.detect(self.ui.TextFrom.toPlainText())
File .... u.feed(aBuf) File .... 
if self._highBitDetector.search(aBuf):

TypeError: buffer size mismatch 
```

还：

```
print type(self.ui.TextFrom.toPlainText())
# <class 'PyQt4.QtCore.QString'> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T10:18:47.073

您需要先将您的字符串转换`QString`为 Python 字符串，然后再将其传递给`chardet`. 改变这个：

```
chardet.detect(self.ui.TextFrom.toPlainText()) 
```

对此：

```
chardet.detect(str(self.ui.TextFrom.toPlainText())) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T08:55:36.930

我想这是另一种选择。

[http://cthedot.de/encutils/](http://cthedot.de/encutils/)

> 一组辅助函数，用于检测通过 HTTP、文件或字符串检索的文本文件（如 HTML、XHTML、XML、CSS 等）的编码。

# user-interface - 寻找简单的基于脚本的 gui 框架，输出是关闭的 exe

> ID：819316
> 
> 赞同：0
> 
> 时间：2009-05-04T08:49:16.803
> 
> 标签：user-interface, scripting, frameworks

我需要基于脚本语言的 GUI 框架（和 linux 后者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T08:56:25.383

[鞋子](http://shoooes.net/ "鞋")非常好，跨平台，用 ruby​​ 编写，允许将程序打包为 win32、mac、linux 的可执行文件。

# c - C 编程数据类型

> ID：819317
> 
> 赞同：5
> 
> 时间：2009-05-04T08:49:22.793
> 
> 标签：c, types

问了一个问题，我不确定我是否给出了准确的答案。问题是，为什么使用`int`，为什么不使用，为什么`char`它们是分开的？都保留在内存中，还有位，为什么数据类型有类别？

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T08:52:10.103

`char`是最小的可寻址内存块——非常适合操作数据缓冲区，但不能容纳超过 256 个不同的值（如果`char`是 8 位，这很常见），因此对于数值计算不是很好。`int`通常大于`char`- 更适合计算，但不太适合字节级操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T09:13:31.350

请记住，`C`它有时用作*高级汇编语言*- 与低级硬件交互。您需要数据类型来匹配机器级功能，例如字节宽度的 I/O 寄存器。

来自[维基百科，C（编程语言）](http://en.wikipedia.org/wiki/C_programming_language#Uses)：

> C 的主要用途是“系统编程”，包括实现操作系统和嵌入式系统应用程序，这是由于代码可移植性和效率、访问特定硬件地址的能力、“双关”类型以匹配外部强加的能力等理想特性的组合数据访问需求，以及对系统资源的低运行时需求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T09:06:02.053

过去，计算机的内存很小。这就是您拥有不同数据类型的主要原因。如果您需要一个仅保存小数字的变量，则可以使用 8 位字符而不是 32 位长。但是，今天的内存很便宜。因此，这个原因现在不太适用，但无论如何都卡住了。

但是，请记住，每个处理器都有一个默认数据类型，因为它以一定的宽度（通常是 32 位）运行。因此，如果您使用 8 位字符，则需要将该值扩展到 32 位并再次返回以进行计算。这实际上可能会稍微减慢您的算法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T16:33:29.327

*该标准对char*和*int*的限制很少：

*   *char*必须能够保存 ASCII 值，即最少 7 位（编辑：根据 C 标准，CHAR_BIT 至少为 8）。它也是最小的可寻址内存块。

*   *int*至少为 16 位宽，并且是“推荐的”默认整数类型。此建议留给实现（您的 C 编译器）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T08:55:14.497

一般来说，有一些算法和设计是抽象的，而数据类型有助于实现这些抽象。例如 - 权重很有可能通常表示为一个有理数，它可以在存储中以浮点/双精度的形式最好地实现，即一个具有精度部分的数字。

我希望这有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T08:59:08.030

`int`是“自然”整数类型，您应该将它用于大多数计算。

`char`本质上是一个字节；它是可寻址的最小内存单元。`char`不是在所有平台*上*都是 8 位宽，尽管大多数时候都是这样。

# batch-file - 将文本文件数据附加到日志文件 .bat

> ID：819319
> 
> 赞同：7
> 
> 时间：2009-05-04T08:49:55.087
> 
> 标签：batch-file

该`.bat`文件用于网站复制，将文件从开发传输到生产，然后生成包含作业统计信息的日志文件。我想在日志文件的末尾包含一个文本文件的内容。是否有捷径可寻？

```
@ECHO off
    IF "%1"=="" goto :Syntax
    for %%d in (%1) do call :sub0 %%d
    goto :END

    :sub0
    Echo Replicating Site %1
    rem subinacl /subdirectories D:\inetpub\%1\*.* /setowner=Administrators REM /grant=Administrators=f /grant=SYSTEM=f
    robocopy D:\inetpub\%1 \\111.111.11.11\D$\inetpub\%1 /MIR /ZB /NP /R:3 /W:3 /XD SiteReplication /XD SiteLogs /XD Administration /XD sitestatistics /XF calendar_secure.asp /XF navigation_editor.asp  /LOG:logs\test%USERNAME%.log
    robocopy D:\inetpub\%1 \\111.111.11.11\D$\inetpub\%1 /MIR /ZB /NP /R:3 /W:3 /XD SiteReplication /XD SiteLogs /XD Administration /XD sitestatistics /XF calendar_secure.asp /XF navigation_editor.asp  /LOG+:logs\test.log

    goto :EOF

    :Syntax
    ECHO Usage:  _REP_SITE WEB_Site
    ECHO.
    ECHO Where:  "WEB_Site"   is the name of the folder you want to replicate
    ECHO                      i.e. _REP_SITE www.test.com
    ECHO.
    goto :END

    :END
    exit 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-04T08:53:25.297

就像是：

```
type textfile.txt >> test.log 
```

?

（请注意，在批处理文件中，*您*当前正在创建两个单独的日志文件。这是故意的吗？）

或者，如果您需要将文件复制到其他地方，您可以这样做：

```
copy test.log+textfile.txt destination.log 
```

那是`destination.log`从末尾附加的`test.log`。`textfile.log`

# c# - ASP.NET 在 Global.asax 中捕获和替换输出

> ID：819326
> 
> 赞同：3
> 
> 时间：2009-05-04T08:51:28.140
> 
> 标签：c#, asp.net, global-asax

我需要替换从我网站上的每个页面发送的一些数据，我想用 Global.asax 来做。到目前为止，这是我尝试过的：

```
void Application_PreSendRequestContent(object sender, EventArgs e)
{
    System.IO.StreamReader sr = new System.IO.StreamReader(Response.OutputStream);
    String output = sr.ReadToEnd();

    Response.ClearContent();
    Response.Write("Testing..");
} 
```

但这给了我一个 ArgumentException。我究竟做错了什么？有没有更好的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T08:58:40.637

> 有没有更好的方法来做到这一点？

对于此类任务， [HttpModule](http://msdn.microsoft.com/en-us/library/ms227673.aspx)可能是更好的选择。

有关如何修改请求响应的示例，请查看这篇文章：[使用响应过滤器生成符合 XHTML 的页面](http://web.archive.org/web/20140906104137/http://www.aspnetresources.com/articles/HttpFilters)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T17:30:37.097

[在 ASP.NET MVC 和 IIS7 中记录原始 HTTP 请求/响应](https://stackoverflow.com/questions/1038466/logging-raw-http-request-response-in-asp-net-mvc-iis7)的帖子非常准确地描述了如何获取响应的副本。

# php - 在 PHP 类之间共享对象

> ID：819334
> 
> 赞同：4
> 
> 时间：2009-05-04T08:54:41.143
> 
> 标签：php, oop

在其他类之间共享对象的最佳方式是什么？

例如; 具有“文章”和“用户”对象所需功能的“数据库”对象。

我不想使用全局变量（包括单例）或在每个类中创建对象的新实例，例如

```
function __construct() {
    $this->database = new database;
    $this->cache = new cache;
} 
```

将传递对象，例如。

```
class test{
    function __construct( $obj ) {
        $this->obj = $obj;
    }
}
$database = new database;
$test = new test( $database ); 
```

是要走的路吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T08:57:55.457

是的。将对象传递给构造函数 - 或传递给 setter - 是最好的方法。这种模式称为[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)。它还有一个额外的好处是它使你的代码更容易测试（使用存根或模拟）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T08:58:21.040

是的，这几乎就是您想要做的方式。如果一个类有外部需求，不要在类内部创建它们，而是在构造函数中要求它们作为参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T08:58:20.543

如果他们有一个实例，那么要走的路就是单例。如果没有，唯一的方法是在初始化期间传递它们（例如：在构造函数中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T08:59:38.527

这将是朝着正确方向迈出的一步，但在我看来，你**确实**想要一个单例，即使实际上并没有受到代码的限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T13:49:24.883

您还可以使用之前在会话或缓存（APC、memcached）中加载的对象。我个人认为单例是去那里的最佳方式（尤其是对于数据库类）

# javascript - 如何在没有 Javascript 的情况下预加载图像？

> ID：819336
> 
> 赞同：36
> 
> 时间：2009-05-04T08:55:17.837
> 
> 标签：javascript, html, image-preloader

在我的布局之一中，有一些大图像（来自 XML），当我将鼠标悬停在某些链接上时会显示这些图像，但是当页面加载和翻转时加载该图像需要时间。

**注意：**有修复5张图片*（非动态）*

我不想使用 JavaScript 预加载图像任何解决方案？

**我没有使用悬停菜单或类似的东西，但这个图像是产品图像，链接是文本链接**明白我的意思了吗？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-09-16T17:55:54.157

HTML5 有一种新方法可以做到这一点，即`link prefetching`.

```
<link rel="prefetch" href="http://davidwalsh.name/wp-content/themes/walshbook3/images/sprite.png" /> 
```

`link`只需在 HTML 中添加您需要的许多标签，您就可以开始了。当然，较旧的浏览器不会以这种方式加载内容。

**注意** 上面的代码不适用于 Apple Safari Safari 不支持预取直到现在版本 12 [https://caniuse.com/#search=prefetch](https://caniuse.com/#search=prefetch)

**更新**

如果您的服务器使用 HTTP2，您还可以`Link`在响应中添加一个使用[HTTP2 Server Push](https://en.wikipedia.org/wiki/HTTP/2_Server_Push)的标头。

```
Link: <http://davidwalsh.name/wp-content/themes/walshbook3/images/sprite.png>; rel=preload; as=image; 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-05-04T11:56:53.843

来自[http://snipplr.com/view/2122/css-image-preloader](http://snipplr.com/view/2122/css-image-preloader)

> 一种仅使用 CSS 的低技术但有用的技术。将 css 放入样式表后，将其插入页面的 body 标记下方：每当在整个页面中引用图像时，它们现在将从缓存中加载。

```
#preloadedImages
{
    width: 0px;
    height: 0px;
    display: inline;
    background-image: url(path/to/image1.png);
    background-image: url(path/to/image2.png);
    background-image: url(path/to/image3.png);
    background-image: url(path/to/image4.png);
    background-image: url();

} 
```

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2009-05-04T09:12:18.683

无需预加载图像。我不明白为什么 99% 的人认为悬停效果必须使用 2 张图像。没有这样的需要，并且使用 2 张图像会使它看起来很糟糕。我知道的唯一好的解决方案是对 A 元素使用 CSS（或对所有其他按钮使用简单的 JS）。当我们悬停按钮时，将背景位置设置为某个偏移量。

```
a { display:block; width:160px; height:26px; background:url(b_tagsdesc.png); }
a:hover { background-position:0 26px } 
```

就是这样，您可以在下面看到使用的图像：

[![替代文字](https://i.stack.imgur.com/tRV8P.png)](https://i.stack.imgur.com/tRV8P.png)
[（来源：[margonem.pl](http://www.margonem.pl/img/b_tagsdesc.png)）]

编辑：您也可以以其他方式使用它。您可以隐藏图像，而不是切换图像。所以起点是“背景位置：0 -100px”，悬停在“0 0”上。

这种技术被称为 CSS sprites - 这里有很好的描述：[http ://css-tricks.com/css-sprites/](http://css-tricks.com/css-sprites/)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-07-08T18:01:57.147

我还没有看到这里提到的一种技术，如果您不需要担心 IE6 和 7，它会非常有用，它是使用`:after`伪选择器将图像添加`content`到页面上的元素中。以下代码摘自[本文](http://www.thecssninja.com/css/even-better-image-preloading-with-css2)：

```
body:after {
    content: url(img01.jpg) url(img02.jpg) url(img03.jpg);
    display: none;
} 
```

与使用 JavaScript 预加载图像相比，我能看到的唯一缺点是没有简单的方法可以从内存中释放它们。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-04T09:03:43.337

您可以使用隐藏的 div 来放置图像。像这样

```
<html>
<body>
<div style="width:1px; height:1px; visibility:hidden; overflow:hidden">
    <img src="img1.jpg" /><img src="img2.jpg" />
</div>
<div>Some html</div>
</body>
</html> 
```

但这仅适用于图像，即。如果您尝试对 .swf 文件执行相同操作，则会出现问题。如果 .swf 文件不可见，Firefox 不会运行它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-04T09:00:28.463

在不可见的 img 标签中引用您的图像。在页面加载时，它们也会下载。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-04T09:20:44.343

由于我不确定是否加载了隐藏图像，您可能需要使用[图像精灵](http://www.alistapart.com/articles/sprites)。然后在显示任何内容之前加载整个图像。您甚至可以将所有菜单项放在一张图像中，从而节省大量 HTTP 请求。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-04-21T01:22:28.370

如果预加载图像是您所追求的，那么性能就是您想要的。我怀疑在资源加载是你想要的时候阻塞页面。所以，只需在正文的末尾放置一些预取链接并将虚假媒体添加到其中，以使它们看起来不重要（以便它们在其他所有内容之后被加载）。然后，将 onload 标记添加到这些链接中，其中 onload 将是设置页面中实际资源来源的代码。例如，这甚至可以与动态 iframe 结合使用。

# 前：

```
<a onclick="myFrame.style.opacity=1-myFrame.style.opacity;myFrame.src='http://jquery.com/'">
    Click here to toggle it
</a><br />
<iframe id="myFrame" src="" style="opacity: 0"></iframe>
```

# 后：

```
<a onclick="myFrame.style.opacity=1-myFrame.style.opacity">
    Click here to toggle it
</a><br />
<iframe id="myFrame" src="" style="opacity: 0"></iframe>
<link rel="prefetch" href="http://jquery.com/"
      onload="myFrame.src=this.href" media="bogus" />
```

请注意第一个（之前）如何冻结页面并以非常难看的方式闪烁，而第二个（之后）预加载内容并没有冻结页面或闪烁，而是立即无缝地出现和消失。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-04T09:01:16.370

您不能将它们作为`<img />`标签添加到您的页面并使用 css 隐藏它们吗？

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-07-05T14:52:56.930

```
<link rel="preload" as="image" href="..." /> 
```

当我们想为 CSS 提前加载图像时，这对我最有效（而 rel="prefetch" 会导致从 CSS 重复加载）

# html - 如何在 Google App Engine 上托管静态 HTML 文件？

> ID：819346
> 
> 赞同：39
> 
> 时间：2009-05-04T08:56:50.750
> 
> 标签：html, google-app-engine, web-applications, hosting

是否可以在 App Engine 上托管静态 HTML 网站？以及如何使我的域名与它一起使用？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-05-04T09:00:12.580

是的，您可以在 AppEngine 上托管您的静态文件。只需像下面这样配置您的 app.yaml 文件

```
- url: /
  static_dir: static_files 
```

并将您的文件放在目录 static_files 中。这样，每个请求都会路由到您的静态文件。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-02-26T20:29:04.823

我刚刚遇到了同样的问题，并决定使用这个解决方案......它从根目录提供静态文件，如果你不提供文件，它会使用 index.html。希望有帮助。

```
# re-direct to index.html if no path is give
- url: /
  static_files: index.html
  upload: index.html

# access the static resources in the root director

- url: /(.*)
  static_files: \1
  upload: (.*) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-09-13T23:59:07.287

我发现我认为是一个**非常**巧妙的解决方案。

## **[干滴](http://drydrop.binaryage.com)**

基本上，据[我](http://www.nata2.org/2011/01/26/how-to-use-app-engine-to-host-static-sites-for-free)所知，您将 DryDrop 部署到 GAE，配置（域、Github html 存储库等），然后通过推送到 GitHub 存储库来发布您的静态 HTML（GitHub 利用“挂钩”来提醒您的 DryDrop 安装任何新的 HTML 更改）。

我个人还没有使用过，但是如果 Threadless Tees 的前 CTO Harper Reed 认为没问题，那对我来说已经足够了 :-D 。

干杯

富有的

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-04T09:06:09.947

要将您自己的域与 Google App Engine 一起使用，[您必须先将您的域设置为与 Google Apps 一起使用](http://www.google.co.uk/support/a/bin/topic.py?hl=en&topic=9194)。

然后，您[将相关的 Google App Engine 应用程序链接到 Google Apps Domain](http://code.google.com/appengine/articles/domains.html)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-26T23:46:58.727

我为此编写了一个库，它可以在 AppEngine 或您想要的任何其他服务器上运行：

[https://github.com/stochastic-technologies/static-appengine-hoster](https://github.com/stochastic-technologies/static-appengine-hoster)

您只需将文件放入目录中，它就会托管它们。它还支持 Jinja2 模板、URL 重写和多个域。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-31T18:03:46.280

这也对我有用。这与@BradAbrams 解决方案完全一样，仅在第二部分使用 static_dir ：

```
handlers:

- url: /
  static_files: index.html
  upload : index.html

- url: /*
  static_dir: "." 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-01T20:24:33.847

您不需要使用任何其他脚本来托管静态网站。我只需要做你提到的类似的事情。

1.  自定义域添加
2.  主要托管 HTML 和静态内容
3.  一些 php 脚本（你不需要）

像这样为每个静态 .html 文件定义处理程序

```
handlers:
    - url: /
      static_files: index.html
      upload : index.html

    - url: /index.html
      static_files: index.html
      upload : index.html 
```

对于静态目录，请使用此

```
- url: /images
  static_dir: images 
```

使用自定义域

如果您从其他地方购买了域，那么您必须将您的域添加为自定义域，然后继续为您的域进行验证过程。在我的例子中，我的域名提供商是 godaddy.com，谷歌自动完成了验证过程。虽然我不得不在 Godaddy 域的 DNS 部分手动添加 Cname 记录。谷歌有完整的自动化系统，所以这根本不难。

# python - 如何在 Python 中检查 ip 是否在网络中？

> ID：819355
> 
> 赞同：121
> 
> 时间：2009-05-04T08:59:20.273
> 
> 标签：python, networking, ip-address, cidr

给定一个 IP 地址（比如 192.168.0.1），我如何在 Python 中检查它是否在网络中（比如 192.168.0.0/24）？

Python中有用于IP地址操作的通用工具吗？诸如主机查找，int 的 ip 地址，带有网络掩码的网络地址到 int 等的东西？希望在 2.5 的标准 Python 库中。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-06-17T00:15:35.323

使用[ipaddress](http://code.google.com/p/ipaddress-py/)（[自 3.3 起在 stdlib 中](http://docs.python.org/3.3/library/ipaddress.html)，[在 PyPi 中为 2.6/2.7](https://pypi.python.org/pypi/ipaddress)）：

```
>>> import ipaddress
>>> ipaddress.ip_address('192.168.0.1') in ipaddress.ip_network('192.168.0.0/24')
True 
```

* * *

如果您想以这种方式评估*大量*IP 地址，您可能需要预先计算网络掩码，例如

```
n = ipaddress.ip_network('192.0.0.0/16')
netw = int(n.network_address)
mask = int(n.netmask) 
```

然后，对于每个地址，使用以下之一计算二进制表示

```
a = int(ipaddress.ip_address('192.0.43.10'))
a = struct.unpack('!I', socket.inet_pton(socket.AF_INET, '192.0.43.10'))[0]
a = struct.unpack('!I', socket.inet_aton('192.0.43.10'))[0]  # IPv4 only 
```

最后，您可以简单地检查：

```
in_network = (a & mask) == netw 
```

* * *

## 回答 #2

> 赞同：168
> 
> 时间：2009-05-04T13:35:13.513

我喜欢为此使用[netaddr](http://pypi.python.org/pypi/netaddr)：

```
from netaddr import CIDR, IP

if IP("192.168.0.1") in CIDR("192.168.0.0/24"):
    print "Yay!" 
```

正如 arno_v 在评论中指出的那样，新版本的 netaddr 是这样的：

```
from netaddr import IPNetwork, IPAddress
if IPAddress("192.168.0.1") in IPNetwork("192.168.0.0/24"):
    print "Yay!" 
```

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2018-07-23T06:04:07.033

对于python3

```
import ipaddress
ipaddress.IPv4Address('192.168.1.1') in ipaddress.IPv4Network('192.168.0.0/24')
ipaddress.IPv4Address('192.168.1.1') in ipaddress.IPv4Network('192.168.0.0/16') 
```

输出 ：

```
False
True 
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-05-04T09:21:29.707

[这篇文章](http://code.activestate.com/recipes/66517/)展示了你可以用[`socket`](http://docs.python.org/library/socket.html)和[`struct`](http://docs.python.org/library/struct.html)模块做到这一点，而不需要太多额外的努力。我在文章中添加了一点如下：

```
import socket,struct

def makeMask(n):
    "return a mask of n bits as a long integer"
    return (2L<<n-1) - 1

def dottedQuadToNum(ip):
    "convert decimal dotted quad string to long integer"
    return struct.unpack('L',socket.inet_aton(ip))[0]

def networkMask(ip,bits):
    "Convert a network address to a long integer" 
    return dottedQuadToNum(ip) & makeMask(bits)

def addressInNetwork(ip,net):
   "Is an address in a network"
   return ip & net == net

address = dottedQuadToNum("192.168.1.1")
networka = networkMask("10.0.0.0",24)
networkb = networkMask("192.168.0.0",24)
print (address,networka,networkb)
print addressInNetwork(address,networka)
print addressInNetwork(address,networkb) 
```

这输出：

```
False
True 
```

如果你只想要一个接受字符串的函数，它看起来像这样：

```
import socket,struct

def addressInNetwork(ip,net):
   "Is an address in a network"
   ipaddr = struct.unpack('L',socket.inet_aton(ip))[0]
   netaddr,bits = net.split('/')
   netmask = struct.unpack('L',socket.inet_aton(netaddr))[0] & ((2L<<int(bits)-1) - 1)
   return ipaddr & netmask == netmask 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2019-12-26T07:16:35.173

使用 Python >= 3.7 [ipaddress](https://docs.python.org/3/library/ipaddress.html)：

```
import ipaddress

address = ipaddress.ip_address("192.168.0.1")
network = ipaddress.ip_network("192.168.0.0/16")

print(network.supernet_of(ipaddress.ip_network(f"{address}/{address.max_prefixlen}"))) 
```

* * *

### 解释

您可以将**IP 地址**视为具有最大可能网络掩码的网络（**对于**`/32`IPv4，`/128`对于 IPv6）

检查是否`192.168.0.1`是在`192.168.0.0/16`本质上与检查是否`192.168.0.1/32`是一个子网相同`192.168.0.0/16`

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2010-12-16T20:16:55.317

这段代码在 Linux x86 上为我工作。我并没有真正考虑过字节序问题，但我已经使用超过 200K IP 地址针对 8 个不同的网络字符串测试了“ipaddr”模块，并且 ipaddr 的结果与此代码相同。

```
def addressInNetwork(ip, net):
   import socket,struct
   ipaddr = int(''.join([ '%02x' % int(x) for x in ip.split('.') ]), 16)
   netstr, bits = net.split('/')
   netaddr = int(''.join([ '%02x' % int(x) for x in netstr.split('.') ]), 16)
   mask = (0xffffffff << (32 - int(bits))) & 0xffffffff
   return (ipaddr & mask) == (netaddr & mask) 
```

例子：

```
>>> print addressInNetwork('10.9.8.7', '10.9.1.0/16')
True
>>> print addressInNetwork('10.9.8.7', '10.9.1.0/24')
False 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-06-05T21:38:55.173

我会尽可能推荐内置的[ipaddress](https://docs.python.org/library/ipaddress.html)模块。虽然它只在 Python 3 中可用，但它非常易于使用，并且支持 IPv6。为什么你还不使用 Python 3，[对吧](https://www.python.org/doc/sunset-python-2/)？

* * *

接受的答案不起作用......这让我很生气。掩码是向后的，不适用于任何不是简单的 8 位块（例如 /24）的位。我调整了答案，效果很好。

```
 import socket,struct

    def addressInNetwork(ip, net_n_bits):  
      ipaddr = struct.unpack('!L', socket.inet_aton(ip))[0]
      net, bits = net_n_bits.split('/')
      netaddr = struct.unpack('!L', socket.inet_aton(net))[0]
      netmask = (0xFFFFFFFF >> int(bits)) ^ 0xFFFFFFFF
      return ipaddr & netmask == netaddr 
```

这是一个函数，它返回一个带点的二进制字符串，以帮助可视化屏蔽..有点像`ipcalc`输出。

```
 def bb(i):
     def s = '{:032b}'.format(i)
     def return s[0:8]+"."+s[8:16]+"."+s[16:24]+"."+s[24:32] 
```

例如：

![蟒蛇的屏幕截图](https://i.stack.imgur.com/TU1Bm.png)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-04-29T17:41:51.267

我不喜欢在不需要时使用模块。这项工作只需要简单的数学运算，所以这是我完成这项工作的简单函数：

```
def ipToInt(ip):
    o = map(int, ip.split('.'))
    res = (16777216 * o[0]) + (65536 * o[1]) + (256 * o[2]) + o[3]
    return res

def isIpInSubnet(ip, ipNetwork, maskLength):
    ipInt = ipToInt(ip)#my test ip, in int form

    maskLengthFromRight = 32 - maskLength

    ipNetworkInt = ipToInt(ipNetwork) #convert the ip network into integer form
    binString = "{0:b}".format(ipNetworkInt) #convert that into into binary (string format)

    chopAmount = 0 #find out how much of that int I need to cut off
    for i in range(maskLengthFromRight):
        if i < len(binString):
            chopAmount += int(binString[len(binString)-1-i]) * 2**i

    minVal = ipNetworkInt-chopAmount
    maxVal = minVal+2**maskLengthFromRight -1

    return minVal <= ipInt and ipInt <= maxVal 
```

然后使用它：

```
>>> print isIpInSubnet('66.151.97.0', '66.151.97.192',24) 
True
>>> print isIpInSubnet('66.151.97.193', '66.151.97.192',29) 
True
>>> print isIpInSubnet('66.151.96.0', '66.151.97.192',24) 
False
>>> print isIpInSubnet('66.151.97.0', '66.151.97.192',29) 
```

就是这样，这比上面包含模块的解决方案要快得多。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-05-10T12:57:30.247

我尝试了 Dave Webb 的解决方案，但遇到了一些问题：

最基本的 - 应该通过将 IP 地址与掩码进行与运算来检查匹配，然后检查结果是否与网络地址完全匹配。不像之前那样将 IP 地址与网络地址进行与运算。

我还注意到，假设一致性将节省您的时间，而忽略 Endian 行为，只会适用于八位字节边界（/24、/16）上的掩码。为了让其他掩码（/23、/21）正常工作，我在结构命令中添加了一个“大于”，并将创建二进制掩码的代码更改为以全“1”开头并左移（32-mask ）。

最后，我添加了一个简单的检查网络地址是否对掩码有效，如果不是则打印一个警告。

结果如下：

```
def addressInNetwork(ip,net):
    "Is an address in a network"
    ipaddr = struct.unpack('>L',socket.inet_aton(ip))[0]
    netaddr,bits = net.split('/')
    netmask = struct.unpack('>L',socket.inet_aton(netaddr))[0]
    ipaddr_masked = ipaddr & (4294967295<<(32-int(bits)))   # Logical AND of IP address and mask will equal the network address if it matches
    if netmask == netmask & (4294967295<<(32-int(bits))):   # Validate network address is valid for mask
            return ipaddr_masked == netmask
    else:
            print "***WARNING*** Network",netaddr,"not valid with mask /"+bits
            return ipaddr_masked == netmask 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2013-09-25T21:42:39.273

不在 2.5 的标准库中，但 ipaddr 使这很容易。我相信它是在 3.3 中，名称为 ipaddress。

```
import ipaddr

a = ipaddr.IPAddress('192.168.0.1')
n = ipaddr.IPNetwork('192.168.0.0/24')

#This will return True
n.Contains(a) 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-03-29T03:13:52.373

Marc 的代码几乎是正确的。代码的完整版本是 -

```
def addressInNetwork3(ip,net):
    '''This function allows you to check if on IP belogs to a Network'''
    ipaddr = struct.unpack('=L',socket.inet_aton(ip))[0]
    netaddr,bits = net.split('/')
    netmask = struct.unpack('=L',socket.inet_aton(calcDottedNetmask(int(bits))))[0]
    network = struct.unpack('=L',socket.inet_aton(netaddr))[0] & netmask
    return (ipaddr & netmask) == (network & netmask)

def calcDottedNetmask(mask):
    bits = 0
    for i in xrange(32-mask,32):
        bits |= (1 << i)
    return "%d.%d.%d.%d" % ((bits & 0xff000000) >> 24, (bits & 0xff0000) >> 16, (bits & 0xff00) >> 8 , (bits & 0xff)) 
```

显然来自与上述相同的来源......

一个非常重要的注意事项是第一个代码有一个小故障 - IP 地址 255.255.255.255 也显示为任何子网的有效 IP。我花了很多时间让这段代码运行起来，感谢 Marc 的正确答案。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-11-06T06:32:22.233

依赖“struct”模块可能会导致字节序和类型大小出现问题，而这并不是必需的。socket.inet_aton() 也不是。Python 非常适用于点分四组 IP 地址：

```
def ip_to_u32(ip):
  return int(''.join('%02x' % int(d) for d in ip.split('.')), 16) 
```

我需要针对一整套允许的源网络对每个套接字 accept() 调用进行 IP 匹配，因此我将掩码和网络预先计算为整数：

```
SNS_SOURCES = [
  # US-EAST-1
  '207.171.167.101',
  '207.171.167.25',
  '207.171.167.26',
  '207.171.172.6',
  '54.239.98.0/24',
  '54.240.217.16/29',
  '54.240.217.8/29',
  '54.240.217.64/28',
  '54.240.217.80/29',
  '72.21.196.64/29',
  '72.21.198.64/29',
  '72.21.198.72',
  '72.21.217.0/24',
  ]

def build_masks():
  masks = [ ]
  for cidr in SNS_SOURCES:
    if '/' in cidr:
      netstr, bits = cidr.split('/')
      mask = (0xffffffff << (32 - int(bits))) & 0xffffffff
      net = ip_to_u32(netstr) & mask
    else:
      mask = 0xffffffff
      net = ip_to_u32(cidr)
    masks.append((mask, net))
  return masks 
```

然后我可以快速查看给定 IP 是否在这些网络之一中：

```
ip = ip_to_u32(ipstr)
for mask, net in cached_masks:
  if ip & mask == net:
    # matched!
    break
else:
  raise BadClientIP(ipstr) 
```

不需要模块导入，并且代码匹配速度*非常*快。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-04-22T21:11:31.283

选择的答案有一个错误。

以下是正确的代码：

```
def addressInNetwork(ip, net_n_bits):
   ipaddr = struct.unpack('<L', socket.inet_aton(ip))[0]
   net, bits = net_n_bits.split('/')
   netaddr = struct.unpack('<L', socket.inet_aton(net))[0]
   netmask = ((1L << int(bits)) - 1)
   return ipaddr & netmask == netaddr & netmask 
```

注意：`ipaddr & netmask == netaddr & netmask`而不是`ipaddr & netmask == netmask`.

我也替换`((2L<<int(bits)-1) - 1)`为`((1L << int(bits)) - 1)`，因为后者似乎更容易理解。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-09-06T17:33:34.023

# 从 netaddr 导入 all_matching_cidrs

```
>>> from netaddr import all_matching_cidrs
>>> all_matching_cidrs("212.11.70.34", ["192.168.0.0/24","212.11.64.0/19"] )
[IPNetwork('212.11.64.0/19')] 
```

这是此方法的用法：

```
>>> help(all_matching_cidrs)

Help on function all_matching_cidrs in module netaddr.ip:

all_matching_cidrs(ip, cidrs)
    Matches an IP address or subnet against a given sequence of IP addresses and subnets.

    @param ip: a single IP address or subnet.

    @param cidrs: a sequence of IP addresses and/or subnets.

    @return: all matching IPAddress and/or IPNetwork objects from the provided
    sequence, an empty list if there was no match. 
```

基本上，您提供一个 IP 地址作为第一个参数，并提供一个 cidr 列表作为第二个参数。返回命中列表。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-04-07T08:36:07.483

```
#这可以正常工作，没有奇怪的逐字节处理
def addressInNetwork(ip,net):
    '''是网络中的地址'''
    # 将地址转换为主机顺序，因此移位实际上是有意义的
    ip = struct.unpack('>L',socket.inet_aton(ip))[0]
    netaddr,bits = net.split('/')
    netaddr = struct.unpack('>L',socket.inet_aton(netaddr))[0]
    # 必须左移一个全为值，/32 = 零移，/0 = 32 左移
    网络掩码 = (0xffffffff << (32-int(位))) & 0xffffffff
    # 不需要屏蔽网络地址，只要是正确的网络地址
    返回（IP 和网络掩码）== netaddr

```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2013-08-01T23:34:27.677

这是我为最长前缀匹配编写的一个类：

```
#!/usr/bin/env python

class Node:
def __init__(self):
    self.left_child = None
    self.right_child = None
    self.data = "-"

def setData(self, data): self.data = data
def setLeft(self, pointer): self.left_child = pointer
def setRight(self, pointer): self.right_child = pointer
def getData(self): return self.data
def getLeft(self): return self.left_child
def getRight(self): return self.right_child

def __str__(self):
        return "LC: %s RC: %s data: %s" % (self.left_child, self.right_child, self.data)

class LPMTrie:      

def __init__(self):
    self.nodes = [Node()]
    self.curr_node_ind = 0

def addPrefix(self, prefix):
    self.curr_node_ind = 0
    prefix_bits = ''.join([bin(int(x)+256)[3:] for x in prefix.split('/')[0].split('.')])
    prefix_length = int(prefix.split('/')[1])
    for i in xrange(0, prefix_length):
        if (prefix_bits[i] == '1'):
            if (self.nodes[self.curr_node_ind].getRight()):
                self.curr_node_ind = self.nodes[self.curr_node_ind].getRight()
            else:
                tmp = Node()
                self.nodes[self.curr_node_ind].setRight(len(self.nodes))
                tmp.setData(self.nodes[self.curr_node_ind].getData());
                self.curr_node_ind = len(self.nodes)
                self.nodes.append(tmp)
        else:
            if (self.nodes[self.curr_node_ind].getLeft()):
                self.curr_node_ind = self.nodes[self.curr_node_ind].getLeft()
            else:
                tmp = Node()
                self.nodes[self.curr_node_ind].setLeft(len(self.nodes))
                tmp.setData(self.nodes[self.curr_node_ind].getData());
                self.curr_node_ind = len(self.nodes)
                self.nodes.append(tmp)

        if i == prefix_length - 1 :
            self.nodes[self.curr_node_ind].setData(prefix)

def searchPrefix(self, ip):
    self.curr_node_ind = 0
    ip_bits = ''.join([bin(int(x)+256)[3:] for x in ip.split('.')])
    for i in xrange(0, 32):
        if (ip_bits[i] == '1'):
            if (self.nodes[self.curr_node_ind].getRight()):
                self.curr_node_ind = self.nodes[self.curr_node_ind].getRight()
            else:
                return self.nodes[self.curr_node_ind].getData()
        else:
            if (self.nodes[self.curr_node_ind].getLeft()):
                self.curr_node_ind = self.nodes[self.curr_node_ind].getLeft()
            else:
                return self.nodes[self.curr_node_ind].getData()

    return None

def triePrint(self):
    n = 1
    for i in self.nodes:
        print n, ':'
        print i
        n += 1 
```

这是一个测试程序：

```
n=LPMTrie()
n.addPrefix('10.25.63.0/24')
n.addPrefix('10.25.63.0/16')
n.addPrefix('100.25.63.2/8')
n.addPrefix('100.25.0.3/16')
print n.searchPrefix('10.25.63.152')
print n.searchPrefix('100.25.63.200')
#10.25.63.0/24
#100.25.0.3/16 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2014-02-03T12:43:04.343

**以前的解决方案在 ip & net == net 中有一个错误。正确的 ip 查找是 ip & netmask = net**

错误修正的代码：

```
import socket
import struct

def makeMask(n):
    "return a mask of n bits as a long integer"
    return (2L<<n-1) - 1

def dottedQuadToNum(ip):
    "convert decimal dotted quad string to long integer"
    return struct.unpack('L',socket.inet_aton(ip))[0]

def addressInNetwork(ip,net,netmask):
   "Is an address in a network"
   print "IP "+str(ip) + " NET "+str(net) + " MASK "+str(netmask)+" AND "+str(ip & netmask)
   return ip & netmask == net

def humannetcheck(ip,net):
        address=dottedQuadToNum(ip)
        netaddr=dottedQuadToNum(net.split("/")[0])
        netmask=makeMask(long(net.split("/")[1]))
        return addressInNetwork(address,netaddr,netmask)

print humannetcheck("192.168.0.1","192.168.0.0/24");
print humannetcheck("192.169.0.1","192.168.0.0/24"); 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-03-18T20:56:29.250

[从 Python 3.7 开始](https://docs.python.org/3/whatsnew/3.7.html#ipaddress)，您可以使用[`subnet_of`](https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv4Network.subnet_of)和[`supernet_of`](https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv4Network.supernet_of)辅助方法，它们是标准库的一部分：

要仅针对单个 IP 进行测试，您可以使用`/32`表示“仅此 IP 地址”的子网掩码作为子网，或者您可以将 IP 地址传递给`IPv4Nework`构造`IPv6Nework`函数，它们将为您返回子网值。

所以对于你的例子：

```
from ipaddress import IPv4Network, IPv4Address

# Store IP Address as variable
>>> myip = IPv4Address('192.168.0.1')
>>> myip
IPv4Address('192.168.0.1')

# This treats the IP as a subnet
>>> myip_subnet = IPv4Network(myip)
>>> myip_subnet
IPv4Network('192.168.0.1/32')

# The other subnet to test membership against
>>> other_subnet = IPv4Network('192.168.0.0/24')
>>> other_subnet
IPv4Network('192.168.0.0/24')

# Now we can test
>>> myip_subnet.subnet_of(other_subnet)
True 
```

> Python中有用于IP地址操作的通用工具吗？诸如主机查找，int 的 ip 地址，带有网络掩码的网络地址到 int 等的东西？希望在 2.5 的标准 Python 库中。

在 Python 3 中，有[`ipaddress`](https://docs.python.org/3/library/ipaddress.html)一个具有 IPv4 和 IPv6 操作工具的模块。您可以通过强制转换将它们转换为 int，即`int(IPv4Address('192.168.0.1'))`. `ipaddress`主机模块中的许多其他有用功能等。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-05-04T09:03:32.917

我不知道标准库中的任何内容，但[PySubnetTree](https://github.com/bro/pysubnettree)是一个 Python 库，可以进行子网匹配。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-07-06T17:10:58.627

谢谢你的剧本！
我已经做了很长时间的工作以使一切正常......所以我在这里分享它

*   使用 netaddr 类比使用二进制转换慢 10 倍，所以如果你想在一个大的 IP 列表上使用它，你应该考虑不使用 netaddr 类
*   makeMask 功能不起作用！仅适用于 /8,/16,/24
    例如：

    > 位=“21”；socket.inet_ntoa(struct.pack('=L',(2L << int(bits)-1) - 1))
    > '255.255.31.0' 而它应该是 255.255.248.0

    所以我使用了来自 [http://code.activestate.com/recipes/576483-convert-subnetmask-from-cidr-notation-to-dotdecima/](http://code.activestate.com/recipes/576483-convert-subnetmask-from-cidr-notation-to-dotdecima/)
    的另一个函数 calcDottedNetmask(mask) 例如：

```
 #!/usr/bin/python
>>> calcDottedNetmask(21)
>>> '255.255.248.0' 
```

*   另一个问题是IP是否属于网络的匹配过程！基本操作应该是比较 (ipaddr & netmask) 和 (network & netmask)。
    例如：暂时，功能错误

```
 #!/usr/bin/python
>>> addressInNetwork('188.104.8.64','172.16.0.0/12')
>>>True which is completely WRONG!! 
```

所以我的新 addressInNetwork 函数看起来像：

```
 #!/usr/bin/python
import socket,struct
def addressInNetwork(ip,net):
    '''This function allows you to check if on IP belogs to a Network'''
    ipaddr = struct.unpack('=L',socket.inet_aton(ip))[0]
    netaddr,bits = net.split('/')
    netmask = struct.unpack('=L',socket.inet_aton(calcDottedNetmask(bits)))[0]
    network = struct.unpack('=L',socket.inet_aton(netaddr))[0] & netmask
    return (ipaddr & netmask) == (network & netmask)

def calcDottedNetmask(mask):
    bits = 0
    for i in xrange(32-int(mask),32):
        bits |= (1 > 24, (bits & 0xff0000) >> 16, (bits & 0xff00) >> 8 , (bits & 0xff)) 
```

而现在，答案是对的！！

```
 #!/usr/bin/python
>>> addressInNetwork('188.104.8.64','172.16.0.0/12')
False 
```

我希望它会帮助其他人，为他们节省时间！

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-01-11T14:39:56.720

关于上述所有内容，我认为 socket.inet_aton() 按网络顺序返回字节，因此解压它们的正确方法可能是

```
struct.unpack('!L', ... ) 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2016-02-17T14:50:57.560

```
import socket,struct
def addressInNetwork(ip,net):
    "Is an address in a network"
    ipaddr = struct.unpack('!L',socket.inet_aton(ip))[0]
    netaddr,bits = net.split('/')
    netaddr = struct.unpack('!L',socket.inet_aton(netaddr))[0]
    netmask = ((1<<(32-int(bits))) - 1)^0xffffffff
    return ipaddr & netmask == netaddr & netmask
print addressInNetwork('10.10.10.110','10.10.10.128/25')
print addressInNetwork('10.10.10.110','10.10.10.0/25')
print addressInNetwork('10.10.10.110','10.20.10.128/25') 
```

$ python check-subnet.py
假
真
假

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-08-20T20:35:25.637

从上面的各种来源以及我自己的研究来看，这就是我如何让子网和地址计算工作的方式。这些作品足以解决问题和其他相关问题。

```
class iptools:
    @staticmethod
    def dottedQuadToNum(ip):
        "convert decimal dotted quad string to long integer"
        return struct.unpack('>L', socket.inet_aton(ip))[0]

    @staticmethod
    def numToDottedQuad(n):
        "convert long int to dotted quad string"
        return socket.inet_ntoa(struct.pack('>L', n))

    @staticmethod
    def makeNetmask(mask):
        bits = 0
        for i in xrange(32-int(mask), 32):
            bits |= (1 << i)
        return bits

    @staticmethod
    def ipToNetAndHost(ip, maskbits):
        "returns tuple (network, host) dotted-quad addresses given"
        " IP and mask size"
        # (by Greg Jorgensen)
        n = iptools.dottedQuadToNum(ip)
        m = iptools.makeMask(maskbits)
        net = n & m
        host = n - mask
        return iptools.numToDottedQuad(net), iptools.numToDottedQuad(host) 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-10-21T16:14:38.390

在 python 中有一个称为 SubnetTree 的 API 可以很好地完成这项工作。这是一个简单的例子：

```
import SubnetTree
t = SubnetTree.SubnetTree()
t.insert("10.0.1.3/32")
print("10.0.1.3" in t) 
```

[这是链接](https://www.bro.org/sphinx/components/pysubnettree/README.html)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-04-17T07:44:27.520

这是我的代码

```
# -*- coding: utf-8 -*-
import socket

class SubnetTest(object):
    def __init__(self, network):
        self.network, self.netmask = network.split('/')
        self._network_int = int(socket.inet_aton(self.network).encode('hex'), 16)
        self._mask = ((1L << int(self.netmask)) - 1) << (32 - int(self.netmask))
        self._net_prefix = self._network_int & self._mask

    def match(self, ip):
        '''
        判断传入的 IP 是不是本 Network 内的 IP
        '''
        ip_int = int(socket.inet_aton(ip).encode('hex'), 16)
        return (ip_int & self._mask) == self._net_prefix

st = SubnetTest('100.98.21.0/24')
print st.match('100.98.23.32') 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-10-10T08:45:16.273

如果您不想导入其他模块，可以使用：

```
def ip_matches_network(self, network, ip):
    """
    '{:08b}'.format(254): Converts 254 in a string of its binary representation

    ip_bits[:net_mask] == net_ip_bits[:net_mask]: compare the ip bit streams

    :param network: string like '192.168.33.0/24'
    :param ip: string like '192.168.33.1'
    :return: if ip matches network
    """
    net_ip, net_mask = network.split('/')
    net_mask = int(net_mask)
    ip_bits = ''.join('{:08b}'.format(int(x)) for x in ip.split('.'))
    net_ip_bits = ''.join('{:08b}'.format(int(x)) for x in net_ip.split('.'))
    # example: net_mask=24 -> compare strings at position 0 to 23
    return ip_bits[:net_mask] == net_ip_bits[:net_mask] 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-07-19T19:32:34.370

我在这些答案中尝试了提议的解决方案的一个子集。没有成功，我最终调整并修复了提议的代码并编写了我的固定函数。

我对其进行了测试，并且至少可以在小端架构上工作——egx86——如果有人喜欢尝试大端架构，请给我反馈。

`IP2Int`代码来自[这篇文章](https://stackoverflow.com/a/16446104/1052899)，另一种方法是完全（对于我的测试用例）对这个问题中先前提案的工作修复。

编码：

```
def IP2Int(ip):
    o = map(int, ip.split('.'))
    res = (16777216 * o[0]) + (65536 * o[1]) + (256 * o[2]) + o[3]
    return res

def addressInNetwork(ip, net_n_bits):
    ipaddr = IP2Int(ip)
    net, bits = net_n_bits.split('/')
    netaddr = IP2Int(net)
    bits_num = int(bits)
    netmask = ((1L << bits_num) - 1) << (32 - bits_num)
    return ipaddr & netmask == netaddr & netmask 
```

希望有用，

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-02-10T10:41:57.823

这是使用 netaddr 包的解决方案

```
from netaddr import IPNetwork, IPAddress

def network_has_ip(network, ip):

    if not isinstance(network, IPNetwork):
        raise Exception("network parameter must be {0} instance".format(IPNetwork.__name__))

    if not isinstance(ip, IPAddress):
        raise Exception("ip parameter must be {0} instance".format(IPAddress.__name__))

    return (network.cidr.ip.value & network.netmask.value) == (ip.value & network.netmask.value) 
```

# apache-flex - flex 应用程序中的自动更新

> ID：819361
> 
> 赞同：2
> 
> 时间：2009-05-04T09:00:23.253
> 
> 标签：apache-flex, actionscript-3, air

我正在使用更新程序框架在我的 flex 应用程序中使用自动更新。我得到了这篇文章并遵循了相同的步骤。

[http://blog.multimediacollege.be/2008/12/using-the-air-15-updater-framework-in-flex/#](http://blog.multimediacollege.be/2008/12/using-the-air-15-updater-framework-in-flex/#)

但我收到一个错误，无法理解原因：

> 1046：类型未找到或不是编译时常量：UpdateEvent。

```
import flash.events.ErrorEvent;
import air.update.ApplicationUpdaterUI;
import air.update.events.UpdateEvent; 
import mx.controls.Alert;

private var appUpdater:ApplicationUpdaterUI = new ApplicationUpdaterUI();

private function checkForUpdates():void {
    appUpdater.configurationFile = new File("app:/updateConfig.xml");
    appUpdater.isCheckForUpdateVisible = false;
    appUpdater.addEventListener(UpdateEvent.INITIALIZED,updaterInitialised);
    appUpdater.initialize();
}

private function updaterInitialised(event:UpdateEvent):void {
    appUpdater.checkNow();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:12:50.570

我没有使用过这个特定的功能，但是由于您在编译时缺少 UpdateEvent 类，我怀疑您没有为 Air 1.5 进行编译。

如果您从 Adob ​​e 获得[最新版本的 SDK ，这应该可以解决。](http://www.adobe.com/products/flex/flexdownloads/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T20:25:23.580

您在对葡萄柚的评论中说您有 flex 3.0 SDK；下载最新的 flex 3.3 sdk，解压并告诉 flex 你把 sdk 放在哪里。我个人使用 flash 开发，我所做的只是将 ApplicationUpdater_ui.swc 添加到项目中，并且包变得可用。

*   swc 文件位于 flex _sdk _3/frameworks/lib/air/ 中。一旦 swc 成为您的库的一部分，您将拥有 UpdateEvent 以及可用的框架的其余部分。

flex 框架带有创建 AIR 应用程序的所有必要元素，包括更新框架。

# asp.net - Asp.Net GridView Pager colspan？

> ID：819368
> 
> 赞同：1
> 
> 时间：2009-05-04T09:01:36.480
> 
> 标签：asp.net, xhtml

我有一个带有一些数据的 GridView 和一个寻呼机，这样我就不必在一页上显示所有数据。

但是如果我查看 HTML GridView 生成的寻呼机列的 colspan 为 66？这会弄乱 Chrome 和 Safari 中的布局。

为什么当只有 5 个 cols 有数据时，它会将 colspan 设置为 66？

编辑：我发现了问题！我隐藏了一些列和那些被计算的列，这就是为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:41:07.070

请记住，您始终可以使用[CSS Friendly Control Adapters](http://www.asp.net/CssAdapters/)将标记呈现为纯 CSS 。

在这里您可以看到[GridView 的示例](http://www.asp.net/CSSAdapters/GridView.aspx)

# java - Tomcat 更新事件

> ID：819374
> 
> 赞同：0
> 
> 时间：2009-05-04T09:04:34.083
> 
> 标签：java, web-services, swing, tomcat

我正在开发一个使用 tomcat 作为 Web 服务器和 java swing 应用程序的应用程序。作为唯一的客户端通过 web 服务与 web 服务器通信。

我陷入了一种情况，我需要服务器以某种方式通知客户端发生在服务器端的某种更新事件。像反向ajax或类似的东西。

有任何想法吗...

阿卜杜勒哈利克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T09:40:12.237

最常见的方法是您的客户端轮询服务器。这意味着定期向服务器发出请求以请求新事件。这将在事件的出现和向客户端的通知之间引入延迟。

另一种方法是从客户端发出 HTTP 请求并保持打开状态，直到出现事件。这样，通知会在事件发生后立即到达。报告事件时，您发出另一个请求。这种方法的缺点是它极大地限制了服务器可以随时服务的客户端数量。Tomcat 的默认线程数是 150。对于每个 http 请求，您需要一个线程，因此您不能有超过 150 个打开的请求。

# asp.net - 使用 jquery 验证动态控件

> ID：819376
> 
> 赞同：0
> 
> 时间：2009-05-04T09:04:58.607
> 
> 标签：asp.net, jquery, validation

如何验证在运行时使用 jQuery 生成的动态文本框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T10:10:41.790

```
<%    
        TextBox tb = new TextBox();
        tb.Attributes.Add("data-validateme","true");
        Page.Controls.Add(tb);
%> 
```

这将添加一个 HTML5 数据属性。

```
<input type="text" data-validateme="true" /> 
```

jQuery：

```
$(document).ready(function(){
   $("*[data-validateme]").change(function(){
      alert($(this).val());
   });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:59:35.980

我不确定，但你可以使用这样的东西：

```
$(function() {
$('input').each(function() {
    $('#' + this.id).live('onchange', function() {  
        // VALIDATION Code
    });
}); 
```

# asp.net-2.0 - 语法错误信息

> ID：819377
> 
> 赞同：1
> 
> 时间：2009-05-04T09:05:13.990
> 
> 标签：asp.net-2.0, syntax-error

我这两周过得很糟糕。我接触的一切似乎都破碎了。好吧，无论如何...我在 Visual Studio 2008 中有一个 Web 应用程序，它已经开始表现得很糟糕了。我收到一条错误消息，上面写着语法错误（仅此而已）。它“指向”我的文件 Forms.aspx 中的第一行。该行说

```
<%@ Page Language="C#" MasterPageFile="MasterPageLogin.master" AutoEventWireup="true" CodeFile="Forms.aspx.cs" Inherits="artlgn_Form" Title="Untiled Page" %> 
```

我在不同的文件夹中有一个同名的文件，但以前没有问题。

两个文件中的类命名空间不同。

我想我错过了一些显而易见的东西。

提前致谢！

/弗雷德里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:23:23.727

要检查的一件事是关闭 Visual Studio 和 IIS。转到 ASP.NET 临时文件夹，可能是：

> C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET 文件

现在删除该目录中的所有文件夹和文件。重新启动 IIS 和 Visual Studio 并尝试重新构建并运行您的项目。当您遇到此类奇怪的构建错误时，这只是要检查的一件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:08:55.400

您可以通过在浏览器中启用调试器来获取有关错误的更多信息。启用调试器后，一旦出现错误，它会询问您是否要调试错误，按“是”，它应该带您到故障行。

# iphone - 将 CALayer 添加为子图层，然后进行动画处理

> ID：819381
> 
> 赞同：1
> 
> 时间：2009-05-04T09:07:26.510
> 
> 标签：iphone, cocoa-touch

这就是我想要做的：将 CALayer 作为子层添加到另一个层，然后立即对其进行动画处理。该层被添加到当前视图之外的位置，并且应该“飞”到视图中。这一切都发生在 UIViewController 中。

这是我的代码的基本外观：

```
mysublayer.position = CGPointMake(-160.0, -250.0);
[self.view.layer addSublayer:mysublayer];   

[CATransaction begin]; // outer transaction
[CATransaction setValue:[NSNumber numberWithFloat:2.0f]
                 forKey:kCATransactionAnimationDuration];

mysublayer.position = CGPointMake(160.0, 250.0);
mysublayer.opacity = 1.0;

[CATransaction commit]; 
```

发生的情况是，子图层立即出现在新位置 (160,250)，没有动画。我认为我在做一些根本性的错误，在我尝试为图层设置动画的那一刻，它并没有真正添加到父图层，对吗？

那么，总结一下，如何在将新子图层添加到父图层后为其设置动画？

谢谢和亲切的问候，汉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T09:19:17.963

您应该使用 [CABasicAnimation animationWithKeyPath:@"position"]

# python - 使用 Python 2/3 解析 ANSI 和 UTF-16LE 文件的最佳方法？

> ID：819396
> 
> 赞同：0
> 
> 时间：2009-05-04T09:12:42.473
> 
> 标签：python, encoding, ansi, utf-16

我有一组以 ANSI 或 UTF-16LE 编码的文件。我希望 python 使用正确的编码打开文件。问题是 ANSI 文件在使用 UTF-16le 编码时不会引发任何异常，反之亦然。

有没有一种直接的方法可以使用正确的文件编码打开文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T09:26:14.063

使用[chardet](http://chardet.feedparser.org/)库来检测编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:27:06.463

您可以检查文件开头的[BOM以检查它是否为 UTF。](http://en.wikipedia.org/wiki/Byte-order_mark "物料清单")

然后[unicode.decode](http://docs.python.org/library/stdtypes.html#str.decode)相应地（使用[标准编码](http://docs.python.org/library/codecs.html#standard-encodings)之一）。

**编辑** 或者，也许，尝试 s.decode('ascii') 你的字符串（给定 s 是变量名）。如果它抛出 UnicodeDecodeError，则将其解码为“utf_16_le”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T12:09:00.827

# web-applications - 学习Web编程的好开源代码

> ID：819400
> 
> 赞同：5
> 
> 时间：2009-05-04T09:13:45.123
> 
> 标签：web-applications, open-source

嗨，有人可以指点我一些好的开源代码来学习 Web 编程（语言无关紧要）。

我正在寻找 Web 应用程序而不是框架的源代码

我不是初学者，我可以在某种程度上编码。我想知道在现实世界的应用程序中是如何完成的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T09:19:13.113

嗯，这个问题有点模糊。您是在寻找开源 Web 框架，还是在 Web 框架中编写的开源代码？但请尝试查看[Tomcat](http://tomcat.apache.org/)、[Django](http://www.djangoproject.com/)、[ASP.net MVC](http://www.asp.net/mvc/)、[MediaWiki](http://mediawiki.org)、[Drupal](http://en.wikipedia.org/wiki/Drupal)和[Wordpress](http://en.wikipedia.org/wiki/Wordpress)等等。

还有几个应用程序（现在已经澄清了）是[Gitweb](http://git.or.cz/gitwiki/Gitweb)和[Meldware](http://www.buni.org/mediawiki/index.php/Meldware_Communications_Suite)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T10:17:22.850

通过阅读开源应用程序的源代码来学习*似乎*总是一个好主意，但每次尝试都是徒劳的。我认为这是因为存在三种通用类型的开源应用程序，并且没有一个是为了学习而阅读的：

1.  **小项目。** 小，我的意思是“几乎不是一个项目”小。出于某种原因，这些从未通过概念验证阶段。要么这些想法不够有趣，要么更糟糕的是，程序员还不够优秀，无法将其转化为准备好迎接黄金时段的应用程序。通常，这些程序员的能力并没有明显高于你目前的水平，所以这些不值得你花时间研究。
2.  **中小型项目**。这些项目足够大，足够有趣和复杂，但公开可用的技术文档严重缺乏，你永远不会对他们的架构做出正面或反面。您可以向贡献者发送电子邮件，但他们可能太忙于将时间分配在高水平的带薪日常工作和将所有个人时间投入到这个宠物项目中。继续...
3.  **大时代的项目。** 例如 Firefox、Eclipse 等。这类软件都有详细的文档记录，但这并不重要，因为阅读和理解这一切所需的时间令人望而却步。除非您正在从事该项目（并希望为此获得报酬！），否则您必须发疯才能让自己度过难关。

我不是要劝你，这只是我个人的经历。如果你想成为一个更好的程序员，专注于找工作。我工作第一年的学习速度比我自己做的任何工作都要快几个数量级。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T10:33:55.897

如果我理解正确，您想研究流行的开源 Web 应用程序的代码，以了解“真实世界、实时、流行”应用程序的编码方式。

如果是这样，我推荐以下流行的开源应用程序：

*   [Wordpress](http://wordpress.org) - 用 PHP 编码，这个应用程序是一个非常流行的博客管理系统

*   [文本模式](http://textpattern.com)- 使用 PHP 编码，此应用程序类似于 wordpress，但稍微高级一些。

*   [CGI 模块](http://search.cpan.org/~lds/CGI.pm-3.43/CGI.pm)- 用 Perl 编码，这个 perl 模块用于大多数基于 perl 的 Web 应用程序。了解此模块的代码将使您对互联网的一部分工作方式有深刻的了解。

*   [SQLAlchemy](http://sqlalchemy.org) - 用 Python 编码，是 Python 社区中一个流行的应用程序，用于与数据库接口/交互。

如果您在尝试理解上述任何一种语言的工作原理之前就熟悉其中一种语言会更容易。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T09:27:07.087

我建议首先选择一种语言或平台。例如 grails 上的 groovy。然后上教程。每个平台都有一个“宠物店示例”或类似的东西，您可以在其中开始和关注。

如果语言无关紧要，请尝试用 perl 编写的 Mhonarc。

路易斯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T16:51:16.163

如果您对 Python 感兴趣，可以查看[Reddit](http://reddit.com/code/)或[Django 源代码](http://code.djangoproject.com/)。我知道 Django 是一个 Web 框架，但代码确实做得很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T09:25:34.767

我见过的最先进的 PHP 框架，带有漂亮的代码：[FLOW3](http://flow3.typo3.org/) 但我的回答只有在你正在寻找严肃的框架作为代码示例并且已经知道基础知识时才有意义......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T09:36:52.883

您可以查看[http://www.asp.net](http://www.asp.net)和[http://www.asp.net/community/projects/](http://www.asp.net/community/projects/)以获取大型开源 Web 项目
[http://www.codeproject.com/](http://www.codeproject.com/)以获取较小的示例
和[http:// /code.google.com/opensource/](http://code.google.com/opensource/)非常大的列表
还有[http://www.codeplex.com/](http://www.codeplex.com/) , [http://sourceforge.net](http://sourceforge.net)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T13:00:56.997

我建议你看看[Pier](http://www.piercms.com/)它是一个用 Seaside 编写的内容管理系统。它的结构比我在这里看到的任何其他建议都要好。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-05-04T09:17:17.580

如果您想向 abc 学习，那么 w3schools.com 是一个更好的选择。

在那里你可以找到很多像 asp、asp.net、HTML 等的部分。你也会有很多例子。

# iphone - 将图片添加到 UITabBar

> ID：819401
> 
> 赞同：0
> 
> 时间：2009-05-04T09:14:13.063
> 
> 标签：iphone, cocoa-touch

我在界面构建器中将视图控制器添加到了我的 UITabBarController 中。如何以编程方式添加图片和更改项目标题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T14:32:47.930

您可以在 appDelegate.m 文件中的 'applicationDidFinishLaunching:' 函数中添加它们。

例如 ：

```
NSInteger index = 0;
while(index < 4){ // 4 is the number of tabbar items
    UINavigationController *navCtrlr = (UINavigationController*)[[tabBarController viewControllers] objectAtIndex:index];
    UITabBarItem *tabBar = (UITabBarItem *) navCtrlr.tabBarItem;
    if(index == 0){
        tabBar.image = [UIImage imageNamed:@"home-item.png"];
        tabBar.title = @"home";
    }
    ...
    index ++;
} 
```

# c# - 在列表视图的分隔行中添加项目

> ID：819402
> 
> 赞同：6
> 
> 时间：2009-05-04T09:15:13.747
> 
> 标签：c#, winforms, listview

当我将列表视图添加到我的表单并在表单加载事件中我写在下面的代码中时，在同一行中添加的项目而不是在单独的行中，我如何将它们添加到单独的行中

```
 listView1.MultiSelect = true;
            listView1.CheckBoxes = true;
            listView1.Items.Add("Item 1");
            listView1.Items.Add("Item 22");
            listView1.Items.Add("Item 333"); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-04T20:34:52.507

试试这个

```
listView1.View = View.List; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T09:20:08.213

对此进行尝试，我建议这是因为您的 ListView 默认为小图标或图块。尝试在任何地方添加此行：

```
listView1.View = View.Details; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T09:21:45.947

你确定吗 ？
通常，使用此代码，您应该添加了 3 个项目，当 ListView 的 View 属性设置为时，您应该看到 3 行`Details`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-28T15:47:35.443

你可以试试 `listView1.View = View.Tile;` 还有一个垂直滚动条。

# java - 运行时不调用打印方法，调试时调用

> ID：819404
> 
> 赞同：0
> 
> 时间：2009-05-04T09:16:31.637
> 
> 标签：java, algorithm, debugging

我用四种方法创建了一个类。我在其中插入了打印语句，因此我可以查看它们是否正常工作。前三个没有问题。但是当我调用第四种方法时，什么都没有打印出来。奇怪的是，当我启动调试器并逐步通过该方法时，会调用语句（并打印输出）。怎么会这样？

提前致谢。

有问题的方法：

```
 public void robin(int counter, int quant, int penalty) {

   if(Schedulers.quant==-1) {
      Schedulers.quant=quant;
   }

   while(p!=null && p.getArrival()==counter) {
       qrobin.add(p);

       if(i.hasNext())
           p=i.next();
       else {
           p=null;
           break;
       }
    }

   if(active!=null) {
       if(active.getLeftOver()>0 && Schedulers.quant>0) {
           active.decreaseLeftOver();
           Schedulers.quant--;
           System.out.print(active.getPID());
       }
       else if(active.getLeftOver()>0 && Schedulers.quant==0) {
           qrobin.add(active);
           active=qrobin.poll();

           Schedulers.quant=quant;
           Schedulers.quant--;

           if(active!=null) {
               System.out.print(active.getPID());
               active.decreaseLeftOver();
           }
           else
               System.out.print(" ");

       }
       else {
           active=qrobin.poll();

           Schedulers.quant=quant;
           Schedulers.quant--;

           if(active!=null) {
               System.out.print(active.getPID());
               active.decreaseLeftOver();
           }
           else
               System.out.print(" ");

       }
   }
   else {
       active=qrobin.poll();

       Schedulers.quant=quant;
       Schedulers.quant--;

       if(active!=null) {
          System.out.print(active.getPID());
          active.decreaseLeftOver(); 
       }
       else
           System.out.print(" ");
   } 
```

}

调用它的代码：

```
while(true){

        algorithm(algorithm,s,counter);

        counter++;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:56:58.793

看起来没有明显的答案，如果没有项目的其余部分，我们就无法重现和分析问题。

解决这种无法解释的行为的方法是尽可能减少代码，同时保留所说的行为，即把所有看起来不相关的代码都去掉，看看问题是否仍然存在；如果不是，则添加一些代码，等等。最终，您应该能够查明导致问题的更改并从中推断出实际发生的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:19:39.557

发生这种情况的原因有很多。但是，如果没有进一步的信息，几乎不可能为您提供帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T09:27:02.953

如果没有看到该类的其余部分，也许还没有看到它使用的其他一些类，我不能说任何确定的东西，但它看起来可能是一种竞争条件，即多个线程以不可预测的方式相互干扰。尤其是多次使用`Schedulers.quant`，显然是一个不同步的静态变量，看起来非常可疑。

如果确实是竞态条件，你需要阅读[这本书](http://www.javaconcurrencyinpractice.com/)，然后回来修复你的代码；多线程问题可能非常复杂，在编写多线程代码之前，您确实需要了解理论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T13:01:12.067

当你“运行”代码时，你是怎么做的？它是否在标准输出可能被重定向的某种服务器或容器中“运行”？这是我会怀疑的。

`System.out`像这样用于调试和故障排除可能会很麻烦，并且（通常）是一种非常糟糕的做法 - 最好使用日志框架，例如[log4j](http://logging.apache.org/log4j)。这样您就不必猜测日志输出的发送位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T13:10:26.817

好吧，如果您的活动变量一直为空，您只会打印“”，因此您可能不会在控制台输出中注意到它。当您在调试中运行时，这可能是一个时序问题，导致 active 不为空。

# php - XMLReader 编码错误

> ID：819414
> 
> 赞同：1
> 
> 时间：2009-05-04T09:19:52.970
> 
> 标签：php, encoding, xmlreader

我有一个 PHP 脚本试图解析一个巨大的 XML 文件。为此，我使用 XMLReader 库。在解析过程中，我有这个编码错误：

输入不是正确的UTF-8，表示编码！字节：0xA0 0x32 0x36 0x30

我想知道它们是否是一种跳过带有坏字符的记录的方法。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T11:29:15.610

首先，确保您的 XML 文件确实是 UTF-8 编码的。如果不指定编码作为[`XMLReader::open()`](http://php.net/manual/en/xmlreader.open.php).

如果编码错误是由于 UTF-8 文档中的真正格式错误的字节序列引起的，并且如果您使用的是 PHP > 5.2.0，您可以将`LIBXML_NOERROR`和/或（取决于错误级别）`LIBXML_NOWARNING`作为位掩码传递给 的第三个参数[`XMLReader::open()`](http://php.net/manual/en/xmlreader.open.php)：

```
$xml = new XMLReader(); 
$xml->open('myxml.xml', null, LIBXML_NOERROR | LIBXML_NOWARNING); 
```

如果您使用的是 PHP > 5.1.0，您可以调整[`libXML`](http://php.net/manual/en/book.libxml.php)错误处理。

```
// enable user error handling
libxml_use_internal_errors(true);
/* ... do your XML processing ... */
$errors = libxml_get_errors();
foreach ($errors as $error) {
    // handle errors here
}
libxml_clear_errors(); 
```

我实际上不知道前面的两个解决方法是否真的允许`XMLReader`在发生错误时继续阅读，或者它们是否只抑制错误输出。但值得一试。

* * *

**回复评论：**

`libXML`定义[`XML_PARSE_RECOVER`](http://www.xmlsoft.org/html/libxml-parser.html#xmlParserOption)(1) 但 ext/libxml 不将此常量公开为 PHP 常量。也许可以将整数值传递`1`给`$options`参数。

```
$xml = new XMLReader(); 
$xml->open('myxml.xml', null, LIBXML_NOERROR | LIBXML_NOWARNING | 1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T12:11:39.533

我会听听 XMLReader 告诉你什么。请记住，许多编码是 ASCII 的超集，因此（例如）UTF-8 和 ISO-8859-1 与前 128 个代码点的 ASCII 相同。很可能您的文件确实编码为 ISO-8859-1，但其中几乎所有字符都来自该字符集的较低 ASCII 一半。在这种情况下，错误将是你让它使用 XML 的默认编码 UTF-8。

在 ISO-8859-1 中，字节序列`0xA0 0x32 0x36 0x30`是完全有效的：一个不间断的空格，后跟“2”、“6”、“0”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-08T09:08:36.770

```
$xml = file_get_contents('myxml.xml');
$xml = preg_replace('/[\x0-\x1f\x7f-\x9f]/u', ' ', $xml);
//解析下面的$xml

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T11:35:12.130

如果您的 XML 文件具有非常简单的结构，您可以“预过滤”它以消除（甚至更好地纠正）错误的记录。

逐条读取并写出过滤后的xml文件，然后处理过滤后的文件。

# javascript - 调整 iframe 的宽度和高度以适应其中的内容

> ID：819416
> 
> 赞同：373
> 
> 时间：2009-05-04T09:20:18.133
> 
> 标签：javascript, html, iframe, adjustment

我需要一个解决方案来**自动调整**and`width`以`height`勉强`iframe`适应它的内容。`iframe`关键是加载后可以更改宽度和高度。我想我需要一个事件操作来处理 iframe 中包含的主体尺寸的变化。

* * *

## 回答 #1

> 赞同：298
> 
> 时间：2009-05-04T09:33:39.443

```
<script type="application/javascript">

function resizeIFrameToFitContent( iFrame ) {

    iFrame.width  = iFrame.contentWindow.document.body.scrollWidth;
    iFrame.height = iFrame.contentWindow.document.body.scrollHeight;
}

window.addEventListener('DOMContentLoaded', function(e) {

    var iFrame = document.getElementById( 'iFrame1' );
    resizeIFrameToFitContent( iFrame );

    // or, to resize all iframes:
    var iframes = document.querySelectorAll("iframe");
    for( var i = 0; i < iframes.length; i++) {
        resizeIFrameToFitContent( iframes[i] );
    }
} );

</script>

<iframe src="usagelogs/default.aspx" id="iFrame1"></iframe> 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2015-07-20T09:38:18.727

嵌入的单线解决方案：从最小尺寸开始并增加内容尺寸。不需要脚本标签。

```
<iframe src="http://URL_HERE.html" onload='javascript:(function(o){o.style.height=o.contentWindow.document.body.scrollHeight+"px";}(this));' style="height:200px;width:100%;border:none;overflow:hidden;"></iframe>
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2010-10-04T09:09:33.507

跨浏览器[jQuery 插件](https://github.com/house9/jquery-iframe-auto-height)。

Cross-bowser、跨域**[库](https://github.com/davidjbradshaw/iframe-resizer)**，用于`mutationObserver`保持 iFrame 大小适合内容并`postMessage`在 iFrame 和主机页面之间进行通信。使用或不使用 jQuery。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2012-06-15T10:05:33.137

到目前为止给出的所有解决方案都只考虑一次调整大小。您提到您希望能够在修改内容后调整 iFrame 的大小。为此，您需要在 iFrame 内执行一个函数（一旦内容发生更改，您需要触发一个事件来说明内容已更改）。

我被这个问题困扰了一段时间，因为 iFrame 内的代码似乎仅限于 iFrame 内的 DOM（并且无法编辑 iFrame），并且在 iFrame 外执行的代码被 iFrame 外的 DOM 卡住（并且不能t 拾取来自 iFrame 内部的事件）。

解决方案来自发现（通过同事的帮助）可以告诉 jQuery 使用什么 DOM。在这种情况下，是父窗口的 DOM。

因此，这样的代码可以满足您的需要（在 iFrame 中运行时）：

```
<script type="text/javascript">
    jQuery(document).ready(function () {
        jQuery("#IDofControlFiringResizeEvent").click(function () {
            var frame = $('#IDofiframeInMainWindow', window.parent.document);
            var height = jQuery("#IDofContainerInsideiFrame").height();
            frame.height(height + 15);
        });
    });
</script> 
```

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2012-08-01T15:17:59.777

如果 iframe 内容来自同一个域，这应该很好用。它确实需要 jQuery。

```
$('#iframe_id').load(function () {
    $(this).height($(this).contents().height());
    $(this).width($(this).contents().width());
}); 
```

要让它动态调整大小，你可以这样做：

```
<script language="javaScript">
<!--
function autoResize(){
    $('#themeframe').height($('#themeframe').contents().height());
}
//-->
</script>
<iframe id="themeframe" onLoad="autoResize();" marginheight="0" frameborder="0" src="URL"></iframe> 
```

然后在 iframe 加载的页面上添加以下内容：

```
<script language="javaScript">
function resize()
{
    window.parent.autoResize();
}

$(window).on('resize', resize);
</script> 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2011-01-17T12:29:11.790

如果您不想使用 jQuery，这是一个跨浏览器的解决方案：

```
/**
 * Resizes the given iFrame width so it fits its content
 * @param e The iframe to resize
 */
function resizeIframeWidth(e){
    // Set width of iframe according to its content
    if (e.Document && e.Document.body.scrollWidth) //ie5+ syntax
        e.width = e.contentWindow.document.body.scrollWidth;
    else if (e.contentDocument && e.contentDocument.body.scrollWidth) //ns6+ & opera syntax
        e.width = e.contentDocument.body.scrollWidth + 35;
    else (e.contentDocument && e.contentDocument.body.offsetWidth) //standards compliant syntax – ie8
        e.width = e.contentDocument.body.offsetWidth + 35;
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-10-01T11:27:54.553

我正在使用此代码在页面上加载所有 iframe（使用 autoHeight 类）时自动调整它们的高度。经过测试，它适用于 IE、FF、Chrome、Safari 和 Opera。

```
function doIframe() {
    var $iframes = $("iframe.autoHeight"); 
    $iframes.each(function() {
        var iframe = this;
        $(iframe).load(function() {
            setHeight(iframe);
        });
    });
}

function setHeight(e) {
  e.height = e.contentWindow.document.body.scrollHeight + 35;
}

$(window).load(function() {
    doIframe();
}); 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-04-07T15:18:38.507

在我尝试了地球上的一切之后，这对我来说真的很有效。

索引.html

```
<style type="text/css">
html, body{
  width:100%;
  height:100%;
  overflow:hidden;
  margin:0px;   
}
</style>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript">
function autoResize(iframe) {
    $(iframe).height($(iframe).contents().find('html').height());
}
</script>

<iframe src="http://iframe.domain.com" width="100%" height="100%" marginheight="0" frameborder="0" border="0" scrolling="auto" onload="autoResize(this);"></iframe> 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-11-06T03:09:57.430

这是一个可靠的解决方案

```
function resizer(id)
{

var doc=document.getElementById(id).contentWindow.document;
var body_ = doc.body, html_ = doc.documentElement;

var height = Math.max( body_.scrollHeight, body_.offsetHeight, html_.clientHeight, html_.scrollHeight, html_.offsetHeight );
var width  = Math.max( body_.scrollWidth, body_.offsetWidth, html_.clientWidth, html_.scrollWidth, html_.offsetWidth );

document.getElementById(id).style.height=height;
document.getElementById(id).style.width=width;

} 
```

html

```
<IFRAME SRC="blah.php" id="iframe1"  onLoad="resizer('iframe1');"></iframe> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-07-11T06:22:41.577

我在上面稍微修改了 Garnaph 的出色解决方案。似乎他的解决方案根据事件发生前的大小修改了 iframe 大小。对于我的情况（通过 iframe 提交电子邮件），我需要在提交后立即更改 iframe 高度。例如，提交后显示验证错误或“谢谢”消息。

我刚刚消除了嵌套的 click() 函数并将其放入我的 iframe html 中：

```
<script type="text/javascript">
    jQuery(document).ready(function () {
        var frame = $('#IDofiframeInMainWindow', window.parent.document);
        var height = jQuery("#IDofContainerInsideiFrame").height();
        frame.height(height + 15);
    });
</script> 
```

为我工作，但不确定跨浏览器功能。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-06-17T04:08:51.070

经过一些实验，我想出了另一个解决方案。我最初尝试了标记为这个问题的“最佳答案”的代码，但它没有用。我的猜测是因为我当时程序中的 iframe 是动态生成的。这是我使用的代码（它对我有用）：

正在加载的 iframe 中的 Javascript：

```
window.onload = function()
    {
        parent.document.getElementById('fileUploadIframe').style.height = document.body.clientHeight+5+'px';
        parent.document.getElementById('fileUploadIframe').style.width = document.body.clientWidth+18+'px';
    }; 
```

> 必须在高度上添加 4 个或更多像素才能删除滚动条（iframe 的一些奇怪的错误/效果）。宽度更奇怪，你可以安全地将 18px 添加到 body 的宽度。还要确保您已应用 iframe 主体的 css（如下）。

```
html, body {
   margin:0;
   padding:0;
   display:table;
}

iframe {
   border:0;
   padding:0;
   margin:0;
} 
```

这是 iframe 的 html：

```
<iframe id="fileUploadIframe" src="php/upload/singleUpload.html"></iframe> 
```

这是我的 iframe 中的所有代码：

```
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>File Upload</title>
    <style type="text/css">
    html, body {
        margin:0;
        padding:0;
        display:table;
    }
    </style>
    <script type="text/javascript">
    window.onload = function()
    {
        parent.document.getElementById('fileUploadIframe').style.height = document.body.clientHeight+5+'px';
        parent.document.getElementById('fileUploadIframe').style.width = document.body.clientWidth+18+'px';
    };
    </script>
</head>
<body>
    This is a test.<br>
    testing
</body>
</html> 
```

我已经在 chrome 中进行了测试，并在 Firefox 中进行了一些测试（在 windows xp 中）。我还有更多的测试要做，所以请告诉我这对你有用。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-01-13T11:35:34.630

如果您可以同时控制 IFRAME 内容和父窗口，那么您需要[iFrame Resizer](https://davidjbradshaw.github.io/iframe-resizer/)。

该库支持自动调整相同和跨域 iFrame 的高度和宽度，以适应其包含的内容。它提供了一系列功能来解决使用 iFrame 时最常见的问题，其中包括：

*   将 iFrame 的高度和宽度调整为内容大小。
*   适用于多个和嵌套的 iFrame。
*   跨域 iFrame 的域身份验证。
*   提供一系列页面大小计算方法来支持复杂的 CSS 布局。
*   使用 MutationObserver 检测可能导致页面调整大小的 DOM 更改。
*   检测可能导致页面调整大小的事件（窗口调整大小、CSS 动画和过渡、方向更改和鼠标事件）。
*   通过 postMessage 简化 iFrame 和主机页面之间的消息传递。
*   修复 iFrame 中的页面链接并支持 iFrame 和父页面之间的链接。
*   提供自定义大小和滚动方法。
*   向 iFrame 公开父位置和视口大小。
*   与 ViewerJS 一起使用以支持 PDF 和 ODF 文档。
*   回退支持到 IE8。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2018-09-06T13:05:25.900

## 语境

我必须在网络扩展的背景下自己做这件事。这个网络扩展在每个页面中注入了一些 UI，这个 UI 存在于`iframe`. 里面的内容`iframe`是动态的，所以我不得不重新调整它本身的宽度和高度`iframe`。

我使用**React**，但这个概念适用于每个库。

## 我的解决方案（假设您同时控制页面和 iframe）

在里面`iframe`我改变了`body`样式以具有非常大的尺寸。这将允许内部元素使用所有必要的空间进行布局。制作`width`and `height`100% 对我不起作用（我猜是因为 iframe 有一个默认值`width = 300px`and `height = 150px`）

```
/* something like this */
body {
  width: 99999px;
  height: 99999px;
} 
```

然后我将所有 iframe UI 注入到一个 div 中并给它一些样式

```
#ui-root {
  display: 'inline-block';     
} 
```

在此内部渲染我的应用程序后`#ui-root`（在*React*中，我在内部执行此操作`componentDidMount`）我计算此 div 的尺寸并将它们同步到父页面，使用`window.postMessage`：

```
let elRect = el.getBoundingClientRect()
window.parent.postMessage({
  type: 'resize-iframe',
  payload: {
    width: elRect.width,
    height: elRect.height
  }
}, '*') 
```

在父框架中，我执行以下操作：

```
window.addEventListener('message', (ev) => {
  if(ev.data.type && ev.data.type === 'resize-iframe') {
    iframe.style.width = ev.data.payload.width + 'px'
    iframe.style.height = ev.data.payload.height + 'px'
  }
}, false) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-12-19T03:46:09.157

使用上述方法都无法正常工作。

javascript:

```
function resizer(id) {
        var doc = document.getElementById(id).contentWindow.document;
        var body_ = doc.body, html_ = doc.documentElement;

        var height = Math.max(body_.scrollHeight, body_.offsetHeight, html_.clientHeight, html_.scrollHeight, html_.offsetHeight);
        var width = Math.max(body_.scrollWidth, body_.offsetWidth, html_.clientWidth, html_.scrollWidth, html_.offsetWidth);

        document.getElementById(id).style.height = height;
        document.getElementById(id).style.width = width;

    } 
```

html:

```
<div style="background-color:#b6ff00;min-height:768px;line-height:inherit;height:inherit;margin:0px;padding:0px;overflow:visible" id="mainDiv"  >
         <input id="txtHeight"/>height     <input id="txtWidth"/>width     
        <iframe src="head.html" name="topFrame" scrolling="No" noresize="noresize" id="topFrame" title="topFrame" style="width:100%; height: 47px" frameborder="0"  ></iframe>
        <iframe src="left.aspx" name="leftFrame" scrolling="yes"   id="Iframe1" title="leftFrame" onload="resizer('Iframe1');" style="top:0px;left:0px;right:0px;bottom:0px;width: 30%; border:none;border-spacing:0px; justify-content:space-around;" ></iframe>
        <iframe src="index.aspx" name="mainFrame" id="Iframe2" title="mainFrame" scrolling="yes" marginheight="0" frameborder="0" style="width: 65%; height:100%; overflow:visible;overflow-x:visible;overflow-y:visible; "  onload="resizer('Iframe2');" ></iframe>
</div> 
```

环境：IE 10、Windows 7 x64

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-02-22T13:03:03.403

可以制作一个“类似幽灵”的 IFrame，就像它不存在一样。

见[http://codecopy.wordpress.com/2013/02/22/ghost-iframe-crossdomain-iframe-resize/](http://codecopy.wordpress.com/2013/02/22/ghost-iframe-crossdomain-iframe-resize/)

[基本上，您使用https://developer.mozilla.org/en-US/docs/DOM/window.postMessage](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)`parent.postMessage(..)`中描述 的事件系统

这适用于所有现代浏览器！

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-08-13T06:46:17.853

我发现这个调整器效果更好：

```
function resizer(id)
{

    var doc = document.getElementById(id).contentWindow.document;
    var body_ = doc.body;
    var html_ = doc.documentElement;

    var height = Math.max( body_.scrollHeight, body_.offsetHeight, html_.clientHeight,     html_.scrollHeight, html_.offsetHeight );
    var width  = Math.max( body_.scrollWidth, body_.offsetWidth, html_.clientWidth, html_.scrollWidth, html_.offsetWidth );

    document.getElementById(id).height = height;
    document.getElementById(id).width = width;

} 
```

请注意，样式对象已被删除。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-12-17T00:23:26.007

万一有人来到这里：当我从 iframe 中删除 div 时，我遇到了解决方案的问题 - iframe 并没有变短。

有一个 Jquery 插件可以完成这项工作：

[http://www.jqueryscript.net/layout/jQuery-Plugin-For-Auto-Resizing-iFrame-iFrame-Resizer.html](http://www.jqueryscript.net/layout/jQuery-Plugin-For-Auto-Resizing-iFrame-iFrame-Resizer.html)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-02-08T06:42:00.823

在 jQuery 中，这对我来说是最好的选择，这对我很有帮助！！我等着帮你！

框架

```
<iframe src="" frameborder="0" id="iframe" width="100%"></iframe> 
```

jQuery

```
<script>            
        var valueSize = $( "#iframe" ).offset();
        var totalsize = (valueSize.top * 2) + valueSize.left;

        $( "#iframe" ).height(totalsize);            

</script> 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-04-10T09:58:01.287

显然有很多场景，但是，我的文档和 iframe 具有相同的域，并且我能够将其附加到 iframe 内容的末尾：

```
var parentContainer = parent.document.querySelector("iframe[src*=\"" + window.location.pathname + "\"]");
parentContainer.style.height = document.body.scrollHeight + 50 + 'px'; 
```

这会“找到”父容器，然后将长度设置为 50 像素的软糖因子以移除滚动条。

没有任何东西可以“观察”文档高度的变化，我的用例不需要这个。在我的回答中，我确实带来了一种引用父容器的方法，而不使用烘焙到父/iframe 内容中的 id。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2020-03-03T19:28:51.093

如果您可以使用**固定的纵横比**并且想要**响应式 iframe**，那么此代码将对您有用。这只是 CSS 规则。

```
.iframe-container {
  overflow: hidden;
  /* Calculated from the aspect ration of the content (in case of 16:9 it is 9/16= 
  0.5625) */
  padding-top: 56.25%;
  position: relative;
}
.iframe-container iframe {
  border: 0;
  height: 100%;
  left: 0;
  position: absolute;
  top: 0;
  width: 100%;
} 
```

iframe 必须有一个 div 作为容器。

```
<div class="iframe-container">
   <iframe src="http://example.org"></iframe>
</div> 
```

源代码基于这个[站点](https://benmarshall.me/responsive-iframes/)，[Ben Marshall](https://benmarshall.me/)有一个很好的解释。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-07-01T08:19:50.900

```
function resizeIFrameToFitContent(frame) {
if (frame == null) {
    return true;
}

var docEl = null;
var isFirefox = navigator.userAgent.search("Firefox") >= 0;

if (isFirefox && frame.contentDocument != null) {
    docEl = frame.contentDocument.documentElement;
} else if (frame.contentWindow != null) {
    docEl = frame.contentWindow.document.body;
}

if (docEl == null) {
    return;
}

var maxWidth = docEl.scrollWidth;
var maxHeight = (isFirefox ? (docEl.offsetHeight + 15) : (docEl.scrollHeight + 45));

frame.width = maxWidth;
frame.height = maxHeight;
frame.style.width = frame.width + "px";
frame.style.height = frame.height + "px";
if (maxHeight > 20) {
    frame.height = maxHeight;
    frame.style.height = frame.height + "px";
} else {
    frame.style.height = "100%";
}

if (maxWidth > 0) {
    frame.width = maxWidth;
    frame.style.width = frame.width + "px";
} else {
    frame.style.width = "100%";
}
} 
```

**伊夫拉姆风格：**

```
.myIFrameStyle {
   float: left;
   clear: both;
   width: 100%;
   height: 200px;
   padding: 5px;
   margin: 0px;
   border: 1px solid gray;
   overflow: hidden;
} 
```

**iframe 标签：**

```
<iframe id="myIframe" src="" class="myIFrameStyle"> </iframe> 
```

**脚本标签：**

```
<script type="text/javascript">
   $(document).ready(function () {
      $('myIFrame').load(function () {
         resizeIFrameToFitContent(this);
      });
    });
</script> 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-05-14T10:27:59.297

这就是我的做法（在 FF/Chrome 中测试）：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript">
function autoResize(iframe) {
    $(iframe).height($(iframe).contents().find('html').height());
}
</script>

<iframe src="page.html" width="100%" height="100" marginheight="0" frameborder="0" onload="autoResize(this);"></iframe> 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-06-27T12:32:32.617

这里有几种方法：

```
<body style="margin:0px;padding:0px;overflow:hidden">
    <iframe src="http://www.example.com" frameborder="0" style="overflow:hidden;height:100%;width:100%" height="100%" width="100%"></iframe>
</body> 
```

和另一个选择

```
<body style="margin:0px;padding:0px;overflow:hidden">
    <iframe src="http://www.example.com" frameborder="0" style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:100%;width:100%;position:absolute;top:0px;left:0px;right:0px;bottom:0px" height="100%" width="100%"></iframe>
</body> 
```

如上图所示，使用 2 个选项隐藏滚动

```
<body style="margin:0px;padding:0px;overflow:hidden">
    <iframe src="http://www.example.com" frameborder="0" style="overflow:hidden;height:150%;width:150%" height="150%" width="150%"></iframe>
</body> 
```

破解第二个代码

```
<body style="margin:0px;padding:0px;overflow:hidden">
    <iframe src="http://www.example.com" frameborder="0" style="overflow:hidden;overflow-x:hidden;overflow-y:hidden;height:150%;width:150%;position:absolute;top:0px;left:0px;right:0px;bottom:0px" height="150%" width="150%"></iframe>
</body> 
```

为了隐藏 iFrame 的滚动条，父级被设置为“overflow:hidden”以隐藏滚动条，并且 iFrame 的宽度和高度达到 150%，这会强制滚动条在页面之外，并且由于正文没有t 有滚动条人们可能不会期望 iframe 超出页面的边界。这会以全宽隐藏 iFrame 的滚动条！

来源：设置[iframe 自动高度](https://stackoverflow.com/questions/5867985/iframe-100-height)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-09-12T16:29:44.347

我知道这篇文章很旧，但我相信这是另一种方法。我刚刚在我的代码上实现了。在页面加载和页面调整大小时都可以完美运行：

```
var videoHeight;
var videoWidth;
var iframeHeight;
var iframeWidth;

function resizeIframe(){
    videoHeight = $('.video-container').height();//iframe parent div's height
    videoWidth = $('.video-container').width();//iframe parent div's width

    iframeHeight = $('.youtubeFrames').height(videoHeight);//iframe's height
    iframeWidth = $('.youtubeFrames').width(videoWidth);//iframe's width
}
resizeIframe();

$(window).on('resize', function(){
    resizeIframe();
}); 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-02-27T05:55:23.667

**要放置在标题中的 Javascript：**

```
function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
      } 
```

**这是 iframe html 代码：**

```
<iframe class="spec_iframe" seamless="seamless" frameborder="0" scrolling="no" id="iframe" onload="javascript:resizeIframe(this);" src="somepage.php" style="height: 1726px;"></iframe> 
```

**Css 样式表**

>

```
.spec_iframe {
        width: 100%;
        overflow: hidden;
    } 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-12-23T18:04:39.207

对于 angularjs 指令属性：

```
G.directive ( 'previewIframe', function () {
return {
    restrict : 'A',
    replace : true,
    scope : true,
    link : function ( scope, elem, attrs ) {
        elem.on ( 'load', function ( e ) {
            var currentH = this.contentWindow.document.body.scrollHeight;
            this.style.height = eval( currentH ) + ( (25 / 100)* eval( currentH ) ) + 'px';
        } );
    }
};
} ); 
```

注意百分比，我插入了它，以便您可以对抗通常为 iframe、文本、广告等进行的缩放，如果没有实现缩放，只需输入 0

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-07-22T15:53:37.063

这就是我在加载或事情发生变化时的方式。

```
parent.jQuery("#frame").height(document.body.scrollHeight+50); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-08-29T13:07:34.143

如果您正在寻找无 jQuery 跨域解决方案，您可能想看看我的想法：

```
<main id="container"></main>
<script>
  fetch('https://example.com').then(response => {
    return response.text();
  }).then(data => {
    const iframeContainer = window.document.getElementById('container');
    const iframe = document.createElement('iframe');
    iframe.frameBorder = 'none';
    iframe.width = '100%';
    iframe.addEventListener("load", function() {
      iframe.height = iframe.contentWindow.document.body.scrollHeight;
    })
    const finalHtml = data;
    const blob = new Blob([finalHtml], {type: 'text/html'});
    iframe.src = window.URL.createObjectURL(blob);
    iframeContainer.appendChild(iframe);
  })
</script> 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-09-17T15:12:33.557

我在这里阅读了很多答案，但几乎每个人都给出了某种跨域框架块。

示例错误：

> 未捕获的 DOMException：阻止具有源“null”的框架访问跨域框架。

相关线程中的答案也是如此：

[使iframe根据内容自动调整高度而不使用滚动条？](https://stackoverflow.com/q/9975810/3850405)

我也不想使用第三方库`iFrame Resizer`或类似库。

@bboydflo 的答案很接近，但我错过了一个完整的例子。[https://stackoverflow.com/a/52204841/3850405](https://stackoverflow.com/a/52204841/3850405)

我正在使用`width="100%"`，`iframe`但代码也可以修改为使用宽度。

这就是我解决设置自定义高度的方法`iframe`：

嵌入式`iframe`：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="description"
          content="Web site" />
    <title>Test with embedded iframe</title>
</head>
<body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <iframe id="ifrm" src="https://localhost:44335/package/details?key=123" width="100%"></iframe>
    <script type="text/javascript">
        window.addEventListener('message', receiveMessage, false);

        function receiveMessage(evt) {
            console.log("Got message: " + JSON.stringify(evt.data) + " from origin: " + evt.origin);
            // Do we trust the sender of this message?
            if (evt.origin !== "https://localhost:44335") {
                return;
            }

            if (evt.data.type === "frame-resized") {
                document.getElementById("ifrm").style.height = evt.data.value + "px";
            }
        }
    </script>
</body>
</html> 
```

`iframe source`, 示例来自`Create React App`但仅使用`HTML`and `JS`。

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="description"
          content="Web site created using create-react-app" />
    <title>React App</title>
</head>
<body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <script type="text/javascript">
        //Don't run unless in an iframe
        if (self !== top) {
            var rootHeight;
            setInterval(function () {
                var rootElement = document.getElementById("root");
                if (rootElement) {
                    var currentRootHeight = rootElement.offsetHeight;
                    //Only send values if height has changed since last time
                    if (rootHeight !== currentRootHeight) {
                        //postMessage to set iframe height
                        window.parent.postMessage({ "type": "frame-resized", "value": currentRootHeight }, '*');
                        rootHeight = currentRootHeight;
                    }
                }
            }
                , 1000);
        }
    </script>
</body>
</html> 
```

`setInterval`当然可以修改代码，但它非常适合动态内容。`setInterval`仅当内容嵌入 a 时才激活，`iframe`并且`postMessage`仅在高度更改时发送消息。

您可以在此处阅读更多信息`Window.postMessage()`，但描述非常适合我们想要实现的目标：

> window.postMessage() 方法可以安全地启用 Window 对象之间的跨域通信；例如，在页面和它生成的弹出窗口之间，或者在页面和嵌入其中的 iframe 之间。
> 
> 通常，当且仅当它们源自的页面共享相同的协议、端口号和主机（也称为“同源策略”）时，才允许不同页面上的脚本相互访问。window.postMessage() 提供了一种受控机制来安全地规避此限制（如果使用得当）。

[https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage)

如果你想要 100% 的宽度和高度，`iframe`我会这样做：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="description"
          content="Web site" />
    <style>
        body {
            margin: 0; /* Reset default margin */
        }

        iframe {
            display: block; /* iframes are inline by default */
            background: #000;
            border: none; /* Reset default border */
            height: 100vh; /* Viewport-relative units */
            width: 100vw;
        }
    </style>
    <title>Test with embedded iframe</title>
</head>
<body>
    <iframe src="https://localhost:44335/package/details?key=123"></iframe>
</body>
</html> 
```

来源：

[https://stackoverflow.com/a/27853830/3850405](https://stackoverflow.com/a/27853830/3850405)

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2016-07-21T08:15:47.463

简单：

```
var iframe = $("#myframe");
$(iframe.get(0).contentWindow).on("resize", function(){
    iframe.width(iframe.get(0).contentWindow.document.body.scrollWidth);
    iframe.height(iframe.get(0).contentWindow.document.body.scrollHeight);
}); 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2016-09-09T03:02:38.850

```
<iframe src="hello.html" sandbox="allow-same-origin"
        onload="this.style.height=(this.contentWindow.document.body.scrollHeight+20)+'px';this.style.width=(this.contentWindow.document.body.scrollWidth+20)+'px';">
</iframe> 
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2018-04-23T18:05:51.390

如果内容只是很简单的html，最简单的方法就是用javascript去掉iframe

HTML 代码：

```
<div class="iframe">
    <iframe src="./mypage.html" frameborder="0" onload="removeIframe(this);"></iframe>
</div> 
```

Javascript代码：

```
function removeIframe(obj) {
    var iframeDocument = obj.contentDocument || obj.contentWindow.document;
    var mycontent = iframeDocument.getElementsByTagName("body")[0].innerHTML;
    obj.remove();
    document.getElementsByClassName("iframe")[0].innerHTML = mycontent;
} 
```

* * *

## 回答 #33

> 赞同：-6
> 
> 时间：2020-07-27T19:20:15.673

```
<iframe src="..." style="border:none; width:100%; height: 100vh;"></iframe> 
```

# svn - 在颠覆差异中包括外部

> ID：819419
> 
> 赞同：3
> 
> 时间：2009-05-04T09:20:57.993
> 
> 标签：svn, version-control, diff, svn-externals

我已经在 SVN 中设置了我的项目以使用外部库。当我想将一些修改推送到实时服务器时，我会在版本之间进行差异并仅复制更改的文件。我的问题是 diff 也不检查外部修改，它只返回项目修改。

您为具有外部代码的项目部署修改的策略是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T09:25:17.780

我们使用构建工具 ( [Maven](http://maven.apache.org/) ) 来检查和更新依赖项。这些是在构建脚本中配置的，并保留在某个服务器上，从那里下载它们以适应配置文件。

# windows - 如何在 C++ 中实现 CTRL-A 组合键

> ID：819422
> 
> 赞同：1
> 
> 时间：2009-05-04T09:21:56.740
> 
> 标签：windows, visual-c++

我想在按下 CTRL-A 时执行一些操作。如何在 Windows 平台上的 C++ 中执行此操作。我正在使用 VS 2005 。

任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:33:39.693

您需要在资源中定义键盘加速器表，然后确保在消息循环中调用[TranslateAccelerator 。](http://msdn.microsoft.com/en-us/library/ms646373(VS.85).aspx)有关完整详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/ms645526(VS.85).aspx)。

如果您使用的是框架（例如 MFC），那么它将有自己的包装加速器的方式 - 您需要在您正在使用的框架的文档中查找它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T13:28:30.237

你绝对不需要加速器，上面的代码根本没有意义。
只需使用HK。基本代码参见 MSDN 和 Google 组 (Win32)

# c# - 从excel粘贴到文本框

> ID：819423
> 
> 赞同：2
> 
> 时间：2009-05-04T09:22:34.057
> 
> 标签：c#, excel, textbox, selection, paste

我想将一些数据从 excel 文件复制到 win 应用程序中的文本框。如果单元格是连续的，则复制粘贴可以正常工作，但是如果我选择（使用 CTRL）第一个和第三个单元格，当我将其粘贴到文本框时，它也会粘贴第二个单元格。获得我感兴趣的细胞的最佳方法是什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T15:50:13.487

我发现的唯一方法是复制两个有趣的列，在 Excel 中的某个位置重新粘贴它们，（就像一个新的电子表格）重新复制，然后粘贴到文本框中。

文本框确实不适用于网格视图中的数据。如果您正在创建文本框，我建议您尝试使用某种网格视图控件。

如果您必须使用文本框，我还建议使用某种分隔符（如逗号）粘贴数据，以将数据分隔成行，否则当它从框中拉出时将很难使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T15:53:20.153

没有办法解决这个问题，因为这正是 Excel 与窗口交互的方式。您将需要单独复制/粘贴每个单元格，或者复制/粘贴然后删除多余的值。

如果这是一项重复性任务，您可以考虑编写脚本。有大量可用的脚本选项，这些选项取决于您的技能水平和您正在运行的操作系统。

如果你不想为此编写一个 vbscript，你可以考虑一个像[shortkeys](http://www.shortkeys.com/lite.htm)这样的免费程序。这是一个文本替换工具，由于您的复制/粘贴都可以使用键盘完成，因此这可能是一个更简单的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T04:00:54.367

我可以想出一种方法来解决这个问题。如果您的源 excel 文件是恒定的并且不是由其他工具/宏或网页生成的，并且如果您可以在其中添加宏，那么您可以尝试一下。

```
Private Sub Workbook_WindowDeactivate(ByVal Wn As Window)
Dim oSelection As Range, oWorkbook As Workbook
Application.ScreenUpdating = False  
Set oSelection = Selection
Set oWorkbook = Application.Workbooks.Add
Application.Windows(oWorkbook.Name).Visible = False
oWorkbook.Sheets(1).Paste
oWorkbook.Sheets(1).Range("A1:" & oWorkbook.Sheets(1).Cells(500, 1).End(xlUp).Address).Copy
oWorkbook.Close False
Application.ScreenUpdating = True
End Sub 
```

但是在写下来之后，我不确定如果您从 Excel 切换到另一个 Windows 应用程序是否会触发 Window Deactivate。我认为只有当您切换到另一个 Excel 文件窗口时才会发生这种情况。

# mfc - 蒙皮 MFC 应用程序

> ID：819424
> 
> 赞同：2
> 
> 时间：2009-05-04T09:22:43.760
> 
> 标签：mfc, skinning, skin

我见过一些很酷的应用程序，它们的皮肤看起来很漂亮。我是 MFC 的新手，我想创建一个具有更改皮肤功能的应用程序。在 MFC 中是如何实现的？我检查了一些教程，但有点过时了。谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:26:24.157

只是一个注释。*UI 皮肤*的概念是一个通用的软件设计任务（基本上是一个*插件*概念），并且（据我所知）没有被任何语言或框架（如 MFC）明确支持为服务。即没有做皮肤的“MFC 方式”，也没有“.NET 方式”。但是您可以使用其中任何一个来设计蒙皮支持。

也就是说，某些语言或框架可能比其他语言或框架更容易实现皮肤支持。我通常会推荐 C#/.NET 进行 UI 编码，但设计插件/皮肤支持的大部分是关于通用代码机制和接口的，语言/框架的问题是没有实际意义的。如果您对自己编写它的练习不感兴趣，也有许多语言的现成框架可以为您执行此操作。

一些可能有用的链接：

[插件概念](http://en.wikipedia.org/wiki/Plugin)（注意底部一些语言的插件框架列表）

[立面设计模式](http://en.wikipedia.org/wiki/Facade_pattern)

[中介者设计模式](http://en.wikipedia.org/wiki/Mediator_pattern)

[关于皮肤的一般信息](http://en.wikipedia.org/wiki/Skin_(computing))

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T09:48:01.563

MFC 通常已经过时，但您可能已经知道这一点。如果你愿意付钱，似乎有一个供应商提供皮肤组件。请参阅[BCGSoft](https://www.bcgsoft.com/featuretour/tour88.htm)。

![替代文字](https://www.bcgsoft.com/featuretour/screenshots/skins2.jpg)

另一种可能是寻找其他平台，例如 Mozilla 的[XULRunner 框架](https://developer.mozilla.org/en-US/docs/Archive/Mozilla/XULRunner)，[Songbird](https://nmhytg.com/)（[开发者中心](http://wiki.songbirdnest.com/Developer)）是基于该框架的。请参阅[外观](http://addons.songbirdnest.com/addons?category=appearance)插件和[XUL 的乐趣](https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XUL/The_Joy_of_XUL)。

[![替代文字](https://i.stack.imgur.com/Wq96h.png)](https://i.stack.imgur.com/Wq96h.png)
[（来源：[songbirdnest.com](http://addons.songbirdnest.com/addon-images/1345/Screenshot-darksuper_thumbnail.png?1218294592)）]

[![替代文字](https://i.stack.imgur.com/NYyys.png)](https://i.stack.imgur.com/NYyys.png)
[（来源：[songbirdnest.com](http://addons.songbirdnest.com/addon-images/197/zrzutekranu-Blank_page_-_Songbird_thumbnail.png?1211917007)）]

# c++ - 为什么 C++ 需要“管理”语言修改？

> ID：819425
> 
> 赞同：9
> 
> 时间：2009-05-04T09:23:00.937
> 
> 标签：c++, .net, c++-cli, clr, managed-code

为什么不能编写一个编译器来*管理*需要在 C++ 代码中*管理*的内容（即使其“与 CLR 兼容”）？

也许有一些妥协，比如禁止*无效*指针等。但是所有这些额外的关键字等。这些添加必须解决的问题是什么？

我对某些方面以及可能难以解决的问题有自己的想法，但我们将不胜感激！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-04T13:00:37.870

到目前为止，我不得不不同意这些答案。

要理解的主要问题是 C++ 编译器创建的代码适用于非常愚蠢的环境。即使是现代 CPU 也不知道虚函数，地狱，甚至函数都是一个延伸。例如，CPU 真的不在乎用于展开堆栈的异常处理代码在任何函数之外。CPU 处理指令序列，包括跳转和返回。就 CPU 而言，函数当然没有名称。

因此，支持函数概念所需的一切都由编译器放在那里。例如，vtables 只是大小正确的数组，从 CPU 的角度来看具有正确的值。`__func__`最终成为字符串表中的一个字节序列，其中最后一个是 00。

现在，没有什么说目标环境*必须是愚蠢*的。您绝对可以针对 JVM。同样，编译器必须填写本机未提供的内容。没有原始内存？然后分配一个大字节数组并使用它。没有原始指针？只需在该大字节数组中使用整数索引即可。

主要问题是 C++ 程序在宿主环境中看起来非常难以辨认。JVM 并不笨，它知道函数，但它希望它们是类成员。它不希望他们拥有`<`并`>`以他们的名义。你可以绕过这个，但你最终得到的基本上是名称修改。与今天的名称修饰不同，这种名称修饰不是针对 C 链接器，而是针对智能环境。因此，它的反射引擎可能会确信存在一个`c__plus__plus`具有成员函数的类`__namespace_std__for_each__arguments_int_pointer_int_pointer_function_address`，这仍然是一个很好的例子。我不想知道如果你有一个`std::map`字符串来反转迭代器会发生什么。

一般来说，相反的方式实际上要容易得多。几乎所有其他语言的抽象都可以在 C++ 中处理掉。垃圾收集？这在今天的 C++ 中已经被允许，所以你甚至可以支持`void*`.

我还没有解决的一件事是性能。在大字节数组中模拟原始内存？这不会很快，特别是如果你把双打放进去。你可以玩很多技巧来让它更快，但价格是多少？您可能不会获得商业上可行的产品。实际上，您可能会使用一种将 C++ 最糟糕的部分（许多不寻常的依赖于实现的行为）与 VM 的最糟糕的部分（慢）结合在一起的语言。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T09:25:59.320

现有的正确代码，即根据 C++ 标准编写的代码，不得无意中改变其行为。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T10:40:16.630

好吧，C++/CLI 主要是托管和非托管代码之间的粘合剂。因此，您需要能够混合托管和非托管概念。您需要能够在同一代码中分配托管对象和非托管对象，因此无法绕过单独的关键字。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-04T11:11:45.557

为什么不能编译针对 CLR 的本机 C++ 代码？

是的，你猜对了，会有太多的妥协，那会让它变得毫无用处。我只想举三个例子...

1.) 模板：C++ 支持它们，CLR 不支持（泛型不同）。所以你不能在你的代码中使用 STL、boost 等。

2.) 多重继承：在 C++ 中支持，在 CLI 中不支持。您甚至不能使用从 istream 和 ostream 继承的标准 iostream 类和派生类（如 stringstream、fstream）。

几乎没有任何代码可以编译，您甚至无法实现标准库。

3.) 垃圾收集：大多数 C++ 应用程序手动管理它们的内存（使用智能指针等），CLR 具有自动内存管理。因此，C++ 风格的“new”和“delete”将与“gcnew”不兼容，使得现有的 C++ 代码对这个新编译器毫无用处。

如果你必须根除所有重要的特性，甚至是标准库，并且没有现有的代码可以编译......那有什么意义呢？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T11:03:22.537

首先，“简单 C++”和“托管 C++”之间的区别是有意的，因为 MC++ 的目的之一是在现有 C++ 代码和 CLR 之间架起一座桥梁。

其次，有太多的 C++ 特性不适合 CLR 模型。多重继承、模板、指针算法......如果没有明确的界限，程序员将注定要在编译和运行时面临神秘的错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T09:33:20.007

[Qt 框架](http://qt.nokia.com/)几乎可以做到这一点。即它有智能指针，当它们指向的对象被销毁时，它会自动设置为空。经过 moc（元对象编译器）解析后，它仍然是原生 C++。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T10:16:09.637

我认为这是因为将托管代码功能添加到 C++ 中会使 C++ 变慢并且编译器更复杂。如此之多以至于 C++ 会失去它最初的设计目的。C++ 的优点之一是它是一种很好的语言，它足够低级并且具有一定的可移植性。可能这就是 C++ 标准委员会计划让它保持这种状态的原因。无论如何，我不认为 C++ 可以被完全“管理”，因为这意味着用 C++ 编写的程序需要一个虚拟机来执行。如果是这样，为什么不直接使用 C++/CLI？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-19T08:09:41.517

是的，我想 C++ 可以被管理。但是，.NET 需要为 C++**重写**，而不是偏向于 BASIC。在同一个屋檐下拥有多种语言。某些功能必须取消。在VB.NET或C++.NET之间进行选择，最终选择了VB.NET。我听到的有趣的事情是 C# 比 VB.NET 更流行（尽管我都没有使用！）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-01T21:29:37.390

.NET CLR 要求在运行时不知道的任何地方都不能存在对托管对象的引用，除非对象被固定；良好的性能要求尽可能少地固定对象。由于 .NET CLR 无法理解 C++ 中可用的所有数据结构，因此对托管对象的引用必须永远不会保留在此类结构中。可以让“普通”C++ 代码与 .NET 代码交互，而无需对 C++ 语言进行任何更改，但 C++ 代码可以保持对任何 .NET 对象的任何“引用”的唯一方法是拥有一些.NET 端的代码为每个对象分配某种句柄，并保留与句柄关联的对象的静态表。然后，想要操作对象的 C++ 代码必须要求 .NET 包装器对由句柄标识的对象执行一些操作。添加新语法使编译器能够识别 .NET 框架需要了解的对象类型，并对它们实施必要的限制。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-05-04T21:52:44.200

首先要考虑的是一切使`c++`“快”的东西都会消失。一个完整的 C++ 垃圾收集系统几乎是不可能的。因为`c++`您几乎可以在代码中的任何位置使用指针。如果不直接将运行时类型信息内置到它自己的语言系统中，那么运行时类型信息就会变得昂贵。您可以利用真正的原生性能。模板将消失。真正的指针会消失。直接访问内存已不复存在。

必须执行的事情清单

```
1\. no direct pointers(pointers will get replace with complex refernces)
2\. templates (generics pay for preformance)
3\. simple c-style arrays (will get wrapped with array structures)
4\. programmer no longer has control of whether data is on the stack or
the heap.
5\. garbage collection will be enforced(this will cause the most changes to the syntax)
6\. runtime type data will get added extensively to the code.
(larger code size)
7\.  inlining will become more difficult for the compiler
(no more inline key word)
8\. no more inline assembly.
9\. the new langauge by now will become incompatible c code.(unless you go through hoops) 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-04-06T13:42:08.163

我同意5hammer！如果我离开 Java 和其他托管语言，这不是没有意义的：那就是完全控制计算机，自己访问内存管理内存，控制计算机如何运行我的代码，与 C 库（例如 Lua）集成。如果我失去了这种灵活性，那么我会离开 C++ 并退回到 C，如果 C 也成为托管的，那么我会去汇编程序。

托管语言是所有游戏平台/复杂程序中最糟糕的语言，因为它们将您限制在某种沙箱中，无法直接访问硬件，并且比编译语言慢得多。

C++ 的主要目的一直是性能。它是大型游戏的最佳语言之一。如果没有这种语言表演，很多游戏都不会存在！

# haskell - 在Haskell中将两个列表元素相乘

> ID：819434
> 
> 赞同：12
> 
> 时间：2009-05-04T09:26:46.620
> 
> 标签：haskell, list

如何将 Haskell 中两个列表的元素乘以二？基本上，如果我有 [1,2,3] 和 [2,3,4]，我想得到 [2,6,12]。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-04T09:31:11.773

```
zipWith (*) [1,2,3] [2,3,4] 
```

[查找](http://haskell.org/hoogle/)函数的一种有用方法，例如`zipWith`Hoogle。在那里，您可以输入您要查找的函数的类型，它会尝试在标准库中查找匹配的函数。

在这种情况下，您正在寻找一个函数来使用组合函数将两个`Int`s 列表组合成一个 s 列表，所以这将是您的查询：。如果您更改参数的顺序，Hoogle 甚至会找到正确的函数。`Int``(*)`[`(Int -> Int -> Int) -> [Int] -> [Int] -> [Int]`](http://haskell.org/hoogle/?hoogle=(Int%20-%3E%20Int%20-%3E%20Int)%20-%3E%20%5BInt%5D%20-%3E%20%5BInt%5D%20-%3E%20%5BInt%5D)

# visual-studio-2008 - Visual Studio 2008 CSS 验证级别

> ID：819436
> 
> 赞同：5
> 
> 时间：2009-05-04T09:26:59.663
> 
> 标签：visual-studio-2008, preferences, css, css-validator

我在 Visual Studio 08 的 2.1 级验证我的 CSS。

有没有办法改变你验证的级别？我找不到任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T09:41:40.983

您还可以在**工具 -> 选项 -> 文本编辑器 -> HTML -> 验证中设置验证选项**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T09:31:28.857

打开一个样式表并从样式表菜单上出现的下拉菜单中选择验证。

我正在寻找工具选项..

# eclipse - 修改 Eclipse 搜索

> ID：819442
> 
> 赞同：1
> 
> 时间：2009-05-04T09:29:01.653
> 
> 标签：eclipse, search

我最近安装了 Ganymede SR2 并想搜索一些东西。我按下 CTRL - H 打开搜索视图并使用文件搜索。但是，我遇到的是文件夹 test-build 和 exploded-archieves 也在搜索中，我想禁用对这些文件夹的搜索。

我只想搜索源代码，而不是生成的内容。有人知道我如何在 Ganymede 中做到这一点吗？我在欧罗巴没有这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:38:20.977

您可以创建一个仅包含您的源目录的工作集。使用搜索时，您可以将工作集指定为范围（靠近搜索对话框的底部）。

为此，请按 Ctrl+H 打开搜索框，然后在范围区域中单击选择...按钮，这将打开一个对话框，您可以在其中管理工作集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-24T10:20:41.087

我使用了 Eclipse 开普勒。

通过在“搜索”对话框的“**文件搜索**”选项卡中的字段中输入“ **.java** ”，将搜索限制为仅源文件，即仅搜索**.java文件。****`File name patterns(Separated by commas):`**

 ****添加更多以逗号分隔的文件名模式，例如：`*.java, *.xml, *.properties, *.txt`等

# vbscript - 插入日期和时间戳，vbs

> ID：819444
> 
> 赞同：2
> 
> 时间：2009-05-04T09:30:12.463
> 
> 标签：vbscript

我想插入脚本执行的时间和日期。到目前为止，我只有执行脚本的人的用户名....

```
Set FSO = wscript.CreateObject("Scripting.FileSystemObject")
Set NewTextFile = FSO.OpenTextFile("UserInfo.flag",2,true)
Set WshNetwork = WScript.CreateObject("WScript.Network")
WScript.Echo "User Name = " & WshNetwork.UserName
NewTextFile.WriteLine("Site replication was last executed by user:")
NewTextFile.WriteLine(WshNetwork.userName)
NewTextFile.Close
Set NewTextFile = Nothing
Set FSO = Nothing 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T09:35:00.143

您可能需要 Now 语句：

```
NewTextFile.WriteLine(Now) 
```

或者，如果您不想要时间，请使用 Date

# .net - 将 IHierarchicalEnumerable 绑定到树视图，并指定自定义图像和导航 URL

> ID：819445
> 
> 赞同：0
> 
> 时间：2009-05-04T09:30:27.533
> 
> 标签：.net, asp.net, data-binding, treeview, hierarchical-data

我有一个实现 IHierarchicalEnumerable 的外部数据源。我正在尝试为我的 TreeView 使用该数据源，但我找不到指定控件应呈现的图像和单个导航 url 的方法（那里有一些业务逻辑）。

我看到的示例都假设 Url 以及 Name 和 Image 字段在数据源中直接可用，但这里不是这种情况。

我尝试创建另一个数据源作为实现这些属性的代理，但这证明比预期的要困难得多（由于 GetHierarchyData().GetChildren()）所以我希望有其他方法。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:38:28.183

您应该查看 TreeView 控件的[TreeNodeDataBound](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.treenodedatabound.aspx)事件。在事件处理程序中，您可以根据特定条件更改节点属性（如图像 url 或文本）。

# .net - 如何在没有 Visual Studio 的情况下调试 .net 应用程序

> ID：819446
> 
> 赞同：21
> 
> 时间：2009-05-04T09:31:03.647
> 
> 标签：.net, debugging, remote-debugging

如果之前有人问过这个问题，请告诉我，我找不到关于这个主题的任何问题：-

我需要确定在安装了 .net 框架但未安装 Visual Studio 的计算机上引发的异常的内部异常（也无法在计算机上安装 Visual Studio）。我如何检查这个内部异常？

注意几点：

*   从另一台计算机上运行 Visual Studio 并不好，因为问题实际上出在盒子上；这是一阶海森虫。
*   我知道 WinDbg 是一种选择，但是我需要快速完成这项工作，不幸的是，我想充分学习 WinDbg 以完成这项工作所花费的时间将超过我所拥有的时间 - 但是，如果有人对此有分步说明，我会感兴趣的。
*   我有完全的管理员权限，可以安装任何不太大的东西（安装 VS 的问题是硬盘空间不足）。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-04T09:46:13.937

你看过[MDBG](https://docs.microsoft.com/en-us/dotnet/framework/tools/mdbg-exe)吗？您可能需要一段时间才能四处走动，但相当直截了当。

DbgClr[也](http://blogs.msdn.com/andypennell/archive/2005/02/21/377621.aspx)可能是一个选项，我认为它仍然应该在 SDK 的某个地方。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-04T09:48:07.257

如果您有故障转储，使用 WinDbg 执行此操作实际上相当简单。将转储加载到 WinDbg 中，加载 sos，然后运行 ​​printexception 命令。

```
>.load sos
>!printexception 
```

这将告诉您异常并指出内部异常。输出将类似于：

```
0:000> !printexception
Exception object: 0135b340
Exception type: System.ApplicationException
Message: GetAverage failed
InnerException: System.IndexOutOfRangeException, use !PrintException 01358394 to see more
<stack trace follows> 
```

如果您还没有内存转储，您可以使用 adplus（WinDbg 附带）创建一个。

```
>adplus -crash -o<dump location> -quiet -pn<name of process> 
```

如果您更喜欢使用 PID，请改用该`-p`选项。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T09:38:34.487

您可以使用远程调试：http: [//msdn.microsoft.com/en-us/library/y7f5zaaa.aspx](http://msdn.microsoft.com/en-us/library/y7f5zaaa.aspx)

# c - 流行的 Linux 发行版中的 C/JSON 库？

> ID：819452
> 
> 赞同：20
> 
> 时间：2009-05-04T09:32:55.670
> 
> 标签：c, linux, json

我有一个用 C 编写的程序，它必须通过本地域套接字输入和输出 JSON。我发现了几个通过搜索“几乎可以工作”的 C/JSON 库。在使用我发现的一个库之前.. 我​​想确保我没有忽略现代 Linux 发行版中常见的库。

我也非常感谢您使用的库的链接。最有可能的是，我会把它放在树上，除非我意识到我已经看过广泛分布的东西。

我将此标记为主观的，因为我选择的答案是链接到对我有用的库的答案，这并不意味着它是“最佳”库。

我想获取一个现有的数组并轻松地将其转换为可以发送的缓冲区，或者获取一个缓冲区并轻松地将其转换为分配的数组。

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-04-24T02:43:45.207

[json-Glib](http://live.gnome.org/JsonGlib)似乎在大多数发行版的存储库中，我没有使用过它，所以我不能谈论它的质量或稳定性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T10:03:23.257

我不太喜欢 C，但是，MJSON 刚刚达到 1.0 ( [http://sourceforge.net/projects/mjson/](http://sourceforge.net/projects/mjson/) )，而且最近更新的另一个项目是 json-c ( [http://oss.metaparadigm. com/json-c/](http://oss.metaparadigm.com/json-c/) )...

# oracle - 在不同的数据库中执行存储过程失败？

> ID：819457
> 
> 赞同：0
> 
> 时间：2009-05-04T09:33:57.413
> 
> 标签：oracle, visual-c++, stored-procedures

在开发数据库中执行良好但在生产数据库中执行失败的存储过程？返回的错误是：“PLS-00306：调用中的参数数量或类型错误`<procedure naeme>`”

VC++数据库oracle

已关闭：由于同义词错误而发生错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T10:19:23.000

此错误与您正在执行的过程中的问题无关。此错误与您在一个数据库与另一个数据库中调用它的方式有关。发送参数和参数类型的正确组合的是 DEV 中的调用者。最终在 PROD 中调用过程的逻辑是发送不同的参数组合。

首先检查两个数据库中的过程规范以确保它真的相同。查找参数、数据类型或 DEFAULT NULL 等中的任何差异。

接下来检查在数据库之间调用实际过程的逻辑。通常它会丢失一个参数或数据类型不正确。如果您不使用命名符号，则参数的顺序也很重要。

如果最终你确定一切都是一样的，那么可能是与数据相关的参数之一缺乏价值，并且你的 C++ 驱动程序没有调用相同的过程。

这是一个明确而明确的错误，它告诉你它的调用方式最终会有所不同。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T22:57:24.393

您应该提供更多信息。至少，这些“基本”数据类型（NUMBER、DATE、VARCHAR2 等）或者您是否有外来数据类型（XMLTYPE、geo、用户定义类型？）使用 SQL*Plus，连接到两个数据库中的模式并执行 DESC发布结果，以便我们查看。

# .net - UI线程上的方法超时

> ID：819466
> 
> 赞同：1
> 
> 时间：2009-05-04T09:37:00.997
> 
> 标签：.net, timeout, single-threaded

我有一个问题，我在 UI 线程（WinForms）上实例化一个对象。这个对象创建可能需要很长时间，我希望该方法有某种“超时”（因为它阻止了我的应用程序）。

我遇到的问题是：1.对象必须在UI线程上创建2.对象是外来对象，我没有任何源访问权限，所以无法修改。

所以我的问题是，如果有人有创意，是否可以创建一个逻辑，如果达到超时，则停止执行该方法？

蒂亚·马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T09:51:30.320

这是一个糟糕的解决方案。在计时器上使用工作线程来监视 UI 线程。如果在创建对象之前计时器已过，则让工作线程调用`Abort`UI 线程。这将`ThreadAbortException`在您必须捕获的 UI 线程中引发一个。这不好的原因是因为您可能会导致程序挂起或崩溃，具体取决于引发异常的微妙时间和竞争条件。

“更安全”的方法是让工作人员调用`Interrupt`- 这将`ThreadInterruptedException`在 UI 线程中引发 a，但仅当它处于`WaitSleepJoin`状态时 - 如果线程从不休眠，它不会中断，但至少不会挂起或损坏内存也。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:53:05.607

并不真地; *特别是*如果您无权访问源代码。

即使可以，在没有充分理由的情况下强行中断代码也不是一个好主意——它只会导致问题（泄漏、锁被锁定等）。

它必须是*相同*的UI 线程吗？您可以生成第二个 UI 线程来拥有此代码吗？它*有点*杂乱无章，但可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T09:55:01.140

如果您使用 BeginInvoke，则[IAsyncResult](http://msdn.microsoft.com/en-us/library/system.iasyncresult_members.aspx)有一个等待句柄，您可以在该句柄上 WaitOne(timeout) - 来自非 UI 线程。

不幸的是，在超时时，没有干净的方法可以取消 BeginInvoke - 所以你可以尝试`1800 INFORMATION`'s 解决方案。

# asp.net-mvc - ASP.Net MVC 简单编辑来自默认模板的数据

> ID：819468
> 
> 赞同：0
> 
> 时间：2009-05-04T09:37:52.430
> 
> 标签：asp.net-mvc

创建新视图并选择编辑模板时，模板将为不可编辑的主键创建一个文本框。

```
 <%=Html.TextBox("CompanyID", Model.CompanyID)%> 
```

因此，从视图中删除控件会导致问题：发布到控制器的集合具有 CompanyID=0 ，因此不会进行任何编辑。但是如果我放回那行代码来查看，发布集合中的 CompanyID 具有正确的值。我正在做这个教程： [http](http://www.asp.net/learn/mvc/tutorial-21-vb.aspx) ://www.asp.net/learn/mvc/tutorial-21-vb.aspx ，还有（“清单 6 – Controllers\HomeController.vb（编辑方法）”上方的灰色框部分）它是说您可以删除控件，但它不起作用..有什么建议吗？

**更新** 好的，更多解释，这里有 2 个问题：此代码中的
**问题 1 ：**

```
<AcceptVerbs(HttpVerbs.Post)> _
Function Edit(ByVal movieToEdit As Movie) As ActionResult 
```

*如果您从视图*中删除 MovieID 文本框，movietoedit 集合中的 movieid 始终为零，因此 asp.net 网站上的教程将不起作用！如果我想从视图中删除 movieID，我必须将 ID 传递给我的控制器，如下所示：

```
 <AcceptVerbs(HttpVerbs.Post)> _
Function Edit(ByVal ID as integer,ByVal movieToEdit As Movie) As ActionResult 
```

现在我可以使用这个 ID 查询模型了。没问题，但我需要一些时间才能弄清楚，因为我是从网站一步一步做的！

**问题2**那么，即使在隐藏的文本框中，如何在不使用movieID的情况下进行编辑？
我使用它作为我的控制器：（使用 Enity 框架）

```
 <AcceptVerbs(HttpVerbs.Post)> _
Function Edit(ByVal id As Integer, ByVal collection As Company) As ActionResult
    If Not ModelState.IsValid Then
        Return View()
    End If

    Try
        Dim c = _db.CompanySet.FirstOrDefault(Function(m) m.CompanyID = id)

        If c Is Nothing Then
            Return RedirectToAction("index")
        End If

        _db.ApplyPropertyChanges(c.EntityKey.EntitySetName, collection)
        _db.SaveChanges()

        Return RedirectToAction("Index")
    Catch ex As Exception
        Throw ex
    End Try
End Function 
```

如果我从我的视图（文本框或隐藏字段）中删除 CompanyID，它会从 c.EntityKey.EntitySetName 给我这个错误：
ObjectStateManager 不包含引用“Companies.Company”类型对象的 ObjectStateEntry。
如果我添加类似

```
 <%= Html.TextBox("CompanyName", Model.CompanyName) %> 
```

它会正常工作..我很困惑！

注意：我检查了代码10多次，不知道是我做错了什么还是教程错了..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T13:42:40.780

本教程是正确的，您不应该留下带有 id 的文本框，我认为他们假设 id 是您路线的一部分，例如 /movies/edit/1。如果不是这种情况，您可以使用路由集合将其添加到表单操作或在表单中添加隐藏字段。

将 id 添加到编辑操作的路由中：

```
 <% using (Html.BeginForm("Edit", "Controller", 
              new {id = Model.Id}, FormMethod.Post))
   { %> 
```

或隐藏字段：

```
 <%=Html.Hidden("CompanyID", Model.CompanyID)%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T12:44:29.267

如果您通过 UpdateModel 传递 id 并更新特定字段，它应该可以工作。您最好发布您的 Edit 方法，让我们看看发生了什么。下面的例子可以说明我试图解释的过程。

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Edit(int id, FormCollection formValues) {

    Page page = repo.GetPage(id); // returns page with specific id
    UpdateModel(page); // updates page with new form values
    repo.Save(); // saving all the changes
    return RedirectToAction("Details", new { id = page.id });

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T10:12:32.867

试试这个方法：

```
<AcceptVerbs(HttpVerbs.Post)> _
Function Edit(<Bind(Exclude:="Id")> ByVal movieToEdit As Movie) As ActionResult 
```

有关 ASP.Net MVC 的更多信息，请参阅[http://asp.net/learn/mvc](http://asp.net/learn/mvc)

# java - 如何在 Java 中发送 HTTP 标头

> ID：819474
> 
> 赞同：5
> 
> 时间：2009-05-04T09:39:36.497
> 
> 标签：java, http, http-headers, urlconnection

是否可以通过 java 中的 URL 连接发送 Http 标头？我使用套接字进行了这项工作，但遇到了防火墙问题，这似乎不是 URLConnection 的问题。通过查看 API，我得到的印象是 URLConnection 中的输出方法仅用于填写表单等，或者它们可以用于发送我自己的 HTTP 标头吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-04T09:44:07.610

是的，您想要的方法是[setRequestProperty](http://java.sun.com/javase/6/docs/api/java/net/URLConnection.html#setRequestProperty(java.lang.String,%20java.lang.String))。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-04T09:46:35.403

您想要的方法是 setRequestProperty，但我建议使用 Apaches HttpClient。使用此库，您可以完全控制要发送的请求。

[http://hc.apache.org/httpclient-3.x/tutorial.html](http://hc.apache.org/httpclient-3.x/tutorial.html)

# checkbox - QTP：获取复选框的值

> ID：819480
> 
> 赞同：1
> 
> 时间：2009-05-04T09:41:48.240
> 
> 标签：checkbox, automated-tests, qtp

[我想知道www.gmail.com](http://www.gmail.com)的主页上有多少个复选框，并且我想检查复选框是否被选中.....

我的代码是......

```
Set obj= Description.Create()
obj("name").value="PersistentCookie"
obj("html tag").value="INPUT"
obj("type").value="checkbox"

Set a = Browser("name:=Gmail.*","title:=Gmail.*").Page("title:=Gmail.*").Childobjects(obj)
MsgBox a.count

c =Browser("name:=Gmail.*", "title:=Gmail.*").Page("title:=Gmail.*").GetROProperty("checked")
MsgBox c 
```

`c`即使我选中了复选框（在这台计算机上记住我）并执行上面的代码，值始终为“OFF”，但值始终`c`为“OFF”

请帮助我提前谢谢...

请回复这个..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T13:45:44.300

您正在`GetROProperty`Page 对象上运行该函数，而不是您找到的复选框（我不知道为什么`Page`有一个`checked`属性），但是如果您在返回的测试对象上运行，`ChildObjects`您将获得正确的值（1 表示`true`0 表示`false`）。

```
c = a(0).GetROProperty("checked") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-12T17:08:13.660

```
c = Browser("name:=Gmail.*","title:=Gmail.*").Page("title:=Gmail.*").WebCheckBox("name:=PersistentCookie").GetROProperty("checked") 
```

在您的代码中添加上述行，您将在消息框中获得正确的结果，对于“ON”，您将获得`1`，对于“OFF” `0`。

# c++ - c++ 旧功能的更好替代方案？

> ID：819481
> 
> 赞同：1
> 
> 时间：2009-05-04T09:42:01.170
> 
> 标签：c++, language-features

c++ 已经走了很长一段路，它有很多功能可以以 n 种方式完成相同的任务。您认为应该避免哪些功能并列出更好的替代方案。

> 就像在指针的地方使用 SmartPointers

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-04T09:48:57.050

避免 malloc，使用 new。

避免 memcpy，使用复制构造函数。

避免`#defines`，使用`const`s。

[避免`(C-style) casts`，使用`static_cast<C++>( style casts )`。](https://stackoverflow.com/questions/791953/when-using-win32-code-in-your-modern-c-app-should-you-use-proper-casting/791969#791969)

避免使用宏，使用模板。

如果可以使用前增量，请避免后增量。

避免新的，使用值类型的集合，让集合处理内存管理。

避免指向新对象的指针，使用`boost::scoped_ptr`或`boost::shared_ptr.`

避免编写自己的代码来遍历集合，使用`<algorithm>`s

避免重新发明轮子，看看 boost 是否有你需要的东西。

避免使用“char * name”来存储字符串，使用 std::string。

[避免`using namespace foo`，使用`using foo::bar`。](https://stackoverflow.com/questions/708089/c-using-namespaces-to-avoid-long-paths/708106#708106)

避免“静态（内部链接）声明”使用未命名的命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:06:53.647

使用新风格的演员表

static_cast、const_cast、reinterpret_cast、dynamic_cast、

而不是不再被认为是完全安全的 C 风格强制转换

也更喜欢在运行时使用 STL 容器而不是动态调整数组大小

# delphi - BDE 对 .sch 模式文件使用什么标准？

> ID：819482
> 
> 赞同：2
> 
> 时间：2009-05-04T09:42:27.580
> 
> 标签：delphi, schema, file-format, bde

我想知道 - BDE 使用的 .sch 模式文件格式是否有标准（如 RFC）？

格式在[此处](http://wall.riscom.net/books/delphi/del_tis/TI2844.html)和[此处](http://www.href.com/pub/source/D1AsciiDriver.txt)进行了描述。它似乎基于[这种微软格式](http://msdn.microsoft.com/en-us/library/ms709353.aspx)，但并不完全相同。

## 示例 1 - VARYING 格式文件

客户.SCH：

```
[CUSTOMER]
Filetype=VARYING
Delimiter="
Separator=,
CharSet=ascii
Field1=Customer No,Float,20,04,00
Field2=Name,Char,30,00,20
Field3=Phone,Char,15,00,145
Field4=First Contact,Date,11,00,160 
```

客户.TXT：

```
1221.0000,"Kauai Dive Shoppe","808-555-0269",04/03/1994
1231.0000,"Unisco","809-555-3915",02/28/1994
1351.0000,"Sight Diver","357-6-876708",04/12/1994
1354.0000,"Cayman Divers World Unlimited","809-555-8576",04/17/1994
1356.0000,"Tom Sawyer Diving Centre","809-555-7281",04/20/1994 
```

## 示例 2 - FIXED 格式文件

客户.SCH：

```
[CUSTOMER]
Filetype=Fixed
CharSet=ascii
Field1=Customer No,Float,20,04,00
Field2=Name,Char,30,00,20
Field3=Phone,Char,15,00,145
Field4=First Contact,Date,08,00,160 
```

客户.TXT：

```
 1221.0000Kauai Dive Shoppe             808-555-0269   04/03/94
           1231.0000Unisco                        809-555-3915   02/28/94
           1351.0000Sight Diver                   357-6-876708   04/12/94
           1354.0000Cayman Divers World Unlimited 809-555-8576   04/17/94
           1356.0000Tom Sawyer Diving Centre      809-555-7281   04/20/94 
```

我对“文件类型”、“分隔符”、“分隔符”和“字符集”可能的参数值特别感兴趣。我已经使用各种术语（“RFC”、“模式”、“文件类型”、“标准”等）搜索了互联网，但结果一片空白……

我特别想知道的事情：

*   .sch 文件本身可以使用哪些编码？（这与正确解释字段名和其他可配置字符有关。）
*   我应该如何指定不可打印的分隔符和分隔符，例如像“单位分隔符”（$1F）这样的 Ansi 控制字符，甚至是简单的“制表符”（$09）？（考虑到格式的年龄，我认为我应该使用插入符号，但它只是想确定。）
*   如何指定不使用分隔符？我应该指定一个空值，还是完全保留设置？

TIA

PS：注意，我没有使用 BDE 本身——我必须正确生成和读取这些模式文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T20:53:51.477

在您的硬盘驱动器中搜索一个名为 bde32.hlp 的文件，该文件与 Borland Delphi 一起安装。它是一个包含 BDE API 文档的 Windows 帮助文件。它还包含一个标题为“将外部模式绑定到文本表”的主题，该主题描述了 *.sch 文件的格式。

在标题“语言驱动程序”下，相同的帮助文件还包含可以为`CharSet`*.sch 文件中的条目指定的“短名称”列表。

因此，例如，如果您想将 Windows 字符集用于西欧语言 (Windows-1252)，您将需要法语重音字符或德语元音变音符号，使用的值`CharSet`如下`ANSIINTL`：

```
[CUSTOMER]
Filetype=VARYING
Delimiter="
Separator=,
CharSet=ANSIINTL 
```

* * *

> .sch 文件本身可以使用哪些编码？（这与正确解释字段名和其他可配置字符有关。）

只是普通的ASCII。除了具有 0-127 字符代码的良好旧 ASCII 字符之外，没有任何场景需要或允许您使用任何东西，其中（除了用于分隔不同行的换行符）只有可打印字符才有意义。

例如，表名或列名中不允许使用其他字符（变音符号、重音字符等）。

> 我应该如何指定不可打印的分隔符和分隔符，例如像“单位分隔符”（$1F）这样的 Ansi 控制字符，甚至是简单的“制表符”（$09）？（考虑到格式的年龄，我认为我应该使用插入符号，但它只是想确定。）

不可能。只有“可见”字符可以用作分隔符和分隔符。要使用选项卡，只需使用空分配：

```
[CUSTOMER]
Filetype=VARYING
Delimiter="
Separator=
CharSet=ANSIINTL 
```

> 如何指定不使用分隔符？我应该指定一个空值，还是完全保留设置？

在“固定”格式中，不使用分隔符和定界符。在“变化”格式中，分隔符始终用于字符串/字符类型的列，而分隔符从不用于其他列类型。要不使用分隔符，只需在模式中使用空分配：

```
[CUSTOMER]
Filetype=VARYING
Delimiter=
Separator=,
CharSet=ANSIINTL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T12:45:10.433

你的问题很难得到明确的答案。BDE 已被弃用多年，大多数最初的开发人员已经转向其他工作。

如果我没记错的话，BDE 的文本（后来的 ASCII）支持在它第一次被称为 ODAPI 和后来的[IDAPI](http://info.borland.com/bde/papers/idapi/)（独立数据库 API，90 年代早期 Borland、Novell、IBM 和 WordPerfect 的共同开发）时就已经存在了。

与此同时，Borland 成为 Inprise，将重心转移到企业市场，再次成为 Borland，将开发工具和数据库组分离到 CodeGear，并将 CodeGear 出售给 Embarcadero（最终再次以开发人员为中心）。

稍后我将尝试提出一些体面的东西并扩展此答案，或者在[DelphiLive 处询问！](http://delphilive.com/)下周。

不挂断 ：-）

**编辑1**：更多信息

idasci32.dll 支持 ASCII

这些字段的值：

文件类型：

*   固定的
*   分隔的

分隔符：未知

分隔符：未知

字符集：

*   ASCII

# c++ - 是否有用于更改区域设置（特别是 IME）的 WinXP/WinXP 嵌入式 API？

> ID：819483
> 
> 赞同：1
> 
> 时间：2009-05-04T09:42:43.603
> 
> 标签：c++, winapi, visual-c++

我正在寻找一个在 WinXP 上的 API 来在已安装的 IME 之间切换。

场景是，能够插入语言键盘（比如西班牙语）并通过单击 UI 按钮（比如名为西班牙语的按钮）更改 IME

例如，我插入一个西班牙语键盘并单击名为西班牙语的 UI 按钮。这应该在内部将 IME 更改为已安装的西班牙语

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T11:38:45.443

我试图更改语言环境/ IME（属于语言环境）。我发现有一个名为“SystemParametersInfo”的 api，它允许我们在系统级别进行设置。就我而言，我必须转到控制面板 > 区域设置 > 然后在语言选项卡下的已安装语言环境之间切换。这最终可以以编程方式实现，如代码所示：

```
#include "stdafx.h"
#include "windows.h"

int _tmain(int argc, _TCHAR* argv[])
{

HKL hLangId = 0;
bool isFine;
DWORD errorCode;

errorCode = GetLastError();

isFine = SystemParametersInfo(SPI_GETDEFAULTINPUTLANG, 0, &hLangId, 0);

errorCode = GetLastError();

HKL spanishLanguage = (HKL) (0x040a0c0a);

isFine = SystemParametersInfo(SPI_SETDEFAULTINPUTLANG, 0, &spanishLanguage, 0);

errorCode = GetLastError();

return 0; 
```

}

# c++ - 在 C/C++ 中高效地在十六进制、二进制和十进制之间进行转换

> ID：819487
> 
> 赞同：9
> 
> 时间：2009-05-04T09:43:47.797
> 
> 标签：c++, c, binary, decimal, hex

我有 3 个正整数的基本表示形式：

1.  十进制，在 unsigned long 变量中（例如*unsigned long int NumDec = 200*）。
2.  十六进制，在字符串变量中（例如*字符串 NumHex = "C8"*）
3.  二进制，在字符串变量中（例如*string NumBin = "11001000"*）

我希望能够以最有效的方式在所有 3 种表示形式中的数字之间进行转换。即实现以下6个功能：

```
unsigned long int Binary2Dec(const string & Bin) {}
unsigned long int Hex2Dec(const string & Hex) {}
string Dec2Hex(unsigned long int Dec) {}
string Binary2Hex(const string & Bin) {}
string Dec2Binary(unsigned long int Dec) {}
string Hex2Binary(const string & Hex) {} 
```

对于他们每个人来说，最有效的方法是什么？我可以使用 C 和 C++，但不能使用 boost。

编辑：“效率”是指时间效率：最短的执行时间。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T21:23:14.620

正如其他人指出的那样，我将从[`sscanf()`](http://en.cppreference.com/w/cpp/io/c/fscanf),[`printf()`](http://en.cppreference.com/w/cpp/io/c/fprintf)和/或[`strtoul()`](http://en.cppreference.com/w/cpp/string/byte/strtoul). 它们对于大多数应用程序来说足够快，而且它们不太可能出现错误。然而，我要说的是，这些函数比你想象的更通用，因为它们必须处理非 ASCII 字符集，以及以任何基数表示的数字等等。对于某些领域，可以击败库函数。

因此，首先进行测量，如果这些转换的性能确实是一个问题，那么：

1) 在某些应用程序/领域中，某些数字经常出现，例如零、100、200、19.95，可能很常见，因此优化您的函数以使用一堆 if() 语句转换这些数字是有意义的，然后回退到通用库函数。2）如果最常见的 100 个数字使用表查找，然后回退到库函数。请记住，大型表可能不适合您的缓存，并且可能需要多个间接共享库，因此请仔细测量这些内容以确保不会降低性能。

您可能还想查看 boost lexical_cast 函数，尽管根据我的经验，后者与良好的旧 C 函数相比是相对的。

很多人都说过，值得一遍又一遍地重复：在你有证据证明它们是一个问题之前，不要优化这些转换。如果您进行优化，请测量您的新实现以确保它更快*，并*确保您为自己的版本进行大量单元测试，因为您将引入错误 :-(

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T10:04:18.903

我建议只使用[sprintf](http://www.cplusplus.com/reference/clibrary/cstdio/sprintf/)和[sscanf](http://www.cplusplus.com/reference/clibrary/cstdio/sscanf/)。

此外，如果您对它的实现方式感兴趣，可以查看 glibc 的源[代码](http://ftp.gnu.org/gnu/glibc/)[，即 GNU C 库](http://www.gnu.org/software/libc/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T16:45:09.343

为什么这些例程必须如此省时？这种说法总是让我感到好奇。你确定像 strtol() 这样明显的转换方法太慢，还是你可以做得更好？系统功能通常非常有效。它们有时支持通用性和错误检查的速度较慢，但​​您需要考虑如何处理错误。如果一个`bin`参数的字符不是 '0' 和 '1'，那又是什么呢？中止？传播大量错误？

为什么用“Dec”来表示内部表示？应该使用 Dec、Hex 和 Bin 来指代字符串表示。没有小数点`unsigned long`。您是否正在处理以十进制显示数字的字符串？如果不是，你会在这里混淆人们，并且会混淆更多人。

二进制和十六进制文本格式之间的转换可以通过查找表快速有效地完成，但涉及十进制文本格式的任何事情都会更加复杂。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T09:49:09.093

这取决于您要优化什么，“高效”是什么意思？转换速度快、占用内存少、程序员时间少、其他程序员阅读代码的[WTF少，或者什么重要吗？](http://thedailywtf.com/)

为了可读性和易于实现，您至少应该`Dec2Hex()`通过`Dec2Binary()`调用`[strotul()](http://www.manpagez.com/man/3/strtoul/)`. 这使它们成为单行，这对于至少上述单词的某些解释非常有效。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T10:01:19.503

听起来很像一个家庭作业问题，但到底是什么......

简短的回答是使用两个查找表从 long int 转换为您的字符串。每个表应该有 256 个条目。一个将一个字节映射到一个十六进制字符串：0 ->“00”、1 ->“01”等。另一个将一个字节映射到一个位字符串：0 ->“00000000”、1 ->“00000001”。

然后对于 long int 中的每个字节，您只需查找正确的字符串，并将它们连接起来。

要将字符串转换回长字符串，您只需将每个字符的数值乘以 16 或 2 的适当幂，然后将结果相加，即可将十六进制字符串和位字符串转换回十进制数。

编辑：您还可以使用相同的查找表进行反向转换，方法是进行二进制搜索以找到正确的字符串。这将需要对您的字符串进行 log(256) = 8 次比较。不幸的是，我没有时间分析比较字符串是否比乘法和加法快得多。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T17:28:53.263

让我们考虑一下任务的一半——从字符串化的基数 n 转换为无符号长整数，其中 n 是 2 的幂（二进制的基数为 2，十六进制的基数为 16）。

如果你的输入是理智的，那么这项工作只不过是一个比较、一个减法、一个移位和一个或每个数字。如果你的输入不健全，那么，这就是它变得丑陋的地方，不是吗？进行超快转换并不难。在所有情况下都做好是一项挑战。

因此，让我们假设您的输入是理智的，那么您转换的核心是：

```
unsigned long PowerOfTwoFromString(char *input, int shift)
{
    unsigned long val = 0;
    char upperLimit = 'a' + (1 << shift)
    while (*input) {
        char c = tolower(*input++);
        unsigned long digit = (c > 'a' && c < upperLimit) ? c - 'a' + 10 : c - '0';
        val = (val << shift) | digit;
    }
    return val;
 }

 #define UlongFromBinaryString(str) PowerOfTwoFromString(str, 1)
 #define UlongFromHexString(str) PowerOfTwoFromString(str, 4) 
```

看看这有多容易？它会在非理智的输入上失败。你的大部分工作都是为了让你的输入变得理智，而不是表现。

现在，这段代码利用了两次移位的力量。很容易扩展到base 4，base 8，base 32等。它不适用于两个base的非幂。对于那些，你的数学必须改变。你得到

```
val = (val * base) + digit 
```

这组操作在概念上是相同的。乘以基数将等同于移位。所以我很可能会使用一个完全通用的例程。并在清理输入的同时清理代码。到那时，strtoul 可能是你最好的选择。这是strtoul[版本的链接。](http://cvsweb.xfree86.org/cvsweb/*checkout*/cvs/lib/strtoul.c?rev=1.1.1.1)几乎所有的工作都在处理边缘条件——这应该让你知道你的精力应该集中在哪里：正确、有弹性的代码。与说不因输入错误而崩溃的节省相比，使用位移的节省将是最小的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T16:09:15.687

为什么不只使用宏也将格式作为输入。如果你至少在 C 中。

```
#define TO_STRING( string, format, data) \
sprintf( string, "##format##", data)
// Int
TO_STRING(buf,%d,i);
// Hex ( Two char representation )
TO_STRING(buf,%02x,i);
// Binary
TO_STRING(buf,%b,i); 
```

或者你可以直接使用 sprintf：或者你可以有多个宏。

```
#define INT_STRING( buf, data) \
sprintf( buf, "%d", data)
#define HEX_STRING( buf, data) \
sprintf( buf, "%x", data)
#define BIN_TO_STRING( buf, data) \
sprintf( buf, "%b", data)

BIN_TO_STRING( loc_buf, my_bin ); 
```

# django - 盖伊+姜戈。app-engine-patch 还是 django-gae-helpers？

> ID：819490
> 
> 赞同：7
> 
> 时间：2009-05-04T09:44:12.757
> 
> 标签：django, google-app-engine

我正在使用 GAE 构建应用程序，并希望为此使用 Django。哪个“补丁”更好？app-engine-patch 还是 django-gae-helpers？我的意思是它们的功能和未来（其中一个会很快死去）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T19:04:57.480

如果通过 django-gae-helpers 你指的是[http://code.google.com/p/django-gae-helpers/](http://code.google.com/p/django-gae-helpers/)那么你还没有什么可以使用的。

我没有尝试过 app-engine-patch，但我使用过 goole-app-engine-django。它需要一些试验和错误才能使其工作，但它工作得很好（虽然我想念管理员）。

我会试试 app-engine-patch，他们说比 google-app-engine-django 更好，并且包括管理员等等......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-07T13:02:57.730

app-engine-patch 为您提供最新的稳定 django，并且除了数据库模型（您必须使用 google 数据存储）之外几乎兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-18T22:11:07.853

[在搜索比较http://code.google.com/p/google-app-engine-django/](http://code.google.com/p/google-app-engine-django/)与[http://code.google.com/p/app-engine-patch/](http://code.google.com/p/app-engine-patch/)的内容时发现了这个问题。有人有这两种经验吗？

# java - 用 Java 读/写 Tiff

> ID：819499
> 
> 赞同：2
> 
> 时间：2009-05-04T09:48:19.330
> 
> 标签：java, open-source, image, awt, tiff

任何关于使用 Apache 或类似许可的开源库的想法，用于在 Java 5 中读取和写入 TIFF 文件（最好使用 AWT 图像处理库，包括 *ImageIO*。）

我知道 Java 6 应该支持 TIFF。我知道 Sun 的 JAI 实施，但该 [许可证](https://jai.dev.java.net/jdl-jai.pdf)不适用于我工作的公司；和 Asprise，但那是一种商业产品。Sanselan 看起来不错，但那还不是发布的产品。

对另一个 TIFF 阅读器实施有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T13:18:31.667

[Freeimage](http://freeimage.sourceforge.net/)在 Java 中应该相当容易使用——我在 C# 和 VB6 中使用过它。

开源图像库的唯一问题是它们无法读取许多商业扫描仪创建的 JPEG 编码 Tiff（来自 TIFF 6.0 标准），尤其是脏图像。

Libtiff 可以重新编译以支持它，但我从未尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T09:51:14.847

您应该能够使用[**iText**](http://itextdocs.lowagie.com/tutorial/objects/images/index.php)读取/写入 tiff。

# asp.net - 找不到方法：System.IO.Stream CrystalDecisions.CrystalReports.Engine.ReportDocument.ExportToStream(CrystalDecisions.Shared.ExportFormatType)

> ID：819509
> 
> 赞同：0
> 
> 时间：2009-05-04T09:51:38.870
> 
> 标签：asp.net, crystal-reports

我使用 ASP.Net 1.1 的原因可能是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-11T20:14:10.240

将晶体组件的属性“复制本地”设置为 true

# sql-server-2005 - SQL Server 2005，缩小复制数据库

> ID：819513
> 
> 赞同：0
> 
> 时间：2009-05-04T09:53:18.833
> 
> 标签：sql-server-2005, replication, maintenance

现在我目前正在使用带有可更新订阅的事务复制。是否有任何方法（包括 T-SQL）可以用来缩小复制架构中使用的分发数据库？该文件名为**distribution.MDF**

**我还发现文件夹repldata**上存储了相当大的数据，删除这些文件是否保存？如何？或者至少一些我如何缩小它

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T13:49:37.230

**分发**数据库只是一个普通的系统数据库，所以是的，您可以像在 Management Studio 中的所有其他数据库（它位于 System Databases 文件夹下）一样收缩它。

但是，由于该数据库用于存储复制所需的数据，因此当放入更多数据时它可能会再次增长，因此可能并不总是建议缩小它。

**repldata**应该包含用于复制的快照，并且是新订阅和重新初始化先前订阅所必需的。除非您使用快照发布，否则我相信您可以安全地删除内容。但是，我没有找到任何确认它受支持的文档，因此这样做可能不是一个好主意（但是，由于 SQL Server 2000 和更新版本支持快照的备用位置，其中包括它不应该关心的可移动媒体)

# c# - Mono System.IO.Ports SerialPort 类错误处理

> ID：819515
> 
> 赞同：1
> 
> 时间：2009-05-04T09:54:42.437
> 
> 标签：c#, linux, mono, serial-port

我正在调试一些使用串口的单声道代码。在某些时候，单声道使用以下代码编写表格：

```
 // Send the 1024 byte (256 word) CRC table

    progressBar = new ProgressBar();

    progressBar.Update(0.0,"Sending CRC table...");

    for (int i = 0; i < MyCRC.Length; i++)

    {

        MySP.Write(MyCRC[i].ToString("x8"));

        progressBar.Percent = (((Double)(i+1))/MyCRC.Length);

    }

    progressBar.Update(100.0,"CRC table sent."); 
```

MySP 是一个 SerialPort 实例。然而，当我使用 strace 跟踪此代码时，我认为这是生成的系统调用：

```
16620 write(3, "3ab551ce", 8)           = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\0003ab551c", 8)        = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\0\0003ab551", 8)       = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\0\0\0003ab55", 8)      = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\10\0\0\0003ab5", 8)    = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\0\10\0\0\0003ab", 8)   = -1 EAGAIN (Resource temporarily unavailable)

...

16620 write(3, "\0005\0\230O+\10\0", 8) = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "E\0005\0\230O+\10", 8)  = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\0E\0005\0\230O+", 8)   = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\0\0E\0005\0\230O", 8)  = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "\0\0\0E\0005\0\230", 8) = -1 EAGAIN (Resource temporarily unavailable)
16620 write(3, "4\0\0\0E\0005\0", 8)    = 8
16620 write(3, "\230O+\10\0\0\0\0", 8)  = 8
16620 write(3, "\0\0\0\0\10\0\0\0", 8)  = -1 EAGAIN (Resource temporarily unavailable) 
```

我的理解是 SerialPort Write 方法不能正确处理 -EAGAIN 情况，并在重新开始写入之前将索引更新为 -1。因为每次尝试后，原始缓冲区的内容都会移动一个字节。

我的问题是，这是一个已知问题吗？如何修改 SerialPort 类以使其行为正确或以阻塞方式使用串行端口？

[SerialPort 类](http://www.go-mono.com/docs/index.aspx?tlink=35@ecma%3a4314%23SerialPort%2f*)的Mono 文档不是很有帮助

附加信息：单声道-V输出：

```
Mono JIT compiler version 1.2.6 (tarball)
Copyright (C) 2002-2007 Novell, Inc and Contributors. www.mono-project.com
    TLS:           __thread
    GC:            Included Boehm (with typed GC)
    SIGSEGV:       altstack
    Notifications: epoll
    Architecture:  x86
    Disabled:      none 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:48:23.020

Consider upgrading to a newer version.

The bug was fixed [here](http://anonsvn.mono-project.com/viewvc/trunk/mono/support/serial.c?r1=87452&r2=99480).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T10:08:40.950

I have a workaround, but I don't consider it is a good solution :

```
progressBar = new ProgressBar();

progressBar.Update(0.0,"Sending CRC table...");

for (int i = 0; i < MyCRC.Length; i++)

{

    MySP.Write(MyCRC[i].ToString("x8"));
    while(WySP.BytesToWrite != 0)
    {
        ;
    }
    progressBar.Percent = (((Double)(i+1))/MyCRC.Length);

}

progressBar.Update(100.0,"CRC table sent."); 
```

# repository - 设置好 svnserve 服务器后，客户端将使用什么 URL 来访问服务器？

> ID：819517
> 
> 赞同：3
> 
> 时间：2009-05-04T09:55:54.070
> 
> 标签：repository, svn

**客户**---| 互联网 |---**服务器**

所以我已经设置了一个 svnserver 服务器并且它已经在运行了。我在 cmd 上输入了 svsnserve.exe --daemon --root "C:\Documents and Settings\Subversion Directory"。我还建立了一个存储库，我可以通过 TortoiseSVN 浏览它。我是服务器计算机。我现在要做的是让客户端计算机访问服务器。客户端只安装了 TortoiseSVN，没有安装 SVN 服务器。我现在要做的是从服务器签出存储库，我在 URL 中写什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T10:01:28.800

最有可能的：

```
svn://<hostname>/<repository_name> 
```

看到[这个 StackOverflow](https://stackoverflow.com/questions/174773/svn-url-format)问题（非常相似）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T10:01:21.607

对于基于 Internet 的存储库，您最好通过网络服务器进行托管。[VisualSVN Server](http://www.visualsvn.com/server/)是免费的，它提供了一种使用 Apache（它安装和配置）在 Windows 上托管 SVN 的简单方法。它会告诉您管理工具中的 SVN http 路径 - 当然，您需要确保设备之间有视线/DNS，这可能意味着更多的配置/防火墙规则/端口转发等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-01T01:01:56.137

启动守护进程：

```
svnserve -d -r my_repo 
```

使用 RapidSVN 连接：（书签 > 添加现有存储库...）*此处无需指定“my_repo”*

```
svn://localhost 
```

# wpf - 在 WPF 中，如何获取 tabItem 的内容以填充可用空间？

> ID：819520
> 
> 赞同：4
> 
> 时间：2009-05-04T09:58:03.003
> 
> 标签：wpf, tabitem, autosize

我不知道我在这里做错了什么。在下面的 XAML 中，边框没有填充 tabItem 上的可用空间（只是很多空白）。如何填充整个标签页？

```
<TabControl>
    <TabItem Header="Plant State">
        <Border Background="Red" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"></Border>
    </TabItem>
</TabControl> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T10:13:54.993

我在马特汉密尔顿的帮助下解决了这个问题。如果您使用常规 TabControl（默认模板），这实际上可以正常工作。

我正在使用更改默认控件模板的 xaml“主题”。这导致布局失败，所以我将不得不调查并找出问题所在。

# animation - 如何使用 Blend / VS2008 将 WPF 应用程序中的动画集成更上一层楼？

> ID：819523
> 
> 赞同：0
> 
> 时间：2009-05-04T09:59:41.160
> 
> 标签：animation, expression-blend

我已经能够使用 Blend 中的故事情节创建小动画。

而且我已经能够将孤立的故事情节和触发器复制到 Visual Studio 中的现有项目中，以稍微修饰它们的边缘。

**但是添加太多动画后**，它们开始发生冲突或相互抵消等，或者我可以让一个面板向下滑动并将其向上滑动，然后它不再可以向下滑动，因为它不再处于原始状态.

有没有人有任何**链接，视频教程，书籍，资源**，不仅向您展示如何制作一个小动画，然后让您弄清楚如何将众多动画集成到典型的业务应用程序布局中，而是**带您完成整个过程在将动画和 WPF 优点与 Blend 和 Visual Studio 集成的同时构建业务应用程序**？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T10:39:53.980

以下是一些视频教程： [http ://expression.microsoft.com/en-us/cc188684.aspx](http://expression.microsoft.com/en-us/cc188684.aspx)

您可能还想使用 SDK 附带的 Xamlpad.exe 来了解 XAML 的工作原理。

在使用 blend 的同时了解所有组件的工作原理非常重要，否则可能会使您感到困惑，或者您可能会尝试做框架可能遇到问题的事情。

祝你好运。

# c# - 奇怪的 Powershell 性能问题

> ID：819524
> 
> 赞同：1
> 
> 时间：2009-05-04T10:00:17.150
> 
> 标签：c#, performance, powershell

**注意：**这是 Project Euler [Problem 14](https://projecteuler.net/problem=14)的解决方案。如果您仍然想自己解决它，请不要继续阅读。

问题是找到低于 100 万的数字，它作为[Collat​​z 序列](http://en.wikipedia.org/wiki/Collatz_sequence)的起始数字，会产生最长的此类序列。我的初始代码如下：

```
$r = @{}

for($i = 1; $i -lt 1000000; $i++) {
    $n = 0
    $a = $i
    while ($a -gt 1) {
        if ($r[$a]) {
            $n += $r[$a]
            break
        }
        if ($a % 2 -eq 0) {
            $a /= 2
        } else {
            $a = $a * 3 + 1
        }
        $n++
    }
    $r[$i] = $n
}

$r.GetEnumerator() | sort Value | select -l 1 | %{$_.Key} 
```

它尝试使用哈希表作为已经遇到的子序列的缓存以节省时间。当该脚本在我的机器上运行超过 8 分钟时，我感到非常惊讶。在 C# 中重新创建相同的代码：

```
using System;
using System.Collections.Generic;

class Problem14
{
    public static void Main()
    {
        var ht = new Dictionary<long, int>();

        for (int i = 1; i < 1000000; i++)
        {
            int count = 0;
            long j = i;

            while (j > 1)
            {
                if (ht.ContainsKey(j))
                {
                    count += ht[j];
                    break;
                }
                if (j % 2 == 0)
                    j /= 2;
                else
                    j = 3 * j + 1;

                count++;
            }
            ht[i] = count;
        }

        KeyValuePair<long, int> max = new KeyValuePair<long, int>();
        foreach (var n in ht)
        {
            if (n.Value > max.Value)
                max = n;
        }
        Console.WriteLine(max.Key);
    }
} 
```

运行时间刚刚超过一秒。我知道执行速度并不是 Powershell 的主要目标。它是一种管理语言，对于这些任务，PS 代码与 cmdlet 的比率可能与我在这里所做的非常不同。

不过，我不知道究竟是什么导致了放缓。

怀疑哈希表，我将其替换为数组进行缓存。这导致在 C# 中执行时间约为 200 毫秒，在 Powershell 中执行时间约为 32 分钟。代码如下：

```
$r = ,0*1000000

for($i = 1; $i -lt 1000000; $i++) {
    $n = 0
    $a = $i
    while ($a -gt 1) {
        if ($r[$a]) {
            $n += $r[$a]
            break
        }
        if ($a % 2 -eq 0) {
            $a /= 2
        } else {
            $a = $a * 3 + 1
        }
        $n++
    }
    if ($i -lt 1000000) {
        $r[$i] = $n
    }
}

$max = 0
for($i=1; $i -lt 1000000; $i++) {
    if ($r[$i] > $r[$max]) {
        $max = $i
    }
}
$max 
```

和

```
using System;

class Problem14
{
    public static void Main()
    {
        var cache = new int[1000000];

        for (int i = 1; i < 1000000; i++)
        {
            int count = 0;
            long j = i;

            while (j > 1)
            {
                if (j < 1000000 && cache[j] != 0)
                {
                    count += cache[j];
                    break;
                }
                if (j % 2 == 0)
                    j /= 2;
                else
                    j = 3 * j + 1;

                count++;
            }
            cache[i] = count;
        }

        var max = 0;
        for (int i = 1; i < cache.Length; i++)
        {
            if (cache[i] > cache[max])
                max = i;
        }

        Console.WriteLine(max);
    }
} 
```

在 C# 中，完全无缓存的变体大约需要 1.2 秒。尚未在 Powershell 中尝试过。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T21:04:13.800

首先，PowerShell 是一种解释型语言（不是 jitted，也不是编译型）。那总是会受伤的。;-)

其次，您可以使用一些语言结构来避免多个解释步骤。例如，不要使用 for(;;) 语句，而是使用范围：

```
0..1000000 | foreach-object { foo $_ 
```

可能有点帮助。

最重要的是，避免在循环中过度使用 break 和 continue 关键字——如果可能的话，反转你的逻辑以避免这种情况。在内部，这些关键字使用 .NET 异常发出信号，因此是昂贵的操作。

希望这对您的理解有所帮助。

编辑：这些关键字使用 .NET 异常来发出信号

从 System.Management.Automation.FlowControlNode.Execute(...)：

```
switch (this._tokenId)
    {
        case TokenId.ExitToken:
        {
            int exitCode = this.GetExitCode(result);
            throw new ExitException(base.NodeToken, exitCode);
        }
        case TokenId.ReturnToken:
            throw new ReturnException(base.NodeToken, result);

        case TokenId.BreakToken:
            label = this.GetLabel(result, context);
            throw new BreakException(base.NodeToken, label);

        case TokenId.ContinueToken:
            label = this.GetLabel(result, context);
            throw new ContinueException(base.NodeToken, label); 
```

-Oisin

# c++ - 构建 exe 时如何禁用 exp/lib 生成？

> ID：819525
> 
> 赞同：2
> 
> 时间：2009-05-04T10:00:32.017
> 
> 标签：c++, visual-studio, win32ole

我意识到这可能是由某处的 _dllexport() 引起的，而不是在我的代码中，而是在某些第三方代码中。(Qt, Boost, OpenSG, ...)

是否有一个简单的链接器选项来禁用它？我已经搜索但没有找到任何地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T12:33:14.300

AFAIK，不，因为相关的#pragma 覆盖了链接器设置。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-04T11:46:33.307

我建议您确保中间文件和输出文件具有不同的文件夹。

我用这种方式设置项目（项目属性/一般配置页面）：

```
Output Directory = $(SolutionDir)\Build\$(ConfigurationName)
Intermediate Directory = $(SolutionDir)\Build\$(ConfigurationName)\$(ProjectName) 
```

# c# - .NET BindingSource.Filter 与正则表达式

> ID：819526
> 
> 赞同：5
> 
> 时间：2009-05-04T10:00:53.997
> 
> 标签：c#, .net, regex, bindingsource

我正在使用 BindingSource.Filter 仅列出数据源的某些元素。特别是我经常这样使用它：

```
m_bindingSourceTAnimation.Filter = "Name LIKE '" + FilterText + "'"; 
```

现在我的问题是，是否可以通过这些过滤器使用正则表达式。

我尤其需要多个通配符 (*) 字符，例如

```
*hello*world* 
```

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-11T02:17:17.433

您可以很容易地使用 LINQ 查询 DataTable，然后您可以在查询中使用实际的 Regex 来随意过滤它。

像这样的东西...

```
var source = myDataTable.AsEnumerable();

var results = from matchingItem in source
              where Regex.IsMatch(matchingItem.Field<string>("Name"), "<put Regex here>")
              select matchingItem;

//If you need them as a list when you are done (to bind to or something)
var list = results.ToList(); 
```

这将为您提供基于实际正则表达式匹配的行，我不知道您需要对这些信息做什么，但这将允许您根据正则表达式获取行。

****更新** - 试图根据评论澄清

我不知道您使用它的目的是什么，所以我没有很好的上下文，但据我猜测您正在使用 DataTable 将数据绑定到 Grid 或类似的东西。如果是这种情况，我认为您应该能够从我放在这里的代码段中分配“列表”作为数据源（假设您使用的是 BindingSource）并且我认为它会起作用。我不使用 DataTables，我通常坚持使用对象来处理我的数据，所以我不确定它将如何处理行列表，但我认为它会起作用（或者足够接近谷歌搜索会这样做）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-04T10:07:03.780

`BindingSource`依赖于[`IBindingListView.Filter`](http://msdn.microsoft.com/en-us/library/system.componentmodel.ibindinglistview.filter.aspx)这个功能。该行为*完全*取决于特定的列表实现。这是`DataTable`/`DataView`吗？如果是这样，这将映射到[`DataView.RowFilter`](http://msdn.microsoft.com/en-us/library/system.data.dataview.rowfilter.aspx)，语法在[此处](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression(vs.71).aspx)列出。

该`DataView`实现没有正则表达式支持，但支持`LIKE`via `*`- 即 where `FilterText`is like `"Foo*Bar*"`. 至少，这是我的理解。

* * *

我仍然假设您正在使用`DataTable`/ `DataView`... 一个务实的替代方案可能是为此目的引入一个额外的（布尔）列。将该标记设置/清除为谓词（使用正则表达式或任何其他复杂的逻辑），然后使用行过滤器说出“设置位置”。也许不是很干净，但比实现自定义数据视图/绑定源要简单得多。

* * *

如果您正在使用对象（而不是`DataTable`），那么另一个选项可能是[Dynamic LINQ Library](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)。我不知道它支持的全部范围，但它（`Where(string)`）肯定有一些/大部分的`RowFilter`能力。并且由于示例项目中提供了代码，您*可以*教育它应用正则表达式吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-17T15:55:13.817

我通过用通配符拆分搜索字符串解决了这个问题，然后使用拆分值创建了行过滤器表达式。

```
Array a = SearchString.Split('*');
string rowFilter = "";

if (a.GetUpperBound(0) == 1)
{

  rowFilter = "(MODEL_NBR like '" + a.GetValue(0).ToString() + "*' AND MODEL_NBR like '*"      + a.GetValue(1).ToString() + "')";

 } 
```

如果您使用多个通配符，您可以创建一个递归函数来创建过滤器表达式

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T21:19:26.127

The comment below doesn't really work:

*"...a pragmatic alternative might be to introduce an extra (bool) column for the purpose. Set/clear that marker as the predicate (using a regex or any other complicated logic), and just use the row-filter to say "where set". Not very clean, maybe, but a lot simpler than implementing a custom data-view / binding-source."*

When you set the new column this causes the row state to change and you basically end up with the whole table/dataview thinking that it needs to do every row in the next update. Not sure how to get around this problem.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-22T06:59:11.453

```
 '[Description] Is column name
    Dim SearchStrArr() As String = Split(txtSearch.Text, " ")
    Dim FilterString As String = "" 
    FilterString = String.Join("%' AND [Description] Like '%", SearchStrArr)
    FilterString = "[Description] Like '%" & FilterString & "%'"

    m_bindingSourceTAnimation.Filter = FilterString 
```

# linq-to-sql - Linq to Sql，如何检查给定的表/类是否在 DataContext 的变更集中

> ID：819534
> 
> 赞同：2
> 
> 时间：2009-05-04T10:03:14.833
> 
> 标签：linq-to-sql

我正在使用 LinqToXSD 解析 XML 文件。我正在使用 Linq to SQL 将 XML 中的元素插入数据库中相应的表中。

我使用在 DataContext 中插入许多不同的表/元素

```
DB.<tables>.InsertOnSubmit(table); 
```

其中表可以是大约 75 个不同表中的任何一个。

XML 中充满了重复项，我想检查 XML 中的给定元素是否已添加到 DataContext 的变更集中。

有这样做的通用方法吗？我现在这样做的方式涉及为每个不同的表编写代码，这使我认为我可以以某种方式提取一个方法并只编写一次该代码。

为了解析 XML，我对 xml 中的每个元素都有一个方法，它对应于数据库中的一个表。接下来的两个方法分别处理不同类型的 xml 元素。

```
 private static tbl_trackname ParseTrackName(TRACKNAMEType tRACKNAMEType)
    {
        tbl_trackname tableTrackName = new tbl_trackname();

        tableTrackName.code = tRACKNAMEType.code;
        tableTrackName.text = tRACKNAMEType.text;

        DB.tbl_tracknames.InsertOnSubmit(tableTrackName);
        return tableTrackName;
    }

 private static tbl_track ParseTrack(TRACKType tRACKType)
    {
        tbl_track tableTrack = new tbl_track();

        tableTrack.trackID = int.Parse(tRACKType.trackid);
        tableTrack.tbl_organisation = ParseOrganisation(tRACKType.organisation);
        tableTrack.tbl_trackname = ParseTrackName(tRACKType.trackname);
        tableTrack.tbl_nation = ParseNation(tRACKType.country);

        DB.tbl_tracks.InsertOnSubmit(tableTrack);
        return tableTrack;
    } 
```

第一种方法在名为 tbl_trackname 的表中插入行，第二种方法在名为 tbl_track 的表中插入行。

此处缺少的代码是检查 Datacontext 是否已将轨道或轨道名称插入 Datacontext 中的代码。我还应该检查它是否已经在数据库中，但这只是一行代码，所以我可以忍受对每个 ParseXXX() 方法都这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T10:09:26.597

好吧，你可能可以用`dataContext.GetChangeSet().Inserts.OfType<Foo>()`? 也许有什么`Any`或`Contains`最后？

你能举更多的例子吗？

# java - 如何从 C++ 调用 Java 函数？

> ID：819536
> 
> 赞同：49
> 
> 时间：2009-05-04T10:03:55.470
> 
> 标签：java, c++

如何从 C++ 应用程序调用 Java 函数？

我知道从 CMD（或类似技术）调用它们，但我宁愿不使用它们。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-04T10:40:51.077

例如，检查[从 C 创建 JVM](http://www.inonit.com/cygwin/jni/invocationApi/c.html)。它显示了创建 JVM 和调用方法的示例过程。如果JVM已经存在；例如，您的 C 程序被 Java 程序调用（回调情况），您可以缓存 JNIEnv* 指针。

作为建议，请小心从 C/C++ 缓存指向 JVM 的指针，其中涉及到一些关于您可以缓存哪些内容以及稍后可以调用它的语义。为此，正如 Brian Agnew 指出的那样，请检查 JNI 参考。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-04T10:13:41.330

查看[JNI 调用接口](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/spec/invocation.html)。这将允许您在 C（或 C++）应用程序中嵌入 JVM。

请注意，存在各种更简单的机制来促进从 Java 调用 C/C++（例如[JNA](https://github.com/twall/jna/)）。可能值得考虑反转您的问题，以便您可以*从*Java 调用（我知道这对于您的特定应用程序可能不太可能，但是）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-14T19:21:29.377

此页面很有帮助： [http ://hildstrom.com/projects/jni/index.html](http://hildstrom.com/projects/jni/index.html)

假设您有一个 Java 类：

```
package foo;
public class bar {
    public static int timesTen(int input){
        return input * 10;
    }
} 
```

一旦你有一个 JVM 和 JNIEnv*（细节省略......），你可以从 C++ 调用 Java 方法，如下所示：

```
jclass myClass = env->FindClass("foo.bar");
jmethodID mid = env->GetStaticMethodID(myClass, "timesTen", "(I)I");
jint hundred = env->CallStaticIntMethod(myClass, mid, (jint)10); 
```

这掩盖了*很多*细节，包括异常处理，如果忽略这些细节会使你的 JVM 崩溃。有关“Java Native Interface”的所有血腥细节，请搜索 Oracle 链接。

既然有人问......这就是你如何获得 Env*。请注意，如果 JVM 调用您的本机代码，它已经有一个 Env*。

```
JNIEnv* env(0);
jint rv = vm->GetEnv((void**)&env, JNI_VERSION_1_6);
if (rv == JNI_OK) {
    return env;
} else if (rv == JNI_EDETACHED) {
    // This happens if you created the thread, not the JVM
    rv = vm->AttachCurrentThread((void**)&env, 0);
    if (rv != JNI_OK) {
        // error
    }
} else {
    // error
} 
```

我不能过分强调使用 JNI 从 C/C++ 调用 Java 非常繁琐且容易出错。错误是神秘的和低级的。您*必须*处理异常，并且*必须*分离线程，否则事情会变得丑陋。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2016-07-29T06:53:04.553

从 CPP 调用 java 方法的另一种简单方法是通过批处理文件。

```
system() 
```

是从 CPP 调用 exe 或 bat 文件的方法。将带有 java 路径和类路径的类放入批处理文件中，并使用`system("batch-file-name.bat")`.

这很容易和直接。

# php - 在这种情况下我可以得到这个变量值吗？(php)

> ID：819537
> 
> 赞同：0
> 
> 时间：2009-05-04T10:04:14.923
> 
> 标签：php, variables

我将一个变量传递给 domain.com/index.php?user=username

在我的页面 (index.php) 中包含其他页面，如 about.php、profile.php、contact.php 等。

我的问题是，我是否可以将变量传递给 index.php，然后 about.php、profile.php 也可以使用 $_GET['user']; 检索变量；方法？？（实际上我试过了，它失败了，给我“未定义的索引：......”

如果这个方法失败了，还有其他方法吗？

编辑：是的，我可以使用 SESSION。我想显示其他人的个人资料怎么样？表示其他用户名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T10:06:02.877

您可以将变量保存在会话中。

在您的 index.php 文件中。

```
session_start();
$_SESSION["user"] = $_GET["user"]; 
```

然后在您的以下文件中，您可以启动会话并调用`$_SESSION["user"]`

编辑：如果您需要显示可以采用相同参数的不同内容，那么您需要在该 url 中包含这些参数。

编辑2：顺便说一句，这是一种猜测，因为我不知道您的代码或技能水平。

假设您有这个 index.php 页面。您通过 index.php?user=john 访问

在此页面中，您列出了约翰的朋友。您还可以通过执行 index.php?user=alex 和 index.php?user=tim 访问他们的个人资料

然后你可以参考他们朋友的网址。（假设你有一个标准的 mysql_fetch_* 方式的朋友数组）

```
<?php
    echo "<a href='index.php?user=".$friend["name"]."'>".$friend["name"]."</a>
?> 
```

并使用 $_GET 变量获取您的链接

```
<?php
    echo "<a href='index.php?user=".$_GET["user"]."'>".$_GET["user"]."</a>
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T10:47:47.503

我假设您想在您的网站上将“用户名”作为不同的用户身份传递，以便用户可以查看他们的个人资料，例如：

profile.php?user=peter

profile.php?user=olafur

这个对吗？一种方法是会话，但如果您愿意，您也可以将它们作为 GET 变量传递给页面内的所有链接。

例如。如果用户以 index.php?user=peter 开头，您只需将其保存为 $this_user = $_GET["user"]; 在 index.php 中，当您呈现链接时，您只需分配 $this_user 变量，例如：

<a href="profile.php?user=< ?=$this_user?>" >个人资料</a>

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T11:22:57.620

我建议避免使用会话将参数从一页传递到另一页。在这种情况下，最好的解决方案是将用户名（或者更好的是用户 ID）作为参数传递给每个页面。

如果您觉得它太难，请尝试查找一些 PHP MVC 框架（那里有**很多**）。这比尝试自己动手要好。

# text - GDI+ 中的文本渲染控件

> ID：819541
> 
> 赞同：1
> 
> 时间：2009-05-04T10:05:38.040
> 
> 标签：text, fonts, gdi+

我一直在为 GDI+ 中的文本渲染苦苦挣扎。我们正在动态生成标题图像，但在库中似乎有很多值得期待的东西。我可以设置字体、字体大小和其他一些东西，但我无法控制行高或字母间距。

我已经构建了自己的类，该类采用生成的文本图像，剪切出单独的文本行（每种字体的设置都手动编码到设置文件中）并用我想要的行高重新组合它们。不过，我无法解决相同的字母间距问题。

有没有人为此提供解决方案或推荐解决此问题的库（操作系统或商业）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T06:32:04.900

我不知道这是否适用于您的解决方案，但在过去，当我需要渲染一些更复杂的文本并且我希望在渲染方式上有相当大的灵活性时，我使用了这个库：

[http://www.terrainformatica.com/htmlayout/main.whtm](http://www.terrainformatica.com/htmlayout/main.whtm)

它不是开源的，但它是免费的......

或者，在游戏空间中，我广泛使用了位图字体 - 如果您存储字符间距等信息，它看起来可能与 TTF 完全相同，但是您在不引入一些像样的工件的情况下失去了对其进行大量缩放的能力。为了更好地了解这种方法，这里有一个构建字体的工具：

[http://www.angelcode.com/products/bmfont/](http://www.angelcode.com/products/bmfont/)

希望其中一个能给你一些帮助——任何一个都可以让你控制字符间距和行高，但它们也有其局限性。

# delphi - Delphi 有缓存框架吗？

> ID：819544
> 
> 赞同：6
> 
> 时间：2009-05-04T10:07:07.960
> 
> 标签：delphi, memory-management, caching

**问题：** Delphi 有哪些可用的缓存框架以及它们的开发程度如何？如果没有，那么是否有一种被广泛接受的方法来实现相同的目标？*适用于 Win32 目标版本的 Delphi。*

**问题详情：**我询问的框架类型主要存在于 Web 开发框架中，允许用户：

*   检查缓存以获取先前存储的数据/对象
*   检索数据/对象
*   存储新的数据/对象
*   可选地标记数据/对象并标记它。
*   根据某些标准（标签、标签、时间限制等）使数据/对象过期。

我知道没有 RTTI 的 Delphi Objects 缺乏反射服务意味着它们可能不会以完全相同的方式存在，但是是否有类似的方式可以以更多的 Delphi 方式实现至少部分相同的最终结果？

**替代方法：**作为本机 Delphi 库的替代方法：例如，是否有一组好的绑定用于 memcached 或类似的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T12:22:16.667

我在 Linux 上使用过[memcached](http://www.danga.com/memcached/)（Windows 和 MacOS 上都有版本，以及几乎任何其他操作系统），它非常简单。

我直接处理了，使用 indy 的 TIDTelnet，通过阅读协议的[文档](http://code.sixapart.com/svn/memcached/trunk/server/doc/protocol.txt)，我只使用了**set**、 **get**、**delete**和**quit**。

我使用了这种命令（我设置并获取“名称”，14是要存储的字节数）：

```
osama@osama:~$ telnet 127.0.0.1 11211
Trying 127.0.0.1...
Connected to 127.0.0.1.
Escape character is '^]'.
set name 0 0 14
Osama Alassiry
STORED
get name
VALUE name 0 14
Osama Alassiry
END
quit 
```

memcached 允许每个缓存键最多存储 1MB，我使用了复合键，例如“Person|17|name”、“Person|17|picture”、“Employee|7|Salary|Basic”（这些是与内容无关的虚构名称我真的做到了）......我在缓存中存储了一些二进制文件作为base64，它允许使用多达768k的二进制数据。

memcached 还可以通过对密钥进行散列处理并根据它们的散列选择多个服务器之一来分布在多个服务器上。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-29T20:11:11.857

Memcached 的 Delphi 客户端可以在 google 代码中找到：

[http://code.google.com/p/delphimemcache/](http://code.google.com/p/delphimemcache/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T10:27:13.200

缓存机制需要手动滚动。

[展开树](http://en.wikipedia.org/wiki/Splay_tree)是一种有用且直接的机制，用于存储缓存对象，并检测它们的陈旧程度。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T11:50:42.983

这些框架提供*了一些*缓存对象的方法

*   [企业核心对象](http://delphi.wikia.com/wiki/Enterprise_Core_Objects)
*   [对象](http://www.remobjects.com/da.aspx)
*   [DevExpress 持久对象](http://www.devexpress.com/Products/NET/ORM/)

根据您的确切要求，这些可能超出了顶部。如果您尝试实现自己的解决方案，我建议您以查看[Jedi VCL](http://jvcl.delphi-jedi.org/)中的各种容器作为起点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T12:52:59.480

如果您想构建自己的，您可能希望在 Freepascal 中进行，因为它具有 64 位支持。我建议使用 k-ary，而不是二叉树。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T20:36:01.753

行。我可能最终会对此感到愚蠢，但是 TStringList 有什么问题？我一直在使用带有 TStringList 的相当结构化数据的动态数组来查找基于字符串 ID 的元素。最近，我将 TStringList 更新为 THashedStringList。它可能会快一点，但还没有什么特别之处。到目前为止，StringList/Array 排列为我的应用程序提供了出色的性能。

到目前为止，我只缓存了 100 到 150 条记录，但我希望它可以正常工作到几千条。在我从事的业务中，这是一项相当大的业务。

# xml - 如何使用 xquery 即时创建 xml 文档？

> ID：819545
> 
> 赞同：0
> 
> 时间：2009-05-04T10:07:42.013
> 
> 标签：xml, xquery

我如何使用 XQuery 将“aaa=1&bbb=2”之类的字符串转换为 xml

```
<request>
  <aaa>1</aaa>
  <bbb>2</bbb>
</request> 
```

我尝试了以下代码，但失败了！

```
xquery version "1.0" encoding "GBK";
(:: pragma  type="xs:anyType" ::)

declare namespace xf = "http://tempuri.org/BNetAP/Xquery/query2xml/";

declare function xf:query2xml($queryStr as xs:string)
    as element(*) {
    <query-params>
    {
        for $c in
            fn:tokenize($queryStr, "&amp;")
        let $myname as xs:string := "{fn:substring-before($c,"=")}"
        return 
            element
                {fn:QName("", $myname)}
                {"{fn:substring-after($c,"=")}"}
    }
    </query-params>
}; 
```

错误信息是：

```
line 15, column 6:  "{http://www.w3.org/2004/07/xpath-functions}QName": unknown function (or number of arguments (2) is wrong)  BNetAP/Xquery   query2xml.xq    line 15 1241431186406   397 
```

我不知道为什么“QName”是一个“未知函数”？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T17:06:46.327

您应该使用构造函数 xs:QName，而不是 fn:QName。

您构造的元素的主体也看起来有点可疑：

```
"{fn:substring-after($c,"=")}" 
```

实际上是字符串 "{fn:substring-after($c," 和字符串 ")}" 之间的比较，因此元素的内容就是文本 "false"。

同样，您的 $myname 变量实际上被设置为 false，因此会在运行时引发类型检查错误。

您的功能应该如下：

```
declare function xf:query2xml($queryStr as xs:string)
    as element(*) {
  <query-params>
  {
    for $c in fn:tokenize($queryStr, "&amp;")
    let $myname := fn:substring-before($c,"=")
    return 
      element
        {xs:QName("", $myname)}
        {fn:substring-after($c,"=")}
  }
  </query-params>
}; 
```

计算元素构造函数也可以只接受一个字符串作为其名称，因此您的返回表达式可以简化为

```
return element {$myname} {fn:substring-after($c,"=")} 
```

# asp.net - 连接两个项目

> ID：819549
> 
> 赞同：0
> 
> 时间：2009-05-04T10:09:52.943
> 
> 标签：asp.net, vb.net

我目前正在做一个要与另一个项目链接的项目。即，当我单击当前项目页面中的某个按钮时，我应该从另一个项目中获取一个页面。你能建议一种方法来做同样的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T10:17:22.723

您始终可以使用`Response.Redirect()`将用户重定向到任何可用的 Internet 位置。

如果您的两个项目都配置为网站（即，它们可以通过虚拟目录访问），那么您可以使用此方法执行重定向。如果没有更多信息，就很难进一步解决这个简单过程可能遇到的任何问题。

请注意，您将无法在两个应用程序之间共享状态信息（至少不能以直接的方式！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T11:06:11.657

根据您在问题中提供的信息，我想您想从一个项目中的“模块”导航到另一个项目、页面或页面上的控件中的“模块”......一种方法是使模块的 url 可配置。所以你可以像这样导航到模块

```
Response.Redirect(ConfigurablePropertyName); 
```

或者在这样的客户端上：

```
<a href='<%= this.ConfigurablePropertyName %>' >Click me</a> 
```

希望这可以帮助。

# fonts - GDI+ 的字体问题

> ID：819551
> 
> 赞同：3
> 
> 时间：2009-05-04T10:10:10.200
> 
> 标签：fonts, gdi+, truetype

我遇到了一些 ttf 字体在 GDI+ 中不起作用的问题。我似乎找不到某些工作字体和非工作字体之间的任何区别。有些可以毫无问题地阅读和渲染。对于某些字体，GDI+ 只是将文件报告为丢失（事实并非如此）。格式一定有问题，但我一生都无法找出它是什么......任何指针？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T10:47:23.260

GDI+ 很挑剔，它只适用于真正的 TrueType 字体，而不适用于 OpenType 或 PostScript 字体，因此支持少于 GDI。

看看[这个链接](http://www.codeguru.com/cpp/g-m/gdi/gdi/article.php/c10621)，它可能会帮助你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T10:42:15.660

Microsoft 有一个不错的工具，称为[Microsoft Font Validator](http://www.microsoft.com/typography/FontValidator.mspx)，可以免费下载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T10:35:55.613

字体的问题在于它们是编程中最不被理解的方面之一。我遇到了类似的问题（请参阅[Corrupt TrueType font detection](https://stackoverflow.com/questions/615479/corrupt-truetype-font-detection)）。试一试我的问题——它可能会有所帮助。

您能否发布有关您的问题的更多详细信息，例如您正在使用的 API、有效的字体、无效的字体等？

# objective-c - 我应该用什么替换此代码？

> ID：819552
> 
> 赞同：-2
> 
> 时间：2009-05-04T10:10:31.633
> 
> 标签：objective-c, cocoa

我最近从一位朋友那里得到了一些代码的示例，但他告诉我需要更改一行以使其适合我。这是代码：

```
- (void)tableView:(NSTableView *)aTableView willDisplayCell:(id)aCell forTableColumn:

(NSTableColumn *)aTableColumn row:(int)rowIndex {

    if ([aCell respondsToSelector:@selector(setTextColor:)]) {

        if ([self visibilityForFile:[fileList objectAtIndex:rowIndex]] == NO) 

[aCell setTextColor:[NSColor lightGrayColor]];

        else [aCell setTextColor:[NSColor blackColor]];
    }
} 
```

我需要替换这一行：

```
[self visibilityForFile:[fileList objectAtIndex:rowIndex]] == NO 
```

通过一些不同的代码，我实际上要做的就是，正如我在表格中的每一行都有一个复选框，当检查该行的复选框时，该行的文本颜色将更改。我认为代码需要检查是否选中了行中的复选框，我只需要代码。

**更新**

这是应用程序（核心数据）的代表。

头文件（.h）：

```
#import <Cocoa/Cocoa.h>

@interface Spark_AppDelegate : NSObject 
{
    IBOutlet NSWindow *window;
    IBOutlet NSMenu *theMenu;

    NSPersistentStoreCoordinator *persistentStoreCoordinator;
    NSManagedObjectModel *managedObjectModel;
    NSManagedObjectContext *managedObjectContext;
}

- (NSPersistentStoreCoordinator *)persistentStoreCoordinator;
- (NSManagedObjectModel *)managedObjectModel;
- (NSManagedObjectContext *)managedObjectContext;

- (IBAction)saveAction:sender;

@end 
```

.M 文件

```
/**
    Returns the support folder for the application, used to store the Core Data
    store file.  This code uses a folder named "Spark" for
    the content, either in the NSApplicationSupportDirectory location or (if the
    former cannot be found), the system's temporary directory.
 */

- (NSString *)applicationSupportFolder {

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSApplicationSupportDirectory, NSUserDomainMask, YES);
    NSString *basePath = ([paths count] > 0) ? [paths objectAtIndex:0] : NSTemporaryDirectory();
    return [basePath stringByAppendingPathComponent:@"Spark"];
}

/**
    Creates, retains, and returns the managed object model for the application 
    by merging all of the models found in the application bundle.
 */

- (NSManagedObjectModel *)managedObjectModel {

    if (managedObjectModel != nil) {
        return managedObjectModel;
    }

    managedObjectModel = [[NSManagedObjectModel mergedModelFromBundles:nil] retain];    
    return managedObjectModel;
}

/**
    Returns the persistent store coordinator for the application.  This 
    implementation will create and return a coordinator, having added the 
    store for the application to it.  (The folder for the store is created, 
    if necessary.)
 */

- (NSPersistentStoreCoordinator *) persistentStoreCoordinator {

    if (persistentStoreCoordinator != nil) {
        return persistentStoreCoordinator;
    }

    NSFileManager *fileManager;
    NSString *applicationSupportFolder = nil;
    NSURL *url;
    NSError *error;

    fileManager = [NSFileManager defaultManager];
    applicationSupportFolder = [self applicationSupportFolder];
    if ( ![fileManager fileExistsAtPath:applicationSupportFolder isDirectory:NULL] ) {
        [fileManager createDirectoryAtPath:applicationSupportFolder attributes:nil];
    }

    url = [NSURL fileURLWithPath: [applicationSupportFolder stringByAppendingPathComponent: @"Spark.xml"]];
    persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel: [self managedObjectModel]];
    if (![persistentStoreCoordinator addPersistentStoreWithType:NSXMLStoreType configuration:nil URL:url options:nil error:&error]){
        [[NSApplication sharedApplication] presentError:error];
    }    

    return persistentStoreCoordinator;
}

/**
    Returns the managed object context for the application (which is already
    bound to the persistent store coordinator for the application.) 
 */

- (NSManagedObjectContext *) managedObjectContext {

    if (managedObjectContext != nil) {
        return managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil) {
        managedObjectContext = [[NSManagedObjectContext alloc] init];
        [managedObjectContext setPersistentStoreCoordinator: coordinator];
    }

    return managedObjectContext;
}

/**
    Returns the NSUndoManager for the application.  In this case, the manager
    returned is that of the managed object context for the application.
 */

- (NSUndoManager *)windowWillReturnUndoManager:(NSWindow *)window {
    return [[self managedObjectContext] undoManager];
}

/**
    Performs the save action for the application, which is to send the save:
    message to the application's managed object context.  Any encountered errors
    are presented to the user.
 */

- (IBAction) saveAction:(id)sender {

    NSError *error = nil;
    if (![[self managedObjectContext] save:&error]) {
        [[NSApplication sharedApplication] presentError:error];
    }
}

/**
    Implementation of the applicationShouldTerminate: method, used here to
    handle the saving of changes in the application managed object context
    before the application terminates.
 */

- (NSApplicationTerminateReply)applicationShouldTerminate:(NSApplication *)sender {

    NSError *error;
    int reply = NSTerminateNow;

    if (managedObjectContext != nil) {
        if ([managedObjectContext commitEditing]) {
            if ([managedObjectContext hasChanges] && ![managedObjectContext save:&error]) {

                // This error handling simply presents error information in a panel with an 
                // "Ok" button, which does not include any attempt at error recovery (meaning, 
                // attempting to fix the error.)  As a result, this implementation will 
                // present the information to the user and then follow up with a panel asking 
                // if the user wishes to "Quit Anyway", without saving the changes.

                // Typically, this process should be altered to include application-specific 
                // recovery steps.  

                BOOL errorResult = [[NSApplication sharedApplication] presentError:error];

                if (errorResult == YES) {
                    reply = NSTerminateCancel;
                } 

                else {

                    int alertReturn = NSRunAlertPanel(nil, @"There Are Un-Saved Changes. Quit anyway?" , @"Quit anyway", @"Cancel", nil);
                    if (alertReturn == NSAlertAlternateReturn) {
                        reply = NSTerminateCancel;  
                    }
                }
            }
        } 

        else {
            reply = NSTerminateCancel;
        }
    }

    return reply;
}

/**
    Implementation of dealloc, to release the retained variables.
 */

- (void) dealloc {

    [managedObjectContext release], managedObjectContext = nil;
    [persistentStoreCoordinator release], persistentStoreCoordinator = nil;
    [managedObjectModel release], managedObjectModel = nil;
    [super dealloc];
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T13:37:14.240

您需要更改 if 语句以从模型中读取支持给定行复选框的布尔值。由于您没有包含有关模型的任何信息，因此没有人能够为您提供实际使用的代码行。

还不清楚其余代码是否会执行您想要的操作；它有条件地改变文本的颜色，而不是行本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T15:47:06.863

通常，您不希望一个单元格的显示基于另一个单元格的值。一种更符合 MVC 的方法是让复选框控制该行对象的属性（例如`isActive`），然后您可以在上面的代码中检查该属性以确定如何绘制文本。只要复选框状态和文本颜色都基于相同的属性，它们就会根据需要匹配。

此外，您想要的颜色不是`[NSColor lightGrayColor]`，而是`[NSColor disabledControlTextColor]`。通常，您只想禁用整个单元格，`[aCell setEnabled:NO]`而不是仅仅更改文本颜色，这使它看起来像一个被禁用的单元格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T11:56:15.093

[self visibilityForFile:] 返回什么？如果它不是 BOOL，那么您需要将其更改为确实返回 BOOL 的东西。你为什么不问问你的朋友你应该把线路改成什么？

# php - RSS 提要和 cdata 的问题

> ID：819554
> 
> 赞同：3
> 
> 时间：2009-05-04T10:10:55.237
> 
> 标签：php, rss

我的 RSS 提要有问题。

当我做 `<title>This is a title </title>`

标题很好地出现在提要中

但是当我 ddo $title = "this is atilte";

```
<title><![CDATA['$title']]></title> 
```

标题根本没有出现。

* * *

它仍然不起作用。我动态生成我的 rss 提要，它看起来像这样：

```
$item_template="
      <item>
         <title>[[title]]</title>
         <link>[[link]]</link>
         <description><![CDATA[[[description]]]]></description>
         <pubDate>[[date]]</pubDate>
      </item>
      "; 
```

并在一个循环中：

```
$s.=str_replace(
array("[[title]]","[[link]]","[[description]]","[[date]]"),
array(htmlentities($row["title"]),$url,$description,$date),
$item_template); 
```

问题特别是当标题有欧元符号时。然后它显示在我的 rss 验证器中，例如：

```
Â\x80 
```

* * *

**更详细的信息：**

好的，过去几天我一直在为此苦苦挣扎，但找不到解决方案。所以我会开始赏金。以下是更多信息：

*   提要中的信息存储在 latin 1 数据库中（由我管理）
*   当数据库中有欧元符号时，就会出现问题。无论是像€还是`&euro;`
*   欧元符号有时看起来像奇怪的字符或像 Â\x80
*   我尝试在提要方面而不是在读者方面解决问题。
*   完整的代码可以在这里找到：[codedump](http://codedump.mastercode.nl/622/)
*   下一步：有时当无法解析欧元符号时，项目（标题或描述）显示为空。因此，如果您在浏览器中显示提要时查看源代码，您会发现`<title></title>`

如果需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-04T14:28:31.793

问题是您的输出代码；改变

```
echo '<title><![CDATA[$title]]></title>'; 
```

到

```
echo '<title><![CDATA[' . $title . ']]></title>'; 
```

作为旁注，请注意以下几点：不要在后续回答您自己的问题，而是编辑原始问题。不要无缘无故地使用正则表达式。不要猜测。

相反，做你应该做的事情：将标题包装起来[`htmlentitites`](http://php.net/htmlentities)并完成，如：

```
echo '<title>' . htmlentities($title, ENT_NOQUOTES, [encoding]) . '</title>'; 
```

**替换`[encoding]`为您正在使用的字符编码。**最有可能的是，这是“UTF-8”。这是必要的，因为 php(<6) 默认使用 ISO-8859-1，并且无法在该编码中表达例如欧元符号。如需更多信息，请参阅这篇[写得很好的介绍](http://www.joelonsoftware.com/articles/Unicode.html)。

我还建议您[阅读有关 XML](http://www.w3.org/TR/2006/REC-xml11-20060816/)的内容。从第二章开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T15:14:33.773

使用`htmlspecialchars()`而不是`htmlentities()`.

RSS/ATOM 提要**不是**HTML，因此您不能在其中使用 HTML 实体。[XML 默认只定义了五个实体](http://en.wikipedia.org/wiki/List_of_XML_and_HTML_character_entity_references#Predefined_entities_in_XML)，所以不能使用`&euro;`。由于您使用的是 UTF - 使用文字欧元符号，不进行转换 (no `htmlentities`)，但转义其他敏感字符 ( `htmlspecialchars`)。

这将是完全有效的 RSS/XML。如果这不能解决问题，则意味着它位于其他地方（请向我提供生成的 RSS 原始源以获得更多帮助）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T10:29:08.140

您使用哪种编程语言或环境？例如，在 PHP 中，单引号会阻止计算内部变量。

否则，在这种情况下，您实际上并不需要这些引号。可能你被 PHP 的数组语法弄糊涂了。

所以你最好写：

```
<title><![CDATA[$title]]></title> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-07T13:04:08.330

我不明白为什么要使用编码功能。当第三方获取您的内容时，将不知道如何解码该字符串。我认为 - 您应该将 CDATA 用于可能破坏 de XML 的标记 - 使用定义良好的库来编写 XML。对于 PHP：DomDocument 或 XML Writer (http://php.net/manual/en/book.xmlwriter.php)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-04T10:31:43.267

我相信 RSS Profile 不允许这样做：[该](http://www.rssboard.org/rss-profile#element-channel-title)文件指出`title`，字符数据进一步定义[如下](http://www.rssboard.org/rss-profile#data-types-characterdata)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-08T22:26:07.533

[本文](http://www.cs.tut.fi/~jkorpela/html/euro.html)可能有助于了解有关欧元符号和各种情况下的支持的信息。该文章中的一些建议包括使用`&#8364;`或`&euro;`仅用“欧元”一词替换该标志。祝你好运！

# java - 是否可以从 POI 将 VB 添加到 Excel 工作表？

> ID：819555
> 
> 赞同：4
> 
> 时间：2009-05-04T10:11:09.323
> 
> 标签：java, excel, vba, apache-poi

有谁知道是否可以从 Java 中将 VB 添加到 Excel 文档中？我基本上想向工作表添加一个数据透视表，并动态设置它的一些属性。我知道我可以从 VB 访问数据透视表设置，但不能直接从 POI 访问。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T10:19:51.673

我做过类似的事情，我使用 Excel*预先*使用 VBA 创建了一个电子表格。然后我使用 POI 加载它，填充值，然后再次保存。因此，我得到了一个包含填充值和预配置的 VB/宏等的电子表格。

也许您需要提前创建 VBA，它会从工作表中读取其动态属性。然后，您可以随意填充这些属性。

# java - 如何在 JXDatePicker 上注册 KeyStroke

> ID：819557
> 
> 赞同：4
> 
> 时间：2009-05-04T10:11:34.377
> 
> 标签：java, keystroke, swingx

当用户按下 Enter 键时，我需要将焦点转移到另一个元素上，因此我成功地以这种方式在大多数元素上注册 KeyStroke：

```
 this.getInputMap( ).put( KeyStroke.getKeyStroke( '\n' ), "transferFokus" );

  this.getActionMap( ).put( "transferFokus", transferFokusa ); 
```

一切正常，除了我的类扩展了 JXDatePicker，我想它在里面消耗了 Enter 键。我能做些什么？

重点是让人们使用 GUI 界面更轻松，因为他们使用过旧的 DOS 应用程序，在该应用程序中，他们使用 Enter 键而不是 TAB 键在表单内部移动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T11:39:06.320

从 javadoc 看来，JXDatePicker 使用 JFormattedTextField 作为日期字符串的实际编辑组件。JXDatePicker.getEditor() 返回文本字段，所以也许您应该尝试在文本字段上调用 ​​getInputMap() 和 getActionMap()？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-26T21:08:21.400

为了将 a 添加`java.awt.event.KeyEvent`到 a `JXDatePicker`，您需要获取其编辑器并将事件添加到其中。例如：

```
jXDatePicker1.getEditor().addKeyListener(new java.awt.event.KeyAdapter() {
    public void keyPressed(java.awt.event.keyEvent evt) {
        // Your functionality here...
    }
}); 
```

# c# - 返回选定的指定列

> ID：819558
> 
> 赞同：10
> 
> 时间：2009-05-04T10:11:56.433
> 
> 标签：c#, linq, linq-to-sql

我想从某个（Blobs）表中只选择几列。我有如下字段：Id、RowVersion、Size、Signature、Blob，我只想选择前四个。我这样做：（--->是一个错误的地方）

```
public List<BlobDetails> GetAllBlobsNames()  
{  
    RichTekstModelDataContext dc = new RichTekstModelDataContext();

    var allBlobs = from b in dc.Blobs
               orderby b.RowVersion descending
               select new {b.Id, b.Size, b.Signature, b.RowVersion};

---> allBlobs.ToList<BlobDetails>();
}

public class BlobDetails   
{  
    public int Id { get; set; }  
    public string Signature { get; set; }  
    public int Size { get; set; }  
    public System.Data.Linq.Binary RowVersion { get; set; }     
} 
```

当我尝试返回 BlobDetails 时发生错误 - 因为 VS.08 不知道如何从匿名类型 (allBlobs) 转换为列表。

我不想选择所有值，因为 Blob 字段可能很重，我不想一直发送它。

你知道如何正确地做到这一点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-04T10:17:01.650

如果`BlobDetails` **不是**LINQ 实体，则可以直接执行：

```
var qry = from b in dc.Blobs
          orderby b.RowVersion descending
          select new BlobDetails {
              Id = b.Id, Size = b.Size,
              Signature = b.Signature, RowVersion = b.RowVersion};

return qry.ToList(); 
```

然而; 如果`BlobDetails` **是**LINQ 实体，则需要使用 subtrefuge：

```
var qry = from b in dc.Blobs
          orderby b.RowVersion descending
          select new {b.Id, b.Size, b.Signature, b.RowVersion};

var typedQry = from b in qry.AsEnumerable()
               select new BlobDetails {
                  Id = b.Id, Size = b.Size,
                  Signature = b.Signature, RowVersion = b.RowVersion};
return typedQry.ToList(); 
```

打破了`AsEnumerable`LINQ 组合，使其工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T10:15:39.420

使用“select new {”，您正在创建一个无法隐式转换为 BlobDetails 的匿名类型。相反，在选择中显式声明您要新建的类型：

```
var allBlobs = from b in dc.Blobs
           orderby b.RowVersion descending
           select new BlobDetails {Id = b.Id, .... };
allBlobs.ToList(); 
```

# c# - PocketPC 上的 SQL CE 依赖项

> ID：819559
> 
> 赞同：0
> 
> 时间：2009-05-04T10:13:12.640
> 
> 标签：c#, mobile, compact-framework, sql-server-ce

我在 VS2008 上构建了一个使用 SQL CE 和 Framework 3.5 的 PPC 移动程序。在运行我的程序之前，我需要运行或安装哪些文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T11:03:42.597

该设备需要安装 .NET Compact Framework。直接从 Visual Studio 部署时会自动安装；否则，它可以与[.NET Compact Framework 3.5 Redistributable](http://www.microsoft.com/downloads/details.aspx?FamilyID=E3821449-3C6B-42F1-9FD9-0041345B3385&displaylang=en)一起安装。

对于 SQL CE，安装 CAB 位于 Visual Studio 文件夹中，通常
`C:\Program Files\Microsoft Visual Studio 9.0\SmartDevices\SDK\SQL Server\Client\v2.0`

# ruby - 如何在Ruby中拆分包含逗号的单引号逗号分隔值

> ID：819563
> 
> 赞同：0
> 
> 时间：2009-05-04T10:14:00.627
> 
> 标签：ruby, split, csv

假设我有一个带有逗号分隔值的字符串，这些值用单引号括起来，可能包含也可能不包含逗号，如下所示：

```
"'apples,bananas','lemons'" 
```

我想把它分成一个数组

```
["apples,bananas", "lemons"] 
```

显然，如果我`split(',')`得到的字符串

```
[ "'apples", "bananas'", "lemons" ] 
```

我不明白。我想出的唯一方法是

```
a = []
s = "'apples,bananas','lemons'"
s.scan(/\'([^\']+)\'/){|i| a << i[0]}

# result is ["apples,bananas", "lemons"] 
```

但是有没有更优雅的方式呢？是否有我没有得到的 split 方法导致奇怪的结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T11:10:11.630

实际上 split 正在按照它应该的方式工作。但似乎您正在尝试拆分逗号分隔的值。在 Ruby 的 stdlib 中已经有一个解决方案：

[http://www.ruby-doc.org/stdlib/libdoc/csv/rdoc/index.html](http://www.ruby-doc.org/stdlib/libdoc/csv/rdoc/index.html)

或者，如果您想要一个外部库（应该更好，更快，......）使用[FasterCSV](http://fastercsv.rubyforge.org/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T10:16:29.327

#split 的结果是完全正常的，该方法不应该以任何方式标记字符串。选择你知道的方式，而不是优雅的方式。

# jquery - JQuery 在页面上迭代 DISTINCT 类

> ID：819567
> 
> 赞同：0
> 
> 时间：2009-05-04T10:15:25.367
> 
> 标签：jquery

我希望对我的 html 页面上定义的每个类进行一次迭代。我可以使用 Jquery 取回类名，但我正在寻找一种方法，只对每个单独的类名进行一次迭代，而不是每次出现在页面上时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T10:29:23.397

这样做有点奇怪，但你去吧

```
<html>
<head>
   <title>Page</title>  
   <script src="jquery-1.3.2.min.js"></script>
   <script>
       $(function() {

           var classes = {};
           $("*[class]").each(function() {
               var cs = $(this).attr("class").split(/\s/g);
               for (var i = 0; i < cs.length; i++) {
                   if (!classes[cs[i]]) {
                       classes[cs[i]] = true;
                   }
               }
           });

           for (var prop in classes)
               alert(prop);
       });
</script>
</head>
   <body>

   <div class="single"></div>
   <div class="one two three"></div>
   <div class="one two three"></div>
   <div class="one two three four"></div>
   <div class="one two three five"></div>
   <div class="one two three six"></div>

   </body>
</html> 
```

# ant - 将 ant 目标传递给子目录中的多个 build.xml 文件

> ID：819568
> 
> 赞同：7
> 
> 时间：2009-05-04T10:15:37.220
> 
> 标签：ant, build

我有一个包含多个模块的项目，每个模块都在自己的目录中。每个模块都有自己的 ant 构建文件 (build.xml)

在根目录中，我设置了一个通用构建文件，它以正确的顺序调用每个模块的构建文件。

```
<?xml version="1.0"?>
<project name="bridgedb" default="all" basedir=".">
  <target name="all">
    <ant dir="corelib"/>
    <ant dir="tools"/>
    <ant dir="makeGdb"/>
    <ant dir="cytoscape-plugin"/>
  </target>
</project> 
```

现在每个模块也有一个“干净”的目标，所以我添加了这些行：

```
 <target name="clean">
    <ant dir="corelib" target="clean"/>
    <ant dir="tools" target="clean"/>
    <ant dir="makeGdb" target="clean"/>
    <ant dir="cytoscape-plugin" target="clean"/>
  </target> 
```

还有更多这样的目标。有没有办法重写构建文件以避免这种重复？我一直在寻找一个包含活动目标的内置属性，但我找不到它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T10:35:33.977

为什么不使用[antcall](http://ant.apache.org/manual/Tasks/antcall.html)调用引用所有子目录的目标，并参数化要调用的目标。例如

```
 <antcall target="doStuffToSubdirs">
    <!-- let's clean -->
    <param name="param1" value="clean"/>
  </antcall> 
```

接着：

```
<target name="doStuffToSubdirs">
   <ant dir="corelib" target="${param1}"/>
   <ant dir="tools" target="${param1}"/>
    ...etc
</target> 
```

所以这允许您参数化对子目录的调用。如果您添加一个新的子目录，您只需将该子目录添加到“doStuffToSubdirs”目标（我也会重命名它！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T10:22:44.880

在您的 commonbuild.xml 中放置一个干净的目标，在子文件中只需导入您的父 build.xml

```
<import file="${parent.dir}/commonbuild.xml" /> 
```

现在您将能够在您的子构建中调用 clean 目标。您还可以通过在任何子构建中创建一个干净的目标来覆盖此目标。

# c - 如何在 Windows 中使用 ruby 扩展库（在 c 中）运行我的 ruby 应用程序？

> ID：819572
> 
> 赞同：2
> 
> 时间：2009-05-04T10:15:53.680
> 
> 标签：c, ruby, windows, ruby-c-extension

我将感谢您对此的任何帮助：我想为我的 c 库编写一个扩展。我创建了使用库 libzmq（用 C++ 编写）的文件 zmq.cpp。

我使用 ruby​​ extconf.rb 创建了 makefile，然后运行 ​​nmake。一切顺利。Nmake 生成的文件

```
librbzmq-i386-mswin32.def
librbzmq-i386-mswin32.lib
librbzmq-i386-mswin32.exp
librbzmq.so librbzmq.so.manifest 
```

这一切都是在 Windows XP 中完成的。

然后我有一个测试程序，在我的第一行有：

```
require 'librbzmq' 
```

当我尝试使用运行我的测试程序时

```
ruby -I"C:\Documents and Settings\Kustarova\wcopy\trunk\librbzmq\librbzmq-i386-mswin32.lib" -I"C:\Documents and Settings\Kustarova\wcopy\trunk\windows\Debug\libzmq.lib" ./rb_remote_lat.rb 
```

我明白了

```
rb-remote_lat.rb:1:in `require':no such file to load -- librbzmq (LoadError) from ./rb_remote_lat.rb:1:in `<main>' 
```

文件位置是正确的，我检查了它。

你知道如何运行它吗？

注意：我在 ubuntu 中完成了所有这些工作，它运行良好 - 我创建了 makefile，并且能够使用与此处类似的命令运行测试应用程序（只有路径不同）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T10:39:05.573

更正我之前的回答 - 看起来您使用“-I”提供的路径是错误的。它应该指向可以找到 librbzmq.so 的目录。或者，您可以使用以下方法安装库：

```
nmake install 
```

或使用 RUBYLIB 设置搜索路径：

```
set RUBYLIB="C:\Documents and Settings\Kustarova\wcopy\trunk\librbzmq" 
```

问候

授予

# .net - 是否可以在.NET的调用堆栈中获取每个帧的参数值

> ID：819576
> 
> 赞同：12
> 
> 时间：2009-05-04T10:16:40.027
> 
> 标签：.net, clr, diagnostics

我说的是托管的.NET 代码。如果我们运行任何程序并将 VS 附加到它，我们可以在调用堆栈中看到每个方法的参数值。我想创建一个日志记录解决方案，它将记录调用堆栈中每个方法的所有参数值。实际上，如果发生异常，我需要此信息。

我知道分析 API 是可能的。但我想知道只有托管代码有可能吗？

更新：好的，可能使用纯 .NET 这是不可能的。然后可能是某种非托管代码......重点是从应用程序本身内部执行此操作。发生异常时的应用程序可以调用某个库（可能是非托管的），该库返回有关调用堆栈中方法值的信息。只是想法...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T10:40:52.667

参数值不存储在 StackFrame 实例中。事实上，它们根本不会被记录/记录，除非您选择明确地这样做。

记录这些值的一种明显方法是使用 AOP。这当然意味着成本，但结合日志框架和正确的日志级别，它可能是一种替代方案。您还可以选择仅检测基码中的某些类型/方法，这些类型/方法更有可能引发异常。我可能会选择 Postsharp 的静态编织功能，以发出日志调用。

无论如何，它远不是一个理想的解决方案，但是如果您被困在托管世界中，恐怕您将没有太多选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T10:40:21.467

您最好的选择可能是在相关方法中插入所需的跟踪代码。这样，您可以在需要时附加跟踪侦听器并转储值。

我知道这不是您要的，但这是获取数据的一种方式。

或者，您可以使用 WinDbg 调试应用程序。!clstack/!dso 命令将让您检查参数和堆栈对象。

# sql - 如何组合 2 位列

> ID：819589
> 
> 赞同：14
> 
> 时间：2009-05-04T10:21:57.830
> 
> 标签：sql, sql-server, tsql

我正在查询一个数据库，我需要合并 2 位列（对于这个例子，如果一个为真，则该列必须为真）。

就像是：`Select col1 || col2 from myTable`

实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-04T10:28:05.600

```
select col1 | col2 from myTable 
```

[http://msdn.microsoft.com/en-us/library/ms176122.aspx](http://msdn.microsoft.com/en-us/library/ms176122.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T10:26:22.343

我假设 col1 和 col2 是位值，最接近的 Sql Server 必须是布尔值。

返回 1 或 0：

```
select case when col1=1 or col2=1 then 1 else 0 end
from yourtable 
```

返回真或假：

```
select case when col1=1 or col2=1 then 'true' else 'false' end
from yourtable 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-03-26T18:23:43.670

您想使用 Bitwise 操作

& - 所有条件都需要匹配

| - 任何条件都需要匹配

```
 Select 
    -- Both need to Match
    1 & 0,   -- false  
    1 & 1,   -- true
    -- Only one condition needs to match
    1 | 1,   -- true
    0 | 1,   -- true
    1 | 0,   -- true
    0 | 0   -- False 
```

# email - OMA 电子邮件通知 WAP 推送问题

> ID：819592
> 
> 赞同：1
> 
> 时间：2009-05-04T10:24:01.630
> 
> 标签：email, sms, symbian, wap

我正在尝试向移动设备发送 OMA 电子邮件通知 ( [EMN](http://www.openmobilealliance.org/Technical/release_program/emn_v10.aspx) ) 1.0 WAP-Push，以使其获取给定邮箱的最新电子邮件。

我的问题是当手机收到短信时没有任何反应。我用诺基亚 E71 进行了测试，它应该按照诺基亚自己的技术规范实现规范。在设备上，我为电子邮件地址“my_email@gmail.com”设置了一个 IMAP 电子邮件帐户。

我在某处读到，还需要在“自动检索”菜单中将“电子邮件通知”设置为“自动更新”。

因此，在解释了设置后，这是我尝试发送的内容：

标题：

```
UDH=WDP+WSP
WDP=0605040B8423F0
06 - Length of WDP in octets
05 - information element identifier, application port addressing scheme, 16-bit address
04 - information element length in octets
0B84 - Destination port (2948)
23F0 - Source port (9200)

WSP=250603030A09
25 - transaction id (connectionless WSP)
06 - PDU Type: Push
03 - Length of headers in octets
030A - Content-type: application/vnd.wap.emn+wbxml
09 - Application-id: x-wap-application:emn.ua 
```

身体：

```
030D6A008507036D795F656D61696C40676D61696C2E636F6D0005C30620090504121501
03 - WBXML version 1.3
0D - EMN 1.0 public identifier
6A - Encoding UTF-8
00 - String table length = 0
85 - <EMN>-tag with attributes
07 - Mailbox=mailat: (Attribute)
03 - Inline string follows
6D795F656D61696C40676D61696C2E636F6D - 'my_email@gmail.com' 
00 - End of string
05 - Timestamp (Attribute)
C3 - Opaque data follows
06 - data is 6 octets long
200905041215 - 20090504T12:15:00Z
01 - </EMN> 
```

我知道这是一个非常具体的问题，可能很难回答，但我希望有人能够指出我做错了什么......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T08:20:22.867

您是否尝试过使用 Wireshark 监控消息以验证其格式是否正确？

还：：

您的目的端口值不一致 - 您是否打错字或错误？

0B84 - 目标端口 (2984)

需要考虑的事情

1）你的字节顺序正确吗？例如，您的 0x23f0 (9200) 源端口是否应该格式化为 23f0 或 f023

2) WDP 长度指示符是否应该包括长度字节本身，使正确的长度为 07 个八位字节？

3) WSP 是否应该有一个长度字段？

问候

# php - 需要一些 SQL 的帮助

> ID：819593
> 
> 赞同：0
> 
> 时间：2009-05-04T10:25:11.207
> 
> 标签：php, sql

```
<?php

if (isset($_POST['email'])) {

$email = mysql_real_escape_string($_POST['email']);
$password = mysql_real_escape_string($_POST['password']);

mysql_query("INSERT INTO accounts (email, password) VALUES ('$email', '$password')");

}

?>

<h1>Create Account</h1>

<form action="" method="post">
<table cellspacing="3">

<tr>
 <td valign="top">E-mail address:</td>
 <td><input type="text" name="email" size="28"></td>
</tr>

<tr>
 <td valign="top">Password:</td>
 <td><input type="text" name="password" size="28"></td>
</tr>

<tr>
<td colspan="2" align="center">
  <input type="submit" value="Submit">
</td>
</tr>

</table>
</form> 
```

如何防止人们只输入空格并插入空条目？:/ 你还看到任何其他潜在威胁吗？

谢谢。/新手

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T10:34:01.437

```
if(!empty($_POST['email']) && !empty($_POST['password'])){
  $email = trim($_POST['email']); // Remove trailing and leading spaces
  $password = trim($_POST['password']); 
  if( $email != "" && $password != ""){
    $email = mysql_real_escape_string($email);
    $password = mysql_real_escape_string($password);
    mysql_query("INSERT INTO accounts (email, password) VALUES ('$email', '$password')");
  } else {
    //DISPLAY ERROR MSG
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T10:30:13.863

您应该在调用任何 SQL 之前对字段进行验证，以防止不需要的条目以及 SQL 注入。

您可能还想对密码长度/强度、电子邮件的正则表达式等进行一些检查。

在您的代码中，现在有人可以输入任何内容。

此外，您是否也在数据库端处理具有唯一电子邮件/用户名约束的重复条目？

编辑 - 看起来你可能已经用 mysql_real_escape_string 覆盖了 SQL 注入

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T10:31:38.633

您可以修剪这些值并检查空字符串，然后向用户询问真实的电子邮件地址。您还可以将正则表达式用作某些验证的一部分。最后，我不确定如何使用 PHP 实现这一点，但您可以参数化 SQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T10:38:56.463

您应该考虑可用性和安全性。

可用性方面：添加 javascript-validators，当用户以错误的格式编写电子邮件时，它会为用户显示一些工具提示等。

为了安全起见：您应该在执行插入查询之前验证数据，验证器可以与 js-validators 相同（但“智能”用户可以简单地在浏览器中禁用 javascript）

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-04T10:40:31.903

正如 schooner 所说，您应该在调用 sql 查询之前验证字段。我认为保留一个包含用于验证字段的常用函数的文件是一种很好的做法，因此您可以在代码中多次重用此函数。可以使用正则表达式进行此验证。我给你留了一个例子。

```
function checkEmail($email) 
{
  if(preg_match("/^([a-zA-Z0-9])+([a-zA-Z0-9\._-])
               *@([a-zA-Z0-9_-])+([a-zA-Z0-9\._-]+)+$/",
               $email)){

    return true;
  }
  return false;
} 
```

另外...如果您需要验证大量输入条目，也许您会对在 php.ini 中搜索开放源代码验证库感兴趣。

# jquery - 同一页面上的多个调用ajax

> ID：819602
> 
> 赞同：0
> 
> 时间：2009-05-04T10:30:11.850
> 
> 标签：jquery, ajax

我正在尝试使用 jQuery 创建一个聊天应用程序，而不必使用 setTimeout 来减少 ajax 请求的数量：

```
function checkChat(){    
  new jQuery.ajax({
        'url'     : './chat/check.php',
        'cache'   : false,
        'success' : function(messages) {
                      if( messages.length ) {
                          $("#empty_chat").append(messages);
                          //write to chat wall
                       }
                       checkChat();
                   }
   });
} 
```

在一个运行良好的简单页面上，但在有其他 ajax 事件（如导航）的页面上，请求被排队，只要消息为空，什么都不会出现。

光标也处于等待状态。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T10:34:19.890

不是真的，除非您想研究 Comet，否则您仍然需要轮询消息并且 setTimeout 很好。

您在此处设置的递归调用 checkChat() 应设置为 setTimeout 否则您将堆栈溢出大声笑

```
setTimeout(checkChat,2000); 
```

并需要删除新的运营商，只是做

jQuery.ajax 或 $.ajax

[彗星和 jQuery](https://stackoverflow.com/questions/136012/comet-and-jquery)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-05-04T12:20:04.847

AJAX 请求排队的影响很可能是由于对同一域的活动请求的限制，在大多数浏览器上默认为 2 个。

# haskell - 如何在 Haskell 中检查一个字符串是否小于另一个字符串？

> ID：819620
> 
> 赞同：6
> 
> 时间：2009-05-04T10:38:41.893
> 
> 标签：haskell, string, compare

我有两个字符串作为 Haskell 函数的参数。

`s1`小于`s2`if`s1`小于`s2`或 如果它们具有相同的长度并且按`s1`字典顺序小于`s2`。

如何在 Haskell 中实现这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T12:09:15.123

我会使用以下内容：

```
smaller :: String -> String -> Bool
smaller s1 s2 | len1 /= len2         = (len1 < len2)
              | otherwise            = (s1 < s2)
              where (len1, len2) = (length s1, length s2) 
```

这是一个运行示例，在 Hugs 中：

```
主>较小的“b”“aa”
真的
主>较小的“aa”“b”
错误的
主>较小的“这个”“那个”
错误的
Main> 较小的“那个”“这个”
真的

```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-04T15:26:17.897

一次性解决方案：

```
lengthcompare :: Ord a => [a] -> [a] -> Ordering
lengthcompare = lc EQ
 where
  lc lx [] [] = lx
  lc _ [] _ = LT
  lc _ _ [] = GT
  lc EQ (v:vs) (w:ws) = lc (compare v w) vs ws
  lc lx (_:vs) (_:ws) = lc lx vs ws

smaller :: Ord a => [a] -> [a] -> Bool
smaller s1 s2 = lengthcompare s1 s2 == LT 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-04T10:44:20.537

试试这个：

```
compare s1 s2 
```

（这将返回 LT、EQ 或 GT）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-04T18:38:37.310

`mappend`上面 Tom Lokhorst 版本的较短版本：

```
import Data.Monoid (mappend)
import Data.Ord (comparing)

compareStrings :: String -> String -> Ordering
compareStrings = comparing length `mappend` comparing id 
```

另一种方式，利用元组的顺序：

```
import Data.Ord (comparing)
import Control.Arrow ((&&&))

compareStrings :: String -> String -> Ordering
compareStrings = comparing (length &&& id) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T10:47:26.257

`String`是的一个实例，[`Ord`](http://www.zvon.org/other/haskell/Outputprelude/Ord_c.html)因此您可以使用所有这些方法按字典顺序比较字符串。正如安德鲁所说，这本质上`compare`是比较运算符`(<)`等。

```
smaller :: Ord a => a -> a -> Bool
smaller a b = a < b 
```

这适用于*所有类型*的实现`Ord`（实际上只是 的粗略包装`(<)`），包括`String`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T10:50:03.347

正常的字符串比较仅适用于字典顺序，而不适用于字符串的长度。

因此，您必须编写自己的函数来检查长度：

```
smaller :: String -> String -> Bool
smaller s1 s2 | length s1 < length s2 = True
              | length s1 > length s2 = False 
              | otherwise             = s1 < s2 
```

或者更笼统一些：

```
compareStrings :: String -> String -> Ordering
compareStrings s1 s2 | length s1 < length s2 = LT
                     | length s1 > length s2 = GT
                     | otherwise             = compare s1 s2 
```

例子：

```
ghci> compare "ab" "z"
LT
ghci> compareStrings "ab" "z"
GT 
```

* * *

上周我们在大学里玩弄 Monoids，我们想出了这个可爱的替代`Ord`实例：

```
instance Ord a => Ord [a] where
  compare = comparing length
              `mappend` comparing head `mappend` comparing tail 
```

但是如果你不太明白这一点，我建议你坚持第一个定义;-)

# iphone - UISegmentControl问题

> ID：819633
> 
> 赞同：1
> 
> 时间：2009-05-04T10:45:09.553
> 
> 标签：iphone

我有一个 UISegmentControl，它在我的视图中有 2 个段，问题是我选择的任何段，它将在我的 selectedSegmentIndex 属性中返回 1，因为我希望它在选择段 0 时保留在第一个视图，我在我的段控件中使用的事件是 valueChanged，函数将被调用如下所示： -(void)segmentSelect:(id)sender{

```
NSInteger select=[sender selectedSegmentIndex];

if(select==0){

    NSLog(@"this is 0");

}
else{
    NSLog(@"this is 1");
    infoViewController *viewController = [[infoViewController alloc]initWithNibName:@"infoView" bundle:[NSBundle mainBundle]];
    [[self navigationController] pushViewController:viewController animated:YES];
    [viewController release];
} 
```

谁能告诉我出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T10:51:21.940

尝试这样的事情：

```
 -(void)segmentSelect:(id)sender{
    UISegmentedControl* segmentedControl = sender;

    switch ([segmentedControl selectedSegmentIndex]) {
            case 0:
                NSLog(@"this is 0");
                break;
            case 1:
                NSLog(@"this is 1");
                            //push the controller
                break;
            default:
                NSLog(@"this is unexpected");
    } 
} 
```

# iphone - Sqlite + 80K 行 + LIKE = 键盘延迟

> ID：819638
> 
> 赞同：2
> 
> 时间：2009-05-04T10:48:58.390
> 
> 标签：iphone, sqlite, keyboard, performance, sql-like

我有这个问题，我一直在推迟解决，但现在是时候了。

我有一个基本的字典程序。它有一个 UISearchBar 和一个 UITableView。它以应有的方式工作，除非在设备上运行时会导致键盘滞后。（模拟器当然可以）我有两种搜索方式。即用型和返回型。我发现两者都需要大约相同的时间来返回结果，但是 As-you-type 会使键盘滞后。

我有 UISearchBar textDidChange 接受 searchText 并将其发送到执行所有 sqlite 提升的搜索方法，将结果放入数组中。重新加载表。

```
- (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText{
    if((searchType == SEARCH_AS_YOU_TYPE) && ([searchText length] >= 2)){
        NSString *myKeyword = [NSString stringWithFormat:@"%@", searchText];
        [self search:myKeyword];
        [myTableView reloadData];
    }
} 
```

我将结果限制为 50。我的 SQL 查询使用 LIKE 和 OR，但目前还没有办法。

```
SELECT WORD_ID, DEFIN, PINYIN, SIMP, TRAD from WORDS where DEFIN LIKE "%to dog %" OR DEFIN LIKE "%dog" OR DEFIN LIKE "%dog%"  ORDER BY DEFIN LIMIT 50 
```

我还尝试将 [myTableView reloadData] 移动到搜索方法中，希望键盘至少不会滞后。没有喜悦。可悲的是，我知道当 sqlite 使用 like 运算符时，它基本上会检查每一行。但是 80 行的 3-4 秒似乎有点慢。

任何想法、想法、意见或建议将不胜感激！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T11:05:15.993

在我看来，您正在同一线程中搜索并准备好键盘。这样，您将搜索尽可能多的字符，并且输入速度仅限于搜索速度。

一个适当的解决方案是将其分成两个线程，一个用于读取和显示键盘，第二个用于搜索并显示搜索结果。这样，如果您的输入速度比搜索速度快，则只有搜索会滞后，而输入不会滞后。例如，Firefox 地址栏就是这样工作的。

由于两个线程以及两者之间的通信/协调，您的代码将更加复杂，但我认为这是唯一好的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T10:58:18.413

以下是我猜测 SQLite 执行该查询的方式：

1.  查找与您的 LIKE 语句之一匹配的所有行。

2.  按 DEFIN 对它们进行排序。

3.  在前 50 行之后截断结果。

我怀疑真正痛苦的部分是那种。没有它，它可以简单地收集它找到的前 50 个匹配行。你能不对定义进行排序吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T05:31:52.223

因为您使用的是 LIKE sqlite 不会使用索引，它会从头开始顺序扫描，直到结果集中达到 50 条记录的限制。根据您数据的顺序，它可能会在最坏的情况下在开始或结束时达到前 50 个结果。

您如何创建一个新列，将每个基本单词的第一个字母存储在定义中，例如 dog 等，并索引该列。

修改您的查询以选择 * from words where fisrtletter = :firstletter order by defin limit 50

这将大大减少您的搜索空间

使用 like 运算符进行完全匹配

您也可以预先订购数据，这样就不需要 order by，我怀疑 order by 将导致扫描整个表，而不是在前 50 条记录被命中时终止

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T12:17:19.330

尝试在不同的线程中进行搜索查询。由于 UI 操作仅在主线程上执行，因此在主线程上进行的任何耗时操作都会延迟 UI 操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-04T17:50:03.843

我一般用

```
[self performSelectorInBackground:@selector(threadedFetch) withObject:nil]; 
```

结合 Core Data's`NSFetchedResultsController`在用户搜索输入时开始获取。但是踩的时候要小心。对每个线程使用单独`NSManagedObjectContext`的或使用您锁定的单个上下文`-[NSManagedObjectContext lock]`。

# django - 使用 django + nginx + apache mod_wsgi 访问正在进行的上传文件

> ID：819641
> 
> 赞同：3
> 
> 时间：2009-05-04T10:50:45.483
> 
> 标签：django, file, upload

我知道当我们上传到使用 django 的 Web 应用程序时，我们无法在服务器完全接收上传文件之前访问它。

所以我的问题是，有没有办法检查/访问正在进行的上传文件的总字节数？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T12:30:07.583

您可以通过编写自己的 Django 上传处理程序来监控正在进行的上传。您需要做的就是子类`django.core.files.uploadhandler.FileUploadHandler`化并实现`receive_data_chunk`and`file_complete`方法。

Django 的[上传处理程序文档](http://docs.djangoproject.com/en/dev/topics/http/file-uploads/#upload-handlers)为您提供了所需的详细信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-06T20:09:01.270

这取决于您的服务器设置。如果您将 Apache 与 mod_python 一起使用，则文件在到达时会流式传输到您的 Django 进程。但是如果你在使用 wsgi 或 fastcgi 的 web 服务器后面运行 Django，那么整个文件将在 django 参与之前被服务器缓冲。那么上面给出的解决方案将不起作用。

这是“设计使然”，因为捆绑等待文件上传的 fastcgi 进程将是一种很大的浪费。所以你需要做的是使用一个服务器模块，比如[http://redmine.lighttpd.net/wiki/1/Docs:ModUploadProgress](http://redmine.lighttpd.net/wiki/1/Docs:ModUploadProgress) for Lighttpd，它在服务器上为你实现了 upload_progress 视图。或者[http://wiki.nginx.org/NginxHttpUploadProgressModule](http://wiki.nginx.org/NginxHttpUploadProgressModule)用于 nginx。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T06:38:30.107

[使用 jQuery、Django 和 nginx](http://www.fairviewcomputing.com/blog/2008/10/21/ajax-upload-progress-bars-jquery-django-nginx/#files)检查AJAX 上传进度条

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-12T17:59:39.853

刚刚找到了一个apache的上传进度模块：

[http://github.com/drogus/apache-upload-progress-module](http://github.com/drogus/apache-upload-progress-module)

我不知道它如何（或是否）与 django 和 mod_wsgi 一起工作。

# wcf - 使用 OperationContract 中未提及的方法

> ID：819643
> 
> 赞同：0
> 
> 时间：2009-05-04T10:53:06.757
> 
> 标签：wcf, contract, operation

我有一个 WCF 服务。它有两种方法，比如获取和保存。我只想向将使用该服务的第三方公开 Get 方法，而我的应用程序应该能够同时使用 Get 和 Save。

有没有办法使用不在 OperationContract 中的方法？我正在考虑验证请求的主机名并仅在它是我的应用程序的主机名时才授予访问权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T10:57:42.503

为什么不创建一个`ServiceContract`同时具有`Get`和`Set`as的第二个`OperationContracts`？然后你可以锁定谁可以获得第二份合同。

```
[ServiceContract]
public interface IFoo
{
    [OperationContract]
    void Get();
}

[ServiceContract]
public interface IFooInternal : IFoo
{
    [OperationContract]
    void Set();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-19T22:29:11.960

下面是识别主机ip地址的代码：

```
string GetAddressAsString()
{
           RemoteEndpointMessageProperty clientEndpoint =
                        OperationContext.Current.IncomingMessageProperties[
                        RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty;

                    if (clientEndpoint != null)
                    {
                        return String.Format("{0}:{1}", clientEndpoint.Address, clientEndpoint.Port);
                    }
                    return "Failed to identify address";
} 
```

# silverlight-2.0 - Silverlight 中的 WrapPanel，绑定 CLR 对象

> ID：819646
> 
> 赞同：0
> 
> 时间：2009-05-04T10:56:00.947
> 
> 标签：silverlight-2.0, wrappanel

有人可以帮我吗？我需要将 CLR 对象绑定到 SILVERLIGHT 中的 WrapPanel。最后应该显示的是几个带有描述（文本）的图像缩略图。我知道如何用 ListBox 来做，但我需要它是 WrapPanel，所以我的 Thumbs 将水平显示并分解成一个新的 raw ......等等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T11:09:33.207

在这种情况下，您仍然希望您的控件是 ListBox，但您将 ListBox 的 ItemsPanel 设置为 WrapPanel，例如

```
 <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel IsItemsHost="True" />
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel> 
```

然后它将水平显示项目并在行尾换行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T10:12:22.213

问题解决了。我不得不用 WrapPanel 替换 ListBox 内的 StackPanel。很简单……你只需要知道它！

# .net - 自动更新 .NET 应用程序

> ID：819647
> 
> 赞同：29
> 
> 时间：2009-05-04T10:56:12.943
> 
> 标签：.net, auto-update

我们正在开发一个非常复杂的系统，该系统由多个 WCF 服务、ASP.NET MVC 应用程序、管理工具（Windows 窗体应用程序）组成......其中一些将在多个服务器上运行实例。我们正在为这样的系统寻找一个好的自动更新解决方案。最有可能的是，我们需要一个单独的自动更新应用程序（服务）来完成这项工作，或者需要一些集中的管理应用程序来了解所有已安装实例的版本并远程进行更新。是否有任何你知道或有经验的为此目的而制作的好产品/库？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-04T11:28:42.663

就我个人而言，我对任何类型的自动更新都使用了一种非常简单的方法：

*   有安装程序
*   检查新版本（简单的 WebClient 并将数字与您当前的 AssemblyVersion 进行比较）
*   如果版本更高，请下载最新的安装程序（出于安全原因，应通过 SSL）
*   运行下载的安装程序并关闭应用程序。（如果您的安装程序要求您成为管理员，则在此阶段您需要拥有管理员权限）

安装人员应负责其余的工作。这样，您将始终拥有最新版本和具有最新版本的安装程序。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2010-02-23T21:09:45.137

首先让我说我是拥有完整更新解决方案的公司的创始人，其中包括：

*   用 C# [BSD 许可证] 编写的开源[更新程序 wyUpdate](http://wyday.com/wyupdate/)
*   您可以添加到 .NET 应用程序表单中的[开源 AutomaticUpdater 控件[LGPL 许可证]](http://wyday.com/wybuild/help/automatic-updates/)
*   [wyBuild 用于构建补丁](http://wyday.com/wybuild/)和管理您的版本

wyUpdate 可处理所有 Vista/Windows 7 UAC 问题以及在您尝试更新复杂软件时不可避免地出现的所有文件权限问题。

我们还[为开源项目提供免费的 wyBuild 许可证](http://wyday.com/wybuild/buy/special-prices.php)，但如果您只是想构建自己的更新程序，您可以自由地蚕食我们的源代码。

话虽如此，如果您想构建自己的更新程序，这里有一些提示：

## 构建自己的更新程序

一个好的起点是我上面提到的[wyUpdate](http://wyday.com/wyupdate/)和[AutomaticUpdater](http://wyday.com/wybuild/help/automatic-updates/)源代码。您可以将其蚕食并将其用于您自己的目的。它包含的一些算法：

*   完整的 Windows Vista / Windows 7 UAC 支持
*   有限用户能够检查然后更新他们是否有凭据
*   支持不稳定的企业内部网。（如果您曾经与一家公司合作过，这是一个真正的问题）。
*   快速提取、修补和安装文件。
*   注册表支持。
*   在用户出错或取消时回滚文件和注册表
*   自我更新（不留下任何文件）

我们这里也有[文件规范](http://wyday.com/wyupdate/file-specifications.php)。

## 自动更新

由于自动化是一项要求，让我告诉您我们如何使用[AutomaticUpdater 控件](http://wyday.com/wybuild/help/automatic-updates/)来做到这一点。

我们使用命名管道在独立更新程序 (wyUpdate) 和位于程序窗体上的自动更新程序控件之间进行通信。wyUpdate 向 Automatic Updater 报告进度，Automatic Updater 可以告诉 wyUpdate 取消进度、开始下载、开始解压等。

这使更新程序与您的应用程序分开。

事实上，我们使用的确切命名管道 C# 代码包含在我不久前写的一篇文章中：**[Multi-process C# app like Google Chrome](http://wyday.com/blog/2010/multi-process-c-sharp-application-like-google-chrome-using-named-pipes/)**。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-08-24T22:37:15.453

这是我为解决我们对 WinForms 和 WPF 应用程序的特定需求而编写的一个开源解决方案。总体思路是以尽可能低的开销获得最大的灵活性。

因此，**集成**非常简单，该库几乎可以为您完成所有工作，包括同步操作。它也**非常灵活**，可以让您确定要执行哪些任务以及在什么条件下执行 - 您制定规则（或使用一些已经存在的规则）。最后一点是对**任何更新源**（网络、BitTorrent 等）和任何**提要格式**的支持——任何未实现的内容您都可以自己编写。

还支持冷更新（需要重新启动应用程序），并且会自动完成，除非为任务指定“热交换”。

这归结为一个 DLL，大小不到 70kb。

更多详情请访问[http://www.code972.com/blog/2010/08/nappupdate-application-auto-update-framework-for-dotnet/](http://www.code972.com/blog/2010/08/nappupdate-application-auto-update-framework-for-dotnet/)

代码位于[http://github.com/synhershko/NAppUpdate](http://github.com/synhershko/NAppUpdate)（在 Apache 2.0 许可下获得许可）

当我有更多时间时，我计划进一步扩展它，但老实说，你应该能够自己快速增强它，以应对它目前不支持的任何东西。

自动更新 WCF 服务和 ASP.NET 网站应该也可以使用它，在必要时使用文件的“热交换”和“iisreset”任务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T12:48:17.763

我们调查了一些选项，并决定将[AppLife 更新](http://www.kineticjump.com/update/default.aspx)库用于我们的企业项目。

AppLife Update 可以快速轻松地为您的 .NET 应用程序添加自动更新功能，但由于它的综合 API 也很灵活。

在他们的网站上查看完整的功能列表和一些演示视频。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-11T20:15:00.637

对于简单的 WPF 应用程序，那些可能使用 Xcopy 安装的应用程序，您可以使用[这个 AppUpdater 模块](http://blogs.msdn.com/dotnetinterop/archive/2008/03/28/simple-auto-update-for-wpf-apps.aspx)。它是一个源模块，只需几行代码，即可为简单的 WPF 应用程序添加更新功能。

免费。

# asp.net - 使用 SQLBulkCopy 从 excel 到 SQL Server 时添加文本

> ID：819654
> 
> 赞同：0
> 
> 时间：2009-05-04T10:59:57.800
> 
> 标签：asp.net, sqlbulkcopy, import-from-excel

我创建了一个页面，我们的合作伙伴可以使用 SQLBulkCopy 上传带有统计信息的 excel 文件。该文件有多个工作表，我需要将工作表的名称添加到数据库中每一行的列中。工作表的名称不会更改，因此可以对名称进行硬编码。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-08T09:21:38.553

由于床单的名称没有改变，我以这种方式解决了它：

1.  创建了一个与最终布局相同的临时表。

2.  将第一张工作表中的数据导入临时表。

3.  用正确的值填充现在为空的列。

4.  为下一张纸做 nr 2->3，直到所有的纸都被导入。

5.  检查临时表是否有错误。

6.  将临时表中的数据一次导入最终表的一行，以便能够发现记录是否已经存在，如果存在则更新它，否则插入它。

# c++ - 用于以编程方式更改输入语言的 Win API

> ID：819665
> 
> 赞同：8
> 
> 时间：2009-05-04T11:04:32.610
> 
> 标签：c++, winapi, visual-c++, sdk

我想以编程方式将 WinXP 中的输入语言更改为西班牙语。有 API 支持吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T11:12:47.037

*   [加载键盘布局](http://msdn.microsoft.com/en-us/library/ms646305.aspx)
*   [激活键盘布局](http://msdn.microsoft.com/en-us/library/ms646289.aspx)
*   [获取键盘布局](http://msdn.microsoft.com/en-us/library/ms646296.aspx)

等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-08T08:09:04.140

我设法通过键盘事件和快捷键分配来做到这一点。

1.  转到“文本服务和输入语言”（这就是所谓的 Windows 7 控制面板）
2.  为单向语言分配键。例如“英语”和“希伯来语”。我选择了 Alt-Shift-7 和 Alt-Shift-8，因为它们很少在其他地方使用。
3.  从您的应用程序中，在需要时发送相应语言的组合键。

**笔记：**

如果“你的应用程序”是一个外部实用程序（我用 Python 编写的），那么它不能调用窗口，否则 /your-app/ 会窃取焦点，并会改变语言。在 python 中，我通过使用无 GUI 的 pyw 脚本文件名解决了它。（或使用 pythonw.exe 调用脚本）

本文展示了如何在 python 中发送键盘事件：

[https://python-decompiler.com/article/2012-11/how-to-generate-keyboard-events-in-python](https://python-decompiler.com/article/2012-11/how-to-generate-keyboard-events-in-python)

# asp.net-mvc - ASP.MVC：实现非模板化视图引擎？

> ID：819667
> 
> 赞同：3
> 
> 时间：2009-05-04T11:04:42.533
> 
> 标签：asp.net-mvc, template-engine

我对 ASP.MVC 相当陌生。对于我们的新 Web 应用程序，我正在考虑两种视图引擎选项：

1.  使用一些可用的视图引擎（默认的 NVelocity、Brail 等）作为主要的视图代码生成器。
2.  实现特定于应用程序的 C# DSL 以生成 HTML 代码，以便将大部分视图代码存储在 C# 类中（使用某种[智能 HTML 生成，如 Jimmy Bogard 所描述的](http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/04/24/how-we-do-mvc.aspx)那种）。

2\. 背后的想法是减少每次需要新视图时直接编写 HTML 代码的需要，但我不确定这是否是一个好方法。它的一个缺点是如果不重新编译项目就不可能更改生成的代码。

你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:39:12.293

我已经在其他项目中看到过类似的方法，但总的来说，它们带来的麻烦多于其价值。你失去的灵活性对于生成阶段的自动性来说太高了。想想需求只适用于一种特殊情况的频率，现在想象一下您必须如何在这里处理它。

此外，如果您的视图给您带来如此多的痛苦，我建议您可能没有正确使用视图。您应该在整个站点的视图中看到很少重复。例如，应该将常见的部分重构为单独的块并从那里拉入。

# objective-c - 将 NSMutableArray 保存到磁盘

> ID：819671
> 
> 赞同：7
> 
> 时间：2009-05-04T11:06:28.143
> 
> 标签：objective-c, arrays, serialization

我有一个 NSMutableArray，它包含 Person (NSString,NSString,int) 类型的对象，我正在寻找一种简单的方法来将此数组保存到磁盘并稍后再次加载。

我读了很多关于序列化的文章，但我从来没有这样做过。也许这对我来说毕竟不是最简单的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T11:44:16.230

第一步是让你的 Person 类实现 NSCoding 协议。基本策略是实现两种方法来序列化和反序列化您希望在会话之间保留的每个对象的实例变量。

```
#pragma mark NSCoding Protocol

- (void)encodeWithCoder:(NSCoder *)encoder;
{
    [encoder encodeObject:[self foo] forKey:@"foo"];
    [encoder encodeDouble:[self bar] forKey:@"bar"];
}

- (id)initWithCoder:(NSCoder *)decoder;
{
    if ( ![super init] )
        return nil;

    [self setFoo:[decoder decodeObjectForKey:@"foo"]];
    [self setBar:[decoder decodeDoubleForKey:@"bar"]];

    return self;
} 
```

要将对象实际写入磁盘，您可以使用 NSArray 的`writeToFile:`方法，或者如果您想更明确地了解它是如何完成的，可以使用 NSKeyedUnarchiver 类。在这两种情况下，如果您想在数据文件中包含其他项目（例如文件格式编号），您还可以将数组放入另一个数据结构（例如字典）中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T12:44:43.040

Charbonneau 先生的想法是正确的。抽象对象的`NSCoder`特定序列化，让您只担心需要序列化/反序列化的内容。在`-encodeWithCoder:`中，您可能想要

```
NSAssert1([encoder allowsKeyedCoding],
          @"%@ does not support sequential archiving.",
          [self className]); 
```

因为并非所有编码器都支持密钥归档。

在`-initWithCoder`中，您应该在初始化对象之前 发送`-initWithCoder:`（不仅仅是`-init`） ：`super`

```
self = [super initWithCoder:decoder];
if (!self) return nil;
// now use the coder to initialize your state 
```

或者，由于您的对象基本上已经是一个属性列表，您可以添加如下内容`-[Person plistRepresentation]`：

```
- (NSDictionary *)plistRepresentation
{
    return [NSDictionary dictionaryWithObjectsAndKeys:
            [self firstName], @"firstName",
            [self lastName], @"lastName",
            [NSNumber numberWithInteger:[self age]], @"age", nil];
} 
```

然后，要序列化一个 s 数组`Person`，您可以自己将 people 转换为他们的`plistRepresentation`然后使用`-[NSArray writeToURL:atomically:]`. （当然也可以`NSProperyListSerialization`直接使用 的方法。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-14T13:45:45.490

通过使用 writeToFile:atomically，它不会在我的代码中工作：

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory , NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *issueURLsPlist = [documentsDirectory stringByAppendingPathComponent:@"test.plist"];

MyClass * myObject = [[MyClass alloc] init];
NSMutableArray * array = [[NSMutableArray alloc] init];
[array addObject:myObject];
[array writeToFile:issueURLsPlist atomically:YES]; 
```

我的类.h

```
#import <Foundation/Foundation.h>

@interface MyClass : NSObject <NSCoding>
{

}

@property (nonatomic,copy) NSString * foo;
@property (nonatomic)      double  bar;

@end 
```

我的班级.m

```
#import "MyClass.h"

@implementation MyClass

- (id)init {
self = [super init];
if (self) {
    self.foo = @"test";
    self.bar = 0.4f;
}
return self;
}

#pragma mark NSCoding Protocol

- (void)encodeWithCoder:(NSCoder *)encoder;
{
[encoder encodeObject:[self foo] forKey:@"foo"];
[encoder encodeDouble:[self bar] forKey:@"bar"];
}

- (id)initWithCoder:(NSCoder *)decoder;
{
if ( ![super init] )
    return nil;

[self setFoo:[decoder decodeObjectForKey:@"foo"]];
[self setBar:[decoder decodeDoubleForKey:@"bar"]];

return self;
}

@synthesize foo;
@synthesize bar;
@end 
```

当我使用带有 NSStrings 的数组时，方法 writeToFile:atomically: 工作正常。

# c# - 不同用途的类

> ID：819672
> 
> 赞同：1
> 
> 时间：2009-05-04T11:06:29.673
> 
> 标签：c#, oop

我有一个类被两个不同的进程使用，每个进程使用类的不同属性。每当一个进程需要一个新属性时，我只需将它添加到类中。这是一个坏主意吗？我应该只创建两个单独的类并在需要时更新它们吗？

注意有时两个进程都使用相同的属性，并且每个进程都使用该类的不同实例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T11:09:48.887

公共属性可以保存在一个类中。然后您可以从公共类派生两个不同的类并添加特定的属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T11:41:44.923

> “公共属性可以保存在单个类中。然后您可以从公共类派生两个不同的类并添加特定属性” - Kirtan Gor

```
class BaseClassWithSharedProperties
{
    public Int32 SharedId { get; set; }
    public String SharedName { get; get; }
}

class UniqueClassNumberOne : BaseClassWithSharedProperties
{
    public UniqueClassNumberOneProperty { get; set; }
}

class UniqueClassNumberTwo : BaseClassWithSharedProperties
{
    public UniqueClassNumberTwoProperty { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T11:10:50.833

在类中使用包含（命名属性、值）对的成员列表。将此与具有 2 个方法的工厂结合使用，该方法返回使用正确属性集播种的实例。

# php - 希望为自己构建一个用于 PHP+MySQL 开发的小型免费 VMWare 映像

> ID：819682
> 
> 赞同：3
> 
> 时间：2009-05-04T11:09:58.493
> 
> 标签：php, mysql, vmware

我正在为自己构建一个用于 PHP+MySQL 开发的 VMWare 映像。

目前我正在使用一个 ubuntu 映像，它占用了我大约 1 GB 的硬盘空间。我想用更小更轻的东西来代替它。

所以，我很好奇......你们用什么？只要它运行 Php 5 和 MySQL，什么操作系统/网络服务器都没有关系。越小越轻越好。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T11:14:34.677

看看[jeos](http://www.ubuntu.com/products/whatisubuntu/serveredition/jeos) - 在坚持使用 Ubuntu 的同时，您可能可以将安装大小减半。我猜你应该可以用标准的服务器 CD 创建一张？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T11:20:23.353

如果你真的想压缩大小，一个基本的 Debian 系统应该可以装进 250MB。您只需要注意在安装时取消选择“标准”包集。添加[lighttp](http://packages.debian.org/lenny/lighttpd)（大约 1MB）和 php5(-cgi ?) 应该只会略微增加图像的大小。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T11:33:46.300

你可以试试[Debian Etch Mini](http://www.visoracle.com/download/debian/)，它只有 332 MB。`apt-get dist-upgrade`请注意，如果您需要新版本的软件包，您可能需要lenny。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T12:20:22.663

Damn Small Linux 可以配置得非常小。其他建议是 Debian 和 Gentoo。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T17:41:41.900

你真的需要看看 Tiny Core Linux。我在大约 15MB（包括操作系统）中构建了一个 Rebol 网络服务器（cheyenne）图像。

[http://www.tinycorelinux.com/](http://www.tinycorelinux.com/)

谢谢！国标

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-04T13:01:03.377

别忘了[斯莱克斯](http://www.slax.org/)。仅使用您想要的内容构建您自己的压缩发行版。它在虚拟机中运行良好。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-10T03:59:09.787

有这张图片[http://yii.googlecode.com/files/yii-vmware-1.0.6.zip](http://yii.googlecode.com/files/yii-vmware-1.0.6.zip)包含 php 5.2.3、postgresql、lighttpd。它非常小，大约 17MB 下载，它是使用 buildroot.uclibc.org 构建的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T11:33:05.193

我知道你说的是 VMWare 映像，但只是想我会让你知道[XAMPP](http://www.apachefriends.org/en/xampp.html)

他们有 GNU/Linux、Windows 和 Mac 版本。来自网站（Windows 版）

> 适用于 Windows 98、NT、2000、2003、XP 和 Vista 的发行版。此版本包含：Apache、MySQL、PHP + PEAR、Perl、mod_php、mod_perl、mod_ssl、OpenSSL、phpMyAdmin、Webalizer、Mercury Mail Transport System for Win32 和 NetWare Systems v3.32、Ming、JpGraph、FileZilla FTP Server、mcrypt、eAccelerator 、SQLite 和 WEB-DAV + mod_auth_mysql。

完整的 Windows 版本是 ~35Mb 下载。再次抱歉，如果这不能满足您的确切需求，但可能包含一些对您有用的信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-05T11:00:23.673

来自提问者：

[Slax](http://www.slax.org/)是我所选择的；因为它符合我的需要。这是一个非常可定制的从 cd linux 发行版引导。意味着我可以维护多个从同一个 iso 映像启动但具有不同状态的虚拟机。

.

我认为其他一些很棒的建议：

[DSL](http://damnsmalllinux.org/)：是一个不错的 timy 平台：一个现成的 vmware 映像可供下载。刚刚超过 50 MB。我没有尝试在它上面安装 xampp，但它应该很容易。

[jeos](http://www.ubuntu.com/products/whatisubuntu/serveredition/jeos)：看起来也不错，但是没有预先存在的 vmware 映像...这就是为什么我自己没有使用它的原因

debian net-install 也是一个小而伟大的候选者。[Thoughtpolice](http://www.thoughtpolice.co.uk/vmware/)有这个和其他几个 linux vmware 镜像可供下载。

.

此页面底部还提供了三个*现成的 {x}amp 图像：* [http](http://www.fosstools.org/) ://www.fosstools.org/ ；如果您正在寻找不需要额外配置的图像。

# java - JSF 和 Spring 性能与差的 JSP 性能

> ID：819684
> 
> 赞同：4
> 
> 时间：2009-05-04T11:10:19.400
> 
> 标签：java, performance, jsp, jsf, comparison

我看到我的同事开发了一些 JSF 项目，这些项目在我看来非常缓慢。有没有人有相同的看法？

我目前正在将 jsp+jstl 和 jQuery 用于“富”客户端。

我想知道现代框架（jsf、wicket、tapestry..）与旧的普通 jsp 相比有哪些优点和缺点。

如果使用所有这些技术的人都回答了，那就太好了。

对我来说，最令人兴奋的特性让你离开 jsp 并使用“大规模”框架也很有趣（我的意思是，例如 Spring 中的 AOP 或其他任何你能注意到的东西）。

感谢所有评论。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T12:31:22.997

I've used CGI, PHP, JSP, Struts, Spring MVC (1.2), Bea workshop, JSF, JBoss Seam, Spring MVC (2.5) and [Wicket](http://wicket.apache.org) (in that order). I've noticed a jump in both productivity and quality for each new technology I've worked on. It just works better, It **feels** better. I prefer Wicket (with a twist of spring, quartz, etc.) over all of the others. I can honestly say I saw the light, and I don't want to go back to a darker -- or lighter ;) -- side.

There is a lot to say about Wicket.

*   Conversational support (or tab-enabling) comes by default, you do not worry about "open in a new tab" and "back" button problems ever again.
*   It is component-based, so you can re-use code ala swing.
*   Leverages a lot of the standard Java, like the type safety wonders.
*   Supports advanced security features like url encryption.
*   Clusterizable applications by default.
*   And, most important, it is **fun** to use.

There is a lot to improve for JSP and JSF.

*   The one thing that bothers me the most is the "EL" nonsense, for I believe it breaks the nice java type safety and strength.
*   Both need tooling support for high productivity.
*   You need another framework on top of both of them to really solve the problems (as seen with seam framework, which makes JSF usable).
*   The error handling is very tricky and the exceptions are not straitforward helpful.
*   It is difficult to make reusable components on both frameworks and doesn't support a proper model for separation of concerns.
*   ... and, most important, a long etc of minor pains, like [this](http://techieexchange.wordpress.com/2008/02/21/jsf-session-expired-timeout-solution/), or [this](http://mail-archives.apache.org/mod_mbox/myfaces-users/200508.mbox/%3Cc206dbe9050805070956b59d8f@mail.gmail.com%3E).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T12:12:20.000

我非常喜欢将 JSP 2.0 用作模板技术——也就是说，我使用 Spring MVC 来访问我的域对象并为某个视图准备我需要的所有数据，并将其留给 JSP 来呈现它。JSP 2.0 因为我喜欢使用标签文件进行模板合成，这允许我在需要其他合成框架的地方使用简单的 JSP 2.0。

我有意避免在 JSP 中基本上是编程的所有内容。没有数据访问，没有 SQL，没有小脚本，没有方法，什么都没有。只是简单地展示预先存在的、控制器提供的数据，可能还有一些简单的案例和集合的迭代。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T11:27:34.007

很多优点。我可以列举我在上一个项目中使用的 JSF 优势。

*   导航的集中位置（如在 struts 中）
*   日期选择器、自动完成、分页等组件。
*   您有布局的渲染，这有助于很多布局逻辑。
*   瓷砖的可用性，如支柱。

JSP 没有明确区分业务逻辑和布局。

无论如何，尽管所有这些优势，如果你是一名 Java 程序员，我建议你看看**[Grails](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fwww.grails.org%2F&ei=stX-SfCnJZrKMoy-5bgE&usg=AFQjCNGIgpW3nOFVxqBZifqp9XE4d7Xd1Q&sig2=-_uLUqRDOe7312dK0fUHwg)**，它更舒服。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T11:38:14.247

JSP 非常原始，您基本上没有小部件并且必须自己构建所有东西。JSF 虽然改进并不是最好的 java web 框架——还有很多其他的框架可以让你获得更令人印象深刻的结果——例如 GWT。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:59:14.940

Benefits of Spring MVC:

*   The framework subtly encourages you to write better designed code: by using dependency injection, and splitting up your application design into domain (model) objects, controllers, service classes, DAOs, etc.
*   As a side effect of the first bullet point, your code ends up being **extremely** and easily unit-testable.

# c# - 动态创建 AJAX Accordian 控件

> ID：819685
> 
> 赞同：2
> 
> 时间：2009-05-04T11:10:41.067
> 
> 标签：c#, asp.net

我正在尝试在页面加载时动态创建 Accordian Controlls，代码方面，这是我目前所拥有的：

```
 // Create dynamic acordian control

                    AjaxControlToolkit.Accordion info = new AjaxControlToolkit.Accordion();
                    AjaxControlToolkit.AccordionPane infoPane = new AjaxControlToolkit.AccordionPane();

                    info.ID = hostelId;
                    info.FadeTransitions = true;
                    info.FramesPerSecond = 10;
                    info.TransitionDuration = 500;

                    Literal headerContent = new Literal();
                    headerContent.ID = hostelId + "_Header";
                    headerContent.Text = hostelName + " More Info ";

                    Literal content = new Literal();
                    content.ID = hostelId + "_Content";
                    content.Text = hostelName + " BOOM ";

                    infoPane.HeaderContainer.Controls.Add(headerContent);
                    infoPane.ContentContainer.Controls.Add(content);

                    info.Panes.Add(infoPane);

                    cell3.Controls.Add(info); 
```

当我运行页面时，显示 Accordian 控件的内容，但它只是文本而不是实际的手风琴。只是想知道是否有人可以指出我正确的方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T11:20:15.147

我猜你还需要`Accordion`在`ScriptManager`你的页面上添加 。

```
scriptManager.Controls.Add(info); 
```

另外，您是否尝试过在另一个事件处理程序中添加控件？`Init`至少根据[此 Microsoft Support page](http://support.microsoft.com/default.aspx/kb/317794) ，这似乎是您应该动态添加控件的事件。（我不记得我在 Web 应用程序中是在哪里完成的，但`Init`听起来不错。）

希望有帮助。

# emacs - 在哪个文件中定义了键绑定？

> ID：819696
> 
> 赞同：6
> 
> 时间：2009-05-04T11:17:04.157
> 
> 标签：emacs, keyboard-shortcuts, key-bindings

考虑 Emacs 中的击键，例如`C-x C-s`. 我可以通过键入来确定它调用了哪个函数，但是我怎样才能找到这个键绑定的定义位置呢？`C-h c *keystroke*`

（也许正确的答案是无法确定，因为键盘映射不存储此类信息。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T13:14:22.783

Emacs 不保存关于键绑定与函数关联的位置的信息。事实上，答案通常是不确定的。

很多时候，键绑定被设置为次要模式的副作用，或者通过模式挂钩。次要模式的键绑定通常存储在一些变量中，例如`comint-mode-map`. 通过设置 mode-variable 启用此键盘映射`comint-mode`。但是，该模式映射是一个全局变量，任何地方的任何人都可以向它添加键绑定。所以，做你想做的事情本质上是跟踪谁设置了一个具有特定值的变量。类似地，对于仅通过模式挂钩在本地设置的键绑定（使用`local-set-key`）。[此外，您甚至可以通过文件变量](http://www.gnu.org/software/emacs/manual/html_node/emacs/Specifying-File-Variables.html#Specifying-File-Variables)设置键绑定。所有这些只是说 Emacs 中的键绑定是短暂的。

您可以做的最好的事情是找到与密钥关联的功能，然后查看该文件（或任何相关文件，如果该模式被拆分为多个文件）。

由于您可以设置/关联击键的方式多种多样（全局、主要模式、次要模式、覆盖次要模式、缓冲区本地、文本属性等），因此 Emacs 中的键绑定查找相当复杂。如需快速概览，请查看[此文档](http://www.gnu.org/software/emacs/elisp/html_node/Searching-Keymaps.html)。

您可以编写这样的函数来查看次要模式以查看可能设置键绑定的位置，但当然我的第一个测试显示键绑定没有在那里定义。但也许代码会很有启发性。

```
(defun guess-where-keybinding-is-defined (key)
  "try to guess where a key binding might be defined"
  (interactive (list (read-key-sequence "Describe key: ")))
  (let ((bindings (minor-mode-key-binding key))
        found)
    (while (and bindings (not found))
      (if (setq found (caar bindings))
          (find-function (cdar bindings)))
      (setq bindings (cdr bindings))))) 
```

是否有您要解决的特定问题（除了这个问题）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T11:20:35.817

只需执行 Mx 查找功能

来自 Emacs 文档：

> （查找函数）
> 
> 求近点函数的定义。
> 
> 在缓冲区中查找包含函数近点定义的源文件（由 `function-called-at-point' 选择），并将点放在定义之前。如果缓冲区已经存在，则在移动之前设置标记。

# cocoa - 如何在 Mac OS X 中的“apple mail”和“entourage”中截取电子邮件？

> ID：819699
> 
> 赞同：2
> 
> 时间：2009-05-04T11:17:57.260
> 
> 标签：cocoa, macos, applescript

我想在 Mac OS X 中编写一个 AppleScript 或 Cocoa 应用程序，它将截取 AppleMail 和 Microsoft Entourage 中的电子邮件的屏幕截图。

我通过编写一个简单的 AppleScript 代码来做到这一点，但它需要页面的屏幕截图。如果电子邮件很长，我无法截取后续页面的屏幕截图。

你有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T12:26:51.540

您可以将电子邮件打印为 PDF 并将其转换为图像吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T11:36:23.220

这是一个古老的问题，也是一个难以解决的问题。

我解决它的方法是在向下滚动时每隔几微秒拍摄一次屏幕截图（或者最好是窗口的图像）。通过匹配像素线来重建图像。

不幸的是，我无法帮助您了解编程的细节，我猜您必须深入挖掘[WindowServer](http://developer.apple.com/documentation/Cocoa/UserExperience-date.html#//apple_ref/doc/uid/TP30000440-TP30000416-TP30000465)甚至更深入才能获取屏幕图像数据。

一旦你有了这个，重建将相对简单。

如果它只是需要捕获的长“网页”，您可以随时尝试使用[SnapWeb](http://www.tribalmedia.com/bts/SnapWeb/SnapWeb.html)，它使用 WebKit，就像 Safari 和 Mail 一样，并将长页面输出为一张图像，这至少解决了一半的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T13:43:15.287

这可能不是您想要的答案，但其他人已经设法解决了这个问题。有一项名为[LitmusApp](http://litmusapp.com/ "石蕊应用")的服务可以为许多电子邮件客户端和平台执行此操作。值得一看，他们有免费版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-06T18:46:05.150

如果您尝试保存电子邮件的内容，[此应用程序](http://homepage.mac.com/aamann/Mail_Scripts.html)可能是一个不错的选择。

# makefile - 条件测试中的自动变量：GNU Make

> ID：819700
> 
> 赞同：5
> 
> 时间：2009-05-04T11:20:02.730
> 
> 标签：makefile, gnu-make

我有点卡在这里。我们有两个 makefile（我无法更改的要求）

*   defs.mk：它包含源文件名和它们的额外编译标志（除了标准标志），例如：

```
C_FILES = c/src/main/rule_main.c
rule_main_OPTIONAL_FLAG = +w127
rule_main_DEBUG = TRUE

```

*   `Makefile`: 它包含所有规则。

现在我想添加一个工具，以便我可以定义文件特定的标志（和可选的文件特定的调试标志），如下所示：

```
CUSTOM_DEBUG_FLAG = $($(basename $(notdir $@))_DEBUG) ## rule_main_DEBUG macro from defs.mk
ifeq ($(CUSTOM_DEBUG_FLAG),TRUE)
  do something
endif 
```

但这不起作用，因为条件不支持自动变量的扩展。还有其他方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T11:51:35.400

我通常利用[条件函数](http://www.gnu.org/software/autoconf/manual/make/Conditional-Functions.html)：

```
SPECIFIC_FLAGS=$(if $(findstring $(CUSTOM_FLAG),TRUE),$(IF_TRUE),$(IF_FALSE)) 
```

或者使用[调用函数](http://www.gnu.org/software/make/manual/make.html#Call-Function)来定义我自己的函数：

```
debug_defs=$(if $(findstring $(1),file1 file2),-DDEBUG,-DNDEBUG)

%.o: src/$$(notdir %).c
    @cc -c $(CFLAGS) $(call debug_defs,$(notdir $(basename $@)) 
```

# c++ - Windows上套接字号的PID？

> ID：819708
> 
> 赞同：2
> 
> 时间：2009-05-04T11:22:28.310
> 
> 标签：c++, winapi, sockets, winsock, pid

我需要计算各种应用程序从网络发送和接收的字节数。一开始我考虑使用 LSP，但是有很多应用程序根本不使用 LSP（例如 SMB）。这就是我写一个小嗅探器的原因。此应用程序在 IP 级别上工作，并使用 recvfrom 收集数据。

所以我有远程主机、本地和远程端口的地址。这很酷，但我还需要本地套接字所有者的 PID。那么，有没有简单的方法来获得这样的PID呢？解决方法是使用 GetTcpTable、GetUdpTable 或 AllocateAndGetUdpExTableFromStack 和 AllocateAndGetTcpExTableFromStack（这些函数在 2k、XP、XP SP2 和 Vista 之间存在很多差异）并查找结果表，但它似乎不优雅且效率低下......

那么有没有一种“GetPIDOfSocket”函数呢？解决方案应仅是 WinAPI（无 .net），因为可以使用各种语言，例如 C++、Delphi。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T18:20:55.027

很抱歉不得不告诉您，但使用`GetTcpTable`or`AllocateAndGetTcpExTableFromStack`不是一种解决方法，这实际上是其他 netstat 类型应用程序的工作方式。AFAIK 没有 Win32`"GetPIDOfSocket"`功能，您唯一的选择是使用端口表功能进行轮询。但至少您可以自己编写代码，而不必产生 netstat 进程。

请参阅`netstatp` [此处](http://tinyurl.com/cy2kcw)的 SysInternals C 源代码。它的数量不多，值得一看。

# c++ - DuplicateHandle()，在第一个或第二个过程中使用？

> ID：819710
> 
> 赞同：5
> 
> 时间：2009-05-04T11:24:59.490
> 
> 标签：c++, winapi, ipc

Windows API DuplicateHandle() [http://msdn.microsoft.com/en-us/library/ms724251(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms724251(VS.85).aspx) 需要复制对象句柄以及原始进程和另一个进程的句柄你想使用重复的句柄。

我假设如果我有两个 UNRELATED 进程，只要我有所需的句柄可用，我可以在其中一个中调用 DuplicateHandle() 吗？

我的问题是关于使用管道在两个进程之间进行通信以通过事件实现这一点。

在第一个过程中我 CreateEvent()。现在我想在第二个过程中使用 WaitForSingleObject() 。

如果我尝试在第一个进程中复制句柄，我需要先通过管道将第二个进程句柄发送到第一个进程，复制句柄然后将句柄发送到第二个进程？

或者，我可以首先将第一个进程句柄和事件句柄发送到第二个进程，然后在那里复制它。

我有理由选择其中一个吗？

要添加一个皱纹，事件句柄实际上是从实际调用第一个进程（这是一个 CGI 应用程序）的父进程继承的。如果该事件句柄是使用 HANDLE_DO_NOT_DUPLICATE （类似的东西）创建的，那么我实际上可以使用 DuplicateHandle() 为第二个进程复制它吗？

回复：

好吧，我可以在第一个进程中创建一个新的 NAMED 事件，并按照建议在第二个进程中找到它，但是我试图复制在第一个进程的父进程中创建的事件并将其转发给第二个进程。此事件不是命名事件，因此我需要使用 DuplicateHandle()。

我正在为 IPC 使用管道。我意识到 DuplicateHandle() 必须在第一个进程中调用，因为事件句柄在发送到第二个进程时脱离了上下文。

```
 hProcPseudo  = GetCurrentProcess() 

    //Then call either:
        lpRealHandle = OpenProcess( PROCESS_DUP_HANDLE, 0, hProcPseudo ) 
//This fails with GetLastError= 87 - The parameter is incorrect ???
// same thing with PROCESS_ALL_ACCESS ??

    //OR
        lRet = DuplicateHandle( hProcPseudo, hProcPseudo, hProcPseudo, lpRealHandle, DUPLICATE_SAME_ACCESS, 0, 0 )

    //then I can Duplicate my Event Handle in the first thread with:
        lRet = DuplicateHandle( hLocalProcess, hEvent, lpRealHandle, hDupEvent, DUPLICATE_SAME_ACCESS, 0, 0) 
```

第二个过程使用上面详细说明的 DuplicateHandle() 转换其句柄

hProcPseudo= 4294967295

至

h进程= 152

然后我通过命名管道将此进程句柄传递给第一个进程。在第一个过程（事件句柄有效）中，我调用 Duplicate handle：

```
DuplicateHandle( hFirstProcess, hEvent, hSecondProc, hDupEvent, DUPLICATE_SAME_ACCESS, 0, 0) 
```

不幸的是，我得到了错误：

DuplicateHandle hPipeFCGI GetLastError= 6 - 句柄无效。

进一步的测试（替换 hFirstProcess）显示是 hSecondProc 无效！？？

大奥秘。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:36:30.210

为 IPC使用[命名管道](http://msdn.microsoft.com/en-us/library/aa365590(VS.85).aspx)或[邮槽，这应该可以可靠地满足您的目的。](http://msdn.microsoft.com/en-us/library/aa365576(VS.85).aspx)如果您需要等待，请使用命名的等待句柄。

否则，我会选择在第二个过程中执行 DuplicateHandle 以正确设置句柄所有权。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T06:42:31.827

进程句柄与进程 ID 不同。OpenProcess 采用进程 ID。使用类似...

HANDLE hProcess = OpenProcess(PROCESS_DUP_HANDLE, FALSE, GetCurrentProcessId());

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T11:36:20.897

如果我理解正确的话，你想通过同一个事件来同步两个不相关的进程。如果是这样，您可以使用命名事件。

[使用CreateEvent](http://msdn.microsoft.com/en-us/library/ms682396(VS.85).aspx) API 函数创建一个，为其提供名称，然后从第二个进程使用[OpenEvent](http://msdn.microsoft.com/en-us/library/ms684305(VS.85).aspx) API 函数，指定事件的名称。

您对其他同步对象也有类似的功能，例如互斥锁 ( [OpenMutex](http://msdn.microsoft.com/en-us/library/ms684315(VS.85).aspx) ) 或信号量 ( [OpenSemaphore](http://msdn.microsoft.com/en-us/library/ms684326.aspx) )。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-05T00:12:40.847

1.  不知何故，第二个进程需要将其进程 ID 传递给第一个进程。这可以通过[`GetCurrentProcessId()`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms683180(v=vs.85).aspx)
2.  第一个进程现在需要使用这个 ID 来获取`HANDLE`第二个进程：`hProcess = OpenProcess(PROCESS_DUP_HANDLE, FALSE, dwProcessId);`
3.  现在您可以复制第一个进程中的句柄，使用第二个进程的 REAL 进程句柄和第一个进程的伪句柄：`DuplicateHandle(GetCurrentProcess(), hEvent, hProcess, &hDupEvent, 0, FALSE, DUPLICATE_SAME_ACCESS);`
4.  请记住最终释放您创建的句柄`OpenProcess`（我不知道它会产生什么不同，但您应该......）。此外，释放事件的两个句柄：赋予第二个进程的句柄和初始句柄。

# c# - 如何编写一个轮询目录以查找新文件的 Windows 服务？

> ID：819714
> 
> 赞同：0
> 
> 时间：2009-05-04T11:28:48.887
> 
> 标签：c#, web-services

我做了一个窗口服务，它基本上是在我的机器上读取一个临时文件，将它读入数据库然后删除它。我已经在方法中编写了这些操作的代码`onStart`，因此当我需要它工作时我需要再次重新启动服务，但我真正需要的是服务应该自动感知我文件夹中文件的创建然后工作在上面。

那么我应该将这个特定代码放在我的 Windows 服务中的什么位置呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T11:38:51.967

由于 FileSystemWatcher 不能保证在所有文件系统更改时通知您，因此我建议您使用具有设定间隔的[Timer来轮询它。](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)这种方法在系统资源上也更容易。

在内部，FSW 缓冲从文件系统接收到的事件。如果同时发生太多事件，此缓冲区将溢出，您将开始丢失事件。除非您的事件处理程序代码真的很快完成或者您使用某种排队机制，否则您也将开始丢失事件。IMO，这使得 FSW 成为一种不到 100% 可靠的方法。

这是[一篇](http://p3net.mvps.org/Topics/Basics/FileSystemWatcher.aspx)更详细地讨论 FSW 与性能的文章。

关于系统资源的说明：FSW 依赖于向 OS 文件系统注册回调。我没有关于这在系统资源中占多少的指标。我建议使用定时器主动轮询系统不需要来自文件系统的此类资源。您可以每 30 秒或每 5 分钟轮询一次文件系统，具体取决于您需要多快获取文件。

除非你真的需要近乎实时的行为，那就是......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T11:34:58.030

文件系统观察器

[http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T12:12:45.723

也许组合方法可能有用？结合计时器和文件系统观察程序。

在写入文件时使用临时扩展名并在准备好时重命名也可能有助于防止在写入文件时读取文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-15T19:59:00.460

我最近创建的东西几乎与您所描述的完全一样。起初我以为我应该使用 FileSystemWatcher。问题是它只在事情发生时通知我。如果服务关闭并且由于某种原因必须重新启动，则当它启动时，它不会触发与服务关闭时创建的文件有关的任何事件。

所以我开始编写自己的轮询器，它会在服务启动时检查文件，然后使用 FileSystemWatcher。然后我开始思考，为什么还要费心使用 FileSystemWatcher 并且要维护 2 段代码？所以我完全放弃了它，只让我的轮询器完成所有工作，因为应用程序只需要一遍又一遍地执行轮询器在启动时所做的事情。

我的应用程序是 Windows 服务。OnStart 创建一个线程，该线程运行一个函数来进行轮询。该函数只是一个带有由 OnStop 触发的结束条件的 while 循环，它只是每分钟轮询一次并扫描目录。如果它找到了它处理的东西，如果没有它就休眠 1 分钟。很简单。该代码是基本的并且易于维护。

这是我的 OnStart 示例：

```
 protected override void OnStart(string[] args)
    {
        WriteToLog("Starting...");
        bThreadRun_m = true;

        tMain_m = new Thread(new ThreadStart(RunThread));
        tMain_m.Name = "Main Thread";
        tMain_m.Start();

        WriteToLog("Start Complete");
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:55:28.413

无论您使用计时器还是 FileSystemWatcher，两者都会触发您需要订阅的事件。当检测到文件时，会触发一个事件。这将启动一个执行事件处理程序的新线程。

因此，在您的 OnStart 方法中，您需要订阅该事件。为此，您的事件处理程序需要是一种可以从您的 OnStart() 以某种方式访问​​的方法。

作为记录，我被FSW烧了几次，不再使用它，我觉得它太不可靠了。我编写了自己的 FileWatcher 类，该类执行[Peter Lillevold](https://stackoverflow.com/questions/819714/how-do-i-write-a-windows-service-that-polls-a-directory-for-new-files/819740#819740)的建议并使用计时器重复轮询目录。也许有点粗糙，但它确实有效。你不能打败那个;-)

# java - 没有由 JAXB 生成的 @XmlRootElement

> ID：819720
> 
> 赞同：232
> 
> 时间：2009-05-04T11:32:19.970
> 
> 标签：java, jaxb, xjc, fpml

我正在尝试从 FpML（金融产品标记语言）4.5 版生成 Java 类。生成了大量代码，但我无法使用它。试图序列化一个简单的文档，我得到了这个：

```
javax.xml.bind.MarshalException
  - with linked exception: [com.sun.istack.SAXException2: unable
  to marshal type
  "org.fpml._2008.fpml_4_5.PositionReport"
  as an element because it is missing an
  @XmlRootElement annotation] 
```

事实上，**没有**类有 @XmlRootElement 注释，那么我做错了什么？我将 xjc (JAXB 2.1) 指向 fpml-main-4-5.xsd，然后它包括所有类型。

* * *

## 回答 #1

> 赞同：278
> 
> 时间：2010-01-31T19:15:06.603

为了将其他人已经陈述或暗示的内容联系在一起，JAXB XJC 决定是否将`@XmlRootElement`注释放在生成的类上的规则非常重要（[请参阅本文](http://web.archive.org/web/20160117210900/https://community.oracle.com/blogs/kohsuke/2006/03/03/why-does-jaxb-put-xmlrootelement-sometimes-not-always)）。

`@XmlRootElement`存在是因为 JAXB 运行时需要某些信息才能编组/解组给定对象，特别是 XML 元素名称和命名空间。您不能将任何旧对象传递给 Marshaller。`@XmlRootElement`提供此信息。

注释只是一种方便，但是 - JAXB 不需要它。替代方法是使用`JAXBElement`包装器对象，它提供与 相同的信息`@XmlRootElement`，但以对象的形式，而不是注释。

但是，`JAXBElement`构建对象很麻烦，因为您需要知道 XML 元素名称和名称空间，而业务逻辑通常不需要。

值得庆幸的是，当 XJC 生成一个类模型时，它也会生成一个名为`ObjectFactory`. 这部分是为了向后兼容 JAXB v1，但它也是 XJC 放置生成的工厂方法的地方，这些方法`JAXBElement`在您自己的对象周围创建包装器。它为您处理 XML 名称和命名空间，因此您无需担心。您只需要浏览这些`ObjectFactory`方法（对于大型模式，可能有数百个）以找到您需要的方法。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2011-05-03T13:18:29.243

在上面已经链接的博客文章的底部提到了这一点，但这对我来说就像一种享受：

```
Marshaller marshaller = jc.createMarshaller();
marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
marshaller.marshal(new JAXBElement<MyClass>(new QName("uri","local"), MyClass.class, myClassInstance), System.out); 
```

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2013-02-27T16:27:01.513

正如上述答案之一所暗示的那样，如果在 XSD 中将其类型定义为命名类型，您将不会在根元素上获得 XMLRootElement，因为该命名类型可以在 XSD 中的其他地方使用。尝试将其标记为匿名类型，即代替：

```
<xsd:element name="myRootElement" type="MyRootElementType" />

<xsd:complexType name="MyRootElementType">
...
</xsd:complexType> 
```

你将会拥有：

```
<xsd:element name="myRootElement">
    <xsd:complexType>
    ...
    <xsd:complexType>
</xsd:element> 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2011-08-09T15:22:59.147

解组不需要@XmlRootElement - 如果使用 Unmarshaller#unmarshall 的 2 参数形式。

所以，如果不是这样做：

```
UserType user = (UserType) unmarshaller.unmarshal(new StringReader(responseString)); 
```

应该这样做：

```
JAXBElement<UserType> userElement = unmarshaller.unmarshal(someSource, UserType.class);
UserType user = userElement.getValue(); 
```

后面的代码在 UserType 类级别不需要 @XmlRootElement 注释。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2012-05-16T07:13:06.703

[您可以使用How to generate @XmlRootElement Classes for Base Types in XSD? 中](https://stackoverflow.com/questions/1514110/how-to-generate-xmlrootelement-classes-for-base-types-in-xsd)的绑定来解决此问题？.

这是一个 Maven 的例子

```
 <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>jaxb2-maven-plugin</artifactId>
            <version>1.3.1</version>
            <executions>
                <execution>
                    <id>xjc</id>
                    <goals>
                        <goal>xjc</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <schemaDirectory>src/main/resources/xsd</schemaDirectory>
                <packageName>com.mycompany.schemas</packageName>
                <bindingFiles>bindings.xjb</bindingFiles>
                <extension>true</extension>
            </configuration>
        </plugin> 
```

这是`binding.xjb`文件内容

```
<?xml version="1.0"?>
<jxb:bindings version="1.0" xmlns:jxb="http://java.sun.com/xml/ns/jaxb"
              xmlns:xjc= "http://java.sun.com/xml/ns/jaxb/xjc"
              jxb:extensionBindingPrefixes="xjc" xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <jxb:bindings schemaLocation="path/to/myschema.xsd" node="/xs:schema">
        <jxb:globalBindings>
            <xjc:simple/>
        </jxb:globalBindings>
    </jxb:bindings>
</jxb:bindings> 
```

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2010-12-30T15:58:30.220

乔的回答（乔 2009 年 6 月 26 日在 17:26）为我做了。简单的答案是，如果您编组 JAXBElement，则没有 @XmlRootElement 注释是没有问题的。让我感到困惑的是，生成的 ObjectFactory 有 2 个 createMyRootElement 方法——第一个不带参数并给出未包装的对象，第二个采用未包装的对象并将其返回包装在 JAXBElement 中，并且编组 JAXBElement 可以正常工作。这是我使用的基本代码（我是新手，如果此回复中的代码格式不正确，请致歉），主要来自[链接文本](http://jaxb.java.net/tutorial/section_4_5-Calling-marshal.html#Calling%20marshal)：

```
ObjectFactory objFactory = new ObjectFactory();
MyRootElement root = objFactory.createMyRootElement();
...
// Set root properties
...
if (!writeDocument(objFactory.createMyRootElement(root), output)) {
    System.err.println("Failed to marshal XML document");
}
...

private boolean writeDocument(JAXBElement document, OutputStream output) {

  Class<?> clazz = document.getValue().getClass();
  try {
    JAXBContext context =
        JAXBContext.newInstance(clazz.getPackage().getName());
    Marshaller m = context.createMarshaller();
    m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
    m.marshal(document, output);
    return true;

  } catch (JAXBException e) {
    e.printStackTrace(System.err);
    return false;
  }
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2016-02-18T18:15:49.133

如您所知，答案是使用 ObjectFactory()。这是对我有用的代码示例:)

```
ObjectFactory myRootFactory = new ObjectFactory();

MyRootType myRootType = myRootFactory.createMyRootType();

try {

        File file = new File("./file.xml");
        JAXBContext jaxbContext = JAXBContext.newInstance(MyRoot.class);
        Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

        //output pretty printed
        jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

        JABXElement<MyRootType> myRootElement = myRootFactory.createMyRoot(myRootType);

        jaxbMarshaller.marshal(myRootElement, file);
        jaxbMarshaller.marshal(myRootElement, System.out);

    } catch (JAXBException e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-03-03T12:01:54.457

经过两天的挣扎，我找到了问题的解决方案。您可以使用**ObjectFactory**类来解决没有**@XmlRootElement**的类。ObjectFactory 具有将其包装在 JAXBElement 周围的重载方法。

**方法：1**进行对象的简单创建。

**Method:2**将使用**@JAXBElement**包装对象。

始终使用**Method:2**来避免 javax.xml.bind.MarshalException - 链接异常缺少 @XmlRootElement 注释。

请在下面找到示例代码

**方法：1**做对象的简单创建

```
public GetCountry createGetCountry() {
        return new GetCountry();
    } 
```

**Method:2**将使用**@JAXBElement**包装对象。

```
 @XmlElementDecl(namespace = "my/name/space", name = "getCountry")
 public JAXBElement<GetCountry> createGetCountry(GetCountry value) {
        return new JAXBElement<GetCountry>(_GetCountry_QNAME, GetCountry.class, null, value);
    } 
```

**工作代码示例：**

```
ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext("applicationContext.xml");
WebServiceTemplate springWSTemplate = context.getBean(WebServiceTemplate.class);

GetCountry request = new GetCountry();
request.setGuid("test_guid");

JAXBElement<GetCountryResponse> jaxbResponse = (JAXBElement<GetCountryResponse>)springWSTemplate .marshalSendAndReceive(new ObjectFactory().createGetCountry(request));

GetCountryResponse response = jaxbResponse.getValue(); 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-11-26T15:44:10.913

万一我对这个问题的经历给了某人一个尤里卡！时刻..我将添加以下内容：

当使用我使用 IntelliJ 的“从实例文档生成 xsd”菜单选项生成的 xsd 文件时，我也遇到了这个问题。

当我接受这个工具的所有默认值时，它生成了一个 xsd 文件，当与 jaxb 一起使用时，生成的 java 文件没有`@XmlRootElement`. 在运行时，当我尝试编组时，我得到了与这个问题中讨论的相同的异常。

我回到 IntellJ 工具，在“设计类型”下拉菜单中看到了默认选项（当然我不明白……老实说，我仍然不明白）是：

设计类型：

> **“局部元素/全局复杂类型”**

我把它改成了

> **“本地元素/类型”**

，现在它生成了一个（基本上）不同的 xsd，它`@XmlRootElement`在与 jaxb 一起使用时产生了。不能说我了解它的来龙去脉，但它对我有用。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-06-18T15:38:42.397

它也不适合我们。但是我们确实找到了一篇被广泛引用的文章，它添加了一些背景......为了下一个人，我会在这里链接到它：[http ://weblogs.java.net/blog/kohsuke/archive/2006/03 /why_does_jaxb_p.html](http://weblogs.java.net/blog/kohsuke/archive/2006/03/why_does_jaxb_p.html)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2012-06-07T10:13:28.160

使用 Maven 构建，您可以添加`@XmlRootElement`注释

用“ `jaxb2-basics-annotate`”插件。

查看更多信息：见

[配置 Maven 以使用 JAXB 从 XML Schema 生成类](http://azagorneanu.blogspot.be/2011/09/configure-maven-to-generate-classes.html)

和[JAXB XJC 代码生成](https://codereview.stackexchange.com/questions/1877/jaxb-xjc-code-generation-adding-xmlrootelement-and-joda-datetime)

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2017-08-09T15:31:08.710

JAXBElement 包装器适用于`@XmlRootElement`JAXB 生成 no 的情况。这些包装器在`ObjectFactory`由`maven-jaxb2-plugin`. 例如：

```
 public class HelloWorldEndpoint {
        @PayloadRoot(namespace = NAMESPACE_URI, localPart = "person")
        @ResponsePayload
        public JAXBElement<Greeting> sayHello(@RequestPayload JAXBElement<Person> request) {

        Person person = request.getValue();

        String greeting = "Hello " + person.getFirstName() + " " + person.getLastName() + "!";

        Greeting greet = new Greeting();
        greet.setGreeting(greeting);

        ObjectFactory factory = new ObjectFactory();
        JAXBElement<Greeting> response = factory.createGreeting(greet);
        return response;
      }
 } 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2011-05-02T22:40:21.170

你试过这样改变你的xsd吗？

```
<!-- create-logical-system -->
<xs:element name="methodCall">
  <xs:complexType>
    ...
  </xs:complexType>
</xs:element> 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-03-30T07:25:18.420

该主题相当古老，但在企业业务环境中仍然相关。我尽量避免触摸 xsd，以便将来轻松更新它们。这是我的解决方案..

# 1\. 多半`xjc:simple`就够了

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<jxb:bindings version="2.0" xmlns:jxb="http://java.sun.com/xml/ns/jaxb"
    xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
    jxb:extensionBindingPrefixes="xjc">

    <jxb:globalBindings>
        <xjc:simple/> <!-- adds @XmlRootElement annotations -->
    </jxb:globalBindings>

</jxb:bindings> 
```

它将主要创建用于导入 xsd 定义的 XmlRootElements。

# 2.划分你的`jaxb2-maven-plugin`执行

我遇到过，如果您尝试从多个 xsd 定义而不是每个 xsd 的执行定义生成类，它会产生巨大的差异。

因此，如果您有一个包含多个`<source>`'s 的定义，而不仅仅是尝试拆分它们：

```
 <execution>
            <id>xjc-schema-1</id>
            <goals>
              <goal>xjc</goal>
            </goals>
            <configuration>
              <xjbSources>
                <xjbSource>src/main/resources/xsd/binding.xjb</xjbSource>
              </xjbSources>
              <sources>
                <source>src/main/resources/xsd/definition1/</source>
              </sources>
              <clearOutputDir>false</clearOutputDir>
            </configuration>
          </execution>

          <execution>
            <id>xjc-schema-2</id>
            <goals>
              <goal>xjc</goal>
            </goals>
            <configuration>
              <xjbSources>
                <xjbSource>src/main/resources/xsd/binding.xjb</xjbSource>
              </xjbSources>
              <sources>
                <source>src/main/resources/xsd/definition2/</source>
              </sources>
              <clearOutputDir>false</clearOutputDir>
            </configuration>
          </execution> 
```

生成器不会捕捉到一个类可能就足够的事实，因此每次执行都会创建自定义类。这正是我需要的；）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-11-15T15:14:45.370

要解决它，您应该在使用 wsimport 编译之前配置一个 xml 绑定，将 generateElementProperty 设置为 false。

```
 <jaxws:bindings wsdlLocation="LOCATION_OF_WSDL"
      xmlns:jaxws="http://java.sun.com/xml/ns/jaxws"
      xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc" 
      xmlns:xs="http://www.w3.org/2001/XMLSchema"
      xmlns:jxb="http://java.sun.com/xml/ns/jaxb"
      xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">
         <jaxws:enableWrapperStyle>false</jaxws:enableWrapperStyle>
    <jaxws:bindings  node="wsdl:definitions/wsdl:types/xs:schema[@targetNamespace='NAMESPACE_OF_WSDL']">
      <jxb:globalBindings xmlns:jxb="http://java.sun.com/xml/ns/jaxb" xmlns:xs="http://www.w3.org/2001/XMLSchema">
            <xjc:generateElementProperty>false</xjc:generateElementProperty> 
      </jxb:globalBindings>
  </jaxws:bindings>
</jaxws:bindings> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-08-26T23:46:47.500

所以我使用 mavens`maven-jaxb2-plugin`从一个大而复杂的 WSDL 文件生成类并遇到了这个问题。问题在于 WSDL 中的元素将`complexType`定义引用为`type`未生成的元素类，并且在尝试使用 complexType 类时会产生缺失的`@XmlRootElement`错误。

在我看来，修改 WSDL 并不是一个真正可行的解决方案，唯一可行的方法似乎是设计一种在生成期间添加缺失注释的方法。它还在编组时导致序列化问题，因为请求发送了错误的元素名称，并且响应中也没有具有匹配元素名称的类。

我最终做的是使用第二个 maven 插件`jaxb2-basics-annotate`，它允许您通过使用 jaxb 绑定文件将缺少的注释添加到所需的类中。这使您不必在不添加不必要的代码的情况下解决这个问题，并且还意味着如果您将来需要使用更新的 WSDL 文件，您可以轻松地重新生成。

**pom.xml**（注意配置中有一个插件部分用于执行 - WSDL 文件位置是 /src/main/resources/wsdl/EstimatingService.wsdl）

```
<project>
    ...
    <properties>
        <maven.compiler.source>11</maven.compiler.source>
        <maven.compiler.target>11</maven.compiler.target>
        <jaxb2.version>0.14.0</jaxb2.version>
        <jaxb2.annotate.version>1.1.0</jaxb2.annotate.version>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.jvnet.jaxb2.maven2</groupId>
            <artifactId>maven-jaxb2-plugin</artifactId>
            <version>${jaxb2.version}</version>
        </dependency>
        <dependency>
            <groupId>org.jvnet.jaxb2_commons</groupId>
            <artifactId>jaxb2-basics-annotate</artifactId>
            <version>${jaxb2.annotate.version}</version>
        </dependency>
    </dependencies>

    <build>
        <plugins>
            <plugin>
                <groupId>org.jvnet.jaxb2.maven2</groupId>
                <artifactId>maven-jaxb2-plugin</artifactId>
                <version>${jaxb2.version}</version>
                <executions>
                    <execution>
                        <id>estimating</id>
                        <goals>
                            <goal>generate</goal>
                        </goals>
                        <configuration>
                            <schemaLanguage>WSDL</schemaLanguage>
                            <generateDirectory>target/generated-sources/acme/src/gen/estimating-service</generateDirectory>
                            <generatePackage>com.acme.shipping.estimating.service</generatePackage>
                            <schemaDirectory>${project.basedir}/src/main/resources/wsdl</schemaDirectory>
                            <schemaIncludes>
                                <include>EstimatingService.wsdl</include>
                            </schemaIncludes>
                            <bindingDirectory>${project.basedir}/src/main/resources/bindings</bindingDirectory>
                            <bindingIncludes>estimateServiceBinding.xjb</bindingIncludes>
                            <extension>true</extension>
                            <args>
                                <arg>-Xannotate</arg>
                                <arg>-XremoveAnnotation</arg>
                            </args>
                            <plugins>
                                <plugin>
                                    <groupId>org.jvnet.jaxb2_commons</groupId>
                                    <artifactId>jaxb2-basics-annotate</artifactId>
                                </plugin>
                            </plugins>
                        </configuration>
                    </execution>
                    ...
                    // More executions here if you have multiple WSDL files (Dont forget to give it a different package name and id)
                </executions>
            </plugin>
        </plugins>
    </build>
    ...
</project> 
```

**estimateServiceBinding.xjb**（本示例中使用的 jaxb 绑定文件 - /src/main/resources/bindings/estimateServiceBinding.xjb）

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<jaxb:bindings version="2.0" xmlns:jaxb="http://java.sun.com/xml/ns/jaxb" xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:annox="http://annox.dev.java.net" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/">
    <jaxb:globalBindings generateElementProperty="false">
        <xjc:simple />
    </jaxb:globalBindings>
    <!-- Target the schema section in the WSDL file using the given target namespace which contains the complexType definitions we want to annotate -->
    <jaxb:bindings schemaLocation="../wsdl/EstimatingService.wsdl" node="//xs:schema[@targetNamespace='http://acme.com/schema/datatypes/v2']">
        <jaxb:bindings node="xs:complexType[@name='GetQuickEstimateRequestContainer']">
            <!-- Add the @XmlRootElement annotation to the generated class and then tell it use the correct element name required when marshalling. e.g GetQuickEstimateRequestContainer element is renamed to the element name that referenced it in the WSDL (GetQuickEstimateRequest) -->
            <annox:annotateClass>@javax.xml.bind.annotation.XmlRootElement(name="GetQuickEstimateRequest")</annox:annotateClass>
        </jaxb:bindings>
        <jaxb:bindings node="xs:complexType[@name='GetQuickEstimateResponseContainer']">
            <annox:annotateClass>@javax.xml.bind.annotation.XmlRootElement(name="GetQuickEstimateResponse")</annox:annotateClass>
        </jaxb:bindings>
    </jaxb:bindings>
</jaxb:bindings> 
```

**生成的类**(GetQuickEstimateRequestContainer.java) 带有 @XmlRootElement 注释和正确的元素名称

```
@XmlRootElement(name = "GetQuickEstimateRequest")
public class GetQuickEstimateRequestContainer {
    ...
    // class member fields & setters and getters
    ...
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-11-30T18:51:46.993

我只是在同样的问题上挣扎了一段时间，只想发布我的最终结果，这对我来说很好。所以基本问题是：

*   我必须从没有*XmlRootElement*注释的 JAXB 类实例生成 xml 字符串
*   这些类需要额外的类来绑定编组过程

下面的类可以很好地解决这个问题：

```
public class Object2XmlConverter {

    public static <T> String convertToString(final T jaxbInstance, final Class<?>... additionalClasses)
            throws JAXBException {
        final Class<T> clazz = (Class<T>) jaxbInstance.getClass();

        final JAXBContext jaxbContext;
        if (additionalClasses.length > 0) {
            // this path is only necessary if you need additional classes to be bound
            jaxbContext = JAXBContext.newInstance(addClassesToBeBound(clazz, additionalClasses));
        } else {
            jaxbContext = JAXBContext.newInstance(clazz);
        }

        final QName qname = new QName("", jaxbInstance.getClass().getSimpleName());
        final JAXBElement<T> jaxbElement = new JAXBElement<T>(qname, clazz, null, jaxbInstance);

        final Marshaller jaxbMarshaller = jaxbContext.createMarshaller();
        jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);

        final StringWriter stringWriter = new StringWriter();
        jaxbMarshaller.marshal(jaxbElement, stringWriter);
        return stringWriter.toString();
    }

    private static <T> Class<?>[] addClassesToBeBound(final Class<T> clazz, final Class<?>[] additionalClasses) {
        final Class<?>[] classArray = new Class<?>[additionalClasses.length + 1];
        for (int i = 0; i < additionalClasses.length; i++) {
            classArray[i] = additionalClasses[i];
        }
        classArray[classArray.length - 1] = clazz;
        return classArray;
    }

    public static void main(final String[] args) throws Exception {
        final Ns1TargetHeaderTyp dataTyp = ...;
        System.out.println(convertToString(dataTyp));
    }
} 
```

# installation - 从 MSI 安装程序中删除修复选项屏幕

> ID：819722
> 
> 赞同：6
> 
> 时间：2009-05-04T11:32:55.413
> 
> 标签：installation, windows-installer, option, repair

我为我的应用程序的 P&D 创建了一个标准 MSI 安装程序，它使用以下组件：

*   作为 Windows 服务托管的 WCF 服务。
*   与该服务通信的 GUI 应用程序。
*   一个外壳扩展 Dll。

安装程序工作得很好，没有任何问题。当用户尝试使用 MSI 安装程序在现有应用程序上再次安装应用程序时，会出现此问题。目前，它提供了带有“修复”和“删除”两个选项的屏幕。这两个选项都不起作用并破坏了安装的应用程序。

我想要的是跳过此屏幕并显示类似于 MessageBox 的内容，说明应用程序已安装。因为我不需要向用户提供修复选项。至少我应该能够隐藏或以某种方式不提供修复选项。

对我有什么帮助或建议吗？所以，到目前为止，我已经尝试了很多东西，比如使用 ORCA 添加 NotRepair 属性等。但它们都没有奏效。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T18:25:18.963

查看 MSDN 上的*Windows Installer Guide*了解这两个属性：

*   [ARPNO修改](http://msdn.microsoft.com/en-us/library/aa367590(VS.85).aspx)
*   [ARPNOREPAIR](http://msdn.microsoft.com/en-us/library/aa367592(VS.85).aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-06-24T18:57:17.050

接受的答案为没有很多安装经验的人留下了一些东西。

为此，您必须在 .NET 安装版本创建 .MSI 后对其进行编辑。微软支持的简单方法是[Orca](http://msdn.microsoft.com/en-us/library/aa370557%28v=vs.85%29.aspx)。您可以从[.NET Framework SDK](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=3138)安装 Orca 。如果您认为您已经拥有 SDK，但开始菜单中没有 Orca，请在您的机器上搜索“Orca.exe”或“Orca.msi”。

安装 Orca 后，只需运行它。使用 Orca UI 打开您的 MSI 文件。在左侧，您将看到“表格”列表。选择表*属性*。在右侧窗格中，右键单击并添加。添加一个名为`ARPNOREPAIR`. 确保将值设置为空字符串`""`。`ARPNOMODIFY`如果您不希望更改选项显示在程序的窗口中，还可以添加一个节点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-11T08:02:53.520

我同意 Henrik 的观点，但在我的情况下是最后一步

> 使用 Dialog_ 'MaintenanceForm' 和 Control 'RepairRadioGroup' 查找并删除条目。

导致 2814 错误。
所以我的建议是：让 RepairRadioGroup 不可见。为此，只需将其[属性](http://msdn.microsoft.com/en-us/library/aa368042%28v=vs.85%29.aspx)设置为 0

> 更新控件集属性 = 0 WHERE 控件 = 'RepairRadioGroup'

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-19T08:52:46.337

意识到这个问题已经有好几年了，但我想像我这样的人仍然会遇到这个问题。Sumeet 在对已接受解决方案的评论中提到，用户仍然可以使用显示的“修复”和“删除”这两个选项进入屏幕。

事实上，用户可以通过三种不同的方式访问应用程序的安装程序。

一：正如已经回答的 ARPNOMODIFY 和 ARPNOREPAIR 仅修复了添加删除程序中的问题，可以使用“Orca.exe”完成。

二：通过右键单击 msi 的安装程序。可悲的是，如果不对所有 msi 文件在计算机范围内进行调整，似乎就无法避免这两种选择。

三：通过双击安装程序，如果已经安装，则会出现一个带有单选按钮“修复”和“删除”的屏幕。

在下面找到了解决第三个访问点的巧妙改编，在这里有些重写：http: [//us.generation-nt.com/there-way-disable-remove-repair-option-through-orca-project-properties-帮助 49010162.html](http://us.generation-nt.com/there-way-disable-remove-repair-option-through-orca-project-properties-help-49010162.html)。它以图形方式删除了允许修复选项的选择。我要感谢 Paul Brun。

1.  使用 Orca.exe 打开 msi 文件。
2.  进入表“属性”。
3.  添加键 'ARPNOMODIFY' 和 value `1`。
4.  添加键 'ARPNOREPAIR' 和 value `1`。
5.  将属性“MaintenanceForm_Action”的值从 更改`Repair`为`Remove`。
6.  进入表“控制”。
7.  找到带有 Dialog_'MaintenanceForm' 和 Control 'BodyText' 的条目。
8.  将“文本”属性更改为： `{\VSI_MS_Sans_Serif13.0_0_0}Select "Finish" to remove [ProductName]`
9.  找到带有 Dialog_'MaintenanceForm' 和 Control 'RepairRadioGroup' 的条目。
10.  将“Control_Next”属性从 更改`CancelButton`为`FinishButton`。
11.  使用 Dialog_ 'MaintenanceForm' 和 Control 'RepairRadioGroup' 查找并删除条目。

与执行上述步骤相关的可能是通过仅执行一次步骤获得的转换来自动调整 msi 的过程。可以在此处找到有关如何执行此操作的更多信息：[使用 Orca 从命令行编辑 msi？](https://stackoverflow.com/questions/886842/use-orca-to-edit-msi-from-command-line)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-09T12:08:12.800

如果你通过 installshield 来编辑你的 ISM 文件，这会容易得多。要从添加/删除程序屏幕禁用`Change`和按钮，请将以下设置设置为选项卡 >导航窗格中的节点 > 导航窗格中的节点 >详细窗格中的部分`Repair``Yes``Installation Designer``Installation Information``General Information``Add or Remove Programs`

1.  `Disable Change Button`
2.  `Disable Repair Button`

[![在此处输入图像描述](https://i.stack.imgur.com/yK0n2.png)](https://i.stack.imgur.com/yK0n2.png)

要解决第二个问题，您可以简单地修改`MaintenanceWelcome`installshield 的内置对话框屏幕。

1.  将欢迎消息标签的文本更改为一些错误消息，例如“已安装此产品的另一个版本。安装无法继续。”
2.  在单击`Next`按钮的行为中，只需添加`EndDialog`事件。将其执行条件设置为`1`使其始终执行。将其设置`Value`为`Exit`
3.  `Next`将按钮的文本更改为“完成”。
4.  如果需要，禁用或隐藏`Cancel`按钮。

你都准备好了！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-25T06:58:45.540

我将 setup.exe 和 MSI 封装在一个 EXE 文件中。单击哪个会提取文件并触发 Setup.exe。在那个 exe 中，我添加了一个代码来检查应用程序是否已经安装在机器中。如果安装了它，我会提示用户并退出。这样，如果应用程序已经安装，则永远不会启动 MSI，因此永远不会出现修复和删除屏幕。关于添加/删除屏幕中的更改按钮，我使用了“CheGueVerra”提供的解决方案。谢谢你。

# c# - C#反射问题：如何询问一个类是否有一个名为的对象

> ID：819725
> 
> 赞同：0
> 
> 时间：2009-05-04T11:33:37.487
> 
> 标签：c#, reflection

我的代码中有一个类的多个实例，每个实例都有不同的配置等。这个类有一个委托事件处理程序方法，它从发送者接收事件，然后需要对上述对象之一执行一些操作。

我想知道反射是否可以解决这个问题。

```
private CatClass cat1;
private CatClass cat2;
private CatClass cat3; 
```

我想避免单独检查每个实例以查看它是否是我想要的对象。但希望以某种方式检索发送事件已识别的对象实例。

所以

```
private void delegateHandler(string senderName, object sender, CustomEventType evt)
{
     // given reciept of the senderName string,
     // how do I perform an action on say the cat2 object

    // Is it possible to ask the class if it has an object defined
    // called 'cat2' and then proceed with performing an action on that object
} 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T11:39:50.123

这极不可能达到您想要的方式？出于好奇，发件人不会给你一个合适的例子吗？如果没有，那么您应该将拍摄的 CatClass 实例放入 Dictionary 并在需要时搜索该字典。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T11:40:27.610

如果您“告诉”而不是“询问”，C# 会更好地工作。

换句话说，最好有一个接口或基类，其中`CatClass`声明了成员，这将允许您使用该接口类型或基类的变量而不是使用反射。我唯一担心的是，由于您希望使用的成员是私有的，这将阻止您使用界面。

您是否真的在使用通过反射深入到发送方来检索私有成员的处理程序？也许你应该重新考虑你的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T11:41:14.817

您可以为此使用反射，但我建议不要这样做。反射很慢，这不太可能是需要它的情况。

为什么没有字典（当您想按名称查找它们时）、列表或 CatClass 数组并迭代它们以查看您需要哪一个？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T12:07:06.157

好吧，就像上面提到的帖子一样，反射通常是一个坏主意。

```
this.GetType().GetMember(senderName) == null; 
```

不过可能会在这里工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-02T20:44:38.780

我怀疑你是否在乎这一点，但你关于如何在反思中解决这个问题的具体问题从未得到解答。这基本上是你将如何做到的。

```
private void delegateHandler(string senderName, object sender, CustomEventType evt)
{
    FieldInfo field = this.GetType().GetField(senderName, BindingFlags.NonPublic | BindingFlags.Instance);
    if(field != null && field.Name == senderName)
    {
        CatClass cat = (CatClass)field.GetValue(this);
        cat.DoWork();
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-02T21:08:42.200

有不同的方法来解决这个问题。反思当然不是正确的选择。

一种方法是使用一系列猫

```
Cat[] cats = new Cat[] { new Cat(), new Cat(), new Cat() }; 
```

而不是使用猫名，您将使用猫号

```
private void delegateHandler(int catNumber, object sender, CustomEventType evt)
{
    DoSomethingWith(cats[catNumber]);
} 
```

另一种方法是将猫本身作为发送者传递（这是使用事件处理程序做事的常用方法）

```
private void delegateHandler(object sender, CustomEventType evt)
{
    Cat cat = (Cat)sender;
    DoSomethingWith(cat);
} 
```

还有一种方法是给每只猫一个名字属性

```
public class Cat
{
    public string Name { get; set; }

    // Other properties and methods       
} 
```

然后用字典来存储猫

```
var catsByName = new Dictionary<string, Cat>();
Cat cat = new Cat { Name = "Tiger" };
catsByName.Add(cat.Name, cat);
... 
```

然后你可以像这样通过它的名字得到一只猫

```
cat = catsByName["Tiger"]; 
```

或者如果你不确定猫是否存在

```
if (catsByName.TryGetValue("Misty", out cat)) {
    DoSomethingWith(cat);
} else {
    CatNotFound();
} 
```

# excel - 如何从 Excel 加载项运行托管的 Ironpython 1.1？

> ID：819727
> 
> 赞同：0
> 
> 时间：2009-05-04T11:34:21.807
> 
> 标签：excel, com, ironpython

我正在编写一个托管 IronPython 1.1 的 Excel 加载项，并且我想将 Excel.Application COM 对象提供给 PythonEngine 实例。

我的 C# 可以很好地访问 COM 对象的成员。但是，当我的 IronPython 脚本访问 COM 对象的成员时，我收到“System.ArgumentException：'System.Int32' 类型的对象无法转换为'System.UInt32&' 类型。”

这是我托管 IronPython 1.1 的 C# 代码：

```
public void ExecuteFile(string path) {
    // see if COM object works
    Debug.WriteLine(Globals.ThisAddIn.Application.ActiveWindow.Caption); 

    engine.Globals.Add("excel", Globals.ThisAddIn.Application);

    try
    {
        engine.ExecuteFile(path);
    }
    catch (Exception ex)
    {
        Debug.WriteLine(ex);
    }
} 
```

这是我的 IronPython 测试脚本：

`excel.ActiveSheet.Range['A1'].Value2 = 42`// 抛出上面提到的异常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T16:27:24.003

我相信要设置 .Value 你需要用数据类型“索引”它；改为设置 .Value2 更方便（可以直接设置）。那么如果在那个 Python 作业中使用 .Value2 而不是 .Value 会发生什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T09:10:56.867

一篇带有解释和解决方案的好文章在这里：

[http://codeidol.com/csharp/c-sharp-in-office/Working-with-Excel-Objects/Special-Excel-Issues/](http://codeidol.com/csharp/c-sharp-in-office/Working-with-Excel-Objects/Special-Excel-Issues/)

基本上，我选择禁用包装 Excel COM 对象的 VSTO 代理。可以通过 AssemblyInfo.cs 中的这一行来完成：

[程序集：ExcelLocale1033(false)]

# sql - 使用 Sql 检索 DateTime 对象的问题

> ID：819741
> 
> 赞同：0
> 
> 时间：2009-05-04T11:39:02.077
> 
> 标签：sql, sql-server

给定日期 2009/04/30，在我想检索所有日期 <= 2009/04/30 和 >= 2009/04/30 的行中。sql语句是这样的：

```
select dateColumn from someTable where dateColumn <= '2009/4/30'

select dateColumn from someTable where dateColumn >= '2009/4/30' 
```

上面的 2 个语句运行，但第一个语句返回 2009/04/30 以下的所有日期，即使它出现在数据库中，它似乎也排除了日期。知道为什么会发生这种情况吗？如何比较 sql 中 DateTime 对象的日期部分？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T11:43:18.680

`SQL Server`存储日期和时间。

```
select dateColumn from someTable where dateColumn <= '2009/4/30' 
```

返回小于或等于 的所有日期`2009/4/30 00:00:00`。

如果您的日期至少`1/300`大几秒，例如`2009/4/30 00:00:00.003`，则不会返回。

您需要像这样选择：

```
select dateColumn from someTable where dateColumn < '2009/5/01' 
```

或像这样：

```
select dateColumn from someTable where dateColumn < DATEADD(day, 1, '2009/4/30') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T11:44:14.653

该列是否包含时间数据？如所写，第一个查询将返回 dateColumn 在 12:00 AM（午夜）小于或等于 2009/4/30 的记录。您可以使用 CAST 或 CONVERT 仅比较时间部分，但在这种情况下，最简单的答案是将第一个查询更改为：

```
select dateColumn from someTable where dateColumn < '2009/5/1' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T11:44:44.120

第一个查询隐式地将您的日期字符串转换为`datetime`. 这种转换产生：

```
2009-04-30 00:00:00.000 
```

排除的日期是否可能在当天，但在稍后的时间会被上述值排除？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T13:14:37.197

**从 someTable 中选择 dateColumn 其中 dateColumn 在 dateadd(dd,-1,'2009/4/30') 和 dateadd(dd,1,'2009/4/30') 之间**

此查询将在您指定的两个日期之间选择具有 dateColumn 值的列，包括它们。希望它能解决您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T11:43:43.687

不要将日期与字符串进行比较。

[http://rtipton.wordpress.com/2009/01/18/converting-dates-in-sql-server/](http://rtipton.wordpress.com/2009/01/18/converting-dates-in-sql-server/)

至于获取日期部分，日期在内部表示为浮点数，其中 1 是一天。

```
CONVERT(DATETIME, CONVERT(INT, GETDATE())) 
```

将执行您想要的日期时间到日期转换。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T11:44:15.010

当您将日期指定为字符串且未指定时间时，它将使用该日期的午夜 (12:00 AM)。如果您想包含给定日期的所有时间（而不仅仅是午夜），请使用小于后续日期的比较 - 这比使用晚上 11:59:59 更容易和更准确。

```
select dateColumn from someTable where dateColumn < '2009/5/1' 
```

或者，您可以投射日期以排除时间，但您需要小心排序比较`yyyymmdd`以使排序正确。将字符串转换为日期也可以，但您仍然需要确保您比较的是第二天的午夜而不是相关日期的午夜。

```
select dateColumn from someTable where CONVERT(varchar,dateColumn,112) <= '2090430' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T11:47:51.883

在 MySQL[文档页面](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)中有一个非常有用的帮助函数列表，您可以使用它们。您在查询中所做的是比较字符串而不是日期。如果您将月份写为两位数 04 而不是 4，它可能会起作用。无论如何，您最好转换为 UNIX_TIMESTAMP 并根据它进行比较。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T12:50:36.833

无论是在创建您的数据，都包括上午 12:00 以外的时间。

我在以下位置找到了这个：Jeff 的 SQL Server 博客，并在我想要的只是日期的情况下使用它来消除时间：

```
dateadd(dd,0, datediff(dd,0,@DateTime)) 
```

所以您的查询可能是：

```
select dateColumn from someTable where dateadd(dd,0, datediff(dd,0, [dateColumn]))<= '2009/4/30' 
```

我把它变成了一个函数，因为它经常被使用。

# asp-classic - asp中的vb脚本问题

> ID：819754
> 
> 赞同：0
> 
> 时间：2009-05-04T11:43:32.783
> 
> 标签：asp-classic, vbscript

我试图让这段代码在一个asp页面中工作。当用户单击 OnClick 按钮时，它会将他们带到此页面，该页面将创建一个文件来存储该用户的用户名和他们执行代码的时间。到目前为止，当此代码运行时，它会创建“userinfo.flag”文件，但不会捕获用户的数据。基本上，我没有正确获取用户数据。

```
<%
Set FSO = Server.CreateObject("Scripting.FileSystemObject")
Set NewTextFile = FSO.OpenTextFile(server.mappath("UserInfo.flag"),2,true)
Set WshNetwork = WScript.CreateObject("WScript.Network")
WScript.Echo "User Name = " & WshNetwork.UserName
NewTextFile.WriteLine("user:")
NewTextFile.WriteLine(WshNetwork.userName)
NewTextFile.WriteLine(Now)
NewTextFile.Close
Set NewTextFile = Nothing
Set FSO = Nothing

%>

<HTML>
<HEAD>
<TITLE>TEST PAGE</TITLE>
</HEAD>
</HTML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T13:09:58.363

在 .asp 环境中工作时，您没有在 .vbs 环境中可用的所有全局变量。这里有一些事情：

*   不要使用 WshNetwork 对象来查找有关用户的信息。该信息（如果用户已通过身份验证）可在`Request.ServerVariables["AUTH_USER"]`
*   使用`Response.Write`代替`WScript.Echo`

那应该可以让您正确获取用户信息。

# c# - 如何将表格值显示到列表框？

> ID：819755
> 
> 赞同：0
> 
> 时间：2009-05-04T11:43:40.067
> 
> 标签：c#, asp.net, listbox

如何在列表框控件中显示表格值？从这段代码中，我从 TeamMember_table 中获得了**ProjectCode值：**

```
SqlDataAdapter adp = new SqlDataAdapter("select ProjectCode from TeamMember_table where EmpId = '" + eid + "'", conn); 
```

我想在**listBox中显示这个****ProjectCode**值。

 **平台：Visual Studio 2008，带有 C# 的 ASP.NET。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:58:17.427

使用 ASP.NET ListBox 控件，您可以通过分配 DataSource 属性来实现：

```
 ListBox1.DataSource = YourDataSource;
        ListBox1.DataTextField = "projectCode";
        ListBox1.DataBind(); 
```

其中“YourDataSource”可以是一个填充了来自 SqlDataAdapter 的数据的 DataTable。

您还可以手动添加每个项目：

```
ListItem item = new ListItem();
            item.Text="sometext";
            item.Value="somevalue";
            ListBox1.Items.Add(item); 
```

[您可以在此处](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listbox.aspx)阅读有关数据绑定和 ASP.NET ListBox 控件的更多信息。

# c# - .net onpaint 垂直同步

> ID：819762
> 
> 赞同：4
> 
> 时间：2009-05-04T11:45:17.817
> 
> 标签：c#, winforms, graphics, gdi+

我正在尝试使用 winforms 和 gdi+ 实现一些动画，但是我在控件中得到了很多撕裂的移动精灵。

托管 .net 中有没有办法让覆盖的 Control.OnPaint 方法等待监视器的垂直回溯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T12:02:51.317

您是否已经在使用双缓冲？如果不是，我怀疑这会消除撕裂，这比尝试等待垂直回撤更简单。

# encryption - 需要一个非常快速的一对一算法，可能是加密

> ID：819765
> 
> 赞同：4
> 
> 时间：2009-05-04T11:46:50.293
> 
> 标签：encryption, hardware, cryptography

我需要一个非常非常快速的一对一算法。该算法不需要是牢不可破的。相当强大就足够了，但它必须是闪电般的速度。我将在硬件中实现它。面积也是一个问题，所以它不应该使用太多的逻辑。

它应该是一个函数 f_N(x)，其输入为 N 位数，输出为 N 位数。N 是一个常数，可能在 20-70 之间。该函数必须是一对一的。（即可逆，意味着可以解密。解密速度无关紧要。）

我需要在 3ns 内加密，即每秒大约 333M 输入。例如，DES 每秒大约 50Mbits。我需要每秒 333M**输入。**

到目前为止，我一直在使用大约 6 轮的 Feistel 密码。这似乎需要大约 3ns。

建议？

**更多笔记**

有一些问题，所以我会解释一下。我需要将键放入哈希表中。标准方法是散列输入键并将结果用作表的索引。表中的每一行都必须存储原始键。 [信息论](http://en.wikipedia.org/wiki/Information_theory)告诉我们，表的行实际上并不需要与输入键一样宽，而是与输入键一样宽**减去**表地址中的位数。例如：

*   输入：x（N位）
*   哈希：x%128（8 位）
*   验证者: floor(x/128) (N-8 bits)

在整数通常具有相同宽度但我在硬件中执行此操作的 CPU 上会很愚蠢。

x%128 是一个容易破解的哈希。事实上，如果输入键仅在前几位不同，您将意外破坏散列。我想要一个不会被意外破坏的哈希，甚至可能很难被故意破坏。我还尝试了[LFSR](http://en.wikipedia.org/wiki/Linear_feedback_shift_register)。LFSR 速度很快，但两个长度相等的 LFSR 会生成线性相关的哈希结果。（如果 f(x) 和 g(x) 为两个不同的多项式提供相同的哈希，则 f(x+1) 和 g(x+1) 很容易相关。）

因此，我需要一个具有 N 位输入和 V 位、H 位输出 (V+H=N) 的函数，其中很难找到长度为 N 的两个输入，以便两者都输出相同的 H。加密适合账单，因为它使输出的长度与输入的长度相同，并且很难反转。加密以外的其他方法也可能起作用，尽管我想要的似乎几乎就是加密的定义。

很抱歉没有提前解释所有这些。希望这可以澄清事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T11:49:36.667

我想知道您是否不关心加密的强度，那么也许您根本不需要加密。加密算法最**重要**的部分是它的强度。如果加密很弱，那么一开始加密就没有任何好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T12:22:00.397

以下是一些算法的基准：http: [//gd.tuwien.ac.at/privacy/crypto/libs/cryptlib/benchmarks.html](http://gd.tuwien.ac.at/privacy/crypto/libs/cryptlib/benchmarks.html)

请注意，这些基准测试正在测试**算法**的实现，因此它可能不是您想要的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T13:23:38.610

当您说“快速”时，您只关心吞吐量，还是延迟本身最重要？

如果延迟不如吞吐量那么重要，那么您有什么理由不能使用已知安全的标准[Feistel 密码](http://en.wikipedia.org/wiki/Feistel_cipher)，而不是从组合输出中获得完整的轮数（例如 Blowfish 中的 16 轮）逻辑，在每一轮之间粘贴一个寄存器，以便您流水线化加密算法？它基本上需要与已知的安全加密算法相同数量的硬件（为寄存器添加一些触发器），但传播延迟仅为一轮 Feistel 网络的传播延迟 +人字拖。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T11:56:21.097

我会推荐我的老朋友[Tiny Encryption Algorithm](http://en.wikipedia.org/wiki/Tiny_Encryption_Algorithm)

它既快速又占用空间极低，在硬件中实现时您可能还必须考虑这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:16:52.763

使用 64 位“键”值并对每个字节进行异或运算有什么问题？您可以根据需要多次循环访问密钥，以对前 64 位之后的任何明文位进行异或。

64 位密钥可以是 8 字符密码或密码短语的 8 字节哈希。

由于密钥的位数几乎与消息一样多，因此它实际上会非常强大且速度极快。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T13:15:03.373

以下内容不能满足您对一对一功能的要求，但如果速度至关重要，它可能会很有用。（如果它不起作用，那么我建议采用分而治之的方法：您正在使用硬件，因此理论上您应该能够并行加密和解密，除非一个输入的加密依赖于先前输入的加密。 )

对于我所说的“munging” ，最快的*硬件算法是在概念上将您的输入视为比特流，并将它们与加密安全和可重构比特生成器的比特流输出进行异或 - 如果您希望解密它，则可重构。*一个简单且快速但本身并不安全的示例是[线性反馈移位寄存器](http://en.wikipedia.org/wiki/Linear_feedback_shift_register)(LFSR)。选择一个长周期（2 ^(128) - 1 或 2 ^(256)- 1 或类似的东西）。维基百科页面建议进行修改以增强安全性。您也可以偶尔尝试（例如，每 M 位一次，其中 M = 4096、16384、65536 等等）将 LFSR 的状态与较慢但更安全的比特流（流密码或加密预先确定的一组输入，例如递增序列或 LFSR 状态的延迟快照）——尽管这属于不发明你自己的密码技术，但众所周知的密码技术已经有很大投入大量精力测试它们是否存在漏洞。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-08T17:52:46.190

如果您在硬件中执行此操作，为什么不在 DSP 上使用标准分组密码？

[高端 DSP 是否适合 AES 算法？](http://focus.ti.com.cn/cn/lit/an/spra740/spra740.pdf)

# iis - 如何以编程方式重置 IIS？

> ID：819767
> 
> 赞同：2
> 
> 时间：2009-05-04T11:47:20.590
> 
> 标签：iis

是否有任何替代 IIS 管理 UI 可用于从程序重置 IIS？

现在我们已经创建了一个批处理文件，如果 iis 重置并每小时安排一次......

我只是想要一些东西，这样我们就不能重置 iis....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:53:30.467

查看[IIS Admin API](http://msdn.microsoft.com/en-us/library/ms526050.aspx)，特别是[IIisServiceControl](http://msdn.microsoft.com/en-us/library/ms525399.aspx)接口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T14:59:35.527

使用 WMI 接口，您可以以编程方式回收 AppPool

使用 SDK 中的 MgmtClassGen 生成 WMI 类：

```
"C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\mgmtclassgen" IIsApplicationPool        /n root\MicrosoftIISv2 /l VB /p IIsApplicationPool.vb 
```

-或者-

```
"C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin\mgmtclassgen" IIsApplicationPool        /n root\MicrosoftIISv2 /l CS /p IIsApplicationPool.cs 
```

然后在您的代码中使用它：

```
Dim msScope As New ManagementScope("root\MicrosoftIISv2")
Dim wmiIISAppPool As IIsApplicationPool
Try
    wmiIISAppPool = New IIsApplicationPool(msScope, String.Format("W3SVC/AppPools/{0}", _AppPoolID))
    'Recycle it
    wmiIISAppPool.Recycle()

Catch ex As Exception
    LogEvent("    *** ERROR - AppPoolRecycle failed: AppPoolID: {0} {1}", _AppPoolID, ex.Message)
Finally
    If Not wmiIISAppPool Is Nothing Then wmiIISAppPool.Dispose()
End Try 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T12:45:41.057

您还可以在命令提示符下使用 iisreset 重新启动所有 IIS。

我相信 tvanfossan 的回答还可以，但我认为他推荐的界面只能重置所有 IIS 一次。如果您有一个挂起的进程，您可能希望以编程方式确定您想要终止应用程序池中运行的哪个进程。

我建议也查看脚本接口：http: [//msdn.microsoft.com/en-us/library/ms526050.aspx](http://msdn.microsoft.com/en-us/library/ms526050.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-07T04:19:17.827

在 system32 文件夹中有一个名为 iisreset.exe 的文件。您可以创建一个批处理来执行它。

# java - 显示错误时间

> ID：819771
> 
> 赞同：1
> 
> 时间：2009-05-04T11:49:01.897
> 
> 标签：java, jsf, time

我已经使用 JSF 编写了一个方法：

```
public static String getCurrentTime(Locale locale) {
        Calendar cal=Calendar.getInstance(locale);
        return new SimpleDateFormat("HHmmss").format(cal.getTime());
    } 
```

在本地机器上测试我的应用程序时，我得到的时间与系统时间相同，但是当我的朋友测试它时，时间延迟为 4 分钟。

可能是什么问题？否则建议一个代码来做同样的事情

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T11:53:55.067

发生这种情况是因为您在两台不同的机器上进行测试 -**您的系统时间不一样**。

时间严格取自您的本地计算机时间。如果您将时钟设置为 12:34，您将得到 12:34，而不是实际时间。

除非您连接到网络上的时间服务器，或者以某种方式设法同步您的时钟，否则您永远无法保证您将获得相同的时间。

或者，一旦您将 JSF 应用程序部署到生产服务器，您将始终获得服务器时间，这自然保证对所有用户都是正确的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T11:57:09.677

如果您希望时间准确，请将计算机的时钟与[NTP](http://en.wikipedia.org/wiki/Network_Time_Protocol)同步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T12:13:48.187

您可以检查计算机是否与网络上的时钟匹配，例如[http://www.atomic-clock.org.uk/atomuhr.html](http://www.atomic-clock.org.uk/atomuhr.html)

# c# - 使用 Mutex 运行应用程序的单个实例

> ID：819773
> 
> 赞同：30
> 
> 时间：2009-05-04T11:49:39.133
> 
> 标签：c#, mutex

为了只允许运行应用程序的单个实例，我正在使用互斥锁。代码如下。这是正确的方法吗？代码中是否有任何缺陷？

当用户第二次尝试打开应用程序时如何显示已经运行的应用程序。目前（在下面的代码中），我只是显示另一个实例已经在运行的消息。

```
 static void Main(string[] args)
    {
        Mutex _mut = null;

        try
        {
            _mut = Mutex.OpenExisting(AppDomain.CurrentDomain.FriendlyName);
        }
        catch
        {
             //handler to be written
        }

        if (_mut == null)
        {
            _mut = new Mutex(false, AppDomain.CurrentDomain.FriendlyName);
        }
        else
        {
            _mut.Close();
            MessageBox.Show("Instance already running");

        }            
    } 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-04T12:03:39.210

我这样做过一次，希望对您有所帮助：

```
bool createdNew;

Mutex m = new Mutex(true, "myApp", out createdNew);

if (!createdNew)
{
    // myApp is already running...
    MessageBox.Show("myApp is already running!", "Multiple Instances");
    return;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-04T12:17:57.193

```
static void Main() 
{
  using(Mutex mutex = new Mutex(false, @"Global\" + appGuid))
  {
    if(!mutex.WaitOne(0, false))
    {
       MessageBox.Show("Instance already running");
       return;
    }

    GC.Collect();                
    Application.Run(new Form1());
  }
} 
```

来源： http: [//odetocode.com/Blogs/scott/archive/2004/08/20/401.aspx](http://odetocode.com/Blogs/scott/archive/2004/08/20/401.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-27T07:14:03.187

我用这个：

```
 private static Mutex _mutex;

    private static bool IsSingleInstance()
    {
        _mutex = new Mutex(false, _mutexName);

        // keep the mutex reference alive until the normal 
        //termination of the program
        GC.KeepAlive(_mutex);

        try
        {
            return _mutex.WaitOne(0, false);
        }
        catch (AbandonedMutexException)
        {
            // if one thread acquires a Mutex object 
            //that another thread has abandoned 
            //by exiting without releasing it

            _mutex.ReleaseMutex();
            return _mutex.WaitOne(0, false);
        }
    }

    public Form1()
    {
        if (!isSingleInstance())
        {
            MessageBox.Show("Instance already running");
            this.Close();
            return;
        }

        //program body here
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        if (_mutex != null)
        {
            _mutex.ReleaseMutex();
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T12:03:27.790

看看[这个问题](https://stackoverflow.com/questions/777744/how-can-i-check-for-a-running-process-per-user-session)

这篇文章有一个链接：[被误解的互斥锁](http://odetocode.com/Blogs/scott/archive/2004/08/20/401.aspx)，其中解释了互斥锁的用法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T12:08:40.023

查看[此页面上显示的代码示例](http://msdn.microsoft.com/en-us/library/bwe34f1k.aspx)

简而言之，您使用重载 Mutex `ctor(bool, string, out bool)`，它通过 out 参数告诉您，您是否拥有 Named Mutex。如果您是第一个实例，则在调用 ctor 后，此输出参数将包含 true - 在这种情况下，您将照常进行。如果此参数为 false，则表示另一个实例已经获得所有权/正在运行，在这种情况下，您会显示错误消息“另一个实例已在运行”。然后优雅地退出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-28T06:39:20.690

使用具有超时和安全设置的应用程序。我使用了我的自定义类：

```
private class SingleAppMutexControl : IDisposable
    {
        private readonly Mutex _mutex;
        private readonly bool _hasHandle;

        public SingleAppMutexControl(string appGuid, int waitmillisecondsTimeout = 5000)
        {
            bool createdNew;
            var allowEveryoneRule = new MutexAccessRule(new SecurityIdentifier(WellKnownSidType.WorldSid, null),
                MutexRights.FullControl, AccessControlType.Allow);
            var securitySettings = new MutexSecurity();
            securitySettings.AddAccessRule(allowEveryoneRule);
            _mutex = new Mutex(false, "Global\\" + appGuid, out createdNew, securitySettings);
            _hasHandle = false;
            try
            {
                _hasHandle = _mutex.WaitOne(waitmillisecondsTimeout, false);
                if (_hasHandle == false)
                    throw new System.TimeoutException();
            }
            catch (AbandonedMutexException)
            {
                _hasHandle = true;
            }
        }

        public void Dispose()
        {
            if (_mutex != null)
            {
                if (_hasHandle)
                    _mutex.ReleaseMutex();
                _mutex.Dispose();
            }
        }
    } 
```

并使用它：

```
 private static void Main(string[] args)
    {
        try
        {
            const string appguid = "{xxxxxxxx-xxxxxxxx}";
            using (new SingleAppMutexControl(appguid))
            {

                Console.ReadLine();
            }
        }
        catch (System.TimeoutException)
        {
            Log.Warn("Application already runned");
        }
        catch (Exception ex)
        {
            Log.Fatal(ex, "Fatal Error on running");
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T12:04:31.313

还有这个。[是否使用互斥锁来防止同一程序的多个实例安全运行？](https://stackoverflow.com/questions/646480/is-using-a-mutex-to-prevent-multipule-instances-of-the-same-program-from-running)

# asp.net - 禁用在 SiteFinity 主题中自动包含样式表

> ID：819774
> 
> 赞同：2
> 
> 时间：2009-05-04T11:49:53.343
> 
> 标签：asp.net, master-pages, themes, sitefinity

我正在将 HTML 模板切片集成到 SiteFinity 主题中，并且想知道是否有办法禁用样式表的自动包含。如果可能的话，我更愿意从 MasterPage 中手动包含它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T21:17:09.307

Sitefinity 中自动包含的样式表是位于 ~/App_Themes/ *ThemeName*目录中的 CSS 文件。这是一个[ASP.NET 功能](http://msdn.microsoft.com/en-us/library/ykzx33wh.aspx)，而不是 Sitefinity 特有的功能。

要删除此行为，只需从 ~/App_Themes/ *ThemeName*目录中删除所有文件。但是，不要删除目录本身。

# vb.net - 使用 long 数据类型创建字节数组？

> ID：819775
> 
> 赞同：0
> 
> 时间：2009-05-04T11:49:57.917
> 
> 标签：vb.net, arrays, initialization

大多数时候，当我们将文件流读入字节数组时，我们会编写以下代码：-

```
 Dim inputStream As New System.IO.FileStream(filePath, IO.FileMode.Open)
 Dim fileLength As Integer= CType(inputStream.Length, Integer)
 Dim input(fileLength) As Byte

 Using inputStream
     inputStream.Read(input, 0, fileLength)
 End Using 
```

但是这里我们必须将 Length 转换为整数类型（上面代码的第 2 行），因为我们不能使用 long 数据类型（带有选项 strict）声明字节数组。这是一个好习惯吗？这个问题的解决方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:58:28.580

好的做法是使用[`File.ReadAllBytes`](http://msdn.microsoft.com/en-us/library/System.IO.File.ReadAllBytes(loband).aspx)而不是全部使用：

```
Dim input = File.ReadAllBytes(filePath) 
```

顺便说一句，如果您的文件要**那么大**（超过 4 GB），您不希望一次将其全部加载到字节数组中，因为它将占用 4GB RAM（并且在 32 位托管进程，你根本无法拥有它，即使你有更多的 RAM）。

# asp.net - ASP.NET：如何在 Web 应用程序之间共享资源（成员资格、库）

> ID：819779
> 
> 赞同：0
> 
> 时间：2009-05-04T11:50:54.637
> 
> 标签：asp.net, deployment, resources, sharing

我正在尝试创建一个小型 Intranet。为此，我在本地电脑上有一个网络服务器。该网站的根目录将是一个仪表板，它将包含登录/注册功能（默认 ASP.NET 成员资格）。

```
http://localhost
http://localhost/帐户

```

Intranet 的其余部分将包含子应用程序，例如：

```
http://localhost/ApplicationName

```

根网站和大多数子应用程序都需要对用户进行身份验证，我将为其使用默认的 ASP.NET 成员资格提供程序。

> *所有项目（根项目和子项目）都是 Visual Studio 中的单独项目，每个项目都有自己的 WebSetup 项目用于部署。*

**1.) 如何在子应用程序中使用 ASP.NET Membership？**

此外，大多数应用程序（根和子）将使用第 3 方库（数据框架）。

**2.) 如何在根项目中引用库并在子应用程序中“使用”引用的库？**

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T11:57:34.183

在可以从多个 Web 项目中使用的类库项目中创建您的通用代码。至于成员资格提供者，我认为您需要将成员资格数据存储在外部 SQL 实例中（可能在同一台服务器上），然后在每个项目中简单地使用相同的连接字符串来访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T16:47:17.107

[成员资格](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)旨在与一个或多个应用程序一起使用。您可以拥有一个数据库实例（与您的任何应用程序的任何数据库分开），该实例可以容纳您的每个应用程序成员资格数据。如果您希望所有应用程序使用相同的 Membership 数据，请[在每个应用程序的 web.config 中定义 Membership](http://msdn.microsoft.com/en-us/library/6e9y4s5t.aspx)时提供相同的 applicationName（和 connectionString） 。

至于您问题的第二部分，tvanfosson 发布的答案（连同评论）应该会引导您走上正确的道路。

**编辑（@ropstah 评论）：**啊，我没有考虑到这一点。在这种情况下，您需要实现[单点登录 (SSO)](http://en.wikipedia.org/wiki/Single_Sign_On)。Masoud Tabatabaei[在 ASPAlliance.com](http://aspalliance.com/1545_Understanding_Single_SignOn_in_ASPNET_20.all)上发表了一篇文章，介绍了该过程。此外，[Keith Rull](https://stackoverflow.com/users/16565/keith-rull)对此[Stack Overflow 问题](https://stackoverflow.com/questions/616046/passing-session-data-between-asp-net-applications)的回答也可能有所帮助。

# c# - 命名空间、类、对象和实例之间有什么区别？

> ID：819793
> 
> 赞同：27
> 
> 时间：2009-05-04T11:58:16.553
> 
> 标签：c#, oop, namespaces

我正在阅读 Heads First C#（它非常有趣且用户友好），但我想知道是否有人有一个有用的比喻来描述名称空间、类、方法、属性等如何“组合在一起”？

类是父类，方法是子类等。还是更复杂？

命名空间可以是房子，类可以是房间（浴室）吗？方法可以是在那个房间里可以做什么（洗等），属性可以是做那个活动时可以做什么，使用肥皂，热水...

……我去拿我的外套。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-05-04T12:14:14.860

我会说：

*   **命名空间**：汽车的类别或品牌。请注意，品牌实际上不必规定汽车的制造方式。你不能说本田总是有四扇门，或者说它总是有四驱。这些细节由班级决定。[Rich.Carpenter 的帖子](https://stackoverflow.com/questions/819793/namespaces-then-classes-then-methods-is-there-a-metaphor/819813#819813)很好地解释了命名空间的用途。

*   **类**：如何构建特定汽车的蓝图。

*   **对象**：从汽车蓝图（类）创建的实际汽车（实例）

*   **方法**：汽车用户可以做的事情。`Start()`, `IncreaseThrottle()`, `Brake()`,`OpenDoor()`等

*   **属性**：汽车包含的属性、信息和构建块。例如总行驶里程、颜色、方向盘尺寸、立体声系统等。

一些对您来说似乎更高级的概念。现在可能有点矫枉过正，但如果您有兴趣，请阅读：

*   **继承**：当一个类基于另一个类并添加一些更具体的细节时。一条继承线通常从最常见和一般的方面开始，一直到更具体没有意义的地方。动物上下文中的示例：动物- >哺乳动物->啮齿动物*->大鼠->RattusNorvegicus*

*   **聚合**：“构建”对象的属性。例如“这辆车是四个轮子、底盘、发动机等的集合体”。

*   **属性**：描述对象的属性，通常不是其物理构造的一部分。例如颜色、最高速度、发动机体积等。

*   **封装**：对用户隐藏某些属性或保护某些属性不被错误使用（从而损坏对象）的概念。例如，您不会公开要自由更改的汽车类的齿轮属性。您封装它并确保`Clutch()`在之前调用它`SetGear()`。

*   **覆盖**：如果一个类从另一个类继承，它也从该类继承方法。重写基本上是当*继承*类用自己需要的行为替换这种方法的实现时。下一点的用法示例。

*   **多态性**：一个很难掌握的概念，直到您开始实际使用它。这意味着通过使用允许您忽略特定类型（当您不需要知道它时）的通用引用来引用非常特定类型的对象。例如，如果您想“读取”停车场中每辆车的车牌号属性，您并不真正关心品牌是什么，或者即使它是拖车或摩托车或其他什么。为了能够做到这一点，我们确保车牌号是继承行中最通用类（可能是`Vehicle`类）中的一个属性。所以你只需要处理列表中的所有对象，将它们称为它们的`Vehicle`类，然后调用`Vehicle::GetLicensePlateNumber()`. 任何需要一些特殊处理来检索号码的车辆都可以通过覆盖该方法来实现此行为并使其按要求运行。因此，可以使用范围广泛的对象类型，就好像它们属于同一类型一样，但可以表现不同。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-05-04T12:05:52.760

将类视为对象的描述，将方法视为对象可以执行的操作。

例如，我设计了一辆新车。该汽车的计划或蓝图（类）用于创建实际的物理汽车（对象）。这些计划表明汽车应该有一个功能性喇叭。因此，我在汽车中设计了鸣喇叭功能（一种方法）。这些计划还表明这辆车有四个轮子。Wheels 将是汽车的一个属性，其实例化（在创建对象时分配给该属性）值为 4。颜色将是另一个可能的属性。属性描述对象的质量或特性（颜色、高度、宽度等）。

现在，我为丰田工作（不是真的，但请耐心等待）。Toyota 将是包含我的汽车蓝图的命名空间。由于福特、通用汽车等都可以拥有自己的汽车设计（类）以及相同的名称（汽车）和方法（喇叭），丰田、福特和通用汽车的命名空间将这些蓝图（类）分开并且不同的，因为当应用程序具有不同的命名空间时，您可以在应用程序中拥有多个版本的具有相同名称的类和方法。

希望有帮助。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-05T13:16:09.073

一句话：

**对象**是**类**的**实例**_

 *** * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-05T13:20:58.843

通过使用房屋蓝图的类比。

蓝图是一个类。它指定了很多细节，但也遗漏了很多属性，比如房子的颜色，前门的颜色和风格等。你知道，通过查看蓝图，门将在哪里，并且有*一*扇门。

对象是您根据该蓝图建造的房屋。您可以使用相同的蓝图建造许多房屋。它们都具有相同的整体外观和布局，但属性可能会有所不同，例如外部油漆的颜色、前门的风格等。但所有房屋的前门都在同一个位置。

您可以从特定蓝图中调用房屋的每个房屋实例。

所以，正如[@yx](https://stackoverflow.com/users/38264/yx)雄辩地所说，一个对象是一个类的一个实例。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T12:18:02.573

类通常用于表示某种对象。它可能类似于发票等物理对象，但也可能是更抽象的东西。

动物有时被用作类的示例，因为我们熟悉动物的工作方式。所以，让我们使用一些动物：

类可以是一种动物，例如`Cat`and `Dog`。当你创建一个类的实例时，它就变成了一个特定的对象，比如 Fido 狗。

命名空间用于对类进行逻辑分组，因此`Cat`和`Dog`类可以放在命名空间中`Animals.Pets`。尽管命名空间是分层的，但这并不能使它们中的类分层。它们只是不同的组，因此`Animals`命名空间中的类不会自动成为命名空间中的类的父类`Animals.Pets`。

方法是对象所做的事情，例如`Eat()`和`Sleep()`。

属性是描述对象的一个​​方面的东西，比如`NumberOfLegs`和`IsSleeping`。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-04T12:19:12.493

我会说您的课程可能是工作职位，执行不同的操作（换句话说，这些操作是方法）。您可能有不同的个人执行操作（对象的各种实例）。

这些工作职位的集合将驻留在一个部门中。财务有自己的工作/课程（会计师、簿记员……），但他们需要与销售人员合作，他们有自己的工作/课程类型。

从这个意义上说，各个部门都是命名空间。从事销售工作的人最终需要与财务部门合作。多个部门（或命名空间）正在共同努力实现一个目标。

现在这些部门可能是公司的一部分；该公司将是所有这些部门的根命名空间。并且以这种方式，命名空间可以存在并嵌套在一起。

简而言之，命名空间几乎分离了职责。

想象多家公司一起工作（Microsoft .net 命名空间与您自己的命名空间一起工作），您会得到更大的图景。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-05T13:16:10.117

一个对象可以是一个类的实例吗？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-05T13:17:27.103

一个类定义了一个对象的样子——它包含什么数据，它有什么方法，以及它与哪些其他类相关。

实例是该类的单个创建实体 - 它是通过使用类定义作为引用创建的对象。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-05T13:18:14.810

类是一种对象。例如，您可以拥有任意数量的一类对象。

实例是一个对象，有时这两个术语可以互换使用，因为在许多语言中，所有对象也是类的实例。人们使用“实例”这个词来明确表示他们不是在谈论一个类，而是该类的一个对象。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-05T13:20:36.910

类是对象的模板**。**它是告诉编译器哪些成员变量和方法进入该类型类的对象的源代码。

**对象**和实例**实际上**是相同的。从类模板中，您可以创建该类的许多实例（或对象）。每个都在自己的内存中定义了类中的所有成员和方法（尽管您可以拥有共享成员，并且方法几乎总是在实例之间共享）。

# c# - .NET 单元测试可以使用什么动态语言？

> ID：819796
> 
> 赞同：4
> 
> 时间：2009-05-04T11:58:42.277
> 
> 标签：c#, .net, unit-testing, mstest, dynamic-language-runtime

我正在尝试为我的 C# 代码编写一些复杂的验收测试。我注意到，当我编写测试时，我做了很多显式转换以满足 C# 编译器的要求。我喜欢使用静态类型语言（如 C#）在生产代码中获得的类型安全，但对于我的测试，我很乐意使用动态类型语言（例如 IronPython 或 IronRuby）来避免所有显式转换。如果我的测试调用了一个对象上不存在的方法，那么代码在运行时失败是可以的（这只是一个失败的测试）。我目前正在使用 MS Test 作为我的单元测试框架，如果我能继续使用它会很方便。我可以使用哪种动态（基于 DLR）语言来与 MS Test 集成？如果您认为这会有所帮助，请随意提出不同的测试框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T12:08:05.640

我更喜欢 C# 进行单元测试...如果您正在寻找动态语言，您可以尝试使用 iron-python...。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T12:52:09.607

对于 IronRuby 和 Rspec，您可以查看这篇文章：

[http://msdn.microsoft.com/en-us/magazine/dd453038.aspx](http://msdn.microsoft.com/en-us/magazine/dd453038.aspx)

和[http://msdn.microsoft.com/sv-se/magazine/dd434651(en-us).aspx](http://msdn.microsoft.com/sv-se/magazine/dd434651(en-us).aspx)开始使用 IronRuby .Net 互操作。

然后总是有fitnesse：

[http://www.fitnesse.org/](http://www.fitnesse.org/)

Fitnesse .net 1.1 和 2.0 二进制文件可以在这里找到：http: [//fitnesse.org/FitNesse.DotNet](http://fitnesse.org/FitNesse.DotNet)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T16:00:51.870

我推荐 IronPython——它的优点之一是优秀的书籍“IronPython in Action”，它将引导您了解每个重要方面，包括测试。

# windows - IIS 6.0 调试方法

> ID：819797
> 
> 赞同：3
> 
> 时间：2009-05-04T11:59:26.800
> 
> 标签：windows, debugging, iis, iis-6, windows-server-2003

关于调试服务器（Windows Server 2003 R2）上的高 CPU 使用率（w3wp.exe），我需要您的帮助。我使用 debugdiag 进行分析，但问题是这个软件没有检测到任何类型的问题。

你有没有遇到过 w3wp.exe 上 CPU 使用率高的问题（一直是 100%）？

您是否有任何教程如何调试任何相关问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T12:20:11.993

在挂起模式下使用 adplus 收集内存转储

```
adplus -hang -pn w3wp.exe -quiet 
```

更多详细信息：[.NET 调试演示实验室 4：高 CPU 挂起](http://blogs.msdn.com/tess/archive/2008/02/22/net-debugging-demos-lab-4-high-cpu-hang.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T12:12:08.110

第一步是确定哪个程序/进程正在使用这么多 CPU。您是否使用任务管理器按 CPU 使用率对进程进行排序？

我还建议您从[Sysinternals](http://technet.microsoft.com/en-us/sysinternals/default.aspx)（现在是 Microsoft 的一部分）下载免费工具。

他们的[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)工具将是一个很好的开始。

# jquery - 预期对象 - jquery

> ID：819801
> 
> 赞同：1
> 
> 时间：2009-05-04T11:59:33.883
> 
> 标签：jquery, database, validation, object, submit

由于 jquery，由于某些奇怪的原因，我收到错误“预期对象”，这不会“提交”表单或将数据输入数据库。

没有jquery，数据可以输入到数据库中。但现在没有了。

我主要使用 jquery 来验证 asp.net 控件。

* * *

roosteronacid，验证工作非常好， id 属性也是一样的。提交只是没有执行服务器端代码，我不知道是什么问题。

编辑：

这是jQuery代码：

```
 <script type="text/javascript">
        $(document).ready(function() {
            // add custom validation methods
            $.validator.addMethod('phone', function(value, el, params) {
                return this.optional(el) || /^[0-9,+,(), ,]{1,}(,[0-9]+){0,}$/.test(value);
            }, 'Please enter a valid phone number');

            $.validator.addMethod('numbers', function(value, el, params) {
                return this.optional(el) || /^[0-9]+$/.test(value);
            }, 'Invalid entry. Only Numeric is allowed.');

            $.validator.addMethod('domainurl', function(value, el, params) {
                return this.optional(el) || /^(http\:\/\/(?:www\.)?[a-zA-Z0-9]+(?:(?:\-|_)[a-zA-Z0-9]+)*(?:\.[a-zA-Z0-9]+(?:(?:\-|_)[a-zA-Z0-9]+)*)*\.[a-zA-Z]{2,4}(?:\/)?)$/.test(value);
            }, 'Please enter a valid domain url');

            $.validator.addMethod('selectone', function(value, element) {
                return this.optional(element) || (value.indexOf("none") == -1);
            }, 'Please select an option.');

            $("#form1").validate({
                debug: true,
                rules: {
                    txt_name: {
                        required: true,
                        minlength: 2
                    },
                    txt_cmp: {
                        required: true,
                        minlength: 2
                    },
                    txt_tel1: {
                        phone: true,
                        required: true,
                        minlength: 3

                    },
                    txt_tel2: {
                        phone: true,
                        required: false,
                        minlength: 3

                    },
                    txt_mob: {
                        phone: true,
                        required: false,
                        minlength: 9

                    },
                    txt_email: {
                        required: true,
                        email: true
                    },

                    txt_domname: {
                        required: true,
                        domainurl: true
                    },

                    radiobt_domain: "required",

                    ddl_yremail: {
                        required: true,
                        selectone: true
                    },
                    ddl_email: {
                        required: true,
                        selectone: true
                    },

                    txt_space: {
                        required: true,
                        numbers: true

                    },
                    txt_calfr: {
                        required: true
                    },
                    txt_calto: {
                        required: true
                    }  

            },
            messages: {
                txt_name: {
                    required: "This field is required",
                    minLength: "Please enter a valid name"
                },
                txt_cmp: {
                    required: "This field is required",
                    minLength: "Please enter a valid commpany name"
                },
                txt_tel1: {
                    required: "This field is required",
                    minLength: "Please enter a valid telephone number"

                },
                txt_tel2: {
                    minLength: "Please enter a valid telephone number"
                },
                txt_mob: {
                    minLength: "Please enter a valid mobile number"

                },
                txt_email: {
                    email: "Please enter a valid email address",
                    required: "This field is required"
                },

                txt_domname: {
                    required: "This field is required"
                },
                radiobt_domain: "Select the Hosting Type"
            }

        });
    });
    </script> 
```

代码有什么问题吗？

它在第 559 行显示预期对象。我检查了 jquery.validate.js 文件，这是它显示的代码：

```
addWrapper: function(toToggle) {
            if ( this.settings.wrapper )
                toToggle = toToggle.add( toToggle.parents( this.settings.wrapper ) );
            return toToggle;
        } 
```

jquery 代码在正确的位置显示所有错误，但一旦更正，它就不会提交数据。

我正在使用的插件：

[http://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-04T12:05:39.577

当您尝试访问未定义、未引用或错误拼写的对象时，会出现预期的对象。查看预期的对象。使用 Firefox firebug 调试您的 javascript 或使用 IE 进行调试以获取运行时无法找到的对象....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-24T05:48:32.877

我通过正确引用 JQuery 文件解决了这个问题。我把它放在一个子目录中，但路径不正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T10:55:00.777

在这里回答：[提交按钮不会触发服务器端代码](https://stackoverflow.com/questions/827005/submit-button-does-not-trigger-server-side-code)

“调试”应设置为假。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T21:26:51.997

我的猜测是错误在于您使用 jQuery 验证插件。尝试仅验证一个 ASP.NET 控件。这将使错误更容易被发现：

```
$("#form1").validate({
    rules: {
       id_of_control_you_know_exists_in_the_rendered_html: {
            required: true,
            minlength: 2
        }
    }
}); 
```

另一种可能是您在用户控件中使用 ASP.NET 控件。在这种情况下，呈现的 HTML 输入控件的 id 属性与您在 .aspx 页面中设置的不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-10T18:48:09.217

我有同样的问题，但在我们的登台服务器上。比较文件表明它们是相同的，并且在不同站点上托管完全相同的文件没有问题，因此它必须是我们放置文件的特定站点。故障排除后的罪魁祸首是我们在 IIS 的网站属性中设置了 Footer.html 文件设置，因此服务器在渲染时将其注入脚本中。因此破坏任何良好的合规代码。我们关闭了 IIS 设置的页脚属性 - 宾果游戏！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-07-26T07:59:23.177

我也面临这个问题。但就我而言，我是 jquery 版本的问题。我放了最新版本，它在 IE 中工作得更好。

# c# - 使用 Windows 服务实现计划作业的最佳方法是什么

> ID：819802
> 
> 赞同：2
> 
> 时间：2009-05-04T12:00:24.613
> 
> 标签：c#, windows-services, scheduling

我有一个偶尔在晚上运行的数据库作业，我需要一个 Windows 服务来定期轮询数据库，以便在 SQL 作业完成后做更多的工作。我正在寻找一个可靠的例子来编写一个可以优雅地失败而不会导致服务崩溃的调度程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T12:04:52.840

只需将其设为计划任务即可。查看 [Windows 服务与计划任务](https://stackoverflow.com/questions/390307/windows-service-vs-scheduled-task)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:09:41.567

我会使用 MSMQ，向将消息添加到队列的作业添加最后一步（如果可以，通过 ActiveX 脚本/COM 或 .net 调用）

然后让您的服务监控队列。

至于不使服务崩溃，这完全取决于您和错误处理等...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T12:26:24.707

看看[http://codeplex.com/TaskService](http://codeplex.com/TaskService)

# emacs - Emacs 处理大型 XML 文件

> ID：819803
> 
> 赞同：2
> 
> 时间：2009-05-04T12:01:00.040
> 
> 标签：emacs, elisp

我经常需要阅读结构相当简单的大型 XML 文件（> 100 MB）。我想使用 emacs，但它不太支持大文件。我在想也许我可以使用可以为我进行 SAX 或 StAX 解析并为我提供所有必要操作（例如搜索）的 java 应用程序。在 emacs 和外部 java 应用程序之间进行通信的“正确方式”是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T17:38:49.310

您可以尝试禁用该特定缓冲区的字体锁定模式。我打开的文件比使用 emacs 的文件大得多。我注意到只有当文件中的行大于我的屏幕并且它们开始换行时才会减速。让它们离开屏幕并禁用字体锁定会加速性能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T13:29:41.653

我认为没有单一的“正确方法”，但这里有一些想法：

*   使您的 Java 应用程序将 XML 文档呈现为一组成组的线程文章；让它说[NNTP](http://www.gnus.org/)并使用 Gnus，或者提出你自己的协议并为其编写一个 Gnus 后端（请参阅[Web-browsing backends](http://www.gnus.org/manual/gnus_202.html)以获取灵感）
*   把 XML 文档想象成一个 Lisp 程序（S-表达式，XML 元素，有什么区别？）并在 Emacs 中编写一个与[SLIME](http://common-lisp.net/project/slime/)通信的[Swank 后端](http://github.com/jochu/swank-clojure/tree/master)，然后使用 SLIME 命令进行查询
*   编写一个[FUSE](http://en.wikipedia.org/wiki/Filesystem_in_Userspace)驱动程序，以便您可以将 XML 文档挂载为文件系统并使用[Dired](http://www.gnu.org/software/emacs/manual/html_node/emacs/Dired.html)来探索它。

# sms - 国际短信转发

> ID：819818
> 
> 赞同：0
> 
> 时间：2009-05-04T12:08:22.707
> 
> 标签：sms

是否可以将所有短信转发到手机号码？您知道有哪些网络服务提供商？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T12:51:43.743

一些（接近）重复：

1.  [短信 API 建议](https://stackoverflow.com/questions/804924/sms-api-suggestions)
2.  [如何设计短信服务？](https://stackoverflow.com/questions/576940/how-do-i-design-sms-service)
3.  [通过 Web 应用程序接收 SMS 消息](https://stackoverflow.com/questions/526046/receive-sms-messages-by-web-application)
4.  [免费短信 API](https://stackoverflow.com/questions/238579/free-sms-api)
5.  [处理传入 SMS 消息的最佳方式是什么？](https://stackoverflow.com/questions/115361/what-is-the-best-way-to-handle-incoming-sms-messages)

加上其他人，如果您搜索短信和传入或接收。

# c# - ClickOnce 和参考

> ID：819823
> 
> 赞同：1
> 
> 时间：2009-05-04T12:10:49.707
> 
> 标签：c#, reference, clickonce

我用 VS2008 创建了 ClickOnce 解决方案。我的主项目引用了另一个将 COM dll 引用为“链接”的项目。

当我在 VS 中构建我的解决方案时，来自其他项目的 dll 被移动到我的 bin 文件夹中，但是当我发布和启动项目时，这些文件不在我的 Local Settings\Apps\2.0... 文件夹中。

我知道我可以添加另一个项目的每个 dll 作为我的主项目的参考，但我想要一个更干净的解决方案......

是否可以 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T12:52:43.520

首先将这些文件直接添加到您的项目中。然后转到应用程序属性 -> 发布 -> 应用程序文件

如果您没有看到您需要的文件，请选择“显示所有文件”，然后将它们的发布状态设置为“包含”而不是“包含（自动）”。这很重要，否则将不会添加它们。

请注意，如果您更新文件，则必须删除它们并再次添加它们并再次设置它们的发布状态。这是一个小错误。

有关详细信息，请参阅我的上一个问题： [ClickOnce - 覆盖内容文件](https://stackoverflow.com/questions/261789/clickonce-overwriting-content-files)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T12:24:15.757

您需要在项目的“发布”选项卡中打开“应用程序文件”对话框。从那里您可以设置每个文件的发布类型（包括、先决条件等）。

如果它是非托管 DLL，则需要将实际的 .dll 作为文件添加到项目中，并将其构建操作标记为“数据”。然后，您可以将该文件的发布类型设置为包含。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-07T16:05:21.303

我遇到了同样的问题....在经历了许多选择之后解决这个问题的唯一方法是将这些 dll 添加到引用中。

它有效，但我希望将来会有一个更清洁的解决方案。

# c# - LINQ 重构

> ID：819824
> 
> 赞同：1
> 
> 时间：2009-05-04T12:11:37.927
> 
> 标签：c#, .net, linq, linq-to-xml

我之前从这里重构了我的 foreach 循环：

```
foreach (KeyValuePair[string, string] param in paramsList)
{
    XmlElement mainNode = xmlDoc.CreateElement("parameter");
    mainNode.SetAttribute("name", param.Key);
    mainNode.SetAttribute("value", param.Value);
    rootNode.AppendChild(mainNode);
} 
```

为此，使用 LINQ：

```
XmlElement mainNode = xmlDoc.CreateElement("parameter");
var selected = paramsList.AsEnumerable().Select(param => param).ToList();
selected.ForEach(x => (mainNode.SetAttribute("name", x.Key)));
selected.ForEach(x => (mainNode.SetAttribute("value", x.Value)));
rootNode.AppendChild(mainNode); 
```

但是，我知道下面的部分仍然可以重构为一个循环，但我不知道如何。请赐教。

```
selected.ForEach(x => (mainNode.SetAttribute("name", x.Key)));
selected.ForEach(x => (mainNode.SetAttribute("value", x.Value))); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T12:23:50.160

我认为您可以通过以下方式获得相同的结果：

```
 paramsList.ToList().ForEach( e => {
            XmlElement mainNode = xmlDoc.CreateElement("parameter");
            mainNode.SetAttribute("name", e.Key);
            mainNode.SetAttribute("value", e.Value);
            rootNode.AppendChild(mainNode);
        }); 
```

但是，在这种情况下，我会选择一个简单的`foreach`：

```
 foreach (var e in paramsList)
        {
            XmlElement mainNode = xmlDoc.CreateElement("parameter");
            mainNode.SetAttribute("name", e.Key);
            mainNode.SetAttribute("value", e.Value);
            rootNode.AppendChild(mainNode);
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T12:21:27.997

也许是这样的

```
selected.ForEach(x => 
          { 
             mainNode.SetAttribute("name", x.Key);
             mainNode.SetAttribute("value", x.Value);
          }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T02:11:01.543

您有机会从 XmlDocument 切换到 XDocument 吗？正如您所料，LINQ to XML 与 LINQ 的集成要好得多。

```
var nodes = from pair in paramsList
            select new XElement("parameter",
                                new XAttribute("name", pair.Key),
                                new XAttribute("value", pair.Value)); 
```

就是这样，除了将节点添加到文档中，或者将它们传递给 XDocument 构造函数或其他东西。

编辑：为了澄清，您的问题被标记为“linqtoxml”，但 LINQ to XML 暗示 System.Xml.Linq 命名空间中的一组特定类，例如 XDocument、XElement 和 XAttribute。您的示例代码没有使用任何实际的 LINQ to XML 类，我建议如果您想使用 LINQ 来构建您的 XML，那么实际的 LINQ to XML 类会比 XmlDocument 和朋友更好地为您服务。

# apache-flex - 如何知道直播点在流中的哪个位置？

> ID：819827
> 
> 赞同：0
> 
> 时间：2009-05-04T12:12:05.070
> 
> 标签：apache-flex, flash, live, flash-media-server, netstream

如何知道直播点在流中的哪个位置？

NetStream.seek ( 99999999999999 ) 基本上将我发送到最新点，但我如何找到流的当前确切端点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T13:25:01.993

现在在客户端上找到了

onMetaData()

信息持续时间

否则它的netstream.time。

# internet-explorer - 如何在 Internet Explorer 中创建侧边栏

> ID：819832
> 
> 赞同：2
> 
> 时间：2009-05-04T12:12:47.767
> 
> 标签：internet-explorer, bho

我想在 IE 中创建一个与 Firefox 侧边栏相同的侧边栏，类似于 IE 开发人员工具栏、IE http 分析器……。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T12:20:47.623

[创建自定义浏览器栏](http://msdn.microsoft.com/en-us/library/bb776819.aspx)。此页面包含详细信息和代码示例。

# c# - 改变面板颜色

> ID：819839
> 
> 赞同：0
> 
> 时间：2009-05-04T12:17:17.617
> 
> 标签：c#

我在这里创建了一个简单的代码，只是为了玩弄 C#。它有 3 个按钮和 1 个面板。如果单击第二个和第三个按钮，面板高度会发生变化。这也可以改变颜色吗？

例如，如果我点击第二个按钮，我希望它变成黄色，同时高度也发生变化，与第三个按钮相同。

```
public partial class Form1 : Form
 {
public int heightPanel;

  public Form1()
    {
  InitializeComponent();
  heightPanel = panel1.Height;
    }

  private void button1_Click(object sender, EventArgs e)
    {
  panel1.Height = heightPanel;
    }

  private void button2_Click(object sender, EventArgs e)
    {
  panel1.Height = this.Height/2;
    }

  private void button3_Click(object sender, EventArgs e)
    {
  panel1.Height = this.Height - 150;
    }
  } 
```

我有一个想法，但我不知道该放在哪里。我认为它会是这样的：

```
panel1.Height=this.BackColor.ToString(); 
```

有什么输入吗？

## 回复回复

是的，如果我单击任何按钮，我想保留 3 种颜色。我不确定这是否可能。例如：

```
my button1 =pink
button2=yellow
button3=green 
```

如果我点击按钮 1 我会看到粉红色，如果我点击按钮 2 我会看到粉红色和黄色。

那可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-04T12:21:18.760

您需要做的就是将 设置`BackColor`在新行上。例如...

```
private void button2_Click(object sender, EventArgs e)
{
    panel1.Height = this.Height/2;
    panel1.BackColor = Color.Yellow;
}

private void button3_Click(object sender, EventArgs e)
{
    panel1.Height = this.Height - 150;
    panel1.BackColor = Color.Yellow;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:21:56.433

简单如：

```
panel1.BackColor = Color.Red; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T12:22:41.190

在`button2_Click`中，只需添加另一行，如下所示：

```
panel1.BackColor = Color.Yellow; 
```

# actionscript-3 - AS3：如何在 über 类中更改属性时触发事件？

> ID：819843
> 
> 赞同：0
> 
> 时间：2009-05-04T12:18:44.897
> 
> 标签：actionscript-3, actionscript, event-handling

我在 Sprite 中有一个 TextField，我总是希望 TextField 的 alpha 等于 sprite 的 alpha。如何订阅 Sprite 中所做的更改？我想我需要以某种方式触发 PropertychangeEvent，但我看不到精灵开箱即用地支持这个？

```
class TextWidget extends Sprite{  
  private var textfield:TextField;    
  public function TextWidget(){  
    textfield = new TextField();  
    textfield.alpha = this.alpha;  //does'n help  
    addChild(textField);  
??  
  this.addEventListener(PropertyChangeEvent.PROPERTY_CHANGE, updateAlpha);  
??  
  }
  private function updateAlpha(event:PropertychangeEvent):void{  
    textfield.alpha = this.alpha;  
  }  
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T12:35:05.187

一种方法是创建精灵的派生类并覆盖 alpha 属性

```
/**
 * ...
 * @author Andrew Rea
 */
public class CustomSprite extends Sprite
{

    public static const ALPHA_CHANGED:String = "ALPHA_CHANGED";

    public function CustomSprite() 
    {

    }

    override public function get alpha():Number { return super.alpha; }

    override public function set alpha(value:Number):void 
    {
        super.alpha = value;

        dispatchEvent(new Event(CustomSprite.ALPHA_CHANGED));
    }
} 
```

另一种方法是在父精灵的 alpha 设置器被击中时设置文本字段 alpha，如上所示，没有事件。

安德鲁

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:34:03.300

一个快速的解决方法是覆盖 alpha 设置器并使用为 TextField 传入的值。

```
public override function set alpha(value:Number):void {
    super.alpha = value;
    textField.alpha = value;
} 
```

# java - 设置连接 mysql 和 jdbc 的最佳方式/模板是什么？

> ID：819845
> 
> 赞同：0
> 
> 时间：2009-05-04T12:19:16.003
> 
> 标签：java, jdbc

与 mysql 的 jdbc 建立连接的最佳方法是什么？并执行简单的语句。怎么做？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T12:30:15.727

MySQL/JDBC 的基本样板是这样的：

**获取连接**：

```
Class.forName("com.mysql.jdbc.Driver").newInstance();
Connection conn = DriverManager.getConnection("jdbc:mysql://databaseName"); 
```

**执行语句**：

```
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery("SELECT * from tableName");
while (rs.next()) {
    System.out.println(rs.getString(1));
} 
```

**关闭语句和连接**：

```
rs.close();
stmt.close();
conn.close(); 
```

您只需要确保已安装驱动程序和/或在您的 CLASSPATH 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T13:14:26.557

这是二十一世纪 - 使用 JPA (ORM) 实现。但是，如果您坚持要回归金属（冒着被否决票的风险）-

从某些驱动程序获取 JDBC 连接的方法有很多。使用带有硬连线类名的反射是最常见的，也可能是最伤脑筋的。如果你打算硬连线一个类名，你可能会得到普通代码的好处（编译器会捕获拼写错误，没有多余的异常需要处理，更容易阅读，明确的依赖关系，更好的工具支持等）。

还要养成安全清理资源的习惯。

所以：

```
public static void main(String[] args) throws SQLException {
     Driver driver = new com.mysql.jdbc.Driver();
     Connection connection = driver.connect(
         "jdbc:mysql://mydatabase", 
         new java.util.Properties() {{
              put("user", "fred");
         }}
     );
     try {
         PreparedStatement statement = connection.prepareStatement(
             "SELECT insideLeg FROM user WHERE name=?"
         );
         try {
             statement.setString(1, "jim");
             ResultSet results = statement.executeQuery();
             try {
                 if (results.next() {
                     System.out.println("= "+results.getLong(1));
                 } else {
                     System.out.println("Missing.");
                 } 
             } finally {
                 results.close();
             }
         } finally {
             statement.close();
         }
     } finally {
         connection.close();
     }
} 
```

真是一团糟！它甚至还没有使用交易。是的，使用 ORM。这些天他们非常受人尊敬。

你不需要为每一个语句做所有这些。您不想每次都创建实例化驱动程序。尤其是execute around 习惯用法很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T12:25:47.377

[这是用于创建 JDBC 连接](http://java.sun.com/docs/books/tutorial/jdbc/basics/connecting.html)的 sun 文档。从那里可以很容易地[访问 Statement 对象](http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Connection.html#createStatement())并运行一些简单的 SQL。

对于生产级系统，您可能还想创建一个[连接池](https://web.archive.org/web/20090630233044/http://java.sun.com/developer/onlineTraining/Programming/JDCBook/conpool.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T12:30:34.980

这取决于你的情况。

如果您只需要从独立应用程序执行一些查询，那么您应该使用单一连接，例如：

```
Class.forName ("yourDriverName");

Connection cn = DriverManager.getConnection ("db url");
Statement st = cn.createStatement ();
ResultSet rs = st.executeQuery ("select * from foo");
while (rs.next()) {
  doSmth ();
} 
rs.close ();
st.close ();
cn.close (); 
```

但是，如果您正在开发真正的应用程序（特别是 Web 应用程序），那么请使用 DataSource。阅读您的数据库和 Web 服务器的手册，了解如何配置数据源。DataSource 允许您使用连接池 - 这将有助于提高性能。

配置 DataSource 并非难事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:42:54.997

使用 Spring Framework 的 JDBC 抽象框架——您需要做的就是创建一个上下文 XML 文件，并使用 JDBC 模板类。只需几行 XML + Java 代码就可以帮助您。优点是使您的连接详细信息远离已编译的 Java。见： [http ://www.springbyexample.org/examples/simple-spring-jdbc-template.html](http://www.springbyexample.org/examples/simple-spring-jdbc-template.html)

# eclipse - 如何在 Eclipse 的工具栏上添加撤消/重做按钮？

> ID：819846
> 
> 赞同：26
> 
> 时间：2009-05-04T12:19:42.757
> 
> 标签：eclipse, toolbar, undo-redo

问这个问题我觉得有点尴尬，但是我怎么能把常规的撤消/重做按钮放到 Eclipse 的工具栏中呢？

我经常在德语和英语键盘布局之间切换。**这些布局上的Y**和**Z**是互换的，因此我经常触发错误的撤消/重做操作。我已经观察到自己在没有其他编辑器的情况下是如何计算的：我只是使用工具栏进行此操作。

我已经尝试过谷歌等，以及通过自定义透视对话框，但无法找到我正在寻找的内容:-(

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-05-04T20:11:16.743

一种方法是使用自定义插件。事实上，这样的自定义插件不需要做任何事情，只需使用现有的撤消/重做命令声明新的工具栏贡献。

我为您构建了这样的插件：[http](http://www.foglyn.com/misc/undoredo_1.0.0.jar) ://www.foglyn.com/misc/undoredo_1.0.0.jar 。绝对没有代码，只有plugin.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
          locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
            <toolbar
                  id="undoredo.toolbar"
                  label="Undo/Redo">
            <command
                  commandId="org.eclipse.ui.edit.undo"
                  id="undoredo.undo"
                  style="push">
            </command>
            <command
                  commandId="org.eclipse.ui.edit.redo"
                  id="undoredo.redo"
                  style="push">
            </command>
         </toolbar>
      </menuContribution>
   </extension>

</plugin> 
```

和清单.MF：

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: Undoredo
Bundle-SymbolicName: undoredo;singleton:=true
Bundle-Version: 1.0.0
Bundle-RequiredExecutionEnvironment: J2SE-1.5
Require-Bundle: org.eclipse.ui 
```

您可以下载它，然后放入 Eclipse 的“dropins”目录，重新启动，您将在工具栏上看到 Undo/Redo 按钮。

在 Eclipse 3.4 和 Eclipse 3.5M7 中为我工作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-04T19:58:28.397

也许如果无法使撤消工具栏正常工作，您可以将撤消/重做组合键的映射更改为您可以更熟悉的组合。

在 Eclipse 中，转到 Window > Preferences，然后在左侧树中，转到 General > Keys。

在“类型过滤器文本”框中，键入撤消，您将看到撤消命令出现在底部列表中。您可以随意将此映射从默认的 Ctrl + Z 更改为另一个映射。您也可以对重做和任何其他操作执行相同的操作，例如删除尾随空格等。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-28T20:03:16.790

**编辑**：这现在包含在 Peter Štibraný 的[回答中](https://stackoverflow.com/a/821801/1344425)

旧线程，但仍然有帮助...对 Peter Štibraný 的出色[回答](https://stackoverflow.com/a/821801/1344425)做了一点补充。将打开的**工具栏**标记更改为：

```
<toolbar
    id="undoredo.toolbar"
    label="Undo/Redo"> 
```

这使得新工具栏在“自定义透视”对话框中显示为带有**撤消/重做**标签，而不是显示为空白条目。（没有足够的代表将其添加到评论中！）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-05T18:07:51.517

工具栏和菜单取决于当前透视图。要更改它们，请转到**Window > Customize Perspective...**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-02-26T17:25:44.587

## 2021 更新

这是 eclipse 2020-12 中的快速修复：窗口 --> 透视 --> 自定义透视 --> 单击编辑复选框 --> 应用并关闭。

这会将撤消/重做按钮放在工具栏上，但在左侧。要移动它们，请单击撤消按钮左侧的三个点，然后拖动到编辑器窗口上方更方便的位置。

# model-view-controller - 游戏框架架构——视图组件还是 MVC？

> ID：819847
> 
> 赞同：8
> 
> 时间：2009-05-04T12:19:46.470
> 
> 标签：model-view-controller, frameworks, components

我正在尝试为我的游戏构建一个非常轻量级的可重用框架，而不是每次开始游戏时都从头开始。我有一个组件驱动的架构 - 例如实体组成一个位置组件和一个健康组件和 Ai 组件等。

我的大问题是我的**模型是否组合视图组件**以允许模型的多个视图，或者是否使用更真实的 MVC，模型不知道其视图，并且它们是在外部管理的。

我已经尝试了这两种方法，但是如果有人知道每种方法的优缺点以及行业标准，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T13:29:33.603

取决于你的观众，游戏开发者，包括我自己都不是很习惯 MVC 模型，虽然大多数人都知道，但由于开发人员伤亡（不是任何严重的技术原因），保持它的干净并不容易。所以从经验来看，我见过几十个游戏框架从 MVC 开始，但只有一对能够维持到最后。我的理论是 MVC 为小型一次性游戏（通常只有几个开发人员）增加了太多的复杂性和很少的好处，并且很难将大多数游戏对象真正干净地分离到大型/复杂游戏的这些层中。而且由于游戏有发布日期，它们很多时候为了性能和快速的临时解决方案而牺牲了代码的清晰度和可重用性（如果续集有必要的话（如果有的话），它们会被重写）。

然而，有了上面的警告，最好把目标定得很高，因为如果你成功了，那就更好了:)，如果你失败了，那就不好了。所以你可能应该尝试 MVC，但如果它失败了也不用担心，专业的游戏开发者在任务上都失败了很多次 :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-04T12:37:03.747

我当然会投票支持该模型对其观点一无所知。松耦合是好的：更简单的模型代码，更容易测试，更多选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-07-26T11:06:32.103

我知道这个问题可能已经过时，但我需要回复它。实际上，我开始在 Lua 中（使用 LÖVE）编写游戏，并开始编写 MVC - 框架。首先，使用 MVC 真的取决于你想要什么。我知道我在游戏编程方面遇到的问题，当程序变得更大时，大多数情况下结构变得过于复杂而无法维护。接下来的事情是，我知道当我找到愿意为它工作的艺术家时，我会改变所有的图形。但在那之前，我将使用我自己的虚拟图形。我希望艺术家可以随心所欲地做他想做的事，而不受任何分辨率或颜色限制。这意味着，我可能不得不更改整个（！）演示代码。甚至可能是对象交互的方式（碰撞检测，fe）。游戏逻辑被捕获在模型中，所以我可以专注于此。我认为游戏逻辑是制作游戏最重要的部分。不是吗？希望你明白我的意思。

但是，如果你把所有东西都放在一起：所有的图形、声音，整个东西；然后你可以直接编码。

我的 MVC 是一个配置而不是约定俗成的东西，它会稍微减慢原型设计的速度。但是（！）开发的迭代可以更容易地进行。测试，尤其是单元测试的完成速度要快得多。我会说 MVC 将您的开发速度曲线（通常是反指数曲线）变成指数曲线。一开始很慢，但最后越来越快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-05T00:48:48.300

MVC 非常适合游戏，至少对于我为跨平台设计的游戏而言。这实际上取决于您如何实施它以获得收益。

# c# - 在 ASP.net 中执行 amout(price) 的验证

> ID：819850
> 
> 赞同：0
> 
> 时间：2009-05-04T12:20:17.717
> 
> 标签：c#, asp.net

我在我的应用程序的数据表中使用“金额”作为列。

我想执行以下验证 wrt 'Amount' 这是一个字符串变量。

1）我想检查金额是否在小数点后超过2位

2）如果金额是正数或负数..（如出现负数错误消息需要闪烁）

你能用简短而有效的代码片段来帮忙吗？？？

编辑：

@彼得：

但是检查小数点后的数字即使对于作为输入的 1986、200134 类型的数字也会显示错误......该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T12:44:35.477

您可以像这样创建一个经过验证的数字文本框：

```
<asp:TextBox ID="txtDollars" Runat="server" />
<asp:CustomValidator 
    runat="server" 
    ErrorMessage="Only a valid number with no more than two decimal places is allowed." 
    ClientValidationFunction="validateDollars"
    />

<script type=text/javascript>
function validateDollars(source,args)
{
    // first check for a valid number
    args.IsValid = !isNaN(args.Value)
    if(args.IsValid)
    {
        // confirmed numeric, now check for 3+ decimals.
        if(args.Value.Match(/\.\d\d\d+/))
            args.IsValid = false;
    }
    return;
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:33:38.217

我很快将一个验证功能放在一起，它应该可以满足您的需求。

```
public static bool validateAmount(string amount)
{
    int posDecSep = amount.IndexOf(NumberFormatInfo.CurrentInfo.NumberDecimalSeparator);
    int decimalPlaces = amount.Length - posDecSep - 1;
    if (posDecSep < 0) { decimalPlaces = 0; }
    if (decimalPlaces > 2)
    {
        //handle error with args, or however your validation works
        return false;
    }
    decimal decAmount;
    if (decimal.TryParse(amount, out decAmount))
    {
        if (decAmount >= 0)
        {
            //positive
        }
        else
        {
            //negative
        }
    }
    return true;
} 
```

# c - 使用 longjmp/setjmp 进行 C 错误处理有哪些“好”方法？

> ID：819864
> 
> 赞同：20
> 
> 时间：2009-05-04T12:23:13.607
> 
> 标签：c, error-handling, setjmp

我必须将 C 用于一个项目，并且我正在考虑将`longjmp/setjmp`其用于错误处理，因为我认为在一个中心位置处理错误比返回代码要容易得多。如果有一些关于如何做到这一点的线索，我将不胜感激。

如果发生任何此类错误，我特别关心是否正确完成资源清理。

另外，我如何处理导致多线程程序使用它们的错误？

更好的是，是否已经存在一些用于错误/异常处理的 C 库？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-04T17:44:23.820

如果您担心资源清理，您必须认真考虑 longjmp() 和 setjmp() 是否是一个好主意。

如果您设计的资源分配系统实际上可以准确地清理，那么它是可以的 - 但是如果您的代码使用的标准库自己分配的资源必须被发布。它需要特别小心，并且由于它不是完全可靠的，因此它不适合可能需要多次使用 setjmp()/longjmp() 调用（它们会泄漏、扩展并最终导致问题）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-04T15:12:11.377

看看这个例子/教程：
[http ://www.di.unipi.it/~nids/docs/longjump_try_trow_catch.html](http://www.di.unipi.it/~nids/docs/longjump_try_trow_catch.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-04T12:32:58.780

我只发现*了一种*用途`setjmp()/longjmp()`，它与错误处理无关。

真的没有必要为此使用它，因为它总是可以被重构为更容易理解的东西。的使用`setjmp()/longjmp()`非常相似`goto`，因为它很容易被滥用。通常，任何使您的代码可读性降低的事情都是一个坏主意。请注意，我并不是说它们天生就不好，只是说它们比替代品更容易导致糟糕的代码。

FWIW，他们非常宝贵的一个地方是我在行业早期所做的一个项目（MS-DOS 6 时间框架）。我设法使用 Turbo C 组合了一个协作多线程库，该库在函数中使用这些函数`yield()`来切换任务。

我很确定从那时起我就没有碰过它们（或有必要）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-04T12:35:42.970

Symbian 实现了它的`Leave`机制，`longjmp()`这可以很好地完成您需要做的所有事情。

Symbian 有一个全局“清理堆栈”，如果发生跳转，您可以推送和弹出要清理的内容。这是 C++ 编译器在抛出 C++ 异常时执行的自动堆栈展开的手动替代方法。

Symbian 有它可以跳出的“陷阱线束”；这些可以嵌套。

（Symbian 最近根据 C++ 异常重新实现了它，但接口保持不变）。

总之，我认为正确的 C++ 异常不太容易出现编码错误，并且比滚动您自己的 C 等效项要快得多。

（例如，现代 C++ 编译器在不抛出“零开销”异常时非常擅长；`longjmp()`必须存储所有寄存器的状态等，即使以后不进行跳转，所以从根本上讲永远不会像例外。）

使用 C++ 作为更好的 C，您只采用异常和 RAII，将是一个很好的途径，应该使用`longjmp()`异常仿真对您很有吸引力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:54:06.403

到目前为止，异常是一种更好的通用机制，但在 C 过去的黑暗时期，我编写了一个包含命令 shell 的处理器模拟器。用于设置jmp/longjmp 以进行中断处理的shell（即，处理器正在运行并且用户点击break/ctrl-c，代码将SIGINT 和longjmps 捕获回shell）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-12T15:37:23.480

我已经使用`setjmp`/`longjmp`相当整洁地从回调中逃脱，而无需通过各种其他库级别进行协商。

这种情况（如果我没记错的话）是 yacc 生成的解析器中的代码可以检测到（非语法）问题，并希望放弃解析但将合理有用的错误报告返回给另一端的调用者所有 yacc 生成的代码。另一个例子是在从 Expat 解析器调用的回调中。在每种情况下，都有其他方法可以做到这一点，但它们似乎比简单地以这种方式纾困更麻烦和晦涩。

但是，正如其他答案所指出的那样，有必要小心清理，并且非常周到地确保`longjmp`代码只能在`setjmp`.

在多线程编程的上下文中这样做？我敢肯定这不是不可能的，但是哦：现在就拿出你家装的阿司匹林吧。`setjmp`将/`longjmp`对尽可能靠近可能是明智之举。只要匹配`setjmp`/`longjmp`对在同一个线程中，我希望你会没事，但是......要小心。

# machine-learning - 音乐分析软件

> ID：819866
> 
> 赞同：5
> 
> 时间：2009-05-04T12:23:17.320
> 
> 标签：machine-learning, audio

问候

我可能已经想到了这一点，但有人知道 Last.fm 以前是否使用过某种形式的开源项目来对音乐进行分析以确定相似的音乐。

随着它现在转移到付费版本，我想做一些可以将已知音乐添加到我的播放列表的东西。（我讨厌手动扫描我的电脑寻找类似的音乐）

做不到这一点 - 有没有人知道我可以用来代替它的任何系统？理想情况下，我想要某种形式的 API / 源代码，可用于将整个过程自动化成批处理作业。

谢谢，

[编辑] 理想情况下，我正在寻找更多内容匹配的内容。我是那种把我所有的音乐都扔到一个杂乱无章的地方的人。然后是懒惰的我希望生成一个播放列表，给我一个类似的音乐类型的播放列表。

Last.fm 使用[http://www.audioscrobbler.net/](http://www.audioscrobbler.net/) - 它还通过 API 提供对其数据库的访问。

[/编辑]

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-04T12:39:07.750

音乐相似性不是一个容易的问题。

解决这个问题有两种通用方法。

**方法 1.** 在问题上投入数据。这是 LastFM 和 Pandora 采用的方法。它基本上是一个由社区或专家组维护的巨大数据库。请注意，要使用这种方法，您将需要干净的元数据或某种音频指纹解决方案，如[musicbrainz](http://musicbrainz.org/)。拥有特征数据库后，您可以使用[Pearson 相关系数](http://en.wikipedia.org/wiki/Correlation)等算法来查找相似项目。

**方法 2.** 用算法解决问题。特别是计算机试听算法。这意味着您计算一首歌曲包含的各种特征的向量，并使用神经网络和各种其他技术，您可以找到具有相似向量的其他歌曲。该方法已成功用于[自动类型分类](http://webhome.cs.uvic.ca/~gtzan/work/projects/pastc.html)和[实例查询](http://en.wikipedia.org/wiki/Query_by_Example)。

如果您正在寻找用于音乐分析的开源软件，[marsyas](http://marsyas.info/)几乎可以做商业软件可以做的所有事情。它是[George Tzanetakis](http://webhome.cs.uvic.ca/~gtzan/)的智囊，在他的网站上，您可以找到许多关于计算机试听状况的论文。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-05T17:30:14.490

[The Echo Nest](http://developer.echonest.com)有一个 Web API，其中包括一个 get_similar Web 服务，允许您检索与一组种子艺术家相似的艺术家。您可以使用它来帮助构建播放列表。Echo Nest 还有一组 Web API，可以对曲目（类似于前面提到的 Marsyas）进行详细分析，可以用作基于声学的歌曲相似性方法的基础。（警告，我在 Echo Nest 工作）。当然，如果您使用 iTunes，也有一些固定的解决方案。iTunes 现在有一个音乐推荐器/播放列表生成器，它将构建来自类似艺术家的歌曲的播放列表。同样，Mufin 公司有一个 iTunes 插件，它将对您的曲目进行声学分析，并使用该分析来构建播放列表。

如果你有兴趣建立自己的音乐相似度系统，我建议你看看 ISMIR（国际音乐信息检索协会）的会议记录。围绕音乐相似性和播放列表进行了大量研究，您会发现它们很有帮助。您可以在 ismir.net 上找到程序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T12:30:38.690

查询（构建？）一些基于流派/风格/等的互联网数据库不是更简单/更有效吗？我使用了 last.fm 和类似的网站，但从来没有觉得他们做了比这更多的事情（至少结果没有表明）；）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T05:30:13.693

我曾经使用 Predixis Magic Mixer。它将对文件中的音频进行简要分析，生成“指纹”并将其与中央数据库中的指纹进行比较。如果列出，它将设置一个识别码，该识别码是对整个文件的分析结果到客户端副本中。如果没有，它将在客户端计算机上进行全面分析（需要一段时间）并将其上传到中央数据库并保留本地副本。根据该信息，它可以建立一个播放列表，根据实际声音将曲调相互关联。我已经有几年没有使用它了，所以我不知道中央数据库服务器是否仍在运行，但网络搜索显示没有。它应该仍然有效，但每个文件都需要全面分析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:38:44.040

我不太确定您到底想要什么，但是[MusicBrainz](http://musicbrainz.org/doc/libmusicbrainz)怎么样？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-01-14T12:51:03.530

需要明确的是，AudioScrobbler 是 Last.fm 为运行其服务而构建的技术。他们收集人们收听的曲目的统计数据（还有“喜欢的曲目和艺术家”）。

所以 Last.fm 做了社会相似性……听过 X 的用户也听过 Y——你喜欢 X，所以也许你也会喜欢 Y。

鉴于提交统计数据的用户群足够大，社交相似性可能会提供比计算机分析方法更好的结果。例如，尝试查询 Last.fm API 以查找与您认识的人相似的艺术家 - 可能会找到一些好的匹配和一些晦涩或古怪的匹配，但它们仍然反映了真实人们的聆听习惯。您搜索的艺术家越模糊，您就越有可能得到奇怪的匹配。

即使您可以让 George Tzanetakis 描述的自动流派分类方法运行良好，您也错过了由真人提供的对质量的主观判断。例如，两首曲目看起来都像“爵士乐”，但有许多不同种类的爵士乐……我可能对最喜欢的爵士音乐家演奏过的非爵士专辑感兴趣。社会相似性更有可能捕获该信息。

# c# - WCF：“无法打开 System.ServiceModel.Channels.ClientReliableDuplexSessionChannel”

> ID：819871
> 
> 赞同：4
> 
> 时间：2009-05-04T12:25:14.820
> 
> 标签：c#, wcf, web-services, timeout, wcf-binding

我目前有一个带有回调合同（双工）的 WCF 服务，当我在我的计算机上使用使用它的应用程序时，一切正常，但是当我从另一台计算机尝试它时，它无法连接。

一旦我切换到使用它`wsDualHttpBinding`（用于回调），这些问题就开始出现，因为当我使用时`wsHttpBinding`一切正常。

为什么 Web 服务不接受来自其他计算机的请求？是否需要修改一些托管设置？

* * *

至于日志，我得到了这些：

[替代文字 http://img17.imageshack.us/img17/4628/wcfissue.jpg](http://img17.imageshack.us/img17/4628/wcfissue.jpg)

> 打开操作未在分配的 00:01:00 超时内完成。分配给此操作的时间可能是较长超时的一部分
> 
> 无法打开 System.ServiceModel.Channels.ClientReliableDuplexSessionChannel
> 
> 故障 System.ServiceModel.Channels.ClientReliableDuplexSessionChannel
> 
> 故障 System.ServiceModel.Channels.ServiceChannel
> 
> 无法打开 System.ServiceModel.Channels.ServiceChannel

* * *

该端口在我的路由器（TCP 和 UDP）上是打开的，所以这不是问题。

至于服务属性，这就是我正在使用的：

*界面：*

```
[ServiceContract(Name = "MusicRepo_DBAccess_Service", 
                 CallbackContract = typeof(IOnlineUsersCallback),
                 SessionMode=SessionMode.Required)] 
```

*服务：*

```
[ServiceBehavior(
        ConcurrencyMode=ConcurrencyMode.Reentrant, 
        InstanceContextMode=InstanceContextMode.Single)] 
```

* * *

**[更新]**

关于[Orion Edwards](https://stackoverflow.com/questions/819871/wcf-failed-to-open-system-servicemodel-channels-clientreliableduplexsessionchann/837106#837106)的帖子：

*   没有防火墙
*   见第 1 点
*   是的，我可以，因为我的路由器上转发了端口
*   我正在使用 IIS 来托管服务器。

问题是，当我从`wsHttpBinding`（工作正常）切换到`wsDualHttpBinding`（因为我需要回调）时，这个问题就开始发生了

* * *

**[更新]**

我现在已经切换`wsDualHttpBinding`到`NetTcpBinding`并且出于某种原因，一切正常。

我使用[这篇文章](http://www.singingeels.com/Articles/Duplex_WCF_Services_Hosted_in_IIS_Using_NetTcp.aspx)来帮助我在 IIS 上设置托管，谢天谢地，一切都按预期工作，带有回调。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-09T08:38:56.343

我现在已经切换`wsDualHttpBinding`到`NetTcpBinding`并且出于某种原因，一切正常。

我使用[这篇文章](http://www.singingeels.com/Articles/Duplex_WCF_Services_Hosted_in_IIS_Using_NetTcp.aspx)来帮助我在 IIS 上设置托管，谢天谢地，一切都按预期工作，带有回调。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-13T00:20:22.003

如果您发布服务器和客户端配置设置会有所帮助。

[以下是MSDN](http://msdn.microsoft.com/en-us/library/ms731821.aspx)中 wsDualHttpBinding 如何工作的摘要（强调我的）：

> WSDualHttpBinding 为 Web Service 协议提供与 WSHttpBinding 相同的支持，但用于双工协定。WSDualHttpBinding 仅支持 SOAP 安全性并需要可靠的消息传递。**此绑定要求客户端具有为服务提供回调端点的公共 URI。这是由 clientBaseAddress 属性提供的。**双重绑定将客户端的 IP 地址暴露给服务。客户端应该使用安全性来确保它只连接到它信任的服务。
> 
> 此绑定可用于通过一个或多个 SOAP 中介进行可靠通信。
> 
> 默认情况下，此绑定生成一个运行时堆栈，其中 WS-ReliableMessaging 用于可靠性，WS-Security 用于消息安全和身份验证，HTTP 用于消息传递，以及文本/XML 消息编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-07T21:21:47.873

检查事项：

*   Windows 防火墙
*   您的防病毒产品的防火墙
*   你能从远程机器telnet到端口吗？
*   您的“服务器”是否在 ASP.NET 开发服务器下运行？这只会接受来自本地主机的请求 - 您需要使用 IIS 自行托管服务器`ServiceHost`或将其托管在 IIS 下。

# c# - .Net 测试自动化

> ID：819872
> 
> 赞同：0
> 
> 时间：2009-05-04T12:25:39.547
> 
> 标签：c#, unit-testing, automated-tests

如何在 C# 中生成点击链接以进行自动化测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T12:37:29.220

如果 razzie 假设是真的并且你想测试你的 gui，如果你正在开发 windows 窗体应用程序，请使用[TestComplete](http://automatedqa.com/products/testcomplete)，它是用于此类用途的完美工具，通常是测试自动化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:34:01.693

我不太确定你想要实现什么。如果您想对您的 GUI 进行“单元测试”，例如，用户单击链接并且他应该导航到页面 X，那么我认为[NUnitASP](http://nunitasp.sourceforge.net/tutorial/index.html)接近您想要的。您基本上可以说您浏览到页面 X，然后可以测试各种事情，例如应该存在的文本框，当用户尝试在该页面上保存表单时应该发生什么，等等。看看这是不是你需要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T11:54:04.677

您可以使用 WinRunner 工具来自动化 GUI 功能。

# svn - 如何实现 SVN 挂钩以了解提交的文件的文件名等？

> ID：819874
> 
> 赞同：1
> 
> 时间：2009-05-04T12:26:06.457
> 
> 标签：svn, windows-xp, tortoisesvn, hook, post-commit

我正在使用 Windows XP 和 TortoiseSVN，我想知道文件名、文件路径、作者以及有关使用提交后挂钩提交到存储库的修订的其他详细信息。我们是否必须使用某种语言来执行此操作，例如 Python，或者即使仅使用批处理文件也可以编写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T12:40:56.560

这是一个关于如何创建 SVN 钩子的很好的教程[http://wordaligned.org/articles/a-subversion-pre-commit-hook](http://wordaligned.org/articles/a-subversion-pre-commit-hook) 基本上你需要创建一个 post-commit.exe 或 bat 脚本。它可以执行你想要 py 调用的 python 代码：

python myhook.py

剧本里面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:31:17.880

[从这里](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.create.html#svn.reposadmin.create.hooks)开始

从该链接引用：

> 但是，Windows 使用文件扩展名来确定程序是否可执行，因此您需要提供一个程序，其基本名称是挂钩的名称，其扩展名是 Windows 识别的可执行程序的特殊扩展名之一，例如*. exe*用于程序，*.bat*用于批处理文件。

# sql - 我可以从列 CHECK 约束中调用用户定义的函数吗？

> ID：819881
> 
> 赞同：4
> 
> 时间：2009-05-04T12:29:46.087
> 
> 标签：sql, sqlanywhere

我有一个用户定义的 SQL 函数，它返回 1 或 0，我想从列 CHECK 约束中调用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T12:30:53.497

是的。SQL Anywhere 没有布尔数据类型，因此您必须编写一个产生 TRUE、FALSE 或 UNKNOWN 的谓词。换句话说，如果您的函数返回 1 或 0 表示通过或失败，您必须将约束编码为 CHECK ( f() = 1 )。

请注意，TRUE 和 UNKNOWN 都会导致“通过”；只有 FALSE 结果会导致检查失败。

以下示例显示如何更改已包含数据的表，以添加具有此类 CHECK 约束的列。

布雷克

```
CREATE TABLE t (
   pkey INTEGER NOT NULL PRIMARY KEY );

INSERT t VALUES ( 1 );
COMMIT;

CREATE FUNCTION is_filled_in ( 
   IN @value VARCHAR ( 100 ) )
RETURNS TINYINT
BEGIN
   IF COALESCE ( @value, '' ) <> '' THEN
      RETURN 1;
   ELSE 
      RETURN 0;
   END IF;
END;

ALTER TABLE t ADD c VARCHAR ( 3 ) DEFAULT 'xxx'
   CHECK ( is_filled_in ( c ) = 1 );

-- Works ok...
INSERT t VALUES ( 2, 'yyy' );
COMMIT;

-- Throws SQLCODE -209 Invalid value for column 'c' in table 't'...
INSERT t VALUES ( 3, '' );
COMMIT;

SELECT * FROM t; 
```

# c# - 如何将项目添加到 ListBox 中列表的开头？

> ID：819891
> 
> 赞同：26
> 
> 时间：2009-05-04T12:31:10.563
> 
> 标签：c#, winforms, listbox

有没有办法将项目添加到 WinForms ListBox 到列表的开头，而无需在循环中重写整个列表？

解决我的问题的其他方法是以相反的顺序显示 ListBox （顶部的最后一项），但我不知道该怎么做。

我的 ListBox 控件用作日志查看器，其中最近的条目应位于顶部。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-04T12:37:04.213

在您的项目上使用该[`Insert`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.objectcollection.insert.aspx)方法`ListBox`。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-04T12:37:51.763

如果我理解正确，您不能使用该`Insert(int index, object item)`方法吗？例如：

```
myListBox.Items.Insert(0, "First"); 
```

这会插入“First”作为列表框的第一项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T12:41:50.553

一种选择可能是使用 ListBox [http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.sort.aspx的 .Sort() 方法](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.sort.aspx)

另一个当然是将您的项目放在通用列表中，然后从该列表中添加/删除项目，而不是直接添加到 ListBox。将列表用作 ListBox 的数据源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T12:38:16.053

如果您为日志事件添加时间戳，您应该能够在数据源中设置排序顺序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:42:47.867

我没有科学证据支持我，但我认为文本框在处理日志可视化方面性能更高。您还可以轻松设置自动滚动，如果您想复制某些内容，则不需要任何编码。

# c# - 如何：从 C# 使用 MS CRM Web 服务？

> ID：819894
> 
> 赞同：1
> 
> 时间：2009-05-04T12:31:51.230
> 
> 标签：c#, dynamics-crm

我必须使用 C# 在 MS CRM（动态）Web 服务中的实体上添加、更新和查询（搜索）。

现在MS CRM中有两个实体Account和Contact，它们都可以用来存储客户信息；上述操作应使用哪个实体？

我被告知我必须使用 MS CRM 的“CRMService”网络服务，该服务将为每个实体提供创建、检索、检索多个、更新、删除和获取的通用方法。是否有任何称为 crmservice 的 Web 服务？

**问题：**

我已经开发/部署了几个 Web 服务，但我从未对 MS CRM 做过任何事情。我不确定如何启动开发？

只是想，我应该创建一个项目，将 Web 服务链接添加到我的 VS2005 IDE 中，然后调用 Web 方法吗？这就是全部？我不需要 MS CRM SDK 吗？如果是，那么我将使用哪些 dll？再说一遍，如何开始使用它？

任何帮助/链接/指针/图表/文章/等将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T17:33:11.723

是的，按照 Bobby 的观点，您不需要 SDK 即可使用 Web 服务。它包含文档、一些在编码插件时使用的 dll 和一些示例项目（您可以查看）。

要使用 Web 服务，您可能对 LinqtoCRM（我开始的一个项目）感兴趣：[http ://codeplex.com/linqtocrm](http://codeplex.com/linqtocrm)

关于客户和联系人，通常您将您的客户公司建模为“客户”，然后创建附加到这些客户的“联系人”，代表您在这些公司与之交谈的实际人员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T13:13:39.727

首先，从这里开始：

[http://technet.microsoft.com/en-us/library/aa613627.aspx](http://technet.microsoft.com/en-us/library/aa613627.aspx)

像往常一样在 VS 项目中添加对此 asmx 的引用：

http:///mscrmservices/2006/crmservice.asmx

（使用适当的 URL）

并且使用那篇technet文章有一个如何使用这些方法的指南。这应该是您所需要的。如果您有任何其他相关问题，只需编辑并在此问题中提供。

# .net - 在 dot net 应用程序中未获取异常的行号

> ID：819895
> 
> 赞同：4
> 
> 时间：2009-05-04T12:32:07.410
> 
> 标签：.net

我有一个用 .Net 3.0 VS2008 编写的数据迁移应用程序。

我已在调试模式下部署并将 PDB 文件复制到我要运行的服务器。

我得到一个例外，但没有行号。

这就是我显示异常的方式

为什么没有异常的行号？？？

马尔科姆

```
 string msg = string.Format("{0} {1} {2}",ex.Message,ex.StackTrace.ToString(),ex.Source.ToString());               
        if(ex.InnerException != null)
            msg += string.Format(" {0}", ex.InnerException.ToString());
        return msg; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-04T12:35:45.467

如果你没有得到行号，那么要么

**a)** .NET 运行时确定 .pdb 与程序集不匹配（过时、使用优化编译等）

或者

**b)**程序集从与包含 .pdb 的目录不同的目录运行（例如，Windows 服务在 %WINDOWS%\System32 下运行）

听起来第一种可能性并不适用于您，那么这是 Windows 服务还是正在更改执行目录？

无论如何，您应该能够使用该`AppDomain.CurrentDomain.BaseDirectory`属性来确定在哪里搜索程序集和 .pdb（默认情况下，这可以被覆盖，但如果它被更改应该是一个很好的指标）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:47:57.900

不要弄乱异常字符串...尝试美化它，只需 ex.toString() 就可以让堆栈展开并打印您正在寻找的信息

当然，pdb 文件需要用于调试信息。但是格式化异常是完全没有必要的，只需调用 ex.toString() 并为您格式化它。

# svn - 如何更正“提交失败。文件 xxx 已过期。找不到 xxx 路径。”

> ID：819896
> 
> 赞同：46
> 
> 时间：2009-05-04T12:32:48.733
> 
> 标签：svn, merge, commit

我最近遇到了一个关于提交 subversion 合并结果的特别棘手的问题。我们的 Subversion 服务器是@1.5.0，我的 TortoiseSVN 客户端现在是@1.6.1。

我正在尝试将功能分支合并回我的主干。合并似乎工作正常；但是，提交失败并显示以下错误消息。

```
Commit failed (details follow):
File 
'flex/src/com/penbay/invision/portal/services/http/soap/ReportServices/GetAllBldgsParamsByRegionBySiteResultEvent.as' 
is out of date
'/svn/ibis/!svn/wrk/531d459d-80fa-ea46-bfb4-940d79ee6d2e/visualization/trunk/source/flex/src/com/penbay/invision/portal/services/http/soap/ReportServices/GetAllBldgsParamsByRegionBySiteResultEvent.as' 
path not found
You have to update your working copy first. 
```

我的工作主干是最新的。我什至已经将一个新的文件检出到另一个文件夹中，以确保没有任何本地杂乱无章的东西弄乱了合并。我对此进行了更多研究，我认为部分问题是用户错误。我认为我们的问题是：

1.  我们有一些开发人员在 1.5 之前和之后提交了使用颠覆客户端的工作。我相信这有可能破坏合并信息。
2.  在其他分支中，我们执行了部分合并。也就是说，我们并不总是在分支的根部执行合并。这是为了便于在同一分支内更新 Flex 和 .NET 工作。
3.  我们在分支上执行了循环（自反）合并。这样做是因为我们有多个并行分支，并且我们希望使用主干中的最新代码定期更新我们的分支。

Subversion 书籍/团队明确不推荐所有这些内容。我们已经吸取了教训，现在知道了最佳实践。但是，我们首先需要合并并提交我们最新的分支。

纠正我们遇到的问题的最佳方法是什么？

删除主干和分支中的所有合并信息是一个可行的解决方案吗？ *不，我已经这样做了，但它不能解决我上面遇到的错误。*

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-08-06T12:42:25.010

我刚遇到这个问题，原因似乎是一个目录被标记为冲突。修理：

```
svn update
svn resolved <the directory in conflict>
svn commit 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-05-12T19:21:37.720

我在 1.6.2 服务器，1.6.8 乌龟上得到这个。全部在 Windows 上，在这个分支中没有合并。

我重命名了一个目录，并且不知何故（可能是由于 AnkhSVN）目录中的两个文件被标记为“已替换”而不是“正常”。对目录中的其他文件进行了一些额外的小改动。

恢复标记为已替换的文件解决了该问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-08-26T08:03:11.777

我也遇到了同样的问题，我用下面的方法解决了

```
svn resolve --accept=working <FILE/FOLDER NAME>
svn cleanup
svn update <FILE/FOLDER NAME>
svn commit <FILE/FOLDER NAME> -m "Comment" 
```

希望对你有帮助 ：）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-24T13:26:42.130

我在尝试提交工作副本时遇到了同样的问题。我所做的是将 Subversion 报告为“找不到路径”的文件夹添加到忽略列表中。提交（应该成功）。然后将相同的文件夹添加回 Subversion。再次提交。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-01-04T04:33:20.237

我刚刚遇到类似的问题，但没有任何分支或合并导致问题。我的解决方法是：

*   svn 将我的工作文件夹（包括未版本控制的文件）导出到临时文件夹。
*   将工作文件夹重命名为备份。
*   svn 结帐主干。
*   将临时导出文件夹中的所有文件夹复制到新的工作文件夹上。
*   svn 提交。

现在一切似乎都很好。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-10-02T15:51:30.813

我知道这是一个旧帖子，但这个问题仍然经常发生。我发现解决它的最简单方法是重命名/删除受影响文件夹中的 .svn/all-wcprops 文件，然后运行更新并提交。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-14T13:40:08.303

我今天遇到了同样的问题，而且我没有进行任何中间合并，所以从你的开篇文章中只有 #1 可能适用 - 但是我已经从 ubuntu 中的 svn 客户端以及 windows 中的 tortoisesvn 进行了提交。幸运的是，在我的情况下，没有对主干进行任何更改，所以我可以用分支替换主干。那么可能不同的svn版本？这很令人担忧。

如果您使用 svn move / copy /delete 功能，但在我的情况下没有丢失任何历史记录 - 我 svn 移动了主干，然后 svn 将分支移动到主干。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-02-08T20:23:41.820

我有同样的问题，不知道是什么原因，但我通过输入终端修复了

```
svn update 
```

然后我承诺并成功了！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-04T20:55:50.070

我一直无法找到解决这个问题的令人满意的方法；但是，我找到了一个不令人满意的解决方案。

我已经删除了主干中的所有文件并提交了这些更改。然后我将我的分支代码导出到主干中，添加了所有文件，并进行了大量提交。这影响了我的树干以 1:1 的比例模仿我的分支（这正是我想要的）。

不幸的是，这造成了很大的分歧，因为所有文件的历史现在都“丢失”了。但由于时间限制，似乎没有任何其他选择。

我仍然会对其他人可能拥有的任何答案感兴趣，因为我想知道根本原因是什么以及将来如何避免它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-12-14T12:29:02.240

Mac 10.6.5 上的 SVN 1.6.5 有类似问题，升级到 SVN 1.6.9 并且提交成功。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-10-22T14:16:34.233

在将具有大量更改的分支合并回我的主干后，我遇到了同样的问题。我能看到的唯一两个解决方案是使用[Pacifika](https://stackoverflow.com/users/997/pacifika)提供的 svn move 解决方案，或者使用 diff 工具手动合并文件。但是我确实找到了解决方法...

不工作的机器正在运行 Subversion 客户端 1.6.5。**我在一台装有Subversion 1.5.4**的机器上做了同样的事情，它奏效了！在两台机器上，我都做了 1) 干线的干净检出，2) svn merge ...，和 3) svn commit。我的服务器是 1.5.x 值得。

希望这可以帮助某人。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-04T17:05:33.117

好家伙！这看起来很糟糕！我能想到的唯一选择是工作副本已损坏。

尝试删除工作副本，执行新签出并再次执行合并。

如果这不起作用，则记录一个错误。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-10-02T18:57:29.333

当我尝试提交一个已删除的包（其中包含各种 java 类但不再需要包中的任何内容）时，我遇到了同样的问题。

为了解决问题，我的解决方案/解决方法：

*   我还原了整个包裹
*   先删除内容
*   提交了删除的内容
*   最后我再次提交了删除的包（它在大多数情况下都有效:-)）

但是，有时无法提交已删除的包（不包含任何内容）

我的解决方法：

*   我在包中创建了一个虚拟类
*   然后我重复了上面提到的步骤

我的最后一个提示......

但有时它有助于简单地再次同步包/项目，然后一切都恢复正常。

关于我的配置：

*   日食霓虹灯
*   SVN 接口：JavaHL (JNI) 1.8.13 (r1667537)
*   VisualSVN 服务器管理器，版本：3.3.1

也许我可以通过我的提示帮助某人。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-07-24T13:54:54.933

这看起来像是`svn:mergeinfo`属性在分支和主干之间变得异常的问题。

这导致了以下问题（请原谅我的命令行指令，因为我经常使用乌龟）：

1.  您是在主干根级别还是子文件夹级别合并？根据我的经验，总是最好在根级别做，这样整个主干都认为它已经被合并到而不是只是一部分（这似乎在 1.5.0 中使 svn 非常困惑）

2.  我的下一个问题是您是否使用了`--reintergrate`参数？我永远不记得如何在乌龟中得到这个，但是当你从一个分支回到树干时，你应该使用这个参数。

3.  在重新整合之前，您是否将主干合并到分支中？这可以帮助消除您在合并回来时可能会看到的冲突？

4.  您是否`svn:mergeinfo`在分支上有任何不在根级别的属性？我发现这总是会导致问题。你总是可以通过去发现这一点`svn -R pg svn:mergeinfo`。然后，您可以记录根目录下的位置和修订，如果您发现它们相关，然后将它们移动到根目录`svn merge --record-only -r start:end <location>` ，然后将它们从子根目录位置删除，然后`svn pd svn:mergeinfo <location>` 您需要提交这些更改

5.  完成所有操作后，再次尝试合并。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-08-03T14:53:33.930

我对此表示怀疑，但也许在您的工作目录上运行 svn cleanup 会有所帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-02T17:33:27.237

I think I've seen something similar when folders were moved on the server but the working copies were still bound to the older SVN folder structure. Not sure if anyone moved things around in your trunk before you had the chance to merge the branch.

Is that a possibility?

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-10-28T13:30:41.250

我遇到了同样的问题，抬起头，发现我已经将represotory中的目录从“/”更改为“/trunk”，并且在TortoiseSVN中忘记执行“Switch”命令！

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-04-10T16:54:44.010

哇，这个我花了一段时间才解决，因为我是通过 Eclipse 使用 SVN。最后，唯一对我有用的是提交所有不受影响的文件，然后（关闭 Eclipse）重命名项目目录，并从 SVN 重新签出项目。很高兴它现在可以正常工作！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2014-06-23T07:50:02.470

显然 SVN 不是一个非常可靠的程序。我遇到了同样的问题（将 SVN 与 Turtoise 一起使用）并通过保存 .cs 文件的内容然后返回 1 个修订版来解决它。这显示了这样的冲突：“<<<<<<< filename my changes

======= 代码从存储库修订合并"

虽然我没有做任何特别的事情（只是一次推迟了修订）。

我用保存的内容替换了这个文件的内容，保存，然后通过 TortoiseSVN → Resolved 选择。然后我可以将修改提交到存储库。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-03-15T12:19:51.763

谢谢杰米布洛克为我工作

根据杰米布洛克，

我刚遇到这个问题，原因似乎是一个目录被标记为冲突。修理：

1.  svn更新
2.  svn 解决了
3.  svn 提交

# svn - 如果路径可写（或不可写），如何在不写任何内容的情况下测试该测试

> ID：819900
> 
> 赞同：1
> 
> 时间：2009-05-04T12:33:59.883
> 
> 标签：svn, apache

假设你有以下颠覆 httpd 服务器：

```
http://svn.mycompany.com/svn/<project-name> 
```

假设您有复杂的授权规则来指定谁可以读取哪里，并且您已将它们写在`svn-access-file.conf`包含基于路径的身份验证配置的其中。

现在假设您将测试配置文件是否正确（不修改 subversion 中的历史记录）。您可以使用类似的东西测试用户（例如alex）是否可以读取位置

```
wget --user=alex --password=******* http://svn.mycompany.com/svn/location/that-should-readable-from-alex/ 
```

您可以使用类似的东西测试用户（例如鲍勃）无法读取的位置

```
wget --user=bob --password=******* http://svn.mycompany.com/svn/location/that-shouldnt-readable-from-bob/ 
```

如何测试该位置是否可由用户写入（或不可写入）？

如何以自动化的方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T17:37:10.767

最简单的方法是设置一个副本（使用`svnhotcopy`或`svnsync`其他方式）并在那里进行测试。

# iphone - 在 iPhone 上引用多个 sqlite 表？

> ID：819914
> 
> 赞同：0
> 
> 时间：2009-05-04T12:37:29.080
> 
> 标签：iphone, sql, cocoa-touch

我还没有足够的“Stack Overflow fu”来找到以前的答案。

我的一个应用程序的数据在 SQLite 数据库中，我使用 Apple SQLiteBooks 示例作为主要灵感——但是，SQLiteBooks 只有一个表和一个视图。我有多个（相关）表作为标签栏中的不同视图访问——例如食谱、食谱、配料、餐具等。示例代码的一些问题：

1）似乎示例代码初始化得太早（在applicationDidFinishLaunching中：当我倾向于viewDidLoad时：）

2）每个类的静态SQL查询字符串需要不同（另一方面，它们通常只在被访问的表上有所不同，所以我可以在静态字符串中使用“？”然后根据需要绑定表ID吗？）

3) 如果我遵循 TheElements 示例代码的引导，它使用 plist 作为数据存储，我似乎会花费太多时间和内存来“预构建”尚未查看的选项卡的数据源。

关于如何/在哪里定义示例中的单个类的多个实例，同时保持高性能和低内存，是否有人有最佳实践的指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T13:45:38.793

你不能用？绑定表名，只有查询上的值。

我建议您看一下[FMDB](http://flycode.googlecode.com/svn/trunk/fmdb/)，它是 Objective-C 中的 SQLite 包装器。

有了它，您可以轻松地让不同的对象查询数据库（某种本土的 ORM）。

Objective-C 中有一些 ActiveRecord 实现，你可以看看，但我没有使用它们。

# language-agnostic - 表模块示例

> ID：819916
> 
> 赞同：3
> 
> 时间：2009-05-04T12:37:45.930
> 
> 标签：language-agnostic, design-patterns, domain-driven-design, sample

我正在寻找一些使用表模块模式来组织业务逻辑（可以是任何语言）的优秀开源示例应用程序。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-05T04:45:54.280

应用程序模式如何：来自 codeplex的[四层 Web 应用程序场景（表模块） ？](http://apparch.codeplex.com/wikipage?title=App%20Pattern%20-%20Four-Tier%20Web%20Application%20Scenario%20%28Table%20Module)我知道这是一篇旧帖子，但我在为自己寻找一些类似的东西时偶然发现了它。所以我认为答案可能对某人有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-26T13:34:58.587

马丁·[福勒](http://martinfowler.com/eaaCatalog/tableModule.html)：

> 表模块用数据库中的每个表一个类来组织域逻辑，并且一个类的单个实例包含将作用于数据的各种过程。

我没有任何开源示例供您参考，但我认为它是不言自明且易于掌握的。

以下是这种模式的迹象：

1.  每桌一节课
2.  低代码重用
3.  高耦合
4.  低凝聚力

我认为在旧的遗留代码中找到该代码比在开源项目中更容易。

# biztalk - BizTalk server 2006 R2 最近没有使用“GAC”ced dll

> ID：819923
> 
> 赞同：0
> 
> 时间：2009-05-04T12:39:12.790
> 
> 标签：biztalk, biztalk2006r2

我有一个 DLL，它是我的应用程序正在使用的`GAC`'ced( ) ，出于某些要求，我更改了该 DLL 中的一个函数，并且：`c:\windows\assembly``Biztalk`

1.  `GAC`我卸载了（版本 1.0.0.0）中的旧 DLL
2.  我`GAC`将新构建的 DLL 转换为`GAC`（版本 1.0.0.0）
3.  我还重新启动了`BizTalk`主机实例。

但输出*似乎*仍然来自旧 DLL 的函数。我没有得到问题，为什么我仍然得到旧的输出。

有谁能够帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-11T08:30:11.830

一些可能有用的提示：

(1) 如果您的群组中有多个 BizTalk 服务器，请务必更新所有服务器！根据您的主机实例配置，您的实例可以在主机实例处于活动状态的任何服务器上运行。

(2) 确保重新启动正确的 biztalk 主机实例。这常常被忽视。不要忘记 BizTalk 隔离主机！如有必要，执行特定 IIS 应用程序池的回收。如果您不确定，请执行 iisreset.exe

(3) 要更新 BizTalk 中的 DLL，通常需要在 BizTalk 数据库中更新它。对于某些更改，它可能只更新 GAC 中的 DLL，但我经常发现这还不够（尤其是在编排中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T13:13:09.050

你在这里描述的是正确的。您应该会看到新的 DLL 接管。有几件事要检查：

1.  您是否回收了正确的主机实例？
2.  您是否回收了所有服务器上的主机实例？
3.  您是否验证了 GAC 的 DLL 上的创建日期以确保安装了新的？

另一个问题可能基于您在应用程序中所做的更改。您只能在特定情况下 Gac/Restart。在 Jon Flander 的博客上看到这个[你什么时候可以重新 gac 并重新开始以供参考。](http://www.jonflanders.com/?p=1361)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T15:20:48.837

If you want to be really sure that the correct assembly that has been GAC:ed, click "Run" and type "%systemroot%\assembly\gac" for .Net 1.1 or "%systemroot%\assembly\gac_msil" for > 2.0.

There you have the physical files for each version number to be checked (or overwrited).

It might help us support you if you let us know what part of BizTalk you are using the assembly, pipeline, functoid, schema etc.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-08-03T19:49:34.117

该 DLL 是在 BizTalk 进程 (BTSNTSvc.exe) 下使用还是由独立主机实例使用？

如果此 DLL 用于接收处理程序（主机）被隔离的接收位置，例如 SOAP 接收位置，则必须从 IIS 而不是主机实例重新启动应用程序池。

# erlang - 如何删除额外的节点

> ID：819928
> 
> 赞同：10
> 
> 时间：2009-05-04T12:42:12.610
> 
> 标签：erlang, mnesia

我有一组 erlang 节点，它们通过 Mnesia 的“extra_db_nodes”复制它们的数据......我需要升级硬件和软件，所以当我从一个节点到另一个节点时，我必须分离一些节点。

如何删除一个节点并仍然保留插入的数据？

[更新] 删除节点与添加节点一样重要。随着时间的推移，随着集群的增长，它也必须收缩。如果没有，那么 Mnesia 将忙于尝试将数据发送到不存在的节点并填满队列并保持网络繁忙。

[**最终更新**] 在翻阅 erlang/mnesia 源代码后，我能够确定无法完全分离节点。虽然 del_table_copy 删除了表之间的链接，但它是不完整的。我会结束这个问题，但没有一个密切的描述是充分的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-05T03:06:06.443

我希望我很久以前就发现了这个：[http ://weblambdazero.blogspot.com/2008/08/erlang-tips-and-tricks-mnesia.html](http://weblambdazero.blogspot.com/2008/08/erlang-tips-and-tricks-mnesia.html)

基本上，使用正常运行的集群....

*   登录要移除的集群

*   停止健忘症

    ```
    mnesia:stop(). 
    ```

*   登录到集群上的不同节点

*   删除架构

    ```
    mnesia:del_table_copy(schema, node@host.domain). 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-19T23:57:08.037

我参加聚会的时间非常晚，但是在寻找解决同一问题的方法时，在文档中发现了以下信息：

> “函数调用 mnesia:del_table_copy(schema, mynode@host) 从 Mnesia 系统中删除节点 'mynode@host'。如果 mnesia 在 'mynode@host' 上运行，则调用失败。其他 mnesia 节点永远不会尝试连接再次到那个节点。注意，如果节点'mynode@host'上有一个磁盘驻留模式，则应该删除整个mnesia目录。这可以通过mnesia:delete_schema/1来完成。如果mnesia在节点 'mynode@host' 并且目录尚未被清除，mnesia 的行为未定义。” （[http://www.erlang.org/doc/apps/mnesia/Mnesia_chap5.html#id74278](http://www.erlang.org/doc/apps/mnesia/Mnesia_chap5.html#id74278)）

我认为以下内容可能会满足您的要求：

```
AllTables = mnesia:system_info(tables),
DataTables = lists:filter(fun(Table) -> Table =/= schema end,
                          AllTables),

RemoveTableCopy = fun(Table,Node) ->
  Nodes = mnesia:table_info(Table,ram_copies) ++
          mnesia:table_info(Table,disc_copies) ++
          mnesia:table_info(Table,disc_only_copies),
  case lists:member(Node,Nodes) of
    true -> mnesia:del_table_copy(Table,Node);
    false -> ok
  end
end,

[RemoveTableCopy(Tbl,'gone@gone_host') || Tbl <- DataTables].

rpc:call('gone@gone_host',mnesia,stop,[]),
rpc:call('gone@gone_host',mnesia,delete_schema,[SchemaDir]),
RemoveTablecopy(schema,'gone@gone_host'). 
```

不过，我没有测试它，因为我的情况略有不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-08T23:11:06.880

我当然使用这种方法来执行此操作（支持 mnesia:del_table_copy/2 使用）。请参阅下面的 removeNode/1：

```
-module(tool_bootstrap).

-export([bootstrapNewNode/1, closedownNode/0,
     finalBootstrap/0, removeNode/1]).

-include_lib("records.hrl").

-include_lib("stdlib/include/qlc.hrl").

bootstrapNewNode(Node) ->
    %% Make the given node part of the family and start the cloud on it
    mnesia:change_config(extra_db_nodes, [Node]),
    %% Now make the other node set things up
    rpc:call(Node, tool_bootstrap, finalBootstrap, []).

removeNode(Node) ->
    rpc:call(Node, tool_bootstrap, closedownNode, []),
    mnesia:del_table_copy(schema, Node).

finalBootstrap() ->
    %% Code removed to actually copy over my tables etc...
    application:start(cloud).

closedownNode() ->
    application:stop(cloud), mnesia:stop(). 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T22:06:10.993

如果您在要删除的节点之外的节点上复制了表（添加的表副本），那么您已经很好 - 只需删除节点即可。

如果你想稍微整洁一点，你可以从你要删除的节点中删除表副本，首先通过`mnesia:del_table_copy/2`.

通常，mnesia 会优雅地处理节点丢失并检测节点重新加入（重新启动的节点从继续运行的节点获取新的表副本，未重新启动的节点被检测为网络分区事件）。Mnesia 不会为已关闭的节点消耗 CPU 或网络流量。我认为，虽然我没有在源代码中确认它，但 mnesia 不会重新连接到自动关闭的节点 - 关闭的节点预计会重新启动（mnesia）并重新连接。

`mnesia:add_table_copy/3`，`mnesia:move_table_copy/3`并且`mnesia:del_table_copy/2`是您应该查看实时模式管理的功能。

该`extra_db_nodes`参数仅应在初始化新的 DB 节点时使用 - 一旦新节点具有模式的副本，它就不需要该`extra_db_nodes`参数。

# java - Java 任务运行时

> ID：819931
> 
> 赞同：2
> 
> 时间：2009-05-04T12:43:47.397
> 
> 标签：java, algorithm, runtime, jvm-hotspot

首先，我必须承认这些都是非常基本和原始的问题......我想演示 Java 中用于排序和搜索的不同算法，并为运行时获取一个值。有我无法解决的问题：

1.  有热点编译 - 这是我需要停用的运行时优化（我猜）。

2.  如何获取运行时的时间值（秒）？在执行之前启动计时器并在之后停止它......似乎有点原始。并且计时器对象本身会消耗运行时......我需要避免这种情况。

Java API 中有什么东西可以用来解决这些问题吗？

谢谢，克劳斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-04T12:53:55.860

您可以在命令行上禁用 HotSpot `-Xint`，以使性能下降一个数量级。但是，您为什么不想衡量现实世界的表现呢？编译时，不同的东西可能会成为瓶颈。

通常用于微基准测试：

*   用于`System.nanoTime`在开始和结束时获得时间测量
*   运行一段合理的时间
*   多次测量（有一些“热身”）
*   不要交错不同算法的测量
*   不要在测量段中执行任何 I/O
*   使用结果（HotSpot 可以完全优化掉琐碎的操作）
*   在现实世界的情况下做（或尽可能的 cloae）
*   记住双核是常态，更多的核心将成为常态

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:54:13.860

1.  使用`-Xint`JVM 标志。其他选项可以在[这里](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)看到。

2.  使用[**`ThreadMXBean`**](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/management/ThreadMXBean.html)API 获取线程的 CPU/用户时间。可以在[这里](http://nadeausoftware.com/articles/2008/03/java_tip_how_get_cpu_and_user_time_benchmarking)看到一个例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T19:00:36.490

使用 System.nanoTime() 两次消耗不到 1 微秒。我建议您在几秒钟内运行任何基准测试并取平均值，这样微秒级的错误就不会很严重。

总的来说，我建议不要让事情变得比你需要的更复杂。

为了进行内置热身，我经常忽略前 10%-20% 的迭代。就像是

```
long start;
int count;
for(int i = -count / 5; i < count; i++) {
    if (count == 0) start = System.nanoTime();
    // do tested code
}
long time = System.nanoTime() - start;
long average = time / count;
System.out.printf("Average time was %,d micro-seconds%n", average / 1000); 
```

# c# - 在 GridView 中生成列（C#、LINQ）

> ID：819934
> 
> 赞同：0
> 
> 时间：2009-05-04T12:44:31.200
> 
> 标签：c#, linq-to-sql, datagridview, datasource

情况是，我需要在网格视图中创建表格，如下所示：

----------| ID---|---姓名---|--1/2002--|--2/2002--|--1/2003--|........| 2/2009 |
客户1--|
客户2--|
:
:
我在 db 中有两个表 - 客户和订单，通过 LINQ to SQL DataContext
ID 和我从简单查询中获得的客户名称

```
var custInfo = from cust in db.Customers
               select new { ID = cust.Id, 
                            FullName = cust.FirstName + " " + cust.LastName } 

dataGridOrdersPreview.DataSource = custInfo; 
```

我需要一些线索，如何生成格式为 t/year 的列，其中 t 表示今年上半年或下半年，并将该年该会话中每个客户的订单分配给生成的列（仅显示成本）

[编辑]

就目前而言，我正在尝试这样的事情：

```
var orders = from ord in db.Orders
             group ord by ord.Id_cust into grouped
             let costs = grouped
               .Where( s => s.YearSession == session && s.Year == year)
               .Select(a => new { Costs = a.Cost ) } )

             select new { ID = grouped.Key,
                          Name = custInfo
                             .Where( a => a.ID == grouped.Key)
                             .Select( j => j.Name).Single(),   
                          Cost = ExtensionLibrary.Sum(costs, "\n")
                      }; 
```

（在成本中仅获取每个客户在该年度会话中的总成本）

然后我考虑遍历这些年和会话，并以某种方式将查询结果获取到相应的列

```
while (year <= DateTime.Today.Year)
        {
            year++;
            while (session < 2)
            {
                session++;
                dataGridOrdersPreview.Columns.Add(session +"/"+ year);
                col.Add((session +"/"+ year), 
                         orders.Select( a => a.Cost ).ToList() );
                /* col is Dictionary<string, List<string> > */

            }
            session = 0;
        } 
```

在这里，我生成了我想要的列，并且我在 Dictionary 中有订单，其中 Key 是列名，Value 是该列中的订单，但我需要一些帮助将其绑定到该列

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T14:39:02.517

我看到它的方式是创建一个具有您想要的属性的类，例如，

```
class CustOrders
{
   public string CustName {get; set;}
   public int Orders2002-1 {get; set;}
   public int Orders2002-2 {get; set;}
   ...
   public int Orders2009-1 {get; set;}
} 
```

然后使用 System.Windows.Forms.BindingSource，称它为 CustOrdsBindingSource 并将其 DataSource 设置为新类的列表。

```
List<CustOrders> myListOfCustOrders =  new List<CustOrders>();
/* Code to populate myListOfCustOrders */
CustOrdsBindingSource.DataSource = myListOfCustOrders; 
```

在这种情况下，您必须编写代码将查询结果的每个结果转换为 CustOrders 实例并将其存储在 myListOfCustOrders 中。

最后，还必须设置网格视图的数据源：

```
gridView1.DataSource = CustOrdsBindingSource; 
```

我看到这种方法的一个大问题是您必须每年更改 CustOrders 类，除非有一些巫毒教可以建议在运行时将属性插入到类中。

不管怎样，我希望这能给你一个开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T11:40:38.943

只要不会更新/添加/删除行，我想我会手动生成该网格。

获取客户列表和在哪一年/哪个时段的销售数量。然后在表单中获取该列表并创建所需的列。

# delphi - 在 Delphi/BCB 项目中生成事件列表

> ID：819937
> 
> 赞同：0
> 
> 时间：2009-05-04T12:44:55.647
> 
> 标签：delphi, events, c++builder

我想在给定的 BCB 项目中生成分配给它们的事件和方法的列表。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T13:04:09.407

我认为你不能以 100% 可靠的方式做到这一点。但也许只扫描项目文件夹中的所有 *.dfm 以查找以“On”开头的行就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T13:08:56.993

网上有可用的 DFM 解析器代码。

[http://www.felix-colibri.com/papers/colibri_utilities/dfm_parser/dfm_parser.html](http://www.felix-colibri.com/papers/colibri_utilities/dfm_parser/dfm_parser.html)

FWIW，事件只是具有方法类型的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-21T14:04:03.510

我最近自己编写了一个 DFM 文件解析器。我的用例是加载一个表单并从中提取和替换一些二进制信息。该库是用 Go 编写的，它经过 RAD Studio 源代码和我们自己的生产代码的良好测试。

[https://github.com/gonutz/dfm](https://github.com/gonutz/dfm)

您可以使用解析器，在内存中遍历树并从中生成您需要的内容。

# linux - 使用 cron 运行脚本的正确方法？

> ID：819944
> 
> 赞同：3
> 
> 时间：2009-05-04T12:47:41.380
> 
> 标签：linux, bash, scripting, cron, sysadmin

使用 cron 运行脚本时，内部调用的任何可执行文件都必须具有完整路径。我在尝试运行[wondershaper](http://lartc.org/wondershaper/)时发现了这个，当它尝试调用 tc. 所以我的问题是，克服这个问题的正确方法是什么？

可能的解决方案：

*   cd 到可执行文件夹并准备符号链接到那里的任何其他调用的可执行文件（不确定它是否有效 - 可移植性低）
*   在脚本中使用完整路径（它可以工作 - 跨不同发行版的可移植性低）
*   在脚本中导出具有所需路径的路径变量（不确定它是否有效）

好吧，提前感谢任何人的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T13:49:39.280

如果你在 linux/bsd/mac 上，你可以设置一些环境变量，比如`PATH`在 中`crontab`，这样你通常就可以了。

如果你在 Solaris 上，那么，我为你祈祷。但是，我也有一个答案：我通常会`.profile`在运行任何东西之前进行采购：

```
0 0 * * 0 . /home/myuser/.profile && cd /path && ./script 
```

请注意，我的`.profile`负载`.bash_profile`和`.bashrc`. 只要确保您来源的任何文件都有您需要的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T13:50:44.460

由于 cron 不运行登录，因此 .profile 和 /etc/profile 没有来源。因此 PATH 可能未设置为您期望的值。我要么

*   将 PATH 设置并导出为适当的值
*   在脚本中使用完整路径

您使用符号链接的技巧假设 . 在 PATH 中，只是看起来不太好

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-04T14:00:40.533

在您的 cron 作业中声明变量更加明确且更易于维护：您需要修改的所有内容都包含在您的 cron 作业中，如果您将其移动到另一个系统，则无需传输多个文件。

```
PATH=/usr/bin:/your/fancy/dir
MYAPPROOT=/var/lib/myapp

*/2 * * * * myappinpath
*/3 * * * * $MYAPPROOT/mylocalapp 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T13:37:18.507

我的建议：

在外部文件中设置所有变量。我使用位于 /etc/process_name 或类似文件中的“process_name.env”文件。假设您有一个备份脚本。那么你：

*   创建 /etc/backup.env 并放置执行“备份”任务所需的所有环境变量。
*   修改您的备份脚本并在[Shebang](http://en.wikipedia.org/wiki/Shebang_(Unix))之后添加此行：

    . /etc/backup.env #备份环境的完整路径前有一个点和一个空格。

IMO 这种方法比在 CRON 定义中声明变量更好，因为：

*   易于维护。只需编辑一个文件。
*   易于切换配置/集中配置：
    *   您可以有多个 .env 用于在不同情况下使用您的脚本（例如，假设您在 .env 上有备份位置，您可以将 .env 位置作为参数传递并每天运行您的 cron 作业，提供一个位置很少的 .env 和每周通过提供另一个 .env 提供不同的位置，这只是一个示例）。
*   您可以将 .env 文件保存在 SVN 或 Git 等 VCS 中。
*   测试您的脚本非常容易（无需从 CRON 执行它）。

问候

# c# - 在代码隐藏中访问 DataContext

> ID：819949
> 
> 赞同：4
> 
> 时间：2009-05-04T12:49:34.153
> 
> 标签：c#, wpf, xaml, datacontext

当心，这是一个相当基本的问题（我认为）。

我有一个名为 MyUserControl 的 UserControl。我在我的 ListBox 的 DataTemplate 中使用它：

```
<l:MyUserControl DataContext="Test" /> 
```

现在我想在 MyUserControl 的代码隐藏中访问这个 DataContext，我希望 DataContext 包含一个内容为“Test”的字符串对象。但是，DataContext 为空。我在这里想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T14:00:28.787

如果您想在后面的代码中访问 DataContext 属性，请为用户控件（或与此相关的任何控件）命名：

在后面的代码中：

myControl.DataContext = 某个对象；

尽管在您的示例中将 DataContext 设置为“Test”将一事无成。

阅读 WPF [http://msdn.microsoft.com/en-us/library/aa480224.aspx中的数据绑定](http://msdn.microsoft.com/en-us/library/aa480224.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T12:57:02.387

您需要 MyUserControl 的名为 DataContext 的类中的一些字段或属性。

请参阅[此处](http://msdn.microsoft.com/en-us/library/wt9d35z6(VS.71).aspx)以了解 .net 中的用户控件属性。

# c++ - 如何开始用 C++ 编写音乐可视化工具？

> ID：819953
> 
> 赞同：21
> 
> 时间：2009-05-04T12:50:37.833
> 
> 标签：c++, opengl, audio, visualization

我对学习使用 OpenGL 很感兴趣，并且有编写音乐可视化器的想法。谁能给我一些关于我需要哪些元素以及我应该如何学习做到这一点的指示？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-22T10:47:18.217

如果您使用 C++/CLI，这里有一个使用 WPF 四（即傅立叶）显示[的示例。](https://web.archive.org/web/20121006142849/http://blogs.windowsclient.net/ricciolocristian/archive/2008/02/16/audio-spectrum-using-wpf-and-c-cli.aspx)

他引用[了这个网站](http://www.relisoft.com/science/physics/sound.html)（[已存档](https://web.archive.org/web/2/http://www.relisoft.com/science/physics/sound.html)），其中包含有关您的要求的大量信息，这是特定页面的概述；

> 我们如何将声音分成频率？我们的耳朵通过机械方式进行，数学家使用傅里叶变换，计算机使用 FFT。
> 
> 1.  声音物理学
>     *   谐波振荡器
> 2.  采样声音
> 3.  傅立叶分析
> 4.  复数
> 5.  数字傅里叶变换
> 6.  快速傅里叶变换

啊，几分钟后我发现[了这个](http://www.relisoft.com/freeware/index.htm)（[存档），它是一个原生 C++ 分析器。](https://web.archive.org/web/2/http://www.relisoft.com/freeware/index.htm)包括代码，这应该让你开始并运行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T23:49:34.937

我创建 BeatHarness ( [http://www.beatharness.com](http://www.beatharness.com) ) 的方法：

*   实时录制音频
*   有一个线程在音频上运行 FFT 以获得频率强度
*   计算左右声道的音量
*   过滤频段中的频率（低音、中音、高音）

现在您可以在图形显示中使用一些不错的变量。例如，显示一张尺寸乘以低音的图片 - 这将为您提供一张放大节拍的图片。从那里开始，这是你自己的想象！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T13:02:11.877

您是否正在尝试编写自己的音频/音乐播放器？也许您应该尝试为现有播放器编写插件，这样您就可以专注于图形而不是编解码器、dsp 和音频输出设备的细节。

我知道 WinAMP 和 Foobar 有用于可视化插件的 API。我确信 Windows Media Player 和 iTunes 也有它们。只需选择一个媒体播放器并开始阅读。其中一些甚至可能有现有的 OpenGL 插件，您可以从中开始，这样您就可以专注于纯 OpenGL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T13:03:18.817

如果您只是追求一些基本的 3D 或加速 2D，那么我建议您购买 Dave Astle 的“ [Beginning OpenGL Game Programming](https://rads.stackoverflow.com/amzn/click/com/1592003699) ”，其中涵盖了 C++ 中 OpenGL 的基础知识。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T13:11:26.347

对于音乐分析部分，你应该学习傅里叶级数的基础，然后选择一个自由实现的 DFFT（数字快速傅里叶变换）算法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T11:03:20.867

您可以在 C书中的[数值食谱中](http://www.fizyka.umk.pl/nrbook/bookcpdf.html)找到 FFT 算法的实现和其他有用信息。这本书是免费的AFAIK。[C ++](http://www.nr.com/cpp-blurb.html)书中还有数字食谱。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-17T11:45:22.573

您可能需要考虑在 FFTW 上使用 libvisual 的 FFT/DCT 函数；为了生成视觉效果，它们更易于使用并提供同样易于使用的数据。一些媒体播放器和可视化插件在某种程度上使用 libvisual 来实现视觉效果。示例：Totem（播放器）、GOOM（图腾和其他播放器的插件）、PsyMP3 2.x（播放器）

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-05-04T12:56:14.403

从我的角度来看......检查这个网站： http: [//nehe.gamedev.net/](http://nehe.gamedev.net/)

使用 OpenGL 的非常好的信息和教程

编辑： [http ://www.opengl.org/code/](http://www.opengl.org/code/)

# c# - Castle Windsor WcfFacility 出现奇怪的组件注册错误

> ID：819954
> 
> 赞同：2
> 
> 时间：2009-05-04T12:50:40.140
> 
> 标签：c#, wcf, castle-windsor

我正在尝试将现有站点转换为使用 WCF 与我在另一个盒子上的服务进行通信。目前我使用自动注册来直接连接我的服务。当我尝试使用 Windsor 的 WcfFacility 时，我在尝试注册的接口之一上收到 ComponentRegistrationException。错误如下，它只发生在特定接口上，所有其他接口都正常工作并且以相同的方式编码。

```
Type Demo.IFooService is abstract.
As such, it is not possible to instansiate it as implementation of Demo.IFooService service 
```

我有另一个 Windows 窗体应用程序，我将它转换为使用具有相同服务的 WCF，并且 100% 有效。

我使用以下代码注册 WCF 服务（在 Windows 和 Web 应用程序中）：

```
Container.Register(Component.For<IFooService>()
.Named("FooService")
.ActAs(new DefaultClientModel
  {
    EndPoint = WcfEndPoint.BoundTo(new BasicHttpBinding())
               .At("http://localhost/services/fooservice.svc")
  }
 )); 
```

该接口标有ServiceContract 和OperationContract 属性，与其他所有接口相同。

我不知道为什么 Windsor 将其视为抽象类，但正确注册了另一个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T12:02:07.660

我已经解决了这个问题，似乎我以某种方式删除了在 Web 应用程序上注册 WCFFacility 的代码行，但仍然在 Windows 应用程序上，这解释了它为什么在那里工作。我是个白痴，看来……哦，好吧。

希望这将帮助任何遇到该异常并且像我一样白痴的人:)

无论如何感谢您的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T09:31:02.047

获取最新版本。我相信这已经解决了。

# .net - 通过 Windows 更新自动更新您的应用程序

> ID：819961
> 
> 赞同：2
> 
> 时间：2009-05-04T12:53:32.863
> 
> 标签：.net, auto-update

这是一个场景：用户安装您制作的 .NET 应用程序。一段时间后，您会发现其中存在安全问题并为其创建补丁。补丁准备好后，您将其发布到“某处”，并且当下一次 Windows 更新在用户机器上运行（自动或手动）时，该应用程序也会更新。我想知道这是否可能......以及如何？在 MSDN 上搜索它，没有给出任何结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-04T12:59:16.780

您应该查看 Microsoft [ClickOnce](http://msdn.microsoft.com/en-us/library/142dbbz4.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T10:16:24.517

您可以使用Microsoft Update 用于在后台下载文件的[BITS下载器。](http://www.codeproject.com/KB/IP/sharpBITS.aspx?fid=321911&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2947694)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T12:58:42.540

不是，除非它是经过 MS 认证并在 Microsoft 更新上发布的硬件驱动程序。MS 更新网站已关闭，仅限于 MS 软件和一些硬件合作伙伴。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T13:06:04.707

您无法通过 Microsoft 更新来做到这一点，但您可以查看[Paint .NET](http://www.getpaint.net/)或 . [NET Reflector](http://www.red-gate.com/products/reflector/)实现了它们的自动更新功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T12:58:01.120

据我所知，Windows Update 功能仅适用于 Microsoft 提供的软件和更新

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T12:59:13.897

Windows 更新仅适用于 Microsoft 产品。您不能在其上托管您的软件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-04T13:08:17.913

正如其他人所说，你不能。您可以像许多公司一样构建自己的更新程序。

# javascript - 如何在 JavaScript 中打开 HTML 页面

> ID：819962
> 
> 赞同：0
> 
> 时间：2009-05-04T12:53:34.487
> 
> 标签：javascript, html

我有一个 .html 文件 (X)，根据某些值，在打开 .html 文件 (X) 时应该立即打开另一个 .html 文件 (Y)。在 javascript 中实现这一点的最佳方法是什么？

我还希望当用户在 Y .html 上按下“刷新 (F5)”时，应该再次加载的页面是启动当前页面 (X) 的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T13:00:15.390

> 我有一个 .html 文件 (X)，根据某些值，在打开 .html 文件 (X) 时应该立即打开另一个 .html 文件 (Y)。在 javascript 中实现这一点的最佳方法是什么？

您可以使用[window.open](http://www.javascript-coder.com/window-popup/javascript-window-open.phtml)来做到这一点。

> 我还希望当用户在 Y .html 上按下“刷新 (F5)”时，应该再次加载的页面是启动当前页面 (X) 的页面。

您可以在页面 (Y) 的[onbeforeunload](http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx)事件中使用

```
window.parent.window.location.href = window.parent.window.location.href; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T13:01:55.403

使用 jQuery，它可能看起来像这样：

```
<input type="text" id="whatPage" value="somepagename">
<input type="button" id="someinput" value="getPage">

<div id="targetDiv">
  I will be filled with the resulting HTML.
</div>

<script>
  $('#someinput').click(function() {
    $.ajax({
     url: $('#whatPage').val()+'.htm',
     success: function(response) {
       $('#targetDiv').html(response);
     }
    });
  });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T13:05:27.470

最好的事情是ajax。在一些主 div 中通过 javascript 加载 Y 的内容。[这里](http://www.cristalab.com/tutoriales/ajax-y-javascript-no-intrusivo-y-accesible-c218l/)有一些信息。

简单的选择是使用框架。首先加载一个框架 X，然后根据值加载并调整第二个框架 Y 的大小。[这里](http://www.pageresource.com/jscript/jframe1.htm)有一些信息。

# vb.net - VB代码中奇怪的空指针异常

> ID：819968
> 
> 赞同：0
> 
> 时间：2009-05-04T12:54:58.460
> 
> 标签：vb.net, nullpointerexception

我正在使用 Windows Vista x64 + VSTS 2008。我正在从以下 URL 调试示例程序（本文的相关示例代码），

[http://www.codeproject.com/KB/audio-video/CaptureScreenAsVideo.aspx?display=PrintAll&fid=129831&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=101&select=1160633](http://www.codeproject.com/KB/audio-video/CaptureScreenAsVideo.aspx?display=PrintAll&fid=129831&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=101&select=1160633)

但是当按下写入文件按钮时我遇到了空指针异常，这是我的屏幕快照。

[http://tinypic.com/view.php?pic=14cbfop&s=5](http://tinypic.com/view.php?pic=14cbfop&s=5)

有什么想法有什么问题吗？

EDIT1：这是整个源代码。

```
Imports WMEncoderLib
Imports WMPREVIEWLib

Imports System.IO
Public Class Form1
    Inherits System.Windows.Forms.Form

#Region " Windows Form Designer generated code "

    Public Sub New()
        MyBase.New()

        'This call is required by the Windows Form Designer.
        InitializeComponent()

        'Add any initialization after the InitializeComponent() call

    End Sub

    'Form overrides dispose to clean up the component list.
    Protected Overloads Overrides Sub Dispose(ByVal disposing As Boolean)
        If disposing Then
            If Not (components Is Nothing) Then
                components.Dispose()
            End If
        End If
        MyBase.Dispose(disposing)
    End Sub

    'Required by the Windows Form Designer
    Private components As System.ComponentModel.IContainer

    'NOTE: The following procedure is required by the Windows Form Designer
    'It can be modified using the Windows Form Designer.  
    'Do not modify it using the code editor.
    Friend WithEvents Button1 As System.Windows.Forms.Button
    <System.Diagnostics.DebuggerStepThrough()> Private Sub InitializeComponent()
        Me.Button1 = New System.Windows.Forms.Button
        Me.SuspendLayout()
        '
        'Button1
        '
        Me.Button1.Location = New System.Drawing.Point(48, 80)
        Me.Button1.Name = "Button1"
        Me.Button1.Size = New System.Drawing.Size(216, 23)
        Me.Button1.TabIndex = 1
        Me.Button1.Text = "Write To file and Close application"
        '
        'Form1
        '
        Me.AutoScaleBaseSize = New System.Drawing.Size(5, 13)
        Me.ClientSize = New System.Drawing.Size(292, 266)
        Me.Controls.Add(Me.Button1)
        Me.Name = "Form1"
        Me.Text = "Form1"
        Me.ResumeLayout(False)

    End Sub

#End Region
    Dim Encoder As WMEncoder
    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        ' Create a WMEncoder object.

        Encoder = New WMEncoder
        ' Retrieve the source group collection and add a source group. 

        Dim SrcGrp As IWMEncSourceGroup2
        Dim SrcGrpColl As IWMEncSourceGroupCollection
        SrcGrpColl = Encoder.SourceGroupCollection
        SrcGrp = SrcGrpColl.Add("SG_1")

        ' Add a video and audio source to the source group.
        Dim SrcVid As IWMEncVideoSource2
        Dim SrcAud As IWMEncAudioSource
        SrcVid = SrcGrp.AddSource(WMENC_SOURCE_TYPE.WMENC_VIDEO)
        SrcAud = SrcGrp.AddSource(WMENC_SOURCE_TYPE.WMENC_AUDIO)

        ' Identify the source files to encode.
        SrcVid.SetInput("ScreenCap://ScreenCapture1")
        SrcAud.SetInput("Device://Default_Audio_Device")

        ' Choose a profile from the collection.
        Dim ProColl As IWMEncProfileCollection
        Dim Pro As IWMEncProfile
        Dim i As Integer
        Dim lLength As Long

        ProColl = Encoder.ProfileCollection
        lLength = ProColl.Count
        'For i = 0 To lLength - 1
        '    Console.WriteLine(ProColl.Item(i).Name)
        'Next
        For i = 0 To lLength - 1
            Pro = ProColl.Item(i)
            If Pro.Name = "Windows Media Video 8 for Local Area Network (384 Kbps)" Then
                SrcGrp.Profile = Pro
                Exit For
            End If
        Next

        ' Fill in the description object members.
        Dim Descr As IWMEncDisplayInfo
        Descr = Encoder.DisplayInfo
        Descr.Author = "Armoghan Asif"
        Descr.Copyright = "Copyright information"
        Descr.Description = "Text description of encoded content"
        Descr.Rating = "Rating information"
        Descr.Title = "Title of encoded content"

        ' Add an attribute to the collection.
        Dim Attr As IWMEncAttributes
        Attr = Encoder.Attributes
        Attr.Add("URL", "www.adnare.com")

        ' Specify a file object in which to save encoded content.
        Dim File As IWMEncFile
        File = Encoder.File
        File.LocalFileName = "C:\OutputFile.avi"

        ' Crop 2 pixels from each edge of the video image.
        SrcVid.CroppingBottomMargin = 2
        SrcVid.CroppingTopMargin = 2
        SrcVid.CroppingLeftMargin = 2
        SrcVid.CroppingRightMargin = 2

        ' Start the encoding process.
        Encoder.Start()

    End Sub

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        If Encoder.RunState Then
            Encoder.Stop()
            Application.Exit()
        End If
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T13:01:46.883

您是否按照文章中的说明安装了[Windows Media Encoder 9 系列](http://www.microsoft.com/windows/windowsmedia/forpros/encoder/features.aspx)和[SDK](http://www.microsoft.com/windows/windowsmedia/forpros/encoder/default.mspx)？我的猜测是，这是罪魁祸首。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T13:00:39.850

你可能没有编码器。检查先决条件（请参阅此行：“您将需要 Windows Media Encoder 9 系列和 SDK。”）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T13:02:37.583

这段代码还完好无损吗？

```
Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    ' Create a WMEncoder object.
    Encoder = New WMEncoder 
```

这意味着该代码丢失或悄然失败。

如果在下一行设置断点`Encoder = New WMEncoder`，那么 的值是`Encoder`多少？

# iphone - 性能方面：很多小 PNG 还是一个大 PNG？

> ID：819974
> 
> 赞同：5
> 
> 时间：2009-05-04T12:57:18.237
> 
> 标签：iphone, performance, graphics

为 iPhone 开发一个简单的游戏，什么能提供更好的性能？

1.  **为我的 UIViews 的背景使用很多小的（10x10 到 30x30 像素）PNG。**
2.  **使用一个大的 PNG 并裁剪到我的 UIViews 的边界。**

我的想法是，第一种技术需要的每个 UIView 的内存更少，但它使 iPhone 处理大量图像的方式变得复杂，因为它试图将图像组合成更大的纹理或尝试在所有小纹理之间切换很多。

另一方面，第二种技术使 iPhone 有机会只处理一个大的 PNG，但不必要地增加了每个 UIView 必须承载的图像权重。

*   **我对 iPhone 的尝试是否正确，按照我描述的方式处理图像？**
*   **那么，要走的路是什么？**

到目前为止看到答案，仍然存在疑问。似乎需要权衡两个参数：复杂性和 CPU 密集型编码。**我决定使用什么技术的临界点是什么？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-04T13:34:43.310

如果您最终引用相同的 CGImageRef（例如通过共享 UIImage *），则不同视图不会多次加载图像。这是[WWDC 07 主题演讲中拼接墙核心动画演示](http://www.youtube.com/watch?v=pyd8O-2mkgk)所使用的技术。那是 OSX 代码，但 UIView 与 CALayers 非常相似。

Core Graphics 处理图像的方式（无论如何，从我的观察来看）进行了大量调整，以便在内存紧张时进行即时加载和积极释放。

如果 CGImageRef 指向的解码图像的内存已被系统回收，则使用大图像最终可能会在绘制时加载图像。

重要的不是你有多少图像，而是 UIKit 遍历你的代码的频率。

UIViews 和 Core Animation CALayers 只会在你要求它们时重新绘制 ( `-setNeedsDisplay`)，瓶颈通常是你的代码加上将渲染的内容转换为图形芯片的纹理。

所以我的建议是考虑你的 UIView 布局，允许一起更改的部分同时更新，这变成一个单一的纹理上传。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-04T13:13:24.627

一张大图主要是给你更多的工作和更多的头痛。它更难维护，但可能更少 ram 密集型，因为内存中只有一个结构 + 数据，而不是许多结构 + 数据。（虽然可能不足以引起注意）。

查看常规 Mac OS 上 .app 包的内容，似乎普遍认可的存储方法是每个图像一个文件/资源​​。

当然，这是假设您没有从 web 获取图像资源，瓶颈将在 http 及其指定的最大两个并发请求中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T13:05:18.297

一个大的给你更好的性能。（当然，如果您无论如何都应该渲染所有图片）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-04T13:09:19.177

一张大图像将消除与在内存中打开和操作许多图像相关的任何开销。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T17:17:24.213

我想说这个问题没有权威的答案。单个大图像会减少（慢速）闪存访问并一次性完成解码，但是许多较小的图像可以让您更好地控制在什么时候发生的处理......但是它很占用内存，您必须将该图像切片或掩盖它。

You will have to implement one solution and test it. If it isn't fast enough and you can't optimise, implement the other. I suggest implementing the version which you personally find easier to imagine implementing because that will be easiest to implement.

# ruby-on-rails - Has_many 类名不像我想的那样工作？

> ID：819975
> 
> 赞同：0
> 
> 时间：2009-05-04T12:57:24.103
> 
> 标签：ruby-on-rails, ruby

我有一个用户和帖子模型：

```
class User < ActiveRecord::Base
  has_many :sent_posts, :class_name => 'Post'
end

class Post < ActiveRecord::Base
  belongs_to :user
end 
```

问题是在控制台中，如果我这样做

```
User.first.sent_posts.empty? 
```

它返回真。

但如果我在我看来这样做

```
<%= @user.sent_posts.empty? %> 
```

它返回 False。任何想法为什么会发生这种情况？如果我只使用它就可以了

```
has_many :posts 
```

在其自己的。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T13:12:38.620

您确定 User.first 和 @user 是相同的用户模型记录吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T15:24:10.770

弄清楚了。这与在控制器中有一个@user.sent_posts.build 有关！多哈。

# sql - 查询返回相同的总和 - oracle sql

> ID：819980
> 
> 赞同：0
> 
> 时间：2009-05-04T12:59:02.587
> 
> 标签：sql, oracle

想知道是否有人可以对我正在使用的 sql 查询有所了解；

我已经建立了这个查询；

```
SELECT  SUM(TICKET_TYPE.PRICE) AS TOTALCINEMASALES, CINEMA.LOCATION, PERFORMANCE.PERFORMANCE_DATE
FROM    RESERVATION, TICKET, TICKET_TYPE, CINEMA, PERFORMANCE
WHERE   TICKET_TYPE.TICKET_TYPE_ID = TICKET.TICKET_TYPE_ID
        AND TICKET.RESERVATION_ID = RESERVATION.RESERVATION_ID
        AND RESERVATION.PERFORMANCE_ID = PERFORMANCE.PERFORMANCE_ID
        AND CINEMA.LOCATION = 'SKIPTON'
        AND PERFORMANCE.PERFORMANCE_DATE BETWEEN to_date('01/03/2009','DD/MM/yyyy') AND to_date('07/04/2009','DD/MM/yyyy')
GROUP BY
       CINEMA.LOCATION, PERFORMANCE.PERFORMANCE_DATE
ORDER BY
       TOTALCINEMASALES; 
```

每次我运行它时，它都会为 totalcinemasales 的每一行返回相同的总和，但我知道数据库中有不同级别的门票销售等，它会为我改变的每一个位置，任何关于我如何的指针可以改善吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T13:02:40.033

你忘了加入 CINEMA，可能是 PERFORMANCE。

猜测：

```
AND CINEMA.CINEMA_ID = PERFORMANCE.CINEMA_ID 
```

你可以使用 ANSI 连接，当你习惯它时，它实际上更容易阅读：

```
SELECT  SUM(TICKET_TYPE.PRICE) AS TOTALCINEMASALES, CINEMA.LOCATION, PERFORMANCE.PERFORMANCE_DATE
FROM    
   TICKET 
   inner join TICKET_TYPE
     on TICKET_TYPE.TICKET_TYPE_ID = TICKET.TICKET_TYPE_ID
   inner join RESERVATION
     on TICKET.RESERVATION_ID = RESERVATION.RESERVATION_ID
   inner join PERFORMANCE
     on RESERVATION.PERFORMANCE_ID = PERFORMANCE.PERFORMANCE_ID
   inner join CINEMA  /* the missing link */
     on CINEMA.CINEMA_ID = PERFORMANCE.CINEMA_ID
WHERE
   CINEMA.LOCATION = 'SKIPTON'
   AND PERFORMANCE.PERFORMANCE_DATE BETWEEN to_date('01/03/2009','DD/MM/yyyy') AND to_date('07/04/2009','DD/MM/yyyy')
GROUP BY
       CINEMA.LOCATION, PERFORMANCE.PERFORMANCE_DATE
ORDER BY
       TOTALCINEMASALES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T13:04:19.453

```
SELECT  SUM(TICKET_TYPE.PRICE) AS TOTALCINEMASALES, CINEMA.LOCATION, PERFORMANCE.PERFORMANCE_DATE
FROM    RESERVATION, TICKET, TICKET_TYPE, CINEMA, PERFORMANCE
WHERE   TICKET_TYPE.TICKET_TYPE_ID = TICKET.TICKET_TYPE_ID
        AND TICKET.RESERVATION_ID = RESERVATION.RESERVATION_ID
        AND RESERVATION.PERFORMANCE_ID = PERFORMANCE.PERFORMANCE_ID
        AND CINEMA.LOCATION = 'SKIPTON'
-- Added this
        AND PERFORMANCE.CINEMA_ID = CINEMA.CINEMA_ID
--
        AND PERFORMANCE.PERFORMANCE_DATE BETWEEN to_date('01/03/2009','DD/MM/yyyy') AND to_date('07/04/2009','DD/MM/yyyy')
GROUP BY
        CINEMA.LOCATION, PERFORMANCE.PERFORMANCE_DATE
ORDER BY
        TOTALCINEMASALES; 
```

# wpf - 如何在 WPF 应用程序中禁用 XP 主题？

> ID：819990
> 
> 赞同：2
> 
> 时间：2009-05-04T13:00:45.017
> 
> 标签：wpf, windows-xp, themes, tabcontrol

我有一个 WPF 应用程序（.NET 3.0，VS2008），它在选项卡控件中显示数据。此应用程序中几乎所有控件都需要自定义颜色：基本上是白色前景和绿色背景。

我的问题是，当 XP 主题（比如 Luna）处于活动状态时，它会自动应用于渲染控件，以便我的白色文本写在......白色背景上。例如在活动选项卡项目标题上：![不可读的选项卡项目标题](https://lh6.ggpht.com/_dR4_IBKyRV0/Sf7kTth9ZaI/AAAAAAAAAD8/sUrspncvXek/s800/Sigp3d-WPF-Luna.png)

我试过了 ：

*   从生成的应用程序中删除嵌入的清单文件（在项目属性中）：没用。
*   在应用程序资源中强制使用 Windows 经典主题：

    ```
    <ResourceDictionary.MergedDictionaries>
      <ResourceDictionary Source="/PresentationFramework.Classic;V3.0.0.0;31bf3856ad364e35;component/themes/classic.xaml" />
    </ResourceDictionary.MergedDictionaries> 
    ```

最后一次尝试对所有控件都有效，除了仍然如上显示的选项卡控件。

任何的想法 ？

**更新**：我怀疑这种行为是由于我必须应用于选项卡控件的自定义样式：

```
<Window.Resources>
  <Style x:Key="Custom">
    <Setter Property="Control.Background" Value="#FF47C7C8" />
    <Setter Property="Control.Foreground" Value="White" />
  </Style>
  <Style TargetType="TabControl" BasedOn="{StaticResource Custom}" />
</Window.Resources> 
```

那么如何获得带有自定义颜色的经典主题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T14:26:40.293

为了确保跨操作系统的一致行为和外观，您最好的选择是重新模板化 TabItem 控件，然后在选择 TabItem 时使用触发器修改新模板的一部分。尝试以下操作：

```
<Grid>
<Grid.Resources>
  <Style x:Key="Custom">
    <Setter Property="Control.Background" Value="#FF47C7C8"/>
    <Setter Property="Control.BorderBrush" Value="#FF47C7C8"/>
    <Setter Property="Control.Foreground" Value="White"/>
  </Style>
  <Style BasedOn="{StaticResource Custom}" TargetType="TabControl"/>
  <Style TargetType="TabItem">
    <Setter Property="Foreground" Value="White"/>
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type TabItem}">
          <Grid>
            <Border
              Name="Border"
              Background="#FF47C7C8"
              BorderBrush="#FFFFFF"
              BorderThickness="1,1,1,1"
              CornerRadius="2,2,0,0">
              <ContentPresenter
                x:Name="ContentSite"
                HorizontalAlignment="Center"
                Margin="12,2,12,2"
                VerticalAlignment="Center"
                ContentSource="Header"
                RecognizesAccessKey="True"/>
            </Border>
          </Grid>
          <ControlTemplate.Triggers>
            <Trigger Property="IsSelected" Value="True">
              <Setter Property="Panel.ZIndex" Value="100"/>
              <Setter TargetName="Border" Property="Background" Value="#FF47C7C8"/>
              <Setter TargetName="Border" Property="BorderThickness" Value="1,1,1,0"/>
            </Trigger>
          </ControlTemplate.Triggers>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
</Grid.Resources>
<TabControl>
  <TabItem Header="Item 1"/>
  <TabItem Header="Item 2"/>
  <TabItem Header="Item 3"/>
  <TabItem Header="Item 4"/>
</TabControl> 
```

好的机会！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-05-04T13:06:15.657

为什么不使用 WPF Futures 项目中的 WPF 主题！ [WPF 主题](http://wpf.codeplex.com/Wiki/View.aspx?title=WPF%20Themes)

[替代文字 http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=wpf&DownloadId=62497](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=wpf&DownloadId=62497)********``