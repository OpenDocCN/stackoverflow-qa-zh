# StackOverflow 问答 000887000-000887999

# version-control - Perforce“文件内容翻译失败”错误

> ID：887006
> 
> 赞同：7
> 
> 时间：2009-05-20T09:19:06.523
> 
> 标签：version-control, perforce

我正在尝试将大量文件添加到 Perforce 库。在提交时，我收到以下错误，我认为这意味着它无法确定其中一个文件的文件类型：

*   锁定 16380 个文件...
*   第 1 行附近的文件内容翻译失败
*   提交中止——修复问题然后使用“p4 submit -c 5851”。
*   某些文件无法从客户端传输。

我如何获得有关此的更多信息，特别是它实际上遇到问题的文件？在解决问题时，该错误并不完全有帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T09:30:02.883

通常，我会在发布后 5 分钟找到答案。原来 p4v 的文件日志显示的信息比日志窗口更多。打开文件日志，日志文件会告诉你问题出在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-13T17:59:58.420

我刚遇到这个问题。是的，这是由于文件类型问题。但是，如果您有数十万个文件，则很难找到有问题的文件。“p4 opens -c pendingchangelist#”列出了在挂起的更改列表中打开的文件（及其文件类型）。将输出通过管道传输到文本文件。例如，在某些服务器上，不支持 utf16。搜索“utf16”并将它们重新键入二进制（再次，例如）。您可以将有问题的文件从待处理的更改列表移动到另一个待处理的更改列表，然后使用“p4 重新打开”一次性重新键入所有文件。现在您可以重新提交原始的待处理更改列表，然后提交新的待处理更改列表并更正文件类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-17T08:40:06.457

我的情况与 amir 的情况略有不同，但解决方案奏效了。遗憾的是，我不知道在打开的文件中搜索哪个关键字，所以我在控制台上查看了“p4 submit”的输出，发现一个 c 文件以“unicode”打开。将文件作为“文本”重新打开后，我成功提交了我的更改列表。

下次我会在查看输出之前尝试 p4 手册中列出的文件类型，这里是列表：[基本文件类型](http://www.perforce.com/perforce/doc.current/manuals/cmdref/o.ftypes.html#1040647)

# php - 使用@fopen 时出错

> ID：887013
> 
> 赞同：0
> 
> 时间：2009-05-20T09:20:38.360
> 
> 标签：php, fopen

我正在使用@fopen 以“rb”模式打开文件。我在此处打开的文件正在运行，没有错误，但如果我使用 @fopen 打开该文件，则会出现错误。

代码是这样的---

```
$file = @fopen("xyz.com","rb") or $flag=1;

if($flag==1)
{
    mail($to, $subject, $message, $from);
    die();
} 
```

有时它会打开而没有发送任何错误邮件，但有时它会开始提供如此多的错误邮件。

在没有任何错误邮件的情况下打开此 url 的解决方案是什么？请帮忙！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T09:29:36.707

如果您尝试打开一个 URL（假设来自您包含的“xyz.com”），那么您需要在它之前包含架构声明。例如[http://xyz.com](http://xyz.com)，否则 PHP 将尝试打开本地文件。如果您指的是本地文件，请确保在 Windows 上转义任何反斜杠。

但是，您的代码示例的其余部分本质上没有任何其他问题会导致问题。@ 只是抑制错误输出，因此它本身不会导致任何奇怪的行为。

尽管如此，处理它的更好方法可能是这样做：

```
$file = @fopen("xyz.com","rb");

if(!$file)
{
    mail($to, $subject, $message, $from);
    die();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T13:50:58.300

尝试使用

```
file_get_contents(); 
```

函数而不是 fopen()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T09:38:11.773

顺便说一句，当出现错误时，您正在设置 $flag = 1。但是如果上次有错误而这次没有错误怎么办？（那么 $flag 仍然是前一次的 1）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T09:39:04.127

从 fopen 方法的开头删除 '@' 字符，（@ 符号的存在会抑制任何 php 驱动的错误消息）这将为您解释为什么 php 认为您无法打开该文件 - 我会冒险猜测文件路径或文件权限无效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T11:10:02.667

什么是错误信息？我们可以猜测没有它的问题。

您的ini中是否始终允许使用url fopen？也许这个值用 ini_set() 覆盖了某个地方？

您确定该网址正确且主机还活着吗？

最后，我建议改用 fsockopen。它提供了更灵活的远程连接、错误处理以及设置连接超时的可能性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-09T15:34:56.717

@ 符号抑制错误，因此永远不会设置 $flag

# c# - c#编译的应用程序可以在未安装.net的机器上运行吗？

> ID：887016
> 
> 赞同：4
> 
> 时间：2009-05-20T09:22:03.490
> 
> 标签：c#, .net, compilation, native

我想为 windows 开发一个小实用程序，我更喜欢在 c# 中这样做，因为它更容易（我是一个 java 开发人员）。

该实用程序可供许多人下载，我假设其中一些人不会安装 .net 框架（这个假设是否正确，比如我的目标是 win xp 及更高版本？）

我的问题是：ac# 应用程序可以编译成不需要安装 .net 框架的方式吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T09:26:55.447

通常，您需要在目标系统上安装 .NET Framework。没有简单的解决方法。

但是，某些第三方工具（例如 Xenocode 或 Salamander）允许您创建独立的应用程序。请参阅此相关问题：

> [有没有办法将 .NET 应用程序编译为本机代码？](https://stackoverflow.com/questions/45702/is-there-some-way-to-compile-a-net-application-to-native-code)

由于这些解决方案不是直截了当的并且需要商业产品，我建议您创建一个简单的 Visual Studio*安装和部署*项目。在项目的属性中，您应该将 .NET Framework 作为先决条件。创建的 setup.exe 将在安装应用程序之前自动下载并安装 .NET Framework。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-20T09:24:17.200

不，它需要安装 .Net 框架。请注意，您只需要可再发行版本，而不需要 SDK。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T09:29:47.563

一个小问题 - 但在这种情况下，请考虑在 Silverlight 中开发该实用程序 - 它的占用空间要小得多，并且受许多操作系统的支持。这可能让您获得覆盖范围，包括尚未拥有 .NET 的人。

如果您需要“普通”.NET，那么“客户端配置文件”也许是一个选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T09:26:50.517

您可能还可以在应用程序中包含 .net 框架安装程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T09:35:41.513

在一个相关问题中，[您可以在不使用 .Net 框架的情况下编译 C# 吗？](https://stackoverflow.com/questions/551554/can-you-compile-c-without-using-the-net-framework)，有人提到你可以使用来自单声道的 mkbundle 来做到这一点。我自己没有尝试过，所以我无法评论这是否是你应该走的路，但你可能想考虑一下。

# c# - 想要从数据库中检索数据

> ID：887017
> 
> 赞同：0
> 
> 时间：2009-05-20T09:22:09.077
> 
> 标签：c#, .net

```
byte[] imageData = null;
long byteSize = 0;
byteSize = _reader.GetBytes(_reader.GetOrdinal(sFieldName), 0, null, 0, 0);

imageData = new byte[byteSize];
long bytesread = 0;
int curpos = 0, chunkSize = 500;
while (bytesread < byteSize)
{
    // chunkSize is an arbitrary application defined value 
    bytesread += _reader.GetBytes(_reader.GetOrdinal(sFieldName), curpos, imageData, curpos, chunkSize);
    curpos += chunkSize;
}

byte[] imgData = imageData;

MemoryStream ms = new MemoryStream(imgData);
Image oImage = Image.FromStream((Stream)ms);
return oImage; 
```

当我们点击`Image oImage = Image.FromStream((Stream)ms);`这条线执行时我遇到了问题，但之后我得到一个异常“参数无效”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T09:26:49.190

我猜该`imgData`数组实际上并不包含有效的图像（或`Image.FromStream()`至少可以理解的图像）。

尝试根据您认为的数据检查数据。您也可以尝试将流保存到文件并以这种方式打开它 - 我猜它会因为“无效格式”而失败。如果它正确打开，请查看[此相关问题](https://stackoverflow.com/questions/676072/image-fromstream-method-returns-invalid-argument-exception/676113#676113)。

# .net - VS 2008 中的表单设计器有问题吗？

> ID：887021
> 
> 赞同：2
> 
> 时间：2009-05-20T09:23:14.767
> 
> 标签：.net, winforms, visual-studio-2008

我们遇到了几种情况，在加载本来可以的项目时，在 Winforms 设计器中出现错误，如下所示：

> 无法加载文件或程序集“MyLibrary，Version=1.4.3419.14461，Culture=neutral，PublicKeyToken=null”或其依赖项之一。该系统找不到指定的文件。

Visual Studio 死机，提示我们是否希望向 Microsoft 发送调试信息——如果忽略此提示，我们可以关闭受影响的选项卡，保存所有内容，重新加载时一切正常；如果我们不关闭受影响的选项卡，问题就会重复。

我不确定这是否是 Visual Studio 错误，或者我们正在做一些“错误”或意外的事情。有没有人对在哪里查看或此类问题的常见原因有任何想法？

（为了争论，解决方案由 MyLibrary 和 MyLibrary.Windows 组成，其中有对前者的项目引用。一旦加载 Visual Studio，两个项目都没有问题。如果有任何区别，项目已从 VS2003 迁移，而这又没有表现出这种崩溃）

**编辑：**

还尝试加载附加了调试器的解决方案，加载了解决方案，并且它在没有任何异常停止的情况下崩溃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T09:39:25.277

我以前见过这种类型的崩溃，这是由于在自定义用户控件上公开公共属性引起的，这些控件不是 Visual Studio 设计器已经支持的简单类型或结构。

例如（为了说明而写下的代码）：

```
public class MyUserControl : UserControl
{
    // This will be fine.
    public int RowCount { get; set; }

    // This will cause problems
    public CustomerEntity DisplaySubject { get; set; }
} 
```

似乎发生的事情是设计者正试图从设计者“代码”（在单独的文件中）反序列化 from，并且对意外的类型感到困惑。

解决问题的一种方法是不使用自定义类型公开属性，但这在（咳咳）椅子界面中很痛苦。

另一种方法是使用[DesignerSerializationVisibility](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerserializationvisibilityattribute.aspx)属性标记属性，指定隐藏（不要保留在初始化代码中）。

如果你够勇敢，你可以考虑使用[DesignerSerialization](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.serialization.designerserializerattribute.aspx)属性来自己控制序列化，但你不太可能需要它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T09:30:07.127

你可以试试：

*   清理解决方案并进行完全重建
*   删除有问题的引用并再次添加它们
*   清理解决方案并再次执行完全重建
*   重新启动 Visual Studio

祝你好运

**编辑：**

还尝试将引用的 dll 特定版本设置为 false 并重新加载解决方案。请参阅[http://channel9.msdn.com/forums/TechOff/261335-Dreadful-Visual-Studio-2008-crash-Solved/?CommentID=392089](http://channel9.msdn.com/forums/TechOff/261335-Dreadful-Visual-Studio-2008-crash-Solved/?CommentID=392089)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T09:38:39.230

您是否有一个对其父表单进行假设的控件？当表单设计器加载您的表单时，它会创建控件的实例，但不会创建表单类的实例。

因此，如果您的控件之一仅依赖于以您的表单类作为其父级进行实例化，则在加载到表单设计器时它可能会崩溃。

# c# - 在 pgp 中生成公共、私人和密码短语？

> ID：887027
> 
> 赞同：0
> 
> 时间：2009-05-20T09:25:56.307
> 
> 标签：c#, bouncycastle

嗨，谁能告诉我如何使用 c# 中的充气城堡生成 pgp 公共、私人和密码短语？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-09T11:09:22.933

这应该这样做:)

```
//DSA Key Pair Generator
DsaKeyPairGenerator a = new DsaKeyPairGenerator();

//DSA Key Parameter Generator
DsaParametersGenerator paramgen = new DsaParametersGenerator();

//Initialize Key Parameter Generator
paramgen.Init(512, 100, new SecureRandom());

//DSA KeyGeneration Parameters 
DsaKeyGenerationParameters param = new DsaKeyGenerationParameters(new SecureRandom(), paramgen.GenerateParameters());

//Initialize the Key Pair Generator
a.Init(param);

//The DSA Keys!
AsymmetricCipherKeyPair keys = a.GenerateKeyPair();

//PGP PubKey
PgpPublicKey pub = new PgpPublicKey(Org.BouncyCastle.Bcpg.PublicKeyAlgorithmTag.Dsa, keys.Public, DateTime.Now);

//PGP PrivKey
PgpPrivateKey priv = new PgpPrivateKey(keys.Private, pub.KeyId); 
```

# jquery - 如何在 Jquery UI 对话框中实现“确认”对话框？

> ID：887029
> 
> 赞同：151
> 
> 时间：2009-05-20T09:26:08.350
> 
> 标签：jquery, jquery-ui, dialog, modal-dialog

我正在尝试使用 JQuery UI Dialog 来替换丑陋的`javascript:alert()`框。在我的场景中，我有一个项目列表，在每个项目旁边，每个项目都有一个“删除”按钮。伪 html 设置将如下所示：

```
<ul>
    <li>ITEM <a href="url/to/remove"> <span>$itemId</span>
    <li>ITEM <a href="url/to/remove"><span>$itemId</span>
    <li>ITEM <a href="url/to/remove"><span>$itemId</span>
</ul>

<div id="confirmDialog">Are you sure?</div> 
```

在 JQ 部分，在文档准备好时，我首先将 div 设置为带有必要按钮的模态对话框，并将那些“a”设置为在删除之前触发确认，例如：

```
$("ul li a").click(function() {
  // Show the dialog    
  return false; // to prevent the browser actually following the links!
} 
```

好的，这就是问题所在。在初始化期间，对话框将不知道谁（项目）将启动它，以及项目 ID（！）。我如何设置这些确认按钮的行为，以便如果用户仍然选择“是”，它将按照链接将其删除？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2009-06-09T22:33:11.620

我只需要解决同样的问题。使其工作的关键是`dialog`必须在`click`事件处理程序中为您想要使用确认功能的链接部分初始化（如果您想将其用于多个链接）。这是因为必须将链接的目标 URL 注入到确认按钮单击的事件处理程序中。我使用了一个 CSS 类来指示哪些链接应该具有确认行为。

这是我的解决方案，抽象出来以适合示例。

```
<div id="dialog" title="Confirmation Required">
  Are you sure about this?
</div>

<script type="text/javascript">
  $(document).ready(function() {
    $("#dialog").dialog({
      autoOpen: false,
      modal: true
    });
  });

  $(".confirmLink").click(function(e) {
    e.preventDefault();
    var targetUrl = $(this).attr("href");

    $("#dialog").dialog({
      buttons : {
        "Confirm" : function() {
          window.location.href = targetUrl;
        },
        "Cancel" : function() {
          $(this).dialog("close");
        }
      }
    });

    $("#dialog").dialog("open");
  });
</script>

<a class="confirmLink" href="http://someLinkWhichRequiresConfirmation.com">Click here</a>
<a class="confirmLink" href="http://anotherSensitiveLink">Or, you could click here</a> 
```

`confirmLink`如果您可以使用 CSS 类（在我的示例中）生成链接，我相信这对您有用。

这是一个带有代码的[jsfiddle](http://jsfiddle.net/Raitono/jcxv8qom/1/)。

为了全面披露，我会注意到我在这个特定问题上花了几分钟时间，并且我为[这个问题](https://stackoverflow.com/questions/878710/is-a-modal-confirm-box-using-jquery-possible)提供了类似的答案，当时也没有公认的答案。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-11-18T21:36:39.983

我发现 Paul 的答案不太有效，因为他在单击事件上实例化对话框后设置选项的方式不正确。这是我正在工作的代码。我没有对其进行定制以匹配保罗的示例，但这只是猫的胡须在某些元素方面的差异，它们的名称不同。你应该能够解决它。更正是在单击事件按钮的对话框选项的设置器中。

```
$(document).ready(function() {

    $("#dialog").dialog({
        modal: true,
        bgiframe: true,
        width: 500,
        height: 200,
        autoOpen: false
    });

    $(".lb").click(function(e) {

        e.preventDefault();
        var theHREF = $(this).attr("href");

        $("#dialog").dialog('option', 'buttons', {
            "Confirm" : function() {
                window.location.href = theHREF;
            },
            "Cancel" : function() {
                $(this).dialog("close");
            }
        });

        $("#dialog").dialog("open");

    });

}); 
```

希望这对其他人有所帮助，因为这篇文章最初让我走上了正确的道路，我认为我最好发布更正。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2012-01-17T11:22:39.280

我为 jquery ui 确认对话框创建了一个我自己的函数。这是代码

```
function myConfirm(dialogText, okFunc, cancelFunc, dialogTitle) {
  $('<div style="padding: 10px; max-width: 500px; word-wrap: break-word;">' + dialogText + '</div>').dialog({
    draggable: false,
    modal: true,
    resizable: false,
    width: 'auto',
    title: dialogTitle || 'Confirm',
    minHeight: 75,
    buttons: {
      OK: function () {
        if (typeof (okFunc) == 'function') {
          setTimeout(okFunc, 50);
        }
        $(this).dialog('destroy');
      },
      Cancel: function () {
        if (typeof (cancelFunc) == 'function') {
          setTimeout(cancelFunc, 50);
        }
        $(this).dialog('destroy');
      }
    }
  });
} 
```

现在要在您的代码中使用它，只需编写以下内容

```
myConfirm('Do you want to delete this record ?', function () {
    alert('You clicked OK');
  }, function () {
    alert('You clicked Cancel');
  },
  'Confirm Delete'
); 
```

继续。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-03-29T04:49:08.720

我刚刚尝试过的简单而简短的解决方案并且有效

```
 $('.confirm').click(function() {
    $(this).removeClass('confirm');
    $(this).text("Sure?");
    $(this).unbind();
    return false;
  }); 
```

然后只需将 class="confirm" 添加到您的链接中即可！

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-06-10T20:39:17.387

这是我的解决方案..我希望它可以帮助任何人。它是即时写的，而不是复制粘贴的，所以请原谅我的任何错误。

```
$("#btn").on("click", function(ev){
    ev.preventDefault();

    dialog.dialog("open");

    dialog.find(".btnConfirm").on("click", function(){
        // trigger click under different namespace so 
        // click handler will not be triggered but native
        // functionality is preserved
        $("#btn").trigger("click.confirmed");
    }
    dialog.find(".btnCancel").on("click", function(){
        dialog.dialog("close");
    }
}); 
```

我个人更喜欢这个解决方案:)

编辑：对不起..我真的应该更详细地解释它。我喜欢它，因为在我看来它是一个优雅的解决方案。当用户单击需要首先确认的按钮时，事件被取消，因为它必须是。单击确认按钮时，解决方案不是模拟链接单击，而是在原始按钮上触发相同的本机 jquery 事件（单击），如果没有确认对话框，则会触发该事件。唯一的区别是不同的事件命名空间（在本例中为“已确认”），因此确认对话框不会再次显示。然后 Jquery 原生机制可以接管，事情可以按预期运行。另一个优点是它可以用于按钮和超链接。我希望我足够清楚。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-12-19T12:48:09.447

我知道这是一个老问题，但这是我在 MVC4中使用 HTML5[数据属性的解决方案：](http://www.w3.org/TR/2011/WD-html5-20110525/elements.html#embedding-custom-non-visible-data-with-the-data-attributes)

```
<div id="dialog" title="Confirmation Required" data-url="@Url.Action("UndoAllPendingChanges", "Home")">
  Are you sure about this?
</div> 
```

JS代码：

```
$("#dialog").dialog({
    modal: true,              
    autoOpen: false,
    buttons: {
        "Confirm": function () {
            window.location.href = $(this).data('url');
        },
        "Cancel": function () {
            $(this).dialog("close");
        }
    }
});

$("#TheIdOfMyButton").click(function (e) {
    e.preventDefault();
    $("#dialog").dialog("open");
}); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-20T09:39:47.997

这会吗？

```
$("ul li a").click(function(e) {
  e.preventDefault();
  $('#confirmDialog').show();

  var delete_path = $(this).attr('href');

  $('#confirmDialog a.ok').unbind('click'); //  just in case the cancel link 
                                            //  is not the  only way you can
                                            //  close your dialog
  $('#confirmDialog a.ok').click(function(e) {
     e.preventDefault();
     window.location.href = delete_path;
  });

});

$('#confirmDialog a.cancel').click(function(e) {
   e.preventDefault();
   $('#confirmDialog').hide();
   $('#confirmDialog a.ok').unbind('click');
}); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-12-29T00:35:23.900

如上。以前的帖子让我走上了正轨。我就是这样做的。这个想法是在表中的每一行旁边都有一个图像（由数据库中的 PHP 脚本生成）。当单击图像时，用户将被重定向到 URL，因此，相应的记录将从数据库中删除，同时在 jQuery UI 对话框中显示与单击记录相关的一些数据。

JavaScript 代码：

```
$(document).ready(function () {
  $("#confirmDelete").dialog({
    modal: true,
    bgiframe: true,
    autoOpen: false
  });
});

function confirmDelete(username, id) {
  var delUrl = "/users/delete/" + id;
  $('#confirmDelete').html("Are you sure you want to delete user: '" + username + "'");
  $('#confirmDelete').dialog('option', 'buttons', {
    "No": function () {
      $(this).dialog("close");
    },
    "Yes": function () {
      window.location.href = delUrl;
    }
  });
  $('#confirmDelete').dialog('open');
} 
```

对话框分区：

```
<div id="confirmDelete" title="Delete User?"></div> 
```

图片链接：

```
<img src="img/delete.png" alt="Delete User" onclick="confirmDelete('<?=$username;?>','<?=$id;?>');"/> 
```

这样您就可以将 PHP 循环值传递到对话框中。唯一的缺点是使用 GET 方法来实际执行操作。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-20T09:49:45.277

这个怎么样：

```
$("ul li a").click(function() {

el = $(this);
$("#confirmDialog").dialog({ autoOpen: false, resizable:false,
                             draggable:true,
                             modal: true,
                             buttons: { "Ok": function() {
                                el.parent().remove();
                                $(this).dialog("close"); } }
                           });
$("#confirmDialog").dialog("open");

return false;
}); 
```

我已经在这个 html 上对其进行了测试：

```
<ul>
<li><a href="#">Hi 1</a></li>
<li><a href="#">Hi 2</a></li>
<li><a href="#">Hi 3</a></li>
<li><a href="#">Hi 4</a></li>
</ul> 
```

它删除了整个 li 元素，您可以根据需要对其进行调整。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-10-22T15:33:31.160

（截至 2016 年 3 月 22 日，链接到的页面上的下载不起作用。我将链接留在这里，以防开发人员在某个时候修复它，因为它是一个很棒的小插件。原始帖子如下。一个替代方案，以及一个实际有效的链接：[jquery.confirm](https://myclabs.github.io/jquery.confirm/)。）

它可能对您的需求来说太简单了，但您可以试试这个[jQuery 确认插件](http://zoomq.qiniudn.com/ZQScrapBook/ZqFLOSS/data/20091125002853/)。它使用起来非常简单，并且在许多情况下都能胜任。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-11-10T02:05:30.293

尽管我讨厌使用 eval，但它对我来说似乎是最简单的方法，根据不同的情况不会引起很多问题。类似于 javascript 的 settimeout 函数。

```
<a href="#" onclick="javascript:confirm('do_function(params)');">Confirm</a>
<div id="dialog-confirm" title="Confirm" style="display:none;">
    <p>Are you sure you want to do this?</p>
</div>
<script>
function confirm(callback){
    $( "#dialog-confirm" ).dialog({
        resizable: false,
        height:140,
        modal: false,
        buttons: {
            "Ok": function() {
                $( this ).dialog( "close" );
                eval(callback)
            },
            Cancel: function() {
                $( this ).dialog( "close" );
                return false;
            }
        }
    });
}

function do_function(params){
    console.log('approved');
}
</script> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-02-15T02:29:27.237

我自己遇到了这个问题，最终得到了一个解决方案，类似于这里的几个答案，但实现方式略有不同。我不喜欢很多 javascript，或者某个地方的占位符 div。我想要一个通用的解决方案，然后可以在 HTML 中使用，而无需为每次使用添加 javascript。这是我想出的（这需要jquery ui）：

Javascript：

```
$(function() {

  $("a.confirm").button().click(function(e) {

    e.preventDefault();

    var target = $(this).attr("href");
    var content = $(this).attr("title");
    var title = $(this).attr("alt");

    $('<div>' + content + '</div>'). dialog({
      draggable: false,
      modal: true,
      resizable: false,
      width: 'auto',
      title: title,
      buttons: {
        "Confirm": function() {
          window.location.href = target;
        },
        "Cancel": function() {
          $(this).dialog("close");
        }
      }
    });

  });

}); 
```

然后在 HTML 中，不需要 javascript 调用或引用：

```
<a href="http://www.google.com/"
   class="confirm"
   alt="Confirm test"
   title="Are you sure?">Test</a> 
```

由于标题属性用于 div 内容，用户甚至可以通过将鼠标悬停在按钮上来获得确认问题（这就是为什么我没有使用磁贴的标题属性的原因）。确认窗口的标题是 alt 标签的内容。javascript 片段可以包含在通用的 .js 包含中，并且只需应用一个类，您就有一个漂亮的确认窗口。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-06-06T18:45:45.507

我知道这个问题很老，但这是我第一次不得不使用确认对话框。我认为这是最短的方法。

```
$(element).onClick(function(){ // This can be a function or whatever, this is just a trigger
  var conBox = confirm("Are you sure ?");
    if(conBox){ 
        // Do what you have to do
    }
    else
        return;
}); 
```

我希望你喜欢它 ：）

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-12-16T16:10:25.487

非常受欢迎的主题，谷歌发现这个用于“jquery dialog close which event was clicked”查询。我的解决方案正确处理 YES,NO,ESC_KEY,X 事件。无论对话框如何处理，我都希望调用我的回调函数。

```
function dialog_YES_NO(sTitle, txt, fn) {
    $("#dialog-main").dialog({
        title: sTitle,
        resizable: true,
        //height:140,
        modal: true,
        open: function() { $(this).data("retval", false); $(this).text(txt); },
        close: function(evt) {
            var arg1 = $(this).data("retval")==true;
            setTimeout(function() { fn(arg1); }, 30);
        },
        buttons: {
            "Yes": function() { $(this).data("retval", true); $(this).dialog("close"); },
            "No": function()  { $(this).data("retval", false); $(this).dialog("close"); }
        }
    });
}
- - - - 
dialog_YES_NO("Confirm Delete", "Delete xyz item?", function(status) {
   alert("Dialog retval is " + status);
}); 
```

很容易将浏览器重定向到一个新的 url 或在函数 retval 上执行其他操作。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-05-25T11:36:21.303

```
$("ul li a").live('click', function (e) {
            e.preventDefault();

            $('<div></div>').appendTo('body')
                    .html('<div><h6>Are you sure about this?</h6></div>')
                    .dialog({
                        modal: true, title: 'Delete message', zIndex: 10000, autoOpen: true,
                        width: 'auto', modal: true, resizable: false,
                        buttons: {
                            Confirm: function () {
                                // $(obj).removeAttr('onclick');                                
                                // $(obj).parents('.Parent').remove();

                                $(this).dialog("close");

                                window.location.reload();
                            },
                            No: function () {
                                $(this).dialog("close");
                            }
                        },
                        Cancel: function (event, ui) {
                            $(this).remove();
                        }
                    });

            return false;
        }); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-07-20T17:02:21.540

我一直在寻找这个用于 ASP.NET Gridview 中的链接按钮（GridView Control build in Commands）所以对话框中的“确认”操作需要在运行时激活由 Gridview 控件生成的脚本。这对我有用：

```
 $(".DeleteBtnClass").click(function (e) {
     e.preventDefault();
     var inlineFunction = $(this).attr("href") + ";";
     $("#dialog").dialog({
         buttons: {
             "Yes": function () {
                 eval(inlineFunction); // eval() can be harmful!
             },
                 "No": function () {
                 $(this).dialog("close");
             }
         }
     });
 }); 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2012-10-29T15:57:17.803

注意：没有足够的代表发表评论，但 BineG 的回答完美地解决了 Homer 和 echo 强调的 ASPX 页面的回发问题。为了纪念，这里有一个使用动态对话框的变体。

```
$('#submit-button').bind('click', function(ev) {
    var $btn = $(this);
    ev.preventDefault();
    $("<div />").html("Are you sure?").dialog({
        modal: true,
        title: "Confirmation",
        buttons: [{
            text: "Ok",
            click: function() {
                $btn.trigger("click.confirmed");
                $(this).dialog("close");
            }
        }, {
            text: "Cancel",
            click: function() {
                $(this).dialog("close");
            }
        }]
    }).show();  
}); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-03-15T20:48:57.670

上面的另一种变体，它检查控件是呈现为两个不同 html 控件的“asp:linkbutton”还是“asp:button”。似乎对我来说工作得很好，但还没有进行广泛的测试。

```
 $(document).on("click", ".confirm", function (e) {
            e.preventDefault();
            var btn = $(this);
            $("#dialog").dialog('option', 'buttons', {
                "Confirm": function () {
                    if (btn.is("input")) {                            
                        var name = btn.attr("name");
                        __doPostBack(name, '')
                    }
                    else {
                        var href = btn.attr("href");
                        window.location.href = href;
                    }
                    $(this).dialog("close");
                },
                "Cancel": function () {
                    $(this).dialog("close");
                }
            });

            $("#dialog").dialog("open");
        }); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-11-08T16:40:45.783

我个人认为这是在许多 ASP.Net MVC 应用程序的许多视图中经常出现的要求。

这就是我定义模型类和局部视图的原因：

```
using Resources;

namespace YourNamespace.Models
{
  public class SyConfirmationDialogModel
  {
    public SyConfirmationDialogModel()
    {
      this.DialogId = "dlgconfirm";
      this.DialogTitle = Global.LblTitleConfirm;
      this.UrlAttribute = "href";
      this.ButtonConfirmText = Global.LblButtonConfirm;
      this.ButtonCancelText = Global.LblButtonCancel;
    }

    public string DialogId { get; set; }
    public string DialogTitle { get; set; }
    public string DialogMessage { get; set; }
    public string JQueryClickSelector { get; set; }
    public string UrlAttribute { get; set; }
    public string ButtonConfirmText { get; set; }
    public string ButtonCancelText { get; set; }
  }
} 
```

而我的部分观点：

```
@using YourNamespace.Models;

@model SyConfirmationDialogModel

<div id="@Model.DialogId" title="@Model.DialogTitle">
  @Model.DialogMessage
</div>

<script type="text/javascript">
  $(function() {
    $("#@Model.DialogId").dialog({
      autoOpen: false,
      modal: true
    });

    $("@Model.JQueryClickSelector").click(function (e) {
      e.preventDefault();
      var sTargetUrl = $(this).attr("@Model.UrlAttribute");

      $("#@Model.DialogId").dialog({
        buttons: {
          "@Model.ButtonConfirmText": function () {
            window.location.href = sTargetUrl;
          },  
          "@Model.ButtonCancelText": function () {
            $(this).dialog("close");
          }
        }
      });

      $("#@Model.DialogId").dialog("open");
    });
  });
</script> 
```

然后，每次在视图中需要它时，您只需使用 @Html.Partial （在部分脚本中这样做，以便定义 JQuery）：

```
@Html.Partial("_ConfirmationDialog", new SyConfirmationDialogModel() { DialogMessage = Global.LblConfirmDelete, JQueryClickSelector ="a[class=SyLinkDelete]"}) 
```

诀窍是指定将匹配需要确认对话框的元素的 JQueryClickSelector。在我的例子中，所有具有 SyLinkDelete 类的锚点，但它可能是一个标识符、一个不同的类等。对我来说，它是一个列表：

```
<a title="Delete" class="SyLinkDelete" href="/UserDefinedList/DeleteEntry?Params">
    <img class="SyImageDelete" alt="Delete" src="/Images/DeleteHS.png" border="0">
</a> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-05-08T12:59:47.393

这里有很多好的答案；）这是我的方法。类似于 eval() 的用法。

```
function functionExecutor(functionName, args){
    functionName.apply(this, args);
}

function showConfirmationDialog(html, functionYes, fYesArgs){
    $('#dialog').html(html);
    $('#dialog').dialog({
        buttons : [
            {
                text:'YES',
                click: function(){
                    functionExecutor(functionYes, fYesArgs);
                    $(this).dialog("close");
                },
                class:'green'
            },
            {
                text:'CANCEL',
                click: function() {
                    $(this).dialog("close");
                },
                class:'red'
            }
        ]
    });     
} 
```

用法如下：

```
function myTestYesFunction(arg1, arg2){
    alert("You clicked YES:"+arg1+arg2);
}

function toDoOrNotToDo(){
    showConfirmationDialog("Dialog text", myTestYesFunction, ['My arg 1','My arg 2']);
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-10-23T20:14:02.427

开箱即用的 JQuery UI 提供了这个解决方案：

```
$( function() {
    $( "#dialog-confirm" ).dialog({
      resizable: false,
      height: "auto",
      width: 400,
      modal: true,
      buttons: {
        "Delete all items": function() {
          $( this ).dialog( "close" );
        },
        Cancel: function() {
          $( this ).dialog( "close" );
        }
      }
    });
  } ); 
```

HTML

```
<div id="dialog-confirm" title="Empty the recycle bin?">
  <p><span class="ui-icon ui-icon-alert" style="float:left; margin:12px 12px 20px 0;">
 </span>These items will be permanently deleted and cannot be recovered. Are you sure?</p>
</div> 
```

您可以通过为 JQuery 函数提供名称并将您希望显示的文本/标题作为参数传递来进一步自定义它。

参考：[https ://jqueryui.com/dialog/#modal-confirmation](https://jqueryui.com/dialog/#modal-confirmation)

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2010-12-31T19:10:10.523

嗯，这就是你的问题的答案......

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><HTML>
<HEAD>
<TITLE>Santa Luisa</TITLE>
<style>
    body{margin:0;padding:0;background-color:#ffffff;}
    a:link {color:black;}    
a:visited {color:black;}  
a:hover {color:red;}  
a:active {color:red;}
</style>

</HEAD>
<body>

<link rel="stylesheet" href="jquery/themes/base/jquery.ui.all.css">
    <script src="jquery-1.4.4.js"></script>

    <script src="external/jquery.bgiframe-2.1.2.js"></script>
    <script src="ui/jquery.ui.core.js"></script>

    <script src="ui/jquery.ui.widget.js"></script>
    <script src="ui/jquery.ui.mouse.js"></script>
    <script src="ui/jquery.ui.draggable.js"></script>
    <script src="ui/jquery.ui.position.js"></script>

    <script src="ui/jquery.ui.resizable.js"></script>
    <script src="ui/jquery.ui.dialog.js"></script>

    <link rel="stylesheet" href="demos.css">
    <script>
    var lastdel;
    $(function() {
        $( "#dialog" ).dialog({
            autoOpen: false,modal: true,closeOnEscape: true
        });

        $(".confirmLink").click(function(e) {
            e.preventDefault();
            var lastdel = $(this).attr("href");

        });

        $("#si").click( function() {
            $('#dialog').dialog('close');
            window.location.href =lastdel;

        });
        $("#no").click( function() {
            $('#dialog').dialog('close');
        });
    });

    </script>

<SCRIPT LANGUAGE="JavaScript">
<!--
        var currentimgx;
        var cimgoverx=200-6;
        var cimgoutx=200;

        function overbx(obj){
        color='#FF0000';
        width='3px';
        obj.style.borderTopWidth = width;
        obj.style.borderTopColor =color;
        obj.style.borderTopStyle ='solid';

        obj.style.borderLeftWidth = width;
        obj.style.borderLeftColor =color;
        obj.style.borderLeftStyle ='solid';

        obj.style.borderRightWidth = width;
        obj.style.borderRightColor =color;
        obj.style.borderRightStyle ='solid';

        obj.style.borderBottomWidth = width;
        obj.style.borderBottomColor =color;
        obj.style.borderBottomStyle ='solid';

        currentimgx.style.width=cimgoverx+"px";
        currentimgx.style.height=cimgoverx+"px"; 

    }

    function outbx(obj){
        obj.style.borderTopWidth = '0px';   
        obj.style.borderLeftWidth = '0px';
        obj.style.borderRightWidth = '0px';
        obj.style.borderBottomWidth = '0px';

        currentimgx.style.width=cimgoutx+"px";
        currentimgx.style.height=cimgoutx+"px"; 
    }

function ifocusx(obj){
        color='#FF0000';
        width='3px';
        obj.style.borderTopWidth = width;
        obj.style.borderTopColor =color;
        obj.style.borderTopStyle ='solid';

        obj.style.borderLeftWidth = width;
        obj.style.borderLeftColor =color;
        obj.style.borderLeftStyle ='solid';

        obj.style.borderRightWidth = width;
        obj.style.borderRightColor =color;
        obj.style.borderRightStyle ='solid';

        obj.style.borderBottomWidth = width;
        obj.style.borderBottomColor =color;
        obj.style.borderBottomStyle ='solid';

    }

    function iblurx(obj){
        color='#000000';
        width='3px';
        obj.style.borderTopWidth = width;
        obj.style.borderTopColor =color;
        obj.style.borderTopStyle ='solid';

        obj.style.borderLeftWidth = width;
        obj.style.borderLeftColor =color;
        obj.style.borderLeftStyle ='solid';

        obj.style.borderRightWidth = width;
        obj.style.borderRightColor =color;
        obj.style.borderRightStyle ='solid';

        obj.style.borderBottomWidth = width;
        obj.style.borderBottomColor =color;
        obj.style.borderBottomStyle ='solid';
    }

    function cimgx(obj){
        currentimgx=obj;
    }

    function pause(millis){
    var date = new Date();
    var curDate = null;

    do { curDate = new Date(); }
    while(curDate-date < millis);
    } 

//-->
</SCRIPT>
<div id="dialog" title="CONFERMA L`AZIONE" style="text-align:center;">
    <p><FONT  COLOR="#000000" style="font-family:Arial;font-size:22px;font-style:bold;COLOR:red;">CONFERMA L`AZIONE:<BR>POSSO CANCELLARE<BR>QUESTA RIGA ?</FONT></p>

    <p><INPUT TYPE="submit" VALUE="SI" NAME="" id="si"> --><INPUT TYPE="submit" VALUE="NO" NAME="" id="no"></p>
</div>

<TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0" WIDTH="100%" height="100%">
<TR valign="top" align="center">
    <TD>
    <FONT COLOR="red" style="font-family:Arial;font-size:25px;font-style:bold;color:red;">Modifica/Dettagli:<font style="font-family:Arial;font-size:20px;font-style:bold;background-color:yellow;color:red;">&nbsp;298&nbsp;</font><font style="font-family:Arial;font-size:20px;font-style:bold;background-color:red;color:yellow;">dsadas&nbsp;sadsadas&nbsp;</font>&nbsp;</FONT>
    </TD>
</TR>

<tr valign="top">
    <td align="center">
        <TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0" WIDTH="">
        <TR align="left">

            <TD>
                <TABLE CELLSPACING="0" CELLPADDING="0" BORDER="0" WIDTH="">

                <TR align="left">
                    <TD>
                    <font style="font-sixe:30px;"><span style="color:red;">1</span></font><br><TABLE class="tabela" CELLSPACING="0" CELLPADDING="0" BORDER="1" WIDTH="800px"><TR style="color:white;background-color:black;"><TD align="center">DATA</TD><TD align="center">CODICE</TD><TD align="center">NOME/NOMI</TD><TD  align="center">TESTO</TD><td>&nbsp;</td><td>&nbsp;</td></TR><TR align="center"><TD>12/22/2010&nbsp;</TD><TD>298&nbsp;</TD><TD>daaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</TD><TD><A HREF="modificarigadiario.php?codice=298"  style="font-weight:bold;color:red;font-size:30px;">Modifica</A></TD><TD><A HREF="JavaScript:void(0);"  style="font-weight:bold;color:red;font-size:30px;" onclick="$('#dialog').dialog('open');$('#dialog').animate({ backgroundColor: '#aa0000', color: '#fff', width: 250 }, 2000);lastdel='cancellarighe.php?codice=298&id=1';alert(lastdel);" class="confirmLink">Cancella</A></TD><TR align="center"><TD>22/10/2010&nbsp;</TD><TD>298&nbsp;</TD><TD>dfdsfsdfsf</TD><TD><A HREF="modificarigadiario.php?codice=298"  style="font-weight:bold;color:red;font-size:30px;">Modifica</A></TD><TD><A HREF="JavaScript:void(0);"  style="font-weight:bold;color:red;font-size:30px;" onclick="$('#dialog').dialog('open');$('#dialog').animate({ backgroundColor: '#aa0000', color: '#fff', width: 250 }, 2000);lastdel='cancellarighe.php?codice=298&id=2';alert(lastdel);" class="confirmLink">Cancella</A></TD></TABLE><font style="font-sixe:30px;"><span style="color:red;">1</span></font><br>

                    </TD>
                </TR>

                </TABLE>
            </TD>
        </TR>
        </TABLE>
    </td>
</tr>
</tbody></table>

</body>
</html> 
```

确保你有 jquery 1.4.4 和 jquery.ui

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2012-12-13T21:36:05.213

使用 javascript 的简单方法

```
$("#myButton").click(function(event) {
    var cont = confirm('Continue?');
    if(cont) {
        // do stuff here if OK was clicked
        return true;
    }
    // If cancel was clicked button execution will be halted.
    event.preventDefault();
} 
```

* * *

## 回答 #24

> 赞同：-3
> 
> 时间：2021-03-03T18:11:41.907

```
<input type="button" value="Delete" onclick="Delete(@item.id)" / >
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
<script type="text/javascript">
    function Delete(id) {
        if (confirm("Are you sure ?") == true) {
            $.get("/Stud/StudDelete", {
                id: id
            }, function(res) {
                if (res) {
                    location.reload();
                }
            });
        }
    }
</script> 
```

# .net - 最佳实践：单元测试结构化

> ID：887035
> 
> 赞同：3
> 
> 时间：2009-05-20T09:28:35.990
> 
> 标签：.net, unit-testing

我有点困惑。得到了在不同程序集中被单元测试覆盖的项目。共同开发人员也创建了另一个项目 + 另一个单元测试程序集。现在我们想在两个单元测试项目之间混合一些逻辑（对象工厂、一些初始化任务、注入/模拟助手等）。这将导致他的项目引用我使用的程序集。

我找到了一个观点，它代表所有项目的 1 个单元测试程序集（有时是 2 个，其中 2nd 包含集成测试）。这是正确的方法吗？如果不是 - 在哪里放置单元测试的共享逻辑？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T09:49:40.720

当然有不同的方法，没有单一的“正确方法”。这就是我们构建测试的方式：

我们的产品中有“模块”，由几个程序集组成。对于每个“模块”，我们有一个单一的单元测试程序集和一个单一的集成测试程序集。我们以这种方式引用其他人的测试程序集：

*   “核心”单元测试不引用任何东西。它还包含用于单元测试的辅助类。
*   “核心”集成测试参考“核心”单元测试。它包含额外的集成测试助手类（例如数据库的东西）
*   “模块 X”单元测试参考“核心”单元测试
*   “module X”集成测试可以引用“module X”单元测试和“core”测试

“模块 X”测试当然永远不会引用“模块 Y”测试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T09:40:01.800

您应该将单元测试放在单独的程序集中的基本原理是防止将测试代码与生产代码混淆。程序集提供了关注点的清晰分离，并使其足够灵活，您可以在不需要时删除测试。例如，当您发布时，最终客户对下载所有测试代码不感兴趣，而他/她只想使用最终结果。

关于拥有许多测试程序集（每个“实际代码”程序集一个）是一个明智的想法。在测试程序集之间添加引用并不难，实际上可以帮助您避免过多地混淆代码，因为您不希望程序集之间有很多引用（即依赖关系）。

也不要尝试为单元测试提供太多共享逻辑，因为这就是单元测试/模拟/DI框架的用途！在您的测试代码中拥有许多自定义实现的工厂是一个很好的指标，表明您已经使生产代码过于复杂，超出了它的需要。

# mysql - 如何在 MySQL 中转义单引号

> ID：887036
> 
> 赞同：116
> 
> 时间：2009-05-20T09:28:53.710
> 
> 标签：mysql, string, quotes

如何在 MySQL 中插入由单引号或双引号组成的值。IE

```
This is Ashok's Pen. 
```

单引号会产生问题。可能还有其他转义字符。

如何正确插入数据？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2009-05-20T09:31:57.870

只需将每个单引号替换为其中两个：

```
SELECT 'This is Ashok''s Pen.'; 
```

或者用反斜杠转义它：

```
SELECT 'This is Ashok\'s Pen.' 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-20T09:30:08.013

' 是转义字符。所以你的字符串应该是：

> 这是阿肖克的钢笔

如果您使用一些前端代码，则需要在将数据发送到存储过程之前进行字符串替换。

例如，在 C# 中，您可以这样做

```
value = value.Replace("'", "''"); 
```

然后将值传递给存储过程。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-07-12T16:19:42.037

使用此代码：

```
<?php
    $var = "This is Ashok's Pen.";

    mysql_real_escape_string($var);
?> 
```

这将解决您的问题，因为数据库无法检测到字符串的特殊字符。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-20T09:33:16.307

[请参阅我对“如何在 MySQL 中转义字符”](https://stackoverflow.com/questions/881194/how-to-escape-special-character-in-mysql/881208#881208)的回答

无论您使用什么库来与 MySQL 对话，都将内置转义函数，例如在 PHP 中，您可以使用[mysqli_real_escape_string](http://php.net/mysqli_real_escape_string)或[PDO::quote](http://php.net/manual/en/pdo.quote.php)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-05-23T09:56:54.443

如果您使用准备好的语句，驱动程序将处理任何转义。例如（Java）：

```
Connection conn = DriverManager.getConnection(driverUrl);
conn.setAutoCommit(false);
PreparedStatement prepped = conn.prepareStatement("INSERT INTO tbl(fileinfo) VALUES(?)");
String line = null;
while ((line = br.readLine()) != null) {
    prepped.setString(1, line);
    prepped.executeQuery();
}
conn.commit();
conn.close(); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-02-16T20:18:33.380

根据您的观点，还有另一种方法可能更安全，也可能不安全。由于使用了特定的字符串函数，它需要 MySQL 5.6 或更高版本：[`FROM_BASE64`](https://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_from-base64).

假设您要插入此消息：

> “啊，”差点没头的尼克优雅地摆了摆手，“无关紧要的事情……我又不是真的想加入……本来想申请的，但显然我没有达到要求’——”

该引用有一堆单引号和双引号，插入 MySQL 会很痛苦。如果从程序中插入，很容易转义引号等。但是，如果必须将其放入 SQL 脚本中，则必须编辑文本（以转义引号），这可能容易出错或对自动换行等敏感。

相反，您可以对文本进行 Base64 编码，因此您有一个“干净”的字符串：

`SWtGb0xDSWdUbVZoY214NUlFaGxZV1JzWlhOeklFNXBZMnNnZD JGMlpXUWdZVzRnWld4bFoyRnVkQ0JvWVc1a0xDQWlZU0J0WVhS MFpYCklnYjJZZ2JtOGdhVzF3YjNKMFlXNWpaUzRnTGlBdUlDNG dTWFFuY3lCdWIzUWdZWE1nZEdodmRXZG9JRWtnY21WaGJHeDVJ SGRoYm5SbApaQ0IwYnlCcWIybHVMaUF1SUM0Z0xpQlVhRzkxWj JoMElFa25aQ0JoY0hCc2VTd2dZblYwSUdGd2NHRnlaVzUwYkhr Z1NTQW5aRzl1SjMKUWdablZzWm1sc2JDQnlaWEYxYVhKbGJXVn VkSE1uSUMwaUlBPT0K`

关于 Base64 编码的一些说明：

1.  Base64-encoding 是一种*二进制编码*，所以你最好确保你在编码时得到正确的字符集，因为 MySQL 会将 Base64 编码的字符串解码为字节，然后解释它们。确保`base64`和 MySQL 同意字符编码是什么（我推荐 UTF-8）。
2.  为了便于在 Stack Overflow 上阅读，我已将字符串包装为 50 列。您可以将它包装到您想要的任意数量的列（或根本不包装），它仍然可以工作。

现在，将其加载到 MySQL 中：

`INSERT INTO my_table (text) VALUES (FROM_BASE64(' SWtGb0xDSWdUbVZoY214NUlFaGxZV1JzWlhOeklFNXBZMnNnZD JGMlpXUWdZVzRnWld4bFoyRnVkQ0JvWVc1a0xDQWlZU0J0WVhS MFpYCklnYjJZZ2JtOGdhVzF3YjNKMFlXNWpaUzRnTGlBdUlDNG dTWFFuY3lCdWIzUWdZWE1nZEdodmRXZG9JRWtnY21WaGJHeDVJ SGRoYm5SbApaQ0IwYnlCcWIybHVMaUF1SUM0Z0xpQlVhRzkxWj JoMElFa25aQ0JoY0hCc2VTd2dZblYwSUdGd2NHRnlaVzUwYkhr Z1NTQW5aRzl1SjMKUWdablZzWm1sc2JDQnlaWEYxYVhKbGJXVn VkSE1uSUMwaUlBPT0K '));`

这将插入没有任何抱怨，并且您不必手动转义字符串中的任何文本。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-20T09:34:06.650

您应该使用字符转义特殊`\`字符。

```
This is Ashok's Pen. 
```

变成：

```
This is Ashok\'s Pen. 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-04-27T19:48:01.923

如果您想**`(')`**在数据库中保留撇号，请使用以下代码：

```
$new_value = str_replace("'","\'", $value); 
```

`$new_value`可以存储在数据库中。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-11-06T17:56:14.150

在 PHP 中，使用[mysqli_real_escape_string](https://www.php.net/manual/en/mysqli.real-escape-string.php)。

PHP手册中的示例：

```
<?php
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

mysqli_query($link, "CREATE TEMPORARY TABLE myCity LIKE City");

$city = "'s Hertogenbosch";

/* this query will fail, cause we didn't escape $city */
if (!mysqli_query($link, "INSERT into myCity (Name) VALUES ('$city')")) {
    printf("Error: %s\n", mysqli_sqlstate($link));
}

$city = mysqli_real_escape_string($link, $city);

/* this query with escaped $city will work */
if (mysqli_query($link, "INSERT into myCity (Name) VALUES ('$city')")) {
    printf("%d Row inserted.\n", mysqli_affected_rows($link));
}

mysqli_close($link);
?> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-03-10T13:27:51.207

您可以使用此代码，

```
<?php
     $var = "This is Ashok's Pen.";
     addslashes($var);
?> 
```

如果 mysqli_real_escape_string() 不起作用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-11-27T12:37:15.250

如果您使用的是 PHP，只需使用 addlashes() 函数。

[PHP 手册添加斜杠](http://www.php.net/addslashes)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-11-22T10:44:08.073

```
$var = mysqli_real_escape_string($conn, $_POST['varfield']); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-05-22T23:40:37.807

对于编程访问，您可以使用[占位符](http://web.archive.org/web/20051218150351/http://www.geekuprising.com/create_better_perl_and_sql_with_placeholders)自动为您转义不安全的字符。

例如，在 Perl DBI 中，您可以使用：

```
my $string = "This is Ashok's pen";
$dbh->do("insert into my_table(my_string) values(?)",undef,($string)); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-04-19T11:25:27.070

使用addlahes() 或mysql_real_escape_string()。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-12-10T12:47:28.693

我使用Delphi的方式：

TheString 要“转义”：

```
TheString=" bla bla bla 'em some more apo:S 'em and so on "; 
```

解决方案：

```
StringReplace(TheString, #39,'\'+#39, [rfReplaceAll, rfIgnoreCase]); 
```

结果：

```
TheString=" bla bla bla \'em some more apo:S \'em and so on "; 
```

此函数将所有 Char(39) 替换为“\'”，让您可以毫无问题地在 MySQL 中插入或更新文本字段。

在所有编程语言中都可以找到类似的功能！

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-12-04T08:40:08.530

也许您可以查看[`QUOTE`](http://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_quote)MySQL 手册中的功能。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-06-21T04:10:51.930

这就是我的数据作为 API 响应的样子，我想将其存储在 MYSQL 数据库中。它包含引号、HTML 代码等。

例子：-

```
{

rewardName: "Cabela's eGiftCard $25.00",

shortDescription: '<p>adidas gift cards can be redeemed in over 150 adidas Sport Performance, adidas Originals, or adidas Outlet stores in the US, as well as online at&nbsp;<a href="http://adidas.com/">adidas.com</a>.</p>

terms: '<p>adidas Gift Cards may be redeemed for merchandise on&nbsp;<a href="http://adidas.com/">adidas.com</a>&nbsp;and in adidas Sport Performance, adidas Originals, and adidas Outlet stores in the United States.'

} 
```

解决方案

```
CREATE TABLE `brand` (
`reward_name` varchar(2048),
`short_description` varchar(2048),
`terms` varchar(2048),  
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=latin1; 
```

插入时，在后面跟着**JSON.stringify()**

```
 let brandDetails= {
    rewardName: JSON.stringify(obj.rewardName),  
    shortDescription: JSON.stringify(obj.shortDescription),
    term: JSON.stringify(obj.term),
     } 
```

上面是 JSON 对象，下面是向 MySQL 插入数据的 SQL 查询。

```
let query = `INSERT INTO brand (reward_name, short_description, terms) 
VALUES (${brandDetails.rewardName}, 
(${brandDetails.shortDescription}, ${brandDetails.terms})`; 
```

它的工作......

[![在此处输入图像描述](https://i.stack.imgur.com/g8Evq.png)](https://i.stack.imgur.com/g8Evq.png)

如果没有任何效果，试试这个：

```
var res = str.replace(/'/g, "\\'");
var res = res.replace(/"/g, "\\\""); 
```

它将 \ 转义字符添加到**所有（每次）**出现的 ' 和 "

不确定它是否是解决问题的正确/专业方法

我猜它会起作用，但在实际内容中，每个单引号和双引号都将替换为 \ 字符

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-12-30T02:38:23.360

作为 Python 用户，我将引号替换为原始“'”：

```
don_not_work_str = "This is Ashok's Pen."
work_str = don_not_work_str.replace("'", r"\'") 
```

# c# - 关于 C# 中模糊调用的问题

> ID：887044
> 
> 赞同：9
> 
> 时间：2009-05-20T09:30:53.193
> 
> 标签：c#, .net, ambiguous-call

我有一个问题，这不是一个真正的问题，但让我有点好奇。

我有一个类，里面有两种方法。一种是静态方法，另一种是实例方法。这些方法具有相同的名称。

```
public class BlockHeader
{
    public static BlockHeader Peek(BinaryReader reader)
    {
        // Create a block header and peek at it.           
        BlockHeader blockHeader = new BlockHeader();
        blockHeader.Peek(reader);
        return blockHeader;
    }

    public virtual void Peek(BinaryReader reader)
    {
        // Do magic.
    }
} 
```

当我尝试构建我的项目时，我收到一条错误消息：

> 以下方法或属性之间的调用不明确：“MyApp.BlockHeader.Peek(System.IO.BinaryReader)”和“MyApp.BlockHeader.Peek(System.IO.BinaryReader)”

**我知道方法签名实际上是相同的，但我看不出我怎么可能直接从实例成员调用静态方法。**

我认为这是有充分理由的，但有人知道这是什么原因吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-20T09:36:14.790

C# 设计的一般策略是强制您指定可能存在歧义的地方。面对允许人们一举两得地重新调整事物是否静态的重构工具，这种立场是很好的——尤其是对于这样的情况。您会看到许多其他类似的情况（覆盖与虚拟，新的阴影等）。

一般来说，消除这种混乱的空间会使代码更清晰，并迫使你保持你的房子井井有条。

编辑：[来自 Eric Lippert 的一篇好文章讨论了导致您看到的错误的歧义的另一个原因](http://blogs.msdn.com/ericlippert/archive/2009/07/06/color-color.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T10:08:00.497

这是 C# 3.0 语言规范的摘录。

> 方法的签名在声明该方法的类中必须是唯一的。方法的签名由方法的名称、类型参数的数量及其参数的数量、修饰符和类型组成。方法的签名不包括返回类型。

'static' 修饰符不是签名的一部分，因此您的示例违反了此唯一签名规则。

不过，我不知道规则背后的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T09:47:39.993

我认为没有技术上的理由来禁止它，但这样做更多是为了保护程序员免受自己的伤害。考虑以下示例：

```
public static void Main()
{
  BlockHeader BlockHeader = new BlockHeader();
  BlockHeader.Peek();
} 
```

上面的例子是完全有效的，但如果你描述的情况是允许的，它是否可读？你能一眼看出是调用了实例方法还是静态方法？

# iphone - iphone 应用程序图标在 iTunes 商店中显示时模糊

> ID：887050
> 
> 赞同：0
> 
> 时间：2009-05-20T09:32:32.237
> 
> 标签：iphone

在 iTunes Store 上显示时我的图标模糊，但在 iphone 的本地应用商店中很好，我的大图标格式是：

像素：512X512 格式：png dpi:72

任何人都可以指出我在iTunes商店中图标变得模糊的原因是什么，因为我已经遵循了苹果alr要求的所有规范

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T12:49:29.080

**您的 512x512 图标应该是 jpeg**，但我无法想象它会被上传，因为 iTunes Connect 拒绝其他格式。

重新提交是一种选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-12-07T15:23:54.873

我今天发现了同样的问题。仔细阅读规范，我意识到他们要求至少一个 24 位的 .png 文件。我已将 8 位 .png 文件上传到 iTunes Connect。我今天重新提交测试，但我认为这是我的问题。

# iphone - 将用户输入的数据传递到我们的 URL 中，接收 XML

> ID：887053
> 
> 赞同：0
> 
> 时间：2009-05-20T09:33:17.353
> 
> 标签：iphone

'将用户输入的数据传递到我们的 URL 中，接收 XML ' 这如何实现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T09:44:34.960

请参阅[使用NSURLConnection](http://developer.apple.com/documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)。

# java - 如何在 Windows 批处理文件中获取 Java 程序的退出状态

> ID：887066
> 
> 赞同：25
> 
> 时间：2009-05-20T09:37:25.193
> 
> 标签：java, windows, batch-file, exit-code

类似于`$?`Linux，有没有办法在 Windows 批处理文件 ( `.bat`) 中获取程序的退出状态？
例如，程序有一个`System.exit(0)`成功执行，`System.exit(1)`一个失败，我如何在`.bat`文件中捕获这些退出值？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-20T09:41:05.170

使用[%ERRORLEVEL%](http://vlaurie.com/computers2/Articles/environment.htm)。你不喜欢批处理文件的简洁明了吗？:)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-20T09:42:03.247

就像是：

```
java Foo
set exitcode=%ERRORLEVEL%
echo %exitcode% 
```

重要的是让它成为批处理文件的绝对下一行，以避免错误级别被覆盖:)

请注意，如果您使用

```
IF ERRORLEVEL number 
```

批处理文件的“特征”，它的意思是“如果错误级别大于或等于`number`” - 它不是基于相等性。我以前被那个咬过:)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-05-20T09:46:06.267

Raymond Chen 有一篇很好的博文，名为[ERRORLEVEL is not %ERRORLEVEL%](http://blogs.msdn.com/oldnewthing/archive/2008/09/26/8965755.aspx)。值得一试。

另外值得注意的是，大多数人认为是注释的 REM 命令实际上并非如此。REM 命令是一个**总是成功**的 nop 命令。在 REM 之后，错误级别始终为 0。所以

```
willalwaysfail.bat
REM unless you insert a comment after it
if errorlevel 1 goto fail 
```

永远不会失败...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-26T10:21:36.430

主要回答**bulgar**的问题，但补充其他答案：

要使 %ERRORLEVEL% 工作，您需要在 Windows 中激活*命令扩展*（这是默认设置）。
对于一个会话：

```
cmd /E:on 
```

或永久在注册表中

```
 HKEY_LOCAL_MACHINE\Software\Microsoft\Command Processor\EnableExtensions = 0x01 
```

更多细节：

```
cmd /? 
```

[]]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T09:45:29.950

大多数常用的外部命令操作返回**ERRORLEVEL** 0，这通常（但并非总是）表明没有遇到错误：

```
c:\> dir
...
c:\> echo %ERRORLEVEL% 
```

# mysql - 您将如何优化以下查询

> ID：887072
> 
> 赞同：0
> 
> 时间：2009-05-20T09:39:09.713
> 
> 标签：mysql, optimization

我正在使用以下查询来查找我的 Drupal 站点中查看的前 6 个页面：

```
SELECT n.title, n.nid, c.daycount 
FROM node n 
JOIN node_counter c ON n.nid=c.nid 
WHERE n.type='page' AND n.status = 1 
ORDER BY c.daycount DESC
LIMIT 0,6; 
```

这是非常自然的，并且在大多数网站上运行良好。然而，在一个有很多节点（1.7m）的站点上，它的运行速度很慢，而且几乎没有缓存，因为随着用户在系统中添加/编辑节点，节点表会不断变化。

在重站点上运行解释会产生以下输出：

```
+----+-------------+-------+--------+-----------------------------------------------+------------------+---------+------------------+-------+----------------------------------------------+
| id | select_type | table | type   | possible_keys                                 | key              | key_len | ref              | rows  | Extra                                        |
+----+-------------+-------+--------+-----------------------------------------------+------------------+---------+------------------+-------+----------------------------------------------+
|  1 | SIMPLE      | n     | ref    | PRIMARY,node_type,status,node_status_type,nid | node_status_type | 102     | const,const      | 71878 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | c     | eq_ref | PRIMARY                                       | PRIMARY          | 4       | kidstvprd2.n.nid |     1 | Using where                                  |
+----+-------------+-------+--------+-----------------------------------------------+------------------+---------+------------------+-------+----------------------------------------------+ 
```

请注意“使用位置；使用临时；使用文件排序”。

我想到的一个解决方案是离线运行这个查询（也许在 cron 中），并将结果保存在另一个表中供任何人读取，直到下一次 cron 运行更新它。但是，在恢复为 cron 之前，我想尝试优化此查询。

有人知道如何优化它吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T09:45:30.137

问题是它从 n 表而不是 c 开始。你想要的是它在 c.daycount 上使用一个索引（为了避免排序），然后将它加入到 n。如有必要，使用 straight_join 强制排序。

另见[http://dev.mysql.com/doc/refman/5.1/en/join.html](http://dev.mysql.com/doc/refman/5.1/en/join.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T09:46:03.240

在 SQLServer 中，我会确保有以下索引

```
CREATE INDEX IX_NODE_NID_TYPE_STATUS_TITLE   
  ON dbo.Node (Nid, Type, Status) INCLUDE (Title)

CREATE INDEX IX_NODE_COUNTER_NID_DAYCOUNT 
  ON dbo.Node_Counter (Nid, DayCount) 
```

# coldfusion - ColdFusion 8调度程序不重新安排任务

> ID：887078
> 
> 赞同：3
> 
> 时间：2009-05-20T09:40:37.650
> 
> 标签：coldfusion, scheduled-tasks, coldfusion-8

我刚刚在 Windows 2000 机器上完成了 CF8 的全新安装。我有一个计划任务，我需要在这台机器上每 15 分钟运行一次，而这台机器几乎不做其他事情。

该任务是通过 CF 管理员正常设置的，但由于某种原因，当任务需要大约 5 分钟才能运行时，它会正常完成（我可以从调试输出和 cfstat 看到这一点），但调度程序不会重新安排任务。

调度日志显示任务开始执行，但没有重新调度的条目。例如：

```
[ProcessRecords] Executing at Wed May 20 10:30:00 BST 2009 
```

我已经超过了我的服务器超时。我在 CF 管理员中没有超时，并且这个特定的脚本有一个`<cfsetting requesttimeout="43200" />`标签集。控制台日志记录中没有例外。最后一点控制台日志记录是我的 .cfm 模板中的最后一个调试语句。

我确实注意到在较短的时间内运行的任务，例如在一分钟内，将正常重新安排。

有没有人遇到过这样的问题？

我很困惑。任何和所有的答复表示赞赏！

干杯，夏兰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T13:39:26.903

not for nothing, but i've never seen anything like this with cf8\. are you sure that you have the latest hotfix and jvm installed? this might have been something in cf8 that was fixed in 8.01.

[hotfix 2 for cf8.01](http://kb2.adobe.com/cps/403/kb403781.html)

[list of all hotfixes and updates for cf8.01](http://kb2.adobe.com/cps/402/kb402604.html#CF801)

[hotfix 3 for cf8](http://kb2.adobe.com/cps/403/kb403070.html)

[list of all hotfixes and updates for cf8](http://kb2.adobe.com/cps/402/kb402604.html#CF8)

[latest jvm](http://java.sun.com/javase/downloads/index.jsp)

[upgrade instruction for jvm](https://stackoverflow.com/questions/798491/upgrading-the-jre-used-by-coldfusion/798852#798852)

If you suspect that it's an uncaught exception causing the issue, then might I suggest logging portions of the process. Case in point, I had a similar problem with a scheduled task where it would just bottom out for no reason (never had the reschedule problem though). What I ended up doing to diagnose the problem was use cflog to write out portions of the process as they completed. This particular task too about 4 minutes to complete but ran through about 200 portions (it was a mass emailer for a bunch of clients).

I logged the when the portion started and completed along with how log it took. By doing so, i could see what portion would trip up the whole process and knew where to focus my attention.

# iphone - 如何更改 sectionIndexTitlesForTableView 字母的颜色？

> ID：887079
> 
> 赞同：0
> 
> 时间：2009-05-20T09:40:56.497
> 
> 标签：iphone

希望你们都很好，心情也很好。

我有一个小问题，请帮助我得到它的解决方案。

我的问题是：

我在我的应用程序中使用垂直搜索，使用 tableview 的方法 sectionIndexTitlesForTableView() 我在右侧从上到下列出所有字符。

但是这些字母有固定的颜色。我需要改变这种颜色。由于我是新手，我不知道如何处理它。

请帮助获得解决方案。

谢谢，如果你发现我的英语有误，我很抱歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T13:16:29.727

没有支持的方法来执行此操作。即使您可以访问索引视图（您不容易），也无法访问，因为 iPhone 上没有 NSAttributedString，因此您无法返回颜色信息。

实现这一点的最佳方法是关闭 tableview 的索引并从头开始生成您自己的索引，将其浮动在 tableview 的顶部。但我不会向新的 iPhone 开发者推荐这种方法。最好花一些时间认真学习按照 Apple 的意图构建 UI。一旦您了解了 Apple 的 UI 及其实施方式，您就可以就是否应该违反 UI 规则做出明智的决定。

# .net - 我应该总是使用 TryGetValue 来访问 .net 字典吗？

> ID：887097
> 
> 赞同：9
> 
> 时间：2009-05-20T09:46:12.740
> 
> 标签：.net, exception

在[另一个 SO question 中，](https://stackoverflow.com/questions/886814/why-doesnt-net-provide-us-with-the-key-when-it-raises-a-keynotfound-exception)我看到有几个人建议我始终使用 TryGetValue。

虽然我总是使用 TryGetValue 而不是 Contains?/Access 模式，但当我希望密钥始终在字典中时，我会故意避免这种模式。然后，我进行直接索引器访问，以便在不存在密钥时引发异常，因为确实发生了意外的事情（即密钥不在字典中，而我希望它出现在字典中）。

由于似乎对我的“最佳实践”达成了普遍共识（我提到的帖子中有四分之三的人明确建议始终使用 TryGetValue），我渴望阅读关于该主题的扩展讨论。 .

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-20T09:52:06.240

不，你是完全正确的国际海事组织。

这样做没有意义：

```
if (dict.TryGetValue(key, out value))
{
    // whatever
}
else
{
    throw new SomeException("key '" + key + "' wasn't in dictionary");
} 
```

唯一的好处是：

```
value = dict[key]; 
```

是你得到一个更明确的异常消息......但以可读性为代价，IMO。

这就像强制转换与使用`as`- 当状态“错误”时，例外是正确的结果，因此请使用提供该行为的形式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T09:53:47.857

如果预计缺少密钥，则使用`TryGetValue`通常会产生更清洁和更有效的代码。如果预计密钥会存在，那么直接索引访问通常会更好 - 异常表明存在错误。

`ContainsKey`通常仅在不需要相应值时使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T09:51:41.887

如果缺少密钥是异常的，那么可以提出异常，恕我直言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T09:52:26.347

如果您的字典中不存在该键是异常行为（听起来就是这样），那么如果找不到该键并让该异常沿堆栈传播，则可以引发异常。如果您想使用防御性编程实践，您可以在访问字典键之前使用以下内容：

```
Debug.Assert(Dictionary.ContainsKey(Key)); 
```

只有在您预计密钥可能不存在的情况下，或者如果您希望在密钥不存在的情况下运行某些代码时，您才真正需要使用 TryGetValue。

# asp.net - 以与它们可见的相同顺序访问网格列

> ID：887099
> 
> 赞同：2
> 
> 时间：2009-05-20T09:46:51.943
> 
> 标签：asp.net, ultrawingrid

我需要以与它们在网格中显示的顺序相同的顺序访问基础设施超网格的列。如果我可以按照与网格上可见的相同顺序获取列的索引，我可以解决我的问题。提前致谢。

拉利特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-23T21:43:05.930

```
UltraGridColumn column = this.ultraGrid1.DisplayLayout.Bands[0].Columns[0];

Debug.WriteLine( "Columns in visible order: ");

       // Get the first visible column by passing in VisibleRelation.First.
       column = column.GetRelatedVisibleColumn( VisibleRelation.First );

       while ( null != column )
       {
           Debug.WriteLine( "   " + column.Key );

           // Get the next visible column by passing in VisibleRelation.Next.
           column = column.GetRelatedVisibleColumn( VisibleRelation.Next );
       } 
```

[http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/Infragistics2.Win.UltraWinGrid.v8.2~Infragistics.Win.UltraWinGrid.UltraGridColumn~GetRelatedVisibleColumn.html](http://help.infragistics.com/Help/NetAdvantage/NET/2008.2/CLR2.0/html/Infragistics2.Win.UltraWinGrid.v8.2~Infragistics.Win.UltraWinGrid.UltraGridColumn~GetRelatedVisibleColumn.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T16:33:29.800

我想您可以尝试处理订单更改时触发的事件并跟踪所有更改，但这似乎是在要求潜入微妙的错误。

我考虑遍历所有列并尝试使用一些属性来告诉我它们的当前位置（可能是 TabOrder？）并使用它来编译列的无序列表。我想您可能必须使用 Column.GetRelatedVisibleColumn() 方法遍历每个列。

我还没有真正实施它，因为我还有其他更高优先级的问题，但这可能是我最终要走的路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-11T07:47:11.450

这是一个老问题，但我最近遇到了同样的问题并以这种方式解决了它：

```
var selectedCells = this.Selected.Cells;

List<int> columns = new List<int>();

foreach (var cell in selectedCells)
        {
            if (!columns.Contains(cell.Column.Index))
                columns.Add(cell.Column.Index);
        }

columns.Sort((x, y) => this.DisplayLayout.Rows.Band.Columns[x].Header.VisiblePosition.CompareTo(this.DisplayLayout.Rows.Band.Columns[y].Header.VisiblePosition)); 
```

然后，您可以使用`columns`来访问列，以便它们显示。

# php - 服务器端会话安全吗？

> ID：887100
> 
> 赞同：2
> 
> 时间：2009-05-20T09:47:16.967
> 
> 标签：php, security, session

我在编写的应用程序中使用（服务器端，而不是 cookie）会话，如果用户没有获得对服务器的访问权限，我可以信任 $_SESSION 变量还是应该在每个页面加载时验证它的内容？

**注意：**
我正在尝试限制对我的数据库的查询数量，目前我正在验证每个页面加载时的数据，并且我认为我可能可以消除查询，但我希望 100% 确定。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T09:54:02.927

是的，您可以将其安全地存储在会话中。您应该确保 Validation 方法是安全的。（存储在会话中之前使用的方法）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T10:34:36.450

您只需要确保会话存储在安全的地方。默认情况下，会话存储在 Linux 上的 /tmp/ 之类的地方。如果用户可以访问您的服务器，他们可以编辑会话变量。

您应该考虑将会话保存到数据库，和/或向会话添加哈希计算（md5+秘密种子）验证，并始终检查会话变量是否未针对该哈希进行修改。

# asp.net-mvc - HtmlHelper 扩展方法与部分视图？

> ID：887105
> 
> 赞同：21
> 
> 时间：2009-05-20T09:48:27.243
> 
> 标签：asp.net-mvc, html-helper, asp.net-mvc-partialview

我很好奇什么时候推荐使用 HtmlHelper 扩展方法，什么时候使用局部视图？在许多情况下，他们似乎同样有资格。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-20T18:36:28.210

HtmlHelpers - 少量 HTML（自定义链接、按钮、输入等）

PartialViews - 更复杂的东西（表单、页眉、页脚、列表项等）

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-20T13:21:51.340

我个人认为partial view和asp.net中的usercontrol差不多，都是作为一组可复用的功能元素。例如，如果您需要制作一个可能会出现在整个网站上的登录控制框，那么局部视图会更好。更重要的是，它实际上是自包含的，具有自己的渲染/处理策略（并且可能也有自己的状态）

另一方面，htmlhelper 只是用于节省编码时间和维护的工具，以某种方式提高代码的可读性。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-27T13:22:18.187

为 HTML 助手（只是方法）编写测试比部分视图容易得多。如果我正在编写具有逻辑的东西，例如基于 viewdata 内容的不同输出，那么我会使用一个助手来测试它。如果我正在创建一段没有任何实际逻辑的可重用内容，那么我可能会使用局部视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T14:30:52.433

只是补充一点：如果现有的 htmlhelper 无法完成这项工作，您将使用 htmlhelper 来呈现用户控件中的元素......所以让我们把它作为一个规则：

在使用 htmlhelper 而不是 usercontrol（部分视图）的场景中是不好的方法，而当您使用 htmlhelper 作为渲染页面/用户控件的原子元素的助手时是好的方法

# regex - 正则表达式是编程必须的吗？

> ID：887107
> 
> 赞同：40
> 
> 时间：2009-05-20T09:48:34.903
> 
> 标签：regex, string-matching

正则表达式是编程必须的吗？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-20T09:55:36.137

一个人可以很容易地没有它们，但一个人应该（恕我直言）知道基础知识，原因有两个。
1) 可能有一天，RegEx 是手头问题的最佳解决方案（见下图）
2) 当你在别人的代码中看到 RegEx 时，它不应该是 100% 神秘的。

```
preg_match('/summarycount">.*?([,\d]+)<\/div>.*?Reputation/s', $page, $rep); 
```

这段代码很简单，但如果你不知道 RegEx，那么第一个参数中的内容也可能是火星语言。一旦你学习了基础知识，这里使用的 RegEx 实际上非常简单，为了让你更深入地[访问 http://www.regular-expressions.info/](http://www.regular-expressions.info/)他们有很多关于 RegEx 的信息及其对不同的各种暗示平台/语言，他们也有一个很好的入门教程。之后查看[RegexBuddy](http://www.regexbuddy.com/)，它可以帮助您构建 RegEx，当您构建它们时，如果您观察它的作用，那么它可以帮助您精益求精，这是迄今为止我花过的最好的 39.95 美元。

[![](https://imgs.xkcd.com/comics/regular_expressions.png "等等，忘记逃生了。 呜呜[taptaptap]eeeeee。")](http://xkcd.com/208/)
[原创漫画](http://xkcd.com/208/)

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-20T09:51:56.347

是的。你可以不用它们来管理，但你真的应该至少学习一些基础知识，因为大多数计算任务都可以使用它们。从长远来看，您将省去很多痛苦和麻烦。一旦你克服了最初的“wtf”阶段，正则表达式比你想象的要容易得多。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2009-05-20T09:50:20.360

我会说不，它们不是必须的。你可以在不了解他们的情况下成为一个非常优秀的程序员。

我发现我将正则表达式主要用于一次性的数据操作任务，而不是实际放入应用程序代码。它们可以很方便地验证输入数据，但是现在您的控件通常会为您执行此操作。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-05-20T09:53:46.110

一点也不。你可以用正则表达式做的任何事情，完全可以不用它们来做。

然而，它是一个强大的模式匹配系统，所以如果没有它，使用简单的正则表达式模式很容易完成的一些事情需要大量的代码来完成。

例如，这个：

```
s = Regex.Replace(s, "[bcdfghjklmnpqrstvwxz]", "$1o$1"); 
```

没有正则表达式需要更多代码：

```
StringBuilder b = new StringBuilder();
foreach (char c in s) {
   if ("bcdfghjklmnpqrstvwxz".IndexOf(c) != -1) {
      b.Append(c).Append('o').Append(c);
   } else {
      b.Append(c);
   }
}
s = b.ToString(); 
```

或者，如果您不是经验丰富的程序员，您可以轻松创建更多代码并且性能非常糟糕的东西：

```
string temp = "";
for (int i = 0; i < s.Length; i++ ) {
   if (
      s[i] == 'b' || s[i] == 'c' || s[i] == 'd' ||
      s[i] == 'f' || s[i] == 'g' || s[i] == 'h' ||
      s[i] == 'j' || s[i] == 'k' || s[i] == 'l' ||
      s[i] == 'm' || s[i] == 'n' || s[i] == 'p' ||
      s[i] == 'q' || s[i] == 'r' || s[i] == 's' ||
      s[i] == 't' || s[i] == 'v' || s[i] == 'w' ||
      s[i] == 'x' || s[i] == 'z'
   ) {
      temp += s.Substring(i, 1);
      temp += "o";
      temp += s.Substring(i, 1);
   } else {
      temp += s.Substring(i, 1);
   }
}
s = temp; 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-20T11:23:17.693

这么说吧，如果你的工具包里有正则表达式，你会为自己节省很多时间和精力。如果你没有它们，你将不知道你错过了什么，所以你仍然会很开心。

作为一名 Web 开发人员，我经常使用它们（输入验证、从站点提取数据等）。

编辑：我意识到通过查看stackoverflow上的**[正则表达式标签](https://stackoverflow.com/tags/regex)**，它可能会帮助您了解一些使用正则表达式的常见问题。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-21T20:04:10.007

我会说是的。

它们是如此普遍有用，以至于完全没有能力至少读写简单的东西是一个相当大的障碍。

# 支持正则表达式的语言

*   爪哇
*   perl
*   Python
*   PHP 。
*   C＃
*   Visual Basic.NET
*   ASP
*   电源外壳
*   javascript
*   红宝石
*   tcl
*   脚本
*   VB6
*   XQuery
*   XPath
*   XSD
*   MySQL
*   甲骨文
*   PostgreSQL

# 支持正则表达式的 IDE 和编辑器

*   蚀
*   智能
*   网豆
*   凝胶
*   视觉工作室
*   超编辑
*   编辑
*   编辑
*   记事本++
*   编辑板临
*   六
*   emacs
*   HAP编辑
*   平板电脑

让我们不要忘记`grep`和`sed`！

作为雇主，你更愿意拥有一个优秀的程序员——偶尔——必须在数千个源文件中手动查找/替换一组相似的字符串，并且需要数小时或数天才能完成，或者是一个优秀的程序员那——偶尔——花五分钟，甚至十分钟来制作一个正则表达式来完成与他们去喝咖啡所花费的时间相同的事情？

# 这个答案中的真实世界实际用法

事实上，我在撰写这篇文章时实际上使用了一个正则表达式。我最初以逗号分隔的散文列出了支持它的语言。然后我重新考虑它并通过搜索表达式`(\w+),`并将其替换为`\n* $1`JEdit 将格式更改为项目符号列表。而且您使用它们获得的经验越多，使用它们对于越来越短的操作集将变得越来越具有成本效益。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-20T09:51:35.350

不。你可以编程多年而不接触正则表达式。当然，这意味着对于某些了解 RE:s 的人会使用它们的情况，您会做其他事情。解决特定问题总是有不止一种方法，而正则表达式只是表达模式的一种方法（一种非常有效的，因此可能是流行的方法）。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-05-20T11:13:16.403

如果您关心发展作为软件工程师的职业，那么是的。我聘请了软件工程师，如果他们不了解使用正则表达式的基础知识，或者从未听说过它们，那么我想知道他们在整个编程技术范围内实际上有多少经验。他们还有什么不知道的？

上面的大多数评论都说“不，你可以用其他方式解决问题”，他们也大多说替代方案是更多的代码并且需要更长的时间来编写......现在想想可维护性以及这个定制代码是多么容易改变。 .. 使用正则表达式 - 那么它只是一行代码。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-20T09:53:44.143

至少知道正则表达式的存在以及它们可以用于什么是绝对必须的。否则，在许多情况下，您将面临重新发明轮子的危险。如果您知道它们的存在，您可以在必须应用它们时进入详细信息。顺便说一句，正则表达式背后的理论非常有趣:-)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-05-25T19:13:29.117

Jeffrey Friedl 写了一本很棒的书，叫做[Mastering Regular Expressions](http://regex.info/)。它给了我洞察力，读起来真的很开心。

尽管我不经常使用正则表达式，但它们最近派上了用场：

*   **输入**：一些 CSV 字典文件，具有某种松散的格式、多种翻译、谚语等。

*   **输出**：漂亮的 JSON。

*   *第一个想法*：写一个简短的语法来解析所有可能的字段和值。

*   *第一次尝试*：写了一个语法，但有一些粗糙的边缘，主要是特殊情况，仅出现在 0-1% 的数据中。制作一个涵盖所有内容的语法将是过多的设计。

*   *第二次尝试*：我使用了一个简单的语法来捕获主要字段，然后将其余部分传递给一个例程，该例程应用了一些正则表达式。它速度快，概念上比完整的语法更容易，而且写起来也很有趣。

*   **摘要**：正则表达式为我节省了几个小时，实际上帮助我了解了数据中的特殊情况以及它们出现的方式和位置。

**它们值得学习吗？**是的。

**必须的？**不，但我知道该领域几乎没有人不熟悉它们。

**难学？**一点也不。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-20T09:51:43.523

一句话，不。

但是它们当然可以成为正确工作的正确工具，并且对于那些最有效的字符串匹配操作值得学习。然而，仅仅因为你有一把好大的锤子，并不意味着你应该用它来敲碎每一个坚果。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-20T09:54:36.263

其实，我的感觉是，这是必须的.​​..

例如，我正在查看为什么我们的 YouTube 视频的一部分不起作用……结果发现这些视频的链接是

[http://ca.youtube.com/v/raINk2Ii1A4](http://ca.youtube.com/v/raINk2Ii1A4) （不是实际的 URL，仅作为示例）

代替

[http://www.youtube.com/v/raINk2Ii1A4](http://www.youtube.com/v/raINk2Ii1A4)

另一个程序员早些时候使用“substr()”来提取 youtube 视频 ID，并且由于 ca.youtube.com 部分，ID 被提取错误。

所以在我看来，正则表达式非常重要，没有它，隐藏的错误可能会比平时更频繁地被引入。

但其实我之前遇到过3个开发者，一个是非常优秀的Web应用开发者，一个是[硅谷](http://en.wikipedia.org/wiki/Silicon_Valley)名牌大学[的理学硕士](http://en.wikipedia.org/wiki/Master's_degree)，一个是高知名度的硕士研究生，结果他们都没有。”不知道正则表达式。这让我有点吃惊。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-20T09:54:37.340

不，我自己的正则表达式很糟糕，但我仍然是一个糟糕的程序员。等待。什么？

更严肃的一点是：我*不*知道正则表达式，但几乎不需要它们。如果我真的需要一个，例如当我需要验证 Dave 提到的用户输入时，我会问一位同事。

作为程序员，有*很多*值得了解/学习的东西，但我敢说正则表达式远非该列表的顶部。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-05-20T09:53:24.177

嗯，在计算机科学理论领域它是非常强大和有用的“设备”，因为有了它你可以定义常规语言并用它来识别 NFA 甚至 DFA，因此在计算理论或有限自动化和形式语言领域证明一些困难的定理. 在实际编程中它也非常有用，因为使用它您能够以相对简单的方式执行复杂的字符串操作。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-05-20T09:53:58.857

可能不是。但是它们**真的很容易学习**。至少可以快速教授基础知识（所有正则表达式引擎所做的事情）。我在大约 30 分钟内从另一个人的聊天窗口中学到了它......

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-05-20T10:26:46.810

我想这不是必须的，但它们会减轻您的生活并为您节省很多时间。

如果你不知道如何使用正则表达式，你就不知道你错过了什么。但是仅仅看着一个人使用它们来完成一项任务，就会让你觉得这是你绝对应该拥有的技能。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-20T14:10:33.643

如果不使用，正则表达式至少对学习很重要。

首先，你必须能够阅读和理解别人的正则表达式代码。

其次，基本的正则表达式对应于有限自动机（根据 Kleene 定理），这使得它们对于算法设计至关重要。

其实女生有**备忘单裙**

[http://store.xkcd.com/xkcd/#RegexCheatSkirt](http://store.xkcd.com/xkcd/#RegexCheatSkirt)

如果你碰巧是个女孩，这可能是一个绝佳的学习机会。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-05-20T14:51:02.983

不……是的，

这很像其中一个“我应该学习 C”的问题。没有正则表达式不一定是做某事的唯一方法。但它们通常是一种有用的抽象，可以简化代码并且（我真的认为）甚至可以使其更具可读性。也许是因为我喜欢 [Jeff Friedl 的 Mastering Regular Expressions](https://rads.stackoverflow.com/amzn/click/com/1565922573)或者是因为我确实在 perl 中工作。但无论出于何种原因，正则表达式都是我的首选工具。现在对我来说，使用正则表达式似乎比使用大多数其他字符串操作技术更容易。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-05-20T20:37:46.950

至少在最低级别了解正则表达式是/可以做什么是非常重要的。如果您了解 NFA 背后的概念，那么您将更好地理解其他问题。

至于开始擅长正则表达式，我会说没有必要但非常有价值。事实上，每个正则表达式引擎都是不同的，所以即使你已经掌握了一个，你也可能无法在其他地方快速做到。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-05-29T03:36:57.613

不，对于合适的要求，您总是有另外两种选择。

1.  问一个知道正则表达式的朋友。

2.  在 SO 上发布问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-05-20T09:52:42.790

根据您的领域，某些问题适合正则表达式 - 或者相反：使用正则表达式的解决方案 /not/ 非常笨拙。想到电子邮件验证/网址验证/最低密码强度/日期解析。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-05-20T09:53:30.540

一定不是。尽管有人认为一个好的程序员应该知道这一点，但我不会这么说。当时机成熟并且您需要它时，您只需使用它。无论如何，给它六个月不使用它，您将不会记得任何表达选项。

就像编程中的所有事实一样，你学习它，你忘记它，你又重新学习它。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-05-20T09:54:09.277

不。

根据您要实现的目标，Regex 可能很有用。但我敢说 80% 或更多的程序员从不使用 Regex，大约 15% 只是偶尔使用（并且必须用 Google 搜索），而其余的只有一小部分实际上吃过 Regex Ninjas。

我发现[Regexr](http://www.gskinner.com/RegExr/)非常适合我使用 Regex 的罕见场合。

此外，有人会在接下来的一分钟左右提到 jwz 的某句话……

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-05-20T10:26:46.870

正则表达式是一种强大的模式匹配语言。它不仅限于文本字符串。但一如既往，你的代码，你的电话。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-05-20T10:39:07.173

简单地说，没有。这完全取决于您的计划要实现的目标。

当然，了解 RegExp 是什么以及对它们如何工作的基本了解在未来会很有用。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-05-20T11:37:36.667

我同意其他人的观点，这可能不是必须的，但至少有一个基本的了解是非常有帮助的。我在我的多维数据集中张贴了一张 RegEx 备忘单，我觉得它很有帮助。[http://regexlib.com/CheatSheet.aspx](http://regexlib.com/CheatSheet.aspx)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-05-20T12:01:04.030

理解正则表达式不是必须的。但是，它是处理文本的有效工具。如果您从事处理文本的项目，您最终会遇到它们。

正则表达式带来了各种挑战，无论您是使用它们还是只是支持具有它们的代码。请注意，有多种语法风格。不同的库和语言通常有略微不同的语法规则。正则表达式，随着它们变得越来越复杂，可以很容易地从一个简单的模式匹配工具转变为一种魔法，只写不容易理解的代码。而且，与大多数文本处理工具一样，它们通常难以排除故障或更改（例如，您有一个不再适合该工具功能的极端案例）。

与所有解析代码一样，我建议进行大量单元测试。特别要注意边缘条件、重复的文本模式和异常输入。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-05-20T12:02:27.147

绝对不是，我（和许多人一样）多年来一直在编程而没有接触过它们。也就是说，一旦你了解了它们，你就会开始看到它们在过去可能有用的地方:-)

我想说 - 只需阅读基础知识，这样您就知道 RegEx 是什么以及您可以使用它们做什么，然后如果您发现它们可能有用，您可以获取一个教程/参考网站，例如[http://www.regular -expressions.info/](http://www.regular-expressions.info/)并直接进入。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-05-20T12:14:46.217

如果您正在开发一种新产品，我建议您避免使用它们，或者最多谨慎而明智地使用它们。

如果您正在维护一个已经使用正则表达式的产品，那么您别无选择。

它有助于至少能够识别正则表达式，因此如果您遇到一段特别模糊的代码，您知道正确的搜索词来查找参考卡。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-05-20T12:34:01.763

比如说，了解 HTML 或能够使用关系数据库。严格来说，不，它们不是编程的必要条件——它们在某些工作中可能是必不可少的和基本的，但在其他工作中却无关紧要。在为新的以太网芯片编写设备驱动程序时，您不太可能使用正则表达式（或 HTML 或 SQL）。在我所在的领域，我偶尔会在生产代码中使用正则表达式，更常见的是在临时脚本中按摩报告等。我参与过一个项目，其中它们是一个核心功能（一个分析自由格式文本以查找的应用程序）某些关键短语来生成编译的规则集）。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-05-25T19:20:36.873

如果您进行大量字符串操作、搜索和替换等操作，则需要它们。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-12-22T18:12:47.763

我认为这取决于你要做什么。它们是 mod_rewrite 的必需品。但在大多数情况下，我同意你可以在没有它们的情况下四处走动。但是它们可以为您节省大量时间来完成一些原本会花费大量繁琐时间的任务。

# java - db2 参照完整性问题

> ID：887110
> 
> 赞同：1
> 
> 时间：2009-05-20T09:49:42.420
> 
> 标签：java, spring, db2, referential-integrity, jt400

情况非常严重，我们在 AS400 上的 DB2 中有一个表，它定义了另一个表的外键，所以我们正在输入具有引用表的常规 ID 的记录，所以当我们通过前端工具输入 SQL 插入时一切正常。

当通过使用 Spring Framework（仅 SQL 处理程序、Web 服务...）的 java 应用程序完成此插入时会出现问题，因此使用 jt400.jar 中的 jdbc 驱动程序完成 PreparedStatement。我们收到消息“参照完整性检查失败”，正如我们检查的那样，这是不可能的。

有没有人有类似的经历？我们应该升级 JTOPEN 库吗？现在有实际的 6.5 版本，我们在生产中使用 6.3，并且担心将其升级到 6.5 会产生负面影响。

忘了提一下，重启 Tomcat（应用服务器）没有效果，但如果我重启 linux box（ubuntu 8.10）一切正常。与 DB 的连接由 JNDI 管理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T10:18:19.040

也许你在一个事务中，你要放入的数据不一致，然后执行回滚，所以你不应该看到任何错误。

# php - 我的网站的客户面板

> ID：887136
> 
> 赞同：0
> 
> 时间：2009-05-20T09:55:32.533
> 
> 标签：php

作为一名自由开发者，我与客户打交道主要是通过电子邮件/即时通讯联系他们。这还不错，但我正在考虑为我的网站使用更专业的客户沟通面板方法。客户基本上将获得登录名/密码并访问它以查看预览并对其进行评论。

我自己编写应用程序很好，但是由于很多开发人员在他们的网站上都有类似的东西，也许已经有一些我可以重复使用的解决方案？

**//编辑**

好吧，我可能应该更清楚地解释自己。我很好地展示了网站，因为它们正在正确构建/编码。这只是沟通和设计阶段，我想从邮件/即时通讯转移到一些简单的网络应用程序。

理论上项目管理工具可以，但它们过于复杂，我只需要简单的功能来评论（理想情况下在线程中）和附加图像。以后可能会想要更多，但这就是我现在能想到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T10:57:31.443

它可能已经“过于复杂”，但您可以查看 Request Tracker：[http ://bestpractical.com/rt/](http://bestpractical.com/rt/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T10:15:43.757

“访问它以查看预览”对不同的人意味着截然不同的事情——你可能只想做一些事情，比如拥有一个受密码保护的预览区域——如果你正在制作网站，它可以在[http://preview.example 上运行。以com](http://preview.example.com)为例。

第二部分可能有各种系统，Wiki 可能会工作，或者 FogBugz 或 Trac。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-23T16:17:51.050

我发现[collabtive](http://collabtive.o-dyn.de/)是一款出色的一体化软件。
得到了我真正需要的一切。

# windows - 为什么 Windows 'Run:' 与 CMD 行不同？

> ID：887138
> 
> 赞同：0
> 
> 时间：2009-05-20T09:55:55.187
> 
> 标签：windows, shell

当我在 Windows Run: 提示符下键入' [http://www.google.com](http://www.google.com)时，它会启动我的默认浏览器。

但是当我在 CMD 或 Commnad 提示符下执行此操作时，它不会。我假设发出了某种形式的 RunDLL 命令，但我不知道是什么。

有没有人有任何见解？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T10:07:23.493

我认为这相当于使用 START。

如果你试试

```
START http://www.google.com 
```

从命令行（或批处理文件），它应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T10:27:54.637

乔恩所说的似乎是正确的。我用 mailto:someone@somewhere.com 对其进行了测试。有趣的是，如果您想让 run 像 cmd 的默认行为一样工作，您可以执行以下操作：

开始 -> 运行 -> cmd /c [http://www.google.com](http://www.google.com)。不知道为什么有人需要这样做！

# reflection - C# CF2.0 - System.Activator 和内部类

> ID：887140
> 
> 赞同：0
> 
> 时间：2009-05-20T10:07:05.833
> 
> 标签：reflection, compact-framework, c#-2.0, internal, activator

我有一个包含实体集合的数据提供者。我只希望能够通过数据提供者创建一个新实体。

即，要创建我需要使用的新记录：

```
Entity entity = Provider.AddNew();
enity.set_Properties... etc 
```

我的问题是，如果我将实体设置为内部，System.Activator 无法创建它们的实例。我的每个数据提供者都使用一个基类，该类具有传递的实体的通用类型。

所以目前我的 AddNew() 方法包含以下内容：

```
public T AddNew()
{
  T added = Activator.CreateInstance<T>();
  this.Collection.Add(added);
  return added;
} 
```

如果我可以在数据提供者命名空间之外手动实例化一个新实体，这显然不是世界末日，但考虑到无法保存它们似乎毫无意义，那么为什么要选择这样做呢？

**编辑：忘了提到我所有的提供者、实体等都在同一个命名空间中。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T13:21:02.790

不要使用依赖于公共构造函数的 Activator。而是使用反射找到无参数构造函数，然后调用它。这些方面的东西：

```
Type t = typeof(MyType);
var parameterlessCtor = (from c in t.GetConstructors(
  BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Instance)
    where c.GetParameters().Length == 0
    select c).FirstOrDefault;
if(parameterlessCtor != null) instance = parameterlessCtor.Invoke(null); 
```

# .net-3.5 - 将项目.net 2.0 转换为 3.5，扩展方法在哪里？

> ID：887147
> 
> 赞同：0
> 
> 时间：2009-05-20T10:10:06.733
> 
> 标签：.net-3.5, .net-2.0, project

我最近将一个应用程序从 .net 2.0 转换为 3.5，但我没有看到任何扩展方法......我做错了什么？或者除了在项目设置中将目标框架从 2.0 更改为 3.5 之外，我还应该做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T10:12:40.330

扩展方法基于导入的命名空间出现尝试添加

```
using System.Linq; 
```

到文件的顶部。正如 Jon 所说，您还需要添加对 System.Core.dll 程序集的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T10:20:44.980

您不仅需要按照 SillyMonkey 的建议添加 using 指令，而且如果要使用 LINQ `System.Linq`，还需要对程序集进行引用。`System.Core`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T10:12:30.160

扩展方法，是 .net 3.5 的特性。扩展方法是你需要创建的东西！！！

[什么是扩展方法？](https://stackoverflow.com/questions/403539/what-are-extension-methods)

参考这个链接

# java - 如何确定字符串是否包含无效的编码字符

> ID：887148
> 
> 赞同：34
> 
> 时间：2009-05-20T10:11:34.030
> 
> 标签：java, string, unicode, encoding

**使用场景**

我们已经实现了一个 Web 服务，我们的 Web 前端开发人员在内部使用（通过 php api）来显示产品数据。在网站上，用户输入一些东西（即查询字符串）。在内部，网站通过 api 调用服务。

**注意：我们使用restlet，而不是tomcat**

**原始问题**

Firefox 3.0.10 似乎尊重浏览器中选择的编码，并根据选择的编码对 url 进行编码。这确实会导致 ISO-8859-1 和 UTF-8 的查询字符串不同。

我们的网站转发来自用户的输入并且不转换它（它应该），因此它可以通过使用包含德语变音符号的查询字符串调用 web 服务的 api 来调用服务。

即查询部分看起来像

```
 ...v=abcädef 
```

如果选择“ISO-8859-1”，发送的查询部分看起来像

```
...v=abc%E4def 
```

但如果选择“UTF-8”，则发送的查询部分看起来像

```
...v=abc%C3%A4def 
```

**所需的解决方案**

当我们控制服务时，因为我们已经实现了它，所以我们想在**服务器端**检查调用是否包含非 utf-8 字符，如果是，则以 4xx http 状态响应

**当前解决方案的详细信息**

检查每个字符（ == string.substring(i,i+1) ）

1.  如果 character.getBytes()[0] 为 '?' 等于 63
2.  如果 Character.getType(character.charAt(0)) 返回 OTHER_SYMBOL

**代码**

```
protected List< String > getNonUnicodeCharacters( String s ) {
  final List< String > result = new ArrayList< String >();
  for ( int i = 0 , n = s.length() ; i < n ; i++ ) {
    final String character = s.substring( i , i + 1 );
    final boolean isOtherSymbol = 
      ( int ) Character.OTHER_SYMBOL
       == Character.getType( character.charAt( 0 ) );
    final boolean isNonUnicode = isOtherSymbol 
      && character.getBytes()[ 0 ] == ( byte ) 63;
    if ( isNonUnicode )
      result.add( character );
  }
  return result;
} 
```

**问题**

这会捕获所有无效（非 utf 编码）字符吗？你们有没有更好（更简单）的解决方案？

**注意：**我使用以下代码检查了 URLDecoder

```
final String[] test = new String[]{
  "v=abc%E4def",
  "v=abc%C3%A4def"
};
for ( int i = 0 , n = test.length ; i < n ; i++ ) {
    System.out.println( java.net.URLDecoder.decode(test[i],"UTF-8") );
    System.out.println( java.net.URLDecoder.decode(test[i],"ISO-8859-1") );
} 
```

这打印：

```
v=abc?def
v=abcädef
v=abcädef
v=abcÃ¤def 
```

它不会**引发**IllegalArgumentException*叹息*

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-09-19T04:18:00.080

我问了同样的问题，

[在 Tomcat 上处理 URI 中的字符编码](https://stackoverflow.com/questions/1233076/handling-character-encoding-in-uri-on-tomcat)

我最近找到了一个解决方案，它对我来说效果很好。你可能想试一试。这是你需要做的，

1.  将您的 URI 编码保留为 Latin-1。在 Tomcat 上，将 URIEncoding="ISO-8859-1" 添加到 server.xml 中的连接器。
2.  如果您必须手动进行 URL 解码，也可以使用 Latin1 作为字符集。
3.  使用 fixEncoding() 函数来修复编码。

例如，要从查询字符串中获取参数，

```
 String name = fixEncoding(request.getParameter("name")); 
```

你可以一直这样做。具有正确编码的字符串不会更改。

附上代码。祝你好运！

```
 public static String fixEncoding(String latin1) {
  try {
   byte[] bytes = latin1.getBytes("ISO-8859-1");
   if (!validUTF8(bytes))
    return latin1;   
   return new String(bytes, "UTF-8");  
  } catch (UnsupportedEncodingException e) {
   // Impossible, throw unchecked
   throw new IllegalStateException("No Latin1 or UTF-8: " + e.getMessage());
  }

 }

 public static boolean validUTF8(byte[] input) {
  int i = 0;
  // Check for BOM
  if (input.length >= 3 && (input[0] & 0xFF) == 0xEF
    && (input[1] & 0xFF) == 0xBB & (input[2] & 0xFF) == 0xBF) {
   i = 3;
  }

  int end;
  for (int j = input.length; i < j; ++i) {
   int octet = input[i];
   if ((octet & 0x80) == 0) {
    continue; // ASCII
   }

   // Check for UTF-8 leading byte
   if ((octet & 0xE0) == 0xC0) {
    end = i + 1;
   } else if ((octet & 0xF0) == 0xE0) {
    end = i + 2;
   } else if ((octet & 0xF8) == 0xF0) {
    end = i + 3;
   } else {
    // Java only supports BMP so 3 is max
    return false;
   }

   while (i < end) {
    i++;
    octet = input[i];
    if ((octet & 0xC0) != 0x80) {
     // Not a valid trailing byte
     return false;
    }
   }
  }
  return true;
 } 
```

编辑：由于各种原因，您的方法不起作用。当出现编码错误时，你不能指望你从 Tomcat 得到什么。有时你会得到 � 或 ?。其他时候，你什么也得不到，getParameter() 返回 null。假设您可以检查“？”，您的查询字符串包含有效的“？”会发生什么？?

此外，您不应该拒绝任何请求。这不是您的用户的错。正如我在最初的问题中提到的，浏览器可以将 URL 编码为 UTF-8 或 Latin-1。用户没有控制权。你需要接受两者。将您的 servlet 更改为 Latin-1 将保留所有字符，即使它们是错误的，以便我们有机会修复它或将其丢弃。

我在这里发布的解决方案并不完美，但它是我们迄今为止找到的最好的解决方案。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-09-24T11:51:15.047

如果发现无效字符，您可以使用配置为抛出异常的 CharsetDecoder：

```
 CharsetDecoder UTF8Decoder =
      Charset.forName("UTF8").newDecoder().onMalformedInput(CodingErrorAction.REPORT); 
```

请参阅[CodingErrorAction.REPORT](http://java.sun.com/j2se/1.5.0/docs/api/java/nio/charset/CodingErrorAction.html#REPORT)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-01-22T07:21:15.257

这是我用来检查编码的：

```
CharsetDecoder ebcdicDecoder = Charset.forName("IBM1047").newDecoder();
ebcdicDecoder.onMalformedInput(CodingErrorAction.REPORT);
ebcdicDecoder.onUnmappableCharacter(CodingErrorAction.REPORT);

CharBuffer out = CharBuffer.wrap(new char[3200]);
CoderResult result = ebcdicDecoder.decode(ByteBuffer.wrap(bytes), out, true);
if (result.isError() || result.isOverflow() ||
    result.isUnderflow() || result.isMalformed() ||
    result.isUnmappable())
{
    System.out.println("Cannot decode EBCDIC");
}
else
{
    CoderResult result = ebcdicDecoder.flush(out);
    if (result.isOverflow())
       System.out.println("Cannot decode EBCDIC");
    if (result.isUnderflow())
        System.out.println("Ebcdic decoded succefully ");
} 
```

编辑：更新了 Vouze 建议

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-05T09:21:36.917

将所有控制字符替换为空字符串

```
value = value.replaceAll("\\p{Cntrl}", ""); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-20T10:18:38.090

[URLDecoder](http://java.sun.com/j2se/1.4.2/docs/api/java/net/URLDecoder.html)将解码为给定的编码。这应该适当地标记错误。但是文档指出：

> 该解码器有两种可能的方式来处理非法字符串。它可以单独留下非法字符，也可以抛出 IllegalArgumentException。解码器采用哪种方法留给实现。

所以你应该尝试一下。另请注意（来自 decode() 方法文档）：

> [万维网联盟建议](http://www.w3.org/TR/html40/appendix/notes.html#non-ascii-chars)规定应使用 UTF-8 。不这样做可能会引入不兼容性

所以还有别的事情要考虑！

编辑：Apache Commons [URLDecode](http://commons.apache.org/sandbox/messenger/apidocs/org/apache/commons/messagelet/impl/RequestUtil.html#URLDecode%28byte[],%20java.lang.String%29)声称会为错误的编码抛出适当的异常。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-09-23T17:51:50.773

我一直在研究类似的“猜测编码”问题。最好的解决方案是*了解*编码。除此之外，您可以做出有根据的猜测来区分 UTF-8 和 ISO-8859-1。

要回答如何检测字符串是否正确编码为 UTF-8 的一般问题，您可以验证以下内容：

1.  没有字节是 0x00、0xC0、0xC1 或在 0xF5-0xFF 范围内。
2.  尾字节 (0x80-0xBF) 之前总是有一个头字节 0xC2-0xF4 或另一个尾字节。
3.  头字节应该正确地预测尾字节的数量（例如，0xC2-0xDF 中的任何字节都应该紧跟在 0x80-0xBF 范围内的一个字节）。

如果一个字符串通过了所有这些测试，那么它可以被解释为有效的 UTF-8。这并不能保证它*是*UTF-8，但它是一个很好的预测器。

ISO-8859-1 中的合法输入可能没有除行分隔符之外的控制字符（0x00-0x1F 和 0x80-0x9F）。看起来 0x7F 也没有在 ISO-8859-1 中定义。

（我基于 UTF-8 和 ISO-8859-1 的维基百科页面。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-25T16:03:52.823

您可能希望在请求中包含一个已知参数，例如“...&encTest=ä€”，以安全地区分不同的编码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-09-18T20:56:36.523

您需要从一开始就设置字符编码。尝试发送正确的*Content-Type*标头，例如*Content-Type: text/html; charset=utf-8*修复正确的编码。标准一致性[将 utf-8 和 utf-16 称为](http://www.ws-i.org/Profiles/BasicProfile-1.0-2004-04-16.html#refinement16457984)Web 服务的正确编码。检查您的响应标头。

此外，在服务器端——在浏览器没有正确处理服务器发送的编码的情况下——通过分配一个新的字符串来强制编码。您还可以通过执行单个*each_byte & 0x80*检查编码的 utf-8 字符串中的每个字节，验证结果为非零。

```
 boolean utfEncoded = true;
byte[] strBytes = queryString.getBytes();
for (int i = 0; i < strBytes.length(); i++) {
    if ((strBytes[i] & 0x80) != 0) {
        continue;
    } else {
        /* treat the string as non utf encoded */
        utfEncoded = false;
        break;
    }
}

String realQueryString = utfEncoded ?
    queryString : new String(queryString.getBytes(), "iso-8859-1"); 
```

另外，[看看这篇文章](http://java.sun.com/developer/technicalArticles/Intl/HTTPCharset/)，希望对你有帮助。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-09-23T17:58:22.250

您可能会感兴趣以下正则表达式：

[http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/185624](http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/185624)

我在红宝石中使用它如下：

```
module Encoding
    UTF8RGX = /\A(
        [\x09\x0A\x0D\x20-\x7E]            # ASCII
      | [\xC2-\xDF][\x80-\xBF]             # non-overlong 2-byte
      |  \xE0[\xA0-\xBF][\x80-\xBF]        # excluding overlongs
      | [\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}  # straight 3-byte
      |  \xED[\x80-\x9F][\x80-\xBF]        # excluding surrogates
      |  \xF0[\x90-\xBF][\x80-\xBF]{2}     # planes 1-3
      | [\xF1-\xF3][\x80-\xBF]{3}          # planes 4-15
      |  \xF4[\x80-\x8F][\x80-\xBF]{2}     # plane 16
    )*\z/x unless defined? UTF8RGX

    def self.utf8_file?(fileName)
      count = 0
      File.open("#{fileName}").each do |l|
        count += 1
        unless utf8_string?(l)
          puts count.to_s + ": " + l
        end
      end
      return true
    end

    def self.utf8_string?(a_string)
      UTF8RGX === a_string
    end

end 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-24T16:55:29.420

尝试在您可以触摸的任何地方始终使用 UTF-8 作为默认值。（数据库、内存和 UI）

单一字符集编码可以减少很多问题，实际上它可以加快您的 Web 服务器性能。编码/解码浪费了太多的处理能力和内存。

# asp.net - RSA 数据解密错误。要解密的数据超过了此模数 64 字节的最大值

> ID：887157
> 
> 赞同：0
> 
> 时间：2009-05-20T10:15:13.930
> 
> 标签：asp.net

在使用 rsa 提供程序加密和描述字符串时，我收到了这个错误。

RSA 数据解密错误。要解密的数据超过了此模数 64 字节的最大值。

谁能知道如何解决这个错误？

```
    内部密封类 RSAProvider
    {
        #region 密钥存储类

        [可序列化]
            私有结构 rsaKey
        {
            公共 rsaKey(RSAParameters rsaKeyInfo)
            {
                D = rsaKeyInfo.D;
                DP = rsaKeyInfo.DP;
                DQ = rsaKeyInfo.DQ;
                指数 = rsaKeyInfo.Exponent;
                InverseQ = rsaKeyInfo.InverseQ;
                模数 = rsaKeyInfo.Modulus;
                P = rsaKeyInfo.P;
                Q = rsaKeyInfo.Q;
            }

            公共 RSAParameters CreateRSAKey()
            {
                RSAParameters rsaKeyInfo = new RSAParameters();

                rsaKeyInfo.D = D;
                rsaKeyInfo.DP = DP；
                rsaKeyInfo.DQ = DQ;
                rsaKeyInfo.Exponent = 指数；
                rsaKeyInfo.InverseQ = InverseQ;
                rsaKeyInfo.Modulus = 模数；
                rsaKeyInfo.P = P;
                rsaKeyInfo.Q = Q;

                返回 rsaKeyInfo;
            }

            公共字节[] D;
            公共字节[] DP；
            公共字节[] DQ；
            公共字节[] 指数；
            公共字节[] InverseQ;
            公共字节[]模数；
            公共字节[] P;
            公共字节[] Q;
        }

        #endregion

        私有静态 RSAParameters rsaKeyParameters；

        静态 RSAProvider()
        {
            字符串 rsaKeyString = System.Configuration.ConfigurationSettings.AppSettings["RSAKey"];
            如果（rsaKeyString ！= null）
            {
                rsaKeyParameters = GetKeyByString(rsaKeyString);
            }
        }

        私有 RSAProvider()
        {
        }

        私有静态 RSAParameters RSAKeyInfo
        {
            得到
            {
                返回 rsaKeyParameters;
            }
        }

        私有静态布尔 DoOAEPPadding
        {
            得到
            {
                返回假；
            }
        }

        公共静态字符串 GenerateKey(int keySize)
        {
            //创建一个新的RSACryptoServiceProvider实例来生成
            //公钥和私钥数据。
            RSACryptoServiceProvider RSA = new RSACryptoServiceProvider(keySize);

            RSAParameters rsaKeyInfo = RSA.ExportParameters(true);

            返回 GetKeyString(rsaKeyInfo);
        }

        #region 加密

        公共静态字节 [] 加密（字节 [] 数据加密，字符串 rsaKeyString）
        {
            RSAParameters rsaKeyInfo = GetKeyByString(rsaKeyString);

            返回加密（dataToEncrypt，rsaKeyInfo）；
        }

        公共静态字节 [] 加密（字节 [] 数据加密，RSAParameters rsaKeyInfo）
        {
            尝试
            {   
                //创建一个新的 RSACryptoServiceProvider 实例。
               // Common.Identity.ImpersonateValidUser("prana", "eetplpvt", "Avdhoota1985");
                RSACryptoServiceProvider RSA = new RSACryptoServiceProvider();

                //导入RSA Key信息。这只需要
                //包含公钥信息。
                RSA.ImportParameters(rsaKeyInfo);

                //加密传递的字节数组并指定OAEP填充。  
                //OAEP 填充仅适用于 Microsoft Windows XP 或
                //之后。  
                //return RSA.Encrypt(dataToEncrypt, DoOAEPPadding);
                字节[] 数据 = RSA.Encrypt(dataToEncrypt, DoOAEPPadding);
                RSA.清除（）；
                //Common.Identity.UndoImpersonation();
                返回数据；
            }
                //捕获并显示 CryptographicException  
                //到控制台。
            捕获（加密异常 e）
            {
                // Divya Bhalodia 于 2008 年 6 月 27 日更新本地化任务
                //throw new Exception("数据加密错误。", e);
                Common.EnumLocalization.EnumLocalization loc = new Common.EnumLocalization.EnumLocalization(ASP.BL.ApplicationUsers.ApplicationUserController.CurrentUserCulture.Code, ASP.BL.Applications.ApplicationController.CurrentApplicationInfo.ItemId);
                throw new Exception(loc.LocalizeString("RSA 数据加密错误。") + e.Message, e);
                // 结束更新 - Divya
            }
        }

        公共静态字节[]加密（字节[]数据加密）
        {
            返回加密（dataToEncrypt，RSAKeyInfo）；
        }

        #endregion

        #region 解密

        公共静态字节 [] 解密（字节 [] dataToDecrypt，字符串 rsaKeyString，布尔 doOAEPPadding）
        {
            RSAParameters rsaKeyInfo = GetKeyByString(rsaKeyString);
            返回解密（dataToDecrypt，rsaKeyInfo，doOAEPPadding）；
        }

        公共静态字节[]解密（字节[] dataToDecrypt，RSAParameters rsaKeyInfo，bool doOAEPPadding）
        {
            尝试
            {
                //创建一个新的 RSACryptoServiceProvider 实例。
                Common.Identity.ImpersonateValidUser();
                RSACryptoServiceProvider RSA = new RSACryptoServiceProvider();

                //导入RSA Key信息。这需要
                //包含私钥信息。
                RSA.ImportParameters(rsaKeyInfo);

                //解密传入的字节数组并指定OAEP填充。  
                //OAEP 填充仅适用于 Microsoft Windows XP 或
                //之后。  
                //return RSA.Decrypt(dataToDecrypt, doOAEPPadding);
                字节[] 数据 = RSA.Decrypt(dataToDecrypt, doOAEPPadding);
                RSA.清除（）；
                Common.Identity.UndoImpersonation();
                返回数据；
            }
                //捕获并显示 CryptographicException  
                //到控制台。
            捕获（加密异常 e）
            {

                // Divya Bhalodia 于 2008 年 6 月 27 日更新本地化任务
                //throw new Exception("数据解密错误。", e);
                Common.EnumLocalization.EnumLocalization loc = new Common.EnumLocalization.EnumLocalization(ASP.BL.ApplicationUsers.ApplicationUserController.CurrentUserCulture.Code, ASP.BL.Applications.ApplicationController.CurrentApplicationInfo.ItemId);
                throw new Exception(loc.LocalizeString("RSA 数据解密错误。") + e.Message, e);
                // 结束更新 - Divya
            }
        }

        公共静态字节[]解密（字节[]数据解密）
        {
            返回解密（dataToDecrypt，RSAKeyInfo，DoOAEPPadding）；
        }
        #endregion

        #region 附加功能

        私有静态字符串 GetKeyString(RSAParameters rsaKeyInfo)
        {
            字节[] tmp;
            rsaKey k = 新 rsaKey(rsaKeyInfo);
            BinaryFormatter 格式化程序 = new BinaryFormatter();

            使用（内存流流 = 新的内存流（））
            {
                格式化程序。序列化（流，k）；
                tmp = stream.ToArray();
            }

            代码（tmp）；

            返回 Convert.ToBase64String(tmp);
        }

        私有静态 RSAParameters GetKeyByString(string rsaKeyString)
        {
            rsaKey k;

            byte[] tmp = Convert.FromBase64String(rsaKeyString);
            代码（tmp）；

            BinaryFormatter 格式化程序 = new BinaryFormatter();

            使用（MemoryStream 流 = 新 MemoryStream（tmp））
            {
                k = (rsaKey)formater.Deserialize(stream);
            }
            返回 k.CreateRSAKey();
        }

        私有静态无效代码（字节[] tmp）
        {
            字节掩码1 = 0x55；
            字节掩码3 = 0xB9；
            字节掩码4 = 0xCF；

            for(int i = 0; 我

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T16:28:09.013

我遇到过类似的问题，但你可以做两件事来帮助自己克服它们。

1.  您需要确保您正在加密的 hte 数据比您正在使用的密钥短。因此，如果您的密钥是 1024 位，那么请确保您只使用 1000 位。为此，您需要将字节数组分成更小的块，加密每个块，然后将加密的值存储在数组或字符串中。因此，不是加密 1 个字符串，而是加密 5 个字符串。

将此信息存储为字符串时，请确保所有数字的长度相同，因此如果格式化程序返回 15，则将字符串存储为 015，以便稍后除以 3 以获取字节，然后将其放入数组中。

要解密您的数据，您只需读取字符串的长度并确定要解密的块数。将这些一一解密，然后您可以使用已破坏的字节数组重新创建对象。

如果您想要实际代码，请亲自与我联系，我将能够通过一些可以为您执行此操作的脚本更好地帮助您。

# dom - 是否可以使用 iframe_id 获取 iframe 文档？

> ID：887160
> 
> 赞同：2
> 
> 时间：2009-05-20T10:16:09.280
> 
> 标签：dom, iframe

AFAIK，我可以通过 window.frames['frame_name'] 来实现这个目标

但是如果我只知道frame_id，是否也可以获取内容？

你可以在这里试试：

[http://maishudi.com/rte-light-read-only/index.html](http://maishudi.com/rte-light-read-only/index.html)

顺便说一句，是否可以通过 iframe_id 获取位置属性？

我很久以前试过但失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T10:27:07.713

我认为应该这样做。它适用于（最新的）firefox、safari、camino 和opera (mac)。
你仍然应该做一些测试（尤其是在 IE 中）

```
var iframeObj = document.getElementById("theIframeId");
var documentObj = iframeObj.contentWindow || iframeObj.contentDocument;
var location = documentObj.location.href; // I think this only works if
                                          // the content of the iframe comes 
                                          // from the same domain. 
```

# c++ - 将外部应用程序与我的应用程序集成

> ID：887163
> 
> 赞同：3
> 
> 时间：2009-05-20T10:16:54.380
> 
> 标签：c++, architecture, plugins, integration, external

我有 2 个希望与外部应用程序集成的桌面应用程序。其中一个应用程序使用我开发的插件进行了扩展，以提供并非所有发行版都通用的特定功能。这种情况可以用下图来描述：

[替代文字 http://img32.imageshack.us/img32/8902/integration1.png](http://img32.imageshack.us/img32/8902/integration1.png)

正如我所提到的，我想将我的应用程序与外部应用程序或 SDK 集成（接收和发送数据）。通常有两种来自外部应用程序的数据：

1.  一般/通用数据 - 始终相关
2.  特定数据 - 对于每个外部应用程序应以不同方式处理

使用“核心应用程序”，可以在此图中描述所需的情况：

[替代文字 http://img32.imageshack.us/img32/3299/integration2.png](http://img32.imageshack.us/img32/3299/integration2.png)

通用数据在核心应用程序中处理，特定数据在插件（支持插件）中处理。

此应用程序的分发可能是其中之一

*   核心应用 + Yakko App + Yakko App Integrator + Yakko App Support Plugin
*   核心应用+点应用+点应用集成商

对于另一个应用程序，我想保持相同的“集成器”，但在应用程序内部以不同方式处理它们：

[替代文字 http://img32.imageshack.us/img32/2088/integration3x.png](http://img32.imageshack.us/img32/2088/integration3x.png)

正如我刚才所描述的，您如何建议在我的应用程序中实现对集成外部应用程序和 SDKS 的支持？

笔记：

*   我在 Windows 上使用 C++，插件作为 DLL 分发。
*   将使用的数据类型总是提前知道的，我只需要一些通用的方法将它从源移动到处理程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T11:06:44.543

我同意评论者的观点，COM 似乎是一个不错的策略。您的支持 dll 在安装时被注册，然后您的核心应用程序可以查找插件，例如：

```
hr = CLSIDFromProgID(L"Wakko.1.0", &clsid);  
hr = GetActiveObject(clsid, NULL, &punk); 
```

或者
`hr = CoCreateInstance(clsid, ...,..., IID_IWAKKO, ...);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T18:24:23.267

看看windows[这里有的IPC选项](http://msdn.microsoft.com/en-us/library/aa365574(VS.85).aspx)

对我来说，COM 在这里也是一个不错的选择。

另一种方法是让您的核心应用程序运行一个服务器，该服务器侦听来自您的插件的调用。您可以通过使用名称管道来实现这一点。现在，您的支持应用程序将使用这些插件与您的核心应用程序进行通信（通过命名管道）。

# java - 如何选择适当的 java 数据结构来建模 1-n 关系映射？

> ID：887167
> 
> 赞同：3
> 
> 时间：2009-05-20T10:18:11.787
> 
> 标签：java, algorithm, data-structures, oop, concurrency

**设想**

我会尽可能简洁。基本上参考这个[classdiag](http://www.flickr.com/photos/37403003@N08/3548515830/)，我有一个管理**SocketManager**列表（管理一个 Socket 连接）的外观。每个**SocketManager使用唯一的***SocketUserId*登录到远程服务器。此外，每个**SocketManager**将接受来自客户端的消息，这些消息发往特定的**Receipients**列表。为了讨论起见，将这些**接收者**简单地视为由名称标识的远程数据桶。

客户端将发送如下数据：

```
SocketFacade facade = ...;

byte[] data = ...

facade.sendData( receipient, data ); 
```

当*SocketFacade*启动时，它将查询一个 mysql 表，该表返回*SocketUserId*和*Receipients*之间的 1-m 关系。我将使用[MultiValuedMap](https://jsr311.dev.java.net/nonav/releases/1.0/javax/ws/rs/core/MultivaluedMap.html)来表示这个 1 米的关系。然后将通过遍历地图来启动多个**SocketManager 。**

```
(1) Map< SocketUserId, List<Receipient> > 
```

例如，假设我们有 2 个**SocketManager**和*SocketUserId 分别*是 "alice" 和 "tom"

```
 +----SocketManager1 ( "alice" ) for Receipients { "B", "C" }
            |
 SocketFacade 
            |
            +----SocketManager2 ( "tom" ) for Receipients { "A", "D" } 
```

**问题**

我对如何实现*sendData*方法感到困惑。基本上我需要一种从接收者（例如“B”）映射到其负责的**SocketManager**（例如*SocketManager1*）的方法。

假设我这样做

```
(2) Map< SocketUserId, SocketManager >
(3) Map< Receipient, SocketUserId > 
```

*   对于 (2) 中的值，我需要 SoftReference 吗？
*   我应该直接从**Receipient**映射到**SocketManager**吗？
*   **SocketFacade**还支持将改变由 (1) 表示的关系的方法。如果我写入数据库，（1）、（2）和（3）中的内存数据结构将需要同步更改。**SocketFacade**也必须是线程安全的。最初的想法是拥有某种发布订阅系统，其中对数据库的添加/删除将导致更改通过回调传播。

    ```
    interface Callback
    {
        void receipientAdded( Receipient r );
        void receipientDeleted( Receipient r );
    } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T10:27:44.390

`SocketManager`在 each 中保留对 的引用`Receipient`。这样，您可以避免使用地图（需要更多 RAM，速度较慢且不会增加任何价值）。

在 中`SocketManager`，保留`Receipient`'s 的列表。在添加和删除`Receipient`'s 时，更新指向 .s 的指针`SocketManager`。

在 中`SocketFacade`，您需要一个接受`SocketUserId`并返回 的地图`SocketManager`。该地图是通过查询地图中的 ID 来填充的。在所有经理都存在后，将收件人添加到每个经理。这需要两个 SQL 查询。

这很容易使用任何 ORM 工具进行映射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T10:39:23.023

既然 SocketUserId 和 SocketManager 之间是 1-1 的关系，你不能只在 SocketMananger 中添加对 SocketUserId 的引用，并在 Recipient 中添加对 SocketManager 的引用吗？

然后你会在你的外观中有一个包含接收者的地图和 SocketManager 的列表。在该`sendData`函数中，您将从地图中获取接收者，并从该接收者获取对其 SocketManager 的引用。

问候

纪尧姆

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T03:29:44.507

在抽象层面上，您有： 1`Thing`与 n `OtherThing`s 相关。您可以通过创建一个特殊的关系对象来对此进行建模，该对象引用`Thing`并包含`java.util.List<OtherThing>`对 n`OtherThing`的引用。这使您的域对象（事物）与关系信息无关。但是，如果看起来正确，`java.util.List`直接将其添加到类`Thing`（或子类）中会更简单。`java.util.ArrayList<OtherThing>`仅当您需要建立关系时，可以将 List 变量留空并用 a 填充。

# asp.net - 为 FileUpload 控件维护 ViewState

> ID：887170
> 
> 赞同：1
> 
> 时间：2009-05-20T10:18:59.570
> 
> 标签：asp.net, file-upload, webforms, viewstate

我[`FileUpload`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.fileupload.aspx)在运行时创建控件。当我单击一个`LinkButton`新`FileUpload` 控件时，会生成一个。

现在假设我从`FileUpload`控件中选择了一个文件，然后单击`LinkButton`. 先前的`FileUpload`控制失去了它的路径。但是，我使用以下行来维护我在运行时创建的每个控件的 ViewState：

```
f1.enableviewstate = true; 
```

如何维护`FileUpload`控件的选定文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T11:06:14.107

**脚步**

1.  用户选择一个文件
2.  用户单击 LinkBut​​ton（发出回发，添加额外的文件上传控制）
3.  服务器端应该在回发时获取文件并将其存储在某个地方（任何地方）
4.  首先`<input type=file>`用标签和复选标记图标替换（告诉用户文件已经上传（或者甚至是带有禁用*浏览*按钮的只读文本框来伪造文件上传控件 - 但是您将无法显示正确的文件里面的路径）
5.  用户会看到一个新表单，该表单在显示已上传的文件时具有新的空文件上传控件。

出于安全原因，您不能`<input type=file>`以任何方式操纵形状或形式。

**破解方法**
如果我理解正确，您的链接按钮会向您的页面添加额外的文件上传控件。相反，我会在第一次创建足够数量的上传控件并仅显示一个。其他的会被 CSS 隐藏。然而，在用户单击 LinkBut​​ton 后，它将只有客户端 Javascript 功能，可以显示额外的控制。又一个……又一个……又一个……直到达到最大值。

**复杂的方法**
但是，您可以通过使用更多的 Javascript 以不同的方式实现它，并使其更接近 Web 2.0。但是，您应该通过以下方式上传这些文件`<iframe>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T11:11:16.780

正如其他一些人提到的，由于安全问题，您无法保留 FileUpload 的视图状态。您可以做的只是在 FileUpload 下方添加一个标签。当用户单击链接按钮以生成新的 FileUpload 时，将触发回发，您可以在其中检查页面上存在的 FileUpload 控件是否具有某些值（即用户已经选择了要上传的文件），如果是的话，您可以直接开始上传该文件并在标签上显示结果（路径或文件名），只是用户知道他已经添加了该文件。您还可以隐藏文件上传并另外添加删除链接以再次删除上传的文件（与 Gmail 类似的方法）。

希望这有帮助。

朱里

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T10:35:16.323

您无法在文件上传输入标签中预先选择文件路径（安全相关 - 用户*必须*选择文件），因此 .Net 无法从视图状态填充值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T10:34:48.850

1.  考虑一下你是否真的需要在运行时处理它？
2.  如果你真的需要在运行时；不要忘记将它添加到最近的容器的`Controls`属性中。这样做可以确保它的状态被序列化为`ViewState`.

希望这可以帮助...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-23T05:20:07.517

据我所知，没有办法在 asps.net 中保留文件上传的视图状态。

您可以将其值存储在隐藏字段、会话等文件中您无法将该值分配给再次文件上传，因为它是只读的

# mysql - 具有时间戳结构的 MySQL 查询索引

> ID：887173
> 
> 赞同：0
> 
> 时间：2009-05-20T10:21:48.410
> 
> 标签：mysql, indexing

我想知道在 MySQL 中存储与时间戳相关的用户查询的最佳方式是什么。假设我只有两个输入，一个用户的“查询”和“时间戳”......

我可以创建一个带有字段 ( `id`, `query`, `count`, `timestamp_list`) 的 MySQL 表，其中：

`id`是查询的唯一标识符，
`query`是文字查询字符串，
`count`是输入查询的（不断更新的）次数，
`timestamp_list`是 LONGTEXT 或带有搜索查询次数列表的东西。

有没有更好的方法来使用我不熟悉的索引来关联这些？在 LONGTEXT 中存储时间戳列表似乎很愚蠢，但很容易；也许我应该创建一个单独的表，例如：

`id`
`query_id` （与`id`第一个表相关）
`timestamp`

我可以将结果与第一个表连接起来。有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T10:29:50.873

如果您需要在执行每个查询时记录时间戳，我建议您有 2 个表：

```
 tbl_queries
  - id       INT
  - query    VARCHAR

 tbl_queries_performed
  - id         INT AUTOINCREMENT
  - query_id   INT
  - timestamp  CURRENT_TIMESTAMP 
```

每次要记录查询时，检查它是否`tbl_queries`已经存在，然后`tbl_queries_performed`分别使用 query_id保存条目

# perl - 如何让每个人都可以从任何地方执行 Perl 脚本？

> ID：887175
> 
> 赞同：4
> 
> 时间：2009-05-20T10:23:17.550
> 
> 标签：perl, executable

我写了一个非常简单的 perl 脚本，现在我想让它在任何地方都可以执行。

我知道我可以把它放到 /bin/ 中，从 'mytest.pl' -> 'mytest' 和 chmod +x 重命名它，但这是标准做法吗？我注意到 /bin/ 中没有任何东西是 perl 脚本。

另外，我希望它能够登录到 /var/logs/mytest/*

是否有任何我应该注意的安全问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T10:28:35.743

最好将用户制作的脚本放在 /usr/local/bin 中，但是否值得担心这是您的决定。至于登录到 /var/logs/mytest/*，您可以尝试使用可以写入目录的用户来使脚本[suid](http://en.wikipedia.org/wiki/Setuid)（有时出于安全考虑，这是不允许的），或者只是使 /var/logs/mytest世界可写。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T20:15:30.233

与其担心日志文件权限问题，何不登录系统记录器呢？这就是它的用途。请参阅[Sys::Syslog](http://perldoc.perl.org/Sys/Syslog.html)

# wpf - INotifyPropertyChanged 和 DependencyProperty 有什么关系？

> ID：887177
> 
> 赞同：6
> 
> 时间：2009-05-20T10:24:08.047
> 
> 标签：wpf, mvvm, dependency-properties, inotifypropertychanged

我正在使用 DependencyProperties 构建一个**简单的 UserControl 示例**，以便可以在 XAML 中更改控件的属性（下面的代码）。

但当然，在我的应用程序中，我不希望此控件具有紧密耦合的代码隐藏，而是用户控件将是一个名为“DataTypeWholeNumberView”的视图，并且它将拥有自己的名为“DataTypeWholeNumberViewModel”的 ViewModel。

因此，我将在 ViewModel 中实现下面的 DependencyProperty 逻辑，但在 ViewModels 中，我通常继承 INotifyPropertyChanged，这似乎给了我相同的功能。

**那么两者之间的关系是什么：**

1.  将 UserControl XAML 的 DataContext 绑定到其**背后**具有 DependencyProperties的代码
2.  将 UserControl XAML（视图）的 DataContext 绑定到其**ViewModel**（继承自 INotifyPropertyChanged）并具有实现 INotifyPropertyChanged 功能的属性？

**XAML：**

```
<UserControl x:Class="TestDependencyProperty827.SmartForm.DataTypeWholeNumber"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <StackPanel>
        <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top" Orientation="Horizontal">
            <TextBlock Text="{Binding Label}"/>
        </StackPanel>
    </StackPanel>
</UserControl> 
```

**代码背后：**

```
using System.Windows;
using System.Windows.Controls;

namespace TestDependencyProperty827.SmartForm
{
    public partial class DataTypeWholeNumber : UserControl
    {
        public DataTypeWholeNumber()
        {
            InitializeComponent();
            DataContext = this;
        }

        public string Label
        {
            get
            {
                return (string)GetValue(LabelProperty);
            }
            set
            {
                SetValue(LabelProperty, value);
            }
        }

        public static readonly DependencyProperty LabelProperty =
            DependencyProperty.Register("Label", typeof(string), typeof(DataTypeWholeNumber),
            new FrameworkPropertyMetadata());
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-20T13:28:39.547

INotifyPropertyChanged 是自 2.0 以来存在于 .Net 中的接口。它基本上允许对象在属性更改时发出通知。引发此事件时，相关方可以执行某些操作。它的问题是它只发布属性的名称。因此，您最终使用反射或一些不确定的 if 语句来确定在处理程序中要做什么。

DependencyProperties 是一个更精细的构造，它支持默认值、以更节省内存和性能的方式更改通知。

唯一的关系是 WPF 绑定模型支持使用 INotifyPropertyChanged 实现绑定到 DependencyProperties 或标准 Clr 属性。您的 ViewModel 也可以是 DependecyObject，第三个选项是绑定到 ViewModel 的 DependencyProperties！

Kent Boogaart 写了一篇关于让 ViewModel 成为 POCO 与 DependencyObject的[非常有趣的文章。](http://kentb.blogspot.com/2009/03/view-models-pocos-versus.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T13:22:54.770

我真的不认为 DependencyProperties 和 INotifyPropertyChanged 之间存在关系。这里唯一的魔力是 Binding 类/实用程序足够聪明，可以识别 DependencyProperty 并直接绑定到它，或者订阅绑定目标的 notify-property-changed 事件并等待触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-21T10:23:12.090

使用 WPF，您可以绑定到 DependencyProperties 或实现 INotifyPropertyChanged 的​​属性。这是一个选择问题。

因此，您的问题分为将它们放在代码后面或视图模型中。既然您提到您不希望后面有紧密耦合的代码，那么您最好拥有一个遵循 MVVM 模式的视图模型。

您甚至可以在您的视图模型中使用 DependencyProperties，就像您在后面的代码中所做的那样。

# asp.net - 从母版页类调用的内容页类方法

> ID：887178
> 
> 赞同：1
> 
> 时间：2009-05-20T10:25:09.543
> 
> 标签：asp.net, methods, master

我的内容页类中有一个公共方法，我想从母版页类中调用此方法
谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T10:35:09.130

您可以从基类继承您的页面。然后，您可以在您的基类中创建一个虚拟方法，该方法将在您的页面中被覆盖。然后，您可以像这样从母版页调用该虚拟方法 -

```
(cphPage.Page as PageBase).YourMethod(); 
```

这里，**`cphPage`**是**`ContentPlaceHolder`**您的母版页中的 ID。**`PageBase`**是包含该**`YourMethod`**方法的基类。

**`YourMethod`**编辑：当然，在使用页面实例调用方法之前，您必须进行空值检查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T10:53:07.707

如果您不想使用任何基本页面

将此添加到您的母版页，

```
private object callContentFunction(string methodName, params object[] parameters)
{
    Type contentType = this.Page.GetType();
    System.Reflection.MethodInfo mi = contentType.GetMethod(methodName);
    if(mi == null)return null;
    return mi.Invoke(this.Page, parameters);
} 
```

然后使用它

callContentFunction("myPublicMethodName", myParam1, myParam2...);

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T09:56:52.100

脚步：

1.  将新`<%@ MasterType VirtualPath="location of your masterpage" %>`指令添加到 .aspx 页面

2.  在 MasterPage 中声明一个公共函数。

3.  使用 . 从内容页面调用函数`Master.functionName()`。

# web-services - 您的组织如何设置测试数据？

> ID：887180
> 
> 赞同：1
> 
> 时间：2009-05-20T10:26:06.140
> 
> 标签：web-services, testing, test-data

我在一个将 Web 服务作为关键应用程序的组织中担任测试员。目前，我们通过 Web 前端加载大量测试数据，因为这是在现实世界中完成的方式。

这使数据具有一定程度的合法性，并防止数据格式出现错误。但是，以这种方式加载数据非常耗时，我经常想知道将数据直接加载到数据库是否会更有效率。

其他人是否有此决定，您选择了哪个选项？是否有另一种解决方案可以同时提供数据的速度和合法性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T11:00:15.213

这来自开发人员的角度而不是测试人员的角度，因此它可能适用也可能不适用。

我不能代表整个组织，但在我们的项目中，我们花了一些时间创建“类似真实世界”的数据，我们使用 SQL 脚本将这些数据加载到测试数据库中。该数据是来自生产环境的真实数据和为代表我们产品中的特定“问题情况”而定制的数据的组合。

这些脚本作为构建我们软件的一部分自动运行，并由单元测试框架驱动的自动化集成测试使用。这些测试将测试通过各种可用界面查找、创建、编辑和删除数据。

在这样的构建和测试运行期间，测试数据库被重置并多次重新加载数据。这样做是为了消除测试之间的依赖关系；一项测试不应依赖于另一项测试创建或修改的数据，并且因为某些测试的数据可能与其他测试的数据不同。但是，所有测试中的大多数都是基于相同的测试数据执行的。

设置这个测试数据（并维护它）一直（并且有时）有点令人头疼，但从长远来看，它在我们的案例中运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T11:47:54.837

在大多数相同的情况下，测试人员更喜欢使用脚本加载测试数据，因为无法使用 UI 部分加载数据[耗时]。对于测试人员关键点，每个测试应该只对单行数据或整个数据库数据执行. 因此，为了更好地测试，请遵循制作脚本来加载数据的方法。这里还有一个要点，制作脚本是一次为整个项目加载数据的时间投资。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T09:01:04.440

最后，我们决定从通过前端设置数据的系统迁移到数据插入系统。但请密切关注数据以确保它是真实世界。这运行良好，测试运行得更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T20:39:16.720

我对测试数据有同样的问题。在我们的组织中，有一个批处理作业使用类似生产的数据填充数据库。我与功能测试人员协调以获取我的负载运行程序脚本的测试数据。

# jsf - 如何使用 JSF 返回上一页

> ID：887183
> 
> 赞同：1
> 
> 时间：2009-05-20T10:26:26.467
> 
> 标签：jsf

我想实现一个超链接，指向相应的上一个页面，该页面应该提供与之前显示相同的数据（类似于“历史返回”按钮的效果）。

有没有最佳实践来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T08:48:43.730

这是 Seam 试图在标准 JSF 上改进的特性之一。[这是参考](http://docs.jboss.com/seam/2.1.2.CR2/reference/en-US/html/jbpm.html#d0e6713)的相关部分。

# java - Java Pdf 差异库

> ID：887186
> 
> 赞同：6
> 
> 时间：2009-05-20T10:27:04.407
> 
> 标签：java, pdf, diff

有人知道一个开源 Java 库可以对 pdf 文件的文本部分进行强大的差异化吗？

理想情况下，我想要以补丁的形式产生差异的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-20T11:25:03.353

[使用http://incubator.apache.org/pdfbox/](http://incubator.apache.org/pdfbox/)提取 pdf 文本并使用[http://code.google.com/p/google-diff-match-patch](http://code.google.com/p/google-diff-match-patch)创建一个差异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T06:49:44.570

如果 PDF 仅在文本上有所不同，您还可以将页面栅格化，然后以这种方式查看差异 - 我们将其用于 PDF 代码的回归测试输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-28T09:57:35.633

你可以看看 xdiffweb.com。它是一个基于 apache pdfbox 的纯 java 开源项目。

# c# - C# .NET 中的模糊日期时间选择器控件？

> ID：887189
> 
> 赞同：9
> 
> 时间：2009-05-20T10:27:23.890
> 
> 标签：c#, winforms, datetime, user-controls, fuzzy

我正在 C# 中为 winforms 应用程序实现模糊日期控件。模糊日期应该能够采用模糊值，例如

*   去年六月
*   2小时前
*   2个月前
*   上个星期
*   昨天
*   去年

之类的

是否有“模糊”日期时间选择器的示例实现？

任何实现这种控制的想法将不胜感激

**PS**：我知道[这里](https://stackoverflow.com/questions/822124/fuzzy-date-algorithm)和[这里](https://stackoverflow.com/questions/11/how-do-i-calculate-relative-time)所说的模糊日期算法，我真的在寻找开发这种控件的任何想法和灵感

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-21T18:27:22.417

解析非常简单。它可以实现为一堆正则表达式和一些日期计算。

下面的示例可以轻松扩展以满足您的需求。我已经对其进行了粗略的测试，它至少适用于以下字符串：

*   下个月，明年，
*   未来 4 个月，未来 3 天
*   3 天前，5 小时前
*   明天，昨天
*   去年，上个月，
*   上周二，下周五
*   去年六月，明年五月，
*   2008 年 1 月，2009 年 1 月 1 日，
*   2019 年 6 月，2009/01/01

助手类：

```
class FuzzyDateTime
{

    static List<string> dayList = new List<string>() { "sun", "mon", "tue", "wed", "thu", "fri", "sat" };
    static List<IDateTimePattern> parsers = new List<IDateTimePattern>()
    {
       new RegexDateTimePattern (
            @"next +([2-9]\d*) +months",
            delegate (Match m) {
                var val = int.Parse(m.Groups[1].Value); 
                return DateTime.Now.AddMonths(val);
            }
       ),
       new RegexDateTimePattern (
            @"next +month",
            delegate (Match m) { 
                return DateTime.Now.AddMonths(1);
            }
       ),           
       new RegexDateTimePattern (
            @"next +([2-9]\d*) +days",
            delegate (Match m) {
                var val = int.Parse(m.Groups[1].Value); 
                return DateTime.Now.AddDays(val);
            }
       ),

       new RegexDateTimePattern (
            @"([2-9]\d*) +months +ago",
            delegate (Match m) {
                var val = int.Parse(m.Groups[1].Value); 
                return DateTime.Now.AddMonths(-val);
            }
       ),
       new RegexDateTimePattern (
            @"([2-9]\d*) days +ago",
            delegate (Match m) {
                var val = int.Parse(m.Groups[1].Value); 
                return DateTime.Now.AddDays(-val);
            }
       ),
       new RegexDateTimePattern (
            @"([2-9]\d*) *h(ours)? +ago",
            delegate (Match m) {
                var val = int.Parse(m.Groups[1].Value); 
                return DateTime.Now.AddMonths(-val);
            }
       ),
       new RegexDateTimePattern (
            @"tomorrow",
            delegate (Match m) {
                return DateTime.Now.AddDays(1);
            }
       ),
       new RegexDateTimePattern (
            @"today",
            delegate (Match m) {
                return DateTime.Now;
            }
       ),
       new RegexDateTimePattern (
            @"yesterday",
            delegate (Match m) {
                return DateTime.Now.AddDays(-1);
            }
       ),
       new RegexDateTimePattern (
            @"(last|next) *(year|month)",
            delegate (Match m) {
                int direction = (m.Groups[1].Value == "last")? -1 :1;
                switch(m.Groups[2].Value) 
                {
                    case "year":
                        return new DateTime(DateTime.Now.Year+direction, 1,1);
                    case "month":
                        return new DateTime(DateTime.Now.Year, DateTime.Now.Month+direction, 1);
                }
                return DateTime.MinValue;
            }
       ),
       new RegexDateTimePattern (
            String.Format(@"(last|next) *({0}).*", String.Join("|", dayList.ToArray())), //handle weekdays
            delegate (Match m) {
                var val = m.Groups[2].Value;
                var direction = (m.Groups[1].Value == "last")? -1 :1;
                var dayOfWeek = dayList.IndexOf(val.Substring(0,3));
                if (dayOfWeek >= 0) {
                    var diff = direction*(dayOfWeek - (int)DateTime.Today.DayOfWeek);
                    if (diff <= 0 ) { 
                        diff = 7 + diff;
                    }
                    return DateTime.Today.AddDays(direction * diff);
                }
                return DateTime.MinValue;
            }
       ),

       new RegexDateTimePattern (
            @"(last|next) *(.+)", // to parse months using DateTime.TryParse
            delegate (Match m) {
                DateTime dt;
                int direction = (m.Groups[1].Value == "last")? -1 :1;
                var s = String.Format("{0} {1}",m.Groups[2].Value, DateTime.Now.Year + direction);
                if (DateTime.TryParse(s, out dt)) {
                    return dt;
                } else {
                    return DateTime.MinValue;
                }
            }
       ),
       new RegexDateTimePattern (
            @".*", //as final resort parse using DateTime.TryParse
            delegate (Match m) {
                DateTime dt;
                var s = m.Groups[0].Value;
                if (DateTime.TryParse(s, out dt)) {
                    return dt;
                } else {
                    return DateTime.MinValue;
                }
            }
       ),
    };

    public static DateTime Parse(string text)
    {
        text = text.Trim().ToLower();
        var dt = DateTime.Now;
        foreach (var parser in parsers)
        {
            dt = parser.Parse(text);
            if (dt != DateTime.MinValue)
                break;
        }
        return dt;
    }
}
interface IDateTimePattern
{
    DateTime Parse(string text);
}

class RegexDateTimePattern : IDateTimePattern
{
    public delegate DateTime Interpreter(Match m);
    protected Regex regEx;
    protected Interpreter inter;
    public RegexDateTimePattern(string re, Interpreter inter)
    {
        this.regEx = new Regex(re);
        this.inter = inter;
    }
    public DateTime Parse(string text)
    {
        var m = regEx.Match(text);

        if (m.Success)
        {
            return inter(m);
        }
        return DateTime.MinValue;
    }
} 
```

使用示例：

```
var val = FuzzyDateTime.Parse(textBox1.Text);
if (val != DateTime.MinValue)
   label1.Text = val.ToString();
else
   label1.Text = "unknown value"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T18:56:55.540

我们的用户使用的系统之一允许他们输入日期，如下所示：

*   T // 今天
*   T + 1 // 今天加/减天数
*   T + 1w // 今天加/减几个星期
*   T + 1m // 今天加/减几个月
*   T + 1y // 今天加/减若干年

他们似乎喜欢它，并在我们的应用程序中请求它，所以我想出了以下代码。ParseDateToString 将采用上述形式之一的字符串，加上其他一些形式，计算日期，并以“MM/DD/YYYY”格式返回。很容易更改它以返回实际的 DateTime 对象，并添加对小时、分钟、秒或任何您想要的支持。

```
using System;
using System.Text.RegularExpressions;

namespace Utils
{
    class DateParser
    {
        private static readonly DateTime sqlMinDate = DateTime.Parse("01/01/1753");
        private static readonly DateTime sqlMaxDate = DateTime.Parse("12/31/9999");
        private static readonly Regex todayPlusOrMinus = new Regex(@"^\s*t(\s*[\-\+]\s*\d{1,4}([dwmy])?)?\s*$", RegexOptions.Compiled | RegexOptions.IgnoreCase); // T +/- number of days
        private static readonly Regex dateWithoutSlashies = new Regex(@"^\s*(\d{6}|\d{8})\s*$", RegexOptions.Compiled); // Date in MMDDYY or MMDDYYYY format

        private const string DATE_FORMAT = "MM/dd/yyyy";

        private const string ERROR_INVALID_SQL_DATE_FORMAT = "Date must be between {0} and {1}!";
        private const string ERROR_DATE_ABOVE_MAX_FORMAT = "Date must be on or before {0}!";
        private const string ERROR_USAGE = @"Unable to determine date! Please enter a valid date as either:
    MMDDYY
    MMDDYYYY
    MM/DD/YY
    MM/DD/YYYY

You may also use the following:
    T (Today's date)
    T + 1 (Today plus/minus a number of days)
    T + 1w (Today plus/minus a number of weeks)
    T + 1m (Today plus/minus a number of months)
    T + 1y (Today plus/minus a number of years)";

        public static DateTime SqlMinDate
        {
            get { return sqlMinDate; }
        }

        public static DateTime SqlMaxDate
        {
            get { return sqlMaxDate; }
        }

        /// <summary>
        /// Determine if user input string can become a valid date, and if so, returns it as a short date (MM/dd/yyyy) string.
        /// </summary>
        /// <param name="dateString"></param>
        /// <returns></returns>
        public static string ParseDateToString(string dateString)
        {
            return ParseDateToString(dateString, sqlMaxDate);
        }

        /// <summary>
        /// Determine if user input string can become a valid date, and if so, returns it as a short date (MM/dd/yyyy) string. Date must be on or before maxDate.
        /// </summary>
        /// <param name="dateString"></param>
        /// <param name="maxDate"></param>
        /// <returns></returns>
        public static string ParseDateToString(string dateString, DateTime maxDate)
        {
            if (null == dateString || 0 == dateString.Trim().Length)
            {
                return null;
            }

            dateString = dateString.ToLower();

            DateTime dateToReturn;

            if (todayPlusOrMinus.IsMatch(dateString))
            {
                dateToReturn = DateTime.Today;

                int amountToAdd;
                string unitsToAdd;

                GetAmountAndUnitsToModifyDate(dateString, out amountToAdd, out unitsToAdd);

                switch (unitsToAdd)
                {
                    case "y":
                        {
                            dateToReturn = dateToReturn.AddYears(amountToAdd);
                            break;
                        }
                    case "m":
                        {
                            dateToReturn = dateToReturn.AddMonths(amountToAdd);
                            break;
                        }
                    case "w":
                        {
                            dateToReturn = dateToReturn.AddDays(7 * amountToAdd);
                            break;
                        }
                    default:
                        {
                            dateToReturn = dateToReturn.AddDays(amountToAdd);
                            break;
                        }
                }
            }
            else
            {
                if (dateWithoutSlashies.IsMatch(dateString))
                {
                    /*
                    * It was too hard to deal with 3, 4, 5, and 7 digit date strings without slashes,
                    * so I limited it to 6 (MMDDYY) or 8 (MMDDYYYY) to avoid ambiguity.
                    * For example, 12101 could be:
                    *       1/21/01 => Jan 21, 2001
                    *       12/1/01 => Dec 01, 2001
                    *       12/10/1 => Dec 10, 2001
                    * 
                    * Limiting it to 6 or 8 digits is much easier to deal with. Boo hoo if they have to
                    * enter leading zeroes.
                    */

                    // All should parse without problems, since we ensured it was a string of digits
                    dateString = dateString.Insert(4, "/").Insert(2, "/");
                }

                try
                {
                    dateToReturn = DateTime.Parse(dateString);
                }
                catch
                {
                    throw new FormatException(ERROR_USAGE);
                }
            }

            if (IsDateSQLValid(dateToReturn))
            {
                if (dateToReturn <= maxDate)
                {
                    return dateToReturn.ToString(DATE_FORMAT);
                }

                throw new ApplicationException(string.Format(ERROR_DATE_ABOVE_MAX_FORMAT, maxDate.ToString(DATE_FORMAT)));
            }

            throw new ApplicationException(String.Format(ERROR_INVALID_SQL_DATE_FORMAT, SqlMinDate.ToString(DATE_FORMAT), SqlMaxDate.ToString(DATE_FORMAT)));
        }

        /// <summary>
        /// Converts a string of the form:
        /// 
        /// "T [+-] \d{1,4}[dwmy]" (spaces optional, case insensitive)
        /// 
        /// to a number of days/weeks/months/years to add/subtract from the current date.
        /// </summary>
        /// <param name="dateString"></param>
        /// <param name="amountToAdd"></param>
        /// <param name="unitsToAdd"></param>
        private static void GetAmountAndUnitsToModifyDate(string dateString, out int amountToAdd, out string unitsToAdd)
        {
            GroupCollection groups = todayPlusOrMinus.Match(dateString).Groups;

            amountToAdd = 0;
            unitsToAdd = "d";

            string amountWithPossibleUnits = groups[1].Value;
            string possibleUnits = groups[2].Value;

            if (null == amountWithPossibleUnits ||
                0 == amountWithPossibleUnits.Trim().Length)
            {
                return;
            }

            // Strip out the whitespace
            string stripped = Regex.Replace(amountWithPossibleUnits, @"\s", "");

            if (null == possibleUnits ||
                0 == possibleUnits.Trim().Length)
            {
                amountToAdd = Int32.Parse(stripped);
                return;
            }

            // Should have a parseable integer followed by a units indicator (d/w/m/y)
            // Remove the units indicator from the end, so we have a parseable integer.
            stripped = stripped.Remove(stripped.LastIndexOf(possibleUnits));

            amountToAdd = Int32.Parse(stripped);
            unitsToAdd = possibleUnits;
        }

        public static bool IsDateSQLValid(string dt) { return IsDateSQLValid(DateTime.Parse(dt)); }

        /// <summary>
        /// Make sure the range of dates is valid for SQL Server
        /// </summary>
        /// <param name="dt"></param>
        /// <returns></returns>
        public static bool IsDateSQLValid(DateTime dt)
        {
            return (dt >= SqlMinDate && dt <= SqlMaxDate);
        }
    }
} 
```

您的列表中唯一可能比较困难的示例是“Last June”，但您可以通过计算自去年 6 月以来的几个月来计算要传入的字符串。

```
int monthDiff = (DateTime.Now.Month + 6) % 12;

if(monthDiff == 0) monthDiff = 12;
string lastJuneCode = string.Format("T - {0}m", monthDiff); 
```

当然，这将取决于 DateTime 的 AddMonths 函数的准确性，而且我还没有真正测试过边缘情况。它应该在去年六月为您提供 DateTime，您可以使用它来查找本月的第一天和最后一天。

其他一切都应该很容易用正则表达式映射或解析。例如：

*   上周 => "t - 1w"
*   昨天 => "t - 1d"
*   去年 => "t - 1y"
*   下周 => "t + 1w"
*   明天 => "t + 1d"
*   明年 => "t + 1y"

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T11:51:42.207

我们有类似的控制。我们只需添加一个组合框列表 - 控件来选择您的选择。

周期选择器：

*   从 [datepicker] 到 [datepicker]
*   [numericupdown] 几个月前
*   [numericupdown] 小时前
*   上个星期
*   昨天
*   周[日期选择器]
*   日期 [日期选择器]
*   ...

只需选择对您的目的有意义的选择。

实现这一点比解析文本要容易得多。计算相当简单。

重要的是要看到你正在选择一个**时期**。去年是指从 2008 年 1 月 > 2008 年 12 月。两小时前从现在到现在 - 2 小时。等等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-29T12:12:44.007

Piotr Czapla 的回答中有一个错误：

```
new RegexDateTimePattern (
            @"([2-9]\d*) *h(ours)? +ago",
            delegate (Match m) {
                var val = int.Parse(m.Groups[1].Value); 
                return DateTime.Now.AddMonths(-val);
            }
       ), 
```

使用 AddMonths 代替 AddHours()。

PS：由于论坛积分低，我无法评论他的回答。我已经浪费了时间来调试它，为什么当我尝试使用“5 小时前”时它会删除 5 天。

# .net - 如何在 Linux 环境下运行 .net 应用程序？

> ID：887193
> 
> 赞同：17
> 
> 时间：2009-05-20T10:28:00.270
> 
> 标签：.net, linux

是否可以在 Linux 环境中运行 .net 应用程序？如果是，那怎么办？.net 框架的所有组件都可以在 Linux 上正常工作吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-20T10:30:47.720

请参阅[在 Linux 上使用 Mono 运行 .Net 应用程序](http://www.linux.com/archive/articles/53582)：

> 想象一下，您公司的命运取决于您能否按时完成新的 Linux 项目。你有一个一流的开发人员组成的优秀团队，但他们都是.Net 程序员。你会怎样做？承认 Windows 比 Linux 更好？哭？辞职？不，您将安装 Mono 并拯救世界！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-20T10:29:52.293

虽然有其他选择（我相信），但[Mono](http://mono-project.com)可能是您想要的。

它不支持.NET 支持的*所有内容*，但有一个[兼容性工具](http://www.mono-project.com/MoMA)可以为您检查。（我不会盲目相信兼容性工具的结果是 100% 准确的，因为总会有一些偷偷摸摸的未知不兼容性，但这是一个非常好的开始。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-05-31T10:10:59.453

随着技术的进步，一个老问题的新答案。您也可以考虑将您的应用程序作为 dotnet 核心应用程序运行。相同的代码将自然适用于您的操作系统的 MAC Windows 和 linX 下载 dotnet 运行时以及控制台类型 Dotnet .\yourapp.dll

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T10:51:16.620

还有[MainSoft](http://www.mainsoft.com/products/vmw_j2ee.aspx)可以让您在 Linux 上的 J2EE 环境中运行。它基本上将 .NET 源代码编译成 Java 字节码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-09T10:44:02.713

**2018 年**的更新答案与[Linux](http://www.mono-project.com/)中 Mono 项目的当前状态。

[`mono`回购存在于](http://www.mono-project.com/download/stable/#download-lin)：

```
Ubuntu
Debian
Raspbian
CentOS
Fedora
Docker 
```

说明建议安装`mono-complete`- 在 Centos 上，我还必须安装`mono-basic`VB.NET 才能工作。当前对 VB.NET 的支持级别是：

```
default runtime: v4.0.30319 
```

这足以运行需要运行时的**VB.NET** `XML`客户端`3.5`：

[![在此处输入图像描述](https://i.stack.imgur.com/e4Ycr.png)](https://i.stack.imgur.com/e4Ycr.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T10:47:41.773

对于运行简单的 .net 应用程序，mono 是您选择的工具！我将它用于许多应用程序，并且没有出现重大故障。不过，我不建议开始在 Mono 上进行开发。我班上的一些人试图在 Linux 上用 mono 做 C#，但失败了。

当你做简单的事情时效果很好，但是当你去做更高级的事情时，比如使用 NHibernate 或类似的东西，它可能会让你失败。你会错过 .net 最好的东西——开发环境，因为一切都是由微软提供的，所以一切都可以协同工作。

# php - PHP fopen 警告

> ID：887195
> 
> 赞同：0
> 
> 时间：2009-05-20T10:28:33.857
> 
> 标签：php, fopen

```
$file = @fopen("http://ajax.htm","rb"); 
```

我在使用时收到此错误`fopen`

```
Warning: fopen(xyz.htm): failed to open stream: HTTP request failed! 
in /home/user/public_html/aaa/ttt.php on line 8 
```

这背后的原因是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T12:17:15.197

我将在这里竭尽全力，并建议问题出在 URL 上，“ [http://ajax.htm](http://ajax.htm) ”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T10:33:06.187

[来自文档](http://php.net/fopen)：

> 如果 PHP 决定`filename` 指定一个已注册的协议，并且该协议已注册为网络 URL，PHP 将检查以确保[`allow_url_fopen`](http://docs.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen)已启用。如果它被关闭，PHP 将发出警告并且 fopen 调用将失败。

**编辑**：`ajax.htm`不是有效的网址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T10:43:29.567

```
$file = @fopen("ajax.htm","rb"); 
```

我认为有你的问题

[http://nl3.php.net/function.fopen](http://nl3.php.net/function.fopen)

# c# - 如何在 Office Com 加载项中以编程方式处理 PowerPoint 关闭事件？

> ID：887197
> 
> 赞同：0
> 
> 时间：2009-05-20T10:29:02.763
> 
> 标签：c#, vsto

我正在将共享加载项用于办公插件。

谁能告诉我如何在 POWER POINT 的 Office COM 加载项中以编程方式处理关闭事件（我的窗口的 [X] 按钮）。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T10:36:00.130

由于共享加载项实现了`IDTExtensibility2`接口，您应该已经实现了`OnBeginShutdown`和`OnDisconnection`方法。`OnDisconnection`将在您的加载项卸载`OnBeginShutdown`时调用，将在主机应用程序（即您的案例中的 PowerPoint）即将关闭时调用：

```
/// <summary>
///      Implements the OnBeginShutdown method of the IDTExtensibility2 interface.
///      Receives notification that the host application is being unloaded.
/// </summary>
/// <param term='custom'>
///      Array of parameters that are host application specific.
/// </param>
/// <seealso class='IDTExtensibility2' />
public virtual void OnBeginShutdown(ref System.Array custom)
{
     // do clean-up when PowerPoint exits.
} 
```

请注意，您可能更愿意考虑加载项的卸载事件而不是主机的关闭事件，因为卸载事件是对加载项进行任何清理的地方。

# erlang - 成功故障转移后 Erlang Takeover 失败

> ID：887198
> 
> 赞同：1
> 
> 时间：2009-05-20T10:29:09.423
> 
> 标签：erlang, erlang-otp

我有一个分布在 2 个节点上的应用程序。当我停止（）第一个节点时，故障转移工作完美，但是（有时？）当我重新启动第一个节点时，接管失败并且应用程序崩溃，因为 start_link 返回已经启动。

```
SUPERVISOR REPORT  <0.60.0>                                 2009-05-20 12:12:01
===============================================================================
Reporting supervisor                          {local,twitter_server_supervisor}

Child process
   errorContext                                                     start_error
   reason                                         {already_started,<2415.62.0>}
   pid                                                                undefined
   name                                                                    tag1
   start_function                                {twitter_server,start_link,[]}
   restart_type                                                       permanent
   shutdown                                                               10000
   child_type                                                            worker

ok 
```

我的应用

```
start(_Type, Args)->
    twitter_server_supervisor:start_link( Args ).

stop( _State )->
    ok. 
```

我的主管：

```
start_link( Args ) ->
    supervisor:start_link( {local,?MODULE}, ?MODULE, Args ). 
```

两个节点都使用相同的 sys.config 文件。

我对这个过程不理解以上不应该工作的地方是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-21T09:28:28.683

您的问题似乎源于 twitter 服务器主管试图启动它的一个孩子。由于错误报告抱怨带有 start_function 的孩子

```
{twitter_server,start_link,[]} 
```

而且由于您没有显示该代码，我只能猜测它正在尝试为自己注册一个名称，但已经有一个使用该名称注册的进程。

更令人猜测的是，原因显示了一个 Pid，这个 Pid 的名字是我们试图为自己获取的：

```
{already_started,<2415.62.0>} 
```

那里的 Pid 有一个非零的初始整数，如果它为零，则表示它是一个本地进程。从中我推断您正在尝试注册一个全局名称，并且您连接到另一个节点，其中已经有一个以该名称全局注册的进程。

# c# - 在 C# 中行走 ANTLR AST 的教程？

> ID：887205
> 
> 赞同：22
> 
> 时间：2009-05-20T10:30:40.623
> 
> 标签：c#, java, parsing, antlr

有人知道在 C# 中使用 ANTLR 生成的 AST 的教程吗？我能找到的最接近的是[this](http://www.manuelabadia.com/blog/PermaLink,guid,5085c0cc-5256-429c-a18c-4639afa0dcc1.aspx)，但它并不是很有帮助。

我的目标是遍历基于我正在研究的领域特定语言生成的树，并使用这些树来输出生成的 C# 代码。

基于 Java 的教程也会有所帮助——任何提供如何遍历 ANTLR AST 的清晰示例的内容。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-29T19:06:09.693

我设法通过改编[Manuel Abadia 文章](http://www.manuelabadia.com/blog/PermaLink,guid,6e509f70-3db8-46f4-b451-1ef9dd80740b.aspx)末尾的示例来解决这个问题。

这是我的版本，我碰巧用它来将解析的代码转换为 C#。这些是步骤：

1.  使用您的输入实例化一个[ANTLRStringStream](http://www.antlr.org/api/CSharp/class_antlr_1_1_runtime_1_1_a_n_t_l_r_string_stream.html)或子类（它可以是文件或字符串）。
2.  实例化您生成的词法分析器，传入该字符串流。
3.  使用词法分析器实例化令牌流。
4.  使用该令牌流实例化您的解析器。
5.  从解析器中获取顶级值，并将其转换为`CommonTree`.
6.  遍历树：

要获取节点的文字文本，请使用`node.Text`. 要获取节点的令牌名称，请使用`node.Token.Text`.

请注意，`node.Token.Text`如果它是一个没有相应字符串的虚构令牌，它只会给您令牌的实际名称。如果它是一个真正的令牌，那么`node.Token.Text`将返回它的字符串。

例如，如果您的语法中有以下内容：

```
tokens { PROGRAM, FUNCDEC }

EQUALS : '==';
ASSIGN : '='; 
```

然后，您将从 的相应访问中获得`"PROGRAM"`、`"FUNCDEC"`、`"=="`和。`"="``node.Token.Text`

您可以在下面看到我的部分示例，或者您可以浏览[完整版本](http://code.google.com/p/godpl/source/browse/#svn/tags/cs152-submission/GodPl/GodPl/Parser)。

* * *

```
public static string Convert(string input)
{
    ANTLRStringStream sStream = new ANTLRStringStream(input);
    MyGrammarLexer lexer = new MyGrammarLexer(sStream);

    CommonTokenStream tStream = new CommonTokenStream(lexer);

    MyGrammarParser parser = new MyGrammarParser (tStream);
    MyGrammarParser.program_return parserResult = parser.program();

    CommonTree ast = (CommonTree)parserResult.Tree;

    Print(ast);
    string output = header + body + footer;

    return output;
}

public static void PrintChildren(CT ast)
{
    PrintChildren(ast, " ", true);
}

public static void PrintChildren(CT ast, string delim, bool final)
{
    if (ast.Children == null)
    {
        return;
    }

    int num = ast.Children.Count;

    for (int i = 0; i < num; ++i)
    {
        CT d = (CT)(ast.Children[i]);
        Print(d);
        if (final || i < num - 1)
        {
            body += delim;
        }
    }
}

public static void Print(CommonTree ast)
{
    switch (ast.Token.Text)
    {
        case "PROGRAM":
            //body += header;
            PrintChildren(ast);
            //body += footer;
            break;
        case "GLOBALS":
            body += "\r\n\r\n// GLOBALS\r\n";
            PrintChildren(ast);
            break;
        case "GLOBAL":
            body += "public static ";
            PrintChildren(ast);
            body += ";\r\n";
            break;

      ....
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-20T13:29:32.307

通常，您使用递归遍历 AST，并根据节点的类型执行不同的操作。如果您使用多态树节点（即树中不同节点的不同子类），那么访问者模式中的双重调度可能是合适的；然而，这对于 Antlr 来说通常不是很方便。

在伪代码中，行走通常看起来像这样：

```
func processTree(t)
    case t.Type of
        FOO: processFoo t
        BAR: processBar t
    end

// a post-order process
func processFoo(foo)
    // visit children
    for (i = 0; i < foo.ChildCount; ++i)
        processTree(foo.GetChild(i))
    // visit node
    do_stuff(foo.getText())

// a pre-order process
func processBoo(bar)
    // visit node
    do_stuff(bar.getText())
    // visit children
    for (i = 0; i < foo.ChildCount; ++i)
        processTree(foo.GetChild(i)) 
```

处理的种类高度依赖于语言的语义。例如，在为 JVM 或 CLR 等堆栈机器生成代码时`IF`，使用 structure 处理语句，可能看起来有点像这样：`(IF <predicate> <if-true> [<if-false>])`

```
func processIf(n)
    predicate = n.GetChild(0)
    processExpr(predicate) // get predicate value on stack
    falseLabel = createLabel()
    genCode(JUMP_IF_FALSE, falseLabel) // JUMP_IF_FALSE is called brfalse in CLR,
                                       // ifeq in JVM
    if_true = n.GetChild(1)
    processStmt(if_true)
    if_false = n.ChildCount > 2 ? n.GetChild(2) : null
    if (if_false != null)
        doneLabel = createLabel()
        genCode(JUMP, doneLabel)
    markLabel(falseLabel)
    if (if_false != null)
        processStmt(if_false) // if-false branch
        markLabel(doneLabel) 
```

一般来说，一切都是根据当前节点的类型递归完成的，等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T14:17:07.420

You should look into writing a TreeParser; it can make the job of interpreting the tree much simpler.

For ANTLR 2.x see [http://www.antlr2.org/doc/sor.html](http://www.antlr2.org/doc/sor.html) For ANTLR 3.x see [http://www.antlr.org/wiki/display/ANTLR3/Tree+construction](http://www.antlr.org/wiki/display/ANTLR3/Tree+construction) (java-based parser and tree parser example)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T14:24:43.740

我做了类似的事情（但不是真的），最终得到了一个 TreeParser。

我还建议购买 ANTLR 书。我发现它比任何网络资源都更有价值。它可能没有所有的答案，但它肯定有助于基础知识。

# javascript - 如何自定义这个已经自定义的 jQuery 排序解决方案？

> ID：887207
> 
> 赞同：1
> 
> 时间：2009-05-20T10:30:53.757
> 
> 标签：javascript, jquery, arrays, sorting

我找到了以下解决方案来为 jQuery 添加排序功能（参考：[jQuery sort()](http://www.wrichards.com/blog/2009/02/jquery-sorting-elements/ "jQuery 排序（）")）。我已经改变了对未知长度的字符串进行排序的解决方案。它工作得很好，但是正如您可能从函数名称中注意到的那样：它按升序排序:-)。

```
jQuery.fn.sort = function() {  
    return this.pushStack( [].sort.apply( this, arguments ), []);  
};  

function sortStringAscending(a,b){
    var h1 = a.innerHTML;
    var h2 = b.innerHTML;
    var c = 0;
    var str1 = null,
    var str2 = null;

    while(str1 == str2 && (c < h1.length && c < h2.length)) {
        str1 = h1.substring(c,c+1).toLowerCase().charCodeAt(0);
        str2 = h2.substring(c,c+1).toLowerCase().charCodeAt(0);

        if(str1 > str2) {
            r = 1;
        } else if(str2 > str1) {
            r = -1;
        }

        c += 1;
    }
    return r;  
}; 
```

该函数的使用如下：

```
$('ol li').sort(sortStringAscending).appendTo('ol'); 
```

**是否可以更改此代码以使以下成为可能？**

```
$('ol li').sort(sortString, 0).appendTo('ol');  //0 for descending
$('ol li').sort(sortString, 1).appendTo('ol');  //1 for ascending 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T11:28:42.597

您将无法轻松地将附加参数添加到 jQuery.fn.sort 使用的数组排序函数中。

使用两个单独的函数会更容易，一个用于升序，一个用于降序，但将实际比较保留在第三个函数中。

```
function sortStringAscending(a,b) {
    return sortString(a,b,1);
};
function sortStringDescending(a,b) {
    return sortString(a,b,-1);
};
function sortString(a,b,direction) {
   var h1 = a.innerHTML.toLowerCase();
   var h2 = b.innerHTML.toLowerCase();

   if(h1 > h2) {
      r = 1*direction;
   } else if(h2 > h1) {
      r = -1*direction;
   }
   return r;  
}; 
```

另请注意，您可以简单地比较两个字符串，无需逐个字符地比较它们，除非您希望对“abc”和“abcd”等项目具有不可预测的排序顺序。

那么你应该能够做到

```
$('ol li').sort(sortStringAscending).appendTo('ol');
$('ol li').sort(sortStringDescending).appendTo('ol'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T10:51:29.240

这将满足您的要求：（使用参数来决定排序顺序）

```
function sortString(a,b,direction){
var d = (direction?1:-1);
var h1 = a.html();
var h2 = b.html();
var c = 0;
var str1 = null,
var str2 = null;

while(str1 == str2 && (c < h1.length && c < h2.length)) {
    str1 = h1.substring(c,c+1).toLowerCase().charCodeAt(0);
    str2 = h2.substring(c,c+1).toLowerCase().charCodeAt(0);

    if(str1 > str2) {
        r = 1*d;
    } else if(str2 > str1) {
        r = -1*d;
    }

    c += 1;
}
return r; 
```

};

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T10:39:49.327

改变这个：

```
if(str1 > str2) {
    r = 1;
} else if(str2 > str1) {
    r = -1;
} 
```

对此：

```
if(str1 > str2) {
    r = -1;
} else if(str2 > str1) {
    r = 1;
} 
```

将交换排序顺序。

* * *

编辑：

由于 Javascript 的 array.sort(callback) 函数的工作方式，只添加第三个参数来接受回调并不容易，我建议使用 2 个单独的函数 mySortAsc 和 mySortDesc ，这反过来又可以调用第三个函数并传递需要什么参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-05T19:40:55.610

您也许可以使用闭包。尽管 javascript 数组排序方法需要一个 2 参数函数，但您可以通过执行以下操作将其他信息带入回调函数的范围：

```
function BiSort(direction)
{
    return  function( a, b )
            {
                var d = ( direction ? 1 : -1 ) ;

                return ( a > b ? 1 : b > a ? -1 : 0 ) * d ; 
            }
} 
```

BiSort 函数返回一个可以访问外部函数参数列表的新函数。现在你可以这样做：

```
var a = ["ant", "goat", "bat", "zebra", "yak"] ;

a.sort(BiSort(true));  // sorts ascending

a.sort(BiSort(false)); // sort descending 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-01T04:39:50.287

我知道这是旧的，但为了将来参考，我会为 asc/desc 创建 2 个函数，然后根据您的需要使一个 var 指向一个或另一个，然后将该 var 传递给 array.sort()

```
function SortAsc(a, b){
}

function SortDesc(a, b){
}

var sortOrder

// if asc button clicked
sortOrder = SortAsc;

// if desc button clicked
sortOrder = SortDesc;

$('ol li').sort(sortOrder); 
```

# asp.net-mvc - ASP.net MVC RouteLink 和可选的 routeValues

> ID：887208
> 
> 赞同：2
> 
> 时间：2009-05-20T10:30:56.300
> 
> 标签：asp.net-mvc, routevalues, routelink

我试图弄清楚如何有条件地设置一个可选的 routeValue。

我有

```
<%= Html.RouteLink("<<<","Products",new { page=(Model.Products.PageIndex) }) %> 
```

如果访问者点击“类别”，我只显示该类别的产品，但如果没有“类别”，我会显示所有产品。

这 2 个 URL 将是有效的：

/产品/页面

/Products/Page?category=汽车

RouteLink 在我的寻呼机中，所以我想我可以通过某种方式在寻呼机的链接中传递类别参数，以便在页面之间保持类别。但是，我不确定如何处理未选择类别与选择类别的情况。

我知道我可以这样做：

```
<%= Html.RouteLink("<<<","Products",new { page=(Model.Products.PageIndex), category=cars }) %> 
```

但是是否有可能在不创建一些尴尬的 if 语句的情况下处理这两种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T12:08:06.277

这只是一个想法，但你不能只传递一个空的类别参数吗？

```
<%= Html.RouteLink("<<<","Products",new { page=(Model.Products.PageIndex), category=(ViewData["CategoryName"]) }) %> 
```

在获得页面的产品控制器中，只需检查它是否存在？

```
public ActionResult Index(int page, string category)
{
    ViewData["CategoryName"] = category;

    if(!string.IsNullOrEmpty(category)){
        //paging with category
    }else{
        //paging without category
    }
    return View("Create");
} 
```

或者这就是“尴尬的 if 语句”的意思？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T12:26:15.553

如果*汽车*变量为 null 或空字符串，Html.RouteLink 方法不会自动将*类别*参数添加到 URL。你不需要做额外的检查。

# regex - 为什么在这个正则表达式中匹配空行？

> ID：887209
> 
> 赞同：1
> 
> 时间：2009-05-20T10:31:06.893
> 
> 标签：regex, perl

天，

我正在使用以下 Perl 片段从 Solaris 集群命令中提取输出。

```
open(CL,"$clrg status |");
my @clrg= grep /^[[:lower:][:space:]]+/,<CL>;
close(CL); 
```

当我打印数组@clrg BTW“=>”和“<=”行分隔符的内容时，我得到以下打印语句：

```
=><=
=>nas-rg             mcs0.cwwtf.bbc.co.uk   No          Online<=
=>                   mcs1.cwwtf.bbc.co.uk   No          Offline<=
=><=
=>apache-rg          mcs0.cwwtf.bbc.co.uk   No          Online<=
=>                   mcs1.cwwtf.bbc.co.uk   No          Offline<=
=><= 
```

当我用以下 Perl 片段替换它时，空白行不匹配。

```
open(CL,"$clrg status |");
my @clrg= grep /^[[:lower:][:space:]]{3,}/,<CL>;
close(CL); 
```

我得到以下信息：

```
=>nas-rg             mcs0.cwwtf.bbc.co.uk   No          Online<=
=>                   mcs1.cwwtf.bbc.co.uk   No          Offline<=
=>apache-rg          mcs0.cwwtf.bbc.co.uk   No          Online<=
=>                   mcs1.cwwtf.bbc.co.uk   No          Offline<= 
```

简单的问题是为什么？

顺便说一句，在第二个 Perl 片段中使用 {1,} 也匹配空行！

任何建议都感激不尽！

干杯，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-20T10:36:39.177

那是因为`[:space:]`也匹配换行符和回车符。

`[[:space:]]+`匹配`\n`,`\r\n`或`\n\n`. _

但是`[[:space:]]{3,}`需要三个字符，而空行只是一个`\n`.

`{1,}`并且`+`意思相同：匹配前一组一次或多次。

PS 一个典型的换行符是`\n`在 Unix 和`\r\n`Windows 上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T12:51:35.377

嗯。根据[Perl 正则表达式文档](http://perldoc.perl.org/perlre.html)，`[:space:]`字符类不应包含换行符，因为它应该等同于`\s`（除了它识别附加字符垂直制表符以保持 POSIX 合规性）。

*但是*，刚刚在 5.10.0 上对此进行了测试，我可以验证它是否也匹配换行符。无论这是否属于 Perl 或文档中的错误，我都会留给 Perl 维护者。但是为了避免眼前的问题，请使用以前的回答者的解决方案，`\s`而不是使用 POSIX 类。

# winforms - 如何在 winforms 应用程序中记录用户操作

> ID：887212
> 
> 赞同：1
> 
> 时间：2009-05-20T10:31:54.037
> 
> 标签：winforms, user-interface

我想在 winforms 应用程序中记录用户操作。“用户操作”是指“点击菜单项/按钮”、“移动/最大化/最小化/关闭表单”、“keydown/up”等...

日志应该包含时间、动作类型（点击/keydown/etc...）、目标（控制名称/文本）。

我可以访问目标应用程序的源代码，但如果没有必要，我不想在我正在使用的每个 winforms 控件中覆盖诸如“OnClick”或“OnKeyDown”之类的方法。

有没有一些优雅的解决方案，怎么做？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T11:00:38.237

您可以使用属性，但我想知道收益是否会超过成本？

有关创建可以在每个方法上设置的属性的示例，请参见此链接

[http://www.yoda.arachsys.com/csharp/benchmark.html](http://www.yoda.arachsys.com/csharp/benchmark.html)

# project-management - Axosoft OnTime vs Countersoft Gemini

> ID：887223
> 
> 赞同：5
> 
> 时间：2009-05-20T10:35:19.070
> 
> 标签：project-management, ontime, gemini

我们正在“升级”公司的系统，从 SourceSafe/BugNet/...（是的！）转移到一些更严重的系统。TFS 太贵了。我们已经开始比较 OnTime 与 Gemini。他们看起来都不错，标价“OK”。我们当然会下载并试用它们，但如果有经验丰富的用户发表评论，那就太好了。对我来说，他们似乎相当平等。

有没有人用过两者，并且可以将两者相互比较？如果你会推荐其中之一，是哪一个，为什么？这些系统还有其他经验吗？（尤其是双子座，似乎很难找到关于这个的评论......？）

（我们谈论的是一个较小的开发团队，一次最多 8 个开发人员在一个项目中，几个测试人员和一些利益相关者/经理等......多个项目同时运行。需要能够集成到 Visual Studio、Subversion反馈给问题跟踪器等）

谢谢你的时间！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-08-01T07:48:20.007

我们在这里使用 OnTime - 它有一个很好的工作流环境，但要注意它根本不能很好地扩展。我们目前有 35 个许可证，任何时候只有 10 到 15 个用户在线，而且很困难。

还要注意在分布式环境中使用 Web 或“远程”服务器的推销 - 它适用于 demo/eval 数据库，但一旦您开始在数据库中获取相当数量的项目，它就会变慢。您所要做的就是查看 SQL 分析器，您将看到对数据库的调用次数。

如果您分析 Web 服务，您还会看到 Web 和远程环境根本没有针对批处理调用进行优化，因此一旦您移动到存在任何类型通信延迟的环境，它就会爬行。

Axosoft 的支持在这方面也没有多大帮助——奇怪的是，他们并不将这些视为错误，而是将其视为我们在这些环境中应该期待的。我们还就其他一些事情联系了他们的支持，令人惊讶的是，它在其他事情上也有多么糟糕。

Axosoft 的借口是我们应该在 eval 期间发现这些东西，但我不知道他们希望我们如何在 30 天 eval 期间将数据扩展到生产环境级别......

对于我们的分布式团队，我们被迫恢复使用 WinForm 客户端而不是 Citrix。

总的来说 - 如果你在一个地方有一个小团队，这是一个很好的应用程序。但是，如果您有更大的团队或分散在多个地点的人员，我会不惜一切代价避免它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-25T21:30:50.750

Gemini 很棒，我们选择了 Gemini 而不是许多其他错误跟踪系统...

我们喜欢的主要功能：
用户界面
可扩展性（API，基于 REST）
插件产品（Visual Studio，Outlook 插件）
源代码控制集成（颠覆）

源代码可用（asp.net c#），易于设置和强大的支持。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-08T14:33:11.423

为了与[Gemini 错误跟踪器](http://www.geminiplatform.com)和同一空间中的其他人进行更广泛的比较，维基百科[错误跟踪比较](http://en.wikipedia.org/wiki/Comparison_of_issue-tracking_systems)页面可能有用。虽然我不知道直接、深入的 Gemini / OnTime 比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-27T16:17:47.823

查看[Project Kaiser](http://www.projectkaiser.com)（提供简短演示）。它速度快，基于网络，支持嵌入式 wiki、论坛和聊天。它对 5 个用户免费 :)

# c - 在 C 中识别俄罗斯方块

> ID：887224
> 
> 赞同：2
> 
> 时间：2009-05-20T10:35:29.363
> 
> 标签：c, image, image-processing

我必须制作一个应用程序来识别黑白图像中用户给出的一块俄罗斯方块。我读取图像以分析成一个数组。

我怎么能用C做这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T10:39:11.540

您可能不想从头开始实现它（当然，除非需要）......我建议寻找合适的库。我听说[OpenCV](http://en.wikipedia.org/wiki/OpenCV)很好，但我自己从来没有做过机器视觉方面的工作，所以我没有测试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T10:40:43.003

搜索连接的组件（即使用深度优先搜索；如果效率是一个问题，您可能希望避免递归；改用您自己的堆栈）。最大的连接组件应该是你的俄罗斯方块。然后您可以进一步分析它（使用形状、大小或某种边框描述）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T10:56:15.297

假设您已经将图像加载到数组中，那么使用正则表达式呢？您不需要精确的形状匹配，而是近似匹配，所以为什么不试一试！

*编辑*：我下载了你的 doc 文件。您必须在 2D 数组上的随机数字中识别出随机模式，因此正则表达式不适合这个问题，可以说这是个坏消息。好消息是你的作业并不*完全是*图像处理，而且要容易得多。

这是你的作业，所以我不会为你创建代码，但我可以给你指示。

1.  您需要一个可以从旋转的原始图案/片段创建新片段的例程。（注意：我的意思是 4x4 正方形 - 它的所有单元格）
2.  您需要一个例程来检查一块是否与 2D 图像中位置 x,y 的区域匹配 - 匹配区域将具有角 (x-2, y-2, x+1, y+1)。
3.  您通过检查每个图像位置 (x,y) 来搜索匹配项。

由于您必须使用并行性，您可以创建 4 个线程并为每个线程分配不同的旋转进行搜索。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-21T16:22:53.370

查看 Wikipedia 中为俄罗斯方块给出的形状，称为“I,J,L,O,S,T,Z”，似乎边界框的边的比率（很容易找到给定的二进制图像和 C ) 揭示你有 I (4:1) 还是 O (1:1)；其他形状为 2:3。

要检测您拥有哪些剩余形状（J、L、S、T 或 Z），您似乎可以收集落在边界框边缘上的形状边缘的长度和位置。因此，T 将沿 3 边显示 3 和 1，沿 2 边显示 1 和 1。跟踪位置有助于区分 J 和 L、S 和 Z。

# android - 为什么更新一个安卓应用可以让它出现两次？

> ID：887226
> 
> 赞同：4
> 
> 时间：2009-05-20T10:35:31.207
> 
> 标签：android

我对我的应用程序进行了很多更改：数据库方案、图形、代码等。最大的是我重命名为完全不同的包名称。应用程序在 manifeste.xml 文件中具有相同的名称和 Id，而 apk 具有相同的名称，具有相同的数字签名。

然而，在使用时`./adb install -r myapp.apk`，myapp 在菜单中出现了两次。当然，由于数据库是以包名作为名称存储在目录中的，因此用户会感觉它的数据丢失了。

我怎样才能防止这种情况发生，如果我不能，我怎样才能使他的迁移自动化？

我有几个线索：提示用户卸载旧应用程序，将数据库从旧文件复制到新文件等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T02:15:07.410

直接的答案是应用程序出现两次，因为 Android Market 和 Android OS 将两个不同的包视为两个不同的应用程序。代码可以相同，但如果包不同，则应用程序完全不同

Android Market 通过包名来识别应用程序。我怀疑这是因为操作系统按包跟踪程序......这是有道理的，您不希望安装两个具有完全相同名称的包，操作系统如何知道要调用哪个包？因此，如果您安装的软件包与已安装的软件包同名，操作系统会将其视为软件包升级，并让新程序访问旧用户数据。

您声明包共享相同的 ID，我假设这是用户 ID。这使您能够在包之间共享数据。更多信息在这里：

[http://developer.android.com/guide/topics/security/security.html#userid](http://developer.android.com/guide/topics/security/security.html#userid)

建议：发布对旧包的小升级，提供所需的任何胶水，使其与新包共享数据。然后使用代码发布您的新包以从旧包中导入用户数据（需要相同的 UserId 和签名）。过渡对用户来说是无缝的（无需手动备份和导入）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-03T07:52:00.013

应用程序签名必须相同。如果您在另一个 Eclipse 中导入项目，构建它并将其上传到市场，您将看到 2 个单独的应用程序。

# iphone - 在 floatA 和 floatB 之间获取随机浮点数的最佳方法是什么？

> ID：887240
> 
> 赞同：6
> 
> 时间：2009-05-20T10:40:14.923
> 
> 标签：iphone, objective-c, cocoa-touch

我有一个由两个浮点数组成的区间，并且需要生成 20 个随机数，它们位于由两个浮点数定义的区间之间的某个位置。

比方说，例如：

```
float a = 12.49953f
float b = 39.11234f
float r = //best way to get best randomly numbers between a and b 
```

随机数可以是 == a 和 == b。你有什么建议？我知道所有的计算机和语言都有随机数的问题，并且有很多方法可以生成它们。但我在目标 c 方面没有经验。

在循环中生成的一组 20 个数字中生成的数字不相同，这一点非常重要。我认为为此我会创建一个方法，将数字放入数组中并检查生成的数字是否与数组中的所有其他数字不同，如果没有，我会生成另一个。

我试过这个：

CGFloat r = 1 + arc4random() % 5;

但这只会生成整数，而且大多数时候我会得到 2 次相同的随机数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T11:01:28.750

试试这个

```
float a = 12.49953f;
float b = 39.11234f;
int startVal = a*10000;
int endVal = b*10000; 

srandom((unsigned)(mach_absolute_time() & 0xFFFFFFFF));
int randomValue = startVal+ (random() % (endVal - startVal));

float r = (float)randomValue / 10000.0f; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T11:00:31.827

通常，您会通过 random 函数获得 0 到 1 之间的随机数（不包括 1）。这可以通过将随机数乘以 a 和 b 之间的间隔长度并加上较低的值来均匀地分布到所需的间隔。

与

```
float r = random();
return a+(b-a)*r; 
```

对于 20 个不同随机数的问题：20 个数字 - 我会创建某种数组并按照您的建议每次进行线性搜索。这很容易实现而不会失败并且易于调试。这可以节省您解决更复杂问题的时间。20 足够低，线性搜索不会对性能产生重大影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-25T17:40:21.793

这是我用的，相当于python的random.uniform()：

```
 float random_uniform(float min, float max) {
       // equivalent of random.uniform()
       return ((float)arc4random_uniform(((max-min)*1000)))/1000+min;
   } 
```

arc4random_uniform 提供了非常好的均匀分布。乘以 1000 是为了允许处理小于 1 的数字。增加乘数（和除数）以提高精度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-18T19:52:23.867

当使用 arc4random 获取浮点值时，将其除以最大值是一个不错的主意。这将为您提供一个范围从 0 到 1 的浮点数，具有相当高的精度。而不是从 1-100 中获取 1 2 3 4 的值...

```
#define ARC4RANDOM_MAX  0x100000000
float r = ((double)arc4random() / ARC4RANDOM_MAX); 
```

就像托比亚斯说的那样，要获得一个范围，你会使用类似的东西

```
float result = a + ((b-a)*r); 
```

# rhino-mocks - Rhino Mocks：Repeat.Once() 不起作用？

> ID：887245
> 
> 赞同：15
> 
> 时间：2009-05-20T10:42:06.823
> 
> 标签：rhino-mocks

谁能告诉我为什么下面的测试没有失败？

```
[Test]
public void uhh_what() {
    var a = MockRepository.GenerateMock<IPrebuiltNotifier>();
    a.Expect(x => x.Notify()).Repeat.Once();
    a.Notify();
    a.Notify();
    a.VerifyAllExpectations();
} 
```

真的需要第二双眼睛来确认我没有疯……现在我担心我所有的测试都不可靠。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-20T12:10:56.067

[RhinoMocks 组上](http://groups.google.com/group/RhinoMocks/browse_thread/thread/13abb06b8893ade8/9a1d0473f18f54c9)已经有一个线程。

GenerateMock 创建一个动态模拟。动态模拟允许未指定（=预期）的调用。如果发生这种情况，它只会返回 null（或返回类型的默认值）。

注意：**重复是行为的规范（如 Stub），而不是期望，**即使在期望中指定。

如果你想避免超过一定数量的调用，你可以写：

```
[Test]
public void uhh_what() 
{
    var a = MockRepository.GenerateMock<IPrebuiltNotifier>();
    a.Expect(x => x.Notify()).Repeat.Once();
    a.Stub(x => x.Notify()).Throw(new InvalidOperationException("gotcha"));
    a.Notify();

    // this fails
    a.Notify();

    a.VerifyAllExpectations();
} 
```

或者

```
[Test]
public void uhh_what() 
{
    var a = MockRepository.GenerateMock<IPrebuiltNotifier>();
    a.Notify();
    a.Notify();

    // this fails
    a.AssertWasCalled(
      x => x.Notify(), 
      o => o.Repeat.Once());
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-12-23T07:54:27.100

当使用 GenerateMock（或一般的 Dynamic Mocks）时，我总是在脑海中插入以下内容：

a.Expect(x => x.Notify()).重复。***[至少]** *Once();

# ruby-on-rails - Rails 迁移：撤消列的默认设置

> ID：887246
> 
> 赞同：191
> 
> 时间：2009-05-20T10:42:52.423
> 
> 标签：ruby-on-rails, rails-migrations

我有一个问题，我在 Rails 中有一个为列设置默认设置的迁移，如下例所示：

```
def self.up
  add_column :column_name, :bought_at, :datetime, :default => Time.now
end 
```

假设，我想在以后的迁移中删除默认设置，如何使用 rails 迁移来做到这一点？

我目前的解决方法是在 rails 迁移中执行自定义 sql 命令，如下所示：

```
def self.up
  execute 'alter table column_name alter bought_at drop default'
end 
```

但我不喜欢这种方法，因为我现在依赖于底层数据库如何解释这个命令。如果数据库发生更改，此查询可能不再起作用，并且迁移将被破坏。那么，有没有办法表示撤消 Rails 中列的默认设置？

* * *

## 回答 #1

> 赞同：388
> 
> 时间：2009-11-17T02:36:11.313

### 导轨 5+

```
def change
  change_column_default( :table_name, :column_name, from: nil, to: false )
end 
```

### 导轨 3 和导轨 4

```
def up
  change_column_default( :table_name, :column_name, nil )
end

def down
  change_column_default( :table_name, :column_name, false )
end 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-20T12:28:35.533

正如文档指出的那样，[听起来您正在使用“执行”做正确的事情：](http://www.railsbrain.com/api/rails-2.3.2/doc/index.html?a=M001960&name=change_column_default)

> ```
> change_column_default(table_name, column_name, default) 
> ```
> 
> 为列设置新的默认值。 **如果您想将默认值设置为 NULL，那么您就不走运了。您需要自己执行 DatabaseStatements#execute 相应的 SQL 语句。** 例子
> 
> ```
> change_column_default(:suppliers, :qualification, 'new')
> change_column_default(:accounts, :authorized, 1) 
> ```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-04-06T05:10:20.837

我用来制作`NULL`columns的以下片段，但在架构级别`NOT NULL`跳过：`DEFAULT`

```
def self.up
  change_column :table, :column, :string, :null => false, :default => ""
  change_column_default(:table, :column, nil)
end 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-12-09T07:44:32.043

导轨 4

```
change_column :courses, :name, :string, limit: 100, null: false 
```

# eclipse-rcp - 如何在 Eclipse RCP 中实现内容辅助的文档弹出窗口

> ID：887248
> 
> 赞同：3
> 
> 时间：2009-05-20T10:43:30.923
> 
> 标签：eclipse-rcp, code-completion, eclipse-pde

我已经实现了自己的编辑器，并为其添加了代码完成功能。我的内容助手在源查看器配置中注册，如下所示：

```
public IContentAssistant getContentAssistant(ISourceViewer sourceViewer) {
    if (assistant == null) {
        assistant = new ContentAssistant();
        assistant.setDocumentPartitioning(getConfiguredDocumentPartitioning(sourceViewer));
        assistant.setContentAssistProcessor(getMyAssistProcessor(),
                MyPartitionScanner.DESIRED_PARTITION_FOR_MY_ASSISTANCE);
        assistant.enableAutoActivation(true);
        assistant.setAutoActivationDelay(500);
        assistant.setProposalPopupOrientation(IContentAssistant.PROPOSAL_OVERLAY);
        assistant.setContextInformationPopupOrientation(IContentAssistant.CONTEXT_INFO_ABOVE);
    }
    return assistant;
} 
```

当我在所需分区内按`Ctrl`+时`SPACE`，会出现完成弹出窗口并按预期工作。

这是我的问题..如何实现/注册出现在完成弹出窗口旁边的文档弹出窗口？（例如在 java 编辑器中）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T14:08:21.213

好，

我会自己回答这个问题;-)

您必须添加此行

```
assistant.setInformationControlCreator(getInformationControlCreator(sourceViewer)); 
```

到上面的配置。然后在创建**CompletionProposals时，构造函数的名为****additionalProposalInfo**的第八个（最后一个）参数是文本，它将显示在文档弹出窗口中。

```
new CompletionProposal(replacementString,
                          replacementOffset,
                          replacementLength,
                          cursorPosition,
                          image,
                          displayString,
                          contextInformation,
                          additionalProposalInfo); 
```

更多信息可以在[这里](http://www.50001.com/language/javaside/lec/java_ibm/Equipping%20SWT%20%BE%D6%C7%C3%B8%AE%C4%C9%C0%CC%BC%C7%BF%A1%20content%20assistants%20%C3%DF%B0%A1%C7%CF%B1%E2%20(%BF%B5%B9%AE).htm)找到。

容易，不是吗..如果你知道怎么做;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-04T05:33:11.157

对于样式化的信息框（就像在 JDT 中一样）。

![样式化的附加信息](https://i.stack.imgur.com/YCIar.png)

* * *

*   [DefaultInformationControl](http://help.eclipse.org/helios/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/text/DefaultInformationControl.html)实例需要接收`HTMLTextPresenter`一个.

```
import org.eclipse.jface.internal.text.html.HTMLTextPresenter;

public class MyConfiguration extends SourceViewerConfiguration {

    [...]
    public IContentAssistant getContentAssistant(ISourceViewer sourceViewer) {
        if (assistant == null) {
            [...]
            assistant.setInformationControlCreator(getInformationControlCreator(sourceViewer));
        }
        return assistant;
    }

    @Override
    public IInformationControlCreator getInformationControlCreator(ISourceViewer sourceViewer) {
        return new IInformationControlCreator() {
            public IInformationControl createInformationControl(Shell parent) {
                return new DefaultInformationControl(parent,new HTMLTextPresenter(false));
            }
        };
    }
} 
```

*   [然后，提案可以在getAdditionalProposalInfo()](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/text/contentassist/ICompletionProposal.html)方法的字符串中使用基本的 HTML 标记。

```
public class MyProposal implements ICompletionProposal {
    [...]
    @Override
    public String getAdditionalProposalInfo() {
        return "<b>Hello</b> <i>World</i>!";
    }
} 
```

# vb.net - 如何将对象转换为可空类型的结构？

> ID：887251
> 
> 赞同：1
> 
> 时间：2009-05-20T10:44:59.940
> 
> 标签：vb.net, casting

在我正在工作的代码库中，有一个具有签名的方法

```
Public Sub SetDropDownValue(Of T As Structure)(ByVal target As ListControl, ByVal value As Nullable(Of T)) 
```

我正在编写的方法传递了一个对象类型的参数。

如何将对象转换为可以传递给`SetDropDownValue`方法的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T10:53:15.337

不，您将无法将引用类型转换为值类型（这是`Structure`约束所表示的）。CLR 确实允许您将值类型强制转换为引用类型（这称为*装箱*），但是这两种不同类型的实现（和语义）之间的差异的性质使得相反的情况变得不可能。

你唯一能做的就是创建一个值类型，它将对你的对象的引用保存为一个字段，但也许这个问题可能暗示你正在以错误的方式处理整个事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:00:11.017

如果您知道，这应该可以工作`T`：

```
something.SetDropDownValue(target, DirectCast(value, Nullable(Of T))) 
```

有关详细信息，请参阅[本文](http://www.fmsinc.com/free/NewTips/NET/NETtip6.asp)。

如果你不知道 type `T`，你就有麻烦了，必须在运行时开始使用反射。这很复杂，很危险，而且性能很差。

# python - Python中的机器视觉

> ID：887252
> 
> 赞同：19
> 
> 时间：2009-05-20T10:45:29.297
> 
> 标签：python, matlab, computer-vision

我想使用 Python 执行一些基本的机器视觉任务，我想知道在哪里可以找到帮助我入门的教程。

据我所知，用于机器视觉的 Python 唯一免费库是[PyCV](http://pycv.sharkdolphin.com/)（它显然是[OpenCV](http://opencv.willowgarage.com/wiki/)的包装器），但我找不到任何合适的教程。

我的主要任务是从 FireWire 获取图像。在不同区域分割图像。然后对每个区域进行统计，确定像素面积和质心。

以前，我使用 Matlab 的[图像处理工具箱](http://www.mathworks.com/products/image/)没有任何问题。我想在 Python 中找到等价的函数是[graythresh](http://www.mathworks.com/help/images/ref/graythresh.html)、[regionprops](http://www.mathworks.com/help/images/ref/regionprops.html)和[gray2ind](http://www.mathworks.com/help/images/ref/gray2ind.html)。

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-30T18:48:31.080

OpenCV 可能是你最好的图书馆选择。您可以为它们选择包装器。我查看了标准 OpenCV 安装附带的 SWIG 包装器，但最终使用了[ctypes-opencv](http://code.google.com/p/ctypes-opencv/)，因为内存管理看起来更干净。

它们都是 C 代码的非常薄的包装器，因此您可以找到的任何 C 引用都将适用于 Python。

OpenCV 非常庞大，文档也不是特别完善，但是示例目录中包含一些不错的示例，您可以使用它们来入门。可搜索的 OpenCV API 参考在[这里](http://www.cs.indiana.edu/cgi-pub/oleykin/website/OpenCVHelp/)。

您没有提到您是在寻找在线资源还是印刷资源，但我有[O'Reilly](http://oreilly.com/catalog/9780596516130/)的书，它非常好（C 中的示例，但易于翻译）。

FindContours[函数](http://www.cs.indiana.edu/cgi-pub/oleykin/website/OpenCVHelp/ref/OpenCVRef_Cv.htm#decl_cvFindContours)有点类似于 regionprops；它将为您提供已连接组件的列表，然后您可以对其进行检查以获取其信息。

对于阈值，您可以尝试[Threshold](http://www.cs.indiana.edu/cgi-pub/oleykin/website/OpenCVHelp/ref/OpenCVRef_Cv.htm#decl_cvThreshold)。我确信您可以将标志传递给它以使用 Otsu 的方法，但它似乎没有在文档中列出。

我没有遇到与 gray2ind 对应的特定函数，但它们可能在那里。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T18:34:25.150

文档：几年前，我经常使用为 Python 包装的 OpenCV。OpenCV 有大量文档，附带许多示例，甚至还有一[本书](http://oreilly.com/catalog/9780596516130/)。我使用的 Python 包装器足够薄，因此只需要很少的包装器特定文档（这对于许多其他包装库来说是典型的）。我想花几分钟看一个例子，比如 PyCV 单元测试就是你所需要的，然后你就可以专注于适合你需要的 OpenCV 文档。

分析：至于是否有比 OpenCV 更好的库，我有点过时的观点是，如果你想做相当高级的事情（例如对象跟踪），OpenCV 是很棒的，但它可能对你的需求来说有点过头了。听起来 scipy [ndimage](http://docs.scipy.org/doc/scipy-0.7.x/reference/tutorial/ndimage.html)结合一些基本的 numpy 数组操作可能就足够了。

采集：我所知道的采集选项是 OpenCV、Motmot，或者使用 ctypes 直接连接到驱动程序。其中，我从未使用过 Motmot，因为安装时遇到了麻烦。我发现其他方法相当简单，虽然我不记得细节（这是一件好事，因为这意味着它很容易）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-12T19:33:17.247

我已经建立了一个关于这个主题的网站：[pythonvision.org](http://pythonvision.org "pythonvision.org")。它有一些教程、&c 和一些软件链接。那里有更多的链接和教程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-20T18:39:16.517

You probably would be well served by [SciPy](http://www.scipy.org/). Here is the [introductory tutorial](http://www.scipy.org/Getting_Started) for SciPy. It has a lot of similarities to Matlab. Especially the included matplotlib package, which is explicitly made to emulate the Matlab plotting functions. I don't believe SciPy has equivalents for the functions you mentioned. There are some things which are similar. For example, [threshold](http://docs.scipy.org/doc/scipy-0.7.x/reference/generated/scipy.stsci.image.threshhold.html#scipy.stsci.image.threshhold) is a very simple version of graythresh. It doesn't implement "Otsu's" method, it just does a simple threshold, but that might be close enough.

I'm sorry that I don't know of any tutorials which are closer to the task you described. But if you are accustomed to Matlab, and you want to do this in Python, [SciPy](http://www.scipy.org/) is a good starting point.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T17:20:31.770

我已经使用 .NET 和 IronPython 从 FW 相机获取图像。在 CPython 上，我会检查 ctypes 库，除非您找到任何支持抓取的库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-20T11:33:41.447

我不太了解这个包[Motmot](http://code.astraw.com/projects/motmot/)或它与 OpenCV 的比较，但我已经导入并使用了其中的一两个类。大部分图像处理是通过 numpy 数组完成的，可能与您使用 Matlab 满足您的需求的方式非常相似。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-06T08:45:48.960

前言：这本书更适合那些想要很好地了解计算机或机器视觉的人，尽管它涵盖了最初的问题。

## [书籍]：[**用 Python 编程计算机视觉**](http://programmingcomputervision.com/)

目前，您可以从本书的网站**上免费下载 PDF 格式**的最终​​草稿：

**[http://programmingcomputervision.com/](http://programmingcomputervision.com/)**

从介绍：

本书背后的想法是为实践计算机视觉提供一个易于访问的切入点，并充分了解基础理论和算法，为学生、研究人员和爱好者奠定基础。

你需要知道的

*   基本的编程经验。您需要知道如何使用编辑器和运行脚本、如何构建代码以及基本数据类型。熟悉 Python 或其他脚本风格的语言（如 Ruby 或 Matlab）会有所帮助。
*   基础数学。为了充分利用这些示例，如果您了解矩阵、向量、矩阵乘法、标准数学函数以及导数和梯度等概念，将会有所帮助。一些更高级的数学例子可以很容易地跳过。

你会学到什么

*   使用 Python 对图像进行动手编程。
*   各种现实世界应用背后的计算机视觉技术。
*   许多基本算法以及如何自己实现和应用它们。

# java - 使用java将xml转换为xsd

> ID：887253
> 
> 赞同：2
> 
> 时间：2009-05-20T10:45:32.387
> 
> 标签：java, xml, xsd

我正在寻找可以从 XML 文件生成 XSD 的工具或 java 代码或类库/API。（类似于 .NET Framework sdk 中的 xsd.exe 实用程序）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T14:08:52.123

这些工具可以提供一个很好的起点，但它们不能替代思考实际的模式约束应该是什么。您可能会遇到两种错误：(1) 允许不应该允许的 XML，以及 (2) 不允许应该允许的 XML。

例如，假设您想从包含“性别”标签的数千个患者记录中推断出 XSD（我曾经在医疗记录软件上工作）。该工具可能会遇到“M”和“F”作为值，并可能推断该元素是一个枚举。但是，其他有效（尽管很少使用）值是 B（两者）、U（未知）或 N（无）。当然，这些很少见。因此，如果您使用派生模式作为输入验证器，它会表现良好，直到有多个性器官的患者入院为止。

相反，为避免此错误，XSD 生成器可能不会添加枚举类型限制（我不记得这些在模式中被称为什么），并且您的应用程序会正常工作，直到遇到带有性别 = X 的错误记录。

所以，小心。最好仅将这些工具用作起点。此外，它们往往会产生冗长和冗余的模式，因为它们无法像人类一样找出模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T11:01:49.047

检查[Castor](http://www.castor.org/)，我认为它具有您正在寻找的功能。它们还为您提供了一个从 XML 文件创建 XSD 模式的[ant 任务。](http://www.castor.org/schemaGen-anttask.html)

PS 我建议您以后添加更具体的标签：例如，使用*xml*、*xsd*和*java*将增加获得答案的可能性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-30T21:23:26.243

试试 Google 的 xsd-gen 项目。

[https://code.google.com/p/xsd-gen/](https://code.google.com/p/xsd-gen/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-04T05:57:13.967

您可以使用 xsd-gen-0.2.0-jar-with-dependencies.jar 文件将 xml 转换为 xsd。它的命令是“java -jar xsd-gen-VERSION-jar-with-dependencies.jar /path/to/xml.xml > /path/to/my.xsd”

# .net - 为什么属性 setter 和 getter 会与 get_X 和 set_X 方法发生冲突？

> ID：887255
> 
> 赞同：6
> 
> 时间：2009-05-20T10:46:34.723
> 
> 标签：.net, properties, language-design

在`.NET`属性中应该是一等公民，但是在`IL`代码中，属性 getter 和 setter 被实现为`get_`*PropertyName*和`set_`*PropertyName*。

```
class Property
{
    int Value { get { return 42; } }
    int get_Value() { return 6 * 9; }
    void set_Value(int i) { } // Error even though Value is a read only property
} 
```

**输出：**

> 错误 CS0082：类型“SO.Property”已经保留了一个名为“get_Value”的具有相同参数类型的成员
> 
> 错误 CS0082：类型“SO.Property”已经保留了一个名为“set_Value”的具有相同参数类型的成员

为什么设计者`.NET`决定使用可能与用户代码冲突的名称？他们可能使用了非法字符（正如 Java`$`用于内部类的东西）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T10:49:20.570

对于没有属性概念的语言，例如 J#（这很可能影响了设计决策），仍然需要一个简单的名称来调用它们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-20T10:52:11.313

[公共语言规范](http://msdn.microsoft.com/en-us/library/12a7a7h3.aspx)(CLS) 要求在实现属性时在 IL 中使用 get_ 和 set_ 方法（​​用特殊位装饰）。这是必要的，以便不同的编译器（C#、托管 C++、VB.NET、J#、IronPython 等）创建可互操作的字节码。

因此，下划线**不是**广义上的“合法”字符。它们不符合 CLS，因此不应在非私有接口中使用。

另外，请参阅MSDN 上有关[编写符合 CLS 的代码的这篇文章。](http://msdn.microsoft.com/en-us/library/bhc3fa7f.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T10:48:58.060

因为它们可能需要从外部代码调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T10:48:42.147

好问题 - 大多数编译器生成的成员（匿名类型和方法）使用的名称保证不会与类中的任何成员发生冲突。我认为这个特定的实例（以及为事件方法生成的名称）是微软犯了一点错误的一个例子。

我能想到的唯一理由是微软可能一直希望允许其他语言调用这些本身没有“属性”概念或语法的方法。

# c++ - C++ 模板专业化问题

> ID：887256
> 
> 赞同：1
> 
> 时间：2009-05-20T10:46:47.313
> 
> 标签：c++

我正在尝试实现一个适用于所有类型的通用 toString() 函数。我们所有的内部类都派生自 Abstract，其中包含 toString() 的签名。换句话说，我们所有的内部类都有某种形式的 toString 方法。

问题是，原始类型（int、char、double..）没有本机 toString 函数。但是我们确实有一个实用函数，它调用 lexical_cast 来返回原语的字符串值。我们不想要一大堆 if 语句取决于所以我正在尝试创建一个模板化的实用程序类来完成这项工作。

我的第一个技巧如下：

```
 template<class T>
    class ObjectToString {
    public:
        string objectToString(T value) {
            iil::stringUtils::StringSp ret(stringUtils::valueToString<T>(value));
            return ret;
        }
    };

    template<>
    class ObjectToString <Abstract<T>*> {
    public:
        iil::stringUtils::StringSp objectToString(Abstract<T>* value) {
            return iil::stringUtils::StringSp(new std::string("AAAA"));
        }
    }; 
```

现在的问题是，由于 Abstract 是一个模板类，它需要模板值 T。我不知道如何设置它。有人可以建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-20T10:58:15.793

简单地为 lexical_cast 提供一个专业化怎么样？

```
template<> string lexical_cast(Abstract* obj)
{
  return obj->toString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T10:52:05.230

你的问题是不是简单多了？在所有 Abstract 对象上，您都知道该做什么，因此您只需要为内置类型提供重载函数：

```
string getAsString(Abstract *obj)
{
  return obj->toString();
}

string getAsString(int x)
{
  return intToStr(x);
}

string getAsString(double x)
{
  return doubleToStr(x);
} 
```

等，您可以酌情实施 intToStr() 和 doubleToStr() 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T10:58:51.410

你只是不以 C++ 的方式思考。C++ 已经**有**“toString”，它被`operator<<`称为`std::ostream`. 你需要为你的类实现它。

如果您想支持继承，请执行以下操作：

```
#include <iostream>
#include <boost/lexical_cast.hpp>
#include <string>

class streamable {
public:
    virtual void stream(std::ostream &) const = 0;
};
std::ostream &operator<<(std::ostream &out,streamable const &obj)
{
    obj.stream(out);
    return out;
}

// Now anything derived from streamable can be written to std::ostream
// For example:

class bar : public streamable {
    int x;
    int y;
public:
    bar(int a,int b) : x(a),y(b){}
    virtual void stream(std::ostream &out) const { out<<x<<":"<<y; }
};

int main()
{
    bar b(1,3);
    std::cout<< b << std::endl;

    // and converted to string
    std::string str=boost::lexical_cast<std::string>(b);

    std::cout<< str <<std::endl;
} 
```

这**是**C++ 方式，如您所见，您可以`boost::lexical_cast`免费使用。

编辑你的情况：

```
template<typename T>
class Abstract {
public:
    virtual void stream(std::ostream &) const = 0;
};

template<typename T>
std::ostream &operator<<(std::ostream &out,Abstract<T> const &obj)
{
    obj.stream(out);
    return out;
} 
```

现在如果你不喜欢 boost::lexical_cast，实现起来`string_cast`很简单

```
template<typename T>
std::string string_cast(T const &obj)
{
   std::ostringstram ss;
   ss<<obj;
   return ss.str();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T11:21:52.767

[正如Dobb 博士的这篇文章以及](http://www.ddj.com/article/printableArticle.jhtml?articleID=184401689&dept_url=/cpp/)[Imperfect C++](http://www.imperfectcplusplus.com/)和[Extended STL](http://www.extendedstl.com/)书籍中所描述的，Matthew [Wilson](http://www.blogger.com/profile/08032564940029177259)以*shims*的形式详细处理了这个问题。它们是允许[FastFormat](http://www.fastformat.org/)和[Pantheios](http://www.pantheios.org/)库一般处理参数类型的技术的基础。

# mapping - edi-gentran 有什么用？什么叫做 gentran 中的映射？

> ID：887262
> 
> 赞同：1
> 
> 时间：2009-05-20T10:49:02.833
> 
> 标签：mapping, sap

edi-gentran 有什么用？什么叫做 gentran 中的映射？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-24T19:54:51.010

EDI代表[电子数据交换](http://en.wikipedia.org/wiki/Electronic_Data_Interchange)，是描述组织之间某些结构化数据传输的通用术语。

Gentran 是一种 EDI 工具，可以将数据从一种格式解析和转换为另一种格式（例如 XML、[AS2](http://en.wikipedia.org/wiki/AS2)或[X12](http://en.wikipedia.org/wiki/X12)）。它有一个[业务流程建模语言](http://en.wikipedia.org/wiki/Business_Process_Modeling_Language)组件，可以在其中进行拖放编程。

映射是一个通用术语，用于描述将数据点从一种文档格式匹配到另一种格式。例如，如果我的公司收到一个 AS2 格式的 EDI 请求并且我们在内部使用 XML，我会将 AS2 文档中的字段映射到我的系统可以读取的新 XML 文档。映射的字段可能包括公司订购的零件编号、送货地址等...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-17T18:54:01.027

EDI 基本上是规范的。

许多公司都有自己的系统来处理会计、库存、仓库等。他们希望与合作伙伴进行电子交易，但他们的合作伙伴使用不同的 ERP。EDI 为其中一个系统与另一个系统之间架起了一座桥梁。

映射是用于将文件从 ERP A 所需格式转换为 ERP B 所需格式的定义。

最常见的 EDI 版本和格式由一个委员会标准化，该委员会决定是否需要额外的限定符、循环、段或其他修改。

评论上一个答案，AS2 不是一种格式，而是一种有时用于在合作伙伴之间传输这些文件的协议。

# wpf - 使用 WrapPanel 和 ScrollViewer 在 ListBox 中包装图像，选定项消失！

> ID：887265
> 
> 赞同：2
> 
> 时间：2009-05-20T10:49:28.370
> 
> 标签：wpf, silverlight, listbox, scrollviewer, wrappanel

我正在使用 ListBox 显示 800 个缩略图的水平显示，但一次只能显示 6 个（取决于屏幕分辨率），我想使用列表两侧的按钮在图像中移动。

我目前有这个工作，但是当我将列表框的 SelectedItem 更改为下一个/上一个缩略图时，ScrollViewer 不会自动将 SelectedItem 保留在视图中。6 个缩略图后的 SelectedItem 将消失。

我可以移动 ScrollBar 来查看 SelectedItem，但这还不够好，在最终版本中我什至不想要 ScrollBar，我只希望用户能够按住左或右按钮，然后它会闪过相片。

也只是为了给你我想要这个的原因，每次在 ListBox 上更改 SelectedItem 时，它都会更改上面照片的 FullSize 预览。

Silverlight 2 中是否有确保 ScrollViewer（在 ListBox 中）中的 SelectedItem 保持在可视区域中？

这是 ListBox 的当前 XAML：

```
 <ListBox x:Name="lbPhotos" 
         ItemsSource="{Binding Photos}" 
         SelectedItem="{Binding Path=SelectedPhoto, Mode=TwoWay}" 
         ItemContainerStyle="{StaticResource ReflectionListBoxItemStyle}">

    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <controls:WrapPanel Margin="0" />
        </ItemsPanelTemplate>
    </ListBox.ItemsPanel>

    <ListBox.Template>
        <ControlTemplate>
            <Grid>
                <ScrollViewer VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Hidden" 
                              BorderThickness="0" MaxHeight="170">
                    <ItemsPresenter />
                </ScrollViewer>
            </Grid>
        </ControlTemplate>
    </ListBox.Template>

    <ListBox.ItemTemplate>
        <DataTemplate>
            <Image MaxHeight="85" Source="{Binding ThumbnailUrl, Converter={StaticResource UrlToBitmapImageConverter}}" />
        </DataTemplate>
    </ListBox.ItemTemplate>

  </ListBox> 
```

项目容器样式在这里：

```
<Style x:Key="ReflectionListBoxItemStyle" TargetType="ListBoxItem">
        <Setter Property="Padding" Value="3"/>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Top"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="TabNavigation" Value="Local"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Grid Background="{TemplateBinding Background}">
                        <vsm:VisualStateManager.VisualStateGroups>
                            <vsm:VisualStateGroup x:Name="CommonStates">
                                <vsm:VisualState x:Name="Normal"/>
                                <vsm:VisualState x:Name="MouseOver">
                                    <Storyboard>
                                        <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MainContentBorder" Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)">
                                            <SplineColorKeyFrame KeyTime="00:00:00" Value="{StaticResource PinkColor}"/>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="ReflectionBorder" Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)">
                                            <SplineColorKeyFrame KeyTime="00:00:00" Value="{StaticResource PinkColor}"/>
                                        </ColorAnimationUsingKeyFrames>
                                    </Storyboard>
                                </vsm:VisualState>
                                <vsm:VisualState x:Name="Disabled">
                                </vsm:VisualState>
                            </vsm:VisualStateGroup>
                            <vsm:VisualStateGroup x:Name="SelectionStates">
                                <vsm:VisualState x:Name="Unselected"/>
                                <vsm:VisualState x:Name="Selected">
                                    <Storyboard>
                                        <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="MainContentBorder" Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)">
                                            <SplineColorKeyFrame KeyTime="00:00:00" Value="{StaticResource PinkColor}"/>
                                        </ColorAnimationUsingKeyFrames>
                                        <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Duration="00:00:00.0010000" Storyboard.TargetName="ReflectionBorder" Storyboard.TargetProperty="(Border.BorderBrush).(SolidColorBrush.Color)">
                                            <SplineColorKeyFrame KeyTime="00:00:00" Value="{StaticResource PinkColor}"/>
                                        </ColorAnimationUsingKeyFrames>
                                    </Storyboard>
                                </vsm:VisualState>
                            </vsm:VisualStateGroup>
                            <vsm:VisualStateGroup x:Name="FocusStates">
                                <vsm:VisualState x:Name="Focused">
                                </vsm:VisualState>
                                <vsm:VisualState x:Name="Unfocused"/>
                            </vsm:VisualStateGroup>
                        </vsm:VisualStateManager.VisualStateGroups>
                        <StackPanel Orientation="Vertical" Margin="0,0,4,0">
                        <!-- Image -->
                                <Border HorizontalAlignment="{TemplateBinding HorizontalAlignment}" BorderThickness="3,3,3,2" CornerRadius="1" x:Name="MainContentBorder" VerticalAlignment="{TemplateBinding VerticalAlignment}">
                                    <Border.BorderBrush>
                                        <SolidColorBrush Color="#00000000"/>
                                    </Border.BorderBrush>
                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                </Border>

                                <!-- Image reflection -->
                                <Border RenderTransformOrigin="0.5,0.5" BorderThickness="3,2,3,3" CornerRadius="1" VerticalAlignment="{TemplateBinding VerticalAlignment}" Margin="0,2,0,0" x:Name="ReflectionBorder" HorizontalAlignment="{TemplateBinding HorizontalAlignment}">
                                    <Border.BorderBrush>
                                        <SolidColorBrush Color="#00000000"/>
                                    </Border.BorderBrush>
                                    <Border.OpacityMask>
                                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                            <GradientStop Color="#66000000" Offset="1"/>
                                            <GradientStop Color="#00000000" Offset="0.348"/>
                                        </LinearGradientBrush>
                                    </Border.OpacityMask>
                                    <Border.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform ScaleY="-1"/>
                                        </TransformGroup>
                                    </Border.RenderTransform>
                                    <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}"/>
                            </Border>
                            </StackPanel>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T12:54:23.140

您可以使用传入所选项目的 ScrollIntoView 方法。

[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.listbox.scrollintoview(VS.95).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T10:31:14.783

我最终使用 ScrollViewer.ScrollToHorizo​​ntalOffset 因为 ScrollIntoView 不起作用

# wcf - WcfTestClient，“客户端无法检索服务元数据......”

> ID：887267
> 
> 赞同：5
> 
> 时间：2009-05-20T10:50:00.130
> 
> 标签：wcf, wcftestclient

当我尝试运行 wcftestclient 应用程序时出现此错误：“客户端无法检索服务元数据...”

加载程序时发生这种情况很奇怪；在加载用于选择要连接的服务的 UI 之前。我认为它“有帮助”记住我连接的最后一个服务，不幸的是它不再运行，我不知道它可能是什么（因为当这个错误弹出时 wcftestclient 退出）。

有谁知道它可能在哪里存储这些信息以及我将如何删除它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-24T12:33:45.403

如果从命令行启动应用程序，则传入要测试的服务的 URI 可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-24T13:07:47.060

检查您机器上的此文件夹：

C:\Documents and Settings*User*\Local Settings\Application Data\Temp\Test Client Projects

您所有的客户都保存在那里。

# sifr - sifr 中的重复文本

> ID：887271
> 
> 赞同：0
> 
> 时间：2009-05-20T10:51:00.457
> 
> 标签：sifr

我在 sifr 显示替换的文本和 flash 渲染的文本时遇到问题。所有的 css 文件都正确加载，但是我在 sharepoint 2007 中实现了这个，所以可能是其他东西导致了这个问题。这是我得到的浏览器输出：-

h1 class="large sIFR-replaced" style=""> object id="sIFR_replacement_0" class="sIFR-flash" height="61" width="1238" type="application/x-shockwave-flash" name= "sIFR_replacement_0" data="/Style Library/sifr/cartonnage-alternate.swf" style=""> /object> span id="sIFR_replacement_0_alternate" class="sIFR-alternate">hello hub /h1>

（我已经删除了上述代码左侧的 < 以便它在堆栈溢出时显示）

没有隐藏，对于我的生活，我不明白为什么 - 如果它很明显，我道歉！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T21:30:11.883

`.sIFR-alternate`似乎没有应用隐藏文本的 CSS 。使用 Firebug 检查页面，看看是否是这种情况，或者 CSS 是否与其他内容冲突。

# javascript - JavaScript，循环所有选择？

> ID：887272
> 
> 赞同：2
> 
> 时间：2009-05-20T10:51:01.703
> 
> 标签：javascript, dom

好吧，我是 javascript 的新手，但为什么这不起作用，我要做的就是获取页面上所有选择的列表。

```
var elements = document.getElementsByTagName("select");
alert("there are " + elements.length + " select's");
for (i = 0; i < elements.length; i++)
{
    alert(elements[i].getAttribute('Id'));
} 
```

编辑：错误是它根本没有找到任何选择，elements.length 始终为零！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T11:11:33.817

您是说 elements.length 总是为您返回**0**，这可能是因为：

*   您在页面开头运行 JS 代码，因此 DOM 尚未完全可用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T10:53:28.440

尝试使用`.id`而不是`getAttribute('Id')`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T10:52:58.877

我想获取 id 属性的部分对你不起作用。可能是因为您在那里输入了“Id”而不是“id”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T11:21:53.717

getElementsByTagName 返回零导致文档具有匹配元素的通常原因是它在元素出现在文档中之前运行（通常在节中，而不是在称为 onload 或 onDomReady 的函数内）。

将元素移动到 (END of body!) 标记之前，或使用在 HTML 处理完毕后触发的事件处理程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T10:57:51.240

好吧，据我所知，您页面上的选择可能没有 ID（循环中的警报显示为空）

# asp.net-mvc - 在单元测试控制器动作时提供明确的视图名称？

> ID：887275
> 
> 赞同：2
> 
> 时间：2009-05-20T10:52:01.577
> 
> 标签：asp.net-mvc, unit-testing

Stephen Walther[建议](http://stephenwalther.com/blog/archive/2008/06/17/asp-net-mvc-tip-3-provide-explicit-view-names-when-unit-testing.aspx)您在对它们进行单元测试时提供明确的视图名称。

我当然想测试它们，但我很好奇这个建议在 1.0 版本中是否仍然有效。

在[NerdDinner 教程](http://nerddinnerbook.s3.amazonaws.com/Part12.htm)中，测试只是检查 viewResult 是否为空。他们没有明确指定 viewName，因此它是空的。我想删除在实际代码中作为字符串提供的视图名称，但是这些检查对我来说似乎不太有用......（我什至想不出 viewResult 确实返回 null 的场景？！）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T12:49:09.890

这里真的有两个不同的问题。首先是自从 Stephen Walther 写了会改变推荐的推荐后，MVC 框架中是否有任何改变。这个问题的答案是“不”。

第二个问题是该建议是否是一种好的做法。我在这里不同意斯蒂芬沃尔特的观点。他的例子有点奇怪。他对“索引”动作的单元测试试图断言该动作返回一个明确的视图名称，而显然它没有。如果我编写了这个单元测试，我会断言视图名称等于空字符串。然后单元测试将通过。单元测试不会断言该动作指定了某个名称的视图，而是有效地断言该动作指定该视图与该动作具有相同的名称。这是一个合法的测试。

MVC 框架背后的指导原则之一是约定优于配置。换句话说，您不应该被要求指定任何只是通常的默认值。视图名称的默认值与操作名称相同。WebFormsViewEngine 的记录行为是查找与操作同名的视图，除非指定了单独的视图名称。因此，不指定视图名称与指定“使用默认视图名称”相同。

因此，我认为指定与默认视图名称相同的视图名称不是一个好主意，并且我认为使用单元测试不是违反此约定的好理由。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:03:00.963

如果控制器可以返回各种视图，则提供显式视图名称很重要。然后你可以对控制器进行单元测试，它返回一个它应该按名称返回的控制器。否则 - 我看不出使用它们的意义。

# hibernate - 如何使用 JPA 在 Spring 中减少事务？

> ID：887278
> 
> 赞同：1
> 
> 时间：2009-05-20T10:52:22.577
> 
> 标签：hibernate, spring, jpa, transactions

我有这个代码：

```
run big query: Select all unprocessed objects from table A
for each result
    create or update an output object in table B
    update input object: Set it to "processed" 
```

我想在循环体上有一个事务，即在处理了一行输入之后，应该提交更新的对象，所以当程序中止时，它不会再次处理所有行，而是从错误行开始.

我正在使用 Spring 2.5、Hibernate 3.4 和 JPA（即我有一个`EntityManager`.

我怎么做？我试图`em.getTransaction().commit()`在循环中调用，但 Spring 不允许这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T15:26:39.200

我建议查看 spring 的 TransactionTemplate。[TransactionTemplate 文档](http://static.springframework.org/spring/docs/2.5.x/reference/transaction.html#tx-prog-template)包含的示例准确地解决了您想要实现的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T13:55:32.223

实体管理器读取操作不需要事务。所以我会尝试重构一个内部方法来更新行并将其设置为事务性的。请注意，它需要是一个公共方法才能使用@transactional。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:39:05.603

在不查找 spring 文档并且不知道您的事务设置的情况下：

首先你必须设置一个事务管理器（可能是 HibernateTransactionManager）。然后恕我直言，最好使用 Spring 的 TransactionTemplate 在它自己的事务中运行每个迭代。您必须确保 TransactionTemplate 确实启动了一个新事务，或者在进入该方法时没有任何事务正在运行。

提示之一：使用事务管理器的类名作为调试事务行为的日志类别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T11:14:06.073

您应该使用 Hibernate 的 Session 对象。

有一个 javax.persistence.EntityManager 实例（我想是“em”）：

```
((org.hibernate.Session) em.getDelegate()).beginTransaction(); 
```

更多信息：[https ://www.hibernate.org/hib_docs/v3/api/org/hibernate/Session.html](https://www.hibernate.org/hib_docs/v3/api/org/hibernate/Session.html)

# project-management - 设计应用程序和编码之间的最佳时间平衡是什么？

> ID：887286
> 
> 赞同：3
> 
> 时间：2009-05-20T10:54:57.767
> 
> 标签：project-management

这个问题可能看起来微不足道，但它是一个实际问题：当你在一个项目上工作时，你在真正开始编码之前是否进行了任何类型的*架构设计？*您是否花费大量时间与客户合作以获得详细的规格/用例/模型？

在编码期间，您是否更改了之前做出的那些架构决策？你会带着新的规格/用例/模型回到客户那里吗？

我想知道，根据您的经验，所有这些非编码操作和编码本身之间的良好平衡是什么？

更新：

好的，所以从到目前为止的回答看来，似乎有两种方法：

*   尽早设计，然后坐下来编写代码以避免后期修复
*   尽量减少单独的设计部分，而是进行迭代开发（*敏捷*方法似乎更喜欢这种方式）。

我想走哪条路取决于项目、团队和客户……我说的对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T11:04:28.323

使花费的总时间最小化的；-)

这在很大程度上取决于项目的类型，但一般来说，最好是“浪费”时间过度设计和指定必要条件，而不是稍后发现有问题并一路回来修复它。

我在“The Mythical Man-Month”中读到了一些关于糟糕设计决策影响的定量测量，或者可能在微软出版社的一本名为“Software Requirements Pro Practices”之类的书中，我认为时间浪费在后期修复中（接近产品交付）大约是早期阶段的 10 倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T11:38:15.510

看看 Scrum、敏捷和瀑布。这与项目管理有关，而不是与编程本身有关。

一旦您在域或平台中构建了足够多的应用程序，架构也会变得更容易。在 PHP 中，如果您使用 Joomla、Symfony 或 codeigniter，那么您的脚手架和架构已经到位。与 ASP.NET MVC 相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T10:59:12.093

如果你做敏捷，设计和编码是一回事。以我的经验，在项目的第一阶段结对编程是件好事……

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-29T12:38:41.110

我会说它大约是 50/50，无论“方法”或项目类型如何。仅在这 50% 设计的分布方式上有所不同。这*可能*取决于项目，但*最重要的是取决于做这项工作的人*，以及他们是如何“连接”的。这更多的是心理学问题而不是方法论问题。

有些人（我会说更谨慎的角色）在开始编码之前需要更详细的心理地图。如果他们没有之前的经验，他们将需要更多的“调查”时间。

其他人则喜欢只使用粗略的思维导图“跳入”编码，并在进行时计算出细节。

介于两者之间的是通过尖峰和原型进行详细说明，并在该运行代码之上开发“大图”。对我个人而言，这往往会产生最好的结果，并且浪费最少。（毕竟，原型设计在某种程度上是一种应用于解决方案想法的测试优先方法。你得到一个想法，在峰值或原型中对其进行测试，然后将其与主代码库实现/集成。）

我的建议是：找出你个人感觉最好的风格，并坚持下去。这将非常确定您将最有效的风格。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-02T01:00:50.193

大约 50/50。每当我分析我的项目进度表时，发现大约 50% 的时间用于设计、项目管理、质量控制和辅助任务。剩下的 50% 是编码。如果我没有看到 50/50 的比例，我会担心。

请注意，这是使用传统的瀑布模型（更适合自定义应用程序开发）。在我看来，敏捷方法更适合收缩包装的软件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T22:28:36.923

我的个人经验告诉我，你应该考虑不同的因素。没有灵丹妙药。我的个人名单如下，主要是根据经验增加的。

1.  如果你正在开发的东西在细节上是众所周知的，那么开发团队很稀少，很难一起有效地沟通，这个团队对其他团队的工作有很强或很大的依赖关系，你正在开发的东西有一个基本的长期未来很难改变的重要性（例如文件格式），需要一个很长的设计阶段，类似于瀑布模型。此外，如果您计划开发一个相当复杂的应用程序，您应该花费大量设计，并且您必须在编码之前深入考虑功能之间所有可能的交互。与设计相比，编码花费的时间很少。此外，如果从非常高的角度有效记录应用程序的行为方式很重要，并且如果您的团队往往高度不稳定，您应该考虑这一点，
2.  如果您必须实施全新的东西并进行研究，您希望尽快获得功能，从快速反馈中发展应用程序，您有一群在同一个房间工作的极客，非常致力于您的事业，爱编程，他们热衷于分享和共同构建，选择敏捷方法。
3.  如果您介于前两种情况之间，请采用迭代方法。我通常选择3个月的时间表。当我独自编写代码时，我的工作就像敏捷一样，主要是因为我必须应对频繁的中断，所以我一个接一个地添加功能。但是，我发布迭代，即我不打算在第三次迭代之前发布正式的稳定版本。我想要空间来学习这个领域，犯错误，并在承诺保持一些愚蠢的选择之前纠正它们。
4.  如果你在学术界编码，你就完蛋了，因为你有一些问题 1 没有人力来适应它们，而 2 中的一些问题没有敏捷方法所需的简单沟通。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-20T11:36:25.513

我的 google-fu 彻底失败了，但我最近读到了一些内容：

“花 6 个月的编码、6 个月的设计和 6 个月的测试。好消息是，它们都是一样的 6 个月。”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-20T11:37:34.607

重要的是要设计足够多的地图，以了解您正在尝试编码的内容，以及它与系统其余部分的关系。您不能只编写大多数大型项目的代码——它们太大了，通常涉及多个组件。我年轻的时候做过，结果你得到了一个大泥球，或者熬夜一个星期重构它。

我现在倾向于做的是设计到包级别，并为组件分配角色。在大型系统上，进入组件选择阶段可能需要几个月的时间，并且涉及一些跟踪和原型编码。

然后每个包的 API 和实现会根据功能所需的消息以及包的客户端如何演变以导致进一步的需求或约束的出现而演变。我通常通过为每个已知用例设计带有单元测试的纯接口（通过为其编写代码）来发展 API，然后实现它。因此，在设计中涉及到一些代码编写——API 的最佳表示通常是代码和内联文档，并且最容易确认客户端可以执行满足用例所需的操作（以及执行此操作的代码）并不太复杂）通过编写以这种方式练习 API 的代码，并且该代码在到达时很容易成为 API 实现的单元测试。但是在“设计”期间编写的代码是 t 提供 API 实现的代码。对于低耦合的API（所以可以在不破坏太多客户端的情况下进行更改），我将在设计和实现模式之间快速切换；对于那些耦合度更高的人，我通常会在提交实现它们之前发布 API 和用例示例以供同行评审。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-20T11:03:59.777

这两件事是紧密耦合的。那么在第一阶段，你肯定会花一些时间来做出设计决定。然后您将不得不开始编码，并且几乎在所有情况下，您都会为之前的设计提出一些改进决定。毕竟这将取决于交货日期和你有多少时间，然后相应地决定你将如何平衡它。通常，您进行启动设计，然后在编码期间进行更新和更改。在开发阶段让您的客户深入参与设计决策也是一种很好的做法，以迫使他意识到这一点以及您将在每次更改上花费多少时间。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-20T11:04:34.813

编写规范和开始编码之间的时间越长，需求发生变化的机会就会越大。所以，为了回答你的问题，尽快......

如果您的需求蠕变过多，那么我建议您实施较小的版本迭代（如果可能），然后为每个更小的阶段创建新的需求/规范文档。

如果你不能做到这一点......确保你有一个良好的变更管理流程罪恶的地方。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-20T20:26:29.780

正如 aleemb 所说，这确实是一个项目管理问题。我建议您阅读几种方法，找到每种方法有用和不太有用的部分，并评估您自己的情况（团队规模/经验、客户参与度和承诺水平、您的组织中做了什么、时间表/预算等.) 并想出最好的时间表。这真的完全取决于你的具体情况。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-30T21:30:41.970

想想有多少人将参与编写软件。

如果这只是一个开发人员的工作，可能会在设计方面占较小的比例。如果你打算让 30 个人来工作，那么你可能需要更多的设计部分。

让开发人员团队编写软件很像将软件划分到多个 CPU 上 - 当您可以最大限度地减少他们之间的必要通信时，您将获得增加 CPU 的最佳回报（阅读“开发人员”）。在开发人员开始讨论架构问题之前，您肯定不想在您的项目中加入 10 个 k-loc。

现在您可能还可以提出这样的情况，即当您在设计阶段做得更好时，编码实际上会花费更少的时间和更少的痛苦。测量两次，切割一次，等等。

此外，您可能应该考虑项目被“搁置”的可能性；与不成熟的代码相比，设计工件的保质期要长得多。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-30T22:34:47.037

取决于您选择的方法。
传统上，使用 Big Design Up Front 或 Waterfall，您花费 90% 的时间进行设计和 10% 的时间编码。然后，您又花费 90% 的时间来处理初始设计遗漏的所有更改。还有 90% 的时间都在追逐错误。

通过现代敏捷开发，您将 10% 的时间用于设计，90% 的时间用于编码。然后另外 90% 的时间处理客户代表忘记提及的所有更改，另外 90% 的时间在追踪错误。

# javascript - 使用 javascript 提交多个表单

> ID：887296
> 
> 赞同：1
> 
> 时间：2009-05-20T10:58:15.997
> 
> 标签：javascript

我的脚本：

```
<script language="JavaScript">
function submitform()
{
  document.playsong.submit();
}
</script> 
```

提交以下表格：

```
<form name="playsong" method="post" action="submit.php">
<input type="hidden" name="play" value="2009-05-19-3934.data">
<A href="javascript: submitform()">Play 1</A>
</form> 
```

我怎样才能改变它，以便我可以拥有一系列链接：<`A href="javascript: submitform()">Play 1</A>`这将提交正确的表单，而无需构建一个函数来提交每个表单。

这就是我如何使函数根据单击的链接在页面上提交不同的各种表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T11:03:27.077

考虑：-

```
 function submitForm(form)
 {
      document[form].submit();
 }

 <a href="javascript:submitform('playsong')">Play 1</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:05:15.873

建立几个链接，如

```
<form action="act1">
    <a href="#" onclick="goForm(this.parentNode); return false;">Play 1</a>
</form>
<form action="act2">
    <a href="#" onclick="goForm(this.parentNode); return false;">Play 2</a>
</form>
<form action="act3">
    <a href="#" onclick="goForm(this.parentNode); return false;">Play 3</a>
</form>
<form action="act4">
    <a href="#" onclick="goForm(this.parentNode); return false;">Play 4</a>
</form>
<form action="act5">
    <a href="#" onclick="goForm(this.parentNode); return false;">Play 5</a>
</form> 
```

并制作一个js：

```
function goForm(frm) {
    if (frm != null)
        frm.submit();
} 
```

给你！=´p

# vb.net - 执行内连接

> ID：887300
> 
> 赞同：1
> 
> 时间：2009-05-20T10:59:38.800
> 
> 标签：vb.net, ms-access

我试图做一个内部连接选择语句，我从一个表中选择两个字段，而不是第二个表中与第一个表具有相同 id 的字段的所有记录。

代码如下所示：

```
 Dim conn As OleDbConnection
    Dim cmd As OleDbCommand

    Public Sub openDB()
        rsConn = New ADODB.Connection
        rsConn.Open("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Application.StartupPath & "\VFMS_DB.mdb;" & "Jet OLEDB:System Database=Security.mdw", "ADMIN", "1234")
    End Sub

    Public Function GetProdDetails(ByVal vegeID As Integer, ByRef dsTask As DataSet) As Integer

        Dim retCode As New Integer

        Dim da As OleDbDataAdapter

        Try
            Dim i As Integer = 0

            openDB2()

            da = New OleDbDataAdapter("SELECT [Vegetables Descriptions.Task], [Vegetables Descriptions.Description], [TasksOcc.When] FROM [Vegetables Descriptions] INNER JOIN [TasksOcc] ON [Vegetables Descriptions.DescID] = [TasksOcc.DescID] WHERE [Vegetables Descriptions.VegeID] = vegeID", conn)
            da.Fill(dsTask)

            retCode = 0

            conn.Close()
            Return retCode
        Catch ex As Exception
            MessageBox.Show(ex.ToString, ex.Message, MessageBoxButtons.OK)
            retCode = 1
            Return retCode
        End Try
    End Function 
```

我得到一个例外：“名称 [Vegetables Descriptions.DescID] 的括号无效

如果我把它拿出来让它看起来如下我得到一个“不支持加入表达式”

```
 da = New OleDbDataAdapter("SELECT [Vegetables Descriptions.Task], [Vegetables Descriptions.Description], [TasksOcc.When] FROM [Vegetables Descriptions] INNER JOIN [TasksOcc] ON [DescID] = [DescID] WHERE [Vegetables Descriptions.VegeID] = vegeID", conn) 
```

我尝试从网上学习示例，但没有成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T11:02:18.983

使用`[Vegetables Descriptions].[DescID]`而不是`[Vegetables Descriptions.DescID]`. 由于“蔬菜描述”包含一个空格，因此它必须是`[]`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T11:04:09.680

为便于阅读而换行：

```
da = New OleDbDataAdapter("
  SELECT [Vegetables Descriptions].[Task], 
         [Vegetables Descriptions].[Description], 
         [TasksOcc].[When] 
  FROM   [Vegetables Descriptions] INNER JOIN [TasksOcc] 
         ON [Vegetables Descriptions].[DescID] = [TasksOcc].[DescID] 
  WHERE  [Vegetables Descriptions].[VegeID] = vegeID
", conn) 
```

每个*标识符*都放在方括号中，而不是每个完整的名称。

顺便说一句：带有空格的表名是......嗯......他们不是我会做的。;-)

编辑：这在眼睛上更容易（您需要对仅具有“非标准”名称的表标识符使用方括号，并且您可以使用别名）：

```
da = New OleDbDataAdapter("
  SELECT d.Task, 
         d.Description, 
         t.When
  FROM   [Vegetables Descriptions] AS d INNER JOIN TasksOcc AS t
         ON d.DescID = t.DescID
  WHERE  d.VegeID = vegeID
", conn)         ''#  ^
                 ''#  |
                 ''#  /----- Not sure what this does in this query, though. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:06:54.917

插入这个：

`da = New OleDbDataAdapter("SELECT Descriptions.Task, Descriptions.Description, TasksOcc.When FROM Descriptions INNER JOIN TasksOcc ON TasksOcc.DescID = Descriptions.DescID WHERE Descriptions.VegeID = " & vegeID, conn)`

# javascript - 使用 JavaScript 在文本字符串中插入隐藏字符

> ID：887301
> 
> 赞同：3
> 
> 时间：2009-05-20T10:59:54.167
> 
> 标签：javascript

如何使用 JavaScript 在文本字符串中使用隐藏字符。我读取并写回了一个文本字符串，其中包含隐藏字符（因此重写的文本看起来与原始文本相同，尽管它包含隐藏字符），所以接下来当我阅读该文本时，我可以知道该文本已被阅读，因为它包含隐藏字符

例如）

```
< html>
< body>
< div>
This is a simple text
< /div>
< /body>
< /html> 
```

我正在尝试解析 div 并提取 div 的内容，并在文本中插入一个隐藏字符并使用 JavaScript 再次将文本重写为 div。

我只想知道我应该使用哪个隐藏字符插入到文本中？如何将隐藏字符写入文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T11:10:10.713

既然您使用的是 javascript，为什么不向 div 添加一个属性：-

```
var divs = document.getElementByTagName("div");
for (var i = 0, length = divs.length; i < length; i++)
{
    if (!divs[i].hasBeenRead)
    {       
         fnReadDiv(divs[i]);
         divs[i].hasBeenRead = true;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:06:43.420

要回答这个问题，请保留已遍历的 div 数组：

```
var divsChecked = [];
//code that looks at the div
divsChecked.push(div.getAttribute('id')); 
```

但是，我认为您用来遍历项目的方法可能与 jQuery 之类的库不正确，您可以依次循环遍历每个 div，因此除非您运行循环两次，否则您永远不会看到相同的 div 两次。

# javascript - 从标签获取href值

> ID：887307
> 
> 赞同：10
> 
> 时间：2009-05-20T11:01:25.723
> 
> 标签：javascript, html, href

 我有以下html：

```
<div class="threeimages" id="txtCss">  
<a>   
       <img alt="Australia" src="/Images/Services%20button_tcm7-9688.gif"/>
</a>        
    <div class="text" id="txtLink">            
        <h2>
            <a href="/partnerzone/downloadarea/school-information/australia/index.aspx">Australia</a>
        </h2>            
        <p>Land of the sunshine!</p>        
    </div>
</div> 
``` 

现在，如果您看到 div ID“txtLink”中有 href，即[澳大利亚](/partnerzone/downloadarea/school-information/australia/index.aspx)

我希望在页面运行时将相同的href值复制到div ID“txtCss”的上面标签中，我的意思是当我的页面显示时，我的html将如下所示：

```
<div class="threeimages" id="txtCss">  
<a href="/partnerzone/downloadarea/school-information/australia/index.aspx">   
       <img alt="Australia" src="/Images/Services%20button_tcm7-9688.gif"/>
</a>        
    <div class="text" id="txtLink">            
        <h2>
            <a href="/partnerzone/downloadarea/school-information/australia/index.aspx">Australia</a>
        </h2>            
        <p>Land of the sunshine!</p>        
    </div>
</div> 
```

请为上述问题提出一些代码

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-20T11:12:41.753

这是不使用任何库的最短答案，并且只适用于您想要的东西

```
var tc = document.getElementById("txtCss");
var ary = tc ? tc.getElementsByTagName("a") : [];
if(ary.length >= 2)
    ary[0].href = ary[1].href; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-20T11:06:37.103

**更新**
这里没有 jquery 的答案：[https](https://stackoverflow.com/a/887348/11333)
://stackoverflow.com/a/887348/11333 早在 2009 年，使用 jquery 是完全可以接受的:)

使用以下内容创建一个 js 文件：

```
$(document).ready(function() {
    $('.threeimages').each(function(){
    $(this).DupeHref();
    });
});

jQuery.fn.DupeHref =  function(){       
    var target = $(this).find(".text h2 a").attr("href");
    $(this).find("a").attr("href", target);
} 
```

在你的 html 中引用 jquery 和这个 javascript 文件。像这样的东西：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Test</title>         
    </head>
    <body>
        <div class="threeimages">  
            <a>   
                <img alt="Australia" src="/Images/Services%20button_tcm7-9688.gif"/>
            </a>        
            <div class="text">            
                <h2>
                    <a href="/partnerzone/downloadarea/school-information/australia/index.aspx">Australia</a>
                </h2>            
                <p>Land of the sunshine!</p>        
            </div>
        </div>
        <div class="threeimages">  
                     <a>   
                <img alt="Belgium" src="/Images/Services%20button_tcm7-9689.gif"/>
            </a>        
            <div class="text">            
                <h2>
                        <a href="/partnerzone/downloadarea/school-information/belgium/index.aspx">Belgium</a>
                </h2>            
                <p>Land of beer and food!</p>        
            </div>
        </div>
        <script src="./content/js/jquery-1.2.6.min.js" type="text/javascript"></script>
        <script src="./content/js/dupetargets.js" type="text/javascript"></script>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T12:38:52.470

这是一个简单易懂的代码：

```
 <html>
  <head>
   <script language="javascript">  
  function simpleChangeURL(){
        var anchors = document.getElementsByTagName('a');
        if(anchors != null & anchors.length > 0){
            anchors[0].href = anchors[1].href;  
        }   
    }

    function simpleChangeByAustraliaURL()
    {
        var anchors = document.getElementsByTagName('a');
        var images = document.getElementsByTagName('img');
        var imageNeeded;
        var anchorNeeded;
        if(images != null){
            for( var i = 0; i < images.length ; i++){
                if (images[i].alt == 'Australia') imageNeeded = images[i];
            }
        }
        if(anchors != null){
            for( var j = 0; j < anchors.length ; j++){
                if (anchors[j].firstChild.data == 'Australia') anchorNeeded = anchors[j];
            }
        }
        if(imageNeeded != null && anchorNeeded!= null){
    var imageAnchor = imageNeeded.parentNode;
    imageAnchor.href = anchorNeeded;

}

    }

    </script>
    </head>

    <body>
    <div class="threeimages" id="txtCss">  
    <a>   
           <img alt="Australia" src="/Images/Services%20button_tcm7-9688.gif"/>
    </a>        
        <div class="text" id="txtLink" >            
            <h2>
                    <a href="/partnerzone/downloadarea/school-information/australia/index.aspx">Australia</a>
            </h2>            
            <p>Land of the sunshine!</p>        
        </div>
    </div>
    <script> simpleChangeByAustraliaURL();</script>
    </body>
    </html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T11:10:38.653

您可以使用：

```
var txtLink = document.getElementById('txtLink');
var a = txtLink.getElementsByTagName('a');
if (a != null && a.length > 0) {
    var setLink = txtLink.parentNode.getElementsByTagName('a');
    if (setLink != null && setLink.length > 0) {
        setLink[0].href = a[0].href;
    }
} 
```

我认为这应该工作..

# javascript - 如何让 clientX 和 clientY 在 Firefox 上的“拖动”事件处理程序中工作？

> ID：887316
> 
> 赞同：11
> 
> 时间：2009-05-20T11:04:13.707
> 
> 标签：javascript, events, drag-and-drop, firefox-3

Mozilla Firefox 3.x 在监听“ondrag”事件时似乎有一个错误。事件对象不报告被拖动对象的位置，`clientX`，`clientY`，和其他屏幕偏移都设置为零。

这是相当有问题的，因为我想根据被拖动和使用的元素制作代理元素，`clientX`并`clientY`调整它的位置。

我知道有一些很酷的东西，比如`setDragImage`在 HTML5 中，但我想为浏览器之间的本地 DD 提供一个通用抽象。

错误代码：

```
document.addEventListener('drag', function(e) {
    console.log(e.clientX); // always Zero
}, false); 
```

笔记：

此问题不会发生在其他事件（`dragstart`, `dragover`）上，并且`mousemove`在拖动某些东西时无法捕获事件。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-23T20:00:51.480

我找到了一个解决方案，我在文档级别的“dragover”事件上放置了一个侦听器，现在我获得了可以通过全局共享对象公开的正确 X 和 Y 属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T11:14:56.430

HTML 5 中的拖动事件在当今的浏览器中并不能完全发挥作用。要模拟拖放情况，您应该使用：

1.  添加一个 onmousedown 事件，设置一个 var true。
2.  添加一个 onmouseup 事件，将该 var 设置为 false。
3.  添加一个 onmousemove 事件，检查该变量是否为真，如果是，则根据坐标移动 div。

这一直对我有用。如果您遇到任何问题，请再次联系，我可以提供一些示例。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:35:02.193

> 我知道有一些很酷的东西，例如 HTML5 中的 setDragImage，但我想为浏览器之间的本地 DD 提供一个通用抽象。

但是为什么要做这样的事情，难道没有像[JQuery](http://jquery.com/) & [Prototype](http://www.prototypejs.org/)这样的库可用于跨浏览器拖放吗？

或者，如果您想实现自己的 DD 库，您可以借助他们的方法或扩展它们，因为这两个库都遵循面向对象的范例。

这将节省很多时间。

# design-patterns - 单态与单态

> ID：887317
> 
> 赞同：52
> 
> 时间：2009-05-20T11:04:24.033
> 
> 标签：design-patterns, language-agnostic, singleton

什么情况下会使用单态模式而不是单例来维护全局对象？

编辑：我知道单例模式和单态模式是什么。在很多场景中也实现了 Singleton。只想知道需要实现 MonoState 模式的场景（案例）。

例如。我需要在我的 Windows 窗体应用程序中维护每个屏幕的列列表。在这种情况下，我可以使用单例字典。但是，我将 List 存储在静态全局变量中，并且我想提供索引器（因为如果键不存在，我需要动态地将新条目添加到列表中），我可以将 ScreenDetails.ScreenName 指定为键并获取 ScreenDetails .ColumnsTable。由于索引器无法对静态类进行操作，因此我将模式更改为 Monostate。

所以我想知道哪些其他场景可能会迫使用户使用 Monostate 而不是 Singletons。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-05-20T11:23:49.657

monostate 和 singleton 是同一个奖牌的两个面（全局状态）：

*   单态强制一种**行为**（所有类实例中只有一个值）
*   单例强制**结构约束**（只有一个实例）

## 单例使用不透明

IE：

```
Singleton singleton = Singleton.getInstance(); 
```

## 单态使用是透明的

即：MonoState m1 = new MonoState(); MonoState m2 = 新的 MonoState(); // 与 m1 相同的内部状态（例如静态）

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-05-20T11:16:26.990

以下是*Robert C. Martin*对此的看法：[Singleton vs. Monostate (pdf)](http://staff.cs.utu.fi/~jounsmed/doos_06/material/SingletonAndMonostate.pdf)

> SINGLETON 最适用于您想要通过派生来约束现有类的情况，并且您不介意每个人都必须调用 instance() 方法才能获得访问权限。当您希望类的单一性质对用户透明，或者当您希望使用单个对象的多态派生时，最好使用 Monostate。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-07-24T15:33:35.607

在它的基础上，Monostate 只是 Singleton 周围的语法糖。当您开始子类化时，Monostate 变得有趣，因为子类可以用不同的行为装饰共享状态。

一个简单的——如果有点做作而且效率不高:)——例子：

```
public class GlobalTable implements Iterable<Key> {

  /** Shared state -- private */    
  private static final Map<Key, Value> MAP = new LinkedHashMap<Key, Value>();

  /** Public final accessor */    
  public final Value get(Key key) {
    return MAP.get(key);
  }

  /** Public final accessor */    
  public final boolean put(Key key, Value value) {
    return MAP.put(key);
  }

  /** Protected final accessor -- subclasses can use this to access
      the internal shared state */    
  protected final Set<Key> keySet() {
    return MAP.keySet();
  }

  /** Virtual -- subclasses can override for different behavior */    
  public Iterator<Key> iterator() {
    return Collections.unmodifiableSet(MAP.keySet()).iterator();
  }
} 
```

现在如果我们想要索引访问怎么办？

```
public class IndexedGlobalTable extends GlobalTable {

  public List<Key> getKeysAsList() {
    return Collections.unmodifiableList(new ArrayList<Key>(keySet()));
  }

  public Key getKeyAt(int index) {
    return getKeysAsList().get(index);
  }

  public Value getValueAt(int index) {
    return get(getKeyAt(index));
  }
} 
```

排序键怎么样？

```
public class SortedGlobalTable extends GlobalTable {

  @Override
  public Iterator <Key> iterator() {
    return Collections
      .unmodifiableSortedSet(new TreeSet<Key>(keySet())).iterator();
  }

} 
```

每当您需要数据的一个或另一个视图时，您只需实例化适当的子类。

当然，首先全局数据是否真的是一个好主意是另一个问题，但至少 Monostate 为您提供了更多使用它的灵活性。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-06-04T11:58:59.337

有人应该注意到单例和单态是极其危险的模式。他们往往会被懒惰的程序员滥用，他们不想考虑他们想要制作成单例的对象的生命周期。它们使测试变得更加困难，并创建了紧密绑定的不灵活系统。

真正需要单身或单态的情况极为罕见。对象协作的首选方法是依赖注入。

关于这个已经写了很多：

*   [accu 单例反模式文章](http://accu.org/index.php/journals/337)
*   [斯科特·登斯莫尔谈单身者是邪恶的](http://blogs.msdn.com/scottdensmore/archive/2004/05/25/140827.aspx)
*   [关于单例的堆栈重载](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-05-16T12:22:07.940

两种模式之间的区别在于行为与结构之一。SINGLETON模式强制执行奇**点**结构。它可以防止创建一个以上的实例。而**MONOSTATE**在不施加结构约束的情况下强制执行奇点行为。

**SINGLETON 的好处**

*   适用于任何班级。您可以将任何类更改为 SINGLETON，只需将其构造函数设为私有并添加适当的静态函数和变量即可。
*   可以通过派生来创建。给定一个类，您可以创建一个 SINGLETON 的子类。
*   懒惰的评价。如果从未使用过 SINGLETON，则永远不会创建它。

**SINGLETON的成本**

*   破坏是未定义的。没有很好的方法来销毁或停用 SINGLETON。如果您添加使实例无效的停用方法，系统中的其他模块可能仍持有对 SINGLETON 实例的引用。对 Instance 的后续调用将导致另一个实例被创建，从而导致两个并发实例存在。

*   不继承。从 SINGLETON 派生的类不是单例。如果它需要是 SINGLETON，则需要添加静态函数和变量。

*   效率。对 Instance 的每次调用都会调用 if 语句。对于大多数这些调用，if 语句是无用的。

*   不透明。SINGLETON 的用户知道他们正在使用 SINGLETON，因为他们必须调用 Instance 方法。

**MONOSTATE 的好处**

*   透明度。MONOSTATE 用户的行为与常规对象的用户没有什么不同。用户不需要知道对象是 MONOSTATE。

*   可推导性。单态的衍生物是单态。事实上，一个 MONOSTATE 的所有衍生物都是同一个 MONOSTATE 的一部分。它们都共享相同的静态变量。

*   多态性。由于 MONOSTATE 的方法不是静态的，它们可以在派生中被覆盖。因此，不同的导数可以在同一组静态变量上提供不同的行为。

*   定义明确的创造和毁灭。MONOSTATE 的变量是静态的，具有明确定义的创建和销毁时间。

**MONOSTATE 的费用**

*   没有转换。普通类不能通过派生转换为 MONOSTATE 类。

*   效率。一个 MONOSTATE 可能会经历许多创建和破坏，因为它是一个真实的对象。这些操作通常成本高昂。

*   在场。MONOSTATE 的变量会占用空间，即使从未使用过 MONOSTATE。

敏捷软件开发、原则、模式和实践 Robert C. Martin

# c# - 使用Linq的数据库表中的唯一字符串列表？

> ID：887327
> 
> 赞同：4
> 
> 时间：2009-05-20T11:07:31.437
> 
> 标签：c#, sql-server, linq

我有一个具有以下结构的“票证”表（删除了不必要的列）

```
整数 | 字符串 | 整数 |
身份证 | 窗口 | 计数 |
----------------------
0 | 互联网 | 10 |
1 | 电话 | 20 |
2 | 传真 | 15 |
3 | 传真 | 10 |
4 | 互联网 | 5 |
. | . | . |
. | . | . |

```

我已将此表映射到“票证”类。所以我可以得到这样的所有记录：

```
var ticket = 来自 db.Tickets 中的 t
              选择 t;

```

现在我需要获取表中唯一窗口名称的列表。对于上表，列表看起来像：

*   互联网
*   电话
*   传真

无论如何创建此列表而不获取所有记录并对其进行迭代？

我使用的是 SQL Server 2008 速成版。

编辑：感谢他们解决了上述问题的答案。只是贪婪，但有什么办法*也*可以获得每个窗口的总数。例如：

*   互联网 = 15
*   电话 = 25
*   传真 = 20

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-20T11:10:29.280

怎么样：

```
var tickets = db.Tickets.Select(t => t.Window).Distinct(); 
```

我更喜欢仅在执行多个操作时使用查询表达式，但如果您喜欢它们，则等效的是：

```
var tickets = (from t in db.Tickets
               select t.Window).Distinct(); 
```

要获得计数，您需要分组：

```
var tickets = from t in db.Tickets
              group t by t.Window into grouped
              select new { Window=grouped.Key, 
                           Total=grouped.Sum(x => x.Count) };

foreach (var entry in tickets)
{
    Console.WriteLine("{0}: {1}", entry.Window, entry.Total);
} 
```

请注意，这一切都应该最终在数据库端执行 - 检查 SQL 查询以检查这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T11:13:15.467

```
 var query2 = from ticket in db.tickets 

 group window by ticket.Window into result
 select new
 {
     Name = result.Window,
     Sum = result.Sum(i => i.Count)
 }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T11:10:11.323

Bill Wagner 的[Linq Samples Part 11应该可以帮助您。](http://srtsolutions.com/blogs/billwagner/archive/2006/04/10/linq-samples-part-11.aspx)只需`Distinct()`在您的 Linq 结果上调用该函数。就这么简单。

```
var tickets = (from t in db.Tickets
               select t).Distinct(); 
```

**[编辑]**

关于出现次数，[请参阅此示例](http://msdn.microsoft.com/en-us/vcsharp/aa336754.aspx#simple1)作为提示。

```
 int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 5 };

        var numberGroups =
            from n in numbers
            group n by 5 into g
            select g;

        g.Count(); // occurences 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T11:12:38.650

查询将在商店内进行评估。

```
var windows = db.Tickets.Select(ticket => ticket.Window).Distinct(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T11:10:31.900

您可以使用 .Distinct() 运算符 - 它会对数据库进行 SELECT DISTINCT 操作，准确给出您的要求。

# google-app-engine - App Engine 中的 favicon.ico“未找到错误”

> ID：887328
> 
> 赞同：50
> 
> 时间：2009-05-20T11:07:47.897
> 
> 标签：google-app-engine, favicon

我正在尝试在 Google App Engine 上进行开发，并且在管理控制台中显示的错误列表中，我总是看到以下内容：

> /favicon.ico

我阅读了文档，添加了一个名为 static 的新文件夹并将其添加到我的 app.yaml 中：

```
- url: /favicon.ico
       static_files: static/favicon.ico
       upload: static/favicon.ico 
```

但即使现在我也遇到了同样的错误......

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-05-21T08:44:15.963

此条目应放在主处理程序的条目*之前*，例如：

```
- url: /favicon.ico
  static_files: media/img/favicon.ico
  upload: media/img/favicon.ico

- url: /robots.txt
  static_files: media/robots.txt
  upload: media/robots.txt

- url: .*
  script: main.py 
```

条目按外观顺序处理，第一个匹配的将*获胜*。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-01-19T20:14:52.350

**如果您在 Java 中执行此操作，我通过在“war”目录中放置一个空白的“favicon.ico”文件来消除错误。**

如果你想自己制作又快又丑的“favicon.ico”文件，这个网站超级好用： http: [//www.favicon.cc/](http://www.favicon.cc/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-20T11:10:53.257

对于您的应用程序，favicon.ico 应该是静态图像。您可以将 favicon.ico 文件与您的应用程序一起上传，并在您的 app.yaml 文件中配置您的应用程序以在请求 url /favicon.ico 时提供图像。下面是 /favicon.ico 的 app.yaml 文件中的示例条目。我们假设您在目录路径 static/images 中包含 favicon.ico 文件：

```
- url: /favicon.ico
  static_files: static/images/favicon.ico
  upload: static/images/favicon.ico 
```

写[在这里](http://code.google.com/intl/nl/appengine/kb/general.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-22T03:53:02.077

我在 GAE 应用程序配置中使用此代码段：

```
handlers:

  - url: /(.*\.(ico|png|webmanifest))$
    static_files: faviconfiles/\1
    upload: faviconfiles/.*\.(ico|png|webmanifest)$ 
```

然后我将相应的文件集（这些天如果你真的想设置一个“favicon”它是一组文件，包括例如`apple-touch-icon.png`）放入`./faviconfiles`我的`app.yaml`.

# javascript - 你能在 javascript 的 print() 函数中添加参数吗

> ID：887340
> 
> 赞同：7
> 
> 时间：2009-05-20T11:11:11.960
> 
> 标签：javascript

我正在寻找一种在打印函数上添加参数的方法，因为我只需要打印表格，当我提醒表格时它会显示正确的值，但是当我打印时它会打印整个页面。

我的代码是

```
aa = document.getElementById('tablename').innerHTML 
```

如果`alert(aa)`它给了我写入值，那么`print(aa)`它给了我整个页面。所以我尝试了`print(aa)`，`aa.print`但它不起作用。

有谁知道这个的解决方案？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-20T19:49:47.467

打印样式表很好，但您仍然可以在 Javascript 中完成此操作。只需将要打印的值传递给以下函数...

```
function printIt(printThis) {
  var win = window.open();
  self.focus();
  win.document.open();
  win.document.write('<'+'html'+'><'+'body'+'>');
  win.document.write(printThis);
  win.document.write('<'+'/body'+'><'+'/html'+'>');
  win.document.close();
  win.print();
  win.close();
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-20T11:14:59.457

定义一个只显示表格的打印样式表。

*   [http://www.webcredible.co.uk/user-friendly-resources/css/print-stylesheet.shtml](http://www.webcredible.co.uk/user-friendly-resources/css/print-stylesheet.shtml)
*   [http://www.alistapart.com/articles/goingtoprint/](http://www.alistapart.com/articles/goingtoprint/)

它没有必要是动态的。

只需将那些您不想看到的部分定义为 display:none （如 alistpart 文章中所述）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-08-06T11:03:23.267

我们可以使用 PDF 中的表格视图实现您要求的功能，如下所示，在我的情况下，我给出了 table id="tableId" 然后用我们需要的 Table 替换了该页面数据：

```
printTarget(tableId) {
    let divToPrint = document.getElementById('tableId');
    let htmlToPrint = 
        '<style type="text/css">' + 
        'table {'+'font-family: arial, sans-serif;'+ 
        'border-collapse: collapse;'+'width: 95%;'+ 
        'margin-left: 20px'+'}'+   
        'th, td {' +
        'border:1px solid #000;' +
        'padding: 8px;' +
        '}'+ 'tr:nth-child(even) {'+
        'background-color: #dddddd;'+'}'+
        '</style>';
    htmlToPrint += divToPrint.outerHTML;
    let windowToPrint = window.open("");    
    windowToPrint.document.write(htmlToPrint);
    windowToPrint.print();
    windowToPrint.close();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T11:14:40.520

不，你不能。

您可以做的是动态修改打印媒体样式表并显示：没有您不想要的元素。

[YUI StyleSheet](http://developer.yahoo.com/yui/stylesheet/)可能会对此有所帮助。

# netbeans - 身份证号码生成

> ID：887342
> 
> 赞同：0
> 
> 时间：2009-05-20T11:11:31.303
> 
> 标签：netbeans, netbeans6.5

我正在尝试在 NetBeans IDE 6.5 中为我的系统编写代码，以便为我自动生成 ID 号，例如 Ms Access 中的自动编号。有没有人对此有任何想法？我的意思是它的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T23:09:18.047

If you're using Oracle, you will need a sequence for each table.

once you have the sequence you can create a trigger like this:

```
Create or Replace trigger incrementOnInsert
before insert on TABLE
for each row
begin
    select sequence.nextval into :new.id from dual;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:35:19.493

如果您使用的是 JavaDB，则需要在语句中的字段上使用该[`GENERATED AS IDENTITY`选项。](http://developers.sun.com/docs/javadb/10.4.2.1/ref/rrefsqlj37836.html#rrefsqlj37836)`CREATE TABLE`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:39:04.243

在 Windows API 中，您可以创建一个 Guid。我确信 Netbeans 有一些类似的[UID API](http://en.wikipedia.org/wiki/Universally_Unique_Identifier)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T11:18:22.540

你用的是什么数据库系统？如果它是基于 SQL 的：

```
CREATE TABLE $tblname (id int(10) NOT NULL auto_increment PRIMARY KEY (id)) 
```

尝试使用 auto_increment ，例如上面的示例。

# actionscript-3 - 控制加载的 swf 的 FPS

> ID：887345
> 
> 赞同：1
> 
> 时间：2009-05-20T11:12:18.557
> 
> 标签：actionscript-3, flash

我正在开发一个加载多个 swf 的 Flash 应用程序。但问题是它们有不同的帧速率（12/25/30）。如果我添加 2 个 swf，它们都以 25fps 的速度播放。我发现了很多关于这个的话题，但我无法让它工作（在 AS3 中）。有谁知道它为什么不起作用以及如何使它起作用？

```
public class MainClass extends MovieClip 
    {
        var loader:Loader = new Loader();
        var request:URLRequest;

        var mcMedia:MovieClip = new MovieClip();

        MovieClip.prototype.setFrameRate = function(frameRate:Number)
        {
            var mc:MovieClip = this;
            if (mc.tweenFaster != null)
            {
                Timer(mc.tweenFaster).stop();
            }
            mc.tweenFaster = new Timer(1000/frameRate);
            mc.tweenFaster.addEventListener(TimerEvent.TIMER, timelineFaster);
            mc.tweenFaster.start();

            function timelineFaster(event:TimerEvent = null)
            {               
                if (mc.currentFrame == mc.totalFrames)
                {
                    mc.tweenFaster.stop();
                    mc.gotoAndStop(1);
                }
                else
                {
                    trace(mc.currentFrame);
                    mc.nextFrame();
                }                           

                event.updateAfterEvent();
            }
        }

        public function MainClass() 
        {
            configureListeners();
            request = new URLRequest("data/7/7.swf");

            try 
            {
                loader.load(request);
            } 
            catch (error:Error) 
            {
                trace("Unable to load requested document.");
            }
        }

        private function configureListeners():void 
        {           
            loader.contentLoaderInfo.addEventListener(Event.COMPLETE, completeHandler);
            loader.contentLoaderInfo.addEventListener(Event.OPEN, openHandler);
            loader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, progressHandler);
            loader.contentLoaderInfo.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityErrorHandler);
            loader.contentLoaderInfo.addEventListener(HTTPStatusEvent.HTTP_STATUS, httpStatusHandler);
            loader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
        }

        private function completeHandler(event:Event):void 
        {
            loader.content.scaleX = 550/event.target.width;
            loader.content.scaleY = 400/event.target.height;
            mcMedia.addChild(loader);
            mcMedia.setFrameRate(12);
            addChild(mcMedia);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T13:13:47.190

在 as3 中，如果您只是想更改帧率，请使用 stage.frameRate = 12; 管他呢;

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Stage.html#frameRate](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/display/Stage.html#frameRate)

在 AS3 中，虽然您*可以*使用原型，但通常不能。我会重写你的 setFrameRate 函数（它的名字很糟糕，不应该是更多.. tweenFaster，还是 matchFrameRate 什么的？）

我会做一个这样的辅助函数：

```
package util{

//imports

public class TweenFasterMC extends MovieClip{

   public var mc:MovieClip;

   public function matchFrameRate(frameRate:Number):void
   {
                if (tweenFaster != null)
                {
                        Timer(mc.tweenFaster).stop();
                }
                tweenFaster = new Timer(1000/frameRate);
                tweenFaster.addEventListener(TimerEvent.TIMER, timelineFaster);
                tweenFaster.start();

    }

    function timelineFaster(event:TimerEvent = null):void
    {                               
                        if (currentFrame == totalFrames)
                        {
                                tweenFaster.stop();
                                gotoAndStop(1);
                        }
                        else
                        {
                                trace(currentFrame);
                                nextFrame();
                        }                                                       

                        event.updateAfterEvent();
    }

} 
```

此外，清理您的事件侦听器，如果您有很多 mc 应用此功能，那么强大的计时器事件侦听器将导致很多问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T13:47:07.137

As far as I know all MovieClips in one flash player instance (sharing the same 'stage') will run at the same speed - there is no way to have two clips running at different speeds. So to adjust the speed you have to resort to calling gotoAndStop() on all MovieClips in the loaded clip at the right time - that won't be fun.

Code along the lines that quoo is showing will only work if the loaded swf contains just 1 MovieClip (no nesting) as far as I can see.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-03T03:36:46.287

真的很麻烦，我一直在网上寻找答案。我有粒子跟随路径，我想动态改变这些粒子跟随路径的速度，而不改变整个电影。只是粒子影片剪辑。

我已经尝试过greensock，但是，这并没有像我需要的那样真正起作用..我认为您可以为每个mc动态更改一些东西，但是没有骰子。

stage.frameset 仅适用于整部电影...... arggggggg ......糟透了......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T17:19:25.960

在我看来，这不起作用的最可能原因是它要求您加载的每个剪辑都是一个简单的、完全非动态的动画，并且永远循环。如果加载的内容如此简单，为什么不将其调整为在 30fps 时看起来更好呢？（如果它非常长，JSFL 脚本可以自动执行添加额外帧的过程。）或者，如果内容*不是*那么简单，那么尝试通过`nextFrame`从其他地方调用来改变它的时间不会给你想要的东西。

综上所述，如果您确定这是您想要做的，但您`currentFrame`在加载的内容中得到 0 作为回报，您确定它们是 AS3 SWF 吗？如果不是，那么 AS3/AS2 互操作是一个值得阅读的棘手主题。

# python - 在python中同步多个线程

> ID：887346
> 
> 赞同：6
> 
> 时间：2009-05-20T11:12:34.813
> 
> 标签：python, multithreading, synchronize

我有一个问题，我需要`x`线程等到它们都达到同步点。我的解决方案使用`synchronise`下面的方法，每个线程函数在需要同步时调用该方法。

有一个更好的方法吗？

```
thread_count = 0
semaphore = threading.Semaphore()
event = threading.Event()

def synchronise(count):
    """ All calls to this method will block until the last (count) call is made """
    with semaphore:
        thread_count += 1
        if thread_count == count:
            event.set()

    event.wait()

def threaded_function():
    # Do something

    # Block until 4 threads have reached this point
    synchronise(4)

    # Continue doing something else 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T11:40:53.163

您想要的功能称为“[障碍](http://en.wikipedia.org/wiki/Barrier_(computer_science))”。（不幸的是，在谈论线程时，该术语有 2 个含义。因此，如果您在[Google](http://www.google.com/search?hl=en&client=firefox-a&rls=org.mozilla%3Aen-GB%3Aofficial&hs=dq4&q=barrier+threading+python&btnG=Search)上搜索它，请忽略那些谈论“[内存障碍](http://en.wikipedia.org/wiki/Memory_barrier)”的文章——这是完全不同的事情）。

您的代码看起来很合理 - 它简单且安全。

我找不到任何 Python 障碍的“标准”实现，所以我建议你继续使用你的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T12:05:05.050

有很多方法可以同步线程。许多。

除了同步之外，您还可以执行以下操作。

1.  围绕同步点将您的任务分成两个步骤。启动执行预同步步骤的线程。然后使用“join”等待所有线程完成第 1 步。启动新线程执行同步后步骤。我更喜欢这个，而不是同步。

2.  创建队列；获取同步锁。启动所有线程。每个线程在队列中放入一个条目并等待同步锁。“主”线程位于从队列中取出项目的循环中。当所有线程都将一个项目放入队列时，“主”线程释放同步锁。所有其他线程现在都可以再次自由运行。

有许多进程间通信 (IPC) 技术——所有这些技术都可用于线程同步。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-29T00:17:02.700

[请注意，Barrier 自Python 3.2](https://docs.python.org/3/whatsnew/3.2.html#threading)起已实现

使用障碍的例子：

```
from threading import Barrier, Thread

def get_votes(site):
    ballots = conduct_election(site)
    all_polls_closed.wait()        # do not count until all polls are closed
    totals = summarize(ballots)
    publish(site, totals)

all_polls_closed = Barrier(len(sites))
for site in sites:
    Thread(target=get_votes, args=(site,)).start() 
```

# asp.net - 使用企业库时出现 ASP.3.5 错误

> ID：887349
> 
> 赞同：0
> 
> 时间：2009-05-20T11:13:02.223
> 
> 标签：asp.net, .net-3.5, enterprise-library

我在 Vs2005 中创建了一个使用 Microsoft 企业数据库的 VisualStudio 解决方案。现在我将其转换为 Visual Studio 2008。现在当我构建项目时，我收到如下错误创建配置节处理程序时发生错误对于 dataConfiguration：无法加载文件或程序集“Microsoft.Practices.EnterpriseLibrary.Data，Version=2.0.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）（D:\dotnet\Test\Test.UI\web.config 第 4 行）

我的 Web.Config 第 4 行如下

```
&lt;section name="dataConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSettings, Microsoft.Practices.EnterpriseLibrary.Data, Version=3.5.0.0, Culture=neutral, PublicKeyToken=null"/&gt; 
```

我将版本从 2.0.0.0 更改为 3.5.0.0 。但没有结果。我得到同样的错误。谁能帮我解决这个问题？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T11:16:41.200

您是否检查过公钥令牌实际上是否为空？您可以使用 sn –T Microsoft.Practices.EnterpriseLibrary.Data.dll 执行此操作

# sql - SQL Server：提取表元数据（描述、字段及其数据类型）

> ID：887370
> 
> 赞同：72
> 
> 时间：2009-05-20T11:19:25.487
> 
> 标签：sql, sql-server, metadata

我正在尝试找到一种方法来提取有关我在 SQL Server (2008) 中的表的信息。
我需要的数据需要包括**表的描述**（从属性窗口中的描述属性填充）、该**表的字段列表**及其各自的**数据类型**。

有什么办法可以提取这样的元数据？我想我必须使用一些`sys`sp，但我不确定是哪一个。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-20T11:35:34.300

要获取描述数据，很遗憾您必须使用 sysobjects/syscolumns 来获取 id：

```
SELECT      u.name + '.' + t.name AS [table],
            td.value AS [table_desc],
            c.name AS [column],
            cd.value AS [column_desc]
FROM        sysobjects t
INNER JOIN  sysusers u
    ON      u.uid = t.uid
LEFT OUTER JOIN sys.extended_properties td
    ON      td.major_id = t.id
    AND     td.minor_id = 0
    AND     td.name = 'MS_Description'
INNER JOIN  syscolumns c
    ON      c.id = t.id
LEFT OUTER JOIN sys.extended_properties cd
    ON      cd.major_id = c.id
    AND     cd.minor_id = c.colid
    AND     cd.name = 'MS_Description'
WHERE t.type = 'u'
ORDER BY    t.name, c.colorder 
```

您可以使用 info-schema 来做到这一点，但是您必须连接 etc 才能调用 OBJECT_ID() - 那有什么意义呢？

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-05-20T11:26:19.950

有关表和列的一般信息可以在这些表中找到：

```
select * from INFORMATION_SCHEMA.TABLES
select * from INFORMATION_SCHEMA.COLUMNS 
```

表描述是一个扩展属性，可以从 sys.extended_properties 中查询：

```
select 
    TableName = tbl.table_schema + '.' + tbl.table_name, 
    TableDescription = prop.value,
    ColumnName = col.column_name, 
    ColumnDataType = col.data_type
FROM information_schema.tables tbl
INNER JOIN information_schema.columns col 
    ON col.table_name = tbl.table_name
    AND col.table_schema = tbl.table_schema
LEFT JOIN sys.extended_properties prop 
    ON prop.major_id = object_id(tbl.table_schema + '.' + tbl.table_name) 
    AND prop.minor_id = 0
    AND prop.name = 'MS_Description' 
WHERE tbl.table_type = 'base table' 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-05-20T12:31:38.583

你可以试试`sp_help <Name of object>`

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-06-19T16:23:02.473

我最喜欢@Andomar 的回答，但我也需要列描述。这是他的查询修改为也包括那些。（取消注释 WHERE 子句的最后一部分以仅返回任一描述为非空的行）。

```
SELECT
    TableName = tbl.table_schema + '.' + tbl.table_name, 
    TableDescription = tableProp.value,
    ColumnName = col.column_name, 
    ColumnDataType = col.data_type,
    ColumnDescription = colDesc.ColumnDescription
FROM information_schema.tables tbl
INNER JOIN information_schema.columns col 
    ON col.table_name = tbl.table_name
LEFT JOIN sys.extended_properties tableProp 
    ON tableProp.major_id = object_id(tbl.table_schema + '.' + tbl.table_name) 
        AND tableProp.minor_id = 0
        AND tableProp.name = 'MS_Description' 
LEFT JOIN (
    SELECT sc.object_id, sc.column_id, sc.name, colProp.[value] AS ColumnDescription
    FROM sys.columns sc
    INNER JOIN sys.extended_properties colProp
        ON colProp.major_id = sc.object_id
            AND colProp.minor_id = sc.column_id
            AND colProp.name = 'MS_Description' 
) colDesc
    ON colDesc.object_id = object_id(tbl.table_schema + '.' + tbl.table_name)
        AND colDesc.name = col.COLUMN_NAME
WHERE tbl.table_type = 'base table'
--AND tableProp.[value] IS NOT NULL OR colDesc.ColumnDescription IS NOT null 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-10-12T00:42:08.577

**使用对象目录视图：**

```
SELECT  T.NAME AS [TABLE NAME], C.NAME AS [COLUMN NAME], P.NAME AS [DATA TYPE], P.MAX_LENGTH AS[SIZE],   CAST(P.PRECISION AS VARCHAR) +‘/’+ CAST(P.SCALE AS VARCHAR) AS [PRECISION/SCALE]
FROM ADVENTUREWORKS.SYS.OBJECTS AS T
JOIN ADVENTUREWORKS.SYS.COLUMNS AS C
ON T.OBJECT_ID=C.OBJECT_ID
JOIN ADVENTUREWORKS.SYS.TYPES AS P
ON C.SYSTEM_TYPE_ID=P.SYSTEM_TYPE_ID
WHERE T.TYPE_DESC=‘USER_TABLE’; 
```

**使用信息模式视图**

```
SELECT TABLE_SCHEMA, TABLE_NAME, COLUMN_NAME, ORDINAL_POSITION,
       COLUMN_DEFAULT, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH,
       NUMERIC_PRECISION, NUMERIC_PRECISION_RADIX, NUMERIC_SCALE,
       DATETIME_PRECISION
FROM ADVENTUREWORKS.INFORMATION_SCHEMA.COLUMNS 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-03-16T02:09:38.500

看一下这个：

```
SELECT TABLE_SCHEMA ,
       TABLE_NAME ,
       COLUMN_NAME ,
       ORDINAL_POSITION ,
       COLUMN_DEFAULT ,
       DATA_TYPE ,
       CHARACTER_MAXIMUM_LENGTH ,
       NUMERIC_PRECISION ,
       NUMERIC_PRECISION_RADIX ,
       NUMERIC_SCALE ,
       DATETIME_PRECISION
FROM   INFORMATION_SCHEMA.COLUMNS
where TABLE_SCHEMA in ('dbo','meta')
and table_name in (select name from sys.tables)
order by TABLE_SCHEMA ,       TABLE_NAME ,ORDINAL_POSITION 
```

[![在此处输入图像描述](https://i.stack.imgur.com/KXNxK.png)](https://i.stack.imgur.com/KXNxK.png)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-08-05T01:29:30.947

根据您想要多少元数据，这对我有用：哪里可能是 Northwind.dbo.Products 之类的整个东西，或者只是 Products

```
SELECT c.name Field, 
    t.name Type,
    c.Precision, 
    c.Scale,
    c.is_nullable,
    c.collation_name 
FROM sys.columns c 
INNER JOIN sys.types t ON t.system_type_id=c.system_type_id
WHERE object_id=object_id('<table to inspect>')
ORDER BY column_id 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-05T15:21:27.900

如果您使用 java 代码提取查询，则可以使用一个很棒的类 ResultSetMetaData，它可以检索列名和列的属性（类型和长度）。

**例子**

```
ResultSet rs = null;

        rs = sql.executeQuery();

        if (rs != null) {
            if (rs.next()) {
                ResultSetMetaData rsmd = rs.getMetaData();
                for (int i = 1; i <= rsmd.getColumnCount(); i++) {
                    System.out.println("column name: "
                            + rsmd.getColumnName(i));
                    System.out.println("column size: "
                            + rsmd.getColumnDisplaySize(i));
                }
            } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-05-13T06:56:03.760

获取基本元数据摘要的最简单方法是使用临时表，然后使用 EXEC 函数：

```
SELECT * INTO #TempTable FROM TableName
EXEC [tempdb].[dbo].[sp_help] N'#TempTable' 
```

对于表中的所有列，这将为您提供列名称、
数据类型、
计算长度、
Prec、
Scale、Nullable、
TrimTrailingBlanks、FixedLenNullInSource、排序规则类型

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-05-13T08:36:56.080

我使用此 SQL 代码来获取有关列的所有信息。

```
SELECT
COL.COLUMN_NAME,
ORDINAL_POSITION,
DATA_TYPE,
CHARACTER_MAXIMUM_LENGTH,
NUMERIC_PRECISION,
NUMERIC_PRECISION_RADIX,
NUMERIC_SCALE,
DATETIME_PRECISION,
IS_NULLABLE,
CONSTRAINT_TYPE,
COLUMNPROPERTY(object_id(COL.TABLE_NAME), COL.COLUMN_NAME, 'IsIdentity') IS_IDENTITY,
COLUMNPROPERTY(object_id(COL.TABLE_NAME), COL.COLUMN_NAME, 'IsComputed') IS_COMPUTED

FROM INFORMATION_SCHEMA.COLUMNS COL 
LEFT OUTER JOIN 
(
    SELECT COLUMN_NAME, CONSTRAINT_TYPE 
    FROM INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE A
    INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS B 
    ON A.CONSTRAINT_NAME = B.CONSTRAINT_NAME
    WHERE A.TABLE_NAME = 'User'
) CONS
ON COL.COLUMN_NAME = CONS.COLUMN_NAME
WHERE COL.TABLE_NAME = 'User' 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-01-02T18:01:08.810

如果您只是想以方便的方式查看信息，Red Gate 的 SQL Prompt 可能会有所帮助。

如果您将鼠标悬停在查询窗口中的对象文本上，SQL 提示将在工具提示中显示 MS_Description 扩展属性文本。单击工具提示将打开一个对话框，其中显示列信息以及对象的 DDL。

[http://www.red-gate.com/products/sql-development/sql-prompt/](http://www.red-gate.com/products/sql-development/sql-prompt/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-03-13T22:45:21.007

如果可以使用 .NET 代码，我建议使用 SMO： http: [//msdn.microsoft.com/en-us/library/ms162169.aspx](http://msdn.microsoft.com/en-us/library/ms162169.aspx)，在您的特定情况下，它将是 Table 类[http:// msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.table.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.table.aspx) 这将是一个比使用特定于版本的系统视图和表更便携的解决方案。

如果这是您要定期使用的东西 - 您可能想要编写一个简单的控制台应用程序，可能使用运行时 T4 代码生成器[http://msdn.microsoft.com/en-us/library/ee844259.aspx](http://msdn.microsoft.com/en-us/library/ee844259.aspx)

如果这只是一项一次性任务 - 您可以使用我的 LiveDoco ( [http://www.livedoco.com](http://www.livedoco.com) ) 导出到 XML 的功能以及可选的 XSLT 转换，或者我确信那里有免费的工具可以做到这一点。这个看起来不错：[http](http://sqldbdoc.codeplex.com/) ://sqldbdoc.codeplex.com/ - 通过 XSLT 支持 XML，但我不确定您是否可以为选择的表运行它（使用 LiveDoco 可以）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-02T11:47:59.107

```
 SELECT
    sc.name AS ColumnName
   ,ep.*
  FROM
    sys.columns AS sc
    INNER JOIN sys.extended_properties AS ep
      ON ep.major_id = sc.[object_id]
         AND ep.minor_id = sc.column_id
  WHERE

--here put your desired table
    sc.[object_id] = OBJECT_ID('[Northwind].[dbo].[Products]')

-- this is optional, remove this and you get all extended props
    AND ep.name = 'MS_Description' 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-11-05T12:16:42.250

```
select Col.name Columnname,prop.Value Description, tbl.name Tablename, sch.name schemaname
    from sys.columns col  left outer join  sys.extended_properties prop
                    on prop.major_id =  col.object_id and prop.minor_id = col.column_id
                    inner join sys.tables tbl on col.object_id =  tbl.object_id
                    Left outer join sys.schemas sch on sch.schema_id = tbl.schema_id 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-12-03T03:33:27.770

我刚刚完成了一个 .net 库，其中包含一些有用的查询，这些查询返回代码 gen/t4 模板的强类型 C# 对象。

[nuget SqlMeta](http://www.nuget.org/packages/SqlMeta/)

[项目现场](http://www.achadwick.com/DeveloperBlog/Result/SqlMeta%20Code%20Generation%20Tool)

[github源码](https://github.com/TheDev6/SqlMeta)

```
/// <summary>
    ///     Get All Table Names
    /// </summary>
    /// <returns></returns>
    public List<string> GetTableNames()
    {
        var sql = @"SELECT name
                    FROM dbo.sysobjects
                    WHERE xtype = 'U' 
                    AND name <> 'sysdiagrams'
                    order by name asc";

        return databaseWrapper.Call(connection => connection.Query<string>(
            sql: sql))
            .ToList();
    }

    /// <summary>
    ///     Get table info by schema and table or null for all
    /// </summary>
    /// <param name="schema"></param>
    /// <param name="table"></param>
    /// <returns></returns>
    public List<SqlTableInfo> GetTableInfo(string schema = null, string table = null)
    {
        var result = new List<SqlTableInfo>();

        var sql = @"SELECT
                    c.TABLE_CATALOG AS [TableCatalog]
                ,   c.TABLE_SCHEMA AS [Schema]
                ,   c.TABLE_NAME AS [TableName]
                ,   c.COLUMN_NAME AS [ColumnName]
                ,   c.ORDINAL_POSITION AS [OrdinalPosition]
                ,   c.COLUMN_DEFAULT AS [ColumnDefault]
                ,   c.IS_NULLABLE AS [Nullable]
                ,   c.DATA_TYPE AS [DataType]
                ,   c.CHARACTER_MAXIMUM_LENGTH AS [CharacterMaxLength]
                ,   c.CHARACTER_OCTET_LENGTH AS [CharacterOctetLenth]
                ,   c.NUMERIC_PRECISION AS [NumericPrecision]
                ,   c.NUMERIC_PRECISION_RADIX AS [NumericPrecisionRadix]
                ,   c.NUMERIC_SCALE AS [NumericScale]
                ,   c.DATETIME_PRECISION AS [DatTimePrecision]
                ,   c.CHARACTER_SET_CATALOG AS [CharacterSetCatalog]
                ,   c.CHARACTER_SET_SCHEMA AS [CharacterSetSchema]
                ,   c.CHARACTER_SET_NAME AS [CharacterSetName]
                ,   c.COLLATION_CATALOG AS [CollationCatalog]
                ,   c.COLLATION_SCHEMA AS [CollationSchema]
                ,   c.COLLATION_NAME AS [CollationName]
                ,   c.DOMAIN_CATALOG AS [DomainCatalog]
                ,   c.DOMAIN_SCHEMA AS [DomainSchema]
                ,   c.DOMAIN_NAME AS [DomainName]
                ,   IsPrimaryKey = CONVERT(BIT, (SELECT
                            COUNT(*)
                        FROM    INFORMATION_SCHEMA.TABLE_CONSTRAINTS tc
                            ,   INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE cu
                        WHERE CONSTRAINT_TYPE = 'PRIMARY KEY'
                        AND tc.CONSTRAINT_NAME = cu.CONSTRAINT_NAME
                        AND tc.TABLE_NAME = c.TABLE_NAME
                        AND cu.TABLE_SCHEMA = c.TABLE_SCHEMA
                        AND cu.COLUMN_NAME = c.COLUMN_NAME)
                    )
                ,   IsIdentity = CONVERT(BIT, (SELECT
                            COUNT(*)
                        FROM sys.objects obj
                        INNER JOIN sys.COLUMNS col
                            ON obj.object_id = col.object_id
                        WHERE obj.type = 'U'
                        AND obj.Name = c.TABLE_NAME
                        AND col.Name = c.COLUMN_NAME
                        AND col.is_identity = 1)
                    )
                FROM INFORMATION_SCHEMA.COLUMNS c
                WHERE (@Schema IS NULL
                        OR c.TABLE_SCHEMA = @Schema)
                    AND (@TableName IS NULL
                        OR c.TABLE_NAME = @TableName)
                    ";

        var columns = databaseWrapper.Call(connection => connection.Query<SqlColumnInfo>(
            sql: sql,
            param: new { Schema = schema, TableName = table },
            commandType: CommandType.Text)
            .ToList());

        var refs = this.GetReferentialConstraints(table: table, schema: schema);

        foreach (var tableName in columns.Select(info => info.TableName).Distinct())
        {
            var tableColumns = columns.Where(info => info.TableName == tableName).ToList();
            var children = refs.Where(c => c.UniqueTableName == tableName).ToList();
            var parents = refs.Where(c => c.TableName == tableName).ToList();
            result.Add(new SqlTableInfo
            {
                TableName = tableName,
                Columns = tableColumns,
                ChildConstraints = children,
                ParentConstraints = parents
            });

        }

        return result;
    }

    public List<SqlReferentialConstraint> GetReferentialConstraints(string table = null, string schema = null)
    {
        //https://technet.microsoft.com/en-us/library/aa175805%28v=sql.80%29.aspx
        //https://technet.microsoft.com/en-us/library/Aa175805.312ron1%28l=en-us,v=sql.80%29.jpg
        //https://msdn.microsoft.com/en-us/library/ms186778.aspx

        var sql = @"
                    SELECT
                        KCU1.CONSTRAINT_NAME AS [ConstraintName]
                    ,   KCU1.TABLE_NAME AS [TableName]
                    ,   KCU1.COLUMN_NAME AS [ColumnName]
                    ,   KCU2.CONSTRAINT_NAME AS [UniqueConstraintName]
                    ,   KCU2.TABLE_NAME AS [UniqueTableName]
                    ,   KCU2.COLUMN_NAME AS [UniqueColumnName]
                    ,   RC.MATCH_OPTION AS [MatchOption]
                    ,   RC.UPDATE_RULE AS [UpdateRule]
                    ,   RC.DELETE_RULE AS [DeleteRule]
                    FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS RC
                    LEFT JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU1 ON KCU1.CONSTRAINT_CATALOG = RC.CONSTRAINT_CATALOG
                        AND KCU1.CONSTRAINT_SCHEMA = RC.CONSTRAINT_SCHEMA
                        AND KCU1.CONSTRAINT_NAME = RC.CONSTRAINT_NAME
                    LEFT JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU2 ON KCU2.CONSTRAINT_CATALOG = RC.UNIQUE_CONSTRAINT_CATALOG
                        AND KCU2.CONSTRAINT_SCHEMA = RC.UNIQUE_CONSTRAINT_SCHEMA
                        AND KCU2.CONSTRAINT_NAME = RC.UNIQUE_CONSTRAINT_NAME
                    WHERE KCU1.ORDINAL_POSITION = KCU2.ORDINAL_POSITION
                            AND (@Table IS NULL
                                OR KCU1.TABLE_NAME = @Table
                                OR KCU2.TABLE_NAME = @Table)
                            AND (@Schema IS NULL
                                OR KCU1.TABLE_SCHEMA = @Schema
                                OR KCU2.TABLE_SCHEMA = @Schema)
                    ";

        return databaseWrapper.Call(connection => connection.Query<SqlReferentialConstraint>(
            sql: sql,
            param: new { Table = table, Schema = schema },
            commandType: CommandType.Text))
            .ToList();
    }

    /// <summary>
    ///     Get Primary Key Column by schema and table name
    /// </summary>
    /// <param name="schema"></param>
    /// <param name="tableName"></param>
    /// <returns></returns>
    public string GetPrimaryKeyColumnName(string schema, string tableName)
    {
        var sql = @"SELECT
                    B.COLUMN_NAME
                FROM    INFORMATION_SCHEMA.TABLE_CONSTRAINTS A
                    ,   INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE B
                WHERE CONSTRAINT_TYPE = 'PRIMARY KEY'
                    AND A.CONSTRAINT_NAME = B.CONSTRAINT_NAME
                    AND A.TABLE_NAME = @TableName
                    AND A.TABLE_SCHEMA = @Schema";

        return databaseWrapper.Call(connection => connection.Query<string>(
            sql: sql,
            param: new { TableName = tableName, Schema = schema },
            commandType: CommandType.Text))
            .SingleOrDefault();
    }

    /// <summary>
    ///     Get Identity Column by table name
    /// </summary>
    /// <param name="tableName"></param>
    /// <returns></returns>
    public string GetIdentityColumnName(string tableName)
    {
        var sql = @"SELECT
                    c.Name
                FROM sys.objects o
                INNER JOIN sys.columns c ON o.object_id = c.object_id
                WHERE o.type = 'U'
                    AND c.is_identity = 1
                    AND o.Name = @TableName";

        return databaseWrapper.Call(connection => connection.Query<string>(
            sql: sql,
            param: new { TableName = tableName },
            commandType: CommandType.Text))
            .SingleOrDefault();
    }

    /// <summary>
    ///     Get All Stored Procedures by schema
    /// </summary>
    /// <param name="schema"></param>
    /// <param name="procName"></param>
    /// <returns></returns>
    public List<SqlStoredProcedureInfo> GetStoredProcedureInfo(string schema = null, string procName = null)
    {
        var result = new List<SqlStoredProcedureInfo>();

        var sql = @"SELECT
                        SPECIFIC_NAME AS [Name]
                    ,   SPECIFIC_SCHEMA AS [Schema]
                    ,   Created AS [Created]
                    ,   LAST_ALTERED AS [LastAltered]
                    FROM INFORMATION_SCHEMA.ROUTINES
                    WHERE ROUTINE_TYPE = 'PROCEDURE'
                        AND (SPECIFIC_SCHEMA = @Schema
                            OR @Schema IS NULL)
                        AND (SPECIFIC_NAME = @ProcName
                            OR @ProcName IS NULL)
                        AND ((SPECIFIC_NAME NOT LIKE 'sp_%'
                                AND SPECIFIC_NAME NOT LIKE 'procUtils_GenerateClass'
                                AND (SPECIFIC_SCHEMA = @Schema
                                    OR @Schema IS NULL))
                            OR SPECIFIC_SCHEMA <> @Schema)";

        var sprocs = databaseWrapper.Call(connection => connection.Query<SqlStoredProcedureInfo>(
            sql: sql,
            param: new { Schema = schema, ProcName = procName },
            commandType: CommandType.Text).ToList());

        foreach (var s in sprocs)
        {
            s.Parameters = GetStoredProcedureInputParameters(sprocName: s.Name, schema: schema);
            s.ResultColumns = GetColumnInfoFromStoredProcResult(storedProcName: s.Name, schema: schema);
            result.Add(s);
        }

        return result;
    }

    /// <summary>
    ///     Get Column info from Stored procedure result set
    /// </summary>
    /// <param name="schema"></param>
    /// <param name="storedProcName"></param>
    /// <returns></returns>
    public List<DataColumn> GetColumnInfoFromStoredProcResult(string schema, string storedProcName)
    {
        //this one actually needs to use the dataset because it has the only accurate information about columns and if they can be null or not.
        var sb = new StringBuilder();
        if (!String.IsNullOrEmpty(schema))
        {
            sb.Append(String.Format("exec [{0}].[{1}] ", schema, storedProcName));
        }
        else
        {
            sb.Append(String.Format("exec [{0}] ", storedProcName));
        }

        var prms = GetStoredProcedureInputParameters(schema, storedProcName);

        var count = 1;
        foreach (var param in prms)
        {
            sb.Append(String.Format("{0}=null", param.Name));
            if (count < prms.Count)
            {
                sb.Append(", ");
            }
            count++;
        }

        var ds = new DataSet();
        using (var sqlConnection = (SqlConnection)databaseWrapper.GetOpenDbConnection())
        {
            using (var sqlAdapter = new SqlDataAdapter(sb.ToString(), sqlConnection))
            {
                if (sqlConnection.State != ConnectionState.Open) sqlConnection.Open();

                sqlAdapter.SelectCommand.ExecuteReader(CommandBehavior.SchemaOnly);

                sqlConnection.Close();

                sqlAdapter.FillSchema(ds, SchemaType.Source, "MyTable");
            }
        }

        var list = new List<DataColumn>();
        if (ds.Tables.Count > 0)
        {
            list = ds.Tables["MyTable"].Columns.Cast<DataColumn>().ToList();
        }

        return list;
    }

    /// <summary>
    ///     Get the input parameters for a stored procedure
    /// </summary>
    /// <param name="schema"></param>
    /// <param name="sprocName"></param>
    /// <returns></returns>
    public List<SqlParameterInfo> GetStoredProcedureInputParameters(string schema = null, string sprocName = null)
    {
        var sql = @"SELECT
                    SCHEMA_NAME(schema_id) AS [Schema]
                ,   P.Name AS Name
                ,   @ProcName AS ProcedureName
                ,   TYPE_NAME(P.user_type_id) AS [ParameterDataType]
                ,   P.max_length AS [MaxLength]
                ,   P.Precision AS [Precision]
                ,   P.Scale AS Scale
                ,   P.has_default_value AS HasDefaultValue
                ,   P.default_value AS DefaultValue
                ,   P.object_id AS ObjectId
                ,   P.parameter_id AS ParameterId
                ,   P.system_type_id AS SystemTypeId
                ,   P.user_type_id AS UserTypeId
                ,   P.is_output AS IsOutput
                ,   P.is_cursor_ref AS IsCursor
                ,   P.is_xml_document AS IsXmlDocument
                ,   P.xml_collection_id AS XmlCollectionId
                ,   P.is_readonly AS IsReadOnly
                FROM sys.objects AS SO
                INNER JOIN sys.parameters AS P ON SO.object_id = P.object_id
                WHERE SO.object_id IN (SELECT
                            object_id
                        FROM sys.objects
                        WHERE type IN ('P', 'FN'))
                    AND (SO.Name = @ProcName
                        OR @ProcName IS NULL)
                    AND (SCHEMA_NAME(schema_id) = @Schema
                        OR @Schema IS NULL)
                ORDER BY P.parameter_id ASC";

        var result = databaseWrapper.Call(connection => connection.Query<SqlParameterInfo>(
            sql: sql,
            param: new { Schema = schema, ProcName = sprocName },
            commandType: CommandType.Text))
            .ToList();

        return result;
    } 
```

[外键元数据](https://technet.microsoft.com/en-us/library/aa175805%28v=sql.80%29.aspx)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-08-14T09:51:21.570

有2个简单的方法：

*   选项1

    sp_help 'schema.table_name'

*   选项 2

    SELECT * FROM INFORMATION_SCHEMA.columns c WHERE c.table_name = 'table_name'

# c# - 如何获取 C# 中所有可打印字符的列表？

> ID：887377
> 
> 赞同：21
> 
> 时间：2009-05-20T11:22:45.463
> 
> 标签：c#

我希望能够在 C# 中获得所有可打印字符的 char 数组，有人知道该怎么做吗？

**编辑：**

我所说的可打印是指可见的欧洲字符，所以是的，变音符号、波浪线、重音符号等。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-20T11:32:38.610

这将为您提供一个列表，其中包含所有不被视为控制字符的字符：

```
List<Char> printableChars = new List<char>();
for (int i = char.MinValue; i <= char.MaxValue; i++)
{
    char c = Convert.ToChar(i);
    if (!char.IsControl(c))
    {
        printableChars.Add(c);
    }
} 
```

您可能需要调查其他[Char.IsXxxx](http://msdn.microsoft.com/en-us/library/system.char_members.aspx)方法以找到适合您要求的组合。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-20T11:45:07.773

这是 Fredrik 解决方案的 LINQ 版本。请注意，`Enumerable.Range`产生 an`IEnumerable<int>`所以您必须先转换为字符。`Cast<char>`我相信在 3.5SP0 中可以工作，但是从 3.5SP1 开始，您必须进行“正确”转换：

```
var chars = Enumerable.Range(0, char.MaxValue+1)
                      .Select(i => (char) i)
                      .Where(c => !char.IsControl(c))
                      .ToArray(); 
```

我已经将结果创建为一个数组，因为这就是问题所要求的 - 虽然它不一定是最好的主意。这取决于用例。

请注意，这也不考虑完整的 Unicode 字符，只考虑基本多语言平面中的字符。我不知道它为高/低代理返回什么，但至少值得知道一个单曲`char`并不能真正让你代表一切:(

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T11:41:18.017

LINQ 解决方案（基于 Fredrik Mörk 的）：

```
Enumerable.Range(char.MinValue, char.MaxValue).Select(c => (char)c).Where(
    c => !char.IsControl(c)).ToArray(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-03T08:00:16.367

我知道没有特别要求 ASCII，但这是获取所有可打印 ASCII 字符列表的快速方法。

```
for (Int32 i = 0x20; i <= 0x7e; i++)
{
    printableChars.Add(Convert.ToChar(i));
} 
```

请参阅此[ASCII 表](http://www.asciitable.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-22T07:03:38.140

```
public bool IsPrintableASCII(char c)
{
     return c >= '\x20' && c <= '\x7e';
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-30T16:04:42.443

### TLDR 答案

使用这个正则表达式...

```
var regex = new Regex(@"[^\p{Cc}^\p{Cn}^\p{Cs}]"); 
```

### TLDR 解释

*   `^\p{Cc}`:*不*匹配控制字符。
*   `^\p{Cn}`：*不*匹配未分配的字符。
*   `^\p{Cs}`:*不*匹配 UTF-8 无效字符。

### 工作演示

我在这个演示中测试了两个字符串：`"Hello, World!"`和`"Hello, World!" + (char)4`. `char(4)`是 的字符[`END TRANSMISSION`](https://www.fileformat.info/info/unicode/char/0004/index.htm)。

```
using System;
using System.Text.RegularExpressions;

public class Test {
    public static MatchCollection getPrintableChars(string haystack) {
        var regex = new Regex(@"[^\p{Cc}^\p{Cn}^\p{Cs}]");
        var matches = regex.Matches(haystack);
        return matches;
    }
    public static void Main() {
        var teststring1 = "Hello, World!";
        var teststring2 = "Hello, World!" + (char)4;

        var teststring1unprintablechars = getPrintableChars(teststring1);
        var teststring2unprintablechars = getPrintableChars(teststring2);

        Console.WriteLine("Testing a Printable String: " + teststring1unprintablechars.Count + " Printable Chars Detected");
        Console.WriteLine("Testing a String With 1-Unprintable Char: " + teststring2unprintablechars.Count + " Printable Chars Detected");

        foreach (Match unprintablechar in teststring1unprintablechars) {
            Console.WriteLine("String 1 Printable Char:" + unprintablechar);
        }

        foreach (Match unprintablechar in teststring2unprintablechars) {
            Console.WriteLine("String 2 Printable Char:" + unprintablechar);
        }
    }
} 
```

[**IDEOne.com 上的完整工作演示**](https://ideone.com/HF5KV4)

### 备择方案

*   `\P{C}`: 只匹配可见字符。不要匹配任何不可见的字符。
*   `\P{Cc}`: 只匹配非控制字符。不匹配任何控制字符。
*   `\P{Cc}\P{Cn}`：仅匹配已分配的非控制字符。不要匹配任何控制或未分配的字符。
*   `\P{Cc}\P{Cn}\P{Cs}`：仅匹配已分配且 UTF-8 有效的非控制字符。不匹配任何控制、未分配或 UTF-8 无效字符。
*   `\P{Cc}\P{Cn}\P{Cs}\P{Cf}`：仅匹配已分配且 UTF-8 有效的非控制、非格式字符。不匹配任何控制、未分配、格式化或 UTF-8 无效字符。

### 来源和解释

查看可用于在正则表达式中进行测试的[Unicode 字符属性。](https://en.wikipedia.org/wiki/Unicode_character_property#General_Category)您应该能够在[Microsoft .NET](https://docs.microsoft.com/en-us/dotnet/standard/base-types/character-classes-in-regular-expressions)、[JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Unicode_Property_Escapes)、[Python](https://pypi.org/project/regex/)、[Java](https://javascript.info/regexp-unicode)、[PHP](https://www.php.net/manual/en/parle.regex.unicodecharclass.php)、[Ruby](https://ruby-doc.org/core-2.4.1/Regexp.html)、[Perl](https://perldoc.perl.org/5.8.9/perlrecharclass)、[Golang](https://golang.org/pkg/regexp/syntax/)甚至[Adob](https://helpx.adobe.com/coldfusion/developing-applications/the-cfml-programming-language/using-regular-expressions-in-functions/regular-expression-syntax.html) ​​e 中使用这些正则表达式。了解 Unicode 字符类是*非常可转移的知识*，所以我推荐使用它！

# database-design - 为每个用户提供独特的颜色

> ID：887386
> 
> 赞同：1
> 
> 时间：2009-05-20T11:25:26.050
> 
> 标签：database-design, web-applications, colors, chatroom

在我的网络应用程序中，我有一个聊天室。我希望每个用户的名字都有不同的颜色，而不是全黑。实现这一目标的最佳方法是什么？我是否应该在每个用户注册我的应用程序时存储他们的 RGB/HEX 代码并将该字符串作为字段作为他们在数据库中记录的一部分？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T11:28:58.710

我有一个固定的颜色列表，让用户从中挑选并在数据库中存储一个索引`1 = red`，`2 = green`等等。这将允许您更改每种颜色的阴影以匹配您的网站设计，因为它正在发展。

例如，您可能希望“红色”与您的徽标匹配相同的红色；如果您将其作为 RGB 值存储在数据库中，而不仅仅是“红色”，则更改将更加困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T12:24:12.827

如果您的目标是让用户在聊天室中一目了然，这取决于您的用户群有多大。如果聊天室的平均大小是 10 人，但您的用户群有数千人，那么为每个人设置唯一的颜色是行不通的。最终，您最终会在同一个聊天室中出现相同颜色的稍微不同的阴影。

在这种情况下，只需保留一个明显不同颜色的简短列表，然后在单个聊天室中分配它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-20T14:10:12.410

作为您的方案的替代方案：

您可以像 irssi（和其他人一样）那样做，只需根据屏幕昵称的散列（使用您选择的函数）分配颜色。在这个系统下，昵称的长度和颜色（应该/将）是不相关的，所以不同的字母、不同的网名和不同的颜色的组合应该足以使事物既可区分，又在会话之间保持一致。在此方案中，您可能需要缓存的唯一内容是*作为会话*中每个用户名的颜色，因此您不必进行无数次 md5 调用。这并不能保证每个用户都有不同的颜色（远非如此），也许您应该考虑一下您尝试使用该规范实现的目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T11:28:42.317

特别是使用色调值从 HSV/HSL 生成颜色。然后转换为RGB。

[有关 HSV/HSL 的更多信息，请参阅我的答案](https://stackoverflow.com/questions/773226/generate-unique-colours/773243#773243)

您可能每次都想要尽可能不同的颜色。

您可以通过保留一系列颜色范围来做到这一点。

如果队列为空，则返回色调 0 并将对 (0, 360) 插入队列。下次您想要颜色时，从队列 (0, 360) 中弹出一个元素，并返回这些值之间的中点：180。然后将 (0, 180) 和 (180, 360) 推入队列。

下次你想要一个颜色时，从队列 (0, 180) 中弹出一个元素，并返回这些值之间的中点：90。然后将 (0, 90) 和 (90, 180) 推入队列。

下次您想要颜色时，从队列 (180, 360) 中弹出一个元素，并返回这些值之间的中点：270。然后将 (180, 270) 和 (270, 360) 推入队列。

继续这个过程...

您将自动为每个用户拥有最广泛的可区分颜色。

# python - SQLAlchemy 中使用的“SQL 表达式语言”中是否支持 IN 运算符？

> ID：887388
> 
> 赞同：19
> 
> 时间：2009-05-20T11:27:26.687
> 
> 标签：python, sqlalchemy

是否可以在 SQLAlchemy 中使用的“SQL 表达式语言”中表达如下查询？

```
SELECT * FROM foo WHERE foo.bar IN (1,2,3)
```

我想避免用纯文本编写 WHERE 子句。有没有一种类似于我下面的示例或不使用纯文本的方式来表达这一点？

```
select([foo], in(foo.c.bar, [1, 2, 3]))
```

```
select([foo]).in(foo.c.bar, [1, 2, 3])
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-20T11:32:30.903

```
select([foo], foo.c.bar.in_([1, 2, 3])) 
```

您可以将该[`.in_()`](http://docs.sqlalchemy.org/en/latest/core/sqlelement.html#sqlalchemy.sql.expression.ColumnElement.in_)方法与 Columns 或 Instrumented 属性一起使用。两者都有效。

在 SQLAlchemy 的第一个教程[中提到了这里。](https://docs.sqlalchemy.org/en/latest/orm/tutorial.html#common-filter-operators)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-12-05T05:27:37.610

.in_() 运算符现在位于**ColumnOperators**类中，记录在 @ [http://docs.sqlalchemy.org/en/rel_0_9/core/sqlelement.html#sqlalchemy.sql.operators.ColumnOperators.in_](http://docs.sqlalchemy.org/en/rel_0_9/core/sqlelement.html#sqlalchemy.sql.operators.ColumnOperators.in_)

示例用法：

```
ids_to_select = ["1", "2", "3"]
query(Model).filter(Model.id.in_(ids_to_select)).all() 
```

# sql - DB（SQL）自动压力/负载工具？

> ID：887393
> 
> 赞同：8
> 
> 时间：2009-05-20T11:28:47.307
> 
> 标签：sql, database, testing, load, stress

我想测量我的数据库应用程序的性能和可扩展性。我正在寻找一种工具，它允许我对我的数据库运行许多 SQL 语句，将数据库和脚本 (SQL) 文件作为参数（+必要的详细信息，例如主机名、端口、登录名......）。

理想情况下，它应该让我控制参数，例如模拟客户端的数量、测试持续时间、随机化变量或从列表中选择（例如 SELECT FROM ... WHERE value = @var，其中 var 是从命令行读取或每次执行随机化） . 我想将测试结果保存为 CSV 或 XML 文件，我可以分析和绘制它们。当然，在定价方面，我更喜欢“免费”或“演示”:-)

令人惊讶的是（至少对我来说）虽然有很多这样的工具用于 Web 应用程序负载测试，但我找不到任何用于 DB 测试的工具！？我看到的那些，比如 pgbench，使用基于一些 TPC 场景的内置数据库，所以它们有助于测试 DBMS 配置和硬件，但我无法测试我的数据库！有什么建议么？

具体来说，我在 Linux 上使用 Postgres 8.3，尽管我可以使用任何满足这些要求的 DB 通用工具。硬件有 32GB 的 RAM，而主表和索引的大小约为 120GB。因此，冷缓存与热缓存运行（I/O 与 RAM）之间的响应时间比率可能为 1:10。实际上，我希望请求能够均匀分布，因此对我来说测试针对不同数据库部分的查询很重要。

请随时通过电子邮件与我联系。谢谢！

-- 绍尔达尔 (info@shauldar.com)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T11:49:03.257

[来自 Apache 的JMeter](http://jakarta.apache.org/jmeter/index.html)可以处理不同的服务器类型。我将它用于针对 Web 应用程序的负载测试，团队中的其他人将它用于 DB 调用。它可以通过多种方式进行配置以获得您需要的负载。它可以在控制台模式下运行，甚至可以使用不同的客户端进行集群以最小化客户端开销（从而伪造结果）。

这是一个 java 应用程序，乍一看有点复杂。但我们仍然喜欢它。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-07-19T10:21:22.000

[k6.io可以使用](https://k6.io/)[xk6-sql 扩展](https://github.com/imiric/xk6-sql)对一些关系数据库进行压力测试。

作为参考，测试脚本可能类似于：

```
import sql from 'k6/x/sql';

const db = sql.open("sqlite3", "./test.db");

export function setup() {
  db.exec(`CREATE TABLE IF NOT EXISTS keyvalues (
           id integer PRIMARY KEY AUTOINCREMENT,
           key varchar NOT NULL,
           value varchar);`);
}

export function teardown() {
  db.close();
}

export default function () {
  db.exec("INSERT INTO keyvalues (key, value) VALUES('plugin-name', 'k6-plugin-sql');");

  let results = sql.query(db, "SELECT * FROM keyvalues;");
  for (const row of results) {
    console.log(`key: ${row.key}, value: ${row.value}`);
  }
} 
```

阅读有关此[简短教程](https://k6.io/blog/load-testing-sql-databases-with-k6/)的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T18:14:03.833

SQL Load Generator 是另一个这样的工具：

[http://sqlloadgenerator.codeplex.com/](http://sqlloadgenerator.codeplex.com/)

我喜欢它，但它还没有保存测试设置的选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T09:45:19.837

我们从未真正找到合适的解决方案来对大型机 DB2 数据库进行压力测试，因此我们最终推出了自己的解决方案。它实际上只是由一组 30 台运行 Linux 并安装了 DB2 Connect 的 PC 组成。

29 个盒子运行一个脚本，它只是等待启动文件出现在 NFS 挂载上，然后开始执行基于数据的固定查询。这些查询（以及数据库中的数据）是固定的，这意味着我们可以轻松地与之前的成功运行进行比较。

第 30 个盒子连续运行两个脚本（第二个与所有其他盒子相同）。第一个清空然后用我们已知的数据填充数据库表，然后创建启动文件以允许所有其他机器（和它自己）继续。

这一切都是通过`bash`DB2 Connect 完成的，因此相当容易维护（并且免费）。

我们还有另一种变体，可以根据对数月来收集的生产信息的分析进行随机查询。对照已知的成功基线检查输出比较困难，但在这种情况下，我们只是在寻找功能和性能问题（因此我们检查错误和查询时间过长）。

我们目前正在研究是否可以在运行 zLinux 的大型机（它将使用 TCP/IP 的共享内存 HyperSockets，基本上消除网络延迟）和带有 VMWare 的 Intel 平台上将所有这些物理服务器整合到虚拟机中，以释放一些硬件。

如果您不介意提前做一点工作，那么您应该检查一下这个选项，因为它可以让您在赛道上进行大量控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T05:59:11.150

您是否检查过 Bristlecone Continuent 的开源工具？我不使用它，但它适用于 Postgres，并且似乎能够完成您要求的事情。（对不起，作为一个新用户，我不能给你工具页面的直接链接，但谷歌会带你去那里；o]）

# c++ - 使用 C/C++ 本机函数设置文件属性

> ID：887398
> 
> 赞同：5
> 
> 时间：2009-05-20T11:30:44.840
> 
> 标签：c++, c

我知道如何使用 SetFileAttributes 函数在 Windows 上设置文件属性。但我想知道是否有一个本机 C/C++ 函数也可以做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-20T11:35:24.220

不，那里没有。标准 C++ 和标准 C 均未指定此类函数。

这样做的原因是，在这个领域，跨不同操作系统的功能几乎没有共同点。例如，类 UNIX 操作系统具有“可执行”属性，而类 Windows 操作系统使用文件扩展名来确定可执行性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-20T11:38:25.620

如果通过“本机”，您的意思是在 C 标准库中，那么没有。文件“属性”是特定于操作系统的扩展，因此不会出现在任何标准功能集中。如果我们愿意将我们的职责扩展到 POSIX，那么还有 fchmod 之类的函数，但它只处理 UNIX 样式的文件模式，它不像 Windows 文件属性那样具有表现力。

一般来说，您可以回答“是否有标准函数/对象来执行特定于操作系统的事情”形式的任何问题，方法是说“可能，如果标准仅适用于操作系统。否则，不”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T11:35:30.493

在 Windows 上有一个[_chmod](http://msdn.microsoft.com/en-us/library/1z319a54(VS.80).aspx)函数，它模仿 Unix 上 chmod 函数的行为。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-04T19:23:48.507

对于 C++，您可以尝试[boost::filesystem](http://www.boost.org/doc/libs/1_51_0/libs/filesystem/doc/index.htm)。

# xcode - 在 Xcode 上管理代码片段的最佳方式是什么？

> ID：887404
> 
> 赞同：8
> 
> 时间：2009-05-20T11:33:18.017
> 
> 标签：xcode, macos

我爱上了 Visual Studio 的代码片段工具包。Xcode上有类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T11:39:13.650

你也可以看看[这个](https://stackoverflow.com/questions/20420/any-resharper-equivalent-for-xcode)问题，这个问题是关于 XCode 3 的类似问题（代码模板、代码完成等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-10T14:27:40.123

Xcode 4 支持代码片段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:37:53.920

当然有。它们位于“编辑-> 插入文本宏”下。

或者您可以简单地开始输入“if<ctrl+.>”，这将扩展为完整的 if 语句。

# linux - 需要一些建议才能开始在 ARM（使用 linux）平台上编程

> ID：887423
> 
> 赞同：4
> 
> 时间：2009-05-20T11:38:25.323
> 
> 标签：linux, macos, arm

我将（也许）很快在托管 linux 发行版的 ARM 平台上工作（我不知道哪个发行版..）。

我知道该项目涉及视频流，但我不能告诉你更多。其实我只收到了通知，还没有遇到任何人。

我从来没有在这样的平台上工作过。所以我的想法是在项目开始之前进行测试。

**你有什么建议让我不明白这样的平台是如何运作的？互联网链接？教程？工具**

此外，因为我家里没有任何 ARM 处理器（只有我的 iPhone ..）你会建议我使用哪个虚拟机？（我显然不想浪费时间安装和测试它们中的每一个。）

我知道[维基百科上](http://en.wikipedia.org/wiki/Comparison_of_platform_virtual_machines)的这个页面。**哪一个更适合在 MacOS X 10.5/intel 平台上运行？在虚拟机上安装哪个 linux 发行版？**

我知道这个话题很广泛，所以欢迎任何想法！:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-20T11:55:10.047

对于可以模拟 ARM 平台的虚拟机，请尝试 QEMU。您可以安装基于 ARM 的 Debian Linux 发行版并对其进行修改。在 ARM、QEMU 和 Debian 上的谷歌搜索将帮助您入门。

另外：不要太担心 ARM CPU。您将使用 linux，因此所有低级的东西都已经为您完成了。了解 linux 引导过程的工作原理更为重要。如何安装东西等。您很少（如果有的话）注意到您在 ARM 设备上运行。与运行 linux 的 PC 最大的不同是，ARM 会慢很多。

如果您正在寻找真正的硬件来玩，我建议您看看 beagleboard (www.beagleboard.org)。它很便宜（大约 150 美元）并且运行（除其他外）各种 Linux 发行版。

使用 beagleboard，如果您愿意，您将获得整个 linux 交叉编译体验（请注意：您会拔掉头发）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:49:00.497

我不能回答你所有的问题，但是[ARM 上有一个完整的 Debian GNU/Linux](http://www.debian.org/ports/arm/)端口。[根据我的经验，效果非常好（我在QNAP](http://www.cyrius.com/debian/orion/qnap/)上试过）。Debian 中可用的一切现在都可以在 QNAP 上使用！因此，首先尝试与您的项目接近的 Debian 工具和软件包可能是最简单的，然后从那里继续。

# asp.net - 智能感知在 VS 2008 中是否无法正常工作？

> ID：887425
> 
> 赞同：1
> 
> 时间：2009-05-20T11:38:46.740
> 
> 标签：asp.net, visual-studio-2008, telerik

我无法让 Intellisense 在 ASP.NET 源视图中工作。

例如，我使用标记前缀注册 Telerik RadControls DLL，如示例中所述：

```
<%@ Register Assembly="Telerik.Web.UI" Namespace="Telerik.Web.UI" TagPrefix="telerik" %> 
```

但是当输入 <telerik: 时没有出现智能感知。

此外，在添加几个控件后，它们会突出显示错误“无法识别的标签前缀或设备过滤器'telerik'”。这很烦人，我似乎找不到解决方案。

顺便说一句，网页本身可以工作 - 它只是 Intellisense 没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T06:40:27.073

Intellisense 可能由于各种原因而失败，所以我要问你几个问题：

1.  设计时是否按预期工作？有时如果未加载设计时程序集，智能感知可能会失败。
2.  您是否有机会在远程驱动器上工作？我们也发现了这方面的问题。需要将远程驱动器添加为程序集的受信任位置。
3.  如果您使用的是旧版本的 RadControls，您还需要添加对 Telerik.Charting.dll 的引用。您使用哪个版本？
4.  最后我们发现升级到 Visual Studio 2008 SP1 解决了很多问题。如果还没有，我强烈建议您升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-29T16:30:49.293

我注意到 VS2008（使用 SP1）中的智能感知存在一个普遍问题。当他们开始支持 JS 智能感知时，很多事情变得更慢 - 或者有时无法正常工作。

我知道描述问题 - 不仅是 Telerik 控件，我还从其他（和我自己的）控件库中知道它。大多数时候重建 - 关闭所有页面并重新启动 VS 为我解决了问题。

我的特殊问题（我想这很重要）是我使用的是德国版本的 VS2008。但还有其他规则（根据我的经验）：项目的大小（超过 50 页的情况变得更糟）。我在调试时不得不杀死一个应用程序的时间:) 一般我在一个项目上工作的时间（在一个会话中）。

最后一个提示（可能会有所帮助）当我直接在 web.config 中向控件添加引用时，我感觉问题较少。此外，它使我免于在每一页上都使用 register 指令。

它看起来像这样：

```
<controls>
<add assembly="Telerik.Web.UI" namespace="Telerik.Web.UI" tagPrefix="telerik" />
<add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, 
```

高温高压

曼弗雷德

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T15:59:08.480

ctrl + space 是触发它的快捷方式...

可能无济于事，但至少您会知道问题可能在于智能感知无法找到其数据。

你还有其他课程的智能感知吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T12:30:51.427

你的整个项目编译了吗？如果其他地方出现编译错误（甚至是其他页面中的编译错误），Intellisense 经常会中断。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-19T10:05:21.327

通过将 Telerik .dll 添加到我本地开发机器上的 GAC 中，我自己为 VS2008（用于 aspx/ascx*和代码隐藏）修复了这个问题。*

我之前遇到过这个问题，两次都是在我的项目托管在网络驱动器上时，项目的路径类似于：* *\\networkmachinename\c$\inetpub\projectname**

**修复：**

在本地计算机上，转到开始 > 程序 > Microsoft Visual Studio 2008 > Visual Studio 工具 > Visual Studio 2008 命令提示符（以管理员身份运行）

使用**gacutil**工具和以下命令（或更多取决于您希望使用的 .dll 数量），将程序集添加到您的 GAC：

gacutil.exe -i "C:\Program Files (x86)\Telerik\RadControls for ASPNET AJAX Q2 2008\Bin35\Telerik.Web.UI.dll"

gacutil.exe -i "C:\Program Files (x86)\Telerik\RadControls for ASPNET AJAX Q2 2008\Bin35\Telerik.Charting.dll"

显然，根据您的 OS/Telerik/Framework 版本修改目录，然后关闭 Visual Studio 2008 命令提示符，关闭 VS2008（如果打开）并再次重新启动 VS2008。

您会发现智能感知首先适用于 aspx/ascx 文件，几分钟后它也适用于您的代码隐藏文件。如果仍然不起作用，请关闭并重试。

另一个注意事项，如果您网站的根 web.config 文件中的某处有一个小错误，您还将失去 Telerik（可能还有其他）控件的智能感知 - 所以首先检查您的 web.config 文件是否有误。

# iphone - iPhone MoviePlayer 示例，按钮和标签从何而来

> ID：887430
> 
> 赞同：0
> 
> 时间：2009-05-20T11:39:58.190
> 
> 标签：iphone, video

我使用了名为“MoviePlayer”的 iPhone 示例，它向您展示了如何在 MPMoviePlayer 上添加叠加层。

这很好用，但我找不到他们在哪里设置按钮和标签？如何添加一些我自己的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T11:55:27.083

问得太早了。

然而，如果有人需要它：
1\. 使用界面生成器打开 MainWindow.xib（双击应该可以）
2\. 在 xib 窗口中，有一个名为“我的覆盖视图”的视图。

就是这个。

# sql-server - 编写正确的表描述

> ID：887431
> 
> 赞同：3
> 
> 时间：2009-05-20T11:40:24.693
> 
> 标签：sql-server, metadata

我是第一次为我的 SQL Server 表（从窗口`Description`中的字段`Properties`）编写描述，并且我开始思考在这样的字段中究竟要写什么。

例如，某些表格根据其标题是不言自明的……就像`Albums`在“音乐系统”中调用的表格一样。在这种情况下，您实际上会写什么描述？

您通常在描述中包含哪些“其他”信息？你提到表的关系吗？

**是否有一种标准的、正式的方式来为表格编写描述？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T11:49:51.727

我相信一个好的对象命名和设计加上最终可以使您的数据库结构可视化的工具（[例如 SQL Doc](http://www.red-gate.com/products/SQL_Doc/index.htm)）比为每个对象添加详细描述要好得多。

您想在描述中涵盖的越多，它就越有可能与真实的数据库结构不同步。例如，如果您想记录关系，那么每次更改它时，您都需要记住更新描述（在所有涉及的对象上？）它基本上是冗余信息，因为它已经记录在模式中。我们不希望数据库冗余吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T23:31:27.490

我还将包括该表与其他重要表的基数/关系。这似乎很明显，但通常并非如此。例如，对于 tblAddresses，您可能有以下描述：

"*此表是地址明细行 (tblAddressLines) 的父表，由雇员表 (tblEmployees) 引用（而非子表）*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:58:06.830

表描述应该使用 3 个简单的语句：一个描述表包含的内容，一个描述表中数据的初始状态（空或预填充），以及一个描述数据如何移入/移出表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T20:56:56.670

我会将使用该表的工作/程序/报告的名称放在描述中。这不太可能需要不断更新并回答为什么这个表存在的问题？（即这是谁的数据？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T23:41:41.227

如果您使用的是源代码控制，我想不出任何评论都不能更好地用作 SCC 评论。我认为这是多余的，除非您的组织有标准，否则不会使用它。

# crystal-reports - 本地化水晶报表

> ID：887433
> 
> 赞同：5
> 
> 时间：2009-05-20T11:40:59.513
> 
> 标签：crystal-reports, localization

在 Crystal Reports 上本地化标签（列标题、字段标签、页眉/页脚等）的好方法是什么？

我们目前使用的是 XI R2 SP4，但正在寻求迁移到 2008。看起来 2008 提供了更好的查看器 UI 本地化。它有内容本地化的故事吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-23T19:02:35.387

找到了一种方法来本地化诸如 Crystal Reports 中的 DateTimes 之类的值。
例如，如果日期是 2009 年 8 月，文化是法语，那么将显示为 août-2009。
所有这一切都无需将当前的 Thread 文化切换为法语。

相关代码片段（示例）：

```
 //Locale must be set BEFORE report is opened 
            if (this.IsEnglish)
            {
                ReportDoc.ReportClientDocument.PreferredViewingLocaleID =
                    CrystalDecisions.ReportAppServer.DataDefModel.CeLocale.ceLocaleEnglishCanada;
                ReportDoc.ReportClientDocument.LocaleID =
                    CrystalDecisions.ReportAppServer.DataDefModel.CeLocale.ceLocaleEnglishCanada;
                ReportDoc.ReportClientDocument.ProductLocaleID =
                    CrystalDecisions.ReportAppServer.DataDefModel.CeLocale.ceLocaleEnglishCanada;
            }
            else
            {
                ReportDoc.ReportClientDocument.PreferredViewingLocaleID =
                    CrystalDecisions.ReportAppServer.DataDefModel.CeLocale.ceLocaleFrenchCanada;
                ReportDoc.ReportClientDocument.LocaleID =
                    CrystalDecisions.ReportAppServer.DataDefModel.CeLocale.ceLocaleFrenchCanada;
                ReportDoc.ReportClientDocument.ProductLocaleID =
                    CrystalDecisions.ReportAppServer.DataDefModel.CeLocale.ceLocaleFrenchCanada;
            }

            //Load the report from file path 
            ReportDoc.Load(reportPath.ToString()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T11:47:23.823

我能想到的两个选项是：1）每个本地化版本都有一个单独的报告（这会很快变得丑陋，我不太推荐它）或 2）从应用程序生成报告（比如 ac# windows /web app），然后您可以使用 .net 的本地化标准进行本地化，并在代码中设置所有本地化文本（从资源文件中读取）。

我不确定 2008 年，但我们也在 XI R2 上。我们对每种语言都有本地化报告，但这只是因为我们 * 知道 * 我们只需要三个不同的本地化版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-09T15:07:15.807

一位客户要求我为他们制定本地化策略。我一直想写一篇关于它的文章。多亏了你，我已经做到了。 [http://www.cogniza.com/blog/?p=55](http://www.cogniza.com/blog/?p=55)

编辑：

我能够使用引用本地化值数据库的嵌入式子报表（在报表标题部分中）。我会在我的帖子中添加它，但它非常复杂。

另一种选择是创建处理此任务的用户函数库 (UFL)。将数据存储在数据库或 XML 文件中。但是，您很可能会失去 ContentLocale 功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-03T01:20:10.920

我们终于开始实施报告本地化。Crystal Reports 的加载已经是我们应用程序中用户体验中最滞后/性能最差的部分，因此我们希望避免任何性能影响。另一个决定我们决定的想法是翻译不会在发布的版本中改变。

我们开发了一个使用 Crystal Reports API（2008 - 因此没有 RDC）并分两个阶段工作的应用程序。

第一阶段是抓取所有文本并输出到英文 .resx 文件。其中最困难的部分是识别函数中的可翻译文本，并用表示“不翻译”的标记替换嵌入字段。

在 resx 的本地化版本回来后，应用程序的第二阶段将每个报告与每个 resx 一起保存，并用翻译文本替换英文的新报告。这也使我们能够将仅在日语报告中的字体切换为 MS Gothic，从而避免需要许可“通用”字体。“通用”字体（例如 Arial Unicode MS）中的日文字符看起来像废话。

Crystal API 是拜占庭式的，在检测函数和嵌入字段中的可翻译字符串时，您需要小心处理边缘情况。小心像 PageNofM 这样的内置字段，它们没有用花括号括起来（更不用说你应该用 {field} 的 Page {field} 替换它，以便可以翻译“page”和“of”）。一个指针，使用控制器将现有项目替换为克隆/修改的副本，您不能只修改项目的文本内容。如果你走这条路，祝你好运，但最终我们认为这是最好的选择。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-11-25T10:39:45.417

单晶报表用于多种语言

```
if (CultureInfo.CurrentCulture.Name == "en-US")
{
   (obj.ReportDefinition.ReportObjects["lbleverest"] as TextObject).Text = resBundle.GetString("Localization", "everest");
   (obj.ReportDefinition.ReportObjects["lblmandlicode"] as TextObject).Text = resBundle.GetString("Localization", "SocietyCode");
   (obj.ReportDefinition.ReportObjects["MandliName1"] as FieldObject).ApplyFont(new Font(resBundle.GetString("Localization", "Font"), Convert.ToInt32(resBundle.GetString("Localization", "FontSize")), FontStyle.Regular));
   (obj.ReportDefinition.ReportObjects["shortName1"] as FieldObject).ApplyFont(new Font(resBundle.GetString("Localization", "Font"), Convert.ToInt32(resBundle.GetString("Localization", "FontSize")), FontStyle.Regular));        
}    
else    
{    
   (obj.ReportDefinition.ReportObjects["lbleverest"] as TextObject).Text = resBundle.GetString("Localization", "everest");    
   (obj.ReportDefinition.ReportObjects["lblmandlicode"] as TextObject).Text = resBundle.GetString("Localization", "SocietyCode");    
   (obj.ReportDefinition.ReportObjects["MandliName1"] as FieldObject).ApplyFont(new Font(resBundle.GetString("Localization", "Font"), Convert.ToInt32(resBundle.GetString("Localization", "FontSize")), FontStyle.Regular));    
   (obj.ReportDefinition.ReportObjects["shortName1"] as FieldObject).ApplyFont(new Font(resBundle.GetString("Localization", "Font"), Convert.ToInt32(resBundle.GetString("Localization", "FontSize")), FontStyle.Regular));    
}

obj.DataDefinition.FormulaFields["lang"].Text = "'" + CultureInfo.CurrentCulture.Name + "'";    
cv.crystalReportViewer1.ReportSource = obj;    
cv.Show(); 
```

# delphi - 在 Delphi 中按名称“复制”单元，由组件引用，编译问题

> ID：887435
> 
> 赞同：2
> 
> 时间：2009-05-20T11:41:30.403
> 
> 标签：delphi, delphi-units

我们正在使用不同供应商的多个组件包，其中两个在其目录结构中都有一个“regexp.pas”单元。

现在的问题是，无论我们编译它们的顺序如何，其中一个都会抱怨使用其他各种单元的错误版本来编译该单元。

有什么办法可以正确处理吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T12:49:00.733

在任何完全链接和加载的 Delphi 可执行文件中，没有两个单元可以具有相同的名称，无论这些单元是静态链接的还是通过包动态链接的。正如您得出的结论，您必须重命名其中一个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T11:59:54.093

1.  您必须确保您只有该单元的一个版本
2.  删除所有 dcu（两家供应商的）以强制重新编译所有源代码。
3.  完全卸载 2 个供应商的软件包（确保每个地方的每个痕迹都被删除）
4.  一次重新编译和安装一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-21T17:22:46.573

您可以使用此解决方法。

如前所述，您不能将两个供应商包**一起**加载到 IDE 中。

但是，如果您一次需要一个，您可以使用*“-r”命令行开关***启动两个不同的 IDE 配置文件**，为每个配置文件指定一个自定义名称。然后，您可以使用第一个配置文件启动 Delphi，并安装两个“冲突”包中的第一个，关闭 IDE 并使用第二个配置文件运行 Delphi，然后安装另一个包。

 *为每个配置文件创建一个快捷方式，然后运行 ​​Delphi，选择加载您需要维护特定项目的包的配置文件。

问候，~/|/|arco。

# c# - 如何获取配置元素

> ID：887437
> 
> 赞同：6
> 
> 时间：2009-05-20T11:41:54.300
> 
> 标签：c#, configuration, web-config, app-config

直升机

谁能解释我如何从 .config 文件中获取配置元素。我知道如何处理属性而不是元素。例如，我想解析以下内容：

```
<MySection enabled="true">

 <header><![CDATA[  <div> .... </div>  ]]></header>

 <title> .... </title>

</MySection> 
```

到目前为止，我的 c# 代码如下所示：

```
 public class MyConfiguration : ConfigurationSection
    { 
        [ConfigurationProperty("enabled", DefaultValue = "true")]
        public bool Enabled
        {
            get { return this["enabled"].ToString().ToLower() == "true" ? true : false;   }
        }

        [ConfigurationProperty("header")]
        public string header
        {
                ???
        }
  } 
```

它适用于属性，我如何处理元素（上面代码中的标题属性）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T08:00:12.470

还有另一种方法可以做同样的事情。

我们可以通过覆盖`DeserializeElement`方法创建一个元素来获取字符串值：

```
public class EmailTextElement : ConfigurationElement {

    public string Value { get; private set; }

    protected override void DeserializeElement(XmlReader reader, bool s) {
        Value = reader.ReadElementContentAs(typeof(string), null) as string;
    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T11:59:30.990

这是一个非常好的自定义配置部分设计器工具，您可以使用（而且它是免费的）：

[配置部分设计器](http://www.codeplex.com/csd)

编辑：

我正在研究 MSDN，似乎自定义配置部分不能做你想要的，即。从元素获取配置值。自定义配置元素可以包含其他配置元素，但配置值始终来自属性。

也许您可以将您的 html 片段放入其他文件并从配置中引用它们，就像这样。

```
<MySection enabled="true"> 
  <header filename="myheader.txt" />
  <title filename="mytitle.txt" />
</MySection> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-11T18:33:57.167

继承 ConfigurationElement 类并重写其反序列化方法。使用新类来表示具有文本内容的元素。

[http://www.codeproject.com/KB/XML/ConfigurationTextElement.aspx](http://www.codeproject.com/KB/XML/ConfigurationTextElement.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-13T17:46:39.297

使用您的示例，您将覆盖 ConfigurationElement 中“标题”的反序列化以获取 CDATA 值。

```
<MySection enabled="true">

  <header name="foo"><![CDATA[  <div> .... </div>  ]]></header>

  <title> .... </title>

</MySection>
```

```
 public sealed class HeaderSection: ConfigurationElement {
      private string __Name, __CDATA;

      [ConfigurationProperty("name", IsRequired = true)]
      public string Name {
        get {
          return this.__Name;
        }
        set {
          this.__Name = value;
        }
      }

      [ConfigurationProperty("value", IsRequired = true)]
      public string Value {
        get {
          return this.__CDATA;
        }
        set {
          this.__CDATA = value;
        }
      }

      protected override void DeserializeElement(System.Xml.XmlReader reader, bool s) {
        this.Name = reader.GetAttribute("name").Trim();
        string cdata = reader.ReadElementContentAs(typeof(string), null) as string;
        this.Value = cdata.Trim();
      }
    }
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T11:47:56.207

您可以使用[ConfigurationManager.GetSection("SectionName")](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.getsection.aspx)方法获取配置文件中的配置部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T18:29:06.333

我终于找到了一种方法。

有 IConfigurationSectionHandler 接口允许我想要的东西。它需要编写方法的人

```
 public object Create(object parent, object configContext, XmlNode section) 
```

之后，你自己解析*部分*，这样我就可以毫无问题地获取 XmlElement：

```
 header  = s["header"]  != null ? s["header"].InnerText   : String.Empty;
        title   = s["title"]   != null ? s["title"].InnerText    : String.Empty; 
```

不利的一面是接口已经过时，但 MSDN 声明它不会从框架的未来版本中删除，因为它在内部使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T18:45:16.323

您可以创建一个继承自 System.Configuration.ConfigurationElement 的类，该类表示配置部分中的一个元素。

[MSDN 文档中](http://msdn.microsoft.com/en-us/library/system.configuration.configurationelement.aspx)有一个 ConfigurationElement 的简单示例。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-03-27T11:43:26.510

根据[MSDN](http://msdn.microsoft.com/en-us/library/kyx77cz3%28v=VS.100%29.aspx)，在**.NET 4**中有一个新属性，它为您提供对表示当前实例所属的配置层次结构`CurrentConfiguration`的顶级实例的引用。`Configuration``ConfigurationElement`

# subsonic - SubSonic 创建者

> ID：887441
> 
> 赞同：0
> 
> 时间：2009-05-20T11:42:46.797
> 
> 标签：subsonic

我在数据类型为 int 的表中有一个 CreatedBy 列。SubSonic 崩溃是因为它显然使用了 CreatedBy、CreatedOn、ModifiedBy 和 ModifiedOn。By 列必须是字符串。

有没有办法让 SubSonic 知道它必须忽略这些列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T11:56:58.170

不，您可能必须将该列重命名为 CreateByUser 或其他名称。

您还可以将其更改为 nvarchar(50) 并创建列 ModifiedBy nvarchar(50) 并使其也可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T16:49:34.697

是的......这是完全可行的。首先向我们展示导致它崩溃的代码。我大概知道那是什么。你可能正在尝试做这样的事情

```
MyRecord.Save(); 
```

您需要在哪里传递创建记录的人的 ID。

```
MyRecord.Save(55); 
```

SubSonic 知道你的列是什么数据类型，所以你不需要告诉它它是什么数据类型。此外，如果您查看 Save 方法的重载，即 Save(int id)、Save(string id) 和 Save(Guid id)。因此，只要您为 CreateBy 列使用 int、string 或 guid 就可以了，您只需要记住在使用这些列时按照 SubSonic 的预期传递 ID。

# java - Java 方法 - 将方法作为参数

> ID：887444
> 
> 赞同：5
> 
> 时间：2009-05-20T11:43:24.203
> 
> 标签：java, methods

我遇到了一些我不能在这里分享的代码，但它在另一个**方法**的参数列表中**声明**了一个方法。我什至不知道这是可能的。我真的不明白它为什么这样做。有人可以向我解释一下您作为程序员可能会这样做的用途吗？（注意：由于我无法显示代码，因此我一般不期望有上下文解释）

 **### 有关的：

> [Java 中最接近函数指针的替代品是什么？](https://stackoverflow.com/questions/122407/whats-the-nearest-substitute-for-a-function-pointer-in-java)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-20T11:51:50.600

代码看起来像这样吗？

```
obj.someMethod(myVar,3,new FooObject() {
  public void bar() {
    return "baz";
  }
}); 
```

如果是这样，那么该方法不会作为参数传递给另一个方法，而是正在创建一个[匿名内部类，并且该类的一个实例作为参数传递。](http://java.sun.com/docs/books/tutorial/java/javaOO/nested.html)

在上面的例子`FooObject`中是一个没有实现该`bar()`方法的抽象类。我们创建抽象类的实例并提供与其余代码一致的抽象方法的实现， 而不是创建`private class`扩展。`FooObject`

您不能创建抽象类的实例，因此我们必须提供缺少的方法来创建完整的类定义。由于这个新类是动态创建的，因此它没有名称，因此是**匿名**的。因为它是在另一个类中定义的，所以它是一个匿名**内部**类。

它可能是一个非常方便的快捷方式，尤其是对于`Listener`类而言，但如果您忘乎所以并且行内方法定义太长，它会使您的代码难以遵循。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-20T13:23:22.910

你见过[函数式 Java](http://functionaljava.org/)吗？这是一个非常有趣的库，可以让您像在[Scala](http://scala-lang.org/)中一样进行编程。 [我写](http://codemountain.wordpress.com/)了这个库。我承认最好使用更灵活的语法（BGGA 闭包），例如 Scala。

使用具有高阶函数（如列表中的 map）的函数式 Java，我们有：

```
final List<Integer> numbers = list(1, 2, 3, 4, 5);  

List<Integer> c = numbers.map(new F<Integer, Integer>() {  
                 public Integer f(Integer arg) {  
                   return arg * arg;  
                  }  
              }); 
```

另一个有用的库是[lambdaj](http://code.google.com/p/lambdaj/)，它提供了像函数式（FP）编程一样的好方法。与 FP 语言相比，Java 的语法有限。但是你仍然可以利用FP风格的一些优势，但你必须要有创意！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-20T11:46:12.793

在 Java 中，您不能将方法作为参数传递。难道它传递的不是一个方法，而是一个匿名的内部类？

这对于在类之间传递行为很有用。谷歌“依赖注入”或“控制反转”以获取更多信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-20T13:17:18.400

在 Java 中传递函数指针最接近的方法是传递抽象类或接口的匿名实例。例如，一个泛型函数类型可以在这样的接口中编码：

```
public interface F<A, B> {
  public B f(final A a);
} 
```

然后，您可以期待另一个方法的参数列表中的方法：

```
public List<B> map(List<A> as, F<A, B> f) {
  ...
} 
```

您可以使用该接口的匿名实例调用它：

```
map(myList, new F<Integer, String>() {
  public String f(Integer i) {
    return String.valueOf(i);
  }
}); 
```

有一个名为[Functional Java](http://functionaljava.org)的库正是利用这个想法为光荣的 Java 语言带来了巨大的好处。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-20T11:47:54.913

使用[java.lang.reflect.Method](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/reflect/Method.html)

## 例子

```
public void callMethod(Method aMethod, int value) throws Exception {
    aMethod.invoke(this, value);
}

public void print(Integer value) {
    System.out.print(value);
}

public void println(Integer value) {
    System.out.println(value);
}

public void demo() throws Exception {
    Method println = this.getClass().getMethod("println", Integer.class);
    Method print = this.getClass().getMethod("print", Integer.class);
    callMethod(println, 10);
    callMethod(print, 10);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-20T13:01:45.840

你也可以这样做：

```
final Predicate somePredicate = new Predicate<Item>() 
  {
  @Override
  public boolean apply(Item item)
    {
    return item.someProperty().equals(something);
    }
  } 
```

并像这样使用它：

```
List<Item> filteredList = filter(list, somePredicate); 
```

我以前做过类似的事情。我还编写了使用闭包以类似方式构建和返回接口的匿名实现的方法：

```
Predicate isSomeColor(final Color color)
  {
  return new Predicate<Shape>() 
    {
    @Override
    public boolean apply(Shape shape)
      {
      return shape.getColor().equals(color);
      }
    }
  }

List<Shape> redShapes = filter(shapes, isSomeColor(Color.RED); 
```

所有这些仍然是匿名的内部类。我实际上没有在任何地方命名类本身，我只是引用了该类的一个实例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-20T11:46:27.413

它本身不是 Java 中的合法语法。是不是创建了一个匿名类的新实例？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-20T14:00:14.663

最接近函数参数的是

一个匿名类的实例，只有一种方法。

```
 Runnable a = new Runnable(){

   run(){
    System.out.println("hello");
        }
    }

  myMethod(a); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-20T11:46:23.747

这称为[反射](http://java.sun.com/docs/books/tutorial/reflect/index.html)。有一个完整的对象库，表示构造函数、方法等。
例如，您可以使用它来调用在运行时确定的动态[方法。](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/reflect/Method.html)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-20T12:07:12.143

是的，可以在另一个方法的参数列表中声明一个方法。您可以查看 java.lang.reflect.Method

使用反射，您检索一个 Method 对象，该对象表示您希望作为参数传递的方法。然后您可以调用 Method 来调用以调用该方法。

此外，您可以参考“Java 语言中的函数式编程”（*http://www.ibm.com/developerworks/java/library/j-fp.html*），它可以为您提供由内而外的示例。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-20T12:13:08.700

关于它是否可能，上面的答案各不相同。可以通过反思吗？是否可以通过使用匿名内部类？我们需要澄清这一点。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-22T15:25:04.773

不是指针，但您仍然可以通过一些技巧内联编写函数。

在另一个[线程](https://stackoverflow.com/questions/4685563/how-to-pass-a-function-as-a-parameter-in-java)上检查我的[答案](https://stackoverflow.com/a/19521916/1423539)

# filter - WordPress 插件：在 the_content 中查找

> ID：887447
> 
> 赞同：0
> 
> 时间：2009-05-20T11:44:50.940
> 
> 标签：filter, wordpress

我正在编写一个过滤**the_content**的 WordPress 插件，我想使用该`<!--more-->`标签，但它似乎在它到达我的时候已经被剥离了。这似乎不是过滤器，而是 WordPress 工作方式的一个功能。

我当然可以求助于从数据库中重新加载已经加载的内容，但这听起来可能会导致其他麻烦。有什么好方法可以让我在不`<!--more-->`删除的情况下获取原始内容吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-21T16:48:58.683

很有可能，当您的插件运行时，`<!--more-->`已经转换为`<span id="more-1"></span>`

这是我在插件中使用的，它在标签之后立即注入一些标记`<!--more-->`：

```
add_filter('the_content', 'inject_content_filter', 999);

function inject_content_filter($content) {
  $myMarkup = "my markup here<br>";
  $content = preg_replace('/<span id\=\"(more\-\d+)"><\/span>/', '<span id="\1"></span>'."\n\n". $myMarkup ."\n\n", $content);
  return $content;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T06:59:29.803

您可以使用以下代码：

!is_single() 将避免在查看帖子页面中显示更多链接。

```
add_filter('the_content', 'filter_post_content');
function filter_post_content($content,$post_id='') {

        if ($post_id=='') {
            global $post;
            $post_id = $post->ID;
        }

        // Check for the "more" tags
        $more_pos = strpos($filtered_content, '<!--more-->');
        if ($more_pos && !is_single()) {
            $filtered_content = substr($filtered_content, 0, $more_pos);

            $replace_by = '<a href="' . get_permalink($post_id) . '#more-' . $post_id 
                    . '" class="more-link">Read More <span class="meta-nav">→&lt;/span></a>';

            $filtered_content = $filtered_content . $replace_by;
        }

        return $filtered_content;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-31T12:25:46.273

根据[Frank Farmer 的回答](https://stackoverflow.com/a/893895/4519702)，我解决了`<span id="more-...`在 single.php 文件中生成的更多标记 () 之后添加缩略图照片：

```
// change more tag to post's thumbnail in single.php
add_filter('the_content', function($content)
{
    if(has_post_thumbnail())
    {
        $post_thumbnail = get_the_post_thumbnail(get_the_ID(), 'thumbnail', array('class'=>'img img-responsive img-thumbnail', 'style'=>'margin-top:5px;'));
        $content = preg_replace('/<span id\=\"(more\-\d+)"><\/span>/', '<span id="\1"></span>'.$post_thumbnail, $content);
    }
    return $content;
}, 999); 
```

# java - 以抽象为参数声明方法的接口

> ID：887452
> 
> 赞同：0
> 
> 时间：2009-05-20T11:46:19.503
> 
> 标签：java, interface

我对以下示例中的最佳实践有疑问：

```
interface Request;
interface Service {
  void process(Request request)
}

class MyService implements Service;
class YourService implements Service;

class MyRequest implements Request;
class YourRequest implements Request; 
```

但是如何确保`MyService`将始终接收`MyRequest`和`YourService`只会得到`YourRequest`，而不是相反的方式？明显的答案“if-instance-of-check”`MyService.process(...)`似乎很丑陋，并且在某种程度上违反了 SOLID 原则。也许有更好的方法？

也许泛型会是一个很好的解决方案？（但是，如何在必须在 Java 1.4 下运行的代码中使用它们？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T11:54:00.393

简而言之，您正在建立一个您不想遵守的界面，因此它并不是一个真正理想的设计。

我的意思是，如果 MyService 实现了 Service，那么它必须能够接受任何类型的请求。否则它不遵循定义的合同。

我会质疑为什么在这种情况下你有 Service 接口，如果你确实需要它（对于其他方法），如果子类不支持它，是否适合使用 process(Request request) 方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T12:26:48.890

如果合约的设计是每个 Service 可以处理任何类型的请求，那么你的 MyService 实现，它只接受 MyRequest （如果传入其他类型的请求则中断）是错误的。

如果契约的设计是Service 和Request 子类相互映射，例如MyService 可以（并且应该）*只*处理一个MyRequest，那么您将需要更改Service 的接口。否则，问题中编写的当前界面不会执行问题描述的操作。一种解决方法是参数化 Service 接口：

```
interface Service<R> {
   void process(R request);
} 
```

那么你的具体 MyService 将是

```
public class MyService implements Service<MyRequest> {
   public void process (MyRequest r) {/*blah*/}
} 
```

你可以在 JDK 中看到一个这样的例子—— Comparator 接口正是这样做的，原因完全相同。[http://java.sun.com/javase/6/docs/api/java/util/Comparator.html](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)

我不明白你为什么会这样做，但如果你仍然想将 MyRequest 的层次结构限制为请求，那么你可以`Service<R>`交换`Service<R extends Request>`

编辑：这显然不在 1.4 中运行，所以要做同样的事情[1]，你需要使用访问者模式。它更丑，但 1.4 更丑 =)

```
interface Service {
   void process(Request visitor);
}
interface RequestVisitor {
   void visitMyRequest(MyService service);
   void visitYourRequest(YourService service);
   void visitTheOtherRequest(TheOtherService  service);
}
interface Request extends RequestVisitor { /* and any extra methods required for request*/ }
public class MyService implements Service {
   public process(Request r) {r.visitMyRequest(this);}
   public void doSpecialMyProcessing(MyRequest request) { /* your code using MyRequest*/ }
}
public class YourService implements Service {
   public process(Request r) {r.visitYourRequest(this);}
   public void doSpecialYourProcessing(YourRequest request) { /* your code using YourRequest */ }
}
public class MyRequest implements Request {
   void visitMyRequest(MyService service) {
      service.doSpecialMyProcessing(this);
   }
   void visitYourRequest(YourService service) {
      throw new UnsupportedOperation("Cannot call visitYourRequest in MyRequest!");
   }
   void visitTheOtherRequest(TheOtherService  service) {
      throw new UnsupportedOperation("Cannot call visitTheOtherRequest in MyRequest!");
   }
}
public class YourRequest implements Request {
   void visitMyRequest(MyService service) {
      throw new UnsupportedOperation("Cannot call visitMyRequest in YourRequest !");
   }
   void visitYourRequest(YourService service) {
      service. doSpecialYourProcessing(this);
   }
   void visitTheOtherRequest(TheOtherService  service) {
      throw new UnsupportedOperation("Cannot call visitTheOtherRequest in YourRequest !");
   }
} 
```

[1]*实际上不一样*，因为现在您需要为每个请求子类型编写一个方法。在 1.4 中，您必须强制转换并执行 instanceof 等，以实现 1.5 可以使用泛型执行的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-20T11:56:52.040

在我看来，泛型在这里更适合。您的接口假装服务可以处理任何类型的请求。但事实上，每一个的实现似乎都是紧密耦合的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T11:55:36.957

任何实现 Service 的东西都应该按原样实现它的方法。如果 MyService 和 YourService 需要不同的方法原型，那么它们就是不同的接口。

从另一个方向考虑。在不知道 Service 接口背后的实现的情况下，任何调用者都应该能够使用 Request 的任何实现调用 Service.process(request)，并期望收到有效的响应。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T11:59:39.727

尝试引入另一个级别的间接：

```
interface Module {
   Service createService();
   Request createRequest();
}

class MyModule implements Module {
   Service createService() { return new MyService(); } 
   Request createRequest() { return new MyRequest(); }
}

class YourModule implements Module {
   Service createService() { return new YourService(); } 
   Request createRequest() { return new YourRequest(); }
} 
```

# .net - Windows 服务将文件写入网络共享

> ID：887456
> 
> 赞同：2
> 
> 时间：2009-05-20T11:46:41.890
> 
> 标签：.net, file-io, windows-services, impersonation

我有一个正在运行的 Windows 服务，它将文件从监视文件夹 (IO.FileSystemWacher) 移动到网络上的 UNC 共享。

网络共享是安全的，但共享对服务用户具有完全控制权；尽管如此，我还是遇到了找不到文件路径的问题。

我打算冒充服务（当前）用户，但不确定这是否是正确的方法。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T11:50:37.387

首先检查路径是你认为的。

要检查权限，您可以在服务帐户的身份下运行 Internet Explorer (do runas)，然后将路径放在 URL 框中，以检查服务帐户是否可以访问该路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-20T11:54:18.177

检查这些：

*   您的服务用户是域帐户吗？（本地账户不行）
*   服务用户是否对 UNC 共享具有 NTFS 写入权限？（共享级权限还不够，还必须有NTFS权限）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:50:28.857

尝试授予运行该服务的计算机的计算机帐户对共享的访问权限。或者，在域帐户下运行服务（显然可以访问共享）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T12:01:33.030

您如何访问共享？不是挂载目录吗？所以让我们说 \server1\direcotry1 安装到 z:\directory1 或类似的东西。如果是这样，您必须确保服务用户“看到”已安装的目录。或者使用标准 UNC 路径（使用 double `\`）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-20T12:01:58.067

FileSystemWatcher 是否总是无法连接到 UNC 共享，还是在 watcher 运行后发生？

我已经看到，如果您重新启动监视文件夹所在的计算机，则在另一台计算机上运行的 FileSystemWatcher 将不再看到更改事件。要解决此问题，您需要重新启动观察程序。我相信您可以使用 EnableRaisingEvents 属性来执行此操作。

# asp.net - 如何将图像设置为 asp.net 页面的背景？

> ID：887457
> 
> 赞同：0
> 
> 时间：2009-05-20T11:46:58.770
> 
> 标签：asp.net

我只是想将图像设置为 asp.net 页面的背景。我可以在网页上以简单格式显示图像，但不能将其用作背景。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-20T11:51:06.747

使用 CSS。如果您使用的是主题或 CSS 文件，请添加到主题...

```
body {
  background-image: url(images/image.png);
} 
```

最佳实践建议将其放在单独的文件中，而不是文档的头部——而且肯定不是内联的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-20T11:48:52.960

设置 body 元素的背景图片样式：

```
<body style="background-image:url(bgr.jpg);">
...
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:49:45.860

这是一个基本的 HTML 东西，你需要做一些 CSS 例如：

```
<style type="text/css">
body {
  background-image: url(background.jpg);
}
</style> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-02T09:54:58.070

```
 Using db As New MITLibrary.MITLibraryDataContext
                imagelink.NavigateUrl = db.SelectInnerBannerByPID(1).FirstOrDefault.Link
                bodyimage.ImageUrl = db.SelectInnerBannerByPID(1).FirstOrDefault.image
                bodyimage.ImageUrl = bodyimage.ImageUrl.Replace("~/SystemAssets/", "~/EchoBusV3.0/SystemAssets/")
                lnk1.Attributes.Add("Style", "background:url(" + bodyimage.ImageUrl + ") no-repeat top center; background-size:cover; min-height:280px;")
                lblTitle.Text = db.SelectInnerBannerByPID(1).FirstOrDefault.Title
                lblbrief.Text = db.SelectInnerBannerByPID(1).FirstOrDefault.Brief
                Lbltitle2.Text = db.SelectInnerBannerByPID(2).FirstOrDefault.Title
                Lblbreaf2.Text = db.SelectInnerBannerByPID(2).FirstOrDefault.Brief
                HyperLink1.NavigateUrl = db.SelectInnerBannerByPID(2).FirstOrDefault.Link
                Image3.ImageUrl = db.SelectInnerBannerByPID(2).FirstOrDefault.image
                Image3.ImageUrl = Image3.ImageUrl.Replace("~/SystemAssets/", "~/EchoBusV3.0/SystemAssets/")
                lnk2.Attributes.Add("Style", "background:url(" + Image3.ImageUrl + ") no-repeat top center; background-size:cover; min-height:280px;")

                If (db.SelectInnerBannerByPID(1).First.Target = 1) Then

                    imagelink.Target = "_blank"
                Else
                    imagelink.Target = "_parent"
                End If
                If (db.SelectInnerBannerByPID(2).First.Target = 1) Then

                    imagelink.Target = "_blank"
                Else
                    imagelink.Target = "_parent"
                End If

            End Using
        Catch ex As Exception

        End Try 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-06-14T06:04:40.140

```
<body background="images/bg4.gif">
</body> 
```

# wordpress - 如何防止带有子项的主菜单项在 Wordpress 中被点击？

> ID：887464
> 
> 赞同：1
> 
> 时间：2009-05-20T11:48:41.777
> 
> 标签：wordpress, menu, menuitem

这是我的网站： [http](http://wake9.com/blogs/norcal-merced-wakesurfing-competition-2009/) ://wake9.com/blogs/norcal-merced-wakesurfing-competition-2009/ 。

注意菜单项“照片和结果”。将鼠标悬停在它上面，您将看到子菜单项。我希望能够单击子菜单项，但主菜单项不应是页面或可单击。我能在菜单上得到这个项目的唯一方法是把它变成一个页面。有没有办法让一个菜单项包含子菜单项的内容，但实际的菜单项是不可点击的？我正在考虑使用 JQuery 删除锚标记，但这是一个真正的 hack，我想知道是否有更简单的方法。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T12:20:40.527

一种选择是使用[页面链接](http://txfx.net/code/wordpress/page-links-to/)插件并将主链接设置为 ' **#** '。我试过这个，它在我的博客中有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-21T20:11:03.427

使用[jQuery.remove](http://docs.jquery.com/Manipulation/remove)删除元素怎么样？

像这样的东西：

```
function removeLinkAttrib() {
  var attrib =  jQuery(#menus).find("a").attr("Photos and Results");
  jQuery(attrib).remove;
} 
```

我不确定是否**$(attrib).remove;** 会工作，但你会得到图片:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-06T19:09:41.803

（此答案适用于使用 Wordpress.com 免费网站的人）：

您可以转到外观 > 菜单，然后通过单击左侧栏中的“链接”向菜单添加自定义链接，并添加“#”作为 URL（以及您想要的任何标签）。然后将此链接添加到菜单中。在“菜单结构”中打开新菜单项的选项，然后从 URL 中删除“#”，使该字段为空白，并保存更改。现在您可以向此菜单项添加子菜单，并且主菜单上将没有此项目的链接......对我有用。

# .net - 如何在 OnStart 方法中停止服务？

> ID：887470
> 
> 赞同：5
> 
> 时间：2009-05-20T11:49:59.370
> 
> 标签：.net, windows-services, .net-2.0, service

我正在.net 2.0 中编写 Windows 服务。

`OnStart()`如果出于某种原因我不希望我的服务启动，我应该在该方法中做什么？我可以简单地调用`Stop()`基类（`ServiceBase`）的方法吗？我已经尝试过了，并且得到了一些有趣的内存访问异常。是否需要启动一个单独的线程来调用该`Stop()`方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-20T11:52:53.500

你为什么要这样做？如果有错误，将其记录在事件日志中并抛出异常。您的服务将不会启动，并且会通知用户发生了一些不好的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T11:52:57.430

使用 ServiceController 并通过它停止它，然后立即返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-20T11:56:57.483

您可以使用[Environment.FailFast()](http://msdn.microsoft.com/en-us/library/ms131100.aspx)。请注意，它会忽略任何 try-catch-finally 块。

# nhibernate - NHibernate 属性公式过滤器

> ID：887474
> 
> 赞同：6
> 
> 时间：2009-05-20T11:50:53.893
> 
> 标签：nhibernate, hibernate

我有以下课程：

```
MyClass
public virtual int Id { get; set; }
public virtual int Code { get; set; }
public virtual int Description { get; set; }
public virtual int Name { get; set; } 
```

使用以下映射：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="TestApplication" assembly="TestApplication">
  <class name="MyClass" table="MyTable">
    <id name="Id" column="id">
      <generator class="native"/>
    </id>

    <property name="Code" column="code"/>
    <property name="Description" column="description"/>
    <property name="Name" formula="(SELECT b.translation FROM translations b WHERE b.translation_id = translation_id AND b.language_id = :TranslationFilter.LanguageId)"/>
  </class>

  <filter-def name="TranslationFilter">
    <filter-param name="LanguageId" type="Int32"/>
  </filter-def>
</hibernate-mapping> 
```

我正在尝试通过spring加载实体：

```
Session.EnableFilter("TranslationFilter").SetParameter("LanguageId", 1);
return Session.Get<MyClass>(1); 
```

但我得到了异常。我看到（在分析器中）变量 :TranslationFilter.LanguageId 没有被替换为 ? 并且该参数值不发送到服务器？

这是否可能（在公式中有过滤器）以及如何？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-28T06:40:35.220

此功能不受官方支持。因此，关于 2 个不同功能（公式和过滤器）的组合的 oren 博客文章应该持保留态度......

# java - 在 JFlex 中跟踪状态

> ID：887485
> 
> 赞同：6
> 
> 时间：2009-05-20T11:53:04.340
> 
> 标签：java, parsing, jflex, jsyntaxpane

我正在编写一个自定义 flex 文件来生成一个用于 JSyntaxpane 的词法分析器。

我需要 lex 的自定义语言具有不同的状态，可以在一种堆栈中相互嵌入。

在 IE 中，您可以编写一个包含单引号字符串的表达式，然后使用特殊标记 eval() 在字符串中嵌入另一个表达式。但您也可以将表达式嵌入双引号字符串中。

例如：

```
someExpressionFunction('a single-quoted string with an eval(expression) embedded in it', "a double-quoted string with an eval(expression) embedded in it") 
```

这是一个简化，有比这更多的状态，但假设我需要为 DOUBLE_STRING 和 SINGLE_STRING 设置不同的状态，它充分描述了我的情况。

确保在关闭 eval 表达式后返回正确状态的最佳方法是什么（即，如果我在双引号中，则返回 DOUBLE_STRING，如果我在单引号中，则返回 SINGLE_STRING）

我提出的可行的解决方案是使用 Stack 和一些自定义方法来跟踪状态，而不是使用 yybegin 来启动不同的状态。

```
private Stack<Integer> stack = new Stack<Integer>();

public void yypushState(int newState) {
  stack.push(yystate());
  yybegin(newState);
}

public void yypopState() {
  yybegin(stack.pop());
} 
```

这是实现这一目标的最佳方式吗？是否有我可以利用的更简单的 JFlex 内置功能或我应该了解的最佳实践？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-30T08:40:55.330

我认为这是一种非常好的方法。我实际上需要一些类似的功能来将 Groovy GString、Python like String 和一些 HTML 添加到 JavaDocs。

我还想添加的是一个 Lexer 调用 Lexer 来解析子部分。类似于嵌入在 HTML 中的 JavaScript。但我没有时间去做。

我喜欢 StackOverflow，但只是想知道你为什么不在 JSyntaxPane 的问题上发布这个？

# asp.net - ASP.NET - Multiple Validation总结

> ID：887486
> 
> 赞同：0
> 
> 时间：2009-05-20T11:53:29.333
> 
> 标签：asp.net, validation

**场景**：我试图在一个页面上插入一个团队（由多人组成）。我有一个 Web 用户控件来插入每个人，当一个团队有多个人时，会同时显示几个 Web 用户控件。

每个用户都有一个 ValidationSummary 和几个验证器（全部分组到同一个验证组，例如 person1 Web 用户控件在 de Validation summary 和每个验证器上都有验证组设置为“valGroup_Person1”）。

问题是当验证发生时，所有错误都被分组并显示在所有 Web 用户控件中，使得每个 Web 用户控件显示一个很长的错误列表。预期的是个别错误列表。

有没有办法让 ValidationSummary 以这种方式执行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T13:21:20.623

如果您使用的是 asp.net 2.0，那么您必须使用验证组，这将起作用。

请参阅下面的示例，它将起作用

```
 `<asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
    ControlToValidate="TextBox1" ErrorMessage="RequiredFieldValidator" 
    ValidationGroup="1">1</asp:RequiredFieldValidator>
<asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" 
    ControlToValidate="TextBox2" ErrorMessage="RequiredFieldValidator2" 
    ValidationGroup="2">2</asp:RequiredFieldValidator>
<asp:ValidationSummary ID="ValidationSummary1" runat="server" 
    ValidationGroup="1" />
<asp:ValidationSummary ID="ValidationSummary2" runat="server" 
    ValidationGroup="2" />
<asp:Button ID="Button1" runat="server" Text="Button" ValidationGroup="1" />
<asp:Button ID="Button2" runat="server" Text="Button" ValidationGroup="2" />` 

            回答 #2

赞同：0

时间：2009-07-06T18:05:29.287

您必须通过在每个控件上给它们单独的名称来消除验证组的歧义。例如，在用户控件的 page-init 中：

```
Private Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init
    Dim uniqueGroupName = Guid.NewGuid.ToString
    valSummary.ValidationGroup = uniqueGroupName
    txtFirstName.ValidationGroup = uniqueGroupName
    txtLastName.ValidationGroup = uniqueGroupName
    btnFind.ValidationGroup = uniqueGroupName
End Sub 
```

（对于组中的每个控件，以编程方式为其指定一个验证组）

如果您正在进行服务器端验证，您应该只为组调用验证，例如

```
Page.Validate(valSummary.ValidationGroup)
If Not Page.IsValid then Exit Sub
... 
```

        asp-classic - VBScript VarType 函数给出了奇怪的值

ID：887495

赞同：3

时间：2009-05-20T11:55:35.617

标签：asp-classic, vbscript

我遇到了一个奇怪的问题，即从数据库中获取数据并使用 VBScript for ASP 将其转换为正确的类型。

我使用以下函数检索了一个记录集：

```
Public Function vfuncGetRS(strQuery)
    'Returns a disconnected paging capable recordset
    'Note - Non Windows servers don't support disconnected recordsets so you'll always get a connected recordset on
    '   a non Windows server!

    On Error Resume Next
    Err.Clear

    Dim objData

    Set objData = Server.CreateObject("ADODB.Recordset")
    objData.CursorLocation = adUseClient
    objData.CursorType = adOpenStatic
    objData.LockType = adLockReadOnly
    objData.Open vlogSQLFilter(strQuery), objDB

    If Not blnUNIXMode Then
        Set objData.ActiveConnection = Nothing
    End If

    Set vfuncGetRS = objData
End Function 
```

如果我从记录集中选择一个值并获取它的 VarType 它返回值 16 例如。

```
Set objRS = vfuncGetRS("SELECT * FROM SOME_TABLE")
Response.Write(VarType(objRS("someColumn"))) 
```

奇怪之处在于两部分

1.  这仅发生在特定服务器上，此代码是我在多个站点上部署的 CMS 的一部分，并且只有在 IIS 6.0 上运行的实例会导致我出现问题。这似乎也取决于记录集选项。
2.  根据官方 MSDN 参考，值 16 不是 VarType 返回的有效值

我可以通过向受奇怪值影响的函数添加检查来相当容易地解决这个问题，如下所示

```
If VarType(strValue) = 16 Then strValue = CInt(strValue) 
```

我必须执行上述操作，因为我需要有问题的函数来正确检测类型是数字，如果 VarType 为 16，那么即使变量中的值是数字， IsNumeric() 也会给出 false（并且它始终是数字）

所以我的问题是有人知道为什么会这样吗？

            回答 #1

赞同：3

时间：2009-05-20T19:12:35.110

如前所述`Stijn`，值 16 意味着它是一个***`One Byte Variant`***，在[C++ 头文件](http://msdn.microsoft.com/en-us/library/ms221627.aspx)中指定为`VT_I1`.

而且您之所以获得这个值，是因为 MySQL 连接驱动程序（正如您所说，遇到这个 16 值的环境是带有 MySQL 的 IIS6）。

显然这是 MySQL 驱动程序中的一个错误，它不是报告`adBoolean`BIT 字段而是 Reporting `VT_I1`。

            回答 #2

赞同：0

时间：2009-05-20T15:39:45.397

据此[，](http://www.google.com/codesearch?hl=nl&lr=&q=vartype%20VT_%20%3D16) 16 可能代表 VT_I1，因此是单字节有符号整数。

        php - 在 JQuery 中从控制器中检索值

ID：887498

赞同：2

时间：2009-05-20T11:56:57.173

标签：php, jquery, cakephp

我是 Jquery 的新手。如何从我的控制器中检索值并将它们与 JQuery 中的一些字符串进行比较？

```
 $(".select"+increment).change(function () 
            {

          if("here i need the value from my controller " =='String')
               {
       $("<label id=labelstr"+stringinc+"  >"+labelname+"</label>").appendTo(".menu li");
       $("<input id=inputstr"+stringinc+" type= 'text' ></input>").appendTo(".menu li");
              }
         } 
```

            回答 #1

赞同：1

时间：2009-05-20T12:15:51.487

[编辑]：这个答案是如果控制器是指在 ASP.NET MVC 项目的 ViewData 对象中传递的控制器数据。[/编辑]

该脚本必须在 aspx/ascx 中（而不是在单独的 JS 文件中）。

```
 <script language="Javascript">

       $(".select"+increment).change(function () 
            {

          if("<%=ViewData["YourData"] %>" =='String')
               {
       $("<label id=labelstr"+stringinc+"  >"+labelname+"</label>").appendTo(".menu li");
       $("<input id=inputstr"+stringinc+" type= 'text' ></input>").appendTo(".menu li");
              }
         }
    </script> 
```

            回答 #2

赞同：0

时间：2009-05-20T18:44:22.747

您的问题非常令人困惑，但我会尽力提供帮助。我将假设您想通过 AJAX 检索此信息。我还将假设您的 CakePHP 控制器在调用时会输出以下内容（您可以通过以下网址找到：[http://yoursite/Forms/views](http://yoursite/Forms/views)）：

`This is some random string`

为了按照我的假设使用它，您需要这样做：

```
<script language="javascript">
$(function() {
    $(".select"+increment).change(function () {
        $.get('/Forms/views',{},function(data) {
            if(data == 'This is some random string') {
                // I have no idea where you are getting the
                // 'stringinc' and 'labelname' variables from.
                $("<label id=labelstr"+stringinc+"  >"+labelname+"</label>").appendTo(".menu li");
                $("<input id=inputstr"+stringinc+" type= 'text' ></input>").appendTo(".menu li");
            }
        });
    });
});
</script> 
```

现在，如果您尝试按照 Oliver 建议的方式进行操作（除了在 CakePHP 中），您需要这样做：

```
<script language="javascript">
$(function() {
    $(".select"+increment).change(function () {
        // I'm not familiar with Cake, you might need to use
        // some sort of template syntax. Either way, whatever
        // method you need to use to get the value into you view
        // let's just assume its called '$value_from_controller'.
        var data = <?= $value_from_controller; ?>;
        if(data == 'This is some random string') {
            // I have no idea where you are getting the
            // 'stringinc' and 'labelname' variables from.
            $("<label id=labelstr"+stringinc+"  >"+labelname+"</label>").appendTo(".menu li");
            $("<input id=inputstr"+stringinc+" type= 'text' ></input>").appendTo(".menu li");
        }
    });
});
</script> 
```

我希望这在某种程度上有所帮助。

        asp.net - 在页面中水平居中内容

ID：887501

赞同：1

时间：2009-05-20T11:57:33.647

标签：asp.net, css

我想在一个 800px 宽的 div 中显示我的所有内容，在页面中居中。这样，所有浏览器窗口的宽度都得到满足。我该怎么做呢？

            回答 #1

赞同：6

时间：2009-05-20T11:59:20.443

如下设置您的 div CSS：

```
#container {
  width: 800px;
  margin: 0 auto;
} 
```

            回答 #2

赞同：4

时间：2009-05-20T15:42:09.107

我还建议添加`text-align:left;`到容器 div 并添加`text-align:center;`到 body 标记。原因是 Internet Explorer 6.0 不会处理自动边距。

```
body {
      text-align:center;}

#container {
      margin: 0px auto;
      text-align:left;
      width: 800px;} 
```

        performance - 优先考虑 Erlang 节点

ID：887502

赞同：2

时间：2009-05-20T11:57:39.700

标签：performance, erlang, benchmarking, messaging, bandwidth-throttling

假设我有一个由 n 个[Erlang](http://en.wikipedia.org/wiki/Erlang_%28programming_language%29)节点组成的集群，其中一些可能在我的 LAN 上，而另一些可能使用 WAN（即通过 Internet）连接，有什么合适的机制来满足 a) 不同的带宽可用性/行为（例如，引起的延迟）和b）具有不同计算能力的节点（甚至是内存限制）？

换句话说，我如何优先考虑具有大量计算能力的本地节点，而不是那些具有高延迟并且可能不太强大的节点，或者我如何在理想情况下优先考虑具有高传输延迟的高性能远程节点来专门执行这些进程相对巨大的计算/传输（即每条消息，每时间单位完成的工作）比率？

我主要考虑通过向集群中的每个节点发送一个基准过程以在初始化期间运行来对它们进行基本基准测试，以便可以计算消息传递所涉及的延迟以及整体计算速度（即使用一个节点-特定的计时器来确定节点终止任何任务的速度）。

可能，类似的事情必须重复进行，一方面是为了获得代表性数据（即平均数据），另一方面它甚至可能在运行时有用，以便能够动态调整改变运行时条件。

（在同样的意义上，人们可能希望优先考虑本地运行的节点而不是其他机器上运行的节点）

这意味着有望优化内部作业调度，以便特定节点处理特定作业。

            回答 #1

赞同：1

时间：2009-05-22T08:07:54.840

您正在谈论的问题已经在网格计算的背景下以许多不同的方式得到解决（例如，参见[Condor](http://www.cs.wisc.edu/condor/)）。为了更彻底地讨论这个问题，我认为需要一些额外的信息（要解决的问题的同质性，对节点的控制程度[即是否存在意外的外部负载等？]）。

实现自适应作业调度程序通常还需要调整探测可用资源的频率（否则探测的开销可能会超过性能增益）。

理想情况下，您可能能够使用基准测试来提出一个经验（统计）模型，该模型允许您预测给定问题的计算难度（需要良好的领域知识和对执行速度有很大影响的问题特征，并且是易于提取），另一个用于预测通信开销。将两者结合使用应该可以实现一个简单的调度程序，该调度程序基于预测模型做出决策，并通过考虑实际执行时间作为反馈/奖励来改进它们（例如，通过[强化学习](http://en.wikipedia.org/wiki/Reinforcement_learning)）。

            回答 #2

赞同：1

时间：2009-06-16T22:13:18.283

我们已经做了类似的事情，仅在我们的内部 LAN/WAN 上（WAN 是例如旧金山到伦敦）。问题归结为以下因素的组合：

1.  简单地通过本地（内部）调用进行远程调用的开销
2.  节点的网络延迟（作为请求/结果负载的函数）
3.  远程节点的性能
4.  执行功能所需的计算能力
5.  如果存在共享的“静态”数据集，则调用批处理是否提供任何性能改进。

对于 1\. 我们假设没有开销（与其他开销相比可以忽略不计）

对于 2\. 我们使用探测消息主动测量它来测量往返时间，我们从实际调用中整理信息

对于 3\. 我们在节点上测量它并让它们广播该信息（这取决于节点上的负载电流而变化）

对于 4 和 5。我们根据经验对给定批次进行了计算

然后调用者解决了获得一批调用的最小解决方案（在我们的例子中为一大堆衍生品定价）并将它们分批发送到节点。

使用这种技术，我们可以更好地利用我们的计算“网格”，但这需要付出相当多的努力。我们还有一个额外的优势，即网格仅由该环境使用，因此我们有更多的控制权。添加互联网组合（可变延迟）和网格的其他用户（可变性能）只会增加复杂性并可能减少回报......

        c# - ASP.Net MVC - 回发时未填充集合的模型

ID：887505

赞同：10

时间：2009-05-20T11:59:10.257

标签：c#, asp.net-mvc

我有一个 ASP.Net MVC 应用程序，它的模型包含一个集合，该模型深几层。  

我相信创建对象的视图都设置正确，但是当我将表单发布到服务器时，它只是没有填充模型中的集合。

我有一段数据可以在类层次结构中找到，因此：

```
person.PersonDetails.ContactInformation[0].Data; 
```

这个类结构是由 LinqToSQL 创建的，ContactInformation 的类型是`EntitySet<ContactData>`. 要创建视图，我通过以下内容：

```
return View(person); 
```

在视图中，我有一个表单，其中包含一个文本框，其名称与上述字段相关联：

```
<%= Html.TextBox("person.PersonDetails.ContactInformation[0].Data")%> 
```

我的控制器中的 post 方法如下：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create (Person person)
{
  //Do stuff to validate and add to the database 
} 
```

正是在这一点上，我迷失了 person.PersonDetails.ContactInformation.Count() ==0。因此，ModelBinder 创建了一个 ContactInformation 对象，但没有用它应该在索引 0 处保存的对象（即 ContactData）填充它。

我的问题有两个： 1\. 我是否采取了正确的方法.. 即这是否可行？2\. 关于为什么它可能无法填充 ContactInformation 对象的任何想法？

非常感谢，理查德

            回答 #1

赞同：21

时间：2009-05-20T12:18:40.110

我认为您的模型太复杂，无法使用默认模型绑定器。您可以尝试使用多个参数并将它们与前缀绑定：

```
public ActionResult Create( 
    Person person,
    [Bind(Prefix="Person.PersonDetails")]
    PersonDetails details,
    [Bind(Prefix="Person.PersonDetails.ContactInformation")] 
    ContactInformation[] info )
{
      person.PersonDetails = details;
      person.PersonDetails.ContactInformation = info;

      ...
} 
```

或者，您可以开发自己的自定义模型绑定器，该绑定器将了解如何从表单输入中派生复杂模型。

            回答 #2

赞同：5

时间：2009-05-20T12:38:21.193

如果属性为空，则模型绑定器其他人无法找到它或无法在提交的表单中找到创建该属性类型实例所需的值。例如，如果属性具有不可为空的 ID，并且您的表单不包含该 ID 的任何数据，则模型绑定器会将属性保留为 null，因为它无法在不知道 ID 的情况下创建该类型的新实例。

换句话说，要诊断这个问题，您必须仔细比较提交表单中的数据（这在 Firebug 或 Fiddler 中很容易看到）与您期望模型绑定器填充的对象的结构。如果缺少任何必填字段，或者如果提交的值无法转换为必填字段的类型，则整个对象将保留为空。

            回答 #3

赞同：1

时间：2009-05-22T03:34:21.470

我一直在同类型的场景中苦苦挣扎，最终意识到根本问题是 MVC 默认模型绑定器似乎不适用于 EntitySet<T> 字段，只有 List<T> 字段。但是，我确实找到了一个似乎可以接受的简单解决方法。就我而言，我有一个与联系人具有一对多关系的公司实体（我的 Linq-to-Sql EntitySet）。

由于似乎当我将代码从 EntitySet<Contact> 更改为 List<Contact> 时，MVC 默认模型绑定器开始按预期工作（即使现在不是 LTS），我想我会提供一个替代的“别名" List<Contact> 类型的 MVC 的属性，果然，这似乎有效。

在我的公司实体类中：

```
 // This is what LINQ-to-SQL will use:
private EntitySet<Contact> _Contacts = new EntitySet<Contact>();
[Association(Storage="_Contacts", OtherKey="CompanyID", ThisKey="ID")]
public EntitySet<Contact> Contacts
{
    get { return _Contacts; }
    set { _Contacts.Assign(value); }
}

// This is what MVC default model binder (and my View) will use:
public List<Contact> MvcContacts
{
    get { return _Contacts.ToList<Contact>(); }
    set { _Contacts.AddRange(value); }
} 
```

所以现在，在我看来，我有以下几点：

```
`<label>First Name*
    <%= Html.TextBox("Company.MvcContacts[" + i + "].FirstName") %>
</label>
<label>Last Name*
    <%= Html.TextBox("Company.MvcContacts[" + i + "].LastName") %>
</label>` 
```

`似乎像魅力一样工作！` 祝你好运！-麦克风

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:05:55.580

也许缺少 Bind 属性是这种情况：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Create ([Bind] Person person)
{
// Do stuff to validate and add to the database 
} 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:10:43.027

Html.TextBox 的第一个参数是文本框的名称，第二个参数是值。

“错误的”：

```
<%= Html.TextBox("person.PersonDetails.ContactInformation[0].Data")%> 
```

“正确的”：

```
<%= Html.TextBox("nameoftextbox", person.PersonDetails.ContactInformation[0].Data)%> 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2016-02-10T21:30:59.900

确保您的模型（以及所有嵌套模型）使用属性（getter/setter）而不是字段。显然，默认活页夹需要属性才能正常运行。我有一个非常相似的情况，通过将必要的字段更改为属性来解决。

# c++ - 何时为 gcc 使用 -O2 标志？

> ID：887509
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-05-20T11:59:48.510
> 
>         
> 
> 标签：c++, unix, optimization, gcc

如果我使用“-O2”标志，性能会提高，但编译时间会变长。

我如何决定是否使用它？

也许 O2 在某些特定类型的代码（例如数学计算？）中发挥了最大的作用，我应该只将它用于项目的那些部分？

编辑：我想强调一个事实，即为我的项目的所有组件设置 -O2 会将总编译时间从 10 分钟更改为 30 分钟。

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-05-20T12:12:16.580

我建议大多数时候使用 -O2，好处包括：

*   通常会减小生成代码的大小（与 -O3 不同）。

*   更多警告（某些警告需要仅在优化期间进行的分析）

*   通常会显着提高性能（这可能无关紧要）。

如果发布级代码将启用优化，最好在整个开发/测试周期中启用优化。

启用优化后，源代码级调试更加困难，有时在调试问题时禁用优化会很有帮助。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-05-20T12:04:40.060

我在生物信息学领域，所以我的建议可能有偏见。也就是说，我*总是*使用**`-O3`**开关（用于发布和测试版本，也就是说；通常不用于调试）。诚然，它有一定的缺点，即增加编译时间并且通常会增加可执行文件的大小。

但是，第一个因素可以通过良好的构建策略和其他减少整体构建时间的技巧来部分缓解。此外，由于大多数编译实际上是 I/O 绑定的，因此编译时间的增加通常并不*那么*明显。

第二个缺点，可执行文件的大小，通常根本不重要。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T12:09:55.633

绝不。

使用 -O3 -Wall -Werror -std=[无论你的代码库应该遵循什么]

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T12:03:15.880

总是，除非你正在编程并且只是想测试你刚写的东西。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T18:04:59.787

我们通常会设置构建环境，以便我们可以构建使用 -O0 的*调试构建和**发布*使用 -O3 的构建（构建环境保留所有配置的对象和库，以便可以轻松地在配置之间切换）。在开发过程中，为了更快的构建速度（和更准确的调试信息），主要构建和运行调试配置，并且不太频繁地构建和测试发布配置。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-05-22T14:40:00.760

增加的编译时间真的很明显吗？我一直使用 -O2 作为默认值，任何更少的东西都会在你的代码中留下很多“摩擦”。另请注意，-O1、-O2 的优化级别往往是经过最佳测试的，因为它们最有趣。-O0 往往更容易出错，根据我的经验，您可以在 -O2 上很好地调试。如果您对编译器在代码重新排序、内联等方面可以做什么有所了解。

-Werror -Wall 是必要的。

# java - 在等待确认消息的java中实现同步网络调用？

> ID：887512
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T11:59:59.727
> 
>         
> 
> 标签：java, asynchronous, synchronous

你将如何在 Java 中实现等价的方法调用，直到完成方法调用？

基本上我想要做的是有一种方法，它通过网络向服务器应用程序发送消息，并等待它从服务器获得适当的 Ack 消息，操作成功完成或操作失败并出现错误消息。

我已经有了我的方法的非阻塞版本，它传递了一个回调类，其中有一个在回调中调用的方法。

构造一个回调类将其传递给我以前的方法然后执行等待操作并在回调上让该类执行通知是否有意义？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:07:26.077

将 .wait() 添加到回调类将是最简单的路径。它可以在某个标志上旋转，直到您的回调切换它，只要确保在循环中包含 Thread.yield() 或 .sleep() 即可。

无需重写替代阻塞通信通道。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:29:22.447

是的，按照您的建议使用您现有的方法。在同步方法调用中创建回调，该回调将通过 wait()/notify() 与同步方法调用协调。同步方法将调用异步方法，然后调用 wait()。当回调被调用时，它会调用 notify() 来唤醒同步方法以便返回结果。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:03:16.847

简短的回答：是的。我已经很喜欢使用类库中的内容，您所描述的内容听起来很像观察者模式，假设您使用的是 J2SE，那么您已经拥有观察者/可观察的接口。

编辑：我的咖啡出了点问题 :) 显然，我的意思是检查 java.util.concurrent 包中的内容，特别是 Future<> 和 ExecutorService 类。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:18:57.813

如果您不使用 JMS，请忽略。

如果您使用的是 JMS，那么您可以使用[QueueRequestor](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/jms/QueueRequestor.html)，它是[Request Reply 集成模式](http://www.enterpriseintegrationpatterns.com/RequestReply.html)的实现。

也就是说，即使使用了异步消息，以下调用对客户端来说也是同步的：

```
QueueRequestor requestor = null;
try {
    requestor = new QueueRequestor(session, queue); 
    Message response = requestor.send(request);
} finally {
    if (requestor == null) {
        try {
            requestor.close();
        } catch (JMSException e) {
            // log error message
        }
     }
} 
```

# google-maps - 如何增加谷歌地图中图标的可点击区域

> ID：887514
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T12:00:12.160
> 
>         
> 
> 标签：google-maps

我们正在尝试增加谷歌地图上标记的可点击区域。我们想要这样做的原因是点击图标有时会错过锚点。我们宁愿不减小图标大小

我们假设 GIcon 对象的属性之一是我们需要更改的，并尝试更改 GIcon 的 iconAnchor 和 infoWindowAnchor 属性，但这似乎不起作用。

有人指出我们正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-11-02T22:41:55.803

我知道已经有一段时间了，但我遇到了同样的问题，假设您的图标宽 51 像素，高 32 像素：

```
var baseIcon = new GIcon(G_DEFAULT_ICON);
baseIcon.imageMap = [0,0 , 51,0, 51,32 , 0,32]; 
```

基本上你只是输入 x,y 坐标

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-08-03T11:36:56.273

如果您有不同的图标，最好动态创建 imageMap：

```
function getImgSize(imgSrc) {
   var newImg = new Image();
   newImg.src = imgSrc;
   var height = newImg.height;
   var width = newImg.width;
   return [height,width];
}

var icon = new GIcon(G_DEFAULT_ICON,iconUrl);
var iconSize = getImgSize(iconUrl);
icon.iconSize = new GSize(iconSize[1], iconSize[0]); // set icon size
icon.imageMap = [0,0, icon.iconSize.width,0, icon.iconSize.width,icon.iconSize.height,0,icon.iconSize.height]; // set click area
icon.shadowSize = new GSize(0, 0); // disable shadow 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:10:14.900

参考：[http ://code.google.com/apis/maps/documentation/reference.html#GIcon](http://code.google.com/apis/maps/documentation/reference.html#GIcon)

iconAnchor 和 infoWindowAnchor 分别设置地图上的实际点和信息窗口在图像中的位置。

如果您想要更大的可点击区域，您可以使用非 IE 的 imageMap 属性做一些事情（我从未尝试过）。但是，我认为您最好的选择是定义一个使用更大图像的自定义 GIcon（用透明空间填充。不幸的是，这有点像 hack——也许其他人知道更好的方法。

* * *

## 回答 #4

> 赞同：-2
> 
>             
> 
> 时间：2009-06-02T11:25:58.300

最后，我们缩小了图像的大小。我们没有注意到推荐的图形尺寸是 19x19

# asp.net - StackTrace 可以在什么时候使用
在 web.config 中？

> ID：887518
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:01:19.363
> 
>         
> 
> 标签：asp.net, web-config, stack-trace

我知道我以编程方式检查它   

```
 ConfigurationSection configSection =
      (CompilationSection) ConfigurationManager.GetSection( "system.web/compilation" ); 
```

我知道它在生产中也有点慢......但是如果我们处于一种测试阶段，它还没有伤害......

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:18:34.167

是的，它在调试和发布版本中都可用，但如果 PDB 处于调试模式，它将包含更多数据（例如源代码行号）。

# c# - WPF UserControl 如何继承 WPF UserControl？

> ID：887519
> 
>         
> 
> 赞同：99
> 
>         
> 
> 时间：2009-05-20T12:01:19.910
> 
>         
> 
> 标签：c#, wpf, xaml, user-controls

以下名为**DataTypeWholeNumber**的 WPF UserControl有效。

现在我想制作一个名为**DataTypeDateTime**和**DataTypeEmail**等的 UserControl。

许多依赖属性将由所有这些控件共享，因此我想将**它们的常用方法放入 BaseDataType**并让这些 UserControl 中的每一个都继承自此基本类型。

但是，当我这样做时，我收到***错误： Partial Declaration may not have different base classes***。

那么如何使用 UserControls 实现继承，以便共享功能都在基类中呢？

```
using System.Windows;
using System.Windows.Controls;

namespace TestDependencyProperty827.DataTypes
{
    public partial class DataTypeWholeNumber : BaseDataType
    {
        public DataTypeWholeNumber()
        {
            InitializeComponent();
            DataContext = this;

            //defaults
            TheWidth = 200;
        }

        public string TheLabel
        {
            get
            {
                return (string)GetValue(TheLabelProperty);
            }
            set
            {
                SetValue(TheLabelProperty, value);
            }
        }

        public static readonly DependencyProperty TheLabelProperty =
            DependencyProperty.Register("TheLabel", typeof(string), typeof(BaseDataType),
            new FrameworkPropertyMetadata());

        public string TheContent
        {
            get
            {
                return (string)GetValue(TheContentProperty);
            }
            set
            {
                SetValue(TheContentProperty, value);
            }
        }

        public static readonly DependencyProperty TheContentProperty =
            DependencyProperty.Register("TheContent", typeof(string), typeof(BaseDataType),
            new FrameworkPropertyMetadata());

        public int TheWidth
        {
            get
            {
                return (int)GetValue(TheWidthProperty);
            }
            set
            {
                SetValue(TheWidthProperty, value);
            }
        }

        public static readonly DependencyProperty TheWidthProperty =
            DependencyProperty.Register("TheWidth", typeof(int), typeof(DataTypeWholeNumber),
            new FrameworkPropertyMetadata());

    }
} 
```

* * *

## 回答 #1

> 赞同：140
> 
>             
> 
> 时间：2009-05-20T12:03:08.940

确保您已将 xaml 中的第一个标记更改为也继承自您的新基类型

所以

```
<UserControl x:Class="TestDependencyProperty827.DataTypes.DataTypeWholeNumber"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"        
    xmlns:s="clr-namespace:System;assembly=mscorlib"
    > 
```

变成

```
<myTypes:BaseDataType x:Class="TestDependencyProperty827.DataTypes.DataTypeWholeNumber"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"        
    xmlns:s="clr-namespace:System;assembly=mscorlib"
    xmlns:myTypes="clr-namespace:TestDependencyProperty827.DataTypes"
    > 
```

* * *

因此，总结完整的答案，包括以下评论中的额外细节：

*   基类不应包含 xaml 文件。在单个（非部分）cs 文件中定义它，并将其定义为直接从 Usercontrol 继承。

*   确保子类在 cs 代码隐藏文件和 xaml 的第一个标记中都继承自基类（如上所示）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2014-01-31T09:07:55.820

```
public partial class MooringConfigurator : MooringLineConfigurator
    {
        public MooringConfigurator()
        {
            InitializeComponent();
        }
    }

<dst:MooringLineConfigurator x:Class="Wave.Dashboards.Instruments.ConfiguratorViews.DST.MooringConfigurator"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:dst="clr-namespace:Wave.Dashboards.Instruments.ConfiguratorViews.DST"
    mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400">

    <Grid x:Name="LayoutRoot" Background="White">

    </Grid>
</dst:MooringLineConfigurator> 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2012-01-30T21:52:34.340

我在这篇文章中找到了答案：http: [//www.paulstovell.com/xmlnsdefinition](http://www.paulstovell.com/xmlnsdefinition)

基本上说的是你应该在 AssemlyInfo.cs 文件中定义一个 XML 命名空间，它可以在 XAML 中使用。它对我有用，但是我将基本用户控件类放在单独的 DLL 中......

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2015-09-10T08:54:39.527

设计者创建了部分类定义，您可以通过 InitializeComponent() 方法定义轻松打开它。然后只需将部分类继承从 UserControl 更改为 BaseDataType（或您在类定义中指定的任何内容）。

之后，您将收到 InitializeComponent() 方法隐藏在子类中的警告。

因此，您可以将 CustomControl 作为基类而不是 UserControl 以避免在基类中进行部分定义（如一条评论中所述）。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2013-09-12T14:32:13.730

我遇到了同样的问题，但需要从抽象类继承控件，设计器不支持。解决我的问题是让用户控件继承自标准类（继承用户控件）和接口。设计师就是这样工作的。

```
//the xaml
<local:EcranFiche x:Class="VLEva.SIFEval.Ecrans.UC_BatimentAgricole" 
                  xmlns:local="clr-namespace:VLEva.SIFEval.Ecrans"
                  ...>
    ...
</local:EcranFiche>

// the usercontrol code behind
public partial class UC_BatimentAgricole : EcranFiche, IEcranFiche
{
    ...
}

// the interface
public interface IEcranFiche
{
   ...
}

// base class containing common implemented methods
public class EcranFiche : UserControl
{
    ... (ex: common interface implementation)
} 
```

# c++ - 将指针转换为 shared_ptr

> ID：887524
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T12:02:31.310
> 
>         
> 
> 标签：c++, pointers

我有一些返回指向对象（B）的指针的库代码（我不能不更改源代码）。我想将此指针作为 shared_ptr 存储在具有此类构造函数的类下：

```
class A
{
  public:
   A(boost::shared_ptr<B> val);
   ...
  private:
   boost::shared_ptr<B> _val;
   ...
};

int main()
{
   B *b = SomeLib();
   A a(b); //??
   delete b;
   ...
} 
```

也就是说，我想做一个b的深拷贝并控制它在a下的生命周期（即使原始b被删除（删除b），我在a下仍然有一个精确的副本）。

我是新手，对不起，如果它看起来微不足道......

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:52:48.307

如果库定义了这个 B 对象，则库应该提供（或完全禁止）复制 B 的机制。

作为旁注，

如果您的 A 类专门控制此复制对象的生命周期，那么您真正想要使用的智能指针是`boost::scoped_ptr`.

`boost::shared_ptr`以分担终生责任的能力命名，这听起来像是你不想要的。  `scoped_ptr`不会让这种意外发生。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:06:58.993

正如您所说，您必须复制它们而不仅仅是复制指针。所以要么 B 已经实现了“克隆”方法，要么你必须实现一些外部`B* copy(B* b)`的，这将创建具有相同状态的新 B。

如果 B 已经实现了复制构造函数，您可以将复制实现为

```
B* copyOf(B* b)
{
    return new B(*b);
} 
```

如果 B 已实现[克隆方法或类似方法，](http://en.wikipedia.org/wiki/Prototype_pattern)您可以将复制实现为

```
B* copyOf(B* b)
{
    return b->clone();
} 
```

然后你的代码看起来像

```
int main()
{
   B *b = SomeLib();
   A a(copyOf(b));
   delete b;
   ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:11:20.403

深度复制在 C++ 中由复制构造函数轻松实现，因为在 C++ 中，默认情况下*所有*对象都具有值语义。但是，以这种方式复制不适用于多态对象——在这种情况下，您必须`clone`在类中实现一个虚拟覆盖的方法。

但在所有其他情况下，只需编写

```
A(boost::shared_ptr<B> val) : _val(new B(*val)) { } 
```

会做。

# svn - 相当于 svn 中的 perforce 作业

> ID：887526
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:03:00.000
> 
>         
> 
> 标签：svn, perforce

是否有与 svn 中的 perforce 作业等效的机制来对相关更改进行分组？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:14:43.330

不，至少，不是开箱即用。这种修订元数据必须存储在其他地方，例如[Trac](http://trac.edgewall.org/)或其他构建在 SVN 存储库之上的系统。遗憾的是，我还没有找到另一个像 Perforce 一样出色的 SCM。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-05-20T12:51:10.730

要对相关更改进行分组，您可以使用更改[列表](http://svn.collab.net/repos/svn/trunk/notes/changelist-design.txt)

从我读到的关于工作的内容来看，它们有点像错误跟踪参考。

要在提交时关联错误引用，您必须在 SVN 之上实现一些东西（因为 SVN 没有集成的错误跟踪器），但您还必须说明您确实想要与哪个错误跟踪器集成 - 并且意味着技术会有所不同。在所有情况下，bugtracker-association 都是在 post-commit 钩子中执行的。

例如，我使用 Mantis 作为我的 bugtracker，当我提交更改时，如果我在日志消息中输入了一些神奇的词（例如“Fixed Bug #1234”或“Fixed Mantis #1234”），那么提交后hook 将使用 curl 将该消息和提取的错误编号发送到 Mantis URL 并自动解决错误（并将日志消息文本添加到错误注释）。

对于 bugtracker，您可以替换任何其他 API 驱动的系统。

# algorithm - 20 道题 AI 算法是如何工作的？

> ID：887533
> 
>         
> 
> 赞同：106
> 
>         
> 
> 时间：2009-05-20T12:04:19.217
> 
>         
> 
> 标签：algorithm, artificial-intelligence

由 20 个问题组成的简单在线游戏，由极其准确的 AI 提供支持。

他们怎么猜得这么好？

* * *

## 回答 #1

> 赞同：58
> 
>             
> 
> 时间：2009-05-20T13:21:20.043

您可以将其视为二分搜索算法。在每次迭代中，我们都会提出一个问题，该问题应该消除大约一半的可能单词选择。如果总共有 N 个单词，那么我们可以期望在 log2(N) 个问题之后得到答案。

有 20 个问题，我们应该能够在 2^20 = 100 万个单词中找到一个单词。

消除异常值（错误答案）的一种简单方法可能是使用类似[RANSAC](http://en.wikipedia.org/wiki/RANSAC)的东西。这意味着，您无需考虑所有已回答的问题，而是随机选择一个较小的子集，这足以给您一个答案。现在你用不同的随机问题子集重复几次，直到你看到大多数时候，你得到了相同的结果。然后你就知道你有正确的答案。

当然，这只是解决这个问题的许多方法中的一种。

* * *

## 回答 #2

> 赞同：27
> 
>             
> 
> 时间：2009-05-20T12:13:20.290

我建议在这里阅读有关游戏的信息：[http ://en.wikipedia.org/wiki/Twenty_Questions](http://en.wikipedia.org/wiki/Twenty_Questions)

特别是计算机部分：

> 该游戏表明，识别任意对象所需的信息（由香农熵统计量测量）约为 20 位。在向人们教授信息论时，该游戏经常被用作示例。在数学上，如果每个问题的结构都消除了一半的对象，那么 20 个问题将允许提问者区分 2 ^(20)或 1,048,576 个主题。因此，对于二十个问题，最有效的策略是提出的问题每次都会将剩余可能性的范围大致分成两半。该过程类似于计算机科学中的二进制搜索算法。

* * *

## 回答 #3

> 赞同：26
> 
>             
> 
> 时间：2009-05-20T13:37:17.127

决策树直接支持这种应用。决策树通常用于人工智能。

决策树是一棵二叉树，它在每个分支处询问“最佳”问题，以区分由其左右子节点表示的集合。最佳问题由 20 个问题应用程序的创建者用来构建树的一些学习算法确定。然后，正如其他海报所指出的，一棵 20 层深的树会给你一百万件事。

在每个点定义“最佳”问题的一种简单方法是寻找一个最均匀地将集合分成两半的属性。这样，当您对该问题的回答是“是/否”时，您在每个步骤中都会删除大约一半的集合。这样你就可以近似二分搜索。

维基百科给出了一个更完整的例子：

[http://en.wikipedia.org/wiki/Decision_tree_learning](http://en.wikipedia.org/wiki/Decision_tree_learning)

和一些一般背景：

[http://en.wikipedia.org/wiki/Decision_tree](http://en.wikipedia.org/wiki/Decision_tree)

* * *

## 回答 #4

> 赞同：16
> 
>             
> 
> 时间：2010-01-18T21:04:55.040

它自称是“互联网上的神经网络”，关键就在这里。它可能将问题/答案概率存储在备用矩阵中。使用这些概率，它能够使用决策树算法来推断要问的问题最能缩小下一个问题的范围。一旦它将可能的答案数量缩小到几十个，或者如果它已经达到 20 个问题，那么它最有可能开始阅读。

20q.net 真正有趣的方面是，与我所知道的大多数决策树和神经网络算法不同，20q 支持稀疏矩阵和增量更新。

编辑：原来答案一直在网上。[发明者 Robin Burgener 在2005 年的专利申请](http://www.google.com/patents/US20060230008?dq=Artificial%20neural%20network%20guessing%20method%20and%20game)中详细描述了他的算法。

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T12:09:59.610

它正在使用学习算法。

k-NN 就是其中一个很好的例子。

[维基百科：k-最近邻算法](http://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm)

# javascript - 如何在 Firefox 的 html 表上触发 onkeydown 事件？

> ID：887551
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-20T12:10:17.490
> 
>         
> 
> 标签：javascript, firefox

我想捕获表格单元格上的击键。我有以下代码可在 IE 上运行，但不能在 Firefox/Chrome 上运行。

```
<table id="testing" onkeydown="alert('testing')"><br />
    <tr><td>testing</td></tr>` <br />
    </table>
<br /> 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-20T13:05:55.177

[http://www.w3schools.com/jsref/jsref_onkeydown.asp](http://www.w3schools.com/jsref/jsref_onkeydown.asp)指定大多数标签支持onkeydown。

您需要将`tabindex`属性（例如`tabindex="1"`）设置为某个值，以便它可以识别此表是键盘可选择的。这允许触发键盘事件。以下将在 Firefox 中工作：

```
<table id="testing" onkeydown="alert('testing')" tabindex="0"><br />
<tr><td>testing</td></tr><br />
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:31:02.987

这似乎是 Firefox 和 Chrome 对规范的解释而不是您的代码的问题。我自己试过这个并重现了这个问题。

W3C 规范显示表格单元格应支持 onkeydown，但目前 Firefox/Chrome 似乎不支持此功能，您可以尝试通过其网站将其报告为 Firefox 错误。你通常会得到一些关于它为什么坏的反馈（或者为什么他们认为它没有坏并且不会像我过去那样修复它）

我能问一下为什么需要捕获表格单元格上的击键吗？

*   如果您希望人们输入文本，那么您应该使用 <input> 标记来很好地注册按键事件。

*   如果击键是某种导航，那么基于鼠标单击事件完成的上下文菜单可能会更好

# java - 反思：有效、令人敬畏、必要的用途

> ID：887552
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T12:10:41.293
> 
>         
> 
> 标签：java, reflection

> **可能的重复：**
> 
>   [什么是反射，为什么它有用？](https://stackoverflow.com/questions/37628/what-is-reflection-and-why-is-it-useful)

所以我已经阅读了 Java 网站上的反射教程，我想我一般都理解它允许一个类检查自己，可以访问属性、方法等。但是，如果有的话，这与可变或不可变代码？类可以使用反射之类的方法更改自己的代码吗？如果没有，你遇到/创造的反射最棒的用途是什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T12:22:51.363

不，反射不会直接使类能够更改其代码。但是，您可以使用[java.lang.reflect.Proxy](http://java.sun.com/javase/6/docs/api/java/lang/reflect/Proxy.html)做一些很棒的事情- 例如编写实现任何 JavaBean 样式接口（即 set 和 get 方法）的通用代码，甚至是通过让所有方法返回来实现*任何*接口的代码默认值——甚至可能是递归的，即返回接口类型的方法会返回一个行为相同的对象。

这个工具被[Mock 对象库](http://tutorials.jenkov.com/java-unit-testing/stub-mock-and-proxy-testing.html)使用，并且可能最突出的是[Groovy 语言](http://groovy.codehaus.org/)来实现支持鸭子类型和猴子补丁的完全动态语言。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:24:43.840

Java 反射不允许您像使用动态语言（如 ruby​​）那样动态更改程序代码。

Java 反射允许您查看有关类的方法和属性的元数据。它还允许您调用这些方法或更改属性值，而无需事先了解可用的方法和属性。

要在 Java 中在运行时修改程序代码，请查看 Aspect-Oriented Programming。

我见过的最棒的用途是在 JRuby 绑定中，它可以使 Java 类作为 ruby​​ 代码动态可用。我自己也使用反射来允许我从使用静态 int 常量而不是枚举的第三方库中查找错误代码。

# visual-studio-2005 - 有没有办法将 Visual Studio 2005 的 .NET 框架版本更改为 3.5？

> ID：887556
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-20T12:12:10.433
> 
>         
> 
> 标签：visual-studio-2005, frameworks

有没有办法将 Visual Studio 2005 的 .NET 框架版本更改为 3.5？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-20T12:19:21.090

不可以。Visual Studio 2005 仅支持开箱即用的 .NET 2.0。它可以更新以支持[.NET 3.0](http://www.microsoft.com/downloads/details.aspx?FamilyID=10cc340b-f857-4a14-83f5-25634c3bf043)。

可以使用[Visual Studio 2008 Express Edition](http://www.microsoft.com/Express/)编译 .NET 3.5 代码，也可以使用 Mono 编译 .NET 3.5 代码，或者使用[Mono](http://www.mono-project.com)编译 .NET 3.5 代码，我认为是[Windows/.NET SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=F26B1AA4-741A-433A-9BE5-FA919850BDBF)。然而，这些显然不会集成到 Visual Studio 2005 中。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:20:58.090

Visual Studio 2005 仅支持 .NET 2.0。解决方案文件 (.sln) 的格式在 Visual Studio 2008 中进行了更改，以允许您选择目标 .NET 版本。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-09-08T18:00:13.553

VS2008/2010 具有设置项目设置“TargetFrameworkVersion”的可视化方式，这使得它更容易，但是我发现将相同的标签添加到 VS2005 项目会改变目标框架。您可以尝试将以下 1（一个）添加到 VS C# 项目的部分中。

```
<TargetFrameworkVersion>v3.0</TargetFrameworkVersion>
<TargetFrameworkVersion>v3.5</TargetFrameworkVersion>
<TargetFrameworkVersion>v4.0</TargetFrameworkVersion> 
```

# python - 更改文件创建日期

> ID：887557
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-05-20T12:12:13.477
> 
>         
> 
> 标签：python, linux, file, date

我可以在 Linux 中使用 Python 更改某些文件的创建日期吗？

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-05-20T12:44:51.820

Linux 和 Unix 文件系统存储：

> 文件访问、更改和修改时间（记住 UNIX 或 Linux 从不存储文件创建时间，这是 UNIX/Linux 系统管理员工作面试中最喜欢问的问题）

[了解 UNIX/Linux 文件系统](http://www.cyberciti.biz/tips/understanding-unixlinux-filesystem-inodes.html)

* * *

## 回答 #2

> 赞同：16
> 
>             
> 
> 时间：2009-05-20T12:15:28.227

您可以使用[os.utime](http://docs.python.org/library/os.html#os.utime)更改访问和修改时间，但不能更改创建日期。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:34:29.093

我不是 UNIX 专家，所以也许我错了，但我认为 UNIX（或 Linux）不存储文件创建时间。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2015-10-05T07:25:15.913

查看[os.utime](http://docs.python.org/2/library/os.html#os.utime)

```
os.utime(file_path,(new_atime,new_mtime)) 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2019-02-14T02:14:20.280

Linux 不支持创建时间不再是事实。看：

*   [https://askubuntu.com/questions/470134/how-do-i-find-the-creation-time-of-a-file](https://askubuntu.com/questions/470134/how-do-i-find-the-creation-time-of-a-file)

请注意此特定答案以查看显示该字段的 C 代码：

*   [https://askubuntu.com/a/980750/116108](https://askubuntu.com/a/980750/116108)

如果该帖子的作者可以提供帮助，我也许可以使用 ctypes 创建一个包装器，以便从 Python 对其进行修改。

# c# - 从 int 到短字符串的 2 路加密

> ID：887565
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:15:36.293
> 
>         
> 
> 标签：c#, .net, asp.net, cryptography, passwords

我正在构建一个小型 Web 应用程序，我们的客户可以在其中更新有关他们公司的一些详细信息。客户目前没有登录名/密码，我们不想验证他们的注册，所以我们想给他们一个自动生成的密码/密钥来登录网站。

我们计划加密他们的 customerId 并将其提供给客户，以便他可以在 webapp 上输入该密钥，以便我们将密钥解密为他的 ID。

大约有 10,000 名客户，他们都没有电子邮件，所以有些人会收到一封带有 URL 和代码的信。这意味着客户必须输入代码，因此代码不能超过 8 个字符（最好是 6 个）。

这是一个空模板：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            int passwordLength = 6;
            int customerId = 12345;
            string encrypted = Crypter.Encrypt(customerId, "secretKey", passwordLength);
            if (customerId == Crypter.Decrypt(encrypted, "secretKey"))
            {
                Console.WriteLine("It worked! Well done!");
            }
        }

    }

    public static class Crypter
    {
        public static string Encrypt(int input, string key, int passwordLength)
        {
            string encryptedString = "";
            //do encrypt stuffz here

            return encryptedString;
        }
        public static int Decrypt(string encryoted, string key)
        {
            int decrypted = 0;
            //do decrypt stuffz here

            return decrypted;
        }
    }
} 
```

**=> 任何人都可以将我链接到有关如何执行此操作的更多信息吗？**

我不是在寻找“请给我发送代码”，但如果有人已经制作了这样的东西，请随时分享。

提前感谢您提供任何信息。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-20T12:20:57.653

不要将您的密码基于用户 ID。相反，为每个客户生成一个随机的 6 个字符的字符串并将其存储在数据库中。它不容易找到实际的算法。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T12:21:50.163

首先，我不确定你的想法是否很好。但是，暂时搁置一下，我不确定您是否真的需要加密/解密任何东西。

您要说的是，您将获取一些内部客户 ID 并将其转换为其他 ID（在您的情况下，是内部客户 ID 的加密版本）。为什么不只创建 2 个密钥 - 一个内部客户 ID（您保存在数据库中并用作主键的那个）和外部客户 ID。（另一个 8 位唯一密钥用作替代）。您将两者都存储在数据库中，并且当他们“登录”时，您会根据后者进行查找。

不过，我想和你一样：是什么阻止了别人猜测你的 6 或 8 位数字键。无论它们是否只是一些随机字符集的加密 ID，只有 6 位或 8 位数字，很快就会有人对您的网站进行攻击并猜测某人的密钥。将这些密钥格式化为 6 位或 8 位数字这一事实使攻击者的工作变得更容易。

我认为你最好发送这个 8 位密钥，让用户输入一些你已经知道的信息（他们的姓名、电子邮件地址、公司名称等），然后让他们定义一个用户 ID/登录名他们的选择。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:20:07.500

不确定我是否完全理解您的意图。您不能简单地生成一个[UUID](http://en.wikipedia.org/wiki/Uuid)或类似的东西并将其（或其中的一部分）用作用户的代码吗？您只需将其与数据库中的用户 ID 一起存储。

作为确保唯一性的替代方法，您可以根据两个单独的输入生成 N 字符代码。比如说，8 个字符中的 5 个可以随机生成，而另外 3 个字符将根据客户 ID 唯一生成。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:28:06.407

我同意另一位发帖人的说法，他说不要将加密字符串基于数据库中的某些内容。生成唯一的随机字符串以存储在数据库中要容易得多。

但是，如果您必须使用用户 ID，我建议查看以下命名空间。

[系统安全密码学](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aspx)

# iphone - 获取某些 UIColors 的颜色分量的异常结果

> ID：887568
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-05-20T12:16:11.847
> 
>         
> 
> 标签：iphone, core-graphics, uicolor, cgcolor

我正在尝试提取 a 的 rgb 组件，`UIColor`以便手动构建 a 中的像素`CGBitmapContext`。以下示例代码适用于大多数`UIColor`常量，但令人困惑的是，并非全部。以机智：

```
CGColorRef color = [[UIColor yellowColor] CGColor];
const float* rgba = CGColorGetComponents(color);

float r = rgba[0];
float g = rgba[1];
float b = rgba[2];
float a = rgba[3];

NSLog( @"r=%f g=%f b=%f a=%f", r, g, b, a); 
```

`[UIColor yellowColor]`如预期的那样，上述结果为

r=1.000000 g=1.000000 b=0.000000 a=1.000000。

`[UIColor redColor]`再次按预期给出 r=1.000000 g=0.000000 b=0.000000 a=1.000000。同样对于`blueColor`和`greenColor`。

*但是*`[UIColor blackColor]`，和的结果`[UIColor whiteColor]`似乎完全异常，而且我不知道我做错了什么（如果确实如此）。

也就是说，`[UIColor blackColor]`给出r=0.000000 g=1.000000 b=0.000000 a=0.000000，这是一个透明的绿色，

并`[UIColor whiteColor]`给出 r=1.000000 g=1.000000 b=0.000000 a=0.000000，这是一种透明的黄色。

如果有人可以，我将不胜感激：

(1) 解释我做错了什么

(2) 复制我的异常结果并告诉我不是我，或者

(3) 用大锤子敲打我的头，这样它就不会那么痛了。

霍华德

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-20T12:30:04.907

您假设颜色空间始终为 RGBA，但事实并非如此。

试试这个代码：

```
CGColorRef color = [[UIColor blackColor] CGColor];
const CGFloat* rgba = CGColorGetComponents(color);
CGColorSpaceRef space = CGColorGetColorSpace(color);
CGColorSpaceModel model = CGColorSpaceGetModel(space);
NSLog(@"%d", model); 
```

并且模型将屈服`kCGColorSpaceModelMonochrome`。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:23:11.097

我认为您缺少的是可以在不同的颜色空间中定义颜色：您假设它们都是 RGBA。

例如，[文档](http://developer.apple.com/iphone/library/documentation/uikit/reference/UIColor_Class/Reference/Reference.html#//apple_ref/occ/clm/UIColor/blackColor)声明`blackColor`“返回灰度值为 0.0 且 alpha 值为 1.0 的颜色对象”。所以我认为只有两个分量对黑色有效，而不是四个。

# vb6 - 为移动设备交叉编译/重新编译 ActiveX

> ID：887569
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:16:28.583
> 
>         
> 
> 标签：vb6, activex, mobile-phones, cross-compiling

在我们的项目中，我们有很多用 VB6 编写的 ActiveX 控件。在大型 (x86) 计算机上，它运行良好。这些控件托管在网站上。移动用户也想使用它。

那么是否有任何可能的解决方案来重新编译/交叉编译 .ocx 并使 .cab 文件在 ARM 架构下工作？

或者我可以在手机/PDA 上模拟 x86 架构？  

马特乌什

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T17:26:46.070

无法获取用 VB6 编写的控件并在具有 ARM 处理器的设备上运行它（通过交叉编译、仿真或其他方式）。

您最好的方法是在针对 x86 和您选择的 ARM 移动平台（java/j2me、.net 框架/紧凑框架、flash、C/C++ 等之一）或只是让您的应用程序运行的东西中重写您的应用程序在服务器上并通过网络公开它

# visual-studio - 使用 Resharper 时找不到元数据窗口 (F12)

> ID：887575
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-05-20T12:18:29.923
> 
>         
> 
> 标签：visual-studio, resharper

当我`F12`在 Visual Studio 中点击（或右键单击并选择转到定义）我没有源代码的代码时，它应该会显示一个生成的元数据文件。（非常类似于代码定义窗口）

这在安装 ReSharper (R#) 时不起作用。安装 R# 后，将打开对象浏览器。

我在几台新安装的计算机上遇到过这个问题，至少从 R# 3 开始。（当你禁用 R# 并重新启动 VS 时，你会再次看到这个问题）

我现在如何进入元数据视图？

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2010-05-24T17:15:20.133

您可以通过转到 ReSharper -> 选项... -> 工具 -> 外部源并更改外部源数据提供程序的顺序和选择来更改 ReSharper 的 F12 操作。

信用和更多细节：[http ://blog.aheil.de/2009/12/27/resharper-5-0-can-visual-studio-2010-metadata-view/](http://blog.aheil.de/2009/12/27/resharper-5-0-can-visual-studio-2010-metadata-view/)

# c# - 用反射评估空投？

> ID：887581
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:20:05.287
> 
>         
> 
> 标签：c#, reflection, null-cast

给定一个空转换：

```
var result = MyMethod( (Foo) null ); 
```

是否可以在反射方法中使用这些额外信息？

**编辑：**

该方法的签名类似于：

```
object MyMethod( params object[] args )
{
  // here I would like to see that args[0] is (was) of type Foo
} 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:23:59.473

啊……你编辑了……

我怀疑你会得到最接近的是泛型：

```
object MyMethod<T>( params T[] args ) {...} 
```

（看看`typeof(T)`）

但这是假设所有的`args`都是一样的。除此之外; 不。每个空值都与其他空值相同（`Nullable<T>`除此之外），并且您无法分辨变量类型。

* * *

原回复：

你的意思是重载决议？

```
object result = someType.GetMethod("MyMethod",
        new Type[] { typeof(Foo) })
        .Invoke(someInstance, new object[] { null }); 
```

（哪里`someInstance`是`null`静态方法，`someType`是`Type`有`MyMethod`方法的）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:25:37.600

简短的回答：没有

我猜你有这样的事情：

```
class Foo : Bar{} 
```

既然你有：

```
object MyMethod(param object[] values); 
```

没有办法做到这一点。您可以使用空对象模式来完成此操作：

```
class Foo : Bar
{
 public static readonly Foo Null=new Foo();
} 
```

然后用**Foo.Null**而不是 null 调用。然后，您的 MyMethod 可以检查静态实例并采取相应措施：

```
object MyMethod(param object[] values
{
 if(values[0]==Foo.Null) ......
} 
```

# c# - 将字符串转换为整数

> ID：887586
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T12:21:02.770
> 
>         
> 
> 标签：c#, .net, string, integer

我的代码需要帮助。我想在我的文本框中只写数字/整数，并想在我的列表框中显示它。

我的代码是否按顺序排列？这似乎给出了一个错误。

```
 int yourInteger;
    string newItem;

    newItem = textBox1.Text.Trim();

    if (newItem == Convert.ToInt32(textBox1.Text))
    {
        listBox1.Items.Add(newItem);
    } 
```

==== 更新：

这就是我的代码现在的样子。我的问题是，listBox 可以处理“long”数据类型吗？因为当我输入数字 20,000,000 时，我只得到了一个 20 分钟的沙漏。但是当我用控制台尝试这个时，我得到了答案。所以我不确定什么样的元素可以处理“long”数据类型。

```
 string newItem;
    newItem = textBox1.Text.Trim();

    Int64 num = 0;
    if(Int64.TryParse(textBox1.Text, out num))
    {
        for (long i = 2; i <= num; i++)
        {
            //Controls if i is prime or not
            if ((i % 2 != 0) || (i == 2))
            {
                listBox1.Items.Add(i.ToString());
            }

        }
    }

    private void btnClear_Click(object sender, EventArgs e)
    {
        listBox1.Items.Clear();
    } 
```

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-05-20T12:22:01.227

```
int result = int.Parse(textBox1.Text.Trim()); 
```

如果要检查有效性：

```
int result;
if (int.TryParse(textBox1.Text.Trim(), out result)) // it's valid integer...
   // int is stored in `result` variable.
else
   // not a valid integer 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T12:22:40.740

用这个：

```
 int yourInteger;
    string newItem;

    newItem = textBox1.Text.Trim();
    Int32 num = 0;
    if ( Int32.TryParse(textBox1.Text, out num))
    {
        listBox1.Items.Add(newItem);
    }
    else
    {
        customValidator.IsValid = false;
        customValidator.Text = "You have not specified a correct number";
    } 
```

这假设您有一个 customValidator。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:22:29.820

使用 int.TryParse() 检查字符串是否包含整数值。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:23:52.047

`textBox1.Text`可能不包含整数的有效字符串表示形式（或者只是一个空字符串）。要解决此问题，请使用`Int32.TryParse()`.

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:26:56.270

你可以做：

```
Convert.ToInt32(input); 
```

对于使用此功能的更长的功能，您可以查看：http:
 [//msdn.microsoft.com/en-us/library/bb397679.aspx](http://msdn.microsoft.com/en-us/library/bb397679.aspx)

基本上它检查字符串是否为空，然后它会调用 int.Parse。这也可以在没有 int.TryParse 的 WindowsCE 下工作。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:43:31.447

具体来说，为什么您的代码无法编译它是因为您将字符串 (newItem) 与 Convert.ToInt32 的结果进行比较，它是一个整数，它不会让您这样做。如果传入的字符串不是数字，Convert.ToInt32 也会引发异常。

您可以尝试使用`int.TryParse`，或者编写一个简单的正则表达式来验证您的输入：

```
int i;
bool isInteger = int.TryParse(textBox1.Text,out i); 
```

或者

```
bool isInteger = System.Text.RegularExpressions.Regex.IsMatch("^\d+$", textBox1.Text); 
```

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2009-05-20T12:23:40.707

你在检查一个空字符串吗？

```
int yourInteger;
string newItem;
newItem = textBox1.Text.Trim();

if(newItem != string.Empty)
{
   if ( newItem == Convert.ToInt32(textBox1.Text))
   {
      listBox1.Items.Add(newItem);
   }
} 
```

# c# - 如何使用 Sqlserver SMO 查找 sql2000 数据库信息

> ID：887588
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:21:57.917
> 
>         
> 
> 标签：c#, sql-server, sql-server-2005, sql-server-2000

如何使用 SQLSERVER-SMO 查找 sqlserver2000 数据库信息

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:30:23.987

也许你可以从这个[SMO 和 Sql Server 7.0](https://stackoverflow.com/questions/33457/smo-and-sql-server-7-0)中得到一些想法。

# mysql - 在 MySQL 中删除表是否也会删除索引？

> ID：887590
> 
>         
> 
> 赞同：56
> 
>         
> 
> 时间：2009-05-20T12:22:29.087
> 
>         
> 
> 标签：mysql, database, indexing, sql-drop

文档中没有明确提及（[http://dev.mysql.com/doc/refman/6.0/en/drop-table.html](http://dev.mysql.com/doc/refman/6.0/en/drop-table.html)）。我之所以问，是因为我刚刚在 Rails 项目中看到了一个奇怪的数据库迁移，开发人员在删除表之前删除了所有索引，这似乎没有必要。

* * *

## 回答 #1

> 赞同：54
> 
>             
> 
> 时间：2009-05-20T12:28:48.327

是的，它确实。

但是，如果您有诸如 RESTRICT 之类的外键约束来确保与其他表的引用完整性，那么您需要在删除或截断表之前删除这些键。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T12:28:44.067

是的，它会删除索引。如果基础表不存在，则没有理由保留索引。我怀疑向下迁移只是在一对一的基础上与向上迁移相反。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:28:50.400

这是不必要的。但是，当表是外键关系的一部分并且删除表会破坏依赖关系时，您的 DROP TABLE 可能会被阻止。

# c# - 如何在 ADO.Net 中的 DataTable 中高效转换数据

> ID：887594
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:22:57.213
> 
>         
> 
> 标签：c#, datatable, ado.net

我正在使用`ADO.Net`+ `C#`+ `VSTS 2008`+ `SQL Server 2005`。我将 an 绑定`ADO.Net` `DataTable`到一个真实的数据库表，然后将其绑定`DataTable`到页面上的网格视图`ASP.Net`。

我的问题是：如果我想做一些数据操作工作（很简单，比如为某些字符数据类型行添加一些前缀，多个整数数据类型行加 100 或其他东西）并在网格视图中显示页面上的操作数据，什么建议的最佳实践解决方案是进行数据操作吗？

我无法更改数据库内的数据。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:29:14.660

ADO.NET 数据集允许“计算”列。[查看DataColumn.Expression](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)上的 MSDN 页面，了解支持的表达式类型的概要。

如果您在可视数据集设计器中，只需右键单击您的表并添加一列，然后在“属性”框中填写表达式。否则，在代码中创建一个新的 DataColumn、设置其 Expression 属性并将其添加到您的 DataTable 是非常简单的。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:31:29.833

将 DataTable 放入 DataView，执行编辑并将 DataView 绑定到 DataGrid

```
DataView dv = new DataView();

            dv.Table = dt; //where dt is the datatable
            dv.AllowDelete = true;
            dv.AllowEdit = true;
            dv.AllowNew = true; 
```

绑定使用 :`dv.ToTable()`而不是 dv.Table[0]

# c# - 如何从 System.Window.media.PixelFormats.Gray16 创建位图

> ID：887600
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:24:08.007
> 
>         
> 
> 标签：c#, system.drawing

我成功地从他们的原始像素数据中绘制了图像。（只有 8 位图像）。这是做同样事情的代码。

```
 PixelFormat format = PixelFormat.Format8bppIndexed;
     Bitmap bmp = new Bitmap(Img_Width, Img_Height, format);
     Rectangle rect = new Rectangle(0, 0, Img_Width, Img_Height);
     BitmapData bmpData = bmp.LockBits(rect, ImageLockMode.ReadWrite, format);
     Marshal.Copy(rawPixel, 0, bmpData.Scan0, rawPixel.Length);
     bmp.UnlockBits(bmpData); 
```

现在众所周知，c# 2.0 GDI+ 不支持 PixelFormat.format16bppGrayscale。我用谷歌搜索并获得了 3.0/3.5 框架支持。所以我两个都安装了。支持的类是 System.windows.media.PixelFormats。PixelFormats.Gray16

现在我的问题是如何通过传递此参数来创建位图并获取要显示的图像。

我在那里得到了一些 BitmapSource 类，但我在 C#3.0 中很新。

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:24:44.453

尝试这个：

```
private static Bitmap changePixelFormat(Bitmap input, PixelFormat format)
{
    Bitmap retval=new Bitmap(input.Width, input.Height, format);
    retval.SetResolution(input.HorizontalResolution, input.VerticalResolution);
    Graphics g = Graphics.FromImage(retval);
    g.DrawImage(input, 0, 0);
    g.Dispose();
    return retval;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T19:32:06.037

看看[AForge.net中的](http://code.google.com/p/aforge/)[灰度过滤](http://www.aforgenet.com/framework/docs/html/f0c2a0fb-12a4-0ab4-81cd-095f482b1383.htm)器。你可以在[这里](http://www.codeproject.com/KB/GDI-plus/Image_Processing_Lab.aspx?fid=158880&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=201)找到来源。  

编辑：

作为我链接的那个来源的注释，它使用的是 AForge.NET 的“旧”版本，但概念是相同的。

# iphone - 在 UIImageView 上放大放大镜

> ID：887602
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-20T12:24:18.130
> 
>         
> 
> 标签：iphone, uiimageview, accessibility, uiimage, loupe

有谁知道在 iPhone 上的 UIImage 视图中实现 UITextField 的缩放放大镜功能的方法？

我正在构建的应用程序的一部分允许用户在 UIImage 上画一条线，这个过程可能涉及点的精确定位。为了帮助用户，我想提供在 UITextField 中定位光标时看到的放大镜。有谁知道如何做到这一点？任何指向相关文档的指针？

干杯!

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T04:05:28.317

本教程写得很好，包括示例代码：

[http://www.craftymind.com/2009/02/10/creating-the-loupe-or-magnifying-glass-effect-on-the-iphone/](http://www.craftymind.com/2009/02/10/creating-the-loupe-or-magnifying-glass-effect-on-the-iphone/)

您需要注释掉导入 CustomView.h 的行，然后它才能编译并运行良好。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:19:47.847

我不知道任何相关文档。

实现这样的事情时我会做什么。在视图上显示视图的 UIImage 表示。然后将覆盖 UIImage 剪辑到您要放大的视图部分。您可以使用 CGAffineTransformScale 放大该部分。

您可以使用 CALayer 的 renderInContext: 方法将现有视图绘制到 UIImage。

```
 UIGraphicsBeginImageContext(self.view.frame.size);

    CGContextRef context = UIGraphicsGetCurrentContext();
    [self.view.layer renderInContext:context];

    UIImage *imageRepresentation = UIGraphicsGetImageFromCurrentImageContext(); 
```

# nhibernate - NHibernate“数据库”模式混淆 [.\hibernate-mapping\@schema]

> ID：887605
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T12:24:37.523
> 
>         
> 
> 标签：nhibernate, schema, nhibernate-mapping, mapping

我主要针对 MSSQL 数据库使用 NHibernate，其中我对各种表使用了 MSSQL 模式。

在我的 NH 映射 (HBM) 文件中，我为映射中的每个表指定了架构，如下所示：

```
<?xml version="1.0"?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   auto-import="true"
                   schema="xyz">                 <!-- schema specified -->
  <class name="Customer">
    <id name="Id">
      <generator class="native" />
    </id>
    <property name="Name" />
  </class>
</hibernate-mapping> 
```

对于我的单元测试，我一直在试验 SQLite，但是我的映射现在失败了，因为 NH 报告找不到数据库“xyz”。

[我知道schema](https://stackoverflow.com/questions/667208/database-schema-confusion)的解释存在差异，那么 NH 的解释/实现是什么，使用 schema 时最好的方法是什么？

顺便说一句：使用“nhibernate database schema”之类的关键字搜索网络并没有产生任何相关信息。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T12:43:21.073

“标准”解释是表具有三部分名称：“CATALOG.SCHEMA.TABLE”：这些是标准（ISO-SQL 标准？）“information_schema”视图中使用的名称。Hibernate（可能也是 NHibernate）遵循这个约定，你可以在类映射中指定目录和模式，在配置中指定 default_catalog 和 default_schema。

在我自己的单元测试环境（使用 Hypersonic）中，我在构建 SessionFactory 之前调整了 Hibernate 配置：我自己这样做是为了设置与 HSQL 兼容的 IdentifierGenerators，但您可能可以通过清除映射类的模式属性。

一般来说，我尽量避免在应用程序中指定模式和目录。在 Oracle 中，我通常创建同义词，以便用户在自己的命名空间中看到对象；在 PostgreSQL 中，在数据库配置中设置 search_path；在 SQL Server 中，将所有表放入“dbo”。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:35:41.807

该类`NHibernate.Mapping.Table`有一个`GetQualifiedName(NHibernate.Dialect.Dialect dialect)`方法，定义如下：

```
public string GetQualifiedName(NHibernate.Dialect.Dialect dialect)
{
    string quotedName = this.GetQuotedName(dialect);
    return ((this.schema == null) ? 
        quotedName : 
        (this.GetQuotedSchemaName(dialect) + '.' + quotedName));
} 
```

因此，除了为每个场景（或在编译之前对其进行预处理）之外，基本上没有办法让 SQLite 忽略模式名称。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:41:22.573

您可以使用 property 在配置文件中指定架构（如果需要）`default_schema`。您可以使用多个配置文件，或者更改您正在使用的一个 - 一个用于生产，另一个用于测试。

您可以简单地忽略架构设置并使用不同的凭据。

# sql - SQL Server 的 ADO.Net 的连接字符串

> ID：887609
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:25:28.487
> 
>         
> 
> 标签：sql, string, ado.net, connection, cluster-computing

当连接到 SQL Cluster 的非默认实例时，我对 ADO.Net 的连接字符串格式感到困惑。我进行了搜索，但找到了各种示例，谁能告诉我正确的格式是什么（如果我知道虚拟服务器名称和实例名称）？我正在使用受信任的连接。

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T12:29:11.210

请参阅[http://www.connectionstrings.com/](http://www.connectionstrings.com/) - 制作数据库连接字符串的好网站。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:28:31.227

服务器名称\实例名称？在 C# 中处理字符串时使用双 \

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:29:55.313

以下网站为您提供了许多不同的连接字符串。我相信以下应该有效：

[http://www.connectionstrings.com/sql-server-2005#1](http://www.connectionstrings.com/sql-server-2005#1)

这也是[SQL Server 集群的连接字符串的副本](https://stackoverflow.com/questions/751634/connection-string-to-a-sql-server-cluster)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-11-17T12:50:40.260

如果您可以使用 Visual Studio 连接到它，则连接属性应该为您提供 vs.net 使用的连接字符串。使用该连接字符串可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-03-12T22:19:37.260

如果您想要一种快速简便的方法来尝试不同的连接字符串，我建议使用[DatabaseTester](http://www.sql-reports.net/2011/03/how-to-easily-test-your-adonet-connections.html)（免责声明 - 我写的）。它是免费的，而且是一种非常简单的测试方法。我同意上面的其他帖子，为了找出连接字符串[ConnectionStrings.com](http://www.connectionstrings.com/)是你最好的朋友。

# c# - Listview的宽度调整

> ID：887613
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:26:52.760
> 
>         
> 
> 标签：c#, wpf, wpf-controls

我有一个 GroupBox 里面有一个 DockPanel，它包含两个列表视图。有 2 个按钮，在每个按钮上单击一个列表视图将可见，其他将折叠。但是列表视图不会调整宽度以使其适合组合框。

如何使列表视图适合组框？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-21T04:43:19.160

将 ListView 宽度设为“Auto”和 Horizo​​ntalAligment =“Strech”...希望这能解决您的问题

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-26T09:24:10.257

在添加控件之前清除停靠面板。

即点击按钮清除面板使用dockPanel.Children.Clear(); 并使用 dockPanel.Children.Add( control ) 添加新项目；

# language-agnostic - 是否有任何“主要”框架使用猴子补丁/开放类

> ID：887616
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:27:36.097
> 
>         
> 
> 标签：language-agnostic

我很好奇在 Ruby、Python、Groovy 等语言中称为开放类或猴子补丁的特性的使用。此特性允许您在运行时对现有类或对象进行修改（如添加或替换方法）。

有谁知道主要框架（例如 Rails/Grails/Zope）是否（广泛）利用这个机会为开发人员提供服务？如果有，请举例说明。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-20T12:32:49.237

Rails 做到了（恕我直言）荒谬的程度。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:39:50.800

.Net 通过扩展方法允许它。

具体来说，Linq 严重依赖于猴子修补到 IEnumerable 接口上的扩展方法。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:27:29.750

它在 Java 平台上的一个使用示例（因为您提到了 Groovy）是加载时编织与 AspectJ 和 JVM 工具之类的东西。但是，在这种特殊情况下，您可以选择使用编译时编织。有趣的是，我最近的一个 SO 问题与使用这种加载时编织的问题有关，其中一些建议将编译时作为唯一可靠的选择。

使用加载时（运行时）编织为开发人员提供有用服务的 AspectJ 示例可以是 Spring 的 @Configuration 注释，它允许您对未由 Spring 的 BeanFactory 实例化的对象使用依赖注入。

您特别提到了修改方法（或其工作方式），并且正在使用的一个示例是在发送到处理程序（某些控制器方法或 doPost 等）之前拦截 http 请求并检查是否用户有权访问该资源。然后，您的方面可能会决定返回 - 过早 - 带有重定向登录的响应。虽然不修改方法本身的内容，但您仍在修改方法的工作方式，即更改它本来会给出的返回值。

# django - 以编程方式使用 Django 的 loaddata

> ID：887627
> 
>         
> 
> 赞同：50
> 
>         
> 
> 时间：2009-05-20T12:29:36.640
> 
>         
> 
> 标签：django, loaddata

我想`manage.py loaddata`从 Django 视图中调用等价物。我希望能够指定从何处加载数据以及将其加载到哪个应用程序中。

有任何想法吗？

* * *

## 回答 #1

> 赞同：78
> 
>             
> 
> 时间：2009-05-20T13:24:50.100

[如文档](https://docs.djangoproject.com/en/dev/ref/django-admin/#running-management-commands-from-your-code)中所见，每个`django-admin.py`( ) 命令都可以从代码中调用：`manage.py`

```
from django.core.management import call_command

call_command('loaddata', 'myapp') 
```

其中第一个参数是命令名称，所有其他位置参数与命令行位置参数相同，所有关键字参数都是选项。

# tsql - 以逗号为分隔符将多行转换为一行

> ID：887628
> 
>         
> 
> 赞同：99
> 
>         
> 
> 时间：2009-05-20T12:29:36.780
> 
>         
> 
> 标签：tsql, rows, csv

如果我发出`SELECT username FROM Users`，我会得到这个结果：

```
用户名
--------
保罗
约翰
玛丽

```

但我真正需要的是所有值用逗号分隔的一行，如下所示*：*

```
保罗、约翰、玛丽

```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：133
> 
>             
> 
> 时间：2009-11-23T21:00:06.630

```
 select
   distinct  
    stuff((
        select ',' + u.username
        from users u
        where u.username = username
        order by u.username
        for xml path('')
    ),1,1,'') as userlist
from users
group by username 
```

之前有错字，上面的作品

* * *

## 回答 #2

> 赞同：111
> 
>             
> 
> 时间：2009-05-20T12:44:50.727

这应该适合你。一直测试到 SQL 2000。

```
create table #user (username varchar(25))

insert into #user (username) values ('Paul')
insert into #user (username) values ('John')
insert into #user (username) values ('Mary')

declare @tmp varchar(250)
SET @tmp = ''
select @tmp = @tmp + username + ', ' from #user

select SUBSTRING(@tmp, 0, LEN(@tmp)) 
```

* * *

## 回答 #3

> 赞同：57
> 
>             
> 
> 时间：2009-05-20T16:06:29.697

对几种方法的良好审查：

[http://blogs.msmvps.com/robfarley/2007/04/07/coalesce-is-not-the-answer-to-string-concatentation-in-t-sql/](http://blogs.msmvps.com/robfarley/2007/04/07/coalesce-is-not-the-answer-to-string-concatentation-in-t-sql/)

**文章副本 -** 

Coalesce 不是 T-SQL 中字符串连接的答案 多年来我看到很多关于使用 COALESCE 函数在 T-SQL 中实现字符串连接的帖子。这是此处的示例之一（借自 Readifarian Marc Ridey）。

```
DECLARE @categories varchar(200)
SET @categories = NULL

SELECT @categories = COALESCE(@categories + ',','') + Name
FROM Production.ProductCategory

SELECT @categories 
```

这个查询可能相当有效，但需要注意，并且应该正确理解 COALESCE 的使用。COALESCE 是 ISNULL 的版本，它可以接受两个以上的参数。它返回参数列表中不为空的第一件事。所以实际上它与连接无关，下面的代码是完全相同的——不使用 COALESCE：

```
DECLARE @categories varchar(200)
SET @categories = ''

SELECT @categories = @categories + ',' + Name
FROM Production.ProductCategory

SELECT @categories 
```

但是数据库的无序特性使得这不可靠。T-SQL（还）没有连接函数的全部原因是，这是一个聚合，元素的顺序很重要。使用这种字符串连接的变量赋值方法，您实际上可能会发现返回的答案中没有所有值，特别是如果您希望将子字符串按特定顺序放置。考虑以下内容，当我希望它返回 ',Bikes,Clothing,Components,Accessories' 时，它在我的机器上只返回 ',Accessories'：

```
DECLARE @categories varchar(200)
SET @categories = NULL

SELECT @categories = COALESCE(@categories + ',','') + Name
FROM Production.ProductCategory
ORDER BY LEN(Name)

SELECT @categories 
```

更好的是使用一种考虑顺序的方法，该方法已包含在 SQL2005 中，专门用于字符串连接 - FOR XML PATH('')

```
SELECT ',' + Name
FROM Production.ProductCategory
ORDER BY LEN(Name)
FOR XML PATH('') 
```

在我最近比较使用子查询时的 GROUP BY 和 DISTINCT 的帖子中，我演示了 FOR XML PATH('') 的用法。看看这个，你会看到它在子查询中是如何工作的。'STUFF' 功能仅用于删除前导逗号。

```
USE tempdb;
GO
CREATE TABLE t1 (id INT, NAME VARCHAR(MAX));
INSERT t1 values (1,'Jamie');
INSERT t1 values (1,'Joe');
INSERT t1 values (1,'John');
INSERT t1 values (2,'Sai');
INSERT t1 values (2,'Sam');
GO

select
    id,
    stuff((
        select ',' + t.[name]
        from t1 t
        where t.id = t1.id
        order by t.[name]
        for xml path('')
    ),1,1,'') as name_csv
from t1
group by id
; 
```

FOR XML PATH 是可以在子查询中使用 ORDER BY 的少数情况之一。另一个是TOP。当您使用未命名的列和 FOR XML PATH('') 时，您将获得直接连接，没有 XML 标记。这确实意味着字符串将是 HTML 编码的，因此，如果您要连接可能具有 < 字符（等）的字符串，那么您可能应该在之后修复它，但无论哪种方式，这仍然是连接字符串的最佳方式在 SQL Server 2005 中。

* * *

## 回答 #4

> 赞同：12
> 
>             
> 
> 时间：2015-07-17T14:56:40.943

基于 mwigdahls 的回答。如果你还需要在这里进行分组是如何让它看起来像

```
group, csv
'group1', 'paul, john'
'group2', 'mary'

    --drop table #user
create table #user (groupName varchar(25), username varchar(25))

insert into #user (groupname, username) values ('apostles', 'Paul')
insert into #user (groupname, username) values ('apostles', 'John')
insert into #user (groupname, username) values ('family','Mary')

select
    g1.groupname
    , stuff((
        select ', ' + g.username
        from #user g        
        where g.groupName = g1.groupname        
        order by g.username
        for xml path('')
    ),1,2,'') as name_csv
from #user g1
group by g1.groupname 
```

* * *

## 回答 #5

> 赞同：8
> 
>             
> 
> 时间：2011-11-04T11:54:28.687

您可以使用此查询来执行上述任务：

```
DECLARE @test NVARCHAR(max)  
SELECT @test = COALESCE(@test + ',', '') + field2 FROM #test
SELECT field2 = @test 
```

有关详细信息和分步说明，请访问以下链接
[http://oops-solution.blogspot.com/2011/11/sql-server-convert-table-column-data.html](http://oops-solution.blogspot.com/2011/11/sql-server-convert-table-column-data.html)

* * *

## 回答 #6

> 赞同：7
> 
>             
> 
> 时间：2011-01-12T18:50:03.150

```
DECLARE @EmployeeList varchar(100)

SELECT @EmployeeList = COALESCE(@EmployeeList + ', ', '') + 
   CAST(Emp_UniqueID AS varchar(5))
FROM SalesCallsEmployees
WHERE SalCal_UniqueID = 1

SELECT @EmployeeList 
```

来源：
 [http ://www.sqlteam.com/article/using-coalesce-to-build-comma-delimited-string](http://www.sqlteam.com/article/using-coalesce-to-build-comma-delimited-string)

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2012-02-13T07:41:19.740

在 SQLite 中，这更简单。我认为 MySQL、MSSql 和 Orable 有类似的实现

```
CREATE TABLE Beatles (id integer, name string );
INSERT INTO Beatles VALUES (1, "Paul");
INSERT INTO Beatles VALUES (2, "John");
INSERT INTO Beatles VALUES (3, "Ringo");
INSERT INTO Beatles VALUES (4, "George");
SELECT GROUP_CONCAT(name, ',') FROM Beatles; 
```

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2014-05-30T10:44:41.290

您可以使用 stuff() 将行转换为逗号分隔值

```
select
EmployeeID,
stuff((
  SELECT ',' + FPProjectMaster.GroupName 
      FROM     FPProjectInfo AS t INNER JOIN
              FPProjectMaster ON t.ProjectID = FPProjectMaster.ProjectID
      WHERE  (t.EmployeeID = FPProjectInfo.EmployeeID)
              And t.STatusID = 1
              ORDER BY t.ProjectID
       for xml path('')
       ),1,1,'') as name_csv
from FPProjectInfo
group by EmployeeID; 
```

感谢@AlexKuznetsov 提供参考以获得此答案。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T19:15:54.900

MS SQL Server 2005/2008 中一个简洁灵活的解决方案是创建一个 CLR Agregate 函数。

[你会在google](http://www.google.com/search?hl=en&client=safari&rls=nb-no&q=sql+string+concat+clr+aggregate+c%23&btnG=Search)上找到很多文章（带有代码）。

看起来[这篇文章](http://dotnet-enthusiast.blogspot.com/2007/05/user-defined-aggregate-function-in-sql.html)将引导您使用 C# 完成整个过程。

* * *

## 回答 #10

> 赞同：-5
> 
>             
> 
> 时间：2009-05-20T12:49:24.120

如果你是通过 PHP 来执行的，那么这个呢？

```
$hQuery = mysql_query("SELECT * FROM users");
while($hRow = mysql_fetch_array($hQuery)) {
    $hOut .= $hRow['username'] . ", ";
}
$hOut = substr($hOut, 0, strlen($hOut) - 1);
echo $hOut; 
```

# mysql - MySQL 更新行为

> ID：887629
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:29:37.933
> 
>         
> 
> 标签：mysql, sql, mysql-error-1062

mysql> update tablename set fieldname = 'C200900674' where fieldname - 'C200900673';

错误 1062 (23000)：密钥 1 的重复条目“C200900674-2008-0-1”

对此有何想法或建议？我们有人不小心用减号而不是等号进行了更新。它显然试图更改小于该值的所有记录？即使它是字母数字的并且确实相当不完整。最重要的是，在出现该错误之前已更新了许多记录，并且根本没有任何反馈。没有像“查询正常，X 行受影响（0.00 秒）”这样的东西，所以我们不知道有多少被改变了。autocommit=1 所以无法回滚。

无论如何，只是寻找有关此的任何提示或指示。为什么该查询根本没有做*任何事情*，它看起来确实应该向我返回一个错误。当然，除了不让没有经验的管理员做愚蠢的事情的明显答案之外。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-30T07:23:02.337

每当对 Mysql 如何解释 WHERE 子句有疑问时，将其反转为 SELECT。

```
SELECT fieldname - 'C200900673' FROM tablename; 
```

和：

```
SELECT fieldname FROM tablename WHERE fieldname - 'C200900673'; 
```

查看第一个选择返回什么值，以及第二个选择返回什么行。

可悲的是，由于 Mysql 在数字/字符串转换方面非常松懈，特别是在 4.x 系列上，甚至在非严格的 5.x 上，哎呀......即使是严格模式，也很难准确地说出哪里出了问题您的 Mysql 配置的详细信息。这可能是因为 fieldname 被强制转换为某个数字，'C200900673' 也是如此，基本上运行：

```
update tablename set fieldname = 'C200900674' where NUMBER - NUMBER; 
```

这可以转化为：

```
update tablename set fieldname = 'C200900674' where 1; 
```

无论如何，我希望你有一个备份！

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:32:34.230

如果您的表使用 InnoDB 存储引擎，则不会造成任何损害。即使使用 autocommit=1，查询也只会“全有或全无”执行。您收到错误消息的事实证明数据库没有触及您的数据。每当您收到错误消息时，都会省略“受影响的 x 行”消息。

即使没有违反唯一性约束，查询也会失败并出现不同的错误：

> 错误 1292 (22007)：截断不正确的 DOUBLE 值：'fieldname'

这是因为减号会导致 MySQL 尝试计算字段内容的值减去其他值。这不起作用。你只是没有看到这个错误，因为另一个“先到那里”。

# openid - 是否有哪些 OpenID 提供者使用哪些模式属性的列表？

> ID：887630
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T12:29:40.383
> 
>         
> 
> 标签：openid, dotnetopenauth

我在我的网站中使用 OpenId。爱它。目前，我正在使用我自己的 openId 帐户测试我的代码，我拥有 MyOpenId[帐户](https://www.myopenid.com/)。每当我试图检索从 MyOpenId 交给我的任何数据时，它都是空的/null。

经过进一步分析，谷歌将我带到了[这篇文章](http://groups.google.com/group/dotnetopenid/browse_thread/thread/946ccc2337bdb196#)，这表明，即使有官方模式，也不是每个人都真正遵守它。Andrew Arnott（[DotNetOpenId的作者）实际上](http://code.google.com/p/dotnetopenid/)[在这里](http://blog.nerdbank.net/2009/03/how-to-pretty-much-guarantee-that-you.html)谈到了这种痛苦。

伟大的。

> 标准的好处是有很多选择。:(

那么，是否有人有提供者列表和他们使用的模式命名空间？我将从我所知道的开始：-

### 官方的

*   [http://axschema.org/contact/email](http://axschema.org/contact/email)

### 我的OpenId

*   [http://schema.openid.net/contact/email](http://schema.openid.net/contact/email) 

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-21T01:35:02.153

IMO，维护 OP 及其奇怪行为的列表是一项噩梦般的任务，并且会破坏应该确定行为的规范的目的。当然，从你的角度来看，你只是想让它工作。:) 所以这里...

解决[DotNetOpenAuth 票证 22](http://dotnetopenauth.net:8000/ticket/22)的一部分，它计划用于 v3.2 版本，可能会包括一些内置到库中的智能。基本上，DNOA 将尝试根据 OpenID 上的发现找出 OP 的期望。在可能的情况下，它将适应 OP 的古怪之处。如果无法发现这些奇怪的东西，它会自动发送所有请求，使用 sreg 和所有常用（尽管非规范）的 AX 模式，并为您包装所有这些细节，只给您一个简单的答案。

与此同时，你*可以*自己做这件事。只需发送 sreg 和 ax 请求（使用所有三种已知形式），然后检查所有响应以查看您得到了什么。这很痛苦，但这就是我写博客的原因，我看到你已经找到了。:)

顺便说一句，我看到的三个 AX 模式形式在您链接到的那篇博客文章中。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T20:20:16.440

[如果您只需要电子邮件，我想您会发现对简单注册扩展](http://openid.net/specs/openid-simple-registration-extension-1_0.html)（又名`sreg`）的更广泛支持。

# sql - 规范化数据

> ID：887635
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:30:45.030
> 
>         
> 
> 标签：sql, sql-server, database-normalization

我需要用相关的employeeid 更新managerid 字段。

```
CREATE TABLE Employee(
EmployeeID Int Primary Key Identity,
Name Varchar(50),
ManagerID INT default 0,
ManagerName Varchar(50) default ''
)
INSERT INTO Employee(Name,ManagerName) VALUES('Dilbert','Boss')
INSERT INTO Employee(Name,ManagerName) VALUES('Boss','Dogbert')
INSERT INTO Employee(Name) VALUES('Dogbert')
SELECT * FROM Employee
GO
-- This is the update stmt I need help with
UPDATE Employee 
SET ManagerID=EmpID
WHERE ManagerName = Name 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T12:33:55.147

您可以加入 Employee 表以查找经理的 ID：

```
UPDATE emp
SET ManagerID = boss.EmployeeID
FROM Employee emp
INNER JOIN Employee boss
    ON boss.Name = emp.ManagerName 
```

请注意，在员工行中同时存储经理的姓名和经理的 ID 违反了[第 3 范式](http://en.wikipedia.org/wiki/Third_normal_form)。

# c# - 在 C# 代码中包含 HTML 文件

> ID：887646
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:32:53.153
> 
>         
> 
> 标签：c#

我有一个页面，其中有一个左侧菜单。此左侧菜单是一个 HTML 文件 [LeftFrame.htm]，并使用以下代码包含在 aspx 页面中。

```
<!-- #include file="LeftFrame.htm"--> 
```

现在我需要将文件名从 C# 代码更改为 LeftFrameOthers.htm。

例如：

```
if ( arg == 1 )
{
    divMenu.InnerHTML = "<!-- #include file="LeftFrame.htm"-->";
}
else
{
     divMenu.InnerHTML = "<!-- #include file="LeftFrameOthers.htm"-->";
} 
```

但它会产生错误并且未加载左侧菜单。有没有办法从 C# 代码管理这个。

我不想为此目的使用两个 div，例如..

```
<div id="divOwnLeftFrame" runat="server" style="DISPLAY: block">
           <!-- #include file="LeftFrame.htm"--></div><div id="divOthersLeftFrame" runat="server" style="DISPLAY: block">
          <!-- #include file="LeftProfileFrame.htm"-->
</div> 
```

并从 C# 代码更改 div 的显示属性。

**我正在使用 VS 2003**

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:39:46.073

您可以创建一组 LeftFrame 用户控件，您可以在代码隐藏中替换它们。这样，您可以动态选择在运行时加载的控件。

例如 。. .

```
ILeftFrame {}

LeftFrame : ILeftFrame {}
LeftFrameOthers : ILeftFrame {} 
```

然后，控件本身

```
LeftFrameControl : System.Web.Ui.UserControl {} 
```

然后，在您的页面中，您有一个

```
<myns:LeftFrameControl runat="Server">. 
```

该控件将具有一个属性，允许您指定您正在使用的 ILeftFrame，将加载它，将执行适当的行为，并且在面向对象的世界中一切都会很好。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:57:31.950

解决这个问题的一些肮脏的方法可能是做这样的事情：

```
<div id="ALeftMenu">
<%

if ( arg == 1 )
{
    %>
    <!-- #include file="LeftFrame.htm"-->";
    <%
}
else
{
     %>
     <!-- #include file="LeftFrameOthers.htm"-->
     <%
}

%>
</div> 
```

不完美，但快速，简单，可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:08:05.203

ASP.NET 中包含文件的使用通常已被功能更强大的用户控件所取代。这是使用包含文件的另一种选择：

ASPX：

```
<asp:Literal ID="FrameLiteral" runat="server" /> 
```

后面的代码：

```
private string GetFrameContent(int arg)
{
    string filename = (arg == 1) ? "LeftFrame.htm" : "LeftFrameOthers.htm";
    string path = Server.MapPath("./" + filename);
    string content = System.IO.File.ReadAllText(path);

    return content;
}

// Populate Literal
FrameLiteral.Text = GetFrameContent(arg); 
```

不像使用用户控件那样优雅，但它应该可以完成这项工作并且相对整洁。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:37:43.050

一个[ASP.NET 文字控件](http://msdn.microsoft.com/en-us/library/f93yf0ee(VS.80).aspx)似乎非常适合此目的。该代码与您发布的代码几乎相同：

**标记**

```
<div id="divOwnLeftFrame" runat="server" style="display: block;">
    <asp:Literal id="menuLiteral" runat="server" Mode="PassThrough" />
</div> 
```

**代码隐藏**（简化）

```
menuLiteral.Text = String.Format("<!-- #include file="LeftFrame{0}.htm"-->", 
    (arg == 1) ? "" : "Others"; 
```

让我知道这是否有效。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-02-01T09:19:51.713

另一种选择可能是...

html:

```
<div style="DISPLAY: block">
    <asp:placeholder id=="phContent1" runat="server" visible="false">
        <!-- #include file="LeftFrame.htm"-->
    </asp:placeholder>
    <asp:placeholder id=="phContent2" runat="server" visible="false">
        <!-- #include file="LeftFrameOthers.htm"-->
    </asp:placeholder>
</div> 
```

您的 C# 代码：

```
if ( arg == 1 )
{
    phContent1.Visible = true;
}
else
{
    phContent2.Visible = true;
} 
```

# asp.net-mvc - 服务器端图像映射的 ASP.NET MVC 路由

> ID：887648
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:33:07.957
> 
>         
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, imagemap

我有`<input type='image'>`一个 ASP.NET MVC 视图，但我不确定如何在提交表单时运行的操作中检索坐标。请求的 URL 看起来像

```
/地图/视图/?map.x=156&map.y=196
```

但我不能只做

```
public ActionResult View( int map.x, int map.y )
{
  ...
} 
```

因为它们显然不是 C# 方法参数的有效名称。是否有任何等效的`ActionName`属性将查询参数映射到方法参数？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T12:59:58.933

您必须使用模型绑定器并将前缀属性设置为“map”：  

首先创建模型对象：  

```
public class ImageMap()
{
  public int x{get;set;}
  public int y{get;set;}
} 
```

在您的操作方法中：  

```
public ActionResult About([Bind(Prefix="map")]ImageMap map)
{

   // do whatever you want here
    var xCord = map.x;

} 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T13:24:21.833

要直接回答您的问题，您可以使用 [Bind] 更改参数上使用的字段：

```
public ActionResult View([Bind(Prefix="map.x")] int x, 
    [Bind(Prefix="map.y")] int y ) 
```

但是，将图像映射绑定到 System.Drawing.Point 结构的自定义 ModelBinder 会更好。

**编辑：**这是一个自动映射到 System.Drawing.Point 参数的 ImageMapBinder。只要将以下代码添加到 Application_Start，您就不必使用属性来装饰每个 Point 参数：

```
ModelBinders.Binders.Add(typeof(Point), new ImageMapBinder()); 
```

尽管您仍然可以根据`[Bind(Prefix="NotTheParameterName")]`需要重命名输入。

ImageMapBinder 的代码如下：

```
public class ImageMapBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext, 
        ModelBindingContext bindingContext)
    {
        int x, y;

        if (!(ParseValue(bindingContext, "x", out x) &&
            ParseValue(bindingContext, "y", out y)))
        {
            return Point.Empty;
        }

        return new Point(x, y);
    }

    private bool ParseValue(ModelBindingContext bindingContext, string value, 
        out int outValue)
    {
        string key = String.Concat(bindingContext.ModelName, ".", value);

        ValueProviderResult result = bindingContext.ValueProvider[key];

        if (result == null)
        {
            outValue = 0;
            return false;
        }

        return ParseResult(result, out outValue);
    }

    private bool ParseResult(ValueProviderResult result, out int outValue)
    {
        if (result.RawValue == null)
        {
            outValue = 0;
            return false;
        }

        string value = (result.RawValue is string[])
            ? ((string[])result.RawValue)[0]
            : result.AttemptedValue;

        return Int32.TryParse(value, out outValue);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:39:11.143

你可以像这样创建一个类：

```
public class ImageMap()
{
  public int x{get;set;}
  public int y{get;set;}
} 
```

然后将其用作您的操作方法的参数

```
public ActionResult View(ImageMap map)
{
  ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:39:15.497

试试`IModelBinder`s。看到[这个](http://odetocode.com/Blogs/scott/comments/12788.aspx)，[这个](http://aspnet.codeplex.com/SourceControl/changeset/view/17272#266460)和[这个问题](https://stackoverflow.com/questions/230077/imodelbinder-and-asp-net-mvc-beta)。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-06-27T09:48:49.443

您可以尝试一种完全不同的方法，并使用以下链接中提供的代码构建您的图像映射。

[http://www.avantprime.com/articles/view-article/9/asp.net-mvc-image-map-helper](http://www.avantprime.com/articles/view-article/9/asp.net-mvc-image-map-helper)

# asp.net-mvc - App_Data 中的数据库没有持久化数据

> ID：887651
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:34:05.880
> 
>         
> 
> 标签：asp.net-mvc, sql-server-2005, fluent-nhibernate

我的 app_data 文件夹中有一个 sql 数据库，我的连接字符串如下所示：

`Server=.\SQLExpress;AttachDbFilename=|DataDirectory|wikipediamaze.mdf; Trusted_Connection=Yes;`

我正在使用 Fluent Nhibernate，并且所有内容都已正确映射。我能够很好地连接到数据库，甚至可以毫无问题地更新和插入行。

我的问题是，一旦我停止调试，我的数据就没有了。我检查过我的数据库是否被放入 bin 文件夹中，并且每次运行应用程序时都会创建一个新实例，但事实并非如此。

有没有人有任何其他建议？我已经花了两个晚上试图弄清楚这一点。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:02:11.133

一种可能性是您没有提交更改。启动 SQL Profiler，您将确切地看到针对您的数据库运行的 SQL。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T23:30:07.587

我遇到的问题是我不正确地使用了 NHibernate 会话。我需要调用 ISession.Flush 或 ITransaction.Commit 将其持久化到数据库中。

# java - JDBC Dates Deprecated in Java (java.sql package)

> ID：887653
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-20T12:34:44.803
> 
>         
> 
> 标签：java, jdbc

I am working with JDBC and MySQL. I have a date column that I need included in my result set. Unfortunately, I cannot find a class in Java to retrieve the date. The SQL Date class is deprecated. How do you get Date objects from a result set?

* * *

## 回答 #1

> 赞同：23
> 
>             
> 
> 时间：2009-05-20T12:38:28.710

You use [java.sql.Date](http://java.sun.com/javase/6/docs/api/java/sql/Date.html). A constructor and some methods are deprecated. The class isn't. Confused by this versus, say, [java.util.Date](http://java.sun.com/javase/6/docs/api/java/util/Date.html) or [java.util.Calendar](http://java.sun.com/javase/6/docs/api/java/util/Calendar.html)? Look at [Making Sense of Java's Dates](http://www.onjava.com/pub/a/onjava/2003/06/05/java_calendar.html).

There are three JDBC date/time types:

*   [DATE](http://java.sun.com/javase/6/docs/api/java/sql/Types.html#DATE): granularity of days, use [java.sql.Date](http://java.sun.com/javase/6/docs/api/java/sql/Date.html);

*   [TIMESTAMP](http://java.sun.com/javase/6/docs/api/java/sql/Timestamp.html): date and time, use [java.sql.Timestamp](http://java.sun.com/javase/6/docs/api/java/sql/Timestamp.html);

*   [TIME](http://java.sun.com/javase/6/docs/api/java/sql/Types.html#TIME), just the time with no date, use [java.sql.Time](http://java.sun.com/javase/6/docs/api/java/sql/Time.html).

The confusion probably arises from the fact that java.sql.Date extends java.util.Date and thus inherits its deprecated methods.

Just use the right type for the type of your column.

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T12:37:41.320

I don't think the java.sql.Date class itself it deprecated, only one of its constructors. You should be safe to continue using it.

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:46:33.127

You can safely use the java.sql.Date class to map your MySQL DATE type. The java.sql.Date class extends the java.util.Date class, so you can use this object to do all types of date calculations.

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-12-23T17:47:14.023

Old post, but anyways:

I had problems with the granularity of java.util.Date and switched to java.util.Timestamp.
I also experienced limited granularity with Timestamp type (up to seconds).

The columns in the database are declared as Date and to get the additional time part, I retrieved it as Timestamp. Problem is it truncates the value to seconds.

I investigated the Oracle default definition for timestamp which allows for 6 fractional digits.

I guess the Date part in the oracle definition limits the timestamp part in Java...

Cheers,
Grazina

# ruby-on-rails - 在 Rails 2.3 中正确使用 text_field 的 :disabled 选项？

> ID：887657
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T12:36:35.673
> 
>         
> 
> 标签：ruby-on-rails

我刚刚从 Rails 2.1 更新到 Rails 2.3.2，并注意到`:disabled`在输入字段上使用选项时出现问题。

以前我们将此选项用作布尔值，因此我们将指示是否要基于对象上的方法禁用字段，例如

```
f.text_field :amount, :disabled => @my_object.is_disabled?, :class => 'my_class' 
```

这在 Rails 2.1 中工作得很好——如果`is_disabled?`返回 true，则表单字段被禁用，否则不是。

然而，在 Rails 2.3 中，情况并非如此。无论 的值如何，表单域都被禁用`:disabled`。

这是否意味着我必须`if`在我的声明周围`f.text_field`发表声明，例如：

```
<% if @my_object.is_disabled? %>
  <%= f.text_field :amount, :disabled => 'disabled', :class => 'my_class' %>
<% else %>
  <%= f.text_field :amount, :class => 'my_class' %>
<% end %> 
```

我肯定在这里遗漏了一些东西吗？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T13:54:43.533

他们摆脱了 is_boolean_field？在轨道 2.3 中。它只是 boolean_field 吗？现在。

所以：

```
f.text_field :amount, :disabled => @my_object.disabled?, :class => 'my_class' 
```

应该可以正常工作。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-21T09:51:19.370

请忽略此线程。我遇到的问题实际上是 Javascript。

添加 :disabled => false 将 "disabled=''" 添加到表单字段，这毕竟*不会正确禁用表单字段。*

# php - 在 PHP 中对 JSON 输出进行排序

> ID：887667
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:39:22.797
> 
>         
> 
> 标签：php, arrays, json, sorting

我有以下 JSON：

```
{
"row":  [
    {
    "sort":3,
    "type":"fat",
    "widgets":
        [
            {"values": [3,9] },
            {"values": [8,4] }                  
        ]
    },
{
    "sort":2,
    "type":"three",
    "widgets":
    [
        {"values": [3,4] },
        {"values": [12,7] },
        {"values": [12,7] }                         
    ]
}                       
]
} 
```

这个PHP输出它：

```
foreach ( $value->row as $therow )
{
    echo "<div class='row ".$therow->type."'>";

    foreach ( $therow->widgets as $thewidgets )
    {
        echo "<div class='widget'>";
        echo $thewidgets->values[0];
        echo "</div>";

    }

    echo "</div>";

} 
```

我想做的是根据 JSON 中的排序值对输出进行排序，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T12:46:18.540

使用[usort](http://au.php.net/usort)：

```
function my_sort($a, $b)
{
    if ($a->sort < $b->sort) {
        return -1;
    } else if ($a->sort > $b->sort) {
        return 1;
    } else {
        return 0;
    }
}

usort($value->row, 'my_sort'); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:47:33.840

看这里：

[在 PHP 中对关联数组进行排序](https://stackoverflow.com/questions/777597/sorting-an-associative-array-in-php/777625)

用于用户定义的排序。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:45:22.520

如果您想在客户端执行此操作，请参阅以下内容。

[按值对 JSON 进行排序](https://stackoverflow.com/questions/881510/json-sorting-question/881987#881987)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:48:47.583

`foreach`只需在第二个循环中打印之前对数据进行排序：

```
foreach ($value->row as $therow) {
    if ($therow->sort == 2) {
        // sort $therow->widgets according to whatever sort 2 means
    } elseif ($therow->sort == 3) {
        // sort $therow->widgets according to whatever sort 3 means
    }
    echo "<div class='row ".$therow->type."'>";
    foreach ($therow->widgets as $thewidgets) {
        echo "<div class='widget'>";
        echo $thewidgets->values[0];
        echo "</div>";
    }
    echo "</div>";
} 
```

# asp.net-mvc - 在 ASP.NET MVC 中处理级联下拉其他回发方案的最佳实践

> ID：887668
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:39:30.830
> 
>         
> 
> 标签：asp.net-mvc

我已经看到了一些使用 jQuery 和 Ajax 在 ASP.NET MVC 中处理级联下拉列表的示例。当然，这需要启用 javascript。假设 javascript 被禁用，这将是处理级联下拉列表的最佳实践。

这是我为我工作的公司的库存应用程序开发的 asp.net Web 表单的真实场景。在网页上，我有级联下拉菜单。对于此示例，假设汽车品牌的下拉列表和取决于所选汽车品牌的汽车型号。此外，在此表单上，我有一个用户控件，它实现了搜索功能，因此用户可以输入城市和/或州，选择搜索，然后从网格视图中选择客户，这会触发一个事件，将客户 ID 存储在一个字段中网页上的当前订单。我没有在此页面上使用 javascript。下拉菜单触发回发并重新加载第二个下拉菜单中的下拉值。当用户单击 Find 按钮并从 gridview 中选择客户时，搜索用户控件会导致回发。

这将如何在 MVC 中处理？我的示例中的回发是否等同于 MVC 中的操作？改变汽车品牌会采取行动吗？搜索的动作？从gridview中选择的动作？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:56:38.863

除非它是大量数据，否则您应该考虑使用 <optgroup> 标签来显示您的分组。从可访问性的角度来看，这也是一件更好的事情。

尽管值得注意的是 optgroups 仅适用于层次结构的一个级别。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-06-12T10:53:49.320

我有一个场景，我有三个下拉菜单，每个下拉菜单的值取决于前一个下拉菜单的值。

> 我知道无论何时发布表单，它都会转到特定的 ActionName，默认情况下它将与 aspx 页面名称相同，因此如果它是 Index.aspx，则在发布时它会调用位于其控制器中的方法 Index()。

上述行为引起了一些问题，所以

```
From:<%=Html.DropDownList("From", (SelectList)ViewData["From"], new { onchange = "this.form.action='Index'; this.form.submit();" })%>
To :<%=Html.DropDownList("To", (SelectList)ViewData["To"], new { onchange = "this.form.action='GetTo'; this.form.submit();" })%> 
```

我首先将动作名称更改为“GetTo”，然后发布数据，因此它将转到控制器的 GetTo 方法而不是 Index()。

在这里，我使用 javascript 更改操作名称，然后提交表单。

希望这可能会有所帮助。

# jquery - 如何突出显示 AJAX 帖子上的 Html.ValidationMessage？

> ID：887677
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:43:18.733
> 
>         
> 
> 标签：jquery, asp.net-mvc

我有一个通过 jQuery AJAX 发回的表单。在我的控制器中，它检查 ModelState 中的错误并在 ContentResult 中返回这些错误，并且用户在更新的 DIV 中看到错误。

出现错误时如何获取字段旁边的小 *？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-22T08:39:40.517

我已将模型状态作为 JSON 对象返回。在 OnSuccess 事件中，我遍历错误并找到一个带有 modelstate 键名的跨度并将其设置为可见。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:47:52.983

这只是一个类名。  `input-validation-error`. 您可以使用 jquery 解析错误属性的结果并将类添加到适当的元素。

# c# - ASP.NET 在 UpdatePanel 中更新内容

> ID：887679
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:43:24.333
> 
>         
> 
> 标签：c#, asp.net, updatepanel

在 aspx 页面上，我有一个位于 Updatepanel 内的 PlaceHolder。

我在运行时创建嵌套中继器：

```
protected void Page_Init(object sender, EventArgs e)
{       
        CreateRepeater(PlaceHolder1, 0);
        Repeater repeater1 = (Repeater)PlaceHolder1.FindControl("Repeater1");

        if (repeater1 != null)        
            BindDataToRepeater(repeater1, 0);
            /*Each repeater creates another repeater(if needed)
              in repeater_ItemCreated event and binds it to data
              in repeater_ItemDataBound event
            */          
} 
```

在 repeater_ItemCommand 事件中，执行操作（如删除）后，我需要重新创建并重新绑定中继器以使更改出现。我现在要做的是：

```
 Page.Response.Redirect(Page.Request.Url.ToString(), true); 
```

有更好的方法吗？使用更新面板？

或者也许是另一种方式？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:05:48.630

我认为您只需要在 Delete 事件处理程序中调用 Repeater1.DataBind() 即可刷新控件。

# iphone - iTunesConnect 可以为我的客户下载统计信息

> ID：887685
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:44:23.223
> 
>         
> 
> 标签：iphone, app-store-connect

我为客户开发了一个应用程序，并希望让他访问我的 iTunesConnect，以便访问他的应用程序的下载统计信息。

问题是，如果我创建一个新用户并将权限设置为只查看报告，他将能够获取所有统计信息......

而且我不想每天手动获取统计信息。

你有想法吗 ？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-29T12:58:56.603

您可以在 www.appfigures.com 上开设一个帐户，它会导入和解析您的报告，然后将它们显示在交互式图表中并发送电子邮件报告。

然后，您可以为该应用程序设置一个电子邮件报告，以仅发送到您客户的电子邮件，他将获得一份完整的报告，其中包括销售、下载和更新（按国家/地区的总计）以及如果应用程序出现的警报在世界任何地方都排名前 100 位。报告可以是每天或每周。

appfigures.com 目前是（在测试阶段免费）

# c++ - 用c++写一个循环文件

> ID：887689
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-05-20T12:44:58.807
> 
>         
> 
> 标签：c++, file-io, ofstream

我需要用 C++ 编写一个循环文件​​。程序必须在文件中写入行，当代码达到最大行数时，它必须覆盖文件开头的行。

有人知道吗？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-20T12:48:06.040

不幸的是，您不能在不重写整个文件的情况下截断/覆盖文件开头的行。

## 新建议

我刚刚想到了一种可能对你有用的新方法......

您可以在具有以下结构的文件中包含一个小标题。

*编辑：*垃圾，我刚刚描述了一个[循环缓冲区](http://en.wikipedia.org/wiki/Circular_buffer)的变体！

**标题字段**

*   `Bytes 00 - 07 (long)`- 写入文件的总（当前）行数。

*   `Bytes 08 - 15 (long)`- 指向文件“实际”第一行开头的指针。这最初是标头结束后的字节，但稍后会在数据被覆盖时更改。`

*   `Bytes 16 - 23 (long)`- 文件“结束部分”的长度。同样，这最初将为零，但稍后会在数据被覆盖时更改。

**读取算法（伪代码）**

*读取整个文件。*

```
读取指向“实际”第一行开头的标题字段
读取指定“结束部分”长度的标题字段
读取每一行直到文件末尾
查找标题结束后的字节
阅读每一行，直到“结束部分”被完全阅读

```

**写算法（伪代码）**

*将任意数量的新行写入文件。*

```
读取包含总数的标题字段。文件中的行数
如果（行数）+（新行数）<=（最大行数）那么
    在文件末尾追加新行
    将行数的标题字段增加（ne 行数）
别的
    将尽可能多的行（最多）附加到文件末尾
    从指向第一行的指针（在标题字段中）开始，读取仍需要写入的行数
    查找刚刚读取的行的总字节数
    将指向第一行的头字段设置为流中的下一个字节
    继续将新行写入文件末尾，一次一次，直到剩余行的字节数小于文件开头的行的字节数（可能这个条件立即为真，在这种情况下你不需要再写了）
    将剩余的新行写入文件的开头（从头后的字节开始）
    将包含文件“结束部分”长度的标题字段设置为刚刚写入标题之后的字节数。

```

我完全承认，这不是一个非常简单的算法！尽管如此，我认为它在某种程度上非常优雅。当然，如果有任何不清楚的地方，请告诉我。希望它现在应该完全按照您的意愿行事。

## 原始建议

现在，如果您保证行的长度是恒定的（以字节为单位），您可以轻松地返回到适当的点并覆盖现有数据。然而，这似乎是一个不太可能的情况。如果您不介意施加您的行必须具有最大长度的限制，并且另外将您写入的每一行填充到该最大长度，那么这可能会让您的事情变得容易。尽管如此，它也有其缺点，例如在某些情况下会大大增加文件大小（即大多数行比最大长度短得多。）这完全取决于情况是否可以接受......

最后，您可能希望考虑利用现有的日志记录系统，具体取决于您的确切目的。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-05-20T12:51:08.047

处理大小不会爆炸的日志的常用方法是使用滚动日志文件，并且每天滚动一次或类似的，并且只保留 N 个最新的文件。

例如，每天您创建一个文件名为“application_2009_05_20.log”的新日志文件，然后开始写入，始终追加。

一旦你有 14 天的日志文件，你就开始删除最旧的。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T13:02:35.480

由于文件是面向字节的，并且您需要面向行的服务，因此您有两种选择：

1.  在文件周围实现一个面向行的包装器

2.  切换到一些面向线路的设备。我最想知道的是：SQLite 有一些不错的 C++ 包装器可用。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T14:43:23.763

**使用循环缓冲区并将缓冲区写入每个添加的文件。**

这是一个小而简单的代码大小解决方案。它是一个简单的字符串循环缓冲区，每次添加字符串时，它都会将整个字符串缓冲区写入文件（当然，为单个添加操作写入*所有字符串会产生**巨大*的成本。所以这仅适用于少量字符串）。

 *循环缓冲区的简单实现，输出到文件：

```
// GLOBALS ( final implementation should not use globals )
#define MAX_CHARS_PER_LINE (1024)
#define MAX_ITEMS_IN_CIRCULARBUF (4) // must be power of two
char    lineCircBuf[MAX_ITEMS_IN_CIRCULARBUF][MAX_CHARS_PER_LINE];
int     lineCircBuf_add = 0;
int     lineCircBuf_rmv = 0; // not being used right now
uint32_t lineCircBuf_mask = MAX_ITEMS_IN_CIRCULARBUF-1;
char    FILENAME[] = "lineCircBuf.txt";
FILE *  ofp = NULL;

int addLine(char * str) {
    int i;

    // Error checking
    if( strlen(str) > MAX_CHARS_PER_LINE ) {
        return -1; // failure
    }
    if( ofp != NULL) {
        fclose(ofp);
    }

    // Copy string into circular buffer
    strncpy( &(lineCircBuf[lineCircBuf_add][0]),
             str,
             MAX_CHARS_PER_LINE );
    lineCircBuf_add = ( lineCircBuf_add + 1 ) & lineCircBuf_mask;

    // Write to file
    ofp = fopen(FILENAME,"w");
    for( i = 0; i < MAX_ITEMS_IN_CIRCULARBUF-1; i++ ) {
        fprintf( ofp, "%s\n", lineCircBuf[i] );
    }
    fprintf( ofp, "%s", lineCircBuf[i] ); // do not add a newline to the last line b/c we only want N lines in the file

    return 0; // success
}

int removeLine(int index) {
    // not implemented yet
}

void unitTest() {
    int i;

    // Dummy text to demonstrate adding string lines
    char lines[5][MAX_CHARS_PER_LINE] = {
        "Hello world.",
        "Hello world AGAIN.",
        "The world is interesting so far!",
        "The world is not interesting anymore...",
        "Goodbye world."
    };

    // Add lines to circular buffer
    for( i = 0; i < sizeof(lines)/sizeof(lines[0]); i++ ) {
        addLine(&(lines[i][0]));
    }
}

int main() {
    unitTest();
    return 0;
} 
```

所以在上面的例子中，我们有 5 行输入，我们的缓冲区只有 4 行长。因此输出应该只有 4 行，第一行应该被最后一行“再见世界”覆盖。果然输出的第一行确实有“再见世界”：

```
Goodbye world.
Hello world AGAIN.
The world is interesting so far!
The world is not interesting anymore... 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:48:33.013

这会很棘手，因为文件 I/O 使用字节作为底层存储单元，而不是行。

我的意思是你可以 fseek() 回到开头并破坏早期的数据，但我有一种预感，这不是你想要的。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:03:30.423

简单的解决方案：

1.  有某种线的分隔符。

2.  每次添加新行时，只需覆盖从当前行开始的所有文本，直到遇到分隔符。

3.  文件末尾是一种特殊情况，可能有一些填充以保持文件大小不变。

此解决方案旨在提供恒定的文件长度，而不是文件中的恒定行数。行数将随时间变化，具体取决于长度。此解决方案使快速查找特定行号变得更加困难，尽管您可以将一些指标数据粘贴在文件的顶部或底部以使其更容易。

“聪明”的解决方案（上述解决方案的变体）：

只需使用有时用于双端队列的相同技巧。只是明确地从文件的开头环绕到结尾，但要跟踪文件的开头/结尾在哪里。当您希望使用不支持该文件的程序读取该文件时，您可以编写一个解包实用程序将该文件转换为标准文件。这个解决方案真的很容易实现，但我更喜欢上面的版本。

丑陋的解决方案：

添加行时，为添加的每一行添加适量的填充。

每次您希望添加新行时，请执行以下操作：

1.  确定当前行的长度，包括填充。请注意，当前行的开头等于上一行的结尾，不包括填充。

2.  如果当前行足够长以适合您所在的行，请将其放入。在前一行的末尾添加等于任何多余空间的 1/3 的左填充，以及等于任何多余空间的 2/3 的右填充多余的空间。

3.  如果当前行的长度不足以容纳您所在的行，请将行移到您前面（吃掉他们的填充物）直到他们有空间。

4.  如果第 3 步达到某种阈值，则使用更多填充重写整个文件。

请注意，除非您的线条在长度上非常一致，否则这将非常糟糕。一个更简单的解决方案是保证线条的长度恒定（但以某种方式创建多行“线条”，以防超过该长度。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:12:34.680

我已经看到通过将文件的*当前写入位置*保持在某处来完成此操作。当您需要添加一行时，您会寻找该位置，写入该行并以原子方式更新该位置。如果溢出，则在写入该行之前寻求为零。我们今天为大小受限的循环日志文件执行此操作。在线路约束的基础上做这件事有点奇怪，但可能以类似的方式完成。我们的写循环看起来像：

```
logFile.lockForWrite();
currentPosition = logFile.getWritePosition();
logFile.seek(currentPosition);
for each line in lineBuffer {
    if ((currentPosition+line.length()) > logFile.getMaxSize()) {
        currentPosition = 0;
        logFile.seek(0);
    }
    logFile.write(line);
    currentPosition += line.length();
}
logFile.setWritePosition(currentPosition);
logFile.unlock(); 
```

棘手的部分是保持*当前的写入位置*`tail`，并在应用程序写入文件时找到某种方式来协调读取文件（例如，使用实用程序）。您的阅读器实用程序还必须跟踪写入位置，因此它的读取循环变为：

```
lastPosition = logFile.getWritePosition();
while (!killed) {
    logFile.wait();
    logFile.lockForRead();
    newPosition = logFile.getWritePosition();
    logFile.seek(lastPosition);
    newLine = logFile.readFrom(lastPosition, (newPosition-lastPosition));
    lastPosition = newPosition;
    logFile.unlock();
} 
```

这不是任何特定的语言——它只是伪代码，但想法就在那里。当然，我把处理所有有趣的边缘情况留给了读者。

综上所述……我同意其他意见。除非你有充分的理由，否则不要这样做。这听起来是个好主意，但是：

*   实现很难写

*   更难提高效率

*   由于必须在某处维护*写入位置*，因此多个实用程序必须就如何读取、更新、初始化等达成一致。

*   拥有非线性日志会使使用现有工具（如`grep`、`tail`、`perl`等）进行日志处理变得困难。

总体而言，您最好使用一些允许可配置日志文件管理的现有包日志记录包。看看[Apache 的 log4cxx](http://logging.apache.org/log4cxx/index.html)或[Poco 的`Poco::Logger`](http://pocoproject.org/docs/Poco.Logger.html).

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:02:45.063

**如果文件需要是文本文件：**

这对于不同的行长度是非常有问题的。你的前两行每行 80 个字符，你如何用 100 个字符的行覆盖它？

如果新行应该*替换第一行*，这将导致文件插入，这是一个非常昂贵的操作（基本上，需要读取和写入文件的整个其余部分）。除了最少量的数据，您真的不想对所有数据都这样做。

如果这是为了记录目的，请使用滚动日志文件 - 例如每天一个（如 lassevek 建议的那样）。我让它变得更简单：当文件大小超过限制时，旧文件被重命名为 .bak（旧的 .bak 被删除），然后重新开始。使用 1MB 限制，这会保留例如最后的 1 MB，而不会占用超过 2 MB。

您可以对两个或多个文件使用类似的机制。基本上，将“翻转”移动到文件，而不是行。

**如果文件可能是专有格式：**

使用基本数据库引擎（如建议的 SQLite）或其他结构化存储机制。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:05:54.760

您可以使用[`log4cxx`](http://logging.apache.org/log4cxx/index.html)with a[`RollingFileAppender`](http://logging.apache.org/log4cxx/apidocs/index.html)将此信息写入日志文件。当`RollingFileAppender`日志文件达到一定大小时，它将处理滚动日志文件。我不认为这*正是*你想要的，但它相当简单——也许它会做。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:08:56.610

只需创建所需大小的文件映射（CreateFileMapping 或 mmap），将行写入缓冲区并在达到最大数量时重新开始。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:03:37.057

**简单的解决方法：**

*   定义每行的最大长度为 80 个字符。将较长的“行”包装成几行。

*   将行标题添加到行。例如“[#589] 这是第 589 行”所以你会知道什么是第一个等。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:54:46.020

如果您想生成此文件以输入到另一个应用程序，我认为您最好的选择是直接登录到关系数据库（SQL Server、MySQL 等），然后根据需要从记录的数据中定期生成该文件.

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T17:46:39.883

为了解决可变大小的问题，您可能最终会得到一个间接和分配方案。这将包括一个间接块，该块具有固定数量的指向文件的“指针”，以及一个环绕 N 的“下一个要写入的”指针。

但主要技巧是添加间接性。

# jquery - jQuery datepicker，onSelect 不起作用

> ID：887696
> 
>         
> 
> 赞同：51
> 
>         
> 
> 时间：2009-05-20T12:47:07.850
> 
>         
> 
> 标签：jquery, datepicker, onselect

我无法`onSelect`处理我的 jQuery `datepicker`。

这是我的代码：

```
<script type="text/javascript">
$(function() {
    $('.date-pick').datePicker( {
        onSelect: function(date) {
            alert(date)
        },
        selectWeek: true,
        inline: true,
        startDate: '01/01/2000',
        firstDay: 1,
    });
});
</script> 
```

就像它没有注册该`onSelect`功能一样。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：91
> 
>             
> 
> 时间：2009-05-20T12:58:54.020

最后一个属性后没有逗号。

警报后的分号（日期）；

datepicker 上的案例（不是 datePicker）

检查您的其他大写/小写的属性。

```
$(function() {
    $('.date-pick').datepicker( {
        onSelect: function(date) {
            alert(date);
        },
        selectWeek: true,
        inline: true,
        startDate: '01/01/2000',
        firstDay: 1
    });
}); 
```

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-05-20T13:47:23.847

datePicker 的 onSelect 等效项是 dateSelected 事件。

```
$(function() {
    $('.date-pick').datePicker( {
        selectWeek: true,
        inline: true,
        startDate: '01/01/2000',
        firstDay: 1,
    }).bind('dateSelected', function(e, selectedDate, $td) {
        alert(selectedDate);
    });
}); 
```

[这个页面](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/datePickerKarmasAgent.html)有一个很好的例子，展示了 dateSelected 事件和其他被绑定的事件。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2017-02-24T06:02:54.543

```
$('.date-picker').datepicker({
                    autoclose : true,
                    todayHighlight : true,
                    clearBtn: true,
                    format: 'yyyy-mm-dd', 
                    onSelect: function(value, date) { 
                         alert(123);
                    },
                    todayBtn: "linked",
                    startView: 0, maxViewMode: 0,minViewMode:0

                    }).on('changeDate',function(ev){
                    //this is right events ，trust me
                    }
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2010-11-09T13:39:30.000

最好的解决方案是设置日期选择器默认值

遵循我使用的代码

```
$.datepicker.setDefaults({
    onSelect: function () {
        $(this).focus();
        $(this).nextAll('input, button, textarea, a').filter(':first').focus();
    }
}); 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T12:54:36.493

该函数`datepicker`区分大小写并且全部小写。但是，以下内容对我来说很好：

```
$(document).ready(function() {
  $('.date-pick').datepicker( {
    onSelect: function(date) {
        alert(date);
    },
    selectWeek: true,
    inline: true,
    startDate: '01/01/2000',
    firstDay: 1
  });
}); 
```

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2012-10-14T04:02:51.150

```
<script type="text/javascript">
    $(function() {
        $("#datepicker").datepicker({ 
              onSelect: function(value, date) { 
                 window.location = 'day.jsp' ; 
              } 
        });
    });
 </script>

<div id="datepicker"></div> 
```

我想你可以试试这个。效果很好。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-12-23T17:38:44.473

我已经从 jqueryui.com/download 下载了 datepicker，我得到了 1.7.2 版本，但 onSelect 功能仍然不起作用。这是我所拥有的 -

```
$("#datepicker").datepicker();

$("#datepicker").datepicker({ 
      onSelect: function(value, date) { 
         alert('The chosen date is ' + value); 
      } 
}); 
```

我在此页面中找到了解决方案 - [jquery datepicker onselect 的问题](https://stackoverflow.com/questions/1274347/problem-with-jquery-datepicker-onselect)。删除了 $("#datepicker").datepicker(); 一次，它奏效了。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:52:27.653

如果您使用的是 jQuery UI DatePicker 插件，它应该是“datepicker”，而不是“datePicker”。也许，您有一个不支持选择处理程序的[不同但相似的插件。](http://www.kelvinluck.com/assets/jquery/datePicker/v2/demo/)

# xml - 如何更改 Excel 的 XML 数据导出的缩进？

> ID：887698
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:47:42.453
> 
>         
> 
> 标签：xml, excel

我正在使用 Excel 2003 的 XML 数据源并使用菜单选项数据 -> XML -> 导出来导出数据。数据导出正常，但生成的元素使用制表符缩进。这可能听起来微不足道，但是有没有办法可以将缩进的格式设置为空格？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-27T05:35:40.813

我不相信无论如何可以修改 Excel 的 XmlMap 导出逻辑的缩进字符（或 XML 编写器格式）。如果可以，请考虑编写一个简单的宏来通过 XmlMap 对象的 ExportXml 方法自己执行导出到字符串变量，然后在自己将其写入文件之前，用 Space(2) 或结果字符串中的任何内容执行简单的 vbTab 替换.

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-26T23:59:03.360

如果所有其他方法都失败了，您以后可以随时通过[Tidy](http://tidy.sourceforge.net/)运行它。

# jquery - 通过从正常的 clickevent 提交 post 操作来防止页面刷新

> ID：887712
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:49:48.033
> 
>         
> 
> 标签：jquery, events, click, submit

我可以阻止此代码刷新页面吗？

如您所见，我从普通的 click_event 提交了一个 post 操作，因为 live 不支持提交事件，所以我需要它。

```
jQuery('.verwijder').live('click', function() { 
    t=$(this);

    t.parents(".paneltbnote").animate({ opacity: 'hide' }, "slow",function(){
        t.parents(".wrappertbnote").remove();
        settbnotecounter();

        $db_tbnoteid = t.parents(1).children('.frmnoteid').val();

        $.post("tbnotesact.php", {
            noteid: $db_tbnoteid,
            actie: "verwijder",
            tijd: timestamp
        }, function(xml) {
            // hier nog iets doen
            berichtentoevoegen(xml);//feedback
        });//einde post methode

    });// einde callback animate methode

    return false;    
});//einde binding click event 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:57:04.213

尝试这个：

将第一行替换为

```
jQuery('.verwijder').live('click', function(e) { t=$(this); 
```

并替换 return false; 和

```
e.preventDefault(); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T18:55:30.713

您在 click 事件中返回 false ，但不幸的是，它不会停止提交操作。如果您可以选择*不*使用实时事件侦听器，则始终可以使用 bind() 方法观看提交操作。

```
jQuery('.verwijder').bind('submit', function() {
    /* everything as usual... */
    return false;
}); 
```

当然，如果这不是一个选项，您可能只需要在代码中添加一些逻辑，这些逻辑将取消绑定然后重新绑定所有表单的提交操作以执行您想要的操作。

```
$(function() {
    bind_submits();
    // Let's pretend you have a link that adds forms to your page...
    $('#addForm').live('click', function() {
        add_form();
    });
});

function bind_submits() {
   // We need to unbind first to make we don't multi-bind 
   jQuery('.verwijder').unbind('submit').bind('submit', function() {
        /* everything as usual... */
        return false;
    });
}

function add_form() {
    /* do some stuff to add a form to your layout... */

    // Now reset all current 'submit' binds and add the new one...
    bind_submits();
} 
```

这是在添加 live() 方法之前必须为所有事件侦听器完成的操作（如果您当然没有使用 livequery 插件）。它的编码更多，更难维护，但目前我知道的其他选择并不多。

快乐的 jQuerying...

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T15:08:04.167

很多时候，如果代码中有错误，javascript 永远不会完成函数，直到“return false;”。导致页面重新加载。暂时取消链接，看看是否有任何错误弹出。

# php - 使 index.php 表现为一个目录

> ID：887718
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:51:16.377
> 
>         
> 
> 标签：php, sysadmin

一些网站（例如，mediawiki 的某些实现）的 uri 格式为`http://example.com/index.php/SOME_PAGE`. 这是怎么做到的？index.php 只是服务器上的一个目录，它恰好被命名为 php 文件，并且实际上包含一个名为 的文件`SOME_PAGE`？如果是这样，为什么要这样命名？如果不是（即它*确实*代表某种合法的 PHP 文件），那么它的内容会是什么样子？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-05-20T12:53:10.397

此功能称为路径信息（请参阅[Apache 指令`AcceptPathInfo`](http://httpd.apache.org/docs/2.2/mod/core.html#acceptpathinfo)）。

`PATH_INFO`启用后，Apache 会写入已映射到环境变量中现有文件或目录的请求 URI 路径的其余部分。因此，如果`/index.php/SOME_PAGE`被请求并且`/index.php`是现有文件，则请求将映射到该文件，并且`/index.php`( `/SOME_PAGE`)之后的其余路径在`PATH_INFO`变量中可用。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:42:12.393

通常，它也使用 .htaccess 文件和 mod_rewrite 来完成。

有关更多信息，请参阅[本文](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:54:28.243

它的行为不像目录，它只是看起来像。

index.php 是一个常规的 php 文件。

这是一个关于如何仅使用 PHP 代码执行此操作[的教程。](http://www.evanbot.com/article/fancy-urls-without-mod_rewrite/3)这样做的问题是您只获得值并且您的代码中有无意义的键。

教程中的示例，他正在调用 index.php/about/Evan/2

为了`about`从 url 中获取，他获取

```
$url[0] 
```

这不是很有意义吗？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:54:55.620

查看 Apache 中使用的“AcceptPathInfo”指令（直接在 httpd.conf 中或通过 .htaccess）。自从我使用 PHP / Apache 以来已经有很长时间了，而且自从我进行这种 url 美化以来甚至更长的时间，但它本质上是一种将额外数据传递到 index.php 的方法，而无需 ?var1= 的“正常”html语法foo&var2=bar

请注意，当我这样做时，我设置了一个名为“动态”（或类似）的脚本作为默认的 PHP 解析处理程序，并使我的 URL 看起来像[http://hostname/dynamic/value1/value2](http://hostname/dynamic/value1/value2)

高温高压

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T12:54:57.133

这些站点使用诸如 apache 的[mod_rewrite](http://httpd.apache.org/docs/1.3/mod/mod_rewrite.html)之类的 Web 服务器模块重写传入请求以指向服务器上的实际资源。

# xml - XSLT：将 CSV 从一个源 XML 节点分解为多个目标 XML 节点

> ID：887720
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T12:51:45.457
> 
>         
> 
> 标签：xml, xslt

感谢帮助我解决[这个问题](https://stackoverflow.com/questions/886316/)的其他 SO 用户的帮助，
我的 XML 转换已经完成了一半。

我在转换逗号分隔值（日期和数量）时遇到的问题：

```
<?xml version="1.0" encoding="utf-8"?>
<results>
<recordset rowCount="68" fieldNames="ITEM,ECL,LEAD_TIME,QTY,DATE" type="**coldfusion.sql.QueryTable**">
<field name="ITEM">
<string>ITEM_A</string>
<string>ITEM_B</string>
<string>ITEM_C</string>
</field>
<field name="REV">
<string>A</string>
<string>B</string>
<string>C</string>
</field>
<field name="LEAD_TIME">
<string>10</string>
<string>15</string>
<string>25</string>
</field>

<field name="QTY">
<string>10,13,3</string>
<string>1,5,2</string>
<string>6,10,25</string>
</field>

</recordset>
<var name="DATE_LABELS">
<string>05-18,05-25,06-01</string>
</var>
</results> 
```

进入：

```
<records>
<item_line>
 <item>ITEM_A</item>
 <rev>A</rev>
 <lead_time>10</lead_time>
 <values>
    <qty date="05-18>10</qty>
    <qty date="05-25>13</qty>
    <qty date="06-01>3</qty>
 </values>
</item_line>
<item_line>
 <item>ITEM_B</item>
 <rev>B</rev>
 <lead_time>15</lead_time>
 <values>
    <qty date="05-18>1</qty>
    <qty date="05-25>5</qty>
    <qty date="06-01>2</qty>
 </values>
</item_line>
<item_line>
 <item>ITEM_C</item>
 <rev>C</rev>
 <lead_time>25</lead_time>
 <values>
    <qty date="05-18>6</qty>
    <qty date="05-25>10</qty>
    <qty date="06-01>25</qty>
 </values>
</item_line>
</records> 
```

有没有可能用 XSLT 来表达它？

我开始讨厌“设计”源xml架构的人......

更新：感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T22:01:38.263

我已经更新了我为您的其他问题提供的解决方案：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output indent="yes"/>

  <xsl:template match="/">
    <records>
      <!-- Just process the first field's children, to get the list of line items -->
      <xsl:apply-templates select="/results/recordset/field[1]/*"/>
    </records>
  </xsl:template>

          <!-- Convert each field child to a line item -->
          <xsl:template match="field/*">
            <item_line>
              <!-- Then query all the fields for the value at this position -->
              <xsl:apply-templates select="/results/recordset/field">
                <xsl:with-param name="pos" select="position()"/>
              </xsl:apply-templates>
            </item_line>
          </xsl:template>

                  <xsl:template match="field">
                    <xsl:param name="pos"/>
                    <!-- Convert the field name to lower case -->
                    <xsl:element name="{translate(@name,'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
                                                        'abcdefghijklmnopqrstuvwxyz')}">
                      <xsl:value-of select="*[$pos]"/>
                    </xsl:element>
                  </xsl:template>

                  <xsl:template match="field[@name = 'QTY']">
                    <xsl:param name="pos"/>
                    <values>
                      <xsl:apply-templates mode="qty" select="*[$pos]"/>
                    </values>
                  </xsl:template>

  <xsl:template mode="qty" match="field/*">
    <!-- ASSUMPTION: date-list and value-list will have same number of commas -->
    <xsl:param name="date-list" select="/results/var[@name = 'DATE_LABELS']/string"/>
    <xsl:param name="value-list" select="."/>
    <!-- Extract the date -->
    <xsl:variable name="date">
      <xsl:call-template name="next-item">
        <xsl:with-param name="csv" select="$date-list"/>
      </xsl:call-template>
    </xsl:variable>
    <!-- Extract the value -->
    <xsl:variable name="value">
      <xsl:call-template name="next-item">
        <xsl:with-param name="csv" select="$value-list"/>
      </xsl:call-template>
    </xsl:variable>
    <!-- Output the element -->
    <qty date="{$date}">
      <xsl:value-of select="$value"/>
    </qty>
    <!-- Keep processing if there are more left -->
    <xsl:if test="contains($date-list,',')">
      <xsl:apply-templates mode="qty" select=".">
        <xsl:with-param name="date-list"  select="substring-after($date-list,  ',')"/>
        <xsl:with-param name="value-list" select="substring-after($value-list, ',')"/>
      </xsl:apply-templates>
    </xsl:if>
  </xsl:template>

          <xsl:template name="next-item">
            <xsl:param name="csv"/>
            <xsl:choose>
              <xsl:when test="contains($csv, ',')">
                <xsl:value-of select="substring-before($csv, ',')"/>
              </xsl:when>
              <xsl:otherwise>
                <xsl:value-of select="$csv"/>
              </xsl:otherwise>
            </xsl:choose>
          </xsl:template>

</xsl:stylesheet> 
```

如果您有任何问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:49:47.867

也许你下次可以在一个问题中问这块蛋糕，这样我们就不必做两次了，但是我们开始吧！

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

  <xsl:template match="//recordset">
    <records>
      <xsl:apply-templates select="field[@name = 'ITEM']/string"/>
    </records>
  </xsl:template>

  <xsl:template match="//var" />

  <xsl:template match="string">
    <xsl:variable name="loc" select="position()"/>
    <item_line>
      <item>
        <xsl:value-of select="."/>
      </item>
      <rev>
        <xsl:value-of select="//recordset/field[@name = 'REV']/string[position() = $loc]"/>
      </rev>
      <lead_time>
        <xsl:value-of select="//recordset/field[@name = 'LEAD_TIME']/string[position() = $loc]"/>
      </lead_time>
      <values>
        <xsl:call-template name="split-csv">
          <xsl:with-param name="list">
            <xsl:value-of select="//recordset/field[@name = 'QTY']/string[position() = $loc]" />
          </xsl:with-param>
          <xsl:with-param name="labels">
            <xsl:value-of select="//var[@name = 'DATE_LABELS']/string" />
          </xsl:with-param>
        </xsl:call-template>
      </values>
    </item_line>
  </xsl:template>

  <xsl:template name="split-csv">
    <xsl:param name="list" />
    <xsl:param name="labels" />
    <xsl:variable name="first" select="substring-before($list, ',')" />
    <xsl:variable name="remaining" select="substring-after($list, ',')" />
    <xsl:variable name="label" select="substring-before($labels, ',')" />
    <qty>
      <xsl:choose>
        <xsl:when test="not($first) and $list">
          <xsl:attribute name="date">
            <xsl:value-of select="$labels"/>
          </xsl:attribute>
          <xsl:value-of select="$list" />
        </xsl:when>
        <xsl:otherwise>
          <xsl:attribute name="date">
            <xsl:value-of select="$label"/>
          </xsl:attribute>
          <xsl:value-of select="$first" />
        </xsl:otherwise>
      </xsl:choose>
    </qty>
    <xsl:if test="$remaining">
      <xsl:call-template name="split-csv">
        <xsl:with-param name="list" select="$remaining" />
        <xsl:with-param name="labels" select="substring-after($labels, ',')" />
      </xsl:call-template>
    </xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

# asp.net-mvc - MVC Crystal 报表查看器

> ID：887729
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:54:13.767
> 
>         
> 
> 标签：asp.net-mvc

当我尝试使用 MVC 架构通过视图将数据绑定到水晶报表查看器时，我在水晶报表查看器上收到类似“错误编程”消息的错误。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T12:58:37.813

您确定 Crystal Viewer 可以在 MVC 中使用吗？我认为它不起作用，因为它（可能）是一个 asp.net（不是 MVC）控件。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2017-05-27T10:36:54.397

Crystal Report 不适用于 MVC。如果要在 MVC 应用程序中显示 Crystal Report，则必须添加一个`.aspx`页面，然后才能在 MVC 应用程序中使用 Crystal Report。

# c# - 如何将字符串转换为 OctetString (C#)？

> ID：887734
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T12:54:37.180
> 
>         
> 
> 标签：c#, ldap, attributes

我正在将数据导入 LDAP 存储。有问题的属性是 OctetString 类型。我有一个正常的字符串，我需要进入该属性。

我正在使用 C# (.net 3.5)

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:03:47.960

据我所知， OctetString 只是一个字节数组。不要与八进制混淆（以 8 为基数）

完全可以更正，但一些随机谷歌搜索似乎同意......这会将您的字符串转换为字节数组

```
byte[] octets = System.Text.Encoding.ASCII.GetBytes("abcd"); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:21:47.627

```
System.Text.Encoding utf8 = System.Text.Encoding.UTF8;
byte[] octets = utf8.GetBytes("Réne"); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:02:44.730

An[`OctetString`](http://msdn.microsoft.com/en-us/library/ms684451.aspx)似乎只是一个表示为字节数组的字符串（因此是*octets*）。

[八位组字符串 (SID) 属性类型](http://msdn.microsoft.com/en-us/library/ms180873(VS.80).aspx)的 MSDN 页面提供了以下用于编写八位组字符串的示例：

```
byte[] usrSID = (byte[])usr.Properties["objectSid"].Value;
usr.Properties["objectSid "].Clear();
usr.Properties["objectSid "].Value = usrSID;
usr.CommitChanges(); 
```

# java - 比较作曲家名称，或者如何在两个字符串之间找到“足够接近”的匹配？

> ID：887738
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-20T12:55:01.377
> 
>         
> 
> 标签：java, string

完成两门 cs 课程后，我开始从事 Java 的个人项目。我正在编写一个程序，它将查看音乐收藏并尝试通过查看文件名和元标签来设置“作曲家”标签。我将这些与作为简单文本文件创建的作曲家列表进行比较。我的问题是这样的：

比较两个字符串以尝试找到最佳匹配的好方法是什么？例如，在我的情况下，假设我有一个名为“Pulenc - Gloria in excelsis Deo.flac”的文件。在我的作曲家名单中，我有“Poulenc, Francis”。我希望能够阅读“Pulenc”，并看到它非常接近“Poulenc”，以便我可以正确设置作曲家标签。一位朋友建议我考虑使用余弦距离（我以前从未听说过），另一位建议我使用 Levenshtein 距离。这些方法中的任何一个是好方法还是有其他方法可能效果更好？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T13:04:51.187

听起来[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)正是您所需要的。[余弦距离](http://www.comp.rgu.ac.uk/staff/sy/PhD_Thesis_html/page_67.htm)似乎可以处理较长的文本，而像 Soundex 这样的[语音算法](http://en.wikipedia.org/wiki/Phonetic_algorithm)可能会对名称产生较差的结果，其中大部分不打算使用英语发音规则来发音。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T12:59:33.520

有一个[名为 SimMetrics 的项目](http://sourceforge.net/projects/simmetrics/)，由英国[谢菲尔德大学](http://nlp.shef.ac.uk/wig/)运营，可以帮助您。我从 .NET 的角度[在我的博客中](http://chillijam.co.uk/2009/05/13/fuzzy-matching-of-names/)写了一些关于它的内容，但我相信该项目也有可用的 Java 实现。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:23:38.013

[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance)是一个合理的想法，尽管如果您的系统中有很多作曲家，它可能会表现不佳。与[Soundex](http://en.wikipedia.org/wiki/Soundex)（或[Metaphone](http://en.wikipedia.org/wiki/Metaphone)或[NYSIIS](http://en.wikipedia.org/wiki/New_York_State_Identification_and_Intelligence_System)）不同，编辑距离算法使您可以将拼写错误的作曲家名称与系统中的所有其他作曲家进行比较。根据有多少，这可能需要一段时间。

作为（过早的？）优化，对于名字以正确字母开头的作曲家来说，只计算 Levenshtein 距离可能是值得的。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:30:15.847

Peter Norvig 写了一篇出色的文章[“如何编写拼写校正器”](http://norvig.com/spell-correct.html)，您可能会发现它很有用，并且您可以根据自己的特定需求进行调整。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-21T02:31:08.563

顺便说一句，Apache Commons Lang lib 实现了 Levenshtein 距离计算器：[http ://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html#getLevenshteinDistance(java.lang.String ,%20java.lang.String)](http://commons.apache.org/lang/api-release/org/apache/commons/lang/StringUtils.html#getLevenshteinDistance(java.lang.String,%20java.lang.String))

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-21T02:37:34.710

我认为在您的情况下[Damerau–Levenshtein 距离](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)应该可以正常工作。如果您有更多数据，请使用它。在没有好的算法的情况下，大量的数据可以弥补。

# .net - XSLT 自闭标签问题

> ID：887739
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2009-05-20T12:55:44.357
> 
>         
> 
> 标签：.net, xslt, tags, xslcompiledtransform

我正在使用 xslt 将 xml 文件转换为 html。.net xslt 引擎不断为我提供空标签的自闭合标签。

例子：

```
<div class="test"></div> 
```

变成

```
<div class="test" /> 
```

前者是合法的 html，而后者是非法的 html，渲染效果不好。我的问题是：如何告诉 xslt 引擎 (XslCompiledTransform) 不使用自闭合标签。

如果不可能，我如何告诉我的浏览器（在这种情况下为 IE6+）正确解释自闭标签。

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2009-05-20T12:59:29.357

将您的`xsl:output`方法更改为`html`（而不是`xml`）。

或者如果您还没有该元素，请添加它

```
<xsl:output method="html"/> 
```

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2012-01-23T12:17:45.617

一种解决方法是插入一个注释元素来强制生成非自闭：

```
<script type="text/javascript" src="nowhere.js">
<xsl:comment></xsl:comment>
</script> 
```

这不是一个很好的解决方案，但它有效:-)

/斯坦

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-05-20T13:54:31.850

如果您使用 XmlWriter 作为输出流，请改用 HTMLTextWriter。XMLWriter 会将您的 HTML 输出重新格式化回 XML。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2010-09-15T15:53:21.670

这与 XslCompiledTransform 类有关

这是一种解决方法：

[http://blogs.msdn.com/b/nareshjoshi/archive/2009/01/15/how-to-force-non-self-closing-tags-for-empty-nodes-when-using-xslcompiledtransform-class。 aspx](http://blogs.msdn.com/b/nareshjoshi/archive/2009/01/15/how-to-force-non-self-closing-tags-for-empty-nodes-when-using-xslcompiledtransform-class.aspx)

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2010-11-24T15:22:53.717

*对我来说，这是脚本*标签中的一个问题。我通过用分号（**;**）填充它来解决它

```
<script type="text/javascript" src="somewhere.js">;</script> 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:08:45.983

你不能告诉你的浏览器将无效的 HTML 当作 HTML 来处理——你很幸运它完全理解了格式错误的 HTML。:)

绝对在你的样式表中这样做：

```
<xsl:output method="html"/> 
```

但是，如果您的源文档有名称空间，这将无法解决问题。如果名称空间节点出现在输出中，XSLT 处理器似乎默默地将输出方法改回 XML。

您需要将所有实例`<xsl:copy-of>`和`<xsl:copy>`元素的创建替换为仅具有本地名称的元素，例如

```
<xsl:template match="*">
   <xsl:element name="{local-name()}">
     <xsl:apply-templates/>
   </xsl:element>
</xsl:template> 
```

看

*   [http://www.biglist.com/lists/xsl-list/archives/200708/msg00538.html](http://www.biglist.com/lists/xsl-list/archives/200708/msg00538.html)

*   [http://www.stylusstudio.com/xsllist/200509/post90860.html](http://www.stylusstudio.com/xsllist/200509/post90860.html)

*   [http://www.richardhallgren.com/removing-namespace-from-outgoing-messages/](http://www.richardhallgren.com/removing-namespace-from-outgoing-messages/)

等等

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2011-07-18T22:05:57.067

我曾经在里面放一个`<xsl:text>`元素，比如：

```
<script type="text/javascript" src="/scripts/jquery.js"><xsl:text> </xsl:text></script> 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2014-04-06T07:10:47.177

您需要注意以下几点：

1.  在你的 xsl 中使用 <xsl:output method='html'>

2.  在输出 XmlWriter 中设置 OutputSettings  

3.  在您的 xsl 内的 Html 中，不要像这样在 html 标记中设置属性 < html xmlns="http://www.w3.org/1999/xhtml"> 而是使用 < html> 。

这是一段工作代码：

```
string xmlStr = "<?xml version='1.0' encoding='UTF-8'?><Data></Data>";
XmlDocument doc = new XmlDocument();
doc.LoadXml(xmlStr);
string xslContents = @"
<xsl:stylesheet version='1.0' xmlns:xsl='http://www.w3.org/1999/XSL/Transform'  
xmlns:msxsl='urn:schemas-microsoft-com:xslt' exclude-result-prefixes='msxsl'>
<xsl:output method='html' version='4.0' omit-xml-declaration='yes' indent='yes'/>
<xsl:template match='Data'>
<html>
<body>
    <div></div>
</body>
</html>
</xsl:template>
</xsl:stylesheet>";
XslCompiledTransform xsl = new XslCompiledTransform();
xsl.Load(XmlReader.Create(new StringReader(xslContents)));
StringWriter result = new StringWriter();
using (XmlWriter writer = XmlWriter.Create(result, xsl.OutputSettings))
{
    xsl.Transform(doc, null, writer);
}
System.Diagnostics.Debug.Write( result.ToString()); 
```

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2018-02-20T23:43:16.497

我发现的简单方法是创建一个新的 XmlTextWriter 类来覆盖方法 WriteEndElement，强制使用非关闭标记并将序列化过程作为参数传递。

```
public class MyXmlTextWriter : XmlTextWriter
{
    public MyXmlTextWriter(Stream stream) : base(stream, Encoding.UTF8)
    { }
    public MyXmlTextWriter(TextWriter stream) : base(stream)
    { }

    public override void WriteEndElement()
    {
        base.WriteFullEndElement();
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2012-09-24T14:57:36.287

刚刚在 PHP 5 的 XSL 中遇到了同样的问题，输出/@method=html。似乎分配一个空值属性会导致元素被输出为无效的非自闭合、非闭合标签：

```
<input type="text" name="foo" value="{my-empty-value}" /> 
```

结果是：

```
<input type="text" name="foo" value=""> 
```

一种可能的解决方案是有条件地添加属性：

```
<xsl:if test="string-length(my-empty-value) > 0">
    <xsl:attribute name="value">
        <xsl:value-of select="my-empty-value" />
    </xsl:attribute>
</xsl:if> 
```

导致：

```
<input type="text" name="foo" /> 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2014-07-02T15:05:55.927

每当我希望防止元素自动关闭时，我都会使用以下内容：

```
<xsl:value-of select="''" /> 
```

这会使渲染引擎误以为元素内部有内容，从而防止自闭。

这有点难看，所以我建议将它包含在描述性模板中，并每次都调用它：

```
<xsl:template name="PreventSelfClosure">
   <xsl:value-of select="''" />
</xsl:template>

<div class="test">
   <xsl:call-template name="PreventSelfClosure"/>
</div> 
```

这将呈现以下内容：

```
<div class="test"></div> 
```

[http://curtisimson.co.uk/post/xslt/how-to-prevent-self-closing-elements-in-xslt/](http://curtistimson.co.uk/post/xslt/how-to-prevent-self-closing-elements-in-xslt/)

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2020-03-02T23:47:08.430

不要在家里尝试这个：

```
<xsl:when test="self::* and not(text())">
    <xsl:value-of select="concat('&lt;', name(), '&gt;', '&lt;/', name(), '&gt;')" disable-output-escaping="yes"/>
</xsl:when> 
```

# .net - 如何从 TimeSpan 生成双精度值

> ID：887746
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-20T12:57:55.037
> 
>         
> 
> 标签：.net, double, timespan

我必须计算相对时间

```
TimeSpan relativeTime = currentTime.Subtract(startTime); 
```

接下来我想将 relativeTime 转换为应该由秒和毫秒（seconds.milliseconds）组成的双精度值。

有谁知道从时差中产生这种双重价值的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-20T13:02:15.277

`double seconds = (currentTime - startTime).TotalSeconds;`

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:02:19.130

诶，`TimeSpan.TotalSeconds`。或者，如果您明确想要尝试以毫秒为单位的粒度（不完全可能`double`），那么：

```
((long) relativeTime.TotalMilliseconds) / 1000.0 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:02:23.127

试试这个：

```
relativeTime.TotalSeconds 
```

这将返回整数和小数，作为双精度数。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:02:21.347

```
timeSpan.TotalSeconds 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:03:32.250

除非我错过了什么：

```
t.TotalSeconds; 
```

# c# - 如何从 DotNetOpenID AX 属性中提取数据？

> ID：887748
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T12:58:08.703
> 
>         
> 
> 标签：c#, .net, dotnetopenauth

Andrew Arnott 有一篇关于如何从 OpenId 提供者中提取属性交换扩展数据的帖子。这是代码片段：-

```
var fetch = openid.Response.GetExtension<FetchResponse>();   
if (fetch != null)
{   
    IList<string> emailAddresses = fetch.GetAttribute
                                   (WellKnownAttributes.Contact.Email).Values;   
    IList<string> fullNames = fetch.GetAttribute
                                   (WellKnownAttributes.Name.FullName).Values;   
    string email = emailAddresses.Count > 0 ? emailAddresses[0] : null;   
    string fullName = fullNames.Count > 0 ? fullNames[0] : null;   
} 
```

当我尝试执行以下操作时...

```
fetch.GetAttribute(...) 
```

我得到一个编译错误。基本上，那是不存在的。是这样做的唯一（阅读：正确）方法如下......

```
fetch.Attribue[WellKnownAttributes.Contact.Email].Values 
```

干杯:)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-21T03:25:58.640

恐怕我的博客文章是为 DotNetOpenId 2.x 编写的，但 DotNetOpenAuth 3.x 的 AX 扩展 API 略有不同，这就是您遇到的问题。

你来的很*接近*，但不是你应该拥有的。如果该属性未包含在提供者的响应中，您所拥有的将生成一个`NullReferenceException`或。`KeyNotFoundException`实际上，这也可能是我的博客文章中的一个错误，除非 DNOI 2.x 以不同的方式实现，我不记得了。

无论如何，这就是你应该做的事情来找出一个电子邮件地址：

```
if (fetch.Attributes.Contains(WellKnownAttributes.Contact.Email)) {
    IList<string> emailAddresses =
        fetch.Attributes[WellKnownAttributes.Contact.Email].Values;
    string email = emailAddresses.Count > 0 ? emailAddresses[0] : null;
    // do something with email
} 
```

如果仅提取电子邮件地址似乎很费力，请将其归结为 AX 扩展本身的复杂性和灵活性。对于那个很抱歉。

# asp.net-mvc - 使用 ModelState 验证表单

> ID：887757
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T13:01:22.550
> 
>         
> 
> 标签：asp.net-mvc

我正在尝试使用 ModelState 验证表单，通常与 asp.net/mvc 上的教程相同。但是我没有自己的数据库或它们的对象，并且想针对 Formcollection 进行验证。我不确定 ModelState 是如何工作的，所以也许我是在黑暗中拍摄，但这是崩溃的代码：

和 NullReferenceException 我在 TextBox 上得到：

System.NullReferenceException：对象引用未设置为对象的实例。在 System.Web.Mvc.HtmlHelper.GetModelStateValue(String key, Type destinationType) 在 System.Web.Mvc.Html.InputExtensions.InputHelper(HtmlHelper htmlHelper, InputType inputType, String name, Object value, Boolean useViewData, Boolean isChecked, Boolean setId , Boolean isExplicitValue, IDictionary `2 htmlAttributes) at System.Web.Mvc.Html.InputExtensions.TextBox(HtmlHelper htmlHelper, String name, Object value, IDictionary`2 htmlAttributes) at System.Web.Mvc.Html.InputExtensions.TextBox(HtmlHelper htmlHelper, String name, Object value) at ASP.views_authorized_account_aspx.__RenderContent1(HtmlTextWriter __w, Control parameterContainer) in c:\Users\Trimack \Documents\Visual Studio 2008\Projects\GuestManager\AccountManager\Views\Authorized\Account.aspx：第 61 行*

有任何想法吗？还是我完全错了？

特里马克

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T14:04:38.007

因此，对于您使用 ModelState.AddModelError() 添加的每个错误并再次调用 View，MVC 框架将尝试为它找到的每个错误找到一个 AttemptedValue。因为你没有添加它们，MVC 会抛出异常。

[http://forums.asp.net/p/1396019/3006051.aspx](http://forums.asp.net/p/1396019/3006051.aspx)

如果有错误，那么您还必须设置模型值以及模态错误

```
ModelState.AddModelError("Some_Key","显示一些错误信息");
ModelState.SetModelValue("Some_Key", ValueProvider["Some_Key"]);

```

# iphone - 实现在大型项目中到处使用的自己的功能的最简单方法是什么？

> ID：887765
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T13:02:33.047
> 
>         
> 
> 标签：iphone, objective-c, cocoa-touch

我想创建一组功能，让生活更轻松。我在大约 60% 的项目文件中使用它们。我想知道将这些包含在项目中的最有效方法是什么。

我考虑在他们进入的地方创建一个文件，并将这个文件包含在我需要它们的每个文件中。另一方面，如果我能在显眼的地方只包含一次，那就太酷了，这样在整个项目中都可以使用。但我不知道那可能是什么地方。我不确定，但我认为这是不可能的。还是我对这个假设有误？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T13:42:08.817

我认为您询问的更多是关于类设计以及如何构建 API，而不是如何将定义包含到其他 .m 文件中。

如果是这样的话，大致有三种选择：

*   向您的应用程序委托添加一些内容 - 这是存储控制整个模型或应用程序本身的系统范围功能的好地方。

*   创建一个signleton类来保存你的方法。一个实际的单例或一个只有类方法的类（即用前导`+`而不是 a声明`-`）

*   通过将类别添加到系统类。

我认为一般来说，您不想为所有实用程序方法做出单一决定 - 您应该根据具体情况采用每种方法（或方法组）并做正确的事情。例如，如果您有一个显示您自己的错误对话框样式的方法，您可以将它放在 AppDelegate 上。如果您有将字符串翻译成法语的方法，则可以将其添加为 NSString 类别。

一般来说，类别在这里是你的朋友——它们可以封装在一个单独的 .h 和 .m 中，这样它们很容易在项目中移动，而且它们的可访问性遵循目标类。

如果你不应该考虑实现一个单例。请参阅 Matt Gallager关于如何做到这一点的[讨论。](http://cocoawithlove.com/2008/11/singletons-appdelegates-and-top-level.html)

最后，如果这确实是正确的决定，请扩展您的 AppDelegate - 可能带有一个类别；-)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:21:53.337

您在 xcode 项目中拥有的 prefix.pch 文件用于添加您在项目的所有/几乎所有类中需要的所有导入语句。

UIKit 和 Foundation 导入都写在这个文件中。

因此，只需将您的导入语句添加到此文件中即可。您可以在 Groups & Files 的 Other Sources 文件夹中找到它

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:18:30.033

我认为您可以在 ProjectName_Prefix.pch 中包含您的标题。

# html - 排列文本字段

> ID：887769
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T13:03:07.507
> 
>         
> 
> 标签：html, ruby-on-rails, css

如何排列文本字段以使它们看起来更整洁？目前我有：

```
<div id="content">
    <h2>Change password</h2>
    <% form_tag({:action => "change_password"}, :method => "post") do %>
    <%= @error %>

    <div class="form_row">
        <label for="current_password">Current password:</label>
        <%= password_field_tag 'current_password', "", :size => 15 %>
    </div>

    <div class="form_row">
        <label for="new_password">New password:</label>
        <%= password_field_tag 'new_password', "", :size => 15 %>
    </div>

    <div class="form_row">
        <label for="repeat_new_password">Repeat new password:</label>
        <%= password_field_tag 'repeat_new_password', "", :size => 15 %>
    </div>

    <%= submit_tag "Set new password", :class => "submit" %>
    <% end %>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T13:04:01.030

您在标签元素中放置了一个宽度。

```
<form action="">
    <label style='float: left; display: block; width: 100px;'>Hello</label><input type="text" size="3"><br />
    <label style='float: left; display: block; width: 100px;'>Long World</label><input type="text" size="3"><br />
    <label style='float: left; display: block; width: 100px;'>How are you?</label><input type="text" size="3"><br />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:49:30.367

对于您的问题：为标签元素设置宽度。在单独的说明中，我会在外部样式表中进行样式设置，并使用以下语法作为表单，只是个人喜好问题。当然它有点冗长，但更容易为 imo 设置样式。

```
<div id="#content">
    <h2>Change Password</h2>
    <form>
        <dl>
            <dt>
                <label for="elm">Test:</label>
            </dt>
            <dd>
                <input type="text" id="elm" />
            </dd>
        </dl>
    </form>
</div> 
```

# c# - 使用存储库模式与实体框架一起使用的自动映射器？

> ID：887777
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-20T13:04:28.970
> 
>         
> 
> 标签：c#, entity-framework, repository-pattern

一直忙于创建一个新应用程序，基本上我有我的数据访问、服务层和表示层......一切都很好，但我正在使用 EF 返回的实体类。这里的问题是我将这些传递到表示层，所以我需要将实体框架引用 /dataccess 添加到表示层 - 不好：

所以我的想法如下，并且正在寻找一些帮助和确认我正在走正确的路线......

1.  在服务层中创建一组类，如客户、订单等，因为表示层有对服务层的引用。

2.  当在数据访问中返回客户实体时，我会将实体类（即客户）返回给服务，我会在这里进行映射 - 不太确定我是否喜欢这个？

3.  我用于映射的这些“标准类”的最佳位置在哪里，如果我将它们放在服务层并映射数据访问，那么这将创建一个循环引用作为数据访问>服务和服务>数据访问.. - 它应该只是一种方式，即服务 > 数据访问

我正在考虑使用 Automapper ( [http://www.codeplex.com/AutoMapper](http://www.codeplex.com/AutoMapper) ) 来解决这个问题，我在正确的路线上吗？？？任何想法或例子都非常感谢..

正如我所说，唯一的是当我从数据访问返回到服务层（使用 Iqueryable）时，我需要将这些从实体类中映射出来并使用标准集合类。

我认为这是我感到困惑的地方，我确实觉得使用实体类不好，因为这意味着我需要在我的表示层中引用实体框架/数据访问才能访问实体类..

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-24T17:06:09.267

您遇到了 EF v1 的弱点之一。现在，是的，使用 AutoMapper 的路线当然可以让您将 EF 实体转换为“直接”业务实体并在更高层中使用它们。

此外，.NET 4.0 / Visual Studio 2010 的 EF v4 应该会在许多问题领域带来很多缓解 - 支持您自己的直接 POCO（普通旧 CLR 对象）等等。查看[EF 设计博客](http://blogs.msdn.com/efdesign/)。该团队最近发布了许多关于 EF v4 的非常有趣、非常有前途的帖子。我对此很期待！

马克

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-12-12T16:41:54.727

1.  如果将 EF 对象的接口提取到核心/公共项目中并从存储库或服务返回 Web 项目使用的接口类型，则可以在 Web 项目中使用 EF 对象。您可以通过创建部分类并在此处添加来使 EF 对象实现您的接口：

    部分类客户：ICustomer

2.  即使您可以做到 1\. 技巧，您可能还是应该使用 automapper 将这些实体映射到适合您特定视图的自定义 ViewModel 对象。您还可以使存储库/服务的查询方法直接返回 DTO/ViewModels - 它有时可以使查询更高效（仅查询需要的列等），但这需要额外的 EF 映射。

# php - jQuery - 重新加载表

> ID：887778
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:04:43.043
> 
>         
> 
> 标签：php, jquery, dynamic, reload

我正在尝试重新加载一个也由 PHP 生成的表。

该表有一个 ID：`#bookmarks`

用户按下按钮后，表格应重新加载内容+他们刚刚添加的数据。我有点困惑，因为我不知道如何从 PHP 结果中发送所有数据。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T13:12:20.873

这是假设您的 PHP 为该表返回一个准备好注入的 HTML 代码：

```
$("#update_button").click(function(){
    $("#mytable").load("/tools/getTable.php")
}) 
```

在您的页面中，您需要一个像这样的 DIV 占位符：

```
<div id="mytable"></div> 
```

并且您的 getTable.php 需要像这样回显 html：

```
<table>
  <tr>
    <td>col1<td>
    <td>col2<td>
  <tr>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:09:32.377

点形式：

*   通过 AJAX 请求将用户数据提交回 PHP 页面。（查看 jQuery 表单插件）

*   PHP 页面应该接受并验证数据，将其插入数据库，然后以某种格式将响应发送回页面（我推荐使用 JSON，使用 php 函数[json_encode](http://php.net/json_encode)。

    *   响应应该是“拒绝”或“接受”，并将用户数据返回给他们，并根据您自己的系统要求进行清理。

*   然后在 AJAX 成功回调方法中，使用 jQuery 将数据追加到表中，或者给他们一条消息，告诉他们为什么它被拒绝。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:08:57.200

当用户按下按钮时，您应该调用用于加载表格的代码。数据可能是一开始的数据+用户添加的数据。或者可能会从服务器重新检索数据，具体取决于您的应用程序的工作方式。

更多信息可能会澄清问题，因此我们可以给出更具体的答案。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:12:51.967

那么表格是使用这个生成的：

```
<table id="bookmarks">
        <thead>
            <tr class="table-top">
                <th>Thumbnail</th>
                <th>Title/Description</th>
                <th>Tags</th>
                <th>Action</th>
            </tr>
        </thead>
        <?php
        $hID = userToID($_SESSION['username']);
        $hQuery = mysql_query("SELECT * FROM linkz WHERE userid='$hID'") or die(mysql_error());
        while($hRow = mysql_fetch_array($hQuery)) {
            echo "<tr class='link'><td><img src='http://www.thumbshots.de/cgi-bin/show.cgi?url=".$hRow["location"]."' /></td><td><a href='share/".$hRow['shareid']."'>".$hRow["title"]."</a> - <i>". $hRow["description"]."</i><br /><b>Share Link:</b> http://www.linkbase.us/share/".$hRow['shareid']."</td><td>".$hRow['tags']."</td><td><a href='#' id='".$hRow['shareid']."' class='delbutton'>Delete</a></td></tr>";
        }
    ?>
    </table> 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:19:50.937

有关使用 jQuery 的具体帮助，请查看[jEditable](http://www.appelsiini.net/projects/jeditable)插件，该插件旨在提供就地编辑数据的能力。还有关于如何收集和保存数据的说明。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:22:44.037

您需要先了解 AJAX 的基础知识。

在开始跑步之前，您需要学习如何走路。

搜索一些关于 Ajax、PHP 和 Ajax 的教程

[这里](http://www.sitepoint.com/article/ajax-jquery/)和[这里](http://viralpatel.net/blogs/2009/04/jquery-ajax-tutorial-example-ajax-jquery-development.html)有2个开始

# hibernate - 当持久性实例已设置但未更改时，hibernate 会更新数据库吗？

> ID：887781
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T13:05:34.180
> 
>         
> 
> 标签：hibernate

如果我有一个持久性对象的实例，并且像这样设置一些成员：

```
MyThing thing = session.get(MyThing.class, id);
thing.setSomething(thing.getSomething());
session.update(thing); 
```

这实际上会导致休眠发出 SQL 更新命令来刷新记录吗？或者休眠足够聪明，可以知道对象已更新，但值实际上并没有改变？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:25:17.260

一般来说，如果属性值比较相等，它不应该发出更新。（具体来说，根据它们的类型实现比较相等——这通常与它们的 equals(Object) 方法相同）。

nemo 是对的，您应该始终了解 SQL Hibernate 正在执行什么。虽然我建议将“org.hibernate.SQL”记录器（Hibernate 2 的“net.sf.hibernate.SQL”）设置为调试级别（在 log4j 中）而不是使用“show_sql”属性（它总是写入 System.out或 System.err iirc）。

（尽管我认为您的意思是`session.flush()`，不是`session.update(thing)`……除非您使用的是无状态会话？）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:12:38.440

我相信它会足够聪明地识别出对象没有被改变，从而避免更新。

确定的方法是打开 Hibernate 的 SQL 输出。添加

```
<property name="hibernate.show_sql">true</property> 
```

到 hibernate-configuration 的 session-factory 部分，在您的 hibernate.cfg.xml 中。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:16:46.450

AFAIK，它不会执行 SQL 命令。

# objective-c - 如何创建仅包含 Objective-c 中的函数的文件？

> ID：887782
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T13:05:38.953
> 
>         
> 
> 标签：objective-c, function

我想制作一个包含对我的项目有用的功能的文件。好吧，我知道我可以在我的类实现中定义一个函数。但我真的不明白......我的意思是：我不想创建一个“类”，只是函数。或者函数总是类的一部分？我的objective-c 知识非常有限，我关于objective-c 的好书确实提到了它们，但没有解释如何独立实现它们。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T13:10:12.703

以简单的旧 C 风格组织代码：

*   包含所有函数声明的头文件 (.h)。

*   包含所有函数体的主体文件 (.c)。

在您需要其中一项功能的地方包含您的头文件。

让 Xcode 管理编译和链接。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T13:16:39.400

因为 Objective-C 是 C 的超集，你可以用普通的 c 方式来做这件事，你在一个头文件中定义你的函数，你可以在任何你想使用它们的地方包含它，然后在 .c 文件中实现它们。

不过，我可能会将它们实现为类上的类方法，以便为它们命名空间，并防止任何意外冲突。

# c# - 与打印机交谈

> ID：887785
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-20T13:06:08.907
> 
>         
> 
> 标签：c#, printing

有没有办法编写一些可以与打印机“对话”的代码以获得有关其状态的一些基本信息？我真正感兴趣的是找出它是否已用完纸或卡纸——这种性质的事情。我应该为这类东西使用 System.Management 库吗？

PS - 知道如何获取已在特定 PC 上设置的所有打印机也很方便。你会怎么做呢？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-20T13:14:55.300

使用 System.Management 从打印机获取信息相对容易。

```
 //Declare WMI Variables
    ManagementObject MgmtObject;
    ManagementObjectCollection MgmtCollection;
    ManagementObjectSearcher MgmtSearcher;

    //Perform the search for printers and return the listing as a collection
    MgmtSearcher = new ManagementObjectSearcher("Select * from Win32_Printer");
    MgmtCollection = MgmtSearcher.Get();

    foreach (ManagementObject objWMI in MgmtCollection)
    {
       //Do whatever action you want with the Printer
    } 
```

查看[http://msdn.microsoft.com/en-us/library/aa394363.aspx](http://msdn.microsoft.com/en-us/library/aa394363.aspx)了解 Win32_Printer 的方法和属性。对于您的问题：

```
//Test whether a Win32_Printer is out of paper or jammed
int state = Int32.Parse(objWMI["PrinterState"]);
if (state == 4) {
   //Paper Jam
} else if (state == 5) {
   //Paper Out
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-21T04:22:53.827

您也可以使用[LINQ to WMI api](http://www.codeplex.com/linq2wmi)。

# sql - 使用返回超过 5 个结果的 TOP 5 访问 SQL？

> ID：887787
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-20T13:07:45.923
> 
>         
> 
> 标签：sql, ms-access, sorting

我正在使用以下语句

```
SELECT TOP 5 rootcause, COUNT(IIF(accountability="Team 1",1,0))
FROM  MOAQ
WHERE CDT=1
GROUP BY rootcause 
```

`MOAQ`是另一个查询，它从 4 个表中返回大约 20 个字段，没什么特别的。这按预期工作，我得到 5 个结果。

如果我`ORDER BY`在条件字段上添加一个子句，虽然我开始得到 8 个结果。如果我按第一个字段排序没有问题。

有谁知道可能会发生什么？

**编辑澄清**- 我现在只在 Access 2003 中进行测试，最终语句将通过 Excel 前端的 ADO 进行参数化查询。

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2009-05-20T13:20:02.030

这是 Access 中指令的一个已知效果`top`，但它不是很为人所知......

该`top`指令不会返回最重要的`n`项目，因为很容易让人相信。相反，它至少返回`n`由结果的排序确定的不同项目。

在大多数情况下，它是相同的，但在您的示例中，第 5 到第 8 项具有相同的排序值，所有这些都包括在内。它返回前五个项目，然后返回与第五个项目具有相同排序值的所有项目。

如果您不对表应用任何排序，则会考虑所有字段，因此如果结果中有唯一字段，则查询将始终返回五个项目。如果唯一字段包含在排序中，当然也是一样的。

SQL 的其他方言可能表现不同。例如，仅在 T-SQL (SQL Server) 中的`top`指令永远不会返回超过`n`项目。但是，通过指定子句`with ties`和`order by`with `top`，可以观察到与 Access 中相同的行为。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-07-09T10:05:32.820

转到 Access 2003 帮助名称中[关于 ANSI SQL 查询模式 (MDB)](http://office.microsoft.com/en-gb/access/HP030704831033.aspx)的页面，  然后展开“为什么使用 ANSI-92 SQL？” 主题，你会看到这个：

“使用 LIMIT TO nn ROWS 子句限制查询返回的行数”

所以只需将 Access UI 置于 ANSI-92 查询模式或在代码中使用 OLE DB（例如 ADO）并添加子句

```
LIMIT TO 5 ROWS 
```

到您的查询。

...

只是在开玩笑！这只是 Access 数据库引擎文档不足的另一个示例。我认为 Access 文档团队中的某个人做出了不太合理的假设，即 Access 数据库引擎的所谓 ANSI-92 查询模式将符合 ISO/ANSI SQL-92 标准。它不是。

Access 数据库引擎有自己的专有（即非 SQL-92 标准）语法 TOP n（不要与 SQL Server 自己专有的 TOP n 语法混淆，后者在语义上是不同的）。简而言之，它不能解决重复问题。如果条件满足表中的每一行，那么您将在结果集中获得表中的每一行。

解决方法是使用游标仅读取结果集中的前 n 行。因为 Access 数据库 SQL 不支持过程代码或显式游标，所以您需要在“客户端”端执行此操作，例如打开 Recordset 对象并将前 n 条记录读入伪造的 ADO 记录集中。

# c++ - 发送一系列UDP数据报的“正确”方式？

> ID：887797
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-20T13:09:59.863
> 
>         
> 
> 标签：c++, winapi, udp, messaging

我的印象是 UDP 的不稳定性是物理层的属性，但似乎不是：

我正在尝试通过 UDP 发送消息，该消息分为一系列数据包。消息识别和重新排序是隐式完成的。

我在同一台计算机上运行的两个应用程序上测试了这种方法，并希望它能够顺利运行。然而，即使数据传输完全是在同一台机器上的两个程序之间进行的，也存在丢包现象，而且非常频繁。损失似乎也很随机：有时整个信息都通过了，有时没有。

现在，即使在同一台机器上也会发生损失，这让我想知道我做得对吗？

最初，我是单次异步发送消息的所有片段，而不是等待一个片段完成后再发送下一个片段。

然后，我尝试从前一个消息的完成例程中发送下一个消息。这确实提高了丢包率，但并没有完全阻止它。

如果我在两个部分之间添加一个暂停 (Sleep(...))，它可以 100% 工作。

**编辑：**
正如答案所建议的那样：数据包发送得太快了，操作系统做了最小的缓冲。这是合乎逻辑的。

那么，如果我想阻止向系统添加确认和重新传输（我可以只使用 TCP），我应该怎么做？在不将数据速率降低到可能更高的水平的情况下，提高丢包率的最佳方法是什么？

**编辑2：**
我想到问题可能不完全是缓冲区溢出，而不是缓冲区不可用。我正在使用异步 WSARecvFrom 来接收，据我所知，它需要一个缓冲区，覆盖默认的操作系统缓冲区。当接收到数据报时，将其送入缓冲区，无论缓冲区是否已满，都会调用完成例程。

此时，根本没有缓冲区来处理传入的数据，直到从完成例程中重新调用 WSARecvFrom。

问题是是否有办法创建某种缓冲池，以便在处理不同的缓冲区时缓冲数据？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T13:13:27.517

在您的情况下，您只是将数据包发送得太快，以至于接收过程无法读取它们。O/S 在开始丢弃它们之前只会缓冲一定数量的接收到的数据包。

避免这种情况的最简单机制是让接收进程发回一个最小的 ACK 数据包，但让发送进程继续进行，无论它是否在几毫秒左右内没有收到 ACK。

编辑 - 从本质上讲，UDP 是“一劳永逸”。协议中没有像 TCP 那样内置反馈机制。调整传输速率的唯一方法是让远端告诉您它没有接收到整个流。另请参阅[RFC 2309](https://www.rfc-editor.org/rfc/rfc2309)。

* * *

回复：数据包序列 - 由于物理层，不会发生重新排序，通常是因为 IP 网络是“数据包交换”而不是“电路交换”。

这意味着每个数据包可能通过网络采用不同的路由，并且由于这些不同的路由可能具有不同的延迟，因此数据包可能会乱序到达。

在实践中，这些天很少有数据包因为物理层错误而丢失。数据包丢失是因为它们以高于该管道可以容纳的速率发送到有限的吞吐量管道。缓冲可以通过平滑数据包流率来帮助实现这一点，但如果缓冲区填满，您将回到原点。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:55:42.520

为了避免操作系统缓冲区的问题，您需要实现一个速率控制系统。它可以是闭环（接收方发回 ACK 和有关*其*缓冲区的信息）或开环（发送方减慢速度，这意味着您必须保守）。

有 UDP 的半标准协议来实现这两者。RBUDP（Reliable Blast UDP）浮现在脑海中，还有其他的。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:46:36.967

If you're using UDP, the only way to detect packet loss as far as I know is going to involve some sort of feedback. If you're on a network with fairly consistent throughput, you could do a training period where you send bursts of data and wait for the receiver to respond and tell you how many packets of from the burst it received (i.e. make the receiver count and after a timeout, respond with the number it got). Then you just step up the amount of data per burst until you hit the limit and drop back down a little just to be sure.

This would avoid acks after the initial evaluation period, but will only work if the load on the network / receiving process does not change.

I've written UDP clients in Python before and the only time I've found any significant packet loss was when the input buffer on the receiving process was too small. As a result, when the system was under heavy load, you'd get packet loss because the buffer would silently overfill.

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-21T05:27:39.523

如果将`WSA_FLAG_OVERLAPPED`标志传递给`WSASocket()`，则可以多次调用`WSARecvFrom()`以将多个接收 I/O 请求排队。这样，已经有另一个缓冲区可用于接收下一个数据包，甚至在您的完成例程对另一个 I/O 请求进行排队之前。

这并不一定意味着您不会丢弃数据包。如果您的程序没有足够快地提供足够的缓冲区，或者处理它们并重新排队它们需要太长时间，那么它将无法跟上，这时某种速率限制可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:43:58.703

You have to be doing something wrong. The only way you should be losing packets is 1) An unreliable network 2) You are sending data too fast to be handled by your receiving program. 3) You are sending messages that are bigger than the UDP max message size  4) Each device in your network has a max message size (MTU), so you might be exceeding a limit there.

In case #1, since you are sending on the same machine, the network is not even involved so it should be 100% reliable.  You didn't say you had 2 network cards so I don't think this is an issue.

In case #2, you usually have to send a heck of a lot of data before you start dropping data.  From your description, that does not sound like the case.

In case #3, make sure all your messages fall below this limit.

In case #4, I'm pretty certain if you meet the UDP max message size then you should be ok, but there very well could be some older hardware or custom device with a small MTU that your data is going through.  If that is the case then those packets will be silently dropped.

I have used UDP on many applications and it has proven very reliable.  Are you using MFC for receiving the messages?  If you are, then you need to read the documentation very carefully as they clearly state some issues that you need to be aware of, but most people just gloss over them.  I've had to fix quite a few of those gloss overs when people couldn't figure out why there messaging isn't working.

EDIT: You say that your packets are implicitly reordered.  I might begin by verifying that your implicit reordering is really working correctly. That seems like the most likely candidate for your problem.

EDIT#2: Have you tried using a network monitor.  Microsoft has (or at least used to) a free program called Network Monitor that will probably help.

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:19:43.603

我怀疑您机器的 IP 层传输速度不如您发送它们的速度快。

可能是因为协议允许丢弃数据包，而另一个目标 - 尽可能快地传输数据包 - 否则无法实现。

您的机器上的其他流量或 CPU 占用进程可能会解释不同的结果，您在测试期间是否使用 top (unix) 或 prcess explorer (nt) 进行了观察？

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2014-02-11T04:27:49.327

看起来操作系统缓冲无法跟上不太频繁的上下文切换，即低级别发送需要更频繁的上下文切换。检查是否有办法优化低级发送缓冲区大小。

# asp.net - 如何在其他页面上反映一个类的实例的变化

> ID：887799
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:10:22.157
> 
>         
> 
> 标签：asp.net

我有一个类。我需要在两个不同的页面上使用同一个类的相同实例，并将以前的值分配给该实例。？

那么如何维护一个实例的值 b/w 两页....

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:41:47.977

You have 3 choices:

**1) Add it to the HTTPContext items and do a Server.Transfer to the other pages.**
-great if you are doing some sort of a wizard
-does not work well with ajax at all

**2) Use a session variable**
- quick and dirty
- won't work well in a farm environment
- attachments sound large; could be hard on the system memory

**3) Store in a database of some sort and fetch on subsequent pages.**
- most complicated to develop
- users can come back later and still get their data
- statelessness is better maintained and works well on farms

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:12:53.760

将其存储在会话中：

```
// Store
Session["MyInstance"] = myObject;

// Read
MyObject myObject = (MyObject)Session["MyInstance"]; 
```

# .net - 跨不同数据库连接的多个 SQL 事务命令

> ID：887801
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-20T13:10:47.553
> 
>         
> 
> 标签：.net, sql, tsql, transactions, msdtc

我正在为我的应用程序使用 .NET 2.0/3.5 框架。我需要跨多个连接运行多个 SQL 命令，并且每个连接都在不同的服务器（Oracle、SQL Server）上。我需要确保这些命令是事务性的。

例如：我需要在 Oracle 和 SQL Server 数据库上的表中执行 INSERT，然后在没有引发异常的情况下提交它们。如果有异常，如果需要，我想在两台服务器上回滚。

我怀疑我需要使用 System.Transactions 和 TransactionScope。这将要求我在数据库服务器和应用程序服务器上设置 Microsoft 分布式事务协调器 (MSDTC)。

我看了高低，找不到任何描述逐步设置 MSDTC 和相互身份验证的文章（包括配置防火墙设置和 MSDTC 设置。）完全记录（除非你能找到我关于如何设置它的非常好的 MSDN 文章。）

使用 MSDTC 是完成工作的唯一方法吗？

如果是这样，我该如何正确配置它？

编辑：

*   我在所有机器上都使用 Windows Server 2003。

*   我有两个 SQL Server。一个是 SQL Server 2000，另一个是 2005。

*   我有一台 Oracle 服务器，它是 11g 版本

*   我们正在开发的应用程序有时必须以事务方式在所有三个数据库中更改/创建记录。

*   键盘和椅子之间不是问题。我们阅读了 MSDN 上有关如何设置有关 MSDTC 的所有内容的文章，但我们无法让 DTCPing 和其他测试应用程序正常工作。我们正在寻找详细说明该过程的分步文章。我不止一次遇到过 MSDN 文档，其中“省略”了执行某些操作的步骤。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-09-15T22:14:03.900

遗憾的是，两家供应商的官方文档似乎都乐于提及互操作提供商或其他，但似乎都不愿承认对方的数据库产品的存在。

您可能更喜欢需要有关[Oracle Services for Microsoft Transaction Server](http://www.oracle.com/technology/tech/windows/ora_mts/index.html)的文档。

*   甲骨文文档：

    *   [10克](http://download.oracle.com/docs/cd/B19306_01/win.102/b14320/toc.htm)

    *   [9i](http://www.oracle.com/technology/tech/windows/ora_mts/htdocs/oramtsfov9i.html) 

    *   旧版本存在，但在 8 之后似乎发生了很大变化

从 ODP.NET 10.2.0.3 开始，您应该（如果您已适当配置 MS DTC 并且存在 OraMTS dll）能够简单地使用 System.Transactions TransactionScope，就像在两个 sql server 数据库之间进行协调但使用一个 sql server 和 oracle 连接。可能需要 Oracle 10 及更高版本才能非常简单地开箱即用。

[这是从 .net 2.0 和 Sql Server 2005 开始使用 DTC 的指南](http://blogs.msdn.com/angelsb/archive/2004/07/06/174215.aspx)。它特别指出了操作系统的要求（这在很大程度上应该不再是一个问题，但值得注意）。此外，除非数据库和客户端都在同一台机器上，否则必须启用网络 DTC。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:57:53.173

我使用链接服务器来完成我的所有任务。它使我们更容易管理连接信息和凭据。基本上一站式购物满足我们的所有需求。

编辑：更多细节 - 我们有一个严格用于报告的数据库。我们从整个公司的服务器获取数据。我们没有一个帐户来访问这些服务器，其中一些我们使用功能 ID，其他我们的 AD 凭据。将所有这些连接打包到单独的链接服务器中对我们来说效果最好。在我们的报告服务器上，我们目前有 16 个链接服务器。

我们还将查询封装到视图中，以便更轻松地访问我们的应用程序和水晶报表。因此，我们不必在我们的代码中创建多个连接字符串，而是只使用一个全局字符串来连接到报告数据库。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-09-16T17:04:06.733

我的回答可能有点奇怪，但我会建议您（如果技术上可行）评估每个数据库使用 2 个独立事务。我对分布式事务/XA 的关注是整体数据库性能/可扩展性/延迟。

2个链接将试图证明我的观点：

1.  [Martin Fowler 指出：](http://martinfowler.com/bliki/Transactionless.html) “您必须注意提交的顺序，将更重要的提交放在最前面。在每次提交时，您必须检查它是否成功并决定如果失败该怎么办。”

2.  [关于 eBay 架构的采访](http://www.infoq.com/articles/ebay-scalability-best-practices)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T15:11:16.673

这是一个经典的分布式事务问题，也是 MSDTC 的用途。查找事务监视器和 XA 协议以更深入地描述此类问题。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-08-31T20:58:49.513

使用多个连接时，您将需要使用 DTC。单个连接可以管理单个事务，但如果您有多个连接，则需要一个事务协调器来处理两阶段提交协议。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2011-12-16T22:58:57.880

我有同样的问题。需要在 2 个 SQL 和 1 个 Oracle 数据库服务器之间进行分布式事务，所有这些都来自 ASP.Net 应用程序。

所以我把那次经历写在我的博客里，所以下次我不会再浪费时间了。

检查它：

[MS DTC 分布式事务：Oracle 10gR2、SQL Server 2005 和 Windows Server 2008 R2](http://jhonatantirado.wordpress.com/tag/oracle-services-for-microfost-transaction-server/)

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2009-09-18T10:39:48.373

是的，您需要创建一个事务范围，并且 SQL 和 Oracle 的 ADO.Net 提供程序会将每个连接注册到由 MSDTC 协调的单个分布式事务中。

关于如何设置 MSDTC 的 MSDN 文档非常详细，并专门涵盖了您提出的问题：[为 MS DTC 启用防火墙例外](http://technet.microsoft.com/en-us/library/cc725913%28WS.10%29.aspx)、[为分布式事务配置安全](http://technet.microsoft.com/en-us/library/cc772402%28WS.10%29.aspx)性。

您没有提及您的客户端正在运行的操作系统、SQL Server 版本、Oracle 版本、SQL Server(s) 和 Oracle(s) 的后端操作系统。您也忽略了告诉您遇到的任何*实际*问题或您看到的错误消息。现在，问题似乎位于键盘和椅子之间。

# c# - 如何使用 LINQPad 在关系中进行选择？

> ID：887802
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:11:15.853
> 
>         
> 
> 标签：c#, linq-to-sql, linqpad

我有一个简单的表结构

```
Images(image_id, image_library_id,...)

Links(link_id, image_id, link_component_code...) 
```

我正在尝试使用 LINQ 执行一个简单的查询

```
var q = from i in Images where i.Link.link_component_code = "x" select i; 
```

但是 LINQPad 中的智能感知不提供“链接”对象

```
where i.Link.link_component_code 
```

相反，我只得到一个“链接”对象，它是一个 EntitySet，并没有继续列出表字段，只是方法，如 Add、Select、Where 等

但是，如果我反过来做

```
var q = from l in Links where l.Image.image_library_id = 1234 select l; 
```

它按预期工作

这个 EntitySet 是什么，我哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:00:07.237

建立关系的方式，每个图像作为 0 个或多个链接（许多链接）。Image 的 Links 属性是相关链接记录的可查询集合。

试试这个 where 子句

```
where i.Links.Any(link => link.link_component_code == "x") 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T22:32:02.163

每张图片是否有多个链接？如果不是，请将 Links 表中的 image_id 字段限制为唯一。然后你应该得到你期望的结果。

# c# - ComboBox items.count 与 DataSource 不匹配

> ID：887803
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-05-20T13:11:39.720
> 
>         
> 
> 标签：c#, winforms, data-binding, combobox

我有一个绑定到数据源的组合框。我想根据某些条件向 ComboBox 动态添加项目。所以我所做的就是将选项添加到一个新列表中，然后像这样更改 ComboBox 的 DataSource：

```
cbo.DataSource = null;
cbo.DataSource = cbos;
cbo.DisplayMember = "Title";
cbo.ValueMember = "Value"; 
```

然后，我检查`cbo.Items.Count`，它没有增加 - 它不等于 DataSource 的计数。任何想法我可以在这里做什么？  

请注意，这是 WinForms 而不是 ASP.NET。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-05-20T13:14:39.357

您是立即还是稍后检查 Count？在进行诸如 UI 刷新之类的操作之前，ComboBox 可能不会真正更新其内容，因此在此之前计数将关闭。  

如果您在为组合框创建句柄之前更新数据源，则可能发生这种情况。我在反射器上挖掘了一些代码，在这种情况下，在实际创建和渲染 ComboBox 之前，项目似乎不会更新。  

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-11-10T15:27:26.030

如果有人在动态添加的组合框上遇到此问题，答案是确保将组合框添加到表单中容器的控件中。

通过添加“this.Controls.Add(cbo);” 在设置数据源之前到代码，问题就消失了。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T13:34:56.897

I've found the cause...

I took out the cbo.Datasource = null line.. and added a cbo.Invalidate() at the end. This has solved the problem. 

Thanks all for the advice.

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2011-07-21T14:58:31.770

```
cbo.DataSource = null; 
cbo.DataSource = cbos; 
cbo.DisplayMember = "Title"; 
cbo.ValueMember = "Value"; 
```

现在在设置之前`cbo.SelectedValue`，或者依靠`Items`是最新的，调用

```
cbo.CreateControl ; 
```

并将`Items`重新计算。

问题是`SelectedValue`/`SelectedIndex`是 WinForms 属性，仅接受`Items`列表中合法的值，但仅在 GUI 交互之后构建，即在实例化“真实”Windows GUI 组合框之后，即在获得 Windows 之后组合框的句柄。

`CreateControl`无论如何都会强制创建 Windows 句柄。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2019-08-23T09:36:53.590

```
By adding "this.Controls.Add(cbo);" to the code before setting the datasource, the problem goes away.   
 //Create dynamic combobox and add to Panel
    ComboBox ddCombo = new ComboBox();
    controls = new Control[1] { ddCombo };
    panel.Controls.AddRange(controls); 

    //After creating add to table layout
    tableLayoutPanel.Controls.Add(panel, 0, 0);

    ddCombo .Name = "ddName";
    ddCombo .Width = 200;
    ddCombo .Location = new Point(x, y);                                                                                                          ddCombo .DataSource = ds;//or any List
    ddCombo .SelectedIndex = ddCombo .Items.Count - 1; 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2017-02-14T07:06:00.947

```
 ComboBox cbNew = new ComboBox();
    cbNew.Name = "cbLine" + (i+1);
    cbNew.Size = cbLine1.Size;
    cbNew.Location = new Point(cbLine1.Location.X, cbLine1.Location.Y + 26*i);
    cbNew.Enabled = false;
    cbNew.DropDownStyle = ComboBoxStyle.DropDownList;
    cbNew.DataSource = DBLayer.GetTeams(lineName).Tables[0];
    cbNew.DisplayMember = "teamdesc";
    cbNew.ValueMember = "id";
    Console.WriteLine("ComboBox {0}, itemcount={1}", cbNew.Name, cbNew.Items.Count);
        // The output displays itemcount = 0 for run-time created controls
        // and >0 for controls created at design-time
    gbLines.Controls.Add(cbNew); 
```

至

```
 ComboBox cbNew = new ComboBox();
    cbNew.Name = "cbLine" + (i+1);
    cbNew.Size = cbLine1.Size;
    cbNew.Location = new Point(cbLine1.Location.X, cbLine1.Location.Y + 26*i);
    cbNew.Enabled = false;
    cbNew.DropDownStyle = ComboBoxStyle.DropDownList;
    Console.WriteLine("ComboBox {0}, itemcount={1}", cbNew.Name, cbNew.Items.Count);
        // The output displays itemcount = 0 for run-time created controls
        // and >0 for controls created at design-time
    gbLines.Controls.Add(cbNew);
    cbNew.DataSource = DBLayer.GetTeams(lineName).Tables[0];
    cbNew.DisplayMember = "teamdesc";
    cbNew.ValueMember = "id"; 
```

必须在将控件添加到其容器后设置 DataSource、DisplayMember 和 ValueMember 属性。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:48:05.763

This code produces 2 in the message box for me, can you try it and see how it behaves for you?

You can paste it into a console application, and add a reference to `System.Windows.Forms` and `System.Drawing`.

```
using System;
using System.Collections.Generic;
using System.Windows.Forms;
using System.Drawing;

namespace SO887803
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.Run(new MainForm());
        }
    }

    public partial class MainForm : Form
    {
        private Button _Button;
        private ComboBox _ComboBox;

        public MainForm()
        {
            _Button = new Button();
            _Button.Text = "Test";
            _Button.Location = new Point(8, 8);
            _Button.Click += _Button_Click;
            Controls.Add(_Button);

            _ComboBox = new ComboBox();
            _ComboBox.Location = new Point(8, 40);
            Controls.Add(_ComboBox);
        }

        private void _Button_Click(object sender, EventArgs e)
        {
            List<Item> items = new List<Item>();
            items.Add(new Item("A", "a"));
            items.Add(new Item("B", "b"));

            _ComboBox.DataSource = null;
            _ComboBox.DataSource = items;
            _ComboBox.DisplayMember = "Title";
            _ComboBox.ValueMember = "Value";
            MessageBox.Show("count: " + _ComboBox.Items.Count);
        }

        public class Item
        {
            public String Title { get; set; }
            public String Value { get; set; }
            public Item(String title, String value)
            {
                Title = title;
                Value = value;
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:29:14.240

只是为了澄清你在调用 databind() 方法之后调用 count() 方法

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-22T07:39:05.243

comboBox1.DataSource=一些列表；

int c1=comboBox1.DataSource.Count; // 仍然为零

BindingContext dummy = this.comboBox1.BindingContext;// 现在强制更新！

int c2=comboBox1.DataSource.Count; // 现在它等于 somelist.Count

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-08-12T14:54:19.303

我遇到了同样的问题（我正在使用 VS 2005）。

您需要做的是将 DataSource 设置为 null，清除项目，重新分配 datasource 、 display 和 value 成员。

例如

cbo.DataSource = null;

cbo.Items.Clear();

cbo.DataSource = cbos;

cbo.DisplayMember = "标题";

cbo.ValueMember = "价值";

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2018-12-13T09:01:34.057

试试这个代码。

```
cbo.BindingContext = new BindingContext();
cbo.DataSource = null;
cbo.DataSource = cbos;
cbo.DisplayMember = "Title";
cbo.ValueMember = "Value"; 
```

也许您的 ComboBox 的 BindingContext 为空。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2016-10-10T22:35:11.660

旧线程，但我尝试了其中一些解决方案，以及暂停/恢复绑定上下文、绑定和重置绑定源，以及只是简单地重新加载表单。在我的 .datasource 设置时，没有人用新绑定的数据更新我的控件（我的 items.count 是空的，就像 OP 一样）。

然后我意识到我的组合框位于一个标签页上，该标签页在代码开始时被删除，后来又被重新添加（在我的数据绑定之后）。在重新添加标签页*之前*，不会发生绑定事件。

回想起来似乎很明显，但在运行时很难检测到，因为调用的顺序和无法看到事情何时发生变化。

* * *

## 回答 #13

> 赞同：-1
> 
>             
> 
> 时间：2009-07-01T07:32:41.983

巴萨拉姆，

您可以通过 preformLayout() 函数简单地刷新 UI；

例子：

组合框1.performLayout();

问候莫森

* * *

## 回答 #14

> 赞同：-1
> 
>             
> 
> 时间：2009-07-25T13:29:59.070

请试试这个：

```
cbo.Parent = <your panel control>;
cbo.DataSource = null; 
cbo.DataSource = cbos; cbo.DisplayMember = "Title"; 
cbo.ValueMember = "Value";
MessageBox.Show(string.Format("itemcount is {0}", cbo.Items.Count); 
```

我想你的问题和我今天遇到的一样。

# apache-flex - Flex - 更改浏览器

> ID：887805
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-20T13:11:57.537
> 
>         
> 
> 标签：apache-flex, browser

当我运行我的项目时，如何更改 Flex 使用的浏览器？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-20T13:15:23.270

它位于 Flex Builder > 首选项 > 常规 > Web 浏览器下

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:59:39.827

或者，如果您使用的是 Eclipse，它是 Window > Preferences > General > Web Browser

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-02-22T14:31:38.797

我从我的 Windows 7 机器上卸载了 Internet Explorer，并将 Google Chrome 设置为默认浏览器。Adobe Flex 3 表现出以下行为：

使用内部 Web 浏览器 -> Flex 尝试启动 iexplore.exe，但失败。

使用外部 Web 浏览器，默认系统 Web 浏览器 -> Flex 尝试启动 iexplore.exe，但失败。（注意默认浏览器是Chrome）

使用外部 Web 浏览器、Chrome（手动添加）-> Flex 正确启动 Chrome。

因此，如果有人遇到同样的问题，只需手动添加 Chrome。它位于`C:\Users\(user)\AppData\Local\Google\Chrome\Application\chrome.exe`。

# debugging - 如何解决此事件日志问题？

> ID：887819
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:15:33.660
> 
>         
> 
> 标签：debugging, event-log

我在我的事件日志中不断收到“svcListener”和“svcListener - Prof”的以下事件日志描述。有谁知道这是从哪里来的以及我该如何解决这个问题？

svc监听器

> 找不到 Source (svcListener) 中事件 ID (0) 的描述。本地计算机可能没有必要的注册表信息或消息 DLL 文件来显示来自远程计算机的消息。您可以使用 /AUXSOURCE= 标志来检索此描述；有关详细信息，请参阅帮助和支持。以下信息是事件的一部分：无法对已关闭的数据集执行此操作。

svcListener - 教授

> 找不到 Source (svcListener-Prof) 中事件 ID (0) 的描述。本地计算机可能没有必要的注册表信息或消息 DLL 文件来显示来自远程计算机的消息。您可以使用 /AUXSOURCE= 标志来检索此描述；有关详细信息，请参阅帮助和支持。以下信息是事件的一部分：Oracle 连接中的异常 - 12560 EOracleEr

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T17:31:18.870

看起来 svcListener 和 svcListener-Prof 正在尝试使用不存在的事件源写入事件日志。（或者他们没有创建它的权限）

在代码中，您将在写入事件日志之前执行以下操作：

```
if(!EventLog.SourceExists("myService")){EventLog.CreateEventSource("myService","Application");} 
```

并且您将确保“svcListener”第一次运行时，它具有创建事件源所需的权限。

To fix it, you can create the source yourself. Just write a short program to do it, like the above, and run it just once from an Admin account. 

# sql - SQL Server 服务器查询 - 计算不同的 DateTime 字段

> ID：887822
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-20T13:16:18.167
> 
>         
> 
> 标签：sql, sql-server, distinct

假设我们在 SQL Server 表中有以下记录。

```
Date
19/5/2009 12:00:00 pm
19/5/2009 12:15:22 pm
20/5/2009 11:38:00 am 
```

获得类似的东西的 SQL 语法是什么？

*日期* **计数**

*2009年 19 月 5 日* **2** 

*2009年 5 月 20 日* **1**  

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-05-20T13:19:37.380

您需要对日期字段的仅日期版本进行任何分组，例如这个。

```
SELECT
    CONVERT(VARCHAR(10), YourDateColumn, 101),
    COUNT(*)
FROM
    YourTable
GROUP BY
    CONVERT(VARCHAR(10), YourDateColumn, 101) 
```

不过我通常会这样做，因为它避免了转换为 varchar。

```
SELECT
    DATEPART(yy, YourDateColumn),
    DATEPART(mm, YourDateColumn),
    DATEPART(dd, YourDateColumn),
    COUNT(*)
FROM
    YourTable
GROUP BY
    DATEPART(yy, YourDateColumn),
    DATEPART(mm, YourDateColumn),
    DATEPART(dd, YourDateColumn) 
```

编辑：另一种获取日期时间的日期部分的方法

```
DATEADD(d, 0, DATEDIFF(d, 0, YourDateColumn)) 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:19:41.263

这将取决于您的数据库引擎。对于 SQL Server 2008（和未来版本），您可以使用该`date`类型来执行此操作。

```
select
    convert(date, date_column_name) as Date,
    count(1) as Count

from table_name

group by convert(date, date_column_name) 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:20:38.643

取决于您的[DBMS](http://en.wikipedia.org/wiki/DBMS)。Mysql 示例：

```
SELECT DATE_FORMAT(dateColumn, '%e/%c/%Y') as `date`, COUNT(*)
FROM YourTable
GROUP BY `date` 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:26:00.957

你在用什么 RDBMS？使用 Sybase，您的查询将如下所示：

```
select date(datetimeColumn) as myDate, count(*) as myTotal
from thisTable
Group by myDate
Order by myTotal, myDate 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T20:50:30.717

在谷歌搜索后也找到了这个......

选择 CAST(FLOOR(CAST(Expr1 AS FLOAT)) AS DATEtime) AS Expr1,

COUNT(*) AS Expr2

来自 MY_TABLE

通过...分组

CAST(FLOOR(CAST(Expr1 AS FLOAT)) 作为日期时间)

缺点？

1.  高速执行

2.  返回的结果采用原始语言环境。前希腊语 19/5/2009

谢谢你们

# api - 将 2 个 MS Word 文档与 Java 和 OpenOffice API 进行比较和合并？

> ID：887824
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T13:16:36.403
> 
>         
> 
> 标签：api, merge, ms-word, compare, openoffice.org

如何将 2 个 MS Word 文档与 Java 和[OpenOffice API](http://en.wikipedia.org/wiki/Universal_Network_Objects)进行比较和合并？

我只是想确认是否可以将 2 个 MS Word 文档与 OpenOffice API 进行比较。

# .net - 在调试时我应该采取什么下一步来修复 MissingMethodException？

> ID：887829
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T13:17:23.173
> 
>         
> 
> 标签：.net, missingmethodexception

我正在从另一个程序集中的 C# 代码调用一个程序集中的一些 VB.NET 代码。代码构建得很好，但是`MissingMethodException`当我打电话时我得到了。

通常，根据`MethodMissingException`我读过的 Stack Overflow 和 Google 搜索结果，这是由于您正在构建的 DLL 与您正在运行的 DLL 之间的不匹配。没有一个结果提到第三个 DLL。更多关于下面的内容。

我已经确认：

*   调试时根据 VS2008 输出窗口，目标 DLL 的路径与引用的路径匹配

*   根据 ProcExp，这是系统上加载的目标 DLL 的唯一版本

*   根据代码存在“缺失”方法

*   根据生成的 XML 文档存在“缺失”方法

*   根据反射器存在“缺失”方法

最强的领先优势是重复加载包含“缺失”方法签名中使用的类型的程序集。它来自`SecondParty`（我参考）和`FirstParty`（复制本地设置）。

手动将所有内容复制到新目录可以解决问题。但是，这使得调试变得棘手：我喜欢直接点击绿色三角形。

细节：

我有一个带有强类型 ADO.NET 数据集的第三个程序集。我们称之为类型`ThirdParty.PortableData`。我`FirstParty`正在用数据填充它并将其传递给`SecondParty`.

失败的调用代码`FirstParty`如下所示：

```
ThirdParty.PortableData data = GetPortableData()
SecondParty instance = new SecondParty()
instance.Data = data 
```

（`MissingMethodException`从调用包含此代码的方法的行中抛出。）

`SecondParty`在运行时似乎`FirstParty`无法找到的目标代码如下所示：

```
Public Property Data() As ThirdParty.PortableData
    Get
        ' ...
    End Get

    Set(ByVal value As ThirdParty.PortableData)
        ' ...
    End Set
End Property 
```

我也尝试过，调用代码略有不同：

```
Public Sub SetData(ByVal value as ThirdParty.PortableData) 
    ' ...
End Sub 
```

根据`ThirdParty`VS2008 和 ProcExp，DLL 从多个位置加载——一次从参考路径加载，一次从构建目录加载。DLL 的 MD5 摘要匹配。

如果我将所有内容复制到一个新目录中，确保只有一个`ThirdParty`DLL 副本，则程序可以正常工作。

`ThirdParty`关闭“复制本地”的所有引用。然而，一个副本正坐在`FirstParty\bin\Debug`.

我还应该检查什么？`MissingMethodException`除了复制构建产品的构建后脚本之外，我如何在调试期间进行预防？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2014-10-03T07:20:54.000

我在使用`gacutil /i`. 在调试时，Visual Studio 没有使用本地副本，而是使用了来自 GAC 的副本（版本号相同但方法声明不同），导致缺少方法异常。

我的解决方案是使用 GAC 列出所有程序集`gacutil /l >myassemblies.txt`，然后使用`gacutil /u`.

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-22T00:14:06.883

您需要的工具是[Fusion Log Viewer](http://blogs.msdn.com/suzcook/archive/2003/05/29/57120.aspx)。它将告诉您 CLR 在尝试找到要加载的正确程序集时所采取的确切步骤。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T19:29:26.230

将所有文件复制到新的干净机器上。散列所有这些文件以确保每个 dll 都有唯一的值，不要相信版本号。看看问题是否存在。我的猜测是您的问题将在干净的机器上得到解决。  

如果它有效，则返回您的计算机并为每个 DLL 进行全局搜索并在其上运行哈希并确保它与您期望的完全相同的文件。  

我经常发生这种情况，人们对他们的版本号（1.0.0.0）进行硬编码，然后在他们的机器上拥有 5 个不同的 DLL 副本（本地目录、共享文件夹、GAC 等）

# c# - 转换函数
[] 进入函数
?

> ID：887830
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T13:17:25.387
> 
>         
> 
> 标签：c#, .net, linq, generics

考虑这个类：

```
public class Column<T>
{
    public string Header { get; set; }
    public Func<T, string> ValueExpression { get; set; }
} 
```

像这样使用：

```
var columns = new List<Column<Employee>>
              {
                  new Column<Employee> {Header = "Employee Id", ValueExpression = e => e.EmployeeID.ToString()},
                  new Column<Employee> {Header = "Name", ValueExpression = e => e.FirstName + " " + e.LastName},
                  new Column<Employee> {Header = "Employee Birthday Year", ValueExpression = e => e.BirthDate.HasValue ? e.BirthDate.Value.Year.ToString() : ""},
                  new Column<Employee> { Header = "test", ValueExpression = e => e.Address}
              } 
```

我想在 IQueryable 上执行 .Select() 以使其仅从数据库中检索所需的字段。

所以我想做这样的事情：

```
var expressions = columns.Select(c => c.ValueExpression).Combine();
IQueryable<Employee> employees = EmployeeRepository.GetEmployees();
employees = employees.Select(expressions); 
```

只有“Combine()”显然不存在.. :-)

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T13:21:53.990

```
public static Func<T, U[]> Combine<T, U>(this Func<T, U>[] functions) {
    return t => functions.Select(fun => fun(t)).ToArray();
} 
```

我会声明为泛型`IEnumerable<Func<T, U>>`而不是数组：

```
public static Func<T, IEnumerable<U>> Combine<T, U>(this IEnumerable<Func<T, U>> functions)
{
    return t => functions.Select(fun => fun(t));
} 
```

正如评论中提到的，这不太可能直接与 LINQ to SQL 一起使用。但是，您可以通过执行 a 来获取 LINQ to SQL 结果`.AsEnumerable()`并在客户端处理其余部分。

# c# - “Using”语句如何从 C# 转换为 VB？

> ID：887831
> 
>         
> 
> 赞同：53
> 
>         
> 
> 时间：2009-05-20T13:17:29.163
> 
>         
> 
> 标签：c#, .net, vb.net, visual-studio-2005, .net-2.0

例如：

```
BitmapImage bitmap = new BitmapImage();

byte[] buffer = GetHugeByteArray(); // from some external source
using (MemoryStream stream = new MemoryStream(buffer, false))
{
    bitmap.BeginInit();
    bitmap.CacheOption = BitmapCacheOption.OnLoad;
    bitmap.StreamSource = stream;
    bitmap.EndInit();
    bitmap.Freeze();
} 
```

你能告诉我更多`using`吗？

**编辑：**

正如 JaredPar 帖子的评论中所讨论的，这个问题更关注`Using`VS2003 中的实现。有人指出，`Using`直到 .NET 2.0 (VS2005) 才引入。JaredPar 发布了一个等效的解决方法。

* * *

## 回答 #1

> 赞同：71
> 
>             
> 
> 时间：2009-05-20T13:20:03.823

Using 在 VB 中的语法与 C# 几乎相同，假设您使用的是 .NET 2.0 或更高版本（这意味着 VB.NET v8 编译器或更高版本）。基本上，只需删除大括号并添加“结束使用”

```
Dim bitmap as New BitmapImage()
Dim buffer As Byte() = GetHugeByteArrayFromExternalSource()
Using stream As New MemoryStream(buffer, false)
    bitmap.BeginInit()
    bitmap.CacheOption = BitmapCacheOption.OnLoad
    bitmap.StreamSource = stream
    bitmap.EndInit()
    bitmap.Freeze()
End Using 
```

你可以在这里获得完整的文档

*   [http://msdn.microsoft.com/en-us/library/htd05whh(VS.80).aspx](http://msdn.microsoft.com/en-us/library/htd05whh(VS.80).aspx)

**编辑**

如果您使用的是 VS2003 或更早版本，您将需要以下代码。using 语句直到 VS 2005，.NET 2.0（[参考](http://en.wikipedia.org/wiki/Visual_Basic_2005#Visual_Basic_2005_.28VB_8.0.29)）才引入。谢谢克里斯！以下等价于 using 语句。

```
Dim bitmap as New BitmapImage()
Dim buffer As Byte() = GetHugeByteArrayFromExternalSource()
Dim stream As New MemoryStream(buffer, false)
Try
    bitmap.BeginInit()
    bitmap.CacheOption = BitmapCacheOption.OnLoad
    bitmap.StreamSource = stream
    bitmap.EndInit()
    bitmap.Freeze()
Finally
    DirectCast(stream, IDisposable).Dispose()
End Try 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T13:46:17.840

需要指出的是 using 实际上是编译成多行代码，类似于 lock 等。

来自 C# 语言规范.... 形式的 using 语句

```
using (ResourceType resource = expression) statement 
```

对应于两种可能的扩展之一。当`ResourceType`是一个值类型时，展开是

```
{
    ResourceType resource = expression;
    try {
        statement;
    }
    finally {
        ((IDisposable)resource).Dispose();
    }
} 
```

否则，当 ResourceType 为引用类型时，扩展为

```
{
    ResourceType resource = expression;
    try {
        statement;
    }
    finally {
        if (resource != null) ((IDisposable)resource).Dispose();
    }
} 
```

（结束语言规范片段）

基本上，在编译时它转换为该代码。没有称为 using 等的方法。我试图在 vb.net 语言规范中找到类似的东西，但我找不到任何东西，大概它做了完全相同的事情。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:22:28.483

那将是这样的：

```
Dim bitmap As New BitmapImage()
Dim buffer As Byte() = GetHugeByteArray()
Using stream As New MemoryStream(buffer, False)
    bitmap.BeginInit()
    bitmap.CacheOption = BitmapCacheOption.OnLoad
    bitmap.StreamSource = stream
    bitmap.EndInit()
    bitmap.Freeze()
End Using 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:25:09.647

关键点是被“使用”的类必须实现 IDisposable 接口。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2013-10-14T18:26:03.397

似乎`using`（C#）和`Using`（VB）有一个非常重要的区别。而且至少对我现在来说，它可以打败`Using`.

```
Imports System.IO
Class Program

    Private Shared sw As StreamWriter

    Private Shared Sub DoSmth()
        sw.WriteLine("foo")
    End Sub

    Shared Sub Main(ByVal args As String())
        Using sw = New StreamWriter("C:\Temp\data.txt")
            DoSmth()
        End Using
    End Sub
End Class 
```

你会得到 NullReferenceException，因为在 VB 中`Using`重新定义了成员类变量，而在 C# 中却没有！

当然，也许我错过了什么..

# hadoop - 如何控制 Hadoop 流作业的输出文件名称和内容？

> ID：887835
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-20T13:18:43.170
> 
>         
> 
> 标签：hadoop, mapreduce, distributed-computing

有没有办法控制 Hadoop Streaming 作业的输出文件名？具体来说，我希望我的工作的输出文件内容和名称由减速器输出的 ket 组织 - 每个文件只包含一个键的值，它的名称就是键。

更新：刚刚找到答案 - 使用从 MultipleOutputFormat 派生的 Java 类作为作业输出格式允许控制输出文件名。
[http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/lib/MultipleOutputFormat.html](http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/lib/MultipleOutputFormat.html)

我还没有看到任何示例...任何人都可以指出使用自定义输出格式 Java 类的 Hadoop Streaming 示例吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-08-05T02:29:56.703

使用派生自 MultipleOutputFormat 的 Java 类作为作业输出格式可以控制输出文件名。[http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/lib/MultipleOutputFormat.html](http://hadoop.apache.org/core/docs/current/api/org/apache/hadoop/mapred/lib/MultipleOutputFormat.html) 

使用 Hadoop Streaming 时，由于只支持一个 JAR，因此您实际上必须派生流 jar 并将新的输出格式类放入其中，以便流作业能够引用它...

***编辑：***
从 hadoop 0.20.2 版开始，该类已被弃用，您现在应该使用：
 [http ://hadoop.apache.org/docs/mapreduce/current/api/org/apache/hadoop/mapreduce/lib/output /MultipleOutputs.html](http://hadoop.apache.org/docs/mapreduce/current/api/org/apache/hadoop/mapreduce/lib/output/MultipleOutputs.html)

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-05-24T16:39:57.710

通常，Hadoop 会让您将整个目录视为输出，而不是单个文件。无论是使用 Streaming 还是常规 Java 作业，都无法直接控制文件名。

但是，在工作完成后，没有什么能阻止您进行这种拆分和重命名。您可以 $HADOOP dfs -cat path/to/your/output/directory/part-*，并将其通过管道传输到您的脚本，该脚本通过键拆分内容并将其写入新文件。

# c - 如何根据C中的变量整数访问“结构”的成员？

> ID：887852
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-05-20T13:20:40.467
> 
>         
> 
> 标签：c, data-structures, struct

假设我有这个`struct`（顺便包含位字段，但你不应该关心）：

```
struct Element {
    unsigned int a1 : 1;
    unsigned int a2 : 1;
    ...
    unsigned int an : 1;
}; 
```

我想以一种方便的方式访问*第 i*个成员。让我们检查一个检索解决方案。

我想出了这个功能：  

```
int getval(struct Element *ep, int n)
{
    int val;
    switch(n) { 
         case 1: val = ep->a1; break;
         case 2: val = ep->a2; break;
         ...
         case n: val = ep->an; break;
    }
    return val;
} 
```

但我怀疑有一个更简单的解决方案。可能是数组访问样式之类的东西。

我试图做这样的事情：  

```
 #define getval(s,n)   s.a##n 
```

但预计它不起作用。

有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-05-20T13:24:52.020

除非您对结构的底层结构有特定的了解，否则无法在 C 中实现这样的方法。有各种各样的问题会妨碍您，包括

*   不同大小的成员

*   包装问题

*   对齐问题

*   位域之类的技巧将是有问题的

您最好为您的结构手动实现一个方法，该方法对结构的内部成员有深​​入的了解。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-05-20T13:34:42.250

如果你的结构中的每个字段都是一个`int`，那么你基本上应该可以说

```
int getval(struct Element *ep, int n)
{
    return *(((int*)ep) + n);
} 
```

如果整数，这会将指向您的结构的指针转换为指向数组的指针，然后访问该数组的第 n 个元素。由于结构中的所有内容似乎都是整数，因此这是完全有效的。请注意，如果您有一个非 int 成员，这将非常失败。

一个更通用的解决方案是维护一个字段偏移数组：

```
int offsets[3];
void initOffsets()
{
    struct Element e;
    offsets[0] = (int)&e.x - (int)&e;
    offsets[1] = (int)&e.y - (int)&e;
    offsets[2] = (int)&e.z - (int)&e;
}

int getval(struct Element *ep, int n)
{
    return *((int*)((int)ep+offsets[n]));
} 
```

从某种意义上说，这将起作用`getval`，即使您的结构中有其他非 int 字段，您也可以调用结构的任何 int 字段，因为偏移量都是正确的。但是，如果您尝试调用`getval`其中一个非 int 字段，它将返回一个完全错误的值。

当然，您可以为每种数据类型编写不同的函数，例如

```
double getDoubleVal(struct Element *ep, int n)
{
    return *((double*)((int)ep+offsets[n]));
} 
```

然后只需为您想要的任何数据类型调用适当的函数。顺便说一句，如果您使用的是 C++，您可以这样说

```
template<typename T>
T getval(struct Element *ep, int n)
{
    return *((T*)((int)ep+offsets[n]));
} 
```

然后它将适用于您想要的任何数据类型。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-05-20T13:45:30.760

如果你的结构是位域以外的任何东西，你可以只使用数组访问，如果我没记错的话，C 保证结构的一系列成员都具有相同的类型，具有与数组相同的布局。如果您知道编译器将位域以何种顺序存储到整数类型中，那么您可以使用移位/掩码操作，但这取决于实现。

如果您想通过变量索引访问位，那么最好用包含标志位的整数替换您的位域。通过变量访问真的不是位域的用途：a1 ... an 基本上是独立的成员，而不是位数组。

你可以这样做：

```
struct Element {
    unsigned int a1 : 1;
    unsigned int a2 : 1;
    ...
    unsigned int an : 1;
};

typedef unsigned int (*get_fn)(const struct Element*);

#define DEFINE_GETTER(ARG) \
    unsigned int getter_##ARG (const struct Element *ep) { \
        return ep-> a##ARG ; \
    }

DEFINE_GETTER(1);
DEFINE_GETTER(2);
...
DEFINE_GETTER(N);

get_fn jump_table[n] = { getter_1, getter_2, ... getter_n};

int getval(struct Element *ep, int n) {
    return jump_table[n-1](ep);
} 
```

并且可以通过多次包含相同标题的技巧来避免某些重复，每次都以不同的方式定义宏。标题为每个 1 ... N 扩展一次该宏。

但我不相信这是值得的。

它确实处理了 JaredPar 的观点，即如果您的结构混合了不同的类型，您就会遇到麻烦 - 这里通过特定跳转表访问的所有成员当然必须是相同类型，但它们之间可能有任何旧垃圾。尽管如此，这仍然留下了 JaredPar 的其余观点，而且与 switch 相比，这是很多代码膨胀，实际上没有任何好处。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:25:04.903

不，没有简单的方法可以更轻松地做到这一点。特别是对于难以通过指针间接访问的位域（您不能获取位域的地址）。

您当然可以将该功能简化为如下所示：

```
int getval(const struct Element *ep, int n)
{
    switch(n)
    {
      case 1: return ep->a1;
      case 2: return ep->a2;
      /* And so on ... */
    }
    return -1; /* Indicates illegal field index. */
} 
```

很明显，如何通过使用扩展至`case`-line 的预处理器宏来进一步简化实现，但这只是[sugar](http://en.wikipedia.org/wiki/Syntactic_sugar)。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:37:13.803

如果结构真的像描述的那样简单，您可以使用带有数组的联合（或强制转换为数组）和一些位访问魔术（如[如何在 C 中设置、清除和切换单个位？](https://stackoverflow.com/questions/47981/how-do-you-set-clear-and-toggle-a-single-bit-in-c)） .

正如 Jared 所说，一般情况下是*困难*的。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:38:12.740

为什么不构建`getval()`到结构中？  

```
struct Whang {
    int a1;
    int a2;
    int getIth(int i) {
        int rval;
        switch (i) {
            case 1: rval = a1; break;
            case 2: rval = a2; break;
            default : rval = -1; break;
        }
        return rval;
    }
};    

int _tmain(int argc, _TCHAR* argv[])  
{  
        Whang w;  
    w.a1 = 1;  
    w.a2 = 200;

    int r = w.getIth(1);

    r = w.getIth(2);

    return 0;
} 
```

`getIth()`将了解 的内部结构`Whang`，并且可以处理其中包含的任何内容。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:50:15.353

我认为你真正的解决方案是不在你的结构中使用位域，而是定义一个集合类型或一个位数组。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:08:06.457

我建议代码生成。如果您的结构不包含大量字段，您可以为每个字段或一系列字段自动生成例程，并像这样使用它们：

```
val = getfield_aN( myobject, n ); 
```

或者

```
val = getfield_foo( myobject ); 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:31:02.713

如果您想使用两个元素索引访问您的结构：

```
int getval(struct Element *ep, int n) 
```

并按名称：

```
ep->a1 
```

那么你就会陷入一些难以维护的开关之类的方法，每个人都建议过。

但是，如果您只想按索引而不是按名称访问，那么您可以更有创意。

首先，定义一个字段类型：

```
typedef struct _FieldType
{
    int size_in_bits;
} FieldType; 
```

然后创建一个结构定义：

```
FieldType structure_def [] = { {1}, {1}, {1}, {4}, {1}, {0} }; 
```

上面定义了一个具有大小为 1、1、1、4 和 1 位的五个元素的结构。最后的 {0} 标志着定义的结束。

现在创建一个元素类型：

```
typedef struct _Element
{
    FieldType *fields;
} Element; 
```

创建一个实例`Element`：

```
Element *CreateElement (FieldType *field_defs)
{
  /* calculate number of bits defined by field_defs */
  int size = ?;
  /* allocate memory */
  Element *element = malloc (sizeof (Element) + (size + 7) / 8); /* replace 7 and 8 with bits per char */
  element->fields = field_defs;
  return element;
} 
```

然后访问一个元素：

```
int GetValue (Element *element, int field)
{
   /* get number of bits in fields 0..(field - 1) */
   int bit_offset = ?;
   /* get char offset */
   int byte_offset = sizeof (Element) + bit_offset / 8;
   /* get pointer to byte containing start of data */
   char *ptr = ((char *) element) + byte_offset;
   /* extract bits of interest */
   int value = ?;
   return value;
} 
```

设置值与获取值类似，只是最后一部分需要更改。

`FieldType`您可以通过扩展结构以包含有关存储值类型的信息来增强上述功能：char、int、float 等，然后为每种类型编写访问器，根​​据定义的类型检查所需的类型。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:32:28.950

如果你有

1.  只有位域，或结构体中的所有位域

2.  少于 32（或 64）个位域

那么这个解决方案适合你。

```
#include <stdio.h>
#include <stdint.h>

struct Element {
  unsigned int a1 : 1;
  unsigned int a2 : 1;
  unsigned int a3 : 1;
  unsigned int a4 : 1;
};

#define ELEMENT_COUNT 4 /* the number of bit fields in the struct */

/* returns the bit at position N, or -1 on error (n out of bounds) */
int getval(struct Element* ep, int n) 
{
  if(n > ELEMENT_COUNT || n < 1)
    return -1;

  /* this union makes it possible to access bit fields at the beginning of 
     the struct Element as if they were a number.
   */
  union {
    struct Element el;
    uint32_t bits;
  } comb;

  comb.el = *ep;
  /* check if nth bit is set */
  if(comb.bits & (1<<(n-1))) {
    return 1;
  } else {
    return 0;
  }
}

int main(int argc, char** argv)
{
  int i;
  struct Element el;

  el.a1 = 0;
  el.a2 = 1;
  el.a3 = 1;
  el.a4 = 0;

  for(i = 1; i <= ELEMENT_COUNT; ++i) {
    printf("el.a%d = %d\n", i, getval(&el, i));
  }  

  printf("el.a%d = %d\n", 8, getval(&el, 8));

  return 0;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2010-01-15T14:21:30.267

基于 eli-courtwright 解决方案但不使用字段偏移数组......如果您有一个包含这样的指针字段的结构，也许您可​​以编写：

```
struct  int_pointers
 {
   int  *ptr1;
   int  *ptr2;
   long *ptr3;
   double *ptr4;
   std::string * strDescrPtr;

}; 
```

然后您知道每个指针与指向该结构的指针有 4 个字节的偏移量，因此您可以编写：

```
struct int_pointers  ptrs;
int  i1 = 154;
int i2 = -97;
long i3 = 100000;
double i4  = (double)i1/i2;
std::string strDescr = "sample-string";
ptrs.ptr1 =  &i1;
ptrs.ptr2 =  &i2;
ptrs.ptr3 = &i3;
ptrs.ptr4 = &i4;
ptrs.strDescrPtr = &strDescr; 
```

然后，例如，对于 int 值，您可以编写：

```
int GetIntVal (struct int_pointers *ep, int intByteOffset) 
{ 
   int * intValuePtr =  (int *)(*(int*)((int)ep + intByteOffset)); 
   return *intValuePtr; 
} 
```

通过以下方式调用它：

```
int intResult = GetIntVal(&ptrs,0) //to retrieve the first int value in ptrs structure variable

int intResult = GetIntVal(&ptrs,4) //to retrieve the second int value in ptrs structure variable 
```

对于其他结构字段值，依此类推（编写其他特定函数并使用正确的字节偏移值（4 的倍数））。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2011-12-29T10:37:55.507

尽管 OP 指定我们不应该关心结构的内容，因为它们只是位域，是否可以使用 char 或 int（或任何具有所需大小的数据类型）来创建 n 位“数组“ 在这种情况下？

```
void writebit(char *array, int n)
{
  char mask = (1 << n);
  *array = *array & mask;
} 
```

如果需要更长的“数组”，则将 char 类型替换为更大的类型。不确定这是其他结构中的最终解决方案，但它应该在这里工作，具有类似的 readbit 功能。

# mysql - 开源数据库软件的任何正式基准测试？

> ID：887862
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T13:22:10.340
> 
>         
> 
> 标签：mysql, database, sqlite, postgresql, benchmarking

有没有开源数据库，特别是sqlite，MySQL，PgSQL的正式性能和压力测试报告？

我想在服务器中使用 sqlite，因为它结构简单，易于嵌入。但是我找不到关于这些数据库软件性能的任何优点和缺点（通过谷歌搜索和雅虎搜索）。

请建议。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T20:11:47.703

Sysbench 是一个很好的 mysql 基准测试工具，我相信它有插件或测试 PostgreSQL 的能力。请记住，您不会得到一个简单的数字，上面写着“DBMS A 比 DBMS B 快”——充其量您可以希望了解对于特定类型的工作负载，希望类似于您最终会扔给系统的任何工作负载。

不管性能如何，如果你真的知道你在用 RDBMS 软件做什么并且需要一个开源解决方案，你可能会想要使用 PostgreSQL——否则，坚持使用 MySQL。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:55:31.537

我找到[了这篇](http://www.sqlite.org/speed.html)文章。它在顶部有关于信息年龄的免责声明。但是，它可能对您有所帮助。  

这是另[一篇](http://www.sqlite.org/cvstrac/wiki?p=PerformanceConsiderations)似乎更新和更新的文章。

从阅读这些内容看来，SQLite 在性能方面已经足够了。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-08-13T06:39:30.583

基准测试很难。而且很贵。而且在大部分安装完成后，SQLite 甚至都不会进行测试，因为它是为完全不同的工作负载而设计的，根本无法处理这种情况。（例如，任何真正的基准测试都会让客户端在与服务器不同的机器上运行，而 SQLite AFAIK 并没有真正做到这一点——而在本地只有一个客户端的情况下它确实做得很好）。

您总是可以查看类似规范的内容，例如[http://www.spec.org/jAppServer2004/results/jAppServer2004.html](http://www.spec.org/jAppServer2004/results/jAppServer2004.html)至少同时显示 pg 和 mysql。但请注意，硬件平台不同（而且这些测试也不是从今天开始的）。

但底线是，如果您想比较应用程序的性能，您可以运行的唯一真正相关的基准测试是您自己在测试环境中的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T18:22:58.390

基准不是数据库选择中最重要的。

我认为 SQLite 和 MySQL 比 Progres 或[Firebird](http://www.firebirdsql.org)更快，但是如果您需要一些特定的功能，例如[CTE](http://www.firebirdsql.org/rlsnotesh/rlsnotes210.html#rnfb210-cte)，即使是 SQL 标准，也只有少数数据库具有

# sql - 单个 SQL SELECT 从一个表行返回多行

> ID：887870
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-20T13:23:40.290
> 
>         
> 
> 标签：sql, oracle, select, plsql, oracle9i

我们有一个表格，其形式为：

```
ID,Value1,Value2,Value3
1,2,3,4 
```

我们需要将其转化为。

```
ID,Name,Value
1,'Value1',2
1,'Value2',3
1,'Value3',4 
```

在一个 SELECT 语句中（即没有 UNION）有没有一种聪明的方法？列名 Value1、Value2 和 Value3 是固定不变的。

数据库是oracle 9i。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-20T13:27:27.583

试一试`union`。

```
select ID, 'Value1' as Name, Value1 as Value from table_name union all
select ID, 'Value2', Value2 as Value from table_name union all
select ID, 'Value3', Value3 as Value from table_name

order by ID, Name 
```

using`union all`意味着服务器不会执行 a `distinct`（这在操作中是隐含的`union`）。它不应该对数据产生任何影响（因为您的 ID 应该完全不同），但它可能会加快速度。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T14:03:16.607

这适用于 Oracle 10g：

```
select id, 'Value' || n as name,
       case n when 1 then value1 when 2 then value2 when 3 then value3 end as value
from (select rownum n
      from (select 1 from dual connect by level <= 3)) ofs, t 
```

我认为 Oracle 9i 有递归查询？无论如何，我很确定它有 CASE 支持，所以即使它没有递归查询，您也可以执行“(select 1 from dual union all select 2 from dual union all select 3 from dual) ofs”代替。对 Oracle 来说，滥用递归查询更为普遍。（不过，使用联合生成行可以移植到其他数据库）

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:27:42.357

你可以这样做，但它并不漂亮：

```
SELECT id,'Value 1' AS name,value1 AS value FROM mytable
UNION
SELECT id,'Value 2' AS name,value2 AS value FROM mytable
UNION
SELECT id,'Value 3' AS name,value3 AS value FROM mytable 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:28:18.893

联合三个 select 语句应该可以解决问题：

```
SELECT ID, 'Value1', Value1 AS Value
FROM TABLE
UNION
SELECT ID, 'Value2', Value2 AS Value
FROM TABLE
UNION
SELECT ID, 'Value3', Value3 AS Value
FROM TABLE 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:29:56.050

如果您使用的是 SQL Server 2005+，那么您可以使用 UNPIVOT

```
CREATE TABLE #tmp ( ID int, Value1 int, Value2 int, Value3 int)

INSERT INTO #tmp (ID, Value1, Value2, Value3) VALUES (1, 2, 3, 4)

SELECT
    *
FROM
    #tmp

SELECT
    *
FROM
    #tmp
UNPIVOT
(
    [Value] FOR [Name] IN (Value1, Value2, Value3)
) uPIVOT

DROP TABLE #tmp 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:14:20.890

正如其他人所建议的那样，UNION ALL 可能是您在 SQL 中的最佳选择。您可能还需要考虑在前端处理此问题，具体取决于您的具体要求。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2013-07-24T13:25:33.287

Oracle 的 CTE 语法可能不同（我在 Teradata 中运行它），但我只使用 CTE 提供测试数据，即 1 2 3 和 4。您可以使用临时表。实际的 select 语句是普通的普通 SQL，它适用于任何关系数据库。

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2009-05-20T13:36:06.910

对于 Sql Server，考虑 UNPIVOT 作为 UNION 的替代方案：

```
SELECT id, value, colname
FROM #temp t
UNPIVOT (Value FOR ColName IN (value1,value2,value3)) as X 
```

这也将返回列名。我不确定 X 的用途，但你不能忽略它。

* * *

## 回答 #9

> 赞同：-1
> 
>             
> 
> 时间：2013-07-23T19:43:44.400

试试这个：

CTE 创建一个包含 4 个值的临时表。您可以在任何数据库中按原样运行它。

```
with TEST_CTE (ID) as

(select * from (select '1' as a) as aa  union all
select * from (select '2' as b) as bb  union all
select * from (select '3' as c) as cc  union all
select * from (select '4' as d) as dd )

select a.ID, 'Value'|| a.ID, b.ID
from TEST_CTE a, TEST_CTE b
where b.ID = (select min(c.ID) from TEST_CTE c where c.ID > a.ID) 
```

这是结果集：

```
1   Value1  2

2   Value2  3

3   Value3  4 
```

享受！

一些事后的想法。

^^^ CTE 语法在 Oracle 中可能不同。我只能在 Teradata 中运行它。您可以将其替换为临时表或修复语法以使其与 Oracle 兼容。select 语句是普通的普通 SQL，适用于任何数据库。

^^^ 还有一点要注意。如果 ID 字段是数字，您可能需要将其转换为 CHAR 以便将其与“值”连接起来。

# msbuild - 无法使用 msbuild 或使用 cc.net 的 aspnet_compiler 发布

> ID：887883
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T13:25:10.100
> 
>         
> 
> 标签：msbuild, cruisecontrol.net, aspnet-compiler

我正在尝试自动发布在 cc.net 中具有许多解决方案的项目。我正在使用 msbuild，它又调用 aspnetcompiler xml 文件。问题是我的目录包含许多解决方案，当我运行 aspnetcompiler 时，它给了我以下错误。

errorASPCONFIG：使用注册为 allowDefinition='MachineToApplication' 的部分超出应用程序级别是错误的。此错误可能是由于虚拟目录未在 IIS 中配置为应用程序所致

我已经尝试了许多论坛上给出的所有可能的解决方案。但我很困惑如何明确告诉 aspnet_compiler 执行 20 个项目中的一个特定项目。

```
 I am using the ccnet build to call aspnet complier 
  <msbuild>
    <executable>C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe</executable>
    <!--msbuild exe directory -->
    <workingDirectory>C:\cc\test\code\</workingDirectory>
    <!--your working directory -->
    <projectFile>C:\Program Files\CruiseControl.NET\server\AspNetCompilerConfiguration.xml</projectFile>
    <!--the configuration xml file which will hold  AspNetCompiler  lines-->
    <logger>C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll</logger>
  </msbuild> 
```

这是我的 AspNetCompilerConfiguration.xml 文件

```
<Project
    xmlns = "http://schemas.microsoft.com/developer/msbuild/2003"
    name = "AspNetPreCompile"
    DefaultTargets = "PrecompileWeb">
    <Target Name = "PrecompileWeb">
            <AspNetCompiler
                    VirtualPath = "test" 
                    PhysicalPath = "C:\cc\test\code\"
                    TargetPath = "C:\cc\testitr\deploy\"
                    Force = "true"
                    Debug = "true"
                    Updateable = "true"/>
    </Target>
</Project> 
```

现在我想运行 C:\cc\test\code\Com.Project1.sln。但我不知道如何告诉 aspnet 编译器。任何想法如何做到这一点，然后发布。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-12-09T12:38:24.540

首先：您不能使用 aspnet_compiler 通过脚本发布网站，但您可以（发布模式-）编译网站，这通常是同一件事。或者你可以按照我在这篇文章中描述的方式使用 MsBuild。

我建议您将 ASP.NET 网站分组为解决方案文件并构建它们。然后你有更少的参数，你可以用 Visual Studio 测试构建。

以下是如何在 cc.net 构建文件中为 msbuild-scirpt 使用一些参数的方法：

```
 <msbuild>
    <executable>C:\WINDOWS\Microsoft.NET\Framework\v3.5\MSBuild.exe</executable>
    <!--msbuild exe directory -->
    <workingDirectory>C:\cc\test\code\</workingDirectory>
    <!--your working directory -->
    <projectFile>C:\Program Files\CruiseControl.NET\server\AspNetCompilerConfiguration.xml</projectFile>
    <!--the configuration xml file which will hold  AspNetCompiler  lines-->
    <logger>C:\Program Files\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MsBuild.dll</logger>
    <!--Build arguments. You can have multiple projects or msbuild sections in cc.net.config-->
    <buildArgs>/p:Configuration=Debug;MyAttribute1=MyValue1;MyAttribute2=MyValue2;</buildArgs>
    <!--targets, if not default (here PrecompileWeb) -->
    <targets>Build;Analyze</targets>
  </msbuild> 
```

然后你可以修改你的 AspNetCompilerConfiguration.xml（在我看来更好的名字应该是 MyWebSites.msbuild 之类的）来获取参数：

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" name = "AspNetPreCompile"    DefaultTargets = "PrecompileWeb">
  <!--Conditions are params from ccnet.config (or command line)-->
  <PropertyGroup Condition="'$(MyAttribute1)' == MyValue1" >
    <MySolution>c:\mything.sln</MySolution>
  </PropertyGroup>
  <PropertyGroup Condition="'$(MyAttribute1)' != MyValue1" >
    <MySolution>c:\some_other.sln</MySolution>
  </PropertyGroup>

  <!--This way you could import other msbuild-scirpts to manage separate files-->
  <!--<Import Project="Morexml.msbuild"/>-->

  <Target Name="Build">
    <Exec Command="echo hello world 1!"/>
    <MSBuild Projects="$(MySolution)" Targets="Rebuild" ContinueOnError="false" StopOnFirstFailure="false" />
  </Target>
  <Target Name="Analyze">
    <Exec Command="echo hello world 2!"/>
  </Target>
  <!--default, for example, here call some tasks -->
  <!--default is not used when targets are specified -->
  <Target Name="PrecompileWeb">
    <CallTarget Targets="Build" />
    <CallTarget Targets="Analyze" Condition="'$(MyAttribute2)' != 'MyValue2'" />
  </Target>
</Project> 
```

您可以使用 Visual Studio 或记事本配置您的解决方案 .sln 文件。但是它应该有您的网站，如下所示：

```
Project("{ABCD1234-7377-472B-9ABA-BC803B73C123}") = "MyWebSite", "http://localhost/MyWebSite", "{12345678-5FD6-4177-B210-54045B098ABC}"
    ProjectSection(WebsiteProperties) = preProject
        Debug.AspNetCompiler.VirtualPath = "/MyWebSite"
        Debug.AspNetCompiler.PhysicalPath = "..\..\MyWebSite\"
        Debug.AspNetCompiler.TargetPath = "C:\MyPublishedWebsite\"
        Debug.AspNetCompiler.Updateable = "false"
        Debug.AspNetCompiler.ForceOverwrite = "true"
        ... 
```

在那里你可以看到属性。无需对 IIS 进行任何配置。（只需检查您发布的 Web.Config（发布/调试等设置）或者使用一些 msbuild-Target 来处理它。）

希望这可以帮助！

# c# - 通过远程 Exchange 2007 服务器上的 Web 服务为用户创建邮箱。（C＃）

> ID：887887
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T13:26:18.380
> 
>         
> 
> 标签：c#, web-services, ldap, exchange-server, email

***编辑***
我几乎得到了它，现在有错误消息，它找不到交换数据库。我在与 Exchange 不同的服务器上运行该服务，所以我认为我必须使用 UNC 路径。MyServer01\First Storage Group\Mailbox Database.edb 不起作用...

你好！我在这里变得很沮丧，感觉头疼得厉害，我几乎要把我的电脑扔出窗外......

这就是问题所在，我想通过 Sharepoint 在 Active Directory 中创建一个新用户，在 Sharepoint 列表下方运行一个工作流，该工作流捕获变量并将它们发送到在活动目录中创建用户的 web 服务。这很好用，但用户还需要一个邮箱。那么我们该怎么办？我们将邮件属性设置为所需的电子邮件地址并找到属性“创建邮箱”....说什么？它在哪里？NOOOOOESSS它不再存在，MS决定它需要更复杂，现在唯一的方法是使用powershell废话......

所以这就是我在这里的原因，我在谷歌上搜索了一些信息并找到了一些可以解决问题的代码，但是，这就是我卡住的地方，网络服务不在 Exchange 服务器上运行，而是在不同的服务器上运行，网络服务需要连接到交换服务器以运行 powershellshizzle...找不到任何有关此的信息，找不到任何示例等等...

帮助... F1 ...等

```
using System;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.Linq;
using System.Web;
using System.Management.Automation;
using System.Management.Automation.Host;
using System.Management.Automation.Runspaces;
using Microsoft.PowerShell.Commands;  
using System.Web.Services;
using System.DirectoryServices;

namespace WebService1
{
/// <summary>
/// Summary description for Service1
/// </summary>
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.ComponentModel.ToolboxItem(false)]
// To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
// [System.Web.Script.Services.ScriptService]
public class Service1 : System.Web.Services.WebService
{

    [WebMethod]
    public void CreateADUser(string domain, string domainPostFix, string firstName, string emailaddress, string lastName, string department, string loginName, string password)
    {
        DirectoryEntry AD = null;
        DirectoryEntry NewUser = null;

        AD = new DirectoryEntry("LDAP://OU=Users,DC=" + domain + ",DC=" + domainPostFix);

        NewUser = AD.Children.Add("CN=" + firstName + " " + lastName, "user");
        NewUser.Properties["samAccountName"].Add(loginName);
        NewUser.Properties["name"].Add(firstName + " " + lastName);
        NewUser.Properties["displayname"].Add(firstName + " " + lastName);
        NewUser.Properties["givenName"].Add(firstName);
        NewUser.Properties["sn"].Add(lastName);
        NewUser.Properties["userprincipalname"].Add(loginName + "@" + domain + "." + domainPostFix);
        NewUser.CommitChanges();

        NewUser.Invoke("SetPassword", new object[] { password });

        NewUser.CommitChanges();

        // E-mail shizzle, don't understand it yet, hopefully it works, if not, don't blame me -Erik
        RunspaceConfiguration runspaceConf = RunspaceConfiguration.Create();
        PSSnapInException PSException = null;
        PSSnapInInfo info = runspaceConf.AddPSSnapIn("Microsoft.Exchange.Management.PowerShell.Admin", out PSException);
        Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConf);
        runspace.Open();
        Pipeline pipeline = runspace.CreatePipeline();
        Command command = new Command("New-Mailbox");
        command.Parameters.Add("Name", "TestName");

        //Enabling user account
        int val = (int)NewUser.Properties["userAccountControl"].Value;
        NewUser.Properties["userAccountControl"].Value = val & ~0x2;
        NewUser.CommitChanges();

        NewUser.Close();

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-08-12T02:07:04.547

[这篇](http://msexchangeteam.com/archive/2006/10/02/429053.aspx)文章解释了发生了什么。基本上，Exch2003 中曾经有一个叫做 RUS 的东西，它为“部分配置”的用户创建了邮箱。因此，您可以通过 LDAP 创建一个用户，然后 RUS 将在下一次通过时选择新用户，并通过创建邮箱并修复其其他 AD 属性来完成该过程。

现在在 2007 年，RUS 已不复存在，但您可以通过安排一些 cmdlet 在 Exchange 服务器上定期运行（例如，使用“at”命令）来获得相同的功能。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-08-11T21:29:59.580

运行此应用程序的计算机需要安装 Exchange 管理工具，以便 Exchange 管理管理单元可用。

您运行它的帐户还需要具有 Exchange 的管理权限。

# trigonometry - 大于 360 度角的三角比

> ID：887889
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-20T13:26:52.717
> 
>         
> 
> 标签：trigonometry

有没有使用 Sin(720) 或 Cos(1440)（以度为单位的角度）？无论是在计算机编程还是在任何其他情况下？一般来说，是否有任何大于 360 度角的 Sin/Cosine/Tan 的使用？

在物理学中，我们确实经常使用点积和叉积，但即使它们也总是需要小于 180 度的角度。

大家好，我知道如何计算它们....我想知道它们是否有用？？？？我什么时候会遇到一种情况，例如当我需要计算 Sin(440) 时？？？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-20T13:31:44.173

在数学和编程方面：

```
Sin(x) = Sin(x % 360) 
```

正如另一个答案所指出的那样，大于 360 的角度表示一个或多个完整的圆加上模部分。在某些情况下，这可能具有物理意义。

此外，在进行三角函数计算时，您应该考虑到这一事实。例如：

```
sin(a)*cos(a) = (1/2)*sin(2a) 
```

对于 a>180，您将得到大于 360 的角度的 sin。

顺便说一下，看看[这里](http://www87.wolframalpha.com/input/?i=sin%28380%29)。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T13:37:53.817

我在做角度算术时看到过这样的事情：

```
float angleOne = 150;
float angleTwo = 250;

//...

float result = Sin(angleOne + angleTwo); // Sin(400)
float result = Sin(angleOne - angleTwo); // Sin(-100) 
```

在这个（人为的）示例中，这似乎很明显，但是当您根据多个对象的任意旋转计算角度时，您并不总是知道您会得到什么样的数字。想象一下，例如，在 3D 游戏中计算玩家站在旋转平台上时的位置。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:32:37.137

绕一圈旋转一圈是 360 度或`2pi`弧度。

[正弦和余弦等三角函数](http://en.wikipedia.org/wiki/Trigonometric_functions)在达到 360 度时会“环绕”，其作用与 0 度时相同。基本上，会发生以下情况：

```
angle_in_unit_circle = angle mod 360 
```

此外，某些三角函数（例如切线）未定义在某些角度，例如 90 度和 270 度，其中角度的切线将返回正无穷或负无穷大。

这种“环绕”可以通过使用[单位圆](http://en.wikipedia.org/wiki/Unit_circle)内接的直角三角形表示正弦、余弦、正切函数来看到，这种行为[使这些函数具有*周期性*](http://en.wikipedia.org/wiki/Periodic_function)，因为它们会一遍又一遍地重复它们的模式。

维基百科有一篇关于[三角函数](http://en.wikipedia.org/wiki/Trigonometric_functions)的广泛文章，因此可能值得一看。

**用法**

在使用方面，我想不出一个很好的例子，除了，也许可以表示一个粒子在[极坐标系](http://en.wikipedia.org/wiki/Polar_coordinate_system)中某个时间的位置，其中角度`θ`取决于时间`t`：

```
r(θ(t)) = t    where θ(t) = t 
```

对于从 0 到 720 的 t 值，它可以在[笛卡尔坐标系](http://en.wikipedia.org/wiki/Cartesian_coordinate_system)中表示为：

```
x(t) = r sin(θ(t)) == t sin(t)
y(t) = r cos(θ(t)) == t cos(t) 
```

粒子将以螺旋式运动方式运动，具体取决于时间`t`。在这种情况下，将计算超过 360 度角的正弦和余弦。

（而且我的数学很生疏，所以如果上面的方程式有任何错误，请告诉我！）

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:54:44.597

每当您处理用户交互技术时，它们完全有可能将您推过 0 度或 360 度。想象一下，您正在使用炮塔制作游戏。它当前指向 359 度，用户将操纵杆向右拉动：现在它指向 361 度。如果您错误地执行角度表示，突然间，枪会快速向左移动近 360 度。  

我预测用户会……对那个错误*感到失望*。

在游戏、模拟和真实设备控制中很重要的参考系的  [欧拉角](http://en.wikipedia.org/wiki/Euler_angles)表示有各种各样的问题。[云台锁](http://en.wikipedia.org/wiki/Gimbal_lock)是实际旋转设备控制中的一个严重问题（这是我生活中相机云台设备的问题）。“快速旋转”错误曾是小船自动驾驶系统中的一个非常讨厌的问题——想象一下将钢缆紧紧地缠绕在轮罩周围（即，你不想站在那里）。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T14:01:02.400

有时，正常的数学意味着你最终会“穿过圆圈”一次或多次，如果你保持数学简单，你的角度可能大于 360。我个人喜欢将角度标准化为 0 到 360 或在这样的操作之后-180到180，但这并不重要。

有时更大的数字可能真的代表了一些东西。举个简单的例子，想象一下打开经典拨号组合保险箱的说明。您需要将表盘旋转几次，因此说明可能是：

```
 turn(800);  // Twice around plus another 20 degrees
   turn(-500); // Once around the other direction plus 140 degrees
   turn(40);   // Dial in the last digit 
```

在这种情况下，取 sin 或 cos 会告诉您有关表盘最终位置的信息，但您会丢失有关转数的信息。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:35:50.843

在正弦曲线上，Sin(720) == Sin(0) （等等），所以我希望这些函数的任何体面实现都能处理“大于”360 度。有很多原因可以达到更大的角度大于 360 或小于 0。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:46:46.827

“主角”范围之外的角度 [-180,180) 本质上是彼此的别名（模 360 度）并且没有物理区别。

从数学/工程的角度来看，如果您有一个旋转数很重要并且必须跟踪的过程（例如来回旋转的电机），那么 0 度和 720 度是不一样的。正弦和余弦只是周期函数，因此它们每 360 度具有相同的值。如果你有一个粒子进行匀速圆周运动，其中 x(t) = A cos (ωt + φ) 并且 y(t) = A sin (ωt + φ)，那么相位角 θ = (ωt + φ) 将变为不管它是什么，无论是 0 度还是 720 度还是 82144.33 度或其他什么。

所以函数 cos(θ) 和 sin(θ) 只是用来计算 x 和 y 坐标，不管 θ 的值是多少。在这件事上你没有选择权，如果 θ 是 82144.33 度，那么你会想要计算那个角度的正弦和余弦。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2010-06-30T21:24:09.803

我玩一个名为 Garry's Mod 的 PC 游戏，在游戏中的某些时刻，在编程时，我想要一个简单的解决方案来保持对象在一个恒定的圆圈中不断移动。为此，我使用了一个永远递增的计时器的正弦和余弦，测量自游戏启动以来的时间量。

T（时间）的正弦等于轨道路径 X 值，而 T 的余弦等于轨道路径 Y 值（X 和 Y 位于 3 维坐标平面上，Z 暂时未使用。）

例子：

T=1000 滴答 X=sin(T) Y=cos(T)

所以在那个时刻 X 是 0.8268795405320025 而 Y 是 0.15466840618074712。

现在假设时间增加到 1500。X 将是 -0.9939019569066535 并且 Y = -0.11026740251372914。

简而言之，它会不断地从 1 波动到 -1，让我有机会将该值乘以 100，并使坐标平面本地化到我的角色位置，然后我可以告诉程序表达式基于移动对象那些坐标，它会在我周围以恒定的圆形路径移动。

多田。谁说你不能从电子游戏中学习？

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:30:59.103

由于某种计算，您肯定会得到一个大于 360 度的角度测量值……但它与无数其他角度测量值相同，其中一个在 0 到 360 之间. 但是，如果你正在编写一个函数，你应该能够自己处理这个计算……而不是依赖用户为你做 mod。

即虽然 sin(370) == sin(10) 确实如此，并且用户可以自己进行此翻译，但他们可能出于某种原因不想这样做（请参阅评论中的“螺栓”示例以获得最高评价答案），因此该函数应该能够处理任何值。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:34:58.223

因为`sin(x) = sin(x mod 360°)`并且`cos(x) = cos(x mod 360°)`您可以在计算中使用每个值，但您也可以标准化为范围`[0°,360°)`或任何其他范围`360°`。大角度是否具有明确定义的含义仅取决于用法。

处理器可能会将计算标准化为一个范围`90°`甚至更小，并从这个小范围中得出所有其他值。

什么时候会出现大于的争论`360°`？

它们自然出现在周期性时间或空间相关函数的模拟中。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:51:58.983

您的问题没有多大意义，因为您似乎知道这里的区别：

不——您将永远不必“计算”Sin(720)，就像您将需要“计算”Sin(0) 一样。您需要查看 Sinus 函数的定义以完全理解幕后发生的事情 - 当理解了这一点后，任何人都可以理解为什么 Sin(0) = Sin(720) - 没有什么神奇的事情发生，（逻辑上）没有 Angle = FullAngle % 360 继续，这一切都在函数应该做什么的定义中。

[见维基百科](http://en.wikipedia.org/wiki/Sine)

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:55:39.930

@dta，我认为人们有点困惑。你问它是否“有用”。我会说“没关系，因为您只需在执行计算时将角度移动到适当的范围。” 在某些情况下，您需要知道物体旋转了多远，以考虑多次旋转。但除了这些情况之外，解释正常 0-360 范围内的角度更方便。大多数人都会对哪个方向对应于该正常范围内的角度建立一种直观的感觉。170,234 度指向什么方向？与 314 度相同。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:15:20.187

正如@Chris Arguin 和其他人所说，角度大于 360°（或就此而言小于 -360°）是否对您有用取决于您是否需要有关旋转（或其分数）的信息，由角度和角度%360°的区别。

此外，由于您得到相同的答案，因此如果您调用 sin(angle) 而不是 sin(angle%360)，您将节省一点处理时间，尤其是当您在循环中进行许多计算时。

OTOH，@Scottie T 提出了一个很好的观点，如果让某人知道您的角度指向的圆周围的位置很重要，那么人们通常可以直观地感知绝对值为 360 或更小的角度的位置，而不是更大的角度。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:16:03.880

在许多情况下，需要 [0,360] 之外的角度。我喜欢密码锁的想法。在这里，人们经常会看到简单的 [0,360] 度范围之外的正角和负角。

多角度公式在数学中通常很重要。三角函数不仅用于三角形，还用于其他地方。它们出现在各种地方，例如傅里叶级数，或图像压缩方案，或微分方程的解。在计算上，确实可以使用 mod 将触发函数的范围缩小到默认值。但是，总是在该标称范围内提供角度很少是真的。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2010-12-11T00:27:30.617

高于 360 度的角度也用于描述滑雪板技巧：

[http://en.wikipedia.org/wiki/List_of_snowboard_tricks#Spins](http://en.wikipedia.org/wiki/List_of_snowboard_tricks#Spins)

所以你看，有各种现实世界的例子，你使用更高的角度来描述物体的旋转。

# visual-c++ - 简单宏扩展中的“未声明的标识符”错误

> ID：887891
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:27:02.497
> 
>         
> 
> 标签：visual-c++, unicode, macros

我有一个非常简单的宏，用于声明异常时的速记。在调试模式下，它会添加当前文件和行号。

我正在修改我的代码以支持 unicode，但每当使用我的宏时突然出现“未声明的标识符”错误。我可能遗漏了一些非常简单的东西，因为宏本身相当简单。谁能告诉问题是什么？

这是宏声明：

```
#ifdef _DEBUG
#define EXCEPTION(msg, mm) Exception(msg, mm, _T(__FILE__), _T(__LINE__))
#else
#define EXCEPTION(msg, mm) Exception(msg, mm)
#endif 
```

我认为不需要，但以防万一，这里是异常构造函数声明：

```
Exception(LPCTSTR msg, BOOL manageMsg = FALSE, LPCTSTR f = NULL, int l = -1); 
```

在发布模式下编译时我没有收到任何错误，但在调试模式下我会这样做，所以它与 __FILE__ 和 __LINE__ 位有关，但我无法弄清楚实际问题是什么。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-07-14T17:00:50.987

这与我遇到的问题不完全相同，但我在这里发布了我的问题的解决方案，因为我在调查期间遇到了这个问题。

如果您在使用多行宏时遇到此错误消息，请在编辑器中打开可见空白。在行尾的 '\' 延续字符后可能有空格：

```
#define FOO_BAR(aFoo) \ 
    FOO_BASE(aFoo, "bar") 
```

最后的空格导致解析器将宏定义的第一行解析为完整的（FOO_BAR 扩展为 '\'），第二行被解释为函数声明，因此是“未声明的标识符 'aFoo'”）。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:35:27.847

`__LINE__`宏计算为一个整数。该`_T`宏`L`在字符串的前面放置一个以使它们成为 Unicode 字符串。它后面应该跟一个双引号，例如`L"file.cpp"`. `__LINE__`但在你的情况下，它后面是扩展为的整数文字。你得到这样的东西：`L23`. 摆脱第二个`_T`电话。

```
#define EXCEPTION(msg, mm) Exception(msg, mm, _T(__FILE__), __LINE__) 
```

如果您包含了编译器无法识别的标识符的名称，这可能更容易诊断。编译器通常在其错误消息中包含该信息。

# windows - 如何找到 Windows SDK 的 SetEnv.cmd / SetEnv.cmd 无法正常工作

> ID：887894
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-20T13:27:39.517
> 
>         
> 
> 标签：windows, msbuild, sdk, setenv

我们有一个正在运行的 Team City Build Server，并且想要编译一个 Visual C++ 项目。到目前为止，这很容易，因为我已经使用 Windows SDK 设置了我们的 Windows 构建代理，但我们没有解决方案/项目文件。

项目文件是使用 CMake 创建的。CMake 似乎有点笨（未安装 Visual Studio 时无法生成解决方案），但通过一些技巧，我可以做到这一点。然后可以使用 MSBuild 构建解决方案。

问题来了。为此，我需要调用 Windows SDK 的 SetEnv.cmd。而且我似乎无法自动找到它。在Windows SDK的bin子目录下，但是bin和root都不在路径下，而且`%mssdk%`环境变量*是SetEnv.cmd设置的，*事先不可用！

将 Windows SDK\bin 目录添加到 PATH 会导致 SetEnv.cmd 不再工作（退出并显示`The x86 compilers are not currently installed`和`Jump target Set_x86 not found`.

开始菜单链接以 Windows SDK 目录作为工作目录调用 SetEnv.cmd。但是如果我将根目录添加到 PATH，Bin\SetEnv.cmd 不可用。

如何自动找到 SetEnv.cmd？即使将环境变量设置为 setenv.cmd 的完整路径也不起作用，并且当我将 %mssdk% 定义为 sdk 目录时，调用 %mssdk%\bin\SetEnv 也不起作用。我还尝试定义 %mssdk%，然后 cd %mssdk%，然后调用 bin\SetEnv。在所有这些情况下也找不到编译器。如果我在命令行上手动 cd 到 root 或 bin 目录，然后调用 SetEnv.cmd，它也不起作用...

不过，开始菜单链接工作正常。

作为记录，我现在的解决方案虽然很奇怪，但如下：

我创建了一个 MSBuild 文件，该文件在命令行上使用 CMake 创建解决方案文件，然后使用 MSBuild 任务调用创建的解决方案。MSBuild 文件可以很容易地从 TeamCity 构建，尽管我需要一些额外的技巧来满足 CMake 愚蠢地*寻找编译器，尽管我不会调用它*。不是很令人满意，但它确实有效。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2010-06-04T14:18:51.480

我的解决方案（设置`%WindowsSdkPath%`，因此`SetEnv.cmd`可以在下找到`%WindowsSdkPath%Bin\`）：

```
@ECHO OFF

IF "%WindowsSdkVersion%"=="" (
  CALL :SetWindowsSdkVersionHelper HKCU > nul 2>&1
  IF ERRORLEVEL 1 CALL :SetWindowsSdkVersionHelper HKLM > nul 2>&1
  IF ERRORLEVEL 1 GOTO ERROR_NOWSDK
)

CALL :SetWindowsSdkPathHelper > nul 2>&1
IF ERRORLEVEL 1 GOTO ERROR_NOWSDK
GOTO END

:SetWindowsSdkPathHelper
SET WindowsSdkPath=
FOR /F "tokens=1,2*" %%i in ('REG QUERY "HKLM\SOFTWARE\Microsoft\Microsoft SDKs\Windows\%WindowsSdkVersion%" /V InstallationFolder') DO (
    IF "%%i"=="InstallationFolder" (
        SET "WindowsSdkPath=%%k"
    )
)
IF "%WindowsSdkPath%"=="" EXIT /B 1
EXIT /B 0

:SetWindowsSdkVersion
CALL :GetWindowsSdkVersionHelper HKCU > nul 2>&1
IF ERRORLEVEL 1 CALL :GetWindowsSdkVersionHelper HKLM > nul 2>&1
IF ERRORLEVEL 1 EXIT /B 1
EXIT /B 0

:SetWindowsSdkVersionHelper
SET WindowsSdkVersion=
FOR /F "tokens=1,2*" %%i in ('REG QUERY "%1\SOFTWARE\Microsoft\Microsoft SDKs\Windows" /V "CurrentVersion"') DO (
    IF "%%i"=="CurrentVersion" (
        SET "WindowsSdkVersion=%%k"
    )
)
IF "%WindowsSdkVersion%"=="" EXIT /B 1
EXIT /B 0

:ERROR_NOWSDK
ECHO The Windows SDK %WindowsSdkVersion% could not be found.
EXIT /B 1

:END 
```

我被这件事`SetEnv.cmd`本身所启发......

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2011-01-17T15:18:08.897

马克，很好的答案！现在我想用我的项目文件运行 msbuild。但在我应该运行 SetEnv.Cmd 之前 - 对吧？

所以，我们开始：

```
run_Macs_code.bat REM see above
call "%WindowsSdkPath%\bin\Setenv.cmd" /Release /x86 /xp
cd E:\client
msbuild client.proj 
```

现在它正在工作:)

# java - 在自定义 JTable 中传递事件

> ID：887898
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T13:28:08.533
> 
>         
> 
> 标签：java, jtable

嗨，我有一个名为 ColorChooser 的类（在 net.java.dev.colorchooser.ColorChooser 包中）

这是一个用于选择颜色的自定义组件。我想要的是在第二列中显示一个带有 ColorChooser 的 JTable。所以我创建了自己的 TableCellRenderer 并且它可以工作：

```
@SuppressWarnings("serial")
class ColorChooserTableRenderer extends DefaultTableCellRenderer {

    public static List<ColorChooser> colors;

    public ColorChooserTableRenderer(int rows) {
        colors = new ArrayList<ColorChooser>(rows);
        for (int i = 0; i<rows ; i ++) {
            colors.add(new ColorChooser());
        }
    }

    @Override
    public Component getTableCellRendererComponent(JTable table, Object value,
            boolean isSelected, boolean hasFocus, int row, int column) {
        return colors.get(row);
    }

} 
```

我在我的表中注册了这个：

```
JTable t = new JTable(5,3);
t.getColumn(t.getColumnName(1)).setCellRenderer(new ColorChooserTableRenderer(5)); 
```

显示器很好。当我将鼠标悬停在其中一个上时，它甚至会显示 ColorChoosers 的工具提示。问题是 ColorChoosers 没有收到 MouseEvents。

通常，当您在 ColorChooser 上按住鼠标时，会弹出一个窗口，您可以使用它来选择颜色。在 JTable 中时，ColorChooser 组件不接收鼠标事件。

有什么解决办法吗？

编辑：这个问题可以很容易地修改为：

**你能给我一个在第二列中包含实际工作的 JButtons 的表的小例子吗？你知道，可以按下的按钮吗？**

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:33:06.900

这听起来有点熟悉，因为我一直在将表格单元格渲染器用于其他目的。

我的理解是 TableCellRenderer 只是用来**渲染**组件的；组件实际上并不存在于每个单元中。

因此，您可能不得不以某种方式将鼠标事件从 JTable 本身转发到 ColorChooser。

edit: p.s., see [my question](https://stackoverflow.com/questions/864707/) -- also for custom table cell rendering, you only need 1 instance of the component itself for the entire column, if the column is rendered with the same logic. Don't store persistent state in the TableCellRenderer, store it in the TableModel instead, and use that state immediately prior to rendering when you handle the call to `getTableCellRendererComponent()`.

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:48:38.460

A renderer only paints the component on the screen and does not allow for interaction. What you need is to also implement a [TableCellEditor](http://java.sun.com/javase/6/docs/api/javax/swing/table/TableCellEditor.html). It is recommend that you inherit the [AbstractCellEditor](http://java.sun.com/javase/6/docs/api/javax/swing/AbstractCellEditor.html) and you'll save some work. Check out the java [tutorial](http://java.sun.com/docs/books/tutorial/uiswing/components/table.html) for tables.

Example:

```
public class MyTableCellRenderer implements TableCellRenderer
{
    private JButton button = new JButton("Press Me");
    public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
        return button;
    }
}

public class MyTableCellEditor extends AbstractCellEditor implements TableCellEditor
{
    private JButton button;

    public MyTableCellEditor()
    {
        button = new JButton("Press Me");
        button.addActionListener(new ActionListener(){

            public void actionPerformed(ActionEvent e) {
                System.out.println("buttonPressed");
            }
        });
    }
    public Object getCellEditorValue() {
        return null;
    }
    public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row, int column) {
        return button;
    }
} 
```

# testing - 软件测试工作

> ID：887908
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T13:30:46.360
> 
>         
> 
> 标签：testing

我即将参加软件测试暑期工作的面试。关于这个我应该问教授什么问题+我以前从未做过软件测试，任何你能推荐的好的参考资料都将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-20T13:53:32.587

您应该准备好讨论各种测试术语，例如：

*   “黑盒”测试、“白盒”测试等。

*   单元测试

*   功能测试

*   烟雾测试

*   BVT（构建验证测试）

*   压力测试和负载测试的区别

*   性能测试

*   全球化测试

*   互操作性测试

*   手动测试与自动测试（何时？为什么？）

*   api测试

*   安全测试

*   回归测试

*   代码覆盖率测试

*   （等等......）您可能不需要所有这些方面的经验，但您应该表达一种意识。

以下内容的一般知识是有帮助的（请参阅 IEEE 829 作为开始）： - 测试计划 - 一个好的计划应该是什么？- 测试用例 - 一个好的测试用例应该包含什么？- 测试设计规范 - 事件报告（包括错误跟踪） - 软件规范 - 寻找什么？

你应该开始考虑如何测试不同的东西。基本情况是什么？有没有边界情况？任何给定的产品或项目可能有什么问题？创造性地思考...

对于测试的一些起始参考，我建议查看以下内容：

*   Cem Kamer[关于软件测试的书](https://rads.stackoverflow.com/amzn/click/com/0471358460)

*   [维基百科](http://en.wikipedia.org/wiki/Software_testing)的更多起点

*   IEEE 829（[相关文章](http://en.wikipedia.org/wiki/IEEE_829)应该足以让你思考，因为完整的规范对失眠者有好处）

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-22T14:23:23.117

如果您以前从未做过软件测试，那么快速学习一些东西是个好主意。

我建议查看黑盒软件测试课程，该课程可在[http://www.testingeducation.org/BBST](http://www.testingeducation.org/BBST)免费（无需讲师）获得，或者以讲师指导的版本免费提供给软件协会的成员测试（[http://www.associationforsoftwaretesting.org](http://www.associationforsoftwaretesting.org)）。这是一门大学水平的课程，视频、补充材料、测验、自测和其他信息的指针。

James Bach 和我共同创作并教授了一门名为“快速软件测试”的课程 ( [http://www.developsense.com/courses.html](http://www.developsense.com/courses.html) )。可在 James 的网站[http://www.satisfice.com/rst.pdf](http://www.satisfice.com/rst.pdf)上免费获取课程笔记。

我为 Better Software 杂志写了很多关于测试的文章。它们可在[http://www.developsense.com/publications.html](http://www.developsense.com/publications.html)免费获得。

此外，还有一篇博文供您参考：http:   [//www.developsense.com/2009/02/how-can-trainee-improve-his-her-skills.html](http://www.developsense.com/2009/02/how-can-trainee-improve-his-her-skills.html)

有几个在线测试社区，您可以在其中提出问题并获得指导。  [http://www.softwaretestingclub.com](http://www.softwaretestingclub.com)和[http://www.testrepublic.com](http://www.testrepublic.com)就是其中的两个。

祝你好运。

---迈克尔 B.

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T14:00:35.723

除了你会被问到的问题，别忘了面试实际上是一次谈话。如果你自己提问，你看起来会更好。所以，让我说几件事，如果我是你，我会问:)

对我来说，作为一名测试人员，最重要的是沟通。您与开发您测试的软件的团队成员、经理、团队沟通的能力如何。

他们是否使用某种错误跟踪系统，如果是，它是什么系统？开发团队使用的是同一个系统吗？

这个工具是否涵盖了大部分的沟通需求，或者会有很多电话/电子邮件交换导致关于问题的讨论完全混乱？

是否有任何用于测试的自动化工具？这让你非常接近你在这个职位上的职责，所以无论如何可能会在面试中涉及。

你有 2 台显示器 ;) 吗？（真的，获得第二台显示器对我来说是测试员工作的巨大进步）。您是否获得了使您的工作更快、更有效的工具？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-03-16T22:02:41.273

术语、定义和工具很重要……但分析技能、逻辑、沟通和其他技能可能更重要。

也许这不会是一份暑期工作，而是一份[职业](http://staqs.com/pubs/crit_think_career_PC2007.pdf)。  

# c# - 处理集合时正确使用属性

> ID：887911
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-20T13:31:07.403
> 
>         
> 
> 标签：c#, collections, properties

我想知道在处理集合时使用属性的最佳方法是什么。

例如，我有一个 Foo 类，我想存储该类的列表。应该使用以下哪一项：

```
private List<Foo> myList;
private List<Foo> myOtherList = new List<Foo>(); 
```

现在为财产：

```
public List<Foo> ListOfFoo
  {
     get 
     { 
        return myList; 
     }
     set 
     { 
        myList= new List<Foo>(value); 
     }
  } 
```

还是应该只设置值？

```
public List<Foo> ListOfFoo
  {
     get 
     { 
        return myList; 
     }
     set 
     { 
        myList= value; 
     }
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:37:55.097

通常，您不想使用丰富类型的属性`List<T>`（通常会使用`Collection<T>`），并且通常集合类型的属性是只读的 - 集合本身可以使用诸如等方法进行修改`Clear`，`Add`这通常是充足的。

例如：

```
class Foo
{
    Collection<Bar> _bars = new Collection<Bar>();

    public Collection<Bar> Bars { get { return _bars; } }
} 
```

这也使您可以通过实现等方法的后代`Collection<T>`并覆盖`InsertItem`等`SetItem`方法来验证对集合的修改。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:42:33.560

选择

```
private List<Foo> myOtherList = new List<Foo>(); 
```

因为另一个只是声明了一个引用（设置为 null），所以上面的示例声明了一个对列表的引用，创建了一个列表并将该新列表分配给该引用。

选择

```
public List<Foo> ListOfFoo
  {
     get { return myList; }
     set { myList= new List<Foo>(value); }
  } 
```

当您希望 myList 不反映列表分配给 myList 后发生的任何更改时，例如

```
List<string> myFirstList = new List<string>();
myFirstList.Add("Hello");
myFirstList.Add("World");

List<string> mySecondList = new List<string>(myFirstList); 
// mySecondList now contains Hello & world

myFirstList.Add("Boyo");
// myFrist List now contains Hello, world & Boyo
// mySecondList still contains Hello & world 
```

选择

```
public List<Foo> ListOfFoo
  {
     get { return myList; }
     set { myList= value; }
  } 
```

当您希望两个引用都指向同一个对象时，例如

```
List<string> myFirstList = new List<string>();
myFirstList.Add("Hello");
myFirstList.Add("World");

List<string> mySecondList = myFirstList; 
// mySecondList now contains Hello & world

myFirstList.Add("Boyo");
// myFrist List now contains Hello, world & Boyo
// mySecondList "also" contains Hello, world & Boyo 
```

上面的“也”用引号引起来，因为实际上只有一个列表，而且我的第一个和第二个都指向同一个列表。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:31:50.897

这取决于。

使用第一种样式时，您会创建列表的副本，这通常是不必要的。.Net 约定是让设置者将引用分配给属性。这就是为什么我会倾向于第二种选择。

但是，如果您打算进行复制操作，则第一个选项就是您要查找的选项。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:52:21.807

通常，只公开一个接口（ICollection、IList 或类似的），并将其设为只读：

```
private IList<Foo> m_list = new List<Foo>();
public IList<Foo> List {get { return m_list; } } 
```

优点：您可以修改实现，例如从列表切换到可观察列表。您可能需要创建`m_list`具体类型的成员而不是接口，例如使用附加功能。

使用可设置的外部列表，您会遇到一些问题。但是，在某些情况下需要这样做：

*   数据可以在外部创建，并且可能很大，并且经常更改（例如数万个项目）

*   外部列表应该在不同的实例之间共享

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:07:15.520

为什么不在类上使用 IEnumerator-Interface，如果必须使用 setter，请使用某种方法。

这样你也隐藏了实际的列表实现。

```
class FooBar : IEnumerator
{
  private Collection<Foo> col;

  public IEnumarator GetEnumerator()
  {
    return col.GetEnumerator();
  }

  public void SetList(Collection col)
  {
    this.col= col; // you can also make this more general and convert the parameter so it fits your listimpl.
  }
}

class Clazz
{
  private void WhatEver(){
    FooBar foobar = new FooBar();
    ...
    foreach(Foo f in foobar)
    {...}
  }
} 
```

# c#-3.0 - SQL Server 2008 Express 和 VFP 表之间的同步

> ID：887912
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:31:16.560
> 
>         
> 
> 标签：c#-3.0, synchronization, sql-server-2008-express, visual-foxpro

我正在寻找有关如何在两个数据库之间同步数据的意见和建议。

第一个数据库是 SQL Server 2008 Express，可在断开连接的笔记本电脑（无网络或互联网访问）上运行。第二个数据库（主）是在服务器上运行的 VFP 9.0。

当用户将他们的笔记本电脑连接到网络上时，我希望同步过程能够通过。

除了不同的数据库引擎之外，我还需要考虑以下项目：

1.  表不必具有相同的结构  

2.  主键不相同（SQL Server 中的 GUID 和 VFP 中的字符字段组合）  

3.  表的同步必须按照一定的顺序进行，以尊重父子关系  

4.  在 SQL Server 端的某些插入中，必须在 VFP 表中生成和同步新的主键  

5.  必须进行大量验证，有时需要用户的一些反馈  

6.  并非所有记录都需要同步  

7.  同步后需要删除 SQL Server 上的一些记录  

8.  需要考虑双方删除的记录  

9.  需要对 VFP 数据库进行最少的修改

我现在可能忘记了其他几点，但我想你明白我面临的挑战。我现在的猜测是我需要构建一个自定义同步模块，但在我继续之前我需要你的输入，以防我忽略了一些选项并获得一些关于如何解决这个问题的提示。

我快速查看了 Microsoft Sync Framework，但由于我的所有限制以及尚未构建 VFP 客户端 (AFAIK) 的事实，我认为它不会有很大帮助。

提前感谢您的反馈。

**更新**：笔记本电脑应用程序是 C# WinForm 应用程序，使用 SQL Server 2008 Express。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-07T17:52:58.547

情况和要求的复杂性使我相信您需要编写一个 Visual FoxPro 应用程序。Visual FoxPro 轻松连接到 SQL Server 2008 数据。代码的复杂性在于匹配需求并识别需要同步的数据，而不是语法。Visual FoxPro 的优势在于数据操作语言和连接到几乎任何数据源（本机 DBF、ODBC、ADO 和 XML）的能力。

SQL Server 可以通过 VFP 9 OLE DB 驱动程序读取 VFP 9 数据。您可以编写 T-SQL 存储过程来获取 VFP 数据。不确定它如何识别连接到网络的笔记本电脑。

另一种方法是使用 SQL Server XML Diffgrams。无论如何，我都不是这种方法的专家，但这将是您可以研究的东西。

由于我的专长是 Visual FoxPro，我会发现另一种方式更容易，但这只是我。你必须使用你为项目所拥有的资源的技能。

VFP 通过连接（DSN、ConnectionString）和涉及 SQL 直通（SQLConnect()、SQLExec() 和 SQLDisconnect()）、CursorAdapters、远程视图或三者组合的任何技术读取和写入 SQL Server 数据。

Visual FoxPro 程序还可以识别 Windows 事件，例如连接到网络。该应用程序可以安装在每台笔记本电脑上并运行以识别 Windows 事件。引发事件后，应用程序可以尝试连接到 SQL Server 数据库（可能正在连接到没有 SQL Server 可用的网络或不同的网络）。

连接后，它会运行逻辑来检查和同步数据库。

听起来您对写入笔记本电脑上的 VFP 9 数据的应用程序没有太多控制权。如果您确实可以控制写入 VFP 9 数据库的应用程序，您可能会考虑将应用程序更改为写入笔记本电脑上的 SQL Server Express 实例，然后您可以使用 SQL Server 复制来管理同步。虽然这不是一项简单的任务，而且 SQL Server 复制虽然在每个版本中都变得更好，但确实会导致 DBA 脱发。这条路线肯定有很多工作要做。

Rick Schummer Visual FoxPro MVP

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-07-17T01:58:24.427

我鼓励您再看看 MS 同步框架。我们有一种情况，我们希望偶尔将连接的 C# 客户端应用程序与我们的 Java/Oracle 后端同步。您可以为 C# 客户端使用同步框架提供程序，并为后端实现您自己的 KnowledgeSyncProvider 自定义子类。这将使您走到一半，并向您展示申请其余部分的良好模式。

# c# - 将 Web 服务引用添加到控制台应用程序

> ID：887914
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-05-20T13:31:18.947
> 
>         
> 
> 标签：c#, visual-studio, wcf, web-services, console

我在控制台应用程序中创建了一个简单的 Web 服务。(PersonService) 这是我下面的 Program.cs

我试图将服务引用添加到不同的控制台应用程序（PersonClient）我该怎么做？我尝试通过右键单击添加它，添加服务引用，指向引用等...但它不会工作。

```
 [DataContract]
        public class Person
        {
            [DataMember]
            public string FirstName { get; set; }

            [DataMember]
            public string LastName { get; set; }

        }

        [ServiceContract]
        public interface IPersonLookup
        {
            [OperationContract]
            Person GetPerson(int identifier);
        }

        public class PersonService : IPersonLookup
        {
            public PersonService()
            {
            }
            public Person GetPerson(int identifier)
            {
                Person p = new Person();
                p.FirstName="Jane";
                p.LastName="Doe";
                return p;
            }

        }

        class Program
        {
            static void Main(string[] args)
            {
                using (ServiceHost host = new ServiceHost(typeof(PersonService)))
                {
                    WSHttpBinding binding = new WSHttpBinding();
                    host.AddServiceEndpoint(typeof(IPersonLookup), binding, "http://localhost:9090/PersonService");
                    host.Open();
                    Console.WriteLine("Listening....");
                    Console.ReadLine();
                }

            }
        } 
```

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2012-04-17T11:49:49.257

**解决方案：**

1.  使用 Visual Studio 创建控制台应用程序。

2.  右键单击该项目，然后单击“添加服务引用...”。

3.  在窗口中，您会在底部找到“高级”按钮。

4.  单击按钮，它将打开服务参考设置窗口。它在底部有一个名为“添加 Web 引用”的按钮。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:34:23.373

您需要阅读有关 WCF MEX 端点的信息。这是[一篇可能会有所帮助](http://bloggingabout.net/blogs/dennis/archive/2006/11/09/WCF-Part-4-_3A00_-Make-your-service-visible-through-metadata.aspx)的博文。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:34:58.160

您有两个控制台 exe，一个运行`ServiceHost`- 对吗？在不调试的情况下运行服务器控制台；然后在 IDE 中将 WCF 引用添加到 url。它应该可以工作，但是当您查询 mex 时，它需要服务器（您的第二个控制台 exe）正在运行。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:35:28.783

添加 Web 服务引用时，您定义了服务的命名空间和“类名”。您必须添加命名空间引用（“using FooNameSpace;”）或使用服务的完全限定类名（“FooNameSpace.BarClass ws = new FooNameSapce.BarClass()”）；

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2019-01-03T18:32:19.503

*   创建一个控制台应用程序。

*   右键单击引用，然后单击添加服务引用。

*   点击底部的高级按钮。

*   在新窗口中单击添加 Web 引用。

    [![在此处输入图像描述](https://i.stack.imgur.com/20sja.png)](https://i.stack.imgur.com/20sja.png)

[![在此处输入图像描述](https://i.stack.imgur.com/kK7E3.png)](https://i.stack.imgur.com/kK7E3.png)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2020-09-19T16:04:43.367

还没有人提到在使用“添加服务参考”之前需要做几件事。

1.  使用 Visual Studio 2019 安装程序工具修改现有安装。

2.  检查“.NET 桌面开发工作负载”。（这将添加第二种类型的控制台应用程序。）

3.  现在启动 VS 2019，然后使用以下命令创建一个项目： Console App (.NET Framework) 重要提示：不要为 .NET Core 选择一个，否则它将没有“添加服务引用”选项！

4.  现在转到主菜单栏并选择 Project -> Add Service Reference。现在您可以添加您的参考。

快乐编码！

# php - 如何在php中检测用户是否已注销？

> ID：887919
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-05-20T13:32:11.210
> 
>         
> 
> 标签：php, mysql, session, redirect, logout

用户成功登录后，我将 login = true 存储在数据库中。但是，如何在不单击注销按钮的情况下关闭浏览器来检查用户是否已注销？另外，我如何将已经不活动 10 分钟的用户重定向到登录页面？

我正在使用 php 和 mysql。任何帮助，将不胜感激。

编辑：对不起，如果我的问题不清楚。我确实使用 session 来存储他们是否登录。但是，现在我想将信息存储在数据库中，以便我可以在其他页面上显示它们的状态。假设 user1 有 3 个朋友。当显示他所有的朋友时，user1 想知道他的朋友是在线还是离线。这就是我要的。有什么建议吗？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-05-20T13:50:39.487

**2017 edit:** These days, your best bet is using websockets to track presence on a page/site.

* * *

You cannot detect when a user closes their browser or navigates off your site with PHP, and the JavaScript techniques of doing so are so far from guaranteed as to be useless.

Instead, your best bet is most likely to store each user's last activity time.

*   Create a column in your user table along the lines of 'last_activity'.

*   Whenever a user loads a page, update their last_activity to the current time.

*   To get a list of who's online, just query the database for users with last_activity values more recent than 10/20/whatever minutes ago.

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-05-20T13:56:11.877

存储用户每个活动的时间戳。当该时间超过 10 分钟之前，请注销。

在 PHP 中，您可以执行以下操作：

```
session_start();
if (!isset($_SESSION['LAST_ACTIVITY'])) {
    // initiate value
    $_SESSION['LAST_ACTIVITY'] = time();
}
if (time() - $_SESSION['LAST_ACTIVITY'] > 3600) {
    // last activity is more than 10 minutes ago
    session_destroy();
} else {
    // update last activity timestamp
    $_SESSION['LAST_ACTIVITY'] = time();
} 
```

相反，可以在数据库上执行相同的操作。在那里，您甚至可以获得“当前”在线的用户列表。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:54:41.053

您想知道是否可以检测用户是否关闭了浏览器。您可以使用 javascript，但我不会依赖它（因为 javascript 很容易禁用）但是您不能使用 PHP，因为 PHP 仅在您请求页面时运行。不是在页面打开时。

为了安全起见，您应该跟踪用户的最后一次活动，如果已经过了几分钟（5/10），那么假设用户已经离开。如果他再次做某事（例如 6 分钟后），那么他就会重新上线。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:51:52.137

如果您尝试跟踪“在线”用户，那么您可能会考虑为单个用户使用会话，而不是将 login=true 存储在数据库中以向您或其他人显示他们的状态，而是存储上次活动时间用户。当您拉出在线用户列表时，创建您的 sql 查询以仅在过去 10 分钟内返回具有“last_activity”的用户。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:35:15.260

Normally you would put such information in sessions.

```
$_SESSION['user'] = "A user name"; 
```

Then when you want to logout you do:

```
session_destroy(); 
```

Some more info on sessions [here](http://nl3.php.net/manual/en/book.session.php) and a [tutorial](http://www.tizag.com/phpT/phpsessions.php).

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:36:09.953

Why dont you use session or cookies for this instead of inserting it in the database.
You can set the cookies by using setcookie() function or either you can make a session vaiable and store the value in it.

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:36:42.073

You would find it better to use the session to monitor the login status. 

[Read this information about sessions](http://www.php.net/manual/en/features.sessions.php)

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:54:10.213

AFAIK 您无法检查某人何时关闭浏览器窗口（或离开您的页面转到另一个页面），因此您需要按照上面其他人的建议检查活动。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:33:36.183

最好将 login=true 存储在会话变量中以检查用户是否登录。这将解决您的大部分问题；）

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T16:10:22.420

这是' [ceejayoz](https://stackoverflow.com/questions/887919/how-to-detect-if-the-user-is-logout-in-php/888029#888029) '之前所说的扩展。

让用户定期 ping 服务并告知他们仍然登录。将上次 ping 时间存储在会话中。如果最后一次 ping 会话大于所述时间，则再次 ping 以告知用户仍然存在。

将收到 ping 的时间存储在数据库中。如果收到的最后一个 ping 大于 keeplive 阈值，则认为用户已离开站点。

以下是一些未经测试的示例代码，供您开始使用。您可以使用“PING__FREQUENCY”来控制用户活动更新 last_activity 列的频率。

```
define(PING_FREQUENCY,300); //5 mins
if (($_SESSION['lastPingTime'] + PING_FREQUENCE) > time()) {
    stillLoggedIn(); //execute a function to tell that the user is still logged in
}

function stillLoggedIn() {
    //Do SQL update to mark the last activity time for the user
} 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T16:23:56.743

恕我直言，最好的方法是在每次更新用户记录时将上次活动时间戳存储在数据库中。注销或超时后（使用 cronjob 保持超时）只需将其设置为零值并用作标志。

```
$user = new User($user_id);
$user->logged_in = (bool)($last_activity > 0); 
```

有时你需要说 smth。就像“最后一次看到...”，然后离开最后一个活动，只需在您的用户表中添加一个布尔标志（tinyint）logged_in。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2014-06-22T13:45:27.463

您可以通过多种方式组合来做到这一点，我猜最多 2 种，其中一个打扰最后一个活动，您将它与使用 jQuery 来检查不活动状态相结合，即一段时间内没有鼠标或键盘事件，比如 10到 20 分钟，然后一旦确认空闲时间，您对 php 文件进行 ajax 调用，该文件将更新您的数据库表，显示用户离线。

你可以从：

```
<script type="text/javascript">
idleTime = 0;
$(document).ready(function () {
//Increment the idle time counter every minute.
var idleInterval = setInterval(timerIncrement, 60000); // 1 minute

//Zero the idle timer on mouse movement.
$(this).mousemove(function (e) {
    idleTime = 0;
});
$(this).keypress(function (e) {
    idleTime = 0;
});
});

function timerIncrement() {
idleTime = idleTime + 1;
if (idleTime > 19) { // 20 minutes
    $.ajax({
     url: 'update_user.php',
     type: 'POST',
     datatype: 'json',
     data: someData
    });
}
}
</script> 
```

# jquery - jQuery防止按钮点击回发

> ID：887923
> 
>         
> 
> 赞同：29
> 
>         
> 
> 时间：2009-05-20T13:33:39.083
> 
>         
> 
> 标签：jquery

如何将点击事件附加到按钮并防止回发？

我的代码似乎不起作用。

```
$('#btnNext').click(function() {
        return false;
    }); 
```

* * *

## 回答 #1

> 赞同：59
> 
>             
> 
> 时间：2009-05-20T13:35:30.813

```
$('#btnNext').click(function(e) {
        e.preventDefault();
    }); 
```

* * *

## 回答 #2

> 赞同：21
> 
>             
> 
> 时间：2014-05-30T15:16:08.490

我正在使用一个按钮，发现如果你想阻止按钮进行自动回发，你需要将类型指定为“按钮”。例如：

```
<button id="saveButton">Save</button> 
```

--这将生成一个自动回发（在 IE 中测试）

```
<button type="button" id="saveButton">Save</button> 
```

--这不会

希望这可以帮助某人。  

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2016-04-04T07:37:56.740

**在 Asp.net 中防止页面回发按钮单击使用 preventDefault() 函数**

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head runat="server">
        <title>WebForm1</title>
        <script src="js/jquery-2.2.2.js" type="text/javascript"></script>
        <script>
            $(document).ready(function () {
                $("#btnshow").click(function (e) {
                    e.preventDefault();
                    $("#Label1").show();
                });
                $("#btnhide").click(function (e) {
                    e.preventDefault();
                    $("#Label1").hide();
                })
            });
        </script>
    </head>
    <body>
        <form id="form1" runat="server">
        <div>

        </div>
            <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
            <asp:Button ID="btnshow" runat="server" Text="Show" />
            <asp:Button ID="btnhide" runat="server" Text="Hide" />
        </form>

    </body>
    </html> 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2014-09-25T11:19:18.350

在按钮标签内，使用 type="Button" 来防止回发。

# c# - 如何从应用程序中向 PowerShell 公开功能

> ID：887924
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-20T13:34:11.330
> 
>         
> 
> 标签：c#, powershell

我正在收听[Scott Hanselman 所做](http://www.hanselminutes.com/default.aspx?showID=180)的关于 PowerShell 2.0 的播客。在那一集中，他们谈到了扩展您的应用程序以公开 PowerShell 功能的可能性。

现在这听起来很有趣。你们有没有人做过这样的扩展来暴露你的应用程序中的功能？如果是这样，什么样的功能？

编辑：更准确地说：我对在我的应用程序中托管 PowerShell 不感兴趣。我对使用类似 API 的界面打开我的应用程序更感兴趣。因此，PowerShell Provider 似乎是我正在寻找更多洞察力的技术。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T14:24:39.510

有多种方法可以在自定义应用程序中利用 PowerShell。PowerShell 自动化引擎的美妙之处在于您不必处理处理参数、格式化输出以及您必须自己处理的一堆其他 PITA 事情。要在 PowerShell 中将对象扔到管道中，请覆盖 ProcessRecord 方法并调用 WriteObject

```
protected override void ProcessRecord()
{
  // Get the current processes
  Process[] processes = Process.GetProcesses();

  // Write the processes to the pipeline making them available
  // to the next cmdlet. The second parameter of this call tells 
  // PowerShell to enumerate the array, and send one process at a 
  // time to the pipeline.
  WriteObject(processes, true);
} 
```

您可以编写允许管理员自动化应用程序服务器端的 Cmdlet。Cmdlet 始终是具有动词-名词命名约定的基于任务的功能单元。例如，Get-Process 或 Restart-Service。Cmdlet 只做一件事，而且做得很好。将 cmdlet 组合在一起会带来各种不可思议的力量。

此外，如果您的应用程序有某种数据存储，也可以编写一个提供程序，允许某人使用 cd（set-location）和 md（new-item）等 cmd 浏览和/或管理数据存储。提供者是 PS 团队编写的，因此您可以使用 cd hklm: 进入注册表或使用 cd cert 进入证书存储区：

您还可以在应用程序中托管 PowerShell 本身。

[这里](http://msdn.microsoft.com/en-us/library/ms714469(VS.85).aspx)有关于 MSDN 上所有这三个选项的一些很好的信息

考虑到对提供程序的兴趣，这里有一些关于[如何创建 PowerShell 提供程序的示例。](http://msdn.microsoft.com/en-us/library/ms714636(VS.85).aspx)

已经有一些关于设计和使用一组 cmdlet 或使用 Provider 公开某些内容的讨论。实现提供程序时，还会获得一些 cmdlet，例如 Get-item、New-item、Get-Location、Set-Location。但是，我发现除了提供程序之外，还有一些用于特定任务的 cmdlet 会很有帮助。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T18:28:25.090

这是关于powershell这一面的一本好书（在大多数书中没有得到太多的报道）。  

[专业的 Poweshell 编程](https://rads.stackoverflow.com/amzn/click/com/0470173939)

使用这本书（以及一些 msdn 之旅），我能够在一天内启动并运行一个自定义的 powershell 主机。几天后，我有了与 gui 交互的自定义​​ cmdlet（用于构建树视图、网格、图表、菜单等）

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-21T20:53:31.763

有几个级别的 PowerShell 支持，并没有多少人能很好地解释这一点。

1.  .NET 类。是的，任何带有 .NET API 的东西都可以通过 PowerShell 访问，而无需您做任何额外的事情！但是，您并没有获得所有额外的 PowerShell 功能。最少的工作量。

2.  带有 cmdlet、脚本和/或函数的 PowerShell 模块。这将需要编写一些特定于 PowerShell 的代码来包装您现有的 API。如果你走这条路，你应该坐下来学习 PowerShell 设计的最佳实践，并考虑你的 PowerShell 支持。这需要做更多的工作才能正确完成。

3.  PowerShell 提供程序。提供者是一种特殊情况，并非所有事物都应该有提供者。您需要真正考虑您的信息在文件系统视图中是否真的有意义。

这不适用于您的问题，但为了完整起见，我会添加它。

4.  托管 PowerShell。您可以在您的应用程序中托管 PowerShell 代码，或从您的应用程序访问 PowerShell 功能。这在某些情况下是有意义的，但也是 PowerShell 支持的一个特殊案例。

# jquery - JQuery window width not correct in Chrome

> ID：887931
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-20T13:35:08.550
> 
>         
> 
> 标签：jquery, google-chrome, window, width

I have created a plugin which i have cut down to the bare bones of a plugin (i.e. no functionality, just the structure) to debug this issue and it still exists. It deals with resizing divs and bases this on the document's width. 

The problem is that the documents reported width is reduced by 17px from its actual width and thus doesnt size the divs correctly. 

I have put in alerts to find out where the problem occurs: 
Before "ready" function: 1780px (correct width) 
Inside the "ready" function: 1763px 
Inside the Plugin: 1763px 
(all values returned from "document.width" and "$(document).width()" with same results) 

This is only happening within Chrome and still remains even with the plugin reduced to effectively nothing. 

Any thoughts on why this is happening?

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2011-03-08T10:04:06.783

取自[jQuery 文档](http://api.jquery.com/ready/)：

> 虽然 JavaScript 提供了在页面呈现时执行代码的加载事件，但在完全接收到所有资产（例如图像）之前，不会触发此事件。在大多数情况下，只要完全构建了 DOM 层次结构，就可以运行脚本。传递给 .ready() 的处理程序保证在 DOM 准备好后执行，因此这通常是附加所有其他事件处理程序和运行其他 jQuery 代码的最佳位置。当使用依赖 CSS 样式属性值的脚本时，在引用脚本之前引用外部样式表或嵌入样式元素很重要。
> 
>   
>   
> 
> 如果代码依赖于加载的资产（例如，如果需要图像的尺寸），则应将代码放置在加载事件的处理程序中。

你可能应该使用

```
$(window).load(function() {}); 
```

作为触发事件

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-01-22T14:29:42.260

I have found that jQuery(window).width() return a wrong value in Safari and Chrome. 

# java - StackOverflowError 在 Solaris 上，但不在 Linux/Windows 上

> ID：887935
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T13:35:19.550
> 
>         
> 
> 标签：java, xml, xerces

我有一个 Java 应用程序，它使用 Xerces 解析大型 xml 模式 (.xsd)，它在 Linux 和 Windows 上运行良好，但在 Solaris 上给出了 StackOverflowError，输入和配置完全相同。我知道 Xerces 使用递归来验证 xml 模式，但由于它在 Windows 和 Linux 上没有出现任何问题，我非常有信心它可以在任何地方运行。

为什么会这样？有解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T13:45:11.307

根据[此页面](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)，默认堆栈大小取决于操作系统。

**火花：** 512

**Solaris x86：** 320（在5.0及更早版本之前为256）*（更新：根据[this page](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4689767)，主线程堆栈的大小来自ulimit。主线程堆栈被vm人为减少到-Xss值）*

**Sparc 64 位：** 1024

**Linux amd64：** 1024（5.0及更早版本为0）*（更新：默认大小来自ulimit，但我可以用-Xss减小）*

**Windows：** 256（也在[这里](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4689767)）

**您可以使用-Xss**标志更改默认设置。例如：

```
java ... -Xss1024k ... <classname> 
```

将默认堆栈大小设置为 1Mb。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:42:29.957

请注意，不同架构的 Hotspot VM 参数默认值[可能](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)不同。我将确定 Windows/Linux 下的默认值，并尝试为 Solaris 设置这些值。

例如：

> -XX:ThreadStackSize=512 - 线程堆栈大小（以千字节为单位）。(0 表示使用默认堆栈大小) [Sparc: 512; Solaris x86：320（在 5.0 及更早版本中为 256）；Sparc 64位：1024；Linux amd64：1024（在 5.0 及更早版本中为 0）；所有其他 0。]

（我并不是说这个特定的参数是问题。只是强调它在不同操作系统下的差异）

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:44:59.450

这可能是因为平台之间的默认最大堆栈大小不同。

您可以使用 JVM 的 -Xss 命令行指定堆栈大小，例如

java -Xss256k

对于 256k 堆栈。这是基于每个线程分配的。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-05-20T13:43:45.757

来自 javadoc 的引用：

**StackOverflowError**：

当由于应用程序递归太深而发生堆栈溢出时抛出。

为每个方法创建的堆栈有多大，**取决于实现**。这就是原因。

# c# - 无法将类型“字符串”转换为“整数？” 通过引用转换、装箱转换、拆箱转换、包装转换或空类型转换

> ID：887943
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-20T13:36:29.983
> 
>         
> 
> 标签：c#, int, type-conversion

C# 接受以下内容：

```
object o = "hello";
int? i = o as int?;

if (i == null) {
    // o was not a boxed int
}
else {
    // Can use i.Value to recover the original boxed value
} 
```

但不是

```
String o = "hello";
int? i = o as int?;

if (i == null) {
    // o was not a boxed int
}
else {
    // Can use i.Value to recover the original boxed value
} 
```

我只是想知道`as`C# 中关键字的行为。

与 Java 相同，这将失败：

```
Object test1 = "hello";
Integer test2 = (Integer) test1;
String test3 = "hello";
Integer test4 = (Integer) test3; //compilation error 
```

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-05-20T13:39:16.640

编译器知道一个字符串永远不可能是一个`int?`，所以它会告诉你。这并不意味着它`int?`没有用。您尝试的用例与正常用例相去甚远。正常的是“我想表示一个整数以及该值丢失/未知的可能性”。为此，`int?`效果非常好。

为什么你*希望*你的原始代码能够工作？为什么会有帮助？

请注意，您*可以*使用`as`可空类型进行拆箱：

```
object o = "hello";
int? i = o as int?;

if (i == null)
{
    // o was not a boxed int
}
else
{
    // Can use i.Value to recover the original boxed value
} 
```

编辑：看到您的评论后，您不会`as`用来解析事物。您可能想使用[`int.TryParse`](http://msdn.microsoft.com/en-us/library/system.int32.tryparse.aspx)：

```
string text = "123":
int value;
if (int.TryParse(text, out value))
{
    Console.WriteLine("Parsed successfully: {0}", value);
}
else
{
    Console.WriteLine("Unable to parse text as an integer");
} 
```

如果您确定该字符串是一个整数（否则就是一个错误），那么您可以使用[`int.Parse`](http://msdn.microsoft.com/en-us/library/system.int32.parse.aspx)：

```
int value = int.Parse(text); 
```

如果解析失败，这将引发异常。

另请注意，这两种方法都允许您指定格式提供程序（通常是文化信息），它允许您表达数字在该格式中的表示方式（例如千位分隔符）。

编辑：在回答您的新问题时，编译器会阻止这种情况，因为它知道字符串*不可能*是装箱的 int - 转换永远不会成功。当它只知道原始值是一个对象时，它*可能会*成功。

例如，假设我对你说，“这是一个形状：它是正方形吗？” 这是一个明智的问题。问它是有道理的：不看形状就无法判断。

然而，如果我说：“这是一个三角形：它是一个正方形吗？” 那么你就有理由当着我的面笑，因为三角形不可能是正方形——这个问题没有意义。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T13:37:42.430

诠释？表示可以为空的整数类型，而不是可以包含任何其他类型变量的 int。

如果你想要一个可以包含 int 或字符串的变量类型，你必须使用一个对象，或者我想是一个字符串，然后过着充满类型转换的生活。不过，我不知道你为什么要这样做。

诠释？允许您存储任何整数值或空值。当说“这个人下了多少订单”这个问题的答案合法地是“我不知道”而不是订单数量时，这很有用，或者为零，这将是“我知道这个人从来没有下了订单”。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-06-25T06:02:28.893

我想补充一些进一步的信息。

另一种情况，为什么强制转换无效并且编译器在编译时抛出错误是**System.String**被标记为*seal*。因此编译器知道**System.String**从哪些类型继承，以及您可以使用*as*运算符将字符串转换为哪些类型。

由于关键字*sealed*，编译器还知道您*不能从***System.String**继承来添加功能或实现一些额外的接口。

下面的代码是一个示例，编译器会在编译时抛出以下错误

> 无法通过引用转换、装箱转换、拆箱转换、包装转换或空类型转换将类型“SealedClass”转换为“ICastToInterface”

```
public class UnsealedClass {
  // some code
}

public sealed class SealedClass {
  // some code
}

public interface ICastToInterface {
  // some code
}

public class Test {

  public Test() {
    UnsealedClass unsealedClass = new UnsealedClass();

    SealedClass sealedClass = new SealedClass();

    ICastToInterface unsealedCast = unsealedClass as ICastToInterface;  // This works fine

    ICastToInterface sealedCast = sealedClass as ICastToInterface; // This won´t compile, cause SealedClass is sealed
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:38:33.457

但您可以检查 null 的值并将其设置为 null。

```
int? blah;
if (blah == null)
{} 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:52:52.960

诠释？是一个可为空的整数，它与强制转换和 as 关键字无关。"String" 是一个字符串类型的对象，它不能转换为 int（可空或不可空）。

as 关键字实际上与使用方括号进行强制转换相同，只是它不会返回错误，它将对象设置为 null：

```
int i = 1;

object o = i; //boxing

int j = (int)o; //unboxing 
```

第一个示例的工作原理是分配给 o 的对象是 int。

现在考虑：

```
string i = "MyString";

object o = MyString;

 int j = (int)o //unboxing raises exception

 int j = o as int; //raises compilation Error as int is not nullable
 int? j = o as int?; /// o == null 
```

我希望这有助于解释这两个概念之间的区别。

理查德

# php - 从 Zend Framework 应用程序获取所有模块、控制器和操作

> ID：887947
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-05-20T13:37:06.767
> 
>         
> 
> 标签：php, zend-framework

我想为 ACL 管理创建一个 Zend 控制器，所以我的问题是：如何在 Zend 应用程序中获取所有模块名称、控件名称和操作名称来构建 ACL 控件？

我使用 Zend_Navigation，如果 ACL 中不存在资源 Zend_Navigation 会抛出异常。我想使用数据库来拒绝和允许访问。所以我必须先建立数据库。如果我必须用手来做，那做起来很痛苦。

* * *

## 回答 #1

> 赞同：25
> 
>             
> 
> 时间：2009-07-27T16:46:53.920

这可能是一个老问题，但这就是我这样做的方式......

```
//        $front = Zend_Controller_Front::getInstance(); // use this line instead on a model class
    $front = $this->getFrontController(); // this in controller
    $acl   = array();

    foreach ($front->getControllerDirectory() as $module => $path) {
        foreach (scandir($path) as $file) {

            if (strstr($file, "Controller.php") !== false) {

                include_once $path . DIRECTORY_SEPARATOR . $file;
                $class = substr($file,0,strpos($file,".php"));

                if (is_subclass_of($class, 'Zend_Controller_Action')) {

                    $controller = strtolower(substr($file, 0, strpos($file, "Controller")));
                    $methods = array();

                    foreach (get_class_methods($class) as $method) {
                        if (strstr($method,"Action") != false) {
                            array_push($methods,substr($method,0,strpos($method,"Action")));
                        }
                    }
                }

                $acl[$module][$controller] = $methods;
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-05-21T21:50:32.773

我创建了一个函数，可以从 zend 应用程序中获取所有操作、控制器和模块。这里是：

```
$module_dir = substr(str_replace("\\","/",$this->getFrontController()->getModuleDirectory()),0,strrpos(str_replace("\\","/",$this->getFrontController()->getModuleDirectory()),'/'));
    $temp = array_diff( scandir( $module_dir), Array( ".", "..", ".svn"));
    $modules = array();
    $controller_directorys = array();
    foreach ($temp as $module) {
        if (is_dir($module_dir . "/" . $module)) {
            array_push($modules,$module);
            array_push($controller_directorys, str_replace("\\","/",$this->getFrontController()->getControllerDirectory($module)));
        }
    }

    foreach ($controller_directorys as $dir) {
        foreach (scandir($dir) as $dirstructure) {
            if (is_file($dir  . "/" . $dirstructure)) {
                if (strstr($dirstructure,"Controller.php") != false) {
                    include_once($dir . "/" . $dirstructure);
                }
            }

        }
    }

    $default_module = $this->getFrontController()->getDefaultModule();

    $db_structure = array();

    foreach(get_declared_classes() as $c){
        if(is_subclass_of($c, 'Zend_Controller_Action')){
            $functions = array();
            foreach (get_class_methods($c) as $f) {
                if (strstr($f,"Action") != false) {
                    array_push($functions,substr($f,0,strpos($f,"Action")));
                }
            }
            $c = strtolower(substr($c,0,strpos($c,"Controller")));

            if (strstr($c,"_") != false) {
                $db_structure[substr($c,0,strpos($c,"_"))][substr($c,strpos($c,"_") + 1)] = $functions;
            }else{
                $db_structure[$default_module][$c] = $functions;
            }
        }
    }       
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-01-17T04:37:33.420

实际上，我发现拥有一个易于使用的反射引用的最佳方法是递归地标记正确的目录，然后构建一个 xml 文档。缓存 xml 文档以提高速度并使用 xpath 检索数据。

该插件构建反射 xml 并将其缓存以供以后使用。我已经将这段代码从它的原始实现中取出，所以它更多的是给你一种感觉，而不是复制和粘贴。

当然，数据库在这里也可以正常工作。但是，如果您试图限制每页的查询，缓存的 xml 文档可以很好地工作。

```
class My_Reflection_Plugin extends My_Controller_Plugin_Abstract
{
    public function routeShutdown(Zend_Controller_Request_Abstract $request)
    {
        $cache = $this -> getCacheManager() -> getCache('general');

        if (!$xml = $cache->load("Reflection"))
        {
            $paths = array(
                PATH_APPLICATION . "/Core",
                PATH_SITE . "/Project"
            );

            foreach ($paths as $path)
            {
                $this -> inspectDir($path);
            }

            $cache -> save($this->getReflectionXML(), "Reflection");
        }
        else
        {
            $this -> getReflectionXML($xml);
        }
    }

    private function inspectDir($path)
    {
        $rdi = new RecursiveDirectoryIterator($path);
        $rii = new RecursiveIteratorIterator($rdi);
        $filtered = new My_Reflection_Filter($rii);

        iterator_apply($filtered, array($this, 'process'), array($filtered));
    }

    private function process($it = false)
    {
        $this -> getReflectionXML() -> addItem($it -> current());

        return true;
    }
} 
```

标记化发生在过滤器内部：

```
class My_Reflection_Filter extends FilterIterator
{
    public function accept()
    {
        $file = $this->getInnerIterator()->current();

        // If we somehow have something other than an SplFileInfo object, just
        // return false
        if (!$file instanceof SplFileInfo) {
            return false;
        }

        // If we have a directory, it's not a file, so return false
        if (!$file->isFile()) {
            return false;
        }

        // If not a PHP file, skip
        if ($file->getBasename('.php') == $file->getBasename()) {
            return false;
        }

        // Resource forks are no good either.
        if (substr($file->getBaseName(), 0, 2) == '._')
        {
            return false;
        }

        $contents = file_get_contents($file->getRealPath());
        $tokens   = token_get_all($contents);

        $file->className = NULL;
        $file->classExtends = NULL;
        $file->classImplements = array();

        $last = null;
        while (count($tokens) > 0)
        {
            $token = array_shift($tokens);

            if (!is_array($token))
            {
                continue;
            }

            list($id, $content, $line) = $token;

            switch ($id)
            {
                case T_ABSTRACT:
                case T_CLASS:
                case T_INTERFACE:
                        $last = 'object';
                    break;
                case T_EXTENDS:
                        $last = "extends";
                    break;
                case T_IMPLEMENTS:
                        $last = "implements";
                    break;
                case T_STRING:
                        switch ($last)
                        {
                            case "object":
                                    $file -> className = $content;
                                break;
                            case "extends":
                                    $file -> classExtends = $content;
                                break;
                            case "implements":
                                    $file -> classImplements[] = $content;
                                break;
                        }
                    break;
                case T_WHITESPACE:
                        // Do nothing, whitespace should be ignored but it shouldnt reset $last.
                    break;
                default:
                        // If its not directly following a keyword specified by $last, reset last to nothing.
                        $last = null;
                    break;
            }
        }

        return true;
    }
} 
```

一旦你的反射 xml 填充了你需要的任何信息，你的 acl 插件就可以在它之后使用 xpath 查询该信息。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T14:33:43.377

我认为 Zend 中没有解决方案。你将不得不自己做......

一种方法是列出所有类，并检查这些类是否扩展（例如） Zend_Controller_Action 类......

检查 php 函数[get_declared_classes](http://php.net/manual/en/function.get-declared-classes.php)和[is_subclass_of](http://www.php.net/manual/en/function.is-subclass-of.php)

```
foreach(get_declared_classes() as $c){
  if(is_subclass_of($c, 'Zend_Controller_Action')){
     ...
  }
} 
```

# statistics - 如何对调查中问题的自由格式答案进行分类和表格化？

> ID：887954
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-20T13:37:45.673
> 
>         
> 
> 标签：statistics, analysis, survey, freeform

我想分析网络调查的答案（如果有兴趣，可以[使用 Git User's Survey 2008 ）。](http://git.or.cz/gitwiki/GitSurvey2008)其中一些问题是自由形式的问题，例如“您是如何听说 Git 的？”。超过 3,000 条回复完全手动分析这些回复是不可能的（尤其是本次调查中有相当多的自由形式问题）。

我如何至少半自动地将这些回复（可能基于响应中使用的关键词）分组（即程序可以要求确认），然后如何将这些回复（每个类别中的条目数）表格化 -表格回复（答案）？一个答案可以属于多个类别，尽管为简单起见，可以假设类别是正交/互斥的。

我想知道的至少是要搜索的*关键字，或者要使用的***算法**（一种方法）。我更喜欢**Perl**（或 C）中的解决方案。

* * *

### 可能的解决方案 1。（部分）：贝叶斯分类

*(添加于 2009-05-21)*  

我想到的一种解决方案是使用算法（及其背后的数学方法）进行贝叶斯垃圾邮件过滤，而不是一两个类别（“垃圾邮件”和“火腿”），会有更多；并且类别本身将自适应/交互地创建。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:46:50.227

你不会喜欢这个的。但是：如果您进行调查并且包含许多自由形式的问题，那么您最好准备好手动对它们进行分类。如果那是不可能的，那么您为什么首先会提出这些问题？

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T21:11:02.780

**文本::Ngrams + 算法::集群**

1.  [使用Text::Ngrams](http://search.cpan.org/~vlado/Text-Ngrams-2.002/)为每个答案（例如字数）生成一些向量表示。

2.  [使用Algorithm::Cluster](http://bonsai.ims.u-tokyo.ac.jp/~mdehoon/software/cluster/software.htm)对向量进行聚类以确定分组以及与组对应的关键字。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-21T01:26:18.910

过去，我在相当大的语料库中使用过类似的强制方法。Lingua::EN::Tagger，Lingua::Stem::En。此外，Net::Calais API（不幸的是，汤普森路透社并不完全对开源友好）对于从文本中提取命名实体非常有用。当然，一旦你用这些东西清理了原始数据，实际的数据处理取决于你。我倾向于怀疑频率计数和输出的一些机械土耳其人交叉验证足以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:45:28.717

寻找常用词作为关键字，但不要使用诸如“the”、“a”等无意义的词。之后，您将进入我无法理解的[自然语言](http://en.wikipedia.org/wiki/Natural_language_processing)内容。

我突然意识到，完美的解决方案是 AAI（人工智能）。使用亚马逊的[Mechanical Turk](https://www.mturk.com/mturk/welcome)。Perl 绑定是[Net::Amazon::MechanicalTurk](http://search.cpan.org/dist/Net-Amazon-MechanicalTurk/lib/Net/Amazon/MechanicalTurk.pm)。每个回复一美分，有相当大的重叠（比如每个回复三个人），大约是 90 美元。

# asp.net - 带有链接 DataSourceId 的 ASP.Net Datalist 不会重新加载

> ID：887960
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:38:25.940
> 
>         
> 
> 标签：asp.net, datasource, datalist, multiview

我有一个 MultiView 控件，它有一个视图，其中填充了 DataList，如下所示：

```
<asp:DataList ID="DataList6" runat="server" DataSourceID="SqlDataSource11" Width="100%">
<ItemTemplate>
   <!-- rendering is left out to keep this sample simple -->
</ItemTemplate>
</asp:DataList> 
```

问题是当我切换到MultiView控件的另一个视图时，编辑这个DataList的内容并保存数据后返回，数据没有刷新。我检查了数据库，我确定数据已经改变。

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:45:21.370

尝试`DataList6.DataBind`

# c++ - 有没有使用 STL 在容器中查找最大元素的便捷方法？

> ID：887966
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T13:39:47.323
> 
>         
> 
> 标签：c++, stl

有没有办法使用 STL 在容器中找到最大的容器？ATM，我有这种相当幼稚的做法：

```
 int main()
{
        std::vector<std::vector<int> > v;

        ...

        unsigned int h = 0;

        for (std::vector<std::vector<int> >::iterator i = v.begin(); i != v.end(); ++i) {
                if (*i.size() > h) {
                        h = *i.size();
                }
        }
} 

```

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-05-20T13:45:05.207

您始终可以使用[std::max_element](http://en.cppreference.com/w/cpp/algorithm/max_element)并传递一个自定义比较器来比较两个`std::vector<int>`作为参数的大小。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:44:14.023

您是否考虑过使用 STL 排序方法对容器进行排序？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:44:54.617

您可以使用快速选择，然后选择最末端的值：

[快速选择](http://goanna.cs.rmit.edu.au/~stbird/Tutorials/QuickSelect.html)

# .net - How can I modify a given xpath string to only have nodes that exist in a specific xml document

> ID：887968
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:40:03.720
> 
>         
> 
> 标签：.net, xml, xpath

I build a xpath string based on all filled-out fields in a form submitted by a user. In my xml document, not all form fields necessarily exist as nodes. When I try to do 

doc.SelectNodes(xpath);

I get an exception  System.Xml.XPath.XPathException that my xpath has an invalid token.

How can I modify the xpath string to only include those fields that do exist in the xml document and disregard all the others?

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-06-29T15:56:58.257

当您收到无效令牌错误时，这意味着您的查询中有一些无效字符或无效 xpath。xml 示例和一些 xpath 示例将非常有帮助。

# authentication - 使用 LDAP 身份验证登录到 2 层的 Peoplesoft App-Designer

> ID：887970
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-20T13:40:27.917
> 
>         
> 
> 标签：authentication, ldap, peoplesoft, 2-tier

我有一个启用了 LDAP 登录的数据库。通过 PIA 登录或通过应用程序服务器登录 app-designer 时，它工作正常。

我需要让 app-designer 允许我使用 LDAP 身份验证以 2 层模式登录。如果没有定制，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-29T06:16:17.387

我不认为这是可能的。2 层直接登录到数据库，更重要的是，不运行为 LDAP 身份验证调用的登录人员代码。事实上，2 层实际上只是一个不运行人员代码的 Win32 应用程序——它不是一个人员软件“应用程序”。peoplesoft 提供了一个用户标注 dll，以及一些关于您必须做什么才能使用它的少量文档 - 但同样，可能无法满足您的需求。如果您想使用这些登录身份进行 2 层访问，您可能需要使用 ldap 同步在线应用程序引擎作业将您的 ldap 用户拉入安全表。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-06-28T19:29:55.373

为 App Designer 使用 LDAP 身份验证的唯一交付方式是通过应用服务器使用连接 3 层。只有使用 3 层连接才能执行 Signon PeopleCode。使用 2 层，LDAP 服务器没有挂钩。

您可以考虑使用 Gray Sparling Desktop Single Signon，它确实与 App Designer 集成并使用 Windows 和 NTLM 来获取 Active Directory 身份验证。如果您的 Windows 机器使用域进行身份验证，这将为您提供一定程度的 LDAP 身份验证。但它是您需要购买的附加产品。

否则，正如 Epictetus 所提到的，如果您已将 LDAP 用户名与您的 PeopleSoft 数据库同步并使用存储在 PSOPRDEFN 中的本地密码，则您可以使用它。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2015-07-30T14:47:26.067

我看到的一个问题是，当您使用 LDAP 登录时使用 LDAP 和 2 层时，它会以某种方式解密 PSOPRDEFN 中的密码。同一帐户下一次登录 2 层抛出错误无法登录请使用数据移动器加密密码*加密密码。如果您加密该用户密码，则在该用户下一次 LDAP 登录后会发生相同的结果。

# php - PHP：判断文件是否存在？

> ID：887982
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-20T13:43:52.933
> 
>         
> 
> 标签：php, php4

我需要能够判断图像是否存在于目录中。给定文件名和目录，我如何判断它是否存在？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-20T13:44:47.783

```
file_exists($filename); 
```

[http://www.php.net/file_exists](http://www.php.net/file_exists)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-20T13:45:24.940

```
$dir = '/var/img/'; $name = 'img.jpg';

echo is_file($dir.$name); 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:45:47.267

```
bool file_exists(string $filename) 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:46:29.993

如果您需要了解的不仅仅是 file_exists()，您应该查看 stat 函数...它可以告诉您文件是否存在，如果存在，它有多大，以及它是什么类型的文件（以及大约十几个其他的东西)...

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-20T13:47:46.683

```
<?php
$filename = '/path/to/foo.txt';

if (file_exists($filename)) {
    echo "The file $filename exists";
} else {
    echo "The file $filename does not exist";
}
?> 
```

来源：http: [//in.php.net/file_exists](http://in.php.net/file_exists)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T16:33:12.903

你在谈论图像......可能你试图找到一种方法来放置一些“无图片”图像而不是不存在？

如果是的话 - 看看这样的[东西](http://www.boutell.com/newfaq/creating/emitimage.html)。否则就像人们之前所说的那样阅读手册......

# c# - 使用 C# HttpHandler webservice 创建 PNG 图像

> ID：887985
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-05-20T13:44:10.420
> 
>         
> 
> 标签：c#, web-services, png, httphandler, image

我希望能够创建一个简单的 PNG 图像，例如使用基于 ac# web 的服务生成图像的红色方块，从`<img src="myws.ashx?x=100>`HTML 元素调用。

一些示例 HTML：

```
<hmtl><body>
     <img src="http://mysite.com/webservice/rectangle.ashx?size=100">
</body></html> 
```

有没有人可以拼凑一个简单的（工作的）C#类来让我开始？一旦出发，我确信我可以完成这件事，真正做我想做的事。

*   最终目标是为显示性能指标等的数据驱动网页创建简单的红色/琥珀色/绿色 (RAG) 嵌入式状态标记*

*   我希望它使用 PNG，因为我预计将来会使用透明度*

*   ASP.NET 2.0 C# 解决方案请...（我还没有生产 3.5 盒子）

蒂亚

**解决方案**

矩形.html

```
<html>
<head></head>
<body>
    <img src="rectangle.ashx" height="100" width="200">
</body>
</html> 
```

矩形.ashx

```
<%@ WebHandler Language="C#" Class="ImageHandler" %> 
```

矩形.cs

```
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Web;

public class ImageHandler : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        int width = 600; //int.Parse(context.Request.QueryString["width"]);
        int height = 400; //int.Parse(context.Request.QueryString["height"]);

        Bitmap bitmap = new Bitmap(width,height);

        Graphics g = Graphics.FromImage( (Image) bitmap );
        g.FillRectangle( Brushes.Red, 0f, 0f, bitmap.Width, bitmap.Height );    // fill the entire bitmap with a red rectangle

        MemoryStream mem = new MemoryStream();
        bitmap.Save(mem,ImageFormat.Png);

        byte[] buffer = mem.ToArray();

        context.Response.ContentType = "image/png";
        context.Response.BinaryWrite(buffer);
        context.Response.Flush();
    }

    public bool IsReusable {
        get {return false;}
    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
>             
> 
> 时间：2009-05-20T13:52:56.143

Web 服务，尤其是 SOAP 期望诸如带有调用细节的 XML 信封之类的东西。最好使用`HttpHandler`.

像这样的东西：

```
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Web;

public class ImageHandler : IHttpHandler
{

    public void ProcessRequest(HttpContext context)
    {
        int width = int.Parse(context.Request.QueryString["width"]);
        int height = int.Parse(context.Request.QueryString["height"]);

        using (Bitmap bitmap = new Bitmap(width,height)) {

            ...

            using (MemoryStream mem = new MemoryStream()) {
                bitmap.Save(mem,ImageFormat.Png);
                mem.Seek(0,SeekOrigin.Begin);

                context.Response.ContentType = "image/png";

                mem.CopyTo(context.Response.OutputStream,4096);
                context.Response.Flush();
            }
        }
    }

} 
```

这当然是非常粗糙的。你会这样称呼它：

```
<img src="myhandler.ashx?width=10&height=10"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-20T13:47:47.417

Web 服务不适合这种情况。它返回特定格式的消息，通常是 SOAP，因此它不能是图像。

请改用常规 Web 表单，在其中删除除`@page`指令之外的所有标记。使用该`BinaryWrite`方法将图像数据写入响应流。

例子：

```
byte[] imageData;
using (Bitmap image = new Bitmap(10,10)) {
   using (Graphics g = Graphics.FromImage(image)) {
      g.Clear(Color.Red);
   }
   using (MemoryStream m = new MemoryStream()) {
      image.Save(m, ImageFormat.Png);
      imageData = m.ToArray();
   }
}
Response.ContentType = "image/png";
Response.BinaryWrite(imageData); 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-20T14:03:35.013

我认为@Lloyd 的回答是一个好的开始。

我遇到了 alpha 透明度和 PNG 的问题：[你能用 C# 制作一个 alpha 透明的 PNG 吗？](https://stackoverflow.com/questions/388677)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2012-11-26T18:06:02.800

还有另一种方法可以完成为动态图像提供服务。

```
namespace MyApp
{
    [ServiceContract]
    public interface IMyService
    {
        [WebGet(UriTemplate = "Image.png")]
        [OperationContract]
        Stream ShowImage();
    }
} 
```

对于实施：

```
public Stream ShowImage()
{
    Bitmap image = new Bitmap(@"C:\Image.png");
    Image image2 = new Bitmap(125, 125);

    using (Graphics graphics = Graphics.FromImage(image2))
    {
           graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
           graphics.SmoothingMode = SmoothingMode.HighQuality;
           graphics.PixelOffsetMode = PixelOffsetMode.HighQuality;
           graphics.CompositingQuality = CompositingQuality.HighQuality;
           graphics.DrawImage(image, 0, 0, 125, 125);
    }

    MemoryStream imageAsMemoryStream = new MemoryStream();
    image2.Save(imageAsMemoryStream, ImageFormat.Png);
    imageAsMemoryStream.Position = 0;
    return imageAsMemoryStream;
} 
```

将该服务作为常规 WCF 服务启动并在您的 app.config 中添加该服务

```
(WebService = new WebServiceHost(typeof(MyService))).Open(); 
```

您可以传递参数以使其更具动态性。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:52:56.330

无法从 WebService 输出图像。

检查这个：[http ://www.c-sharpcorner.com/UploadFile/gnsrinivas1511/Webservice05112009034709AM/Webservice.aspx](http://www.c-sharpcorner.com/UploadFile/gnsrinivas1511/Webservice05112009034709AM/Webservice.aspx)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-20T13:57:42.327

此外，根据您的实现方式，请注意您可能正在为 DOS 攻击做好准备。生成图像并不是对处理器最友好的事情。请确保有一些身份验证和/或缓存机制来帮助缓解这个潜在的痛点。* 
```***