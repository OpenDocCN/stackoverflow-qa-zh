# StackOverflow 问答 11623000-11623999

# django - 使用 CheckboxSelectMultiple 在 django MultipleChoiceField 中正确定义“其他”选项

> ID：11623001
> 
> 赞同：4
> 
> 时间：2012-07-24T01:48:10.827
> 
> 标签：django, model-view-controller, checkbox, django-forms, multiple-choice

我是 django 和 python 的新手，目前正在尝试构建一个包含各种选项的表单以及一个“其他”选项用于不在列表中的选项。我想定义该选项，以便在选中“其他”时，表单仅验证其他文本框是否包含非空值。

**是否有适当的方法来扩展 django 表单/字段/小部件来完成此任务？** 在搜索 google 和 stackoverflow 后可以找到最接近的东西是[这个示例](http://djangosnippets.org/snippets/863/)，它提供了扩展创建自定义渲染器、小部件和表单字段的代码，但它基于旧版本的 django。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T14:33:55.137

如果您使用`django.forms.ModelForm`呈现表单，您可以在选项字段 ( `clean_[your field name]`) 的表单验证中执行此操作。

```
from django import forms

class YourModelForm(forms.ModelForm):
    def clean_your_options(self):
        your_options = self.cleaned_data.getlist('your_options')

        if 'other' in your_options:
            other_text_input = self.cleaned_data.get('other_text_input')
            if len(other_text_input) == 0:
                raise forms.ValidationError('Other text input must contain value')

        return your_options 
```

# java - 在 Java 中，我可以创建一个名称由字符串传递的对象吗？

> ID：11623005
> 
> 赞同：1
> 
> 时间：2012-07-24T01:49:06.787
> 
> 标签：java, methods

我想做这样的事情：

```
Creator method = new Creator();
method.addSubject("example");

class Creator{
  public void addSubject(String subjName) {
     //here is the issue
     subjName = new Subject(subjName);
  }
}

class Subject {
  private String name;
  public Subject(String newName) {
    name = newName;
  }
} 
```

所以我希望这个名为 Creator 的类能够创建主题，但我需要它能够通过传递一个带有我想要调用这些主题的名称的字符串来做到这一点。我怎样才能做到这一点？

编辑：为了澄清，“Creator”类有一个名为“addSubject”的方法。在程序的主要方法中，我有一个名为“方法”的 Creator 对象（可能应该选择一个更好的示例名称）。那么Creator的这个对象是否可以通过将方法“addSubject”传递给我希望Subject的那些对象具有的名称来制作另一个类“Subject”类的对象？

Edit2：这是我想要的伪代码：

```
Main method:
Initialize Creator object
Command line for program takes arguments
Pass these arguments to creator object

Creator Object:
Takes command line argument in the form of string and makes a new object of the class Subject by the name of the String 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T01:57:52.147

~~我认为您想创建一个只想使用名称的类的新对象。是吗？所以，你可以这样做（Java 7）。~~

 ~~```
try {
    // you need to provide the default constructor!
    Object newInstance = Class.forName( "your.package.YourClassName" ).newInstance();
} catch ( ClassNotFoundException | IllegalAccessException | InstantiationException exc ) {
    exc.printStackTrace();
} 
```~~ 

~~如果您使用的是Java 7 之前的版本，则需要使用3 个catch 语句，一个用于ClassNotFoundException，一个用于IllegalAccessException，一个用于InstantiationException。~~

**编辑：**我想我现在明白了。您希望创建具有传递给方法的名称的 Subject 实例。您可以使用 HashMap 来模拟这一点。

就像是：

```
import java.util.*;

class Creator{

  private Map<String, Subject> map = new HashMap<String, Subject>();

  public void addSubject(String subjName) {
     map.put( subjName, new Subject(subjName) );
  }

  public Subject getSubject(String subjName) {
     return map.get(subjName);
  }
}

class Subject {
  private String name;
    public Subject(String newName) {
      name = newName;
    }
    @Override
    public String toString() {
      return name;
    }
}

// using...
Creator method = new Creator();
method.addSubject("example");

// prints example
System.out.println( method.getSubject("example") );

// prints null, since there is not a value associeted to the "foo" 
// key in the map. the map key is your "instance name".
System.out.println( method.getSubject("foo") ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T01:54:34.643

这是不起作用的位：

```
subjName = new Subject(subjName); 
```

`subjName`是一个字符串，但当然 a`new Subject()`是`Subject`

怎么样

```
Subject myNewSubject = new Subject(subjName); 
```

当然，我想您真正想要的是将其交付到`Subject`某个地方（`Collection`可能？），但是您的问题并没有澄清，所以我将其保留。

# perl - Perl 序列化和反序列化散列的散列

> ID：11623007
> 
> 赞同：5
> 
> 时间：2012-07-24T01:49:14.487
> 
> 标签：perl, perl-data-structures

我正在尝试序列化哈希哈希，然后反序列化它以取回原始哈希哈希..问题是每当我反序列化它时..它会附加一个自动生成的 $var1 例如。

原始哈希

```
%hash=(flintstones => {
    husband   => "fred",
    pal       => "barney",
},
jetsons => {
    husband   => "george",
    wife      => "jane",
    "his boy" => "elroy",  
},
); 
```

出来为 $VAR1 = { 'simpsons' => { 'kid' => 'bart', 'wife' => 'marge', 'husband' => 'homer' }, 'flintstones' => { 'husband' => '弗雷德', '朋友' => '巴尼' }, };

有什么方法可以在没有 $var1 的情况下获得原始哈希值 ..？？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T02:16:57.917

您已经证明 Storable 工作得非常好。这`$VAR1`是 Data::Dumper 序列化的一部分。

```
use Storable     qw( freeze thaw );
use Data::Dumper qw( Dumper );

my %hash1 = (
   flintstones => {
      husband  => "fred",
      pal      => "barney",
   },
   jetsons => {
      husband  => "george",
      wife     => "jane",
     "his boy" => "elroy",  
   },
);

my %hash2 = %{thaw(freeze(\%hash1))};

print(Dumper(\%hash1));
print(Dumper(\%hash2)); 
```

如您所见，原件和副本都是相同的：

```
$VAR1 = {
          'jetsons' => {
                         'his boy' => 'elroy',
                         'wife' => 'jane',
                         'husband' => 'george'
                       },
          'flintstones' => {
                             'husband' => 'fred',
                             'pal' => 'barney'
                           }
        };
$VAR1 = {
          'jetsons' => {
                         'his boy' => 'elroy',
                         'wife' => 'jane',
                         'husband' => 'george'
                       },
          'flintstones' => {
                             'husband' => 'fred',
                             'pal' => 'barney'
                           }
        }; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T02:33:24.340

如果您设置`$Data::Dumper::Terse`为`1`，则 Data::Dumper 将尝试跳过这些变量名称（但结果有时可能无法再被 解析`eval`）。

```
use Data::Dumper;
$Data::Dumper::Terse = 1;
print Dumper \%hash; 
```

现在变成：

```
{
  'jetsons' => {
                 'his boy' => 'elroy',
                 'wife' => 'jane',
                 'husband' => 'george'
               },
  'flintstones' => {
                     'husband' => 'fred',
                     'pal' => 'barney'
                   }
} 
```

也许像[JSON](https://metacpan.org/module/JSON)或[YAML](https://metacpan.org/module/YAML)这样的东西更适合您的目的？

# android - Android ImageButton 背景颜色

> ID：11623011
> 
> 赞同：12
> 
> 时间：2012-07-24T01:50:02.320
> 
> 标签：android, background, android-widget, imagebutton

我有一个具有一定透明度的背景图像的 ImageButton。默认情况下，由于 Holo.Light 主题，按钮在透明像素所在的位置获得灰色背景。`setBackgroundColor(Color.TRANSPARENT)`我尝试通过该方法将按钮的背景颜色设置为透明。这工作得很好，可以满足我的需要，除了现在我的按钮在聚焦/按下时不再具有浅蓝色并且看起来相当平坦（它周围没有边框，所以它看起来像一个图像）。

我搜索了一下，发现您可以按照[此处](http://www.mkyong.com/android/android-imagebutton-selector-example/)的说明分配选择器，但这意味着我必须为每个按钮状态指定一个图像，而我不想这样做。我想从主题继承焦点/按下的颜色，但将普通按钮背景（未按下/聚焦时）覆盖为透明而不是灰色。我怎样才能做到这一点？请提供一个工作示例，因为我尝试了许多不同的组合但没有成功。

**编辑** 谢谢大家的帮助。我想出了如何做到这一点，而不必为每个按钮重新创建具有焦点和按下状态的相同图像！

这是我的解决方案：

我的按钮定义为：

```
<ImageButton
            android:id="@+id/ImageButton05"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:background="@drawable/button" /> 
```

我的背景 XML 文件（标题为 button.xml）定义如下：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:state_pressed="true">
        <layer-list>
            <item android:drawable="@drawable/btn_default_pressed_holo_light"></item>
            <item android:drawable="@drawable/network_wifi"></item>
        </layer-list>
    </item>
    <item android:state_focused="true">
        <layer-list>
            <item android:drawable="@drawable/btn_default_focused_holo_light"></item>
            <item android:drawable="@drawable/network_wifi"></item>
        </layer-list>
    </item>
    <item android:state_hovered="true">
        <layer-list>
            <item android:drawable="@drawable/btn_default_focused_holo_light"></item>
            <item android:drawable="@drawable/network_wifi"></item>
        </layer-list>
    </item>
    <item>
        <layer-list>
            <item android:drawable="@drawable/btn_default_normal_holo_light"></item>
            <item android:drawable="@drawable/network_wifi"></item>
        </layer-list>
    </item>
</selector> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T01:58:04.887

例如，您可以将某些内容放入 xml 文件中，`custom_button.xml`然后`background="@drawable/custom_button"`在按钮视图中进行设置。

请参考此链接，因为有一个 xml 示例：[Standard Android Button with a different color](https://stackoverflow.com/questions/1521640/standard-android-button-with-a-different-color)

我在我的代码中使用了它，它按照我想要的方式工作。

参考： [具有不同颜色的标准 Android Button](https://stackoverflow.com/questions/1521640/standard-android-button-with-a-different-color)

* * *

**编辑：**

如果您更愿意使用 Maybe，您应该尝试设置边框。例如（参考：[Android - 按钮边框](https://stackoverflow.com/questions/7690416/android-border-for-button)）：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
  android:shape="rectangle">
  <gradient android:startColor="#FFFFFF" 
    android:endColor="#00FF00"
    android:angle="270" />
  <corners android:radius="3dp" />
  <stroke android:width="5px" android:color="#000000" />
</shape> 
```

或者，您可以尝试为按钮设置样式/主题。（但它会在一个单独的文件中）样式/主题包含按钮各种状态的颜色属性，例如聚焦/启用/禁用/等。

对于设置背景颜色/图像并具有单击突出显示效果，这是一个示例（参考：[如何以编程方式在视图中设置样式属性](https://stackoverflow.com/questions/2016249/how-to-programmatically-setting-style-attribute-in-a-view/2016344#2016344)）

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
  <item
    android:state_pressed="true"
    android:drawable="@drawable/btn_pressed" />
  <item
    android:state_pressed="false"
    android:drawable="@drawable/btn_normal" />
</selector> 
```

然后，您可以通过设置属性 android:background="@drawable/my_button" 将此选择器应用于 Button。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T01:56:50.570

> 我想从主题继承焦点/按下的颜色，但将普通按钮背景（未按下/聚焦时）覆盖为透明而不是灰色。我怎样才能做到这一点？

AFAIK 你不能因为焦点/按下的颜色内置于包含灰色背景的相同图像资源中。

如果您想保持系统焦点/按下但删除背景，您必须获取图像资源的副本（可以在您的 SDK`/sdkroot/platforms/[version]/data/res/drawable-hdpi`中用您所追求的任何 api 级别替换 [version] 找到。如果需要的话将 hdpi 替换为另一种密度）并使用照片编辑器从其中编辑灰色按钮。然后制作一个引用您修改后的图像的选择器并将其设置为按钮的背景。

**编辑：** 这是聚焦和按下的默认全息按钮图像

![专注](../Images/79ea33c4059b736f809c8981b1a77cf2.png)

![按下](../Images/c69c109ec82ae7b7abbe38d45e6eddc8.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-15T23:48:50.280

您可以使用 ImageView 而不是 ImageButton 来解决您的问题。请将 ImageView 的 android:background 属性设置为父级的背景颜色。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-14T16:19:42.580

你可以在你的 xml 文件中写这个：

```
android:background="@null" 
```

它对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-17T04:36:40.817

如果你不需要默认的灰色背景并且你需要你的 ImageButton 看起来像一个没有背景的图标，只需使用 android:background 属性并将其设置为

```
@android:color/transparent** 
<ImageButton
android:id="@+id/ImageButton05"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_gravity="center"
android:background="@android:color/transparent"
android:background="@drawable/button" /> 
```

希望能帮助任何人

# objective-c - tableView:cellForRowAtIndexPath: 未调用，因为数组为空？

> ID：11623013
> 
> 赞同：0
> 
> 时间：2012-07-24T01:50:20.883
> 
> 标签：objective-c, ios, uitableview, strongly-typed-dataset, weak-references

我的 tableView 没有加载，因为`tableView:cellForRowAtIndexPath:`没有被调用。`NSLog`我在里面写的消息`tableView:cellForRowAtIndexPath:`没有出现在控制台中。我有一个`weak`名为 listOfItems 的 NSArray @property。当我将其更改为 时`strong`，tableView 终于显示了它的内容。有人可以澄清一下是否`tableView:cellForRowAtIndexPath:`因为 NSArray 很弱而没有被调用。`listOfItems`属性和`tableView:cellForRowAtIndexPath:`被调用的方法之间是否存在联系？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T01:56:23.300

没有对象对数组有强引用。您的视图控制器有一个参考，但它并不强大。这意味着您不在乎它是否从内存中删除，您不需要它留下来。在这种情况下，由于您的表依赖于数组中的数据，因此您不希望将其从内存中删除：您希望它在表存在时一直存在。为此，您创建了一个强引用，以确保该对象不会从内存中删除，*直到*该指针（在本例中为您的属性）不再指向它。

# javascript - 变量三.js

> ID：11623020
> 
> 赞同：1
> 
> 时间：2012-07-24T01:51:36.703
> 
> 标签：javascript, syntax, three.js

我不明白这里到底发生了什么，这似乎是一个语法问题。以防万一它可能会有所帮助，我对 Javascript 很陌生，但我有使用 AS3 的经验。

在此代码上：

[https://github.com/mrdoob/three.js/blob/master/examples/canvas_lines.html](https://github.com/mrdoob/three.js/blob/master/examples/canvas_lines.html)

第 34 行是：

```
camera, scene, renderer; 
```

我假设这些是全局范围内的变量声明，并且在第 42 行，这些也是变量声明，但在 init() 函数的范围内。

第 42 行：

```
particles, particle; 
```

玩弄一下该代码，我意识到如果我像这样在全局范围内声明粒子对象，则脚本不起作用，但如果我像这样使用它，它就会起作用：

```
var particle; 
```

如果我删除第 42 行，它也能很好地工作。

为什么它会这样工作？这是怎么回事？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:15:53.327

这段代码的格式很差（恕我直言）。没有说清楚，但是：

```
var mouseX = 0, mouseY = 0,

windowHalfX = window.innerWidth / 2,
windowHalfY = window.innerHeight / 2,

SEPARATION = 200,
AMOUNTX = 10,
AMOUNTY = 10,

camera, scene, renderer; 
```

这是一个单独`var`的语句，逗号将其延续到行中。这可能会回答混乱并帮助您重新安排声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:17:17.097

第 42 行确实是

```
particles, particle; 
```

但是，第 41 行包含

var 容器，分隔 = 100，amountX = 50，amountY = 50，

所以完整的声明是（在一行上）

```
var container, separation = 100, amountX = 50, amountY = 50, particles, particle; 
```

不要粗鲁，但下次更仔细地阅读代码可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-24T13:52:09.713

'particles,particle' 在第 42 行的局部范围内声明（第 41 行的继续）。然而，“粒子”不在任何地方使用，“粒子”在本地使用。在 javascript 中声明变量 local 始终是一个好习惯。删除第 42 行使“粒子”成为全局变量。但是，由于在函数范围之外不需要“粒子”，因此最好在函数内将其声明为本地。Javascript 非常简单。您可以查看参考资料[http://www.w3schools.com/js](http://www.w3schools.com/js/) 和 [http://www.javascriptkit.com](http://www.javascriptkit.com/)

# django - django templatedoesnotexist current_date

> ID：11623021
> 
> 赞同：0
> 
> 时间：2012-07-24T01:51:40.193
> 
> 标签：django

我正在浏览 Django Book。我在第 4 章的中间。我无法呈现我的 current_datetime.html 模板视图。我究竟做错了什么？看起来模板加载器没有找到正确的目录。[http://www.djangobook.com/en/2.0/chapter04/](http://www.djangobook.com/en/2.0/chapter04/)

我在我的项目文件夹中创建了我的模板目录，并在目录中创建了 current_datetime.html。

```
Setting.py
import os.path

TEMPLATE_DIRS = (
    os.path.join(os.path.dirname(__file__), 'templates').replace('\\','/'),
    # I've also tried: # '/Users/macuser/Python_Projects/django_test1/templates',
)

views.py
from django.shortcuts import render_to_response
import datetime

def current_datetime(request):
    now = datetime.datetime.now()
    return render_to_response('current_datetime.html', {'current_date': now})

urls.py
from django.conf.urls import patterns, include, url
from django_test1.views import hello, my_homepage_view, current_datetime, hours_ahead

urlpatterns = patterns('',
    (r'^$', my_homepage_view),
    (r'^hello/$', hello),
    (r'^time/$', current_datetime),
    (r'^time/plus/(\d{1,2})/$', hours_ahead),) 
```

错误：

```
TemplateDoesNotExist at /time/
current_datetime.html
Request Method: GET
Request URL:
Django Version: 1.4
Exception Type: TemplateDoesNotExist
Exception Value:    
current_datetime.html
Exception Location: /Library/Python/2.7/site-packages/django/template/loader.py in find_template, line 138
Python Executable:  /usr/bin/python
Python Version: 2.7.1
Python Path:    
['/Users/macuser/Python_Projects/django_test1',
 '/Library/Python/2.7/site-packages/distribute-0.6.27-py2.7.egg',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload',
 '/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/PyObjC',
 '/Library/Python/2.7/site-packages']
Server time:    Mon, 23 Jul 2012 20:40:35 -0500
Template-loader postmortem

Django tried loading these templates, in this order:
Using loader django.template.loaders.filesystem.Loader:
Using loader django.template.loaders.app_directories.Loader:
/Library/Python/2.7/site-packages/django/contrib/auth/templates/current_datetime.html (File does not exist) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T07:32:34.910

你还没有检查 render_to_Response 格式 [https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#render-to-response](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#render-to-response)

通过它，您需要将 context_instance=RequestContext(request) 添加到响应中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T08:12:01.260

这是一个愚蠢的错误。我没有创建一个实际的应用程序：python manage.py startapp "appName"。我将“assert False”放在设置文件中，并意识到 django 甚至没有使用我的 settings.py 文件。

# linux - SD卡信息linux

> ID：11623033
> 
> 赞同：4
> 
> 时间：2012-07-24T01:53:04.470
> 
> 标签：linux, command-line, sd-card, android-sdcard

我正在尝试从打开的**SD**卡获取**OEM**和其他信息。linux 中是否有一个命令可以像我们对**MMC**所做的一样。例如：得到*cid*，得到*oemid*？**`/dev/sdc1`**`/sys/block/mmcblk0/device/cid`*`/sys/block/mmcblk0/device/oemid`*****

 ******如果您能让我知道如何以编程方式获取此信息，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:29:59.073

如果它出现在 scsi (/dev/sdX) 子系统中，则意味着您和卡之间有一些硬件，几乎可以肯定是实现 USB 存储协议的控制器。我不认为有一种标准机制可以在其中公开 SD/MMC 特定信息，尽管您的硬件可能有一些特定的东西。******

# javascript - 如何从组合框中获取数据并使用 Javascript 将其输入到文本框？

> ID：11623034
> 
> 赞同：0
> 
> 时间：2012-07-24T01:53:09.450
> 
> 标签：javascript, html

我有这个代码，它很简单，但为什么它不起作用？

```
<html>
    <head>
        <script type=”text/javascript“&gt;
            function Expedisi() 
            {
                var x=document.getElementById("cmb");//this the script for get data combo box
                var y = document.getElementById("txt");
                getCmb = x.value; 
                y.value = getCmb;
                alert(x);
            }
    </head>  
    <body>
        <select name="JENIS" id="cmb" data-role="slider" onChange="Expedisi()">
            <option value="Suplier">Sup</option>
            <option value="Expedisi">Exp</option>//if i pick one of this                          the value will be input on text box
        </select> 

        <input type="text" name="BKIRIM" id="txt" value=""> //this the destination value
    </body>
</html> 
```

谁能帮我？因为这个脚本没有运行？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T01:57:03.017

你的代码对我有用。在这里试试。[http://jsfiddle.net/DLs7j/](http://jsfiddle.net/DLs7j/) 这与您的代码完全相同。复制，粘贴。

最好的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T01:57:40.837

您不需要 getCmb，也不需要声明额外的元素。

改用这个：

```
<html>
      <head>
          <script type="text/javascript">
             function Expedisi(t) 
             {
                var y=document.getElementById("txt");
                y.value = t.value;
              }
        </script>
      </head>  
   <body>

   <select name="JENIS" id="cmb" data-role="slider" onChange="Expedisi(this);">
                          <option value="Suplier">Sup</option>
                          <option value="Expedisi">Exp</option>
    </select> 

     <input type="text" name="BKIRIM" id="txt" value=""/>
    </body>
    </html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T02:20:22.600

您需要更改脚本类型标记周围的引号。您当前使用的是“”而不是“”；所以将“text/javascript”更改为“text/javascript”。

# c# - 任务并行库 WaitAll 异常处理

> ID：11623036
> 
> 赞同：2
> 
> 时间：2012-07-24T01:53:13.613
> 
> 标签：c#, .net, multithreading, task-parallel-library

我正在使用任务并行库，并且正在使用任务工厂来创建和启动新任务列表。启动任务后，我调用 Task.WaitAll(...) 等待所有任务返回。代码类似于以下内容。

```
Tasks<MyClass>[] tasks = .../Create List of Tasks and Start using TaskFactory.StartNew(..) etc.

Task.WaitAll(tasks);         //Wait until all tasks complete before continuing. 
```

当我的任务返回并完成时，如果它们符合某些条件，结果将汇总到一个列表中，以便稍后处理。在每个任务运行时，可能会引发某些异常，这将“取消”将任务结果添加到聚合列表的资格。我希望能够在执行任务中抛出异常，并且该任务不再运行。

我知道有诸如取消令牌和取消源等功能可以处理某些事件，但它们似乎不允许我做我想做的事。尽管它不存在，但我会喜欢诸如在 task.OnException 或 task.OnError 等任务上订阅事件处理程序的功能。使用 TPL 完成此功能有哪些选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:37:56.647

After a Task has finished running, you can check the Task.Exception property.

[Task.Exception Property](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.exception.aspx)

If there was an unhandled exception running the Task, Task.Exception will not be null, it will be a System.AggregateException which will contain the details for one of more exceptions that occured.

You might also try using Task.ContinueWith on each Task, passing in a new Task and a flag of TaskContinuationOptions.OnlyOnFaulted. This new task is executed only if there was an unhandled exception in the original Task.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-29T07:33:33.140

您可以在[TaskCompletionSource](http://msdn.microsoft.com/en-us/library/dd449174.aspx)`Task`的帮助下将执行进一步分解。然后，您可以公开将在will或方法运行之前引发的事件 (?) 。`TaskCompletionSource``SetResult``TryToSetException`

# javascript - Canvas ArcTo 混淆

> ID：11623037
> 
> 赞同：5
> 
> 时间：2012-07-24T01:53:14.453
> 
> 标签：javascript, canvas, geometry

所以我再次处理环形扇区，这不是我的强项。我可以`.arc`很好地在画布上使用该方法，问题来自需要我的弧线成为路径的一部分。

例如：

```
 ctx.save();
 ctx.arc(centerX, centerY, radius, startAngle, endAngle, true);
 ctx.stroke();
 ctx.restore(); 
```

工作正常。但现在我需要它作为路径的一部分，所以我有这样的东西：

```
 var pointArray = [...]; //this contains all four corner points of the annular sector
 ctx.save();
 ctx.moveTo(pointArray[0].x, pointArray[0].y);
 ctx.lineTo(pointArray[1].x, pointArray[1].y); //so that draws one of the flat ends
 ctx.arcTo(?, ?, pointArray[2].x pointArray[2].y, radius); 
```

切线坐标的切线让我发疯。另外，我有一个严重的担忧： [http](http://www.dbp-consulting.com/tutorials/canvas/CanvasArcTo.html) : //www.dbp-consulting.com/tutorials/canvas/CanvasArcTo.html 听起来好像用 arcTo 绘制的弧永远无法覆盖 180 度或更多的圆，而且有时会这样我的环形扇区将大于 180 度。

感谢stackoverflow的高级几何头脑的帮助！

**更新** 好的，所以我必须在这里做 svg canvas inter-polarity，并使用咖啡脚本，实际的生产代码如下！

```
 annularSector : (startAngle,endAngle,innerRadius,outerRadius) ->

    startAngle  = degreesToRadians startAngle+180
    endAngle    = degreesToRadians endAngle+180
    p           = [ 
        [ @centerX+innerRadius*Math.cos(startAngle),    @centerY+innerRadius*Math.sin(startAngle) ]
        [ @centerX+outerRadius*Math.cos(startAngle),    @centerY+outerRadius*Math.sin(startAngle) ]
        [ @centerX+outerRadius*Math.cos(endAngle),      @centerY+outerRadius*Math.sin(endAngle) ]
        [ @centerX+innerRadius*Math.cos(endAngle),      @centerY+innerRadius*Math.sin(endAngle) ] 
    ]
    angleDiff   = endAngle - startAngle
    largeArc    = (if (angleDiff % (Math.PI * 2)) > Math.PI then 1 else 0)

    if @isSVG

        commands    = []

        commands.push "M" + p[0].join()
        commands.push "L" + p[1].join()
        commands.push "A" + [ outerRadius, outerRadius ].join() + " 0 " + largeArc + " 1 " + p[2].join()
        commands.push "L" + p[3].join()
        commands.push "A" + [ innerRadius, innerRadius ].join() + " 0 " + largeArc + " 0 " + p[0].join()
        commands.push "z"

        return commands.join(" ")

    else

        @gaugeCTX.moveTo p[0][0], p[0][1]
        @gaugeCTX.lineTo p[1][0], p[1][1]
        #@gaugeCTX.arcTo 
        @gaugeCTX.arc @centerX, @centerY, outerRadius, startAngle, endAngle, false
        #@gaugeCTX.moveTo p[2][0], p[2][1]
        @gaugeCTX.lineTo p[3][0], p[3][1]
        @gaugeCTX.arc @centerX, @centerY, innerRadius, startAngle, endAngle, false 
```

![在此处输入图像描述](../Images/ebe8e2528d32b6482b0106777674ae82.png)

**解决方案**

```
 @gaugeCTX.moveTo p[0][0], p[0][1]
        @gaugeCTX.lineTo p[1][0], p[1][1]
        @gaugeCTX.arc @centerX, @centerY, outerRadius, startAngle, endAngle, false
        @gaugeCTX.lineTo p[3][0], p[3][1]
        @gaugeCTX.arc @centerX, @centerY, innerRadius, endAngle, startAngle, true #note that this arc is set to true and endAngle and startAngle are reversed! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:50:51.730

虽然您的问题/代码对我来说不是 100% 清楚，

arcTo() 仍然存在浏览器/渲染问题，所以现在使用 arc()。
（请原谅我，我现在无法提供详细链接，因为我成为了新的强制 firefox 12 垃圾的受害者，并且在我的 ff3.6 动力系统中丢失了多年的笔记，它在未经批准的更新期间被简单地删除了）。

arc() 适用于弧度，因此请在 wiki 上快速阅读 Math.PI 如何与弧度相关，然后制定一些公式将您的度数（或您可能希望的任何值）转换为弧度。
您将执行以下操作： (((2 * Math.PI) / 360) * 270)     *(=3/4 circle)*
顺便说一句：我没有遇到弧度/单位转换和 ECMAscript 浮动的明显绘图问题点行为！

也不要忘记 beginPath() 和 closePath() （和 stroke() 在需要的地方）：不要让画布猜测！这通常是绘制（封闭）路径的关键！！

您可能还想查看 bezierCurveTo()。

**更新**（关于 TS 的更新）：看着你的图片（我猜这是你的问题的渲染），我想我看到了你想要的：饼图。

这很简单，它们是 beginPath() 和 closePath() （以及填充颜色）之间的 2 条弧线和两条线。
你想要做的是用 translate() 将你的原点（点 0,0）居中。在您执行此操作之前，请阅读有关获得清晰线条的信息：诀窍是转换为半像素：(x.5,y.5)。

然后制作一张“主画布”和一张“临时画布”。对于每一块饼，在干净的临时画布上绘制一个（只需设置它的宽度和高度，而不是一些清晰的胡言乱语）并将这个临时画布放在你的主画布上。最后渲染/输出你的主画布。完毕。

您脚本中的“魔术”（简单数学）在您现有的 svg-path 之间进行翻译我无法帮助您，因为我（羞于承认）在您更新的源代码中无法识别任何 javascript。

希望这可以帮助！

**更新2：**实际上..如果你能告诉我们你的点/坐标数组的格式..那真的很有帮助！然后我们会知道你从哪里画到哪里。
最好的解决方案可能确实是创建一个接受您的点数组的 javascript 函数。
这样，​​您的咖啡脚本可以简单地将您的已知值（数据格式）吐出到无论如何渲染画布所需的 javascript（在html).

这让我觉得.. 必须有现有的 svg-path 到画布翻译脚本.. 对吗？也许有人知道一个久经考验的，可以在这里链接/复制它（以供将来参考）..

**更新 3：** 提示：不要忘记：您可以在绘图模式下旋转画布，也可以在分层画布时旋转画布。
当您旋转时（使用上述相同的弧度原理），画布将围绕其原点 (0,0) 旋转，这就是为什么平移（到画布中心 + 0.5px）对于绘制这些非常有用善良的圆形形状！！！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-18T15:32:12.380

我最近发现自己对 arcTo() 方法（实际上应该称为 roundedCorner() ）感到失望。我决定为想要使用 cx,cy,r,theta1,theta2 表达式的人提出一个通用的解决方法：

[http://www.purplefrog.com/~thoth/art/paisley/arcTo.html](http://www.purplefrog.com/~thoth/art/paisley/arcTo.html)

在这里复制了重要的代码：

```
/**
   if code is "move" then we will do a moveTo x0,y0
   if code is "line" then we will do a lineTo x0,y0
   if code is anything else, we'll assume the cursor is already at x0,y0
*/
function otherArcTo(ctx, cx, cy, r, theta1, theta2, code)
{
    console.log([cx,cy,r,theta1, theta2, code])
    var x0 = cx + r*Math.cos(theta1)
    var y0 = cy + r*Math.sin(theta1)
    if (code=="move") {
        ctx.moveTo(x0,y0)
    } else if (code=="line") {
        ctx.lineTo(x0,y0)
    }

    var dTheta = theta2-theta1
    var nChunks = Math.ceil( Math.abs(dTheta) / (0.67*Math.PI) )
    if (nChunks <=1) {
        var theta3 = theta1 + dTheta/2
        var r3 = r/Math.cos(dTheta/2)
        var x1 = cx + r3*Math.cos(theta3)
        var y1 = cy + r3*Math.sin(theta3)
        var x2 = cx + r*Math.cos(theta2)
        var y2 = cy + r*Math.sin(theta2)
        ctx.arcTo(x1,y1,x2,y2, r)
    } else {
        for (var i=0; i<nChunks; i++) {
            var code2 = null
            if (i==0)
                code2 = code
            otherArcTo(ctx, cx, cy, r,
                       theta1 + dTheta*i/nChunks,
                       theta1 + dTheta*(i+1)/nChunks, code2)
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T20:30:41.950

我自己也遇到了麻烦。一旦我把它画在一张纸上并使用了一点几何学和三角学，它就非常简单了。

此函数将帮助您计算 arcTo() 函数所需的点。您可以通过在每个点的 x 和 y 中添加/减去来移动（平移）弧。

```
function calculateArcPoints(radius, rotation, sectionAngle) {
    var halfSectionAngle = sectionAngle / 2;

    return {
        control: {
            x: Math.cos(rotation) * radius / Math.cos(halfSectionAngle),
            y: -1 * Math.sin(rotation) * radius / Math.cos(halfSectionAngle)
        },
        start: {
            x: Math.cos(rotation - halfSectionAngle) * radius,
            y: -1 * Math.sin(rotation - halfSectionAngle) * radius
        },
        end: {
            x: Math.cos(rotation + halfSectionAngle) * radius,
            y: -1 * Math.sin(rotation + halfSectionAngle) * radius
        }
    };
} 
```

我使用了 KineticJS，没有使用 SVG 或咖啡脚本，因此旋转和平移是在绘图功能之外完成的。[这是jsFiddle](http://jsfiddle.net/bicycle/nnLRt/11/)上的完整代码。我在一个圆圈周围画了多个环形部分，但您可以轻松地将其修改为只画一个。基本上，你有一个内半径，一个外半径，并且你在它们的起点和终点用直线连接它们中的每一个。

> 切线坐标的切线让我发疯。另外，我有一个严重的担忧：[http](http://www.dbp-consulting.com/tutorials/canvas/CanvasArcTo.html) : //www.dbp-consulting.com/tutorials/canvas/CanvasArcTo.html 听起来好像用 arcTo 绘制的弧永远无法覆盖 180 度或更多的圆，而且有时会这样我的环形扇区将大于 180 度。

您对 arcTo() 函数是正确的。它只能产生小于 180 度的圆弧。>= 180° 处的切线永远不会相交，因此 arcTo() 函数不能有控制点。您可以只画两个或（我会为整个环形空间画三个）彼此更相邻。

# c++ - 在内存中渲染用户界面

> ID：11623038
> 
> 赞同：0
> 
> 时间：2012-07-24T01:53:32.927
> 
> 标签：c++, wxwidgets

假设我有 hwnd 句柄并想在内存中添加一些 GUI 控件。我还通过事件接收所有用户输入。那么，是否可以使用 wxwidgets 将用户界面添加到将被绘制到窗口上的图像（使用这样的 hwnd 句柄）。如果是这样，wxwidget 是否有一些工具来跟踪 GUI 的状态？

我是 wxwidgets 的新手，所以请原谅我的一般性问题。

非常感谢，克里斯蒂安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T07:27:23.353

将 GUI 控件添加到图像的唯一方法是自己绘制它们。这样做的唯一方法是创建一个图像 GUI 元素，并相对于图像元素定位其他 GUI 元素。但是，这不会像您想要的那样对 UI 进行双缓冲，它实际上并没有在图像中绘制 UI 元素，只是将它们放在图像的顶部。

# c# - 如何在 c# 上使对象成为线程安全的？

> ID：11623039
> 
> 赞同：3
> 
> 时间：2012-07-24T01:53:38.587
> 
> 标签：c#, .net, thread-safety

我有一个在大多数情况下需要线程的应用程序。大多数时候我会遇到错误或错误值，因为对象在每个线程执行之前已更新。

您对如何使对象成为线程安全并确保对象对每个线程都具有正确性有什么建议吗？我应该做我的变量`static`吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-24T02:53:05.563

您应该做的第一件事是**绘制**要通过多线程解决的问题的**Happens-Before 图。**如果你不能画出你的设计，那就太复杂了。

例如，这是一个方法的发生前图，它采用两个整数数组并输出所有元素的总和。

![在此处输入图像描述](../Images/d4a1280c67067b56cfe7b2a190934d6b.png)

一旦你有了之前发生的图表，就很容易看到在其他事情之前必须发生的事情，但更重要的是，它向你展示了在其他事情之前不需要发生的事情。

在此示例中，您可以同时获得 array1 和 array2 的总和。您也可以同时获得 sum1 和 sum2，因为它们不相互依赖。将总和添加到 TotalSum1 可以按任一顺序完成，（但您需要锁定加法步骤，因为您不能与另一个同时进行加法）。

C# .net 4.0 为并行编程提供了很多有用的功能。

我推荐这本书[Parallel Programming with Microsoft .Net](http://msdn.microsoft.com/en-us/library/ff963553) —— 只需使用左侧的书签进行导航。它涵盖了循环、任务、聚合、期货和管道的并行模式。

在上面的示例中，我将使用 Task1 来获取 Array1 和 Task2 来获取 Array2，然后在这两者中，我将使用内置到 Parallel.For 循环中的聚合模式来获取数组总和，我需要使用锁或 Interlocked.Add 以累积 subTotals，然后等待任务完成并返回结果。

**有用的模式：**

*   任务
*   并行循环
*   生产者/消费者
*   管道
*   工作清单
*   MapReduce

**有用的工具：**

*   任务并行库
    *   并行.For
    *   Parallel.Foreach,
    *   任务
*   PLinq
*   并发数据结构
    *   并发队列
    *   等等
*   锁定
    *   “锁定”关键字
    *   监视器（与“锁定”功能相同）
    *   信号量
    *   自旋锁
    *   读/写锁
*   硬件原子操作
    *   互锁增量
    *   互锁。添加
    *   Interlocked.CompareAndSwap
    *   分配给机器字长变量，如 int
*   消息传递
    *   MPI
    *   障碍
    *   等等

基本上，首先**了解**您的问题，然后选择**工具/模式**来解决它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-24T01:57:35.767

考虑对需要使线程安全的任何资源使用 lock 语句。

[http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)

```
class Account
{
    decimal balance;
    private Object thisLock = new Object();

    public void Withdraw(decimal amount)
    {
        lock (thisLock)
        {
            if (amount > balance)
            {
                throw new Exception("Insufficient funds");
            }
            balance -= amount;
        }
    }
} 
```

这将是我的第一步。您也可以查看 Monitor 类。

[http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx](http://msdn.microsoft.com/en-us/library/system.threading.monitor.aspx)

这是在并发操作期间保护资源的两种基本方法。还有许多其他方式，例如互斥锁、信号量、条件读/写锁等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T01:59:20.317

从这里开始：[为多线程同步数据](http://msdn.microsoft.com/en-us/library/z8chs7ft.aspx)

基本上，您需要使用[mutex](http://en.wikipedia.org/wiki/Mutex)。在 .NET 中，每个对象都可以充当互斥锁，因此您可以在任何对象上使用[lock 关键字](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)来确保互斥。

# python - 在 Sublime Text 2 的插件中使用整个范围作为输入

> ID：11623040
> 
> 赞同：3
> 
> 时间：2012-07-24T01:53:52.893
> 
> 标签：python, sublimetext, sublimetext2

Textmate 的优点之一是能够将整个范围的内容通过管道传输到命令中，如下所示：

![Textmate 截图](../Images/e524b6b5e6c5753bdcfbba2acdae4e5d.png)

然后，您可以指定要使用的范围，例如`meta.class.python`或其他。

我正在尝试编写一个小插件，它将整个当前范围作为插件的输入（例如（不完全是我想要做的，但关闭），一个让你注释掉整个Python 类而不全选）

使用当前选择作为输入非常简单：

```
import sublime, sublime_plugin
import re

class DoStuffWithSelection(sublime_plugin.TextCommand):
    def run(self, edit):
        for region in self.view.sel():
            if not region.empty():
                changed = region  # Do something to the selection
                self.view.replace(edit, region, changed)  # Replace the selection 
```

我已经搜索了 Sublime Text 插件 API 以寻找某种方式来做类似的事情`for region in self.view.scope()`，但没有成功。

那么，有没有办法将光标下当前范围的内容用作插件函数的输入？或者，更好的是，如果没有选择，则使用整个范围，但如果有选择，则使用选择。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:50:36.470

如果您想获取您选择的文本，以下代码片段就是一个示例。

```
if not region.empty():
    selectText = self.view.substr(region)
    ... 
```

如果你想获取光标所在的文本，下面的代码片段就是一个例子。

```
if region.empty():
    lineRegion = self.view.line(region)
    lineText = self.view.substr(lineRegion)
    ... 
```

要获取更多信息，请参阅[http://net.tutsplus.com/tutorials/python-tutorials/how-to-create-a-sublime-text-2-plugin/](http://net.tutsplus.com/tutorials/python-tutorials/how-to-create-a-sublime-text-2-plugin/)和[http://www.sublimetext.com/docs /api 参考](http://www.sublimetext.com/docs/api-reference)。

# jquery - jquery 选择选项默认值隐藏并重新出现

> ID：11623041
> 
> 赞同：0
> 
> 时间：2012-07-24T01:54:09.090
> 
> 标签：jquery

查看所有选项（1,2,3）（第一次单击选择时）时，我在选项列表中隐藏了默认选项，但是在进行选择然后再次查看选项后它需要以某种方式重新出现..（仅通过页面刷新，用户可以查看包含“浴室”类别的选择框，否则会出现无意义的数字 1,2,3..)

即当前“浴室”不会重新出现，一旦选择，然后再次单击选择框..（如果用户改变主意）这就是问题所在。做这个的最好方式是什么。

我无法更改 html - 仅需要使用 Jquery 来完成。请帮忙

```
<select name="searchForm__bathrooms" id="field-searchForm__bathrooms" class="field-    dropdown">
    <option value=""> Bathrooms </option>
    <option value="1"> 1 </option>
    <option value="3"> 3 </option>
    <option value="2"> 2 </option>
</select>

$('select option:first-child').hide(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:15:27.980

[http://jsfiddle.net/earlonrails/EfMvd/2/](http://jsfiddle.net/earlonrails/EfMvd/2/)

Javascript

```
$(function() {
    $("#field-searchForm__bathrooms").change(function() {
        var selectEle = $(this);
        var doAppend = true;  
        $.each(selectEle.children(), function(index, child) {
            if (child.value == "0") {
                doAppend = false;
            }
        });
        if (doAppend) {
            selectEle.append('<option name="bathroom" value="0">Bathrooms</option>');
        }
    });
}); 
```

HTML

```
<body>
    <select name="searchForm__bathrooms" id="field-searchForm__bathrooms" class="field-dropdown">
        <option value="1"> 1 </option>
        <option value="2"> 2 </option>
        <option value="3"> 3 </option>
    </select>
</body>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:06:24.113

```
$("#field-searchForm__bathrooms").click(function(){
  $('select option:first-child').toggle();
}) 
```

# sql - 我想知道如何在 sql 上输出这些值

> ID：11623046
> 
> 赞同：2
> 
> 时间：2012-07-24T01:55:24.940
> 
> 标签：sql

商务、豪华、小型货车或 SUV、行政面包车、装甲轿车、装甲小型货车、小巴

它们在同一张表上，列名是 Vehicletype。我的问题是，如果使用 ORDER BY ASC 将无法达到上述安排。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:14:46.797

`ASC`按字母升序排列。如果您需要将该顺序更改为其他内容，请添加数字类型的另一列（例如，`SORTORDER`）和`ORDER BY`该列，即使您不显示它也是如此。

```
VehicleType         SortOrder
-----------         ---------
Business               1
Luxury                 2
Minivan or SUV         3
Executive van          4
Armored Sedan          5
Armored Minivan        6
Minibus                7

SELECT VehicleType FROM whatever ORDER BY sortorder ASC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:18:28.713

通常为此使用条件语句来为该位置引入一个数字。作为您的一部分`SELECT`，您可以使用：

```
 CASE WHEN Vehicletype='Business' THEN 1
      WHEN Vehicletype='...' THEN 2
      WHEN ...
      ELSE NULL
 END AS position 
```

在这种情况下或更简单：

```
 CASE VehicleType
 WHEN 'Business' THEN 1
 WHEN '...' THEN 2
 END AS position 
```

然后，使用`ORDER BY position`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:06:26.850

ASC 将按字母顺序输出列。而 DESC 将输出相反的结果。

# ios - FB SDK 3.0 我需要扩展访问令牌还是自动扩展？

> ID：11623047
> 
> 赞同：5
> 
> 时间：2012-07-24T01:55:40.540
> 
> 标签：ios, facebook, sdk, token

基于[http://developers.facebook.com/roadmap/offline-access-removal/](http://developers.facebook.com/roadmap/offline-access-removal/) 异常（部分）3：如果我使用“较新”的 SDK，它将为我保存访问令牌并自动扩展它。

我的问题：

[1] 当它说“较新”的 SDK 时 - 有谁知道这是否指的是 3.0？

[2] 有没有办法手动为 FBSession 分配访问令牌？FBSession 的 accessToken 属性是只读的。我的情况：在我的应用程序中，用户使用他们的电子邮件地址登录，而在我的服务器上，电子邮件地址链接到 facebook 访问令牌。现在，如果用户在另一台设备上登录我的应用程序，我的服务器将在身份验证响应中返回 FB 访问令牌；我希望为 FBSession 分配相同的访问令牌，这样他们就不必重新验证 FB 并希望访问令牌扩展过程只是神奇地发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T08:42:34.763

很确定你再也不用担心了。查看代码，FBSession 负责延长令牌和到期日期。

[https://github.com/facebook/facebook-ios-sdk/blob/master/src/FBSession.m](https://github.com/facebook/facebook-ios-sdk/blob/master/src/FBSession.m)

# c# - 对于异步生成的 StateMachine 中的 MoveNext 来说，这是否有意义？

> ID：11623048
> 
> 赞同：0
> 
> 时间：2012-07-24T01:55:54.997
> 
> 标签：c#, .net, asynchronous, async-await, c#-5.0

最近，我正在阅读[Jon Skeet 博客中的](http://msmvps.com/blogs/jon_skeet/default.aspx)Eduasync 连载。当我阅读[第 7 部分](http://msmvps.com/blogs/jon_skeet/archive/2011/05/20/eduasync-part-7-generated-code-from-a-simple-async-method.aspx)时，一个问题阻止了我，我认为 C# 生成的状态机在某些极少数情况下可能无法正常工作，让我们深入代码（此代码来自 Jon Skeet 的 Eduasync 第 7 部分，我只是添加一些赞扬）：

```
public void MoveNext() 
{ 
    int result; 
    try 
    { // doFinallyBodies is never used 
        bool doFinallyBodies = true; 
        if (state != 1) 
        { 
            if (state != -1) 
            { 
                task = Task<int>.Factory.StartNew(() => 5); 
                awaiter = task.GetAwaiter(); 
                // In a rare case, in this moment the task still has not completed, 
                // so return false IsCompleted
                if (awaiter.IsCompleted) 
                { 
                    goto Label_GetResult; 
                } 
                state = 1; 
                // The task just completed before OnCompleted, 
                // but in this moment we haven't call the OnCompleted yet, 
                // so the task's ContinueWith is nothing the task will complete 
                // without ContinueWith and we will never get back to this StateMachine again.
                doFinallyBodies = false; 
                awaiter.OnCompleted(moveNextDelegate); 
            } 
            return; 
        } 
        state = 0; 
      Label_GetResult: 
        int awaitResult = awaiter.GetResult(); 
        awaiter = new TaskAwaiter<int>(); 
        result = awaitResult; 
    } 
    catch (Exception e) 
    { 
        state = -1; 
        builder.SetException(e); 
        return; 
    } 
    state = -1; 
    builder.SetResult(result); 
} 

public struct TaskAwaiter<T>
{
    private readonly Task<T> task;

    internal TaskAwaiter(Task<T> task)
    {
        this.task = task;
    }

    public bool IsCompleted { get { return task.IsCompleted; } }

    public void OnCompleted(Action action)
    {
        SynchronizationContext context = SynchronizationContext.Current;
        TaskScheduler scheduler = context == null ? TaskScheduler.Current
            : TaskScheduler.FromCurrentSynchronizationContext();
        task.ContinueWith(ignored => action(), scheduler);
    }

    public T GetResult()
    {
        return task.Result;
    }
} 
```

那么你认为这可能是一个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T06:46:35.107

为了确保我正确理解您，我将更详细地描述我认为您期望的事件顺序：

1.  异步操作开始
2.  `IsCompleted`被检查，这将返回`false`，因为操作还没有完成
3.  操作完成
4.  `OnCompleted()`被调用，而后者又调用`ContinueWith()`，但由于`Task`已经完成，延续永远不会执行

如果我猜对了，那么你的错误就在第 4 步。那是因为 的作者`Task`知道这种竞争条件，所以如果你调用`ContinueWith()`一个已经完成的，那么*将立即安排*`Task`继续。因此，即使在这种情况下，状态机也能正常工作。

 *不幸的是，关于这一点[的文档`ContinueWith()`](http://msdn.microsoft.com/en-us/library/dd270696)不是很清楚（它解释了何时*不会*安排延续，但没有解释何时会）。*

# matlab - 计算向量中的所有差异可能性

> ID：11623049
> 
> 赞同：3
> 
> 时间：2012-07-24T01:55:55.703
> 
> 标签：matlab, math, vector

假设我有一个短向量`x = [a,b,c,d,e];`计算向量成员之间所有差异的最佳方法是：

```
y = [e-d e-c e-b e-a
     d-e d-c d-b d-a
     c-e c-d c-b c-a
     b-e b-d b-c b-a
     a-e a-d a-c a-b]; 
```

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T02:22:03.077

要给出确切的矩阵，请尝试：

```
x = [1;2;3;4;5];     %# note this is a column vector (matrix of rows in general)

D = squareform( pdist(x,@(p,q)q-p) );
U = triu(D);
L = tril(D);
y = flipud(fliplr( L(:,1:end-1) - U(:,2:end) )) 
```

在这种情况下导致：

```
y =
     1     2     3     4
    -1     1     2     3
    -2    -1     1     2
    -3    -2    -1     1
    -4    -3    -2    -1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:20:08.377

首先创建一个[循环矩阵](http://en.wikipedia.org/wiki/Circulant_matrix)，然后计算第一列和其余列之间的差异。[这](http://www.mathworks.com/matlabcentral/fileexchange/22858-circulant-matrix)是创建循环矩阵的参考

# sql - Where Exists 返回所有行

> ID：11623052
> 
> 赞同：1
> 
> 时间：2012-07-24T01:56:18.913
> 
> 标签：sql

我的`where exists`条款不起作用。我错过了什么微不足道的事情？

```
select * from patient as p
where exists
(
    select p.patientid, count(*) from tblclaims as c 
    inner join patient as p on p.patientid=c.patientid
    and p.admissiondate = c.admissiondate
    and p.dischargedate = c.dischargedate
    group by p.patientid
    having count(*)>500
) 
```

如您在查询中看到的那样，患者和 tblclaims 通过三字段复合键连接在一起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:00:02.110

这`count(*) from tblclaims as c`是不必要的，可能会抛出查询。

此外，您没有`WHERE`加入`patient p`您的条款的`exists`条款。

更不用说您`p`在主查询和子句中都用作别名`exists`，这只是令人困惑。

你可能想要这样的东西：

```
select * from patient
where exists
(
    select p.patientid 
    from tblclaims as c 
    inner join patient as p on p.patientid=c.patientid
        and p.admissiondate = c.admissiondate
        and p.dischargedate = c.dischargedate
    where patient.patientid = p.patientid
    group by p.patientid
    having count(*)>500
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:08:19.437

您根本不需要在子查询中使用内连接；这实际上是你额外结果的原因。您应该在外部查询中引用“p”。

```
select * from patient as p
where exists
(
    select 1 from tblclaims as c 
    where p.patientid = c.patientid
       and p.admissiondate = c.admissiondate
       and p.dischargedate = c.dischargedate
    group by c.patientid
    having count(*)>500
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:02:20.537

我不太喜欢存在。也许您可以使用其他功能。尝试这个：

```
select * from patient as p
where patientid IN
(
    select p.patientid from tblclaims as c 
    inner join patient as p on p.patientid=c.patientid
    and p.admissiondate = c.admissiondate
    and p.dischargedate = c.dischargedate
    group by p.patientid
    having count(*)>500
) 
```

# python - matplotlib：使用颜色图为表格单元格背景着色

> ID：11623056
> 
> 赞同：10
> 
> 时间：2012-07-24T01:56:42.890
> 
> 标签：python, colors, matplotlib

我有一个 Pandas 数据框，我想将其绘制为 matplotlib 表。到目前为止，我的那部分正在使用以下代码：

```
import numpy as np
randn = np.random.randn
from pandas import *

idx = Index(arange(1,11))
df = DataFrame(randn(10, 5), index=idx, columns=['A', 'B', 'C', 'D', 'E'])
vals = np.around(df.values,2)

fig = plt.figure(figsize=(15,8))
ax = fig.add_subplot(111, frameon=True, xticks=[], yticks=[])

the_table=plt.table(cellText=vals, rowLabels=df.index, colLabels=df.columns, 
                    colWidths = [0.03]*vals.shape[1], loc='center')

table_props = the_table.properties()
table_cells = table_props['child_artists']

clm = cm.hot(vals)

for cell in table_cells: 
    cell.set_height(0.04)
    # now i would like to set the backgroundcolor of the cell 
```

最后，我想根据颜色图设置单元格的背景颜色 - 但是我如何在没有索引的 clm 数组中查找它？

另一个问题：我可以以某种方式将格式字符串传递给表格，以便将文本格式化为小数点后 2 位吗？

任何提示表示赞赏，安迪

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T02:44:10.293

您可以使用[`plt.Normalize()`](https://matplotlib.org/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize)规范化数据，并将规范化的数据传递给[`Colormap`对象](https://matplotlib.org/users/colormapnorms.html)，例如[`plt.cm.hot()`](https://matplotlib.org/examples/color/colormaps_reference.html).

[`plt.table()`](https://matplotlib.org/api/_as_gen/matplotlib.pyplot.table.html)有一个参数`cellColours`，将用于相应地设置单元格的背景颜色。

因为`cm.hot`将黑色映射到最小值，所以我在创建规范化对象时增加了值范围。

这是代码：

```
from matplotlib import pyplot as plt
import numpy as np
randn = np.random.randn
from pandas import *

idx = Index(np.arange(1,11))
df = DataFrame(randn(10, 5), index=idx, columns=['A', 'B', 'C', 'D', 'E'])
vals = np.around(df.values,2)
norm = plt.Normalize(vals.min()-1, vals.max()+1)
colours = plt.cm.hot(normal(vals))

fig = plt.figure(figsize=(15,8))
ax = fig.add_subplot(111, frameon=True, xticks=[], yticks=[])

the_table=plt.table(cellText=vals, rowLabels=df.index, colLabels=df.columns, 
                    colWidths = [0.03]*vals.shape[1], loc='center', 
                    cellColours=colours)
plt.show() 
```

![在此处输入图像描述](../Images/1c2ec17208a2dc5766dadfa1f156e100.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T13:41:01.170

安迪的代码工作：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

# sudo apt-get install python-pandas
# sudo apt-get install python-matplotlib
# 
# python teste.py

from matplotlib import pyplot
from matplotlib import cm

import numpy

from pandas import *

idx = Index(numpy.arange(1, 11))

df = DataFrame(
        numpy.random.randn(10, 5),
        index=idx,
        columns=['A', 'B', 'C', 'D', 'E']
    )

vals = numpy.around(df.values, 2)

normal = pyplot.normalize(vals.min()-1, vals.max()+1)

fig = pyplot.figure(figsize=(15, 8))

ax = fig.add_subplot(111, frameon=True, xticks=[], yticks=[])

the_table = pyplot.table(
                cellText=vals,
                rowLabels=df.index,
                colLabels=df.columns, 
                colWidths = [0.03]*vals.shape[1],
                loc='center', 
                cellColours=pyplot.cm.hot(normal(vals))
            )

pyplot.show() 
```

# sql - 优化plpgsql函数

> ID：11623059
> 
> 赞同：3
> 
> 时间：2012-07-24T01:56:57.850
> 
> 标签：sql, performance, postgresql, insert, plpgsql

PostgreSQL 版本是 9.0。

我必须优化一个 plpgsql 函数。这个想法只是运行所有文档并测试表中的相关行 902,903,905,907 是否`webdte.doc_tip_cifra`已经存在。如果它们不存在，则插入空行以满足之后的验证。即使我只使用这 4 个条件之一并使用它必须运行的行数的一半，它现在也慢得离谱。有人有提高性能的想法吗？

```
CREATE OR REPLACE FUNCTION webdte.addtagobligatoriosventa(idlibro bigint)
  RETURNS character AS
$BODY$
DECLARE                 
    id_documento bigint;
    validador integer;
    validador1 integer;
    validador2 integer;
    validador3 integer;
    validador4 integer;

    tipo_cifra integer;
    --counts integer[];
BEGIN
    SELECT INTO validador1, validador2, validador3, validador4
             max(CASE id_tipo_cifra WHEN 901 THEN 1 ELSE 0 END)
            ,max(CASE id_tipo_cifra WHEN 902 THEN 1 ELSE 0 END)
            ,max(CASE id_tipo_cifra WHEN 905 THEN 1 ELSE 0 END)
            ,max(CASE id_tipo_cifra WHEN 907 THEN 1 ELSE 0 END)
    FROM   webdte.doc_tip_cifra
    WHERE  id_doc = id_documento;

    if (validador1 = 0) then
        insert into webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
        values (id_documento, 901, 0, 0);

    end if;
        if (validador2 = 0) then
        insert into webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
        values (id_documento, 902, 0, 0);

    end if;
        if (validador3 = 0) then
        insert into webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
        values (id_documento, 905, 0, 0);

    end if;
        if (validador4 = 0) then
        insert into webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
        values (id_documento, 907, 0, 0);

    end if;

END;
$BODY$
  LANGUAGE plpgsql VOLATILE; 
```

也许最好决定插入触发器，`doc_tip_cifra`在每个文档插入上插入 4 个空行，以避免对所有文档进行这种愚蠢的昂贵循环并为每个文档测试 4 次？你怎么看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:09:55.027

事实证明，您实际上并不需要计数。你[前面的问题](https://stackoverflow.com/q/11613257/939860)已经传达了这种印象。但是，在我的解决方案中`sum`替换它并不会让您走得太远。`max`

是的，它有效，但效率极低。找到匹配的行后，您不必遍历表的其余部分。这就是[**`EXISTS`半连接**](http://www.postgresql.org/docs/current/interactive/functions-subquery.html#FUNCTIONS-SUBQUERY-EXISTS)的用途。我提出了这种完全不同的方法：

```
INSERT INTO webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
SELECT id_documento, 901, 0, 0
WHERE  NOT EXISTS (
    SELECT 1
    FROM   webdte.doc_tip_cifra
    WHERE  id_doc = id_documento
    AND    id_tipo_cifra = 901
    );

INSERT INTO webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
SELECT id_documento, 902, 0, 0
WHERE  NOT EXISTS (
    SELECT 1
    FROM   webdte.doc_tip_cifra
    WHERE  id_doc = id_documento
    AND    id_tipo_cifra = 902
    );

INSERT INTO webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
SELECT id_documento, 905, 0, 0
WHERE  NOT EXISTS (
    SELECT 1
    FROM   webdte.doc_tip_cifra
    WHERE  id_doc = id_documento
    AND    id_tipo_cifra = 905
    );

INSERT INTO webdte.doc_tip_cifra (id_doc, id_tipo_cifra, tasa_imp, val_imp)
SELECT id_documento, 907, 0, 0
WHERE  NOT EXISTS (
    SELECT 1
    FROM   webdte.doc_tip_cifra
    WHERE  id_doc = id_documento
    AND    id_tipo_cifra = 907
    ); 
```

您可以将其包装在 plpgsql 或 sql 函数中，也可以将其作为普通 SQL 运行。

除了您前面的问题之外，这很可能会使用合适的索引。最佳将是一个[**多列索引**](http://www.postgresql.org/docs/current/interactive/indexes-multicolumn.html)，例如：

```
CREATE INDEX doc_tip_cifra_special_idx
ON webdte.doc_tip_cifra (id_doc, id_tipo_cifra); 
```

应该使您的查询闪电般快速。

此外，这种算法存在一个固有的**并发**问题。检查一行是否已经存在和插入它之间的时间窗口应该尽可能小。在这方面，将所有内容放在一个查询中是最佳选择。

不过，它并不*完美*。如果您的数据库看到很多并发，您可能会对[@depesz 的这篇优秀的博客文章感兴趣，或者](http://www.depesz.com/2012/06/10/why-is-upsert-so-complicated/)[在这个相关问题下](https://stackoverflow.com/q/11532550/939860)阅读更多内容。

* * *

是的，用触发器解决这个问题听起来是个好主意。我会做。

# android - 无法在android上写入文件txt

> ID：11623067
> 
> 赞同：0
> 
> 时间：2012-07-24T01:58:05.540
> 
> 标签：android, permissions, file-manager

我尝试制作短信日志，但我的设备发送这样的错误消息

```
07-18 10:11:33.956: E/One(1320): Could not write file /sdcard/log.txt (Permission denied) 
```

我写文件的代码

```
File root = Environment.getExternalStorageDirectory();
try 
{
    BufferedWriter fw = new BufferedWriter(new FileWriter(new File("/sdcard/log.txt"), true));
    if (root.canWrite()) 
    {
        fw.newLine();
        fw.write("----+ Monitoring SMS +----" + "\n");
        fw.write("- Pesan Masuk "+ "\n");
        fw.write(logSMS + "\n");
        fw.write("          ----+||+----" + "\n");
        fw.newLine();
        fw.close();
    } 
} catch (IOException e) {
    Log.e("One", "Could not write file " + e.getMessage());
} 
```

我的应用的清单权限

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.READ_SMS" />
<uses-permission android:name="android.permission.WRITE_SMS" />
<uses-permission android:name="android.permission.SEND_SMS" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />
<uses-permission android:name="android.permission.RECEIVE_MMS" />
<uses-permission android:name="android.permission.READ_CONTACTS"></uses-permission>
<uses-permission android:name="android.permission.WRITE_CALENDAR"></uses-permission>
<uses-permission android:name="android.permission.READ_CALENDAR"></uses-permission> 
```

我找不到任何错误，请帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:31:17.063

在某些设备上，sdcard 不在根目录中。

你想要做的是替换`"/sdcard/log.txt"`你`root + "/log.txt"`有SD卡但你不使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:21:19.467

您不能写入 SDCard 的根目录。在您的 SDCard 上创建一个文件夹，然后写入该文件夹。

[http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory) ()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:37:56.063

你能换个试试吗

```
BufferedWriter fw = new BufferedWriter(new FileWriter(new File("/sdcard/log.txt"), true)); 
```

和

```
BufferedWriter fw = new BufferedWriter(new FileWriter(new File(root.getAbsolutePath() + "/log.txt"), true)); 
```

这是为了确保您的代码正在写入系统分配的外部存储路径。因为它在不同的设备之间有所不同。

# jenkins - 如何从詹金斯通过电子邮件发送脚本输出？

> ID：11623070
> 
> 赞同：7
> 
> 时间：2012-07-24T01:59:10.833
> 
> 标签：jenkins, build-automation, jenkins-plugins

我正在设置一个处理一些数据的 Jenkins 作业。

工作完成后，我想让 jenkins 运行一个描述最近处理状态的脚本，并将该脚本的标准输出通过电子邮件发送到指定的电子邮件地址。

虽然我意识到可以让脚本自己发送电子邮件，但我想知道是否存在更理想的方式让 Jenkins 发送该脚本的输出。有没有适合这个想法的插件？

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-24T21:17:12.560

配置**Email-ext**插件：

要在邮件中获取部分日志（如果不是全部），请将“扩展电子邮件通知”设置为为每个失败的构建发送一封电子邮件，并在邮件正文中使用**$BUILD_LOG**：

1.  在消息正文中（在 '$DEFAULT_CONTENT' 下方）添加参数**$BUILD_LOG** 以显示构建日志的结尾
2.  假设日志是纯文本的，将“*内容类型*”更改为**纯文本**

有关内置 Jenkins 参数的列表，请转到此页面：

*   `http://[your-jenkins-server]/env-vars.html`

干杯

**编辑：**

要通过 UI 获取可用 env-vars 的列表，在**Execute shell**
构建步骤 中有一个链接，例如 -

 **[![通过 UI 链接到 Env-Vars 列表](../Images/4f1f650edda81dd682e8858961fa37a8.png)](https://i.stack.imgur.com/wNCAM.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T04:31:12.820

我不确定这是否正是您正在寻找的，但 Jenkins 的[Email-ext](https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin)插件听起来可能会满足您的需求。**

# php - PHP：将图片存储在文件目录中，图像名称在数据库中并检索图像

> ID：11623071
> 
> 赞同：2
> 
> 时间：2012-07-24T01:59:12.293
> 
> 标签：php

经过研究，我发现更建议将图像名称保存在数据库中，并将实际图像保存在文件目录中。少数几个原因中的两个是它更安全，图片加载速度更快。但是我并没有真正理解执行此过程的意义，因为每次我使用 firebug 工具检索图片时，我都可以在文件目录中找到可能导致潜在漏洞的图片路径。

我这样做是正确的还是不应该显示图像的完整文件目录路径？

用于将图像保存到数据库的 PHP

```
$images = retrieve_images();
    insert_images_into_database($images);

    function retrieve_images()
    {        
        $images = explode(',', $_GET['i']);

        return $images;
    }

    function insert_images_into_database($images)
    {
        if(!$images) //There were no images to return
            return false;        

       $pdo = get_database_connection();

        foreach($images as $image)
        {

            $path = Configuration::getUploadUrlPath('medium', 'target');
            $sql = "INSERT INTO `urlImage` (`image_name`) VALUES ( ? )";

            $prepared = $pdo->prepare($sql);
            $prepared->execute(array($image));
            echo ('<div><img src="'. $path . $image . '" /></div>');
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:16:42.120

您可以使用 .htaccess 来保护您的图像。

看这里：

[http://michael.theirwinfamily.net/articles/csshtml/protecting-images-using-php-and-htaccess](http://michael.theirwinfamily.net/articles/csshtml/protecting-images-using-php-and-htaccess)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:25:38.227

通过将图像存储在数据库中来实现您最初打算做的一种方法仍然是继续通过 PHP 脚本提供图像，因此：

1.  使您的用户不知道图像的实际路径。
2.  您可以并且应该将图像存储在您的外部`DocumentRoot`，以便 Web 服务器无法提供它们。

这是您可以通过以下方式实现的一种方法[`readfile()`](http://php.net/manual/en/function.readfile.php)：

```
<?php
// image.php

// Translating file_id to image path and filename
$path = getPathFromFileID($_GET['file_id']);
$image = getImageNameFromFileID($_GET['file_id']);

// Actual full path to the image file
// Hopefully outside of DocumentRoot
$file = $path.$image;

if (userHasPermission()) {
    readfile($file);
}
else {
    // Better if you are actually outputting an image instead of echoing text
    // So that the MIME type remains compatible
    echo "You do not have the permission to load the image";
}

exit; 
```

然后，您可以使用标准 HTML 提供图像：

```
<img src="image.php?file_id=XXXXX"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:38:31.937

我还在开发一个项目，该项目将图像的 url 路径存储在数据库 (Amazon RDS) 上，并将实际图像存储在 Amazon S3 的云管理文件系统中。

这样做的决定主要是出于对**价格、可扩展性和易于实施的考虑。**

**更便宜：**首先，与数据库（Amazon EC2 / RDS）相比，将数据存储在文件系统（Amazon S3）中更便宜。

**可扩展性：**由于图像存储库将来可能会变得非常大，您可能还需要确保您有足够的容量来为它们提供服务。在这一点上，与数据库相比，扩展文件系统更容易。事实上，如果您使用的是云存储（如 Amazon S3），您甚至不必担心没有足够的空间，因为它已由 Amazon 为您管理！你只需要为你使用的东西付费。

**易于实施：**在实施方面，将图像存储在文件系统中要容易得多。如果您要直接从数据库提供图像，您可能需要实现额外的逻辑来将 blob 文件转换为 html src blob 字符串以提供图像。从外观上看，这实际上可能会占用相当大的处理能力，这可能会减慢您的 Web 服务器的速度。

另一方面，如果您要使用文件系统，您只需将图像的 url 路径从数据库中放到图像的 src 属性中，一切就完成了！

**安全性：**至于图像的安全性，我已将图像名称更改为与随机字符串连接的时间戳，以便在不知道文件名的情况下浏览图片非常困难。

IE。1342772480UexbblEY7Xj3Q4VtZ.png

希望这可以帮助！

注意：如果您在这里发现任何问题，请编辑我的帖子！这只是我的意见，欢迎大家编辑！

# extjs4 - 未调用负载侦听器上的 extjs4

> ID：11623074
> 
> 赞同：0
> 
> 时间：2012-07-24T01:59:34.170
> 
> 标签：extjs4

如果这没有多大意义，请原谅我，因为我仍在尝试了解 extjs 的某些方面。我试图在加载页面时动态获取菜单。但似乎我的 MenuFetch() 函数没有被调用。

这是我的代码，这是页面： [http ://srikanthrajan.com/test/](http://srikanthrajan.com/test/)

```
 Center = Ext.create('Ext.panel.Panel', {
        title: "User Admin",
        region: 'center',
        layout: 'fit',
        dockedItems: {
            xtype: 'panel',
            dock: 'left',
            title: 'Main Menu',
            width: 160,
            layout: 'anchor',
            collapsible: true,
            collapseDirection: 'left',
            items: [
                {
                    defaults: {
                        width: 140,
                        layout: 'vbox',
                        xtype: 'linkbutton'
                    },
                    id: 'MainMenu',
                    xtype: 'panel',
                    listeners: {
                        load: function(menu) {
                            menu.show()
                            MenuFetch()
                            this.load()
                        }

                    }
                }
            ]
        }
});

//function that uses ajax to fetch menu items and add them
function MenuFetch() {
    Ext.getBody().mask('loading')
    var menu = Ext.ComponentManager.get('MainMenu')

    menu.removeAll(true)    
    Ext.Ajax.request({
        url: 'PanelScripts/getMenu.php',
        method: 'POST',

        callback: function(opt, success, response) {
            var text = response.responseText;
            var obj = Ext.JSON.decode(text);
            if (success && !obj.failure) {
                menu.add(obj)
                Ext.getBody().unmask()
                menu.show()
            } else {
                obj = Ext.JSON.decode(response.responseText);
                Ext.Msg.alert('Error',obj.Error)
                Ext.getBody().unmask()
            }
        }
    });
} 
```

PS：我不确定我是否需要负载监听器。基本上我需要调用 menuftech 函数，它以 json 格式获取菜单项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T07:01:02.760

使用 Ext.ComponentLoader（或加载器配置属性）为菜单加载远程内容。根据您要完成的工作，xtype 似乎应该是“菜单”而不是“面板”。尝试这样的事情：

```
var adminPanel = Ext.create('Ext.panel.Panel', {
    title: 'User Admin',
    region: 'center',
    layout: 'fit',
    dockedItems: {
        xtype: 'panel',
        dock: 'left',
        title: 'Main Menu',
        width: 160,
        layout: 'anchor',
        renderTo: Ext.getBody(),
        items:[
              {
                 xtype: 'menu',
                 width: 100,
                 loader: {
                     url: 'foo.bar',
                     autoLoad: true,
                     callback: function(loader, success, response, options) {
                         var menu = adminPanel.down('menu');
                         if (success) {
                           menu.add(response.items);
                           menu.show();
                         }
                     },
                     scope: this
                 }
             }
         ]
     }
 }); 
```

# plone - Plone 4.2 上的 anthill.exampletheme

> ID：11623077
> 
> 赞同：2
> 
> 时间：2012-07-24T02:00:08.333
> 
> 标签：plone

我正在尝试在 Plone 4.2 版上安装一个名为 anthill.exampletheme 0.2 的 Plone 皮肤，但它不断返回以下错误。扩展，anthill.skinner 0.8 安装并运行良好，但不是示例主题。请帮忙！

```
Traceback (innermost last):

    Module ZPublisher.Publish, line 126, in publish
    Module ZPublisher.mapply, line 77, in mapply
    Module ZPublisher.Publish, line 46, in call_object
    Module Shared.DC.Scripts.Bindings, line 322, in __call__
    Module Shared.DC.Scripts.Bindings, line 359, in _bindAndExec
    Module Products.CMFCore.FSPageTemplate, line 237, in _exec
    Module Products.CMFCore.FSPageTemplate, line 177, in pt_render
    Module Products.PageTemplates.PageTemplate, line 79, in pt_render
    Module zope.pagetemplate.pagetemplate, line 113, in pt_render
    Module zope.tal.talinterpreter, line 271, in __call__
    Module zope.tal.talinterpreter, line 343, in interpret
    Module zope.tal.talinterpreter, line 888, in do_useMacro
    Module zope.tal.talinterpreter, line 343, in interpret
    Module zope.tal.talinterpreter, line 533, in do_optTag_tal
    Module zope.tal.talinterpreter, line 518, in do_optTag
    Module zope.tal.talinterpreter, line 513, in no_tag
    Module zope.tal.talinterpreter, line 343, in interpret
    Module zope.tal.talinterpreter, line 583, in do_setLocal_tal
    Module zope.tales.tales, line 696, in evaluate
    URL: file:c:\plone42\eggs\anthill.exampletheme-0.2-py2.6.egg\anthill\exampletheme\skins\anthill_exampletheme_custom_templates\main_template.pt
    Line 9, Column 0
    Expression: <PathExpr standard:u'language'>
    Names:

    {'container': <PloneSite at /test>,
     'context': <PloneSite at /test>,
     'default': <object object at 0x00991838>,
     'here': <PloneSite at /test>,
     'loop': {},
     'nothing': None,
     'options': {'args': ()},
     'repeat': <Products.PageTemplates.Expressions.SafeMapping object at 0x08794A20>,
     'request': <HTTPRequest, URL=http://localhost:8080/test/portal_skins/index_html>,
     'root': <Application at >,
     'template': <FSPageTemplate at /test/index_html>,
     'traverse_subpath': [],
     'user': <PropertiedUser 'admin'>}

    Module zope.tales.expressions, line 217, in __call__
    Module Products.PageTemplates.Expressions, line 147, in _eval
    Module zope.tales.expressions, line 118, in _eval

KeyError: 'language' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:23:23.590

根据：

*   [https://dev.plone.org/ticket/10676](https://dev.plone.org/ticket/10676)

[anthill.exampletheme](https://pythonpackages.com/package/anthill.exampletheme)的 main_template 与 Plone 4 不兼容。将其 main_template 替换为 Plone 4 main_template（例如来自 sunburst），您可能会走得更远。

# winapi - 按 Alt 会挂起应用程序

> ID：11623085
> 
> 赞同：0
> 
> 时间：2012-07-24T02:01:55.793
> 
> 标签：winapi

我正在编写一个没有菜单的 Windows 应用程序。每次我按下 Alt 时，它都会收到 WM_ENTERMENULOOP 事件并挂起，直到我按下一个键。
我尝试过其他没有菜单的应用程序（例如 MS .chm 文件查看器），它们表现出相同的行为。
将事件转发到 DefWindowProc 或处理它没有区别。

如果没有菜单，有没有办法阻止 Windows 进入菜单循环？或者，有没有办法在收到事件后立即手动退出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T06:37:21.583

如果要禁用进入菜单循环，请处理`WM_SYSKEYDOWN`并`WM_SYSKEYUP`手动（不要将它们传递给）。`DefWindowProc`

此外，您可能希望处理`WM_SYSCHAR`并返回`TRUE`此消息，以避免像`Alt`+这样的击键发出哔哔声`SomeKey`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-11-18T14:52:49.643

解析窗口消息并返回正确结果后的可伸缩代码，不调用 DefWindowProc。

```
case WM_SYSKEYDOWN:
case WM_SYSKEYUP:
case WM_SYSCHAR:
    return (LRESULT)1; 
```

[https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-syskeydown](https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-syskeydown)

[https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-syskeyup](https://docs.microsoft.com/en-us/windows/win32/inputdev/wm-syskeyup)

[https://docs.microsoft.com/en-us/windows/win32/menurc/wm-syschar](https://docs.microsoft.com/en-us/windows/win32/menurc/wm-syschar)

> 返回值
> 
> 如果应用程序处理此消息，它应该返回零。

# php - 从文本框鼠标离开 Codeigniter 调用验证方法

> ID：11623086
> 
> 赞同：0
> 
> 时间：2012-07-24T02:01:59.817
> 
> 标签：php, codeigniter, codeigniter-2

是否可以从“输入框”等视图元素调用位于控制器中的验证函数。例如：gmail 注册页面用户名字段在鼠标离​​开时验证...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:09:59.640

您需要使用 ajax 来执行此操作。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)的文档`$.ajax();`

```
$.ajax({
  url: "url/to/controller/validationaction",
  success: function(data){
    //do something since validation
    //passed.
  },
  error: function(d,r,x){
    //do something since validation
    //failed.
  }
}); 
```

是一个非常非常补救的例子。

您的控制器将使用返回 http 失败状态代码

```
$this->output->set_status_header(code, 'text'); 
```

[链接到 CI 的输出文档](http://codeigniter.com/user_guide/libraries/output.html)

[http状态码列表](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

如果验证失败，否则`return TRUE;`回显消息的 json_encoded 数组。

```
$message = array(
  'message' => 'Success!',
  'type' => 'succes',
);
echo json_encode($message); 
```

## 使用 jQuery 验证

您还可以依靠 jquery/javascript 来处理您的验证客户端，这将防止您必须发出 http 请求来验证用户的输入。

一个流行的插件是：[http ://bassistance.de/jquery-plugins/jquery-plugin-validation/](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)

应该注意的是，如果用户禁用 jquery/javascript，您需要有一个故障安全方法，该方法仍将通过 codeigniters 表单验证助手进行验证。

# java - 通过多线程的 Java 代理连接

> ID：11623093
> 
> 赞同：1
> 
> 时间：2012-07-24T02:02:37.990
> 
> 标签：java, multithreading

我有几个问题如下：

1) 我有一个 Java 程序，它尝试使用多线程（大约 100 个线程）通过不同的代理服务器进行连接。我可以知道哪些因素决定了此类连接的最大数量？我们的操作系统允许在一个进程中拥有的代理连接（或非代理）的最大数量实际上是多少？

2）根据我的经验，当我想在我的电脑中设置代理服务器时，我会到IE的“选项设置”中进行更改。当我使用谷歌浏览器时，代理设置也会通过IE的“选项设置”（我不知道为什么chrome使用IE的功能）。那么，我可以假设我们的操作系统一次只允许一个代理服务器连接吗？

```
Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(ipAdd, portNum));
HttpURLConnection uc = (HttpURLConnection)Main.targetMachine.openConnection(proxy);
uc.setConnectTimeout(Main.timeOut);
uc.setReadTimeout(Main.timeOut); 
```

我创建了多个线程来处理上述连接。他们给了我所有的“超时”错误。可能是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T14:50:54.673

因为服务器配置为仅响应来自特定节点的几个连接线程，因此如果进行多个连接，则出现上述错误只需找到最佳连接数并设置它

# function - VB6 如何使函数在我的所有表单上全局工作？

> ID：11623096
> 
> 赞同：4
> 
> 时间：2012-07-24T02:03:00.567
> 
> 标签：function, vb6, global

我不敢相信我找不到让我的函数在全球范围内工作的方法......目前我在所有 3 个表单的顶部都有这个相同的函数：

```
Public Function HTMLEncode(p_strText As String) As String
Dim strTemp As String
    strTemp = p_strText
    strTemp = Replace(strTemp, "ó", "&oacute;")
    '... around 30-40 lines more like these ...
    strTemp = Replace(strTemp, "ÿ", "&yuml;")
  HTMLEncode = strTemp
End Function 
```

但这不仅是一种[反模式](http://en.wikipedia.org/wiki/Anti-pattern#Programming_anti-patterns)，而且真的很难维护，而且它给我的代码带来了很多垃圾邮件

我通常不使用 VB 编程，所以我为新手问题道歉。但是我已经找了好几个小时了，我不能因为这个而失去更多的头发或时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T02:07:33.450

从项目菜单中，选择“添加模块”，然后将您的函数移动到该模块中，将其保留为`Public`. 您应该能够从其他表单中注释掉其他函数，因为它现在可以调用此公共函数。

# java - 带有将内置的 plist 文件的 Android FileNotFound 异常

> ID：11623097
> 
> 赞同：0
> 
> 时间：2012-07-24T02:03:36.493
> 
> 标签：java, android, filenotfoundexception

我正在尝试为我正在制作的 Android 应用程序打开一个文件。我在常规 Java 项目上测试了打开此文件的代码，并且可以正常打开。但是，当我在 Android Java 项目中使用此代码时，出现 java.io.FileNotFoundException 错误。

```
File file = new File ("list.plist"); 
```

现在 list.plist 文件位于项目的父目录中。该文件将包含在应用程序中，因为它是唯一将使用的文件。

我想我已经习惯了 Xcode，我可以将文件放在项目中的任何位置，并且可以毫无问题地访问它。

我应该如何构建这条路径？

谢谢 ：-）

我用过这个，但它也没有用。

`File file = new File(context.getFilesDir().getAbsoluteFile(), "list.plist");`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:06:09.193

您需要将此文件放在资产目录中，而不是放在父文件夹中。父文件夹中的任何文件都不需要与应用程序一起打包。此外，您在手机上的文件结构与您在 eclipse 中看到的不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:06:10.290

您应该使用“res/raw”或“assets”目录在您的 Android 项目中包含原始文件。见：http: [//developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:57:41.777

首先，您需要确保您使用的文件被打包在您的应用程序中 - 例如在资产目录中。

其次，Android会根据扩展名自动压缩plist文件。作为一种解决方法，将扩展名更改为 Android 不会压缩的内容。这些扩展包括：

```
".jpg", ".jpeg", ".png", ".gif",
".wav", ".mp2", ".mp3", ".ogg", ".aac",
".mpg", ".mpeg", ".mid", ".midi", ".smf", ".jet",
".rtttl", ".imy", ".xmf", ".mp4", ".m4a",
".m4v", ".3gp", ".3gpp", ".3g2", ".3gpp2",
".amr", ".awb", ".wma", ".wmv" 
```

（有关完整文章，请参阅[deal-with-asset-compression-in-android-apps](http://ponystyle.com/blog/2010/03/26/dealing-with-asset-compression-in-android-apps/)）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T16:36:56.113

我将 list.plist 添加到 assets 文件夹并将其重命名为 list.mp3 以避免压缩问题。

```
AssetManager assetManager = getAssets();
InputStream inputStream = assetManager.open("list.mp3"); 
```

这成功地打开了文件，没有问题，现在允许我解析 inputStream。

感谢菲尔给了我正确的方向。

# substring - 寻找一种从linux中的文本文件中提取模式的方法

> ID：11623098
> 
> 赞同：0
> 
> 时间：2012-07-24T02:03:53.123
> 
> 标签：substring, design-patterns

我正在使用 linux 和 bash。我有一个文本文件，其中包含其他程序在运行时生成的上下文。文本文件的长度、行数和内容不时发生变化。但是文中有一些模式没有改变，一个典型的例子是

123098230984LD#2e3 123098230984LD#23234 XER_3424324_23424 33:34:35: 节点:9-72-1408 &82 &34 $1231313 *3435322 链接到端口:323 3424242424LD#2234 2424332

在这里，我想提取模式“node:NUMBER-NUMBER-NUMBER”和“port:NUMBER”，但它在文本中出现的位置也不时变化。现在我手动提取信息。我想知道是否有任何方法可以自动提取信息。真正困难的是每次生成文件时内容都会发生变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:10:05.787

您可以`sed`通过删除不需要的位来提取所需的字段：

```
pax> echo 'junk node:9-72-1408 more junk port:323 last junk'
     | sed -E 's/^.*(node:[0-9]+-[0-9]*-[0-9]*).*(port:[0-9]+).*$/\1 \2/'
node:9-72-1408 port:323 
```

这些`.*`位仅代表任何垃圾，括号用于“捕获”匹配的文本，以便可以在替换中使用它（as`\1`和`\2`）。

* * *

**侧边栏：**

如果您的版本`sed`不支持`-E`扩展正则表达式，它可能支持`-r`，就像某些版本的 GNU 一样`sed`。

否则，您需要转义括号和`+`字符：

```
pax> echo 'junk node:9-72-1408 more junk port:323 last junk'
     | sed  's/^.*\(node:[0-9]\+-[0-9]\+-[0-9]\+\).*\(port:[0-9]\+\).*$/\1 \2/'
node:9-72-1408 port:323 
```

GNU sed 的源代码包含这个小片段：

```
/* Undocumented, for compatibility with BSD sed.  */
    case 'E':
    case 'r': 
```

但这似乎是在 4.2 中引入的（即，它在 4.2 中，但不是在 4.1.5 中，这是 4.1 系列的最后一个）。有关详细信息，请参见[此处](http://ftp.gnu.org/gnu/sed/)。

* * *

而且，如果您需要变量中的实际值，您可以使用以下内容：

```
pax> inpstr='junk-here node:9-72-1408 more-junk port:323 last-junk'

pax> node=$(echo "$inpstr" | sed -E 's/^.*node:([0-9]+-[0-9]+-[0-9]+).*$/\1/')

pax> port=$(echo "$inpstr" | sed -E 's/^.*port:([0-9]+).*$/\1/')

pax> echo $inpstr
junk-here node:9-72-1408 more-junk port:323 last-junk

pax> echo $node
9-72-1408

pax> echo $port
323 
```

（考虑到早期关于使用`-r`或添加额外转义用于“较小”`sed`实现的评论）。

# c++ - 在 MSVC 2010 上使用 bjam 构建 Boost 1.50 时出错

> ID：11623100
> 
> 赞同：0
> 
> 时间：2012-07-24T02:04:12.537
> 
> 标签：c++, visual-c++, boost, compiler-errors, bjam

在 MSVC 2010 上使用 bjam 构建 Boost 1.50

我正在尝试使用 MSVC 2010 构建最新的 Boost (1.50)。我在同一台机器 (Windows Vista) 上安装了 MSVC 2003 和 2008，并且已经能够使用这两个工具集成功构建 Boost 1.50。但是我在使用 msvc 2010 时遇到了问题。

以下是我调用 bootstap.bat 后使用的 bjam 命令：

```
bjam --without-mpi --without-python --toolset=msvc-7.1 --build-type=complete -d+2
bjam --without-mpi --without-python --toolset=msvc-9.0 --build-type=complete -d+2
bjam --without-mpi --without-python --toolset=msvc-10.0 --build-type=complete -d+2 
```

在构建 MSVC 2010 时，我收到以下错误消息：

```
file bin.v2\libs\exception\build\msvc-10.0\release\link-static\runtime-link-static\clone_current_exception_non_intrusive.obj.rsp
"libs\exception\src\clone_current_exception_non_intrusive.cpp" -Fo"bin.v2\libs\exception\build\msvc-10.0\release\link-static\runtime-link-static\clone_current_exception_non_intrusi
ve.obj"    -TP /O2 /Ob2 /W3 /GR /Zc:forScope /Zc:wchar_t /MT /wd4675 /EHs -c
-DBOOST_ALL_NO_LIB=1
-DNDEBUG
"-I."
compile-c-c++ bin.v2\libs\exception\build\msvc-10.0\release\link-static\runtime-link-static\clone_current_exception_non_intrusive.obj

    call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" x86 >nul
cl /Zm800 -nologo @"bin.v2\libs\exception\build\msvc-10.0\release\link-static\runtime-link-static\clone_current_exception_non_intrusive.obj.rsp"

Command line error D2016 : '/Ze' and '/Za' command-line options are incompatible
...skipped <pbin.v2\libs\exception\build\msvc-10.0\release\link-static\runtime-link-static>libboost_exception-vc100-s-1_50.lib for lack of <pbin.v2\libs\exception\build\msvc-10.0\r
elease\link-static\runtime-link-static>clone_current_exception_non_intrusive.obj...
...skipped <pstage\lib>libboost_exception-vc100-s-1_50.lib for lack of <pbin.v2\libs\exception\build\msvc-10.0\release\link-static\runtime-link-static>libboost_exception-vc100-s-1_
50.lib...

file bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\codecvt_error_category.obj.rsp
"libs\filesystem\src\codecvt_error_category.cpp" -Fo"bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\codecvt_error_category.obj"    -TP /O2 /Ob2 /W3
/GR /Zc:forScope /Zc:wchar_t /MT /wd4675 /EHs -c
-DBOOST_ALL_NO_LIB=1
-DBOOST_FILESYSTEM_STATIC_LINK=1
-DBOOST_SYSTEM_STATIC_LINK=1
-DNDEBUG
"-I."
compile-c-c++ bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\codecvt_error_category.obj

    call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" x86 >nul
cl /Zm800 -nologo @"bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\codecvt_error_category.obj.rsp"

Command line error D2016 : '/Ze' and '/Za' command-line options are incompatible

file bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\operations.obj.rsp
"libs\filesystem\src\operations.cpp" -Fo"bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\operations.obj"    -TP /O2 /Ob2 /W3 /GR /Zc:forScope /Zc:wch
ar_t /MT /wd4675 /EHs -c
-DBOOST_ALL_NO_LIB=1
-DBOOST_FILESYSTEM_STATIC_LINK=1
-DBOOST_SYSTEM_STATIC_LINK=1
-DNDEBUG
"-I."
compile-c-c++ bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\operations.obj

    call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" x86 >nul
cl /Zm800 -nologo @"bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\operations.obj.rsp"

Command line error D2016 : '/Ze' and '/Za' command-line options are incompatible

file bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\path.obj.rsp
"libs\filesystem\src\path.cpp" -Fo"bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\path.obj"    -TP /O2 /Ob2 /W3 /GR /Zc:forScope /Zc:wchar_t /MT /wd
4675 /EHs -c
-DBOOST_ALL_NO_LIB=1
-DBOOST_FILESYSTEM_STATIC_LINK=1
-DBOOST_SYSTEM_STATIC_LINK=1
-DNDEBUG
"-I."
compile-c-c++ bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\path.obj

    call "C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\vcvarsall.bat" x86 >nul
cl /Zm800 -nologo @"bin.v2\libs\filesystem\build\msvc-10.0\release\link-static\runtime-link-static\path.obj.rsp"

Command line error D2016 : '/Ze' and '/Za' command-line options are incompatible 
```

除了执行上述命令行之外，我对 bjam 的经验很少。我相信一切都设置正确，所有编译器都在 PATH 环境变量中。例如：

```
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\bin
C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin 
```

此外，我看不到在 msvc 的 bjam 配置中定义了“/Ze”和“/Za”的位置。

还有什么我想念的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T19:42:29.250

您是否尝试过从 Visual Studio 命令提示符（在您的开始菜单上找到）启动 bjam，而不是将编译器添加到路径中？

我从来没有在 PATH 上放任何东西——我只是运行它，去 boost 文件夹，引导和构建。

# zend-framework - Symfony 集成 Zend Lucene 搜索

> ID：11623101
> 
> 赞同：1
> 
> 时间：2012-07-24T02:04:24.153
> 
> 标签：zend-framework, search, symfony1, lucene

我一直在关注 Jobeet 教程，以便将 Zend Lucene 搜索集成到我的 Symfony 项目中，但我似乎无法让它工作。我已将以下代码添加到我的 config/ProjectConfiguration.class.php

```
class ProjectConfiguration extends sfProjectConfiguration
{

  static protected $zendLoaded = false;

  static public function registerZend()
  {
    if (self::$zendLoaded)
    {
      return;
    }

    set_include_path(sfConfig::get('sf_lib_dir').'/vendor'.PATH_SEPARATOR.get_include_path());
    require_once sfConfig::get('sf_lib_dir').'/vendor/Zend/Loader/Autoloader.php';
    Zend_Loader_Autoloader::getInstance();
    self::$zendLoaded = true;
  } 
```

我也将此代码添加到我的 CarTable.class.php

```
 static public function getLuceneIndex()
    {
      ProjectConfiguration::registerZend();

      if (file_exists($index = self::getLuceneIndexFile()))
      {
        return Zend_Search_Lucene::open($index);
      }

      return Zend_Search_Lucene::create($index);
    }

    static public function getLuceneIndexFile()
    {
      return sfConfig::get('sf_data_dir').'/car.'.sfConfig::get('sf_environment').'.index';
    } 
```

最后，我将以下代码添加到我的 Car.class.php

```
 public function updateLuceneIndex()
    {
      $index = CarTable::getLuceneIndex();

      foreach ($index->find('pk:'.$this->getIditem()) as $hit)
      {
        $index->delete($hit->id);
      }

      if (!$this->getActivated())
      {
        return;
      }

      $doc = new Zend_Search_Lucene_Document();

      $doc->addField(Zend_Search_Lucene_Field::Keyword('pk', $this->getIditem()));

      $doc->addField(Zend_Search_Lucene_Field::UnStored('title', $this->getTitle(), 'utf-8'));
      $doc->addField(Zend_Search_Lucene_Field::UnStored('features', $this->getFeatures(), 'utf-8'));
      $doc->addField(Zend_Search_Lucene_Field::UnStored('location_city', $this->getLocation_city(), 'utf-8'));
      $doc->addField(Zend_Search_Lucene_Field::UnStored('location_state', $this->getLocation_state(), 'utf-8'));

      $index->addDocument($doc);
      $index->commit();
    }

    public function delete(Doctrine_Connection $conn = null)
    {
      $index = CarTable::getLuceneIndex();

      foreach ($index->find('pk:'.$this->getIditem()) as $hit)
      {
        $index->delete($hit->id);
      }

      return parent::delete($conn);
    } 
```

当然，我在保存函数中添加了这几行：

```
 $conn = $conn ? $conn : $this->getTable()->getConnection();
      $conn->beginTransaction();
      try
      {
        $ret = parent::save($conn);

        $this->updateLuceneIndex();

        $conn->commit();

        return $ret;
      }
      catch (Exception $e)
      {
        $conn->rollBack();
        throw $e;
      } 
```

我已将 Zend 框架的“库”文件夹的内容提取到我的 lib/vendor/Zend 文件夹中。

但是每次我运行命令

```
php symfony doctrine:data-load 
```

它一直运行并加载我所有的装置，但它不会在我的数据文件夹中创建包含索引文件的文件夹。我不确定我做错了什么。

这是我的参考资料（Jobeet 教程） [http://www.symfony-project.org/jobeet/1_4/Doctrine/en/17](http://www.symfony-project.org/jobeet/1_4/Doctrine/en/17)

顺便说一句，我使用的是 Symfony 1.4 (Doctrine)。

# jquery - Jquery Li 图片库

> ID：11623106
> 
> 赞同：1
> 
> 时间：2012-07-24T02:04:55.180
> 
> 标签：jquery, html, jquery-plugins, css, html-lists

我如何将所有 li 隐藏在 ul 中，而 ul 不是最上面的那个。

代码：http: [//jsfiddle.net/mSmbv/375/](http://jsfiddle.net/mSmbv/375/)

我需要顶部的 li 是唯一隐藏的。所有其他人都应该隐藏起来，直到它们向上滑动到视图中并且顶部滑动到底部。

编辑：我已经到了可以让它们滑入和滑出的地步，但我更喜欢漂亮的淡入/淡出，其中当前的 nad next li 彼此淡入。[http://jsfiddle.net/mSmbv/386/](http://jsfiddle.net/mSmbv/386/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T06:40:27.560

使用您当前的代码，我会使用 CSS3 选择器。

```
#rotated li
{
    display: none;
}

#rotated li:nth-child(1)
{
    display: list-item;
} 
```

我会尝试这些方面的东西。您还可以使用 jQuery 将您的 CSS 效果转换为存在和不存在。在最坏的情况下，您可以通过指定一个强制显示和您正在寻找的样式的 !important CSS 类来遍历 LI 的集合。

祝你好运！

# javascript - java 脚本错误对象不支持此属性或方法

> ID：11623107
> 
> 赞同：0
> 
> 时间：2012-07-24T02:04:57.353
> 
> 标签：javascript, jsf-2

由于某种原因，微调器对象只有在 startSpin() 函数中定义时才有效。

这是非工作代码：

```
<script type="text/javascript" src="resources/js/spin.js"></script>
    <script type="text/javascript">
        var opts = {
            lines: 18, // The number of lines to draw 
            length: 40, // The length of each line
            top: 'auto', // Top position relative to parent in px
            left: 'auto' // Left position relative to parent in px
        };

         // -- not support ? 
        var target = document.getElementById('spin');
        var spinner = new Spinner(opts).spin(target);
        // -- ???
        function startSpin()
        {
            spinner.start();   
        }
        function stopSpin()
        {
            spinner.stop();  
        }

        function showStatus() {
            startSpin();
            statusDialog.show();
        }

        function hideStatus() {
            stopSpin();
            statusDialog.hide();
        }
    </script>
    <h:form id="testfm">
        <p:commandButton id="start" type="submit" 
                         ajax="false" 
                         value="test" 
                         actionListener="#{bean.test}" 
                         onclick="PrimeFaces.monitorDownload(showStatus, hideStatus)"/>
        <p:dialog modal="true" 
                  widgetVar="statusDialog" 
                  showHeader="false"
                  draggable="false" 
                  closable="false" 
                  resizable="false">
            <div id="spin" class="spinner"/>
        </p:dialog>
    </h:form> 
```

微调器仅在 spinStart 函数中定义时才工作

我尝试使用脚本位置，但仍然收到相同的消息，知道为什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:21:07.107

您`document.getElementById('spin')`在该函数之外运行，`id=spin`尚未创建带有的元素，因此您为微调器提供了一个空值。如果你在里面创建它`startSpin`，它是为了响应来自用户的点击事件，所以 DOM 很可能在那个时候已经构建并且元素存在。这是一种解决方法：

```
 var spinner;  //Lave the variable out here so both functions can see it

    function startSpin() {
        var target = document.getElementById('spin');
        spinner = new Spinner(opts).spin(target);  //Actually create it here, when the element exists
        spinner.start();   
    }
    function stopSpin() {
        spinner.stop();  
    } 
```

您也可以保留代码原样并将其放在文档的末尾，就在`</body>`标签之前。

# jpa-2.0 - 是否可以将通配符添加到 @Query 参数？

> ID：11623113
> 
> 赞同：11
> 
> 时间：2012-07-24T02:05:53.653
> 
> 标签：jpa-2.0, spring-data, spring-data-jpa

我将我的 ContactDao 定义如下：

```
public interface ContactDao extends JpaRepository<Contact, Long> {

  /**
   * Finds all contacts that the given user has entered where the contact's full name matches {@code name}.
   * @param userId The current user's LDAP id.
   * @param name The name to search for.
   * @return A list of contacts matching the specified criteria.
   */
  @Query(" select c from Form as f" +
           " inner join f.contacts as c" +
           " where f.requestorUserId = :userId" +
           " and lower(c.fullName) like lower(:name)" +
           " order by lower(c.fullName)")
  List<Contact> findUserContactsByUserIdAndName(@Param("userId") String userId, @Param("name") String name);

} 
```

以上工作完美，生成的 SQL 是我自己编写的。问题是我想在`:name`参数中添加周围的通配符。有什么好方法可以做到这一点吗？我查看了 Spring Data JPA 参考文档，但找不到任何关于通配符和`@query`.

以下hack有效，但有点难看：

```
and lower(c.fullName) like '%' || lower(:name) || '%' 
```

有没有人有更好的解决方案？

谢谢，穆尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:10:06.427

我也不会称其为 hack - 这是针对这些问题定义 JPQL 语法的方式。

但是，还有一个使用[CriteriaBuilder/CriteriaQuery](http://docs.oracle.com/javaee/6/api/javax/persistence/criteria/CriteriaBuilder.html#like%28javax.persistence.criteria.Expression,%20javax.persistence.criteria.Expression%29)的替代方法，但也许您会发现它更加复杂（但您会获得编译时类型安全性作为回报）。

# vim - 为什么 mvim clear 在启动时突出显示组？

> ID：11623114
> 
> 赞同：2
> 
> 时间：2012-07-24T02:06:00.783
> 
> 标签：vim, macvim

我最近开始将[vim-makegreen](https://github.com/reinh/vim-makegreen)与 mvim 一起使用。

问题是红/绿条不适用于 mvim。它们确实与 mvim -v （或其他控制台 vim）一起工作。

经过进一步调查，似乎定义为的突出显示组：

```
hi GreenBar term=reverse ctermfg=white ctermbg=green guifg=white guibg=green
hi RedBar   term=reverse ctermfg=white ctermbg=red guifg=white guibg=red 
```

在调用 .gvimrc 文件之前，makegreen.vim 中的内容被 mvim 清除。mvim 启动后，我得到：

```
:hi RedBar
RedBar         xxx cleared    

:hi GreenBar
GreenBar         xxx cleared 
```

有没有人知道为什么 mvim 会破坏高亮组？到目前为止，我发现的唯一解决方法是在 .gvimrc 中重新定义它们。但这显然是一种痛苦。试图弄清楚我是否在这里遗漏了什么。

## 更新

我只是剥离了我的 .vimrc 并使用病原体，我只将 makegreen 放在捆绑目录中。结果是相同的行为。

我的 .vimrc 只有一行：

```
call pathogen#infect() 
```

捆绑目录仅包含 makegreen 捆绑。autoload 目录中只有pathogen.vim。我删除了.gvimrc。

然后我启动 mvim 并执行`:hi RedBar`并得到与上面相同的结果。我使用了 echo 语句来确认 makegreen.vim 的来源。

我安装了 mvim `brew install macvim`。macvim 的版本是 7.3(64)，我在 OSX Lion 上。

## 更新 2

我只是更进一步，消除了对病原体的依赖。现在我在插件目录中只有 makegreen.vim 和一个空的 .vimrc 文件。结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-06T15:31:44.707

Add `let macvim_skip_colorscheme=1` to your `~/.vimrc`. See the comment before the colorscheme is loaded in your global `gvimrc`:

```
" Load the MacVim color scheme.  This can be disabled by loading another color
" scheme with the :colorscheme command, or by adding the line
"   let macvim_skip_colorscheme=1
" to ~/.vimrc.
if !exists("macvim_skip_colorscheme") && !exists("colors_name")
    colorscheme macvim
endif 
```

All color schemes clear the highlights.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-21T02:36:42.753

我有同样的问题。`~/.vimrc`解决方法是在（或`python.vim`等）中重新定义 GreenBar 和 RedBar

# c# - 无法使用 asp.net mvc 3 获取事件模糊

> ID：11623121
> 
> 赞同：1
> 
> 时间：2012-07-24T02:07:04.197
> 
> 标签：c#, javascript, asp.net-mvc-3, events, onblur

大家好，我一直在努力如何从 asp.net mvc 3 强类型视图中获取事件模糊。这是我尝试过的。

```
<table>
 <td class="contentTable">
     @Html.LabelFor(model => model.Ciudad)
  </td>
  <td>
     @Html.EditorFor(model => model.Ciudad, new{id= "mapSearch"})
     @Html.ValidationMessageFor(model => model.Ciudad)
 </td>
</table>

<script type="text/javascript">
    $(function () {
        $('#mapSearch').blur(function () {
           myFunction();
       });
});
</script> 
```

myFunction 已经是我正在使用的由按钮触发的函数，但现在我希望它由事件触发。我也尝试过：

```
@Html.EditorFor(model => model.Ciudad, new{onblur= "mapSearch();"}) 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:10:35.013

试试这个。像这样更改您的视图标记

```
@Html.EditorFor(model => model.Ciudad) 
```

和这样的脚本

```
$(function () {
    $('#Ciudad').blur(function () {
           myFunction();
    });
}); 
```

假设你有一个叫做`myFunction`存在的 javascript 函数

```
function myFunction() {
        console.debug("myFunction Called");
       //Some other awesome stuff here
} 
```

JsFiddle 示例：http: [//jsfiddle.net/C3wMY/4/](http://jsfiddle.net/C3wMY/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T10:55:24.843

EditorFor 没有采用 html 属性的覆盖。在“EditorFor”级别，它不知道可能会插入哪些元素或如何获取它们的属性。您需要使用 TextBoxFor、DropDownListFor 或其他添加特定元素的助手。或者，如果您使用的是编辑器，则需要在编辑器模板中添加属性。如果需要，您可以将属性传递给模板，但作为模型的一部分（或 ViewBag 或其他方式）。

# c++ - C++ 构造函数和并发

> ID：11623124
> 
> 赞同：6
> 
> 时间：2012-07-24T02:07:27.333
> 
> 标签：c++, concurrency, constructor

我一直在考虑编写一个容器类来控制对将在多线程环境中使用的复杂数据结构的访问。

然后我想到了一个问题：

是否存在 C++ 构造函数必须是线程安全的情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T02:11:36.507

通常，两个线程不能同时为*同一个对象调用构造函数。*但是，当然可以同时为*不同*的对象调用相同的构造函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T02:09:54.237

当然，您可以一次从多个线程调用相同的构造函数。从这个意义上说，它们必须是线程安全的，就像任何其他函数一样。如果构造函数要修改共享状态，例如您的容器，那么您必须使用同步来确保以确定的方式修改状态。

你不能一次在多个线程上构造同一个对象，因为每个对象只构造一次，所以没有办法在同一个对象上多次调用构造函数，更不用说同时在两个不同的线程上.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-24T07:09:14.520

不是我的经验。它是*调用*构造函数的代码，无论是隐式的还是其他的，如果应用程序需要它，则需要使其成为线程安全的。

基本原理是一次只有一个线程应该初始化一个对象，因此不需要同步来保护在构造函数本身内初始化的对象（如果对象尚未完成初始化，则无论如何都不应该在线程之间共享）。

另一种看待它的方式是：在其构造函数返回之前，对象将被视为逻辑上不存在。因此，正在创建对象的线程是唯一“知道”它的线程。

当然，适当的同步规则适用于构造函数*本身*访问的任何共享资源，但这适用于任何函数（我遇到过没有意识到这一点的人，他们认为构造函数是特殊的，并且以某种方式提供对所有资源的独占访问）。

# jquery - 无法使 jqGrid 中的可编辑列可编辑

> ID：11623126
> 
> 赞同：0
> 
> 时间：2012-07-24T02:07:41.757
> 
> 标签：jquery, jqgrid

我搜索了所有可用的资源，但无济于事。我试图使一列可编辑（参见下面的第 7 列），但到目前为止没有任何效果。我已经将可编辑属性设置为 true。我的猜测是它与网格属性集有关，但我无法弄清楚我需要编辑哪个属性，以便我的可编辑列可以工作。

```
$('#pGrdList0').jqGrid({
    "url" : "clientArray",
    "editurl" : "server.php",
    "datatype" : "local",
    "width" : "900",
    "height" : "338",
    "rowNum" : "1000",
    "colNames" : 
        [ "1", "2", "3", "4", "5", "6", "7", "8", "9", "10" ],
    "colModel" :
        [ {"name" : "g1", "index" : "g1", "width" : "115", "align" : "left", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g2", "index" : "g2", "width" : "15", "align" : "right", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g3", "index" : "g3", "width" : "68", "align" : "right", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g4", "index" : "g4", "width" : "68", "align" : "right", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g5", "index" : "g5", "width" : "68", "align" : "right", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g6", "index" : "g6", "width" : "68", "align" : "right", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g7", "index" : "g7", "width" : "68", "align" : "right", "formatter" : numberFormatter, "formatoptions" : {thousandsSeparator:',',decimalPlaces:0,defaultValue:''}, "editoptions" : "{maxlength: 9, dataInit:setImeDisabled}", "editable" : true},
          {"name" : "g8", "index" : "g8", "width" : "68", "align" : "right", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g9", "index" : "g9", "width" : "80", "align" : "right", "edittype" : null, "formatter" : null, "formatoptions" : null, "editoptions" : null, "editable" : false},
          {"name" : "g10", "index" : "g10", "width" : "215", "align" : "left", "edittype" : "text", "formatter" : null, "formatoptions" : null, "editoptions" : {maxLength:30, dataInit:setImeEnabled}, "editable" : true} ],
    "pager" : "#pGrdList0nav",
    "viewrecords" : false,
    "cellEdit" : true,
    "cellsubmit" : "clientArray",
    "multiselect" : false,
    "forceFit" : false,
    "shrinkToFit" : false,
    "pgbuttons" : false,
    "pginput" : false,
    "pgtext" : false,
    "onCellSelect": function(rowid, iCol, cellcontent, e) {
        var grid = $('#pGrdShinkoujoukenichiran0');
        grid.setSelection(rowid, true);
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T11:31:39.247

好吧，我发现您的代码没有任何问题，我没有对其进行测试，但我认为您应该这样编写

可编辑：真....不带双引号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T19:11:53.017

我也遇到过类似的事情……请记住，jqgrid 是模块化的，因此您必须请求将编辑选项包含在您的副本中。

所以当你下载 jqgrid 时，一定要检查所有的编辑选项。

# mongodb - MongoDB/GridFS 磁盘空间不足

> ID：11623128
> 
> 赞同：1
> 
> 时间：2012-07-24T02:07:43.080
> 
> 标签：mongodb, gridfs

我正在使用 MongoDB 2.0.6，我的磁盘空间用完了，似乎无法做任何事情来清理一些东西。

我有 3 个碎片（没有复制，因为我可以重新生成照片）。

我有一个名为照片的集合，启用了分片。我将所有内容存储在 gridfs 中，因此 db.photos.files 和 db.photos.chunks。

所有文件最终都在我的主分片上，并且即使在我的集合上启用了分片，也不会分发。

当我尝试：

```
>  db.runCommand({ shardcollection : "photos.fs.chunks", key : { files_id : 1 }}) 
```

我收到有关需要创建索引的错误。当我尝试创建索引时，我得到“磁盘空间不足时无法获取写锁”。

当我尝试删除内容时：

```
>db.fs.files.remove({$and: [{_id: {$gt: "1667"} }, { _id: {$lt: "5000"} }]});
Can't take a write lock while out of disk space 
```

有任何想法吗？

# c# - 无法检测到的内存泄漏

> ID：11623130
> 
> 赞同：3
> 
> 时间：2012-07-24T02:07:45.773
> 
> 标签：c#, garbage-collection

我有一个`Stock`类可以从一个文件（大约 100 MB）中加载大量股票数据历史记录。我有一个`Pair`类，它接受两个`Stock`对象并计算两者之间的一些统计关系，然后将结果写入文件。

在我的主要方法中，我有一个循环遍历一对股票（大约 500 个）的列表。它创建 2 个库存对象，然后从这两个对象中创建一个 pair 对象。此时，配对计算被写入文件，我完成了对象。我需要释放内存，以便继续下一个计算。

除了将 3 个对象设置为 null 之外，我还在循环末尾添加了以下两行：

```
GC.Collect(GC.MaxGeneration);
GC.WaitForPendingFinalizers(); 
```

跨过这两行似乎只是从每次循环迭代分配的 200-300 MB 中释放了 50 MB（从任务管理器中查看）。

该程序在给我一个系统内存不足异常之前做了大约八到十对。内存使用量稳步增加，直到它在大约 1.5 GB 时崩溃。（这是一台运行 Win7 Ultimate 的 8 GB 机器）

我对垃圾收集没有太多经验。难道我做错了什么？

这是我的代码，因为你问了：（注意：程序有两种模式，1> 添加模式，将新配对添加到系统中。2> 常规模式，根据`filesystemwatcher`事件实时更新配对文件。股票数据由外部应用程序更新称为 QCollector。）

这是`MainForm`在添加模式下运行的段：

```
foreach (string line in PairList)
{
    string[] tokens = line.Split(',');

    stockA = new Stock(QCollectorPath, tokens[0].ToUpper()); 
    stockB = new Stock(QCollectorPath, tokens[1].ToUpper()); 

    double ratio = double.Parse(tokens[2]);
    Pair p = new Pair(QCollectorPath, stockA, stockB, ratio);

    // at this point the pair is written to file (constructor handles this)        

    // commenting out the following lines of code since they don't fix the problem
    // stockA = null;
    // stockB = null;
    // p = null;

    // refraining from forced collection since that's not the problem
    // GC.Collect(GC.MaxGeneration);
    // GC.WaitForPendingFinalizers();

    // so far this is the only way i can fix the problem by setting the pair classes
    // references to StockA and StockB to null
    p.Kill();
} 
```

我正在根据请求添加更多代码：`Stock`并且`Pair`是 的子类`TimeSeries`，具有通用功能

```
public abstract class TimeSeries {
     protected List<string> data;

     // following create class must be implemented by subclasses (stock, pair, etc...)
     // as each class is created differently, although their data formatting is identical
     protected void List<string> Create();

     // . . . 

     public void LoadFromFile()
     {
          data = new List<string>();

          List<StreamReader> srs = GetAllFiles();

          foreach (StreamReader sr in srs)
          {
               List<string> temp = new List<string>();
               temp = TurnFileIntoListString(sr);
               data = new List<string>(temp.Concat(data));
               sr.Close()
          }
     }

     // uses directory naming scheme (according to data month/year) to find files of a symbol
     protected List<StreamReader> GetAllFiles()...

     public static List<string> TurnFileIntoListString(StreamReader sr)
     {
          List<string> list = new List<string>();
          string line;
          while ((line = sr.ReadLine()) != null)
               list.Add(line);
          return list;
     }

     // this is the only mean to access a TimeSeries object's data
     // this is to prevent deadlocks by time consuming methods such as pair's Create

     public string[] GetListCopy()
     {
          lock (data)
          {
               string[] listCopy = new string[data.count];
               data.CopyTo(listCopy);
               return listCopy();
          }
     }
}

public class Stock : TimeSeries
{
     public Stock(string dataFilePath, string symbol, FileSystemWatcher fsw = null)
     {
          DataFilePath = dataFilePath;
          Name = symbol.ToUpper();
          LoadFromFile();
          // to update stock data when external app updates the files
          if (fsw != null) fsw.Changed += FileSystemEventHandler(fsw_Changed);
     }

     protected void List<string> Create()
     {
          // stock files created by external application
     }

     // . . . 
}

public class Pair : TimeSeries {
     public Pair(string dataFilePath, Stock stockA, Stock stockB, double ratio)
     {
          // assign parameters to local members
          // ...         

          if (FileExists())
               LoadFromFile();
          else
             Create();
     }

     protected override List<string> Create()
     {
          // since stock can get updated by fileSystemWatcher's event handler
          // a copy is obtained from the stock object's data 
          string[] listA = StockA.GetListCopy();
          string[] listB = StockB.GetListCopy();
          List<string> listP = new List<string>();

          int i, j;
          i = GetFirstValidBar(listA);
          j = GetFirstValidBar(listB);
          DateTime dtA, dtB;

          dtA = GetDateTime(listA[i]);
          dtB = GetDateTime(listB[j]);

          // this hidden segment adjusts i and j until they are starting at same datetime
          // since stocks can have different amount of data

          while (i < listA.Count() && j < listB.Count)
          {
              double priceA = GetPrice(listA[i]);
              double priceB = GetPrice(listB[j]);
              double priceP = priceA * ratio - priceB;
              listP.Add(String.Format("{0},{1:0.00},{2:0.00},{3:0.00}"
                   , dtA
                   , priceP
                   , priceA
                   , priceB
              );
              if (i < j)
                   i++;
              else if (j < i)
                   j++;
              else
              {
                   i++; 
                   j++;
              }
          }
     }

     public void Kill()
     {
         data = null;
         stockA = null;
         stockB = null;
     }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T01:02:53.713

您的内存泄漏在这里：

```
if (fsw != null) fsw.Changed += FileSystemEventHandler(fsw_Changed); 
```

只要 FileSystemWatcher 处于活动状态，stock 对象的实例就会保存在内存中，因为它正在响应 FileSystemWatcher 的事件。

我认为您想在其他地方实现该事件，或者在代码中的其他位置添加：

```
if (fsw != null) fsw.Changed -= fsw_Changed; 
```

考虑到代码的编写方式，在完成批量处理的情况下，可能会在没有 FileSystemWatcher 的情况下调用 stock 对象。

In the original code that you posted the constructors of the Stock classes were being called with a FileSystemWatcher. You have changed that now. I think you will find that now with a null FileSystemWatcher you can remove your kill and you will not have a leak since you are no longer listening to the fsw.Changed.

# php - PHP MySQL Active Record 条件总和

> ID：11623133
> 
> 赞同：0
> 
> 时间：2012-07-24T02:08:17.437
> 
> 标签：php, mysql, activerecord

我有两个表，用户和访问。我想选择在访问表的状态字段中具有“活动”的所有用户，以及所有访问记录的计数，无论活动/非活动状态如何。

这个查询只会给我一个“活动”访问记录的计数

```
SELECT 
     users.user_id, 
     COUNT(visits.id) 
FROM users u 
JOIN visits v ON v.user_id=u.user_id 
WHERE visits.status='active' 
```

我正在考虑子查询或 php 循环，但担心用户表增长时的性能。如果子查询是最好的解决方案，请发布活动记录代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:17:28.120

子查询将比在代码中循环更有效。我建议这个查询：

```
select u.user_id, ucount
from users u
join (
      select user_id, COUNT(id) as ucount
      from visits
      group by user_id
     ) all
ON u.user_id = all.user_id
join visits v
on v.user_id=u.user_id
where v.status='active' 
```

如果您只需要 user_id 而不需要 users.* 字段，那么您不必加入 users 表（受 arunmoezhi 的回答启发）：

```
select user_id,count(*) as visit_count
from visits v
join (
  select user_id from visits
  where status ='active'
) act
on v.user_id=act.user_id
group by v.user_id; 
```

编辑格式化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:22:48.590

```
select user_id,count(*) as visit_count
from visits 
where user_id in(
select user_id from visits
where status ='active'
)
group by user_id; 
```

# vb.net - 从树视图（VB.NET）中删除/禁用子节点的子节点（这段代码有什么问题？）

> ID：11623140
> 
> 赞同：0
> 
> 时间：2012-07-24T02:09:24.937
> 
> 标签：vb.net, treeview, treenode

我想在用户在文本框中输入特定数字后删除/禁用子节点。我知道以下代码有问题，但我无法弄清楚（我是初学者）。

```
Dim k As Integer
k = Val(TextBox1.Text)
For i = k + 1 To 4
TreeView1.Nodes(1).Nodes("Node" & i).Remove()
Next 
```

任何帮助将不胜感激。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:22:56.273

在不知道您遇到什么错误或您的 TreeView1 节点结构是什么的情况下（无论您是否有多个根节点。我假设您忘记了[TreeNodeCollection](http://msdn.microsoft.com/en-us/library/2xdhazd0.aspx)索引是从零开始的，并且应该使用`TreeView1.Nodes(0)`.

从上面的链接：

> 要将 TreeNode 对象分配到特定位置，或从 TreeNodeCollection 中检索它们，您可以使用特定索引值引用集合对象。TreeNodeCollection 的索引值是从零开始的索引。

下面的代码适用于我的节点结构：

![在此处输入图像描述](../Images/b6f32581a16c0ae4e0c8a751f2da69f8.png)

```
Dim k As Integer
If Integer.TryParse(TextBox1.Text, k) Then 'Checking if conversion is valid before trying to use 
    For i = k + 1 To 4
        TreeView1.Nodes(0).Nodes("Node" & i).Remove() 'Using Nodes(0) for root node.
    Next
End If 
```

* * *

作为一个警告，我不确定你到底想要完成什么，但我希望这些子例程能让你接近。第一个是`Treeview`通过创建节点结构然后清除`TreeView`并添加新节点来重新创建原始节点。第二个子例程使用文本框中的数字，检查创建的节点是否是重复的，如果不是，它将添加到 TreeView。第三个子例程是查找最后一个现有节点，添加新节点，其数量基于 TextBox 输入。

```
Private Sub ResetNodes()
    Dim root As TreeNode

    root = New TreeNode("Node0")
    root.Nodes.Add("Node1")
    root.Nodes.Add("Node2")
    root.Nodes.Add("Node3")
    root.Nodes.Add("Node4")

    TreeView1.Nodes.Clear()
    TreeView1.Nodes.Add(root)
End Sub

Private Sub AddNodes()
    Dim k As Integer
    Dim duplicate As Boolean
    If Integer.TryParse(TextBox2.Text, k) Then
        For i = 1 To k
            For Each node As TreeNode In TreeView1.Nodes(0).Nodes
                If node.Text = "Node" & i Then
                    duplicate = True
                    Exit For
                End If
                duplicate = False
            Next
            If Not duplicate Then TreeView1.Nodes(0).Nodes.Add("Node" & i)
        Next
    End If
End Sub

Private Sub AddToExistingNodes()
    Dim k As Integer
    Dim lowIndex As Integer
    Dim highIndex As Integer

    lowIndex = TreeView1.Nodes(0).Nodes.Count + 1

    If Integer.TryParse(TextBox2.Text, k) Then
        highIndex = lowIndex + k
        For i = lowIndex To highIndex
            TreeView1.Nodes(0).Nodes.Add("Node" & i)
        Next
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T08:08:30.363

如果你喜欢，你可以搜索和删除

```
Private Sub Delete_Sub_TreeNod()

For Each tn As TreeNode In TreeView1.Nodes

            For Each tn2 As TreeNode In tn.Nodes
                If tn2.Text = "Some Value" Then
                    tn2.Remove()
                End If

            Next
        Next
    End Sub 
```

# c++ - 将 R 值传递给采用 L 值的函数时重载歧义

> ID：11623142
> 
> 赞同：10
> 
> 时间：2012-07-24T02:09:52.927
> 
> 标签：c++, c++11, rvalue-reference

我有 2 个重载函数 - 一个采用 L 值，另一个采用 R 值。目的是使函数可以像这样调用：

```
Obj obj;
foo(obj); 
```

或者：

```
foo(Obj()); 
```

所以，我写了 2 个重载函数：

```
template <class T>
void foo(T& v)
{
  /* ... function body code goes here ... */
}

template <class T>
void foo(T&& v)
{
    foo(v);
}

int main()
{
    foo(int(5));
} 
```

R 值重载只需要委托给 L 值重载。我理解它的方式，一旦我进入函数体，任何使用`v`都会给我一个 L 值引用，除非我特别使用`std::move`or `std::forward`。所以`foo(v)`在 R 值重载中调用应该自动调用 L 值版本（而不是递归。）

但是，编译器抱怨歧义：

```
test.cpp: In function ‘void foo(T&&) [with T = int]’:
test.cpp:305:12:   instantiated from here
test.cpp:299:2: error: call of overloaded ‘foo(int&)’ is ambiguous 
```

我不明白为什么这是模棱两可的。在 R 值重载中的调用`foo()`应该清楚地调用 L 值版本。那么为什么不编译呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T06:54:22.733

短版：尝试更新您的编译器。您的版本没有实现[http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#1164](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_defects.html#1164)。

您的第二个模板是“完美转发”模板。任何类型为 的函数模板形参`T&&`，其中`T`是模板形参，当实参为右值时，将推导出该模板形参到`X`（实参类型在哪里），如果实参为左值，则推导出为。`X``X&`

在您的情况下，您传递了一个右值，因此`T`被推断为`Obj`（并且`int`在您的真实代码中）。如果您将传递一个变量名称或其他左值，那么您的第二个模板将具有参数类型`Obj&`（T 将是`Obj&`，并且`&&`应用于此类类型保持`Obj&`）。

但是另一个模板也有这样的参数类型。因此，在重载解析期间，参数到参数的转换是相同的（完全匹配），并且需要检查另一个标准，即两个模板的*特殊性*，在*部分排序*规则下。如果一个模板比另一个模板更专业，那么它将由编译器选择。如果没有比另一个更专业的模板，最终的歧义就会上升。

在这种情况下，**第一个模板比第二个模板更专业**，因此编译器最终应该调用第一个模板。

# bash - 这个 bash 脚本给了我一个错误，我不知道为什么

> ID：11623147
> 
> 赞同：0
> 
> 时间：2012-07-24T02:10:38.620
> 
> 标签：bash

我在这里关注一些教程，每当我执行这个，我得到

```
Do you want to create a bukkit server on this computer? (Hint: answer YES or NO) > no
answered no
./test.sh: line 44: syntax error near unexpected token `else'
./test.sh: line 44: 'else' 
```

这是脚本：

```
while true; do
    read -p "Do you want to create a bukkit server on this computer? (Hint: answer YES or NO) > " yn
    case $yn in
        [Yy]* ) echo answered yes; INSTALL="Y"; break;;
        [Nn]* ) echo answered no; break;;
        * ) echo "Please answer yes or no.";;
    esac
done

if [ -z "$INSTALL" ];
    echo "Yay!"
else
    echo "Sadface!"
fi 
```

我是 bash 新手：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:14:36.140

您在`then`条件后缺少关键字：

```
if [ -z "$INSTALL" ]; then
    echo "Yay!"
else
    echo "Sadface!"
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:15:44.440

你需要一个`then`之后`if`：

```
while true; do
read -p "Do you want to create a bukkit server on this computer? (Hint: answer YES or NO) > " yn
case $yn in
[Yy]* ) echo answered yes; INSTALL="Y"; break;;
[Nn]* ) echo answered no; break;;
* ) echo "Please answer yes or no.";;
esac
done

if [ -z "$INSTALL" ]; then
echo "Yay!"
else
echo "Sadface!"
fi 
```

# sql - 如何删除数据库中的最后一行（全为 NULL）？

> ID：11623148
> 
> 赞同：0
> 
> 时间：2012-07-24T02:10:40.420
> 
> 标签：sql

```
Column1  Column2  Column3  Column4  Column5  Column6
NULL    NULL     NULL   NULL     NULL     NULL 
```

我尝试了以下查询：

1.

```
Delete from tablename where column1 = NULL 
```

2.

```
Delete from tablename where column1 IS NULL 
```

第二个查询成功完成，但它说 0 行受到影响。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T02:15:53.520

`is null`尝试匹配空值时必须使用特殊语法：

```
delete from mytable
where Column1 is null
and Column2 is null
and Column3 is null
and Column4 is null
and Column5 is null
and Column6 is null; 
```

任何常规比较`null`总是错误的，

例如两者`Column1 = null`和`Column1 != null`总是`false`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:26:01.107

我相信这对您的 rdbms 或等效项应该有效。如果 isnull 函数的返回值等于空字符串，它将删除行。

```
DELETE FROM tablename
WHERE isnull(Column1, '') = '' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:29:45.263

```
DELETE FROM table WHERE coalesce(col1,col2,col3,...) IS NULL 
```

# flash - 编译文件 .as 和 .fla 以导出 .swf

> ID：11623149
> 
> 赞同：0
> 
> 时间：2012-07-24T02:10:46.047
> 
> 标签：flash

我使用 Sothink SWF Decompile，并取 .fla 和 .as 。如何通过 Adob​​e Flash 编译 .as 和 .fla？帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T16:31:36.243

您可以使用 Adob​​e Flash 打开 .fla 并发布它。

# javascript - JavaScript：按顺序排列的 Ajax 请求

> ID：11623151
> 
> 赞同：0
> 
> 时间：2012-07-24T02:11:28.360
> 
> 标签：javascript, ajax

我正在编写一些 JavaScript/AJAX 代码。

有没有办法确保服务器按照发送顺序*接收XML 请求？*

如果不是使用普通的 Ajax，如果我通过单个 WebSocket 发送所有内容，我能得到这个保证吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:44:33.043

如果以正确的顺序接收它们至关重要，并且将迭代 id 附加到表单是不够的：

```
msg_number = 1; sendAJAX(msg_number);  msg_number++; 
```

然后我建议建立自己的队列系统，并将每个后续文件作为前一个文件的回调发送。
与其让每个元素都有自己的 AJAX 访问，不如在应用程序中创建一个集中点来处理它。

您不同的启用 AJAX 的部分甚至不需要知道它***是***一个队列：

```
AJAX.send({ url : "......", method : "post", success : func(){}, syncronous : true }); 
```

另一方面，你可以有类似的东西：

```
AJAX.send = function (obj) {
    if (obj.synchronous) {
        addToSyncQueue(obj); checkQueue();
    } else { fireRequest(); }
}; 
```

在同步队列中，您需要做的就是围绕旧回调包装一个新函数：

```
callback = (function (old_cb) {
    return function (response) {
        checkQueue();
        old_cb(response);
    };
}(obj.success));

obj.success = callback;

AJAX.call(obj); 
```

在 内部`checkQueue`，您只需要查看它是否为空，如果不是，请使用
`nextObj = queue.shift();`（如果您将`.push()`对象放入队列中 - 所以先进先出，就像您想要的那样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:19:55.537

我想到了几个选项：

1.  同步发送它们，方法是在接收到每个 XML 请求后等待来自服务器的成功响应（即创建一个队列）。
2.  如果您事先知道要发送的请求数，请将请求号作为每个请求的标签发送，例如`<requestNum>1</requestNum><numRequests>5</numRequests>`. 这并不能保证它们被接收的顺序，但保证它们可以在之后按顺序放回，并且具有确保您拥有所有数据的额外好处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:15:52.443

在我的公司，我们使用这个`ajaxQueue`由 jQuery 核心贡献者之一编写的小插件：

[http://gnarf.net/2011/06/21/jquery-ajaxqueue/](http://gnarf.net/2011/06/21/jquery-ajaxqueue/)

# asp.net-mvc-3 - 更新服务器文件时 MVC3 站点未更新

> ID：11623152
> 
> 赞同：0
> 
> 时间：2012-07-24T02:11:31.433
> 
> 标签：asp.net-mvc-3, entity-framework, razor

我只是更改了一些代码，将数据库中所有葡萄酒的完整计数添加到视图模型中。当我将所有更新的文件复制到我的服务器时，我不断收到以下错误：

> “vf2.ViewModels.MyAccountViewModel”不包含“DBWineCount”的定义，并且找不到接受“vf2.ViewModels.MyAccountViewModel”类型的第一个参数的扩展方法“DBWineCount”（您是否缺少 using 指令或程序集引用?)

这在我的开发盒上运行良好，文件相同。我编辑了我的 web.config 文件以强制编译，但我仍然有这个问题。如果我尝试改用 ViewBag，它不会抛出错误 - 但它会返回一个空白值。这里会发生什么？以下是我的代码示例：

```
namespace vf2.ViewModels
{
    public class MyAccountViewModel
    {
        public DistributorUser DistributorUser { get; set; }
        public ProducerUser ProducerUser { get; set; }
        public RestaurantUser RestaurantUser { get; set; }
        public UserObj UserObj { get; set; }

        [Display(Name="Email")]
        public string MembershipEmail { get; set; }

        public string GetFullName()
        {
           return this.UserObj.FirstName + " " + this.UserObj.LastName;
        }

        public string sInstitutionTab { get; set; }
        public string DBWineCount { get; set; }

    }
}

[Authorize]
        public ActionResult MyAccount()
        {
            MyAccountViewModel myAccount = new MyAccountViewModel();
            MembershipUser muCurrent = Membership.GetUser(true);
            muCurrent = Membership.GetUser(true);

            myAccount.UserObj = db.UserObjs.Find(muCurrent.ProviderUserKey);
            myAccount.MembershipEmail = muCurrent.Email;
            int iDocCount = 0;
            int iRevCount = 0;

            if (myAccount.UserObj != null)
            {
                myAccount.DBWineCount = string.Format("{0:n0}",db.Wines.Count());

                switch ((UserTypesEnum)myAccount.UserObj.UserTypeID)
                {
                    case UserTypesEnum.Producer:
                        myAccount.ProducerUser = db.ProducerUsers.Find(muCurrent.ProviderUserKey);
                        myAccount.sInstitutionTab = "My Producer";
                        myAccount.ProducerUser.Producer.Wines.ToList().ForEach(w => iDocCount +=  w.Docs.Count);
                        myAccount.ProducerUser.Producer.Wines.ToList().ForEach(w => iRevCount += w.Reviews.Count);
<I cut the rest out because it is pretty long>

<div class="lightbox" id="gettingStarted" style="text-align:center;">
    <a href="#" class="ui-icon ui-icon-circle-close closer"></a>
    <h3 style="margin-top:0px;">Getting Started</h3>
    <br />
    To get started using the site, search useing the searchbox above or the search
    tab on the left. 
    <br />From there you'll have access to all @Model.DBWineCount wines in our database.  
       <br />

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T05:24:21.183

我怀疑您来自 ASP.NET 开发，其中编译器在首次访问页面时自动运行。在 ASP.NET MVC 中，您需要使用 Visual Studio 的发布命令强制编译。右键单击解决方案并选择 'Publish...' ，然后选择要发布文件的文件夹，然后将该文件夹的内容上传到生产服务器。

请注意，如果您使用的是实体框架并且在共享主机上，您可能没有运行应用程序的权限，并且 EF 会自动为您创建数据库。在这种情况下，您将需要生成 SQL 脚本并在数据库上手动执行这些脚本。

请注意，修改 web.config 只会重新启动应用程序，但不会执行任何编译。在 ASP.NET MVC 中，您需要在测试时显式构建一个项目以进行编译。

# view - CouchDB - 仅查询第一个键元素的数组键值

> ID：11623154
> 
> 赞同：10
> 
> 时间：2012-07-24T02:11:38.917
> 
> 标签：view, couchdb

我有一个使用数组键值设置的 couchdb 视图，格式如下：

```
[articleId, -timestamp] 
```

我想查询具有相同文章 ID 的所有条目。所有时间戳都是可接受的。

现在我正在使用这样的查询：

```
?startkey=["A697CA3027682D5JSSC",-9999999999999]&endkey=["A697CA3027682D5JSSC",0] 
```

但我想要一些更简单的东西。

有没有一种简单的方法可以完全通配第二个关键元素？最简单的语法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-24T13:51:51.010

首先，正如评论指出的那样，确实有一个特殊值`{}`在任何值之后排序，因此您的查询变为：

```
startkey=["target ID"]&endkey=["target ID",{}] 
```

这相当于通配符匹配。

作为旁注，不需要通过发出负时间戳来反转 map 函数中的顺序，您可以反转顺序作为视图调用的选项（您的开始和结束键将被交换）。

```
startkey=["target ID",{}]&endkey=["target ID"]&descending=true 
```

# java - 录制视频时启用相机闪光灯

> ID：11623157
> 
> 赞同：29
> 
> 时间：2012-07-24T02:12:39.053
> 
> 标签：java, android, c++, process, android-camera

我需要一种在录制视频时控制 Android 设备上的相机闪光灯的方法。我正在制作一个频闪灯应用程序，使用闪烁的频闪灯拍摄视频将能够记录高速移动的物体，例如风扇叶片。

只能通过启动视频预览并在相机参数中设置 FLASH_MODE_TORCH 来启用闪光灯。看起来像这样：

```
Camera c = Camera.open();
Camera.Parameters p = c.getParameters();
p.setFlashMode(Camera.Parameters.FLASH_MODE_TORCH);
c.setParameters(p);
c.startPreview(); 
```

预览开始后，我可以来回翻转该参数以打开和关闭灯。在我尝试录制视频之前，这很有效。麻烦的是，为了把摄像头交给 MediaRecorder，我首先要解锁它。

```
MediaRecorder m = new MediaRecorder();
c.unlock();     // the killer
m.setCamera(c); 
```

解锁后，我无法再更改相机参数，因此无法更改闪光灯状态。

我不知道是否真的可以做到这一点，因为我不是最擅长 java-hacking，但这是我所知道的：

*   Camera.unlock() 是本机方法，因此我无法真正看到它锁定我的方式背后的机制
*   Camera.Parameter 有一个包含其所有参数的 HashMap
*   Camera.setParameters(Parameters) 获取 HashMap，将其转换为字符串，并将其传递给本地方法
*   我可以从 HashMap 中消除所有参数，但 TORCH-MODE 并且相机仍然会接受它

所以，我仍然可以访问相机，但它不会听我告诉它的任何内容。（这就是 Camera.unlock() 的目的）

**编辑：**

检查本机代码后，我可以看到在[CameraService.cpp](http://androidxref.com/2.3.6/xref/frameworks/base/services/camera/libcameraservice/CameraService.cpp)中我对 Camera.setParameters(Parameters) 的调用被拒绝，因为我的进程 ID 与相机服务记录的进程 ID 不匹配。所以这似乎是我的障碍。

**编辑2：**

看起来[MediaPlayerService](http://androidxref.com/2.3.6/xref/frameworks/base/media/libmediaplayerservice/MediaPlayerService.cpp)是在录制视频时控制相机的主要服务。我不知道这是否可能，但如果我能以某种方式在我自己的进程中启动该服务，我应该能够跳过 Camera.unlock() 调用。

**编辑3：**

最后一个选择是如果我能以某种方式获得指向 CameraHardwareInterface 的指针。从外观上看，这是一个特定于设备的接口，可能不包括 PID 检查。不过，主要问题是我唯一能找到指向它的指针的地方是在 CameraService 中，而 CameraService 没有说话。

**Edit4：（几个月后）**

在这一点上，我认为不可能做到我最初想要的。我不想在有人回答的情况下删除该问题，但我并没有积极寻求答案。（虽然，收到一个有效的答案会很棒。）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-13T14:22:21.310

我遇到了类似的问题。用户应该能够在录制过程中根据光线情况更改闪光模式以满足他们的需要。经过一些调查研究，我得出以下解决方案：

我假设您已经设置了适当的 SurfaceView 和 SurfaceHolder 及其必要的回调。我做的第一件事是提供这段代码（未声明的变量是全局变量）：

```
public void surfaceCreated(SurfaceHolder holder) {
    try {
        camera = Camera.open();

        parameters = camera.getParameters();
        parameters.setFlashMode(Parameters.FLASH_MODE_OFF);

        camera.setParameters(parameters);
        camera.setPreviewDisplay(holder);
        camera.startPreview();

        recorder = new MediaRecorder();
    } catch (IOException e) {
        e.printStackTrace();
    }       
} 
```

我的下一步是初始化和准备录音机：

```
private void initialize() {
    camera.unlock();

    recorder.setCamera(camera);
    recorder.setAudioSource(MediaRecorder.AudioSource.CAMCORDER);
    recorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
    recorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
    recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AAC);
    recorder.setVideoEncoder(MediaRecorder.VideoEncoder.H264);
    recorder.setVideoFrameRate(20);
    recorder.setOutputFile(filePath);

    try {
        recorder.prepare();
    } catch (IllegalStateException e) {
        e.printStackTrace();
        finish();
    } catch (IOException e) {
        e.printStackTrace();
        finish();
    }
} 
```

需要注意的是，camera.unlock() 必须在媒体记录器的整个初始化过程之前调用。也就是说，还要注意每个 set 属性的正确顺序，否则在调用 prepare() 或 start() 时会出现 IllegalStateException。说到录音，我就是这么做的。这通常由视图元素触发：

```
public void record(View view) {
    if (recording) {
        recorder.stop();

        //TODO: do stuff....

        recording = false;
    } else {
        recording = true;

        initialize();
        recorder.start();
    }
} 
```

所以现在，我终于可以正常录制了。但是那个闪光灯是怎么回事？最后但并非最不重要的是，这里有幕后的魔力：

```
public void flash(View view) {
    if(!recording) {
        camera.lock();
    }

    parameters.setFlashMode(parameters.getFlashMode().equals(Parameters.FLASH_MODE_TORCH) ? Parameters.FLASH_MODE_OFF : Parameters.FLASH_MODE_TORCH);
    camera.setParameters(parameters);

    if(!recording) {
        camera.unlock();
    }
} 
```

每次我通过 onClick 操作调用该方法时，我都可以更改闪光灯模式，即使在录制期间也是如此。只需注意正确锁定相机即可。一旦在录制过程中媒体记录器获得锁定，您就不必再次锁定/解锁相机。它甚至不起作用。这是在带有 Android 版本 4.1.2 的三星 Galaxy S3 上测试的。希望这种方法有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-05T11:18:24.097

准备好媒体记录器后，使用camera.lock()，然后设置你想要设置到camera的任何参数。但是在开始录制之前你需要调用camera.unlock()，在你停止媒体录制之后你需要调用camera.lock()来开始预览。享受！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T06:49:59.533

试试这个..希望它会工作.. :)

```
 private static Torch torch;

          public Torch() {
            super();
            torch = this;
          }

          public static Torch getTorch() {
            return torch;
          }

          private void getCamera() {
            if (mCamera == null) {
              try {
                mCamera = Camera.open();
              } catch (RuntimeException e) {
                Log.e(TAG, "Camera.open() failed: " + e.getMessage());
              }
            }
          }
        public void toggleLight(View view) {
            toggleLight();
          }

          private void toggleLight() {
            if (lightOn) {
              turnLightOff();
            } else {
              turnLightOn();
            }
          }

          private void turnLightOn() {
            if (!eulaAgreed) {
              return;
            }
            if (mCamera == null) {
              Toast.makeText(this, "Camera not found", Toast.LENGTH_LONG);
                   button.setBackgroundColor(COLOR_WHITE);
              return;
            }
            lightOn = true;
            Parameters parameters = mCamera.getParameters();
            if (parameters == null) {
                    button.setBackgroundColor(COLOR_WHITE);
              return;
         }
            List<String> flashModes = parameters.getSupportedFlashModes();
               if (flashModes == null) {
                   button.setBackgroundColor(COLOR_WHITE);
              return;
            }
            String flashMode = parameters.getFlashMode();
            Log.i(TAG, "Flash mode: " + flashMode);
            Log.i(TAG, "Flash modes: " + flashModes);
            if (!Parameters.FLASH_MODE_TORCH.equals(flashMode)) {
                   if (flashModes.contains(Parameters.FLASH_MODE_TORCH)) {
                parameters.setFlashMode(Parameters.FLASH_MODE_TORCH);
                mCamera.setParameters(parameters);
                button.setBackgroundColor(COLOR_LIGHT);
                startWakeLock();
              } else {
                Toast.makeText(this, "Flash mode (torch) not supported",
                    Toast.LENGTH_LONG);
                       button.setBackgroundColor(COLOR_WHITE);
                Log.e(TAG, "FLASH_MODE_TORCH not supported");
              }
            }
          }
         private void turnLightOff() {
            if (lightOn) {
                    button.setBackgroundColor(COLOR_DARK);
              lightOn = false;
              if (mCamera == null) {
                return;
              }
              Parameters parameters = mCamera.getParameters();
              if (parameters == null) {
                return;
              }
              List<String> flashModes = parameters.getSupportedFlashModes();
              String flashMode = parameters.getFlashMode();
                   if (flashModes == null) {
                return;
              }
              Log.i(TAG, "Flash mode: " + flashMode);
              Log.i(TAG, "Flash modes: " + flashModes);
              if (!Parameters.FLASH_MODE_OFF.equals(flashMode)) {
                       if (flashModes.contains(Parameters.FLASH_MODE_OFF)) {
                  parameters.setFlashMode(Parameters.FLASH_MODE_OFF);
                  mCamera.setParameters(parameters);
                  stopWakeLock();
                } else {
                  Log.e(TAG, "FLASH_MODE_OFF not supported");
                }
              }
            }
          }
     private void startPreview() {
        if (!previewOn && mCamera != null) {
          mCamera.startPreview();
          previewOn = true;
        }
      }

      private void stopPreview() {
        if (previewOn && mCamera != null) {
          mCamera.stopPreview();
          previewOn = false;
        }
      }

      private void startWakeLock() {
        if (wakeLock == null) {
          Log.d(TAG, "wakeLock is null, getting a new WakeLock");
          PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
          Log.d(TAG, "PowerManager acquired");
          wakeLock = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, WAKE_LOCK_TAG);
          Log.d(TAG, "WakeLock set");
        }
        wakeLock.acquire();
        Log.d(TAG, "WakeLock acquired");
      }

      private void stopWakeLock() {
        if (wakeLock != null) {
          wakeLock.release();
          Log.d(TAG, "WakeLock released");
        }
      }
     @Override
      public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (Eula.show(this)) {
          eulaAgreed = true;
        }
        setContentView(R.layout.main);
        button = findViewById(R.id.button);
        surfaceView = (SurfaceView) this.findViewById(R.id.surfaceview);
        surfaceHolder = surfaceView.getHolder();
        surfaceHolder.addCallback(this);
        surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        disablePhoneSleep();
        Log.i(TAG, "onCreate");
      } 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-09-03T17:49:00.283

要访问设备摄像头，您必须在 Android Manifest 中声明 CAMERA 权限。还要确保包含`<uses-feature>`manifest 元素以声明应用程序使用的相机功能。例如，如果您使用相机和自动对焦功能，您的清单应包括以下内容：

```
 <uses-permission android:name="android.permission.CAMERA" />
 <uses-feature android:name="android.hardware.camera" />
 <uses-feature android:name="android.hardware.camera.autofocus" /> 
```

检查手电筒支持的示例可能如下所示：

```
//Create camera and parameter objects
private Camera mCamera;
private Camera.Parameters mParameters;
private boolean mbTorchEnabled = false;

//... later in a click handler or other location, assuming that the mCamera object has already been instantiated with Camera.open()
mParameters = mCamera.getParameters();

//Get supported flash modes
List flashModes = mParameters.getSupportedFlashModes ();

//Make sure that torch mode is supported
//EDIT - wrong and dangerous to check for torch support this way
//if(flashModes != null && flashModes.contains("torch")){
if(flashModes != null && flashModes.contains(Camera.Parameters.FLASH_MODE_TORCH)){
    if(mbTorchEnabled){
        //Set the flash parameter to off
        mParameters.setFlashMode(Camera.Parameters.FLASH_MODE_OFF);
    }
    else{
        //Set the flash parameter to use the torch
        mParameters.setFlashMode(Camera.Parameters.FLASH_MODE_TORCH);
    }

    //Commit the camera parameters
    mCamera.setParameters(mParameters);

    mbTorchEnabled = !mbTorchEnabled;
} 
```

要打开手电筒，您只需设置相机参数`Camera.Parameters.FLASH_MODE_TORCH`

```
Camera mCamera;
Camera.Parameters mParameters;

//Get a reference to the camera/parameters
mCamera = Camera.open();
mParameters = mCamera.getParameters();

//Set the torch parameter
mParameters.setFlashMode(Camera.Parameters.FLASH_MODE_TORCH);

//Comit camera parameters
mCamera.setParameters(mParameters); 
```

要关闭手电筒，请设置`Camera.Parameters.FLASH_MODE_OFF`

# ruby - Capistrano 处理未在 VCS 中跟踪的文件

> ID：11623161
> 
> 赞同：1
> 
> 时间：2012-07-24T02:13:29.057
> 
> 标签：ruby, web-applications, deployment, capistrano

如果我有任何 VCS 未跟踪的文件，例如 jquery 插件文件，我如何让 Capistrano 使用它们？

我可以手动将它们上传到“共享”文件夹吗？还是 Capistrano 会自动处理“非 VCS-ed”文件？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:04:49.367

您可以通过 scp 使用 capistrano 复制任意文件，如下所示：

```
task :copy_files do
  top.upload('path/to/files', "#{shared_path}", {:via => :scp, :recursive => true})
end 
```

# asp.net - 为什么我的会话没有过期？

> ID：11623163
> 
> 赞同：2
> 
> 时间：2012-07-24T02:13:57.310
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, session, session-state

我创建了一个空的 mvc3 项目。

它有一个控制器（“home”）和 2 个动作（“index”、“about”）

我正在使用 sqlserver 来保存我的会话。

这是我的配置文件。

```
 <sessionState  mode="SQLServer" cookieless="false" timeout="1" sqlConnectionString="Data Source=localhost;Integrated Security=True;MultipleActiveResultSets=False"> 
```

超时为 1 分钟。

在索引页中。我创建了一个会话

```
Session["currentTime"] = DateTime.Now.ToString(); 
```

在我的关于页面中，我将其写在视图中。

```
@Session["currentTime"] 
```

第一次，我打开关于页面，当前时间显示。我将页面单独放置 5 分钟，然后返回刷新它。旧的 currentTime 仍然存在。我将超时设置为 1，因此它现在应该过期并且页面上应该什么也不显示。

也许我完全误解了会话是如何工作的。请告诉我为什么会话值在过期后仍然存在。

**编辑：**

它不是缓存。我添加了以下代码来禁用缓存。还是有问题。

```
 <meta http-equiv="cache-control" content="max-age=0" />
 <meta http-equiv="cache-control" content="no-cache" />
 <meta http-equiv="expires" content="0" />
 <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
 <meta http-equiv="pragma" content="no-cache" /> 
```

我想我发现了问题，不知道如何解决它。

我从 Chrome 中清除了缓存。打开“/home/index”页面创建会话，然后转到“/home/about”页面。检查数据库。创建了一个会话。仔细检查“创建”和“过期”字段。确认它将在一分钟后过期。

然后我离开电脑 5 分钟。在我回来刷新“/home/about”页面后。会话还在，没有过期。查询我的会话表，注意“过期”字段更改为 1 分钟 + 我刷新页面的时间。为什么过期字段改变了？？？？？？？？？

**第二次更新：**

我相信这就是问题所在。SQL 会话提供程序不会主动监控会话表中的 Expires 列。相反，会话在从表中删除之前不会“正式”过期，这是通过调用 DeleteExpiredSessions 存储过程的 SQL 代理作业完成的。默认情况下，作业配置为每 60 秒运行一次。

我很确定我的 sql 代理没有运行。但不知道如何打开它。如果您有任何想法，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T06:10:39.180

这里有很多可能的事情。配置中设置的超时时间为“1”分钟，因此您的会话变量必然会超时。

您面临的情况（我 90% 肯定）是缓存的情况。您的索引页面默认控制器操作必须是 HTTP 获取。在您的页面内放置一个按钮，然后尝试使用按钮刷新您的网页。该按钮将发布到服务器。我确信会话变量不会持续存在。

**更新 2**

请参阅以下链接以了解[如何打开 Sql Agent](http://technet.microsoft.com/en-us/library/ms191454%28v=sql.105%29.aspx)。请打开它并让我们知道它是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T06:17:26.930

闻起来像缓存问题。你在哪个浏览器中？

您在浏览器中使用的会话是为所有控制器初始化的“访客”会话（当然，无会话除外）。即使它过期了，也会创建一个新的，并且应该将时间戳放在里面。因此，每次刷新页面时，您都应该看到当前时间。

**编辑：（**帖子更新后）。

如果认为它完全正确。据此，[您](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx)需要设置`regenerateExpiredSessionId`sessionState 的字段，以重新生成过期的会话 id。否则，现有的会话对象将被简单地重新更新和重新使用。

**编辑2：**

如果 cookieless 为真，则先前的编辑将是有效的。在您的代码中，您提到 cookieless 是错误的，但由于某种原因，它仍然充当 cookieless = true。你确定你有正确的参数`sessionState`。

# php - else if 条件下的服务器错误

> ID：11623167
> 
> 赞同：-1
> 
> 时间：2012-07-24T02:14:35.033
> 
> 标签：php

我不断收到服务器错误，我已将其限制在此代码块中。我一定不熟悉语法。有人可以指出为什么我收到服务器错误吗？我发布了所有代码。这里是.....

```
<?php 
 // this starts the session 
 session_start();
 $id = $_SESSION['userid'];

//this connects to the database
$con = mysql_connect("example","example","example");
mysql_select_db("example", $con);

 //this is the info the user entered stored as variables
 $leaguename = $_POST["leaguename"];
 $members = $_POST["members"];
 $leaguepassword = $_POST["leaguepassword"];

  //this filters throught the variables to check against mysql injections
 $leaguename = (filter_var($leaguename, FILTER_SANITIZE_STRING));
 $leaguename = (filter_var($leaguename, FILTER_SANITIZE_URL));
 $members = (filter_var($members, FILTER_SANITIZE_STRING));
 $members = (filter_var($members, FILTER_SANITIZE_URL));
 $leaguepassword = (filter_var($leaguepassword, FILTER_SANITIZE_STRING));
 $leaguepassword = (filter_var($leaguepassword, FILTER_SANITIZE_URL));

 //this is the variables that displays errors 
 $errors = ""; 
 $result = mysql_query("SELECT * FROM League_Info WHERE League = '$leaguename'"); 
 $result2 = mysql_fetch_array($result);
 $result3 = $result2['League'];

 $result4 = mysql_query("SELECT * FROM League_Info WHERE User_ID = '$id'");
 $result5 = mysql_fetch_array($result4);
 $result6 = $result5['User_ID'];

 if ($id == "") {
    $errors .= "<li>You must register or login to create a league!"; break;
  } elseif ($result3 != "") {
    $errors .= "<li>League Name already in use!"; break;
  } elseif ($result6 != "") {
    $errors .= "<li>You already have a league!"; break;
  } else {
 }

 // no errors
 if ($errors == "") {
    $sql="INSERT INTO League_Info (League, User_ID, Commissioner, Year, Members, League_Password) 
        VALUES('$leaguename', '$id', 'y', '2012', '$members', '$leaguepassword')"; 
    mysql_query($sql);
        /* Redirect browser */
    header("Location: http://www.yourfantasyfootballreality.com/invite.php");
    /* Make sure that code below does not get executed when we redirect. */
    exit;

 } else {
 }

 ?>

 <html><head><title>Create a League</title></head>

<body>

<center><h1>Create a League</h1></center>

<center>
<div class="form" style= "width:500px; height:200px; background-color:gray; ">
<form action="createleaguevalidation.php" method="POST">
League Name:       <input style="margin-left:0px;" type="text" name="leaguename" value="<?=$leaguename?>" /><br />
Number of Members: <input type="text" name="members" value="<?=$members?>"/><br>
League Password:   <input type="password" name="leaguepassword" value="<?=$leaguepassword?>"><br>
<input type="submit" value="Create League" name="action">
<input type="reset"  value="Reset">
</form>

<div style="background-color:#ffcccc; height:80px; width:500px;">
<?=$errors?>
</div>

</div>
<center>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T02:17:27.730

如果此代码不在循环内，`break`则为错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T02:16:36.763

您的代码很好，只需取出`break;`

要中断循环，请将其放在`break;`所有 if 语句的末尾。

# heroku - Heroku 上的 JRuby on Rails 3.2.2

> ID：11623170
> 
> 赞同：1
> 
> 时间：2012-07-24T02:15:11.017
> 
> 标签：heroku, jruby, ruby-on-rails-3.2, jrubyonrails

我有一个成熟的 Rails 3.2.2 应用程序，我想将它部署在 Heroku 上的 JRuby 之上，原因我不会深入探讨。在尝试通过 Maven 配置引导 JRuby 并尝试让 Rails 应用程序捆绑失败后，我求助于使用基于 Carl Hörberg 的[Heroku JRuby buildpack](https://github.com/jruby/heroku-buildpack-jruby)的自定义 Heroku buildpack ，我认为我在这方面取得了更大的成功. 我的自定义 buildpack 和 Carl 的唯一区别是我不会尝试在 slug 编译期间预编译资产，因为我更愿意在本地执行此操作。

对 Heroku 的推动效果很好。Heroku 接收推送，获取自定义 buildpack，安装所有捆绑的 gem，启动等，没有问题、警告或错误，但是当我尝试在浏览器中解析部署的应用程序时，我立即收到 500 错误（这是在 MRI 1.9.2 上运行良好的应用程序）。不幸的是，Heroku 日志并没有那么有用：

```
2012-07-24T01:39:27+00:00 heroku[slugc]: Slug compilation finished
2012-07-24T01:39:32+00:00 heroku[web.1]: Starting process with command `bin/trinidad --threadsafe --rackup -p 9108 -e production`
2012-07-24T01:39:43+00:00 app[web.1]: INFO: Initializing ProtocolHandler ["http-bio-9108"]
2012-07-24T01:39:43+00:00 app[web.1]: Jul 24, 2012 1:39:43 AM org.apache.coyote.AbstractProtocol init
2012-07-24T01:39:43+00:00 app[web.1]: Jul 24, 2012 1:39:43 AM org.apache.catalina.core.StandardService startInternal
2012-07-24T01:39:43+00:00 app[web.1]: INFO: Starting service Tomcat
2012-07-24T01:39:43+00:00 app[web.1]: Jul 24, 2012 1:39:43 AM org.apache.catalina.core.StandardEngine startInternal
2012-07-24T01:39:43+00:00 app[web.1]: INFO: Starting Servlet Engine: Apache Tomcat/7.0.28
2012-07-24T01:39:43+00:00 app[web.1]: 2012-07-24 01:39:43 INFO: No global web.xml found
2012-07-24T01:39:43+00:00 heroku[web.1]: State changed from starting to up
2012-07-24T01:39:44+00:00 app[web.1]: 2012-07-24 01:39:44 INFO: INFO: jruby 1.7.0.preview1 (ruby-1.9.3-p203) (2012-05-19 00c8c98) (OpenJDK 64-Bit Server VM 1.6.0_20) [linux-amd64-java]
2012-07-24T01:39:44+00:00 app[web.1]: 2012-07-24 01:39:44 INFO: INFO: using a shared (threadsafe!) runtime
2012-07-24T01:39:47+00:00 app[web.1]: 2012-07-24 01:39:47 SEVERE: ERROR: unable to create shared application instance
2012-07-24T01:39:47+00:00 app[web.1]: 2012-07-24 01:39:47 SEVERE: Error: application initialization failed
2012-07-24T01:39:47+00:00 app[web.1]: 2012-07-24 01:39:47 INFO: Starting ProtocolHandler ["http-bio-9108"]
2012-07-24T01:39:49+00:00 heroku[router]: GET agile-crag-7590.herokuapp.com/ dyno=web.1 queue=0 wait=0ms service=512ms status=500 bytes=643
2012-07-24T01:39:49+00:00 heroku[router]: GET agile-crag-7590.herokuapp.com/favicon.ico dyno=web.1 queue=0 wait=0ms service=23ms status=500 bytes=643 
```

有没有人知道什么可能是错的？我尝试将 buildpack 中使用的 JRuby 版本更改为 1.6.7 和/或在应用程序配置和 Procfile 中禁用多线程，但得到的结果大致相同。

提前致谢...

# git - 如何解决 git pull 的问题

> ID：11623172
> 
> 赞同：2
> 
> 时间：2012-07-24T02:15:28.417
> 
> 标签：git

我在工作时克隆了一个 https github 存储库。在工作中，我可以毫无问题地拉/推。但是，当我回家时，“git pull”就挂了。Wireshark 没有显示任何通过 https 流出的流量。我没有在 git 中定义任何代理设置。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:13:47.147

```
set GIT_CURL_VERBOSE=1 
```

然后运行

```
git pull 
```

# vba - 觉得奇怪。以某些名称隐藏 Activex 组合框不起作用

> ID：11623173
> 
> 赞同：1
> 
> 时间：2012-07-24T02:15:38.870
> 
> 标签：vba, excel

我有一个名为“ `Start_EX_Item_Catalog_CatalogGenre`”的 Activex 组合框，但此代码`ActiveSheet.Shapes("Start_EX_Item_Catalog_CatalogGenre").Visible = False`不起作用，有什么帮助吗？

当我在“”之前命名它时，我可以隐藏它`Start_EX_Item_Catalog_CatalogGen`，不再是。

Excel 2007

运行时错误 -2147024809 (80070057)

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:00:35.127

原因很简单。

工作表上的 ActiveX 对象必须以字母开头，最多可包含 32 个字符，包括字母、数字和下划线 (_)。

的长度`Start_EX_Item_Catalog_CatalogGenre`为 34。

因此`Start_EX_Item_Catalog_CatalogGen`这是 32 个字符的工作，但`Start_EX_Item_Catalog_CatalogGenre`没有

您可以为控件命名超过 32 个字符，Excel 不会抱怨，但它不会让您在代码中使用该名称。

# symfony - 如何在 Symfony2 中删除 PHPSESSID

> ID：11623182
> 
> 赞同：0
> 
> 时间：2012-07-24T02:15:55.753
> 
> 标签：symfony

我在网上部署了我的网站，一切正常，但我在页面链接的末尾有类似的东西：

```
../..?PHPSESSID=.... 
```

所以我的问题是关于如何从我网站中所有页面的路径中删除 PHPSESSID cookie？

编辑

所以我找到了一个很好的解决方案，只需将此代码放在我的 .htaccess 中的 web 文件夹中：

```
<IfModule mod_rewrite.c>

 RewriteEngine On

 #remove PHPSESSID 

  RewriteCond %{QUERY_STRING} PHPSESSID=.*$ 

  RewriteRule .* %{REQUEST_URI}? [R=301,L]

 </IfModule> 
```

永远不要让 ?PHPSESSID 再次伤害您的排名！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T06:01:06.410

Symfony 没有添加 PHPSESSID，PHP 被配置为将 PHPSESSID 变量附加到 URL 以允许 PHP 跟踪会话。您可以通过使用禁用此行为

```
ini_set('session.use_trans_sid',false); 
```

请参阅[我的虚拟主机正在将 ?PHPSESSID=fgh2h45... 添加到 URL 的末尾以](https://stackoverflow.com/questions/3191235/my-web-host-is-adding-phpsessid-fgh2h45-to-the-end-of-the-url)获取更多详细信息

# java - Java 语音聊天 - 混合输入数据以用于单个输出

> ID：11623185
> 
> 赞同：3
> 
> 时间：2012-07-24T02:16:32.940
> 
> 标签：java, sockets, audio, javax.sound.sampled

我正在尝试编写一个 Java 语音聊天应用程序，并且已经实现了回声功能，但是在尝试连接多个客户端时，我被卡住了。我知道您不能在不混合数据的情况下遍历套接字并将数据发送给所有连接的人。（我已经尝试过了，这听起来不像它应该的那样）。我不太确定该怎么做，我正在使用一个非常简单的字节缓冲回显服务器作为服务器（我想在其中执行混音）。我还有一个客户端，它接受麦克风输入，将其发送到服务器，从服务器获取数据，然后从扬声器中播放该数据。

注意：客户端由 2 个类（Program 和 SoundReceiver）组成。我正在使用 javax.sound.sampled 库。

回声服务器： http: [//pastebin.com/c9KiaTpJ](http://pastebin.com/c9KiaTpJ)

```
import java.net.*;
import java.io.*;
import java.util.*;

public class Echo
{
    public static void main(String[] args) throws Exception
    {
        ServerSocket serverSocket = new ServerSocket(3000);
        while(true){Thread echoThread = new Thread(new EchoThread(serverSocket.accept()));
                    echoThread.start();}
    }
}

class EchoThread implements Runnable
{
    public static Collection<Socket> sockets = new ArrayList<Socket>();
    Socket connection = null;
    DataInputStream dataIn = null;
    DataOutputStream dataOut = null;

    public EchoThread(Socket conn) throws Exception
    {
        connection = conn;
        dataIn = new DataInputStream(connection.getInputStream());
        dataOut = new DataOutputStream(connection.getOutputStream());
        sockets.add(connection);
    }

    public void run()
    {
        int bytesRead = 0;
        byte[] inBytes = new byte[1];
        while(bytesRead != -1)
        {
            try{bytesRead = dataIn.read(inBytes, 0, inBytes.length);}catch (IOException e){}
            if(bytesRead >= 0)
            {
                sendToAll(inBytes, bytesRead);
            }
        }
        sockets.remove(connection);
    }

    public static void sendToAll(byte[] byteArray, int q)
    {
        Iterator<Socket> sockIt = sockets.iterator();
        while(sockIt.hasNext())
        {
            Socket temp = sockIt.next();
            DataOutputStream tempOut = null;
            try
            {
                tempOut = new DataOutputStream(temp.getOutputStream());
            } catch (IOException e1)
            {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
            try{tempOut.write(byteArray, 0, q);}catch (IOException e){}
        }
    }
} 
```

客户端程序类： http: [//pastebin.com/v24CYwXE](http://pastebin.com/v24CYwXE)

```
import java.io.DataOutputStream;
import java.net.*;
import javax.sound.sampled.*;

public class Program
{
    public static void main(String[] args) throws Exception
    {
        AudioFormat af = new AudioFormat(8000.0f,8,1,true,false);
        DataLine.Info info = new DataLine.Info(TargetDataLine.class, af);
        TargetDataLine microphone = (TargetDataLine)AudioSystem.getLine(info);
        microphone.open(af);
        Socket conn = new Socket("localhost",3000);
        microphone.start();
        DataOutputStream dos = new DataOutputStream(conn.getOutputStream());
        int bytesRead = 0;
        byte[] soundData = new byte[1];
        Thread inThread = new Thread(new SoundReceiver(conn));
        inThread.start();
        while(bytesRead != -1)
        {
            bytesRead = microphone.read(soundData, 0, soundData.length);
            if(bytesRead >= 0)
            {
                dos.write(soundData, 0, bytesRead);
            }
        }
        System.out.println("IT IS DONE.");
    }
} 
```

客户端 SoundReceiver 类： http: [//pastebin.com/2tt0Jucv](http://pastebin.com/2tt0Jucv)

```
import java.net.*;
import java.io.*;

import javax.sound.sampled.*;

public class SoundReceiver implements Runnable
{
    Socket connection = null;
    DataInputStream soundIn = null;
    SourceDataLine inSpeaker = null;

    public SoundReceiver(Socket conn) throws Exception
    {
        connection = conn;
        soundIn = new DataInputStream(connection.getInputStream());
        AudioFormat af = new AudioFormat(8000.0f,8,1,true,false);
        DataLine.Info info = new DataLine.Info(SourceDataLine.class, af);
        inSpeaker = (SourceDataLine)AudioSystem.getLine(info);
        inSpeaker.open(af);
    }

    public void run()
    {
        int bytesRead = 0;
        byte[] inSound = new byte[1];
        inSpeaker.start();
        while(bytesRead != -1)
        {
            try{bytesRead = soundIn.read(inSound, 0, inSound.length);} catch (Exception e){}
            if(bytesRead >= 0)
            {
                inSpeaker.write(inSound, 0, bytesRead);
            }
        }
    }
} 
```

基本上，我想将所有传入字节合并到一个字节数组中，同时保持每个人的声音都是完整的（就像一个 3 路电话一样）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T06:58:59.563

设置 serverSocket 的限制可能会有所帮助，例如 new ServerSocket(3000,101); 诸如积压或队列长度之类的东西..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T13:40:25.470

就是这一行：

```
try
{
    tempOut.write(byteArray, 0, q);
}
catch (IOException e){
} 
```

在服务器端，我认为将数据发送回客户端，因为有回声。我认为您应该省略该行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-17T05:16:51.947

我认为您需要在服务器端创建一个检查。就像从具有连接实例的 EChoThread 调用 sendAll 一样，只需将其传递给 sendAll 并将 sockIt 与 connection 进行比较，如果它们相同，那么这是发送日期的同一个套接字，无需向其发送数据self 所以跳过它并移动到下一个套接字。

应在服务器端进行以下更改：

```
 public void run()
{
    int bytesRead = 0;
    byte[] inBytes = new byte[1];
    while(bytesRead != -1)
    {
        try{bytesRead = dataIn.read(inBytes, 0, inBytes.length);}catch (IOException e)       {}
        if(bytesRead >= 0)
        {
            sendToAll(connection, inBytes, bytesRead);
        }
    }
    sockets.remove(connection);
}

public static void sendToAll(Socket connection, byte[] byteArray, int q)
{
    Iterator<socket> sockIt = sockets.iterator();
    while(sockIt.hasNext())
    {
        Socket temp = sockIt.next();
        if(connection == temp){
            continue;
        }
        DataOutputStream tempOut = null;
        try
        {
            tempOut = new DataOutputStream(temp.getOutputStream());
        } catch (IOException e1)
        {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        try{tempOut.write(byteArray, 0, q);}catch (IOException e){}
      }
  }

 public void run()
{
    int bytesRead = 0;
    byte[] inBytes = new byte[1];
    while(bytesRead != -1)
    {
        try{bytesRead = dataIn.read(inBytes, 0, inBytes.length);}catch (IOException e)       {}
        if(bytesRead >= 0)
        {
            sendToAll(connection, inBytes, bytesRead);
        }
    }
    sockets.remove(connection);
}

public static void sendToAll(Socket connection, byte[] byteArray, int q)
{
    Iterator<socket> sockIt = sockets.iterator();
    while(sockIt.hasNext())
    {
        Socket temp = sockIt.next();
        if(connection == temp){
            continue;
        }
        DataOutputStream tempOut = null;
        try
        {
            tempOut = new DataOutputStream(temp.getOutputStream());
        } catch (IOException e1)
        {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        }
        try{tempOut.write(byteArray, 0, q);}catch (IOException e){}
      }
  } 
```

# emacs - 如何将键绑定到 emacs 中的缩进/未缩进区域？

> ID：11623189
> 
> 赞同：15
> 
> 时间：2012-07-24T02:16:41.133
> 
> 标签：emacs

我想将两个键绑定定义为缩进/取消缩进区域 4 个空格。

* * *

### 前：

```
hello
world
foo
bar 
```

*   直观地选择`world`和`foo`。
*   类型`>`

### 后：

```
hello
    world
    foo
bar 
```

* * *

我也想绑定`<`到 unindent 区域。
我不熟悉`emacs`，请帮助。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-24T05:30:10.693

已经有键盘快捷键：

缩进：`C-u 4 C-x TAB`

缩进`C-u - 4 C-x TAB`

如果您觉得输入的时间太长，您可以在 .emacs 文件中添加以下内容：

```
(defun my-indent-region (N)
  (interactive "p")
  (if (use-region-p)
      (progn (indent-rigidly (region-beginning) (region-end) (* N 4))
             (setq deactivate-mark nil))
    (self-insert-command N)))

(defun my-unindent-region (N)
  (interactive "p")
  (if (use-region-p)
      (progn (indent-rigidly (region-beginning) (region-end) (* N -4))
             (setq deactivate-mark nil))
    (self-insert-command N)))

(global-set-key ">" 'my-indent-region)
(global-set-key "<" 'my-unindent-region) 
```

使用此代码，*大于*( `>`) 和*小于*( `<`) 键将每个标记区域缩进/取消缩进 4 个空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-30T17:58:35.927

```
(defun keyboard-indent (&optional arg)
  (interactive)
  (let ((deactivate-mark nil)
        (beg (or (and mark-active (region-beginning))
                 (line-beginning-position)))
        (end (or (and mark-active (region-end)) (line-end-position))))
    (indent-rigidly beg end (* (or arg 1) tab-width))))

(defun keyboard-unindent (&optional arg)
  (interactive)
  (keyboard-indent (* -1 (or arg 1)))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-22T19:28:19.000

除了@Thomas 已经写过的内容之外，您可能不想使用键`<`和`>`缩进或取消缩进。只是图像，您需要编写一些 HTML 并且不能再输入这些字符。这就是为什么我在我的`init file`, 中插入以下内容作为关键设置：

```
(global-set-key (kbd "C-<") 'my-indent-region)
(global-set-key (kbd "C->") 'my-unindent-region) 
```

注意：没有`(kbd ...)`. 你会得到一个错误：

```
global-set-key: Key sequence C - > starts with non-prefix key C 
```

# sql - 什么时候可以在 SQL 中使用 SELECT *

> ID：11623192
> 
> 赞同：0
> 
> 时间：2012-07-24T02:17:01.287
> 
> 标签：sql, select

我知道通常在 SQL 中使用 SELECT * 是一个坏主意。有没有例外情况？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T02:19:59.260

当您需要当前和未来的*每一*列时，考虑到可能会添加或删除一些列。

通常，这种情况仅适用于完全需要数据库信息的工具，例如模式列表器，或者如果您正在执行分析以尝试找出您需要的信息实际位于何处。

“真正的”应用程序几乎*从*不需要它，它应该只知道并要求他们需要什么。

您不希望您的应用程序因为数据库的其他一些用户决定他们需要在每一行中添加 42 个 2GB BLOB 列而陷入尖叫堆中：-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:20:51.620

通常只有在移动大量数据时才重要，因为这样你的吞吐量就会被最大化。

我经常使用它，因为就您的应用程序原型设计而言，它使 ALTERing 表变得轻松。

就处理而言，这无关紧要 - 由于 MySQL 的性质。

所以不用担心。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:23:16.637

如果使用它的代码能够自动提取列名并随后映射所有名称以便在您的应用程序中进一步使用，那么您可以使用`SELECT *`.

但是，这通常是个坏主意，因为假设您想要检索的列的位置可能很诱人（取决于您使用的 DB API，它可能是基于索引的而不是基于名称的）。为了可读性，通常最好明确地写下您想要检索的内容。

使用时可能会出现一些问题`SELECT *`：

*   如果列标签没有明确定义（例如`SUM(...)`，来自视图或 CTE 的操作或其他操作），
*   如果选择中的多个列具有相同的名称（例如，连接或视图/CTE 与`AS`子句）。

Java[`ResultSet`](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSet.html)对名称的描述如下：

> 可以使用列的索引号或列的名称来检索值。一般来说，使用列索引会更有效。
> 
> [...]
> 
> 当使用列名调用 getter 方法并且多个列具有相同名称时，将返回第一个匹配列的值。列名选项设计为在生成结果集的 SQL 查询中使用列名时使用。对于查询中未明确命名的列，最好使用列号。如果使用列名，程序员应该注意保证它们唯一地引用预期的列，这可以通过 SQL AS 子句来保证。

# php - 在非对象 PHP/SQL 上调用成员函数 execute()

> ID：11623193
> 
> 赞同：1
> 
> 时间：2012-07-24T02:17:05.987
> 
> 标签：php, mysql, sql

下面应该做的，是从 HTML 表单中获取我们想要创建的表的标题，现在我硬编码了它的值......但即使使用硬编码的值，我也会收到以下错误. 连接到数据库致命错误：在第 44 行的 'filepath'.php 中的非对象上调用成员函数 execute()

```
 <?php

            // Configuration
            $hostname = 'host';
            $username = 'user';
            $password = 'pass';
            $database = 'dbname';

            $table = $_Post['table'];
        try {
            $conn = new PDO('mysql:host='. $hostname .';dbname='. $database, $username, $password);
    echo "Connected to database"; // check for connection
    echo $table;
    // We get the connected to database message....
$conn->exec("SET CHARACTER SET utf8");      // Sets encoding UTF-8
 // table A is going to be a var , but for now testing with a hardcoded value 
  $sql = "CREATE TABLE tableA (
  id int(8) ,
  Question varchar(170),
  AnswerA varchar(100),
  AnswerB varchar(100),
  AnswerC varchar(100),
  AnswerD varchar(100),
  A int(8),
  B int (8), 
  C int (8) , 
  D int (8)
  ) CHARACTER SET utf8 COLLATE utf8_general_ci";

  $sqlb = "INSERT INTO `DBNAME` tableA (`id`, `Question`, `AnswerA`, `AnswerB`, `AnswerC`, `AnswerD`, `A`, `B`, `C`, `D`) 
  VALUES ('1', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), 
  ('2', NULL,  NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), 
  ('3', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
  ('4', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
  ('5', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), 
  ('6', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), 
  ('7', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
  ('8', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL), 
  ('9', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL),
  ('10', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)";
  // lets not do it all at once eh , run a secound script to add in all the values 

 $sql->execute(); 
 $sqlb->execute(); 
 // if($conn->exec($sql) !== false) echo 'The sites table is created';  
//if($conn->exec($sqlb) !== false) echo 'We inserted some values !';  

}
catch(PDOException $e)
    {
    echo $e->getMessage();
    }
//  }
// write code to check if we succeded in creating a table with with $, if so display an alert of of some kind
// with Javascript ....

// disabled the redirect so i could see the error message
//header ("Location: quizsubmit.html");
/* Make sure that code below does not get executed when we redirect. */
exit ;

?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T02:19:45.117

`$sql`and`$sqlb`变量包含字符串，而不是 PHP 对象。他们没有`execute()`方法。

您需要先准备查询，然后才能执行生成的语句对象：

```
$stmt = $conn->prepare($sql);
$stmtb = $conn->prepare($sqlb);

$stmt->execute();
$stmtb->execute(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:20:04.503

你正在调用`->execute()`一个字符串，它应该如何工作？您需要使用`prepare()`方法来创建语句对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:23:30.257

如上所述，您可以调用准备返回`PDOStatement`，然后调用执行或只调用`exec`PDO 对象。1)

```
$stmt = $conn->prepare($sql);
$stmtb = $conn->prepare($sqlb);

$stmt->execute();
$stmtb->execute(); 
```

2)

```
$pdoObj = new PDO('mysql:host='. $hostname .';dbname='. $database, $username, $password);
$pdoObj->exec($sql); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-01T10:22:31.107

我有同样的错误......

我正在选择一个不存在的表。我的错误。

# android - 如何在android中以编程方式调整按钮的大小

> ID：11623203
> 
> 赞同：1
> 
> 时间：2012-07-24T02:19:05.623
> 
> 标签：android, android-layout

我希望 Ui 以编程方式完成，我使用的是简单的按钮，它占据了屏幕的整个宽度，我应该如何调整按钮宽度。

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //setContentView(R.layout.activity_main);
    TextView label = new TextView(this);  
    label.setText("Hello");  
    label.setTextSize(20);  
    Button but = new Button(this);

    but.setText("Click Me");
    but.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            // Perform action on click
            System.out.println("Button Clicked");
            Intent myIntent = new Intent(v.getContext(), SecondActivity.class);
            startActivityForResult(myIntent, 0);
        }
    });
    LinearLayout ll = new LinearLayout(this);  
    ll.setOrientation(LinearLayout.VERTICAL);  

    ll.addView(label);
    ll.addView(but);
    setContentView(ll);  

} 
```

是否有任何单独的布局我应该添加此按钮？任何有关以编程方式深入理解布局的教程都会很有用。

问候 Rakesh Shankar.P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:47:48.103

检查[这个](http://android-coding.blogspot.in/2011/05/resize-button-programmatically-using.html)_`Resize Button programmatically using Java Code`

```
 (or)

final float scale = getResources().getDisplayMetrics().density;
int heightDp = (int) (33 * scale + 0.5f);
ViewGroup.LayoutParams params = b.getLayoutParams();//b========>ur button
params.height = heightDp;
b.setLayoutParams(params);
b.requestLayout(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T05:35:38.653

```
LayoutParams params =new      LinearLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT);
LinearLayout layout = new LinearLayout(this);
layout.setOrientation(LinearLayout.VERTICAL);

Button btn = new Button(this);
btn.setText("login");
btn.setLayoutParams(params);

layout.addView(btn); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T05:44:24.033

请参阅此链接以编程方式调整按钮大小[http://android-coding.blogspot.in/2011/05/resize-button-programmatically-using.html](http://android-coding.blogspot.in/2011/05/resize-button-programmatically-using.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T05:05:38.123

您可以将参数添加到按钮

```
LinearLayout.LayoutParams lp_l = new LinearLayout.LayoutParams(
            (LayoutParams.WRAP_CONTENT), (LayoutParams.WRAP_CONTENT));
but.setLayoutParams(rel_lp); 
```

# java - 如何从 jtable 内的组合框中获取值和选定值？

> ID：11623218
> 
> 赞同：0
> 
> 时间：2012-07-24T02:20:50.947
> 
> 标签：java, swing, combobox, jtable, jcombobox

在提出我的问题之前，我将尝试解释我需要和正在尝试做的事情。我已经设置了一个表格，其中有几列显示一个组合框，如图所示：

[图片 http://www.freeimagehosting.net/newuploads/4ks9s.png](http://www.freeimagehosting.net/newuploads/4ks9s.png)

这应该为作业创建一个“订单”，这意味着，作业 1 将首先到站 1。如果我在站 2 列中添加站 4，那么它将到站 4，依此类推。它旨在创建订单以进行进一步处理。所以，我想：

*   创建表格并显示渲染的组合框；
*   如果前一列的值为“无”，则使列 (3-6) 中的单元格不可编辑（从而确保其保持正确的顺序）；
*   不要显示已经为该行选择的站；

但是对于初学者来说，我无法获得从组合框中选择时设置的值，也无法获得这些值！

到目前为止，这是我的代码。

创建组合框：

```
public class SimGui extends JFrame {
                          //implements ActionListener {
    String Stations[] = new String[] {"Station 1","Station 2","Station 3","Station 4","Station 5","None"};
    JComboBox stationscombo = new JComboBox(Stations);
    Object obj = stationscombo.getSelectedItem(); 
```

桌子上的鼠标点击事件：

```
private void jTable2MouseClicked(java.awt.event.MouseEvent evt) {                                     
    //Object event = evt.getSource();
    obj = stationscombo.getSelectedItem();
    System.out.println("Item: " + obj);
    //ListSelectionModel selectionModel = jTable2.getSelectionModel();
    int tb1columns = jTable2.getColumnCount();
    int selectionrow= jTable2.getSelectedRow();
    int selectioncolumn = jTable2.getSelectedColumn();
    if (selectioncolumn > 1) {
        for (int i=2;i<tb1columns;i++) {
            System.out.println(jTable2.getValueAt(selectionrow,selectioncolumn));
            /*if (jTable2.getValueAt(selectionrow, i) != "None") {
                stationscombo.removeItem(jTable2.getValueAt(selectionrow, i));
            }*/
        }
    }
    else { System.out.println(jTable2.getValueAt(selectionrow,selectioncolumn)); }
} 
```

表结构：

```
jTable2.setModel(new javax.swing.table.DefaultTableModel(
    new Object [][] {
        {null, null, null, null, null, null, null},
        {null, null, null, null, null, null, null},
        {null, null, null, null, null, null, null}
    },
    new String [] {
        "Job Type", "Parts", "Station 1", "Station 2", "Station 3", "Station 4", "Station 5"
    }
) {
    Class[] types = new Class [] {
        java.lang.Integer.class, java.lang.Integer.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class
    };
    boolean[] canEdit = new boolean [] {
        false, true, true, true, true, true, true
    };

    public Class getColumnClass(int columnIndex) {
        return types [columnIndex];
    }

    public boolean isCellEditable(int rowIndex, int columnIndex) {
        return canEdit [columnIndex];
    }
});
jTable2.getTableHeader().setReorderingAllowed(false);
for (int x = 2;x<7;x++) {
    jTable2.getColumnModel().getColumn(x).setCellEditor(new DefaultCellEditor(stationscombo));
}
jTable2.addMouseListener(new java.awt.event.MouseAdapter() {
    public void mouseClicked(java.awt.event.MouseEvent evt) {
        jTable2MouseClicked(evt);
    }
}); 
```

我环顾四周，试图为组合框实现一个监听器，但失败了。如果我在类上实现 ActionListener ，它将显示一条警告：

```
SimGui is not abstract and does not override abstract method actionPerformed(java.awt.event.ActionEvent) in java.awt.event.ActionListener 
```

我已经为正在工作的表实现了一个 ActionListener，但我不知道这是否会干扰？

```
Action action = new AbstractAction() {
    @Override
    public void actionPerformed(ActionEvent e) {
        System.out.println(e.getSource());
        //TableCellListener tcl = (TableCellListener)e.getSource();
        //JComboBox cb = (JComboBox)e.getSource();
        //String newSelection = (String)cb.getSelectedItem();
        /*JComboBox cb = (JComboBox)e.getSource();
        String teste = (String)cb.getSelectedItem();
        System.out.println("Item: " + teste);*/
        //TableCellListener tcl1 = new TableCellListener(jTable1, action);
        /*if (tcl.getColumn() == 3) {
            if (tcl.getNewValue() == true) {
                int x = tcl.getColumn();
                table1model.setColumnEditable(x, true);
            }
            else { 
                table1model.setColumnEditable(tcl.getColumn(), false);
            }
            /*boolean canEdit[] = {
            false, true, true, true, true, true
            };
            //System.out.println(isCellEditable(tcl1.getRow(),tcl1.getColumn()));
        }*/
        /*System.out.println(newSelection);
        System.out.println("Row   : " + tcl.getRow());
        System.out.println("Column: " + tcl.getColumn());
        System.out.println("Old   : " + tcl.getOldValue());
        System.out.println("New   : " + tcl.getNewValue());*/
    }
}; 
```

但最重要的是，我的问题是，如何正确使用表格内的组合框，以便我可以设置值并在选择时获取项目值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:25:56.430

看看[TableModel.setColumnValue(row, col)](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/TableModel.html#getValueAt%28int,%20int%29)

您可能还想对[表格单元格编辑器](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)进行一些阅读，这将帮助您准确了解正在发生的事情。

# php - PHP、HTML 或 XML 中的 %S 是什么意思？

> ID：11623224
> 
> 赞同：37
> 
> 时间：2012-07-24T02:21:20.090
> 
> 标签：php, html, xml, string-literals

我正在看[Webmonkey 的 PHP 和 MySql 教程，第 2 课](http://www.webmonkey.com/2010/02/php_and_mysql_tutorial_-_lesson_2)。我认为这是一个php文字。是什么`%s`意思？它`print_f()`至少在前几个代码块中的 while 循环中的函数内部。

`printf("<tr><td>%s %s</td><td>%s</td></tr>n", ...`

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-07-24T02:29:31.083

以 % 符号开头的 printf 或 sprintf 字符是占位符（或标记）。它们将被作为参数传递的变量替换。

**例子：**

```
$str1 = 'best';
$str2 = 'world';

$say = sprintf('Tivie is the %s in the %s!', $str1, $str2);
echo $say; 
```

这将输出：

> 蒂维是世界上最好的！

注意：还有更多的占位符（%s 代表字符串，%d 代表十进制数，等等...）

* * *

**命令：**

传递参数的顺序很重要。如果您将 $str1 与 $str2 切换为

```
$say = sprintf('Tivie is the %s in the %s!', $str2, $str1); 
```

它会打印

> “蒂维是世界上最好的！”

但是，您可以像这样更改参数的阅读顺序：

```
$say = sprintf('Tivie is the %2$s in the %1$s!', $str2, $str1); 
```

这将正确打印句子。

* * *

此外，请记住 PHP 是一种动态语言，不需要（或支持）显式类型定义。这意味着它会根据需要处理变量类型。在 sprint 中，这意味着如果您将“字符串”作为数字占位符 (%d) 的参数传递，该字符串将被转换为可能产生奇怪结果的数字 (int, float...)。这是一个例子：

```
$onevar = 2;
$anothervar = 'pocket';
$say = sprintf('I have %d chocolate(s) in my %d.', $onevar, $anothervar);
echo $say; 
```

这将打印

> 我的 0 中有 2 块巧克力。

更多阅读[**PHPdocs**](http://www.php.net/manual/en/function.printf.php)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-07-24T02:22:40.693

In `printf`,`%s`是将插入到字符串中的数据的占位符。额外的参数`printf`是要插入的值。它们在位置上与占位符相关联：第一个占位符获得第一个值，第二个占位符获得第二个值，依此类推。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-24T02:28:19.227

`%s`是一个类型说明符，在`%s`.

除了`%s`您可以使用其他[说明符](http://www.php.net/manual/en/function.sprintf.php)之外，最受欢迎的如下：

d - 参数被视为整数，并显示为（有符号的）十进制数。

f - 参数被视为浮点数，并显示为浮点数（区域设置感知）。

s - 参数被视为并呈现为字符串。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-24T02:24:18.687

```
$num = 5; 
$location = 'tree';

$format = 'There are %d monkeys in the %s'; 
echo sprintf($format, $num, $location); 
```

将输出：“树上有 5 只猴子。”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-20T21:46:54.393

`printf()`or函数将`sprintf()`格式化的字符串写入变量。这是语法：

```
sprintf(format,arg1,arg2,arg++) 
```

**格式：**

*   %% - 返回一个百分号
*   %b - 二进制数
*   %c - 根据 ASCII 值的字符
*   %d - 有符号十进制数（负数、零或正数）
*   %e - 使用小写的科学记数法（例如 1.2e+2）
*   %E - 使用大写的科学记数法（例如 1.2E+2）
*   %u - 无符号十进制数（等于或大于零）
*   %f - 浮点数（本地设置感知）
*   %F - 浮点数（不支持本地设置）
*   %g - %e 和 %f 中的较短者
*   %G - %E 和 %f 中的较短者
*   %o - 八进制数
*   %s - 字符串
*   %x - 十六进制数（小写字母）
*   %X - 十六进制数（大写字母）

**参数1**：

*   *要在格式字符串的第一个% 符号*处插入的参数..（必需。）

**参数2**：

*   要在格式字符串中的第二个*% 符号*处插入的参数。（选修的）

**参数++**：

*   要在第三个、第四个等处插入的参数*%* - 格式字符串中的符号（可选）

示例 1：

```
$number = 9;
$str = "New York";
$txt = sprintf("There are approximately %u million people in %s.",$number,$str);
echo $txt; 
```

这将输出：

> 大约有`9`百万人`New York`。

**arg1**、**arg2**、**arg++**参数将插入到主字符串中的百分号 (%) 处。此功能“逐步”工作。在第一个 % 符号处插入 arg1，在第二个 % 符号处插入 arg2，以此类推。

> **注意**：如果 % 符号多于参数，则必须使用占位符。在 % 符号之后插入一个占位符，由参数编号和“\$”组成。让我们看另一个例子：

示例 2

```
$number = 123;
$txt = sprintf("With 2 decimals: %1\$.2f
<br>With no decimals: %1\$u",$number);
echo $txt; 
```

这将输出：

> 有 2 位小数：`123.00`
> 没有小数：`123`

**要记住的另一个重要提示是：**

> 使用`printf()`and`sprintf()`函数，转义字符不是反斜杠'\'而是'%'。IE。要打印 '%' 字符，您需要自行对其进行转义：

`printf('%%%s%%', 'Nigeria Naira');`

这将输出：

> %尼日利亚奈拉%

随意探索官方[PHP 文档](https://secure.php.net/manual/en/function.sprintf.php)

# ruby-on-rails-3 - 按 has_many 计数排序：通过 Rails 3 中的项目

> ID：11623226
> 
> 赞同：1
> 
> 时间：2012-07-24T02:21:38.617
> 
> 标签：ruby-on-rails-3, count, associations, has-many-through

如果我有 3 个模型：

模型`Section`

模型`User`

`has_many :votes`

模型`Vote`

`belongs_to :user`

和内部模型`Section`

```
has_many :users
has_many :votes, :through => :users 
```

`AR`如何使用关联获取按票数排序的章节列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:06:50.913

最合理的方法是使用编写为原始 SQL 的子查询来对结果进行排序，如下所示...

```
Section.order(
  '(select count(1) from votes inner join users on votes.user_id=users.id where users.section_id=sections.id)'
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-11T07:16:05.827

```
Section.joins(users: :votes).group(:id).order('COUNT(*)') 
```

# css - 设计不加载自定义 CSS

> ID：11623229
> 
> 赞同：3
> 
> 时间：2012-07-24T02:22:18.293
> 
> 标签：css, ruby-on-rails, devise, haml

因此，我们最近开始从定制的身份验证模块更改为设计，我在试图弄清楚如何将我的 css 加载到我的设计视图中时遇到了非常糟糕的事情。我可以正确加载部分，甚至是来自 /layouts/ 的部分，但它一直试图从 /assets/devise 访问 css，达到 404。这是我的 app/views/registration/new.html.haml，例如：

```
%h2 Sign up
= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f|
  = devise_error_messages!
  %div
    = f.label :email
    %br/
    = f.email_field :email
  %div
    = f.label :password
    %br/
    = f.password_field :password
  %div
    = f.label :password_confirmation
    %br/
    = f.password_field :password_confirmation
  %div= f.submit "Sign up"
= render "users/shared/links" 
```

因此，任何帮助将不胜感激。=)

在快速更新中：我已经运行了 rails g devise:views。我认为问题在于它没有在资产管道中加载我的 CSS。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:27:46.170

您应该首先生成设计视图。试试这个：`rails generate devise:views`。然后您还可以自定义设计视图。

# ajax - Facebook 如何处理主页和个人资料页面之间的请求

> ID：11623230
> 
> 赞同：1
> 
> 时间：2012-07-24T02:22:32.707
> 
> 标签：ajax, facebook

我只是想知道 facebook 如何管理对“我的个人资料页面”和“主页”以及其他一些似乎只重新加载一些内容的页面的请求。

例如，当我在 facebook 上的“我的个人资料页面”上时，我点击主页按钮，顶部栏按钮和右侧的聊天面板保持不变（它们没有重新加载）。我在 webkit 控制台中监控了 XMLHTTPRequest 并且没有生成 ajax，所以它不是 Ajax（我认为）。否则，如果单击这些链接时生成了 FULL http 请求，我认为必须重新加载整个页面，对吗？所以我不知道这是如何处理的。你能帮我一把吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-06T09:21:10.990

这是一种称为“quickling”的性能优化，他们还使用“pagecache”策略来减少来自服务器的数据。在底层，它依赖于 javascript 作为 LinkController 执行，它委托一个超链接点击事件，然后发送一个 ajax（或使用 iframe）向服务器请求 pagelet 数据，响应将是一个 json 格式的数据结构, 然后 javascript 将插入当前页面的内容。你地址栏中的uri可以处理旧浏览器中的hash change事件和H5的History API（pushState）来管理浏览器的历史记录。

# go - go语言exec.Command方法执行失败

> ID：11623232
> 
> 赞同：1
> 
> 时间：2012-07-24T02:22:41.493
> 
> 标签：go

```
package main

import (
    "os/exec"
    "fmt"
)

func main(){
    cmd := exec.Command("find", "/home/d101270c/cbe", "-name","*.log", ">", "log.txt")
    fmt.Println(cmd)
    err := cmd.Run()
    if err != nil {
        fmt.Printf("%s\n", err)
        return
    }
} 
```

运行结果：

```
<1067 linux20 [d101270c] :/home/d101270c>uname -a
Linux linux20 2.6.16.60-0.21-smp #1 SMP Tue May 6 12:41:02 UTC 2008 x86_64 x86_64 x86_64 GNU/Linux
<1068 linux20 [d101270c] :/home/d101270c>tgo
&{/usr/bin/find [find /home/d101270c/cbe -name *.log > log.txt] []  <nil> <nil> <nil> [] <nil> <nil> <nil> <nil> false [] [] [] [] <nil>}
exit status 1 
```

该命令执行失败，不`log.txt`存在。

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T05:34:03.827

您正在传递`find`像 `>' 这样的参数，它不理解，但 shell 可以。这对我有用：

```
(07:28) jnml@tsat:~/src/tmp/SO/11623232$ cat main.go 
package main

import (
    "fmt"
    "os"
    "os/exec"
)

func main() {
    //cmd := exec.Command("sh", "-c", "find /home/d101270c/cbe -name \\*.log > log.txt")
    cmd := exec.Command("sh", "-c", "find "+os.Getenv("HOME")+"/src -name \\*.go > go.txt")
    fmt.Println(cmd)
    err := cmd.Run()
    if err != nil {
        fmt.Printf("%s\n", err)
        return
    }
}
(07:29) jnml@tsat:~/src/tmp/SO/11623232$ go build main.go 
(07:29) jnml@tsat:~/src/tmp/SO/11623232$ ./main 
&{/bin/sh [sh -c find /home/jnml/src -name \*.go > go.txt] []  <nil> <nil> <nil> [] <nil> <nil> <nil> <nil> false [] [] [] [] <nil>}
(07:29) jnml@tsat:~/src/tmp/SO/11623232$ ls -l
celkem 1408
-rw-r--r-- 1 jnml jnml    7845 2012-07-24 07:29 go.txt
-rwxr-xr-x 1 jnml jnml 1428319 2012-07-24 07:29 main
-rw-r--r-- 1 jnml jnml     332 2012-07-24 07:28 main.go
(07:29) jnml@tsat:~/src/tmp/SO/11623232$ wc go.txt 
 131  131 7845 go.txt
(07:29) jnml@tsat:~/src/tmp/SO/11623232$ tail go.txt 
/home/jnml/src/github.com/nsf/gocode/config.go
/home/jnml/src/github.com/nsf/gocode/rpc.go
/home/jnml/src/github.com/nsf/gocode/_gccgo/package.go
/home/jnml/src/github.com/nsf/gocode/_goremote/goremote.go
/home/jnml/src/github.com/nsf/gocode/scope.go
/home/jnml/src/github.com/nsf/gocode/formatters.go
/home/jnml/src/github.com/nsf/gocode/autocompletefile.go
/home/jnml/src/github.com/nsf/gocode/decl.go
/home/jnml/src/tmp/go/main.go
/home/jnml/src/tmp/SO/11623232/main.go
(07:29) jnml@tsat:~/src/tmp/SO/11623232$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T09:54:00.233

也许，你甚至不需要在这里使用 shell。请参阅[http://golang.org/pkg/os/exec/#Cmd.Output](http://golang.org/pkg/os/exec/#Cmd.Output)。

亚历克斯

# linux - 如何获取两个目录的差异并将创建的补丁应用于原始目录？

> ID：11623235
> 
> 赞同：0
> 
> 时间：2012-07-24T02:22:50.777
> 
> 标签：linux

我是使用差异的新手。我希望递归地创建目录内容的补丁并将其提供给某人，以便他可以与他一起修补目录（略有不同）。提前致谢。如果有人能澄清我如何使之成为可能，我会很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:27:47.060

只需使用类似的东西创建一个补丁

```
diff -cr originaldirectory/ updateddirectory/ > your.patch 
```

并申请使用

```
patch -p0 -i your.patch 
```

# java - 有没有办法从 Java 应用程序中基于 SOAP 的 Web 服务获取原始 SOAP 请求

> ID：11623237
> 
> 赞同：0
> 
> 时间：2012-07-24T02:23:13.660
> 
> 标签：java, web-services, soap

我正在开发一个应用程序，它将使用 Web 服务将客户端输入传递给供应商。作为项目的第一阶段，供应商向我们提供了 XSD 和 WSDL 信息。我使用 apache CXF 来构建客户端 jar。现在我面临的问题是，作为要求的一部分，我需要将 SOAP 请求以加密（我已经处理了加密部分）XML 文件的形式发送给他们，他们将手动处理，然后发回给我另一个 XML 文件中的响应，我需要解析和检索响应对象。

无论如何以虚拟模式或其他方式使用客户端 jar，看起来我们正在调用客户端，但我们所做的只是将原始 SOAP 请求获取到文件

我有点死胡同，我不完全确定如何在这里进行，任何帮助或建议将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:02:32.577

你可以试试 SoapUI，它是一个免费的网络服务测试工具。我知道您可以查看您的肥皂请求和响应的原始数据。[肥皂界面](http://www.soapui.org)

# wxwidgets - 如何使用 wxImage 保存图像？

> ID：11623241
> 
> 赞同：1
> 
> 时间：2012-07-24T02:23:39.590
> 
> 标签：wxwidgets

我有从我的手机捕获的图像的原始数据，它的分辨率是 480*800，格式是 RGBA。然后我想用 wxImage 函数将它保存到一个 jpeg 图像中。鳕鱼如下：

```
wxFile m_bufferfile = wxFile(wxT("out.raw"));
if(!m_bufferfile->IsOpened())
{
    wxLogMessage( _T("Fail to open the config file.") );
}
m_count = m_bufferfile->Length();
unsigned char* rawdata = new unsigned char[m_count];
for(unsigned int i = 0; i < m_count; i=i+4)
{
    m_bufferfile->Seek(1,wxFromCurrent);
m_bufferfile->Read(rawdata, 3);
}
wxImage *image = new wxImage(480, 800, rawdata, false);
image->SaveFile(wxT("raw.jpg"),wxBITMAP_TYPE_JPEG); 
```

当我打开 raw.jpg 时，它变成了黑色。有错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:28:05.810

你这里有一个错误：

`m_bufferfile->Read(rawdata, 3);`

您只会读入`rawdata`缓冲区的开头。

# jpa - 我如何坚持地图 在 JPA2 中使用地图语义

> ID：11623247
> 
> 赞同：2
> 
> 时间：2012-07-24T02:24:44.330
> 
> 标签：jpa, map, jpa-2.0, eclipselink

我有以下模型： A 类型的实体与许多类型的实体（B，C）有关联。每个 B 实体在 A 中最多出现一对，但同一个 C 实体可以多对出现。例如：

```
A1 --> (B1, C1)
   --> (B2, C2)
   --> (B3, C1)

A2 --> (B1, C3)
   --> (B2, C4)
   --> (B3, C4) 
```

这遵循存储在 A 中的 java.util.Map<B, C> 的语义。此外，每个 C 仅针对一个实体 A 出现，因此 A 到 C 的关系是 OneToMany。我想保留这样的 Map，[Java EE6 doc](http://docs.oracle.com/javaee/6/api/javax/persistence/MapKeyJoinColumn.html)中出现了类似的示例。据我所知，我的代码（如下）与示例基本相同：

```
@Entity
public class A implements Serializable {
    @OneToMany(fetch= FetchType.EAGER)
    @JoinTable(name="A_BC_MAP",
            joinColumns=@JoinColumn(name="A_ID"),
            inverseJoinColumns=@JoinColumn(name="C_ID"))
    @MapKeyJoinColumn(name="B_ID")
    private Map<B, C> pinnedCourses = new HashMap<Course, ScheduleTerm>();
    ...
} 
```

A_BC_MAP 的数据库模式按预期出现，具有三列连接表（A_ID、B_ID、C_ID）。但是，主键约束由 (A_ID, C_ID) 对组成。**因此，我不能在数据库中存储多个（映射键）B 与相同的（映射值）C，就像我在映射中一样。**

这是预期的行为吗？对于地图语义，我希望主键由（A_ID，B_ID）组成。难道我做错了什么？

我目前正在使用 EclipseLink 2.3.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T14:30:58.100

我假设您正在使用 EclipseLink 来定义您的 DDL？您总是可以使用自己的 DDL 脚本。

在 OneToMany 中存在重复项是不常见的，但使用映射键可能是可能的，您可以记录一个错误以让 DDL 生成将映射键定义为主键而不是目标外键。

# ios - 如何在 iPad 中更改 UIWindow 的方向

> ID：11623248
> 
> 赞同：0
> 
> 时间：2012-07-24T02:24:55.000
> 
> 标签：ios

我想为 iPad 中的状态栏创建类似于 UIView 向下滑动的东西。但它仅适用于纵向模式。当我将 iPad 旋转到横向模式时， UIView 仍然以纵向模式滑动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T11:03:36.473

这是因为您将其添加到窗口

```
If you add an additional view controller's UIView property to UIWindow (at the same level as your primary view controller) via the following:

[myWindow addSubview:anotherController.view];

this additional view controller will not receive rotation events and will never rotate. Only the first view controller added to UIWindow will rotate. 
```

所以试试这个：

```
UIWindow* window = [UIApplication sharedApplication].keyWindow;
if (!window) 
    window = [[UIApplication sharedApplication].windows objectAtIndex:0];
[[[window subviews] objectAtIndex:0] addSubview:myView]; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-24T02:39:45.570

You should try:

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return YES;
} 
```

Just put it in your viewcontroller.m file.

# ruby-on-rails - 背景图像不会在 Ruby on Rails 应用程序上呈现

> ID：11623251
> 
> 赞同：1
> 
> 时间：2012-07-24T02:25:37.670
> 
> 标签：ruby-on-rails, haml, background-image

我正在尝试在具有类的 div 的背景中渲染图像`head`。

我的`application` *观点*写成Haml，正文定义如下：

```
%body
    .container
        .head
            .sixteen_columns
            .top-nav 
```

我的`application` *样式表*中包括：

```
.head {
    background-image: url(/images/background_image.jpg); 
    width: 100%; 
    height: auto;
} 
```

我尝试了多种变体来指定图像的路径并多次更改图像名称但无济于事。

问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T20:28:06.180

在 rails 4 中，您现在可以使用 css 和 sass 助手 image-url：

```
div.logo {background-image: image-url("logo.png");} 
```

如果您的背景图像没有出现，请考虑查看您在 css 文件中如何引用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:17:24.660

`asset_path`在样式表中引用图像时 考虑使用帮助器。可以在[此处找到](http://guides.rubyonrails.org/asset_pipeline.html#coding-links-to-assets)*文档*（查看**2.2.1**）在上下文中，您列出的 CSS 会引起您的注意

 **```
.head {
  background-image:url(<%= asset_path 'background_image.jpg'%>); 
  width:100%; 
  height:auto;
} 
```

注意：这要求您的样式表是 erb。

与显式说明路径相比，这样做提供了许多优势，其中一个是随着新版本发布的 Rails 应用程序结构发生变化，您*无需*更改代码中的任何内容即可正确引用该图像。

仅仅引用图像这似乎有点过头了，但它是 Rails 的众多约定之一，很难使用但很棒！随着您的应用程序的增长和变化，希望它能够更好地经受住时间的考验。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:44:13.947

假设您使用的是 Rails 3.1 或更高版本，并且您正在为您的图像正确使用资产管道，您可以通过执行以下操作来包含您的图像文件：

```
.head {
    background-image: url(/assets/background_image.jpg); 
    width: 100%; 
    height: auto;
} 
```

原因是资产管道的工作方式。它在运行时编译您的资产，并将您的所有资产放在一个名为`/assets/`. 它还忽略了子文件夹结构，它只是将所有内容转储到根`/assets/`文件夹中，而不是`/assets/subfolder/`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T14:32:12.833

**解决方案：**

事实证明这是两件事的结合。我将这种格式用于背景图像：

```
background-image: url(../images/background_image.jpg); 
```

但是， 正在使用 的进行`.head div`渲染。我添加了一个固定的高度来测试，一切都完美地显示出来了。我可以从这里开始工作。`height``0`

非常感谢大家的帮助！！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T03:43:06.370

尝试运行

```
rails -v 
```

从控制台确认您使用的 Rails 版本。

听起来您正在运行 rails 2.x 应用程序，对吗？这应该意味着您正在从 /public 目录提供图像、js 等。一个让我在 CSS 中设置背景图像时遇到的重要问题是，您指定的路径是相对于*样式表*所在的目录（例如 /public/stylesheets），而不是项目本身的根目录。

您是否尝试过更改路径以从样式表所在的目录上移一个目录？

```
.head {
    background-image: url(../images/background_image.jpg); 
    width: 100%; 
    height: auto;
} 
```

编辑：您尝试过哪些其他通往 bg 图像的路径？

其他一些可能性可能是：

```
 background-image: url(images/background_image.jpg); 
  background-image: url('../images/background_image.jpg'); 
```

要检查的另一件事是加载视图并使用检查器 (Ctrl Shift + I) 在 Google Chrome 中检查 div。选择 div 并检查 Chrome 分配给它的样式。

另外，请仔细检查它是否仍然命名为 background_image.jpg 无法告诉你我被我忽略的一些错字烧伤了多少次；）**

# mysql - MySQL - 在 CASE 语句中使用 NOT IN

> ID：11623256
> 
> 赞同：0
> 
> 时间：2012-07-24T02:26:19.277
> 
> 标签：mysql

我想以某种方式在 CASE 语句中使用 NOT IN 术语，但出现语法错误。我想要的是在 T.Segment 列中没有出现某个数字（在本例中为 14）时设置 TribQin=0。

```
SELECT DISTINCT F.JDAY,     
    F.TL6 AS 'OriginalLayer',
    CASE
        WHEN 14 NOT IN T.Segment THEN 0
        ELSE 
                (SELECT T.flow
                FROM trib_data AS T
                WHERE T.JDAY<=F.JDAY AND T.Segment=14 AND T.Year=2000
                ORDER BY T.JDAY DESC LIMIT 1)
    END AS 'TribQin'
FROM FlexGridLayers AS F
INNER JOIN trib_data AS T
ON T.Segment=F.Segment
WHERE F.Year=2000 AND F.Segment=14
ORDER BY F.JDAY; 
```

我得到的错误是：

```
[Err] 1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'T.Segment THEN 0
        ELSE 
                (SELECT T.flow
                FROM trib_data AS T
                ' at line 4 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:56:32.843

您可以尝试以下方法：

```
SELECT DISTINCT k.JDAY,     
    k.TL6 AS 'OriginalLayer',
    CASE
        WHEN k.kid is not null THEN 0
        ELSE 
                (SELECT T.flow
                FROM trib_data AS T
                WHERE T.JDAY<=F.JDAY AND T.Segment=14 AND T.Year=2000
                ORDER BY T.JDAY DESC LIMIT 1)
    END AS 'TribQin'
FROM ( select F.*,F2.id as kid from FlexGridLayers F 
       left outer join FlexGridLayers F2 on F.id=F2.id and F.Segment=14) k
INNER JOIN trib_data AS T
ON T.Segment=k.Segment
WHERE k.Year=2000 AND k.Segment=14
ORDER BY k.JDAY; 
```

查询是连接表本身和段 = 14 的值，这样我们就可以知道值 14 是否确实存在于列中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:32:51.267

用这个：

```
CASE
    WHEN T.Segment != 14 THEN 0
    ELSE ... 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-24T02:31:33.170

在 MySQL 中，如果

```
NOT 
```

不行，试试

```
<> 
```

（小于或大于，即“不”）

# java - 如何让两个始终占据屏幕一半的 JPanel 水平拆分？

> ID：11623260
> 
> 赞同：7
> 
> 时间：2012-07-24T02:26:43.270
> 
> 标签：java, swing, jpanel

如标题中所述。我有两个 JPanel，一个在另一个之上，使用`BorderLayout()`.

```
import java.awt.*;
import javax.swing.*;

public class myForm(){
    public static void main(String[] args) {       
        JFrame myFrame = new JFrame("SingSong");
        myFrame.setLocation(100,100);
        myFrame.setSize(new Dimension(1024,800));
        myFrame.setLayout(new BorderLayout());
        JPanel jp = new JPanel();
        jp.setBackground(new Color(0x00FF00FF));
        JPanel jp2 = new JPanel(new BorderLayout());
        jp2.setBackground(new Color(0x00000000));

        jp.setPreferredSize(new Dimension(100,400));
        jp2.setPreferredSize(new Dimension(100,400));
        jp2.setLocation(0, 512);

        myFrame.add(jp2, BorderLayout.SOUTH);
        myFrame.add(jp, BorderLayout.NORTH);
    }
} 
```

它们每个占一半，但是我该如何设置它，以便它们总是占 JFrame 的一半，即使在调整大小时也是如此？（PS 我通常使用更好的变量名，我只是将其作为 SSCCE 进行了整理）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-24T02:35:58.010

试试`GridLayout`

```
JFrame myFrame = new JFrame("SingSong");
myFrame.setLocation(100, 100);
myFrame.setSize(new Dimension(1024, 800));

GridLayout layout = new GridLayout(2, 1);
myFrame.setLayout(layout);

JPanel jp = new JPanel();
jp.setBackground(new Color(0x00FF00FF));

JPanel jp2 = new JPanel(new BorderLayout());
jp2.setBackground(new Color(0x00000000));

myFrame.add(jp);
myFrame.add(jp2);

myFrame.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T02:43:27.780

当您设置PreferredSize 时，布局管理器将使两个面板的高度始终为400 像素。如果您希望面板始终为框架高度的一半，则不要设置首选尺寸。如果这不起作用，那么您总是可以尝试将面板的高度设置`(myFrame.getSize().height) / 2`为框架高度的一半。

# python - Python数据结构索引从1开始而不是0？

> ID：11623264
> 
> 赞同：11
> 
> 时间：2012-07-24T02:27:15.550
> 
> 标签：python, data-structures

我有一个奇怪的问题：我有这个永远不会改变的 64 个数字的列表：

```
(2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128) 
```

我需要一个 Python 中的数据结构，它允许我使用 1-64 索引而不是标准的 0-63 来访问这些数字。这可能吗？实现这一目标的最佳方法是建立字典吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-24T02:34:40.047

`0`只需在结构的开头插入 a ：

```
(0, 2, 4, 6, 8, ...) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-24T02:36:13.137

您可以覆盖[项目吸气剂](http://docs.python.org/library/operator.html#operator.getitem)并制作一个专门的元组：

```
class BaseOneTuple(tuple):
    __slots__ = () # Space optimization, see: http://stackoverflow.com/questions/472000/python-slots 
    def __new__(cls, *items):
        return tuple.__new__(cls, items) # Creates new instance of tuple
    def __getitem__(self, n):
        return tuple.__getitem__(self, n - 1)

b = BaseOneTuple(*range(2, 129, 2))
b[2] == 4 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-24T02:29:33.157

您可以使用字典，也可以在访问索引之前简单地从索引中减去一个。

另外，我注意到你的 64 个数字是一个简单的算术级数。为什么要存储它们？你可以使用这个：

```
def my_number(i):
    return 2*i 
```

如果您显示的列表实际上是一个示例，并且实数更复杂，则使用具有虚拟第一个元素的列表：

```
my_nums = [0, 2, 4, 6, 8, ....] 
```

然后你可以得到 2 作为`my_nums[1]`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-24T02:30:08.243

您可以使用`range(2, 129, 2)`以 2 为增量生成 1 - 128 范围内的数字，如果它不会更改，则将此列表转换为元组。

```
t = tuple(range(2, 129, 2))

def numbers(n):
   return t[n-1] 
```

给定全局元组`t`，函数`numbers`可以使用基于 1（而不是基于 0）的索引检索元素。

# android - 相机参数.setFocusMode 不起作用

> ID：11623266
> 
> 赞同：7
> 
> 时间：2012-07-24T02:27:19.630
> 
> 标签：android, android-camera, autofocus

我正在尝试将相机自动对焦设置为 ON ...但是每当我设置`setFocusMode`应用程序崩溃时..

```
java.lang.RuntimeException: setParameters failed 
```

我的代码是：

```
Camera.Parameters parameters = camera.getParameters();
parameters.setFlashMode(Parameters.FLASH_MODE_TORCH);
Camera.Size size = getBestPreviewSize(width, height, parameters);
Camera.Size pictureSize = getSmallestPictureSize(parameters);

if (size != null && pictureSize != null) {
    parameters.setFocusMode(Camera.Parameters.FOCUS_MODE_CONTINUOUS_VIDEO);
    parameters.setPreviewSize(size.width, size.height);
    parameters.setPictureSize(pictureSize.width, pictureSize.height);
    parameters.setPictureFormat(ImageFormat.JPEG);
    camera.setParameters(parameters);
    cameraConfigured = true;
} 
```

为什么会出现这个错误？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-30T05:59:32.587

您需要验证相机是否支持您想要的 FOCUS MODE。

这样做：

```
Camera.Parameters parameters = camera.getParameters();
List<String> focusModes = parameters.getSupportedFocusModes();
if (focusModes.contains(Parameters.FOCUS_MODE_CONTINUOUS_VIDEO))
    parameters.setFocusMode(Parameters.FOCUS_MODE_CONTINUOUS_VIDEO);
camera.setParameters(parameters); 
```

# regex - nginx 将除白名单外的所有内容都重写为 index.php

> ID：11623267
> 
> 赞同：6
> 
> 时间：2012-07-24T02:27:20.930
> 
> 标签：regex, .htaccess, codeigniter, nginx, rewrite

首先，我试图搜索类似的问题，但这些问题的解决方案是特定的代码行，我无法根据自己的需要进行定制。

我有一个 Codeigniter 安装，我正在尝试从 Apache 迁移到 nginx。然而，在 Apache 中 .htaccess 非常简单：它需要一个白名单，并将其他所有内容重写为`index.php`.

```
RewriteEngine on
RewriteCond $1 !^(index\.php|css|images|core|uploads|js|robots\.txt|favicon\.ico)
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

但是在 nginx 中，我尝试了 if 和 try_files 指令，以及弄乱位置，但无济于事。我对 nginx 如何读取服务器配置仍然很陌生，并且在线教程有些令人困惑。

**此外**，index.php 将不在 Web 根目录中，而是在子目录`server`中。

因此，我还需要确保即使以 /server 开头的 URI 请求也不会转到目录，而是`index.php`

到目前为止，这是我的 nginx 虚拟主机配置：

```
server {
    listen 80;
    server_name example.com;

    root /home/example/public_html;

    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    location / {
        index index.htm index.html index.php;
    }

    location ~ \.php$ {
        fastcgi_pass        unix:/var/run/php-fpm/example.sock;
        include             fastcgi_params;
        fastcgi_param       PATH_INFO $fastcgi_script_name;
        fastcgi_param       SCRIPT_FILENAME $document_root$fastcgi_script_name;

    }

    location ~* ^.*(/|\..*) { 
        try_files $uri $uri/ /server/index.php;
    }

    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/html;
    }
} 
```

这有助于将请求重定向到`index.php`，但没有白名单。如果有人能生成一个工作示例并简要说明每个部分的作用，我将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-24T06:18:39.627

我会使用[$uri](http://wiki.nginx.org/HttpCoreModule#.24uri)变量和[if](http://wiki.nginx.org/HttpRewriteModule#if)在一个`location`块中来实现这一点。

```
location / {
    if ( $uri !~ ^/(index\.php|css|images|core|uploads|js|robots\.txt|favicon\.ico) ) {
        rewrite ^ /server/index.php last;
    }
} 
```

此外，对于[pathinfo 安全问题](http://flexichat.net/nginx-phpfcgi-easy-hacking/)，（[讨论](http://forum.nginx.org/read.php?2,88845,page=3)）添加

```
try_files $uri =403;
fastcgi_split_path_info ^(.+.php)(.*)$; 
```

到`location ~ \.php$`块。

# google-app-engine - Datanucleus Rest API 示例

> ID：11623268
> 
> 赞同：1
> 
> 时间：2012-07-24T02:27:23.530
> 
> 标签：google-app-engine, maven, datanucleus

大约一个月前，我尝试在我的 Appengine Web 应用程序之上实现 Datanucleus Rest API，但是我遇到了很多问题，尤其是在具体包含哪些依赖项方面。我与放在`POM`.

*   所以我的问题是，是否有任何使用 Datanucleus Rest API 的示例 Web 应用程序，以便 POM 中存在所有正确的依赖项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:44:09.283

这是我正在使用的 maven 插件： [maven-gae-plugin](https://github.com/maven-gae-plugin/maven-gae-plugin)

有一些有趣的模板可以从那里开始！如果您需要帮助，我从去年开始就在努力！

# c# - 将字符（或字符串）转换为它的键值

> ID：11623271
> 
> 赞同：0
> 
> 时间：2012-07-24T02:27:44.057
> 
> 标签：c#, key, keycode

我不确定“键值”是否正确，因为我相信很少有格式，我所说的是[http://pastebin.com/XJVx1dB5](http://pastebin.com/XJVx1dB5)这是 88 为 Z 等的格式。我希望我很清楚.

我尝试了很多东西，但是从键转换器类的字符串函数转换是唯一一个远程关闭的。问题是，它按照我的意愿将“x”转换为 88，但是它无法转换“”或“[”，因为它需要“SPACE”（字符串）而不是单个空格作为我相信的 char。

我这样使用它，也许还有另一个（正确的？）使用它的版本：

```
((int)kc.ConvertFromString(s)) 
```

所以我想做的是让我的那些字符编码。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T02:36:28.493

如果你仔细检查你的*枚举键*，你会发现`[`.

事实上，那个字符（在我的键盘上）被报告为 Oem4。

此代码有效：

```
var c = kc.ConvertFromString("Oem4"); 
```

然而，

```
var c = kc.ConvertFromString("["); 
```

无法工作，因为`[`它不是您要转换的枚举的有效成员。

转换字符串后你想做什么？这可能有助于指导更好地回答您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:32:41.913

尝试类似：

```
 var stringValue = " ";
 var intValue = (int)stringValue[0]; 
```

字符串是一个“字符数组” - 所以你需要做的是获取 char [在这种情况下是第一个] - 并将其转换为 int - 在这种情况下只需通过强制转换。

如果你想用枚举来做，那么你将不得不编写一个手动系统来将 "" 转换为 Keys.Space 。

# html - 将导航栏颜色与背景颜色混合（渐变？）

> ID：11623276
> 
> 赞同：0
> 
> 时间：2012-07-24T02:28:06.533
> 
> 标签：html, css, navigation

我有一个导航栏，它比我的背景颜色稍暗。我想要一个从中心到左右两侧的渐变，以便导航栏的最右边和最左边的位达到背景颜色。这可能吗？

```
<body>
<div id="container">
    <div id="header">
        <h1>
            <!--<a href="#"><img src="tracylogo7.jpg" alt="Millington and Hope" /></a> -->
            <a href="#"><img src="tracylogo5_header.jpg" alt="Millington and Hope" /></a>
        </h1>
        <h2>
            <!--<a href="#"><img src="tracylogo5_header.jpg" alt="Millington and Hope" /></a> -->
        </h2>   
    </div>
    <ul id="nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="stock.html">Stock</a></li>
        <li><a href="events.html">Events</a></li>
        <li><a href="contact.html">Contact</a></li>
    </ul>
    <div id="box">
            <a href="#"><img src="home1.jpg" alt="Slideshow Image 1" /></a>

            <a href="#"><img src="home3.jpg" alt="Slideshow Image 2" /></a>

            <a href="#"><img src="home2.jpg" alt="Slideshow Image 3" /></a>
    </div>
    <div id="footer">
        <p class="client">Tel: 0788740&nbsp;&nbsp;&nbsp;&nbsp;E-mail: tjdelane@hotmail.co.uk</p>

    </div>
</div>      
</body>

#nav
{
  border:1px solid #ccc;
  border-width:1px 0;
  list-style:none;
  margin:0;
  padding:0;
  text-align:center; 
  background:rgb(161,153,134)
  background: #999; /* for non-css3 browsers */

    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='(#A19986', endColorstr='#ABA390'); /* for IE */
    background: -webkit-gradient(linear, left top, left bottom, from(#A19986), to(#ABA390)); /* for webkit browsers */
    background: -moz-linear-gradient(top,  #ccc,  #000); /* for firefox 3.6+ */ 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:32:54.953

是的。CSS 可以做不同程度的跨浏览器成功的渐变（包括线性、径向和颜色停止）。试试这个生成器来构建一些东西： http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

# ruby-on-rails - 在我的错误视图中，我不断收到“nil:NilClass 的未定义方法‘每个’”。谁能告诉我为什么？

> ID：11623282
> 
> 赞同：1
> 
> 时间：2012-07-24T02:29:37.820
> 
> 标签：ruby-on-rails

所以我试图从 Amistad 为我的友谊模型设置一个视图，但我不断收到这个错误：“undefined method `each' for nil:NilClass”

这是我的友谊.rb 模型

```
class Friendship < ActiveRecord::Base
  include Amistad::FriendshipModel

    attr_accessible :user_id, :friend_id
end 
```

这是我的friendships_controller.rb

```
class FriendshipsController < ApplicationController
  before_filter :authenticate_user!

  def index
    @friends = current_user.friends
    @pending_invited_by = current_user.pending_invited_by
    @pending_invited = current_user.pending_invited
  end

  def create
    @Friend = User.find(params[:user_id])
    @friendship_created = current_user.invite(@Friend)
  end

  def approve
    @Friend = User.find(params[:user_id])
    @friendship_approved = current_user.approve(@Friend)
    @friends = current_user.friends
    @pending_invited_by = current_user.pending_invited_by
  end

  def remove
    @Friend = User.find(params[:user_id])
    @friendship = current_user.send(:find_any_friendship_with, @Friend)
    if @friendship
      @friendship.delete
      @removed = true
    end
   end
  end 
```

我的用户模型 user.rb

```
class User < ActiveRecord::Base
  mount_uploader :avatar, AvatarUploader
  has_many :cereals, dependent: :destroy

  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable, :authentication_keys => [:login]
  include Amistad::FriendModel

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me, :username, :login, :avatar, :avatar_cache, :remove_avatar, :firstname, :lastname, :phone, :urlname
  # attr_accessible :title, :body

  attr_accessor :login

  def self.find_first_by_auth_conditions(warden_conditions)
      conditions = warden_conditions.dup
      if login = conditions.delete(:login)
        where(conditions).where(["lower(username) = :value OR lower(email) = :value", { :value => login.downcase }]).first
      else
        where(conditions).first
      end
    end

            def update_with_password(params={})
        current_password = params.delete(:current_password)

        if params[:password].blank?
          params.delete(:password)
          params.delete(:password_confirmation) if params[:password_confirmation].blank?
        end

                result = if params[:password].blank? || valid_password?(current_password) 
          update_attributes(params)
        else
          self.attributes = params
          self.valid?
          self.errors.add(:current_password, current_password.blank? ? :blank : :invalid)
          false
        end

        clean_up_passwords
        result
      end
    end 
```

和 users_controller.rb

```
class UsersController < ApplicationController
    def show
      if params[:id].nil? && current_user
        @user = current_user
      else
        @user = User.find(params[:id])
      end
      @cereal = current_user.cereals.build if signed_in?
      @cereals = @user.cereals.paginate(page: params[:page])
  end

  def first_time
      if params[:id].nil? && current_user
        @user = current_user
      else
        @user = User.find(params[:id])
      end
  end

    def edit
        if params[:id].nil? && current_user
            @user = current_user
        else
            @user = User.find(params[:id])
        end
  end

    def profile
        @username = params[:id]
        @title = "User Profile for #{@username}"
        @user = User.find_by_username(@username)
        @users = User.all :conditions => ["id != ?", current_user.id]
  end 

end 
```

有人知道发生了什么吗？我还是 Rails 的新手，可以使用一些见解。

风景：

```
.row
    #dashboard.span12
        = @user.username
        #profile_pic=link_to image_tag(@user.avatar, border: '0'), action: 'profile', controller: 'users'
    #bowl_outline.span9
        Bowl

    #friends.span3
        Friends
        %ul
        - for @user in @friends
            %li
                - if current_user.friend_with? user
                    = user.username
                    |
                    You are already friends!
                - elsif current_user.invited? user
                    = user.username
                    | 
                    Pending request ...
                - elsif user.invited? current_user
                    = user.username
                    |
                    = link_to "Confirm friend?", friend_path(user), :method => "put"
                - else
                    = user.username
                    = link_to "Add friend?", friends_path(:user_id => @user), :method => "post" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:38:17.527

你不应该有一个实例变量作为你的 for 循环变量。

```
for user in @friends 
```

我相信`@friends = current_user.friends`返回一个数组，所以它应该与这个修复一起工作。

编辑

如果这是循环在您的用户/配置文件视图中，您需要`@friends`在用户控制器的配置文件操作中定义。

```
def profile
    @username = params[:id]
    @friends = current_user.friends
    @title = "User Profile for #{@username}"
    @user = User.find_by_username(@username)
    @users = User.all :conditions => ["id != ?", current_user.id]
end 
```

并添加`before_filter :authenticate_user!`到您的`UsersController`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:44:16.320

在 ruby​​ 中，通常会看到`for user in @friends`要编写的行：

`@friends.each do |user|`

在此配置中，我们将每个消息传递给存储在 @friends 中的对象，该对象可能为 nil 并引发错误。

确保`@friends = current_user.friends`在你`FriendshipsController`没有返回`nil`（你不能迭代它）。

如果您正在接收`nil`，请通过将行更改为以下内容来添加默认值：`@friends = current_user.friends || []`

# java - Android Google Maps API，防止在屏幕方向更改时重新加载/重绘地图

> ID：11623287
> 
> 赞同：1
> 
> 时间：2012-07-24T02:30:03.733
> 
> 标签：java, android, google-maps-api-2

在我的应用程序中，当您在 mapView 中倾斜设备时，它会重绘所有标记。我不想让这种情况发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T11:26:37.533

为了避免在我在清单中添加的屏幕方向更改时重新加载地图，在活动标记中此行：

```
android:configChanges="orientation" 
```

我不知道这是否是最好的解决方案，但它有效

# objective-c - 将 URL 协议捕获到未安装的应用程序

> ID：11623289
> 
> 赞同：2
> 
> 时间：2012-07-24T02:30:20.070
> 
> 标签：objective-c, ios

我正在尝试创建一个链接到我在 iOS 中的 Twitter 个人资料的 URL 协议。但如果用户没有安装 Twitter 应用程序，我希望它回退到 Safari。我该怎么做？这是我现在使用的代码：

```
NSString *stringURL = @"twitter://user?screen_name=ecnepsnai";
NSURL *url = [NSURL URLWithString:stringURL];
[[UIApplication sharedApplication] openURL:url]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T02:33:51.753

我相信您可以测试是否可以使用以下方法处理“twitter://”URL：

```
if ([[UIApplication sharedApplication] canOpenURL:url]) {
    [[UIApplication sharedApplication] openURL:url];
} else {
    // fallback
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T02:34:04.107

你可以使用的`-canOpenURL:`方法`UIApplication`。

```
NSString *stringURL = @"twitter://user?screen_name=ecnepsnai";
NSURL *url = [NSURL URLWithString:stringURL];

if ([[UIApplication sharedApplication] canOpenURL:url]) {
    [[UIApplication sharedApplication] openURL:url];
} else {
    // Do something else
} 
```

# json - 在 Alfresco 4.0 中启用 json 回调

> ID：11623293
> 
> 赞同：3
> 
> 时间：2012-07-24T02:31:30.817
> 
> 标签：json, jsonp, alfresco

你好，我在这里有点卡。

我正在尝试按照这些指令在 Alfresco 4.0.b 上激活 json 回调（jsonp）。 [http://wiki.alfresco.com/wiki/Web_Scripts#JSON_Callbacks](http://wiki.alfresco.com/wiki/Web_Scripts#JSON_Callbacks)

如果我正确理解为 webscripts 激活此功能，我需要修改此文件 /Alfresco/tomcat/webapps/alfresco/WEB-INF/classes/alfresco/web-scripts-application-context.xml 并将属性添加 `<property name="allowCallbacks"><value>true</value></property>` 到任何bean 定义我想要 json 回调。

现在从我到处读到的内容来看，你永远不应该修改 alfresco.war 或 share.war 中的文件。所以这是我的问题：

我将如何在露天战争之外修改这个文件？

我尝试将文件复制到 /Alfresco/tomcat/shared/classes/alfresco/web-scripts-application-context.xml 并将属性添加到 webscripts.container bean 和 webscripts.authenticator.basic bean 但我的脚本和当我使用 alf_callback=my_function 时，基本身份验证脚本没有返回包装在 my_function 中的结果

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T11:50:06.113

仅将自定义副本放入其中`shared/classes/alfresco`是行不通的，因为 bean 仍然从`alfresco/WEB-INFO/classes/alfresco`.

尝试将您的自定义设置在`shared/classes/alfresco/extension/whatever-context.xml`.

导入的顺序在`alfresco/WEB-INF/classes/alfresco/application-context.xml`- 最后一个定义覆盖和“获胜”中定义。

# android - 使用 Flex 4 应用程序锁定手机

> ID：11623296
> 
> 赞同：0
> 
> 时间：2012-07-24T02:31:33.523
> 
> 标签：android, ios, actionscript-3, flex4

目前我正在使用 Flex 4 和动作脚本 3 开发基于移动的应用程序。通常要锁定 android 手机，我们需要按下锁定按钮，但我想通过应用程序锁定 android 手机。

有没有可用的API？我需要通过运行使用 Flex 4 和动作脚本 3 创建的应用程序来锁定手机。请给我一些想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T08:07:31.147

使用 Flex 4 并不困难。更好的是，您可以尝试使用本机 android 应用程序。有一些选项可用，例如

```
KeyguardManager mgr = (KeyguardManager)getSystemService(Activity.KEYGUARD_SERVICE); 
KeyguardLock lock = mgr.newKeyguardLock(KEYGUARD_SERVICE); 
lock.reenableKeyguard(); 
```

另一种方法是`android.os.PowerManager`

```
PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, "My Tag");
wl.acquire();
//and use 
wl.release(); 
```

关于您的详细说明`PowerManager`可以从[这里](http://developer.android.com/reference/android/os/PowerManager.WakeLock.html)找到。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-24T04:34:42.040

我不确定是否仍然可以使用 Android 以编程方式锁定设备，但您可以关注此[SO 讨论](https://stackoverflow.com/questions/4793339/lock-an-android-phone)以获取最新信息。

AIR 不提供用于锁定移动设备的 API，因为这种功能并非在所有移动/桌面平台上都普遍可用。AIR 的设计理念是保持其默认的 SDK 功能可用于所有平台，因此开发人员不必考虑平台的差异。

最新的 AIR 提供了通过本[机扩展](http://www.adobe.com/devnet/air/articles/extending-air.html)(ANE) 扩展特定于平台的功能的方法。您可以在许多站点（例如[这个](http://extensionsforair.com/)站点）上检查各种扩展。

也就是说，如果 Android 本身提供锁定功能，那么您就很幸运了。即使这样的 ANE 不可用，我相信您也可以轻松开发出一个。

# xml - 在 invoke-webrequest 期间在 powershell 上强制使用 UTF-8

> ID：11623298
> 
> 赞同：0
> 
> 时间：2012-07-24T02:31:38.933
> 
> 标签：xml, powershell, encoding

我正在尝试使用“invoke-webrequest”CMDLET 来调用 Web 服务。我成功地将它与 apache tomcat 提供的 WSDL 一起使用，但是当我对 glassfish 2 使用它时，我得到：

---Invoke-WebRequest : '"utf-8"' 不是受支持的编码名称。---

我的请求在 SOAP UI 中工作得很好，但是使用 SOAP UI 我意识到 Glassfish V2 正在使用双引号设置 UTF-8 编码（请参阅上面的错误并为您提供线索）。Apache Tomcat 做得很好，它给了我没有双引号的编码。

你如何处理这个问题？有什么方法可以动态删除这些双引号，或者在 CMDLET 调用期间完全替换编码？我可以在文档中找到对此的任何参考。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T05:08:21.923

`Invoke-WebRequest`只是为您设置一个普通的旧 HTTP 标头/正文请求。您确定您正在使用所有正确的 XML 命名空间等创建带有标题和正文的正确信封吗？我并不是说您不能这样做，但总的来说，使用`New-WebServiceProxy`针对服务的 WSDL 创建代理可能更容易。

如果您仍然想这样做，只需传入一个包含您要使用的所有标题的哈希表，包括设置字符集的标题，例如：

```
Invoke-WebRequest ... -Headers @{Host = 'www.xxxx.xxx';
                                 Content-Type = 'application/soap+xml; charset=utf-8';
                                 Content-Length = <length>;
                                 SOAPAction = 'http://www.w3.org/2003/05/soap-envelope;
                                 ...} 
```

# performance - 在 chrome 开发者工具 TimeLine 记录中重新计算布局绘制是什么意思？

> ID：11623299
> 
> 赞同：9
> 
> 时间：2012-07-24T02:31:55.967
> 
> 标签：performance, google-chrome-devtools

![在此处输入图像描述](../Images/691deef16aa3597f32191b171ee26dd8.png)

在 chrome 开发者工具 TimeLine 记录中重新计算布局绘制是什么意思？以及如何通过减少页面重新计算、布局和绘制的计数来提高页面性能？可以给点建议吗？谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-24T03:03:20.320

基本上，它们是您的浏览器，用于确定如何绘制您对页面所做的更改。

不要担心摆脱它们——如果你这样做了，你的网站将是静态的。但是... ...如果您想做一些对**性能**有用的事情，这确实与重排和重绘有关，那么将您的更改一起批处理。

假设你在 Twitter 找到了一份工作。你的工作是编写下一个版本的窗口，将每个 Twitter 帖子添加到屏幕上。

如果用户在他们的时间线中收到 250 条新推文，并且您在一个循环中添加每一条，一个接一个，浏览器将会变慢，因为每次添加一条，它都必须重新排列（移动为您添加的内容腾出空间）并重新绘制（样式化受添加影响的所有内容）。

一个更好的方法是在非 DOM 中构建新推文列表（即：使用当前实际上不在页面上的元素），然后一次添加它们。这减少了浏览器必须弄清楚一切需要去哪里的次数。

@Fabricio - 微优化可能不是很好，但是在一个循环中附加数百个浏览器元素，而不是同时将它们全部放入可以产生很大的不同。问问 Twitter 的人，他们不会费心缓存他们的 jQuery 对象。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-15T05:41:36.123

这是触发页面布局（重排）的属性和方法的非常方便的列表：

[http://gent.ilcore.com/2011/03/how-not-to-trigger-layout-in-webkit.html](http://gent.ilcore.com/2011/03/how-not-to-trigger-layout-in-webkit.html)

您希望尽可能减少这些调用——尤其是在性能至关重要的情况下，例如在滚动事件期间，或在为大块内容设置动画时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T03:01:16.693

您可以使用“配置文件”选项卡和“审核”选项卡来检测代码的性能。这将为您提供有关您的代码的报告。

您可以通过多种方式减少页面重新计算、布局和绘制的计数。

*   一次添加多个孩子。
*   在更改元素之前隐藏元素。
*   给图像和其他元素高度和宽度。

# jquery - 使用 jquery 堆叠照片投掷效果

> ID：11623301
> 
> 赞同：0
> 
> 时间：2012-07-24T02:32:17.620
> 
> 标签：jquery

我想实现堆栈照片图像库，例如手动抛出的照片。

像这样：[http ://www.youtube.com/watch?v=FlohNb8rnR8](http://www.youtube.com/watch?v=FlohNb8rnR8)

我尝试使用 jquery animate 和 drop 效果，但它看起来并不相似。知道如何实施吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:41:33.403

I highly recommend using [greensock](http://www.greensock.com/v12/) for animation over jquery's animate. Greensock has a lot of nice easing options to get nice smooth motion with controllable easing.

Check out the [speed test](http://www.greensock.com/js/speed.html) comparing different JS engines.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T02:43:28.707

您需要将所有图像绝对定位并离开屏幕，然后一次一张地将它们的位置随机动画到屏幕上的某个位置，每个图像的 z-index 都高于前一个图像。

使用 jQuery 的回调函数，您可以顺利地让每个回调函数一个接一个地出现。您需要提出一些有限制的 math.random 逻辑（可能在窗口高度/宽度等方面）。但基本上这个想法有点像这样。

```
var zindex = 100;

$('img').each(function () {
    $(this).css('z-index', zindex++)
           .animate({ top: _yVariable, left: _xVariable }, _timeVariable, function () {
       return; //restart loop once this animations finished
    });     
}); 
```

# php - 在 CodeIgniter 中扩展异常

> ID：11623302
> 
> 赞同：0
> 
> 时间：2012-07-24T02:32:22.727
> 
> 标签：php, codeigniter

我收到错误 Fatal error: Class 'CI_Controller' not found in ....\core\CodeIgniter.php on line 233

我在 application/core/My_Exception.php 中创建了一个名为 My_Exceptions 的类 基本上，我想在用户从我的站点收到错误时收到电子邮件。

```
<?php
class My_Exceptions extends CI_Exceptions{
    var $CI="";
    function __construct(){
        parent::__construct();
        $this->CI =& get_instance();
    }
    function show_404($page = '', $log_error = TRUE)
{
    $heading = "404 Page My Not Found";
    $message = "The page you requested was not found.";

    // By default we log this, but allow a dev to skip it
    if ($log_error)
    {
        log_message('error', '404 Page Not Found --> '.$page);
    }

    //Email to Developer
    $this->CI->load->library('email');
    $uri = $this->CI->uri->uri_string();  
    $this->CI->email->from('error-donotreply@YOURAPP.com', 'APP Error');
    $this->CI->email->to('youremail@example.org');
    $this->CI->email->subject('APP Error [severity: '.$severity.']');
    $this->CI->email->message("Page not Found. From URL: ".$uri);
    $this->CI->email->send();

    echo $this->show_error($heading, $message, 'error_404', 404);
    exit;
}
} 
```

请帮忙 ！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T07:18:56.383

我知道您已经接受了答案，但另一种方法是扩展 CI 日志类。

```
<?php  if (!defined('BASEPATH')) exit('No direct script access allowed');
/**
 * MY_Log Class
 *
 * This library extends the native Log library.
 * It adds the function to have the log messages being emailed when they have been outputted to the log file.
 *
 * @package     CodeIgniter
 * @subpackage      Libraries
 * @category        Logging
 * @author      Johan Steen
 * @link        http://wpstorm.net/
 */
class MY_Log extends CI_Log {
    private $_reporting_email = 'test@me.com';
    private $_subject = 'CI Logger';

    /**
     * Constructor
     *
     * @access  public
     */
    function __construct() {
        parent::__construct();
    }

    /**
     * Write Log File
     *
     * Calls the native write_log() method and then sends an email if a log message was generated.
     *
     * @access  public
     * @param   string  the error level
     * @param   string  the error message
     * @param   bool    whether the error is a native PHP error
     * @return  bool
     */
    function write_log($level = 'error', $msg, $php_error = FALSE) {
        $result = parent::write_log($level, $msg, $php_error);

        if ($result == TRUE && strtoupper($level) == 'ERROR') {
            $message = "An error occurred: \n\n";
            $message .= $level.' - '.date($this->_date_fmt). ' --> '.$msg."\n";

            $to = $this->_reporting_email;
            $subject = $this->_subject;
            $headers = 'From: Example Name <no-reply@example.com>' . "\r\n";
            $headers .= 'Content-type: text/plain; charset=utf-8\r\n';

            mail($to, $subject, $message, $headers);
        }
        return $result;
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T03:18:50.963

Exceptions 类在主 CI_Controller 之前加载。

这意味着当发生错误时 - 您不能使用 CI 发送电子邮件，因为“$this->CI”不存在。

您的选择是使用本机 PHP 发送电子邮件，或者我做什么；自动将前一天的错误日志通过电子邮件发送给自己（使用 CRON 作业）。这样您就可以每天检查一次所有错误。

# python - 加快 API 响应时间

> ID：11623303
> 
> 赞同：3
> 
> 时间：2012-07-24T02:32:23.920
> 
> 标签：python, performance, api, cassandra

我希望减少 Web 服务器为给定查询从 API 服务器请求/接收数据的完整时间。

假设 MySQL 为瓶颈，我将 API 服务器数据库更新为 Cassandra，但完成时间仍然保持不变。可能是其他东西是我无法弄清楚的瓶颈。

**环境：**

```
Number of Request Estimated per minute: 100
Database: MySQl / Cassandra
Hardware: EC2 Small
Server Used: Apache HTTP 
```

**当前观察：**

```
Cassandra Query Response Time: .03 Secs 
Time between request made and response received: 4 Secs 
```

**必需的：**

```
Time between request made and response received: 1 Secs 
```

**底线：我们如何才能减少在这个给定案例中所花费的完整时间？**

*如果需要，请随时询问更多详细信息。谢谢*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T08:38:07.177

聊天总结：

*   环境：
    *   在小型 Amazon EC2 实例上运行（1 个虚拟 CPU，1.7GB RAM）
    *   Web 服务器是 Apache
    *   100 个工作线程
    *   Python 正在使用 Pylons（这意味着 WSGI）
    *   EC2 中的测试客户端
*   测试：
    *   1.8k 请求，单线程
        *   未知的 CPU 成本
        *   Cassandra请求时间：0.079s（传播0.048->0.759）
        *   MySQL请求时间：0.169s（传播0.047->1.52）
    *   10k 个请求，多个线程
        *   CPU 以 90% 运行
        *   Cassandra请求时间：2.285s（传播0.102->6.321）
        *   MySQL请求时间：7.879s（传播0.831->14.065）

**观察**：在您的小型 EC2 实例上，100 个线程可能**太多了。**请记住，每个线程都会产生一个占用内存和资源的 Python 进程——即使什么都不做。减少线程减少：

*   内存争用（和内存分页*会降低*性能）
*   CPU 缓冲区未命中
*   CPU 争用
*   数据库争用

**建议**：您的目标应该是只运行尽可能多的线程以最大限度地利用 CPU（但如果它们最大限度地利用内存或其他资源，则更少）。运行更多线程会增加开销并降低吞吐量。

**观察**：您在单线程模式下的最佳性能时间给出了每个请求可能的最佳情况成本 0.05 CPU 秒。假设有一些延迟（等待 IO），您的 CPU 成本可能会低很多）。假设 CPU 是您的架构中的瓶颈，您可能能够在 EC2 服务器上每秒处理 20-40 个事务，只需进行线程调整。

**建议**：使用标准的 Python 分析器来分析系统（在以最佳线程数运行时）。分析器将指示 CPU 花费最多时间的位置。区分等待（即数据库返回、磁盘读取或写入数据）与代码固有的 CPU 成本。

*   固有 CPU 成本高的地方：您能降低成本吗？如果这不在您的代码中，您可以通过做一些不同的事情来避免该代码路径吗？缓存？使用另一个库？
*   存在延迟的地方：鉴于您的单线程结果，**假设**CPU 可以服务另一个请求，延迟不一定很糟糕。事实上，您可以通过计算来大致了解您需要的线程数：（总时间/（总时间 - 等待时间））但是，检查一下，当 Python 等待时，数据库（例如）不是t努力工作以返回结果。

**其他想法**：考虑测试工具如何传递 HTTP 请求 - 它是否尽可能快地完成（例如尝试同时打开 10k TCP 套接字？）如果是这样，这可能会扭曲您的结果。使用不同的加载模式和工具可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T06:23:57.317

Cassandra 在高负载下工作得更快，在世界不同地区的两个系统上的平均时间为 3 - 4 秒是可以的。

# gwt - 如何在滚动（在 GWT 中）后修复 div（或面板...）？

> ID：11623305
> 
> 赞同：0
> 
> 时间：2012-07-24T02:32:42.173
> 
> 标签：gwt, panel

我正在尝试实现这个效果： http: [//massless.org/pegs/](http://massless.org/pegs/) 您可以看到滚动后，左侧导航栏固定在页面顶部。

我怎样才能用 GWT 达到这样的效果？

问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T11:53:04.097

根据我的经验，实际上有两种方法可以做到这一点。两者都基于 GWT 最终实际上只是 Javascript 的知识。

1.  由于这是一种效果，与功能无关，因此您可以将其连接到外部 js 文件中，然后按原样使用 Pegs。

2.  复制 GWT 中的功能。

    一个。(Widget).getElement().getStyle().setTop("33px");

    湾。[http://code.google.com/p/gwtquery/](http://code.google.com/p/gwtquery/) = 使用这个模块，只需内省 Pegs 扩展。

您不必接触 JSNI（这很好）。

如果可能的话，我个人会选择第一个。选项二基于窗口滚动，根据具体情况，这可能会变得非常非常慢。

# c# - 从一个数据表中删除重复项

> ID：11623306
> 
> 赞同：0
> 
> 时间：2012-07-24T02:32:50.100
> 
> 标签：c#, datatable

任何人都可以帮助我的代码我正在尝试从 freeTechslist 数据表中删除重复的项目，如果相同的项目包含在分配的技术列表数据表中

```
DataTable freeTechslist = user.GetAllUsers();
DataTable assignedtechsList  = Task.GetAllAssignedUserToTask(taskID);

foreach(DataRow row1 in freeTechslist.Rows)
{
    foreach(DataRow row2 in assignedtechsList.Rows)
    {
        var arr1 = row1.ItemArray;
        var arr2 = row2.ItemArray;
        if (arr2.SequenceEqual(arr1))
        {
            int num =  arr1.Count();
            freeTechslist.Rows[num].Delete();       
        }
    }
}

return freeTechslist; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:22:40.010

我使用 LinqPad 编写了一个小程序来帮助解释 Linq 在做什么。的实施`GetAllUsers`和`GetAllAssignedUserToTask`不重要的解释目的；我刚刚创建了示例函数来返回您在代码中使用的 DataTables。我还修改了代码以使用 Guids 作为技术人员的标识符。

```
void Main()
{
    var allTechs = GetAllUsers();   
    var freeTechsList = 
            //Start the Linq query by selecting all the available techs.
            //Since GetAllUsers returns a DataTable, we use AsEnumerable
            //to convert the DataTable to a queryable object
            from tech in allTechs.AsEnumerable()
            //Now we add a where clause to the Linq query.  Essentially 
            //what this clause does is just remove every tech that is in
            //the assigned techs list (which is returned by GetAllAssignedUserToTask)
            where 
            !(
                //This is our subquery; all this does is give us a list of Guids
                //that identifies techs that are assigned.  Again, GetAllAssignedUserToTask
                //returns a DataTable, so we use AsEnumerable to make it queryable with Linq
                from assigned in GetAllAssignedUserToTask(allTechs).AsEnumerable()
                select assigned.Field<Guid>("TechGUID")
            //The above subquery has returned us a list of assigned techs, so we check if 
            //the current tech we're looking at from GetAllUsers is in that list using 
            //the Contains method.  Contains will tell us whether the current tech is in the 
            //list of assigned techs.  Since we negate the result above (using !), that means
            //that if the tech is in this list, he will not be included in the final result.
            ).Contains(tech.Field<Guid>("TechGUID"))
            //Finally, we return the selected techs that have been filtered by our where clause
            select tech; 

    //Dump is basically just LinqPad's version of print so we can see the result.           
    freeTechsList.Dump();
}

// Define other methods and classes here
DataTable GetAllUsers()
{
    //create a datatable
    var dt = new DataTable();
    dt.Columns.Add(new DataColumn() {DataType = typeof(Guid), ColumnName = "TechGUID"});
    dt.Columns.Add(new DataColumn() {DataType = typeof(String), ColumnName = "Name"});

    //add some data
    DataRow bob = dt.NewRow();
    bob["Name"] = "Bob";
    bob["TechGUID"] = Guid.NewGuid();
    dt.Rows.Add(bob);

    DataRow phil = dt.NewRow();
    phil["Name"] = "Phil";
    phil["TechGUID"] = Guid.NewGuid();  
    dt.Rows.Add(phil);

    DataRow joe = dt.NewRow();
    joe["Name"] = "Joe";
    joe["TechGUID"] = Guid.NewGuid();   
    dt.Rows.Add(joe);

    return dt;

}

DataTable GetAllAssignedUserToTask(DataTable allUsers)
{
    //simulate Joe as our only assigned Tech
    return allUsers.AsEnumerable()
                   .Where(tech => tech.Field<String>("Name") == "Joe")
                   .CopyToDataTable();
} 
```

# php - 使用 PEAR 邮件发送测试消息时出现错误消息

> ID：11623310
> 
> 赞同：0
> 
> 时间：2012-07-24T02:33:04.203
> 
> 标签：php, email, pear, mime

[我已经安装了最新版本的 PEAR Mail 和 Mail_Mime，我正在尝试使用此页面](http://www.phpmaniac.net/wiki/index.php/Pear_Mail)中的以下测试电子邮件发送测试消息，即

```
<?
        include('/home/****/php/Mail.php');
        include('/home/****/php/Mail/mime.php');

        // Constructing the email
        $sender = "**** <info@****.com>";                              // Your name and email address
        $recipient = "**** <****@gmail.com>";                           // The Recipients name and email address
        $subject = "Test Email";                                            // Subject for the email
        $text = 'This is a text message.';                                  // Text version of the email
        $html = '<html><body><p>This is a html message</p></body></html>';  // HTML version of the email
        $crlf = "\n";
        $headers = array(
                        'From'          => $sender,
                        'Return-Path'   => $sender,
                        'Subject'       => $subject
                        );

        // Creating the Mime message
        $mime = new Mail_mime($crlf);

        // Setting the body of the email
        $mime->setTXTBody($text);
        $mime->setHTMLBody($html);

        $body = $mime->get();
        $headers = $mime->headers($headers);

        // Sending the email
        $mail =& Mail::factory('mail');
        $mail->send($recipient, $headers, $body);
?> 
```

并且消息没有被发送。检查我的错误日志：

> [2012 年 7 月 24 日 02:14:50] PHP 致命错误：调用 /home/ 中未定义的方法 Mail_mimePart::encodeHeader() *** */php/Mail/mime.php 在第 1330 行

我想知道是否有人知道此错误消息与什么有关以及可以做些什么？mime.php 中的第 1330 行是此函数的第 4 行：

```
function encodeHeader($name, $value, $charset, $encoding)
    {
        $mime_part = new Mail_mimePart;
        return $mime_part->encodeHeader(
            $name, $value, $charset, $encoding, $this->_build_params['eol']
        );
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T23:49:40.447

```
include_once("Mail/mime.php"); 
```

应该是你的包括。

# java - 在每个实例中将后台脚本输出缓冲到前端

> ID：11623313
> 
> 赞同：0
> 
> 时间：2012-07-24T02:33:48.820
> 
> 标签：java, ajax, multithreading, jsp, long-polling

我正在开发一个 Web 应用程序，其中我使用 Java 作为前端，使用 shell 脚本作为后端。我需要在 shell 脚本中处理很多文件，假设我需要在 shell 脚本中处理 1000 个文件。我正在使用 Java 中的以下代码

```
for(i from 1..1000)
{
       Call shell script to process file i
} 
```

在 shell 脚本中，我正在做一些处理逻辑并将 o/p 存储在本地文件中（然后可以从 Java 访问）。

```
My requirement is, for everytime the shell script being called, an output is generated to a file. so as an when the control from shell script to java, I have to process it and display it in the front end. But the for loop should not break. It has to carry on with as it is but some front end work of displaying this file should also take place. 
```

我尝试对此进行搜索，我得到的建议是为此使用 AJAX 和长轮询以及线程。你们能分享一些关于这个的想法吗？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:14:05.100

这也可以通过 websockets 来完成。例如，您可以将每 100 个中的每一个发回信息。也可以在 Google 上搜索“Comet”或“Reverse Ajax”（尤其是对于较旧的浏览器支持）。

确实，您可能想查看称为 Socket.Io 的东西或其他语言/环境的相应框架。

如今，很多用户都在运行支持 Web 套接字的 HTML 5 浏览器，因此根据用户的不同，您不必担心打开长轮询连接。

# objective-c - UILabel 有最大高度吗？

> ID：11623317
> 
> 赞同：5
> 
> 时间：2012-07-24T02:34:19.607
> 
> 标签：objective-c, uilabel

没有太多要分享的代码，只是一个问题。如果标签的高度超过 8191 像素，为什么我的标签不可见？

你可能会认为这太过分了，为什么我要这么长的标签……它是动态的，所以你永远不知道。

所以事情是这样的：我创建了我的 UIScrollView 并开始在 init 中添加标签，其中 5 个。我设置了文本，一切顺利。我有一个方法可以获取 5 个标签，使用 获取大小`NSString sizeWithFont:constrainedToSize:lineBreakMode:`，重新排列它们并重置 UIScrollView 的 contentHeight。都好。问题是，当标签的高度正好超过 8191 像素（宽度超过 300）时，它就会消失，不可见，噗！走了。

如果我不能让它工作，我想我可以将文本分成多个部分并创建额外的 UILabel，但我想避免这种情况。

有任何想法吗？

这是一些虚拟代码，易于理解

```
NSError *er = nil;
    // this file can be found here: 
    // https://gist.github.com/3167635
NSString *path = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"lorem.txt"];
NSString *labelText = [[NSString alloc] initWithContentsOfFile:path encoding:NSUTF8StringEncoding error:&er];
if(er != nil)
    NSLog(@"Error: %@", er);

UIScrollView *scrollView = [[UIScrollView alloc] initWithFrame: self.view.bounds];
[scrollView setBackgroundColor:[UIColor whiteColor]];

UILabel *label = [[UILabel alloc] init];
[label setBackgroundColor:[UIColor whiteColor]];
[label setNumberOfLines:0];
[label setText:labelText];

CGSize size = [labelText sizeWithFont:label.font constrainedToSize:CGSizeMake(300, CGFLOAT_MAX) lineBreakMode:UILineBreakModeCharacterWrap];

NSLog(@"Size: %@", NSStringFromCGSize(size));
CGRect labelFrame;
labelFrame.origin = CGPointMake(10, 0);
labelFrame.size = size;

[label setFrame:labelFrame];
[scrollView setContentSize:size];   
[scrollView addSubview:label];

[[self view] addSubview:scrollView]; 
```

虚拟文本很大，使标签不可见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T08:46:39.230

我建议使用`sizeToFit`属性而不是自己设置高度，因为此属性将根据您的文本设置标签的高度，您不必费力设置高度

或者你可以改用这条线

```
CGSize maximumLabelSize = CGSizeMake(headerView.frame.size.height,over 8191 ); 
```

# css - 同时进行两个过渡

> ID：11623318
> 
> 赞同：4
> 
> 时间：2012-07-24T02:34:34.643
> 
> 标签：css, webkit, css-transitions

在[这次讨论](https://stackoverflow.com/questions/11622883/animating-specific-corners-on-hover-with-jquery/11622955#comment15392078_11622955)中，给出了一些很好的建议。现在，我不仅想使用

```
-webkit-transition: border-radius 0.5s; 
```

但是也

```
-webkit-transition: background-color 0.5s; 
```

然后走

```
div.menuItem:hover {
  border-radius: 145px 85px 145px 85px;
  background-color: #000000;
} 
```

当我一次只做一个过渡时，它工作得很好，但我不知道如何将它们结合起来。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-24T02:36:21.253

用逗号分隔它们。

```
-webkit-transition: background-color 0.5s, border-radius 0.5s; 
```

演示：**[=)](http://jsfiddle.net/97dX5/)**

# java - 在静态变量中使用同步

> ID：11623326
> 
> 赞同：1
> 
> 时间：2012-07-24T02:35:15.683
> 
> 标签：java, multithreading, static-variables

我有一个静态地图

```
private static Map<String, Car> cars = new HashMap<~>() //Map holding car objects 
```

我在方法中使用变量，例如

```
private static String getCar(String name){
    return cars.get(name);
} 
```

因此，如果我想锁定汽车，是否可以像下面那样进行线程安全。

```
private static void xyz() {
    synchronized(cars) {
        Car c = getCar("abc");
        c.setColor("Green");
    }
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T02:55:35.793

Java 的`synchronized`关键字可以应用于任何对象以在继续之前对该对象“获取锁”（或“同步”该对象）。如果任何其他进程试图同时在同一对象上运行同步代码，它将阻塞，直到锁定该对象的进程退出同步块。

您同步的对象不必在`synchronized`块的任何部分实际使用；它可能是一个简单的互斥对象，其唯一目的是在同步块中锁定和解锁。但是，重要的是要注意，如果其他线程没有在该对象上进行同步，那么简单地在一个对象上同步**并不会**阻止*它们*修改它。它是程序员/约定强制执行的锁，而不是内置锁，所有使用共享对象的代码都必须“同意”在其上进行同步。

例如，使用您上面编写的代码，即使您的`xyz()`方法在 上同步`cars`，您也可以编写另一个方法，如下所示：

```
public void changeCar() {
    Car myCar = cars.get("abc");
    myCar.setColor("Blue");
} 
```

`cars` *无需*调用即可修改`synchronized`。此方法可能会在您的方法修改“abc”汽车的同时`xyz()`修改它（即违反线程安全），因为它不包含任何调用`synchronized`on 的代码`cars`。

如果您想确保您的`cars`地图是线程安全的（即从不同时被两种方法修改），您必须要么

1.  确保任何修改`cars`首次调用的代码`synchronized(cars)`
2.  使用[ConcurrentHashMap](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)，它可以保证对它的 put 和 get 操作是线程安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:05:27.727

很好，但请**注意**，使用您当前的代码，您并没有完全锁定汽车对象，**您仍然可以通过其他方法访问汽车并设置属性*，除非您再次在汽车对象上同步***。

```
public static void otherMethod() {
  synchronized(cars) {
     Car myCar = cars.get("abc");
     myCar.setColor("Red");
  }
} 
```

但是如果方法 xyz() 是您设置属性的**唯一位置**，那么您的代码是线程安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T03:48:54.230

如果您只担心单个方法同步，请使用

```
Map<String, Car> synchronizedMap = Collections.synchronizedMap(map); 
```

这将自动为映射中的所有方法添加同步，并使每个方法调用原子。这是您可能应该向您的线程公开的地图。

但是，如果您需要跨多个方法调用进行同步（如果某些内容为空，则 get 后跟 put），则需要上述方法。

请注意 Car 对象也需要是线程安全的，并且在没有看到该方法的情况下，我不能说它是否是。

# wordpress - Wordpress：显示与我创建的自定义分类相关的所有帖子......

> ID：11623332
> 
> 赞同：0
> 
> 时间：2012-07-24T02:35:36.287
> 
> 标签：wordpress

我需要显示我为自定义帖子类型创建的所有类别，然后在每个类别中我需要循环与该类别相关的所有帖子。

我尝试用多种不同的方式构建我的 WP_Query，但我根本无法让它工作。

这是我现在拥有的代码：

```
$categories = get_categories('taxonomy=faqcat&order=DESC');
foreach ($categories as $cat) {

    // loop through all  posts tied to category here
} 
```

更新的代码..仍然不起作用..在每个类别中不断显示相同的帖子。

```
<?php
$categories = get_categories('taxonomy=faqcat&order=DESC');
foreach ($categories as $cat) :

    echo '<h1>' . $cat->name . ' (' . $cat->cat_ID . ' )</h1>';
    $q = new WP_Query(array('cat_ID' => $cat->cat_ID, 'post_type' => 'faq', 'tax_query' => array('taxonomy' => 'faqcat')));
    if ($q->have_posts()) : while ($q->have_posts()) : $q->the_post();
      echo $post->ID;      

    ?>
            <pre> <B><?php the_title(); ?></b></pre>
            <p><?php the_content(); ?></p>
            <br/>
        <?php endwhile;
    else:
        ?>
        <p><?php _e('Sorry, no posts matched your criteria.'); ?></p>
    <?php
    endif;
endforeach;
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T02:06:43.390

这是修复：

```
 <!--faq page -->
    <div class="faq">
        <?php get_template_part('./template/global/breadcrumbs'); ?>
        <h3><span><?php the_title(); ?></span></h3>
        <?php
        $categories = get_categories('taxonomy=faqcat&order=DESC');
        foreach ($categories as $cat) {
            $i = 0;
            ?>
            <div class="faq-title">
                <h2><?php echo $cat->name; ?></h2>
            </div>
            <?php
            $answers = new WP_Query(array('post_type' => 'faq', 'tax_query' => array(array('taxonomy' => 'faqcat', 'field' => 'id', 'terms' => $cat->term_id,),),));
            if ($answers->have_posts()) : while ($answers->have_posts()) : $answers->the_post();
                    $i++;
                    ?>
                    <div class="faq-post" id="faq-<?php echo $i; ?>"> <span class="close-tab"><?php the_title(); ?></span>
                        <div class="faq-post-detail">
                            <?php the_content(); ?>  
                        </div>
                    </div>

                    <?php
                endwhile;
            else:
                ?>
                <p><?php _e('Sorry, no posts matched your criteria.'); ?></p>
            <?php endif;
        }
        ?> 
```

# android - 手机上的照片看起来非常像素化（有时） - 但在模拟器上看起来不错

> ID：11623333
> 
> 赞同：1
> 
> 时间：2012-07-24T02:35:36.893
> 
> 标签：android, photos

我正在开发一个新闻应用程序，每篇文章只有一张照片。我正在调整服务器上照片的大小并将它们 DLing 到我的应用程序中。

一切看起来都很好，然后突然之间，我开始注意到我手机上的照片看起来非常像素化（不仅仅是像素化-它们就像保存-a-jpg-at-0-quality crappy）所以我检查了模拟器，他们看起来很好 - 清晰/干净的图像。

后来，我手机上的图像又看起来不错了，所以我把它从我的待办事项列表中标记出来“修复手机上看起来很糟糕的图像”——完成。

现在，他们又回来了。我已经检查了调整大小/提供照片的 URL - 它们在那里看起来很好。我尝试过不同的尺寸、压缩方式……等等。目前，我的画质为 90，宽为 640 像素。我试过 100 质量和 1200 像素宽，我也试过更小。

我的手机是 Galaxy Nexus。

# java - Atmosphere @MeteorService 注释不起作用

> ID：11623334
> 
> 赞同：0
> 
> 时间：2012-07-24T02:35:43.893
> 
> 标签：java, comet, atmosphere

我试图从下面的链接创建一个基本的气氛测试。我已经从 pom 文件中下载了它所要求的所有内容。但由于某种原因，日食无法识别“@MeteorService(path = "/*", interceptors = {AtmosphereResourceLifecycleInterceptor.class})”

```
https://github.com/Atmosphere/atmosphere/blob/master/samples/meteor-chat/src/main/java/org/atmosphere/samples/chat/MeteorChat.java 
```

有任何想法吗？我用的是大气0.9.7版本

**Maven 安装**

```
=======================
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building atmosphere-meteor-chat 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-resources-plugin:2.4.3:resources (default-resources) @ atmosphere-meteor-chat ---
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] Copying 0 resource
[INFO] 
[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ atmosphere-meteor-chat ---
[WARNING] File encoding has not been set, using platform encoding Cp1252, i.e. build is platform dependent!
[INFO] Compiling 1 source file to Q:\myEdu\atmosphere-meteor-chat\target\classes
[INFO] -------------------------------------------------------------
[ERROR] COMPILATION ERROR : 
[INFO] -------------------------------------------------------------
[ERROR] \myEdu\atmosphere-meteor-chat\src\main\java\org\atmosphere\samples\chat\MeteorChat.java:[31,1] cannot find symbol
symbol: class MeteorService
@MeteorService(path = "/*", interceptors = {AtmosphereResourceLifecycleInterceptor.class})
[INFO] 1 error
[INFO] -------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.542s
[INFO] Finished at: Tue Jul 24 23:10:57 EDT 2012
[INFO] Final Memory: 7M/121M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project atmosphere-meteor-chat: Compilation failure
[ERROR] \myEdu\atmosphere-meteor-chat\src\main\java\org\atmosphere\samples\chat\MeteorChat.java:[31,1] cannot find symbol
[ERROR] symbol: class MeteorService
[ERROR] @MeteorService(path = "/*", interceptors = {AtmosphereResourceLifecycleInterceptor.class})
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException 
```

# POM XML

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>org.atmosphere.samples</groupId>
    <artifactId>atmosphere-meteor-chat</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <packaging>war</packaging>
    <name>atmosphere-meteor-chat</name>
        <properties>
        <atmosphere.version>0.9.7</atmosphere.version>
        <jersey.version>1.10</jersey.version>
        <nettosphere.version>1.3.1</nettosphere.version>
        <ahc.version>1.7.4</ahc.version>
        <javaee.version>6.0</javaee.version>
        <testng.version>6.5.2</testng.version>
        <logback.version>1.0.6</logback.version>
        <maven-compiler-plugin.version>2.3.2</maven-compiler-plugin.version>
        <maven-war-plugin.version>2.1.1</maven-war-plugin.version>
        <jetty.version>8.1.1.v20120215</jetty.version>
    </properties>
    <repositories>
        <repository>
            <id>Sonatype snapshots</id>
            <url>https://oss.sonatype.org/content/repositories/snapshots</url>
        </repository>
        <repository>
            <id>Sonatype releases</id>
            <url>https://oss.sonatype.org/content/repositories/releases</url>
        </repository>
    </repositories>

    <dependencies>
        <dependency>
            <groupId>org.atmosphere</groupId>
            <artifactId>atmosphere-jquery</artifactId>
            <version>${atmosphere.version}</version>
            <type>war</type>
        </dependency>
        <dependency>
            <groupId>org.atmosphere</groupId>
            <artifactId>atmosphere-runtime</artifactId>
            <version>${atmosphere.version}</version>
        </dependency>
        <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-core</artifactId>
            <version>${logback.version}</version>
        </dependency>
          <dependency>
            <groupId>ch.qos.logback</groupId>
            <artifactId>logback-classic</artifactId>
            <version>${logback.version}</version>
        </dependency>
        <!-- This is ONLY required if you use Atmosphere's annotation -->
        <dependency>
            <groupId>eu.infomas</groupId>
            <artifactId>annotation-detector</artifactId>
            <version>3.0.0</version>
        </dependency>
        <dependency>
            <groupId>org.apache.geronimo.specs</groupId>
            <artifactId>geronimo-servlet_3.0_spec</artifactId>
            <version>1.0</version>
            </dependency>
    </dependencies>
</project> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-22T00:52:14.740

MeteorService 在大气运行时版本 1.1.0-SNAPSHOT 中，因此将 0.9.7 更改为 1.1.0-SNAPSHOT 应该修复它。

我还找到了 m2e-apt Eclipse 插件来帮助注释来自 Maven 稳定更新站点[http://download.jboss.org/jbosstools/updates/m2e-extensions/m2e-apt](http://download.jboss.org/jbosstools/updates/m2e-extensions/m2e-apt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T10:32:39.430

确保你的 pom.xml 中有：

```
 <dependency>
        <groupId>eu.infomas</groupId>
        <artifactId>annotation-detector</artifactId>
        <version>3.0.0</version>
    </dependency> 
```

您应该在日志中看到：

6:31:48.712 [main] INFO o.atmosphere.cpr.AtmosphereFramework - Atmosphere 正在使用 org.atmosphere.cpr.DefaultAnnotationProcessor 处理注释 06:31:48.721 [main] INFO oacpr.DefaultAnnotationProcessor - 在 org.atmosphere 中找到注释。正在扫描的 samples.chat.MeteorChat：接口 org.atmosphere.config.service.MeteorService 06:31:48.729 [main] INFO o.atmosphere.cpr.AtmosphereFramework - 安装的 AtmosphereHandler org.atmosphere.handler.ReflectorServletProcessor 映射到上下文路径： /* 06:31:48.729 [main] INFO o.atmosphere.cpr.AtmosphereFramework - 安装的 AtmosphereInterceptor [Atmosphere LifeCycle] 映射到 AtmosphereHandler org.atmosphere.handler.ReflectorServletProcessor

谢谢

——让弗朗索瓦

# smarty - 将函数应用于函数的结果

> ID：11623343
> 
> 赞同：0
> 
> 时间：2012-07-24T02:36:35.030
> 
> 标签：smarty

在我的 tpl 文件中，我有这部分代码显示一个字符串：

`{l s='blabla' mod='module'}`

我想`html_entity_decode`在显示之前将该函数应用于该字符串。

请问这个怎么处理？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T06:57:00.217

```
{capture assign="foobar"}{l s='blabla' mod='module'}{/capture}
{$foobar|unescape:"htmlall"} 
```

我不确定修饰符 unescape 在 Smarty2 中是否可用。从（至少）Smarty3.1 开始

# objective-c - get x & y & z position for CALayer

> ID：11623347
> 
> 赞同：0
> 
> 时间：2012-07-24T02:37:26.537
> 
> 标签：objective-c, ios, calayer

I want to get x,y,z position of CAlayer can i get it directly or i should use transform matrix ?

i know how to set its value

```
[layer setValue:value forKeyPath:@"transform.translation.z"];
[layer setValue:value forKeyPath:@"transform.translation.x"];
[layer setValue:value forKeyPath:@"transform.translation.y"]; 
```

but i don't know how to get them back ?

if i should use transform matrix what are the equations ?

and how can i get its rotation angle ?

# markdown - How To Syntax Highlight Jekyll Markup in Jekyll Page

> ID：11623349
> 
> 赞同：1
> 
> 时间：2012-07-24T02:37:57.303
> 
> 标签：markdown, jekyll, liquid

I am trying to write a Jekyll based post using Markdown parsed by kramdown about how I achieved something in Jekyll's liquid templating engine. However, when the pages are generated, Jekyll seems to get confused if its actual markdown that I intend to render OR is it supposed to be displayed as code.

Thus, how can I make the following snippet appear as a highlighted code section in my post?

```
{% for post in paginator.posts %}
   <div class="author">{{ post.date | date_to_string }}</div>
   <h3><a href="{{ BASE_PATH }}{{ post.url }}">{{ post.title }}</a></h3>
   <div class="content">
       {{ post.content | split:"<!--break-->" | first }}
   </div>
   <b><a href="{{ BASE_PATH }}{{ post.url }}">continue reading >></a></b>
   <hr/>
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T06:16:17.100

假设你有 Liquid 的词法分析器：

```
{% highlight liquid %}
{% raw %}
{% for post in paginator.posts %}
   <div class="author">{{ post.date | date_to_string }}</div>
   <h3><a href="{{ BASE_PATH }}{{ post.url }}">{{ post.title }}</a></h3>
   <div class="content">
       {{ post.content | split:"<!--break-->" | first }}
   </div>
   <b><a href="{{ BASE_PATH }}{{ post.url }}">continue reading >></a></b>
   <hr/>
{% endfor %}
{% endraw %}
{% endhighlight %} 
```

# ruby - Multiple subscribers with EM-WebSocket or Goliath

> ID：11623352
> 
> 赞同：1
> 
> 时间：2012-07-24T02:38:37.113
> 
> 标签：ruby, eventmachine, em-websocket, goliath

So I'm attempting to setup [em-websocket](https://github.com/igrigorik/em-websocket) (or potentially [Goliath](http://postrank-labs.github.com/goliath/)), so that users can come to a different route and thusly be subscribed to only that channel, so for example:

```
example.com/channel_1 
```

Browsers open there will only receive messages published to `channel_1`, actually to that point it doesn't have to be a route like this I'd settle for using params. So I'm using AMQP and it has the notion of a direct exchange, and routing keys. Is there something analogous to that with websockets?

I've got a Goliath server working but the issue is, that because it uses shared endpoints, I think that all the browsers open with a websocket connection are getting the same messages, here's what I'm doing:

```
channel.queue(params['channel'], :auto_delete => true).subscribe do |payload|
  config['channel'].push(payload)
end 
```

So this example uses AMQP, which I'd still like to use, but the issue I think lies in that each client is reinstantiating `EM::Channel.new`, and then the messages are pushed to that channel, I just don't understand how I would have multiple clients subscribed to different channels.

Any help understanding this or guiding me to a more appropriate design pattern.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-07T05:34:04.493

如果你的频道是预定义的，你可以在你的服务器的配置文件中为每个频道做一个 EM::Channel.new，然后客户端将通过适当的频道发送/接收消息。

如果通道是由用户定义的，那么您需要在配置中设置一个哈希（或其他东西）来存储您的通道，当客户端连接时，检查配置哈希以查看通道是否存在，如果不存在' t, EM::Channel.new 并继续。如果存在，请使用现有频道。

在第二种情况下，您需要在客户端断开连接时执行一些逻辑，以处理在所有客户端都消失时关闭通道，否则您将发生内存泄漏。

# cassandra - Cassandra 服务器抛出 java.lang.AssertionError: DecoratedKey(...) != DecoratedKey

> ID：11623356
> 
> 赞同：59
> 
> 时间：2012-07-24T02:39:13.577
> 
> 标签：cassandra, hector

我目前正在尝试使用 Cassandra。

在客户端（使用 Hector），我查找了如下几个键：

```
ColumnFamilyResult<String, String> result = template.queryColumns(Arrays.asList("key1","key2","key3")); 
```

大多数时候它似乎工作。但其他时候我在客户端上遇到超时异常：

```
Caused by: me.prettyprint.hector.api.exceptions.HTimedOutException: TimedOutException()
    at me.prettyprint.cassandra.service.ExceptionsTranslatorImpl.translate(ExceptionsTranslatorImpl.java:35)
    at me.prettyprint.cassandra.service.template.ThriftColumnFamilyTemplate$1.execute(ThriftColumnFamilyTemplate.java:100)
    at me.prettyprint.cassandra.service.template.ThriftColumnFamilyTemplate$1.execute(ThriftColumnFamilyTemplate.java:88)
    at me.prettyprint.cassandra.service.Operation.executeAndSetResult(Operation.java:103)
    at me.prettyprint.cassandra.connection.HConnectionManager.operateWithFailover(HConnectionManager.java:258)
    at me.prettyprint.cassandra.model.ExecutingKeyspace.doExecuteOperation(ExecutingKeyspace.java:97)
    at me.prettyprint.cassandra.service.template.ThriftColumnFamilyTemplate.sliceInternal(ThriftColumnFamilyTemplate.java:88)
    at me.prettyprint.cassandra.service.template.ThriftColumnFamilyTemplate.doExecuteSlice(ThriftColumnFamilyTemplate.java:46)
    at me.prettyprint.cassandra.service.template.ColumnFamilyTemplate.queryColumns(ColumnFamilyTemplate.java:113)
    at info.gamlor.experiments.Cassandra.readObjectByKey(ComplexCassandra.java:255)

Caused by: TimedOutException()
    at org.apache.cassandra.thrift.Cassandra$get_slice_result.read(Cassandra.java:7772)
    at org.apache.cassandra.thrift.Cassandra$Client.recv_get_slice(Cassandra.java:570)
    at org.apache.cassandra.thrift.Cassandra$Client.get_slice(Cassandra.java:542)
    at me.prettyprint.cassandra.service.template.ThriftColumnFamilyTemplate$1.execute(ThriftColumnFamilyTemplate.java:95) 
```

在服务器上显示此异常：

```
ERROR 11:33:55,312 Exception in thread Thread[ReadStage:91,5,main]
java.lang.AssertionError: DecoratedKey(4948402862350542345439897754126541659, 6932) != DecoratedKey(132475956107784875457507977471906551877, 726f6f74) in C:\tem
p\cassandra\lib\cassandra\data\CassandraPolepos\ComplexObjects\CassandraPolepos-ComplexObjects-hd-2-Data.db
        at org.apache.cassandra.db.columniterator.SSTableSliceIterator.<init>(SSTableSliceIterator.java:58)
        at org.apache.cassandra.db.filter.SliceQueryFilter.getSSTableColumnIterator(SliceQueryFilter.java:66)
        at org.apache.cassandra.db.filter.QueryFilter.getSSTableColumnIterator(QueryFilter.java:78)
        at org.apache.cassandra.db.CollationController.collectAllData(CollationController.java:256)
        at org.apache.cassandra.db.CollationController.getTopLevelColumns(CollationController.java:63)
        at org.apache.cassandra.db.ColumnFamilyStore.getTopLevelColumns(ColumnFamilyStore.java:1331)
        at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1193)
        at org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1128)
        at org.apache.cassandra.db.Table.getRow(Table.java:378)
        at org.apache.cassandra.db.SliceFromReadCommand.getRow(SliceFromReadCommand.java:69)
        at org.apache.cassandra.service.StorageProxy$LocalReadRunnable.runMayThrow(StorageProxy.java:816)
        at org.apache.cassandra.service.StorageProxy$DroppableRunnable.run(StorageProxy.java:1250)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722) 
```

有时 DecoratedKey(...) 部分中的键值会占用页面。

任何人都暗示我做错了什么。或者如何调查这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T23:25:09.923

这是[https://issues.apache.org/jira/browse/CASSANDRA-4687](https://issues.apache.org/jira/browse/CASSANDRA-4687)或[https://issues.apache.org/jira/browse/CASSANDRA-5202](https://issues.apache.org/jira/browse/CASSANDRA-5202) 您可以在所有服务器显示错误。如果它不断出现，您可能需要禁用密钥缓存。如果是 5202，它应该只在使用相同名称删除并重新创建列族之后发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T15:48:50.027

对我来说，它看起来像是一个错误。

使用更高版本（1.1.5），错误消失了。至少对我来说。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T14:55:22.093

这看起来像[https://issues.apache.org/jira/browse/CASSANDRA-4687](https://issues.apache.org/jira/browse/CASSANDRA-4687)，尚未修复。一种解决方法是禁用密钥缓存。

# php - Variable Within Single and Double Quotes

> ID：11623359
> 
> 赞同：1
> 
> 时间：2012-07-24T02:40:13.090
> 
> 标签：php, syntax-error

How would I get this to work?

```
$step = $_SERVER['PHP_SELF']. '?&step=';
echo "<form action=". $step ."2"><select>"; 
```

It's giving me a (Parse error: syntax error, unexpected '<') on the second line. Halp?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T02:43:08.850

转义字符串内的引号：

```
echo "<form action=\"${step}2\"><select>"; 
```

这将解决您的问题，但在将属性值放入 HTML 之前转义它可能是一个好主意：

```
echo "<form action=\"" . htmlspecialchars($step) . "2\"><select>"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T02:41:40.257

The " after the 2 ends the string. Escape it or use single quotes.

```
$step = $_SERVER['PHP_SELF']. '?&step=';
echo "<form action=\"", $step , "2\"><select>"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T02:42:02.970

Try escaping the double-quotes, or using a combination of double/singe:

```
echo "<form action=\"". $step ."2\"><select>"; 
```

or

```
echo '<form action="'. $step .'2"><select>'; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-24T02:42:15.333

Try actually paying attention to colour coding. Or use an editor that has colour-coding if yours doesn't.

```
echo '<form action="'.$step.'2"><select>'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-24T02:44:35.007

```
$step = $_SERVER['PHP_SELF']. '?&step=';
echo "<form action=". $step .'"2"><select>'; 
```

或者

```
$step = $_SERVER['PHP_SELF']. '?&step=';
echo "<form action=". $step ."\"2\""><select>"; 
```

# objective-c - Method After Delay with Parameters in Objective-C

> ID：11623362
> 
> 赞同：1
> 
> 时间：2012-07-24T02:40:31.183
> 
> 标签：objective-c, xcode, methods, parameter-passing, delay

I'm fairly new to Objective-C, so forgive me if I'm missing something common. I have a method with several (four) required parameters that needs to run over and over with a delay between runs. Normally, I'd use:

```
[self performSelector:@selector(methodName:) withObject:nil afterDelay:1.0f/10f]; 
```

The problem is I need the method to pass parameters (more than one) back into itself after the delay; but this bit of code can only pass one over. Is there something I'm missing here?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T02:44:13.743

Check the docs for `dispatch_after()`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T22:48:19.543

To answer the actual question, there are generally two ways to use `performSelector:withObject:afterDelay:` with multiple pieces of data:

1.  Change the method to take only one parameter, usually by packing the multiple items into a collection like an array. The caller will have to pack and the callee will have to unpack the items. You can add a wrapper method if you don't want to modify the original method.
2.  Use NSInvocation to represent the call of the method with multiple parameters, then do `performSelector:withObject:afterDelay:` on the invocation's `invoke` method. This method does not require changing any method parameters or adding any methods, but is more verbose.

# c# - Hashset "value cannot be null" error

> ID：11623363
> 
> 赞同：1
> 
> 时间：2012-07-24T02:40:34.357
> 
> 标签：c#, hash, hashmap, hashtable

I'm trying to execute the follow code and it works fine if myObject is != null but throws a "value cannot be null" error if myObject is null. Ideally, if myObject is null then I'd like to just have the HashSet have a single value of 0.

```
var ids = new HashSet<int>(myObject.Select(p => p.ID)); 
```

I've tried a couple different things. I'm not sure why I thought this would work.

```
var ids = new HashSet<int>(myObject.Select(p => p.ID).Where(p => p != null)); 
```

and this which seemed like it should work.

```
var ids = new HashSet<int>(myObject.Select(p => (p == null) ? 0 : p.ID)); 
```

Finally this worked but it seems like there's got to be a better way.

```
var ids = new HashSet<int>(myObject!= null ? myObject.Select(p => p.ID) : new int[] {0}); 
```

Anyone have a better way to do this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-11-15T17:37:59.933

现在，您的答案可以稍微清理一下：

```
var ids = new HashSet<int>(myObject?.Select(p => p.ID) ?? new [] {0}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:42:34.557

如果 myObject 为空，您的代码将转换为

```
var ids = new HashSet<int>(null.Select(p => p.ID)); 
```

您不能使用 Select 扩展方法关闭 null。

你的选择

```
var ids = new HashSet<int>(myObject!= null ? myObject.Select(p => p.ID) : new int[] {0}); 
```

是我所知道的满足您要求的最紧凑的形式，尽管如果您愿意，当然可以将这种复杂性隐藏在方法或扩展方法中。

# html - CSS 显示：表格单元格浮动导致文本中有额外的空间

> ID：11623368
> 
> 赞同：0
> 
> 时间：2012-07-24T02:41:01.073
> 
> 标签：html, css, css-float

我在使用表格布局进行设计时遇到问题。因此，我使用 2 个边栏进行侧边导航和居中的主要部分内容（全部包含在部分包装器中） 我在部分包装器中的文本在顶部有一些空白间距。这是由于侧面元素上的左右浮动。如果我删除它们，文本会回到顶部，但我的侧边元素会占据整个空间（我在侧边使用了框边框来显示它，因为我想为我的设计为侧边元素着色所以我不不希望它占据主体内容的整个空间）

我试过使用 top:0% 但没有运气。

小提琴：http: [//jsfiddle.net/chou_one/nPAJc/](http://jsfiddle.net/chou_one/nPAJc/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:22:17.387

您可以通过更改宽度和浮动来简单地做到这一点。

根据您的代码，我做了一些更改：

我将浮动`#side-news2`从更改`right`为`left`。并添加`width: 30%`到`#side-news`、`#side-news2`和`#section-wrapper`。请注意，所有的`width`( `30%`+ `30%`+ `30%`) 不能超过一个 in `#body-content`(设置为`90%`)

```
#body-content {
    display: table;
    width:90%;     
    margin: 0 auto;
    background: lightblue;
    border-color: rgba(255, 255, 255, 0.7); /* highlight on inner box */
    border-width: 1px;
    border-style: solid;
    -moz-border-radius: 3px; /* FF */
    -webkit-border-radius: 3px; /* Safari, Chrome */
    border-radius: 3px; /* modern browsers */    
    -moz-box-shadow: 1px 1px 6px rgba(0, 0, 0, 0.15);
    -webkit-box-shadow: 1px 1px 6px rgba(0, 0, 0, 0.15);
    box-shadow: 1px 1px 6px rgba(0, 0, 0, 0.15);    
}

#side-news {
    border:1px solid black;
    width:30%;
        top:0%;
    display:table-cell;    
    float:left;
    list-style:none;    
}

#side-news2 {
    border:1px solid black;
    width:30%;
    display:table-cell;    
    float:left;
    list-style:none;      
}
#section-wrapper {
    width:30%;
    display:table-cell;  
    margin: 0px;
    float:left;
    top:0%;
    margin-top:0%;
    border:1px solid black;
    margin-top:0%;
} 
```

​</p>

# xml - How to set up catalog files for xmllint?

> ID：11623369
> 
> 赞同：5
> 
> 时间：2012-07-24T02:41:11.797
> 
> 标签：xml, xsd, xml-validation, lint

Ok. I want to set up catalog files for xmllint to fix things so that the dcterms xml namespace is validated from a local document. I believe that I have done everything right, but it simply doesn't seem to be working.

I am running OSX.

I have created a directory /etc/xml

```
$ mkdir /etc/xml
$ cd /etc/xml 
```

I have downloaded dcterms.xsd to that directory

```
$ ls -l
-rw-r--r--  1 ibis  wheel  12507 24 Jul 11:42 dcterms.xsd 
```

I have created a file named "catalog"

```
$ xmlcatalog --create > catalog 
```

I have added the dcterms namespace to the catalog file

```
$ xmlcatalog --noout --add uri http://purl.org/dc/elements/1.1/ file:///etc/xml/dc.xsd
$ xmlcatalog --noout --add uri http://purl.org/dc/terms/ file:///etc/xml/dcterms.xsd
$ cat catalog
<?xml version="1.0"?>
<!DOCTYPE catalog PUBLIC "-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN" "http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd">
<catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">
  <uri name="http://purl.org/dc/elements/1.1/" uri="file:///etc/xml/dc.xsd"/>
  <uri name="http://purl.org/dc/terms/" uri="file:///etc/xml/dcterms.xsd"/>
</catalog> 
```

In a work directory, I have created a simple xml schema named Empty.xsd

```
<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.example.org/Empty" xmlns:tns="http://www.example.org/Empty" elementFormDefault="qualified">
  <element name="empty">
    <complexType>
      <sequence>
        <any processContents="strict" minOccurs="0" maxOccurs="unbounded"/>
      </sequence>
      <anyAttribute></anyAttribute>
    </complexType>
  </element>
</schema> 
```

Note that the processcontnts is "strict".

I have created an XML file which *should* trigger all the validation:

```
<?xml version="1.0" encoding="UTF-8"?>
<empty xmlns="http://www.example.org/Empty" 
          xmlns:dcterms="http://purl.org/dc/terms/">
    <dcterms:title>A title</dcterms:title>
</empty> 
```

Then I attempt to validate it.

```
$ xmllint --noout --valid --schema Empty.xsd Empty.xml
Empty.xml:2: validity error : Validation failed: no DTD found !
y xmlns="http://www.example.org/Empty" xmlns:dcterms="http://purl.org/dc/terms/"
                                                                               ^
Empty.xml:3: element title: Schemas validity error : Element '{http://purl.org/dc/terms/}title': No matching global element declaration available, but demanded by the strict wildcard.
Empty.xml fails to validate 
```

I have set up a catalog as specified in the docs and pointed it at the local dcterms schema file. Why does xmllint fail to find it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T16:57:17.597

1.  我在 中没有`title`元素`dcterms`，所以我将其替换为`abstract`
2.  我找不到任何确认，但其他人也报告了在 libxml 中为 xsd 模式使用目录文件的问题。我发现目录对 dtds 工作正常。
3.  有一种解决方法。插入. `<import namespace="http://purl.org/dc/terms/" schemaLocation="dcterms.xsd" />`_ `Empty.xsd`之后，我摆脱了`No matching global`消息。
4.  `No DTD found`仍然可见，但返回码从 3 增加到 4，这意味着解析成功。
5.  编辑：`--sax`开关似乎有助于“未找到 DTD”消息。

相关问题：[使用架构标头和目录查找进行 Xml 验证](https://stackoverflow.com/questions/7994086/xml-validation-with-schema-header-and-catalog-lookup)，没有答案。这大约是第 2 点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-11T13:28:12.180

程序`xmllint`不会根据`xmlns="something"`要解析的 XML 文件中的属性自动加载 XSD 文件，它只使用`--schema`参数中指定的 XSD（以及从中导入/包含的 XSD）。

对于测试，您可以创建一个`NonEmpty.xsd`这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<schema 
    xmlns="http://www.w3.org/2001/XMLSchema"
    targetNamespace="http://www.example.org/Empty"
    elementFormDefault="qualified">
  <include schemaLocation="Empty.xsd"/>
  <import schemaLocation="dcterms.xsd" namespace="http://purl.org/dc/terms/"/>
</schema> 
```

用法：

```
$ xmllint -debugent -noout -schema NonEmpty.xsd Empty.xml
new input from file: NonEmpty.xsd
new input from file: Empty.xsd
new input from file: dcterms.xsd
new input from file: http://www.w3.org/2001/03/xml.xsd
new input from file: dc.xsd
new input from file: dcmitype.xsd
new input from file: Empty.xml
Empty.xml validates 
```

现在有`catalog`文件：

```
<?xml version="1.0"?>
<!DOCTYPE catalog PUBLIC "-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN" "http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd">
<catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">
  <uri name="http://www.w3.org/2001/03/xml.xsd"          uri="file:///home/zsiga/proba/dcterms/2001_03_xml.xsd"/>
  <uri name="http://dublincore.org/schemas/xmls/qdc/dcterms.xsd" uri="file:///home/zsiga/proba/dcterms/dcterms.xsd"/>
</catalog> 
```

这是`NonEmpty2.xsd`文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<schema 
    xmlns="http://www.w3.org/2001/XMLSchema"
    targetNamespace="http://www.example.org/Empty"
    elementFormDefault="qualified">
  <include schemaLocation="Empty.xsd"/>
  <import schemaLocation="http://dublincore.org/schemas/xmls/qdc/dcterms.xsd" namespace="http://purl.org/dc/terms/"/>
</schema> 
```

及其用法：

```
$ XML_CATALOG_FILES=./catalog xmllint -debugent -noout \
    -schema NonEmpty2.xsd Empty.xml
new input from file: NonEmpty2.xsd
new input from file: Empty.xsd
new input from file: file:///home/zsiga/proba/dcterms/dcterms.xsd
new input from file: file:///home/zsiga/proba/dcterms/2001_03_xml.xsd
new input from file: file:///home/zsiga/proba/dcterms/dc.xsd
new input from file: file:///home/zsiga/proba/dcterms/dcmitype.xsd
new input from file: Empty.xml
Empty.xml validates 
```

--- 编辑 2020.11.02。---

我想建议使用`<systemId>`标签 in `catalog`，也使用相对路径名：

```
<?xml version="1.0"?>
<!DOCTYPE catalog PUBLIC "-//OASIS//DTD Entity Resolution XML Catalog V1.0//EN" "http://www.oasis-open.org/committees/entity/release/1.0/catalog.dtd">
<catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">
  <system systemId="http://www.w3.org/2001/03/xml.xsd"                  uri="2001_03_xml.xsd"/>
  <system systemId="http://dublincore.org/schemas/xmls/qdc/dcterms.xsd" uri="dcterms.xsd"/>
</catalog> 
```

结果是一样的，但有些程序更`<system>`喜欢`<uri>`. 相对路径名 [相对于`catalog`文件的位置] 可能更容易处理。

# php - symfony2 still using MYSQL instead of POSTGRESQL

> ID：11623370
> 
> 赞同：1
> 
> 时间：2012-07-24T02:41:29.293
> 
> 标签：php, symfony

my parameters.ini file:

```
; These parameters can be imported into other config files
; by enclosing the key with % (like %database_user%)
; Comments start with ';', as in php.ini
[parameters]
    database_driver="pdo_pgsql"
    database_host="localhost"
    database_port=""
    database_name="mydbname"
    database_user="postgres"
    database_password="somepassword"
    mailer_transport="smtp"
    mailer_host="localhost"
    mailer_user=""
    mailer_password=""
    locale="en"
    secret="ffdfdffdfdfdfdfdfdfdf" 
```

my config.yml file is as follows:

```
# Doctrine Configuration
doctrine:
    dbal:
        driver:   %database_driver%
        host:     %database_host%
        port:     %database_port%
        dbname:   %database_name%
        user:     %database_user%
        password: %database_password%
        charset:  UTF8 
```

I also did:

```
php bin/vendors update
php app/console assets:install web
php app/console doctrine:schema:create
php app/console doctrine:fixtures:load
chmod 777 -R app/cache app/logs 
```

However when I do the schema:create, I get:

```
[PDOException]                                                                         
  SQLSTATE[42S01]: Base table or view already exists: 1050 Table 'users' already exists  

doctrine:schema:create [--dump-sql] [--em[="..."]] 
```

It appears it is still trying to create stuff in the MYSQL database since that has the users table already. What am i doing wrong?

# html - 在 Cakephp 中解析 HTML

> ID：11623377
> 
> 赞同：1
> 
> 时间：2012-07-24T02:42:09.553
> 
> 标签：html, parsing, web-crawler, php-5.3, cakephp-2.2

我开始在 CakePHP 2.2 中构建一个网络爬虫。脚本正在抓取的页面是 HTML 页面，我需要解析它们以获取我的值。

尝试了一些不同的解决方案，并查看了一些开源的东西，但不确定最好的方法是什么。

*   DomDocument::loadHTML() - 看起来这是解决方案，但不是 100% 确定。
*   正则表达式 - 有点难以维护
*   简单的 HTMLDom - [http://electrokami.com/coding/simple-html-dom-baked-cakephp-component](http://electrokami.com/coding/simple-html-dom-baked-cakephp-component)（为 Cake 1.3 制作，以及它自己的代码，是的，我不喜欢它 -**并且有严重的内存泄漏（ s)** )

*要弄清楚我应该使用哪种方法，我需要你的帮助。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T19:09:28.117

DomDocument 是您的最佳选择。该模块的 php.net 文档中有一些不错的示例。如果您可以使用其他语言，例如 ruby​​，我对 hpricot 有很好的经验，这是一个类似于 jQuery 的用于解析 html 的库。

这个问题与[Robust and Mature HTML Parser for PHP有关](https://stackoverflow.com/questions/292926/robust-mature-html-parser-for-php)

# jquery - Ajax: success doesn't work with .live() click to execute a script

> ID：11623380
> 
> 赞同：2
> 
> 时间：2012-07-24T02:42:21.997
> 
> 标签：jquery, ajax

I'm just changing one div and replace it with ajax. In this div I have a script running ([fittext](http://fittextjs.com/)) which will only work if I reload the function to the script within the success of the ajax. This works.

I am also using .live() click to make links inside the new content work. But if I'm using those .live() links inside the div to load the new div the script in the success won't work. I just see it working for a second and then it doesn't work anymore.

Here's my Ajax code:

```
$(function(){
    var replacePage = function(url) {

        $.ajax({
            url: url,
            type: 'get',
            dataType: 'html',
            success: function(data){
                var dom = $(data);
                var html = dom.filter('#content').html();

                $("#content").promise().done(function(){                            
                    $('#content').html(html);
                }); 

               //my script
               fitText();
            }
        });
    }

    $('nav a').on('click', function(e){
        history.pushState(null, null, this.href);       
        replacePage(this.href);
        e.preventDefault();
        $("#content").hide();
    });

    $(window).bind('popstate', function(){
        replacePage(location.pathname);
    });
}); 
```

And here's my .live() code:

```
(function(){
    var $lis = $('.list a');
    var index = 0, lastIndex = 0;

    start();

    function next(){
        lastIndex = index;
        if(++index == $lis.length) index = 0;
        $lis.eq(index).addClass('active');
        $lis.eq(lastIndex).removeClass('active');
        $lis.eq(index).click();
    };

    function prev(){
        lastIndex = index;
        if(--index < 0) index = ($lis.length - 1);
        $lis.eq(index).addClass('active');
        $lis.eq(lastIndex).removeClass('active');
        $lis.eq(index).click();
    };
    function start(){
        $lis.eq(0).addClass('active');

        $('.next').live("click", next);        
        $('.prev').live("click", prev);   
    }

})(); 
```

And here's the html:

```
// outside ajax content
<div class="list">
   <a href="link-1">
   <a href="link-2>
</div>

// ajaxed content
<div id="content">
   <h2 id="fittext">Heading</h2>
   <span class="prev"></span>
   <span class="next"></span>
</div> 
```

I though I would use .live() correct here and that clicking a link outside the ajax content and inside the ajax content with .live() would do the same but I'm wondering why it doesn't work in this case.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:54:14.973

```
$('nav a').on('click', function(e){
    history.pushState(null, null, this.href);       
    replacePage(this.href);
    e.preventDefault();
    $("#content").hide();
}); 
```

应该：

```
$(document).on('click', 'nav a', function(e){
    history.pushState(null, null, this.href);       
    replacePage(this.href);
    e.preventDefault();
    $("#content").hide();
}); 
```

现在这将使它就像一个 .live() 函数，我认为这就是为什么未来的点击不起作用的原因。

有时在 ajax 完成上重置一些绑定可能会使其工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T13:46:35.983

好的，这是答案：

我不得不承认这只是我的错。

例如，当我发布此工作 html 时：

```
<div id="content">
   <h2 id="fittext">Heading</h2>
   <span class="prev"></span>
   <span class="next"></span>
</div> 
```

我的内容中仍然有这个 html：

```
<div id="content">
   <h2 id="fittext">Heading</h2>
   <a href="#" class="prev"></a> <-- The a-tags
   <a href="#" class="next"></a> <-- The a-tags
</div> 
```

当然，这会导致两次点击请求。第一个来自 .list (ajax)，第二个来自链接本身，这只是一个不用于 ajax 的普通点击事件。

# css - -webkit-transition-timing-function 在 Chrome 中没有任何效果

> ID：11623387
> 
> 赞同：1
> 
> 时间：2012-07-24T02:43:14.183
> 
> 标签：css, css-transitions

无论我设置什么，`-webkit-transition-timing-function`我总是得到默认`ease`行为。我已经尝试了所有选项并需要`linear`，但 Chrome 忽略了该设置。FF 和 Safari 确实按预期工作......

[http://www.w3schools.com/cssref/css3_pr_transition-timing-function.asp](http://www.w3schools.com/cssref/css3_pr_transition-timing-function.asp)

```
 .boxOverGlow
    {
        width: 100%;
        left: 0px;
        top: 0px;
        position: absolute;
        display: block;
        z-index: 28;
        opacity: 0;
        filter: alpha(opacity=0);

        transition-timing-function: linear;
    -moz-transition-timing-function: linear; /* Firefox 4 */

    -o-transition-timing-function: linear; /* Opera */

     transition:opacity 1s;
    -moz-transition:opacity 1s; /* Firefox 4 */
    -webkit-transition:opacity 1s; /* Safari and Chrome */
    -o-transition:opacity 1s; /* Opera */

     -webkit-transform-style: preserve-3d;
          -webkit-transition-timing-function: linear; /* Safari and Chrome */

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T07:12:15.783

当您更改行为时，还要将其更改为默认行，即

```
 transition-timing-function: ease-out;
-moz-transition-timing-function: ease-out;
-webkit-transition-timing-function: ease-out; 
```

这些转换正在我的谷歌浏览器（20.0.1132）中醒来。

您正在使用

```
-webkit-transform-style:preserve-3d 
```

它是用于元素的转换，这与转换完全不同。尝试删除该行。根据我从您的问题中了解到的情况，我在那里没有必要。:)

# sql-server-2008 - 有条件地添加多行 (SQL SERVER 2008)

> ID：11623401
> 
> 赞同：0
> 
> 时间：2012-07-24T02:44:38.140
> 
> 标签：sql-server-2008, insert-update

我需要一次在表中添加多行。这些行有一些共同的字段值。我使用游标解决了我的问题，这是存储过程。

有没有人有更好的方法呢？

```
 USE [MyDataBase]
    GO

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    ALTER PROCEDURE [dbo].[spAddDetailsBatch]
    (
    @IdOperTur UniqueIdentifier,
    @IdProd UniqueIdentifier,
    @Model Bit,
    @PrAd Decimal(18,2),
    @PrMe Decimal(18,2),
    @PoCo Decimal(5,2)
    )
    AS
    DECLARE @prpr_Id UniqueIdentifier
    DECLARE @IdCont UniqueIdentifier = NULL

    DECLARE CPr CURSOR FOR SELECT prpr_Id FROM trsx_PrPr WHERE (prod_Id = @IdProd)
    OPEN CPr

    FETCH NEXT FROM CPr INTO @prpr_Id
    WHILE @@Fetch_Status=0 BEGIN /*iterate through all records from cursor*/

     SET @IdCont = (SELECT cont_Id FROM trsx_Cont
                    WHERE  (prpr_Id = @prpr_Id) AND (optu_Id = @IdOperTur))

     IF @IdCont IS NULL
     BEGIN
      INSERT INTO trsx_Cont(cont_Id, prpr_Id, optu_Id, cont_Neto, cont_PrAd, cont_PrMe, cont_PoCo)
      VALUES (NEWID(), @prpr_Id, @IdOperTur, @Model, @PrAd, @PrMe, @PoCo)
     END

     FETCH NEXT FROM CPr INTO @prpr_Id
    END
   CLOSE CPr
   DEALLOCATE CPr
   RETURN 
```

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:18:27.313

像这样的东西怎么样：

```
insert into trsx_Cont(cont_Id, prpr_id, optu_Id, cont_Neto, cont_PrAd, cont_PrMe, cont_PoCo)
select (newid(), trsx_PrPr.prpr_id, @IdOperTur, @Model, @PrAd, @PrMe, @PoCo)
from trsx_PrPr
where not exists(
    SELECT 1
    from trsx_Cont
    WHERE
        trsx_Cont.prpr_Id = trsx_PrPr.prpr_Id AND 
        trsx_Cont.optu_Id = @IdOperTur
) and
trsx_PrPr.prod_id = @IdProd 
```

我没有对此进行测试，并且由于它有点复杂，因此它可能无法按原样工作，但是您应该能够理解。

# php - 使用 mysql 和 php 存储多个选定的列表框

> ID：11623402
> 
> 赞同：0
> 
> 时间：2012-07-24T02:44:45.753
> 
> 标签：php, mysql

我的场景有点像这个线程中的场景： [PHP - Remember Selected value of Dropdownlist from mysql](https://stackoverflow.com/questions/11189692/php-remember-selected-value-of-dropdownlist-from-mysql)

但是我的字段有多个值，我想根据数据库选择这些值到列表框选择中。

我有一个粗略的想法，我需要使用 foreach 循环（如果我错了，请纠正我）并且我需要对字段中的多个值使用 explode() 字符串。

假设我的表单具有列表框选项“一、二、三、四、五”，并且该用户仅提交了列表框值为“一、二、三”的表单。

如何检索并使列表框突出显示选项“一、二、三”和不突出显示选项“四、五”？

提前谢谢各位。

这是我到目前为止编写的代码：

使用 PHP 更新 HTML 表单：

```
<form action="" method="post" enctype="multipart/form-data">
<table class="product_upload_table" cellpadding="0" cellspacing="0" border="0">

<?php
    $select=mysql_query("select * from products_list where id='$id' "); 
    while($row=mysql_fetch_array($select)){     
?>
<select name="product_category[]" id="category" size="5" multiple="multiple">

<option value="Available Stock">Available Stock</option>
    <option value="Black">Black</option>
    <option value="New Arrival">New Arrival</option>
    <option value="Ruffles">Ruffles</option>
    <option value="White">White</option>
</select>
<?php 
}
?>

<div class="button"><input type="submit" name="update" value="Update"/></div>
</form>

</table>

<?php

$product_category = implode("\n", $_POST['product_category']);

if(isset($_POST['update'])){
$update_product=mysql_query("update products_list set category='$product_category'");
}
?> 
```

我不确定这是否足以理解。我还没有开始将 PHP 代码写入列表框，因为我不知道如何开始。

问候，杰夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:29:40.217

> 如何检索并使列表框突出显示选项“一、二、三”和不突出显示选项“四、五”？

```
$data = array('Available Stock', 'Black', 'New Arrival', 'Ruffles', 'White');
echo '<select name="data">;
foreach ($data as $value) {
    echo '<option value="'.htmlentities($value).'";
    if (isset($result[$id])) echo ' selected';
    echo '>'.$value.'</option>';
}
echo '</selected>'; 
```

# sql - 从我的表视图刷新我的查询结果

> ID：11623403
> 
> 赞同：0
> 
> 时间：2012-07-24T02:45:18.390
> 
> 标签：sql, sql-server-2008

```
SET ANSI_NULLS ON
 GO

SET QUOTED_IDENTIFIER ON
 GO

ALTER VIEW [dbo].[pais2k1view]
AS
SELECT DISTINCT 
                  RTRIM(dbo.Gen_info.last) AS LastName, RTRIM(dbo.Gen_info.first) AS         Firstname, RTRIM(dbo.Gen_info.middle) AS Middlename, RTRIM(dbo.Gen_info.rank) AS rank, 
                  RTRIM(dbo.Gen_info.badge_no) AS badge_no, RTRIM(dbo.Gen_info.tin) AS TIN, CONVERT(char(10), dbo.Gen_info.birthdate, 110) AS birthdate, dbo.Gen_info.hair, 
                  dbo.Gen_info.eyes, RTRIM(dbo.Gen_info.blood) AS Blood, dbo.Gen_info.height, dbo.Gen_info.weight, dbo.Gen_info.marks, dbo.dependent.name, 
                  dbo.dependent.address, dbo.dependent.phone_no, dbo.dependent.dep_contact, dbo.dependent.dep_phone, dbo.Gen_info.acct_no, dbo.Gen_info.unit AS RDO_Code, 
                  dbo.Gen_info.fstatus, dbo.dependent.tag1, RTRIM(dbo.Gen_info.first) + ' ' + RTRIM(dbo.Gen_info.middle) + ' ' + RTRIM(dbo.Gen_info.last) AS Fullname, 
                  RTRIM(dbo.Gen_info.last) + RTRIM(dbo.Gen_info.first) AS Photolink, dbo.Unit.abbvr AS unit
FROM         dbo.Gen_info WITH (NOLOCK) LEFT OUTER JOIN
                  dbo.dependent WITH (NOLOCK) ON dbo.Gen_info.link = dbo.dependent.link LEFT OUTER JOIN
                  dbo.Unit WITH (NOLOCK) ON dbo.Gen_info.unit = dbo.Unit.unit
WHERE     (dbo.dependent.fstatus = 0) AND (dbo.dependent.tag1 = 1) AND (dbo.Gen_info.fstatus = 0) 
```

我正在使用 sql management studio，这是我的更改视图，如何在此行中添加刷新命令，以便视图始终反映最新的记录

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:48:26.480

你不必那样做。视图不是表，它们是预定义的查询。

当您从视图中选择时，SQL Server 会在此时执行视图的查询。

您可以通过创建视图、从中进行选择、然后将行添加到基表并再次从视图中进行选择来测试这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:01:29.340

如果您对基础表进行更改，则需要刷新视图以查看反映的更改，但我很确定您不能在 alter 语句中这样做。

```
sp_refreshview [dbo].[pais2k1view] 
```

然后，您可以在对数据库进行更改时手动运行它，也可以将其包含在脚本中，您必须在调用视图查询之前将其自动化。

# mysql - django + 搜索数据库

> ID：11623409
> 
> 赞同：1
> 
> 时间：2012-07-24T02:46:03.660
> 
> 标签：mysql, django, solr

我想让用户能够跨模型中的多个列搜索其他用户`user`。即`first_name`,`last_name`和`email`字段。我现在正在做 MySQL 全文搜索，但我不相信这是我继续进行的正确方法。有人知道 MySQL 全文搜索如何与 Solr 和其他第三方提供商相提并论吗？

我正在将 searchify 和 websolr 视为潜力。但是对于 1 个表跨 3 列进行全文搜索，是否值得？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T04:08:30.007

搜索数据库本身相当慢。推荐的方法是使用搜索引擎，如 Solr、Whoosh 等来生成索引。[Haystack](http://haystacksearch.org/)是一个非常有用的 django 应用程序，它可以让您抽象搜索引擎并在索引时使用模板。

因此，使用模板，您可以拥有如下模板：

```
{{user.first_name}}
{{user. last_name}}
{{user.email}} 
```

它将生成您正在寻找的搜索结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T04:42:01.860

我就是这样做的

```
#search.py
import re

from django.db.models import Q

def normalize_query(query_string,
                    findterms=re.compile(r'"([^"]+)"|(\S+)').findall,
                    normspace=re.compile(r'\s{2,}').sub):
    return [normspace(' ', (t[0] or t[1]).strip()) for t in findterms(query_string)] 

def get_query(query_string, search_fields):
    query = None
    terms = normalize_query(query_string)
    for term in terms:
        or_query = None
        for field_name in search_fields:
            q = Q(**{"%s__icontains" % field_name: term})
            if or_query is None:
                or_query = q
            else:
                or_query = or_query | q
        if query is None:
            query = or_query
        else:
            query = query & or_query
    return query 
```

和观点：

```
# views.py
from django.shortcuts import render_to_response
from django.contrib.auth.models import User

def search(request):
    query = request.GET.get('q', '')
    if query:
        entry_query = get_query(query, ['first_name', 'last_name', 'email'])
        users = User.objects.filter(entry_query).order_by('-pub_date')
    else:
        entries_list = []
    return render_response(request, 'blog/list.html', {'entries': entries_list}) 
```

# sql - SQL：如何使用 where like 组合多列的结果

> ID：11623411
> 
> 赞同：2
> 
> 时间：2012-07-24T02:46:17.090
> 
> 标签：sql

很简单，我想在多列中使用 WHERE LIKE 时合并结果

```
$query = "SELECT T.Id_Servicio ids, 
            C.Nombre cliente, 
            T.T_Atencion atencion, 
            M.Nombre marca, 
            P.Nombre producto, 
            SU.Nombre subproducto, 
            T.Observaciones obs, 
            T.Estado edo
            FROM t_servicio T
            INNER JOIN cat_clientes C ON C.Id = T.Id_Cliente
            INNER JOIN cat_marcas M ON M.Id = T.Marca
            INNER JOIN cat_productos P ON P.Id = T.Producto
            INNER JOIN cat_subproducto SU ON SU.Id = T.SubProducto
            WHERE C.Nombre LIKE '%$termsearch%'
            OR T.T_Atencion LIKE '%$termsearch%'
            OR M.Nombre LIKE '%$termsearch%'
            OR P.Nombre LIKE '%$termsearch%'
            OR SU.Nombre LIKE '%$termsearch%'"; 
```

使用此指令，获取最后一个结果但不合并所有结果，这将是正确的陈述？

希望能帮到我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:53:57.570

使用`INNER JOIN`你只会匹配那些相关的行。如果我猜对了，简单的切换`LEFT JOIN`会让你更快乐。最后，您可能还**需要**声明`GROUP BY`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:40:39.017

Can you try this?

```
SELECT T.Id_Servicio ids, 
            C.Nombre cliente, 
            T.T_Atencion atencion, 
            M.Nombre marca, 
            P.Nombre producto, 
            SU.Nombre subproducto, 
            T.Observaciones obs, 
            T.Estado edo
            FROM t_servicio T
            LEFT JOIN cat_clientes C ON C.Id = T.Id_Cliente
            LEFT JOIN cat_marcas M ON M.Id = T.Marca
            LEFT JOIN cat_productos P ON P.Id = T.Producto
            LEFT JOIN cat_subproducto SU ON SU.Id = T.SubProducto
            WHERE C.Nombre LIKE '%$termsearch%'
            OR T.T_Atencion LIKE '%$termsearch%'
            OR M.Nombre LIKE '%$termsearch%'
            OR P.Nombre LIKE '%$termsearch%'
            OR SU.Nombre LIKE '%$termsearch%' 
```

and what are you comparing to???? I assume that $termsearch is the entire string you want to search in SU.Nombre

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T03:00:38.197

LIKE '%$termsearch%' 应该是 LIKE '%' + @termsearch + '%'

# salesforce - Http* 方法的类型无效：顶点中的 system.RestRequest

> ID：11623413
> 
> 赞同：5
> 
> 时间：2012-07-24T02:46:48.600
> 
> 标签：salesforce, apex-code

您好我正在尝试创建一个 apex 休息服务，但收到错误 Invalid type for Http* method: system.RestRequest

这是我收到此错误的功能。

```
 @RestResource(urlMapping='/v.9/scorecard/*') 
global with sharing class ScorecardRestSvc {

  /**
  * @date July 26, 2011
  * @description Update a question answer. 
  * @return Map<String,String> - results and boolean success message
  */

  @HttpPost
  global Static Map<String,String> doPut(RestRequest req, RestResponse res) {

    String answerId = req.requestURI.substring(req.requestURI.lastIndexOf('/')+1);
    string updateResult = 'Waiting to run';
    Map<String,String> returnMap = new Map<String,String>();
    returnMap.put('Success','True');

    // mark the participant as having no submission
      if(req.params.containsKey('deleteSubmission') && req.params.get('deleteSubmission').toLowerCase() == 'true') {
      markParticipantAsNoSubmission(req,res);
        returnMap.put('Message','Participant marked as no submission.');
        return returnMap;    
      } 

    try {

      if(!isValidId(answerId) || answerId.length() == 0) {
        returnMap.put('Method','Bulk');
        updateResult = updateObjectsFromXml(req,res);     
      } else {
        returnMap.put('Method','Single');
        updateResult = updateSingleAnswer(req,res);
      }

      returnMap.put('Update Result', updateResult);

      if(updateResult != 'All records updated successfully. ' && updateResult != 'All records updated successfully. Survey set to scored. No further changes allowed') {
        returnMap.put('Success','False');
      }     
    } catch(Exception e) {
      returnMap.put('Error',e.getMessage());
    } 

    return returnMap;   
  }

  private static void markParticipantAsNoSubmission(RestRequest req, RestResponse res) { 
    ID participantId = (ID)req.params.get('participantId');
    // get the participant and mark them as no submission
    Challenge_Participant__c cp = [select id, Has_Submission__c from Challenge_Participant__c 
      where id = :participantId];
    cp.Has_Submission__c = false;
    cp.Status__c = 'Submission Rejected';
    update cp;      
  }

  private static String updateObjectsFromXml(RestRequest req, RestResponse res) {

    string returnMessage = 'All records updated successfully. ';

    try {
      String xml = req.requestBody.toString().trim();
      System.debug('===================== here is the xml passed: ' + xml);
      List<sObject> updateList = parseUpdateXML(xml);

      //before we update we need to make sure this card is not scored
      List<QwikScore_Question_Answer__c> thisAns = [select QwikScore_Scorecard__r.Scored__c, QwikScore_Scorecard__c 
        from QwikScore_Question_Answer__c where id = :updateList[0].Id];

      if(thisAns[0].QwikScore_Scorecard__r.Scored__c) throw new customException('This scorecard has been marked as scored. No further updates are available.');

     // ScoringEngine.saveAnswers(thisAns[0].QwikScore_Scorecard__c, updateList);           

      if(req.params.containsKey('setScored') && req.params.get('setScored').toLowerCase() == 'true') {
      //  ScoringEngine.gradeScorecard(thisAns[0].QwikScore_Scorecard__c);
        returnMessage += 'Survey set to scored. No further changes allowed';        
      }

    } catch(Exception e) {
      returnMessage = e.getMessage();
    }

    return returnMessage;
  }

  private static String updateSingleAnswer(RestRequest req, RestResponse res) {

    String answerId = req.requestURI.substring(req.requestURI.lastIndexOf('/')+1);

    // get a map of all field in the member__c custom object
    Map<String, Schema.SObjectField> sObjectFieldsMap = Schema.SObjectType.QwikScore_Question_Answer__c.fields.getMap();
    // don't let them update the following fields -- use all lowercase for comparison
    Set<String> noUpdateFields = new Set<String>{'Answer_Value__c,QwikScore_Scorecard__c,Weighted_Score__c,Answer_Value__c,IsAnswered__c'};

    String returnMessage = 'All records updated successfully. ';

    try {

      QwikScore_Question_Answer__c qa = new QwikScore_Question_Answer__c(Id=id.ValueOf(answerId));

      for (String key : req.params.keySet()) {
        // only add params if they are valid field on the object and not on the no-update list
        if (sObjectFieldsMap.containsKey(key) && !noUpdateFields.contains(key.toLowerCase()))
          qa.put(key,req.params.get(key)); 
      }

      List<QwikScore_Question_Answer__c> thisAns = [select QwikScore_Scorecard__r.Scored__c,
        QwikScore_Scorecard__c from QwikScore_Question_Answer__c where id = :qa.Id];

      if(thisAns.isEmpty()) throw new customException('Could not locate answer with Id' + qa.Id);

      if(thisAns[0].QwikScore_Scorecard__r.Scored__c) throw new customException('This scorecard has been marked as scored. No further updates are available.');

      //ScoringEngine.saveAnswers(thisAns[0].QwikScore_Scorecard__c, new List<QwikScore_Question_Answer__c>{qa});

      if(req.params.containsKey('setScored') && req.params.get('setScored').toLowerCase() == 'true') {
        //ScoringEngine.gradeScorecard(thisAns[0].QwikScore_Scorecard__c);
        returnMessage += 'Scorecard set to scored. No further changes allowed';          
      }

    } catch(Exception e) {
      returnMessage = e.getMessage();
    }

    return returnMessage;     
  }

  /*******************************************
  Used to create a list of sObjects ready for updating from 
  XML data that would likely be passed in a request

  This method is pretty cool actually. You can pass it some XML
  formated in the way outlined previously and it will get you a list
  of objects ready for update. I think they all have to be of the same type
  though.
  *******************************************/
  private static List<sObject> parseUpdateXML(String Xml) {

    Map<Id,sObject> updates = new Map<Id,sObject>();  
    xml = xml.trim();
    Xmlstreamreader reader = new Xmlstreamreader(xml);
    Id lastId;
    string fieldName;
    Map<String, Schema.SObjectType> gd = Schema.getGlobalDescribe();
    Schema.SobjectType oType;

    while (reader.hasNext()) {

      if (reader.getEventType() == XmlTag.START_ELEMENT && reader.getLocalName().toLowerCase() == 'object') {

        if(oType == null) oType = gd.get(reader.getAttributeValueAt(0));

        sObject thisObject;
        if(reader.getAttributeLocalName(1) == 'id') thisObject= oType.newSObject(reader.getAttributeValueAt(1));

        if(thisObject != null) {
          updates.put(thisObject.id,thisObject);
          lastId = thisObject.id;
        }
      } else if(reader.getEventType() == XmlTag.START_ELEMENT && reader.getLocalName().toLowerCase() == 'field') {
        fieldName = reader.getAttributeValueAt(0);
        sObject thisObject = updates.get(lastId);
        reader.next();
        thisObject.put(fieldName,getDecodedString(reader));
        updates.put(thisObject.id,thisObject);  
      }
    reader.next();
    }

    return updates.values();

  }

  /*******************************************
  Test to see if a given string is a valid id
  ********************************************/
  public static Boolean isValidId(String s) {
    Id validId;
    try {
      validId = s;
      return true; 
    } catch (Exception ex) {
      return false;
    }
  } 

  public class customException extends Exception {}

  public static String getDecodedString(Xmlstreamreader reader) {
    return EncodingUtil.urlDecode(reader.getText(), 'UTF-8').trim();
  }

} 
```

谁能告诉我为什么会收到这个错误以及如何纠正它？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T04:59:43.910

在 api 版本 24.0 中访问 RestRequest 和 RestResponse 的方式发生了变化，因此任何 24.0 或更高版本的代码都需要使用新的 RestContext 对象来访问它们：

新方法

```
@HttpPost
global Static Map<String,String> doPut() {
    RestRequest req = RestContext.request;
    RestResponse res = RestContext.response; 
```

老路

```
@HttpPost
global Static Map<String,String> doPut(RestRequest req, RestResponse res) { 
```

# java - 更多关于使用 Android 的线程和进程

> ID：11623416
> 
> 赞同：2
> 
> 时间：2012-07-24T02:47:17.743
> 
> 标签：java, android, multithreading, process, resources

这篇关于什么是线程的[文章](http://www.seti.net/SETINet/Other/Threads/Chap%201/Ch1.htm)首先定义了一个过程读取

“操作系统提供了这种虚拟化。进程执行代码模块。这些可能是不相交的；从某种意义上说，包括 Windows 资源管理器和 Microsoft Word 的可执行代码模块是不相交的。但是，它们也可以共享，例如DLL 的, 其代码通常在许多不同进程的上下文中执行, 通常同时执行. 进程的执行速度或顺序通常是相互独立的: Microsoft word 不会因为打印后台处理程序而停止打开文档目前正在向打印机发送一些东西！”

我解释说这篇文章“只是因为打印后台处理程序正在向打印机发送一些东西！”

我得到一个回复​​，“它不会停止弹出文档，只是因为打印假脱机，因为打开文档和假脱机打印机是不同的过程”

进一步解释说

“是的，基本上两个程序可能正在使用一个 DLL，但它们仍然是独立的进程，因此一个进程可能有多个线程，例如当您转到任务管理器时，您可以查看进程每个进程都可以自己打开 CPU”

我想对此进行更多澄清并得到

“他们只是说 DLL 可以由多个事物同时执行。DLL 的代码通常在许多不同进程的上下文中执行，通常同时这是关键线”

并且“两个进程都使用同一个 DLL（比如说“interpretdocument.dll”）可以同时执行。在许多其他情况下，它们不必等待一个“完成” dll 共享资源的事情会必须这样做。一个不会阻止另一个“

然后我解释说它在技术上不是同时运行，而是翻转

终于到了我没有得到的点：个人回应：

“是的，但如果它这样做了，它不会保留资源，那么打开文档的整个过程必须完成，然后它会释放 DLL，然后打印机可以开始使用它，就像在打开文档时尝试重命名文档一样假设...您正在阅读这本书，而不是我 :)”

我的问题是，这是什么意思“但它不包含资源，资源是 DLL 还是 .doc 文件，为什么要强调？他们共享资源？

# ios - 如何在一个 UIButton 中同时实现开始和停止动作？

> ID：11623420
> 
> 赞同：0
> 
> 时间：2012-07-24T02:48:01.137
> 
> 标签：ios, uibutton

我想要一个 UIButton 像这样工作：首先单击它，运行 start_method；其次点击它，运行stop_method；单击它第三次再次运行 start_method；第四次单击它，再次运行 stop_method。这样的循环。

当我设置按钮时：

```
 [button addTarget:self action:@selector(start_method:)  forControlEvents:UIControlEventTouchDown];
    [button addTarget:self action:@selector(stop_method:)  forControlEvents:UIControlEventTouchDownRepeat]; 
```

每当您单击它时，它都会响应这两个操作。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:49:42.633

向视图控制器添加一个布尔值，并将其设置为 false。然后，当您按下按钮时，检查布尔值，然后翻转它，然后运行 ​​start 或 stop 方法。

# java - Java-同步列表

> ID：11623428
> 
> 赞同：3
> 
> 时间：2012-07-24T02:49:36.627
> 
> 标签：java, arraylist, synchronization

我已经坚持了一段时间，所以非常感谢任何帮助。

我有以下代码部分：

```
BallThread.java
@Override
public synchronized void run() {
  while (numItersCompleted < maxNumIters) {
    completedThisIter = false;
synchronized (ballList) {
    for (Ball b : ballList) { // line 35
        b.updatePosition(ballPanel.getBounds(), ballList);
    }
}
 } // other stuff

Exception in thread "Thread-2" java.util.ConcurrentModificationException
at java.util.ArrayList$SubList.checkForComodification(ArrayList.java:1091)
at java.util.ArrayList$SubList.listIterator(ArrayList.java:972)
at java.util.AbstractList.listIterator(AbstractList.java:300)
at java.util.ArrayList$SubList.iterator(ArrayList.java:968)
at Part2.BallThread.run(BallThread.java:35) 
```

有时我会得到这个（BallPanel 中的第 36 行）

```
java.util.ConcurrentModificationException
at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:782)
at java.util.ArrayList$Itr.next(ArrayList.java:754)
at Part2.BallPanel.paintComponent(BallPanel.java:36)
at javax.swing.JComponent.paint(JComponent.java:1029)
at javax.swing.JComponent.paintToOffscreen(JComponent.java:5138)
at javax.swing.BufferStrategyPaintManager.paint(BufferStrategyPaintManager.java:302)
at javax.swing.RepaintManager.paint(RepaintManager.java:1188)
at javax.swing.JComponent._paintImmediately(JComponent.java:5086)
at javax.swing.JComponent.paintImmediately(JComponent.java:4896)
at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:783)
at javax.swing.RepaintManager.paintDirtyRegions(RepaintManager.java:735) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T02:58:08.107

在没有看到其余代码的情况下，一种解决方法是声明`ballList`如下：

```
private final List<Ball> ballList = Collections.synchronizedList(...); 
```

在每个方法之前尝试对自身进行同步的所有操作，[`synchronizedList`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#synchronizedList%28java.util.List%29)只要您保持当前`synchronized(ballList)`的 s 就位，这将使您的迭代完全安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:59:03.127

在我们可以在这里看到的代码中，`ballList`实际上没有被修改并且使用多个线程读取是安全的。其他一些代码可能正在修改`ballList`（上面的@pst 指出它可能是`updatePosition`）。

`run`and`paintComponent`方法看起来也不需要同步，因为它们没有在外部共享状态（因为您正在代码的相关部分进行同步）`ballList`。

编辑：

根据您的编辑，看起来`processCollisions`只有`ballsLocal`一个短块同步，而`ballsLocal`不是实际上没有被修改的时间

```
synchronized (ballsLocal) {             
  initialSize = ballsLocal.size();
} 
```

虽然`processCollisions`是同步的，但隐式同步于`this`. 如果您的方法只使用`synchronized`关键字而不指定要同步的内容在不同的类中，则`this`同步的对象是不同的。如果您需要像这样在不同的类之间进行同步，那么球类应该处理同步，或者您需要一个共享的锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T03:28:44.523

在您的`processCollisions()`中，您将对象添加到同步块之外的列表中。请注意，似乎只有一行是同步的，即获取大小的行，但稍后（接近尾声）您要添加到列表中*。*在循环完成之前，您不需要关闭同步块。

# iphone - 我需要使用换行符从文本字段或文本视图中获取文本

> ID：11623432
> 
> 赞同：0
> 
> 时间：2012-07-24T02:50:03.397
> 
> 标签：iphone, xcode, uitextfield, uitextview

我需要从用户输入文本字段或文本视图中获取文本。我制作了矩形并将文本绘制到矩形中。代码如下。

```
CGRect a = CGRectMake(0,500,2400,100);
[textfield.text drawInRect:a 
                  withFont:font 
                  lineBreakMode:UILineBreakModeWordWrap 
                  alignment:UITextAlignmentLeft]; 
```

问题是如果用户输入的文本太长，[drawInRect] 只会像 ... 一样绘制或剪切句子的中间。如果用户输入长句子，我想制作双线，但如果很长，linebreakmode 似乎会忽略后面的文本。我需要做什么才能获得全文？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T05:10:37.343

做这个：

```
 CGSize maximumSize = CGSizeMake(textfield.frame.size.width, 1000); //here 1000 for maximum height u can increase this if u want
 CGSize strSize = [textfield.text sizeWithFont:textfield.font constrainedToSize:maximumSize lineBreakMode:UILineBreakModeWordWrap];
 CGRect newframe = CGRectMake(0, 0, strSize.width, strSize.height);
 [textfield.text drawInRect:newframe 
                  withFont:textfield.font 
             lineBreakMode:UILineBreakModeWordWrap 
                 alignment:UITextAlignmentLeft]; 
```

# java - JSP 中的表单认证

> ID：11623433
> 
> 赞同：0
> 
> 时间：2012-07-24T02:50:08.773
> 
> 标签：java, forms, jsp, jsp-tags, form-authentication

我想在我的 JSP 网站中设置表单身份验证`without creating any folder`。有人可以建议如何做到这一点。? 谢谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T05:19:25.430

使用 Servlet 身份验证功能。它使用 JAAS 安全性，由 Tomcat、Websphere、Glassfish 等大多数 Servlet 容器实现。

[看这里的例子](https://stackoverflow.com/questions/11182356/standard-form-authentification-java-servlets/11183774#11183774)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:34:24.367

在 web.xml 中添加 login-config 部分。这是示例用法，

```
 <login-config>
      <auth-method>FORM</auth-method>
      <form-login-config>
      <form-login-page>/login.jsp</form-login-page>
      <form-error-page>/fail_login.html</form-error-page>
      </form-login-config>
    </login-config> 
```

如果您想了解基于表单的身份验证的详细信息，请查看[此](http://docs.oracle.com/cd/E19798-01/821-1841/bncby/index.html)。

# c# - 数据网格单元格单击事件

> ID：11623434
> 
> 赞同：2
> 
> 时间：2012-07-24T02:50:22.817
> 
> 标签：c#, .net, wpf, xaml, datagrid

```
<UserControl x:Class="DDCUI.CommDiagnosisWPFCtrl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" Height="800" Width="300">
    <StackPanel>
        <DataGrid MinHeight="300" MaxHeight="600" AutoGenerateColumns="False" Name="DGComm" CanUserResizeColumns="True" IsReadOnly="True" ItemsSource="{Binding Source=dataGridRows}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="No." Binding="{Binding Number}" Width="0.1*"/>
                <DataGridTextColumn Header="Time" Binding="{Binding Time}" Width="0.1*" />
                <DataGridTextColumn Header="Protocol" Binding="{Binding Protocol}" Width="0.15*" />
                <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="0.15*" />
                <DataGridTextColumn Header="Destination" Binding="{Binding Destination}" Width="0.15*" />
                <DataGridTextColumn Header="Data" Binding="{Binding Data}" Width="0.5*" />
            </DataGrid.Columns>
        </DataGrid>
        <RichTextBox Height="150" Name="RtbHexCode"/>
        <TreeView  Height="200" Name="TreeViewDecode"/>

    </StackPanel>
</UserControl> 
```

```
private void DGComm_SelectedCellsChanged(object sender, SelectedCellsChangedEventArgs e)
{
    //e.AddedCells[0].Column
    IList<DataGridCellInfo> cells = e.AddedCells;
    foreach (DataGridCellInfo di in cells)
    {
        DataRowView dvr = (DataRowView)di.Item;
        MessageBox.Show(di.ToString());
    }
} 
```

我希望能够操作选定的单元格。我正在尝试打印单击的单元格的名称，但它在 DataRowView dvr = (DataRowView)di.Item; 上引发了无效的强制转换异常；说明我无法将 DataSource 转换为 RowView。

我该如何解决这个问题？

编辑：Itemsources 由提供

```
public ObservableCollection<object> dataGridRows = new ObservableCollection<object>();

private void InitProtocolParsers()
        {
            DGComm.ItemsSource = dataGridRows; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T06:24:03.927

您访问的对象`di.Item`不是类型`DataRowView`，而是您绑定到的实际业务对象。因此，您放入的任何内容`ObservableCollection<object>`都可以通过`di.Item"`.

试试看嘛

```
MessageBox.Show(di.Item.ToString()) 
```

我希望这会变得更清楚。

# c# - c#根据变量内容调用方法

> ID：11623436
> 
> 赞同：1
> 
> 时间：2012-07-24T02:50:29.217
> 
> 标签：c#

如何根据变量的内容调用方法

前任。

```
String S = "Hello World";
String Format = "ToUpper()";

String sFormat = s.Format;

resulting in "HELLO WORLD" 
```

这样我可以在其他时间通过`Format = "ToLower()"`或 Format = "Remove(1,4)" 删除从 pos 1 开始的 4 个字符 - 简而言之，我希望能够调用任何字符串方法。

有人可以发布一个完整的工作解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:54:55.823

解决方案的症结需要你使用反射来定位所需的方法。这是一个涵盖您的情况的简单示例；

```
private string DoFormat(string data, string format)
{
    MethodInfo mi = typeof (string).GetMethod(format, new Type[0]);
    if (null == mi)
        throw new Exception(String.Format("Could not find method with name '{0}'", format));

    return mi.Invoke(data, null).ToString();
} 
```

您可以使该方法更通用，以接受您要调用的方法的参数，如下所示。请注意调用 .GetMethod 和 .Invoke 以传递所需参数的方式的变化。

```
private static string DoFormat(string data, string format, object[] parameters)
{
    Type[] parameterTypes = (from p in parameters select p.GetType()).ToArray();

    MethodInfo mi = typeof(string).GetMethod(format, parameterTypes);
    if (null == mi)
        throw new Exception(String.Format("Could not find method with name '{0}'", format));

    return mi.Invoke(data, parameters).ToString();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:56:54.577

您可以通过反射来做到这一点，但是代码变得难以阅读，并且类型安全性消失了。

C# 提供了一种更好的机制来传递可执行代码 - 即委托。

你可以这样做：

```
void ShowConverted(string str, Func<string,string> conv) {
    Console.WriteLine("{0} -- {1}", str, conv(str));
}

Func<string,string> strAction1 = (s) => s.ToUpper();
Func<string,string> strAction2 = (s) => s.ToLower();
ShowConverted("Hello, world!", stringAction1);
ShowConverted("Hello, world!", stringAction2); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T02:57:20.533

您可以使用反射从字符串类型中提取 ToLower() 方法。

```
 string format = "Hello World";
  MethodInfo methodInfo = typeof(string).GetMethod("ToLower");
  string result = methodInfo.Invoke(format,null); 
```

我可能把语法弄乱了一点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T02:54:36.030

为什么不直接使用这些方法。

```
Func<string, string> format = s = > s.ToUpper(); 
```

然后你可以做

```
format = s = > s.ToLower(); 
```

否则，您将不得不使用反射，这不安全并且可能更慢。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T02:55:30.413

你可以在这里使用反射。看看`MethodInfo`课堂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-24T02:56:33.657

像这样的东西会起作用，但我面前没有编译器来验证。

像这样使用它：

```
var result = someObject.CallParameterlessMethod("ToUpper");

public static class ObjectExtensionMethods
{
  public static object CallParameterlessMethod(this object obj, string methodName)
  {
    var method = typeof(obj).GetMethod(methodName);
    return method.Invoke(obj,null);
  }
} 
```

# php - PHP/MySQL 查询错误？

> ID：11623439
> 
> 赞同：0
> 
> 时间：2012-07-24T02:51:09.343
> 
> 标签：php, mysql, database

页面在这里：[http ://www.arkmediainc.com/ark20test/ark20test/portfolio.php](http://www.arkmediainc.com/ark20test/ark20test/portfolio.php)

```
$result = mysql_query(
    "SELECT * FROM foliobro WHERE itemid >= ".$startid." LIMIT 9"
);

while($row = mysql_fetch_array($result))
{

     $itemid = $row['itemid'];
     $thumb_desc = $row['thumb_desc'];
     $title = $row['title'];
     $category = $row['category'];
     ...
} 
```

我得到这个错误代码：

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, 
boolean given in /home/arkmedia/public_html/ark20test/ark20test/portfolio.php 
on line 49 
```

49 号线实际上就是那条`while($row = mysql_fetch_array($result))`线。

我正在尝试获得以下 9 个结果，或者（id 从 1-11，未来扩展）1-9，或者 10-11+ 我的查询出了什么问题，因为我怀疑查询运行不正常。该查询直接来自 phpMyAdmin，所以我不明白为什么它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T02:54:51.987

将您的代码更改为：

```
$result = mysql_query("SELECT * FROM foliobro WHERE itemid >= ".$startid." LIMIT 9");

if (!$result) {
    die(mysql_error());
} 
```

您的查询失败，并且您将无效结果传递给`mysql_fetch_array`.

检查右侧边栏是否有重复的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T02:57:07.793

来自 PHP 文档：

```
For SELECT, SHOW, DESCRIBE, EXPLAIN and other statements returning 
resultset, mysql_query() returns a resource on success, or FALSE on error.

For other type of SQL statements, INSERT, UPDATE, DELETE, DROP, etc,
mysql_query() returns TRUE on success or FALSE on error.

The returned result resource should be passed to mysql_fetch_array(), and
other functions for dealing with result tables, to access the returned data.

Use mysql_num_rows() to find out how many rows were returned for a SELECT
statement or mysql_affected_rows() to find out how many rows were affected 
by a DELETE, INSERT, REPLACE, or UPDATE statement.

mysql_query() will also fail and return FALSE if the user does not have 
permission to access the table(s) referenced by the query. 
```

因此，当您收到错误时，它会返回 false，这可能是 SQL 错误，但鉴于查询的简单性，这似乎不太可能，因此我会尝试确保您的权限设置正确。

顺便说一句，请不要使用 mysql_*，使用 PDO 或 mysqli。mysql_* 已弃用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T02:56:54.767

如果没有更多信息，我的猜测是您的`$startid`变量在您运行查询时为空 - 或者您输入了表名。

运行这个：

```
$sql = "SELECT * FROM foliobro WHERE itemid >= ".$startid." LIMIT 9;";
echo $sql;
$result = mysql_query($sql); 
```

并查看您在运行查询时是否定义了变量/不为空

# iphone - 核心数据父子UITableView关系

> ID：11623441
> 
> 赞同：0
> 
> 时间：2012-07-24T02:51:57.810
> 
> 标签：iphone, objective-c, ios, cocoa-touch, core-data

我正在尝试创建父子核心数据关系。`TableViewA`包含汽车制造商并`TableViewB`包含所选制造商制造的汽车。**我想过滤汽车，以便它们只显示在制造商的表格视图中。**我的这个工作得很好，但是当我在一个制造商表格视图中添加汽车时，它会在添加它的制造商表格视图中正确显示，但在所有其他制造商表格视图中，单元格仅显示其默认标签（“单元格”）用于其他制造商表视图中添加的汽车数量。这是我的`tableView:cellForRowAtIndexPath:`方法`TableViewB`：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Car Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    Car *car = [self.fetchedResultsController objectAtIndexPath:indexPath];

    if (car.manufacturer == self.currentManufacturer) {

            cell.textLabel.text = car.carName;
    }

    return cell;
} 
```

请解释如何在 Core Data 中正确过滤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T02:59:53.063

选择制造商时，您需要修改分配给获取结果控制器的谓词。

# css - 取决于操作系统的条件 CSS

> ID：11623444
> 
> 赞同：1
> 
> 时间：2012-07-24T02:52:30.163
> 
> 标签：css, fonts, conditional-comments

我知道浏览器有条件 CSS，但我很想看看操作系统是否有条件 CSS。这是我的动机：

我通过 CSS3 使用自定义字体开发了一个网站。该字体在 Mac OSX 上运行的所有浏览器上看起来很漂亮，但在 Windows 上运行的所有浏览器上看起来很可怕。我知道这是因为 OSX 和 Windows 以不同的方式呈现字体。

作为此问题的临时解决方案，我希望 Windows 浏览器上的所有用户使用替代 CSS 文件，其中不会使用自定义字体 - 而是恢复为像 Helvetica 这样的系统字体。

任何人有任何想法如何做到这一点？

或者如果没有，有没有办法让字体在 Windows 上看起来更好？我试过了

```
-webkit-font-smoothing: antialiased; 
```

无济于事。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-24T03:13:27.323

这看起来是个不错的[选择](http://www.stoimen.com/blog/2009/07/16/jquery-browser-and-os-detection-plugin/)。这是一个基于 jquery 的解决方案。检测到操作系统后，您可以像这样添加 css：（从[此处](https://stackoverflow.com/questions/5680657/adding-css-file-with-jquery)获取代码）

```
$('head').append('<link rel="stylesheet" href="os-windows.css" type="text/css" />'); 
```

# marker - 地理编码器放置标记后如何创建信息窗口

> ID：11623448
> 
> 赞同：2
> 
> 时间：2012-07-24T02:52:55.013
> 
> 标签：marker, infowindow

嗨，我对 Google Maps APi 还很陌生。

我创建了一个对地址进行地理编码并绘制标记的脚本。

我想在标记位置添加一个信息窗口，其中包含用户在地址字段中输入的地址。

我遇到了信息窗口未显示的问题，也许它在脚本中的错误位置。

你能看一下吗。

这是我的脚本，谢谢你的帮助

```
<script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script>

 var geocoder;
 var map;

 //set the map center
   function initialize() {
 geocoder = new google.maps.Geocoder();
 var latlng = new google.maps.LatLng(43.6481, -79.4042);
 var mapOptions = {
  zoom: 8,
  center: latlng,
  mapTypeId: google.maps.MapTypeId.ROADMAP
 }
  map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
 }

// Creating an InfoWindow          
var infowindow = new google.maps.InfoWindow({});

//on click of the drop the dot button, place a marker
 function codeAddress() {
var address = document.getElementById("address").value;
geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {
    map.setCenter(results[0].geometry.location);

    var marker = new google.maps.Marker({
        map: map,
        position: results[0].geometry.location
        title: address
    });

    // Adding a click event to the marker
        google.maps.event.addListener(marker, 'click', function() {
            infowindow.setContent('address');
            infowindow.open(map, this);
        }); 
   } else {
    alert("Geocode was not successful for the following reason: " + status);
   }
 });

});

</script>
</head>
<body onload="initialize()">

<div id="map_canvas" style="height:800px;width:1000px"></div>

<div>
    <input id="address" type="textbox" value="Type the address here">
    <input type="button" value="Drop the dot" onclick="codeAddress()">
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T10:17:52.660

在为javascript错误调整了一些东西之后，它对我有用：

```
<script>

 var geocoder;
 var map;

 //set the map center
   function initialize() {
 geocoder = new google.maps.Geocoder();
 var latlng = new google.maps.LatLng(43.6481, -79.4042);
 var mapOptions = {
  zoom: 8,
  center: latlng,
  mapTypeId: google.maps.MapTypeId.ROADMAP
 }
  map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
 }

// Creating an InfoWindow          
var infowindow = new google.maps.InfoWindow({});

//on click of the drop the dot button, place a marker
 function codeAddress() {
var address = document.getElementById("address").value;
geocoder.geocode( { 'address': address}, function(results, status) {
  if (status == google.maps.GeocoderStatus.OK) {
    map.setCenter(results[0].geometry.location);

    var marker = new google.maps.Marker({
        map: map,
        position: results[0].geometry.location,
        title: address
    });

    // Adding a click event to the marker
        google.maps.event.addListener(marker, 'click', function() {
            infowindow.setContent('address');
            infowindow.open(map, this);
        }); 
   } else {
    alert("Geocode was not successful for the following reason: " + status);
   }
 });

}

</script> 
```

# c++ - 命名空间中的静态变量与非静态变量

> ID：11623451
> 
> 赞同：56
> 
> 时间：2012-07-24T02:53:10.573
> 
> 标签：c++, static, namespaces

我有一个`foo`包含整数的命名空间`bar`，声明如下...

富.h：

```
namespace foo {
    int bar;
} 
```

现在，如果我`foo.h`只包含在一个文件中，这工作得很好。但是当我包含两个或多个文件时会出现问题`foo.h`：我收到链接器错误。我发现如果我声明`bar`为`static`，我可以包含`foo.h`在多个文件中。这对我来说似乎很奇怪，因为我不知道可以在命名空间内声明一个静态变量。（那有什么意思？）

为什么这行得通？更重要的是，为什么**没有**它就*不能* `static`工作？在 a 中使用时是什么`static`意思`namespace`？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-07-24T02:56:45.433

`static`在不同的上下文中有多种含义。在这个特定的上下文中，这意味着变量具有内部链接，因此包含该标题的每个翻译单元都将拥有自己的变量副本。

请注意，虽然这将使链接器错误保持沉默，但它会`foo::bar`为生成的每个目标文件维护一个单独的变量（更改在不同的目标文件中不可见）。

如果你想要一个变量，你应该`extern`在标题中声明它，并在一个翻译单元中提供一个定义。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-07-24T02:55:55.857

当您将变量声明为`static`时，这意味着它的**范围仅限于给定的翻译单元**。没有`static`范围是全局的。

当您`static`在 .h 文件中声明一个变量（在或没有`namespace`; 无关紧要），并将该头文件包含在各种 .cpp 文件中时，该`static`变量将成为每个`.cpp`文件的本地范围。
所以现在，每个包含该标头的 .cpp 文件都将拥有该变量的自己的副本。

如果没有`static`关键字，编译器将只生成该变量的一个副本，因此一旦您将头文件包含在多个 .cpp 文件中，链接器就会抱怨多个定义。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-07-24T02:59:11.477

问题是由变量的多个定义引起的。不同翻译单元中的定义相互冲突，就像多个非内联函数定义不起作用一样。

当您将变量设为静态时，您将赋予变量内部链接，因此每个翻译单元都有自己的独立副本。

您可能真正想要的只是将声明放在头文件中（使用 extern），然后将定义放在实现文件中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-29T14:20:53.013

另请注意，默认情况下`const int`，C++ 中的命名空间（全局）范围已`static`隐式添加：[Define constant variables in C++ header](https://stackoverflow.com/questions/12042549/define-constant-variables-in-c-header/53541011#53541011)

为了更好地理解发生了什么，`readelf`在编译的中间 ELF 目标文件上做一个，你会清楚地看到符号是否定义了两次。这是一个详细的示例：[“静态”在 C 中是什么意思？](https://stackoverflow.com/questions/572547/what-does-static-mean-in-c/14339047#14339047)

# cassandra - Cassandra 按键排序 (TimeUUID)

> ID：11623457
> 
> 赞同：0
> 
> 时间：2012-07-24T02:54:28.897
> 
> 标签：cassandra, pycassa, timeuuid

`get_range()`调用列族时，我无法按键排序。

*   键是 TimeUUID
*   关键验证类是 org.apache.cassandra.db.marshal.TimeUUIDType
*   分区器是“ByteOrderedPartitioner”

但是，当我调用 get_range() 时，结果不会以正确的顺序返回。关于我在这里可能做错的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T23:15:22.130

ByteOrderedPartitioner 顾名思义，按字节排序。由于版本 1 uuid 的“时间”组件不是第一个字节，因此这与 TimeUUID 排序不同。

我建议阅读 Cassandra 中的时间序列建模：[http](http://rubyscale.com/blog/2011/03/06/basic-time-series-with-cassandra/) ://rubyscale.com/blog/2011/03/06/basic-time-series-with-cassandra/和[http://www.datastax.com/dev/博客/高级时间序列与 cassandra](http://www.datastax.com/dev/blog/advanced-time-series-with-cassandra)

# php - PHP使用盐+加密登录

> ID：11623458
> 
> 赞同：1
> 
> 时间：2012-07-24T02:54:30.837
> 
> 标签：php, encryption, hash, salt

问题是我只是想用这个脚本登录，唯一可以让它工作的时候是如果我根据提供的用户名从数据库中检索盐分并手动输入散列密码。整个问题的奇怪之处在于，这正是我在我制作的另一个网站上执行此操作的确切方式，并且它完美无缺。发生的事情是它使页面空白，甚至不显示错误。如果有人有解决方案，我会很高兴听到他们或有关更好方法的建议。

```
<?php
include 'includes/calendar-functions.php';
//user login
if(isset($_POST['membership_id']) && isset($_POST['user_password']) && $_POST['membership_id'] != "" && $_POST['user_password'] != "" ) {
    //Setting up VARS
    $newUsername = mysql_real_escape_string($_POST['membership_id']);
    $newPassword = mysql_real_escape_string($_POST['user_password']);
    $saltQuery = 'SELECT `salt` FROM `vintage_user` WHERE membership_id = '.$newUsername;
    $resultSalt = mysql_query($saltQuery, $connect) or die( mysql_error() );

    while ($row = mysql_fetch_assoc($resultSalt)) {
        $salt = $row["salt"];
    }

    $saltedPW =  $newPassword . $salt;
    $hashedPW = hash('sha256', $saltedPW);

    // QUERYING DB FOR USERNAME AND PASSWORD
    $query = 'SELECT *
        FROM vintage_user
        WHERE membership_id = "'.$newUsername.'"
        AND user_password = "'.$hashedPW.'"
        AND approved = "1"
        LIMIT 1';
    $result = mysql_query( $query, $mysql ) or die( mysql_error() );

    if( mysql_num_rows( $result ) == 1 ) {
        list( $_SESSION['user_first'],
            $_SESSION['user_last'],
            $_SESSION['user_id'],
            $_SESSION['user_email'],
            $_SESSION['membership_id'] ) = mysql_fetch_row( $result );
        header( 'location:'.'calendar.php?m='.$month.'d=1&y='.$year );
        die();
    }
    else {
        echo '<p class="incorrect">Incorrect login and/or password</p>';
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:58:49.703

如果启用了magic_quotes_gpc，首先将stripslashes() 应用于数据。对已经转义的数据使用此函数将两次转义数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-01T17:27:59.120

试试河豚加密方法，它对我有用。

函数.php

```
<?php
 include_once("Blowfish.php");
   function Eencrypt($cipher, $plaintext){
      $ciphertext = "";
      $paddedtext = maxi_pad($plaintext);
      $strlen = strlen($paddedtext);
      for($x=0; $x< $strlen; $x+=8){
         $piece = substr($paddedtext,$x,8);
         $cipher_piece = $cipher->encrypt($piece);
         $encoded = base64_encode($cipher_piece); 
         $ciphertext = $ciphertext.$encoded;       
      }
   return $ciphertext;  
   }

   function Edecrypt($cipher,$ciphertext){
      $plaintext = "";
      $chunks = explode("=",$ciphertext);
      $ending_value = count($chunks) ;
      for($counter=0 ; $counter < ($ending_value-1) ; $counter++)
      {
            $chunk = $chunks[$counter]."=";
            $decoded = base64_decode($chunk);
            $piece = $cipher->decrypt($decoded);
            $plaintext = $plaintext.$piece;
      }
      return $plaintext;
   }

   function maxi_pad($plaintext){
      $str_len = count($plaintext);
      //plain text must be div by 8
      $pad_len = $str_len % 8;
      for($x=0; $x<$pad_len; $x++){
         $plaintext = $plaintext." ";
      }

      $str_len = count($plaintext);
      if($str_len % 8){
         print "padding function is not working\n";
      }else{
         return $plaintext;
      }
      return (-1);
   }
?> 
```

河豚.php

```
<?php
/* vim: set expandtab tabstop=4 shiftwidth=4 softtabstop=4: */

/**
 * Crypt_Blowfish allows for encryption and decryption on the fly using
 * the Blowfish algorithm. Crypt_Blowfish does not require the mcrypt
 * PHP extension, it uses only PHP.
 * Crypt_Blowfish support encryption/decryption with or without a secret key.
 *
 *
 * PHP versions 4 and 5
 *
 * LICENSE: This source file is subject to version 3.0 of the PHP license
 * that is available through the world-wide-web at the following URI:
 * http://www.php.net/license/3_0.txt.  If you did not receive a copy of
 * the PHP License and are unable to obtain it through the web, please
 * send a note to license@php.net so we can mail you a copy immediately.
 *
 * @category   Encryption
 * @package    Crypt_Blowfish
 * @author     Matthew Fonda <mfonda@php.net>
 * @copyright  2005 Matthew Fonda
 * @license    http://www.php.net/license/3_0.txt  PHP License 3.0
 * @version    CVS: $Id: Blowfish.php,v 1.81 2005/05/30 18:40:36 mfonda Exp $
 * @link       http://pear.php.net/package/Crypt_Blowfish
 */

require_once 'PEAR.php';

/**
 *
 * Example usage:
 * $bf = new Crypt_Blowfish('some secret key!');
 * $encrypted = $bf->encrypt('this is some example plain text');
 * $plaintext = $bf->decrypt($encrypted);
 * echo "plain text: $plaintext";
 *
 *
 * @category   Encryption
 * @package    Crypt_Blowfish
 * @author     Matthew Fonda <mfonda@php.net>
 * @copyright  2005 Matthew Fonda
 * @license    http://www.php.net/license/3_0.txt  PHP License 3.0
 * @link       http://pear.php.net/package/Crypt_Blowfish
 * @version    @package_version@
 * @access     public
 */
class Crypt_Blowfish
{
    /**
     * P-Array contains 18 32-bit subkeys
     *
     * @var array
     * @access private
     */
    var $_P = array();

    /**
     * Array of four S-Blocks each containing 256 32-bit entries
     *
     * @var array
     * @access private
     */
    var $_S = array();

    /**
     * Mcrypt td resource
     *
     * @var resource
     * @access private
     */
    var $_td = null;

    /**
     * Initialization vector
     *
     * @var string
     * @access private
     */
    var $_iv = null;

    /**
     * Crypt_Blowfish Constructor
     * Initializes the Crypt_Blowfish object, and gives a sets
     * the secret key
     *
     * @param string $key
     * @access public
     */
    function Crypt_Blowfish($key)
    {
        if (extension_loaded('mcrypt')) {
            $this->_td = mcrypt_module_open(MCRYPT_BLOWFISH, '', 'ecb', '');
            $this->_iv = mcrypt_create_iv(8, MCRYPT_RAND);
        }
        $this->setKey($key);
    }

    /**
     * Deprecated isReady method
     *
     * @return bool
     * @access public
     * @deprecated
     */
    function isReady()
    {
        return true;
    }

    /**
     * Deprecated init method - init is now a private
     * method and has been replaced with _init
     *
     * @return bool
     * @access public
     * @deprecated
     * @see Crypt_Blowfish::_init()
     */
    function init()
    {
        $this->_init();
    }

    /**
     * Initializes the Crypt_Blowfish object
     *
     * @access private
     */
    function _init()
    {
        $defaults = new Crypt_Blowfish_DefaultKey();
        $this->_P = $defaults->P;
        $this->_S = $defaults->S;
    }

    /**
     * Enciphers a single 64 bit block
     *
     * @param int &$Xl
     * @param int &$Xr
     * @access private
     */
    function _encipher(&$Xl, &$Xr)
    {
        for ($i = 0; $i < 16; $i++) {
            $temp = $Xl ^ $this->_P[$i];
            $Xl = ((($this->_S[0][($temp>>24) & 255] +
                            $this->_S[1][($temp>>16) & 255]) ^
                            $this->_S[2][($temp>>8) & 255]) +
                            $this->_S[3][$temp & 255]) ^ $Xr;
            $Xr = $temp;
        }
        $Xr = $Xl ^ $this->_P[16];
        $Xl = $temp ^ $this->_P[17];
    }

    /**
     * Deciphers a single 64 bit block
     *
     * @param int &$Xl
     * @param int &$Xr
     * @access private
     */
    function _decipher(&$Xl, &$Xr)
    {
        for ($i = 17; $i > 1; $i--) {
            $temp = $Xl ^ $this->_P[$i];
            $Xl = ((($this->_S[0][($temp>>24) & 255] +
                            $this->_S[1][($temp>>16) & 255]) ^
                            $this->_S[2][($temp>>8) & 255]) +
                            $this->_S[3][$temp & 255]) ^ $Xr;
            $Xr = $temp;
        }
        $Xr = $Xl ^ $this->_P[1];
        $Xl = $temp ^ $this->_P[0];
    }

    /**
     * Encrypts a string
     *
     * @param string $plainText
     * @return string Returns cipher text on success, PEAR_Error on failure
     * @access public
     */
    function encrypt($plainText)
    {
        if (!is_string($plainText)) {
            PEAR::raiseError('Plain text must be a string', 0, PEAR_ERROR_DIE);
        }

        if (extension_loaded('mcrypt')) {
            return mcrypt_generic($this->_td, $plainText);
        }

        $cipherText = '';
        $len = strlen($plainText);
        $plainText .= str_repeat(chr(0),(8 - ($len%8))%8);
        for ($i = 0; $i < $len; $i += 8) {
            list(,$Xl,$Xr) = unpack("N2",substr($plainText,$i,8));
            $this->_encipher($Xl, $Xr);
            $cipherText .= pack("N2", $Xl, $Xr);
        }
        return $cipherText;
    }

    /**
     * Decrypts an encrypted string
     *
     * @param string $cipherText
     * @return string Returns plain text on success, PEAR_Error on failure
     * @access public
     */
    function decrypt($cipherText)
    {

        if (!is_string($cipherText)) {
            PEAR::raiseError('Chiper text must be a string', 1, PEAR_ERROR_DIE);
        }

        if (extension_loaded('mcrypt')) {
            return mdecrypt_generic($this->_td, $cipherText);
        }

        $plainText = '';
        $len = strlen($cipherText);
        $cipherText .= str_repeat(chr(0),(8 - ($len%8))%8);
        for ($i = 0; $i < $len; $i += 8) {
            list(,$Xl,$Xr) = unpack("N2",substr($cipherText,$i,8));
            $this->_decipher($Xl, $Xr);
            $plainText .= pack("N2", $Xl, $Xr);
        }
        return $plainText;
    }

    /**
     * Sets the secret key
     * The key must be non-zero, and less than or equal to
     * 56 characters in length.
     *
     * @param string $key
     * @return bool  Returns true on success, PEAR_Error on failure
     * @access public
     */
    function setKey($key)
    {
        if (!is_string($key)) {
            PEAR::raiseError('Key must be a string', 2, PEAR_ERROR_DIE);
        }

        $len = strlen($key);

        if ($len > 56 || $len == 0) {
            PEAR::raiseError('Key must be less than 56 characters and non-zero. Supplied key length: ' . $len, 3, PEAR_ERROR_DIE);
        }

        if (extension_loaded('mcrypt')) {
            mcrypt_generic_init($this->_td, $key, $this->_iv);
            return true;
        }

        require_once 'Blowfish/DefaultKey.php';
        $this->_init();

        $k = 0;
        $data = 0;
        $datal = 0;
        $datar = 0;

        for ($i = 0; $i < 18; $i++) {
            $data = 0;
            for ($j = 4; $j > 0; $j--) {
                    $data = $data << 8 | ord($key{$k});
                    $k = ($k+1) % $len;
            }
            $this->_P[$i] ^= $data;
        }

        for ($i = 0; $i <= 16; $i += 2) {
            $this->_encipher($datal, $datar);
            $this->_P[$i] = $datal;
            $this->_P[$i+1] = $datar;
        }
        for ($i = 0; $i < 256; $i += 2) {
            $this->_encipher($datal, $datar);
            $this->_S[0][$i] = $datal;
            $this->_S[0][$i+1] = $datar;
        }
        for ($i = 0; $i < 256; $i += 2) {
            $this->_encipher($datal, $datar);
            $this->_S[1][$i] = $datal;
            $this->_S[1][$i+1] = $datar;
        }
        for ($i = 0; $i < 256; $i += 2) {
            $this->_encipher($datal, $datar);
            $this->_S[2][$i] = $datal;
            $this->_S[2][$i+1] = $datar;
        }
        for ($i = 0; $i < 256; $i += 2) {
            $this->_encipher($datal, $datar);
            $this->_S[3][$i] = $datal;
            $this->_S[3][$i+1] = $datar;
        }

        return true;
    }

}

?> 
```

例子.php

```
<?php

   include_once('functions.php');
   include_once('blowfish.php');

   //NOTE: This is the key or password for encrypting your files.
   // THIS MUST BE 8 CHARACTERS
   $key = "12345678";

   //This is the text to be encrypted
   $plaintext = "stringtoencrypt";

   //This is a blowfish cipher object
   $cipher = new Crypt_Blowfish($key); 

   //This is the encrypted text
   $ciphertext = Eencrypt($cipher,$plaintext);
   $ciphertext = $plaintext;

   print $ciphertext."</br>"; 

   //If the var to decrypt is sent by $_GET
   $key = "";
   $url = explode(" ",$_GET['key']);      
   for ($i=0; $i < count($url)-1; $i++) { 
      @$key .= $url[$i]."+";
   }
   $key = $key.array_pop($url);

   //This is the Decrypted text.
   $desencriptado = Edecrypt($cipher, $key);  

   print "desencriptado es: ".$desencriptado;    
?> 
```

# python - win32com.client.Dispatch 有效，但 win32com.client.gencache.EnsureDispatch 无效

> ID：11623461
> 
> 赞同：4
> 
> 时间：2012-07-24T02:54:43.110
> 
> 标签：python, outlook, pywin32, win32com, dispatch

我正在为 python 学习 win32com，我遇到了一个奇怪的问题。

我正在尝试在字典列表中导出 Outlook 联系人。我的代码与 win32com.client.Dispatch("Outlook.Application) 完美配合。但它返回 0 个与 win32com.client.gencache.EnsureDispatch("Outlook.Application) 的联系人，这应该是更快和“更安全”。这是我的代码：

```
class MapiImport():
    def __init__(self):
        self.olApp = win32com.client.Dispatch("Outlook.Application")
        self.namespace = self.olApp.GetNamespace(u"MAPI")
        # olFolderContacts = 10 :
        self.mapiContacts = self.namespace.GetDefaultFolder(10).Items

    def getContacts(self, *fields):
        contacts = []
        # Class == 40 is ContactItem
        # Class == 69 is DistListItem
        # Exclude ditribution list and others objects != ContactItem
        for contact in filter(lambda x: x.Class == 40,self.mapiContacts) :
            if not fields :
                ctact = dict((x.Name,x.Value) for x in contact.ItemProperties)
            else :
                ctact = {}
                for field in fields :
                    itemProp = contact.itemProperties[field]
                    ctact[field] = itemProp.Value
            contacts.append(ctact)
        return contacts

#====TEST SCRIPT====
myMAPI = MapiImport()
fields = (u"LastName",u"FirstName",u"Companies",
          u"HomeTelephoneNumber",u"Home2TelephoneNumber",
          u"MobileTelephoneNumber",
          u"BusinessTelephoneNumber",u"Business2TelephoneNumber",
          u"Email1Address",u"Email2Address",u"Email3Address",
          u"HomeAddress",u"BusinessAddress",
          u"Birthday",u"Anniversary",
          u"Body")
print(myMAPI.getContacts(*fields)) 
```

所以当我更换：

```
olApp = win32com.client.Dispatch("Outlook.Application") 
```

和 ：

```
olApp = win32com.client.gencache.EnsureDispatch("Outlook.Application") 
```

它返回此错误：

```
Traceback (most recent call last):
  File "D:\Documents and Settings\da7950\Mes documents\Dropbox\cheetahImporter\mapiImport.py", line 42, in <module>
    print(myMAPI.getContacts(*fields))
  File "D:\Documents and Settings\da7950\Mes documents\Dropbox\cheetahImporter\mapiImport.py", line 19, in getContacts
    for contact in filter(lambda x: x.Class == 40,self.mapiContacts) :
  File "D:\Documents and Settings\da7950\Mes documents\Python27\lib\site-packages\win32com\gen_py\00062FFF-0000-0000-C000-000000000046x0x9x2\_Items.py", line 122, in __getitem__
    return self._get_good_object_(self._oleobj_.Invoke(*(81, LCID, 1, 1, item)), "Item")
com_error: (-2147352567, "Une exception s'est produite.", (4096, u'Microsoft Office Outlook', u'Index de la matrice en dehors des limites.', None, 0, -2147352567), None) 
```

该消息的意思是“矩阵索引超出范围”。最奇怪的是，在我调用 EnsureDispatch 之后，win32com.client.Dispatch 不再起作用。我必须卸载 pywin32 并重新安装它...

我正在运行 Python2.7.3 64 位和 Outlook 2007 32 位

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T14:22:19.643

我找到了解决方案。这是一个错误 win32com makepy ......

主要问题是 Outlook 是基于 1 的索引`olContactItem`（而不是基于 0 的 python 索引）

```
olApp = win32com.client.gencache.EnsureDispatch("Outlook.Application")           
namespace = olApp.GetNamespace(u"MAPI")           
# olFolderContacts = 10 :           
mapiContacts = namespace.GetDefaultFolder(10).Items
for i in range(1,len(mapiContacts)+1) :
    contact = self.mapiContacts[i]
    ... 
```

还有另一个问题`contact.itemProperties`。所有属性都区分大小写`EnsureDispatch`，因此：

```
contact.ItemProperties("FullName").Value
#       ^ 
```

有效，但不是：

```
contact.itemProperties("FullName").Value
#       ^ 
```

要获得正确的名称，请参阅：[MSDN 上的 Microsoft Outlook ContactItem 参考模型](https://docs.microsoft.com/en-us/office/vba/api/outlook.contactitem)

# android - 如何在片段中实例化接口？

> ID：11623468
> 
> 赞同：2
> 
> 时间：2012-07-24T02:55:29.693
> 
> 标签：android, interface, fragment, instantiation

在我的 Android 应用程序中，我有一个片段活动，它有一个进度条。当任何片段调用接口时，此进度条设置为可见。因此，片段类的代码是这样的：

```
public class MainScreen extends FragmentActivity {

    public interface OnConnectingToInternet {
        public void showProgressbar(boolean flag);
    }

    // rest of codes
    .
    .
    .

    // Implementing Interface
    public void showProgressbar(boolean flag) {
        if(flag){
            myProgressbar.showProgressBar();
        } else {
            myProgressbar.hideProgressBar();
        }
    }

} 
```

每个片段都应该连接到 Internet 并获取数据，但是在此之前它们应该调用接口。我为一个类编写了以下代码（其他片段的代码是这样的）。

```
public class TopRecipesFragment extends Fragment {

    private OnConnectingToInternet onConnectingToInternet;

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);

        // onConnectingToInternet = (OnConnectingToInternet) activity;

        Log.i(TAG, "Fragment attached to activity.");
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        New MyAsyncTask.execute();
    }

    public class MyAsyncTask extends AsyncTask<Void, Void, Boolean> {       

        @Override
            protected void onPreExecute() {
            Log.i(TAG, "myAsyncTask is about to start...");

            onConnectingToInternet.showProgressbar(true);
            }

        @Override
            protected Boolean doInBackground(Void... params) {
            ...
            }

        @Override
            protected void onPostExecute(Boolean result) {
            Log.i(TAG, "myAsyncTask is about to start...");

            onConnectingToInternet.showProgressbar(false);
            }

} 
```

问题是我不知道如何实例化这个接口。如果我不放`onConnectingToInternet = (OnConnectingToInternet) activity;`，那么在运行应用程序后，它会在`NullPointerException`.

但是，如果我这样实例化，那么应用程序会因为转换问题而崩溃。我也无法以正常方式实例化它，例如`onConnectingToInternet = new MainScreen();`.

解决办法是什么？任何建议将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T03:21:48.363

我会写你正在尝试按照以下方式进行操作：

OnConnectingToInternet.java：

```
public interface OnConnectingToInternet {
        public void showProgressbar(boolean flag);
    } 
```

主屏幕.java：

```
public class MainScreen extends FragmentActivity implements OnConnectingToInternet {

// rest of codes
.
.
.

// Implementing Interface
@Override
public void showProgressbar(boolean flag) {
    if(flag){
        myProgressbar.showProgressBar();
    } else {
        myProgressbar.hideProgressBar();
    }
}
} 
```

TopRecipesFragment.java：

```
public class TopRecipesFragment extends Fragment {

    @Override
    public void onAttach(Activity activity) {
        super.onAttach(activity);
        Log.i(TAG, "Fragment attached to activity.");
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        new MyAsyncTask((OnConnectingToInternet)getActivity()).execute();
    }

    // Make class static to avoid memory leaks
    public static class MyAsyncTask extends AsyncTask<Void, Void, Boolean> {

        // Keep WeakReference to the interface to avoid memory leaks
        private final WeakReference<OnConnectingToInternet> connectionRef;       

        MyAsyncTask(OnConnectingToInternet connection) {
            connectionRef = new WeakReference<OnConnectingToInternet>(connection);
        }

        @Override
        protected void onPreExecute() {
            Log.i(TAG, "myAsyncTask is about to start...");

            OnConnectingToInternet connection = connectionRef.get();

            if (null != connection) {
               connection.showProgressbar(true);
            }
        }

        @Override
        protected Boolean doInBackground(Void... params) {
            ...
        }

        @Override
        protected void onPostExecute(Boolean result) {
            Log.i(TAG, "myAsyncTask is about to start...");

            OnConnectingToInternet connection = connectionRef.get();

            if (null != connection) {
               connection.showProgressbar(false);
            }
       }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T14:02:08.447

问题是有时 Fragment 的寿命比它的 Activity 长，例如，如果 Activity 有配置更改（例如旋转），那么 Activity 被销毁，但 Fragment 可以保持活动状态，然后重新附加到新的（旋转的）Activity . 请参阅这篇文章： [Android Fragment 生命周期超过方向更改](https://stackoverflow.com/questions/8474104/android-fragment-lifecycle-over-orientation-changes)

因此，您可能对使用 Wea​​kReference 提出的解决方案有疑问，因为在轮换之后，您将获得对旧 Activity 的引用（或者可能什么也没有）。

虽然我不确定为什么线路在 onAttach() 中崩溃，但应该没问题。

什么似乎对我有用：

1) 当我需要 Activity 的引用时，调用 getActivity()。在 onPostExecute() 中执行此操作。

2) 检查结果是否为空（这可能发生：片段的寿命可能比它们的活动长）

3) 检查活动是否为 isFinishing()——你不想在那种状态下做某些 UI 事情。

4）将活动转换为您的界面类型。

5) 调用 showProgressBar()。

# ios - 从 UINavigationController 弹出视图向我显示了不正确的 UITableview 数据

> ID：11623471
> 
> 赞同：0
> 
> 时间：2012-07-24T02:55:50.140
> 
> 标签：ios, uinavigationcontroller, uitableview

我正在尝试使用一系列 UITableViewControllers 在整个分层菜单中向下钻取和向上钻取。由于每个 UITableViewController 除了其特定的数据源外完全相同，因此我只使用一个 UITableViewController 类。例如，级别 1 是姓氏数组，级别 2 是名字数组，级别 3 是生日数组。我没有 3 个 UITableViewController（一个用于姓氏，一个用于名字，一个用于出生日期），我只有一个 UITableViewController 并且只分配/初始化一个全新的 UITableViewController，但是使用数据源数组初始化它，每个连续向下钻取（即 didSelectRowAtIndexPath）。如果我需要深入到第四层，我可以切换阵列，我们都很好。这样可以更好地扩展。

我可以“向前”并正确向下钻取。它完美无瑕。但是当我向后退时，即单击 UINavigationController 的“后退”按钮时，我确实得到了“父级”数据，或者它出现了。但是，当我真正单击一个单元格以再次前进时，看起来我的数据源实际上并没有在后台切换。它似乎被正确缓存了，但是当我点击数据时，实际上 2 级的数据源实际上不再由 2 级的数据支持。它实际上有 3 级的数据，也就是我刚刚从堆栈中弹出的 UITableViewController。

我是否需要覆盖 UINavigationController 的“后退按钮”，然后在弹出堆栈时更新我的​​数据源？我不确定我在这里缺少什么。我的 UITableViewCode 将近 1000 行，这是我面临的普遍问题。

```
Table1    Table2                     Table3
smith -->  Joe -->                   1/1/1980

hit "back"
          Table2
          Joe is displayed (correct)

          tap "Joe" again -->        6/23/1976  (indicating that this is someone else's birthdate, so the datasources have gotten mixed up.) 
```

所以向前走是正确的，但向后走似乎会混淆数据源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:16:07.613

考虑看看[这个项目](https://github.com/Stunner/Table-View-Specifier)是如何做到的。它正在做您描述的确切事情，而是从 plist 创建表层次结构。在示例应用程序中前后导航工作正常，您可以更改 plist 以包含更多级别。

# c# - 使用 C# 将 DateTime 从 UTC 转换为用户提供的时区

> ID：11623472
> 
> 赞同：1
> 
> 时间：2012-07-24T02:55:52.330
> 
> 标签：c#, asp.net, datetime, timezone

比如说，如果我有一个数据库列在 UTC 时区保存日期/时间，我可以将它们读入我用 C# 编写的 ASP.NET Web 应用程序中的 DateTime 对象中。如何将它们转换为用户提供的时区？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T02:59:36.597

这假设`time`有一个`Kind = DateTimeKind.Utc`

你可以使用[`ConvertTimeFromUtc`](http://msdn.microsoft.com/en-us/library/system.timezoneinfo.converttimefromutc.aspx)：

```
TimeZoneInfo.ConvertTimeFromUtc(time, userTimeZone); 
```

或者[`TimeZoneInfo.ConvertTime`](http://msdn.microsoft.com/en-us/library/bb382770.aspx)：

```
TimeZoneInfo.ConvertTime(time, TimeZoneInfo.Utc, userTimeZone); 
```

您可能需要查看[`TimeZoneInfo.ConvertTime`](http://msdn.microsoft.com/en-us/library/bb382770.aspx)有关该方法的详细信息的 MSDN 文章。

[在 MSDN 上](http://msdn.microsoft.com/en-us/library/bb397769.aspx)，关于时区转换的所有内容可能也值得一读。它比你想象的要复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T03:31:44.897

要获取系统中的时区列表，您可以使用 TimeZoneInfo.GetSystemTimeZones() 。它将为您提供系统中所有可用时区的列表。

```
 List<TimeZoneInfo>  lstTZI = TimeZoneInfo.GetSystemTimeZones().ToList(); 
```

因为它是 ReadOnlyCollection 。现在您可以将此源与 DropDownCntrl 绑定。

# web-services - 码头 WebSocket 服务器

> ID：11623479
> 
> 赞同：-1
> 
> 时间：2012-07-24T02:56:53.350
> 
> 标签：web-services, html, rest, webserver, websocket

这是什么：

我有一个网络服务，允许网络客户端获取和发布数据。那已经在起作用了。我想要发生的是当我的 Web 服务 UI 中发生添加、编辑、删除时，我希望更改自动更新到 Web 客户端，以便它具有准确的数据。因此，人们建议我在服务器和客户端中使用 WebSocket，以便 Web 服务/客户端可以随时发送/接收消息。我想要做的是，每次添加、编辑、删除发生时，服务器都会发送一条消息，例如“请更新您的数据”，当客户端收到该消息时，它将调用 ajax 方法 GET 来获取数据并加载屏幕。

我的 Web 服务是从 Netbeans 向导创建的 Restful Web 服务。我已经下载了码头罐子。关于如何将 WebSocket 东西集成到我的 Web 服务中的任何想法或好的教程？我看过有关如何创建 WebSocket 客户端的教程，但在 Web 服务器上没有运气。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:35:20.507

github上的这个项目是comet的客户端实现（当然包括websockets），但它也提供了一些示例服务器端实现，一个是jetty websockets

[https://github.com/flowersinthesand/jquery-socket/tree/master/samples/jetty-ws](https://github.com/flowersinthesand/jquery-socket/tree/master/samples/jetty-ws)

# java - Java 传递值理解

> ID：11623482
> 
> 赞同：2
> 
> 时间：2012-07-24T02:56:56.187
> 
> 标签：java, parameter-passing

我想我理解它是传递给方法的对象/数据成员的副本`tricky()`，因为只有值才是重要的，而不是实际的对象本身。但是打印语句向我保证`arg1`，`arg2`副本确实在方法内切换。我不明白为什么这不会将信息传递回原始对象，从而切换它们；视为该方法能够成功访问该方法中的`arg1.x`和`arg1.y`数据成员。

```
// This class demonstrates the way Java passes arguments by first copying an existing
// object/data member. This is called passing by value. the copy then points(refers)
// to the real object

// get the point class from abstract window toolkit
import java.awt.*;

public class passByValue {

static void tricky(Point arg1, Point arg2){

  arg1.x = 100;
  arg1.y = 100;
  System.out.println("Arg1: " + arg1.x + arg1.y);
  System.out.println("Arg2: " + arg2.x + arg2.y);

  Point temp = arg1;
  arg1 = arg2;
  arg2 = temp;
  System.out.println("Arg1: " + arg1.x + arg1.y);
  System.out.println("Arg2: " + arg2.x + arg2.y);
}

public static void main(String [] args){

  Point pnt1 = new Point(0,0);
  Point pnt2 = new Point(0,0);
  System.out.println("X1: " + pnt1.x + " Y1: " +pnt1.y); 
  System.out.println("X2: " + pnt2.x + " Y2: " +pnt2.y);
  System.out.println(" ");
  tricky(pnt1,pnt2);
  System.out.println("X1: " + pnt1.x + " Y1:" + pnt1.y); 
  System.out.println("X2: " + pnt2.x + " Y2: " +pnt2.y);  

}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T02:59:53.397

对象*引用*被复制，复制的引用仍然指向内存中的同一个对象。这就是您可以使用复制的引用更改对象的原因。但是，修改参数引用会修改*副本*，而不是原始引用。这就是为什么在方法中重定向引用不会重定向您传入的引用。

希望这可以解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T03:01:33.500

Java 确实按值传递，但它传递的是对象引用的值，这给出了按引用传递的效果（对于原语，它的行为更像是按值传递）。

但是Java*总是*按值传递。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-02T11:34:09.820

Java*是*按值传递的，但是当我们传递对象引用时，引用值会传递给方法，并且方法可以从那里更改对象成员的值。

看下面的代码：

```
public class Passbyvalue {

    public static void main(String[] args) {
        // TODO code application logic here
        Animal animal=new Animal();
        animal.name="Dog";
        System.out.println(animal.name);
        testIt(animal);
        System.out.println(animal.name);
    }

    public static void testIt(Animal animal){
        animal.name="Cat";
    }

} 
```

输出

狗猫

这是因为引用（原始和方法）都指向同一个对象。

```
 __________
   |          |                 
   |          |<------------- Orignal Reference 
   | Object   |   
   |          |<------------- Method Reference
   |          |
   |__________| 
```

如果您想更清楚地看到这种效果，请在方法中创建新对象

```
public class Passbyvalue {

    public static void main(String[] args) {
        Animal animal=new Animal();
        animal.name="Dog";
        System.out.println(animal.name);
        testIt(animal);
        System.out.println(animal.name);
    }

    public static void testIt(Animal animal){
        animal=new Animal();
        animal.name="Cat";
    }

} 
```

输出：狗狗

现在方法引用正在发布到堆中的另一个对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T03:10:17.043

最初，您新建了两个对象，将打印以下内容：

```
X1: 0 Y1: 0
X2: 0 Y2: 0 
```

当您调用tricky() 时，您通过值传递对pnt1 和pnt2 的引用并将它们分配给arg1 和arg2。因此，您正在传递内存中的位置。然后打印值：

```
Arg1: 100100
Arg2: 00
Arg1: 00
Arg2: 100100 
```

当您使用 temp 进行交换时，您正在交换地址。所以回到你的主要方法 pnt1 和 pnt2 仍然保存原始地址。因此，当您打印时，您会得到：

```
X1: 100 Y1:100
X2: 0 Y2: 0 
```

这是一个带有一些额外背景的相关[线程。](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T04:06:01.360

我曾经使用“图形方法”来解释这一点，所以我希望它有所帮助。在`main`，在调用`tricky`方法之前，您有：

```
pnt1 -> Point(x=0; y=0)
pnt2 -> Point(x=0; y=0) 
```

内部`tricky`方法，`arg1`和分别是和引用`arg2`的副本，因此它们指向相同的对象：`pnt1``pnt2`

```
pnt1 -> Point(x=0; y=0) <- arg1
pnt2 -> Point(x=0; y=0) <- arg2 
```

通过`arg1`引用，您正在修改第一个 Point 对象：

```
pnt1 -> Point(x=100; y=100) <- arg1
pnt2 -> Point(x=0; y=0) <- arg2 
```

然后，您将“指向”对`temp`第一个 Point(100;100) 对象的引用。之后，您`arg1`指向指向`arg2`-Point(0,0)- 的同一对象，并`arg2`指向已由 指向的同一对象`temp`，即Point(100;100)。因此，在`tricky`您交换内存地址`arg1`并`arg2`引用的内部方法中。

```
pnt1 -> Point(x=100; y=100) <- arg2 (temp also pointing this object)
pnt2 -> Point(x=0; y=0) <- arg1 
```

但是一旦方法完成，arg1 和 arg2（和 temp）就超出了范围（消失），你又得到了：

```
pnt1 -> Point(x=0; y=0)
pnt2 -> Point(x=0; y=0) 
```

和`pnt1`和`pnt2`预期不变，因为`tricky`方法内部的所有更改都是在`arg1`和上执行的`arg2`，它们只是引用的副本。

因此，`tricky`您可以在内部更改对象的内容（您有对它的引用），但您不能修改对它的原始引用，因为您只有它的副本。所以*Java*是*按值传递的*（实际上是按值*传递的引用*）。

# c# - C# Write Listview, and Read Listview（如何为子项的listview添加指标）

> ID：11623490
> 
> 赞同：0
> 
> 时间：2012-07-24T02:58:10.523
> 
> 标签：c#, listview, subitem

我让这个项目为自己保持秩序。

我所拥有的是：

```
+---Date---+----Time----+----Error-----------+
|24-24-2012|    4:42    | Warning - test/test|
+----------+------------+--------------------+ 
```

现在我得到了所有的工作，至少阅读和写作。但它并没有像我希望的那样进行。

我希望这些文本像：

```
Date (items.add)
time (subitem)
error (subitem) 
```

我希望它写成：

```
date | time | error 
```

然后一旦程序读取它，他就知道：

```
| = Start of subitem ( || end of subitem ) 
```

所以它在要写入的文本文件中的样子是：

```
date | time ||| error || ( which means : time start+end / error start+end (add to subitem) 
```

我想让程序视觉工作室知道他知道`( | 1x = subitems.add(" - And | 2x = ");`

很难解释。我会尝试不那么复杂的。

```
| = subitems.add("<br>
|| = "); 
```

所以写一个文件看起来像：

```
writer.writeline( | + "hello" + || + | + "test" + || ); 
```

这将导致文本文件为：

```
| hello ||| test || 
```

一旦程序启动，它将以这种方式再次读取它：

```
Listview.additems.add( hello ) *with no | or ||* 
```

测试将是：

```
listview.subitem( test ) *with no | or ||* 
```

等等...

* * *

对于像我这样的自闭症患者来说，截图可以更好地解释它。

> [点击这里查看屏幕截图](http://i48.tinypic.com/2uti9vb.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:24:54.170

我不确定我是否完全理解您需要实现的目标，但我认为您希望列表框中的每个项目都遵循特定的模板 - 所以主要的项目将在某个 X 模板中，并且子项目将有一个不同的模板 - 有点有意。因此，当根据您要添加的项目类型添加到列表框时，设置

listboxitem.template = isSubitem?subItemTemplate:mainItemTemplate;

这就是我从你的问题中了解到的全部内容。希望这是有道理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T04:10:15.240

因此，将响应添加为另一个答案。您的代码将如下所示：

```
using(StreamReader reader = new StreamReader(logFileName))
{
  StringBuilder currentItem = new StringBuilder();
  char currentChar;
  while (true)
  {
    if (reader.Peek() == 'specialChar')
    {
      if (currentChar == '|')
      {
        // This indicates that the currentItem is subItem
        AddNewSubitem(currentItem.ToString());
      }
      else
      {
        AddNewItem(currentItem.ToString());
      }
      currentItem.Clear();
      reader.Read();
    }
    else if (reader.Peek() != null)
    {
      curentItem.Append(reader.Read());
    }
    else
    {
      break;
    }
  }
} 
```

# ios - 在不影响应用程序性能的情况下，从 Core Data 执行级联删除对象的有效方法是什么？

> ID：11623491
> 
> 赞同：5
> 
> 时间：2012-07-24T02:58:13.353
> 
> 标签：ios, core-data, nsmanagedobjectcontext

我们应用程序中的数据库由嵌套数层的对象组成。出于架构上的原因，我们现在要迁移到这里是不可行的。

每天都有很大一部分数据过期。随着数据库大小的增长，我们的应用程序性能会下降。

因此，我们需要找到一种有效的方法来保持数据库的小型化（至少在这个版本中），我们正在考虑以下方法之一：

1.  在 applicationWillResignActive 期间，通过遍历根级别的所有对象来删除 NSManagedObjects，对每个对象调用 delete，然后允许删除级联到 3 层“对多”对象。这涉及到最后保存的一个上下文，它将所有这些都提交给数据库。这通常需要 10-20 秒（在 iPhone 4 上）才能删除对象，而 Springboard 在 10 秒时终止该过程。这样做的一个主要缺点是，如果在 10 秒超时之前未完成上下文保存，则不会删除任何内容，并且每次用户运行应用程序时数据库都会继续增长。

2.  删除 didFinishLaunchingWithOptions 或 applicationDidBecomeActive 或 applicationWillResignActive 内的整个 sqlite 文件。这迫使我们弹出应用程序的视图控制器堆栈的根目录，以避免尝试显示已删除的数据。最大的缺点是应用程序必须下载并解析数据几秒钟，然后用户下次启动应用程序时才能执行任何操作。

3.  在用户点击 Home 或 Power 按钮后，使用 beginBackgroundTaskWithExpirationHandler 删除 DB 对象。与此相关的未知数使它变得可怕。有人这样做（成功）吗？

4.  在应用程序运行时逐步删除较小的对象组。这会增加设备上的负载，以至于破坏了 tableview 的平滑度，使它们变得紧张。与删除旧对象并发的 API 调用已经解析的数据量在这里似乎不切实际。

任何关于在 Core Data 中删除对象的最佳实践的想法都将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T11:51:21.833

我遇到了这样的情况，我没有时间清理数据。

我解决了将一些关键实体标记为已删除（实体属性）的问题，并在稍后删除它们（和级联）。您不必标记每个已删除的实体，只需标记允许延迟删除的实体，这样 UI 就可以轻松知道是否有任何实体（标记或未标记）即将被删除。听起来很难，但如果您的数据模型足够干净，则不应该如此。

当您的应用程序重新启动时，您可以删除实体并级联 - 如果这不能结束，您将在可能的情况下重新开始删除 - 或者首先迭代并标记所有可删除的实体，可能会“一个接一个地删除它们” ”。这可以在后台完成而不会弄乱 UI（因为 UI 知道可删除的实体）。如果您这样做时遇到性能问题，您可以很容易地逐步处理删除。

“稍后标记并删除”策略对我来说效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T17:04:04.903

橙色80，

您应该在从 -applicationDidEnterBackground: 内启动的后台队列中进行级联删除。为避免被终止，您必须使用后台任务 ID。

我在经常搅动的实例 CD 应用程序中使用此策略。总的来说，使用这种策略，用户将永远不会看到删除。

安德鲁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:11:41.780

您可能需要考虑将选项 1 与标记某些要删除的实体结合使用。这样，即使在应用退出时删除没有完成，在启动时（假设你的应用启动还没有花费一些时间）你可以删除标记的实体（比如几秒钟），然后诉诸“轻" 在后台删除，比如没有用户交互（没有移动的表格视图）。当然，这会增加启动应用程序的时间，但我认为考虑到您的情况，这可能是一个可行的选择。

此外，我希望您通过 Core Data 执行批量加载，并且仅根据需要将对象加载到内存中。

快速重新阅读您的问题，我刚刚有了另一个想法……按照#2 的思路……您为什么不尝试将过时的数据迁移到单独的文件，然后当用户退出应用程序时，只删除该文件？迁移这些对象肯定会有开销，但它可能会提供更流畅的用户体验。

# camera - 在 XNA 中显示全屏摄像头

> ID：11623492
> 
> 赞同：0
> 
> 时间：2012-07-24T02:58:21.940
> 
> 标签：camera, windows-phone-7.1, fullscreen, xna-4.0, windows-phone

全部，我想用 XNA 在 Windows Phone 中显示全屏相机（Microsoft.Devices.PhotoCamera），如下面的代码所示，我试图改变 screenpos 和 origin 的值，但是没有用，我的有什么问题代码？谢谢

```
 if (CameraTexture != null)
        {
            Vector2 origin = new Vector2(CameraTexture.Width / 2, CameraTexture.Height / 2);
            Vector2 screenpos = new Vector2(240, 400);
            spriteBatch.Draw(CameraTexture, screenpos, null, Microsoft.Xna.Framework.Color.White, (float)Math.PI / 2,
           origin, 1.0f, SpriteEffects.None, 0f);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T07:27:38.867

好，我知道了

```
Microsoft.Xna.Framework.Rectangle rec = new Microsoft.Xna.Framework.Rectangle(0, 0, (int)ActualWidth, (int)ActualHeight); 
```

spriteBatch.Draw（纹理，rec，Microsoft.Xna.Framework.Color.White）；

# python - 使用 matplotlib 格式化日期

> ID：11623498
> 
> 赞同：2
> 
> 时间：2012-07-24T02:58:48.120
> 
> 标签：python, matplotlib

使用 Python 2.6.2 Matplotlib 1.1.0

基于[http://matplotlib.sourceforge.net/examples/api/date_index_formatter.html](http://matplotlib.sourceforge.net/examples/api/date_index_formatter.html)，我构建了一个 Python 程序来生成图像图

```
gr = getResults()
AttributeName = gr.getAttributeName(attributeId)
dates = []
values = []
for data in gr.byClient(clientId, attributeId):
    dates.append(data[0])
    values.append(data[1])

from matplotlib.backends.backend_agg import FigureCanvasAgg as FigureCanvas
from matplotlib.figure import Figure
import matplotlib.ticker as ticker
import numpy as np

# Create a figure with size 6 x 6 inches.
fig = Figure(figsize=(6,6))

# Create a canvas and add the figure to it.
canvas = FigureCanvas(fig)

# Create a subplot.
ax = fig.add_subplot(111)

# Set the title.
ax.set_title("Response over time",fontsize=14)

# Set the X Axis label.
ax.set_xlabel("Date",fontsize=12)

# Set the Y Axis label.
ax.set_ylabel(AttributeName,fontsize=12)

# Display Grid.
ax.grid(True,linestyle='-',color='0.75')

N = len(dates)
ind = np.arange(N)

def format_date(x, pos=None):
    thisind = np.clip(int(x+0.5),0, N-1)
    return dates[thisind].strftime('%Y-%m-%d')

ax.xaxis.set_major_formatter(ticker.FuncFormatter(format_date))

# Generate the Scatter Plot.
ax.scatter(dates,values,s=20,color='tomato');
fig.autofmt_xdate()

# Save the generated Scatter Plot to a PNG file.
canvas.print_figure(outputFileName,dpi=50) 
```

问题出在 format_date 方法中。当它被调用时，x 参数的值类似于 734586、734747、734808 ... 这会导致 clip 方法始终将索引设置为最后一个日期。最终图像的实际布局还可以，只是选择了错误的日期。x 值如何用于选择均匀间隔的日期？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T05:32:21.820

您可以调用 pylab.num2date() 将此数字转换为日期时间对象：

```
import pylab as pl
from matplotlib import ticker
from datetime import date

dates = [date(2012,7,10), date(2012,8,5), date(2012,9,4)]
values = [1,2,3]

def format_date(x, pos=None):
    return pl.num2date(x).strftime('%Y-%m-%d')

gca().xaxis.set_major_formatter(ticker.FuncFormatter(format_date))

# Generate the Scatter Plot.
scatter(dates,values,s=20,color='tomato');
gcf().autofmt_xdate() 
```

![在此处输入图像描述](../Images/d9b469599339420bb38d1e872ed785fd.png)

# android - 在活动开关上强制关闭

> ID：11623500
> 
> 赞同：0
> 
> 时间：2012-07-24T02:58:57.853
> 
> 标签：android

我正在使用一个按钮来切换活动，但是 logcat 说我没有在我的`AndroidManifest.xml`检查中声明该活动至少五次，它就在那里。我正在尝试切换到华氏温度课程。

我的带有按钮的主要 java 页面在这里：

```
package com.jordandebarth.supercalculator;

import com.jordandebarth.supercalculator.distance;
import com.jordandebarth.supercalculator.exponents;
import com.jordandebarth.supercalculator.nuclearfusion;
import com.jordandebarth.supercalculator.pythagorean;
import com.jordandebarth.supercalculator.fahrenheittocelsius;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.support.v4.app.NavUtils;

public class tab_view extends Activity {

    Button calculator, pythagorean, distance, exponent, temperature, nuclearfusion;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_tab_view);
        calculator = (Button)findViewById(R.id.calculatorButton);
        pythagorean = (Button)findViewById(R.id.pythagoreanButton);
        distance = (Button)findViewById(R.id.distanceButton);
        exponent = (Button)findViewById(R.id.exponentsButton);
        temperature = (Button)findViewById(R.id.temperatureButton);
        nuclearfusion = (Button)findViewById(R.id.nuclearfusion);

        pythagorean.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent pythagoreanIntent = new Intent(getBaseContext(), pythagorean.class);
                startActivityForResult(pythagoreanIntent, 0);
                overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left);
            }
        });
        distance.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent distanceIntent = new Intent(getBaseContext(), distance.class);
                startActivityForResult(distanceIntent, 0);
                overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left);
            }
        });
        exponent.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent exponentIntent = new Intent(getBaseContext(), exponents.class);
                startActivityForResult(exponentIntent, 0);
                overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left);
            }
        });
        temperature.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent temperatureIntent = new Intent(getBaseContext(), fahrenheittocelsius.class);
                startActivityForResult(temperatureIntent, 0);
                overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left);
            }
        });
        nuclearfusion.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent nuclearfusionIntent = new Intent(getBaseContext(), nuclearfusion.class);
                startActivityForResult(nuclearfusionIntent, 0);
                overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left);
            }
        });

    }

} 
```

我的 AndroidManifest 是：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.jordandebarth.supercalculator"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".tab_view"
            android:label="@string/title_activity_tab_view" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
       <activty
            android:name=".fahrenheittocelsius"
            android:label="Fahrenheit to Celsius"
            ></activty>

        <activity
            android:name=".calculator"
            android:label="Calculator"  >
        </activity>
        <activity
            android:name=".pythagorean"
            android:label="Pythagorean Theorem"
            >

        </activity>
        <activity
            android:name=".distance"
            android:label="Distance Formula"
            ></activity>
        <activity 
            android:name=".exponents"
            android:label="Exponents"
            ></activity>

        <activity
            android:name=".nuclearfusion"
            android:label="Nuclear Fusion"
            ></activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:08:20.287

`getBaseContext()`用替换所有实例`tab_view.this`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T04:24:50.203

[startActivityForResult](https://stackoverflow.com/a/5869048/940096)允许您启动活动并取回一些数据。假设您有一些文件选择器活动。按照答案链接。而且，如果您使用`startActivityForResult()`它需要`onActivityResult()`

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // Result OK.d.
    if (requestCode == resultCode) {
        // do something good
    }
} 
```

尝试使用以下代码开始您的活动 -

```
Intent temperature = new Intent(tab_view.this, fahrenheittocelsius.class);
startActivity(temperature);
overridePendingTransition(R.anim.slide_in_right, R.anim.slide_out_left); 
```

# database - PetaPoco GetInstance() 总是返回新实例？

> ID：11623504
> 
> 赞同：1
> 
> 时间：2012-07-24T02:59:20.393
> 
> 标签：database, orm, petapoco

只是对 PetaPoco 从版本 4.0.3 生成的 Database.cs 代码有疑问。请参见下面的代码片段：

```
public partial class postgresqlDB : Database
{
    public postgresqlDB() 
        : base("postgresql")
    {
        CommonConstruct();
    }

    public postgresqlDB(string connectionStringName) 
        : base(connectionStringName)
    {
        CommonConstruct();
    }

    partial void CommonConstruct();

    public interface IFactory
    {
        postgresqlDB GetInstance();
    }

    public static IFactory Factory { get; set; }
    public static postgresqlDB GetInstance()
    {
        if (_instance!=null)
            return _instance;

        if (Factory!=null)
            return Factory.GetInstance();
        else
            return new postgresqlDB();
    }

    [ThreadStatic] static postgresqlDB _instance;

    public override void OnBeginTransaction()
    {
        if (_instance==null)
            _instance=this;
    }

    public override void OnEndTransaction()
    {
        if (_instance==this)
            _instance=null;
    }
.....
..... <snip /> 
```

查看`GetInstance()`函数，为什么`return new postgresqlDB()`从未将 分配给私有变量`_instance`？

这是否意味着每次调用`GetInstance()`都会创建一个新实例，因为`if (_instance != null) return _instance;`永远不会是真的？

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:02:28.353

您已将 _instance 字段归因于 ThreadStatic。这意味着每个线程用于访问它的字段中都有不同的值。如果 GetInstance 总是用新线程调用，它总是有一个新值（换句话说，每次都调用构造函数）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T19:59:27.917

我今天在 PetaPoco 中也遇到了这种行为。（向创作者致敬，因为使用它通常是一种乐趣！）。在相关情况下，我想提取通过 PetaPoco 传递的最新 sql 的副本，以便使用如下代码查看它：

```
Console.WriteLine(RepositoryTableClass.repo.LastCommand); 
```

就我而言，正如 OP 所建议的那样，它总是空的。threadstatic 标记与原始问题正交。代码中设置 _instance 变量的唯一位置是在事务期间。因此，默认情况下会使用和放弃存储库的每个实例。（这可能是为了避免将单个连接重新用于多个重叠查询\结果的问题？）

在任何情况下，工厂模式都是可用的，并且可以用来强制依赖单个 repo 实例，如果这是您想要的。尝试一个超级简单的工厂类，例如：

```
private class RepoFactory : postgresqlDB.IFactory
{
        private static postgresqlDB repo = postgresqlDB.GetInstance();

        public postgresqlDB GetInstance()
        {
            return repo;
        }
} 
```

Set the factory before you begin using any repository objects like so:

```
postgresqlDB.Factory = new RepoFactory(); 
```

That enabled me to use repository objects against a single repository instance as verified by having a populated value for the last command after each usage...

```
RepositoryTableClass.repo.LastCommand 
```

# c# - 如何保持 DropDownList 变量的原始值？

> ID：11623505
> 
> 赞同：0
> 
> 时间：2012-07-24T02:59:24.280
> 
> 标签：c#, asp.net-mvc-3, entity-framework, html-select

我`Viewbag.typeofchange`在控制器中使用将列表传递给视图。在创建网页/视图中，如果`dropdownlist`选择了一个项目，它将正确保存到实体模型/数据库中。

但是，在编辑网页/视图中，下拉列表显示原始值，但在保存页面时，如果未选择下拉列表中的新项目，则该值丢失。

在编辑视图中，如果`dropdownlist`选择 ，则新值将存储到数据库中。

**如何保持`dropdownlist`变量的原始值，`typeofchange`以便在用户不选择项目时不会丢失？**

控制器中的代码：

```
 List<SelectListItem> items = new List<SelectListItem>();
    items.Add(new SelectListItem { Text = "Red", Value = "Red" });
    items.Add(new SelectListItem { Text = "Green", Value = "Green" });
    items.Add(new SelectListItem { Text = "Blue", Value = "Blue" });
    items.Add(new SelectListItem { Text = "Other/Explain", Value = "Other" });
    ViewBag.typeofchange = items; 
```

编辑视图中的代码：

```
 <div class="editor-field">
        @Html.DropDownList("typeofchange", Model.typeofchange)
    </div> 
```

实体 CodeFirst 模型中的代码：

```
 [DisplayName("Type of Change")]
    public string typeofchange { get; set; } 
```

我非常感谢反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T12:29:35.273

您有两个变量，typeofchange 是在 ViewBag 中传递的 SelectList，typeofchange 是模型的一部分。您需要做的就是将模型 typeofchange 设置为选定的值，然后将为您设置相关 SelectListItem 的 Selected 属性。

# .net - 如何更改 XML 中识别的语音输出？

> ID：11623511
> 
> 赞同：1
> 
> 时间：2012-07-24T03:00:14.997
> 
> 标签：.net, xml, grammar, speech-recognition

我在 XML 中为 C# 定义了多个规则。加载文件并最终调用 RecognizeAsync(RecognizeMode.Multiple) 以实现我希望成为连续识别的内容。SpeechRecognized 事件正确地从语法文件中返回已识别的文本。

现在，我希望有一个规则接受“二比三的比例”，但返回显示文本“2:3 的比例”。我定义了以下规则，它可以很好地返回 "ratio of 2:3:" ：

```
<rule id="ratio" scope="public">
<example>ratio of 2 to 3</example>
ratio of
<ruleref uri="#numbers"/><tag>$.value1=$$; </tag>
<item> to </item>
<ruleref uri="#numbers"/><tag>$.value2=$$;</tag>
<tag>$="ratio of "+ $.value1+ ":" +$.value2;</tag>
</rule> 
```

但由于这是一条最底层的规则，有多个规则调用它，我发现将“2:3”呼应到更高规则的唯一方法是每个更高的规则也使用语义解释。这意味着对原本不需要语义的规则进行大量额外的编码。

那么，在 XML 规则“ratio”中是否有让它返回“ratio 2:3”而不使用语义？或者更重要的是，在 XML 中是否有指定“二比三的比率”中可识别的单词“to”实际上是“:”？或者就此而言，如何将显示从“to”更改为“two”或“to”或“too”或“:”？

感谢您的任何建议。

# objective-c - UITableView dataSource 必须从 tableView 返回一个单元格：cellForRowAtIndexPath 错误

> ID：11623514
> 
> 赞同：2
> 
> 时间：2012-07-24T03:00:32.347
> 
> 标签：objective-c, uitableview

我收到这段代码的错误。你能帮我找出原因吗。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"CustomerCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    Restaurant *restaurant = [self.restaurants objectAtIndex:[indexPath row]];
    [[cell textLabel] setText:[NSString stringWithFormat:@"%@ %@",restaurant.Name,restaurant.Address]];
    return cell;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:04:17.533

您的代码的问题在于`dequeueReusableCellWithIdentifier:`它并不总是返回一个有效的单元格；有时，它会返回`nil`。在这种情况下，您需要分配一个新的单元实例，然后以通常的方式对其进行初始化。就目前而言，`nil`如果从该`dequeueReusableCellWithIdentifier:`方法返回一个，则您的方法将返回。

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (!cell) {
      cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyle1 reuseIdentifier:CellIdentifier];
} 
```

# java - 如何在eclipse的不同控制台中显示stdout和stderr？

> ID：11623525
> 
> 赞同：8
> 
> 时间：2012-07-24T03:01:19.330
> 
> 标签：java, eclipse

在开发过程中，我不想将它们重定向到文件中。有没有办法创建两个控制台，一个只显示标准输出消息而另一个只显示标准错误？有没有可以提供这个功能的插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:15:21.097

我认为最好的办法是在文本中为 stdout 和 stderr 使用不同的颜色。但是只有一个控制台视图用于输出。

# java - IF 语句中的日期类

> ID：11623531
> 
> 赞同：0
> 
> 时间：2012-07-24T03:01:46.173
> 
> 标签：java, date, if-statement, string-concatenation

这是我的代码：

```
import java.util.*;
import java.io.*;
import type.lib.GlobalCredit;
import type.lib.CreditCard;
import java.text.SimpleDateFormat;

public class eCheck08A
{
    public static void main(String[] args)
    {
        PrintStream out = System.out;
        Scanner in = new Scanner(System.in);

        GlobalCredit credit1 = new GlobalCredit().getRandom();

        out.print("Enter report range in years ... ");
        int range = in.nextInt();
        out.println("Cards expiring before " + range + " year(s) from now: ");

        SimpleDateFormat sf = new SimpleDateFormat("dd/MM/yyyy");

        for (CreditCard cc : credit1)
        {
            out.print(cc.getNumber());
            out.println("\t" + sf.format(cc.getExpiryDate()));
        }   
    }
} 
```

起初，我的应用程序要求输入 Range 年份，假设我们输入“3”。我想在低于范围号的任何年份的日期旁边放一个“*”。我假设 Java 假设日期是今天，所以是 2012 年 7 月 23 日。例如，如果我们得到 16/04/2013，我想要一个“*”旁边。但如果我们得到 23/05/2016，则不会出现“*”。

编辑：

```
 Date endDate = new Date(2015, 12, 31);
    for (CreditCard cc : credit1)
    {
        if (cc.getExpiryDate().compareTo(endDate) < 0)
        {
            if(cc.getExpiryDate().compareTo(endDate) > 0)
            {
                out.print("*");
            }
            out.print(cc.getNumber());
            out.println("\t" + sf.format(cc.getExpiryDate()));
                     }
            } 
```

范围是

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:08:25.760

由于这是作业，我不会给你完整的代码。

Java Date 类允许使用该[`.compareTo()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Date.html#compareTo%28java.util.Date%29)方法比较两个日期。尝试创建一个精确`range`到未来几年的日期，并查看信用卡的到期日期是否晚于该日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T08:39:45.433

java中的compareTo允许您比较两个对象。因此，如果您比较两个日期，您可以看到哪个日期更晚或更早。我会在你的 for 循环中放一些 if 语句。

例如

```
Date endDate= new Date(2015, 12, 25);

for (//some stuff....)
{
     if (cc.getExpiryDate.compareTo(endDate)<0)
     {
         if (cc.getExpiryDate.compareTo(//????????? figure out which date should go here) >0)
         {  
               // put a star here
         }
      }
 } 
```

当您执行 .compareTo 时，如果您比较的数字更大，您将返回一个负整数，否则如果您的对象更大，则返回正整数。如果它们相等，它将为零。这就是为什么人们会做 <0 ， >0 或 ==0

# javascript - Firefox 14.0.1 在读取通过 AJAX 发送的 JSON 文件时返回错误

> ID：11623538
> 
> 赞同：4
> 
> 时间：2012-07-24T03:02:38.963
> 
> 标签：javascript, ajax, json, firefox

Firefox 13.0.1 和 IE7+ 可以很好地处理服务器上的 JSON 文件。然而，当我在浏览器中打开 JSON（在线存储）文件时，FF14 会返回控制台生成的以下错误消息：

> 未声明纯文本文档的字符编码。如果文档包含 US-ASCII 范围之外的字符，则文档将在某些浏览器配置中呈现乱码。文件的字符编码需要在传输协议中声明或文件需要使用字节顺序标记作为编码签名。
> 
> [http://lifelearning.x10.mx/test/php_slides.js。](http://lifelearning.x10.mx/test/php_slides.js.)

当你访问这个网站（我的一个测试网站）时， http: [//lifelearning.x10.mx/test/php_slides.html](http://lifelearning.x10.mx/test/php_slides.html) （你可以在那里查看代码）并在div内滚动鼠标（被黑色边框包围)，文本不会按预期出现（否则在上面列出的任何浏览器中都会出现，FF14 除外）。

我想问一下如何按照 FF14 Web 控制台的要求声明纯文本的字符编码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T03:17:41.680

可以使用 HTTP 标头设置内容类型和字符编码。您可能想要的标题是：

```
Content-type: application/json; charset=UTF-8 
```

如果您从 php 提供 json 数据，您可以使用`header()`命令添加此标头。如果您使用的是 apache，则可以使用`.htaccess`包含以下行的文件：

```
AddType application/json .json
AddCharset UTF-8 .json 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-28T02:49:03.527

当我在 php 脚本中包含 php 脚本时出现此错误。当我将包含在脚本标签中时，错误停止发生。

# java - 为什么单击按钮时我的应用程序崩溃？

> ID：11623540
> 
> 赞同：0
> 
> 时间：2012-07-24T03:02:44.933
> 
> 标签：java, android, android-layout, android-emulator, android-widget

我有一个按钮，`id = button1`单击它会运行该功能 `onEnterClick();` ，但是每当我单击它时，我的应用程序就会崩溃并说出来`unexpectedly quit`。我将在下面提供java文件和xml，非常感谢任何帮助。

```
package tip.calculator;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.widget.EditText;
import android.widget.TextView;
import android.view.View;

public class MainActivity extends Activity {

    final EditText myEditField = (EditText) findViewById(R.id.percentText);
    final EditText myEditField2 = (EditText) findViewById(R.id.billText);

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

    public void onEnterClick(View view){   //This Function Runs When The Button is clicked

        TextView textView;

        textView = 
                (TextView) findViewById(R.id.textView1);

        final EditText myEditField = (EditText) findViewById(R.id.percentText);
        final EditText myEditField2 = (EditText) findViewById(R.id.billText);

        int percentage;
        int percentageInp;
        int billAmount;
        int output; 
        String output1;

        percentageInp = Integer.parseInt(myEditField.getText().toString());
        billAmount = Integer.parseInt(myEditField2.getText().toString());

        percentage = percentageInp /100;
        output = (billAmount * percentage);
        output1 = Integer.toString(output);

        textView.setText(output1);
    }

} 
```

那是Java^^ 这是xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:onClick="onEnterClick" >

    <EditText
        android:id="@+id/billText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:ems="10"
        android:hint="Bill Amount"
        android:inputType="numberDecimal|textAutoComplete" />

    <EditText
        android:id="@+id/percentText"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/billText"
        android:layout_below="@+id/billText"
        android:ems="10"
        android:hint="Percent"
        android:inputType="number" >

        <requestFocus />
    </EditText>

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/percentText"
        android:layout_centerHorizontal="true"
        android:onClick="onEnterClick"
        android:text="Calculate" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="287dp"
        android:text="Solution Will Appear Here:"
        android:textAppearance="?android:attr/textAppearanceLarge" />

</RelativeLayout> 
```

**原木猫：**

```
07-24 03:12:26.563: D/AndroidRuntime(412): Shutting down VM
07-24 03:12:26.563: W/dalvikvm(412): threadid=1: thread exiting with uncaught exception (group=0x40014760)
07-24 03:12:26.763: E/AndroidRuntime(412): FATAL EXCEPTION: main
07-24 03:12:26.763: E/AndroidRuntime(412): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{tip.calculator/tip.calculator.MainActivity}: java.lang.NullPointerException
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1739)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1831)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.ActivityThread.access$500(ActivityThread.java:122)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1024)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.os.Looper.loop(Looper.java:132)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.ActivityThread.main(ActivityThread.java:4123)
07-24 03:12:26.763: E/AndroidRuntime(412):  at java.lang.reflect.Method.invokeNative(Native Method)
07-24 03:12:26.763: E/AndroidRuntime(412):  at java.lang.reflect.Method.invoke(Method.java:491)
07-24 03:12:26.763: E/AndroidRuntime(412):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
07-24 03:12:26.763: E/AndroidRuntime(412):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
07-24 03:12:26.763: E/AndroidRuntime(412):  at dalvik.system.NativeStart.main(Native Method)
07-24 03:12:26.763: E/AndroidRuntime(412): Caused by: java.lang.NullPointerException
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.Activity.findViewById(Activity.java:1745)
07-24 03:12:26.763: E/AndroidRuntime(412):  at tip.calculator.MainActivity.<init>(MainActivity.java:12)
07-24 03:12:26.763: E/AndroidRuntime(412):  at java.lang.Class.newInstanceImpl(Native Method)
07-24 03:12:26.763: E/AndroidRuntime(412):  at java.lang.Class.newInstance(Class.java:1301)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.Instrumentation.newActivity(Instrumentation.java:1022)
07-24 03:12:26.763: E/AndroidRuntime(412):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1730)
07-24 03:12:26.763: E/AndroidRuntime(412):  ... 11 more
07-24 03:12:34.871: I/Process(412): Sending signal. PID: 412 SIG: 9
07-24 03:15:54.102: D/AndroidRuntime(453): Shutting down VM
07-24 03:15:54.216: W/dalvikvm(453): threadid=1: thread exiting with uncaught exception (group=0x40014760)
07-24 03:15:54.381: E/AndroidRuntime(453): FATAL EXCEPTION: main
07-24 03:15:54.381: E/AndroidRuntime(453): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{tip.calculator/tip.calculator.MainActivity}: java.lang.NullPointerException
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1739)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1831)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.ActivityThread.access$500(ActivityThread.java:122)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1024)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.os.Handler.dispatchMessage(Handler.java:99)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.os.Looper.loop(Looper.java:132)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.ActivityThread.main(ActivityThread.java:4123)
07-24 03:15:54.381: E/AndroidRuntime(453):  at java.lang.reflect.Method.invokeNative(Native Method)
07-24 03:15:54.381: E/AndroidRuntime(453):  at java.lang.reflect.Method.invoke(Method.java:491)
07-24 03:15:54.381: E/AndroidRuntime(453):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
07-24 03:15:54.381: E/AndroidRuntime(453):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
07-24 03:15:54.381: E/AndroidRuntime(453):  at dalvik.system.NativeStart.main(Native Method)
07-24 03:15:54.381: E/AndroidRuntime(453): Caused by: java.lang.NullPointerException
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.Activity.findViewById(Activity.java:1745)
07-24 03:15:54.381: E/AndroidRuntime(453):  at tip.calculator.MainActivity.<init>(MainActivity.java:12)
07-24 03:15:54.381: E/AndroidRuntime(453):  at java.lang.Class.newInstanceImpl(Native Method)
07-24 03:15:54.381: E/AndroidRuntime(453):  at java.lang.Class.newInstance(Class.java:1301)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.Instrumentation.newActivity(Instrumentation.java:1022)
07-24 03:15:54.381: E/AndroidRuntime(453):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1730)
07-24 03:15:54.381: E/AndroidRuntime(453):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:18:39.060

在调用部分之前不要初始化 UI 元素`setContentView(R.layout.activity_main);`。

将您的代码更改为

```
public class MainActivity extends Activity 
{
private EditText myEditField;
private EditText myEditField2;
private Button enter;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    myEditField = (EditText) findViewById(R.id.percentText);
    myEditField2 = (EditText) findViewById(R.id.billText);
    enter = (Button)findViewById(R.id.button1);

    enter.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {
            TextView textView;

            textView = (TextView) findViewById(R.id.textView1);

            final EditText myEditField = (EditText) findViewById(R.id.percentText);
            final EditText myEditField2 = (EditText) findViewById(R.id.billText);

            float percentage;//=======> declate as float
            int percentageInp;
            int billAmount;
            int output; 
            String output1;

            percentageInp = Integer.parseInt(myEditField.getText().toString());
            billAmount = Integer.parseInt(myEditField2.getText().toString());

            System.out.println(percentageInp+" "+billAmount);

            percentage = ((float)percentageInp /100);//=====>check here

            output = (int)(billAmount * percentage);
            output1 = Integer.toString(output);

            textView.setText(output1);

        }
    });
}
} 
```

# c# - 如何加速这段代码？

> ID：11623541
> 
> 赞同：3
> 
> 时间：2012-07-24T03:02:46.383
> 
> 标签：c#, bioinformatics

我得到了以下用于读取 txt 文件并返回字典的方法。读取一个约 5MB 的文件（67000 行，每行 70 个字符）需要约 7 分钟。

```
public static Dictionary<string, string> FASTAFileReadIn(string file)
{
    Dictionary<string, string> seq = new Dictionary<string, string>();

    Regex re;
    Match m;
    GroupCollection group;
    string currentName = string.Empty;

    try
    {
        using (StreamReader sr = new StreamReader(file))
        {
            string line = string.Empty;
            while ((line = sr.ReadLine()) != null)
            {
                if (line.StartsWith(">"))
                {// Match Sequence
                    re = new Regex(@"^>(\S+)");
                    m = re.Match(line);
                    if (m.Success)
                    {
                        group = m.Groups;
                        if (!seq.ContainsKey(group[1].Value))
                        {
                            seq.Add(group[1].Value, string.Empty);
                            currentName = group[1].Value;
                        }
                    }
                }
                else if (Regex.Match(line.Trim(), @"\S+").Success &&
                            currentName != string.Empty)
                {
                    seq[currentName] += line.Trim();
                }
            }
        }
    }
    catch (IOException e)
    {
        Console.WriteLine("An IO exception has benn thrown!");
        Console.WriteLine(e.ToString());
    }
    finally { }

    return seq;
} 
```

代码的哪一部分最耗时，如何加快速度？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:08:42.413

我希望编译器会自动执行此操作，但我注意到的第一件事是您正在重新编译每个匹配行上的正则表达式：

```
 while ((line = sr.ReadLine()) != null)
            {
                if (line.StartsWith(">"))
                {// Match Sequence
                    re = new Regex(@"^>(\S+)"); 
```

如果您可以完全删除正则表达式，那就更好了；大多数语言都提供`split`某种经常使用正则表达式的功能......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T03:14:27.787

缓存和编译正则表达式、重新排序条件、减少修剪次数等。

```
public static Dictionary<string, string> FASTAFileReadIn(string file) {
    var seq = new Dictionary<string, string>();

    Regex re = new Regex(@"^>(\S+)", RegexOptions.Compiled);
    Regex nonWhitespace = new Regex(@"\S", RegexOptions.Compiled);
    Match m;
    string currentName = string.Empty;

    try {
        foreach(string line in File.ReadLines(file)) {
            if(line[0] == '>') {
                m = re.Match(line);

                if(m.Success) {
                    if(!seq.ContainsKey(m.Groups[1].Value)) {
                        seq.Add(m.Groups[1].Value, string.Empty);
                        currentName = m.Groups[1].Value;
                    }
                }
            } else if(currentName != string.Empty) {
                if(nonWhitespace.IsMatch(line)) {
                    seq[currentName] += line.Trim();
                }
            }
        }
    } catch(IOException e) {
        Console.WriteLine("An IO exception has been thrown!");
        Console.WriteLine(e.ToString());
    }

    return seq;
} 
```

*然而*，这只是一个幼稚的优化。阅读 FASTA 格式，我写了这个：

```
public static Dictionary<string, string> ReadFasta(string filename) {
    var result = new Dictionary<string, string>
    var current = new StringBuilder();
    string currentKey = null;

    foreach(string line in File.ReadLines(filename)) {
        if(line[0] == '>') {
            if(currentKey != null) {
                result.Add(currentKey, current.ToString());
                current.Clear();
            }

            int i = line.IndexOf(' ', 2);

            currentKey = i > -1 ? line.Substring(1, i - 1) : line.Substring(1);
        } else if(currentKey != null) {
            current.Append(line.TrimEnd());
        }
    }

    if(currentKey != null)
        result.Add(currentKey, current.ToString());

    return result;
} 
```

告诉我它是否有效；它应该快得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T03:10:49.900

您可以通过使用以下方法显着提高阅读速度[`BufferedStream`](http://msdn.microsoft.com/en-us/library/system.io.bufferedstream.aspx)：

```
using (FileStream fs = File.Open(file, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
using (BufferedStream bs = new BufferedStream(fs))
using (StreamReader sr = new StreamReader(bs))
{
    // Use the StreamReader
} 
```

`Regex`不过，如果您的处理时间约为 5 分钟，那么提到的重新编译 @sarnold 可能是您最大的性能杀手。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T03:32:38.543

这就是我要写的方式。如果没有更多信息（即字典条目的平均长度），我无法优化 StingBuilder 容量。您也可以按照 Eric J. 的建议添加一个`BufferedStream`. 理想情况下，`Regular Expressions`如果你想提高性能，你会完全放弃，但它们更容易编写和管理，所以我理解你为什么要使用它们。

```
public static Dictionary<string, StringBuilder> FASTAFileReadIn(string file)
{
    var seq = new Dictionary<string, StringBuilder>();
    var regName = new Regex("^>(\\S+)", RegexOptions.Compiled);
    var regAppend = new Regex("\\S+", RegexOptions.Compiled);

    Match tempMatch = null;
    string currentName = string.Empty;
    try
    {
        using (StreamReader sReader = new StreamReader(file))
        {
            string line = string.Empty;
            while ((line = sReader.ReadLine()) != null)
            {
                if ((tempMatch = regName.Match(line)).Success)
                {
                    if (!seq.ContainsKey(tempMatch.Groups[1].Value))
                    {
                        currentName = tempMatch.Groups[1].Value;
                        seq.Add(currentName, new StringBuilder());
                    }
                }
                else if ((tempMatch = regAppend.Match(line)).Success && currentName != string.Empty)
                {
                    seq[currentName].Append(tempMatch.Value);
                }
            }
        }
    }
    catch (IOException e)
    {
        Console.WriteLine("An IO exception has been thrown!");
        Console.WriteLine(e.ToString());
    }

    return seq;
} 
```

如您所见，我稍微更改了您的字典以使用优化的`StringBuilder`类来附加值。我还一次又一次地预编译了正则表达式，以确保您不会一遍又一遍地重复编译相同的正则表达式。我还提取了您的“附加”案例以编译成正则表达式。

让我知道这是否可以帮助您提高性能。

# java - java后端使用输入存在名称时如何快速提示可用名称

> ID：11623542
> 
> 赞同：1
> 
> 时间：2012-07-24T03:02:55.277
> 
> 标签：java, jpa, db2, eclipselink

## 现在我有一个要求。

当用户输入存在名称时，我需要快速提示用户可用的名称。而在前端，没有问题。但是在后端，**如何编写清晰的代码？**

这个功能就像当用户使用名称'Java'注册一个电子邮件帐户时，当发现重复时，会给用户一些可用的名称建议g例如'Java01'，'Java001'，'Java002'

目前，我的想法如下， **示例**：

用户输入名称为“ **Name01** ”。
首先，我使用“JPQL(JPA)”来验证名称是否存在；
如果存在，我将创建一个类似 ' 的 sql，`Select name from table a where a.name like 'Name01%'`
然后我将获得一个存在名称列表。`{'Name012','Name014','Name015'...}`
所以我使用**'Name01'**来概括一个猜测列表`{'Name010','Name011','Name012','Name013','Name014',...}`
，然后我使用猜测列表来比较存在名称列表，并返回一个 10 大小的列表（它不应该存在于数据库中，用户可以使用其中一个来保存快速请求以避免第二次验证。）例如：`{'Name010','Name011','Name013','Name016',...}`
但是如果猜测列表都存在于数据库中。我需要按“Name0%”搜索 db 并进行递归。

看起来效率太低了。
我很困惑**如何概括一个猜测列表以及如何进行比较会降低比较频率。** 有人有好的解决方案吗？

提示：我使用 JSF+EJB+JPA(Eclipse Link 1.0) DB2 名称的最大长度为 10，只能包含字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T14:06:21.803

老实说……我觉得非常令人沮丧的是，非常智能的网络应用程序实际上会建议像 ricky01 或 ricky011 之类的东西。

我们仍然是人类，我们想出昵称的原因是为了避免必须记住 ID，这或多或少是最终会在提供诸如 %01 之类的建议的系统中发生的事情

建议您的用户已经为具有更高可见性的用户名（例如他/她的电子邮件地址）选择了用户名，这不是一个更好的主意吗？

电子邮件根据定义是独一无二的，您可以像 google 一样玩：“如果您输入 email@domain.com”然后首先检查电子邮件是否是他的有效用户名，否则检查整个事情......

我想我要说的是你最终会得到一个用户友好得多的系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T11:00:42.543

在这种情况下使用的高效数据结构是[`Trie`](http://en.wikipedia.org/wiki/Trie)（前缀树）。

作为应用程序的一部分，您应该生成`Trie`带有所有`Name`s 的 a，并且此数据结构可用于生成用户提示。这种数据结构的美妙之处在于它将时间复杂度降低到`O(n)`.

例如：name0,name10,name45 将产生一个具有以下节点的 Trie

```
root node - "n"
node Level 1 - "a"
node Level 2 = "m"
node Level 3 = "e"
node Level 4 = "0" , "1" , "4"
node Level 4 = "0" , "5" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-01T09:43:10.613

如果我对您的理解正确，您只需几个步骤：1）用户输入他们首选的用户名（没有限制的自由文本输入，可能很少规则）2）您从上面验证用户输入，如果它是唯一的则接受它或向用户提供几个替代方案（此时您是否禁用用户自由文本输入？） 3）您接受步骤 2 中的用户选择）（无需进一步验证，因为您假设它已经是唯一的？）

假设任何事情并接受任何用户数据而不进行验证绝不是一个好主意，因此步骤 3) 必须执行与步骤 2) 相同的验证 - 这意味着没有步骤 3)，只是重复第2步）。

这在步骤 2 中留下了功能）

查询您的用户存储 (DB) 以检查条目是否唯一：

a) 它是独一无二的 - 创建新条目并通知用户

b) 它已经存在 - 查询您的用户存储中的 LIKE 条目，通常它将是 userEnteredStringFromStep1 + someWayOfMakingYourStringUnique。最常见的 someWayOfMakingYourStringUnique 只是一个数字。因此，您需要在您的用户存储中查询 LIKE 'userEnteredStringFromStep1%' 并生成新的 userEnteredStringFromStep1 + someWayOfMakingYourStringUnique 组合，这些组合在上面的结果中不存在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T09:20:08.113

也许您可以先预先定义生成规则：

例如，如果用户的输入存在，然后您将此输入与一些随机生成的字母和数字连接以生成 10 大小的建议列表，然后使用一个查询来验证它们是否可用。因为这个列表真的很少用不上，大多数时候你会成功，如果没有，就重新生成列表。

```
userInput = "java"
generate list = {"java01","java02","java03",...}
select count(*) into existence from table a where a.name in (list)
if existence >0 then regenerate else return list 
```

所以只需先定义一个规则来生成建议列表的规则，并使该算法在第一次几乎成功，并且建议接近用户的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-31T11:42:47.647

正如 Byter 所指出的，a[`Trie`](http://en.wikipedia.org/wiki/Trie)是最适合使用的对象类型。然而，找到一个易于使用的 Java 实现是很棘手的。采取次优选择，并坚持标准课程，这对于黑客来说怎么样？（假设您的用户使用的是 UTF-8）

```
import com.google.common.collect.*;
import java.util.*;

public class Subsearch {

    private static final List<String> EXAMPLE_RESULTS = Lists.newArrayList("Name010", "Name011", "Name012", "Name013", "Name014", "Name100");

    public static void main(String[] args) {
        // EXAMPLE_RESULTS is from the DB lookup, also retain the original user string
        // exit if the user didn't add one character to the end of the original string
        SortedSet<String> sorted = Sets.newTreeSet(EXAMPLE_RESULTS);
        String userInput = "Name0";
        String upper = userInput + "\uFFFF";        
        SortedSet<String> trimmed = sorted.subSet(userInput, upper);
        // save "trimmed" and userInput for the next iteration
        // no need to store EXAMPLE_RESULTS anymore
        System.out.println(trimmed);
    }
} 
```

我用以下几点警告这一点：确保您确实需要优化您的查找代码。如果数据库没有受到命中的影响，那么不要引入这个额外的复杂层（需要维护的额外代码以及增加并发问题的可能性）。完全有可能，如果您已经索引了您的数据库，`@Column`那么数据库实际上可能在`Trie`内部使用。

顺便说一句，你已经索引了你的列，对吧？如果没有，您可以通过将以下特定于 Hibernate 的注释添加到该字段来实现

```
@org.hibernate.annotations.Index
@Column
String name; 
```

（不要忘记重建 DB Schema）或发出[原生查询](http://www.w3schools.com/sql/sql_create_index.asp)。

# xml - 在 solr 中索引 xml 文件时找不到 404

> ID：11623561
> 
> 赞同：0
> 
> 时间：2012-07-24T03:05:42.190
> 
> 标签：xml, solr, indexing

嗨，我在索引 xml 时收到 Http 错误 404，说问题访问。/solr/#/myproject/update 找不到原因

任何人对此都有任何线索。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T18:16:23.387

如果要在 Solr 中插入数据，则需要执行 curl 命令。

1.  您需要`php5-curl`在您的计算机/服务器上安装模块
2.  Solr 必须正在运行
3.  您需要一个 xml 文件，其中的数据与您的 schema.xml 具有相同的字段名

打开终端并执行：

```
curl yoursolrURL/update -H "Content-type:text/xml" --data-binary @yourfilewithdata.xml
curl yoursolrURL/update -H "Content-type:text/xml" --data-binary "<commit/>"
curl yoursolrURL/update -H "Content-type:text/xml" --data-binary "<optimize/>" 
```

我就是这样做的。告诉我这是否对您有帮助。

# php - 使用 PDO 选择和插入的循环时虚 URL 无法正常工作

> ID：11623563
> 
> 赞同：0
> 
> 时间：2012-07-24T03:05:50.573
> 
> 标签：php, mysql, while-loop

我正在尝试实现一个简单的 mysql 插入，它采用用户的名字 ($first_name) 和用户的姓氏 ($last_name) 并将它们插入到我的用户表 (url) 列中。这非常像 Quora 和 Facebook...例如 www.facebook.com/Michael.Jackson.32。

我的 while 循环在下面，我希望我知道错误，但是当我执行代码时，我的服务器继续运行并最终超时。

任何帮助深表感谢。

```
//Store Vanity URL
$user_id_sql = $db->prepare("SELECT id FROM users WHERE first_name = :first_name AND last_name = :last_name");
$user_id_sql->execute(array(':first_name' => $first_name , ':last_name' => $last_name));
$user_search_results = $user_id_sql->rowCount();

if($user_search_results == "0") {
    $vanity = $first_name.'.'.$last_name;
    $insert_vanity_url = $db->prepare("INSERT INTO users (url) VALUES (:vanity) WHERE uid = :uid");
    $insert_vanity_url->execute(array(':vanity'=>$vanity , ':uid'=>$uid));
}
else {
    $var1 = "bad";
    $i = "1";
    while($var1 == "bad") {
        $user_id_sql_two = $db->prepare("SELECT id FROM users WHERE first_name = :first_name AND last_name = :last_name");
        $user_id_sql_two->execute(array(':first_name' => $first_name , ':last_name' => $last_name));
        $user_search_results_two = $user_id_sql_two->rowCount();
        if($user_search_results_two == "0") {
            $vanity = $first_name.'.'.$last_name.$i;]
            $insert_vanity_url = $db->prepare("INSERT INTO users (url) VALUES (:vanity) WHERE uid = :uid");
            $insert_vanity_url->execute(array(':vanity'=>$vanity, ':uid'=>$uid));
            $var1 = "good";
        }
        $i++;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:23:38.110

好的，我发现了问题（以及具体问题）：

这个查询：

```
SELECT id FROM users WHERE first_name = :first_name AND last_name = :last_name 
```

完全按照您的想法进行操作，获取具有该名字和姓氏的所有用户。第一次使用时，如果不存在这样的用户，则添加用户和虚荣，然后继续。

但是，如果这样的用户确实存在，由 确定`rowCount()`，您将进入该循环。

该循环包含相同的查询，检查是否有任何具有该名字和姓氏的用户。但是您在此块中的唯一原因是因为有与查询匹配的用户。

这里的一般逻辑是：

1.  如果这样的用户不存在，请创建它们。
2.  如果这样的用户确实存在，则循环直到它不再存在。

你可能应该做的是生成基本的虚荣，然后检查*它*在表中的存在，然后你可以检查你的后备虚荣，每个循环生成一个新的虚荣，直到它不存在（这实际上不是一个好的方法这样做，但更好的是需要更重大的改变）。

实际上，您的代码还有很多需要改进的地方，但这不是代码审查，所以我会保持沉默。

# xml - sql server 2008 xml文件到表

> ID：11623565
> 
> 赞同：3
> 
> 时间：2012-07-24T03:06:04.840
> 
> 标签：xml, sql-server-2008, xquery, shred

我有一个要导入表的 xml 文件。我的 xml 文件如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xml_objects xmlns="http://www.blank.info/ns/2002/ewobjects">
<item_id item_id="41-FE-001">
<class display="true">
<class_name>FEEDER</class_name>
</class>
<name display="true">
<name_value>41-FE-001</name_value>
</name>
<attributes>
<attribute>
<attributename>Type</attributename>
<value>EQUIP</value>
</attribute>
<attribute>
<attributename>Tag No</attributename>
<value>41-FE-001</value>
</attribute>
</attributes>
</item_id>
</xml_object> 
```

这是我正在使用的 SQL。我无法让 SQL 返回任何值：

```
CREATE TABLE [dbo].[item_data](
[item_id] [nchar](15) NULL,
[class] [nchar](10) NULL,
) ON [PRIMARY]
GO

--INSERT INTO item_data (item_id) 
SELECT xmldata.value('(@item_id)', 'NCHAR') AS item_id       
FROM ( 
SELECT CAST(x AS XML)
FROM OPENROWSET(BULK 'C:\xmlfile.xml',
SINGLE_BLOB) AS T(x)) AS T(x)
CROSS APPLY x.nodes('//xml_objects/item_id') AS X(xmldata); 
```

我尝试了各种 xpath 和 SQL 语法。我无法让 SQL 返回任何值。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:59:26.047

您忽略了在根元素上定义的 XML 命名空间：

```
<xml_objects xmlns="http://www.blank.info/ns/2002/ewobjects">
             *********************************************** 
```

您需要将此添加到您的查询中：

```
;WITH XMLNAMESPACES(DEFAULT 'http://www.blank.info/ns/2002/ewobjects')
SELECT 
     xmldata.value('(@item_id)', 'NCHAR') AS item_id       
FROM 
    (SELECT CAST(x AS XML)
     FROM OPENROWSET(BULK 'C:\xmlfile.xml',
     SINGLE_BLOB) AS T(x)) AS T(x)
CROSS APPLY 
     x.nodes('//xml_objects/item_id') AS X(xmldata); 
```

# python - Python OpenCV 线程

> ID：11623566
> 
> 赞同：2
> 
> 时间：2012-07-24T03:06:10.987
> 
> 标签：python, multithreading, opencv, serversocket

Python 脚本从套接字读取 png 图像，然后尝试使用 OpenCV 像慢速视频一样显示。有 2 个类 server.py 和 Worker.py。Server.py 从套接字接收原始 png 并将其放在队列中。在其自己的线程中，工作人员将 png 出列并显示它。只有第一张图像正确显示。尽管调用了 ShowImage 和 WaitKey，但其他图像不可见（即保留第一张图像）。

线程模型对吗？似乎服务器套接字线程阻止了 OpenCV 线程的显示。有没有办法将服务器套接字放在后台线程上？从后台线程调用 ShowWINdow 和 WaitKey 是否正确？我对 Mac 上的 Python 或 OpenCV 线程了解不多。任何意见和建议将不胜感激。

服务器.py：

```
#! /usr/bin/env python
import sys
import SocketServer
import socket
import subprocess
import time
import cv
import Worker
import ShowImage

HOST = 'andrew-rosenblums-macbook-pro.local'
PORT = 3001
FRAME_SIZE = 144*192
data = ''
worker = Worker.Worker()

class SingleTCPHandler(SocketServer.BaseRequestHandler):
    imagesSaved = 0

    "One instance per connection.  Override handle(self) to customize action."
    def handle(self):
        # self.request is the client connection
        print "connection received.."
        while True:
            #print "calling rcv"
            messageLength = self.request.recv(6)  # Read 6 ascii char image size
            cv.WaitKey(30)
            if (len(messageLength) > 0):
                print "messageLength=" + messageLength
                iLength = int(messageLength)
                message = ''
                while (iLength > 0):
                    if (iLength > 1024):
                        chunk = self.request.recv(1024)
                    else:
                        chunk = self.request.recv(iLength)
                    iLength -= len(chunk)
                    message += chunk
                print "rcvd imsg of len=" + str(len(message))
                worker.write(message)

                if (SingleTCPHandler.imagesSaved == 0):
                    SingleTCPHandler.imagesSaved += 1

        print "closing stream"
        self.request.close()
        print "done receiving"

    def finish(self):
        print "finish called"

class SimpleServer(SocketServer.ThreadingMixIn, SocketServer.TCPServer):
    # Ctrl-C will cleanly kill all spawned threads
    daemon_threads = True
    # much faster rebinding
    allow_reuse_address = True

    def __init__(self, server_address, RequestHandlerClass):
        SocketServer.TCPServer.__init__(self, server_address, RequestHandlerClass)

if __name__ == "__main__":
    server = SimpleServer((HOST, PORT), SingleTCPHandler)
    # terminate with Ctrl-C
    try:
        print "waiting for connections..."
        server.serve_forever()
    except KeyboardInterrupt:
        sys.exit(0) 
```

工人.py

```
#! /usr/bin/env python
import time
from threading import Thread
from Queue import Queue
import sys
import cv
import cv2
import numpy as np
import Image
from cStringIO import StringIO

class Worker(Thread):

    count = 0

    def __init__(self):
        Thread.__init__(self)

        self.cvImage = None
        cv.NamedWindow('display')
        cv.MoveWindow('display', 10, 10)

        self.queue = Queue()
        self.writer = None
        # Daemon threads won't prevent process from exiting
        self.setDaemon(True)

        # Start ourselves automatically
        self.start()
        print "Worker started"

    def run(self):
        writer = None
        while 1:
            frame = None

            try:
                #frame = self.queue.get(block=False)
                frame = self.queue.get()
                print "display izeof rawImage=" + str(len(frame))

               #convert to mat
                pilImage = Image.open(StringIO(frame));#.convert("RGB");

                bgrImage = np.array(pilImage)

                cvBgrImage = cv.fromarray(bgrImage)
                self.cvImage = cv.CreateImage(cv.GetSize(cvBgrImage),8,3)
                cv.CvtColor(cvBgrImage, self.cvImage, cv.CV_BGR2RGB)

                #show it
                cv.ShowImage('display', self.cvImage)
                cv.WaitKey(30)
                self.cvImage = None
            except:
                frame = None

        print "done with thread"

    # Requests from main thread
    def write(self, frame):
        self.queue.put(frame)

    def stop(self):
        self.queue.put(None) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T13:40:53.380

答案很简单：OpenCV 的`ShowImage`并且`WaitKey`必须在主线程中。我猜这是GUI线程。ServerSockets 被推送到自己的线程，这在 Python 中非常容易。

您所需要的只是：

```
UDPThread = Thread(target = UDPServer.run)
s.start(UPDThread) 
```

# c++ - 链表数组大小不同

> ID：11623568
> 
> 赞同：1
> 
> 时间：2012-07-24T03:06:20.317
> 
> 标签：c++, arrays, struct, linked-list

这是我的代码：

```
using namespace std;
class Network
{
    // private function to constructe the nodes with a left and right childed
    private:

        struct node
        {

           node* left;
           node* mid;
           node* right;
           char data;
        };
        node* root;
    // public function for the the program
    public:
        char *Nodes ;
        Network()
        {
           root = NULL;
        }

        char Link(char,char);

        node* Network::Order(char* temp){

            cout << "Order:" << sizeof(temp);

            node* store; 
            store = new node[sizeof(temp)];

};
};

char Network::Link(char temp, char temp1){

};

// Smaller elements go left
// larger elements go right

/*
 * 
 */
int main() {

    Network object;
    char p[11];
    p[0] = 'a';
    p[1] = 'b';

    cout << "p:" << sizeof(p);
    object.Order(p);
    return 0;
} 
```

输出：p:11 订单：4

为什么订单 4 它应该是 11 因为我传递了数组 pt

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:09:32.363

当传递给期望指针的函数时，您的数组将衰减为指针。函数中的`sizeof`运算符`Order`返回指针的大小，在您的体系结构中为 4 个字节。

> (C99, 6.3.2.1p3) “除非它是 sizeof 运算符或一元 & 运算符的操作数，或者是用于初始化数组的字符串字面量，否则类型为“类型数组”的表达式将转换为类型为“类型指针”的表达式，它指向数组对象的初始元素并且不是左值。”

# php - 获取变量并将其保存在同一个php文件中？

> ID：11623578
> 
> 赞同：0
> 
> 时间：2012-07-24T03:07:48.213
> 
> 标签：php, variables, save

我试着这样做

```
<h1>My Css Colors</h1>
<form action="" method="get">
    <input type="text" name="csscolor"/>
    <input type="submit" value="Save">
</form>

<div ID="csscolors">
</ul>
<?php
    $csscolor = $_GET['csscolor'];
    echo '<li>'. $csscolor .'</li>'; // I used `echo` b/c I don't know anything else
?>
</ul>
</div> 
```

如何将其保存`<li>some csscolor</li>`在同一个 php 文件中，以便我可以添加任意数量的文件`li`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:18:10.420

如果您想保存一个值，最好的办法是放入数据库中，而不是尝试将其硬编码到 PHP 文件中（尤其是如果您想添加更多`<li>`. 使用[PDO](http://php.net/manual/en/book.pdo.php)或[MySQLi](http://php.net/manual/en/book.mysqli.php)类与您的数据库。我建议让 XAMPP/WAMP 在您的家用机器上进行实验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:39:25.903

You might want to use **cookies or session** to store all the CSS colors.

Below is sample code using ***$SESSION***.

```
<?php 
   // this starts the session 
   session_start(); 

   // get all CSS colors in SESSION
   $allCssColors=$_SESSION['color'];
   if (!isset($allCssColors)) {
      $allCssColors=array();
   }
   $allCssColors[count($allCssColors)]=$_GET['csscolor']; // add the new one

   // now display all the CSS colors
   for ($i = 0; $i < count($allCssColors); ++$i) {
      print '<li>'.$allCssColors[$i].'</li>'
   } 
   $_SESSION['color'] = $allCssColors; // save all CSS colors in SESSION

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T03:32:25.663

查看您是否需要在某些页面之间维护多个 css 类并一次又一次地使用@SomeKittens，提到您可以将这些值存储到数据库中，但如果您的应用程序没有那么多的数据库权衡您可以将其存储到 CONSTANT 变量中，例如

```
define('CSSCOLOR', '#EFEFEF'); \\ Or any color code you want to put in second parameter. 
```

然后将此代码放在一个全局文件中，并且您要在该文件中使用此代码的位置包含该文件，在您要使用此常量的位置，您可以像这样使用它

```
echo '<li>'. CSSCOLOR .'</li>'; 
```

另一种方法是您可以将其存储到会话或 cookie 中，如 hidemaru 拳头在登录时提到的或一些全局包含文件中所说的 global.php

```
session_start(); 
$_SESSION['color'] = "#DEFDEF"; // any of your color code here 
```

在你想使用的文件中说 index.php

```
session_start(); 
echo '<li>'. $_SESSION['color'] .'</li>'; 
```

希望你已经明白了。

# linux - 如何通过 PID 与进程交互

> ID：11623580
> 
> 赞同：1
> 
> 时间：2012-07-24T03:07:59.643
> 
> 标签：linux, bash, process

我正在使用 Ubuntu 12.04 。我想知道如何通过 PID 对进程进行操作。我不知道这是否可能。如果可能的话，请帮助我。操作意味着状态，进程的属性以及通过它发送命令和数据到进程 PID 。

编辑：状态是指它的工作统计数据，例如它消耗了多少内存。属性意味着重新分级该过程的信息。我想在这里了解的主要内容是通过其 PID 发送命令/数据以进行处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:20:47.893

[procfs](https://en.wikipedia.org/wiki/Procfs)是你应该看看的东西。它提供了有关该过程的大量信息。这是[proc(5) 的手册页](http://linux.die.net/man/5/proc)。基本上，您 cd 到`/proc/$PID`所有这些伪文件都包含您应该能够查看的信息。

否则，一个可以玩的好程序是`top`，甚至更好[`htop`](http://htop.sourceforge.net/)。它可以发送各种信号，并且可以观察到很多信息（状态、mem 使用情况、cpu 使用情况……）真的很棒。

除此之外，尚不清楚您要做什么，因此我保持通用。如果你想像 sarnold 所说的那样做 IPC（进程间通信），信号可能是要走的路，或者 mmap。（内存映射文件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T05:37:20.303

ps、kill 和 top 常用于与进程交互，请阅读它们的手册页。

ps 提供快照，通常是从 proc 名称中获取 pid：

例如`ps aux | grep -i sshd`

top 提供半连续的反馈（如可配置的 Windows 任务管理器......排序）

在我看来，top 会很好地了解 mem 的使用情况。不过，您需要使用 top 的交互式命令来配置以获得最佳输出。按“o”进行排序，按“f”进行我认为的字段，请阅读该人。

kill 默认情况下发送 SIGTERM （或停止进程的东西）或使用 kill -9 如果 proc 处理程序忽略 SIGTERM，kill -s SIGNAL 可用于发送任何信号，尽管如 SIGSTOP（停止 proc）和 SIGCONT（继续过程）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T05:54:48.170

不同的程序有不同的方式将进程ID作为参数。手册页是你在这里的帮助。

例如，现在`top`将给出大部分基本系统统计信息。要获得进程的最佳结果，例如`X`，此命令将为您提供所需的结果`top -n1 -b -p <pid of X>`

dir`/proc/<pid>`还将拥有所有必要的系统统计信息，您所需要的只是知道在哪里以及如何读取这些数据。

# ruby-on-rails - 使用 Ruby on Rails 每行显示 4 个条目

> ID：11623587
> 
> 赞同：0
> 
> 时间：2012-07-24T03:08:50.440
> 
> 标签：ruby-on-rails, twitter-bootstrap

我需要以 4 个条目的行显示视频。

它应该看起来像这样（`x`一个视频）：

```
x | x | x | X
x | x | x | X
x | x | x | X

```

现在，我正在调用一个`while`循环，当我可以再获取 4 个视频时，该循环将停止（因此它不会因为一行仅显示三个视频而破坏布局）。我正在使用一个变量 ( `n`) 来拍摄 4 个视频 ( `@videos[n..n+3]`)。

```
- n = 0
  - while n+4 < @videos.count do
    .row
      %ul.thumbnails            
        - @videos[n..n+3].each do |v|
          %li.span3
            # code for showing the video
    - n +=4 
```

*必须*有更好的方法来做到这一点。

**更新**

我发现了很棒的 Rails 函数[in_groups_of](http://as.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Array/Grouping.html)。

如this [SO answer所示](https://stackoverflow.com/a/4037770/1146764)

> ActiveSupport 方法 in_groups_of 接受一个数组并将其分组

**更新 2**

我的第一个更新是一个可行的解决方案，但接受的答案更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:25:19.943

您正在使用 Bootstrap 的`.thumbnails`组件，`.span3`因此您已经自动获得了四行。您不需要任何循环、嵌套列表或实用方法。

```
%ul.thumbnails            
  - @videos.each do |v|
    %li.span3
      # code for showing the video 
```

它只是工作：http: [//jsbin.com/uguqib/edit](http://jsbin.com/uguqib/edit)

PS ActiveSupport`in_groups_of`只是 Ruby 内置的包装器[`Enumerable#each_slice`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-each_slice)，添加了填充项以完善最后一组。如果你需要像这样的填充元素，你可以很容易地自己做填充：

```
- @videos += [ nil ] * ( 4 - @videos.size % 4 )
%ul.thumbnails
  - @videos.each do |v|
    %li.span3
      - if v then render_the_video_element
      - else      render_a_filler_element end 
```

# c++ - srand 在 C++ 中太慢了它返回相同的数字

> ID：11623594
> 
> 赞同：-1
> 
> 时间：2012-07-24T03:10:06.883
> 
> 标签：c++, random, time, srand

我只是想拥有一个简单的 RndInt(limit) 函数，该函数将返回以限制为限制的随机数。

```
 cout << "Enter higher limit of random range:" ;
 cin >> limit;
 while(limit != 0)

{
//        RndInt(limit);
    cout << "Random number smaller than " << limit << " is " << RndInt(limit) << endl;
    cin.get();
    cin.get();
    cout << "Other random number smaller than " << limit << " is " << RndInt(limit) << endl;
    cin.get();
    cin.get();
    cout << "There is " << RndInt(limit) << " ways I love you" <<endl ;
    cout << "Enter higher limit of random range:" ;
    cin >> limit;
}
return 0;
}

int RndInt(int limit)
{
srand(time(&base));
int rndnumber;
rndnumber=rand()%limit;
base+=100;
return rndnumber;
} 
```

我在使 RndInt 后续调用显示不同的整数时遇到问题。当我调试其对 RndInt(limit) 的良好后续调用时，会给出不同的值。但是当我尝试在没有 cin.get() 暂停的情况下运行它时，我在所有三个调用中都得到相同的数字。我发现问题是种子在同一秒内。

我的问题是如何使对 RndInt 的调用返回不同的值而不会暂停。srand 函数怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T03:12:23.090

不要`srand()`每次想要随机数时都打电话。在程序开始时调用`srand()` *一次*，然后调用`rand()`每个号码。

# php - 从 json api 到 mysql

> ID：11623598
> 
> 赞同：0
> 
> 时间：2012-07-24T03:10:49.463
> 
> 标签：php, mysql, json, api

我需要帮助将 json 数据解析到 mysql。我的代码不起作用，这是我的代码。

```
<?php
$server = "localhost";
$username = "root";
$password = "12345";
$database = "json";
mysql_connect($server,$username,$password) or die("Failed");
mysql_select_db($database) or die("Database Failed");

$url = "http://demo.miliarta.com/cityapi/all/?dealerid=TEN000005&user=dealer&passwd=dealer&cityid=316";
$string = file_get_contents($url);
$arr = json_decode($string, true);

//array instances specific to json items
$id = $arr["cityid"];
$id2 = $arr["stateid"];
$id3 = $arr["cityname"];
$id4 = $arr["statename"];
$s=0;
//Enumerating Array index
foreach($arr as $item=> $value){
    $s=count($value); // WIN
}
echo $s;
//suck the array for loop
for($i=0;$i<$s;$i++){
    $cityid= $id[0];
    $stateid = $id2[$i];
    $cityname = $id3[$i];
    $statename = $id4[0];
    mysql_query("INSERT INTO city (cityid, stateid, cityname, statename) VALUES('$cityid', '$stateid', '$cityname', '$statename')") or die (mysql_error());
}
?> 
```

问题出在第 22 行。注意：未定义的索引：C:\xampp\htdocs\json\jsontosql.php 中的 cityid 第 22 行注意：未定义的索引：C:\xampp\htdocs\json\jsontosql.php 中的 stateid 23 注意：未定义索引：第 24 行 C:\xampp\htdocs\json\jsontosql.php 中的城市名 注意：未定义索引：第 25 行 C:\xampp\htdocs\json\jsontosql.php 中的状态名 4Table 'json.city '不存在

tq 寻求帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:19:52.367

为你修好了。您的循环是错误的，您需要先查看`$arr`以获取每一行数据。

试试这个：

```
<?php
// Your database configs here

$url = "http://demo.miliarta.com/cityapi/all/?dealerid=TEN000005&user=dealer&passwd=dealer&cityid=316";
$string = file_get_contents($url);
$arr = json_decode($string, true);

foreach($arr as $item){
    $cityid = $item['cityid'];
    $stateid = $item['stateid'];
    $cityname = $item['cityname'];
    $statename = $item['statename'];

    mysql_query("INSERT INTO city (cityid, stateid, cityname, statename) VALUES('$cityid', '$stateid', '$cityname', '$statename')") or die (mysql_error());
} 
```

# r - r中的阴影三元图

> ID：11623602
> 
> 赞同：7
> 
> 时间：2012-07-24T03:11:57.553
> 
> 标签：r, plot, ggplot2, triplot

我可以使用包 klaR 找出三元图。…………

```
 require(klaR)

triplot(label = c("1, 2 or 3", "4 or 5", "6"), 
    main = "die rolls: probabilities", pch = 17) 
```

我想绘制阴影三元图，以便我可以显示特定点属于哪个类。

是否有任何软件包（已开发或未开发）可以做到这一点？或者我们可以调整可用的包来实现这一点？

![在此处输入图像描述](../Images/e7d803c284775613f5082906ef350626.png)

编辑：响应以下答案：

```
xpoint <- matrix(c(0, 0, 10,  0, 10, 0, 10,0,0, 10,10, 0, 10,0,10, 0,0, 10, 0,10,10, 10,10,10), ncol =3, byrow= TRUE)
xp <- t(apply(xpoint,1,tern2cart))
points(xp[,1], y = xp[,2], type = "p", col = "green", pch = "*", cex = 4)
text(xp[,1]-0.01,xp[,2]-0.01)
> xpoint 

       [,1] [,2] [,3]
    [1,]    0    0   10
    [2,]    0   10    0
    [3,]   10    0    0
    [4,]   10   10    0
    [5,]   10    0   10
    [6,]    0    0   10
    [7,]    0   10   10
    [8,]   10   10   10 
```

![在此处输入图像描述](../Images/b21e799f9b0360ed6fd2bef589f42efc.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-30T12:18:18.463

所以（至于我为[这个问题](https://stackoverflow.com/questions/10879361/ternary-plot-and-filled-contour/11691173 "这个问题")给出的答案），我无法使用`triplot`（因为我不知道该函数使用什么参考来绘制图表）为您提供答案，但这是一个从头开始的解决方案：

```
#First draw the empty ternary diagram:
plot(NA,NA,xlim=c(0,1),ylim=c(0,sqrt(3)/2),asp=1,bty="n",axes=F,xlab="",ylab="")
segments(0,0,0.5,sqrt(3)/2)
segments(0.5,sqrt(3)/2,1,0)
segments(1,0,0,0)

text(0,0,labels="1, 2 or 3",pos=1)
text(1,0,labels="6",pos=1)
text(0.5,sqrt(3)/2,labels="4 or 5",pos=3)

#The following function is for transforming ternary coordinates into cartesian coordinates:
tern2cart <- function(coord){
    coord[1]->x
    coord[2]->y
    coord[3]->z
    x+y+z->tot
    x/tot -> x
    y/tot -> y
    z/tot -> z
    (2*y + z)/(2*(x+y+z)) -> x1
    sqrt(3)*z/(2*(x+y+z)) -> y1
    return(c(x1,y1))
    }

#Here are your zones:
green.zone<-matrix(c(0,0,100,40,0,60,0,40,60,0,0,100),nrow=4,byrow=TRUE)
blue.zone<-matrix(c(30,10,60,30,40,30,0,70,30,0,40,60,30,10,60),nrow=5,byrow=TRUE)
purple.zone<-matrix(c(90,0,10,100,0,0,30,70,0,30,40,30,50,40,10,90,0,10),nrow=6,byrow=TRUE)
red.zone<-matrix(c(30,40,30,30,70,0,0,100,0,0,70,30,30,40,30),nrow=5,byrow=TRUE)
yellow.zone<-matrix(c(90,0,10,40,0,60,30,10,60,30,40,30,50,40,10,90,0,10),nrow=6,byrow=TRUE)

#Then transformed into cartesian coordinates:
t(apply(green.zone,1,tern2cart))->green
t(apply(blue.zone,1,tern2cart))->blue
t(apply(purple.zone,1,tern2cart))->purple
t(apply(red.zone,1,tern2cart))->red
t(apply(yellow.zone,1,tern2cart))->yellow

#And plotted:
polygon(green,col="green",border=NULL)
polygon(blue,col="blue",border=NULL)
polygon(purple,col="purple",border=NULL)
polygon(red,col="red",border=NULL)
polygon(yellow,col="yellow",border=NULL)

#And finally the grid:
a<-seq(0.9,0.1, by=-0.1)
b<-rep(0,9)
c<-seq(0.1,0.9,by=0.1)
grid<-data.frame(x=c(a, b, c, a, c, b),y=c(b, c, a, c, b, a),z=c(c, a, b, b, a, c))
t(apply(grid,1,tern2cart)) -> grid.tern
cbind(grid.tern[1:27,],grid.tern[28:54,])->grid
apply(grid,1,function(x){segments(x0=x[1],y0=x[2],x1=x[3],y1=x[4],lty=2,col="grey80")}) 
```

如果需要，您显然可以将其包装成一个函数...

![在此处输入图像描述](../Images/115c84fffe43841e17ebd78fb2d933a0.png)

**编辑：带标签**

```
paste(seq(10,90,by=10),"%")->lab
text(grid.tern[9:1,],paste(lab,"\n(1, 2 or 3)"),col="grey80",cex=0.7, pos=2)
text(grid.tern[18:10,],paste(lab,"\n(4 or 5)"),col="grey80",cex=0.7, pos=4)
text(grid.tern[27:19,],paste(lab,"\n(6)"),col="grey80",cex=0.7, pos=1) 
```

![在此处输入图像描述](../Images/cf9287957b8a7b271d25e92e57db7aa4.png)

**并在图表上绘制数据**

```
df<-data.frame('1, 2 or 3'=c(10,33.3,50,100), '6'=c(0,33.3,50,0), '4 or 5'=c(90,33.3,0,0))
df
  X1..2.or.3   X6 X4.or.5
1       10.0  0.0    90.0
2       33.3 33.3    33.3
3       50.0 50.0     0.0
4      100.0  0.0     0.0

t(apply(df, 1, tern2cart)) -> df.tern
points(df.tern, pch="*", cex=3) 
```

![在此处输入图像描述](../Images/658f6f395efdca677395f5dcf682a4b6.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-28T14:25:18.353

使用我最近通过 CRAN 发布的[ggtern](http://www.ggtern.com)包，可以获得以下内容：

![在此处输入图像描述](../Images/f6eb7f632c91fbaf774cfbf17a249ef8.png)

上面的结果可以用下面的代码来实现：

```
g <- data.frame(x=c(1,.6,.6),
                y=c(0,.4,0),
                z=c(0,0,.4),         Series="Green")
y <- data.frame(x=c(.6,.1,.1,.3,.6),
                y=c(.4,.9,.5,.3,.3),
                z=c( 0, 0,.4,.4,.1), Series="Yellow")
b <- data.frame(x=c(.6,.3,.3,.6),
                y=c(.3,.3, 0, 0),
                z=c(.1,.4,.7,.4),    Series="Blue")
r <- data.frame(x=c(.3, 0,0,.3),
                y=c(.3,.3,0, 0),
                z=c(.4,.7,1,.7),     Series="Red")
p <- data.frame(x=c(.1,0, 0,.3,.1),
                y=c(.9,1,.3,.3,.5),
                z=c( 0,0,.7,.4,.4),  Series="Purple")
DATA=rbind(g,y,b,r,p)
ggtern(data=DATA,aes(x,y,z)) + 
geom_polygon(aes(fill=Series),alpha=.5,color="black",size=0.25) +
  scale_fill_manual(values=as.character(unique(DATA$Series))) +
  theme(legend.position=c(0,1),legend.justification=c(0,1)) + 
  labs(fill="Region",title="Sample Filled Regions") 
```

# xml - xmllint ls 的输出格式是什么？

> ID：11623604
> 
> 赞同：6
> 
> 时间：2012-07-24T03:12:07.537
> 
> 标签：xml, xmllint

使用`xmllint --shell`，我执行

```
chapter > cat * 
 -------
<title>Getting to Know Penguins</title>
 -------
<abstract>
      <para>Penguins are cute.</para>
    </abstract>
 -------
<sect1>
      <title>The Head</title>
      <para>...</para>
    </sect1>
 -------
<sect1 id="penguin.coat">
      <title>The Coat</title>
      <para>...</para>
    </sect1> 
```

和

```
chapter > ls
ta-        5      
---        1 title
ta-        5      
---        3 abstract
ta-        5      
---        5 sect1
ta-        5      
c--       17 
ta-        5      
-a-        5 sect1
ta-        3 
```

“ta”、“c”和“a”代表什么，字符代表什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-10T01:29:53.157

您寻求的答案可在以下位置找到：

libxml2-2.9.0::debugXML.c:1652: xmlLsOneNode(FILE *output, xmlNodePtr 节点)

我已经按节点类型分解了输出，请注意，为方便起见，下面的后两个字符显示为“--”。实际上，对于除 XML_NAMESPACE_DECL 之外的所有节点类型，如果 node->properties 不为 NULL，则第二个字符为“a”，如果 node->nsDef 不为 NULL，则第三个字符为“n”。最后，#NC# 建议节点具有的子节点数量的数字值，而#CL# 是节点内容长度的数字值。

```
XML_ELEMENT_NODE：
--- #NC# [[(节点->ns->前缀):](节点->名称)]

XML_ATTRIBUTE_NODE：
a-- #NC# [(节点->名称)]

XML_TEXT_NODE：
t-- #CL# [xmlDebugDumpString(node->content)...|"(NULL)"]
    * 内容的字符串值最多40个字符，有的
    * 换人。空格 (' ') 替换空白字符
    * XML RFC 允许：(0x20, 0x9, 0xA, 0xD)。任何角色
    * HEX 值为 0x80 或更大以字符串形式打印：“#XXXX”

XML_CDATA_SECTION_NODE：
C--#CL#

XML_ENTITY_REF_NODE：
e-- 1 [(节点->名称)]

XML_ENTITY_NODE：
E-- 1 [(节点->名称)]

XML_PI_NODE：
p--#CL#

XML_COMMENT_NODE：
c--#CL#

XML_DOCUMENT_NODE：
d--#NC#

XML_HTML_DOCUMENT_NODE：
h--#NC#

XML_DOCUMENT_TYPE_NODE：
T-- 1

XML_DOCUMENT_FRAG_NODE：
F-- 1

XML_NOTATION_NODE：
N-- 1

XML_NAMESPACE_DECL：
n 1 [(node->prefix)|"default"] -> (node->href)

默认：
?-- 1

```

# opengl - 将 .obj 转换为 .h 但缺少 .jpg

> ID：11623607
> 
> 赞同：0
> 
> 时间：2012-07-24T03:12:25.640
> 
> 标签：opengl, .obj

我使用 obj2opengl.pl 将其中一个 .obj 模型转换为 .h 文件

它应该有一个包含对象颜色的 .jpg 文件吗？我应该在哪里或如何得到它？它是否链接到 .mtl 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T07:17:42.567

> 我使用 obj2opengl.pl 将其中一个 .obj 模型转换为 .h 文件

请停止这样做。使用适当的模型文件加载器来加载数据。

> 它应该有一个包含对象颜色的 .jpg 文件吗？我应该在哪里或如何得到它？它是否链接到 .mtl 文件？

.mtl 文件确实包含要为模型加载的纹理的文件名。这是文件加载器真正派上用场的地方。加载图像最好委托给图像加载库，如 DevIL、imlib2 或类似库。

# c++ - 将枚举传递给构造函数

> ID：11623608
> 
> 赞同：4
> 
> 时间：2012-07-24T03:12:44.230
> 
> 标签：c++, constructor, enums

我有一个基类`Shape`和一些其他派生类，例如`Circle`，`Rectangle`等等。

这是我的基类

```
class Shape {

private:
enum Color {
    Red,
    Orange,
    Yellow,
    Green
};
protected:
int X;
int Y;

// etc...
}; 
```

这是我的派生类之一

```
class Rectangle : public Shape {
private:
int Base;
int Height;
string shapeName;

//etc...
}; 
```

这就是我调用构造函数的方式：

```
Rectangle R1(1, 3, 2, 15, "Rectangle 1"); 
```

我的构造函数：

```
Rectangle::Rectangle(int x, int y, int B, int H, const string &Name)
:Shape(x, y)
{
setBase(B);
setHeight(H);
setShapeName(Name);
} 
```

`enum Color`我想向我的构造函数添加一个参数，这样我就可以在我的基类中使用形状的颜色。我怎样才能做到这一点？我还想将颜色打印为`string`. 我不知道如何`enum`在构造函数中用作参数。

任何帮助表示赞赏...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T03:41:11.890

首先，您应该将颜色设为受保护或公开。将颜色从枚举变为字符串的一种简单方法是使用数组。

```
class Shape {
public:
    enum Color {
        Red = 0, // although it will also be 0 if you don't write this
        Orange, // this will be 1
        Yellow,
        Green
    };

};

class Rectangle : public Shape {
public:
    Rectangle(int x, int y, int B, int H, Color color);
};

string getColorName(Shape::Color color) {
    string colorName[] = {"Red", "Orange", "Yellow", "Green"};
    return colorName[color];
}

void test() {
    // now you may call like this:
    Rectangle r(1,2,3,4, Shape::Red);
    // get string like this:
    string colorStr = getColorName(Shape::Yellow);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:26:43.770

an 的类型名`enum`就是它的名字，*在类内部，*这个名字被隐式解析为属于这个类。在这种情况下，像这样的构造函数参数`Shape(Color color)`将定义一个名为的基类构造函数参数`color`，它具有您的`enum Color`类型。

然后您的派生类可以调用基构造函数，例如`Rectangle(int x, int y, int width, int height, const char* name, Color color): Shape(color) { ... }`.

请注意，您还必须更改`enum`:`private:`枚举的可见性，子类将无法使用枚举，因此它必须至少位于基类的 a`protected:`或`public:`部分中`Shape`。

至于`string`...请更好地描述你打算做什么。例如，您是否尝试打印颜色的名称或它们的数值`enum`？如果是前者，您可能会编写一个这样的辅助方法：

```
void printColor (Color color, std::ostream& os)
{
    switch (color)
    {
    case Red:
        os << "Red";
        break;
    . . . // and so on
    }
} 
```

# java - 这个方法必须返回一个 GObject 类型的结果——但是看看——我告诉它——

> ID：11623616
> 
> 赞同：1
> 
> 时间：2012-07-24T03:13:58.837
> 
> 标签：java

我想知道当我输入什么应该是一个非常好的方法时会怎么想，但它并没有被认为是一种方法。这里是。

```
private GObject getCollidingObject() {
    gobj = getElementAt(ball.getX(),ball.getY());
    if (gobj != null) {
        return gobj;
    }
    gobj = getElementAt(ball.getX()+BALL_RADIUS,ball.getY());
    if (gobj != null) {
        return gobj;
    }
    gobj = getElementAt(ball.getX(),ball.getY()+BALL_RADIUS);
    if (gobj != null) {
        return gobj;
    }
    gobj = getElementAt(ball.getX()+BALL_RADIUS,ball.getY()+BALL_RADIUS);
    if (gobj != null) {
        return gobj;
    }
} 
```

现在 eclipse 告诉我“这个方法必须返回 GObject 类型的结果”，并且没有以紫色突出显示 GObject，这是它通常告诉我它对我的工作感到满意的方式。

我应该在想什么？我仔细查看了所有开闭括号，所有其他方法都在工作，所以我认为我没有将此方法放在错误的范围内......

在我所有其他实例变量的程序底部，我有

```
private GObject gobj; 
```

但这似乎对我没有帮助。

感谢您的任何指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:43:24.630

我发现您的功能存在一些问题；首先，您不在`gobj`方法体内声明。您在其他地方发表了评论，让我认为您正在尝试`return`使用该类的数据成员；这是奇怪的设计，至少可以这么说。（通常，目标是让每个方法尽可能独立。如果您要共享这样的数据，您可能会引入以后难以发现的错误。）

您的函数并不*总是*`return`返回数据——有时它会在没有明确声明的情况下从函数末尾掉下来。*您*可能知道这四个条件之一将始终为真，但编译器不知道 - 老实说，这将是正确的，因为您将来不可避免地会破坏该条件。

这段代码很难以一种更美观的方式编写。（好吧，如果 Java 的[`||`运算符](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op2.html)也`null`可以使用，这可能是一个非常漂亮的短函数。但 Java`||`只能使用`true`and `false`。）

重写函数最简单的方法可能是在最后一次尝试后移除保护：

```
private GObject getCollidingObject() {
    GObject gobj;

    gobj = getElementAt(ball.getX(),ball.getY());
    if (gobj != null) {
        return gobj;
    }
    gobj = getElementAt(ball.getX()+BALL_RADIUS,ball.getY());
    if (gobj != null) {
        return gobj;
    }
    gobj = getElementAt(ball.getX(),ball.getY()+BALL_RADIUS);
    if (gobj != null) {
        return gobj;
    }
    gobj = getElementAt(ball.getX()+BALL_RADIUS,ball.getY()+BALL_RADIUS);

    return gobj;
} 
```

`return`这样，无论您通过该函数采用哪条路径，您都将至少执行一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:16:36.883

编译器抱怨您`gobj`没有声明为`GObject`. 它实际上是一个实例并不重要，它需要被声明为返回类型（或其子类/实现的类或接口之一）或被成功转换为这样。

声明为什么`gobj`？

编辑：当然，您需要确保在每种情况下都有一个 return 语句。`if`如果您的所有语句都评估为，则您没有默认值`false`。

# maven - Maven 发布的区别：使用 jython 时准备和安装 jars

> ID：11623619
> 
> 赞同：2
> 
> 时间：2012-07-24T03:14:10.723
> 
> 标签：maven, jython, maven-release-plugin

我正在使用 Maven 3.0.4 以及 Jython 2.5.2 和 Pygments 1.5（通过鸡蛋）。我已将 jython-compile-maven-plugin 配置为，

```
<plugin>
<groupId>net.sf.mavenjython</groupId>
<artifactId>jython-compile-maven-plugin</artifactId>
<version>1.2</version>
<executions>
    <execution>
        <phase>package</phase>
        <goals>
            <goal>jython</goal>
        </goals>
    </execution>
</executions>
<configuration>
    <libraries>
        <!-- Install the latest pygments library -->
        <param>Pygments</param>
    </libraries>
</configuration> 
```

运行**mvn install**创建的 JAR 包含嵌入在**Lib**文件夹中的**Pygments库。**这确保我所有的代码都能正常工作。

 **当我运行**mvn release:prepare**命令时，问题就开始了。在这种情况下，只有我的代码进入 JAR，而**Pygments**库被排除在外。如果我查看**target/classes**文件夹，它包含我的代码和所需的 pygments 库。

关于我可能遗漏或做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T03:27:09.250

经过大量的试运行后，我能够自行解决问题。该解决方案使用配置**maven-jar-plugin**以包含**target/classes**文件夹中的所有文件。这样，**install**和**release:prepare**目标都会构建完全相同的二进制文件。

```
<plugin>
<artifactId>maven-jar-plugin</artifactId>
<configuration>
    <includes>
        <include>**</include>
    </includes>
</configuration>
<executions>
    <execution>
        <phase>package</phase>
        <goals>
            <goal>jar</goal>
        </goals>
    </execution>
</executions>
</plugin> 
```

我用于项目的整个构建条目如下：

```
<build>
<plugins>
    <!-- set compilation properties -->
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
            <source>1.6</source>
            <target>1.6</target>
        </configuration>
    </plugin>

    <!-- Generate the project-javadoc.jar for OSS repository -->
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-javadoc-plugin</artifactId>
        <version>2.8.1</version>
    </plugin>

    <!-- Generate the project-sources.jar for OSS repository -->
    <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-source-plugin</artifactId>
        <version>2.1.2</version>
    </plugin>

    <!-- Install Jython and Pygments library -->
    <plugin>
        <groupId>net.sf.mavenjython</groupId>
        <artifactId>jython-compile-maven-plugin</artifactId>
        <version>1.2</version>
        <executions>
            <execution>
                <phase>package</phase>
                <goals>
                    <goal>jython</goal>
                </goals>
            </execution>
        </executions>
        <configuration>
            <libraries>
                <!-- Install the latest pygments library -->
                <param>Pygments</param>
            </libraries>
        </configuration>
    </plugin>       

    <plugin>
        <artifactId>maven-jar-plugin</artifactId>
        <configuration>
            <includes>
                <include>**</include>
            </includes>
        </configuration>
        <executions>
            <execution>
                <phase>package</phase>
                <goals>
                    <goal>jar</goal>
                </goals>
            </execution>
        </executions>
    </plugin>
</plugins>
</build> 
```

希望这可以帮助。**

# android - JNI 全局引用泄漏以及如何调试

> ID：11623624
> 
> 赞同：0
> 
> 时间：2012-07-24T03:14:44.777
> 
> 标签：android, memory-leaks, java-native-interface, native-code

我正在测试我的应用程序，发现“GREF 超过 2001”的问题。对于这种特殊情况，我可以看到在系统进程和应用程序进程中使用`dumpsys meminfo`. 我有两个问题：（1）Binder 泄漏是否特定于旧版本的 Android？(2) 一般来说，我们如何调试 GREF 问题（或原生泄漏）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T04:00:28.470

一般来说，这是一个难题。与调试使用本机库的桌面 Java 应用程序相比，没有太大区别。更多细节将在稍后发布。

# api - 如何将待处理状态更改为已支付状态

> ID：11623625
> 
> 赞同：1
> 
> 时间：2012-07-24T03:14:59.317
> 
> 标签：api, shopify

我有一家商店，它通过使用其他付款方式累积了许多无需信用卡即可接受的订单。因此，它们被记录为未结、挂单。使用 API，我需要能够创建一个将状态从 Pending 更改为 Paid 的新事务。

当我针对类型设置为“捕获”的待处理订单创建新交易时，API 返回 403 禁止，这是有道理的，因为它旨在从信用卡中捕获授权付款。

您能否在 API 中添加一种交易类型，以允许将状态从待处理更改为已付款。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T21:59:02.507

`capture`仅当您尝试使用除 之外的其他类型，或者您实际上无权创建事务时，才应返回 403 Forbidden 。仔细检查应用程序的权限以确保您拥有`write_orders`权限。如果您这样做，请向 Shopify 发送一封包含应用详细信息的电子邮件，以便我们进一步调查。

# c++ - 我可以使用什么库在我的 GUI 中显示 3D 图像和/或点云？

> ID：11623626
> 
> 赞同：1
> 
> 时间：2012-07-24T03:15:12.563
> 
> 标签：c++, qt, point-clouds, point-cloud-library

我目前正在用 Qt (C++) 编写一个 GUI，我一直在寻找可以让我打开 PCD 图像（点云）的东西，以及拖动图像的能力。

我查看了 Blender 和 MeshLab API（后者违背了我的理解），最近 PCLVisualizer 没有运气。

任何关于最简单方法的输入将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:21:31.510

云查看器：

[http://pointclouds.org/documentation/tutorials/cloud_viewer.php#cloud-viewer](http://pointclouds.org/documentation/tutorials/cloud_viewer.php#cloud-viewer)

将允许您拥有这种可视化。如果您想查看 pcd 文件，您需要对其进行解码并创建一个点云以使用此可视化，但它应该很容易编辑。

您可以使用此链接：

[http://pointclouds.org/documentation/tutorials/reading_pcd.php#reading-pcd](http://pointclouds.org/documentation/tutorials/reading_pcd.php#reading-pcd)

它将教阅读 PCD 文件并创建点云。

结合这些应该可以让您轻松地可视化 PCD 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T20:50:07.167

由于您是在 Qt 中编写 GUI，因此您可能希望使用为显示 3D 点云而开发的 Qt 小部件，以便与 PCL 库一起使用。它由 Walter Lucetti 编写，可在他的公司网站[Rekno.it](http://www.rekno.it/page.php?page=Code)上找到。

不幸的是，那里不再提供代码。快速的网络搜索将我指向这个[github 存储库](http://code.google.com/p/miminect)，它仍然保存着小部件代码的副本。相关类是`CPCLOpenglWidget`. 您还可以找到用于实时点云可视化的 PCL+QT+Kinect 集成的完整示例。

# matlab - 如果 csvread 失败则跳过文件 Matlab

> ID：11623631
> 
> 赞同：2
> 
> 时间：2012-07-24T03:16:22.647
> 
> 标签：matlab, file-io, csv, error-handling

所以我正在阅读一堆日志文件。它们中的大多数都可以与 csvread 一起使用，但有些是空的。当您将一个空文件传递给 csvread 时，您会得到以下回报：

```
Error using dlmread (line 139)
Badly formed format string.

Error in csvread (line 48)
    m=dlmread(filename, ',', r, c);

Error in CreateBDTable (line 15)
        digArea = csvread(sprintf('Converted_Logs\\DigAreaPoints\\%s', file2(j).name)); 
```

有没有办法捕捉或防止这种情况并跳过这个文件？还是我需要做一些预处理并查看文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T03:20:46.567

像大多数语言一样，matlab 有一个“尝试”语句，可以让您忽略错误。

```
for file = files
    try
        csv = load(file.name);
        % do stuff
    catch err
        % do nothing?
    end
end 
```

# symfony - 无法阻止 Symfony 2 重复字段冒泡其错误？

> ID：11623636
> 
> 赞同：0
> 
> 时间：2012-07-24T03:16:52.070
> 
> 标签：symfony, twig, symfony-forms

我无法让[重复的字段类型](http://symfony.com/doc/current/reference/forms/types/repeated.html)不冒泡错误（例如，当字段不匹配时）到父主窗体。这里是`$plain_password`属性：

```
/**
 * @ORM\Entity
 */
class User implements
    \Symfony\Component\Security\Core\User\AdvancedUserInterface, \Serializable
{
    /**
     * @Assert\NotBlank()
     * @Assert\MinLength(limit=6)
     * @Assert\MaxLength(limit=32)
     */
    public $plain_password;
} 
```

以及表格的相关部分：

```
$builder->add('plain_password', 'repeated', array(
    'type'        => 'password',
    'first_name'  => 'Password *',
    'second_name' => 'Conferma password *',
)); 
```

当用户输入无效值时，错误将传递给父表单并呈现。请参阅[Issue #1971](https://github.com/symfony/symfony/issues/1971)，但它应该被关闭！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T08:43:36.063

这在 Symfony 2.1 中已修复，这就是关闭票证的原因。不幸的是，它不能向后移植到 2.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T12:16:21.907

如果您以显式方式呈现字段，则可以使用此语法仅显示您感兴趣的错误

```
{{ form_errors(form.fieldName) }} 
```

这样，您可以仅将冒泡“util”用于您感兴趣的字段，或者，如果您不感兴趣，则根本不要放入`form_errors`您的树枝模板中。

# abap - SELECT 语句中有多个条件？

> ID：11623637
> 
> 赞同：5
> 
> 时间：2012-07-24T03:17:02.127
> 
> 标签：abap, opensql

首先，我没有使用 ABAP 的经验，我在这里进行猜测。

我想在现有报告中向 SELECT 添加条件。现有代码如下所示：

```
SELECT SINGLE *
  FROM EKPO
  WHERE EBELN = GT_MSEG-EBELN
  AND   EBELP = GT_MSEG-EBELP. 
```

如果字段 F1 为某个值且字段 F2 为 0，我想添加一个条件来排除记录（两个条件都必须为真才能排除记录）。我试过这个：

```
SELECT SINGLE *
  FROM EKPO
  WHERE EBELN = GT_MSEG-EBELN
  AND   EBELP = GT_MSEG-EBELP
  AND NOT (F1 = 'value' AND F2 = '0'). 
```

我收到语法错误：字段“F1 = 'value' AND F2 = '0'”未知。它既不在指定的表之一中，也不由“DATA”语句定义。

我检查过，EKPO 表中肯定存在字段 F1 和 F2。似乎括号使编译器将内容视为字段名称，但我不知道为什么。

语法是否不正确，我是否在某处遗漏了定义，或两者兼而有之？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-24T04:03:25.737

```
SELECT SINGLE *
  FROM EKPO
  WHERE EBELN = GT_MSEG-EBELN
  AND   EBELP = GT_MSEG-EBELP
  AND NOT ( F1 = 'value' AND F2 = '0' ). 
```

这行得通。基本上我只需要一个与括号相邻的空间。

# iphone - iPhone 4 前置摄像头视野（FaceTime FOV）

> ID：11623639
> 
> 赞同：2
> 
> 时间：2012-07-24T03:17:18.310
> 
> 标签：iphone, augmented-reality, camera-calibration

[这个问题](https://stackoverflow.com/questions/3594199/iphone-4-camera-specifications-field-of-view-vertical-horizontal-angle)和其他几个在线资源列出了主相机的FOV。我对 FaceTime 摄像头也有同样的疑惑。更大吗？较少的？

# sql - SQL Server CE 抛出错误 使用 COALESCE 时参数无效

> ID：11623643
> 
> 赞同：1
> 
> 时间：2012-07-24T03:17:56.190
> 
> 标签：sql, sql-server-ce, coalesce

看来SQL Server CE 不喜欢`COALESCE`我的专栏。

如果我的查询有`COALESCE(ep.value, '') as id`，查询失败

> 参数无效

我试过使用 ( `case ep.value when null then '' else ep.value end`) 但后来我得到了其他关于`NTEXT`等的错误。

有谁知道将空值转换为非空值的另一种方法？

更新：

完整的查询相当复杂，需要很长时间才能解释，但这里是为了好奇。

```
 SELECT COALESCE(ep.value, '') as domainId , [p].[id], [p].[firstName], [p].[middleName], [p].[lastName], [p].[isDeleted], ...    
FROM Patient p 

INNER JOIN PatientOrganisation po on p.id = po.patientFk  

left join extendedproperty ep on ep.entityId = p.id 

left join (select sgu.id, sgu.unitFk 
           from StaffGroupUnit sgu 
           where sgu.staffGroupFk = '3d364f5b-b5ff-456a-bf33-d8b48bf195b2' and sgu.isDeleted = 0) as bat on bat.unitFk = po.unitFk 

where p.isDeleted = 0 and po.isDeleted = 0  AND 
      COALESCE(ep.metadatafk,'55b009d5-cead-4b62-ad04-526b57a02ed2')='55b009d5-cead-4b62-ad04-526b57a02ed2' and 
      COALESCE(ep.isdeleted,0)=0  AND 
      (not exists(select 1 from staffgroupunit sgu where sgu.staffGroupFk = '3d364f5b-b5ff-456a-bf33-d8b48bf195b2' and sgu.isDeleted=0) OR bat.id IS NOT NULL)  
order by p.lastName, p.firstName 
```

现在是的，我知道这个查询是可怕的，我实际上已经通过删除它的某些部分来解决这个问题。真正有趣的是，这个查询大部分都可以工作。当它因“参数无效”而失败时，我可以使用 Visual Studio 或 Management Studio 运行完全相同的查询，它会正常工作。

我们正在使用 CE 3.5，因为我们的产品之一是 Windows Mobile。我怀疑这只是 CE 中的一个错误，升级将修复。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:37:37.257

# javascript - 所有值的 ember.js 观察者

> ID：11623645
> 
> 赞同：4
> 
> 时间：2012-07-24T03:18:20.797
> 
> 标签：javascript, ember.js

在 Ember.js 中，是否有一种添加观察者的好方法来观察子类实例的所有变化`Ember.Object`？

即*（咖啡脚本）*

```
Bat = Ember.Object.extend
    name: null
    age: null

hank = Bat.create
    name: 'Hank'
    age: 2

#Something like this
hank.addObserverToAll myClass, 'handleChange' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-27T00:15:59.827

这是一个实现：http: [//jsfiddle.net/Sly7/GMwCu/](http://jsfiddle.net/Sly7/GMwCu/)

```
App = Ember.Application.create();

App.WatchedObject = Ember.Object.extend({
  firstProp: null,
  secondProp: "bar",

  init: function(){
    this._super();
    var self = this;
    Ember.keys(this).forEach(function(key){
      if(Ember.typeOf(self.get(key)) !== 'function'){
        self.addObserver(key, function(){
          console.log(self.get(key));
        });
      }
    }); 
  }
});

App.watched = App.WatchedObject.create({
  firstProp:"foo",
  plop: function(){},
  thirdProp: 'far'
});

App.watched.set('firstProp', 'trigObserver');
App.watched.set('secondProp', 'doesNotTrigObserver');
App.watched.set('thirdProp', 'alsoTrigObserver'); 
```

​</p>

正如你所看到的，它只处理属性，而不是函数（我认为这是你想要的）。
您还可以意识到它仅适用于传递给`create()`方法的属性，而不适用于类定义中指定的属性（即 using `extend`）。

# css - 如何使用 Selenium IDE 查找包含特定文本的一组类

> ID：11623646
> 
> 赞同：0
> 
> 时间：2012-07-24T03:18:20.670
> 
> 标签：css, xpath, selenium, selenium-ide

我正在尝试测试正确的标题、摘要和链接是否出现在搜索结果中。例如，在下面的示例中，我想确认至少有一条记录包含标题“Beta 版标题”、包含文本“Beta 版摘要”的摘要以及一个名为“链接”的链接。

```
<ul>
  <li class="results">
    <h2 class="title">Title for Alpha</h2>
    <div class="summary">Summary for Alpha...</li>
    <div class="link"><a href="http://www.example.com">Link</a>
 </li>
 <li class="results">
    <h2 class="title">Title for Beta</h2>
    <div class="summary">Summary for Beta...</li>
    <div class="link"><a href="http://www.example.com">Link</a>
 </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T07:49:00.247

有很多方法可以选择它们。一种是使用 CSS 类。

```
HtmlUnitDriver driver = new HtmlUnitDriver();

driver.get("...");

List<WebElement> titles = driver.findElements(By.className("title"));
List<WebElement> summarys = driver.findElements(By.className("summary"));
List<WebElement> links = driver.findElements(By.className("link"));

for (WebElement webElement : titles) {
    String innerText = webElement.getText();

    // do your test....
} 
```

如果您的页面结构更复杂，您也可以使用 XPath 来做到这一点。

如果你是 Selenium 的新手，你应该看看[PageFactory](http://code.google.com/p/selenium/wiki/PageFactory "页面工厂") Pattern。这是编写更简洁代码的好方法。

在按元素选择元素的不寻常方式中，`InnerText`您可以使用 XPath。此 XPath 选择所有包含“Title for Alpha”的元素作为`InnerText`

```
List<WebElement> titles = driver.findElements(By.xpath("//*[contains(text(), 'Title for Alpha')]")); 
```

# c++ - 仅当类覆盖方法时，动态加载的共享库中实例化的类的 XCode 4.3/4.4 类型信息才会丢失

> ID：11623650
> 
> 赞同：4
> 
> 时间：2012-07-24T03:18:49.970
> 
> 标签：c++, xcode, llvm, clang, dynamic-cast

我在运行时加载的共享库中实例化的对象上使用 dynamic_cast 时遇到了一个问题，但前提是该类包含覆盖另一个方法的方法。

我将 Xcode 4.3 与“Apple LLVM 3.1 编译器”一起使用我已经在 linux 上使用 gcc 和 clang 编译了相同的代码并且没有问题，所以我假设它是 Xcode 中的编译器错误，但有人看过这个前？

假设在名为“test3.h”的头文件中定义类

```
#pragma once

class c1
{
public:
 virtual ~c1 ();
 virtual void foo ();
};

class c2 : public c1
{
public:
 void foo () override;
};

class c3 : public c1
{
public:
}; 
```

假设在名为“test3.cpp”的源文件中的静态库中的实现代码

```
#include "test3.h"

c1::~c1 ()
{
}

void c1::foo ()
{
}

void c2::foo ()
{
} 
```

假设在名为 test2.cpp 的源文件中有一个简单的动态库

```
#include "test3.h"

extern "C"
c1 * get1 ()
{
 return new c2;
}

extern "C"
c1 * get2 ()
{
 return new c3;
} 
```

假设在名为 test1.cpp 的源文件中有一个简单的可执行应用程序

```
#include "test3.h"
#include <dlfcn.h>
#include <iostream>

int main ()
{
 auto lib (dlopen ("libtest2.dylib", RTLD_NOW | RTLD_GLOBAL));
 auto a1 (dlsym (lib, "get1"));
 auto a2 (dlsym (lib, "get2"));
 auto f1 ((c1 * (*) ())a1);
 auto f2 ((c1 * (*) ())a2);
 auto o1 (f1 ());
 auto o2 (f2 ());
 auto d1 (dynamic_cast <c2 *> (o1));
 auto d2 (dynamic_cast <c3 *> (o2));
 auto result1 (d1 != 0);
 auto result2 (d2 != 0);
 std::cout << result1 << std::endl;
 std::cout << result2 << std::endl;
} 
```

运行测试程序时，result1 为假，而 result2 为真。我期望 result1 和 result2 都是真的。

有没有人看到这个或可以想到一个解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T05:30:28.310

我认为这个问题的原因是双重的。首先，动态转换在 RTTI 对象上使用相等比较。其次，有两个：一个在主线，一个在动态库。

此问题的解决方法应该是确保要共享的类位于单独的动态链接库中，并且由您的主线和所有其他共享库链接到。

确实它是库/编译器中的一个错误：它不应该使用指针相等来进行动态类型比较。

* * *

哎呀。我试过了，但它并没有解决我的问题（g++ 也曾经把它搞砸了）。奇怪的是，我在不同的库中正确地捕获了异常，重新抛出它，通过基类指针正确地捕获它，但是 dynamic_cast 失败了。所以我的建议似乎不起作用（在 OSX 上）。对不起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T15:43:27.430

如果您打算将它们从 a 传递`.dylib`到另一个应用程序，则不能将静态库用于 c++ 类的实现代码 - 您必须使用共享对象。

原因是在链接时，您最终会在 和 中获得类型信息的私有`libtest2.dylib`副本`test1`；他们将彼此不兼容。

如果你想让它工作，你需要从链接到应用程序`test3.cpp/h`的 a中导出类。`.dylib``libtest2.dylib``test1`

示例`Makefile`：

```
CXX=clang
CXXFLAGS=-std=c++11

all: libshlib.dylib libtest2.dylib test1

clean:
    rm -f *.o test1 *.dylib

test3.o: test3.cpp test3.h
    $(CXX) $(CXXFLAGS) -c -fPIC test3.cpp -o test3.o

libshlib.dylib: test3.o
    $(CXX) $(CXXFLAGS) -fPIC -shared test3.o -o $@ -lstdc++

test2.o: test2.cpp test3.h
    $(CXX) $(CXXFLAGS) -c -fPIC test2.cpp -o test2.o

libtest2.dylib: libshlib.dylib test2.o
    $(CXX) $(CXXFLAGS) -o $@ -shared test2.o -lstdc++ -L. -lshlib

test1: test1.o test3.h
    $(CXX) $(CXXFLAGS) -o $@ test1.o -lstdc++ -L. -lshlib

test1.o: test1.cpp test3.h
    $(CXX) $(CXXFLAGS) -c -o $@ test1.cpp 
```

# python - 无法在 GAE 的烧瓶应用程序中包含交互式 python shell

> ID：11623652
> 
> 赞同：0
> 
> 时间：2012-07-24T03:18:51.493
> 
> 标签：python, google-app-engine, flask

我正在使用烧瓶和 python 2.7 GAE SDK。我正在尝试在我的应用程序中包含一个交互式外壳。

我正在尝试在我的应用程序中包含以下交互式 python shell，以便我可以在开发时与 GAE API 交互 - [http://code.google.com/p/google-app-engine-samples/source/browse/后备箱/外壳/](http://code.google.com/p/google-app-engine-samples/source/browse/trunk/shell/)

按照指示，我已将 static/ 和 templates/ 文件夹以及 shell.py 复制到我的应用程序的根目录。

我还仅将 url 路由添加到我的 app.yaml (shell)-

```
application: myflaskonappengineapp
version: 1
runtime: python27
api_version: 1
threadsafe: false

default_expiration: "5d"

builtins:
- appstats: on
- admin_redirect: on
- deferred: on
- remote_api: on

libraries:
- name: jinja2
  version: "2.6"
- name: markupsafe
  version: "0.15"
- name: lxml
  version: "2.3"
- name: numpy
  version: "1.6.1"
- name: PIL
  version: "1.1.7"
- name: pycrypto
  version: "2.3"
- name: setuptools
  version: "0.6c11"
- name: webapp2
  version: "2.3"
- name: webob
  version: "1.1.1"
- name: yaml
  version: "3.10"

inbound_services:
- warmup

handlers:
- url: /favicon.ico
  static_files: application/static/img/favicon.ico
  upload: application/static/img/favicon.ico

- url: /robots.txt
  static_files: application/static/robots.txt
  upload: application/static/robots.txt

- url: /_gae_mini_profiler/static
  static_dir: packages/flaskext/gae_mini_profiler/static

- url: /static
  static_dir: application/static

#interactive shell
- url: /shell
  script: shell.py

- url: /remote_api
  script: /opt/google_appengine/google/appengine/ext/remote_api/handler.py

- url: .*
  script: application.app 
```

但是，当我尝试访问 url /shell 时，出现 404 错误？我还需要为路由配置烧瓶吗？为什么烧瓶处理这个 url 而不是 shell.py？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T05:11:48.687

您需要修改 shell.py 以处理 URL '/shell' 以及 app.yaml。特别是，您需要编辑[shell.py 的第 303 行](http://code.google.com/p/google-app-engine-samples/source/browse/trunk/shell/shell.py#303)。

从

```
 [('/', FrontPageHandler), 
```

至

```
 [('/shell', FrontPageHandler), 
```

您还需要更新您的 app.yaml （添加通配符）：

```
- url: /shell.*
  script: shell.py 
```

请考虑将 login:admin 添加到 shell 处理程序，否则您将向世界上的每个人开放 shell 功能。

# oracle - PLSQL中IN、OUT、IN OUT参数的区别

> ID：11623653
> 
> 赞同：6
> 
> 时间：2012-07-24T03:18:53.243
> 
> 标签：oracle, plsql

请告诉我 PL/SQL 中的 IN、OUT、IN OUT 参数有什么区别。以及如何使用 PL/SQL 过程返回多个值。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T03:28:07.020

### 什么是 IN/OUT/INOUT 参数？

这些是您定义为函数参数列表的一部分的参数，它们作为结果的一部分返回。创建函数时，未显式指定的参数默认为 IN 参数（这意味着它们被传入而不返回），这就是为什么您有时会在使用函数向导时看到 PgAdmin 执行类似于 IN somevariable variabletype 之类的操作。

你也可以有 INOUT 参数，它们是函数输入，既可以传入，也可以由函数修改，也可以返回。

### SQL OUTPUT 参数 - 返回多条记录

```
--SQL returning multiple records
CREATE OR REPLACE FUNCTION fn_sqltestmulti(param_subject varchar, 
  OUT test_id integer, OUT test_stuff text) RETURNS SETOF record
AS $$
  SELECT test_id, test_stuff 
    FROM testtable where test_stuff LIKE $1;
$$
LANGUAGE 'sql' VOLATILE;

--example
SELECT * FROM fn_sqltestmulti('%stuff%');

 --OUTPUT--
 test_id |     test_stuff
---------+--------------------
       1 | this is more stuff
       2 | this is new stuff 
```

### [更多示例](http://www.postgresonline.com/journal/archives/129-Use-of-OUT-and-INOUT-Parameters.html)

# ruby - 过滤器/最大最小/每第 n 个帖子？

> ID：11623658
> 
> 赞同：1
> 
> 时间：2012-07-24T03:19:46.663
> 
> 标签：ruby, blogs, jekyll, liquid

假设我有一个`div`包含 3 列的容器，我希望 Jekyll 填充所有帖子。我看到了`limit`Liquid 语法，但不知道如何在每 3 个博客之后附加下面的 div 容器。这可能吗？

假设我有 9 个帖子；我应该看到 3 列有 3 行的`column-container`.

```
{% for post in site.posts %}

<div class="column-container">

   <!-- col 1 -->
   <div class="column">
      <p>1 {{ post.title }}</p>   
   </div>

   <!-- col 2 -->
   <div class="column">
      <p>2 {{ post.title }}</p>   
   </div>

   <!-- col 3 -->
   <div class="column">
      <p>3 {{ post.title }}</p>   
   </div>

</div>

{% endfor %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T07:09:04.133

如何使用[循环过滤器](http://wiki.shopify.com/UsingLiquid#Cycle)并做这样的事情..

```
{% for post in site.posts %}

<div class="column-container">

  <div class="column {%cycle 'col1', 'col2', 'col3'%}">
    <p>1 {{ post.title }}</p>   
  </div>

</div>

{% endfor %} 
```

然后使用 CSS 来设置它们的样式。

```
.column { float: left }
.col1 { clear: left } 
```

[请参阅 jsfiddle 上的 html](http://jsfiddle.net/Tmvr9/2/)

# session - 会话变量不起作用

> ID：11623659
> 
> 赞同：1
> 
> 时间：2012-07-24T03:19:50.733
> 
> 标签：session, session-variables

我的申请有问题。我在按钮单击事件上创建两个会话变量，然后重定向到另一个页面并执行从数据库中选择数据的方法（使用两个会话变量作为参数），然后在网格中显示结果。

一切正常，直到我有两个（或更多）用户，他们访问应用程序、设置自己的会话值、执行数据检索方法，当然他们希望看到自己的数据。

最终发生的是，两个用户都看到了相同的数据，而不是他们自己的特定数据。本质上，用户 A 可以很好地看到他的数据，但用户 B 最终看到的是用户 A 的数据——而不是他自己的数据。

注意：这仅在他们尝试以 20 秒间隔访问其特定数据时发生

这是我的代码示例：

```
//The user control that sets the session variables and redirects               
Session.Clear();
Session.["ID"] = TxtPatientIDCode.Text.ToString());
Session["DOB"] = Convert.ToDateTime(TxtDateOfBirth.SelectedDate.Value.ToShortDateString());
Response.Redirect("mypage");

// the user control that gets the session variable values and executes //the data method                   
if (Session["ID"].ToString() != null)
{
    SelectData();
} 
```

*修正*

这是 SelectData() 方法上发生的情况：

```
private void SelectData()
{
    DataSet ds = Data.GetData(Session["ID"].ToString(),Session["DOB"].ToString());
    gv.DataSource = ds;
    gv.DataBind();
} 
```

此外，我确实将其记录到数据库表中，并且它插入得很好，因为它显示了访问数据的人员和时间，以及正在使用的会话值。

再次感谢技术人员的帮助

# c# - 读取文本文件，然后将行分解为列

> ID：11623669
> 
> 赞同：0
> 
> 时间：2012-07-24T03:21:25.503
> 
> 标签：c#, asp.net, .net

我有一个任务，我需要读取一个文本文件，然后将每一行分解为列，然后我需要将其插入数据库。

最好的方法是什么？任何帮助将不胜感激，如果您能提供代码会更好。

这是我到目前为止所拥有的

```
 string filename = Server.MapPath("~/Text_File_4.txt");

    StreamReader sr = new StreamReader(filename);

    string styl;
    string colr;
    string sdim;
    string size;
    string qty;
    string line;

    string sprice;
    string sretail;

    while ((line = sr.ReadLine()) != null)

    {
        styl = line.Substring(0, 6);
        colr = line.Substring(6, 2);
        sdim = line.Substring(8, 1);
        size = line.Substring(14, 3);
        qty = line.Substring(19, 5);

        sprice = line.Substring(27, 6);
        sretail = line.Substring(38, 4);

        con.Open();
        cmd = new SqlCommand("insert into ststyl00(ststyl, stcolr, stsdim, stszcd, stprq, strprq) values(@ststyl, @stcolr, @stsdim, @stszcd, @stprq, @strprq)", con);

        cmd.Parameters.Add("@ststyl", SqlDbType.VarChar, 15).Value = styl;
        cmd.Parameters.Add("@stcolr", SqlDbType.VarChar, 3).Value = colr;
        cmd.Parameters.Add("@stsdim", SqlDbType.VarChar, 8).Value = sdim;
        cmd.Parameters.Add("@stszcd", SqlDbType.VarChar, 3).Value = size;

        cmd.Parameters.Add("@stprq", SqlDbType.VarChar, 8).Value = sprice;
        cmd.Parameters.Add("@strprq", SqlDbType.VarChar, 8).Value = sretail;
        cmd.ExecuteNonQuery();
        con.Close();

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:28:35.873

**输入是 CSV**

如果您的输入文件是 CSV 文件，我强烈建议您使用 CSV Reader 类，网址为

[http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader](http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader)

**输入是固定宽度的**

如果您的输入是固定宽度的，只需读取所有行并将每一行解析为适当的结构以存储在数据库中（稍后会详细介绍）。

如果您只有少量文本要阅读（可能是几兆字节或更少），只需使用

```
File.ReadAllLines 
```

[http://msdn.microsoft.com/en-us/library/s2tte0y1](http://msdn.microsoft.com/en-us/library/s2tte0y1)

将文件的所有行读入*string[]*。

**写入数据库**

您现在可以读取文件。现在，您需要将其写入数据库。大概有一个与文件中的数据匹配的给定模式的数据库表。查看 ADO.Net 以了解如何写入数据库并根据需要提出具体问题。

[http://msdn.microsoft.com/en-us/library/h43ks021(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/h43ks021(v=vs.100).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:27:55.410

这听起来像你必须有带有分隔符的文本文件。将数据分隔成列的分隔符，例如

数据1，数据2，数据3，数据4

分隔符可以是逗号或任何其他未出现在常规数据中的字符。如果你有这种格式的文本文件，很容易解析它并将其推送到数据库。

方法可能是 - 您使用 StreamReader 打开文件。逐行读取文件，即一次读取一行。通过指定分隔符将行拆分为列。

```
string[] lineData = sr.ReadLine().split('delimiter');
foreach(string colData in lineData)
{
     //store data into appropriate collections and push it to database
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:22:00.590

除了已经建议的其他解析技术之外，您还可以将[TextFieldParser](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx)类（它位于 Microsoft.VisualBasic.FileIO 命名空间中）与您已经编写的 ADO.Net 代码结合使用

# android - 为什么导入 CSV 需要这么长时间，如何加快速度？

> ID：11623671
> 
> 赞同：0
> 
> 时间：2012-07-24T03:21:44.007
> 
> 标签：android, csv

我有一个相当大的 CSV 文件（~.5Mb，16000 行，6 列），我目前正在将其作为 Android 应用程序的一部分导入到数组中。我将 CSV 存储在资产文件夹中，并在每次使用时重新导入。导入现在需要 7 或 8 秒（每行约 0.47 毫秒）。

这是我用来读取 CSV 的代码：

```
 @Override
         protected ArrayList<Car> doInBackground(Void... voids) {
            ArrayList<Car> toReturn = new ArrayList<Car>(); 

            try {

                BufferedReader CSVFile = new BufferedReader(new InputStreamReader(CarChooser.this.getAssets().open(CSV_NAME)));
                String dataRow = CSVFile.readLine();
                Car car;
                while (dataRow != null){
                    // split on the comma only if that comma has zero, or an even number of quotes in ahead of it
                    String[] dataArray = dataRow.split(",(?=([^\"]*\"[^\"]*\")*[^\"]*$)");
                    if(dataArray.length != 6) throw new IllegalStateException("Row length should be 6\. Row length = " + dataArray.length);

                    int year = Integer.parseInt(dataArray[0]);
                    String make = Utils.removeQuotes(dataArray[1]);
                    String model = Utils.removeQuotes(dataArray[2]);
                    float mpgCty = Float.parseFloat(dataArray[3]);
                    float mpgHwy = Float.parseFloat(dataArray[4]);
                    float mpgCmb = Float.parseFloat(dataArray[5]);

                    car = new Car(year, make, model, mpgCty, mpgHwy, mpgCmb);

                    toReturn.add(car);

                    dataRow = CSVFile.readLine(); 
                }
                CSVFile.close();
            } catch (IllegalStateException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            return toReturn;
         } 
```

以下是我的问题：

1.  它所花费的时间是我应该期待的吗？

2.  如果不是，为什么要花这么长时间？

3.  加快整个过程的最佳方法是什么？

我没有使用 SQL 数据库的经验，但这听起来像是我应该研究的东西。

# php - PHP 文件 exec() 另一个 PHP 文件并使用返回的数据

> ID：11623672
> 
> 赞同：0
> 
> 时间：2012-07-24T03:21:45.987
> 
> 标签：php

文件 displaypage.php 如下所示：

```
<?php

exec("php filetoexecute.php 2>&1",$output);
print_r($output);

?> 
```

文件 filetoexecute.php 如下所示：

```
<?php

echo "test data";

?> 
```

我的 $output 数组中唯一的东西是`PHP_FCGI_CHILDREN is not valid`，我在网上没有得到太多帮助。我知道它为什么在那里，我将 STDERR 重定向到 STDOUT，但为什么文本`test data`没有写入数组？

我知道它会起作用，只要我不想检索输出。如果 displaypage.php 中的行如下所示，filetoexecute.php 中的代码将正确执行（假设我让它向数据库写入一些内容）：

```
exec("php filetoexecute.php >/dev/null"); 
```

这当然是因为输出被转储为空。

我这样做是因为我需要 filetoexecute.php 在与调用它的文件不同的 php 会话 cookie 下运行。我不能只为 filetoexecute.php 处理的几行代码切换会话。我需要知道 filetoexecute.php 的结果是什么，这就是我需要它产生的数据的原因。

此外，`passthru()`似乎根本没有帮助我。

最后，我不同意使用 exec() 或 passthru() 的想法，将不胜感激有关可以完成我想要的事情的提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T18:39:16.610

经过大量实验，我发现了一些可行的方法。我还不明白它，因为我不熟悉 CLI，并且真的没有太多用处，但这里是有效的：

显示页面.php

```
<?php

$returnedData = exec("php filetoexecute.php &");

echo $returnedData;

?> 
```

无论出于何种原因，最后的 & 号是导致 exec() 返回被调用页面输出的任何内容的原因。我不知道这是否是实现这一目标的最佳方式，但它现在对我有用。如果您对做得更好有任何建议，我很想知道。

# jqgrid - 如何让 jqGrid 有两个不同的寻呼机？

> ID：11623675
> 
> 赞同：0
> 
> 时间：2012-07-24T03:22:10.937
> 
> 标签：jqgrid

我可以在 jqGrid 中获得两个寻呼机，一个在顶部，一个在底部。但我想让顶部寻呼机在左侧显示recordText，底部寻呼机在左侧显示导航器按钮。我想要这个的原因是我的网格太宽了，我不想使用滚动条来获取 recordText 或导航器按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T11:27:53.023

在这里，这将对您有所帮助...您可以有两个寻呼机，一个在顶部，一个在底部，根据您的要求，您可以从寻呼机中隐藏一些东西。

[无法在 jqGrid 上方定位寻呼机（导航栏）](https://stackoverflow.com/questions/4402455/unable-to-position-pager-navigation-bar-above-jqgrid)

# html - 如何实现这个css显示？

> ID：11623678
> 
> 赞同：2
> 
> 时间：2012-07-24T03:22:26.497
> 
> 标签：html, css

![在此处输入图像描述](../Images/f6ff34abd4e97e100a2af8a0a713ea51.png)

我在网上搜索时发现了这张图片，我尝试自己实现这个显示。这是我到目前为止所拥有的：

![在此处输入图像描述](../Images/f885745cd285f870d57ca2983ee8b508.png)

我的 HTML 代码在这里：

```
<ul>
<li>
<span style="display:block;"><a href="">
<span><img src="../creation/images/samps/unnamed4.png" width="48" align="absmiddle"/></span>
<span class="price" >Freeep</span>
<span class="appname">Name of the apps that is so long</span>
<span class="developer">by scamexdotexe</span>
</a>
</span>
</li>
</ul> 
```

这是我的 CSS 样式：

```
<style type="text/css">
li{
list-style: none;
width:200px;
border:1px solid #00CCFF;
border-radius: 10px;
-moz-border-radius: 10px;
-webkit-border-radius: 10px;
 padding: 0px;

}
li:hover{
border:1px solid red;
}
li a{
 margin: 0px; 
 display: block; 
 width: 100%; 
 height: 100%;
 white-space:nowrap;
 text-overflow:ellipsis;
 overflow:hidden;
 text-decoration:none;
 padding:2px; 
}
li a span img{
padding: 5px;
}

.price{
position:absolute;
margin-top:4px;
margin-bottom:4px;
color:#0099FF;
font-size:12px;

}
.appname{

}
.developer{
font-size:12px;
color:#666666;
margin:0;
position:inherit;
display:inline;
white-space:nowrap;

}

</style> 
```

我花了几个小时克隆第一张图片上的显示，但似乎我没有运气。你能指出我在这里做错了什么吗？我真正想做的是将应用名称和价格水平对齐，并将应用名称、评级、总下载量垂直对齐。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:29:39.550

对于初学者，我将边框半径更改为 5px，并添加阴影：

```
li {
  -moz-border-radius: 5px;
  -webkit-border-radius: 5px; 
  -moz-box-shadow: 0px 0px 5px #333;
  -webkit-box-shadow: 0px 0px 5px #333;
  box-shadow: 0px 0px 5px #333;
} 
```

你也想使用相同的颜色吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T03:41:58.193

这是你的开始：http: [//jsfiddle.net/k8ejp/4/](http://jsfiddle.net/k8ejp/4/)

笔记：

*   “头像”`div`当然可以是图像
*   如果您想要更复杂的布局（或发现使用位置更容易），可以使用绝对定位而不是浮动
*   我的示例使用了 CSS 的一些新功能（例如`text-overflow`），但它们应该在不改变布局的情况下降级。

## HTML

```
<div class="box">
    <div class="avatar">foo</div>
    <div class="price">Free!</div>
    <div class="name">A long app name A long app name A long app name A long app name</div>
    <div class="info">Other info about the app goes here.</div>
</div>​ 
```

## CSS

```
.box{ 
    font: 11px/1.5 sans-serif; 
    padding: 8px; 
    background-color: #ccddcc; 
    width: 400px; 
    border-radius: 4px; 
    border: 1px solid silver; 
    box-shadow: 2px 2px 2px #ddd; 
}

.avatar { 
    width: 32px; 
    height: 32px; 
    background-color: #555; 
    float: left; 
    margin-right: 12px; 
}

.price { 
    float: right; 
    color: green; 
}

.name { 
    width: 200px; 
    white-space: nowrap; 
    text-overflow: ellipsis; 
    overflow: hidden; 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T03:46:25.897

我不太确定你应该使用 span，我个人会使用 div 代替，因为它的默认显示样式已经是块，我看到这是你试图在描述块上实现的。

关于价格和应用名称，我建议您将它们包装在与评级和下载计数相同级别的 Div 容器中，并使该容器显示样式内联块，然后调整价格和应用名称的宽度。

会是这样

```
<div class="main-container">
    <div class="image"> Image Goes Here </div>
    <div class="description">
         <div class="description-top">
               <div class"description-top-title"> Title Goes Here</div>
               <div class"description-top-price"> Price Goes Here</div>
         </div>
         <div class="description-middle"> Rating Goes Here</div>
         <div class="description-bottom"> Download Count Goes Here</div>
    </div>
</div>

.main-container{
    display: inline-block;
}
.image{
    width: 30%;
}
.description{
    display: block;
    width: 70%;
}
.description-top{
    display: inline-block;
}
.description-top-title{
    width: 60%;
}
.description-top-price{
    width: 40%;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-24T04:50:49.727

我在这里创建了一个示例：http: [//jsfiddle.net/D26Hj/1/](http://jsfiddle.net/D26Hj/1/)。

~~它只需要一个应用程序徽标和星形精灵图像。~~

[我已经绘制了一个星形精灵图像并很快在Paint.NET](http://getpaint.net)中制作了一个假徽标。

**精灵的相关资料：**

*   每颗星星都很`9px`宽。
*   评分中有 5 颗星，因此每个评分都很`45px`宽。
*   因此，要更改评级，请`background-position`按以下方式更改。

以下是`background-position`用于不同星级的 s：

```
-0px     0 Stars
-45px    1 Star
-90px    2 Stars
-135px   3 Stars
-180px   4 Stars
-225px   5 Stars 
```

我添加了类以使其更容易，`rating-0`用于`rating-5`0 星到 5 星。

**HTML：**

```
<div class="app">
    <div class="image"></div>
    <div class="title">
        <a href="#">App title</a>
    </div>
    <div class="price">$0.00</div>
    <div class="rating rating-3">3 stars</div>
    <div class="info">1024 downloads</div>
</div> 
```

**CSS：**

```
body {
    padding: 20px;
}
.app {
    position: relative;
    width: 225px;
    height: 50px;
    padding: 5px;
    background: #8f8;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 13px;
    border: 1px solid #484;
    border-radius: 5px;
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    box-shadow: 0 0 2px #484;
    -moz-box-shadow: 0 0 3px #888;
    -webkit-box-shadow: 0 0 3px #888;
}
.app a {
    text-decoration: none
}
.app .image, .app .title, .app .price, .app .rating, .app .info {
    position: absolute;
}
.app .image {
    left: 5px;
    top: 5px;
    width: 48px;
    height: 48px;
    background-image: url('http://i.imgur.com/JAgto.png');
}
.app .title {
    left: 60px;
    top: 7px;
}
.app .price {
    right: 5px;
    top: 7px;
    color: #262;
}
.app .rating {
    left: 65px;
    top: 25px;
    width: 45px;
    height: 10px;
    text-indent: -999px;
    background-image: url('http://i.imgur.com/giWyQ.png');
    background-position: -135px 0;
}
.app .info {
    left: 60px;
    top: 40px;
    font-size: 11px;
    color: #666;
}
.rating-0 {
    background-position: 0 0;
}
.rating-1 {
    background-position: -45px 0;
}
.rating-2 {
    background-position: -90px 0;
}
.rating-3 {
    background-position: -135px 0;
}
.rating-4 {
    background-position: -180px 0;
}
.rating-5 {
    background-position: -225px 0;
} 
```

# c# - 发送电子邮件时图像不显示

> ID：11623680
> 
> 赞同：1
> 
> 时间：2012-07-24T03:22:40.053
> 
> 标签：c#, asp.net, c#-4.0, html-email

我正在使用以下部分代码向我们的客户发送电子邮件消息，例如新闻信件。它发送正确，但我在发送电子邮件时遇到了一个小问题。现在我用 HTML 代码发布一些图片。电子邮件中未显示图像。请帮我解决此问题..

这是我的部分代码：

```
 msg.To = wemail;
                            //msg.Bcc = "bcc email";
                            msg.BodyFormat = MailFormat.Html;
                            msg.Body = "<html xmlns='http://www.w3.org/1999/xhtml'><head><title>Untitled Document</title></head><body><table width='506' style='border-style:solid; border-radius:5px;' ><tr><td width='496'>  <img src='../images/logo1.jpg' alt='' width='508' /></td></tr><tr>  <td height='1px'><hr /></td></tr><tr style='border:0px; background:#6CF;'>  <td align='left' style='border-bottom:1px;'><p><b>Dear Team,</b></p>    <p><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  This mail is to inform you ....</b></p>    <p><u><b>Note : </b></u></p>    <p><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  ....&nbsp;</i>     </p>     <form action='http://xxx.in' method='post' target='_blank'>  <!--  <form id='form1' name='form1' method='post' action=''>-->      <b>      Please Click Here : </b>        <input type='submit' name='btn_submit' id='btn_submit' onclick='window.location.href='http://xxx.in'' value='Visit our 'Portal' ' />     </form><br /><br /></td></tr><tr style='border-top:#000'>  <td> <img src='../images/Untitled-2.gif' alt='' /></td></tr></table></body></html>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:24:08.490

您需要图像的绝对 URL。如果您有`"../images/logo1.jpg"`图像 URI，电子邮件客户端将不知道从哪里获取它。将图像上传到 Web 服务器并`"http://exam.ple/images/logo1.jpg"`用作 URL。如果这样做，大多数客户端仍然不会自动加载外部图像，因为它可以用于跟踪等。

您可以将电子邮件编码为多部分 mime，并将图像嵌入到电子邮件中。请参阅[如何在 html 电子邮件中嵌入图像](https://stackoverflow.com/questions/1851728/how-to-embed-images-in-html-email)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:24:31.463

您需要提供图片的绝对网址。否则不会显示。

像

```
<img src="http://yoursite.com/imGges/image.jpg" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T03:26:38.717

您需要提供图片的完整网址，而不仅仅是`<img src='../images/logo1.jpg' alt='' width='508' />`

而是提供 .jpg 文件的确切路径

如果您想嵌入您的邮件，那么您必须使用“cid”，例如`<img src="cid:whatever">`电子邮件客户端需要“src=cid:”部分才能将标签识别为嵌入图像，而“whatever”部分是实际的LinkedResource 图像的 Content-Id。

有关更多信息，您可以在这里查看：[http ://www.systemnetmail.com/faq/4.4.aspx](http://www.systemnetmail.com/faq/4.4.aspx)

# python - 如何在 Python 的打印语句中显示输入

> ID：11623681
> 
> 赞同：0
> 
> 时间：2012-07-24T03:22:48.167
> 
> 标签：python

```
def main():
    print "This program calculates the future value of a 10-year investment"

    principal = input("enter the initial principle: ")
    years = input("enter number of years you want to invest: ")
    apr = input("Enter the APR: ")

    for i in range(years):
        principal = principal * (1 + apr)

        print "The amount in" years "years is: " , years, principal

main() 
```

我在这里遇到错误。我如何获得最终的打印语句以显示输入值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:35:25.150

您可以使用`,`分隔字符串和值。（`,`自动添加空格）

```
print "The amount in", years, "years is:", principal 
```

但更好的方法是使用字符串格式：

```
print "The amount in {0} years is: {1}".format(years, principal) 
```

***或者：***

```
print "The amount in {years} years is: {principal}".format(years=years, principal=principal) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:25:38.753

```
print "The amount in" years "years is: " , years, principal 
```

我认为，应该是：

```
print "The amount in" + str(years) + "years is: " + str(principal) 
```

或者：

```
print "The amount in %(years) is : %(principal)" % { 'years': years, 'principal': principal } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-01T14:48:57.223

我认为您遇到的问题是“年”一词周围没有逗号。尝试这个。
def main(): print "这个程序计算 10 年投资的未来价值"

```
 principal = input("enter the initial principle: ")
    years = input("enter number of years you want to invest: ")
    apr = input("Enter the APR: ")

    for i in range(years):
        principal = principal * (1 + apr)

        print "The amount in",years,"years is:", principal 
```

希望这有效:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T03:23:35.833

您缺少逗号`years`。我认为这是您的问题，但您没有指定遇到的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T03:31:45.200

输出行应该写成如下：

```
print "The amount in " + str(years) + " years is: " + str(principal) 
```

# jquery - 只是另一个不会显示 JSON 数据的 jqGrid

> ID：11623682
> 
> 赞同：0
> 
> 时间：2012-07-24T03:22:51.917
> 
> 标签：jquery, json, jqgrid

我使用 jqGrid 来显示表格。如果数据是`local`，它可以正常工作，但如果它以 JSON 形式给出，则不会显示数据。

我搜索了很多，但没有一个可以解释我的问题。这里有什么建议吗？

Javascript：

```
 jQuery("#gpaTable").jqGrid({
    url: "data.html",
    datatype: "json",
    pager: "#gpaPager",
    height: "100%",
    colNames: [
        "star",
        "id",
        "name",
        "gpa",
        "tag",
        "failCnt",
        "lowScore",
        "noScore"],
    colModel: [{
        name: "star",
        index: "star",
        width: 20
    },
    {
        name: "id",
        index: "id",
        width: 80
    },
    {
        name: "name",
        index: "name",
        width: 80
    },
    {
        name: "gpa",
        index: "gpa",
        width: 40,
        sorttype: "float"
    },
    {
        name: "noScore",
        index: "noScore",
        width: 80,
        sorttype: "int"
    },
    {
        name: "lowScore",
        index: "lowScore",
        width: 80,
        sorttype: "int"
    },
    {
        name: "failCnt",
        index: "failCnt",
        width: 60,
        sorttype: "int"
    },
    {
        name: "tag",
        index: "tag",
        width: 300
    }],
    multiselect: true,
    caption: "GPA",
    viewrecords: true,
    jsonReader: {
        repeatitems: false,
        id: "lineId",
        cell: "cell",
        root: "rows",
        records: "records",
        total: "pageTotal",
        page: "pageId"
    }
}); 
```

数据.html：

```
{
"total": 1,
"page": 1,
"records": 1,
"pageId": 1,
"pageTotal": 1,
"rows": [{
    "lineId": 1,
    "cell": {
        "star": "",
        "id": "5090379054",
        "name": "BBB",
        "gpa": "2.6",
        "tag": "",
        "failCnt": 2,
        "lowScore": 0,
        "noScore": 2
    }
},
{
    "lineId": 2,
    "cell": {
        "star": "",
        "id": "5090379051",
        "name": "BBB",
        "gpa": "2.1",
        "tag": "",
        "failCnt": 2,
        "lowScore": 0,
        "noScore": 2
    }
},
{
    "lineId": 3,
    "cell": {
        "star": "",
        "id": "5090379052",
        "name": "CCC",
        "gpa": "3.5",
        "tag": "<ul class='tagClass'><li>Tag3</li><li>Tag4</li><li>Tag5</li><li>Tag6</li></ul>",
        "failCnt": 0,
        "lowScore": 70,
        "noScore": 0
    }
},
{
    "lineId": 4,
    "cell": {
        "star": "<span class='ui-icon ui-icon-star' value='starred' />",
        "id": "5090379032",
        "name": "DDD",
        "gpa": "1.5",
        "tag": "",
        "failCnt": 1,
        "lowScore": 90,
        "noScore": 5
    }
},
{
    "lineId": 5,
    "cell": {
        "star": "<span class='ui-icon ui-icon-star' value='starred' />",
        "id": "5090379032",
        "name": "EEE",
        "gpa": "1.2",
        "tag": "<ul class='tagClass'><li>Tag3</li></ul>",
        "failCnt": 4,
        "lowScore": 120,
        "noScore": 2
    }
}]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:36:55.257

我使用 $.map 方法做了类似的事情。这是我的 AJAX POST 的一个片段，它接收一个映射到“项目”的 JSON 对象，这是我的插件所期望的一个对象，它显示接收到的数据（在我的情况下不是网格，但在概念上是相同的交易）..

```
 $.ajax({
            type: "POST",
            url: '/Venues/GetVenuesJSON',
            dataType: "json",
            data: JSON.stringify(jsonToSend1),
            contentType: "application/json; charset=utf-8",
            success: function (data) {
                response($.map(data, function (item) {
                    return {
                        success: item.success,
                        label: item.label,
                        value: item.label,
                        id: item.value
                    }
                }));
            }, 
```

# android - Android XML 配置文件？

> ID：11623688
> 
> 赞同：2
> 
> 时间：2012-07-24T03:23:35.383
> 
> 标签：android, exchange-server

我在企业服务台工作，我们的许多用户都使用 Android 手机。另一方面，我们的一些用户也使用 iPhone，我们能够创建一个用户可以下载的配置文件来设置他们的交换帐户。是否有任何程序允许为 Android 完成此操作？我们正在寻求简化我们的交换帐户设置，并且我们希望为 Android 手机提供类似的配置文件。

或者如果没有配置实用程序，是否有人知道任何用于 Android 交换设置的企业解决方案？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-24T03:38:08.430

As far as I know, there is no such feature in the Android Email App. You need to manually set up your phones to talk to any exchange servers.

# python - 如何让 wxpython 框架始终显示在屏幕上？

> ID：11623691
> 
> 赞同：0
> 
> 时间：2012-07-24T03:23:42.663
> 
> 标签：python, wxpython

我制作了一个音乐播放器，一旦主框架被图标化，就会出现另一个框架，一旦该框架被图标化，就会出现一个较小的框架。有没有办法让最后一个小框架始终出现在屏幕上？现在，如果我在框架外单击它会消失，直到我在任务栏中单击它。我希望它始终在屏幕上，直到用户单击一个按钮以在最终的小框架之前打开框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:44:15.740

要使对话框保持在前台，直到用户与之交互，请使用以下`ShowModal()`方法：

> 有两种类型的对话框。模态和非模态。模态对话框在销毁之前不允许用户使用应用程序的其余部分。模态对话框是使用 ShowModal() 方法创建的。使用 Show() 调用时，对话框是无模式的。

[http://wiki.wxpython.org/AnotherTutorial/](http://wiki.wxpython.org/AnotherTutorial/)

如果你只是想让窗口留在前台，你可以使用`setFocus()`对话框上的方法，因为它是类的子`Window`类：

```
SetFocus(self) 
```

> 设置这个窗口的焦点，允许它接收键盘输入。

[http://wxpython.org/docs/api/wx.Window-class.html#SetFocus](http://wxpython.org/docs/api/wx.Window-class.html#SetFocus)

# android - 安卓蓝牙设置功能

> ID：11623696
> 
> 赞同：4
> 
> 时间：2012-07-24T03:24:17.110
> 
> 标签：android, bluetooth

我的 Android 设备正在尝试通过蓝牙连接到传感器。

作为一个普通的蓝牙设备，我需要务实的设置pin码（通常是0000或1234）

对于传感器端，因为它是无声的，不会弹出请求对话框。

我在 Android 开发网站上没有找到任何相关线索。

有谁可以告诉我是否有任何方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T20:53:09.247

要设置 PIN，您可以通过反射调用类中的隐藏`setPin(byte[])`方法`BluetoothDevice`。

例子：

```
try {
  Log.d("setPin()", "Try to set the PIN");
  Method m = device.getClass().getMethod("setPin", byte[].class);
  m.invoke(device, pin);
  Log.d("setPin()", "Success to add the PIN");
} catch (Exception e) {
  Log.e("setPin()", e.getMessage());
} 
```

`device`您的`BluetoothDevice`和包含蓝牙设备引脚`pin`的阵列在哪里。`byte[]`

但我认为，您会更喜欢使用方法`setPasskey(int)`。这对您来说会更容易，因为您想设置一个像“0000”或“1234”这样的密码。

[更新]

以前的源链接已失效，课程已更新。显然`setPasskey`已经不存在了。按照下面的文档链接查找您需要的信息。

资料来源：[BluetoothDevice Android 文档](https://developer.android.com/reference/android/bluetooth/BluetoothDevice.html)

# vb.net - SQL Server CE 转换/将双精度转换为字符串

> ID：11623703
> 
> 赞同：1
> 
> 时间：2012-07-24T03:25:02.990
> 
> 标签：vb.net, visual-studio-2010, sql-server-ce

对于大多数人来说，这似乎是一个愚蠢的问题，但它已经困扰了我很长一段时间。

我们如何在 SQL Server CE 中连接字符串和整数？

仅供参考，我正在使用 Vb.Net 和 Visual Studio 2010 查询生成器。

我试过

```
SELECT CONVERT(VARCHAR(10), mi.qty) FROM MutationItem mi 
```

和

```
SELECT CAST(qty AS VARCHAR(10)) AS Expr1 FROM MutationItem mi 
```

和

```
SELECT CAST(qty AS VARCHAR) AS Expr1 FROM MutationItem mi 
```

没有运气。

后者给了我一个错误：

> 函数参数列表中的错误：“AS”无法识别。无法解析查询文本。

请帮我解决这个问题。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:59:00.133

对不起，伙计们，这是我的错。

或者实际上是巫师的坏事。

因此，即使它给了我一个错误，我也尝试推动它，并且它最终起作用了。

我的猜测是表关系设计器无法复制 CAST 或 CONVERT，然后给我一个警告。

干杯！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T20:16:03.520

我跳过了这个问题 Visual Studio create a function with the code which throws questions

例如sybase上的这段代码sql

```
CREATE FUNCTION GetV(@cod NUMERIC(8)) 
RETURNS VARCHAR(20)
AS
BEGIN
  DECLARE @result VARCHAR(20)
  DECLARE @query VARCHAR(100)
  SET @query = (SELECT p.v1+' '+cast(p.v2 AS VARCHAR)+'X'+cast(p.v3 AS VARCHAR) FROM table1 p WHERE p.cod=@cod)
  IF(@query IS NULL OR @query = '' OR @query = ' ')
    SET @result = 0
  ELSE
    SET @result = @query
  RETURN @result
END
GO 
```

# delphi - 从 Delphi XE 调用的 Delphi 7 DLL

> ID：11623707
> 
> 赞同：3
> 
> 时间：2012-07-24T03:25:24.203
> 
> 标签：delphi, dll, interface, delphi-7, delphi-xe2

我需要在 Delphi 7 中包装一些遗留代码以在 Delphi XE2 中使用。我的问题似乎很简单，但我尝试了所有能找到的例子，但都失败了。基本上，我需要能够在 D7 和 DXE2 之间传递字符串，据我所知，最安全的方法是使用 pchar（因为我不想发送 borlandmm dll）。所以用D7编写的DLL，由Delphi XE2调用

我的界面需要

在我的 DLL 中：

```
function d7zipFile(pFatFile,pThinFile : PChar) : integer; stdCall;
function d7unzipfile(pThinFile,pFatFile : PChar) : integer; stdCall; 
```

我需要在 unzipfile 函数中传回 pFatFile 名称。

在我的调用代码中：

```
function d7zipFile(pFatFile,pThinFile : PChar) : integer; external 'd7b64zip.dll';

function d7unzipfile(pThinFile,pFatFile : PChar) : integer; external 'd7b64zip.dll'; 
```

有人可以协助实施这些的最佳方法吗？

显然，我不是在寻找实际的 zip/unzip code - 我在 D7 中可以正常工作。我想知道如何声明和使用字符串/ pchar 参数，因为我尝试的各种类型（PWideChar、WideString、ShortString 等）都会出错。

所以我很高兴能够简单地在 d7zipFile 函数中为两个文件名做一个 showMessage 。然后能够在 delphiXE2 中对 pFatFile 变量执行 showMessage，这意味着字符串双向都可以吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T08:41:48.547

到目前为止，最简单的方法是使用`WideString`. 这是 COM`BSTR`类型的 Delphi 包装器。字符串有效负载的动态分配是使用共享 COM 分配器完成的。由于 Delphi RTL 管理它，它对您是透明的。

在 Delphi 7 代码中，您可以像这样声明您的函数：

```
function d7zipFile(const FatFile, ThinFile: WideString): integer; stdcall;
function d7unzipfile(const ThinFile: WideString; var FatFile: WideString): 
    integer; stdcall; 
```

在您的调用代码中，您声明如下函数：

```
function d7zipFile(const FatFile, ThinFile: WideString): integer; stdcall; 
    external 'd7b64zip.dll';
function d7unzipfile(const ThinFile: WideString; var FatFile: WideString): 
    integer; stdcall; external 'd7b64zip.dll'; 
```

* * *

这种方法的替代方法是使用`PAnsiChar`or `PWideChar`。请注意，您不能使用`PChar`，因为该别名根据您使用的 Delphi 版本引用不同的类型。在 Delphi 7`PChar`中是 的别名`PAnsiChar`，在 XE2 中是 的别名`PWideChar`。

例如，使用的最大缺点`PAnsiChar`是调用者需要分配从 DLL 返回的字符串。但通常调用者不知道该字符串需要多大。该问题有多种解决方案，但最简洁的方法始终是使用共享分配器。您声明您不想依赖`borlandmm.dll`，因此下一个最明显的常见分配器是 COM 分配器。这就是为什么`WideString`有吸引力。

# sql - 使用 Oracle LISTAGG 函数消除重复

> ID：11623713
> 
> 赞同：3
> 
> 时间：2012-07-24T03:26:34.643
> 
> 标签：sql, oracle, plsql, analytics, oracle11gr2

> **可能重复：**
> [oracle 中的 LISTAGG 以返回不同的值](https://stackoverflow.com/questions/11510870/listagg-in-oracle-to-return-distinct-values)

我正在使用 Oracle LISTAGG 函数，但在我的返回名称列表中，我实际上想消除重复项，只返回不同的值。

我的查询是这样的：

```
select a.id,
       a.change_id,
       LISTAGG(b.name, ',') WITHIN GROUP (ORDER BY b.name) AS "Product Name", 
from   table_a a,
       table_b b
where  a.id = 1
and    b.change_id = c.change_id
group by a.id, a.change_id 
```

目前，它正在返回（仅显示一条记录）：

```
1    1   NameA, NameA, NameB, NameC, NameD, Name D 
```

我想要返回的是：

```
1    1   NameA, NameB, NameC, Name D 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T07:02:30.887

由于评论中的链接答案没有提供我的解决方案，我还是会发布它。

我只会使用`table_b`虚拟数据来展示这个概念，您可以轻松添加您的连接等：

```
with table_b as ( -- dummy data
 select 'name'||mod(level,3) name
        ,mod(level,3) id
   from dual
  connect by level < 10
 union all
 select 'name'||mod(level,2) name
        ,mod(level,3) id
   from dual
  connect by level < 10
)
select id
      ,RTRIM (
              XMLAGG (
                      XMLELEMENT (E,XMLATTRIBUTES (name|| ',' AS "Seg")
                      )
                     ORDER BY name ASC
              ).EXTRACT ('./E[not(@Seg = preceding-sibling::E/@Seg)]/@Seg'),
              ','
             ) AS "Product Name"
       ,LISTAGG(b.name, ',') WITHIN GROUP (ORDER BY b.name) AS "Product Name with dups"
  from table_b b
group by id; 
```

（想法取自[https://forums.oracle.com/forums/thread.jspa?messageID=9634767&tstart=0#9943367](https://forums.oracle.com/forums/thread.jspa?messageID=9634767&tstart=0#9943367)）

# c# - 将 FQL 结果转换为自定义类？

> ID：11623714
> 
> 赞同：0
> 
> 时间：2012-07-24T03:26:35.050
> 
> 标签：c#, linq, facebook-c#-sdk

我是一个相当新的 C# 程序员，并且一直在尝试将 FQL 结果转换为自定义类...例如，我正在执行以下操作，但似乎有很多步骤...我只是返回一个数据表，但希望结果是强类型的类集合。我会很感激任何见解。我也对实现类似结果的其他方法持开放态度。

谢谢，乍得

```
public class FacebookFriends
{
    public string FriendID { get; set; }
    public string FriendName { get; set; }
    public string PicURLSquare { get; set; }
    public string ProfileLink { get; set; }

    //Gets your FB friends that are NOT currently using this application so you can invite them
    public IEnumerable<FacebookFriends> GetFriendsNotUsingApp()
    {
        string strQuery = "SELECT uid, name, pic_square, link FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1=me()) AND NOT is_app_user";

        FacebookSDKInterface objFQL = new FacebookSDKInterface();
        dynamic objFNU = objFQL.FBFQL(strQuery);

        //Construct the new, formated, merged datatable to store the results the way we want them   
        DataTable dtFriendsNotUsingApp = new DataTable();    
        dtFriendsNotUsingApp.Columns.Add("FriendID");
        dtFriendsNotUsingApp.Columns.Add("FriendName");
        dtFriendsNotUsingApp.Columns.Add("PicURLSquare");
        dtFriendsNotUsingApp.Columns.Add("Link");

        if (objFQL != null)
        {
            foreach (dynamic row in objFNU.data)
            {
                //Add New DataRow to new DataTable
                DataRow drRow = dtFriendsNotUsingApp.NewRow();

                //Get various values from original JSON Friend List returned
                drRow["FriendID"] = row.uid;
                drRow["FriendName"] = row.name;
                drRow["PicURLSquare"] = row.pic_square;
                drRow["Link"] = row.link;

                //Add New Row to New Resulting Data Table
                dtFriendsNotUsingApp.Rows.Add(drRow);
            }

            dtFriendsNotUsingApp.DefaultView.Sort = "FriendName";
        }

        IEnumerable<FacebookFriends> objFriendsListCollection = null;

        var toLinq = from list in dtFriendsNotUsingApp.AsEnumerable()
                     select new FacebookFriends
                     {
                         FriendID = list["FriendID"].ToString(),
                         FriendName = list["FriendName"].ToString(),
                         PicURLSquare = list["PicURLSquare"].ToString(),
                         ProfileLink = list["ProfileLink"].ToString()
                     };

        objFriendsListCollection = toLinq.OrderByDescending(p => p.FriendName);

        return objFriendsListCollection;

    } //Get FB Friends not already using this app 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:46:23.473

我相信这可能会有所帮助。

**第一**：我从未使用过 Facebook API，所以我只是以您的代码为例。

**第二**：由于该方法在类中，我已将其更改为`static`. 这样，您可以通过简单地调用来使用它`FacebookFriends.GetFriendsNotUsingApp()`，而不是`new FacebookFriends().GetFriendsNotUsingApp()`.

**3号**代码：

```
 public class FacebookFriends
    {
        public string FriendID { get; set; }
        public string FriendName { get; set; }
        public string PicURLSquare { get; set; }
        public string ProfileLink { get; set; }

        //Gets your FB friends that are NOT currently using this application so you can invite them
        public static IEnumerable<FacebookFriends> GetFriendsNotUsingApp()
        {
            string strQuery = "SELECT uid, name, pic_square, link FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1=me()) AND NOT is_app_user";

            FacebookSDKInterface objFQL = new FacebookSDKInterface();
            dynamic objFNU = objFQL.FBFQL(strQuery);

            List<FacebookFriends> friendsToReturn = new List<FacebookFriends>();

            if (objFQL != null)
            {
                foreach (dynamic row in objFNU.data)
                {
                    friendsToReturn.Add(new FacebookFriends()
                        {
                            FriendID = row.uid,
                            FriendName = row.name,
                            PicURLSquare = row.pic_square,
                            ProfileLink = row.link
                        }
                    );
                }
            }

            return friendsToReturn;
        } //Get FB Friends not already using this app
    } 
```

希望这可以帮助。

问候

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T05:03:56.550

我也没有使用 Facebook API 或 FQL 的经验，但是通过查看您的代码`objFNU.data`似乎实现了`IEnumerable`，因此您可以直接使用 LINQ 扩展方法：

```
public class FacebookFriends
{
    public string FriendID { get; set; }
    public string FriendName { get; set; }
    public string PicURLSquare { get; set; }
    public string ProfileLink { get; set; }

    //Gets your FB friends that are NOT currently using this application so you can invite them
    public static IEnumerable<FacebookFriends> GetFriendsNotUsingApp()
    {
        string strQuery = "SELECT uid, name, pic_square, link FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1=me()) AND NOT is_app_user";

        FacebookSDKInterface objFQL = new FacebookSDKInterface();
        dynamic objFNU = objFQL.FBFQL(strQuery);

        if (objFQL != null) // shouldn't you check objFNU for being null here instead?
        {
            IEnumerable<dynamic> objFNUdata = (IEnumerable<dynamic>)objFNU.data; // explicit cast might not be necessary
            return objFNUdata.Select(row => new FacebookFriends()
                {
                    FriendID = row.uid,
                    FriendName = row.name,
                    PicURLSquare = row.pic_square,
                    ProfileLink = row.link
                }).OrderByDescending(p => p.FriendName);
        }
        else
        {
            return new List<FacebookFriends>();
        }
    } //Get FB Friends not already using this app
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T18:07:04.153

最后，这对我来说效果最好。感谢两者，尤其是 @DarmirArh 为使这项工作发挥作用所提供的所有帮助。

```
try
        {
            FacebookSDKInterface objFQL = new FacebookSDKInterface();
            dynamic objFNU = objFQL.FBFQL(strQuery);

            if (objFNU != null) // shouldn't you check objFNU for being null here instead?
            {
               IEnumerable<dynamic> objFNUdata = (IEnumerable<dynamic>)objFNU.data; // explicit cast might not be necessary
               IEnumerable<FacebookFriends> objMyFriends =
               from row in objFNUdata
               select new FacebookFriends()
               {
                   FriendID = row.uid,
                   FriendName = row.name,
                   PicURLSquare = row.pic_square,
                   ProfileLink = row.profile_url
               };

               objMyFriends = objMyFriends.OrderBy(p => p.FriendName);
               return objMyFriends;
            }
            else
            {
                return new List<FacebookFriends>();
            }
        }
        catch (Exception ex)
        {
            return new List<FacebookFriends>();
        } 
```

# emacs - 我可以在emacs中标记行的开始吗

> ID：11623721
> 
> 赞同：5
> 
> 时间：2012-07-24T03:27:04.333
> 
> 标签：emacs

我喜欢使用制表符而不是空格来格式化所有代码，但我只想在每行的开头将空格转换为制表符。

tabify 可以在行的开头将空格转换为制表符吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-07T01:28:21.383

的文档`tabify`提到了仅对行前空白进行操作的合适值。我用它来编写这个我觉得很方便的函数，但你可以在你的初始化文件中设置它并放弃一个单独的函数：

```
(defun tabify-leading (start end)
  "Call `tabify' with `tabify-regexp' set so that only leading
spaces are treated."
  (interactive "r")
  (setq tabify-regexp-old tabify-regexp)
  (unwind-protect
      (progn
        (setq tabify-regexp "^\t* [ \t]+")
        (tabify start end))
    (setq tabify-regexp tabify-regexp-old))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T03:33:07.177

看看[SmartTabs](http://www.emacswiki.org/SmartTabs)

它将添加到多种模式（适用于多种语言）并使其代码缩进仅是制表符，同时确保代码显示正确，无论查看器的制表符宽度如何。

摘抄：

> 1.  制表符仅用于行首。其他所有内容，如 ASCII 艺术和表格，都应使用空格进行格式化。
>     
> 2.  制表符仅用于表示缩进级别。每个“块”一个制表符——任何剩余的空白都是空格。

`tabify`除此之外，您可以使用该命令“tabify”现有代码。

# objective-c - 显示新窗口后如何关闭当前窗口

> ID：11623723
> 
> 赞同：0
> 
> 时间：2012-07-24T03:27:25.030
> 
> 标签：objective-c, macos, cocoa, nswindowcontroller

在当前的NSWindowController中，添加一个子窗口（mainViewController.window），然后关闭当前窗口，但是当调用方法[self.window close]时，应用程序终止（不会崩溃，因为我可以得到日志消息形式的方法windowWillClose） ;

```
[self.window addChildWindow:mainViewController.window ordered:NSWindowAbove];
[self.window close]; 
```

我想要的是：显示新窗口时关闭当前窗口。我的方法错了吗？

==================================== 更新============== =======================

谢谢@rdelmar，我的错误，应用程序没有终止，只是所有的窗口都关闭了。

```
[self.window orderFront:mainViewController.window];
[self.window close]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:13:34.187

如果您想在打开另一个窗口时关闭一个窗口，那么您不应该使第二个窗口成为第一个窗口的子窗口。当您关闭子窗口的父窗口时，子窗口也将关闭。您可以在代码中创建一个新窗口，然后使用 orderFront 或 makeKeyAndOrderFront: 将其显示在屏幕上，然后关闭其他窗口。您还可以在 IB 中添加另一个窗口，并取消选中 Visible At Launch，这样它只会在您调用我上面提到的方法之一时显示。

# c# - C# 强制转换泛型类型

> ID：11623726
> 
> 赞同：1
> 
> 时间：2012-07-24T03:27:46.983
> 
> 标签：c#, generics, dynamic, casting

我有一个有趣的问题，它让我超出了我的 C# 舒适区。通过使用 WsdlImporter 和 CodeDomProvider 类动态检查 Web 服务 WSDL，我可以生成 Web 服务的客户端代理代码并将其编译为程序集。这包括声明如下的服务客户端类：

```
public partial class SomeServiceClient : System.ServiceModel.ClientBase<ISomeService>, ISomeService {...} 
```

请注意，客户端类的名称和 ISomeService 契约的名称是动态的——我事先并不知道它们。我可以使用以下方法动态实例化此类的对象：

```
string serviceClientName = "SomeServiceClient";// I derive this through some processing of the WSDL
object client = webServiceAssembly.CreateInstance(serviceClientName , false, System.Reflection.BindingFlags.CreateInstance, null, new object[] { serviceEndpoint.Binding, serviceEndpoint.Address }, System.Globalization.CultureInfo.CurrentCulture, null); 
```

但是，如果我需要在此客户端类中设置 ClientCredentials，那么我无法弄清楚如何执行此操作。我认为我可以将客户端对象强制转换为 System.ServiceModel.ClientBase 泛型类，然后引用 ClientCredentials 属性。但是，以下编译但在运行时失败：

```
System.Net.NetworkCredential networkCredential = new System.Net.NetworkCredential(username, password, domain);
((System.ServiceModel.ClientBase<IServiceChannel>)client).ClientCredentials.Windows.ClientCredential = networkCredential; 
```

是否有某种方法可以动态指定演员表，或者是否有某种方法可以在没有此演员表的情况下设置凭据？谢谢你的帮助！马丁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T05:12:38.110

如果您分享了异常，我们可以为您提供更好的帮助，但这是我的猜测：

你的类层次结构是这样的：

```
public interface ISomeService : System.ServiceModel.IServiceChannel
{
    ...
}

public class SomeServiceClient : System.ServiceModel.ClientBase<ISomeService>
{
} 
```

并且您正在尝试转换`SomeServiceClient`为`System.ServiceModel.ClientBase<IServiceChannel>`. 遗憾的是你不能这样做，C# 4 有一个称为[**协变**](http://msdn.microsoft.com/en-us/library/ee207183.aspx)的特性，它允许向上转换泛型类型参数，但它只适用于接口，而不适用于具体类。

所以其他选项是使用反射：

```
ClientCredentials cc = (ClientCredentials)client.GetType().GetProperty("ClientCredentials").GetValue(client,null);
cc.Windows.ClientCredential = networkCredential; 
```

这应该没有问题（我没有测试过，所以如果它不起作用，请告诉我问题，以便我解决它）。

# java - 将 JPanel 添加到画布

> ID：11623729
> 
> 赞同：1
> 
> 时间：2012-07-24T03:28:29.067
> 
> 标签：java, swing, awt, jpanel

由于 JPanel 和 Canvas 都是同一级别的组件，因此解决方案可能是某种“黑客”。[这个](https://stackoverflow.com/questions/4759983/transparent-jpanel-over-canvas-vlcj)问题说您将无法将轻量级组件添加到重量级画布（我希望 JPanel 透明）。

如果这不可行，那么放置一个透明的组件会起作用吗？另外，将 Swing 组件添加到 Component 是否可行（它必须工作，即使它很糟糕）。我将如何将它实际放在画布上（因为它们都是同一级别的组件）？

注意：我永远不会在真正的应用程序中做这样的事情，我只是在这种情况下需要它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:05:49.033

一种可能性是将 JPanel 添加到 Canvas 所在的任何容器中，然后将 JPanel 的颜色设置为 0 的 alpha。这应该将其添加到旧的容器上，而不会阻挡 Canvas。这是你想要的吗？

编辑：考虑一下，JPanel 的默认颜色是透明的......您应该能够将 JPanel 添加到 Canvas 的父级，并将其放在上面

# android - Android：Google Play 中的过滤顺序

> ID：11623731
> 
> 赞同：2
> 
> 时间：2012-07-24T03:28:38.907
> 
> 标签：android, google-play

我的疑问是清单文件的元素在 Google Play 中进行过滤的顺序，我的意思是哪个元素在过滤过程中具有更高的优先级。

据我了解，元素 < compatible-screens > 和 < supports-screens > 具有过滤可以正确下载您的应用程序的设备的功能。

但是，如果我的清单中同时包含这两个元素但值冲突，那么过滤将如何发生？

例如，我的 Compatible-Screen 元素表示支持小屏幕元素，但我的清单中也有 Support-Screen 元素，它设置了 android:smallScreens="false"。

是否有任何网站可以让我在类似的行中阅读更多内容？我搜索过滤的所有内容都提到了每个属性的作用。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-03T03:46:14.090

据我了解，清单文件中的属性没有设置优先级，系统在查看支持屏幕和兼容屏幕元素的属性时会以不同的方式表现。并且开发人员应尽可能避免使用兼容的屏幕元素。不确定如果存在冲突值，系统将如何反应。

# c# - 将列表框项目放入网格

> ID：11623733
> 
> 赞同：0
> 
> 时间：2012-07-24T03:29:08.433
> 
> 标签：c#, wpf, gridview, listbox

我有一个列表框和一个网格（5 行，1 列），可能每个网格行都有一个画布。当我从列表框中拖动一个项目并拖动到网格中的一行时，该行将改变颜色。我该怎么做？如果我想同时更改这一行和下一行，可以吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T06:13:00.627

看看这些文章——

[http://www.codeproject.com/Articles/17266/Drag-and-Drop-Items-in-a-WPF-ListView](http://www.codeproject.com/Articles/17266/Drag-and-Drop-Items-in-a-WPF-ListView)

[http://www.codeproject.com/Articles/22855/ListBox-Drag-Drop-using-Attached-Properties](http://www.codeproject.com/Articles/22855/ListBox-Drag-Drop-using-Attached-Properties)

[http://blogs.msdn.com/b/jaimer/archive/2007/07/12/drag-drop-in-wpf-explained-end-to-end.aspx](http://blogs.msdn.com/b/jaimer/archive/2007/07/12/drag-drop-in-wpf-explained-end-to-end.aspx)

# php - 删除 index.php 并在 .htaccess (ExpressionEngine) 中添加 301 重定向

> ID：11623738
> 
> 赞同：1
> 
> 时间：2012-07-24T03:29:52.400
> 
> 标签：php, .htaccess, mod-rewrite, expressionengine

客户有一个表达式引擎站点并希望删除“index.php”。单独这样做会降低他的网站 SEO 排名，因为它会更改所有 URL。因此，我们希望通过向所有页面添加 301 来保留链接权益和社交网络共享计数。

我知道如何删除 index.php 并且知道如何重定向（我认为），但是当我同时使用它们时，服务器会引发重定向循环。我的逻辑是扭曲的。我在这里想念什么？

这是我正在使用的内容：

```
# Redirect attempt
Redirect 301 /index.php/feature/article/ http://domain.com/feature/article/

# EE index.php rewrite
RewriteCond $1 !^(index\.php|js|path\.php|press_releases|rear|robots\.txt|text\.html|themes) [NC]
RewriteRule ^(.*)$ /index.php/$1 [L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:44:53.277

*如果实际请求*是针对`/index.php/`URL的，您只想重定向。`Redirect`将您的指令更改为：

```
# Redirect attempt
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /index\.php
RewriteRule ^/?index.php/feature/article/(.*)$ http://domain.com/feature/article/$1 [R=301,L] 
```

此条件与服务器获得的实际请求匹配，而不是 URI（可以被第二条规则重写）。

# r - 我可以移动光标在 R 中进行修改吗？

> ID：11623742
> 
> 赞同：2
> 
> 时间：2012-07-24T03:30:32.847
> 
> 标签：r, cursor

我在 R 控制台中输入了一些内容：

```
> ta <- function(x,y){  
+ x=x+2  
+ y=y+1  
+ 
```

现在我的光标在第四行，我发现它是`x=x+1`，不是`x=x+2`。
我可以将光标移到第二行以修改`x=x+2`吗`x=x+1`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T03:41:15.250

As far as I'm aware, you can't do what you describe. What you can do is press `Esc` to cancel entering into the console and start afresh writing it in.

Are you using an IDE? Or are you writing directly into the RGui? If the latter, I heartily recommend using [RStudio](http://www.rstudio.org/). It will make your life a lot easier. You'll be able to to enter text into one window and then send it into the R console when you're ready.

Alternatively. R does have an editor (File > New script) which you can use to send lines, or you can even use a txt file off to the side and only send lines when you're ready.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T03:46:22.247

AFAIK，当 R 仍在等待您关闭函数调用时，无法编辑函数。所以首先，我认为您需要通过键入来完成编写函数`}`。完成后，您可以做几件事中的一件，所有这些都在[此处](https://stackoverflow.com/questions/2458013/what-ways-are-there-to-edit-a-function-in-r)进行了详细概述。我不会费心重复那些完美的答案，但建议你检查一下。最后，如果您目前没有使用 IDE 来帮助开发您的 R 代码，那将使您的生活更轻松。哪个 IDE 最适合您也是非常主观的，但之前已在 SO 中介绍[过](https://stackoverflow.com/questions/1439059/best-ide-texteditor-for-r)。FWIW，我对独立于平台的[RStudio](http://rstudio.org/)以及所有出色的爵士乐都很幸运……您的里程可能会有所不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T14:01:25.357

如果您从终端运行 R，您可以按`ctrl`+`c`取消您的输入并重新开始。

# regression - 多个输出（或任务）的随机森林回归

> ID：11623743
> 
> 赞同：1
> 
> 时间：2012-07-24T03:30:37.473
> 
> 标签：regression, random-forest

我有 d_x 输入特征和 d_y 输出的多输出回归问题。输出具有复杂的非线性相关结构。

我想使用随机森林进行回归。据我所知，用于回归的随机森林仅适用于单个输出，因此我必须训练 d_y 随机森林 - 每个输出一个。这忽略了它们的相关性。

是否存在考虑输出相关性的随机森林扩展？可能类似于[多任务学习的高斯过程回归](http://books.nips.cc/papers/files/nips20/NIPS2007_0431.pdf)。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T11:51:27.173

您可以参考“多元随机森林”。

# xcode - 视图加载后如何在xcode中编辑贝塞尔路径

> ID：11623744
> 
> 赞同：0
> 
> 时间：2012-07-24T03:30:46.373
> 
> 标签：xcode, path, draw, bezier

加载视图后，我需要能够在 xcode 中更新我的贝塞尔路径的三个点。我想通过 NSTimer 更新我的贝塞尔路径。我能够绘制初始贝塞尔路径，但我不知道在初始加载后如何更改它！我正在制作弹弓，这就是为什么我需要经常改变我的贝塞尔路径。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:28:14.700

`NSBezierPath`是一条不可变的路径。您需要使用更新的点创建一个新的，而不是更改现有的。

# javascript - 请求的建议 - 使用 json/jquery 和 ajax 在函数之间传递变量

> ID：11623746
> 
> 赞同：1
> 
> 时间：2012-07-24T03:30:54.620
> 
> 标签：javascript, jquery, ajax, json, frontend

我已经查看了很多关于 SO 的“类似”问答线程，但老实说，由于我对 js 编程没有太多了解，我发现很难理解很多答案（只要它们可能适用于我自己的情况）。

上下文是这样的，我有两个 php 脚本，一个在一段时间内返回 customer_ids 列表（json 编码），另一个返回他们对新闻提要的偏好（json 编码）。

我写了以下内容，在 google 上搜索了一下以基本了解如何在 jQuery 中设置 ajax 函数：

```
$('document').ready(function() {
    $.ajax({
        type:'GET', url: 'cust_selection.php', data: '',
        succes:function(cstmrid) {
            var clistlen = cstmrid.length;
            var i=0;
            var cstmr;
            for( ;cstmr=cstmrid[i++]; ) {
            $('#adminPanel>ul>li').append("<a href='' onclick='alert("+cstmr+")' class='lst_admin basic'>"+cstmr+"</a>"); //alert to be replaced with a function call which passes customerid to the function below.
            }
        },
        dataType:'json'
    });

    var cstmrid = "483972258"; //hardcoded for testing purposes
    $.ajax({
        type:'GET', url:'newsfpref.php?', data:'cref='+cstmrid,
        success:function(npfdata) {
            var item;
            var n=0;
            for( ;item=npfdata[n++]; ) {
                var news = npfdata[n].nsource;
                $('#adminMain>table>tbody').append("<tr><td>"+item+"</td></tr>");
            }
         },
         dataType:'json'
    });
}); 
```

现在从第一个 ajax 函数中，我得到一个链接列表，我希望能够单击以启动第二个 ajax 函数并将客户 ID 传递给它，以便它可以获取他们配置的新闻源列表他们的页面。警报和硬编码的客户 ID 都表明这些功能正在“工作”，但是当我尝试调整第一个功能时：...

```
$('#adminPanel>ul>li').append("<a href='' onclick='getCustomerNP("+cstmr+")' class='lst_admin basic'>"+cstmr+"</a>"); 
```

...正在调用第二个函数的修改版本，如下所示：...

```
function getCustomerNP(cstmrid) {
    $.ajax({
        type:'GET', url:'newsfpref.php?', data:'cref='+cstmrid,
        success:function(nprfdata) {
            var item;
            var n=0;
            for( ;item=npfdata[n++]; ) {
                var news = npfdata[n].nsource;
                $('#adminMain>table>tbody').append("<tr><td>"+item+"</td></tr>");
            }
         },
         dataType:'json'
    });
} 
```

在这一点上，一切似乎都失败了。第二个函数似乎没有“接收”变量，我不确定它是否是我忽略的基本内容（比如一些混乱的“和”位置），或者我想要完成的实际上不是jQuery ajax 函数相互交互的方式。

正如你所看到的，我已经从许多 SO q&a 线程中蚕食了一些代码和想法，但是在没有太多理解的情况下进行复制会导致令人沮丧的依赖生活。

我将不胜感激 - 广泛 - 您可以提供的评论，以及一两个解决方案（自然）。

编辑：不要让任何人进一步混淆，我一直在修改上述内容并纠正我的（许多）错误和拼写错误。目前，代码如下所示：

```
$('document').ready(function () {
    $.ajax({
        type: 'GET', url: 'cust_selection.php', data: '',
        succes: function (cstmrid) {
            var clistlen = cstmrid.length;
            var i = 0;
            var cstmr;
            for (; cstmr = cstmrid[i++]; ) {
                var a = $("<a href='' class='lst_admin basic'>" + cstmr + "</a>").click(function () {
                    getCustomerNP(cstmr)
                })
                $('#adminPanel>ul>li').append(a); //alert to be replaced with a function call which passes customerid to the function below.
            }
        },
        dataType: 'json'
    });
    function getCustomerNP(cstmr) {
        alert(cstmr);
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:46:07.013

您`$.ajax()`在`getCustomerNP()`. 函数声明：

```
success:function(nprfdata) { 
```

... 有一个参数`nprfdata`，但在您使用的函数中`npfdata`（缺少`r`）。

还有这段代码：

```
 var item;
        var n=0;
        for( ;item=npfdata[n++]; ) {
            var news = npfdata[n].nsource;
            $('#adminMain>table>tbody').append("<tr><td>"+item+"</td></tr>");
        } 
```

...声明并设置您从不使用的变量`news`。`n`在`for`测试表达式中增加但`n`在循环中使用似乎不正确。你从来没有设置`item`任何东西，但你在你的`.append()`.

（还要注意，JS 没有块作用域，只有函数作用域，所以在 if 或 for 循环内声明变量不会将它们限制为 if 或 for 块。）

我不会创建`onclick`这样的内联处理程序。我可能会做更多这样的事情：

```
$('#adminPanel>ul>li').append("<a href='' data-cstmr='"+cstmr+"' class='lst_admin basic'>"+cstmr+"</a>"); 
```

...然后在准备好的文档中设置一个委托事件处理程序来捕获对这些锚点的点击：

```
$('#adminPanel>ul>li').on('click', 'a.lst_admin', function() {
    $.ajax({
        type:'GET', url:'newsfpref.php?', data:'cref='+ $(this).attr('data-cstmr'),
        success:function(npfdata) {
            var item,
                n=0,
                // cache the jQuery object rather than reselecting on every iteration
                $table = $('#adminMain>table>tbody'); 
            // increment n only after the current iteration of the loop               
            for( ;item=npfdata[n]; n++) {
                // change to use item
                $table.append("<tr><td>"+item.nsource+"</td></tr>");
            }
         },
         dataType:'json'
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:46:39.930

当您附加您的喜欢时`<a href='' onclick='getCustomerNP("+cstmr+")'`，请确保您可以访问该功能`getCustomerNP`。尝试定义`getCustomerNP`为

```
window.getCustomerNP = function(cstmrid) {
    ... 
```

如果你在`$(document).ready(function(){ ... })`块中定义它，试试这个

```
 $('document').ready(function () {
        $.ajax({
            type: 'GET', url: 'cust_selection.php', data: '',
            succes: function (cstmrid) {
                var clistlen = cstmrid.length;
                var i = 0;
                var cstmr;
                for (; cstmr = cstmrid[i++]; ) {
                    var a = $("<a href='' class='lst_admin basic'>" + cstmr + "</a>").click(function () {
                        getCustomerNP(cstmr)
                    })
                    $('#adminPanel>ul>li').append(a); //alert to be replaced with a function call which passes customerid to the function below.
                }
            },
            dataType: 'json'
        });

        function getCustomerNP(cstmrid) {
            $.ajax({
                type: 'GET', url: 'newsfpref.php?', data: 'cref=' + cstmrid,
                success: function (nprfdata) {
                    var item;
                    var n = 0;
                    for (; item = npfdata[n++]; ) {
                        var news = npfdata[n].nsource;
                        $('#adminMain>table>tbody').append("<tr><td>" + item + "</td></tr>");
                    }
                },
                dataType: 'json'
            });
        }
    }); 
```

# javascript - 如何找到 Iframe 页面的渲染内容？

> ID：11623747
> 
> 赞同：2
> 
> 时间：2012-07-24T03:31:03.947
> 
> 标签：javascript, iframe

我有以下页面编码：

我的页面.html：

```
 <html><script>var a=document.createElement('p');
    a.innerHTML="hello world";
    document.body.appendChild(a);​​​​​​​​​​​&lt;/script>
    ​​​​​​​​​​​​​​​​​​​​​​&lt;body>
    <p>testing 1 2 3....</p></body>
   </html>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

当我使用具有以下代码的 find.html 提取信息时。

```
<script>
window.onload =finder();
function finder(){
var iframe=document.createElement('iframe');
iframe.width=1;
iframe.height=1;
iframe.src='mypage.html';
iframe.setAttribute('id', 'iframer');
document.body.appendChild(iframe);
    setTimeout(
        function() { 
var e = document.getElementById("iframer");
var frameHTML = e.contentDocument; var serializer = new XMLSerializer(); var content = serializer.serializeToString(frameHTML); alert(content);
        } , 30000);
}
</script> 
```

最终结果显示为警报弹出窗口：

```
 <html><script>var a=document.createElement('p');
    a.innerHTML="hello world";
    document.body.appendChild(a);​​​​​​​​​​​&lt;/script>
    ​​​​​​​​​​​​​​​​​​​​​​&lt;body>
    <p>testing 1 2 3....</p></body>
   </html>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

那不是我要找的。我正在寻找已在浏览器中呈现的以下内容，我需要获取所有呈现和生成的动态源代码仅用于检查，我如何编写代码以获取呈现的 HTML 源代码：

```
 <body>
   <p>hello world</p>
   <p>testing 1 2 3....</p>
   </body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:56:50.150

给 IFrame 一个`id`属性。

该`contentDocument`对象实际上因不同的浏览器而异。此外，出于安全原因，您只能获取同一域上的 IFrame 的内容。

```
var IFrame_DOM;
var iframe = document.getElementById('iframer'); // The ID of the IFrame
if (iframe.contentDocument)
{
  IFrame_DOM = iframe.contentDocument; // Get DOM in Chrome / Gecko
}
else if (iframe.contentWindow)
{
  IFrame_DOM = iframe.contentWindow.document; // Internet Explorer
}
if (IFrame_DOM)
{
  // Successfully got the DOM
  // Use the DOM in code here
}
else
{
  alert('Unsupported Browser. Couldn\'t read DOM.');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-29T11:26:28.957

为什么你不使用这样的 xml 序列化程序：

```
var serializer = new XMLSerializer();
var content = serializer.serializeToString('yourIframeObject;); 
```

content 变量包含 iframe 内容，包括 `<!DOCTYPE html>`, `<HTML>`和 `<head>`

# c - c printf size_t

> ID：11623749
> 
> 赞同：-3
> 
> 时间：2012-07-24T03:31:09.227
> 
> 标签：c, string, printf, size-t

我的代码编译，虽然`printf`不显示任何东西？

如果我取出格式化程序的一部分，`printf`那么它工作得很好。

```
#include <stdio.h>

size_t MyStrlen(const char *s1)
{
    const char *s1Copy = s1;

    while (*s1)
    {
        *s1Copy++;
    }

    return s1Copy -s1;
}

int main(void) 
{
    const char str[] = "HELLO";

    printf("Length: %d \n", (unsigned int)MyStrlen(str));

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T03:34:37.540

在您的循环测试中，您想要测试`*s1Copy`非 NULL，not `*s1`，您不会增加它。实际上，由于`*s1`永远不会更改，因此您将直接从字符串参数的末尾走出来，`s1Copy++`并且代码不会正常终止。

当然，除非您传递空字符串：您的`MyStrlen`方法**将**适用于空字符串。

```
while (*s1Copy)
    s1Copy++; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-24T03:48:28.663

这个：

```
printf("Length: %d \n", (unsigned int)MyStrlen(str)); 
```

没问题；`%d`需要一个`int`参数，但可以保证`int`并且`unsigned int`对于两者范围内的值具有相同的表示。这个：

```
printf("Length: %u\n", (unsigned int)MyStrlen(str)); 
```

更好，因为`%u`需要`unsigned int`争论。

的正确格式`size_t`是`"%zu"`：

```
printf("Length: %zu\n", MyStrlen(str)); 
```

但这是 C99 中的“新”功能，可能仍有一些实现不支持它。（特别是，Microsoft 支持 C99 的速度非常慢。）为了获得最大的可移植性（假设您的字符串长度不超过 2 ^(32) -1 字节），您可以使用以下命令：

```
printf("Length: %lu\n", (unsigned long)MyStrlen(str)); 
```

这回答了您提出的问题`printf`；pb2q 巧妙地诊断出您所看到的问题的实际原因（并击败了我！）。

# r - 如何在R中获取对象的容器类型？

> ID：11623753
> 
> 赞同：4
> 
> 时间：2012-07-24T03:31:27.020
> 
> 标签：r

假设我有一个名为 v 的对象，我如何找出它的容器类型（向量、列表、矩阵等），而无需尝试每个 is.vector(v)、is.list(v) .. . ?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T05:06:53.320

有三个对您有帮助的功能`mode`：`str`和`class`

首先，让我们做一些数据：

```
nlist <- list(a=c(1,2,3), b=c("a", "b", "c"), c=matrix(rnorm(10),5))
ndata.frame <- data.frame(a=c("a", "b", "c"), b=1:3)
ncharvec <- c("a", "b", "c")
nnumvec <- c(1, 2, 3)
nintvec <- 1:3 
```

所以让我们使用我上面提到的功能：

```
mode(nlist)
[1] "list"

str(nlist)
List of 3
 $ a: num [1:3] 1 2 3
 $ b: chr [1:3] "a" "b" "c"
 $ c: num [1:5, 1:2] -0.9469 -0.0602 -0.3601 0.9594 -0.4348 ...

class(nlist)
[1] "list" 
```

现在对于数据框：

```
mode(ndata.frame)
[1] "list" 
```

这可能会让您感到惊讶，但数据框只是一个带有 data.frame 类属性的列表。

```
str(ndata.frame)
'data.frame':   3 obs. of  2 variables:
 $ a: Factor w/ 3 levels "a","b","c": 1 2 3
 $ b: int  1 2 3
class(ndata.frame)
[1] "data.frame" 
```

请注意，向量有不同的模式：

```
mode(ncharlist)
[1] "character"
mode(nnumvec)
[1] "numeric"
mode(nintvec)
[1] "numeric" 
```

还可以看到，虽然`nnumvec`和`nintvec`看起来相同，但它们却完全不同：

```
str(nnumvec)
 num [1:3] 1 2 3
str(nintvec)
 int [1:3] 1 2 3

class(nnumvec)
[1] "numeric"
class(nintvec)
[1] "integer" 
```

根据您想要的这些中的哪一个来确定您使用的功能。`str`通常是查看变量的好函数，而其他两个在函数中更有用。

# php - Deezer API 和 file_put_contents

> ID：11623757
> 
> 赞同：0
> 
> 时间：2012-07-24T03:32:06.000
> 
> 标签：php, json, api, deezer

我有这个脚本，用于将专辑从 Deezer 保存到我的服务器。专辑地址没问题，你可以自己试试。它确实会生成一个文件，但它不是我想要看到的图像，而是一个损坏的文件。我猜这与他们在访问从 API 获得的原始链接时提供的（我猜）301 有关。但如果是这样，我不知道如何解决这个问题。

```
<?php
// Deezer
$query = 'https://api.deezer.com/2.0/search?q=madonna';
$file = file_get_contents($query);
$parsedFile = json_decode($file);
$albumart = $parsedFile->data[0]->artist->picture;
$artist =  $parsedFile->data[0]->artist->name;

$dir = dirname(__FILE__).'/albumarts/'.$artist.'.jpg';
file_put_contents($dir, $albumart);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:25:22.357

两个问题：

1)`$albumart`包含一个 URL（在您的情况下为[http://api.deezer.com/2.0/artist/290/image](http://api.deezer.com/2.0/artist/290/image)）。你需要`file_get_contents`在那个网址上做。

```
<?php 
// Deezer 
$query = 'https://api.deezer.com/2.0/search?q=madonna'; 
$file = file_get_contents($query); 
$parsedFile = json_decode($file); 
$albumart = $parsedFile->data[0]->artist->picture; 
$artist =  $parsedFile->data[0]->artist->name; 

$dir = dirname(__FILE__).'/albumarts/'.$artist.'.jpg'; 
file_put_contents($dir, file_get_contents($albumart));    // << Changed this line
?> 
```

2）重定向可能是一个问题（正如你所建议的那样）。要解决这个问题，请使用 curl 函数。

```
// Get file using curl.
// NOTE: you can add other options, read the manual
$ch = curl_init($albumart);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$data = curl_exec($ch);
curl_close($ch);

// Save output
file_put_contents($dir, $data); 
```

请注意，您应该将`curl()`其用于处理从外部 URL 获取内容的原则。更安全，你有更好的控制。一些主机还阻止使用`file_get_contents`无论如何访问外部 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T10:28:51.860

为什么不获取文件的标头（标头包含重定向）。

```
$headerdata=get_headers($albumart);
echo($headerdata[4]);//show the redirect (for testing)
$actualloc=str_replace("Location: ","",$headerdata[4]);//remove the 'location' header string

file_put_contents($dir, $actualloc); 
```

我认为这是标题中的第 4 条记录，如果不使用 print_r($hearderdata);

这将返回图像文件的正确 url。

# node.js - 会话未存储在 Connect、expressjs 中

> ID：11623759
> 
> 赞同：0
> 
> 时间：2012-07-24T03:32:24.717
> 
> 标签：node.js, session, cookies, connect, express

我有一个非常奇怪的问题，我一直在寻找解决方案。问题是一个 Expressjs 服务器配置了 Connect 会话，它在开发机器中运行良好，但是当我尝试使用 IP 从同一 LAN 中的其他浏览器访问时，它不存储 cookie。我可以在 Chrome 网络选项卡中看到它，服务器发送它，但在资源选项卡中它没有出现，显然没有任何效果。

我希望你能帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:33:47.343

我只是发布这个，因为我同时又感到困惑和快乐。首先，我只能在 Express 3.0 中使用会话和 cookie，而 Express 2.5 只能在我的开发机器中使用。我还不知道为什么，但现在我使用 3.0 版本，因为它对我有用。但是又出现了一个新的问题，cookie的sid和Express 2.5中的不一样，所以我查看了源码，发现了Connect的一个新功能，叫做parseSignedCookie，我必须使用，才能检索到会话存储中的会话。我希望这可以帮助遇到像我这样的问题的人。

# c - 避免“ISO C99 需要使用其他参数”

> ID：11623760
> 
> 赞同：4
> 
> 时间：2012-07-24T03:32:25.117
> 
> 标签：c, gcc, c99, gcc-warning, variadic-macros

使用 gcc 4.6.3（使用 -ansi -pedantic），我得到以下代码：

```
// Argument counting macro
#define NARGS(...) NARGS_(__VA_ARGS__, 5, 4, 3, 2, 1)
#define NARGS_(_1, _2, _3, _4, _5, _, ...) _

static inline void fi_init_(size_t nargs, fileinfo_t *finfo, ...) {
    // Default fmt/type values
    char* fmt  = "CD";
    int   type = 1000;

    if (nargs == 2) {
        va_list  ap;
        va_start(ap, hdr);
        fmt  = va_arg(ap, char*);
        type = va_arg(ap, int);
        va_end(ap);
    } 

    // Do some junk with it
}

#define fi_init(...) fi_init_(NARGS(__VA_ARGS__)-1, __VA_ARGS__) 
```

当被称为：

```
fileinfo_t out; fi_init(&out); 
```

我收到警告：

> 警告：ISO C99 要求使用剩余参数

当被称为：

```
fileinfo_t out; fi_init(&out, "CF", 2222); 
```

我不。我怎么能压制这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-24T04:27:13.333

我想我的问题在这里：

```
#define NARGS(...) NARGS_(__VA_ARGS__, 5, 4, 3, 2, 1)
#define NARGS_(_1, _2, _3, _4, _5, _, ...) _ 
```

将其更改为：

```
#define NARGS(...) NARGS_(__VA_ARGS__, 5, 4, 3, 2, 1, 0)
#define NARGS_(_1, _2, _3, _4, _5, _, ...) _ 
```

好像修好了

# objective-c - 如何在 Objective-C Xcode 中加密 .m 文件

> ID：11623766
> 
> 赞同：1
> 
> 时间：2012-07-24T03:33:13.870
> 
> 标签：objective-c, xcode, frameworks, encryption

我写了几个 .h 和 .m 文件，我想让其他人无法访问 .m 文件。他们可以使用我定义的这些方法，但是他们看不到这些方法是如何定义和修改的。某种“库”或“框架”，我不知道，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:30:17.280

这个问题已经在[这里](https://stackoverflow.com/questions/4065052/how-to-build-a-framework-or-library-for-other-developers-the-secure-way)问过。该问题的答案有很多相关链接，我建议您从那里开始。但是 btown 是对的，对您的程序进行逆向工程是可能的。

# iphone - 关于如何使用 NSThread

> ID：11623767
> 
> 赞同：0
> 
> 时间：2012-07-24T03:33:15.420
> 
> 标签：iphone, ios, xml-parsing, nsthread

我是一名 iPhone 开发人员。我研究了如何使用 NSThread。所以我创建了源代码。但是，我不确定我的源代码是好是坏。

```
 -(void)check_threadEnd 
    {
           if ([_thread isFinished]) {
            threadCount++; 

            if (threadCount == 4) {
                [self performSelector:@selector(removeActivityView) withObject:nil afterDelay:0.0];                 
                [self.tableView reloadData];               
            }         
        }
    } 
```

有时，threadCount 不会变为 4。因此，ActiveView 会连续工作而不会停止。一段时间后打开定时器，去掉ActiveView？我会给你一些建议。

```
-(IBAction)click_ServerSync:(id)sender
{
    if ([util checkNetwork]) {
        threadCount = 0 ;         
        [self displayActivityView]; 

        NSOperationQueue  *queue = [[[NSOperationQueue alloc] init] autorelease];
       [queue setMaxConcurrentOperationCount:4]; 
        _thread = [[NSThread alloc] initWithTarget:self selector:@selector(_th) object:nil];
        [_thread start];       
    } 
}

-(void)_th
{
  [self performSelectorOnMainThread:@selector(LoadXml:) withObject:@"XML1"   waitUntilDone:NO];
  [self performSelectorOnMainThread:@selector(LoadXml:) withObject:@"XML2"   waitUntilDone:NO];
  [self performSelectorOnMainThread:@selector(LoadXml:) withObject:@"XML3"   waitUntilDone:NO];
  [self performSelectorOnMainThread:@selector(LoadXml:) withObject:@"XML4"   waitUntilDone:NO]; 
}

-(void)LoadXml:(NSString*)P_VAL
{     
    NSString *smsURL = [NSString stringWithFormat:@"%@%@.asp", XML_URL, P_VAL];   

    NSString *sendAuthInfo = [NSString stringWithFormat:@"A=%@&B=%d&C=%@&D=%@"  , A, B, C, D ];   
    NSString *val = [sendAuthInfo stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc]initWithURL:[NSURL URLWithString:smsURL]]autorelease];

    [request setURL:[NSURL URLWithString:smsURL]];
    [request setHTTPMethod:@"POST"];
    [request setHTTPBody: [val dataUsingEncoding: NSUTF8StringEncoding]];    
    [self startAsyncLoad:request tag:P_VAL];   
}

- (void)startAsyncLoad:(NSMutableURLRequest*)request tag:(NSString*)tag {

    CustomURLConnection *connection = [[CustomURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES tag:tag];

    if (connection) { 
        [receivedData setObject:[[NSMutableData data] retain] forKey:connection.tag];
    }    
}

- (NSMutableData*)dataForConnection:(CustomURLConnection*)connection {
    NSMutableData *data = [receivedData objectForKey:connection.tag];
    return data;
}

-(void)check_threadEnd 
{
       if ([_thread isFinished]) {
        threadCount++; 

        if (threadCount == 4) {
            [self performSelector:@selector(removeActivityView) withObject:nil afterDelay:0.0];                 
            [self.tableView reloadData];               
        }         
    }
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {    
    NSMutableData *dataForConnection = [self dataForConnection:(CustomURLConnection*)connection];
    [dataForConnection setLength:0];
}
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {   
    NSMutableData *dataForConnection = [self dataForConnection:(CustomURLConnection*)connection];
    [dataForConnection appendData:data];
}
-(void)connectionDidFinishLoading:(NSURLConnection*)connection
{     
    NSLog(@" connection connectionDidFinishLoading : %d", [connection retainCount]);    
    NSMutableData *dataForConnection = [self dataForConnection:(CustomURLConnection*)connection];
    [connection release];

    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;    
    NSXMLParser *xmlParser = [[[NSXMLParser alloc] initWithData:dataForConnection] autorelease];  
    XMLParser *parser = [[XMLParser alloc] initXMLParser];      
    [xmlParser setDelegate:(id)parser];    
    parser.viewDelegate = (id)self; 
    [xmlParser parse];   // xml parser

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:57:01.803

你有理由选择 NSThread 而不是 NSOperation 吗？NSOperation 抽象了很多你在使用 NSThread 时不得不担心的低级问题。我强烈建议您阅读 Apple 的这个[并发编程指南](https://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091)。

请注意最后一部分，[从线程迁移](https://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/ThreadMigration/ThreadMigration.html#//apple_ref/doc/uid/TP40008091-CH105-SW1)，因为它讨论了可以帮助您编写健壮、干净的代码的其他替代方案。

# php - 在 symfony2 和 Doctrine 应用程序中出现“列不能为空”错误

> ID：11623768
> 
> 赞同：1
> 
> 时间：2012-07-24T03:34:03.307
> 
> 标签：php, symfony, doctrine-orm

我的构造函数中有班级国家和这个

```
public function __construct()
    {
        $this->createdAt = new \DateTime();
        $this->setUpdatedAt(new \DateTime());
        $this->isActive = true;
        $this->isDeleted = false;

        $this->setLastUpdatedBy(99);
        $this->setCreatedBy(99);

    } 
```

但是当我填写表格时，我得到了这个错误

> SQLSTATE [23000]：违反完整性约束：1048 列“createdAt”不能为空

我需要做些什么来使该字段成为默认日期时间吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:02:55.160

确保您使用的是 php 5.3+

# python - 检索已展平为二维的三角形上的点的实际 3D 坐标

> ID：11623769
> 
> 赞同：3
> 
> 时间：2012-07-24T03:34:16.070
> 
> 标签：python, graphics, 3d, coordinate-systems, cartesian

这是一个有点复杂的问题，所以我会尽力把它分解成块。

为了学习/乐趣，我正在编写一个 3D Python 库（而不是我打算让其他人使用的库）。在我开发的系统中，三维点一般会被展平到图像上，如下所示：

*   `width`通过将点移动到中心消失点的一半来增加 Z 索引。
*   在`Z = 0`处，X 和 Y 值直接对应于 X、Y 处的像素。

（这个方法可能有名字，但如果有，我不熟悉。）

在 Python 中：

```
# vx and vy are the vanishing point's coordinates
def flatten_point(width, vx, vy, x, y, z):
    distance = (x - vx, y - vy)
    flat_distance = [d / (1 + float(z) / width) for d in distance]
    return (vx + flat_distance[0], vx + flat_distance[1]) 
```

在这一点上，我能够通过展平它的顶点并使用[重心坐标](http://en.wikipedia.org/wiki/Barycentric_coordinate_system_%28mathematics%29#Converting_to_barycentric_coordinates)来查找和填充落在这三个点之间的像素来稍微有效地创建三角形。如果我不需要知道这些像素对应的三角形上的实际点，这已经足够好用了，但是如果我想对三角形进行着色以使更深的点绘制得更暗，我需要知道什么未*展平点*像素对应的三角形。

[math.stackexchange 上的 joriki](https://math.stackexchange.com/a/173727/36265)建议使用重心坐标作为权重来查找原点。这似乎确实有效了一段时间——如果我使用线性深度系统，它可能会有效——但是当三角形点的深度相差足够大时，它就会分崩离析。三角形似乎比实际更快地接近最大深度，就好像它向后弯曲一样。

所以，简而言之：如何反转点展平功能以获得展平三角形上任意 2D 像素的实际 3D 点？或者，如果有更好/更有效的方法来展平三角形而不丢失每个像素的深度，那也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T17:20:55.150

你是对的，问题在于你的深度值不是线性的。幸运的是，解决方案很简单，但如果按像素计算，则有点贵。

使用您的重心坐标，而不是直接插值三个 Z 分量，您需要插值它们的**逆**并重新**反转**结果。这称为透视校正。

仅 Z 示例：

```
def GetInterpolatedZ(triangle, u, v):
    z0 = 1.0 / triangle[0].z
    z1 = 1.0 / triangle[1].z
    z2 = 1.0 / triangle[2].z
    z = z0 + u * (z1-z0) + v * (z2-z0)
    return 1.0/z 
```

*具有`triangle`三个向量的列表 和 以及和`u`的`v`重心坐标。`triangle[1]``triangle[2]`*如果它们被偏移，您将需要在分区之前和之后重新映射您的 Z。

如果你想插入实际的 X 和 Y 坐标，你可以做类似的事情。您将需要对 x/z 和 y/z 进行插值，并通过乘以 z 来重新线性化结果。

```
def GetInterpolatedZ(tri, u, v):
    t0 = Vec3(tri[0].x/tri[0].z, tri[0].y/tri[0].z, 1.0/tri[0].z)
    t1 = Vec3(tri[1].x/tri[1].z, tri[1].y/tri[1].z, 1.0/tri[1].z)
    t2 = Vec3(tri[2].x/tri[2].z, tri[2].y/tri[2].z, 1.0/tri[2].z)

    inter = t0 + u * (t1-t0) + v * (t2-t0)
    inter.z = 1.0 / inter.z
    inter.x *= inter.z
    inter.y *= inter.z
    return inter 
```

*同样，`tri`是三个向量的列表，并且`u, v`是 的重心坐标`tri[1], tri[2]`。`Vec3`是一个规则的 3 分量欧几里得向量类型。*

# c# - GridView 没有在列表框选择上刷新

> ID：11623771
> 
> 赞同：0
> 
> 时间：2012-07-24T03:34:31.110
> 
> 标签：c#, asp.net, c#-4.0, dataset

我有一个 GridView，

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
            DataSourceID="SqlDataSource1">
            <Columns>
                <asp:BoundField DataField="LastName" HeaderText="LastName" 
                    SortExpression="LastName" />
                <asp:BoundField DataField="FirstName" HeaderText="FirstName" 
                    SortExpression="FirstName" />
                <asp:BoundField DataField="ProgramName" HeaderText="ProgramName" 
                    SortExpression="ProgramName" />
            </Columns>
 </asp:GridView> 
```

这是我用来刷新 GridView 的 ListBox 方法，

```
protected void ListBox1_SelectedIndexChanged(object sender, EventArgs e)
    {        
        if (ListBox1.SelectedValue == "Computer Programmer")
        {
          DataSet test =  GetStudentByProgramID(1);
          if (test.Tables.Count > 0)
          {
              GridView1.Columns.Clear();
              GridView1.DataSource = test;
              GridView1.Attributes.Add("style", "table-layout:fixed");
              //ISBNColumn
              BoundField LastName = new BoundField();
              //LastName.DataField = test.Tables.r.ColumnName;
              LastName.HeaderText = "ISBN";
              LastName.ItemStyle.HorizontalAlign = HorizontalAlign.Center;
              GridView1.Columns.Add(LastName);
              //CopyNumberColumn
              BoundField FirstName = new BoundField();
              //FirstName.DataField = myitems.Items.CopyNumberColumn.ColumnName;
              FirstName.HeaderText = "Copy Number";
              FirstName.ItemStyle.HorizontalAlign = HorizontalAlign.Center;
              GridView1.Columns.Add(FirstName);
              GridView1.DataBind();
          }

        }
    } 
```

但是当我从 ListBox 中选择值时，GridView 不会刷新。我在这里犯了什么错误？我的列表框也像这样被填满，

```
DataSet ab = GetProgramList();
        ListBox1.Items.Clear();

        if (ab.Tables[0].Rows.Count > 0)
        {
        ListBox1.DataSource = ab;
        ListBox1.DataTextField ="ProgramName";
        ListBox1.DataValueField ="ProgramName";
        ListBox1.DataBind();
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:43:22.843

确保您的列表框有

`AutoPostBack="True"`

```
<asp:ListBox id="ListBox1" 
               Rows="4"
               AutoPostBack="True" 
               SelectionMode="Single"  
               runat="server">

if(!IsPostBack)
{
        DataSet ab = GetProgramList();
        ListBox1.Items.Clear();

        if (ab.Tables[0].Rows.Count > 0)
        {
        ListBox1.DataSource = ab;
        ListBox1.DataTextField ="ProgramName";
        ListBox1.DataValueField ="ProgramName";
        ListBox1.DataBind();
        }
} 
```

# ruby-on-rails-3 - Ruby on Rails 中的多表关联表单

> ID：11623773
> 
> 赞同：0
> 
> 时间：2012-07-24T03:34:39.330
> 
> 标签：ruby-on-rails-3

目前我坚持使用我的 ruby​​ on rails 项目。我正在使用导轨 3.2

我设法为人类形式的技能创建复选框，但我不知道如何创建一个可以更改 human_skills 表中的“for_work”布尔值的表单输入。

所以我的目标是当用户创建一个新人或编辑一个人时，他们可以选择技能并确定这些技能是否适用于工作（布尔值）。

提前非常感谢！

```
Here is my Human form code

    = semantic_form_for @human do |f|
    = f.input :name 
    = f.input :skills , :as => :check_boxes, 
```

数据库设计

**技能**- id、姓名

**human_skills** - id、skills_id、human_id、for_work

**人类**- 身份，姓名

这是我的模型代码：

```
class Human < ActiveRecord::Base
  has_many :human_skills;
  has_many :skills, :through => :human_skills

class HumanSkill< ActiveRecord::Base
    belongs_to :human_skills;
    belongs_to :human;

class Skill < ActiveRecord::Base
  has_many :human_skills;
  has_many :human, :through => :human_skills 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T13:52:34.283

好的，所以你需要稍微调整你的模型以允许人类创造技能，然后使用 fields_for 让 form_for 助手知道它在另一个模型上。

```
class Human < ActiveRecord::Base
  has_many :human_skills;
  has_many :skills, :through => :human_skills

  accepts_nested_attributes_for :skills

class HumanSkill< ActiveRecord::Base
    belongs_to :human_skills;
    belongs_to :human;

class Skill < ActiveRecord::Base
  has_many :human_skills;
  has_many :human, :through => :human_skills 
```

和表格

```
 = semantic_form_for @human do |f|
    = f.input :name 
    = fields_for @human.skills do |h_skills|
      = h_skills.checkbox :skills 
```

查看资源以回答您的问题：Accepts Nested Attributes = [Accepts_nested_attributes_for](http://api.rubyonrails.org/classes/ActiveRecord/NestedAttributes/ClassMethods.html) Fields 文档：[Fields_for](http://apidock.com/rails/ActionView/Helpers/FormHelper/fields_for) Nested Form video [Railscast](http://railscasts.com/episodes/196-nested-model-form-part-1)

# java - 如何在触摸屏上实现 Java Swing 应用程序

> ID：11623777
> 
> 赞同：6
> 
> 时间：2012-07-24T03:35:14.463
> 
> 标签：java, swing, touchscreen, on-screen-keyboard

我们已经建立了一个销售点系统，现在我们需要将它实施到触摸屏上吗？我们是否需要依次更改任何代码才能使其正常工作。

我们正在使用键盘输入值 - 比如说数量 - 当我专注于 JTextField 时，是否有一种 java 方式可以弹出键盘（如 android）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T03:59:44.487

下面是一个关于如何实现弹出式键盘的简单示例：

![在此处输入图像描述](../Images/73cbf3e336cda023cb203c4f5ccf8fc8.png)

```
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.GridLayout;
import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;

@SuppressWarnings("serial")
public class MainFrame extends JFrame
{
    private JTextField txt;
    private PopUpKeyboard keyboard;

    public MainFrame()
    {
        super("pop-up keyboard");
        setDefaultCloseOperation(EXIT_ON_CLOSE);

        txt = new JTextField(20);
        keyboard = new PopUpKeyboard(txt);

        txt.addMouseListener(new MouseAdapter()
        {
            @Override
            public void mouseClicked(MouseEvent e)
            {
                Point p = txt.getLocationOnScreen();
                p.y += 30;
                keyboard.setLocation(p);
                keyboard.setVisible(true);
            }
        });
        setLayout(new FlowLayout());
        add(txt);

        pack();
        setLocationByPlatform(true);
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new MainFrame().setVisible(true);
            }
        });
    }

    private class PopUpKeyboard extends JDialog implements ActionListener
    {
        private JTextField txt;

        public PopUpKeyboard(JTextField txt)
        {
            this.txt = txt;
            setLayout(new GridLayout(3, 3));
            for(int i = 1; i <= 9; i++) createButton(Integer.toString(i));
            pack();
        }

        private void createButton(String label)
        {
            JButton btn = new JButton(label);
            btn.addActionListener(this);
            btn.setFocusPainted(false);
            btn.setPreferredSize(new Dimension(100, 100));
            Font font = btn.getFont();
            float size = font.getSize() + 15.0f;
            btn.setFont(font.deriveFont(size));
            add(btn);
        }

        @Override
        public void actionPerformed(ActionEvent e)
        {
            String actionCommand = e.getActionCommand();
            txt.setText(txt.getText() + actionCommand);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T03:45:04.507

如果您不需要多点触控，则与大多数触摸屏控制器一起使用的普通鼠标驱动程序只会让触摸屏模拟普通鼠标，其中将触摸屏幕的手指模拟为鼠标点击。

至于虚拟键盘，Windows 和 MacOSX 中内置了一些糟糕的键盘，但如果可以的话，最好在应用程序中内置一个。

如果您需要多点触控或对特定的触摸屏控制器有疑问，有几个选项。

至少在 Windows 上，您最好的摇摆选择似乎是这个项目： http: [//www.michaelmcguffin.com/code/JWinPointer/](http://www.michaelmcguffin.com/code/JWinPointer/)

JavaFX 似乎有触摸支持，英特尔有一个教程：[https ://software.intel.com/en-us/articles/using-javafx-to-implement-multi-touch-with-java-on-windows-8-桌面](https://software.intel.com/en-us/articles/using-javafx-to-implement-multi-touch-with-java-on-windows-8-desktop)。您可能能够以某种方式使用 Swing，因为有一些方法可以在 JavaFX 中托管 Swing 和在 Swing 中托管 JavaFX，您可能会寻找其他答案来完成两者之间的互操作。

有项目 MT4J，但它似乎已经不复存在。它似乎不适用于 Swing 或 JavaFX。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T03:47:39.407

您应该能够通过使用类似 a[`JWindow`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JWindow.html)和[`KeyboardFocusManager`](http://docs.oracle.com/javase/7/docs/api/java/awt/KeyboardFocusManager.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T05:44:40.820

我们为带有触摸支持的 Swing 应用程序实现了自定义外观，以使一切看起来更大（所有按钮、复选框……甚至`JTree`实例），以便使用手指轻松修改它们。

这样的解决方案可能会节省您将所有 UI 转换为触摸友好 UI 的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-25T12:57:20.343

你应该改变你的用户体验和交互设计，从而改变代码。查看 Windows UX 触控指南 - [https://msdn.microsoft.com/en-us/library/windows/desktop/dn742468.aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742468.aspx)

# search - 我如何找到秘密的 mercurial 修订？

> ID：11623778
> 
> 赞同：4
> 
> 时间：2012-07-24T03:35:17.207
> 
> 标签：search, mercurial, phase

我从事很多项目，有时我宁愿只删除我的本地存储库。但是，由于我偶尔使用秘密阶段（因为我需要检查我的存储库与服务器的不同之处），我在这方面受到了限制。

是否可以使用搜索来查找秘密阶段的变更集，或者我是否必须恢复到（缓慢）

```
hg log --debug | grep secret -B 2 -A 15 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-24T04:35:48.887

See `hg help revsets` for information on how to specify ranges of revisions. This should do the trick:

```
hg log -r "secret()" 
```

# google-apps-script - 来自 flextable 空白标签的值

> ID：11623780
> 
> 赞同：0
> 
> 时间：2012-07-24T03:35:25.803
> 
> 标签：google-apps-script, flextable

我是谷歌应用脚​​本的初学者。我想从另一个功能上的 flextable 标记中获取价值。我之前在 doGet() 函数上使用 setTag("init") 启动标签，但是当我调用 getTag() 时，什么都没有（空白）这是我的代码

```
var SPREADSHEET_ID = "xxx";

function doGet(){
  var app = UiApp.createApplication().setTitle('Request For Leaving');
  var panel = app.createVerticalPanel();
  var grid = app.createGrid(4, 4).setId('request');

  var employee = gsLibrary.getEmployee(SPREADSHEET_ID);

  var date1 = new Date();
  var preLabel = app.createLabel(': ').setText(': ');
  var preLabel2 = app.createLabel(': ').setText(': ');
  var preLabel3 = app.createLabel(': ').setText(': ');
  var preLabel4 = app.createLabel(': ').setText(': ');
  var preLabel5 = app.createLabel(': ').setText(': ');

  var employee = gsLibrary.getEmployee(SPREADSHEET_ID);
  var idLabel = app.createLabel('Employee ID ');
  var userIdLabel = app.createLabel(employee.employeeId).setId('userId').setTag(employee.employeeId);

  var yearLabel = app.createLabel('Year ');
  var yearDropdown = app.createListBox().setName("yearList").setId("yearList").setWidth('120px');

  var statusLabel = app.createLabel('Status ');
  var statusDropdown = app.createListBox().setName("statusList").setId("statusList").setWidth('120px');

  var searchButton = app.createButton("Search").setId("search");

  grid.setWidget(0, 0, idLabel)
    .setWidget(0, 1, preLabel5)
    .setWidget(0, 2, userIdLabel)
    .setWidget(1, 0, yearLabel)
    .setWidget(1, 1, preLabel4)
    .setWidget(1, 2, yearDropdown)
    .setWidget(1, 3, searchButton)
    .setWidget(2, 0, statusLabel)
    .setWidget(2, 1, preLabel3)
    .setWidget(2, 2, statusDropdown);

 var flexTable = app.createFlexTable()     
     .setId('myTable')
     .setTag('init')
     .setStyleAttribute('border','1px solid black')
     .setStyleAttribute("left","50px")
     .setStyleAttribute('borderCollapse','collapse')
     .setBorderWidth(1)
     .insertRow(0)
     .insertCell(0, 0).setStyleAttribute(0,0,"width","20px")
     .insertCell(0, 1).setStyleAttribute(0,1,"width","80px")
     .insertCell(0, 2).setStyleAttribute(0,2,"width","70px")
     .insertCell(0, 3).setStyleAttribute(0,3,"width","70px")
     .insertCell(0, 4).setStyleAttribute(0,4,"width","500px")
     .insertCell(0, 5).setStyleAttribute(0,5,"width","50px")
     .setText(0,0,'No. ')
     .setText(0, 1,'Leave Day(s)')
     .setText(0, 2,'Start Date')
     .setText(0, 3,'End Date')
     .setText(0, 4,'Description')
     .setText(0, 5,'Status')
     .setStyleAttribute('text-align','center').setCellPadding(10).setVisible(true);

  var searchHandler = app.createServerClickHandler('searchRequestList');   
  searchHandler.addCallbackElement(panel);   
  searchButton.addClickHandler(searchHandler);  
  setYearList(app,employee);
  setStatusList(app);

  panel.add(grid);
  panel.add(flexTable);
  app.setStyleAttribute("height","auto");
  app.add(panel);
  return app;
}

function setYearList(app,employee){
  var yearList = app.getElementById("yearList");
  var listYear=getAllYear(employee);
  var index=0;
  yearList.addItem("All Year");
  for (var i=0;i<listYear.length;i++){
    yearList.addItem(listYear[i]);
    index++;
  }

}

function getAllYear(user){
  var AllLeaveObjects = gsLibrary.getAllLeaveRequestByUser(SPREADSHEET_ID, user);
  var m_yearList=[];
  for (var i =0 ;i<AllLeaveObjects.length;i++){
   var status=true;
   var index;
   index=0;
    while (status==true && index<=m_yearList.length){
      if (gsLibrary.getYear(AllLeaveObjects[i].startDate)==m_yearList[index]){
        status =false;
     }
      index++;       
   }
    if (status==true){
      m_yearList.push(gsLibrary.getYear(AllLeaveObjects[i].startDate));

    }

  }

  m_yearList.sort();
  return m_yearList;
}

function setStatusList(app){
 var statusList = app.getElementById("statusList");
  var allStatus=getAllStatusName();
   statusList.addItem("All Status");
  for (var i=0;i<allStatus.length;i++){
    statusList.addItem(allStatus[i].status);
  }
}

function getAllStatusName(){
  var spreadsheetId = SPREADSHEET_ID;
  var sheet  = SpreadsheetApp.openById(spreadsheetId).getSheetByName("Status Request");
  var status = gsLibrary.getRowsData(sheet);  
  return status;
}

function getStatusNameByNum(num){
  var statusName;

  var allStatusName = getAllStatusName();
  for (var i =0 ;i<allStatusName.length;i++){
    if (num == allStatusName[i].statusCode){
      statusName = allStatusName[i].status;
    }
  }
  return statusName;
}

function searchRequestList(e){
    var app = UiApp.getActiveApplication();
    var employee = gsLibrary.getEmployee(SPREADSHEET_ID);
    var year=e.parameter.yearList;
    var status = e.parameter.statusList;

    fillTable(app,employee,year,status);
    return app;
}

function fill(table, LeaveRequest, index, row, tag){
  table.setText(index+1,0,index+1);
  table.setText(index+1,1,LeaveRequest[row].numberOfDays);
  table.setText(index+1,2,gsLibrary.convertDate(LeaveRequest[row].startDate));
  table.setText(index+1,3,gsLibrary.convertDate(LeaveRequest[row].endDate));
  table.setText(index+1,4,table.getTag()); //<--- this is the problem, always blank
  table.setText(index+1,5,getStatusNameByNum(LeaveRequest[row].status));
}

function setTagTable(){
  var app = UiApp.getActiveApplication();
  var table = app.getElementById("myTable");
  if(table.getTag() == 'init'){
    table.setTag() = '1';
  }
}

function fillTable(app,employee, year, status){
  setTagTable();
  var table =app.getElementById("myTable");
  var label = app.getElementById("showLabel");
  var LeaveRequest = gsLibrary.getAllLeaveRequestByUser(SPREADSHEET_ID, employee);
  var index = 0;

  if(year == "All Year" && status == "All Status"){
      for (var row = 0; row<LeaveRequest.length; row++){
        fill(table, LeaveRequest, index, row, ntag);
        index++;        
      }
  }
  else if(year == "All Year"){
      for (var row = 0; row<LeaveRequest.length; row++){
        if(getStatusNameByNum(LeaveRequest[row].status) == status){
          fill(table, LeaveRequest, index, row, ntag);
          index++;          
        }
      }
  }
  else if(status == "All Status"){
      for (var row = 0; row<LeaveRequest.length; row++){
        if(gsLibrary.getYear(LeaveRequest[row].startDate) == year){
          fill(table, LeaveRequest, index, row, ntag);
          index++;          
        }
      }
  }
  else {
      for (var row = 0; row<LeaveRequest.length; row++){
        if(gsLibrary.getYear(LeaveRequest[row].startDate) == year && getStatusNameByNum(LeaveRequest[row].status) == status){
          fill(table, LeaveRequest, index, row, ntag);
          index++;          
        }
      }
  }
} 
```

gsLibrary 是我之前创建的库，没有问题...谢谢 :D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T05:00:45.577

您可以按照下面给出的方式获取任何小部件的标签

```
function doGet(){
  ...
  var lbl = app.createLabel('Hello World').setId('lbl').setTag('tag'); 
  ...
}

function handleFunction(e){
  /* Some handler function invoked when a button is clicked etc. */
  var tag = e.parameter.lbl_tag; 
} 
```

# fluent-nhibernate - 当阅读器关闭时，NHibernate获取问题无效尝试调用读取

> ID：11623781
> 
> 赞同：2
> 
> 时间：2012-07-24T03:35:34.087
> 
> 标签：fluent-nhibernate

我遇到了一些关于 NHibernate 批量保存的问题。同时，我保存了 250 多个通过 NHibernate 映射链接的实体。

两个实体之间存在一对多关系。

```
ParentEntity 1 
   ----  ChildEntity 1
   ----  ChildEntity 2
   ----  ChildEntity 3
              --
              --
   ----  ChildEntity 249   
   ----  ChildEntity 250   

So when i call 
      repository.save(ParentEntity 1); 
```

它将在内部调用 250 个 childEntity 和 1 个 ParentEntity 的保存。我已经设置了 batchsize 来提高性能。但是一段时间后，我会收到异常，因为“阅读器关闭时调用读取的尝试无效”。

有关详细信息，我在分析器中检查了 sql 查询。直到 200 个 childEntities 我可以看到插入语句，但在调用重置连接之后。“exec sp_reset_connection”我不知道，我关闭阅读器的问题是因为这个重置连接。

谁能帮我解决这个问题？

谢谢，马赫什。

# linux - 文件系统上的 Jira 附件限制

> ID：11623785
> 
> 赞同：1
> 
> 时间：2012-07-24T03:36:47.087
> 
> 标签：linux, filesystems, jira

我们使用 Jira 作为我们的错误和任务跟踪器。由于Linux上的文件数量限制（单个文件夹只能包含有限数量的文件-我必须说我们没有空间不足），我们需要将旧问题的附件移动到另一个文件夹，以便在以下情况下可以附加新文件附件的数量达到了限制，但是在这种情况下，如果人们想要获取旧附件，作为 Jira 管理员，我们需要手动在服务器上获取该文件。

你有什么想法可以解决这个问题吗？

# android - 试图制作一个从网页下载内容的应用程序

> ID：11623787
> 
> 赞同：0
> 
> 时间：2012-07-24T03:36:58.737
> 
> 标签：android, web

我想编写一个应用程序，每当课程开放时通知我。一种天真的方法是下载 HTML 源代码并查找指示“开放”（对于开放课程）或“候补名单”（候补名单已开放）的特定字符串，然后通知我。我应该如何处理这个？我已经研究过 HTPClient ，但它比它需要的更困难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T04:40:30.773

使用简单的 HTML 解析器对我有用。

# javascript - Extjs如何在组件中创建getter/setter

> ID：11623789
> 
> 赞同：1
> 
> 时间：2012-07-24T03:37:02.483
> 
> 标签：javascript, extjs

我有一个代码，我在其中创建了一个组件。单击应用时，我想保存此表单字段对象并可供 getter 使用。这样父容器就可以读取它。

我还想要所有字段获取器/设置器，以便可以更新值运行时。如何做到这一点？

```
Ext.define('MyApp.view.MyForm', {
    extend: 'Ext.form.Panel',

    height: 463,
    width: 227,
    bodyPadding: 10,
    title: 'My Form',

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            items: [
                {
                    xtype: 'textfield',
                    fieldLabel: 'Component Name',
                    anchor: '100%'
                },
                {
                    xtype: 'textfield',
                    fieldLabel: 'Host',
                    anchor: '100%'
                },
                {
                    xtype: 'textfield',
                    fieldLabel: 'Port',
                    anchor: '100%'
                },
                {
                    xtype: 'textfield',
                    fieldLabel: 'Path',
                    anchor: '100%'
                },
                {
                    xtype: 'textareafield',
                    fieldLabel: 'Request Data',
                    anchor: '100%'
                },
                {
                    xtype: 'button',
                    text: 'Apply',
                    listeners: {
                        click: {
                            fn: me.onButtonClick,
                            scope: me
                        }
                    }
                }
            ]
        });

        me.callParent(arguments);
    },
        onButtonClick: function(button, e, options) {
                   var form = this.getForm(),
            values = form.getFieldValues(),
                    //make this available to public
            json = Ext.JSON.encode(values);
            console.log(json);

    }

}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T03:26:05.120

为了实现这一点，需要在 config 中定义所有变量：{} extjs 会自动创建 getter/setter。

然后您可以使用 this.getVar()、this.setVar() 来引用它

我希望这对初学者有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-11T19:30:21.333

有关详细信息，请参阅[http://docs.sencha.com/ext-js/4-0/#!/guide/class_system](http://docs.sencha.com/ext-js/4-0/#!/guide/class_system)上的配置部分

# javascript - 有没有办法在页面回发后从同一点继续执行 javascript 函数？

> ID：11623790
> 
> 赞同：0
> 
> 时间：2012-07-24T03:37:08.560
> 
> 标签：javascript, jquery, asp.net, automation, screen-scraping

我必须在一个旧系统上工作，那里有很长的数据列表，我必须标记为删除，并且由于这个应用程序真的很旧（我猜是.net 1.1）并且没有人有源，我必须这样做它通过使用javascript手动尝试自动化应用程序界面。

这是我想使用小书签自动化的过程：

1.  在网站页面上，搜索所有复选框元素并将它们设置为选中
2.  到页尾，点击提交按钮，等待回发
3.  单击列表底部分页部分的“下一页”链接
4.  等待新页面加载
5.  重复直到没有更多的“下一页按钮”。

html的结构很好，所以找到要点击的控件等真的不是问题，我不知道该怎么做就是在页面回发完成后继续执行javacript函数。

有谁知道如何做这样的事情？

到目前为止我得到的伪代码，除了 WaiForThePostbackToComplete 之外，我已经弄清楚了其余的部分：

```
while($('#nextPageLink').length) {
  var checkboxes = getCheckboxes();
  checkboxes.each(click());
  var submitbutton = getSubmitButton();
  document.location = submitbutton.attr('href');

  // im stuck here, after the postback the function stops
  WaiForThePostbackToComplete();

  var nextpage = getNextPageLink();
  document.location = nextpagelink.attr('href');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:04:56.293

你不能真正从一条线上重新开始。如果您不知道是哪一种，我不知道有任何一种编程语言可以让您从一行开始执行。

你需要在这里做的是保持你上次执行的状态。

最简单的选择是使用 javascript cookie 来保持这种状态。

```
document.cookie = 'timesRum=1; expires=Wed, 24 Jul 2013 02:47:11 UTC; path=/' 
```

您可以参考本教程，它将为您提供一些[使用 cookie 的辅助函数](http://www.quirksmode.org/js/cookies.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T06:55:34.630

你可以试试这个： -

```
<% if(IsPostBack)
{%>
var nextpage = getNextPageLink();
document.location = nextpagelink.attr('href');
<%}%> 
```

# mysql - 在两个表之间的连接中查找最旧的记录

> ID：11623793
> 
> 赞同：1
> 
> 时间：2012-07-24T03:37:27.310
> 
> 标签：mysql, sql, join

我有两张桌子。“问题”：问题列表，“结果”用户对这些问题的结果。

```
Table: Questions
   ID

Table: Results
   ID 
   Created - When this record was added. 
   Q_ID - A FK to the Question table 
```

示例数据

```
Table: Questions
   ID 
   ----
    1
    8
   15
   55

Table: Results
   ID | Created | Q_ID 
   --------------------
    1 |   12:02 |    1 
    2 |   12:03 |   15 
    3 |   12:04 |    8 
```

我正在寻找一个（或两个）可以得到以下信息的查询。

*   没有相关结果的问题。
*   如果所有问题都有结果，则找到结果最早的问题。

这个查询应该返回 question.id=55，因为它是唯一没有结果的问题。如果 question.id=55 不存在，那么它将返回 question.id=1，因为它具有问题的最旧结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:51:08.453

如果你`LEFT JOIN`有两个表，你可以使用该`ORDER BY`子句来做你需要的事情：

```
SELECT *
FROM
    questions
    LEFT JOIN results
        ON results.q_id = questions.id
ORDER BY
    ISNULL(results.id) DESC, results.created ASC
LIMIT 1 
```

这会将没有结果的所有问题放在列表顶部，然后是所有有结果的问题的列表（按“最早的问题优先”顺序）。它将让它只显示`LIMIT 1`最佳结果 - 这应该符合您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:55:28.063

1- 没有相关结果的问题

```
select q.qid from questions q where q.qid not in ( select r.qid from result r ) 
```

2-找到结果最早的问题

```
select min(r.createdon) from result r 
```

# sql-server - Data Conversion In ETL SSIS

> ID：11623799
> 
> 赞同：1
> 
> 时间：2012-07-24T03:38:23.120
> 
> 标签：sql-server, ssis, etl

I'm working in ETL process where I have a column in a table varchar with data as `28JUN1952`. This will always be in this format i.e. 2 digits for date, 3 letters for months and 4 numbers for years.

I was able to convert this into a date column by I need this to come in `yyyyMMdd` format i.e. `28JUN1952` become `19520628`. I was able split the years months and date, but unable to add a padding in the month if it's a 1 digit month for e.g. `Jan` or `Feb`.

Is there any other way to convert the data format or any other alternative to add a padding?

I need the conversion in SSIS only.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T07:01:40.083

最简单的方法是添加脚本转换。

1.  在输入和输出选项卡上，展开输出 0，选择输出列，单击添加列。2\. 将 Column 重命名为 ccyymmdd 并更改数据类型。我不确定你的目标类型是什么（int32，string？）但我会假设 string 因为我很懒
2.  在 Input Columns 选项卡上，选择字符串日期源列（假设它称为 srcDate）
3.  在脚本任务中，假设 C#，使用这样的代码

内部脚本任务

```
public override void Input0_ProcessInputRow(Input0Buffer Row)
{
    DateTime x = DateTime.MinDate;
    if (DateTime.TryParse(Row.srcDate, out x))
    {
        Row.ccyymmdd = x.ToString("yyyyMMdd");
    }
    else
    {
        // Handle NULL values however you wish
        // Assign "known bad value"
        // Row.ccyymmdd = "99991231";
        // Or set the null property to true (preferred)
        Row.ccyymmdd_IsNull = true;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T05:52:46.937

尝试这个：

```
declare @d varchar(20)='28JAN1952';

SELECT replace(CONVERT(date,RIGHT(@d,4)+SUBSTRING(@d,3,3)+LEFT(@d,2)),'-','') 
```

# python - Python: best way to test a single method of a class

> ID：11623800
> 
> 赞同：15
> 
> 时间：2012-07-24T03:38:29.387
> 
> 标签：python, testing, pytest

I have a class like the following:

```
class A:
    def __init__(self, arg1, arg2, arg3):
        self.a=arg1
        self.b=arg2
        self.c=arg3
        # ...
        self.x=do_something(arg1, arg2, arg3)
        self.y=do_something(arg1, arg2, arg3)

        self.m = self.func1(self.x)
        self.n = self.func2(self.y)
        # ...

    def func1(self, arg):
        # do something here

    def func2(self, arg):
        # do something here 
```

As you can see, initializing the class needs to feed in arg1, arg2, and arg3\. However, testing func1 and func2 does not directly require such inputs, but rather, it's simply an input/output logic.

In my test, I can of course instantiate and initialize a test object in the regular way, and then test func1 and func2 individually. But the initialization requires input of arg1 arg2, arg3, which is really not relevant to test func1 and func2\.

Therefore, I want to test func1 and func2 individually, without first calling `__init__`. So I have the following 2 questions:

1.  What's the best way of designing such tests? (perferably, in py.test)
2.  I want to test func1 and func2 *without* invoking `__init__`. I read from [here](https://stackoverflow.com/questions/6383914/is-there-a-way-to-instantiate-a-class-without-calling-init) that `A.__new__()` can skip invoking `__init__` but still having the class instantiated. Is there a better way to achieve what I need without doing this?

NOTE:

There have been 2 questions regarding my ask here:

1.  Is it necessary to test individual member functions?
2.  (for testing purpose) Is it necessary to instantiating a class without initializing the object with `__init__`?

For question 1, I did a quick google search and find some relevant study or discussion on this:

*   [Unit Testing Non Public Member Functions](http://c2.com/cgi/wiki?UnitTestingNonPublicMemberFunctions)
*   [(PDF) Incremental Testing of Object-Oriented Class Structures.](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CGgQFjAC&url=http://citeseer.ist.psu.edu/viewdoc/download?doi=10.1.1.55.8988&rep=rep1&type=pdf&ei=fCEOULqDCMiaiAL2u6DMCQ&usg=AFQjCNFqfLfMeZfpV8gjW2fh362qFjFoXw&sig2=gstb1sIzmDKLDB1KV8Y2iA)

> We initially test base classes having no parents by designing a test suite that tests each member function individually and also tests the interactions among member functions.

For question 2, I'm not sure. But I think it is necessary, as shown in the sample code, func1 and func2 are called in `__init__`. I feel more comfortable testing them on an class A object that hasn't been called with `__init__` (and therefore no previous calls to func1 and func2).

Of course, one could just instantiate a class A object with regular means (testobj = A()) and then perform individual test on func1 and func2\. But is it good:)? I'm just discussing here as what's the best way to test such scenario, what's the pros and cons.

On the other hand, one might also argue that from design perspective one should NOT put calls to func1 and func2 in `__init__` in the first place. Is this a reasonable design option?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-24T03:45:14.317

在不实例化类（包括 running `__init__`）的情况下测试类的方法通常是没有用的，甚至是不可能的。通常，您的类方法将引用类的属性（例如，`self.a`）。如果您不运行`__init__`，这些属性将不存在，因此您的方法将不起作用。（如果您的方法不依赖于其实例的属性，那么为什么它们是方法而不仅仅是独立函数？）在您的示例中，它看起来像`func1`并且`func2`是初始化过程的一部分，因此它们应该作为那。

`__new__`理论上，可以通过使用然后仅添加您需要的成员来“准实例化”该类，例如：

```
obj = A.__new__(args)
obj.a = "test value"
obj.func1() 
```

但是，这可能不是一个很好的测试方法。一方面，它会导致您复制可能已经存在于初始化代码中的代码，这意味着您的测试更有可能与真实代码不同步。另一方面，您可能必须以这种方式复制许多初始化调用，因为您必须手动重新执行从您的类调用的任何基类`__init__`方法可能会执行的操作。

至于如何设计测试，你可以看看[unittest 模块](http://docs.python.org/library/unittest.html)和/或[nose 模块](http://nose.readthedocs.org/en/latest/index.html)。这为您提供了如何设置测试的基础知识。实际放入测试的内容显然取决于您的代码应该做什么。

编辑：您的问题 1 的答案是“肯定是的，但不一定是每一个”。您的问题 2 的答案是“可能不是”。即使在您提供的第一个链接中，关于是否应该测试不属于该类的公共 API 的方法也存在争议。如果您的 func1 和 func2 是纯粹的内部方法，只是初始化的一部分，那么可能不需要与初始化分开测试它们。

这就涉及到最后一个问题，即从 inside 调用 func1 和 func2 是否合适`__init__`。正如我在评论中反复声明的那样，这取决于*这些功能的作用*。如果 func1 和 func2 执行部分初始化（即，为实例做一些“设置”工作），那么从`__init__`;调用它们是完全合理的。但在这种情况下，它们应该作为初始化过程的一部分进行测试，不需要单独测试它们。如果 func1 和 func2*不是*初始化的一部分，那么是的，您应该独立测试它们；但在那种情况下，他们为什么在`__init__`？

构成实例化类的组成部分的方法应作为测试类实例化的一部分进行测试。不构成实例化类的组成部分的方法不应从内部调用`__init__`。

如果 func1 和 func2 是“简单的输入/输出逻辑”并且不需要访问实例，那么它们根本不需要是类的方法；它们可以只是独立的功能。如果要将它们保留在类中，可以将它们标记为静态方法，然后直接在类上调用它们而不实例化它。这是一个例子：

```
>>> class Foo(object):
...     def __init__(self, num):
...         self.numSquared = self.square(num)
...     
...     @staticmethod
...     def square(num):
...         return num**2
>>> Foo.square(2) # you can test the square "method" this way without instantiating Foo
4
>>> Foo(8).numSquared
64 
```

可以想象你可能有一些怪物类，它需要一个非常复杂的初始化过程。在这种情况下，您可能会发现有必要单独测试该过程的各个部分。然而，这样一个巨大的初始化序列本身就是一个笨拙设计的警告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-25T08:05:12.147

如果您有选择，我会将您的初始化辅助函数声明为静态方法，然后从测试中调用它们。

如果您有不同的输入/输出值要断言，您可以[使用 py.test 查看一些参数化示例](http://pytest.org/latest/examples/parametrize.html)。

如果您的类实例化有些繁重，您可能需要查看[依赖注入](http://pytest.org/latest/funcargs.html)并像这样缓存实例：

```
# content of test_module.py

def pytest_funcarg__a(request):
    return request.cached_setup(lambda: A(...), scope="class")

class TestA:
    def test_basic(self, a):
        assert .... # check properties/non-init functions 
```

这将在每个测试类中重复使用相同的“a”实例。其他可能的范围是“会话”、“功能”或“模块”。您还可以定义一个命令行选项来设置范围，以便快速开发您使用更多缓存和连续集成您使用更多隔离资源设置，而无需更改测试源代码。

就个人而言，在过去的 12 年中，我从细粒度的单元测试转向了更多功能/集成类型的测试，因为它简化了重构并且似乎更好地利用了我的时间。当然，在发生故障时获得良好的支持和报告至关重要，例如下降到 PDB、简洁的回溯等。对于一些复杂的算法，我仍然编写非常细粒度的单元测试，但是我通常将算法分离成一个非常独立的可测试的东西。

HTH，霍尔格

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-15T16:33:25.430

我同意之前的评论，通常最好通过减少在实例化时完成的工作量来避免这个问题，例如通过将`func1`etc 调用移动到`configure(self)`应该在实例化后调用的方法中。

如果您有充分的理由保留对`self.func1`etc in的调用`__init__`，那么有一种方法`pytest`可能会有所帮助。

(1) 将其放入模块中：

```
_called_from_test = False 
```

(2) 将以下内容放入conftest.py

```
import your_module

def pytest_configure(config):
    your_module._called_from_test = True 
```

具有适当的名称`your_module`。

(3)在运行测试时插入一条`if`语句以结束早期的执行，`__init__`

```
 if _called_from_test:
      pass
   else:
      self.func1( ....) 
```

然后，您可以单步执行各个函数调用，随时测试它们。

同样可以通过制作`_called_from_test`一个可选参数来实现`__init__`。

[如果从文档的 pytest 运行](https://docs.pytest.org/en/latest/example/simple.html)部分中运行，则在检测中给出了更多上下文`pytest`。

# ruby-on-rails - How to sanitize strings for storage in a sqlite database?

> ID：11623808
> 
> 赞同：2
> 
> 时间：2012-07-24T03:40:08.740
> 
> 标签：ruby-on-rails, sqlite, sanitization

I'm trying to store tags from mp3's in a sqlite database and I get the following error:

```

SQL (0.3ms)  INSERT INTO "songs" ("album", "artist", "created_at", "length", "path", "store_id", "title", "track_number", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)  [["album", "\xFF\xFE2\x001\x00"], ["artist", "\xFF\xFEa\x00d\x00e\x00l\x00e\x00"], ["created_at", Tue, 24 Jul 2012 03:34:03 UTC +00:00], ["length", 15], ["path", "/audios/music/Adele - Discography (Complete) [2008 - 2011]/Adele - 21 [2011] + Bonus Tracks/01\. Adele - Rolling in the Deep.mp3"], ["store_id", 3], ["title", "\xFF\xFEr\x00o\x00l\x00l\x00i\x00n\x00g\x00 \x00i\x00n\x00 \x00t\x00h\x00e\x00 \x00d\x00e\x00e\x00p\x00"], ["track_number", "01"], ["updated_at", Tue, 24 Jul 2012 03:34:03 UTC +00:00]]
Encoding::UndefinedConversionError: "\xFF" from ASCII-8BIT to UTF-8: INSERT INTO "songs" ("album", "artist", "created_at", "length", "path", "store_id", "title", "track_number", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
   (0.2ms)  rollback transaction
ActiveRecord::StatementInvalid: Encoding::UndefinedConversionError: "\xFF" from ASCII-8BIT to UTF-8: INSERT INTO "songs" ("album", "artist", "created_at", "length", "path", "store_id", "title", "track_number", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)

```

How could I strip or sanitize the input?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T11:54:51.587

ActiveRecord 抱怨`Encoding::UndefinedConversionError: "\xFF" from ASCII-8BIT to UTF-8`，但很明显那`\xFF\xFE2\x001\x00`不在`ASCII-8BIT`编码中。因此，您可以通过在调用 ActiveRecord 之前将 id3 标签转换为 UTF-8 来解决此问题。

```
"source string".encoding(dst_encoding, src_encoding). 
```

文档：[http ://www.ruby-doc.org/core-1.9.3/String.html#method-i-encode](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-encode)

# javascript - how to find better implementation of a function in javascript

> ID：11623812
> 
> 赞同：1
> 
> 时间：2012-07-24T03:40:40.583
> 
> 标签：javascript

I wrote three javascript functions which works the same task. They all provide the same result but I am wondering which one of them is faster and most scalable?

Here are my functions first one

```
function odds(n, p) {
    var acc = 1;
    for (var i = 0; i < n; i++) {
        acc *= (n - i) / (p - i);
    }
    return acc;
} 
```

second one

```
function odds(n, p) {
    if (n == 0) {
        return 1;
    } else {
        return (n / p) * odds(n - 1, p - 1);
    }
} 
```

third one

```
var odds = (function () {
    var odds1 = function(n, p, acc) {
        if(n == 0) {
            return acc;
        } else {
            return odds1(n - 1, p - 1, (n / p) * acc);
        }
    }
    return function(n, p) {
        return odds1(n, p, 1);
    }  
}()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T04:08:00.180

您必须测试才能回答这样的问题，但通常来说，内部循环几乎总是比 javascript 中的递归快。像[jsPerf](http://jsperf.com)这样的测试工具对于提供真实数据非常非常有帮助。

我在这里为您的三个案例构建了一个 jsPerf：http: [//jsperf.com/oddsflavors](http://jsperf.com/oddsflavors)。对于我选择的参数（我不确定哪些参数对您最重要），它显示您的第一个代码选项（没有递归的那个）大约是第二个的两倍。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T03:44:49.250

你可以使用[http://jsperf.com/](http://jsperf.com/)来测试 javascript 的性能，这样你就可以知道哪个函数更快

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T03:46:15.713

您可以使用各种工具来测试 Javascript 代码的速度，例如[JSLitmus](http://www.broofa.com/Tools/JSLitmus/)和[jsPerf](http://jsperf.com/)。

另外，看看这个问题：[你如何对 JavaScript 代码进行性能测试？](https://stackoverflow.com/questions/111368/how-do-you-performance-test-javascript-code)
还有[这篇](http://jquery-howto.blogspot.com/2008/12/how-to-test-javascript-performance.html)关于 Javascript 性能测试的文章。

# javascript - javascript/jquery- how to determine the partial text belonging to an HTML element that has been selected by user

> ID：11623813
> 
> 赞同：0
> 
> 时间：2012-07-24T03:40:41.983
> 
> 标签：javascript, jquery

In a javascript function that I am developing, the user selects some content on a html web page. The content selected can include text, HTML elements, links and images.

Also, the content can start from some portion of one HTMl element, then entire content of some other HTML elements and so on.

I understand how to obtain the Ids of the html elements from which text has been selected.

However, how do I obtain only the portion of text within an HTML element that has been selected (viz. in case user has selected only some portion of content within an HTML Element- i.e. he has not selected the entire content of that element). Also, what is the easiest way to determine if the user has selected partial content or entire content within an HTML element? I would prefer a solution in JQuery but a javascript solution will also be fine with me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:50:52.637

Try `document.getSelection`，它返回一个选择对象，该对象代表文档中选择的文本。它不会返回在 input 或 textarea 元素中选择的文本。或者尝试`window.getSelection`.

请参阅[HTML5 DOM 范围](http://html5.org/specs/dom-range.html)

```
function getSelectedText() {

  // DOM
  // supported by Firefox, Chrome, Opera
  // Concatenate an empty string to fix bug in Safari <2.0 and Firefox < 1.0.3
  if (window.getSelection) {
    return window.getSelection() + '';

  // This seems to work in all browsers that support window.getSelection
  // and also IE 9+? (per MSDN, untested)
  } else if (document.getSelection) {
    return document.getSelection() + '';

  // IE 6, 7 & 8?
  } else if (document.selection) {
    return document.selection.createRange().text;

  } else {
    return null;
  }
} 
```

# ruby-on-rails - undefined method `[]' for nil:NilClass - When trying to run rake db:test:load for the first time

> ID：11623814
> 
> 赞同：0
> 
> 时间：2012-07-24T03:40:45.880
> 
> 标签：ruby-on-rails

I am trying to create some functional tests around my controllers but when I attempt to create the test db I get the error described in my thread. This is the first time I have attempted to populate a test db. I am using the default sqlite adapter. I have populated my fixtures with some test values. Can someone tell me what this error means?

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:02:05.580

显然我需要指定要使用的环境。这个命令成功了：rake db:test:load RAILS_ENV="test"

# c++ - Creating a 1D Vector and Assigning Values by Reference C++

> ID：11623816
> 
> 赞同：0
> 
> 时间：2012-07-24T03:41:05.623
> 
> 标签：c++, function, vector, reference, dimensional

I'm a novice coder, just a few months into learning C++. This is my second question on Stack Overflow, and I really hope that the answers will benefit me and others.

I started working on this program because I wanted to create a vector engine that could create a 1D vector, assign a value to any position in that 1D vector (by abstracting width and height to simulate 2D), and then print out said vector. The end goal of a project like this would be to later have a rendering engine that would convert the int values in this vector to image tiles on the screen using SDL or equivalent.

I previously made a program that could do something similar using a vector of objects each containing a character, but I didn't pass values by reference, so I really wanted to nail passing values by reference in this program.

The code compiles just fine, and the cout statements in the assignToVector function seem to indicate that the value is being assigned properly. But when I call the final print statement, the value that I want to pass into the vector is not properly outputted. I'm using vector.erase to clear the position before assigning a value to it, and vector.assign to input the value, if that helps narrow down the problem.

I really appreciate the time anyone spends answering this question! Thank you!

EDIT: The suggestion made by chris below fixed the first part of the problem (change std::cout << printerVector[*it] TO std::cout << *it).

However I find I needed to add a position--; after I create it in order to align the value properly. Basically, the inputted width and height values don't match their actual position on the grid. Any further help on this would be appreciated! I think it's an issue related to one dimensional vectors and using them as 2D.

```
//The purpose of this program is to create a one dimensional vector of integers
//that is equal to the desired screen size.  Look at the preprocessor defines
//to change these values.
//The program also contains a function to print the created vector for testing
//purposes.
#include <iostream>  //Needed for std::cout and std::endl
#include <vector>    //Needed for std::vector and others

#define CONSOLEWIDTH  80;
#define CONSOLEHEIGHT 25;

//This function is supposed to assign a value to a specific point in the 1D vector matrix.
//The posWidth and posHeight are used to compute the location with default console values, mimicking 2D.
void assignToVector(std::vector<int>& intVector, int posWidth, int posHeight, int assignValue);

//This is mostly just a testing function to ensure that the desired
//contents are properly stored in the vector.
void printVector(std::vector<int>& printerVector);

//Creates the test vector, prints it, modifies it, and prints it again
void setupAndRun();

int main()
{
    setupAndRun();
}

void assignToVector(std::vector<int>& intVector, int posWidth, int posHeight, int assignValue)
{
    int position = posWidth + posHeight*CONSOLEWIDTH;
    //std::cout << intVector[position] << std::endl;
    std::cout << position << std::endl;
    intVector.erase(intVector.begin() + position);
    //std::cout << intVector[position] << std::endl;
    std::cout << assignValue << std::endl;
    intVector.insert(intVector.begin() + position, 1, assignValue);
    std::cout << intVector[position] << std::endl;
}

void printVector(std::vector<int>& printerVector)
{
    for(std::vector<int>::iterator it = printerVector.begin(); it != printerVector.end(); it++)
    {
        std::cout << printerVector[*it];
    }
}

void setupAndRun()
{
    int width     = CONSOLEWIDTH;
    int height    = CONSOLEHEIGHT;
    //Creates a vector of size argument1 that each have a value of argument2
    //This syntax doesn't seem to work inside classes
    std::vector<int> testVector(width*height, 8);
    //80*25 8's
    printVector(testVector);
    //Suppossed to assign 200 to the 10th position of the first row of testVector
    assignToVector(testVector, 10, 0, 200);
    //Prints out 200
    std::cout << testVector[10] << std::endl;
    //Prints out default value
    std::cout << testVector[9]  << std::endl;
    //Doesn't have a 200 in it
    printVector(testVector);
} 
```

# database - 在 UML 中表示轮询数据库的 Windows 服务

> ID：11623822
> 
> 赞同：0
> 
> 时间：2012-07-24T03:41:37.413
> 
> 标签：database, service, uml

我有一个 Windows 服务，它不断地轮询数据库以从中获取数据。如何在 UML 中表示这种场景？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T19:03:37.073

您可以使用活动图，其中一个动作是服务休眠时，另一个动作是服务轮询数据库时，您可以将它们连接成一个循环。

另一种可能性是使用具有两种状态的状态机图，一种空闲，一种轮询，并且在轮询状态有一个`do`调用数据库的动作

# multiplication - 伽罗瓦域的快速求幂

> ID：11623827
> 
> 赞同：4
> 
> 时间：2012-07-24T03:43:05.903
> 
> 标签：multiplication, polynomial-math, exponentiation, galois-field, finite-field

我希望能够计算

```
g^x = g * g * g * ... * g     (x times) 
```

其中 g 在有限域 GF(2^m) 中。这里 m 相当大，m = 256、384、512 等，因此查找表不是解决方案。我知道对于类似的想法有非常快速的算法，用于 Z/nZ 的 modpow（参见[HAC](http://cacr.uwaterloo.ca/hac/about/chap14.pdf)的第 619-620 页）。

1.  什么是计算周期（即 g^x）的快速、非基于表格的方法？
2.  这绝对是一个一厢情愿的问题，但它来了：[蒙哥马利乘法/求幂](http://en.wikipedia.org/wiki/Montgomery_reduction)的想法可以“循环”到伽罗瓦域吗？由于同构属性，我想这样想，但我真的不知道。

备注：这是我在 math.stackoverflow.com 上的[帖子](https://math.stackexchange.com/questions/174459/cycling-through-powers-of-a-generator-of-finite-field-something-similar-to-modp)我想这是提出这个问题的最佳社区。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T22:33:19.850

在[数学 stackexchange](https://math.stackexchange.com/questions/174459/cycling-through-powers-of-a-generator-of-finite-field-something-similar-to-modp)社区，我有两个人建议[Binary Exponentiaion](http://en.wikipedia.org/wiki/Exponentiation_by_squaring)。维基百科将递归它称为递归算法。可以将其更改为迭代算法，如 Wiki 的伪代码所示。

起初我对这个想法不以为然，但我仔细研究了一下，发现了两篇论文（[1](http://research.microsoft.com/pubs/103205/c14expgf.pdf)、[2](http://www.csd.uwo.ca/~eschost/Exam/Koc.pdf)），它们可以帮助在使用蒙哥马利乘法的伽罗瓦域中实现二进制取幂。

此外，[Jyrki Lahtonen](https://math.stackexchange.com/users/11619/jyrki-lahtonen)建议使用正常碱基（或当 m =/= 256,384、512 等最佳正常碱基时）来加速乘法。可以在[本文](http://www.shoup.net/papers/pow.pdf)中找到这种乘法方法的算法。

感谢 sarnold 的意见。

# jquery - 执行 AJAX POST 时不允许使用的关键字符

> ID：11623829
> 
> 赞同：3
> 
> 时间：2012-07-24T03:43:09.710
> 
> 标签：jquery, ajax, codeigniter, textarea

> **可能重复：**
> [CodeIgniter Disallowed Key Characters](https://stackoverflow.com/questions/4197976/codeigniter-disallowed-key-characters)

我正在使用 CodeIgniter，当我通过 jQuery 使用 AJAX 调用时，我得到一个`POST`错误，我不知道为什么。有针对这个的解决方法吗？`<textarea>``Disallowed Key Characters`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:47:39.967

我用 CodeIgniter 遇到了这个问题，并在这里找到了解决方案：http: [//codeigniter.com/forums/viewthread/140333/](http://codeigniter.com/forums/viewthread/140333/)。它涉及`system/libraries/Input.php`在 CodeIgniter 中进行更改或删除正则表达式禁止的字符。

这些行是错误消息的来源：

```
if ( ! preg_match("/^[a-z0-9:_\/-]+$/i", $str))
{
    exit('Disallowed Key Characters.');
} 
```

# ios - 视图和数据级别的 ios 基于角色的访问控制

> ID：11623830
> 
> 赞同：0
> 
> 时间：2012-07-24T03:43:13.140
> 
> 标签：ios, security, core-data, role-based

我想为我目前正在开发的*iOS应用程序实现基于角色的访问控制。*需要控制对视图和实际数据的访问。例如，我将根据用户的角色使用不同的按钮显示相同的视图。同样，我想在数据级别保护其他机密信息。

我认为对此没有简单的解决方案（读取配置文件），并且需要在代码本身中实现它。为了保护对视图的访问，它将像`hiding/showing`基于角色的不同视图一样繁琐。为了保护数据，在 Core Data 数据模型本身中拥有各种访问权限作为实体属性。

我的结论对吗？有没有更好的方法来完成同样的事情？谢谢！

# mysql - 对 MySQL 识别与非识别关系感到困惑

> ID：11623834
> 
> 赞同：1
> 
> 时间：2012-07-24T03:44:07.150
> 
> 标签：mysql, sql, schema

我正在为位置数据库设计数据库模式。我正在使用 MySQL Workbench 5.2.40 创建下图。我目前对识别与非识别关系的使用感到困惑。

这是我的架构图：

![架构图](../Images/19c452f4702c602f9f23807e12c2a403.png)

在阅读[了这个问题](https://stackoverflow.com/questions/762937/whats-the-difference-between-identifying-and-non-identifying-relationships)和其他相关问题之后，我想我应该为那些属于对象本身的属性使用*识别关系（例如，位置有电话号码）。***但是在我添加了Locations**和**OperatingHours**之间的关系之后，我很惊讶它添加了**CostRange**的主键。

我对识别和/或非识别关系的使用是错误的吗？如果是这样，请你给建议。

*注意：我知道我的架构中需要更改更多内容。您可以评论设计的其他方面，但请让我们首先关注我的外键问题，以免我们跑题。*

# c# - 将项目添加到字典而不使用 C# 中的 Add 方法

> ID：11623843
> 
> 赞同：3
> 
> 时间：2012-07-24T03:45:57.163
> 
> 标签：c#, dictionary

我有项目，我想将它们添加到 Dictionary 而不使用 Add 方法（因为它消耗行数）。有什么方法可以将项目添加到字典中

```
new List<string>() { "P","J","K","L","M" }; 
```

或类似 List 中的 AddRange 方法。任何帮助都将受到高度重视。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T03:50:53.713

[从这里](http://msdn.microsoft.com/en-us/library/bb531208.aspx)引用

```
 Dictionary<int, StudentName> students = new Dictionary<int, StudentName>()
 {
   { 111, new StudentName {FirstName="Sachin", LastName="Karnik", ID=211}},
   { 112, new StudentName {FirstName="Dina", LastName="Salimzianova", ID=317}},
   { 113, new StudentName {FirstName="Andy", LastName="Ruth", ID=198}}
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-24T03:52:20.840

您可以轻松地创建一个为您的字典执行 AddRange 的扩展方法

```
namespace System.Collections.Generic
{
    public static class DicExt
    {
        public static void AddRange<K, V>(this Dictionary<K, V> dic, IEnumerable<K> keys, V v)
        {
            foreach (var k in keys)
                dic[k] = v;
        }
    }
}

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {

            var list  = new List<string>() { "P", "J", "K", "L", "M" };
            var dic = new Dictionary<string, bool>();

            dic.AddRange(list, true);

            Console.Read();

        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T03:53:28.313

这很容易

```
var dictionary = new Dictionary<int, string>() {{1, "firstString"},{2,"secondString"}}; 
```

# php - 带有mysql数据和php的按钮

> ID：11623849
> 
> 赞同：0
> 
> 时间：2012-07-24T03:46:42.020
> 
> 标签：php, mysql, facebook-like

我正在测试我的网站并尝试在我的链接上输入“赞”按钮。我想要做的是显示来自 mysql 数据库的标题、url 和图像，例如我的代码现在是这样的：

```
<meta property="og:title" content="<?php echo $titulo; ?>" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://hogardelocio.com/pl.php?pl=<?php echo $lid; ?>" />
<meta property="og:image" content="http://hogardelocio.com/img/<?php echo $imagem; ?>" /> 
<meta property="og:site_name" content="Hogar del Ocio" /> 
```

在调试中它看起来很好，它正确显示了图像、标题和链接，但是如果你点击我页面上的“喜欢”按钮并分享它，它只会显示这个链接“http://hogardelocio.com/ pl.php?pl" 和另一个没有标题的图片...

这是调试页面： http: [//developers.facebook.com/tools/debug/og/object ?q=http%3A%2F%2Fwww.hogardelocio.com%2Fpl.php%3Fpl%3D91](http://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fwww.hogardelocio.com%2Fpl.php%3Fpl%3D91)

有人可以帮助我吗？谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T03:52:48.497

我查看了[您的页面](http://www.hogardelocio.com/pl.php?pl=91)，似乎错误不在于您的`<meta>`标签，`data-href`而在于格式错误的 fb:like 按钮：

这是您页面上的内容：

```
<div class="fb-like" 
    data-href="http://hogardelocio.com/pl.php?pl='link.php?link=91'" 
    data-send="false" data-layout="button_count" data-width="20" 
    data-show-faces="false" data-font="arial">
</div> 
```

如果我没记错的话，它应该在哪里：

```
<div class="fb-like" data-href="http://hogardelocio.com/pl.php?pl=91" 
    data-send="false" data-layout="button_count" data-width="20" 
    data-show-faces="false" data-font="arial">
</div> 
```

# bash - 需要帮助将批处理转换为 bash

> ID：11623850
> 
> 赞同：0
> 
> 时间：2012-07-24T03:46:45.863
> 
> 标签：bash, batch-file

所以我一直在尝试将我的批处理文件转换为 bash。我正在运行一个 linux (ubuntu) 服务器，我想在那里运行我的游戏服务器而不是我的工作/游戏机。这是重击

```
@echo off
title BSH 525
cd ../build 
"C:\Program Files\Java\jdk1.7.0_03\bin\java.exe" -Xmx700m -server -cp .;../deps/*; net/com/codeusa/Server 43595
pause 
```

这是我在 bash 上的尝试

```
!/bin/bash
cd ../build 
java -server -cp .;../deps/*; ../net/com/codeusa/Server 43595 
```

我不断收到诸如找不到文件之类的错误，或者 java 抱怨语法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:49:48.613

几件事：

*   第一行应为：

    ```
    #!/bin/bash 
    ```

    带头`#`。这是一种特殊的语法，它告诉内核应该使用哪个 shell 来运行您的脚本。

*   在 Unix 中，路径`:`在 Java 类路径中用 分隔，而不是`;`. 所以试试：

    ```
    java -server -cp .:../deps/* ../net/com/codeusa/Server 43595 
    ```

    这`;`实际上是一个命令分隔符，因此 shell 将您的单行视为三个不同的命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:49:02.453

在 Linux 中，目录分隔符`:`是`;`

```
java -server -cp .:../deps/*: ../net/com/codeusa/Server 43595 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T03:52:28.880

你有几个问题：

```
!/bin/bash
cd ../build 
java -server -cp .;../deps/*; ../net/com/codeusa/Server 43595 
```

hashbang[行](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)不正确；它应该是：

```
#!/bin/bash 
```

你有一个`cd ../build`-- 但是在你执行这个脚本*之前当前的工作目录是什么？*您必须得到正确的 - 或者使用绝对目录，例如：

```
cd ~/gameserver/build 
```

而且，类 Unix 系统上*目录列表*的路径分隔符`:`不是`;`. 因此，您的 Java 命令应如下所示：

```
java -server -cp .:../deps/*: ../net/com/codeusa/Server 43595 
```

（虽然我对类搜索路径末尾的空白目录感到惊讶......）

# php - 如何在 SQL 中总结分组结果

> ID：11623851
> 
> 赞同：0
> 
> 时间：2012-07-24T03:47:32.967
> 
> 标签：php, mysql, sql

我试图避免在此查询之后涉及 php。我有一张表格，其中包含员工列表以及他们在几秒钟内工作了多少时间，日期等......我想：

```
select SUM(`seconds`) between date A and date B group by WEEK(`date`) 
```

这会给我每周的结果，但现在我想通过在整个结果集上使用 AVG() 来获得每周平均工作秒数。您如何在一个查询中完成此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:04:22.383

你可以使用这样的东西

```
select sum(total) from (select SUM(`seconds`) as total between date A and date B group by WEEK(`date`)) as tbl1 
```

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:58:29.197

这可以解决问题：

```
Select AVG(sum_seconds) from (select SUM('seconds') as sum_seconds between date A and date B group by WEEK('date')) as a 
```

# ios - 针对未登录 Game Center 的用户的高分政策

> ID：11623854
> 
> 赞同：1
> 
> 时间：2012-07-24T03:47:59.130
> 
> 标签：ios, game-center

我设计了一个游戏来将高分保存到 Game Center 排行榜。现在，我的项目经理说。“所以那些没有开启游戏中心的，让他们在本地保存高分。”

好的，但这可能会在以下情况下引起混淆：

*   用户在没有 GC 的情况下玩游戏并获得高分。然后用户登录 GC 并再次切换到您的游戏。您应该一起删除本地高分的显示吗？

当涉及到这种情况时，是否有一个普遍的“这样做”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:26:36.153

IMO最大的担忧是保持用户的高分。如果出现用户本地高分A，游戏中心高分B的情况，则显示max(A, B)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T05:56:27.077

始终在本地缓存或保存高分。这样，即使启用了 Game Center 的用户也可以在离线时查看他们的分数，并在重新连接时提交。您可以为离线分数创建自己的 UI，并添加一个指示符，表明给定分数已提交到 Game Center。然后，提供一种查看 Game Center 分数的方法。（您可以使用自定义视图控制器或标准视图控制器。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T06:07:01.193

我不知道在这种情况下是否有“最佳实践”，但我有一个游戏可以两者兼得，我最终做了以下事情：

*   如果 GC 被禁用，您将获得本地保存的高分。
*   如果启用了 GC，您将获得 GC 高分。没有本地高分。

现在，我开发这款游戏的时候，GC是全新的，很多用户都没有，所以本地高分似乎是一种要求。如果我今天开发它，我可能会完全跳过本地高分。如果你没有GC，你就不会得到高分，期间。

但是请注意，我是在专门谈论 GC 被禁用。如果用户已登录 GC，但它不可用（例如，没有网络连接），您绝对应该将任何获得的高分排队，以便稍后在网络再次可用时将它们发送给 GC。

# android - 向 ListView 添加新条目

> ID：11623857
> 
> 赞同：1
> 
> 时间：2012-07-24T03:48:17.457
> 
> 标签：android, android-linearlayout

我的目标是能够将两个数字输入到两个单独`EditText fields`的 中，对这两个数字进行快速计算，然后将其添加`three numbers + the date`到列表中，同时保留所有旧条目，以便在顶部的表格中添加另一行。

```
 Date1  |  Num1  |  Num2  |  CalculatedNum3 

 Date2  |  Num4  |  Num5  |  CalculatedNum6 
```

以上将是 ListView 设计的粗略布局。

我研究过数组、字符串和适配器，但我似乎无法理解它们；我如何在这种情况下使用它们。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:12:35.357

你需要的是一个 ListView。ListView 是一个视图，它根据给定给它的 Adapter 观察到的数据集中存在的元素，自动在滚动的垂直列表中对其子视图进行排序。本质上，分为三个部分：

1.  包含要显示的数据的数据集。
2.  适配器提供从该数据到的接口：
3.  视图本身，负责显示数据。

您需要定义的是从某种集合到适配器的映射，以便适配器知道如何访问它需要提供给 ListView 的数据。Android SDK 中有这方面的示例，甚至还有[ListView 教程](http://developer.android.com/guide/topics/ui/layout/listview.html)。

除此之外，还有两种方法可以在 ListView 中显示数据。您可以计算字符串`"DateX | Num1 | Num2 | CalculatedNumX"`并让每个列表元素成为该字符串（最简单）。或者，您可以创建一个包含 4 个（或 7 个）文本框的自定义视图，并使用适当的数据单独填充每个文本框。这更复杂，但其优势在于为文本的格式和位置提供了更多的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T05:00:05.687

有很多方法可以做到这一点，在某些情况下，有些方法比其他方法更好。

**了解您将使用的课程**

正如在另一个答案中发布的那样，您将需要：

*   显示您的数据的`ListView`一些风格
*   某种适配器（`BaseAdapter`会很好）来处理显示您的数据
*   用于存储数据的变量（我建议使用`ArrayList`）
*   一个自定义`Layout`，在你的一行中显示每组数据`ListView`

**把它变成有效的东西**

首先，最简单的方法是制作您的组件，然后最后链接它们。所以首先，你的每一行的布局`ListView`：

```
// Very basic layout for a row
public class rowView extends LinearLayout {
    TextView tv1 = null;
    TextView tv2 = null;
    TextView tv3 = null;
    TextView tv4 = null;

    public rowView(Context ct) {
        super(ct);

        // Do some Layout settings as needed
        setOrientation(LinearLayout.HORIZONTAL);

        // Create and configure TextViews
        tv1 = new TextView(ct);
        tv2 = new TextView(ct);
        tv3 = new TextView(ct);
        tv4 = new TextView(ct);

        tv1.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT, 1.0f));
        tv2.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT, 1.0f));
        tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT, 1.0f));
        tv4.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT, 1.0f));

    // Add the views to the layout
        addView(tv1);
        addView(tv2);
        addView(tv3);
        addView(tv4);
    }
} 
```

接下来是您的数据显示，您将其链接到您`EditText`的等的方式会有所不同。但这里有一些关于如何使用`ArrayList<String[]>`.

假设当您计算第三个数字时，您调用如下函数：

```
public void addData(String date, String num1, String num2, String calculatedNum) {
    String[] s = new String[4];

    s[0] = date;
    s[1] = num1;
    s[2] = num2;
    s[3] = calculatedNum;

    arrayListofStrings.add(s);
} 
```

现在您的数据已存储。最后一个主要步骤是简单地创建您的适配器，您必须设置它以正确“让您`ListView`正确地与您的数据交谈”。看到您的新数据被添加到您的末尾`ArrayList`（这比尝试将其添加到开头要容易得多），您所要做的就是翻转适配器中的顺序，如下所示：

```
public class myAdapter extends BaseAdapter {

    public int getCount() {
        return arrayListofStrings.size();
    }

    public Object getItem(int position) {
        // Returns the strings in REVERSE order
        return arrayListofStrings.get(arrayListofStrings.size() - 1 - position);
    }

    public long getItemId(int position) {
        // Not concerned with this
        return 0;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        // Here is the version for memory optimization (aka view recycling). This should be habit

        rowView ret = null;

        if (convertView == null) {
            // Create a new view
            ret = new rowView(getApplicationContext());
        } else {
            // Cast and reuse
            ret = (rowView) convertView;
        }

        // Get the data
        String[] data = (String[]) getItem(position);

        // Update the row with the data
        ret.tv1.setText(data[0]);
        ret.tv2.setText(data[1]);
        ret.tv3.setText(data[2]);
        ret.tv4.setText(data[3]);

        return ret;
    }
} 
```

最后一步只是`ListView`在你需要的地方创建你的，创建并附`Adapter`加到你的`ListView`和其他次要的东西（比如将你的值转换为字符串等）。

这绝不是一个可行的解决方案，只是其中包含什么样的想法以及您需要做什么的胆量。

**注意：**无论何时更改数据，请确保**调用** [BaseAdapter.notifyDataSetChanged](http://developer.android.com/reference/android/widget/BaseAdapter.html#notifyDataSetChanged%28%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T05:09:02.290

这是您需要的：

1.  一个类包含这些数据：`Date1`, `Num1`, `Num2`,`CalculatedNum`
2.  一个自定义适配器，从`BaseAdapter`
3.  内项目的布局`ListView`
4.  主布局，其中包含`ListView`
5.  最后，主要活动由二`TextView`、二`EditText`和一组成`Button`。

这是设置 的最基本的框架`ListView`，当然您可以在代码中实现所有视图，但请尝试遵循此模式。它将使您的代码更清晰，更容易适应布局的变化。

**#1**

```
package com.example.demo;

public class Data {
    private int mX;
    private int mY;
    private int mSum;
    private String mDate;

    public Data(int x, int y, int sum, String date) {
        mX = x;
        mY = y;
        mSum = sum;
        mDate = date;
    }

    public int getX() {
        return mX;
    }

    public int getY() {
        return mX;
    }

    public int getSum() {
        return mSum;
    }

    public String getDate() {
        return mDate;
    }
} 
```

**#2**

```
package com.example.demo;

import java.util.List;

import android.content.Context;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.TextView;

public class DemoAdapter extends BaseAdapter {
    private Context mContext;
    private List<Data> mItems;
    private ViewHolder mHolder;

    private static LayoutInflater mInflater = null;

    public DemoAdapter(Context context, List<Data> items) {
        mContext = context;
        mItems = items;
        mInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    public int getCount() {
        return mItems.size();
    }

    public Object getItem(int position) {
        return mItems.get(position);
    }

    public long getItemId(int position) {
        return position;
    }

    public static class ViewHolder {
        TextView x;
        TextView y;
        TextView sum;
        TextView date;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.list_item, null);
            mHolder = new ViewHolder();
            mHolder.x = (TextView) convertView.findViewById(R.id.text_x);
            mHolder.y = (TextView) convertView.findViewById(R.id.text_y);
            mHolder.sum = (TextView) convertView.findViewById(R.id.text_sum);
            mHolder.date = (TextView) convertView.findViewById(R.id.text_date);
            convertView.setTag(mHolder);
        }
        else {
            mHolder = (ViewHolder) convertView.getTag();
        }

        mHolder.x.setText(Integer.toString(mItems.get(position).getX()));
        mHolder.y.setText(Integer.toString(mItems.get(position).getY()));
        mHolder.sum.setText(Integer.toString(mItems.get(position).getSum()));
        mHolder.date.setText(mItems.get(position).getDate());
        return convertView;
    }
} 
```

**#3**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <TextView
        android:id="@+id/text_date"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_weight="0.3"
        android:text="date">
    </TextView>

    <TextView
        android:id="@+id/text_x"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_weight="0.2"
        android:text="x">
    </TextView>

    <TextView
        android:id="@+id/text_y"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_weight="0.2"
        android:text="y">
    </TextView>

    <TextView
        android:id="@+id/text_sum"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" 
        android:layout_weight="0.3"
        android:text="sum">
    </TextView>

</LinearLayout> 
```

**#4**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Num 1" />

        <EditText
            android:id="@+id/edit_x"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="23dp"
            android:ems="10"
            android:inputType="number" />
    </LinearLayout>

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >
        <TextView
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:text="Num 2" />

        <EditText
            android:id="@+id/edit_y"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="22dp"
            android:ems="10"
            android:inputType="number" >

            <requestFocus />
        </EditText>
    </LinearLayout>

    <Button 
        android:id="@+id/button_add"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Add"/>

    <ListView
        android:id="@+id/listview"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>

</LinearLayout> 
```

**#5**

```
package com.example.demo;

import java.util.ArrayList;
import java.util.List;

import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ListView;
import android.support.v4.app.NavUtils;

public class MainActivity extends Activity {
    private List<Data> mData;
    private ListView mListView;
    private DemoAdapter mAdapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        setupListView();

        Button add = (Button) findViewById(R.id.button_add);
        add.setOnClickListener(new OnClickListener() {
            public void onClick(View v) {
                EditText editX = (EditText) findViewById(R.id.edit_x);
                EditText editY = (EditText) findViewById(R.id.edit_y);

                int x = Integer.parseInt(editX.getText().toString());
                int y = Integer.parseInt(editY.getText().toString());

                mData.add(new Data(x, y, x + y, "02/33/2033"));
                // add new data to list and refresh
                mAdapter.notifyDataSetChanged();
            }
        });
    }

    private void prepareDummyData() {
        mData = new ArrayList<Data>();
        mData.add(new Data(1, 2, 3, "07/22/2012"));
        mData.add(new Data(2, 3, 5, "07/23/2012"));
    }

    private void setupListView() {
        // add some data
        prepareDummyData();
        mListView = (ListView) findViewById(R.id.listview);
        mAdapter = new DemoAdapter(this, mData);
        mListView.setAdapter(mAdapter);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T04:18:21.637

只需在 ListView（而不是 android_simple_listview_item）使用的适配器上的 getView 方法的 Override 上扩展自定义视图。在您的案例中，在 XML 布局资源上提供 layout_weight 和 weight_sum 属性来控制视图的外观。只需使用 Date 和 Calendar java 类来计算日期。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T04:21:11.577

编写您自己的自定义适配器。您将创建自己的布局，您可以在其中设置基于您自己的自定义布局创建的任何类型的项目。查看以下[链接](http://www.softwarepassion.com/android-series-custom-listview-items-and-adapters/)。它一定会对您有所帮助。

完成基本的 ListView 适配器后，您可以添加计算。要在顶部添加布局，一种方法是使用一个名为`adapt.insert(object, index)`where 您基本上提供添加项目的索引的函数。例如，上面给出的链接有一个名为`getOrders()`.

# java - 向下转换异常

> ID：11623860
> 
> 赞同：0
> 
> 时间：2012-07-24T03:48:25.290
> 
> 标签：java, downcast

我做了这个代码：

```
protected Lala lala;
private Oyeha oyeha;

public void setLala(Lala lala) {
    this.lala = lala;
}

this.oyeha = (Oyeha) this.lala;
            executeHostBean = this.oyeha.updateMethod(a, b, c, d, e); 
```

拉拉是母班。

Oyeha是延伸Lala的孩子。

但是当我运行这段代码时，我得到了错误：

> java.lang.ClassCastException: $Proxy201

我找不到我的错误在哪里。有人可以帮我解决这个问题吗？谢谢你。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:08:51.807

如果你有类似 Spring 注入 Lala 对象的东西，它可能正在创建一个动态代理对象（这就是错误消息所暗示的）。

如果在您的设计中绝对需要向下转换，您可能需要重新考虑设计。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T04:11:00.450

作为其他答案的补充（他们基本上已经确定了）：

假设你*可以这样*沮丧，这样线路就可以`this.oyeha = (Oyeha) this.lala` 工作，并且在 Oyeha 有一些领域，比如说，`test`。

如果您然后尝试在`this.oyeha.test`某个地方使用，它怎么知道在哪里`test`？更糟糕的是，如果 的实例`Oyeha`占用了更多的内存，并且它任意选择了为 的实例预留的地址之外的地址怎么`Lala`办？

我想 Java 的发明者预见到了这样的情况，因此你不能将一个类型的实例转换为它的一个子类。

（我会把这个放在评论中，但是太多了）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:00:33.070

您的问题可能`this.lala`是设置为 Lala 的一个实例，它*不是*Oyeha 的一个实例。由于 Oyeha 是 Lala 的子类，因此可以`public void setLala`使用作为 Oyeha 实例的参数进行调用，如下所示：

```
Lala childInstance = new Oyeha();
setLala(childInstance); 
```

但也可以使用只是 Lala 实例的参数调用该方法，如下所示：

```
Lala parentInstance = new Lala();
setLala(parentInstance); 
```

在第一种情况下，`this.lala`是 Oyeha，因此您可以将其施放给 Oyeha。但在后一种情况下，`this.lala`它只是一个 Lala，而你`this.lala`对 Oyeha 的演员将失败，因为 Lala 不是 Oyeha。

# git - git 中的 fetch 没有得到所有的分支

> ID：11623862
> 
> 赞同：291
> 
> 时间：2012-07-24T03:48:32.077
> 
> 标签：git, git-branch, git-fetch

我克隆了一个存储库，之后其他人创建了一个新分支，我想开始处理它。我阅读了手册，似乎很容易。奇怪的是它不起作用，我发现的所有帖子都表明我在做正确的事情。所以我要让自己受到抨击，因为这*肯定*有什么明显的错误：

正确的做法*似乎*是

```
git fetch
git branch -a
* master
  remotes/origin/HEAD --> origin/master
  remotes/origin/master
git checkout -b dev-gml origin/dev-gml 
```

此时出现了问题，由于某种原因后`git fetch`我看不到 dev-gml 远程分支。为什么不？如果我新克隆存储库，它就在那里，所以远程分支肯定存在：

```
$ mkdir ../gitest
$ cd ../gitest
$ git clone https://github.com/example/proj.git
Cloning into proj...
remote: Counting objects: 1155, done.
remote: Compressing objects: 100% (383/383), done.
remote: Total 1155 (delta 741), reused 1155 (delta 741)
Receiving objects: 100% (1155/1155), 477.22 KiB | 877 KiB/s, done.
Resolving deltas: 100% (741/741), done.
$ cd projdir
$ git branch -a
* master
  remotes/origin/HEAD -> origin/master
  remotes/origin/dev-gml
  remotes/origin/master 
```

我已经尝试过`git update`所有可能`git pull`的排列方式`git fetch --all`...`git pretty-please`

* * *

## 回答 #1

> 赞同：566
> 
> 时间：2014-09-19T20:25:07.357

`remote.origin.fetch`检查设置时可以看到问题
（以我输入的命令开头的行`$`是 bash 提示。其他行是结果输出）

```
$ git config --get remote.origin.fetch
+refs/heads/master:refs/remotes/origin/master 
```

如您所见，在我的例子中，遥控器被设置为专门且仅获取主分支。我按照下面的方法修复了它，包括检查结果的第二个命令。

```
$ git config remote.origin.fetch "+refs/heads/*:refs/remotes/origin/*"
$ git config --get remote.origin.fetch
+refs/heads/*:refs/remotes/origin/* 
```

通配符`*`当然意味着该路径下的所有内容。

不幸的是，在我已经挖掘并通过反复试验找到答案之后，我看到了[这个评论。](https://stackoverflow.com/questions/11623862/git-fetch-doesnt-fetch-all-branches#comment15394706_11623862)

* * *

## 回答 #2

> 赞同：183
> 
> 时间：2018-03-09T03:03:27.803

我今天在回购中遇到了这个问题。

根据顶级解决方案，这不是`+refs/heads/*:refs/remotes/origin/*`问题。

症状很简单，`git fetch origin`或者`git fetch`只是似乎没有做任何事情，尽管有远程分支要获取。

在尝试了很多事情之后，我删除了原始遥控器，并重新创建了它。这似乎已经解决了它。不知道为什么。

删除： `git remote rm origin`

并重新创建： `git remote add origin <git uri>`

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2012-07-24T04:26:34.633

## 远程更新

你需要跑

```
git remote update 
```

或者

```
git remote update <remote> 
```

然后您可以运行`git branch -r`以列出远程分支。

## 结帐一个新的分支

将（新）远程分支作为本地分支进行跟踪：

```
git checkout -b <local branch> <remote>/<remote branch> 
```

或（有时没有额外的它不起作用`remotes/`）：

```
git checkout -b <local branch> remotes/<remote>/<remote branch> 
```

## 有用的 git 备忘单

*   [Git 备忘单](http://cheat.errtheblog.com/s/git)（*我个人最喜欢的*）
*   [git的一些注意事项](http://akrabat.com/computing/some-notes-on-git/)
*   [Git 备忘单](http://www.cheat-sheets.org/saved-copy/git-cheat-sheet.pdf)(pdf)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2020-05-28T17:45:14.583

今天从头开始设置我的仓库时遇到了同样的问题。我尝试了一切，除了删除原点并重新添加它之外，没有任何效果。

```
git remote rm origin
git remote add origin git@github.com:web3coach/the-blockchain-bar-newsletter-edition.git

git fetch --all
// Ta daaa all branches fetched 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-01-03T14:16:31.073

从终端写

```
git fetch --prune. 
```

它工作正常。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-07-24T05:26:25.550

使其更具体 创建一个跟踪分支，这意味着您现在正在跟踪一个远程分支。

```
git branch --track branch remote-branch
git branch --track exp remotes/origin/experimental 
```

之后你可以

```
git branch   # to see the remote tracking branch "exp" created . 
```

然后在那个分支上工作

```
git checkout branchname
git checkout exp 
```

对分支进行更改后。您可以 git fetch 和 git merge 与您的远程跟踪分支合并您的更改并推送到远程分支，如下所示。

```
git fetch origin
git merge origin/experimental  
git push origin/experimental 
```

希望它对您有所帮助并给您一个想法，它是如何工作的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-10-28T09:48:22.013

我遇到了类似的问题，但是在我的情况下，我可以拉/推到远程分支，但`git status`没有显示远程分支的本地分支状态。

另外，在我的情况下`git config --get remote.origin.fetch`没有返回任何东西

问题是`.git/config`在相应远程块的提取行中的文件中有错字。可能是我之前错误添加的东西（有时我直接看这个文件，甚至编辑它）

因此，请检查您在`.git/config`文件中的远程条目是否正确，例如：

```
[remote "origin"]
    url = https://[server]/[user or organization]/[repo].git
    fetch = +refs/heads/*:refs/remotes/origin/* 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-11-16T04:17:33.427

`git checkout --track origin/formats`似乎做到了：

```
% git branch      ### show local branches
* main

% git branch - a  ### show local and remote branches
* main
  remotes/origin/HEAD -> origin/main
  remote/origin/formats
  remote/origin/main

% git checkout --track origin/formats
Switched to a new branch 'formats'
Branch 'formats' set up to track remote branch 'formats' from 'origin'

% git branch
* formats
  main 
```

以下应该做同样的事情，但使用不同的本地分支名称：

```
git checkout -b my-formats origin/formats 
```

[`git switch`](https://stackoverflow.com/a/57066202/4376643)git c2.23 中提供了一种新语法

```
git switch -c <branch> --track <remote>/<branch> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-05T15:20:31.477

这可能是由于面部手掌时刻：如果您在多个克隆之间切换，很容易发现自己在错误的源树中试图拉出一个不存在的分支。当克隆具有相似的名称，或者 repos 是来自多个贡献者中的每个贡献者的同一项目的不同克隆时，这会更容易。当真正的问题是失去焦点或工作环境或两者兼而有之时，一个新的 git clone 显然会解决这个“问题”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-07-28T14:15:06.250

我不得不进入我的 GitExtensions 远程存储库，因为这里似乎没有任何工作。在那里我看到 2 个分支没有配置远程存储库。调整后如下图![在此处输入图像描述](../Images/65b6cd760db6bd3f3d8bbb24a257503c.png)

注意分支`noExternal3`仍然显示为没有远程存储库。不确定 bash 命令的哪个组合会找到或调整它。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-02-25T11:44:18.077

我们有同样的问题，你必须使用

```
git fetch

git push origin branch_name

git branch -r 
```

希望这可以帮助面临同样问题的人

# apache - 将子域重定向到主域

> ID：11623863
> 
> 赞同：1
> 
> 时间：2012-07-24T03:48:32.497
> 
> 标签：apache, mod-rewrite, redirect, subdomain

我正在处理一个同时支持英语和西班牙语的站点，我想知道如何将所有请求重定向到特定语言的子域到主域（en.mysite.com 和 es.mysite.com 到mysite.com）。

整个站点是用 PHP 编写的，它有一个主脚本`index.php`，用于处理`language`和`section`GET 参数并相应地显示内容。

现在，我尝试在 mysite.com 根目录下的 .htaccess 文件中执行以下操作。我认为它澄清了我正在尝试做的事情：

```
RewriteEngine On

# English redirects

RewriteRule ^en.mysite.com$ index.php?language=English&section=Main
RewriteRule ^en.mysite.com/store$ index.php?language=English&section=Store
RewriteRule ^en.mysite.com/create_account$ index.php?language=English&section=CreateAcc

# Spanish redirects

RewriteRule ^es.mysite.com$ index.php?language=Spanish&section=Feed
RewriteRule ^es.mysite.com/comprar$ index.php?language=Spanish&section=Store
RewriteRule ^es.mysite.com/crear_cuenta$ index.php?language=Spanish&section=CreateAcc 
```

但这不起作用。谁能告诉我我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:06:44.820

您不能将主机名作为匹配的一部分包含在 a 中`RewriteRule`，因为它仅与 URI 匹配。您需要*为每个规则*`RewriteCond`使用与主机名匹配的单独的：

 *```
RewriteCond %{HTTP_HOST} ^en.mysite.com$ [NC]
RewriteRule ^$ /index.php?language=English&section=Main

RewriteCond %{HTTP_HOST} ^en.mysite.com$ [NC]
RewriteRule ^store$ /index.php?language=English&section=Store

RewriteCond %{HTTP_HOST} ^en.mysite.com$ [NC]
RewriteRule ^create_account$ /index.php?language=English&section=CreateAcc 
```

然后西班牙语重写：

```
RewriteCond %{HTTP_HOST} ^es.mysite.com$ [NC]
RewriteRule ^$ /index.php?language=English&section=Feed

RewriteCond %{HTTP_HOST} ^es.mysite.com$ [NC]
RewriteRule ^comprar$ /index.php?language=English&section=Store

RewriteCond %{HTTP_HOST} ^es.mysite.com$ [NC]
RewriteRule ^crear_cuenta$ /index.php?language=English&section=CreateAcc 
```*

# java - Java XML 节点长度

> ID：11623864
> 
> 赞同：0
> 
> 时间：2012-07-24T03:48:32.603
> 
> 标签：java, xml

我真的对 XML DOM 树结构感到困惑。

例如我有这段 XML

```
<?xml version="1.0" encoding="UTF-8"?>
<Container>
    <Group>             
    </Group>
    <Group2>                
    </Group2>
</Container> 
```

Container 节点不应该只包含 2 个子节点吗？组和组2？

```
File fXmlFile = new File("Test2.xml");
DocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();
DocumentBuilder dBuilder = dbFactory.newDocumentBuilder();
Document doc = dBuilder.parse(fXmlFile);
doc.getDocumentElement().normalize();
Node firstNode = doc.getDocumentElement();
if (firstNode.getNodeName().toString().equals("Container")) {
    // Process container here
    Container container = new Container(); 
    System.out.println(firstNode.getChildNodes().getLength()); // why print out 5?

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:53:40.827

因为中间有 TEXT 类型的节点。它们是隐式节点。

```
<?xml version="1.0" encoding="UTF-8"?>
<Container>
    <!-- TEXT -->
    <Group>             
    </Group>
    <!-- TEXT -->
    <Group2>                
    </Group2>
    <!-- TEXT -->
</Container> 
```

您的节点 Group 和 Group2 属于 ELEMENT 类型。大多数情况下，遵循 XML 会给你计数 2，

```
<?xml version="1.0" encoding="UTF-8"?>
<Container><Group></Group><Group2></Group2></Container> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T03:54:09.640

您始终必须准备好在文档中的任何位置查找文本节点（在这种情况下，只包含空格）。一些解析器会丢弃空格；其他解析器将保留它，并创建这些节点。您必须检查所有节点的类型。

# r - R中更快的模或相等检查（或矢量化的好方法）

> ID：11623865
> 
> 赞同：3
> 
> 时间：2012-07-24T03:48:45.013
> 
> 标签：r

我一直在通过 Project Euler 尝试编写计算效率高的程序。考虑问题 1：[http](http://projecteuler.net/problem=1) ://projecteuler.net/problem=1 。我已将范围从 1000 提高到 10,000,000 以突出效率低下。

这是我的解决方案：

```
system.time({
    x <- 1:1E7
    a <- sum(as.numeric(x[x%%3 ==0 | x%%5==0]))
})
 user  system elapsed 
0.980   0.041   1.011 
```

这是一个朋友编写的一些 C++ 代码来做同样的事情。

```
#include <iostream>
using namespace std;

int main(int argc, char** argv)
{
 long x = 0;
 for (int i = 1; i < 10000000; i++)
 {
   if (i % 3 == 0)
     x += i;
   else if (i % 5 == 0)
     x += i;
 }
 cout << x;
 return 0;
}
cbaden$ time ./a.out
23333331666668
real    0m0.044s
user    0m0.042s
sys     0m0.001s 
```

我知道 C++ 应该比 R 更快，但这*要*快得多吗？Rprof 表明我将近 60% 的时间花在模运算符上，13% 的时间花在 "==" 操作上。有没有更快的矢量化方法？

第二个问题是我将耗尽内存——随着范围变大，这种方法的可扩展性不是很高。有没有一种很好的方法可以保持矢量化，但又不尝试将子集保留在内存中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T04:18:03.477

`integer`对s 而不是s进行模运算时，取模更快`numeric`：

```
f1 <- function() {
   x <- 1:1E7
   a <- sum(as.numeric(x[x%%3 ==0 | x%%5==0]))
}

f2 <- function() {
   x <- 1:1E7
   a <- sum(as.numeric(x[x %% 3L == 0L | x %% 5L == 0L]))
}

library(rbenchmark)
benchmark(f1(), f2(), replications = 5)
#   test replications elapsed relative user.self sys.self user.child sys.child
# 1 f1()            5   14.78 4.976431     13.95     0.67         NA        NA
# 2 f2()            5    2.97 1.000000      2.37     0.50         NA        NA 
```

这距离 C++ 的性能还很远，但这是朝着正确方向迈出的一步。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-24T04:59:44.023

更快的解决方案

```
x <-1E7
a<-x%/%3
b<-x%/%5
c<-x%/%15
ans<-3*a*(a+1)/2+5*b*(b+1)/2-15*c*(c+1)/2 
```

关于模数并没有真正帮助

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-24T04:04:20.180

[在 OP 上] 略有改进

```
system.time({
  x_3 <- seq(3, 1E7, by = 3)
  x_5 <- seq(5, 1E7, by = 5)
  x_3_5 <- unique(c(x_3, x_5))
  a <- sum(as.numeric(x_3_5))}
 )
##  user  system elapsed 
##  1.53    0.13    1.66 
```

**编辑**用于`profr`分析代码并替换`seq`为`unique`内部泛型/默认方法。

```
new2 <-  function(){
  x_3 <- seq.int(3, 1E7, by = 3)
  x_5 <- seq.int(5, 1E7, by = 5)
  x_3_5 <- unique.default(c(x_3, x_5))
  a <- sum(as.numeric(x_3_5))
  }

system.time(new2())
##   user  system elapsed 
##   1.11    0.04    1.16 
```

为了比较（我的慢机器）：

```
system.time({
    x <- 1:1E7
    a <- sum(as.numeric(x[x %% 3 == 0 | x %% 5 == 0]))
})

## user  system elapsed 
## 4.47    0.18    4.64 
```

基准测试

```
orig <- function(){
  x <- 1:1E7
  a <- sum(as.numeric(x[x %% 3 == 0 | x %% 5 == 0]))
}

new <-  function(){
  x_3 <- seq(3, 1E7, by = 3)
  x_5 <- seq(5,1 E7, by = 5)
  x_3_5 <- unique(c(x_3, x_5))
  a <- sum(as.numeric(x_3_5))
}

benchmark(orig(), new(), new2(), replications = 5)
##     test replications elapsed relative 
## 2  new()            5    7.67 1.198438      
## 3 new2()            5    6.40 1.000000     
## 1 orig()            5   22.01 3.439063 
```

# c# - 在单独的线程中处理设备引发的事件

> ID：11623868
> 
> 赞同：0
> 
> 时间：2012-07-24T03:48:56.777
> 
> 标签：c#, multithreading, event-handling

我编写了一个 C# 应用程序，该应用程序与连接的 2 个设备一起工作，即。显示图像的数字显微镜和返回计数器的计数装置。这两个设备同时运行并生成指示图像和计数器值变化的事件。

显微镜产生以下事件：

```
void _ImageCaptured(object source, WebcamEventArgs e)
{
}  

And counter generates below event:
void _OnRegisterValueChanged(object sender, RegisterChangeEventArgs args)
{
} 
```

作为一个单线程应用程序，我当前的应用程序无法以相同的速度获取图像和计数器值，并且它们之间存在一些滞后。我想让这个应用程序多线程并在单独的线程中处理这两个事件。感谢任何帮助实现这一目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T03:56:02.647

因此，这意味着您要将在两个不同线程中运行的逻辑与初始化点分开 - 然后您将在不同线程中接收每个通知 - 每个通知都在一个触发事件的位置。然后，如果您需要在这些事件之间共享一些数据 - 只需对其进行同步即可。

# java - Jboss 没有从 Netbeans 开始

> ID：11623872
> 
> 赞同：2
> 
> 时间：2012-07-24T03:49:15.823
> 
> 标签：java, netbeans, jboss

我正在尝试在 netbeans 中运行 jboss v6，但它显示以下错误

```
Unable to read the logging configuration from 'file:logging.properties' (java.io.FileNotFoundException: logging.properties (The system cannot find the file specified)) 
```

如果我通过直接进入 bin/run.bat 来运行 jboss stnadalone，则不会显示错误并且它可以正常启动，但是在 netbeans 中我收到了上面提到的错误。

谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-03T21:41:55.703

我在网上的其他地方找到了这个答案：

> 转到安装 JBoss 的“bin”目录编辑“run.bat”文件
> 
> 搜索线路
> 
> `set JAVA_OPTS=-Dprogram.name=%PROGNAME% -Dlogging.configuration=file:%DIRNAME%logging.properties %JAVA_OPTS%`
> 
> 将 %DIRNAME% 更改为您安装的 JBoss.eg 的“bin”目录的绝对路径
> 
> `set JAVA_OPTS=-Dprogram.name=%PROGNAME% -Dlogging.configuration=file:"C:\Java\jboss-6.1.0-final\bin\logging.properties" %JAVA_OPTS%`
> 
> 我添加了双引号 " 以便如果您的目录名称有空格，它仍然是合法的。
> 
> 尝试再次通过 Netbeans 启动您的服务器，之后它应该可以正常工作。

编辑：[一个可能的来源](http://www.developerscrappad.com/759/java/java-ee/jboss/quick-fix-how-to-solve-unable-to-read-the-logging-configuration-on-netbeans7-with-jboss6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T10:54:58.730

您从“Program Files”复制JDK并放在C：\，然后从bin文件夹配置JBOSS的run.conf以指向JDK的新位置。例如

```
 rem set "JAVA_HOME=C:\jdk1.6.0_13" 
```

# python - sqlalchemy 类的别名？

> ID：11623880
> 
> 赞同：1
> 
> 时间：2012-07-24T03:50:46.793
> 
> 标签：python, sqlalchemy

这是我的基类

```
class Product(Base):
    __tablename__ = 'PRODUCT'
    __table_args__ = {'quote':False}

    ...
    id = Column(Integer, name='id_prod', primary_key=True)
    type = Column(String(100),name='id_typ_prod')

    __mapper_args__ = {'polymorphic_on': type} 
```

因此，我们自然有许多从该产品扩展而来的类，例如电话和电缆，它们中的每一个都映射到自己的表。

```
class Phone (Product):
    __tablename__ = 'PHONE'
    ... 
```

现在由于某些原因，现在我想创建一个“别名”类，一个在数据库中没有对应表的类。像这样的东西：

```
class VapourWare(Product):
     ... 
```

如果我做

```
class VapourWare(Product):
    __tablename__ = 'PRODUCT'
    __mapper_args__ = {'polymorphic_identity':'VapourWare'} 
```

它似乎工作。但这是正确的还是推荐的方式？我在`__tablename__ = 'PRODUCT'`这里重复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T18:20:03.387

在某种程度上，这取决于您要实现的目标，但是从您的示例看来，您要尝试做的事情在 SA Docs 中称为[单表继承。](http://docs.sqlalchemy.org/en/rel_0_7/orm/inheritance.html#single-table-inheritance)链接页面上列出的示例与您的示例非常相似，带有`Employee == Product`and `Manager == VapourWare`（在此处插入 Dilbert 笑话）。

# coldfusion - fusebox5 noxml 解析文件“app.deleterecord.cfm”已更改或不存在

> ID：11623881
> 
> 赞同：0
> 
> 时间：2012-07-24T03:50:46.880
> 
> 标签：coldfusion, fusebox

我在下面有一个代码

```
<cffunction name="DeleteRecord">
    <cfargument name="myFusebox" />
    <cfargument name="event" />

    <cfset event.xfa("ShowForm", "app.ShowForm") />
    <cfset event.xfa("AddNew", "app.AddNew") />
    <cfset event.xfa("EditRecord", "app.EditRecord") />
    <cfset event.xfa("DeleteRecord", "app.DeleteRecord") />
    <cfset event.xfa("UpdateRecord", "app.UpdateRecord") />

    <cfset DeleteForecastRecord = application.report.ForecastRecordDelete(event.getValue("id"))/>

    <cflocation url="#myFusebox.getMyself()##event.xfa('manageforecastreport')#" addtoken="false" />

</cffunction> 
```

在我下面的 cfc 文件中

```
<!--- ::::: Forecast Record Show ::::: --->
<cffunction name="ForecastRecordShow" returntype="query" access="public" output="true" hint="Add Forecast Record">
    <cfargument name="ForecastID" type="any" default="">
    <cfquery name="qryGetForcastRecord" datasource="#variables.dsn#">
        SELECT * FROM tbl_forecast  
        WHERE ForecastID = <cfqueryparam cfsqltype="cf_sql_integer" value="#trim(arguments.ForecastID)#">
    </cfquery>
    <cfreturn qryGetForcastRecord>
</cffunction> 
```

我有一个错误

> 解析的文件“app.deleterecord.cfm”已更改或不存在请求失败，出现异常“应用程序”（在组件 C:\Websites\LiquidMetalWheel.com\DiscountTire_dev\model\report.cfc 中找不到方法 ForecastRecordDelete。）方法在组件 C:\Websites\mysite.com\model\report.cfc 中找不到 ForecastRecordDelete。

请帮助我解决此错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T12:57:37.280

确保“模式”设置为 dev 而不是 prod（我认为是 prod）。当设置为 prod 时，它将假定已解析目录中的文件是正确的。当设置为 dev 时，它会“重新解析”每个请求的所有熔断器。

“模式”设置隐藏在您的保险丝盒设置中 - 检查 fbx_settings.cfm 文件。我是凭记忆做的，所以我可能对设置的*名称*有误（可能是 appsettingStyle 或类似的东西）。

# cocoa - 如何使在单独进程中运行的 UI 似乎在我的进程中？

> ID：11623884
> 
> 赞同：1
> 
> 时间：2012-07-24T03:51:06.440
> 
> 标签：cocoa

Apple Help Viewer 是我想要的一个示例：它是一个单独的进程，但没有菜单栏，没有出现在 Dock 中，并且浮动在顶部。所以它似乎在当前进程中运行。我怎样才能用 Cocoa 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T03:58:41.833

使用正确的关键字进行一些谷歌搜索，我得出了解决方案：

将以下内容添加到 Info.plist 文件中：

```
<key>LSUIElement</key>
<string>1</string> 
```

这是由[http://uselessthingies.wordpress.com/2008/05/18/an-app-without-dock-icon-and-menu-bar/提供的](http://uselessthingies.wordpress.com/2008/05/18/an-app-without-dock-icon-and-menu-bar/)

# gwt - 我在哪里可以找到 GWT 的 remoteLoggingServlet 的日志文件？

> ID：11623887
> 
> 赞同：1
> 
> 时间：2012-07-24T03:51:11.573
> 
> 标签：gwt, logging, gwt-rpc, java.util.logging

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T15:05:29.647

对于日志文件：在我将一个 logging.properties 文件放在 war\WEB-INF\classes 下之后，如果我部署 GWT 项目，它就可以在 tomcat 上运行。如果您未指定任何路径，则该位置是 tomcat\bin。在GWT devMode下还是不行，可能eclipse下devMode下的Jetty服务器工作方式不同。但是您可以启用其他处理程序以在 Eclipse 控制台上查找日志信息。到目前为止，这对我来说已经足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T04:12:03.733

你不需要：

> /your-gwt-module-name/remote_logging

并不是

> /my.app.class.name/remote_logging

在

```
<!-- remote logging -->
<servlet>
    <servlet-name>remoteLogging</servlet-name>
    <servlet-class>com.google.gwt.logging.server.RemoteLoggingServiceImpl</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>remoteLogging</servlet-name>
    <url-pattern>/your-gwt-module-name/remote_logging</url-pattern>
</servlet-mapping> 
```

# c# - 上下移动 ListViewItems

> ID：11623893
> 
> 赞同：10
> 
> 时间：2012-07-24T03:52:19.570
> 
> 标签：c#, .net, winforms

我有一个 ListView (WinForms)，我想通过单击按钮在其中上下移动项目。要移动的项目是被检查的项目。因此，如果选择了项目 2、6 和 9，当我按下向上移动的按钮时，它们将变为 1、5 和 8，并且这些位置上的项目将向下移动一个步骤。

我觉得我把这变得不必要地复杂了，如下所示。每个 ListViewItem 的第二个 SubItem 是一个数字，表示它在列表中的位置（从 1 开始）。

我将以下代码归咎于缺乏睡眠和咖啡，但如果您能找到一种更简单的方法来完成此任务，我将不胜感激。

```
private void sourceMoveUpButton_Click(object sender, EventArgs e)
    {
        List<Int32> affectedNumbers = new List<Int32>();
        bool foundNonChecked = false;

        List<KeyValuePair<int, ListViewItem>> newList = new List<KeyValuePair<int, ListViewItem>>();

        foreach (ListViewItem item in this.sourceListView.CheckedItems)
        {
            int newNum = int.Parse(item.SubItems[1].Text) - 1;

            if (newNum >= 1)
            {
                foreach (ListViewItem testItem in this.sourceListView.Items)
                {
                    if (int.Parse(testItem.SubItems[1].Text) == newNum && !testItem.Checked)
                    {
                        foundNonChecked = true;
                    }
                }

                if (foundNonChecked)
                {
                    item.SubItems[1].Text = newNum.ToString();
                    affectedNumbers.Add(newNum);
                }
            }
        }

        foreach (ListViewItem item in this.sourceListView.Items)
        {
            int num = int.Parse(item.SubItems[1].Text);

            if (affectedNumbers.Contains(num) && !item.Checked)
            {
                item.SubItems[1].Text = (num + affectedNumbers.Count).ToString();
            }

            newList.Add(new KeyValuePair<int, ListViewItem>(int.Parse(item.SubItems[1].Text), item));
            item.Remove();
        }

        newList.Sort((firstPair, secondPair) =>
            {
                return firstPair.Key.CompareTo(secondPair.Key);
            }
        );

        foreach (KeyValuePair<int, ListViewItem> pair in newList)
        {
            this.sourceListView.Items.Add(pair.Value);
        }
    } 
```

**编辑** 我已将其缩短为以下内容：

```
foreach (ListViewItem item in this.sourceListView.CheckedItems)
        {
            if (item.Index > 0)
            {
                int newIndex = item.Index - 1;
                this.sourceListView.Items.RemoveAt(item.Index);
                this.sourceListView.Items.Insert(newIndex, item);
            }
        }

        int index = 1;
        foreach (ListViewItem item in this.sourceListView.Items)
        {
            item.SubItems[1].Text = index.ToString();

            index++;
        } 
```

但是现在，如果我选择两个最上面的项目（或类似项目），当我单击向上移动的按钮时，它们将切换位置。

**第二次编辑**
一切都适用于向上运动，如下所示：

```
if (this.sourceListView.CheckedItems[0].Index != 0)
        {
            this.sourceListView.BeginUpdate();

            foreach (ListViewItem item in this.sourceListView.CheckedItems)
            {
                if (item.Index > 0)
                {
                    int newIndex = item.Index - 1;
                    this.sourceListView.Items.RemoveAt(item.Index);
                    this.sourceListView.Items.Insert(newIndex, item);
                }
            }

            this.updateListIndexText();

            this.sourceListView.EndUpdate();
        } 
```

但是对于向下运动，我似乎无法正确：

```
if (this.sourceListView.CheckedItems[this.sourceListView.CheckedItems.Count - 1].Index < this.sourceListView.Items.Count - 1)
        {
            this.sourceListView.BeginUpdate();

            foreach (ListViewItem item in this.sourceListView.CheckedItems)
            {
                if (item.Index < this.sourceListView.Items.Count - 1)
                {
                    int newIndex = item.Index + 1;
                    this.sourceListView.Items.RemoveAt(item.Index);
                    this.sourceListView.Items.Insert(newIndex, item);
                }
            }

            this.updateListIndexText();

            this.sourceListView.EndUpdate();
        } 
```

它适用于向下移动单个项目，但是当我选择多个时，它不会。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-24T04:05:49.430

尝试这样的事情：

```
foreach (ListViewItem lvi in sourceListView.SelectedItems)
{
    if (lvi.Index > 0)
    {
        int index = lvi.Index - 1;
        sourceListView.Items.RemoveAt(lvi.Index);
        sourceListView.Items.Insert(index, lvi);
    }
} 
```

基本上只是删除该项目，然后将其插入到它曾经所在的位置之上。ListView 会在插入后自动处理按顺序重新排列项目，因此不用担心。

**编辑：** 两个最上面的项目交换的原因是最上面的项目永远不会移动（即我没有实现`wrap-around`移动。但是，第二个项目可以自由移动，因此进入列表的顶部。

要解决此问题，您可以执行以下两项操作中的一项：

> 1.  实施环绕式重新洗牌（即顶部项目到底部）
> 2.  如果选择了顶部项目，则防止任何移动（检查 listview.Items[0].Selected）

至于文字的重做，就在原来的循环里做。

环绕式实现：

```
foreach (ListViewItem lvi in sourceListView.SelectedItems)
{
    int index = lvi.Index > 0 ? lvi.Index - 1 : sourceListView.Items.Count - 1;
    sourceListView.Items.RemoveAt(lvi.Index);
    sourceListView.Items.Insert(index, lvi);

    if (index != sourceListView.Items.Count - 1) //not a wraparound:
    {
        //just swap the indices over.
        sourceListView.Items[index + 1].SubItems[1].Text = (index + 1).ToString();
        lvi.SubItems[1].Text = index.ToString();
    }
    else //item wrapped around, have to manually update all items.
    {
        foreach (ListViewItem lvi2 in sourceListView.Items)
            lvi2.SubItems[1].Text = lvi2.Index.ToString();
    }
} 
```

### 编辑2：

静态助手实现，没有环绕：

```
private enum MoveDirection { Up = -1, Down = 1 };

private static void MoveListViewItems(ListView sender, MoveDirection direction)
{
    int dir = (int)direction;
    int opp = dir * -1;

    bool valid = sender.SelectedItems.Count > 0 &&
                    ((direction == MoveDirection.Down && (sender.SelectedItems[sender.SelectedItems.Count - 1].Index < sender.Items.Count - 1))
                || (direction == MoveDirection.Up && (sender.SelectedItems[0].Index > 0)));

    if (valid)
    {
        foreach (ListViewItem item in sender.SelectedItems)
        {
            int index = item.Index + dir;
            sender.Items.RemoveAt(item.Index);
            sender.Items.Insert(index, item);

            sender.Items[index + opp].SubItems[1].Text = (index + opp).ToString();
            item.SubItems[1].Text = (index).ToString();
        }
    }
} 
```

例子：

```
MoveListViewItems(sourceListView, MoveDirection.Up);
MoveListviewItems(sourceListview, MoveDirection.Down); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-03T10:27:40.150

只是为了完成@Jason Larkes 的答案以使其正确支持“下移”，在他提供的 MoveListViewItems 函数中的 foreach 之前添加这个：

```
ListViewItem[] itemsToBeMoved = sender.SelectedItems.Cast<ListViewItem>().ToArray<ListViewItem>(); 
IEnumerable<ListViewItem> itemsToBeMovedEnum;
if (direction == MoveDirection.Down)
     itemsToBeMovedEnum = itemsToBeMoved.Reverse();
else
     itemsToBeMovedEnum = itemsToBeMoved; 
```

然后迭代使用：

```
foreach (ListViewItem item in itemsTobemovedEnum) 
```

而不是原来的foreach。

奇迹般有效。@EClaesson - 我希望这能解决你在评论中写的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-30T19:39:57.003

这个是包装的，所以如果你将索引 0 处的项目向下移动，它将到达最后一个位置，如果你将最后一个项目向上移动，它将在列表中排在第一位：

```
 public static class ListExtensions
    {
        public static void MoveUp<T>(this IList<T> list, int index)
        {
            int newPosition = ((index > 0) ? index - 1 : list.Count - 1);
            var old = list[newPosition];
            list[newPosition] = list[index];
            list[index] = old;
        }

        public static void MoveDown<T>(this IList<T> list, int index)
        {
            int newPosition = ((index + 1 < list.Count) ? index + 1 : 0);
            var old = list[newPosition];
            list[newPosition] = list[index];
            list[index] = old;
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-30T01:55:56.843

环绕代码：

```
 private enum MoveDirection { Up = -1, Down = 1 };

    private void MoveListViewItems(ListView sourceListView, MoveDirection direction)
    {
        int dir = (int)direction;

        foreach (ListViewItem lvi in sourceListView.SelectedItems)
        {
            int index = lvi.Index + dir;
            if(index >= sourceListView.Items.Count)
                index = 0;
            else if(index < 0)
                index = sourceListView.Items.Count + dir;

            sourceListView.Items.RemoveAt(lvi.Index);
            sourceListView.Items.Insert(index, lvi);
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-07T04:03:32.120

```
 private void MoveItems(ListView sender, MoveDirection direction)
    {
        bool valid = sender.SelectedItems.Count > 0 &&
                    ((direction == MoveDirection.Down && (sender.SelectedItems[sender.SelectedItems.Count - 1].Index < sender.Items.Count - 1))
                    || (direction == MoveDirection.Up && (sender.SelectedItems[0].Index > 0)));

        if (valid)
        {                
            bool start = true;
            int first_idx = 0;                
            List<ListViewItem> items = new List<ListViewItem>();

            // ambil data
            foreach (ListViewItem i in sender.SelectedItems)
            {
                if (start)
                {
                    first_idx = i.Index;
                    start = false;
                }
                items.Add(i);
            }

            sender.BeginUpdate();

            // hapus
            foreach (ListViewItem i in sender.SelectedItems) i.Remove();

            // insert
            if (direction == MoveDirection.Up)
            {
                int insert_to = first_idx - 1;
                foreach (ListViewItem i in items)
                {
                    sender.Items.Insert(insert_to, i);
                    insert_to++;
                }                    
            }
            else
            {
                int insert_to = first_idx + 1;
                foreach (ListViewItem i in items)
                {
                    sender.Items.Insert(insert_to, i);
                    insert_to++;
                }   
            }                
            sender.EndUpdate();
        }            
    } 
```

> 你的答案不太好用。在这里我的代码工作完美......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-21T11:35:30.287

仅用于完整的，基于 'Jason Larke' 静态辅助解决方案：

该解决方案不会移动相邻的项目，这可以使用 Stack 来完成，因此：

```
private enum MoveDirection { Up = -1, Down = 1 };

private static void MoveListViewItems(ListView sender, MoveDirection direction)
{
int dir = (int)direction;
int opp = dir * -1;

bool valid = sender.SelectedItems.Count > 0 &&
                ((direction == MoveDirection.Down && (sender.SelectedItems[sender.SelectedItems.Count - 1].Index < sender.Items.Count - 1))
            || (direction == MoveDirection.Up && (sender.SelectedItems[0].Index > 0)));

if (valid)
{

Stack aPila = new Stack();
ListViewItem item = default(ListViewItem);
foreach ( item in sender.SelectedItems) {
    aPila.Push(item);
}

for (int iaux = 1; iaux <= aPila.Count; iaux++) {
    {
    item  = (ListViewItem)aPila.Pop();
        int index = item.Index + dir;
        sender.Items.RemoveAt(item.Index);
        sender.Items.Insert(index, item);

        sender.Items[index + opp].SubItems[1].Text = (index + opp).ToString();
        item.SubItems[1].Text = (index).ToString();
    }
}
} 
```

# c++ - opencv中的内存泄漏处理cv::Mat数组

> ID：11623898
> 
> 赞同：1
> 
> 时间：2012-07-24T03:52:48.693
> 
> 标签：c++, opencv

我试图在视频帧上绘制 10 * 10 矩阵，这是绘图功能：

```
void AddMatrixToVideo::process(cv::Mat &videoFrameInput)
{
    int MatrixStartPointX = 0;
    int MatrixStartPointY = 0;
    int m,n;

    for(int i = 0; i < matrixNumInRow; ++i) {
        for(int j = 0; j < matrixNumInColm; ++j) {
            //draw horizontal line
            for(m = MatrixStartPointX; m < MatrixStartPointX + matrixWidth; ++m) {
                    processGrayFrame(m,MatrixStartPointY,videoFrameInput);
                    processGrayFrame(m,MatrixStartPointY + matrixHeight,videoFrameInput);
            }
            //draw vertical line
            for(n = MatrixStartPointY; n < MatrixStartPointY + matrixHeight; ++n) {
//                    processGrayFrame(MatrixStartPointX,n,videoFrameInput);
//                    processGrayFrame(MatrixStartPointX + matrixWidth,n,videoFrameInput);
            }
            MatrixStartPointX += matrixWidth;
        }
        MatrixStartPointX = 0;
        MatrixStartPointY += matrixHeight;
    }
} 
```

这是 processGrayFrame()：

```
void AddMatrixToVideo::processGrayFrame(int x,int y,cv::Mat &videoFrameInput)
{
    videoFrameInput.at<uchar>(y,x) = 255;
} 
```

运行程序后，似乎绘图进度正常，内存使用量不断增加，最终耗尽内存。如果我评论 processGrameFrame() 函数，内存问题就会出现（当然它不会再画线了）。所以我的问题是为什么分配操作会导致内存泄漏问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:36:26.923

你`processGrayFrame`是对的，这就是你应该如何使用它。我认为的问题是您没有传入`x`并且`y`值在界限内。您的电话`processGrayFrame`不要通过界内点。至少`MatrixStartPointY + matrixHeight`肯定是越界了。

还要确保您正确分配矩阵（`uchar`分配时元素类型是 - 我认为`CV_8UC1`至少如果您有 8-bit `char`s）。

在调试模式下运行 OpenCV，它应该会告诉您坐标何时超出范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T06:29:07.140

使用 C++ 接口时很难发生内存泄漏。实际上，您必须是专家才能做到这一点:)

它要么是一个误报，在 Windows 系统上经常发生（参见[opencv 函数中的内存泄漏](https://stackoverflow.com/questions/7949452/memory-leak-in-opencv-functions/7950788#7950788)）要么是程序其他部分的泄漏。

为确保它不是泄漏，您应该使用检漏仪对其进行分析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T14:13:33.823

使用`assert(0<=x&&x<m.cols&&0<=y&&y<m.rows)`宏检查边界条件。（如果您设置了 DEBUG 标志或您使用 IDE 处于调试模式，则检查仅出现在实际代码中。）

* * *

如果您不克隆视频帧，也可能存在潜在泄漏。

视频帧 cv::Mat （您可能来自`cv::VideoCapture cap(0); cap>>frame;`）必须被克隆出来。否则，根据我的经验，您会不时出现泄漏，而不是在每一帧中。（我认为只有当缓冲区的位置发生变化时。）

所以解决方案是`cap>>frame_raw; Mat frame = frame_raw.clone();`（我认为你实际上打电话`frame` `videoFrameInput`）。

备注：
我知道这不是重点，但您更愿意熟悉[opencv 绘图功能](http://opencv.willowgarage.com/documentation/cpp/core_drawing_functions.html)（如果还没有这样做的话）。
有`cv::line(mat, p1, p2, color,...)`、和for 填充`cv::rectangle(...)`，仅举几例。这些方式效率更高，因为它们具有更有效的内存访问（不使用并且还可以优化和并行化访问顺序）。`cv::ellipse(...)``cv::floodFill(...)``.at<>()`

# c++ - C++ 预处理器可以判断一个标记是否是一个字符串吗？

> ID：11623899
> 
> 赞同：5
> 
> 时间：2012-07-24T03:52:56.337
> 
> 标签：c++, macros, c-preprocessor

预处理器宏是否可以确定其参数是否为字符串（文字）？

例如：

```
#define IS_STRING(token) ???

IS_STRING("foo")  // expands to 1
IS_STRING(foo)    // expands to 0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T04:01:44.033

是的。但输出略有不同：

```
#define IS_STRING(token) "" token 
```

字符串文字会很好。对于非字符串，它会给出编译器错误。

**逻辑**：编译器会自动连接字符串文字，所以`"" token`如果`token`是字符串文字就可以了。

[这是一个相关的讨论](https://stackoverflow.com/questions/5819217/verify-type-of-string-e-g-literal-array-pointer-passed-to-a-function)。

# excel - SQLite for Excel 支持 64 位 Excel

> ID：11623907
> 
> 赞同：0
> 
> 时间：2012-07-24T03:53:56.633
> 
> 标签：excel, sqlite, vba, 64-bit

我需要将数据 SQLite 读入 Excel。我在（[#1](https://stackoverflow.com/questions/1346979/how-do-i-access-sqlite-from-vba)，[#2](https://stackoverflow.com/questions/1630035/whats-the-best-way-to-access-an-sqlite-database-in-microsoft-excel)）找到了一些解决方案。我选择`SQLite for Excel`@Govert。我的 excel 是 64 位版本，所以我已经下载并用 sqlite3.dll(64bit) 替换了 sqlite3.dll(32bit) 然后更新 VBA 声明：

`...Declare Function...`改成`...Declare PtrSafe Function...`

但我仍然无法在`SQLiteForExcel.xls`. 和错误输出`VBE Immediate Window`：

> SQLite3Initialize 加载 C:\Users\davuz\Downloads\SQLiteForExcel-0.7\Distribution\SQLite3_StdCall.dll 时出错：193 初始化 SQLite 时出错。错误：193

如何修复 sqliteforexcel 以使用 Excel 64 位运行？感谢帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T12:26:59.417

我（[Excel 的 SQLite](http://sqliteforexcel.codeplex.com)人）实际上还没有尝试弄清楚 64 位 VBA 声明 - 我只是注意到现在有一​​个预编译的 64 位 SQLite 库，这对我们有很大帮助。

首先要注意的是，对于 64 位情况，您根本不需要 SQLite3_StdCall.dll 中间体。仅在调用约定需要重新映射的 32 位情况下才需要。因此对于 64 位，VBA 文件中的所有 .dll 引用必须直接引用 SQLite3.dll。

接下来，我认为您在 PtrSafe 更改方面走在了正确的轨道上。但我不确定 VBA 64 位指针声明是如何工作的。人们还必须弄清楚哪些“长”参数实际上是指针。

所以还有一点事情要做...

**编辑：**

**完毕。SQLite for Excel 的更新版本 0.8 现在包括 64 位 Excel 的 VBA 声明、更新的测试和 64 位 SQLite3.dll 的副本。**

# objective-c - If 和 Else if 语句

> ID：11623909
> 
> 赞同：0
> 
> 时间：2012-07-24T03:54:17.643
> 
> 标签：objective-c, ios, calculator, if-statement

我想知道为什么这段代码不起作用。它适用于计算器 :) 我需要计算器识别符号（香蕉），并根据用户输入的内容使用 +,-。

```
NSString *list = [Sum_TextField text]; 
NSArray *listItemsArray = [list componentsSeparatedByString:@" "];
int batman = [[listItemsArray objectAtIndex: 0] intValue]; 
NSString *banana = [listItemsArray objectAtIndex: 1];
int joker = [[listItemsArray objectAtIndex: 2] intValue];
{

    Calculator* calc = [[Calculator alloc] init];
    [calc setNum1:batman];
    [calc setNum2:joker];
    if ((banana = @"-"))
    {
        [calc minus];
    }
    else if ((banana = @"+"))
    {
        [calc add];
    } 

    [Answer_TextField setText:[NSString stringWithFormat:@"%d", [calc answer]]];  
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:00:26.537

要判断 NSString 是否相等，必须使用`[@"AAAA" isEqualToString : @"BBBB"]`. 你不能使用`==`，因为它们不在同一个地址的内存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T03:56:49.623

以下是您想要执行此操作的方法：

```
 if ([banana isEqualToString:@"-"])
 {
     [calc minus];
 }
 else if ([banana isEqualToString:@"+"])
 {
     [calc add];
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T04:03:31.713

`=`是赋值。这与比较完全无关。

`==`正在比较两个表达式，看看它们是否相等。这可用于比较整数类型（例如`enum`, `char`, `int`, `short`, `long`, `long long`, `BOOL`）或引用（检查 2 个指针是否指向同一个对象）。请注意，2 个指针可以指向 2 个不同的对象，其中包含相同的值，但`==`会将它们比较为不同。（浮点类型，例如`float`和`double`需要稍微不同的方法来比较相等性）。

`=`作为一种避免和之间混淆的方法`==`，对于与 的相等性测试`==`，有些人将值放在左侧，将变量放在右侧（例如`2 == variable`）。如果他们碰巧输错`==`了`=`，编译器会抱怨。

如果要比较 2 个对象的内容，在这种情况下是`NSString`，您应该搜索`isEquals`函数类型。对于，如果要比较两个字符串是否具有相同的内容`NSString`，则应使用。`isEqualToString`

# google-maps - Google Places API：地点详情限制为 5 条评论

> ID：11623912
> 
> 赞同：7
> 
> 时间：2012-07-24T03:55:23.290
> 
> 标签：google-maps, google-places-api

[https://developers.google.com/places/documentation/#PlaceDetails](https://developers.google.com/places/documentation/#PlaceDetails)

“评论”输出列表显然仅限于前 5 条评论。文档中根本没有提到这一点。有没有办法获得分页结果或超过 5 个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-24T04:24:53.257

[这在此处](https://developers.google.com/maps/documentation/places/web-service/details?hl=en#Place)的文档中明确说明，在`reviews[]`字段说明下：

> reviews[] 一个 JSON 数组，最多包含五个评论。

目前无法检索超过 5 条评论。如果您认为这将是一个有价值的功能，您可以在`Places API - Feature Request` [此处](http://code.google.com/p/gmaps-api-issues/issues/entry?template=Places%20API%20-%20Feature%20Request)提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-08-19T22:05:39.563

您现在实际上可以获得所有评论，您需要做的就是使用 Google 的 My Business API。特别是[`batchGetReviews`](https://developers.google.com/my-business/reference/rest/v4/accounts.locations/batchGetReviews)通话。

您还有更多工作要做，但它满足排序/过滤评论的所有要求。

[谷歌我的商家 API](https://developers.google.com/my-business/)

# java - 两个小结构的性能差异

> ID：11623917
> 
> 赞同：0
> 
> 时间：2012-07-24T03:55:51.043
> 
> 标签：java, performance, if-statement, conditional-statements

我想知道以下两者之间是否有任何性能差异？

```
if(i>=0){
    //some code here
}

//and

if(i>-1){
    //some code here
} 
```

那么下面两个呢？

```
if(i>=0){
    //some code here
}

//and

if(i>0 || i==0){
    //some code here
} 
```

是否`>=` 会在内部转换为`> || ==`?

PS 性能差异会很小，可以忽略不计，但我想知道是否有任何性能差异？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:20:48.220

在现代 JVM 上，我认为这种想法毫无意义。JVM 不只是编译代码并停止。它在运行时**了解**您的代码并相应地修改其行为。现在我不是编译器专家，但据我了解，JVM 可以非常聪明，`if`如果它看到`i`始终评估为真或假的价值，它基本上可以在运行时优化你的整个语句。

每当您想以这样的微观方式“优化”您的代码时，请停下来提醒自己，您不如 JVM 聪明，因为它会作弊。它可以实际查看您的代码在运行时所做的事情并相应地更改其行为。

查看 Steve Yegge 的演讲中出色的成绩单，它暗示了 VM 可以有多么令人印象深刻。这是几年前的事了！

[http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html](http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html)

**添加了更好的示例**

这些是 Josh Bloch 的演讲中的幻灯片，他谈到现在微基准测试是不可能的。您无法查看源代码行并知道 JVM 在运行时会做什么。我最喜欢的幻灯片是短路操作员`&&`过去总是更快，但在现代硬件上，这不再总是正确的了。完全违反直觉，这意味着您应该停止尝试走这条路。

[http://wiki.jvmlangsummit.com/images/1/1d/PerformanceAnxiety2010.pdf](http://wiki.jvmlangsummit.com/images/1/1d/PerformanceAnxiety2010.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T04:08:34.877

答案将取决于平台；即它将取决于您的Java 安装中的硬件平台、ISA 和JIT 编译器。

这使得知道答案变得毫无意义......因为您不想浪费时间为特定的硬件/ISA/JIT编译器平台进行微优化。

但是，如果您确实需要知道，那么您应该对其进行基准测试……注意做所有您需要做的事情，以便从 Java 基准测试中获得有效的结果。

* * *

FWIW - 我认为现代 JIT 编译器将在所有两种情况下为子案例生成等效的本机代码；即它应该对您使用的性能没有影响。但这`i>0 || i==0`是毫无意义的混淆，因此应该避免。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:54:53.343

它依赖于实现，因此如果您真的关心，您需要针对您的特定平台进行基准测试。

话说回来：

*   前两个在任何合理的现代硬件/JVM 组合上*可能是等效的。*所有比较往往在现代硬件上执行相同。
*   对于后两个，第一个选项*可能*更快。虽然一个聪明的编译器会发现等价性并产生相同的单一本地操作，但我相信一些当前的 JIT 编译器不会发现这一点。但是无论如何您都应该使用第一个选项，因为它更易于阅读和维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T04:01:48.203

您可以使用 来检查相应的汇编代码`objdump`，或检查在运行时实际退出的指令数。但是，对于流水线，所需的实际周期可能并不那么清楚。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-24T03:58:57.857

我相信第一种方法更好。

第二个需要3个比较：

1.  `if (i > 0)`
2.  `if (i == 0)`
3.  1\. 和 2 的布尔 OR。

但是，实际结果仍然取决于编译器是否能够将 2 个代码优化为相同（因为它们正在做同样的事情）。

也许基准是一个更好的主意。

# sql-server - SQL 存储过程 - 固定列数据

> ID：11623920
> 
> 赞同：0
> 
> 时间：2012-07-24T03:56:43.260
> 
> 标签：sql-server, sql-server-2008, stored-procedures

先生，我在 SQL 中有一个包含以下数据的表。

```
 ID    Date       Rly   Equipment     Type     
  1  3-Apr-12      SR     SIV       R
  2  3-Apr-12      SER    TM        I
  3  3-Apr-12      NR     3PH       I
  4  3-Apr-12      NCR    3PH       R
  5  3-Apr-12      WR     ARNO      I
  6  3-Apr-12      WR      EMC      I
  7  3-Apr-12      SR      EMC      R
  8  3-Apr-12      SR     Pn. Pipeline   I 
```

我正在使用 SQL 中的数据透视语句来计算 Rlys 中的设备，如下所示

```
 Equipment         SER   NR   NCR  WR   SR    TTL 
  SIV                                    1     1
  TM                1                          1
  3PH                     1    1               2
  EMC                               1    1     2
  ARNO                              1          1
  Pn. Pipeline                           1     1 
```

使用这个我面临一个问题，只要设备没有出现在数据表中，就不会出现在数据透视语句中。但我的要求是每个设备都将出现在主数据表中是否可用的数据透视表中，以便始终固定表行。请帮助修复左侧栏中的设备名称。例如 SIV、TFP 和轴承不在主数据表中，但在最终结果中是必需的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T05:10:51.257

鉴于您必须知道其他表中存在哪些设备，请创建从设备左连接到数据的枢轴

即：如果您的查询当前看起来像

```
select equipment, ser, nr, ncr, wr, sr
from 
(select rly, equipment from #data ) as source
pivot
(count(rly) for rly in ([ser], [nr], [ncr], [wr], [sr])) as p 
```

并且您的设备表是#eq，然后将您的查询更改为

```
select eqcode, ser, nr, ncr, wr, sr
from
(select rly, eqcode from #eq left join #data on #eq.eqcode=#data.equipment) as source
pivot
(count(rly) for rly in ([ser], [nr], [ncr], [wr], [sr])) as p 
```

# c# - C# 中的进度条和后台工作者

> ID：11623923
> 
> 赞同：1
> 
> 时间：2012-07-24T03:56:50.367
> 
> 标签：c#, multithreading, progress-bar, backgroundworker

目前我正在做一个需要从Web服务中消耗大量数据的项目，有服务类将输入日期发送到服务器并返回结果，由于它的耗时过程，需要用户结合进度条和后台工作者向用户显示进程百分比。我浏览了很多关于这个主题的示例代码，但仍然无法找到最好的方法。请您帮忙，我的代码如下，

```
private  MyCollection[] callWebService(string[] Inputs, string method)
{
    List<string> results = new List<string>();
    string fiel dNames = ""; // todo - fix this if nothing left in loop
    int sizeOfArray = 500;
    for (int i = 0; i < Inputs.Length; i = i + sizeOfArray)
    {
        string[] outputRecords;
        int errorCode;
        string errorString;
        string[] thisFiveHundred = createSubArray(Inputs, i, sizeOfArray);

        iq.NameValuePair[] namevaluepairs = new iq.NameValuePair[0];
        fieldNames = iqOfficeWebservice.BatchStan(method, thisFiveHundred, null, "",        out outputRecords, out errorCode, out  errorString);
        results.AddRange(outputRecords);
    }
    results.ToArray();
    IAddress[] formattedResults = convertStringsToInputs(fieldNames, results);
    return formattedResults;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-24T04:37:54.330

```
 private void cmdButton_Click(object sender, EventArgs e)
    {
        BackgroundWorker worker = new BackgroundWorker();
        worker.WorkerReportsProgress = true;
        worker.DoWork += new DoWorkEventHandler(worker_DoWork);
        worker.ProgressChanged += new ProgressChangedEventHandler(worker_ProgressChanged);
        worker.RunWorkerAsync();
    }

    private void worker_DoWork(object sender, DoWorkEventArgs e)
    {
        BackgroundWorker worker = sender as BackgroundWorker;

        for (int i = 0; i < 101; i++)
        {
            worker.ReportProgress(i);
            System.Threading.Thread.Sleep(1000);
        }
    }

    private void worker_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        lblProgress.Text = ("Progress: " + e.ProgressPercentage.ToString() + "%");
    } 
```

可以在[此处](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)找到其他信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T04:48:13.820

除了 WPF 或 Winforms 中的技术实现之外，还有一个重要方面需要考虑。

*   您是否从 Web 服务获得进度反馈？

否则，您可能无法正确预测 Web 服务所需的时间。这将取决于您无法影响的因素（如服务器负载、网络流量……）。在这种情况下，不建议使用进度条，因为它会给用户带来奇怪的体验。

然后，您可以选择显示请求可能需要几分钟的文本信息，并显示带有`IsIndeterminate`标志集 (WPF) 的进度以显示持续的进度反馈。当您使用后台线程时，不能选择沙时光标。

另一种方法是将大请求分解为可以报告进度的较小部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-24T05:24:34.313

我刚刚汇总了 Adil 答案的变体，它封装了工作和更新，以及正确分离事件和处置工人。如果您支持我的回答，请支持 Adil 的回答。

```
 private void cmdButton_Click(object sender, EventArgs e)
    {
        var worker = new BackgroundWorker();
        worker.WorkerReportsProgress = true;

        DoWorkEventHandler doWork = (dws, dwe) =>
        {
            for (int i = 0; i < 101; i++)
            {
                worker.ReportProgress(i);
                System.Threading.Thread.Sleep(100);
            }
        };

        ProgressChangedEventHandler progressChanged = (pcs, pce) =>
        {
            lblProgress.Text = String.Format("Progress: {0}%", pce.ProgressPercentage);
        };

        RunWorkerCompletedEventHandler runWorkerCompleted = null;
        runWorkerCompleted = (rwcs, rwce) =>
         {
             worker.DoWork -= doWork;
             worker.ProgressChanged -= progressChanged;
             worker.RunWorkerCompleted -= runWorkerCompleted;
             worker.Dispose();
             lblProgress.Text = "Done.";
         };

        worker.DoWork += doWork;
        worker.ProgressChanged += progressChanged;
        worker.RunWorkerCompleted += runWorkerCompleted;

        worker.RunWorkerAsync();
    } 
```

# reload - Redmine 插件 Javascript Asset 不会在开发模式下重新加载

> ID：11623924
> 
> 赞同：1
> 
> 时间：2012-07-24T03:56:52.307
> 
> 标签：reload, redmine-plugins

我正在使用以下版本的 Redmine 和 Ruby：

```
Environment:
  Redmine version                          2.0.1.devel
  Ruby version                             1.9.3 (x86_64-darwin11.2.0)
  Rails version                            3.2.3
  Environment                              development
  Database adapter                         Mysql2 
```

但是，当在开发模式本身下进行插件开发时，javascript 文件不会在每个请求上重新加载。

解决这个问题的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T15:44:10.373

如果你像下面这样包含你的javascript：
`<%= javascript_include_tag 'plugin', :plugin => 'redmine_plugin' %>`你
必须每次重新启动你的rails服务器，当对javascript或css文件进行一些更改时。

您必须这样做，因为您的插件目录中的 javascript 文件在服务器重新启动期间`plugin/assets/javascript`被复制到应用程序公共目录。`plugin_assets/redmine_plugin/javascripts/`

# php - 使用 Facebook 弹出窗口更改登录的宽度和高度

> ID：11623927
> 
> 赞同：-1
> 
> 时间：2012-07-24T03:57:14.610
> 
> 标签：php, html, css, facebook

如何使用 Facebook 弹出窗口更改登录的宽度和高度？默认情况下，它显示一个 450x260 像素的弹出窗口，因此我们看不到登录表单（附加捕获）。如何更改弹出窗口的大小？

默认弹出窗口大小，此处看不到登录表单： ![默认弹出窗口大小，此处看不到登录表单](../Images/df8ce4a3ee2d73c92b940d786a40fc56.png)

我们需要调整它的大小，以便我们可以看到登录表单： ![我们需要调整它的大小，以便我们可以看到登录表单](../Images/5525c4e468506a0f89c3507e0c53c566.png)

我尝试了[FB.ui 中建议的解决方案并设置弹出窗口大小](https://stackoverflow.com/questions/2948517/fb-ui-and-setting-popup-size)无济于事。任何帮助，将不胜感激。

这是我的完整代码：

```
<?php
session_start();
define('YOUR_APP_ID', 'myidhere');
define('YOUR_APP_SECRET', 'mysecrethere');

function get_facebook_cookie($app_id, $app_secret)
{ 
    $signed_request = parse_signed_request(@$_COOKIE['fbsr_' . $app_id], $app_secret);
    $signed_request['uid'] = $signed_request['user_id']; // for compatibility 
    if (!is_null($signed_request))
    {
        $access_token_response = file_get_contents("https://graph.facebook.com/oauth/access_token?client_id=$app_id&redirect_uri=&client_secret=$app_secret&code={$signed_request['code']}");
        parse_str($access_token_response);
        $signed_request['access_token'] = $access_token;
        $signed_request['expires'] = time() + $expires;
    }
    return $signed_request;
}

function parse_signed_request($signed_request, $secret)
{
  list($encoded_sig, $payload) = explode('.', $signed_request, 2); 
  $sig = base64_url_decode($encoded_sig);
  $data = json_decode(base64_url_decode($payload), true);

  if (strtoupper($data['algorithm']) !== 'HMAC-SHA256') {
    error_log('Unknown algorithm. Expected HMAC-SHA256');
    return null;
  }

  $expected_sig = hash_hmac('sha256', $payload, $secret, $raw = true);
  if ($sig !== $expected_sig) {
    error_log('Bad Signed JSON signature!');
    return null;
  }

  return $data;
}

function base64_url_decode($input)
{
  return base64_decode(strtr($input, '-_', '+/'));
}

if (isset($_COOKIE['fbsr_' . YOUR_APP_ID]))
{ 
    $cookie = get_facebook_cookie(YOUR_APP_ID, YOUR_APP_SECRET);
    $user = json_decode(@file_get_contents('https://graph.facebook.com/me?access_token=' .$cookie['access_token']));
}
?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Facebook Login Connect for Website Demo</title>
</head>
<body>

<?php
if (@$cookie)
{
    ?>
    <h2>You Are Logged In <?= $user->name ?> </h2> <br />
    E-mail ID: <?= $user->email ?>
    <br />
    <a href="javascript://" onclick="FB.logout(function() { window.location='sandbox/facebook_login' }); return false;" >Logout</a>
    <?php
}
else
{
    ?>
    <h2>Welcome Guest! </h2>    
    <div id="fb-root"></div>
    <fb:login-button perms="email" width="width_value" show_faces="true" autologoutlink="true" size="large">Login with Facebook</fb:login-button>
    <?php
} ?>

<script src="http://connect.facebook.net/en_US/all.js"></script>   
<script>
 // Initiate FB Object
 FB.init({
   appId: '<?= YOUR_APP_ID ?>', 
   status: true,
   cookie: true, 
   xfbml: true
   });
 // Reloading after successfull login
 FB.Event.subscribe('auth.login', function(response) { 
    window.location.reload(); 
 });
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T13:46:32.980

Mozilla Firefox 出现问题，导致 autoGrow 无法正常工作。当我升级到 Mozilla Firefox 16.0.2 时，问题会自动解决。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-24T05:17:20.370

尝试使用 jquery 操作 dom 的 height 属性

```
$('[whatever dom element]').attr([modify attributes]); 
```

# sql - 索引/主键序数的 SQL 查询

> ID：11623928
> 
> 赞同：3
> 
> 时间：2012-07-24T03:57:14.957
> 
> 标签：sql, postgresql, ordinal

在我们的在线竞赛系统中，有一个经常变化`standings`的整数列表格`(user_id, score)`。两者都使用唯一约束进行索引。需要两种查询：

1.  给定一个`score`不在表中的值，返回从 1 开始的位置，如果它被插入，分数将占据的位置。
2.  给定`user_id`表中的a，返回对应分数的位置。

在这两种情况下，位置都是相对于分数升序的：比表中当前所有分数小的新分数将具有位置 1。

这是困难的部分：我们可能负担不起表扫描。该表可能有多达 1000 万条记录，我们需要每秒处理至少 40 个查询。

如何在 PostgreSQL 中做到这一点？

我在 Berkeley DB 中有一个非 SQL 解决方案，它使用了支持逻辑记录号的 B 树。它很容易具有足够好的性能。但是我们想通过使用 PostgreSQL 查询重新实现来摆脱 BDB。我已经尝试了明显的

```
select 1+count(*) from standings where score < ? limit 1; 
```

这会导致表扫描。

我希望答案是“不可能”，因为 BDB 的逻辑记录编号功能需要为每次编辑锁定整个 B 树。为了获得 O(log N) 的性能，它依赖于每个节点中的叶子数。root 路径中的所有这些计数都必须随着每次编辑而改变；因此，锁定。这种锁定违反了 PostgreSQL 的设计原则，并且可能违反了任何多用户数据库。

因此，如果问题不能用 PostgreSQL 解决，那么确认这一点是这个问题的下一个最佳结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:59:12.187

**使用常规表，您在 PostgreSQL 9.1`count()`**中无能为力。**导致表扫描**，因为索引没有可见性信息。为了验证这些行在此期间没有被删除，PostgreSQL 必须访问该表。

如果表是只读的（或很少更新），您*可以*向表中添加行号。然后是这样的查询：

```
SELECT rownumber+1
FROM   standings
WHERE  score < ?
ORDER  BY score DESC
LIMIT  1; 
```

有一个索引：

```
CREATE INDEX standings_score_idx ON standings (score DESC); 
```

几乎可以立即得到结果。但是，出于显而易见的原因，这**不是具有写入负载的表的选项。**所以不适合你。

* * *

**好消息：即将推出的PostgreSQL 9.2**的主要新特性之一正适合您：“**覆盖索引**”或“**仅索引扫描**”。[我在这里](http://www.postgresql.org/docs/9.2/interactive/release-9-2.html#AEN110235)引用 9.2 发行说明：

> 允许查询仅从索引中检索数据，避免堆访问（Robert Haas、Ibrar Ahmed、Heikki Linnakangas、Tom Lane）
> 
> 这通常称为“仅索引扫描”或“覆盖索引”。正如可见性映射所报告的，这对于具有完全可见元组的堆页面是可能的。作为实现此功能的必要部分，可见性地图是防撞的。

[Robert Haas 的这篇博客文章](http://rhaas.blogspot.co.at/2011/10/fast-counting.html)详细介绍了这如何影响**计数性能**。`WHERE`即使有一个子句，它也有助于提高性能，就像你的情况一样。

# javascript - 关于原型和prototypejs

> ID：11623929
> 
> 赞同：4
> 
> 时间：2012-07-24T03:57:15.717
> 
> 标签：javascript, object, prototypejs

我想了解这个原型。

你们中的任何人都可以澄清一下使用的原型有什么区别吗？

[https://developer.mozilla.org/en/Introduction_to_Object-Oriented_JavaScript](https://developer.mozilla.org/en/Introduction_to_Object-Oriented_JavaScript)链接和 [http://www.prototypejs.org/learn/class-inheritance](http://www.prototypejs.org/learn/class-inheritance)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:17:45.697

没有区别。Prototype JS 只是一个让使用 JavaScript 变得更容易的框架。两种情况下的`prototype`属性都属于用作构造函数的函数，即简单的 JavaScript。

如果您想进一步了解 JavaScript 中的继承，请阅读以下[答案](https://stackoverflow.com/a/8096017/783743 "JavaScript继承和构造函数属性 - 代码日志")。我个人不喜欢使用任何框架。我使用的唯一框架是[Vapor.js](http://vaporjs.com/ "Vapor.js |  世界上最小和最快的 JavaScript 库")。但是，在使用类时，我通常会使用以下[要点](https://gist.github.com/3091759 "JavaScript 中的经典 OOP — 要点")：

```
var Class = function () {
    var slice = Array.prototype.slice;
    var bind = Function.prototype.bind;

    var prototype = Class.prototype = new Function;
    return prototype.constructor = Class;

    function Class(definition, base) {
        var klass = function () {
            var instance = this;

            if (base instanceof Class)

            var uber = function () {
                if (uber instanceof base) return uber;

                arguments = slice.call(arguments);
                arguments = [null].concat(arguments);
                uber = bind.apply(base, arguments);
                uber = new uber;

                var hyper = instance.__proto__ = uber;
                var proto = hyper.__proto__;

                while (proto != parent) {
                    hyper = proto;
                    proto = hyper.__proto__;
                }

                hyper.__proto__ = child;

                return uber;
            };

            var constructor = definition.call(this, uber);
            constructor.apply(this, arguments);
        };

        if (base instanceof Class) {
            klass.__proto__ = base;
            var child = klass.prototype;
            var parent = child.__proto__ = base.prototype;
        } else klass.__proto__ = prototype;

        return klass;
    }
}(); 
```

这使我可以按如下方式创建类：

```
var Rectangle = new Class(function () {
    var width;
    var height;

    function constructor(length, breadth) {
        width = length;
        height = breadth;
    }

    this.area = function () {
        return width * height;
    };

    return constructor;
}); 
```

继承很简单：

```
var Square = new Class(function (uber) {
    return function (side) {
        uber(side, side);
    };
}, Rectangle); 
```

您还可以使用基类方法，例如：

```
var Cube = new Class(function (uber) {
    var side;

    function constructor() {
        side = arguments[0];
        uber = uber(side);
    }

    this.area = function () {
        return 6 * uber.area();
    };

    this.volume = function () {
        return side * uber.area();
    };

    return constructor;
}, Square); 
```

每个类都有自己的原型对象。因此，原型或类本身的任何属性（静态属性）都会被每个派生类自动继承。`uber`在调用函数之前，不会继承类中定义的属性。该`uber`函数返回基类的一个实例，以便可以调用基类方法。

**编辑：**这是上述模式的一个[工作示例：](http://jsfiddle.net/93QTd/2/)

```
var cube = new Cube(5);
alert("Side of the cube: 5");
alert("Area of the cube: " + cube.area());     // 150
alert("Volume of the cube: " + cube.volume()); // 125 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T04:04:43.677

第二个链接是描述*Prototype*，一个用于构建 JavaScript 应用程序的框架；这是一个专有名称。（有点像将窗口系统命名为“Windows”，随便举个例子。）第一个链接中使用的“原型”一词是 JavaScript 内部工作方式的标准术语。该框架以原型概念命名。

[在此链接](http://yehudakatz.com/2011/08/12/understanding-prototypes-in-javascript/)中对 JavaScript 中的“原型”概念进行了很好的介绍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:05:06.527

[https://developer.mozilla.org/en/Introduction_to_Object-Oriented_JavaScript](https://developer.mozilla.org/en/Introduction_to_Object-Oriented_JavaScript)中提到的原型是一种编程风格（面向对象的编程不使用`class`）；然而

[http://www.prototypejs.org](http://www.prototypejs.org)中提到的 Prototype是一个 JavaScript 库或框架，类似于 jQuery、MooTools 等。

# android - 启用 GPU 的 Android 模拟器的问题

> ID：11623930
> 
> 赞同：2
> 
> 时间：2012-07-24T03:57:29.047
> 
> 标签：android, mobile

启用 GPU 的 Android 模拟器出现问题。摘要和详细信息：

*   GPU Emulation 已打开，使用的图像是 ARM EABI，它不断闪烁。与此处所述相同的问题：[Android emulator black screen with "GPU emulation - yes"](https://stackoverflow.com/questions/10179187/android-emulator-black-screen-with-gpu-emulation-yes)。但不同之处在于我在 Windows 7 而不是 Linux 上运行模拟器。

*   GPU Emulation 已打开，使用的图像是 INTEL x86 ATOM（无英特尔虚拟化），它与上一个一样连续闪烁。

*   GPU Emulation 已打开，并且使用的映像是 INTEL x86 ATOM 并启用了 INTEL VIRTUALIZATION（安装了 intel haxm 并在 BIOS 配置中设置了虚拟化）导致蓝屏崩溃。

*   我正在运行安装了 SP1 的 Windows 7 x64。

*   尝试过 API 15 和 API16。
*   Android SDK 工具 rev 20.0.1（最新）
*   Android SDK Platformtools 13（最新）

如果解决了这个问题，肯定会节省我的开发时间。请帮忙。

# r - R - 如何减少 pch 在情节中出现的频率？

> ID：11623938
> 
> 赞同：0
> 
> 时间：2012-07-24T03:58:52.067
> 
> 标签：r

我想绘制几个时间序列，每行显示 pch。但是，pch 出现在每个数据点上，有什么办法可以减少 pch 出现在线上的频率，比如每隔几个数据点出现一个 pch，这样线条就不会显示为填充 pch 的粗线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T05:51:23.677

这是一种可能对您有所帮助的方法。如果没有更多关于您希望输出的外观的详细信息，很难确定。

```
x = seq(0, 20, 0.1)

par(mfrow=c(2, 1))

plot(x, x^2, pch=1, main="Before")
points(x, x*10, pch=2)

plot(x, x^2, pch=c(1, rep(NA, 9)), main="After")
points(x, x*10, pch=c(2, rep(NA, 9))) 
```

![在此处输入图像描述](../Images/b0a5fef8ed1c6948855792098d3d332d.png)

# iphone - 使用 switch 语句读取 NSDictionary

> ID：11623943
> 
> 赞同：0
> 
> 时间：2012-07-24T03:59:16.140
> 
> 标签：iphone, ios, nsdictionary

我试图弄清楚（如果可能的话）如何使用 switch 语句而不是 for 循环来读取 NSDictionay 键/值。

目前我正在这样做

```
for (id key in seriesData) {

    NSLog(@"key: %@, value: %@", key, [seriesData objectForKey:key]);

} 
```

但是，我希望它是一个 switch 语句，我在其中查找密钥，如果找到密钥，那么我将该值放入稍后将使用的变量中。

希望这是有道理的，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T04:01:51.193

C`switch`语句仅适用于类似整数的键（包括`enum`）。不能`switch`与 Objective-C 对象一起使用，例如在`NSDictionary`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T04:15:04.923

如果您熟悉使用块，则可以使用基于块的枚举方法 enumerateKeysAndObjectsUsingBlock 之一。

另外，如果您要“过滤”键；由于存在特定的键子集（例如以“A”开头的键），您可以使用其中一种谓词方法，例如 keysOfEntriesPassingTest。

所有这些都记录在[NSDictionary](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/nsdictionary_Class/Reference/Reference.html)类参考中。

# google-maps - 将 Google 地图嵌入移动网站

> ID：11623950
> 
> 赞同：-3
> 
> 时间：2012-07-24T04:00:38.390
> 
> 标签：google-maps, jquery-mobile, mobile

我是 Web 开发的新手，我遇到了一个问题。我正在创建一个移动网页，我想在网页上使用 Google 地图的功能。

所以我几乎在问，我如何让谷歌地图在移动网页上显示出来，以显示在我的网页上？我想要与常规谷歌地图相同的功能，包括位置检测以及图层和搜索功能。

谁能指出我应该寻找的正确方向。我在网站的其余部分使用 jquery mobile。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:04:16.200

[https://developers.google.com/maps/](https://developers.google.com/maps/)。专注于 JavaScript API： [https](https://developers.google.com/maps/documentation/javascript/tutorial) ://developers.google.com/maps/documentation/javascript/tutorial 。完整的参考，包括导航控件，可以在这里找到： [https ://developers.google.com/maps/documentation/javascript/3.8/reference](https://developers.google.com/maps/documentation/javascript/3.8/reference)

# c++ - 为什么在间接使用基类 typedef 时会不断出现语法错误，而直接使用它是可以的？

> ID：11623952
> 
> 赞同：0
> 
> 时间：2012-07-24T04:01:04.507
> 
> 标签：c++, visual-c++, typedef

```
template<typename T>
struct self
{
    typedef T type;
};

template<class T>
class A
{
    struct Type { int x; };
};

template<class T>
class B1 : A<T>
{
    Type insert();     // OK
};

template<class T>
class B2 : self< A<T> >::type
{
    Type insert();     // syntax error? Why?
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T09:31:24.393

Visual C++ 对模板有非标准的名称查找规则；[这是他们在此处](http://msdn.microsoft.com/en-us/library/ms235629.aspx)记录的三项违规行为之一（第三段）。

我相信所有的查找都被推迟到模板被实例化。那时，所有依赖名称都可用，因此通常不需要常用[关键字](https://stackoverflow.com/questions/610245)[`template`和显式成员访问；`typename`](https://stackoverflow.com/questions/610245)并且这个编译器不会费心去强制执行它们。

在您的两个派生类中，`Type`是一个从属名称，因此（在使用使用标准两阶段查找的编译器时）必须使用`typename`:

```
 typename Type insert(); 
```

# asp-classic - 经典的asp停止重定向

> ID：11623954
> 
> 赞同：1
> 
> 时间：2012-07-24T04:01:16.137
> 
> 标签：asp-classic

我有一个 index.html 文件和一个 default.asp 文件（同一目录）

并且我只想在输入域/服务器名称时访问 index.html 文件，例如 www.cat.com 如果输入了其他任何内容我想显示 Response.Write('Page Not Found')

我的 default.asp 文件：

```
<% 

 If InStr( UCase(Request.ServerVariables("SERVER_NAME")),  UCase("cat.com") ) = 0 Then 
    Response.Write("Page Not Found") 
 End If 
%> 
```

我这样做的原因是因为我将多个域指向同一个目录。

目前，这两个域都被重定向到 index.html 文件。

如果输入了 cat.com 以外的内容，是否可以停止执行？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T07:53:52.973

要在代码中调用 404 样式行为，请使用

```
Response.Status = "404 Not Found"
Response.End 
```

但是，您不能根据请求中的主机名阻止对 .html 文件等静态内容的访问。

# cocoa - NSTableview 中选定行的标签颜色

> ID：11623955
> 
> 赞同：0
> 
> 时间：2012-07-24T04:01:32.927
> 
> 标签：cocoa, nstableview, nstableviewcell

我`NSTableRowView`在基于视图的子类中将`NSTableView`选择颜色更改为浅蓝色而不是默认颜色。

不幸的是，当我选择该行时，我的自定义单元格内的标签和文本字段的颜色变为白色并且不可读。

如何防止文本在选择时改变颜色？

找到的解决方案：

我所要做的就是`-setBackgroundStyle:`在我的自定义中实现，`NSTableCellView`然后调用我想要在选择时保持黑暗的所有控件`setBackgroundStyle:NSBackgroundStyleLight`。`NSCell`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T08:23:30.097

好的，我想通了。

我所要做的就是在我的自定义 NSTableCellView 中实现 -setBackgroundStyle: 并在我想在选择时保持黑暗的所有控件的 NSCell 上调用 setBackgroundStyle:NSBackgroundStyleLight 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-24T05:49:37.680

您需要[制作一个自定义 NSCell](http://comelearncocoawithme.blogspot.com/2011/09/custom-cells-in-nstableview-part-1.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T06:06:07.050

你是如何改变选择颜色的？这听起来可能是由于您在现有图层之上添加子视图或子图层（可能是 cell.selectedBackgroundView？）引起的。如果您有任何 insertSublayer 或 subView 调用，请确保您在 Index:0 处执行它们。

# r - 我可以选择 nano 或 gedit 作为我在 R 中的编辑器吗？

> ID：11623957
> 
> 赞同：0
> 
> 时间：2012-07-24T04:01:41.807
> 
> 标签：r

> **可能重复：**
> [如何在 Linux 中更改 R 中的默认文本编辑器？](https://stackoverflow.com/questions/4221310/how-to-change-the-default-text-editor-in-r-when-in-linux)

```
> x=c(1,2,3,4)  
> edit(x) 
```

当我输入它时，vi编辑器将打开，但我不喜欢vi，我可以在输入edit（x）后让nano或gedit成为我在R中的编辑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:15:20.140

解决方案取决于您要如何解决问题。

*   您可以将`VISUAL`或`EDITOR`环境变量设置为您选择的文本编辑器，可能在您的 shell 启动脚本中（看看`~/.bashrc`这对您来说是不是全新的）。

*   如果您的发行版使用该`/usr/bin/sensible-editor`工具，您可以使用该`select-editor(1)`工具来更新您的选择。

*   您可以将`/etc/alternatives/editor`文件或类似文件设置为您希望的编辑器，如果您希望对所有用户在系统范围内进行更改，并且您的系统使用该`update-alternatives(8)`机制来管理哪个特定工具用于哪些任务。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-24T09:03:23.747

我得到它 。我的系统是 debian ，在 shell nano /etc/profile 添加一行
export EDITOR='/usr/bin/nano'
reboot 就可以了。

# objective-c - 单例设计实现

> ID：11623962
> 
> 赞同：0
> 
> 时间：2012-07-24T04:02:48.330
> 
> 标签：objective-c, ios, singleton, global-variables, singleton-methods

根据我之前的问题，[在这里](https://stackoverflow.com/questions/11608104/creating-a-global-object-across-classes)，我已经调整了我的数据控制器类以使用单例设计模式，以便我只能在多个视图中使用它一次。但是我确实有几个问题，我似乎也找不到解决方案。

首先，我不确定如何在两个视图中调用类/对象以使其工作，其次，我已经使用 + 将初始化方法设为全局，但我需要对每个方法都这样做吗？

为了共享数据，我希望能够跨视图共享的类的初始化是

```
static SpeecherDataController *_instance = nil;  // <-- important 

+(SpeecherDataController *)instance
{ 
    // skip everything
    if(_instance) return _instance; 

    // Singleton
    @synchronized([SpeecherDataController class]) 
    {
        if(!_instance)
        {
            _instance = [[self alloc] init];

            //  NSLog(@"Creating global instance!"); <-- You should see this once only in your program
        }

        return _instance;
    }

    return nil;
} 
```

该类使用三个可变数组作为主要内容，需要在两个视图中设置和读取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T04:18:17.033

如果我正确理解您的问题，我认为答案是：

1.  你可以使用类似的东西：

    ```
    SpeecherDataController * localReference = [SpeecherDataController instance]; 
    ```

    然后：

    ```
    [localReference someMessage:param]; // or ...
    localReference.property = whatever; 
    ```

2.  不，您的`SpeecherDataController`类上的方法也不需要成为类方法（即，它们不需要具有`+`前缀，`-`如果您想访问其中的 ivars，可以使用它们）。

注意：我认为您想`[[self alloc] init];`在.`[[SpeecherDataController alloc] init];``instance`

（另外，请注意：我无法按照您的链接到上面的“此处”查看您之前的问题。所以，如果我误解了什么，我深表歉意。）

# python - Python：ftp 和进度条 2.3

> ID：11623964
> 
> 赞同：3
> 
> 时间：2012-07-24T04:02:58.523
> 
> 标签：python, ftp, progress-bar

我有一个使用 ftplib 的 ftp 程序，在过去的几天里，我一直在试图弄清楚如何为 retrbinary 和 storbinary 实现进度条。我正在尝试使用progressbar 2.3 模块，但没有运气让它配合。我认为这可能源于对回调函数如何工作的误解。无论如何，这就是我所拥有的。

```
import progressbar
import ftplib

ftp = ftplib.FTP()
ftp.connect("host", "port")
ftp.login("user", "pwd")

widgets = ['Downloading: ', Percentage(), ' ', Bar(marker=RotatingMarker()),
       ' ', ETA(), ' ', FileTransferSpeed()]
pbar = ProgressBar(widgets=widgets, maxval=1024).start()

def callback(p):
    for i in range(1024):
        pbar.update(10*i+1)
        pbar.finish()

ftp.storbinary("STOR iTunesSetup.exe", open("iTunesSetup.exe"), callback, blocksize=1024) 
```

我收到此错误，尽管这只是我尝试过的多种方法之一：

```
Traceback (most recent call last):
  File "progrbar.py", line 7, in <module>
    ftp.connect("host", "port")
  File "/usr/lib/python2.7/ftplib.py", line 132, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout)
  File "/usr/lib/python2.7/socket.py", line 553, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
socket.gaierror: [Errno -8] Servname not supported for ai_socktype 
```

我可以说如果没有这个回调，ftp 服务器就可以正常工作并且有足够的空间来下载。如果有人可以给我一些指示，我将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T19:17:05.097

对于任何未来的访客，我就是这样做的......

```
def handleupload(self, block):
    self.pbar.update(self.pbar.currval+len(block))

def upload(self):
    try:
        if os.path.getsize(self.filename) == 0:
            print "%s 0 bytes passing..." % self.filename
        else:
            print "Uploading %s-%d-bytes" % (self.filename, self.ftp.size(self.filename))
            self.pbar=ProgressBar(widgets=[FileTransferSpeed(),' ', Bar(marker=RotatingMarker()), ' ', 
                                                    Percentage(),' ', ETA()],    maxval=os.path.getsize(self.filename)).start()
            self.ftp.storbinary("STOR " + self.filename, open(self.filename), 
                                                        callback = s.handleupload, blocksize = 1024)
            self.pbar.finish() 
            print "Finished"
    except (error_perm, error_temp, Exception), self.exc:
        print self.exc 
```

# css - twitter 引导默认填充

> ID：11623965
> 
> 赞同：5
> 
> 时间：2012-07-24T04:03:05.860
> 
> 标签：css, twitter-bootstrap, reset

为什么这是身体上 twitter bootstrap 的默认填充？

```
body {
  padding-top: 60px;
  padding-left: 20px;
} 
```

我的印象是“重置”css-ish 文件通常会删除所有填充/边距。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-05T20:34:56.183

主体上的填充覆盖了 .css 文件。

正如 odupont 所提到的，“当您在页面顶部有一个 navbar navbar-fixed-top 时，这很有用”

填充将在顶部固定定位的导航栏和文档正文之间设置 20 像素的垂直间隙。如上代码所示，padding-top: 60px;

40px 垂直填充，用于清除顶部固定导航栏的高度，该导航栏的高度为 40px。然后，导航栏和正文之间有 20px 的垂直间隙。因此，为 padding-top 声明了 60px。

出于特定目的，该 css 内容被插入正文中，它覆盖了您在 .css 文件中的任何填充样式。

尝试注释上面的代码，看看结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T00:28:43.673

如果您有一个 div 并希望 div 的背景在页面上伸展，请考虑使用与 body 上的 padding 等效的负边距，然后将 padding 添加到 div：

```
margin-left:   -20px;
padding-left:   20px;
margin-right:  -20px;
padding-right:  20px; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T11:46:12.983

当您在页面顶部有一个*navbar navbar-fixed-top*时，它会很有用，例如[Bootstrap Doc](http://twitter.github.com/bootstrap/components.html#navbar)上的示例。

# facebook - 模式 iframe 中的身份验证对话框

> ID：11623966
> 
> 赞同：4
> 
> 时间：2012-07-24T04:03:22.707
> 
> 标签：facebook, iframe, login, popup, modal-dialog

**无论如何，是否可以在自定义 iframe 中（即不在默认弹出窗口中）提供由 FB.login(...) 调用产生的登录/身份验证对话框？**

我尝试将*显示*类型更改为“页面”并将其采购到 iframe 中，但 Facebook 似乎以某种方式阻止了它。我理解他们为什么会这样做，但如果可能的话，我想把丑陋的弹出窗口放在一个类似灯箱的模态 iframe 中。如果有人在弹出窗口以外的其他地方成功获取登录/身份验证对话框，请告诉我。谢谢！

# c# - 删除应用程序分区会引发对象不存在的异常

> ID：11623974
> 
> 赞同：3
> 
> 时间：2012-07-24T04:04:17.980
> 
> 标签：c#, active-directory

按照[MSDN 上发布的关于如何创建应用程序分区的指导，](http://msdn.com/library/windows/desktop/ms676320.aspx)我在删除刚刚创建的分区时遇到了异常。下面的示例针对我的用户帐户具有完全管理员权限的 AD LDS 实例运行。有趣的是，如果在使用测试夹具之前分区存在，它会第一次工作。

```
var connectionString = new Uri("LDAPS://localhost/DC=integrationtests,DC=contoso,DC=com");
var baseContainerName = connectionString.PathAndQuery.TrimStart('/');
var hostName = IPGlobalProperties.GetIPGlobalProperties().HostName;
var directoryContext = new DirectoryContext(DirectoryContextType.DirectoryServer, hostName);
var configurationSet = ConfigurationSet.GetConfigurationSet(directoryContext);

var existingPartition =
                configurationSet.ApplicationPartitions.Cast<ApplicationPartition>().FirstOrDefault(
                    partition => baseContainerName.Equals(partition.Name, StringComparison.OrdinalIgnoreCase));
if (existingPartition != null)
{
    existingPartition.Delete();
}

// DirectoryEntry requires that the scheme is uppercase (LDAP not ldap)
var authenticationOptions = AuthenticationTypes.FastBind | AuthenticationTypes.Delegation | AuthenticationTypes.Secure;
var ldapConnectionString = String.Format(CultureInfo.InvariantCulture, "LDAP://{0}", hostName);
if (connectionString.Scheme.Equals("LDAPS", StringComparison.OrdinalIgnoreCase))
{
    authenticationOptions = authenticationOptions | AuthenticationTypes.SecureSocketsLayer;
    ldapConnectionString = ldapConnectionString + ":" + (connectionString.Port <= 0 ? "636" : connectionString.Port.ToString(CultureInfo.InvariantCulture));
}
using (var parent = new DirectoryEntry(ldapConnectionString, null, null, authenticationOptions))
{
    var partition = parent.Children.Add(baseContainerName, "domainDns");
    partition.Properties["instanceType"].Value = 5;
    partition.Properties["description"].Value = Assembly.GetExecutingAssembly().GetName().Name;
    partition.CommitChanges();
}

var existingPartition2 =
                configurationSet.ApplicationPartitions.Cast<ApplicationPartition>().FirstOrDefault(
                    partition => baseContainerName.Equals(partition.Name, StringComparison.OrdinalIgnoreCase));
if (existingPartition2 != null)
{
    // Throws here
    existingPartition2.Delete();
} 
```

对 existingPartition2.Delete() 的调用抛出：

```
System.DirectoryServices.ActiveDirectory.ActiveDirectoryOperationException was unhandled
HResult=-2146233088
Message=There is no such object on the server.

Source=System.DirectoryServices
ErrorCode=-2147016656
StackTrace:
        at System.DirectoryServices.ActiveDirectory.ApplicationPartition.Delete()
        at LdapTest.Program.Main(String[] args) in d:\Projects\LdapTest\LdapTest\Program.cs:line 58
        at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
        at System.AppDomain.nExecuteAssembly(RuntimeAssembly assembly, String[] args)
        at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
        at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
        at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
        at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
        at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
        at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
        at System.Threading.ThreadHelper.ThreadStart()
InnerException: System.DirectoryServices.DirectoryServicesCOMException
        HResult=-2147016656
        Message=There is no such object on the server.

        Source=System.DirectoryServices
        ErrorCode=-2147016656
        ExtendedError=8333
        ExtendedErrorMessage=0000208D: NameErr: DSID-03100213, problem 2001 (NO_OBJECT), data 0, best match of:
    'CN=Partitions,CN=Configuration,CN={CB88D356-F030-4598-BD59-F810587A2C72}'

        StackTrace:
            at System.DirectoryServices.DirectoryEntries.Remove(DirectoryEntry entry)
            at System.DirectoryServices.ActiveDirectory.ApplicationPartition.Delete() 
```

关于可能导致第二次抛出的任何想法？我可以在调用之前使用 ADSIEdit 看到 crossRef 对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T18:02:37.517

在与 Microsoft（PSS 案例 #112072417632086）一起解决问题后，结果发现 ConfigurationSet 类维护一个缓存，如果您进行了更改，则需要刷新。不是很明显，我知道......在第二个分区存在检查调用之前通过以下方式刷新它：

```
configurationSet = ConfigurationSet.GetConfigurationSet(directoryContext.Value); 
```

# c - 为什么 ctype 函数需要 int 但需要 unsigned char/EOF？

> ID：11623978
> 
> 赞同：8
> 
> 时间：2012-07-24T04:04:37.180
> 
> 标签：c

我正在使用 gcc (Ubuntu/Linaro 4.6.1-9ubuntu3) 4.6.1

手册页`isalnum()`说：

```
SYNOPSIS
       #include <ctype.h>

       int isalnum(int c); 
```

但是，它也说：

> 这些函数检查 c 是否**必须具有 unsigned char**或 EOF 的值，...

我发现对于非常大的正（或负）值（但它处理所有值）`isalnum()`会爆炸。`int``short int`

手册页是否说传入的 int 必须具有 an 值，`unsigned char`因为 C 库编写者保留以`isalnum()`一种不会处理所有`int`值而不爆炸的方式实现的权利？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-24T04:13:01.390

C标准说了很多......

在 ISO/IEC 9899:1999（旧的 C 标准）中，它说：

> ### §7.4 字符处理
> 
> 标头声明了几个对字符分类和映射有用的函数。在所有情况下，参数都是一个 int，其值应表示为无符号字符或应等于宏 EOF 的值。如果参数有任何其他值，则行为未定义。

（*我省略了一个脚注。*）C89 和 C11 说的非常相似。

一种常见的实现是使用偏移 1 的数组——主题的变体：

```
int _CtypeBits[257] = { ... };

#define isalpha(c)  (_Ctype_bits[(c)+1]&_ALPHA); 
```

只要`c`在 an 可以存储的整数范围内`unsigned char`（并且每个字符有 8 位，EOF 是`-1`，并且初始化是正确的），那么它就可以很好地工作。请注意，宏扩展只使用一次参数，这是标准的另一个要求。但是，如果您将随机值传递到规定范围之外，您将访问随机内存（或者，至少，未初始化以包含正确信息的内存）。

# python - 如何确定下拉菜单的值？

> ID：11623981
> 
> 赞同：0
> 
> 时间：2012-07-24T04:04:53.970
> 
> 标签：python, cgi

这是 Html 形式：

```
<form action='use.py'>
<div><input type='text' name='etc'></div>           
<p><input type='submit' value='etc!'></p>
</form> 
```

这就是它的蟒蛇

```
 colour = form["colour"].value 
```

顶部的 html 表单是一个文本框，用户可以在其中输入内容。

如果我有一个这样的下拉框/单选按钮表单：

```
<form action='etc.py'>

    <p>List Type:</p>
    <div><input type='radio' name='status' value='bulleted' checked>
        Bulleted
    </div>
    <div><input type='radio' name='status' value='numbered'>
        Numbered
    </div>

    <p>Text style:</p>
    <div><input type='checkbox' name='bold'>
        <b>Bold</b>
    </div>
    <div><input type='checkbox' name='italic'>
        <i>Italic</i>
    </div>

    <p>Movies to display:</p>
    <div>
        <select name='type'>
            <option>Only numbers</option>
            <option>Only names</option>
        </select>
    </div>    

    <p><input type='submit' value='Display'></p>
</form> 
```

我将如何编写我的python？像这样？

```
only_numbers = form["Only numbers"].value 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T08:55:47.107

您可以编写 Python CGI 脚本，但大多数 Python 框架都是基于 WSGI 构建的，并且具有请求/响应对象的概念。例如，在 Django 中，该值将在`request.POST['fieldname']`.

使用 python CGI 模块，它就像：

```
form = cgi.FieldStorage()
# for multiple elements with same name or elements with multiple values
a_list = form.getlist("multiple_select_input")
# For single value elements
if "single_value_input" in form:
    x = form["single_value_input"].value
else:
    x = "default value"
# or
x = form.getvalue("single_value_input", "default value") 
```

# jquery - 我无法将多选 jquery 值插入数据库

> ID：11623985
> 
> 赞同：1
> 
> 时间：2012-07-24T04:04:59.633
> 
> 标签：jquery, codeigniter-2, multi-select

我使用 jquery 多选来显示我的数据

这就是我在视图中显示数据的方式

* * *

```
<td><select class="multiselect" multiple="multiple" name="id_c[]">
        <?php foreach ($test as $data): ?>
        <option value="<?php echo $data->id_a ?>" ><?php echo $data->nama ?></option>
        <?php endforeach; ?>
        </select><td> 
```

* * *

这就是我在模型中保存到数据库中的方式

```
function save(){    

        $id_c= $this->input->post('id_c');
        var_dump($id_c);
        $idb = '';
        $count = count($id_c);
        $i=0;
        foreach($id_c as $e){
            if($i < $count -1){
                $idb .= $e.', ';
            }else{
                $idb .= $e;
            }
            $i++;
        }

            $tanggal = $this->input->post('tanggal');
            $data=array(
                        'id_c'=>$idb,
                        'tanggal'=>$tanggal
                        );
            $this->db->insert('detail',$data);
    } 
```

但是当我点击提交时，值没有进入数据库

我尝试使用 var_dump 这就是我得到的 bool(false)

* * *

消息：为 foreach() 提供的参数无效

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:13:27.957

您的保存方法应如下所示：

```
function save(){    
    //echo "<pre>";
    //print_r($this->input->post()); //first try to check whether you are receiving posted data or not.
    //die;

    $id_c= $this->input->post('id_c');
    $idb = implode(',', $id_c);
    $tanggal = $this->input->post('tanggal');
        $data=array(
                    'id_c'=>$idb,
                    'tanggal'=>$tanggal
                    );
        $this->db->insert('detail', $data);
} 
```

# javascript - html5画布内的Texbox

> ID：11623986
> 
> 赞同：0
> 
> 时间：2012-07-24T04:05:00.603
> 
> 标签：javascript, html, canvas, kineticjs

我可以使用 HTML 5 在画布内插入文本框吗？如果是，请告诉我如何在画布内插入文本框？目前我正在使用矩形来实现我的功能，但这不是我期待的方式，所以请帮助我在 HTML 5 中使用 KINETICJS 创建文本框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T04:15:08.653

不可以。您可以在画布元素前面放置输入或文本区域，使其看起来在内部，但无法将输入嵌入到画布中，因为画布只是通过 JavaScript 绘制像素的空间.

但是，我相当确定您可以在某些浏览器中将输入嵌入到 SVG 中，甚至可以转换它们（旋转、剪切等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T15:23:19.273

这真的很简单。

您必须将文本框放在 div 中，然后更改 div 位置。为了做到这一点，在你的身体标签下：

```
<body>
    <form id="form1" runat="server">
        <div id="mytext"> 
            <asp:TextBox ID="txtTest" runat="server"></asp:TextBox>
        </div> ..... 
```

在你的 head 标签下：

```
<head id="Head1" runat="server">
    <style type="text/css">
        #mytext {
            position: absolute;
            left: 36%;
            top: 725px;
            z-index: 999;
        }
    </style> 
```

通过更改 left 和 top 值，您可以将文本框放在画布上。

# vb.net - 我们如何在 VB 2008 中创建标准类

> ID：11623987
> 
> 赞同：0
> 
> 时间：2012-07-24T04:05:04.153
> 
> 标签：vb.net, visual-studio

我只是想知道我是否可以在 VB 2008 中创建一个标准类

我正在尝试创建一个接受 sql 作为参数的函数 GetRow(txtSQL)。我希望这个函数返回一个包含数据库表列作为属性的对象，这样我就可以用作

```
 myObj=GetRow("select name, address from tbl_contacts where id=1")
 txtname.text=myObj.name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T07:07:31.083

据我所知，您不能在设计时使用在运行时生成的属性。由于 SQL 只是一个字符串，编译器不知道 .Name 必须是一个属性。

我能给你的最好的如下：

```
 Function GetRow(cnn As SqlConnection, sql As String) As DataRow
    Using dtb As New DataTable
      Using dad As New SqlDataAdapter(sql, cnn)
        dad.Fill(dtb)
      End Using
      If dtb.Rows.Count >= 1 Then
        Return dtb.Rows(0)
      Else
        Return Nothing
      End If
    End Using
  End Function

  Sub test()
    Using cnn As New SqlConnection("Data Source=mycomputername;Timeout=10;User ID=myusername;Password=mypassword;")
      cnn.Open()
      Dim strSql As String = "select name, address from tbl_contacts where id=1"
      Dim drw As DataRow = GetRow(cnn, strSql)
      txtName.text = CStr(drw("name"))
      cnn.Close
    End Using
  End Sub 
```

# java - 了解三维数组

> ID：11623990
> 
> 赞同：9
> 
> 时间：2012-07-24T04:05:39.650
> 
> 标签：java, multidimensional-array

我正试图围绕三维数组。我知道它们是二维数组的数组，但是我正在阅读的这本书让我感到困惑。

在我正在阅读的这本书的练习中，它要求我为全彩图像制作一个三维数组。它给出了一个小例子：

> 如果我们决定选择一个 3D 数组，下面是数组的声明方式：

```
int[][][] colorImage = new int[numRows][numColumns][3]; 
```

但是，这样不是更有效吗？

```
int[][][] colorImage = new int[3][numRows][numColumns]; 
```

其中 3 是 rgb 值，0 为红色，1 为绿色，2 为蓝色。对于后者，每个二维数组都将存储行和列的颜色值，对吗？我只是想确保我了解如何有效地使用三维数组。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T04:14:09.767

顺序无关紧要，实际上前一种形式更具可读性：

```
final const int RED = 0;
final const int GREEN = 1;
final const int BLUE = 2;

int[][][] colorImage = new int[numRows][numColumns][3];
//...

int x = getSomeX();
int y = getSomeY();

int redComponent = colorImage[x][y][RED];
int greenComponent = colorImage[x][y][GREEN];
int blueComponent = colorImage[x][y][BLUE]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T04:08:19.497

顺序应该无关紧要，所以一个并不比另一个更有效。唯一重要的是任何访问 colorImage 的东西都知道哪个维度用于什么。更多关于多维数组的[上下文](http://en.wikipedia.org/wiki/Array_data_type#Multi-dimensional_arrays)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T05:55:57.600

我不确定将所有内容放在 int 的 3 维数组中是否是个好主意。

您的第一个错误是 dataytpe：RGB 是 int。但是 R 是一个字节，G 是一个字节，B 也是一个字节..（`Color.getXXX()`传递一个 int，我不知道为什么，因为它是一个字节 0-255）

您需要一个 int，因为您要处理超过 256 个列和行。（没关系）。但我认为将颜色信息封装在一个额外的对象中要好得多。也许是一个私有数据结构，例如

```
class MyColor {

        public byte r, g, b;    //public for efficient access;
        public int  color;      //public for efficient access;

        public MyColor(final int rgb) {
            this(new Color(rgb));
        }

        public MyColor(final Color c) {
            this((byte) c.getRed(), (byte) c.getGreen(), (byte) c.getBlue(), c.getRGB());
        }

        public MyColor(final byte red, final byte green, final byte blue, final int c) {
            this.r = red;
            this.g = green;
            this.b = blue;
            this.color = c;
        }
    } 
```

并将其放入 2dim 数组中`MyColor[numRows][numColumns]`

但是，如果您将 MyColor 课程公开给您的整个应用程序 - 我会更改课程的设计以更安全。

# android - 使用 Android 的 lrucache 示例

> ID：11623994
> 
> 赞同：40
> 
> 时间：2012-07-24T04:06:05.880
> 
> 标签：android, android-lru-cache

我需要帮助理解 androids LruCache。我想用来将图像加载到我的网格视图中，以使加载/滚动更好。有人可以使用 LruCache 发布示例代码吗？提前致谢。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-08-29T15:28:29.957

下面是我为使用 LruCache 制作的一个课程，它基于[在 Google I/O 2012上的演示](http://youtu.be/gbQb1PVjfqM)[*做更多事：做一个优秀的 Android 公民*](http://youtu.be/gbQb1PVjfqM)。

查看电影以获取有关我在`TCImageLoader`课堂上所做的更多信息：

```
public class TCImageLoader implements ComponentCallbacks2 {
    private TCLruCache cache;

    public TCImageLoader(Context context) {
        ActivityManager am = (ActivityManager) context.getSystemService(
            Context.ACTIVITY_SERVICE);
        int maxKb = am.getMemoryClass() * 1024;
        int limitKb = maxKb / 8; // 1/8th of total ram
        cache = new TCLruCache(limitKb);
    }

    public void display(String url, ImageView imageview, int defaultresource) {
        imageview.setImageResource(defaultresource);
        Bitmap image = cache.get(url);
        if (image != null) {
            imageview.setImageBitmap(image);
        }
        else {
            new SetImageTask(imageview).execute(url);
        }
    }

    private class TCLruCache extends LruCache<String, Bitmap> {

        public TCLruCache(int maxSize) {
            super(maxSize);
        }

        @Override
        protected int sizeOf(ImagePoolKey key, Bitmap value) {
            int kbOfBitmap = value.getByteCount() / 1024;
            return kbOfBitmap;
        }
    }

    private class SetImageTask extends AsyncTask<String, Void, Integer> {
        private ImageView imageview;
        private Bitmap bmp;

        public SetImageTask(ImageView imageview) {
            this.imageview = imageview;
        }

        @Override
        protected Integer doInBackground(String... params) {
            String url = params[0];
            try {
                bmp = getBitmapFromURL(url);
                if (bmp != null) {
                    cache.put(url, bmp);
                }
                else {
                    return 0;
                }
            } catch (Exception e) {
                e.printStackTrace();
                return 0;
            }
            return 1;
        }

        @Override
        protected void onPostExecute(Integer result) {
            if (result == 1) {
                imageview.setImageBitmap(bmp);
            }
            super.onPostExecute(result);
        }

        private Bitmap getBitmapFromURL(String src) {
            try {
                URL url = new URL(src);
                HttpURLConnection connection
                    = (HttpURLConnection) url.openConnection();
                connection.setDoInput(true);
                connection.connect();
                InputStream input = connection.getInputStream();
                Bitmap myBitmap = BitmapFactory.decodeStream(input);
                return myBitmap;
            } catch (IOException e) {
                e.printStackTrace();
                return null;
            }
        }

    }

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
    }

    @Override
    public void onLowMemory() {
    }

    @Override
    public void onTrimMemory(int level) {
        if (level >= TRIM_MEMORY_MODERATE) {
            cache.evictAll();
        }
        else if (level >= TRIM_MEMORY_BACKGROUND) {
            cache.trimToSize(cache.size() / 2);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-10-27T19:19:20.547

我找到了一种非常适合我的非常简单的方法......

这是 Cache.java 类。在这个类中，静态`getInstance()`方法使我们能够在整个应用程序中只创建一个缓存实例。`getLru()`方法用于检索缓存的对象，稍后将展示如何使用它。此缓存是通用的，这意味着您可以将任何 Object 类型保存到其中。这里的缓存大小设置为1024，如果太小可以更改：

```
import android.support.v4.util.LruCache;

public class Cache {

    private static Cache instance;
    private LruCache<Object, Object> lru;

    private Cache() {

        lru = new LruCache<Object, Object>(1024);

    }

    public static Cache getInstance() {

        if (instance == null) {

            instance = new Cache();
        }

        return instance;

    }

    public LruCache<Object, Object> getLru() {
        return lru;
    }
} 
```

这是您将位图保存到缓存的活动中的代码：

```
public void saveBitmapToCahche(){

        //The imageView that you want to save it's bitmap image resourse
        ImageView imageView = (ImageView) findViewById(R.id.imageViewID);

        //To get the bitmap from the imageView
        Bitmap bitmap = ((BitmapDrawable)imageview.getDrawable()).getBitmap();

        //Saving bitmap to cache. it will later be retrieved using the bitmap_image key
        Cache.getInstance().getLru().put("bitmap_image", bitmap);
    } 
```

这是您从缓存中检索位图的代码，然后将 imageView 设置为此位图：

```
public void retrieveBitmapFromCache(){

        //The imageView that you want to set to the retrieved bitmap
        ImageView imageView = (ImageView) findViewById(R.id.imageViewID);

        //To get bitmap from cache using the key. Must cast retrieved cache Object to Bitmap
        Bitmap bitmap = (Bitmap)Cache.getInstance().getLru().get("bitmap_image");

        //Setting imageView to retrieved bitmap from cache
        imageView.setImageBitmap(bitmap));

} 
```

就这样！正如你所看到的，这是相当容易和简单的。

*   例子：

在我的应用程序中，所有视图都保存在类变量中，因此类中的所有方法都可以看到它们。在我的第一个活动中，我将图像位图保存到一个方法中的缓存中`onClickButton()`，就在我使用意图开始一个新活动之前。我还在缓存中保存了一个字符串值：

```
public void onClickButton(View v){

    Bitmap bitmap = ((BitmapDrawable)imageView.getDrawable()).getBitmap();
    String name = textEdit.getText().toString();

    Cache.getInstance().getLru().put("bitmap_image", bitmap);
    Cache.getInstance().getLru().put("name", name);

    Intent i = new Intent(FirstActivity.this, SecondActivity.class);
    startActivity(i);
} 
```

然后我也使用意图从第二个活动导航到第三个活动。在最后一个活动中，我将其他对象保存到我的缓存中，然后使用意图返回到第一个活动。一旦我回到第一个活动，该`onCreate()`方法将开始。在该方法中，我检查我的缓存是否有任何位图值或任何字符串值分别（基于我的应用程序业务）：

```
public ImageView imageView;
public EditText editText;

@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_first);

        //...Other code...

        //The imageView that you want to save it's bitmap image resourse
        imageView = (ImageView) findViewById(R.id.imageViewID);

        //The editText that I want to save it's text into cache
        editText = (EditText)findViewById(R.id.editTextID);

        if(Cache.getInstance().getLru().get("name")!=null){
             editText.setText(Cache.getInstance().getLru().get("name").toString());
        }
        if(Cache.getInstance().getLru().get("bitmap_image")!=null){
             imageView.setImageBitmap((Bitmap)Cache.getInstance().getLru().get("bitmap_image"));
        }

        //...Other code...
    } 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-07-24T04:41:21.330

看看演示了使用的[缓存位图](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)[`LruCache`](http://developer.android.com/reference/android/util/LruCache.html)。

该页面代码的相关部分如下：-

```
private LruCache mMemoryCache;

@Override
protected void onCreate(Bundle savedInstanceState) {
    ...
    // Get memory class of this device, exceeding this amount will throw an
    // OutOfMemory exception.
    final int memClass = ((ActivityManager) context.getSystemService(
            Context.ACTIVITY_SERVICE)).getMemoryClass();

    // Use 1/8th of the available memory for this memory cache.
    final int cacheSize = 1024 * 1024 * memClass / 8;

    mMemoryCache = new LruCache(cacheSize) {
        @Override
        protected int sizeOf(String key, Bitmap bitmap) {
            // The cache size will be measured in bytes rather than number of items.
            return bitmap.getByteCount();
        }
    };
    ...
}

public void addBitmapToMemoryCache(String key, Bitmap bitmap) {
    if (getBitmapFromMemCache(key) == null) {
        mMemoryCache.put(key, bitmap);
    }
}

public Bitmap getBitmapFromMemCache(String key) {
    return mMemoryCache.get(key);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-29T08:37:33.430

[https://techienotes.info/2015/08/28/caching-bitmaps-in-android-using-lrucache/](https://techienotes.info/2015/08/28/caching-bitmaps-in-android-using-lrucache/)

此链接有一个完整的项目，其中包含使用 LruCache 将图像加载到 Gridview 的示例应用程序。

此类使用 LruCache 并取自链接中给出的代码

```
public class ImageAdapter extends BaseAdapter{
private String TAG = getClass().getSimpleName();
Context mContext;
ArrayList<Uri> imageList;

private LruCache<String, Bitmap> mLruCache;

public ImageAdapter (Context context){
    mContext = context;

    //Find out maximum memory available to application
    //1024 is used because LruCache constructor takes int in kilobytes
    final int maxMemory = (int) (Runtime.getRuntime().maxMemory() / 1024);

    // Use 1/4th of the available memory for this memory cache.
    final int cacheSize = maxMemory / 4;
    Log.d(TAG, "max memory " + maxMemory + " cache size " + cacheSize);

    // LruCache takes key-value pair in constructor
    // key is the string to refer bitmap
    // value is the stored bitmap
    mLruCache = new LruCache<String, Bitmap>(cacheSize) {
        @Override
        protected int sizeOf(String key, Bitmap bitmap) {
            // The cache size will be measured in kilobytes
            return bitmap.getByteCount() / 1024;
        }
    };

    imageList  = new ArrayList<Uri>();
    //Change this directory to where the images are stored
    String imagesFolderPath = Environment.getExternalStorageDirectory().getPath()+"/backups/";

    File imageSrcDir = new File (imagesFolderPath);
    // if directory not present, build it
    if (!imageSrcDir.exists()){
        imageSrcDir.mkdirs();
    }

    ArrayList<File> imagesInDir = getImagesFromDirectory(imageSrcDir);

    for (File file: imagesInDir){
        // imageList will hold Uri of all images
        imageList.add(Uri.fromFile(file));
    }
}

@Override
public int getCount() {
    return imageList.size();
}

@Override
public Object getItem(int position) {
    return null;
}

@Override
public long getItemId(int position) {
    return 0;
}

/**
 *
 * @param position The position of the item within the
 *                 adapter's data set of the item whose view we want.
 * @param convertView it is the view to be reused
 * @param parent The parent that this view will eventually be attached to
 * @return a View corresponding to the data at the specified position.
 */
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ImageView imageView;
    Bitmap thumbnailImage = null;
    if (convertView == null){
        imageView = new ImageView(mContext);
        imageView.setLayoutParams(
                //150,150 is size of imageview to display image
                new GridView.LayoutParams(150, 150));
        imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
    }
    else {
        imageView = (ImageView)convertView;
    }

    // Use the path as the key to LruCache
    final String imageKey = imageList.get(position).toString();

    //thumbnailImage is fetched from LRU cache
    thumbnailImage = getBitmapFromMemCache(imageKey);

    if (thumbnailImage == null){
        // if asked thumbnail is not present it will be put into cache
        BitmapWorkerTask task = new BitmapWorkerTask(imageView);
        task.execute(imageKey);
    }

    imageView.setImageBitmap(thumbnailImage);
    return imageView;
}

/**
 * This function returns the files from a directory
 * @param parentDirPath source directory in which images are located
 * @return list of Files
 */
private ArrayList<File> getImagesFromDirectory (File parentDirPath){
    ArrayList <File> listOfImages =  new ArrayList<File>();
    File [] fileArray = null;

    if ( parentDirPath.isDirectory() ){//parentDirPath.exists() &&
        //    &&
         //   parentDirPath.canRead()){
        fileArray = parentDirPath.listFiles();
    }

    if (fileArray == null){
        return listOfImages;    // return empty list
    }

    for (File file: fileArray){
        if (file.isDirectory()){
            listOfImages.addAll(getImagesFromDirectory(file));
        }
        else {
            // Only JPEG and PNG formats are included
            // for sake of simplicity
            if (file.getName().endsWith("png") ||
                    file.getName().endsWith("jpg")){
                listOfImages.add(file);
            }
        }
    }
    return listOfImages;
}

/**
 *  This function will return the scaled version of original image.
 *  Loading original images into thumbnail is wastage of computation
 *  and hence we will take put scaled version.
 */
private Bitmap getScaledImage (String imagePath){
    Bitmap bitmap = null;
    Uri imageUri = Uri.parse (imagePath);
    try{
        BitmapFactory.Options options = new BitmapFactory.Options();

        /**
         * inSampleSize flag if set to a value > 1,
         * requests the decoder to sub-sample the original image,
         * returning a smaller image to save memory.
         * This is a much faster operation as decoder just reads
         * every n-th pixel from given image, and thus
         * providing a smaller scaled image.
         * 'n' is the value set in inSampleSize
         * which would be a power of 2 which is downside
         * of this technique.
         */
        options.inSampleSize = 4;

        options.inScaled = true;

        InputStream inputStream = mContext.getContentResolver().openInputStream(imageUri);

        bitmap = BitmapFactory.decodeStream(inputStream, null, options);
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }

    return bitmap;
}

public void addBitmapToMemoryCache(String key, Bitmap bitmap) {
    if (getBitmapFromMemCache(key) == null) {
        mLruCache.put(key, bitmap);
    }
}

public Bitmap getBitmapFromMemCache(String key) {
    return mLruCache.get(key);
}

class BitmapWorkerTask extends AsyncTask<String, Void, Bitmap> {

    private final WeakReference<ImageView> imageViewReference;

    public BitmapWorkerTask(ImageView imageView) {
        // Use a WeakReference to ensure the ImageView can be garbage collected
        imageViewReference = new WeakReference<ImageView>(imageView);
    }

    @Override
    protected Bitmap doInBackground(String... params) {
        final Bitmap bitmap = getScaledImage(params[0]);
        addBitmapToMemoryCache(String.valueOf(params[0]), bitmap);
        return bitmap;
    }

    //  onPostExecute() sets the bitmap fetched by doInBackground();
    @Override
    protected void onPostExecute(Bitmap bitmap) {
        if (imageViewReference != null && bitmap != null) {
            final ImageView imageView = (ImageView)imageViewReference.get();
            if (imageView != null) {
                imageView.setImageBitmap(bitmap);
            }
        }
    }
}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-14T12:52:12.203

用于从自己的缓存中保存和检索位图的实用程序类。

```
package com.roomco.android.utils;

import android.graphics.Bitmap;
import android.support.v4.util.LruCache;

public class MyCache {

      private static MyCache instance;
      private LruCache<Object, Object> lru;

      private MyCache() {

         lru = new LruCache<Object, Object>(1024);

       }

    public static MyCache getInstance() {

        if (instance == null) {
        instance = new MyCache();
       }
       return instance;

    }

   public LruCache<Object, Object> getLru() {
       return lru;
   }

  public void saveBitmapToCahche(String key, Bitmap bitmap){

      MyCache.getInstance().getLru().put(key, bitmap);
  }

  public Bitmap retrieveBitmapFromCache(String key){

      Bitmap bitmap = (Bitmap)MyCache.getInstance().getLru().get(key);
      return bitmap;
  }

} 
```

用法：

```
//Save bitmap in cache
MyCache.getInstance().saveBitmapToCahche("your_key",bitmap);
// Get bitmap from cache
MyCache.getInstance().retrieveBitmapFromCache("your_key"); 
```

# python - 对列表python中的每个项目使用一个函数

> ID：11623997
> 
> 赞同：0
> 
> 时间：2012-07-24T04:06:13.717
> 
> 标签：python, list, dictionary, python-3.3

您好我正在尝试构建一个工具来压缩文件夹列表并重命名压缩文件，我要压缩的文件夹名称列表位于 .txt 文件中，.txt 是这样的：

```
james, 5005
kyle,  02939
Betty, 40234 
```

我已经使用了多种方法来尝试构建此代码，但我不断收到一个 python 错误集对象不可下标，我不知道该怎么做才能纠正这个问题以及如何从这里继续。我可以不将 shutil.make_archive 与字典一起使用，还是可以使用列表？因为我想在第一列中运行此函数并重命名我使用第二列创建的文件。我正在使用 python 3，任何帮助都会很棒！

```
import os
import shutil
x = input("Input Path your user list: ")
filename = input("Input user file name: ")
changedir = input("Input where your folders are: ")
os.chdir(changedir)

userfile = x + filename + ".txt"
print("Awesome your path is now", userfile)
with open(userfile, "rt") as userfileone:
    count = 0
    while 1:
        buffer = userfileone.read(8192*1024)
        if not buffer: break
        count += buffer.count('\n')
        print("It is indicated that there are", count + 1, "in the file")
with open(userfile, "rt") as f:
        lines = f.readlines()
dic = {}
for x in lines:
    x = x.strip().split(',')
    dic[x[0]]=tuple(x[1:])

for i in dic:
    shutil.make_archive(i, "zip", dic[i]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T07:13:04.800

看来您正在寻找该[`map`](http://docs.python.org/library/functions.html#map)功能。

# python - 如何替换python中的硬编码路径

> ID：11623998
> 
> 赞同：0
> 
> 时间：2012-07-24T04:06:15.017
> 
> 标签：python

在下面的代码中如何替换硬编码路径？有没有办法从某个配置文件中读取路径？

```
import sys  
sys.path.append(r" ./build/lib.linux-x86_64-2.4") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T04:22:16.473

您可以从 shell 读取路径：

```
path = raw_input( "Insert path: ") # It will display "Insert path and will return the string entered into variable 'path' 
```

或使用文件：

```
f = fopen( "<filepath>", "r" ) #open the file in reading-mode
list_of_lines = f.readlines() # read all the lines and put them in a list
f.close() # closes the file
for i in range( len(list_of_lines ) ): #cleaning from newline characters
  list_of_line[i] = list_of_line[i].strip() 
```

现在，在 list_of_lines 列表中，您将从文件中读取所有行...例如，现在您可以：

```
for i in range(len(list_of_lines)):
  sys.path.append( list_of_lines[i] ) 
```

希望它有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T04:10:36.543

而不是替换你可以做`sys.path.insert(0, "./build/lib.linux-x86_64-2.4")`这将优先考虑该路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T04:12:48.973

`.pth`为此，Python 有一个叫做文件的东西。

# iphone - *** __NSAutoreleaseNoPool()：NSPathStore2 类的对象 0x926d620 自动释放，没有适当的池 - 只是泄漏

> ID：11623999
> 
> 赞同：1
> 
> 时间：2012-07-24T04:06:25.230
> 
> 标签：iphone, ios, automatic-ref-counting, nsautoreleasepool

我的应用程序是启用 ARC 的。

在应用程序委托中，我编写了一个代码

```
[self performSelectorInBackground:@selector(initializeAnimationImageArrays) withObject:nil]; 
```

我的方法是

```
- (void)initializeAnimationImageArrays
{
    NSArray *animationArray = [NSArray arrayWithObjects:
           [UIImage imageNamed:@"1.png"],
           [UIImage imageNamed:@"2.png"],
           [UIImage imageNamed:@"3.png"],
           nil];
} 
```

我看到了一些错误消息，如下所示

`*** __NSAutoreleaseNoPool(): Object 0x926d620 of class NSPathStore2 autoreleased with no pool in place - just leaking`

我通过修改如下方法解决了这个问题。

```
@autoreleasepool
{ 
   NSArray *animationArray = [NSArray arrayWithObjects:
          [UIImage imageNamed:@"1.png"],
          [UIImage imageNamed:@"2.png"],
          [UIImage imageNamed:@"3.png"],
          nil];
} 
```

谁能向我解释一下，在这种情况下发生了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T04:11:21.820

它说您没有自动释放池来管理自动释放的对象。默认情况下，主线程将拥有其自动释放池。当你创建一个线程时，你必须自己创建一个自动释放池。