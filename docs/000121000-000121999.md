# StackOverflow 问答 000121000-000121999

# asp.net-mvc - 卡住创建“安全修剪”html.ActionLink 扩展方法

> ID：121000
> 
> 赞同：4
> 
> 时间：2008-09-23T13:30:41.097
> 
> 标签：asp.net-mvc

我正在尝试为 MVC 的 htmlHelper 创建一个扩展方法。目的是根据控制器/动作上设置的 AuthorizeAttribute 启用或禁用 ActionLink。借用 Maarten Balliauw 创建的[MVCSitemap](http://blog.maartenballiauw.be/post/2008/08/29/Building-an-ASPNET-MVC-sitemap-provider-with-security-trimming.aspx)
代码，我想在决定如何呈现操作链接之前验证用户对控制器/操作的权限。当我尝试获取 MvcHandler 时，我得到一个空值。控制器/动作的属性是否有更好的方法？

这是扩展方法的代码：

```
public static class HtmlHelperExtensions
{
    public static string SecurityTrimmedActionLink(this HtmlHelper htmlHelper, string linkText, string action, string controller)
    {
        //simplified for brevity 
        if (IsAccessibleToUser(action, controller))
        {
            return htmlHelper.ActionLink(linkText, action,controller);    
        }
        else
        {
            return String.Format("<span>{0}</span>",linkText);    
        }
    }

    public static bool IsAccessibleToUser(string action, string controller)
    {
        HttpContext context = HttpContext.Current;

        MvcHandler handler = context.Handler as MvcHandler;            

        IController verifyController = 
            ControllerBuilder
            .Current
            .GetControllerFactory()
            .CreateController(handler.RequestContext, controller);

        object[] controllerAttributes = verifyController.GetType().GetCustomAttributes(typeof(AuthorizeAttribute), true);
        object[] actionAttributes = verifyController.GetType().GetMethod(action).GetCustomAttributes(typeof(AuthorizeAttribute), true);

        if (controllerAttributes.Length == 0 && actionAttributes.Length == 0)
            return true;

        IPrincipal principal = handler.RequestContext.HttpContext.User;

        string roles = "";
        string users = "";
        if (controllerAttributes.Length > 0)
        {
            AuthorizeAttribute attribute = controllerAttributes[0] as AuthorizeAttribute;
            roles += attribute.Roles;
            users += attribute.Users;
        }
        if (actionAttributes.Length > 0)
        {
            AuthorizeAttribute attribute = actionAttributes[0] as AuthorizeAttribute;
            roles += attribute.Roles;
            users += attribute.Users;
        }

        if (string.IsNullOrEmpty(roles) && string.IsNullOrEmpty(users) && principal.Identity.IsAuthenticated)
            return true;

        string[] roleArray = roles.Split(',');
        string[] usersArray = users.Split(',');
        foreach (string role in roleArray)
        {
            if (role != "*" && !principal.IsInRole(role)) return false;
        }
        foreach (string user in usersArray)
        {
            if (user != "*" && (principal.Identity.Name == "" || principal.Identity.Name != user)) return false;
        }
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-22T23:19:37.263

这是工作代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Security.Principal;
using System.Web.Routing;
using System.Web.Mvc;
using System.Collections;
using System.Reflection;
namespace System.Web.Mvc.Html
{
    public static class HtmlHelperExtensions
    {
        public static string SecurityTrimmedActionLink(
        this HtmlHelper htmlHelper,
        string linkText,
        string action,
        string controller)
        {
            return SecurityTrimmedActionLink(htmlHelper, linkText, action, controller, false);
        }
        public static string SecurityTrimmedActionLink(this HtmlHelper htmlHelper, string linkText, string action, string controller, bool showDisabled)
        {
            if (IsAccessibleToUser(action, controller))
            {
                return htmlHelper.ActionLink(linkText, action, controller);
            }
            else
            {
                return showDisabled ? String.Format("<span>{0}</span>", linkText) : "";
            }
        }
        public static bool IsAccessibleToUser(string actionAuthorize, string controllerAuthorize)
        {
            Assembly assembly = Assembly.GetExecutingAssembly();
            GetControllerType(controllerAuthorize);
            Type controllerType = GetControllerType(controllerAuthorize);
            var controller = (IController)Activator.CreateInstance(controllerType);
            ArrayList controllerAttributes = new ArrayList(controller.GetType().GetCustomAttributes(typeof(AuthorizeAttribute), true));
            ArrayList actionAttributes = new ArrayList();
            MethodInfo[] methods = controller.GetType().GetMethods();
            foreach (MethodInfo method in methods)
            {
                object[] attributes = method.GetCustomAttributes(typeof(ActionNameAttribute), true);
                if ((attributes.Length == 0 && method.Name == actionAuthorize) || (attributes.Length > 0 && ((ActionNameAttribute)attributes[0]).Name == actionAuthorize))
                {
                    actionAttributes.AddRange(method.GetCustomAttributes(typeof(AuthorizeAttribute), true));
                }
            }
            if (controllerAttributes.Count == 0 && actionAttributes.Count == 0)
                return true;

            IPrincipal principal = HttpContext.Current.User;
            string roles = "";
            string users = "";
            if (controllerAttributes.Count > 0)
            {
                AuthorizeAttribute attribute = controllerAttributes[0] as AuthorizeAttribute;
                roles += attribute.Roles;
                users += attribute.Users;
            }
            if (actionAttributes.Count > 0)
            {
                AuthorizeAttribute attribute = actionAttributes[0] as AuthorizeAttribute;
                roles += attribute.Roles;
                users += attribute.Users;
            }

            if (string.IsNullOrEmpty(roles) && string.IsNullOrEmpty(users) && principal.Identity.IsAuthenticated)
                return true;

            string[] roleArray = roles.Split(',');
            string[] usersArray = users.Split(',');
            foreach (string role in roleArray)
            {
                if (role == "*" || principal.IsInRole(role))
                    return true;
            }
            foreach (string user in usersArray)
            {
                if (user == "*" && (principal.Identity.Name == user))
                    return true;
            }
            return false;
        }

        public static Type GetControllerType(string controllerName)
        {
            Assembly assembly = Assembly.GetExecutingAssembly();
            foreach (Type type in assembly.GetTypes())
            {
                if (type.BaseType.Name == "Controller" && (type.Name.ToUpper() == (controllerName.ToUpper() + "Controller".ToUpper())))
                {
                    return type;
                }
            }
            return null;
        }
    }
} 
```

我不喜欢使用反射，但我无法访问 ControllerTypeCache。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T14:31:04.850

您的 ViewPage 具有对视图上下文的引用，因此您可以将其作为扩展方法。

然后你可以说是 Request.IsAuthenticated 还是 Request.User.IsInRole(...)

用法就像`<%= this.SecurityLink(text, demandRole, controller, action, values) %>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T16:15:32.067

我真的很喜欢@Robert 帖子中的代码，但是有一些错误，我想缓存角色和用户的收集，因为反射可能会花费一些时间。

已修复的错误：如果同时存在 Controller 属性和 Action 属性，则当角色连接时，不会在控制器角色和操作角色之间插入额外的逗号，从而无法正确分析。

```
[Authorize(Roles = "SuperAdmin,Executives")]
public class SomeController() {
    [Authorize(Roles = "Accounting")]    
    public ActionResult Stuff() {
    }
} 
```

那么角色字符串最终是`SuperAdmin,ExecutivesAccounting`，我的版本确保 Executives 和 Accounting 是分开的。

我的新代码也忽略了 HttpPost 操作上的 Auth，因为这可能会导致事情失败，尽管不太可能。

最后，它返回`MvcHtmlString`而不是`string`新版本的 MVC

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Reflection;
using System.Collections;
using System.Web.Mvc;
using System.Web.Mvc.Html;
using System.Security.Principal;

public static class HtmlHelperExtensions
{
    /// <summary>
    /// only show links the user has access to
    /// </summary>
    /// <returns></returns>
    public static MvcHtmlString SecurityLink(this HtmlHelper htmlHelper, string linkText, string action, string controller, bool showDisabled = false)
    {
        if (IsAccessibleToUser(action, controller))
        {
            return htmlHelper.ActionLink(linkText, action, controller);
        }
        else
        {
            return new MvcHtmlString(showDisabled ? String.Format("<span>{0}</span>", linkText) : "");
        }
    }

    /// <summary>
    /// reflection can be kinda slow, lets cache auth info
    /// </summary>
    private static Dictionary<string, Tuple<string[], string[]>> _controllerAndActionToRolesAndUsers = new Dictionary<string, Tuple<string[], string[]>>();

    private static Tuple<string[], string[]> GetAuthRolesAndUsers(string actionName, string controllerName)
    {
        var controllerAndAction = controllerName + "~~" + actionName;
        if (_controllerAndActionToRolesAndUsers.ContainsKey(controllerAndAction))
            return _controllerAndActionToRolesAndUsers[controllerAndAction];

        Type controllerType = GetControllerType(controllerName);
        MethodInfo matchingMethodInfo = null;

        foreach (MethodInfo method in controllerType.GetMethods())
        {
            if (method.GetCustomAttributes(typeof(HttpPostAttribute), true).Any())
                continue;
            if (method.GetCustomAttributes(typeof(HttpPutAttribute), true).Any())
                continue;
            if (method.GetCustomAttributes(typeof(HttpDeleteAttribute), true).Any())
                continue;

            var actionNameAttr = method.GetCustomAttributes(typeof(ActionNameAttribute), true).Cast<ActionNameAttribute>().FirstOrDefault();
            if ((actionNameAttr == null && method.Name == actionName) || (actionNameAttr != null && actionNameAttr.Name == actionName))
            {
                matchingMethodInfo = method;
            }
        }

        if (matchingMethodInfo == null)
            return new Tuple<string[], string[]>(new string[0], new string[0]);

        var authAttrs = new List<AuthorizeAttribute>();
        authAttrs.AddRange(controllerType.GetCustomAttributes(typeof(AuthorizeAttribute), true).Cast<AuthorizeAttribute>());

        var roles = new List<string>();
        var users = new List<string>();

        foreach(var authAttr in authAttrs)
        {
            roles.AddRange(authAttr.Roles.Split(','));
            users.AddRange(authAttr.Roles.Split(','));
        }

        var rolesAndUsers = new Tuple<string[], string[]>(roles.ToArray(), users.ToArray());
        try
        {
            _controllerAndActionToRolesAndUsers.Add(controllerAndAction, rolesAndUsers);
        }
        catch (System.ArgumentException ex)
        {
            //possible but unlikely that two threads hit this code at the exact same time and enter a race condition
            //instead of using a mutex, we'll just swallow the exception when the method gets added to dictionary 
            //for the second time. mutex only allow single worker regardless of which action method they're getting
            //auth for. doing it this way eliminates permanent bottleneck in favor of a once in a bluemoon time hit
        }

        return rolesAndUsers;
    }

    public static bool IsAccessibleToUser(string actionName, string controllerName)
    {
        var rolesAndUsers = GetAuthRolesAndUsers(actionName, controllerName);
        var roles = rolesAndUsers.Item1;
        var users = rolesAndUsers.Item2;

        IPrincipal principal = HttpContext.Current.User;

        if (!roles.Any() && !users.Any() && principal.Identity.IsAuthenticated)
            return true;

        foreach (string role in roles)
        {
            if (role == "*" || principal.IsInRole(role))
                return true;
        }
        foreach (string user in users)
        {
            if (user == "*" && (principal.Identity.Name == user))
                return true;
        }

        return false;
    }

    public static Type GetControllerType(string controllerName)
    {
        Assembly assembly = Assembly.GetExecutingAssembly();
        foreach (Type type in assembly.GetTypes())
        {
            if (type.BaseType.Name == "Controller" && (type.Name.ToUpper() == (controllerName.ToUpper() + "Controller".ToUpper())))
            {
                return type;
            }
        }
        return null;
    }

} 
```

# iphone - 是否可以在没有 iPhone 的情况下为 iPhone 开发？

> ID：121018
> 
> 赞同：20
> 
> 时间：2008-09-23T13:33:18.517
> 
> 标签：iphone, emulation, mobile-phones

我知道有模拟器，但这是否足够好？如果有人认真对待 iPhone 开发，他们是否绝对需要 iPhone？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-09-23T13:35:39.167

只是我个人的看法：如果你是认真的，那就意味着你致力于产品的质量。如果您致力于质量，那么如果没有在目标平台上实际发布产品，就无法交付产品:)

如其他帖子中所述，您将很难在模拟器上测试多点触控屏幕和硬件的其他方面。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-23T13:42:35.903

不要忘记，大多数类型的 iPhone 应用程序也可以在 iPod Touch 上运行，这是一次性费用，没有月费。如果 iPod Touch 连接到 WiFi，即使是网络应用程序也能正常工作。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-23T14:13:03.927

在开发我的第一个 iPhone 应用程序期间，我编写的代码在 iPhone 模拟器上运行良好，但在设备上却无法运行。所以我会说“是的，你肯定需要在实际设备上进行测试。”

模拟器不是模拟器。它没有运行实际的 iPhone 操作系统；它正在运行一组与 iPhone OS 非常相似但不相同的 Mac OS X 库。模拟器非常适合在代码和测试周期中进行调试和节省时间，因此您将比设备更多地使用它，但设备是必不可少的。

您确实需要在真实设备上触摸和感受您的应用程序。一个在用鼠标指向和点击时效果很好的用户界面在用拇指和手指使用时可能会很糟糕。如果有任何文本输入，您需要感受使用屏幕键盘输入的痛苦程度，以确定提供替代数据输入方法是否有意义。

模拟器和实际设备之间也存在显着的性能差异。您需要使用要支持的最旧（最慢）设备进行测试，以验证它不会太慢、不会耗尽内存等。

正如其他人所建议的那样，iPod Touch 也足够了，因此设备的成本并不高。此外，尝试找到具有各种不同型号的 beta 测试人员。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-23T13:38:12.077

**必要**：应用程序在您手中的处理方式对于 iPhone 之类的东西至关重要。在大屏幕的模拟器中直接贴在您面前时，您无法说出使用时的感觉。

如果你不能持有它，你将无法获得真正的用户体验。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-09-23T13:40:15.410

如果您需要学习 Obj-C，请使用模拟器一段时间，直到您学会了绳索并节省费用以备后用。但是，是的，最终您将需要一部 iPhone 进行最终测试。您可以等待多长时间取决于您的应用程序使用的功能，如果您所做的只是按下按钮，则可以等待很长时间。如果您正在拖动、使用定位服务等，您将需要在开发周期的早期使用设备。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-23T13:34:53.753

你是想说服自己还是说服老板？;-)

我会说你需要一个。模拟这种新设备只会出错。另外不要忘记触觉方面。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-23T21:00:43.510

iPod touch 是合理的替代品，前提是您不使用：

GPS、BlueTouch 或相机 - iPod touch 没有这些

蜂窝网络——虽然 iPod touch 有 WiFi，但蜂窝网络的延迟远高于 wifi 网络。如果您正在为您的应用程序设计一个自定义协议之类的事情，您将需要检查实际性能 - 如果您在开发周期中这样做得太晚，您将会遇到令人不快的惊喜。

无论您是在 iPod touch 上还是在 iPhone 上进行开发，您都必须拥有一台设备。这不是可选的！模拟器很好，但并不完美，没有什么可以替代正确指示性能、屏幕分辨率、亮度、外形尺寸和您在应用程序中需要考虑的所有其他因素的设备。

如果您购买 iPod touch，您可能最终也会获得 iPhone。我会直接去iPhone。这样，您就可以将它用作您的主要手机，并真正了解平台的行为方式以及应用程序需要做什么才能使其变得更好。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-23T13:35:28.433

有点“是”。

只需下载 iPhone SDK（它既简单又免费）并查看其中的模拟器。你会看到这是否适合你的需要。模拟器并不代表真正的硬件性能，没有触摸输入，有些怪癖可能不同，有些东西不能工作，等等。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-09-23T13:41:46.420

iPhone 模拟器使您可以使用台式机或笔记本电脑的强大功能和便利性轻松测试您的应用程序。虽然，**您的开发计算机可能无法模拟复杂的触摸事件，例如多指触摸**，但模拟器可以让您执行捏合操作。要执行捏合，请在点击模拟器屏幕的同时按住 Option。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-23T13:39:07.317

我想说这取决于您正在开发的应用程序类型。对于一个成功的 iPhone 应用程序，一个正确集成到系统中的应用程序，您将*需要*能够测试您的触觉界面。模拟器很难做到这一点。

所以，我的回答是肯定的，你确实需要一部 iPhone 来开发 iPhone 应用程序。幸运的是，如果你买不起，iPod Touch（200 美元）是一个非常合适的替代品。底层硬件几乎相同。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-23T13:56:43.623

必要的。如果您计划开发一款成功的产品，它必须是最终用户（不仅仅是开发人员）觉得易于使用的产品。

最好的方法是将您的应用程序加载到 iPhone 上，然后将其带给不同的人，让他们在您观看他们的同时使用它，看看他们是否遇到任何问题。用户可以在尝试做开发人员从未想过的事情时获得强大的创造力 - 只需询问任何支持技术。

除非您的应用程序的总售价低于 500 美元，否则构建优质应用程序的投资相对较小。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-23T14:38:16.800

如果您对开发很认真，那么 iPhone（或 iPod touch）是必须的。不过官方SDK自带了一个非常完整的“iPhone模拟器”。这将使您对 Objective C 和整个开发工作流程有所了解。SDK 需要 Leopard。

为此，您不需要 Mac。您可以在 PC 上使用 OSX86，可以安装在磁盘上并从磁盘引导，也可以通过**VmWare**进行引导。

有用。事实上，你甚至可以通过运行在 vmWare 中的 Leopard 来同步 iPhone。

现在，由于性能、内存使用等原因，在真正的 iPhone 上进行测试是必要的。您还需要它来完成整个身份验证过程、获取密钥等（如果您想在 Appstore 上出售您的东西），测试这确实需要一部 iPhone。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-24T13:46:17.197

> 如果您购买 iPod touch，您可能最终也会获得 iPhone。我会直接去iPhone。这样，您就可以将它用作您的主要手机，并真正了解平台的行为方式以及应用程序需要做什么才能使其变得更好。

我完全同意这一点。

如果您正在认真开发 iPhone 应用程序 - 出于娱乐或盈利目的 - 您将不得不在真正的 iPhone 上运行它以测试兼容性和可用性。既然您将不得不在某个时候获得一个，那么您不妨现在就获得一个。不要半途而废。iPod Touch 一开始可能会[显着]便宜，但是当你去买你的 iPhone 时会浪费钱。（当然，如果您计划在 iPhone 和 iPod Touch 上运行一个应用程序，那么您必须在两者上测试它。您不能假设如果它在一个上很好，那么它在另一个上一定很好）。

此外，通过从第一天开始拥有 iPhone，您可以熟悉其用户界面、规范和应用程序使用的常见隐喻。这将极大地影响您自己的应用程序设计过程，并确保您的应用程序在外观、感觉和工作上都像一流的 iPhone 公民。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-23T13:40:09.687

从在其他移动平台上开发的经验来看，一旦达到一定程度，*最好*有一个物理设备进行测试。如果这是您自己也会使用的东西，如果通过使用该应用程序更容易获得一些真实世界类型的测试。

我还认为，通过使用您的应用所针对的设备或设备来更好地了解平台，

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-23T14:29:13.687

如果您要为 iphone 开发本机应用程序，我会说让 iphone 或 ipod touch 成为目标。模拟器很好，但最终你需要瞄准真实的东西。如果您正在开发特定于网络的内容，那么您可以在没有它的情况下做很多事情（苹果开发网站上有一些免费的很棒的开发视频，只需您注册即可）但最终我认为您仍然想测试真正的交易

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2011-03-08T13:46:08.163

买一个便宜的二手 iPod touch，开发，赚钱，买一部 iPhone 5。

我现在是诺基亚开发人员，我正在考虑使用 iPhone，实际上我有 Mac 可以工作，只是设备本身；）

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-23T13:43:18.040

我试过 iPhoney，与我的 iPhone（Mark 1）相比，它不一样，它很接近 - 但如果界面对你来说很重要，还不足以依赖它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-25T20:46:41.017

你绝对需要真正的设备。模拟器和实际的 iPhone/iPod Touch 硬件之间的性能差异是巨大的。在模拟器中运行良好且快速的代码很容易被证明太慢而无法在真实的东西上使用。此外，模拟器提供的 API 并非 100% 与真实事物相同，因此在 sim 中运行良好的代码可能无法在设备上运行。唯一确定的方法是经常在实际设备上进行测试。

正如其他人所提到的，iPod touch 作为开发设备运行良好。因此，如果您不需要 iPhone 的任何功能，它是一个不错的、更便宜的替代品。

# python - 如何在 Python 中获取文件的修改日期/时间？

> ID：121025
> 
> 赞同：23
> 
> 时间：2008-09-23T13:34:35.207
> 
> 标签：python, file

如何在 Python 中获取文件的修改日期/时间？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-09-23T13:35:07.967

```
os.path.getmtime(filepath) 
```

或者

```
os.stat(filepath).st_mtime 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-05-24T12:06:59.110

形成：

```
import time
print time.strftime("%m/%d/%Y %I:%M:%S %p",time.localtime(os.path.getmtime(fname))) 
```

# iphone - iPhone全屏图像

> ID：121051
> 
> 赞同：8
> 
> 时间：2008-09-23T13:38:26.757
> 
> 标签：iphone, html, mobile-safari

如何在 iPhone 上全屏显示图像或页面部分？

我有一个 480 x 320 的图像，我想在 iPhone 上全屏显示，但它必须在网页内，以便我可以将图像作为返回上一页的链接。

目前，如果我将图像放在空白页面上并在 iPhone 上打开它，它只会显示在左上角。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-23T13:45:00.750

希望我在这里没有违反 NDA，但这里是这样。

默认情况下，Mobile Safari 会呈现页面，就好像该页面已由桌面浏览器查看一样，默认宽度为 980 像素。

要更改此行为，您需要显式声明视口，您可以通过元标记执行此操作。如果您将宽度声明为常量*device-width*，它将默认为 320 而不是 980，并且一切看起来都很棒。

```
<head>
    <meta name="viewport" content="width=device-width,user-scalable=no" />
</head> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T13:42:02.677

我会说在您的空白页面中设置视口元标记，以便 Safari 知道以正确的大小呈现页面。有关更多信息，请参阅此链接：

[Apple iPhone Safari 文档](http://developer.apple.com/DOCUMENTATION/AppleApplications/Reference/SafariWebContent/UsingtheViewport/chapter_4_section_5.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T22:21:57.877

不错的链接，可以进一步帮助您：

如何针对移动设备优化您的网站：http: [//solutions.treypiepmeier.com/2008/12/01/optimizing-a-website-for-iphone/](http://solutions.treypiepmeier.com/2008/12/01/optimizing-a-website-for-iphone/)

# c# - 从 32 位整数到 4 个字符的转换

> ID：121059
> 
> 赞同：5
> 
> 时间：2008-09-23T13:40:00.200
> 
> 标签：c#, encoding

在 C# 中将 32 位整数分成四个（无符号）字符的最佳方法是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T13:48:53.190

Quick'n'dirty：

```
int value = 0x48454C4F;
Console.WriteLine(Encoding.ASCII.GetString(
  BitConverter.GetBytes(value).Reverse().ToArray()
)); 
```

将 int 转换为字节，将字节数组反转为正确的顺序，然后从中获取 ASCII 字符表示。

编辑：该`Reverse`方法是 .NET 3.5 的扩展方法，仅供参考。在您的场景中也可能不需要反转字节顺序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T13:48:42.223

字符？也许您正在寻找这个方便的小助手功能？

```
Byte[] b = BitConverter.GetBytes(i);
Char c = (Char)b[0];
[...] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T13:43:49.223

目前尚不清楚这是否真的是您想要的，但是：

```
int x = yourNumber();
char a = (char)(x & 0xff);
char b = (char)((x >> 8) & 0xff);
char c = (char)((x >> 16) & 0xff);
char d = (char)((x >> 24) & 0xff); 
```

这假设您希望将字节解释为最低范围的 Unicode 字符。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-23T14:28:09.243

我已经尝试了几种方法，并计算了转换 1000000 个整数所需的时间。

内置转换方法，325000 滴答：

```
Encoding.ASCII.GetChars(BitConverter.GetBytes(x)); 
```

指针转换，100000 滴答：

```
static unsafe char[] ToChars(int x)
{
    byte* p = (byte*)&x)
    char[] chars = new char[4];
    chars[0] = (char)*p++;
    chars[1] = (char)*p++;
    chars[2] = (char)*p++;
    chars[3] = (char)*p;

    return chars;
} 
```

位移，77000 滴答声：

```
public static char[] ToCharsBitShift(int x)
{
     char[] chars = new char[4];
     chars[0] = (char)(x & 0xFF);
     chars[1] = (char)(x >> 8 & 0xFF);
     chars[2] = (char)(x >> 16 & 0xFF);
     chars[3] = (char)(x >> 24 & 0xFF);
     return chars;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T13:44:32.280

获取 8 字节块：

```
int a = i & 255; // bin 11111111
int b = i & 65280; // bin 1111111100000000 
```

将前三个字节分解为一个字节，只需将它们除以适当的数字并执行另一个逻辑并获得最终字节。

编辑：Jason 的移位解决方案当然要好得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T13:51:41.047

.net 使用 Unicode，一个 char 是 2 个字节而不是 1

要在包含非 unicode 文本的二进制数据之间进行转换，请使用 System.Text.Encoding 类。

如果你确实想要 4 个字节而不是字符，那么在 Jason 的回答中用字节替换字符

# visual-studio-2008 - 为什么 VS2008 不能将异常帮助弹出窗口放置到辅助监视器上？

> ID：121063
> 
> 赞同：0
> 
> 时间：2008-09-23T13:40:24.083
> 
> 标签：visual-studio-2008, multiple-monitors

我最近购买了第二台显示器，现在在我的第二台（和更大的）显示器上运行 VS2008 SP1 最大化。从理论上讲，这有利于在主监视器上打开正在开发的应用程序，在我看来，所有新启动的应用程序都在那里。到现在为止还挺好。现在的问题是，异常帮助程序弹出窗口**没有**在辅助监视器上打开。更糟糕的是，**只有**当 Studio 窗口在主监视器上足够远时才会显示！如果我将带有打开的异常助手的工作室从主监视器拖动到辅助监视器，则助手会随窗口一起拖动，直到它碰到两个监视器之间的边界，然后突然**消失**。

有人也经历过吗？有什么解决方法吗？还有什么我应该尝试的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T13:45:35.617

VS 不支持多显示器。我相信他们正在考虑在下一个版本中改善多显示器体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T14:18:43.117

我运行双 22 英寸宽屏并遇到同样的问题，如果您有一台更大或更常用的显示器，我知道唯一真正可行的方法是将更大的所需显示器作为主要显示器。这并不优雅，甚至可能不适合你，但这就是我所能做的。

# javascript - 事件处理 jQuery unclick() 和 unbind() 事件？

> ID：121066
> 
> 赞同：9
> 
> 时间：2008-09-23T13:41:07.607
> 
> 标签：javascript, jquery, css, event-handling

我想将单击事件附加到按钮元素，然后将其删除，但我无法获取`unclick()`或`unbind()`事件按预期工作。在下面的代码中，按钮是`tan`彩色的，并且单击事件有效。

```
window.onload = init; 
function init() {
    $("#startButton").css('background-color', 'beige').click(process_click);
    $("#startButton").css('background-color', 'tan').unclick();
} 
```

如何从元素中删除事件？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-23T13:54:35.407

没有这样的事情`unclick()`。你从哪里得到那个的？

您可以通过调用 unbind 从元素中删除单个事件处理程序：

```
$("#startButton").unbind("click", process_click); 
```

如果要删除所有处理程序，或者使用匿名函数作为处理程序，则可以省略第二个参数`unbind()`：

```
$("#startButton").unbind("click"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-09-15T15:09:18.390

或者您可能会遇到这样的情况，即您想在使用 click 功能后立即取消绑定，就像我必须这样做：

```
$('#selector').click(function(event){
    alert(1);
    $(this).unbind(event);
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T13:43:15.183

解绑是你的朋友。

```
$("#startButton").unbind('click') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T15:47:39.770

您确定要解除绑定吗？如果以后你想一次又一次地绑定它怎么办？我不喜欢动态事件处理绑定/取消绑定，因为当从代码的不同点调用它们时，它们往往会失控。

您可能需要考虑其他选项：

*   更改按钮“禁用”属性
*   在“process_click”函数中实现你的逻辑

只是我的 2 美分，不是通用的解决方案。

# cognos - 提示中的多选在 Cognos 8.1 中无法正常工作

> ID：121105
> 
> 赞同：3
> 
> 时间：2008-09-23T13:48:04.440
> 
> 标签：cognos, cognos-8

在 Report Studio 中将值提示更改为多选值提示，提供单选功能。如何获得多选功能？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T13:53:09.763

查看与提示关联的参数。现在去看看如何使用该参数来过滤报告中的查询。如果您将过滤器设置为：-

[命名空间].[表].[列] = ?MyParameter?

...那么您的提示是多选提示并不重要，它仍将作为单选提示运行。修改您的过滤器，使其具有以下形式：-

[namespace].[table].[column] in ?MyParameter?

这告诉 Cognos 您的参数可以包含多个值，并且它将相应地显示提示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-02T19:20:52.583

除了上面的答案。如果提示嵌入在框架中的 QuerySubject 中，您可能需要检查 Query Subject 并查看它是否使用 #promptmany()# 宏而不是 #prompt#。

# apache-flex - 良好的资源加载系统

> ID：121110
> 
> 赞同：1
> 
> 时间：2008-09-23T13:49:24.453
> 
> 标签：apache-flex, actionscript-3, resources

我目前正在为 actionscript3 寻找资源管理系统。更具体地说，在这种情况下，我正在寻找使用过它们的人对现成资源加载器/管理器的意见，

*   它们干净/易于使用吗？
*   它们是为扩展而设计的吗？
*   我打算将它与类似 MVC 的系统一起使用，Mate 是列表中的下一个，还有其他人以这种方式使用资源加载器吗？

*   [马萨皮](http://code.google.com/p/masapi/)

*   [队列加载器](http://code.google.com/p/queueloader-as3/)

*   [散装装载机](http://code.google.com/p/bulk-loader/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T17:02:04.613

我对批量装载机非常满意。我们已经将它与 Parsley 的 MVC 和 IoC 框架集成 - [http://spicefactory.org/parsley/](http://spicefactory.org/parsley/) - 取得了巨大成功。

# visual-studio-2008 - 当我激活“焦点跟随鼠标”时，如何防止 Visual Studio 自动提升？

> ID：121111
> 
> 赞同：10
> 
> 时间：2008-09-23T13:49:47.040
> 
> 标签：visual-studio-2008, mouse, desktop, raise

我正在运行 VS2008 并使用[SystemParametersInfo](http://msdn2.microsoft.com/en-us/library/ms724947.aspx)来激活“焦点跟随鼠标”和“不要提高焦点”。可悲的是，VS2008（有和没有 SP1）不尊重“不提升”部分，并且每次指针触摸它的窗口时都急切地推到前台。

不久前，我在我的博客上抱怨了这一点，[并发布了一个示例应用程序](http://dasz.at/index.php/2008/01/focus-follow-mouse-or-not/)来设置参数。另外两个人也报告了这个问题，但他们也不知道如何继续。

我该如何解决/解决这个问题？还有什么我应该尝试的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T13:53:26.860

试试[真正的 X 鼠标](http://fy.chalmers.se/~appro/nt/TXMouse/)。至少视觉工作室不会再偷走焦点了。但是，您可能不喜欢它引入的复制和过去行为，而且弹出窗口通常不会出现在 Visual Studio 中（使用 alt-tab 来查找它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T14:30:51.747

我注意到 Visual Studio 似乎只在“文档”在 VS 中具有焦点时自动引发。如果您在 VS 中选择 Find Results 窗口或解决方案资源管理器，则不会发生自动引发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-19T10:42:23.097

我知道这个问题已经很老了，但它仍然出现在 VS2019 中，而且当有人搜索“自动提升”时，这个线程是第一个点击。
就我而言，我通过注册表启用了 X-mouse，并且不得不忍受这种行为很长一段时间。
几天前，当您将鼠标悬停在窗口上时，我找到了 Visual Studio 自动提升自身的解决方案：（
`Options -> Environment -> Tabs and Windows -> uncheck both entries under 'Floating Windows'.`
'浮动选项卡井保持在顶部'和'浮动工具窗口保持在顶部'）

# c# - C# 中的慢树视图

> ID：121112
> 
> 赞同：11
> 
> 时间：2008-09-23T13:49:58.867
> 
> 标签：c#, winforms, user-interface, optimization

我有一个用 C# 编写的遗留应用程序，它显示了一个非常复杂的树视图，其中包含 10 到 2 万个元素。

过去我遇到过类似的问题（但在 C++ 中），我使用 Win32 API 提供的 OWNERDATA 功能解决了这个问题。

C#中是否有类似的机制？

编辑：计划是优化创建时间和浏览时间。通过 Win32 API 提供的方法在这两种情况下都非常出色，因为它将初始化时间减少到零，并且对元素的请求数量仅限于任何时候可见的元素。乔什：我们实际上已经在按照您的建议做，但我们仍然需要更高的效率。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-23T13:53:11.433

提高性能的一种技术是在用户展开树视图时加载 TreeNode。通常，用户不需要同时在其屏幕上打开 20,000 个节点。仅加载用户需要查看的关卡，以及正确向用户显示可供性所需的任何子信息（如果存在子，则展开图标、计数、图标等）。当用户扩展节点时，及时加载子节点。

来自 Keith 的有用提示：使用 winforms TreeView，您需要至少有一个子节点，否则它不会显示展开 [+]，但随后您处理 TreeNodeExpanded 事件以删除该虚拟节点并填充子节点。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-23T15:04:25.100

在我们的主要 WinForm 应用程序中，我们一次性加载了一个树视图：

*   开始更新（）
*   加载 20.000 个节点
*   结束更新（）

到目前为止，性能仍然不错。它实际上是我们不会用第三方替换的少数组件之一。

以我的经验，当您在不调用 Begin/EndUpdate() 的情况下加载节点（一次性或按需）时，TreeView 性能会变慢，特别是如果您的节点已排序，但如果您正确调用 Begin/EndUpdate()，您不应该真正得到与组件本身相关的性能问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-23T14:08:37.277

我不相信 .NET TreeView 支持您想要的，尽管 .NET 的 DataGridView 支持这种类型的模型（请参阅 DataGridView 的[VirtualMode](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.virtualmode.aspx)属性）。TreeView 将允许您绘制自己的节点，但不允许您从某个虚拟商店填充它们。

如果可能，您可能需要考虑为您的应用程序使用 DataGridView。如果没有，手动管理节点（如上面提到的 joshl）可能会起作用，如果您可以解决一些在扩展节点时正确刷新屏幕的问题。除此之外，您可能想查看一些第三方供应商，例如[（Divelements SandGrid）](http://www.divelements.co.uk/net/controls/sandgrid/)，它们可能（强调可能）支持您想要的操作模式。

注意：截至 2013 年 7 月，Divelements 不支持 SandGrid。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-23T14:27:59.367

*注意：此答案因提问者的编辑而无效，他说他已经做过这种事情，但我决定仍然发布它以供其他人在此主题上搜索以供将来参考*

当我过去做过类似的事情时，我倾向于选择天真的延迟加载风格。

*   使用该`TreeNode.Tag`属性来保存可用于查找子项的引用
*   使用`TreeView.BeforeExpand`事件填充子节点
*   可以选择使用`TreeView.AfterCollapse`事件来删除它们。
*   为了让 [+]/[-] 框出现，我发现的最好方法是创建一个单例虚拟对象`TreeNode`，将其作为子节点添加到所有未填充的节点，然后在填充之前检查它是否存在`BeforeExpand`。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-23T14:18:26.490

有一种方法可以使 TreeView 性能更好，那就是创建所有子节点并将它们连接在一起**，然后**将节点添加到 TreeView。如果是我们正在谈论的图形性能。

```
TreeView tree = new TreeView();
TreeNode root = new TreeNode("Root");
PopulateRootNode(root); // Get all your data
tree.Nodes.Add(root); 
```

**否则，使用OnTreeNodeExpanded 逐个**节点加载它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T14:49:47.397

对于Windows C#编程中的大数据，无论是WPF还是WinForms，我传统上都是动态添加节点的。我将初始树根 + 孩子 + 孙子深度加载。当任何节点展开时，我会加载代表展开节点的孙子节点的树节点（如果有的话）。

这种模式也适用于数据检索。如果您真正从数千或数百万条记录的源中加载数据，您可能不想预先加载所有这些。没有用户愿意等待加载，也没有理由加载可能永远不会查看的数据。

我通常会根据需要在后台线程上加载孙子或曾孙节点数据，然后将这些数据编组回 UI 线程并创建和添加节点。这使 UI 具有响应性。您可以在视觉上装饰树节点以指示它们仍在加载，以应对用户领先于您的 IO 到数据存储的情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-23T13:51:02.800

这对我有用（CSharp）：

```
 Visible = false;
    ...
    Visible = true; 
```

在我的情况下（2000 个节点），加载树只需要 1~2 秒，这比任何其他方式都快得多。它可能在 C++ 中运行良好。

# dll - 如何从托管 DLL 获取可执行路径

> ID：121116
> 
> 赞同：4
> 
> 时间：2008-09-23T13:50:55.773
> 
> 标签：dll, path, c++-cli, executable

我有一个托管 DLL（用 C++/CLI 编写），其中包含 C# 可执行文件使用的类。在类的构造函数中，我需要访问引用 DLL 的可执行文件的完整路径。在实际的应用程序中，我知道我可以使用 Application 对象来执行此操作，但如何从托管 DLL 执行此操作？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-23T13:53:50.730

```
Assembly.GetCallingAssembly() 
```

或者

```
Assembly.GetExecutingAssembly() 
```

或者

```
Assembly.GetEntryAssembly() 
```

取决于你的需要。

然后使用 Location 或 CodeBase 属性（我不记得是哪一个）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T15:26:25.263

@leppie：谢谢-那是我需要的指针。

供将来参考，在 C++/CLI 中，这是有效的实际语法：

```
String^ appPathString = Assembly::GetEntryAssembly()->Location; 
```

`GetExecutingAssembly()`提供了 DLL 的名称

`GetCallingAssembly()`返回类似 System.Windows.Forms

`GetEntryAssembly`返回完整路径，类似于`GetModulePath()`Win32 下。

# web-services - 国家、州、省 Web 服务？

> ID：121117
> 
> 赞同：16
> 
> 时间：2008-09-23T13:50:58.707
> 
> 标签：web-services, lookup-tables

是否有任何好的网络服务可以为国家和州/省提供良好的查找信息？

如果是这样，你用什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-26T19:19:51.643

[http://www.geonames.org/](http://www.geonames.org/)

这是我找到的最好的。他们让您自己下载和托管网络服务，这也很好。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-23T13:57:46.693

如果您只需要美国信息，美国邮政服务提供了一组 Web 服务，它为此确切地调用了 WebTools。 [https://www.usps.com/business/web-tools-apis/welcome.htm](https://www.usps.com/business/web-tools-apis/welcome.htm)。您需要注册才能使用它们，但是一旦您注册它们就非常易于使用。您只需通过 HTTP 发送一个 XML 请求，然后服务器返回一个 XML 响应，您只需解压缩它。

样品要求：

```
http://SERVERNAME/ShippingAPITest.dll?API=Verify&XML=<AddressValidateRequest%20USERID="xxxxxxx"><Address ID="0"><Address1></Address1><Address2>6406 Ivy Lane</Address2><City>Greenbelt</City><State>MD</State><Zip5></Zip5><Zip4></Zip4></Address></AddressValidateRequest> 
```

示例响应：

```
<?xml version="1.0"?>
<AddressValidateResponse>
     <Address ID="0">
         <Address2>6406 IVY LN</Address2>
         <City>GREENBELT</City>
         <State>MD</State>
         <Zip5>20770</Zip5>
         <Zip4>1441</Zip4>
     </Address>
</AddressValidateResponse> 
```

这是技术文档的链接： [https ://www.usps.com/business/web-tools-apis/documentation-updates.htm](https://www.usps.com/business/web-tools-apis/documentation-updates.htm)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-27T02:07:20.353

与 .Net 配合良好的服务（因为它利用 WSDL）是[http://www.webservicex.net](http://www.webservicex.net)。[他们在http://www.webservicex.net/uszip.asmx](http://www.webservicex.net/uszip.asmx)提供美国邮政编码服务。您可以将其添加为服务，Visual Studio 将负责其余的工作。响应以 XML 响应的形式出现，因此您必须对其进行解析，但您可以使用简单的东西，例如`USZIP.GetInfoByZIP(ZIP).SelectSingleNode("//STATE").InnerText`.

然后，对于我的应用程序，我按照以下说明使用 XML 构建了数据的内存缓存：[http](http://www.15seconds.com/issue/010410.htm) ://www.15seconds.com/issue/010410.htm 。我使用 XML 而不是 a `HashTable`or`Dictionary(TKey, TValue)`因为我希望能够将其序列化为字符串，以便可以将“数据库”保存为用户设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T14:05:15.303

美国人口普查局的[TIGER 数据集](http://www.census.gov/geo/www/tiger/)是一个很好的地理数据来源，包括美国的查找和地图数据。他们不再主动跟踪邮政编码数据，但他们确实有一个[1999 年的老式文件](http://www.2010census.biz/geo/www/tiger/zip1999.html)仍然可用。

对于国家/地区，ISO 国家/地区代码列表是公开的。

我不知道美国以外的信息资源。

# keyboard - 中间有数字键盘的键盘？

> ID：121119
> 
> 赞同：3
> 
> 时间：2008-09-23T13:51:12.030
> 
> 标签：keyboard, ergonomics

我患有早期 RSI 症状，正在寻找避免受伤的方法。我的物理治疗师已经确定，我似乎做的最糟糕的事情就是以如此奇怪的角度使用我的鼠标。对我来说问题是，我保持键盘的位置使我的左前臂和右前臂的角度相同，即我的身体大致以 B 键为中心。在我当前的键盘（不是拆分键盘）上，这意味着宽 Enter 键、箭头键和数字键盘在我有空间放置鼠标之前都向右突出。我有一个中等宽度的框架，但即便如此，这让我的手腕在使用鼠标时处于一个非常尴尬的角度。我不想每次在两者之间切换时都不必将键盘推开，但我偶尔会使用数字键盘，所以我不想要没有它的键盘。

我认为在键盘的左右两半之间留出大约 30-50 厘米的空间会比较理想，这样我的手臂更垂直于我的锁骨，中间的箭头键和数字键盘，甚至可能这些数字呈 45 度角，因此我可以将它们配置为用任何一只手使用。

（如果你想知道的话，那就是一个带有触控笔的触摸屏，它有一个用于鼠标右键单击的修改按钮，因为否则鼠标垫会在我放置主行右半部分的地方，最多坐下时右臂的自然姿势。）

有了这么大的空间，您可以为通常使用两键组合的东西安装这么多自定义键……或者您可以将它们完全分离（除了一根电线），并且您知道，实际桌面显示出来。

你见过的最接近这个的键盘是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T14:06:39.980

我在左侧使用带有数字小键盘的键盘。这使我可以将鼠标靠近右侧，从而获得更自然的位置。我是右撇子。你可以看到我[在这里](http://www.keyboardco.com/shortboard/buy_the_lefty.asp)使用的键盘。

[![替代文字](https://i.stack.imgur.com/Q6iPy.jpg)](https://i.stack.imgur.com/Q6iPy.jpg)
[（来源：[keyboardco.com](http://www.keyboardco.com/shortboard/keyboard_images/beige_left_handed_ps2_usb_high_quality_keyboard_thumb.jpg)）]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T14:04:49.003

[http://www.thehumansolution.com/keyboards.html](http://www.thehumansolution.com/keyboards.html)

我一直在看一些键盘（我有严重的腕管）。Kinesis 键盘很不错，但中间有一些数字键盘。

[替代文字 http://us.st12.yimg.com/us.st.yimg.com/I/thehumansolution_2020_3491616](http://us.st12.yimg.com/us.st.yimg.com/I/thehumansolution_2020_3491616)

[替代文字 http://us.st12.yimg.com/us.st.yimg.com/I/thehumansolution_2016_1198996](http://us.st12.yimg.com/us.st.yimg.com/I/thehumansolution_2016_1198996)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T14:05:29.203

根据 Joel Coehoorn 的建议，我发现轨迹点（又名“乳头”）比触摸板更符合人体工程学。联想的[带有 UltraNav 的 USB 键盘](http://www-307.ibm.com/pc/support/site.wss/document.do?sitestyle=lenovo&lndocid=MIGR-45868)两者兼有。

不过，我的鼠标使用量很少，因为我专注于使用键盘来处理所有事情。在您的特定开发环境中，这可能并不容易。

[![替代文字](https://i.stack.imgur.com/aTJLx.jpg)](https://i.stack.imgur.com/aTJLx.jpg)
[（来源：[ibm.com](http://www-307.ibm.com/pc/support/site.wss/45940_usb_key.jpg)）]

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-23T14:05:45.380

只是一个建议。我也患有 RSI 症状，直到肩膀。我尝试过 MS 和罗技人体工学键盘，但均未成功。它甚至比以前更值得，因为老鼠比以前更远了。

然后我创建了[TypeMatrix 键盘](http://www.typematrix.com/ezr2030/dvorak.html)，它将我的 RSI 降低到几乎为零。

不幸的是，非美国或加拿大公民很难找到它们。

[![替代文字](https://i.stack.imgur.com/ViWnX.gif)](https://i.stack.imgur.com/ViWnX.gif)
[（来源：[typematrix.com](http://www.typematrix.com/ezr2030/images/qwerty_new.gif)）]

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T14:02:19.913

当我遇到一些牵涉痛问题时，我确实尝试了一段时间的[PCD Maltron](https://web.archive.org/web/20100830125810/http://www.maltron.com:80/maltron-about.html)键盘，但我从未真正习惯它。我是左撇子，所以我的鼠标离键盘很近。如果您的鼠标在右侧太远时遇到问题，您可以尝试使用小型键盘，例如[Happy Hacking 键盘](https://en.wikipedia.org/wiki/Happy_Hacking_Keyboard)和左侧或其他地方的[单独数字键盘，以获得更简洁的按键布局。](https://web.archive.org/web/20071215011110/http://www.nextag.com:80/numeric-pad/search-html)

我还学会了用双手使用鼠标——你也可以尝试学习用左手使用鼠标。

[替代文字 http://www.maltron.com/images/keyboards/maltron-usb-dual-l90-uk-mac-qwerty-gray-1-600.jpg](http://www.maltron.com/images/keyboards/maltron-usb-dual-l90-uk-mac-qwerty-gray-1-600.jpg) [（来源：][[geekstuff4u.com](http://www.geekstuff4u.com/images/HHKLB.jpg)][）][![替代文字](https://i.stack.imgur.com/CsZGn.jpg)](https://i.stack.imgur.com/CsZGn.jpg)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-23T14:13:57.967

几年前，我也有手腕问题。

对我有用的是改变我的姿势，我如何握住自己，我的手臂。我移动我的键盘和鼠标，我改变了我的位置和这两个的位置。此外，我经常使用键盘快捷键来避免过度使用鼠标。

这样，我在不更换键盘或鼠标的情况下摆脱了手腕问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-23T14:25:54.053

作为受苦的 RSI 同胞，我希望其中一个能有所帮助。

ErgoMagic 和 ErgoFlex 键盘分为 3 个部分，您可以将数字键盘放在中间。

ErgoFlex 采用扁平设计：

[http://www.safecomputingtips.com/blog/ergonomic-keyboard/ergoflex-keyboard/](http://www.safecomputingtips.com/blog/ergonomic-keyboard/ergoflex-keyboard/) [http://www.comfortkeyboard.com/keyboards_ergoflex.html](http://www.comfortkeyboard.com/keyboards_ergoflex.html)

[![替代文字](https://i.stack.imgur.com/C5jbK.jpg)](https://i.stack.imgur.com/C5jbK.jpg)
[（来源：[safecomputingtips.com](http://www.safecomputingtips.com/blog/wp-content/uploads/2008/02/ergoflex-keyboard.jpg)）]

ErgoMagic 的每个部分都有可调节的倾斜度：

[http://www.comfortkeyboard.com/keyboards_ergomagic.html](http://www.comfortkeyboard.com/keyboards_ergomagic.html)

[![替代文字](https://i.stack.imgur.com/k4t2P.jpg)](https://i.stack.imgur.com/k4t2P.jpg)
[（来源：[comfortkeyboard.com](http://www.comfortkeyboard.com/images/keyboard_ergomagic.jpg)）]

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-23T17:07:15.443

键盘的主要问题不是键盘布局或外形，键盘的主要问题是布局。我有非常严重的 RSI 问题，以至于我几乎无法打字（只有在接受严重疼痛时！）两个星期。我有 3 周不能触摸键盘，直到它终于好转。在那之后，问题总是时不时地回来。我也尝试了不同的键盘。我有一个 GoldTouch 分体式键盘，一个 Microsoft Natural 分体式键盘，我什至还有 Gizmo 提到的 TypeMatrix 键盘，但这些都没什么帮助。

然后我发现了[Dvorak 布局](http://en.wikipedia.org/wiki/Dvorak_Simplified_Keyboard)。起初我认为这是一个愚蠢的想法，但我选择了那条路。这是一项艰苦的培训，我花了很长时间，但现在它是我唯一一直使用的，因为它是我唯一可以为我们的打字机打字而没有任何 RSI 症状的。起初情况似乎变得更糟，但这只是因为新的布局会导致新的手指运动。

最近我发现[Colemak](http://colemak.com/)是 QWERTY 的另一种替代品，它似乎比 Dvorak 更有前途；我只是想学习它......我又遇到了困难。

比更换键盘更能帮助我的另一件事是更换鼠标。我不再使用鼠标，我使用的是轨迹球。

[![替代文字](https://i.stack.imgur.com/INbkt.jpg)](https://i.stack.imgur.com/INbkt.jpg)
[（来源：[arstechnica.com](http://members.arstechnica.com/x/archangelha/logitech-trackball.jpg)）]

在我尝试了很多键盘之后（我家里有 20 多个，别开玩笑了！）我继续使用 Microsoft Natural 4000 键盘。它可能很大，但我可以很好地打字。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T13:56:25.433

我不知道有这样的键盘，但可能有帮助的是带有内置触摸板（如笔记本电脑）的键盘，您可以使用它代替其他鼠标进行*一些*鼠标操作：小调整、快速点击点击等，以避免不得不离开鼠标。

# asp.net - 保护 Web 服务

> ID：121123
> 
> 赞同：8
> 
> 时间：2008-09-23T13:51:44.073
> 
> 标签：asp.net, web-services, security

我的生产 Web 服务器上有一个带有一些 Web 方法的 Web 服务 (ASMX)。在一个单独的内部 Web 服务器（未公开）上，我有另一个 Web 站点将使用 ASMX 的公共 Web 方法。保护 Web 服务的最佳方法有哪些，以便只有内部 Web 服务器才能访问在公开的 Web 服务器上运行的 Web 服务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T13:57:26.540

最简单的方法之一是在消息的 soap 标头中传递凭据。因此，每个调用都会传递确定用户是否被授权所需的信息。WSE 使其中一些变得更容易，但可以在 Rocky Lhotka 的关于 Business Objects 的书中找到对该过程最简洁的描述之一。我有很多书要出版商审阅，而这本书有最好的解释

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T13:54:25.033

假设您没有使用 WCF 的选项，我建议您使用 WSE 3（Web 服务增强）。[您可以在MS 的网站上](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=018A09FD-3A74-43C5-8EC1-8D789091255D&displaylang=en)获得工具包 / SDK的东西

为了限制对内部机器的访问（正如我认为你的问题所问的那样），我在 IIS 中建立了一个单独的网站，并将其设置为只响应你服务器的内部 IP 地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T13:55:01.367

我会设置防火墙规则来限制对 IP 地址白名单的访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T13:55:11.023

使用 IIS 的[目录安全 IP 地址限制](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/4117d9e2-c7e0-46db-88f6-6e804b4325b0.mspx?mfr=true)，并限制对内部 Web 服务器 IP 地址的访问。

如果你不能这样做，并且你不能在目录上设置用户名/密码，那么使用 WSE 并将用户名/密码添加到服务中，或者如果你想要一些有趣的*笑容，可以查看证书*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T13:55:21.067

也许我没有正确理解，但是如果 Web 方法只会被内部服务器使用，为什么还要公开公开它们呢？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T13:57:17.040

一个简单的 HTTP 模块就可以工作。只需硬编码（或从配置）允许的 IP/主机并拒绝所有其他 IP/主机。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T14:10:53.027

如果只有内部服务器将访问 asmx 文件？您可以在 IIS 中将它们设置在单独的网站或虚拟目录下，然后在该站点上设置一些 IP 限制。在属性中，进入目录安全性，然后是“IP 地址和域名限制”。

此外，对于密码，WSE 3 是新的首选，但我确实在 Apress 的一本名为“Pro ASP.NET 2.0 in C# 2005”第 34 章的书中找到了一个简单的方法。（注意，这本书的较新版本省略了本章。）该部分是自定义的基于票证的身份验证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T13:55:56.230

此时此刻，我想到的是 IIS 上的 IP 过滤。快速应用，应该适用于您的场景。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T13:56:24.903

带有客户端证书的 TLS。请参阅[Wikipedia 条目](http://en.wikipedia.org/wiki/Secure_Sockets_Layer#Client-Authenticated_TLS_handshake)以开始使用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T14:00:59.900

请注意，[有一些方法](http://www.sensepost.com/research/reDuh/)可以将IP 列入白名单。不要误会我的意思，这是一个好主意，你当然应该这样做，但如果你的预算/资源允许，你可以扩展你的威胁模型。

# macos - 确定目录是 Mac OS X 终端中的捆绑包还是包？

> ID：121147
> 
> 赞同：4
> 
> 时间：2008-09-23T13:55:20.383
> 
> 标签：macos, terminal

我希望能够确定从 Finder 在命令行的角度来看，诸如“.app”之类的目录是否被视为一个包或捆绑包。我认为用一个小的 shell 程序来做这件事并不难，但如果我不需要的话，我宁愿不重新发明轮子。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T06:00:49.890

这有点晚了，但是：您似乎可以使用 mdls 命令检测捆绑包。具体来说，（多行）输出：

```
mdls -name kMDItemContentTypeTree /Path/To/Directory 
```

将包含字符串

```
"com.apple.package" 
```

（包括引号，至少从 Lion 开始）如果目录是一个包。如果包也是一个包，输出也将包含

```
"com.apple.bundle" 
```

最后但并非最不重要的一点是，如果它专门是一个应用程序包，则输出还将包含

```
"com.apple.application-bundle" 
```

（这是根据一些非常有限的测试，但从 Apple 关于统一类型标识符的文档和 mdls 的手册页来看，这应该是正确的。对于我测试的项目，对于非 Apple 提供的捆绑包也是如此，考虑到尿路感染的目的，这是您所期望的。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T15:24:15.707

虽然您可以根据“./contents/Info.plist”的存在来识别某些包，但并非所有包类型（例如文档和旧包）都需要它。Finder 还根据文件扩展名将目录识别为包（.app、.bundle 等）或者如果设置了捆绑位。

要从命令行检查捆绑位，请使用：

```
getFileInfo -aB directory_name 
```

为了抓住所有情况，我会检查：

*   捆绑位设置了吗？
*   如果没有，它是否具有将其标识为捆绑包的文件扩展名？（见[Mecki 的回答](https://stackoverflow.com/questions/121147/determine-if-a-directory-is-a-bundle-or-package-in-the-mac-os-x-terminal#122426)）
*   如果不是，它可能不是一个捆绑包。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T17:23:54.000

## 更新：

在所有具有 Spotlight 的系统上，使用`mdls`您可以检测查看 kMDItemContentTypeTree 属性的包。例如：

```
mdls -name kMDItemContentTypeTree "/Applications/Safari.app" 
```

为我产生以下输出

```
kMDItemContentTypeTree = (
    "com.apple.application-bundle",
    "com.apple.application",
    "public.executable",
    "com.apple.localizable-name-bundle",
    "com.apple.bundle",
    "public.directory",
    "public.item",
    "com.apple.package"
) 
```

每当你看到`com.apple.package`那里时，它应该被 Finder 显示为一个包。当然，名称中带有“bundle”的所有内容都暗示已经但并非所有包都是捆绑包（捆绑包是具有明确定义的目录结构的包的特定子集）。

* * *

## 老答案：

您可以使用以下命令（Leopard 之前的 OS X）获取所有已注册文件类型扩展名的列表：

```
/System/Library/Frameworks/ApplicationServices.framework/Frameworks\
/LaunchServices.framework/Support/lsregister -dump 
```

或对于 Leopard 及更高版本：

```
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks\
/LaunchServices.framework/Versions/A/Support/lsregister -dump 
```

那里的每个文件扩展名都有标志。如果设置了包标志，则这是一个包。

例如

```
 claim   id:            806354944
            name:          Bundle
            role:          none
            flags:         apple-internal  relative-icon-path  package  
            icon:          Contents/Resources/KEXT.icns
            bindings:      .bundle
    --------------------------------------------------------
    claim   id:            1276116992
            name:          Plug-in
            role:          none
            flags:         apple-internal  relative-icon-path  package  
            icon:          Contents/Resources/KEXT.icns
            bindings:      .plugin 
```

将此与没有捆绑的文件进行比较

```
 claim   id:            2484731904
            name:          TEXT
            role:          viewer
            flags:         apple-internal  
            icon:          
            bindings:      .txt, .text, 'TEXT' 
```

真正获得所有捆绑包的唯一方法是在 LaunchService 数据库中查找（我们在上面转储的那个）。如果你只看它是否有 plist 或者是否设置了 bundle 位，你可能会捕获一些甚至许多 bundle，但你不能捕获所有这些。这是 Finder 用来确定的数据库

*   这个目录是不是一个捆绑包？
*   这是一个已知的文件扩展名吗？
*   此文件类型的“打开方式”下应列出哪些应用程序？
*   我应该使用哪个图标来显示此文件类型？

还有更多的东西。

[编辑：添加了 Leopard 的路径，感谢 Hagelin 的更新]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T18:12:26.917

`<plug>`

我的[启动](http://web.sabi.net/nriley/software/#launch)工具有一个功能。例如：

```
% launch -f Guards.oo3 
Guards.oo3: non-application package 
    type: ''    creator: ''
    kind: OmniOutliner 3
    content type ID: com.omnigroup.omnioutliner.oo3-package
    contents: 1 item
    created: 3/6/09 3:36:50 PM
    modified: 3/6/09 4:06:13 PM
    accessed: 4/12/09 1:10:36 PM [only updated by Mac OS X]
    backed up: 12/31/03 6:00:00 PM

% launch -f /Applications/Safari.app
/Applications/Safari.app: scriptable Mac OS X application package 
    type: 'APPL'    creator: 'sfri'
    architecture: PowerPC 7400, Intel 80x86
    bundle ID: com.apple.Safari
    version: 4 Public Beta
    kind: Application
    content type ID: com.apple.application-bundle
    contents: 1 item
    created: 8/21/07 5:11:33 PM
    modified: 2/24/09 7:29:51 PM
    accessed: 4/12/09 1:10:51 PM [only updated by Mac OS X]
    backed up: 12/31/03 6:00:00 PM 
```

您应该能够通过检查输出的第一行是否以“package”结尾来获得所需的内容。

`launch`也在 Fink 和 MacPorts 中。

`</plug>`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T18:07:20.283

应该有一种方法可以从命令行轻松完成，因为作为 AppleScript 用户，我可以使用系统事件来完成。因此，如果一切都失败了，您可以从命令行执行必要的 AppleScript，如下所示：

```
$ FILE=/Users/myuser/Desktop/foo.rtfd
$ osascript -e "tell application \"System Events\" to get package folder of alias POSIX file \"${FILE}\"" 
```

结果是

```
true 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-23T14:03:28.507

一个包应该总是有一个文件`./contents/Info.plist'。您可以在目录中检查它是否存在，如果存在，则它是一个包/捆绑包。

# c++ - 显式关键字是什么意思？

> ID：121162
> 
> 赞同：3355
> 
> 时间：2008-09-23T13:58:45.630
> 
> 标签：c++, constructor, explicit, c++-faq, explicit-constructor

`explicit`C++中的关键字是什么意思？

* * *

## 回答 #1

> 赞同：3824
> 
> 时间：2008-09-23T13:59:04.413

允许编译器进行一次隐式转换以将参数解析为函数。这意味着编译器可以使用可通过**单个参数**调用的构造函数从一种类型转换为另一种类型，以便为参数获取正确的类型。

这是一个带有构造函数的示例类，可用于隐式转换：

```
class Foo
{
private:
  int m_foo;

public:
  // single parameter constructor, can be used as an implicit conversion
  Foo (int foo) : m_foo (foo) {}

  int GetFoo () { return m_foo; }
}; 
```

`Foo`这是一个接受对象的简单函数：

```
void DoBar (Foo foo)
{
  int i = foo.GetFoo ();
} 
```

这里`DoBar`是调用函​​数的地方：

```
int main ()
{
  DoBar (42);
} 
```

参数不是一个`Foo`对象，而是一个`int`. 但是，存在一个构造函数，`Foo`因此`int`该构造函数可用于将参数转换为正确的类型。

允许编译器对每个参数执行一次。

为构造函数添加关键字前缀`explicit`可防止编译器使用该构造函数进行隐式转换。将其添加到上述类中会在函数调用处产生编译器错误`DoBar (42)`。现在有必要使用显式调用转换 `DoBar (Foo (42))`

您可能想要这样做的原因是避免可能隐藏错误的意外构造。
人为的例子：

*   您有一个`MyString`带有构造函数的类，该构造函数构造给定大小的字符串。您有一个函数`print(const MyString&)`（以及一个重载`print (char *string)`），并且您调用`print(3)`（当您*实际*打算调用时`print("3")`）。您希望它打印“3”，但它会打印一个长度为 3 的空字符串。

* * *

## 回答 #2

> 赞同：1246
> 
> 时间：2008-09-23T14:09:06.917

假设，你有一个类`String`：

```
class String {
public:
    String(int n); // allocate n bytes to the String object
    String(const char *p); // initializes object with char *p
}; 
```

现在，如果您尝试：

```
String mystring = 'x'; 
```

该字符`'x'`将被隐式转换为`int`，然后`String(int)`将调用构造函数。但是，这可能不是用户想要的。因此，为了防止这种情况，我们将构造函数定义为`explicit`：

```
class String {
public:
    explicit String (int n); //allocate n bytes
    String(const char *p); // initialize sobject with string p
}; 
```

* * *

## 回答 #3

> 赞同：176
> 
> 时间：2008-09-23T16:37:12.770

在 C++ 中，只有一个必需参数的构造函数被视为隐式转换函数。它将参数类型转换为类类型。这是否是一件好事取决于构造函数的语义。

例如，如果您有一个带有 constructor 的字符串类`String(const char* s)`，那可能正是您想要的。您可以将 a 传递`const char*`给期望 a 的函数`String`，编译器会自动`String`为您构造一个临时对象。

另一方面，如果您有一个缓冲区类，其构造函数`Buffer(int size)`以字节为单位获取缓冲区的大小，您可能不希望编译器悄悄地将`int`s 转换为`Buffer`s。为了防止这种情况，您使用`explicit`关键字声明构造函数：

```
class Buffer { explicit Buffer(int size); ... } 
```

那样，

```
void useBuffer(Buffer& buf);
useBuffer(4); 
```

成为编译时错误。如果你想传递一个临时`Buffer`对象，你必须明确地这样做：

```
useBuffer(Buffer(4)); 
```

总之，如果您的单参数构造函数将参数转换为您的类的对象，您可能不想使用`explicit`关键字。但是如果你有一个构造函数只是碰巧接受一个参数，你应该声明它`explicit`以防止编译器意外转换让你感到惊讶。

* * *

## 回答 #4

> 赞同：56
> 
> 时间：2015-07-10T23:48:58.157

### 关键字`explicit`伴随着

*   **类 X 的构造函数，不能用于将第一个（任何唯一）参数隐式转换为 X 类型**

> **C++ [class.conv.ctor]**
> 
> 1) 没有函数说明符显式声明的构造函数指定从其参数类型到其类的类型的转换。这样的构造函数称为转换构造函数。
> 
> 2) 显式构造函数像非显式构造函数一样构造对象，但仅在显式使用直接初始化语法 (8.5) 或强制类型转换 (5.2.9, 5.4) 的情况下这样做。默认构造函数可以是显式构造函数；这样的构造函数将用于执行默认初始化或值初始化（8.5）。

*   **或仅考虑直接初始化和显式转换的转换函数。**

> **C++ [class.conv.fct]**
> 
> 2) 转换函数可能是显式的（7.1.2），在这种情况下，它只被视为用户定义的直接初始化转换（8.5）。否则，用户定义的转换不限于在赋值和初始化中使用。

### 概述

显式转换函数和构造函数只能用于显式转换（直接初始化或显式转换操作），而非显式构造函数和转换函数可用于隐式和显式转换。

```
/*
                                 explicit conversion          implicit conversion

 explicit constructor                    yes                          no

 constructor                             yes                          yes

 explicit conversion function            yes                          no

 conversion function                     yes                          yes

*/ 
```

### `X, Y, Z`使用结构和函数的示例`foo, bar, baz`：

`explicit`让我们看一下结构和函数的小设置，以了解转换和非`explicit`转换之间的区别。

```
struct Z { };

struct X { 
  explicit X(int a); // X can be constructed from int explicitly
  explicit operator Z (); // X can be converted to Z explicitly
};

struct Y{
  Y(int a); // int can be implicitly converted to Y
  operator Z (); // Y can be implicitly converted to Z
};

void foo(X x) { }
void bar(Y y) { }
void baz(Z z) { } 
```

### 有关构造函数的示例：

函数参数的转换：

```
foo(2);                     // error: no implicit conversion int to X possible
foo(X(2));                  // OK: direct initialization: explicit conversion
foo(static_cast<X>(2));     // OK: explicit conversion

bar(2);                     // OK: implicit conversion via Y(int) 
bar(Y(2));                  // OK: direct initialization
bar(static_cast<Y>(2));     // OK: explicit conversion 
```

对象初始化：

```
X x2 = 2;                   // error: no implicit conversion int to X possible
X x3(2);                    // OK: direct initialization
X x4 = X(2);                // OK: direct initialization
X x5 = static_cast<X>(2);   // OK: explicit conversion 

Y y2 = 2;                   // OK: implicit conversion via Y(int)
Y y3(2);                    // OK: direct initialization
Y y4 = Y(2);                // OK: direct initialization
Y y5 = static_cast<Y>(2);   // OK: explicit conversion 
```

### 关于转换函数的示例：

```
X x1{ 0 };
Y y1{ 0 }; 
```

函数参数的转换：

```
baz(x1);                    // error: X not implicitly convertible to Z
baz(Z(x1));                 // OK: explicit initialization
baz(static_cast<Z>(x1));    // OK: explicit conversion

baz(y1);                    // OK: implicit conversion via Y::operator Z()
baz(Z(y1));                 // OK: direct initialization
baz(static_cast<Z>(y1));    // OK: explicit conversion 
```

对象初始化：

```
Z z1 = x1;                  // error: X not implicitly convertible to Z
Z z2(x1);                   // OK: explicit initialization
Z z3 = Z(x1);               // OK: explicit initialization
Z z4 = static_cast<Z>(x1);  // OK: explicit conversion

Z z1 = y1;                  // OK: implicit conversion via Y::operator Z()
Z z2(y1);                   // OK: direct initialization
Z z3 = Z(y1);               // OK: direct initialization
Z z4 = static_cast<Z>(y1);  // OK: explicit conversion 
```

### 为什么要使用`explicit`转换函数或构造函数？

**转换构造函数和非显式转换函数可能会引入歧义。**

考虑一个结构`V`, 可转换为`int`, 一个结构`U`隐式可构造 from`V`和一个函数分别为和`f`重载。`U``bool`

```
struct V {
  operator bool() const { return true; }
};

struct U { U(V) { } };

void f(U) { }
void f(bool) {  } 
```

`f`如果传递类型为 的对象，则调用是不明确的`V`。

```
V x;
f(x);  // error: call of overloaded 'f(V&)' is ambiguous 
```

编译器不知道是使用 的构造函数`U`还是转换函数将`V`对象转换为类型以传递给`f`。

如果 的构造函数`U`或转换函数`V`是`explicit`，则不会有歧义，因为只会考虑非显式转换。如果两者都是显式的，则必须使用显式转换或强制转换操作来调用`f`使用类型的对象。`V`

**转换构造函数和非显式转换函数可能会导致意外行为。**

考虑一个打印一些向量的函数：

```
void print_intvector(std::vector<int> const &v) { for (int x : v) std::cout << x << '\n'; } 
```

如果向量的大小构造函数不明确，则可以像这样调用函数：

```
print_intvector(3); 
```

人们对这样的电话有何期待？一行包含`3`或三行包含`0`？（第二个是发生了什么。）

### 在类接口中使用显式关键字会强制接口的用户明确说明所需的转换。

正如 Bjarne Stroustrup 所说（在“The C++ Programming Language”，第 4 版，35.2.1，第 1011 页）关于为什么`std::duration`不能从普通数字隐式构造的问题：

> 如果您知道自己的意思，请明确说明。

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2013-10-08T14:43:46.483

这个答案是关于有/没有显式构造函数的对象创建，因为它没有包含在其他答案中。

考虑以下没有显式构造函数的类：

```
class Foo
{
public:
    Foo(int x) : m_x(x)
    {
    }

private:
    int m_x;
}; 
```

Foo 类的对象可以通过两种方式创建：

```
Foo bar1(10);

Foo bar2 = 20; 
```

根据实现，实例化类 Foo 的第二种方式可能会令人困惑，或者不是程序员想要的。`explicit`为构造函数添加关键字前缀会在`Foo bar2 = 20;`.

*通常*将单参数构造函数声明为 是一种好习惯，`explicit`除非您的实现明确禁止它。

还要注意构造函数

*   所有参数的默认参数，或
*   第二个参数的默认参数

都可以用作单参数构造函数。所以你可能也想做这些`explicit`。

[如果您正在创建一个仿函数（查看此](https://stackoverflow.com/a/356993/793930)答案中声明的 'add_x' 结构），您故意***不***希望使您的单参数构造函数显式化的一个示例。在这种情况下，创建一个对象可能是有意义的。`add_x add30 = 30;`

[这](http://weblogs.asp.net/kennykerr/archive/2004/08/31/Explicit-Constructors.aspx)是关于显式构造函数的好文章。

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2012-11-21T02:36:55.113

关键字将`explicit`转换构造函数转换为非转换构造函数。因此，代码不易出错。

* * *

## 回答 #7

> 赞同：35
> 
> 时间：2013-05-14T09:28:39.317

-keyword可`explicit`用于强制*显式*调用构造函数。

```
class C {
public:
    explicit C() =default;
};

int main() {
    C c;
    return 0;
} 
```

`explicit`构造函数前面的-keyword`C()`告诉编译器只允许显式调用此构造函数。

`explicit`-keyword 也可用于用户定义的类型转换运算符：

```
class C{
public:
    explicit inline operator bool() const {
        return true;
    }
};

int main() {
    C c;
    bool b = static_cast<bool>(c);
    return 0;
} 
```

在这里，`explicit`-keyword 仅强制显式强制转换有效，因此`bool b = c;`在这种情况下将是无效强制转换。在这种情况下，`explicit`-keyword 可以帮助程序员避免隐式的、无意的强制转换。这种用法已在[C++11](http://en.cppreference.com/w/cpp/language/cast_operator)中标准化。

* * *

## 回答 #8

> 赞同：29
> 
> 时间：2016-08-20T12:45:16.803

Cpp 参考总是有帮助的！！！可以在[此处](http://en.cppreference.com/w/cpp/language/explicit)找到有关显式说明符的详细信息。您可能还需要查看[隐式转换](http://en.cppreference.com/w/cpp/language/implicit_conversion)和[复制初始化](http://en.cppreference.com/w/cpp/language/copy_initialization)。

快速浏览

> 显式说明符指定构造函数或转换函数（C++11 起）不允许隐式转换或复制初始化。

示例如下：

```
struct A
{
    A(int) { }      // converting constructor
    A(int, int) { } // converting constructor (C++11)
    operator bool() const { return true; }
};

struct B
{
    explicit B(int) { }
    explicit B(int, int) { }
    explicit operator bool() const { return true; }
};

int main()
{
    A a1 = 1;      // OK: copy-initialization selects A::A(int)
    A a2(2);       // OK: direct-initialization selects A::A(int)
    A a3 {4, 5};   // OK: direct-list-initialization selects A::A(int, int)
    A a4 = {4, 5}; // OK: copy-list-initialization selects A::A(int, int)
    A a5 = (A)1;   // OK: explicit cast performs static_cast
    if (a1) cout << "true" << endl; // OK: A::operator bool()
    bool na1 = a1; // OK: copy-initialization selects A::operator bool()
    bool na2 = static_cast<bool>(a1); // OK: static_cast performs direct-initialization

//  B b1 = 1;      // error: copy-initialization does not consider B::B(int)
    B b2(2);       // OK: direct-initialization selects B::B(int)
    B b3 {4, 5};   // OK: direct-list-initialization selects B::B(int, int)
//  B b4 = {4, 5}; // error: copy-list-initialization does not consider B::B(int,int)
    B b5 = (B)1;   // OK: explicit cast performs static_cast
    if (b5) cout << "true" << endl; // OK: B::operator bool()
//  bool nb1 = b2; // error: copy-initialization does not consider B::operator bool()
    bool nb2 = static_cast<bool>(b2); // OK: static_cast performs direct-initialization
} 
```

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2009-10-01T22:00:21.310

如前所述，使您的一个参数构造函数（包括具有默认值的构造函数）始终是一种很好的编码`arg2`实践`arg3`。像往常一样使用 C++：如果你不这样做 - 你会希望你这样做...

另一个类的好习惯是让复制构造和赋值私有（也就是禁用它），除非你真的需要实现它。这样可以避免在使用 C++ 默认为您创建的方法时最终获得指针副本。另一种方法是从`boost::noncopyable`.

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2015-01-23T09:26:52.817

构造函数附加隐式转换。为了抑制这种隐式转换，需要使用显式参数声明构造函数。

[在 C++11 中，您还可以使用这样的关键字http://en.cppreference.com/w/cpp/language/explicit](http://en.cppreference.com/w/cpp/language/explicit)指定“运算符类型（）”使用这样的规范，您可以在显式转换方面使用运算符，并且直接初始化对象。

PS 当使用由用户定义的转换（通过构造函数和类型转换运算符）时，只允许使用一级隐式转换。但是您可以将此转换与其他语言转换结合使用

*   提升积分等级（char 到 int，float 到 double）；
*   标准转换（int 到 double）；
*   将对象的指针转换为基类和 void*；

# javascript - Greasemonkey的隐藏功能

> ID：121167
> 
> 赞同：12
> 
> 时间：2008-09-23T13:59:36.753
> 
> 标签：javascript, greasemonkey

人们在他们的 Greasemonkey 脚本中使用了哪些鲜为人知但有用的功能和技术？

（请，每个答案只有一个功能。）

类似主题：

*   [JavaScript 的隐藏特性](https://stackoverflow.com/questions/61088/hidden-features-of-javascript)
*   [Java的隐藏特性](https://stackoverflow.com/questions/15496/hidden-features-of-java)
*   [C++的隐藏特性](https://stackoverflow.com/questions/75538/hidden-features-of-c)
*   [C#的隐藏特性](https://stackoverflow.com/questions/9033/hidden-features-of-c)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-27T20:34:26.400

```
==UserScript==
...
@require http://ajax.googleapis.com/ajax/framework-of-your/choice.js
==/UserScript== 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-09-23T15:06:50.663

Greasemonkey 脚本通常需要在页面上搜索内容。尝试使用 XPath 定位感兴趣的节点，而不是挖掘 DOM。该`document.evaluate()`方法允许您提供 XPath 表达式并将返回匹配节点的集合。这是一个很好的[教程](http://www-xray.ast.cam.ac.uk/~jgraham/mozilla/xpath-tutorial.html)，可以帮助您入门。例如，这是我编写的一个脚本，它导致 phpBB3 帖子中的链接在新选项卡中打开（在默认皮肤中）：

```
// ==UserScript==
// @name           New Tab in phpBB3
// @namespace      http://robert.walkertribe.com/
// @description    Makes links in posts in phpBB3 boards open new tabs.
// ==/UserScript==

var newWin = function(ev) {
    var win = window.open(ev.target.href);
    if (win) ev.preventDefault();
};

var links = document.evaluate(
        "//div[@class='content']//a[not(@onclick) and not(@href='#')]",
        document, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null);

for (var i = 0; i < links.snapshotLength; i++) {
    var link = links.snapshotItem(i);
    link.addEventListener("click", newWin, true);
} 
```

代码中使用的 XPath 表达式标识了以下所有`a`元素：1) 没有`onclick`属性，2) 其`href`属性未设置为`"#"`3) 在`div`s 中找到其`class`属性设置为`"content"`。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-24T15:31:44.667

即使您没有任何地方可以通过数据 URI 托管文件，您的脚本也可以将图形添加到页面中。

例如，这是一个小按钮图形：

```
var button = document.createElement("img");
button.src = "数据:图像/gif;base64,"
    + "R0lGODlhEAAQAKEDAAAA/wAAAMzMzP///yH5BAEAAAMALAAAAAAQABAAAAIhnI+pywOtwINHTmpvy3rx"
    + "nnABlAUCKZkYoGitJZzUTCMFACH+H09wdGltaXplZCBieSBVbGVhZCBTbWFydFNhdmVyIQAAOw=="
somenode.appendChild(按钮);

```

这是一个在线[图像编码器](http://www.scalora.org/projects/uriencoder/)。

还有一篇关于数据 URI 标准的[维基百科文章。](http://en.wikipedia.org/wiki/Data:_URI_scheme)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-23T14:06:37.577

数据可以通过`GM_setValue(keyname, value)`.

下面是一个简单的例子，它计算了你的脚本被给定浏览器执行的次数：

```
var od = GM_getValue("里程表", 0);
od++;
GM_setValue("里程表", od);
GM_log("里程表=" + od);

```

GM 值类似于 cookie，cookie 值只能由原始域访问，GM 值只能由创建它们的脚本访问。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-19T23:49:02.093

GM_setValue 通常只存储 32 位整数、字符串和布尔值，但您可以利用 uneval() 方法（以及稍后检索时的 eval()）来存储任何对象。如果您正在处理纯 JSON 值（而不是 JavaScript 对象），请使用 JSON.stringify 存储和 JSON.parse 检索；这将更快更安全。

```
var foo={people:['Bob','George','Smith','Grognak the Destroyer'],pie:true};
GM_setValue('myVeryOwnFoo',uneval(foo));
var fooReborn=eval(GM_getValue('myVeryOwnFoo','new Object()'));
GM_log('People: '+fooReborn.people+'   Pie:'+fooReborn.pie); 
```

在这种情况下，我倾向于使用“new Object()”作为我的默认值，但您也可以使用“({})”。请记住，“{}”计算为字符串，而不是对象。像往常一样， eval() 小心。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-23T14:27:16.063

匿名统计

假设您有一个提供访问日志的基本托管服务，您可以轻松跟踪脚本的基本使用统计信息。

1.  在您自己的网站上放置一个 gif 文件（例如，徽标图像）。
2.  在您的脚本中，将 img 元素附加到引用 gif 的页面：

```
var img = document.createElement("img");
img.src = "http://mysite.com/logo.gif";
document.body.appendChild(img);

```

现在，每次用户执行您的脚本时，您的托管服务都会在该 gif 文件上注册一次点击。

要跟踪多个脚本，请为每个脚本使用不同的 gif 文件。或者在 URL 中添加某种区分参数（例如：）`http://mysite.com/logo.gif?zippyver=1.0`。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-26T00:20:37.537

GreaseMonkey 脚本在 DOM 准备就绪时运行，因此您无需添加 onload 事件，您只需在 GreaseMonkey 脚本中立即开始操作 DOM。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-25T14:09:35.760

一个有用的 XPath 技术是指定相对于您已经找到的节点的匹配。作为stackoverflow的人为示例：

```
// 首先我们在页面顶部获得用户名链接
var hdrdiv = document.evaluate(
    "//div[@id='headerlinks']/a[1]", 文档, null,
    XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;

// 现在我们可以检索它后面的文本，（用户的信誉分数）
//（注意 hdrdiv 现在是 contextNode 参数，而不是文档）
var reptext = document.evaluate(
    "following-sibling::span", hdrdiv, null,
    XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;

alert("声誉分数：" + reptext.textContent);

```

您可以在相对于 contextNode、祖先、后代、上一个、下一个的任何方向上进行匹配。这是一个有用的 [XPath 参考](http://zvon.org/xxl/XSLTreference/Output/index.html)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-24T02:07:21.697

可以使脚本头值（@name、@description、@version 等）可检索。这比在脚本的多个位置保持相同的常量值更可取。

请参阅[从脚本中访问 Greasemonkey 元数据？](https://stackoverflow.com/questions/104568/accessing-greasemonkey-metadata-from-within-your-script#112148)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-01-06T21:33:24.247

**已过时：** Firefox 在 Greasemonkey 脚本中放弃了对 E4X 的支持，FF 版本为 17。`GM_info`用于获取元数据。

* * *

您可以使用 e4x 作为变量访问您的 ==UserScript== 信息：

```
var metadata=<> 
// ==UserScript==
// @name           search greasemonkey
// @namespace      foo
// @include        http://*.google.com/*
// @include        http://*.google.ca/*
// @include        http://search.*.com/*
// @include        http://*.yahoo.com/*
// ==/UserScript==
</>.toString(); 
```

# project-management - 为匿名工单提交配置 trac

> ID：121169
> 
> 赞同：4
> 
> 时间：2008-09-23T14:00:11.727
> 
> 标签：project-management, bug-tracking, trac, configure

如何配置 trac 以允许匿名提交票证？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T14:05:15.037

在您的 trac 配置中，您需要授予匿名用户 TICKET_CREATE 权限。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T14:05:55.707

转到 Admin > Permissions，然后授予“匿名”TICKET_CREATE 和 TICKET_MODIFY 权限（操作）。

见：[http ://trac.edgewall.org/wiki/TracPermissions](http://trac.edgewall.org/wiki/TracPermissions)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T14:05:16.490

设置一个 trac 站点以允许匿名（没有实际登录）登录。授予匿名用户仅创建票证的权限，如果您愿意，也可以查看现有票证。但拒绝所有其他权限。

trac 管理插件使这非常容易。

# visual-c++ - 是否还有 MFC 的案例

> ID：121184
> 
> 赞同：19
> 
> 时间：2008-09-23T14:04:13.760
> 
> 标签：visual-c++, mfc

MFC 有哪些引人注目的功能？为什么你会为一个新项目选择它？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-23T14:23:12.950

10 年前，MFC 是一个不错的选择。它仍然是 Win32 API 的一个很好的包装器，但不幸的是已经过时了。

[Qt](https://www.qt.io/)是一个更好的选择，它有一个很大的优势——它独立于平台。使用 MFC，您注定要使用 Windows。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-12T14:14:50.473

我仍然将 MFC 用于各种应用程序。MFC 从它的早期实现中得到了一个坏名声，但它现在非常好。我发现它也比 WTL 方便得多。此外，Visual Studio 中的 GUI 工具已经设置好，可以轻松使用 MFC 快速开发 GUI、将控件映射到变量、DDX 等。

对于我打算广泛分发的桌面应用程序，我仍然使用本机 Windows 应用程序，通常在 MFC 中，因为我们还没有到您可以依赖您的客户拥有您将使用的 .NET 版本的地步安装并要求他们安装它会导致您失去销售，更不用说由于试图让您的应用程序运行而在安装 .NET 时遇到问题时的客户服务头痛。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-23T14:07:15.500

MFC 的优点是它仍然比编写裸 win32 更好，并且您可以分发不需要 .Net 等 23-50Mb 运行时的本机 .exe。

现在，如果您担心这些事情，还有*更好*的选择：C++ Builder、WxWidgets 等。但有些地方不会考虑非 Microsoft 工具。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-23T14:08:54.483

您可以改写一下这个问题，为什么要为桌面应用程序选择 C++ 而不是 C#。C++ 仍然提供速度优势，这对某些应用程序很重要（我在一家为电子交易创建软件的公司工作。速度很重要）。

如果你打算只用 C++ 开发一个针对 Windows 的桌面应用程序，那么 MFC 是最成熟的选择，网上有很多基于 MFC 的免费代码，知识渊博。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-09-15T12:11:00.657

除了 win32 api 本身，MFC 是唯一一个在 15 年以上的 2011 年仍然活跃的主流 Windows 编程技术。早在 2001 年，每个人都说“MFC 已经死了，现在都是 Winforms”；2005 年每个人都说“MFC 已死，现在全是 XAML”；现在是 2011 年，Winforms 和 XAML 已经死了（好吧，XAML 可能并没有真正死去，但已经过了它的鼎盛时期），而 MFC 仍在更新最新的发展（功能区、Aero 扩展、Win7 API 等）。

当然，这并不能保证未来的任何事情，但是在这 15 年多的时间里，编写了*很多*MFC 代码，并且它将在未来十年或几十年内继续使用。它可能不是最漂亮的技术，但很容易理解（它的优点和缺点），并且不像其他炒作技术那样是一个移动目标，这意味着真正想要完成工作的人可以依赖它（更多无论如何，而不是替代品）。

（同样适用于 C++，顺便说一句）

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-09-23T14:18:20.950

这是一种可能性——想象一个需要大量内存的应用程序，比如图形程序、游戏或者一些高性能的商业应用程序。.NET 应用程序占用内存已不是什么秘密——在这种情况下，您可能需要一个精简的 MFC 应用程序作为应用程序的核心。您始终可以通过 COM 可调用包装器或直接通过 C++/CLI 加载和使用 .NET 组件、控件等。

话虽如此 - MFC 是一种痛苦。请考虑使用 WTL - 如果需要，您仍然可以调用 .NET，就像我上面提到的 MFC 一样。WTL 比 MFC 好很多 :-)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-23T14:08:39.693

显然，对于基于 Windows 的手持设备（例如销售点设备）的应用程序，它仍然是一个不错的选择。在这些资源中，资源是有限的，因此内存管理之类的事情变得更加重要。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-23T14:06:45.113

[MFC 新功能快速浏览](http://blogs.msdn.com/vcblog/archive/2007/11/09/quick-tour-of-new-mfc-functionality.aspx)

我听说他们有一个新的色带控件。如果您遇到这种复杂性。这是一个新生成的应用程序的屏幕截图：

[![](https://i.stack.imgur.com/mjNuC.jpg)](https://i.stack.imgur.com/mjNuC.jpg)
[（来源：[msdn.com](http://blogs.msdn.com/blogfiles/vcblog/WindowsLiveWriter/QuickTourOfNewMFCFunctionality_C777/Wizard%20Generated%20with%20accelerator%20tips_2.jpg)）]

真的，这只是一个小部件更新。那么我们需要更多的小部件吗？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-23T14:09:39.723

现有的 Windows API 完全基于 C。如果您想使用 C++（并且您可能应该），那么如果您希望保持原生（即不使用 .NET），那么 MFC 是合乎逻辑的选择。

MFC 只是 C API 之上的一组面向对象的类。加上不少额外的“帮助”类，可以更轻松地完成日常任务。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-23T14:31:43.103

我认为不会.. MFC 会输掉

*   抽象级别
*   开发时间
*   故障排除时间
*   新开发人员的学习曲线
*   面向未来（尽管现在这是有问题的……每 3-4 年就会有新的东西出现）
*   寻找了解他们的 MFC 的好人
*   易于使用的控件

MFC 可能会偷偷溜过去的唯一地方是，如果您有一些性能非常密集的应用程序，例如您在屏幕上有需要每 10 毫秒或 1 秒重绘一次的东西。“托管”应用程序仍然无法跨越这个障碍。

MFC 是演变中的重要一步，但现在有更好的选择。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-23T14:09:50.567

仅靠设计和技术优势？很抱歉是分类的，但没有。这是一个糟糕的设计，一个漏洞百出的抽象，你不得不回退到 Win32 API 编程，严重滥用 C++，并且坚定地针对过去的技术：你不会从现代的（甚至是有吸引力的！）用户体验中获得MFC 应用程序。如果您可以找到 C# 开发人员并且您没有严重的硬件限制，请使用 WinForms。

另一方面，外部因素，例如招聘能力、培训计划和第三方组件的可用性，仍然可以延长其生命周期，至少对于某些类型的应用程序而言：小而简单，针对用户相当少的特殊应用程序，最好是内部的。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-12T14:03:02.837

如果您使用 C++ 开发 Windows CE 和移动应用程序，正如 Einar 已经提到的，MFC 是一个不错的选择。如果您做出此选择，那么 MFC 也将成为桌面的合理选择，因为您可以在桌面和手持设备上使用相同的代码。在这种情况下，MFC 仍然具有良好的性能/易于实现组合。就个人而言，我在这些环境中将 MFC 与 Stingray 库结合使用，它提供了非常好的界面、良好的性能并且快速且易于实现。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-05-12T09:39:39.757

我会说速度和占用空间是 .NET 的好理由。

您可能确实会发现很难找到优秀的 MFC 程序员，但这同样是因为现代语言促进了惰性编程技术，并且大多数编程课程都倾向于他们，因为它们更容易教授。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-23T14:23:44.323

我已经编写跨平台代码多年，所以当我需要编写一些东西时，我总是在它之间有一个非常薄的抽象层，系统调用几乎所有东西，除了 posix 调用。这样，您可以将其编码到 MFC 中，但如果需要，稍后可以很容易地将其转换为不同的 API。我用于一切的基本 c++ 库集通过一个小型 System 类来实现。我目前使用适用于 Windows 的 MFC，也使用适用于 Linux 的 XWindows 和本机 Mac 版本。后来当我将它移植到手持设备上时，它应该很轻松。

如果您想看一看，它是 LGPL 的，位于：

[http://code.google.com/p/kgui/](http://code.google.com/p/kgui/)

# eclipse - 用引号括起来

> ID：121199
> 
> 赞同：36
> 
> 时间：2008-09-23T14:06:40.213
> 
> 标签：eclipse

在 Eclipse JDT 中如何将多行选择转换为字符串。像下面这样

从：

```
xxxx
yyyy
zzz 
```

至：

```
"xxxx " +
"yyyy " +
"zzz" 
```

我尝试了以下模板

```
"${line_selection}${cursor}"+ 
```

但这样我只能将整个街区包围，而不是单独包围每一行。如何实现多行处理，例如评论选定的块？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-09-23T14:50:46.007

也许这不是你的意思，但...

如果我在 Eclipse 中的一行中输入双引号，然后在其中粘贴多行选择（如您的 xyz 示例），它将像这样粘贴：

```
"xxxx\n" +   
"yyyy\n" +  
"zzz" 
```

然后，如果您不打算使用换行符，则可以在`"\n"`to的选择中查找/替换。`""`

我认为启用此功能的选项位于`Window/Preferences`下`Java/Editor/Typing/`，选中旁边的框`"Escape text when pasting into a string literal"`。( `Eclipse 3.4 Ganymede`)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T14:38:17.750

在打开正则表达式选项的情况下查找/替换。寻找：

```
^(.*)$ 
```

用。。。来代替：

```
"$1" + 
```

好吧，最后一行会有多余的`+`，你必须手动删除它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T15:07:13.813

我会在正则表达式模式下使用 Find/Replace eclipse：

*   寻找：

    ^((?:\s(?) *\S?)((?:\s(?![\r\n]))* )

*   用。。。来代替

    \1"\2"\3 +

**将准确**保留每个字符串前后的任何空格或制表符，并用所需的双引号将它们括起来。（最后一个'+'需要删除）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T14:37:10.157

这可能不是您正在寻找的答案。您可以使用 sed 流编辑器轻松实现您的要求。[通过下载cygwin](http://www.cygwin.com/)之类的工具包，可以在所有版本的 Unix 和 Windows 上使用它。在 Unix shell 命令行上运行命令

```
sed 's/^/"/;s/$/"+/' 
```

并粘贴要转换的文本。在其输出中，您将获得转换后的文本。传递给 sed 的参数表示用引号替换 (s) 行的开头 (^)，并用引号和加号替换 (s) 每行的结尾 ($)。

如果要转换的文本很大，您可能希望通过文件重定向 sed 的输入和输出。在这种情况下运行类似

```
 sed 's/^/"/;s/$/"+/' <inputfile >outputfile 
```

在 Windows 上，您还可以使用[Outwit](http://www.spinellis.gr/sw/outwit/)工具套件的 winclip 命令直接更改剪贴板中的内容。只需运行

```
winclip -p | sed 's/^/"/;s/$/"+/' | winclip -c 
```

上面的命令会将剪贴板的内容粘贴到 sed 中，并将结果粘贴回剪贴板。

最后，如果您经常使用此命令，将其放入 shell 脚本文件是有意义的，这样您就可以轻松运行它。然后，您甚至可以为其分配一个 Eclipse 键盘快捷键。

# vim - 在vim中自动折叠#defines

> ID：121202
> 
> 赞同：5
> 
> 时间：2008-09-23T14:06:55.673
> 
> 标签：vim, scripting

我使用相当多的多平台 C/C++ 代码，由常见的#defines（#if WIN、#if UNIX 等）分隔。如果我可以让 vim 在我打开文件时自动折叠我当前不感兴趣的部分，那就太好了。我已经搜索了 vim 脚本档案，但没有发现任何有用的东西。有什么建议么？从哪里开始？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T14:19:09.763

只需在您的语法中添加一个折叠区域 [http://vim.wikia.com/wiki/Syntax_folding_of_Vim_scripts#Syntax_definitions](http://vim.wikia.com/wiki/Syntax_folding_of_Vim_scripts#Syntax_definitions)

```
:syn region myFold start="\#IF" end="\#ENDIF" transparent fold
:syn sync fromstart
:set foldmethod=syntax 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T14:23:46.600

要添加到@hometoasts 答案，您可以将该命令作为注释添加到文件的前十行或最后十行中，vim 会自动将其用于该文件。

```
    /* vim: syn region regionName start="regex" end="regex": */

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-04T07:00:49.953

我有一个庞大的代码库和大量的#defines。每个文件都有许多#ifdef，并且大多数时候它们是嵌套的。我尝试了许多 vim 脚本，但它们总是在我的代码中遇到一些错误。所以最后我把我所有的定义放在一个头文件中，并将它包含在我想要使用的文件中，并像这样对它做了一个 gcc

gcc -E -C -P source.cpp > output.cpp

-E 命令让 gcc 仅在文件上运行预处理器，因此未定义的 #ifdef 中的所有不需要的代码都将被删除。-C 选项保留文件中的注释。-P 选项禁止在预处理器的输出中生成线标记。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T14:34:16.093

对 Denton 的补充的快速补充：要将新语法规则用于任何 C 或 C++ 代码，请将其添加到位于 and 的文件`$VIMRUNTIME/syntax/c.vim`中`cpp.vim`。（`$VIMRUNTIME`是本地 Vim 代码所在的位置：`~/.vim`在 Unix 上。）此外，语法定义中的`start`和值`end`是正则表达式，因此您可以使用`^#if`并`^#endif`确保它们仅匹配行首的那些字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T15:59:50.487

我一直使用 forldmethod=marker 并定义了我自己的折叠标签放在评论中。

这是用于定义定义打开和关闭折叠的字符。在这种情况下，打开是“<（”，关闭是“）>”用你想要的任何东西替换它们。

```
set foldmethod=marker
set foldmarker=<(,)> 
```

这是我的自定义函数，用于决定折叠文本的显示内容：

```
set foldtext=GetCustomFoldText()
function GetCustomFoldText()
    let preline = substitute(getline(v:foldstart),'<(','<(+)','')
    let line = substitute(preline,"\t",'        ','g')
    let nextLnNum = v:foldstart + 1
    let nextline = getline(nextLnNum)
    let foldTtl = v:foldend - v:foldstart
    return line .  ' | ' . nextline . ' (' . foldTtl .  ' lines)>'
endfunction 
```

希望有帮助。

# javascript - 如何检测 JavaScript 是否被禁用？

> ID：121203
> 
> 赞同：690
> 
> 时间：2008-09-23T14:07:12.740
> 
> 标签：javascript, html, code-snippets

今天早上有一篇帖子询问有多少人禁用了 JavaScript。然后我开始想知道可以使用哪些技术来确定用户是否禁用了它。

有谁知道一些简短/简单的方法来检测 JavaScript 是否被禁用？我的意图是发出警告，如果没有启用 JS 的浏览器，该站点将无法正常运行。

最终我想将它们重定向到能够在没有 JS 的情况下工作的内容，但我需要这个检测作为一个占位符才能开始。

* * *

## 回答 #1

> 赞同：379
> 
> 时间：2010-10-13T18:24:20.763

我想在这里添加我的 .02。它不是 100% 防弹的，但我认为它已经足够好了。

对我来说，问题是，最好使用放置某种“如果没有 Javascript，此站点无法正常运行”消息的示例，您需要确保您的站点在没有 Javascript 的情况下可以正常运行。一旦你开始了这条路，你就会开始意识到网站应该在关闭 JS 的情况下是防弹的，这是一大块额外的工作。

所以，你真正想要的是一个“重定向”到一个页面，上面写着“打开 JS，傻”。但是，当然，您不能可靠地进行元重定向。所以，这里的建议是：

```
<noscript>
    <style type="text/css">
        .pagecontainer {display:none;}
    </style>
    <div class="noscriptmsg">
    You don't have javascript enabled.  Good luck with that.
    </div>
</noscript> 
```

...您网站中的*所有*内容都用“pagecontainer”类的 div 包装。noscript 标记内的 CSS 将隐藏您的所有页面内容，而是显示您想要显示的任何“无 JS”消息。这实际上是 Gmail 似乎要做的……如果它对 Google 来说足够好，那么对于我的小网站来说也足够好了。

* * *

## 回答 #2

> 赞同：299
> 
> 时间：2008-09-23T14:16:38.053

我假设您正在尝试决定是否提供 JavaScript 增强的内容。最好的实现完全降级，这样网站仍然可以在没有 JavaScript 的情况下运行。我还假设您的意思是[服务器端](https://www.seguetech.com/client-server-side-code/ "“客户端与服务器端代码：有什么区别？”")检测，而不是[`<noscript>`](https://www.w3.org/TR/html52/semantics-scripting.html#the-noscript-element "WC3 建议：<noscript> 元素 (HTML 5.2)")出于无法解释的原因使用该元素。

没有执行服务器端 JavaScript 检测的好方法。作为替代方案，可以[使用 JavaScript 设置 cookie](https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie "MDN：文档.cookie")，然后在后续页面查看时使用服务器端脚本测试该 cookie。但是，这不适合决定要交付什么内容，因为它无法区分没有 cookie 的访问者与新访问者或不接受 JavaScript 设置 cookie 的访问者。

* * *

## 回答 #3

> 赞同：204
> 
> 时间：2008-09-23T14:08:33.797

[`noscript`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/noscript?redirectlocale=en-US&redirectslug=HTML%2FElement%2Fnoscript)块在禁用 JavaScript 时执行，通常用于显示您在 JavaScript 中生成的替代内容，例如

```
<script type="javascript">
    ... construction of ajaxy-link,  setting of "js-enabled" cookie flag, etc..
</script>
<noscript>
    <a href="next_page.php?nojs=1">Next Page</a>
</noscript> 
```

没有 js 的用户将获得`next_page`链接 - 您可以在此处添加参数，以便在下一页上知道他们是通过 JS/非 JS 链接来的，还是尝试通过 JS 设置 cookie，没有这意味着 JS被禁用。这两个例子都相当琐碎并且容易被操纵，但你明白了。

如果您想了解有多少用户禁用了 javascript，您可以执行以下操作：

```
<noscript>
    <img src="no_js.gif" alt="Javascript not enabled" />
</noscript> 
```

然后检查您的访问日志以查看该图像被点击了多少次。一个稍微粗略的解决方案，但它会为您的用户群提供一个好主意。

上述方法（图像跟踪）不适用于纯文本浏览器或根本不支持 js 的浏览器，因此如果您的用户群主要转向该区域，这可能不是最佳方法。

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2009-03-04T01:07:33.103

这对我有用：如果禁用 javascript，它会重定向访问者

```
<noscript><meta http-equiv="refresh" content="0; url=whatyouwant.html" /></noscript> 
```

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2008-09-23T14:12:54.520

我建议您通过编写不显眼的 JavaScript 来反其道而行之。

让您的项目功能适用于禁用 JavaScript 的用户，完成后，实施 JavaScript UI 增强功能。

[https://en.wikipedia.org/wiki/Unobtrusive_JavaScript](https://en.wikipedia.org/wiki/Unobtrusive_JavaScript)

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2008-09-24T07:06:05.193

如果您的用例是您有一个表单（例如，一个登录表单）并且您的服务器端脚本需要知道用户是否启用了 JavaScript，您可以执行以下操作：

```
<form onsubmit="this.js_enabled.value=1;return true;">
    <input type="hidden" name="js_enabled" value="0">
    <input type="submit" value="go">
</form> 
```

这将在提交表单之前将 js_enabled 的值更改为 1。如果您的服务器端脚本得到 0，则没有 JS。如果它得到一个 1，JS！

* * *

## 回答 #7

> 赞同：39
> 
> 时间：2014-02-07T06:08:55.370

`<noscript>`甚至没有必要，更不用说**XHTML 不支持**。

**工作示例**：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">
<html>
<head>
    <title>My website</title>
    <style>
      #site {
          display: none;
      }
    </style>
    <script src="http://code.jquery.com/jquery-latest.min.js "></script>
    <script>
      $(document).ready(function() {
          $("#noJS").hide();
          $("#site").show();
      });
    </script>
</head>
<body>
    <div id="noJS">Please enable JavaScript...</div>
    <div id="site">JavaScript dependent content here...</div>
</body>
</html> 
```

在此示例中，如果启用了 JavaScript，则您会看到该站点。如果没有，那么您会看到“请启用 JavaScript”消息。**测试 JavaScript 是否启用的最佳方法是简单地尝试使用 JavaScript！**如果有效，则已启用，如果无效，则不是...

* * *

## 回答 #8

> 赞同：37
> 
> 时间：2012-04-25T15:05:36.497

在 body 上使用 .no-js 类并基于 .no-js 父类创建非 javascript 样式。如果禁用了 javascript，您将获得所有非 javascript 样式，如果有 JS 支持，则 .no-js 类将被替换，为您提供所有样式。

```
 document.body.className = document.body.className.replace("no-js","js"); 
```

通过modernizr在HTML5样板[http://html5boilerplate.com/](http://html5boilerplate.com/)中使用的技巧，但你可以使用一行javascript来替换类

noscript 标签是可以的，但是当它可以用 css 完成时，为什么在你的 html 中有额外的东西

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2010-12-08T23:36:06.053

只是有点难，但是（hairbo 给了我这个想法）

CSS：

```
.pagecontainer {
  display: none;
} 
```

JS：

```
function load() {
  document.getElementById('noscriptmsg').style.display = "none";
  document.getElementById('load').style.display = "block";
  /* rest of js*/
} 
```

HTML：

```
<body onload="load();">

  <div class="pagecontainer" id="load">
    Page loading....
  </div>
  <div id="noscriptmsg">
    You don't have javascript enabled. Good luck with that.
  </div>

</body> 
```

在任何情况下都可以工作吗？即使不支持 noscript 标签（只需要一些 css），任何人都知道非 css 解决方案吗？

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2008-09-23T14:08:28.633

您可以使用一个简单的 JS 片段来设置隐藏字段的值。回帖时，您知道 JS 是否已启用。

或者您可以尝试打开一个快速关闭的弹出窗口（但它可能是可见的）。

此外，您还有 NOSCRIPT 标记，可用于为禁用 JS 的浏览器显示文本。

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2008-09-23T14:10:11.313

你会想看看 noscript 标签。

```
<script type="text/javascript">
...some javascript script to insert data...
</script>
<noscript>
   <p>Access the <a href="http://someplace.com/data">data.</a></p>
</noscript> 
```

* * *

## 回答 #12

> 赞同：13
> 
> 时间：2010-07-16T13:53:02.620

因为我总是想给浏览器一些值得一看的东西，所以我经常使用这个技巧：

首先，页面的任何需要 JavaScript 才能正常运行的部分（包括通过 getElementById 调用等修改的被动 HTML 元素）都被设计为可以按原样使用，前提是没有可用的 JavaScript。（设计得好像它不存在）

任何需要 JavaScript 的元素，我都放在一个标签中，例如：

```
<span name="jsOnly" style="display: none;"></span> 
```

然后在我的文档的开头，我使用`.onload`或`document.ready`在一个循环中`getElementsByName('jsOnly')`设置`.style.display = "";`重新打开 JS 相关元素。这样，非 JS 浏览器就不必查看站点的 JS 相关部分，如果有，它会在准备好时立即显示。

一旦你习惯了这种方法，就很容易混合你的代码来处理这两种情况，尽管我现在只是在试验这个`noscript`标签，并期望它会有一些额外的优势。

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2008-09-27T06:53:18.153

noscript 标签运行良好，但需要每个额外的页面请求才能继续提供无用的 JS 文件，因为 noscript 本质上是客户端检查。

您可以使用 JS 设置 cookie，但正如其他人指出的那样，这可能会失败。理想情况下，您希望能够检测 JS 客户端，并且在不使用 cookie 的情况下，为该用户设置一个会话服务器端，表明 JS 已启用。

一种可能性是使用 JavaScript 动态添加 1x1 图像，其中 src 属性实际上是服务器端脚本。这个脚本所做的只是保存到启用 JS 的当前用户会话（$_SESSION['js_enabled']）。然后，您可以将 1x1 空白图像输出回浏览器。该脚本不会为禁用 JS 的用户运行，因此不会设置 $_SESSION['js_enabled']。然后对于提供给该用户的其他页面，您可以决定是否包含所有外部 JS 文件，但您总是希望包含检查，因为您的某些用户可能正在使用 NoScript Firefox 插件或拥有 JS由于其他原因暂时禁用。

您可能希望在页面末尾附近的某处包含此检查，以便额外的 HTTP 请求不会减慢页面的呈现速度。

* * *

## 回答 #14

> 赞同：12
> 
> 时间：2011-04-01T09:42:45.120

将此添加到每个页面的 HEAD 标记中。

```
<noscript>
        <meta http-equiv="refresh" runat="server" id="mtaJSCheck" content="0;logon.aspx" />
</noscript> 
```

所以你有了：

```
<head>
    <noscript>
        <meta http-equiv="refresh" runat="server" id="mtaJSCheck" content="0;logon.aspx" />
    </noscript>
</head> 
```

感谢杰。

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2013-02-22T15:49:22.393

一个常见的解决方案是元标记结合 noscript 来刷新页面并在 JavaScript 被禁用时通知服务器，如下所示：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <noscript>
            <meta http-equiv="refresh" content="0; /?javascript=false">
        </noscript>
        <meta charset="UTF-8"/>
        <title></title>
    </head>
</html> 
```

在上面的示例中，当 JavaScript 被禁用时，浏览器将在 0 秒内重定向到网站的主页。此外，它还会将参数 javascript=false 发送到服务器。

然后，诸如 node.js 或 PHP 之类的服务器端脚本可以解析参数并知道 JavaScript 已禁用。然后它可以向客户端发送一个特殊的非 JavaScript 版本的网站。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2015-04-02T14:04:23.883

这是“最干净”的解决方案 id 使用：

```
<noscript>
    <style>
        body *{ /*hides all elements inside the body*/
            display: none;
        }
        h1{ /* even if this h1 is inside head tags it will be first hidden, so we have to display it again after all body elements are hidden*/
            display: block;
        }
    </style>
    <h1>JavaScript is not enabled, please check your browser settings.</h1>
</noscript> 
```

* * *

## 回答 #17

> 赞同：8
> 
> 时间：2008-09-23T14:10:47.757

如果禁用了 javascript，您的客户端代码无论如何都不会运行，所以我假设您的意思是您希望该信息在服务器端可用。在这种情况下，*noscript*的帮助较小。相反，我有一个隐藏的输入并使用 javascript 来填写一个值。在您的下一个请求或回发之后，如果该值在那里，您就知道 javascript 已打开。

小心诸如 noscript 之类的东西，第一个请求可能会显示 javascript 已禁用，但以后的请求会将其打开。

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2008-09-23T14:16:39.550

例如，您可以使用类似 document.location = 'java_page.html' 的东西将浏览器重定向到一个新的、包含脚本的页面。重定向失败意味着 JavaScript 不可用，在这种情况下，您可以求助于 CGI 例程或在标记之间插入适当的代码。（注意：NOSCRIPT 仅在 Netscape Navigator 3.0 及更高版本中可用。）

信用 [http://www.intranetjournal.com/faqs/jsfaq/how12.html](http://www.intranetjournal.com/faqs/jsfaq/how12.html)

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2008-09-23T14:10:48.643

我过去使用的一种技术是使用 JavaScript 编写一个会话 cookie，它只是作为一个标志来表示 JavaScript 已启用。然后服务器端代码查找此 cookie，如果未找到，则采取适当的措施。当然，这种技术确实依赖于启用 cookie！

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2008-09-23T14:14:32.723

我认为您可以将图像标记插入 noscript 标记，然后查看统计信息您的网站的次数以及该图像的加载频率。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2008-09-23T21:54:29.840

人们已经发布了一些很好的检测选项示例，但基于您的要求“发出警告，如果没有启用 JS 的浏览器，该站点将无法正常运行”。您基本上添加了一个以某种方式出现在页面上的元素，例如当您获得徽章时 Stack Overflow 上的“弹出窗口”，带有适当的消息，然后使用一些在页面加载后立即运行的 Javascript 将其删除（我的意思是 DOM，而不是整个页面）。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2018-06-18T11:12:28.987

标签内`<noscript>`的代码将在浏览器中未启用 js 时执行。我们可以使用`noscript`标签显示 msg 来打开 JS，如下所示。`<noscript> <h1 style="text-align: center;">enable java script and reload the page</h1> </noscript>` 同时将我们的网站内容隐藏在正文中。如下

```
<body>
<div id="main_body" style="display: none;">
website content.
</div>
</body> 
```

现在，如果打开 JS，您可以让 main_body 中的内容如下所示

```
<script type="text/javascript">
document.getElementById("main_body").style.display="block";
</script> 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2009-08-13T21:16:36.050

为什么不直接放置一个仅在启用 JS 时才会触发的劫持 onClick() 事件处理程序，并使用它来将参数 (js=true) 附加到单击/选择的 URL（您还可以检测到一个下拉列表并更改添加隐藏表单字段的值）。所以现在当服务器看到这个参数 (js=true) 时，它知道 JS 已启用，然后在服务器端执行您的花哨逻辑。
不利的一面是，用户第一次访问您的网站、书签、URL、搜索引擎生成的 URL - 您需要检测这是一个新用户，所以不要寻找附加到 URL 中的 NVP，并且服务器必须等待下一次单击才能确定用户是否启用/禁用了 JS。此外，另一个缺点是 URL 将在浏览器 URL 上结束，如果此用户随后将此 URL 加入书签，即使用户没有启用 JS，它也会有 js=true NVP，尽管在下一次单击时服务器会明智地知道用户是否仍然启用了 JS。叹息。。这很有趣。。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2010-07-26T14:12:58.570

为了强制用户启用 JavaScript，我将每个链接的“href”属性设置为同一个文档，通知用户启用 JavaScript 或下载 Firefox（如果他们不知道如何启用 JavaScript）。我将实际链接 url 存储到链接的“名称”属性中，并定义了一个全局 onclick 事件，该事件读取“名称”属性并将页面重定向到那里。

这对我的用户群很有效，虽然有点法西斯主义;)。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2011-08-31T15:03:12.100

您没有检测到用户是否禁用了 javascript（服务器端或客户端）。相反，您假设 javascript 已禁用，并在禁用 javascript 的情况下构建您的网页。这消除了对 的需要`noscript`，无论如何您都应该避免使用它，因为它不能完全正确地工作并且是不必要的。

例如，只是建立你的网站说`<div id="nojs">This website doesn't work without JS</div>`

然后，您的脚本将简单地执行`document.getElementById('nojs').style.display = 'none';`其正常的 JS 业务。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2012-02-09T05:25:27.633

使用我在[此处](https://stackoverflow.com/questions/9205051/a-php-function-to-check-for-cookies "用于检查 cookie 的 PHP 函数")介绍的纯服务器端解决方案检查 cookie，然后通过使用 Jquery.Cookie 删除 cookie 来检查 javascript，然后通过这种方式检查 cookie，您可以同时检查 cookie 和 javascript

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2013-01-13T09:52:06.187

在某些情况下，向后执行可能就足够了。使用 javascript 添加一个类：

```
// Jquery
$('body').addClass('js-enabled');

/* CSS */
.menu-mobile {display:none;}
body.js-enabled .menu-mobile {display:block;} 
```

这可能会在任何复杂的事情上产生维护问题，但它是对某些事情的简单修复。与其尝试检测何时未加载，不如根据加载时间设置样式。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2013-08-23T07:50:39.333

我想添加我的解决方案，以获得关于有多少真实用户在禁用 javascript 的情况下访问我的网站的可靠统计数据。每次会话仅进行一次检查，具有以下好处：

*   访问 100 个页面或仅访问 1 个页面的用户每人计为 1 个。这允许专注于单个用户，而不是页面。
*   无论如何都不会破坏页面流、结构或语义
*   可以记录用户代理。这允许从统计数据中排除机器人，例如通常禁用 JS 的 google bot 和 bing bot！还可以记录IP、时间等...
*   每个会话只需检查一次（最小过载）

我的代码使用带有 ajax 的 PHP、mysql 和 jquery，但可以适应其他语言：

在您的数据库中创建一个表，如下所示：

```
CREATE TABLE IF NOT EXISTS `log_JS` (
  `logJS_id` int(11) NOT NULL AUTO_INCREMENT,
  `data_ins` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `session_id` varchar(50) NOT NULL,
  `JS_ON` tinyint(1) NOT NULL DEFAULT '0',
  `agent` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`logJS_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8; 
```

使用 session_start() 或等效项（需要 jquery）后将其添加到每个页面：

```
<?  if (!isset($_SESSION["JSTest"]))
    { 
        mysql_query("INSERT INTO log_JS (session_id, agent) VALUES ('" . mysql_real_escape_string(session_id()) . "', '" . mysql_real_escape_string($_SERVER['HTTP_USER_AGENT']). "')"); 
        $_SESSION["JSTest"] = 1; // One time per session
        ?>
        <script type="text/javascript">
            $(document).ready(function() { $.get('JSOK.php'); });
        </script>
        <?
    }
?> 
```

像这样创建页面 JSOK.php：

```
<?
include_once("[DB connection file].php");   
mysql_query("UPDATE log_JS SET JS_ON = 1 WHERE session_id = '" . mysql_real_escape_string(session_id()) . "'"); 
```

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2013-09-12T03:17:20.923

我想出了另一种使用 css 和 javascript 本身的方法。
这只是开始修补类和 id。

CSS 片段：
1\. 创建一个 css ID 规则，并将其命名为 #jsDis。
2\. 使用“content”属性在 BODY 元素之后生成文本。（您可以根据需要设置此样式）。
3 创建第二个 css ID 规则并将其命名为#jsEn，并对其进行样式化。（为了简单起见，我给我的#jsEn 规则赋予了不同的背景颜色。

```
<style>
#jsDis:after {
    content:"Javascript is Disable. Please turn it ON!";
    font:bold 11px Verdana;
    color:#FF0000;
}

#jsEn {
    background-color:#dedede;
}

#jsEn:after {
    content:"Javascript is Enable. Well Done!";
    font:bold 11px Verdana;
    color:#333333;
}
</style> 
```

JavaScript 片段：
1\. 创建一个函数。
2\. 使用 getElementById 获取 BODY ID 并将其分配给变量。
3\. 使用JS函数'setAttribute'，改变BODY元素的ID属性值。

```
<script>
function jsOn() {
    var chgID = document.getElementById('jsDis');
    chgID.setAttribute('id', 'jsEn');
}
</script> 
```

HTML 部分。
1\. 使用 ID 为#jsDis 命名 BODY 元素属性。
2\. 添加带有函数名的onLoad事件。（jsOn（））。

```
<body id="jsDis" onLoad="jsOn()"> 
```

因为 BODY 标签被赋予了#jsDis 的 ID：
- 如果 Javascript 被启用，它会自己改变 BODY 标签的属性。
- 如果禁用 Javascript，它将显示 css 'content:' 规则文本。

您可以使用#wrapper 容器或使用 JS 的任何 DIV。

希望这有助于理解。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2008-09-23T14:09:45.200

检测到什么？JavaScript？那是不可能的。如果您只是希望它用于记录目的，您可以使用某种跟踪方案，其中每个页面都有 JavaScript 来请求特殊资源（可能非常小`gif`或类似）。这样，您就可以区分唯一页面请求和跟踪文件请求。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2009-04-03T03:06:19.177

在 noscript 内的 meta 中添加刷新不是一个好主意。

1.  因为 noscript 标签不符合 XHTML

2.  属性值“刷新”是非标准的，不应使用。“刷新”将页面的控制权从用户手中夺走。使用“刷新”将导致 W3C 的 Web 内容可访问性指南 --- 参考[http://www.w3schools.com/TAGS/att_meta_http_equiv.asp](http://www.w3schools.com/TAGS/att_meta_http_equiv.asp)失败。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2010-11-18T22:14:50.253

对于那些只想跟踪 js 是否启用的人来说，使用 ajax 例程来存储状态怎么样？例如，我将所有访问者/访问记录在一组表中。JSenabled 字段可以设置为默认值 FALSE，如果启用了 JS，ajax 例程会将其设置为 TRUE。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2013-09-16T17:38:49.690

这是一个 PHP 脚本，可以在生成任何输出之前包含一次。它并不完美，但它在大多数情况下运行良好，可以避免交付客户端不会使用的内容或代码。标题注释解释了它是如何工作的。

```
<?php
/*****************************************************************************
 * JAVASCRIPT DETECTION                                                      *
 *****************************************************************************/

// Progressive enhancement and graceful degradation are not sufficient if we
// want to avoid sending HTML or JavaScript code that won't be useful on the
// client side.  A normal HTTP request will not include any explicit indicator
// that JavaScript is enabled in the client.  So a "preflight response" is
// needed to prompt the client to provide an indicator in a follow-up request.
// Once the state of JavaScript availability has been received the state of
// data received in the original request must be restored before proceding.
// To the user, this handshake should be as invisible as possible.
// 
// The most convenient place to store the original data is in a PHP session.
// The PHP session extension will try to use a cookie to pass the session ID
// but if cookies are not enabled it will insert it into the query string.
// This violates our preference for invisibility.  When Javascript is not
// enabled the only way to effect a client side redirect is with a "meta"
// element with its "http-equiv" attribute set to "refresh".  In this case
// modifying the URL is the only way to pass the session ID back.
//
// But when cookies are disabled and JavaScript is enabled then a client side
// redirect can be effected by setting the "window.onload" method to a function
// which submits a form.  The form has a "method" attribute of "post" and an
// "action" attribute set to the original URL.  The form contains two hidden
// input elements, one in which the session ID is stored and one in which the
// state of JavaScript availability is stored.  Both values are thereby passed
// back to the server in a POST request while the URL remains unchanged.  The
// follow-up request will be a POST even if the original request was a GET, but
// since the original request data is restored, the containing script ought to
// process the request as though it were a GET.

// In order to ensure that the constant SID is defined as the caller of this
// script would expect, call session_start if it hasn't already been called.
$session = isset($_SESSION);
if (!$session) session_start();

// Use a separate session for Javascript detection.  Save the caller's session
// name and ID.  If this is the followup request then close the caller's
// session and reopen the Javascript detection session.  Otherwise, generate a
// new session ID, close the caller's session and create a new session for
// Javascript detection.
$session_name = session_name();
$session_id = session_id();
session_write_close();
session_name('JS_DETECT');
if (isset($_COOKIE['JS_DETECT'])) {
    session_id($_COOKIE['JS_DETECT']);
} elseif (isset($_REQUEST['JS_DETECT'])) {
    session_id($_REQUEST['JS_DETECT']);
} else {
    session_id(sha1(mt_rand()));
}
session_start();

if (isset($_SESSION['_SERVER'])) {
    // Preflight response already sent.
    // Store the JavaScript availability status in a constant.
    define('JS_ENABLED', 0+$_REQUEST['JS_ENABLED']);
    // Store the cookie availability status in a constant.
    define('COOKIES_ENABLED', isset($_COOKIE['JS_DETECT']));
    // Expire the cookies if they exist.
    setcookie('JS_DETECT', 0, time()-3600);
    setcookie('JS_ENABLED', 0, time()-3600);
    // Restore the original request data.
    $_GET = $_SESSION['_GET'];
    $_POST = $_SESSION['_POST'];
    $_FILES = $_SESSION['_FILES'];
    $_COOKIE = $_SESSION['_COOKIE'];
    $_SERVER = $_SESSION['_SERVER'];
    $_REQUEST = $_SESSION['_REQUEST'];
    // Ensure that uploaded files will be deleted if they are not moved or renamed.
    function unlink_uploaded_files () {
        foreach (array_keys($_FILES) as $k)
            if (file_exists($_FILES[$k]['tmp_name']))
                unlink($_FILES[$k]['tmp_name']);
    }
    register_shutdown_function('unlink_uploaded_files');
    // Reinitialize the superglobal.
    $_SESSION = array();
    // Destroy the Javascript detection session.
    session_destroy();
    // Reopen the caller's session.
    session_name($session_name);
    session_id($session_id);
    if ($session) session_start();
    unset($session, $session_name, $session_id, $tmp_name);
    // Complete the request.
} else {
    // Preflight response not sent so send it.
    // To cover the case where cookies are enabled but JavaScript is disabled,
    // initialize the cookie to indicate that JavaScript is disabled.
    setcookie('JS_ENABLED', 0);
    // Prepare the client side redirect used when JavaScript is disabled.
    $content = '0; url='.$_SERVER['REQUEST_URI'];
    if (!$_GET['JS_DETECT']) {
        $content .= empty($_SERVER['QUERY_STRING']) ? '?' : '&';
        $content .= 'JS_DETECT='.session_id();
    }
    // Remove request data which should only be used here.
    unset($_GET['JS_DETECT'],$_GET['JS_ENABLED'],
            $_POST['JS_DETECT'],$_POST['JS_ENABLED'],
            $_COOKIE['JS_DETECT'],$_COOKIE['JS_ENABLED'],
            $_REQUEST['JS_DETECT'],$_REQUEST['JS_ENABLED']);
    // Save all remaining request data in session data.
    $_SESSION['_GET'] = $_GET;
    $_SESSION['_POST'] = $_POST;
    $_SESSION['_FILES'] = $_FILES;
    $_SESSION['_COOKIE'] = $_COOKIE;
    $_SESSION['_SERVER'] = $_SERVER;
    $_SESSION['_REQUEST'] = $_REQUEST;
    // Rename any uploaded files so they won't be deleted by PHP.  When using
    // a clustered web server, upload_tmp_dir must point to shared storage.
    foreach (array_keys($_FILES) as $k) {
        $tmp_name = $_FILES[$k]['tmp_name'].'x';
        if (move_uploaded_file($_FILES[$k]['tmp_name'], $tmp_name))
            $_SESSION['_FILES'][$k]['tmp_name'] = $tmp_name;
    }
// Have the client inform the server as to the status of Javascript.
?>
<!DOCTYPE html>
<html>
<head>
    <script>
        document.cookie = 'JS_ENABLED=1';
// location.reload causes a confirm box in FireFox
//      if (document.cookie) { location.reload(true); }
        if (document.cookie) { location.href = location; }
    </script>
    <meta http-equiv="refresh" content="<?=$content?>" />
</head>
<body>
    <form id="formid" method="post" action="" >
        <input type="hidden" name="<?=$session_name?>" value="<?=$session_id?>" />
        <input type="hidden" name="JS_DETECT" value="<?=session_id()?>" />
        <input type="hidden" name="JS_ENABLED" value="1" />
    </form>
    <script>
        document.getElementById('formid').submit();
    </script>
</body>
</html>
<?php
    exit;
}
?> 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2013-12-18T10:42:47.650

这里是转折！可能有客户端浏览器启用了 Javascript 并且使用 JS 兼容的浏览器。但是出于什么原因 Javascript 在浏览器中不起作用（例如：防火墙设置）。据统计，这发生在每 93 个场景中的 1 个。所以服务器检测到客户端能够执行 Javascript，但实际上它没有！

作为一种解决方案，我建议我们在客户端站点中设置一个 cookie，然后从服务器读取它。如果设置了 cookie，那么 JS 可以正常工作。有什么想法吗 ？

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2020-06-19T18:10:31.680

当然，Cookie 和 HTTP 标头是很好的解决方案，但两者都需要明确的服务器端参与。

对于简单的站点，或者我没有后端访问权限的站点，我更喜欢客户端解决方案。

--

我使用以下内容为 HTML 元素本身设置类属性，因此我的 CSS 可以处理几乎所有其他显示类型逻辑。

方法：

**1）**放置在元素`<script>document.getElementsByTagName('html')[0].classList.add('js-enabled');</script>` ***上方。***`<html>`

**警告！！！！此方法将覆盖所有`<html>`类属性，更不用说可能不是“有效”HTML，但适用于所有浏览器，我已经对其进行了测试。**

*注意：由于脚本运行的时间，在`<html>`处理标记之前，它最终会得到一个没有节点的空 classList 集合，所以在脚本完成时，`<html>`元素将只被赋予你添加的类.

**2)**保留所有其他`<html>`类属性，只需将脚本`<script>document.getElementsByTagName('html')[0].classList.add('js-enabled');</script>`放在开始`<html>`标记之后。

*在这两种情况下，如果 JS 被禁用，则不会更改`<html>`类属性。*

备择方案

多年来，我使用了其他一些方法：

```
 <script type="text/javascript">
    <!-- 
        (function(d, a, b){ 
            let x = function(){
                // Select and swap
                let hits = d.getElementsByClassName(a);
                for( let i = hits.length - 1; i >= 0; i-- ){
                    hits[i].classList.add(b);
                    hits[i].classList.remove(a);
                }
            };
            // Initialize Second Pass...
            setTimeout(function(){ x(); },0);
            x();
        })(document, 'no-js', 'js-enabled' );
    -->
</script> 
```

// 缩小为：

```
<script type="text/javascript">
    <!-- 
        (function(d, a, b, x, hits, i){x=function(){hits=d.getElementsByClassName(a);for(i=hits.length-1;i>=0;i--){hits[i].classList.add(b);hits[i].classList.remove(a);}};setTimeout(function(){ x(); },0);x();})(document, 'no-js', 'js-enabled' );
    -->
</script> 
```

*   这将在页面中循环两次，一次是在页面中的位置，通常是在`<html>`页面加载之后和页面加载之后。需要两次，因为我注入了我没有后端访问权限的 CMS 的 header.tpl 文件，但想为 no-js 片段提供样式选项。

第一遍，将设置 .js-enabled 类允许任何全局样式启动，并阻止大多数进一步的重排。第二遍，是任何后来包含的内容的统称。

理由：

主要原因，我关心是否启用 JS 是出于“样式”目的，隐藏/显示表单，启用/禁用按钮或重新设置滑块、表格和其他需要 JS 功能的演示文稿的演示和布局“正确”，如果没有 JS 来动画或处理交互，它将是无用的或无法使用的。

此外，你不能直接用javascript检测，如果javascript被“禁用”......只有当它被“启用”时，通过执行一些javascript，所以你要么依赖`<meta http-equiv="refresh" content="2;url=/url/to/no-js/content.html" />`或者你可以依赖css来切换样式，如果javascript执行，切换到“js-enabled”模式。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2021-06-23T14:32:34.120

如果启用了 JavaScript ，为什么需要知道*服务器端？*浏览器支持哪种变体是否重要？例如，它是否需要理解关键字`let`或者就可以了`var`？

我建议发送不需要任何 JavaScript 即可访问的可读**内容，然后尝试加载 JS 文件以添加您想要的所有 JS 行为。**

例如，如果未启用 JS，UI 可能最终会丢失登录或修改按钮，并且它*可能*在底部包含一个小文本（使用`<noscript>`或带有 CSS 的某些元素，`animation`如果 JS 代码未删除，则在一小段延迟后显示文本整个元素很快）说“要登录/修改此内容，您必须在浏览器中启用 JavaScript 支持。” 如果你做得好，除非他或她尝试登录或修改内容，否则读者甚至可能不会注意到缺少任何内容。

作为一种*优化*，您可以使用 JavaScript 设置 cookie，如果您出于某种原因希望异步获取它，服务器*可以避免*发送非 JavaScript 可读内容。只需确保仅在 JS 代码运行完成至少一次后才设置此 cookie，而不是在 JS 代码开始运行时立即设置它，以确保最终用户在 (不是如果！）JS代码因任何原因失败。

（请注意，异步加载初始页面状态不会更快地将该内容提供给最终用户。但是，您只能在没有 JavaScript 的情况下发送全部内容的一部分。这可以允许更快地呈现“首屏”，然后异步加载其余内容页面使用 JS 代码。）

作为额外的好处，搜索引擎仍然可以在不启用任何 JavaScript 的情况下为您的网站编制索引。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2011-04-08T07:01:56.047

我昨天不得不解决同样的问题，所以我只是在这里添加我的 .001。该解决方案至少在主页上对我有用（index.php）

我喜欢在根文件夹中只有一个文件： index.php 。然后我使用文件夹来构建整个项目（代码、css、js 等）。所以 index.php 的代码如下：

```
<head>
    <title>Please Activate Javascript</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script> 
</head>

<body>

<script language="JavaScript">
    $(document).ready(function() {
        location.href = "code/home.php";
    });   
</script>

<noscript>
    <h2>This web site needs javascript activated to work properly. Please activate it. Thanks!</h2>
</noscript>

</body>

</html> 
```

希望这对任何人都有帮助。最好的祝福。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2022-01-28T11:46:18.733

## 2022 年更新

这个问题已经有 30 多个答案，但似乎没有一个明确或准确地说明必须做什么。

*   使用的服务器端框架 - ASP.NET Core
*   客户端 - vanilla js

在`BaseController`应用程序的第一个入口点上，`OnActionExecutionAsync`我有这个逻辑。

*   基本上默认情况下，我假设客户端没有启用 javascript 并设置此标志。

```
Response.Cookies.Append("jsEnabled", "false"); 
```

*   现在，在客户端初始加载后，我有一个 javascript 函数将此标志更新为`true`.
*   这个函数只有在环境有的时候才会运行`javascript`

所以完整的解决方案就在这里。

#### 客户

在初始加载时添加此功能

```
function detectIfJavascriptIsEnabled() {
    // if this function run's which means js is enabled
    var jsEnabled = getCookie('jsEnabled');
    if (jsEnabled === 'false') {
        setCookie('jsEnabled', 'true');
        location.reload();
    }
} 
```

#### 服务器

```
private bool ValidateIfEnvironmentHasJavascript() {
  if (HttpContext.Request.Cookies != null && HttpContext.Request.Cookies.Count > 0) {
    Boolean.TryParse(HttpContext.Request.Cookies["jsEnabled"], out
      var hasJavascriptEnabled);
    return hasJavascriptEnabled;
  } else {
    Response.Cookies.Append("jsEnabled", "false",
      new CookieOptions() {
        IsEssential = true, Expires = DateTime.UtcNow.AddHours(24)
      });
  }

  return false;
} 
```

这就是你得到结果的方式

```
var environmentHasJavascript = ValidateIfEnvironmentHasJavascript(); 
```

* * *

## 回答 #39

> 赞同：-4
> 
> 时间：2013-02-06T15:53:37.107

听起来可能是一个奇怪的解决方案，但您可以尝试一下：

```
<?php $jsEnabledVar = 0; ?>    

<script type="text/javascript">
var jsenabled = 1;
if(jsenabled == 1)
{
   <?php $jsEnabledVar = 1; ?>
}
</script>

<noscript>
var jsenabled = 0;
if(jsenabled == 0)
{
   <?php $jsEnabledVar = 0; ?>
}
</noscript> 
```

现在在整个页面中使用“$jsEnabledVar”的值。您也可以使用它来显示一个块，指示用户 JS 已关闭。

希望这会有所帮助

# java - JMXQuery 连接 - 身份验证失败

> ID：121205
> 
> 赞同：0
> 
> 时间：2008-09-23T14:07:33.363
> 
> 标签：java, monitoring, jmx, mbeans, nagios

大家好。新手提问时间。我正在尝试设置 JMXQuery 以连接到我的 MBean，到目前为止，这就是我得到的。

java -classpath jmxquery org.nagios.JMXQuery -U service:jmx:rmi:///jndi/rmi://localhost:8004/jmxrmi -O java.lang:type=Memory -A "NonHeapMemoryUsage"

这就是我得到的。

JMX CRITICAL 身份验证失败！需要凭据

我得到了凭据，但是如何将它们传递给 JMXQuery？

/高手

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T16:06:29.147

根据来源，您应该能够使用 -username 和 -password 参数。

[http://code.google.com/p/jmxquery/source/browse/trunk/src/main/java/jmxquery/JMXQuery.java?r=3](http://code.google.com/p/jmxquery/source/browse/trunk/src/main/java/jmxquery/JMXQuery.java?r=3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T10:11:10.647

看来这是对原始 JMX-query 的一个插件，请查看注释字段。

> /** * * JMXQuery 用于 JMX 属性的本地或远程请求 * 它需要 JRE 1.5 用于编译和执行。* 查看方法 main 以了解如何调用它。* * 这个插件是在 nagiosexchange 上找到的。它缺少用户名/密码/角色系统。* * @author 未知 * @author Ryan Gravener (ryangravener@gmail.com) *
> */

这是否意味着无法使用原始 JMXQuery 远程访问 JMX？如果是这样，你*能用*它做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T14:30:05.730

java -classpath jmxquery org.nagios.JMXQuery -U service:jmx:rmi:///jndi/rmi://localhost:8004/jmxrmi -O java.lang:type=Memory -A NonHeapMemoryUsage -K used -I NonHeapMemoryUsage - J 使用 -vvvv -w 82208358 -c 105696461 -username monitorRole -password changeme

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-07T10:58:49.077

[您可以从http://snippets.syabru.ch/nagios-jmx-plugin/download.html](http://snippets.syabru.ch/nagios-jmx-plugin/download.html)下载与 --username 和 --password 一起使用的 check_jmx 版本

# reverse-engineering - 对二进制文件格式进行逆向工程是否合法

> ID：121208
> 
> 赞同：16
> 
> 时间：2008-09-23T14:08:05.267
> 
> 标签：reverse-engineering, file-format

通过反向工程来自另一个应用程序的未加密二进制文件格式并读取内容，在我的应用程序中添加对第 3 方文件格式的支持是否合法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-23T14:09:20.270

取决于你的位置。在欧盟，特别允许（第 6 条欧盟软件公约）“为了互操作性对文件格式进行逆向工程”

一般来说，很难阻止某人读取文件格式，有一些例子表明您被禁止写入文件，因为该格式包含专利技术（如果您所在国家/地区允许软件专利）。多年来，GIF 就是这种情况。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T14:09:56.133

取决于相关格式、您的位置等。这不是“破解”，更像是“逆向工程”。

咨询律师，获得生成格式的应用程序许可证！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T14:28:22.563

ArsTechnica 最近发表了[一篇很好的文章](http://arstechnica.com/articles/paedia/chrome-antics-did-google-reverse-engineer.ars)，关于在谷歌浏览器的上下文中逆向工程的合法性，使用 Windows 中的未记录行为来保护它的一些安全保护（例如，在某些版本的 Windows XP 上实现 DEP）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T14:10:49.627

IANAL，但是是的，我很确定这是合法的，只要您不规避某些版权保护系统或其他东西。以能够读取 Word 文档的 OpenOffice 为例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T14:17:25.697

这完全取决于您所在国家/地区的法律以及您对文件格式进行逆向工程的意图。您需要咨询律师/律师/大律师以确定。您是否与拥有该文件格式的公司核实过是否有已发布的规范或其他信息可以让您在无需逆向工程的情况下进行互操作？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T14:20:09.807

如果您必须违反 EULA 的条款才能这样做，这是非法的。尽管大多数州都有明确允许逆向工程的法律，但我的理解是，这不是一项“不可剥夺的权利”，而是您可以通过合同放弃的权利。（换句话说，允许逆向工程并不妨碍您同意不这样做。）然而，一些司法管辖区走得更远，明确规定逆向工程始终是允许的，即使合同另有规定。

如果您居住在美国，如果您必须绕过“复制保护技术”来进行逆向工程，则 DMCA 通常会禁止逆向工程，但为了使某些内容与格式兼容，它会特别禁止逆向工程。

否则，它*可能是*合法的。不管这里的答案如何，请咨询律师。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T14:21:46.963

我想知道这是否被美国的[DMCA](http://en.wikipedia.org/wiki/Digital_Millennium_Copyright_Act)覆盖？与往常一样，最好的办法是咨询律师。

# javascript - 客户端检测HTTP请求方法

> ID：121218
> 
> 赞同：44
> 
> 时间：2008-09-23T14:09:31.470
> 
> 标签：javascript, http-headers

是否可以从 JavaScript 检测页面的 HTTP 请求方法（例如 GET 或 POST）？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-23T14:11:14.807

一句话—​​—没有

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-23T14:21:38.447

我不相信。如果您需要此信息，我建议您包含`<meta>`在服务器上生成的元素，您可以使用 JavaScript 检查该元素。

例如，使用 PHP：

```
<meta id="request-method" name="request-method" content="<?php echo htmlentities($_SERVER['REQUEST_METHOD']); ?>">
<script type="text/javascript">
    alert(document.getElementById("request-method").content);
</script> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-07-20T10:27:58.663

您可以检查页面的引荐来源网址：

```
document.referrer == document.URL 
```

如果它是同一页面，则用户很可能提交了表单。

当然这需要

*   你不会从一个页面链接到它本身（无论如何这是可访问性所必需的）
*   表单提交到它所在的同一个页面
*   用户没有禁用引荐来源网址

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-23T14:20:50.337

如果您需要此功能，请让服务器检测所使用的方法，然后修改 DOM 中的某些内容，以便稍后读取。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T14:11:36.880

您不能为普通的 post/get 执行此操作，但是如果您使用 xmlhttp 调用并使用 getResponseHeader，则可以获取此信息

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-29T14:22:07.483

不。

JS 是一种客户端编程语言，这意味着一切都是客户端。但是，您可以使用 PHP 或任何服务器端语言来执行此操作。

如果您要使用 php，以下是一个示例：

```
<?php 
  $foo = $_POST["fooRequest"]; # The actual response.

  # do something with the foo variable like:
  # echo "Response got: " + $foo;
?> 
```

然后添加一些 HTML：

```
 <form action="test.php" method="post">
 <input type="text" class="foo" name="fooRequest" placeholder="Testing requests" />
 <button type="submit" name="submitButton">Send</button>
 </form> 
```

上面的代码发送一个 POST 请求，然后在 PHP 中我们得到 'fooRequest'。但是，如果您要使用 JS，那是不可能的，**就像我说的那样，它是一种客户端编程语言**

我知道已经有了答案，但我只是想再解释一下。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2018-11-03T15:48:06.293

试试这个

```
function getURIQueryString(){
    var params = {};
    var qstring = window.location.toString().substring(window.location.toString().indexOf("?") + 1);
    var regex = /([^&=]+)=([^&=]+)/g;
    var m;
    while (m = regex.exec(qstring)){
        params[decodeURIComponent(m[1])] = decodeURIComponent(m[2])       
    }
    return params
} 
```

它通常有效。比如获取一个名为test的get参数。用这个

```
getURIQueryString().test 
```

但是不可能得到一个post请求

# visual-studio-2005 - Visual Studio ClickOnce 部署 - 证书过期

> ID：121223
> 
> 赞同：7
> 
> 时间：2008-09-23T14:10:07.163
> 
> 标签：visual-studio-2005, clickonce, installation

[我对Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)应用程序的 ClickOnce 部署有疑问。当我构建新设置并尝试像往常一样将其导出并覆盖之前的设置时，Visual Studio 出现说明我的证书已过期。

*[在用于对安装进行签名的证书过期后尝试更新 Visual Studio 2005 ClickOnce 应用程序时收到错误消息](http://support.microsoft.com/?scid=kb%3Ben-us%3B925521&x=6&y=10)*中描述了此行为，并且*[RenewCert-Working Version](http://may.be/renewcert/)*中有解决方法。但是这些解决方案不适用于我的情况。

另一种解决方法是将部署服务器的系统日期恢复到证书到期日期之前的日期（在部署操作期间） - 但我认为这是一个非常“最后的机会”。

我该如何解决这个问题？我可以尝试另一种解决方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T15:22:50.610

我发现了一篇博客文章， James Harte 的*[ClickOnce and Expiring Code Signing Certificates](http://www.jamesharte.com/blog/?p=11)*，它描述了一种让您的应用程序自行删除并启动新 ClickOnce 安装的方法。它对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:11:29.577

大约两年前我遇到了这个问题。如果 RenewCert 不适合您，则确实没有好的解决方法。我什至给 ClickOnce 权威机构 Brian Noyes 发了电子邮件，并确认没有好的解决方法。

我们最终购买了一个 3 年的证书并告诉我们的用户卸载。但是，如果我没记错的话，用户从开始菜单启动应用程序时只会收到错误消息。如果他们访问网页，它会安装应用程序并运行良好。当然，客户随后在他们的机器上拥有 2 个版本的应用程序 :)。我不记得在那种情况下开始菜单快捷方式发生了什么。

# xml - 如何在 XQuery 中将字符串转换为节点？

> ID：121237
> 
> 赞同：5
> 
> 时间：2008-09-23T14:12:22.603
> 
> 标签：xml, xquery, marklogic

我想将字符串转换为节点。我有一个定义为获取节点的方法，但我拥有的值是一个字符串（它是硬编码的）。如何将该字符串转换为节点？

因此，给定一个 XQuery 方法：

```
define function foo($bar as node()*) as node() {
  (: unimportant details :)
} 
```

我有一个要传递给 foo 方法的字符串。如何将字符串转换为节点，以便该方法接受字符串。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T14:15:11.177

**MarkLogic 解决方案：**

将字符串转换为节点的最佳方法是使用：

```
xdmp:unquote($string). 
```

相反，如果要将节点转换为字符串，则可以使用：

```
xdmp:quote($node). 
```

**语言不可知的解决方案：**

节点到字符串是：

```
fn:string($node) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-09T21:47:17.230

如果要从字符串中创建**文本**节点，只需使用**文本**节点构造函数：

```
text { "your string goes here" } 
```

或者，如果您更喜欢使用字符串内容创建**元素**，您可以构造一个类似这样的**元素：**

```
element (some-element) { "your string goes here" } 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-02T19:36:40.223

如果您谈论的是包含 XML 标记的字符串，那么也有标准化的解决方案（来自 XPath/XQuery Functions 3.0）：

*   字符串到节点：[fn:parse-xml()](http://www.w3.org/TR/xpath-functions-30/#func-parse-xml)
*   节点到字符串：[fn:serialize()](http://www.w3.org/TR/xpath-functions-30/#func-serialize)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-23T14:43:50.937

这个问题的答案取决于所使用的引擎。例如，**Saxon**的用户使用该`saxon:parse`方法。

事实上，**XQuery**规范并没有为此内置。

一般来说，如果您需要从**CDATA部分中提取一些嵌入式****XML** ，您只需要使用它。否则，您可以从文件系统中读取文件，或直接内联声明**XML 。**

 ****大多数情况下，您将使用声明形式，而不是硬编码字符串，例如（使用 Stylus studio）

```
declare namespace my = "http://tempuri.org";

declare function my:foo($bar as node()*) as node() {
    <unimportant></unimportant>
} ;

let $bar := <node><child></child></node>

return my:foo(bar) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-09T14:43:24.127

您还可以使用`fn:parse-xml(xs:string)`将当前有效的 XML 字符串转换为文档。

# c - 如何在C中进行无符号饱和加法？

> ID：121240
> 
> 赞同：49
> 
> 时间：2008-09-23T14:12:50.777
> 
> 标签：c, algorithm, performance, signal-processing, saturation-arithmetic

在 C 中编写饱和加法的最佳（最干净、最有效）的方法是什么？

如果总和溢出，函数或宏应添加两个无符号输入（需要 16 位和 32 位版本）并返回全位为一（0xFFFF 或 0xFFFFFFFF）。

目标是使用 gcc (4.1.2) 和 Visual Studio 的 x86 和 ARM（仅用于模拟，因此可以使用后备实现）。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-10-03T11:22:18.257

您可能希望在此处使用可移植的 C 代码，您的编译器会将其转换为正确的 ARM 程序集。ARM 有条件移动，这些移动可以以溢出为条件。然后算法变为：添加并有条件地将目标设置为无符号（-1），如果检测到溢出。

```
uint16_t add16(uint16_t a, uint16_t b)
{
  uint16_t c = a + b;
  if (c < a)  /* Can only happen due to overflow */
    c = -1;
  return c;
} 
```

请注意，这与其他算法的不同之处在于它纠正了溢出，而不是依靠另一个计算来检测溢出。

[add32 的 x86-64 clang 3.7 -O3 输出](https://gcc.godbolt.org/#%7B%22version%22%3A3%2C%22filterAsm%22%3A%7B%22labels%22%3Atrue%2C%22directives%22%3Atrue%2C%22commentOnly%22%3Atrue%2C%22intel%22%3Atrue%7D%2C%22compilers%22%3A%5B%7B%22sourcez%22%3A%22MQSwdgxgNgrgJgUwAQB4DOAXO4MDoAWAfAFCgBmSAjEjQPS1IgQRICGAbgPYhxpIQBbTuyQB3EBnxJJCNMnBIBaVlAwIATmgDkSdhrQhOYUojLhkUEAGsEUAJ4AKAB4BKGu5oB9TwCMYIVXBPBCcABwQIDAcAQmjnFwAaKhcTBDMwZBgwSxt7eI8kbz8AjCCQ8MiYuNckgAYU4Fs5VPSLa1tHVwKaJxbzJCycjvyPXsawbDJiYnokAGVOdTU4RjAkRcR1dYooBFZMJB9WFaMkJwAOADYk8UkkAHNmAFZp%2FzAMSkvPDDY4Xk%2FPEoVGpNA43h8vj9WElwQCfj43ABvYg0WGQ%2FhIAC8bCQAGpDgBuFGMCgOCAoVhuWgAKiQAGFWGsjPYkPhWKFwms4DBkBhOOs9OoyFBOKIkNTaMSaCxsQBaShEmjqBAYGDqNYQIkAX2I4IAzAAmb6%2FXiGwHKVT6ME4M1QmE2o3wpHE%2FWOjHY1h4wnEkCk8mUpA0%2BmM9bZOys9mcpDc3n84QaYWi8WSjwypDyxVIZWq9X8bXTcjRtLmFYObwgPVXbxuAA%2BNaLrVL3guX0uABZqzMGAAVADyABFewAuJC7H4yficAShAIaJBWMBJySscf4ZCccLqRm8NjK1YgiBssD3PY%2BXbTWY8PZQFmHiJWQqeECXKueJBkRb8ITsJJ%2BVcrrQ%2BGZcNTBLd9PxDVhIhgFRGBfS5pFYdQTwwJJFx%2BBBcHuXAIzQURbCgXUHWNY5TSNFtPFCAArCBAWEa13ltNh7UYt0EWIRE6AYNB8EWEF%2BHUCQmBUWVQhXKQoBXBBIHDHxwyMZAIDsaBeSPaQ1yQNAfB8XR9EMYwPFdY0MGnLF0wVKVuis9xZk4gBBbsADJuw8esAEl3lsJAtRoNA7HeVgnDYS11RXEA9DQHCkG7DTOBkLZBQMIw%2BFuXiYFXEA%2BDEAIoEOZVWAfVL0wEfYBExHBbEs0qkAcAAiUiCk4gBSABtHwAF0Ela1h2vcetus6mhWo67yAB0wFGjBassgpasEYRIBoZqWp6rqWt4DBev69bME6gbvOm6ykBHHbNqQWrcXUWqapM0JEiQFbeouxyrpqykZo8E6Rtq%2B5rocBFAwYGA5HO9QBAQa6Py2T12x8CRdM0fSkgMSB5B%2BTAcoGOQ%2BENOH0ZAe4wFlEI1AmBAVhAARwewKSPpshhF34EVtP0OmaBcTMlRVNU1lu%2FMjKhP40DNCjqNorSfAYjAmOhAZiKdDiuM0kqbznCBOEQWUDAALwQX90tHIwTy2CBBNKCARLEu5JNJpSarbFhTgACX2fCbySPVHbWOyAFl%2BzYCYkAAIXUThjjdqBaDmKw7EkmwUnpzTtMYIDeY002hIt3KrfwGFsnaRRhHMqKJYDlZ5pEJDVOQZRwdHKSZNDYLcrpAAFABVNApVmUva71vvo04WQwC0eF8ofCdEE5RBG9OCdOCgFZ2BUHltmjA5TkZcMYPUQ8kBCCAEFCH5ff7SyBekadObYNABBq%2Bq%2FgKYbBoG8bJsO6zatLjxWo2l%2FTvam%2FKabNzqfifo9JIv9dofysidP%2B51MSvQcLde6j1zq4hen9d6R0vpPV%2BjVdiR0OaWWzDzS%2BoR%2BbyxNMLciVYxZPjAKESSh8pYyxYtLNiKROJKwtmsZUwNq6aVYHXeUWYED3EyiCfWPxeGjyQKEUO3JD7qWQMqNAMBVCrBxBkMUyoJGYA0FVW%2B98GpIGfpAx6QCYHdDmt%2BFgrVlCbQsT1axBQTo9XQZgt6CdrK4POvg%2F6qDHFPSQfKKkDB1YaJWAIgOoMBDXXVmATAW4cBNxasE6RhtjjgHuOZd8oc77gyEOocMmVowwAED4ZG%2FJMAbiZoyXJZACmaV4nFHJjAMByCgBQBQE4PxxRAcQjwpDcysHzOMSYrwkkEwyCsRxaopKeFIp4cEngbDsHAGCaZhNyZnDzgYHZKw7DOg8L6GqdhCDtzcgAOW7GaH2dkAAasougjLWFc259ynnXzeWcXEdhKHvDhEIv4AJlRCClsC2WaJjSEPcJxX5DhPSECQLUJwAAxTF6L0yHDcAAflRRirFx0cT4h8ASbyrwqHKD%2BGacFnBWFumhVQuFS0xE5jWEipAKK0VYr5di2UuKkAEt5fyzFJLPRkoJDqaYRFWLGhpXAOljKSLsKYgDbhswmlTiQAAJVwOfHA7YFVmSlsajALhWC4nJSQ7muZZQODQIQQghpaw1QFi4NA%2BY%2BgZBBXAT4SLfxuHdTgOELgHA1RVRapFLhcRRvDQiNwPKnBkFTRQEVKa00kocDGuNiaUgX0VWaDcUbmJy3lU6JACK7Wco9RGnN4JzXhspHGxtHZo2Ju5YStNPb03dt7am7NubAkuA5pSi8QMwBQ1VGAKSt4pwzl2HwPk0hRD8kSdgUoRhYI%2BC3JANcQETbflkL%2BCIrAYnq2nLOTQg8R4%2FHuKHCe%2BBMpyo4QqlcCy1BLNpUaOAJ53glNLcyitQrkSGWpRUsykrvSnNJI6yDKA2C1nrPBu%2BiHE1s1%2BQAPwbfLFw9Rr5NAQJhmtmkKnakDLSeZW4v2kUNMmV9wLqOLNIgCP90kMCAZhXactEJYUnPcNxsjd8PRehtbByN6i0NIaQHWGqUnUC4p8d0bDuGgWQnw0M9wRGSMcuExRoMzHaOgoQhKWVXZooHuQP%2BjQUlWSLEEmeRSGtkBDgcBZuYAB1OyuqkDnC0YaV9TE5grjsn8du2zZnnE8F5nzngwABDQKWpwaq3THKrS6alMySpoAfNiNF5xaiFeK7UTMF8MC1FNeGAAemcNwjlNLZf2FYMrVCPhVaQA1roDWDlgByy14kQVHLYiw71%2FrmZwzDaQKNpruXMxBVxNiAFxJ2s1mxBVzrZxMztexMg6gKBEOUDcIKvb3KUUAHYtOIqCrVirbqPiArfT8ELGAwtwAi718mZoEtQD4Ml1Lxp0tgd40xMbzWzIFdqFD6HpXMsgY27tmrdXNtg7m3Dp70hqCI8291xrhNxuDc6yN1HA2aCTeJ7N0nZw8RLe29QNb0hKtdbp6a9rB3kg4tO86pAeojuZmu0gW79RZOY%2B9RZz7cyP00f0sQLLhzPCKs8C7MAi44BUQQA4KhssWUuGBzQCDIm2DWuvlQ%2BMQoRRil20i6rUmXCOX%2Bjbipo7nW85%2BaRhwZvEyiAO7zlw1XUPc494KL3jlffEJlakkqmzdc6iAAAA%22%2C%22compiler%22%3A%22g530%22%2C%22options%22%3A%22-xc%20-Wall%20-fverbose-asm%20%20-O3%20-mtune%3Dhaswell%22%7D%5D%7D)：明显优于任何其他答案：

```
add     edi, esi
mov     eax, -1
cmovae  eax, edi
ret 
```

[ARMv7：`gcc 4.8 -O3 -mcpu=cortex-a15 -fverbose-asm`adds32 的输出](https://gcc.godbolt.org/#%7B%22version%22%3A3%2C%22filterAsm%22%3A%7B%22labels%22%3Atrue%2C%22directives%22%3Atrue%2C%22commentOnly%22%3Atrue%7D%2C%22compilers%22%3A%5B%7B%22sourcez%22%3A%22MQSwdgxgNgrgJgUwAQB4DOAXO4MDoAWAfAFCgBmSAjEjQPS1IgQRICGAbgPYhxpIQBbTuyQB3EBnxJJCNMnBIBaVlAwIATmgDkSdhrQhOYUojLhkUEAGsEUAJ4AKAB4BKGu5oB9TwCMYIVXBPBCcABwQIDAcAQmjnFwAaKhcTBDMwZBgwSxt7eI8kbz8AjCCQ8MiYuNckgAYU4Fs5VPSLa1tHVwKaJxbzJCycjvyPXsawbDJiYnokAGVOdTU4RjAkRcR1dYooBFZMJB9WFaMkJwAOADYk8UkkAHNmAFZp%2FzAMSkvPDDY4Xk%2FPEoVGpNA43h8vj9WElwQCfj43ABvYg0WGQ%2FhIAC8bCQAGpDgBuFGMCgOCAoVhuWgAKiQAGFWGsjPYkPhWKFwms4DBkBhOOs9OoyFBOKIkNTaMSaCxsQBaShEmjqBAYGDqNYQIkAX2I4IAzAAmb6%2FXiGwHKVT6ME4M1QmE2o3wpHE%2FWOjHY1h4wnEkCk8mUpA0%2BmM9bZOys9mcpDc3n84QaYWi8WSjwypDyxVIZWq9X8bXTcjRtLmFYObwgPVXbxuAA%2BNaLrVL3guX0uABZqzMGAAVADyABFewAuJC7H4yficAShAIaJBWMBJySscf4ZCccLqRm8NjK1YgiBssD3PY%2BXbTWY8PZQFmHiJWQqeECXKueJBkRb8ITsJJ%2BVcrrQ%2BGZcNTBLd9PxDVhIhgFRGBfS5pFYdQTwwJJFx%2BBBcHuXAIzQURbCgXUHWNY5TSNFtPFCAArCBAWEa13ltNh7UYt0EWIRE6AYNB8EWEF%2BHUCQmBUWVQhXKQoBXBBIHDHxwyMZAIDsaBeSPaQ1yQNAfB8XR9EMYwPFdY0MGnLF0wVKVuis9xZk4gBBbsADJuw8esAEl3lsJAtRoNA7HeVgnDYS11RXEA9DQHCkG7DTOBkLZBQMIw%2BFuXiYFXEA%2BDEAIoEOZVWAfVL0wEfYBExHBbEs0qkAcAAiUiCk4gBSABtHwAF0Ela1h2vcetus6mhWo67yAB0wFGjBassgpasEYRIBoZqWp6rqWt4DBev69bME6gbvOm6ykBHHbNqQWrcXUWqapM0JEiQFbeouxyrpqykZo8E6Rtq%2B5rocBFAwYGA5HO9QBAQa6Py2T12x8CRdM0fSkgMSB5B%2BTAcoGOQ%2BENOH0ZAe4wFlEI1AmBAVhAARwewKSPpshhF34EVtP0OmaBcTMlRVNU1lu%2FMjKhP40DNCjqNorSfAYjAmOhAZiKdDiuM0kqbznCBOEQWUDAALwQX90tHIwTy2CBBNKCARLEu5JNJpSarbFhTgACX2fCbySPVHbWOyAFl%2BzYCYkAAIXUThjjdqBaDmKw7EkmwUnpzTtMYIDeY002hIt3KrfwGFsnaRRhHMqKJYDlZ5pEJDVOQZRwdHKSZNDYLcrpAAFABVNApVmUva71vvo04WQwC0eF8ofCdEE5RBG9OCdOCgFZ2BUHltmjA5TkZcMYPUQ8kBCCAEFCH5ff7SyBekadObYNABBq%2Bq%2FgKYbBoG8bJsO6zatLjxWo2l%2FTvam%2FKabNzqfifo9JIv9dofysidP%2B51MSvQcLde6j1zq4hen9d6R0vpPV%2BjVdiR0OaWWzDzS%2BoR%2BbyxNMLciVYxZPjAKESSh8pYyxYtLNiKROJKwtmsZUwNq6aVYHXeUWYED3EyiCfWPxeGjyQKEUO3JD7qWQMqNAMBVCrBxBkMUyoJGYA0FVW%2B98GpIGfpAx6QCYHdDmt%2BFgrVlCbQsT1axBQTo9XQZgt6CdrK4POvg%2F6qDHFPSQfKKkDB1YaJWAIgOoMBDXXVmATAW4cBNxasE6RhtjjgHuOZd8oc77gyEOocMmVowwAED4ZG%2FJMAbiZoyXJZACmaV4nFHJjAMByCgBQBQE4PxxRAcQjwpDcysHzOMSYrwkkEwyCsRxaopKeFIp4cEngbDsHAGCaZhNyZnDzgYHZKw7DOg8L6GqdhCDtzcgAOW7GaH2dkAAasougjLWFc259ynnXzeWcXEdhKHvDhEIv4AJlRCClsC2WaJjSEPcJxX5DhPSECQLUJwAAxTF6L0yHDcAAflRRirFx0cT4h8ASbyrwqHKD%2BGacFnBWFumhVQuFS0xE5jWEipAKK0VYr5di2UuKkAEt5fyzFJLPRkoJDqaYRFWLGhpXAOljKSLsKYgDbhswmlTiQAAJVwOfHA7YFVmSlsajALhWC4nJSQ7muZZQODQIQQghpaw1QFi4NA%2BY%2BgZBBXAT4SLfxuHdTgOELgHA1RVRapFLhcRRvDQiNwPKnBkFTRQEVKa00kocDGuNiaUgX0VWaDcUbmJy3lU6JACK7Wco9RGnN4JzXhspHGxtHZo2Ju5YStNPb03dt7am7NubAkuA5pSi8QMwBQ1VGAKSt4pwzl2HwPk0hRD8kSdgUoRhYI%2BC3JANcQETbflkL%2BCIrAYnq2nLOTQg8R4%2FHuKHCe%2BBMpyo4QqlcCy1BLNpUaOAJ53glNLcyitQrkSGWpRUsykrvSnNJI6yDKA2C1nrPBu%2BiHE1s1%2BQAPwbfLFw9Rr5NAQJhmtmkKnakDLSeZW4v2kUNMmV9wLqOLNIgCP90kMCAZhXactEJYUnPcNxsjd8PRehtbByN6i0NIaQHWGqUnUC4p8d0bDuGgWQnw0M9wRGSMcuExRoMzHaOgoQhKWVXZooHuQP%2BjQUlWSLEEmeRSGtkBDgcBZuYAB1OyuqkDnC0YaV9TE5grjsn8du2zZnnE8F5nzngwABDQKWpwaq3THKrS6alMySpoAfNiNF5xaiFeK7UTMF8MC1FNeGAAemcNwjlNLZf2FYMrVCPhVaQA1roDWDlgByy14kQVHLYiw71%2FrmZwzDaQKNpruXMxBVxNiAFxJ2s1mxBVzrZxMztexMg6gKBEOUDcIKvb3KUUAHYtOIqCrVirbqPiArfT8ELGAwtwAi718mZoEtQD4Ml1Lxp0tgd40xMbzWzIFdqFD6HpXMsgY27tmrdXNtg7m3Dp70hqCI8291xrhNxuDc6yN1HA2aCTeJ7N0nZw8RLe29QNb0hKtdbp6a9rB3kg4tO86pAeojuZmu0gW79RZOY%2B9RZz7cyP00f0sQLLhzPCKs8C7MAi44BUQQA4KhssWUuGBzQCDIm2DWuvlQ%2BMQoRRil20i6rUmXCOX%2Bjbipo7nW85%2BaRhwZvEyiAO7zlw1XUPc494KL3jlffEJlakkqmzdc6iAAAA%22%2C%22compiler%22%3A%22armhfg482%22%2C%22options%22%3A%22-xc%20-std%3Dgnu99%20-Wall%20-pedantic%20-Wextra%20-fverbose-asm%20%20-O3%20-march%3Darmv7%22%7D%5D%7D)：

```
adds    r0, r0, r1      @ c, a, b
it      cs
movcs   r0, #-1         @ conditional-move
bx      lr 
```

16 位：仍然不使用 ARM 的无符号饱和加法指令 ( `UADD16`)

```
add     r1, r1, r0        @ tmp114, a
movw    r3, #65535      @ tmp116,
uxth    r1, r1  @ c, tmp114
cmp     r0, r1    @ a, c
ite     ls        @
movls   r0, r1        @,, c
movhi   r0, r3        @,, tmp116
bx      lr  @ 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-23T16:57:56.747

在普通 C 中：

```
uint16_t sadd16(uint16_t a, uint16_t b) {
  return (a > 0xFFFF - b) ? 0xFFFF : a + b;
}

uint32_t sadd32(uint32_t a, uint32_t b) {
  return (a > 0xFFFFFFFF - b) ? 0xFFFFFFFF : a + b;
} 
```

几乎是宏观化的，直接传达意思。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-23T14:31:08.627

在没有条件跳转的 IA32 中：

```
uint32_t sadd32(uint32_t a, uint32_t b)
{
#if defined IA32
  __asm
  {
    mov eax,a
    xor edx,edx
    add eax,b
    setnc dl
    dec edx
    or eax,edx
  }
#elif defined ARM
  // ARM code
#else
  // non-IA32/ARM way, copy from above
#endif
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-23T14:26:12.180

在 ARM 中，您可能已经内置了饱和算术。ARMv5 DSP 扩展可以使寄存器饱和到任何位长。同样在 ARM 上，饱和通常很便宜，因为您可以有条件地执行大多数指令。

ARMv6 甚至具有饱和加法、减法和所有其他 32 位和压缩数字的东西。

在 x86 上，您可以通过 MMX 或 SSE 获得饱和算术。

所有这些都需要汇编程序，所以这不是您所要求的。

也有 C 技巧可以做饱和算术。这个小代码对 dword 的四个字节进行饱和加法。它基于并行计算32个半加器的想法，例如添加数字而没有进位溢出。

这是首先完成的。然后计算进位，添加并在加法溢出时用掩码替换。

```
uint32_t SatAddUnsigned8(uint32_t x, uint32_t y) 
{
  uint32_t signmask = 0x80808080;
  uint32_t t0 = (y ^ x) & signmask;
  uint32_t t1 = (y & x) & signmask;
  x &= ~signmask;
  y &= ~signmask;
  x += y;
  t1 |= t0 & x;
  t1 = (t1 << 1) - (t1 >> 7);
  return (x ^ t0) | t1;
} 
```

您可以通过更改符号掩码常量和底部的移位来获得相同的 16 位（或任何类型的位域），如下所示：

```
uint32_t SatAddUnsigned16(uint32_t x, uint32_t y) 
{
  uint32_t signmask = 0x80008000;
  uint32_t t0 = (y ^ x) & signmask;
  uint32_t t1 = (y & x) & signmask;
  x &= ~signmask;
  y &= ~signmask;
  x += y;
  t1 |= t0 & x;
  t1 = (t1 << 1) - (t1 >> 15);
  return (x ^ t0) | t1;
}

uint32_t SatAddUnsigned32 (uint32_t x, uint32_t y)
{
  uint32_t signmask = 0x80000000;
  uint32_t t0 = (y ^ x) & signmask;
  uint32_t t1 = (y & x) & signmask;
  x &= ~signmask;
  y &= ~signmask;
  x += y;
  t1 |= t0 & x;
  t1 = (t1 << 1) - (t1 >> 31);
  return (x ^ t0) | t1;
} 
```

上面的代码对 16 位和 32 位值执行相同的操作。

如果您不需要函数并行添加和饱和多个值的功能，只需屏蔽您需要的位。在 ARM 上，您还想更改符号掩码常量，因为 ARM 无法在单个周期内加载所有可能的 32 位常量。

**编辑：**并行版本很可能比直接方法慢，但如果您必须一次饱和多个值，它们会更快。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-23T17:07:19.907

如果您关心性能，那么您*真的*想在 SIMD 中做这种事情，其中​​ x86 具有本机饱和算法。

由于标量数学中缺乏饱和算术，因此可能会遇到这样的情况：在 4 变量宽 SIMD 上完成的运算*比*等效的 C 快 4 倍以上（相应地，对于 8 变量宽 SIMD 也是如此）：

```
sub8x8_dct8_c: 1332 clocks
sub8x8_dct8_mmx: 182 clocks
sub8x8_dct8_sse2: 127 clocks 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-08-07T19:12:30.933

零分支解决方案：

```
uint32_t sadd32(uint32_t a, uint32_t b)
{
    uint64_t s = (uint64_t)a+b;
    return -(s>>32) | (uint32_t)s;
} 
```

一个好的编译器会对此进行优化以避免执行任何实际的 64 位算术（`s>>32`将仅仅是进位标志，并且`-(s>>32)`是 的结果`sbb %eax,%eax`）。

在 x86 asm 中（AT&T 语法，在`a`and中，结果为）：`b``eax``ebx``eax`

```
add %eax,%ebx
sbb %eax,%eax
or %ebx,%eax 
```

8 位和 16 位版本应该很明显。签名版本可能需要更多的工作。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-23T14:17:08.863

```
uint32_t saturate_add32(uint32_t a, uint32_t b)
{
    uint32_t sum = a + b;
    if ((sum < a) || (sum < b))
        return ~((uint32_t)0);
    else
        return sum;
} /* saturate_add32 */

uint16_t saturate_add16(uint16_t a, uint16_t b)
{
    uint16_t sum = a + b;
    if ((sum < a) || (sum < b))
        return ~((uint16_t)0);
    else
        return sum;
} /* saturate_add16 */ 
```

**编辑：**既然您已经发布了您的版本，我不确定我的版本是否更清洁/更好/更高效/更研究。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-23T14:18:30.200

我们正在使用的当前实现是：

```
#define sadd16(a, b)  (uint16_t)( ((uint32_t)(a)+(uint32_t)(b)) > 0xffff ? 0xffff : ((a)+(b)))
#define sadd32(a, b)  (uint32_t)( ((uint64_t)(a)+(uint64_t)(b)) > 0xffffffff ? 0xffffffff : ((a)+(b))) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-23T15:37:28.653

我不确定这是否比 Skizz 的解决方案（总是配置文件）更快，但这里有一个替代的无分支组装解决方案。请注意，这需要条件移动（CMOV）指令，我不确定您的目标是否可用。

```
 uint32_t sadd32(uint32_t a, uint32_t b)
{
    __asm
    {
        movl eax, a
        addl eax, b
        movl edx, 0xffffffff
        cmovc eax, edx
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-24T00:22:57.970

最好的性能通常涉及内联汇编（正如一些人已经说过的）。

但是对于可移植的 C，这些功能只涉及一个比较并且没有类型转换（因此我认为是最佳的）：

```
unsigned saturate_add_uint(unsigned x, unsigned y)
{
    if (y > UINT_MAX - x) return UINT_MAX;
    return x + y;
}

unsigned short saturate_add_ushort(unsigned short x, unsigned short y)
{
    if (y > USHRT_MAX - x) return USHRT_MAX;
    return x + y;
} 
```

作为宏，它们变成：

```
SATURATE_ADD_UINT(x, y) (((y)>UINT_MAX-(x)) ? UINT_MAX : ((x)+(y)))
SATURATE_ADD_USHORT(x, y) (((y)>SHRT_MAX-(x)) ? USHRT_MAX : ((x)+(y))) 
```

我将 'unsigned long' 和 'unsigned long long' 的版本留给读者作为练习。;-)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-01T08:54:46.433

以防万一有人想知道一个实现而不使用 2 的补码 32 位整数进行分支。

警告！此代码使用未定义的操作：“右移 -1”，因此利用[Intel Pentium SAL 指令](http://eun.github.io/Intel-Pentium-Instruction-Set-Reference/data/shl.html)的属性将计数操作数屏蔽为 5 位。

```
int32_t sadd(int32_t a, int32_t b){
    int32_t sum = a+b;
    int32_t overflow = ((a^sum)&(b^sum))>>31;
    return (overflow<<31)^(sum>>overflow);
 } 
```

这是我所知道的最好的实现

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-23T14:24:19.330

我想，x86 的最佳方法是使用内联汇编程序在添加后检查溢出标志。就像是：

```
add eax, ebx
jno @@1
or eax, 0FFFFFFFFh
@@1:
....... 
```

它不是很便携，但恕我直言，这是最有效的方式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-01-21T18:28:59.970

无分支 x86 asm 解决方案的替代方案是（AT&T 语法，eax 和 ebx 中的 a 和 b，导致 eax）：

```
add %eax,%ebx
sbb $0,%ebx 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-09-22T06:49:05.013

```
int saturating_add(int x, int y)
{
    int w = sizeof(int) << 3;
    int msb = 1 << (w-1);

    int s = x + y;
    int sign_x = msb & x;
    int sign_y = msb & y;
    int sign_s = msb & s;

    int nflow = sign_x && sign_y && !sign_s;
    int pflow = !sign_x && !sign_y && sign_s;

    int nmask = (~!nflow + 1);
    int pmask = (~!pflow + 1);

    return (nmask & ((pmask & s) | (~pmask & ~msb))) | (~nmask & msb);
} 
```

这个实现不使用控制流、campare 操作符( `==`, `!=`) 和`?:`操作符。它只使用位运算符和逻辑运算符。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-06-17T12:08:27.423

*使用 C++，您可以编写Remo.D*解决方案的更灵活变体：

```
template<typename T>
T sadd(T first, T second)
{
    static_assert(std::is_integral<T>::value, "sadd is not defined for non-integral types");
    return first > std::numeric_limits<T>::max() - second ? std::numeric_limits<T>::max() : first + second;
} 
```

这可以很容易地转换为 C 使用定义的限制`limits.h`。另请注意，[固定宽度整数类型](http://en.cppreference.com/w/cpp/types/integer)可能在您的系统上不可用。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-03-08T20:58:30.380

```
//function-like macro to add signed vals, 
//then test for overlow and clamp to max if required
#define SATURATE_ADD(a,b,val)  ( {\
if( (a>=0) && (b>=0) )\
{\
    val = a + b;\
    if (val < 0) {val=0x7fffffff;}\
}\
else if( (a<=0) && (b<=0) )\
{\
    val = a + b;\
    if (val > 0) {val=-1*0x7fffffff;}\
}\
else\
{\
    val = a + b;\
}\
}) 
```

我做了一个快速测试，似乎可以工作，但还没有广泛地抨击它！这适用于 SIGNED 32 位。op：网页上使用的编辑器不允许我发布宏，即它不理解非缩进语法等！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-09-19T17:57:03.353

饱和算法不是 C 的标准，但它通常通过编译器内在函数实现，因此最有效的方法不是最干净的。您必须添加`#ifdef`块以选择正确的方式。MSalters 的答案是 x86 架构中最快的。对于 ARM，16 位版本和32 位版本需要使用（Microsoft Visual Studio）的`__qadd16`函数（ARM 编译器） 。它们将被自动转换为一条 ARM 指令。`_arm_qadd16``__qadd`

*链接：*

*   [`__qadd16`](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0491c/CJAICDDF.html)
*   [`_arm_qadd16`](https://docs.microsoft.com/en-us/cpp/intrinsics/arm-intrinsics?view=vs-2019)
*   [`__qadd`](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0472m/chr1359125002575.html)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-12-18T12:15:56.193

我将添加上面尚未提到的解决方案。

Intel x86 中存在[ADC](https://x86.puri.sm/html/file_module_x86_id_4.html)指令。它表示为[_addcarry_u32()](https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html#ig_expand=196,196,226,196&techs=SSE,SSE2,Other&text=addcarry_u32)内在函数。对于 ARM，应该有类似的内在特性。

`uint32_t`这使我们能够为 Intel x86实现非常快速的饱和加法：

[在线尝试！](https://godbolt.org/z/8snavvP9G)

```
#include <stdint.h>
#include <immintrin.h>

uint32_t add_sat_u32(uint32_t a, uint32_t b) {
    uint32_t r, carry = _addcarry_u32(0, a, b, &r);
    return r | (-carry);
} 
```

Intel x86 MMX 饱和加法指令可用于实现`uint16_t`变体：

[在线尝试！](https://godbolt.org/z/o7azhsqz1)

```
#include <stdint.h>
#include <immintrin.h>

uint16_t add_sat_u16(uint16_t a, uint16_t b) {
    return _mm_cvtsi64_si32(_mm_adds_pu16(
        _mm_cvtsi32_si64(a),
        _mm_cvtsi32_si64(b)
    ));
} 
```

我没有提到 ARM 解决方案，因为它可以通过其他答案的其他通用解决方案来实现。

# sql-server - SQL Server 的隐藏特性

> ID：121243
> 
> 赞同：215
> 
> 时间：2008-09-23T14:13:42.803
> 
> 标签：sql-server, tsql

[SQL Server](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)有哪些隐藏的功能？

例如，未记录的系统存储过程，做一些非常有用但记录不足的事情的技巧？

* * *

## 答案

*感谢大家的所有伟大的答案！*

**存储过程**

*   **sp_msforeachtable：**运行带有“？”的命令 替换为每个表名（v6.5 及更高版本）
*   **sp_msforeachdb：**运行带有“？”的命令 替换为每个数据库名称（v7 及更高版本）
*   **sp_who2：**与 sp_who 类似，但有更多信息用于块故障排除（v7 及更高版本）
*   **sp_helptext：**如果要存储过程的代码，查看&UDF
*   **sp_tables：**返回范围内数据库的所有表和视图的列表。
*   **sp_stored_procedures：**返回所有存储过程的列表
*   **xp_sscanf：**将字符串中的数据读取到每个格式参数指定的参数位置。
*   **xp_fixeddrives:** : 找到可用空间最大的固定驱动器
*   **sp_help：**如果你想知道一个表的表结构、索引和约束。还有视图和 UDF。快捷键是 Alt+F1

**片段**

*   以随机顺序返回行
*   按上次修改日期的所有数据库用户对象
*   仅返回日期
*   查找日期在当前周内某处的记录。
*   查找上周发生日期的记录。
*   返回当前周开始的日期。
*   返回上周开始的日期。
*   查看已部署到服务器的过程的文本
*   删除与数据库的所有连接
*   表校验和
*   行校验和
*   删除数据库中的所有过程
*   恢复后正确重新映射登录 ID
*   从 INSERT 语句调用存储过程
*   按关键字查找程序
*   删除数据库中的所有过程
*   以编程方式查询数据库的事务日志。

**功能**

*   哈希字节（）
*   密钥加密
*   PIVOT 命令

**杂项**

*   连接字符串附加功能
*   TableDiff.exe
*   登录事件触发器（Service Pack 2 中的新增功能）
*   使用持久计算列 (pcc) 提高性能。
*   sys.database_principles 中的 DEFAULT_SCHEMA 设置
*   强制参数化
*   Vardecimal 存储格式
*   在几秒钟内找出最受欢迎的查询
*   可扩展的共享数据库
*   SQL Management Studio 中的表/存储过程过滤器功能
*   跟踪标志
*   a`GO`重复批次后的编号
*   使用模式的安全性
*   使用带有触发器的内置加密函数、视图和基表进行加密

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2008-09-26T18:13:54.563

在 Management Studio 中，您可以在 GO 批次结束标记之后放置一个数字，以使批次重复该次数：

```
PRINT 'X'
GO 10 
```

将打印 'X' 10 次。这可以使您在做重复性工作时免于繁琐的复制/粘贴。

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-08-07T09:03:38.943

许多 SQL Server 开发人员似乎仍然不知道 DELETE、INSERT 和 UPDATE 语句中的**[OUTPUT 子句](http://msdn.microsoft.com/en-us/library/ms177564.aspx)**（SQL Server 2005 和更新版本）。

知道哪些行已被插入、更新或删除是非常有用的，并且 OUTPUT 子句允许非常容易地做到这一点 - 它允许访问称为`inserted`and的“虚拟”表`deleted`（就像在触发器中一样）：

```
DELETE FROM (table)
OUTPUT deleted.ID, deleted.Description
WHERE (condition) 
```

如果您将值插入到具有 INT IDENTITY 主键字段的表中，使用 OUTPUT 子句，您可以立即获得插入的新 ID：

```
INSERT INTO MyTable(Field1, Field2)
OUTPUT inserted.ID
VALUES (Value1, Value2) 
```

如果您正在更新，了解更改的内容可能非常有用 - 在这种情况下，`inserted`代表新值（在 UPDATE 之后），而`deleted`指的是 UPDATE 之前的旧值：

```
UPDATE (table)
SET field1 = value1, field2 = value2
OUTPUT inserted.ID, deleted.field1, inserted.field1
WHERE (condition) 
```

如果会返回大量信息，也可以将 OUTPUT 的输出重定向到临时表或表变量 ( `OUTPUT INTO @myInfoTable`)。

非常有用——而且鲜为人知！

马克

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2008-09-23T15:10:24.867

`sp_msforeachtable`: 使用 '?' 运行命令 替换为每个表名。例如

```
exec sp_msforeachtable "dbcc dbreindex('?')" 
```

每个表最多可以发出 3 个命令

```
exec sp_msforeachtable
    @Command1 = 'print ''reindexing table ?''',
    @Command2 = 'dbcc dbreindex(''?'')',
    @Command3 = 'select count (*) [?] from ?' 
```

还，`sp_MSforeachdb`

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2008-09-23T15:21:30.270

Connection String extras:

**MultipleActiveResultSets=true;**

This makes ADO.Net 2.0 and above read multiple, forward-only, read-only results sets on a single database connection, which can improve performance if you're doing a lot of reading. You can turn it on even if you're doing a mix of query types.

**Application Name=MyProgramName**

Now when you want to see a list of active connections by querying the sysprocesses table, your program's name will appear in the program_name column instead of ".Net SqlClient Data Provider"

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2008-09-23T16:09:25.333

**TableDiff.exe**

*   表差异工具允许您发现和协调源表和目标表或视图之间的差异。Tablediff 实用程序可以报告模式和数据的差异。tablediff 最受欢迎的功能是它可以生成一个脚本，您可以在目标上运行该脚本来协调表之间的差异。

[关联](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2008-09-23T15:13:40.990

一种鲜为人知的 TSQL 技术，用于以随机顺序返回行：

```
-- Return rows in a random order
SELECT 
    SomeColumn 
FROM 
    SomeTable
ORDER BY 
    CHECKSUM(NEWID()) 
```

* * *

## 回答 #7

> 赞同：30
> 
> 时间：2010-07-20T15:22:36.447

在 Management Studio 中，您可以通过以下方式快速获取以逗号分隔的表格列列表：

1.  在对象资源管理器中，展开给定表下的节点（这样您将看到列、键、约束、触发器等文件夹）
2.  指向 Columns 文件夹并拖动到查询中。

当您不想使用通过右键单击表并选择 Script Table As...，然后选择 Insert To... 返回的令人发指的格式时，这很方便。这个技巧适用于其他文件夹，因为它会给你文件夹中包含的名称的逗号分隔列表。

* * *

## 回答 #8

> 赞同：23
> 
> 时间：2009-12-18T19:39:27.307

**行构造函数**

您可以使用单个插入语句插入多行数据。

```
INSERT INTO Colors (id, Color)
VALUES (1, 'Red'),
       (2, 'Blue'),
       (3, 'Green'),
       (4, 'Yellow') 
```

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2008-09-26T14:54:03.107

如果你想知道表结构、索引和约束：

```
sp_help 'TableName' 
```

* * *

## 回答 #10

> 赞同：22
> 
> 时间：2008-09-23T14:21:35.373

[HashBytes()](http://msdn.microsoft.com/en-us/library/ms174415(SQL.90).aspx)返回其输入的 MD2、MD4、MD5、SHA 或 SHA1 哈希。

* * *

## 回答 #11

> 赞同：20
> 
> 时间：2008-09-29T17:03:14.253

**找出最受欢迎的查询**

*   使用 sys.dm_exec_query_stats，您可以通过单个查询找出多种查询分析组合。

与命令[链接](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

```
select * from sys.dm_exec_query_stats 
order by execution_count desc 
```

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2011-03-22T12:35:49.240

[空间结果选项卡可用于创建艺术](http://michaeljswart.com/2010/02/more-images-from-the-spatial-results-tab/)。

[在此处输入链接描述 http://michaeljswart.com/wp-content/uploads/2010/02/venus.png](http://michaeljswart.com/wp-content/uploads/2010/02/venus.png)

* * *

## 回答 #13

> 赞同：16
> 
> 时间：2008-09-23T17:56:07.870

在为测试目的或其他目的恢复数据库时很有用。正确重新映射登录 ID：

```
EXEC sp_change_users_login 'Auto_Fix', 'Mary', NULL, 'B3r12-36' 
```

* * *

## 回答 #14

> 赞同：16
> 
> 时间：2008-11-25T19:36:01.380

**[除了和相交](http://msdn.microsoft.com/en-us/library/ms188055(SQL.90).aspx)**

在比较两个查询结果时，这两个关键字不是编写复杂的连接和子查询，而是一种更优雅的速记和可读性表达查询意图的方式。作为 SQL Server 2005 的新功能，它们有力地补充了 TSQL 语言中已经存在多年的 UNION。

EXCEPT、INTERSECT 和 UNION 的概念是集合论的基础，集合论是所有现代 RDBMS 使用的关系建模的基础。现在，使用 TSQL 可以更直观、更轻松地生成维恩图类型结果。

* * *

## 回答 #15

> 赞同：16
> 
> 时间：2008-10-08T23:36:51.570

我知道它并没有完全隐藏，但没有太多人知道[​​ PIVOT](http://msdn.microsoft.com/en-us/library/ms177410.aspx)命令。我能够更改一个使用游标的存储过程，并且需要 2 分钟才能快速运行 6 秒的代码，该代码是行数的十分之一！

* * *

## 回答 #16

> 赞同：15
> 
> 时间：2008-09-23T15:56:16.393

删除与数据库的所有连接：

```
Use Master
Go

Declare @dbname sysname

Set @dbname = 'name of database you want to drop connections from'

Declare @spid int
Select @spid = min(spid) from master.dbo.sysprocesses
where dbid = db_id(@dbname)
While @spid Is Not Null
Begin
        Execute ('Kill ' + @spid)
        Select @spid = min(spid) from master.dbo.sysprocesses
        where dbid = db_id(@dbname) and spid > @spid
End 
```

* * *

## 回答 #17

> 赞同：15
> 
> 时间：2008-09-23T15:56:53.443

表校验和

```
Select CheckSum_Agg(Binary_CheckSum(*)) From Table With (NOLOCK) 
```

行校验和

```
Select CheckSum_Agg(Binary_CheckSum(*)) From Table With (NOLOCK) Where Column = Value 
```

* * *

## 回答 #18

> 赞同：15
> 
> 时间：2009-05-21T18:10:32.420

我不确定这是否是一个隐藏功能，但我偶然发现了这一点，并发现它在许多场合都很有用。您可以在单个 select 语句中连接一组字段，而不是使用游标并循环通过 select 语句。

例子：

```
DECLARE @nvcConcatonated nvarchar(max)
SET @nvcConcatonated = ''

SELECT @nvcConcatonated = @nvcConcatonated + C.CompanyName + ', '
FROM tblCompany C
WHERE C.CompanyID IN (1,2,3)

SELECT @nvcConcatonated 
```

结果：

```
Acme, Microsoft, Apple, 
```

* * *

## 回答 #19

> 赞同：14
> 
> 时间：2008-09-23T16:56:14.503

如果您想要存储过程的代码，您可以：

```
sp_helptext 'ProcedureName' 
```

（不确定它是否是隐藏功能，但我一直在使用它）

* * *

## 回答 #20

> 赞同：13
> 
> 时间：2008-09-26T08:58:55.500

一个存储过程技巧是您可以从 INSERT 语句中调用它们。当我在处理 SQL Server 数据库时，我发现这非常有用。

```
CREATE TABLE #toto (v1 int, v2 int, v3 char(4), status char(6))
INSERT #toto (v1, v2, v3, status) EXEC dbo.sp_fulubulu(sp_param1)
SELECT * FROM #toto
DROP TABLE #toto 
```

* * *

## 回答 #21

> 赞同：12
> 
> 时间：2009-02-10T15:22:30.683

在 SQL Server 2005/2008 中显示 SELECT 查询结果中的行号：

```
SELECT ( ROW_NUMBER() OVER (ORDER BY OrderId) ) AS RowNumber,
        GrandTotal, CustomerId, PurchaseDate
FROM Orders 
```

ORDER BY 是强制条款。OVER() 子句告诉 SQL 引擎对指定列（在本例中为 OrderId）上的数据进行排序，并根据排序结果分配数字。

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2008-09-23T14:47:43.407

用于解析存储过程参数：[xp_sscanf](http://msdn.microsoft.com/en-us/library/ms181431(SQL.90).aspx)

> 将字符串中的数据读取到每个格式参数指定的参数位置。
> 
> 以下示例使用 xp_sscanf 根据它们在源字符串格式中的位置从源字符串中提取两个值。

```
DECLARE @filename varchar (20), @message varchar (20)
EXEC xp_sscanf 'sync -b -fproducts10.tmp -rrandom', 'sync -b -f%s -r%s', 
  @filename OUTPUT, @message OUTPUT
SELECT @filename, @message 
```

> 这是结果集。

```
-------------------- -------------------- 
products10.tmp        random 
```

* * *

## 回答 #23

> 赞同：9
> 
> 时间：2008-09-23T15:54:23.467

仅返回日期

```
Select Cast(Floor(Cast(Getdate() As Float))As Datetime) 
```

或者

```
Select DateAdd(Day, 0, DateDiff(Day, 0, Getdate())) 
```

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2010-08-30T15:40:59.587

dm_db_index_usage_stats

这使您可以知道表中的数据最近是否已更新，即使表上没有 DateUpdated 列也是如此。

```
SELECT OBJECT_NAME(OBJECT_ID) AS DatabaseName, last_user_update,*
FROM sys.dm_db_index_usage_stats
WHERE database_id = DB_ID( 'MyDatabase')
AND OBJECT_ID=OBJECT_ID('MyTable') 
```

代码来自：http: [//blog.sqlauthority.com/2009/05/09/sql-server-find-last-date-time-updated-for-any-table/](http://blog.sqlauthority.com/2009/05/09/sql-server-find-last-date-time-updated-for-any-table/)

引用自： [SQL Server - 表的最后插入行的日期/时间是什么？](https://stackoverflow.com/questions/837709/sql-server-what-is-the-date-time-of-the-last-inserted-row-of-a-table)

在 SQL 2005 及更高版本中可用

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2008-09-29T17:00:54.993

**持久计算列**

*   计算列可以帮助您将运行时计算成本转移到数据修改阶段。计算列与行的其余部分一起存储，并在计算列上的表达式与查询匹配时透明地使用。您还可以在 PCC 上构建索引以加快表达式的过滤和范围扫描。

[关联](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

* * *

## 回答 #26

> 赞同：7
> 
> 时间：2008-09-23T15:55:41.823

查找日期在当前周内某处的记录。

```
where dateadd( week, datediff( week, 0, TransDate ), 0 ) =
dateadd( week, datediff( week, 0, getdate() ), 0 ) 
```

查找上周发生日期的记录。

```
where dateadd( week, datediff( week, 0, TransDate ), 0 ) =
dateadd( week, datediff( week, 0, getdate() ) - 1, 0 ) 
```

返回当前周开始的日期。

```
select dateadd( week, datediff( week, 0, getdate() ), 0 ) 
```

返回上周开始的日期。

```
select dateadd( week, datediff( week, 0, getdate() ) - 1, 0 ) 
```

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2008-09-23T23:17:05.227

与其说是隐藏功能，不如说是在 Management Studio 中的 Tools\Options\Keyboard 下设置键映射：Alt+F1 默认为 sp_help“选定文本”，但如果不为 sp_helptext“选定文本”添加 Ctrl+F1，我将无法生存

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2010-09-05T15:37:31.463

There are times when there's no suitable column to sort by, or you just want the default sort order on a table and you want to enumerate each row. In order to do that you can put "(select 1)" in the "order by" clause and you'd get what you want. Neat, eh?

```
select row_number() over (order by (select 1)), * from dbo.Table as t 
```

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2008-09-23T14:18:59.937

以下是一些我觉得有用但很多人似乎不知道的功能：

```
sp_tables 
```

> 返回当前环境中可以查询的对象列表。这意味着可以出现在 FROM 子句中的任何对象，同义词对象除外。

[关联](http://msdn.microsoft.com/en-us/library/ms186250(SQL.90).aspx)

```
sp_stored_procedures 
```

> 返回当前环境中的存储过程列表。

[关联](http://msdn.microsoft.com/en-us/library/ms190504(SQL.90).aspx)

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2008-09-23T14:34:16.340

[使用EncryptByKey](http://msdn.microsoft.com/en-us/library/ms174361(SQL.90).aspx)进行简单加密

* * *

## 回答 #31

> 赞同：6
> 
> 时间：2008-09-23T15:09:22.047

/* 找到空闲空间最大的固定驱动器，也可以复制文件来估计哪个磁盘最快 */

```
EXEC master..xp_fixeddrives 
```

/* 在使用或引用之前检查关于文件的假设 */

```
EXEC master..xp_fileexist 'C:\file_you_want_to_check' 
```

[更多细节在这里](http://blogs.msdn.com/sathishcg/archive/2006/11/24/undocumented-sql-server-2000-functions.aspx)

* * *

## 回答 #32

> 赞同：6
> 
> 时间：2008-11-26T15:43:39.977

本周我学到的最令人惊讶的事情涉及在 ORDER By Clause 中使用 CASE 语句。例如：

```
declare @orderby varchar(10)

set @orderby = 'NAME'

select * 
    from Users
    ORDER BY 
        CASE @orderby
            WHEN 'NAME' THEN LastName
            WHEN 'EMAIL' THEN EmailAddress
        END 
```

* * *

## 回答 #33

> 赞同：6
> 
> 时间：2009-06-23T09:53:23.417

## SQLCMD

如果您有反复运行的脚本，但必须更改一些细节，那么在[sqlcmd 模式下](http://msdn.microsoft.com/en-us/library/ms174187.aspx)运行 ssms非常棒。[sqlcmd 命令行](http://msdn.microsoft.com/en-us/library/ms162773.aspx)也非常漂亮。

我最喜欢的功能是：

*   你可以设置变量。不需要跳过 sp_exec 循环的正确变量
*   您可以一个接一个地运行多个脚本
*   这些脚本可以引用“外部”脚本中的变量

Red Gate 的 Simpletalk 不再滔滔不绝，而是对 sqlcmd - [The SQLCMD Workbench](http://www.simple-talk.com/sql/sql-tools/the-sqlcmd-workbench/)做了一个很棒的总结。Donabel Santos 也有一些很棒的[SQLCMD 示例](http://www.sqlmusings.com/tag/sqlcmd/)。

* * *

## 回答 #34

> 赞同：6
> 
> 时间：2009-12-07T16:01:31.277

这是一个简单但有用的：

当您手动编辑表格内容时，您可以通过键入**Control-0****在列中插入 NULL**。

 *** * *

## 回答 #35

> 赞同：5
> 
> 时间：2008-09-23T15:36:33.057

Here is a query I wrote to list All DB User Objects by Last Modified Date:

```
select name, modify_date, 
case when type_desc = 'USER_TABLE' then 'Table'
when type_desc = 'SQL_STORED_PROCEDURE' then 'Stored Procedure'
when type_desc in ('SQL_INLINE_TABLE_VALUED_FUNCTION', 'SQL_SCALAR_FUNCTION', 'SQL_TABLE_VALUED_FUNCTION') then 'Function'
end as type_desc
from sys.objects
where type in ('U', 'P', 'FN', 'IF', 'TF')
and is_ms_shipped = 0
order by 2 desc 
```

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2009-12-18T20:12:05.133

**批处理分隔符**

大多数人不知道，但“GO”不是 SQL 命令。它是客户端工具使用的默认批处理分隔符。[您可以在Books Online](http://msdn.microsoft.com/en-us/library/ms188037.aspx)中找到有关它的更多信息。

您可以通过在 Management Studio 中选择工具 -> 选项并更改查询执行部分中的批处理分隔符选项来更改批处理分隔符。

我不知道除了恶作剧之外你为什么要这样做，但这是一个有点有趣的琐事。

* * *

## 回答 #37

> 赞同：4
> 
> 时间：2008-10-24T16:21:10.713

```
sp_executesql 
```

用于执行字符串中的语句。*与Execute*一样好，但可以返回参数

* * *

## 回答 #38

> 赞同：4
> 
> 时间：2008-09-23T15:06:08.963

sp_who2，就像 sp_who，但有更多信息用于故障排除块

* * *

## 回答 #39

> 赞同：4
> 
> 时间：2008-09-23T16:43:33.207

我发现这个小脚本非常方便查看已部署到服务器的过程文本：

```
DECLARE @procedureName NVARCHAR( MAX ), @procedureText NVARCHAR( MAX )

SET @procedureName = 'myproc_Proc1'

SET @procedureText =    (
                            SELECT  OBJECT_DEFINITION( object_id )
                            FROM    sys.procedures 
                            WHERE   Name = @procedureName
                        )

PRINT @procedureText 
```

* * *

## 回答 #40

> 赞同：4
> 
> 时间：2011-07-14T21:21:39.107

使用或计算附近的`GETDATE()`日期`+``-`

```
SELECT GETDATE() - 1 -- yesterday, 1 day ago, 24 hours ago
SELECT GETDATE() - .5 -- 12 hours ago
SELECT GETDATE() - .25 -- 6 hours ago
SELECT GETDATE() - (1 / 24.0) -- 1 hour ago (implicit decimal result after division) 
```

* * *

## 回答 #41

> 赞同：4
> 
> 时间：2008-10-01T21:26:32.390

**按关键字查找程序**

哪些程序包含某段文本（表名、列名、变量名、TODO 等）？

```
SELECT OBJECT_NAME(ID) FROM SysComments 
WHERE Text LIKE '%SearchString%' 
AND OBJECTPROPERTY(id, 'IsProcedure') = 1 
```

* * *

## 回答 #42

> 赞同：4
> 
> 时间：2008-09-24T13:11:34.893

[跟踪标志](http://msdn.microsoft.com/en-us/library/ms188396.aspx)！“1204”在 SQL Server 2000 上的死锁调试中非常有用（2005 有更好的工具）。

* * *

## 回答 #43

> 赞同：4
> 
> 时间：2009-06-30T20:28:57.747

好的，这是我剩下的几个，遗憾的是我错过了开始，但继续前进，这里有一些顶级的东西！

**查询分析器**

*   `Alt+F1``sp_help`在选定的文本上执行
*   `Alt-D`- 关注数据库下拉列表，以便您可以使用带有字母光标键的 select db。

**T-Sql**

*   `if (object_id("nameofobject") IS NOT NULL) begin <do something> end`- 最简单的存在检查
*   `sp_locks`- 比 sp_who2 更深入的锁定信息（这是第一个停靠港）
*   `dbcc inputbuffer(spid)`- 执行过程的第一行列表（有点有用但很简短）
*   `dbcc outputbuffer(spid)`- 执行进程输出的顶行列表

**通用 T-sql 提示**

*   大量使用子查询来处理集合中的数据

> 例如，要获得 50 岁以上的已婚人士列表，您可以在子查询中选择一组已婚人士，并加入一组 50 岁以上的相同人并输出合并结果 - 请原谅人为的示例

* * *

## 回答 #44

> 赞同：3
> 
> 时间：2009-12-18T19:36:19.747

在 SQL Server Management Studio (SSMS) 中，您可以在对象资源管理器中突出显示对象名称，然后按 Ctrl-C 将名称复制到剪贴板。

无需按 F2 或右键单击，重命名对象即可复制名称。

您还可以将对象从对象资源管理器拖放到查询窗口中。

* * *

## 回答 #45

> 赞同：2
> 
> 时间：2009-12-18T14:23:58.037

Sql 2000+ `DBCC DROPCLEANBUFFERS`：清除缓冲区。用于在缓冲区干净时测试查询速度。

* * *

## 回答 #46

> 赞同：2
> 
> 时间：2008-09-29T17:00:24.107

**登录事件的触发器**

*   登录触发器可以帮助补充审计和合规性。例如，登录事件可用于强制执行连接规则（例如，通过特定用户名限制连接或通过用户名将连接限制在特定时间段）或仅用于跟踪和记录一般连接活动。就像在任何触发器中一样，ROLLBACK 取消正在执行的操作。在登录事件的情况下，这意味着取消连接建立。当服务器以最小配置模式启动或通过专用管理连接 (DAC) 建立连接时，不会触发登录事件。

[关联](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

* * *

## 回答 #47

> 赞同：2
> 
> 时间：2008-10-24T16:36:34.567

由于我是程序员，而不是 DBA，所以我最喜欢的隐藏功能是[SMO 库](http://msdn.microsoft.com/en-us/library/ms162169(SQL.90).aspx)。您可以在 SQL Server 中自动化几乎任何事情，从数据库/表/列的创建和删除到脚本到备份和恢复。如果您可以在 SQL Server Management Studio 中执行此操作，则可以在 SMO 中自动执行此操作。

* * *

## 回答 #48

> 赞同：2
> 
> 时间：2009-01-07T19:08:36.860

Based on what appears to be a vehement reaction to it by hardened database developers, the CLR integration would rank right up there. =)

* * *

## 回答 #49

> 赞同：2
> 
> 时间：2008-09-26T14:31:04.300

My favorite is master..xp_cmdshell. It allows you to run commands from a command prompt on the server and see the output. It's extremely useful if you can't login to the server, but you need to get information or control it somehow.

For example, to list the folders on the C: drive of the server where SQL Server is running.

*   master..xp_cmdshell 'dir c:\'

You can start and stop services, too.

*   master..xp_cmdshell 'sc query "My Service"'

*   master..xp_cmdshell 'sc stop "My Service"'

*   master..xp_cmdshell 'sc start "My Service"'

It's very powerful, but a security risk, also. Many people disable it because it could easily be used do bad things on the server. But, if you have access to it, it can be extremely useful.

* * *

## 回答 #50

> 赞同：2
> 
> 时间：2008-10-16T02:02:57.983

这是我今天学到的一个，因为我需要搜索一笔交易。

::fn_dblog
这允许您查询数据库的事务日志。

```
USE mydatabase;
SELECT *
FROM ::fn_dblog(NULL, NULL) 
```

[http://killspid.blogspot.com/2006/07/using-fndblog.html](http://killspid.blogspot.com/2006/07/using-fndblog.html)

* * *

## 回答 #51

> 赞同：2
> 
> 时间：2010-07-20T14:46:19.097

存储**过程 sp_MSdependencies以比****sp_depends**更有用的方式告诉您对象依赖关系。对于某些生产版本，可以方便地暂时禁用子表约束，应用更改然后重新启用子表约束。这是查找依赖于父表的对象的好方法。

此代码禁用子表约束：

```
create table #deps
( oType int,
  oObjName sysname,
  oOwner nvarchar(200),
  oSequence int
)

insert into #deps  
exec sp_MSdependencies @tableName, null, 1315327

exec sp_MSforeachtable @command1 = 'ALTER TABLE ? NOCHECK CONSTRAINT ALL',
@whereand = ' and o.name in (select oObjName from #deps where oType = 8)' 
```

应用更改后，可以运行此代码以重新启用约束：

```
exec sp_MSforeachtable @command1 = 'ALTER TABLE ? WITH CHECK CHECK CONSTRAINT ALL',
@whereand = ' and o.name in (select oObjName from #deps where oType = 8)' 
```

第三个参数称为@flags，它控制将列出哪些类型的依赖项。去阅读 proc 内容，看看如何根据自己的目的更改 @flags。proc 使用位掩码来破译您想要返回的内容。

* * *

## 回答 #52

> 赞同：1
> 
> 时间：2008-09-29T17:01:31.653

**sys.database_principles 中的 DEFAULT_SCHEMA 设置**

*   SQL Server 通过名称解析提供了极大的灵活性。然而，名称解析是有代价的，并且在不完全限定对象引用的临时工作负载中可能会变得非常昂贵。SQL Server 2005 允许为每个数据库原则（也称为“用户”）设置一个新的 DEFEAULT_SCHEMA 设置，这样可以在不更改 TSQL 代码的情况下消除这种开销。

[关联](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

* * *

## 回答 #53

> 赞同：1
> 
> 时间：2008-09-23T15:49:19.220

一个半隐藏的功能，表/存储过程过滤器功能真的很有用......

在**SQL Server Management Studio** *Object Explorer*中，右键单击**Tables**或**Stored Procedures**文件夹，选择**Filter**菜单，然后选择**Filter Settings ，然后在***Name contains*行中输入部分名称。

同样，使用**删除过滤器**再次查看所有表/存储过程。

* * *

## 回答 #54

> 赞同：1
> 
> 时间：2011-05-26T00:48:49.107

当你真正想要点击：
调试/解析/使用数据库/在查询选项卡之间切换/等时，你是否曾经不小心点击了执行按钮？

这是一种将该按钮移动到安全位置的方法：

工具 -> 自定义。并将按钮拖动到您想要的位置

您还可以：
- 添加/删除其他常用/未使用的按钮（甚至适用于菜单栏中的命令，例如文件/编辑）
- 更改按钮的图标图像（请参阅更改按钮图像下的小猪..哈哈）

* * *

## 回答 #55

> 赞同：1
> 
> 时间：2009-03-31T13:41:10.770

获取垂直格式的列标题列表：

在网格结果中复制列名

工具 - 选项 - 查询结果 - SQL Server - 结果到网格勾选“复制或保存结果时包括列标题”

此时您需要建立一个新连接，然后运行您的查询

现在，当您从网格复制结果时，您将获得列标题

另外，如果您然后将结果复制到excel

仅复制 col 标题

选择性粘贴（不得与复制区域重叠）

勾选“转置”

好的

[您可能希望添加一个“，”并在此时自动填充]

您有一个垂直格式的即时列列表

* * *

## 回答 #56

> 赞同：1
> 
> 时间：2008-09-23T16:46:28.490

如果您想删除数据库中的所有过程 -

```
SELECT  IDENTITY ( int, 1, 1 ) id, 
        [name] 
INTO    #tmp 
FROM    sys.procedures 
WHERE   [type]        = 'P' 
    AND is_ms_shipped = 0 

DECLARE @i INT 

SELECT   @i = COUNT( id ) FROM #tmp 
WHILE    @i > 0 
BEGIN 
   DECLARE @name VARCHAR( 100 ) 
   SELECT @name = name FROM #tmp WHERE id = @i 
   EXEC ( 'DROP PROCEDURE ' + @name ) 
   SET @i = @i-1 
END

DROP TABLE #tmp 
```

* * *

## 回答 #57

> 赞同：1
> 
> 时间：2008-09-29T17:02:46.313

**Vardecimal 存储格式**

*   SQL Server 2005 为数字和十进制数据类型添加了一种新的存储格式，称为 vardecimal。Vardecimal 是十进制类型的可变长度表示，可以在行的每个实例中保存未使用的字节。最大的节省来自小数定义很大（如小数（38,6））但存储的值很小（如值 0.0）或存在大量重复值或数据稀疏的情况.

[关联](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

* * *

## 回答 #58

> 赞同：1
> 
> 时间：2008-09-29T17:03:32.647

**可扩展的共享数据库**

*   通过可扩展共享数据库，人们可以在商用机器上安装相同的物理驱动器，并允许 SQL Server 2005 的多个实例处理同一组数据文件。该设置不需要为每个 SQL Server 实例提供重复存储，并允许通过多个 SQL Server 实例提供额外的处理能力，这些实例拥有自己的本地资源，如 cpu、内存、tempdb 和可能的其他本地数据库。

[关联](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

* * *

## 回答 #59

> 赞同：1
> 
> 时间：2009-09-01T19:00:27.727

使用 osql 实用程序运行命令行查询/脚本/批处理

* * *

## 回答 #60

> 赞同：1
> 
> 时间：2009-05-29T14:18:09.120

执行存储过程并在（临时）表中捕获结果以进行进一步处理，例如：

```
INSERT INTO someTable EXEC sp_someproc 
```

示例：显示`sp_help`输出，但按数据库大小排序：

```
CREATE TABLE #dbs
(
    name nvarchar(50),
    db_size nvarchar(50),
    owner nvarchar(50),
    dbid int,
    created datetime,
    status nvarchar(255),
    compatiblity_level int
)
INSERT INTO #dbs EXEC sp_helpdb

SELECT * FROM #dbs 
ORDER BY CONVERT(decimal, LTRIM(LEFT(db_size, LEN(db_size)-3))) DESC

DROP TABLE #dbs 
```

* * *

## 回答 #61

> 赞同：1
> 
> 时间：2010-01-08T00:56:15.420

这些是我喜欢的一些 SQL Management Studio 隐藏功能。

我喜欢的是，如果您在突出显示信息的同时按住 ALT 键，您可以选择列信息，而不仅仅是整行。

在 SQL Management Studio 中，您有预定义的键盘快捷键：

Ctrl+1 运行 sp_who Ctrl+2 运行 sp_lock Alt+F1 运行 sp_help Ctrl+F1 运行 sp_helptext

因此，如果您在编辑器中突出显示表名并按 Alt+F1，它将显示表的结构。

* * *

## 回答 #62

> 赞同：1
> 
> 时间：2011-12-10T15:44:41.360

我想推荐一个免费的插件[SSMS 工具包](http://www.ssmstoolspack.com/)，它有很多功能，比如

## 代码片段

您不再需要自己键入 SELECT * FROM。只需键入 SSF 并按 Enter 键（可以自定义为任何其他键。我更喜欢 Tab）。很少有其他有用的片段是

SSC + 制表符 - 选择 COUNT(*) FROM

SST + 制表符 - 选择 TOP 10 * FROM

S + 制表符 - 选择

I + 制表符 - 插入

U + 制表符 - 更新

W + 制表符 - 在哪里

OB + 制表符 - ORDER BY

而这样的例子不胜枚举。您可以使用 SSMS 工具包菜单检查和自定义整个列表

## 执行日志历史

你有没有意识到你可以保存几天前写的临时查询，这样你就不需要重新发明轮子了？SSMS 工具包保存您的所有执行历史记录，您可以根据日期或查询中的任何文本进行搜索。

## 搜索数据库数据

此功能可帮助您搜索字符串在整个数据库中出现的次数，并显示表名和列名以及出现的总数。您可以通过右键单击对象资源管理器中的数据库并选择搜索数据库数据来使用此功能。

## 格式化 SQL

将所有关键字设置为大写或小写字母。右键单击查询窗口并选择设置文本格式。您可以在 SSMS 工具菜单中设置快捷键。但它缺乏对齐功能。

## CRUD SP 生成

右键单击一个表，SSMS Tools -> Create CRUD 以生成 Insert、Update、Delete 和 Select SP。可以使用 SSMS 工具菜单自定义 SP 的内容。

## 杂项

很少有其他功能是

1.  网格模式下的搜索结果。
2.  从结果集、表和数据库生成插入脚本。
3.  执行计划分析器。
4.  在多个数据库中运行一个脚本。

有关更多信息，您可以访问他们的[功能](http://www.ssmstoolspack.com/Features)页面

* * *

## 回答 #63

> 赞同：0
> 
> 时间：2008-10-24T18:08:37.127

没有无证

行号由 Itzik Ben-Gan 提供 [http://www.sqlmag.com/article/articleid/97675/sql_server_blog_97675.html](http://www.sqlmag.com/article/articleid/97675/sql_server_blog_97675.html)

SET XACT_ABORT ON 回滚所有错误的事务

所有的 sp_ 都很有帮助，只需在线浏览书籍

我在管理工作室中一直使用的键盘快捷键 F6 - 在结果和查询之间切换 Alt+X 或 F5- 如果未选择任何内容，则在查询中运行选定的文本 运行整个窗口 Alt+T 和 Alt+D - 分别在文本或网格中产生

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2008-09-23T16:05:02.427

对于 SQL Server 2005：

```
select * from sys.dm_os_performance_counters

select * from sys.dm_exec_requests 
```

* * *

## 回答 #65

> 赞同：0
> 
> 时间：2008-11-25T19:57:47.950

在 SQL Server 2005 中，您不再需要运行[sp-blocker-pss80](http://support.microsoft.com/default.aspx/kb/271509)存储过程。相反，您可以这样做：

```
exec sp_configure 'show advanced options', 1;
reconfigure;
go
exec sp_configure 'blocked process threshold', 30;
reconfigure; 
```

然后，您可以启动 SQL 跟踪并在错误和警告组中选择阻塞进程报告事件类。该事件的详细信息在[这里](http://msdn.microsoft.com/en-us/library/ms191168(SQL.90).aspx)。

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2009-01-07T20:45:59.847

这里有一些未记录的：[未记录但方便的 SQL server Procs 和 DBCC 命令](http://wiki.lessthandot.com/index.php/SQL_Server_Programming_Hacks_-_100%2B_List#Undocumented_but_handy)

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2008-09-26T17:18:55.130

@Gatekiller - 获取日期的更简单方法肯定是

```
CAST(CONVERT(varchar,getdate(),103) as datetime) 
```

如果在您的语言环境中不使用 DD/MM/YYYY，则需要使用与 103 不同的值。在 SQL 联机丛书中查找 CONVERT 函数以获取语言环境代码。

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2008-10-24T07:44:26.603

好的，这是我的 2 美分：

[http://dbalink.wordpress.com/2008/10/24/querying-the-object-catalog-and-information-schema-views/](http://dbalink.wordpress.com/2008/10/24/querying-the-object-catalog-and-information-schema-views/)

我懒得在这里重新写整个东西，所以请检查我的帖子。这对许多人来说可能微不足道，但有些人会发现它是“隐藏的宝石”。

编辑：

过了一会儿，我决定在这里添加代码，这样您就不必跳转到我的博客来查看代码。

```
SELECT  T.NAME AS [TABLE NAME], C.NAME AS [COLUMN NAME], P.NAME AS [DATA TYPE], P.MAX_LENGTH AS[SIZE],   CAST(P.PRECISION AS VARCHAR) +‘/’+ CAST(P.SCALE AS VARCHAR) AS [PRECISION/SCALE]
FROM ADVENTUREWORKS.SYS.OBJECTS AS T
JOIN ADVENTUREWORKS.SYS.COLUMNS AS C
ON T.OBJECT_ID=C.OBJECT_ID
JOIN ADVENTUREWORKS.SYS.TYPES AS P
ON C.SYSTEM_TYPE_ID=P.SYSTEM_TYPE_ID
WHERE T.TYPE_DESC=‘USER_TABLE’; 
```

或者，如果您想完全提取所有用户表，请像这样使用 CURSOR：

```
DECLARE @tablename VARCHAR(60)

DECLARE cursor_tablenames CURSOR FOR
SELECT name FROM AdventureWorks.sys.tables

OPEN cursor_tablenames
FETCH NEXT FROM cursor_tablenames INTO @tablename

WHILE @@FETCH_STATUS = 0
BEGIN

SELECT  t.name AS [TABLE Name], c.name AS [COLUMN Name], p.name AS [DATA Type], p.max_length AS[SIZE],   CAST(p.PRECISION AS VARCHAR) +‘/’+ CAST(p.scale AS VARCHAR) AS [PRECISION/Scale]
FROM AdventureWorks.sys.objects AS t
JOIN AdventureWorks.sys.columns AS c
ON t.OBJECT_ID=c.OBJECT_ID
JOIN AdventureWorks.sys.types AS p
ON c.system_type_id=p.system_type_id
WHERE t.name = @tablename
AND t.type_desc=‘USER_TABLE’
ORDER BY t.name ASC

FETCH NEXT FROM cursor_tablenames INTO @tablename
END

CLOSE cursor_tablenames
DEALLOCATE cursor_tablenames 
```

附加参考（我的博客）：[http ://dbalink.wordpress.com/2009/01/21/how-to-create-cursor-in-tsql/](http://dbalink.wordpress.com/2009/01/21/how-to-create-cursor-in-tsql/)

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2012-01-04T04:02:05.767

I use SSMS to find text in files on the OS harddrive. It makes it super easy to write regex and sift through any directory to replace or find text. I always found this easier then using windows.

* * *

## 回答 #70

> 赞同：0
> 
> 时间：2008-09-29T17:02:20.030

**强制参数化**

*   参数化允许 SQL Server 利用查询计划重用的优势，并避免在后续执行类似查询时产生编译和优化开销。然而，由于某种原因，有许多应用程序仍然受到临时查询编译开销的影响。对于具有大量查询编译以及降低 CPU 利用率和响应时间对您的工作负载至关重要的情况，强制参数化可以提供帮助。

[关联](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)

* * *

## 回答 #71

> 赞同：0
> 
> 时间：2008-10-20T18:49:30.197

我最喜欢的一些东西：

在 sp2 中添加 - 工具/选项/脚本下的脚本选项

使用模式的新安全性 - 创建两个模式：user_access、admin_access。将您的用户过程放在一个中，将您的管理员过程放在另一个中，如下所示： user_access.showList ， admin_access.deleteUser 。将架构上的 EXECUTE 授予您的应用用户/角色。不再一直授予执行。

使用内置加密函数、视图（为演示而解密）和带有触发器的基表（在插入/更新时加密）进行加密。

* * *

## 回答 #72

> 赞同：0
> 
> 时间：2009-02-12T19:42:08.420

```
use db
go      
DECLARE @procName varchar(100)      
DECLARE @cursorProcNames CURSOR      
SET @cursorProcNames = CURSOR FOR      
select name from sys.procedures where modify_date > '2009-02-05 13:12:15.273' order by modify_date desc     

OPEN @cursorProcNames      
FETCH NEXT      
FROM @cursorProcNames INTO @procName      
WHILE @@FETCH_STATUS = 0      
BEGIN      
-- see the text of the last stored procedures modified on 
-- the db , hint Ctrl + T would give you the procedures test 
set nocount off;      
exec sp_HelpText @procName --- or print them      
-- print @procName      

FETCH NEXT      
FROM @cursorProcNames INTO @procName      
END      
CLOSE @cursorProcNames      

select @@error 
```

* * *

## 回答 #73

> 赞同：0
> 
> 时间：2010-10-07T11:01:43.600

BCP_IN 和 BCP_OUT 非常适合 BULK 数据导入和导出

* * *

## 回答 #74

> 赞同：0
> 
> 时间：2008-11-04T18:36:12.233

我觉得`sp_depends`很有用。它显示依赖于给定对象的对象，例如

```
exec sp_depends 'fn_myFunction' 
```

返回依赖于这个函数的对象（注意，如果对象最初没有以正确的顺序运行到数据库中，这将给出不正确的结果。）

* * *

## 回答 #75

> 赞同：0
> 
> 时间：2009-05-21T18:17:19.240

在单个语句中基于管道分隔的 ID 字符串返回结果（替代传递 xml 或首先将分隔字符串转换为表）

例子：

```
DECLARE @nvcIDs nvarchar(max)
SET @nvcIDs = '|1|2|3|'

SELECT C.*
FROM tblCompany C
WHERE @nvcIDs LIKE '%|' + CAST(C.CompanyID as nvarchar) + '|%' 
```

* * *

## 回答 #76

> 赞同：0
> 
> 时间：2011-11-09T19:54:42.803

您可以使用子查询创建逗号分隔列表，并且没有最后一个尾随逗号。据说这比在此之前使用的功能更有效。我认为是 2005 年及以后。

```
SELECT 
    Project.ProjectName,
    (SELECT
        SUBSTRING(
            (SELECT ', ' + Site.SiteName
            FROM Site
            WHERE Site.ProjectKey = Project.ProjectKey
            ORDER BY Project.ProjectName
    FOR XML PATH('')),2,200000)) AS CSV 
FROM Project 
```

您还可以使用 FOR XML PATH 和嵌套查询来选择我发现有用的 XML。

* * *

## 回答 #77

> 赞同：0
> 
> 时间：2009-02-12T20:18:12.420

```
use db
go 

select o.name 
, (SELECT [definition] AS [text()] 
     FROM sys.all_sql_modules 
     WHERE sys.all_sql_modules.object_id=a.object_id 
     FOR XML PATH(''), TYPE
  )  AS Statement_Text
 , a.object_id
 , o.modify_date 

 FROM sys.all_sql_modules a 
 LEFT JOIN  sys.objects o ON a.object_id=o.object_id 
 ORDER BY  4 desc

--select * from sys.objects 
```

* * *

## 回答 #78

> 赞同：0
> 
> 时间：2009-06-30T13:26:12.290

我用来将此存储过程添加到主数据库，

改进：

*   修剪主机名，以便复制粘贴在 VNC 上工作。
*   添加了 LOCK 选项，仅用于查看当前锁定的进程。

用法：

*   执行 sp_who3 '活动'
*   执行 sp_who3 'LOCK'
*   执行 sp_who3 spid_No

而已。

```
CREATE procedure sp_who3
       @loginame sysname = NULL --or 'active' or 'lock'
as

declare  @spidlow   int,
         @spidhigh  int,
         @spid      int,
         @sid       varbinary(85)

select   @spidlow   =     0
        ,@spidhigh  = 32767

if @loginame is not NULL begin
    if upper(@loginame) = 'ACTIVE' begin
        select spid, ecid, status
            , loginame=rtrim(loginame)
            , hostname=rtrim(hostname)
            , blk=convert(char(5),blocked)
            , dbname = case
                            when dbid = 0 then null
                            when dbid <> 0 then db_name(dbid)
                        end
              ,cmd
        from  master.dbo.sysprocesses
        where spid >= @spidlow and spid <= @spidhigh AND
              upper(cmd) <> 'AWAITING COMMAND'
        return (0)
    end
    if upper(@loginame) = 'LOCK' begin
        select spid , ecid, status
            , loginame=rtrim(loginame)
            , hostname=rtrim(hostname)
            , blk=convert(char(5),blocked)
            , dbname = case
                            when dbid = 0 then null
                            when dbid <> 0 then db_name(dbid)
                        end
              ,cmd
        from  master.dbo.sysprocesses
        where spid >= 0 and spid <= 32767 AND
              upper(cmd) <> 'AWAITING COMMAND'
        AND convert(char(5),blocked) > 0
        return (0)
    end

end

if (@loginame is not NULL
   AND  upper(@loginame) <> 'ACTIVE'
   )
begin
    if (@loginame like '[0-9]%')    -- is a spid.
    begin
        select @spid = convert(int, @loginame)
        select spid, ecid, status
            , loginame=rtrim(loginame)
            , hostname=rtrim(hostname)
            , blk=convert(char(5),blocked)
            , dbname = case
                            when dbid = 0 then null
                            when dbid <> 0 then db_name(dbid)
                        end
              ,cmd
        from  master.dbo.sysprocesses
        where spid = @spid
    end
    else
    begin
        select @sid = suser_sid(@loginame)
        if (@sid is null)
        begin
            raiserror(15007,-1,-1,@loginame)
            return (1)
        end
        select spid, ecid, status
            , loginame=rtrim(loginame)
            , hostname=rtrim(hostname)
            , blk=convert(char(5),blocked)
            , dbname = case
                            when dbid = 0 then null
                            when dbid <> 0 then db_name(dbid)
                        end
               ,cmd
        from  master.dbo.sysprocesses
        where sid = @sid
    end
    return (0)
end

/* loginame arg is null */
select spid,
       ecid,
       status
       , loginame=rtrim(loginame)
       , hostname=rtrim(hostname)
       , blk=convert(char(5),blocked)
       , dbname = case
                    when dbid = 0 then null
                    when dbid <> 0 then db_name(dbid)
                end
       ,cmd
from  master.dbo.sysprocesses
where spid >= @spidlow and spid <= @spidhigh

return (0) -- sp_who 
```

* * *

## 回答 #79

> 赞同：0
> 
> 时间：2009-07-16T21:09:07.057

CTRL-E 在查询分析器中执行当前选定的文本。

* * *

## 回答 #80

> 赞同：0
> 
> 时间：2010-07-02T09:36:21.720

利用

> 从 information_schema 中选择 *

列出 sql server 中的所有数据库、基表、sps、视图等。

* * *

## 回答 #81

> 赞同：0
> 
> 时间：2011-03-24T08:32:43.590

SQL Server Management Studio 键盘快捷键...这将在日常工作中实现越来越快的结果。[http://sqlserver-qa.net/blogs/tools/archive/2007/04/25/management-studio-shortcut-keys.aspx](http://sqlserver-qa.net/blogs/tools/archive/2007/04/25/management-studio-shortcut-keys.aspx)

* * *

## 回答 #82

> 赞同：0
> 
> 时间：2011-10-25T13:44:40.477

[master..spt_values](https://stackoverflow.com/questions/4273723/what-is-the-purpose-of-system-table-table-master-spt-values-and-what-are-the-me)（特别是 type='p'）对于[字符串拆分](https://stackoverflow.com/questions/4273978/why-and-how-to-split-column-using-master-spt-values)、“binning”和[时间插值](https://stackoverflow.com/questions/7713532/sql-selecting-rows-at-varying-intervals/7714335#7714335)操作非常有用。

* * *

## 回答 #83

> 赞同：0
> 
> 时间：2010-07-19T06:50:41.183

替代 Kolten 的 sp_change_users_login：

```
ALTER USER wacom_app WITH LOGIN = wacom_app 
```

* * *

## 回答 #84

> 赞同：0
> 
> 时间：2011-11-21T18:08:28.737

**sp_lock**：显示所有当前的锁。返回的数据可以进一步查询为：

**spid** - 使用它`sp_who`来查看谁拥有锁。

**objid** - 使用它`select object_name(objid)`来查看哪个数据库对象被锁定。

# eclipse - 在 Eclipse RCP 无头构建中使用 customBuildCallbacks.xml

> ID：121244
> 
> 赞同：2
> 
> 时间：2008-09-23T14:13:47.060
> 
> 标签：eclipse, build-process, rcp, headless

我正在尝试将一些自定义构建步骤添加到 Eclipse RCP 应用程序的无头构建过程中。

我了解推荐的方法是在插件目录上提供一个 customBuildCallbacks.xml 文件，并在 build.properties 文件中添加指向它的链接。

```
 # This property sets the location of the customb Build callback
 customBuildCallbacks = customBuildCallbacks.xml 
```

但是，在构建过程中，会忽略此步骤。

是否有一些我可能缺少的设置步骤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-24T15:23:42.720

实际上，我发现这是唯一需要的......如果我们使用的是 eclipse 3.3。这不适用于 Eclipse 3.1

# java - 最佳 StAX 实施

> ID：121251
> 
> 赞同：18
> 
> 时间：2008-09-23T14:15:25.140
> 
> 标签：java, xml, parsing, stax

我的快速搜索显示了参考实现 ( [http://stax.codehaus.org](http://stax.codehaus.org) )、Woodstox 实现 ( [http://woodstox.codehaus.org](http://woodstox.codehaus.org) ) 和 Sun 的 SJSXP 实现 ( [https://sjsxp.dev.java.net /](https://sjsxp.dev.java.net/)）。

请评论这些的相对优点，并填写我应该考虑的任何其他实现。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-23T17:00:13.183

伍德斯托克斯每次都为我赢。这也不仅仅是性能 - sjsxp 很古怪而且过于迂腐，woodstox 只是继续使用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T14:24:10.780

有趣的是：

> 对于本研究中描述的所有文档，SJSXP 的性能始终高于 BEA、Oracle 和 RI。但是，它在某些文档大小上落后于 Woodstox 和 XPP3，并且在最好的情况下，与这两个解析器相比表现出相似的性能。

Sun 的文章：[XML 解析器的流式 API](http://java.sun.com/performance/reference/whitepapers/StAX-1_0.pdf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T14:47:11.537

[http://javolution.org/](http://javolution.org/)有一个很好的 StAX 实现

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T03:58:57.320

对 Javolution 的评论：不，这不是 Stax 实现。它确实实现了一个类似于 Stax 的 API，但由于 Javolution 避免使用字符串等，它不能与源代码兼容。

无论哪种方式，它们的实现都不是特别好 - 它不是更快，而且功能不太全面，不检测 xml 问题（如重复属性），不会处理实体等。所以我看不出有太多使用它的理由，除非你对所有东西都使用 Javolution 类。

# visual-studio-2008 - “待签到”窗口卡住；永远不会完成更新

> ID：121253
> 
> 赞同：4
> 
> 时间：2008-09-23T14:15:42.783
> 
> 标签：visual-studio-2008, visual-sourcesafe

我在 Visual Studio 2008 中遇到了一个奇怪的问题，我的“Pending Checkins”窗口永远不会更新。我打开它，它像往常一样显示“正在更新...”，但我从未看到“剩余 X”消息，也没有任何反应。它只是坐在那里无所事事。

已签出的内容在解决方案资源管理器中仍显示为已签出。SourceSafe 2005 仍然可以正常工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-10T16:32:40.897

万岁！我找到了解决方案。对于任何其他偶然发现这一点的人，这就是交易。

我今天发现，并非*所有*解决方案的 Pending Checkins 窗口都被破坏了，而只是针对特定的一个解决方案。此外，虽然我没有意识到它是相关的，但每次我打开解决方案时，我都会得到：

**“无法读取与解决方案相关的某些属性。”**

我找到的解决方案在[这里](http://bloggingabout.net/blogs/rick/archive/2007/12/06/quot-some-of-the-properties-associated-with-the-solution-could-not-be-read-quot.aspx)。原来我有两个

```
GlobalSection(SourceCodeControl) = preSolution 
```

解决方案 (.sln) 文件中的部分。我删除了第二个（其中有很长的项目列表，但也有一些乱码），消息消失了，我的 Pending Checkins 窗口现在可以正常工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T16:09:18.530

您是否尝试过 Visual SourceSafe 2005 更新补丁？

# java - 测试 JAX-RS Web 服务？

> ID：121266
> 
> 赞同：84
> 
> 时间：2008-09-23T14:18:00.797
> 
> 标签：java, web-services, unit-testing, junit, jax-rs

我目前正在寻找为基于[JAX-RS](https://jsr311.dev.java.net/)（RESTful Web 服务的 Java API）的 Web 服务创建自动化测试的方法。

我基本上需要一种方法来向它发送某些输入并验证我是否得到了预期的响应。我更喜欢通过 JUnit 来实现，但我不确定如何实现。

您使用什么方法来测试您的 Web 服务？

**更新：**正如 entzik 指出的，将 Web 服务与业务逻辑分离允许我对业务逻辑进行单元测试。但是，我还想测试正确的 HTTP 状态代码等。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-29T09:56:50.940

[Jersey](http://jersey.java.net/)带有一个很棒的 RESTful 客户端 API，它使编写单元测试变得非常容易。请参阅 Jersey 附带的示例中的单元测试。[我们使用这种方法来测试Apache Camel](http://activemq.apache.org/camel/)中的 REST 支持，如果您有兴趣，[测试用例在这里](http://svn.apache.org/viewvc/activemq/camel/trunk/components/camel-rest/src/test/java/org/apache/camel/rest/resources/)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-12-27T08:14:17.987

您可以试用[REST Assured](http://code.google.com/p/rest-assured/)，这使得在 Java 中测试 REST 服务和验证响应变得*非常简单（使用 JUnit 或 TestNG）。*

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-02-25T18:10:57.560

正如詹姆斯所说；Jersey有内置的[测试框架](https://jersey.java.net/documentation/latest/test-framework.html)。一个简单的 hello world 示例可以是这样的：

pom.xml 用于 Maven 集成。当你运行`mvn test`. 框架启动一个灰熊容器。您可以通过更改依赖项来使用 jetty 或 tomcat。

```
...
<dependencies>
  <dependency>
    <groupId>org.glassfish.jersey.containers</groupId>
    <artifactId>jersey-container-servlet</artifactId>
    <version>2.16</version>
  </dependency>

  <dependency>
    <groupId>org.glassfish.jersey.test-framework</groupId>
    <artifactId>jersey-test-framework-core</artifactId>
    <version>2.16</version>
    <scope>test</scope>
  </dependency>

  <dependency>
    <groupId>org.glassfish.jersey.test-framework.providers</groupId>
    <artifactId>jersey-test-framework-provider-grizzly2</artifactId>
    <version>2.16</version>
    <scope>test</scope>
  </dependency>
</dependencies>
... 
```

ExampleApp.java

```
import javax.ws.rs.ApplicationPath;
import javax.ws.rs.core.Application;

@ApplicationPath("/")
public class ExampleApp extends Application {

} 
```

HelloWorld.java

```
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.MediaType;

@Path("/")
public final class HelloWorld {

    @GET
    @Path("/hello")
    @Produces(MediaType.TEXT_PLAIN)
    public String sayHelloWorld() {

        return "Hello World!";
    }
} 
```

HelloWorldTest.java

```
import org.glassfish.jersey.server.ResourceConfig;
import org.glassfish.jersey.test.JerseyTest;
import org.junit.Test;
import javax.ws.rs.core.Application;
import static org.junit.Assert.assertEquals;

public class HelloWorldTest extends JerseyTest {

    @Test
    public void testSayHello() {

        final String hello = target("hello").request().get(String.class);

        assertEquals("Hello World!", hello);
    }

    @Override
    protected Application configure() {

        return new ResourceConfig(HelloWorld.class);
    }
} 
```

您可以查看[此](https://github.com/firatkucuk/example-jaxrs-webapp)示例应用程序。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-23T14:46:50.070

您可能编写了一些实现业务逻辑的 java 代码，然后为它生成了 Web 服务端点。

要做的一件重要事情是独立测试您的业务逻辑。由于它是纯 Java 代码，因此您可以通过常规 J​​Unit 测试来做到这一点。

现在，由于 Web 服务部分只是一个端点，您要确保生成的管道（存根等）与您的 java 代码同步。您可以通过编写调用生成的 Web 服务 Java 客户端的 JUnit 测试来做到这一点。这将在您更改 Java 签名而不更新 Web 服务内容时通知您。

如果您的 Web 服务管道是由您的构建系统在每次构建时自动生成的，那么可能没有必要测试端点（假设它们都已正确生成）。取决于你的偏执程度。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-06-10T06:32:50.840

尽管从发布问题之日起为时已晚，但认为这可能对其他有类似问题的人有用。Jersey 附带一个称为[Jersey 测试框架](http://blogs.oracle.com/naresh/entry/jersey_test_framework_makes_it)的测试框架，它允许您测试 RESTful Web 服务，包括响应状态代码。您可以使用它在 Grizzly、HTTPServer 和/或 EmbeddedGlassFish 等轻量级容器上运行测试。此外，该框架还可用于在 GlassFish 或 Tomcat 等常规 Web 容器上运行测试。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-23T15:37:34.660

我使用 Apache 的[HTTPClient (http://hc.apache.org/)](http://hc.apache.org/)来调用 Restful Services。HTTP 客户端库允许您轻松执行 get、post 或您需要的任何其他操作。如果您的服务使用 JAXB 进行 xml 绑定，您可以创建一个 JAXBContext 来序列化和反序列化来自 HTTP 请求的输入和输出。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-05-27T11:46:18.023

看看[Alchemy 休息客户端生成器](https://github.com/strandls/alchemy-rest-client-generator)。这可以在后台使用 jersey 客户端为您的 JAX-RS Web 服务类生成代理实现。实际上，您会将 Web 服务方法称为单元测试中的简单 Java 方法。也处理 http 身份验证。

如果您只需要简单地运行测试，则不涉及代码生成，因此很方便。

免责声明：我是这个库的作者。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-01-28T08:33:58.827

把事情简单化。查看可以从 Maven Central 导入的[https://github.com/valid4j/http-matchers 。](https://github.com/valid4j/http-matchers)

```
 <dependency>
        <groupId>org.valid4j</groupId>
        <artifactId>http-matchers</artifactId>
        <version>1.0</version>
    </dependency> 
```

使用示例：

```
// Statically import the library entry point:
import static org.valid4j.matchers.http.HttpResponseMatchers.*;

// Invoke your web service using plain JAX-RS. E.g:
Client client = ClientBuilder.newClient();
Response response = client.target("http://example.org/hello").request("text/plain").get();

// Verify the response
assertThat(response, hasStatus(Status.OK));
assertThat(response, hasHeader("Content-Encoding", equalTo("gzip")));
assertThat(response, hasEntity(equalTo("content")));
// etc... 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-04T20:39:58.443

> > 一个重要的事情是独立测试你的业务逻辑

我当然不会假设编写 JAX-RS 代码并希望对接口进行单元测试的人不知何故，出于某种奇怪的、莫名其妙的原因，忘记了他或她可以对程序的其他部分进行单元测试的概念，包括业务逻辑类。陈述显而易见的事实几乎没有帮助，并且反复强调了响应也需要进行测试。

Jersey 和 RESTEasy 都有客户端应用程序，在 RESTEasy 的情况下，您可以使用相同的注解（甚至可以排除带注释的接口并在测试的客户端和服务器端使用）。

REST 不是该服务可以为您做什么；REST 您可以为此服务做什么。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-07-31T10:47:37.583

据我了解，此问题作者的主要目的是将 JAX RS 层与业务层分离。并且只对第一个进行单元测试。这里我们必须解决两个基本问题：

1.  运行测试一些 Web/应用程序服务器，将 JAX RS 组件放入其中。而且只有他们。
2.  在 JAX RS 组件/REST 层中模拟业务服务。

第一个是用 Arquillian 解决的。第二个用[arquillican 和 mock完美描述](https://rpestano.wordpress.com/2014/10/25/arquillian-and-mocks/)

这是代码示例，如果您使用其他应用程序服务器可能会有所不同，但我希望您能了解基本的想法和优势。

```
import javax.inject.Inject;
import javax.ws.rs.GET;
import javax.ws.rs.Path;

import com.brandmaker.skinning.service.SomeBean;

/**
* Created by alexandr on 31.07.15.
*/
@Path("/entities")
public class RestBean
{
   @Inject
   SomeBean bean;

   @GET
   public String getEntiry()
   {
       return bean.methodToBeMoked();
   }
}

import java.util.Set;

import javax.ws.rs.ApplicationPath;
import javax.ws.rs.core.Application;

import com.google.common.collect.Sets;

/**
*/
@ApplicationPath("res")
public class JAXRSConfiguration extends Application
{
   @Override
   public Set<Class<?>> getClasses()
   {
       return Sets.newHashSet(RestBean.class);
   }
}

public class SomeBean
{
   public String methodToBeMoked()
   {
       return "Original";
   }
}

import javax.enterprise.inject.Specializes;

import com.brandmaker.skinning.service.SomeBean;

/**
*/
@Specializes
public class SomeBeanMock extends SomeBean
{
   @Override
   public String methodToBeMoked()
   {
       return "Mocked";
   }
}

@RunWith(Arquillian.class)
public class RestBeanTest
{
   @Deployment
   public static WebArchive createDeployment() {
       WebArchive war = ShrinkWrap.create(WebArchive.class, "test.war")
               .addClasses(JAXRSConfiguration.class, RestBean.class, SomeBean.class, SomeBeanMock.class)
               .addAsWebInfResource(EmptyAsset.INSTANCE, "beans.xml");
       System.out.println(war.toString(true));
       return war;
   }

   @Test
   public void should_create_greeting() {
       Client client = ClientBuilder.newClient();
       WebTarget target = client.target("http://127.0.0.1:8181/test/res/entities");
       //Building the request i.e a GET request to the RESTful Webservice defined
       //by the URI in the WebTarget instance.
       Invocation invocation = target.request().buildGet();
       //Invoking the request to the RESTful API and capturing the Response.
       Response response = invocation.invoke();
       //As we know that this RESTful Webserivce returns the XML data which can be unmarshalled
       //into the instance of Books by using JAXB.
       Assert.assertEquals("Mocked", response.readEntity(String.class));
   }
} 
```

几点注意事项：

1.  此处使用不带 web.xml 的 JAX RS 配置。
2.  这里使用 JAX RS 客户端（没有 RESTEasy/Jersey，它们暴露了更方便的 API）
3.  测试开始时，Arquillian 的跑步者开始工作。[在这里](http://arquillian.org/guides/getting_started/)，您可以找到如何使用所需的应用程序服务器为 Arquillian 配置测试。
4.  根据选择的应用程序服务器，测试中的 url 会略有不同。可以使用另一个端口。Glassfish Embedded 在我的示例中使用了 8181。

希望，它会有所帮助。

# c# - 是否可以将复杂类型属性绑定到数据网格？

> ID：121274
> 
> 赞同：21
> 
> 时间：2008-09-23T14:18:48.967
> 
> 标签：c#, .net, data-binding

我将如何将以下对象 Car 绑定到网格视图？

```
公共级汽车
{
   长 ID {get; 放;}
   制造商 制造商 {get; 放;}
}

公共类 制造商
{
   长 ID {get; 放;}
   字符串名称 {get; 放;}
}

```

原始类型很容易绑定，但我发现无法为 Maker 显示任何内容。我希望它显示制造商名称。甚至可能吗？

有什么方法可以做到这一点？我是否也必须将 ManufacturerId 存储在 Car 中，然后设置一个带有制造商列表的 lookupEditRepository？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-12T22:44:01.810

好的，伙计们......这个问题已经发布了，但我刚刚找到了一种相当不错且简单的方法，方法是在 cell_formatting 事件中使用反射来检索嵌套属性。

像这样：

```
 private void Grid_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
    {

        DataGridView grid = (DataGridView)sender;
        DataGridViewRow row = grid.Rows[e.RowIndex];
        DataGridViewColumn col = grid.Columns[e.ColumnIndex];
        if (row.DataBoundItem != null && col.DataPropertyName.Contains("."))
        {
            string[] props = col.DataPropertyName.Split('.');
            PropertyInfo propInfo = row.DataBoundItem.GetType().GetProperty(props[0]);
            object val = propInfo.GetValue(row.DataBoundItem, null);
            for (int i = 1; i < props.Length; i++)
            {
                propInfo = val.GetType().GetProperty(props[i]);
                val = propInfo.GetValue(val, null);
            }
            e.Value = val;
        }
    } 
```

就是这样！您现在可以在列的 DataPropertyName 中使用熟悉的语法“ParentProp.ChildProp.GrandChildProp”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-23T14:30:22.387

是的，您可以创建一个 TypeDescriptionProvider 来完成嵌套绑定。这是来自 MSDN 博客的详细示例：

[http://blogs.msdn.com/msdnts/archive/2007/01/19/how-to-bind-a-datagridview-column-to-a-second-level-property-of-a-data-source。 aspx](http://blogs.msdn.com/msdnts/archive/2007/01/19/how-to-bind-a-datagridview-column-to-a-second-level-property-of-a-data-source.aspx)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-24T18:26:53.823

我在最近的一个应用程序中处理此问题的方法是创建我自己的 DataGridViewColumn 和 DataGridViewCell 类，这些类继承了现有的类之一，例如 DataGridViewTextBoxColumn 和 DataGridViewTextBoxCell。

根据您想要的单元格类型，您可以使用其他类型，例如 Button、Checkbox、ComboBox 等。只需查看 System.Windows.Forms 中可用的类型。

单元格将它们的值作为对象处理，因此您可以将 Car 类传递给单元格的值。

覆盖 SetValue 和 GetValue 将允许您拥有处理值所需的任何其他逻辑。

例如：

```
public class CarCell : System.Windows.Forms.DataGridViewTextBoxCell
{
    protected override object GetValue(int rowIndex)
    {
        Car car = base.GetValue(rowIndex) as Car;
        if (car != null)
        {
            return car.Maker.Name;
        }
        else
        {
            return "";
        }
    }
} 
```

在列类上，您需要做的主要事情是将 CellTemplate 设置为您的自定义单元格类。

```
public class CarColumn : System.Windows.Forms.DataGridViewTextBoxColumn
{
    public CarColumn(): base()
    {
        CarCell c = new CarCell();
        base.CellTemplate = c;
    }
} 
```

通过在 DataGridView 上使用这些自定义列/单元格，它允许您向 DataGridView 添加许多额外的功能。

我使用它们通过覆盖 GetFormattedValue 将自定义格式应用于字符串值来更改显示的格式。

我还对 Paint 进行了覆盖，以便我可以根据值条件进行自定义单元格突出显示，根据值将单元格 Style.BackColor 更改为我想要的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-23T14:27:20.507

```
 public class Manufacturer
    {
       long Id {get; set;}
       String Name {get; set;}

       public override string ToString()
       {
          return Name;
       }
    } 
```

覆盖 to 字符串方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-01T01:36:55.370

如果您想将特定的嵌套属性公开为绑定目标，那么 Ben Hoffstein 的回答（[http://blogs.msdn.com/msdnts/archive/2007/01/19/how-to-bind-a-datagridview-column- to-a-a-second-level-property-of-a-data-source.aspx](http://blogs.msdn.com/msdnts/archive/2007/01/19/how-to-bind-a-datagridview-column-to-a-second-level-property-of-a-data-source.aspx)）非常好。引用的文章有点迟钝，但它有效。

如果您只想将列绑定到复杂属性（例如制造商）并覆盖呈现逻辑，那么要么执行 ManiacXZ 推荐的操作，要么仅将 BoundField 子类化并提供 FormatDataValue() 的自定义实现。这类似于覆盖 ToString(); 你得到一个对象引用，然后返回你想要在网格中显示的字符串。

像这样的东西：

```
public class ManufacturerField : BoundField
{
    protected override string FormatDataValue(object dataValue, bool encode)
    {
        var mfr = dataValue as Manufacturer;

        if (mfr != null)
        {
            return mfr.Name + " (ID " + mfr.Id + ")";
        }
        else
        {
            return base.FormatDataValue(dataValue, encode);
        }
    }
} 
```

只需将 ManufacturerField 添加到您的网格，将“Manufacturer”指定为数据字段，您就可以开始了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-23T14:31:43.070

只需使用 List 并将**DataMember**设置为字符串“Maker.Name”，如果您希望**DataKeyField**使用汽车的 ID，只需将其设置为“ID”。

```
dataGrid.DataSource = carList;
dataGrid.DataMember = "Maker.Name";
dataGrid.DataKeyField = "ID";
dataGrid.DataBind(); 
```

我知道这在中继器控制中有效，至少......

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-03-09T18:30:25.530

这是我工作的另一个选择：

```
<asp:TemplateColumn
    HeaderText="Maker">
    <ItemTemplate>
          <%#Eval("Maker.Name")%>
    </ItemTemplate>
</asp:TemplateColumn> 
```

可能是特定于 ASP.NET 4.0 的，但它就像一个魅力！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-02T16:25:08.480

I would assume you could do the following:

```
public class Car
{
    public long Id {get; set;}
    public Manufacturer Maker {private get; set;}

    public string ManufacturerName
    {
       get { return Maker != null ? Maker.Name : ""; }
    }
}

public class Manufacturer
{
   long Id {get; set;}
   String Name {get; set;}
} 
```

# http - 如何检测用于访问我的网站的浏览器？

> ID：121280
> 
> 赞同：4
> 
> 时间：2008-09-23T14:19:45.440
> 
> 标签：http, browser

如何检测用户访问我的网站时使用的浏览器（IE、Firefox、Opera）？Javascript、PHP、ASP、Python、JSP 以及您能想到的任何其他示例都会有所帮助。是否有一种与语言无关的方式来获取这些信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T14:21:12.317

如果它用于处理请求，请查看传入请求的[User-Agent](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.43)标头。

更新：如果是用于报告，请将您的 Web 服务器配置为在访问日志中记录 User-Agent，然后运行日志分析工具，例如[AWSStats](http://awstats.sourceforge.net/)。

更新 2：仅供参考，*通常*（并非总是，通常）更改基于用户代理处理请求的方式是一个坏主意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T14:30:51.997

[**来自各种浏览器的用户代理字符串的综合列表**](http://www.zytrax.com/tech/web/browser_ids.htm)

清单真的很大:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-23T14:21:45.030

您将查看他们发送的[用户代理。](http://en.wikipedia.org/wiki/User_agent)请注意，您可以发送您想要的任何代理，因此这不是 100% 万无一失的，但大多数人不会更改它，除非有特定原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T14:25:39.030

一个快速而肮脏的 java servlet 示例

```
private String getBrowserName(HttpServletRequest request) {
    // get the user Agent from request header
    String userAgent = request.getHeader(Constants.BROWSER_USER_AGENT);
    String BrowesrName = "";
    //check for Internet Explorer
    if (userAgent.indexOf("MSIE") > -1) {
        BrowesrName = Constants.BROWSER_NAME_IE;
    } else if (userAgent.indexOf(Constants.BROWSER_NAME_FIREFOX) > -1) {
        BrowesrName = Constants.BROWSER_NAME_MOZILLA_FIREFOX;
    } else if (userAgent.indexOf(Constants.BROWSER_NAME_OPERA) > -1) {
        BrowesrName = Constants.BROWSER_NAME_OPERA;
    } else if (userAgent.indexOf(Constants.BROWSER_NAME_SAFARI) > -1) {
        BrowesrName = Constants.BROWSER_NAME_SAFARI;
    } else if (userAgent.indexOf(Constants.BROWSER_NAME_NETSCAPE) > -1) {
        BrowesrName = Constants.BROWSER_NAME_NETSCAPE;
    } else {
        BrowesrName = "Undefined Browser";
    }
    //return the browser name
    return BrowesrName;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T14:28:15.887

您可以在 ASP.NET 中使用 HttpBrowserCapabilities 类。这是此[链接的示例](http://support.microsoft.com/kb/311281)

```
private void Button1_Click(object sender, System.EventArgs e)
{
        HttpBrowserCapabilities bc;
        string s;
        bc = Request.Browser;
        s= "Browser Capabilities" + "\n";
        s += "Type = " + bc.Type + "\n";
        s += "Name = " + bc.Browser + "\n";
        s += "Version = " + bc.Version + "\n";
        s += "Major Version = " + bc.MajorVersion + "\n";
        s += "Minor Version = " + bc.MinorVersion + "\n";
        s += "Platform = " + bc.Platform + "\n";
        s += "Is Beta = " + bc.Beta + "\n";
        s += "Is Crawler = " + bc.Crawler + "\n";
        s += "Is AOL = " + bc.AOL + "\n";
        s += "Is Win16 = " + bc.Win16 + "\n";
        s += "Is Win32 = " + bc.Win32 + "\n";
        s += "Supports Frames = " + bc.Frames + "\n";
        s += "Supports Tables = " + bc.Tables + "\n";
        s += "Supports Cookies = " + bc.Cookies + "\n";
        s += "Supports VB Script = " + bc.VBScript + "\n";
        s += "Supports JavaScript = " + bc.JavaScript + "\n";
        s += "Supports Java Applets = " + bc.JavaApplets + "\n";
        s += "Supports ActiveX Controls = " + bc.ActiveXControls + "\n";
        TextBox1.Text = s;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T15:15:26.460

PHP 的预定义超全局数组 $_SERVER 包含一个键“HTTP_USER_AGENT”，它包含在 HTTP 请求中发送的 User-Agent 标头的值。 **请记住，这是用户提供的数据，不可信任。**很少有用户会更改他们的用户代理字符串，但它确实会不时发生。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T18:16:27.040

在客户端，您可以使用 navigation.userAgent 对象在 Javascript 中执行此操作。这是一个粗略的例子：

```
if (navigator.userAgent.indexOf("MSIE") > -1) 
{
    alert("Internet Explorer!");
}
else if (navigator.userAgent.indexOf("Firefox") > -1)
{
    alert("Firefox!");
} 
```

可以在此处找到更详细和全面的示例：[http://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html)

请注意，如果您为了 Javascript 兼容性而进行浏览器检测，通常最好简单地使用对象检测或 try/catch 块，以免某些您没有想到的版本从脚本的裂缝中溜走。例如，而不是这样做......

```
if(navigator.userAgent.indexOf("MSIE 6") > -1)
{
    objXMLHttp = new ActiveXObject("Microsoft.XMLHTTP");
}
else
{
    objXMLHttp = new XMLHttpRequest();
} 
```

...这个更好：

```
if(window.XMLHttpRequest) // Works in Firefox, Opera, and Safari, maybe latest IE?
{
    objXMLHttp = new XMLHttpRequest();
}
else if (window.ActiveXObject) // If the above fails, try the MSIE 6 method
{
    objXMLHttp = new ActiveXObject("Microsoft.XMLHTTP");
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T14:22:23.717

这可能取决于您的设置。在linux上使用apache，它写在访问日志/var/log/apache2/access_log中

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T14:22:59.053

您可以通过以下方式做到这一点：
- 查看 Web 服务器日志，或者
- 在处理 HTML 请求（这是一个纯文本流）中查看 User-Agent 字段。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T14:30:06.367

首先，我想指出，最好避免针对特定的网络浏览器进行修补，除非作为最后的结果 - 尝试实现跨浏览器兼容性，而不是使用符合标准的 HTML/CSS/JS（是的， javascript 确实有一个公分母子集，适用于所有主要浏览器）。

话虽如此，HTTP 请求标头中的用户代理标记包含客户端（声明的）浏览器。尽管由于人们针对特定浏览器而不是规范工作，这已经变得非常混乱，但确定真正的浏览器可能有点棘手。

与此匹配：

包含浏览器

火狐->火狐

MSIE -> Internet Explorer

Opera -> Opera（少数几个不伪装成 Mozilla 的浏览器之一 :)）

大多数包含“bot”或“crawler”的代理通常是机器人（所以你可以从日志/等中省略它）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-26T05:41:10.327

查看[browsecap.ini](http://browsers.garykeith.com/downloads.asp)。链接的站点包含多种脚本语言的文件。browsecap 不仅识别用户代理，还包含有关浏览器的 CSS 支持、JS 支持、操作系统、移动浏览器等信息。

[浏览此页面](http://browsers.garykeith.com/tools/your-browser.asp)以查看 browsecap.ini 可以告诉您有关您当前浏览器的信息的示例。

# linux - 为什么在我将一堆二进制数据转储到我的终端后，我的击键变成了疯狂的字符？

> ID：121282
> 
> 赞同：20
> 
> 时间：2008-09-23T14:20:13.427
> 
> 标签：linux, unix, terminal, ascii

如果我这样做：

```
$ cat /bin/ls 
```

进入我的终端，我明白为什么我看到一堆二进制数据，代表 ls 可执行文件。但之后，当我得到提示时，我自己的击键看起来很疯狂。我输入“a”，我得到一条奇怪的对角线。我输入“b”，我得到一个学位符号。

为什么会这样？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-23T14:22:36.387

因为在您的二进制数据中的某处是一些控制序列，您的终端将这些控制序列解释为请求，例如，更改用于绘制的字符集。您可以像这样将一切恢复正常：

```
reset 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-16T01:03:10.653

只需复制粘贴：

```
echo -e '\017' 
```

到您的 bash 和字符将恢复正常。如果您不运行 bash，请尝试以下击键：

```
<Ctrl-V><Ctrl-O><Enter> 
```

并希望当您的终端抱怨找不到要运行的 <Ctrl-V><Ctrl-O> 或 <Ctrl-O> 命令时，它的状态将恢复正常。

<Ctrl-N> 或字符 14（发送到终端时）命令切换到特殊图形模式，其中字母和数字被替换为符号。<Ctrl-O>，或字符 15，将一切恢复正常。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T14:59:39.183

终端将尝试将抛出的二进制数据解释为控制代码，并在此过程中自行混淆，因此您需要清理您的 tty。

跑：

```
stty sane 
```

事情应该会恢复正常。即使命令在您键入时看起来是乱码，实际字符也被正确存储，并且当您按下回车时，该命令将被调用。

[您可以在此处](http://www.ncsa.uiuc.edu/UserInfo/Resources/Hardware/IBMp690/IBM/usr/share/man/info/en_US/a_doc_lib/cmds/aixcmds5/stty.htm)找到有关 stty 命令的更多信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-23T14:22:28.587

您将一些控制字符通过管道传输到 shell 中，这些字符告诉 shell 改变其行为并以不同的方式打印内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T14:25:54.880

[VT100](http://local.wasp.uwa.edu.au/~pbourke/dataformats/vt100/)几乎是用于终端窗口的标准命令集，但有很多扩展。使用的一些控制字符集、键盘映射等。

当您向这样的终端发送大量二进制字符时，很多设置都会发生变化。一些终端具有将设置“清除”回默认值的选项，但通常它们根本不是为二进制数据而设计的。

VT100 及其后续产品允许 Linux 在简单的终端程序中打印彩色文本（例如彩色 ls 列表）。

-亚当

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-23T14:33:06.453

如果你真的必须将二进制数据转储到你的终端，如果你将它通过管道传送到一个类似的寻呼机，你会有更好的运气`less`，它会以一种更易读的格式显示它。（您可能还对`strings`和感兴趣，`od`如果您正在摆弄二进制文件，两者都会很有用。）

# asp.net - 将 Web 应用程序分成多个项目

> ID：121283
> 
> 赞同：2
> 
> 时间：2008-09-23T14:20:21.647
> 
> 标签：asp.net

我有一个变得相当大的 Web 应用程序。我想把它分成更小的更合乎逻辑的项目，但更小的项目仍然需要访问主项目的 app_code 中的一些类。有什么好的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T14:22:28.490

添加一个具有公共类的类库项目，并将对该项目的引用添加到每个新项目中。

因此，您将拥有以下解决方案布局

```
/webapp1
   /default.aspx
   /....
/webapp2
   /default.aspx
   /....
/lib
   /Utils.cs 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T14:22:56.727

`app_code`从您的每个其他项目引用的类库中提取您的公共代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T15:38:03.740

如果您只是在寻找一种组织文件的方法，那么您可以为每个子项目创建一个文件夹。通过这种方式，您将能够获得内容`app_code`并保持一定程度的分离，而几乎不需要返工。

如果您正在寻找执行此操作的最佳方法，那么重构您的代码以拥有一个基于文件夹中可重用内容的通用类库`app_code`以及引用该库的多个独立项目是可行的方法。

您可能会遇到以这种方式重构代码的问题，包括无法直接引用配置文件或用户信息。您现在正在从 Web 站点转向 Web 应用程序范式。

[http://www.codersbarn.com/post/2008/06/ASPNET-Web-Site-versus-Web-Application-Project.aspx](http://www.codersbarn.com/post/2008/06/ASPNET-Web-Site-versus-Web-Application-Project.aspx "http://www.codersbarn.com/post/2008/06/ASPNET-Web-Site-versus-Web-Application-Project.aspx")

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T14:28:53.420

我喜欢创建数据访问项目的 3 层方法，一个单独的业务项目，然后使用您现有的站点代码作为表示层，所有这些都在同一个解决方案文件中。

你这样做，就像我之前说的海报，通过在现有解决方案中创建类库项目并将你的 App_Code 类移动到适当的层，然后在业务项目中引用数据访问项目，在 Web 项目中引用业务项目。

移动它需要一些时间，并且一旦移动就重新连接各个部分，因此请确保留出足够的时间进行测试和重构。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T14:26:07.377

在 CVS 和 Subversion 中，您可以设置我认为被称为“别名”（或者可能是“模块”）的内容。无论如何，您可以使用它们来检出源代码控制树的一部分。例如，您可以创建一个名为“views”的别名，用于检查所有 HTML、javascript 和 css，但不检查您的 php/java/.NET。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T14:30:29.313

这是我在项目中所做的一个示例。
基本思想是将所有公共文件与 htdocs 分开，以便客户端无法直接访问和共享它们。

目录结构：
`public_html`
所有项目的唯一 htdocs 目录。
只存储客户端可以直接访问的文件，即 js、css、图像、索引脚本

`core`
`application`和其他脚本 所需的核心类/函数。换句话说，框架。

`application`
存储用于生成`public_html/index`脚本请求的单独页面的文件+所有项目通用的类

`config`
所有项目的配置，按项目分隔

`templates`
与所有其他文件分开的模板文件

然后将该`public_html/index`脚本用于所有域/子域上的所有项目，并根据请求的 URL 加载适当的页面......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T14:32:42.243

一种简单的方法是将 app_code 文件夹中的代码分组到它自己的程序集中。您可能遇到的唯一问题是，如果您的 app_code 文件夹中的代码没有与您页面上的元素解耦（这通常总是一个坏主意，因为它表明您的类中的内聚力很差）。

将代码放在单独的程序集中后，您可以在升级应用程序时将其部署到任意数量的服务器。

# testing - 在生产系统中测试账户和产品

> ID：121306
> 
> 赞同：6
> 
> 时间：2008-09-23T14:23:03.247
> 
> 标签：testing, production

是否值得设计一个系统来期望测试帐户和产品在生产中存在并处于活动状态，或者是否应该不存在测试实体污染生产数据库，即使您的运输人员知道不运送任何发给“测试客户”的盒子?

我已经实现了在规范中具有 test="True" 属性的消息传递协议，并且想知道现代模式是否应该包含用于标记订单、帐户、交易等的元数据作为测试实体，就像任何其他实体一样被处理 - ——但还不到花钱的地步。即：它伪造了一张假想的信用卡并伪造了包裹的运输。

预计这不会替代完全分离的测试、开发和 QA 数据库，但即便如此，我们在生产系统中始终拥有众所周知的测试 SKU 和测试客户。无害？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T14:34:09.040

我通常不赞成在生产环境中测试帐户，因为它会带来潜在的安全漏洞。人们应该努力在测试中尽可能多地复制生产环境，但显然在某些情况下这是不可能的。昂贵的生产专用硬件就是一个典型的例子。我会说作为一般做法应该不鼓励，但与所有事情一样，如果你能提供一个对你有意义的理由，那么你可能会忽略一个硬性规定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T14:37:00.843

我想最佳实践警察会说“永远不要在产品中测试”的口号，甚至可能会加上“开发人员不应该使用产品”。

但是，我在基于大型机的系统上工作，其中生产和测试/质量控制/质量控制之间存在巨大差异；系统越大，这种情况的可能性就越大。此外，与应用程序相关的组越多，这种可能性就越大。

我需要两只以上的手来计算我们只能在生产环境中复制一个问题的次数。然后选项变成创建测试表/用户/数据或使用实时客户数据。

有时我们也会在生产表中创建测试记录，因为一些用户/客户喜欢他们可以搜索/检索的东西总是在那里。

所以我的建议是，如果它有助于在上线后进行故障排除，可以将测试帐户/产品投入生产。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T15:56:48.827

如果您的数据库是以自动方式从脚本创建的，那么这将成为一个非问题。

在我的环境中，我们使用巡航控制进行连续构建。用于生成数据库的 SQL 脚本与其他所有内容一起签入 CVS，并且每天都会从这些脚本中重建数据库。

我们的测试数据是第二组 sql 脚本，它们是为测试数据库运行的，而不是为生产数据库运行的。

鉴于我们的环境测试数据永远不会触及生产数据库。

这个解决方案对我们来说真的很棒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T14:38:48.267

我不会将任何测试数据放在生产系统中，也不想作为开发人员访问该系统。

我在一个拥有非常敏感的医疗和财务信息的行业工作，拥有这些信息将无法区分测试系统中的生产数据和数据。

恕我直言，最佳实践是将这两个世界完全分开，并投资建立一个程序来准备一个全面的测试环境。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T14:39:17.547

在外部 ERP 系统（仅限内部访问）中，我们有测试数据，因此当我们将更改从测试环境转移到生产环境时，我们可以测试整个过程。我认为数据是一种必要的邪恶，因为系统之间的细微配置差异可能会导致灾难性的结果，因此一旦生产中发生变化，我们会在将其“发布”给用户之前对其进行全面测试。

正如我所说，这些只是内部应用程序，因此安全风险有所降低 - 这是一个非常有效的担忧。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T15:05:21.040

永远不要在产品中进行测试，即使那是产生所有收入/收集统计数据/神奇发生的地方……？

始终有一个生产测试计划。在 prod 上会出现问题，或者，如果你不走运，**只会**在 prod 上发生。如果您没有任何东西，第一次需要在 prod 上进行测试（通常是高压力情况），您将在没有桨的情况下上岸。

在 prod 上拥有测试数据并非无害，您确实需要小心。

# c# - 读入带有命名空间的 XML 字符串以用于 XSL 转换

> ID：121309
> 
> 赞同：1
> 
> 时间：2008-09-23T14:23:38.957
> 
> 标签：c#, asp.net, xslt

在一个 ASP.NET 2.0 网站中，我有一个代表一些格式良好的 XML 的字符串。我目前正在使用它创建一个 XmlDocument 对象并运行 XSL 转换以在 Web 表单中显示。在 XML 输入开始包含名称空间之前，一切都运行良好。

如何读取此字符串并允许命名空间？

我在下面包含了当前代码。字符串源来自 WordPress RSS 提要中的 HTML 编码节点。

```
XPathNavigator myNav= myPost.CreateNavigator();
XmlNamespaceManager myManager = new XmlNamespaceManager(myNav.NameTable);
myManager.AddNamespace("content", "http://purl.org/rss/1.0/modules/content/");
string myPost = HttpUtility.HtmlDecode("<post>" +
    myNav.SelectSingleNode("//item[1]/content:encoded", myManager).InnerXml +
    "</post>");
XmlDocument myDocument = new XmlDocument();
myDocument.LoadXml(myPost.ToString()); 
```

错误在最后一行：

“System.Xml.XmlException：'w' 是一个未声明的命名空间。第 12 行，位置 201。在 System.Xml.XmlTextReaderImpl.Throw(Exception e) ...”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T14:36:18.553

您的代码看起来正确。

问题可能出在您尝试加载的 xml 文档中。它必须具有带有“w”前缀的元素，而无需在 XML 文档中声明该前缀

例如，您应该有：

```
<test xmlns:w="http://...">
  <w:elementInWNamespace />
</test> 
```

（您的文档可能缺少`xmlns:w="http://"`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T14:36:36.680

直觉 - //content:encoding 中声明的命名空间之一被删除（可能是因为您使用的是文字 .InnerXml 属性）

myNav DOM 中的“w”命名空间是什么？您需要将 xmlns:w= 添加到您的 post 节点。可能还会有其他人。

# unix - 读取特定行和位置的 Unix 脚本

> ID：121318
> 
> 赞同：1
> 
> 时间：2008-09-23T14:25:37.157
> 
> 标签：unix

我需要一个脚本来读取传入的文件并检查信息以进行验证。

要读取的文件的第一行是日期，但以数字形式。例如：20080923 但在日期是其他信息之前，我需要从位置 27 读取它。意思是第 1 行位置 27，我需要获取该数字并查看它是否大于另一个数字。

我使用 grep 命令检查其他信息，但我使用特殊字符进行搜索，在这种情况下，日期之前的信息总是不同的，所以我不能使用字符进行搜索。它必须在第 1 行第 27 位完成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T14:28:37.230

```
sed 1q $file | cut -c27-34 
```

该`sed`命令读取文件的第一行，并且该`cut`命令删除了一行的字符 27-34，这就是您所说的日期所在的位置。

*后来补充：*

对于更一般的情况 - 例如，您需要阅读第 24 行，而不是第一行，您需要一个稍微复杂的`sed`命令：

```
sed -n -e 24p -e 24q | cut -c27-34
sed -n '24p;24q' | cut -c27-34 
```

该`-n`选项表示“默认情况下不打印行”；`24p`装置打印第 24 行；`24q`处理第 24 行后退出的方法。您可以将其省略，在这种情况下`sed`将继续处理输入，有效地忽略它。

最后，特别是如果您要验证日期，您可能希望将 Perl 用于整个工作（或 Python、Ruby、Tcl 或您选择的任何脚本语言）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T14:29:33.670

您可以提取从第 1 行第 27 位开始的字符，如下所示：

```
datestring=`head -1 $file | cut -c27-` 
```

您将对 $datestring 执行下一个处理步骤。

# java - 用于生成 Java 源文件的 Java API

> ID：121324
> 
> 赞同：130
> 
> 时间：2008-09-23T14:26:26.767
> 
> 标签：java, eclipse, code-generation

我正在寻找一个框架来生成 Java 源文件。

类似于以下 API：

```
X clazz = Something.createClass("package name", "class name");
clazz.addSuperInterface("interface name");
clazz.addMethod("method name", returnType, argumentTypes, ...);

File targetDir = ...;
clazz.generate(targetDir); 
```

然后，应该在目标目录的子目录中找到一个 java 源文件。

有人知道这样的框架吗？

* * *

**编辑**：

1.  我真的需要源文件。
2.  我也想填写方法的代码。
3.  我正在寻找高级抽象，而不是直接的字节码操作/生成。
4.  我还需要对象树中的“类结构”。
5.  问题域是一般性的：生成大量非常不同的类，没有“共同结构”。

* * *

**解决方案**
我根据您的答案发布了 2 个答案......[使用 CodeModel](https://stackoverflow.com/questions/121324/a-java-api-to-generate-java-source-files#136010)和[Eclipse JDT](https://stackoverflow.com/questions/121324/a-java-api-to-generate-java-source-files#136016)。

我在我的解决方案中使用了[CodeModel](http://codemodel.java.net/)，:-)

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-09-23T16:41:45.973

Sun 提供了一个名为 CodeModel 的 API，用于使用 API 生成 Java 源文件。获取信息并不是最容易的事情，但它就在那里，而且效果非常好。

获取它的最简单方法是作为 JAXB 2 RI 的一部分 - XJC schema-to-java 生成器使用 CodeModel 生成其 java 源代码，它是 XJC jar 的一部分。您可以将其仅用于 CodeModel。

从[http://codemodel.java.net/获取](http://codemodel.java.net/)

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2008-09-25T20:53:36.867

**使用 CodeModel 找到解决方案**
谢谢，[skaffman](https://stackoverflow.com/users/21234/skaffman)。

例如，使用以下代码：

```
JCodeModel cm = new JCodeModel();
JDefinedClass dc = cm._class("foo.Bar");
JMethod m = dc.method(0, int.class, "foo");
m.body()._return(JExpr.lit(5));

File file = new File("./target/classes");
file.mkdirs();
cm.build(file); 
```

我可以得到这个输出：

```
package foo;
public class Bar {
    int foo() {
        return  5;
    }
} 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-09-25T20:54:11.170

**使用 Eclipse JDT 的 AST 找到的解决方案**
谢谢，[Giles](https://stackoverflow.com/users/11835/giles)。

例如，使用以下代码：

```
AST ast = AST.newAST(AST.JLS3);
CompilationUnit cu = ast.newCompilationUnit();

PackageDeclaration p1 = ast.newPackageDeclaration();
p1.setName(ast.newSimpleName("foo"));
cu.setPackage(p1);

ImportDeclaration id = ast.newImportDeclaration();
id.setName(ast.newName(new String[] { "java", "util", "Set" }));
cu.imports().add(id);

TypeDeclaration td = ast.newTypeDeclaration();
td.setName(ast.newSimpleName("Foo"));
TypeParameter tp = ast.newTypeParameter();
tp.setName(ast.newSimpleName("X"));
td.typeParameters().add(tp);
cu.types().add(td);

MethodDeclaration md = ast.newMethodDeclaration();
td.bodyDeclarations().add(md);

Block block = ast.newBlock();
md.setBody(block);

MethodInvocation mi = ast.newMethodInvocation();
mi.setName(ast.newSimpleName("x"));

ExpressionStatement e = ast.newExpressionStatement(mi);
block.statements().add(e);

System.out.println(cu); 
```

我可以得到这个输出：

```
package foo;
import java.util.Set;
class Foo<X> {
  void MISSING(){
    x();
  }
} 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2014-07-10T16:24:57.187

您可以使用 Roaster ( [https://github.com/forge/roaster](https://github.com/forge/roaster) ) 进行代码生成。

这是一个例子：

```
JavaClassSource source = Roaster.create(JavaClassSource.class);
source.setName("MyClass").setPublic();
source.addMethod().setName("testMethod").setPrivate().setBody("return null;")
           .setReturnType(String.class).addAnnotation(MyAnnotation.class);
System.out.println(source); 
```

将显示以下输出：

```
public class MyClass {
   private String testMethod() {
       return null;
   }
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-09-23T15:19:38.120

另一种选择是 Eclipse JDT 的 AST，如果您需要重写任意 Java 源代码，而不仅仅是生成源代码，它会非常有用。（而且我相信它可以独立于 eclipse 使用）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-23T14:37:04.040

[Eclipse JET](http://www.eclipse.org/modeling/m2t/?project=jet)项目可用于生成源代码。我不认为它的 API 与您描述的完全一样，但每次我听说有一个项目进行 Java 源代码生成时，他们都使用 JET 或本土工具。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-23T15:25:08.967

不知道库，但您可能只需要一个通用模板引擎。有很多[，我个人对](http://java-source.net/open-source/template-engines)[FreeMarker](http://www.freemarker.org/index.html)有很好的经验

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-10-09T05:30:12.500

我构建了一个看起来非常像您的理论 DSL 的东西，称为“sourcegen”，但从技术上讲，而不是我编写的 ORM 的 util 项目。DSL 看起来像：

```
@Test
public void testTwoMethods() {
    GClass gc = new GClass("foo.bar.Foo");

    GMethod hello = gc.getMethod("hello");
    hello.arguments("String foo");
    hello.setBody("return 'Hi' + foo;");

    GMethod goodbye = gc.getMethod("goodbye");
    goodbye.arguments("String foo");
    goodbye.setBody("return 'Bye' + foo;");

    Assert.assertEquals(
    Join.lines(new Object[] {
        "package foo.bar;",
        "",
        "public class Foo {",
        "",
        "    public void hello(String foo) {",
        "        return \"Hi\" + foo;",
        "    }",
        "",
        "    public void goodbye(String foo) {",
        "        return \"Bye\" + foo;",
        "    }",
        "",
        "}",
        "" }),
    gc.toCode());
} 
```

[https://github.com/stephenh/joist/blob/master/util/src/test/java/joist/sourcegen/GClassTest.java](https://github.com/stephenh/joist/blob/master/util/src/test/java/joist/sourcegen/GClassTest.java)

它还做了一些简洁的事情，例如“自动组织导入”参数/返回类型中的任何 FQCN，自动修剪在此 codegen 运行中未触及的任何旧文件，正确缩进内部类等。

这个想法是生成的代码应该看起来很漂亮，没有警告（未使用的导入等），就像你的代码的其余部分一样。这么多生成的代码读起来很难看……太可怕了。

无论如何，文档并不多，但我认为 API 非常简单/直观。如果有人感兴趣，[这里](http://repo.joist.ws/joist/joist-util/)是Maven repo 。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T14:32:21.727

如果你真的需要源，我不知道任何产生源的东西。但是，您可以使用[ASM](http://asm.objectweb.org/)或[CGLIB](http://cglib.sourceforge.net/)直接创建 .class 文件。

您可能能够从这些生成源代码，但我只使用它们来生成字节码。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-23T15:00:52.813

我自己做的是一个模拟生成器工具。这是一项非常简单的任务，即使您需要遵循 Sun 格式指南。我敢打赌，你会比在 Internet 上找到符合你目标的东西更快地完成代码。

您基本上已经自己概述了 API。现在只需用实际代码填充它！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-22T22:38:12.960

还有[StringTemplate](http://www.stringtemplate.org/)。它是由 ANTLR 的作者编写的，非常强大。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-05-18T12:15:18.693

有一个新项目[write-it-once](https://code.google.com/p/write-it-once/)。基于模板的代码生成器。[您使用Groovy](http://groovy.codehaus.org/Groovy+Templates)编写自定义模板，并根据 java 反射生成文件。这是生成任何文件的最简单方法。您可以通过生成 AspectJ 文件、基于 JPA 注释的 SQL、基于枚举的插入/更新等来制作 getters/settest/toString。

模板示例：

```
package ${cls.package.name};

public class ${cls.shortName}Builder {

    public static ${cls.name}Builder builder() {
        return new ${cls.name}Builder();
    }
<% for(field in cls.fields) {%>
    private ${field.type.name} ${field.name};
<% } %>
<% for(field in cls.fields) {%>
    public ${cls.name}Builder ${field.name}(${field.type.name} ${field.name}) {
        this.${field.name} = ${field.name};
        return this;
    }
<% } %>
    public ${cls.name} build() {
        final ${cls.name} data = new ${cls.name}();
<% for(field in cls.fields) {%>
        data.${field.setter.name}(this.${field.name});
<% } %>
        return data;
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-03-13T05:46:38.107

这真的取决于你想要做什么。代码生成本身就是一个主题。如果没有特定的用例，我建议查看速度代码生成/模板库。此外，如果您要离线进行代码生成，我建议使用 ArgoUML 之类的东西从 UML 图/对象模型转到 Java 代码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-03-28T17:37:20.203

示例：1/

```
private JFieldVar generatedField; 
```

2/

```
String className = "class name";
        /* package name */
        JPackage jp = jCodeModel._package("package name ");
         /*  class name  */
        JDefinedClass jclass = jp._class(className);
        /* add comment */
        JDocComment jDocComment = jclass.javadoc();
        jDocComment.add("By AUTOMAT D.I.T tools : " + new Date() +" => " + className);
        // génération des getter & setter & attribues

            // create attribue 
             this.generatedField = jclass.field(JMod.PRIVATE, Integer.class) 
                     , "attribue name ");
             // getter
             JMethod getter = jclass.method(JMod.PUBLIC, Integer.class) 
                     , "attribue name ");
             getter.body()._return(this.generatedField);
             // setter
             JMethod setter = jclass.method(JMod.PUBLIC, Integer.class) 
                     ,"attribue name ");
             // create setter paramétre 
             JVar setParam = setter.param(getTypeDetailsForCodeModel(Integer.class,"param name");
             // affectation  ( this.param = setParam ) 
             setter.body().assign(JExpr._this().ref(this.generatedField), setParam);

        jCodeModel.build(new File("path c://javaSrc//")); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-02-04T21:14:13.377

这是一个看起来很有趣的 JSON-to-POJO 项目：

[http://www.jsonschema2pojo.org/](http://www.jsonschema2pojo.org/)

# c++ - GDB 回溯消息“0x0000000000000000 in ?? ()”是什么意思？

> ID：121326
> 
> 赞同：17
> 
> 时间：2008-09-23T14:26:59.043
> 
> 标签：c++, gdb, pthreads, fastcgi, freebsd

当它给出具有以下输出的回溯时，这意味着什么？

```
#0  0x00000008009c991c in pthread_testcancel () from /lib/libpthread.so.2
#1  0x00000008009b8120 in sigaction () from /lib/libpthread.so.2
#2  0x00000008009c211a in pthread_mutexattr_init () from /lib/libpthread.so.2
#3  0x0000000000000000 in ?? () 
```

程序因标准信号 11、分段错误而崩溃。我的应用程序是一个在 FreeBSD 6.3 上运行的多线程 FastCGI C++ 程序，使用 pthread 作为线程库。

根据信息来源，它已使用 -g 编译，并且我的源代码的所有符号表都已加载。

很明显，我的实际代码都没有出现在跟踪中，而是错误似乎来自标准 pthread 库。特别是，什么是？？()????

**编辑**：最终在我的主代码中将崩溃追踪到标准的无效内存访问。没有解释为什么堆栈跟踪已损坏，但这是另一天的问题:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-23T14:32:34.973

gdb 无法从 pthread_mutexattr_init 中提取正确的返回地址；它的地址为 0。“??” 是在符号表中查找地址 0 的结果。它找不到符号名称，所以它打印一个默认的“??”

不幸的是，我不知道为什么它无法提取正确的返回地址。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-23T14:50:38.643

您所做的某些事情会导致线程库崩溃。由于线程库本身没有使用调试符号 (-g) 编译，因此它无法显示发生崩溃的源代码文件或行号。此外，由于它是线程，因此调用堆栈不会指向您的文件。不幸的是，这将是一个难以追踪的错误，您将需要逐步检查代码并尝试缩小崩溃发生的时间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T14:31:55.130

确保使用调试符号进行编译。（对于 gcc，我认为这是 -g 选项）。然后你应该能够从 GDB 中获得更多有趣的信息。编译生产版本时不要忘记将其关闭。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-29T19:25:50.217

我可能会遗漏一些东西，但这不是表示有人`NULL`用作函数指针吗？

```
#include <stdio.h>

typedef int (*funcptr)(void);

int
func_caller(funcptr f)
{
    return (*f)();
}

int
main()
{
    return func_caller(NULL);
} 
```

如果您在 gdb 中运行它，这将产生相同样式的回溯：

```
rivendell$ gcc -g -O0 foo.c -o foo
rivendell$ gdb --quiet foo
Reading symbols for shared libraries .. done
(gdb) r
Starting program: ...
Reading symbols for shared libraries . done

Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_PROTECTION_FAILURE at address: 0x00000000
0x00000000 in ?? ()
(gdb) bt
#0    0x00000000 in ?? ()
#1    0x00001f9d in func_caller (f=0) at foo.c:8
#2    0x00001fb1 in main () at foo.c:14 
```

这是一个非常奇怪的崩溃……`pthread_mutexattr_init`除了分配数据结构和`memset`它之外，很少做任何事情。我会寻找其他发生的事情。是否存在不匹配的线程库之类的可能性。我的 BSD 知识有点过时了，但曾经有过这方面的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T14:42:00.270

也许导致崩溃的错误已经破坏了堆栈（堆栈的覆盖部分）？在这种情况下，回溯可能毫无用处；不知道在这种情况下该怎么办......

# .net - 在运行时将 ADO.Net DataSet 指向不同的数据库？

> ID：121350
> 
> 赞同：2
> 
> 时间：2008-09-23T14:30:37.503
> 
> 标签：.net, oracle, ado.net, connection-string, dataset

我有一个大型 ADO.Net 数据集和两个具有不同约束的数据库模式 (Oracle)。数据集将适用于任一模式，但我希望能够在运行时告诉数据集使用哪个模式（通过连接字符串）。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T14:34:06.170

在 .Net 2.0 世界中，您可以在运行时更改表适配器上的连接字符串。您只需确保 Connnection 属性是公开的，可以从数据集设计器中设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T14:41:37.557

数据集不知道它们指向哪个数据库——它们只是数据的容器。如果数据集充满了数据适配器，那么正如@Austin Salonen 指出的那样，您可以在适配器端进行更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T14:48:51.253

这是有关如何在运行时更新连接字符串的代码片段。生成数据集的内容无关紧要。

```
 DataSet ds = new DataSet();

            // Do some updateing here

            // Put your connection string here dyanmiclly
            System.Data.OleDb.OleDbCommand command = new System.Data.OleDb.OleDbCommand("Your Runtime Connection String");

            // Create the data Adapter
            System.Data.OleDb.OleDbDataAdapter dataAdapter = new System.Data.OleDb.OleDbDataAdapter(command);

            // Update the dataset
            dataAdapter.Update(ds); 
```

# wcf - WCF 路由消息安全

> ID：121354
> 
> 赞同：1
> 
> 时间：2008-09-23T14:31:07.050
> 
> 标签：wcf, security, certificate, wcf-routing

我正在服务之间构建一些路由功能。原始服务和做路由的服务具有相同的配置；两者都使用具有以下绑定配置的 netTcpBinding：

> netTcpBinding
> 
> 安全模式="消息"
> 
> 消息 clientCredentialType="用户名"

服务行为使用我们在机器上安装的 AspNet Membership Provider 和客户端证书。

当我关闭消息安全时，它会很好地中继，但是当它打开时，我得到以下异常：

“无法处理消息。这很可能是因为操作 ' [http://foo/Whatever](http://foo/Whatever) ' 不正确，或者因为**消息包含无效或过期的安全上下文令牌，或者因为绑定之间不匹配***。安全如果服务由于不活动而中止通道，则上下文令牌将无效。为了防止服务过早中止空闲会话，请增加服务端点绑定的接收超时。（强调我的）

我的想法是证书在消息上运行了两次（一次在原始调用上，然后在中继上），这就是破坏消息安全令牌的原因。

**问题：**

1.  我的想法有目标吗？

2.  有没有办法在没有令牌服务复杂性的情况下继续使用消息安全进行路由？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T14:56:18.387

您提到在无安全性和消息安全性之间切换。您是否确保同时更改 WCF 服务端点以及接收端的端点？如果不是，并且两者不匹配，您将收到错误消息。这就是那个错误似乎对我说的。

对于问题 2，您在什么类型的环境中运行？一个可以使用加密和签名的封闭系统，还是一个可能需要使用特殊密钥的公共环境？

# c# - VS2008内置本地化工具

> ID：121373
> 
> 赞同：5
> 
> 时间：2008-09-23T14:33:04.410
> 
> 标签：c#, localization

我正在开发一个用 C# .NET 2.0 和 VS2008 编写的 WinForms 应用程序。我正要开始将应用程序翻译成多种语言。在我开始之前，使用 VS2008 本身进行所有本地化是一个好主意吗？还是立即使用一些外部工具更好？这是我的第一个 .NET 应用程序，所以我宁愿在开始之前先询问一下。别人在用什么？

我的应用程序中使用的所有字符串都在资源中，因此我认为该应用程序已准备好进行翻译。

谢谢你，彼得

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T14:59:26.843

谁将对其进行本地化？大多数外部本地化公司都有这方面的实用程序。如果是您自己或您的团队，最简单的方法可能是使用 Visual Studio 或类似此处提到的东西将其转换为 word doc：

[http://blog.vermorel.com/?p=73](http://blog.vermorel.com/?p=73)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-22T08:46:05.843

我完成了网站上的工作（[REFULOG](http://refulog.de)）并为每个页面生成了 .resx 文件（工具/生成本地资源；确保您处于设计或拆分模式，否则菜单项不会出现）。在此之后，我测试了名为[Resx Crunch](http://resxcrunch.com)的应用程序（即将发布。）我加载了所有生成的 .resx 文件，添加了所需的语言，让应用程序从默认的 .resx 文件中复制了值，所以最后它看起来像这样：

```
Default value | DE    | ES
-------------------------------
apple         |apple  | apple
... 
```

我将信息保存为 CSV 文件并将其发送给翻译人员。当它从译者那里回来时：

```
Default value | DE    | ES
-------------------------------
apple         |Appfel | Manzana
... 
```

我将它加载，另存为到应用程序文件夹中，就是这样。

我尝试使用其他本地化工具，但他们希望 3d 做的太多而做不到。

所以回答你的问题：使用 Visual Studio 生成元标记和 .resx 文件，并使用一些本地化工具进行翻译。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-30T01:24:03.650

为了其他可能遇到此问题的人的利益（上一篇文章后 2 年多），我是专业本地化产品的作者，它使整个翻译过程变得非常容易。这是一个 Visual Studio 插件，可以从任意解决方案中提取所有“.resx”字符串，并将它们加载到一个文件中，该文件可以使用免费的独立应用程序进行翻译（翻译人员可以从我的网站下载）。然后，相同的加载项会将翻译后的字符串导入您的解决方案。非常易于使用，具有许多内置的保护措施、大量的花里胡哨和在线帮助（您不需要太多）。见[http://www.hexadigm.com](http://www.hexadigm.com)

# asp.net - 有没有办法在 .ASPX 页面中注释掉标记？

> ID：121382
> 
> 赞同：220
> 
> 时间：2008-09-23T14:34:01.367
> 
> 标签：asp.net, markup, comments

有没有办法在页面中注释掉标记，`.ASPX`这样它就不会传递给客户端？我已经尝试过标准注释`<!-- -->`，但这只是作为注释传递，并不会阻止控件呈现。

* * *

## 回答 #1

> 赞同：344
> 
> 时间：2008-09-23T14:35:34.263

```
<%--
            Commented out HTML/CODE/Markup.  Anything with
            this block will not be parsed/handled by ASP.NET.

            <asp:Calendar runat="server"></asp:Calendar> 

            <%# Eval(“SomeProperty”) %>     
--%> 
```

[来源](http://weblogs.asp.net/scottgu/archive/2006/07/09/Tip_2F00_Trick_3A00_-Using-Server-Side-Comments-with-ASP.NET-2.0-.aspx)

* * *

## 回答 #2

> 赞同：73
> 
> 时间：2008-09-23T16:54:45.067

奖励答案：Visual Studio 中用于注释任何内容的键盘快捷键是**Ctrl-KC**。这适用于许多地方，包括 C#、VB、Javascript 和 aspx 页面；它也适用于 SQL Management Studio 中的 SQL。

您可以选择要注释掉的文本，也可以将文本放置在要注释掉的块中；例如，将光标放在 GridView 的开始标记内，按 Ctrl-KC，整个内容都会被注释掉。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-09-24T08:12:01.087

仅供参考 | `ctrl`+ `K`,`C`是 Visual Studio 中的注释快捷方式。`ctrl`+ `K`，`U`取消注释。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-09-23T14:36:17.287

```
<%-- not rendered to browser --%> 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-23T14:36:30.313

我相信您正在寻找：

```
<%-- your markup here --%> 
```

这是一个服务器端注释，不会传递给客户端……但这不是可选的。如果你需要它是可编程的，那么你会想要[这个答案](https://stackoverflow.com/a/121397/2415524):-)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-09-23T14:36:23.560

是的，有特殊的服务器端注释：

```
<%-- Text not sent to client  --%> 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-11-10T19:07:18.613

虽然这有效：

```
<%-- <%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="ht_tv1.Default" %> --%>
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="Blank._Default" %> 
```

这不会。

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" <%--Inherits="ht_tv1.Default"--%> Inherits="Blank._Default" %> 
```

因此，您不能注释掉我 99.9995% 的时间都想做的事情的一部分。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-23T14:35:00.943

假设您要注释掉的不是服务器端代码的另一种方法是...

```
<asp:panel runat="server" visible="false">
    html here
</asp:panel> 
```

# strong-typing - 强类型语言的关键方面是什么？

> ID：121385
> 
> 赞同：18
> 
> 时间：2008-09-23T14:34:08.777
> 
> 标签：strong-typing

是什么让语言成为强类型的？我正在寻找强类型语言最重要的方面。

昨天我问PowerShell是否是强类型的，但没有人同意“强类型”的定义，所以我想澄清一下这个定义。

随意链接到维基百科或其他来源，但不要只是剪切和粘贴您的答案。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-23T18:17:19.957

术语“强类型”没有公认的定义。

它在一场激烈的战争中提出了一个“伟大”的论点，因为每当有人被证明是错误的，他们可以重新定义它以表示他们想要的任何含义。除此之外，该术语没有任何实际用途。

最好不要使用该术语，或者，如果您使用它，请先严格定义它。如果您看到其他人使用它，请让他定义该术语。

每个人都有自己的定义。我见过的一些是：

*   强类型 = 静态类型
*   强类型 = 显式类型
*   强类型=名义上类型
*   强类型 = 类型
*   强类型 = 没有隐式类型转换，只有显式
*   强类型 = 根本没有类型转换
*   强类型=我理解的/弱类型=我不理解的
*   强类型 = C++ / 弱类型 = 其他
*   强类型 = Java / 弱类型 = 其他一切
*   强类型 = .NET / 弱类型 = 其他一切
*   强类型 =*我的*编程语言 / 弱类型 =*你的*编程语言

在类型论中，存在一种类型系统比另一种*更强大的概念。*特别是，如果存在一个表达式`e1`，它被类型系统接受`T1`，但被类型系统拒绝`T2`，则`T2`说它比*强*`T1`。这里有两件重要的事情需要注意：

1.  这是比较的，不是绝对的：没有*强弱*之*分*，只有*强弱*之*分*
***   该术语没有暗示任何价值；*更强*并不意味着*更好***

 *** * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-23T15:27:57.837

According to B.C. Pierce, the guy who wrote "Types and Programming Languages and Advanced Types and Programming Languages" :

> I spent a few weeks trying to sort out the terminology of "strongly typed," "statically typed," "safe," etc., and found it amazingly difficult... The usage of these terms is so various as to render them almost useless.

So no wonder why your collegues disagree.

I'd go with the simplest answer : if you can concatenate a string and an int without casting, then it's not strongly typed.

EDIT: as stated in comments, Java just does that :-(

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-23T14:45:44.833

关键是要记住静态类型和强类型之间是有区别的。强类型语言只是意味着一旦分配，给定变量将始终表现为某种类型，直到它被重新分配。根据定义，Java 和 C# 等静态类型语言是强类型的，但许多流行的动态语言（如 Ruby 和 Python）也是如此。

所以在强类型语言中

```
x = "5" 
```

x 将永远是一个字符串，永远不会是一个整数。

在某些弱类型语言中，您可以执行类似的操作

```
x = "5"
y = x + 3
// y is now 8 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-23T14:48:26.683

人们将静态类型与强类型混淆。静态类型意味着“字符串是字符串是字符串”。强类型意味着“一旦你把它变成一个字符串，它将被视为一个字符串，直到它被重新分配为不同的东西。”

编辑：毕竟我看到其他人确实指出了这一点:)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-23T14:46:08.670

我在一次采访中听到有人说（我认为是 C# 的 Anders Hejlsberg 和 turbo pascal 的名声）强类型不是开启或关闭的东西，某些语言比其他语言具有更强大的类型系统。

在强类型、弱类型、静态类型和动态类型之间也存在很多混淆，其中静态类型语言将类型分配给变量，而动态语言将类型分配给存储在变量中的对象。

尝试 wikipedia 获取更多信息，但不要指望一个决定性的答案： [http ://en.wikipedia.org/wiki/Strongly_typed_language](http://en.wikipedia.org/wiki/Strongly_typed_language)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-23T14:36:35.447

强类型意味着您声明了某种类型的变量，如果您尝试将该变量转换为另一种类型而不进行强制转换，您的编译器将抛出一个嘶嘶声。

示例（在 Java 中记住你）：

```
int i = 4;
char s = i; // Type mismatch: cannot convert from int to char 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-30T12:40:15.810

“强类型”这个词完全没有意义。它没有任何意义，而且从来没有。即使一些声称的定义是准确的，我认为区分的原因没有任何意义；为什么了解、讨论或辩论一种语言是否是强类型（无论这可能意味着什么）很重要？

这与术语“Web 2.0”或“OEM”非常相似，它们也没有实际意义。

有趣的是，这些短语是如何开始的，并在日常交流中扎根。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-01-01T15:20:19.773

**静态类型语言**是一种需要先声明变量才能使用的语言。虽然**动态类型语言**是一种可以随时使用变量的语言，即使它们没有被声明。唯一的条件是它们必须在使用之前进行初始化。

现在，让我们来看看**强类型语言**。在这样的语言中，变量具有类型，并且它们将始终是该类型。它们不能分配给其他类型的值。而**弱类型语言**是一种变量没有类型的语言。可以为它们分配任何类型的值。

**示例：** **Java**是一种**静态类型**和**强类型语言**。它是静态类型的，因为必须先声明变量才能使用它们。它是强类型的，因为特定类型的变量`int`将始终保存整数值。你不能分配`boolean`给他们。

**Powershell**是一种**动态类型**和**弱类型的语言**。它是动态类型的，因为变量在使用之前不需要声明。它是弱类型的，因为变量可能在某个时间点保持一种类型的值，而在不同的时间点保持另一种类型的值。

# sql - 获取列的最大值所在的行

> ID：121387
> 
> 赞同：626
> 
> 时间：2008-09-23T14:34:13.877
> 
> 标签：sql, oracle, greatest-n-per-group

桌子：

```
UserId, Value, Date. 
```

我想获取每个 UserId 的 Max(Date) 的 UserId 值。即，每个具有最新日期的 UserId 的值。有没有办法简单地在 SQL 中做到这一点？（最好是甲骨文）

**更新：**对任何歧义道歉：我需要获取所有用户 ID。但是对于每个 UserId，只有该用户具有最新日期的那一行。

* * *

## 回答 #1

> 赞同：480
> 
> 时间：2008-09-23T20:01:21.937

我看到很多人使用子查询或其他窗口函数来执行此操作，但我经常通过以下方式进行这种没有子查询的查询。它使用普通的标准 SQL，因此它可以在任何品牌的 RDBMS 中工作。

```
SELECT t1.*
FROM mytable t1
  LEFT OUTER JOIN mytable t2
    ON (t1.UserId = t2.UserId AND t1."Date" < t2."Date")
WHERE t2.UserId IS NULL; 
```

换句话说：`t1`从不存在具有相同`UserId`和更大日期的其他行的行中获取行。

（我将标识符“日期”放在分隔符中，因为它是 SQL 保留字。）

如果`t1."Date" = t2."Date"`，则出现加倍。通常表有`auto_inc(seq)`键，例如`id`。为了避免加倍可以使用如下：

```
SELECT t1.*
FROM mytable t1
  LEFT OUTER JOIN mytable t2
    ON t1.UserId = t2.UserId AND ((t1."Date" < t2."Date") 
         OR (t1."Date" = t2."Date" AND t1.id < t2.id))
WHERE t2.UserId IS NULL; 
```

* * *

来自@Farhan 的重新评论：

这里有一个更详细的解释：

外部联接尝试与`t1`联接`t2`。默认情况下，返回 的所有结果`t1`，*如果*在 中匹配`t2`，也返回。`t2`如果的给定行没有匹配`t1`，则查询仍返回 的行`t1`，并`NULL`用作所有`t2`列的占位符。这就是外部连接的一般工作方式。

这个查询的技巧是设计连接的匹配条件，使得`t2`必须匹配*相同* `userid`的和*更大的* `date`。这个想法是，如果其中存在`t2`一个具有更大`date`的行，那么`t1`与之比较的行*就不可能*是最大`date`的`userid`。但是如果没有匹配项——即，如果不存在`t2`大于`date`行中的行`t1`——我们知道中的行是给定`t1`的最大的行。`date``userid`

在这些情况下（当不匹配时）， 的列`t2`将是`NULL`-- 甚至是连接条件中指定的列。所以这就是我们使用 的原因`WHERE t2.UserId IS NULL`，因为我们正在搜索未找到行的情况，`date`而给定的 更大`userid`。

* * *

## 回答 #2

> 赞同：433
> 
> 时间：2008-09-23T14:41:11.677

这将检索 my_date 列值等于该用户标识的 my_date 最大值的所有行。这可能会为用户标识检索多行，其中最大日期在多行上。

```
select userid,
       my_date,
       ...
from
(
select userid,
       my_date,
       ...
       max(my_date) over (partition by userid) max_my_date
from   users
)
where my_date = max_my_date 
```

“分析函数摇滚”

编辑：关于第一条评论......

“使用分析查询和自联接违背了分析查询的目的”

此代码中没有自联接。相反，在包含分析函数的内联视图的结果上放置了一个谓词——这是一个非常不同的问题，并且是完全标准的做法。

“Oracle 中的默认窗口是从分区中的第一行到当前行”

windowing 子句仅适用于存在 order by 子句的情况。如果没有 order by 子句，默认情况下不应用任何窗口子句，也不能显式指定。

该代码有效。

* * *

## 回答 #3

> 赞同：168
> 
> 时间：2008-09-23T15:18:24.830

```
SELECT userid, MAX(value) KEEP (DENSE_RANK FIRST ORDER BY date DESC)
  FROM table
  GROUP BY userid 
```

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2008-09-23T14:39:13.007

我不知道你的确切列名，但它会是这样的：

```
    选择用户名，值
      来自用户 u1
     其中日期 =（选择最大值（日期）
                     来自用户 u2
                    其中 u1.userid = u2.userid)

```

* * *

## 回答 #5

> 赞同：43
> 
> 时间：2008-09-23T20:06:29.973

不在工作，我手头没有 Oracle，但我似乎记得 Oracle 允许在 IN 子句中匹配多个列，这至少应该避免使用相关子查询的选项，这很少是好的主意。

可能是这样的（不记得列列表是否应该加括号）：

```
SELECT * 
FROM MyTable
WHERE (User, Date) IN
  ( SELECT User, MAX(Date) FROM MyTable GROUP BY User) 
```

编辑：刚刚尝试过：

```
SQL> create table MyTable (usr char(1), dt date);
SQL> insert into mytable values ('A','01-JAN-2009');
SQL> insert into mytable values ('B','01-JAN-2009');
SQL> insert into mytable values ('A', '31-DEC-2008');
SQL> insert into mytable values ('B', '31-DEC-2008');
SQL> select usr, dt from mytable
  2  where (usr, dt) in 
  3  ( select usr, max(dt) from mytable group by usr)
  4  /

U DT
- ---------
A 01-JAN-09
B 01-JAN-09 
```

所以它起作用了，尽管其他地方提到的一些新奇的东西可能性能更高。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-09-23T15:22:48.410

我知道您要求使用 Oracle，但在 SQL 2005 中，我们现在使用它：

```
 -- Single Value
;WITH ByDate
AS (
SELECT UserId, Value, ROW_NUMBER() OVER (PARTITION BY UserId ORDER BY Date DESC) RowNum
FROM UserDates
)
SELECT UserId, Value
FROM ByDate
WHERE RowNum = 1

-- Multiple values where dates match
;WITH ByDate
AS (
SELECT UserId, Value, RANK() OVER (PARTITION BY UserId ORDER BY Date DESC) Rnk
FROM UserDates
)
SELECT UserId, Value
FROM ByDate
WHERE Rnk = 1 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-23T15:47:54.073

我没有 Oracle 来测试它，但最有效的解决方案是使用分析查询。它应该看起来像这样：

```
SELECT DISTINCT
    UserId
  , MaxValue
FROM (
    SELECT UserId
      , FIRST (Value) Over (
          PARTITION BY UserId
          ORDER BY Date DESC
        ) MaxValue
    FROM SomeTable
  ) 
```

我怀疑您可以摆脱外部查询并将 distinct 放在内部，但我不确定。与此同时，我知道这个有效。

如果您想了解分析查询，我建议您阅读[http://www.orafaq.com/node/55](http://www.orafaq.com/node/55)和~~[http://www.akadia.com/services/ora_analytic_functions.html](http://www.akadia.com/services/ora_analytic_functions.html)~~。这是简短的摘要。

在后台，分析查询对整个数据集进行排序，然后按顺序对其进行处理。在处理它时，您根据某些标准对数据集进行分区，然后为每一行查看某个窗口（默认为当前行的分区中的第一个值 - 该默认值也是最有效的）并且可以使用分析函数的数量（其列表与聚合函数非常相似）。

在这种情况下，这是内部查询的作用。整个数据集按 UserId 然后 Date DESC 排序。然后它一次性处理它。对于每一行，您返回 UserId 和为该 UserId 看到的第一个日期（因为日期按 DESC 排序，这是最大日期）。这为您提供了重复行的答案。然后外部 DISTINCT 挤压重复项。

这不是一个特别引人注目的分析查询示例。为了获得更大的胜利，请考虑使用一张财务收据表，并为每个用户和收据计算他们支付的总金额。分析查询有效地解决了这个问题。其他解决方案效率较低。这就是为什么它们是 2003 SQL 标准的一部分。（不幸的是 Postgres 还没有它们。Grrr ...）

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-10-19T16:17:08.583

QUALIFY 子句不是既简单又最好？

```
select userid, my_date, ...
from users
qualify rank() over (partition by userid order by my_date desc) = 1 
```

就上下文而言，在 Teradata 上，这个 QUALIFY 版本在 17 秒内运行，在 23 秒内运行 'inline view'/Aldridge 解决方案 #1。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2011-11-01T13:22:23.680

使用 PostgreSQL 8.4 或更高版本，您可以使用：

```
select user_id, user_value_1, user_value_2
  from (select user_id, user_value_1, user_value_2, row_number()
          over (partition by user_id order by user_date desc) 
        from users) as r
  where r.row_number=1 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-03-26T12:07:40.033

在**`Oracle 12c+`**中，您可以使用*Top n*查询和分析函数`rank`来非常简洁地实现这一点*，而无需*子查询：

```
select *
from your_table
order by rank() over (partition by user_id order by my_date desc)
fetch first 1 row with ties; 
```

以上返回每个用户最大 my_date 的所有行。

如果您只想要一行具有最大日期，则将其替换`rank`为`row_number`：

```
select *
from your_table
order by row_number() over (partition by user_id order by my_date desc)
fetch first 1 row with ties; 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2017-10-31T13:07:35.730

用于为 each[`ROW_NUMBER()`](https://docs.oracle.com/database/121/SQLRF/functions170.htm)分配一个唯一的降序排名，然后过滤到每个的第一行（即= 1）。`Date``UserId``UserId``ROW_NUMBER`

```
SELECT UserId, Value, Date
FROM (SELECT UserId, Value, Date,
        ROW_NUMBER() OVER (PARTITION BY UserId ORDER BY Date DESC) rn
      FROM users) u
WHERE rn = 1; 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2010-06-29T13:45:48.477

只需要在工作中写一个“活”的例子:)

这个支持**同一**日期的 UserId 的多个值。

列：用户 ID、值、日期

```
SELECT
   DISTINCT UserId,
   MAX(Date) OVER (PARTITION BY UserId ORDER BY Date DESC),
   MAX(Values) OVER (PARTITION BY UserId ORDER BY Date DESC)
FROM
(
   SELECT UserId, Date, SUM(Value) As Values
   FROM <<table_name>>
   GROUP BY UserId, Date
) 
```

您可以使用 FIRST_VALUE 代替 MAX 并在说明计划中查找。我没有时间玩它。

当然，如果搜索巨大的表，最好在查询中使用 FULL 提示。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-07-21T08:27:20.720

我参加聚会已经很晚了，但是以下 hack 将优于相关子查询和任何分析功能，但有一个限制：值必须转换为字符串。所以它适用于日期、数字和其他字符串。代码看起来不太好，但执行配置文件很棒。

```
select
    userid,
    to_number(substr(max(to_char(date,'yyyymmdd') || to_char(value)), 9)) as value,
    max(date) as date
from 
    users
group by
    userid 
```

这段代码之所以这么好，是因为它只需要扫描表一次。它不需要任何索引，最重要的是它不需要对表进行排序，而大多数分析功能都需要这样做。如果您需要过滤单个用户标识的结果，索引将有所帮助。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-11-11T18:53:58.947

如果你使用 Postgres，你可以使用`array_agg`like

```
SELECT userid,MAX(adate),(array_agg(value ORDER BY adate DESC))[1] as value
FROM YOURTABLE
GROUP BY userid 
```

我对甲骨文不熟悉。这就是我想出的

```
SELECT 
  userid,
  MAX(adate),
  SUBSTR(
    (LISTAGG(value, ',') WITHIN GROUP (ORDER BY adate DESC)),
    0,
    INSTR((LISTAGG(value, ',') WITHIN GROUP (ORDER BY adate DESC)), ',')-1
  ) as value 
FROM YOURTABLE
GROUP BY userid 
```

两个查询都返回与接受的答案相同的结果。请参阅 SQLFiddles：

1.  [接受的答案](http://sqlfiddle.com/#!4/2749b5/42)
2.  [我使用 Postgres 的解决方案](http://sqlfiddle.com/#!12/24a7a/18)
3.  [我使用 Oracle 的解决方案](http://sqlfiddle.com/#!4/2749b5/41)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-09-23T14:36:59.923

我想是这样的。（请原谅我的任何语法错误；我现在已经习惯使用 HQL！）

编辑：也误读了这个问题！更正了查询...

```
SELECT UserId, Value
FROM Users AS user
WHERE Date = (
    SELECT MAX(Date)
    FROM Users AS maxtest
    WHERE maxtest.UserId = user.UserId
) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-23T14:47:21.100

我觉得你应该对前面的查询做这个变体：

```
SELECT UserId, Value FROM Users U1 WHERE 
Date = ( SELECT MAX(Date)    FROM Users where UserId = U1.UserId) 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-23T14:51:02.777

```
Select  
   UserID,  
   Value,  
   Date  
From  
   Table,  
   (  
      Select  
          UserID,  
          Max(Date) as MDate  
      From  
          Table  
      Group by  
          UserID  
    ) as subQuery  
Where  
   Table.UserID = subQuery.UserID and  
   Table.Date = subQuery.mDate 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-11-23T13:47:44.890

```
select VALUE from TABLE1 where TIME = 
   (select max(TIME) from TABLE1 where DATE= 
   (select max(DATE) from TABLE1 where CRITERIA=CRITERIA)) 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-23T14:39:31.850

(T-SQL) 首先获取所有用户及其 maxdate。加入表格以查找用户在 maxdates 上的对应值。

```
create table users (userid int , value int , date datetime)
insert into users values (1, 1, '20010101')
insert into users values (1, 2, '20020101')
insert into users values (2, 1, '20010101')
insert into users values (2, 3, '20030101')

select T1.userid, T1.value, T1.date 
    from users T1,
    (select max(date) as maxdate, userid from users group by userid) T2    
    where T1.userid= T2.userid and T1.date = T2.maxdate 
```

结果：

```
userid      value       date                                    
----------- ----------- -------------------------- 
2           3           2003-01-01 00:00:00.000
1           2           2002-01-01 00:00:00.000 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-23T14:49:33.840

假设 Date 对于给定的 UserID 是唯一的，这里有一些 TSQL：

```
SELECT 
    UserTest.UserID, UserTest.Value
FROM UserTest
INNER JOIN
(
    SELECT UserID, MAX(Date) MaxDate
    FROM UserTest
    GROUP BY UserID
) Dates
ON UserTest.UserID = Dates.UserID
AND UserTest.Date = Dates.MaxDate 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2010-04-28T17:04:23.813

这里的答案只有 Oracle。这是所有 SQL 中更复杂的答案：

谁的整体功课成绩最好（功课总分最高）？

```
SELECT FIRST, LAST, SUM(POINTS) AS TOTAL
FROM STUDENTS S, RESULTS R
WHERE S.SID = R.SID AND R.CAT = 'H'
GROUP BY S.SID, FIRST, LAST
HAVING SUM(POINTS) >= ALL (SELECT SUM (POINTS)
FROM RESULTS
WHERE CAT = 'H'
GROUP BY SID) 
```

还有一个更困难的例子，需要一些解释，我没有时间atm：

给出 2008 年最流行的书（ISBN 和书名），即 2008 年最常被借阅的书。

```
SELECT X.ISBN, X.title, X.loans
FROM (SELECT Book.ISBN, Book.title, count(Loan.dateTimeOut) AS loans
FROM CatalogEntry Book
LEFT JOIN BookOnShelf Copy
ON Book.bookId = Copy.bookId
LEFT JOIN (SELECT * FROM Loan WHERE YEAR(Loan.dateTimeOut) = 2008) Loan 
ON Copy.copyId = Loan.copyId
GROUP BY Book.title) X
HAVING loans >= ALL (SELECT count(Loan.dateTimeOut) AS loans
FROM CatalogEntry Book
LEFT JOIN BookOnShelf Copy
ON Book.bookId = Copy.bookId
LEFT JOIN (SELECT * FROM Loan WHERE YEAR(Loan.dateTimeOut) = 2008) Loan 
ON Copy.copyId = Loan.copyId
GROUP BY Book.title); 
```

希望这有助于（任何人）.. :)

问候，古斯

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2010-05-02T15:12:43.197

刚刚对此进行了测试，它似乎可以在日志表上运行

```
select ColumnNames, max(DateColumn) from log  group by ColumnNames order by 1 desc 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-08-30T18:36:07.783

没有分区 KEEP、DENSE_RANK 概念的 MySQL 解决方案。

```
select userid,
       my_date,
       ...
from
(
select @sno:= case when @pid<>userid then 0
                    else @sno+1
    end as serialnumber, 
    @pid:=userid,
       my_Date,
       ...
from   users order by userid, my_date
) a
where a.serialnumber=0 
```

参考： [http ://benincampus.blogspot.com/2013/08/select-rows-which-have-maxmin-value-in.html](http://benincampus.blogspot.com/2013/08/select-rows-which-have-maxmin-value-in.html)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-23T14:57:43.523

```
select userid, value, date
  from thetable t1 ,
       ( select t2.userid, max(t2.date) date2 
           from thetable t2 
          group by t2.userid ) t3
 where t3.userid t1.userid and
       t3.date2 = t1.date 
```

恕我直言，这有效。高温高压

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-23T15:05:01.727

我认为这应该工作？

```
Select
T1.UserId,
(Select Top 1 T2.Value From Table T2 Where T2.UserId = T1.UserId Order By Date Desc) As 'Value'
From
Table T1
Group By
T1.UserId
Order By
T1.UserId 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-23T15:11:04.083

这应该很简单：

```
SELECT UserId, Value
FROM Users u
WHERE Date = (SELECT MAX(Date) FROM Users WHERE UserID = u.UserID) 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-23T15:17:59.950

首先尝试我误读了问题，按照最佳答案，这是一个具有正确结果的完整示例：

```
CREATE TABLE table_name (id int, the_value varchar(2), the_date datetime);

INSERT INTO table_name (id,the_value,the_date) VALUES(1 ,'a','1/1/2000');
INSERT INTO table_name (id,the_value,the_date) VALUES(1 ,'b','2/2/2002');
INSERT INTO table_name (id,the_value,the_date) VALUES(2 ,'c','1/1/2000');
INSERT INTO table_name (id,the_value,the_date) VALUES(2 ,'d','3/3/2003');
INSERT INTO table_name (id,the_value,the_date) VALUES(2 ,'e','3/3/2003'); 
```

--

```
 select id, the_value
      from table_name u1
      where the_date = (select max(the_date)
                     from table_name u2
                     where u1.id = u2.id) 
```

--

```
id          the_value
----------- ---------
2           d
2           e
1           b

(3 row(s) affected) 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2010-02-24T17:07:28.487

这也将处理重复（为每个 user_id 返回一行）：

```
SELECT *
FROM (
  SELECT u.*, FIRST_VALUE(u.rowid) OVER(PARTITION BY u.user_id ORDER BY u.date DESC) AS last_rowid
  FROM users u
) u2
WHERE u2.rowid = u2.last_rowid 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2013-04-21T02:36:36.990

```
select   UserId,max(Date) over (partition by UserId) value from users; 
```

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2008-09-23T14:44:53.087

如果 (UserID, Date) 是唯一的，即同一用户没有出现两次日期，则：

```
select TheTable.UserID, TheTable.Value
from TheTable inner join (select UserID, max([Date]) MaxDate
                          from TheTable
                          group by UserID) UserMaxDate
     on TheTable.UserID = UserMaxDate.UserID
        TheTable.[Date] = UserMaxDate.MaxDate; 
```

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2015-06-17T10:09:08.490

如果您的问题与该页面相似，请检查[此链接](https://stackoverflow.com/questions/30393321/how-to-select-a-unique-record-in-a-table-which-has-no-key-constraints#comment49816289_30393321)，那么我建议您使用以下查询，该查询将为该链接提供解决方案

`select distinct sno,item_name,max(start_date) over(partition by sno),max(end_date) over(partition by sno),max(creation_date) over(partition by sno), max(last_modified_date) over(partition by sno) from uniq_select_records order by sno,item_name asc;`

将给出与该链接相关的准确结果

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2017-05-11T11:18:22.907

使用代码：

```
select T.UserId,T.dt from (select UserId,max(dt) 
over (partition by UserId) as dt from t_users)T where T.dt=dt; 
```

这将检索结果，而不考虑 UserId 的重复值。如果您的 UserId 是唯一的，那么它会变得更加简单：

```
select UserId,max(dt) from t_users group by UserId; 
```

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2018-10-16T07:08:07.223

```
SELECT a.userid,a.values1,b.mm 
FROM table_name a,(SELECT userid,Max(date1)AS mm FROM table_name GROUP BY userid) b
WHERE a.userid=b.userid AND a.DATE1=b.mm; 
```

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2020-05-14T10:58:07.897

下面的查询可以工作：

```
SELECT user_id, value, date , row_number() OVER (PARTITION BY user_id ORDER BY date desc) AS rn
FROM table_name
WHERE rn= 1 
```

* * *

## 回答 #35

> 赞同：-2
> 
> 时间：2017-09-08T09:50:37.407

```
SELECT a.* 
FROM user a INNER JOIN (SELECT userid,Max(date) AS date12 FROM user1 GROUP BY userid) b  
ON a.date=b.date12 AND a.userid=b.userid ORDER BY a.userid; 
```

# scripting - 如何确定文件的行尾

> ID：121392
> 
> 赞同：53
> 
> 时间：2008-09-23T14:34:35.263
> 
> 标签：scripting, line-endings

我有一堆（数百个）应该有 Unix 行结尾的文件。我强烈怀疑其中一些有 Windows 行尾，我想以编程方式找出哪些行尾。

我知道我可以跑

```
翻转 -u
```

或脚本中的类似内容来转换所有内容，但我希望能够识别那些需要首先更改的文件。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-09-23T14:40:41.630

您可以使用该[`file`](http://en.wikipedia.org/wiki/File_(Unix))工具，它会告诉您行尾的类型。或者，您可以使用`dos2unix -U`which 将所有内容转换为 Unix 行结尾，而不管它以什么开头。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-23T14:42:27.587

你可以使用 grep

```
egrep -l $'\r'\$ * 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-01-14T15:24:03.480

类似于以下内容：

```
perl -p -e 's[\r\n][WIN\n]; s[(?<!WIN)\n][UNIX\n]; s[\r][MAC\n];' FILENAME 
```

尽管其中一些正则表达式可能需要完善和整理。

这将在每行的末尾输出带有 WIN、MAC 或 UNIX 的文件。如果您的文件在某种程度上是一个可怕的混乱（或差异）并且有混合的结局，那就太好了。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-06-15T21:41:40.733

这是最安全的答案。stimms 回答不考虑子目录和二进制文件

```
find . -type f -exec file {} \; | grep "CRLF" | awk -F ':' '{ print $1 }' 
```

*   用于`file`查找文件类型。那些有 CRLF 的有窗口返回字符。的输出`file`由 a 分隔`:`，第一个字段是文件的路径。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T14:42:11.847

Unix 使用一个字节，0x0A（换行），而 windows 使用两个字节，0x0D 0x0A（回车，换行）。

如果您从未看到 0x0D，那么它很可能是 Unix。如果您看到 0x0D 0x0A 对，那么很可能是 MSDOS。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T14:36:53.090

Windows 使用 char 13 和 10 作为行尾，unix 只有其中一个（我不记得是哪一个）。因此，您可以将 char 13 和 10 替换为 char 13 或 10 （使用 unix 的那个）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-09T09:00:39.960

当您知道哪些文件具有 Windows 行结尾（`0x0D 0x0A`或`\r \n`）时，您将如何处理这些文件？我想，您会将它们转换为 Unix 行尾（`0x0A`或`\n`）。您可以使用实用程序将具有 Windows 行尾的文件转换为 Unix 行尾`sed`，只需使用命令：

```
$> sed -i 's/\r//' my_file_with_win_line_endings.txt 
```

您可以将其放入脚本中，如下所示：

```
#!/bin/bash

function travers()
{
    for file in $(ls); do
        if [ -f "${file}" ]; then
            sed -i 's/\r//' "${file}"
        elif [ -d "${file}" ]; then
            cd "${file}"
            travers
            cd ..
        fi
    done
}

travers 
```

如果你从你的根目录运行它，最后你会确定所有文件都以 Unix 行结尾。

# eclipse - eclipse 和 netbeans 6.1 的 grails 插件

> ID：121393
> 
> 赞同：3
> 
> 时间：2008-09-23T14:34:45.607
> 
> 标签：eclipse, grails, netbeans, plugins

有没有人成功让 eclipse 的 grails 插件工作？带有netbeans的grails插件怎么样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T17:18:35.433

如果您使用 NetBeans 6.5 Beta，您会发现 Grails 的功能很有前景，但仍然存在缺陷（次要）。好在 6.5 Groovy 和 Grails 支持是标准的，您不必安装插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T14:37:45.380

不幸的是，Grails 的 Eclipse 插件并没有太大的进展，我们已经开始使用[IntelliJ IDEA](http://www.jetbrains.com/idea/)进行 Grails 开发，[JetGroovy](http://www.jetbrains.com/idea/features/groovy_grails.html)插件非常棒，并且在不断进步！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-19T15:55:32.093

Netbeans 6.5 非常适合 Grails 并允许调试，尽管代码完成几乎没有。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-15T23:34:14.067

好吧，这里有一个快速更新。Eclipse 插件可以工作，并且具有重构支持。但是，由于某种原因，我无法让它识别 Eclipse 项目中的 Grails 插件。

不过它开始出现了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T01:25:09.177

我没有任何问题让 Eclipse grails 插件“工作”，因为它已安装并提供所有宣传的功能。问题是这组功能很少，而且比 IntelliJ 落后几年。我知道从免费 IDE 切换到商业 IDE 根本不可能，但如果可以，那就去做吧！尽管 Netbeans 比 Eclipse 好，但它仍然落后于 IntelliJ 相当的距离。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-05T09:00:49.077

只是为了将来的文档：Netbeans 6.8 提供了一个非常好的 Grails/Groovy 插件，它的工作原理就像一个魅力。此外，您可以使用新的代码覆盖率插件。真的很不错的构建。

链接： [Netbeans 主页](http://netbeans.org/)

但是你必须记住，Grails 现在属于 Spring Source。Spring Source 以开发自己的基于 Eclipse 的工具套件而闻名。也许我们会看到一个更好的 Eclipse 的 grails 插件实现。

# python - 访问对象内存地址

> ID：121396
> 
> 赞同：206
> 
> 时间：2008-09-23T14:35:00.443
> 
> 标签：python, object, memory-address, repr

当您`object.__repr__()`在 Python 中调用该方法时，您会得到如下信息：

> ```
> <__main__.Test object at 0x2aba1c0cf890> 
> ```

如果您重载，是否有任何方法可以获取内存地址`__repr__()`，然后调用`super(Class, obj).__repr__()`和正则表达式？

* * *

## 回答 #1

> 赞同：240
> 
> 时间：2008-09-23T14:41:30.270

[Python手册](https://docs.python.org/2/library/functions.html#id)有这样的说法`id()`：

> 返回对象的“身份”。这是一个整数（或长整数），保证在其生命周期内对于该对象是唯一且恒定的。具有非重叠生命周期的两个对象可能具有相同的 id() 值。 （实现说明：这是对象的地址。）

所以在 CPython 中，这将是对象的地址。但是，对于任何其他 Python 解释器都没有这样的保证。

请注意，如果您正在编写 C 扩展，您可以完全访问 Python 解释器的内部，包括直接访问对象的地址。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2008-09-23T14:49:57.553

您可以通过这种方式重新实现默认 repr：

```
def __repr__(self):
    return '<%s.%s object at %s>' % (
        self.__class__.__module__,
        self.__class__.__name__,
        hex(id(self))
    ) 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2008-09-23T14:37:24.853

只需使用

```
id(object) 
```

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2014-10-09T18:41:51.540

这里有一些其他答案未涵盖的问题。

首先，[`id`](https://docs.python.org/3/library/functions.html#id)只返回：

> 对象的“身份”。这是一个整数（或长整数），保证该对象在其生命周期内是唯一且恒定的。具有不重叠生命周期的两个对象可能具有相同的`id()`值。

* * *

在 CPython 中，这恰好是指向[`PyObject`](https://docs.python.org/3/c-api/object.html)在解释器中表示对象的指针，这与`object.__repr__`显示的内容相同。但这只是 CPython 的一个实现细节，而不是 Python 的一般情况。Jython 不处理指针，它处理 Java 引用（JVM 当然可能将其表示为指针，但是您看不到这些，也不想看到，因为允许 GC 移动它们）。PyPy 允许不同类型有不同种类的`id`，但最通用的只是您调用的对象表的索引`id`on，这显然不是一个指针。我不确定 IronPython，但我怀疑在这方面它更像 Jython 而不是 CPython。因此，在大多数 Python 实现中，没有办法得到其中显示的任何内容`repr`，如果这样做也没有用。

* * *

但是如果你只关心 CPython 怎么办？毕竟，这是一个很常见的情况。

好吧，首先，您可能会注意到这`id`是一个整数；* 如果您想要该`0x2aba1c0cf890`字符串而不是数字`46978822895760`，您将不得不自己格式化它。在幕后，我相信`object.__repr__`最终会使用`printf`'s`%p`格式，这是 Python 所没有的……但你总是可以这样做：

```
format(id(spam), '#010x' if sys.maxsize.bit_length() <= 32 else '#18x') 
```

[* 在 3.x 中，它是一个`int`. 在 2.x 中，`int`如果它足够大，可以容纳一个指针——这可能不是因为某些平台上的符号数问题——`long`否则就是一个。]

除了打印出来之外，你还能用这些指针做些什么吗？当然（再次假设您只关心 CPython）。

所有[C API](https://docs.python.org/3/c-api/index.html)函数都带有一个指向某个`PyObject`或相关类型的指针。对于那些相关的类型，您只需调用`PyFoo_Check`以确保它确实是一个`Foo`对象，然后使用`(PyFoo *)p`. 因此，如果您正在编写 C 扩展，那么`id`这正是您所需要的。

如果您正在编写纯 Python 代码怎么办？[`pythonapi`](https://docs.python.org/3/library/ctypes.html#accessing-values-exported-from-dlls)您可以使用from调用完全相同的函数`ctypes`。

* * *

最后，提出了其他一些答案[`ctypes.addressof`](https://docs.python.org/3/library/ctypes.html#ctypes.addressof)。这与这里无关。这仅适用于`ctypes`像这样的对象`c_int32`（可能还有一些类似内存缓冲区的对象，比如 提供的对象`numpy`）。而且，即使在那里，它也没有给你值的地址，它给你的是包裹起来`c_int32`的 C 级的地址。`int32``c_int32`

话虽如此，通常情况下，如果您真的认为需要某物的地址，那么您一开始就不需要原生 Python 对象，而是需要一个`ctypes`对象。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-01-07T17:14:04.557

只是为了回应 Torsten，我无法调用`addressof()`常规的 python 对象。此外，`id(a) != addressof(a)`. 这是在CPython中，不知道其他任何事情。

```
>>> from ctypes import c_int, addressof
>>> a = 69
>>> addressof(a)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: invalid type
>>> b = c_int(69)
>>> addressof(b)
4300673472
>>> id(b)
4300673392 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-23T15:00:58.150

使用[ctypes](http://docs.python.org/lib/module-ctypes.html)，您可以使用

```
>>> import ctypes
>>> a = (1,2,3)
>>> ctypes.addressof(a)
3077760748L 
```

文档：

> `addressof(C instance) -> integer`
> 返回 C 实例内部缓冲区的地址

请注意，在 CPython 中，当前`id(a) == ctypes.addressof(a)`，但`ctypes.addressof`应该返回每个 Python 实现的真实地址，如果

*   支持 ctypes
*   内存指针是一个有效的概念。

**编辑**：添加了有关 ctypes 的解释器独立性的信息

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-23T14:38:01.760

您可以通过以下方式获得适合该目的的东西：

```
id(self) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-09-25T22:53:26.233

我知道这是一个老问题，但如果你还在编程，这些天在 python 3 中......我实际上发现如果它是一个字符串，那么有一个非常简单的方法可以做到这一点：

```
>>> spam.upper
<built-in method upper of str object at 0x1042e4830>
>>> spam.upper()
'YO I NEED HELP!'
>>> id(spam)
4365109296 
```

字符串转换也不影响内存中的位置：

```
>>> spam = {437 : 'passphrase'}
>>> object.__repr__(spam)
'<dict object at 0x1043313f0>'
>>> str(spam)
"{437: 'passphrase'}"
>>> object.__repr__(spam)
'<dict object at 0x1043313f0>' 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-08-06T16:34:37.970

**您可以使用内置**' ' 类型的 ' **partition** ' 方法获取任何对象的内存地址/位置。****`str`****

 **这是一个使用它来获取对象的内存地址的示例：

```
Python 3.8.3 (default, May 27 2020, 02:08:17)
[GCC 9.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> object.__repr__(1)
'<int object at 0x7ca70923f0>'
>>> hex(int(object.__repr__(1).partition('object at ')[2].strip('>'), 16))
0x7ca70923f0
>>> 
```

*在这里*，我使用带有对象/项目（例如作为参数）的内置`object`“类”方法来返回字符串，然后我对该字符串进行分区，该字符串将在我返回的字符串之前返回字符串的元组提供，我提供的字符串，然后是我提供的字符串之后的字符串，并且由于内存位置位于' '之后，我可以获得内存地址，因为它已将其与该部分进行了分区。`__repr__``1``object at`

然后，由于内存地址作为返回元组中的第三项返回，我可以使用`2`元组中的索引访问它。但是，它在我获得的字符串中有一个直角括号作为后缀，所以我使用 ' `strip`' 函数将其删除，这将在没有尖括号的情况下返回它。然后我将结果字符串转换为以 16 为底的整数，然后将其转换为十六进制数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T16:10:37.110

虽然`id(object)`在默认的 CPython 实现中获取对象的地址是正确的，但这通常是无用的……你不能用纯 Python 代码中的地址*做任何事情。*

您真正能够使用该地址的唯一时间是来自 C 扩展库......在这种情况下，获取对象的地址是微不足道的，因为 Python 对象总是作为 C 指针传递。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-04T19:19:56.350

如果`__repr__`重载了，可以考虑`__str__`查看变量的内存地址。

这是StackOverflow 中[Moshe Zadka的](https://stackoverflow.com/users/122683/moshez)[`__repr__`vs`__str__`](https://stackoverflow.com/questions/1436703/what-is-the-difference-between-str-and-repr)的详细信息。

# sqlite - 在 sqlite 数据库中存储日历日

> ID：121408
> 
> 赞同：1
> 
> 时间：2008-09-23T14:36:22.687
> 
> 标签：sqlite, date, time, calendar, iso8601

我需要在 sqlite 数据库中存储带有日历日期（只是一天，没有时间）的项目。在列中表示日期的最佳方式是什么？朱利安天和 unix 秒是合理的选择。如果我去的单位不是几天，应该是什么时间？

更新：我知道 ISO8601 并实际使用它将日期存储为原型的 YYYY-MM-DD 格式的字符串。但是对于各种算术，我必须在内部将其转换为某个数字，所以我更愿意存储一个数字并转换为字符串进行显示。这个数字应该是什么单位，来源是什么，如果单位比天更精确，应该使用什么时间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T14:44:47.017

如果您希望将日期交给外部工具或库，您应该使用它期望的任何格式。Unix 时间似乎是数字时计的通用语，因此如果外部环境不适合您，它是一个很好的默认设置。

[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601#Calendar_dates)可能很有趣。

*编辑：*

> 但是对于各种算术，我必须在内部将其转换为某个数字，所以我更愿意存储一个数字并转换为字符串进行显示。

啊，有道理。如果您的环境（.NET？Python？C++？）有时间处理工具，最好使用它们的本机单元和纪元。没有理由重写所有这些日期操作函数。他们比看起来更棘手。否则，我会使用本地（公历？）日历中的天数，因为您的应用程序处于合理的时期。大方一点，当您突然需要处理比您预期更早的日期时，您不希望出现反向 Y2K 错误。

一天中的时间完全取决于口味。午夜似乎是最干净的选择（小时、分钟、秒字段中的所有零），但由于它永远不会到达用户那里，因此没有实际意义。事实上，这将是一个复活节彩蛋的好地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T14:59:02.787

如果您想覆盖您的基础，请确保将日期存储在 UTC 中并选择 ISO 标准。这种方法需要最少的努力，并且可以保护您的代码免受未来互操作的困扰。我同意@skymt [ISO 8601](http://en.wikipedia.org/wiki/ISO_8601#Calendar_dates)是一个不错的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T15:27:22.143

如果您使用的是 C++，那么 boost::date_time 非常值得一看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T23:13:51.037

“最佳”几乎完全取决于日期的来源（NSDate 对象、一些 XML 提要）以及它们的操作方式（简单地按原样存储与做一些算术，如“直到”）。

I'm not necessarily recommending this, but I wrote an app which also needed to store date-but-not-time in an SQLite DB. At first I used two columns, Month and Day, where Month was defined as the number of months since January 2000\. I needed to enforce one-row-per-date, so I defined a UNIQUE index across those two columns, and it turned out to make updates horribly slow.

For my second attempt, I used a similar scheme but encoded the date into one number, by using the bottom 5 bits for the Day and the remaining upper bits for the Month (again, since Jan 2000). The conversion functions were:

```
Date = (Month << 5) | Day
Month = Date >> 5
Day = 0x1F & Date 
```

该方案保留了日期的数字顺序，并且可以轻松地将它们拆分为组件。这对我的应用程序很有意义，因为我按月存储数据。如果给定一个日期，您想查找下一个日期，则此方案可能不是最好的，因为日期 + 1 可能不是有效日期。

# python - 如何在我的 Django 500.html 页面中包含堆栈跟踪？

> ID：121439
> 
> 赞同：25
> 
> 时间：2008-09-23T14:39:35.877
> 
> 标签：python, django, templates, stack-trace

我正在跑步`Django 1.0`，我即将部署我的应用程序。因此，我会将 DEBUG 设置更改为 False。

话虽如此，当发生错误时，我仍然希望在我的 500.html 页面上包含堆栈跟踪。通过这样做，用户可以复制并粘贴错误并轻松地将它们通过电子邮件发送给开发人员。

关于如何最好地解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-23T14:44:50.810

以这种方式自动记录您的 500s：

*   你知道它们什么时候发生。
*   您不需要依赖用户向您发送堆栈跟踪。

Joel 甚至建议在您的应用程序遇到故障时在您的错误跟踪器中自动创建票证。就个人而言，我创建了一个（私人）RSS 提要，其中包含开发人员可以订阅的堆栈跟踪、网址等。

另一方面，向您的用户显示堆栈跟踪可能会泄漏恶意用户可能用来攻击您的站点的信息。过于详细的错误消息是 SQL 注入攻击的经典垫脚石之一。

*编辑*（添加代码示例以捕获回溯）：

您可以从 sys.exc_info 调用中获取异常信息。虽然格式化回溯以显示来自回溯模块：

```
import traceback
import sys

try:
    raise Exception("Message")
except:
    type, value, tb = sys.exc_info()
    print >> sys.stderr,  type.__name__, ":", value
    print >> sys.stderr, '\n'.join(traceback.format_tb(tb)) 
```

印刷：

```
Exception : Message
  File "exception.py", line 5, in <module>
    raise Exception("Message") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-23T17:32:19.267

正如@zacherates 所说，您真的不想向您的用户显示堆栈跟踪。解决这个问题的最简单方法是，如果您在 ADMINS 设置中列出了您自己和您的开发人员的电子邮件地址，则 Django 默认会执行此操作；每次出现 DEBUG = False 的 500 错误时，它都会向该列表中的每个人发送一封电子邮件，其中包含完整的堆栈跟踪（以及更多信息）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-05T07:50:53.047

如果我们想在您的模板（500.html）上显示生成的异常，那么我们可以编写您自己的 500 视图，获取异常并将其传递给您的 500 模板。

## 脚步：

## # 在views.py中：

```
import sys,traceback

def custom_500(request):
    t = loader.get_template('500.html')

    print sys.exc_info()
    type, value, tb = sys.exc_info()
    return HttpResponseServerError(t.render(Context({
        'exception_value': value,
        'value':type,
        'tb':traceback.format_exception(type, value, tb)
    },RequestContext(request)))) 
```

## # 在主 urls.py 中：

```
from django.conf.urls.defaults import *
handler500 = 'project.web.services.views.custom_500' 
```

## # 在模板中（500.html）：

```
{{ exception_value }}{{value}}{{tb}} 
```

更多信息在这里：[https ://docs.djangoproject.com/en/dev/topics/http/views/#the-500-server-error-view](https://docs.djangoproject.com/en/dev/topics/http/views/#the-500-server-error-view)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T14:46:22.880

您可以调用`sys.exc_info()`自定义异常处理程序。但我不建议这样做。Django 可以向您发送异常电子邮件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-09T10:53:22.643

我知道这是一个老问题，但现在我建议使用[Sentry](https://getsentry.com/welcome/)之类的服务来捕获您的错误。

在 Django 上，设置它的步骤非常简单。从[文档](https://docs.getsentry.com/hosted/clients/python/integrations/django/)：

*   使用安装 Raven`pip install raven`
*   添加`'raven.contrib.django.raven_compat'`到您的`settings.INSTALLED_APPS`.
*   添加`RAVEN_CONFIG = {"dsn": YOUR_SENTRY_DSN}`到您的设置中。

然后，在您的 500 页面（定义在 中`handler500`）上，将 传递`request.sentry.id`给模板，您的用户可以引用特定错误，而不会暴露您的任何内部信息。

# flash - 如何从 Action Script 3.0 中了解 Flash Player 版本

> ID：121453
> 
> 赞同：3
> 
> 时间：2008-09-23T14:41:30.613
> 
> 标签：flash, actionscript-3

有没有办法知道安装在使用 Action Script 3.0 运行我们的 SWF 文件的计算机上的 flash 播放器版本？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T07:26:10.543

如果您在 IDE 中进行编程，以下将为您提供版本

```
跟踪（功能。版本）；

```

如果您正在构建自定义类，则以下内容应该会有所帮助。确保以下代码进入名为 VersionCheck.as 的文件中

> ```
> 包裹
> {
>     导入 flash.system.Capabilities；
> 
>     公共类版本检查
>     {
>         公共函数版本检查（）：无效
>         {
>             跟踪（功能。版本）；
>         }
>     }
> }
> 
> ```

希望这会有所帮助，永远记住所有的 AS3 语言都可以在这里在线学习[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T14:46:19.137

它在[flash.system.Capabilities.version](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/Capabilities.html#version)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-29T15:47:28.943

此示例可能有助于弄清楚您收到的详细信息，以便您可以根据您获得的有些尴尬的数据中的细节采取行动。

```
import flash.system.Capabilities;

var versionNumber:String = Capabilities.version;
trace("versionNumber: "+versionNumber);
trace("-----");

// The version number is a list of items divided by ","
var versionArray:Array = versionNumber.split(",");
var length:Number = versionArray.length;
for(var i:Number = 0; i < length; i++) trace("versionArray["+i+"]: "+versionArray[i]);
trace("-----");

// The main version contains the OS type too so we split it in two
// and we'll have the OS type and the major version number separately.
var platformAndVersion:Array = versionArray[0].split(" ");
for(var j:Number = 0; j < 2; j++) trace("platformAndVersion["+j+"]: "+platformAndVersion[j]);
trace("-----");

var majorVersion:Number = parseInt(platformAndVersion[1]);
var minorVersion:Number = parseInt(versionArray[1]);
var buildNumber:Number = parseInt(versionArray[2]);

trace("Platform: "+platformAndVersion[0]);
trace("Major version: "+majorVersion);
trace("Minor version: "+minorVersion);
trace("Build number: "+buildNumber);
trace("-----");

if (majorVersion < 9) trace("Your Flash Player version is older than the current version 9, please update.");
else trace("You are using Flash Player 9 or later."); 
```

# command-line - 通过命令行访问正在运行的单声道应用程序

> ID：121476
> 
> 赞同：2
> 
> 时间：2008-09-23T14:44:55.083
> 
> 标签：command-line, mono

通过命令行（Linux/Unix）访问正在运行的单声道应用程序的最佳方式是什么？

示例：一个单声道服务器应用程序正在运行，我想使用命令行以最轻/最快的方式向它发送命令，从而导致服务器发回响应（例如到标准输出）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T14:46:07.140

我想说做一个小而简单的控制器程序，它接受您所需的命令行参数并使用远程处理将消息发送到正在运行的守护程序。

这类似于托盘图标控制器程序与大多数 Windows 服务模式中普遍存在的后台服务通信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-02T02:17:07.940

Mono 的[`gsharp`](http://www.mono-project.com/CsharpRepl)工具是一个图形化的 REPL，它可以让你`Attach to Process`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T21:02:13.117

@Rich B：这绝对是一个合适的解决方案，我已经实现了 - 但是在我必须使用的服务器上，单个请求的远程处理方法大约需要 350 毫秒。

我已经测量了请求处理的服务器端的时间 - 请求在不到 10 毫秒的时间内处理，所以它必须是客户端程序的启动和 tcp 连接，这会占用时间。

因此希望我能找到另一种方法将请求发布到服务器应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-01T20:42:00.567

您可以使用[system.net.sockets](http://msdn.microsoft.com/en-us/library/system.net.sockets%28VS.71%29.aspx)抽象在 TCP 端口上创建服务，然后远程登录到该端口。

检查[图书馆状态页面](http://mono.ximian.com/class-status/)；Mono 在这里的报道有点不完整。

# asp.net - 是否有保护通过 Javascript 在 HTML 按钮的单击事件处理程序上进行的 ASP.Net Web 服务调用的好方法？

> ID：121490
> 
> 赞同：3
> 
> 时间：2008-09-23T14:46:57.810
> 
> 标签：asp.net, javascript, service, security

使用带有脚本管理器的服务引用为 Web 服务使用 Javascript 代理的目的是避免页面加载。如果检索到的信息可能是敏感信息，除了使用 SSL 之外，还有其他方法可以保护此 Web 服务调用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T14:53:27.137

我会使用 ssl 它也取决于我想你的信息有多敏感。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T14:58:37.220

如果您担心其他人直接访问您的 Web 服务，您可以检查调用 IP 地址和主机标头，并确保它与预期的 IP 地址匹配。

如果您担心人们在从服务器到客户端的过程中窃取信息，那么 SSL 是唯一的出路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:12:32.303

我会：

1.  使用 SSL 进行连接
2.  在请求中放置基于时间和会话的令牌
3.  根据服务器上的预期范围验证输入

SSL 防止中间人

标记化请求验证请求来自活动且经过身份验证的会话，在会话中最后一个活动的合理时间内。这可以防止重新提交过时的请求并验证它是否来自会话源（将 IP 地址、用户代理等存储在服务器上以进行会话管理）。

验证输入是否在预期范围内可验证请求未被您正在与之交谈的一方篡改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-17T14:59:01.493

尽管 SSL 是最好的，但有许多客户端加密库可以缓解一些安全问题 - 请参阅[https://github.com/jbt/js-crypto](https://github.com/jbt/js-crypto)以获得不错的集合

# c# - 带有 .cer 公钥的 3DES？

> ID：121493
> 
> 赞同：1
> 
> 时间：2008-09-23T14:47:30.600
> 
> 标签：c#, encryption

我不是加密专家，但据我了解，3DES 是一种对称加密算法，这意味着它不使用公钥/私钥。

尽管如此，我的任务是使用公钥（特别是 .CER 文件）加密数据。如果您忽略整个对称/非对称，我应该能够将公钥中的密钥数据用作 TripleDES 密钥。但是，我很难从 .CER 文件中提取关键字节。这是目前的代码..

```
TripleDESCryptoServiceProvider cryptoProvider = new TripleDESCryptoServiceProvider();
X509Certificate2 cert = new X509Certificate2(@"c:\temp\whatever.cer");
cryptoProvider.Key = cert.PublicKey.Key. 
```

我能找到的从证书中提取原始密钥字节的最简单方法是 ToXmlString(bool)，然后对返回的字符串进行一些 hacky 子字符串化。然而，这看起来太老套了，我觉得我一定错过了一种更简单、更明显的方法。

我是否缺少使用 .cer 文件向 C# 3DES 加密类提供密钥数据的更简单方法，或者将其从证书 xml 字符串中破解出来真的是解决此问题的最佳方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T14:58:14.367

将非对称加密生成的密钥用于对称加密并不是一个好主意。没有什么可以阻止您想出一种使用公钥作为 3DES 加密密钥的方法，但最终结果将是任何有权访问公钥的人（这意味着每个人！）都将能够解密您的密文.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T14:53:15.250

cryptoProvider.Key = cert.GetPublicKey()？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T14:53:34.190

使用非对称加密技术加密大量数据并不是可行的方法。相反，使用对称算法加密数据并使用您的公钥加密对称密钥（和 IV）。

[这个](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rijndael.aspx)来自 MSDN 的页面确实帮助我开始使用 .Net 对称加密。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T15:12:42.473

这里真正的问题是公钥是**public**。意味着免费提供，意味着它提供零安全性加密。

哎呀，这个线程上的任何人都拥有解密所有内容所需的所有信息。谷歌人也是如此。

请尽量鼓励您的用户不要使用这样的公钥数据。至少，让他们提供密码或其他更安全的块，您可以使用它们来生成一致的密钥。

还有一件事。证书密钥的大小不同。它可能可以处理丢弃密钥中的额外字节，但如果密钥恰好比 3DES 密钥所需的短，您可能会得到一个数组索引/超出范围异常。我怀疑这会发生，3DES 只需要 56 位，而证书密钥几乎总是 256 位或更大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T14:53:16.280

我认为您缺少的是从包含密钥字节的字符串中转换字节。

希望**[FromBase64String](http://msdn.microsoft.com/en-us/library/system.convert.frombase64string.aspx)**方法对您有所帮助：

```
byte[] keyBytes = Convert.FromBase64String(sourceString); 
```

# javascript - 当发生“模糊”事件时，我如何找出哪个元素焦点*到*？

> ID：121499
> 
> 赞同：216
> 
> 时间：2008-09-23T14:48:43.483
> 
> 标签：javascript, events

假设我将一个`blur`函数附加到一个 HTML 输入框，如下所示：

```
<input id="myInput" onblur="function() { ... }"></input> 
```

有没有办法`blur`在函数内部获取导致事件触发的元素的 ID（被点击的元素）？如何？

例如，假设我有这样的跨度：

```
<span id="mySpan">Hello World</span> 
```

如果我在输入元素获得焦点后立即单击跨度，则输入元素将失去焦点。该函数如何知道它是`mySpan`被点击的？

PS：如果 span 的 onclick 事件发生在 input 元素的 onblur 事件之前，我的问题将得到解决，因为我可以设置一些状态值来指示特定元素已被单击。

PPS：这个问题的背景是我想从外部（从可点击元素）触发一个 AJAX 自动完成器控件来显示它的建议，而建议不会因为`blur`输入元素上的事件而立即消失。因此，如果单击了某个特定元素，我想检查该`blur`函数，如果是，则忽略模糊事件。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2015-10-25T03:42:30.297

**2015回答**：根据[UI Events](http://www.w3.org/TR/uievents)，您可以使用[`relatedTarget`](http://www.w3.org/TR/uievents/#widl-FocusEvent-relatedTarget)事件的属性：

> 用于识别[`EventTarget`](http://www.w3.org/TR/uievents/#interface-EventTarget)与焦点事件相关的次要事件，具体取决于事件的类型。

对于[`blur`](http://www.w3.org/TR/uievents/#event-type-blur)活动，

> [`relatedTarget`](http://www.w3.org/TR/uievents/#widl-FocusEvent-relatedTarget):[事件目标](http://www.w3.org/TR/uievents/#glossary-event-target)接收焦点。

例子：

```
function blurListener(event) {
  event.target.className = 'blurred';
  if(event.relatedTarget)
    event.relatedTarget.className = 'focused';
}
[].forEach.call(document.querySelectorAll('input'), function(el) {
  el.addEventListener('blur', blurListener, false);
});
```

```
.blurred { background: orange }
.focused { background: lime }
```

```
<p>Blurred elements will become orange.</p>
<p>Focused elements should become lime.</p>
<input /><input /><input />
```

注意 Firefox`relatedTarget`直到版本 48（[错误 962251](https://bugzilla.mozilla.org/show_bug.cgi?id=962251)，[MDN](https://developer.mozilla.org/en-US/docs/Web/API/FocusEvent/relatedTarget)）才支持。

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2008-09-23T15:25:04.660

嗯... 在 Firefox 中，您可以使用`explicitOriginalTarget`拉取被点击的元素。我希望`toElement`对 IE 做同样的事情，但它似乎不起作用......但是，您可以从文档中提取新聚焦的元素：

```
function showBlur(ev)
{
   var target = ev.explicitOriginalTarget||document.activeElement;
   document.getElementById("focused").value = 
      target ? target.id||target.tagName||target : '';
}

...

<button id="btn1" onblur="showBlur(event)">Button 1</button>
<button id="btn2" onblur="showBlur(event)">Button 2</button>
<button id="btn3" onblur="showBlur(event)">Button 3</button>
<input id="focused" type="text" disabled="disabled" /> 
```

* * *

**警告：**此技术不适*用于*使用键盘在字段中切换引起的焦点更改*，*并且在 Chrome 或 Safari 中根本不起作用。使用`activeElement`（IE除外）的一个大问题是它直到事件处理完毕后才会持续更新*，*并且`blur`在处理过程中可能根本没有有效值！这可以通过[改变 Michiel 最终使用的技术](https://stackoverflow.com/questions/121499/when-onblur-occurs-how-can-i-find-out-which-element-focus-went-to/128452#128452)来缓解：

```
function showBlur(ev)
{
  // Use timeout to delay examination of activeElement until after blur/focus 
  // events have been processed.
  setTimeout(function()
  {
    var target = document.activeElement;
    document.getElementById("focused").value = 
      target ? target.id||target.tagName||target : '';
  }, 1);
} 
```

这应该适用于大多数现代浏览器（在 Chrome、IE 和 Firefox 中测试），但需要注意的是，Chrome 不会将焦点放在被*点击*的按钮上（与标签页相比）。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-24T17:17:36.097

我最终通过 onblur 事件超时解决了它（感谢不是 StackOverflow 的朋友的建议）：

```
<input id="myInput" onblur="setTimeout(function() {alert(clickSrc);},200);"></input>
<span onclick="clickSrc='mySpan';" id="mySpan">Hello World</span> 
```

适用于 FF 和 IE。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-04-03T19:49:13.390

可以使用文档的 mousedown 事件而不是模糊：

```
$(document).mousedown(function(){
  if ($(event.target).attr("id") == "mySpan") {
    // some process
  }
}); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-12-02T05:05:34.273

type 的实例`FocusEvent`具有`relatedTarget`属性，但是，直到 FF 的版本 47，具体而言，此属性返回`null`，从 48 开始它已经工作。

[你可以在这里](https://developer.mozilla.org/en-US/docs/Web/API/FocusEvent)看到更多。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-05-15T00:16:51.273

适用于 Google Chrome v66.x、Mozilla v59.x 和 Microsoft Edge... 使用 jQuery 的解决方案。

> 我在 Internet Explorer 9 中测试但不支持。

```
$("#YourElement").blur(function(e){
     var InputTarget =  $(e.relatedTarget).attr("id"); // GET ID Element
     console.log(InputTarget);
     if(target == "YourId") { // If you want validate or make a action to specfic element
          ... // your code
     }
}); 
```

在其他 Internet Explorer 版本中评论您的测试。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-23T23:36:32.450

你能扭转你正在检查的内容和时间吗？也就是说，如果您还记得最后模糊的内容：

```
<input id="myInput" onblur="lastBlurred=this;"></input> 
```

然后在您的跨度的 onClick 中，使用两个对象调用 function() ：

```
<span id="mySpan" onClick="function(lastBlurred, this);">Hello World</span> 
```

然后，您的函数可以决定是否触发 Ajax.AutoCompleter 控件。该函数具有单击对象*和*模糊对象。onBlur 已经发生，所以它不会使建议消失。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-07T10:56:06.427

如果单击特定元素并有一个有效的解决方案，我还试图让 Autocompleter 忽略模糊，但由于 explicitOriginalTarget 仅适用于 Firefox

```
Autocompleter.Base.prototype.onBlur = Autocompleter.Base.prototype.onBlur.wrap( 
        function(origfunc, ev) {
            if ($(this.options.ignoreBlurEventElement)) {
                var newTargetElement = (ev.explicitOriginalTarget.nodeType == 3 ? ev.explicitOriginalTarget.parentNode : ev.explicitOriginalTarget);
                if (!newTargetElement.descendantOf($(this.options.ignoreBlurEventElement))) {
                    return origfunc(ev);
                }
            }
        }
    ); 
```

此代码包装了 Autocompleter 的默认 onBlur 方法，并检查是否设置了 ignoreBlurEventElement 参数。如果已设置，则每次检查单击的元素是否为 ignoreBlurEventElement。如果是，Autocompleter 不会调用 onBlur，否则它会调用 onBlur。唯一的问题是它只适用于 Firefox，因为 explicitOriginalTarget 属性是 Mozilla 特定的。现在我试图找到一种不同于使用explicitOriginalTarget 的方法。您提到的解决方案要求您手动将 onclick 行为添加到元素。如果我无法解决explicitOriginalTarget 问题，我想我会遵循您的解决方案。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-23T15:01:49.223

我认为这是不可能的，你可以尝试使用IE `window.event.toElement`，但它不适用于firefox！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-01-13T15:45:07.277

使用这样的东西：

```
var myVar = null; 
```

然后在你的函数里面：

```
myVar = fldID; 
```

进而：

```
setTimeout(setFocus,1000) 
```

进而：

```
function setFocus(){ document.getElementById(fldID).focus(); } 
```

最终代码：

```
<html>
<head>
    <script type="text/javascript">
        function somefunction(){
            var myVar = null;

            myVar = document.getElementById('myInput');

            if(myVar.value=='')
                setTimeout(setFocusOnJobTitle,1000);
            else
                myVar.value='Success';
        }
        function setFocusOnJobTitle(){
            document.getElementById('myInput').focus();
        }
    </script>
</head>
<body>
<label id="jobTitleId" for="myInput">Job Title</label>
<input id="myInput" onblur="somefunction();"></input>
</body>
</html> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-06-29T13:26:40.750

您可以使用以下方法修复 IE：

```
 event.currentTarget.firstChild.ownerDocument.activeElement 
```

它看起来像 FF 的“explicitOriginalTarget”。

安托万和 J

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-11-30T22:05:45.613

如[this answer](https://stackoverflow.com/a/7096271/473792)中所述，您可以检查 的值`document.activeElement`。`document`是一个全局变量，所以你不必做任何魔法就可以在你的 onBlur 处理程序中使用它：

```
function myOnBlur(e) {
  if(document.activeElement ===
       document.getElementById('elementToCheckForFocus')) {
    // Focus went where we expected!
    // ...
  }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2017-05-06T19:57:08.310

*   document.activeElement 可能是父节点（例如 body 节点，因为它处于从目标切换到另一个目标的临时阶段），因此它不适用于您的范围
*   ev.explicitOriginalTarget 并不总是被重视

所以最好的方法是使用 onclick 对 body 事件间接理解你的 node(event.target) 是模糊的

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T14:51:01.060

**编辑：** 一个hacky方法是创建一个变量来跟踪您关心的每个元素的焦点。因此，如果您关心“myInput”失去焦点，请在焦点上为其设置一个变量。

```
<script type="text/javascript">
   var lastFocusedElement;
</script>
<input id="myInput" onFocus="lastFocusedElement=this;" /> 
```

原始答案：您可以将“this”传递给函数。

```
<input id="myInput" onblur="function(this){
   var theId = this.id; // will be 'myInput'
}" /> 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-23T23:40:42.283

我建议使用全局变量 blurfrom 和 blurto。然后，配置您关心的所有元素，以在它们失去焦点时将它们在 DOM 中的位置分配给变量 blurfrom。此外，配置它们以便获得焦点将变量 blurto 设置为*它们*在 DOM 中的位置。然后，您可以完全使用另一个函数来分析 blurfrom 和 blurto 数据。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-03T22:06:35.407

请记住，使用explicitOriginalTarget 的解决方案不适用于文本输入到文本输入的跳转。

尝试用以下文本输入替换按钮，您将看到不同之处：

```
<input id="btn1" onblur="showBlur(event)" value="text1">
<input id="btn2" onblur="showBlur(event)" value="text2">
<input id="btn3" onblur="showBlur(event)" value="text3"> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2011-06-01T14:32:06.543

我一直在使用相同的功能，发现 FF、IE、Chrome 和 Opera 能够提供事件的源元素。我没有测试过 Safari，但我猜它可能有类似的东西。

```
$('#Form').keyup(function (e) {
    var ctrl = null;
    if (e.originalEvent.explicitOriginalTarget) { // FF
        ctrl = e.originalEvent.explicitOriginalTarget;
    }
    else if (e.originalEvent.srcElement) { // IE, Chrome and Opera
        ctrl = e.originalEvent.srcElement;
    }
    //...
}); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-03-29T15:37:56.013

我不喜欢在编写 javascript 时使用超时，所以我会以 Michiel Borkent 的相反方式来做。（没有尝试后面的代码，但你应该明白）。

```
<input id="myInput" onblur="blured = this.id;"></input>
<span onfocus = "sortOfCallback(this.id)" id="mySpan">Hello World</span> 
```

在头上是这样的

```
<head>
    <script type="text/javascript">
        function sortOfCallback(id){
            bluredElement = document.getElementById(blured);
            // Do whatever you want on the blured element with the id of the focus element

        }

    </script>
</head> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-03-24T22:41:04.580

我写了一个[替代解决方案](https://jsfiddle.net/matrunchyk/h612wb9t/)，如何使任何元素可聚焦和“模糊”。

它基于将元素制作为`contentEditable`并在视觉上隐藏它并禁用编辑模式本身：

```
el.addEventListener("keydown", function(e) {
  e.preventDefault();
  e.stopPropagation();
});

el.addEventListener("blur", cbBlur);
el.contentEditable = true; 
```

[演示](https://jsfiddle.net/matrunchyk/h612wb9t/)

注意：在 Chrome、Firefox 和 Safari (OS X) 中测试。不确定IE。

* * *

相关：我正在寻找 VueJs 的解决方案，所以对于那些对如何使用 Vue Focusable 指令实现此类功能感兴趣/好奇的人，请看[一下](https://jsfiddle.net/matrunchyk/pv10fLxL/)。

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2017-08-28T14:11:00.420

我在答案中只看到黑客，但实际上有一个非常易于使用的内置解决方案：基本上你可以像这样捕获焦点元素：

```
const focusedElement = document.activeElement 
```

[https://developer.mozilla.org/en-US/docs/Web/API/DocumentOrShadowRoot/activeElement](https://developer.mozilla.org/en-US/docs/Web/API/DocumentOrShadowRoot/activeElement)

* * *

## 回答 #21

> 赞同：-3
> 
> 时间：2008-09-23T14:51:52.523

这边走：

```
<script type="text/javascript">
    function yourFunction(element) {
        alert(element);
    }
</script>
<input id="myinput" onblur="yourFunction(this)"> 
```

或者，如果您通过 JavaScript（本例中为 jQuery）附加侦听器：

```
var input = $('#myinput').blur(function() {
    alert(this);
}); 
```

**编辑**：对不起。我误读了这个问题。

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2012-08-17T11:15:52.350

我认为它很容易通过 jquery 通过传递导致“this”中的 onblur 事件的字段的引用来实现。
例如

```
<input type="text" id="text1" onblur="showMessageOnOnblur(this)">

function showMessageOnOnblur(field){
    alert($(field).attr("id"));
} 
```

谢谢
莫妮卡

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2015-04-17T16:10:01.717

你可以这样：

```
<script type="text/javascript">
function myFunction(thisElement) 
{
    document.getElementByName(thisElement)[0];
}
</script>
<input type="text" name="txtInput1" onBlur="myFunction(this.name)"/> 
```

# security - SPSecurity.RunWithElevatedPrivileges 是否在控制台应用程序中执行任何操作？

> ID：121504
> 
> 赞同：3
> 
> 时间：2008-09-23T14:49:27.053
> 
> 标签：security, sharepoint, moss, wss

根据我从反射器中收集到的信息，RunWithElevatedPriveleges 只是将当前线程身份恢复为基本（非模拟）身份。这对于在 WSS 应用程序池中运行的代码非常有意义，因为基本服务帐户是超级用户。在不存在模拟的情况下，在外部（控制台或服务）应用程序中运行时是否有任何影响？我猜不是，但我想确定一下。我从谷歌上看到了不同的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T17:01:18.890

我认为如果您在一个帐户下运行可执行文件然后使用代码更改它的凭据（就像 SP 一样），它会。否则，如果没有某种方式生成 Credentials 对象，它就无法提升到它在开始时没有的权限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T13:48:51.763

通常 Runwithelevatedprivileges 将使您的代码作为应用程序池身份运行，但它在控制台中不起作用。在这种情况下，我们所做的是使用[runas](http://technet.microsoft.com/en-us/library/cc781769.aspx)或将计划任务的标识设置为与应用程序池标识相同的帐户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T00:35:16.073

当 HTTPContext 为空时，RunWithElevatedPriveleges 不起作用。在控制台中，HTTPContext 为空。

# c# - 将带有“&”的 XML 读入 C# XMLDocument 对象

> ID：121511
> 
> 赞同：18
> 
> 时间：2008-09-23T14:50:37.707
> 
> 标签：c#, .net, asp.net, xml, xmldocument

我继承了一个编写不佳的 Web 应用程序，当它尝试读取存储在数据库中的 xml 文档时，它似乎有错误，其中包含“&”。例如，会有一个标签，其内容为：“预付和收费”。是否有一些秘密的简单方法可以让它在解析该字符时不会出错，或者我是否遗漏了一些明显的东西？

编辑：是否有任何其他字符会导致这种相同类型的解析器错误，因为格式不正确？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-23T14:54:17.667

问题是xml格式不正确。正确生成的 xml 会像这样列出这些数据：

> `Prepaid &amp; Charge`

我以前必须解决同样的问题，我用这个正则表达式做到了：

```
Regex badAmpersand = new Regex("&(?![a-zA-Z]{2,6};|#[0-9]{2,4};)"); 
```

将它与这样定义的字符串常量结合起来：

```
const string goodAmpersand = "&amp;"; 
```

现在你可以说`badAmpersand.Replace(<your input>, goodAmpersand);`

请注意，简单`String.Replace("&", "&amp;")`是不够的，因为您无法提前知道给定文档的任何 & 字符是否会被正确、错误地编码，甚至两者都在同一个文档中。

这里需要注意的是，您必须在将 xml 文档加载到解析器*之前*对其执行此操作，这可能意味着需要额外通过它。此外，它不考虑 CDATA 部分内的 & 符号。最后，*它只*捕获 & 符号，而不捕获其他非法字符，如 <。 **更新：**根据评论，我还需要更新十六进制编码 (&#x...;) 实体的表达式。

关于哪些字符会引起问题，实际规则有点复杂。例如，数据中允许使用某些字符，但不能作为元素名称的第一个字母。并且没有简单的非法字符列表。相反，一大片（不连续的） UNICODE 被[定义为合法](http://www.w3.org/TR/REC-xml#charsets)的，除此之外的任何东西都是非法的。

因此，归根结底，您必须相信您的文档来源至少具有一定程度的合规性和一致性。例如，我发现人们通常足够聪明，可以确保标签正常工作并转义 <，即使他们不知道 & 是不允许的，因此你今天遇到了问题。但是，**最好的办法是从源头上解决这个问题。**

哦，还有关于 CDATA 建议的说明：我会用它来确保*我正在创建*的 xml 格式正确，但是在从外部处理现有 xml 时，我发现 regex 方法更容易。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T14:54:49.863

Web 应用程序没有问题，XML 文档有问题。XML 中的 & 符号应编码为`&amp;`. 不这样做是语法错误。

**编辑：**在回答后续问题时，是的，有各种类似的错误。例如，不平衡的标签、未编码的小于号、未引用的属性值、字符编码之外的八位字节和各种 Unicode 异常、无法识别的实体引用等等。为了让任何体面的 XML 解析器使用文档，该文档必须是格式良好的。XML 规范要求解析器遇到格式错误的文档时会引发致命错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T15:18:58.823

其他答案都是正确的，我同意他们的建议，但让我补充一点：

请不要让应用程序使用非格式良好的 XML，它只会让我们的余生更加困难 :)。

诚然，有时候如果你无法控制另一端，你真的别无选择，但你真的应该让它抛出一个致命错误，并大声而明确地抱怨发生此类事件时发生了什么问题.

您可能会更进一步说“Ack！这个 XML 在这些地方被破坏了，由于这些原因，我尝试修复它以使其格式正确：...”。

我对 MSXML API 并不太熟悉，但大多数优秀的 XML 解析器都允许您安装错误处理程序，以便您可以捕获出现错误的确切行/列号以及获取错误代码和消息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-23T20:52:56.260

您的数据库不包含 XML 文档。它包含一些格式良好的 XML 文档和一些在人类看来类似于 XML 的字符串。

如果可能的话，您应该解决这个问题 - 特别是，您应该修复生成格式错误的 XML 文档的任何进程。修复从该数据库中读取数据的程序只是将墙纸放在墙上的裂缝上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-23T14:53:24.517

您可以将 & 替换为`&amp;`

或者您也可以使用[CDATA](http://en.wikipedia.org/wiki/CDATA)部分。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-23T14:57:36.707

有几个字符会导致 XML 数据被报告为格式错误。

来自[w3schools](http://www.w3schools.com/XML/xml_cdata.asp)：

> “<”和“&”之类的字符在 XML 元素中是非法的。

对于您不能相信符合 XML 的输入的最佳解决方案是将其包装在 CDATA 标记中，例如

```
<![CDATA[This is my wonderful & great user text]]> 
```

解析器会忽略`<![CDATA[`and标记中的所有内容。`]]>`

# mercurial - 如何将 bitbucket 存储库与托管的 FogBugz 按需版本集成？

> ID：121521
> 
> 赞同：9
> 
> 时间：2008-09-23T14:51:08.657
> 
> 标签：mercurial, dvcs, fogbugz, tortoisehg, bitbucket

我使用 FogBugz 的按需（托管）版本。我想开始使用 Mercurial 进行源代码控制。我想集成 FogBugz 和 BitBucket 存储库。我试了一下，但事情进展并不顺利。

FogBugz 要求您将 Mercurial 客户端连接到 fogbugz.py python 脚本。TortoiseHg 似乎没有他们在说明中引用的 hgext 目录。

那么有没有人成功地做过类似的事情？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-04T14:28:11.860

验尸：

Bitbucket 现在有原生的fogbugz 支持，以及其他回发服务。

[http://www.bitbucket.org/help/service-integration/](http://www.bitbucket.org/help/service-integration/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T19:43:23.243

从它的声音来看，您想在本地机器上运行钩子。钩子和方向旨在用于中央服务器。

如果您是唯一一个在您的存储库中工作的人，或者不介意在您进行拉取之后提交不会出现在 FB 中，那么您可以在本地将钩子添加到您的主克隆，如果您使用的是主克隆，那么您需要做一些与他们在这里所说的略有不同的事情：http: [//bugs.movabletype.org/help/topics/sourcecontrol/setup/Mercurial.html](http://bugs.movabletype.org/help/topics/sourcecontrol/setup/Mercurial.html)

您可以将您的 fogbugz.py 放在任何您想要的位置，只需在该存储库 hgrc 文件的 [fogbugz] 部分添加一个路径行：

```
[fogbugz]
path=C:\Program Files\TortoiseHg\scripts\fogbugz.py 
```

只要确保你已经安装了 python。您可能还希望添加一个提交挂钩，以便对存储库的本地提交也进入 FB。

```
[hooks]
commit=python:hgext.fogbugz.hook
incoming=python:hgext.fogbugz.hook 
```

在 Fogbugz 安装中，您需要更改将以下内容放入您的日志 URL：

```
^REPO/log/^R2/^FILE 
```

以及您的差异网址的以下内容：

```
^REPO/diff/^R2/^FILE 
```

当挂钩脚本运行时，它会连接到您的 FB 安装并向其发送一些参数。这些参数存储在数据库中，用于生成差异和日志信息的 url。该脚本发送 repo 的 url，这是在 [web] 部分的 baseurl 设置中。您希望此 url 成为您的 bitbucket 存储库的 url。这将用于替换上面 url 模板中的**^REPO**。挂钩脚本还将修订 ID 和文件名传递给 FB。这些将替换 ^R2 和 ^FILE。所以总而言之，这是您要添加到 .hg 目录中的 hgrc 文件中的内容：

```
[extensions]
hgext.fogbugz=

[fogbugz]
path=C:\Program Files\TortoiseHg\scripts\fogbugz.py
host=https://<YOURACCOUNT>.fogbugz.com/
script=cvsSubmit.asp

[hooks]
commit=python:hgext.fogbugz.hook
incoming=python:hgext.fogbugz.hook

[web]
baseurl=http://www.bitbucket.org/<YOURBITBUCKETACCOUNT>/<YOURPROJECT>/ 
```

要记住的一件事是，在您实际将这些更改推送到 bitbucket 之前，FB 可能会收到签入通知。如果这是原因，请推动，一切都会奏效。

编辑：添加了关于 FB 服务器和摘要的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-22T21:28:47.980

提醒一下：Fog Creek 发布了[Kiln](http://kilnhg.com)，它提供了与 FogBugz 紧密集成的 Mercurial 托管，并且不需要任何配置。

我通常不会在 Stack Overflow 上“做广告”（免责声明：我是 Kiln 开发人员之一），但我觉得这直接回答了最初的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-25T22:32:47.753

可以将您的 GIT BitBucket 存储库与 FogBugz 问题跟踪器集成，但不幸的是它没有正确记录。

您必须按照[https://confluence.atlassian.com/display/BITBUCKET/FogBugz+Service+Management](https://confluence.atlassian.com/display/BITBUCKET/FogBugz+Service+Management)中描述的步骤进行操作，但请注意

1.  在 CVSSubmit URL 中，您需要输入没有“?ixBug=bugID&sFile=file&sPrev=x&sNew=y&ixRepository=”参数的 url。

    它应该只是“https://your_repo.fogbugz.com/cvsSubmit.asp”

2.  您需要在 git 提交消息中提及您的 FogBugz 案例 ID，方法是在其中放入“BugzID：ID”字符串（这在任何地方都没有记录：-（），类似于：

    git commit -m "这是一个解决案例 BugzID: 42 的极好的提交"

当然，提交信息将在您将提交推送到 BitBucket 服务器之后发送到 FogBugz，而不是在您进行本地提交之后。

# php - PHP：使用 Pecl/Pear，还是构建我自己的系统？

> ID：121525
> 
> 赞同：0
> 
> 时间：2008-09-23T14:53:03.487
> 
> 标签：php, pear, pecl

在构建我的一些 PHP 应用程序时，可以使用 PEAR/PECL 模块对很多功能进行编码，但是，有些使用它的人可能无法安装东西，这让我很困惑。

我是否应该放弃一些用户使用 PEAR/PECL 来实现功能，这些功能将使我能够比我编写自己的功能更快地编写系统代码，但意味着它将排除某些人使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T15:02:27.303

通过使用 pear 库进行开发来节省开发时间，并提供捆绑在您分发的内容中的库（尽管您必须确保它符合许可要求）

我不会依赖安装的某些 PECL 扩展，除非你正在做一些特别相关的事情（比如 XDebug 网络前端或其他东西），大多数安装将携带一组相当普通的扩展。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T15:09:14.057

这部分取决于你有多少时间，以及项目的目的。如果您只是想制作一些有用的东西，请使用 PEAR/PECL。如果您正在努力学习成为一名更好的程序员，并且您有时间，那么我建议您努力编写自己的版本。一旦您了解了您要替换的任何内容的内部结构，您可能想要切换到 PEAR/PECL 版本，这样您就不会浪费时间重新实现已经实现的内容......

...但另一方面，预先存在的工具并不总是能完全满足您的需求，有时会产生对您没有任何好处的开销。这就是 Unix 命令行工具如此之小且用途狭窄的原因。没有人真正需要一个版本的“ls”，除了“ls”目前可以做的事情之外，它还可以做任何事情。任何 PEAR 库的版本都将由您编写，完全符合您的需要。这需要仔细考虑...

...但是在紧握的手上，不要花太多时间去想它。花五分钟，做出决定，然后开始编码。即使你做出了错误的决定，你至少也会得到更多的编码练习。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T14:55:06.090

我的建议是先假设 PEAR/PECL 模块，然后完成其余代码。然后，一旦您的大部分代码按照您想要的方式工作，您就可以评估返回并用您自己的代码逐段替换外部代码。另外，到那时您将更好地了解使用这些对您的用户群的影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T14:55:18.320

最初使用 PEAR/PECL 对其进行编码，如果您让人们要求使用非 PEAR/PECL 版本，请开始编写您自己的替代方案，然后为这样的版本编写代码。

有了这个，最初的开发会更快，你可能会发现一旦你开始发布应用程序就没有人关心需要 3rd 方库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T15:20:42.143

使用 PEAR，但允许在项目中包含 PEAR 包。[所有 PEAR 包都可以从http://pear.php.net/](http://pear.php.net/)单独下载，并且可以放在任何地方。根据便利性和许可问题，您可以将所有必需的 PEAR 文件打包到您的项目中，或者告诉用户如何下载和“安装”它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T14:57:07.410

我最常做的是永远不会使用全局安装在服务器上的 PEAR。版本可以更改并影响您的应用程序。相反，我有一个配置文件（在我的情况下为 XML），其中列出了所有所需的包及其版本。安装程序连接到我的个人 FTP 存储库并在 $PROJECTBASE/lib/pear/ 本地下载和安装所有 PEAR 包。并且 PEAR 在本地而不是全局运行。您可能需要考虑的事情。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T14:59:33.317

使用 PEAR 没有问题，如果用户没有对其 web 服务器的 root 访问权限，他们可以简单地从 pear.php.net 下载 PHP 文件并将其添加到他们的包含路径。PECL 的工作有点棘手，因为没有 root 访问权限通常无法安装新模块。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T15:04:06.583

您需要注意，因为 pear 中的许多模块质量确实很低。

有些很棒，不要误会我的意思，但不要认为梨中的任何东西，由于是梨，具有任何特定的品质。这意味着在决定使用 pear 模块之前，您至少需要浏览它的源代码，对于足够简单的任务，这可能比不使用 pear 需要更多时间。

然而，pecl 是不同的。扩展往往会得到更好的审查和测试，否则它们会使 php 崩溃。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-18T19:34:07.143

重申已经说过的大部分内容：http: [//www.codinghorror.com/blog/archives/001145.html](http://www.codinghorror.com/blog/archives/001145.html)

# ruby-on-rails - Rails 缓存日志级别

> ID：121546
> 
> 赞同：6
> 
> 时间：2008-09-23T14:55:15.667
> 
> 标签：ruby-on-rails, logging

使用 Rails 2.1 中的新缓存选项，我在日志中得到了很好的整体信息

`Cached fragment hit: views/homepage (0.16549)`

但是，它们记录在`:debug`与 SQL 输出相同的级别。我希望能够禁用 SQL 输出，并且仍然可以看到缓存信息。我怎样才能做到这一点

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-23T15:45:52.190

好吧，您可以为 ActiveRecord 实例化一个特定的记录器，并将其日志级别设置为 :info，同时将默认记录器保留在调试...

```
ActiveRecord::Base.logger = Logger.new("#{RAILS_ROOT}/log/#{RAILS_ENV}_database.log")
ActiveRecord::Base.logger.level = Logger::INFO # should set the log_level to info for you 
```

来自[http://wiki.rubyonrails.org/rails/pages/HowtoConfigureLogging](http://wiki.rubyonrails.org/rails/pages/HowtoConfigureLogging)

或者你可以重新打开 AbstractAdapter 并覆盖 log(sql,name) 方法所以它什么都不做

[http://api.rubyonrails.com/classes/ActiveRecord/ConnectionAdapters/AbstractAdapter.html#M001242](http://api.rubyonrails.com/classes/ActiveRecord/ConnectionAdapters/AbstractAdapter.html#M001242)

# asp.net - 来自 asp.net 应用程序的奇怪未处理异常 - 视图状态 MAC 验证失败

> ID：121579
> 
> 赞同：11
> 
> 时间：2008-09-23T15:02:28.693
> 
> 标签：asp.net, exception

我不知道是否有人以前见过这个问题，但我只是被难住了。这是我的错误页面正在捕获的未处理异常消息。

> 错误消息：视图状态 MAC 验证失败。如果此应用程序由 Web Farm 或集群托管，请确保配置指定相同的 validationKey 和验证算法。AutoGenerate 不能在集群中使用。
> 
> 堆栈跟踪：在 System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) 在 System.Web.UI.ObjectStateFormatter.System 的 System.Web.UI.ViewStateException.ThrowError(Exception inner, String persistedState, String errorPageMes​​sage, Boolean macValidationError) .Web.UI.IStateFormatter.Deserialize(String serializedState) 在 System.Web.UI.Util.DeserializeWithAssert(IStateFormatter formatter, String serializedState) 在 System.Web.UI.HiddenFieldPageStatePersister.Load() 在 System.Web.UI.Page。 LoadPageStateFromPersistenceMedium() at System.Web.UI.Page.LoadAllState() at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint,布尔值 includeStagesAfterAsyncPoint) 在 System.Web.UI.Page.ProcessRequestWithNoAssert (HttpContext context) 在 System.Web.UI.Page.ProcessRequest() 在 System.Web.UI.Page.ProcessRequest(HttpContext context) 在 ASP.generic_aspx.ProcessRequest( HttpContext 上下文）在 System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 在 System.Web.HttpApplication.ExecuteStep（IExecutionStep 步骤，布尔和完成同步）HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
> 
> 来源：System.Web

有人对我如何解决这个问题有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-23T15:04:16.503

我似乎记得如果您在页面完全加载之前单击按钮/链接等，可能会发生此错误。

如果是这种情况，则错误是由称为事件验证的 ASP.net 2.0 功能引起的。这是一项安全功能，可确保回发操作仅来自服务器允许和创建的事件，以帮助防止欺骗性回发。此功能是通过让控件在渲染时注册有效事件来实现的（如在其实际的 Render() 方法期间）。最终结果是，在您呈现的表单标签的底部，您会看到如下内容：

```
<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION"  value="AEBnx7v.........tS" /> 
```

当回发发生时，ASP.net 使用存储在此隐藏字段中的值来确保您单击的按钮调用有效事件。如果它无效，你会得到你一直看到的异常。

当您在 EventValidation 字段呈现之前回发时，您看到的问题就会发生。如果启用了 EventValidation（默认情况下启用），但 ASP.net 在您回发时看不到隐藏字段，您也会遇到异常。如果您在表单完全呈现之前提交表单，则可能 EventValidation 字段尚未呈现，因此 ASP.net 无法验证您的点击。

一种解决方法当然是禁用事件验证，但您必须了解安全隐患。或者，在表单完成渲染之前永远不要回发。当然，这很难告诉您的用户，但也许您可以在表单呈现之前禁用 UI？

来自[http://forums.asp.net/p/955145/1173230.aspx](http://forums.asp.net/p/955145/1173230.aspx)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-23T15:34:10.863

[@克里斯](https://stackoverflow.com/questions/121579/im-getting-a-strange-unhandled-exception-from-my-aspnet-application-validation#121583)

如果问题是在页面完全呈现之前单击一个项目，asp.net 3.5 SP1 在[页面元素上添加了一个名为 renderAllHiddenFieldsAtTopOfForm](http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.renderallhiddenfieldsattopofform.aspx)的 web.config 条目。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T15:05:41.710

您是否有多个服务器运行此应用程序和/或有一个网络花园？如果是，您将不得不在 web.config中设置[机器密钥](http://msdn.microsoft.com/en-us/library/ms998288.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T16:23:18.590

默认情况下，ASP.NET 在页面中包含 ViewState 值的数字签名。它使用保存在内存中的自动生成的密钥来执行此操作。这样做是为了防止恶意用户从浏览器更改 ViewState，例如，授予他/她自己访问他们通常无法访问的内容的权限。

ASP.NET 也可以选择性地加密 ViewState，但出于性能原因默认情况下它是关闭的。在许多网站中，确保 ViewState 的内容不被“混淆”比对其保密要重要得多。

错误消息说签名验证失败。该页面使用 ViewState 发布，但 ViewState 签名与使用服务器持有的密钥计算的签名不匹配。

此错误的最常见原因是您在类似农场的环境中使用了两台或多台 Web 服务器：一台服务器发送原始页面，并使用该服务器上的内存中的密钥进行签名，但该页面被发送回第二台服务器（或第三个......）服务器。因为两个或多个服务器不共享签名密钥，所以签名不匹配。

> ...如果此应用程序由 Web Farm 或集群托管，请确保配置指定相同的**validationKey**和验证算法。AutoGenerate 不能在集群中使用。

错误消息告诉您的是使用 web.config 中的**validationKey**属性（[请参阅 MSDN](http://msdn.microsoft.com/en-us/library/w8h3skw9(VS.71).aspx)中的详细信息）将签名密钥硬编码为所有服务器共享的值，而不是使用动态生成的值。这样，签名验证可以独立于哪个服务器接收回发而成功。

您*可以*关闭验证，但这样做非常危险。这意味着任何有一点空闲时间的黑客都可以在您的应用程序中伪造值。例如，如果您将商品的价格保持在 ViewState 值中，黑客可以在下订单之前将浏览器中的值更改为 0.01 美元。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-26T18:11:56.173

对于其他最终在此问题上苦苦挣扎的人，这里是一些解决方法的有用链接：

[http://blogs.msdn.com/tom/archive/2008/03/14/validation-of-viewstate-mac-failed-error.aspx](http://blogs.msdn.com/tom/archive/2008/03/14/validation-of-viewstate-mac-failed-error.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T15:14:32.127

我知道您可以禁用视图状态 MAC 的验证，但我认为如果页面未加载，您可能会遇到更多麻烦。当我遇到这个问题时，我不得不禁用所有按钮，直到页面完全加载。

# sql - 给定另一个日期，创建一个日期的最简单方法是该月的第一天

> ID：121581
> 
> 赞同：10
> 
> 时间：2008-09-23T15:03:55.723
> 
> 标签：sql, sql-server, datetime, date

在 SQL Server 中，根据另一个日期时间制作表示本月第一天的日期时间的最简单/最干净的方法是什么？例如，我有一个 2005 年 3 月 3 日 14:23 的变量或列，我想获得 2005 年 3 月 1 日 00:00（作为日期时间，而不是 varchar）

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-23T15:06:55.263

```
Select DateAdd(Month, DateDiff(Month, 0, GetDate()), 0) 
```

要在列上运行此操作，请将 GetDate() 替换为您的列名。

这段代码的诀窍在于 DateDiff。DateDiff 返回一个整数。第二个参数（0）表示 SQL Server 中的 0 日期，即 1900 年 1 月 1 日。因此，datediff 计算自 1900 年 1 月 1 日以来的整数月数，然后将该月数添加到 1900 年 1 月 1 日。净效果是删除日期时间值的日期（和时间）部分。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-23T15:05:57.857

```
SELECT DATEADD(mm, DATEDIFF(mm, 0, @date), 0) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T15:09:26.320

像这样的东西会起作用....

```
UPDATE YOUR_TABLE
SET NewColumn = DATEADD(day, (DATEPART(day, OldColumn) -1)*-1, OldColumn) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-05T15:15:33.650

只需使用

```
DATEADD(DAY, 1-DAY(@date), @date) 
```

# windows-xp - 检测 Windows 是否已准备好下载/安装 Windows 更新的最佳方法？

> ID：121585
> 
> 赞同：3
> 
> 时间：2008-09-23T15:04:25.020
> 
> 标签：windows-xp, windows-update

我对 Windows 2000/XP 特别感兴趣，但 Vista/7 也会很有趣（如果不同的话）。

我正在考虑每天安排批处理文件或等效文件的任务。

编辑：对不起，我应该提供更多信息。这个问题与我手动应用更新的 10 台机器有关。我不想以编程方式安装更新，而只是使用批处理或脚本找出是否有准备好下载/安装的更新（即系统托盘中的更新盾牌图标表明这一点）。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T12:43:08.280

你可以使用`WUApiLib`：

```
UpdateSessionClass session = new UpdateSessionClass();

IUpdateSearcher search = session.CreateUpdateSearcher();

ISearchResult result = search.Search("IsInstalled=0 and IsPresent=0 and Type='Software'");

int numberOfUpdates = result.Updates.Count - 1;

Log.Debug("Found " + numberOfUpdates.ToString() + " updates");

UpdateCollection updateCollection = new UpdateCollection();

for (int i = 0; i < numberOfUpdates; i++)
{
    IUpdate update = result.Updates[i];

    if (update.EulaAccepted == false)
    {
        update.AcceptEula();
    }

    updateCollection.Add(update);
}

if (numberOfUpdates > 0)
{
    UpdateCollection downloadCollection = new UpdateCollection();

    for (int i = 0; i < updateCollection.Count; i++)
    {
        downloadCollection.Add(updateCollection[i]);
    }

    UpdateDownloader downloader = session.CreateUpdateDownloader();

    downloader.Updates =  downloadCollection;

    IDownloadResult dlResult = downloader.Download();

    if (dlResult.ResultCode == OperationResultCode.orcSucceeded)
    {
        for (int i = 0; i < downloadCollection.Count; i++)
        {
            Log.Debug(string.Format("Downloaded {0} with a result of {1}", downloadCollection[i].Title, dlResult.GetUpdateResult(i).ResultCode));
        }

        UpdateCollection installCollection = new UpdateCollection();

        for (int i = 0; i < updateCollection.Count; i++)
        {
            if (downloadCollection[i].IsDownloaded)
            {
                installCollection.Add(downloadCollection[i]);
            }
        }

        UpdateInstaller installer = session.CreateUpdateInstaller() as UpdateInstaller;

        installer.Updates = installCollection;

        IInstallationResult iresult = installer.Install();

        if (iresult.ResultCode == OperationResultCode.orcSucceeded)
        {
            updated = installCollection.Count.ToString() + " updates installed";

            for (int i = 0; i < installCollection.Count; i++)
            {
                Log.Debug(string.Format("Installed {0} with a result of {1}", installCollection[i].Title, iresult.GetUpdateResult(i).ResultCode));
            }

            if (iresult.RebootRequired == true)
            {
                ManagementClass mcWin32 = new ManagementClass("Win32_OperatingSystem");

                foreach (ManagementObject shutdown in mcWin32.GetInstances())
                {
                    shutdown.Scope.Options.EnablePrivileges = true;
                    shutdown.InvokeMethod("Reboot", null);
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T15:05:40.370

[Windows SUS](http://technet.microsoft.com/en-us/wsus/default.aspx)适用于网络上的多台机器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T15:12:01.460

“最简单”的判断方法是将 Windows 更新设置为每晚发生并下载更新（如果有），然后将更新盾牌图标放在系统托盘中。只需看一眼托盘即可查看图标是否存在。

您还可以将 Windows 设置为每晚检查更新，然后在指定时间下载并安装它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T15:14:20.630

关于 mdsindzeleta 所说的 - 以编程方式进行此操作可能不是最佳解决方案。我会使用 Windows XP 内置的功能来下载和安装更新。我假设 Vista 具有类似的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T02:59:24.867

我相信 Windows 更新是使用 BITS 服务下载的。您可以使用 Windows 支持工具中的 Bitsadmin.exe。您可以从命令行运行 bitsadmin.exe /list 并查看 BITS 作业的状态。（即下载进度、作业名称、作业状态）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-22T13:56:19.743

最后，[Windows SUS](http://technet.microsoft.com/en-us/wsus/default.aspx)不是一个选项，所以我在批处理文件中使用以下内容以及[ActiveState ActivePerl](http://www.activestate.com/activeperl/)（推荐）：

perl -nle "打印 $_ 如果检测到 m/更新/i" < c:\Windows\WindowsUpdate.log

这可能是粗糙或肮脏的，并且将来可能会损坏，但它目前可以满足我的需求。

感谢所有的想法。

# database - CouchDB 备份和克隆数据库

> ID：121599
> 
> 赞同：39
> 
> 时间：2008-09-23T15:06:33.423
> 
> 标签：database, couchdb, backup, administration

我们正在寻找 CouchdDB 的 CMS 应用程序。围绕备份我们的生产数据库有哪些常见模式、最佳实践和工作流程建议？

我对克隆数据库以用于开发和测试的过程特别感兴趣。

仅从实时运行的实例下复制磁盘上的文件就足够了吗？您可以在两个实时运行的实例之间克隆数据库数据吗？

非常感谢您对您使用的技术的建议和描述。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-23T17:33:44.040

要注意的另一件事是，您可以从实时数据库中复制文件。鉴于您可能有一个可能很大的数据库，您可以将其 OOB 从您的测试/生产机器复制到另一台机器。

根据机器的写入负载，建议在复制后触发复制以收集复制文件时正在进行的任何写入。但是复制一些记录仍然比复制整个数据库要快。

参考见：[http ://wiki.apache.org/couchdb/FilesystemBackups](http://wiki.apache.org/couchdb/FilesystemBackups)

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-09-23T15:13:29.337

CouchDB 支持复制，因此只需复制到另一个 CouchDB 实例并从那里备份，避免干扰您将更改写入的位置。

[https://docs.couchdb.org/en/latest/maintenance/backups.html](https://docs.couchdb.org/en/latest/maintenance/backups.html)

你真的向你的 CouchDB 实例发送一个 POST 请求，告诉它复制到哪里，它可以工作（tm）

编辑：只要您可以接受 I/O 命中，您就可以从正在运行的数据库下 cp 出数据目录中的 .couch 文件。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-24T11:18:44.290

我想支持 Paul 的建议：`cp`如果您可以承受 I/O 负载的冲击，只需从实时服务器下获取您的数据库文件即可。如果您仍然运行复制副本，您也可以安全地从中复制，而不会影响您的主服务器的性能。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-27T20:41:27.063

CouchDB 还可以很好地处理现代文件系统（如[ZFS](https://en.wikipedia.org/wiki/ZFS) ）提供的文件系统快照。由于数据库文件始终处于一致状态，您可以随时获取文件的快照，而不会削弱 CouchDB 提供的完整性保证。

这导致几乎没有 I/O 开销。如果您不小心从数据库中删除了一个文档，您可以将快照移动到另一台机器并在那里提取丢失的数据。您甚至可以复制回生产数据库，但我从未尝试过。

但始终确保在移动数据库文件时使用完全相同的 couchdb 修订版。磁盘格式仍在以不兼容的方式发展。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-26T04:02:56.003

CouchDB 复制是可怕的。我通常会做[tar](http://en.wikipedia.org/wiki/Tar_%28computing%29)，这要好得多。

1.  停止源主机上的 CouchDB 服务
2.  tar.gz 数据文件。
3.  在我的 Ubuntu 服务器上，这通常位于 /var/lib/couchdb 中（有时位于基于 Couch 版本的子目录中）。如果您不确定这些文件在哪里，您可以在您的 CouchDb 配置文件中找到路径，或者通常通过执行 ps -A w 查看启动 CouchDb 的完整命令。`.`确保获得以存档文件开头的子目录。
4.  重新启动源主机上的 couchdb 服务。
5.  `scp`tar.gz 文件到目标主机并将它们解压缩到那里的临时位置。
6.  `chown`文件到目标数据库目录中已经拥有文件的用户和组。这可能是 couchdb:couchdb。这很重要，因为弄乱文件权限是迄今为止我设法弄乱这个过程的唯一方法。
7.  在目标主机上停止 CouchDB。
8.  `cp`文件到目标目录。在我的主机上，这又是 /var/lib/couchdb。
9.  仔细检查他们新家中的文件权限。
10.  在目标主机上重新启动 CouchDB。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-28T15:08:27.020

我通过 powershell 和**PSCouchDB**模块使用命令[Export-CouchDBDatabase 来完成](https://pscouchdb.readthedocs.io/en/latest/databases.html#export-and-import-databases)。

这会将整个数据库导出到一个 json 文件，您可以通过 import 命令重新导入该文件（请参阅链接）。

前任。

```
Export-CouchDBDatabase -Database test -Authorization "admin:password" 
```

这会在当前目录中导出一个 json 文件：`test_05-28-2021_17_01_00.json`

# java - 如何减少 JSF 中的 javax.faces.ViewState

> ID：121605
> 
> 赞同：17
> 
> 时间：2008-09-23T15:07:19.693
> 
> 标签：java, optimization, jsf, viewstate, bandwidth

减少 JSF 中视图状态隐藏字段大小的最佳方法是什么？我注意到我的视图状态大约是 40k，这会在每个请求和响应（尤其是到达服务器）时下降到客户端并返回到服务器，这对用户来说是一个显着的减慢。

我的环境 JSF 1.2、MyFaces、Tomcat、Tomahawk、RichFaces

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-04T19:14:29.277

您是否尝试将状态保存设置为服务器？这应该只向客户端发送一个 id，并在服务器上保持完整状态。只需将以下内容添加到文件*web.xml*中：

```
 <context-param>
  <param-name>javax.faces.STATE_SAVING_METHOD</param-name>
  <param-value>server</param-value>
 </context-param> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-23T15:11:21.527

如果您使用的是 MyFaces，您可以尝试此设置以在发送到客户端之前压缩视图状态。

```
<context-param>
    <param-name>org.apache.myfaces.COMPRESS_STATE_IN_CLIENT</param-name>
    <param-value>true</param-value>
</context-param> ` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T23:51:08.797

一种选择是在客户端完全保存视图状态，但您可能会遇到一些问题，例如无法序列化对象。您可能想根据您的要求尝试使用不同的压缩算法/实用程序，但由于浏览器默认已经使用 GZip，我不确定您可以获得多少。

# silverlight - 使用 Silverlight 进行数据绑定

> ID：121606
> 
> 赞同：4
> 
> 时间：2008-09-23T15:07:51.300
> 
> 标签：silverlight

如果我想将集合绑定到 Silverlight 中某种形式的列表控件。这样做的唯一方法是使集合中的基础对象实现 INotifyPropertyChanged 并使集合成为 Observablecollection？

如果我使用某种第三方对象，例如由 Web 服务返回的对象，我必须将其包装或映射到实现 INotifyPropertyChanged 的​​东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T15:30:50.997

不，一旦您在 Visual Studio 中添加了对 silverlight 项目的服务引用，您可以右键单击它并对其进行配置，使其使用 ObservableCollection（无论如何这是默认设置）

此外，默认情况下，服务引用将确保服务返回的类型已实现 INotifyPropertyChanged。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T15:14:11.143

您可以将列表绑定到任何 IEnumerable 集合或将简单控件绑定到任何对象属性。不利的一面是，如果将项目添加到列表或更改了属性，您将不会收到任何更改通知。因此，这是否存在问题取决于您的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:58:12.613

正如 Maurice 所说，您可以绑定到任何集合（甚至 IEnumerable）并且绑定将起作用，但您不会收到更改通知。但是请注意，您不需要使用 ObservableCollection，任何实现 INotifyCollectionChanged 的​​东西都可以工作（尽管 ObservableCollection 是最简单的）。

集合中的对象没有必要实现 INotifyPropertyChanged，但如果他们这样做了，那么您将收到有关每个单独更改的通知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T15:48:58.507

需要明确的是，您可以**OneTime**绑定到任何对象。如果您想要**OneWay**或**TwoWay**绑定，您将需要一个对象支持这些接口之一。如前所述，为通过 web 服务交付的对象创建服务引用会为您执行此操作。但是，如果由于某种原因，您仍然需要从旧类生成 Bindable 对象，则可以实现一个实现 IValueConverter 的转换器，然后使用它将旧对象“包装”在一个 Bindable 中：

```
<UserControl>
    <UserControl.Resources>
        <local:FooToBindableFooConverter x:Key="BindableFooConverter"/>
    </UserControl.Resources>
    <TextBlock Text="{Binding FooInstance, Converter={StaticResource BindableFooConverter}}"/>

</UserControl> 
```

转换器非常强大，可以解决很多“我需要 X 但我有 Y”的问题。

# iphone - 如何为 UIButton 着色？

> ID：121615
> 
> 赞同：7
> 
> 时间：2008-09-23T15:09:51.733
> 
> 标签：iphone

我正在向我的 iPhone UI 添加自定义按钮，并希望使它们具有 Apple 应用程序的玻璃外观。我有一个很好的默认玻璃图像，但我不想为我想要的每种色调（红色、绿色、蓝色等）都有一个单独的图像。

有没有办法加载灰度 PNG 并将其调整为我想要的颜色？更好的是，有没有一种方法可以让 Apple 看起来像玻璃一样，而无需加载自定义图像？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-02-11T16:16:11.323

有点晚了，但如果像我这样的人搜索这种信息：使用 a`UISegmentedControl`和单个按钮，将其设置为`momentary`，然后将其设置为`tintColor`. 这样，您无需准备与颜色一样多的 PNG，框架会为您处理所有渲染。

例子：

```
UISegmentedControl *cancelButton = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObject:@"Cancel"]];
[cancelButton setSegmentedControlStyle:UISegmentedControlStyleBar];
[cancelButton setTintColor:[UIColor colorWithRed:0.8 green:0.3 blue:0.3 alpha:1.0]];
[cancelButton setMomentary:YES];
[cancelButton addTarget:self action:@selector(didTapCancel:) forControlEvents:UIControlEventValueChanged];
[self addSubview:cancelButton];
[cancelButton release]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-29T10:52:43.533

在一直很出色的“Cocoa With Love”网站上有一个示例：[在 CoreGraphic 中绘制光泽渐变](http://cocoawithlove.com/2008/09/drawing-gloss-gradients-in-coregraphics.html "在 CoreGraphics 中绘制光泽渐变")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T23:00:00.790

据我所知，没有一种单一的方式，但是您可以通过采用默认灰度图像并将其与纯色合成（即在其上绘制）来获得所需的效果。如果您查看 Core Graphics 文档，您会发现有十几种不同的合成方法（例如，Color Burn），它们的某些组合可能会产生您想要的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T15:17:26.957

我不了解 iPhone UI，但您可以使用单个 PNG 来制作颜色变体图形。

即这些页面上的两个徽标（左上角）：

**[产品](http://47degrees.com/products/)**

**[商店](http://47degrees.com/shops/)**

使用这个**[PNG](http://47degrees.com/images/logos/47_degrees.png)**

[替代文字 http://47degrees.com/images/logos/47_degrees.png](http://47degrees.com/images/logos/47_degrees.png)

我想您可能需要将背景颜色设置为玻璃色。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-08T00:49:34.827

我最终创建了自己的自定义按钮，该按钮与联系人编辑视图中“删除联系人”按钮中使用的渲染非常匹配。

有兴趣的可以在github上找到

[PFTintedButton](https://github.com/appsinyourpants/Pants-Framework/blob/master/Classes/Views/PFTintedButton.m)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-05T04:14:21.403

我已经这样做了，效果很好：

[iOS：将 RGB 滤镜应用于灰度 PNG](https://stackoverflow.com/questions/6683822/ios-applying-a-rgb-filter-to-a-greyscale-png)

但是，它是作弊，它是添加，所以对于（例如）每个像素的红色分量，R_dest = R_src + R_tint

如果您想要细粒度控制，例如，您可能希望通过平均 RGB 分量（具有适当的权重）来提取每个像素的灰度值，然后将该值乘以您的色调，因此生成的颜色将为灰度（Sr ,Sg,Sb) * {Tr,Tg,Tb}

这将需要创建一块内存，创建一个绘制到该块中的位图上下文，将您的图像绘制到该上下文中，复制整个内存块以进行保管，处理 - 从副本中获取数据并修改原始后备存储，然后从原始后备存储中提取图像并释放您分配的所有内容。

[从 RGBA 像素字节数据重构 UIImage 的问题](https://stackoverflow.com/questions/7175786/problem-reconstituting-uiimage-from-rgba-pixel-byte-data)

这个库已经为你做了一切，它不是最有效的方法，但它可以完成工作。iirc 他在应该使用 calloc 时使用 malloc。

# sql - 内连接 vs Where

> ID：121631
> 
> 赞同：280
> 
> 时间：2008-09-23T15:13:28.040
> 
> 标签：sql, performance, oracle

之间的性能（在oracle中）是否存在差异

```
Select * from Table1 T1 
Inner Join Table2 T2 On T1.ID = T2.ID 
```

和

```
Select * from Table1 T1, Table2 T2 
Where T1.ID = T2.ID 
```

?

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2008-12-10T01:25:58.547

不！同样的执行计划，看这两张表：

```
CREATE TABLE table1 (
  id INT,
  name VARCHAR(20)
);

CREATE TABLE table2 (
  id INT,
  name VARCHAR(20)
); 
```

使用内连接的查询执行计划：

```
-- with inner join

EXPLAIN PLAN FOR
SELECT * FROM table1 t1
INNER JOIN table2 t2 ON t1.id = t2.id;

SELECT *
FROM TABLE (DBMS_XPLAN.DISPLAY);

-- 0 select statement
-- 1 hash join (access("T1"."ID"="T2"."ID"))
-- 2 table access full table1
-- 3 table access full table2 
```

以及使用 WHERE 子句的查询的执行计划。

```
-- with where clause

EXPLAIN PLAN FOR
SELECT * FROM table1 t1, table2 t2
WHERE t1.id = t2.id;

SELECT *
FROM TABLE (DBMS_XPLAN.DISPLAY);

-- 0 select statement
-- 1 hash join (access("T1"."ID"="T2"."ID"))
-- 2 table access full table1
-- 3 table access full table2 
```

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2008-09-23T15:15:36.693

如果查询优化器正常工作，那么这些查询之间应该没有区别。它们只是指定相同期望结果的两种方法。

* * *

## 回答 #3

> 赞同：71
> 
> 时间：2008-09-23T15:23:41.933

它们应该完全相同。但是，作为一种编码实践，我宁愿看到 Join。它清楚地表达了你的意图，

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-09-23T17:18:56.680

使用`JOIN`使代码更易于阅读，因为它是不言自明的。

速度没有区别（*我刚刚测试过*），执行计划是一样的。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-08-27T12:01:36.750

[为了加分……]

使用 JOIN 语法可以让您更轻松地注释掉连接，因为它全部包含在一行中。如果您正在调试复杂的查询，这*会*很有用

正如其他人所说，它们在功能上是相同的，但是 JOIN 更清楚地表明了意图。因此，在某些情况下，它*可能*在当前的 oracle 版本中帮助查询优化器（我不知道是否有），它*可能*在未来的 Oracle 版本中帮助查询优化器（没人知道），*或者*如果您更改数据库供应商。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2008-09-23T17:16:48.480

我不了解 Oracle，但我知道旧语法在 SQL Server 中已被弃用，最终会消失。在我在新查询中使用旧语法之前，我会检查 Oracle 计划用它做什么。

我更喜欢较新的语法，而不是将连接条件与其他需要的 where 条件混合。在较新的语法中，创建连接的内容以及正在应用的其他条件更加清晰。在这样的简短查询中并不是一个大问题，但是当您有更复杂的查询时，它会变得更加混乱。由于人们学习基本查询，我倾向于让人们在复杂查询中需要它之前学习使用连接语法。

再说一次，我并不特别了解 Oracle，但我知道旧式左连接的 SQL Server 版本即使在 SQL Server 2000 中也存在缺陷并且给出不一致的结果（有时左连接有时是交叉连接），所以它永远不应该用过的。希望 Oracle 不会遇到同样的问题，但是用旧语法正确表达左连接和右连接肯定会更加困难。

另外，根据我的经验（当然这完全是个人意见，您可能有不同的经验）使用 ANSII 标准联接的开发人员往往对联接是什么以及它在获取方面意味着什么有更好的理解数据库中的数据。我相信这是因为大多数对数据库有很好理解的人倾向于编写更复杂的查询，而且在我看来，使用 ANSII 标准比旧风格更容易维护这些查询。

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2008-09-23T15:40:24.950

它们在逻辑上是相同的，但是在采用 ANSI 语法的早期版本的 Oracle 中，在更复杂的情况下经常会出现错误，因此在使用它时有时会遇到 Oracle 开发人员的阻力。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-12-04T20:04:48.263

性能应该是相同的，但我建议使用连接版本，因为在外连接方面提高了清晰度。

使用连接版本也可以避免无意的笛卡尔积。

第三个效果是使用更简单的 WHERE 条件更易于阅读 SQL。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-06-03T21:55:51.187

不要忘记，在 Oracle 中，如果两个表中的连接键属性名称相同，您也可以这样写：

```
select *
from Table1 inner join Table2 using (ID); 
```

当然，这也有相同的查询计划。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2016-07-01T02:12:28.617

在表处于第 3 范式的情况下，表之间的连接不应更改。即加入客户和付款应始终保持不变。

但是，我们应该区分**连接**和**过滤器**。连接是关于关系的，过滤器是关于分割一个整体的。

一些作者参考了该标准（即 Jim Melton；Alan R. Simon (1993)。了解新 SQL：完整指南。Morgan Kaufmann。第 11-12 页。ISBN 978-1-55860-245-8。） ，写了关于在 FROM 子句中采用 JOIN 语法而不是逗号分隔表的好处。

我完全同意这个观点。

有几种方法可以编写 SQL 并获得相同的结果，但对于许多进行团队合作的人来说，源代码的易读性是一个重要方面，当然，从特定的过滤器中分离表之间的相互关系是澄清源代码的一大飞跃代码。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-09-23T15:22:59.580

在 PostgreSQL 中，绝对没有区别——它们都等同于相同的查询计划。我 99% 确定 Oracle 也是如此。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-23T15:26:05.827

它们都是做同样事情的内连接，一个只是使用较新的 ANSI 语法。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-23T15:29:07.863

从功能上讲，它们与前面所说的相同。我同意虽然加入更适合准确描述您想要做什么。很多时候，我一直以为我知道我想查询某些东西，直到我开始进行连接并意识到我想做一个与我脑海中原来的查询不同的查询。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-27T02:10:58.830

确实，从功能上讲，两个查询都应该以相同的方式处理。但是，经验表明，如果您从使用新连接语法的视图中进行选择，那么使用它来构建您的查询也很重要。如果视图使用“join”语句，Oracle 的优化器可能会感到困惑，但访问视图的查询使用“where”子句中的传统连接方法。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-06-27T08:59:07.503

尽管两个查询的身份似乎很明显，但有时会发生一些奇怪的事情。在 Oracle 10g 中将连接谓词从 JOIN 移动到 WHERE 时，我遇到了具有不同执行计划的查询（因为 WHERE 计划更好），但我无法在简化的表和数据中重现此问题。我认为这取决于我的数据和统计数据。优化器是一个相当复杂的模块，有时它的行为很神奇。

这就是为什么我们一般不能回答这个问题，因为它取决于数据库内部。但我们应该知道答案必须是“*没有差异*”。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-10-28T14:15:47.543

我今天在检查我们的一个 sp 在生产中的超时时遇到了这个难题，将一个从 xml 提要构建的表上的内部连接更改为一个“where”子句......现在平均执行时间是 80 毫秒，超过 1000 次执行，而在平均执行时间为 2.2 秒之前...执行计划的主要区别是密钥查找的消失...在您使用这两种方法进行测试之前您不会知道的消息。

干杯。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-03-03T05:56:49.593

他们都是连接，并且在哪里做同样的事情。

看看[在 MySQL 查询中，为什么使用 join 而不是 where？](https://stackoverflow.com/questions/2241991/in-mysql-queries-why-use-join-instead-of-where)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-08-08T12:45:33.083

正如kiewik所说，执行计划是一样的。

JOIN 语句只是更容易阅读，更容易不忘记 ON 条件并获得笛卡尔积。在使用多个连接类型的长查询中很难检测到这些错误：SELECT * FROM t1, t2 WHERE t1.id=t2.some_field。

如果您只忘记了一个连接条件，那么执行查询的时间会很长，返回的记录太多……真的太多了。有些人使用 DISTINCT 来修补查询，但执行起来仍然很长。

这就是为什么使用 JOIN 语句肯定是最佳实践的原因：更好的可维护性和更好的可读性。

此外，如果我记得很清楚，JOIN 在内存使用方面进行了优化。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-12-19T15:18:49.813

我有一个[很好的答案](https://stackoverflow.com/a/38135956/2188550)：

这就是分别定义为 SQL92 和 SQL89 的内容，尽管您可以省略 INNER 这个词，但它们之间没有性能差异（仅使用 JOIN 就足够清楚了，在最简单的查询中，您可以节省 5 次键盘敲击现在想象一下有多少笔画大那些）。

# php - 托管服务器上的 MVC 框架

> ID：121638
> 
> 赞同：1
> 
> 时间：2008-09-23T15:14:20.753
> 
> 标签：php, model-view-controller, symfony1

这似乎是一个愚蠢的问题，但我想知道如何在托管服务器上使用 MVC 框架。

我正在家里使用 Ubuntu 上的 RoR 进行游戏（尽管速度很慢），并且了解如果我想做一个实时站点，那么我需要使用 Rails 和 Ruby 进行托管。

但是，PHP 框架会发生什么。例如，我在过去看到了关于 CakePHP 的所有内容，但最近我刚刚遇到了[Symfony 项目](http://www.symfony-project.org/tutorial/1_1/my-first-project)，并且在想如果我有一个服务器堆栈设置我可以在家开发，我将如何去部署任何实时的东西。

我如何在实时服务器上使用 php 命令行，以及如何在另一台服务器上安装框架。

目前这一切都是假设性的，因为我只是在考虑它，但这是我过去想到的一个问题。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T15:21:12.517

大多数 MVC 框架*（例如 Kohana、Zend 框架）可以安装在服务器的任何位置。文档根目录中的前端控制器然后指定它在哪里，并从那里加载它。所以基本上，你把框架目录放在某个地方，然后让你的前端控制器加载它。特别是 ZF 和 Kohana 都有快速入门教程来进行此设置。

至于使用PHP命令行......它只是“php”命令。运行“php -v”以查看您拥有的版本。

（*使用前端控制器模式的 MVC 框架意味着您的 Web 服务器的文档树实际上只包含一件事：前端控制器文件。例如，如果您将框架安装在**/home/username/frameworks/Kohana_2.2**，而您的 Apache docroot 是**/home/username/document_root**，那么你就会有**index.php**在那里，它所包含的只是这样的：

```
<?php
require_once("/home/username/frameworks/Kohana_2.2/system/core/Bootstrap.php"); 
```

（会有其他配置的东西，但你去。））

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:18:37.623

并非每个框架都需要通过命令行甚至 php.ini 文件安装或配置。我相信 CodeIgnitor 是这样的——你可以把基本 CI 目录的路径放在路径中，然后就可以了。我确信有关于如何在托管解决方案上使用 symfony 的文档。事实上，[这个文档](http://www.symfony-project.org/book/1_1/03-Running-Symfony)解释了如何在共享主机上使用 symfony。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:21:18.413

是的，我使用 CakePHP 没有使用 cake 命令行的东西。只要主机支持 php4 或 5，你就可以使用了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T15:23:06.333

除了听说部署可能会很痛苦之外，我对 RoR 部署了解不多，但我相信在这方面已经做了一些很好的工作。显然是的，你需要一个带有 RoR 的主机（我个人使用[Dreamhost](http://www.dreamhost.com)）。

PHP 框架通常不需要实际安装，它们只是您在服务器上的网站文件夹中转储的 PHP 文件的集合。您通常必须配置一个 .htaccess 文件以通过单个 index.php 文件路由所有内容，但无论如何您都必须在本地进行。我必须再次承认我从未尝试在服务器上使用 CakePHP，但我之前已经设置了 CodeIgniter，它真的就这么简单。

如果您正在共享托管环境中查看 MonoRail .NET MVC 框架，祝您好运！我以前做过，而且花了我很长时间，更不用说我自己定制的 MonoRail 了。如果您有兴趣，我可以尝试挖掘我的笔记，但您似乎更热衷于 RoR/PHP。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T15:28:46.570

MVC 框架应该独立托管。但当然，它们是用编程语言编码的，所以托管很重要。除此之外是权限问题。需要修改配置文件吗？你需要访问某些目录吗？连接到数据库？当然，就像任何程序一样。但该框架不需要预先安装。

几个月前我确实玩过 CakePHP，它似乎不需要任何特殊的能力。MVC 框架不是编程语言的扩展，所以我看起来很合乎逻辑。

我想给你更多的细节，但我需要知道具体的框架，因为它取决于一个一个的基础。无论如何，如果您需要阅读或修改任何文件，您可以随时尝试询问您的主机。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-02T22:02:06.553

一些主机包含安装在其服务器上的框架，因此您只需上传您的项目。您可以使用“symfony 托管”之类的内容在 google 中查找。

巴勃罗

# c# - 用于删除 XML 标记及其内容的正则表达式

> ID：121656
> 
> 赞同：3
> 
> 时间：2008-09-23T15:17:33.210
> 
> 标签：c#, .net, xml, vb.net, regex

我有以下字符串，我想在不使用 XML 解析器（对于小字符串来说开销太大）的情况下删除`<bpt *>*</bpt>`和`<ept *>*</ept>`（注意其中的附加标记内容也需要删除）。

```
The big <bpt i="1" x="1" type="bold"><b></bpt>black<ept i="1"></b></ept> <bpt i="2" x="2" type="ulined"><u></bpt>cat<ept i="2"></u></ept> sleeps. 
```

VB.NET 或 C# 中的任何正则表达式都可以。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-23T16:01:49.907

如果您只想从字符串中删除所有标签，请使用此（C#）：

```
try {
    yourstring = Regex.Replace(yourstring, "(<[be]pt[^>]+>.+?</[be]pt>)", "");
} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

编辑：

我决定用更好的选择添加到我的解决方案中。如果有嵌入标签，前一个选项将不起作用。这个新的解决方案应该去除所有 <**pt*> 标签，无论是否嵌入。此外，此解决方案使用对原始 [be] 匹配的反向引用，以便找到完全匹配的结束标记。此解决方案还创建了一个可重用的 Regex 对象以提高性能，因此每次迭代都不必重新编译 Regex：

```
bool FoundMatch = false;

try {
    Regex regex = new Regex(@"<([be])pt[^>]+>.+?</\1pt>");
    while(regex.IsMatch(yourstring) ) {
        yourstring = regex.Replace(yourstring, "");
    }
} catch (ArgumentException ex) {
    // Syntax error in the regular expression
} 
```

补充笔记：

在评论中，一位用户表示担心“。” 模式匹配器将是 CPU 密集型的。虽然在独立的贪婪“。”的情况下这是正确的，但使用非贪婪字符“？” 导致正则表达式引擎只向前看，直到找到模式中下一个字符的第一个匹配项而不是贪婪的 '.' 这需要引擎一直向前看到字符串的末尾。我使用[RegexBuddy](http://www.regexbuddy.com/)作为正则表达式开发工具，它包含一个调试器，可让您查看不同正则表达式模式的相对性能。如果需要，它还会自动注释您的正则表达式，因此我决定在此处包含这些注释以解释上面使用的正则表达式：

```
 // <([be])pt[^>]+>.+?</\1pt>
// 
// Match the character "<" literally «<»
// Match the regular expression below and capture its match into backreference number 1 «([be])»
//    Match a single character present in the list "be" «[be]»
// Match the characters "pt" literally «pt»
// Match any character that is not a ">" «[^>]+»
//    Between one and unlimited times, as many times as possible, giving back as needed (greedy) «+»
// Match the character ">" literally «>»
// Match any single character that is not a line break character «.+?»
//    Between one and unlimited times, as few times as possible, expanding as needed (lazy) «+?»
// Match the characters "</" literally «</»
// Match the same text as most recently matched by backreference number 1 «\1»
// Match the characters "pt>" literally «pt>» 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T15:26:42.940

我想你想完全放弃标签？

```
(<bpt .*?>.*?</bpt>)|(<ept .*?>.*?</ept>) 
```

这 ？在 * 之后使它不贪婪，所以它会尝试匹配尽可能少的字符。

您将遇到的一个问题是嵌套标签。stuff 不会看到第二个，因为第一个匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T16:19:42.033

为什么说开销太大？你量过吗？还是你在猜？

使用正则表达式而不是正确的解析器是一种快捷方式，当有人使用 <bpt foo="bar>"> 之类的东西时，您可能会遇到这种情况

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T15:42:26.427

.NET 正则表达式引擎是否支持负前瞻？如果是，那么您可以使用

```
(<([eb])pt[^>]+>((?!</\2pt>).)+</\2pt>) 
```

这让*大黑猫睡着了。*如果删除所有匹配项，则从上面的字符串中删除。`bpt`但是请记住，如果您有嵌套的/`ept`元素，它将不起作用。您可能还想`\s`在某些地方添加以允许在关闭元素等中使用额外的空格。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T20:48:21.963

如果要使用正则表达式删除 XML 元素，最好确保输入的 XML 不使用来自不同名称空间的元素，或者包含您不想修改其内容的 CDATA 部分。

正确（即既高效又正确）的方法是使用 XSLT。将除特定元素之外的所有内容复制到输出的 XSLT 转换是恒等转换的简单扩展。转换编译完成后，它将非常快速地执行。它不会包含任何隐藏的缺陷。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-28T16:04:45.017

是否有任何可能的方法来获得 regex.pattern 的 xml 类型文本的全局解决方案？这样，我将摆脱替换功能，shell 使用正则表达式。麻烦的是分析 < > 是否按顺序排列。还将保留字符替换为 ' & 等等。这里是代码'处理特殊字符函数 Friend Function ReplaceSpecChars(ByVal str As String) As String Dim arrLessThan As New Collection Dim arrGreaterThan As New Collection If Not IsDBNull(str) Then

```
 str = CStr(str)
  If Len(str) > 0 Then
    str = Replace(str, "&", "&amp;")
    str = Replace(str, "'", "&apos;")
    str = Replace(str, """", "&quot;")
    arrLessThan = FindLocationOfChar("<", str)
    arrGreaterThan = FindLocationOfChar(">", str)
    str = ChangeGreaterLess(arrLessThan, arrGreaterThan, str)
    str = Replace(str, Chr(13), "chr(13)")
    str = Replace(str, Chr(10), "chr(10)")
  End If
  Return str
Else
  Return ""
End If 
```

End Function Friend Function ChangeGreaterLess(ByVal lh As Collection, ByVal gr As Collection, ByVal str As String) As String For i As Integer = 0 To lh.Count If CInt(lh.Item(i)) > CInt(gr.Item( i)) 然后 str = Replace(str, "<", "<") /////////problems//// End If

```
 Next

    str = Replace(str, ">", "&gt;") 
```

End Function Friend Function FindLocationOfChar(ByVal chr As Char, ByVal str As String) As Collection Dim arr As New Collection For i As Integer = 1 To str.Length() - 1 If str.ToCharArray(i, 1) = chr Then arr .Add(i) End If Next Return arr End Function

在问题标记处遇到麻烦

这是一个标准的 xml，有不同的标签，我想分析..

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-30T19:24:01.677

你测量过这个吗？我使用 .NET 的正则表达式引擎*遇到*了性能问题，但相比之下，使用 Xml 解析器解析了大约 40GB 的 xml 文件*而没有*问题（但是，对于更大的字符串，您需要使用 XmlReader）。

请发布一个实际的代码示例并提及您的性能要求：`Regex`如果性能很重要，我怀疑这个类是最好的解决方案。

# c# - 在 ASP.NET 中实现用户控制的样式更改

> ID：121662
> 
> 赞同：1
> 
> 时间：2008-09-23T15:18:30.573
> 
> 标签：c#, asp.net, html, .net-3.5

好的，所以我们有客户，这些客户可以自定义他们的网页。我们为他们提供的一个选项是能够使用其中一个六角轮或其他任何东西来更改图形的颜色（它就像一个看起来很框架的条）。

所以，我已经考虑过了，我不知道从哪里开始。我这周要向我的 xhtml 人发送 comps，并且我希望在发送之前至少在我的脑海中完成实施。

System.Drawing 的某些东西听起来很对，但我以前从未使用过它，而且听起来很复杂。有人有想法吗？

**更新：**图像的颜色将发生变化。因此，如果我希望图像 1 为绿色，图像 2 为蓝色，我进入我的管理屏幕并输入这些十六进制值（可能会给他们一个界面），然后当其他人查看他们的页面时，他们会看到他们所做的改变。有点像自定义 facebook 或 myspace 页面（OMFGz soooo Werb 2.0）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T15:22:42.840

究竟会发生什么变化？根据正在发生的变化，您可能能够在 html 背景颜色之上覆盖透明 png。只需更改背景颜色，徽标颜色就会改变。当然，这限制了您可以更改的内容，但是您会惊讶地发现自己可以逃脱多少。

是的，另一种方法是在 Web 服务器上绘制图像。[这是 hanselman 的一篇文章](http://www.hanselman.com/blog/ASPNETFuturesGeneratingDynamicImagesWithHttpHandlersGetsEasier.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T15:25:09.323

**编辑（因为你改变了标题）：**

**如果您在六角轮上只有少量颜色，那么您可以简单地使用 JavaScript 从一些预先制作的图形中更改图像源。**

**如果您有大量或可更改的颜色集供用户选择，那么我将使用 AJAX 调用来使用相关的 ASP 函数生成图形，您可以在网上或书中找到。**

* * *

我们需要查看您正在谈论的框架或图形。

可能是使用**CSS**和**JavaScript****的客户端**，或者可能需要使用**PHP**或**ASP**等生成**服务器端的**图形。

 ******* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:30:00.497

你可能会搜索[这个例子](http://www.allscoop.com/tools/Web-Colors/web-colors.php)。但我不确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T15:36:01.373

获得此类内容的标准方法是根据用户选择链接到不同的 CSS 文件（或类）（您可能希望存储用户选择并在同一用户登录时检索，但这超出了这里的范围）。

如果您使用的是 ASP.NET，您可以使用主题作为一种优化和集中的方式来控制您的 Web 应用程序的演示。您可以在主题中包含样式表，并以编程方式轻松地在主题之间切换，自动应用关联的样式表。

要了解如何定义 ASP.NET 页面主题，请查看此链接：

[http://msdn.microsoft.com/en-us/library/ms247256.aspx](http://msdn.microsoft.com/en-us/library/ms247256.aspx)

要查看如何以编程方式在主题之间切换，请点击此其他链接：

[http://msdn.microsoft.com/en-us/library/0yy5hxdk(VS.80).aspx](http://msdn.microsoft.com/en-us/library/0yy5hxdk(VS.80).aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T17:09:04.910

我有点直觉，您将有一个黑白位图用作基本图像。然后客户可以选择任何其他颜色组合。这可能不完全是您的情况，但它应该让我们开始。（下面的代码是 VB——这是我所知道的，但转换为 C# 对你来说应该是微不足道的。）

```
Imports System.Drawing

Private Function createImage(ByVal srcPath As String, ByVal fg As Color, ByVal bg As Color) As Bitmap
    Dim img As New Bitmap(srcPath)
    For x As Int16 = 0 To img.Width
        For y As Int16 = 0 To img.Height
            If img.GetPixel(x, y) = Color.Black Then
                img.SetPixel(x, y, fg)
            Else
                img.SetPixel(x, y, bg)
            End If
        Next
    Next
    Return img
End Function 
```

然后你可以对图像做任何事情......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T15:23:23.087

我以前在 PHP 中做过类似的事情，我使用了 ImageMagick 和 GD 库。我不确定 ASP 和 C# 是否可以使用 .NET 框架插入它，但这是一个开始。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T15:24:20.917

System.Drawing 基于 GDI+。仅当您在世界网络中绘制位图时才有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T15:28:12.030

您的解决方案将取决于图形的复杂程度。如果您有简单的图形（您可以使用 MS Paint 制作），那么您可以使用 System.Drawing 命名空间来相当可靠地重新创建图像。

如果您有复杂的图形，例如在 Photoshop 或 Paint.NET 中制作的具有多个图层的图形，您最好允许客户端仅选择几种颜色 (4-8-16) 并预先制作匹配的图形的选择。

# groovy - 如何将标准输出从 groovy 方法通过管道传输到字符串中

> ID：121665
> 
> 赞同：11
> 
> 时间：2008-09-23T15:18:50.540
> 
> 标签：groovy

如何调用打印到标准输出的常规方法，将输出附加到字符串？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-23T15:34:14.670

这演示了如何做到这一点。将其粘贴到 Groovy 脚本文件中并运行它。您将看到第一个调用函数正常。第二次调用没有结果。最后，main 中的最后一步打印重定向到 ByteArrayOutputStream 的第二次调用的结果。

玩得开心！

```
void doSomething() {
  println "i did something"
}

println "normal call\n---------------"
doSomething()
println ""

def buf = new ByteArrayOutputStream()
def newOut = new PrintStream(buf)
def saveOut = System.out

println "redirected call\n---------------"
System.out = newOut
doSomething()
System.out = saveOut
println ""

println "results of call\n---------------"
println buf.toString() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T19:44:12.803

我不确定“将输出附加到字符串”是什么意思，但您可以使用“print”或“println”打印到标准输出。

# programming-languages - 多核和并发 - 语言、库和开发技术

> ID：121674
> 
> 赞同：35
> 
> 时间：2008-09-23T15:19:45.920
> 
> 标签：programming-languages, concurrency, functional-programming, multicore

CPU 架构格局发生了变化，多核是一种趋势，它将改变我们开发软件的方式。我用 C、C++ 和 Java 做过多线程开发，我用各种 IPC 机制做过多进程开发。对于开发人员来说，使用线程的传统方法似乎并不容易使用支持高度并发的硬件。

您知道哪些语言、库和开发技术有助于缓解创建并发应用程序的传统挑战？我显然在考虑死锁和竞争条件等问题。设计技术、库、工具等也很有趣，它们有助于实际利用并确保利用可用资源——仅仅编写一个安全、健壮的线程应用程序并不能确保它使用了所有可用的内核。

到目前为止我看到的是：

*   [Erlang](http://www.erlang.org/)：基于进程，消息传递 IPC，'actor 的并发模型
*   [Dramatis](https://github.com/dramatis/dramatis)：Ruby 和 Python 的演员模型库
*   [Scala](http://www.scala-lang.org/)：用于 JVM 的函数式编程语言，增加了一些并发支持
*   [Clojure](http://clojure.org/)：用于 JVM 的函数式编程语言，带有演员库
*   [Termite](http://code.google.com/p/termite/) : Erlang 进程方法和消息传递给 Scheme 的一个端口

你还知道什么，什么对你有用，你认为什么有趣？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-24T15:18:36.820

我建议进行两个范式转变：

# 软件事务内存

您可能想看看*软件事务内存*(STM) 的概念。这个想法是使用*乐观并发*：任何与其他操作并行运行的操作都尝试在隔离事务中完成其工作；如果在某个时刻另一个事务已提交，使该事务正在处理的数据无效，则该事务的工作将被丢弃并再次运行该事务。

我认为这个想法的第一个广为人知的实现（如果不是概念验证和第一个）是 Haskell 中的一个：[关于 Haskell 中事务内存的论文和演示](http://research.microsoft.com/~simonpj/papers/stm/index.htm)。[Wikipedia 的 STM 文章](http://en.wikipedia.org/wiki/Software_transactional_memory)中列出了许多其他实现。

# 事件循环和承诺

[[E 编程语言]( http://en.wikipedia.org/wiki/E_(programming_language%29)](http://en.wikipedia.org/wiki/E_(programming_language%29))实现了另一种非常不同的并发处理方式。

请注意，它处理并发的方式以及语言设计的其他部分很大程度上基于 Actor 模型。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-23T15:25:26.890

你提到了Java，但你只提到了线程。你看过 Java 的并发库吗？它与 Java 5 及更高版本捆绑在一起。

这是一个非常好的库，包含 ThreadPools、CopyOnWriteCollections 等等。查看[Java 教程](http://java.sun.com/docs/books/tutorial/essential/concurrency/index.html)中的文档。或者，如果您愿意，[可以使用 Java 文档](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-18T22:37:04.010

一些基于 Scala 的东西：

*   [PiLib：Pi-Calculus 风格并发的托管语言](http://www.scala-lang.org/sites/default/files/linuxsoft_archives/docu/files/PiLib.pdf)
*   [没有控制反转的基于事件的编程](http://lampwww.epfl.ch/~odersky/papers/jmlc06.pdf)
*   [统一线程和事件的 Actor](http://lamp.epfl.ch/~phaller/doc/haller07coord.pdf)
*   [Scala Multicast Actors：架构和实现](http://people.bu.edu/chase/index_files/sma07.pdf)
*   [使用可扩展模式匹配实现连接](http://infoscience.epfl.ch/getfile.py?docid=14145&name=HallerVC07&format=pdf&version=1)
*   [通信 Scala 对象（修订版）](http://www.cs.ox.ac.uk/bernard.sufrin/personal/CSO/cpa2008-cso-2016revision.pdf)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-23T15:32:28.637

我已经使用Python[处理](http://pypi.python.org/pypi/processing)。[它模仿线程](http://docs.python.org/lib/module-threading.html)模块的 API，因此非常易于使用。

如果您碰巧使用`map/imap`或生成器/列表理解，则将代码转换为使用`processing`很简单：

```
def do_something(x):
    return x**(x*x)

results = [do_something(n) for n in range(10000)] 
```

可以并行化

```
import processing
pool = processing.Pool(processing.cpuCount())
results = pool.map(do_something, range(10000)) 
```

它将使用您必须计算结果的许多处理器。还有惰性（`Pool.imap`）和异步变体（`Pool.map_async`）。

有一个实现 的队列类[`Queue.Queue`](http://docs.python.org/lib/module-Queue.html)，以及类似于线程的工作人员。

## 陷阱

`processing`基于`fork()`，必须在 Windows 上进行模拟。对象通过`pickle`/传输`unpickle`，因此您必须确保它有效。分叉一个已经获取资源的进程可能不是你想要的（想想数据库连接），但总的来说它是有效的。它运行得非常好，以至于它已被添加到 Python 2.6 的快速通道中（参见[PEP-317](http://www.python.org/dev/peps/pep-0371/)）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-23T15:36:40.233

英特尔的C++[线程构建块](http://www.threadingbuildingblocks.org/)对我来说非常有趣。它提供了比原始线程更高级别的抽象。如果您喜欢死树文档，O'Reilly 有一本非常[好的书。](http://oreilly.com/catalog/9780596514808/)另请参阅[英特尔线程构建模块的任何经验？](https://stackoverflow.com/questions/106862/any-experiences-with-intels-threading-building-blocks).

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-23T20:23:13.820

我会说：

模型：线程 + 共享状态、actor + 消息传递、事务内存、map/reduce？语言：Erlang、Io、Scala、Clojure、Reia 库：Retlang、Jetlang、Kilim、Cilk++、fork/join、MPI、Kamaelia、Terracotta

我维护了一个关于此类内容（Erlang、Scala、Java 线程、actor 模型等）的并发链接博客，并且每天发布几个链接：

[http://concurrency.tumblr.com](http://concurrency.tumblr.com)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-25T23:38:14.347

问题[您今天推荐什么并行编程模型来利用明天的众核处理器？](https://stackoverflow.com/questions/79999/what-parallel-programming-model-do-you-recommend-today-to-take-advantage-of-the)已经被问过了。我也在那里给出了以下答案。

[Kamaelia](http://www.kamaelia.org/Home)是一个**python 框架**，用于构建具有大量通信进程的应用程序。

> # ![](https://i.stack.imgur.com/KVtRN.png)Kamaelia - 并发变得有用、有趣
> 
> 在 Kamaelia 中，您可以使用**相互通信的简单组件**构建系统。这加快了开发速度，极大地帮助了维护，还意味着您可以**构建自然并发的软件**。它旨在供**任何**开发人员访问，包括新手。它也让它变得有趣:)
> 
> 什么样的系统？网络服务器、客户端、桌面应用程序、基于 pygame 的游戏、转码系统和管道、数字电视系统、垃圾邮件根除器、教学工具等等 :)

这是来自 Pycon 2009 的视频。它首先将 Kamaelia 与 Twisted 和 Parallel Python 进行比较，然后动手演示 Kamaelia。

[使用 Kamaelia 轻松并发 - 第 1 部分](http://blip.tv/file/2022798)(59:08)
[使用 Kamaelia 轻松并发 - 第 2 部分](http://blip.tv/file/2022853)(18:15)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-04-28T16:55:38.340

近 20 年来，我一直在 Ada 中进行并发编程。

语言本身（不是一些附加在库上的）支持线程（“任务”）、多种调度模型和多种同步范式。您甚至可以使用内置原语构建自己的同步方案。

您可以将 Ada 的[集合点](http://ei.cs.vt.edu/~cs5204/sp99/rendezvous.html)视为一种面向过程的同步工具，而[受保护对象](http://www.iste.uni-stuttgart.de/ps/ada-doc/style_guide/sec_6a.html#6.1.1)则更面向对象。Rendezvous 类似于旧的 CS 概念[监视器](http://en.wikipedia.org/wiki/Monitor_(synchronization))，但功能更强大。受保护对象是具有同步原语的特殊类型，允许您构建与操作系统锁、信号量、事件等完全相同的东西。但是，它足够强大，您还可以根据您的确切需求发明和创建自己类型的同步对象.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-23T15:32:02.520

我正在密切关注[.NET](http://www.vsj.co.uk/articles/display.asp?id=704)和[Parallel LINQ](http://msdn.microsoft.com/en-us/magazine/cc163329.aspx)的 Parallel Extensions 。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-23T15:27:43.233

我知道[Reia——](http://wiki.reia-lang.org/wiki/Reia_Programming_Language)一种基于 Erlang 但看起来更像 Python/Ruby 的语言。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-23T15:37:10.713

[这个问题与您今天推荐哪种并行编程模型以利用明天的众核处理器](https://stackoverflow.com/questions/79999/what-parallel-programming-model-do-you-recommend-today-to-take-advantage-of-the)密切相关，如果不是重复的话？

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-27T05:09:55.093

[Java 也有你知道的演员库](http://apocalisp.wordpress.com/2008/07/28/threadless-concurrency-with-actors/)。你知道[Java 是一种函数式语言吗？](http://functionaljava.org/);)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-20T16:24:39.537

[开放MP](http://www.openmp.org/)。

它为您处理线程，因此您只需担心要并行运行的 C++ 应用程序的哪些部分。

例如。

```
#pragma omp parallel for
for (int i=0; i < SIZE; i++) 
{
// do something with an element
} 
```

上面的代码将在你告诉 openmp 运行时使用的尽可能多的线程上运行 for 循环，所以如果 SIZE 为 100，并且你有一个四核盒子，那么 for 循环将在每个核心上运行 25 个项目。

还有一些针对各种语言的其他并行扩展，但我最感兴趣的是在您的显卡上运行的那些。那是真正的并行处理:)（例如：[GPU++](http://blog.beef.de/thesis/)和[libSh](http://libsh.org/)）

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-21T14:07:54.960

C++0x 将提供`std::lock`将多个互斥锁锁定在一起的函数。这将有助于缓解由于乱序锁定导致的死锁。此外，C++0x 线程库将包含 promise、futures 和打包任务，它们允许线程等待在另一个线程上执行的操作的结果，而无需任何用户级锁。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-06-06T14:01:26.150

`multiprocessing`是一个简化多核编程的python库，正如另一个答案中提到的那样。

用 python 编写的程序`multiprocessing`可以很容易地修改以在云上交付工作，而不是本地核心。 [piCloud](http://www.picloud.com/)利用这一点在云上提供大量的按需处理能力：您只需要修改 2 行代码。

所以，这里是要点：在为多核选择库时，人们可能想问云方法是否也有意义。

# c# - Starting a process in C# with username & password throws "Access is Denied" exception

> ID：121676
> 
> 赞同：8
> 
> 时间：2008-09-23T15:20:27.870
> 
> 标签：c#, .net, process, permissions

Inside a .NET 3.5 web app running impersonation I am trying to execute a process via:

```
var process = new Process 
             { StartInfo = 
                    { CreateNoWindow = true, 
                      FileName = "someFileName", 
                      Domain = "someDomain", 
                      Username = "someUserName", 
                      Password = securePassword, 
                      UseShellExecute = false
                    }
             };

process.Start(); 
```

-Changing the trust mode to full in web.config did not fix.

-Note the var securePassword is a secureString set up earlier in the code.

This throws an exception with 'Access is Denied' as its message. If I remove the username and password information, the exception goes away, but the process starts as aspnet_wp instead of the user I need it to.

I've seen this issue in multiple forums and never seen a solution provided. Any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T15:32:25.187

You can use ProcessStartInfo which allows you to specify credentials. The trick is that the password is a secure string, so you have to pass it as a byte array.

The code might look something like:

```
Dim startInfo As New ProcessStartInfo(programName)
        With startInfo
            .Domain = "test.local"
            .WorkingDirectory = My.Application.Info.DirectoryPath
            .UserName = "testuser"
            Dim pwd As New Security.SecureString
            For Each c As Char In "password"
                pwd.AppendChar(c)
            Next
            .Password = pwd

            'If you provide a value for the Password property, the UseShellExecute property must be false, or an InvalidOperationException will be thrown when the Process..::.Start(ProcessStartInfo) method is called. 
            .UseShellExecute = False

            .WindowStyle = ProcessWindowStyle.Hidden
        End With 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T05:41:24.977

不确定是不是这样，但我遇到了一个相关的问题，答案是该帐户无权在机器上模拟。这可以通过使用机器上的本地策略管理器将帐户添加到策略“在身份验证后模拟客户端”来更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-29T14:17:51.280

我采取了不同的方式，将整个应用程序放在它自己的应用程序池中，以我们最初模拟的用户身份运行。现在，当 asp.net 生成一个新进程时，它会在用户上下文而不是 aspnet_wp 的上下文中生成。不是我发布的问题的确切解决方案，但它适用于我们的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T15:44:52.600

[根据流程](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx "MSDN - System.Diagnostics.Process")要求检查[代码访问安全](http://msdn.microsoft.com/en-us/library/87x8e4d1.aspx "MSDN - ASP.NET 代码访问安全")级别。您的 Web 应用程序可能在部分信任设置中运行。`Full Trust`

从流程 MSDN 页面：

> **权限**
> 
> * **LinkDemand**
> 对直接调用者的完全信任。部分受信任的代码不能使用此类。
> 
> * **InheritanceDemand**
> 对继承者的完全信任。此类不能被部分受信任的代码继承。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T15:26:11.413

I ran into the same problem that you did on a project. There *should* be a way to spawn a process out of your web app with given credentials, but in practice, it's a kludge at best. What I wound up finally doing was just having the app push information to an MSMQ and having a windows service that popped items of the Queue an serviced the requests.

Even when you appliation is impersonating, it still wants to run under theaspnet user account.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T16:22:29.670

I wanted to mention that I have tried the code at [this site](http://odetocode.com/Blogs/scott/archive/2004/10/28/602.aspx) including the updated code mentioned in the comments. This code runs the process as the impersonated identity (which is really all I need), but the redirecting of the standard error fails -- so this link could be useful to those not concerned with dealing with the stderr.

# c# - 'int' 和有什么区别？和 C# 中的“int”？

> ID：121680
> 
> 赞同：93
> 
> 时间：2008-09-23T15:21:09.647
> 
> 标签：c#, syntax, types, nullable

我 90% 确定我之前在 stackoverflow 上看到过这个答案，事实上我从未见过“int？” 在这里看到之前的语法，但无论我如何搜索我都找不到以前的帖子，这让我发疯。

可能是我不小心吃到了有趣的蘑菇，但如果我不是，如果有人能找到或者重新解释一下，请指出之前的帖子吗？我的 stackoverflow search-fu 显然太低了....

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2008-09-23T15:22:01.937

诠释？是 的简写`Nullable<int>`。

[这](https://stackoverflow.com/questions/110229/how-do-nullable-types-work-in-c)可能是您正在寻找的帖子。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-23T15:22:10.970

诠释？是可空的。

MSDN：[使用 Nullable 类型（C# 编程指南）](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/nullable-types/using-nullable-types)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-09-23T15:22:28.957

诠释？和 Nullable 是一样的。它允许您在 int 中有“null”值。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-10-04T17:55:36.917

int 属于 System.ValueType 并且不能将 null 作为值。在处理元素可以具有空值的数据库或其他类型时，检查元素是否为空可能很有用。那是什么时候int？发挥作用。诠释？是一个可为空的类型，其值范围为 -2147483648 到 2147483648 和 null。

参考：[https ://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx](https://msdn.microsoft.com/en-us/library/1t3y8s4s.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-10T10:42:35.233

Int 不能接受 null 但如果开发人员使用的是 int? 然后将 null 存储在 int 中，例如 int i = null; // 不接受 int? 我=空；// 它的工作主要用于 MVC Pagelist 中的分页

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-10T07:06:31.437

符号？在 int 之后意味着它可以为空。

这 ？符号通常用于变量可以接受空值或整数或者返回整数或空值的情况。

希望使用上下文有所帮助。通过这种方式，您不仅限于处理整数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-18T07:04:57.053

当您期望整数中有一个空值时，您可以使用它，尤其是当您使用 CASTING ex 时：

```
x= (int)y; 
```

如果 y = null 那么你将有一个错误。你必须使用：

```
x = (int?)y; 
```

# winapi - 如何确保 fopen() 在未连接到网络时不会阻塞？

> ID：121685
> 
> 赞同：1
> 
> 时间：2008-09-23T15:21:38.677
> 
> 标签：winapi

我的 win32 C++ 应用程序经常检查通常驻留在 [我们公司网络中] 网络共享上的文件。但如果计算机未连接到网络，应用程序会冻结几分钟，用户通常必须结束该进程。在打开文件之前如何检查文件是否可以访问？

检查是否存在任何网络连接可能还不够好。用户断开连接的原因是使用该文件不存在的测试网络。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T15:23:25.630

将文件访问权限放入单独的线程中？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:42:11.107

我认为线程是您最好的选择。

似乎没有异步调用 CreateFile API 的方法。打开文件句柄后，您可以对其进行异步 I/O，但打开它的行为仍然是同步的。

您必须自己管理与线程的同步，因为只有您的应用程序知道它何时需要 fopen 的结果，并且它可能仍会在此时阻塞。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:25:41.240

在我看来，在一个单独的线程中使用这种方法是你最好的选择。

[文件已存在](http://msdn.microsoft.com/en-us/library/system.io.file.exists(VS.71).aspx)

# .net - 当 ADO.NET 查询无法检索到请求的数据时应该抛出什么异常？

> ID：121700
> 
> 赞同：2
> 
> 时间：2008-09-23T15:23:30.187
> 
> 标签：.net, sql, exception, ado.net

为了向我们的应用程序添加一些参数验证和正确的使用语义，我们正在尝试向我们的 .NET 应用程序添加正确的异常处理。

我的问题是：当在 ADO.NET 中抛出异常时，如果特定查询没有返回数据或找不到数据，我应该使用哪种类型的异常？

伪代码：（阅读，不要仔细检查代码的语义，我知道它不会编译）

```
public DataSet GetData(int identifier)
{
    dataAdapter.Command.Text = "Select * from table1 Where ident = " + identifier.toString();
    DataSet ds = dataAdapter.Fill(ds);
    if (ds.table1.Rows.Count == 0)
        throw new Exception("Data not found");

    return ds;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-23T16:09:23.960

[MSDN 指南](http://msdn.microsoft.com/en-us/library/ms229021(VS.80).aspx)指出：

*   考虑抛出驻留在系统命名空间中的现有异常，而不是创建自定义异常类型。

*   如果您有一个可以以不同于任何其他现有异常的方式以编程方式处理的错误条件，请创建并抛出自定义异常。否则，抛出现有异常之一。

*   不要为了让你的团队例外而创建和抛出新的例外。

没有硬性规定：但如果您有一个以不同方式处理此异常的方案，请考虑创建自定义异常类型，例如[Johan Buret 建议的](https://stackoverflow.com/questions/121700/what-exception-should-be-thrown-when-an-adonet-query-cannot-retrieve-the-reques#121809)DataNotFoundException 。

否则，您可能会考虑抛出现有异常类型之一，例如 System.Data.DataException 甚至可能是 System.Collections.Generic.KeyNotFoundException。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T15:38:33.877

你真的应该定义你自己的异常：DataNotFoundException。

您不应该使用基本类 Exception，因为当您在调用代码中捕获它时，您将编写类似

```
try
{
     int i;
     GetData(i);

}
catch(Exception e) //will catch many many exceptions
{
    //Handle gracefully the "Data not Found" case;
    //Whatever else happens will get caught and ignored
} 
```

仅捕获您的 DataNotFoundEXception 只会获得您真正想要处理的情况。

```
try
{
     int i;
     GetData(i);

}
catch(DataNotFoundException e) 
{
    //Handle gracefully the "Data not Found" case;
} //Any other exception will bubble up 
```

有一个恰当地命名为 SqlException 的类，当 SQL 引擎出现问题时，最好不要让您的业务逻辑超载它

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T15:29:05.743

就 ADO.net 而言，返回零行的查询不是错误。如果您的应用程序希望将此类查询视为错误，则应通过从 Exception 继承来创建自己的异常类。

```
public class myException : Exception
{
   public myException(string s) : base() 
   {
      this.MyReasonMessage = s;
   }
}

public void GetData(int identifier)
{
    dataAdapter.Command.Text = "Select * from table1 Where ident = " + identifier.toString();
    DataSet ds = dataAdapter.Fill(ds);
    if (ds.table1.Rows.Count == 0)
        throw new myException("Data not found");
} 
```

# asp.net - 如何将 javascript 与 asp.net 下拉列表控件一起使用？

> ID：121707
> 
> 赞同：0
> 
> 时间：2008-09-23T15:24:50.277
> 
> 标签：asp.net, javascript, jquery, ajax, webforms

我目前不使用 ajax.net，但如果它是唯一的解决方案，我会接受它。我在屏幕上有一个自动完成控件，用于通过 javascript (jQuery) 填充带有值的 asp.net 下拉列表。我不得不使用 EnableEventValidation="false" 来允许这样做。在我将我的选项添加到选择并回发表单后，我希望能够获取我通过 javascript 添加到 asp.net 下拉列表中的选项元素的所有值。有没有一个好方法来完成这个?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T15:38:43.300

如果 DropDownList 离开服务器时没有选项，它会在没有选项的情况下在服务器端重新创建（来自视图状态）

您可以将选项添加到隐藏的 html 控件作为 javascript 中的分隔字符串以及选择列表。然后在服务器端回发时将其迭代到控件中。否则，您可以将它们 ajax 到服务器并仅为每次添加重新渲染 DropDownList。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T16:13:36.053

您可以直接从表单中获取选定的值，如下所示：

```
string fooBar = Request.Form[SomeDropDown.UniqueID]; 
```

无论您对下拉选项做什么，这都会返回正确的值。我使用 javascript 根据尺寸选择更改产品的数量下拉列表，以反映产品的可用性。

# svn - 在 Subversion 中保留文件创建日期

> ID：121713
> 
> 赞同：7
> 
> 时间：2008-09-23T15:25:36.123
> 
> 标签：svn, tortoisesvn

我的老板让我设置一个[Subversion](http://en.wikipedia.org/wiki/Apache_Subversion)服务器供他使用，这样他就可以在不同的机器上同步共享他的所有文档，并且在没有 Internet 连接时仍然能够访问它们。

我为他准备好了，但现在他要求保留“创建日期”文件属性。我解释说，因为他下载了所有创建日期的文件，但他坚持要我找到一种方法来保存它，因为它会影响他使用的桌面搜索代理。有没有办法设置这个属性通过 Subversion 保留，或者我是否必须编写一个脚本来获取每个文件的日期并让他在每次初始签出后运行“触摸”？

请注意，添加到 SVN 存储库的文档集可以追溯到几年前，他希望在所有结帐时保留这些日期。因此，Subversion 上次更改的日期可能与他想要的相差数年。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T15:29:47.783

使用 TortoiseSVN

*   右键单击并**选择 TortoiseSVN -> 设置**
*   选择**将文件日期设置为“最后提交时间”**

我认为这对你有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T16:02:48.093

对不起 - 第一次误解了这个问题。

一种选择可能是使用 svnadmin 转储和加载命令。

*   使用 svnadmin dump 转储存储库。
*   编写一个脚本来搜索输出，将 SVN 创建日期更新为源文件夹上的文件创建日期。
*   使用 svnadmin load 重新加载更新的转储文件。
*   使用我之前建议的**将文件日期设置为“最后提交时间”**设置。

我不确定这是否可能，但我想它会是。我似乎记得当我从 SourceSafe 转移到 Subversion 时有一个脚本做了类似的事情——我会看看能不能找到它。

编辑：是的，你也许可以从这里（[http://www.pumacode.org/projects/vss2svn](http://www.pumacode.org/projects/vss2svn)）抄下一些代码

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-09-09T18:43:35.527

查看属性“svn:date”：

```
svn propset svn:date --revprop -r HEAD "2007-04-22" 
```

Which requires a hook *pre-revprop-change* to be set up in advance.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T15:28:44.557

上次我检查 Subversion 没有办法保留原始文件的时间戳。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T15:57:55.907

您可以使用 Subversion 文件属性来存储修改日期，但您必须编写自己的脚本来在签入时更新属性并在签出时设置修改日期。

# java - 动态添加的 JTable 不显示

> ID：121715
> 
> 赞同：1
> 
> 时间：2008-09-23T15:25:49.183
> 
> 标签：java, swing, netbeans, jtable

Java新手在这里。我有一个添加到我的 netbeans 项目中的 JFrame，并且我向其中添加了以下方法，它创建了一个 JTable。问题是，由于某种原因，当我调用此方法时，没有显示 JTable。有什么建议么？

```
public void showFromVectors(Vector colNames, Vector data) {     
    jt = new javax.swing.JTable(data, colNames);
    sp = new javax.swing.JScrollPane(jt);
    //NB: "this" refers to my class DBGridForm, which extends JFrame
    this.add(sp,java.awt.BorderLayout.CENTER);
    this.setSize(640,480);
} 
```

该方法在以下上下文中调用：

```
DBGridForm gf = new DBGridForm(); //DBGridForm extends JFrame
DBReader.outMatchesTable(gf);
gf.setVisible(true); 
```

...其中 DBReader.outMatchesTable() 定义为

```
static public void outMatchesTable(DBGridForm gf) {
    DBReader ddb = new DBReader();
    ddb.readMatchesTable(null);
    gf.showFromVectors(ddb.lastRsltColNames, ddb.lastRsltData);
} 
```

我的猜测是我忽略了一些东西，要么是关于我正在使用的摇摆类，要么是关于 Java。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T15:34:17.023

您的上下文中的“这个”不清楚。是在applet里面吗？一个JFrame？

您可能遇到了布局问题，请确保您已使用新的边框布局在您的班级上调用了 setLayout。

在 Swing 应用程序中，您可能希望使用 getRootContentPane().add() 而不是原始的 add()，具体取决于版本。

Java tutorial on adding top-level content: [http://java.sun.com/docs/books/tutorial/uiswing/components/toplevel.html](http://java.sun.com/docs/books/tutorial/uiswing/components/toplevel.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-23T20:12:31.740

If you are not running on the event thread, it could be a problem--I've seen that cause stuff not to display.

If this code is called in response to an AWT event (mouse click, button press, ...) then that's not the problem, but if it's still the same thread that started your app, or this code is running off a timer, could very well be.

# c# - 从 RowDataBound 事件的 gridview 从单元格中获取值

> ID：121722
> 
> 赞同：33
> 
> 时间：2008-09-23T15:26:14.937
> 
> 标签：c#, asp.net, gridview

```
string percentage = e.Row.Cells[7].Text; 
```

我正在尝试用我的 GridView 做一些动态的事情，所以我已经将一些代码连接到 RowDataBound 事件。我正在尝试从特定单元格中获取值，该单元格是 TemplateField。但是上面的代码似乎总是返回一个空字符串。

有任何想法吗？

为了澄清，这里有一点有问题的单元格：

```
<asp:TemplateField HeaderText="# Percentage click throughs">
<ItemTemplate>
    <%# AddPercentClickThroughs((int)Eval("EmailSummary.pLinksClicked"), (int)Eval("NumberOfSends")) %>
</ItemTemplate>
</asp:TemplateField> 
```

在相关说明中，有谁知道是否有更好的方法来选择行中的单元格。`cell[1]`放进去很烂 我不能这样做`cell["mycellname"]`，所以如果我决定改变我的单元格的顺序，错误就不会出现？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-09-23T15:29:31.450

为什么不直接从数据源中提取数据。

```
DataBinder.Eval(e.Row.DataItem, "ColumnName") 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-07T18:50:40.587

当您使用 TemplateField 并将文字文本绑定到它时，asp.net 实际上会为您插入一个控件！它被放入 DataBoundLiteralControl。如果您查看获取空文本的代码行附近的调试器，您可以看到这一点。

因此，要在不更改模板以使用控件的情况下访问信息，您可以像这样进行转换：

```
string percentage = ((DataBoundLiteralControl)e.Row.Cells[7].Controls[0]).Text; 
```

这会让你得到你的文字！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-10T15:46:18.297

以上是很好的建议，但您可以在网格视图中获取单元格的文本值，而无需将其包装在文字或标签控件中。你只需要知道要连接什么事件。在这种情况下，请改用 DataBound 事件，如下所示：

```
protected void GridView1_DataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        if (e.Row.Cells[0].Text.Contains("sometext"))
        {
            e.Row.Cells[0].Font.Bold = true;
        }
    }
} 
```

运行调试器时，您将看到此方法中出现的文本。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-23T15:28:42.887

首先，您需要将代码包装在一个`Label`或`Literal`控件中，以便您可以正确引用它。发生的情况是系统无法跟踪它，因为没有与文本关联的控件。将其内容添加到视图状态是控件的责任。

您需要使用 gridView.FindControl("controlName"); 获得行中的控制权。从那里你可以得到它的属性，包括`Text`.

您还可以获取相关行的 DataItem 属性并将其转换为适当的类型并直接提取信息。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-03-30T19:39:57.927

只需使用循环来检查网格视图中的单元格，例如：

```
for (int i = 0; i < GridView2.Rows.Count; i++)
{
    string vr;
    vr = GridView2.Rows[i].Cells[4].Text; // here you go vr = the value of the cel
    if (vr  == "0") // you can check for anything
    {
        GridView2.Rows[i].Cells[4].Text = "Done";
        // you can format this cell 
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-04-06T17:23:46.510

使用`RowDataBound`函数将数据与特定单元格绑定，并获取控件使用（ASP 控件名称，如 DropDownList）`GridView.FindControl("Name of Control")`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-27T16:33:52.713

我有一个类似的问题，但通过稍微不同的方法找到了解决方案。我没有按照 Chris 的建议查找控件，而是首先更改了在 .aspx 页面中指定字段的方式。我没有使用`<asp:TemplateField ...>`标签，而是将相关字段更改为使用`<asp:BoundField ...>`. 然后，当我到达 RowDataBound 事件时，可以直接访问单元格中的数据。

相关片段： 一、aspx页面：

```
<asp:GridView ID="gvVarianceReport" runat="server" ... >
...Other fields...
    <asp:BoundField DataField="TotalExpected" 
     HeaderText="Total Expected <br />Filtration Events" 
     HtmlEncode="False" ItemStyle-HorizontalAlign="Left" 
     SortExpression="TotalExpected" />
...
</asp:Gridview> 
```

然后在 RowDataBound 事件中，我可以直接访问这些值：

```
protected void gvVarianceReport_Sorting(object sender, GridViewSortEventArgs e)
{
    if (e.Row.Cells[2].Text == "0")
    {
        e.Row.Cells[2].Text = "N/A";
        e.Row.Cells[3].Text = "N/A";
        e.Row.Cells[4].Text = "N/A";
    }
} 
```

如果有人可以评论*为什么*会这样，我将不胜感激。我不完全理解为什么没有 BoundField 绑定后值不在单元格中，但您必须通过控件查找它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-08-23T12:09:18.990

```
Label lblSecret = ((Label)e.Row.FindControl("lblSecret")); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-09T02:12:48.287

```
<asp:TemplateField HeaderText="# Percentage click throughs">
  <ItemTemplate>
    <%# AddPercentClickThroughs(Convert.ToDecimal(DataBinder.Eval(Container.DataItem, "EmailSummary.pLinksClicked")), Convert.ToDecimal(DataBinder.Eval(Container.DataItem, "NumberOfSends")))%>
  </ItemTemplate>
</asp:TemplateField>

public string AddPercentClickThroughs(decimal NumberOfSends, decimal EmailSummary.pLinksClicked)
{
    decimal OccupancyPercentage = 0;
    if (TotalNoOfRooms != 0 && RoomsOccupied != 0)
    {
        OccupancyPercentage = (Convert.ToDecimal(NumberOfSends) / Convert.ToDecimal(EmailSummary.pLinksClicked) * 100);
    }
    return OccupancyPercentage.ToString("F");
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-01-19T09:53:41.913

如果将 asp:BoundField 上的属性**Visible设置为****False**。像这样

```
<asp:BoundField DataField="F1" HeaderText="F1" Visible="False"/> 
```

循环行时，您**不会在 Cells[i].Text 属性中获得任何文本。**所以

```
foreach (GridViewRow row in myGrid.Rows)
{
  userList.Add(row.Cells[0].Text); //this will be empty ""
} 
```

但是您可以通过将网格连接到事件 OnRowDataBound 来设置不可见的列，然后从这里执行此操作

```
e.Row.Cells[0].Visible = false //now the cell has Text but it's hidden 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-06-19T22:37:37.547

关于列的索引选择样式，我建议您执行以下操作。我遇到了这个问题，但我打算使用 an 动态设置值，`API`所以我所做的是：记住`.CastTo<T>`很简单`((T)e.Row.DataItem)`

，你必须调用`DataBind()`才能看到网格中的变化。这样，如果您决定在网格中添加一列，您就不会遇到问题。

```
 protected void gvdata_RowDataBound(object sender, GridViewRowEventArgs e)
        {
            if(e.Row.RowType == DataControlRowType.DataRow)
            {
                var number = e.Row.DataItem.CastTo<DataRowView>().Row["number"];
                e.Row.DataItem.CastTo<DataRowView>().Row["ActivationDate"] = DateTime.Parse(userData.basic_info.creation_date).ToShortDateString();
                e.Row.DataItem.CastTo<DataRowView>().Row["ExpirationDate"] = DateTime.Parse(userData.basic_info.nearest_exp_date).ToShortDateString();
                e.Row.DataItem.CastTo<DataRowView>().Row["Remainder"] = Convert.ToDecimal(userData.basic_info.credit).ToStringWithSeparator();

                e.Row.DataBind();
            }
        } 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-04-05T04:39:48.260

```
protected void gvbind_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        e.Row.Attributes["onmouseover"] = "this.style.cursor='hand';";
        e.Row.Attributes["onmouseout"] = "this.style.textDecoration='none';";
        e.Row.Attributes["onclick"] = ClientScript.GetPostBackClientHyperlink(this.gvbind, "Select$" + e.Row.RowIndex);
    }
} 
```

# wpf - Where can I find free WPF controls and control templates?

> ID：121724
> 
> 赞同：87
> 
> 时间：2008-09-23T15:26:22.783
> 
> 标签：wpf, controls, templates

I am looking for some recommendations on good places to find libraries of controls/templates/styles for WPF. I know about the usual places like Infragistics, but it seems to me that there should be some kind of community effort by now to share nice, clean, well written controls for WPF controls.

I am not big on the design side, and it would be nice to fill out my personal libraries with some nice examples from people who are better at design.

Any ideas or recommendations?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2015-11-10T12:25:07.423

我强烈推荐[MahApps](http://mahapps.com/)，它简直太棒了！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-02-10T21:02:41.227

Syncfusion 有一个免费的社区版本，提供超过 650 个控件。

[同步融合](https://www.syncfusion.com/products/communitylicense)

您会在那里找到一个常见问题解答，其中包含您可能遇到的任何许可问题，说实话听起来很棒。玩得开心！

编辑：WPF 控件本身是 100+，650+ 的数量是指所有区域（WPF、Windows 窗体等）的所有控件。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-09-19T00:06:44.757

我在互联网上搜索了一些不错的主题，但一无所获。所以我移植了 GTK Hybrid 主题的选定控件。它是 MIT 许可的，你可以在这里找到它：

[https://github.com/stil/candyshop](https://github.com/stil/candyshop)

这不是企业级风格，可能有一些缺陷，但我在我的个人项目中使用它。

[![演示](https://i.stack.imgur.com/NneVv.png)](https://i.stack.imgur.com/NneVv.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-09T16:02:12.780

[他们在http://www.xamltemplates.net/](http://www.xamltemplates.net/)上有一个免费的示例

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-10T13:23:29.243

[Silverlight 和 WPF 仪表板和仪表](http://dashboarding.codeplex.com)

简单（但很棒）的作品。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-25T13:18:33.303

Codeplex 绝对是正确的地方。最近的“帖子”：[SofaWPF.codeplex.com](http://sofawpf.codeplex.com/)基于[AvalonDock.codeplex.com](http://avalondock.codeplex.com/)，一个类似 IDE 的框架。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-23T17:40:51.883

看看[Reuxables](http://www.nukeation.com/reuxables.aspx)，尽管它是有代价的。

# performance - Server virtualization: how to avoid, locate and fix bottlenecks?

> ID：121743
> 
> 赞同：4
> 
> 时间：2008-09-23T15:28:52.340
> 
> 标签：performance, virtualization, system-administration

Server virtualization is a big thing these days, so I'm tasked at work to install some of our software on a virtualized server and see what happens. Long story short: a `rsync` transfer promptly brings the virtualized server to its knees. The virtualization host is a beefy machine with no other load; I don't think this should be happening. `Top` shows high load averages, and cpu iowait near 100%. There's a huge bottleneck somewhere.

I'm more a programmer than a sysadmin, I lack the knowledge on how to go about fixing this outside of random Googling. I suspect I'm not alone in this.

What I'd like to see here is general advice on virtualization, and pointers to good articles and other resources, which I and others could use to educate ourselves.

*   What tools (even standard unix tools) can be used to pinpoint bottlenecks?
*   What metrics should be followed to ensure things run smoothly?
*   What kind of things can be efficiently virtualized?
*   What kind of setups are doomed to fail?

I apologize the broadness of the question. I just don't have the knowledge to ask useful specific questions about this.

Edit: More on my specific problem:

*   XAN paravirtualization, 3 x guest CentOS
*   All guests on local SCSI disks, there is a fully hardware raid controller
*   rsyncd running on 1 guest os, transfer initiated from a remote non virtualized server through 100mbps LAN

Like I said before, I really can't provide a ton of useful data. I'm not really expecting to get a direct solution to this problem, I'd be happy with pointers on where to start building the skillset required to better understand these kinds of problems.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T15:36:23.820

I use rsync to keep some parts of our (very new) virtual environment in sync without any issues. I don't think it's a virtualization issue as much as it is an I/O issue, which you appear to have already identified.

I've found that virtualization is very, very taxing on hard disks, and this only gets worse the more guests you have on the host box. For machines that are very I/O intensive, consider segmenting their disk access away from the other hosts. Are you using any kind of SAN technology? We've found that to be very useful at my workplace (we're using two 8-core Sun Intel servers and a 1TB 12 disk iSCSI array).

Is your hardware fully supported by the virtualization software provider? If you're trying to run on unsupported hardware then there's a good chance that your disk controller is not going to be using the best drivers, which would explain your slow disk accesses.

You can use `iostat` on Linux/Unix to get some feedback on the I/O, and there's `iotop` too, though it's not packaged in many distros yet.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:45:56.467

I was going to put this in a comment, but I think it's more useful in the open:

Could you add more detail about your setup:

*   Which VM server?
    (VMware Server, VMware ESX, MS VirtualServer, MS Hyper-V, something else?)
*   Which OS for the guest(s)?
    (Windows, Linux, 32-bit, 64-bit?)
*   Where are the guest(s) stored?
    (Local disk, or on a NAS or SAN?)
*   Were you rsyncing between guests on the same VM server, or between a guest and a physical server?
*   If across a network, how fast is the network?

Performance tuning in any environment is 90% collecting data, and 10% analysis. Virtualized environments have more variables to consider than Physical environments, but more importantly, they have a different response curve than physical environments. Some applications can perform better in a virtualized environment than a physical environment; others will not. You have to understand the requirements of the application as well as constraints of the implementation.

I don't believe that there are any software-only applications that cannot be successfully deployed on virtual servers, if you pay attention to the details. (Applications that require custom hardware that can't be successfully virtualized is a different problem.)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-28T12:08:29.183

Off hand I'd say this is I/O problem. In virtual environments on of the biggest factors that affects performance is the state of the disk of the host machine. The things that we do to optimize performance are:

1.  Fixed disk allocation. This way you get a contiguous block of drive space for the VM to live in.
2.  Schedule a defrag of the VM Slice OS and the Host server drive. Fragmentation is your enemy.
3.  Be sure that you are ending an server sessions gracefully. When bouncing the virtual OS, DO NOT just shutdown the VM slice, as this cause huge disk fragmentation. The virtual OS needs to perform the shut down / restart process.

# sql-server - 跨不同版本的 SQL Server 开发的最佳实践

> ID：121748
> 
> 赞同：2
> 
> 时间：2008-09-23T15:29:16.880
> 
> 标签：sql-server

扩展[这个问题](https://stackoverflow.com/questions/7535/sql-server-2008-compatability-with-sql-server-2005)，针对 SQL Server 2005 和 SQL Server 2008 进行开发的最佳方法是什么？

我想看看我是否可以在我当前的 Vista 64 机器上使用 Orcas 技术，并且由于 SQL Server 2005 想要安装 Visual Studio 2005 的存根版本，我想避免使用它。但是，在可预见的将来，我的技术将被部署的大多数地方都在 SQL Server 2005 上。

那么最好的做法是什么：

1.  仅在我的开发机器上安装 SQL Server 2008，并了解 2008 特定功能
2.  在我的开发机器上的不同实例上安装 SQL Server 2008 和 SQL Server 2005，并根据生产项目的要求进行开发
3.  仅在我的开发机器上安装 SQL Server 2008，在另一台机器上安装 SQL Server 2005（如测试服务器）
4.  仅在我的开发机器上安装 SQL Server 2005，在另一台机器上安装 SQL Server 2008（如测试服务器）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T15:45:55.063

最安全的做法是针对您支持的最旧的数据库服务器进行编码。这个版本更有可能给你带来麻烦。总的来说，新版本的 db 将具有向后兼容性以支持您的 TSQL 和构造。当使用比您的目标新版本的数据库时，将不受支持的代码引入混合中是非常简单的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-30T10:02:35.960

您需要针对最旧版本的 SQL Server 进行编码，这样您就不会开始使用直到更新版本才可用的功能。尽管新版本不一定会继续支持旧功能，但最好的方法是运行 Microsoft 自己的 SQL Server 最佳实践分析器，它会通知您兼容性问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T15:32:00.493

引用的问题建议更改数据库兼容性级别，这是一个不容易自动化的短期解决方案。

进行自动化测试很重要，如果您阅读 stackoverflow，您可能会同意。

我想说让 MS SQL Server 2005 和 2008 都运行。
然后，假设您运行单元测试，请始终针对两台服务器对您的数据库代码进行单元测试。

# c++ - 你如何在 C++ 中实现协程

> ID：121757
> 
> 赞同：73
> 
> 时间：2008-09-23T15:31:03.210
> 
> 标签：c++, coroutine, c++17

我怀疑它可以便携地完成，但有什么解决方案吗？我认为可以通过创建一个备用堆栈并在函数入口处重置 SP、BP 和 IP，并让产量保存 IP 并恢复 SP+BP 来完成。析构函数和异常安全似乎很棘手，但可以解决。

已经完成了吗？这是不可能的吗？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-09-23T15:38:04.503

是的，它**可以**毫无问题地完成。您只需要一点汇编代码就可以将调用堆栈移动到堆上新分配的堆栈。

我会**看看[boost::coroutine](http://www.boost.org/doc/libs/1_53_0/libs/coroutine/doc/html/index.html) library**。

您应该注意的一件事是堆栈溢出。在大多数操作系统上，堆栈溢出将导致段错误，因为未映射虚拟内存页面。但是，如果您在堆上分配堆栈，您将得不到任何保证。要时刻铭记在心。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-23T16:05:46.980

在 POSIX 上，您可以使用 makecontext()/swapcontext() 例程来可移植地切换执行上下文。在 Windows 上，您可以使用光纤 API。否则，您所需要的只是一些切换机器上下文的胶水汇编代码。我已经使用 ASM（对于 AMD64）和 swapcontext() 实现了协程；两者都不是很难。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-02-24T22:22:41.603

为了后代，

Dmitry Vyukov 的[精彩网站](http://www.1024cores.net/home/lock-free-algorithms/tricks/fibers)有一个巧妙的技巧，使用 ucontext 和 setjump 来模拟 c++ 中的协程。

此外，Oliver Kowalke 的上下文库[最近被](http://lists.boost.org/boost-announce/2012/01/0348.php)Boost 接受，所以希望我们很快就会看到在 x86_64 上工作的 boost.coroutine 的更新版本。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-10-26T06:13:10.227

没有简单的方法来实现协程。因为协程本身就像线程一样脱离了 C/C++ 的堆栈抽象。因此，如果不更改支持的语言级别，就无法支持它。

目前（C++11），所有现有的 C++ 协程实现都是基于汇编级别的黑客攻击，很难安全可靠地跨平台。为了可靠，它需要是标准的，并由编译器而不是黑客来处理。

有一个[标准提案 - N3708](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3708.pdf)。如果您有兴趣，请查看它。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-23T15:33:45.933

如果可能的话，使用迭代器可能比协程更好。这样，您可以继续调用`next()`以获取下一个值，但您可以将状态保留为成员变量而不是局部变量。

它可能会使事情更易于维护。另一位 C++ 开发人员可能不会立即理解协程，但他们可能更熟悉迭代器。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-02-19T15:13:44.373

对于那些想知道如何在 C++ 中以可移植方式利用协程的人 y̶o̶u̶̶w̶i̶l̶l̶̶h̶a̶v̶e̶̶t̶o̶̶w̶a̶i̶t̶̶f̶o̶r̶̶C̶+̶+̶1̶7̶ 等待结束（见下文）！标准委员会正在研究该功能，请参阅[N3722 论文](https://isocpp.org/files/papers/N3722.pdf)。总结一下论文的当前草稿，关键字将是可恢复和等待，而不是 Async 和 Await。

看一下 Visual Studio 2015 中的实验性实现来玩微软的实验性实现。看起来clang还没有实现。

Cppcon Coroutines 有一个很好的演讲，[一个负开销抽象](https://youtu.be/_fu0gx-xseY)概述了在 C++ 中使用 Coroutines 的好处以及它如何影响代码的简单性和性能。

目前我们仍然必须使用库实现，但在不久的将来，我们将把协程作为核心 C++ 特性。

更新：看起来协程实现是为 C++20 设计的，但作为 C++17 ( [p0057r2](http://wg21.link/p0057r2) ) 的技术规范发布。Visual C++、clang 和 gcc 允许您选择使用编译时标志。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-23T15:33:10.693

COROUTINE[一个用于协程排序的可移植 C++ 库](http://www.akira.ruc.dk/~keld/research/COROUTINE/)是否为您指明了正确的方向？这似乎是一个经过时间考验的优雅解决方案......它已经 9 岁了！

在 DOC 文件夹中是 Keld Helsgaun 的论文 A Portable C++ Library for Coroutine Sequencing 的 pdf，它描述了该库并提供了使用它的简短示例。

[更新]我自己实际上正在成功使用它。好奇心使我变得更好，所以我研究了这个解决方案，发现它非常适合我已经研究了一段时间的问题！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-23T15:37:26.220

我认为 C++ 中没有很多成熟、干净的实现。我喜欢的一种尝试是[Adam Dunkels 的 protothread library](http://dunkels.com/adam/pt/)。

另请参阅Protothreads：在 ACM 数字图书馆中[简化内存受限嵌入式系统的事件驱动编程和维基百科主题](https://dl.acm.org/citation.cfm?doid=1182807.1182811)[Protothread](https://en.wikipedia.org/wiki/Protothread)中的讨论，

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-11-04T13:31:09.460

它基于（畏缩）宏，但以下站点提供了易于使用的生成器实现： http: [//www.codeproject.com/KB/cpp/cpp_generators.aspx](http://www.codeproject.com/KB/cpp/cpp_generators.aspx)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-08-21T15:34:33.323

今天发布了一个新库**[Boost.Context](http://www.boost.org/doc/libs/1_57_0/libs/context/doc/html/index.html)**，它具有用于实现协程的可移植特性。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-12-04T15:48:31.273

这是一个旧线程，但我想建议使用不依赖于操作系统的 Duff 设备进行黑客攻击（据我所知）：

[使用 Duff 设备的 C 协程](http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html)

作为一个例子，这是一个我修改为使用协程而不是 fork/threads 的 telnet 库： [Telnet cli library using coroutines](https://github.com/alapaa/libcli)

由于 C99 之前的标准 C 本质上是 C++ 的真正子集，因此这在 C++ 中也很有效。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-08-12T17:34:45.657

我想出了一个**没有 asm**代码的实现。思路是使用系统的线程创建函数初始化栈和上下文，使用setjmp/longjmp切换上下文。但它不是可移植的，如果您有兴趣，请参阅[棘手的 pthread 版本。](https://github.com/roxma/cpp_learn/issues/1)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2016-11-16T01:58:34.480

[https://github.com/tonbit/coroutine](https://github.com/tonbit/coroutine)是支持 resume/yield/await 原语和 Channel 模型的 C++11 单 .h 非对称协程实现。它通过 ucontext/fiber 实现，不依赖于 boost，在 linux/windows/macOS 上运行。这是学习在 C++ 中实现协程的一个很好的起点。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-01-05T08:29:42.167

查看我的实现，它说明了 asm 黑客点并且很简单：

[https://github.com/user1095108/generic/blob/master/coroutine.hpp](https://github.com/user1095108/generic/blob/master/coroutine.hpp)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-10-07T16:12:54.597

也基于宏（Duff 的设备，完全可移植，参见 [http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html](http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html) ）并受 Mark 发布的链接的启发，以下模拟协同进程协作使用事件作为同步机制（与传统的协程/生成器样式略有不同的模型）

```
// Coprocess.h
#pragma once
#include <vector>

class Coprocess {
  public:
    Coprocess() : line_(0) {}
    void start() { line_ =  0; run(); }
    void end()   { line_ = -1; on_end(); }
    virtual void run() = 0;
    virtual void on_end() {}; 
  protected:
    int line_;
};

class Event {
  public:
    Event() : curr_(0) {}

    void wait(Coprocess* p) { waiters_[curr_].push_back(p); }

    void notify() {
        Waiters& old = waiters_[curr_];
        curr_ = 1 - curr_; // move to next ping/pong set of waiters
        waiters_[curr_].clear();
        for (Waiters::const_iterator I=old.begin(), E=old.end(); I != E; ++I)
            (*I)->run();
    }   
  private:
    typedef std::vector<Coprocess*> Waiters;
    int curr_;
    Waiters waiters_[2];
};

#define corun()   run() { switch(line_) { case 0:
#define cowait(e) line_=__LINE__; e.wait(this); return; case __LINE__:
#define coend     default:; }} void on_end() 
```

使用示例：

```
// main.cpp
#include "Coprocess.h"
#include <iostream>

Event e;
long sum=0;

struct Fa : public Coprocess {
    int n, i;
    Fa(int x=1) : n(x) {}
    void corun() {
        std::cout << i << " starts\n";
        for (i=0; ; i+=n) {
            cowait(e);
            sum += i;
        }
    } coend {
        std::cout << n << " ended " << i << std::endl;
    }   
};

int main() {
    // create 2 collaborating processes
    Fa f1(5);
    Fa f2(10);

    // start them
    f1.start();
    f2.start();
    for (int k=0; k<=100; k++) { 
        e.notify();
    }   
    // optional (only if need to restart them)
    f1.end();
    f2.end();

    f1.start(); // coprocesses can be restarted
    std::cout << "sum " << sum << "\n";
    return 0;
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-23T19:28:55.010

[WvCont](http://repo.or.cz/w/wvstreams.git?a=blob;f=include/wvcont.h;h=1c08f5a1aa15fefb02d47824e2ee27316d77d32f;hb=HEAD)是 WvStreams 的一部分，[它](http://code.google.com/p/wvstreams/)实现了所谓的半协程。这些比完整的协程更容易处理：你调用它，它会返回给调用它的人。

它是使用更灵活的 WvTask 实现的，它支持完整的协程；你可以在同一个库中找到它。

至少可以在 win32 和 Linux 上工作，并且可能在任何其他 Unix 系统上工作。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2008-09-23T15:58:51.223

您应该始终考虑使用线程；尤其是在现代硬件中。如果您的工作可以在协程中进行逻辑分离，那么使用线程意味着工作实际上可能由单独的执行单元（处理器内核）同时完成。

但是，也许您确实想使用协程，可能是因为您有一个已经以这种方式编写和测试的经过良好测试的算法，或者因为您正在移植以这种方式编写的代码。

如果你在 Windows 中工作，你应该看看[fiber](http://msdn.microsoft.com/en-us/library/ms682661.aspx)。Fibers 将在操作系统的支持下为您提供类似协程的框架。

我不熟悉其他操作系统来推荐那里的替代品。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2020-01-16T06:54:39.310

这是一个 C++11 中的跨平台 go 风格的协程库：[cocoyaxi](https://github.com/idealvin/cocoyaxi)。

它提供了一个很好的 API，你可以像在 golang 中那样创建协程：

```
go(ku);           // void ku();
go(f, 7);         // void f(int);
go(&T::f, &o);    // void T::f(); T o;
go(&T::f, &o, 7); // void T::f(int); T o;
go([](){
    LOG << "hello go";
}); 
```

cocoyaxi 也实现了`channel`,`waitgroup`和`defer`在 golang 中。

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2012-05-27T18:10:55.940

我尝试使用 C++11 和线程自己实现协程：

```
#include <iostream>
#include <thread>

class InterruptedException : public std::exception {
};

class AsyncThread {
public:
    AsyncThread() {
        std::unique_lock<std::mutex> lock(mutex);
        thread.reset(new std::thread(std::bind(&AsyncThread::run, this)));
        conditionVar.wait(lock); // wait for the thread to start
    }
    ~AsyncThread() {
        {
            std::lock_guard<std::mutex> _(mutex);
            quit = true;
        }
        conditionVar.notify_all();
        thread->join();
    }
    void run() {
        try {
            yield();
            for (int i = 0; i < 7; ++i) {
                std::cout << i << std::endl;
                yield();
            }
        } catch (InterruptedException& e) {
            return;
        }
        std::lock_guard<std::mutex> lock(mutex);
        quit = true;
        conditionVar.notify_all();
    }
    void yield() {
        std::unique_lock<std::mutex> lock(mutex);
        conditionVar.notify_all();
        conditionVar.wait(lock);
        if (quit) {
            throw InterruptedException();
        }
    }
    void step() {
        std::unique_lock<std::mutex> lock(mutex);
        if (!quit) {
            conditionVar.notify_all();
            conditionVar.wait(lock);
        }
    }
private:
    std::unique_ptr<std::thread> thread;
    std::condition_variable conditionVar;
    std::mutex mutex;
    bool quit = false;
};

int main() {
    AsyncThread asyncThread;
    for (int i = 0; i < 3; ++i) {
        std::cout << "main: " << i << std::endl;
        asyncThread.step();
    }
} 
```

# java - 休眠一个线程，直到另一个线程参加了一个事件

> ID：121762
> 
> 赞同：30
> 
> 时间：2008-09-23T15:32:20.383
> 
> 标签：java, android, multithreading

我在一个Android应用程序中有两个线程，一个是视图线程，另一个是工作线程。我想要做的是，让工作线程休眠，直到视图线程终止对 onDraw 方法的处理。

我怎么能这样做？有没有等待信号之类的？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-23T15:45:51.333

在两个线程之间共享一个 java.lang.Object，其唯一目的是告诉工作线程何时可以继续工作。每当工作线程到达它应该休眠的点时，它就会这样做：

```
stick.wait(); 
```

当视图线程完成它的 onDraw 工作时，它调用这个：

```
stick.notify(); 
```

请注意视图线程拥有对象上的监视器的要求。在您的情况下，这应该很容易通过一个小的同步块来强制执行：

```
void onDraw() {
  ...
  synchronized (stick) {
    stick.notify();
  }
} // end onDraw() 
```

在这些方法上查阅 java.lang.Object 的 javadoc（以及 notifyAll，以防万一）；他们写得很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T16:54:01.420

如果您想要一个更高级别的并发 API（带有 Barriers 之类的东西），您可以尝试 java 5 并发 API 的反向移植，它适用于 java 1.3 及更高版本，并且可能适用于 Android。Object.wait/notify 之类的东西会起作用，但它们可能有点简洁。

[Backport-util-concurrent](http://backport-jsr166.sourceforge.net/)

# windows - 用于 Windows/IIS 的免费（经济实惠）基于 Web 的远程管理？

> ID：121765
> 
> 赞同：1
> 
> 时间：2008-09-23T15:32:29.960
> 
> 标签：windows, iis, administration, web-based

我一直在使用：

[Webmin](http://www.webmin.com)免费，仅限 Apache

[Cpanel](http://www.cpanel.net)付费，我相信只有 Apache

[Plesk](http://www.parallels.com/plesk/)付费，支持 IIS

最近在我们的 Windows/IIS 机器上管理站点已成为一件苦差事。安装、配置、监控；大部分都是手工完成的，随着时间的推移，我们编写了一堆乱七八糟的脚本。

有谁知道在这种环境中工作的类似于上述的任何工具？

编辑：我们现在正在使用远程桌面，问题是我们并不总是知道哪个网站在哪台机器上......是的，这更像是一个内部问题。但是拥有一个具有管理能力的资源会很棒，它不仅可以设置/配置站点，还可以执行 ftp 帐户、电子邮件帐户、磁盘配额管理等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T16:04:05.797

这并不完全是您所追求的（我认为），但是如果您虚拟化您的 Windows/IIS 环境，并在 Microsoft Virtual Server 上运行它们，这将为您提供一个基于 Web 的远程管理界面。

不完全符合您列出的示例，但仍然......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T16:16:52.243

远程桌面？我们有 300 多台服务器，而我们的 IT 部门只使用远程桌面。也许我错过了问题的重点？你只是想操纵 IIS 对吧？地狱，如果这就是全部，您可以使用 Microsoft 的管理工具包并连接到服务器的 IIS 实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T23:18:01.787

如果您可以使用 IIS 7.0，那么有一些非常酷的[远程处理](http://learn.iis.net/page.aspx/97/managing-iis7-remotely/)工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T02:21:01.067

我从来没有遇到过。从来没有想过要问一个，所以我很高兴我遇到了你的问题。希望有人知道一些事情。

我曾经工作过/合作过的一些公司也有同样的问题：许多 Web 服务器、过时的文档（或没有文档）以及完成任何事情的时间很少。

我通常只是创建了将它们的信息导出到 xml 文件的脚本。Microsoft 有一个不错的 IIS 6 脚本存储库（不过，如果您运行的是 Win2003 之前的版本，那么您就不走运了）： http: [//www.microsoft.com/technet/scriptcenter/scripts/iis/iis6/default.mspx?出厂=真](http://www.microsoft.com/technet/scriptcenter/scripts/iis/iis6/default.mspx?mfr=true)

# c++ - 内存占用最少的 STL 实现是什么？

> ID：121787
> 
> 赞同：3
> 
> 时间：2008-09-23T15:35:31.700
> 
> 标签：c++, optimization, stl

我正在开发一个大量使用 STL 的超大规模计算库。该库正在使用 MSVC2003 构建，并且正在使用其 STL 实现。我正在寻找一种替代的 STL 实现，它可以帮助库降低其内存需求并提高其性能。

目前无法切换到更新版本的 MSVC。

如果可能的话，我希望得到一些关于不基于基准的实际使用情况的反馈。

编辑：为了让它更清楚一点，例如一些 STL 实现（如 STLSoft）正在为字符串连接提出特定的优化；这些可能听起来影响很小，但它们可以带来很大的改进。STLPort 是另一个很好的例子，他们清楚地说明了他们的目标：拥有最快的 STL 实现，有 stdlib++ 等......所有这些都可以是很好的候选者，但我没有时间测试它们，我需要一些社区帮助在那。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T15:39:59.630

[STL端口](http://stlport.org/)。没有测量内存使用差异，但它肯定更快（是的，现实世界的使用）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T15:42:47.957

我质疑您的基本前提，即您不能切换到更新版本的 MSVC。

我认为您不会通过下载新的 STL 来“免费”降低内存并提高性能。或者至少，如果你这样做了，你可能不得不做尽可能多的代码修复，就像你只是更新到最新的 MSVC 一样。

从长远来看，毫无疑问您想更新......现在就去做，您**可能**会很幸运，并免费获得一些内存和性能。

根据您所说的您正在寻找的内容，我能想到的唯一建议是尝试英特尔编译器，我有过好的（性能！）和坏的（古怪，有时！）经验和。

除此之外，找到您自己的内存和性能问题，并编写自定义容器和算法。STL 很棒，但它并不是解决所有问题的灵丹妙药。领域知识是您最好的盟友。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T15:53:00.857

您是否考虑过编写自己的内存分配器？如果你只是不喜欢内存分配策略，你并不总是需要切换整个 STL。所有容器都接受替换分配器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-08T22:05:46.787

您是否分析过您的代码并考虑对那些有问题的区域进行小调整？我认为它会比你正在考虑的痛苦少得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-07T21:11:49.213

其中大部分取决于您正在谈论的容器以及您如何使用它。向量通常具有最小的占用空间，除非您添加的元素超出了当前向量的容量。那时它会分配 1.5 x 当前向量容量，移动元素（或者在最坏的情况下制作一个新的副本，同时分配内存），完成后，删除旧的向量内部，如果你知道如何它将保留许多元素，使用保留的矢量是您最好的选择。

第二小的是列表。它的优点是它不会制作自己的临时副本。在那之后，你最好的赌注可能已经成立。一些实现现在有 slist，它更小。在这些情况下， tt 很容易制作一个将内存打包成页面的分配器。远离像 unordered_* 这样的记忆猪

在 MSVC 上确保 #define _SECURE_SCL=0 这会减少用于安全编程检查的大量开销（如缓冲区溢出等）

到目前为止，内存效率最高的容器是 boost/intrusive 这些容器的占用空间非常小，因为它们使用所包含事物的内存。因此，对于链表或 rb 树节点来说，为了一小块内存进入堆，节点指针是对象本身的一部分。那么“容器”只是一个原始的一组几个指针来创建一个根节点。我已经多次使用它来消除占用空间和分配开销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T16:00:05.573

大多数 STL 实现，包括 MSVC2003 之一，都是很好实现的通用库。因此，您不会看到从一种实现到另一种实现的显着性能提升。

但是，有时您可以为您编写比 STL 更快的算法（或容器），因为您知道 STL 编写者没有新的数据（因为他们正在编写通用容器和算法）。

总之，如果您想提高应用程序的性能，最好尝试创建专门适合您数据的容器，而不是寻找性能更高的 STL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T21:52:53.293

如果性能对您的应用程序如此重要，并且 STL 交织在其中，是否有可能找到一个开源实现（例如[STL-Port](http://sourceforge.net/projects/stlport/)，如前所述）并为自己分叉，根据需要进行性能改进？

一方面，我可以看到这变成了一个滑坡，您对 STL 库的分支进行非标准修改，从而产生问题。但是，性能对您的应用程序的重要性可能超过发生这种情况的风险。

# evc - Fix for fatal error C1083

> ID：121788
> 
> 赞同：0
> 
> 时间：2008-09-23T15:35:51.577
> 
> 标签：evc

We have a set of nightly builds that build of full suite of software using Embedded Visual C++ batch files. There is probably a total of 30 builds that are done. Every night at least one or two builds fail with something like the following error:

> c:\lc\trunk\server\can\svcangettracedrivelength.cpp(11) : fatal error C1083: Cannot open precompiled header file: 'SH4Rel/CANWce.pch': Permission denied

It is never the same file or precompile header that fails and it is rarely the same executable. As far as I know nothing else is happening on this build machine.

Does anyone have a fix to make our nightly builds run more reliably?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T15:41:39.613

尝试在可视化 IDE 中运行它；这样会更容易捕捉。

您确定没有多个编译器实例同时处理多个构建吗？一个构建项目/lib/whatever，而另一个试图访问它？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T19:59:53.057

EVC 4.0 是否支持宏？也许作为最后的手段，你可以有一个触发构建的宏:)

我不明白你最后的说法。很明显，问题出在编译时，而不是运行时。

您是否尝试过在没有预编译头文件的情况下进行编译？那有什么错误呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-30T22:38:30.160

遇到了明显相同的问题 - 似乎是由 Microsoft Security Essentials 引起的。我尝试禁用它，它立即解决了问题，此后一直没有恢复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T18:41:26.950

一般来说，在 IDE (EVC++ 4.0) 中运行时我们不会看到此错误。然而，我们不能使用 GUI 运行我们的夜间构建。

据我们所知，构建机器在夜间构建运行时处于空闲状态。

# versioning - 您推荐什么版本编号方案？

> ID：121795
> 
> 赞同：39
> 
> 时间：2008-09-23T15:37:02.197
> 
> 标签：versioning, release-management, sdlc

我的问题是，哪种版本命名方案应该用于什么类型的项目。

非常常见的是major.minor.fix，但即使这样也可能导致4 个数字（即Firefox 2.0.0.16）。有些有一个模型，奇数表示开发人员版本，偶数表示稳定版本。各种添加都可以进入组合，如 -dev3、-rc1、SP2 等。

有理由更喜欢一种方案而不是另一种方案，不同类型的项目（即开源与闭源）是否应该有不同的版本命名方案？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-19T12:40:36.140

对此有**两个**很好的答案（加上很多个人喜好；参见 gizmo 对宗教战争的评论）。

对于**公共**应用程序，该标准`Major.Minor.Revision.Build`最适用于 IMO - 公共用户可以轻松地判断他们拥有的程序版本，以及在某种程度上，他们的版本已经过时了。

对于**内部**应用程序，用户从不要求应用程序，部署由 IT 处理，用户将致电服务台，我发现`Year.Month.Day.Build`在很多情况下工作得更好。因此，可以对该版本号进行解码，以便为帮助台提供比公共版本号方案更有用的信息。

然而，在一天结束的时候，我会提出一个高于一切的建议——**使用一个你可以保持一致的系统**。如果有一个系统可以设置/编写编译器以每次自动使用，请*使用*.

可能发生的最糟糕的事情是您发布的二进制文件与以前的版本号相同 - 我最近一直在处理自动网络错误报告（其他人的应用程序），并得出的结论是 Year.Month.Day。核心转储中显示的构建版本号甚至与应用程序本身没有远程更新（应用程序本身使用带有实数的启动屏幕 - 当然，这不是从二进制文件中提取的，就像人们可能假设的那样）。结果是我无法知道故障转储是来自 2 年前的二进制文件（版本号表示的内容）还是 2 个月前的二进制文件，因此无法获得正确的源代码（也没有源代码控制！ )

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-07-29T15:06:41.237

[我是语义版本控制](http://semver.org/)的忠实粉丝

正如许多其他人所评论的那样，这使用了 XYZ 格式，并给出了很好的理由。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-09-23T15:46:15.607

这是我们在公司中使用的：**Major**。**未成年人**。**补丁版本**。**内部版本号**。

**重大**变化涉及一个完整的发布周期，包括营销参与等。这个数字由研发之外的力量控制（例如，在我工作的一个地方，营销决定我们的下一个版本将是“11” - 以匹配竞争对手。我们当时是第 2 版:))。

**将新功能或主要行为更改添加到产品时会更改**次要更改。****

 ****每次正式向版本添加补丁时，**补丁版本都会增加一个，通常仅包括错误修复。****

 ****当为客户发布特殊版本时使用构建版本**，通常带有特定于他的错误修复。通常，该修复将汇总到下一个补丁或次要版本（并且产品管理通常在我们的跟踪系统中将错误标记为“将为补丁 3 发布”）。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2008-09-23T16:13:46.367

我们研发部门使用1.0.0.0.0.000：MAJOR.minor.patch.audience.critical_situation.build

请，**请**，不要那样做。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-09-23T15:45:53.283

这种问题更多是关于宗教战争而不是客观方面。对于编号方案或其他方案，总是有很多优点和缺点。人们可以（或应该）给您的只是他们使用的方案以及他们选择它的原因。

在我这边，我使用 XYZ 方案，所有这些都是数字，其中：

*   **X**表示公共 API 中引入向后不兼容的更改
*   **Y**表示添加了一些功能
*   **Z**表示修复（要么修复错误，要么在不影响功能的情况下更改内部结构）

最后，如果我想在正式发布之前从用户那里得到一些反馈，我会使用“Beta N”后缀。没有“RC”后缀，因为没有人是完美的，总会有错误 ;-)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-05-05T16:50:31.047

我们更喜欢`major`. `minor`. `milestone`. `revision`-`build`方案，其中：

*   `major`：显着的架构变化或功能的重要进步时的增量。
*   `minor`：不需要架构更改的小更改和新功能。
*   `milestone`：表示代码的稳定性和成熟度：
    *   0 用于开发/pre-alpha
    *   1 代表阿尔法
    *   2 测试版
    *   3 用于发布候选 (RC)
    *   4 用于最终/生产版本
*   `revision`：表示版本、补丁或错误修复编号。
*   `build`：对应用程序的特定构建或版本的唯一引用。内部版本号是一个连续的整数，通常在每次构建时递增。

### 例子：

*   `1.4.2.0-798`: 版本的第一个 beta 版本`1.4`，由内部版本号创建`798`。
*   `1.8.3.4-970`: `1.8-RC4`，由内部版本号创建`970`。
*   `1.9.4.0-986`: 版本的第一个生产版本`1.9`，由内部版本号创建`986`。
*   `1.9.4.2-990`: 版本的第二个错误修正版本`1.9`，由内部版本号创建`990`。

由于生产版本始终具有`4`版本字符串的第 3 位，因此可能会删除该数字以用于生产版本。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-23T15:40:18.883

我个人更喜欢 MAJOR.MINOR.BUGFIX-SUFFIX，其中 SUFFIX`dev`用于开发版本（版本控制检出），`rc1`/`rc2`用于发布候选版本，没有后缀用于发布版本。

如果您有用于开发检查的后缀，甚至可能带有修订号，则无需将它们设置为偶数/奇数以将它们分开。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-11-28T17:16:30.043

对于库，版本号告诉您两个版本之间**的兼容性级别**，以及升级的难度。

错误修复版本需要保留二进制、源代码和序列化兼容性。

次要版本对不同的项目意味着不同的东西，但通常它们不需要保持源代码兼容性。

主要版本号可以打破所有三种形式。

[我在这里](http://motlin.com/2010/how-to-do-version-numbers/)写了更多关于基本原理的文章。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-05-04T20:23:38.237

随着敏捷软件开发实践和 SaaS 应用程序的出现，主要版本与次要版本的概念已经消失——版本非常频繁地定期发布——因此依赖于这种区别的版本编号方案对我不再有用。

我的公司使用一种编号方案，该方案采用发布开始年份的最后 2 位数字，后跟该年份的发布编号。

因此，2012 年开始的第四个版本是 12.4。

如有必要，您可以在其后包含一个“错误修复”版本号，但理想情况下，您发布的频率足够高，以至于这些通常不需要 - 所以“12.4.2”。

这是一个非常简单的方案，并没有给我们带来我之前使用过的其他版本编号方案的任何问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-23T15:44:30.353

封闭和开源版本号政策之间的差异也可能来自**商业方面**，例如主要版本可以反映发布年份。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-23T16:24:06.280

我们以前在这里做的是**major.minor.platform.fix**。

**主要**：当此版本中保存的文件不再与以前的版本兼容时，我们会增加此数字。
*示例*：3.0.0.0 版本中保存的文件将与 2.5.0.0 版本不兼容。

**次要**：添加新功能时，我们会增加此数字。用户应该看到此功能。不是开发人员的隐藏功能。当major 增加时，这个数字被重置为0。

**平台**：这是我们用于开发的平台。
*示例*：1 代表 .net 框架版本 3.5。

**修复**：当这个新版本只包含错误修复时，我们会增加这个数字。当major 或minor 递增时，此数字重置为0。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-20T13:39:38.747

简单地

```
Major.Minor.Revision.Build 
```

# testing - 行为驱动还是测试驱动开发？

> ID：121806
> 
> 赞同：11
> 
> 时间：2008-09-23T15:38:11.057
> 
> 标签：testing, tdd, bdd, agile

我最近听说过 BDD，发现它与 TDD 非常相似。

您使用这两个中的哪一个（如果有）？

各自的优缺点是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-23T16:00:00.630

BDD 与 TDD 类似，但思维方式不同。在 BDD 中，您尝试创建可执行规范而不是测试。这主要是通过使用与 TDD 不同但相似的机制来完成的。

BDD 似乎是对人们声称在做 TDD 但编写集成测试而不是单元测试的许多情况的反应。BDD 的人认为谈论测试具有误导性，因此测试成为规范。这似乎有点形而上学，但背后有一些好主意。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-23T19:28:20.003

我非常喜欢 BDD = TDD 做正确的阵营。如果您按照 Beck 最初描述的方式进行 TDD - 并且被许多人实践 - 那么基本上没有区别。

BDD 带来的是用于描述过程的语言的一些有趣的变体。通过在描述过程和工具中使用替代术语，BDD 人们希望鼓励更好的实践——这是一个值得称赞的目标。

我已经做 TDD 这么久了，我很难判断这是否真的有帮助。我认为（希望 :-) 我已经学到了 BDD 工具/语言所鼓励的许多课程，因此它们似乎并没有为我提供太多额外的价值。当然是 YMMV——而且我还没有使用 BDD 工具完成一个完整的“现实世界”项目——所以我可能会进行我的个人实验并且推断得太远了。

我*猜想*BDD 工具/语言可能对被介绍到这种接近开发方式的人们更有用——因为它们避免了与更传统意义上使用的“测试”的混淆。我自己还没有这样做过——如果这里的人有过这样的经历，我会很感兴趣。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T13:11:19.790

BDD 就是运行场景。与 TDD 类似，我们将测试每个场景作为一个故事。

故事将由客户解释......根据故事情节编写场景。像 CUCUMBER 这样的工具使编写场景变得容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-18T20:38:19.903

TDD 和 BDD 几乎相同。不同之处在于我们如何解释它，因此成功的团队最终如何使它为他们工作。

BDD 通过形式化最佳 TDD 实践者的良好习惯来构建 TDD。TDD 是编写优秀软件的开发人员工具或指南，而 BDD 是帮助外部开发的好工具，因为它是使用通用语言开发的，因此可以更多地参与业务。

我的经验是，BDD 有助于协作，当团队中的每个人都参与编写描述系统应该做什么的文档时，使用业务可读、可执行的规范有助于构建一种共享语言。这有助于整个团队一起学习领域的语言。

BDD 是使 TDD 成功所需要的。

# excel - 如何判断 Excel 工作簿是否受保护

> ID：121808
> 
> 赞同：4
> 
> 时间：2008-09-23T15:38:27.933
> 
> 标签：excel, password-protection, worksheet, vba

我可以使用 Excel 工作表的属性来判断工作表是否受保护（Worksheet.Protection、Worksheet.ProtectContents 等）。

如何使用 VBA 判断整个工作簿是否已受到保护？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-23T15:53:37.460

自己找到了答案：

我需要`Workbook.ProtectStructure`和`Workbook.ProtectWindows`属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:44:17.703

Worksheet.ProtectedContents 是您需要在每个工作表上使用的内容。

所以我会设置一个这样的循环：

```
Public Function wbAllSheetsProtected(wbTarget As Workbook) As Boolean 

Dim ws As Worksheet 

wbAllSheetsProtected = True

For Each ws In wbTarget.Worksheets 
    If ws.ProtectContents = False Then 
        wbAllProtected = False
        Exit Function 
    End If 
Next ws 

End Function 
```

如果每个工作表都受到保护，该函数将返回 True，如果有任何工作表不受保护，则返回 False。我希望这就是你要找的。

# vba - 从 Outlook 2007 中删除右键单击打印上下文菜单

> ID：121810
> 
> 赞同：6
> 
> 时间：2008-09-23T15:38:41.867
> 
> 标签：vba, outlook, outlook-2007

**当您右键单击带有 VBA 的电子邮件时，有什么方法可以从上下文菜单中删除“打印”项？**

我总是右键单击以回复电子邮件，只是意外单击`Print`并让 Outlook 将其直接发送到打印机，速度比我阻止它的速度更快。

![替代文字](https://farm4.static.flickr.com/3221/2882658372_496d6e7a11_o.jpg)

**注意：**我使用的是 Outlook 2007。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-24T14:57:31.363

根据 TcKs 提供的链接，这非常简单。在下面的示例中，我检查了项目的类型，以便它只影响电子邮件而不影响日历项目。要在 Outlook 中输入代码，请键入 Alt + F11，然后在“项目”窗格中展开 Microsoft Office Outlook 对象。然后双击 ThisOutlookSession。然后将此代码粘贴到代码窗口中。我不喜欢检查这样的字幕，因为您可能会遇到国际化问题。但我没有在命令上看到 ActionID 或任何内容。有一个 FaceID，但这只是打印机图标的 ID。

```
Private Sub Application_ItemContextMenuDisplay(ByVal CommandBar As Office.CommandBar, ByVal Selection As Selection)

   Dim cmdTemp As Office.CommandBarControl

   If Selection.Count > 0 Then

      Select Case TypeName(Selection.Item(1))

         Case "MailItem"

            For Each cmdTemp In CommandBar.Controls

               If cmdTemp.Caption = "&Print" Then

                  cmdTemp.Delete
                  Exit For

               End If

            Next cmdTemp

         Case Else

            'Debug.Print TypeName(Selection.Item(1))

      End Select

   End If

End Sub 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-23T15:52:04.453

Thera 是如何以编程方式使用 Outlook 的示例： [如何：自定义项目上下文菜单](http://msdn.microsoft.com/en-us/library/bb176426.aspx)

# scripting - 如何使用 Inno Setup 根据注册表项选择在文件夹中安装插件/文件？

> ID：121812
> 
> 赞同：2
> 
> 时间：2008-09-23T15:38:44.313
> 
> 标签：scripting, registry, inno-setup

[Inno Setup](http://www.jrsoftware.org/isinfo.php)是一个很好的易于使用的安装程序。[在这个 stackoverflow 问题](https://stackoverflow.com/questions/3767/what-is-the-best-choice-for-building-windows-installers#3769)中它的评价很高。我需要将插件安装到与 3rd 方应用程序的安装文件夹相关的文件夹中。从文档中如何做到这一点并不明显。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T18:32:38.110

您可以在文档和示例代码中找到如何使用注册表项选择性地安装文件的答案，但这可能并不明显，因此这里有一些示例脚本片段，使用 Adob​​e Premiere 插件作为示例：

关键步骤是：

1) 使用 Check: 参数

2）编写一个调用RegQueryStringValue的函数并解析路径以构造相对插件文件夹目的地

3) 使用 {code:} 调用函数返回目标文件夹

```
//
// Copy my plugin file to the Premiere Plugin folder, but only if Premiere is installed.
//
[Files]
Source: "C:\sourceFiles\myplugin.prm";  Check: GetPremierePluginDestination; DestDir: "{code:PluginDestination}"; Flags: ignoreversion overwritereadonly

[Code]

var sPluginDest : String;

//
// Search for the path where Premiere Pro was installed.  Return true if path found.
// Set variable to plugin folder
//

function GetPremierePluginDestination(): Boolean;
var
  i:      Integer;
  len:    Integer;

begin
  sPluginDest := '';

  RegQueryStringValue( HKLM, 'SOFTWARE\Adobe\Premiere Pro\CurrentVersion', 'Plug-InsDir', sPluginDest );
  len := Length(sPluginDest);
  if len > 0 then
  begin
    i := len;
    while sPluginDest[i] <> '\' do
      begin
        i := i-1;
      end;

    i := i+1;
    Delete(sPluginDest, i, Len-i+1);
    Insert('Common', sPluginDest, i);
  end;
  Result := len > 0;
end;

//
//  Use this function to return path to install plugin
//
function PluginDestination(Param: String) : String;
begin
   Result := sPluginDest;
end; 
```

我不是 Pascal 程序员，因此欢迎提出有关使 GetPremiereDestination 更高效的任何建议。

# c# - 如何通过 ASP.NET 重定向和修改无扩展名 URL？

> ID：121813
> 
> 赞同：4
> 
> 时间：2008-09-23T15:38:54.890
> 
> 标签：c#, .net, iis, configuration, routing

我们已将结构重新设计为具有多个业务部门的网站。现在我想将（301）重定向到新页面。

IE：
是 www.example.com/abc
现在是 www.example.com/default.aspx?article=abc

我曾尝试使用 Global.asax 来执行此操作，并且当我通过它进行调试时它可以正常工作。

```
 if (Request.RawUrl.Contains("abc"))
        {
            Response.RedirectLocation = "/default.aspx?article=abc";
            Response.StatusCode = 301;
            Response.StatusDescription = "Moved";
            Response.End();
        } 
```

所以[http://localhost:1234/example/abc](http://localhost:1234/example/abc)正确重定向，但是（其中 1234 是调试服务器的端口）
[http://localhost/example/abc](http://localhost/example/abc)没有重定向，它给了我一个 404。

有任何想法吗？

* * *

附加信息：如果我去[http://localhost/example/abc/default.aspx](http://localhost/example/abc/default.aspx)那么它会正确重定向。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T15:46:15.560

好吧，如果端口表明您正在使用内置的 Web 服务器（VS 附带的服务器），这可能会起作用，因为它*总是*通过 ASP.NET 框架路由请求。

以 /abc 结尾的请求不会自动通过 ASP.NET 框架，因为 IIS 可能不“知道”您想要它们。您需要检查 IIS 设置以确保将此类请求路由到 aspnet_isapi.dll

* * *

**编辑：**为此，您需要添加[**通配符映射**](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx)：

1.  在 IIS 管理器中，展开本地计算机，展开网站文件夹，右键单击所需的网站或虚拟目录，然后单击属性。
2.  单击相应的选项卡：主目录、虚拟目录或目录。
3.  在应用程序设置区域中，单击配置，然后单击映射选项卡。
4.  要安装通配符应用程序映射，请执行以下操作：
    *   在映射选项卡上，单击添加或插入。
    *   在 Executable 文本框中键入 DLL 的路径或单击 Browse 导航到它（例如，ASP.NET 2.0 dll 位于我的 c:\windows\microsoft.net\framework\v2.0.50727\aspnet_isapi.dll机器）
    *   对于扩展名，当然可以使用不带引号的“.*”
    *   选择要查找的动词（GET、HEAD、POST、DEBUG 是 ASP.NET 常用的，由您决定）
    *   确保选择“脚本引擎”或“应用程序引擎”
    *   取消选中“检查文件是否存在”
    *   点击确定。

我可能对此不以为然，但如果我是，希望有人能纠正我。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:51:18.030

你应该使用 IIS 通配符重定向，你需要这样的东西；

```
 *; www.example.com/*; www.example.com/default.aspx?article=$0 
```

[微软](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/41c238b2-1188-488f-bf2d-464383b1bb08.mspx?mfr=true)有一个合理的参考

如果您使用的是 Apache，我认为您需要修改 htaccess 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:43:47.470

您当前是否在 Visual Studio Web 服务器中测试该站点？这通常在“localhost:nnnnn”上运行站点，其中“nnnnn”是一个端口号（如上为 1234），它不会将其设置为在没有端口号的情况下运行。

如果您在相关机器上安装了 IIS，请将您的项目发布到它，您应该能够验证它是否可以在没有“nnnnn”的情况下工作，因为您的代码中看起来没有任何东西会导致它无法运行这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T15:42:42.713

您是否确保每个网站的 web.config 文件都相同（假设：1234 与 :80 不同）

另外，你试过 localhost:80 吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T15:46:14.577

也许您想看看**Routing**。

看：

*   [http://msdn.microsoft.com/en-us/library/cc668201.aspx](http://msdn.microsoft.com/en-us/library/cc668201.aspx)
*   [http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx](http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T15:46:42.253

您的[http://localhost/example/abc](http://localhost/example/abc)没有像您期望的那样调用 Global.asax。通常[http://localhost](http://localhost)在端口 80 (:80) 上运行。如果您想在端口 80 上运行您的站点，您需要在 IIS 中部署您的站点才能在此处运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T15:49:20.280

您需要在 IIS 中设置一个 Handler 映射，以将所有未知扩展转发到 asp.net。第一个有效，因为 cassini 正在处理所有请求，第二个无效，因为 IIS 正在寻找该目录，并且它不存在，而不是运行您拥有的代码的 .net 框架。

这是有关如何[在 asp.net 中进行 URL 重写](http://msdn.microsoft.com/en-us/library/ms972974.aspx)的信息。

如果可能的话，我建议使用新的[Application Request Routing](http://www.hanselman.com/blog/NewModulesForIIS7ApplicationRequestRoutingProxyAndLoadBalancingModule.aspx)或[UrlRewrite.net](http://www.urlrewriting.net/149/en/home.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T19:16:58.830

默认情况下，IIS 不会将所有请求都交给 ASP.NET 进行处理。只有一些资源扩展，其中“aspx”会被传递给asp.net进行处理。当您请求[http://localhost/example/abc](http://localhost/example/abc)时发生的情况是 IIS 尝试定位目录以查看您是否有要从该目录加载的默认文件（即 default.aspx、index.html）。由于它找不到包含垃圾“abc”标签的目录，因此它永远找不到要加载的 default.aspx 文件。

当您尝试加载[http://localhost/example/abc/default.aspx](http://localhost/example/abc/default.aspx)时，IIS 会看到“aspx”扩展名并立即将其交给 ASP.NET 运行时进行处理。[http://localhost/example/abc](http://localhost/example/abc)请求没有加载的原因是它永远不会被交给 ASP.NET，所以当然 global.asax 永远不会看到它。

Cassini 托管站点处理所有请求，因此该调用确实由 ASP.NET 和 global.asax 文件处理。

我同意 Darren Kopp 的观点，他建议您需要在 IIS 中设置处理程序映射以将未知扩展转发到 ASP.NET。

# javascript - 如何替换 div 元素中的文本？

> ID：121817
> 
> 赞同：186
> 
> 时间：2008-09-23T15:39:39.930
> 
> 标签：javascript, html, dom

我需要动态设置 DIV 元素中的文本。什么是最好的、浏览器安全的方法？我有prototypejs 和scriptaculous 可用。

```
<div id="panel">
  <div id="field_name">TEXT GOES HERE</div>
</div> 
```

下面是函数的样子：

```
function showPanel(fieldName) {
  var fieldNameElement = document.getElementById('field_name');
  //Make replacement here
} 
```

* * *

## 回答 #1

> 赞同：273
> 
> 时间：2008-09-23T15:41:08.070

您可以简单地使用：

```
fieldNameElement.innerHTML = "My new text!"; 
```

* * *

## 回答 #2

> 赞同：209
> 
> 时间：2013-09-10T15:30:02.337

**为 2013 年及以后阅读此内容的所有人更新：**

这个答案有很多 SEO，但所有答案都严重过时，并且依赖于库来做所有当前浏览器开箱即用的事情。

[要替换 div 元素内的文本，请使用所有当前浏览器中都提供的 Node.textContent。](https://developer.mozilla.org/en-US/docs/Web/API/Node.textContent#Browser_compatibility)

```
fieldNameElement.textContent = "New text"; 
```

* * *

## 回答 #3

> 赞同：78
> 
> 时间：2008-09-23T15:52:00.383

```
 function showPanel(fieldName) {
  var fieldNameElement = document.getElementById("field_name");
  while(fieldNameElement.childNodes.length >= 1) {
    fieldNameElement.removeChild(fieldNameElement.firstChild);
  }
  fieldNameElement.appendChild(fieldNameElement.ownerDocument.createTextNode(fieldName));
} 
```

这样做的好处是：

1.  它只使用 DOM，因此该技术可以移植到其他语言，并且不依赖于非标准的 innerHTML
2.  fieldName 可能包含 HTML，这可能是一次未遂的 XSS 攻击。如果我们知道它只是文本，我们应该创建一个文本节点，而不是让浏览器将其解析为 HTML

如果我要使用 javascript 库，我会使用 jQuery，并执行以下操作：

```
 $("div#field_name").text(fieldName); 
```

请注意，[@AnthonyWJones 的评论](https://stackoverflow.com/questions/121817/replace-text-inside-a-div-element#comment27322_121898)是正确的：“field_name”不是一个特别具有描述性的 id 或变量名。

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2008-09-23T15:46:04.377

我会使用 Prototype 的`update`方法，它支持纯文本、HTML 片段或任何定义`toString`方法的 JavaScript 对象。

```
$("field_name").update("New text"); 
```

*   [Element.update 文档](http://www.prototypejs.org/api/element/update)

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-09-23T15:41:01.563

```
$('field_name').innerHTML = 'Your text.'; 
```

Prototype 的一个很好的特性是它`$('field_name')`与`document.getElementById('field_name')`. 用它！:-)

John Topley 使用 Prototype's `update`function 的回答是另一个很好的解决方案。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-09-23T15:48:50.483

快速的答案是使用innerHTML（或原型的更新方法，几乎​​相同的东西）。innerHTML 的问题是您需要转义分配的内容。根据您的目标，您需要使用其他代码或

在 IE 中：-

```
document.getElementById("field_name").innerText = newText; 
```

在FF中：-

```
document.getElementById("field_name").textContent = newText; 
```

（实际上FF的代码中有以下内容）

```
HTMLElement.prototype.__defineGetter__("innerText", function () { return this.textContent; })

HTMLElement.prototype.__defineSetter__("innerText", function (inputText) { this.textContent = inputText; }) 
```

现在，如果您需要尽可能广泛的浏览器支持，我可以只使用 innerText ，那么这不是一个完整的解决方案，但也不是在 raw 中使用 innerHTML。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-23T15:41:25.383

如果你真的希望我们从你离开的地方继续，你可以这样做：

```
if (fieldNameElement)
    fieldNameElement.innerHTML = 'some HTML'; 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2010-07-26T21:17:11.403

nodeValue 也是您可以使用的标准 DOM 属性：

```
function showPanel(fieldName) {
  var fieldNameElement = document.getElementById(field_name);
  if(fieldNameElement.firstChild)
    fieldNameElement.firstChild.nodeValue = "New Text";
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-11-24T17:07:03.290

```
el.innerHTML='';
el.appendChild(document.createTextNode("yo")); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-23T15:53:48.647

如果您倾向于在您的网站上开始使用大量 JavaScript，那么 jQuery 可以让您使用 DOM 变得非常简单。

[http://docs.jquery.com/Manipulation](http://docs.jquery.com/Manipulation)

使它变得如此简单： $("#field-name").text("Some new text.");

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-05-27T03:49:06.587

如果您不能假设结构，请使用 innerText - 使用 Text#data 更新现有文本 [性能测试](https://twitter.com/_developit/status/997132016612270081)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-23T15:47:59.067

```
function showPanel(fieldName) {
  var fieldNameElement = document.getElementById(field_name);

  fieldNameElement.removeChild(fieldNameElement.firstChild);
  var newText = document.createTextNode("New Text");
  fieldNameElement.appendChild(newText);
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-02-24T13:22:35.500

这是一个简单的[jQuery](http://jquery.com/)方法：

```
var el = $('#yourid .yourclass');

el.html(el.html().replace(/Old Text/ig, "New Text")); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-05-09T04:44:53.313

在 HTML 中把这个

```
<div id="field_name">TEXT GOES HERE</div> 
```

在Javascript中把这个

```
var fieldNameElement = document.getElementById('field_name');
        if (fieldNameElement)
        {fieldNameElement.innerHTML = 'some HTML';} 
```

# sql - 在视图上设置关键字段

> ID：121821
> 
> 赞同：1
> 
> 时间：2008-09-23T15:40:27.383
> 
> 标签：sql, view, ibm-midrange

我正在为删除特定字段中的空格的文件创建 SQL 视图。我的问题是，是否有理由在该新视图上设置密钥，以便人们仍然可以 CHAIN 文件。我们在 V5R3 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T16:06:31.830

好的，在[http://archive.midrange.com/midrange-l/200809/msg01062.html](http://archive.midrange.com/midrange-l/200809/msg01062.html)找到了答案。

在 V5R3 中是不可能的。据说在 V6R1 中这是可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-29T16:13:45.730

你能用一个逻辑文件或一个`OPNQRYF`语句来完成同样的事情吗？这两者都允许您设置关键字段，并且可能能够去除文件中的空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:54:32.297

你能复制一个去掉空格的字段吗？您可以使用文件触发器更新剥离的副本。然后在删除的字段副本上创建一个索引/逻辑文件。

# wcf - 使用带有 WCF 开发的 IBM DataPower ESB 有任何问题吗？

> ID：121827
> 
> 赞同：1
> 
> 时间：2008-09-23T15:41:41.360
> 
> 标签：wcf, soa, esb, ibm-datapower

我正在寻找实现 ESB 并希望了解与“如何”我的 Web 服务可能会发生变化 (WCF) 相关的想法，或者 - 我的使用这些服务的客户端应用程序可能如何“需要修改”（ - 除了ESB 路径的新服务引用 --)

我正在使用的设备是“WebSphere DataPower XML Security Gateway XS40”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T02:08:27.203

假设我要为我的 wcf 服务使用 basichttpbinding，这是因为我要使用 MTOM 编码来传输文档。MTOM 编码传输只能通过 basichttpbinding 完成。那么在这种情况下，由于 DP 强制执行 WS-*，我会遇到 IDB 数据能力问题吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T17:25:14.613

我假设您选择 XS40（黄色）作为网关的安全方面。那就是强制执行 WS-Security、WS-Policy 等。虽然可以将 datapower 盒配置为支持这些，但您的消息必须包含 WS-Security 标头信息。

此信息通常位于 soap Header 的 Secuity 块中，并且可以保存签名、rsa 密钥、用户名令牌或 x509 证书。

有关 WS-Security 的更多信息可以在[1.0 规范](http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf)中找到。（请记住，不同的 ESB“产品”可能会为不同版本的规范提供支持。）

现在，如果您只是想使用 Datapower 盒进行基于内容的路由（或代理 Web 服务消息），您需要确保您的消息嵌入了足够的信息，以便 datapower 盒将该消息路由到正确的服务。

因此，假设您的 WCF 通信配置为使用肥皂消息（而不是二进制 .net 远程处理），datapower 应该不会有任何问题来破译您的消息（xpath）中的内容并适当地路由。

# asp.net - 网格视图、分页和“未设置对象引用”错误的问题

> ID：121828
> 
> 赞同：3
> 
> 时间：2008-09-23T15:41:47.130
> 
> 标签：asp.net, gridview

我遇到了以下问题。我正在尝试实现一个基本的 GridView 分页结果集，它连接到 Oracle 数据库。GridView 和分页结果本身可以正常工作。当我尝试将它放在我们工作的页面布局类中时，问题就来了。

我们有 ClassA，它继承自 Page，是一个企业标准。然后我有 ClassB，它继承自 ClassA 并包含特定于应用程序的代码。GridView 所在的页面继承自 ClassB。这一切似乎在其他页面上都可以正常工作，我认为这不是问题的根源，但我想我会提到它。

发生的情况是，第一次加载 GridView 的页面时，一切看起来都很正常。查询运行并显示前 10 条记录，下面是用于分页的数字。当我单击“2”或任何其他页面时，我会看到“黄屏死机”并显示以下消息：“对象引用未设置为对象的实例”。该错误行中引用的对象是“我”，即页面对象（调试器中的 ASP.pagename_aspx）。我不相信它失败的确切行是那么重要，因为我已经改变了一些语句的顺序，它只是在最早的一个上失败了。

我已经使用调试器进行了跟踪，它看起来很正常，只有在第 1 页上它工作正常，而在第 2 页上它失败了。

我已经实现了 PageIndexChanging 事件（同样，如果我从 ClassB 中删除继承，它会自行工作。另外，如果我尝试直接从 ClassA 继承（完全绕过 ClassB），我仍然会遇到问题。

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-23T15:47:26.510

我遇到了类似的情况，其中基（在您的示例中为 ClassA）具有设置为处理所有分页和排序位的变量，并且 GridView 连接到使用这些变量的事件。没有在我的页面中设置正确的基类变量会导致完全相同的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T16:05:42.080

当我过去遇到类似问题时，通常是数据绑定问题（没有在正确的时间调用 DataBind()，因此当它尝试查看下一页时，DataSource 为空）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-12T20:42:43.497

我同意@DotNetDaddy 的观点，因为您需要确保在回发时设置数据源，因为这几乎肯定是“有趣”的黄屏死机的原因。下面是一个非常简单的示例，显示了 .NET 2.0+ 中 GridView 的排序和分页

以下是此 gridview 使用我的 vb 代码正常工作所需的确切标记

```
<asp:GridView ID="gridSuppliers" EnableViewState="false" runat="server" OnPageIndexChanging="gridSuppliers_PageIndexChanging" AutoGenerateColumns="false" AllowPaging="true" AllowSorting="true" CssClass="datatable" CellPadding="0" CellSpacing="0" BorderWidth="0" GridLines="None">...</asp:GridView> 
```

接下来是代码隐藏文件，其中包含基于集合的数据绑定所需的排序/分页实现

```
Partial Public Class _Default
    Inherits System.Web.UI.Page
    Implements ISupplierView

    Private presenter As SupplierPresenter

    Protected Overrides Sub OnInit(ByVal e As System.EventArgs)
        MyBase.OnInit(e)
        presenter = New SupplierPresenter(Me)
    End Sub

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        presenter.OnViewLoad()
    End Sub

    Protected Sub gridSuppliers_PageIndexChanging(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewPageEventArgs) Handles gridSuppliers.PageIndexChanging
        gridSuppliers.PageIndex = e.NewPageIndex
        presenter.PopulateSupplierList()
    End Sub

    Private Sub gridSuppliers_Sorting(ByVal sender As Object, ByVal e As GridViewSortEventArgs) Handles gridSuppliers.Sorting
        If DirectCast(ViewState("PreviousSortExpression"), String) = e.SortExpression Then
            If DirectCast(ViewState("PreviousSortDirection"), String) = "Ascending" Then
                e.SortDirection = System.Web.UI.WebControls.SortDirection.Descending
                ViewState("PreviousSortDirection") = "Descending"
            Else
                e.SortDirection = System.Web.UI.WebControls.SortDirection.Ascending
                ViewState("PreviousSortDirection") = "Ascending"
            End If
        Else
            e.SortDirection = System.Web.UI.WebControls.SortDirection.Ascending
            ViewState("PreviousSortDirection") = "Ascending"
        End If
        ViewState("PreviousSortExpression") = e.SortExpression

        Dim gv As GridView = DirectCast(sender, GridView)
        If e.SortExpression.Length > 0 Then
            For Each field As DataControlField In gv.Columns
                If field.SortExpression = e.SortExpression Then
                    ViewState("PreviousHeaderIndex") = gv.Columns.IndexOf(field)
                    Exit For
                End If
            Next
        End If
        presenter.PopulateSupplierList()
    End Sub

#Region "ISupplierView Properties"
    Private ReadOnly Property PageIsPostBack() As Boolean Implements ISupplierView.PageIsPostBack
        Get
            Return Page.IsPostBack
        End Get
    End Property

    Private ReadOnly Property SortExpression() As String Implements ISupplierView.SortExpression
        Get
            If ViewState("PreviousSortExpression") Is Nothing Then
                ViewState("PreviousSortExpression") = "CompanyName"
            End If
            Return DirectCast(ViewState("PreviousSortExpression"), String)
        End Get
    End Property

    Public ReadOnly Property SortDirection() As String Implements Library.ISupplierView.SortDirection
        Get
            If ViewState("PreviousSortDirection") Is Nothing Then
                ViewState("PreviousSortDirection") = "Ascending"
            End If
            Return DirectCast(ViewState("PreviousSortDirection"), String)
        End Get
    End Property

    Public Property Suppliers() As System.Collections.Generic.List(Of Library.Supplier) Implements Library.ISupplierView.Suppliers
        Get
            Return DirectCast(gridSuppliers.DataSource(), List(Of Supplier))
        End Get
        Set(ByVal value As System.Collections.Generic.List(Of Library.Supplier))
            gridSuppliers.DataSource = value
            gridSuppliers.DataBind()
        End Set
    End Property
#End Region

End Class 
```

最后，代码隐藏中使用的演示者类

```
Public Class SupplierPresenter
    Private mView As ISupplierView
    Private mSupplierService As ISupplierService

    Public Sub New(ByVal View As ISupplierView)
        Me.New(View, New SupplierService())
    End Sub

    Public Sub New(ByVal View As ISupplierView, ByVal SupplierService As ISupplierService)
        mView = View
        mSupplierService = SupplierService
    End Sub

    Public Sub OnViewLoad()
        If mView.PageIsPostBack = False Then
            PopulateSupplierList()
        End If
    End Sub

    Public Sub PopulateSupplierList()
        Try
            Dim SupplierList As List(Of Supplier) = mSupplierService.GetSuppliers()
            SupplierList.Sort(New GenericComparer(Of Supplier)(mView.SortExpression, mView.SortDirection))
            mView.Suppliers = SupplierList
        Catch ex As Exception
            Throw ex
        End Try
    End Sub
End Class 
```

**对演示者中引用的通用集合进行排序所需的类

```
Imports System.Reflection
Imports System.Web.UI.WebControls

Public Class GenericComparer(Of T)
    Implements IComparer(Of T)

    Private mDirection As String
    Private mExpression As String

    Public Sub New(ByVal Expression As String, ByVal Direction As String)
        mExpression = Expression
        mDirection = Direction
    End Sub

    Public Function Compare(ByVal x As T, ByVal y As T) As Integer Implements System.Collections.Generic.IComparer(Of T).Compare
        Dim propertyInfo As PropertyInfo = GetType(T).GetProperty(mExpression)
        Dim obj1 As IComparable = DirectCast(propertyInfo.GetValue(x, Nothing), IComparable)
        Dim obj2 As IComparable = DirectCast(propertyInfo.GetValue(y, Nothing), IComparable)
        If mDirection = "Ascending" Then
            Return obj1.CompareTo(obj2)
        Else
            Return obj2.CompareTo(obj1)
        End If
    End Function
End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T20:05:18.877

我丢失了用于发布此问题的原始未注册登录名。

无论如何，哈珀谢尔比的回答被证明是正确的。该基类中有一个未设置的变量（我们公司标准的自定义对象）导致了问题（并且没有有用的错误消息）。

如果管理员或具有正确权力的人看到此内容，您可以将 Harper 的答案标记为该答案，然后关闭它。感谢大家的帮助。

# sql-server - SQL Server 2005：从 SQL Server 2000 导入数据

> ID：121837
> 
> 赞同：0
> 
> 时间：2008-09-23T15:43:34.507
> 
> 标签：sql-server, sql-server-2005, sql-server-2000

在 SQL Server 2000 中，您有“所有任务... - 导出数据”选项。SQL Server 2005 Management Studio 这个选项在哪里？

或者，有没有一种 SQL Server 2005 方法可以做到这一点？

编辑：我使用的是 Express 版本。

编辑：乔尔的回答回答了我的问题，但迈克的回答为我们这些使用特快版的人提供了一个很好的选择（投票给他！！）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T15:58:09.870

您可以使用出色的 SQL Server 数据库发布向导。

[http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)

它允许您生成包含数据、模式或两者的脚本。该脚本可以针对 SQL 2000 或 SQL 2005。

有些人将它用于网络托管环境。当我别无选择时，我用它来移动数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-23T15:45:37.667

如果您使用的是管理工作室的快速版，则导入和导出功能不可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:44:18.233

在商业智能方面，DTS 已被 SSIS 取代。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T16:11:43.160

可能最简单的方法是在 SQL 2000 中进行备份，然后使用还原将备份导入 SQL 2005。这些选项在 Express Edition 中可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T16:29:30.200

总是有 BCP 选项。

# agile - 您使用什么软件开发流程？

> ID：121839
> 
> 赞同：3
> 
> 时间：2008-09-23T15:44:13.163
> 
> 标签：agile, feature-driven

我一直使用敏捷的[功能驱动开发](http://en.wikipedia.org/wiki/Feature_Driven_Development)流程来开发软件。其他人都用什么，你为什么喜欢它？我更喜欢 FDD，因为那是我刚从大学毕业时开始的。在大学里，一切都非常自由，我的“客户”通常是我的教授，除了为大学做研究之外，他可能没有太多的行业经验。

现在，我的客户不那么宽容了，我在医疗领域做了很多工作。敏捷和高质量是必须的！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-24T09:39:45.480

在工作中，我们使用 ICONIX 流程。它是敏捷技术的一个子集，并且是行为需求驱动的。ICONIX 流程的目标是尽可能少地使用尽可能少的文档 - 以便让您轻松保持最新（这与其他 AGILE 流程有很大不同，例如 XP 从业者经常这样做在第一稿声称他们的代码*是*文档之后，似乎没有保持文档是最新的）。

以下是该过程的实际概述：

1.  功能需求速写
2.  领域模型的快速定义
3.  在前面步骤的基础上建模用例
4.  可选 - 为每个用例绘制一个一次性的健壮性图，以了解您的类之间的关系
5.  为每个用例绘制序列图
6.  在用例上为您的测试用例建模
7.  实施
8.  测试

在每个步骤中，您都会从整体上回顾您的工作，更新您的领域模型（不可能第一次就正确）并为您的用例添加评论。到第 5 步结束时，您将获得准备好实现的类和逻辑，如果您重构或更改任何内容，只需维护很少的文档：

*   用例图
*   每个用例的序列图
*   测试用例图（或测试计划）

如果您需要添加功能，请添加新用例并遵循整个过程。

资源：

[Iconix 流程网站](http://iconixprocess.com/)

[Iconix 软件工程网站](http://www.iconixsw.com/)

书籍参考：

[使用 ICONIX 流程进行敏捷开发](https://rads.stackoverflow.com/amzn/click/com/1590594649)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-23T15:58:14.643

结合 XP 工程实践的敏捷开发方法：

*   TDD 与重构相结合
*   YAGNI（你不需要它）
*   KISS（保持简单愚蠢）
*   重构设计模式
*   使用开关对进行配对编程
*   共享代码库
*   尽早并经常部署

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-23T15:59:51.970

无论当前项目需要什么。

我利用自己的时间为各种（主要是基于 PHP 的）Web 开发提供了很多咨询。我还没有为这些项目投入时间来了解 TDD，而且他们中的许多人都在使用现有的框架，这些框架并没有真正让 TDD 变得那么容易。

在工作中，我们还没有为 TDD 提供工具，因此我们使用了敏捷和旧式基于规范的流程的混合体。试图向 TDD 迈进，但我们是一家小商店，拥有根深蒂固的现有项目（大量维护工作）以及与 ERP 系统的集成工作。我认为我可以让 TDD 继续我自己的集成工作（并且正在朝那个方向迈出一小步），但其他事情在很大程度上是一个失败的原因。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-23T15:49:11.123

我选择**敏捷 Scrum**，它让我感觉“与团队紧密相连”。并且对里程碑和个人任务有很好的控制。早上的 scrums 非常有用。我们[在 Team System 中使用敏捷 Scrum 项目模板](http://www.scrumforteamsystem.com/en/default.aspx) [http://www.scrumforteamsystem.com/en/default.aspx](http://www.scrumforteamsystem.com/en/default.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-23T16:07:41.187

这里似乎有些混乱：

TDD 更多的是关于如何*实现*代码，而不是关于管理软件项目的整体开发。TDD 不会帮助您决定要安排哪些功能、何时交付或如何设置优先级。

相比之下，精益/敏捷甚至瀑布之类的事情都是关于这些更高层次的问题。（我的投票是坚定地属于精益/敏捷领域的 Scrum。）

XP（极限编程）很有趣，因为它融合了这两个领域的想法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-23T16:20:10.220

我想我是老派。我根据客户规范开发。一个充满活力的设计阶段，然后是一个低调的开发、测试、错误修复周期。然后，实施。

一旦规范被定义和同意，就不会发生进一步的变化。所有更改都将等待开发和错误修复完成。这可以防止范围蔓延，并允许软件被编写、测试、调试和实施。在这一点上，变化变成了增强、新功能等。

我发现，在过去 10 年中，几乎所有客户都认为他们在开发过程中“投入”的东西中约有 90% 被认为是不必要的。我无法告诉你有多少客户感谢我阻止他们。所以我不知道你会称之为什么过程，但它适用于我和我认识的许多其他开发人员。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-24T13:59:09.163

我是[精益软件开发](http://en.wikipedia.org/wiki/Lean_software_development)的粉丝，该开发由 Poppendiecks 推动，主要基于精益制造的原则，丰田是典型的代表。它与其他敏捷方法有很多共同点，重点是消除浪费、利用排队论和“及时”的心态（例如，在最后一个负责任的时刻指定一个故事）。

精益通常与[看板](http://en.wikipedia.org/wiki/Kanban)相关联，看板是一种通过管道跟踪任务的方法。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-23T16:05:58.603

按合同设计并补充单元测试

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-24T14:05:04.407

我们在我工作的地方使用瀑布，但经过我的一些推动，我们正在为我们的一些新项目更多地转向敏捷/TDD/CI 混合模型。上帝保佑，我们将能够放弃瀑布方法。我们所做的每个维护版本，我们的主要客户只是忽略了请求的最后期限，并在最后一秒将需求更改交给我们，然后在我们解释为什么他们不能继续这样做时，只是茫然地盯着我们。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-23T15:53:06.387

[代码和修复](http://en.wikipedia.org/wiki/Code_and_fix)！

开个玩笑，[TDD](http://en.wikipedia.org/wiki/Test-driven_development)确实是一个绝妙的方法。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-23T15:47:16.603

测试驱动设计 TDD

知道代码更改并没有破坏一些微妙的东西，您会获得很大的信心

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-23T15:56:50.417

我支持敏捷的投票。这些天我正在探索精益，但就像任何开发过程一样，这不是你可以直接加入当前团队的东西。但是，精益和敏捷的某些功能可以轻松融入您当前的流程并获得立竿见影的价值。

我以前的项目使用了瀑布方法并为此感到自豪。从那以后，他们放弃了 Waterfall 并转而使用 Prototype，这是一个很好的步骤。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-23T16:10:06.750

我在一家同时进行网络和系统开发的公司工作。我们的发展模式是快速发展。我们使用更现代的定义，因此它类似于敏捷开发。没有 XP 的概念。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-23T16:10:14.270

我们也使用 scrum……我认为站立会议在某些方面可能很好，但有时快速的 15 分钟至少会变成 30 分钟。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-08-05T23:38:35.307

在过去的几年里，我个人倾向于精益开发，这对我从 XP 中学到的一切都有很大的影响。我认为这里需要注意的是，Scrum 作为一个开发过程是不够的，因为它没有通知软件开发的工作，而是试图管理软件开发任务流的工作。ICONIX 也启发了我的想法。我认为这是处理用例和图表驱动环境的好方法，而不会陷入适得其反的官僚主义。

# math - 我在哪里可以了解对数？

> ID：121847
> 
> 赞同：20
> 
> 时间：2008-09-23T15:44:59.230
> 
> 标签：math, logarithm

我听说在编程上下文中提到了很多对数。它们似乎是许多问题的解决方案，但我似乎无法找到一种在现实世界中使用它们的方法。我已经阅读了[Wikipedia 条目](http://en.wikipedia.org/wiki/Logarithms)，坦率地说，这让我一点也不聪明。

**那么，我在哪里可以了解对数解决的实际编程问题？**有没有人有任何通过实施对数解决的问题的例子？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-23T15:52:33.923

编程中的对数也经常用于描述使用[大 O 表示法](http://en.wikipedia.org/wiki/Big_O_notation#Orders_of_common_functions)的算法的效率。

例如，二分搜索算法的最坏情况是 O(log(n))（在排序集上），而线性搜索的最坏情况是 O(n)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-23T15:52:07.527

假设你有 1000 美元，它存在于一个利息为 2.4% 的储蓄账户中。

你要等多少年才能有 2000 美元才能购买一台新笔记本电脑？

1000 × 1.024 ^x = 2000

1.024 ^x = 2

x = log [1.024] 2 = 29.23 年

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-24T17:52:10.587

在我自己的研究中，我发现了一些有用的资源：

## [可汗学院对数部分](https://www.khanacademy.org/math/algebra2/logarithms-tutorial)

这是一套很棒的对数课程。一位六年级学生的评论很好地总结了这一点：

> 非常感谢。这周，我的数学老师告诉我要挑战自己，所以我尝试了对数。起初我想，“我做不到，这太难了”。然后我看了视频，现在他们甚至很有趣！我在六年级，我的数学老师给我留下了深刻的印象。我不能感谢你。

## [Ruby 测验 #105：锦标赛对决](http://www.rubyquiz.com/quiz105.html)

*本文包含一个很好的示例，该示例使用以 2 为底的对数来确定在给定x*支球队的情况下完成淘汰赛所需的回合数。

## [指数函数和 E 的直观指南](http://betterexplained.com/articles/an-intuitive-guide-to-exponential-functions-e/)

一个优秀的、直观的（正如你所期望的那样，给定标题）指南**e**，自然对数的底。大量插图和示例使其成为文章的瑰宝。

## [揭秘自然对数 (ln)](http://betterexplained.com/articles/demystifying-the-natural-logarithm-ln/)

这是一篇关于**e**的文章的后续文章，讨论了**自然对数 (ln)**，使用文章中给出的直观解释，“给你达到一定增长水平所需的时间”。

**[Better Explained](http://betterexplained.com/)**网站上实际上有很多好的内容。确实，很棒的资源。

我之前实际上遇到过但后来完全忘记的另一个工具是**[Instacalc](http://instacalc.com/)**。似乎是同一个人 - Kalid Azad - 创建了 Better Explained 网站。它是一个非常有用的工具，用于破解数学。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-23T15:59:07.400

日志是一种元算术。这是一种将每个数字视为（可能是固定的）基数提高到指数的方式。仅对指数执行操作。这意味着您可以通过对日志进行加法和减法来进行乘法和除法。换句话说，您将数据放入日志空间，执行一套算术，然后将其拉回非日志空间。如果浮点精度损失和转换进出日志空间的开销很便宜，那么您可能会在时间上取得整体胜利。

你可以用日志做的一个巧妙的技巧是计算一个数字在打印时将占用的字符数，方法是将数字的 log-base-2 除以 log-base-10(2)，这是常数时间与一组乘法相比。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-23T15:52:40.817

我见过用于显示标签云的对数。这是一个解释它的页面：

[标签云字体分布算法](http://www.echochamberproject.com/node/247)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-23T16:05:00.447

我假设您已经听说过带有时间消耗上下文的对数。

一个具体的例子是搜索算法。给定一组有序数据（想想一个有序的 int 数组），您希望找到该数据中某个值的索引键。我们可以从数组已排序的事实中受益（例如 1、2、6、192、404、9595、50000）。假设我们想要找到值 2 的索引。我们可以通过每一步剔除（忽略）一半数组来最小化搜索空间。我们通过测试数组中间的值来开始这个搜索。数组中有 7 个值，然后我们将索引 7/2 = 3.5 = 3 设为 int。array[3] 是 192。我们要查找的值是 2，因此我们要在搜索空间的下半部分继续搜索。我们完全忽略索引 4、5、6，因为它们都高于 192，反过来也高于 2。现在我们有一个看起来像 (1, 2, 6) 的搜索空间。然后我们再次索引到中间（重复过程），我们立即找到 2。搜索完成，2的索引为1。

这是一个非常小的例子，但它展示了这种算法是如何工作的。

对于 16 个值，您最多需要搜索 4 次。对于 32 个值，您最多搜索 5 次，64 个值搜索 6 次，依此类推。1048576 个值在 20 步中搜索。这比必须单独比较数组中的每个项目要快得多。当然，这仅适用于已排序的数据集合。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-23T16:16:35.160

我推荐[e: The Story of a Number](https://rads.stackoverflow.com/amzn/click/com/0691058547)为对数的重要性、它们的发现以及与自然现象的相关性打下良好的基础。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-23T16:18:23.457

另一种看待它的方法是查看一个数字中基数乘数的数量。我相信您可以在以下示例中看到这一切的关系。

**十进制（以 10 为底）：**

*   log10 (1) = 0 , (10^0) = 1
*   log10 (10) = 1 , (10^1) = 10
*   log10 (100) = 2 , (10^2) = 100
*   log10 (1000) = 3 , (10^3)​​ = 1000
*   log10 (10000) = 4 , (10^4) = 10000
*   log10 (100000) = 5 , (10^5) = 100000

**二进制（基数 2）：**

*   log2 (1) = 0 , (2^0) = 1
*   log2 (2) = 1 , (2^1) = 2
*   log2 (4) = 2 , (2^2) = 4
*   log2 (8) = 3 , (2^3) = 8
*   log2 (16) = 4 , (2^4) = 16
*   log2 (32) = 5 , (2^5) = 32
*   log2 (64) = 6 , (2^6) = 64
*   log2 (128) = 7 , (2^7) = 128

**十六进制（以 16 为基数）：**

*   log16 (1) = 0 , (16^0) = 1
*   log16 (16) = 1 , (16^1) = 16
*   log16 (256) = 2 , (16^2) = 256
*   log16 (4096) = 3, (16^3) = 4096
*   log16 (65536) = 4, (16^4) = 65536

如果你想考虑变量：

*   日志**N** ( **X** ) = **Y**
*   ( **N** ^ **Y** ) = **X**

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-23T16:27:40.907

现实世界中的许多（许多！）关系是对数的。例如，如果 Stack Overflow 上的声誉分数分布是[log normal](http://en.wikipedia.org/wiki/Log_normal) ，我不会感到惊讶。绝大多数用户的声誉得分为 1，少数人的声誉很高。如果您对该分布应用对数变换，它可能几乎是线性关系。快速浏览[https://stackoverflow.com/users?page=667](https://stackoverflow.com/users?page=667)表明这是真的。

您可能更熟悉[长尾](http://www.wired.com/wired/archive/12.10/tail.html)概念，它是对数分布的应用。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-23T15:49:36.253

我能回忆起的唯一问题是必须在 SQL 中计算列的乘积。SQL Server 没有 PRODUCT() 聚合函数，因此这是使用每个值的对数之和（使用 LOG10() 函数）来完成的。主要缺点是列中的所有数字都必须是正数且非零（您无法计算负数或零的对数）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-23T15:53:22.720

每个编程示例中最明显的用法是精度。简而言之，考虑存储无符号整数。你需要多少位来存储 X？嗯，您可以存储在 n 位中的最大值是 2^n - 1，因此您可能需要 log_2 X + 1 位来存储 X。现在您可以轻松选择 short、int、word、long 等。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-09-23T16:08:38.407

举一个例子：以非常小的利率和大量的周期计算复利。

您可以使用最直接的方式进行操作，即使使用快速求幂，但准确性可能会受到影响，因为浮点数的存储方式和计算 s * r 幂 n 仍然需要 O(ln(n)) 操作。

使用对数，它会更准确一些。

A = ln( s * r power n ) = ln(s) + n * ln(r)
对数数据库中的两次查找给出了 ln(s) 和 ln(r)，其中 ln(r) 开始非常小，并且浮点数在 0 result = exp(A) 附近以最佳精度工作，此处为反向查找。

如果您使用非整数指数，这也是唯一真正有效的方法，例如提取三次根。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-09-23T16:11:43.953

查看 MIT 的开放课件：[算法简介](http://ocw.mit.edu/OcwWeb/Electrical-Engineering-and-Computer-Science/6-046JFall-2005/CourseHome/index.htm)。免费教育。惊人的。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-23T16:41:25.583

我发现的对数更“酷”的应用之一是[Spiral Storage](http://portal.acm.org/citation.cfm?id=901315&dl=GUIDE&coll=GUIDE&CFID=3731301&CFTOKEN=99586792)。这是一个哈希表，允许您随着表的增长一次拆分一个存储桶，将该存储桶中不到一半的记录重新定位到相同的新存储桶。与线性散列不同，线性散列的性能会周期性地变化，并且所有的桶往往会在同一时间被拆分，而螺旋散列允许表的良好、平滑的增长。

它是大约 30 年前由 GNN Martin 出版的，除了他还发明了[Range Encoding](http://en.wikipedia.org/wiki/Range_encoding)之外，我对他的了解不多。看来是个聪明人！我一直无法得到他的原始论文的副本，但是 Per-Åke Larson 的论文[“动态哈希表”](http://portal.acm.org/citation.cfm?id=42410&dl=GUIDE&coll=GUIDE&CFID=3731301&CFTOKEN=99586792)有一个非常清晰的描述。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-23T16:06:49.723

当一个或两个轴覆盖大范围的值时，对数在图表和图形中经常使用。

一些自然现象最好用对数刻度表示；一些例子是声压级（以 dB 为单位的[SPL](http://en.wikipedia.org/wiki/Sound_pressure_level)）和地震震级（[里氏标度](http://en.wikipedia.org/wiki/Richter_magnitude_scale)）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-24T00:35:33.977

作为[Chris](https://stackoverflow.com/questions/121847/where-can-i-learn-about-logarithms#121902)所说的一个例子，一种根据值中的位数改变复杂性的算法（可能）将具有 O(log(n)) 描述的效率。

指数（以及对数）的另一个日常示例是[IEEE 浮点数](http://en.wikipedia.org/wiki/IEEE_754)格式。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-09-24T02:14:03.913

对数函数只是指数函数的逆函数，就像减法是加法的逆函数一样。就像这个等式：

```
a = b + c 
```

陈述与这个等式相同的事实：

```
a - c = b 
```

这个等式：

```
b ** p = x 
```

(where `**`is raise to an power) 陈述了与这个等式相同的事实：

```
log [base b] (x) = p 
```

虽然`b`可以是任何数字（例如`log [base 10] (10,000) = 4`），但数学的“自然”基数是`e`(2.718281828...)，[请参见此处](http://en.wikipedia.org/wiki/E_(mathematical_constant))。

在工程中使用较多的“常用”对数以 10 为底。对某个数字的常用（以 10 为底）对数的一种简单粗暴（强调脏）的解释`x`是它比十进制数小一表示大小为 的数字所需的数字`x`。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-17T13:12:42.770

**在 BetterExplained揭秘自然对数 (ln)** 是我发现的最好的。它从基础中清除概念并帮助您理解底层概念。在那之后，一切似乎都是小菜一碟。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-29T15:24:46.050

以下是我使用过的一些网站：

*   [http://www.helpalgebra.com/articles/propertiesoflogarithms.htm](http://www.helpalgebra.com/articles/propertiesoflogarithms.htm)
*   [http://www.math.unc.edu/Faculty/mccombs/web/alg/classnotes/logs/lognotation.html](http://www.math.unc.edu/Faculty/mccombs/web/alg/classnotes/logs/lognotation.html)
*   [http://www.math.unc.edu/Faculty/mccombs/web/alg/classnotes/logs/logprops.html](http://www.math.unc.edu/Faculty/mccombs/web/alg/classnotes/logs/logprops.html)
*   [http://abacus.bates.edu/acad/acad_support/msw/exps_and_logs.pdf](http://abacus.bates.edu/acad/acad_support/msw/exps_and_logs.pdf)
*   [http://people.hofstra.edu/Stefan_Waner/Realworld/calctopic1/logs.html](http://people.hofstra.edu/Stefan_Waner/Realworld/calctopic1/logs.html)

我用对数来计算房子的年升值，以确定卖方是否公平。

**房屋升值方程**

这是基本方程：

*   以前的价格 = p
*   新价格 = n
*   升值率 = r
*   升值年限 = y

> `p * (1 + r)^y = n`

那么，如果 6 年前的价格是 191,000 美元（通过查看您的审计师的网站），而要价是 284,000 美元，那么升值率是多少（不考虑任何一次性改进成本）？

> ```
> 191,000 * (1 + r)^6 = 284,000
> 
> (1 + r)^6 = 284,000 / 191,000 = 1.486
> 
> Using a property of exponents and logarithms…
> 
> 6 ( log (1 + r) ) = log 1.486
> log (1 + r) = (log 1.486) / 6 = 0.02866
> 
> Using another property of exponents and logarithms…
> 
> 10 0.02866 = 1 + r
> 1.068 = 1 + r
> r = 1.068 – 1 = 0.068 = 6.8%  (kind of high!) 
> ```

要确定合理的价格是多少……使用 4% 并考虑他们所做的任何改进（应该在他们主要的网络 ID 上列出……但不包括浴室/厨房改造等）

> ```
> 191,000 * (1 + 0.04)^6 = n
> n = 241,675 + reasonable cost of improvement 
> which of course will depreciate over time 
> and should not represent 100% of the 
> cost of the improvement 
> ```

# php - 对整个网页使用一个文件的利弊？

> ID：121849
> 
> 赞同：2
> 
> 时间：2008-09-23T15:45:22.583
> 
> 标签：php, file

我不确定我应该如何表达这一点，但我会试一试。
我最近开始用面向对象的 PHP 编写我的投资组合，我想知道使用单个页面是否符合最佳实践，其中内容根据 SQL 数据和 $_GET 变量而变化？

如果是/不是，为什么？

编辑：看看我的下一篇文章，更深入的细节。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T15:56:29.513

您是否在询问使用前端控制器模式，其中单个文件服务您的所有请求？通常这是通过 index.php 和 mod_rewrite 来完成的，它获取所有请求，并将 URL 的其余部分作为查询字符串中的参数提供给它。

[http://www.onlamp.com/pub/a/php/2004/07/08/front_controller.html](http://www.onlamp.com/pub/a/php/2004/07/08/front_controller.html)

我倾向于推荐这种模式用于应用程序，因为它为您提供了一个处理身份验证等事情的单一位置，并且通常您需要在更紧密的级别上集成事物，其中新功能是向控制器注册的类通过某种机制很有意义。

其他人提到的有关 URL 的担忧并不准确，因为 URL 结构和文件结构之间没有真正的关系，除非您使用的是古老的网站构建技术。大量的 apache 功能基于文件/目录结构和 URL 结构是不同概念的概念（别名模块、重写模块、内容协商等）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-23T15:47:30.377

*   不可扩展
*   难以管理代码
*   解析器必须解析所有内容
*   Code Smell 的完美例子
*   一个错误使您的整个网站崩溃

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T15:53:24.200

如果您指的是单个登录页面（例如 index.php），然后使用会话变量等来确定需要包含哪些代码，那么是的，这是一种经常使用的技术。

编辑：以上我的意思是 Daniel Papasian 在他的优秀帖子中详细解释的内容

如果您的意思是将所有 HTML、SQL 和 PHP 放在一个文件中，那么不，因为 GateKiller 指出的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-23T15:58:18.667

实际页面文件应仅包含该页面与您网站上标准“页面”的不同之处（例如页面标题、索引页面可能包含获取最新消息的代码等）。所有被（或可能）在多个地方使用的东西，都应该被移到外部 php 文件中，并包含在内。例子是：

*   数据库信息（密码、用户名等）
*   页眉页脚
*   登录代码

这使得代码更容易管理。例如，如果您更改数据库密码，它只有一个需要更新的文件，或者如果您决定在标题中添加横幅，那么它也只有一页，而不是所有需要更改的页面。

它还可以减少添加新功能的工作量，例如，新页面可能只是：

```
<?php
require ('config.php')
require ('start.php')
require ('header.php')
//custom page stuff
require ('footer.php')
?> 
```

或通过 cookie 添加自动登录，是对 Login() 函数（创建 cookie）和 start.php（检查 cookie + 调用 Login()）的简单更改。

您也可以在将来轻松地将这些文件传输到其他项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T15:50:17.780

门杀手提到的所有内容+您也不能使用后期绑定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T15:51:24.550

*   难以管理代码

如果您正在使用版本控制，那么回滚可能发生在您网站的单个“页面”上的任何更改将变得更加困难。因为您必须重新合并以处理可能发生的任何事情

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T15:51:44.877

除非您使用 mod rewrite，否则它对搜索引擎不友好

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T15:57:31.353

我倾向于不同意大多数 - 如果您的网站由自定义 CMS 或类似的东西管理，没有理由不使用一个页面。

我在不久前写的 CMS 上做了类似的事情。所有客户端都有一个 default.asp 页面，用于查询数据库的主题、内容、附件和成员权限。为了进行更改，我只进行了一次更改，如果需要更改，则将其复制给我的其他客户。

这当然在大多数情况下都行不通。如果您的网站做了很多不同的事情（我的 cms 只是在加载页面时重复了某些功能），那么多个页面确实是唯一的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T16:07:15.680

对于那些感兴趣的人，有一个使用这个精确模型的框架。最初用于 ColdFusion。这种方法仍然有一个社区，大约一年前（2007 年 12 月）发布了 5.5 版。

[FuseBox 框架站点](http://www.fusebox.org/)

[维基百科条目](http://en.wikipedia.org/wiki/Fusebox_(programming))

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-23T17:06:13.933

此屏幕转储和以下解释可能会更好地了解我的代码目前的样子。

![文件结构](https://i80.photobucket.com/albums/j171/kaemic/stackoverflow/oneFileToRuleThemAll.jpg)

我使用的模型与“Internet Friend”、Daniel Papasian 和其他一些人提到的模型相同；前控制器。

我的索引页面看起来像这样。

```
require_once 'config.php';
require_once 'class_lib/template.php';

$template = new template($config);
$template->dataQuery();
$template->pageCheck();
$template->titleAssembly();
$template->cssAssembly();
$template->metaAssembly();
$template->menuAssembly();
$template->content();
echo $template->publish(); 
```

类构造打开主模板文件并将其加载到每个方法都可以通过用生成的代码替换标记来操作的变量中。丑陋的 URL 并不是真正的问题，因为我将使用 mod_rewrite 来清理它。
但是，Papasian 有一点，这种方法会更适合基于 Web 的应用程序等。

我很抱歉首先我的问题没有很具体。
此外，非常感谢所有放弃几行以提供帮助的人。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-23T20:16:54.847

我经常使用没有 .php 扩展名的 php 文件（即站点）并添加

```
<Files site>
ForceType application/x-httpd-php 
</Files> 
```

到 .htaccess ，它使 apache 将文件解释为 php 文件。

您可以将 var 解析为 url 中的文件：[http ://www.yourdomain.com/site/var1/var2/var3](http://www.yourdomain.com/site/var1/var2/var3)

采用

```
$var_array = explode("/",$_SERVER['REQUEST_URI']); 
$var1 = $var_array[1];
$var2 = $var_array[2];
$var3 = $var_array[3]; 
```

获取变量。这样，您可以使用带有 searchengingfriendlyurls 的单个文件，而无需 modrewrite。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-12T16:21:27.947

re: URL 和文件结构

我转换了一个网站，其中所有内容都在数据库中，并使用 index?p=434 模型进行访问。使用数据库没有任何好处，而且网站让那些不得不添加内容的人感到困惑，因为他们必须使用浏览器编辑内容，而页面只是数字。

我把所有内容都拿出来放在单独的文件中。每个都有一个合理的名称，并被组织成文件夹。每个文件看起来像这样：

```
require('sitelib');
do_header('about', 'About Us');
// content here
do_footer(); 
```

客户喜欢它。他们能够使用任何 HTML 编辑器进入，找到正确的文件并进行更改。他们能够制作新的页面。总而言之：有时，让 URL 和文件结构匹配很有用。

# sql - 将左侧的 varchar 填充到一定长度的最有效 T-SQL 方法？

> ID：121864
> 
> 赞同：211
> 
> 时间：2008-09-23T15:46:39.147
> 
> 标签：sql, sql-server, tsql

相比而言：

```
REPLICATE(@padchar, @len - LEN(@str)) + @str 
```

* * *

## 回答 #1

> 赞同：331
> 
> 时间：2008-09-23T15:50:14.240

这只是对 SQL 的低效使用，无论您如何操作。

也许像

```
right('XXXXXXXXXXXX'+ rtrim(@str), @n) 
```

其中 X 是您的填充字符，@n 是结果字符串中的字符数（假设您需要填充，因为您正在处理固定长度）。

但正如我所说，你真的应该避免在你的数据库中这样做。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2014-09-29T19:04:55.400

我知道这最初是在 2008 年提出的，但是 SQL Server 2012 引入了一些新函数[。FORMAT 函数](https://msdn.microsoft.com/en-us/library/hh213505(v=sql.110).aspx)很好地简化了用零填充。它还将为您执行转换：

```
declare @n as int = 2
select FORMAT(@n, 'd10') as padWithZeros 
```

**更新：**

我想自己测试FORMAT函数的实际效率。[与AlexCuse](https://stackoverflow.com/users/794/alexcuse)的原始答案相比，我很惊讶地发现效率不是很好。虽然我发现 FORMAT 函数更简洁，但它在执行时间方面效率不高。我使用的 Tally 表有 64,000 条记录。感谢[Martin Smith](https://stackoverflow.com/users/73226/martin-smith)指出执行时间效率。

```
SET STATISTICS TIME ON
select FORMAT(N, 'd10') as padWithZeros from Tally
SET STATISTICS TIME OFF 
```

SQL Server 执行时间：CPU 时间 = 2157 毫秒，经过时间 = 2696 毫秒。

```
SET STATISTICS TIME ON
select right('0000000000'+ rtrim(cast(N as varchar(5))), 10) from Tally
SET STATISTICS TIME OFF 
```

SQL Server 执行时间：

> CPU 时间 = 31 毫秒，经过时间 = 235 毫秒。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2008-09-26T15:06:33.093

几个人给出了这个版本：

```
right('XXXXXXXXXXXX'+ @str, @n) 
```

请注意这一点，因为如果它长于 n，它将截断您的实际数据。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-23T15:52:07.793

```
@padstr = REPLICATE(@padchar, @len) -- this can be cached, done only once

SELECT RIGHT(@padstr + @str, @len) 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-06-05T22:18:07.903

也许是过度杀戮，我有这些 UDF 可以左右填充

```
ALTER   Function [dbo].[fsPadLeft](@var varchar(200),@padChar char(1)='0',@len int)
returns varchar(300)
as
Begin

return replicate(@PadChar,@len-Len(@var))+@var

end 
```

并且向右

```
ALTER function [dbo].[fsPadRight](@var varchar(200),@padchar char(1)='0', @len int) returns varchar(201) as
Begin

--select @padChar=' ',@len=200,@var='hello'

return  @var+replicate(@PadChar,@len-Len(@var))
end 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-23T15:51:27.793

我不确定您提供的方法是否真的效率低下，但是另一种方法，只要它在长度或填充字符上不必灵活，就可以（假设您想用“ 0" 到 10 个字符：

```
DECLARE
   @pad_characters VARCHAR(10)

SET @pad_characters = '0000000000'

SELECT RIGHT(@pad_characters + @str, 10) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-23T16:01:30.017

可能矫枉过正，我经常使用这个UDF：

```
CREATE FUNCTION [dbo].[f_pad_before](@string VARCHAR(255), @desired_length INTEGER, @pad_character CHAR(1))
RETURNS VARCHAR(255) AS  
BEGIN

-- Prefix the required number of spaces to bulk up the string and then replace the spaces with the desired character
 RETURN ltrim(rtrim(
        CASE
          WHEN LEN(@string) < @desired_length
            THEN REPLACE(SPACE(@desired_length - LEN(@string)), ' ', @pad_character) + @string
          ELSE @string
        END
        ))
END 
```

这样您就可以执行以下操作：

```
select dbo.f_pad_before('aaa', 10, '_') 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-12-08T15:45:35.743

这是一种向左填充的简单方法：

```
REPLACE(STR(FACT_HEAD.FACT_NO, x, 0), ' ', y) 
```

哪里`x`是焊盘编号，`y`是焊盘字符。

样本：

```
REPLACE(STR(FACT_HEAD.FACT_NO, 3, 0), ' ', 0) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-06-16T13:34:43.850

我希望这可以帮助别人。

```
STUFF ( character_expression , start , length ,character_expression )

select stuff(@str, 1, 0, replicate('0', @n - len(@str))) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-10-28T15:11:45.780

我喜欢 vnRocks 解决方案，这里是 udf 的形式

```
create function PadLeft(
      @String varchar(8000)
     ,@NumChars int
     ,@PadChar char(1) = ' ')
returns varchar(8000)
as
begin
    return stuff(@String, 1, 0, replicate(@PadChar, @NumChars - len(@String)))
end 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-23T15:54:41.407

```
select right(replicate(@padchar, @len) + @str, @len) 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-23T15:55:04.027

在 SQL Server 2005 及更高版本中，您可以创建一个 CLR 函数来执行此操作。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-24T16:15:04.577

这个怎么样：

```
replace((space(3 - len(MyField)) 
```

3 是`zeros`要填充的数量

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-05-21T20:08:51.120

我用这个。它允许您确定希望结果的长度以及默认填充字符（如果未提供）。当然，您可以根据遇到的最大值自定义输入和输出的长度。

```
/*===============================================================
 Author         : Joey Morgan
 Create date    : November 1, 2012
 Description    : Pads the string @MyStr with the character in 
                : @PadChar so all results have the same length
 ================================================================*/
 CREATE FUNCTION [dbo].[svfn_AMS_PAD_STRING]
        (
         @MyStr VARCHAR(25),
         @LENGTH INT,
         @PadChar CHAR(1) = NULL
        )
RETURNS VARCHAR(25)
 AS 
      BEGIN
        SET @PadChar = ISNULL(@PadChar, '0');
        DECLARE @Result VARCHAR(25);
        SELECT
            @Result = RIGHT(SUBSTRING(REPLICATE('0', @LENGTH), 1,
                                      (@LENGTH + 1) - LEN(RTRIM(@MyStr)))
                            + RTRIM(@MyStr), @LENGTH)

        RETURN @Result

      END 
```

你的旅费可能会改变。:-)

Joey Morgan
程序员/分析师负责人我
WellPoint 医疗补助业务部

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-05-25T19:44:37.853

这是我的解决方案，它避免了截断字符串并使用普通的 SQL。感谢*@AlexCuse*、*@Kevin*和*@Sklivvz*，他们的解决方案是这段代码的基础。

```
 --[@charToPadStringWith] is the character you want to pad the string with.
declare @charToPadStringWith char(1) = 'X';

-- Generate a table of values to test with.
declare @stringValues table (RowId int IDENTITY(1,1) NOT NULL PRIMARY KEY, StringValue varchar(max) NULL);
insert into @stringValues (StringValue) values (null), (''), ('_'), ('A'), ('ABCDE'), ('1234567890');

-- Generate a table to store testing results in.
declare @testingResults table (RowId int IDENTITY(1,1) NOT NULL PRIMARY KEY, StringValue varchar(max) NULL, PaddedStringValue varchar(max) NULL);

-- Get the length of the longest string, then pad all strings based on that length.
declare @maxLengthOfPaddedString int = (select MAX(LEN(StringValue)) from @stringValues);
declare @longestStringValue varchar(max) = (select top(1) StringValue from @stringValues where LEN(StringValue) = @maxLengthOfPaddedString);
select [@longestStringValue]=@longestStringValue, [@maxLengthOfPaddedString]=@maxLengthOfPaddedString;

-- Loop through each of the test string values, apply padding to it, and store the results in [@testingResults].
while (1=1)
begin
    declare
        @stringValueRowId int,
        @stringValue varchar(max);

    -- Get the next row in the [@stringLengths] table.
    select top(1) @stringValueRowId = RowId, @stringValue = StringValue
    from @stringValues 
    where RowId > isnull(@stringValueRowId, 0) 
    order by RowId;

    if (@@ROWCOUNT = 0) 
        break;

    -- Here is where the padding magic happens.
    declare @paddedStringValue varchar(max) = RIGHT(REPLICATE(@charToPadStringWith, @maxLengthOfPaddedString) + @stringValue, @maxLengthOfPaddedString);

    -- Added to the list of results.
    insert into @testingResults (StringValue, PaddedStringValue) values (@stringValue, @paddedStringValue);
end

-- Get all of the testing results.
select * from @testingResults; 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-03-07T01:50:44.827

我知道此时这并没有给对话增加太多内容，但是我正在运行文件生成过程，并且速度非常慢。我一直在使用复制并看到这种修剪方法，并认为我会试一试。

您可以在我的代码中看到两者之间的切换除了新的@padding 变量（以及现在存在的限制）。我在两种状态下使用该函数运行我的程序，在执行时间上具有相同的结果。所以至少在 SQLServer2016 中，我没有看到其他人发现的任何效率差异。

无论如何，这是我多年前写的 UDF 加上今天的更改，除了它有一个 LEFT/RIGHT 参数选项和一些错误检查之外，它与其他的几乎相同。

```
CREATE FUNCTION PadStringTrim 
(
    @inputStr varchar(500), 
    @finalLength int, 
    @padChar varchar (1),
    @padSide varchar(1)
)
RETURNS VARCHAR(500)

AS BEGIN
    -- the point of this function is to avoid using replicate which is extremely slow in SQL Server
    -- to get away from this though we now have a limitation of how much padding we can add, so I've settled on a hundred character pad 
    DECLARE @padding VARCHAR (100) = 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
    SET @padding = REPLACE(@padding, 'X', @padChar)

    SET @inputStr = RTRIM(LTRIM(@inputStr))

    IF LEN(@inputStr) > @finalLength 
        RETURN '!ERROR!' -- can search for ! in the returned text 

    ELSE IF(@finalLength > LEN(@inputStr))
        IF @padSide = 'L'
            SET @inputStr = RIGHT(@padding + @inputStr, @finalLength)
            --SET @inputStr = REPLICATE(@padChar, @finalLength - LEN(@inputStr)) + @inputStr
        ELSE IF @padSide = 'R'
            SET @inputStr = LEFT(@inputStr + @padding, @finalLength)
            --SET @inputStr = @inputStr + REPLICATE(@padChar, @finalLength - LEN(@inputStr)) 

    -- if LEN(@inputStr) = @finalLength we just return it 
    RETURN @inputStr;
END

-- SELECT  dbo.PadStringTrim( tblAccounts.account, 20, '~' , 'R' ) from tblAccounts
-- SELECT  dbo.PadStringTrim( tblAccounts.account, 20, '~' , 'L' ) from tblAccounts 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-08-16T23:46:36.780

我有一个带有 x 小数的 lpad 函数： CREATE FUNCTION [dbo].[LPAD_DEC] ( -- 在此处添加函数的参数 @pad nvarchar(MAX), @string nvarchar(MAX), @length int, @dec int ) RETURNS nvarchar(max) AS BEGIN -- 在此处声明返回变量 DECLARE @resp nvarchar(max)

```
IF LEN(@string)=@length
BEGIN
    IF CHARINDEX('.',@string)>0
    BEGIN
        SELECT @resp = CASE SIGN(@string)
            WHEN -1 THEN
                -- Nros negativos grandes con decimales
                concat('-',SUBSTRING(replicate(@pad,@length),1,@length-len(@string)),ltrim(str(abs(@string),@length,@dec)))
            ELSE
                -- Nros positivos grandes con decimales
                concat(SUBSTRING(replicate(@pad,@length),1,@length-len(@string)),ltrim(str(@string,@length,@dec)))                  
            END
    END
    ELSE
    BEGIN
        SELECT @resp = CASE SIGN(@string)
            WHEN -1 THEN
                --Nros negativo grande sin decimales
                concat('-',SUBSTRING(replicate(@pad,@length),1,(@length-3)-len(@string)),ltrim(str(abs(@string),@length,@dec)))
            ELSE
                -- Nros positivos grandes con decimales
                concat(SUBSTRING(replicate(@pad,@length),1,@length-len(@string)),ltrim(str(@string,@length,@dec)))                  
            END                     
    END
END
ELSE
    IF CHARINDEX('.',@string)>0
    BEGIN
        SELECT @resp =CASE SIGN(@string)
            WHEN -1 THEN
                -- Nros negativos con decimales
                concat('-',SUBSTRING(replicate(@pad,@length),1,@length-len(@string)),ltrim(str(abs(@string),@length,@dec)))
            ELSE
                --Ntos positivos con decimales
                concat(SUBSTRING(replicate(@pad,@length),1,@length-len(@string)),ltrim(str(abs(@string),@length,@dec))) 
            END
    END
    ELSE
    BEGIN
        SELECT @resp = CASE SIGN(@string)
            WHEN -1 THEN
                -- Nros Negativos sin decimales
                concat('-',SUBSTRING(replicate(@pad,@length-3),1,(@length-3)-len(@string)),ltrim(str(abs(@string),@length,@dec)))
            ELSE
                -- Nros Positivos sin decimales
                concat(SUBSTRING(replicate(@pad,@length),1,(@length-3)-len(@string)),ltrim(str(abs(@string),@length,@dec)))
            END
    END
RETURN @resp 
```

结尾

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-10-12T15:04:52.213

这是我的解决方案。我可以填充任何字符，而且速度很快。很简单。您可以更改可变大小以满足您的需求。

更新了一个参数来处理 null 时返回的内容： null 将返回 null if null

```
CREATE OR ALTER FUNCTION code.fnConvert_PadLeft(
    @in_str nvarchar(1024),
    @pad_length int, 
    @pad_char nchar(1) = ' ', 
    @rtn_null NVARCHAR(1024) = '')
RETURNS NVARCHAR(1024)
AS
BEGIN
     DECLARE @rtn  NCHAR(1024) = ' '
     RETURN RIGHT(REPLACE(@rtn,' ',@pad_char)+ISNULL(@in_str,@rtn_null), @pad_length)
END
GO

CREATE OR ALTER FUNCTION code.fnConvert_PadRight(
    @in_str nvarchar(1024), 
    @pad_length int, 
    @pad_char nchar(1) = ' ', 
    @rtn_null NVARCHAR(1024) = '')
RETURNS NVARCHAR(1024)
AS
BEGIN
     DECLARE @rtn  NCHAR(1024) = ' '
     RETURN LEFT(ISNULL(@in_str,@rtn_null)+REPLACE(@rtn,' ',@pad_char), @pad_length)
END
GO 

-- Example
SET STATISTICS time ON 
SELECT code.fnConvert_PadLeft('88',10,'0',''), 
    code.fnConvert_PadLeft(null,10,'0',''), 
    code.fnConvert_PadLeft(null,10,'0',null), 
    code.fnConvert_PadRight('88',10,'0',''), 
    code.fnConvert_PadRight(null,10,'0',''),
    code.fnConvert_PadRight(null,10,'0',NULL)

0000000088  0000000000  NULL    8800000000  0000000000  NULL 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2012-03-19T00:52:46.200

为了提供四舍五入到小数点后两位但在需要时用零填充的数值，我有：

```
DECLARE @value = 20.1
SET @value = ROUND(@value,2) * 100
PRINT LEFT(CAST(@value AS VARCHAR(20)), LEN(@value)-2) + '.' + RIGHT(CAST(@value AS VARCHAR(20)),2) 
```

如果有人能想到一个更整洁的方法，那将不胜感激 - 上面看起来*很笨拙*。

**注意**：在这种情况下，我使用 SQL Server 以 HTML 格式通过电子邮件发送报告，因此希望在不涉及解析数据的其他工具的情况下格式化信息。

* * *

## 回答 #20

> 赞同：-4
> 
> 时间：2011-09-21T12:06:54.437

这是我通常如何填充 varchar

```
WHILE Len(@String) < 8
BEGIN
    SELECT @String = '0' + @String
END 
```

# django - 为什么当 Debug 设置为 False 时，Django 会为静态媒体生成 HTTP 500 错误？

> ID：121866
> 
> 赞同：6
> 
> 时间：2008-09-23T15:46:58.740
> 
> 标签：django, deployment, debugging

我正准备部署我的 Django 应用程序，我注意到当我将“DEBUG”设置更改为 False 时，所有对静态文件（即 JavaScript、CSS 等）的引用都会导致`HTTP 500`错误。

知道是什么导致了这个问题（以及如何解决它）吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-23T16:16:07.003

我强烈建议让您的 Web 服务器处理静态请求，而无需使用 Django。在我的`urls.py`中，我只在调试设置为 True 时添加静态请求处理程序。

从技术上讲，提供静态服务的 Django 可以正常工作。一定要阅读简短的文档页面，[http://docs.djangoproject.com/en/dev/howto/static-files/](http://docs.djangoproject.com/en/dev/howto/static-files/)。你会想使用这样的条目`urls.py`

```
(r'^static/(?P<path>.*)$', 'django.views.static.serve',
    {'document_root': '/path/to/media'}) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-23T16:19:27.430

听起来您可能正在尝试使用 Django 开发服务器来提供静态媒体。查看[http://docs.djangoproject.com/en/dev/howto/deployment/](http://docs.djangoproject.com/en/dev/howto/deployment/)了解一些部署方案/howtos 和[http://docs.djangoproject.com/en/dev/howto/static-files/](http://docs.djangoproject.com/en/dev/howto/static-files/)如何提供静态文件（但请注意关于不在生产中使用这些方法的免责声明）。

一般来说，我会查看您的服务器日志，看看它试图从哪里获取文件。我怀疑 500 错误实际上是 404 错误，但它们变成了 500 错误，因为 Django 无法找到或呈现 404.html 模板。如果不是这种情况，那么如果您可以发布您遇到的特定 500 错误将会很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-18T08:26:53.317

您还必须到处检查您的网址。当 DEBUG 设置为 False 时，所有没有尾随“/”的 URL 都被视为错误，这与 DEBUG = True 不同，在这种情况下，Django 将在丢失的任何地方附加“/”。所以，简而言之，确保所有链接都以斜线结尾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-30T14:41:16.707

原来我已经注释掉了这个`SECRET_KEY`变量。不过我没有办法知道。只是不得不尝试一下。

# c++ - 自动铸件

> ID：121922
> 
> 赞同：2
> 
> 时间：2008-09-23T15:55:08.643
> 
> 标签：c++, casting

我目前正在遭受脑放屁。我以前做过，但我不记得确切的语法，也看不到我写的代码，因为当时我在另一家公司工作。我有这样的安排：

```
class P
{
// stuff
};

class PW : public P
{
// more stuff
};

class PR : public P
{
// more stuff
};

class C
{
public:
    P GetP() const { return p; }    
private:
    P p;
};

// ...
    P p = c.GetP( ); // valid
    PW p = c.GetP( ); // invalid
    PR p = c.GetP( ); // invalid
// ... 
```

现在我想让 P 与 PW 和 PR 互换（因此 PW 和 PR 可以互换）。我可能可以摆脱强制转换，但仅在这个模块中，这种代码更改就发生了很多次。我很确定它是一个操作员，但对于我的生活，我不记得是什么。

**如何用最少的代码使 P 与 PW 和 PR 互换？**

**更新：**提供更多说明。P 代表 Project，R 和 W 分别代表 Reader 和 Writer。Reader 拥有的只是加载代码 - 没有变量，而 writer 拥有用于简单写入的代码。它需要分开，因为阅读和写作部分有各种管理器类和对话框，这不是项目真正关心的项目文件的操作。

**更新：**我还需要能够调用 P 和 PW 的方法。因此，如果 P 有一个方法 a() 和 PW 作为方法调用 b() 那么我可以：

```
PW p = c.GetP();
p.a();
p.b(); 
```

基本上是为了使转换透明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T16:06:25.747

你试图强制实际变量，而不是指针。要做到这一点需要演员。但是，如果您的类定义如下所示：

```
class C

    {
        public: 
            P* GetP() const { return p; }
        private:
            P* p;
    } 
```

然后，无论 p 是指向 P、PW 还是 PR 的指针，您的函数都不会改变，并且在函数返回的 P* 上调用的任何（虚拟）函数都将使用 P、PW 或 PR 中的实现取决于成员 p 是什么..

我想要记住的关键是[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)。由于 PW 和 PR 是 P 的子类，因此可以将它们视为 Ps。但是，PW 不能被视为 PR，反之亦然。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T17:26:19.783

如果你想让这部分编译：

```
 // ...
    P p = c.GetP( ); // valid
    PW p = c.GetP( ); // invalid
    PR p = c.GetP( ); // invalid
// ... 
```

您需要能够将 P 构造/转换为 PW 或 PR。你需要做这样的事情：

```
 class PW : public P
{
    PW(const P &);
// more stuff
};

class PR : public P
{
    PR(const P &);
// more stuff
}; 
```

或者你的意思更像是：

```
 class P
{
    operator PW() const;
    operator PR() const;
// stuff
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-23T15:58:36.403

在上面的代码中，您遇到了与**切片**问题相反的问题。

您要做的是将 P 分配给包含比源对象更多信息的 PW 或 PR。你怎么做到这一点？假设 P 只有 3 个成员变量，但 PW 有 12 个附加成员 - 当您编写时，这些成员的值来自哪里`PW p = c.GetP()`？

如果这个赋值实际上*是*有效的，这应该真的表明某种设计怪异，那么我将实现`PW::operator=(const P&)`and `PR::operator=(const P&)`，`PW::PW(const P&)`and `PR::PR(const P&)`。但那天晚上我睡得不好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-23T16:20:59.673

要通过 P 使 PW 和 PR 可用，您需要使用引用（或指针）。所以你真的需要改变 C 的接口，所以它返回一个引用。

旧代码中的主要问题是您将 P 复制到 PW 或 PR 中。这是行不通的，因为 PW 和 PR 可能比 P 拥有更多的信息，并且从类型的角度来看，P 类型的对象不是 PW 或 PR。虽然 PW 和 PR 都是 P。

将代码更改为这样，它将编译：如果您想在运行时返回从 P 类派生的不同对象，那么 C 类必须能够存储您期望的所有不同类型并在运行时专门化。因此，在下面的课程中，我允许您通过传递指向将通过引用返回的对象的指针来进行专业化。为了确保对象是异常安全的，我将指针包装在智能指针中。

```
class C
{
    public:
        C(std::auto_ptr<P> x):
            p(x)
        {
            if (p.get() == NULL) {throw BadInit;}
        }
        // Return a reference.
        P& GetP() const { return *p; }        
    private:
        // I use auto_ptr just as an example
        // there are many different valid ways to do this.
        // Once the object is correctly initialized p is always valid.
        std::auto_ptr<P> p;
};

// ...
P&  p = c.GetP( );                   // valid
PW& p = dynamic_cast<PW>(c.GetP( )); // valid  Throws exception if not PW
PR& p = dynamic_cast<PR>(c.GetP( )); // valid  Thorws exception if not PR
// ... 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-23T16:52:37.773

鉴于一切都是按值传递的，这种做法是明智的。不知道是不是你想的那样。

```
class P
{
public:
    template <typename T>
    operator T() const
    {
        T t;
        static_cast<T&>(t) = *this;
        return t;
    }
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T16:01:14.010

也许您的意思是[dynamic_cast](http://msdn.microsoft.com/en-us/library/cby9kycs(VS.80).aspx)运算符？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T16:03:10.370

它们不能完全互换。PW是P。PR是P。但是P不一定是PW，也不一定是PR。您可以使用 static_cast 将指针从 PW * 转换为 P *，或从 PR * 转换为 P *。由于“切片”，您不应该使用 static_cast 将实际对象转换为它们的超类。例如。如果您将 PW 的对象投射到 P 中，则 PW 中的额外内容将被“切掉”。您也不能使用 static_cast 从 P * 转换为 PW *。如果您真的必须这样做，请使用 dynamic_cast，它将在运行时检查对象是否实际上属于正确的子类，如果不是，则给您一个运行时错误。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T16:03:34.503

我不确定你的确切意思，但请耐心等待。

他们已经是。只需将所有内容称为 P，您就可以假装 PR 和 PW 是 P。PR 和 PW 还是有区别的。

使所有三个等价会导致[Liskov 原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)出现问题。但是，如果它们真的是等价的，为什么还要给它们起不同的名字呢？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-23T16:09:26.347

第二个和第三个将是无效的，因为它是一个隐式向上转换——这在 C++ 中是一件危险的事情。这是因为您要转换的类比分配的类具有更多功能，因此除非您自己显式转换，否则 C++ 编译器会抛出错误（至少应该如此）。当然，这稍微简化了一些事情（您可以将 RTTI 用于某些可能与您想要安全地做的事情有关的事情，而不会引起对坏对象的愤怒）——但简单性始终是解决问题的好方法。

当然，正如在其他一些解决方案中所述，您可以解决这个问题——但我认为在您尝试解决这个问题之前，您可能需要重新考虑设计。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-09-23T16:00:17.383

使用指向 P 而不是对象的引用或指针：

```
class C
{
 public:
  P* GetP() const { return p; }
 private:
  P* p;
}; 
```

这将允许 PW* 或 PR* 绑定到 Cp 但是，如果您需要从 P 转到 PW 或 PR，则需要使用 dynamic_cast<PW*>(p)，这将返回 PW* p 的版本或 p 的 NULL 不是 PW*（例如，因为它是 PR*）。不过，Dynamic_cast 有一些开销，如果可能的话最好避免（使用虚拟）。

您还可以使用 typeid() 运算符来确定对象的运行时类型，但它有几个问题，包括您必须包含以及它无法检测到额外的派生。

# ajax - 带有 AjaxToolkit 的 Accordion 控件的 Sharepoint WebPart

> ID：121935
> 
> 赞同：1
> 
> 时间：2008-09-23T15:57:21.663
> 
> 标签：ajax, sharepoint, web-parts

你们有关于创建使用 AjaxToolkit 控件的 Sharepoint webpart 的任何资源吗？我需要创建一个使用 Accordion 控件的 webpart，但我找不到任何完整的教程或演练。我更喜欢不使用 SmartPart 的教程/文章。

蒂亚！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-23T16:08:45.413

查看： http: [//www.codeplex.com/sharepointajax](http://www.codeplex.com/sharepointajax)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T09:42:06.047

ajax 工具包和共享点不能很好地结合在一起。主要原因是 SharePoint 的默认 MasterPage 中缺少 DOCTYPE 声明（他们为什么这样做，我永远不会知道）。

在我看来，最好的选择是放弃 ajax 控制工具包并使用 JQuery。如果您点击指向 JQuery UI 的链接，您会发现他们已经实现了一个手风琴控件，该控件可以在各种浏览器/环境中很好地工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-28T22:11:46.330

[Telerik 的](http://www.telerik.com)用于 ASP.Net Ajax 的 Rad 控件可以部署在 Sharepoint 环境中，并且具有开箱即用的 Accordion 行为的菜单控件。它可能会为您节省一些时间。

# xml - 适用于 Windows（或跨平台）的 RSS/ATOM 提要阅读器

> ID：121937
> 
> 赞同：2
> 
> 时间：2008-09-23T15:57:38.763
> 
> 标签：xml, rss, cross-platform

为 Windows 寻找一个好的 rss/feed 阅读器，或者如果有任何好的跨平台，我会非常惊讶，或者好的网络服务（不喜欢谷歌的）。

我想要一些简单和简约的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-23T15:59:11.177

我不会称之为简约，但[FeedDemon](http://www.newsgator.com/Individuals/FeedDemon/Default.aspx)是我为 Windows 找到的最好的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T16:00:09.520

我喜欢 NewsGator 系列工具 ( [http://newsgator.com](http://newsgator.com) )。我主要使用 Mac 和基于 Web 的版本，但认为 FeedDemon 也适用于 Windows 环境。所有人都保留一个共同的订阅列表，因此您可以根据需要来回反弹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T16:25:00.757

我正在使用谷歌阅读器，对此非常满意。它基于浏览器，但具有良好的键盘支持。检查[http://www.google.com/reader](http://www.google.com/reader)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T16:00:16.697

我使用[Net Vibes](http://www.netvibes.com)，它是一个在线 Rss 整理器，可让您将提要分成多个主题。我曾经使用 Thunderbird，但我可以从任何地方访问 netvibes。我还可以设置它来跟踪我的电子邮件和社交网站，因为有很多可用的小部件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T16:07:14.153

有些人喜欢[RSS Bandit](http://www.rssbandit.org/)，但我现在在 Mac 上，所以我不确定它的最新情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T16:13:16.680

展望 2007

Attensa（可插入 Outlook 2003）

新闻记者

互联网浏览器 8

火狐浏览器

我还没有找到具有不错离线功能的免费 Windows RSS 阅读器

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T17:01:25.863

查看[大新闻](http://www.curiostudio.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-24T22:42:13.597

I am using Wizz RSS, a Firefox plugin. Works ok. I am using mainly to access [Sun Java forums](http://forums.sun.com/index.jspa).

[http://www.wizzrss.com/Welcome.php](http://www.wizzrss.com/Welcome.php)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-12T19:07:22.697

Y Use A Rss Reader,,, When You Can get the articles.. Go To The Link

[TNB](http://sourceforge.net/projects/thenewsbook/)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-11-03T13:22:38.560

If you have a Google account already, seriously consider Google Reader. It's available everywhere, with Gears installed it is available offline and binds well to Firefox and Chrome.

# comments - 你觉得你的评论怎么样？

> ID：121945
> 
> 赞同：25
> 
> 时间：2008-09-23T15:58:36.403
> 
> 标签：comments

您对评论的最佳做法是什么？什么时候应该使用它们，它们应该包含什么？或者甚至需要评论？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-09-23T16:01:21.267

注释对于可维护性至关重要。要记住的最重要的一点是解释你**为什么**做某事，而不是你在做**什么**。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-23T16:03:54.660

在学校里，规则是评论一切，以至于评论超过了代码。我认为这很愚蠢。

我认为注释应该用来记录代码背后的“为什么”，而不是“如何”……代码本身解释了“如何”。如果有一个操作并不清楚为什么要完成，这是一个发表评论的好地方。

TODO 和 FIXME 有时会出现在注释中，但理想情况下它们应该出现在您的源代码管理和错误跟踪工具中。

我不介意看似无用的注释的一个例外是文档生成器，它只会打印已注释函数的文档 - 在这种情况下，每个公共类和 API 接口都需要至少得到足够的注释才能获得文档生成。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-23T16:10:25.707

答案通常是：视情况而定。我认为您写评论的原因对于决定是好是坏非常重要。评论有多种可能的原因：

*   使结构更清晰（即哪个循环在这里结束）

**不好：**这看起来像是一种可能的代码异味。为什么代码如此复杂，以至于需要注释来清除它？

*   解释一下代码的作用

**非常糟糕：**我认为这很危险。通常会发生，您稍后更改代码并忘记注释。现在评论是错误的。这真是太糟了。

*   表示解决方法/错误修复

**好：**有时​​一个问题的解决方案看起来很清楚，但简单的方法有问题。如果您解决了问题，添加评论可能会有所帮助，说明选择此方法的原因。否则，稍后的另一个程序员可能会认为，他“优化”了代码并重新引入了错误。想想 Debian OpenSSL 问题。Debian 开发人员删除了一个未初始化的变量。通常一个统一变量是一个问题，在这种情况下它是随机性所需要的。代码注释将有助于清除这一点。

*   用于文档目的

**好：**可以从特殊格式的注释（即 Javadoc）生成一些文档。记录公共 API 很有帮助，这是必不可少的。重要的是要记住，文档包含代码的意图，而不是实现。所以回答评论“为什么需要该方法（以及如何使用它）”或该方法是什么？

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-23T16:07:35.447

理想情况下，您的程序可以通过代码而不是注释与读者交流。在我看来，编写其他程序员可以快速理解的软件的能力将最好的程序员与平均水平区分开来。通常，如果您或您的同事无法理解一段没有注释的代码，那么这是一种“代码异味”，应该按顺序进行重构。但是，会有一些过时的库或其他集成，一些评论来指导普通开发人员并不一定是坏事。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-24T20:09:52.767

我认为删除注释的新运动很糟糕……原因是，有很多程序员认为他们正在编写易于理解的不需要注释的代码。但实际上并非如此。

你阅读了多少其他人的代码并立即理解它。也许我阅读了太多经典的 asp、Perl 和 C++，但我阅读的大多数内容都很难略读。

你有没有读过某人的代码，并被它完全弄糊涂了。你认为他们在写作时会想，这是废话，但我并不在乎。他们可能认为哦……这非常聪明，而且速度会非常**快**。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-02-19T19:27:15.883

只是一些注释：

注释对于不能从代码中轻易推断出的所有内容（例如复杂的数学算法）都很重要。

注释的问题在于，它们需要像代码一样维护，但通常根本不维护。

我不喜欢这样的评论：

```
// Create the "Analyze" button
Button analyzeButton = new Button();
analyzeButton.Text = "Analyze";
analyzeButton.Location = new Point( 100, 100 );
Controls.Add( analyzeButton ); 
```

更好的：

```
CreateAnalyzeButton();

void CreateAnalyzeButton()
{
    Button analyzeButton = new Button();
    analyzeButton.Text = "Analyze";
    analyzeButton.Location = new Point( 100, 100 );
    Controls.Add( analyzeButton );
} 
```

现在代码讲述了整个故事。无需评论。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-23T16:02:00.360

我认为这取决于场景。

方法/函数/类需要简短描述它们的作用、它们是如何做的、它们采用什么以及它们返回什么，如果不是很明显并且通常（在我的代码中）以 javadoc 样式的注释块的形式出现.

块内代码，我倾向于在一行块上方留下注释来解释它的作用，或者如果它是一个简短而神秘的函数调用，则在行尾留下注释。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-23T16:04:49.557

使用标签搜索，您会发现 SO 已经有大量关于代码注释的讨论：

[https://stackoverflow.com/questions/tagged/comments](https://stackoverflow.com/questions/tagged/comments)

[注释代码](https://stackoverflow.com/questions/36432/commenting-code)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-02T05:16:25.437

看看[代码完成](http://cc2e.com/)。它最适合此类主题。

# c# - Assembly.GetCallingAssembly() 和静态构造函数？

> ID：121946
> 
> 赞同：6
> 
> 时间：2008-09-23T15:58:38.993
> 
> 标签：c#, reflection, static-constructor

好的，所以我遇到了以下问题，引起了人们的注意。

由于各种原因，我有一个测试设置，其中 TestingAssembly.dll 中的测试类依赖于 BaseTestingAssembly.dll 中的 TestingBase 类。与此同时，TestBase 所做的一件事是在它自己和调用程序集中寻找某个嵌入式资源

所以我的 BaseTestingAssembly 包含以下几行......

```
public class TestBase {    
  private static Assembly _assembly;
  private static Assembly _calling_assembly;

  static TestBase() {
    _assembly = Assembly.GetExecutingAssembly();
    _calling_assembly = Assembly.GetCallingAssembly();
  }
} 
```

静态，因为我认为这些程序集在应用程序的整个生命周期中都是相同的，所以为什么要在每次测试中重新计算它们。

但是，在运行此程序时，我注意到 _assembly 和 _calling_assembly 都分别设置为 BaseTestingAssembly 而不是 BaseTestingAssembly 和 TestingAssembly。

将变量设置为非静态并在常规构造函数中对其进行初始化修复了此问题，但我很困惑为什么会发生这种情况。我认为静态构造函数在第一次引用静态成员时运行。这只能来自我的 TestingAssembly，它应该是调用者。有谁知道可能发生了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-23T16:17:23.253

静态构造函数由运行时调用，而不是由用户代码直接调用。您可以通过在构造函数中设置断点然后在调试器中运行来查看这一点。调用链中紧接其上方的函数是本机代码。

**编辑：**静态初始化程序在与其他用户代码不同的环境中运行的方式有很多。其他一些方法是

1.  它们被隐式保护免受多线程导致的竞争条件
2.  您无法从初始化程序之外捕获异常

一般来说，最好不要将它们用于任何过于复杂的事情。您可以使用以下模式实现单初始化：

```
private static Assembly _assembly;
private static Assembly Assembly {
  get {
    if (_assembly == null) _assembly = Assembly.GetExecutingAssembly();
    return _assembly;
  }
}

private static Assembly _calling_assembly;
private static Assembly CallingAssembly {
  get {
    if (_calling_assembly == null) _calling_assembly = Assembly.GetCallingAssembly();
    return _calling_assembly;
  }
} 
```

如果您期望多线程访问，请添加锁定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T16:14:45.430

我认为答案在[C# static constructors](http://msdn.microsoft.com/en-us/library/k9x6w0hc(VS.80).aspx)的讨论中。我最好的猜测是静态构造函数是从意外的上下文中调用的，因为：

> 用户无法控制程序中何时执行静态构造函数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T16:07:38.727

Assembly.GetCallingAssembly() 仅返回调用堆栈中第二个条目的程序集。这可能很大程度上取决于调用方法/getter/构造函数的位置。这是我在库中为获取不在我的库中的第一个方法的程序集所做的。（这甚至适用于静态构造函数。）

```
private static Assembly GetMyCallingAssembly()
{
  Assembly me = Assembly.GetExecutingAssembly();

  StackTrace st = new StackTrace(false);
  foreach (StackFrame frame in st.GetFrames())
  {
    MethodBase m = frame.GetMethod();
    if (m != null && m.DeclaringType != null && m.DeclaringType.Assembly != me)
      return m.DeclaringType.Assembly;
  }

  return null;
} 
```

# c# - C# .NET 3.5 GUI 设计

> ID：121947
> 
> 赞同：9
> 
> 时间：2008-09-23T15:58:39.430
> 
> 标签：c#, .net, wpf, winforms, user-interface

我正在寻找一些 C# GUI 设计的编程指南。我来自 Java 阵营（在那里我可以愉快地手动编写 Swing/AWT GUI），因此不知道从哪里开始 :(

另外，Windows Presentation Foundation 和 WinForms 之间有什么区别（如果有的话）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-23T16:01:46.257

**Windows Presentation Foundation**是一个基于矢量的系统，它是 .NET 3.0 的一部分。它允许您在 XAML 中定义您的 UI，并且可以非常轻松地制作各种动画、3D 等。它更新了很多，并且仍在被很多人评估。

**Windows 窗体**是旧 Windows UI 类（Win32/MFC 或其他）的包装器。它随 .NET 1.0 一起提供，并使用 C# 定义所有 UI 及其布局。这是久经考验的真实 UI 方法。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-23T16:13:14.153

就 Windows 窗体和 WPF 而言，Chris Sells 似乎是“大佬”：

> [http://www.sellsbrothers.com/writing/](https://web.archive.org/web/20120415062302/http://www.sellsbrothers.com/writing/)
> [http://www.sellsbrothers.com/writing/wfbook](https://web.archive.org/web/20120507182223/http://www.sellsbrothers.com/writing/wfbook)
> [http://www.sellsbrothers.com/writing/wpfbook](https://web.archive.org/web/20120415192041/http://www.sellsbrothers.com/writing/wpfbook)

还可以看看 Charles Petzold：

> [http://www.charlespetzold.com/winforms/index.html](http://www.charlespetzold.com/winforms/index.html)

从 Windows 的角度来看，MS 也有很多与设计指南和可用性相关的东西：

> [http://msdn.microsoft.com/en-us/library/aa152962.aspx](http://msdn.microsoft.com/en-us/library/aa152962.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T16:19:45.510

WPF 是一种完全不同的全新方式来查看 UI 架构和实现。设计师和 C# 开发人员协作开发的酷概念是最大的优势（XAML 标记实际上提供了这种能力）。当您开发控件/UI 时，它将采用“无外观”的方式，Designer/Integrator 可以采用相同的项目 (XAML) 并为其设置样式以获得更好的外观和感觉。因此，简而言之，WPF 或 Silverlight 是我们进行 winforms 开发方式的一种范式转变。

所以.NET3.5 UI 设计可以通过两种方式完成。1) Winforms 方式 2) WPF-XAML 方式。我认为对于未来主义和现代 UI **，您肯定需要 WPF**而不是 winforms。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-09-16T14:47:30.670

实际上，您可能会**更**喜欢在您的背景下手动编写 WPF，我也使用 Java 完成了我的 Swing 接口的分享，虽然 winforms 使绘制接口变得非常容易，但我能够很快进入 WPF，因为许多布局概念与 Java 相同。由于不同的布局范例，一些仅使用 winforms 的程序员在进入 WPF 时确实很困难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T19:55:08.613

没有提到[Alan Coopers About Face](http://en.wikipedia.org/wiki/Alan_Cooper)就没有提到 GUI 设计是不完整的，尽管乍一看它看起来已经过时了（大多数屏幕截图都是 windows 3.1）它的内容今天仍然有效

# asp.net - 在 asp.net 中确定站点的绝对、完全限定的 url

> ID：121962
> 
> 赞同：8
> 
> 时间：2008-09-23T16:00:16.773
> 
> 标签：asp.net, url, uri

无论站点是否在虚拟目录中，也无论我的代码在目录结构中的什么位置，我怎样才能始终如一地获得站点的绝对、完全限定的根或基本 URL？我已经尝试了所有我能想到的变量和函数，但没有找到好的方法。

我希望能够获取当前站点的 url，即[http://www.example.com](http://www.example.com)或者如果它是一个虚拟目录，[http://www.example.com/DNN/](http://www.example.com/DNN/)

* * *

这是我尝试过的一些事情和结果。唯一包含我想要的整个部分（[http://localhost:4471/DNN441](http://localhost:4471/DNN441)）的是 Request.URI.AbsoluteURI：

*   Request.PhysicalPath: C:\WebSites\DNN441\Default.aspx
*   请求.应用程序路径：/DNN441
*   Request.PhysicalApplicationPath: C:\WebSites\DNN441\
*   地图路径：C:\WebSites\DNN441\DesktopModules\Articles\Templates\Default.aspx
*   RawURL：/DNN441/ModuleTesting/Articles/tabid/56/ctl/Det​​ails/mid/374/ItemID/1/Default.aspx
*   Request.Url.AbsoluteUri：[http://localhost:4471/DNN441/Default.aspx](http://localhost:4471/DNN441/Default.aspx)
*   Request.Url.AbsolutePath: /DNN441/Default.aspx
*   Request.Url.LocalPath: /DNN441/Default.aspx Request.Url.Host: localhost
*   Request.Url.PathAndQuery: /DNN441/Default.aspx?TabId=56&ctl=Details&mid=374&ItemID=1

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-23T20:52:03.690

在阅读 Rick Strahl 的博客中提供的答案时，我发现我真正需要的非常简单。首先，您需要确定相对路径（对我来说这很容易），并将其传递给下面定义的函数：

VB.NET

```
Public Shared Function GetFullyQualifiedURL(ByVal s as string) As String
   Dim Result as URI = New URI(HttpContext.Current.Request.Url, s)
   Return Result.ToString
End Function 
```

C＃

```
public static string GetFullyQualifiedURL(string s) {
    Uri Result = new Uri(HttpContext.Current.Request.Url, s);
    return Result.ToString();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-18T18:46:31.963

接受的答案假定当前请求已经在服务器/虚拟根目录中。试试这个：

```
Request.Url.GetLeftPart(UriPartial.Authority) + Request.ApplicationPath 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-23T16:01:45.507

[Rick Strahl 的博客](http://www.west-wind.com/Weblog/posts/154812.aspx)上有一些很棒的讨论和想法

编辑：我应该补充一点，无论有没有有效的 HttpContext，这些想法都有效。

EDIT2：这是该帖子上回答问题的[具体评论/代码](http://www.west-wind.com/Weblog/posts/154812.aspx#466571)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-19T13:13:45.697

在这里找到[这段代码](http://www.geekpedia.com/KB44_Get-the-path-of-the-ASP.NET-web-application-that-is-currently-running.html)：

```
string appPath = null;

appPath = string.Format("{0}://{1}{2}{3}",
    Request.Url.Scheme,
    Request.Url.Host,
    Request.Url.Port == 80 ? string.Empty : ":" + Request.Url.Port,
    Request.ApplicationPath); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T16:02:53.553

您是否尝试过通常在 web.config 文件中配置的 AppSettings.RootUrl？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-23T16:05:08.137

您是在谈论用作链接吗？

如果是这样，那么这样做`<a href='/'>goes to root</a>`会将您带到 Web 根目录的默认文件。

现在，对于客户端，将“~/”传递给 Control::ResolveUrl 方法将为您提供所需的内容。（[http://msdn.microsoft.com/en-us/library/system.web.ui.control.resolveurl.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.control.resolveurl.aspx)）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-23T16:45:12.423

我目前无法验证这一点，但您是否尝试过另一台机器上的“Request.Url.AbsoluteUri”？

我突然想到，就您的机器而言，它的浏览器正在从本地主机请求。

虽然我可能是错的，但我认为请求是相对于浏览器而不是网络服务器。

# asp-classic - 如何在（经典）ASP 中检测屏幕分辨率

> ID：121979
> 
> 赞同：1
> 
> 时间：2008-09-23T16:03:02.180
> 
> 标签：asp-classic

我想检测用户的屏幕尺寸并将其传递给图表应用程序（[http://www.advsofteng.com](http://www.advsofteng.com)的 Chart Director ）来控制要显示的图像大小。

我必须使用 ASP，但我只能考虑使用 JavaScript 来检测屏幕大小，然后将其传递给服务器端脚本。有没有更简单的方法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-23T16:04:55.640

不，除了 IP 和浏览器版本等基本信息之外，服务器对客户端一无所知。屏幕分辨率可以很容易地通过 javascript 确定并通过 ajax 或通过表单提交传递给服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-23T16:04:37.403

这里有几个链接应该会有所帮助

[http://www.javascriptkit.com/howto/newtech3.shtml](http://www.javascriptkit.com/howto/newtech3.shtml)

[http://www.devcity.net/Articles/64/1/screenresolution.aspx](http://www.devcity.net/Articles/64/1/screenresolution.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-16T03:33:49.760

这是我的简单解决方案：

javascript代码：

```
document.cookie = "screen_w=" + screen.availWidth ;
document.cookie = "screen_h=" + screen.availHeight; 
```

ASP代码：

```
screen_w = request.Cookies("screen_w")
screen_h = request.Cookies("screen_h") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-23T16:29:23.163

不，这对于桌面浏览器是不可能的。我建议嵌入适合典型屏幕分辨率的图像，然后检测画布大小，并重写图像的`src`属性以反映这一点。

无论如何，你*不想*看屏幕分辨率，你想看画布大小。不是每个人都使用最大化窗口的浏览器，尤其是那些大屏幕的浏览器。如果您使用屏幕分辨率，那么您最终会提供对某些人来说太大的图像。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-23T16:58:41.987

您不能仅获取浏览器窗口大小的用户屏幕大小，这可以使用 javascript。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-22T10:42:49.967

我发现做到这一点的最好方法是创建一个虚拟 asp 页面，该页面在标题中仅包含以下 javascript 代码：

```
<script type="text/javascript" language="JavaScript">

    document.cookie = "screen_w=" + screen.width;
        location.href = "second_page.asp"

</script> 
```

然后在 second_page.asp 中您可以查找在第一页中设置的 cookie。如果您在同一页面中设置然后请求，则第一次将无法正常工作。

myscreenwidth = request.Cookies("screen_w")

# architecture - MMORPG / VR架构

> ID：121981
> 
> 赞同：8
> 
> 时间：2008-09-23T16:03:12.213
> 
> 标签：architecture, 3d, virtual-reality

任何人都可以提供文章/博客的链接，讨论 MMORPG 或虚拟现实服务器或其他具有丰富 3D 客户端的系统的架构。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-23T16:09:05.583

这些应该可以帮助您入门：

[MMORPG 的分布式架构](http://www.comp.nus.edu.sg/~bleong/hydra/related/assiotis06mmorpg.pdf)

[MMORPG 的服务器架构概念](http://www.daniweb.com/blogs/entry1271.html)

[构建简单而强大的 MMO 游戏架构](http://www.ibm.com/developerworks/architecture/library/ar-powerup1/)

[...以及产生这些的谷歌搜索。](http://www.google.com/search?ie=UTF-8&oe=UTF-8&sourceid=navclient&gfns=1&q=mmorpg+architectures)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-03T19:53:56.643

讨厌死一个旧线程，但我在搜索中遇到了这个资源（连同这个线程）：

[http://onlinegametechniques.blogspot.com/](http://onlinegametechniques.blogspot.com/)

看起来很多很棒的概念。现在，火焰开启和关闭投票。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-23T16:10:56.843

我找到[了这篇期刊文章](http://portal.acm.org/citation.cfm?id=771339&dl=ACM&coll=portal&CFID=11111111&CFTOKEN=2222222)

通过[http://www.gamedev.net/community/forums/topic.asp?topic_id=410490](http://www.gamedev.net/community/forums/topic.asp?topic_id=410490)。Gamedev.net 有一个关于多人游戏和网络编程的论坛。我建议在那个论坛上搜索一下。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-23T16:14:26.740

有关游戏编程的信息，您可以尝试：

[伽马苏特拉](http://www.gamasutra.com/)

# java - 如何将 REGEX 匹配添加到我的 J2ME 项目？

> ID：121988
> 
> 赞同：4
> 
> 时间：2008-09-23T16:04:36.937
> 
> 标签：java, regex, java-me

这个问题几乎概括了它。只想在 J2ME 中对字符串运行正则表达式匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-21T11:56:41.400

JRegex 不会在 CLDC 设备上运行。试试这个：[code.google.com/p/regexp-me/](http://code.google.com/p/regexp-me/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-23T16:10:20.230

JRegex会在 J2ME 中运行吗[？](http://jregex.sourceforge.net/)

更新：根据 Rory 的评论，我推荐 JRegex。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-07T18:43:58.463

JRegex 不能在 J2ME 上编译（至少在黑莓开发环境中）。我也对正则表达式库感兴趣，但 JRegex 似乎不适用于此目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T18:54:47.223

由于 J2ME 的 API 支持太老了，很难判断 J2ME 上运行的是什么*，*但请尝试[Apache ORO](http://jakarta.apache.org/oro/index.html)。那已经足够老了、硬壳和过时了，如果幸运的话，它*可以在 J2ME 上工作。*********************