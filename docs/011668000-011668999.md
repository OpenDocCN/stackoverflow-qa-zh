# StackOverflow 问答 11668000-11668999

# struts2 - 奇怪的struts2行为

> ID：11668005
> 
> 赞同：0
> 
> 时间：2012-07-26T11:11:38.167
> 
> 标签：struts2

发生了一些奇怪的事情。

参数拦截器负责从请求中获取参数字符串值并将它们放入我的操作的 java 属性中。

存在一些默认类型转换器（主要类型、日期、地图、数组）

我试图将一个字符串参数放在 BigDecimal 中。奇怪的是......它的工作原理，但如何？我很确定 BigDecimal 转换器不存在，必须由框架用户实现

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:50:06.427

如果我是正确的，它正在使用默认的 BigDecimal 解析。看看[DefaultTypeConverter](http://struts.apache.org/2.2.3/xwork-core/apidocs/com/opensymphony/xwork2/conversion/impl/DefaultTypeConverter.html)

# android - 从 ArrayAdapter 上的 ListView 过滤项目的问题

> ID：11668011
> 
> 赞同：0
> 
> 时间：2012-07-26T11:11:55.900
> 
> 标签：android, listview, filter, adapter, android-arrayadapter

我正在尝试做一个搜索栏，根据用户输入的关键字过滤列表视图，代码没有错误，但根本没有过滤。知道问题可能是什么吗？我尝试了各种方法，但都没有成功。

创建

```
super.onCreate(savedInstanceState);
// set layout for the main screen
setContentView(R.layout.layout_main);

// load list application
mListAppInfo = (ListView)findViewById(R.id.lvApps);
EditText search = (EditText)findViewById(R.id.EditText01);

mListAppInfo.setTextFilterEnabled(true);

// create new adapter
final AppInfoAdapter adapter = new AppInfoAdapter(this, Utilities.getInstalledApplication(this), getPackageManager());

// set adapter to list view  
mListAppInfo.setAdapter(adapter);

search.addTextChangedListener(new TextWatcher() {

    public void afterTextChanged(Editable s) {

    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
        Log.e("TAG", "ontextchanged");
       adapter.getFilter().filter(s); //Filter from my adapter
       adapter.notifyDataSetChanged(); //Update my view
    }
}); 
```

ArrayAdapter 类

```
public class AppInfoAdapter extends ArrayAdapter<ApplicationInfo> {

    private Context mContext;
    PackageManager mPackManager;

    public AppInfoAdapter(Context c, List<ApplicationInfo> list, PackageManager pm) {
        super(c, 0, list);
        mContext = c;
        mPackManager = pm;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        // get the selected entry
        ApplicationInfo entry = (ApplicationInfo) getItem(position);

        Log.e("TAG", entry.toString());

        // reference to convertView
        View v = convertView;

        // inflate new layout if null
        if(v == null) {
            LayoutInflater inflater = LayoutInflater.from(mContext);
            v = inflater.inflate(R.layout.layout_appinfo, null);
        }

        // load controls from layout resources
        ImageView ivAppIcon = (ImageView)v.findViewById(R.id.ivIcon);
        TextView tvAppName = (TextView)v.findViewById(R.id.tvName);
        TextView tvPkgName = (TextView)v.findViewById(R.id.tvPack);

        // set data to display
        ivAppIcon.setImageDrawable(entry.loadIcon(mPackManager));
        tvAppName.setText(entry.loadLabel(mPackManager));
        tvPkgName.setText(entry.packageName);

        // return view
        return v;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T10:40:55.483

有两种可能的方法来解决这个问题

1.使用自己的过滤算法过滤适配器。有关详细信息，请参阅此博文 [http://www.mokasocial.com/2010/07/arrayadapte-filtering-and-you/](http://www.mokasocial.com/2010/07/arrayadapte-filtering-and-you/)

2\. 第二种更简单的方法是覆盖您可能已经定义的 Custom RowItem 类中的 tostring 方法

```
 @Override
        public String toString() {
            return name + "\n" + description;
        } 
```

并使用 adapter.getFilter().filter(s); 因此，您正在使用它现在可以工作，因为您的适配器现在返回一个有效的字符串来过滤

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:33:56.137

调用`adapter.getFilter().filter(s)`使用 ArrayAdapter 的默认`String`过滤逻辑，但由于您的列表类型是 of `ApplicationInfo`，因此 ArrayAdapter`ApplicationInfo#toString()`用于项目比较
，这[看起来不像您想要过滤的东西](http://developer.android.com/reference/android/content/pm/ApplicationInfo.html#toString%28%29)。

# c# - 即使选择查询不返回任何行，如何用元数据填充数据集

> ID：11668013
> 
> 赞同：0
> 
> 时间：2012-07-26T11:12:03.677
> 
> 标签：c#, wpf, ado.net

我正在使用 WPF 数据绑定到数据集来显示表的内容。
SELECT 语句不能返回任何记录，并且数据表不会从中获取任何元数据。然后 WPF`DataGrid`被最小化，没有列。
我知道可以专门查询表的元数据，但我正在检查是否有速记方法。

如果查询为空，我如何仍然获取列信息？

*人们喜欢看代码所以这里是*
目前我有：

```
<DataGrid AutoGenerateColumns="True" EnableRowVirtualization="True" 
    ItemsSource="{Binding Path=SelectedUserTable, Mode=TwoWay}"  Name="userTablesContentGrid"
    RowDetailsVisibilityMode="VisibleWhenSelected" VerticalAlignment="Stretch">            
</DataGrid> 
```

在我的视图模型中。调用 DisplayUserTable 加载`SelectedUserTable`属性

```
public void DisplayUserTable(string tableName)
{
    if (!UserTablesDataSet.Tables.Contains(tableName))
    {
        FillTable(tableName);
    }
    SelectedUserTable = UserTablesDataSet.Tables[tableName];
    InvokePropertyChanged("SelectedUserTable");
}

private void FillTable(string tableName)
{
    UserTablesDataAdapter.SelectCommand = new SqlCommand(string.Format("SELECT * FROM [{0}]", tableName), _conn);
    UserTablesDataAdapter.Fill(UserTablesDataSet, tableName);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:14:57.303

发出 DataAdapter.FillSchema 命令。

```
UserTablesDataAdapter.FillSchema(UserTablesDataSet, SchemaType.Mapped); 
```

# vim - VIM 自动缩进不能正常工作

> ID：11668014
> 
> 赞同：3
> 
> 时间：2012-07-26T11:12:06.023
> 
> 标签：vim, vim7.3

在 VIM 中，当我键入`gg=G`自动缩进整个代码时，所有内容都会正确缩进，除了具有以下结构的行：

```
$my_arr = array(
    'a' => 1,
    'b' => 2,
) 
```

我已将*shiftwidth*和*tabstop*设置为 2，但它会将数组元素缩进 4 个空格。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-24T14:24:15.303

你从来没有回答过关于`'indentexpr'`. 可能这意味着它是空的。尝试

```
:set indentexpr=GetPhpIndent() 
```

如果您有，这应该自动设置

```
:filetype plugin indent on 
```

在你的 vimrc 文件中。我间接地从

```
:source $VIMRUNTIME/vimrc_example.vim 
```

看

```
:help :filetype
:help :filetype-indent-on
:help php-indent 
```

# android - 查找按钮的 id

> ID：11668018
> 
> 赞同：-1
> 
> 时间：2012-07-26T11:12:16.890
> 
> 标签：android, button

我的 android 应用程序中有一个按钮。它的参考是`button1`即

`button1 = (Button) findViewById(R.id.tv6);`

在某些函数中，我收到一个带有 value 的字符串`button1`。使用这个字符串我需要得到`id`上面的按钮。怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:32:04.423

使用以下：

```
int resID = getResources().getIdentifier(idName, "id", getPackageName()); 
```

通过这种方法你会得到id，通过id你可以得到View。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:29:13.753

就是这样：

```
int buttonId = R.id.button1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:14:32.240

用这个

```
Button mButton  = (Button)findViewById(R.id.button1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T11:15:06.280

将 xml 文件中的按钮设置为：

```
<Button android:id="@+id/button1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="hello"/> 
```

你可以得到它的 id 为：

```
Button button=(Button) findViewById(R.id.button1); 
```

# php - PHP获取列中（不同）数据的数量

> ID：11668019
> 
> 赞同：1
> 
> 时间：2012-07-26T11:12:20.470
> 
> 标签：php, distinct

嗨！

如何从我的 PHP 表的第 3 列和第 6 列获取不同数据的数量：

```
<?php 
```

打开的文本文件（第一行是由;划分的标题）

```
$fp = fopen('C:\...\usedlicences.txt','r') or die("can't open file"); 
```

创建带边框的表格

```
echo "<table id='MyTable' border='1'>\n"; 
```

为带有标题的表创建标题行

```
echo "<td><b>id</b><td><b>name</b></td><td><b>surname</b></td><td><b>address</b></td><td><b>state</b></td><td><b>phone</b></td><td><b>city</b></td><td><b>date</b></td><td><b>color</b></td>";                          
$length = 1000;
$delimiter = ";";      
$k=1; 
```

从文件创建行并用数据填充它们（跳过第一个（标题）行）并添加第一列，其中写入行的 id

```
$csv_line = fgetcsv( $fp, $length, $delimiter); 
while($csv_line = fgetcsv( $fp, $length, $delimiter ) ) {
echo "<tr>";            
echo "<td>$k</td>";
$k++;   
for ($i = 0, $j = count($csv_line); $i < $j; $i++) {
echo '<td>'.$csv_line[$i].'</td>';  
}
}
echo "<tr>";   
echo '</table>';
fclose($fp) or die("can't close file");
?> 
```

用于显示使用了多少许可证的警报（所有行减去标题行）

```
<script language="JavaScript">
var oRows = document.getElementById('MyTable').getElementsByTagName('tr');
var iRowCount = oRows.length-1;
alert('Licences used: ' + ((iRowCount)-1)+'!');
</script> 
```

test.txt 看起来像：

```
id;name;surname;address;state;phone;city;date;color
1;John;Simts;Yellow 12;Greenik;1234567;Mannds;12/3/1234;blue 
```

谢谢，问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:35:30.930

在你的 for 循环中放置以下代码：

```
if ($i==3) 
   $surname[$csv_line[$i]]++;
else if ($i==6)
   $phone[$csv_line[$i]]++; 
```

那么姓氏（第 3 列）和电话（第 6 列）的不同记录数将是：

```
count($surname);
count($phone); 
```

分别。

# android - 轻松复制我的 android 应用程序

> ID：11668020
> 
> 赞同：1
> 
> 时间：2012-07-26T11:12:22.777
> 
> 标签：android, version-control

我有一个客户的安卓应用程序，他想为不同的国家制作一个 99% 相似的应用程序。

几乎一切都是一样的，只需要替换几个位图，API 服务器的地址会改变，语言文件会改变，但代码应该保持不变，**但是**我需要一个不同的包名。

什么是克隆应用程序的简单方法，允许我对一个版本进行代码更改，将它们与新版本（或多个版本）合并，但保留包名称？

还是我应该将所有内容都放在一个项目文件夹中，然后编写并运行一些脚本来更改包名称和交换内容文件？我的 iOS 朋友可能需要几个不同的#defines，但是我应该在这里做什么，以便将来可以维护这两个版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:19:23.820

将您的原始项目声明为库，然后为一种语言创建 2 个新项目，并让它们包含原始项目作为库

然后你可以继续并覆盖你需要的位图和常量。

这样，如果您需要对核心功能进行任何更改，您只需更改您的库项目，更改将传播到两个扩展项目

在此处阅读有关图书馆项目的更多信息：

[https://developer.android.com/tools/projects/index.html#LibraryProjects](https://developer.android.com/tools/projects/index.html#LibraryProjects)

# javascript - 如何使用 Jquery 解析多个 XML 数据？

> ID：11668025
> 
> 赞同：-1
> 
> 时间：2012-07-26T11:12:30.197
> 
> 标签：javascript, jquery, xml, jquery-mobile, xml-parsing

我正在使用 Ajax 调用获得 XML 响应，我可以解析数据，但只能解析单个数据而不是多个数据元素，我在 xml 响应中得到的是：

```
 <GetTimeSlotsForUserType_1Response>
             <GetTimeSlotsForUserType_1Result>
              <NewDataSet xmlns="">
              <Table diffgr:id="Table1" msdata:rowOrder="0">
                 <SlotId>406</SlotId>
                 <TimeAvailable> 01:00</TimeAvailable>
                 <CutOffHours>0.50</CutOffHours>
                 <Sequence>1</Sequence>
              </Table>
              <Table diffgr:id="Table2" msdata:rowOrder="1">
                 <SlotId>408</SlotId>
                 <TimeAvailable>02:00</TimeAvailable>
                 <CutOffHours>0.50</CutOffHours>
                 <Sequence>1</Sequence>
              </Table>
              <Table diffgr:id="Table3" msdata:rowOrder="2">
                 <SlotId>410</SlotId>
                 <TimeAvailable>03:00</TimeAvailable>
                 <CutOffHours>0.50</CutOffHours>
                 <Sequence>1</Sequence>
              </Table>
              <Table diffgr:id="Table4" msdata:rowOrder="3">
                 <SlotId>412</SlotId>
                 <TimeAvailable>04:00</TimeAvailable>
                 <CutOffHours>0.50</CutOffHours>
                 <Sequence>1</Sequence>
              </Table>
              <Table diffgr:id="Table5" msdata:rowOrder="4">
                 <SlotId>414</SlotId>
                 <TimeAvailable>05:00</TimeAvailable>
                 <CutOffHours>0.50</CutOffHours>
                 <Sequence>1</Sequence>
              </Table>
           </NewDataSet>
     </GetTimeSlotsForUserType_1Result>
  </GetTimeSlotsForUserType_1Response> 
```

我需要各种元素并将它们一一放在我的 HTML 页面的选择菜单中。

jQuery代码：

```
function GetTimeSlotsForUser(){
var soapMessage4='<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Body><GetTimeSlotsForUserType_1 xmlns="http://there.org/"><opFacId>'+ OpFacId +'</opFacId><requestType>'+ check +'</requestType><category>'+ category +'</category><availableFor>'+ issignee +'</availableFor></GetTimeSlotsForUserType_1></soap:Body></soap:Envelope>';

 $.ajax({
    url: "http://33.204.22.31/therewebservice/therewebservice.asmx?op=GetTimeSlotsForUserType_1",
    type: "POST",
    dataType: "xml",
    SOAPAction: "http://there.org/GetTimeSlotsForUserType_1",
    data: soapMessage4,
    complete: endSaveProduct4,
    contentType: "text/xml; charset=\"utf-8\""
       });

return false;
}

function endSaveProduct4(xmlHttpRequest,status){
var optionlist='<option value="select-value-2">-- Select Time --</option>';

$(xmlHttpRequest.responseXML)
.find('NewDataSet')
.each(function()
      {
      var timeAvailable=$(this).find('TimeAvailable').text();
      optionlist += '<option>' + timeAvailable + '</option>';

      });
$("#select-choice-2").html(optionlist).selectmenu('refresh', true);
} 
```

直到这里我能够在选项列表中获取数据，但它只是抓取所有元素并将其作为一个选项放在我的选择菜单中，如下所示......：

![您可以看到数据来自一个选项，而不是不同的选项](../Images/453d75108765436fd11a00cfbf94f477.png)

我想要的是从 xml 中解析所有不同的“可用时间”元素，并将其显示为选择菜单中的多个选项。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:35:29.477

这应该工作

```
timeSlots = $(xmlHttpRequest.responseXML).find('TimeAvailable')
$(timeSlots).each(function(){ 
    optionlist += '<option>' + $(this).text() + '</option>';
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:26:49.950

使用[OpenJS](http://www.openjs.com/scripts/xml_parser/)将 XML 解析为 js 对象。接下来的步骤很简单。

# c# - 从命令获取可执行文件的路径（如 cmd 一样）

> ID：11668026
> 
> 赞同：11
> 
> 时间：2012-07-26T11:12:41.460
> 
> 标签：c#, .net, path, cmd, command-prompt

给定命令的命令行样式路径，例如`bin/server.exe`or `ping`，我如何获得该可执行文件的完整路径（作为 cmd 或`Process.Start`将解析它）？

我试过`Path.GetFullPath`了，但它总是相对于工作目录扩展。它可以正确扩展`bin/server.exe`，但是如果`ping`它返回`c:\users\matt\ping`（不存在）。我想要`c:\Windows\system32\ping.exe`。

编辑：我想要与 cmd 相同的行为。一些考虑：

1.  当路径中有同名的本地可执行文件时， cmd 首选本地可执行文件
2.  cmd 可以将命令扩展`server`为`server.bat`或`server.exe`（*添加文件扩展名*）

我还尝试了 Windows 的命令行工具`where`. 它*几乎*是我想要的：

> 显示与搜索模式匹配的文件的位置。默认情况下，搜索是沿着当前目录和 PATH 环境变量指定的路径进行的。

```
>where ping
C:\Windows\System32\PING.EXE
>where bin\server
INFO: Could not find files for the given pattern(s). 
```

* * *

（这个问题很难搜索，因为“路径”这个词有两种不同的含义）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T15:20:22.760

也考虑到 PATHEXT，从 Serj-Tm 的答案中窃取（对不起！+1 给他）：

```
public static string WhereSearch(string filename)
{
    var paths = new[]{ Environment.CurrentDirectory }
            .Concat(Environment.GetEnvironmentVariable("PATH").Split(';'));
    var extensions = new[]{ String.Empty }
            .Concat(Environment.GetEnvironmentVariable("PATHEXT").Split(';')
                       .Where(e => e.StartsWith(".")));
    var combinations = paths.SelectMany(x => extensions,
            (path, extension) => Path.Combine(path, filename + extension));
    return combinations.FirstOrDefault(File.Exists);
} 
```

抱歉，缩进有点乱 - 我试图让它不滚动。我不知道 StartsWith 检查是否真的有必要 - 我不确定 CMD 如何处理没有前导点的 pathext 条目。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-26T11:38:14.547

```
public static string GetFullPath(string filename)    
{
 return new[]{Environment.CurrentDirectory}
  .Concat(Environment.GetEnvironmentVariable("PATH").Split(';'))
  .Select(dir => Path.Combine(dir, filename))
  .FirstOrDefault(path => File.Exists(path));
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-26T11:23:08.283

如果您只对搜索当前目录和 PATH 环境变量中指定的路径感兴趣，则可以使用[以下](https://stackoverflow.com/a/3856090/266143)代码段：

```
public static string GetFullPath(string fileName)
{
    if (File.Exists(fileName))
        return Path.GetFullPath(fileName);

    var values = Environment.GetEnvironmentVariable("PATH");
    foreach (var path in values.Split(';'))
    {
        var fullPath = Path.Combine(path, fileName);
        if (File.Exists(fullPath))
            return fullPath;
    }

    return null;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-26T11:21:54.617

您必须搜索整个磁盘。

Windows 可以响应 iexplore、ping、cmd 等内容，因为它们位于注册表项下：

```
HKEY_LOCAL_MACHINE
   SOFTWARE
       Microsoft
           Windows
               CurrentVersion
                   App Paths 
```

唯一的另一种方法是在整个磁盘中搜索应用程序。

编辑：我的理解是，您要搜索任何随机的可执行文件名称，而不是 Windows 已经知道的名称。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-26T11:21:50.523

```
internal class Program
{
    static void Main(string[] args)
    {
        string fullPath = GetExactPathFromEnvironmentVar("ping.exe");
        if (!string.IsNullOrWhiteSpace(fullPath))
            Console.WriteLine(fullPath);
        else
            Console.WriteLine("Not found");
    }

    static string GetExactPathFromEnvironmentVar(string program)
    {
        var pathVar = System.Environment.GetEnvironmentVariable("PATH");
        string[] folders = pathVar.Split(';');

        foreach (var folder in folders)
        {
            string path = Path.Combine(folder, program);
            if (File.Exists(path))
            {
                return path;
            }
        }

        return null;
    }
} 
```

高温高压

# php - 在我的网址中添加斜杠

> ID：11668028
> 
> 赞同：-2
> 
> 时间：2012-07-26T11:12:49.083
> 
> 标签：php, .htaccess, web-hosting

自从两天试图用 htaccess 重写我的 php 网站的 url 以来，我遇到了一个严重的问题。

```
Options +FollowSymlinks
RewriteEngine On

RewriteRule devis demande-devis.php
RewriteRule mentions-legales mentions-legales.php
RewriteRule condition-utilisation condition-utilisation.php
RewriteRule condition-generales-ventes condition-generales-ventes.php
RewriteRule fournisseur fournisseur.php
RewriteRule qui-sommes-nous qui-sommes-nous.php
RewriteRule faq faq.php
RewriteRule services services.php

RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !example.php
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*)$ http://%{HTTP_HOST}/$1/ [L,R=301] 
```

但是，例如，我期望的是拥有`http://www.example.com/services/`.

使用代码，当我在浏览器地址栏中键入该 URL 时，我有一个没有 CSS 的网页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:21:04.910

最有可能的问题是 css 文件 url 的相对表示法与绝对表示法。查阅 http 服务器错误日志以查看实际引用的内容或检查缺少样式定义的页面的交付 html 源。

您在对问题的评论中指定的页面显示了 css 文件的相对引用和绝对引用。但是，您没有针对这些的重写规则...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:19:40.980

这照常工作。只需确保为 CSS 文件设置正确的链接，以便浏览器能够在没有 404 的情况下从您的服务器请求它们。

由于您可能在编写 php 脚本后编辑了 .htaccess 文件中的 URL，因此您也需要在 PHP 脚本中反映这些更改，方法是更新其中的链接。

监控您的服务器错误日志以找出错误发送的 URI。

回顾那些。

然后通过修复错误输出来改进应用程序的输出。

另请参阅：

*   [自己动手做通用页眉/页脚.php](https://stackoverflow.com/q/9215791/367456)

以及与问题根源有关的类似问题。

# java - 在 c 中创建短整数数组，如 java short[]

> ID：11668029
> 
> 赞同：2
> 
> 时间：2012-07-26T11:12:53.537
> 
> 标签：java, c++, c

爪哇：

```
byte[] arr1=new byte[]{0x01};
String aa = "helloo";
short[] s1 = new short[1]; // **
s1[0] = 246;               // **

Object[] obj = new Object[]{s1,arr1,aa} 
```

C：

```
signed char a1[] = {0x01};
char *str = "helloo";
short int st1[] = {246}; // **

char*  c [] = {st1,str1,c2}; 
```

是否`short int st1[] = {246}`正确？我收到了这个错误：
“ `illegal implicit conversion from 'short *' to 'char *'`”。如何将short分配给char？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T11:17:19.560

```
char*  c [] 
```

是指针数组，而不是字符数组。

使用类似的东西

```
short st1[] = { 246 };
char* str = "helloo";
char  c [] = {st1[0], str[0], str[1], str[2], str[3], str[4], str[5]}; 
```

`str[i]`获取单个字符，因为 'char* str' 指向数组的第一个元素。

如果您需要一个字符串数组，请制作它

```
char tmp[1024];
// itoa is the conversion of st1[0] to string
char* c[] = { itoa(st1[0], tmp, 10), str }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:19:18.827

C++ 没有基本的 Object 类型。您必须将字符串全部转换为特定类型。

```
std::string wtf[]= { std::string(a1, a1+ 1), std::string(st1, st1+ 1), std::string(str) }; // don't forget to #include <string> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:19:31.963

在 C 或 C++ 中，没有适用于所有类型的通用基类（如 Java 的`Object`），您可以使用的最好的方法是`void* c[]=...;`（void* 代表无类型指针，因此它可以保存任何内容）或显式转换为所需的类型（但它是未定义的通过字符指针访问short）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T11:18:54.630

投射`st1`到`char*`. IE：

```
char*  c [] = {(char*)st1,str1,c2}; 
```

`short*`请注意，如果要获取正确的数据，则必须在访问它指向的元素时将指针转换回。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T11:19:02.447

虽然强烈不推荐，但 c 中 las 行的大致等价物是：

```
void*  c [] = {st1,str1,c2}; 
```

# python - Griddata创建不良形状scipy

> ID：11668031
> 
> 赞同：2
> 
> 时间：2012-07-26T11:12:55.143
> 
> 标签：python, numpy, scipy, gaussian, interpolation

我正在使用此[代码](https://docs.google.com/file/d/0Bxv8ab9PeMQVbGRLdGktQXpQb0k/edit)使用 griddata 可视化我的数据。代码如下所示：

```
import math 
import numpy as np
from scipy.interpolate import griddata
import matplotlib.pyplot as plt

**THE LIST C=DATA IS IN THE LINK ABOVE**

cx=np.asarray([row[0] for row in C])
cy=np.asarray([row[1] for row in C])
cz=np.asarray([row[2] for row in C])

xi = np.linspace(22.4,22.5,10)
yi = np.linspace(37,37.1,10)
# grid the data.
zi = griddata((cx, cy), cz, (xi[None,:], yi[:,None]), method='nearest')

plt.contourf(xi,yi,zi,300,cmap=plt.cm.jet)
# draw colorbar
plt.colorbar() 

plt.xlim(xmin=22.4,xmax=22.5)
plt.ylim(ymin=37,ymax=37.1)
plt.title('no diamonds please')
plt.show() 
```

如您所见，有一些菱形形状实际上应该像高斯的轮廓，例如[此处所示](http://www.google.com/imgres?start=312&hl=el&biw=1600&bih=730&tbs=imgo:1&tbm=isch&tbnid=RndWbW1jVB4oZM%3a&imgrefurl=http://ammar-hakim.org/sj/je/je1/je1-periodic-poisson.html&docid=ukuFb9_h0EExhM&imgurl=http://ammar-hakim.org/sj/_images/s2-periodic-poisson_2d_src_sol.png&w=800&h=600&ei=FyERUNCPD8f34QTg34DoBA&zoom=1&iact=hc&vpx=1087&vpy=408&dur=472&hovh=194&hovw=259&tx=104&ty=104&sig=106447174075007480182&page=12&tbnh=161&tbnw=215&ndsp=28&ved=1t:429,r:25,s:312,i:176)

难道我做错了什么？我应该使用其他工具而不是 griddata 吗？我在使用 sagemath 时遇到了问题，现在切换到“纯”python。请记住 Noob 级别:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T10:45:29.217

愚蠢的是，答案只是增加 linspace 中“步长”的值，例如：

```
xi = np.linspace(22.4,22.5,100) 
```

# php - 如何检查是否向特定外部网页发出请求

> ID：11668039
> 
> 赞同：0
> 
> 时间：2012-07-26T11:13:18.160
> 
> 标签：php, javascript, statistics, ads

我正在为我的网站创建一个插件来记录我的广告点击。

我刚刚想到的一种方法是检查是否对特定页面发出了请求。这是因为一旦广告开始播放，它们总是会从特定的外部网页请求数据。

我可以这样做吗？如果是，请指出我正确的方向。

一个典型的请求看起来链接这个
[http://neatlink.net/t/blank/blahblah-blah-blah](http://neatlink.net/t/blank/blahblah-blah-blah)

所有请求都是获取请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:19:31.537

如何使用将 iframe 附加到网页的脚本标记。然后到 iframe 里面的页面使用 $_SERVER['HTTP_REFERER'];

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:28:39.843

只需将点击事件绑定到广告，一旦点击，就向记录点击的脚本发出 ajax 请求。

请参阅[jquery.ajax()](http://api.jquery.com/jQuery.ajax/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:30:32.457

您可以使用 Ajax 对象。您可以检查是否为 readyState = 4 调用回调，然后确保进行了特定调用。

# android - 消费者关闭输入通道或发生错误。事件=0x8

> ID：11668042
> 
> 赞同：4
> 
> 时间：2012-07-26T11:13:30.827
> 
> 标签：android

我正在开发 android youtube 应用程序。我们可以完美地获取数据和所有其他东西。通过使用 openyoutubeplayer 播放 youtube 视频。我们正在传递 videoid 来播放 openyoutubeplayer 中的视频。在播放视频时，我们在一段时间后遇到“**消费者关闭输入通道或发生错误。事件 = 0x8”[其随机]**。请查看以下日志。

```
I/NuCachedSource2( 1146): Keep alive
I/NuCachedSource2( 1146): Keep alive
I/NuCachedSource2( 1146): Keep alive
I/NuCachedSource2( 1146): Keep alive
I/NuCachedSource2( 1146): Keep alive
E/InputDispatcher( 1153): channel '4080cb58 com.android.launcher/com.android.launcher2.Launcher (server)' ~ Consumer closed input channel or an error occurred.  events=0x8
E/InputDispatcher( 1153): channel '4080cb58 com.android.launcher/com.android.launcher2.Launcher (server)' ~ Channel is unrecoverably broken and will be disposed!
W/IMediaDeathNotifier( 2431): media server died
W/MediaMetadataRetriever( 1243): MediaMetadataRetriever server died!
E/MediaPlayer( 2431): error (100, 0)
I/ServiceManager( 1077): service 'media.audio_flinger' died
I/ServiceManager( 1077): service 'media.player' died
I/ServiceManager( 1077): service 'media.camera' died
I/ServiceManager( 1077): service 'media.audio_policy' died
W/AudioSystem( 2431): AudioFlinger server died!
W/AudioSystem( 1153): AudioFlinger server died!
I/WindowManager( 1153): WINDOW DIED Window{4080cb58 com.android.launcher/com.android.launcher2.Launcher paused=false}
W/AudioSystem( 1153): AudioPolicyService server died!
I/ActivityManager( 1153): Process com.android.launcher (pid 1592) has died.
E/MediaPlayer( 2431): Error (100,0)
D/VideoView( 2431): Error: 100,0
W/WindowManager( 1153): Failed looking up window
W/WindowManager( 1153): java.lang.IllegalArgumentException: Requested window android.os.BinderProxy@4080c968 does not exist
W/WindowManager( 1153):         at com.android.server.WindowManagerService.windowForClientLocked(WindowManagerService.java:8181)
W/WindowManager( 1153):         at com.android.server.WindowManagerService.windowForClientLocked(WindowManagerService.java:8172)
W/WindowManager( 1153):         at com.android.server.WindowManagerService$WindowState$DeathRecipient.binderDied(WindowManagerService.java:7031)
W/WindowManager( 1153):         at android.os.BinderProxy.sendDeathNotice(Binder.java:381)
W/WindowManager( 1153):         at dalvik.system.NativeStart.run(Native Method)
I/WindowManager( 1153): WIN DEATH: null
I/        ( 2857): ServiceManager: 0xad50
I/CameraService( 2857): CameraService started (pid=2857)
D/AudioHardwareALSA( 2857): openOutputStream called for devices: 0x00000002
I/ALSAModule( 2857): Initialized ALSA PLAYBACK device AndroidPlayback_Speaker_normal
I/AudioFlinger( 2857): AudioFlinger's thread 0x16c00 ready to run
D/ALSAModule( 2857): route called for devices 00000002 in mode 0...
E/AudioService( 1153): Media server died.
E/AudioService( 1153): Media server started.
W/AudioPolicyManagerBase( 2857): setPhoneState() setting same state 0 
```

播放视频时，日志会显示“**保持活动状态**”消息。当视频停止时，它会显示上述日志。

我不知道到底发生了什么以及如何解决这个问题。如果你有任何想法，请告诉我。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-15T06:49:15.197

Keep Alive 是 Youtube 的服务器和您的客户端之间的“ping”消息......如果客户端或服务器没有收到保持活动，您失去了连接，被客户端或服务器中断......

“E/InputDispatcher（1153）：通道'4080cb58 com.android.launcher/com.android.launcher2.Launcher（服务器）'〜消费者关闭输入通道或发生错误。事件= 0x8”在这里你失去了与服务器，但没有代码我真的不知道更多^^

“W/WindowManager(1153): java.lang.IllegalArgumentException: 请求的窗口 android.os.BinderProxy@4080c968 不存在” 你在这里调用一个不存在的窗口？我认为你的应用程序在这里崩溃了......寻找它;）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-15T00:21:41.823

请`android:configChanges="orientation"` 用于`AndroidManifest.xml`启动屏幕的活动。

我遇到了同样的异常，但这与相机有关，但通常是由于方向变化引起的，方向变化没有通知活动，因此导致崩溃。

# uibutton - 自定义导航按钮但文字不清晰为系统

> ID：11668054
> 
> 赞同：0
> 
> 时间：2012-07-26T11:14:26.933
> 
> 标签：uibutton, uilabel, uibarbuttonitem

我使用自定义视图在导航栏上设置 UIButton。

但按钮上的文字如下：

![在此处输入图像描述](../Images/dc5a2564c7f1502efbd2e30d0771f290.png)

不像默认的按钮文字那样清晰。

![在此处输入图像描述](../Images/61301f48a269ad34faba866b14be3bd4.png)

我试图在按钮上添加另一个标签，但似乎失败了。

我也绑定了这样的代码，但似乎也不起作用。

```
doneButton.titleLabel.layer.shadowColor = [UIColor blackColor].CGColor;
doneButton.titleLabel.layer.shadowOffset = CGSizeMake(0, -1.0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-02T07:02:03.607

这些代码运行良好。

```
button.titleLabel.font = [UIFont boldSystemFontOfSize:[UIFont smallSystemFontSize]];
button.titleLabel.textColor = [UIColor whiteColor];
button.titleLabel.shadowOffset = CGSizeMake(0,-1);
button.titleLabel.shadowColor = [UIColor darkGrayColor]; 
```

我从[https://github.com/boctor/idev-recipes](https://github.com/boctor/idev-recipes)得到它，它非常适合自定义 UI 实现。

# java - 如何在 Maven 2 中使用自定义注释处理器？

> ID：11668055
> 
> 赞同：7
> 
> 时间：2012-07-26T11:14:30.943
> 
> 标签：java, maven-2, annotations, maven-plugin, annotation-processing

在我们的企业应用程序中，我们正在寻找一种从 Java 类中收集数据的动态方式。我们创建了一个`@interface`带有`name`属性的自定义注释接口 ()。我们想从所有带注释的类中收集该属性的值。

我设法为自定义注释创建了一个`AnnotationProcessorFactory`和一个`AnnotationProcessor`。由于我们使用的是 Maven 2，因此我在`pom.xml`主项目的插件中添加了以下内容。

```
 <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>apt-maven-plugin</artifactId>
      <version>1.0-alpha-5</version>
      <configuration>
        <factory>our.company.api.component.lister.ComponentAnnotationProcessFactory</factory>
      </configuration>
    </plugin> 
```

这位于具有多个子项目的主项目中。工厂和定制处理器位于这些子项目之一中。自定义注释分散在所有子项目中，这就是我将插件放在`pom.xml`主项目中的原因。

问题是当我发出`mvn apt:process`命令时，我收到关于没有处理器的注释的警告，我们的自定义注释就在其中。我认为这意味着插件找不到工厂类。

我应该怎么做才能让插件找到工厂和处理器文件？

**编辑：**

项目层次结构非常简单：

```
main_project
|-sub_project1
|...
|-sub_projectn 
```

该插件`pom.xml`位于`main_project`. 假设工厂和处理器在`sub_project1`，自定义注解在`sub_project2`, `sub_project3`, ...,`sub_projectn`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T12:46:53.490

要检查的两件事：

1.  确保`main_project`（或插件）[依赖于](http://mojo.codehaus.org/apt-maven-plugin/examples/configuring-a-factory.html)包含您的`ComponentAnnotationProcessFactory`.
2.  Apt Maven 插件的`<factory>`配置标签对我不起作用，但如果它的完全限定名称在`META-INF/services/com.sun.mirror.apt.AnnotationProcessorFactory`文件中，插件会找到工厂类。（有关[详细信息，请参阅 apt 的文档](http://docs.oracle.com/javase/1.5.0/docs/guide/apt/GettingStarted.html)。）

更好的方法是使用[JDK 6 的注释处理功能](http://docs.oracle.com/javase/6/docs/api/javax/annotation/processing/package-summary.html)（而不是 Maven Apt 插件），因为它不需要 JDK 的`com.sun`包和`tools.jar`文件`lib`夹。

```
<build>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.5.1</version>

            <configuration>
                <source>1.6</source>
                <target>1.6</target>

                <annotationProcessors>
                    <annotationProcessor>
                        com.example.annotationprocessor.Processor
                    </annotationProcessor>
                </annotationProcessors>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

更多参考资料：

*   Java 专家时事通讯中的[注释处理工具](http://www.javaspecialists.eu/archive/Issue167.html)
*   [什么是默认注释处理器发现过程？](https://stackoverflow.com/q/11685498/843804)

# windows-7 - TortoiseSVN 在 Windows 7 SP1 自动更新后停止工作

> ID：11668056
> 
> 赞同：1
> 
> 时间：2012-07-26T11:14:31.553
> 
> 标签：windows-7, tortoisesvn, connect

我在电脑上安装了 TortoiseSVN 1.7.1 版，它运行良好。在 SP1 Window 7 自动更新后，它停止工作并开始在任何有或没有 SSL 的服务器上返回错误“无法连接到服务器”。使用 RapidSVN，它可以在 TortoiseSVN 不工作的相同服务器上正常工作。我试过重新安装，清理Windows注册表，清理\ AppData \ Roaming \ TortoiseSVN和\ AppData \ Roaming \ Subversion，但没有任何效果。有没有人有任何解决方案？

# java - restSQL 战争部署问题

> ID：11668058
> 
> 赞同：0
> 
> 时间：2012-07-26T11:14:35.093
> 
> 标签：java, sql, rest, tomcat

我正在尝试基于此[链接在我的本地 tomcat 安装中部署 restSQL。](http://restsql.org/doc/Deployment.html)

从我的 tomcat webapps 文件夹中：

> webapps\restsql-0.8\WEB-INF\classes\resources\properties

我已修改`'default-restsql.properties'`以设置正确的数据库连接

`'sqlresources.dir=/resources/xml/sqlresources'`并在该位置添加/创建文件夹时保留该属性。

我也在 web.xml 中进行了修改：

```
<context-param>
    <param-name>org.restsql.properties</param-name>
    <param-value>/WEB-INF/resources/properties/default-restsql.properties</param-value>
</context-param> 
```

我很确定`default.restsql.properties`自从我访问此资源时就已加载：

```
http://localhost:8080/restsql-0.8/conf 
```

我得到这个回应：

```
Properties loaded from /resources/properties/default-restsql.properties:
log4j.configuration = resources/properties/default-log4j.properties
org.restsql.security.Authorizer = org.restsql.security.impl.AuthorizerImpl
org.restsql.core.RequestLogger = org.restsql.core.impl.RequestLoggerImpl
**sqlresources.dir = /resources/xml/sqlresources**
database.driverClassName = com.mysql.jdbc.Driver
logging.config = resources/properties/default-log4j.properties
database.user = root
org.restsql.core.Factory.ResponseSerializerFactory = org.restsql.core.impl.ResponseSerializerFactoryImpl
org.restsql.core.SqlBuilder = org.restsql.core.impl.SqlBuilderImpl
database.password = root
org.restsql.core.Factory.ConnectionFactory = org.restsql.core.impl.ConnectionFactoryImpl
org.restsql.core.SqlResourceMetaData = org.restsql.core.impl.SqlResourceMetaDataMySql
org.restsql.core.HttpRequestAttributes = org.restsql.core.impl.HttpRequestAttributesImpl
logging.facility = log4j
response.useXmlSchema = false
org.restsql.core.Factory.RequestFactory = org.restsql.core.impl.RequestFactoryImpl
database.url = jdbc:mysql://localhost:3306/
logging.dir = /var/log/restsql
org.restsql.core.Factory.SqlResourceFactory = org.restsql.core.impl.SqlResourceFactoryImpl
request.useXmlSchema = false
response.useXmlDirective = false
org.restsql.core.Factory.RequestDeserializerFactory = org.restsql.core.impl.RequestDeserializerFactoryImpl

Properties using defaults:
org.restsql.core.Factory.Connection = org.restsql.core.impl.ConnectionFactoryImpl
java.util.logging.config.file = resources/properties/default-logging.properties
request.useXmlDirective = false
org.restsql.properties = /resources/properties/default-restsql.properties 
```

但是，当我访问此资源时

```
http://localhost:8080/restsql-0.8/res/ 
```

我得到这个回应：

> SQL 资源目录 /resources/xml/sqlresources 不存在...请更正您的 restsql.properties 文件中的 sqlresources.dir 属性

尽管该文件夹确实存在：`webapps\restsql-0.8\WEB-INF\classes\resources\xml\sqlresources`

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T20:50:14.553

抱歉，您在部署时遇到问题。restSQL 需要主属性文件的绝对路径。除了在类路径中查找默认值外，它无法搜索其 WAR 文件或展开的 Web 应用程序目录。

大多数路径指向其他文件，在主要的 restSQL 属性文件中引用必须是绝对的。唯一相对的是 logging.config。请查看 [Deployment](http://restsql.org/doc/Deployment.html)以了解所有详细的部署说明。

希望这对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T12:23:20.567

当鸣则已一鸣惊人？

听起来您在运行其中一个数据库创建脚本时遇到了麻烦？是在restsql-sdk/WebContent/database/postgresql 中吗？您是否在运行 create-sakila.bat 时出错？也许您的 psql 可执行文件不在您的路径中。您可以编辑该文件以将其临时添加到您的 PATH 环境变量中。

如果资源查询没有返回数据，您将不会收到任何 5xx 错误。你会得到一个 200 和一个空的 readResponse 文档。

您的问题可能是资源定义元数据问题。country_id 来自国家表吗？国家/地区是否定义为元数据中的表？您可以发布资源定义吗？

您是否查看过[http://restsql.org/doc/SqlResourceRules.html](http://restsql.org/doc/SqlResourceRules.html)上的 SQL 资源规则？抱歉，不允许使用 SQL 函数和视图。您必须使用普通的旧列和表。

# function - 高阶函数和简写形式

> ID：11668060
> 
> 赞同：0
> 
> 时间：2012-07-26T11:14:36.487
> 
> 标签：function, macros, clojure

为什么我们可以写

```
 (defn factory-foo [] (fn [] (println "foo")))
 (apply (factory-foo) []) 
```

但不是：

```
 (defn factory-bar [] #((println "bar")))
 (apply (factory-bar ) []) ;throws NPE 
```

这是一个错误吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T11:31:04.493

`#((println "bar))`由读者翻译为`(fn [] ((println "bar")))`- 注意额外的括号。`(println "bar")`这里 prints`bar`并返回`nil`，然后`nil`由于外括号而将其本身作为函数调用。`nil`实际上`null`是，并且试图取消对 NPE 的引用。

`#(..)`为了避免这种情况，只需在:中放置额外的括号`#(println "bar")`。

# vb.net - vb if 语句：你能有多少个和

> ID：11668061
> 
> 赞同：0
> 
> 时间：2012-07-26T11:14:38.810
> 
> 标签：vb.net, if-statement

我有这样的 if 语句：

```
If r1.Left < r2.Right AndAlso r2.Right < r1.Right AndAlso r2.Top + r2.Height > r1.Top Then 
```

我想知道有这么多`AndAlso`的是不是很糟糕。它确实有效，只是弄不清楚发生了什么令人困惑。有没有一种更简单的方法来做这个测试？还是这是正确的做事方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:30:37.170

据我所知，MSDN 文档没有说明可以在`If`语句中使用的最大条件数——因此任何限制都可能受可用堆栈空间的约束，而且你几乎不可能接近那个。

至于实践：编码术语还不错，但正如您所说，它可能变得难以阅读。我个人倾向于只使用续行来使此类语句更具可读性：

```
If r1.Left < r2.Right _
    AndAlso r2.Right < r1.Right _
    AndAlso r2.Top + r2.Height > r1.Top Then 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:19:28.380

你总是可以引入一个新的变量或方法来提高可读性。

所以而不是

```
If r1.Left < r2.Right AndAlso r2.Right < r1.Right AndAlso r2.Top + r2.Height > r1.Top Then 
```

就像是

```
Function RectIsInsideOf(r1 As ..., r2 As ...) As Bool
    Return r1.Left < r2.Right AndAlso 
           r2.Right < r1.Right AndAlso 
           r2.Top + r2.Height > r1.Top 
End Function

...

If RectIsInsideOf(r1, r2) Then ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:58:41.363

好吧，您对可以在 if 语句中使用多少个运算符没有任何限制。此外，使用任意数量的代码（从程序员的角度来看）是完全可以的，毕竟这就是 if 语句的意义所在。但是，如果您面临需要检查太多运算符的情况，那么您必须考虑另一种方法。

在您的具体示例中，您使用的代码仅包含两个 AndAlso 运算符，这对您的程序来说开销不大。如果您只想在程序中的一个位置检查这种情况，那么您的方法可以被认为是正确的，如果您需要在许多位置进行这种检查，那么为此编写一个 BigYellowCactus 函数是明智的建议。

希望这可以帮助...

# winapi - 当 MediaFoundation API ProcessMessage() 返回给调用者时，收到错误“每个用户订阅的所有者 SID 不存在”。

> ID：11668064
> 
> 赞同：0
> 
> 时间：2012-07-26T11:14:47.330
> 
> 标签：winapi, visual-c++, media, directshow, ms-media-foundation

我正在使用 VC++，VS2008。我收到错误消息“每用户订阅的所有者 SID 不存在”。

> ProcessMessage() (IMFTransform) 返回成功状态，如果我看到调用堆栈，ProcessMessage() 会进入一些 Microsoft DLL（如 evr.dll 等），最后返回错误消息“所有者 SID 在每用户订阅不存在”。

谁能告诉我为什么我们会收到这个错误？如果可能的话如何解决它。任何指针也表示赞赏。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:57:13.273

“每用户订阅的所有者 SID 不存在”是`0x80040207`，这是一个具有特定上下文含义的 HRESULT 代码，在这种情况下`VFW_E_NO_ACCEPTABLE_TYPES`是“这些引脚之间没有共同的媒体类型”。

有关[`FACILITY_ITF`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679751%28v=vs.85%29.aspx)更多详细信息，请参阅。

# mercurial - 使用 Mercurial 为现有项目创建新的远程存储库

> ID：11668065
> 
> 赞同：8
> 
> 时间：2012-07-26T11:14:56.033
> 
> 标签：mercurial, ssh, hgrc

我有一个带有 version.2 的项目，我必须开始着手开发新的 version.3 。我想在远程服务器（即 mercurial-server）上创建一个新的存储库，以便我的团队成员可以访问该存储库。我的本地计算机上有我的项目文件。

我有两个关心的问题：

1.  如何`/home/hg/repositories/private/project3`使用我的项目文件在远程 mercurial-server 的（假设新的 repo 名称为 project3）中创建它。我应该遵循哪些步骤来做到这一点。

2.  如何创建访问权限 (usrname/pword)，以便我的团队可以访问[http://dev.myproject.com/private/project3](http://dev.myproject.com/private/project3)上的这个 repo 。

**注意：** `/home/hg/repositories/`是[http://dev.myproject.com/](http://dev.myproject.com/)的默认设置，我没有版本 2 的 repo（我猜不可能克隆！）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T12:58:00.033

如果不安装额外的服务器端软件，您的团队将需要该框上的 ssh 帐户。我假设您有一个，并且您可以为您的朋友创建它们。如果您没有该设置，最好只使用 bitbucket，它是免费的，并提供 ssh 和 ftp 访问。

此外，您不会说您的 project2 是否已经在 Mercurial 控制下，所以我假设它不是。

要创建远程仓库，您可以**在本地计算机上**执行以下操作：

```
hg init project3   # <-- creates a new empty respository
cp ALL_THE_PROJECT3_FILES_YOU_WANT project3  # <--- put the files you want into project3
cd project3   # <-- go into your local project3 repository
hg addremove   # <-- LOCALLY add the files you copied in
hg commit -m "initial commit copied in project2"  # <-- LOCALLY commit the files
cd ..   # <---- go up a directory
hg clone project3 ssh://yourusername@dev.myproject.com//home/hg/repos/project3  # clone the repo over to the server 
```

然后，您的队友可以使用以下方法进行克隆：

```
hg clone ssh://theirusername@dev.myproject.com//home/hg/repos/project3 
```

以下是一些您可能会在使其正常工作的过程中不小心搞砸的事情：

*   您的朋友需要 ssh 帐户
*   您的朋友帐户需要读/写权限`/home/hg/repos`

请注意，所有克隆都是通过 ssh 进行的。设置 HTTP 比较困难，可能不需要您做任何事情。

说真的，只需使用 bitbucket。

# sql - 使用 SQL Server 的日期时间格式

> ID：11668069
> 
> 赞同：0
> 
> 时间：2012-07-26T11:15:03.357
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一个日期作为形式的 varchar

```
DD/MM/YYYY HH:MM:SS AM 
```

例如

```
16/3/2012 4:39:26 PM 
```

`CONVERT()`我在[MSDN 页面](http://msdn.microsoft.com/en-us/library/ms187928.aspx "MSDN page")中看不到有效的格式选项

我是否遗漏了什么或者我必须先重新格式化 varchar 字段？

编辑：

更正了格式，抱歉

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T11:18:40.153

一旦你的故事直截了当，你会想要其中之一：

```
-- if you really meant dd/mm/yyyy then:

SELECT CONVERT(DATETIME, '16/3/2012 4:39:26 PM', 103);

-- if you really meant mm/dd/yyyy then:

SELECT CONVERT(DATETIME, '3/16/2012 4:39:26 PM', 101); 
```

但同意马迪瓦南的意见。不要使用错误的数据类型存储日期，如果必须，请使用明确的格式！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T11:18:50.950

1.  始终使用正确的`DATETIME`数据类型来存储日期
2.  `YYYYMMDD`并且`YYYYMMDD HH:MM:SS`是明确的日期格式

有关更多信息，请参阅此

[http://beyondrelational.com/modules/2/blogs/70/posts/10898/understanding-datetime-column-part-ii.aspx](http://beyondrelational.com/modules/2/blogs/70/posts/10898/understanding-datetime-column-part-ii.aspx)

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-07-26T11:19:31.440

这将起作用。

```
DECLARE @dt varchar(100)='2012/3/16 4:39:26 PM'
select convert(datetime,@dt,101) 
```

# android - 将按钮添加到 ListActivity

> ID：11668073
> 
> 赞同：0
> 
> 时间：2012-07-26T11:15:37.817
> 
> 标签：android, xml

我正在开发和创建一个包含 ImageView 和 TextView 的 ListActivity 的 android 应用程序。还可以拖放这些对象以便移动它们。我现在想做的是在屏幕底部有一个按钮，而不是列表。

当用户滚动时，按钮将始终停留在那里。我找到了这个[链接](https://stackoverflow.com/questions/4740197/add-buttons-to-a-listactivity)，但是当我执行这个链接所提示的操作时，没有出现任何按钮，而是出现了一个巨大的空白区域，占据了屏幕的四分之一。谁能指出我正确的方向？

好的，这里是设置为 ListActivity 的 .xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content">
<DragNDrop.DragNDropListView
    android:id="@+id/android:list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
  </DragNDrop.DragNDropListView>
</LinearLayout> 
```

希望它可以帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:20:48.550

你的视图应该是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >
<Button 
     android:id="@+id/btn"
     android:layout_width="wrap_content"
     android:layout_height="wrap_content"
     android:layout_alignParentBottom="true"
     android:text="Button"
     android:layout_centerHorizontal="true"/>
 <ListView 
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"
     android:layout_above="@+id/btn"/>
</RelativeLayout> 
```

使用数据填充列表视图，并查看按钮将在其位置，尽管列表正在滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:23:10.933

**我认为 ListActivity 是一种不好的做法。** 您需要做的是**将Activity**从ListActivity更改为Activity。在布局文件中，执行以下操作：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_contant"
    android:orientation="horizontal">
 <DragNDrop.DragNDropListView
   android:id="@+id/android:list"
   android:layout_width="fill_parent"
   android:layout_height="wrap_contant">
 </DragNDrop.DragNDropListView>
 <Button 
    android:id="@+id/btn"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Button"/>
</LinearLayout> 
```

在创建时，您可以通过执行以下操作获取列表参考：

```
ListView lv = (ListView)findViewById(R.id.list); 
```

为了使按钮可点击，用户 OnClickListener

# twitter-bootstrap - 以模态形式聚焦第一个字段

> ID：11668078
> 
> 赞同：6
> 
> 时间：2012-07-26T11:16:01.170
> 
> 标签：twitter-bootstrap, modal-dialog, marionette

我正在使用来自 Twitter 的 Bootstrap 在 Marionette 应用程序中生成模态对话框。

我想知道在不使用花哨的 javascript 的情况下将第一个字段集中在模态表单中的最佳方法是什么。

这是我的代码：

```
var app = new Marionette.Application();

app.addRegions({
    modal: '#modal'
});

app.vent.on('showModal', function (view) {
    var modal = app.modal;

    modal.show(view);
    modal.$el.modal({
        show: true,
        keyboard: true,
        backdrop: 'static'
    });
}); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T11:49:13.463

您可以使用[文档中](http://twitter.github.com/bootstrap/javascript.html#modals)*显示*的事件

```
modal.$el.on('shown', function () {
  $('input:text:visible:first', this).focus();
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-04T13:30:24.040

如果`odupont`你的回答对你没有帮助，（像我一样）试试这个：

```
$('.modal').on('shown.bs.modal', function () {
    $('#firstField').focus();
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-25T16:43:48.723

这是一个更新的答案：

```
$('.modal').on('shown.bs.modal', function () {
    $('input:first', this).focus();
}); 
```

# android - android中的数据检索表单数据库

> ID：11668079
> 
> 赞同：0
> 
> 时间：2012-07-26T11:16:01.427
> 
> 标签：android, database

在我的应用程序中，我在列表视图中显示来自数据库的数据。在列表视图 1 中，特定的文本视图应该是动态的（即）基于特定文本视图应该更改的一列值，

以下是我的完整数据库结构：

```
http://www.freeimagehosting.net/bmcrp
http://www.freeimagehosting.net/8f13z 
```

.如果recurence为“真”意味着textview 9应该显示recctotal否则总计。

我的代码如下：

```
Cursor c = db.getExpensetitle(intent.getStringExtra("grpsdbexp"));
            startManagingCursor(c);     

                    -------------------->Here i have to use the condition.
                  from = new String[] {db.KEY_DATE,db.KEY_DESC,db.KEY_INCOME,db.KEY_QUANTITY,db.KEY_TOTAL,db.KEY_ROWID};
                  to = new int[] {R.id.text1 ,R.id.text3,R.id.text5,R.id.text7,R.id.text9,R.id.text11};

            SimpleCursorAdapter notes =
                            new SimpleCursorAdapter(this, R.layout.columnviewexp, c, from, to);             
            lv.setAdapter(notes); 
```

请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:29:43.100

由于有条件，您应该自定义光标适配器而不是 SimpleCursorAdapter。

[https://codereview.stackexchange.com/questions/1057/android-custom-cursoradapter-design](https://codereview.stackexchange.com/questions/1057/android-custom-cursoradapter-design)

```
SimpleCursorAdapter notes =
                            new SimpleCursorAdapter(this, R.layout.columnviewexp, c, from, to)
{
      @Override
    public void bindView(View view, Context context, Cursor cursor) {

        boolean reurrence= cursor.getBoolean(cursor.getColumnIndex("recurrence"));

        TextView text9=(TextView)view.findViewById(R.id.text9);

        String text=null;
        if(recurrence)
            text=cursor.getString(cursor.getColumnIndex(KEY_TOTAL));
        else
            text=cursor.getString(cursor.getColumnIndex(KEY_REC_TOTAL));

         text9.setText(text);

        // Load remaining TextViews

    }
}; 
```

# php - 如何使用 ajax 上传图片并预览

> ID：11668082
> 
> 赞同：2
> 
> 时间：2012-07-26T11:16:07.453
> 
> 标签：php, jquery, html, ajax

我正在尝试使用 ajax 将图像上传到图像文件夹，但是当我选择图像时它不起作用，然后图像应该上传到本地硬盘驱动器中的我的文件夹，然后我将使用它。

请帮我

我的代码是：

**脚本**

```
$(document).ready(function() { 
$('#pathAbout,#path,#pathWork').change(function(){
if($(this).val() !=""){
    $.ajax({
       type: "POST",
       url: "imageLoad.php", 
       data: "name = <?php echo $_FILES['imgPath']['name']; ?>&type=<?php echo $_FILES['imgPath']['type']; ?>&tmp_name=<?php echo $_FILES['imgPath']['tmp_name']; ?>",
       success: function(msg){
        alert(msg);
       }
     });
}
});
}); 
</script> 
```

**HTML**

```
<form method="POST" action="tabs.php?page=HOME" enctype="multipart/form-data">
<table>
<tr>
<td><label>Choose Image</label></td>
<td><input type="file" id ="pathAbout" name="imgPath" /></td>
</tr>

</table>
</form> 
```

**PHP**

```
if(!empty($_POST)) {
if((isset($_POST['name']) && $_POST['name'] != '') || (isset($_POST['type']) && $_POST['type'] != '') ||(isset($_POST['tmp_name']) && $_POST['tmp_name'] != ''))
{
$name = $_POST['name'];
$type = $_POST['type'];
$tmp_name = $_POST['tmp_name'];
$extension = strtolower(substr($name, strpos($name , '.') +1));
if(($extension == 'png' || $extension == 'jpeg' || $extension == "jpg")&&($type == "image/png" || $type == "image/jpeg" || $type == "image/jpg"))
{
    $location = 'images/';
    if(move_uploaded_file($tmp_name,$location."$name"))
        {
            echo "Loaded";
        } else {
            echo "Error occured";
        }
} else {
    echo "Unsupported file format";
}
} else {
    echo "Please choose a file";
}
} else {
echo "No Information found";
} 
```

这是我的代码，但是当我选择一个文件时什么都没有发生

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:28:40.543

如果您愿意，可以在此处使用[Uploadify](http://www.uploadify.com/demos/)，您还可以查看演示和示例代码，例如 -

```
$(function() {
$("#file_upload").uploadify({
    'formData'      : {'someKey' : 'someValue', 'someOtherKey' : 1},
    'swf'           : '/uploadify/uploadify.swf',
    'uploader'      : '/uploadify/uploadify.php',
    'onUploadStart' : function(file) {
        $("#file_upload").uploadify("settings", "someOtherKey", 2);
    }
});
});

$("#image_upload2").uploadify(uploadifyBasicSettingsObj);

uploadifyBasicSettingsObj.onUploadSuccess = function(file, data, response) 
{
    $('.tempImageContainer2').find('.uploadify-overlay').show();

    /* Here you actually show your uploaded image.In my case im showing in Div  */
    $('.tempImageContainer2').attr('style','background- image:url("../resources/temp/thumbnail/'+data+'")');
    $('#hidden_img_value2').attr('value',data);
} 
```

HTML 代码：

```
<div class="boxWrapper tempImageContainer2" data-image-container-id="2">
   <input type="file"  accept="gif|jpg" name="image2" style="" id="image_upload2"/>
   <input type="hidden" value="" name="image[]" id="hidden_img_value2">
   <input type="hidden" name="upload_path" value="" id="upload_path2" class="upload_path">
   <div class="uploadify-overlay">Change</div>
   <a class="remove-pic-link" href="javascript:void(0)" style="display:none">Remove</a>
 </div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:42:31.940

**HTML**

```
<div class="field">
    <label class="w15 left" for="txtURL">Logo:</label>
    <img id="logoPreview" width="150px" height="150px" src='default.jpg' />
    <input class="w60" type="file" name="txtURL" id="txtURL" />
</div> 
```

**jQuery**

```
$('#txtURL').on('change', function(){

    $.ajaxFileUpload({
           type         :   "POST",
           url          :   "ajax/uploadImage",
           dataType     :   "json",
           fileElementId:   'txtURL',
           data         :   {'title':'Image Uploading'},
           success      :   function(data){

                $('#logoPreview').attr('src', data['path']);
               },
           error        :   function(data, status, e){
                alert(e);
               }                
           });

}); 
```

**阿贾克斯控制器：**

```
public function uploadImage()
    {
        $status = "";
        $msg = "";
        $filename='';
        $file_element_name = 'txtURL';//Name of input field

        if (empty($_POST['title'])){
            $status = "error";
            $msg = "Please enter a title";
        }

        if ($status != "error"){

            $targetPath = ''.date('Y').'/'.date('m').'/';

            if(!file_exists(str_replace('//','/',$targetPath))){
                mkdir(str_replace('//','/',$targetPath), 0777, true);
            }

            $config['upload_path'] = $targetPath;
            $config['allowed_types'] = 'jpg|png|jpeg';
            $config['max_size'] = 150000;
            $config['file_name']=time(); //File name you want
            $config['encrypt_name'] = FALSE;

            $this->load->library('upload', $config);
            $this->upload->initialize($config);

            if(!$this->upload->do_upload($file_element_name)){
                $status = 'error';
                $msg = $this->upload->display_errors('', '');
            }
            else{
                $data = $this->upload->data();
                $filename = $targetPath.$data['file_name'];
            }
            //@unlink($_FILES[$file_element_name]);
        }

        echo json_encode(array('status' => $status, 'msg' => $msg,'path'=>$filename));
    } 
```

添加[Ajaxfileupload.js](https://gist.github.com/3181621)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:21:56.233

无法直接使用 AJAX 上传图像，但有一些库可以创建动态 iframe 来完成此操作。

看看我在几个项目中使用过的这个：[valums.com/ajax-upload](http://valums.com/ajax-upload/)。它甚至还附带了几个 PHP 应用程序框架的示例服务器端代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T11:23:50.327

您不能使用 上传文件`AJAX`，您需要使用由 a`'iframe'`和 the组成的技巧`web form`，还有一些`javascript`.
[此链接](http://viralpatel.net/blogs/ajax-style-file-uploading-using-hidden-iframe/)可能会对您有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T11:18:04.947

您不能直接使用 AJAX 上传图片

答案是对此的回应：

```
data: "name = <?php echo $_FILES['imgPath']['name']; ?>&type=<?php echo $_FILES['imgPath']['type']; ?>&tmp_name=<?php echo $_FILES['imgPath']['tmp_name']; ?>", 
```

# google-apps-script - 我需要在周一至周五 10:30 运行 google docs 脚本：请问有什么建议吗？

> ID：11668083
> 
> 赞同：0
> 
> 时间：2012-07-26T11:16:21.527
> 
> 标签：google-apps-script, triggers

我有一个在 Google Docs 电子表格上运行并且运行良好的脚本。我需要自动运行这个脚本并使用了一个触发器，它也可以正常工作。在触发器的选项中，我可以在 10 点到 11 点或 11 点到 12 点运行脚本，但不能在 10:30 运行。

我可以使用确切的时间选项，但这意味着每次都重置日期。我也可以在上午 10 点运行它并输入睡眠命令，但不确定脚本应该运行多长时间是否有时间限制：这将有效地运行 30 分钟。

请问还有其他想法吗？

谢谢阿德

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T02:48:00.103

通过脚本设置触发器似乎提供了比 UI 更多的选项，请参阅 ClockTriggerBuilder [https://developers.google.com/apps-script/class_clocktriggerbuilder](https://developers.google.com/apps-script/class_clocktriggerbuilder)

例如

```
ScriptApp.newTrigger("myTimeTrigger")
  .timeBased()
  .onWeekDay(ScriptApp.WeekDay.MONDAY)
  .atHour(12).nearMinute(15)
  .create(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T20:44:37.990

您可以每 30 分钟设置一次触发器并检查脚本本身“现在几点？” 不是 10:30 吗？然后返回...根据您需要获得的准确性，给它一个好的开始可能会很棘手...所以您可以在一分钟触发器上做同样的事情...（忘记睡眠选项，它应该超过总可接受的运行时间）另见这篇非常相似的帖子：[Working hours only trigger](https://stackoverflow.com/questions/10995308/working-hours-only-trigger)

# delphi - 将新属性添加到 TActionList 中的 Action

> ID：11668085
> 
> 赞同：2
> 
> 时间：2012-07-26T11:16:26.800
> 
> 标签：delphi, taction, tactionlist

如何在 Delphi 的 TActionList 的操作中添加新的已发布（显示在对象检查器中）属性

属性数据类型是布尔值。

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-26T11:21:12.883

通过派生来创建新的动作类`TAction`。例如：

```
TMyAction = class(TAction)
...
published
  property MyBoolProp: Boolean ....
end; 
```

然后您可以`Register`通过调用从设计时包的过程中注册它[`RegisterActions`](http://docwiki.embarcadero.com/Libraries/en/Vcl.ActnList.RegisterActions)。

```
procedure Register;
begin
  .... // register any other components
  RegisterActions('MyCategory', [TMyAction], nil);
end; 
```

然后从操作列表编辑器中选择`New Standard Action`，您的操作将出现在可用操作的树形视图中。

![在此处输入图像描述](../Images/e33855427cb19b5154643d7d0fec69ff.png)

![在此处输入图像描述](../Images/eb8283534ecdd8085edb9a405bfb7ab2.png)

* * *

在评论中，您似乎暗示您要修改`TAction`以拥有新属性。这将需要对 VCL 本身进行修改，这超出了您的控制范围。毫无疑问，VCL 可能会被黑客入侵以实现您的要求，但这不是一个好主意。

# c - 在 CPU 仿真中使用 switch case 时如何处理分支预测

> ID：11668090
> 
> 赞同：22
> 
> 时间：2012-07-26T11:16:41.073
> 
> 标签：c, performance, compiler-optimization, emulation, branch-prediction

我最近在这里阅读了这个问题[为什么处理排序数组比处理未排序数组更快？](https://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array)并发现答案绝对令人着迷，并且在处理基于数据的分支时完全改变了我对编程的看法。

我目前有一个相当基本但功能齐全的解释型 Intel 8080 仿真器，用 C 语言编写，操作的核心是一个 256 长的 switch-case 表，用于处理每个操作码。我最初的想法是，这显然是最快的工作方法，因为操作码编码在整个 8080 指令集中并不一致，并且解码会增加很多复杂性、不一致和一次性情况。一个充满预处理器宏的 switch-case 表非常整洁且易于维护。

不幸的是，在阅读了上述帖子后，我突然想到，我计算机中的分支预测器绝对无法预测开关盒的跳跃。因此，每次切换开关盒被导航时，管道都必须被完全擦除，从而导致原本应该是一个非常快速的程序的几个周期延迟（我的代码中甚至没有乘法）。

我相信你们中的大多数人都在想“哦，这里的解决方案很简单，转向动态重新编译”。是的，这似乎确实会削减大部分开关盒并大大提高速度。不幸的是，我的主要兴趣是模拟较旧的 8 位和 16 位时代的控制台（这里的英特尔 8080 只是一个示例，因为它是我最简单的一段模拟代码），其中与视频和声音一样，保持精确指令的周期和时间很重要必须根据这些确切的时间进行处理。

当处理这种级别的准确性时，性能成为一个问题，即使对于较旧的控制台也是如此（例如，查看 bSnes）。在处理具有长管道的处理器时，是否有任何追索权，或者这只是一个事实？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-26T11:31:52.053

相反，`switch`语句很可能会转换为[跳转表](http://en.wikipedia.org/wiki/Branch_table)，这意味着它们可能执行几个`if`s（用于范围检查）和一次跳转。s 不应导致分支预测出现问题，`if`因为您不太可能有错误的操作码。跳转对管道不是那么友好，但最后，它只是整个`switch`语句的一个..

我不相信您可以将`switch`操作码的长语句转换为任何其他可以带来更好性能的形式。当然，前提是您的编译器足够聪明，可以将其转换为跳转表。如果没有，您可以手动执行此操作。

如有疑问，请实施其他方法并衡量绩效。

### 编辑

首先，确保不要混淆[分支预测](http://en.wikipedia.org/wiki/Branch_predictor)和[分支*目标*预测](http://en.wikipedia.org/wiki/Branch_target_predictor)。

分支预测仅适用于分支语句。它决定分支条件是失败还是成功。它们与跳转语句无关。

另一方面，分支目标预测试图猜测跳跃将在哪里结束。

因此，您的陈述“分支预测器无法预测跳跃”应该是“分支**目标**预测器无法预测跳跃”。

在您的特定情况下，我认为您实际上无法避免这种情况。如果您有一组非常小的操作，也许您可​​以想出一个涵盖所有操作的公式，例如逻辑电路中的操作。但是，对于像 CPU 一样大的指令集，即使它是 RISC，计算的成本也远高于单次跳转的代价。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-26T11:42:20.507

由于 256 路 switch 语句上的分支密集打包，编译器会将其实现为跳转表，因此您是正确的，因为每次通过此代码时都会触发单个分支错误预测（作为间接跳转不会显示任何可预测的行为）。与此相关的损失将是现代 CPU（Sandy Bridge）上大约 15 个时钟周期，或者在缺少微操作缓存的旧微架构上可能高达 25 个时钟周期。这类事情的一个很好的参考是 agner.org 上的“软件优化资源”。“用 C++ 优化软件”中的第 43 页是一个很好的起点。

[http://www.agner.org/optimize/?e=0,34](http://www.agner.org/optimize/?e=0,34)

避免这种惩罚的唯一方法是确保执行相同的指令，而不管操作码的值如何。这通常可以通过使用条件移动（添加数据依赖关系因此比可预测的分支慢）或以其他方式在代码路径中寻找对称性来完成。考虑到您要尝试执行的操作，这可能是不可能的，如果是这样，那么几乎肯定会增加比错误预测的 15-25 个时钟周期更大的开销。

总而言之，在现代架构上，没有什么比 switch/case 更有效的了，而且错误预测分支的成本也没有你想象的那么高。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-03T22:28:40.453

间接跳转可能是指令解码的最佳选择。

在较旧的机器上，比如 1997 年的 Intel P6，间接跳转可能会导致分支预测错误。

在现代机器上，比如 Intel Core i7，有一个间接跳转预测器可以很好地避免分支错误预测。

但即使在没有间接分支预测器的旧机器上，你也可以玩一玩。顺便说一句，这个技巧（曾经）记录在英特尔代码优化指南中，可以追溯到英特尔 P6 时代：

而不是生成看起来像的东西

```
 loop:
       load reg := next_instruction_bits // or byte or word
       load reg2 := instruction_table[reg]
       jmp [reg]
    label_instruction_00h_ADD: ...
       jmp loop
    label_instruction_01h_SUB: ...
       jmp loop
    ... 
```

生成代码为

```
 loop:
       load reg := next_instruction_bits // or byte or word
       load reg2 := instruction_table[reg]
       jmp [reg]
    label_instruction_00h_ADD: ...
       load reg := next_instruction_bits // or byte or word
       load reg2 := instruction_table[reg]
       jmp [reg]
    label_instruction_01h_SUB: ...
       load reg := next_instruction_bits // or byte or word
       load reg2 := instruction_table[reg]
       jmp [reg]
    ... 
```

即用每个地方循环顶部的代码替换到指令获取/解码/执行循环顶部的跳转。

事实证明，即使在没有间接预测器的情况下，这也有更好的分支预测。更准确地说，一个有条件的、单一目标的、PC 索引的 BTB 在后一种线程代码中将比在只有一个间接跳转副本的原始代码中好得多。

大多数指令集都有特殊的模式——例如在 Intel x86 上，一条比较指令几乎总是跟在一个分支之后。

祝好运并玩得开心点！

（如果您关心的话，工业中指令集模拟器使用的指令解码器几乎总是执行 N 向跳转树，或数据驱动的对偶，导航 N 向表树，树中的每个条目都指向到其他节点，或到要评估的函数。

哦，也许我应该提一下：这些表、这些 switch 语句或数据结构是由专用工具生成的。

一棵N路跳转树，因为当跳转表中的case数量变得非常大时会出现问题-在我在1980年代编写的工具mkIrecog（make指令识别器）中，我通常会跳转表达到64K条目的大小，即在 16 位上跳跃。当跳转表的大小超过 16M（24 位）时，当时的编译器就崩溃了。

数据驱动，即指向其他节点的节点树，因为 (a) 在较旧的机器上可能无法很好地预测间接跳转，并且 (b) 事实证明，指令之间的大部分时间都有公共代码 - 而不是具有跳转到每条指令的案例时的分支预测错误，然后执行公共代码，然后再次切换，并获得第二个错误预测，您执行公共代码，参数略有不同（例如，您消耗了多少指令流的位，以及下一组要分支的位是 (are)。

我在 mkIrecog 中非常激进，正如我所说，允许在开关中使用多达 32 位，尽管实际限制几乎总是阻止我在 16-24 位。我记得我经常看到第一个解码是 16 位或 18 位开关（64K-256K 条目），而所有其他解码都小得多，不超过 10 位。

嗯：我大约在 1990 年将 mkIrecog 发布到 Usenet。ftp://ftp.lf.net/pub/unix/programming/misc/mkIrecog.tar.gz[如果](ftp://ftp.lf.net/pub/unix/programming/misc/mkIrecog.tar.gz) 您关心的话，您可以查看使用的表。（善良：那时我还年轻。我不记得这是 Pascal 还是 C。我已经重写了很多次——尽管我还没有重写它以使用 C++ 位向量。）

我认识的其他大多数做这类事情的人一次只做一个字节——即 8 位、256 路、分支或表查找。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-25T17:02:32.947

我想我会添加一些东西，因为没有人提到它。

当然，间接跳转可能是最好的选择。

但是，如果您采用 N 比较方式，我会想到两件事：

首先，您可以进行 log(N) 不等式比较，而不是进行 N 相等比较，通过二分法根据它们的数字操作码测试您的指令（或者如果值空间接近满，则逐位测试数字）。这是一个有点像哈希表，你实现一个静态树来查找最终元素。

其次，您可以对要执行的二进制代码进行分析。您甚至可以在执行之前为每个二进制文件执行此操作，并在运行时修补您的模拟器。该分析将构建一个表示指令频率的直方图，然后您将组织您的测试，以便正确预测最频繁的指令。

但我看不出这比中等 15 个周期的惩罚更快，除非你有 99% 的 MOV 并且你在其他测试之前为 MOV 操作码设置了相等性。

# java - JUnit 测试之间的相同休眠会话导致问题

> ID：11668100
> 
> 赞同：1
> 
> 时间：2012-07-26T11:17:12.570
> 
> 标签：java, spring, hibernate, junit4, dbunit

我正在开发一个基于 Spring 2.5 和 hibernate 3 的 Web 应用程序。最近我引入了 JUnit 测试，并使用 DBUnit 框架完成了一些集成测试。DBUnit 应该在一个测试和另一个测试之间使用 xml 数据集更新数据库，并且它运行良好，正如我所见。

但是，当我在测试中更新一个元素时，hibernate 似乎捕捉到了这个信息，甚至我在下面的测试中加载了这个元素，这些信息是我修改过的。如果我在执行暂停时查看数据库，则 DBUnit 正确重置了数据库。所以我认为这可能是一个休眠问题..

有没有办法在测试之间进行拆解，说我想要一个新的休眠会话用于我的春季上下文？顺便说一句，我没有使用 Spring 注释，而是通过代码获取 Spring 上下文：

```
String[] contextLocations = new String[2];
contextLocations[0] = "WebContent/WEB-INF/applicationContext.xml";
contextLocations[1] = "src/System_V3/test/applicationContext.xml";
context = new FileSystemXmlApplicationContext(contextLocations); 
```

DBUnit 设置：

```
@Before
public void setUpBeforeClass() throws Exception {
    handleSetUpOperation();
}

private static void handleSetUpOperation() throws Exception {
    conn = getConnection();
    conn.getConnection().setAutoCommit(false);
    final IDataSet data = getDataSet();
    try {
        DatabaseOperation.REFRESH.execute(conn, data);
    } finally {
        conn.close();
    }
}

private static IDatabaseConnection getConnection() throws ClassNotFoundException, SQLException,
        DatabaseUnitException {
    Class.forName("org.gjt.mm.mysql.Driver");
    return new DatabaseConnection(DriverManager.getConnection(
            "jdbc:mysql://localhost:3306/web_database", "root", "pass"));
}

private static IDataSet getDataSet() throws IOException, DataSetException {
    ClassLoader classLoader = TestPrueba.class.getClassLoader();
    return new FlatXmlDataSetBuilder().build(classLoader
            .getResourceAsStream("System_V3/test/dataset.xml"));
} 
```

测试是在 JUnit 4 中仅使用 @Test 注释完成的，并且测试类不扩展任何库类。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T11:35:52.950

不确定这是否可以帮助您-但以防万一...

尝试使用 session.clear() 并在拆卸方法中使用它。请看这里[http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html#clear](http://docs.jboss.org/hibernate/orm/3.5/api/org/hibernate/Session.html#clear) ()

根据规范 session.clear() -> 完全清除会话。驱逐所有加载的实例并取消所有挂起的保存、更新和删除。不要关闭打开的迭代器或 ScrollableResults 的实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:31:43.460

您需要在事务中执行测试。这可以通过为您的测试设置[SpringJUnit4ClassRunner来实现。](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/test/context/junit4/SpringJUnit4ClassRunner.html)配置完成后，您可以在`@Transactional`每个测试中使用注释。

使用这种方法，您也可以`@Autowired`将您的 bean 直接用于您的测试。

例如：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "classpath:context-file.xml" })
public class MyTest {

    @Autowired
    private MyService myService;

    @Transactional
    @Test
    private void myFirstTest() {
        ...
        myService.executeSomething();
        ...
    }

} 
```

当然，您可以在测试类上将默认行为设置为 RollBack`@TransactionConfiguration(defaultRollback = true/false)`

# mysql - Rails 无法识别旧数据库上的布尔字段

> ID：11668102
> 
> 赞同：2
> 
> 时间：2012-07-26T11:17:17.203
> 
> 标签：mysql, ruby-on-rails, activerecord, database-migration

我编写了一个使用旧版 MySQL 数据库的 Rails 应用程序。一个表包含此字段

```
CREATE TABLE `articles` (
  `active` tinyint(3) unsigned NOT NULL DEFAULT '0',
); 
```

我已经修复了架构

```
t.boolean "active",    :default => false 
```

但是 rails 不会将该字段识别为布尔值

```
[1] pry(main)> Article.new.active.class
=> Fixnum 
```

这将在验证上产生问题，因为我的班级中有这个验证器

```
class Article < ActiveRecord::Base
  validates_inclusion_of :active, :in => [true, false]
end 
```

当我为该字段分配布尔值时，它们将转换为 FixNum 并且验证失败并显示消息`"1 is not included in the list"`

如果我生成一个具有相同模型的新应用程序，则生成的 sql 代码是

```
CREATE TABLE `posts` (
  `active` tinyint(1) DEFAULT NULL,
) 
```

一切正常：

```
[1] pry(main)> Article.new.active.class
=> FalseClass 
```

有没有办法让我的遗留列被识别为布尔值（可能不运行迁移）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:09:26.690

在and中缺少[覆盖](https://stackoverflow.com/questions/3192978/why-does-ruby-have-trueclass-and-falseclass-instead-of-a-single-boolean-class/3194797#3194797)方法，是否可以按照以下方式简单地定义您自己的“旧”布尔值以用于您的验证：`TrueClass``FalseClass`

```
class Article < ActiveRecord::Base
  $legacy_false, $legacy_true = 0, 1
  validates_inclusion_of :active, :in => [$legacy_true, $legacy_false]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T14:09:32.093

好的，我[发现](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/connection_adapters/abstract_mysql_adapter.rb#L45)MySQL 的布尔类型被硬编码为`tinyint(1)`

```
def simplified_type(field_type)
  return :boolean if adapter.emulate_booleans && field_type.downcase.index("tinyint(1)")

  case field_type
    when /enum/i, /set/i then :string
    when /year/i         then :integer
    when /bit/i          then :binary
  else
    super
  end
end 
```

我已在我的数据库上运行此迁移以使其正常工作

```
class ChangeBooleanFields < ActiveRecord::Migration
  def up
    change_column :articles, :active, :boolean, :null => false, :default => false, :limit => nil
  end

  def down
    change_column :articles, :active, :integer, :null => false, :default => 0, :limit => 1
  end
end 
```

# python - python中是否有用于读取图像和获取RGB值的“绿色”库？

> ID：11668108
> 
> 赞同：1
> 
> 时间：2012-07-26T11:17:29.553
> 
> 标签：python, image, python-imaging-library, rgb

python中是否有用于读取图像和获取RGB值的“绿色”库？

我想获取 jpeg 图像的像素，但我无权在每台机器上安装 PIL 模块，所以我想知道是否有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T11:28:35.720

可以看看“imagemagick”。

和使用流（[手册](http://www.imagemagick.org/script/stream.php)）：

```
stream -map rgb -storage-type char image.jpg pixels.dat 
```

# javascript - 如何在 Greasemonkey 脚本中弹出自定义表单/对话框？

> ID：11668111
> 
> 赞同：5
> 
> 时间：2012-07-26T11:17:32.087
> 
> 标签：javascript, forms, dialog, popup, greasemonkey

我一直在研究一个在 Firefox 中用作插件的脚本，并且遇到了在单击某个按钮时弹出自定义表单的需求。

我需要能够自己创建整个表单，然后解析输入的数据以在原始站点上呈现图像。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-26T12:52:00.703

好的，这是**一个完整的脚本**示例，展示了如何弹出一个表单并与它的控件进行交互。
请注意，它使用[jQuery——](http://jquery.com/)这使得它更容易/更短/更简单。

```
// ==UserScript==
// @name        _Form, popup example
// @include     http://stackoverflow.com/*
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @grant       GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

//--- Use jQuery to add the form in a "popup" dialog.
$("body").append ( '                                                          \
    <div id="gmPopupContainer">                                               \
    <form> <!-- For true form use method="POST" action="YOUR_DESIRED_URL" --> \
        <input type="text" id="myNumber1" value="">                           \
        <input type="text" id="myNumber2" value="">                           \
                                                                              \
        <p id="myNumberSum">&nbsp;</p>                                        \
        <button id="gmAddNumsBtn" type="button">Add the two numbers</button>  \
        <button id="gmCloseDlgBtn" type="button">Close popup</button>         \
    </form>                                                                   \
    </div>                                                                    \
' );

//--- Use jQuery to activate the dialog buttons.
$("#gmAddNumsBtn").click ( function () {
    var A   = $("#myNumber1").val ();
    var B   = $("#myNumber2").val ();
    var C   = parseInt(A, 10) + parseInt(B, 10);

    $("#myNumberSum").text ("The sum is: " + C);
} );

$("#gmCloseDlgBtn").click ( function () {
    $("#gmPopupContainer").hide ();
} );

//--- CSS styles make it work...
GM_addStyle ( "                                                 \
    #gmPopupContainer {                                         \
        position:               fixed;                          \
        top:                    30%;                            \
        left:                   20%;                            \
        padding:                2em;                            \
        background:             powderblue;                     \
        border:                 3px double black;               \
        border-radius:          1ex;                            \
        z-index:                777;                            \
    }                                                           \
    #gmPopupContainer button{                                   \
        cursor:                 pointer;                        \
        margin:                 1em 1em 0;                      \
        border:                 1px outset buttonface;          \
    }                                                           \
" ); 
```

* * *

您会注意到该对话框非常基本。对于更复杂的表单，您可以使用[jQuery-UI](http://jqueryui.com)。

# android - andEngine 中的可变文本更新速度变慢

> ID：11668113
> 
> 赞同：1
> 
> 时间：2012-07-26T11:17:36.933
> 
> 标签：android, andengine

我对 ChangableText 有疑问，我用它来显示当前分数。

但是它有问题，因为它在更新时速度很慢。但是，在达到 90 分后，更新文本时不再有延迟......（只有前 9x10 分）

任何解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:42:54.953

当您创建可变文本时，请尝试指定您将使用的所有数字。

例如：

```
ChangeableText Scoretext = new ChangeableText(100, 100, font, "0123456789", vertexBufferObjectManager); 
```

# php - 从 php 调用 cron 不起作用

> ID：11668118
> 
> 赞同：0
> 
> 时间：2012-07-26T11:17:56.023
> 
> 标签：php, cron

Cron 无法正常工作。我使用以下命令在 /etc/cron.d 中创建了一个文件

```
$ touch /etc/cron.d/php-crons
$ chown www-data /etc/cron.d/php-crons 
```

我得到了像**(*system*php-crons) WRONG FILE OWNER (/etc/cron.d/php-crons)**这样的错误 ，所以我将文件所有者更改为**root**

```
$ chown root /etc/cron.d/php-crons 
```

即使 cron 不工作。我的php文件**（cron.php）**如下

```
 $fp = fopen('/etc/cron.d/php-crons', 'a');
 fwrite($fp, '10 * * * * root usr/bin/php PATH TO SCRIPT/email.php'.PHP_EOL);
 fclose($fp); 
```

当我在那里打开 /etc/cron.d/php-crons 时，我可以看到这项工作。

```
 10 * * * * root usr/bin/php /var/www/PATH TO SCRIPT/email.php 
```

在 email.php 我包括

```
 #!/usr/bin/php
 mail ("examplemail@gmail.com", "Cron Successful Public HTML!", "Hello World from cron.php!"); 
```

如果我将 (/etc/cron.d/php-crons) 文件所有者更改为**root**，然后在浏览器中运行**cron.php**，那么我无法在 /etc/cron.d/php-crons 中写入任何内容并收到警告为跟随。

警告：fopen（/etc/cron.d/php-crons）：打开流失败：第 2 行 /var/www/cron.php 中的权限被拒绝警告：fwrite() 期望参数 1 是资源，布尔值在第 3 行的 /var/www/cron.php 警告：fclose() 期望参数 1 是资源，布尔值在第 4 行的 /var/www/cron.php 中给出。请有人指导我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:54:32.087

有几个问题。正如您所注意到的，您的 cron 守护程序的实现不允许非 root 用户拥有的文件，并且出于同样的安全原因，您将不允许将该文件设为全局可写。

至少在示例中，您的 cron 作业行列出了应该是绝对的相对路径（“usr/bin/php”）。您的 cron.php 文件归 root 所有并不意味着它以 root 用户身份运行。它由 PHP 执行和运行，因为它具有适当的组和/或其他权限位。并且您不应该以 root 身份运行的方式更改权限（例如使用 setuid-chmods）。

您可能应该做的是一个 cronjob 行，它充当 PHP 脚本的包装器。PHP 脚本从数据库中读取您的所有作业并执行它们，甚至是类似于您已经创建的文本文件。

这样，您可以以非 root 用户身份运行包装脚本。大多数 cron 实现允许您在脚本之前使用“su”命令命名其他用户（例如 www-data）（参见`man 5 crontab`等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:54:59.230

您使用的是哪个操作系统？通常对于这样的事情，你想使用每个用户的 crontabs。因此命令以该用户身份运行。/etc/cron.d 用于系统 crontab。(/var/spool/cron/crontabs) 是存储用户 crontab 的位置，但需要启用它们。通常通过将允许使用它们的用户添加到 /etc/cron.allow。允许 Web 进程更改以 root 身份运行的文件确实是个坏主意。使用每个用户选项，它只能触摸它通常可以触摸的东西，因此安全风险较小。

# jquery - 动态列表视图填充 - 关于 jquery mobile 中的自定义 ajax 调用，处理后退按钮查询

> ID：11668123
> 
> 赞同：0
> 
> 时间：2012-07-26T11:18:13.663
> 
> 标签：jquery, jquery-mobile

我有一个 jquery 移动页面。它有一个深度列表，在父级别有类别，单击它会获取子类别并将它们填充到列表中。现在的问题是，我必须处理后退按钮。我可以使用 Ben Alman's BBQ 来解决这个问题，但随后一切都将在哈希更改事件中手动处理。但是根据我的阅读，在 jquery mobile 中它已经在内部使用了 bbq。

**有什么简单的方法可以将当前页面状态推送到历史记录中，并且当用户单击后退按钮时它将由 jquery mobile 处理？** 

避免它的原因是它可以节省许多错误。我以前用过它，当事情变得太深时，处理后退按钮变得非常困难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:44:17.960

只要您不在`pagehide`事件中以编程方式清空列表或从 DOM 中删除页面；您应该使用后退按钮返回上一页的列表`<a href="#" data-rel="back"></a>`。

# node.js - 如何在 CloudFoundry 上运行节点检查器？

> ID：11668125
> 
> 赞同：1
> 
> 时间：2012-07-26T11:18:17.403
> 
> 标签：node.js, cloud-foundry

我想在 CloudFoundry 上调试我的节点应用程序。如何在 Cloudfoundry 上设置/运行节点检查器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T08:13:08.577

不幸的是，我们不支持 CloudFoundry.com 上的节点检查器，我们计划在不久的将来支持它，但目前还不支持。

我相信私有 CloudFoundry 实例是可能的，如果您需要更多信息，请告诉我，我可以将相关文档发送给您。

# facebook - Facebook 是否替换了 fb_ref 参数？

> ID：11668126
> 
> 赞同：0
> 
> 时间：2012-07-26T11:18:18.557
> 
> 标签：facebook, facebook-opengraph

今天早上，我发现当您将**fb_ref**参数添加到操作或喜欢的链接时，Facebook 没有返回该参数。相反，他们似乎用一系列新参数取代了它：action_ref_map、action_object_map、...

有人可以确认我的这种变化吗？这破坏了我们的软件。

编辑

这是我发现的一个例子：

```
http://uk.omg.yahoo.com/news/john-travoltas-year-gay-affair-pilot-revealed-122446486.html?fb_action_ids=10151047496853334&fb_source=other_multiline&action_object_map={%2210151047496853334%22%3A10151788645595106}&action_type_map={%2210151047496853334%22%3A%22news.reads%22}&action_ref_map={%2210151047496853334%22%3A%22type%3Aread%2Cuser%3A1k-WK59_Yk-EnPq2w1zMLBjX7nA%22}&code=AQCH-sq6XRSQCXj4QNkKlnusWLgIvBaZduNhGO0RNdiXgfCSGUOd1qinfHVw1iFQfs-0KVxFdPpWXD9nWrjEC1naU87H5W4GnxnTPL5j2raksea2pFxuy0rtgSpAa6ExZYCc7PkzIyjNnGTdK6N7g0Spb7qiqSboTgWZOojQJYbEF2XHenlROjhP8--NkvzrxU8#_=_ 
```

**编辑 2**

Facebook 似乎已经激活了一个新系统，用于在沙盒 FB 应用程序中返回“fb_ref”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:44:47.007

[https://developers.facebook.com/docs/fb_source/](https://developers.facebook.com/docs/fb_source/)是（并且应该是）推荐信息的主要来源，并且开放图操作始终有自己的推荐参数，显示哪些操作出现在故事​​/聚合中触发了点击

当您在源发布上有一个“ref”参数时会提供 fb_ref，但据我所知，那里没有变化

（例如，带有 ref = foo 的按钮会导致点击返回到您的应用，其中 fb_ref=foo、fb_source=ticker 或类似的东西）

# php - PHP 正则表达式 - 添加 UTF-* 字符

> ID：11668127
> 
> 赞同：0
> 
> 时间：2012-07-26T11:18:25.753
> 
> 标签：php, regex

我正在学习正则表达式。

我有以下正则表达式：

```
/^[a-zA-Z0-9 +=,?.;:\'\"_()-]+$/m 
```

我需要在这个正则表达式中添加 UTF-8 字符。用 u 修饰符添加 \w 不起作用 - 任何想法为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:54:24.843

你的问题不清楚。如果您想将所有 unicode 字符添加到`[...]`，那么它将匹配所有内容...

如果您只想添加一些特定的 unicode，则使用`\uXXXX`where `XXXX`is its hex code。但是对于 PHP，您需要添加`/u`修饰符。

[在http://www.regular-expressions.info/unicode.html](http://www.regular-expressions.info/unicode.html)了解更多信息

* * *

更新：多次阅读您的帖子后，我相信您正在寻找正则表达式

```
/^[\p{L}\p{N} +=,?.;:\'\"_()-]+$/um 
```

# python - 新手需要 Python 日志记录帮助

> ID：11668129
> 
> 赞同：2
> 
> 时间：2012-07-26T11:18:28.500
> 
> 标签：python, logging

请帮我理解。我是python新手。我正在编写 WSGI 应用程序。我想打开登录。我愿意：

```
logger = logging.getLogger(__name__) 
```

然后我想在日志中打印一些东西：

```
logger.exception("Some exception...") 
```

它都在哪里商店？仅在控制台输出中或服务器上某处有文件？如果是这样，我在哪里可以找到这个文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:26:12.387

```
import logging
logging.error("Error")  # Prints to console 
```

这是如何将日志写入文件

```
logging.basicConfig(filename='Error.log',level=logging.ERROR)
logging.error('Error') 
```

打开`Error.log`你会看到

```
ERROR:root:Error 
```

更多信息[在这里](http://docs.python.org/howto/logging.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:23:32.843

实际上，您必须自己指定文件，例如使用[logging.basicConfig()](http://docs.python.org/library/logging.html#logging.basicConfig)：

```
logging.basicConfig(filename="/path/to/your/logfile.log") 
```

记录有时可能是一件相当复杂的事情，我建议你阅读[HOWTO](http://docs.python.org/howto/logging.html)。

# jdbc - 数据库中的游标与 JDBC 游标和 SQLJ 游标的比较

> ID：11668130
> 
> 赞同：0
> 
> 时间：2012-07-26T11:18:29.083
> 
> 标签：jdbc, cursor, db2, sqlj

有人可以简要比较和对比 SQL 过程中游标的使用与它们在 SQL 过程中的使用吗？

1.  JDBC
2.  SQLJ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-02T14:08:31.027

使用 SQLj 时作为静态查询。相反，它们在使用 JDBC 时是动态的，这意味着查询编译和访问计划是在执行查询时计算的。在 SQLj 中，这些步骤在编译时完成，只留下执行以访问数据。

# python - 带有变音符号错误的 Python URL 编码

> ID：11668132
> 
> 赞同：2
> 
> 时间：2012-07-26T11:18:34.257
> 
> 标签：python, encoding, urllib2

我正在阅读网页内容并检查带有变音符号的单词。该词出现在页面内容中。但是python`find('ü')`函数没有找到这个词。

```
import urllib2
opener = urllib2.build_opener()
page_content = opener.open(url).read() 
page_content.find('ü') 
```

我试图用 u'ü' 转换搜索字符串。那么错误是

```
'SyntaxError: (unicode error) 'utf8' codec can't decode byte 0xfc in position 0' 
```

我在我的 .py 文件中使用了 # - *- coding: utf-8 - -。*

我已经打印了 page_content。那里的变音符号 ü 正在转换为 'ü'。如果我尝试使用 page_content.find('ü')，它工作正常。请让我知道是否有更好的解决方案。

我将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:29:58.420

您的 Python 尝试将源文件（或控制台输入）解析为 UTF-8，但它实际上是用 Latin-1 编码的。你可以尝试放一个

```
# coding: iso-8859-1 
```

在源文件的顶部添加注释，或者更好的是，使用支持 UTF-8 的编辑器/终端仿真器并将脚本保存在该编码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:34:15.440

如果您按如下方式在文件顶部定义 UTF-8 编码，则应该可以。请注意，该`coding`行必须是 hashbang 之后的第一行或第二行。

```
#!/usr/bin/python
# coding: utf-8

import urllib2

url = 'http://en.wikipedia.org/wiki/Germanic_umlaut'
opener = urllib2.build_opener()
page_content = opener.open(url).read() 
page_content.find(u'ü') 
```

# git - Git：我如何监控活动？

> ID：11668136
> 
> 赞同：1
> 
> 时间：2012-07-26T11:18:44.533
> 
> 标签：git

我的团队目前使用一个古老的、可怕的源代码控制库，我们正在寻求切换到一个更成熟的系统。Git 是最吸引我们的。

我们开发供公司内部使用的软件和脚本，我们同时从事许多项目。同一个开发人员可能会在几周内从事一个长期项目，中间有几个小到小项目。

我们当前的 VCS 有一个中央存储库，每个人都可以签出并返回到这个位置。您的工作站上只有当前副本。

我们当前的库让我做的一件事是查看谁签出了文件但忘记签入更改。使用 git，所有存储库都是本地的，那么如何知道有人忘记推送到中央副本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:28:25.020

重要的问题是你为什么需要知道。因为看起来你有人的问题而不是技术问题。此类问题的技术解决方案在实践中很少奏效。

旧的版本控制系统知道服务器上的“签出”操作，因为它们不擅长合并，因此需要防止两个人同时处理同一个文件。但这引起了很多问题，因为人们需要互相等待，所以它被“编辑-合并-提交”工作流程所取代，在该工作流程中，多人可以同时处理同一个文件，因为实际上所做的更改是大多数时候很容易结合。版本控制服务器不再关心本地修改。分布式版本控制通过将中间步骤存储为并行历史记录更进一步。

所以你不需要知道谁有本地更改，因为它会阻止任何人；它不是。

你可能想知道我能想到的唯一另一个原因是，你可以提醒他们他们还没有完成它。这就是人的问题，看到未提交的更改并不能解决它。如果他们甚至没有开始呢？或者他们出于某种原因开始并取消了结帐？

因此，您需要跟踪他们分配了哪些任务，并询问他们的状态。git 可以让他们轻松地向您展示他们正在进行的工作，方法是推送到临时分支或通过电子邮件发送差异，甚至通过网络导出他们的本地存储库，以便您可以从中提取。

# android - 安卓彩信应用

> ID：11668137
> 
> 赞同：-1
> 
> 时间：2012-07-26T11:18:45.120
> 
> 标签：android, newline, mms, enter

我想修改 Android 中的默认 MMs 应用程序，以便回车键不会导致消息被发送。

换句话说，我希望当用户输入“回车键”时，应用程序插入新行而不是发送消息。

如何实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:31:49.033

除非您可以访问完整的 ASOP 源代码并且可以重新编译 MMS 应用程序，否则您不能这样做。这需要您修改 MMS 应用程序源代码，然后替换设备上的 APK。**特别是除非您拥有自己的设备/ROM，否则仅从**应用程序的角度来看这是不可能的。您必须有权访问该平台。

# .net - .NET 重建用户控件

> ID：11668141
> 
> 赞同：0
> 
> 时间：2012-07-26T11:18:57.720
> 
> 标签：.net, user-controls

我对使用 Visual Studio 2010 创建的用户控件有疑问。

具体来说，我创建了一个简单的用户控件，扩展了默认的 Label .Net 控件。使用设计器，我将用户控件的背景色指定为“白色”（请注意，我的用户控件确实有一个没有被任何其他控件占用的区域）。构建项目后，我通过将控件从工具箱中拖动到同一解决方案下的第二个项目的表单上。

放置控件后，我修改了用户控件的相同属性并将 BackColor 设置为“红色”。我重新编译了整个解决方案（检查了项目依赖项——首先是用户控制项目，最后是依赖的第二个项目）。随后，我在表单上创建了我的用户控件的第二个实例（通过从工具箱中拖动它）。尽管第二个实例按预期显示为“红色”背景，但第一个实例仍以“白色”背景色显示。

这对我来说非常不直观，我想知道为什么？当更改影响在表单上放置后未覆盖的属性时，我希望*所有*控件都采用对基类所做的任何更改。我设法得出的唯一结论是，它与 VS 为控件的第一个实例生成“designer.vb”代码以及*之后*不再重新生成它有关，即使基本用户控件已被更改和重新编译。

有任何想法吗 ？

***更新**：谢谢大家的回答！我想指出，设置 BackColor 属性只是说明我的观点的一个例子。在我看来，即使在设计时没有为我的自定义控件定义任何属性，VS 也会在后面的代码中生成一组标准的属性（除了开发人员定义的任何显式属性）。因此，省略属性的显式说明并不总能解决问题（在 Designer.vb 文件中设置属性的默认 VS 机制）。我相信一劳永逸地解决这个问题的唯一方法是在控件的 New 或 Load 方法中设置属性初始化代码；当需要执行大量初始化时，并不总是一个实用的解决方案！*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T00:32:33.510

这是错误的，因为您没有告诉设计人员该属性的默认值是什么。因此，当您将自定义标签放在表单上时，设计器会在表单的 Designer.cs 文件中生成此类代码：

```
 this.myLabel1.AutoSize = true;
        this.myLabel1.BackColor = System.Drawing.Color.Red;         // <=== Here !
        this.myLabel1.Location = new System.Drawing.Point(19, 22);
        this.myLabel1.Name = "myLabel1";
        this.myLabel1.Size = new System.Drawing.Size(52, 13);
        this.myLabel1.TabIndex = 0;
        this.myLabel1.Text = "myLabel1"; 
```

标记的声明破坏了它。当您现在更改控件类中的默认值时，您已经放置在任何窗体上的任何控件都**不会**更改为该默认颜色，设计器代码将覆盖它。

您需要使用 [DefaultValue] 属性告诉设计者您的默认值。像这样：

```
using System;
using System.ComponentModel;
using System.Drawing;
using System.Windows.Forms;

class MyLabel : Label {
    public MyLabel() {
        this.BackColor = Color.Red;
    }
    [DefaultValue(typeof(Color), "Red")]
    public override Color BackColor {
        get { return base.BackColor; }
        set { base.BackColor = value; }
    }
} 
```

现在设计器将**忽略**分配，您在控件内所做的任何更改都将生效。属性语法很笨拙，不幸的是您需要使用字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:33:24.767

> 我设法得出的唯一结论是，它与 VS 为控件的第一个实例生成“designer.vb”代码以及之后不再重新生成它有关，即使基本用户控件已被更改和重新编译。

这是正确的结论。您明确告诉设计人员将`BackColor`第一个控件的 设为白色，它通过将代码插入将属性`*.Designer.vb`设置为白色的文件来遵守。`BackColor`它无条件地执行此操作，以便它覆盖控件的*默认* `BackColor`属性。

当您`BackColor`将控件的默认属性更改为红色时，这会影响已创建的控件的所有*新*实例，因为它们仍在使用默认属性值。但它不会影响您已明确覆盖该属性值的控件实例。

尽管这种行为在您看来并不直观，但它实际上是设计使然。如果您希望控件的所有实例都继承默认背景颜色，则不要`BackColor`为它的单个实例设置属性。

要强制控件的特定实例使用默认背景颜色，即使您已明确设置它，右键单击属性窗口中的属性并选择“重置”。在这种情况下，自定义控件的第一个实例的背景应变为红色，因为它继承了该特定属性的默认值。

* * *

为了响应您的更新，问题在于各种控件类设置了它们自己的默认值（通过它们自己从它们的父类覆盖它们`Control`）。如果您想用自定义控件的新默认值覆盖那些，您需要为此在自定义控件类中编写代码。您不能在设计器中执行此操作，因为这只影响自定义控件的特定*实例，而不影响整个类。*

您需要特别做两件事。首先，覆盖相关属性并使用`DefaultValueAttribute`. 其次，在类的构造函数中设置属性的默认值。

下面是一个继承自默认控件的自定义控件的示例`Label`。我有所有标准控件的版本，基本上只是默认强制`FlatStyle`属性`FlatStyle.System`。该代码在 VB.NET 中是任意的，但如果 C# 是您的首选方言，您应该能够轻松转换它。

```
Imports System.Windows.Forms
Imports System.ComponentModel
Imports System.Drawing

<ToolboxItem(True)> <ToolboxBitmap(GetType(ResFinder), "LabelEx.bmp")> _
<Description("A standard Windows label control for displaying static text and images.")> _
Public Class LabelEx : Inherits Label

    ''' <summary>
    ''' Gets or sets the flat style appearance of this label control.
    ''' </summary>
    <DefaultValue(GetType(System.Windows.Forms.FlatStyle), "System")> _
    Public Shadows Property FlatStyle As FlatStyle
       'Set the default flat style to System
       Get
          Return MyBase.FlatStyle
       End Get
       Set(ByVal value As FlatStyle)
          MyBase.FlatStyle = value
       End Set
    End Property

    ''' <summary>
    ''' Initializes a new instance of the LabelEx" class with default settings.
    ''' </summary>
    Public Sub New()
       MyBase.New()

       'Set default property values
       Me.FlatStyle = FlatStyle.System
    End Sub

End Class 
```

此一般规则的唯一主要例外是如果您想更改控件的大小或填充的默认值。在这种情况下，您应该只覆盖 protected`DefaultSize`和`DefaultPadding`属性；IE

```
 ''' <summary>
  ''' Gets the default Size of a ButtonEx control.
  ''' </summary>
  Protected Overrides ReadOnly Property DefaultSize As Size
     Get
        Return New Size(88, 26)
     End Get
  End Property

  ''' <summary>
  ''' Gets the spacing, in pixels, around the image that is displayed on this button control.
  ''' </summary>
  Protected Overrides ReadOnly Property DefaultPadding As Padding
     Get
        Return New Padding(7, 0, 0, 0)
     End Get
  End Property 
```

在这种情况下，您不应在构造函数中为公共属性设置默认值。

有关如何编写自定义控件（以及一些有用的控件！）的更多线索，您可以查看[Windows Forms Aero](http://windowsformsaero.codeplex.com/)库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:39:22.970

你是对的，背景色是在表单设计器生成的代码中定义的。

如果您确实想在仍从 Label 继承的同时禁用设置背景颜色，则可以覆盖 BackColor 属性并将其从设计器的属性选项卡中删除：

```
[EditorBrowsable(EditorBrowsableState.Never)]
[Browsable(false)]
public override Color BackColor
{
    get
    { 
        return Color.Blue;
    }
    set
    {
    }
} 
```

# android - 关于android启动模式“singleTask”

> ID：11668144
> 
> 赞同：36
> 
> 时间：2012-07-26T11:19:05.097
> 
> 标签：android, android-activity, launchmode

我阅读了 android 开发人员指南和互联网上的一些文章，我仍然对`singleTask` `launchmode`. 举个例子：

用户启动 App1，android 启动一个新任务。假设 App1 按以下顺序创建活动：

```
ActivityA -> ActivityB -> ActivityC 
```

这就是 task1 的样子。

然后用户单击主页按钮并选择启动 App2，因此 task1 进入后台，android 启动一个新任务：task2，用户执行以下操作：

```
ActivityD -> ActivityE 
```

现在让我们说`ActivityE`尝试启动`ActivityB`，并`ActivityB`具有启动模式`singleTask`。

我的理解是 task1 再次进入前端，而 task2 进入后台。task1 现在看起来像这样：

```
ActivityA -> ActivityB 
```

意思是：

1.  `ActivityC`将从 task1 中删除，ActivityB 成为顶部 Activity 。

2.  如果用户现在单击“返回”按钮，他将返回`ActivityA`任务 1 而不是返回`ActivityE`任务 2

我对吗？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-26T12:01:50.707

你说得对。

你为什么不测试一下。

还有这个应用程序可以帮助解释启动模式：

[https://play.google.com/store/apps/details?id=com.novoda.demos.activitylaunchmode](https://play.google.com/store/apps/details?id=com.novoda.demos.activitylaunchmode)

![在此处输入图像描述](../Images/37ff2eb483f21a176fe40285b7056efe.png)

来源在[https://github.com/gnorsilva/Activities-LaunchMode-demo](https://github.com/gnorsilva/Activities-LaunchMode-demo)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-26T12:15:06.193

```
The ActivityC will be removed from task1 and ActivityB becomes the top Activity. 
```

是的，你是对的...

ActivityC 将`removed`来自 即`onDestroy`ActivityC 的方法将被调用。因此，当用户再次启动任务 1 时，将显示 ActivityB 而不是 ActivityC。

已创建 2 个任务（项目）并上传了相同的[@SendSpace](http://www.sendspace.com/file/374hfu)。试试看...

如果您查看 androids[文档](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)，它会说

*““singleTask”活动允许其他活动成为其任务的一部分。它始终位于其任务的根部，但其他活动（必须是“标准”和“singleTop”活动）可以启动到该任务中。”*

这意味着当您单击主页按钮时，单任务活动（在您的情况下为 ActivityB）之上的所有活动都将从堆栈中删除。

在示例中，如果您只是运行项目“AndroidTest”并单击日志中的主页按钮，您可以看到我之前为您提供的应用程序，您可以看到第二个 Activity 处于暂停状态，当您从“最近”再次启动它时应用程序”列表中的第二个 Activity 已被销毁。

在单实例活动（ActivityB）之上的 Activity 没有从 Back Stack 中移除的情况下，并且另一个应用程序请求此 Activity（ActivityB），它可能不会显示并且可能会丢弃 Intent。但这发生的机会极少，因为用户必须按下 Home 按钮，但在 BackStack 中的当前 Task\App 才能导航到另一个 Task\App。

因此警告

***其他模式——singleTask 和 singleInstance——不适用于大多数应用程序，因为它们会导致用户可能不熟悉的交互模型，并且与大多数其他应用程序非常不同。***

我希望这能解决你的疑惑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-05-18T19:21:04.737

正确，无论何时启动 singleTask 活动，它都会在前台清除当前存在于其上方的所有活动，如果您的 singleTask 活动在顶部，它将与 singleTop 行为相同。

PS - onCreate 不是第二次调用，而是调用 onNewIntent。

检查这个链接，很好地解释了启动模式。 [https://medium.com/android-news/android-activity-launch-mode-e0df1aa72242](https://medium.com/android-news/android-activity-launch-mode-e0df1aa72242)

# php - 身份验证后加载 iframe

> ID：11668145
> 
> 赞同：0
> 
> 时间：2012-07-26T11:19:07.750
> 
> 标签：php, curl, facebook-apps

我正在为这个特定场景寻找一个安全的解决方案：

1.  我有一个 index.php 文件（比如说 www.my-app.com/index.php）
2.  我必须 HTTP 将身份验证详细信息发布到 www.domain.com/login
3.  验证登录后，我必须在 index.php 中的 iframe 中加载响应

在研究时我发现了以下解决方案，

> 解决方案 #1：使用 javascript(jquery) / 简单的 html 表单将用户名和密码提交到 www.domain.com 并提及目标作为该特定 iframe 的 id。因此，应用程序会在该 iframe 中加载。

我的看法：这可能不安全，因为用户名和密码可能被嗅探，会话可能被劫持。我不知道怎么做，但这似乎是可能的。（甚至隐藏变量也可以在源码中看到）

解决方案#2：

> 使用 php curl 提交用户名和密码并在 iframe 中加载 url。

（不是很清楚如何实现这一点。）

限制：不是 php 专家（我想很明显）。一个代码片段会有所帮助。

是否有另一种方法以安全的方式实现相同的技术？

我已经看到 facebook 对他们的页面选项卡应用程序做了同样的事情。我相信大多数支付框架都是这样做的。但他们是怎么做到的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:45:09.897

我对 CURL 了解不多。它可能会帮助您解决第二个解决方案（PHP - CURL）

```
<?php
 $ch = curl_init('http://mysite.com/index.php');
 curl_setopt ($ch, CURLOPT_POST, 1);
 curl_setopt ($ch, CURLOPT_POSTFIELDS,"username=xyz&pwd=123");
 $result = curl_exec ($ch);
 curl_close ($ch);
?> 
```

根据php手册：

```
 curl_exec() returns TRUE on success or FALSE on failure. 
  However, if the CURLOPT_RETURNTRANSFER option is set, it will return the result on success, FALSE on failure. 
```

所以你有来自其他网站的结果，你可以在其中显示`iframe`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:54:42.977

> 我必须 HTTP 将身份验证详细信息发布到 www.domain.com/login

从您的安全问题来看，我了解到这些身份验证详细信息不是您应用程序当前用户的身份验证详细信息，而是使用属于您的固定帐户访问 domain.com 服务所需的一般身份验证详细信息？

如果是这样，我会说这是*设计使然*。您不能以任何保存方式使用*您的登录凭据让客户端登录到其他服务。*

如果 domain.com 上的服务是您自己的，那么您必须想办法用它来验证客户端，而不必向该客户端提供登录凭据。

如果您使用的是第三方服务——请他们提供更好的解决方案。

顺便说一句，这与 Facebook 到底有什么关系？

# javascript - 使用 Sizzle 选择缓存节点的子元素

> ID：11668149
> 
> 赞同：4
> 
> 时间：2012-07-26T11:19:09.813
> 
> 标签：javascript, jquery, sizzle

有谁熟悉 Sizzle 吗？是否支持选择缓存 DOM 节点的子节点？像 jQuery：

```
var body = jQuery('body');
var div = jQuery('#mydiv',body); 
```

10 倍的帮助，BR

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T11:21:19.750

使用带有上下文的直接子选择器：

```
Sizzle( "> *", body); 
```

事实上，我直接复制粘贴了 Sizzle 源代码，这很有效，所以我不明白反对意见：

```
var body = Sizzle("body");
var childrenOfBody = Sizzle( "> *", body[0]); 
```

# c# - 装饰器模式与继承的例子

> ID：11668150
> 
> 赞同：32
> 
> 时间：2012-07-26T11:19:12.080
> 
> 标签：c#, .net, design-patterns, inheritance, decorator

例如，我一直在尝试使用装饰器模式来扩展您不想接触的代码的功能，并且我看到了如何实现它，但是我现在不确定为什么您不只是从原始类继承并以这种方式进行扩展。

我读过装饰器模式允许您在运行时添加功能，而继承意味着它在编译时就在那里。

我不明白这一点。

有人可以解释一下，提供示例并解释何时使用装饰器与继承更好。

谢谢

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-26T11:29:26.757

假设您创建了一个 View 类，以某种方式显示您的项目。现在你决定你还想要一个可滚动的版本，所以你创建了一个继承 View 的 ScrollableView。后来你决定你也想要一个有边框的版本，所以你现在需要制作一个 BorderedView 和一个 BorderdScrollableView。

另一方面，如果您可以为每个添加的样式制作一个装饰器。您将有以下课程：

*   看法
*   可滚动装饰器
*   边框装饰器

当您想要一个有边框的滚动视图时，您可以：

`new BorderedDecorator(new ScrollableDecorator(new View()))`.

因此，您可以仅使用 3 个类来配置任何组合。而且您可以在运行时添加或删除它们（假设您单击一个显示添加边框的按钮，您现在用 BorderDecorator 包装您的视图......而如果您还没有继承，您需要实现这个视图类，或者您需要创建一个新的视图实例并将所有相关数据从第一个视图复制到第二个视图，这不像添加或删除包装器那么容易）。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-07-26T11:28:59.603

想象一个像文明这样的游戏，地图上的每个方格都可以附有各种资源（例如，各种矿石、木材或石油等）。

如果您使用直接继承，则需要为每种正方形创建一个类。拥有它会很笨拙

```
public class OilSquare {}
public class OilAndGoldSquare {}
public class GoldAndSilverSquare {}
// etc. 
```

装饰者模式允许人们混合和匹配，而无需创建严格的层次结构。所以，你会改为：

```
public class Square {}
public class GoldDec {}
public class SilverDec {}
public class OilDec {}

// ...

var crazyMix = new GoldDec(new SilverDec(new OilDec(new Square()))); 
```

换句话说，装饰器允许创建管道行为，管道中的每个步骤都可以与另一个步骤交换。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-07-26T11:45:16.930

正如其他人已经说过的那样，装饰器有利于向事物添加“选项”......好处在于您可以通过装饰器链接方法等。

想象一下，我买了一辆带有皮革内饰、金属漆和超棒扰流板选项的汽车……

这三个选项有 8 种不同的组合，但是对于装饰器，您只需要三个额外的类。

有趣的是装饰器模式的工作方式。举个简单的例子：

```
public class MetallicPaint : Car
{
    private Car car;
    public MetallicPaint(Car wrappedCar)
    {
        car = wrappedCar;
    }

    public decimal Cost()
    {
        return car.Cost() + 500;
    }

    public string Description()
    {
        return car.Description() + ", Metallic Paint";
    }
    public string Speed()
    {
        return car.Speed();
    }
    [... {pass through other methods and properties to the car object}]
} 
```

这不是一个完整的示例，但强调了装饰器如何与它正在装饰的对象进行交互。当然，因为它实现了汽车，所以它可以像汽车一样以其他方式使用（并通过装饰器不影响内部汽车对象的任何东西）。

当然，如果你有多个这样的装饰器，每个装饰器都嵌套了一辆汽车，那么它们的成本、描述的一部分以及扰流板可能会改变速度，而其他的则不会……

从本质上讲，它允许您以比继承更模块化和更少基础的方式修改对象。装饰器应该始终像基础对象一样使用（在这种情况下`Car`），因此它们不应该公开任何新方法或属性，只是稍微改变现有方法或属性的效果。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-01-27T21:38:59.057

如果您要添加许多功能并且还需要组合这些功能，则装饰器模式比继承更好。假设您的基类是 A，并且您想扩展（装饰）这个基类，其特征是 f1,f2,f3,f4 以及它们的某种组合，例如 (f1,f2) 和 (f1,f3) 和 ..；所以你需要在你的层次结构中创建 4!=4*3*2*1=24 类（每个特征 4 个，其余的用于它们的组合）。而使用装饰图案，您只需要创建 4 个类！

* * *

对于@Razvi 帖子中的@Seyed Morteza Mousavi：你是对的，我们可以将两个属性 Scrollable 和 Bordered 添加到 View 类，然后检查该属性是否设置为 true 以便运行所需的行为。但这要求我们已经知道我们需要的功能的数量（装饰器模式不是这种情况）。否则，对于我们想要添加到我们的类的每个新特性（比如 f1），我们需要更改我们的主类，或者继承主类（你会说）并添加属性。采用后一种方法，您将进一步需要更改处理功能组合的代码部分（这不好，因为它不遵守“松散耦合！”的经验法则）

希望这可以帮助。

# wpf - MVVM Light UniversalConverter bool to Visibility

> ID：11668166
> 
> 赞同：2
> 
> 时间：2012-07-26T11:19:58.420
> 
> 标签：wpf, mvvm-light

我正在尝试在绑定的布尔值上进行一对`TextBlock`s 切换（一个`Visible`，另一个`Collapsed`，反之亦然）。

我可以用`BooleanToVisibilityConverter`一个但不能做一个！对于另一个，所以我尝试使用 MVVM Light's `UniversalConverter`，它在`ConverterParameter`.

麻烦的是，我找不到任何使用示例并且我的尝试失败了。

我已经在 XAML 资源中声明了它：

```
<Window.Resources>
    <ex:UniversalConverter x:Key="UniversalConverter" />
</Window.Resources> 
```

然后将其添加到`TextBlock`：

```
<TextBlock Visibility="{Binding Path=ShowA, Converter={StaticResource universalConverter}, ConverterParameter='b=>b?Visible:Collapsed'}">A</TextBlock>
<TextBlock Visibility="{Binding Path=ShowA, Converter={StaticResource universalConverter}, ConverterParameter='b=>b?Collapsed:Visible'}">B</TextBlock> 
```

这会在 XAML 设计窗口中引发异常：`Unknown identifier 'Visible'`.

我也试过`b=>b?Visibility.Visible:Visibility.Collapsed`这是 UniversalConverter`Convert`方法注释中的一个例子；那抛出`Unknown identifier 'Visibility'`。

如何将所需的引用添加到`UniversalConverter`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:22:22.903

老实说，我从未使用过`UniversalConverter`优秀的 MVVM Light 工具包框架中的类，所以我无法回答您的具体问题“如何使其工作”。

但是为了解决您的**实际**问题，您可以创建自己的`BooleanToVisibilityConverter`允许**反转 true/false 和 Visible/Collapsed 之间的映射**。请参阅[如何反转 BooleanToVisibilityConverter？](https://stackoverflow.com/questions/534575/how-do-i-invert-booleantovisibilityconverter)举些例子。

`UniversalConverter`就个人而言，出于多种原因，我真的会避免使用：

*   你现在知道的无证
*   强制在 XAML 中编写编程逻辑，这不是 XAML 的主要目标......
*   ...强制编写无法调试的 C# 代码行（至少对于 VS2010 + .Net 4），这意味着这个转换器是错误的方法恕我直言

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-21T12:57:54.757

它似乎`UniversalConverter`自 2013 年以来已被删除

[http://blog.galasoft.ch/posts/2013/01/mvvm-light-v4-1-26-change-log/](http://blog.galasoft.ch/posts/2013/01/mvvm-light-v4-1-26-change-log/)

> BL0023.004, 移除 UniversalConverter

# iphone - 使用块时“指向整数转换的指针不兼容”

> ID：11668169
> 
> 赞同：1
> 
> 时间：2012-07-26T11:20:08.387
> 
> 标签：iphone, objective-c, ios, objective-c-blocks

我在下面的代码中收到这些警告。任何想法如何解决这个问题？谢谢你的帮助。

*   缺少类型说明符，默认为 'int'
*   指向使用 'void *' 类型的表达式初始化 'int' 的整数转换的不兼容指针；
*   未使用的变量“mymoviePlayerController”

重要的线是`"__block mymoviePlayerController = nil;`

```
- (void) moviePlaybackCompleteLightBox:(NSNotification*) notification {

        MPMoviePlayerController *mymoviePlayerController = [notification object];  
        [[NSNotificationCenter defaultCenter] removeObserver:self  
                                                        name:MPMoviePlayerPlaybackDidFinishNotification  
                                                      object:mymoviePlayerController]; 

        // movie fadein transition ====================
        self.moviePlayerController.view.alpha = 1;

        [UIView animateWithDuration:0.3f delay:0.0 options:UIViewAnimationCurveEaseOut
                         animations:^{
                             self.moviePlayerController.view.alpha = 0;   
                         }
                         completion:^(BOOL finished) { 
                             [mymoviePlayerController stop];
                             [mymoviePlayerController.view removeFromSuperview];
                             __block mymoviePlayerController = nil;

                         }];

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T11:25:32.307

`__block`在**声明**变量时使用，而不是在为其赋值时使用。所以编译器把下面这行当做变量声明，这是错误的：

```
 __block mymoviePlayerController = nil; 
```

声明变量时应使用 __block 属性：

```
__block MPMoviePlayerController *mymoviePlayerController = [notification object]; 
```

**PS**你为什么在这里使用__block？在这种情况下看起来你不需要它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T11:29:19.203

首先，如果您之后不使用它，您不必将`mymoviePlayerController`变量设置为 nil。不用担心，从其父视图中删除控制器的视图就足够了。

其次，您不能使用`__block`块内的限定符使变量可写。您必须修改代码以使变量在块外可写：

```
__block MPMoviePlayerController *blockMoviePlayerController = mymoviePlayerController;
[UIView animate...animations:...complection:^(BOOL finished) {
    blockMoviePlayerController = nil; // or something else
}]; 
```

# networking - 如何计算 IP 标头长度？

> ID：11668172
> 
> 赞同：5
> 
> 时间：2012-07-26T11:20:32.593
> 
> 标签：networking, ip, ipv4

我想用以下语句计算 IP 标头长度：

> Header Length 是一个四位字段，顾名思义，以 32 位字表示 IP 标头的长度

现在我在用四位字段计算 IP 标头长度（最小和最大）时遇到了困难。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-26T11:24:12.090

*   有效数据报的 IPv4 报头最小长度为 20 字节，当值读取为 5 且没有选项时
*   由于该字段为 4 位宽，它可以存储的最大值为 15，因此标头的最大长度为 60 字节。

> Internet Header Length 是**32 位字的**Internet 标头长度，因此指向数据的开头。请注意，正确标头的最小值是 5。

这意味着在 IHL 中存储的任何值都应乘以 32 以获得总位数，或乘以 4 以获得总字节数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-16T17:11:08.090

标头长度的最小值是 20 字节，但我们没有足够的位来表示 20，所以我们使用缩放技术，即 0101 (5) 将表示 4 X 5 = 20 字节，这里缩放因子是 4。

4位可能的最大值是15。

所以最大可能的标头长度是 4 X 15 = 60 字节。

```
Header Length |  Header Length Field

         20 -----> 5
         24 -----> 6
         28 -----> 7
            .
            .
            .
         60 -----> 15 
```

如果标头长度为 22 字节，那么我们使用填充使其成为 4 的倍数，即 24 字节

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-04T12:03:08.563

@Amit> HL 字段中的值 = IP 头总长度中的 4 字节数。意思是如果头长度字段是 40，那么计算 40 中有多少 4 字节？它的 40/4=10。所以值在 HL 字段中为 10

## 最低 HL 值

最小 HL 为 20 字节。即 20 中没有 4 字节 = 20/4=5。因此 HL 字段中的最小值为 5。

## 最大 HL 值

HL 是一个 4 位字段。因此可以在该字段中容纳的最大值是 15（1111），或者您可以使用公式 2^4-1=15 进行计算。所以 4 个字节的最大编号：可以是 15。因此最大标头长度=15*4=60bytes。

希望现在一切都清楚了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-03-03T03:37:18.493

> Internet 标头长度 (IHL) 字段是 IPv4 标头中 32 位字（=4 字节）的数量，包括任何选项。因为这也是一个 4 位字段，所以 IPv4 标头被限制为最多 15 个 32 位字（=60 字节）

所以如果 IHL 的值为 0101(5)，那么 IP-header 的长度是 5*4(bytes) = 20(bytes)

# php - wamp 本地主机 .htaccess 导致禁止错误？

> ID：11668173
> 
> 赞同：1
> 
> 时间：2012-07-26T11:20:41.557
> 
> 标签：php, wampserver

我一直在尝试重写网址。这是我的 httpd.conf 中的内容

```
<Directory "C:\wamp\www\base">
    Options None
    AllowOverride all
    Order deny,allow
    Allow from all
    Satisfy all
</Directory>

#
# Note that from this point forward you must specifically allow
# particular features to be enabled - so if something's not working as
# you might expect, make sure that you have specifically enabled it
# below.
#

#
# This should be changed to whatever you set DocumentRoot to.
#
<Directory C:\wamp\www\base>
    #
    # Possible values for the Options directive are "None", "All",
    # or any combination of:
    #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews
    #
    # Note that "MultiViews" must be named *explicitly* --- "Options All"
    # doesn't give it to you.
    #
    # The Options directive is both complicated and important.  Please see
    # http://httpd.apache.org/docs/2.2/mod/core.html#options
    # for more information.
    #
    Options Indexes FollowSymLinks

    #
    # AllowOverride controls what directives may be placed in .htaccess files.
    # It can be "All", "None", or any combination of the keywords:
    #   Options FileInfo AuthConfig Limit
    #
    AllowOverride all

    #
    # Controls who can get stuff from this server.
    #

#   onlineoffline tag - don't remove
    Options None
    AllowOverride all
    Order Deny,Allow
    Allow from all
    Allow from 127.0.0.1

</Directory> 
```

来自 apache 的错误日志：-

```
error] [client 127.0.0.1] client denied by server configuration: C:/wamp/www/base/category 
```

基本目录下的 .htaccess 文件

```
Options +Indexes
Options +FollowSymLinks 
RewriteEngine On
RewriteBase /base/
RewriteRule ^category /category.php 
```

在我没有进行 url 重写之前。如果我从基本目录中删除 .htaccess，那么它工作正常。那么任何人都可以帮助我启用 url 重写吗？

# c++ - Directx 11，将多个纹理发送到着色器

> ID：11668177
> 
> 赞同：8
> 
> 时间：2012-07-26T11:20:49.960
> 
> 标签：c++, shader, textures, directx-11

使用此代码，我可以将一个纹理发送到着色器：

```
 devcon->PSSetShaderResources(0, 1, &pTexture); 
```

当然，我通过以下方式制作了 pTexture：D3DX11CreateShaderResourceViewFromFile

着色器：Texture2D 纹理；

```
return color * Texture.Sample(ss, texcoord); 
```

我目前只向着色器发送一个纹理，但我想发送多个纹理，这怎么可能？

谢谢你。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-07-26T17:08:26.950

您可以使用多个纹理，只要它们的数量不超过您的着色器配置文件规范。这是一个示例： HLSL 代码：

```
Texture2D diffuseTexture : register(t0);
Texture2D anotherTexture : register(t1); 
```

C++ 代码：

```
devcon->V[P|D|G|C|H]SSetShaderResources(texture_index, 1, &texture); 
```

例如，对于上面的 HLSL 代码，它将是：

```
devcon->PSSetShaderResources(0, 1, &diffuseTextureSRV);
devcon->PSSetShaderResources(1, 1, &anotherTextureSRV); (SRV stands for Shader Texture View) 
```

或者：

```
ID3D11ShaderResourceView * textures[] = { diffuseTextureSRV, anotherTextureSRV};
devcon->PSSetShaderResources(0, 2, &textures); 
```

HLSL 名称可以是任意的，不必与任何特定名称相对应——只有索引很重要。而“注册（tXX）；” 声明不是必需的，我建议您使用它们以避免混淆哪个纹理对应于哪个插槽。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-26T11:27:52.170

通过使用[纹理数组](http://msdn.microsoft.com/en-us/library/windows/desktop/ff476906%28v=vs.85%29.aspx#Texture2D_Resource)。当您填写您[`D3D11_TEXTURE2D_DESC`](http://msdn.microsoft.com/en-us/library/windows/desktop/ff476253%28v=vs.85%29.aspx)的`ArraySize`会员时。这个 desc 结构是传递给[`ID3D11Device::CreateTexture2D`](http://msdn.microsoft.com/en-us/library/windows/desktop/ff476521%28v=vs.85%29.aspx). 然后在您的着色器中，您使用第三个 texcoord 采样索引，该索引指示您所指的数组中的哪个 2D 纹理。

***更新：***我刚刚意识到您可能正在谈论通过多次调用（即针对不同的地理位置）进行此操作，在这种情况下，您将更新着色器的纹理资源视图。如果您正在使用效果框架，您可以使用[ID3DX11EffectShaderResourceVariable::SetResource](http://msdn.microsoft.com/en-us/library/windows/desktop/ff476750%28v=vs.85%29.aspx)，或者使用`PSSetShaderResources`. 但是，如果您尝试在多个纹理之间进行混合，那么您应该使用纹理数组。

您可能还想研究 3D 纹理，它提供了一种通过 texcoord 中的第 3 个元素在数组中相邻纹理之间插值的自然方法（而 2D 数组会自动钳制到最接近的整数）。请参阅 HLSL`sample` [备注](http://msdn.microsoft.com/en-us/library/windows/desktop/bb509695%28v=vs.85%29.aspx)。

# iphone - 时间变化时重复 UILocalNotification 行为

> ID：11668184
> 
> 赞同：0
> 
> 时间：2012-07-26T11:21:24.740
> 
> 标签：iphone, objective-c, ios, cocoa, uilocalnotification

我正在设置一个重复的本地通知，以在下周二 10:00 触发，然后每周重复 (NSWeekCalendarUnit) 。我的问题是，当当地时间更改（每年 2 次）时，通知将在 11:00 或 9:00 点触发。原因是 NSWeekCalendarUnit 是以秒计算的（7 天/周*24 小时/天*60 秒/小时）。即使当地时间已更改，我也希望仅在 10:00 触发警报。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:09:32.697

你设置的`timeZone`属性`UILocalNotification`？从文档中：

> ...如果您为此属性分配一个有效的 NSTimeZone 对象，则触发日期将被解释为挂钟时间，当时区发生变化时会自动调整该时间；适合这种情况的一个例子是闹钟。

# magento - Magento 产品中的水印

> ID：11668186
> 
> 赞同：0
> 
> 时间：2012-07-26T11:21:32.997
> 
> 标签：magento

需要在每个magento产品中显示水印，这样任何人都无法复制产品图像。有什么建议我们可以在`view.phtml`页面和`list.phtml`页面上做什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:41:31.343

您可以通过管理后端设置水印图像。希望此链接对您有所帮助。 [http://www.magentocommerce.com/knowledge-base/entry/configuration-general-design-product-image-watermarks/](http://www.magentocommerce.com/knowledge-base/entry/configuration-general-design-product-image-watermarks/)

# apache - 如何配置虚拟主机以在 2 个目录和 1 个文件中查找请求？

> ID：11668187
> 
> 赞同：1
> 
> 时间：2012-07-26T11:21:33.883
> 
> 标签：apache, mod-rewrite, virtualhost

我想这样做，以便访问 domain.com/xyz 将签入 web/，如果它在 web/ 中不存在，那么它将签入 website/，如果它不存在于其中任何一个中，它将检查在 web/app.php 中

如何配置虚拟主机（使用 mod_rewrite）来执行此操作？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T19:37:33.270

尝试将其添加到您的虚拟主机配置中：

```
RewriteEngine On

# check if it exists in /web
RewriteCond %{DOCUMENT_ROOT}/web%{REQUEST_URI} -f [OR]
RewriteCond %{DOCUMENT_ROOT}/web%{REQUEST_URI} -d
# if exists, serve the file in /web
RewriteRule ^(.*)$ /web$1 [L]

# check if it exists in /website
RewriteCond %{DOCUMENT_ROOT}/website%{REQUEST_URI} -f [OR]
RewriteCond %{DOCUMENT_ROOT}/website%{REQUEST_URI} -d
# if exists, serve the file in /website
RewriteRule ^(.*)$ /website$1 [L]

# otherwise, route through app.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/web
RewriteRule ^(.*)$ /web/app.php/$1 [L] 
```

通过 app.php 的路由只是调用`/web/app.php`，它不会向脚本发送任何内容。

# php - 什么是不可变 htaccess 文件，如何创建一个？

> ID：11668188
> 
> 赞同：0
> 
> 时间：2012-07-26T11:21:38.277
> 
> 标签：php, .htaccess

什么是不可变 htaccess 文件？我读到它应该是来自/用于 php 文件的安全性。没完全看懂，怎么操作？以及如何创建一个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T11:30:12.317

不可变文件意味着您不能再删除或修改文件

在 unix 上设置不可变属性

```
 chattr +i .htaccess 
```

# vba - 数据结构的快照，VBA excel

> ID：11668189
> 
> 赞同：1
> 
> 时间：2012-07-26T11:21:47.080
> 
> 标签：vba, serialization, excel, error-handling, snapshot

> **可能重复：**
> [将所有 excel 插件模块导出到 .bas 文件的最快方法是什么？](https://stackoverflow.com/questions/11362404/whats-the-fastest-way-to-export-all-excel-add-in-modules-to-bas-files)

是否可以在 VBA Excel 中对所有使用的模块和数据结构进行快照并在一段时间后恢复它？

原因是崩溃后重现错误

添加。是的，本质上我想序列化类和类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T15:00:07.697

> 我觉得你想要的是将所有类序列化为 XML 文件？我知道这个函数存在于其他语言中，但 VBA 可能没有它。（我相信你可以强迫一些东西）——布拉德
> 
> @Brad，是的，确切地说，作为一种可能的方式——nikaan

假设 VBA 不存在此方法（尽管它可用于 VB.NET 或 VB 2005： http: [//support.microsoft.com/kb/315703](http://support.microsoft.com/kb/315703)），我可能会尝试进行模拟：编写状态使用 FSO 将每个对象/变量（所需的）复制到一个 txt 文件中。
不过，我不知道这对您的项目是否可行，而且我可能不喜欢为大量代码而高兴地这样做。

```
dim sFile               As string 
Dim FSO                 As FileSystemObject     
Dim FSOFile             As TextStream 

sFile = "U:/Log.txt"

Set FSO = New FileSystemObject
Set FSOFile = FSO.OpenTextFile(sFile, 2, True) 
FSOFile.writeline (<Descriptions+Property/variable value>) 
FSOFile.Close
set FSO = nothing 
```

根据您输入描述的程度（例如，包括用于成功实例化对象的布尔值等......），您可能能够看到屏幕后面发生的事情，直到您的应用程序崩溃......我不知道不知道这是否回答了您的问题，因为我有点怀疑您所指的“字段”（评论）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:32:05.240

作为 VBA 项目的所有者，您可以创建一个子例程来导出当前项目中的所有模块。此链接提供代码：

[http://edndoc.esri.com/arcobjects/9.0/Samples/Application_Framework/ExportVBACode.htm](http://edndoc.esri.com/arcobjects/9.0/Samples/Application_Framework/ExportVBACode.htm)

出于您描述的目的，我认为没有理由这样做。
就个人而言，我会使用像这样的蹩脚技巧：

选项显式

```
Sub Save_File()

Dim sCur_Path           As String
Dim sCopied_Path        As String

Application.DisplayAlerts = False
Application.ScreenUpdating = False

sCur_Path = ThisWorkbook.FullName
sCopied_Path = "U:/Copied_New.xlsm"

ThisWorkbook.SaveAs sCopied_Path
ThisWorkbook.SaveAs sCur_Path

End Sub 
```

# sql - SQL Server 将 varchar 字符串转换为 int

> ID：11668191
> 
> 赞同：0
> 
> 时间：2012-07-26T11:21:53.377
> 
> 标签：sql, sql-server, stored-procedures

大家好我有以下存储过程

```
SELECT DISTINCT QuestionId, AnswerId, COUNT(AnswerId) AS Cntr,
    (SELECT     COUNT(AnswerId) AS ttl
     FROM          QUserAnswers
     WHERE      (QuestionId = QUAM.QuestionId)) AS TtlCnt
FROM         QUserAnswers AS QUAM
WHERE     (QuestionId IN (@QuestionIdIn))
GROUP BY QuestionId, AnswerId
ORDER BY QuestionId 
```

`@QuestionIdI`我以格式传入' 但是，它在将 varchar 值转换为数据类型`1,2,3,4,5'`时抛出错误 Conversion failed 。`'1,2,3,4,5,6'``int`

谁能给我一些指导来解决它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:22:56.583

正如 Tim Schelter 在他提供的链接中所建议的那样：-

首先，您需要创建一个解析输入的函数

```
 CREATE FUNCTION inputParser (@list nvarchar(MAX))
 RETURNS @tbl TABLE (number int NOT NULL) AS
 BEGIN
 DECLARE @pos        int,
       @nextpos    int,
       @valuelen   int

 SELECT @pos = 0, @nextpos = 1

 WHILE @nextpos > 0
 BEGIN
  SELECT @nextpos = charindex(',', @list, @pos + 1)
  SELECT @valuelen = CASE WHEN @nextpos > 0
                          THEN @nextpos
                          ELSE len(@list) + 1
                     END - @pos - 1
  INSERT @tbl (number)
     VALUES (convert(int, substring(@list, @pos + 1, @valuelen)))
  SELECT @pos = @nextpos
 END
 RETURN
END 
```

然后在您的 SP 中使用该功能

```
 CREATE PROCEDURE usp_getQuestion
 @QuestionIdIn varchar(50) 
 AS
 Begin
 Select Distinct QuestionId, AnswerId, COUNT(AnswerId) AS Cntr,
    (SELECT     COUNT(AnswerId) AS ttl
      FROM   QUserAnswers
      WHERE      QuestionId = QUAM.QuestionId) as TtlCnt
 from QUserAnswers AS QUAM
 inner join inputParser (@QuestionIdIn) i ON QuaM.QuestionId = i.number
 GROUP BY QuestionId, AnswerId
 ORDER BY QuestionId
 End

EXEC usp_getQuestion '1, 2, 3, 4' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:44:23.570

尝试在此处应用此逻辑。

```
Declare @str varchar(100)='''1'',''2'',''3'',''4'',''5'''
select @str
DECLARE @s int = 1
select * from emp where CAST(@s as varchar) in ('1','2','3','4','5') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:26:31.523

代替

```
WHERE     (QuestionId IN (@QuestionIdIn)) 
```

利用

```
WHERE charindex(','+cast(@QuestionId as varchar(100))+',',','+@QuestionID+',')>0 
```

如果您担心性能，请使用拆分功能并与主表连接

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:56:04.987

尝试改变条件：

```
WHERE     (QuestionId IN (@QuestionIdIn)) 
```

至

```
where (','+@QuestionIdIn+',' like '%,'+convert(varchar(50),QuestionId)+',%') 
```

例如 @QuestionIdIn='1,2,3,4,5,6' 和 QuestionId=3 这意味着：

```
where (',1,2,3,4,5,6,' like '%,3,%') 
```

如果 3 在此列表中，则为真。

# sql-server - 在 SQLCMD for Linux 中使用变量

> ID：11668193
> 
> 赞同：11
> 
> 时间：2012-07-26T11:21:54.693
> 
> 标签：sql-server, linux, sqlcmd

我正在使用 Korn shell 的 Linux 机器（Red Hat Enterprise Server 5.3 tikanga）上运行适用于 Linux 的 Microsoft SQLCMD 工具（CTP 11.0.1720.0）。该工具已正确配置，并且在所有情况下都可以使用，但使用脚本变量时除外。

我有一个 SQL 脚本，看起来像这样。

```
SELECT COLUMN1 FROM TABLE WHERE COLUMN2 = '$(param1)'; 
```

我正在运行这样的`sqlcmd`命令。

```
sqlcmd -S server -d database -U user -P pass -i input.sql -v param1="DUMMYVALUE" 
```

当我执行上述命令时，我收到以下错误。

`Sqlcmd: 'param1=DUMMYVALUE': Invalid argument. Enter '-?' for help.`

帮助列出了以下语法。

`[-v var = "value"...]`

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2017-04-27T14:59:30.707

您不需要将变量传递给 sqlcmd。它会自动从您的 shell 变量中选择：例如

导出参数 1=DUMMYVALUE

`sqlcmd -S $host -U $user -P $pwd -d $db -i input.sql`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-26T14:35:01.557

在 RTP 版本（[11.0.1790.0](http://www.microsoft.com/en-gb/download/details.aspx?id=28160)）中，执行`-v`时开关不会出现在参数列表中`sqlcmd -?`。显然，该工具的 Linux 版本不支持此选项。
据我所知，从环境变量中导入参数值也不起作用。

如果您需要解决方法，一种方法是将一个或多个`:setvar`语句与包含要运行的命令的文本文件连接到一个新文件中，然后执行新文件。根据您的示例：

```
echo :setvar param1 DUMMYVALUE > param_input.sql
cat input.sql >> param_input.sql
sqlcmd -S server -d database -U user -P pass -i param_input.sql 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-05T21:52:01.323

你可以在linux中导出变量。之后，您将不需要将变量传递给`sqlcmd`. `:setvar`但是，我确实注意到如果没有默认值，您将需要更改您的 sql 脚本并删除该命令。

```
export dbName=xyz
sqlcmd -Uusername -Sservername -Ppassword -i script.sql

:setvar dbName  --remove this line
USE [$(dbName)]
GO 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-27T17:06:32.487

我认为您只是没有正确引用输入变量。我创建了这个 bash 脚本...

```
#!/bin/bash
# Create a sql file with a parameterized test script
echo "
set nocount on
select k = '-db', v = '\$(db)' union all
select k = '-schema', v = '\$(schema)' union all
select '-', 'static'
go" > ./test.sql

# capture input variables
DB=$1 
SCHEMA="${2:-dbo}"

# Exec sqlcmd
sqlcmd -S 'localhost\lemur' -E -i ./test.sql -v "db=${DB}" -v "schema=${SCHEMA}" 
```

...并像这样测试它：

```
$ ./test.sh master
k       v     
------- ------
-db     master
-schema dbo
-       static 
```

# javascript - 如何用新的div替换旧的div？

> ID：11668201
> 
> 赞同：0
> 
> 时间：2012-07-26T11:22:11.967
> 
> 标签：javascript, html

当倒计时达到 0 时，我想关闭并创建一个新的 div。我的 div 看起来像这样

```
<div id="bij2">Test
    <div id="bij2Blauw">
        <table width="98%" border="0" align="center" cellpadding="0" cellspacing="0">
            <tr>
                <td colspan="3" class="titel">Resterende tijd</td>
            </tr>
            <tr>
                <td height="25" colspan="3" align="center" valign="middle">
                    <input id="aktie2" type="text" class="countdownTekst" size="27" readonly="readonly">
                    <script language="javascript">
                        countdown(2012, 7, 29, 'aktie2', 'bij2')
                    </script>
                </td>
            </tr>
            <tr>
                <td height="60">
                    <input name="kopen1" type="submit" class="kopen" id="kopen1" value="Koop nu"
                    />
                </td>
                <td height="60" colspan="2" align="right" valign="bottom">
                    <span class="euro">&#8364;</span>
                    <span class="prijs">14,95</span>
                </td>
            </tr>
        </table>
    </div>
</div> 
```

这是倒计时

```
function countdown(yr, m, d, idCountdown, divId) {
    var theyear = yr;
    var themonth = m;
    var theday = d;
    var today = new Date();
    var todayy = today.getYear();
    if (todayy < 1000) todayy += 1900
    var todaym = today.getMonth();
    var todayd = today.getDate();
    var todayh = today.getHours();
    var todaymin = today.getMinutes();
    var todaysec = today.getSeconds();
    var todaystring = montharray[todaym] + " " + todayd + ", " + todayy + " " + todayh + ":" + todaymin + ":" + todaysec;
    var futurestring = montharray[m - 1] + " " + d + ", " + yr;
    var dd = Date.parse(futurestring) - Date.parse(todaystring);
    var dday = Math.floor(dd / (60 * 60 * 1000 * 24) * 1);
    var dhour = Math.floor((dd % (60 * 60 * 1000 * 24)) / (60 * 60 * 1000) * 1);
    var dmin = Math.floor(((dd % (60 * 60 * 1000 * 24)) % (60 * 60 * 1000)) / (60 * 1000) * 1);
    var dsec = Math.floor((((dd % (60 * 60 * 1000 * 24)) % (60 * 60 * 1000)) % (60 * 1000)) / 1000 * 1);
    var dag = "dagen";

    if (dday <= 0 && dhour <= 0 && dmin <= 0 && dsec <= 0) {
        document.getElementById(idCountdown).value = "voorbij";
        $(document.getElementById(divId)).fadeOut(2000);
        //removeElements(document.getElementById(divId));
        setTimeout("creatediv(document.getElementById(divId))", 3000);
        return;
    } else if (dday <= 1) {
        dag = 'dag';
    }
    document.getElementById(idCountdown).value = dday + ' ' + dag + ' ' + dhour + " uur " + dmin + " min " + dsec + " sec";
    setTimeout(function () {
        countdown(theyear, themonth, theday, idCountdown);
    }, 1000);
} 
```

因此，当时间结束时，它将使用 jQuery 淡出 div。然后我想创建一个新的div。我用这个：

```
function creatediv(id) {

    var newdiv = document.createElement('div');
    newdiv.setAttribute('id', id);
    newdiv.className = 'newclass';
    newdiv.style.float = "left";
    newdiv.innerHTML = "nothing";

    document.body.appendChild(newdiv);
    alert(id + 'gemaakt');
} 
```

但这会在页面底部创建一个 div，我希望在与淡出的 div 相同的位置创建一个新的 div。我需要改变什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T11:25:50.243

你试过`replaceWith`jQuery[吗](http://api.jquery.com/replaceWith/)？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T11:27:15.347

这真的很简单：

```
$('#bij2').replaceWith( newcontent ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:29:30.757

您的代码中根本没有使用 jQuery。您犯的错误是您没有替换节点，而是在其后追加新节点。您正在寻找的功能是`replaceChild`.

```
node.replaceChild(oldNode, newNode) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T11:29:31.630

如果你想用 div 3 替换 div 2

```
<div id="1"><div id = "2"></div></div> 
```

您可以使用

```
$("#1").html('<div id="3"></div>') 
```

或者你可以使用

```
$("#2").replaceWith('<div id="3"></div>') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-26T11:33:07.887

您说过“使用 jQuery”，但您似乎没有使用 jQuery。

如果你真的在使用/打算开始使用 jQuery，那么[Rahul 的答案](https://stackoverflow.com/a/11668257/157247)就是你想要的。

如果没有，那么您正在寻找[`parentNode`](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1060184317)、[`insertBefore`](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-952280727)和[`removeChild`](http://www.w3.org/TR/DOM-Level-2-Core/core.html#ID-1734834066)，例如：

```
// Assuming olddiv refers to the old div
var parent = olddiv.parentNode;
parent.insertBefore(newdiv, olddiv);
parent.removeChild(olddiv); 
```

这会将新 div 插入旧 div 之前，然后删除旧 div。

所以也许：

```
function replacediv(oldid, id) {

    var newdiv = document.createElement('div');
    newdiv.id = typeof id !== "undefined" ? id : oldid; // Use old ID if no new one specified
    newdiv.className = 'newclass';
    newdiv.style.float = "left";
    newdiv.innerHTML = "nothing";

    var olddiv = document.getElementById(oldid);
    var parent = olddiv.parentNode;
    parent.insertBefore(newdiv, olddiv);
    parent.removeChild(olddiv);
    alert(id + 'gemaakt');
} 
```

...然后用旧 ID 和新 ID 调用它。

附带说明：您不必使用`setAttribute`for `id`。它是元素实例上的反射属性。

# objective-c - 将属性内的结构包装到 NSValue

> ID：11668204
> 
> 赞同：1
> 
> 时间：2012-07-26T11:22:19.277
> 
> 标签：objective-c, struct

我使用 NSValue 来包装我定义的结构，但是当通过 @property 访问该结构时，我收到此错误：请求的属性表达式的地址。

这可以使用属性来完成，还是我首先将结构存储在变量中？

无效代码：

```
NSValue *previousTileObj = [NSValuevalue:&self.previousTile withObjCType:@encode(RobotTile)]; 
```

有效代码：

```
RobotTile localPreviousTile = self.previousTile;
NSValue *previousTileObj = [NSValuevalue:&localPreviousTile withObjCType:@encode(RobotTile)]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-21T10:05:17.563

您不能将调用结果的地址获取到对象属性的访问器。

这是因为该语句`self.previousTitle`只是 Objective-C 消息调用的语法糖`[self previousTitle]`，它的语义与函数调用的语义相似，因为结果值在内存中没有实际位置，因此它的地址不能由`&`运算符获取。

但是，您可以通过将访问器调用包装在 C 数组文字中来将结果欺骗为可寻址对象。由于数组本质上是指向其第一个元素的指针，因此这将导致指向所需数据的指针。

```
NSValue *previousTileObj = [NSValue value:(RobotTile []){self.previousTile} 
                             withObjCType:@encode(RobotTile)]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-31T09:09:55.723

您可以利用[键值编码中的结构支持](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/KeyValueCoding/Articles/DataTypes.html#//apple_ref/doc/uid/20002171-SW2)并执行以下操作：

```
NSValue *previousTileObj = [self valueForKey:@"previousTile"]; 
```

# java - Android ListView 在加载数据时冻结

> ID：11668206
> 
> 赞同：-1
> 
> 时间：2012-07-26T11:22:33.257
> 
> 标签：java, android, listview

我在我的应用程序中使用带有图像的自定义列表视图，并从 json url 加载所有数据。

我创建了一个 onscrolllistener()

当用户滚动到列表视图的底部时，它会自动在当前数据下方添加数据。

但是**当我的数据加载整个列表视图时，会冻结 2-3 秒。**

不知道怎么回事？？

这是我的 AsyncTask 代码

```
private class BackgroundLoadMore extends AsyncTask<Void, Void, Void> {

          @Override
            protected void onPreExecute() {
                // Showing progress dialog before sending http request

            }

        protected Void doInBackground(Void... unused) {
            runOnUiThread(new Runnable() {
                public void run() {

                    LoadData();

                            list.setOnScrollListener(new EndlessScrollListener());
                }
            });
            return (null);
        }

        protected void onPostExecute(Void unused) {
            // On completing background task
            // closing progress dialog etc,.

        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:24:01.043

您必须从主 UI 线程中的 url 获取 json 数据。这会阻止 UI 被系统更新，因此会冻结。使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)在后台执行此类网络任务。

`LoadData()`应该在后台线程中调用，即 asynctask 的 doInBackground()。您的调用 runOnUIThread 将其放回 UI 线程，并且您不想要。`runOnUIThread`从 asynctask中删除调用。

```
 protected Void doInBackground(Void... unused) {
        LoadData();

        return (null);
    }

   protected void onPostExecute(Void unused) {
        // On completing background task
        // closing progress dialog etc,.

        list.setOnScrollListener(new EndlessScrollListener());

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:37:57.647

搬出`LoadData();`_

```
runOnUiThread(new Runnable() {
    public void run() {}
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:24:37.707

您可能正在 UI 线程中加载数据。

由于从 Internet 加载 JSON 数据等操作很慢（通常为 0.5-10 秒），因此如果您在应用程序的主线程中执行此操作，则用户界面将在此时停止响应。您应该使用 Thread 或 AsyncTask 异步加载 JSON 数据，从而使 UI 线程可以自由响应用户输入（例如滚动列表）。

我的建议是您使用 AsyncTask 来加载数据。

以下是一些链接：

*   [异步任务文档](http://developer.android.com/reference/android/os/AsyncTask.html)
*   [异步任务示例](http://labs.makemachine.net/2010/05/android-asynctask-example/)
*   [请参阅此问题](https://stackoverflow.com/questions/9671546/asynctask-android-example)的已接受答案以查看实现

* * *

**编辑**

放入`list.setOnScrollListener(new EndlessScrollListener());`和`list.notifyDatasetChanged();`里面`onPostExcecute();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T11:29:39.000

doInBackground 正在工作线程中执行，但在其中您使用 runOnUiThread 来启动 UI therad 操作。

您必须在后台线程中从网络加载所有数据，然后在 postExecute 中更新您的列表视图

# chat - 最好的办公室聊天？

> ID：11668207
> 
> 赞同：0
> 
> 时间：2012-07-26T11:22:34.623
> 
> 标签：chat, irc

能够与同事（15 人）分享一些代码片段/随机的东西会很好。

我正在考虑建立一个办公室聊天，不知道您是否有任何系统可以推荐。

我可以为此使用专用服务器。

IRC是要走的路吗？还是有不同的技术？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:38:39.820

Openfire 服务器和 Pidgin 客户端可让您聊天和发送文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T22:09:04.410

IRC 可能是一种非常便宜的方法。几乎任何客户端都可以 XDCC 并将文件发送给其他用户，例如[XChat、chatzilla、pidgin、weechat、mIRC 等](http://en.wikipedia.org/wiki/Comparison_of_Internet_Relay_Chat_clients)。您还可以设置免费的服务器软件，例如 lightIRC、Unreal、Pjirc、Bahamut 等。

但我认为你真正想要的是项目[协作软件](http://en.wikipedia.org/wiki/List_of_collaborative_software)。这里有很多选择，有些是收费的，有些是作为服务托管的。

# ruby-on-rails - Rake 任务在开发中有效，但在生产中无效

> ID：11668208
> 
> 赞同：1
> 
> 时间：2012-07-26T11:22:36.753
> 
> 标签：ruby-on-rails, rake

我有一个 rake 任务，每隔几个小时就会更改主页上的数据。我已经对其进行了测试，它在开发中运行良好。但它在生产中不起作用。我必须做什么才能获得我想看到的变化？我应该添加一个重新启动服务器的命令吗？这会让服务器承认更改吗？有没有更聪明的方法来做到这一点？

耙子任务如下。它将由 heroku 的调度程序插件运行，因此它当前位于 lib/tasks/scheduler.rake 文件中。

```
desc 'changes the meta tags'
task :mixup_meta_tags => :environment do 
  regex = /@meta_tag/
  file = File.open('app/controllers/site_controller.rb', 'r')
  lines = []
  file.each_line do |line|
    (line =~ regex) ? (lines << replace_line(line)) : (lines << line)
  end
  file.close
  file = File.open('app/controllers/site_controller.rb', 'w')
  lines.each{|line| file.write line} 
  file.close
end

def replace_line(line)
  meta_tags = MetaTag.all.map { |tag| tag["tag"] }
  new_tag = meta_tags.sample(1)[0]
  line = "    @meta_tag = \"#{new_tag}\" \n" # added the newline
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:29:23.243

是的，在生产环境中对 Rails 应用程序的更改需要重新启动才能被服务器接收。为了让它即时工作，您可能想尝试这篇文章中提到的解决方案[为什么-does-code-need-to-be-reloaded-in-rails-3](https://stackoverflow.com/questions/5308970/why-does-code-need-to-be-reloaded-in-rails-3/5309126#5309126)

# php - 如果记录不存在，php mysql 获取最近的最新记录（基于日期时间）

> ID：11668210
> 
> 赞同：1
> 
> 时间：2012-07-26T11:22:53.197
> 
> 标签：php, mysql, datetime, select

试图让我的头脑，如果我选择一个记录`WHERE item_id='$item_id' AND date(datetime)='2012-06-25'`，如果该记录不存在，那么我想获得该日期之后最近的最新记录。如何在查询中实现这一点？

~~我现在能想到的唯一方法是，如果 num_of_rows 为 0，那么我在那天之前添加 3 天，然后再次搜索并获取`DESC datetime LIMIT 1`（如果有多行）。但谁知道我只需一个查询就可以做到。~~

该记录在一天内可能有多行。因此，如果特定日期没有记录，如何在给定相同 $item_id 的情况下获取下一个最近的可用数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:25:03.610

```
SELECT *
 FROM table
 WHERE field <= '2012-06-25'
 ORDER BY field DESC
 LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:26:48.643

这将带回最接近您在查询中输入的日期的项目。但是，它不会在之前或之后查找，只需找到与您输入的内容最接近的日期。

```
select 
     min(abs(DATEDIFF(date(datetime),'2012-06-25'))) as minDiff
    ,yourID
from table1 
group by yourID 
order by 1 asc; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:30:35.423

我认为这就是你要找的：

```
SELECT *
FROM my_table
WHERE datetime BETWEEN '2012-06-25 00:00:00' AND 
                       DATE_ADD('2012-06-25 00:00:00', INTERVAL 3 DAY)
ORDER BY datetime ASC
LIMIT 1; 
```

还可以在字段 datetime 上创建索引以获得更快的性能。

# android - 缺少 NotificationCompat.Builder addAction？

> ID：11668212
> 
> 赞同：9
> 
> 时间：2012-07-26T11:22:57.207
> 
> 标签：android, notifications

根据[官方文档](http://goo.gl/Qr8IO)，NotificationCompat.Builder 类应该有方法 addAction，但是我找不到它（我收到“NotificationCompat.Builder 类型的方法 addAction(int, String, null) 未定义”）

有没有人想出如何访问这个方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-23T12:27:17.767

缺少的方法已添加到 Android 支持库 r11。要将其添加到您的项目中，您必须：

1.  打开 Android SDK 管理器。向下滚动并找到 Extras/Android 支持库包。检查修订列，如果您的版本少于 11，则需要先更新您的 SDK。在 Eclipse 中，通过菜单 Help/Check for Updates 完成。

2.  安装 Android 支持库后，您必须手动将其复制到项目的 libs 文件夹中。罐子位于：

.

```
<your android sdk location>/extras/android/support/v13/android-support-v13.jar 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-14T07:42:05.693

与[修订版 10](http://developer.android.com/tools/extras/support-library.html)一样，添加了缺失的方法。请参阅[NotificationCompat.Builder](http://developer.android.com/reference/android/support/v4/app/NotificationCompat.Builder.html)文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-27T18:28:55.577

支持库的最新版本似乎是修订版 9。我提取了 jar 文件并四处寻找，它与 NotificationCompat 及其官方文档（声称已于 2012 年 7 月 26 日 18:49 更新）有很大不同嵌套类。

# c++ - 使用 C++ 旋转字符串

> ID：11668221
> 
> 赞同：1
> 
> 时间：2012-07-26T11:23:37.760
> 
> 标签：c++, string

> **可能重复：**
> [在 C++ 中旋转字符串？](https://stackoverflow.com/questions/789426/rotate-a-string-in-c)
> [如何旋转 std::string？](https://stackoverflow.com/questions/11674473/how-to-rotate-a-stdstring)

我正在用 C++ 制作一个适用于命令行输入的应用程序。我在命令行中输入一个字符串

```
 int main(int argc, char** argv)
    {
        if(argc != 2)
        {
             cerr << "Invalid number of CMD arguments" << endl;
             return 1;
        }

        string StringValue = argv[1];
        cout << StringValue << endl;
     } 
```

这个作品不错。现在我想循环字符串中的字符。示例：如果我输入单词“STATES”。

```
 ^STATES|
    |^STATES
    S|^STATE
    ES|^STAT
    TES|^STA
    ATES|^ST
    TETES|^S
    STATES|^ 
```

其中“^”是开始，“|” 结束。我该怎么做呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-26T11:24:56.277

使用`std::rotate` [http://www.cplusplus.com/reference/algorithm/rotate/](http://www.cplusplus.com/reference/algorithm/rotate/)

```
string foo = "abcdefg";
std::rotate(foo.begin(), foo.begin() + 3, foo.end());
cout << foo << endl; //prints defgabc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:46:59.233

如果你想自己实现...

```
int main() 
{
    string StringValue = "^STATES|";
    string aDoubleStr = StringValue;
    aDoubleStr.append(StringValue);
    for(int i = StringValue.length() - 1; i >= 0; i--)
    {
        string aNewStr = aDoubleStr.substr(i , StringValue.length());
        cout << aNewStr.c_str() << endl;
    }

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T13:12:06.487

我也更喜欢 Andrew 的解决方案，使用`std::rotate()`. 但由于 OP 在评论中要求其他解决方案，我想在这里“拖钓”一些其他想法。这不是很有效：

```
std::string value = "^STATES|";
size_t pos = 3;
value = value.substr(pos) + value.substr(0, pos); 
```

[另一个想法](https://stackoverflow.com/questions/1678707/how-to-rotate-the-given-string-to-left-or-right-in-c)可以追溯到 Doug McIlroy、Brian Kernighan 和 PJ Plauger 8see Jon Bentley：Programming Pearls，第 2 章）。双手并排，拇指朝同一个方向。（将一只手放在另一只手上方，手掌放在身体上可能更容易。）转动每只手，然后转动双手连接：

```
_|||| _||||   =>  ||||_ ||||_   =>  _|||| _|||| 
 \L /  \ R/       \L /  \ R/         \R /  \ L/ 
```

在 C++ 中：

```
std::string::iterator mid = value.begin() + pos;
std::reverse(value.begin(), mid);
std::reverse(mid, value.end());
std::reverse(value.begin(), value.end()); 
```

# sql - 连接表时的性能差异

> ID：11668229
> 
> 赞同：0
> 
> 时间：2012-07-26T11:24:02.210
> 
> 标签：sql, sql-server-2008, stored-procedures

我想加入`Account`AND`Sales`表。

表的主键`Account`：`id,YearCode,AgentId`

哪个查询**运行得更快**

查询 #1：

```
SELECT * 
FROM account A
     JOIN sales s on a.id = s.id
                     AND a.yearcode = s.yearcode
                     AND a.agentid = s.agentid
WHERE a.yearcode = 1
      AND a.agentid=56
      AND a.id=976 
```

查询 #2：

```
SELECT *
FROM Account A
     JOIN sales s on a.id=s.id
WHERE s.yearcode=1
      AND s.agentid=56
      AND a.yearcode=1
      AND a.agentid=56
      AND a.id=976 
```

查询 #3：

```
SELECT *
FROM account a, sales s
WHERE a.id=s.id
      AND a.yearcode=s.yearcode
      AND a.agentid=s.agentid
      AND a.agentid=56
      AND a.yearcode=1
      AND a.id=976 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:48:24.107

尝试这个：

```
SELECT * 
FROM account A
JOIN sales s on a.id = s.id AND a.yearcode = s.yearcode AND a.agentid = s.agentid
WHERE a.id =976 AND a.yearcode = 1 AND a.agentid=56 
```

# .net - 除了“set”和“get”之外的其他属性访问器？

> ID：11668234
> 
> 赞同：3
> 
> 时间：2012-07-26T11:24:36.783
> 
> 标签：.net, clr

我正在反思一种类型的属性，并想检查一个属性是否同时具有**公共**setter 和 getter。不幸的是，`PropertyInfo`'s `CanRead`and`CanWrite`并不表示可访问性级别。所以我转向了`PropertyInfo.GetAccessors()`其中有一个[有趣的描述](http://msdn.microsoft.com/en-us/library/ff3b842x.aspx)（强调我的）：

> 返回一个数组，其元素反映当前实例所反映的属性的公共 get、set 和**其他访问器。**

有哪些“其他访问者”？是否仅存在其他访问器的可能性，或者是否存在实际上具有比属性的简单设置/获取二重奏更多的 CLI 语言？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T11:30:53.637

实际上，只有一个 getter 和 setter。从技术上讲，IIRC CLI 规范（ECMA 335 第 1.8.11.3 节）不仅*限于*这些，因此其他一些语言可以自由添加其他含义，但实际上没有。

这显示在 table 中`II.17`，并使用`.other`IL 中的标题（注意它`.get`用于 getter、`.set`setter 和`.custom`属性）。

**编辑**

*特别*要注意规范中包含的示例：

```
 // the declaration of the property 
  .property int32 Count() { 
    .get instance int32 MyCount::get_Count() 
    .set instance void MyCount::set_Count(int32) 
    .other instance void MyCount::reset_Count() 
  } 
```

这*表明*“重置”是一种选择；然而，实际上这是通过反射模式处理的；因此对于：

```
public int Foo {get;set;} 
```

*约定*是的`public void ResetFoo()`重置方法`Foo`，但*编译器*不会将其处理为自定义访问器。

```
using System;
using System.ComponentModel;
public class MyType
{
    public int Foo { get; set; }
    public void ResetFoo() { Foo = 0; }

    static void Main()
    {
        var obj = new MyType {Foo = 123};
        TypeDescriptor.GetProperties(typeof(MyType))["Foo"].ResetValue(obj);
        Console.WriteLine(obj.Foo); // outputs: 0

        var accessors = typeof (MyType).GetProperty("Foo").GetAccessors();
        // writes get_Foo and set_Foo
        foreach(var acc in accessors) Console.WriteLine(acc.Name);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:30:27.863

[事件](http://msdn.microsoft.com/en-us/library/8627sbea%28v=vs.71%29.aspx#vclrfeventpgexample2)具有注册代表`add`的`remove`访问器（这就是`+=`被翻译成的内容）。

编辑：好的，它们与属性无关，但它们属于“其他访问器”的类别。`EventInfo`，有趣的是，只有方法`GetAddMethod`和`GetRemoveMethod`。此外，还有[`GetOtherMethod`](http://msdn.microsoft.com/en-us/library/7615ct5w.aspx)and `GetRaiseMethod`，但那是我不太了解的黑暗魔法......

# css - 用图标创建导航栏的正确方法是什么

> ID：11668237
> 
> 赞同：0
> 
> 时间：2012-07-26T03:04:01.833
> 
> 标签：css, navigation, sprite

如何在语义上标记图标+文本的导航栏，其中文本位于图标下方，图标是精灵。

还有两个条件：导航框的宽度不同，图标也应该作为链接（可点击）

具体例子是@www.emex.ru。

换句话说：一个人如何转换 `<ul>
<li>
<a><img width=32 height=32/><br/>Link1</a>
</li>
<li>
<a><img width=32 height=32/><br/>Link2</a>
</li>
</ul>`

到没有`<img>`元素的版本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T02:36:21.130

Twitter bootstrap 使用`<i>`标签来执行此操作。见他们的[例子](http://twitter.github.com/bootstrap/base-css.html#icons)。

所以是这样的：

```
<li>
  <a>
    <i class="icon-shoe"></i> 
    Shoe
  </a>
  <a>
    <i class="icon-balloon"></i> 
    Balloon
  </a>
</li> 
```

然后在你的 CSS 中：

```
[class^="icon-"], [class*=" icon-"] {
  display: inline-block;
  width: 32px;
  height: 32px;
  line-height: 32px;
}

.icon-shoe {
  background-image: url("path/to/shoe/icon.png") no-repeat;
}

.icon-balloon {
  background-image: url("path/to/balloon/icon.png") no-repeat;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T03:14:38.330

无序列表对于导航菜单很常见。您可以根据需要设置`ul`和`li`标记的间距并对齐每个链接。您应该在`li`标签上设置类或 ID 并设置背景图像位置。一个很好的例子是here

[http://praveenfrancis.com/tutorials/create-a-simple-menu-with-css-sprite/](http://praveenfrancis.com/tutorials/create-a-simple-menu-with-css-sprite/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-26T09:36:30.630

因为您将使用图像进行导航，所以添加`alt=""`标签很重要，这样谷歌就可以看到您的链接锚文本。

# c# - 如何在 MVC 3 中将 Div 绑定到模型上的属性

> ID：11668243
> 
> 赞同：2
> 
> 时间：2012-07-26T11:25:00.607
> 
> 标签：c#, asp.net-mvc-3, html, binding

我有一个以下视图模型，它将用于获取问题描述和重新创建问题的步骤。

```
public class IssueViewModel
{
   public string IssueDesc { get; set; }
   public string ReCreationSteps  { get; set; }
} 
```

看法

```
@using (Html.BeginForm())
{
  @Html.LabelFor(model => model.IssueDescription)   
  @Html.TextAreaFor(m=>m.IssueDescription)
  @Html.LabelFor(model => model.ReCreationSteps )   
     <div class="editable" id="ReCreationSteps " name="ReCreationSteps" contenteditable="true">
        <ol>
          <li></li>
        </ol>
     </div>
  <input value="Create" type="submit" />
} 
```

控制器

```
[HttpPost]
public ActionResult Create(IssueViewModel model)
{
   string html = model.Recreation;
   //<ol><li>Step:1 Enter the text</li><li>Step:2 Click the button <li></ol>
   Issue newIssue = model.ToIssue(); // here value will be splitted and add steps to table
   _issueRepository.AddIssue(Issue);
} 
```

我想给用户一个简单的控件来输入问题重新创建步骤。所以我最终将 div 元素的 contenteditable 属性设置为 true。

我已将 ReCreationSteps 绑定到 Div 元素，但它不起作用。提交表单后，我无法在 ReCreationSteps 属性中获取 DIV 的值/html。

任何人都可以帮助我或建议我其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T13:13:04.553

据我所知，您需要使用“ [AllowHtmlAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.allowhtmlattribute%28v=vs.98%29.aspx) ”来装饰您的模型并创建一个自定义扩展，以便正确保存您的信息。

**更新**

如果要创建扩展包装器，可以执行以下操作：

**扩展助手**

```
 public static class CustomExtensions {

    public static IDisposable Step<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> expression) {
        ModelMetadata metadata = ModelMetadata.FromLambdaExpression(expression, html.ViewData);
        TextWriter writer = html.ViewContext.Writer;
        writer.WriteLine("<div class=\"editable\" id=\"Raw_{0}\" name=\"Raw_{0}\">", metadata.PropertyName);
        var modelValue = metadata.Model == null ? "" : metadata.Model.ToString();
        writer.WriteLine(modelValue);
        writer.WriteLine("<input type=\"hidden\" id=\"{0}\" name=\"{0}\" value=\"{1}\"/>", metadata.PropertyName, html.Encode(modelValue));

        return new CreationSteps(html, metadata);
    }

        private class CreationSteps : IDisposable {

            #region | Properties |
            private readonly TextWriter writer;
            private bool disposed;
            private ModelMetadata _metadata;
            #endregion

            /// <summary>
            /// Initialize a new instance of <see cref="CreationSteps"/>
            /// </summary>
            /// <param name="html"></param>
            /// <param name="metadata"></param>
            public CreationSteps(HtmlHelper html, ModelMetadata metadata) {
                this._metadata = metadata;
                this.writer = html.ViewContext.Writer;
            }

            #region | Public Methods |
            public void Dispose() {
                if (disposed) return;
                disposed = true;
                writer.WriteLine("</div>");
            }
            #endregion

        }
    } 
```

**看法**

```
@using (@Html.Step(m => m.HtmlValues)) { 
    <p>Please fill in the above information.</p>
} 
```

**模拟数据**

< ol >< li >Step:1 输入文字：< input id="text1" class="hook-text-event" />< li >Step:2 点击按钮：< button id="button2" class= "hook-button-event" >我的按钮<li>

**JavaScript**

```
$(document).ready(function () {
    $(".hook-text-event").change(function () {
        console.log(this.id + " has been changed");
    });
    $(".hook-button-event").click(function () {
        console.log(this.id + " has been clicked");
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:50:25.023

如果您希望用户能够添加多个步骤（`<li>`每个步骤一个），那么您需要使用 JavaScript 来定义自定义表单。那是你的计划吗？

# c# - 如何从服务器端的客户端恢复 System.__ComObject 状态？

> ID：11668256
> 
> 赞同：1
> 
> 时间：2012-07-26T11:25:45.203
> 
> 标签：c#, wcf, com

我有带有 WCF 服务的客户端-服务器应用程序，我需要以某种状态从客户端向服务器发送 ComObject，呈现为 COM 接口。ComObject 不可序列化，因此我需要在服务器端创建一个新实例并恢复正确的状态。

**如何在客户端获取 ComObject 的这种状态并在服务器端创建接口实现实例？**

ComObject 的定义：

```
public class SyncSessionContext
{
  ...
  private CoreInterop.ISyncSessionState rawState;
  ...
} 
```

COM接口定义

```
internal static class CoreInterop
{
    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]           
    [Guid("b8a940fe-9f01-483b-9434-c37d361225d9")]
    [ComImport]
    public interface ISyncSessionState
    {
        [MethodImpl(MethodImplOptions.InternalCall | MethodImplOptions.PreserveSig, MethodCodeType = MethodCodeType.Runtime)]
        int GetInfoForChangeApplication([MarshalAs(UnmanagedType.LPArray), In, Out] byte[] ppbChangeApplierInfo, [In, Out] ref uint pcbChangeApplierInfo);

        ...other methods
    }
} 
```

我的客户端代码：

```
public override void BeginSession(SyncProviderPosition position, SyncSessionContext syncSessionContext)
{
    var field = typeof(SyncSessionContext).GetField("rawState", BindingFlags.Instance | BindingFlags.NonPublic);

    // Nonserializable correct instance
    var rawState = field.GetValue(syncSessionContext);

    //extract state...
    var state = ?????

    //calling wcf service       
    proxy.BeginSession(position, state);
} 
```

我的服务器端代码：

```
public void BeginSession(SyncProviderPosition position, object state)
{
    //initializing and restoring state        
    var rawState = ?????

    syncSessionContext = new SyncSessionContext(IdFormats(), null);
    var field = typeof(SyncSessionContext).GetField("rawState", BindingFlags.Instance | BindingFlags.NonPublic);
    field.SetValue(syncSessionContext, rawState);

    KnowledgeSyncProvider.BeginSession(position, syncSessionContext);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:10:20.773

一般来说，你不能，除非：

*   对象的 COM coclass 公开了一种对其状态进行序列化和反序列化的方法，例如 COM 接口 IPersistMemory 或 IPersistPropertyBag；或者
*   您对您的代码将处理的每个 COM coclass 的内部实现有深入的了解，从而允许您编写代码来“手动”序列化对象的基本状态。

这是因为持有 COM 接口指针不会告诉您任何关于暴露它的 COM 对象的内部状态。该状态甚至可能不在内存中。[也可以看看。](https://stackoverflow.com/a/4609422/502194)

# groovy - 查找两个列表之间的公共元素时出现堆栈溢出错误

> ID：11668258
> 
> 赞同：2
> 
> 时间：2012-07-26T11:25:53.207
> 
> 标签：groovy, stack-overflow

我有这个代码：

```
def input1 = ['a','b','e','r','t']
input2 = ['v','n','m','y']
ans = []

def common(def element,def i) {
  if (element == input2[i]) {
    ans << element
    return
  } else {
    common(element,++i)
  }
}  

for (i=0;i<input1.size();i++) {
  common(input1[i],0)
} 
```

这是产生堆栈溢出错误。为什么会这样？

### 编辑：

我正在尝试创建自己的方式来查找两个列表之间的共同元素。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:36:43.170

您永远不会检查是否`i`大于 的长度`input2`，并且在 Groovy 中，会超出 a 的`List`长度`null`

所以在第一个元素上，它将继续循环

```
if (element == input2[i]) { 
```

对于不断增加的 值，每次都`i`调用该函数，因为它永远不会匹配`common``a`

猜测你正在尝试做什么，这都可以重写为：

```
def input1 = ['a','b','e','r','t']
def input2 = ['v','n','m','y']
def ans = input1.intersect( input2 ) 
```

但是很难确定你想要什么，你也没有明确说出来。

### 编辑

避免堆栈溢出的一种深度递归方法是使用[Groovy 的蹦床方法](http://mrhaki.blogspot.co.uk/2011/04/groovy-goodness-recursion-with-closure.html)。

```
def common
common = { Object element, Collection list ->
  if( list.size() == 0 ) {                     // element not found.  Return null
    null
  }
  else if( list.head() == element ) {          // element found.  Return it
    element
  }
  else {
    common.trampoline( element, list.tail() )  // Trampoline down the list and check again
  }
}
common = common.trampoline()

def elements = ['a','b','e','v','r','t'].collect { // For each element in this list
                 common( it, ['v','n','m','y'] )   // Find if it's in our other list
               }.findAll()                         // And remove the nulls

assert elements == [ 'v' ] 
```

但是我仍然会`intersect`在这种情况下使用，上面只是展示了 Groovy 的一种方法，你可以避免太深的递归......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:38:09.847

问题是您的代码在到达数组 input2 的末尾时不会停止。如果元素不在 input2 中，那么它将永远进行递归调用**common(element,++i)**，这会导致堆栈溢出错误。

# php - 计算 2 个日期之间的小时数 - 不包括周末

> ID：11668259
> 
> 赞同：3
> 
> 时间：2012-07-26T11:25:59.040
> 
> 标签：php, datetime, date

使用此代码：[计算 PHP 中 2 个日期之间的小时数](https://stackoverflow.com/questions/3108591/calculate-number-of-hours-between-2-dates-in-php)我想计算 2 个时间戳之间的小时数。

我现在需要的是能够从这个计数中排除周末时间？

例如，对于以下 2 个时间戳，我希望小时数为 24 而不是 72。

```
$datetime1 = "2012-07-20 12:00:00";
$datetime2 = "2012-07-23 12:00:00"; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T11:36:49.617

下面的代码应该可以工作。我假设 $datetime1 总是小于 $datetime2。

```
$datetime1 = "2012-07-20 12:00:00"; 
$datetime2 = "2012-07-23 12:00:00";

$timestamp1 = strtotime($datetime1);
$timestamp2 = strtotime($datetime2);

$weekend = array(0, 6);

if(in_array(date("w", $timestamp1), $weekend) || in_array(date("w", $timestamp2), $weekend))
{
    //one of the dates is weekend, return 0?
    return 0;
}

$diff = $timestamp2 - $timestamp1;
$one_day = 60 * 60 * 24; //number of seconds in the day

if($diff < $one_day)
{
    return floor($diff / 3600);
}

$days_between = floor($diff / $one_day);
$remove_days  = 0;

for($i = 1; $i <= $days_between; $i++)
{
   $next_day = $timestamp1 + ($i * $one_day);
   if(in_array(date("w", $next_day), $weekend))
   {
      $remove_days++; 
   }
}

return floor(($diff - ($remove_days * $one_day)) / 3600); 
```

# c# - ASP.NET MVC - 如何根据登录的用户角色权限隐藏或显示链接/按钮？

> ID：11668261
> 
> 赞同：26
> 
> 时间：2012-07-26T11:26:05.533
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3

我正在使用 ASP.NET MVC4。

这是我的用户角色

```
1\. Administrator
2\. L1 Admin
3\. L2 Admin 
```

管理员组用户具有设置权限（用于添加、权限设置）。查看日志、错误报告等

如果用户是管理员组的成员，他只能看到与上述设置相关的菜单。

我有一个菜单表，有菜单详细信息。有一些功能，如删除、编辑，根据当前用户的角色显示，在顶部菜单中不可用。列出数据时，删除、编辑链接放置在表内。这也包括并且对于那种类型的 entry ， IsVisible 是错误的。

```
MenuID - MenuName - Controller - Action - ParentID - IsVisible 
```

我有一个 roleMenu 表，其中有分配给每个角色的菜单。

```
RoleID - MenuID 
```

如果管理员正在登录，他可以看到所有菜单。如果 L1Admin 正在登录，他只能看到分配给他的菜单。

我创建了一个用于身份验证的自定义属性，然后我查询数据库并根据 Contoller 和 Action（表 Menu 加入 RoleMenu）获取用户的权限。因此，如果用户尝试通过在浏览器中键入通过 URL 访问操作，我可以限制请求。

如果我以 L1Admin 身份输入，我只能看到列表页面，并且菜单已正确创建。在我用于列表的列表页面中。那么如何根据登录用户的权限隐藏编辑/详细信息链接。

```
 <div style="float: left">
        <table width="50%">
            <tr>
                <th>
                    @Html.DisplayNameFor(model => model.Name)
                </th>
                <th>
                </th>
            </tr>
            @foreach (var item in Model)
            {
                <tr>
                    <td style="width:30%;">
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td style="width:20%;">
// I need to hide EDIT/DELETE based on the permission setting of Current logged in user.
                        @Html.ActionLink("Edit", "Edit", new { id = item.ID }) | 
                        <a href="Server/@item.ID">Details</a> |
                        @Html.ActionLink("Delete", "Delete", new { id = item.ID })
                    </td>
                </tr>
            }
        </table>
    </div> 
```

提前致谢。

**编辑**

我将权限详细信息存储在数据库中。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-07-26T11:39:35.620

例如，您可以通过以下方式执行此操作：

```
@if (ViewContext.HttpContext.User.IsInRole("Your role"))
{
    // Do something here
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-07-26T11:49:41.953

**选项 1** - 考虑到您正在使用 asp .net 会员资格。

```
@if (Roles.IsUserInRole("Administrator"))
{ 
  //show link 
}
else
{
  //hide link/button
} 
```

**选项 2** - 在 userData 中指定角色，以防您自己创建**AuthCookie**，然后在 Global.asax.cs 文件的 Application_PostAuthenticateRequest 方法上将 HttpContext.Current.User 设置为新的 GenericPrinciple（从 authcookie 的用户数据中获取用户角色） - 将实现保留在你去谷歌。

这应该稍后工作

```
System.Web.HttpContext.Current.User.IsInRole("RoleName"); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-22T15:13:12.583

由于将权限详细信息存储在数据库中，您可以通过以下方式检查权限

`Option 1` **创建授权操作链接扩展**。[演示](http://vivien-chevallier.com/Articles/create-an-authorized-action-link-extension-for-aspnet-mvc-3)

创建一个自定义 html Authorized ActionLink 并调用如下

```
 <ul id="menu">              
    <li><%: Html.ActionLink("Home", "Index", "Home")%></li>
    <li><%: Html.ActionLink("About", "About", "Home")%></li>

    // Next line What you are looking for
    <li><%: Html.ActionLinkAuthorized("The Privilege Zone", "ThePrivilegeZone", "Home", true)%></li>
</ul> 
```

注意：为了更好的安全性，您需要一个自定义操作过滤器来检查所有请求是否已授权。

`Option 2` **创建一个静态函数并在操作链接之前检查**

```
public static bool IsUserInRole(string rolenamefrom session)
{
    // Check the user have the privilege then return true/false
}

@if (IsUserInRole("Administrator"))
{ //show link }
else
{//hide link/button} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-07-26T11:42:43.653

制作一个像这样的自定义帮助程序扩展，其中 CustomMethodForRetrievingUserFlag() 返回用户权限，CustomMethodForRetrievingFlags 返回例如操作的允许权限。祝你好运。

视图用法：@Url.CustomUrl("Home", "Index")

```
[Flags]
public enum AuthorizeFlags
{
    Administrator = 1,
    L1 = 2,
    L2 = 4
}

public static class UrlHelperExtensions
{
    public static MvcHtmlString CustomUrl(this UrlHelper urlHelper, string controllerName, string actionName, object routeValues = null)
    {
        var actionFlag = CustomMethodForRetrievingFlags(actionName);
        var userFlag = CustomMethodForRetrievingUserFlag();

        if ((actionFlag & userFlag) == userFlag)
        {
            return new MvcHtmlString(urlHelper.Action(actionName, controllerName, routeValues));
        }

        return new MvcHtmlString(String.Empty);
    }

    private static AuthorizeFlags CustomMethodForRetrievingUserFlag()
    {
        return AuthorizeFlags.L2;
    }

    private static AuthorizeFlags CustomMethodForRetrievingFlags(string actionName)
    {
        return (AuthorizeFlags.Administrator | AuthorizeFlags.L1); // test stub
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-06-29T09:12:49.430

```
@if (User.Identity.IsAuthenticated)// check whether the user is authenticated or not
    {
        if (User.IsInRole("HR"))//Check wether the user is in that role
        {
            //Contents to be displayed for that Role!
            //some sample content which will be displayed to the user of a Role HR
            <div>
                <h5><strong>HR Approval</strong></h5>
            </div>
            <div>
                <button type="button" name="btnApprove" id="btnApprove">Approve</button>
                <button type="button" name="btnReject" id="btnReject">Reject</button>
            </div>
            <br />
        }
    } 
```

# jsf-1.2 - JSF 1.2：h:graphicImage 附加 jsessionid

> ID：11668265
> 
> 赞同：5
> 
> 时间：2012-07-26T11:26:36.283
> 
> 标签：jsf-1.2

我正在使用 JSF 1.2

我有一张应该可以点击的图片。以下是我的编码方式，

```
<h:commandLink value="" action="#{myBean.myMethod}>
   <h:graphicImage value="image-location-in-webserver" />
</h:commandLink> 
```

正在使用`h:commandLink`，因为单击此图像时我必须进行一些业务验证，因此我需要在 bean 中调用一个方法。

我的 bean 是`session`作用域的。由于其他一些问题，我无法使用请求范围。

我尝试`javax.faces.STATE_SAVING_METHOD`将其设置为客户端而不是服务器。

即使这样，当我的页面被渲染时，图像也不会被重新渲染，因为当在 Web 开发人员中查看时，jsessionid 会被附加到如下所示的 url。

```
http:/myDomail/static-files/images/myImage.jpg;jsessionid=77F2A5D24CF1D5C3C4882778BC521263.node1 
```

如果没有附加 jsessionid，我的图像就会被渲染。

我怎样才能做到这一点？

# javascript - 单独突出显示字母，否则还原

> ID：11668272
> 
> 赞同：1
> 
> 时间：2012-07-26T11:27:06.997
> 
> 标签：javascript, jquery, jquery-ui, drag

在我的文字游戏中，我有一种风格，可以向用户显示要将字母拖放到哪个单词上以完成。

然后它允许用户将字母放入该区域，但不限制用户将字母放在我需要的任何其他地方，因此用户只能将第一个字母放入样式区域的第一个单元格。

这是通过单击按钮（#picknext）将样式应用于给定单词的代码...

```
$('#pickNext').click(function() {
// remove the class from all td's
$('td').removeClass('spellword');
// pick a random word
rndWord = shuffledWords.sort(function() {
    return 0.8 - Math.random();
})[0];
// apply class to all cells containing a letter from that word
$('td[data-word="' + rndWord + '"]').addClass('spellword');
}); 
```

理想情况下，如果字母没有放在正确的位置，我希望它们恢复原状。

我有一些额外的代码，我已经在字母上申请了恢复功能，希望它有帮助......

```
$('.drag').draggable({

helper: 'clone',
snap: '.drop',
grid: [60, 60],
revert: function(droppable) {
    if (droppable === false) {
        return true;
    }

    else {

        return false;
    }
}
}); 
```

# objective-c - 导航后相机叠加层保持关闭

> ID：11668273
> 
> 赞同：0
> 
> 时间：2012-07-26T11:27:09.330
> 
> 标签：objective-c, ios

我正在使用具有三个屏幕的应用程序。

首先是主屏幕。从带有按钮的主屏幕，用户导航到第二个屏幕，我有一个相机覆盖，只有一个按钮可以拍照。

当用户拍照时，他可以按下导航到最后一个屏幕的按钮。但是，当他从最后一个屏幕导航到主屏幕，然后转到覆盖的第二个屏幕时，相机就关闭了。按钮显示他可以拍照，但他无法通过相机看到。

我在主屏幕上使用以下代码来启动覆盖：

```
if (self.imageView.isAnimating)
    self.imageView.stopAnimating;

if ([UIImagePickerController isSourceTypeAvailable:sourceType])
{
    [self.overlayViewController setupImagePicker:sourceType];
    [self presentModalViewController:self.overlayViewController.imagePickerController animated:YES];
} 
```

`overlayviewcontroller`第二个屏幕在哪里`overlayviewcontroller`，代码如下：

```
- (void)setupImagePicker:(UIImagePickerControllerSourceType)sourceType
{
    self.imagePickerController.sourceType = sourceType;

    if (sourceType == UIImagePickerControllerSourceTypeCamera)
    {
        self.imagePickerController.showsCameraControls = NO;

        if ([[self.imagePickerController.cameraOverlayView subviews] count] == 0)
        {
            CGRect overlayViewFrame = self.imagePickerController.cameraOverlayView.frame;
            CGRect newFrame = CGRectMake(0.0,
                                         CGRectGetHeight(overlayViewFrame) - self.view.frame.size.height - 10.0,
                                         CGRectGetWidth(overlayViewFrame),
                                         self.view.frame.size.height + 10.0);
            self.view.frame = newFrame;
            [self.imagePickerController.cameraOverlayView addSubview:self.view];
        }
    }
} 
```

我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:41:09.710

我也面临同样的问题，我找到了一个解决方案。

我的解决方案如下

```
[self performSelector:@selector(setCameraOverlayView) withObject:Nil afterDelay:2]; 
```

而不是直接放入下面的行

```
[self.imagePickerController.cameraOverlayView addSubview:self.view]; 
```

in`overlayViewController`的上述方法

并将该行放在选择器方法`setCameraOverlayView`中。

就像下面

```
-(void)setCameraOverlayView
{
    [imagePickerController.cameraOverlayView addSubview:self.view];
} 
```

这将解决您的问题

快乐编码:)

**编辑**

要初始化覆盖，我使用下面的代码，并且覆盖中的 init 函数也被修改

**初始化覆盖**

```
self.overlayViewController = [[OverlayViewController alloc] initWithNibName:@"OverlayViewController" bundle:nil images:self.finalData]; 
```

**overlay中的init函数**

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil images:(NSArray *)imgArray
{
    if ((self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]))
    {
        subCategories = imgArray;
        imagePickerController = [[UIImagePickerController alloc] init];
        imagePickerController.delegate = self;
        imagePickerController.navigationBarHidden = YES;
    }
    return self;
} 
```

该数组不是必需的或不需要的，它是一些额外的信息，我需要使用覆盖做更多的事情，你可以省略它。

快乐编码:)

# php - 将图像中的人脸与 PHP 中的图像列表进行比较

> ID：11668278
> 
> 赞同：1
> 
> 时间：2012-07-26T11:27:29.363
> 
> 标签：php, artificial-intelligence, computer-vision, face-recognition

我正在创建一个应用程序，它的主要功能是，用户可以输入包含人脸的图像。使用该输入图像，我需要检查（比较）输入图像是否与我拥有的图像列表匹配。我的意思是输入图像中的人脸，该列表可能包含更多 100000 张图像。

我们如何在 PHP 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:34:37.487

[OpenCV 确实面临重新定位](http://docs.opencv.org/trunk/modules/contrib/doc/facerec/facerec_tutorial.html)。您可以直接从 PHP 调用 OpenCV，也可以尝试使用[OpenCV for PHP 项目](https://github.com/mgdm/OpenCV-for-PHP)。

关于这个问题还有一长串其他人脸识别库：[人脸识别库](https://stackoverflow.com/questions/953714/face-recognition-library)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:31:03.160

尽管实际上可以在 php 中执行此操作，但该语言对于该问题肯定是一个糟糕的选择。您可能真正在寻找的是：

1.) 一些可以识别图像相似性的模式匹配软件。由于这涉及图形处理，因此此类软件通常不是用 php 之类的脚本语言编写的，而是用 c 或 c++ 之类的更高效的语言编写的。

2.）一些控制人脸识别的原始php代码，比较在另一个进程中运行。

# tomcat - TomCat 延迟存储日志

> ID：11668280
> 
> 赞同：0
> 
> 时间：2012-07-26T11:27:39.703
> 
> 标签：tomcat, logging, jenkins, delay

从周一开始，我一直致力于设置 CI 服务器 Jenkins。今天我注意到，今天的 catalina.YYYY-MM-DD.log 和 tomcat6-stderr.YYYY-MM-DD.log 等文件不包含我在浏览器中看到的一些错误和堆栈跟踪。这很奇怪，但昨天的消息和堆栈跟踪都在那里。有人知道这种延迟吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:41:48.817

尝试“localhost.YYYY-MM-DD.log”，您可以在此文件中找到大多数错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T17:42:21.720

你看过 catalina.log 和 tomcat6-stderr.log 吗？我们的配置不会在日志中添加日期戳，直到日志系统在午夜滚动它们（DailyFileAppender 或类似的东西）。

# jquery - jQM：列表视图作为表单？

> ID：11668281
> 
> 赞同：0
> 
> 时间：2012-07-26T11:27:48.230
> 
> 标签：jquery, jquery-mobile

有谁知道是否可以使用 listview 作为表单？现在我的清单是这样的：

```
<form>
 <ul>
  <li name="answer" value=1 onClick="func()"><a name="answer" id=1 onClick="func()">Answer 1</a></li>
  <li name="answer" value=2 onClick="func()"><a name="answer" id=2 onClick="func()">Answer 2</a></li>
  ...
 </ul>
</form> 
```

或者任何人对可选解决方案都有一个好主意，最好是看起来像列表视图的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:40:35.607

看到这个： http: [//jquerymobile.com/demos/1.1.1/docs/lists/lists-forms.html](http://jquerymobile.com/demos/1.1.1/docs/lists/lists-forms.html) 和这个：http: [//jquerymobile.com/demos/1.1.1/docs/lists/lists-forms -inset.html](http://jquerymobile.com/demos/1.1.1/docs/lists/lists-forms-inset.html)

# c# - 日期时间 asp mvc 4 剃须刀

> ID：11668283
> 
> 赞同：1
> 
> 时间：2012-07-26T11:27:53.910
> 
> 标签：c#, asp.net-mvc-3, datetime, razor

正如你在这里看到的，我有一个日期编辑器。问题是，当我运行我的应用程序并尝试填写日期字段时，我无法选择日期`> 12`（我试图颠倒日期和月份的位置，但没有用）。我该如何解决这个问题？

```
<div class="editor-label">
    <label>Date de fin :</label>
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.date_fin)
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:39:01.083

您的服务器有不同的语言环境来解析您输入的信息。您可能需要考虑分离您的日/月/年字段或增强用户界面。

看看这个例子：[http ://www.nickharris.net/2010/08/asp-net-mvc-editor-template-for-jquery-datepicker/](http://www.nickharris.net/2010/08/asp-net-mvc-editor-template-for-jquery-datepicker/)

编辑：要弄清楚您所处的文化/地区，请在某处写下：`System.Globalization.CultureInfo.CurrentCulture.Name`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:03:16.690

将它放在您的 web.config 文件中，并将“da-DK”替换为您的应用程序应该运行的 CultureInfo（国家/语言）的 ID：

```
 <system.web>
        <globalization culture="da-DK" uiCulture="da-DK"/> 
```

# android - 在android中使用“/proc/mounts”有什么限制吗

> ID：11668284
> 
> 赞同：6
> 
> 时间：2012-07-26T11:28:00.167
> 
> 标签：android, filesystems, storage

我在使用具有外部存储（SD 卡）和内部数据存储的设备时遇到问题。与三星 S3 设备一样，有两种外部存储设备，即 SD 卡和内部数据存储设备。API两者`Environment.getExternalStorageDirectory()`都没有，我搜索了互联网并发现我可以阅读`/proc/mounts`类似的问题

[如何获取安卓设备的所有挂载点信息？](https://stackoverflow.com/questions/6824463/how-to-get-all-the-mount-point-information-for-android-device)

我的问题是我可以依赖`/proc/mounts`所有设备和操作系统上的文件系统还是有任何限制？有没有关于这个文件系统的好文档？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T14:44:03.880

看`/proc/self/mountinfo`；它包含所有信息`/proc/mounts`以及更多信息（例如，对于绑定挂载，它会告诉您源文件系统中的挂载路径）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T23:05:12.377

/proc 是 Linux 虚拟文件系统的挂载点，`procfs`. 它特定于 Linux，因此适用于所有 Android 安装。

procfs 最好的文档是它的源代码，但它需要对 Linux 内核和 C 有一定的了解。另请参阅内核源代码中的[Documentation/filesystems/proc.txt](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=blob;f=Documentation/filesystems/proc.txt;h=fb0a6aeb936c86237fe19bcdf630339fc43ad348;hb=HEAD)，它可能包含相关信息。

# php - 如何使用本地安装的我自己的电子邮件服务器发送电子邮件

> ID：11668292
> 
> 赞同：0
> 
> 时间：2012-07-26T11:28:28.247
> 
> 标签：php, email, configuration, iis-6, mail-server

我已经在安装 php（和 wordpress）的同一台服务器上安装了启用邮件的专业副本，并且我想在人们输入电子邮件表单等时使用邮件服务器。

我从查看简单的电子邮件脚本开始，但它们都失败了，我已经在谷歌上搜索了至少 8-9 个小时，用于使用 sendmail 的脚本、使用 gmail 的脚本以及几乎所有需要 PEAR 或其他一些解决方案的许多选项的不同解决方案- 在我开始沮丧地扯头发之前，我已经认输了。

所以现在我想选择这个选项，因为它对我来说更简单，而且我已经拥有启用邮件的许可证。

我怎样才能做到这一点？

我有可用的最新版本的 php... 服务器是安装了 IIS 6 和 MySQL 服务器/wordpress 的 Windows 服务器 2003 ENT。

我不是程序员——只是一个“普通”的人。我知道在大多数情况下都要使用计算机——但编码对我来说就像希腊语！（在这种情况下，这可能是我的致命弱点）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:38:43.107

尝试使用 PHPMailer 或 SwiftMailer。

这些库使配置您的邮件服务器以发送电子邮件变得微不足道。

Mailenable 应该为您提供 smtp 服务器和凭据。

这是 phpmailer 的示例： [http://phpmailer.worxware.com/index.php?pg=examplebsmtp](http://phpmailer.worxware.com/index.php?pg=examplebsmtp)

# java - 更改 JTable 关键操作的行为

> ID：11668294
> 
> 赞同：2
> 
> 时间：2012-07-26T11:28:31.400
> 
> 标签：java, swing, jtable

我有一个`JTable`可编辑的单元格。当我单击一个单元格时，它会进入编辑模式；当我使用方向箭头在单元格中移动时也会发生同样的情况。现在我想选择单元格而不是开始编辑，并且只有在`Enter`按下键时才编辑单元格。

如果需要任何其他信息，请直接询问。

编辑：`Enter`键操作

```
class EnterAction extends AbstractAction {

    @Override
    public void actionPerformed(ActionEvent e) {
        JTable tbl = (JTable) e.getSource();
        tbl.editCellAt(tbl.getSelectedRow(), tbl.getSelectedColumn());
        if (tbl.getEditorComponent() != null) {
            tbl.getEditorComponent().requestFocus();
        }
    }
} 
```

现在这是左箭头动作，其余 3 个不难从这个中推断出来：

```
class LeftAction extends AbstractAction {
    @Override
    public void actionPerformed(ActionEvent e) {
        JTable tbl = (JTable)e.getSource();
        tbl.requestFocus();
        tbl.changeSelection(tbl.getSelectedRow(), tbl.getSelectedColumn() > 0 ? tbl.getSelectedColumn()-1:tbl.getSelectedColumn(), false, false);
        if(tbl.getCellEditor()!=null)
            tbl.getCellEditor().stopCellEditing();
    }
} 
```

这就是您绑定此操作的方式：

```
final String solve = "Solve";
            KeyStroke enter = KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0);
            table.getInputMap(JTable.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(enter, solve);
            table.getActionMap().put(solve, new EnterAction());
final String sel = "Sel";
            KeyStroke arrow = KeyStroke.getKeyStroke(KeyEvent.VK_LEFT, 0);
            table.getInputMap(JTable.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(arrow, sel);
            table.getActionMap().put(sel, new LeftAction()); 
```

哦，我差点忘了，在鼠标单击时选择单元格而不是编辑：

```
public static MouseListener mAdapterTable = new MouseListener()
{
    @Override
    public void mousePressed(MouseEvent e)
    {
        JTable tbl=((JTable)e.getComponent());
        if(tbl.isEditing())
        {
            tbl.getCellEditor().stopCellEditing();
        }
    }

    @Override
    public void mouseClicked(MouseEvent e) {
        JTable tbl=((JTable)e.getComponent());
        if(tbl.isEditing() )
            tbl.getCellEditor().stopCellEditing();
    }

    @Override
    public void mouseReleased(MouseEvent e) {
        JTable tbl=((JTable)e.getComponent());
        if(tbl.isEditing() )
            tbl.getCellEditor().stopCellEditing();
    }
}; 
```

`EventListner`必须像这样添加到表中：

```
table.addMouseListener(mAdapterTable); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T23:39:09.153

为此使用[*键绑定*](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。大多数 Look & Feel 实现已经绑定`F2`到表的`startEditing`操作，但是您添加了不同的绑定：

```
tree.getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "startEditing"); 
```

这将有效地替换先前绑定`Enter`到表的`selectNextRowCell`操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:50:02.110

这是我要做的：

*   首先为 JTable 启用单个单元格选择
*   为 JTable 或 JPanel 创建一个 KeyAdapter 或 KeyListener，其中包含您的表。
*   在 KeyAdapter 的 keyPressed() 方法中进入所选单元格的编辑模式，如下所示： [http ://www.exampledepot.com/egs/javax.swing.table/StopEdit.html](http://www.exampledepot.com/egs/javax.swing.table/StopEdit.html)

如果用户按下右键进行编辑，您可以检查 keyPressed() 方法。我不确定，如果在您的表格中禁用了正常（双击）编辑，那么会发生什么，如果您尝试以编程方式对其进行编辑，但如果它不起作用，那么您可以在所选单元格上启用编辑，当用户按下编辑按钮时，当他/她完成时，再次禁用它。

# asp.net - 将图像从后面的代码嵌入到 aspx 页面

> ID：11668299
> 
> 赞同：0
> 
> 时间：2012-07-26T11:28:42.980
> 
> 标签：asp.net

在我的用户从组合中选择一些值之后，我以编程方式（服务器端）创建一个`Image`对象。

我想在运行时将此图像重新嵌入到 aspx 页面中，而不是将其保存到磁盘或数据库中。

那么我该怎么做呢？我尝试使用内存流，并使用响应对象发送图像，但我只看到了图像 - 它覆盖了整个页面。

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:33:50.850

创建[处理](http://support.microsoft.com/kb/308001)程序并通过以下方式[请求](http://msdn.microsoft.com/en-us/library/bb398986.aspx)它：

```
<img src="Image.ashx?ID=myImageId" alt="text here"/>

<asp:Image runat="server" ImageUrl="~/Image.ashx?ID=myImageId" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:30:39.743

做这样的事情

```
<img src="yourimagegeneratingpage.aspx?query=value" /> 
```

加载此图像时，它将生成对您的页面 (yourimagegeneratingpage.aspx) 的请求，并且该页面将响应该`img`控件将显示的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:35:58.113

您可以对数据进行 base64 编码并将其写入图像数据。

像这样：

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO
9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot"> 
```

为此，您必须自己渲染 img 标签。

这样您就不必将图像写入服务器上的文件。它从内存直接发送到客户端浏览器。

参考：[数据 URI 方案](http://en.wikipedia.org/wiki/Data_URI_scheme)

*请注意，这不适用于 IE6。*

# android - android从对话框按钮单击打开键盘

> ID：11668300
> 
> 赞同：1
> 
> 时间：2012-07-26T11:28:42.820
> 
> 标签：android, dialog, keyboard

我有一个打开对话框的表单（包括列表视图和一个按钮），如果单击按钮，对话框应该消失并且键盘应该显示在表单上

我做不到。有什么想法吗？

感谢帮助！

我的代码是：

```
final Dialog dialog = new Dialog(context);
                 dialog.setContentView(R.layout.dialog_list_layout);
                 dialog.setCancelable(true);

                 final ListView listviewDialog = (ListView) dialog.findViewById(R.id.listViewDialog);
                 DialogListAdapter adapter = new DialogListAdapter(context, R.id.textViewItem, List);
                 listviewDialog.setAdapter(adapter);

        ((Button) dialog.findViewById(R.id.button)).setOnClickListener(new View.OnClickListener() {

                            public void onClick(View v) {                   
                                editText.setText("");

                                dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_VISIBLE);
                                ((EditText) findViewById(R.id.editText)).requestFocus();
                                InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
                                imm.showSoftInput(((EditText) findViewById(R.id.editTextAddress)), InputMethodManager.SHOW_IMPLICIT);

                                dialog.dismiss();       
                            }
                        });
                         dialog.show(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:40:27.603

只需创建一个对话框，然后单击其按钮，为 inputmanager 编写代码

```
 AlertDialog.Builder builder = new AlertDialog.Builder(this);
            builder.setMessage(str1);
            builder.setCancelable(false);
            builder.setTitle("Status");
            builder.setPositiveButton("OK", new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int id) 
                 {

                    dialog.dismiss();
                   InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
                   imm.toggleSoftInput(InputMethodManager.SHOW_FORCED,0);

                }
            });
            AlertDialog alert = builder.create();
            alert.show(); 
```

查看我更新的答案

**更新**

除了我的回答，看看这[是否可以在对话框中创建列表视图？](https://stackoverflow.com/questions/2874191/is-it-possible-to-create-listview-inside-dialog) 和 [AlertDialog 中的 ListView](https://stackoverflow.com/questions/2397106/listview-in-alertdialog)

# android - 无法获取好友列表 Xmpp

> ID：11668301
> 
> 赞同：0
> 
> 时间：2012-07-26T11:28:53.220
> 
> 标签：android, xmpp

```
public boolean connect() {
    String host = "talk.google.com";
    String port = "5222";
    String service = "gmail.com";

    ConnectionConfiguration connConfig = new ConnectionConfiguration(host,
            Integer.parseInt(port), service);
    connection = new XMPPConnection(connConfig);

    try {
        connection.connect();
        log("xmpp connected");
        connection.login("USERNAME@gmail.com", "Password");
        log("user loged in");
        log("loged user : " + connection.getUser());
    } catch (XMPPException e) {
        e.printStackTrace();
        return false;
    }
    return true;
}

public void displayBuddyList() {
    String user;
    String status_Message; 
    int state;
    Roster roster = connection.getRoster();
    Collection<RosterEntry> entries = roster.getEntries();

    log("Buddy list size :"+entries.size());
    for (RosterEntry r : entries) {

        user=r.getUser();
        status_Message=retrieveStatusMessage(user);
        log("name: "+r.getName()+"  user :"+user+"  Status :"+status_Message+" type :"+retrieveState(user));

    }
} 
```

这是我在服务中编写的代码。我在我的服务类中持有 xmpp 连接对象。从我调用这些方法的活动中。我可以登录，我可以在 logcat 中看到日志。但是当我调用 displayBuddyList 时我无法获取好友列表()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:35:37.353

```
Roster roster = XMPPConnection.getRoster();
        Collection<RosterEntry> entries= roster.getEntries();
        ProviderManager.getInstance().addIQProvider("vCard", "vcard-temp",
                new VCardProvider());
        VCard card = null;
        for (RosterEntry entry : entries) {
            card = new VCard();
            Presence presencek= roster.getPresence(entry.getUser());
            try {
                card.load(Main.conn, entry.getUser());
            } catch (Exception e) {
                e.printStackTrace();
            }

            String jid = entry.getUser();
             String name = card.getField("FN");
            String status = presencek.getType().name();
            Log.d("Prescence", "" + presencek.getType().name());// //num one log

            byte[] imgs = card.getAvatar();
            if (imgs != null) {
                int len = imgs.length;
                Bitmap img = BitmapFactory.decodeByteArray(imgs, 0, len);
            } 
```

看到这个[https://stackoverflow.com/questions/9885154/how-to-get-images-from-xmpp-in-android-application/10272947#10272947](https://stackoverflow.com/questions/9885154/how-to-get-images-from-xmpp-in-android-application/10272947#10272947)

# mysql - 如何使用 shell 将 mysql 命令的输出存储到变量中？

> ID：11668302
> 
> 赞同：1
> 
> 时间：2012-07-26T11:28:55.147
> 
> 标签：mysql, shell

我正在使用这个命令：

```
mysql -u user -ppassword database -e "select distinct entityName,entitySource from AccessControl" 
```

输出是这样的：

```
+-----------------------+--------------+
| entityName            | entitySource |
+-----------------------+--------------+
| low                   | Native       |
| high                  | Native       |
| All Groups            | AD           |
| Help Ser vices Group  | AD           |
| DEFAULT_USER_GROUP    | Native       |
| SYSTEM                | Native       |
| DEFAULT_BA_USER_GROUP | Native       |
| soUsersGrp            | Native       |
+-----------------------+--------------+ 
```

我的问题是：如何动态创建变量数组来存储值`entityName`和`entitySource`？我需要使用的是使用 entityName 和 entitySource 的每个值来更新另一个表。

早些时候我试图将输出存储在一个文件中并使用 awk 访问每一行，但这无济于事，因为一行可能包含多个单词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-24T00:13:48.797

当然，这是可以做到的。我想支持在 shell 中将 mysql 管道传输到 mysql 的想法很尴尬，但我理解为什么可能需要这样做（例如管道`mysql`传输到`psql`什么时候）。

```
mysql -qrsNB -u user -p password database \
    -e "select distinct entityName,entitySource from AccessControl" | \ 
        while read record; do
            NAME="`echo $record|cut -d' ' -f 1`"       # that's a tab delimiter
            SOURCE="`echo $record|cut -d'   ' -f 2`"   # also a tab delimiter 
            # your command with $NAME and $SOURCE goes here ... 
            COMMAND="select trousers from namesforpants where entityName='${NAME}'" # ...
            echo $COMMAND | mysql # flags ...
        done 
```

标志修剪你的`-rs`输出，这样你就不必摸索它给你的那个表格，`-q`要求不缓冲结果，`-B`要求批处理模式，并`-N`要求没有列名。

您如何处理这些变量取决于您；可能我会在该循环中编写语句并将它们提供给您的后续流程，而不是担心插值和引号，因为您已经提到您的一些数据中有空格。或者您可以写入/附加到文件，然后将其提供给您的后续流程。

像往常一样，[手册是你的朋友](http://www.manpagez.com/man/1/mysql/)。我也将成为你的朋友，但是联机帮助页是这些东西的答案所在。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:48:18.227

```
#!/usr/bin/env bash
mysql -u user -ppassword database -e "select distinct entityName,entitySource from AccessControl" | while read name source; do
    echo "entityName: $name, entitySource: $source"
done 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T10:41:09.423

## 请检查一下，我通过`exec`.

```
[wcuser@localhost]$ temp=`exec mysql -h10.10.8.36 --port=3306 -uwcuser -pwcuser@123 paycentral -e "select endVersion from script_execution_detail where releaseNo='Release1.0' and versionPrefix='PS'"|tail -1`

[wcuser@localhost]$ echo $temp 
```

## 19

# git - 无法完成gitolite的安装

> ID：11668316
> 
> 赞同：3
> 
> 时间：2012-07-26T11:29:41.103
> 
> 标签：git, github, gitolite

我已经安装了 Git，现在我正在尝试`gitolite`在我的服务器上安装，所以我输入了：

```
git clone git://github.com/sitaramc/gitolite
gitolite/install 
```

该命令的结果如下

```
use the following full path for gitolite: /root/gitolite/src/gitolite 
```

我怎样才能完成安装

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:40:13.670

如果您查看[您尝试执行的文件](https://github.com/sitaramc/gitolite/blob/master/install)，会有一些有用的评论：

```
Usage (from gitolite clone directory):

    ./install
    to run gitolite using an absolute or relative path, for example
    'src/gitolite' or '/full/path/to/this/dir/src/gitolite'

    ./install -ln [<dir>]
    to symlink just the gitolite executable to some <dir> that is in
    $PATH. <dir> defaults to $HOME/bin if <dir> not specified. <dir> is
    assumed to exist; gitolite will not create it.

    Please provide a full path, not a relative path.

    ./install -to <dir>
    to copy the entire 'src' directory to <dir>. If <dir> is not in
    $PATH, use the full path to run gitolite commands.

    Please provide a full path, not a relative path.

Simplest use, if $HOME/bin exists and is in $PATH, is:

    git clone git://github.com/sitaramc/gitolite
    gitolite/install -ln

    # now run setup
    gitolite setup -pk /path/to/YourName.pub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-03T10:00:10.617

它现在被认为是“完成安装”。要使用它，您必须使用它输出的路径。

如果要在路径上安装它，则必须使用以下形式：

```
./install --to <dir> 
```

推荐的是：

```
./install --to $HOME/bin 
```

# ruby-on-rails - 验证失败后渲染自定义页面

> ID：11668325
> 
> 赞同：2
> 
> 时间：2012-07-26T11:30:22.667
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我将高压 gem (https://github.com/thoughtbot/high_voltage/) 用于具有大量静态页面的站点。该站点具有三个独特的表单，所有这些表单都由“表单”控制器/模型处理。

现在，当需要验证的字段被填充时，一切都运行良好，但是当验证失败时，它会从“页面”控制器（高压）跳回“表单”控制器并呈现 /form/new，而不是例如 / pages/quotes - 这是可以理解的，因为它是默认行为。

我也在检查表单中的验证：

```
= form_for @form, :validate => true do |f|
  - if @form.errors[:name].present?
    .control-group.error
      = f.label "Your Name"
      = f.text_field :name
  - else
    = f.label "Your Name"
    = f.text_field :name 
```

知道如何在验证失败后重新呈现当前页面（呈现特定表单）而不是定向到 /forms/new

任何建议表示赞赏，谢谢！

# java - 在插件中使用 maven 版本

> ID：11668329
> 
> 赞同：0
> 
> 时间：2012-07-26T11:30:34.703
> 
> 标签：java, maven, maven-2, maven-plugin, maven-3

我正在为 Maven 编写一个插件。我想根据 Maven 版本（使用我的插件的人）自定义操作，例如：

```
if (MavenVer == "2.2.1") 
    //do some things
if (MavenVer == "3.0")
//do another things 
```

我发现了 build-helper-maven-plugin 但我不知道如何使用它来完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:48:29.460

您需要将 maven 引用注入 plugina 并使用 API [http://maven.apache.org/ref/2.2.1/maven-project/apidocs/org/apache/maven/project/MavenProject.html#getVersion](http://maven.apache.org/ref/2.2.1/maven-project/apidocs/org/apache/maven/project/MavenProject.html#getVersion) ( )

[http://maven.apache.org/ref/3.0.3/maven-core/apidocs/org/apache/maven/project/MavenProject.html#getVersion](http://maven.apache.org/ref/3.0.3/maven-core/apidocs/org/apache/maven/project/MavenProject.html#getVersion) ()

注入代码

```
public class MyMojo extends AbstractMojo {
/**
 * @component
 */
ArtifactFactory factory;
/**
 * @component
 */
ArtifactResolver artifactResolver;
/**
 * @parameter default-value="${project.remoteArtifactRepositories}"
 */
List remoteRepositories;
/**
 * @parameter default-value="${localRepository}"
 */
ArtifactRepository localRepository;
/**
 * @parameter default-value="${project}"
 */
MavenProject mavenProject; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T19:24:46.193

我一直在寻找你的问题的答案，我得出的结论是没有简单的方法来获得 maven 版本，或者至少我找不到它。我能找到的最好的是 maven-enforcer-plugin 包含查找 maven 版本的代码。然而，在查看 maven-enforcer-plugin 源代码时，它有点复杂，涉及通过 plexus（Maven 使用的 IoC 容器）获取 RuntimeInformation 实例的句柄。

我建议你看看[maven-enforcer-plugin](http://svn.apache.org/viewvc/maven/enforcer/tags/enforcer-1.1.1)看看你是否可以使用他们所做的。特别注意 RequireMavenVersion 和 EnforcerMojo 类。

# css - LESS 导入不起作用

> ID：11668338
> 
> 赞同：0
> 
> 时间：2012-07-26T11:31:13.757
> 
> 标签：css, import, less, c-preprocessor

我在使用@import 时遇到问题。到目前为止，我有一个 style.less 文件，看起来像这样：

```
/*
* Screen-Cuts.Com Styles
* 
*/

/* Mixins
======================================== */

@import "grid.less";

/* Main Page Styles 
======================================== */

body {
}

header {
    h1 {
        font-family: 'Exo', san-serif;
        margin: 0 auto;
        font-size: 2.25em
    }
    nav[role="navigation"] {
        font-family: 'Lato', sans-serif;
        font-size: 1.25em;

        ul {
            list-style: none;

            li {
                float: left;
            }
        }
    }           
} 
```

但是，当我编译较少的代码时，@import 似乎不起作用，并且我没有收到任何编译错误。这是输出：

```
/*
 * Screen-Cuts.Com Styles
 * 
 */
/* Variables
======================================== */
/* Mixins
======================================== */
/* Main Page Styles 
======================================== */
header h1 {
  font-family: 'Exo', san-serif;
  margin: 0 auto;
  font-size: 2.25em;
}
header nav[role="navigation"] {
  font-family: 'Lato', sans-serif;
  font-size: 1.25em;
}
header nav[role="navigation"] ul {
  list-style: none;
}
header nav[role="navigation"] ul li {
  float: left;
} 
```

此外，当我尝试使用在 grid.less 中定义的 mixin 时，我收到一个编译时错误，指出没有定义 mixin。有谁可以帮我离开这里吗？我确定我犯了一个愚蠢的错误，但是我环顾四周并找不到任何线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T00:09:14.383

我在这里解决了问题。grid.less 文件中存在编译错误。一旦我修复了该错误，文件就被导入了。

# grails - 带有id而不是对象的Grails域类构造函数

> ID：11668339
> 
> 赞同：2
> 
> 时间：2012-07-26T11:31:21.567
> 
> 标签：grails, grails-orm, grails-domain-class

我的域类如下所示：

```
class UserEvent { 
    User user
    Event event
    boolean isAttending
} 
```

生成的数据库表看起来有以下列：

```
[ID , EVENT_ID, USER_ID , IS_ATTENDING ] 
```

我有事件对象和唯一的用户对象 (user_id) 的 id。我只想用这个数据创建新的 UserEvent 对象，而不加载 User 对象，它可能看起来像这样：

```
def userEvent = new UserEvent(user:['id':user_id],isAttending: true, event: event) 
```

我尝试了很多东西，但没有找到解决方案。我认为这绝对是可能的，因为它是通过与控制器中的参数类似的方式完成的，控制器中只包含关联对象的 id：

```
 def userEvent= new UserEvent(params) 
```

我期待找到解决方案。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T11:45:22.357

当你说“不加载用户对象”时，你可以这样做：

```
def userEvent = new UserEvent(user:User.load(user_id), isAttending: true, event: event) 
```

与 不同`get`的是，该[`load`](http://grails.org/doc/latest/ref/Domain%20Classes/load.html)方法不会命中数据库。相反，它创建一个代理对象，该对象仅在第一次访问非`id`属性时从数据库中获取其数据。

# macos - OSX 中是否有 API 可以跨应用程序访问 Spelling API？

> ID：11668343
> 
> 赞同：1
> 
> 时间：2012-07-26T11:31:41.837
> 
> 标签：macos, cocoa

很像[Moom](http://manytricks.com/moom/)在应用程序中扩展了 NSWindow 的关闭/打开/最小化功能。是否可以访问 OSX 拼写系统的 API？

更具体地说......是否可以在出现拼写错误时挂钩系统范围的事件？

**编辑** *我猜如果有它会通过辅助功能API* ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:38:49.107

为此，您可以使用[NSSpellChecker](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSSpellChecker_Class/Reference/Reference.html)。或者，如果您只想添加常规拼写检查，您可以为大多数文本输入字段启用拼写检查。

```
[textView setContinuousSpellCheckingEnabled:YES]; 
```

# javascript - javascript查找字符串并删除所有以下字符

> ID：11668348
> 
> 赞同：0
> 
> 时间：2012-07-26T11:31:52.573
> 
> 标签：javascript

> **可能重复：**
> [删除某个字符后的所有内容](https://stackoverflow.com/questions/5631384/remove-everything-after-a-certain-character)

如果我有

```
var shot = www.site.com/ask 
```

我想删除“/”之后的所有字符（包括“/”）。所以结果将是

```
www.site.com 
```

注意：shot 是动态变化的值，这一切都将在 javascript 上完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:35:54.780

```
'www.site.com/ask'.split('/', 1)[0]; // => www.site.com 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:35:35.473

假设您想要之前的所有内容，`/`您可以找到字符的索引并返回它之前的子字符串：

```
var shot = "www.site.com/ask";
var index = shot.indexOf("/");
var result;
if (index < 0) {
    result = shot;
} else {
    result = shot.substr(0, index);
}
// result = "www.site.com" 
```

如果您想从包含协议的字符串中获取域，例如`http://www.site.com/ask`并获取，`www.site.com`那么您需要包含额外的逻辑，因为上面的代码将返回`http:`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:35:46.340

```
var shot = 'www.site.com/ask';
var site = shot.replace(/\/.*$/,''); 
```

`site`现在将包含 www.site.com

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T11:36:27.837

试试这个：

```
/^(.*?)\//.exec(shot)[1] 
```

或者：

```
shot.match(/^[^\/]*/)[0] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-26T11:39:50.380

你可以让浏览器为你做解析：

```
var a = document.createElement("a");
a.href = "http://" + "www.site.com/ask";
alert(a.hostname);
//"www.site.com" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-26T11:42:29.430

最简单的非正则表达式方法是

```
shot = shot.substr(0, shot.indexOf('/')); 
```

但这并不能说明存在`http://`或类似的情况。为此，您确实需要一个正则表达式。

```
shot = shot.replace(/([^\/])\/([^\/].*)?$/, '$1'); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T11:35:16.730

这是一个正则表达式，它将删除第一个斜杠之后的所有内容

```
var shot = 'www.site.com/ask';
shot.replace(/\/.+/, ''); 
```

# asp-classic - 经典asp中的CPF验证

> ID：11668350
> 
> 赞同：1
> 
> 时间：2012-07-26T11:31:59.047
> 
> 标签：asp-classic, vbscript

我是经典asp的新手。我想要经典 asp 中的 CPF 验证功能。

以下链接在 javascript 和 vb.net 中具有 CPF 验证功能，但我希望在经典 asp /vbscript 中使用它

[http://codigofonte.uol.com.br/codigo/js-dhtml/validacao/validar-cpf-via-javascript](http://codigofonte.uol.com.br/codigo/js-dhtml/validacao/validar-cpf-via-javascript)

[http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=3811&lngWId=10](http://www.planetsourcecode.com/vb/scripts/ShowCode.asp?txtCodeId=3811&lngWId=10)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T19:48:48.657

最后，我自己编写了一个 vbscript 函数。将来可能会对某人有所帮助。

```
function ValidateCPFNew(cpf)
    Dim multiplic1, multiplic2
    multiplic1=Array(10, 9, 8, 7, 6, 5, 4, 3, 2)
    multiplic2=Array(11, 10, 9, 8, 7, 6, 5, 4, 3, 2 )
    Dim tempCpf,digit,sum,remainder,i,RegXP
    cpf = Trim(cpf)
    cpf = Replace(cpf,".", "")
    cpf = Replace(cpf,"-", "")
    if (Len(cpf) <> 11) Then
        ValidateCPFNew = false
    else
        tempCpf = Left (cpf, 9)
        sum = 0

        Dim intCounter
        Dim intLen 
        Dim arrChars()

        intLen = Len(tempCpf)-1
        redim arrChars(intLen)

        For intCounter = 0 to intLen
            arrChars(intCounter) = Mid(tempCpf, intCounter + 1,1)
        Next

        i=0
        For i = 0 to 8
            sum =sum + CInt(arrChars(i)) * multiplic1(i)
        Next

        remainder = sum Mod 11
        If (remainder < 2) Then
            remainder = 0
        else
            remainder = 11 - remainder
        End If

        digit = CStr(remainder)
        tempCpf = tempCpf & digit
        sum = 0

        intLen = Len(tempCpf)-1
        redim arrChars(intLen)
        intCounter= 0
        For intCounter = 0 to intLen
            arrChars(intCounter) = Mid(tempCpf, intCounter + 1,1)
        Next
        i=0
        For i = 0 to 9
            sum =sum + CInt(arrChars(i)) * multiplic2(i)
        Next        
        remainder = sum Mod 11

        If (remainder < 2) Then
            remainder = 0
        else
            remainder = 11 - remainder
        End If      
        digit = digit & CStr(remainder)

        Set RegXP=New RegExp
            RegXP.IgnoreCase=1
            RegXP.Pattern=digit & "$"

        If RegXP.test(cpf) Then 
            ValidateCPFNew = true
        else
            ValidateCPFNew = false
        end if
    end if
end Function 
```

# jquery - Freebase 建议 - 连接我的数据库？

> ID：11668354
> 
> 赞同：1
> 
> 时间：2012-07-26T11:32:09.747
> 
> 标签：jquery, freebase

我正在使用[Freebase 建议](http://wiki.freebase.com/wiki/Freebase_Suggest)。如果用户找不到他正在寻找的东西，他会在文本字段中输入它，并将一个新术语添加到我的数据库中。问题是，我建议也通过这些添加的术语进行搜索。

我找到了这个[答案](http://lists.freebase.com/pipermail/freebase-discuss/2011-May/006513.html)，但我不确定它是否适合我的需要，因为我仍然想查看 Freebase 结果。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T23:14:41.753

好的，经过几个小时的谷歌搜索和思考，我已经弄清楚了。

我将同步 ajax 调用 ( `'async':false`) 添加到`beforeSend`建议请求函数中的回调函数。它调用一个函数，该函数从我的数据库返回值的 json 数组。在异步调用 Freebase 建议服务后，我将两个结果加在一起并显示它们。

而已！

# python - SQLAlchemy：从表名中获取模型。据我所知，这可能意味着将一些函数附加到元类构造函数

> ID：11668355
> 
> 赞同：37
> 
> 时间：2012-07-26T11:32:11.180
> 
> 标签：python, sqlalchemy, foreign-keys

我想创建一个函数，给定表的名称，返回具有该表名的**模型**。例如：

```
class Model(Base):
    __tablename__ = 'table'
    ...a bunch of Columns

def getModelFromTableName(tablename):
   ...something magical 
```

所以 getModelFromTableName('table') 应该返回 Model 类。

我的目标是在我正在制作的简单表单生成器中使用该函数，因为 FormAlchemy 不适用于 python3.2，我希望它能够很好地处理外键。

谁能给我任何关于如何让 getModelFromTableName 工作的指示？

这是我的一个想法（这可能是完全错误的，我之前没有使用过元类......）

如果我要让我的模型类继承自 Base 以及其他一些类 (TableReg) 并让 TableReg 的类元存储 Model。**某些**全局字典或单例中的表名。

我意识到这可能完全关闭，因为 Base 的元类做了一些我不想破坏的非常重要且非常漂亮的东西，但我认为必须有一种方法可以将一些构造函数代码附加到元类我的模型。或者我不明白。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2014-05-20T08:19:26.197

受到[Eevee](https://stackoverflow.com/questions/11668355/sqlalchemy-get-model-from-table-name-this-may-imply-appending-some-function-to/23754464#comment24391616_11718281)评论的启发：

```
def get_class_by_tablename(tablename):
  """Return class reference mapped to table.

  :param tablename: String with name of table.
  :return: Class reference or None.
  """
  for c in Base._decl_class_registry.values():
    if hasattr(c, '__tablename__') and c.__tablename__ == tablename:
      return c 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2021-03-17T03:57:46.557

因此，在 SQLAlchemy 版本 1.4.x（我更新到 2020-03-16 左右）中，它似乎`_decl_class_registry`不再存在。

我能够使用新的`registry`类属性（它不受保护，所以希望它不会被突然删除！）。

```
Base.TBLNAME_TO_CLASS = {}

for mapper in Base.registry.mappers:
    cls = mapper.class_
    classname = cls.__name__
    if not classname.startswith('_'):
        tblname = cls.__tablename__
        Base.TBLNAME_TO_CLASS[tblname] = cls 
```

不确定这是否是最好的方法，但它是我如何做到的。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-02-04T11:11:41.293

请注意[OrangeTux](https://stackoverflow.com/a/23754464/4213715)的答案没有考虑架构。如果您在不同的模式中有表同音异义词，请使用：

```
def get_class_by_tablename(table_fullname):
  """Return class reference mapped to table.

  :param table_fullname: String with fullname of table.
  :return: Class reference or None.
  """
  for c in Base._decl_class_registry.values():
    if hasattr(c, '__table__') and c.__table__.fullname == table_fullname:
      return c 
```

`fullname`是一个表属性见：

[github.com/sqlalchemy/sqlalchemy/blob/master/lib/sqlalchemy/sql/schema.py#L530-L532](https://github.com/sqlalchemy/sqlalchemy/blob/7a4c40ff6b9d278529735c792c3ddfda60bd4a85/lib/sqlalchemy/sql/schema.py#L530-L532)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-03T12:11:05.207

实用功能已添加到[SQLAlchemy-Utils](https://github.com/kvesteri/sqlalchemy-utils)。有关更多信息，请参阅[get_class_by_table 文档](http://sqlalchemy-utils.readthedocs.org/en/latest/orm_helpers.html#sqlalchemy_utils.functions.get_class_by_table)。SQLAlchemy-Utils 中的解决方案也能够涵盖单表继承场景。

```
import sqlalchemy as sa

def get_class_by_table(base, table, data=None):
    """
    Return declarative class associated with given table. If no class is found
    this function returns `None`. If multiple classes were found (polymorphic
    cases) additional `data` parameter can be given to hint which class
    to return.

    ::

        class User(Base):
            __tablename__ = 'entity'
            id = sa.Column(sa.Integer, primary_key=True)
            name = sa.Column(sa.String)

        get_class_by_table(Base, User.__table__)  # User class

    This function also supports models using single table inheritance.
    Additional data paratemer should be provided in these case.

    ::

        class Entity(Base):
            __tablename__ = 'entity'
            id = sa.Column(sa.Integer, primary_key=True)
            name = sa.Column(sa.String)
            type = sa.Column(sa.String)
            __mapper_args__ = {
                'polymorphic_on': type,
                'polymorphic_identity': 'entity'
            }

        class User(Entity):
            __mapper_args__ = {
                'polymorphic_identity': 'user'
            }

        # Entity class
        get_class_by_table(Base, Entity.__table__, {'type': 'entity'})

        # User class
        get_class_by_table(Base, Entity.__table__, {'type': 'user'})

    :param base: Declarative model base
    :param table: SQLAlchemy Table object
    :param data: Data row to determine the class in polymorphic scenarios
    :return: Declarative class or None.
    """
    found_classes = set(
        c for c in base._decl_class_registry.values()
        if hasattr(c, '__table__') and c.__table__ is table
    )
    if len(found_classes) > 1:
        if not data:
            raise ValueError(
                "Multiple declarative classes found for table '{0}'. "
                "Please provide data parameter for this function to be able "
                "to determine polymorphic scenarios.".format(
                    table.name
                )
            )
        else:
            for cls in found_classes:
                mapper = sa.inspect(cls)
                polymorphic_on = mapper.polymorphic_on.name
                if polymorphic_on in data:
                    if data[polymorphic_on] == mapper.polymorphic_identity:
                        return cls
            raise ValueError(
                "Multiple declarative classes found for table '{0}'. Given "
                "data row does not match any polymorphic identity of the "
                "found classes.".format(
                    table.name
                )
            )
    elif found_classes:
        return found_classes.pop()
    return None 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-08-20T12:35:39.863

对于 sqlalchemy 1.4.x（对于未来的读者来说也可能是 2.0.x）当模型分布在许多文件中时，您可以很好地扩展[Erotemic](https://stackoverflow.com/a/66666783/10743742)答案以更方便（这种情况是在正确执行时查找 ORM 类的主要原因哎呀）。

参加这样的课程并`Base`从中受益：

```
from sqlalchemy.orm import declarative_base

class BaseModel:

    @classmethod
    def model_lookup_by_table_name(cls, table_name):
        registry_instance = getattr(cls, "registry")
        for mapper_ in registry_instance.mappers:
            model = mapper_.class_
            model_class_name = model.__tablename__
            if model_class_name == table_name:
                return model

Base = declarative_base(cls=BaseModel) 
```

然后声明您的模型，即使在单独的模块中，也可以让您在`cls.model_lookup_by_table_name(...)`不导入任何内容的情况下使用方法，只要您是从 a 派生的`Base`：

`user_models.py`

```
from sqlalchemy import Column, Integer

class User(Base):
    __tablename__ = "user"

    id = Column(Integer, primary_key=True)

    # ... and other columns

    def some_method(self):
        # successfully use lookup like this
        balance_model = self.model_lookup_by_table_name("balance")
        # ...
        return balance_model 
```

`balance_models.py`

```
from sqlalchemy import Column, Integer

class Balance(Base):
    __tablename__ = "balance"

    id = Column(Integer, primary_key=True)

    # ... other columns

    def some_method(self):
        # lookup works on every model
        user_model = self.model_lookup_by_table_name("user")
        # ...
        return user_model 
```

它按预期工作：

```
>>> User().some_method()
<class 'balance_models.Balance'>
>>> Balance().some_method()
<class 'user_models.User'>
>>> Base.model_lookup_by_table_name("user")
<class 'user_models.User'>
>>> Base.model_lookup_by_table_name("balance")
<class 'balance_models.Balance'> 
```

您可以安全地缓存此方法的输出`functools.lru_cache`以提高性能（`for`在不需要时避免 python 循环）。此外，您可以以相同的方式添加更多查找，例如通过类名（不仅是本例中的表名）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-03-04T20:28:46.920

一种方法是在 mixin`__table_cls__`中`Base`或作为 mixin 定义一个类方法。请注意，我没有用任何继承测试过这个。一个例子，如果扩充`Base`：

```
# Python 3.7.2, SQLAlchemy 1.3.13
###
# app/models.py
from sqlalchemy import Table
from sqlalchemy.ext.declarative import declarative_base

class Base(object):
    @classmethod
    def __table_cls__(cls, *args, **kwargs):
        t = Table(*args, **kwargs)
        t.decl_class = cls
        return t

Base = declarative_base(cls=Base) 
```

设计一个表格示例：

```
# app/models.py
class Account(Base):  # Note this is the customized Base class
    __tablename__ = 'account'
    id = Column(Integer, primary_key=True)
    name = Column(String, nullable=False)
    account_number = Column(String) 
```

在控制台中测试：

```
# Python 3.7.2 Console
>>> from app import models as m
>>> account_table = m.Base.metadata.tables['account']
>>> account_table.__class__
<class 'sqlalchemy.sql.schema.Table'>

>>> account_table.decl_class
<class 'app.models.Account'> 
```

作为一个函数：

```
def get_class_by_table_name(table_name):
    tbl = Base.metadata.tables[table_name]
    return tbl.decl_class 
```

旁注：由于很多答案都引用`Base._decl_class_registry`了 ，因此该`declarative_base()`函数还接受`class_registry`命名参数的字典。

```
>>> registered_classes = {}
>>> Base = declarative_base(cls=Base, class_registry=registered_classes)
>>> registered_classes.keys()
dict_keys(['Account', '_sa_module_registry', 'AccountType', ...]) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-09-27T15:04:20.153

如果您正在使用 sqlalchemy automap，则需要稍作修改。我花了几分钟调整它：

```
def get_class_by_tablename(tablename, Base):
  for c in Base._decl_class_registry.values():
    if c.__table__.name == tablename:
      return c 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-21T10:19:49.330

[https://stackoverflow.com/a/23754464/12903047](https://stackoverflow.com/a/23754464/12903047)

对于 flask-sqlachemy 使用它：

db.Model.registry._class_registry.values()

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-07-30T09:03:12.267

我打算删除它，但我认为评论中的讨论可能对想了解一些良好做法的人有用。用少许盐来回答这个问题。

* * *

像这样的东西可以解决问题：

```
def getModelFromTableName(sTable):
    """
    return the Model class with the given __tablename__
    """
    globals = globals()
    for k in globals:
        if type(globals[k]) == sqlalchemy.ext.declarative.DeclarativeMeta:
            try:
                if globals[k].__tablename__ == sTable:
                    return globals[k]
            except:
                pass
    return None 
```

# wordpress - 如何在分类视图中显示子分类文章？- WordPress

> ID：11668357
> 
> 赞同：0
> 
> 时间：2012-07-26T11:32:24.273
> 
> 标签：wordpress, categories, permalinks

我在我的网站上安装了 wordpress 类别小部件，其中列出了我网站上的所有类别/子类别及其层次结构：

```
Watch Accessories (1)
- Straps (1)
Watch Glossary (5)
Watch Guides (1)
- Maintenance (1)
Watch News (2)
- New Releases (2)
Watch Reviews (7)
- Christopher Ward (1)
- Hamilton (1)
- Seiko (2)
- Tissot (2)
- Vostok (1) 
```

我正在使用以下永久链接结构：

```
/%category%/%postname%/ 
```

当我单击父类别（例如： http: [//www.domain.com/watch-reviews/](http://www.domain.com/watch-reviews/)）时，它会显示类别视图并列出该类别中的所有文章。

但是，当我单击子类别（例如： http: [//www.domain.com/watch-reviews/seiko/](http://www.domain.com/watch-reviews/seiko/)）时，它不会显示类别视图，也不会列出子类别中的所有文章。相反，它会重定向到子类别中的第一篇文章。

如何让 Wordpress 显示子类别中的所有文章？

请随意访问 domain.com 亲自体验此问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:17:35.837

您的子类别可在[http://www.zapby.com/seiko/](http://www.zapby.com/seiko/)获得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:49:49.117

一种简单的解决方案是针对这些类别结构

手表配件 (2)

*   肩带 (1)

你有 2 篇文章

第1条（手表配件）选择一个类别

第2条（手表配件，表带）选择2类别，我的意思是也选择父母。

这将显示所有带有附件类别子类别的文章。

# css - 为什么子垂直边距不扩展父容器？

> ID：11668360
> 
> 赞同：33
> 
> 时间：2012-07-26T11:32:41.547
> 
> 标签：css, margin

我遇到了一个案例，我需要一个孩子的边距来扩展父容器。发现parent外面的空间分配了，但是parent本身并没有展开。然后我发现通过向父级添加“溢出：隐藏”可以解决这个问题。

任何人都可以解释为什么会这样吗？

**更新：**

我发现向父级添加任何填充或边框值也可以解决此问题。

[更新示例](http://jsfiddle.net/wmdXJ/2/)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-26T12:24:29.203

“为什么”的答案在[这里](https://colinaarts-com.herokuapp.com/articles/the-magic-of-overflow-hidden)得到了简洁明了的描述。有一些属性可以建立“[块格式化上下文](http://www.w3.org/TR/CSS21/visuren.html#block-formatting)”。即：

> 浮动、绝对 [和固定] 定位元素、不是块框的块容器（例如内联块、表格单元格和表格标题），以及具有“溢出”而不是“可见”的块框（除非值已传播到视口）为其内容建立新的块格式化上下文。

正是这种块格式化上下文的变化，这就是*为什么*上面在评论中给出的这些解决方案适用于`margin`（以及在前面的情况下`float`，`padding`后面的流入元素）如何运作的原因。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-26T12:18:06.990

我认为折叠边距是原因：[http ://www.w3.org/TR/CSS2/box.html#collapsing-margins](http://www.w3.org/TR/CSS2/box.html#collapsing-margins)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-07-10T07:13:37.443

截至 2018 年 7 月的一个小更新。Mozilla 有一篇关于这个问题的[精彩文章](https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing)，这是由于保证金崩溃。

摘要：父母和第一个孩子的边缘可能会崩溃。他们最终**好像父母有结果保证金**。

> **父母和第一个/最后一个孩子**
> 
> 如果没有边框、内边距、内联部分、创建的块格式化上下文，或者没有将块的 margin-top 与其第一个子块的 margin-top 分开的间隙；或者没有边框、填充、内联内容、高度、最小高度或最大高度来将块的边距底部与其最后一个子块的边距底部分开，然后这些边距折叠。折叠的边距最终在父级之外。

# actionscript-3 - 如何在 Flash 中找到按钮定义？

> ID：11668361
> 
> 赞同：0
> 
> 时间：2012-07-26T11:32:53.270
> 
> 标签：actionscript-3, flash, flash-cs5

我有这个带有一些按钮的 Flash 模板 (.fla)，这些按钮的定义位于操作脚本 (.as) 文件中。我需要在动作脚本中找到特定按钮的定义，以便能够修改该特定按钮的功能。

有没有简单的方法可以在动作脚本中找到按钮的定义，而不是手动查看动作脚本文件的定义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:08:19.023

您在寻找[getDefinationByName()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#getDefinitionByName%28%29)吗？

# vb.net - 使用正则表达式验证电子邮件地址

> ID：11668362
> 
> 赞同：0
> 
> 时间：2012-07-26T11:33:04.797
> 
> 标签：vb.net, winforms

我写了这个正则表达式函数

```
 Public Function ValidateEmailAddress(ByVal txtEmailAddress As String) As Boolean

    Dim pattern As String
    pattern = "^[a-z0-9_\\+-]+(\\.[a-z0-9_\\+-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*\\.([a-z]{2,4})$"
    If Regex.IsMatch(txtEmailAddress, pattern) Then
        Return True
    Else
        Return False
    End If

End Function 
```

并在子过程中调用该函数：

```
 If ValidateEmailAddress(txtEmailAddress.Text) = True Then
    Else
       MessageBox.Show("Email Not Valid")
    End If
    Sub Procedure 
```

当我输入电子邮件时，无论是否正确，我都会收到相同的消息，即电子邮件无效，除了在 If 语句之后单步执行代码时，它会忽略返回 true。请任何人都可以发现这里的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T13:21:16.090

作为 BigYellowCactus 答案的替代方法：- 您可以使用类似的东西-我认为这比使用正则表达式更可取：

```
Public Shared Function IsValidEmailAddress(ByVal emailAddress As String) As Boolean
    Try
        Dim address As New MailAddress(emailAddress)
        Return True
    Catch ex As Exception
        Return False
    End Try
End Function 
```

这将返回`False`，`@abc.com`而`bill@`仅检查`@`将返回`True`

# oracle - 具有子查询支持的 PIVOT - IN 的替代方法

> ID：11668365
> 
> 赞同：5
> 
> 时间：2012-07-26T11:33:18.750
> 
> 标签：oracle, oracle11g

根据 oracle 文档，`PIVOT`函数不支持“ `IN`”子句中的子查询，但在`PIVOT`XML 函数中是可能的。例如

```
SELECT *
FROM table_name
PIVOT
(
  SUM(column_name_1)
  FOR [column_name_2] IN (['Output_Column1'],['Output_Column2'])
)
AS aliasName 
```

我需要`['Output_Column1'],['Output_Column2']`用子查询替换。

是否有其他功能等效于`PIVOT`我们可以提供子查询而不是硬编码整个输出列甚至在`PIVOT`函数本身中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:33:32.263

不，列数必须在解析时知道。对于 PIVOT XML 没有问题，因为这样的查询只返回一列。

# r - R组选择以data.table中的值为条件

> ID：11668367
> 
> 赞同：6
> 
> 时间：2012-07-26T11:33:22.260
> 
> 标签：r, select, data.table

您好我想根据数据表中的值选择一组值。

具体来说，我想为 e == 1 的所有正值选择按日期和 id 分组的所有列

```
 id   date     e       logret 
   7 2011-07-29  1   -0.0272275211      
   7 2011-07-29  2    0.0034229025      
   7 2011-07-29  3    0.0042622177      
   8 2011-07-29  1    0.0035662770      
   8 2011-07-29  2   -0.0015268474 
   8 2011-07-29  3    0.0013333333
   7 2011-07-30  1    0.0044444444      
   7 2011-07-30  2   -0.0001111111 
   7 2011-07-30  3    0.0013333333 
```

这里将选择 id 8 和日期 2011-07-29 的所有元素以及日期 2011-07-30 的 id 7 的所有元素，因为 e == 1 的 logret > 0 其中 id 7 的所有元素在 2011- 07-29 被忽略，因为第一个 logret（其中 e==1）<0

答：

```
 8 2011-07-29  1    0.0035662770      
   8 2011-07-29  2   -0.0015268474 
   8 2011-07-29  3    0.0013333333
   7 2011-07-30  1    0.0044444444      
   7 2011-07-30  2   -0.0001111111 
   7 2011-07-30  3    0.0013333333 
```

在 sql 中，我会使用某种子选择来实现这一点。我会 ：

```
1) Select the id and date where e=1 and logret > 0
2) Select * join on results of subselect 
```

我认为 data.table 也可以做到这一点，但我发现用 data.table 术语表达它很棘手。具体来说，我可以复制第 1 步，但不能在第 2 步中执行连接部分。

```
pos <- DT[e==1][logret > 0] 
```

但无法将 pos 值重新加入我的 DT

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T11:55:14.270

它不漂亮，也不在 中`data.table`，但这似乎可行：

```
# Recreate your data
df = read.table(header=TRUE, text="id   date    e       logret 
    7 2011-07-29 1   -0.0272275211      
    7 2011-07-29 2    0.0034229025      
    7 2011-07-29 2    0.0042622177      
    8 2011-07-29 1    0.0035662770      
    8 2011-07-29 2   -0.0015268474 
    8 2011-07-29 3    0.0013333333")
df[which(df$id != df$id[which(df$e == 1 & df$logret < 0)]),]
#   id       date e       logret
# 4  8 2011-07-29 1  0.003566277
# 5  8 2011-07-29 2 -0.001526847
# 6  8 2011-07-29 3  0.001333333
#
## Or the equivalent in "positive" terms
#
# df[which(df$id == df$id[which(df$e == 1 & df$logret > 0)]),] 
```

# 根据评论和新样本数据进行更新

就在我的脑海里（我对这个包没有*任何*经验`data.table`；它在我的“学习”清单上）。这是一个可能的解决方案：

```
temp = split(df, df$date)
lapply(temp, 
       function(x) 
         x[which(x$id == x$id[which(x$e == 1 & x$logret > 0)]),])
# $`2011-07-29`
#   id       date e       logret
# 4  8 2011-07-29 1  0.003566277
# 5  8 2011-07-29 2 -0.001526847
# 6  8 2011-07-29 3  0.001333333
# 
# $`2011-07-30`
#   id       date e        logret
# 7  7 2011-07-30 1  0.0044444444
# 8  7 2011-07-30 2 -0.0001111111
# 9  7 2011-07-30 3  0.0013333333 
```

# 更新 2

这也值得一试`merge`：

```
merge(df, df[which(df$e == 1 & df$logret > 0), c(1, 2)])
#   id       date e        logret
# 1  7 2011-07-30 1  0.0044444444
# 2  7 2011-07-30 2 -0.0001111111
# 3  7 2011-07-30 3  0.0013333333
# 4  8 2011-07-29 1  0.0035662770
# 5  8 2011-07-29 2 -0.0015268474
# 6  8 2011-07-29 3  0.0013333333 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T13:25:06.280

我已经解决了一个回合：

```
pos <- DT[e==1][logret > 0, list(id,date)]
ans <- DT[J(pos$id,pos$date)]; 
```

有兴趣在 data.table 中听到更优雅的 1 行方法。

* * *

马修编辑：

如果`key(DT)`已经是，`(id,date)`那么一个班轮将是：

```
DT[DT[e==1 & logret>0, list(id,date)]] 
```

这也应该更快。如果您可以依赖`id`并`date`成为 的前 2 列`DT`，则可以将其缩短为：

```
DT[DT[e==1 & logret>0]] 
```

# regex - xQuery 中用于标记化的正则表达式

> ID：11668370
> 
> 赞同：2
> 
> 时间：2012-07-26T11:33:30.833
> 
> 标签：regex, xpath, xquery, tokenize

使用 xPath 我得到这样的文本：

> sed id felis mi; Nam porta lacinia sapien vestibulum egestas；Praesent nec nisl purus，eget mollis metus。Fusce euismod ante id Tellus tincidunt dignissim ornare magna blandit。Nunc id risus quam。

我想把它分成两个变量：

var1 = 从开头到第一个点的文本 => 如果这部分包含超过 10 个单词（由空格分隔）并包含分号“;”，那么它将从开头到第一个分号。

var2 = 文本的右侧部分。

我从这段代码开始，但它没有给我想要的东西（我还没有处理 10 个单词的条件）：

```
let $left := data(tokenize($doc//div/blockquote/p/text(), '^(.*?)[;|.](.*?)$')[1])
let $right := data(tokenize($doc//div/blockquote/p/text(), '^(.*?)[;|.](.*?)$')[2]) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T13:33:01.120

`tokenize()`即使不使用或任何正则表达式也可以完成：

```
 for $s in 'Sed id felis mi; Nam porta lacinia sapien vestibulum egestas; Praesent nec nisl purus, eget mollis metus. Fusce euismod ante id tellus tincidunt dignissim ornare magna blandit. Nunc id risus quam.',
       $vBeforeDot in substring-before($s, '.'),
       $vBeforeSemiC in substring-before($s, ';')
      return
         ($vBeforeDot
                       [string-length(normalize-space(.))
                       - string-length(translate(normalize-space(.), ' ', ''))
                       le 9
                       ],
        $vBeforeSemiC
        )[1] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T12:38:52.117

**尝试这个**

```
for $p in doc('file:///c:/test.xml')//div/blockquote/p/text()
    return 
        if (count(tokenize(tokenize($p,'[.]')[1],'\s+')) gt 10) then
            (tokenize($p,'[.]')[1])
        else
            (tokenize($p,';')[1]) 
```

**有关参考，请参阅[fn:tokenize](http://www.w3.org/TR/xpath-functions/#func-tokenize)。**

# android - AndroidManifest.xml 文档中根元素后面的标记必须格式正确

> ID：11668372
> 
> 赞同：3
> 
> 时间：2012-07-26T11:33:34.647
> 
> 标签：android, xml

我已经让 Eclipse 生成一个基本的 android Hello World 应用程序，但它有 2 个错误：首先，在我的 AndroidManifest.xml 的这两行中：
我得到根元素后面的文档中的标记必须格式正确，还有我的 R .java 不会生成，无论我清理我的项目多少次。任何答案？

清单在这里：http: [//jsfiddle.net/NHDU6/](http://jsfiddle.net/NHDU6/)

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.jfkingsley.maclogin"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="14"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest>

<!--
     Declare the contents of this Android application.  The namespace
     attribute brings in the Android platform namespace, and the package
     supplies a unique name for the application.  When writing your
     own application, the package name must be changed from "com.example.*"
     to come from a domain that you own or have control over.
-->
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.jfkingsley.maclogin" >

    <uses-permission android:name="android.permission.CALL_PHONE" />
    <uses-permission android:name="android.permission.GET_TASKS" />
    <uses-permission android:name="android.permission.READ_CONTACTS" />
    <uses-permission android:name="android.permission.SET_WALLPAPER" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.EXPAND_STATUS_BAR" />

    <application
        android:icon="@drawable/ic_launcher_home"
        android:label="@string/home_title" >
        <activity
            android:name="Home"
            android:launchMode="singleInstance"
            android:stateNotNeeded="true"
            android:theme="@style/Theme" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.HOME" />
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name="Wallpaper"
            android:icon="@drawable/bg_android_icon"
            android:label="Wallpaper" >
            <intent-filter>
                <action android:name="android.intent.action.SET_WALLPAPER" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

谢谢，乔纳森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T10:19:04.773

这是你的清单，

您不应指定多个标签`Manifest`，并且不应指定多个`<application>` 标签。

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="com.jfkingsley.maclogin" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <uses-permission android:name="android.permission.CALL_PHONE" />
    <uses-permission android:name="android.permission.GET_TASKS" />
    <uses-permission android:name="android.permission.READ_CONTACTS" />
    <uses-permission android:name="android.permission.SET_WALLPAPER" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.EXPAND_STATUS_BAR" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="h" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="Home"
            android:launchMode="singleInstance"
            android:stateNotNeeded="true" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.HOME" />
                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
        <activity
            android:name="Wallpaper"
            android:icon="@drawable/ic_launcher"
            android:label="Wallpaper" >
            <intent-filter>
                <action android:name="android.intent.action.SET_WALLPAPER" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:53:09.753

可能是您遗漏了某些内容，但有时对代码进行简单的重新格式化：CTRL+SHIFT+F 可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T14:42:07.857

我看了你的清单文件。该错误是由于您有 2 个`<manifest />`标签声明而引起的。

它开始于：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.jfkingsley.maclogin"
    android:versionCode="1"
    android:versionName="1.0" > 
```

然后是一些评论，另一个声明开始：

```
<!--
     Declare the contents of this Android application.  The namespace
     attribute brings in the Android platform namespace, and the package
     supplies a unique name for the application.  When writing your
     own application, the package name must be changed from "com.example.*"
     to come from a domain that you own or have control over.
-->
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.jfkingsley.maclogin" >

    <uses-permission android:name="android.permission.CALL_PHONE" /> 
```

您要么忘记评论清单标签之一，混淆了某些东西，要么遵循了错误的教程。AndroidManifest 文件应该只有一个`<manifest />`标签

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-26T09:36:29.133

自动生成的 AndroidManifest.xml 文件本身存在一些问题。里面有两个manifest标签和两个uses-sdk标签。那就是问题所在。执行以下操作： 1- 删除第一个清单标签的结束标签，即： `</manifest>` 2- 删除第二个清单标签的定义标签，即：

```
<manifest 
xmlns:android="http://schemas.android.com/apk/res/android"
package="net.learn2develop.fragments"
android:versionCode="1"
android:versionName="1.0" > 
```

3-如果有两个uses-sdk标签，也删除第二个uses-sdk标签。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-15T17:52:40.893

我向我的应用程序添加了一个新活动，之后它给出了这个错误。清单完全从 android-studio 中消失了。我不得不使用文本编辑器编辑清单。似乎当我添加一个新活动时，Android Studio 创建了一个新标签，然后在清单文件中添加了新的活动标签，而不是仅仅在清单中添加带有新活动的标签。更新清单后，项目运行良好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-05T12:29:50.087

```
<?xml version="1.0" encoding="utf-8"?> 
```

< xmlns:android="http://schemas.android.com/apk/res/android" 包="com.example.groofy">

```
<activity
    android:allowBackup="true"
    android:icon="@mipmap/ic_launcher"
    android:label="@string/app_name"
    android:roundIcon="@mipmap/ic_launcher_round"
    android:supportsRtl="true"
    android:theme="@style/AppTheme"/>
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main"
        android:theme="@style/AppTheme.NoActionBar"/>
    <activity
        android:name=".SignUp"
        android:label="@string/title_activity_sign_up"
        android:theme="@style/AppTheme.NoActionBar"/>

        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>

            <category android:name="android.intent.category.LAUNCHER"/>
        </intent-filter>

</activity>
</application> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-12-31T23:27:25.437

/> 不应该在文件的末尾我有同样的问题错误意味着 xml 文件的格式不正确你应该尝试删除 > 前面的 / 或者只是重新格式化

# android - 当我将应用程序安装到我的设备时，Android 中的奇怪问题

> ID：11668373
> 
> 赞同：1
> 
> 时间：2012-07-26T11:33:46.373
> 
> 标签：android, installation

我在Android中面临一个非常奇怪的问题。

我已经创建了一个 Android 应用程序，所以当我从 Eclipse 将应用程序安装到设备时，它工作正常，没有问题。但是，当我将 apk 文件保存在手机内存或 SD 卡（或通过电子邮件）中，然后在设备上安装 apk 文件时，它会显示一个问题。

当我打开应用程序时，它工作正常，但是当我最小化它并从应用程序开始时，应用程序再次从其第一个活动（不是从我离开的地方）重新启动，但是如果我从最近的应用程序打开应用程序，它会从我离开的地方开始。

我真的不明白是什么问题。

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:41:40.660

这是因为从 eclipse 启动时设置了不同的标志，从包安装程序启动时设置了不同的标志。

尝试这个：

```
1) copy APK to device
2) run APK and install application but don't choose "Open" when installation is over
3) close package installer
4) run your application from launcher 
```

它应该与 eclipse 一样工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T10:01:52.833

您可以在第一个活动的 onCreate() 中检查标志 FLAG_ACTIVITY_BROUGHT_TO_FRONT，如果已设置，则完成。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
if ((getIntent().getFlags() & Intent.FLAG_ACTIVITY_BROUGHT_TO_FRONT) != 0) {
    // Here activity is brought to front, not created,
    // so finishing this will get you to the last viewed activity
    finish();
    return;
    }

// Regular code.
} 
```

# asp.net-mvc - 如何验证用户在asp mvc4的文本框中输入字符串

> ID：11668375
> 
> 赞同：0
> 
> 时间：2012-07-26T11:33:52.980
> 
> 标签：asp.net-mvc

如何验证用户在asp mvc4的文本框中输入字符串？在必需的标签中写什么？

```
 [required] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:37:12.187

`[RegularExpression]`如果您想限制用户只能输入字母字符，请使用该属性。

[有关MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.regularexpressionattribute%28v=vs.95%29.aspx)的更多信息。

[这](https://stackoverflow.com/questions/6067592/regular-expression-to-match-only-alphabetic-characters)是您可以使用的正则表达式的良好链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:38:36.140

这个例子可能有帮助：

```
public class CustomerMetaData
{
// Require that the Title is not null.
// Use custom validation error.
[Required(ErrorMessage = "Title is required.")]
public object Title;

// Require that the MiddleName is not null.
// Use standard validation error.
[Required()]
public object MiddleName;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:39:45.540

有很多方法可以做到这一点

1）在提交页面之前使用纯 Javascript 或 JQuery 检查它是否具有值 2）在控制器方法上检查它是否具有值 3）如果您使用 EF 并且您的视图绑定到模型添加名为 [Required] 的属性该模型的属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T11:44:00.690

你*究竟*想做什么？

确保服务器接收到的对象中包含正确的数据？然后你应该在你的 C# 模型上使用数据属性。但是，“输入字符串”是什么意思？如果用户只需要输入任何字符串，那么就`[Required]`可以工作 - 这只是意味着必须输入**一些**值。您是否只想允许特定的字符集，例如英文字母？然后你需要使用一个`RegularExpression`属性。

如果您进一步指定您实际想要做什么，我相信我们可以为您提供更多帮助。

# javascript - 通过使用 OpenStreetMap API 获得城市名称来显示地图

> ID：11668379
> 
> 赞同：1
> 
> 时间：2012-07-26T11:34:03.940
> 
> 标签：javascript, api, openstreetmap

我可以使用 OpenStreetMap API（如 Google Maps API）直接调出（只知道城市名称而不是坐标）城市地图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T08:35:26.780

您可以使用 nominatim 服务作为中间步骤，在通过 openstreetmap api 获取地图数据之前查找所需地图的坐标。

[http://wiki.openstreetmap.org/wiki/Nominatim#Reverse_Geocoding_.2F_Address_lookup](http://wiki.openstreetmap.org/wiki/Nominatim#Reverse_Geocoding_.2F_Address_lookup)

# mysql - mysql查询到drupal查询

> ID：11668382
> 
> 赞同：1
> 
> 时间：2012-07-26T11:34:33.610
> 
> 标签：mysql, drupal-7

请任何人都可以将此查询转换为drupal db_select

```
 $query="SELECT DISTINCT 'supplier_id','supplier_name','supplier_address','supplier_city', 'supplier_pincode', 'supplier_state', 'supplier_country' FROM pmai_supplier_directory WHERE ";
foreach($list as $k=>$value)
{
    $query.=" supplier_interest LIKE '%".$value."%' OR";
}
$query=substr($query,0,strlen($query)-2);
echo $query.=" ORDER BY supplier_name"; 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:05:38.277

所以查询是：

```
SELECT DISTINCT 'supplier_id','supplier_name','supplier_address','supplier_city',
   'supplier_pincode', 'supplier_state', 'supplier_country' 
FROM pmai_supplier_directory 
WHERE supplier_interest LIKE '%foo%' 
   OR supplier_interest LIKE '%bar%'
   OR supplier_interest LIKE '%baz%'
ORDER BY supplier_name"; 
```

这可以这样做：

```
$list = array('foo','bar','baz');
$query = db_select('pmai_supplier_directory','pmsp')

  ->fields('pmsp',array(
    'supplier_id',
    'supplier_name',
    'supplier_address',
    'supplier_city',
    'supplier_pincode',
    'supplier_state',
    'supplier_country'
  ))
  ->orderBy('supplier_name')
  ->distinct();

  $orCond = db_or();$elt = 0;
  foreach($list as $k => $value) {
    $orCond->condition('pmsp.supplier_interest','%'.$value.'%','LIKE');
    $elt++;
  }
  if ($elt) {
    $query->condition($orCond);
  } 
```

然后你只需要执行并获取结果。

# android - 有没有办法知道拨出电话是否被接受？

> ID：11668383
> 
> 赞同：1
> 
> 时间：2012-07-26T11:34:37.670
> 
> 标签：android, call, audio-recording, phone-state-listener

我正在做一个记录通话的应用程序（它们都是来电和去电）。

我刚刚解决了来电录音的问题，但我发现拨出电话有一些问题。

接下来是我的情况。我只想在接听电话时录制音频，但我不知道该怎么做。我刚刚尝试过使用 PhoneStateListener 类，但是在接受呼叫时呼叫状态不会改变。我有下一个代码：

```
package com.call.record.listeners;

import android.telephony.PhoneStateListener;
import android.telephony.TelephonyManager;
import android.util.Log;

public class OutgoingPhoneStateListener extends PhoneStateListener{

    private String phoneNumber;

    public OutgoingPhoneStateListener(String pn) {
        // TODO Auto-generated constructor stub
        super();
        phoneNumber = pn;
    }

    public void onCallStateChanged(int state, String incomingNumber){

        switch(state){
            case TelephonyManager.CALL_STATE_IDLE:
              Log.d("DEBUG", "IDLE");
            break;
            case TelephonyManager.CALL_STATE_OFFHOOK:
              Log.d("DEBUG", "OFFHOOK");
            break;
            case TelephonyManager.CALL_STATE_RINGING:
              Log.d("DEBUG", "RINGING");
            break;
        }
    }
} 
```

在前面的代码中，当呼叫拨出时

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T14:38:28.100

我认为没有任何非黑客/强大的方法可以找出对方何时接听电话。`CALL_STATE_OFFHOOK`和`MODE_IN_CALL`( `AudioManager`) 都将在拨打电话后立即设置，而不是在对方应答时设置。

您可以做的是即时处理记录的下行链路数据，以尝试检测何时接听电话。希望对方会回答某种问候语，您可以尝试通过分析音频数据来确定对话何时开始来检测这些问候语。或者您可以查看上行链路并使用您对着麦克风说的第一个词作为对话已经开始的信号（因为您不太可能在对方回答之前开始说话）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-01T09:40:31.867

我完全同意迈克尔的观点，没有可靠的方法来找出 android 中的 calle 何时应答呼叫。即电话管理器。**CALL_STATE_OFFHOOK**将在您拨打电话后立即设置。

试试这个例子你就会明白

```
public class BroadcastReceiverImpl extends BroadcastReceiver{

    @Override
    public void onReceive(Context context, Intent intent) {

        Toast.makeText(context, "Monitoring The Network !! ", Toast.LENGTH_LONG).show();
        PhoneStateListnerImpl phoneStateListnerImpl = new PhoneStateListnerImpl(context);
        TelephonyManager telephonyManager = (TelephonyManager) context.getSystemService(context.TELEPHONY_SERVICE);

            telephonyManager.listen(phoneStateListnerImpl, PhoneStateListener.LISTEN_CALL_STATE);

        }

    private class PhoneStateListnerImpl extends PhoneStateListener{

        private Context mContext;

        public PhoneStateListnerImpl(Context mContext) {
            this.mContext = mContext;
        }

        @Override
        public void onCallStateChanged(int state, String incomingNumber) {

            switch (state) {

            case TelephonyManager.CALL_STATE_RINGING:
                 Toast.makeText(mContext, "Phone is Ringng ", Toast.LENGTH_LONG).show();

                break;

            case TelephonyManager.CALL_STATE_OFFHOOK:
                 Toast.makeText(mContext, "Phone is Answered ", Toast.LENGTH_LONG).show();

                break;

            case TelephonyManager.CALL_STATE_IDLE:
                 Toast.makeText(mContext, "Call Is Over ", Toast.LENGTH_LONG).show();

                 abortBroadcast();
                break;

            default:
                break;
            }
        }

    }
}

manifest :

<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.pervazive.monitor_network_v08"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />

    <uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS" />
    <uses-permission android:name="android.permission.READ_PHONE_STATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <receiver
            android:name="com.example.broadcastreceiver.BroadcastReceiverImpl"
            android:enabled="true"
            android:exported="true" >
            <intent-filter>
                <action android:name="android.intent.action.ACTION_PHONE_STATE_CHANGED" />
                <action android:name="android.intent.action.ACTION_NEW_OUTGOING_CALL" />
                <action android:name="android.intent.action.PHONE_STATE" />
                <action android:name="android.intent.action.NEW_OUTGOING_CALL" />
            </intent-filter>
        </receiver>
    </application>

</manifest> 
```

# .net - 为什么要密封单例类？

> ID：11668390
> 
> 赞同：12
> 
> 时间：2012-07-26T11:35:22.437
> 
> 标签：.net, design-patterns, singleton, class-design, sealed

我想知道为什么单例类应该被密封。如果我们将构造函数设置为私有，我们可以阻止派生类吗？.. 下面我从 MSDN 粘贴几行。请给我一些颜色。

> 在这个策略中，实例是在第一次引用类的任何成员时创建的。公共语言运行时负责变量初始化。该类被**标记为密封以防止派生，这可能会添加实例**。有关将类标记为密封的利弊的讨论，请参见 [Sells03]。此外，该变量被标记为只读，这意味着它只能在静态初始化期间（此处显示）或在类构造函数中分配。

[http://msdn.microsoft.com/en-us/library/ff650316.aspx](http://msdn.microsoft.com/en-us/library/ff650316.aspx)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-26T11:52:57.150

> 如果我们将构造函数设为私有，我们可以防止类被派生，对吗？

不*完全*：

```
public class NotReallySingleton
{
    private NotReallySingleton() {}

    public class CursesFoiledAgain : NotReallySingleton
    {
    }
}

...

NotReallySingleton x = new CursesFoiledAgain();
NotReallySingleton y = new CursesFoiledAgain(); 
```

这是可行的，因为`private`访问仅限于该类型的*程序文本*，包括嵌套类型。所以`CursesFoiledAgain`可以访问`NotReallySingleton`.

但是，即使撇开这一点不谈，如果您的*意图*是没有人可以从该类派生，您为什么不想通过 尽可能清楚地表明该意图`sealed`？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T11:38:00.660

关键字表示该类`sealed`不能被继承。将构造函数声明为私有意味着无法创建该类的实例。

这些不是一回事。您可以拥有一个带有私有构造函数的基类，但仍从该基类继承，定义一些公共构造函数，并有效地实例化该基类。

请记住，构造函数不是继承的（因此派生类不会仅仅因为基类有所有私有构造函数），并且派生类总是首先调用基类构造函数。标记类`sealed`可以防止某人在您精心构建的单例类周围进行琐碎的工作，因为它可以防止某人从该类继承。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:37:57.167

这是一种设计指南，很明显，你可以遵循也可以不遵循。这只是标记您的设计意图，例如在基类标记它的情况下，`abstract`以避免将来可能出现混乱。

# java.util.logging - 定期 java 日志记录

> ID：11668396
> 
> 赞同：1
> 
> 时间：2012-07-26T11:35:39.737
> 
> 标签：java.util.logging

我可以使用配置文件根据时间间隔刷新所有日志吗？搜索了很多。没找到。捷径是自己使用 Timer 并刷新所有记录器。但想知道配置文件是否允许。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-15T16:18:10.320

[LogManager](http://docs.oracle.com/javase/7/docs/api/java/util/logging/LogManager.html)文档中解释了配置文件选项。目前，唯一的方法是通过配置文件，使用 'config' 选项安装自定义代码以刷新所有记录器并执行计时器管理。如果您需要访问 JVM 生命周期，您可以创建一个自定义处理程序，该处理程序忽略所有日志记录但侦听构造函数和关闭方法调用。

```
public class FlushAllHandler extends Handler {

    private final ScheduledExecutorService ses;
    private final Future<?> task;

    public FlushAllHandler() {
        //TODO: Look these up from the LogManager.
        super.setLevel(Level.OFF); //Ignore all published records.
        ses = Executors.newScheduledThreadPool(1);
        long delay = 1L;
        TimeUnit unit = TimeUnit.HOURS;
        task = ses.scheduleWithFixedDelay(new Task(), delay, delay, unit);
    }

    @Override
    public void publish(LogRecord record) {
        //Allow a trigger filter to kick off a flush.
        if (isLoggable(record)) {
            ses.execute(new Task());
        }
    }

    @Override
    public void flush() {
    }

    @Override
    public void close() throws SecurityException {
        super.setLevel(Level.OFF);
        task.cancel(false);
        ses.shutdown();
        try {
            ses.awaitTermination(30, TimeUnit.SECONDS);
        } catch (InterruptedException ex) {
            Thread.currentThread().interrupt();
        }
        ses.shutdownNow();
    }

    private static class Task implements Runnable {

        Task() {
        }

        @Override
        public void run() {
            final ArrayList<Handler> handlers = new ArrayList<>();
            final LogManager manager = LogManager.getLogManager();
            synchronized (manager) { //avoid ConcurrentModificationException
                final Enumeration<String> e = manager.getLoggerNames();
                while (e.hasMoreElements()) {
                    final Logger l = manager.getLogger(e.nextElement());
                    if (l != null) {
                        Collections.addAll(handlers, l.getHandlers());
                    }
                }
            }

            //Don't hold LogManager lock while flushing handlers.
            for (Handler h : handlers) {
                h.flush();
            }
        }
    }
} 
```

# wpf - 关于 wpf 网格行删除的 Srange 结果

> ID：11668401
> 
> 赞同：0
> 
> 时间：2012-07-26T11:36:02.627
> 
> 标签：wpf, grid

我有一个关于删除网格的问题：

每当我删除网格中的最后一行或所有行时，网格上仍然会显示一些内容（实际上是最后一行）。我确实检查了 grid.rowdefinitions.count 是否为 0。我使用的方法是 removeAt 和 removeRange(0, grid.rowdefinitions.count)。那有什么问题？谁能告诉我为什么？非常感谢！

```
//------------
<Grid DockPanel.Dock="Top" HorizontalAlignment="Left" Name="grid1" ShowGridLines="true" Width="200" Height="200">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Grid.Column="0" Text="100" />
                <TextBlock Grid.Row="1" Grid.Column="0" Text="200" />
                <TextBlock Grid.Row="2" Grid.Column="0" Text="300" />
                <TextBlock Grid.Row="3" Grid.Column="0" Text="400" />
                <TextBlock Grid.Row="4" Grid.Column="0" Text="500" />
            </Grid>
            <StackPanel HorizontalAlignment="Left" Orientation="Horizontal" Width="200" DockPanel.Dock="Top">
                <Button Width="80" Click="rem5Row">Remove 5 Rows</Button>
            </StackPanel>

//--------------

private void rem5Row(object sender, RoutedEventArgs e)
        {
            if (grid1.RowDefinitions.Count < 5)
            {
                Console.WriteLine("less than 5!");
            }
            else
            {
                grid1.RowDefinitions.RemoveRange(0,grid1.RowDefinitions.Count);
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:52:32.953

我不确定我是否正确理解了您的问题（并且我不确定代码是否反映了您所说的内容）。但是：你怎么知道“最后一行”正在显示？

我怀疑正在发生的是：您正在删除行并期望这些行中的控件也将被删除。但是，这不是 WPF Grid 的工作方式：控件不是其行的子级，并且当您删除`RowDefinition`.

因此，所有子控件仍将呈现，但由于它们`Grid.Row`无效，它们将呈现在“第 0 行”位置。它们以标记顺序呈现，因此最终结果将显示为好像正在显示“最后一行”，因为这是最后绘制的控件。事实上，您的所有控件仍然存在；他们只是在屏幕上的同一个地方。

如果您想确认这一点，您可以使用 Snoop 来检查您的运行时 UI。或者，为您的文本框设置宽度，以便第 0 行框更宽 - 您将清楚地看到重叠。

# macos - HTTP Post/get 流量拦截 - safari

> ID：11668404
> 
> 赞同：1
> 
> 时间：2012-07-26T11:36:16.357
> 
> 标签：macos, http, safari

我正在开发一种安全软件，它需要在 Safari 中阻止带有敏感正文和附件（CCN、SSN.. 等）的电子邮件。

我已经成功地将我的 Bundle 加载到 Safari 进程中，并且正在尝试覆盖 NSURLConnection 和其他用于 HTTP GET/POST 请求的 CFNetwork API。我能够捕获所有 GET 请求，但 HTTP Post 请求没有运气。

我也尝试过编写一个 NPAPI 插件，但没有成功。

我需要在应用程序级别处理它而不使用任何代理。

任何有关在 MAC OS 上拦截 Safari 的 HTTP POST 请求的指针将不胜感激。

谢谢您的帮助。

# facebook - apps.uses 操作不起作用

> ID：11668405
> 
> 赞同：0
> 
> 时间：2012-07-26T11:36:18.500
> 
> 标签：facebook, installation, facebook-opengraph

默认情况下，当用户开始使用应用程序时，用于在时间线中发布的代码“x 开始使用此应用程序”。我看不到这样的代码。我还手动尝试在加载应用程序时使用 access_token 和网站参数向“https://graph.facebook.com/me/apps.uses”发送 curl 请求。它返回 {id:"xxxxx"} 作为响应，这意味着正在调用操作，但它没有在时间轴中更新。我尝试在图形资源管理器中调试响应 ID，这也是完美的。社交发现已打开，应用程序未处于沙盒模式。客户想要我提交的这个代码，它很容易实现，但现在我一无所知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:42:02.377

您不发布这些，它们是由 Facebook 自动创建并出现在股票行情/可用于类型 25 广告

# ios - 无法使用 echo 打印值

> ID：11668409
> 
> 赞同：0
> 
> 时间：2012-07-26T11:36:27.013
> 
> 标签：ios, xcode, run-script

我在 Xcode 中使用运行脚本，我遇到了一些问题

我正在声明如下变量

```
URL1 = "/Users/UserName/Desktop/Folder/13072012/libRestKit.a" 
```

在下面我正在打印它 echo`"Test $URL1 Test"`我也尝试过这样`"Test ${URL1} Test"`

我无法打印`URL1`值，下面我使用这个

`echo "Hello, world!"` 我可以打印这个，我是脚本新手 有什么问题可以帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:40:37.603

尝试不带空格：

```
URL1="/Users/UserName/Desktop/Folder/13072012/libRestKit.a" 
```

`=`在使用 bash 和同一系列的其他 shell 时，放置空格是一个常见的错误。

# apache-camel - Camel - Split() 和 doCatch(....) 不起作用

> ID：11668417
> 
> 赞同：3
> 
> 时间：2012-07-26T11:36:49.803
> 
> 标签：apache-camel

我正在尝试构建一个尝试验证 xml 的路由，如果一切正确，则必须拆分此文件，否则会引发异常并且它必须执行其他操作。所以我做了以下事情：

```
from("file:"+fileOutboxTransformed+"?preMove=inprogress&move="+backupFolderTransformed+"/"+labelMessageType+"_${date:now:yyyyMMddHHmmssSSS}-${file:name.noext}.${file:ext}")
    .log(LoggingLevel.INFO, "Got transformed file and sending it to jms queue: "+queue)
    .doTry()
        .to("validator:classpath:"+validator)
        .split(xPathMessageTypeSplit)
        .to("jms:"+queue+"?jmsMessageType=Text")
    .doCatch(ValidationException.class)
        .log(LoggingLevel.INFO, "Validation Exception for message ${body}")
        .to("xslt:classpath:"+transformationsErrorAfter)
        .split(xPathNotificationSplit)
        .to("file:"+fileOutboxInvalid+"?fileName=${file:name.noext}-${date:now:yyyyMMddHHmmssSSS}.err2")
    .end(); 
```

但它不编译（如果我不使用拆分，那么它会编译并工作）并且错误是：

```
The method doCatch(Class<ValidationException>) is undefined for the type ExpressionNode 
```

所以我尝试了以下

```
from("file:"+fileOutboxTransformed+"?preMove=inprogress&move="+backupFolderTransformed+"/"+labelMessageType+"_${date:now:yyyyMMddHHmmssSSS}-${file:name.noext}.${file:ext}")
    .log(LoggingLevel.INFO, "Got transformed file and sending it to jms queue: "+queue)
    .doTry()
        .to("direct:validate")
    .doCatch(ValidationException.class)
        .log(LoggingLevel.INFO, "Validation Exception for message ${body}")
        .to("xslt:classpath:"+transformationsErrorAfter)
        .split(xPathNotificationSplit)
        .to("file:"+fileOutboxInvalid+"?fileName=${file:name.noext}-${date:now:yyyyMMddHHmmssSSS}.err2")
    .end();

    from("direct:validate")
        .to("validator:classpath:"+validator)
        .to("direct:split_message");

    from("direct:split_message")
        .split(xPathMessageTypeSplit)
        .to("jms:"+queue+"?jmsMessageType=Text"); 
```

这次我得到重复端点的错误

```
 org.apache.camel.FailedToStartRouteException: Failed to start route route312 because of Multiple consumers for the same endpoint is not allowed: Endpoint[direct://validate] 
```

你对如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-31T14:13:01.050

为了从 split() 块（或选择或其他嵌套类型）返回 doTry() 块，您需要使用 endDoTry()。与其名称相反，此方法将结束嵌套的拆分块并返回到 doTry() DSL。

我将使用您发布的第一条路线进行这些更改：

```
from("file:"+fileOutboxTransformed+"?preMove=inprogress&move="+backupFolderTransformed+"/"+labelMessageType+"_${date:now:yyyyMMddHHmmssSSS}-${file:name.noext}.${file:ext}")
    .log(LoggingLevel.INFO, "Got transformed file and sending it to jms queue: "+queue)
    .doTry()
        .to("validator:classpath:"+validator)
        .split(xPathMessageTypeSplit)
            .to("jms:"+queue+"?jmsMessageType=Text")
        .endDoTry()
    .doCatch(ValidationException.class)
        .log(LoggingLevel.INFO, "Validation Exception for message ${body}")
        .to("xslt:classpath:"+transformationsErrorAfter)
        .split(xPathNotificationSplit)
            .to("file:"+fileOutboxInvalid+"?fileName=${file:name.noext}-${date:now:yyyyMMddHHmmssSSS}.err2")
        .endDoTry()
    .end(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:49:54.547

你的第二次尝试似乎很好。您收到的错误是由两条以`from("direct:validate")` Don't you have an other route in your application from the same endpoint? 开头的两条路由引起的吗？

编辑：尝试以不同的方式命名它，也许验证已经存在（在您的应用程序中或骆驼内部）

# extjs - 使用 rowEditing 插件在网格上进行数据编辑不起作用

> ID：11668425
> 
> 赞同：2
> 
> 时间：2012-07-26T11:37:12.517
> 
> 标签：extjs

我正在使用 Ext Js 开发应用程序，但遇到了问题。我正在使用 RowEditing 插件来编辑我的行，用户还可以在网格中添加动态列和行。但是，当用户编辑该行时，只有第一列，即数据类型列，接受并显示编辑，其余接受编辑但不显示数据，如下图所示。

编辑前：

![在此处输入图像描述](../Images/ded01a637b90a095c09545815bfcaab2.png)

编辑后，点击更新按钮：

如您所见，其余列上的数据没有出现。

![在此处输入图像描述](../Images/33569b7b78e92e349d8e5ba85868ab47.png)

我的代码如下所示：

```
var store = Ext.getStore('StoreTemp');
var rowEditing = Ext.create('Ext.grid.plugin.RowEditing');
var contador = 1;
var contadorLinhas = 0;
Ext.define('Grid', {
extend : 'Ext.grid.Panel',
title: 'Grid',
store: 'StoreTemp',
columns: [ 
        {
         xtype: 'rownumberer',
     },{    
         header : "Data Type",
         dataIndex : 'nome',
         flex : 1,
         editor:'textfield'
     }],            
dockedItems : [ {
    xtype : 'toolbar',
    items : [ {
        xtype: 'button',
        tooltip: 'Click here to set data type on axis Y',
        id : 'buttonTipoDado',
        icon : Webapp.icon('edit.png'),
        iconAlign : 'top',
        handler : function() {
            var gridView = Ext.ComponentQuery.query('gridpanel')[1];
            Ext.Msg.prompt('Alert', 'Insert data type on axis Y', function(
                    btn, text) {
                if (btn == 'ok') {
                    gridView.getView().getHeaderAtIndex(1).setText(text);
                    var botao = Ext.getCmp('buttonTipoDado');
                    botao.setDisabled(true);
                } else {
                    Ext.Msg.alert('Alert', 'Insert a type!');
                }
                gridView.getView().refresh();
            });
        }
    }, {
        xtype: 'button',
        icon : Webapp.icon('add1.png'),
        iconAlign : 'top',
        handler : function() {
            var gridView = Ext.ComponentQuery.query('gridpanel')[1];
            grid = gridView.headerCt;
            if(grid.getGridColumns().length >= 1){
                var column = Ext.create('Ext.grid.column.Column', {dataIndex: 'column', text : contador, editor: {xtype: 'textfield', flex: 0.5, editable: true}});
                grid.insert(gridView.columns.length, column);
                gridView.getView().refresh();
                var botao = Ext.getCmp('buttonRemoverColuna');
                botao.setDisabled(false);
            }
            contador++;
        }
    }, {
        xtype: 'button',
        icon : Webapp.icon('cancel.png'),
        iconAlign : 'top',
        id : 'buttonRemoverColuna',
        handler : function() {
            var gridView = Ext.ComponentQuery.query('gridpanel')[1];
            gridView = gridView.headerCt;
            var botao = Ext.getCmp('buttonRemoverColuna');
            console.log(gridView.getGridColumns().length);
            if(gridView.getGridColumns().length == 2){
                console.log(gridView.getGridColumns().length);
                botao.setDisabled(true);    
                contador = 1;
            }
            else{
                gridView = gridView.remove(gridView.getGridColumns().length - 1);               
            }
        }
    }, {
        xtype: 'button',
        icon : Webapp.icon('add1.png'),
        iconAlign : 'top',
        handler: function(){
            var gridView = Ext.ComponentQuery.query('gridpanel')[1];
            store.insert(contadorLinhas, new Ext.create('model'));
            rowEditing.startEdit(0, 0); 
            contadorLinhas++;
            gridView.getView().refresh();
            if(contadorLinhas > 0){
                botao = Ext.getCmp('buttonRemoverLinha'),
                botao.setDisabled(false);
            }
        }   
    }, {
        xtype: 'button',
        icon : Webapp.icon('cancel.png'),
        iconAlign : 'top',
        id: 'buttonRemoverLinha',
        handler: function(botao){
            store.removeAt(contadorLinhas - 1);
            contadorLinhas--;
            if(contadorLinhas == 0){
                botao.setDisabled(true);
            }
        }   
    }]
} ],
plugins : [ rowEditing ]

});

Ext.define('model', {
extend : 'Ext.data.Model',
fields : [ {
    name : 'id',
    type : 'long'
}, {
    name : 'nome',
    type : 'string'
}, {
    name : 'column',
    type : 'array'
} ]
}); 
```

谁能给我一个见解？？谢谢。

# java - 如何使用 DOM 追加现有 XML 文件而不覆盖现有数据？

> ID：11668429
> 
> 赞同：1
> 
> 时间：2012-07-26T11:37:38.993
> 
> 标签：java, xml, dom, append

我创建了一个简单的 XML 文件，我在其中编写了一些我在每次批处理运行时收集的推文。**我希望在每次批处理运行时附加而不是重写文件**。目前它正在覆盖每批运行的当前文档。

可以帮我解决这个问题！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:25:22.293

用这个：

```
FileWriter writer = new FileWriter(file,true); 
```

这将以追加模式打开文件。

请注意，如果您有以下情况，它可能会导致问题：

```
<root>
    <sometag></sometag>
</root> 
```

然后你再次附加相同的结构，下次你读取文件时，你会得到：

```
 <root>
        <sometag></sometag>
    </root>
 <root>
        <sometag></sometag>
    </root> 
```

这是无效的。因此，如果您稍后需要解析此 xml，则必须这样做：

1.  读取整个 xml 内容。
2.  向文档对象添加新元素（使用 DOM 解析器）
3.  将更新的文档写入文件（覆盖旧数据）。

# sql - 将位列转换为整数

> ID：11668431
> 
> 赞同：26
> 
> 时间：2012-07-26T11:37:49.083
> 
> 标签：sql, sql-server

我正在通过 SQL 脚本将特定表的位列转换为整数（该表对默认值有一些默认约束）。

我必须更改表的列，而不是运行时强制转换，可以使用什么脚本来完成此操作？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-07-26T11:43:00.783

尝试使用`CAST(columnName AS INT) AS IntValue`.

例如

```
SELECT columnName, CAST(columnName AS INT) AS IntValue
FROM table 
```

**或者**你可以使用`CONVERT(INT, columnName) AS IntValue`.

**更新**：如果您需要更改表的实际元数据，那么您首先需要删除约束然后更改列：

IE

```
ALTER TABLE [Table] DROP CONSTRAINT [ConstraintName];
GO
ALTER TABLE [Table] ALTER COLUMN [ColumnName] INT; 
```

然后重新创建您需要的任何约束。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T11:52:30.817

如果您担心更改列的数据类型，可以使用 ALTER 查询，如下所示。

```
ALTER TableName ALTER COLUMN ColumnName INT 
```

否则，仅出于显示目的，您可以使用`CAST`or`CONVERT`函数：

```
CAST(columnName AS INT) AS IntegerVal
CONVERT(int, columnName) AS IntValue 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-27T07:12:40.367

最后我设法让它工作：

```
ALTER TABLE tblname DROP CONSTRAINT DF_tbl_tblname_tblcol
ALTER TABLE tblname ALTER COLUMN tblcol int not null
ALTER TABLE tblname WITH NOCHECK ADD CONSTRAINT [DF_tbl_tblname_tblcol] DEFAULT (0) FOR tblcol 
```

我已经使用上述 SQL 语句来更改表列及其构造函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T11:57:55.883

我们不能简单地将 BIT 列更改为 INT。所以我建议在表中创建新的整数列，然后使用 CAST，用现有的位值更新新的整数列。最后，您可以从表中删除 BIT 列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-10T10:39:04.793

SELECT CONVERT(BIT,'False') AS test1 SELECT CONVERT(BIT,'True') AS test2

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T11:45:08.083

`CAST()`我相信您可以仅使用标准命令将位列提取为整数：

```
SELECT
  CAS(Bit_Column AS int) AS Int_Column
FROM
  YourTable 
```

但是，我不确定我是否理解您要实现的目标，如果您提供更多详细信息（例如表的结构及其约束），您可能会得到更好的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T12:07:48.513

您收到与默认约束相关的错误。因此，您必须在更改列数据类型之前删除该约束...

试试这个来找到基于这个表的所有约束（你只需要在你的列上找到正确的默认值）或者使用[SQL Server Management Studio](http://en.wikipedia.org/wiki/SQL_Server_Management_Studio) (SSMS) 来为表生成脚本，这将具有默认的约束定义。

```
select * from sys.all_objects where parent_object_id  = object_id('<tablename>')
go 
```

然后首先删除约束，然后更改列并再次添加默认值。

```
alter table bittoint drop constraint DF__bittoint__col2__45D500F0
go
alter table bittoint alter column col2 int
go
alter table bittoint add constraint DF__bittoint__col2__45D500F0 default 0 for col2
go 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-29T11:59:35.897

提供的解决方案都不适合我。我不得不使用有符号或无符号而不是 INT 例如

SELECT columnName, CAST(columnName AS SIGNED) AS IntValue FROM table

希望这对新用户有所帮助。

# android - GreenDroid 分页视图 - 检测是否为最后一页

> ID：11668432
> 
> 赞同：0
> 
> 时间：2012-07-26T11:37:54.293
> 
> 标签：android, greendroid

我做了一个类`MyPagedView`扩展`GDActivity`并有一个`PagedView`.

我实现了一个工作`PagedAdapter`类`MyPagedAdapter`。

> 一旦显示最新页面，我希望能够退出 PagedView 以对我的 Android 应用程序进行教程/介绍。

请帮助我，一旦幻灯片结束，我就找不到正确的触发方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:02:05.470

使用[ViewPager.OnPageChangeListener](http://developer.android.com/reference/android/support/v4/view/ViewPager.OnPageChangeListener.html) .. 这`onPageSelected(int position)`很可能是您需要的回调。

```
void onPageChanged(int position) {
    if (position == pageCount-1) {
       /* you are on last page */
    }
} 
```

# java - 在 DOM 解析器中存储 XML 数据

> ID：11668433
> 
> 赞同：0
> 
> 时间：2012-07-26T11:37:56.073
> 
> 标签：java, xml-parsing, domparser

> **可能重复：**
> [如何在 Dom 解析器中修改 XML 数据](https://stackoverflow.com/questions/11666140/how-to-modify-xml-data-in-dom-parser)

我是 Java 和 XMl DOm 解析器的新手。我有一个要求，比如读取 xml 数据并将其存储为列和行类型的通知。这是一个示例代码

```
ki need to read this XMl file and store it in the above format:

 Expected Output"
      swetha,Eunis,swetha,10000
        john,MAdiv,Jo,200000 
```

但是我在它们之间得到了空格，对于 4 个标签，4 个空格即将输出以下代码：

```
 swetha,Eunis,swetha,10000

        john,MAdiv,Jo,200000 
```

Java 代码：

```
 NodeList nl= doc.getElementsByTagName("*");
            for(int i=1;i< nl.getLength();i++)
            {
                Element section = (Element) nl.item(i);
                Node title = section.getFirstChild();
                    while (title != null && title.getNodeType() != Node.ELEMENT_NODE)
                            {
                                title = title.getNextSibling();
                                if (title != null)
                                {
                                    String first=title.getFirstChild().getNodeValue().trim();
                                    if(first!=null)
                                    {
                                        title = title.getNextSibling();
                                        System.out.print(first + ",");
                                        br.write(first + ",");
                                    }
                                } 

                            }//WHILE
                    br.write("/n");
                    System.out.print("\n");
              } 
```

我无法找到如何删除行之间的 spces。

# mongodb - MongoDB - 组合多个数值范围查询（C# 驱动程序）

> ID：11668439
> 
> 赞同：1
> 
> 时间：2012-07-26T11:38:01.270
> 
> 标签：mongodb, mongodb-.net-driver

*这里是Mongo新手

我有一个包含数百个数字字段的文档，我需要组合查询这些字段。

```
var collection = _myDB.GetCollection<MyDocument>("collection");
IMongoQuery mongoQuery; // = Query.GT("field", value1).LT(value2);
foreach (MyObject queryObj in Queries)
{
    // I have several hundred fields such as Height, that are in queryObj
    // how do I build a "boolean" query in C# 
    mongoQuery = Query.GTE("Height", Convert.ToInt16(queryObj.Height * lowerbound));
} 
```

我有数百个字段，例如高度（例如宽度、面积、周长等），在 queryObj 中我如何在 C# 中构建一个“布尔”查询，将每个字段的范围查询结合起来。

我尝试使用示例 Query.GT("field", value1).LT(value2);，但是编译器不接受 LT(Value) 构造。无论如何，我需要能够通过循环遍历每个数字字段值来构建复杂的布尔查询。

感谢您帮助新手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:45:55.493

**编辑 3：**

好的，看起来您已经有了构建复杂查询的代码。在这种情况下，您只需要修复编译器问题。我假设您要执行以下操作`(x > 20 && x < 40) && (y > 30 && y < 50)`...

```
var collection = _myDB.GetCollection<MyDocument>("collection");
var queries = new List<IMongoQuery>();

foreach (MyObject queryObj in Queries)
{
    //I have several hundred fields such as Height, that are in queryObj
    //how do I build a "boolean" query in C# 

    var lowerBoundQuery = Query.GTE("Height", Convert.ToInt16(queryObj.Height * lowerbound));
    var upperBoundQuery = Query.LTE("Height", Convert.ToInt16(queryObj.Height * upperbound));

    var query = Query.And(lowerBoundQuery, upperBoundQuery);
    queries.Add(query);
}

var finalQuery = Query.And(queries); 
/*
    if you want to instead do an OR,
    var finalQuery = Query.Or(queries); 
*/ 
```

* * *

原始答案。

```
var list = _myDb.GetCollection<MyDoc>("CollectionName")
                .AsQueryable<MyDoc>()
                .Where(x => 
                         x.Height > 20 && 
                         x.Height < 40)
                .ToList(); 
```

> 我尝试使用示例 Query.GT("field", value1).LT(value2);，但是编译器不接受 LT(Value) 构造。

如果您使用的是官方 C# 驱动程序，则可以使用 linq 查询 MongoDB。这应该可以解决我认为的编译器问题。

我想到的更有趣的问题是，你将如何构造那个复杂的布尔查询？

一种选择是动态构建一个`Expression`，然后将其传递给`Where`

我的同事正在使用以下代码进行类似的操作...

```
 public static IQueryable<T> Where<T>(this IQueryable<T> query,
        string column, object value, WhereOperation operation)
    {
        if (string.IsNullOrEmpty(column))
            return query;

        ParameterExpression parameter = Expression.Parameter(query.ElementType, "p");

        MemberExpression memberAccess = null;
        foreach (var property in column.Split('.'))
            memberAccess = MemberExpression.Property
               (memberAccess ?? (parameter as Expression), property);

        //change param value type
        //necessary to getting bool from string
        ConstantExpression filter = Expression.Constant
            (
                Convert.ChangeType(value, memberAccess.Type)
            );

        //switch operation
        Expression condition = null;
        LambdaExpression lambda = null;
        switch (operation)
        {
            //equal ==
            case WhereOperation.Equal:
                condition = Expression.Equal(memberAccess, filter);
                lambda = Expression.Lambda(condition, parameter);
                break;
            //not equal !=
            case WhereOperation.NotEqual:
                condition = Expression.NotEqual(memberAccess, filter);
                lambda = Expression.Lambda(condition, parameter);
                break;
            //string.Contains()
            case WhereOperation.Contains:
                condition = Expression.Call(memberAccess,
                    typeof(string).GetMethod("Contains"),
                    Expression.Constant(value));
                lambda = Expression.Lambda(condition, parameter);
                break;
        }

        MethodCallExpression result = Expression.Call(
               typeof(Queryable), "Where",
               new[] { query.ElementType },
               query.Expression,
               lambda);

        return query.Provider.CreateQuery<T>(result);
    }

public enum WhereOperation
{
    Equal,
    NotEqual,
    Contains
} 
```

目前它只支持`==`&& `!=`，但它应该不难实现`>=`或`<=`......

您可以从 Expression 类中获得一些提示：http: [//msdn.microsoft.com/en-us/library/system.linq.expressions.expression.aspx](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression.aspx)

**编辑：**

```
var props = ["Height", "Weight", "Age"];
var query = _myDb.GetCollection<MyDoc>("CName").AsQueryable<MyDoc>();
foreach (var prop in props) 
{
   query = query.Where(prop, GetLowerLimit(queryObj, prop), WhereOperation.Between, GetUpperLimit(queryObj, prop));  
}
// the above query when iterated over, will result in a where clause that joins each individual `prop\condition` with an `AND`. 
// The code above will not compile. The `Where` function I wrote doesnt accept 4 parameters. You will need to implement the logic for that yourself. Though it ought to be straight forward I think... 
```

**编辑2：**

如果你不想使用 linq，你仍然可以使用 Mongo Query。您只需要使用`Query.And()`and来制作您的查询`Query.Or()`。

```
 // I think this might be deprecated. Please refer the release notes for the C# driver version 1.5.0  
        Query.And(Query.GTE("Salary", new BsonDouble(20)), Query.LTE("Salary", new BsonDouble(40)), Query.GTE("Height", new BsonDouble(20)), Query.LTE("Height", new BsonDouble(40)))

        // strongly typed version
        new QueryBuilder<Employee>().And(Query<Employee>.GTE(x => x.Salary, 40), Query<Employee>.LTE(x => x.Salary, 60), Query<Employee>.GTE(x => x.HourlyRateToClients, 40), Query<Employee>.LTE(x => x.HourlyRateToClients, 60)) 
```

# asp.net-mvc - asp.net mvc3 - 从外部应用程序调用控制器操作

> ID：11668442
> 
> 赞同：0
> 
> 时间：2012-07-26T11:38:14.810
> 
> 标签：asp.net-mvc, wcf

我有一个用 RavenDB 构建的 asp.net mvc3 应用程序，我希望能够通过外部 HTML5 移动应用程序访问数据。我正在考虑通过 WCF 或通过 MVC 控制器操作方法公开方法？哪个选项最好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:46:46.753

由于您已经在 MVC3 中构建了应用程序，我建议在 MVC 控制器上执行 JsonResult 操作：[http ://www.asp.net/ajaxlibrary/jquery_json_data_from_controller.ashx](http://www.asp.net/ajaxlibrary/jquery_json_data_from_controller.ashx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:47:11.563

好的，我前一段时间也遇到过类似的情况。这是我处理它的方式，我直接向移动应用程序客户端公开了控制器 url。基本上，它将帮助您减轻维护两个代码库的负担，并帮助您重用现有功能。即使您使用 WCF，您也需要使用 REST 公开以使 HTML5 客户端开发人员的生活更轻松。

这就是为什么微软发布 ASP.NET MVC 4 Web API 以避免开发人员混淆在这些场景中应该走哪条路。这样您的服务与设备无关并且易于测试。

# css - 仅当 URL 没有片段标识符时才显示 div

> ID：11668443
> 
> 赞同：2
> 
> 时间：2012-07-26T11:38:16.077
> 
> 标签：css, html, fragment-identifier

很难解释我的意思，所以先看看这个 jsfiddle：http: [//jsfiddle.net/Gsggy/](http://jsfiddle.net/Gsggy/)

当用户点击 1 时，显示 1 号 div，其他相同，非常简单。

但是，在用户点击一个数字之前，那里没有 div，因为它依赖于 URL 中的 # 值

如何设置一个带有空白网址的默认 div，例如 www.jsfiddle.com 但是当有人单击一个数字并将其变为 www.jsfiddle.com/#1 时消失

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:44:38.073

问题是你不能真正以一个元素为目标，告诉它“在其他人是目标时做某事”。

然而，有一些解决方法可以解决这个困境。一种解决方案是始终显示默认内容并显示上面的目标元素。

您可以使用这样一个事实，即 dom 中较晚出现的元素通常呈现在较早出现的节点之上。因此，您可以让例如负上边距或绝对定位元素覆盖您的默认内容。

改进您的 html 结构：

```
<div class="default" id="z">0</div>
<div id="a">1</div>
<div id="b">2</div>
<div id="c">3</div> 
```

这个 CSS 确实有效：

```
.default {
    display: block;
    background: #eff;
}

div + div {
    margin-top: -102px;
}

div:target {
    background: #eef;
    display: block;
    position: relative;
} 
```

这种特定方法的缺点是您需要知道默认内容的确切尺寸。

看到这个小提琴：http: [//jsfiddle.net/Gsggy/4/](http://jsfiddle.net/Gsggy/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:27:06.313

使用 nth-of-type 或 last-of-type 选择器并在最后创建一个默认 div 我认为它适用于您的情况

# ripple - 在波纹模拟器（mac os x）上运行 bb10 示例应用程序

> ID：11668445
> 
> 赞同：1
> 
> 时间：2012-07-26T11:38:28.213
> 
> 标签：ripple, blackberry-10

我按照以下说明操作： [https ://developer.blackberry.com/html5/documentation/use_the_ripple_emulator_chrome_extension_2007542_11.html](https://developer.blackberry.com/html5/documentation/use_the_ripple_emulator_chrome_extension_2007542_11.html)

运行远程站点应用程序项目，它可以工作。但是当我在本地磁盘上测试样本（bbui.js 样本）时

BB10 文档说： [https ://developer.blackberry.com/html5/documentation/accessing_a_local_project_in_ripple_1948645_11.html](https://developer.blackberry.com/html5/documentation/accessing_a_local_project_in_ripple_1948645_11.html)

所以我将 bbuijs 示例项目复制到 Mac OS：/Users//RippleSites.samples

但是当我将 chrome 指向 localhost:9910/samples/index.htm （波纹模拟器扩展）

![在此处输入图像描述](../Images/44d19dc2f1176592732c0606947f2f7a.png)

Chrome 说无法连接到 localhost:9910

![在此处输入图像描述](../Images/8eb9ff9671195b953f6a132bf3b2d347.png)

有什么不对的吗？

我需要运行网络服务器共享吗？

![在此处输入图像描述](../Images/7f89d92ea7ca132c7c3c971d57e9ef5c.png)

欢迎任何评论

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T18:17:16.137

在这里最简单的事情就是启用“网络共享”（你的最后一张照片）。创建从 Web 服务器的主目录到您的示例的符号链接。所以：

```
cd /Library/WebServer/Documents/
ln -s <path to your samples> <name of dir> 
```

注意：您可能必须在最后一个命令之前使用“sudo”。

然后你应该能够去 127.0.0.1/(name of dir) 并且它应该适合你。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T11:29:18.257

我在带有 Ripple 模拟器版本 0.9.10（测试版）的 Chrome 中的 Windows 7 上遇到了同样的问题（“无法连接到 localhost:9910”）

[https://developer.blackberry.com/html5/documentation/accessing_a_local_project_in_ripple_1948645_11.html](https://developer.blackberry.com/html5/documentation/accessing_a_local_project_in_ripple_1948645_11.html)上的文档 确实提到了如何安装 Chrome 扩展。但它没有提到 Chrome 中的 Ripple 按钮有一个弹出窗口，您可以在其中启动在端口 9910 上运行的本地服务。

我采取的步骤是：

*   [按照https://developer.blackberry.com/html5/documentation/enabling_the_ripple_emulator.html](https://developer.blackberry.com/html5/documentation/enabling_the_ripple_emulator.html)打开厨房水槽示例
*   这使您可以看到 Ripple 模拟器工作。
*   [按照https://developer.blackberry.com/html5/documentation/accessing_a_local_project_in_ripple_1948645_11.html](https://developer.blackberry.com/html5/documentation/accessing_a_local_project_in_ripple_1948645_11.html)中的说明创建本地目录
*   然后您将能够看到服务按钮并启动服务。
*   通过 loaclhost:9910/ 打开本地项目

选项菜单的图像：

[![启动停止服务](../Images/c3916dfd1a3aace9e56f8e473ff6bab8.png)](https://i.stack.imgur.com/rwuTb.png)
[（来源：[escay.nl](http://escay.nl/stackoverflow/RippleServices.png)）]

# python - pandas DataFrame 类型转换

> ID：11668446
> 
> 赞同：1
> 
> 时间：2012-07-26T11:38:30.007
> 
> 标签：python, numpy, pandas

`astype`我正在尝试使用该函数以与 NumPy 中使用的方式相同的方式转换 DataFrame 的类型。

首先在 NumPy 中：

```
In [175]: x = np.rec.array([('a','1'),('b','2')],names='col1,col2')

In [176]: x
Out[176]: 
rec.array([('a', '1'), ('b', '2')], 
    dtype=[('col1', '|S1'), ('col2', '|S1')])

In [177]: dt=[('col1', '|S1'), ('col2', 'i8')]

In [178]: x.astype(dt)
Out[178]: 
rec.array([('a', 1), ('b', 2)], 
    dtype=[('col1', '|S1'), ('col2', '<i8')]) 
```

然后在熊猫中：

```
In [182]: y = DataFrame([('a','1'),('b','2')], columns=['col1','col2'])

In [183]: y
Out[183]: 
  col1 col2
0    a    1
1    b    2

In [184]: y.astype(dt)
Out[184]: ---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
...
NotImplementedError: Not implemented for this type 
```

我正在使用 pandas 0.7.3 和来自[http://pandas.sourceforge.net/generated/pandas.DataFrame.astype.html](http://pandas.sourceforge.net/generated/pandas.DataFrame.astype.html)的 pandas 0.7.0 文档。怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:30:56.780

DataFrame 不是结构化数组，因此在数据类型方面的功能不同。您在此处显示的记录数组操作没有等效的 API（至少据我所知）。

# jquery - 逐字显示动画在 IE 中不起作用

> ID：11668465
> 
> 赞同：0
> 
> 时间：2012-07-26T11:39:47.333
> 
> 标签：jquery, animation, explorer

有谁知道为什么下面的代码在 IE 中不起作用？（在其他浏览器中运行良好）

```
 div.hide().contents().each(function() {
                var words;
                if (this.nodeType === 3) {
                    words = '<span> ' + this.data.split(/\s+/).join(' </span><span> ') + ' </span>';
                    $(this).replaceWith(words);
                } else if (this.nodeType === 1) {
                    this.innerHTML = '<span> ' + this.innerHTML.split(/\s+/).join(' </span><span> ') + ' </span>';
                }
            });

            // Remove any empty spans that were added
            div.find('span').hide().each(function() {
                if( !$.trim(this.innerHTML) ) {
                    $(this).remove();
                }
            });

            div.show().find('span').each(function(i) {
                $(this).css('filter', 'alpha(opacity=40)');
                $(this).delay(400 * i).fadeIn(600);
            }); 
```

任何解决方法可以在 IE 中使用逐字显示效果？

编辑：

在这里创建了一个小提琴：http: [//jsfiddle.net/8dh3F/](http://jsfiddle.net/8dh3F/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T01:44:28.513

问题在于这条线。它适用于 IE9，但不适用于 8 或 7。

`this.innerHTML = '<span> ' + this.innerHTML.split(/\s+/).join(' </span><span> ') + ' </span>';`

这不喜欢`this.innerHTML`。谢天谢地，您使用的是 jQuery！

改用这个：

```
$(this).html(function(index, oldhtml){
    return '<span> ' + oldhtml.split(/\s+/).join(' </span><span> ') + ' </span>';
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T09:10:48.747

好的，我找到了一种在 IE 中逐字母显示的方法（也可以在其他浏览器中使用），使用 lettering.js 库：

HTML 标记：

```
<div class='intro'>
    <div class='starthidden intro'>{{ poem.introLine1 }}</div>
    <div class='starthidden intro'>{{ poem.introLine2 }}</div>
    <div class='starthidden intro'>{{ poem.introLine3 }}</div>
    <div class='starthidden intro'>{{ poem.introLine4 }}</div>
    <div class='starthidden intro'>{{ poem.introLine5 }}</div>
    <br>
</div>
<div class='verse'>
    <div class='starthidden trait'>{{ poem.traitLine1 }}</div>
    <div class='starthidden trait'>{{ poem.traitLine2 }}</div>
    <div class='starthidden trait'>{{ poem.traitLine3 }}</div>
    <div class='starthidden trait'>{{ poem.traitLine4 }}</div>
    <div class='starthidden trait'>{{ poem.traitLine5 }}</div>
    <br>
</div>
etc 
```

查询：

```
var div = $('.starthidden');
var delay = 400;
var fadeIn = 600;
div.lettering();
div.find('span').hide();
div.show().find('span').each(function(i) {
   $(this).delay(delay * i).fadeIn(fadeIn);
}); 
```

# javascript - 由于 Content-Security-Policy 拒绝执行内联事件处理程序

> ID：11668469
> 
> 赞同：4
> 
> 时间：2012-07-26T11:39:54.127
> 
> 标签：javascript, google-chrome, google-chrome-extension, content-security-policy

我需要在此处进行哪些更改，以便 JavaScript 代码与清单版本 2 和安全策略一起使用？

截屏：
[![截屏](../Images/0c805944b145d634eee390ad75693c7f.png)](https://fs.fnkr.net/q9ueLwfqKVlQ)

代码：

```
function init()
{
    chrome.tabs.getSelected(null, function(tab)
    {
        url = tab.url;
        if(url.indexOf('chrome://') == -1 && url.indexOf('about:blank') == -1){
            document.main.q.value = url;
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-18T13:46:02.700

在将 HTML 文件中的 JavaScript 代码放入自己的文件并将以下内容添加到清单文件后，我得到了它的工作：

```
"content_scripts": [ {"js": [ "popup.html" ], "matches": [ "http://*/" ]} ],
"permissions": [ "tabs" ] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T15:34:37.993

内联事件处理程序定义必须重写`addEventListener`并提取到 中`popup.js`，因此您应该删除`onfocus="this.select()"`中的`popup.html`，并在 中`popup.js`添加以下行：

```
document.addEventListener('DOMContentLoaded', function () {
  document.getElementById('address_box').addEventListener('onfocus', this.select);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T00:19:34.580

确保您使用的是最新版本的库。我不认为您使用的是 jQuery，但如果您确定您使用的是支持 CSP 的最新版本。 [http://bugs.jquery.com/ticket/11249](http://bugs.jquery.com/ticket/11249)

当您更新到清单版本 2 时，扩展和库代码都需要支持 CSP。

# android - 带有 webview 的 Android Imagemap

> ID：11668472
> 
> 赞同：2
> 
> 时间：2012-07-26T11:40:04.417
> 
> 标签：android, webview

我正在尝试制作类似于[AndroidImageMap](https://github.com/catchthecows/AndroidImageMap)的图像映射。现在，我需要知道与 android webview 相同的实现是否可行？因为，图像映射可以在服务器端进行处理并实现为 HTML 图像映射。如果我们使用在 webview 中显示 HTML 图片映射的 URL，那么如何从点击的 webview 坐标中识别点击事件呢？

注意：单击相应的图像地图坐标时，我需要执行尊重的操作。

# python - 从一个字符串中添加 2 个字典条目

> ID：11668477
> 
> 赞同：2
> 
> 时间：2012-07-26T11:40:21.393
> 
> 标签：python, python-2.7

假设我有以下代码：

```
new_dict = {}
text = "Yes: No Maybe: So" 
```

我想将字符串拆分为 2 个字典元素，如下所示：

```
new_dict = {'Yes':'No', 'Maybe':'So'} 
```

我尝试以相同的方式将字符串拆分为一个列表，以简要了解如何执行此操作，但我没有取得太大的成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:43:58.913

```
text = "Yes: No Maybe: So"
words = [w.rstrip(':') for w in text.split()]
new_dict = dict(zip(words[::2], words[1::2])) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T11:43:55.120

如果每个冒号后跟一个空格，`str.split()`则对您来说很好：

```
tokens = (s.rstrip(":") for s in text.split())
new_dict = dict(zip(tokens, tokens)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:47:58.753

```
>>> import re
>>> text = "Yes: No Maybe: So"
>>> dict(re.findall(r'(\w+): (\w+)', text))
{'Maybe': 'So', 'Yes': 'No'} 
```

或更高效：

```
>>> dict(m.groups() for m in re.finditer(r'(\w+): (\w+)', text))
{'Maybe': 'So', 'Yes': 'No'} 
```

# iphone - 核心位置的委托错误

> ID：11668480
> 
> 赞同：1
> 
> 时间：2012-07-26T11:40:33.563
> 
> 标签：iphone, objective-c, delegates, core-location

我设置了自己的位置检索类，如 Apple 的核心位置文档中所述。

`MyCLControl.h`：

```
@protocol MyCLControllerDelegate

@required
- (void)locationUpdate:(CLLocation *)location;
- (void)locationError:(NSError *)error;
@end

@interface MyCLController : NSObject <MyCLControllerDelegate, CLLocationManagerDelegate> {
    CLLocationManager *locationManager;
    id <MyCLControllerDelegate> delegate;
}

@property (nonatomic, retain) CLLocationManager *locationManager; 
@property (strong) id <MyCLControllerDelegate> delegate;

- (void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation;

- (void)locationManager:(CLLocationManager *)manager
       didFailWithError:(NSError *)error;

- (BOOL) connected;
@end 
```

在`MyCLController.m`中，`init`and`locationManager:didUpdateToLocation:fromlocation`方法：

```
- (id) init {
    self = [super init];
    if (self != nil) {
        self.locationManager = [[CLLocationManager alloc] init];
        self.locationManager.delegate = self;
        //locationManager.desiredAccuracy = kCLLocationAccuracyKilometer;
    }
    return self;
}

- (void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation
{
    [self.delegate locationUpdate:newLocation];
} 
```

我叫它的方式如下：

```
- (void)viewDidLoad {
    MyCLController *locationController = [[MyCLController alloc] init];
    locationController.delegate = locationController.self;
    [locationController.locationManager startUpdatingLocation];
}

- (void)locationUpdate:(CLLocation *)location {
    NSLog(@"%@", location);
} 
```

`[MyCLController locationUpdate:]: unrecognized selector sent to instance`一旦命中，我会收到运行时错误`[self.delegate locationUpdate:newLocation]`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:43:54.623

你已经做了`MyCLController`自己的代表？您确定要让视图成为委托吗？

您还需要使用以下方法检查委托是否支持该方法（即使它是`required`）：

```
- (void)locationManager:(CLLocationManager *)manager
    didUpdateToLocation:(CLLocation *)newLocation
           fromLocation:(CLLocation *)oldLocation
{
    if ([self.delegate respondsToSelector:@selector(locationUpdate:)])
    {
        [self.delegate locationUpdate:newLocation];
    }
} 
```

# performance - 如何处理替代业务流程

> ID：11668486
> 
> 赞同：1
> 
> 时间：2012-07-26T11:40:53.213
> 
> 标签：performance, architecture, business-logic

我的应用有很多模块，原来的业务流程是这样的：

> A -> B -> C -> D

随着应用程序的增长，将添加替代流程以满足客户的需求：

> A -> B -> C -> D
> 
> A -> B -> C' -> D（C 现在可以执行可选操作）
> 
> A -> D
> 
> A -> D' (D 现在可以执行 C 的可选操作)

单元测试用例的数量和 QC 的手动测试数量猛增。

目前我有2个解决方案：

1.  在给D之前从A默默创建B，C，然后我可以保证D的输入数量
2.  跳过B、C，调整D的输入为中介类型，写Adapter转换A->中介类型

选择的解决方案必须满足以下目标：

*   灵活业务（针对客户）
*   高处理性能
*   维护（源代码）

我不知道我应该使用哪一个或有更好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T19:57:41.647

首先，我不完全确定我理解你的问题，所以让我陈述我的假设，然后提供我的答案。根据需要进行调整。

假设：

*   您的业​​务流程模型操作集。示例：A 可以是结帐步骤，C 和 C' 是两个不同但相似的付款步骤。
*   每个处理步骤都对公共数据集的不同部分进行操作。示例：B 计算总计和折扣（对购物车内容进行操作），C 和 C' 计算总计并发起某种付款。
*   您希望尽可能地保持现有实现的完整。

如果是这种情况，我会确保我对我的数据模型有正确的理解，以及每个步骤将在哪些部分上运行，然后围绕它构建一个状态机。

好处：

*   您的每个流程步骤都可以使用一种或多种状态进行建模。您确保转换基于数据模型。您可以有一个决策状态，该状态基于用户使用 Paypal 付款或兑换代金券的决定，将您转换到适当的状态来处理此问题。
*   状态可以单独测试。单元测试将很容易编写，并且您可以为面向客户的功能构建工具以进行手动测试（例如与支付提供商的集成测试）。
*   状态机通常占用空间小。它们通常是事件驱动的，因此在您的应用程序中保持线程计数。如果状态只包含逻辑并且只对数据对象进行操作，您甚至可以跨不同的并发进程重用状态实例。这取决于您的状态机框架。

要记住的事情：

*   在您的状态中明确，并让许多小状态执行小型专用操作。如果决定使用卡支付或代金券，则将其建模为伪状态。
*   避免上帝对象（即包含无所不知的对象）。如果状态开始在域模型的大部分上运行，请考虑改进模型或状态机
*   确保使所有内容都是事件驱动的和异步的。同步状态机无法扩展。如果您正在调用非异步服务，请为其构建一个包装器。

我在之前的项目中成功地采用了这种方式对业务流程进行建模。这是最终用户可以购买对象的流程。我们需要处理许多替代流程，例如在不同支付方式之间切换、在后端系统不可用时重试等等。

为此，我们推出了自己的状态机框架以满足我们的需求。你可能应该看看你的平台有什么可用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-27T20:02:01.580

听起来您需要一个工作流系统。您可以构建各个组件并独立测试它们，然后使用工作流系统在每个客户的配置中将它们连接在一起。

Windows Workflow 和任何 Java BPM 软件都适合该任务。

# iphone - 比较从相机拍摄的图像和已经存在的图像

> ID：11668489
> 
> 赞同：0
> 
> 时间：2012-07-26T11:41:02.407
> 
> 标签：iphone, ios, image-comparison

我是这个平台的新手。

我正在开发应用程序，我之前已经存储了**100 张图像**，并且想要**比较**从**相机拍摄**的图像，并查看与现有 100 张图像匹配的图像。

我搜索了很多，发现了 OpenCV 框架，似乎在这方面对我没有帮助。

对建议的任何帮助都会非常有帮助。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T11:55:59.577

OpenCV 应该是你最好的选择。如果您只是在寻找图像比较，并且不关心图像的特定部分，那么您可以使用[直方图比较](http://docs.opencv.org/doc/tutorials/imgproc/histograms/histogram_comparison/histogram_comparison.html)

如果你想得到像对象这样的细节，你可以使用特征检测然后比较特征。这种方法应该更快。但是，我已经阅读了两种方法的组合，例如使用直方图比较比较特征点。

# iphone - iOS - 如何在字符串内的特定位置插入字符？

> ID：11668493
> 
> 赞同：1
> 
> 时间：2012-07-26T11:41:09.303
> 
> 标签：iphone, objective-c, ios, nsstring

我有一个看起来像这样的网址：“ [http://www.thisIsMyLink.com/afAFFgsfFGsgsdfgds.jpg](http://www.thisIsMyLink.com/afAFFgsfFGsgsdfgds.jpg) ”

问题是我需要在“.jpg”之前的 url 末尾添加“_s”。所以我需要的是：[http ://www.thisIsMyLink.com/afAFFgsfFGsgsdfgds_s.jpg](http://www.thisIsMyLink.com/afAFFgsfFGsgsdfgds_s.jpg)

我找到了一种将特定字符放入字符串中的方法，如下所示：

```
NSMutableString *mu = [NSMutableString stringWithString:myUrl];
[mu insertString:@"_s" atIndex:5]; 
```

这将在字符串内的第 5 个字符中添加“_s”。问题是由于“.jpg”之前的标识符，我每次都不知道链接的长度，所以我需要始终将“_s”4个字符放在末尾，以便它出现就在“.jpg”之前。

我怎样才能做到这一点？

感谢您阅读我的帖子：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:46:06.757

那这个呢：

```
NSMutableString *mu = [NSMutableString stringWithString:myUrl];
[mu insertString:@"_s" atIndex:[mu length] - 4]; 
```

但是，您应该确保它`[mu length]`始终 >= 4。

可能有聪明的方法可以做到这一点，但您没有指定如何获取原始网址。一种选择是使用`stringWithFormat`模块化构建字符串。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-26T11:49:55.573

这是另一个适用于**任何**扩展名的扩展名（例如 .jpeg）：

```
NSString *test = @"www.thisIsMyLink.com/afAFFgsfFGsgsdfgds.jpg";
NSString *ext = [test pathExtension]; // This is .jpg in this case
NSString *out = [[[test stringByDeletingPathExtension] stringByAppendingString:@"_s"] stringByAppendingPathExtension:ext]; 
```

所以这里的逻辑是：

1.  获取路径的扩展名
2.  删除扩展
3.  添加你的字符串
4.  添加扩展名

这样你就可以避免依赖任何假设（比如你总是有一个 3 个字母的扩展名）。最坏的情况，根本没有扩展名，并以一个路径结尾，并在其末尾附加您的字符串。我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:46:04.500

试试这个：

```
[mu insertString:@"_s" atIndex:[mu length] - 3]; 
```

未经测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T11:59:20.333

将“.jpg”的最后一个实例替换为“_s.jpg”，不区分大小写。如果由于某种原因在 url 的其他地方有“.jpg”，这可以避免 url 损坏。

```
NSString *extension = @".jpg";
NSMutableString *mu = [NSMutableString stringWithString:myUrl];
[mu insertString@"_s" atIndex[[[url lowercaseString] rangeOfString:extension options:NSBackwardsSearch].location]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T11:46:33.200

`NSString`有一个方法被调用`length`，它返回字符串的长度。减去扩展名 (4) 的长度，您就有了起始索引。

# c# - XAML 用于像 Wireshark 诊断这样的窗口？

> ID：11668495
> 
> 赞同：2
> 
> 时间：2012-07-26T11:41:24.177
> 
> 标签：c#, .net, wpf, xaml

我正在尝试创建一个与wireshark 完全相同的网络诊断页面。

我有一个 DataGrid（用于在表上显示发送/接收的数据包）、TreeView（用于显示有关具有折叠/展开功能的数据包的详细信息）和一个 RichTextBox（用于显示原始数据）。

这是我目前拥有的 XAML：

```
<UserControl x:Class="DDCUI.CommDiagnosisWPFCtrl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" Height="950" Width="300">
    <DockPanel LastChildFill="True">
        <DataGrid DockPanel.Dock="Top" SelectionMode="Single" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" MaxHeight="300" AutoGenerateColumns="False" Name="DGComm" CanUserResizeColumns="True" IsReadOnly="True" SelectedCellsChanged="DGComm_SelectedCellsChanged">
            <DataGrid.Columns>
                <DataGridTextColumn Header="No." Binding="{Binding Number}" Width="0.1*"/>
                <DataGridTextColumn Header="Time" Binding="{Binding Time}" Width="0.1*" />
                <DataGridTextColumn Header="Protocol" Binding="{Binding Protocol}" Width="0.15*" />
                <DataGridTextColumn Header="Source" Binding="{Binding Source}" Width="0.15*" />
                <DataGridTextColumn Header="Destination" Binding="{Binding Destination}" Width="0.15*" />
                <DataGridTextColumn Header="Data" Binding="{Binding Data}" Width="0.5*" />
            </DataGrid.Columns>
        </DataGrid>
        <RichTextBox DockPanel.Dock="Bottom" MinHeight ="100" Name="RtbHexCode" IsReadOnly="True" />
        <TreeView MinHeight="100" Name="TreeViewDecode" ScrollViewer.VerticalScrollBarVisibility="Auto"/>
    </DockPanel>
</UserControl> 
```

我决定停靠面板不适合我，主要是因为我不能让用户手动调整他们的行大小。

我想知道我必须对 XAML 进行哪些更改才能满足我的设计要求。那是：

*   用户必须能够手动调整各个控件的高度
*   Datagrid 的高度是固定的，如果用户调整主窗口的大小，它永远不会变大/变小
*   当主窗口的高度变小时，首先树视图的高度变小。（在此过程中，如有必要，会显示一个垂直滚动条）。当树视图不再可见时，富文本框的高度会变小。

如果我的描述没有多大意义，最好打开wireshark，启动诊断程序并尝试调整应用程序的高度以了解我的意思。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:47:37.020

为什么不下载[wireshark 源代码](http://www.wireshark.org/docs/wsdg_html_chunked/ChSrcObtain.html)并看看他们是如何做到的——即使这意味着在他们使用的 UI 技术中进行编码，它显然完全适合您的目的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-03T00:07:53.550

如果没有一个面板，[`Grid`](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.aspx)作为最通用的，做你需要的，你可以实现你自己的（通过继承[`Panel`](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.aspx)）。我不知道是否可以有效地子类化，`Grid`但这将是首先要研究的事情，因为它们已经支持通过拖动调整大小[`GridSplitters`](http://msdn.microsoft.com/en-us/library/system.windows.controls.gridsplitter.aspx)（尽管您可以自己重用它们）。

# struts2 - Struts2表单验证：如何在输入字段上方的同一个jsp页面上显示错误消息？

> ID：11668501
> 
> 赞同：0
> 
> 时间：2012-07-26T11:41:40.453
> 
> 标签：struts2, validation, interceptor

我的 page.jsp 里面有一些 html div 标签，当用户点击相应的锚标签按钮时，将 div 的显示切换为阻止或无。

假设用户单击第二个锚按钮链接，加载了 html 表单的适当 div。我有一个文件上传浏览按钮，使用下面的拦截器，限制上传限制 maxsize 和内容类型：

```
<interceptor-ref name="fileUpload">
<param name="maximumSize">15728640</param>
<param name="allowedTypes">application/pdf</param>
</interceptor-ref> 
```

然后在扩展 ActionSupport 的 java 类中，如果违反 maxsize 和内容类型，则获取返回类型作为输入。

所以在 struts.xml 我定义

```
 <result name="input">  page.jsp </result> 
```

但这会导致 page.jsp 重新加载，而不是保持相同的 html div 状态，即 div 标签的第 2 种形式，必须再次单击第 2 个锚标签按钮，从而加载文件浏览表单。

而不是保持

```
<s:fielderror> </s:fielderror> 
```

在第二个 div 标签的文件浏览表单中，我可以将其保留在 body 标签的开头以显示返回的错误消息。

但是我希望像“文件浏览路径”这样的用户输入留在输入字段中，并且错误消息显示在字段上方。如果我能说服自己在另一个jsp页面上显示错误信息，就不会那么麻烦了。但只是推测，是否有可能实现我想要的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:52:47.717

```
<s:if test="hasActionErrors()">
        <s:actionerror/>
</s:if> 
```

您可以将此代码放在要显示错误的任何位置此外，如果您想显示相应的 div，其中包含要在页面加载时显示的表单，您可以在 javascript 代码中使用相同的策略

```
<script>
 <s:if test="hasActionErrors()">
         document.getElementById("div2").display="block";//or trigger click on the corresponding link
 </s:if>
</script> 
```

从这个[帖子](https://stackoverflow.com/a/11593131/456135)

`hasFieldErrors()`如果您正在使用它，请替换为

# c++ - 控制台计算速度？

> ID：11668502
> 
> 赞同：-4
> 
> 时间：2012-07-26T11:41:41.953
> 
> 标签：c++, console-application

如何提高 C++ 中的控制台计算速度？我在代码块中工作。是否有任何方法可以更改控制台速度，以便它可以更快地计算事物。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T11:43:25.260

控制台窗口的运行速度与您计算机上运行的其他程序的“速度”不同。它不是模拟器。它只是一个显示纯文本应用程序输出的窗口。这些纯文本应用程序像任何其他应用程序一样全速运行。

如果您的计算太慢，那么您需要升级计算机硬件和/或重新设计代码中使用的算法。

> 例如，它是一个程序，它找到 10001 PRime no 为此它必须做很多计算。

是的，找到前 10001 个素数将是一项计算量很大的操作。速度不是控制台窗口的限制，而是您的计算机硬件的限制（假设您的算法已尽可能优化）。

您可以通过创建一个*非控制台*应用程序（例如，在其自己的窗口中运行的标准 Windows 应用程序）、运行完全相同的代码以及使用 MessageBox 打印输出或将其写入文件来对此进行测试。您会看到该程序以与您的控制台应用程序相同的速度找到数字，这表明不是控制台部分在减慢它的速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:44:52.800

有时将不必要的输出打印到控制台会减慢速度。如果是这种情况，请尝试将输出重定向到文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:45:49.260

您可以检查并行编程方法。您可以使用 API，例如 OpenMP，并且可以加快计算速度。还要避免在控制台上使用过多的打印件。

# c# - 在通过电子邮件发送用户填写的表格时遇到问题

> ID：11668512
> 
> 赞同：1
> 
> 时间：2012-07-26T11:42:15.490
> 
> 标签：c#, forms, email

所以我的程序的主要目的是让用户在我的网站上填写申请表。一旦填写了网络表单并且用户按下了提交，我已经完成了，所以程序会将他们填写的信息发送到我的电子邮件中。

我遇到的两个主要问题是一个除非用户附加附件，否则网络表单将不会发送。这很糟糕，因为不需要他们这样做。所以我需要某种 if 语句来说明程序仍然应该发送带有或不带有附件的内容。我也希望在发送给我自己的电子邮件中发送日期。我该如何做到这一点，以便在用户点击提交按钮的第二次将日期发送到我的电子邮件。

我已经添加了下面的大部分代码。

谢谢

```
private string SendMessage(string strTo, string strFrom, string strSubject, string strMessage, string strAttachment, string strBCC)
{
    try
    {
        System.Net.Mail.MailMessage mailMsg;
        string strEmail = "";
        string strSmtpClient = ConfigurationManager.AppSettings["SmtpClient"];
        string[] arrEmailAddress = strTo.Split(';');
        for (int intCtr = 0; intCtr < arrEmailAddress.Length; intCtr++)
        {
            strEmail = "";
            if (arrEmailAddress[intCtr].ToString().Trim() != "")
            {
                strEmail = arrEmailAddress[intCtr].ToString().Trim();
                mailMsg = new MailMessage(strFrom, strEmail, strSubject, strMessage);
                mailMsg.IsBodyHtml = true;
                if (!strBCC.Trim().Equals(string.Empty))
                    mailMsg.Bcc.Add(strBCC);

                /*** Added mail attachment handling ***/    
                System.Net.Mail.Attachment attachment;
                attachment = new System.Net.Mail.Attachment(strAttachment);
                mailMsg.Attachments.Add(attachment);

                SmtpClient smtpClient = new SmtpClient(strSmtpClient);
                smtpClient.UseDefaultCredentials = true;
                smtpClient.Port = 25;

                smtpClient.Send(mailMsg);
                mailMsg.Dispose();
            }
        }
        return "Message sent to " + strTo + " at " + DateTime.Now.ToString() + ".";
    }
    catch (Exception objEx)
    {
        return objEx.Message.ToString();
    }
}

protected void Submit_Click1(object sender, EventArgs e)
{
    try
    {
        /*** Moved from SendMessage function ****/
        string strUpLoadDateTime = System.DateTime.Now.ToString("yyyyMMddHHmmss");
        string strFileName1 = string.Empty;
        if ((File1.PostedFile != null) && (File1.PostedFile.ContentLength > 0))
        {
            string strUploadFileName1 = File1.PostedFile.FileName;
            strFileName1 = strUpLoadDateTime + "." + Path.GetFileNameWithoutExtension(strUploadFileName1) + Path.GetExtension(strUploadFileName1);
            strFileName1 = strFileName1.Replace("'", "");
            string strSaveLocation = Server.MapPath("") + "\\" + strFileName1;
            File1.PostedFile.SaveAs(strSaveLocation);
            txtComments.Text = "The file has been uploaded";
        }

        System.Text.StringBuilder sb = new System.Text.StringBuilder();
System.Text.StringBuilder sb = new System.Text.StringBuilder();

sb.Append("<table>");
sb.AppendFormat("<tr><td>Request Name:</td><td>{0}</td></tr>", txtBugName.Text.Trim());
sb.AppendFormat("<tr><td>Category:</td><td>{0}</td></tr>", ddlModule.SelectedValue);
sb.AppendFormat("<tr><td>Sub-Category:</td><td>{0}</td></tr>", ddlPage.SelectedValue);
sb.AppendFormat("<tr><td>Description:</td><td>{0}</td></tr>", txtComments.Text.Trim());
sb.AppendFormat("<tr><td>Email is:</td><td>{0}</td></tr>", txtemail.Text.Trim());
sb.Append("<table>");

        SendMessage(ConfigurationManager.AppSettings["EmailAddrTo"],
            ConfigurationManager.AppSettings["EmailAddrFrom"],
            txtBugName.Text.Trim(),
            strMessage, strSaveLocation, "");
    }
    catch
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:46:11.630

清理了你的方法

```
 /// <summary>
    /// Sends the message.
    /// </summary>
    /// <param name="strTo">The STR to.</param>
    /// <param name="strFrom">The STR from.</param>
    /// <param name="strSubject">The STR subject.</param>
    /// <param name="strMessage">The STR message.</param>
    /// <param name="strAttachment">The STR attachment.</param>
    /// <param name="strBCC">The STR BCC.</param>
    /// <returns></returns>
    private string SendMessage(string strTo, string strFrom, string strSubject, string strMessage, string strAttachment, string strBCC)
    {
        try
        {
            string strEmail = string.Empty;
            string strSmtpClient = ConfigurationManager.AppSettings["SmtpClient"];
            string[] arrEmailAddress = strTo.Split(';');

            foreach (string emailAddress in arrEmailAddress)
            {
                if (!string.IsNullOrEmpty(emailAddress.Trim()))
                {
                    using (System.Net.Mail.MailMessage mailMsg = new MailMessage(strFrom, strEmail, strSubject, strMessage))
                    {
                        mailMsg.IsBodyHtml = true;
                        if (!string.IsNullOrEmpty(strBCC))
                            mailMsg.Bcc.Add(strBCC);

                        if (!string.IsNullOrEmpty(strAttachment))
                        {
                            System.Net.Mail.Attachment attachment;
                            attachment = new System.Net.Mail.Attachment(strAttachment);
                            mailMsg.Attachments.Add(attachment);
                        }

                        using (System.Net.Mail.SmtpClient smtpClient = new System.Net.Mail.SmtpClient(strSmtpClient))
                        {
                            smtpClient.UseDefaultCredentials = true;
                            smtpClient.Port = 25;
                            smtpClient.Send(mailMsg);
                        }
                    }
                }
            }
            return string.Format("Message sent to {0} at {1}.", strTo, DateTime.Now);
        }
        catch (Exception ex)
        {
            return ex.Message;
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:56:00.773

要知道您的用户何时点击：

在您的消息的创建中添加一行：`sb.AppendFormat("<tr><td>User clicked submit on:</td><td>{0}</td></tr>", strUpLoadDateTime);`在您的 Submit_CLick1

为防止发送电子邮件失败，使附件成为条件：

```
if (!string.IsNullOrWhiteSpace(strAttachment))
{
    /*** Added mail attachment handling ***/    
    System.Net.Mail.Attachment attachment;
    attachment = new System.Net.Mail.Attachment(strAttachment);
    mailMsg.Attachments.Add(attachment);
} 
```

# c# - 在静态类中返回多个值

> ID：11668515
> 
> 赞同：2
> 
> 时间：2012-07-26T11:42:26.073
> 
> 标签：c#, asp.net, string, linq, return

如何在以下课程中返回 FirstName 和 Surname？

```
public static string GetAccount(int AccountId)
{        
    LinqSqlDataContext contextLoad = new LinqSqlDataContext();

    var q = (from p in contextLoad.MyAccounts
             where p.AccountId == AccountId
             select new { Name = p.FirstName, Surname = p.Surname }).Single();

    return ??;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T11:44:07.073

您可以返回强类型类、动态对象或元组。我更喜欢返回一个强类型的类。

使用该`dynamic`类型的问题是您不会仅在运行时获得智能感知和异常。

元组的问题在于它不会向您显示返回的内容。您或其他开发人员必须阅读该方法才能知道什么是名字和什么是姓氏。

### 样本

```
public class MyResult
{
    public string Name { get; set; }
    public string Surname { get; set; }
}

public static MyResult GetAccount(int AccountId)
{        
    LinqSqlDataContext contextLoad = new LinqSqlDataContext();

    var q = (from p in contextLoad.MyAccounts
             where p.AccountId == AccountId
             select new MyResult{ Name = p.FirstName, Surname = p.Surname }).Single();

    return q;
} 
```

## 更新

我建议使用`SingleOrDefault`而不是`Single`. `null`如果帐户不存在而不是抛出异常，这将确保您获得结果。

```
//
select new MyResult{ Name = p.FirstName, Surname = p.Surname }).SingleOrDefault();
// 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T11:43:53.217

如果您不想为返回类型定义新对象，可以使用`Tuple<string, string>`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T11:52:22.070

另一个（不是最好的:)）选项是返回一个数组：

```
public static string[] GetAccount(int AccountId)
{        
    LinqSqlDataContext contextLoad = new LinqSqlDataContext();

    var q = (from p in contextLoad.MyAccounts
             where p.AccountId == AccountId
             select new { Name = p.FirstName, Surname = p.Surname }).Single();

    return new []{q.Name, q.Surname};
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T11:51:02.247

通过引用传入两个对象，您可以设置它们。

更改为使其成为 try 函数，作为代码气味较少的版本的示例

```
public static bool TryGetAccount(int AccountId, out String FirstName, out String Surname)
{        
    LinqSqlDataContext contextLoad = new LinqSqlDataContext();

    var q = (from p in contextLoad.MyAccounts
             where p.AccountId == AccountId
             select new { Name = p.FirstName, Surname = p.Surname }).SingleOrDefault();

    FirstName=(q==null) ? null: q.Name;
    Surname=(q==null) ? null: q.Surname;
    return q!=null;
} 
```

现在你可以做

```
string firstName;
string surname;

if (TryGetAccount(id, out firstName,out surname)) {
  // firstName now equals the first name and surname now equals the surname
} else {
  // Deal with value not found 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T11:44:22.513

如果您使用的是 .Net 4，则可以返回动态而不是字符串，并直接从返回的对象中获取这两个值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T13:40:48.577

您可以使用 Hashtable 来避免创建新的结果类。像这样的东西：

```
 public static Hashtable GetAccount(int AccountId)
    {        
       LinqSqlDataContext contextLoad = new LinqSqlDataContext();

         var q = (from p in contextLoad.MyAccounts
         where p.AccountId == AccountId
         select new { Name = p.FirstName, Surname = p.Surname }).Single();

        return new Hashtable(q.FirstName, q.Surname);
    } 
```

比您可以通过您的名字作为键获得姓氏。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T11:50:44.937

只要您不介意以这种方式使用返回的类型，将其作为元组返回怎么样 tuple.Item1 [,](http://msdn.microsoft.com/en-us/library/system.tuple.aspx) tuple.Item2

# java - 使用java关闭监视器灯

> ID：11668519
> 
> 赞同：1
> 
> 时间：2012-07-26T11:42:34.897
> 
> 标签：java

有没有办法像屏幕保护程序一样使用java代码关闭显示器屏幕灯。按下按钮将关闭屏幕灯，并且按下任何键或鼠标移动灯会回来。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T11:46:01.643

> ***有没有办法像屏幕保护程序一样使用java代码关闭显示器屏幕灯。***

不是以独立于平台的方式使用标准 API。您将不得不依赖一些系统特定的命令。

例如，在 Linux 机器上，您可以这样做

```
Runtime.getRuntime().exec("xset dpms force off"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T11:58:21.113

这是您的操作系统已经实现的功能。它与操作系统和硬件相关的功能紧密相连，这使得在纯 Java 中很难做到，无论如何你可以在 C++ 上轻松做到

```
#include <windows.h>
#include <ctime>

int main() {
  int seconds = 10;
  clock_t delay = seconds *CLOCKS_PER_SEC, start = clock();

  while(clock() - start < delay)
    SendMessage(HWND_BROADCAST, WM_SYSCOMMAND, SC_MONITORPOWER, (LPARAM) 2);

  SendMessage(HWND_BROADCAST, WM_SYSCOMMAND, SC_MONITORPOWER, (LPARAM) 2);
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:58:59.603

这是一个高度系统特定的事情。绝对是特定于操作系统的，也可能是特定于硬件的。

Java不是这种事情的最佳选择。这可能是可能的，但有更好的方法......比如运行本机操作系统实用程序或编写一个小 C 应用程序来调用本机代码库。

# asp.net-mvc-3 - 如何在 ASP.Net MVC 3 中使用 Console.WriteLine

> ID：11668521
> 
> 赞同：47
> 
> 时间：2012-07-26T11:42:36.060
> 
> 标签：asp.net-mvc-3, console

我想在我的 Asp.net MVC 3 项目中使用 Console.writeline。我不知道该怎么做。我也尝试使用`System.Diagnostics.Debug.WriteLine()`方法，但它也不起作用。任何人都可以为此提出解决方案

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2013-06-18T17:35:33.430

```
 Debug.WriteLine("My debug string here"); 
```

应该做的伎俩。检查您的应用程序是否处于调试而不是发布：

![调试按钮](../Images/a8b8a250b41dbea11184a22441a6ba8e.png)

如果您的调试窗口没有出现任何内容，请右键单击您的项目。选择属性。在打开的选项卡的左侧，单击构建。有一个复选框“Define DEBUG constant”，确保它被点击。

![在此处输入图像描述](../Images/bb9c6cf5416e9da29987ddb64f9bee37.png)

您很可能知道如何设置调试信息以显示在输出窗口中（Debug->Windows->Output）：

![在此处输入图像描述](../Images/f06f7c3f1c17e7f07ec0a1c421dd7e48.png)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-07-26T11:47:11.763

你具体想做什么？

如果您想在 MVC 站点运行时将一些调试信息输出到控制台，那么我建议您执行以下操作：

1) 使用`System.Diagnostics.Debug.WriteLine()`

2）使用调试启动网站（F5键默认，我认为..） - 并检查Visual Studio中的输出选项卡

这就是我为许多 MVC 3/4 应用程序所做的事情，而且效果很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:49:35.497

它不是控制台应用程序，而是 Web 应用程序。使用内部 Visual Studio 调试和快速监视来查看您的程序中正在发生的事情。在大多数生产需求中，您可以使用一些流行的日志记录工具（例如 log4net）。

# android - 如何在 Android 微调器中设置数据？

> ID：11668523
> 
> 赞同：7
> 
> 时间：2012-07-26T11:42:53.027
> 
> 标签：android, android-spinner

我成功地从微调器中获取了一个值并将其存储在数据库中，但在返回时，我无法设置`Text`为`Spinner`. 我如何像其他功能一样做到这一点`EditText`？

这是我的代码：

```
public class MainActivity_spinner extends Activity
{
     Button save;
     Button show;
     public void onCreate(Bundle savedInstanceState)
     {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.main);
          String[] items = new String[] {" ","Male","Female"};
          final Spinner gender =(Spinner)findViewById(R.id.sex);
          ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, items);
          adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
          gender.setAdapter(adapter);
          save=(Button)findViewById(R.id.save);
          show=(Button)findViewById(R.id.show);
           //----------------------------------------------------------------    
          save.setOnClickListener(new Button.OnClickListener() {
              public void onClick(View view){
                   ContentValues values = new ContentValues();
                   values.put("sex",gender.getSelectedItem().toString());
                   sql.Insert("db",null,values);
                   sql.Close();
              }
          });
          show.setOnClickListener(new Button.OnClickListener() {
              public void onClick(View view){
                   sql.open();
                   String query = "select sex from db where id=2";
                   Cursor c = sql.rawQuery(query,null);
                   c.moveToFirst();
                   (Error is here)it is my spinner i want show value >>>>>>          gender.setSelection(c.getString(0), true);     
              }
          });
    }
} 
```

我将第二个项目从我的微调器保存到我的数据库中。现在我的微调器已重置。然后，我单击“显示”按钮。我保存的项目将在微调器中显示为数据。为什么会失败？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T11:52:01.317

如果我没有误会您，您正在尝试找到在微调器中将文本设置为选定项目的方法，这是您在微调器中拥有列表的数据库中的项目之一。

如果是这样，那么这可能会对您有所帮助：

例子：

```
 ArrayList<String> options=new ArrayList<String>();
    ...onCreate(){
      ...
      Cursor c=<your cursor with value>;
      for(loop for total records){
           options.add(<value from cursor>);
      }
      //now you have options with all values of your database

      ArrayAdapter<String> adapter = new ArrayAdapter<String>(getApplicationContext(), android.R.layout.simple_spinner_item,options);
      mSpinner.setAdapter(adapter); // this will set list of values to spinner

      mSpinner.setSelection(options.indexOf(<value you want to show selected>)));//set selected value in spinner
    } 
```

这将是这样的：

您在数据库中有以下选项：

1.苹果

2.橙色

3.菠萝

4.草莓

5.葡萄

现在，您要显示要选择的菠萝，然后，

```
mSpinner.setSelection(options.indexOf("pineapple"))); 
```

这条线将相应地设置它。

**编辑：** 试试这个：

```
public class MainActivity_spinner extends Activity
{
     Button save;
     Button show;
     ArrayList<String> items=new ArrayList<String>();
     Spinner gender;

     public void onCreate(Bundle savedInstanceState)
     {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.main);
          items.add("Male");
          items.add("Female");

          gender =(Spinner)findViewById(R.id.sex);
          ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, items);              
          gender.setAdapter(adapter);

          save=(Button)findViewById(R.id.save);
          show=(Button)findViewById(R.id.show);
           //----------------------------------------------------------------    
          save.setOnClickListener(new Button.OnClickListener() {
              public void onClick(View view){
                   ContentValues values = new ContentValues();
                   values.put("sex",gender.getSelectedItem().toString());
                   sql.Insert("db",null,values);
                   sql.Close();
              }
          });
          show.setOnClickListener(new Button.OnClickListener() {
              public void onClick(View view){
                   sql.open();
                   String query = "select sex from db where id=2";
                   Cursor c = sql.rawQuery(query,null);
                   c.moveToFirst();
                   gender.setSelection(items.indexOf(c.getString(0)));     
              }
          });
    }
} 
```

# android - 如何裁剪图像？

> ID：11668527
> 
> 赞同：0
> 
> 时间：2012-07-26T11:43:22.080
> 
> 标签：android

我使用矩阵类来缩放我的图像。但我不知道如何裁剪缩放的图像。

我想我应该在 ZOOM 模式下修复偏移量。

请帮我

```
public class PP2cropActivity extends Activity implements OnTouchListener {

        private static final String TAG = "Touch";

        Button cropbtn;
        float offx, offy; 
        float addX2, addY2; 
        float sx, sy, ex, ey;
        float scale;

        Matrix matrix = new Matrix();
        Matrix savedMatrix = new Matrix();
        static final int NONE = 0;
        static final int DRAG = 1;
        static final int ZOOM = 2;
        int mode = NONE;

        PointF start = new PointF();
        PointF mid = new PointF();
        PointF end = new PointF();

        float oldDist = 1f;
        Bitmap bPhoto;
        String mImgpath;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

            Intent intent = getIntent(); 
            mImgpath = intent.getStringExtra("mImgpath");

             bPhoto = BitmapFactory.decodeFile(mImgpath);
             bPhoto = Bitmap.createScaledBitmap(bPhoto, 400, 600, true);

             cropbtn = (Button)findViewById(R.id.confirmbtn);

             cropbtn.setOnClickListener(new OnClickListener(){
                public void onClick(View arg0) {

                    PP2mainActivity.mCropedImage = Bitmap.createBitmap(bPhoto, (int)addX2, (int)addY2, 100, 100);
                    Intent intent = new Intent(PP2cropActivity.this, PP2mainActivity.class);
                    startActivity(intent); 

                }
            });

            ImageView view = (ImageView) findViewById(R.id.matrixview);
            view.setImageBitmap(bPhoto);
            view.setOnTouchListener(this);
        }

        public boolean onTouch(View v, MotionEvent event) {
            ImageView view = (ImageView) v;

            // Dump touch event to log

            // Handle touch events here...
                switch (event.getAction() & MotionEvent.ACTION_MASK) {
                case MotionEvent.ACTION_DOWN:
                    savedMatrix.set(matrix);
                    start.set(event.getX(), event.getY());
                    Log.d(TAG, "mode=DRAG");
                    sx = event.getX();
                    sy = event.getY();

                    mode = DRAG;
                    break;

                case MotionEvent.ACTION_POINTER_DOWN:
                    oldDist = spacing(event);
                    Log.d(TAG, "oldDist=" + oldDist);
                    if (oldDist > 10f) {
                        savedMatrix.set(matrix);
                        midPoint(mid, event);
                        mode = ZOOM;
                            Log.d(TAG, "mode=ZOOM");
                    }
                    break;
                case MotionEvent.ACTION_UP:
                    if(mode ==DRAG) { 
                    addX2 = -offx +10;
                    addY2 = -offy +10; 
                    mode = NONE;
                    Log.d("point", "addX2 : " + addX2 + "addY2 : " + addY2);
                    } else if(mode ==ZOOM)
                    {
                        addX2 = (-offx+10)*scale;
                        addY2 = (-offy+10)*scale;
                    }
                    break; 
                case MotionEvent.ACTION_POINTER_UP:
                        mode = NONE;
                        Log.d(TAG, "mode=NONE");
                        break;
                case MotionEvent.ACTION_MOVE:
                    if (mode == DRAG) {
                        // ...
                        matrix.set(savedMatrix);
                        ex = event.getX();
                        ey = event.getY();

                         offx +=(int)(ex-sx);
                         offy +=(int)(ey-sy);
                         sx = ex;
                         sy = ey;

                        Log.d("off", "offx : " + offx+ " , offy : " + offy);
                        matrix.postTranslate(event.getX()- start.x, event.getY()- start.y);

                    }
                    else if (mode == ZOOM) {

                            float newDist = spacing(event);
                            Log.d(TAG, "newDist=" + newDist);
                            if (newDist > 10f) {
                                    matrix.set(savedMatrix);
                                 scale = newDist / oldDist;
                                    matrix.postScale(scale, scale, mid.x, mid.y);   
                            }
                            offx +=  (int)(ex-sx) /scale;
                            offy +=  (int)(ey-sy) /scale;
                            sx = ex;
                            sy = ey;
                    }
                    break;
                }

                view.setImageMatrix(matrix);
                return true; // indicate event was handled
        }

        /** Determine the space between the first two fingers */
        private float spacing(MotionEvent event) {
            float x = event.getX(0) - event.getX(1);
            float y = event.getY(0) - event.getY(1);
            return FloatMath.sqrt(x * x + y * y);
        }

        /** Calculate the mid point of the first two fingers */
        private void midPoint(PointF point, MotionEvent event) {
            float x = event.getX(0) + event.getX(1);
            float y = event.getY(0) + event.getY(1);
            point.set(x / 2, y / 2);
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:49:50.240

要裁剪图像：

```
Bitmap originalBitmap = BitmapFactory.decodeResource(getResources(), 
                R.drawable.test_image);
Bitmap croppedBitmap = Bitmap.createBitmap(originalBitmap, x, y, width, height); 
```

# java - 从 Map 中删除实体尝试使引用为空

> ID：11668528
> 
> 赞同：0
> 
> 时间：2012-07-26T11:43:23.447
> 
> 标签：java, hibernate, jpa

我有一个`Quest`包含许多`Task`s 的实体：

```
@Entity
public class Quest {

    @OneToMany(orphanRemoval=true,cascade=CascadeType.ALL)
    @JoinColumn(name="quest_id")
    @MapKey(name="taskName")
    private Map<String, Task> tasks = Maps.createHash();

    @ElementCollection
    @OrderColumn
    private Set<String> completedTasks;

@Entity
public class Task implements Serializable {

    @ManyToOne(optional=false)
    @JoinColumn(name="quest_id")
    private Quest quest;

    @Column(nullable=false,updatable=false,length=50)
    private String taskName; 
```

现在当我这样做时：

```
// store the task as completed
quest.getCompletedTasks().add(taskName); // set
// remove the task entity
quest.getTasks().remove(taskName); // map 
```

Hibernate 尝试执行无意义的查询，但失败：

```
update Task set quest_id=null where quest_id='77149' 
```

这似乎打破了任务与其*所有*任务之间的联系`WHERE quest_id = ...`（`DELETE`在任何情况下，它都不应该使任何东西无效，而应该`Task`完全。

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:48:22.173

更新并非无意义：您删除了`task`from`quest`的列表，因此休眠删除了`task`和之间的连接`quest`。

更新：我刚刚注意到你有`@JoinColumn`和`@OneToMany`在同一个领域。我认为您应该这样做（取决于您使用的休眠版本）：

```
@OneToMany(mappedBy="quest", orphanRemoval=true,cascade=CascadeType.ALL)
@MapKey(name="taskName")
private Map<String, Task> tasks = Maps.createHash(); 
```

# c# - 在三重 DES 加密中切换到 CBC 模式

> ID：11668531
> 
> 赞同：0
> 
> 时间：2012-07-26T11:43:30.130
> 
> 标签：c#, .net, encryption, 3des

我正在通过.Net开发一个mvc应用程序，以保护我的敏感信息，例如web.config中的信息我有两个使用Triple DES加密和解密信息的函数，但是我对此并不陌生并成功达到在朋友的帮助下直到这里，在这里问了几个问题。

我目前陷入困境的一点是如何在加密字符串的末尾添加 TDES IV（初始化向量）以及如何在解密时再次检索它？我的意思是，您将如何在加密信息中识别来自这里的 IV（初始化向量）星号？

从[如何在加密字符串中添加和检索 TDES IV（初始化向量）中，](https://stackoverflow.com/questions/11417816/how-to-add-and-retrieve-tdes-iv-initialization-vector-in-encrypted-string)我被建议切换到 CBC 模式而不是 ECB，因为 ECB 不支持 IV。

**但我很困惑如何切换到CBC？**

我真的需要关于这个问题的帮助，这个问题很长时间以来一直无法解决并且无法找到解决方案。请帮忙。

```
public static string Encrypt(string Message)
{
    byte[] iv;
    byte[] Results;
    System.Text.UTF8Encoding UTF8 = new System.Text.UTF8Encoding();
    MD5CryptoServiceProvider HashProvider = new MD5CryptoServiceProvider();
    byte[] TDESKey = HashProvider.ComputeHash(UTF8.GetBytes(GetSHA256String()));
    TripleDESCryptoServiceProvider TDESAlgorithm = new TripleDESCryptoServiceProvider();
    TDESAlgorithm.Key = TDESKey;
    TDESAlgorithm.Mode = CipherMode.ECB;
    TDESAlgorithm.Padding = PaddingMode.PKCS7;
    // Capture the randomly generated IV
    iv = TDESAlgorithm.IV;
    byte[] DataToEncrypt = UTF8.GetBytes(Message);
    try
    {
        ICryptoTransform Encryptor = TDESAlgorithm.CreateEncryptor();
        Results = Encryptor.TransformFinalBlock(DataToEncrypt, 0, DataToEncrypt.Length);
        //var lnght=Results.GetLength(0);
        //System.Buffer.BlockCopy(iv, 0, Results, lnght + 1, iv.Length()); //HOW?
    }
    finally
    {
        TDESAlgorithm.Clear();
        HashProvider.Clear();
    }
    return Convert.ToBase64String(Results);
    //return Encoding.UTF8.GetString(Results);
}

public static string Decrypt(string Message)
{
    byte[] Results;
    System.Text.UTF8Encoding UTF8 = new System.Text.UTF8Encoding();
    MD5CryptoServiceProvider HashProvider = new MD5CryptoServiceProvider();
    byte[] TDESKey = HashProvider.ComputeHash(UTF8.GetBytes(GetSHA256String()));
    TripleDESCryptoServiceProvider TDESAlgorithm = new TripleDESCryptoServiceProvider();
    TDESAlgorithm.Key = TDESKey;
    // Apply the same IV used during encryption
    //TDESAlgorithm.IV = iv;  // HOW?
    TDESAlgorithm.Mode = CipherMode.ECB;
    TDESAlgorithm.Padding = PaddingMode.PKCS7;
    try
    {
        byte[] DataToDecrypt = Convert.FromBase64String(Message);
        //byte[] DataToDecrypt = UTF8.GetBytes(Message);
        //byte[] DataToDecrypt = Encoding.UTF8.GetBytes(Message);
        ICryptoTransform Decryptor = TDESAlgorithm.CreateDecryptor();
        Results = Decryptor.TransformFinalBlock(DataToDecrypt, 0, DataToDecrypt.Length); // << ERROR is here.
    }
    finally
    {
        TDESAlgorithm.Clear();
        HashProvider.Clear();
    }
    return UTF8.GetString(Results);
}

…
… 
```

任何指南、链接或 a`piece of code`将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T13:47:11.677

要更改为 CBC，请将您的代码修改为 read，`TDESAlgorithm.Mode = CipherMode.CBC;`用于加密和解密。

DES 是一个 64 位的块密码，所以你需要 64 位的 IV，8 个字节。使用加密安全的 RNG，C# 必须[`RNGCryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx)生成您的 IV，并将其作为参数传递给加密方法。C# 文档将在这里为您提供帮助。

加密纯文本后，将 IV 添加到消息中并发送整个内容。

解密时，提取传入消息的前八个字节以用作 IV。消息的其余部分将形成密文。

# drupal - 如果设置了 cookie，则隐藏 drupal 菜单项

> ID：11668535
> 
> 赞同：0
> 
> 时间：2012-07-26T11:43:45.833
> 
> 标签：drupal, menu

我是drupal的新手，我正在尝试隐藏菜单项或根据是否设置cookie来更改它。

任何人都可以就您如何做到这一点提供一些提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T14:58:36.133

我认为您必须以编程方式定义两个块，并根据 cookie 是否是这个来显示一个。

# jquery-ui - jQueryUI 主题滚轮主题的替代品

> ID：11668542
> 
> 赞同：11
> 
> 时间：2012-07-26T11:44:01.610
> 
> 标签：jquery-ui, themes, themeroller

使用 jQueryUI 的每个人都知道 themeroller，我猜相当多的用户和我一样认为 themeroller 主题并不是世界上最漂亮的东西。

按钮通常大得不切实际，渐变看起来很暗淡（没有饱和度变化），标准主题比功能更闪亮，自定义主题的选项......有限。恕我直言，themeroller 主题看起来像 [explitive]。

我知道有几个自定义主题：

*   阿里斯托[http://taitems.github.com/Aristo-jQuery-UI-Theme/](http://taitems.github.com/Aristo-jQuery-UI-Theme/)
*   赦免[http://www.michaelvanderheeren.be/archives/382](http://www.michaelvanderheeren.be/archives/382)
*   引导[http://addyosmani.github.com/jquery-ui-bootstrap/](http://addyosmani.github.com/jquery-ui-bootstrap/)
*   jQUIT 构建器[http://jquit.com](http://jquit.com)

我什至尝试创建自己的：http: [//vanderlee.github.com/Afterdark/](http://vanderlee.github.com/Afterdark/)

[http://www.primefaces.org/themes.html](http://www.primefaces.org/themes.html)还有一些其他非标准主题，但它们似乎大多是经过调整的主题滚轮主题。

但这确实是非常有限的选择，甚至这些自定义的 jQueryUI 主题（包括我自己的）也经常需要修改才能在复杂的 Web 应用程序中使用。

我想知道周围是否还有其他自定义 jQueryUI 主题？特别是不遵循 themeroller 样式的特定主题，例如 Bootstrap 的选项卡或 Absolution 的对话框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T20:53:05.507

有[jQuery UI Bootstrap](http://addyosmani.github.com/jquery-ui-bootstrap/)，您可以在项目页面上看到：

> 该项目旨在将 Twitter Bootstrap 的美观和易用性带入 jQuery UI 小部件♥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T00:03:34.530

我自己尝试使用 jQuery UI Bootstrap，你可以在这里看到：http: [//gustavohenke.github.io/jquery-ui-bootstrap](http://gustavohenke.github.io/jquery-ui-bootstrap)

# bash - 从脚本打开几个 xterm 窗口而不关闭

> ID：11668558
> 
> 赞同：0
> 
> 时间：2012-07-26T11:44:42.827
> 
> 标签：bash, xterm

当我执行这个脚本时，终端正在打开并立即关闭，所以我看不到结果。

我所知道的没有任何帮助。

我使用的是 SunOS 5.9，这不是我的错））

```
#!/bin/bash

if [ -z "$1" ]; then 
echo "enter command"
fi

if [ -z "$2" ]; then 
echo "enter command"
fi

if [ -z "$3" ]; then 
echo "enter command"
fi

xterm -e $1 | wait & 

xterm -e $2 | wait & 

xterm -e $3 | wait & 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-01T23:07:54.363

该`-hold`选项于 1999 年添加到 XFree86 xterm（[补丁 116](http://invisible-island.net/xterm/xterm.log.html#xterm_116)）。但是，Sun 继续提供 xterm 的“openwin”二进制文件，直到 2011 年的 Solaris 11（请参阅 xterm FAQ *[Why can't I use the pageup/pagedown keys?](http://invisible-island.net/xterm/xterm.faq.html#xterm_pageup)*）。在那之前，Sun 在免费软件 CDROM 上提供了现代 xterm。

提供“保持”功能的通常建议涉及在所需命令之后的“读取”命令。假设要执行的命令在 shell 中运行。如果要运行`vi`，建议的修复不起作用，因为可能涉及备用屏幕。此外，它依赖于`$SHELL`set （并且不适用于某些，例如`tcsh`-- 但确实适用于`bash`）。

这是解决这些问题的改进脚本：

```
#!/bin/bash
export SHELL=/bin/bash
while [ $# != 0 ]
do
    CMD="$1" \
    xterm -xrm '*titeInhibit:true' -e $SHELL -c '$SHELL -c "$CMD"; read'
    shift 1
done 
```

所有版本都`xterm`支持该`-xrm`开关（它随 Xt、X Toolkit 库免费提供）。

显式`titeInhibit`资源解决了运行全屏应用程序（例如`vi`. 为Solaris 11中的*xterm*提供的终端描述将*备用屏幕*用于全屏应用程序。这在 xterm FAQ 中有讨论*[为什么运行 vi 时屏幕不清晰？](http://invisible-island.net/xterm/xterm.faq.html#xterm_tite)*. 如果没有资源设置，如果一个脚本运行到`vi`多个文件，退出后屏幕会被清除`vi`，同时等待用户按下`Enter`关闭窗口。在此行为不是默认行为的其他系统上，已修补 xterm- 或 ncurses-sources 以反映打包者的偏好。同样，Solaris 9 的 terminfo 源代码也已修补。尽管如此，无法处理常用的行为`xterm`将是一个问题。

例如，即使使用 Solaris 9，许多用户也依赖 ncurses 来提供可行的彩色终端描述。Solaris（如 xterm FAQ *[What $TERM should I use?](http://invisible-island.net/xterm/xterm.faq.html#xterm_terminfo)*中所述）提供了`xtermc`，但它的功能键与实际的 xterm 完全不同，使其成为一个糟糕的选择。Sun 免费软件 cdrom 的 terminfo（来自 ncurses）没有打补丁；使用该终端数据库的人在备用屏幕上获得了预期的行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:09:09.780

假设您想查看即使失败的命令产生了什么，请将您的命令替换为：

```
xterm -xrm '*hold: true' -e $1 &   # this is to keep xterm from closing
pid1=$!  # this is to save the pid, in case you want to close it
disown   # this is to prevent the finishing shell from closing the xterm 
```

或者，如果`xterm`不支持`-xrm`选项：

```
CMD="$1" xterm -e $SHELL -c '$SHELL -c "$CMD"; read' 
```

这两个 shell 是为了防止命令中的语法错误，即使在这种情况下也能保持 xterm 打开。

# java - 使用计时器任务添加路径覆盖在缩放时捕获 ConcurrentModificationException

> ID：11668560
> 
> 赞同：0
> 
> 时间：2012-07-26T11:44:46.420
> 
> 标签：java, android

我想在许多地理点之间绘制直线路径作为给定的代码.....但是如果我尝试放大地图 ConcurrentModificationException 发生，请帮助我......我对 android 很陌生......

```
//this is the methode to draw path
 public void draw_path(View view) {
     if(timer!=null)
         timer.cancel();

      timerpath = new Timer();
      timerpath.scheduleAtFixedRate(new TimerTask(){
          int i=0;
        @Override
        public void run() {
            // TODO Auto-generated method stub
             List<Overlay> mapOverlays = mapView.getOverlays();

             if(i<replaydata.length-2){
                 GeoPoint point=new GeoPoint((int) (Float.parseFloat(replaydata[i].split("~")[0]) * 1E6),(int) (Float.parseFloat(replaydata[i].split("~")[1])* 1E6));
                 GeoPoint point2=new GeoPoint((int) (Float.parseFloat(replaydata[i+1].split("~")[0]) * 1E6),(int) (Float.parseFloat(replaydata[i+1].split("~")[1])* 1E6));

                 mapOverlays.add(new PathOverlay(point2, point));
                 mapView.postInvalidate();
                 i=i+1;
             }
             }

        }, 50, 500);

    }
//this is the PathOverlay Class
package com.suneeltectonics.tracking;

import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Point;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;
import com.google.android.maps.Projection;
public class PathOverlay extends Overlay {
private GeoPoint gp1;
private GeoPoint gp2;

public PathOverlay(GeoPoint gp1, GeoPoint gp2) {
    this.gp1 = gp1;
    this.gp2 = gp2;
}

@Override
public boolean draw(Canvas canvas, MapView mapView, boolean shadow,
        long when) {
    // TODO Auto-generated method stub
    Projection projection = mapView.getProjection();
    if (shadow == false) {

        Paint paint = new Paint();
        paint.setAntiAlias(true);
        Point point = new Point();
        projection.toPixels(gp1, point);
        paint.setColor(Color.RED);
        Point point2 = new Point();
        projection.toPixels(gp2, point2);
        paint.setStrokeWidth(6);
        canvas.drawLine((float) point.x, (float) point.y, (float) point2.x,
                (float) point2.y, paint);
    }
    return super.draw(canvas, mapView, shadow, when);
}

@Override
public void draw(Canvas canvas, MapView mapView, boolean shadow) {
    // TODO Auto-generated method stub

    super.draw(canvas, mapView, shadow);
}

}
 //this is the crash log
 07-26 17:42:30.850: WARN/dalvikvm(2173): threadid=1: thread exiting with uncaught exception (group=0x400207d8)
 07-26 17:42:30.870: ERROR/AndroidRuntime(2173): FATAL EXCEPTION: main
 07-26 17:42:30.870: ERROR/AndroidRuntime(2173): java.util.ConcurrentModificationException
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at java.util.ArrayList$ArrayListIterator.next(ArrayList.java:573)
 07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at com.google.android.maps.OverlayBundle.draw(OverlayBundle.java:44)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at com.google.android.maps.MapView.onDraw(MapView.java:494)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.View.draw(View.java:6740)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.ViewGroup.drawChild(ViewGroup.java:1640)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.View.draw(View.java:6743)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.ViewGroup.drawChild(ViewGroup.java:1640)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.ViewGroup.drawChild(ViewGroup.java:1638)
07-26 17:42:30.870: ERROR/AndroidRuntime(2173):     at android.view.ViewGroup.dispatchDraw(ViewGroup.java:1367) 
```

07-26 17:42:30.870: 错误/AndroidRuntime(2173): 在 android.view.ViewGroup.drawChild(ViewGroup.java:1638) 07-26 17:42:30.870: 错误/AndroidRuntime(2173): 在 android. view.ViewGroup.dispatchDraw(ViewGroup.java:1367) 07-26 17:42:30.870: 错误/AndroidRuntime(2173): 在 android.view.View.draw(View.java:6743) 07-26 17:42: 30.870: 错误/AndroidRuntime(2173): 在 android.widget.FrameLayout.draw(FrameLayout.java:352) 07-26 17:42:30.870: 错误/AndroidRuntime(2173): 在 com.android.internal.policy.impl .PhoneWindow$DecorView.draw(PhoneWindow.java:1842) 07-26 17:42:30.870: ERROR/AndroidRuntime(2173): at android.view.ViewRoot.draw(ViewRoot.java:1407) 07-26 17:42 :30.870: 错误/AndroidRuntime(2173): 在 android.view.ViewRoot.performTraversals(ViewRoot.java:1163) 07-26 17:42:30.870: 错误/AndroidRuntime(2173):在 android.view.ViewRoot.handleMessage(ViewRoot.java:1727) 07-26 17:42:30.870: 错误/AndroidRuntime(2173): 在 android.os.Handler.dispatchMessage(Handler.java:99) 07-26 17 :42:30.870: ERROR/AndroidRuntime(2173): at android.os.Looper.loop(Looper.java:123) 07-26 17:42:30.870: ERROR/AndroidRuntime(2173): at android.app.ActivityThread。 main(ActivityThread.java:4633) 07-26 17:42:30.870: ERROR/AndroidRuntime(2173): at java.lang.reflect.Method.invokeNative(Native Method) 07-26 17:42:30.870: ERROR/AndroidRuntime (2173): 在 java.lang.reflect.Method.invoke(Method.java:521) 07-26 17:42:30.870: 错误/AndroidRuntime(2173): 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller。运行（ZygoteInit.java:891）07-26 17:42:30.870：错误/AndroidRuntime（2173）：在 com.android.internal.os.ZygoteInit.main（ZygoteInit.java:649) 07-26 17:42:30.870: ERROR/AndroidRuntime(2173): at dalvik.system.NativeStart.main(Native Method) 07-26 17:42:30.920: WARN/ActivityManager(150): 强制完成活动 com.suneeltectonics.tracking/.ViewReplay

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:53:43.880

由于对列表项的操作引发了异常......

这不是因为 ondraw 方法，而是因为你在每个时钟周期都在操作整个列表。这就是为什么当时钟周期很小时你有异常但是当它很大时你没有得到任何异常。

不要一直尝试重新填充和修改...方法无效，以便它可以重绘所有内容，但是由于您保留了非常小的修剪器持续时间，因此值会发生冲突...

# ruby-on-rails - 设计与 Facebook AppCenter 的集成

> ID：11668562
> 
> 赞同：2
> 
> 时间：2012-07-26T11:45:00.703
> 
> 标签：ruby-on-rails, facebook, devise, omniauth

我有一个通过 oauth2 devise/warden/omniauth 与 facebook 集成的应用程序。一切正常，我对此感到满意。

现在我正在尝试将应用程序与新的 facebook appcenter 集成，这基本上似乎解决了让用户在访问我的网站之前进行*预身份验证的问题。*

基本上，用户以类似的 url 结尾

```
/?fb_appcenter=1&code=xxxxxx 
```

但是设计'omniauthcontroller 正在等待不同的网址，即

```
/users/auth/facebook/callback 
```

我尝试执行一个简单的重定向，将代码查询参数传递到回调 url，但我收到“无效凭据”错误。

我认为问题可能是在 oauth2 facebook 策略中用于获取 access_token 的调用中使用的 redirect_uri 不对应于 facebook 本身用于生成初始代码的那个，但我不知道我应该如何改变那。

有人有建议或过去解决过这个问题吗？

值得一提的是，我使用的是旧版本的设计（1.4）和omniauth（0.3），但暗示了总体方向应该是什么，即使使用新版本，也足够了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:50:07.193

在将代码交换为令牌时，代码是在经过身份验证的引用中创建的，该`redirect_uri`值需要与用户被带到的 URL 相同。[App Center 文档](https://developers.facebook.com/docs/guides/appcenter/#authorization)中对此效果有注释：

**使用查询字符串设置时的特殊注意事项：**

如果您想在 App Center 中使用服务器端身份验证流程，请务必确保在将代码交换为访问令牌时正确传递了 redirect_uri 参数。您应该将 redirect_uri 参数设置为您网站的点击后到达 URL。在大多数情况下，URL 看起来像：

`http://www.example.com/?fb_appcenter=1&fb_source=search&code=CODE_HERE` 因此，您应该将 redirect_uri 设置为相同的值。请确保此逻辑是动态的，因为附加到您的点击后到达网址的查询参数可能会发生变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T14:13:55.253

事实证明这对于旧版本的omniauth 是不可能的，因为`redirect_uri`它是硬编码的，但是一个合理的技巧是将用户重定向到标准的auth 回调（例如`/auth/facebook/callback`）。

这将再次对用户进行身份验证，但由于他已经给了你凭据，它只会通过。

另一种方法，也是我最终做的，是从 OA 的 facebook 策略中获取代码并重新实现一些 OAuth2 功能，基本上是在您正在使用的登录页面中将代码与访问令牌交换。

# dsl - 如何将 EMF 与自己的元模型一起使用

> ID：11668563
> 
> 赞同：2
> 
> 时间：2012-07-26T11:45:01.063
> 
> 标签：dsl, eclipse-emf, mda, model-driven-development

我的目标是为模型创建一个元模型，但比默认情况下 EMF 高一级。元模型（2）应该定义可能模型（1）的可能性和限制。然后我想生成这个模型的 Java 代码。

2 元模型 1 模型 0 Java 代码

所以模型（1）是一种 DSL，而元模型是该 DSL 的定义。

我怎样才能做到这一点。是否可以使用 EMF 或 Eclipse 建模项目中是否有任何其他插件？

我正在寻找类似这个工具的一些功能：[http](http://www.actifsource.com/) ://www.actifsource.com/但没有指定额外的生成器模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T05:25:36.413

您可以使用 Xtext（基于 EMF）来定义您的（文本）DSL。XText 将生成元模型和模型编辑器，因此您可以相当快速地定义自己的模型。从那里，您可以使用 Acceleo（基于模板的模型到文本生成器）从中生成 java 代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-09T10:06:45.160

不确定您是否需要元模型，但您可以检查[EMF Facet](http://www.eclipse.org/facet/)，它允许您扩展现有的 Ecore 元模型而无需修改它们。

# matlab - 约束三角测量代码

> ID：11668571
> 
> 赞同：0
> 
> 时间：2012-07-26T11:45:18.847
> 
> 标签：matlab, triangulation

我在 matlab 中寻找约束三角测量代码，类似于 Shewchuk 的[三角](http://www.cs.cmu.edu/~quake/triangle.html)软件。matlab`delaunay`缺少的主要内容是约束，例如对网格最小角度的约束等。

我听说有一个用于将 Shewchuk 的代码用于 matlab 的端口`mex`，但我找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T15:41:23.553

这是为 MATLAB 编写的 GUI，它使用对 Shewchuk 的 Triangle.c 的外部调用：

[http://marineemlab.ucsd.edu/~kkey/software/triangle/index.php](http://marineemlab.ucsd.edu/~kkey/software/triangle/index.php)

也许你可以使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T06:01:17.837

我推荐 Matlab 的 DelaunayTri(...,C) 其中 C 是 numEdge x 2 矩阵中的约束边。边用 2 个索引指定到三角测量点的集合中。

输出是具有 DelaunayTri 类的对象。

[http://www.mathworks.com.au/help/techdoc/ref/delaunaytri.html](http://www.mathworks.com.au/help/techdoc/ref/delaunaytri.html)

要过滤掉约束内部或外部的三角形，请使用“inOutStatus()”

例如

```
dt = DelaunayTri(double(Points), double(Constraints));
outside = ~ dt.inOutStatus();
%filter using TriRep to create a new set of triangles, "tr"
tr = TriRep(dt(outside, :), dt.X); 
```

# gwt - AutoBeanCodex.encode 省略了具有默认值的属性

> ID：11668575
> 
> 赞同：4
> 
> 时间：2012-07-26T11:45:35.683
> 
> 标签：gwt, autobean

我正在通过`AutoBean`转换为 JSON 的 s 与 Web 服务通信。问题在于，Web 服务期望 JSON 对象的每个属性都存在于请求中，而`AutoBeanCodex.encode()`似乎忽略了所有具有默认值的属性（尽管这些属性是显式设置的）。

有没有办法也包含这些属性？

**编辑：**托马斯的回答已经帮了很多忙，但它仍然留下了一个小问题。即一个空数组（`List<Integer>`在我的情况下）也被吞下，显然是因为默认值是空数组而不是`null`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T12:11:25.800

一种解决方法可能是使用包装器类型而不是原始类型，例如，而`Boolean`不是`boolean`，`Integer`而不是`int`; 这样，*默认值*将是`null`而不是`false`or `0`。

# certificate - 如何连接到 CA-Server 来搜索证书？

> ID：11668576
> 
> 赞同：0
> 
> 时间：2012-07-26T11:45:36.260
> 
> 标签：certificate, remote-access, ca

我在连接到 CA 服务器时遇到问题。我的想法是通过远程连接吊销证书。实际上，我是本地机器上的管理员，也是 CA 服务器上的管理员。这个想法与以下链接非常相​​似：[示例](http://blogs.msdn.com/b/alejacma/archive/2010/05/10/how-to-get-info-from-client-certificates-issued-by-a-ca-c.aspx)

现在我的问题在于以下部分：

> certView.OpenConnection(strServer + "\" + strCAName);

如果我通过这条线，它会告诉我错误：

> CCertView::OpenConnection 操作被用户取消。0x800704c7 (WIN32: 1223)

有人现在这个错误可以帮助我吗？

我可以通过这样的远程连接成功吊销证书：

> CCertAdmin caAdmin = new CCertAdmin(); caAdmin.RevokeCertificate("strServer", "strSerialnumber", reason, DateTime.Now);

所以我认为与ca-server的连接没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T13:11:49.193

Ok i found the solution with the help of the microsoft support.

The problem is that the installationfile of the RSAT 64Bit (Remote Server Administration Tools) is not complete. So there are files missing. The 32Bit version of the RSAT is complete.

Now my problem was that i was programming a webapplikation on a Windows 7 64Bit with RSAT 64Bit installed. But my webapplication was running in 32Bit. So then the error occurs cause there are missing some important files.

The solution is to extract the 32Bit version of RSAT like this: [Microsoft Support](http://support.microsoft.com/kb/928636/en-us)

or

if it is possible you develope your webapplikation on a Windows 7 32Bit with RSAT in 32Bit. Then you won't have any trouble.

# c++ - 为什么在 CreateSemaphore 工作时 OpenSemaphore 在 64 位 Windows 7 中总是返回零？

> ID：11668578
> 
> 赞同：1
> 
> 时间：2012-07-26T11:45:46.137
> 
> 标签：c++, winapi, windows-7, 64-bit, semaphore

我将我的应用程序从 Windows 7 32 位移植到 Windows 7 64 位。我发现 API 函数`OpenSemaphore`总是返回零。此调用适用于 32 位 Windows，但不适用于 64 位 Windows。

当我调用时`GetLastError()`，它返回 2。

此外，我`OpenSemaphore`用`CreateSemaphore`函数替换了我的应用程序，我的应用程序工作正常，但我仍然对为什么`OpenSemaphore`函数在 64 位代码中失败感到困惑。

任何知道这个问题的人都可以澄清一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T11:53:35.993

当函数失败时检查错误代码是一个很好的第一步，但你需要确保你理解错误代码的含义。该[`GetLastError`函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679360.aspx)可能返回的错误代码记录[在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681381.aspx)。

在这种情况下，您说错误代码是 2。这对应于`ERROR_FILE_NOT_FOUND`，这意味着

> 该系统找不到指定的文件。

你可能会问自己：文件，什么文件？是的，有时理解错误代码需要一点创造性思维。所以让我们想一想：“找不到文件”对于[`OpenSemaphore`函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684326.aspx)可能意味着什么？好吧，其中一个参数是一个字符串，它指定要打开的信号量的名称。这*有点*像一个文件，对吧？足够接近成为一个很好的领导！

那么，您为`lpName`参数指定的值很可能与有效的信号量不对应。我通常检查的第一件事是字符串的大小写——与`lpName`值进行的比较区分大小写。但既然你说它曾经在 32 位应用程序中工作，那可能不是这里的问题。

不过，32 位到 64 位的转换确实给了我们另一个线索。请记住，32 位和 64 位应用程序是非常不同的野兽，通常不允许相互接触。因此，按理说，64 位应用程序将无法使用由 32 位应用程序创建的信号量，反之亦然。

考虑到你说如果你打电话[`CreateSemaphore`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682438.aspx)来创建一个*新*的信号量它会起作用，这让我们很好地找到了答案。很有可能，您尝试通过调用`OpenSemaphore`函数打开的信号量是由 32 位进程创建的，因此不能被 64 位进程打开或使用。（请记住，[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684326.aspx)告诉我们*“只有当某个进程已经使用该`CreateSemaphore`函数创建了信号量时，该函数才会成功”*。）如果您在 64 位进程中创建*新*的信号量，则可以毫无问题地打开并使用它.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:50:21.877

OpenSemaphore 和 CreateSemaphore 是两个不同的东西。只有当信号量已经存在时，开放信号量才可用。

来自 MSDN

> OpenSemaphore 函数允许多个进程打开同一个信号量对象的句柄。只有当某个进程已经使用 CreateSemaphore 创建了信号量时，该函数才会成功

# php - 如何跟踪对外部站点的 GET 请求

> ID：11668581
> 
> 赞同：0
> 
> 时间：2012-07-26T11:45:48.413
> 
> 标签：php, javascript, ajax, flash, statistics

我正在构建一个广告点击记录插件。

我需要找出点击广告的时间。我注意到，当广告开始播放时，总是会向某个特定页面发出 GET 请求。

现在我使用 google chrome 的开发者工具来查看在我的本地计算机上发出的所有请求。

有谁知道我如何做到这一点，然后将数据发送回我的服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:55:43.337

当使用 ajax 完成因点击广告而发出的请求时，您可以将处理程序绑定到该 ajax 事件并将有关该点击的信息发送回您的服务器。请参阅：[http ://docs.jquery.com/Ajax_Events](http://docs.jquery.com/Ajax_Events)

对于使用直接 http 链接加载其目标的广告，您可以将处理程序添加到这些锚点上的点击事件，例如使用 jquery。见：[http ://api.jquery.com/click/](http://api.jquery.com/click/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:47:21.767

您要做的是创建一个指向您拥有的 PHP 文件的链接，该文件跟踪被单击的链接 - 将数据存储在数据库中或您想要对其进行的任何操作 - 然后重定向到广告指向的 URL至。

您想要的是这样的流程：

`user clicks ad -> runs your PHP code, which saves the data (such as ID of ad clicked, URL being sent to, IP of the person clicking etc etc etc) -> redirects user to the intended destination`

# java - Maven：从 pom.xml 创建目录结构

> ID：11668583
> 
> 赞同：28
> 
> 时间：2012-07-26T11:45:49.023
> 
> 标签：java, maven, maven-3

我有 Maven 一个 pom.xml 文件（从另一个项目复制并改编），我想为一个新项目生成目录结构。哪个命令可以做到这一点？

请注意，我在网上找到了无数示例，解释了如何使用**mvn archetype:create**创建一个 pom.xml 文件和目录结构，但我已经有一个 pom.xml，我想创建基于即，无需在命令行上指定 groupId、artifactId 等。

**mvn archetype:create-from-project**似乎也基于另一个 pom.xml （？）创建了一个 pom.xml，但我只想要目录。先感谢您！

编辑：我知道这不是一个“大问题”，因为我可以手动创建目录:) 我已经做过很多次了，我一直觉得必须有*更聪明*的方法来做......

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-04T14:06:03.930

我同意*应该*有一种方法来指定 maven 本身应该查看我的 pom 并从中生成项目/目录结构。我不知道如何做到这一点，但这就是我所做的：

**第 1 步**：将您已经创建的 pom.xml 移动到其他地方（如果您已经在运行下一个命令的目录中拥有它，maven 会抱怨）

**第 2 步**：从命令行，在新的 maven 项目目录中执行：

```
mvn archetype:generate -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false -DgroupId=my.package.path -DartifactId=myartifact 
```

您确实必须编辑 groupId 和 artifactId 以匹配您的 pom（叹气），但这会为您创建基本的目录结构以及默认的 Java 类和单元测试。

**第 3 步**：将您的 pom.xml 移动/复制到该项目目录中

**第 4 步**：运行一些 maven 命令，例如`mvn clean package`或`mvn dependency:tree`开始下载依赖项

*注意：*我包含这个答案是因为以前的一些答案建议使用`mvn archetype:create`，但根据 maven 网站[，不推荐使用目标](http://maven.apache.org/archetype/maven-archetype-plugin/create-mojo.html)以支持使用`generate`。我想展示如何独立于任何 IDE 或 IDE 插件来做到这一点。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-26T12:28:42.340

听起来不是居高临下，而是：

```
mkdir -p src/main/java
mkdir -p src/main/resources
mkdir -p src/test/java
mkdir -p src/test/resources 
```

（或随意替换不同的目录）。

我不知道有任何 maven 命令可以在不创建新 pom 文件的情况下为您创建此结构。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T12:02:23.393

在我看来，你好像在用一个小问题制造一个大问题。

我会尝试使用`mvn archetype:create-from-project`... 然后将生成的 POM 文件替换为原始文件。

正如 Peter Lawrey 所建议的那样，许多现代 IDE 都能够创建 Maven 项目结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-22T15:13:55.830

类似于马特的回答，这些行将在 Microsoft Windows 操作系统上创建默认的 maven 文件夹结构。从 pom.xml 所在的目录运行它们：

```
mkdir -p src/main/java
mkdir -p src/main/resources
mkdir -p src/test/java
mkdir -p src/test/resources 
```

我想知道为什么没有为此的 Maven 命令。您可以运行上面的 mkdir 命令，或者使用原型代替，即快速启动。盒子里已经有文件夹结构了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-26T03:14:51.810

Maven 可以使用快速入门原型为您生成它：

```
mvn archetype:generate \
    -DgroupId=com.mydomain \
    -DartifactId=my-project \
    -DarchetypeArtifactId=maven-archetype-quickstart 
```

然后，将现有的 pom.xml 复制并粘贴到与生成的 pom.xml 相同的目录中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-26T20:13:42.823

打开命令行，将目录更改为带有 pom.xml 的文件夹，然后将其粘贴
到 CMD 中：

```
echo This will create all required folders for maven project.
echo creating  Application\Library sources
MD "src\main\java"
echo creating  Application\Library resources
MD "src\main\resources"
echo creating  Resource filter files
MD "src\main\filters"
echo creating  Web application sources
MD "src\main\webapp"
echo creating  Test sources
MD "src\test\java"
echo creating  Test resources
MD "src\test\resources"
echo creating  Test resource filter files
MD "src\test\filters"
echo creating  Integration Tests (primarily for plugins)
MD "src\it"
echo creating  Assembly descriptors
MD "src\assembly"
echo creating  Site
MD "src\site" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-27T01:42:50.253

使用[Maven 构建助手插件](http://www.mojohaus.org/build-helper-maven-plugin/)。用法非常简单。只需在 pom 的插件部分进行配置，然后调用适当的 mvn 目标。

从文档中：

```
<project>
  ...
  <build>
    <plugins>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>build-helper-maven-plugin</artifactId>
        <version>1.10</version>
        <executions>
          <execution>
            <id>add-source</id>
            <phase>generate-sources</phase>
            <goals>
              <goal>add-source</goal>
            </goals>
            <configuration>
              <sources>
                <source>some directory</source>
                ...
              </sources>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
</project> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-07T14:01:16.483

正如上面许多答案所建议的那样，我发现这是最快的

```
mkdir -p src/{main,test}/{java,resources} 
```

这将生成以下结构

```
.
├── pom.xml
└── src
    ├── main
    │   ├── java
    │   └── resources
    └── test
        ├── java
        └── resources 
```

请注意如何通过在花括号中传递子目录名称，生成多个子目录。例如`mkdir -p src/{dir1,dir2,dir3}`会给你这个：

```
.
└── src
    ├── dir1
    ├── dir2
    └── dir3 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-08T17:59:52.230

我使用这个单线：

```
touch pom.xml && mkdir -p src/main/java && mkdir -p src/main/resources && mkdir -p src/test/java && mkdir -p src/test/resources 
```

它还会创建一个空的 pom.xml。为了快速访问，我把它放在我的笔记中。除此之外，它是类似的@Matt 答案。

# ruby-on-rails - Mongoid：数据选择错误

> ID：11668589
> 
> 赞同：0
> 
> 时间：2012-07-26T11:46:00.360
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mongodb, exception-handling, mongoid

我在 mongodb 数据库中使用了带有 mongoid gem 的 rails3.2.3。我有以下代码
`user = User.find_by(username: login)`
但是当发布的用户名与任何文档的用户名不匹配时，此代码会出错。错误是这样的：我没有任何想法来解决这个问题。请帮我。提前致谢。
`Problem:
Document(s) not found for class User with id(s) 5010cdc81d41c8d30b0000405. Summary: When calling User.find with an id or array of ids, each parameter must match a document in the database or this error will be raised. The search was for the id(s): 5010cdc81d41c8d30b0000405 ... (1 total) and the following ids were not found: 5010cdc81d41c8d30b0000405. Resolution: Search for an id that is in the database or set the Mongoid.raise_not_found_error configuration option to false, which will cause a nil to be returned instead of raising this error when searching for a single id, or only the matched documents when searching for multiples.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T06:54:17.627

为此使用
`user = User.find_or_create_by(username: login)`
，而不是
`user = User.find_by(username: login)`

# ruby-on-rails - has_many：通过继承类的方法

> ID：11668595
> 
> 赞同：0
> 
> 时间：2012-07-26T11:46:12.577
> 
> 标签：ruby-on-rails, ruby-on-rails-3, inheritance, has-many-through, single-table-inheritance

背景：我有一个简单的 has_many ：通过设置链接社区和帖子 - 它允许我调用@community.posts 或@post.communities。我还有一个继承自 Posts 的 Events 模型

目标：我想知道是否有一种 Rails 方法可以调用类似@community.events 的内容以仅返回属于该社区的事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T19:05:19.973

在社区模型中使用这些关联，

```
class Community < ActiveRecord::Base
  has_and_belongs_to_many :posts, conditions: {type: nil}
  has_and_belongs_to_many :events, join_table: "communities_posts", association_foreign_key: "post_id"
end 
```

对于帖子，您可以简单地使用，

```
has_and_belongs_to_many :communities 
```

# c# - WPF 错误：RichTextBox 中的 TextRange.GetPropertyValue

> ID：11668598
> 
> 赞同：1
> 
> 时间：2012-07-26T11:46:24.637
> 
> 标签：c#, .net, wpf, richtextbox, flowdocument

我必须在 WPF RichtTextBox 中检索所选文本的 Foreground 属性，但我认为 TextRange.GetPropertyValue 函数中存在错误。我编写了一个简单的应用程序来测试错误：

```
 <RichTextBox x:Name="rtfBox">
        <RichTextBox.Document>
            <FlowDocument>
                <Paragraph>
                    <Run>run run run</Run>
                    <Hyperlink TargetName="http://stackoverflow.com">stackoverflow.com</Hyperlink>
                </Paragraph>
            </FlowDocument>
        </RichTextBox.Document>
    </RichTextBox>
    <Button Content="Click!" Height="28" Click="Button_Click" /> 
```

在后面的代码中：

```
 private void Button_Click(object sender, RoutedEventArgs e)
    {
        var textrange = new TextRange(rtfBox.Selection.Start, rtfBox.Selection.End);
        var propertyValue = textrange.GetPropertyValue(TextElement.ForegroundProperty);
        MessageBox.Show(propertyValue.ToString());
    } 
```

当我选择 stackoverflow 超链接的前几个字符时，MessageBox 说 Foreground 属性是一个 DependencyProperty.UnsetValue，但是当我选择链接的其他部分时，它会显示真正的前景色。

它看起来像一个错误。

有没有解决这个问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T11:57:45.157

这是因为 TextElement.ForegroundProperty。如果将其更改为`Hyperlink.ForegroundProperty`，它将显示真实值。

# clearcase - 带有结帐的 ClearCase 基线

> ID：11668599
> 
> 赞同：2
> 
> 时间：2012-07-26T11:46:24.997
> 
> 标签：clearcase

在我正在工作的 clearcase 活动下，我已签入文件并签出文件（我目前正在处理这些签出文件）。我可以在不对这些签出文件执行撤消签出的情况下创建基线吗？问这个的原因是我希望基线只包含签入文件中的更改以及其他文件。也就是说，它应该在制作基线时自动采用当前签出文件的先前签入版本。这样的事情可能吗？我找不到任何解决方法。我也不能进行新的活动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:51:18.897

是的，[mkbl（制作基线）](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/topic/com.ibm.rational.clearcase.cc_ref.doc/topics/ct_mkbl.htm)只会为签入的文件设置基线。

```
–vie/w view-tag 
```

> 指定从中创建基线的视图。基线是在视图附加到的流中创建的。
> 
> 例如，如果您正在使用`coyne_dev_view`，但想从视图指定的配置创建基线`coyne_integration_view`，请使用`–view coyne_integration_view`. 此选项在项目的集成流中
> 创建基线，其中**包括**`coyne_integration_view`.
> 如果不指定 view-tag，则使用当前视图。

# python - 在 Numpy 中的向量上按 bin 应用函数

> ID：11668603
> 
> 赞同：3
> 
> 时间：2012-07-26T11:46:36.117
> 
> 标签：python, numpy

我将如何将聚合函数（例如“ `sum()`”或“ `max()`”）应用于向量中的 bin。

那就是如果我有：

1.  长度为 N 的值 x 向量
2.  长度为 N 的 bin 标签 b 的向量

这样 b 表示 x 中的每个值属于哪个 bin。对于 ba 中的每个可能值，我想对属于该 bin 的所有 x 值应用聚合函数“func()”。

```
>> x = [1,2,3,4,5,6]
>> b = ["a","b","a","a","c","c"] 
```

输出应该是 2 个向量（比如聚合函数是乘积函数）：

```
>>(labels, y) = apply_to_bins(values = x, bins = b, func = prod)

labels = ["a","b","c"]
y = [12, 2, 30] 
```

我想在 numpy （或只是 python）中尽可能优雅地做到这一点，因为显然我可以在它上面“for循环”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-28T10:18:40.670

有了这个[`pandas`](http://pandas.pydata.org) `groupby`

```
import pandas as pd

def with_pandas_groupby(func, x, b):
    grouped = pd.Series(x).groupby(b)
    return grouped.agg(func) 
```

使用 OP 的示例：

```
>>> x = [1,2,3,4,5,6]
>>> b = ["a","b","a","a","c","c"]
>>> with_pandas_groupby(np.prod, x, b)
a    12
b     2
c    30 
```

我只是对速度感兴趣，所以我比较了[senderle](https://stackoverflow.com/a/11677092/1301710)`with_pandas_groupby`答案中给出的一些功能。

*   apply_to_bins_groupby

    ```
     3 levels,      100 values: 175 us per loop
     3 levels,     1000 values: 1.16 ms per loop
     3 levels,  1000000 values: 1.21 s per loop

    10 levels,      100 values: 304 us per loop
    10 levels,     1000 values: 1.32 ms per loop
    10 levels,  1000000 values: 1.23 s per loop

    26 levels,      100 values: 554 us per loop
    26 levels,     1000 values: 1.59 ms per loop
    26 levels,  1000000 values: 1.27 s per loop 
    ```

*   apply_to_bins3

    ```
     3 levels,      100 values: 136 us per loop
     3 levels,     1000 values: 259 us per loop
     3 levels,  1000000 values: 205 ms per loop

    10 levels,      100 values: 297 us per loop
    10 levels,     1000 values: 447 us per loop
    10 levels,  1000000 values: 262 ms per loop

    26 levels,      100 values: 617 us per loop
    26 levels,     1000 values: 795 us per loop
    26 levels,  1000000 values: 299 ms per loop 
    ```

*   with_pandas_groupby

    ```
     3 levels,      100 values: 365 us per loop
     3 levels,     1000 values: 443 us per loop
     3 levels,  1000000 values: 89.4 ms per loop

    10 levels,      100 values: 369 us per loop
    10 levels,     1000 values: 453 us per loop
    10 levels,  1000000 values: 88.8 ms per loop

    26 levels,      100 values: 382 us per loop
    26 levels,     1000 values: 466 us per loop
    26 levels,  1000000 values: 89.9 ms per loop 
    ```

所以`pandas`对于大件物品来说是最快的。此外，级别（箱）的数量对计算时间没有太大影响。（请注意，时间是从 numpy 数组开始计算的，`pandas.Series`包括创建时间）

我生成的数据是：

```
def gen_data(levels, size):
    choices = 'abcdefghijklmnopqrstuvwxyz'
    levels = np.asarray([l for l in choices[:nlevels]])
    index = np.random.random_integers(0, levels.size - 1, size)
    b = levels[index]
    x = np.arange(1, size + 1)
    return x, b 
```

然后像这样运行基准测试`ipython`：

```
In [174]: for nlevels in (3, 10, 26):
   .....:     for size in (100, 1000, 10e5):
   .....:         x, b = gen_data(nlevels, size)
   .....:         print '%2d levels, ' % nlevels, '%7d values:' % size,
   .....:         %timeit function_to_time(np.prod, x, b)
   .....:     print 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T13:43:25.763

如果你要做这种事情，我强烈建议使用[Pandas](http://pandas.pydata.org/)包。有一个不错的 groupby() 方法，您可以在数据框或 Series 上调用该方法，使此类事情变得简单。

例子：

```
 In [450]: lst = [1, 2, 3, 1, 2, 3]
In [451]: s = Series([1, 2, 3, 10, 20, 30], lst)
In [452]: grouped = s.groupby(level=0)
In [455]: grouped.sum()
Out[455]: 
1    11
2    22
3    33
            回答 #3

赞同：1

时间：2012-07-26T19:58:21.543

有几个有趣的解决方案不依赖于`groupby`. 第一个非常简单：

```
def apply_to_bins(func, values, bins):
    return zip(*((bin, func(values[bins == bin])) for bin in set(bins))) 
```

这使用“花式索引”而不是分组，并且对于小输入执行得相当好；基于列表理解的变体做得更好（请参阅下面的时间）。

```
def apply_to_bins2(func, values, bins):
    bin_names = sorted(set(bins))
    return bin_names, [func(values[bins == bin]) for bin in bin_names] 
```

这些具有可读性强的优点。两者的表现也比`groupby`小输入好，但对于大输入，它们的速度要慢得多，尤其是当有很多 bin 时；他们的表现是`O(n_items * n_bins)`。对于小输入，另一种`numpy`基于 - 的方法较慢，但对于大输入要快得多，尤其是对于具有大量 bin 的大输入：

```
def apply_to_bins3(func, values, bins):
    bins_argsort = bins.argsort()
    values = values[bins_argsort]
    bins = bins[bins_argsort]
    group_indices = (bins[1:] != bins[:-1]).nonzero()[0] + 1
    groups = numpy.split(values, group_indices)
    return numpy.unique(bins), [func(g) for g in groups] 
```

一些测试。首先对于小输入：

```
>>> def apply_to_bins_groupby(func, x, b):
...         return zip(*[(k, np.product(x[list(v)]))
...                  for k, v in groupby(np.argsort(b), key=lambda i: b[i])])
... 
>>> x = numpy.array([1, 2, 3, 4, 5, 6])
>>> b = numpy.array(['a', 'b', 'a', 'a', 'c', 'c'])
>>> 
>>> %timeit apply_to_bins(numpy.prod, x, b)
10000 loops, best of 3: 31.9 us per loop
>>> %timeit apply_to_bins2(numpy.prod, x, b)
10000 loops, best of 3: 29.6 us per loop
>>> %timeit apply_to_bins3(numpy.prod, x, b)
10000 loops, best of 3: 122 us per loop
>>> %timeit apply_to_bins_groupby(numpy.prod, x, b)
10000 loops, best of 3: 67.9 us per loop 
```

这里的`apply_to_bins3`表现不太好，但它仍然比最快的慢一个数量级。变大时效果更好`n_items`：

```
>>> x = numpy.arange(1, 100000)
>>> b_names = numpy.array(['a', 'b', 'c', 'd'])
>>> b = b_names[numpy.random.random_integers(0, 3, 99999)]
>>> 
>>> %timeit apply_to_bins(numpy.prod, x, b)
10 loops, best of 3: 27.8 ms per loop
>>> %timeit apply_to_bins2(numpy.prod, x, b)
10 loops, best of 3: 27 ms per loop
>>> %timeit apply_to_bins3(numpy.prod, x, b)
100 loops, best of 3: 13.7 ms per loop
>>> %timeit apply_to_bins_groupby(numpy.prod, x, b)
10 loops, best of 3: 124 ms per loop 
```

当`n_bins`上升时，前两种方法需要很长时间才能在这里显示 - 大约五秒钟。`apply_to_bins3`是这里的明显赢家。  

```
>>> x = numpy.arange(1, 100000)
>>> bn_product = product(['a', 'b', 'c', 'd', 'e'], repeat=5)
>>> b_names = numpy.array(list(''.join(s) for s in bn_product))
>>> b = b_names[numpy.random.random_integers(0, len(b_names) - 1, 99999)]
>>> 
>>> %timeit apply_to_bins3(numpy.prod, x, b)
10 loops, best of 3: 109 ms per loop
>>> %timeit apply_to_bins_groupby(numpy.prod, x, b)
1 loops, best of 3: 205 ms per loop 
```

总的来说，`groupby`在大多数情况下可能没问题，但不太可能很好地扩展，正如[这个线程](https://stackoverflow.com/questions/4651683/numpy-grouping-using-itertools-groupby-performance)所建议的那样。使用 pure(er)`numpy`方法，对于小输入来说速度较慢，但​​只有一点点；权衡是一个很好的选择。

            回答 #4

赞同：1

时间：2012-07-26T11:51:20.863

```
import itertools as it
import operator as op

def apply_to_bins(values, bins, func):
    return {k: func(x[1] for x in v) for k,v in it.groupby(sorted(zip(bins, values), key=op.itemgetter(0)), key=op.itemgetter(0))}

x = [1,2,3,4,5,6]
b = ["a","b","a","a","c","c"]   

print apply_to_bins(x, b, sum) # returns {'a': 8, 'b': 2, 'c': 11}
print apply_to_bins(x, b, max) # returns {'a': 4, 'b': 2, 'c': 6} 
```

            回答 #5

赞同：1

时间：2012-07-26T11:58:34.983

```
>>> from itertools import groupby
>>> x = np.array([1, 2, 3, 4, 5, 6])
>>> zip(*[(k, np.product(x[list(v)]))
...       for k, v in groupby(np.argsort(b), key=lambda i: b[i])])
[('a', 'b', 'c'), (12, 2, 30)] 
```

或者，一步一步：

```
>>> np.argsort(b)
array([0, 2, 3, 1, 4, 5]) 
```

`b`（或）的索引列表，`x`按 中的键排序`b`。

```
>>> [(k, list(v)) for k, v in groupby(np.argsort(b), key=lambda i: b[i])]
[('a', [0, 2, 3]), ('b', [1]), ('c', [4, 5])] 
```

按 键分组的索引`b`。

```
>>> [(k, x[list(v)]) for k, v in groupby(np.argsort(b), key=lambda i: b[i])]
[('a', array([1, 3, 4])), ('b', array([2])), ('c', array([5, 6]))] 
```

使用索引从中获取正确的元素`x`。

```
>>> [(k, np.product(x[list(v)]))
...  for k, v in groupby(np.argsort(b), key=lambda i: b[i])]
[('a', 12), ('b', 2), ('c', 30)] 
```

申请`np.product`。

所以，把所有东西放在一起，

```
def apply_to_bins(values, bins, op):
    grouped = groupby(np.argsort(bins), key=lambda i: bins[i])
    applied = [(bin, op(x[list(indices)])) for bin, indices in grouped]
    return zip(*applied) 
```

            回答 #6

赞同：0

时间：2014-06-21T17:35:28.010

在聚合函数`func`可以表示为总和的特殊情况下，then`bincount`似乎比 快`pandas`。例如当`func`是乘积时，它可以表示为对数之和，我们可以这样做：

```
x = np.arange( 1000000 )
b = nr.randint( 0, 100, 1000000 )

def apply_to_bincount( values, bins ) :
    logy = np.bincount( bins, weights=np.log( values ) )
    return np.arange(len(logy)), np.exp( logy )

%%timeit
apply_to_bincount( x, b )
10 loops, best of 3: 16.9 ms per loop

%%timeit
with_pandas_groupby( np.prod, x, b )
10 loops, best of 3: 36.2 ms per loop 
```

```

# ruby-on-rails - 山狮 - LibXML 和 Nokogiri

> ID：11668604
> 
> 赞同：26
> 
> 时间：2012-07-26T11:46:37.380
> 
> 标签：ruby-on-rails, ruby, libxml2, homebrew, osx-mountain-lion

我刚刚更新到 OS X Mountain Lion，在使用 rails 和 terminal 时我得到了以下信息。

```
WARNING: Nokogiri was built against LibXML version 2.8.0, but has dynamically loaded 2.7.8 
```

我已经查看了类似问题的其他答案，但它们似乎并没有阻止警告消息的出现。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-29T19:08:59.860

我在 ruby​​ 1.9.2 上安装 nokogiri gem 时遇到了类似的问题，显然 Apple 升级了 gcc ......我用符号链接修复了这个问题，然后 gem 安装得很好：

`sudo ln -s /usr/bin/gcc /usr/bin/gcc-4.2`

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-19T05:27:49.200

把`gem 'nokogiri'`上面`gem 'pg'`放在我的 Gemfile 中为我解决了这个问题。

我的 Gemfile 中没有 nokogiri，但它是 Gemfile.lock 中的一个依赖项，所以我明确地将它放在我的 Gemfile 中。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-07-30T02:31:14.430

如果你有一个 Gemfile 并且正在使用 bundler，那么传递标志来安装 gems 通常是一个坏主意。即使您不是，您也将使用自定义编译的 libxml，您可能不会记得...！我开始尝试尝试让它工作，甚至 brew 安装 libxml2。

事实证明，如果您重新安装（并因此重新编译）您正在使用的 ruby​​ 版本（希望使用 rvm），它会起作用。

因此，对于 RVM 用户：

```
 rvm list (gets your rubies - choose the one being used)
    rvm uninstall RUBY_VERSION
    rvm install SAME_RUBY_VERSION
    bundle (or gem install nokogiri) 
```

它对我有用。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-01-18T07:32:38.987

在 OS X 10.8.2 (Mountain Lion) 上使用 Ruby 1.9.3-p194 和 Rails 3.2.11，启动 rails c 会发出警告：

```
WARNING: Nokogiri was built against LibXML version 2.8.0, but has dynamically loaded 2.7.8 
```

卸载/安装 nokogiri 技巧对我不起作用。解决方案要简单得多...通过编辑 Gemifile 将“nokogiri”放在“pg”上方，完全避免了警告。

参考：

*   [https://github.com/sparklemotion/nokogiri/issues/742](https://github.com/sparklemotion/nokogiri/issues/742)
*   [http://www.alanmaciel.net/?p=104](http://www.alanmaciel.net/?p=104)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-25T09:21:49.640

到目前为止列出的所有解决方案都对我不起作用。

所以，我做了一个`brew uninstall libxml2`libxml2 2.8.0 版本，我猜我的 os x 预装了 libxml2 2.7.8 版本

然后我做了`gem uninstall nokogiri`然后`gem install nokogiri`

警告现在消失了。但它是 libxml2 版本 2.7.8 而不是最新的。因此，如果您建议一些适用于最新版本 libxml2 的解决方案，我将不胜感激。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-07-26T13:22:08.167

我刚遇到这个问题。

我的问题出乎意料地轻松解决了。

`gem uninstall nokogiri`

已选中`all versions`

然后`gem install nokogiri`它就消失了。

如果您使用的是自制软件，则可以`brew update`和`brew doctor`. 升级到山狮甚至删除了我的 git 和东西。我通过在 Xcode 中安装 cc 工具并使用 brew doctor 来确保它`raring to go`在上述之前安装它。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-07-26T16:18:05.420

所以我最终使用了以下命令：

```
bundle config build.nokogiri --with-xml2-include=/usr/local/Cellar/libxml2/2.7.8/include/libxml2 --with-xml2-lib=/usr/local/Cellar/libxml2/2.7.8/lib --with-xslt-dir=/usr/local/Cellar/libxslt/1.1.26/ 
```

然后做：

```
gem uninstall nokogiri
gem install nokogiri 
```

然后跑了

```
bundle install 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-11-06T01:57:43.547

似乎没有什么对我有用来解决这个问题。

然后我进入 xcode 并安装了更新的命令行工具，然后`gem uninstall nokogiri`就`gem install nokogiri`成功了！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-27T14:42:21.570

升级 ruby​​-build 后

```
brew update
brew upgrade ruby-build 
```

我刚刚重新安装了 ruby​​（最新版本）

```
rbenv install 1.9.3-p194 
```

然后我安装了所有与我的项目相关的 gem，包括 nokogiri，没有进一步的问题。

```
gem install bundler
bundle 
```

# jquery - jQuery - 属性值未定义

> ID：11668608
> 
> 赞同：0
> 
> 时间：2012-07-26T11:46:49.380
> 
> 标签：jquery, selenium-rc

svg 元素的 Html 代码：

```
<image xlink:href="start.gif" style="pointer-events:none" x="165" y="175" width="100" height="100" stroke-width="1" transform=" scale(1 1) translate(0 0)"/> 
```

就像 POC 一样，

```
$('image').attr('xlink:href'); 
```

确实将属性值返回为`start.gif`.

现在我需要所有图像元素的属性值，所以我写了一个函数

```
function script()
{
    var result = new Array();
    var elements = selenium.browserbot.getCurrentWindow().jQuery('image');
    for(var i = 0 ; i < elements.length ; i++)
    {
        result[i] = $(this).attr('xlink:href');
    }
    return result;
}
script(); 
```

但这会返回`undefined`

为什么会这样？

是的，我确实尝试过使用 jQuery 的 $.each(function(key, value))，但是 selenium 会抛出“错误：抛出异常：c.call 不是函数”。不明白 c 和 call 指的是什么，所以想用 js for 循环。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:50:29.203

使用 jQuery`.each`并尝试`$(this)`

```
var elements = selenium.browserbot.getCurrentWindow().jQuery('image');
elements.each(function(i) {
    result[i] = $(this).attr('xlink:href');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:01:54.580

为什么会这样？因为`this`在该功能的范围内不是您认为的（或希望的）。在不知道确切上下文的情况下，`this`可能指向窗口、另一个元素或对象的实例。

您有一个存储在`elements`数组中的图像列表，并且您想创建一个 jQuery 对象，其中包含存储在`i`该数组索引处的图像，因此请使用`$(elements[i])`而不是`$(this)`.

我预计发生的情况是，在您最初尝试 using 失败后`$.each()`，您将其修改为标准的 Javascript`for`循环，但留下了（现在不正确的）使用 of`this`来引用迭代中的当前元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:49:45.810

尝试：

```
result[i] = $(elements[i]).attr('xlink:href'); 
```

# bash - 如何从 CSV 文件中获取每一行的第一列？

> ID：11668621
> 
> 赞同：42
> 
> 时间：2012-07-26T11:47:57.460
> 
> 标签：bash, shell, csv, awk, text-parsing

如何获取输入 CSV 文件中每一行的第一列并输出到新文件？我正在考虑使用`awk`但不确定如何使用。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-07-26T11:49:42.690

试试这个：

```
 awk -F"," '{print $1}' data.txt 
```

它将`data.txt`根据`,`字符（用 指定）将文件中的每个输入行拆分为不同的字段，`-F`并将第一个字段（列）打印到标准输出。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2012-07-26T11:50:22.513

可以做到：

```
$ cut -d, -f1 data.txt 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-07-26T11:50:51.690

```
echo "a,b,c" | cut -d',' -f1 > newFile 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-26T12:01:14.977

**输入**

```
a,12,34
b,23,56 
```

**代码**

```
awk -F "," '{print $1}' Input 
```

**格式**

```
awk -F <delimiter> '{print $<column_number>}' Input 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-11-12T13:37:44.170

这可以通过以下方式实现`grep`：

```
$ grep -o '^[^,]\+' file.csv 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-12T18:50:39.547

使用 Perl：

`perl -F, -lane 'print $F[0]' data.txt > data2.txt`

使用这些命令行选项：

*   `-n`循环输入文件的每一行
*   `-l`在处理之前删除换行符，然后将它们添加回来
*   `-a`自动拆分模式——将输入行拆分到`@F`数组中。默认为空格分割。
*   `-e`执行 perl 代码
*   `-F`自动拆分修饰符，在这种情况下拆分`,`

* * *

如果要就地修改原始文件，请使用以下`-i`选项：

`perl -i -lane 'print $F[0]' data.txt`

* * *

如果您想就地修改原始文件并制作备份副本：

`perl -i.bak -lane 'print $F[0]' data.txt`

* * *

如果您的数据是空格分隔而不是逗号分隔：

`perl -lane 'print $F[0]' data.txt`

# php - 用php在html元素'a'中添加html元素'h1'

> ID：11668623
> 
> 赞同：-2
> 
> 时间：2012-07-26T11:47:58.690
> 
> 标签：php

我在 php 中有以下 html 字符串

```
$html='<div style="display:block; float:left; width:40px;">&nbsp;</div><a href="http://cosa.gr/index.php?cPath=15" class="headerNavigation">text</a>'; 
```

我需要在 a 元素中添加一个 'h1' html 元素，如果字符串文本采用编程方式。下面的代码显示了我需要的结果。

```
$html='<div style="display:block; float:left; width:40px;">&nbsp;</div><a href="http://cosa.gr/index.php?cPath=15" class="headerNavigation"><h1>text</h1></a>'; 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:56:49.740

```
$html = '<div style="display:block; float:left; width:40px;">&nbsp;</div><a href="http://cosa.gr/index.php?cPath=15" class="headerNavigation">text</a>';
$html = preg_replace('|class="headerNavigation">(.+?)</a>|', 'class="headerNavigation"><h1>$1</h1></a>' ,$html);
print_r($html); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:59:06.377

`heading`在最后一个标签中插入`anchor`标签：

```
$start = strrpos(substr($html,0,strrpos($html,"</a>")),">"); 
$html = substr_replace($html, "<h1>", $start+1,0);
$html = str_replace("</a>","</h1></a>",$html); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T11:55:06.200

a) 修改代码，通常包含一个 h1-Tag

b）用正则表达式替换链接文本：

```
$oldstring = "... dour data without h1 ...";
$text = "... the Link-Text ...";
$newstring = preg_replace("/" . preg_quote($text) . "/", "<h1>" . $text . "</h1>", $oldstring);
echo $newstring; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T11:58:02.993

可能你需要这个？最简单的方法。

```
$html='<div style="display:block; float:left; width:40px;">&nbsp;</div><a href="http://cosa.gr/index.php?cPath=15" class="headerNavigation">text</a>';

function inserth1($str) {
   $str = str_replace('class="headerNavigation">','class="headerNavigation"><h1>', $str);
   $str = str_replace('</a>','</h1></a>', $str);
   return $str;
}

echo inserth1($html); 
```

# web-applications - 多租户 Web/SaaS 应用程序

> ID：11668624
> 
> 赞同：0
> 
> 时间：2012-07-26T11:48:11.373
> 
> 标签：web-applications, saas, multi-tenant

我想就开发可在 Web 上使用的多租户应用程序征求一般性建议。

我想到的应用程序具有以下属性/要求：

*   可能多达 1000 个个人组织。数据是私有的，因此不应（有意或无意地）在组织之间提供。
*   每个组织的多达 100,000 条数据记录
*   每天至少有 2-3 个用户积极参与每个组织的系统
*   偏好是每个组织都使用具有定制的相同应用程序库

我想知道哪种开发环境/框架适合这项任务？我已经阅读了很多有关 Scala/Lift 等技术的资料，但我无法找到任何建议这些东西是否适合这种用途。这种应用程序是否需要多个数据库和/或多个应用程序实例才能有效运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-04T11:26:41.770

自从您发布此问题以来已经有很长时间了，但是我现在碰巧看了一下。

这是您可以使用的。您可以使用 Microsoft .Net Framework 4.0 或更高版本、ASP.NET MVC 2.0 或更高版本，以及 ASP.Net MVC4.0，您可以开箱即用地启用 REST 功能。对于数据库，您可以使用 Microsoft 的 MySQL、Oracle 或 SQL Server。这些是被 Amazon、Azure 等广泛支持的技术……Ruby 也被用于开发。我与 Microsoft .Net 合作过，发现它非常舒适，因为它支持通过 ASP.Net MVC 开箱即用地分离关注点，而且企业库可以有效地用于处理横切关注点。有很多技术论文 [Research Scholars] 也谈到了使用 .Net 进行 SaaS 应用程序开发。

# dotless - dotless 在任何变量或 mixins（函数）上都失败。变量@background-dark 未定义

> ID：11668625
> 
> 赞同：1
> 
> 时间：2012-07-26T11:48:14.150
> 
> 标签：dotless

如果我以 dotless 或 mixins 的形式调用任何变量，则生成的 CSS 文件为空。

我的设置如下：

1.  我有一个导入文件，它导入我所有其他基于 dotless 的 css 文件
2.  第一个导入是变量
3.  第二个导入是mixins（方法）
4.  其次是我需要的任何其他文件

因此该文件`00.1.import.less`将具有以下内容：

```
@import "00.2.variables";
@import "00.3.methods";
@import "00.4.init";
@import "01.1.html"; 
```

当我将生成的链接复制到新选项卡时，它显示：

```
variable @background-dark is undefined on line 24 in file '/Content/00.1.import.less':

 [23]: @import "11.1.p";
 [24]: @import "13.1.a";
       ---------------^
 [25]: @import "13.2.a-login"; 
```

奇怪的是，那条线就是这样，一条导入线。该文件根本不使用任何变量或混合。下一个文件也没有。目前我正在测试一个变量/混合一个文件。

如果我按 F5，我得到的下一个异常是：

```
Value does not fall within the expected range.

Stack Trace:    

[ArgumentException: Value does not fall within the expected range.]
   System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo) +0
   System.Web.Hosting.IIS7WorkerRequest.SetKnownResponseHeader(Int32 index, String value, Boolean replace) +150
   System.Web.HttpHeaderCollection.SetHeader(String name, String value, Boolean replace) +219
   System.Web.HttpHeaderCollection.Add(String name, String value) +23
   System.Web.HttpResponse.AppendHeader(String name, String value) +189
   System.Web.HttpResponseWrapper.AppendHeader(String name, String value) +16
   dotless.Core.Response.CssResponse.HandleCompression() +646
   dotless.Core.Response.CssResponse.WriteCss(String css) +79
   dotless.Core.Loggers.AspResponseLogger.Log(String message) +50
   dotless.Core.Loggers.Logger.Log(LogLevel level, String message) +80
   dotless.Core.Loggers.Logger.Error(String message) +43
   dotless.Core.LessEngine.TransformToCss(String source, String fileName) +562
   dotless.Core.ParameterDecorator.TransformToCss(String source, String fileName) +420
   dotless.Core.HandlerImpl.Execute() +152
   dotless.Core.LessCssHttpHandler.ProcessRequest(HttpContext context) +123
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +100
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75 
```

示例变量问题：声明

```
@background-dark: #404040; 
```

用法

```
div#top
{
    height:125px;
    border-top: 2px solid #158fa6;
    background:@background-dark;
} 
```

无论我做什么，这都会失败。

有人知道我要去哪里错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:17:08.397

似乎有 2 个问题。首先，这应该报告给[http://github.com/dotless/dotless](http://github.com/dotless/dotless)而不是堆栈溢出，但无论如何我会继续。

缓存问题似乎是一个异常设置标头 - 我以前没有看到过，它需要调查以找出问题所在。

变量问题可能是我们在 1.3.0.5 之前遇到的一个错误，它没有正确报告导入文件中的错误。如果您不在 1.3.05 上，请升级并重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T21:48:31.957

# 雅克，

首先，这与其说是解释不如说是答案。

您似乎遇到了与我相同的编译、捆绑、缩小订单问题。

[Dotless - 无法使用 MVC 捆绑在单独的文件中引用较少的变量](https://stackoverflow.com/questions/13403346/dotless-cant-reference-less-variable-in-separate-file-with-mvc-bundling)

我遇到并且正在尝试解决的问题是，我在单独的文件中引用变量和 mixin（在引用之前包含在内），但找不到它们。由于文件编译是单独处理的，因此正在编译的文件不知道以前编译的文件。在这种情况下，dotless 不会返回要捆绑的内容。

我已经对 process 方法进行了一些不同的修改，以手动捆绑然后缩小，但 dotless 似乎没有一种功能方法可以在没有物理文件名可供参考的情况下编译 less。

如果我不在基地，请告诉我。

# c - 多线程、gtk3 和 cairo：在 cairo 表面中绘图

> ID：11668628
> 
> 赞同：1
> 
> 时间：2012-07-26T11:48:23.623
> 
> 标签：c, drawing, cairo, gtk3, gdk

我正在尝试从线程中绘制到 cairo 图像表面，但出现断言错误：

> gtk_mt：/build/buildd/cairo-1.10.2/src/cairo-surface.c:385：_cairo_surface_begin_modification：断言`！表面->完成'失败。中止（核心转储）

这是我的程序：

```
#include <stdlib.h>
#include <gtk/gtk.h>
#include <gdk/gdk.h>
#include <cairo.h>

#define IMAGE_WIDTH 320
#define IMAGE_HEIGHT 200

gpointer thread_func(gpointer data)
{
    int x, y;
    unsigned char rgb_r, rgb_g, rgb_b;
    GtkWidget *widget = (GtkWidget*)data;
    GdkWindow *window;
    cairo_t *cr;
    cairo_format_t format = CAIRO_FORMAT_ARGB32;
    cairo_surface_t *surface;
    unsigned char *image_data, *rgbptr;
    int width = IMAGE_WIDTH;
    int height = IMAGE_HEIGHT;
    int stride;

    gdk_threads_enter();
    stride = cairo_format_stride_for_width(format, width);
    image_data = malloc(stride * height);
    surface = cairo_image_surface_create_for_data(image_data, format, width, height, stride);
    window = gtk_widget_get_window(widget);
    cr = gdk_cairo_create(window);
    gdk_threads_leave();

    while(1)
    {
        rgb_r = random() & 0xff;
        rgb_g = random() & 0xff;
        rgb_b = random() & 0xff;

        for(y = 0; y < height; ++y)
        {
            rgbptr = &image_data[y * stride];
            if(!(random() & 0x3f))
            {
                rgb_r = random() & 0xff;
                rgb_g = random() & 0xff;
                rgb_b = random() & 0xff;
            }           

            for(x = 0; x < width; ++x)
            {
                *rgbptr++ = rgb_r; *rgbptr++ = rgb_g; *rgbptr++ = rgb_b;
                *rgbptr = 0xff;
            }
        }

        gdk_threads_enter();
        cairo_set_source_surface(cr, surface, 0, 0);
        cairo_paint(cr);
        gdk_threads_leave();
        sleep(2);
    }

    return( NULL );
}

int main(int argc, char **argv)
{
  GtkWidget *window;
  GtkWidget *darea;
  GThread *thread;
  GError *error = NULL;

  if(! g_thread_supported())
        g_thread_init(NULL);
  gdk_threads_init();

  gdk_threads_enter();
  gtk_init(&argc, &argv);

  window = gtk_window_new(GTK_WINDOW_TOPLEVEL);
  darea = gtk_drawing_area_new();
  gtk_widget_set_size_request(darea, IMAGE_WIDTH, IMAGE_HEIGHT);
  gtk_container_add(GTK_CONTAINER (window), darea);
  gtk_widget_show_all (window);

    thread = g_thread_create(thread_func, (gpointer)darea, FALSE, &error);
    if(!thread)
    {
        g_print("Error: %s\n", error->message);
        return(-1);
    }

    gtk_main();
    gdk_threads_leave();

    return( 0 );
} 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T11:52:23.507

好的，似乎无法重用surface和cr。我将这些调用移到循环的 gdk_threads_enter() 部分中，然后它就可以工作了。（另外，有一个错误，我通过执行 *rgbptr = 0xff 写入 A 通道，我忘记了 post-inc 指针。）

# openerp - openerp：在树视图中选择的所有 id 上调用方法的操作

> ID：11668636
> 
> 赞同：4
> 
> 时间：2012-07-26T11:48:38.240
> 
> 标签：openerp

我想创建一个操作，该操作将调用模型上的方法，传递树视图中所选行的 ID，以便在选择项目时该操作在屏幕的右侧可用。是否可以在不使用单个“确定”按钮创建向导的情况下做到这一点？

通常，我希望能够调用 ir.module.module 的 button_upgrade 方法来一次更新多个模块，但这对应用程序中的许多情况很有用。

我正在使用 OpenERP 6.1 和 web 客户端。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-12T21:01:13.583

我没有 v6，但这适用于 v7：

```
<record id="action_id_name" model="ir.actions.server">
    <field name="name">Name that shows in More button</field>
    <field name="type">ir.actions.server</field>
    <field name="model_id" ref="model_blah_blah"/>
    <field name="state">code</field>
    <field name="code">self.some_custom_code(cr, uid, context.get('active_ids'), ..., context=context)</field>
</record>

<record id="value_id_name" model="ir.values">
    <field name="name">Name</field>
    <field name="action_id" ref="action_id_name"/>
    <field name="value" eval="'ir.actions.server,' + str(ref('action_id_name'))"/>
    <field name="key">action</field>
    <field name="model_id" ref="model_blah_blah"/>
    <field name="model">blah.blah</field>
    <field name="key2">client_action_multi</field>
</record>

def some_custom_code(self, cursor, uid, ids, ..., context):
    # possibly do some processing
    # maybe with the ... extra fields you added
    #
    # post your changes, either with an sql statement or by calling
    # self.write(...)
    return True 
```

您应该用实际值替换的名称：

*   `action_id_name`：您的操作记录的 id
*   `Name that shows in More button`：你想在按钮中显示的任何内容
*   `model_blah_blah`：使用的模型的名称（应与文件中的任何内容匹配`security/ir.model.access.csv`）
*   `some_custom_code`：模型中函数的名称
*   `value_id_name`: 你的action的值记录的id
*   `Name`：一个名字（不知道它出现在哪里）
*   `blah.blah`: 你的名字`model`和`table`OpenERP 符号
*   `...`：您添加的任何额外参数/参数

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T23:23:52.417

我在 5.0 中使用[旧式向导](http://bazaar.launchpad.net/~zaber/openobject-addons/main/view/3025/promise_date/wizard/wizard_sanity_checked.py)执行此操作，但我还没有看到在 6.1 Web 客户端中执行此操作的方法。您仍然可以在 6.1 GTK 客户端中使用旧式向导，但它在 Web 客户端中不起作用。

我猜你可以将财富消息传送到 OK 对话框中来娱乐你的用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-30T09:16:16.433

我得到了这个工作：

1.  创建一个新的**服务器操作**，在设置»自定义»低级对象»操作»服务器操作：

    *   **操作名称**：“升级选定模块”
    *   **对象**：ir.module.module
    *   **动作类型**：Python 代码
    *   **Python 代码**：action = obj.button_upgrade(context=context)
2.  创建一个新的**Action Binding**，在 Settings » Customization » Low Level Objects » Actions » Action Bindings：

    *   **名称**：“升级模块动作绑定”
    *   **型号名称**：ir.module.module
    *   **限定符**：client_action_multi
    *   **操作**：在“操作（仅限更改）”框中搜索“升级选定模块”。您应该获得类似以下内容的 Action Reference 字段：“ir.actions.server,680”。

论坛主题[“操作：如何获取选定的行？”](http://www.openerp.com/forum/topic24211.html) 被用作参考。您可能还会发现有趣的[电子邮件模板按钮](http://fossies.org/dox/openerp-6.1-1/email__template_8py_source.html#l00175)自动创建操作以使用定义的电子邮件模板进行群发邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-28T02:38:21.123

你应该能够通过一个`execute`动作来做到这一点。 [http://doc.openerp.com/v6.1/developer/03_modules_4.html#actions](http://doc.openerp.com/v6.1/developer/03_modules_4.html#actions%20%22OpenERP%20Developer%20Manual%20-%20Actions)

# database-design - 没有联结表的 M:N 关系

> ID：11668649
> 
> 赞同：0
> 
> 时间：2012-07-26T11:49:42.730
> 
> 标签：database-design, junction

给定两个表 Student(id,name) 和 course(course_id,course_name)。这两个表具有 M:N 关系。

*   有没有办法在不使用联结表的情况下在关系数据库中实现 M:N 关系？
*   如果不在关系数据库中，那么在任何其他数据库模型中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T18:48:40.970

> 有没有办法在不使用联结表的情况下在关系数据库中实现 M:N 关系？

当然，只需将一组“指针” ¹存储在其中一个表中。您可以使用 DBMS 本身支持的数组类型，也可以使用 VARCHAR 对其进行编码。

**但是**，这将使您的数据库异常规范化（您将[违反 1NF](http://en.wikipedia.org/wiki/1NF#Atomicity)），我无法想象为什么有人会在实践中这样做。

您是否有任何特定原因要避免使用联结表？

* * *

*¹另一个表中键的值。*

# android - 如何定义警报对话框在视图中的位置

> ID：11668653
> 
> 赞同：2
> 
> 时间：2012-07-26T11:49:53.360
> 
> 标签：android, android-alertdialog

> **可能重复：**
> [在屏幕的任何位置显示 AlertDialog](https://stackoverflow.com/questions/5469005/show-alertdialog-in-any-position-of-the-screen)

我制作了一个应用程序，在该应用程序中显示`alert dialog`. 我想将 a`custom layout`用于我的警报对话框。如何根据需要在`view/layout`.

我的代码：

```
LayoutInflater inflater=getLayoutInflater();
View view = inflater.inflate(R.layout.actionbarmain,null);
view.setMinimumWidth(200);
view.setMinimumHeight(400);

AlertDialog.Builder alertDialog = new AlertDialog.Builder(this);
alertDialog.setView(view);
alertDialog.show(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:30:26.607

要在警报对话框中添加自定义布局，您必须在其中膨胀布局：

测试xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

            <Button
                android:id="@+id/btn1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="test" />
            <Button
                android:id="@+id/btn2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="test" />
            <Button
                android:id="@+id/btn3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="test" />
</LinearLayout> 
```

如果您想在警报对话框中膨胀此 xml，则：

```
 AlertDialog.Builder builder=new Builder(YourActivityName.this);
                LayoutInflater inflater=getLayoutInflater();
                View view=inflater.inflate(R.layout.testxml, null);
                builder.setView(view);
                builder.setTitle("New Project");
                builder.setMessage("knknknknknmknknknk");
                builder.setPositiveButton("ok", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int which) {

                    }
                });
                builder.setNegativeButton("cancel", new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int which) {

                    }
                });
                builder.create();
                builder.show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:07:08.200

使用您所需的布局创建一个活动，并将主题指定为清单中的对话框。

这是一个示例：您需要根据您的要求进行更改

```
public class EditPropertyActivity extends Activity {

    /** Called when the activity is first created. */
    // @Override
    /*
     * (non-Javadoc)
     * 
     * @see android.app.Activity#onCreate(android.os.Bundle)
     */
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.dialog);
        setTitle("");
        TextView propName = (TextView) findViewById(R.id.tv_propName);          

        propName.setText(getIntent().getExtras().getString("prop_label"));

        final EditText ed_propValue = (EditText) findViewById(R.id.ed_propValue);
        ed_propValue.setText(value);
        if (tagName.equals("timeout")) {
            ed_propValue.setInputType(InputType.TYPE_CLASS_NUMBER);
        }
        Button btn_save = (Button) findViewById(R.id.btn_save);
        btn_save.setOnClickListener(new View.OnClickListener() {
        //onclick
        }
    } 
```

在清单中：

```
 <activity
            android:name="EditPropertyActivity"
            android:theme="@android:style/Theme.Dialog" >
        </activity> 
```

布局对话框.xml：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/tv_propName"
        android:layout_width="200dip"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_marginBottom="10dip"
        android:layout_marginLeft="15dip"
        android:layout_marginRight="25dip"
        android:layout_marginTop="10dip"
        android:text="Medium Text"
        android:textAppearance="?android:attr/textAppearanceMedium" />

    <EditText
        android:id="@+id/ed_propValue"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:ems="10" >

        <requestFocus />
    </EditText>

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginLeft="2dp"
        android:layout_marginRight="2dp"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/btn_save"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/lbl_btn_save" />

        <Button
            android:id="@+id/btn_cancel"
            android:layout_width="0dip"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="@string/cancel" />
    </LinearLayout>

</LinearLayout> 
```

# ipad - 从 NSArray 获取值并将其添加到 NSDictionary

> ID：11668655
> 
> 赞同：0
> 
> 时间：2012-07-26T11:49:59.553
> 
> 标签：ipad, nsarray, nsdictionary

我`NSArray`在数组里面有很多字典。我希望将所有这些字典值放入单个字典中

```
jewels array (
    {
    headAccObi = "<AccessoriesObject: 0x7f7da00>";
},
    {
    headAccObi = "<AccessoriesObject: 0x7f7da00>";
    noseAccObj = "<AccessoriesObject: 0x7f84e40>";
},
    {
    headAccObi = "<AccessoriesObject: 0x7f7da00>";
    neckAccObj = "<AccessoriesObject: 0x7f7d8c0>";
    noseAccObj = "<AccessoriesObject: 0x7f84e40>";
} 
```

)

我想要这样的输出

```
 {
    headAccObi = "<AccessoriesObject: 0x7f7da00>";
    headAccObi = "<AccessoriesObject: 0x7f7da00>";
    noseAccObj = "<AccessoriesObject: 0x7f84e40>";
    headAccObi = "<AccessoriesObject: 0x7f7da00>";
    neckAccObj = "<AccessoriesObject: 0x7f7d8c0>";
    noseAccObj = "<AccessoriesObject: 0x7f84e40>";
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:08:10.823

您无法完全创建您所描述的结构，因为您多次使用相同的密钥。如果键重复，添加对象`setObject:forKey:`将替换现有对象。您需要在字典中为每个键存储一组对象，例如`headAccObi`重复的位置。

# networking - 客户端服务器架构

> ID：11668668
> 
> 赞同：0
> 
> 时间：2012-07-26T11:50:34.007
> 
> 标签：networking, udp, client-server, nat-traversal

我正在为我的应用程序的服务器客户端方面选择什么技术而苦苦挣扎。

## 定义设计

*   .net 2 上的 Windows、C#
*   在许多机器上都有 .net 2 服务。我称之为客户。
*   机器可以位于连接到 Internet 的 NAT（或不连接）后面的不同网络中。
*   服务器服务是公开的。

## 要求

*   按需与客户沟通。
*   客户端必须侦听传入连接。
*   服务器可以在线也可以不在线。
*   端口转发是不可能的。

我有什么选择去做这样的事情？现在我正在研究 UDP 打孔技术。UDP 打孔技术设置和我的设置之间的区别在于，我没有在 NAT 和中介服务器后面有 2 个客户端，而是在 NAT 后面只有一个必须与服务器通信的客户端。那一定更容易，但我很难理解和实施。我在这种 NAT 遍历方面走在正确的道路上，或者可能是其他一些更容易实现的方法？

我考虑过的其他方法：

*   当服务看到服务器在线时，使用 TCP 创建到服务器的连接。问题是我有大约 200 个客户，而且这个数字还在上升，我担心这是一个资源杀手。

*   当服务看到服务器在线时，检查数据库表中的命令，然后每 30 秒再次检查一次。这也是我的服务器的资源杀手。

底线是，如果 UDP Hole Punching 技术是这种情况下的正确方法，请为将在 NAT 后面的服务上运行的 de UDPServer 提供一些代码想法。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T16:35:05.720

## 打孔和p2p

您可能对[UDP 打孔的高级讨论](http://www.h-online.com/security/features/How-Skype-Co-get-round-firewalls-747197.html)感兴趣。如果您希望客户端（两者都可能位于防火墙后面）在没有中继服务器的情况下直接通信，则需要打孔。这是对等 2 对等 (p2p) 通信工作的数量。

对于 p2p，通常经过 NAT 的客户端必须使用一些外部服务器来确定彼此的“服务器反射地址”。当发生 NAT 转换时，防火墙后面的端口可以映射到某个任意端口以公开。客户端可以使用[STUN 服务器](http://en.wikipedia.org/wiki/STUN)来确定其“服务器反射地址”。然后，客户端将通过中间服务器交换服务器自反地址，并可以启动通信（通过打孔来启动会话）。

通常，NAT 不会以允许如上所述的直接通信的方式运行。将数据包发送到不同的目的地将导致 NAT 将端口映射到完全不同的值，具体取决于目的地。在这种情况下，需要一个[TURN 服务器](http://en.wikipedia.org/wiki/TURN)。

### 链接

*   [Nat 遍历和不同类型的 NAT 行为](http://en.wikipedia.org/wiki/Network_address_translation)
*   [眩晕 RFC](https://www.rfc-editor.org/rfc/rfc5389)
*   [转 RFC](https://www.rfc-editor.org/rfc/rfc5766)

## 服务器-客户端通信

如果您的客户端只需要与服务器通信，则不需要打孔。只要客户端可以与公共 Internet 通信，那么您就可以使用任何 C# 套接字 API（我对 C# 不熟悉）来连接到服务器的公共 IP/端口组合。通常，进行套接字连接的客户端不会指定源端口，而是让底层套接字 API 做出决定，因为这并不重要。

你的服务器应该监听一个特定的端口（你做出这个决定），当它接收到来自客户端的数据包时，数据包的源地址将是一些经过 NAT 处理的地址。换句话说，源地址将是您的客户端所在的任何防火墙的公共 IP。如果 NAT 改变了客户端数据包的源端口，服务器会将这个 NAT 的端口视为源端口。这真的没关系，因为当服务器发回响应数据包时，客户端机器上的 NAT 将转换目标端口（它在内部存储转换）并正确地将数据包发送回正确的私有主机（客户端）。

# mysql - MySQL WITH ROLLUP 未显示我的预期

> ID：11668672
> 
> 赞同：2
> 
> 时间：2012-07-26T11:50:52.713
> 
> 标签：mysql, rollup

我正在尝试在我的`SELECT`查询中添加一些总计，但我很难理解为什么这不起作用：

`SELECT client, job_type, actual_value_fee FROM jo2details GROUP BY client, job_type WITH ROLLUP`

这是我**期望**看到的：

```
+--------+----------+------------------+
| client | job_type | actual_value_fee |
+--------+----------+------------------+
| 110    | 2        | 1250             |
| 110    | 20       | 200              |
| 110    |          | 1450             |
| 228    | 27       | 1000             |
| 228    |          | 1000             |
| 229    | 32       | 0                |
| 229    |          | 0                |
|        |          | 2450             |
+--------+----------+------------------+ 
```

但这是我得到的：

```
+--------+----------+------------------+
| client | job_type | actual_value_fee |
+--------+----------+------------------+
| 110    | 2        | 1250             |
| 110    | 20       | 200              |
| 110    |          | 200              |
| 228    | 27       | 1000             |
| 228    |          | 1000             |
| 229    | 32       | 0                |
| 229    |          | 0                |
|        |          | 0                |
+--------+----------+------------------+ 
```

这是表格：

```
CREATE TABLE `jo2details` (
  `ref` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `ID` int(11) unsigned NOT NULL,
  `client` int(11) unsigned NOT NULL,
  `job_type` int(11) unsigned DEFAULT NULL,
  `actual_value_fee` decimal(11,2) DEFAULT NULL,
  `last_updated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`ref`),
  UNIQUE KEY `ref` (`ref`,`ID`),
  UNIQUE KEY `ref_2` (`ref`,`ID`,`client`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=413 ; 
```

非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:06:31.007

试试这个：

```
SELECT client, job_type, sum(actual_value_fee)
 FROM jo2details 
 GROUP BY client, job_type WITH ROLLUP 
```

# charts - JavaFX2 XYChart 轴标签和自定义网格线

> ID：11668673
> 
> 赞同：1
> 
> 时间：2012-07-26T11:50:55.413
> 
> 标签：charts, javafx-2

javafx2 中是否有方法可以覆盖票证标签 X 和 Y 轴以便自定义设置轴格式化程序？

2）如何放大X或Y轴空间以获得更多的标签空间？

3）如何设置网格显示为对数，或重新定义动态网格线空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:37:47.057

要放大 Y 轴宽度，您可以使用

```
yAxis.setPrefWidth(35); 
```

# ruby-on-rails - Heroku push 被拒绝 - Hartl 的 Rails 3.2 教程

> ID：11668675
> 
> 赞同：2
> 
> 时间：2012-07-26T11:51:04.290
> 
> 标签：ruby-on-rails, ruby, heroku

我是一名 ruby​​、ruby on rails 和 heroku 新手，正在尝试从[Michael Hartl 的 Ruby on Rails 3.2 教程](http://ruby.railstutorial.org/chapters/static-pages?version=3.2#top)中学习编码。

现在在本章的开头，我未能将所有内容部署到 Heroku。我收到此错误消息（但我没有计划如何解决此问题）：

```
$ git push heroku master
Counting objects: 69, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (54/54), done.
Writing objects: 100% (69/69), 27.34 KiB, done.
Total 69 (delta 5), reused 0 (delta 0)

-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.2.0.rc
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/
       Fetching gem metadata from https://rubygems.org/........
       Bundler could not find compatible versions for gem "railties": 
       In Gemfile: 
       rails (= 3.2.6) ruby depends on 
       railties (= 3.2.6) ruby 
       jquery-rails (= 2.0.0) ruby depends on 
       railties (3.2.7.rc1) 

 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app

To git@heroku.com:pacific-anchorage-8098.git
 ! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:pacific-anchorage-8098.git' 
```

我的 Gemfile 看起来像这样：

```
source 'https://rubygems.org'

gem 'rails', '3.2.6'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'
group :development, :test do
  gem 'sqlite3', '1.3.5'
  gem 'rspec-rails', '2.10.0' 
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.0'

group :test do
  gem 'capybara', '1.1.2'
end

group :production do
  gem 'pg', '0.12.2'
end

# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# To use Jbuilder templates for JSON
# gem 'jbuilder'

# Use unicorn as the app server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'debugger' 
```

我希望有人可以帮助我（对不起，我是初学者-->也在 Stackoverflow，哈哈）。KR，费边

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:25:10.417

默认生成的 Gemfile（使用 rails 3.2.6）没有指定要使用的 jquery-rails 版本。我建议您也这样做，如下所示：

```
# remove version number, just like you would see in a fresh rails app
gem 'jquery-rails' 
```

您需要的版本 2.0.0 依赖于 railties 3.2.7.rc1 gem，您不能将其与 rails 3.2.6 一起使用。

我在我的应用程序中使用了您的代码，但无法将其捆绑在我的本地主机上。这让我想知道你在推到heroku之前是否也尝试过。您应该始终首先在本地计算机上捆绑安装。

此外，您似乎已经增加了 sass-rails 和 coffee-rails 所需的版本号。这是您在干净的 Rails 应用程序的 Gemfile 中所期望的：

```
# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'

  # See https://github.com/sstephenson/execjs#readme for more supported runtimes
  # gem 'therubyracer', :platforms => :ruby

  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:33:13.640

我现在可以自己解决问题了。这是这样的：

1.  转到 Gemfile 并将部分更改`gem 'rails', '3.2.6'`为`gem 'rails', '3.2.7rc1'`。
2.  节省
3.  跑`bundle install --without production`
4.  跑`git add .`
5.  像 git 一样提交`git commit -a -m "Heroku recommit`
6.  像推送到github`git push`并按照用户名和密码的说明进行操作
7.  最后`git push heroku master`

哇，这很难，但很有教育意义:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:25:57.663

问题是 jquery-rails gem 需要与 bundle 文件中的 rails gem 不同版本的 railties。您可以尝试从 jquery-rails 中删除“2.0.0”，然后重试。Bundle 将安装一个适用于 3.2.6 版 railties 的 gem 版本。

# tortoisesvn - SVN 未提交，未显示错误

> ID：11668678
> 
> 赞同：1
> 
> 时间：2012-07-26T11:51:27.703
> 
> 标签：tortoisesvn, commit, ankhsvn

最近我遇到了 AnkhSVN 的问题。当我想提交时，会出现“提交...”窗口，通常它会要求进行身份验证，但它不再这样做了，它不再做任何事情了。我已经等了一个小时，但仍然没有任何反应，也没有收到任何错误，它什么也没做。

我在网上没有找到解决方案，所以我希望你们中的任何人都遇到过同样的问题并可以帮助我。我不知道如何检查我正在使用的版本以及如何更新它。我正在使用 Visual Studio 2008。

任何帮助，将不胜感激。

我已经尝试了以下方法，但没有帮助：
- 重新启动 Visual Studio
- 重新启动 pc
- 清除身份验证缓存

**更新：**问题不仅是 AnkhSVN，TortoiseSVN 也会出现同样的问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:27:54.367

在同事的帮助下，我设法解决了这个问题。我希望我能给出一个明确的解释，但不幸的是这个问题对我来说仍然很奇怪。我们必须创建一个新的网络适配器并将其传递给虚拟机来修复它。我假设一个损坏的网络适配器：s

# scala - Seq.apply 在 Scala 2.9.2 中去了哪里？

> ID：11668679
> 
> 赞同：2
> 
> 时间：2012-07-26T11:51:27.550
> 
> 标签：scala

Scala 2.8.2 有一个 Seq.apply 方法，因此您可以在 REPL 中编写以下内容：

```
val l = Seq(1, 2)
l: Seq[In] = List(1, 2) 
```

这在 Scala 2.9.2 中仍然有效，但令我困惑的是，根据文档，不再存在 scala.collection.Seq.apply 方法。

我检查了 scala -Xprint:typer 这就是它打印的内容：

```
[[syntax trees at end of typer]]// Scala source: <console>
package $line14 {
  final object $read extends java.lang.Object with ScalaObject {
    def this(): object $line14.$read = {
      $read.super.this();
      ()
    };
    final object $iw extends java.lang.Object with ScalaObject {
      def this(): object $line14.$read.$iw = {
        $iw.super.this();
        ()
      };
      final object $iw extends java.lang.Object with ScalaObject {
        def this(): object $line14.$read.$iw.$iw = {
          $iw.super.this();
          ()
        };
        private[this] val l: Seq[Int] = collection.this.Seq.apply[Int](1, 2);
        <stable> <accessor> def l: Seq[Int] = $iw.this.l
      }
    }
  }
}

[[syntax trees at end of typer]]// Scala source: <console>
package $line14 {
  final object $eval extends java.lang.Object with ScalaObject {
    def this(): object $line14.$eval = {
      $eval.super.this();
      ()
    };
    lazy private[this] var $result: Seq[Int] = {
      $eval.this.$print;
      $line14.$read.$iw.$iw.l
    };
    private[this] val $print: String = {
      $read.$iw.$iw;
      "l: Seq[Int] = ".+(scala.runtime.ScalaRunTime.replStringOf($line14.$read.$iw.$iw.l, 1000))
    };
    <stable> <accessor> def $print: String = $eval.this.$print
  }
}

l: Seq[Int] = List(1, 2) 
```

所以结果是有效的：

```
collection.this.Seq.apply[Int](1, 2) 
```

这表明它仍然调用 Seq.apply，但是这个方法在哪里呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:13:13.010

这确实是 Scaladoc 2.9.2 中的一个错误。

我检查了 scala-library.jar 并发现伴随对象 scala.collection.Seq 间接扩展了 scala.collection.generic.GenericCompanion[Seq]，它有效地提供了方法签名：

```
def apply[A](elems: A*): Seq[A] 
```

这反过来又调用 newBuilder，它在 Seq 中被覆盖以返回：

```
scala.collection.immutable.Seq.newBuilder[A] 
```

# asp.net - 无法将值转换为字符串到字符串 [] 如何传递值？

> ID：11668680
> 
> 赞同：1
> 
> 时间：2012-07-26T11:51:27.380
> 
> 标签：asp.net

我需要将值传递给`.dbml`

> 我如何将值传递给 string[] 参数？

![在此处输入图像描述](../Images/2cff98119d7e8a71c80cd36ab0dadc38.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:55:54.470

这就是你所追求的吗？

```
[FileUpload(FileTypes = new string[] {"filetype1", "filetype2", ...})] 
```

请注意，这与 .dbml 文件或一般的 LINQ2SQL 无关。这是属性的基本命名参数。

# powershell - 如何更新 sharepoint shareddocument 文件夹中的文件夹属性

> ID：11668681
> 
> 赞同：1
> 
> 时间：2012-07-26T11:51:29.757
> 
> 标签：powershell, sharepoint-2010, properties, directory

下面的 C# 代码我用来更新共享文档中的文件夹属性，我在 PowerShell 中尝试过相同的概念，但我没有得到任何线索。

```
SPFolder newFolder = folders.Add(ParentURL + FolderURL + "/" + FolderName);
//Added Title Property to newFolder
newFolder.AddProperty("vti_title", FolderName);
//newFolder.Update(); 
```

在 PowerShell 中：

```
> $web = Get-SPWeb "http://server/sites/4tmdk9h7qc4g"
> $site=$web $list = $web.Lists["Shared Documents"] 
  foreach ($item in $list.Folders)
  { 
    write-host $item["Title"] 
    /?? HOW TO UPDATE HERE
    $item.Update() 
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:47:17.000

```
Finally this code loop all the site document folder and updated the title

$inputUrl =Read-Host "Enter the site URL" 
$site = Get-SPSite -identity $inputUrl 
$site | Get-SPWeb -limit |ForEach-Object 
{   
$web = Get-SPWeb $_.Url     
$list =$web.lists["Shared Documents"]   
Write-Host $_.Url   
foreach($item in $list.folders)     
{  
$item["Title"]="ayyappan"
$item.update()
Write-Host $item["Title"] 
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:10:48.997

$item 是一个 SPListItem 对象。使用 SPListItem.Folder 访问 SPFolder 对象：

```
$item.Folder 
```

# asp.net - 将 ASP.NET Webforms 迁移到 MVC：混合网站

> ID：11668682
> 
> 赞同：0
> 
> 时间：2012-07-26T11:51:34.627
> 
> 标签：asp.net, asp.net-mvc, session-state

我们目前有一个用 Net2 编写的 WebForm 网站，每天的访问量超过 10 000 000 次。我们负责将它迁移到 Net 4 中的 MVC。由于业务影响和大量功能，我们无法直接迁移它。

我们的想法是在 MVC .Net 4 中开发一个或多个新网站（具有新架构），对应于业务领域（营销、财务、帐户..）。旧网站变成了某种端口（链接到不同的网站）。

在迁移期间，会话用户数据将与 AppFabric 等分布式缓存共享。

你能向我确认这是一个好方法吗？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-26T11:54:51.600

也许 DB + Transactions 是执行此操作的更有效方式，因为 AppFabric 将其数据存储在内存中，并且您可能会丢失一小部分信息。

# java - 模型正在更新，但 pageablelistview 未反映 UI + wicket 上的更改

> ID：11668683
> 
> 赞同：0
> 
> 时间：2012-07-26T11:51:37.547
> 
> 标签：java, listview, user-interface, wicket

所以我在提交它时有这个按钮，有一些功能将被执行，并且需要从列表中删除选中的复选框。

下面的一段代码显示了该按钮的用法以及我为删除特定复选框选择所做的实现。

```
 Button resumeDrive = new AjaxButton("resume", driveSearchForm)
        /**
         * 
         */
        private static final long serialVersionUID = -7016746377299867219L;

        @Override
        protected void onSubmit(AjaxRequestTarget target, Form<?> form) {
            log.info("envoking resume");
            target.addComponent(form);
            try {

                List<DashboardModel> list = (List<DashboardModel>) group.getDefaultModelObject();
                log.info("drives data : " + list);
                if (list != null) {
                    List<Long> drives = new ArrayList<Long>();
                    List<DashboardModel> drivesToRemove = new ArrayList<DashboardModel>();
                    for (DashboardModel drive : list) {
                        drives.add(drive.getExecutionUnitId());

                        drivesToRemove.add(drive);
                        log.info("drivesToRemove :" + drivesToRemove);
                    }
                    log.info("selected drive: " + drives);
                    if (drives.size() > 0) {
                        log.info("Execution Ids to resume : " + drives);

                        driveResumeService.resumeDrives(drives);
                        drivesData.removeAll(drivesToRemove);
                        log.info("drivesdata :" + drivesData);

                        warn("Execution Ids to resume : " + drives);
                    } else {
                        warn("No drives selected for resuming.");
                    }
                } else {
                    info("No drives to resume.");
                }
            } catch (Exception e) {
                warn("Failed to resume jobs. " + e.getMessage());
                log.info("Failed to resume jobs", e);
            }
            target.addComponent(group);
        }
        @Override
        protected void onError(AjaxRequestTarget target, Form<?> form) {
            target.addComponent(form);
        }
            driveSearchForm.add(resumeDrive);
    resumeDrive.setDefaultFormProcessing(true);
    resumeDrive.add(new AjaxFormValidatingBehavior(driveSearchForm, "onClick"));

--> my model returns this driveData.
    --->   I'm sticking the pageableListView code also alongside.

            private CheckGroup<DashboardModel> group;
            group = new CheckGroup<DashboardModel>("group", new ArrayList<DashboardModel>());
    driveSearchForm.add(group);
    group.add(new CheckGroupSelector("allSelected"));
    group.setOutputMarkupId(true);

     pageableListView = new PageableListView<DashboardModel>("searchResults", driveDataModel, 10) {
        private static final long serialVersionUID = 1L;

        @Override
        protected void populateItem(ListItem<DashboardModel> item) {
            item.add(new Check("check", item.getModel()));
            item.add(new Label("name", item.getModelObject().getName()));
            item.add(new Label("status", item.getModelObject().getStatus().toString()));
            item.add(new Label("driveUrl", item.getModelObject().getDriveURL()));
        }

    };
    pageableListView.setRenderBodyOnly(false);
    pageableListView.setReuseItems(true);
    group.add(pageableListView);
    group.add(new PagingNavigator("navigator", pageableListView)); 
```

所以我发现我的模型正在更新，但 UI 上没有发生同样的情况，即我希望从刷新的列表中删除选定的复选框.....请建议......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:30:41.043

来自`ListView#setReuseItems()`：

> 但是，如果您修改 listView 模型对象，则必须手动调用 listView.removeAll() 以重建 ListItems。

因此，如果`reuseItems`是真的，那么在您更改`removeAll`列表视图上的模型调用时。

# c# - C#：WCF 接口实现另一个接口以公开方法

> ID：11668684
> 
> 赞同：1
> 
> 时间：2012-07-26T11:51:40.243
> 
> 标签：c#, interface

我有另一个与此相关的问题，所以如果您需要更多详细信息，请阅读它。这是一个与另一个问题的一个要素相关的更具体的问题。我有一个描述 dao 的界面。该接口由另一个接口实现，该接口将作为 wcf 服务的接口。原因是巧合的是，父接口中的所有功能都需要通过 wcf 接口公开。父接口不包含 wcf 属性，因为它不需要它们。子接口需要 wcf 属性才能作为 wcf 接口工作。wcf 接口最终可能包含更多父接口中没有的方法。我可以想到两种在子界面上获取这些属性的方法，如下所示：

1.  用属性装饰父接口方法。
2.  在子接口中覆盖父接口中的所有方法，然后用属性装饰这些方法。

解决方案 1 真的有效吗？这意味着 wcf 属性会被 child(wcf) 接口继承并作为服务合同的一部分提供吗？这是不好的做法吗？

解决方案 2 会是个好主意吗？重写所有方法只是用 wcf 属性装饰它们似乎适得其反。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:16:18.230

我认为您的解决方案**＃2**是更好的解决方案。

这似乎适得其反，但实际上是合乎逻辑的：您有一个接口，其中包含一些执行某些任务的方法，并且您在其之上添加了另一个“层”，它以您需要的任何方式公开它们。

这样，如果您不想再通过 WCF 公开方法，但假设您想将其设为 RIA 服务，或者您想用假客户端替换它，您只需切换“上”层并更改覆盖。底层的实际接口甚至不需要意识到这一点。

这一切都求助于将“电线”（父界面）连接到正确的“显示器”（子界面）。

# android - 在 Java ME 中，我们有 tile.setcell(col,row,tileindex) 但在 andengine 中如何设置图块？

> ID：11668688
> 
> 赞同：0
> 
> 时间：2012-07-26T11:51:46.893
> 
> 标签：android, andengine, tiles

我正在使用 andengine 开发基于 android 平铺的游戏。在 j2me 我们有 tile.setcell(col,row,tileindex) 但在 andengine 如何设置图块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T17:00:05.423

尝试 TMX Tile 地图扩展： [https ://github.com/nicolasgramlich/AndEngineTMXTiledMapExtension](https://github.com/nicolasgramlich/AndEngineTMXTiledMapExtension)

它允许您使用出色的时间地图编辑器[http://www.mapeditor.org/](http://www.mapeditor.org/) 创建地图，andengine 将解析该程序的 XML 输出。

# c# - 调试 Windows 服务 -- 重新访问 (Windows 7)

> ID：11668694
> 
> 赞同：1
> 
> 时间：2012-07-26T11:52:02.420
> 
> 标签：c#, asp.net, windows, windows-services

嗨，关于这个话题（调试 Windows 服务）之前也有很多讨论[https://stackoverflow.com/search?q=debug+windows+service](https://stackoverflow.com/search?q=debug+windows+service)

但是我在实施同样的问题时遇到了一些问题。

*   我尝试从 VS 2008 添加附加过程，但特定的 .Exe 已禁用，因此无法附加
*   还使用调试器尝试了以下代码

    ```
    #if DEBUG
    Debugger.Launch();
    #endif 
    ```

调用调试器时出现错误`"UnHandled Exception Occured--JIT compiler was launched without any security permissions.To debug run as administrator"`

我拥有这台 PC 的管理员权限并且正在使用**Windows 7**我该如何调试它？

PS：我可以调试使其成为控制台应用程序。但是想知道为什么上述方法会失败..有没有办法可以作为服务进行调试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T14:02:34.207

当您附加该进程时，该进程应该正在运行。这是我用来调试服务的两种方式

1）在你的windows服务的开头添加一个睡眠定时器，运行服务，然后在vs-Debug->attach to a process

2) 创建和读取 DUMP 文件（google DebugDiag [v1.2 是最新的？]）它可以让您查找线程中的崩溃、内存泄漏、cpu 使用变化。使用 WinDbg 读取转储文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T11:55:23.227

可能 - 以适当的权限启动 JIT。即以管理员身份启动服务。您可以设置服务启动时使用的用户名和密码。

# android - 在 Android 手机上模拟 NFC 标签

> ID：11668699
> 
> 赞同：2
> 
> 时间：2012-07-26T11:52:18.790
> 
> 标签：android, tags, nfc, simulate, android-beam

我正在使用 Android 中的 NFC。我已经使用 NFC 标签和 Android Beam 做过一些事情，但我想知道是否可以使用像 NFC 标签这样的 Android 手机。关于它的一个问题是，当我将两部手机靠近时，Android Beams 会启动。此外，我还没有找到有关如何模拟 NFC 标签的信息。可能吗？

PS。对不起我的英语。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:15:59.133

这已经讨论过了（http://stackoverflow.com/questions/6138077/can-an-android-nfc-phone-act-as-an-nfc-tag），结论是“否”或“有困难”。

BR 斯坦

# modx - 在 MODX 的不同页面上列出相同的内容

> ID：11668702
> 
> 赞同：0
> 
> 时间：2012-07-26T11:52:24.003
> 
> 标签：modx, modx-revolution

我正在尝试添加一个小的“3 框新闻片段”。我希望它在多个页面上可见。通常我只会使用块，但问题是我希望能够修改“3 框段”内容，并且最好使用 ritch 文本。任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T16:43:56.157

您可以使用 getResources 从 3 个隐藏资源中获取内容，这样您仍然可以保留分段布局的块，并且您的实际内容在资源中 [您可以使用富文本编辑器进行更新]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:19:33.650

除了 getResources，您还可以使用 getResourceField 来获取例如主页上的字段或模板变量的值。这允许在一个地方管理它，当您希望它显示在其他地方时，您可以使用 getResourceField 引用它。

# android - 如何验证Android中的两个签名或绘图是否相同？

> ID：11668703
> 
> 赞同：2
> 
> 时间：2012-07-26T11:52:23.140
> 
> 标签：android, pattern-matching, android-canvas, draw, handwriting-recognition

我想知道是否有任何方法可以检查 Android 是否可以检查两个平局是否相同，而不是特别相同。我想为小孩子做一个测试。假设他们画了“A”字母，我想检查是否正确。所以我想我可以检查孩子的画是否像模型一样。字母“A”的正确抽签。

那么，我有什么方法可以实现它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:44:11.930

这是个有趣的问题。我从来没有做过这样的事情，但这就是我要开始的方式。

假设绘图是在 Canvas 上完成的。因此，您将画布保存到位图。将该位图转换为字节数组并生成哈希。然后你对第二张图片做同样的事情，并比较它们的哈希值。如果两个哈希不匹配，则这意味着其中一张图片被修改。

我自己没有尝试过，但我相信这是一个值得研究的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-16T15:42:40.423

有趣的问题，也许[这个](https://stackoverflow.com/questions/16077526/texture-pattern-recognition-matching-int-unity)其他 SO 问题可以帮助你；）

顺便说一句，我想说安迪的答案包括将绘图转换为位图并检查结果哈希的相似性并没有多大意义，因为您必须在比较中加入一些统计方差余量并允许一些逻辑错误......

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-22T22:06:44.773

您可以查看 android 手势和手势库。它帮助了我。请参阅以下链接 [http://www.devlper.com/2010/10/gesture-detection-in-android-part-2-of-2/](http://www.devlper.com/2010/10/gesture-detection-in-android-part-2-of-2/)

# javascript - IPython内核javascript双向通信的简约示例

> ID：11668704
> 
> 赞同：36
> 
> 时间：2012-07-26T11:52:29.880
> 
> 标签：javascript, jquery, python, ipython

我的目标是为 IPython 编写一个交互式变量查看器，即允许人们查看嵌套字典/列表作为树，并向下钻取（有点像 Javascript 中的 console.log）。

我花了很多时间试图从 IPython 中的 directview 示例中提取简约代码，但仍然无法理解它是如何工作的。我的 Python 没问题，但我的 jQuery 经验非常有限。

所以我必须将 directview.js 剥离为以下内容

```
container.show();
var widget = $('<div/>')
element.append(widget);
var output = $('<div></div>');
$(widget).append(output)
var output_area = new IPython.OutputArea(output, false);
var callbacks = { 'output': $.proxy(output_area.handle_output, output_area) };
var code  = 'print 1+1'
var msg_id = IPython.notebook.kernel.execute(code, callbacks, {silent: false}); 
```

这在我加载 directview.ipynb 时有效。但是我仍然不清楚如何使它完全独立（即不需要directview.py，并传递另一个回调而不是标准`handle_output`）`IPython.OutputArea`。其中一个问题是以`container.show()`独立方式调用时失败。

我迷失在几个方面：

*   为什么有一个`element.append(widget)`然后`$(widget).append(output)`？还有为什么还需要创建一个`Ipython.OutputArea`. 有没有办法只创建一个`<div id=my_output_area>blah</div>`然后让`output`回调用相关数据填充它？
*   整个 .proxy 是关于什么的？我想创建自己的回调，`output`但是当我这样做并且`console.log()`传递给回调的参数时，它们`undefined`或只是没用。

我很欣赏 IPython notebook 的作者使用 jQuery/websockets 创建了如此漂亮的前端所做的出色工作，并且创建允许像我这样的初学者调整它的开发人员文档要求很多，但是如果有人可以借那会很棒的手！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T04:47:56.333

我可以回答你的第二个问题。事实上，当 JavaScript 调用你的回调时，它在没有指定上下文的情况下，即没有设置`this`（Pythonistas 称之为`self`）。但是可以将函数绑定到`this`via `$.proxy`，您在以下代码中看到：

```
var callbacks = { 'output': $.proxy(output_area.handle_output, output_area) }; 
```

# validation - grails 验证电子邮件自定义消息

> ID：11668709
> 
> 赞同：2
> 
> 时间：2012-07-26T11:52:50.807
> 
> 标签：validation, email, grails, customization

当约束失败时，我想自定义电子邮件验证的错误消息：

```
email(size: 1..255, blank: false, email:true) 
```

这将显示如下消息：

> 具有值 [eulinda] 的类 [class com.companyname.icmgrails.nonpersistentdomains.UserProfile] 的属性 [email] 不是有效的电子邮件地址

当电子邮件为空白时，我无法弄清楚如何使用它并将其放入我的**messages.properties中，如下例所示。**

> com.companyname.icmgrails.nonpersistentdomains.UserProfile.email.blank=电子邮件不能为空！

尝试过的解决方案：

> 我使用 [com.companyname.icmgrails.nonpersistentdomains.UserProfile.email] + notavalidemail 或 notvalid 或 notavalidemaladdress 或 notvalidemaladdress

但没有成功。任何人都可以告诉我如何使用它？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:14:50.243

每个约束都在用户指南的参考页面上指定了所需的消息代码。[在电子邮件限制](http://grails.org/doc/latest/ref/Constraints/email.html)的情况下，您需要

```
com.companyname.icmgrails.nonpersistentdomains.UserProfile.email.email.invalid=Not a valid email address 
```

# java - 使用 WMQ API 时是否可以手动设置 JMS 属性？

> ID：11668711
> 
> 赞同：3
> 
> 时间：2012-07-26T11:52:52.067
> 
> 标签：java, .net, jms, ibm-mq

我`com.ibm.mq.jar`在 Java 中有传统的 () MQ 应用程序用于测试目的。现在我需要使用该应用程序向 JMS 发送一些消息。当我尝试在 MQ 消息上设置任何 JMS 属性时，例如：

```
message.setStringProperty("JMSDestination", "queue:///" + queueName); 
```

我总是收到错误：2471 - `MQRC_PROPERTY_NOT_AVAILABLE`。如果我只是`JMS`从属性名称中删除它就可以了。

是否可以直接设置 JMS 属性`MQMessage`？在 MQ 级别上执行此操作的正确方法是什么？

顺便提一句。我在 .NET 中有相同的应用程序，可以通过这种方式设置 JMS 属性，所以我只是尝试在 Java 中使用相同的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T21:26:14.967

不允许手动执行此操作。请使用 JMS API 设置 JMS 属性。

[此处](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp?topic=/com.ibm.mq.csqzal.doc/fg20140_.htm)解释了对 MQ 属性的限制。

有一件事是对那个文档页面很感兴趣，

> 不能保证直接指定为 MQRFH2 元素的属性名称会被 MQPUT 调用验证。

您也许可以在短期内解决这个问题。不过，似乎无法保证直接设置 MQRFH2 元素不会被验证。

# excel - 在java中对excel单元格进行分组

> ID：11668712
> 
> 赞同：2
> 
> 时间：2012-07-26T11:52:54.987
> 
> 标签：excel, java

我正在使用 java 中的 ms excel。有人知道如何对行进行分组吗？POI或jxl有这个功能吗？我搜索了文档，但没有找到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T11:10:29.170

我找到了答案。你只需要调用`org.apache.poi.ss.usermodel.Sheet.groupRow()`方法。

# asp.net-mvc - ASP.NET MVC ModelState 在 Fluent Validation 中始终有效

> ID：11668713
> 
> 赞同：5
> 
> 时间：2012-07-26T11:52:56.340
> 
> 标签：asp.net-mvc, viewmodel, fluentvalidation

我正在尝试对 ASP.NET MVC 项目使用流利的验证。我正在尝试验证我的视图模型。

这是我的视图模型，

```
[Validator(typeof(ProductCreateValidator))]
public class ProductCreate
{
    public string ProductCategory   { get; set; }
    public string ProductName       { get; set; }
    ....
} 
```

这是我的验证器类，

```
public class ProductCreateValidator : AbstractValidator<ProductCreate> 
{
    public ProductCreateValidator()
    {
        RuleFor(product => product.ProductCategory).NotNull();
        RuleFor(product => product.ProductName).NotNull();
    }
} 
```

在我的控制器中，我正在检查我的 ModelState 是否有效，

```
[HttpPost]
public ActionResult Create(ProductCreate model)
{
    /* This is a method in viewmodel that fills dropdownlists from db */
    model.FillDropDownLists();

    /* Here this is always valid */
    if (ModelState.IsValid)
    {
        SaveProduct(model);
        return RedirectToAction("Index");
    }

    // If we got this far, something failed, redisplay form
    return View(model);
} 
```

这就是我所拥有的。当我的视图模型完全为空时，我的问题是`ModelState.IsValid`返回。`true`我是否需要手动配置 Fluent 验证以便可以将模型错误添加到 ModalState 中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T11:57:42.813

正如[文档](http://fluentvalidation.codeplex.com/wikipage?title=mvc&referringTitle=Documentation)所解释的那样，确保您在您的文件中添加了以下行，`Application_Start`以便交换数据注释模型元数据提供程序并改用流式验证：

```
FluentValidationModelValidatorProvider.Configure(); 
```

您的行为中的以下评论也让我感到害怕：

```
/* This is a method in viewmodel that fills dropdownlists from db */
model.FillDropDownLists(); 
```

视图模型不应该知道数据库的含义。**因此，在您的视图模型**中使用此类方法是一种非常错误的方法。

# java - CXF 响应对象引用对象

> ID：11668717
> 
> 赞同：0
> 
> 时间：2012-07-26T11:53:23.137
> 
> 标签：java, arrays, object, cxf, pojo

我有一个包含驱动程序、它们的功能和它们的参数的项目。简化：

**控制器**

```
@WebService  
Device[] getDevices() @WebMethod 
```

**设备**

```
String getName() @WebMethod  
Function[] getFunctions() @WebMethod 
```

**功能**

```
String getName() @WebMethod  
Argument[] getArguments() @WebMethod 
```

**争论**

```
... 
```

这些 POJO 对象已经存在。我正在使用 Eclipse 工具来生成 CXF 代码。

目前，Controller.getDevices 正在返回设备列表。但是，这些对象仅包含字段“名称”。函数引用被完全剥离。

通过阅读关于这个主题的（有限的？）信息，我发现我应该用 XMLRootElement 注释这些类。然而，这并没有改变任何东西。或者每个类都应该是它自己的WebService？

我正在寻找有关如何在 CXF 中正确实现此类系统的信息或文档的指针。我希望我走在正确的道路上，但如果我不是，指向可行的设计模式的指针也会非常有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T14:12:15.030

首先，@WebMethod 注释仅在实际服务上需要，而不是每个 pojo 对象。

对于第二个问题，确保设备具有函数的 getter 和 setter 方法。还要确保 Function 对象具有默认构造函数。

# android - Android xml 错误：“未找到与给定名称匹配的资源”与 RelativeLayout（@id/LinearLayout_acc，@id/ProgressBar_statusScreen）

> ID：11668718
> 
> 赞同：92
> 
> 时间：2012-07-26T11:53:22.737
> 
> 标签：android, xml, eclipse

好的，所以这开始让我很恼火。这个错误以一种非常特殊、不太合乎逻辑的方式弹出。

让我首先说我已经查看了有关此错误的其他问题，谷歌也是如此。据我所知，大多数类似问题的发生是因为人们引用了`String`不在同一个布局文件中的资源或其他东西，他们在“@id+”或类似的东西中放错了“+”。

我遇到的问题发生在带有 .xml 的布局 .xml 文件中`RelativeLayout`。这包含 a `TableLayout`，两个`LinearLayout`s 包含一些文本，最后是 a `ProgressBar`。我想要的是进度条与相对布局`android:layout_alignParentBottom="true"`对齐，然后对齐进度条上方的两个线性布局（底部线性布局在进度条上方对齐，另一个在底部线性布局上方对齐）。

它应该足够简单并且看起来好像可以工作，即图形视图显示了所需的结果。然而，**问题来了**，Eclipse 在两个线性布局上给了我一个错误，

“错误：未找到与给定名称匹配的资源（在 'layout_above' 处，值为 '@id/LinearLayout_acc'）。”

以及其他线性布局参考进度条的相同错误。我已经检查了三次以上，没有错别字（ID 也存在于 packagename.R.java 中），并且我已经尝试清理该项目十几次。

保存（和自动构建）时我没有收到错误，直到我决定运行项目。另一个奇怪的事情是，当我从进度条而不是顶部线性布局引用底部线性布局时，我没有收到错误！

我的布局文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/background_activity" >
        <TableLayout
             ... />

        <LinearLayout
            android:id="@+id/LinearLayout_dist"
            android:layout_above="@id/LinearLayout_acc"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_marginBottom="10dp" >

            <TextView
                ... />

            <TextView
                ... />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/LinearLayout_acc"
            android:layout_above="@id/ProgressBar_statusScreen"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true" >

            <TextView
                ... />

            <TextView
                ... />
        </LinearLayout>

        <ProgressBar
            android:id="@+id/ProgressBar_statusScreen"
            style="?android:attr/progressBarStyleHorizontal"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_margin="16dp" />

</RelativeLayout> 
```

请帮忙，我不知道是什么导致了这个错误！

## 编辑答案

Shrikant 提供了更改布局文件中出现顺序的解决方案，以便元素仅引用在读取引用时已定义的其他元素。
此外，正如其他人发布的那样，即使在参考中更改`@id/`为，也会删除错误消息。`@+id/`正如 Marco W. 在[此](https://stackoverflow.com/questions/5025910/difference-between-id-and-id-in-android)线程中所写，问题是您必须`@+id/`在第一次提到每个 id 时使用，然后再使用`@id/`，即使第一次可能不是定义。

我完成了大部分设计并在 Eclipse 的图形编辑器中设置了引用的 id，因此会自动插入导致错误消息的代码。也许这是 Eclipse 中的一个错误。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-07-26T11:56:55.143

改变

```
@id/LinearLayout_acc 
```

到

```
@+id/LinearLayout_acc 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2012-07-26T12:41:56.850

请检查以下代码

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/ic_launcher" >

<TableLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

<LinearLayout
    android:id="@+id/LinearLayout_dist"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/LinearLayout_acc"
    android:layout_centerHorizontal="true"
    android:layout_marginBottom="10dp" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="FIRST" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="SECOND" />
   </LinearLayout>

   <LinearLayout
    android:id="@+id/LinearLayout_acc"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/ProgressBar_statusScreen"
    android:layout_centerHorizontal="true" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="THIRD" />

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="FOURTH" />
   </LinearLayout>

   <ProgressBar
    android:id="@+id/ProgressBar_statusScreen"
    style="?android:attr/progressBarStyleHorizontal"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_margin="16dp" />

 </RelativeLayout> 
```

另请检查以下[链接](https://stackoverflow.com/questions/5025910/difference-between-id-and-id-in-android)。它说 android:layout_below="@id/myTextView" 将无法识别 ID 为“myTextView”的元素，如果它是在您使用它的元素之后编写的。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-07-26T11:58:57.997

将每个 id 更改`@id`为`@+id`，无论何时定义或引用一个 id。有了这个，你不会得到

> Android xml 错误：“未找到与给定名称匹配的资源”和 RelativeLayout（@id/LinearLayout_acc、@id/ProgressBar_statusScreen）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-26T12:02:53.590

```
 <LinearLayout
        android:id="@+id/LinearLayout_dist"
        android:layout_above="@+id/LinearLayout_acc" <--- here might be a problem you forgot + sign
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="10dp" > 
```

# iphone - UIImageView 在旋转时改变它的宽度和高度，如何获得正常状态的原始高度和宽度？

> ID：11668720
> 
> 赞同：0
> 
> 时间：2012-07-26T11:53:29.997
> 
> 标签：iphone, objective-c, ios, ipad

我有一个**宽度为 200**和**高度为 200**的图像。当我**将它旋转**到某种程度时说**60**度，那么**新的宽度和高度**就是**273,273**。

但我**想检索**相同的**高度和宽度 200*200**无论它有什么旋转。

我正在尝试将该图像缩放到放置该图像的后视图大小的某个比例。如果后视图减小到一半，则图像大小也减小到一半，如果后视图增加到两倍，则图像大小也会增加到两倍。但是，当我旋转图像并尝试更改后视图的框架时，如果不旋转，图像调整大小可以正常工作，但如果旋转了，则后视图比例的大小调整将不适用于图像比例。图像要么增加更多，要么减少。一般来说，它的增长超过预期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T13:10:00.667

`view.bounds.size`旋转后不会改变

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:25:30.267

Image.transform=CGAffineTransformMakeRotation(角度); 工作得很好。检查您的图像....如果它是 ping 或 jpeg 等。问题出在图像上，我认为不是方法.. :)

# java - Java：重命名 .jar 中的文件

> ID：11668723
> 
> 赞同：1
> 
> 时间：2012-07-26T11:53:37.733
> 
> 标签：java, file, jar

通常要重命名我使用的文件：

```
File oldFile = new File("file path");
oldFile.renameTo(new File("file path with new name")); 
```

但是，如果我要重命名的文件位于 .jar 可执行文件中，有没有办法从那里重命名它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:57:57.230

**你不能做这个。**因为

```
A jar file is not itself a file system and the contents cannot be accessed
using File objects. 
```

要做到这一点，您必须提取文件，然后重命名您要重命名的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T11:55:18.463

不，除非您提取 JAR 文件、重命名文件并重新打包，否则您不能这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T12:15:32.457

您可以复制一个罐子，一次一个条目，重命名您要更改的条目。这可能比解包、重命名和重新打包更有效。

如果不更改对该名称的所有引用，则无法重命名类文件。无需重新编译所有代码，您就可以使用 ObjectWebs ASM 之类的库来检查字节码并更改对该类的引用。如果在字符串中引用了该类，您可能还想更改该字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-21T16:03:59.477

是的，您可以重命名 jar 中的文件。例如，您可以使用[JarEntryFilter](http://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/loader/jar/JarEntryFilter.html)

像这样：

```
...
import org.springframework.boot.loader.jar.JarEntryData;
import org.springframework.boot.loader.jar.JarEntryFilter;
import org.springframework.boot.loader.jar.JarFile;
import org.springframework.boot.loader.tools.JarWriter;
import org.springframework.boot.loader.util.AsciiBytes;
...
    JarWriter writer = new JarWriter(destination);
    try {
        JarFile filteredJarFile = sourceJar.getFilteredJarFile(new JarEntryFilter() {
            @Override
            public AsciiBytes apply(AsciiBytes name, JarEntryData entryData) {
                String string = name.toString();
                String exp = "^a.*";
                if (string.matches(exp)) {
                    string = string.replaceFirst(exp, "replaced");
                    return new AsciiBytes(string);
                }
                return name;
            }
        });
        writer.writeEntries(filteredJarFile);
    } finally {
        try {
            writer.close();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    } 
```

# php - Aptana 3 无法识别

> ID：11668724
> 
> 赞同：0
> 
> 时间：2012-07-26T11:53:37.827
> 
> 标签：php, aptana

我刚开始使用 Aptana（来自 Dreamweaver）。我已经导入了使用 css 和 php 的旧 html 文件。每次我使用`<?php echo php_variable_here ?>`Aptana 时都将其标记为错误`"<" missing '>'`

我的 php 使用示例：`<?php echo $share_button ?>`

我究竟做错了什么？如果没有其他工作，也许我会禁用 php 错误验证（我该怎么做？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T11:18:07.120

似乎文件扩展名必须是 .php 才能让 Aptana 识别代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-17T18:55:21.547

所以这就是我发现的 - 我不能说我理解*为什么*会这样，但似乎 aptana 会跟踪文件在创建时的类型*，*而不管它现在是什么。我有同样的问题。我有一个在 html 文件中无法识别的 php 标签，我更改了扩展名，但仍然无法正常工作。然后我将文件的内容复制到一个安全的地方，并在 aptana 中创建了一个带有 php 扩展名的新文件，粘贴了相同的代码，它就被识别了。

# scala - 从具有 selftype 的 trait 调用覆盖的方法

> ID：11668725
> 
> 赞同：1
> 
> 时间：2012-07-26T11:53:44.347
> 
> 标签：scala

假设，您有一个带有 selftype 的特征，并且您已经覆盖了其中一种方法：

```
trait A {
  def foo() { println("A") }
}

trait B { this: A =>
  override def foo() {
    println("B")
  }
}

object Test {
  def main (args: Array[String]) {
    val b = new A with B {}
    b.foo()
  }
} 
```

到目前为止一切顺利，它编译并在输出中生成“B”。但是我如何调用“阴影”方法`A`来做这样的事情：

```
trait A {
  def foo() { println("Hello, ") }
}

trait B { this: A =>
  override def foo() {
    //here I'd like to do something like super.foo()
    println("world!")
  }
}

object Test {
  def main (args: Array[String]) {
    val b = new A with B {}
    b.foo() //Should print "Hello, world!"
  }
} 
```

甚至可以调用 overriden`foo`吗？或者我应该更喜欢继承而不是 selftype 来实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:01:04.293

您正在寻找的是抽象覆盖，它可以让您实现可堆叠特征模式。

如果您在特征 A 上定义 foo ，如下所示

```
trait A {
  def foo()
}

trait M extends A {
  abstract override def foo() {println("M"); super.foo()}
}

class FooImpl1 extends A {
  override def foo() {println("Impl")}
}

class FooImpl2 extends FooImpl1 with M 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T13:34:27.703

受 Edmondo 版本的启发：

```
scala> class C { def c = "C" }
defined class C

scala> trait T1 { def c:String }
defined trait T1

scala> trait T2 extends T1 { self:C => 
     | abstract override def c = super.c + " with T2" 
     |}
defined trait T2

scala> new C with T2
res0: C with T2 = $anon$1@1f841222

scala> res0.c
res1: java.lang.String = C with T2 
```

# c++ - 右值委托，或 const 成员函数的右值等价物

> ID：11668726
> 
> 赞同：1
> 
> 时间：2012-07-26T11:53:48.327
> 
> 标签：c++, c++11, rvalue

```
struct that
{
    that &frob()
    {
        return *this;
    }
    that frob() const
    {
        return that(*this);
    }

    //that &&frob() && //<-called only if *this is an rvalue
    //{
    //    return move(*this);
    //}

    that()
    {
        // make things
    }
    that(const that &other)
    {
        // copy things
    }
    that(that &&other)
    {
        // move things
    }
}; 
```

显然，上面评论中的函数不是合法的 C++，但我需要知道是否有办法做到这一点：

```
that().frob().frob().frob(); 
```

依此类推，而每次调用`frob()`都会有效地调用其“移动”版本。由于这是可以在编译时确定的，我想不出任何理由让它不以某种形式存在。

我可以这样写：

```
that &&frob(that &&t)
{
    return t;
} 
```

这将导致：

```
frob(frob(frob(that()))); 
```

这读起来有点烦人，也没有实现我用委托“拼写出来”的目标。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T11:56:36.467

如果你想让`&&`注解的功能和其他人一起玩得很好，你应该在其他人身上使用`&`注解。

```
that &frob() &
{
    return *this;
}
that frob() const &
{
    return that(*this);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:12:41.553

不，没有办法确定对象是否是对象内的右值。你能做的最好的就是复制它，如果不是`const`，移动它：

```
that frob() const
{
    return *this;
}

that frob()
{
    return std::move(*this);
} 
```

**编辑**

正如@Potatoswatter 指出的那样，进一步的研究表明您实际上[可以，但它称为 ref-qualification 而不是注释。](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2439.htm)

# c# - 在 C# 中编译和执行外部代码

> ID：11668729
> 
> 赞同：2
> 
> 时间：2012-07-26T11:54:18.010
> 
> 标签：c#, windows, linux, multithreading, sandbox

我正在用 C# 编写一个应用程序，它将编译和执行用 C、C++ 或 Java 编写的外部代码。在这方面，我有几个问题要问，以下是我迄今为止所做的研究：

1.  将有一个服务器托管应用程序，该应用程序将接收用户提交的代码请求。这些请求将在特定套接字上发送。
2.  将有一个接收者线程将所有此类请求排入队列。
3.  会有消费者线程从队列中出列并编译和执行程序（提交的代码）。在编译和执行时，将从命令行使用适当的编译器和加载器，它们将作为 C# 应用程序的进程执行。
4.  到目前为止，可以假设沙盒、不公开服务器访问等安全问题已经/将在以后考虑。我的主要关注点是这个执行逻辑。

我有以下问题要问：

1.  有没有更好的方法来做到这一点/我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:09:15.907

1.  方法在纸面上看起来不错，但主要取决于实现。
2.  尽可能多，取决于机器的能力。操作系统将处理它们。
3.  只要您做到无懈可击，这并不重要：恶意/格式错误/明显错误的代码*将*被提交：Java 不能造成那么大的损害，但 C/C++ 有点危险。

# mysql - Mysql Unix_timestamp 函数

> ID：11668731
> 
> 赞同：2
> 
> 时间：2012-07-26T11:54:27.113
> 
> 标签：mysql

在 oracle 中将此日期 2012-07-03 11:38:41 转换为 unix_timestamp 我们得到

```
 select (to_date('2012-07-03 11:38:41','YYYY-MM-DD HH24:MI:SS') -
    to_date('1970-01-01 00:00:00','YYYY-MM-DD HH24:MI:SS'))*86400 as unix_timestamp
    from dual
SQL> /

UNIX_TIMESTAMP
--------------
    1341315521 
```

但是当我在 mysql 服务器上尝试相同的

```
select UNIX_TIMESTAMP('2012-07-03 11:38:41')
1341311921 
```

服务器设置是这样的

```
**mysql**> select current_timestamp();
+---------------------+
| current_timestamp() |
+---------------------+
| 2012-07-26 15:27:31 |
+---------------------+
1 row in set (0.00 sec)

**Unix** >Thu Jul 26 15:27:56 BST 2012

**oracle**>select current_timestamp from dual;

CURRENT_TIMESTAMP
------------------------------------
26-JUL-12 15.27.16.967258 +01:00 
```

我如何确保 oracle 和 mysql 给我相同的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-31T04:12:13.240

我用这个技巧 unix_timestamp(cast(sys_extract_utc(systimestamp) as date

然后我还写了一个名为 unix_timestamp 的函数

```
create or replace
function unix_timestamp(in_date date)
return number DETERMINISTIC PARALLEL_ENABLE AS
l_date date;
begin
return trunc((in_date -to_date ( '01-jan-1970', 'dd-mon-yyyy' ))*86400);
end;
/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T11:58:28.477

您显示的两个值之间的差异是 3600 秒，即 1 小时。

最有可能的是，两台服务器的时区设置相差一小时。

有关 mySQL 服务器中的时区信息，请参阅[https://dev.mysql.com/doc/refman/5.5/en/time-zone-support.html](https://dev.mysql.com/doc/refman/5.5/en/time-zone-support.html)。[以下](http://www.orafaq.com/usenet/comp.databases.oracle.misc/2006/09/26/0723.htm)是 Oracle 处理时区的一些深入信息。

# objective-c - 如何在.plist中写入数据？

> ID：11668733
> 
> 赞同：1
> 
> 时间：2012-07-26T11:54:39.950
> 
> 标签：objective-c, ios, plist, nsdictionary

我正在尝试在 plist 中保存一些评论，这没关系，因为它只是一个原型。问题是我可以从 plist 中读取，但是当我尝试在此之后写入和读取时，它会引发“数组越界”异常。我无法弄清楚我在这里做错了什么。

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"Comments" ofType:@"plist"];
NSMutableArray *plistArray = [[NSMutableArray alloc] initWithContentsOfFile:filePath];

NSMutableDictionary *newComment = [NSMutableDictionary dictionary];
[newComment setValue:commentTitle.text forKey:@"title"];
[newComment setValue:comment forKey:@"comment"];

[plistArray addObject:newComment];
[plistArray writeToFile:filePath atomically:NO]; 
```

效果很好，然后我尝试阅读：

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"Comments" ofType:@"plist"];
NSMutableArray *plistArray = [[NSMutableArray alloc] initWithContentsOfFile:filePath];

NSMutableDictionary *dictionary = (NSMutableDictionary *) [plistArray objectAtIndex:0];

NSLog(@"%@", [dictionary objectForKey:@"title"]); 
```

它抛出异常。

如果我手动将项目添加到 plist，它工作正常，我想这意味着我的阅读代码很好。

可能是我的 plist 的结构吗？

```
<?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
 <plist version="1.0">
 <array>
 </array>
 </plist> 
```

***由于未捕获的异常“NSRangeException”而终止应用程序，原因：“-[__NSCFArray objectAtIndex:]: index (1) beyond bounds (1)”

在写入 plist 之前，我将“描述”添加到数组中。如果我使用以下代码：

```
NSString *aDocumentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];
//    NSString *aFilePath = [NSString stringWithFormat:@"%@/Comments.plist", aDocumentsDirectory];
//
//    NSMutableArray *plistArray = [[NSMutableArray alloc] initWithContentsOfFile:aFilePath]; 
```

返回为（空）

但如果我使用：

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"Comments" ofType:@"plist"];
NSMutableArray *plistArray = [[NSMutableArray alloc] initWithContentsOfFile:filePath]; 
```

我可以看到数组的内容，并且一切正常。

问题是：在两种方式中我都无法写入文件，它一直返回“NO”。而且我已经检查了权限

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:37:57.840

您正在尝试将文件写入***mainBundle***。绝对不可能。您必须将 plist 文件写入应用程序的**Documents**或**Application Support**文件夹。

***在文档目录中创建文件路径：***

```
NSString *aDocumentsDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];

NSString *aFilePath = [NSString stringWithFormat:@"%@/Comments.plist", aDocumentsDirectory]; 
```

***写入文件路径***

```
[plistArray writeToFile:aFilePath atomically:YES]; 
```

***从文件路径读取***

```
NSMutableArray *plistArray = [[NSMutableArray alloc] initWithContentsOfFile:aFilePath]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:09:43.800

首先，你为什么要在你的包中写入一个文件？

然后，为了解决您的问题，请检查您是否确实编写了该文件。

```
if ([plistArray writeToFile:filePath atomically:NO])
    NSLog (@"Written");
else
    NSLog (@"Not Written"); 
```

此外，在您阅读数组时记录您的数组，`-(void)description`以检查字典的内容。

**编辑**

正如你所说，你没有写信给你的 plist。现在，只需在您的桌面上创建一个测试 plist。

```
NSString *testPath = [[NSString stringWithString:@"~/Desktop/Comments.plist"] stringByExpandingTildeInPath];
if ([plistArray writeToFile:testPath atomically:NO])
    NSLog (@"Written");
else
    NSLog (@"Not Written"); 
```

如果仍然返回 Not Written，那么您的字典有问题。我对此表示怀疑，因为它只是字符串（尽管它们可能是在 stackoverflow 上询问您的问题的占位符。文档指出字典中的类必须是 NSData、NSDate、NSNumber、NSString、NSArray 或 NSDictionary）。如果那说写了，我猜它不会因为权限而写入您的包，那么您必须将您的 plist 位置更改为您的包以外的其他位置，我**强烈**建议您这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:05:29.730

我发现您的代码有两个问题：

1.  （可能是也可能不是问题）。如果文件最初不存在，则`initWithContentsOfFile:`选择器将返回 nil，从而导致其余代码无操作。

2.  （可能是原因）。您可能*不会*写入捆绑资源目录。将您的文件存储在 Documents 或 Caches 目录中。

要找到您的文档目录，请使用以下内容：

```
- (NSString*) pathForDocument:(NSString*)documentName {
    NSArray *documentDirectories = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    if(documentDirectories.count < 1) return nil;
    return [[documentDirectories objectAtIndex:0] stringByAppendingPathComponent:documentName];
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-07-26T12:00:39.427

如果您只在数组中放置一项，则在读取时显然应该使用索引 0 而不是 1：

```
NSMutableDictionary *dictionary = (NSMutableDictionary *) [plistArray objectAtIndex:0]; 
```

# c# - 排序字典按 C# 中的值排序（LRU 缓存）

> ID：11668737
> 
> 赞同：7
> 
> 时间：2012-07-26T11:54:50.157
> 
> 标签：c#, algorithm, caching, collections

我想实现一个**`LRU cache`**，其中最近最少使用的元素将被异步驱逐。我目前的想法是使用 a`Dictionary`来存储`<key,value>`对，并跟踪对象的访问时间，以保持 a `SortedDictionary <key, timestamp>`。这个想法是让异步线程从缓存中获取 LRU 项`SortedDictionary`并从缓存中删除。但要使其正常工作，`SortedDictionary`需要按值排序，而事实并非如此。

我本可以使用单独`SortedList`的而不是`SortedDictionary`保持 {key and timestamp} 在 timestamp 上排序，但是我必须进行“线性”查找以从列表中查找密钥（当我必须更新时间戳时，当再次访问相同的键时） - 如果可能的话，我正在寻找一种比线性方式更好的方式。有人可以分享解决这个问题的想法吗？

所以，我的问题归结为：

我必须在 <= logn time 中查找键以更新时间戳，同时能够根据时间戳对键进行排序。

一种考虑的方法是根据 {key,timestamp} 的时间戳部分保留其中一个键`SortedDictionary`的`<{key,timestamp},null>`顺序。虽然这很好，但问题是`hashcode()`只需要返回 key.hashcode() （用于在更新时间戳时进行查找），同时`equals()`还应该使用时间戳。所以 ,`equals()`和`hashcode()`是 冲突 的 , 所以 觉得 这 不是 好 主意 ...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:17:19.397

你应该做的是保留两本字典，一本按时间排序，一本按键排序。

请记住，字典仅保存对您的实际对象的引用，因此您使用哪个字典来更新对象并不重要。

要更新对象，请创建一个将更新两个字典的函数

```
var oldObj = keyedObject[key];
timedObjects.Remove(oldObj.LastUpdateTime);
timedObjects.Add(myUpdatedObject.LastUpdateTime,myUpdatedObject);
keyedObject[key] = myUpdatedObject; 
```

现在您可以按时间和键跟踪同一对象。

我只保留一个对`timedObjects`. 这有助于删除。

您可以根据需要继续修剪您的 timedObjects 字典。

Ofcource，在修剪时，您必须记住还有另一个字典`keyedObject`引用了同一对象。仅仅打电话`Remove`是不够的。

您的删除代码必须是这样的：

```
removeObject = timedObjects[timeToRemove];
timedObjects.Remove(timeToRemove);
keyedObject.Remove(removeObject.key); 
```

*timeToRemove 主要来自 for 循环，您可以在其中决定要删除的对象*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:35:34.603

代替 sorteddictionary，编写你自己的链表，并让 Dictionary 指向它的节点作为值。它将始终按时间戳排序，更新时间戳和删除最近最少使用的元素将是 O(1)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:28:12.943

您要查找的地图类型（至少在 Java 中）称为[`LinkedHashMap`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/LinkedHashMap.html).

从javadoc：

> Map 接口的哈希表和链表实现，具有可预测的迭代顺序。此实现与 HashMap 的不同之处在于它维护一个双向链表，该列表贯穿其所有条目。这个链表定义了迭代顺序，通常是键插入映射*的顺序（插入顺序*）。
> 
> 提供了一个特殊的构造函数来创建一个链接哈希映射，其迭代顺序是其条目最后一次访问的顺序，从最近最少访问到最近访问（*访问顺序*）。这种映射**非常适合构建 LRU 缓存**。

[`LinkedHashMap`来自 OpenJDK 的来源](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/LinkedHashMap.java)

`LinkedHashMap`AFAIK，在 C#中没有现有的实现。话虽如此，写一个应该不难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-11T04:11:26.003

这是C#中LRU Cache的实现。高效 O(1)，但不是线程安全的；

```
 static void Main(string[] args)
    {
        var cache = new LruCache(3);
        cache.Put(1, 1);
        cache.Put(2, 2);
        Console.WriteLine(cache.Get(1));       // returns 1
        cache.Put(3, 3);    // evicts key 2
        Console.WriteLine(cache.Get(2));       // returns -1 (not found)
        cache.Put(4, 4);    // evicts key 1
        Console.WriteLine(cache.Get(1));       // returns -1 (not found)
        Console.WriteLine(cache.Get(3));       // returns 3
        Console.WriteLine(cache.Get(4));       // returns 4     

    }

    public class DoubleLinkedList
    {
        public int key;
        public int value;
        public DoubleLinkedList next;
        public DoubleLinkedList prev;
        public DoubleLinkedList(int k, int v)
        {
            key = k;
            value = v;
        }
    }

    public class LruCache
    {
        private int size;
        private int capacity;
        private Dictionary<int, DoubleLinkedList> map;
        private DoubleLinkedList head;
        private DoubleLinkedList tail;
        public LruCache(int cap)
        {
            capacity = cap;
            map = new Dictionary<int, DoubleLinkedList>();
            head = new DoubleLinkedList(0, 0);
            tail = new DoubleLinkedList(0, 0);
            head.next = tail;
            tail.prev = head;
        }

        public int Get(int key)
        {
            if (map.ContainsKey(key))
            {
                if (tail.prev.key != key)
                {
                    var node = map[key];
                    RemoveNode(node);
                    AddToEnd(node);
                }
                return map[key].value;
            }
            return -1;
        }

        private void AddToEnd(DoubleLinkedList node)
        {
            var beforeTail = tail.prev;
            node.prev = beforeTail;
            beforeTail.next = node;
            tail.prev = node;
            node.next = tail;
        }

        private void RemoveNode(DoubleLinkedList node)
        {
            var before = node.prev;
            before.next = node.next;
            node.next.prev = before;
        }

        public void Put(int key, int value)
        {
            if (map.ContainsKey(key))
            {
                map[key].value = value;
                var node = map[key];
                RemoveNode(node);
                AddToEnd(node);
            }
            else
            {
                size++;
                if (size > capacity)
                {
                    var node = head.next;
                    RemoveNode(node);
                    map.Remove(node.key);
                    size--;
                }

                var newNode = new DoubleLinkedList(key, value);
                AddToEnd(newNode);
                map.Add(key, newNode);
            }
        }
    } 
```

# html - 使用 HTML 和 CSS 的 L 形边框

> ID：11668740
> 
> 赞同：0
> 
> 时间：2012-07-26T11:54:58.990
> 
> 标签：html, css

我需要在图片所示框的空白处填充数据。红色部分将是图像，但仍然必须在空白处连续显示数据。我如何使用 HTML 和 CSS 来实现这一点？

![在此处输入图像描述](../Images/8e6b55ef939ff54ee89cfba64b9578ee.png)

```
Updated with code :

 <div id="Content" runat="server">
    <img id="ad" src="images/sandbox.gif"  
            style="float:right; height: 200px; width: 150px;" alt="{alt}" />

    </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:36:23.810

@Anuya 看看这个[http://jsfiddle.net/TfXNf/](http://jsfiddle.net/TfXNf/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:12:31.127

如果您在 css 样式中定义一个类以切换所有需要具有相同布局的图片，那就更好了

HTML

```
<img src="http://link.to/image.jpg" class="className" alt="Image"/> 
```

CSS

```
.className{
float: right;
margin-right:2px; /*change these based on your layout*/
margin-bottom: 2px; /*change these based on your layout*/
} 
```

需要边距将文本推离图片一点点，这样您就可以创建边框的错觉

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:05:02.087

只需在您的图像上放置一个浮点数：

```
<img src="{imageLocation}" alt="{alt}" style="float:right;" /> 
```

理想情况下，您希望将样式与内容分开，但这会给您带来想法。希望有帮助

# c# - 此上下文不支持“使用”属性。C＃

> ID：11668742
> 
> 赞同：3
> 
> 时间：2012-07-26T11:55:06.950
> 
> 标签：c#, xml, xsd, schema

我正在尝试使用`ReadXmlSchema`C# 读取 xsd 文件。但是我在尝试读取 xsd 文件时遇到了问题。我收到错误消息

> 此上下文不支持“使用”属性。

实际上 xsd 包含属性`use="required"`。

```
<xs:attribute name="sch" type="xs:string" use="required"/>

DataSet ds = new DataSet();
ds.ReadXmlSchema(@"C:\Schema\Schema.xsd"); 
```

有什么想法有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:59:27.857

只有在定义了全局属性时才会收到此错误消息。仅当属性是内容模型的一部分时才能***使用。***

# emacs - Emacs minibuffer 完成

> ID：11668743
> 
> 赞同：6
> 
> 时间：2012-07-26T11:55:12.413
> 
> 标签：emacs, elisp, launcher, tab-completion, minibuffer

我有一个异步启动程序的功能：

```
(defun app (app-name)
  (interactive "sRun application: ")
  (async-shell-command app-name)) 
```

我有一个可供选择的所有可执行文件的列表。我希望`app`函数表现为`switch-to-buffer`，为用户提供 TAB 补全。如何在 Emacs 中使用 minibuffer 完成？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-26T11:57:35.537

使用`completing-read`命令。该功能看起来像

```
(defun app ()
  (interactive)
  (let ((app-name (completing-read "Run application: " program-list)))
    (async-shell-command app-name))) 
```

* * *

可能更惯用的是使用`interactive`而不是根据[Emacs Lisp Idioms 分配给变量： Prompting for User Input](http://ergoemacs.org/emacs/elisp_idioms_prompting_input.html)：

```
(defun app (app-name)
  (interactive (list (completing-read "Run application: " app-list)))
  (async-shell-command app-name)) 
```

如果您根据[Run a program from Emacs and don't wait for output](https://stackoverflow.com/q/7298372/596361)不关心进程输出，您也可以使用`(start-process app-name nil app-name)`而不是。`(async-shell-command app-name)`

* * *

参见[Minibuffer Completion](http://www.gnu.org/software/emacs/manual/html_node/elisp/Minibuffer-Completion.html#Minibuffer-Completion)了解更多关于 Emacs 完成的想法和从 Emacs 调用进程的[异步进程](http://www.gnu.org/software/emacs/manual/html_node/elisp/Asynchronous-Processes.html#Asynchronous-Processes)，两者都来自 GNU 手册。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-26T13:07:37.200

如果您希望完成可能的 shell 命令而不需要自己维护一个列表，并且您使用的是 Emacs 23 或更新版本，您可以使用`read-shell-command`：

```
(defun app (app-name)
  (interactive (list (read-shell-command "Run application: ")))
  (async-shell-command app-name)) 
```

# c# - 以编程方式启用 Wi-Fi 和蓝牙

> ID：11668746
> 
> 赞同：3
> 
> 时间：2012-07-26T11:55:20.477
> 
> 标签：c#, windows-phone-7

我需要编写 2buttons 的处理程序来启用/禁用 wifi 和蓝牙。现在，我只能看到手机设置页面，在这里我可以手动更改启用/禁用 wifi 和蓝牙。那么，我怎样才能以编程方式做到这一点？

无线网络代码：

```
 ConnectionSettingsTask connectionSettingsTask = new ConnectionSettingsTask();
        connectionSettingsTask.ConnectionSettingsType = ConnectionSettingsType.WiFi;
        connectionSettingsTask.Show(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T13:06:15.173

除了显示 wifi / 蓝牙设置页面，您不能做任何其他事情。

然后用户必须切换按钮。

# python - 在国际象棋编程中取消移动与抄板

> ID：11668748
> 
> 赞同：4
> 
> 时间：2012-07-26T11:55:29.427
> 
> 标签：python, chess

我正在开始创建一个国际象棋引擎。当我创建一个检查移动是否合法的函数时，首先我必须进行移动，然后检查移动是否使我的国王受到控制，然后取消它。

在考虑了如何制作一个取消移动的功能之后，我决定复制棋盘并在复制的棋盘上进行假设移动要简单得多，因此它根本不会改变原始棋盘结构。

但我担心这可能不是一个好主意，因为当我进入 AI 部分时，我必须完全复制电路板，这可能会减慢我的引擎速度。是这样吗？您能否分享您对此的想法，因为我对算法复杂性和这类东西知之甚少。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T11:58:39.167

正如您所说，复制整个电路板可能会大大降低速度。我建议制作一个撤消列表，您可以在其中添加您所做的每一步的反向操作。然后要撤消，只需重复从列表中弹出移动并应用它们直到列表为空。这样，您的 AI 可以通过使用带有 maxdepth 参数的简单递归函数来探索所有可能性。

**回复：博的评论**

我恭敬地不同意。

对于用低级语言编写的程序，一个板副本可能相当于一个 memcpy，然后它可能会更快。但是对于一个面向对象的 python 程序，每个棋子有一个对象，加上元数据，一个完全独立的游戏状态副本几乎肯定比创建一个新的“撤消”对象并将其添加到列表要慢得多。

请注意，这与结构的大小无关，更多的是与复制该结构所需的操作数量有关。特别是在 python 中，函数调用会增加大量开销。根据[这个](https://stackoverflow.com/a/11722271/566644)答案（我自己的），在 CPython 中实例化 32 个对象相当于 83 个函数调用，并且假设它们除了`object`. 然后数据分配和复制是最重要的。

如果板是 16x16 numpy 数组，我同意板副本可能会更快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T12:00:10.263

通常使用 unmake 方法更多，因为它避免了不必要的电路板复制。如果您想在`Position`课堂上以两种不同的形式保留作品，则尤其如此；作为传统的 8x8 数组和一组 64 位无符号整数（位板）。

您需要创建一个类来存储您的`UnmakeMoveInfo`哪些持有：

*   移动的起点/终点。
*   前一个位置哈希。
*   “半步时钟”。
*   过路人面具。
*   捕获的片断。
*   先前位置标志（检查、ep_move、castling 权利）。

这样您就拥有取消移动所需的所有信息。

# c# - WPF：对象引用未设置为对象的实例

> ID：11668759
> 
> 赞同：2
> 
> 时间：2012-07-26T11:56:11.520
> 
> 标签：c#, wpf, xmlnode

我正在使用 WPF 访问此方法。我知道从外部方法访问对象时，我应该使用 Dispatcher。或者“节点”是一个局部变量，它给了我：

> 你调用的对象是空的。

为什么？

这是代码：

```
SpeechSynthesizer valery = new SpeechSynthesizer();
XmlDocument xmlNews = new XmlDocument();
xmlNews.Load(string.Format("http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=tc&output=rss"));
foreach (XmlNode node in xmlNews.SelectNodes("/rss/channel/item"))
{
    valery.Speak(node.SelectSingleNode("/title").InnerXml);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:02:22.540

老实说，我怀疑`node.SelectSingleNode`返回的是 null，这意味着尝试调用 to`InnerXml`正在触发异常。

尝试进行以下更改：

```
foreach (XmlNode node in xmlNews.SelectNodes("/rss/channel/item"))
{
    var titleNode = node.SelectSingleNode("/title");

    if (titleNode != null && !string.IsNullOrEmpty(titleNode.InnerXml))
        valery.Speak(titleNode.InnerXml);
} 
```

我也检查了`InnerXml`以防万一`Speak`不能取空字符串。

我最初并不怀疑 XPath，因为如果 XPath 没有找到任何东西，这些方法将返回空集合而不是 null 项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:10:02.383

拿出你的正斜杠，然后再试一次。见下文：

```
SpeechSynthesizer valery = new SpeechSynthesizer();
XmlDocument xmlNews = new XmlDocument();
xmlNews.Load(string.Format("http://news.google.com/news?pz=1&cf=all&ned=us&hl=en&topic=tc&output=rss"));
foreach (XmlNode node in xmlNews.SelectNodes("/rss/channel/item"))
{
    valery.Speak(node.SelectSingleNode("title").InnerXml);
} 
```

这对我有用

# push-notification - GCM - 注册 ID 的最大长度

> ID：11668761
> 
> 赞同：48
> 
> 时间：2012-07-26T11:56:13.580
> 
> 标签：push-notification, google-cloud-messaging

> **更新：不推荐使用** [GCM](https://developers.google.com/cloud-messaging/)，请使用[FCM](https://firebase.google.com/docs/cloud-messaging/)

GCM 服务器颁发的注册 ID 的最大长度是多少？GCM 文档不提供此信息。谷歌搜索显示，注册 ID 本质上不是固定长度，长度可达 4K（4096 字节）。但这些不是谷歌的官方答案。我目前正在接收长度为 162 个字符的注册 ID。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-11-29T10:04:18.243

在 android-gcm 论坛上，谷歌的开发人员[确认](https://groups.google.com/d/msg/android-gcm/q2PzJTP71TY/DNX4lvDu5X4J)它是 4k

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-07-26T14:52:17.650

我也有兴趣知道这件事。我的 reg id 大小为 183 个字符。我怀疑它不会超过 512 个字符，更不用说 4K 了。想象一下发送批量通知，4K reg id x 1000 = 4MB 消息大小！

最后，我只使用 MySQL 表中的“文本”类型来存储注册 ID。因此，即使谷歌向我发送 1K、2K 或 4K（非常不可能）的 reg id，我也能处理它。

更新：我遇到了一个新的 reg id 大小：205。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T09:17:56.253

这就是GCM doc中所说的，

一个 JSON 对象，其字段表示消息有效负载数据的键值对。如果存在，有效负载数据将作为应用程序数据包含在 Intent 中，键是额外的名称。例如，"data":{"score":"3x1"} 将导致一个意图额外命名的分数，其值为字符串 3x1。

键/值对的数量没有限制，但消息的总大小（4kb）有限制。这些值可以是任何 JSON 对象，但我们建议使用字符串，因为无论如何这些值都会在 GCM 服务器中转换为字符串。

如果要包含对象或其他非字符串数据类型（如整数或布尔值），则必须自己转换为字符串。另请注意，密钥不能是保留字（from 或任何以 google. 开头的单词）。

让事情稍微复杂一点的是，在有效载荷数据中技术上允许使用一些保留字（例如 collapse_key）。但是，如果请求中还包含该单词，则请求中的值将覆盖有效负载数据中的值。因此，即使在技术上允许的情况下，也不建议使用在此表中定义为字段名称的词。可选的。

# asp.net-mvc - MVC4 / IIS6 中的 TempData /Session 不返回存储的值

> ID：11668762
> 
> 赞同：0
> 
> 时间：2012-07-26T11:56:28.103
> 
> 标签：asp.net-mvc, session, iis, asp.net-mvc-4

真的在为 MVC / TempData / Session / 可能是 IIS6 类型的问题而苦苦挣扎。

我有一个简单的 MVC 网站 - 主控制器如下所示：

```
public class DemoController : Controller
{
    [HttpPost]
    public RedirectToRouteResult Index(SomeObject obj)
    {
        _someService.DoStuffWith(obj);

        TempData.Add("SomeObject", obj);

        return RedirectToAction("Index");
    }

    [HttpGet]
    public ViewResult Index()
    {
        var obj = TempData.Peek("SomeObject") as SomeObject;

        return View("Hello", obj);
    }
} 
```

所以这是一个超级简单的 Post Redirect Get - 从某个地方提交数据，在 Post-friendly 操作中获取它，用它做一些事情，将它插入临时数据，重定向到 Get-friendly，再次拿起它，粘住用户在模型中的对象的新视图上。之前已经实现了十几次，从来没有出现过问题，但它一直在 IIS7 上。

在 cassini 和本地 IIS 7.5 上本地运行时，这完全符合预期。但是，一旦我部署到 Server 2003 和 IIS6，当我第一次尝试访问视图中“SomeObject”模型的任何属性时，我得到一个空引用异常。

那么，我还尝试了什么：

*   我已经放弃了 TempData 并将其推入 Session["Whatever"] - 结果相同
*   我已经推入 HttpContext.Current.Session["Whatever"] - 结果相同
*   我已经推入 ControllerContext.HttpContext.Session["Whatever"] - 结果相同

（诚​​然，我对这些之间的差异很粗略 - 以前从来不需要担心它）

*   我已确保在 IIS 上打开了会话状态。
*   我检查了 Asp.net 会话标识符在请求之间没有变化。
*   我已经部署到 2 个单独的服务器，都运行 2003 和 IIS6，两者的结果相同
*   明确使用 SessionStateBehaviour.Required

我不能做的事情：

*   在我的本地计算机之外部署到 IIS7
*   使用 SqlServer 会话状态
*   使用 StateServer SessionState

另外值得一提的是，该站点正在使用 MVC4 RC——尽管站点的这个特定部分没有使用 RC 功能。

欢迎任何想法或意见！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T18:47:22.610

这是我系统上的问题 - 我有一个包含下划线的服务器名称。RFC 952 不允许在主机名中使用下划线，这可能会干扰设置 cookie 并因此保持会话的能力。

为了追踪这一点，我开始观察每个控制器部分中的 SessionID，并注意到每篇文章都在变化。这只发生在我们的测试服务器上，因为我们用 _t 命名它以表明它是一台测试机器。哎哟！

我发现[了这一点](http://weblogs.asp.net/bleroy/archive/2004/08/03/Don_2700_t-redirect-after-setting-a-Session-variable-_2800_or-do-it-right_2900_.aspx)。

这可能会提供其他价值。

我希望这有帮助

大卫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-26T10:23:33.523

我的问题是我在 web.config 文件中有这个设置，但没有使用 SSL：

`<httpCookies requireSSL="true" />`

此设置可防止 cookie 在不安全（即非 SSL）连接上工作 - 包括 ASP.NET 会话 cookie。

# mysql - 计算数据库中中性、正面和中性推文的数量并相应地更新表

> ID：11668764
> 
> 赞同：1
> 
> 时间：2012-07-26T11:56:31.287
> 
> 标签：mysql

考虑下表

```
users                    tweets
--------------------     -----------------------------
user_id  neu pos neg     id _date       user_id  class
--------------------     -----------------------------
1                        1  2011-02-13  1        1
2                        2  2011-02-13  1        2
                         3  2011-02-15  2        1
                         4  2011-02-16  2        3
                         5  2011-02-16  2        3 
```

数据库中的每条推文都经过分析和分类。`tweets.class`可以是`1`（中性）、`2`（正）或`3`（负）。我需要一个查询来计算每个用户的所有`neu`（中性、`pos`（正面）和`neg`（负面）推文。查询的最终结果将是和`UPDATE`d `users`-table，如下所示：

```
users
--------------------
user_id  neu pos neg
--------------------
1        1   1   0
2        1   0   3 
```

我现在有，但这根本不起作用。是朝着正确的方向前进吗？

```
update users u left join (
  select count(t.id) as neu from tweets t where class = 1 
) on u.user_id = t.user_id
set u.neu = coalesce(neu,0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:11:20.950

这应该工作：

```
UPDATE users a
       INNER JOIN (SELECT user_id,
                          SUM(IF(class = 1, 1, 0)) AS class_1,
                          SUM(IF(class = 2, 1, 0)) AS class_2,
                          SUM(IF(class = 3, 1, 0)) AS class_3
                   FROM tweets
                   GROUP BY user_id
                 ) b
             ON a.user_id = b.user_id
SET a.neu = b.class_1,
    a.pos = b.class_2,
    a.neg = b.class_3; 
```

# java - Android 从代码中截取屏幕截图，具有 root 访问权限

> ID：11668767
> 
> 赞同：2
> 
> 时间：2012-07-26T11:56:45.903
> 
> 标签：java, android, screenshot, framebuffer

我需要从后台运行的服务中截取屏幕截图。屏幕截图可以是前台应用程序的截图，即使它不是我的应用程序，这就是我不能使用 DrawingCache 的原因。我四处寻找，发现了这个

`process = Runtime.getRuntime().exec("su -c cat /dev/graphics/fb0"); InputStream is = process.getInputStream();`

但我不知道如何处理流。如何将其放入位图中？我不需要将其保存到文件中，只需将其保存在变量中即可。这适用于有根电话。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-28T18:11:12.650

好吧，看来我独自一人。到目前为止，对于那些有类似问题的人来说，这就是我发现的。请注意，这因版本而异，我正在运行 2.3 Gingerbread。

我在`/system/bin`-`screencap`和`screenshot`.

`screencap`以我不知道如何解码的格式返回位图，同时`screenshot`在 sdcard 的根目录创建一个名为 tmpshot.bmp 的常规 bmp 文件（不接受任何类型的命令参数。他们似乎不接受 -h， -help，--help 等）。

tmpshot.bmp 目前似乎是一个可行的解决方案，但我希望避免从 sdcard 写入和读取，因为这是相当大的瓶颈。我会继续寻找，但对于那些现在需要解决方案的人来说，这里有。

编辑：经过进一步的试验，我发现`screencap`来自另一个 rom 的二进制文件（具体来说是 MIUI）实际上提供了更多选项，其中 (miui)`screencap -t png /sdcard/screen.png`产生了一个有效的 png 屏幕截图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T12:26:38.180

尝试这个

```
 Process sh = Runtime.getRuntime().exec("su", null,null);    
                    OutputStream  os = sh.getOutputStream();
                    os.write(("/system/bin/screencap -p " + "/sdcard/img.png").getBytes("ASCII"));
                    os.flush();          
                    os.close();
                    sh.waitFor(); 
```

把它放在一个 try catch 块中

# java - 用户主目录中的 log4j 日志文件

> ID：11668770
> 
> 赞同：15
> 
> 时间：2012-07-26T11:56:50.147
> 
> 标签：java, log4j

我正在开发一个将在 OSX 和 Windows 上运行的应用程序。我希望将日志写入用户主目录。对于 OSX，它将位于 /Users//Library/Application Support/MyApp/log 目录下，在 windows 下取决于 /Users//AppData/MyApp/log 目录下的版本。

我能做到这一点的最佳方法是什么？我已经四处寻找解决方案，但没有任何有用的解决方案或我喜欢使用的解决方案出现。

期待您的投入。

编辑：由于日志文件的位置取决于操作系统，我希望找到一个运行时解决方案，可能如下所示

```
if (System.getProperty("os.name").contains("mac"))
    logFileLocation = System.getProperty("user.home") + "/Library/Application Support/MyApp/logs"
else
    logFileLocation = System.getenv("APPDATA") + "/MyApp/logs" 
```

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-26T12:01:22.680

将 更改`ConsoleAppender`为`FileAppender`. 据我所知，写请求将被重定向到 Windows 操作系统上的 appdata。不确定MacOs。

```
URL mySource = MyAppMainClass.class.getProtectionDomain().getCodeSource().getLocation();
File rootFolder = new File(mySource.getPath());
System.setProperty("app.root", rootFolder.getAbsolutePath()); 
```

并像这样编辑 log4j 配置

```
log4j.appender.NotConsole=org.apache.log4j.RollingFileAppender
log4j.appender.NotConsole.fileName=${app.root}/fileName.log 
```

或用户家：

```
// log4j 1.*
log4j.appender.NotConsole.fileName=${user.home}/fileName.log
// log4j 2.*
log4j.appender.NotConsole.fileName=${sys:user.home}/fileName.log 
```

请注意，log4j 2 需要`sys:`前缀 - 感谢@sgrubsmyon

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-29T13:54:47.233

谢谢大家的投入。根据亚历克斯提出的提示，我采用了以下方法，

在 log4j.properties 我有以下配置

```
log4j.appender.FILE=org.apache.log4j.RollingFileAppender
log4j.appender.FILE.File=${userApp.root}/logs/myapp.log 
```

在应用程序开始时我已经这样做了。

```
System.setProperty("userApp.root", getUserAppDirectory()); 
```

getUserAppDirectory() 方法定义为

```
static String getUserAppDirectory() {
    if (isMacOS())
        return System.getProperty("user.home") + "/Library/Application Support/myapp";
    else
        return System.getenv("APPDATA") + "/myapp";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T08:59:23.340

可能最干净的方法是编写 log4j 配置假设特定的系统属性（例如`myapp.data.dir`）

```
log4j.appender.logfile.fileName=${myapp.data.dir}/logs/myapp.log 
```

并在每个平台的启动器中以适当的方式设置该属性。例如，如果您`.app`在 Mac OS X 上使用捆绑软件，那么您可以在`Info.plist`

```
<plist version="1.0">
<dict>
    <!-- ... -->
    <key>Java</key>
    <dict>
        <!-- ... -->
        <key>Properties</key>
        <dict>
            <key>apple.laf.useScreenMenuBar</key>
            <string>true</string>
            <key>myapp.data.dir</key>
            <string>$USER_HOME/Library/Application Support/MyApp</string> 
```

或将其设置为相对于 Windows 上的 APPDATA 环境变量（它将处理 XP 和 7 之间的差异）。使用[Launch4J](http://launch4j.sourceforge.net) `.exe`，您可以将`-Dmyapp.data.dir="%APPDATA%\MyApp"`文件[`.l4j.ini`放入](http://launch4j.sourceforge.net/docs.html#Additional_jvm_options).

在尝试访问任何记录器之前，您需要显式代码来初始化 log4j

```
if(System.getProperty("myapp.data.dir") == null) {
  // fallback to ~/.myapp (sensible Linux default) if run without a launcher
  System.setProperty("myapp.data.dir", new File(
        System.getProperty("user.home"), ".myapp").getAbsolutePath());
}
// ensure log directory exists
new File(new File(System.getProperty("myapp.data.dir")), "logs").mkdirs();
// now it's safe to configure log4j
PropertyConfigurator.configure(this.getClass().getResource("/log4j.properties")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-12T10:59:00.770

我已经解决了 mac 中 log4j.xml 的路径问题：

在 Windows 中，我们在 web.xml 中配置 log4j，例如：

```
 <listener>
        <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
    </listener>

    <context-param> 
        <param-name>log4jConfigLocation</param-name> 
        <param-value>file:${LOG4J_HOME}/conf/log4j.xml</param-value> 

<!--   Above path is that where we have stored log4j.xml file externally  -->
    </context-param> 

    <context-param>
        <param-name>log4jRefreshInterval</param-name>
        <param-value>6000</param-value>
    </context-param> 
```

其中 ${LOG4J_HOME} 是我们用来在窗口中设置的用户变量。喜欢

用户变量 = LOG4J_HOME 值 = D:/LOG4J（在 d 驱动器中，我们创建了一个名为 Log4J 的文件夹，我们复制了该路径并作为值给出）

在 mac 中，我们通过 bash 命令设置了环境变量集 fasility，但它不再起作用了。

因此对于 mac，我们必须在任何地方创建一个文件夹，并且我们必须提供该文件夹的静态路径。

就像在 xml 中一样：

```
<listener>
        <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
    </listener>

    <context-param> 
        <param-name>log4jConfigLocation</param-name> 
        <param-value>file:/Users/vardhaman/Desktop/LOG4J/conf/log4j.xml</param-value> 
<!--   Above path is that where we have stored log4j.xml file externally  to get this path go up to the log4j.xml file in external device and right click select get info, where we will get path, copy that path -->

    </context-param> 

    <context-param>
        <param-name>log4jRefreshInterval</param-name>
        <param-value>6000</param-value>
    </context-param> 
```

我们必须在 log4j.xml 文件中做同样的事情

在窗口中，我们经常这样做：

```
<appender name="CLICK-SPRING" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="${LOG4J_HOME}/logs/CLICK/CLICK-spring.log"/>
        <param name="Append" value="true"/>
        <param name="Threshold" value="DEBUG"/>
        <param name="MaxFileSize" value="100MB"/>
        <param name="MaxBackupIndex" value="10" />
        <layout class="org.apache.log4j.PatternLayout">
          <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss} %p [%t] %C{1}.%M(%L) | %m%n"/>
        </layout>
    </appender> 
```

在 mac 中：

代替值，我们必须将静态路径复制到文件夹 LOG4J，或者您可以创建任何文件夹。

```
<appender name="CLICK-SPRING" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="Users/vardhaman/Desktop/LOG4J/logs/CLICK/CLICK-spring.log"/>
        <param name="Append" value="true"/>
        <param name="Threshold" value="DEBUG"/>
        <param name="MaxFileSize" value="100MB"/>
        <param name="MaxBackupIndex" value="10" />
        <layout class="org.apache.log4j.PatternLayout">
          <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss} %p [%t] %C{1}.%M(%L) | %m%n"/>
        </layout>
    </appender> 
```

# c++ - 令人困惑的枚举初始化

> ID：11668772
> 
> 赞同：0
> 
> 时间：2012-07-26T11:56:54.533
> 
> 标签：c++

这段代码是什么意思：

```
using namespace std;

enum DRAM_Controller { dram_controller_maximum = 10};

void myprint(DRAM_Controller dct)
{
    printf("dct value is: %d\n", dct);
}

int main ()
{

    DRAM_Controller(0); //**--> What is the meaing of this**

    printf("value is : %d\n", dram_controller_maximum);
    printf("value is : %d\n", DRAM_Controller(1));
    myprint(DRAM_Controller(0));
} 
```

输出为：值是：10 值是：1 dct 值是：0

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:00:01.020

`int`这是从到的演员表`DRAM_Controller`

它创建一个临时类型`DRAM_Controller`并且没有效果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:11:39.167

你指出的那条线，

```
DRAM_Controller(0); 
```

将 a 转换`0`为`DRAM_Controller`，然后忽略它。

它具有相同的效果

```
0; 
```

并且同样有用。

在 C++ 中，任何可以适合枚举大小的整数都可以转换为该枚举。这是在枚举值上“切换大小写”时使用大小写是个好主意
的原因之一。`default:`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T12:13:13.940

在这里，您将 a 分配`dram_controller_maximum`给 10，这仅表示每次编写 `something = dram_controller_maximum`时，您的意思是`something = 10`：

```
enum DRAM_Controller { dram_controller_maximum = 10}; 
```

对于下面的函数，如果你传递一个数字，它只会打印它。如果你传递一个`DRAM_Controller`变量，它将评估它的值（一个数字，记住），并打印它。

```
void myprint(DRAM_Controller dct)
{
    printf("dct value is: %d\n", dct);
} 
```

以下行只是将整数 ( `0`) 转换为`DRAM_Controller`。仅这一行就没什么用了：

```
DRAM_Controller(0); //**--> What is the meaing of this** 
```

接下来的三行将打印`dram_controller_maximum`转换为 int 的值。请记住，一开始我们说它等于 10，所以这只会打印 10。所有三行都做同样的事情：它们尝试将 DRAM_Controller 类型的值解释为 int 并打印它：

```
printf("value is : %d\n", dram_controller_maximum);
printf("value is : %d\n", DRAM_Controller(1));
myprint(DRAM_Controller(0)); 
```

基本上， an`enum`只是一堆`int`具有“名称”的 s：

> C 将枚举值的整数表示直接暴露给程序员。整数和枚举值可以自由混合，并且允许对枚举值进行所有算术运算。枚举变量甚至可以保存一个不代表任何枚举值的整数。事实上，根据语言定义，上面的代码会将 CLUBS、DIAMONDS、HEARTS 和 SPADES 定义为 int 类型的常量，只有将它们存储在该类型的变量中才会（默默地）转换为 enum cardsuit

和

> C++ 具有直接从 C 继承的枚举类型，它们的工作方式大多类似，除了枚举是 C++ 中的真实类型，提供额外的编译时检查。

[来自维基。](http://en.wikipedia.org/wiki/Enumerated_type)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:11:15.293

它创建一个`DRAM_Controller`使用给定值初始化的临时、未命名类型的对象。

第一行没有任何效果，因为对象在没有使用其值的情况下被销毁。最后两行使用对象来初始化函数参数。

# wpf - 如何在不同的程序集中使用 ResourceDictionaries 以及 VS2010 中的 DesignTime 支持

> ID：11668776
> 
> 赞同：0
> 
> 时间：2012-07-26T11:57:14.427
> 
> 标签：wpf, visual-studio-2010, resourcedictionary, design-time

我有以下问题。我有位于不同程序集中的 ResourceDictionaries。如果我创建 UserControls 并使用此 ResourceDictionaries 中的 Styles 和 Resourcen 在**运行时**都可以正常工作，但在设计时我在 vs2010 中遇到错误，例如 - 无法找到名称为“InvertConverter”的资源。

*   核心资源.dll
*   其他资源.dll
*   UserControl.dll（参考以上两者）
*   OtherWpf.dll（参考以上所有内容并使用用户控件）

现在我检查了很多与这个问题相关的帖子和​​博客。一种解决方案是将 ResourceDictionaries 添加到每个 UserControl - 这会起作用，但会在运行时产生大量开销。我发现的所有其他解决方案都不适合我。

我会将我所做的事情作为答案发布，因为它对我有用。但我想看看其他/更好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:03:55.707

这就是我现在所做的。

我只是在设计时使用静态方法添加我的资源**字典**。

```
public class DesignTimeResourceLoader
{
    public static void LoadResources4DesignTime(UserControl ctrl)
    {
        //do this just in DesignMode
        if (Convert.ToBoolean(DesignerProperties.IsInDesignModeProperty.GetMetadata(ctrl).DefaultValue))
        {
            var uricore = new Uri("/CoreResource;component/ResourceDictionary.xaml", UriKind.Relative);
            var core = (ResourceDictionary)Application.LoadComponent(uricore);
            ctrl.Resources.MergedDictionaries.Add(core);

            var uriother = new Uri("/OtherResource;component/OtherResourceDictionary.xaml", UriKind.Relative);
            var other = (ResourceDictionary)Application.LoadComponent(uriother);
            ctrl.Resources.MergedDictionaries.Add(other);

            //if you have(need more just add here
        }
    }
} 
```

我在我的 UserControl.dll 中创建并使用这个类，并且对于每个 Usercontrol 我在构造函数中调用该方法。

```
public partial class MyControl : UserControl
{
    public MyControl ()
    {
        DesignTimeResourceLoader.LoadResources4DesignTime(this);
        InitializeComponent();
    }
} 
```

这对我有用。bu也许有一些我现在没有看到的缺点。

# android - 当方向改变时，如何使 VideoView 在不同的布局中完美播放？

> ID：11668779
> 
> 赞同：1
> 
> 时间：2012-07-26T11:57:22.050
> 
> 标签：android, android-layout, screen-orientation, android-orientation

说在纵向模式下，我将屏幕划分为 2x1 矩阵（2 个 VideoViews），以便可以同时播放两个视频。

```
 -------------------
                                   |                 | 
                                   |                 |
                                   |      VV1        |
                                   |                 |
                                   -------------------
                                   |                 | 
                                   |                 |
                                   |      VV2        |
                                   |                 |
                                   ------------------- 
```

现在，当我将手机旋转到横向时，屏幕需要分成 2x2 矩阵（4 个 VideoViews）。

```
 ----------------------------------------------
                        |                     |                      |
                        |                     |                      |                                                        
                        |        VV1          |         VV2          |
                        |                     |                      |  
                        ----------------------------------------------
                        |                     |                      |
                        |                     |                      |                                                        
                        |        VV3          |         VV4          |
                        |                     |                      |  
                        ---------------------------------------------- 
```

因此，在这种情况下，当从纵向更改为横向时，我希望需要达到以下几点。

1.  需要动态更改布局而不会中断视频。（从 2 Videoview 到 4 Videoview）。

2.  视频应该可以完美播放。在定向过程中不应暂停和播放。

3.  如果您建议我使用“configChanges="orientation"”，我如何在定位期间处理布局？？？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:37:25.570

使用[Fragments](http://developer.android.com/guide/components/fragments.html)可能是一个解决方案。如果您选择，它会在方向更改时保留其状态（因此您不会丢失实例对象），而且它还会重新创建布局，因此您可以更改当前布局。

# zend-framework - Zend ACL 动态断言

> ID：11668785
> 
> 赞同：3
> 
> 时间：2012-07-26T11:57:43.070
> 
> 标签：zend-framework, dynamic, acl, assertion

我想限制我的用户仅编辑/删除他们添加的评论。我在 youtube 上找到了一个名为 intergral30 的人的示例，并按照他的指示进行操作。现在我的管理员帐户可以编辑/删除所有内容，但我的用户无权访问他自己的评论。

这是代码：资源

```
class Application_Model_CommentResource implements Zend_Acl_Resource_Interface{
public $ownerId = null;
public $resourceId = 'comment';

public function getResourceId() {
    return $this->resourceId;
}
} 
```

角色

```
class Application_Model_UserRole implements Zend_Acl_Role_Interface{
public $role = 'guest';
public $id = null;

public function __construct(){
    $auth = Zend_Auth::getInstance();
    $identity = $auth->getStorage()->read();

    $this->id = $identity->id;
    $this->role = $identity->role;
}

public function getRoleId(){
    return $this->role;
}
} 
```

断言

```
class Application_Model_CommentAssertion implements Zend_Acl_Assert_Interface
{
public function assert(Zend_Acl $acl, Zend_Acl_Role_Interface $user=null,
            Zend_Acl_Resource_Interface $comment=null, $privilege=null){
    // if role is admin, he can always edit a comment
    if ($user->getRoleId() == 'admin') {
        return true;
    }

    if ($user->id != null && $comment->ownerId == $user->id){
        return true;
    } else {
        return false;
    }
}

} 
```

在我的 ACL 中，我有一个名为 setDynemicPermissions 的函数，它在访问检查插件的 preDispatch 方法中被调用。

```
public function setDynamicPermissions() {
    $this->addResource('comment');
    $this->addResource('post');

    $this->allow('user', 'comment', 'modify', new Application_Model_CommentAssertion());

    $this->allow('admin', 'post', 'modify', new Application_Model_PostAssertion());
}

public function preDispatch(Zend_Controller_Request_Abstract $request) 
{
    $this->_acl->setDynamicPermissions();
} 
```

我正在从我的评论模型中调用 ACL-s isAllowed 方法，在该模型中我返回评论对象列表。

```
public function getComments($id){
    //loading comments from the DB

    $userRole = new Application_Model_UserRole();
    $commentResource = new Application_Model_CommentResource();

    $comments = array();
    foreach ($res as $comment) {
        $commentResource->ownerId = $comment[userId];

        $commentObj = new Application_Model_Comment();
        $commentObj->setId($comment[id]);
        //setting the data
        $commentObj->setLink('');

        if (Zend_Registry::get('acl')->isAllowed($userRole->getRoleId(), $commentResource->getResourceId(), 'modify')) {
            $commentObj->setLink('<a href="editcomment/id/'.$comment[id].'">Edit</a>'.'<a href="deletecomment/id/'.$comment[id].'">Delete</a>');
        }

        $comments[$comment[id]] = $commentObj;
    }
} 
```

谁能告诉我我做错了什么？或者，如果我想让我的管理员有权开始发帖，而其他用户有权对其发表评论，我应该使用什么。每个用户都应该有机会编辑或删除自己的评论，并且管理员应该拥有所有权限。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-29T13:08:04.677

您似乎以错误的方式使用动态断言，因为您仍在传递`roleId`to `isAllowed()`。

这些动态断言的真正作用是获取一个完整的对象并使用它。`getResourceId()`Zend 将通过调用您的`getRoleId()`对象来确定必须使用的规则。

所以你所要做的就是将你的**对象**而不是字符串传递给`isAllowed()`：

```
public function getComments($id){
    //loading comments from the DB

    $userRole = new Application_Model_UserRole();
    $commentResource = new Application_Model_CommentResource();

    $comments = array();
    foreach ($res as $comment) {
        $commentResource->ownerId = $comment[userId];

        $commentObj = new Application_Model_Comment();
        $commentObj->setId($comment[id]);
        //setting the data
        $commentObj->setLink('');

        // This line includes the changes
        if (Zend_Registry::get('acl')->isAllowed($userRole, $commentResource, 'modify')) {
            $commentObj->setLink('<a href="editcomment/id/'.$comment[id].'">Edit</a>'.'<a href="deletecomment/id/'.$comment[id].'">Delete</a>');
        }

        $comments[$comment[id]] = $commentObj;
    }
} 
```

## 但可以做得更好

你不必实现一个全新的`Application_Model_CommentResource`，而是你可以`Application_Model_Comment`像这样使用你的实际：

```
// we are using your normal Comment class here
class Application_Model_Comment implements Zend_Acl_Resource_Interface {
    public $resourceId = 'comment';

    public function getResourceId() {
        return $this->resourceId;
    }

    // all other methods you have implemented
    // I think there is something like this among them
    public function getOwnerId() {
        return $this->ownerId;
    }
} 
```

Assertion 将使用该对象并检索所有者以将其与实际登录的人进行比较：

```
class Application_Model_CommentAssertion implements Zend_Acl_Assert_Interface {
    public function assert(Zend_Acl $acl, Zend_Acl_Role_Interface $user=null,
        Zend_Acl_Resource_Interface $comment=null, $privilege=null){
    // if role is admin, he can always edit a comment
    if ($user->getRoleId() == 'admin') {
        return true;
    }

    // using the method now instead of ->ownerId, but this totally depends
    // on how one can get the owner in Application_Model_Comment
    if ($user->id != null && $comment->getOwnerId() == $user->id){
        return true;
    } else {
        return false;
    }
} 
```

用法是这样的：

```
public function getComments($id) {
    //loading comments from the DB

    $userRole = new Application_Model_UserRole();

    $comments = array();
    foreach ($res as $comment) {
        $commentObj = new Application_Model_Comment();
        $commentObj->setId($comment[id]);
        //setting the data
        $commentObj->setLink('');

        // no $commentResource anymore, just pure $comment
        if (Zend_Registry::get('acl')->isAllowed($userRole, $comment, 'modify')) {
            $commentObj->setLink('<a href="editcomment/id/'.$comment[id].'">Edit</a>'.'<a href="deletecomment/id/'.$comment[id].'">Delete</a>');
        }

        $comments[$comment[id]] = $commentObj;
    }
} 
```

# javascript - 如何修复多个字段上的 jQuery 验证

> ID：11668789
> 
> 赞同：1
> 
> 时间：2012-07-26T11:57:54.810
> 
> 标签：javascript, jquery

我正在尝试使用**phone**的 id 验证输入元素，我已经使用 required 和 minlength 成功验证了输入元素的**邮政编码。**

我附上了名为**number**的第二个输入字段以及所需的规则和数字，但它没有验证表单中的输入是数字。它正在运行所需的检查，但是当我输入一封信时，表格允许这样做，这不是我想要的。

请在此处找到表格 - [http://www.bestclowintown.co.uk/book.php](http://www.bestclownintown.co.uk/book.php)

这是jQuery代码，我的语法可能有误吗？任何帮助表示赞赏：

```
 <script>
      $(document).ready(function() {
          $("#myform").validate({
              rules: {
               postcode: {required: true, minlength: 6},
               number: {required: true, number: true},        
              }
          });
      });
  </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:09:18.353

尝试用以下代码替换您的代码：

```
 $(document).ready(function() {
      $("#myform").validate({
          rules: {
           postcode: {required: true, minlength: 6},
           phone: {required: true, number: true},        
          }
      });
  }); 
```

`key`对于规则对象应该是验证元素的名称、类或属性。有关更多信息，请咨询[docs](http://docs.jquery.com/Plugins/Validation/validate "文档")。

# java - 等效标准或 HQL？

> ID：11668793
> 
> 赞同：1
> 
> 时间：2012-07-26T11:58:15.447
> 
> 标签：java, sql, spring, hibernate

我有以下 SQL 查询。什么是等效的 Criteria 或 HQL 查询？

```
select max(id) from 
(
select max(id) id from TableA
union 
select max(id) from TableB
) 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:46:02.040

没有等价物，因为 HQL 或 Criteria 中没有 UNION。一些解决方法是：

*   使用本机查询
*   构建视图并将其映射为只读目的（如果由于某种原因确实无法使用本机查询）
*   执行两个查询并在 Java 代码中选择要使用的值。

# xcode - 滚动视图将图像堆叠在一起 -xcode

> ID：11668799
> 
> 赞同：0
> 
> 时间：2012-07-26T11:58:31.917
> 
> 标签：xcode, image, scrollview

我有一个带有子视图作为图像的滚动视图。当我将图片中心设置为滚动视图时，它们都作为堆栈显示在彼此的顶部。我需要它们水平滚动。我该如何解决？这是我到目前为止的代码..

```
- (void)viewDidLoad
{

    [super viewDidLoad];

    for (int i = 1; i < 18; i++) {
        UIImageView *images = [[UIImageView alloc] initWithImage:[UIImage imageNamed: [NSString stringWithFormat:@"%d.jpg", i]]];

       images.frame = CGRectMake((i-1)*320, 0, 320, 330);

        [scroller setContentOffset:CGPointMake(0, 0)];
        [scroller addSubview:images];
        [images setContentMode:UIViewContentModeScaleAspectFill];
        [images sizeToFit];

        //center image
        CGSize boundsSize = scroller.bounds.size;
        CGRect frameToCenter = images.frame;

        // center horizontally
        if (frameToCenter.size.width < boundsSize.width) {
            frameToCenter.origin.x = (boundsSize.width - frameToCenter.size.width) / 2;
            NSLog(@"%f", frameToCenter.origin.x);
        }
        else
            frameToCenter.origin.x = 0;

        // center vertically
        if (frameToCenter.size.height < boundsSize.height)
            frameToCenter.origin.y = (boundsSize.height - frameToCenter.size.height) / 2;
        else
            frameToCenter.origin.y = 0;

        images.frame = frameToCenter;

        scroller.pagingEnabled = NO;

    }

    [scroller setContentMode:UIViewContentModeScaleAspectFit];

    scroller.delegate =self;
    scroller.contentSize = CGSizeMake(320*17, 330);
    scroller.backgroundColor = [UIColor blackColor];
    pageControl.numberOfPages =17;
    pageControl.currentPage = 0; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:17:21.443

要水平居中图像，只需使用下面的代码

```
float scrollHeight = 0;    
    for (int col = 0; col < index; ++col)
        {
            CGRect selectFrame = CGRectMake(0,0,kOvrW,kOvrH);
            selectionIndicator = [[UIImageView alloc] initWithFrame:selectFrame];
            selectionIndicator.contentMode = UIViewContentModeBottomRight;
            [selectionIndicator setImage:[UIImage imageNamed:@"checked"]];
            CGRect frame = CGRectMake(5,kOvrPreY+col*(kOvrPreH+kOvrH),kOvrW,kOvrH);
            UIView *fr = [[UIView alloc] initWithFrame:frame];

            CGRect imgFrame = CGRectMake(5, 4, 68, 55);
            UIImageView *imgView = [[UIImageView alloc]initWithFrame:imgFrame];
            imgView.image = [UIImage imageNamed:[[subCategories objectAtIndex:col] valueForKey:@"add"]];

            UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(tapAction:)];
            tapGesture.numberOfTapsRequired = 1;
            tapGesture.numberOfTouchesRequired = 1;
            [fr setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"small-thumb"]]];
            [fr addGestureRecognizer:tapGesture]; 
            [fr addSubview:imgView];
            fr.tag = col;
            [subCatScroll addSubview:fr];

            [subCatScroll bringSubviewToFront:fr];
            scrollHeight += kOvrPreH+kOvrH;
        }
    subCatScroll.contentSize = CGSizeMake(subCatScroll.frame.size.width, scrollHeight+kOvrPreH); 
```

# javascript - 如何让用户改变表单的样式元素？

> ID：11668802
> 
> 赞同：0
> 
> 时间：2012-07-26T11:58:36.640
> 
> 标签：javascript, html, css, forms

我必须构建一个基于 Web 的工具，让用户可以更改表单元素的 CSS 样式。

例如，一个表单包含两个标签、两个文本字段和一个按钮。用户现在应该（以某种方式）能够设置样式，例如`color:red`，`border:1px`或`text-align:right`（或以任何其他方式定义此类内容）。应检查此设置（如果有效或无效）并保存。

在任何情况下，都不应该执行注入攻击或破坏或更改（例如通过删除文本字段）表单。

现在，我只是在寻找一些关于如何处理这个请求的想法，或者是否有一些有用的库（PHP、JS、...）。所以如果有人想和我分享他的想法，我很高兴。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T12:14:56.837

此链接可能会有所帮助[http://wrapbootstrap.com/preview/WB0412697](http://wrapbootstrap.com/preview/WB0412697)

这个页面使用了样式切换器和Bootstrap插件，它可以根据你的选择改变页面的颜色，参考这个'样式切换器'的代码可能是你问题的解决方案。

# android - 搜索按钮 - Android 4.1.1 中的 onSearchRequested()

> ID：11668811
> 
> 赞同：2
> 
> 时间：2012-07-26T11:59:02.650
> 
> 标签：android, search, software-update

在我的活动中，当用户按下搜索按钮时，我实现了特定的行为。这些假设实施

> ```
>  @Override
>     public boolean onSearchRequested(){
>         //..............
>         return true;
>     } 
> ```

问题是，在我将 Nexus S 更新到 Android 4.1.1 后，这不再起作用，而搜索按钮将启动 Google 网络搜索。这令人沮丧！这些可以被覆盖以像以前一样工作吗？

# php - 重定向到另一个页面的 if else 语句

> ID：11668814
> 
> 赞同：3
> 
> 时间：2012-07-26T11:59:10.247
> 
> 标签：php, mysql, sql, if-statement

我对 PHP/SQL 很糟糕，所以任何帮助都将不胜感激。

基本上我有一个表格，将值“名字”和“姓氏”发布到另一个页面。我希望该页面执行的操作是检查用户名是否已在“成员”表中。如果是我希望它继续加载此页面，但如果它们不在数据库中，我希望查看器被重定向到现有的注册页面。

这是我一直在处理的代码，我不确定我是否朝着正确的方向前进。

```
<?php
$con = mysql_connect("localhost","site","xxxxxxxx");
if (!$con)
   {
   die('Could not connect: ' . mysql_error());
   }

mysql_select_db("site", $con);

$query = "SELECT * FROM Members WHERE firstname='$_POST[firstname]' and surname='$_POST[surname]'";  
$result = mysql_query($query);

if ($result==$something)
   {
   echo "great success"; //user continues loading page
   }
else
   {
   echo "fail"; //user is redirected to sign up page
   }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:00:42.963

```
if (mysql_num_rows($result) == 1)
   {
   echo "great success"; //user continues loading page
   }
else
   {
   echo "fail"; //user is redirected to sign up page
   } 
```

此外，您的查询很容易出现 SQL 注入

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T12:13:31.853

这可以解决问题：

```
<?php

$con = mysql_connect( "localhost", "site", "xxxxxxxx" );
if ( !$con ) {
    die('Could not connect: ' . mysql_error());
}

mysql_select_db("site", $con); 
```

1st，至少像这样删除sql注入部分：

```
$firstname = strip_tags( $_POST[ 'firstname' ] );
$surname = strip_tags( $_POST[ 'surname' ] ); 
```

第二，我没有改变它，但你需要删除`*`并只输入你想要加载的特定值。即使这些都是值，仍然手动编写它们。

```
$query = "SELECT * FROM Members WHERE firstname='" . $firstname . "' and surname=' " . $surname. "'";  
$result = mysql_query( $query ); 
```

第三，您可以检查行数，如果您有一些值，则有一个包含这些变量的条目

```
if ( mysql_num_rows($result) >= 1 ) {
    // the page you want
} else {
    // redirect user to another page
    header( "Location: signup.php" ); die;
}

?> 
```

***编辑：***

考虑向您的查询添加一些`unique`请求。如果两个用户具有相同的姓名和姓氏，或者如果一个新用户想要加入，但姓名和姓氏已经在数据库中，会发生什么...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T12:02:30.720

```
$rows = mysql_num_rows($results);

if ($rows == 1)
{
   echo "login successful"; //user continues loading page
}
else
{
   header ('location: signup.php'); //user is redirected to sign up page
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:03:15.907

您可以简单地 `header( "Location: host/site.php" )` 在 else 分支中放置一个函数调用，然后是 die()

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T12:03:24.293

```
if(mysql_num_rows($result) > 0){
    echo "great success"; //user continues loading page
}
else
{
   echo "fail"; //user is redirected to sign up page
} 
```

用这个

# jquery - 电子邮件确认 jquery

> ID：11668815
> 
> 赞同：0
> 
> 时间：2012-07-26T11:59:14.317
> 
> 标签：jquery

我的目标是让用户输入他的电子邮件，然后确认。如果两者不相同，则表单会显示错误。

下面的代码可以找到，除非用户

*   在电子邮件字段中输入：“bla@stack.com”；
*   在确认电子邮件字段中输入：“bla@stack.com”；
*   返回电子邮件字段并将“bla@stack.com”更改为“azerty@stack.com”；
*   不会更改确认电子邮件字段。

没有错误。

jQuery：

```
//Vérifie si l'email et sa répetition son identiques
$('#RepetitionEmail').keyup(function(){

    var RepetitionEmail = $('#RepetitionEmail').val();

    if($("#RepetitionEmail").val()!=$("#Email").val())
    {
        $('#RepetitionEmail').css('border-color','orange');
        $('.ErreurRepetitionEmail').text('Pas encore les mêmes ...');
        checkRepetitionEmail = "Repetition email pas identique";
    }else
    {
        $('#RepetitionEmail').css('border-color','#00ff00');
        $('.ErreurRepetitionEmail').text('... ça y est!');
        checkRepetitionEmail = "Repetition email ok";
    }
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T12:02:06.080

将您的选择器更改为此

```
$('#RepetitionEmail, #Email').keyup(function(){ 
```

它现在将在两个输入上监听 keyUp 事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:16:21.470

这个[答案](https://stackoverflow.com/a/11668861/447356)是正确的，您可以改进代码。首先，当用户仅使用鼠标粘贴文本时，您当前的代码将失败。其次，您有可以优化的冗余代码。

这是实现相同最终结果的更好方法：（假设您使用的是新的 jQuery 版本）

```
$("#MyForm").on("change", "#RepetitionEmail, #Email", function() {
    var tbEmail = $("#Email");
    var tbConfirmEmail = $("#RepetitionEmail");
    var email = tbEmail.val();
    var confirmEmail = tbConfirmEmail.val();
    if (email.length === 0 || confirmEmail.length === 0) {
        //user still did not fill up both.
        return;
    }

    var borderColor = "";
    var errorText = "";
    if(email !== confirmEmail)
    {
        borderColor = "orange";
        errorText = "Pas encore les mêmes ...";
        checkRepetitionEmail = "Repetition email pas identique";
    }else
    {
        borderColor = "#00ff00";
        errorText = "... ça y est!";
        checkRepetitionEmail = "Repetition email ok";
    }

    tbConfirmEmail.css('border-color', borderColor );
    $('.ErreurRepetitionEmail').text(errorText );
}); 
```

[现场测试用例](http://jsfiddle.net/xaH59/)。

处理`change`事件会更好，因为无论文本如何更改，它都会起作用。

如果您有更多的东西要验证或希望它更灵活，请查看众多 jQuery 验证插件。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-26T12:15:26.260

```
$('#RepetitionEmail, #Email').keyup(function(){ // do something } 
```

# android - 通知操作按钮外观

> ID：11668819
> 
> 赞同：5
> 
> 时间：2012-07-26T11:59:20.303
> 
> 标签：android, notifications

如何使通知按钮按预期显示（如下图的第二个通知）？

这是我的代码：

```
Notification.Builder nb = new Notification.Builder(mCtx);
    nb.setTicker("DATART");
    nb.setSmallIcon(R.drawable.ic_menu_info_details_select);
    nb.setContentText("DATART text");
    nb.setContentTitle(mCtx.getString(R.string.app_name));
    nb.setContentIntent(getClickIntent());
    nb.setAutoCancel(true);
    nb.setDefaults(Notification.DEFAULT_VIBRATE | Notification.DEFAULT_SOUND);
    nb.setLights(LED, LEDON, LEDOFF);
    nb.addAction(android.R.drawable.ic_btn_speak_now, "Prihodit", PendingIntent.getActivity(mCtx, 0, new Intent(mCtx, AuctionProductDetail.class), 0));
    nb.addAction(android.R.drawable.ic_dialog_map, "Mapa", PendingIntent.getActivity(mCtx, 0, new Intent(mCtx, AuctionProductDetail.class), 0));
    return nb.build(); 
```

![通知](../Images/7db47fded6f528c179ac58cca621b271.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:08:40.927

看起来我必须将 android:targetSdkVersion 设置为 11 或更高

# mysql - 查询有什么问题？

> ID：11668822
> 
> 赞同：2
> 
> 时间：2012-07-26T11:59:37.093
> 
> 标签：mysql, sql, sql-delete, cascade, cascading-deletes

查询有什么问题？

```
delete from categories c
left join categories_products cp on cp.category_id = c.id
left join products p on p.id = cp.product_id
left join images i on i.object_id = cp.product_id
where c.id = 3 and i.site_section = 'products' 
```

MySQL 返回错误。我正在尝试通过 HeidiSQL 执行此查询。错误未知。

另一个问题，这也对我有帮助：如果我没有索引，如何对行进行级联删除？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:08:58.623

`delete`您应该在关键字后添加别名

```
DELETE c FROM categories c
          LEFT JOIN categories_products cp 
                    on cp.category_id = c.id
          LEFT JOIN products p 
                    on p.id = cp.product_id
          LEFT JOIN images i on i.object_id = cp.product_id
WHERE c.id = 3 and i.site_section = 'products' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:02:01.820

```
delete c from categories c
left join categories_products cp on cp.category_id = c.id
left join products p on p.id = cp.product_id
left join images i on i.object_id = cp.product_id
where c.id = 3 and i.site_section = 'products' 
```

加入时，您必须指定要从哪个表中删除。这就是为什么它是`delete c from ...`

# android - 用作确认码的二维码

> ID：11668824
> 
> 赞同：1
> 
> 时间：2012-07-26T11:59:38.807
> 
> 标签：android, zxing

晚上好，

我正在开发一款移动增强现实游戏，我想在游戏中使用二维码。我想做的是自己创建二维码，用作密码，以便能够进入游戏的下一个阶段。所以从这个意义上说，我需要用户能够从街道上的某个位置扫描二维码，如果二维码是合适的，应用程序将继续进行下一个活动，以继续流程游戏。

我通常检查过 ZXing 库，但无法准确确定我是否可以以这种方式使用 QR 码，所以我决定在这里询问是否有人从事过/做过类似的事情。任何指向示例的指针将不胜感激。

非常感谢您的帮助，约翰。

```
public void onActivityResult(int requestCode, int resultCode, Intent intent) {
        if (requestCode == 0) {
          TextView tvStatus=(TextView)findViewById(R.id.tvStatus);
          TextView tvResult=(TextView)findViewById(R.id.tvResult);

          if (resultCode == RESULT_OK) {
              tvStatus.setText(intent.getStringExtra("SCAN_RESULT_FORMAT"));
              tvResult.setText(intent.getStringExtra("SCAN_RESULT"));

              String a=(intent.getStringExtra("SCAN_RESULT"));

                if (a=="1") {
                    Button next = (Button) findViewById(R.id.proceed);  

                    next.setOnClickListener(new View.OnClickListener() { 

                        public void onClick(View view) {                 
                            Intent myIntent = new Intent(view.getContext(), StoryLine2Part1.class); 
                            startActivityForResult(myIntent, 0);                              
                        }

                    });
                }

          } else if (resultCode == RESULT_CANCELED) {
            tvStatus.setText("Press a button to start a scan.");
            tvResult.setText("Scan cancelled.");
          }
        }

      }
    } 
```

编辑：

我有这个工作（它可以正确扫描和显示。但是我无法让检查工作，因为不知何故我没有解析字符串上的正确值，我稍后会检查以便继续。关于什么可能是错误的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:05:12.620

是的，你可以做到这一点。

开始您的活动以获得结果。

```
 try {
            Intent intent = xzingHelper.getScanQrCodeIntent();
            startActivityForResult(intent, XzingHelper.QR_REQ_CODE);
        } catch (ActivityNotFoundException e) {
            Toast.makeText("You need the ZXing 2D BarCode scanner");
            Intent playIntent = xzingHelper.getZxingGooglePlayIntent();
            startActivity(playIntent);
            finish();
        }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if(requestCode == XzingHelper.QR_REQ_CODE){
            if(resultCode == RESULT_OK){
                String qrCodeValue = xzingHelper.getScanResult(data);
                Log.i("Got ZXing result: "+ qrCodeValue);
                dealWithQrCode(qrCodeValue); // Check if the qr code is for the next level
            } else
            if(resultCode == RESULT_CANCELED) {
                // Cancelled - dont go to next level
                finish();
            }
        }
        super.onActivityResult(requestCode, resultCode, data);
    } 
```

Helper 类，如果他们没有安装 zXing，它会提示他们：

```
public class XzingHelper {

    public static final int QR_REQ_CODE = 123;

    public Intent getScanQrCodeIntent() {
        Intent intent = new Intent("com.google.zxing.client.android.SCAN");
        intent.putExtra("SCAN_MODE", "QR_CODE_MODE");
        intent.putExtra("SAVE_HISTORY", false);
        intent.putExtra("PROMPT_MESSAGE", "Too dark? Menu > Settings > 'use front light'");
        return intent;
    }

    public Intent getZxingGooglePlayIntent() {
        Uri playUri = Uri.parse("market://details?id=com.google.zxing.client.android");
        Intent playIntent = new Intent(Intent.ACTION_VIEW, playUri);
        return playIntent;
    }

    public String getScanResult(Intent data) {
        return data.getStringExtra("SCAN_RESULT");
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:11:51.710

我已经使用过 ZXing Library，但不是在游戏方面。您可以使用它通过 Intents 进行扫描，我认为这很舒服。你可以在[ZXing Wiki](http://code.google.com/p/zxing/wiki/ScanningViaIntent)中找到它的描述。

只需将[意图包](http://code.google.com/p/zxing/source/browse/trunk#trunk%2Fandroid-integration%2Fsrc%2Fcom%2Fgoogle%2Fzxing%2Fintegration%2Fandroid)中的所有类放入您自己的项目中即可。然后，您可以在想要启动相机以供用户扫描条形码时使用以下代码：

```
// yourActivity will be "this" if you start this from your activity
IntentIntegrator integrator = new IntentIntegrator(yourActivity); 
integrator.initiateScan(); 
```

如果您想将应扫描的代码类型限制为 QR 码，您可以将最后一行替换为以下内容：

```
integrator.initiateScan(IntentIntegrator.QR_CODE_TYPES); 
```

要处理结果，请`onActivityResult`在活动中重载方法。这将在扫描仪返回时调用，您可以在那里解锁您的游戏关卡：

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent intent) {
   IntentResult scanResult = IntentIntegrator.parseActivityResult(requestCode, resultCode, intent);
   if (scanResult != null) {
      // a code has been scanned, so handle scan result
   }
} 
```

对于 QR 码生成，我将只使用随机字符串（来自某些单词的哈希标签），您可以在扫描结果中进行检查。

# php - 使用 preg_replace 函数删除字符

> ID：11668826
> 
> 赞同：0
> 
> 时间：2012-07-26T11:59:38.500
> 
> 标签：php, preg-replace

我使用 preg_replace 函数。我希望该函数不删除撇号（**'**）字符。所以我希望它把这个词返回为 (o'clock) 。我怎样才能做到这一点？

```
$last_word = "o'clock.";

$new_word= preg_replace('/[^a-zA-Z0-9 ]/','',$last_word);

echo $new_word; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:09:37.183

尝试：

```
$last_word = "o'clock.";
$new_word= preg_replace('/[^a-zA-Z0-9\' ]/','',$last_word);
echo $new_word; 
```

在这里演示：http: [//ideone.com/JMH8F](http://ideone.com/JMH8F)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:09:38.170

该正则表达式明确删除了*除*字母和数字之外的所有字符。注意前导“^”。所以它会按照你的要求去做。

因此，您很可能希望将“'”（撇号）添加到正则表达式内的排除集：

```
'/[^a-zA-Z0-9\' ]/' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:09:49.667

将您的原件更改`'/[^a-zA-Z0-9 ]/'`为`"/[^a-zA-Z0-9 ']/"`. 这只是在否定字符类中包含撇号。

请参阅[在线示例](http://so.viperpad.com/GQkjyn)。

^(另外：我的建议是对字符串使用双引号（就像您使用的那样`"o'clock."`），因为将反斜杠转义与 PHP 字符串和正则表达式模式混合会很快让人感到困惑。)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:13:49.600

试试这个。它可能会有所帮助..

```
$new_word= preg_replace('/\'/', '', $last_word); 
```

演示：[http ://so.viperpad.com/F82z9o](http://so.viperpad.com/F82z9o)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-26T12:04:13.850

您使用的正则表达式不会删除“'”（撇号）。相反，由于“。”，它根本不匹配主题字符串。（点）。在这种情况下 preg_replace() 返回 NULL。

# ruby-on-rails - Rails : SQLite3::SQLException 与 has_and_belongs_to_many 关联

> ID：11668828
> 
> 赞同：0
> 
> 时间：2012-07-26T11:59:49.873
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, sqlite

我的应用程序遇到了一个新问题。

我尝试建立这样的多对多关系：http: [//guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association](http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association) 在这里我使用 has_and_belongs_to_many 来“连接”两个表：用户和引脚

但是当我尝试计算用户的引脚数时出现此错误。

```
Showing /app/views/shared/_users_pins.html.erb where line #4 raised:

SQLite3::SQLException: no such column: pins_users.user_id: SELECT COUNT(*) FROM "pins" INNER JOIN "pins_users" ON "pins"."id" = "pins_users"."pins_id" WHERE "pins_users"."user_id" = 102

line 4 :  <%= @user.pinss.count %> 
```

（我需要使用别针而不是别针，因为否则轨道会搜索类别针而不是别针，但它太脏了：'（）

这是我的模型：

```
class Pins < ActiveRecord::Base
  attr_accessible :describe, :title, :url_img
  has_and_belongs_to_many :users
end

class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation, :team_id
 has_and_belongs_to_many :pinss
end 
```

谢谢 ！=)

最好的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:24:19.530

如果你使用 habtm，你需要手动创建一个连接表，在你的情况下，pins_users 正好有两列，pins_id 和 user_id。

见[http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association](http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association)

因为您的错误表明 pins_users 中缺少 user_id（没有这样的列：pins_users.user_id）

ps：pins 中的双 s 确实很奇怪，我不确定它是否以某种方式增加了问题 - 那么连接表不应该命名为 pinss_users 吗？您确定将其固定为正确的名称吗？如果不是 pin 的复数，那么 pin 是什么？如果您绝对必须这样做，您可以为此添加自定义复数。

# c# - 如何使用 C# 拆分大文本文件（32 GB）

> ID：11668829
> 
> 赞同：12
> 
> 时间：2012-07-26T11:59:53.040
> 
> 标签：c#

我尝试使用以下代码拆分大约 32GB 的文件，但我得到了`memory exception`.

请建议我使用`C#`.

```
string[] splitFile = File.ReadAllLines(@"E:\\JKS\\ImportGenius\\0.txt");

int cycle = 1;
int splitSize = Convert.ToInt32(txtNoOfLines.Text);
var chunk = splitFile.Take(splitSize);
var rem = splitFile.Skip(splitSize);

while (chunk.Take(1).Count() > 0)
{
    string filename = "file" + cycle.ToString() + ".txt";
    using (StreamWriter sw = new StreamWriter(filename))
    {
        foreach (string line in chunk)
        {
    sw.WriteLine(line);
        }
    }
    chunk = rem.Take(splitSize);
    rem = rem.Skip(splitSize);
    cycle++;
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-26T12:06:13.390

好吧，首先您需要使用`File.ReadLines`（假设您使用的是.NET 4），这样它就不会尝试将整个内容读入内存。然后我会继续调用一个方法来将“下一个”吐出很多行到一个新文件：

```
int splitSize = Convert.ToInt32(txtNoOfLines.Text);
using (var lineIterator = File.ReadLines(...).GetEnumerator())
{
    bool stillGoing = true;
    for (int chunk = 0; stillGoing; chunk++)
    {
        stillGoing = WriteChunk(lineIterator, splitSize, chunk);
    }
}

...

private static bool WriteChunk(IEnumerator<string> lineIterator,
                               int splitSize, int chunk)
{
    using (var writer = File.CreateText("file " + chunk + ".txt"))
    {
        for (int i = 0; i < splitSize; i++)
        {
            if (!lineIterator.MoveNext())
            {
                return false;
            }
            writer.WriteLine(lineIterator.Current);
        }
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-26T12:03:13.013

不要*立即*将所有行读入数组，而是使用[StremReader.ReadLine](http://msdn.microsoft.com/en-us/library/system.io.streamreader.readline.aspx)方法，例如：

```
using (StreamReader sr = new StreamReader(@"E:\\JKS\\ImportGenius\\0.txt")) 
{
    while (sr.Peek() >= 0) 
    {
       var fileLine = sr.ReadLine();
       //do something with line
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-26T12:05:11.180

> ```
> File.ReadAllLines 
> ```

这会将*整个文件读入内存*。

要处理大文件，您只需将现在需要的内容读入内存，然后在完成后立即将其丢弃。

更好的选择是[`File.ReadLines`](http://msdn.microsoft.com/en-us/library/system.io.file.readlines.aspx)返回一个惰性枚举器，数据仅在您从枚举器获取下一行时才读入内存。如果您避免多次枚举（例如，不要使用`Count()`），则只会读取文件的一部分。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-26T12:03:51.330

`File.ReadAllLines`不要使用一次读取所有文件，而是`File.ReadLines`在 foreach 循环中根据需要读取行。

```
foreach (var line in File.ReadLines(@"E:\\JKS\\ImportGenius\\0.txt"))
{
    // Do something
} 
```

**编辑：**在不相关的注释中，在字符串前面加上“@”前缀时，您不必转义反斜杠。所以要么写`"E:\\JKS\\ImportGenius\\0.txt"`or `@"E:\JKS\ImportGenius\0.txt"`, but`@"E:\\JKS\\ImportGenius\\0.txt"`是多余的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T12:02:52.330

这里的问题是您正在将整个文件的内容一次读入内存`File.ReadAllLines()`。您需要做的是打开一个 FileStream`File.OpenRead()`并读取/写入较小的块。

编辑：实际上对于您的情况 ReadLine 显然更好。查看其他答案。:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-26T12:03:06.120

使用[StreamReader](http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx)读取文件，使用 StreamWriter 写入。

# java - 如何在java中显示50位或更多位（例如乘法）？

> ID：11668830
> 
> 赞同：2
> 
> 时间：2012-07-26T11:59:57.850
> 
> 标签：java, calculator, digits

我有一个项目要求我用 java 设计一个计算器，我应该让用户选择显示 50 位或 100 位。

当我进行乘法运算或任何其他大数字运算时，您知道的问题不会显示所有数字，它将显示大约 20 位数字，左边将显示为 E（某个数字）！

我尝试使用`BigDecimal`，`DecimalFormat`但无法解决。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-26T12:01:20.707

查看[`BigDecimal`](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html)课程（[`BigInteger`](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)如果您对小数位不感兴趣，请查看课程。）。它应该打印任意数量的数字就好了。（无需使用`DecimalFormat`顺便说一句。）

```
BigDecimal x = new BigDecimal("123456789123456789123456789");
BigDecimal y = new BigDecimal("987654321987654321987654321");

BigDecimal z = x.multiply(y);

System.out.println(z); 
```

**输出：**

```
121932631356500531591068431581771069347203169112635269 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:05:54.270

使用 BigDecimal

```
System.out.println(new BigDecimal(1.1).multiply(new BigDecimal(1.8))); 
```

打印 104 位数字

```
1.9800000000000002087219286295294335439472797061332458086428264139311483660321755451150238513946533203125 
```

* * *

使用 valueOf 转换`double`你可能期望的

```
System.out.println(BigDecimal.valueOf(1.1).multiply(BigDecimal.valueOf(1.8))); 
```

印刷

```
1.98 
```

# c# - 鼠标滚轮事件对标签页上的组合框不起作用？

> ID：11668835
> 
> 赞同：2
> 
> 时间：2012-07-26T12:00:21.227
> 
> 标签：c#, componentone

我有功能区选项卡，每个选项卡中都有按钮、文本框、组合框。我的问题是，我希望能够使用鼠标滚轮（对于组合框）向下和向上滚动，但是，我的鼠标滚轮会更改选项卡。它不会影响其中的组合框。有没有办法来解决这个问题？这真的很烦人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:40:53.843

太长的评论，所以我会在这里发布。

尝试创建您自己的继承自该 Ribbon 控件的类。我没有 ComponentOne 库，所以对于这个例子，我只是调用控件“Ribbon”：

```
public class MyRibbon : Ribbon {

  public bool DisableMouseWheel { get; set; }

  protected override void OnMouseWheel(MouseEventArgs e) {
    if (!this.DisableMouseWheel) {
      base.OnMouseWheel(e);
    }
  }
} 
```

重建您的解决方案。单击解决方案资源管理器中的“显示所有文件”按钮，然后打开表单的设计器文件。文件中应该有两行引用您的 Ribbon 类型，将类型替换为新的 MyRibbon 类。

现在订阅您更改`DisableMouseWheel`属性的组合框的 Enter 和 Leave 事件。

在尝试之前备份您的工作。

# php - 使用 copy() 将 timthumb 输出保存到服务器

> ID：11668841
> 
> 赞同：0
> 
> 时间：2012-07-26T12:00:46.417
> 
> 标签：php, copy, save

目前我正在将文件上传到服务器。上传文件后，我将 timthumb 调整大小并复制到另一个位置。

```
copy(timthumb_image_address, new_server_address); 
```

到目前为止，这一直运作良好。Timthumb 工作正常，但我无法将其正确复制到服务器。我现在制作无效文件。

保存文件的文件夹是可写的。我真的可以进去下载它。但我无法在下载时或在浏览器中查看图像本身

没有错误信息

这是我一直在使用的一些虚拟地址

复制（）第 1 部分：

```
http://mywebsite.com/timthumb.php?src=/home/usernamehere/public_html/images/uploads/imagetocopy.jpg&w=32&h=32 
```

复制（）第 2 部分：

```
/home/usernamehe/public_html/images/uploads/imagetocopy_v2.jpg 
```

它制作了一个大小为 533 字节的文件。无论如何，这始终是我在 filezilla 中看到的大小。

我知道它是无效图像的唯一方法是因为没有任何东西可以打开它。picassa 说它的图片无效。顺便说一句，尽管有一个 .jpg 扩展名。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:17:35.683

好的，我想我解决了。我认为这是因为我设置了 apache 密码保护。文件本身有 401 错误消息

```
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>401 Authorization Required</title>
</head><body>
<h1>Authorization Required</h1>
<p>This server could not verify that you
are authorized to access the document
requested.  Either you supplied the wrong
credentials (e.g., bad password), or your
browser doesn't understand how to supply
the credentials required.</p>
<p>Additionally, a 401 Authorization Required
error was encountered while trying to use an ErrorDocument to handle the request.</p>
</body></html> 
```

# android - android eclipse INSTALL_PARSE_FAILED_CERTIFICATE_ENCODING

> ID：11668842
> 
> 赞同：0
> 
> 时间：2012-07-26T12:00:52.000
> 
> 标签：android, eclipse, adb, adt

不知道这是怎么发生的，我正在构建一个项目，然后下次我构建它时，在 2 分钟内，突然这开始在 eclipse 中发生：

```
[2012-07-26 12:48:02 - project] Installation error: INSTALL_PARSE_FAILED_CERTIFICATE_ENCODING
[2012-07-26 12:48:02 - project] Please check logcat output for more details.
[2012-07-26 12:48:02 - project] Launch canceled! 
```

亚行输出为：

```
07-26 12:48:01.656: W/ActivityManager(346): No content provider found for permission revoke: file:///data/local/tmp/xxxx.apk
07-26 12:48:01.726: W/ActivityManager(346): No content provider found for permission revoke: file:///data/local/tmp/xxxx.apk
07-26 12:48:01.781: D/dalvikvm(346): WAIT_FOR_CONCURRENT_GC blocked 0ms
07-26 12:48:01.781: W/PackageParser(346): Exception reading /data/app/vmdl-883532656.tmp
07-26 12:48:01.781: W/PackageParser(346): java.io.IOException: global_list_ch
07-26 12:48:01.781: W/PackageParser(346):  ild_row_bck.png.png
07-26 12:48:01.781: W/PackageParser(346): SHA1-Digest
07-26 12:48:01.781: W/PackageParser(346):   at java.util.jar.InitManifest.readName(InitManifest.java:130)
07-26 12:48:01.781: W/PackageParser(346):   at java.util.jar.InitManifest.readHeader(InitManifest.java:104)
07-26 12:48:01.781: W/PackageParser(346):   at java.util.jar.InitManifest.initEntries(InitManifest.java:69)
07-26 12:48:01.781: W/PackageParser(346):   at java.util.jar.Manifest.read(Manifest.java:221)
07-26 12:48:01.781: W/PackageParser(346):   at java.util.jar.Manifest.<init>(Manifest.java:120)
07-26 12:48:01.781: W/PackageParser(346):   at java.util.jar.JarFile.getManifest(JarFile.java:296)
07-26 12:48:01.781: W/PackageParser(346):   at android.content.pm.PackageParser.collectCertificates(PackageParser.java:608)
07-26 12:48:01.781: W/PackageParser(346):   at com.android.server.pm.PackageManagerService.installPackageLI(PackageManagerService.java:7249)
07-26 12:48:01.781: W/PackageParser(346):   at com.android.server.pm.PackageManagerService.access$1600(PackageManagerService.java:159)
07-26 12:48:01.781: W/PackageParser(346):   at com.android.server.pm.PackageManagerService$5.run(PackageManagerService.java:5546)
07-26 12:48:01.781: W/PackageParser(346):   at android.os.Handler.handleCallback(Handler.java:615)
07-26 12:48:01.781: W/PackageParser(346):   at android.os.Handler.dispatchMessage(Handler.java:92)
07-26 12:48:01.781: W/PackageParser(346):   at android.os.Looper.loop(Looper.java:137)
07-26 12:48:01.781: W/PackageParser(346):   at android.os.HandlerThread.run(HandlerThread.java:60) 
```

我已经尝试了明显的，重启设备，`adb uninstall com.project.xxxx`重启adb，重启eclipse，`android update project -p ./`

真正的问题是这个项目只是坏了，我可以建造任何其他的，去看看！

干杯，克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T13:30:54.663

OK 休息一下，再看一遍，终于发现了问题：

```
07-26 12:48:01.781: W/PackageParser(346): java.io.IOException: global_list_ch
07-26 12:48:01.781: W/PackageParser(346):  ild_row_bck.png.png 
```

我看到了这个然后查看了我的资源，我设法在我的一个文件上输入了一个新行。看起来像：

```
ic_something.png
ic_something_else.png 
```

作为文件名，奇怪的是它编译得很好，所以我从来没想过要看资源。

希望这可能对将来的某人有所帮助。

我为此提出了一个错误，它是 Eclipse 特定的：[Eclipse Bug: 386045](https://bugs.eclipse.org/bugs/show_bug.cgi?id=386045)

干杯，克里斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:14:43.370

从评论转换而来。

我知道你说你重新启动了 adb，但是你是否也清除了缓存？其他人在[这里](https://stackoverflow.com/questions/9532653/android-4-0-3-emulator-install-fails-with-permission-revoke)遇到了同样的错误，显然通过缓存重置修复了它。具体来说，他们在终端中输入了以下内容：

```
adb root
adb remount
adb shell rm -r /data/dalvik-cache/* 
```

# iphone - 如何在应用商店发布应用更新？

> ID：11668843
> 
> 赞同：8
> 
> 时间：2012-07-26T12:00:51.773
> 
> 标签：iphone, ios, app-store, publish

我必须为我的发布应用程序发布第一个更新。我想把它做好，但不知道怎么做:(有什么帮助吗？

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-26T12:05:38.880

就像最初创建应用程序时所做的一样。唯一的区别是，一旦您在 Xcode 中创建了新版本（在 plist 中具有更高版本号字符串）并且您在 iTunes Connect 中，而不是单击“管理您的应用程序”选项卡中的“添加新应用程序”，您将进入您正在更新的应用程序并单击“添加版本”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T12:03:31.703

您登录到 iTunes Connect 并创建应用程序的新版本。

它会询问您在更新中所做的更改。

然后您上传二进制文件并等待审核。

就那么简单...

# java - 如何编写实现 Comparable 的方法签名“T” “在Java中？

> ID：11668850
> 
> 赞同：1
> 
> 时间：2012-07-26T12:01:24.060
> 
> 标签：java, generics, comparable

我的`insert`-method 上应该有什么签名？我正在为仿制药而苦苦挣扎。在某种程度上，我想要两者`Comparable<T>`，`T`并且我已经尝试过`<Comparable<T> extends T>`.

```
public class Node<T> {

    private Comparable<T> value;

    public Node(Comparable<T> val) {
        this.value = val;
    }

    // WRONG signature - compareTo need an argument of type T
    public void insert(Comparable<T> val) {
        if(value.compareTo(val) > 0) {
            new Node<T>(val);
        }
    }

    public static void main(String[] args) {
        Integer i4 = new Integer(4);
        Integer i7 = new Integer(7);

        Node<Integer> n4 = new Node<>(i4);
        n4.insert(i7);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T12:06:36.323

不确定您要达到什么目标，但您不应该将其包含在类的声明中吗？

```
public static class Node<T extends Comparable<T>> { //HERE

    private T value;

    public Node(T val) {
        this.value = val;
    }

    public void insert(T val) {
        if (value.compareTo(val) > 0) {
            new Node<T>(val);
        }
    }
} 
```

注意：最好使用`<T extends Comparable<? super T>>`代替`<T extends Comparable<T>>`

# iphone - 我可以指定带有双后缀的文档类型吗？

> ID：11668854
> 
> 赞同：1
> 
> 时间：2012-07-26T12:01:46.320
> 
> 标签：iphone, cocoa-touch

我们的应用程序有一个使用后缀的文档类型`.sgb`。它是一种包类型，因此在很多情况下，用户会将它们压缩并`.sgb.zip`以`.sgbz`. 我已将`.zip`文件作为文档类型添加到我们的应用程序中，它正在打开`.sgb.zip`文件；但操作系统正在向用户提供我的应用程序以打开所有`.zip`文件。我尝试指定`sgb.zip`为新的文档类型，但它只是被忽略了。我可以以某种方式指定带有后缀的文档类型`.sgb.zip`，还是必须打开所有`.zip`s 并查看它们是否有`.sgb`文件？

# java - 可以将 Maven 清洁阶段添加到默认生命周期吗？

> ID：11668865
> 
> 赞同：3
> 
> 时间：2012-07-26T12:02:15.173
> 
> 标签：java, maven

我使用 maven 已经有一段时间了，我非常喜欢它。但我认为有一些小问题必须解决。

有这个干净的阶段，我需要不时使用它，因为打包文件中可能有一些旧的类，这会给应用程序服务器带来混乱的错误。

我知道当我执行包阶段时，它会运行它之前的所有其他阶段但不干净。因为清洁处于清洁生命周期中。

那么有什么方法可以将 clean 添加到默认生命周期？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:05:56.063

也许这可以工作

```
 <plugin>
    <artifactId>maven-clean-plugin</artifactId>
    <version>2.5</version>
    <executions>
      <execution>
        <id>auto-clean1</id>
        <phase>initialize</phase>
        <goals>
          <goal>clean</goal>
        </goals>
      </execution>
      <execution>
        <id>auto-clean2</id>
        <phase>package</phase>
        <goals>
          <goal>clean</goal>
        </goals>
      </execution>
    </executions>
  </plugin> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T12:51:33.730

我不会为了清理旧的编译类而将 clean 添加到默认生命周期 - 它会打破 maven 用户的约定。`mvn install`键入或`mvn clean install`在需要时比试图弄清楚为什么它总是从头开始重新编译并试图跳过自动清理要容易得多。

# c# - 使 RadioButtonList 中选定的 RadioButton 不可点击但未禁用

> ID：11668866
> 
> 赞同：1
> 
> 时间：2012-07-26T12:02:15.753
> 
> 标签：c#, javascript, jquery, asp.net

我有一个 ASP.Net 页面，上面有几个 RadioButtonList 控件。

我想以只读格式显示此页面，但我希望每个 RadioButtonList 中选定的单选按钮显示为“正常”，即看起来不禁用但不允许单选按钮可点击，因为我不希望该值是可修改的.

我确信这已经在某个地方得到了回答，但我的谷歌搜索目前让我失望了......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:08:23.973

如何将 div 覆盖在单选按钮容器 div 的顶部，最大 z-index 和 alpha 设置为 max 以使其看起来透明。这使得单选按钮无法点击

试试这个[http://jsfiddle.net/chintupawan/ztT5j/](http://jsfiddle.net/chintupawan/ztT5j/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:13:13.807

要阻止按钮也无法点击，您可以使用 div 覆盖它们。

[http://jsfiddle.net/heXQf/](http://jsfiddle.net/heXQf/)

```
<form>
    <div class="row">
        <div class="block"></div>           
<input type="radio" name="sex" value="male" id="rdo"/> Male<br />
<input type="radio" name="sex" value="female" id="rdo"/> Female
     </div>
</form> 

form{width:300px;position:relative;}
.block{width:100px;display:block;height:100px;position:absolute;top:0;}

    $('#rdo').click(function(e) {
    e.preventDefault();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:04:39.430

试试这个 jQuery：

```
$('.class-of-radio-button').click(function(e) {
    e.preventDefault();
}); 
```

小提琴：http: [//jsfiddle.net/c_kick/Gkp2Z/](http://jsfiddle.net/c_kick/Gkp2Z/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:19:19.100

试试这个

```
$("input[type!='radio'], select, textarea ").attr('disabled',true);
$("input[type='radio']").click(function(e){
     e.preventDefault();
}); 
```

# jquery - tumblr 中基于多个标签的精选帖子

> ID：11668871
> 
> 赞同：0
> 
> 时间：2012-07-26T12:02:26.527
> 
> 标签：jquery, tags, tumblr

我正在尝试根据标签显示特定的 tumblr 帖子。

苦苦挣扎：1.如何查询tumblr的多个标签？-- （这里有一个类似的帖子：[如何在 Tumblr 的 read api 中查询多个标签？](https://stackoverflow.com/questions/6043119/how-to-query-multiple-tags-in-tumblrs-read-api)） -- 但是我如何使它适应我的脚本呢？2\. 根据标签为呈现的帖子分配一个类。例如，如果帖子被标记为“featured_1”，它应该在呈现的 html 中显示“featured_1”类。

提前谢谢了！任何帮助表示赞赏。

这是我正在使用的脚本：

```
/*
--------------------------------------
    Created by james <at> bandit.co.nz
    http://blog.bandit.co.nz
*/
Featured = {
    'apiNum' : 100, // how many posts to read
    'listId' : 'featured', // the id of the ul to write to
    'tagName' : 'featured', // the name of the tag we're searching for
    'tagName2': 'featured_1',
    'tagName3': 'featured_2',
    'tagName4': 'featured_3',

    'postDB' : [],
    'listPos' : 0,
    'doList' : function (where) {
        var li; var ul = $('#'+where);
        var titles = {"link":"link-text", "photo":"photo-caption", "quote":"quote-text", "regular":"regular-body", "video":"video-caption"}

        // cycle through post database
        pcount = Featured.postDB.length;
        for(i=Featured.listPos;i<pcount;i++) {
            p = Featured.postDB[i];
            if(p[titles[p.type]] != '') titlestr = p[titles[p.type]].replace(/<\/?[^>]+>/gi, '');
            else titlestr = p['url'];

            li = document.createElement('li');
            $(li).html('<p class=" ">'+titlestr+'</p>');
            ul.append(li);

            Featured.listPos = pcount;
        }
    },

    'getData' : function() {
        $.get('/api/read/json?num='+Featured.apiNum+'&tagged='+Featured.tagName3+Featured.tagName+Featured.tagName2,
            function(data) {
                eval(data);
                for(i=0;i<tumblr_api_read.posts.length;i++) {
                    Featured.postDB.push(tumblr_api_read.posts[i]);
                    Featured.doList(Featured.listId);
                }

            }
        );
    }
};

$(document).ready(function(){
    Featured.getData();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:42:06.667

好吧，无论是在您的代码中，还是在您提供的 SO 帖子中，一切都已经存在。由于似乎没有办法获得多个标签（虽然我不是 Tumbl 用户），所以您仍然需要自己查询每个标签。（未经测试的代码，您可能会在`{`某处修复缺失或拼写错误）。

修改你的`getData`功能。现在它只读取一个标签并返回一个 jqXHR whislt 将结果推送到您的数组。

```
 'getData' : function(tag) {
       return $.get('/api/read/json?num=' + Featured.apiNum + '&tagged=' + tag,
       function(data) {
          //do NOT use eval or a kitten will die somewhere
          Featured.postDB.push(data.posts); //change according to the result
       });
    } 
```

添加一个新功能（从您提供的帖子中从 Gary Green 复制）。这将使用您想要的每个标签调用您之前的函数。当所有这些都完成后（注意 when-then 函数），你可以做任何你需要做的事情。

```
'myFunction' : function() {
    $.when(Featured.getData(Featured.tagName1), Featured.getData(Featured.tagName2) /*, and so on */)
      .then(function() {
         var posts = $.extend({}, arguments); //you might not need this
         Featured.doList(Featured.listId);
      });
 } 
```

# android - 在 Android 上使用 webkit 溢出触摸滚动跳转到顶部

> ID：11668873
> 
> 赞同：2
> 
> 时间：2012-07-26T12:02:33.437
> 
> 标签：android, cordova, scroll

我正在使用 phonegap 和 html 为 ios 和 android 制作应用程序。在我的布局中，我有一个带有溢出内容列表的 div。为了能够滚动它，我使用 -webkit-overflowscroll:touch; 以及不支持此功能的设备的 overthrow js polyfill。

这在ios上工作得很好。

但是在Android上，我有一个错误。在支持“-webkit-overflowscroll:touch;”功能的 Android 4.1 上进行测试时，滚动第一次运行良好，但如果我在滚动后单击某个项目，滚动向上跳，我可以滚动列表超过列表大小（所以我可以向下滚动它以使项目从屏幕上消失）就像滚动已经是双倍大小......

这是基本标记

```
<div class='page'>
   <div class="contain">
       <ul><li><a></a></li></ul>
   </div>
</div> 
```

我的列表由我应用到 .contain css “overflow-y:auto;-webkit-overflow:touch;”的 ajax 加载动态填充

我只滚动 .contain div 而不是正文（具有溢出隐藏属性）

有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T22:51:58.787

我遇到了同样的问题，在我的情况下，我更改了列表项的类以显示向下状态。当我删除执行此操作的代码时，列表选择工作正常。

# wix - 在产品条件之前执行自定义操作

> ID：11668875
> 
> 赞同：3
> 
> 时间：2012-07-26T12:02:50.073
> 
> 标签：wix, windows-installer

基本上我需要在安装之前验证某个程序没有运行。这是通过设置属性的自定义操作完成的`APPRUNNING`：

```
<CustomAction Id="CheckingAppIsRunning"
          BinaryKey="AppIsRunning"
          DllEntry="AppIsRunning"/>

<Binary Id="AppIsRunning" 
        SourceFile="CustomActions.CA.dll" /> 
```

但是在显示的消息中，`APPRUNNING`似乎为空，即根本没有设置（应该是“0”或“1”）。

```
<Condition Message="Exit all instances of [APPNAME] before installation (APPRUNNING = [APPRUNNING]).">
    <![CDATA[APPRUNNING = "0"]]>
</Condition>

<InstallExecuteSequence>
    <Custom Action="CheckingAppIsRunning" Before="LaunchConditions" />
</InstallExecuteSequence> 
```

我想在条件检查时没有执行自定义操作。自定义操作后执行条件检查的选项有哪些？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-26T13:00:44.133

LaunchConditions操作计划在[和](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369751.aspx)`InstallUISequence`中运行`InstallExecuteSequence`。只要您将自定义操作安排为`InstallExecuteSequence`only，该属性就不会在 LaunchConditions 被触发时设置`InstallUISequence`。

您应该`CheckingAppIsRunning`在两个序列中安排您的自定义操作。您可能还想用`Execute='firstSequence'`属性定义它 - 这样它将运行它遇到的第一个序列。

这就是我的意思，实际上：

```
<InstallUISequence>
  <Custom Action="CheckingAppIsRunning" Before="LaunchConditions" />
</InstallUISequence>
<InstallExecuteSequence>
  <Custom Action="CheckingAppIsRunning" Before="LaunchConditions" />
</InstallExecuteSequence> 
```

以及定义：

```
<CustomAction Id="CheckingAppIsRunning" BinaryKey="AppIsRunning" DllEntry="AppIsRunning" Execute="firstSequence"/> 
```

# jakarta-ee - 在 JAAS 登录模块中获取 HttpSession/Request

> ID：11668878
> 
> 赞同：4
> 
> 时间：2012-07-26T12:02:54.120
> 
> 标签：jakarta-ee, jaas, jacc

我正在尝试在我的登录模块中获取 HttpSession 或 Request。我已经尝试过 JACC，但它没有用。

我需要这个，因为我必须在登录窗口中输入验证码。也许一些 JAAS 忍者知道更好的方法来做到这一点。我正在使用[kaptcha](http://code.google.com/p/kaptcha/)来做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-01T14:47:43.090

我在 JBoss AS 上运行的应用程序中正是这样做的。

这是我从登录模块中访问 HttpServletRequest 的操作：

```
HttpServletRequest request = (HttpServletRequest) PolicyContext.getContext(HttpServletRequest.class.getName()); 
```

然后我得到会话，提取验证码并根据屏幕上的请求参数对其进行验证。在对用户进行身份验证后，我从会话中删除了验证码参数。这对我来说很好。

请注意，在用户已经通过身份验证后，也可以通过 EJB 调用激活登录模块。在这种情况下，验证码参数当然不会出现在会话中。所以你应该检查一下。

# c# - 在 filesystemwatcher 中，错误事件可能引发的预期错误是什么？

> ID：11668886
> 
> 赞同：3
> 
> 时间：2012-07-26T12:03:12.780
> 
> 标签：c#, filesystemwatcher

我查看了 MSDN 和反射器，但通常无法弄清楚 - 我从描述标签中获取所有这些信息，但在这种情况下 - 没有这样的运气。

我已经通过实验弄清楚了：

> *   “访问被拒绝” [Win32Exception，本机错误代码 = 5] 如果正在删除监视的目录
> *   如果缓冲区溢出，则“一次更改太多”[InternalBufferOverflowException]。

还有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T14:07:52.877

当您无权访问文件夹或特定文件时，也可能出现**UnauthorizedAccessException 。**

此外，不要过度依赖基本的**FileSystemWatcher**，即使没有**InternalBufferOverflowException**，它也可以跳过一些事件并且对网络目录的工作非常非常糟糕。您应该将**FileSystemWatcher**与一些轮询式系统结合使用，例如，每**30**秒运行一次目录扫描目标目录，并将当前基于**FileSystemWatcher**的文件列表与实际情况进行比较，这样您将实时获得大部分实际信息和所有信息定期。

# iphone - 创建一个可以通过 USB 数据线发送/接收数据的 iPad 应用程序？

> ID：11668887
> 
> 赞同：3
> 
> 时间：2012-07-26T12:03:14.643
> 
> 标签：iphone, objective-c, ios, ipad

我想创建一个 iPad 应用程序，该应用程序通过 USB 连接到另一台机器、笔记本电脑或其他设备，并与我在那里开发的其他一些应用程序进行通信。

我知道这很容易通过蓝牙或 WiFi 实现，但是这组特定的解决方案必须通过 USB 电缆完成。

是否可以在不访问 Apple MFi 程序的情况下这样做？（我大约 5 周了，反应看起来不太好）。

iOS App --> USB Cable --> Mac OSX --> Desktop App（没有 MFi 访问权限）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:09:08.577

要使用 USB 通信，Apple 没有在 IOS SDK 中提供任何 API。目前唯一的选择是 MFI。我认为苹果在不久的将来不会允许这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:13:37.747

要使用串行通信，您可能已经发现需要 MFI。然而，有一个穷人的方法来实现这一点。我在开发过程中这样做了。

在您的设备上启用“互联网共享”并连接到它。在 Mac 上使用“ifconfig”来找出要使用的界面。您不需要将其用作默认连接，但它需要处于活动状态。如果我没记错的话，只有一端可以发起连接（时间有点长，抱歉我不记得细节了）。

*编辑：*我还想指出，我是在 iPhone 上做的，而不是 iPad。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-11T20:37:47.743

不是通过 USB 而是通过 RS232（串行端口）

看这里：[http ://www.redpark.com/c2db9.html](http://www.redpark.com/c2db9.html)

但：

1.  电缆使用旧的 30 针连接器，但根据他们的说法，它与 Lightning 适配器兼容
2.  AppStore 不接受该应用程序，仅供内部使用。
3.  有一本（小）书解释了如何使用这条电缆将 iPhone 直接连接到 Arduino，它已于 2011 年底出版。“iOS Sensor Apps with Arduino Wiring the iPhone and iPad into Internet of Things” [http:// /shop.oreilly.com/product/0636920021179.do](http://shop.oreilly.com/product/0636920021179.do)

# extjs4.1 - ExtJS RowExpander - nextBd 为空

> ID：11668892
> 
> 赞同：0
> 
> 时间：2012-07-26T12:03:27.117
> 
> 标签：extjs4.1, extjs-mvc

我在为我的网格配置 RowExpander 时遇到问题。当网格渲染时，扩展器已经为每一行打开并且里面没有任何东西。当我单击它的图标时，会生成以下错误：nextBd 为空​​。我在这里发现了非常相似的问题[http://www.sencha.com/forum/showthread.php?185837-Grid-Panel-PlugIn-Rowexpander-nextBd-is-null](http://www.sencha.com/forum/showthread.php?185837-Grid-Panel-PlugIn-Rowexpander-nextBd-is-null)但该解决方案对我不起作用并且仍然不明白为什么插件配置不能在 initComponent 方法中传递：

这是我的网格代码：

```
 Ext.define('GSIP.view.plans.PlanReqList' ,{
        extend: 'Ext.grid.Panel',
        alias : 'widget.gsip_devplan_list',
        id: 'gsip_plan_list',
        plugins: [{
            ptype: 'rowexpander',
            rowBodyTpl : [
                'Nazwa:{name}'
            ]
        }],
        //title:i18n.getMsg('gsip.view.PlanReqList.title'), 
        layout: 'fit',
        initComponent: function() {

            this.store = 'DevPlan';

    //      this.plugins = [{
    //            ptype: 'rowexpander',
    //            rowBodyTpl : [
    //                {name}
    //            ]
    //        }];

            this.features = [{ftype:'filters', encode:false, local:true},{ftype:'grouping'}];

            this.tbar = [{
                xtype:'commandbutton',
                id: 'newReq',
                iconCls:'icon-application_add',
                text: i18n.getMsg('gsip.view.plans.PlanReqList.addReq'),
                command: 'newReq',
            }];

            this.viewConfig = {
                forceFit:true,
                getRowClass: function(record, index) {
                    var c = record.get('elapsedPercent');
                    if (c >= 0) {                   
                        return 'elapsed-normal';
                    } 
                }
            }

            this.columns = [
                {header: "Id", dataIndex: "id", width:50, sortable: true, filter:{type:'numeric'}},
                {header: i18n.getMsg('gsip.view.plans.PlanReqList.column.name'), dataIndex: "name", flex:1, sortable: true, filter:{type:'string'} },

                }
            ];

            this.callParent(arguments);

        }, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-29T19:29:24.743

该`rowexpander`插件使用了一个名为`rowbody`.

在你用这一行`initComponent()`覆盖`this.features`（已经包括）：`rowbody`

```
this.features = [{ftype:'filters', encode:false, local:true},{ftype:'grouping'}]; 
```

因此，该`rowbody`功能不包括在内；因此`.x-grid-rowbody-tr`该类没有被注入；因此`rowexpander`找不到这样的类`nextBd`并返回null。

你应该试试：

```
var iNewFeatures = [{ftype:'filters', encode:false, local:true},{ftype:'grouping'}];
this.features = iNewFeatures.concat( this.features ); 
```

最后，插件不能在 中启动`InitComponent()`，您可以将它们声明为配置，或者在构造函数中。有关更多信息，请参阅[此线程](http://www.sencha.com/forum/showthread.php?138056-TreeEditor-plugin-until-Ext-releases-native&p=620022&viewfull=1#post620022)。

# hibernate - 使用 select 排序休眠查询

> ID：11668895
> 
> 赞同：3
> 
> 时间：2012-07-26T12:03:40.700
> 
> 标签：hibernate, sql-order-by, subquery, hql

是否可以通过某些子查询编写 hql 查询来订购？有这样的查询：

```
select a from A.a join a.b where a.b.id = :id 
```

我需要的是这样的：

```
select a from A.a join a.b where a.b.id = :id order by (select count(c) from C c where c.a = a.id) desc 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:31:53.690

我的别名系统似乎没有工作。或者它可能是休眠的一个错误，但这个东西有效（虽然效率很低），我必须硬编码别名

```
SELECT a, (SELECT COUNT(c) FROM C c WHERE c.a = a.id) AS col_1_0_ 
FROM A.a 
JOIN a.b 
WHERE a.b.id = :id 
ORDER BY col_1_0_ 
```

我正在使用 Hibernate 3 和 MySQL

# xsl-fo - 如何使用 XSL-FO 和 FOP 1.0 创建两列布局？

> ID：11668902
> 
> 赞同：6
> 
> 时间：2012-07-26T12:04:21.077
> 
> 标签：xsl-fo, apache-fop

我有一个软件，可以`XSL-FO`从文本文件创建描述并将其转换为 PDF 文档。文本文件中的每一行都转换为`fo:block`FO 中的 a，这听起来不对，但我现在无法更改。我的文档包含 1 到 3 页 A4。

我现在需要做的是在现有文本下方添加一个大约 8 厘米宽的图形。它应该是左对齐的。在它旁边，我想放置一个带有（长）描述的文本块。

![布局示例](../Images/36b7fb11fbcb1f1e9c6271c67ad5b9a9.png)

我查看了一些关于 FO 的文档并提出了以下建议：

```
<fo:block intrusion-displace="block" margin-top="20mm">
 <fo:float float="right">
   <fo:block margin-left="20mm">
    Bacon ipsum dolor sit amet laborum proident...
   </fo:block>
 </fo:float> 
  <fo:external-graphic src="image.png"/> 
</fo:block> 
```

这似乎是我想要的（当然经过一些微调），但不幸的是 FOP[还不支持](http://xmlgraphics.apache.org/fop/compliance.html#fo-object-float) `fo:float`。

似乎还有一种方法可以创建多个列（没有表），但我无法弄清楚它是如何工作的。一个似乎需要一个新页面，但如果有可用空间，我需要使用当前页面（我猜我不必关心）。

所以我的问题是：**有没有另一种方法可以在不使用的情况下构建它`fo:float`？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-26T12:36:00.150

您可以尝试将图像用作背景图像并留下与图像一样宽的左侧填充。

```
<fo:block intrusion-displace="block" margin-top="20mm">
   <fo:block padding-left="20mm" 
       background-image="image.png" 
       background-repeat="no-repeat">
    Bacon ipsum dolor sit amet laborum proident...
   </fo:block>
</fo:block> 
```

如果图像需要进一步处理，只能使用`<fo:external-graphic>`，您可以使用填充技术和一个额外的、绝对定位的块容器：

```
<fo:block intrusion-displace="block" margin-top="20mm">
   <fo:block padding-left="20mm">
    Bacon ipsum dolor sit amet laborum proident...
   </fo:block>
   <fo:block-container absolute-position="absolute">
       <fo:block>
          <fo:external-graphic src="image.png"/>
       </fo:block>
   </fo:block-container>
</fo:block> 
```

第三种选择是使用表格。

# r - 如何更改 knitr 选项中间块

> ID：11668904
> 
> 赞同：14
> 
> 时间：2012-07-26T12:04:53.570
> 
> 标签：r, options, knitr, chunks

嗨，我想更改块选项，中间块，而不必创建新块..

运行以下代码，我希望得到两个大小非常不同的输出，但由于某种原因，情况似乎并非如此。

此外，第二个情节根本没有情节......（当你将它更改为 plot(2:1000) 时它会......但无论哪种方式，第二个输出的大小都与第一个相同。两者`fig.width=7`。我在做什么错误的？

请注意“中间块”的重要性，原因是我想在运行函数时多次更改块选项以获得不同大小的不同输出。

```
```{r}
sessionInfo()

opts_chunk$set(fig.width=3)

plot(1:1000)

opts_chunk$set(fig.width=10)

plot(1:1000)

``` 
```

sessionInfo 输出如下：

```
## R version 2.15.1 (2012-06-22)
## Platform: i386-pc-mingw32/i386 (32-bit)
## 
## locale:
## [1] LC_COLLATE=English_United Kingdom.1252 
## [2] LC_CTYPE=English_United Kingdom.1252   
## [3] LC_MONETARY=English_United Kingdom.1252
## [4] LC_NUMERIC=C                           
## [5] LC_TIME=English_United Kingdom.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices datasets  utils     methods   base     
## 
## other attached packages:
## [1] knitr_0.7
## 
## loaded via a namespace (and not attached):
## [1] digest_0.5.2   evaluate_0.4.2 formatR_0.5    parser_0.0-16 
## [5] plyr_1.7.1     Rcpp_0.9.13    stringr_0.6    tools_2.15.1 
```

![html预览](../Images/2006a437c4828cc4f71e1e69b4f8b3ac.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-22T08:02:37.117

根据 github 上 Yui 的提示，这对我有用。

```
\documentclass{article}

\begin{document}
<<setup,echo=FALSE>>=
opts_knit$set(progress = F, verbose = F)
opts_chunk$set(comment=NA, warning=FALSE,message=FALSE,fig.width=6, echo=F)
kexpand=function(){
  cat(knit(
  text=knit_expand(text=
                     "<<yfig-{{cap}}-,fig.cap='{{cap}}',results='markup',echo=FALSE,fig.height={{figheight}},out.height={{outheight}}>>=\n
                   .q\n
                   @"
  )
))}
@

<<results='asis'>>=
library(ggplot2)
.q=qplot(1:10);cap="first caption";figheight=9;outheight=90
kexpand()
.q=qplot(1:20);cap="second caption";figheight=12;outheight=160
kexpand()

@
\end{document} 
```

所以关键的一件事是将进度和详细设置为 F 否则它们会破坏输出。然后小函数 kexpand 扩展了一个内联模板，该模板作为函数的一部分输入为文本。然后，您可以将绘图定义为 .q，将标题定义为 cap，以及您的身高等。您可以调整该功能以控制其他选项。奇怪的是，.q 和标题不一定是函数的参数，你可以在当前环境中设置它们，无论如何它们都会被函数拾取。不知道这是否是好的做法或为什么它有效，但它确实有效。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-26T12:58:23.603

两个问题：当您希望保留两个数字时，请使用

```
```{r fig.keep='all'} 
```

默认只保留唯一的图（因为你的两个图是相同的，第二个被删除；有关详细信息，请参阅[knitr 图形手册](https://github.com/downloads/yihui/knitr/knitr-graphics.pdf)）。

下一个块打开时，全局块选项处于活动状态：

```
```{r}
opts_chunk$set(fig.width=10)
```

```{r}
opts_chunk$set(fig.width=2)
# Our figure is 10 wide, not 2
plot(1:1000)
```

```{r}
# Our figure is 2 wide, not 10
opts_chunk$set(fig.width=10)
plot(1:1000)
``` 
```

# jquery - 我可以使用 .outerWidth() 和 .css() 将其向右移动吗

> ID：11668906
> 
> 赞同：1
> 
> 时间：2012-07-26T12:05:02.257
> 
> 标签：jquery, css, width

**编辑使问题更简洁。**

我可以使用 .css() 方法中的 outerWidth() 值将“#item”的位置偏移两倍的宽度吗？

例如：

```
$("#item").css("left", - (2 x outerwidth(this))); 
```

* * *

公认的答案主要是指我提出的原始（更复杂和更广泛）问题，其中包含我正在开发的更广泛的功能。

```
elem.css('left', $(window).width()+'px'); 
```

这适当地移动了元素，而不依赖于 outerWidth() 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:10:54.783

像这样的东西：

```
var elem = $("#item");

// 1\. animate to left
elem.animate({'left': -(2 * elem.outerWidth())+'px'}, function() { 

    // 2\. move to outside right border
    elem.css('left', $(window).width()+'px'); 

    // 3\. animate to starting position 
    elem.animate({'left': '0px'});
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:08:20.323

尝试这个：

```
$("#item").css("left", - (2 * $('#item').outerWidth())); 
```

`outerWidth()`是一个 jQuery 方法，为了使用它，您首先应该创建一个 jQuery 对象（通过选择一个元素）。请注意，在 JavaScript 中进行乘法运算时，您应该使用`*`not 运算符`x`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:08:39.123

来自 jQuery[`.css()`](http://api.jquery.com/css/#css2)文档：

> 从 jQuery 1.6 开始，.css() 接受类似于 .animate() 的相对值。相对值是一个以 += 或 -= 开头的字符串，用于增加或减少当前值。例如，如果一个元素的 padding-left 为 10px，.css( "padding-left", "+=15" ) 将导致总 padding-left 为 25px。

从那，我认为你想要的是：

```
$("#item").css("left", "-=" + (2 x outerwidth(this))); 
```

注意：我假设`outerwidth`在上面的代码行中是一个有效的函数（可能是你自己写的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:08:40.053

你在找这个吗？

```
$("#item").css("left", function(i, oldLeft){
    return -2*$(this).outerWidth();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-26T12:08:43.000

```
$("#item").css("left", - (2 * $("#item").outerwidth())); 
```

应该做的伎俩

# eclipse-emf - 如何从 EMF 模型生成 Java 代码

> ID：11668907
> 
> 赞同：1
> 
> 时间：2012-07-26T12:05:01.763
> 
> 标签：eclipse-emf, model-driven-development

我用 EMF 创建了一个模型，并为这个模型生成了一个 Eclipse 插件。在插件中，我现在可以定义该模型的一个实例。但现在我想从这个实例生成 Java 代码。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T05:38:15.260

您应该首先从您的 eCore 模型创建一个 GenModel。新建 -> 创建 -> EMF 生成器模型 -> 从 eCore -> 选择您的 eCore。然后单击此模型的顶级元素并选择 Generate All。

**编辑：** 没有办法**直接**从自定义模型生成 Java。您必须使用 JET、Accelo 或 xTend2 来编写您的生成器。或者，您可以查看 xText 项目。

# java - 如何优化此更新 SQL 查询

> ID：11668913
> 
> 赞同：1
> 
> 时间：2012-07-26T12:05:16.263
> 
> 标签：java, sql, oracle11g

我有这个 Java 方法，我将使用它来将 JSF 表单中的数据插入 Oracle：

```
public int saveData(int result) throws SQLException, java.text.ParseException, NoSuchAlgorithmException {

        String SqlStatement = null;

        if (ds == null) {
            throw new SQLException();
        }

        Connection conn = ds.getConnection();
        if (conn == null) {
            throw new SQLException();
        }

        PreparedStatement ps = null;

        /*

        CREATE TABLE USERS(
            USERID INTEGER NOT NULL,
            GROUPID INTEGER,
            SPECIALNUMBER VARCHAR2(60 ),
            USERNAME VARCHAR2(50 ),
            PASSWD VARCHAR2(50 ),
            DATETOCHANGEPASSWD DATE,
            ADDRESS VARCHAR2(60 ),
            STATEREGION VARCHAR2(50 ),
            COUNTRY VARCHAR2(50 ),
            USERSTATUS VARCHAR2(30 ),
            TELEPHONE VARCHAR2(50 ),
            DATEUSERADDED DATE,
            USEREXPIREDATE DATE,
            DATEUSERLOCKED CHAR(20 ),
            CITY VARCHAR2(50 ),
            EMAIL VARCHAR2(50 ),
            DESCRIPTION CLOB
        )
        /
        */

        try {
            conn.setAutoCommit(false);
            boolean committed = false;
            try {           /* insert into Oracle the default system(Linux) time */
        InsertSqlStatement = "INSERT INTO USERS"
                        + " (USERID, GROUPID, SPECIALNUMBER, USERNAME, PASSWD, DATETOCHANGEPASSWD,"
                        + " ADDRESS, STATEREGION, COUNTRY, USERSTATUS, TELEPHONE, DATEUSERADDED," 
                        + " USEREXPIREDATE, DATEUSERLOCKED, CITY, EMAIL, DESCRIPTION)"
                        + " VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";

        UpdateSqlStatement = "UPDATE USERS "
                                + "SET "
                                    + "USERID = ?, "
                                    + "GROUPID = ?, "
                                    + "SPECIALNUMBER = ?, "
                                    + "USERNAME = ?, "
                                    + "PASSWD = ?, "
                                    + "DATETOCHANGEPASSWD = ?, "
                                    + "ADDRESS = ?, "
                                    + "STATEREGION = ?, "
                                    + "COUNTRY = ?, "
                                    + "USERSTATUS = ?, "
                                    + "TELEPHONE = ?, "
                                    + "DATEUSERADDED = ?, "
                                    + "USEREXPIREDATE = ?, "
                                    + "DATEUSERLOCKED = ?, "
                                    + "CITY = ?, "
                                    + "EMAIL = ?, "
                                    + "DESCRIPTION = ? "
                        + "WHERE USERID = " + id;

                ps = conn.prepareStatement(SqlStatement);

                ps.setString(1, settingsMap.get("USERID"));
                ps.setString(2, settingsMap.get("GROUPID"));
                ps.setString(3, settingsMap.get("SPECIALNUMBER"));
                ps.setString(4, settingsMap.get("USERNAME"));
                ps.setString(5, passwdConvert(settingsMap.get("PASSWD")));
                ps.setDate(6, toDate(settingsMap.get("DATETOCHANGEPASSWD")));
                ps.setString(7, settingsMap.get("ADDRESS"));
                ps.setString(8, settingsMap.get("STATEREGION"));
                ps.setString(9, settingsMap.get("COUNTRY"));
                ps.setString(10, settingsMap.get("USERSTATUS"));
                ps.setString(11, settingsMap.get("TELEPHONE"));
                ps.setDate(12, toDate(settingsMap.get("DATEUSERADDED")));
                ps.setDate(13, toDate(settingsMap.get("USEREXPIREDATE")));
                ps.setDate(14, toDate(settingsMap.get("DATEUSERLOCKED")));
                ps.setString(15, settingsMap.get("CITY"));
                ps.setString(16, settingsMap.get("EMAIL"));
                ps.setString(17, settingsMap.get("DESCRIPTION"));

                ps.executeUpdate();

                conn.commit();
                committed = true;
            }
            finally 
            {
                if (!committed) {
                    conn.rollback();
                }
            }
        } finally {
            /* Release the resources */
            ps.close();
            conn.close();
        }
        return result;
    } 
```

现在我无法测试 SQL 查询。你能告诉我它是否有效以及如何优化 SQL 查询的性能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:18:54.023

> 现在我无法测试 SQL 查询。你能告诉我它是否有效...

没有任何把握。（为什么不等到可以测试它？？）

> ...以及如何优化 SQL 查询的性能？

目前尚不完全清楚您要做什么。但是，这里有一些关于性能的建议：

*   您正在为每个执行的 SQL 语句创建和释放数据库连接。这对性能肯定是不利的。
*   无需在更新同一记录后进行插入操作……如果您打算这样做的话。
*   您将通过批量或批量插入或更新而不是一次插入一条记录来获得性能。
*   如果您将大量数据插入到具有大量索引的空表中，那么如果您先进行插入然后再创建索引，则可能会获得更好的性能。

在单个查询级别（即“UPDATE”），您可能无法使查询*显着*加快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T12:14:54.427

你唯一能做的改进就是把`id`as '?' 还：

```
UPDATE USERS "
                            + "SET "
                                + "USERID = ?, "
                                + "GROUPID = ?, "
                                + "SPECIALNUMBER = ?, "
                                + "USERNAME = ?, "
                                + "PASSWD = ?, "
                                + "DATETOCHANGEPASSWD = ?, "
                                + "ADDRESS = ?, "
                                + "STATEREGION = ?, "
                                + "COUNTRY = ?, "
                                + "USERSTATUS = ?, "
                                + "TELEPHONE = ?, "
                                + "DATEUSERADDED = ?, "
                                + "USEREXPIREDATE = ?, "
                                + "DATEUSERLOCKED = ?, "
                                + "CITY = ?, "
                                + "EMAIL = ?, "
                                + "DESCRIPTION = ? "
                    + "WHERE USERID = ?"; 
```

当然，还要添加一个 set decleration：

```
 ps.setInt(18, id); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-26T12:18:14.793

如果要插入多行，则可以通过重用数据库连接以及准备好的语句来提高性能。后者也需要按照 ftom2[建议](https://stackoverflow.com/a/11669070/1468366)的方式将用户 ID 视为一行。除此之外，性能优化的空间很小。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-26T12:12:53.393

我认为没有什么可以优化的，因为您只插入一个表。更新也一样。没有连接或分组，所以你真的可以做任何事情。也许只是一个注释-您可以`StringBuilder`用于代码格式化:-)

# iphone - 从 iPhone 实时流式传输到网站

> ID：11668918
> 
> 赞同：1
> 
> 时间：2012-07-26T12:05:39.107
> 
> 标签：iphone, objective-c, http-live-streaming, live-streaming

我目前正在尝试制作一个应用程序，它可以让我直播 iPhone 相机看到的内容，然后在我的网站上看到这个直播，但是我不确定我需要在服务器端和 iOS 上做什么边。

我是否需要在我的网络服务器上设置任何东西才能接收到这个，或者是否可以在 iPhone 上完成这一切？

另外将视频和音频发送到网站的最佳方式是什么，我在文档中读到它是做 10 秒的块，然后有另一个重叠，所以它是无缝的，这是正确的还是有更好的方法呢？ ?

# c# - 我应该将 RouteParameter 或 UrlParameter 用于 Asp.NET web-api 路由吗？

> ID：11668925
> 
> 赞同：11
> 
> 时间：2012-07-26T12:05:57.297
> 
> 标签：c#, routes, asp.net-mvc-routing, asp.net-mvc-4

我已经看到两者都被使用了，所以我想知道，它们是做同样的事情还是做不同的事情？如果是后者，有什么区别？

我尝试通过查看 Visual Studio MVC 4 (rc) web api 模板自己回答这个问题，但遗憾的是它同时使用了两者，所以我的困惑仍然存在。以下是模板包含的内容：

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );
    }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-26T12:21:08.457

用于`RouteParameter`Web Api 路由 ( `.MapHttpRoute`) 和`UrlParameter`标准 MVC 控制器路由 ( `.MapRoute`)。如您所知，标准 MVC 和 Web API 在程序集和命名空间方面是两个完全不同的 API，即使两者非常相似。例如，您可以在控制台应用程序中自行托管您的 Web API，因此您甚至不会引用`System.Web.Mvc`程序集，并且您当然会`RouteParameter`在这种情况下使用。

# asp.net - 添加事件以动态控制

> ID：11668928
> 
> 赞同：0
> 
> 时间：2012-07-26T12:06:05.050
> 
> 标签：asp.net, vb.net, ajaxcontroltoolkit

我通过在后面的代码中添加 html 来创建一个 web 控件，如下所示：

```
Dim sb As New StringBuilder
Dim myDiv As HtmlGenericControl = Me.theContainer

sb.Append("<table width='100%'  cellpadding='0' cellspacing='0' style='border:0px;'>" & vbCrLf)
sb.Append(" <tr class='mainRow1'>" & vbCrLf)
sb.Append("<td  align='left'  style='border:0px solid white;'>Main Menu</td>" & vbCrLf)
sb.Append("<td>" & vbCrLf)
sb.Append("<asp:Label ID='Label1' runat='server' Text='Label'></asp:Label>" & vbCrLf)
sb.Append("</td>" & vbCrLf)
sb.Append("<td  align='right' style='border:0px solid white;'>Sort By: Id | Name</td>" & vbCrLf)
sb.Append("</tr>" & vbCrLf)
sb.Append("</table>" & vbCrLf)

myDiv.InnerHtml = sb.ToString 
```

这将在代码隐藏中为表生成 html，然后将其注入指定的 DIV 元素。我的问题是，如果我以这种方式创建一个控件，我如何添加一个将在我的代码隐藏中触发方法的事件？例如，如果我想创建一个图像按钮，我会在代码中这样做：

```
<asp:ImageButton CommandArgument='<%# (Container.DataItem.objectValue) %>'            
ID='ImageButton1' runat='server' OnCommand='Button1_Click' ImageUrl='~/images/folder.gif' /> 
```

但在后面的代码中我会这样做：

```
sb.Append("<input type='image' name='ctl00$ContentPlaceHolder1$importWizard1$folderControl1$folderRepeater$ctl04$ImageButton" & myCounter & "'")
sb.Append(" id='ctl00_ContentPlaceHolder1_importWizard1_folderControl1_folderRepeater_ctl04_ImageButton" & myCounter & "'")
sb.Append(" src='images/folder.gif' style='border-width:0px;'  />" & vbCrLf) 
```

我的问题是，考虑到我在服务器上生成控件，如何添加会在服务器上触发特定方法的“onCommand”事件？我不希望只是导致页面重新加载。此功能位于更新面板中的用户控件（ascx 文件）中。我只希望更新面板发回，而不是整个页面。当我使用 ONCommand 事件查看图像按钮或任何按钮的源时，它实际上甚至不在后面的代码中。

任何帮助都会很棒。哦，我正在使用 Visual Studio 2005 进行开发

谢谢杰森

如果我尝试添加这样的服务器控件：

```
Dim img As New ImageButton
img.Command = New CommandEventHandler(AddressOf Button1_Click)

img.ID = "button-" & item.directoryName & "-" & item.objectValue
Dim newSb As StringBuilder = New StringBuilder()
Dim tw As StringWriter = New StringWriter(newSb)
Dim hw As HtmlTextWriter = New HtmlTextWriter(tw)
img.RenderControl(hw) 
```

“img.Command”给我一个错误（蓝色波浪线）说“公共事件命令（发送者作为对象，e 作为 webcontrols.commandEventArgs）是一个事件，不能直接调用。使用引发事件语句来引发事件”

```
Dim img As New ImageButton()
img.ID = "button-" & item.directoryName & "-" & item.objectValue
img.ImageUrl = "images/folder.gif"
AddHandler img.Click, AddressOf img_Click

Dim newSb As StringBuilder = New StringBuilder()
Dim tw As StringWriter = New StringWriter(newSb)
Dim hw As HtmlTextWriter = New HtmlTextWriter(tw)

img.RenderControl(hw)
sb.Append(tw.ToString)

Protected Sub img_Click(ByVal sender As Object, ByVal e As ImageClickEventArgs)
    ...
End Sub 
```

尽管这似乎渲染得很好（当我查看源代码时），但实际上从未调用过该方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:46:30.883

他们可能会按照您的方式执行此操作，但我不建议您这样做。关键是了解 HTML 控件和服务器控件之间的区别。

要添加事件，您需要建立服务器控件，然后将它们添加到您的 div - 像这样（这是 C# 而不是 VB，但您明白了）

```
Table table = new Table();
TableRow row = new TableRow();
TableCell cell = new TableCell();

ImageButton img = new ImageButton();
img.Command += new CommandEventHandler(img_Command);

cell.Controls.Add(img);
row.Controls.Add(cell);
table.Controls.Add(row);

myDiv.Controls.Add(table); 
```

**编辑**

根据您的评论，我认为问题在于在 VB 中注册的处理程序与在 C# 中不同 - 您需要查看 AddHandler (http://msdn.microsoft.com/en-us/library/6yyk8z93(v=vs.80) ).aspx) 所以你需要这样的东西

```
AddHandler img.Command, AddressOf Button1_Click 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T17:41:11.227

所以，我想通了，想发帖以防其他人试图这样做：

1.  在客户端，添加这个 javascript 函数：

    ```
     function UpdPanelUpdate(value){   
     var obj = document.getElementById("<%= text.ClientID %>");   
     obj.value=value;  
      __doPostBack("ctl00$ContentPlaceHolder1$importWizard1$folderControl1$button","");
     } 
    ```

2.  在客户端，添加这些控件：

    ```
     <asp:TextBox ID="text" runat="server" style="display:none;"></asp:TextBox>
      <asp:Button ID="button" runat="server" OnClick="Button1_Click" CommandArgument="" style="display:none;"/> 
    ```

3.  在客户端页面上，添加带有触发器的更新面板：

    ```
    <asp:UpdatePanel ID="UpdatePanel1" runat="server"  UpdateMode="Conditional">
    <ContentTemplate>
        <div runat="server" id="theContainer" style="position:relative; border:1px solid grey; width:51em; height:28.8em; overflow:auto; align:left;"> 
            <asp:TextBox  runat="server" ID="currentIdTb" Visible="false"></asp:TextBox>     
        </div>
    </ContentTemplate>
    <Triggers>
      <asp:AsyncPostBackTrigger ControlID="button" EventName="Click" />
      </Triggers>
     </asp:UpdatePanel> 
    ```

4.  在代码隐藏中，添加此处理程序：

    ```
     Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs)
      'code here
     end sub 
    ```

5.  最后，在代码隐藏中，添加一个 onclick 甚至调用 js 函数。

    ```
     sb.Append("<input type='image' name='b" & myCounter & "'")
            sb.Append(" id='b" & myCounter & "'")
            sb.Append(" src='images/folder.gif' style='border-width:0px;' ")
            sb.Append(" onClick=""UpdPanelUpdate('" & item.objectValue & "')""  />" &   vbCrLf) 
    ```

# jquery - mvc 4 模板问题

> ID：11668931
> 
> 赞同：1
> 
> 时间：2012-07-26T12:06:16.293
> 
> 标签：jquery, jquery-ui, asp.net-mvc-4

我为 VS 2010 VS Express for Web (2012) 安装了 MVC 4。无论我使用什么版本，我的 Internet MVC 4 Web 应用程序都不具备许多博主描述的所有功能。例如，登录链接不显示登录对话框，而是显示常规登录页面。此外，我无法使 jquery-ui 对话框工作（标题向右移动）。

在我深入故障排除/调试 CSS/jscripts 之前，我想确保我在这里没有遗漏一些简单的东西......

提前致谢！

# c# - 在 Visual Studio 2010 Express 中从 dll 自动生成 C# 包装类？

> ID：11668932
> 
> 赞同：26
> 
> 时间：2012-07-26T12:06:18.653
> 
> 标签：c#, dll, wrapper, visual-studio-express

我的一位同事告诉我，Visual Studio 允许指向 a`.dll`并自动生成一个 C# 包装类。这真的可能吗？如果是这样，如何实现这一目标？我浏览了网页，但没有提出任何建议！

谢谢大家！

* * *

我想我也会分享这些资源，

*   [如何：创建 COM 包装器](http://msdn.microsoft.com/en-us/library/ms404285.aspx)
*   [并由 @Darin](https://stackoverflow.com/a/11721430/584862)提供，使用[非托管 DLL 函数](http://msdn.microsoft.com/en-us/library/26thfadc.aspx)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-30T12:19:52.533

3个案例：

1.  DLL 代表一个托管程序集 => 您在项目中直接引用它并使用它
2.  DLL 代表一个 COM 对象 => 您可以使用[tlbimp.exe](http://msdn.microsoft.com/en-us/library/tt0cf3sx.aspx)实用程序来生成托管包装器
3.  DLL 表示具有一些导出函数的非托管库。那是最艰难的一个。没有工具。您必须查阅库的文档以了解导出的函数名称和参数并构建托管 P/Invoke 包装器。您可以使用[dumpbin.exe](http://msdn.microsoft.com/en-us/library/c1h23y6c.aspx)实用程序查看导出函数的列表。这是MSDN 上有关不同步骤[的文章。](http://msdn.microsoft.com/en-us/library/26thfadc.aspx)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-30T14:04:29.763

这对于任何 DLL 来说肯定是不可能的。只是一种非常特殊的类型，它实现了 COM 服务器。转换器需要对导出的类型进行良好的描述，这是由*类型库*为此类服务器提供的。

类型库完全等同于托管程序集中的元数据。虽然它以独立文件（.tlb 文件）的形式开始使用，但它通常作为资源嵌入到 DLL 中。它的好地方，保持类型描述接近实现它的代码。就像 .NET 程序集中的元数据一样。

一些用于查看类型库的工具（不确定它是否适用于 Express）：在 Visual Studio 中使用 File + Open + File 并选择 c:\windows\system32\shell32.dll。您将看到该 DLL 中的资源，请注意 TYPELIB 节点。这就是类型库。它是二进制的，因此实际上阅读它是不切实际的。为此，请从 Visual Studio 命令提示符运行 OleView.exe。File + View Typelib 并选择相同的 DLL。这会将类型库反编译回 IDL，即最初用于创建类型库的接口描述语言。高度可读性，您在理解该语言时将毫不费力。并且可以很容易地看到 .NET Tlbimp.exe 如何将该类型库转换为等效的 C# 声明。

类型库是旧的，它们从 1996 年就已经存在。最初由 Microsoft 的 Visual Basic 团队设计，作为 VBX 的替代品，16 位 VB 可扩展性模型。它们*非常*成功，几乎所有 Windows 编译器都支持它们。但是它们的表达能力有限，不支持泛型和实现继承之类的东西。值得注意的是，Windows 8 团队已经替换了 WinRT 的类型库。他们选择了 .NET 元数据格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-18T08:13:14.310

我知道这个问题已经相当老了，而且似乎已经得到了充分的回答，但我只想添加一个我认为可能很重要的想法。我可能完全错了，所以请对我的回答持保留态度，如果我错了，请纠正我。

为了能够调用 DLL 中的成员/字段，调用它们所需的信息必须能够以某种形式访问。这些信息应该是编写包装器所需的全部信息。有了它，您可以确定所有成员/字段“表单”，也就是方法头等等。

在 C# 中，可以通过反射加载 DLL 并获取该信息。我不知道上述不同的 DLL 类型，但正如我所说，要调用成员/字段，这些信息必须以某种形式存在。因此，使用反射来获取该信息，您可以生成一个新类，例如“prefixOriginalname”，并使其具有与原始类相同的成员/字段，调用原始类的成员/字段并添加您想要的额外功能。

所以

1.  每个 DLL（或外围文档）都为您提供了使用其类型所需的信息。即所有被实现为“公共”的东西
2.  您可以通过反射访问所需的信息
3.  给定 1\. 和 2.，您可以创建一个程序来从 DLL 中提取所需的信息并相应地生成包装器。

正如我所说，我对这个不是 100% 确定的，因为其他答案让我觉得这可能因为某种原因太难甚至是不可能的。

# .net - XmlException 与 XmlStringReader vb .net

> ID：11668933
> 
> 赞同：0
> 
> 时间：2012-07-26T12:06:28.787
> 
> 标签：.net, xml, vb.net, xml-parsing

我正在尝试使用 XmlStringReader 解析错误的 XML 代码，例如这个。

```
<Page CODE=""L"" page Caption=""Example""><Cell CellType="0"...></Cell></Page> 
```

并使用此代码，我尝试从单元格标记中的单元格类型属性中获取值。

```
 Using reader As XmlReader = XmlTextReader.Create(New StringReader(l.Label), New XmlReaderSettings With {
                                                     .ValidationType = ValidationType.None,
                                                     .XmlResolver = Nothing})
               While (reader.ReadToFollowing("Cell"))
            reader.MoveToAttribute("CellType")
            Select Case Int32.Parse(reader.Value)
                  ...
            End Select
        End While 
```

所以我得到以下 XmlException

> 'Caption' 是一个意想不到的标记。预期的标记是'='

有什么方法可以避免这种异常吗？还是我应该在此之前解析 xml 以修复错误写入的属性？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T12:10:15.043

> 我应该在此之前解析 xml 以修复错误写入的属性吗？

它不是 XML。它看起来*有点*像 XML，但实际上并非如此。不要尝试使用 XML API 读取非 XML。它会——而且应该——失败。

理想情况下，首先修复*生成*伪 XML 的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:14:56.473

解析器的通用规则是它们假设输入根据解析器编写的任何规范都是有效的。那么，在 XML 解析器的情况下，它假定您正在向它传递有效的 XML 代码以进行解析。

在这种情况下，您不是因为 XML 不允许属性在其名称中包含空格。`page Caption`不是有效的属性标识符，因此解析器可能将其解释`page`为属性标识符，将空格视为分隔符，并想知道如何处理`Caption`.

你不能只是“修复”异常。解析器彻底糊涂了，它正在放弃。即使您可以以某种方式强制它继续，也无法保证结果的有效性。就像有人浏览一本书并删除了所有标点符号一样。你可能会沮丧地放下它，因为你无法理解它。但是，如果有人*强迫*您阅读它，您最终可能会更频繁地得到错误的含义。解决问题的唯一方法是向解析器提供它理解的输入。

So, yes, you'll need to ensure that the XML is valid *before* running it through a parser. Where are you obtaining this XML from? Can you fix the generation process so that it uses valid identifiers and conforms properly to an XML schema?

# ms-access - 在 Access 中查询两个表并使用记录数据作为列标题？

> ID：11668936
> 
> 赞同：0
> 
> 时间：2012-07-26T12:06:42.543
> 
> 标签：ms-access

这个网站对我为工作创建的这个数据库非常有帮助，我有很多 VB 知识，但很少有 SQL。

我正在创建一个 Cisco IP 电话数据库，该数据库记录 MAC、序列号以及它们被分配到的站点 ID。

我的经理现在决定再次更改我的应用程序的目标职位，现在要求我创建一个表单，以我不知道该怎么做的方式显示数据。

他们现在想要的以及我希望以某种方式实现的是创建一个 sql 语句，该语句通过站点 ID 获取手机的数量，然后将该数字与另一个表中的数据进行比较。

以下是我们需要处理的字段：

```
TABLE 1
Handset_Type
Handset_Site_Id

TABLE 2
Handset_Type
Handset_Site_Id 
```

这就是我想显示数据的方式

```
SITE ID        | Handset_Type1      | Handset_Type1 
Handset_Site_id1 |COUNT TYPE1 FROM T1|COUNT TYPE1 FROM T2 
Handset_Site_id2 |COUNT TYPE1 FROM T1|COUNT TYPE1 FROM T2 
```

如果我们可以使用 Handset_type 字段中的数据来创建列标题，那就太好了，因为只有少数手机型号，但如果它们是静态列，那也可以。

我希望我已经解释过了，因为我可以看到这可能很难理解。

如果您有任何建议，请让我知道

谢谢

史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T14:02:59.810

如果我正确理解了这个问题，您想为每个站点 ID 显示两个表中的记录计数，其中手机类型和源表作为列标题。

第一步是将您的表合并到一个表中，创建一个表示手机类型和源表的列：

```
SELECT Handset_Type & " in T1" as TypeFromT, Handset_Site_Id FROM [Table 1]
UNION ALL
SELECT Handset_Type & " in T2" as TypeFromT, Handset_Site_Id FROM [Table 2] 
```

这将形成交叉表的内部查询。交叉表的语法可能有点棘手，所以我通常在设计视图中构建我的。我们将 定义`TypeFromT`为新的列标题，并将`Handset_Site_Id`其用作行分组和计数字段：

```
TRANSFORM Count(SubQry.Handset_Site_Id) AS SiteIDCount
SELECT SubQry.Handset_Site_Id
FROM (
    SELECT Handset_Type & " in T1" as TypeFromT, Handset_Site_Id FROM [Table 1]
    UNION ALL
    SELECT Handset_Type & " in T2" as TypeFromT, Handset_Site_Id FROM [Table 2]
) AS SubQry
GROUP BY SubQry.Handset_Site_Id
PIVOT SubQry.TypeFromT; 
```

唯一需要注意的是，如果特定手机类型、源表和站点 ID 的条目为零，则结果值为空而不是 0。如果不希望出现这种情况，请替换`Count(SubQry.Handset_Site_Id)`为`Nz(Count(SubQry.Handset_Site_Id),0)`

# c# - 将 tiff 转换为 jpg 格式

> ID：11668945
> 
> 赞同：15
> 
> 时间：2012-07-26T12:07:14.153
> 
> 标签：c#, tiff, jpeg

我有一个两页的 tiff 图像。当我将文件转换为 jpg 格式时，我丢失了第二页。有没有办法将 tiff 文件中的两个图像放入一个 jpg 文件中。由于 tiff 文件太大，我不得不减小它们的大小。有没有办法以编程方式减小 tiff 文件的大小？这也可以解决我的问题。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-26T12:23:36.773

由于 TIFF 可以包含多个帧，但 JPG 不能，因此您需要将每个单独的帧转换为 JPG。

取自[Windows 开发中心示例](http://code.msdn.microsoft.com/windowsdesktop/CSTiffImageConverter-92ac2358/sourcecode?fileId=25010&pathId=199825375)：

```
public static string[] ConvertTiffToJpeg(string fileName) 
{ 
        using (Image imageFile = Image.FromFile(fileName)) 
        { 
            FrameDimension frameDimensions = new FrameDimension( 
                imageFile.FrameDimensionsList[0]); 

            // Gets the number of pages from the tiff image (if multipage) 
            int frameNum = imageFile.GetFrameCount(frameDimensions); 
            string[] jpegPaths = new string[frameNum]; 

            for (int frame = 0; frame < frameNum; frame++) 
            { 
                // Selects one frame at a time and save as jpeg. 
                imageFile.SelectActiveFrame(frameDimensions, frame); 
                using (Bitmap bmp = new Bitmap(imageFile)) 
                { 
                    jpegPaths[frame] = String.Format("{0}\\{1}{2}.jpg",  
                        Path.GetDirectoryName(fileName), 
                        Path.GetFileNameWithoutExtension(fileName),  
                        frame); 
                    bmp.Save(jpegPaths[frame], ImageFormat.Jpeg); 
                } 
            } 

            return jpegPaths; 
        } 
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-11-19T12:15:05.243

```
using System.Drawing;
using System.Drawing.Imaging;

Bitmap bm=Bitmap.FromFile("photo.tif");
bm.Save("photo.jpg",ImageFormat.Jpeg); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-27T00:35:50.663

```
 public static class ConvertTiffToJpeg
    {
        static string base64String = null;
        public static string ImageToBase64(string tifpath)
        {
            string path = tifpath;
            using (System.Drawing.Image image = System.Drawing.Image.FromFile(path))
            {
                using (MemoryStream m = new MemoryStream())
                {
                    image.Save(m, ImageFormat.Jpeg);
                    byte[] imageBytes = m.ToArray();
                    base64String = Convert.ToBase64String(imageBytes);
                    return base64String;
                }
            }
        }
    } 
```

< img src="data:image/jpeg;base64, @ConvertTiffToJpeg.ImageToBase64(@"c:\sample.tif")"/>

[时间：2019-04-01 标签： c#](/questions/tagged/c%23 "显示标记为“c#”的问题") [.net](/questions/tagged/.net "显示标记为“.net”的问题") [tiff-to-jpeg](/questions/tagged/tiff-to-jpeg "显示标记为“tiff-to-jpeg”的问题") [tiff](/questions/tagged/tiff "显示标记为“tiff”的问题")

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T11:39:00.960

我们在将 TIF 文件转换为 JPEG 时遇到了一些问题，因为 TIF 格式支持免费工具包中不支持的某些类型的压缩。我在互联网上搜索并尝试了一些商业工具包，但大多数都很难实现，有很多限制。引起我注意的工具包是leadtools，因为它支持加载和保存多种文件格式（包括不同压缩的TIF图像）。我们使用这个工具包将我们的图像转换为 JPEG 格式。您可以在以下页面中找到更多信息：http: [//support.leadtools.com/CS/forums/8925/ShowPost.aspx](http://support.leadtools.com/CS/forums/8925/ShowPost.aspx)

请注意，您可以使用此免费代码转换器将任何 VB.Net 代码转换为 C#：http: [//www.developerfusion.com/tools/convert/vb-to-csharp/](http://www.developerfusion.com/tools/convert/vb-to-csharp/)

# c# - 使用 Collectionpager 在 asp.net Datalist 中只显示一件事

> ID：11668946
> 
> 赞同：0
> 
> 时间：2012-07-26T12:07:17.287
> 
> 标签：c#, collections, datalist

我想在一页中只显示一件事。我将选择页面大小更改为 1 以提供此功能但它的下一个按钮不起作用所以我无法在 DataList 中看到其他数据。

我尝试过这样的事情：

```
 <cc1:CollectionPager ID="Sayfalama" runat="server" BackNextDisplay="Buttons"
    BackNextLinkSeparator="" BackNextLocation="Split" BackNextStyle=""
    BackText="Geri" ControlCssClass="Sayfalama" ControlStyle=""
    FirstText="İlk Sayfa" HideOnSinglePage="True" IgnoreQueryString="True"
    LabelStyle="" LabelText="Sayfalar :" LastText="Son Sayfa" MaxPages="100"
    NextText="İleri" PageNumbersDisplay="Results" PageNumbersSeparator="&amp;nbsp;"
    PageNumbersStyle="" PageNumberStyle="" PageSize="1" PagingMode="PostBack"
    QueryStringKey="Sayfa"
    ResultsFormat="{2} tane makaleden {0} - {1} arası gösteriliyor"
    ResultsLocation="None" ResultsStyle="" SectionPadding="15" ShowFirstLast="True"
    ShowLabel="False" ShowPageNumbers="False" SliderSize="15" UseSlider="False">
</cc1:CollectionPager> 
```

你能帮我吗？我能做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T13:18:55.463

我找到了我设置的问题解决方案，`ShowPageNumbers="False"`但是当它为假时，它不允许使用下一个按钮更改页面以更改页面首先您应该单击一个数字然后返回，下一个按钮可以成功工作，因此`ShowPageNumbers`属性必须为真。

# android - 九个补丁图像不起作用

> ID：11668950
> 
> 赞同：2
> 
> 时间：2012-07-26T12:07:44.687
> 
> 标签：android, nine-patch

我用 android 工具 draw9patch.bat 做了一个 9 补丁图像。仅在右侧画一条黑线，我希望它伸展。另存为 .9.png 并将其设置为 TextView 的背景：

```
android:background="@drawable/myninepatch" 
```

它不起作用，我在应用程序中得到带有黑线的图像并且它没有拉伸。我究竟做错了什么？

我在一些地方看到除了可拉伸区域的线之外，对面还有一个非常小的标记区域，但我不知道它是做什么的，我没有使用它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-26T12:10:30.067

检查本[指南](http://radleymarx.com/blog/simple-guide-to-9-patch/)。在这里您可以找到九个补丁图像的简单 UI 指南。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T12:18:25.870

在 9 个补丁图像中，右侧和底部的线表示填充，例如。图片下方的大小不会缩小。由顶部和左侧线指示的段将根据所需的大小进行拉伸和收缩。

# symfony - Setter 注入在带有 Buzz 浏览器客户端的 Symfony 2 中不起作用？

> ID：11668952
> 
> 赞同：1
> 
> 时间：2012-07-26T12:07:56.017
> 
> 标签：symfony, dependency-injection, ssl-certificate, buzz

我在我的自定义服务中使用[kriswallsmith/Buzz](https://github.com/kriswallsmith/Buzz/)`Skebby`浏览器。这是`config.yml`，请注意`setVerifyPeer(false)`禁用 SSL 证书验证的调用：

```
# cURL client
buzz.client.curl:
    class:  Buzz\Client\Curl
    public: false
    calls:
    - [setVerifyPeer, [false]]

# Buzz browser configured to use cURL client
buzz.browser:
    class:     Buzz\Browser
    arguments: ['@buzz.client.curl'] 
```

虽然`Skebby`它本身是用[schmittjoh/JMSDiExtraBundle](https://github.com/schmittjoh/JMSDiExtraBundle)注释的：

```
/** @Service("skebby") */
Class Skebby
{
    /**
     * @InjectParams({
     *     "browser"    = @Inject("buzz.browser"),
     *     "translator" = @Inject("translator")
     * })
     *
     * @param \Buzz\Browser $browser
     * @param \Symfony\Bundle\FrameworkBundle\Translation\Translator $translator
     */
    public function __construct(Browser $browser, Translator $translator)
    {
        $this->browser    = $browser;
        $this->translator = $translator;
    }

    public function getCredit()
    {
        var_dump($this->browser->getClient());
        die();
    }
} 
```

不幸的是，调用（在控制器内）`$this->get('skebby')->getCredit()`显示服务容器发生了问题：

```
object(Buzz\Client\Curl)[4905]
  private 'lastCurl' => null
  protected 'options' => 
    array (size=0)
      empty
  protected 'ignoreErrors' => boolean true
  protected 'maxRedirects' => int 5
  protected 'timeout' => int 5
  protected 'verifyPeer' => boolean true 
```

那`verifyPeer`仍然是`true`，因为电话`setVerifyPeer(false)`从未发生过。我的配置有问题吗？

有用的链接：

*   [`AbstractClient.php`](https://github.com/kriswallsmith/Buzz/blob/master/lib/Buzz/Client/AbstractClient.php)抽象客户类
*   [`AbstractCurl.php`](https://github.com/kriswallsmith/Buzz/blob/master/lib/Buzz/Client/AbstractCurl.php)cURL 客户端的父类，扩展`AbstractClient`
*   [`Curl.php`](https://github.com/kriswallsmith/Buzz/blob/master/lib/Buzz/Client/Curl.php)类本身，扩展`AbstractCurl`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T13:05:58.590

`calls`您在指令下有错误的缩进

应该：

```
buzz.client.curl:
    class:  Buzz\Client\Curl
    public: false
    calls:
        - [setVerifyPeer, [false]] 
```

在您的版本中，它什么都不叫；）

# c# - Silverlight + WP7 中的 WebClient 和缓存

> ID：11668953
> 
> 赞同：0
> 
> 时间：2012-07-26T12:07:56.780
> 
> 标签：c#, silverlight, windows-phone-7, caching, webclient

每次我的 WP7 应用程序加载时，我都使用 WebClient 下载 JSON 文件。我一次性加载所有详细信息，并且也是从服务此 JSON 的服务器端点加载的。我面临的明显问题是缓存。它总是在加载陈旧的副本。但是我通过在最后添加一个虚拟 URL 参数来解决这个问题。

但是，JSON 很少更改。所以我仍然需要利用 WebClient 自动使用的缓存技术。为此，我最初请求调用服务器的 JSON 版本，例如`http://myserver/JSONVersion`. 每当更新 JSON 时，都会更新此 JSONVersion。

一旦我得到它，我将它附加到我的 url `http://myserver/myjson.json?v=(JSONVERSION)`。这解决了我的整个问题。但是，我觉得这很丑陋，并且有不必要的多余代码+逻辑浮动。我希望 HTTP 缓存标头具有与我所拥有的类似的解决方法。如果是这样，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T08:36:05.323

显然，我没有找到比我目前拥有的更好的解决方案。

# php - PHP 基本转换 if then else

> ID：11668954
> 
> 赞同：0
> 
> 时间：2012-07-26T12:08:00.353
> 
> 标签：php

我想从这里转换以下代码

```
$diff = strtotime($row['start']) - strtotime($current);
if ($diff < 7200) {
    echo 'Starts soon';
} else if ($diff <= 0) {
    echo 'Started';
} else {
    echo 'Starts';
} 
```

到这个？

```
<?= ($current > $row['start']) ? 'Started' : 'Starts';  ?> 
```

（如果可能的话）怎么能这样写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T12:11:40.210

它不是很易读，所以我不会使用它，但你去：

```
echo ($diff < 7200) ? 'Starts soon': (($diff <= 0) ? 'Started': 'Starts'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:11:24.653

这不是很漂亮，但你可以这样做：

```
<?php
$diff = strtotime($row['start']) - strtotime($current);
echo ($diff < 7200 ? 'Start soon' : ($diff <= 0 ? 'Started' : 'Starts'));
?> 
```

或者

```
<?= ((strtotime($row['start']) - strtotime($current)) < 7200 ? 'Start soon' : ((strtotime($row['start']) - strtotime($current)) <= 0 ? 'Started' : 'Starts')); ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-26T12:11:36.080

else if 可以在 else 部分应用你添加新的 if。

```
<?= (($diff < 7200) ? "Starts soon" : (($diff <= 0) ? "Started" : "Starts")); ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:13:30.043

`if elseif`涵盖几行的陈述没有错。如果您稍后检查您的代码，或者更重要的是，如果其他人正在阅读您的代码，它会使其易于阅读、易于理解并且易于查看正在发生的事情。

请记住，编写代码总是比阅读更容易。

从[文件](http://php.net/manual/en/language.operators.comparison.php)：

```
<?php
// on first glance, the following appears to output 'true'
echo (true?'true':false?'t':'f');

// however, the actual output of the above is 't'
// this is because ternary expressions are evaluated from left to right

// the following is a more obvious version of the same code as above
echo ((true ? 'true' : false) ? 't' : 'f');

// here, you can see that the first expression is evaluated to 'true', which
// in turn evaluates to (bool)true, thus returning the true branch of the
// second ternary expression.
?> 
```

这真的不太可取，因为它难以阅读且容易误读。

# c# - 如果不为空，则添加到集合

> ID：11668965
> 
> 赞同：32
> 
> 时间：2012-07-26T12:08:44.203
> 
> 标签：c#, nullable

我有一个非常大的对象，其中包含许多可为空类型的变量。我还有一本字典，我想用这个对象的非空变量填充它。

代码看起来像这样

```
if (myObject.whatever != null)
{
myDictionary.Add("...",myObject.whatever);
}
if (myObject.somethingElse != null)
{
myDictionary.Add("...",myObject.somethingElse);

... 
```

编辑（抱歉弄乱了代码）

当我们无数次重复这一点时，我们会得到一堆非常长的代码。有没有更短的方法可以写出这个烂摊子？我知道条件运算符（又名？），但这只是用于分配。有没有类似的东西可以添加到收藏中？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-26T12:11:47.563

你的字典的扩展方法怎么样？

```
public static void AddIfNotNull<T,U>(this Dictionary<T,U> dic, T key, U value) 
where U : class {
    if (value != null) { dic.Add(key, value); }
} 
```

然后你可以这样做：

```
myDictionary.AddIfNotNull("...",myObject.whatever); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-26T12:16:55.167

我建议编写一个扩展方法：

```
public static class MyExtensions
{
    public static void AddIfNotNull<TKey, TValue>(this IDictionary<TKey, TValue> dictionary, TKey key, TValue value)
    {
        if ((object)value != null)
            dictionary.Add(key, value);
    }
} 
```

Using`(object)value != null`确保这对可空类型（例如`int?`）值类型（例如`int`）和引用类型（例如`SomeClass`）如您所期望的那样工作。如果将其与 进行比较`default(TValue)`，则不会添加`int`of ，即使它不为空。`0`如果您包含`TValue : class`需求，则不能`Nullable<T>`用作类型，这听起来像是您最常见的用法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-26T12:11:19.587

您可以制作一个隐藏您的方法`if`：

```
AddIfNotNull(myDictionary, "...", myObject.whatever);

private static void AddIfNotNull<K,T>(
    IDictionary<K,T> myDictionary
,   K key
,   T value) {
    if (value != default(T)) {
        myDictionary.Add(key, value);
    }
} 
```

您可以通过将该方法作为扩展来获得一些“风格积分”（然后您需要将其添加到静态类中）：

```
private static void AddIfNotNull<K,T>(
    this IDictionary<K,T> myDictionary
,   K key
,   T value) {
    if (value != default(T)) {
        myDictionary.Add(key, value);
    }
}

myDictionary.AddIfNotNull(myDictionary, "...", myObject.whatever); 
```

如果您知道您只插入引用类型对象，请替换`default(T)`为泛型`null`并添加一个`class T`约束。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-26T12:12:04.487

```
public void addToDict(string ?myObj, Dictionary<,> myDict) {
        if (myObj != null)
              myDict.Add("...", myObj);
}

addToDict(myObject.whatever, myDict);
addToDict(myObject.somethignElse, myDict); 
```

ETC

# drupal - 根据 cookie 限制对页面的访问。德鲁巴

> ID：11668967
> 
> 赞同：1
> 
> 时间：2012-07-26T12:08:52.240
> 
> 标签：drupal

我想限制对某些页面的访问，例如：http://www.something.com/hello/x

我需要根据是否设置了 cookie 来限制“hello”路径中的每个页面。知道如何执行此操作以及将代码放在哪里吗？我需要为我创建一个新模块来执行此操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T14:41:38.467

在自定义模块中尝试：

```
// Implements hook_init()
function mycustommodule_init() {
  if (drupal_match_path($_GET['q'], "hello/*")) {
    if (!isset($_COOKIE['my_cookie'])) {
      drupal_access_denied();
    }
  }
} 
```

# python - Python，如何解码二进制编码的十进制（BCD）

> ID：11668969
> 
> 赞同：11
> 
> 时间：2012-07-26T12:08:59.980
> 
> 标签：python, struct, binary, decode, bcd

二进制字段的描述是：

> 主叫号码，用压缩的BCD码表示，剩余位用“0xF”填充

我尝试使用 struct 格式打印，`'16c'`我得到：`('3', '\x00', '\x02', '\x05', '\x15', '\x13', 'G', 'O', '\xff', '\xff', '\xff', '\xff', '\xff', '\xff', '\xff', '\xff')`如果我使用`'16b'`我得到`(51, 0, 2, 5, 21, 19, 71, 79, -1, -1, -1, -1, -1, -1, -1, -1)`. 而且不正确，我应该得到电话号码，上面的号码无效。

```
print struct.unpack_from('>16b', str(data.read()),offset=46) 
```

以上是无效的代码，我得到无效的数字。我应该用什么格式解压那个 16 字节的字段以及如何转换 BCD 码？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-26T12:21:09.020

BCD 代码使用每个数字 4 位，通常只编码数字 0 - 9。因此序列中的每个字节包含 2 个数字，每 4 位信息 1 个。

以下方法使用生成器来生成这些数字；我假设 0xF 值意味着没有更多的数字可以跟随：

```
def bcdDigits(chars):
    for char in chars:
        char = ord(char)
        for val in (char >> 4, char & 0xF):
            if val == 0xF:
                return
            yield val 
```

在这里，我使用[右移运算符](http://docs.python.org/reference/expressions.html#shifting-operations)将最左边的 4 位向右移动，并使用[按位与](http://docs.python.org/reference/expressions.html#shifting-opera)来选择最右边的 4 位。

示范：

```
>>> characters = ('3', '\x00', '\x02', '\x05', '\x15', '\x13', 'G', 'O', '\xff', '\xff', '\xff', '\xff', '\xff', '\xff', '\xff', '\xff')
>>> list(bcdDigits(characters))
[3, 3, 0, 0, 0, 2, 0, 5, 1, 5, 1, 3, 4, 7, 4] 
```

该方法适用于`c`输出；如果直接传递整数，则可以跳过`ord`方法中的调用（但使用`B`无符号变体）。或者，您可以直接从文件中读取这 16 个字节，并将此函数直接应用于这些字节，而无需使用 struct.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-12T14:34:40.990

```
a = b'\x12\x34\x5f'

def comp3_to_int(a):
    b = a.hex()
    c = int(b[0:len(b)-1])
    if b[len(b)-1:] == 'd':
        c = -c
    return c 
```

# java - Javac 在 ant 构建中不起作用

> ID：11668970
> 
> 赞同：1
> 
> 时间：2012-07-26T12:09:00.903
> 
> 标签：java, ubuntu, ant, javac, build.xml

我尝试在 ubuntu 11.02 的命令行上的 ant build.xml 中运行 javac。然后运行“ant deploy-live”后，命令行打印如下：

```
Compile failed; see the compiler error output for details.
    at org.apache.tools.ant.taskdefs.Javac.compile(Javac.java:1150)
    at org.apache.tools.ant.taskdefs.Javac.execute(Javac.java:912)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:390)
    at org.apache.tools.ant.Target.performTasks(Target.java:411)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.helper.SingleCheckExecutor.executeTargets(SingleCheckExecutor.java:38)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.apache.tools.ant.taskdefs.Ant.execute(Ant.java:442)
    at org.apache.tools.ant.taskdefs.CallTarget.execute(CallTarget.java:105)
    at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
    at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
    at org.apache.tools.ant.Task.perform(Task.java:348)
    at org.apache.tools.ant.Target.execute(Target.java:390)
    at org.apache.tools.ant.Target.performTasks(Target.java:411)
    at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
    at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
    at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
    at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
    at org.apache.tools.ant.Main.runBuild(Main.java:809)
    at org.apache.tools.ant.Main.startAnt(Main.java:217)
    at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
    at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109) 
```

我关于 javac 的任务：

```
<javac deprecation="true"
               includeantruntime="false"
               debug="true"
               debuglevel="${debuglevel}"
               destdir="${project.build.outputpath}"
               verbose="true"
               encoding="UTF-8">
            <src path="${project.src.classes}" />
            <compilerarg value="-Xlint" />
            <classpath refid="core.classpath" />
</javac> 
```

**操作系统：** Ubuntu 11.10 (oneiric)

**Java 版本：** java 版本 "1.7.0" Java(TM) SE Runtime Environment (build 1.7.0-b147) Java HotSpot(TM) 64-Bit Server VM（build 21.0-b17，混合模式）

**Ant 版本：** 2011 年 8 月 19 日编译的 Apache Ant(TM) 版本 1.8.2

我尝试编码 build.xml 文件，但无法工作。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T12:12:41.930

首先你需要弄清楚错误细节

尝试运行并使用 -debug 或 -verbose 标志

[http://ant.apache.org/manual/running.html](http://ant.apache.org/manual/running.html) 影响 Ant 日志输出量的选项有： -quiet，指示 Ant 向控制台打印更少的信息；-verbose，使 Ant 将附加信息打印到控制台；和 -debug，这会导致 Ant 打印更多的附加信息。

并在此处提交错误详情以供后续分析...

# sql-server - 不停止更新生产 IIS 网站和 SQL Server 数据库

> ID：11668971
> 
> 赞同：8
> 
> 时间：2012-07-26T12:09:03.740
> 
> 标签：sql-server, iis, web-deployment, updating, continuous-deployment

有一个使用测试数据库的测试服务器。我们在测试服务器上测试网站。如果没问题，我们将网站和数据库模式从测试服务器更新到生产服务器。但是这种方法是非常痛苦和危险的。

首先，我们必须将用户重定向到维护页面，因此网站会暂停一段时间。

其次，如果更新时出现问题，我们必须回到旧网站，因为我们不能让网站长时间处于维护模式。

因此，我正在寻找一个可靠的解决方案来更新 IIS 网站和 Sql Server 数据库，而不会丢失数据并使用维护模式。有没有办法做到这一点？大型网站如何在不丢失数据和暂停的情况下做到这一点。

我们考虑过使用发布候选网站。我们计划暂时使用这个 RC 网站。首先，我们更新 RC 站点，然后交换 RC 和生产站点之间的绑定。但是这次数据库有问题。因为我们可以更改数据库架构，而旧的架构不能与新数据库一起使用。因此，如果我们使用带有 temp db 的临时站点，就会有数据丢失。此外，如果临时站点使用旧的生产数据库，则更新后的网站将无法使用旧数据库。所以我需要一个可靠而实用的解决方案来解决这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T11:15:13.287

这比你想象的要复杂几个数量级。这*与*HA 和连续集成无关。这些都不会提供您需要的东西，它们只是更复杂的难题的一部分。

根本不可能以对模式更改*发生时*透明/无视的方式编写代码更改。充其量您可以以支持 v. N 和 v. N+1 的模式的方式编写代码，这本身就是一个很大的挑战。*但是，当它*从 v. N 转换到 v. N+1时，不可能以支持模式的方式编写代码。对于在模式上运行的代码，部署引起的模式更改必须是原子的。由于架构更改本身不能是原子的，因此升级有两种可能的途径：

*   在架构更改期间使代码脱机。这就是您现在正在做的事情，也是最安全的方法。当然，这意味着服务可用性停机时间并运行您已经经历过的风险（升级失败的回滚、冗长的升级等）。这种方法的一个变体是将服务重定向到数据的只读副本，并提供降级的服务体验（在停机期间不可能进行任何更改），这可能会或可能不会接受，具体取决于业务细节。

*   待机升级。这意味着您拍摄服务数据的快照（各种 HA 解决方案可能会提供开箱即用的备用快照，例如日志传送）。升级快照，然后将真实服务数据上发生的所有事务应用到升级的快照。这总是很棘手，因为它需要一种技术来检测、捕获和应用更改（例如更改跟踪、复制、自定义解决方案等）*，并且*需要将每个更改转换为新的、升级的模式。一旦升级的模式与主服务的更改保持同步，服务就可以重定向到升级的模式。这种重定向也比听起来要复杂得多。对于一个选择何时切断旧模式并停止接受新更改的时刻，同时确保*所有*将更改应用于新升级的模式数据库本身就是一个挑战。另一个挑战是解决代码理解升级前和升级后模式版本的冲突。正如我所说，开发同时处理这两种情况的代码是有问题且容易出错的，因此一种解决方案是再次让服务在短时间内离线并替换代码。另一种解决方案是拥有一个备用*服务*，运行处理升级后数据库模式并连接到升级后数据库的代码，并将实时请求重定向到您的备用、升级服务。

当一个更大的部署解决方案的特定服务必须升级时，我什至没有触及服务交互这个棘手的话题。这是[服务 API 协议向后兼容性](http://www.amazon.co.uk/The-REST-Design-Handbook-ebook/dp/B00890OBFI)发挥主要作用的时候，它允许升级后的服务与其对等服务一起发挥作用。

最终没有任何灵丹妙药。我目睹了单机大型数据库部署需要*数周时间*才能推出版本 N+1，转录复制连续地为升级后数据库模式提供升级前数据库的更改。我目睹了数千台机器分阶段部署版本 N+1，这是一场复杂的舞蹈，需要在几天内更改代码和数据以实现升级后的全部功能。这个问题很**简单**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T01:11:56.640

这就是 Azure 的绝妙之处。Azure 云平台允许登台服务器和生产服务器。您可以对其进行设置，以便在将更改提交到 Git 或 TFS 后，它会自动推送到登台或生产服务器。您还可以设置为手动推送更改。大多数 ORM 库（如 Entity Framework）都支持迁移。

有关此主题的更多信息，例如： [当数据库架构更改](https://stackoverflow.com/questions/10597933/azure-seamless-upgrade-when-database-schema-changes) [暂存或生产实例时 Azure 无缝升级？](https://stackoverflow.com/questions/4328462/staging-or-production-instance)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-30T01:03:18.873

您正在描述一个高可用性解决方案 (HA)。HA 解决方案很昂贵，而且很快就会过大。您需要为您的应用程序和数据库服务器提供冗余，这意味着设置一个数据库集群。所有这些都会增加您部署更改所花费的时间，但代价是您的应用程序始终可用。

部署的主要内容是有一个可重复的过程。所以我最好的建议是尽可能地编写脚本或自动化。

# orchestration - 编排方法

> ID：11668977
> 
> 赞同：0
> 
> 时间：2012-07-26T12:09:21.627
> 
> 标签：orchestration

我感兴趣的职位发布要求“全面了解编排方法”。

是否有此类方法的公认清单？或者它是特定编排算法或属性（如同步/异步、事务性、长时间运行等）的另一个名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:16:24.733

编排是指“试图实现最大效果的事件安排”，意思是“完全了解编排方法”，他们想问您是否知道执行此类事件的方式，以产生他们想要的最大结果。

或者，这可能是 Web 服务编排的编程模型

# c# - 在 Winform 的 Devexpres 网格中选中 Uncheck Checkbox 列

> ID：11668980
> 
> 赞同：2
> 
> 时间：2012-07-26T12:09:35.113
> 
> 标签：c#, winforms, visual-studio-2010, devexpress

开发人员您好，我正在使用 VS 2010。我有一个 dev express 网格，其中有一个复选框列。问题是当我选中复选框时，它会被选中，但是当我移动到任何其他单元格或列时，复选框会自动取消选中。直到现在我的代码如下

```
 if (e.Column.ToString()=="Active" )
            {

                RepositoryItemCheckEdit edit = UserInfoGridView.GridControl.RepositoryItems.Add("CheckEdit") as RepositoryItemCheckEdit;

                column = e.Column;
                column.OptionsColumn.AllowSort = DevExpress.Utils.DefaultBoolean.False;
                column.Visible = true;
                column.VisibleIndex = 3;
                column.FieldName = "CheckMarkSelection";
                column.Caption = "Active";
                column.OptionsColumn.ShowCaption = true;
                column.OptionsColumn.AllowEdit = true;
                column.OptionsColumn.AllowSize = false;

                column.UnboundType = DevExpress.Data.UnboundColumnType.Boolean;

                column.ColumnEdit = edit;

            } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-27T11:19:59.480

好吧，我找到了答案…………我所做的是

```
 public frmLoad()
    {

        InitializeComponent();

        string DisplayQuery = "Select * from TableName";
         MasterDs = SqlHelper.ExecuteDataset(CommonClass.ConnectionString, CommandType.Text, DisplayQuery);
        MasterDs.Tables[0].Columns.Add("FLAG", typeof(string));

        MainGrid.DataSource = MasterDs.Tables[0];
        gridview.PopulateColumns();

        gridview.Columns["ID"].VisibleIndex = -1;
        gridview.Columns["FLAG"].VisibleIndex = -1;

        DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit selectnew = new DevExpress.XtraEditors.Repository.RepositoryItemCheckEdit();
        gridview.Columns["ColName"].ColumnEdit = selectnew;
        selectnew.NullText = "";
        selectnew.ValueChecked = "Y";
        selectnew.ValueUnchecked = "N";
        selectnew.ValueGrayed = "-";

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:21:04.120

这可能是因为在检查取消选中操作后未修改绑定网格的数据源。您是否处理`CellValueChanged`视图事件以更改 darasource 对象的属性值？

```
private void gridView1_CellValueChanged(object sender, CellValueChangedEventArgs e)
        {
            if (e.Column.Name != "Active")
                return;

            var person = gridView1.GetFocusedRow() as Person;
            person.Active = Convert.ToBoolean(e.Value);
        } 
```

或者，如果您使用 DataSet 作为网格的数据源：

```
var id = gridView1.GetFocusedRowCellValue("IdColumnName");
var active = gridView1.GetFocusedRowCellValue("ActiveColumnName");

NorthwindDataSet.PersonsRow PersonsRow = 
    northwindDataSet1.Persons.FindByPersonID(id);

PersonsRow.ACTIVE= Convert.ToBoolean(active); 
```

PS：未测试

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-22T07:19:13.697

试试这样的
字符串 DisplayQuery = "declare @Active bit; set @Active=0; select @Active as Active, * from TableName";

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-17T13:35:16.743

该问题可能是由列的不正确基础类型引起的：它应该是`bool`开箱即用的。

要设置类型，您可以尝试以下操作：

```
MasterDs.Tables[0].Columns[0].DataType = typeof(bool); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-27T01:50:54.110

我使用 Entity Framework 6.1 作为 ObjectContext 的后端。我已经将数据库类型设置为 tinyint，当实体框架更新类时它映射到字节。

将数据库类型更改为位并刷新实体对象会创建正确的布尔类型，之后复选框会正确显示在 DevExpress Winforms 中。

# ruby - 在 Ubuntu 11.10 上安装 watir-webdriver 时出错

> ID：11668983
> 
> 赞同：2
> 
> 时间：2012-07-26T12:09:37.997
> 
> 标签：ruby, watir, functional-testing, watir-webdriver

一步一步（正确安装 ruby​​ 和 ruby​​gems）安装 watir-webdriver 后，我面临以下错误：

```
ERROR:  Error installing watir-webdriver:
        ERROR: Failed to build gem native extension.

/usr/bin/ruby1.9.1 extconf.rb
<internal:lib/rubygems/custom_require>:29:in `require': no such file to load -- mkmf (LoadError)
        from <internal:lib/rubygems/custom_require>:29:in `require'
        from extconf.rb:4:in `<main>' 
```

请帮我解决这个问题，并让我知道是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T14:20:01.707

我不是 Linux/Ubuntu 专家，但错误消息说您没有安装构建工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-02T14:52:36.990

不确定如何在 Ubuntu 机器上安装 ruby​​，但我可以推荐 Ruby 版本管理器。

[https://rvm.io/](https://rvm.io/)

这将允许您在您的机器上安装不同版本的 ruby​​ 并在它们之间切换以及 gem 等。

这是我为通过 RVM 在 Ubuntu 中安装 watir webdriver 编写的快速指南：

Ubuntu 需要使用 Ruby 版本管理器。为此，我们需要先安装 Curl 包和 Git-core。

为此，请使用以下命令：

```
sudo apt-get install curl git-core 
```

成功后，我们需要下载 Ruby 版本管理器应用程序。这个应用程序允许我们安装多个版本的 ruby​​ 以及在它们之间切换。它还提供了一个宝石管理器。建议 Google 阅读 RVM 中的命令和功能。要安装 RVM，请使用以下命令：

```
bash -s stable < <(curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer ) 
```

我们还可以在 RVM 中安装包，我们将需要使用 openSSL：

```
rvm pkg install openssl 
```

然后安装 Ruby 本身：

```
rvm install 1.9.3-p125 --with-openssl-dir=$rvm_path/usr 
```

最好的测试这一切都在使用：

```
irb 
```

一切都清楚后，我们可以安装 Gem，我们需要在 RVM 中安装它，如下所示：

```
rvm do gem install watir-webdriver 
```

如果安装正确，我们应该能够使用 watir 来驱动已经安装在 ubuntu 上的 firefox。

# php - symfony2：更新数据错误

> ID：11668988
> 
> 赞同：0
> 
> 时间：2012-07-26T12:09:49.997
> 
> 标签：php, symfony, symfony-forms

我正在尝试使用表单更新数据库中的数据。

控制器是：

```
public function addAction($id) {

  $em = $this->getDoctrine()->getEntityManager();
  $product = $em->getRepository('AcmeStoreBundle:Product')->find($id);
  if (!$product) {
    $product = new Product();
  }
  $form = $this->createForm(new PageAdd(), $product);
  $request = $this->getRequest();

  if ($request->getMethod() == 'POST') {
     $form->bindRequest($request);

     $name=$this->get('request')->request->get('name');
     $price=$this->get('request')->request->get('price');
     $description=$this->get('request')->request->get('description'); 

     if ($form->isValid()) {
        $product->setName($name);
        $product->setPrice($price);
        $product->setDescription($description);    

        $em->persist($product);
        $em->flush();

        /*Llamando a la plantilla de listados*/
        $product = $em->getRepository('AcmeStoreBundle:Product')->findAll();

        /*Enviando los datos a la plantilla y Renderizandola*/
        return $this->render('AcmeStoreBundle:Default:pageadd.html.twig', array('Product' => $product));
     }
  }

  return $this->render('AcmeStoreBundle:Default:show.html.twig', array('form' => $form->createView(), 'product' => $product));
} 
```

文件`show.html.twig`是

```
<form action="{{ path('Product_add',{'id':product.id}) }}"
{{ form_enctype(form) }}>

            {{ form_errors(form) }}

            {{ form_rest(form) }}

               <input type="submit" value="Save This Page" class="savebutton" />

         </form> 
```

它给了我错误

> AcmeStoreBundle 中不存在对象“Acme\StoreBundle\Entity\Product”的方法“id”：默认值：show.html.twig 第 2 500 行内部服务器错误 - Twig_Error_Runtime

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:55:09.020

这意味着您的产品实体中缺少 getId() 方法。

```
public function getId()
{
  return $this->id;
} 
```

# objective-c - OSX AES 加密不工作

> ID：11668993
> 
> 赞同：0
> 
> 时间：2012-07-26T12:10:04.843
> 
> 标签：objective-c, encryption, osx-lion, aes

在我的应用程序中，我需要在通过网络发送之前加密文件，在另一端，它将被解密，这是我的代码，

```
-(void)doEncryptTest:(NSString *)pFileName{

    // read the NSData; 
    NSStringEncoding encoding  =NSUTF8StringEncoding;

    NSString *pFileContent = @"xaaaaaaxxaaaaaax";

    NSString *pKey = @"01234567012345670123456701234567";

    NSData *pData = [pFileContent dataUsingEncoding:encoding];

    NSData *pEncryptedData = [pData AES256EncryptWithKey:pKey];

    NSData *decrypted=[pEncryptedData AES256DecryptWithKey:pKey Data:pEncryptedData];

    NSString* pDecryptedDataStr = [[NSString alloc] initWithData:decrypted
                                                      encoding:encoding];

} 
```

这工作正常，仅当数据大小为 16 字节时，在实时情况下，当我发送大小为 151186 字节的文件时，[pEncryptedData] 的大小为 15200，实际上解密数据的大小与原始数据相同, 但是 pDecryptedDataStr 是空白的，猜猜怎么回事，请参考下面，加解密函数，

```
int keySize = kCCKeySizeAES256;
int padding = kCCOptionPKCS7Padding;
char ivKey[16]={0,0,0,0,
             0,0,0,0,
             0,0,0,0,
             0,0,0,0};
//////////////*Encryption*///////////////////
- (NSData *)AES256EncryptWithKey:(NSString *)key{
    // 'key' should be 32 bytes for AES256, will be null-padded otherwise
    char keyPtr[keySize + 1]; // room for terminator (unused)
    bzero( keyPtr, sizeof( keyPtr ) ); // fill with zeroes (for padding)

    // fetch key data
    [key getCString:keyPtr maxLength:sizeof( keyPtr ) encoding:NSUTF8StringEncoding];

    NSUInteger dataLength = [self length];

    //See the doc: For block ciphers, the output size will always be less than or 
    //equal to the input size plus the size of one block.
    //That's why we need to add the size of one block here
    size_t bufferSize = dataLength + kCCBlockSizeAES128;
    void *buffer = malloc( bufferSize );
    char ivVector[kCCBlockSizeAES128+1];
    // fetch key data
    [key getCString:ivVector maxLength:sizeof( ivVector ) encoding:NSUTF8StringEncoding];

    bzero( ivVector, sizeof( ivVector ) ); // fill with zeroes (for padding)

    const void *iv=NULL;
    size_t numBytesEncrypted = 0;

    CCCryptorStatus cryptStatus = CCCrypt( kCCEncrypt, kCCAlgorithmAES128, padding,
                                          keyPtr, keySize,
                                          ivKey /* initialization vector (optional) */,
                                          [self bytes], dataLength, /* input */
                                          buffer, bufferSize, /* output */
                                          &numBytesEncrypted );
    if( cryptStatus == kCCSuccess )
    {
        //the returned NSData takes ownership of the buffer and will free it on deallocation
        return [NSData dataWithBytesNoCopy:buffer length:numBytesEncrypted];
    }

    free( buffer ); //free the buffer
    return nil;
}

- (NSData *)AES256DecryptWithKey:(NSString *)key   Data:(NSData*)EncryptedData{
    bool same =[self isEqualToData:EncryptedData];

    // 'key' should be 32 bytes for AES256, will be null-padded otherwise
    char keyPtr[keySize+1]; // room for terminator (unused)
    bzero( keyPtr, sizeof( keyPtr ) ); // fill with zeroes (for padding)

    // fetch key data
    [key getCString:keyPtr maxLength:sizeof( keyPtr ) encoding:NSUTF8StringEncoding];

    NSUInteger dataLength = [EncryptedData length];

    //See the doc: For block ciphers, the output size will always be less than or 
    //equal to the input size plus the size of one block.
    //That's why we need to add the size of one block here
    size_t bufferSize = dataLength +kCCBlockSizeAES128;
    void *buffer = malloc( bufferSize );
    const void *iv=NULL;
    char ivVector[kCCBlockSizeAES128+1];
    // fetch key data
    [key getCString:ivVector maxLength:sizeof( ivVector ) encoding:NSUTF8StringEncoding];

    bzero( ivVector, sizeof( ivVector ) ); // fill with zeroes (for padding)

    size_t numBytesDecrypted = 0;
    NSData *output_decrypt = [[NSData alloc] init];
    CCCryptorStatus cryptStatus = CCCrypt( kCCDecrypt, kCCAlgorithmAES128, padding,
                                          keyPtr, keySize,
                                          ivKey /* initialization vector (optional) */,
                                          [EncryptedData bytes], dataLength, /* input */
                                          buffer,bufferSize ,//bufferSize, /* output */
                                          &numBytesDecrypted );
    output_decrypt = [NSMutableData dataWithBytesNoCopy:buffer length:numBytesDecrypted];
    same =[self isEqualToData:output_decrypt];
    if( cryptStatus == kCCSuccess )
    {
        //the returned NSData takes ownership of the buffer and will free it on deallocation

        NSData *pData = [[NSData alloc]initWithBytes:buffer length:numBytesDecrypted];

        return pData;

    }

    free( buffer ); //free the buffer
    return nil;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-31T10:52:39.327

谢谢你看这个，这是问题，

```
output_decrypt = [NSMutableData dataWithBytesNoCopy:buffer length:numBytesDecrypted];
    same =[self isEqualToData:output_decrypt];
    if( cryptStatus == kCCSuccess )
    {
        //the returned NSData takes ownership of the buffer and will free it on deallocation

        **NSData *pData = [[NSData alloc]initWithBytes:buffer length:numBytesDecrypted];**

        return pData;

    } 
```

解决方案是；

```
output_decrypt = [NSMutableData dataWithBytesNoCopy:buffer length:numBytesDecrypted];
    same =[self isEqualToData:output_decrypt];
    if( cryptStatus == kCCSuccess )
    {
        //the returned NSData takes ownership of the buffer and will free it on deallocation

        return output_decrypt;

    } 
```

不知道为什么会导致问题，当然我需要更改返回类型并在调用函数中进行一些处理以释放内存。

# ruby-on-rails - 在 Rspec 中使用数据库查询好吗？

> ID：11668995
> 
> 赞同：3
> 
> 时间：2012-07-26T12:10:10.683
> 
> 标签：ruby-on-rails, rspec, mocking, stubbing

我已经开始使用 Rspec 为一个非常古老的项目编写测试。我正在测试的模型都是 ActiveRecords（后端是 Oracle）。我读过一些博客说我们应该使用模拟和存根/夹具/工厂女孩而不是触发实际的 sql。我很困惑。我将不得不存根很多方法并创建很多对象。这是一个好习惯吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-26T12:46:08.817

当您测试模型时，最好让您的测试与数据库集成。也就是说，不要试图模拟 ActiveRecord 的东西，而只需使用模型对象。FactoryGirl 和 Fabrication 都是构建真实模型对象的便捷捷径，它们是测试 ActiveRecord 模型的最佳实践。

由于这是遗留代码，我建议不要在旧代码中过多地模拟或存根，因为只有在单独测试每个组件时，隔离才有效。

然而，当使用 TDD 编写代码时，模拟和存根有很多好处：

*   为您提供细粒度的测试（如果方法中断，您的测试会告诉您是哪一个）
*   您的测试运行得更快，因此您的 TDD 周期更短
*   让您断言您的代码如何与其他对象交互
*   如果您必须过度存根和模拟其他模型以隔离一个模型，这通常是一个好兆头，表明您的代码耦合度太高，值得重构

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-26T12:27:09.223

通常你会使用存根，然后你可以在不加载 AR 的情况下运行测试，它们会运行得更快。

我个人认为测试假数据不是测试……也许在做TDD的开发环境中……也许……但是对于测试环境，它应该尽可能接近真实的东西。

这当然是我的观点，可能不是当前的思想流派。