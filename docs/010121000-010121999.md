# StackOverflow 问答 10121000-10121999

# jsp - 指定我的 Java Web 应用程序的 Servlet 和 JSP 版本

> ID：10121002
> 
> 赞同：3
> 
> 时间：2012-04-12T09:33:56.963
> 
> 标签：jsp, web-applications, servlets

“web-app_*.dtd”参考 web.xml 是否确定了 Web 应用程序中使用的 Servlet 和 JSP 版本？

不知怎的，我一直有这样的印象，但似乎我错了。我有一个 web.xml 指定的应用程序

```
<!DOCTYPE web-app PUBLIC
    "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
    "http://java.sun.com/dtd/web-app_2_3.dtd"> 
```

我在想它应该使用 Servlet 2.3 版。但是，当我将以下代码放入我的 JSP 中时，我得到了一个完全不同的版本。

```
<div>
Server info: <%= application.getServerInfo() %><br>  
Servlet version: <%= application.getMajorVersion() %>.<%= application.getMinorVersion() %>  
JSP version: <%= JspFactory.getDefaultFactory().getEngineInfo().getSpecificationVersion() %><br> 
</div> 
```

**输出：**

```
Server info: Apache Tomcat/7.0.21
Servlet version: 3.0
JSP version: 2.1 
```

我将感谢一些相关问题的帮助：。

*   dtd 版本是否与应用程序中使用的 Servlet 和 JSP 版本有任何关系？
*   我的应用程序是否使用 Servlet 3.0 版，因为这是 Apache Tomcat 7 使用的默认版本？
*   有没有办法让 Tomcat 7 使用旧的 Servlet JSP 版本？
*   [此页面](http://www.coderanch.com/t/425693/java-Web-Component-SCWCD/certification/know-which-servlet-jsp-version)上的一条评论（由 Bauke Scholtz 撰写）似乎表明每个 Servlet 版本都与 JSP 版本相关联。这总是真的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:51:59.670

**dtd 版本是否与应用程序中使用的 Servlet 和 JSP 版本有任何关系？**

是的，它告诉服务器应用程序是在哪个版本中开发的。

**我的应用程序是否使用 Servlet 3.0 版，因为这是 Apache Tomcat 7 使用的默认版本？**

不，服务器可以支持 3.0 并不意味着您的应用程序使用 3.0 因为您的应用程序是 servlet 2.5，所以 servlet 3.0 的功能将为您禁用。

**有没有办法让 Tomcat 7 使用旧的 Servlet JSP 版本？**

是的。第一个问题的答案，你的 web.xml

**此页面上的一条评论（由 Bauke Scholtz 撰写）似乎表明每个 Servlet 版本都与 JSP 版本相关联。这总是真的吗？**

大部分是的。它不是紧密耦合的。但是每个服务器都遵循 JavaEE 标准，每个 JavaEE 标准都应该确认一些规范及其版本。例如，JavaEE 5 需要 Servlet 2.5 和 JSP 2.1，JavaEE 6 需要 Servlet 3.0 和 JSP2.2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T09:50:00.900

> dtd 版本是否与应用程序中使用的 Servlet 和 JSP 版本有任何关系？

是的。

> 我的应用程序是否使用 Servlet 3.0 版，因为这是 Apache Tomcat 7 使用的默认版本？

是的。

> 有没有办法让 Tomcat 7 使用旧的 Servlet JSP 版本？

不，您需要获得早期版本的 Tomcat。

> 此页面上的一条评论（由 Bauke Scholtz 撰写）似乎表明每个 Servlet 版本都与 JSP 版本相关联。这总是真的吗？

是的。

# mysql - 将`show create procedure procedure_name`的结果存储到MySql中的一个变量中

> ID：10121006
> 
> 赞同：1
> 
> 时间：2012-04-12T09:34:19.303
> 
> 标签：mysql, stored-procedures

我想通过使用命令获取用于创建现有过程的代码 `show create procedure` ，然后将其存储在变量中。这一切都在一个程序内。

### 问题

*   `Set @var`仅当结果包含一行和一列时，创建用户定义的变量才有效。
*   `show create procedure proc_name`返回多列，我无法选择特定的列`Create Function`

### 问题

如何将用于创建过程的代码保存到变量中以供以后使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T09:55:05.000

您可以使用 information_schema 数据库中的routines 表。

```
select
routine_definition
from
information_schema.routines
where
specific_name = 'nameOfYourStoredProcedure' 
```

有关更多信息，请参阅此[链接。](http://dev.mysql.com/doc/refman/5.0/en/routines-table.html)

更新：

然后，您将不得不自己构建它。没有别的办法。

```
select
CONCAT('CREATE PROCEDURE nameOfYourStoredProcedure ', routine_definition, 'END') /*something like that, this here is pseudo-code*/
from
information_schema.routines
where
specific_name = 'nameOfYourStoredProcedure' 
```

更新 2：

考虑到 Devart 的评论，您还必须使用 information_schema 数据库中的参数表。

注意：此表是在 MySQL 5.5.3 中添加的

有关更多信息，请查看[此处。](http://dev.mysql.com/doc/refman/5.5/en/parameters-table.html)

老实说，我不知道有任何其他方法可以解决这个问题。我也不能在这里更新到 5.5.3 来帮助你。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-07T09:00:16.473

下面的代码片段应该适用于大多数情况，我开始研究它希望它足够简单。但是有很多问题需要解决，也有例外。

我想使用 SHOW CREATE / MySQLDump 仍然是一个更好的解决方案（即使它不允许将响应读取到变量中）。

```
SELECT 
CONCAT_WS(' ',
        'DELIMITER $$\n',
        'CREATE ',
        CONCAT_WS('=',r.SECURITY_TYPE,CONCAT_WS('@',CONCAT('`',SUBSTRING_INDEX(r.`definer`,'@',1),'`'),CONCAT('`',SUBSTRING_INDEX(r.`definer`,'@',-1),'`'))),
        '\n',
        r.ROUTINE_TYPE,
        CONCAT_WS('.', ROUTINE_SCHEMA, ROUTINE_NAME),
        CONCAT('(',GROUP_CONCAT(CONCAT_WS(' ', p.PARAMETER_NAME, p.DTD_IDENTIFIER)),')'),
        IF(o_p.DTD_IDENTIFIER is not null,CONCAT('RETURNS ',o_p.DTD_IDENTIFIER),''),
        ROUTINE_DEFINITION,
        '$$') stmt_ 
```

FROM information_schema.routines r LEFT JOIN information_schema.parameters p ON p.SPECIFIC_SCHEMA = r.routine_schema AND p.specific_name = r.routine_name AND p.PARAMETER_MODE = 'IN' LEFT JOIN information_schema.parameters o_p ON o_p.SPECIFIC_SCHEMA = r.routine_schema AND o_p.specific_name = r.routine_name AND o_p.PARAMETER_MODE 为空，其中 ROUTINE_SCHEMA IN ('_secured' , 'tester') GROUP BY CONCAT_WS('.', ROUTINE_SCHEMA, ROUTINE_NAME)

# delphi - 如何将 20 个形状连接到单个“OnMouseDown”？

> ID：10121009
> 
> 赞同：2
> 
> 时间：2012-04-12T09:34:31.143
> 
> 标签：delphi

我有一个 Delphi 程序，其中包含以下代码：

```
procedure TForm1.Shape1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  <code here>
end; 
```

问题是，我希望所有 20 种形状都使用完全相同的代码。我如何有效地做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T09:36:55.953

1.  使用多选（例如`SHIFT+CLICK`，或单击并拖动选择矩形）选择所有 20 个形状。
2.  在 Object Inspector 中，将`OnMouseDown`事件处理程序设置为公共事件处理程序。这将为所有 20 个选定的形状分配相同的事件处理程序。
3.  如果您需要知道从公共事件处理程序中单击了哪个形状，请使用`(Sender as TShape)`.

# javascript - html5图片裁剪

> ID：10121011
> 
> 赞同：7
> 
> 时间：2012-04-12T09:34:31.850
> 
> 标签：javascript, html, canvas

我正在使用[上下文混合器](https://github.com/Phrogz/context-blender)对具有固定颜色的 html 背景图像的前 192 个像素应用乘法效果，以在页面标题上实现透明效果。

在 html 上，我有 2 个画布。一个用于应用乘法效果的图像部分，一个用于颜色。

在 javascript 上，将颜色画布的颜色和两个画布的宽度设置为 window.innerWidth 后，我得到的背景图像是：

```
imageObj.src = $('html').css('background-image').replace(/^url|[\(\)]/g, ''); 
```

现在问题来了。我想将裁剪后的图像绘制到图像画布上，这样我就可以应用乘法效果。我正在尝试执行以下操作：

```
imageObj.onload = function(){
    // getting the background-image height
    var imageHeight = window.innerWidth * imageObj.height / imageObj.width;

    // get the corresponding pixels of the source image that correspond to the first 192 pixels of the background-image
    var croppedHeight = 192 * imageObj.height / imageHeight;

    // draw the image to the canvas
    imageCanvas.drawImage(imageObj, 0, 0, imageObj.width, croppedHeight, 0, 0, window.innerWidth, 192);

    // apply the multiply effect
    colorCanvas.blendOnto( imageCanvas, 'multiply');
} 
```

但是我做错了得到裁剪的高度。

例如：对于 1536x1152 图像和 1293x679 浏览器容器，我得到的源裁剪高度值为 230，但要获得正确的裁剪，我需要使用 296 左右的值。

**编辑：**

我正在使用 background-size: 覆盖 css 来创建背景图像

**编辑2：**

我创建了一个[小提琴](http://jsfiddle.net/254ck/4/)来说明这个问题。如果您取消注释该行`//cHeight *= magicConstant;`，裁剪后的图像看起来会好很多，但事情就没有意义了。我删除了提琴手的乘法效果，但这并不是重现问题所必需的。我还注意到，如果我从 URL 中删除第二个画布，行为会发生变化。

顺便说一句，这种行为发生在 google chrome 上，但我认为同样的事情也发生在 safari 和 firefox 上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T03:43:45.373

好的，我已经修好了。男人就是这么难！主要是因为你忘了设置 imageCanvas 的画布高度。图像有白色边框也无济于事。我花了很多时间试图弄清楚填充的来源。

所以首先，对于[fiddle](http://jsfiddle.net/254ck/4/)的情况，在 function 中`doBlending()`，设置`imageCanvas.canvas.height = height;`

那么`crop()`需要的计算涵盖2种可能性。图像是按高度缩放并在左侧截断，还是按宽度缩放并在底部截断？我不会为你写这两个，但这是一个针对高度缩放的情况：

```
function crop(imageObj, imageCanvas, colorCanvas) {
    // Assumes bg image is scaled for hight
    var scale = imageObj.height / window.innerHeight; 
    var targetHeight = imageCanvas.canvas.height;
    var targetWidth = window.innerWidth;

    imageCanvas.drawImage(imageObj, 
                          0, 0, targetWidth * scale, targetHeight * scale,
                          0, 0, targetWidth, targetHeight);
} 
```

我真的不知道你在你的例子中从哪里想出了比例因子。将通过将 x 和 y 维度乘以某个比例因子来缩放图像。这就是你如何保持纵横比。比例因子将是使图像的高度与窗口的高度匹配的比例因子和使图像的宽度与窗口的宽度匹配的比例因子中的较大者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T03:24:52.403

我认为在这里使用窗口内部尺寸可能对您无效。由于封面将保持背景图像的纵横比，这意味着它的两个尺寸可能都不会完全显示。因此，如果您尝试在纵横比之间进行转换以确定剪辑的位置，则必须考虑图像可能会流出窗口边界的事实。

# windows-phone-7 - 错误部分 xaml WP7

> ID：10121012
> 
> 赞同：-3
> 
> 时间：2012-04-12T09:34:34.160
> 
> 标签：windows-phone-7, xaml

![在此处输入图像描述](../Images/f2594e73123fb3821d3076eb054c2780.png)

我收到此错误，我尝试通过修改 namspace 的名称将旧项目复制到另一个

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:42:54.630

该错误表明您有另一个文件，其中该类的部分定义共享不同的基类。找到这个其他部分定义并解决。

# delphi - 如何影响 URL 以访问已注册的 Delphi WebService

> ID：10121014
> 
> 赞同：7
> 
> 时间：2012-04-12T09:34:37.457
> 
> 标签：delphi, soap, delphi-xe2

我们用 Delphi XE2 编写了一个 webservice dll，它在我们的 IIS7 服务器上运行，可以通过 url [http://server/webservice.dll/soap访问](http://server/webservice.dll/soap)

为了能够调试服务，我创建了一个webservice.exe项目，可以在Delphi的WebAppDebugger中运行。现在问题出现了，在调试器中运行的 web 服务可以通过 url [http://localhost/webservice.webservice/soap访问](http://localhost/webservice.webservice/soap)

我们的客户端应用程序具有硬编码的 url “webservice.dll/soap”的最后一部分（安全原因），所以我无法在使用我们的客户端应用程序进行测试时更改它，服务器地址部分“ [http://server/](http://server/) ”可配置为客户端。

所以，我的问题是：如何在我的 webappdebugger 中注册调试服务以使用像我的生产 dll 这样的 url？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T10:12:07.330

我自己找到了解决方案;-)

在调试表单的初始化中有以下行：

TWebAppSockObjectFactory.Create('Webservice');

将其更改为：

TWebAppSockObjectFactory.Create('dll');

将整体地址更改为[http://localhost/Webservice.dll/](http://localhost/Webservice.dll/)

这确实留下了一个小问题，即调试器项目必须重命名为 Webservice.exe 而不是 WebserverDebug.exe，因为它被称为，但是将它移动到子文件夹使得这个重命名成为可能。

# drupal-7 - 使用 Drupal 7 中的规则从节点字段填写表单字段

> ID：10121016
> 
> 赞同：1
> 
> 时间：2012-04-12T09:34:49.697
> 
> 标签：drupal-7, entity, drupal-modules, drupal-rules

一旦客户填写了他的税号（或其他可配置字段），我正在寻找一种方法来**填充**（实体）表单中的某些**字段（例如姓名和电子邮件）。**与之比较的字段位于另一个节点或实体中。

**例如：**

> 一个事件的注册表=> 用户注册时：检查填写的税号是否已经存在于节点“去年参加者”之一中。如果找到匹配项，它会在节点的“名称”字段中获取日期，并将其放入表单的“名称”字段中（在下一步中，见下文）

对于我使用 EntityForms-module 的表单（它创建一个包含实体字段的表单，因此用户可以创建新的实体对象）和一个允许我分多个步骤浏览表单的自定义模块，一个规则事件是单击表单步骤中的“继续”按钮时触发。

我启用了规则和规则表单支持，我尝试制定规则：

*   事件：单击了我的自定义继续按钮
*   条件：从表单中的（待选择）字段输入的日期已经存在于（待选择）节点的字段中
*   动作：将节点中的（待选择）字段放入表单的（待选择）字段中

我不能对此进行硬编码，因为它必须是可配置的（必须制作多种不同的形式..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:01:50.170

您可以通过 URL 中的值来执行此操作。结帐预填充模块[http://drupal.org/project/prepopulate](http://drupal.org/project/prepopulate)

Drupal 7 有一个开发版本。

您应该在规则的 URL 中添加额外的信息。

# sql - 如何重用大型动态查询而不重复？

> ID：10121028
> 
> 赞同：1
> 
> 时间：2012-04-12T09:36:02.610
> 
> 标签：sql, oracle, plsql, reusability

我有一个参数化（动态）查询，我想在 oracle 过程中重用（如果可能的话，甚至在 oracle 包中），如下所示：

```
cursor q (p1 integer, p2 integer, p3 ...) as
select .... from .... where col1 = p1 and col2 = p2 and .... 
```

然后在后续查询中执行类似的操作

```
select ... 
from t1, t2, ..., q (a, b, c)
where q.c1 = t1.tc1
and q.c2 = t2.tc2
....

select ... 
from n1, n2, ..., q (a, b, c)
where q.c1 = n1.tc1
and q.c2 = n2.tc2
.... 
```

如果查询是静态的，我已经使用了 VIEWS 但它不是.. 还有其他更简单的方法而不是填充和使用大量额外的对象吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T09:54:23.270

您可以尝试使用[AskTom 此处](http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:1448404423206)描述的“参数化视图”方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T11:12:09.787

要创建一种参数化视图，您可以使用流水线函数，正如我在上一篇文章中详述的[那样](https://stackoverflow.com/questions/7562665/calling-oracle-stored-procedures-in-r-how-to-get-the-result-set/9176817#9176817)。流水线函数的使用有其局限性，但 Oracle 不断地增加它们的功能（例如函数缓存和并行执行）。

有关更多示例，请参阅此处以获取带有示例的[好文章](http://www.oracle-base.com/articles/misc/pipelined-table-functions.php)。

当然，请务必根据您的情况测试它们的性能。我个人不会疯狂地创建大量函数来代替简单的 SQL，但它们有自己的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T11:28:57.140

您可以在包中定义参数化光标，然后从您需要的任何地方引用它。

[http://docs.oracle.com/cd/B14117_01/appdev.101/b10807/09_packs.htm#i7454](http://docs.oracle.com/cd/B14117_01/appdev.101/b10807/09_packs.htm#i7454)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T10:50:21.763

我可能遗漏了一些东西，但为什么不将视图创建为：

```
create view q as
select .... from .... 
```

即在 WHERE 子句中没有 3 个参数 ( `where col1 = p1 and col2 = p2 and col3 = p3`)

然后在使用视图时应用 3 个“参数”：

```
select ... 
from t1, t2, ..., q
where q.c1 = t1.tc1
and q.c2 = t2.tc2
and col1 = p1 and col2 = p2 and col3 = p3
....

select ... 
from n1, n2, ..., q
where q.c1 = n1.tc1
and q.c2 = n2.tc2
and col1 = p1 and col2 = p2 and col3 = p3
.... 
```

# actionscript-3 - GUI - 调用设置器或调度事件？

> ID：10121031
> 
> 赞同：0
> 
> 时间：2012-04-12T09:36:14.933
> 
> 标签：actionscript-3, oop, design-patterns

我正在开发一个先进的模块化 GUI 系统。我需要它尽可能灵活，并希望对尽可能多的人有用（但是它将是合理的利基）。

我的设计中让我思考的部分是每个组件应该如何最好地与应用程序的其余部分交互。

我看到两种方法：

1.  传入一个 setter 的类和名称，组件应该对其进行操作。如果需要，这仍然允许从 setter 内分派事件。
2.  传入组件应调度的 CustomEvent 以及相关数据。虽然我觉得这可能会导致大量的事件监听器，以及额外的复杂性。

**但是什么是最佳实践？各自的优缺点是什么？有没有更好的方法？**

1.  基本示例：

    ```
    public class Button extends Sprite
    {
    private var _property:String;
    private var _object:*;

    public function Button(label:String, object:*, property:String) 
    { 
        _property = property;
        _object = object;
        addEventListener(MouseEvent.CLICK,  onClick);
    } 

    private function onClick(e:MouseEvent):void
    {
        _object[_property] = "Changed";
    }

    } 
    ```

2.  基本示例：

    ```
    public class Button extends Sprite
    {
    private var _event:GuiEvent;

    public function Button(label:String, event:GuiEvent) 
    {
        _event = event;
        addEventListener(MouseEvent.CLICK,  onClick);
    }

    private function onClick(e:MouseEvent):void
    {
        dispatchEvent(new GuiEvent(_event.type, "Changed"));
    }

    } 
    ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:51:08.840

如果您希望您的 GUI 框架对所有人有用，您应该使用标准事件而不是发明新事件。第二种选择是要走的路，但你应该尽量保持简单。您在示例 2 中编写的代码看起来非常复杂。它可以简单地写成这样：

```
public class Button extends Sprite
{

    public function Button(label:String) 
    {
    }

} 
```

然后任何人都可以使用他们知道的事件来处理点击：

```
button.addEventListener(MouseEvent.CLICK, onClick); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T11:57:36.270

*有点题外话，并不能真正回答您的问题：*

为什么要重新创建已经存在的东西？已经有经过验证的带有 GUI 组件的库。

例如，以 AS3 Temple Library
[http://code.google.com/p/templelibrary/](http://code.google.com/p/templelibrary/)

它具有所有类型的表单元素组件；复选框、单选按钮、组合框、输入字段、文件字段、滚动组件、日期选择器、（步骤）滑块、列表、滚动条、自动完成字段和所有类型的按钮。它还有一个 Form 类，它有助于验证，将数据传递给任何类型的服务。它还可以正确管理 tabindexes，所有控件也可以与键盘一起使用，就像每个人都希望它工作一样。还有用于样机的代码组件，但您可以使用相同的代码通过库项目、时间线或任何您想要的方式对其进行样式设置，并具有无穷无尽的创造力。大多数 gui 组件都经过设计，因此可以对其进行扩展以满足您的需求。

大多数 gui 组件都使用普通的事件监听器（大多数在内容更改时调度 Event.CHANGE），在大多数情况下，不需要将其包装到新类型的事件中。

# php - Symfony 2：EntityManager::flush 上的错误消息“ArrayCollection::__construct() must be an array, object given”

> ID：10121033
> 
> 赞同：1
> 
> 时间：2012-04-12T09:36:34.410
> 
> 标签：php, symfony, doctrine-orm

我正在尝试更新特定实体（主实体）的实体集合（子实体）的位置。一切正常，直到方法执行刷新指令将更新推送到数据库。

错误消息是：

```
Catchable Fatal Error: Argument 1 passed to Doctrine\Common\Collections\ArrayCollection::__construct() must be an array, object given, called in \vendor\doctrine\lib\Doctrine\ORM\UnitOfWork.php on line 426 and defined in \vendor\doctrine-common\lib\Doctrine\Common\Collections\ArrayCollection.php line 46 
```

控制器方法是：

```
public function layoutAction($id, $entity, $subentity)
{
    //-- Get Repository for master entity class
    $object  = $this->getRepository($entity)->find($id);
    $em = $this->getDoctrine()->getEntityManager();     

    //-- Get form datas
    $datas = $this->get('request')->get('items', array());

    //-- Update position for each msater entity childs of given subentity
    $method = "get" . ucfirst($subentity) . "s";        
    foreach($object->$method() as $item){
        $item->setPosition(array_search($item->getId(), $datas));
        $em->persist($item);            
    }

    //-- Push updates
    $em->flush();

    //-- Notification + Redirection
    ...
} 
```

主实体与子实体是一对多的关系，子实体与主实体是一对一的关系。下面的示例声明：

主实体：

```
<one-to-many field="subentities" target-entity="Subentity" mapped-by="masterentity" /> 
```

子实体：

```
<one-to-one field="masterentity" target-entity="MasterEntity" inversed-by="subentities">
    <join-column name="idMaster" referenced-column-name="idMaster" />
</one-to-one> 
```

我不明白为什么会触发此错误，但我相信它来自关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:49:15.063

你的地图很混乱。如果您定义**了一个**Masterentity 有**许多**子实体，那么`Subentity::masterentity`您应该设置反向关系：**多对一**而不是一对一。

# jquery-ui - 为什么当我使用多个选择菜单时我的更改功能在 jquerymobile 中不起作用

> ID：10121035
> 
> 赞同：0
> 
> 时间：2012-04-12T09:36:39.207
> 
> 标签：jquery-ui, jquery-mobile, jquery-selectors

```
<select name="select-choice-1" id="select-choice-1" data-native-menu = false multiple=true>
<option value="standard">Standard: 7 day</option>
<option value="rush">Rush: 3 days</option>
</select>

$("#select-choice-1").selectmenu({
    change: function() {
        DataObj.GetJson(DataObj.GetRequestUrl("InitData","sessionKey="+ DataObj.sessionKey),"InitData");
    }
}); 
```

这就是我上面关于选择更改的所有代码。但是当我更改所选菜单时它不起作用。我不知道它是怎么发生的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:26:00.163

试试这个：

```
$("#select-choice-1").selectmenu();
$("#select-choice-1").bind( "change", function(event, ui) {
        DataObj.GetJson(DataObj.GetRequestUrl("InitData","sessionKey="+ DataObj.sessionKey),"InitData");
}); 
```

# c# - 安装应用更新时应用丢失所有设置

> ID：10121044
> 
> 赞同：6
> 
> 时间：2012-04-12T09:37:10.067
> 
> 标签：c#, windows-phone-7, isolatedstorage, appsettings

这是仅对某些用户发生的问题。每当我在 Marketplace 中发布我的应用程序的新版本时，我都会收到来自用户的电子邮件，说应用程序中的所有设置都已丢失。

我自己无法重现这一点，而且我没有可以擦除 IsolatedStorage 的代码。

如果有人知道可能导致这种情况的原因，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:07:51.267

**更新：**不确定以下内容是否适用于 WP7 应用程序 - 我将把它留在这里以防万一。我只为普通应用程序尝试过这个。

您将需要“升级”旧的设置文件。

您还需要知道何时需要执行此操作（即仅在安装新版本时）。

要知道何时需要升级设置，请在设置中添加一个名为（例如）NeedSettingsUpgrade 的布尔值，并将其默认为 true。

然后在 Main() 开始附近的某处调用以下函数：

```
/// <summary>Upgrades the application settings, if required.</summary>
private static void upgradeApplicationSettingsIfNecessary()
{
    // Application settings are stored in a subfolder named after the full #.#.#.# version number of the program. This means that when a new version of the program is installed, the old settings will not be available.
    // Fortunately, there's a method called Upgrade() that you can call to upgrade the settings from the old to the new folder.
    // We control when to do this by having a boolean setting called 'NeedSettingsUpgrade' which is defaulted to true. Therefore, the first time a new version of this program is run, it will have its default value of true.
    // This will cause the code below to call "Upgrade()" which copies the old settings to the new.
    // It then sets "NeedSettingsUpgrade" to false so the upgrade won't be done the next time.

    if (Settings.Default.NeedSettingsUpgrade)
    {
        Settings.Default.Upgrade();
        Settings.Default.NeedSettingsUpgrade = false;
    }
} 
```

注意：您当然需要`Settings.Default.Save()`在程序退出之前调用，否则设置更改将不会保留。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:31:26.560

我的方法是使用程序集版本号作为升级的触发器。在第一次运行时，它以 v1.0 和程序集版本号 1.0.0.0 所需的格式保存设置。当升级发生时，它将保存的设置编号 (1.0.0.0) 与升级后的装配编号 1.1.0.0 进行比较，并决定需要升级。

我发现重新部署Visual Studio并不能保证升级，有时它会卸载，重新安装，效果不佳。所以我改用[Windows Phone Powertools](http://wptools.codeplex.com/)来测试我的“升级”路径，因为它似乎可以可靠地进行升级。

# iphone - TableView 变成 tabBarController

> ID：10121050
> 
> 赞同：2
> 
> 时间：2012-04-12T09:37:33.747
> 
> 标签：iphone, ios, uitableview

我开始了一个选项卡式应用程序项目，在我的第一个视图中，我想获得一个填充列表，所以我声明了一个 NSArray，如下所示：

```
@interface agrospineFirstViewController : UIViewController <UITableViewDelegate     ,UITableViewDataSource>
{
NSArray  *JournalList;
}
@property (nonatomic,retain) NSArray *JournalList;
@end 
```

我在 .m 上添加了以下内容：

[超级视图DidLoad];

```
//initialisation de la liste
JournalList = [NSArray arrayWithObjects:@"journal1",@"journal2",nil];

//initialisation du table View 
UITableView* tableView=[[UITableView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]style:UITableViewStylePlain];

//population de la vue

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [JournalList count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *MyIdentifier = @"MyIdentifier";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:MyIdentifier];

if (cell == nil)

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:MyIdentifier];

// Configuration de la cellule

NSString *cellValue = [JournalList objectAtIndex:indexPath.row];
cell.textLabel.text = cellValue;
return cell;

} 
```

我也将表格列表放入视图中......但仍然在 numberOfRowsInSection 上显示错误，要求将“：”替换为“；” 有什么帮助建议可以改进吗？

感谢您的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T09:45:06.033

我认为您还没有像这样关闭**viewDidLoad**方法：

```
- (void)viewDidLoad {
  [super viewDidLoad];

  //initialisation de la liste
  JournalList = [NSArray arrayWithObjects:@"journal1",@"journal2",nil];

  //initialisation du table View 
  UITableView* tableView=[[UITableView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]style:UITableViewStylePlain];

  //population de la vue
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [JournalList count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
  static NSString *MyIdentifier = @"MyIdentifier";

  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:MyIdentifier];

  if (cell == nil)

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:MyIdentifier];

  // Configuration de la cellule

  NSString *cellValue = [JournalList objectAtIndex:indexPath.row];
  cell.textLabel.text = cellValue;
  return cell;

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:14:40.367

你不需要这个
`UITableView* tableView=[[UITableView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]style:UITableViewStylePlain];`

只需将表添加到 viewController 并像这样在 appDelegate 类上添加该 viewController 名称

```
UIViewController *homeViewController = [[[HomeViewController alloc] initWithNibName:@"HomeViewController" bundle:nil] autorelease];
self.tabBarController = [[[UITabBarController alloc] init] autorelease];
self.tabBarController.viewControllers = [NSArray arrayWithObjects:homeViewController,nil]; 
```

只需在 xib 类中提供 delagate 和数据源连接

# .net - 在 HTML 页面中显示缩进的 XML 代码

> ID：10121054
> 
> 赞同：1
> 
> 时间：2012-04-12T09:37:59.533
> 
> 标签：.net, html, xml, xslt

我有一个以编程方式创建的 HTML 文档，我想在上面展示一些 XML**代码**，完全格式化为换行符和制表符。也就是说，如果您将没有 xml-stylesheet 的 xml 文件直接拖到浏览器上，它应该看起来像（大多数浏览器使用一些默认样式表进行某种 xml-rendering）。

现在，我当然*可以*转义所有字符（例如`<>`，制表符和换行符）并自己进行缩进（例如，使用 css 样式），但我想知道我是否不能重用一些“默认”xml-stylesheet从某处。最好也有一些javascript节点折叠的。

你知道这样的样式表/xslt 吗？还是您会建议另一种方法来实现这一目标？

我正在使用 C#。

PS：我尝试使用 Microsoft 的 XmlNotepad 中的 XmlNotepad.DefaultSS.xslt，但我无法真正使用它。:T

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T09:40:33.947

为什么不使用 SyntaxHighlighter .. 像[这个](http://alexgorbatchev.com/SyntaxHighlighter/)- 它有一个 XML 画笔 -[这里的 XML 示例](http://alexgorbatchev.com/SyntaxHighlighter/manual/brushes/xml.html)

您需要做的就是将您的 XML 包装在`<pre>`标签中，其余的都为您完成 - 缩进、行号等...

# android - 从 SD 卡中检索特定图像

> ID：10121055
> 
> 赞同：1
> 
> 时间：2012-04-12T09:38:01.030
> 
> 标签：android, android-sdcard

我不想打开任何画廊视图。我知道图像的名称，例如：blabla.jpg，它存储在存储卡中。我想检索硬编码并显示在图像视图中的那个物种图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:42:57.313

尝试：

```
ImageView.setImageUri(Uri.parse(new File("/sdcard/blabla.jpg").toString())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:32:14.730

如果你想从 SD 卡加载图像，你可以尝试下面的代码。

```
 BitmapFactory.Options options = new BitmapFactory.Options();
        options.inSampleSize = 4;

        Bitmap bitmap = BitmapFactory.decodeFile("/sdcard/blabla.jpg", options);
        mImageView.setImageBitmap(bitmap); 
```

# php - 跟踪何时出现下载文件对话框

> ID：10121056
> 
> 赞同：-1
> 
> 时间：2012-04-12T09:38:03.993
> 
> 标签：php, javascript, jquery

我有一些链接，当用户单击一个链接时，它会链接到一个 php 脚本，该脚本运行一些存储过程以生成数据，然后调用另一个脚本将数据下载为 Excel 电子表格。这一切都很好。

我想要做的是在被点击的链接旁边出现一个加载器 gif，当对话框出现让用户保存文件时，让该 gif 再次消失。

我可以完全跟踪此事件以实现此目的吗？到目前为止没有太多运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T09:42:28.857

我会将生成脚本称为 ajax，并使用`success`and`error`函数来识别脚本的完成？然后你可以开始动画，调用你的脚本，当它返回时你可以取消动画。

# c# - 使用 RavenDB 和 LINQ 查找至少包含子集中所有元素的对象

> ID：10121061
> 
> 赞同：4
> 
> 时间：2012-04-12T09:38:19.963
> 
> 标签：c#, .net, linq, ravendb

我有简单的类型`Question`：

```
public class Question
{
    public Question(string id)
    {
        Id = id;
        Tags = new List<string>();
    }

    public string Id { get; private set; }
    public IList<string> Tags { get; set; }            
} 
```

我已经定义了此类问题的样本集合：

```
var q1 = new Question("q1") { Tags = new List<string>() {"aa", "bb"} };
var q2 = new Question("q2") { Tags = new List<string>() {"aa"} };
var q3 = new Question("q3") { Tags = new List<string>() {"aa", "bb", "cc"} };
var q4 = new Question("q4");
var questions = new List<Question>() {q1, q2, q3, q4}; 
```

现在我需要**从给定的子集中找到所有问题，其中至少包含所有标签**。子集定义如下：

```
string[] tags = new[] {"aa", "bb"}; 
```

我用来获得所需结果的查询是：

```
var result = questions.Where(x => !tags.Except(x.Tags).Any()).ToList(); 
```

结果是 2 个问题的列表：**q1**和**q3**，在我使用 linq-to-objects 时可以正常工作。

不幸的是，当我试图查询这些问题，这些问题现在保留在 RavenDB 中时，我得到了一个例外：

```
var result = DocumentSession.Query<Question>()
                     .Where(x => !tags.Except(x.Tags).Any()).ToList(); 
```

结果是：

```
System.InvalidOperationException: Cannot understand how to translate value(Core.Commands.GetQuestions+<>c__DisplayClass0).tags.Except(x.Tags)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.GetPath(Expression expression, String& path, Type& memberType, Boolean& isNestedPath)
   at Raven.Client.Linq.DynamicQueryProviderProcessor`1.GetMember(Expression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitAny(MethodCallExpression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitEnumerableMethodCall(MethodCallExpression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitMethodCall(MethodCallExpression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitExpression(Expression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitExpression(Expression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitQueryableMethodCall(MethodCallExpression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitMethodCall(MethodCallExpression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.VisitExpression(Expression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.GetLuceneQueryFor(Expression expression)
   at Raven.Client.Linq.RavenQueryProviderProcessor`1.Execute(Expression expression)
   at Raven.Client.Linq.DynamicRavenQueryProvider`1.Execute(Expression expression)
   at Raven.Client.Linq.DynamicRavenQueryProvider`1.System.Linq.IQueryProvider.Execute(Expression expression)
   at Raven.Client.Linq.RavenQueryInspector`1.GetEnumerator()
   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
... 
```

如何使用 RavenDB 执行我想要的操作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T11:09:30.940

Jarek，你想做的是：

```
var q = session.Query<Question>();
foreach(var tag in tags)
{
    var currentTag = tag;
    q = q.Where(x=>x.Tags.Any(xTag=>xTag == currentTag));
} 
```

这将为您提供至少具有所有这些标签的所有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T09:58:00.583

看起来 LINQ 提供程序没有将 except 作为查询模式的一部分实现。如果我足够了解您的要求，您也许可以使用 SequenceEquals。

```
var result = questions.Where(q => q.Tags.SequenceEqual(tags)); 
```

使用您提供的代码，这恰好返回了一个 result `{"aa","bb"}`。如果 RavenDB Provider 没有为您提供足够多的查询模式实现，那么就干脆不使用 LINQ。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:28:02.880

RavenDB LINQ 提供程序不支持这种语法，因为底层索引机制 (Lucene) 不允许这种类型的查询。

但是，RavenDB 中有一个新功能允许您执行此操作，请参阅[此线程](https://groups.google.com/d/msg/ravendb/z5zQ6zP0fD8/gi4_RXffJzoJ)以获取更多信息。*请注意*，您需要获取最新版本才能使用此功能。

您应该能够将查询编写为：

```
var result = session.Query<Question>("IndexName")
        .Where(x => x.Tags.Any(t => t == "aa"))
        .Intersect()
        .Where(x => x.Tags.Any(t => t == "bb")
        .ToList(); 
```

并且索引需要看起来像这样：

```
from qu in docs.Questions
from tag in qu.Tags
select new { tag } 
```

谢谢，我一直在寻找这个新功能的另一个场景，所以当我有机会时，我会创建一个显示完整示例的要点。

# android - Android - 将字符串转换为图像

> ID：10121062
> 
> 赞同：0
> 
> 时间：2012-04-12T09:38:32.920
> 
> 标签：android, android-image

我需要从数据库中读取文本/字符串并将它们转换为图像。我尝试了以下代码，但我只得到空白图像。请帮忙

```
public Bitmap textAsBitmap(String text, float largest, int textColor) {
            Paint paint = new Paint();
            paint.setStyle(Paint.Style.FILL);
            paint.setColor(textColor);
            // int width = (int) (paint.measureText(text) + 0.5f); // round

            paint.setAntiAlias(true);
            paint.setTypeface(Typeface.MONOSPACE);

            paint.setTextSize(16);
            int width = 400;

            // float baseline = (int) (paint.ascent() + 0.5f) + 3f;
            // int height = (int) ((baseline + paint.descent() + 0.5f) + 3);

            int height = 400;

            Bitmap image = Bitmap.createBitmap(width, height,
                    Bitmap.Config.RGB_565);
            Canvas canvas = new Canvas(image);
            canvas.drawText(text, 0, 5, paint);
            return image;

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:44:03.023

我还没有尝试过，但您是否需要先用与 textColor 形成对比的颜色填充位图？在任何情况下，这似乎都是一件很重要的事情—— createBitmap() 的文档没有指定位图的初始内容，所以理论上它可以是任何东西，并且可能会在系统的未来版本中发生变化。

# r - 如何用 R + Igraph 处理 Ids 和命名顶点

> ID：10121064
> 
> 赞同：2
> 
> 时间：2012-04-12T09:38:35.150
> 
> 标签：r, igraph

我有一个名称从 1 到 10 的图表

```
library(igraph)
library(Cairo)

graphics.off()  
g<- graph(c(0,1,0,4,0,9,1,7,1,9,2,9,2,3,2,5,3,6,3,9,4,5,4,8,5,8,6,7,6,8,7,8),n=10,dir=FALSE)
V(g)$name<-c(1:10)
V(g)$label<-V(g)$name
coords <- c(0,0,13.0000,0,5.9982,5.9991,7.9973,7.0009,-1.0008,11.9999,0.9993,11.0002,7.9989,13.0009,10.9989,14.0009,5.9989,14.0009,7.0000,4.0000)
coords <- matrix(coords, 10,2,byrow=T)
plot(g,layout=coords) 
```

从每个顶点的邻居中，我做了以下事情，

```
listMn<-neighborhood(g,1,0:9)

m1<-V(g)[listMn[[7]]]$name # here I'm trying to name this array to don't confuse me 

g<-add.edges(g, c(listMn[[7]][2],listMn[[7]][3])) # with 6 3 7 8 I take ids 2 and 3 from this array to add between 3 and 7 an edge,
                                                   # but it's really 4 and 8 if i want to continue with the names id....  :s 

plot(g , layout = coords[V(g)$name,]) 
```

现在我进行下一步“寻找同构”，消除顶点名称（7）并在名称“9”和“4”之间添加边

```
vc<-c(0,1,1,2,2,3,3,0,0,2)
gp<-graph(vc,dir=FALSE);
listSub<-graph.get.subisomorphisms.vf2(g,gp)

m<-matrix(c(unlist(listSub)),length(listSub),length(unique(vc)),byrow=T)
m<-m[!duplicated(m[,1]),] 
```

在这种情况下，使用第一行 i=1 我很困惑，因为我想在 m[1,] 中添加 9 到 4 个名称之间的边，但在这种情况下，id 已更改

```
i<-1

if(length(neighbors(g,c(m[i,1])))==3){
    found<-1
    g<-delete.vertices(g,c(m[i,1]))

    if(are.connected(g, c(m[i,2]),c(m[i,4]))==TRUE){

    }else{
        g<-add.edges(g, c(m[i,2],m[i,4]))
    }

}else if(length(neighbors(g,c(m[i,3])))==3){
    found<-1
    g<-delete.vertices(g,c(m[i,3]))

    if(are.connected(g, c(m[i,2]),c(m[i,4]))==TRUE){

    }else{
        g<-add.edges(g, c(m[i,2],m[i,4]))
    }
}

plot(g , layout = coords[V(g)$name,]) 
```

总之，处理该算法的 id 的最佳方法是什么，我需要消除顶点并添加新边？

# iphone - EXC_BAD_ACCESS 错误 - 有时只有

> ID：10121065
> 
> 赞同：0
> 
> 时间：2012-04-12T09:38:35.720
> 
> 标签：iphone, xcode, exc-bad-access

我的应用程序有一个按钮，用于检查输入的值是否正确。有时它会导致它崩溃，但奇怪的是它以不规则的间隔发生（有时在第三次迭代，有时在第十次，有时从不）。

我在调试器中收到 EXC_BAD_ACCESS 错误。所以似乎有些东西在不应该的时候被释放了。按钮调用此函数：

```
- (IBAction)checkValue:(id)sender{
int actualDifference = [firstNumberString intValue] - [secondNumberString intValue];
actualDifferenceAsString = [NSString stringWithFormat:@"%d", actualDifference];
if ([answerTextField.text isEqualToString:actualDifferenceAsString])
{
    UIAlertView *correctAlert = [[UIAlertView alloc] initWithTitle:@"matches"
            message:@"next value."
            delegate:nil
            cancelButtonTitle:@"ok" 
            otherButtonTitles: nil];
    [correctAlert show];
    [correctAlert release];
}
else
{
    UIAlertView *incorrectAlert = [[UIAlertView alloc]
    initWithTitle:@"does not match"
            message:@"next value."
        delegate:nil
            cancelButtonTitle:@"ok"
            otherButtonTitles: nil];
    [incorrectAlert show];
    [incorrectAlert release];
} 
```

使用僵尸指向第一个语句：

```
int actualDifference = [firstNumberString intValue] - [secondNumberString intValue]; 
```

有谁知道问题可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:51:24.860

把它改成

```
 NSInteger actualDifference = [firstNumberString intValue] - [secondNumberString intValue];  //change int to NSInteger
NSString *actualDifferenceAsString = [NSString stringWithFormat:@"%d", actualDifference];
if ([answerTextField.text isEqualToString:actualDifferenceAsString])
{
    UIAlertView *correctAlert = [[UIAlertView alloc] initWithTitle:@"matches"
                                                           message:@"next value."
                                                          delegate:nil
                                                 cancelButtonTitle:@"ok" 
                                                 otherButtonTitles: nil];
    [correctAlert show];
    [correctAlert release];
}
else
{
    UIAlertView *incorrectAlert = [[UIAlertView alloc]
                                   initWithTitle:@"does not match"
                                   message:@"next value."
                                   delegate:nil
                                   cancelButtonTitle:@"ok"
                                   otherButtonTitles: nil];
    [incorrectAlert show];
    [incorrectAlert release];
} 
```

你得到这个代码。它对我有用...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T12:22:49.563

如果在第一行检测到僵尸，这意味着程序的其他部分正在释放`firstNumberString`或`secondNumberString`. 这就是问题开始的地方，但它只出现在这里，当您稍后尝试访问这些值时。你还在哪里使用这些字符串？你有没有释放过它们？

为了整体安全，可能应该为它们分配属性，而不是成员变量。

# php - Doctrine2 getResult() 重复对象

> ID：10121066
> 
> 赞同：0
> 
> 时间：2012-04-12T09:38:38.893
> 
> 标签：php, doctrine-orm

我在 Doctrine 2 Repository 函数中有一个奇怪的错误

```
$query = $this->_em->createQuery('SELECT c FROM \Model\Entity\Cluster c
                                  WHERE c.publisherid = :publisherid');
$query->setParameter("publisherid", (int)$publisher_id);
var_dump($query->getResult());
var_dump($query->getArrayResult()); 
```

而我们所拥有的

对象：

```
array (size=8)
  0 => 
    object(Model\Entity\Cluster)[**396**]
      private 'psiteid' => int 215
      private 'psiteclusterdate' => 
        object(DateTime)[371]
          public 'date' => string '**2011-12-20** 00:00:00' (length=19)
          public 'timezone_type' => int 3
          public 'timezone' => string 'Europe/Moscow' (length=13)
      private 'publisherid' => int 276
      private 'views' => int 14657
      private 'clicks' => int 6220
      ...

  1 => 
    object(Model\Entity\Psitecluster)[**396**]
      private 'psiteid' => int 215
      private 'psiteclusterdate' => 
        object(DateTime)[371]
          public 'date' => string '**2011-12-20** 00:00:00' (length=19)
          public 'timezone_type' => int 3
          public 'timezone' => string 'Europe/Moscow' (length=13)
      private 'publisherid' => int 276
      private 'views' => int 14657
      private 'clicks' => int 6220
      ... 
```

键为 0-3 的行复制此对象 (396)，其他行复制第二个对象。当我转储为数组时：

```
array (size=8)
  0 => 
    array (size=22)
      'psiteid' => int 215
      'psiteclusterdate' => 
        object(DateTime)[367]
          public 'date' => string '**2011-12-20** 00:00:00' (length=19)
          public 'timezone_type' => int 3
          public 'timezone' => string 'Europe/Moscow' (length=13)
      'publisherid' => int 276
      'views' => int 14657
      'clicks' => int 6220
        ....

  1 => 
    array (size=22)
      'psiteid' => int 215
      'psiteclusterdate' => 
        object(DateTime)[396]
          public 'date' => string '2011-12-21 00:00:00' (length=19)
          public 'timezone_type' => int 3
          public 'timezone' => string 'Europe/Moscow' (length=13)
      'publisherid' => int 276
      'views' => int 10166
      'clicks' => int 4028 
```

所有行在数组中都不同。对象有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-16T10:30:24.300

我解决了一个问题。这是 Doctrine2 中的一个错误。我在这里创建了错误报告[http://doctrine-project.org/jira/browse/DDC-1780](http://doctrine-project.org/jira/browse/DDC-1780)

您可以在您的项目中修复（如果您可以编辑 Doctrine 库文件）。只需添加

```
if ($id[$fieldName] instanceof \DateTime) { 
    $id[$fieldName] = $id[$fieldName]->getTimestamp(); 
}` 
```

在 foreach 循环中。

# asp.net-mvc - 选择对象并修改字段 linq

> ID：10121073
> 
> 赞同：1
> 
> 时间：2012-04-12T09:39:20.390
> 
> 标签：asp.net-mvc, linq, linq-to-entities

我有以下 Linq 查询：

```
 var list = (from user in serviceu.Repository.FindFind(<<filtering nonsense>>)
                            from profile in serviceP.Repository.GetQuery().Where(p => p.userID == user.userID).DefaultIfEmpty()
                            select user ).ToList(); 
```

基本上我必须将 ProfileId 添加到我的用户实体中。执行此连接仅允许我选择用户元素，但我想更改的值`user.profileID=profile.profileID`（我已经扩展了对象，因此它具有该字段）。如何以最快的方式做到这一点？我已经通过这样做暂时解决了它：

```
var list = (from user in serviceu.Repository.Find(<<filtering nonsense>>)
                                from profile in serviceP.Repository.GetQuery().Where(p => p.userID == user.userID).DefaultIfEmpty()
                                select new { user, profile.ProfileID }).ToList(); 

list.ForEach(el =>
                {
                    el.user.ProfileID = el.ProfileID.ToString();
                });

                return list.Select(x => x.user).ToList(); 
```

这是最好的（最快/优雅的方式）吗？可以做不同的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T18:58:06.070

而不是 ForEach 并返回尝试：

```
return list.Select(c => {c.user.ProfileID = c.ProfileID.ToString(); return c;}).ToList(); 
```

# ios5 - setTint 不工作

> ID：10121076
> 
> 赞同：0
> 
> 时间：2012-04-12T09:39:28.393
> 
> 标签：ios5, uinavigationbar

我一直在四处寻找在 iOS 5.1 上更改 UINavigationBar 的色调。

我有一个带有两个 UINavigationController 的 UITabBarController，以下代码放在自定义 UINavigationController 中：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [self.navigationController.navigationBar setTintColor:[UIColor blackColor]];
} 
```

...但这没有任何效果。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:58:48.233

如果您有子类化`UINavigationController`（并且没有最常见的`UIViewController`内部 a `UINavigationController`），那么您应该这样做：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    [self.navigationBar setTintColor:[UIColor blackColor]];
} 
```

因为`self`已经是一个导航控制器。否则你的代码你会工作得很好（即你有一个`UIViewController`或一个它的子类，你已经通过代码或通过 Interface Builder 将它嵌入到 a 中`UINavigationController`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T11:55:30.123

尝试这个

*   (void)viewWillAppear:(BOOL)animated { [super viewWillAppear:animated]; self.navigationController.navigationBar.tintColor = [UIColor orangeColor]; }

# facebook-graph-api - 图 api 分页错误...为什么？

> ID：10121082
> 
> 赞同：1
> 
> 时间：2012-04-12T09:40:19.920
> 
> 标签：facebook-graph-api, paging

我正在构建一个 facebook 相册/照片浏览器。facebook api 提供了一个很酷的分页系统，应该避免我们构建它。但是它似乎不能正常工作......看看这个查询： http: [//developers.facebook.com/tools/explorer/ ?method=GET&path=me%2Falbums](http://developers.facebook.com/tools/explorer/?method=GET&path=me%2Falbums)

它返回当前用户的所有专辑。但是，它显示上一页和下一页，虽然只有下一页有专辑（上一页是空的......）

知道为什么会这样吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T18:45:22.297

Facebook 通常不会费心确定下一个或上一个查询中是否有数据。它只是根据当前查询自动为您构建 url。

FB 开发中的常见现象：

```
{
  “数据”： [
  ]
}
```

您可以对响应进行解码并查看它是否为空数组。在这种情况下，您位于第一页，因此您应该期望上一个链接返回一个空数据集。

# javascript - 大众astar寻路

> ID：10121083
> 
> 赞同：5
> 
> 时间：2012-04-12T09:40:26.627
> 
> 标签：javascript, html, path-finding, a-star

我正在尝试用 Javascript 创建一个塔防游戏。

除了寻路，一切都很顺利。。

我正在使用来自该网站的 astar 代码：[http](http://www.briangrinstead.com/blog/astar-search-algorithm-in-javascript) ://www.briangrinstead.com/blog/astar-search-algorithm-in-javascript它使用二进制堆（我认为这是相当最佳的）

我遇到的问题是我想让人们阻止“攻击者”的路径。这意味着每个“攻击者”都需要能够自己找到通往出口的路（因为有人可以切断一个“攻击者”并且它需要自己找到通往出口的路）。现在 5/6 攻击者可以在任何时候毫无问题地寻路。但是假设路径被 10 多个攻击者阻止，所有 10 个攻击者都需要同时触发其寻路脚本，这只会将 FPS 降低到每秒 1/2 左右。

对于任何时候都有很多实体寻路的人来说，这一定是一个常见的问题，所以我想一定有比我的方法更好的方法。

所以我的问题是：以最有效的方式对多个“机器人”实施大规模寻路算法的最佳方法是什么。

谢谢，

詹姆士

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:01:55.887

使用*反对象*，这是获得廉价寻路的唯一方法，afaik： [http ://www.cs.colorado.edu/~ralex/papers/PDF/OOPSLA06antiobjects.pdf](http://www.cs.colorado.edu/~ralex/papers/PDF/OOPSLA06antiobjects.pdf)

反对象基本上意味着您将拥有一个绑定到您的游戏地图的“swarm ai”，而不是机器人拥有单独的人工智能。

* * *

ps：这是另一个关于一般寻路的链接（可能是最好的在线参考）： [http ://theory.stanford.edu/~amitp/GameProgramming/index.html](http://theory.stanford.edu/~amitp/GameProgramming/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T03:54:31.283

只缓存结果。

将路径作为值存储在哈希表（对象）中，给每个节点一个 UUID，连接 UUID 以形成唯一的哈希表键并将路径插入其中。

当您从哈希表中检索出路径时，遍历路径，看看它是否仍然有效，如果不是，重新计算并重新插入新的路径。

你可以做很多优化:)

就像 c69 说的 swarm AI 或蜂巢思维浮现在脑海中：P

# string - 匹配一个或零个不匹配的字符串模式

> ID：10121088
> 
> 赞同：8
> 
> 时间：2012-04-12T09:40:32.997
> 
> 标签：string, algorithm, pattern-matching, string-matching, knuth-morris-pratt

给定一个要匹配的字符串和一个模式，如何有效地找到零个或一个不匹配的匹配项。

```
e.g) 
S = abbbaaabbbabab
P = abab

Matches are abbb(index 0),aaab(index 4),abbb(index 6),abab(index 10) 
```

我试图修改 KMP 算法，但我不确定该方法。

请给我一个想法来解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-15T06:45:34.743

好的，我找到了！我找到了最好的算法！

这听起来可能有点勇敢，但只要我要提出的算法同时具有运行时间`O(m + n)`和内存消耗`O(m + n)`，并且条目数据本身具有相同的属性，则该算法只能在常量中进行优化。

## 使用的算法

我将在我的解决方案中使用 KMP 和[Rabin Karp](http://en.wikipedia.org/wiki/Rabin%E2%80%93Karp_algorithm)算法之间的混合。Rabin Karp 使用[滚动哈希](http://en.wikipedia.org/wiki/Rolling_hash)来比较初始字符串的子字符串。它需要使用线性附加内存的线性时间预计算，但从那时起，两个字符串的子字符串之间的比较是恒定的`O(1)`（如果您正确处理冲突，这将摊销）。

## 我的解决方案不会做什么

我的解决方案不会在第一个字符串中找到与第二个字符串匹配的**所有匹配项，最多相差 1 个。**但是，可以修改算法，以便对于第一个字符串中的每个起始索引，如果存在这样的匹配，则至少会找到其中一个（这留给读者）。

## 观察

设`m`第二个字符串`n`的长度和 - 第一个字符串的长度。我将把任务分成两部分：如果我的目标是找到最多有一个差异的匹配，我想找到第一个字符串的子字符串：`PREF`将是单个差异之前的`SUFF`子字符串和之后的子字符串区别。我想要`len(PREF) + len(SUFF) + 1 = m`, where `PREF`or`SUFF`将在需要时被人为缩短（当字符串匹配没有差异时）。

我将我的解决方案基于一个非常重要的观察：假设第一个字符串的子字符串从 index 开始，`i`其长度`m`与第二个字符串匹配，最多有一个差异。然后，如果我们`PREF`尽可能长时间地使用，仍然会有解决方案`SUFF`。这很明显：我只是尽可能地将差异推到最后。

## 算法

现在遵循算法本身。从通常的 KMP 开始。每次当前缀扩展失败并且要遵循失败链接时，首先检查是否跳过下一个字母剩余的后缀是否匹配第二个字符串的剩余部分。如果是这样，则找到最多具有一个字符差异的所寻求的匹配。如果不是 - 我们继续使用普通 KMP 进行 Rabin Karp 检查，每次要遵循失败链接。

让我用一个例子进一步澄清 Rabin Karp 检查。假设我们在 KMP 的某个步骤，我们发现`first.substring[i, i + k - 1]`匹配`k`第二个字符串的第一个字母。还假设该字母`first[i + k]`不同于`second[k]`。然后使用 Rabin Karp检查是否`first.substring[i + k + 1, i + m - 1]`完全匹配。`second.substring[k + 1, m - 1]`这正是您`i`尽可能地扩展了起始前缀形式索引并且您现在尝试是否存在最多一个差异的匹配的情况。

Rabin Karp 仅在跟随失败链接时使用，它将前缀的起始索引移动至少一个，这意味着最多`O(n)`使用 Rabin Karp 调用，每个调用都具有复杂度`O(1)`，总复杂度为线性复杂度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:05:40.283

这被称为[近似字符串匹配](http://en.wikipedia.org/wiki/Approximate_string_matching)问题。在您的特定情况下，您希望最大编辑距离为 1。

bitap[算法](http://en.wikipedia.org/wiki/Bitap_algorithm)是一种相当快速的解决方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-02T09:44:08.160

要查找包括一个不匹配在内的所有子匹配，您需要 2 个 z 函数（一个用于原始 P，另一个用于反向 P）。在原始和反转字符串 S 的最长前缀子匹配的 buld 数组之后。稍后您需要反转第二个数组。最后一切都很简单：遍历第一个数组并检查最长前缀的长度是否等于 P 的长度。如果是，那么它是一个没有错误的匹配。如果它更短，则检查位置 (i + length(P) - 1) 处的第二个数组。如果两个值之和等于 length(P) - 1，则它是一个错误的子匹配。

复杂度为 O(len(P) + len(S))

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T01:48:39.400

[Gonzalo Navarro 在他的近似字符串匹配指南](http://scholar.google.com/scholar?cluster=15894901928968181925&hl=en&as_sdt=0,5)中全面概述了各种算法以及它们如何相互比较。第 80、81 和 82 页显示了复杂性结果，包括最坏和平均情况，以及各种算法的空间要求。

*（在此处使用的符号中，n 是指您搜索的文本的长度，m 是模式的长度，σ 是字母表的大小，k 是最大编辑距离，在您的情况下为 1。）*

# android - 在 android webview 中阻止某些 URL 以确保安全

> ID：10121089
> 
> 赞同：5
> 
> 时间：2012-04-12T09:40:33.070
> 
> 标签：android, url, android-webview

我正在尝试在我的 webview 中拦截 url 点击。我想阻止在 webview 中单击某些 url 时启动它们。

为此，我是压倒一切的`shouldOverrideUrlLoading`方法。但是仍然会返回`true/false`该 url 正在启动。

例如，如果我想阻止`http://www.xyz.com`我能够获取 url 字符串并能够使用我的黑名单 url 对其进行更改，但无论返回值如何，它都会启动。

我的方法可能错了我需要建议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T09:53:46.857

尝试这样的事情

```
 @Override
public boolean shouldOverrideUrlLoading(WebView wView, String url)
{
     if(url.equals("from your list")){
         //DO something
     }
    return true;
} 
```

但是我不太记得布尔值。试一试....

# memory - 操作系统启动、分页或不分页时的内存管理类型是什么？

> ID：10121093
> 
> 赞同：1
> 
> 时间：2012-04-12T09:40:49.607
> 
> 标签：memory, memory-management, linux-kernel, x86, kernel

启动操作系统时，内存管理的类型是什么，分页还是无分页？也就是说cr0寄存器中控制分页的开/关的值是多少。我猜在内核初始化开始时分页是关闭的，否则所有的内存访问都将无效。分页是在内核初始化时设置的，内核空间的所有映射都必须设置为有效。我对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:02:37.757

我假设“操作系统启动时”是指“处理器启动时”。在那种情况下，它显然取决于处理器的架构。

对于 x86，分页由 CR0 寄存器中的第 31 位控制（如果设置了该位，则启用分页）。来自[英特尔的软件开发人员手册](http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html)，第 3 卷，第 8.1.1 节。“Processor State After Reset”，可以看到复位后CR0中的值为0x60000010，表示分页被禁用。

如果您想知道在内核启动之前是否启用了分页，这取决于引导加载程序的作用。Multiboot规范（例如，由 GRUB 实现）[规定](http://www.gnu.org/software/grub/manual/multiboot/multiboot.html)[应该](http://www.gnu.org/software/grub/manual/multiboot/multiboot.html#Machine-state)禁用分页：

> 'CR0'</p>
> 
> 位 31 (PG) 必须清零。必须设置位 0 (PE)。其他位都是未定义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:07:52.563

x86 CPU 在复位后以实地址模式开始执行。操作系统需要先将 CPU 切换到保护模式，然后才能启用页面转换。您不能在从实模式切换到保护模式的同时启用它（您会获得#GP），也不能在实模式中启用它。因此，在 x86 上，操作系统首先在禁用页面转换的情况下运行（除非它之前已由操作系统引导加载程序启用，这种情况很少见），然后在它准备好时启用它（即已构建页表并加载 CR3）。

# c# - 使用 lambda 返回一个连接的字符串

> ID：10121094
> 
> 赞同：2
> 
> 时间：2012-04-12T09:40:50.577
> 
> 标签：c#, lambda

我有一个用户列表，在那个对象上我有一个属性电子邮件。有没有办法在 c# 中使用 lambda 以“email1;email2;email3”的格式返回每个用户电子邮件的单个字符串，最后没有任何分号。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T09:42:59.457

是的。假设您的`User`对象列表称为`users`：

```
string emailList = string.Join(";", users.Select(u => u.Email)); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-12T09:43:28.080

```
from user in listOfUsers
select string.Join(";", user.Emails); 
```

感谢yamen发现错误

```
select string.Join(";", user.Emails.ToArray()); 
```

# hadoop - 无法启动 Hue-2.0.0-Beta 的蜂蜡服务器

> ID：10121096
> 
> 赞同：0
> 
> 时间：2012-04-12T09:41:00.527
> 
> 标签：hadoop, hue

由于 Thrift 依赖失败，无法启动蜂蜡服务器。这是失败日志。

```
Exception in thread "main" java.lang.NoSuchMethodError: org.apache.thrift.server.TThreadPoolServer.<init>(Lorg/apache/thrift/server/TThreadPoolServer$Args;)V
at com.cloudera.beeswax.Server.serveBeeswax(Server.java:203)
at com.cloudera.beeswax.Server.main(Server.java:159)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.apache.hadoop.util.RunJar.main(RunJar.java:197) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T07:32:23.957

这基本上是色调和节俭插件之间的版本不匹配。我正在使用 Hive 0.7 测试 Hue 2.0 beta。Hue 2.0 beta 是使用 Hive 0.8 编译的。

请参阅此处的问题。[https://issues.cloudera.org/browse/HUE-678](https://issues.cloudera.org/browse/HUE-678)

# jenkins - Jenkins - 配置 Jenkins 以轮询 SCM 中的更改

> ID：10121098
> 
> 赞同：64
> 
> 时间：2012-04-12T09:41:08.180
> 
> 标签：jenkins

我正在与 jenkins 合作，当 svn 存储库发生更改时，我想运行 maven 目标。我附上了一张我当前配置的图片。

我知道每 5 分钟检查一次存储库很疯狂。我只想在有新变化时运行它，但我找不到方法。无论如何，它没有检查存储库。我究竟做错了什么？？

提前致谢![在此处输入图像描述](../Images/b864c456ec5f6b388ab41211abbd5326.png)

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2015-06-14T22:03:33.580

我相信这些天的最佳做法是`H/5 * * * *`，这意味着每 5 分钟使用一个散列因子，以避免所有工作在完全相同的时间开始。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2012-04-12T11:31:53.303

我认为您的 cron 不正确。根据您的描述，您可能需要将 cron 计划更改为

```
*/5 * * * * 
```

您现在在日程表中输入的内容意味着它将在每小时 5 点轮询 SCM。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-08-16T21:57:18.150

这是一个老问题，我知道。但是，据我说，它缺少正确的答案。

此处的实际/最佳工作流程将包含 SVN 的提交后挂钩，因此它仅在发出实际提交后触发 Jenkins 作业，而不是在任何其他情况下。这样可以避免在 SCM 系统上进行不必要的轮询。

您可能会发现以下链接很有趣：

*   Jenkins Wiki在 Subversion 插件的文档站点上[的提交后挂钩描述。](https://wiki.jenkins.io/display/JENKINS/Subversion+Plugin#SubversionPlugin-Post-commithook)在这里，您可以找到您感兴趣的脚本的文档示例。
*   [Hook-scripts contrib 目录](https://svn.apache.org/repos/asf/subversion/trunk/contrib/hook-scripts/)位于官方 Apache Foundation 的 Subversion 源代码控制存储库的源代码中。
*   [StackOverflow 上的类似问题](https://stackoverflow.com/questions/21194621/post-commit-hook-to-trigger-automatic-jenkins-build)。

如果我在 corp 的 SVN 服务器中进行设置，我使用以下（审查的）脚本作为 subversion 服务器端的提交后挂钩：

```
#!/bin/sh

# POST-COMMIT HOOK

REPOS="$1"
REV="$2"
#TXN_NAME="$3"
LOGFILE=/var/log/xxx/svn/xxx.post-commit.log

MSG=$(svnlook pg --revprop $REPOS svn:log -r$REV)
JENK="http://jenkins.xxx.com:8080/job/xxx/job/xxx/buildWithParameters?token=xxx&username=xxx&cause=xxx+r$REV"
JENKtest="http://jenkins.xxx.com:8080/view/all/job/xxx/job/xxxx/buildWithParameters?token=xxx&username=xxx&cause=xxx+r$REV"

echo post-commit $* >> $LOGFILE 2>&1

# trigger Jenkins job - xxx
svnlook changed $REPOS -r $REV | cut -d' ' -f4 | grep -qP "branches/xxx/xxx/Source"
if test 0 -eq $? ; then
        echo $(date) - $REPOS - $REV: >> $LOGFILE
        svnlook changed $REPOS -r $REV | cut -d' ' -f4 | grep -P "branches/xxx/xxx/Source" >> $LOGFILE 2>&1
        echo logmsg: $MSG >> $LOGFILE 2>&1
        echo curl -qs $JENK >> $LOGFILE 2>&1
        curl -qs $JENK >> $LOGFILE 2>&1
        echo -------- >> $LOGFILE
fi

# trigger Jenkins job - xxxx
svnlook changed $REPOS -r $REV | cut -d' ' -f4 | grep -qP "branches/xxx_TEST"
if test 0 -eq $? ; then
        echo $(date) - $REPOS - $REV: >> $LOGFILE
        svnlook changed $REPOS -r $REV | cut -d' ' -f4 | grep -P "branches/xxx_TEST" >> $LOGFILE 2>&1
        echo logmsg: $MSG >> $LOGFILE 2>&1
        echo curl -qs $JENKtest >> $LOGFILE 2>&1
        curl -qs $JENKtest >> $LOGFILE 2>&1
        echo -------- >> $LOGFILE
fi

exit 0 
```

# php - 在 PHP 脚本上设置 jQuery BlockUI

> ID：10121099
> 
> 赞同：0
> 
> 时间：2012-04-12T09:41:09.143
> 
> 标签：php, jquery, html

我想在我的 PHP 脚本在后台运行时显示一些东西并锁定屏幕。

该脚本可能需要很长时间才能运行，因为它正在为 URL 列表提取元数据，因此根据在文本区域中输入的 URL 数量，可能需要长达 5 分钟。

我想使用 BlockUI jQuery 代码，但不知道如何在我的 php 脚本中设置它，有人可以帮我吗？

这是我的代码：

```
<form method="get" action=<?php echo "'".$_SERVER['PHP_SELF']."'";?> >
<p>URL of Competitor:</p> 
<textarea name="siteurl" rows="10" cols="50">
<?php //Check if the form has already been submitted and if this is the case, display     the submitted content. If not, display 'http://'.
echo (isset($_GET['siteurl']))?htmlspecialchars($_GET['siteurl']):"http://";?>
</textarea><br>
<input type="submit" value="Submit">
</form>
<div id="nofloat"></div>
<table class="metadata" id="metatable_1">
<?php
ini_set( "display_errors", 0);
function parseUrl($url){
    //Trim whitespace of the url to ensure proper checking.
    $url = trim($url);
    //Check if a protocol is specified at the beginning of the url. If it's not,     prepend 'http://'.
    if (!preg_match("~^(?:f|ht)tps?://~i", $url)) {
            $url = "http://" . $url;
    }
    //Check if '/' is present at the end of the url. If not, append '/'.
    if (substr($url, -1)!=="/"){
            $url .= "/";
    }
    //Return the processed url.
    return $url;
}
//If the form was submitted
if(isset($_GET['siteurl'])){
    //Put every new line as a new entry in the array
    $urls = explode("\n",trim($_GET["siteurl"]));
    //Iterate through urls
    foreach ($urls as $url) {
            //Parse the url to add 'http://' at the beginning or '/' at the end if not    already there, to avoid errors with the get_meta_tags function
            $url = parseUrl($url);
            //Get the meta data for each url
            $tags = get_meta_tags($url);
            //Check to see if the description tag was present and adjust output   accordingly
            echo (isset($tags['description']))?"<tr><td>Description($url)</td>   <td>".$tags['description']:"<tr><td>Description($url)</td><td>No Meta Description</td>  </tr>.";
    }
}
?>
</table>
<script type="text/javascript">
        var exportTable1=new ExportHTMLTable('metatable_1');
    </script>
<div>
        <input type="button" onclick="exportTable1.exportToCSV()"   value="Export to CSV"/>
        <input type="button" onclick="exportTable1.exportToXML()"     value="Export to XML"/>
    </div> 
```

这里是 jQuery Block UI 的链接：http: [//jquery.malsup.com/block/#demos](http://jquery.malsup.com/block/#demos)

我还需要包含任何文件吗？

如果有人能指出我正确的方向，那就太好了:)

非常感谢！

瑞奇

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:54:34.243

将 php 放在一个单独的文件中，然后使用 ajax 调用该脚本并在检索到后将结果返回到页面？

# php - mysql UPDATE 不工作并且不返回任何错误

> ID：10121101
> 
> 赞同：-1
> 
> 时间：2012-04-12T09:41:18.007
> 
> 标签：php, mysql

```
$update = mysql_query("UPDATE users SET regstatus='TRUE' WHERE username='$id' AND regstring='$key'") or die(mysql_error());
if (mysql_num_rows($check)>0)
    header("refresh:3;url=login.php");
    echo "Your account is active now. Redirecting to login page."; } 
```

我得到一个输出 您的帐户现在处于活动状态。重定向到登录页面并将我重定向到登录页面。

但是 的值`regstatus`没有被更新。作为调试的一部分，我在查询中检查 mysql_num_rows，它说有一行受到影响，但值仍然没有更新。

有任何想法吗？列 regstatus 是 varchar。

根据建议更新了代码：

```
 $update = mysql_query("UPDATE users SET regstatus='True' WHERE username='$id' AND regstring='$key'") or
        die(mysql_error());
    if (mysql_num_rows($update)>0)
    {
        header("refresh:3;url=login.php");
        echo "Your account is active now. Redirecting to login page.";
    } 
```

现在我得到：

`Warning: mysql_num_rows(): supplied argument is not a valid MySQL result resource in /activate.php on line 27`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T09:44:24.600

难道不应该

```
if (mysql_num_rows($update)>0) {
                    ^^^^^^     ^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T09:45:50.840

您想使用`mysql_affected_rows()`而不是`mysql_num_rows()`. 此外，参数应该是`$update`而不是`$check`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T09:45:30.807

mysql_num_rows():

> 从结果集中检索行数。此命令仅对返回实际结果集的 SELECT 或 SHOW 等语句有效。要检索受 INSERT、UPDATE、REPLACE 或 DELETE 查询影响的行数，请使用 mysql_affected_rows()。

即你必须在你的代码示例中使用 mysql_affected_rows

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T09:46:38.207

查看[`mysql_affected_rows`](http://php.net/manual/de/function.mysql-affected-rows.php)获取`UPDATE`查询的受影响行数。您还应该明确是什么`$check`。

为了调试您的 MySQL 查询问题，尝试调试打印查询并手动执行它，例如通过 PhpMyAdmin。`$id`参数和可能有问题`$key`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T09:47:47.363

语句中的“$check”是什么

```
 if (mysql_num_rows($check)>0) 
```

那不应该是“$ update”吗？

```
 if (mysql_num_rows($update)>0)   { 
```

# javascript - 添加了 contenteditable="true" 的 DIV 不关注点击

> ID：10121102
> 
> 赞同：4
> 
> 时间：2012-04-12T09:41:27.613
> 
> 标签：javascript, jquery, html, contenteditable

我正在使用 jQuery 将内容可编辑属性添加到 DIV。

```
$('div').attr('contenteditable', 'true'); 
```

当我单击它时，当我单击已经内容可编辑的 DIV 时，我没有获得焦点效果。只有当我再次单击它时它才会聚焦。

这发生在我的每一个浏览器中——Safari 5、Chrome 18、Firefox 8。无论如何我可以让它表现得像它应该的那样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T14:30:01.697

我意识到我遇到了这个问题，因为该元素也是 jquery-ui 可拖动的，并且单击事件已被劫持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T09:49:10.060

[http://jsfiddle.net/VV7BW/1/](http://jsfiddle.net/VV7BW/1/)似乎工作。`$('div')`可能是你的问题，这将得到我认为的所有 div，但只将 attr 应用于第一个（但不要引用我的话）

尝试给你的 div 一个 id，然后用`$('#id')`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-26T03:31:48.533

我在尝试`contenteditable`在鼠标事件上添加属性时遇到了同样的错误。使用`mousedown`事件，它不起作用。使用`click`它工作正常的事件......

在我的情况下，该`id`属性不会改变任何东西。

# java - Hibernate Envers：检索具有集合属性的实体的正确修订

> ID：10121103
> 
> 赞同：0
> 
> 时间：2012-04-12T09:41:30.013
> 
> 标签：java, hibernate, hibernate-envers

我有两个经过审计的实体 A 和 B。实体 A 拥有实体 B 的集合（注释为一对多关系）。将 A 的新实例插入数据库时​​，A 和 B 的所有行都处于同一修订版（假设是修订版 1）。然后，对 A 的更新仅影响实体 B 的实例。因此更新后，实体 A 仍处于修订版 1，而 B 的实体处于修订版 2（包括审计表中的 MOD 条目） . 在修订版 3 中，实体 A 被删除。因为实体 B 的集合使用@Cascade 注释，所以属于 A 的实体 B 也被删除。

鉴于这种情况，我如何使用 Envers 创建一个审计查询，该查询获取实体 A 的实例以及修订版 2 的更新实体 B？当我查询实体 A 的所有修订版时，我要么得到 A 的已删除实体，它不包含 B 的实体（修订版 3），要么我得到修订版 1 的 A 也包含修订版 1 的 B 实体。

如果有帮助，请使用 Hibernate 3.6。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-28T12:02:20.980

我通过在相当于您的 A 实体上添加隐藏的 lastUpdated 日期字段解决了类似的问题。

```
@Entity
public class A {
    private Date lastModified;
    @OneToMany(mappedBy = "a", cascade = CascadeType.ALL )
    private List<B> blist;
    public void touch(){
        lastModified=new Date();
    }
} 
```

然后在相关实体（比如你的 B 字段）中，我添加了以下内容：

```
public class B {
    @ManyToOne
    private A a; 

    @PreUpdate
    public void ensureParentUpdated(){
        if(a!=null){
            a.touch();
        }
    }
} 
```

这确保了无论何时将修订添加到 B，都会将修订添加到 A，即使它需要许多实体中的自定义代码。

在您的情况下，这将确保 A 的历史记录实际上包含 B 的修订。这样您只需要一个查询即可获取整个 A、Bs 图表的所有修订

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T14:00:19.363

如果您阅读第 2 版的实体 A，您将获得正确的数据。

目前无法获取实体或相关实体更改的修订列表（如您的情况 - rev 2 仅在 B 中进行更改，而不在 a 中更改）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:04:55.510

在 Hibernate 中，我们可以通过指定惰性来控制子元素的加载。因此，您需要将以下行添加到休眠配置中的类定义中，以便在两种读/写情况下加载所有关联。

```
<cache usage="read-write"/> 
```

如果您已标记**CacheMode.REFRESH**，则它将项目写入二级缓存。不要从二级缓存中读取。

如果您在为父母时加载孩子没有问题，您可以转为惰性，这将返回更新的信息。

# php - 在mongodb的嵌套数组中插入数据

> ID：10121108
> 
> 赞同：4
> 
> 时间：2012-04-12T09:42:02.293
> 
> 标签：php, mongodb

> **可能重复：**
> [MongoDB 更新嵌套数组中的字段](https://stackoverflow.com/questions/9611833/mongodb-updating-fields-in-nested-array)

我有如下数据：

```
{ 
    "_id" : ObjectId("4f855061dd53351011000b42"), 
    "act_mgr" : [{ "sales" : {"agent" : ["rohan@walkover.in" ],  "last_interacted" : "rohan@walkover.in" } } ],
    "email" : "aman@asasas.com", "name" : "Aman",
    "sales" : [{"sno" : 1,  "message" : "description","status" : "open"},{"sno" : 12,"message" : "assad","status" :"open"}]
} 
```

我想在 act_mgr:sales 中添加新代理并更新 last_interacted 类似的东西

```
"act_mgr" : [{ "sales" : {"agent" : ["rohan@walkover.in","abc@walkover.in" ],
 "last_interacted" : "abc@walkover.in" } } ] 
```

此外，如果我像开发人员一样添加新的 act_mgr，那么它就像

```
 "act_mgr" : [{ "sales" : {"agent" : ["rohan@walkover.in","abc@walkover.in" ],  "last_interacted" : "abc@walkover.in" } },
 { "developer" : {"agent" : ["newdeveloper@walkover.in" ],  "last_interacted" : "newdeveloper@walkover.in" } } ] 
```

我不知道如何添加这些字段

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T20:51:55.003

您可以使用以下更新语句更新“act_mgr”数组中嵌入的“销售”文档：

```
> db.sales.update({"act_mgr.sales.last_interacted":"rohan@walkover.in"}, {$push:{"act_mgr.$.sales.agent":"abc@walkover.in"}, $set:{"act_mgr.$.sales.last_interacted":"abc@walkover.in"}})
> db.sales.find().pretty()
{
    "_id" : ObjectId("4f855061dd53351011000b42"),
    "act_mgr" : [
        {
            "sales" : {
                "agent" : [
                    "rohan@walkover.in",
                    "abc@walkover.in"
                ],
                "last_interacted" : "abc@walkover.in"
            }
        }
    ],
    "email" : "aman@asasas.com",
    "name" : "Aman",
    "sales" : [
        {
            "sno" : 1,
            "message" : "description",
            "status" : "open"
        },
        {
            "sno" : 12,
            "message" : "assad",
            "status" : "open"
        }
    ]
}
> 
```

您可以将包含“开发人员”信息的嵌入文档添加到数组中，如下所示：

```
> db.sales.update({"_id" : ObjectId("4f855061dd53351011000b42")}, {$push:{"act_mgr":{ "developer" : {"agent" : ["newdeveloper@walkover.in" ],  "last_interacted" : "newdeveloper@walkover.in" } }}})
> db.sales.find().pretty()
{
    "_id" : ObjectId("4f855061dd53351011000b42"),
    "act_mgr" : [
        {
            "sales" : {
                "agent" : [
                    "rohan@walkover.in",
                    "abc@walkover.in"
                ],
                "last_interacted" : "abc@walkover.in"
            }
        },
        {
            "developer" : {
                "agent" : [
                    "newdeveloper@walkover.in"
                ],
                "last_interacted" : "newdeveloper@walkover.in"
            }
        }
    ],
    "email" : "aman@asasas.com",
    "name" : "Aman",
    "sales" : [
        {
            "sno" : 1,
            "message" : "description",
            "status" : "open"
        },
        {
            "sno" : 12,
            "message" : "assad",
            "status" : "open"
        }
    ]
}
> 
```

$push 和 $set 修饰符的文档可以在“更新”文档中找到： [http ://www.mongodb.org/display/DOCS/Updating](http://www.mongodb.org/display/DOCS/Updating)

有关使用 Mongo db 创建和更新嵌入式文档的更多信息，请参阅标题为“Dot Notation (Reaching into Objects)”的文档 [http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects %29](http://www.mongodb.org/display/DOCS/Dot+Notation+%28Reaching+into+Objects%29)

有关使用“$”位置运算符更新嵌入文档的信息，请参见“更新”文档的“$ 位置运算符”部分。
[http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator](http://www.mongodb.org/display/DOCS/Updating#Updating-The%24positionaloperator)

提醒一句：嵌入文档通常都匹配相同的结构更为常见，这样可以更轻松地引用单个嵌入文档。您的“销售”数组就是一个很好的例子；每个嵌入的文档都包含相同的键，“sno”、“message”和“status”

但是，“act_mgr”数组中的嵌入文档包含不同的键；第一个包含“销售”，第二个包含“开发者”。相反，也许考虑以下结构：

```
"act_mgr" : [
    {
        "title" : "sales",
        "agent" : [
            "rohan@walkover.in",
            "abc@walkover.in"
        ],
        "last_interacted" : "abc@walkover.in"
    },
    {
        "title": "developer",
        "agent" : [
            "newdeveloper@walkover.in"
        ],
        "last_interacted" : "newdeveloper@walkover.in"
    }
] 
```

现在，每个嵌入的文档都包含相同的键，“title”、“agent”和“last_interacted”。

您可以使用以下命令更新子文档。

```
> db.sales.update({"act_mgr.title":"sales"}, {$push:{"act_mgr.$.agent":"abc@walkover.in"}, $set:{"act_mgr.$.last_interacted":"abc@walkover.in"}}) 
```

希望这将使您能够进行所需的更新，并可能为您提供有关模式设计的一些思考。祝你好运！

# java - GWT java小部件没有出现在指定的div上

> ID：10121109
> 
> 赞同：1
> 
> 时间：2012-04-12T09:42:18.330
> 
> 标签：java, gwt

我目前在使用 GWT 和 Eclipse 时遇到问题。在我当前的实现中，当我运行 > 调试为 > Web 应用程序时，我的 html 页面上没有任何小部件，即使我正在将它们加载到页面上的 div 中。

在图片中，您可以看到我在这个项目上的文件夹组织。 ![项目的文件夹组织](../Images/05dd47e9e15494c221cd8102340eb1c4.png)

所有相关文件的代码如下：

Anacom.gwt.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<module rename-to='AnacomGWT'>

<inherits name='com.google.gwt.user.User' />

<inherits name='com.google.gwt.user.theme.standard.Standard' />

<entry-point class='pt.ist.anacom.presentationserver.client.AnacomGWT' />

<source path='client' />

</module> 
```

AnacomGWT.java

```
package pt.ist.anacom.presentationserver.client;

import com.google.gwt.core.client.EntryPoint;

public class AnacomGWT implements EntryPoint{

private VerticalPanel mainPanel = new VerticalPanel();

private HorizontalPanel inserePanel = new HorizontalPanel();
private TextBox numBox = new TextBox();
private Button numBtn = new Button();

private HorizontalPanel smsPanel = new HorizontalPanel();
private TextArea smsText = new TextArea();
private TextBox smsBox = new TextBox();
private Button smsBtn = new Button();

private HorizontalPanel saldoPanel = new HorizontalPanel();
private TextBox saldoBox = new TextBox();
private Button saldoBtn = new Button();

private HorizontalPanel modoPanel = new HorizontalPanel();
private Label modoId = new Label();
private Button desligadoBtn = new Button();
private Button ligadoBtn = new Button();
private Button silencioBtn = new Button();
private Button ocupadoBtn = new Button();

@Override
public void onModuleLoad() {

    // Assemble insereBox
    inserePanel.add(numBox);
    inserePanel.add(numBtn);

    //assemble smsPanel
    smsPanel.add(smsText);
    smsPanel.add(smsBox);
    smsPanel.add(smsBtn);

    //assemble saldoPanel
    saldoPanel.add(saldoBox);
    saldoPanel.add(saldoBtn);

    //assemble modoPanel
    modoPanel.add(modoId);
    modoPanel.add(desligadoBtn);
    modoPanel.add(ligadoBtn);
    modoPanel.add(silencioBtn);
    modoPanel.add(ocupadoBtn);

    //assemble mainPanel
    mainPanel.add(inserePanel);
    mainPanel.add(smsPanel);
    mainPanel.add(saldoPanel);
    mainPanel.add(modoPanel);

    RootPanel.get("contents").add(mainPanel);

    numBox.setFocus(true);
}

} 
```

Anacom.html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"     "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Anacom</title>
</head>
<body>

<h1>Anacom</h1>
<div id="contents"></div>

</body>
</html> 
```

最后是 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE web-app
PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
"http://java.sun.com/dtd/web-app_2_3.dtd">
<web-app>
<welcome-file-list>
    <welcome-file>Anacom.html</welcome-file>
</welcome-file-list>
 </web-app> 
```

当我将应用程序作为 Web 应用程序运行时，在我得到的链接中，我只能看到包装在标签中的“ANACOM”，而我在 anacomGWT.java 上定义的面板都没有，它应该出现在“内容”中“ div 我打电话给：

```
RootPanel.get("contents").add(mainPanel); 
```

有人知道我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:20:44.583

我没有发现您的 html 和 GWT 之间有任何联系。您没有指定将在您的 html 页面 (Anacom.html.) 中使用哪个 gwt 模块。采用

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"     "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Anacom</title>
 <script type="text/javascript" language="javascript" src="anacom/anacom.nocache.js"></script>
</head>
<body>

<h1>Anacom</h1>
<div id="contents"></div>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:12:12.123

也许您必须设置至少一个元素/面板的宽度/高度？

您应该在浏览器上尝试其中一种开发工具（IE/chrome 上的原生工具，Fx 上的 Firebug）并查看在 DOM 上实际创建了哪些元素。这将为您的调试提供一些有意义的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T19:20:27.477

您的浏览器是否启用了对 Javascript 的支持？

# java - Jenkins：使用单元测试对 Maven-Release 进行自动版本检查

> ID：10121110
> 
> 赞同：2
> 
> 时间：2012-04-12T09:42:20.063
> 
> 标签：java, unit-testing, maven, jenkins, release

我正在尝试配置 Jenkins-Job 以使用 Maven-Release-Plugin 发布 Java-Project。
我想确保如果当前版本与前一个版本不兼容，我用来将版本标记为与早期主要版本不兼容的主要版本会发生变化。

一个例子：

> 最后一个版本是**1.9.5 版本**，其中包含一个名为 **Foo**的类。
> 在**当前版本中**，此类已被删除。
> 用户指定当前版本为**1.9.6**并启动 Jenkins-Job。
> 
> Release 应该告诉用户当前的主要版本应该是**2**而不是**1**，因为 API 变得不兼容。

我想过使用上一版本的单元测试来测试当前版本的代码。如果某些 API 变得不兼容，则以前版本的单元测试应该在编译或测试期间失败（假设该代码有一个单元测试）。

我的方法需要将测试保存在一个单独的项目中，并从我的 VCS 中检查两个版本。

您是否知道任何可能有助于这样做的 Jenkins-Plugin，或者您对如何检查 API 是否在两个主要版本之间变得不兼容有任何其他想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T11:27:01.260

由于我对您的 API 没有任何了解，因此无法提出任何与测试您的 API 兼容性相关的建议。

在 Jenkins/Maven 方面，我建议您使用名为“在其他项目上触发参数化构建”的构建后操作选项，将实际发布构建作为测试工作的下游工作运行

使用此功能，您可以根据此作业的结果触发不同参数的下游作业。即，如果整个测试套件通过，则触发次要版本构建，反之亦然。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T12:50:53.697

我认为为此使用 Jenkins 或发布插件没有任何意义——你要发布多少次主要版本？

您将单元测试分成不同项目的想法是一个很好的想法。只需针对您要发布的 -SNAPSHOT 版本运行先前版本的测试即可。如果他们通过了，那很好。否则，增加主版本号。

# iphone - iPhone 辅助功能画外音

> ID：10121111
> 
> 赞同：3
> 
> 时间：2012-04-12T09:42:21.543
> 
> 标签：iphone, xcode, accessibility, voiceover

**我正在创建一个应用程序，供视障用户使用画外音（在 iPhone 中内置的屏幕阅读器中）使用。某些视障人士使用外接键盘。**

1）有没有办法使用xCode控制iPhone中控件的阅读顺序？我希望一个特定的控件被一个接一个地读取。类似的功能可以通过其他编程语言中的 tabIndex 属性来实现。xCode 中是否有任何类似的属性可以用来控制控件的阅读/导航顺序？

2) 是否可以在任何事件上将焦点从一个元素转移到另一个元素？我尝试使用“nextResponder”，但它不起作用。

3）如果普通用户使用外接键盘的 iPhone，则很难理解当前键盘焦点在哪里，从而使应用程序难以使用。是否可以提供焦点插入符号（当前聚焦的控件周围的黑色边框？）当 Voiceover 为 ON 时，聚焦的项目周围会显示黑色边框

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-04T12:58:57.537

1) 你的意思是：[这个](https://stackoverflow.com/questions/13132805/accessibility-for-ios-voiceover-read-order-issue/13133633#13133633)

2) 有一种方法可以在更改后将焦点从一个元素切换到另一个元素

```
UIAccessibilityPostNotification(UIAccessibilityScreenChangedNotification, yourElementOfFocus); 
```

或者如果是布局更改

```
UIAccessibilityPostNotification(UIAccessibilityLayoutChangedNotification, yourElementOfFocus); 
```

3）我不太明白你的问题......如果打开了voiceOver，它不会自动在它当前关注的元素周围显示一个边框吗？

# php - MVCGRID CSV 导出错误

> ID：10121114
> 
> 赞同：0
> 
> 时间：2012-04-12T09:42:28.660
> 
> 标签：php, atk4, export-to-csv

我正在尝试导出使用对象 MVCgrid 创建的网格。

我发现我可以将当​​前页面添加到对象“MVCGrid_Export”而不是提供导出按钮和功能的对象“MVCGrid”。

顺便说一句，我在导出过程中遇到错误：

“致命错误：在第 42 行的 ..\agiletoolkit\atk4-addons\misc\lib\Export.php 中调用非对象的成员函数 getField()”

在那一行，“$b[] = $this->__getHeaderModel()->getField($ *a)->caption();”，我发现“$this->* _getHeaderModel()”的结果是一个字符串我要导出的模型，而不是该模型的对象，这是我需要的项目。

这是我页面的代码：

```
class page_resultsShow extends Page {
function initMainPage() {
    $p = $this;
    $gr = $this->add('MVCGrid_Export');
    $gr->setModel('results',array('name','budget','bestapplicants'));

    $gr->addColumnMVC('name');
    $gr->addFormatter('name','link');
    $gr->addQuickSearch(array('name'));
    $gr->addPaginator(20); 
}

//details...
function page_details() {
    ... some code..
}

function defaultTemplate(){
    return array('page/results');
} 
```

}

我想我需要添加一些信息来向网格解释正在处理的模型，但我没有找到如何！

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T11:20:36.420

我们已经为 4.2 推送了更新的导出模块

请更新 atk4-addons 和 atk4 以确保您在 master 分支上（现在是 4.2）。

语法现在有点不同，因为 Export 现在充当控制器。

```
class page_index extends Page {
    function init(){
        parent::init();
        $c=$this->add("Grid");
        $c->setModel("A");
        $c->addPaginator(1);
        $c->add("Export");

        $c=$this->add("CRUD");
        $c->setModel("A");
        if ($c->grid){
            $c->grid->addPaginator(1);
        }
        $c->add("Export");
    }
} 
```

* * *

从电子邮件到 atk4 组：

// 假设你有网格

```
$export = $grid->add("Export"); 
```

// 这会将导出 xls 和导出 csv 按钮添加到您的网格

//如果你有crud：

```
$export = $crud->add("Export"); 
```

// 这会将导出 xls 和导出 csv 按钮添加到您的网格

现在，您可以轻松地创建新的“解析器”，通过创建

`Export_Parser_Xyz`班级。

然后只需将其添加到您的导出中：

```
$export->add("Export_Parser_Xyz"); 
```

非常重要的更新是它现在在被分页器、过滤器等更改后使用 dq，以便它可以准确地导出显示的内容。可选，是默认情况下被删除的限制，但可以在解析器级别进行控制。

这将自动将按钮添加到网格/crud 并处理来自相应网格/crud 数据源的数据流。

注意！

导出仅适用于基于 dq 的网格，如果定义了模型，则尝试从模型的字段定义中加载标题。PDF 解析器在这一点上被忽略了，因为它非常具体并且需要特定的第 3 方软件。

如果您想让旧的导出模块按照说明`lib/Export.php`启用兼容模式。

* * *

# domain-driven-design - 具有标识的值对象

> ID：10121117
> 
> 赞同：3
> 
> 时间：2012-04-12T09:42:36.673
> 
> 标签：domain-driven-design

在应用程序中，我们已将其建模`Company`为实体和`Address`值对象：

```
public class Company : Entity  {
    public Address PrimaryAddress { get; set; }
    public Address SecondaryAddress { get; set; }
}

public class Address : ValueObject {
    public string ZipCode { get; private set; } // etc.

    public Address(string zipCode) {
        ZipCode = zipCode;
    }
} 
```

在这里，`Address`没有身份并且是不可变的。为了更新`PrimaryAddress`公司，我将其替换为新`Address`对象。

但是，在进一步发现该域后，我们发现一家公司可能拥有可变数量的地址。将它们表示为单独的属性不再可行。所以我们重构了`Company`：

```
public class Company : Entity  {
    public Address[] AddressBook { get; set; }
} 
```

我们现在有一个问题是如何更新公司的`Address`. 我们*现在*关心地址的身份，但**仅在 Company 的上下文中**。

重构之后，我们最终得到：

```
public class Company : Entity  {
    public Address[] AddressBook { get; set; }

    public void UpdateAddress(Address newAddress) {
        var oldAddress = AddressBook.FirstOrDefault(a => a.Id == newAddress.Id);
        if (oldAddress != null)
            oldAddress = newAddress;
    }
}

public class Address : ValueObject {
    public Guid Id { get; private set; }
    public string ZipCode { get; private set; } // etc. 

    public Address(Guid id, string zipCode) {
        ZipCode = zipCode;
        Id = id;
    }
}

// usage
var company = repo.Load<Company>(companyId);
var address = new Address(model.Id, "12345"); // uses id of address we are replacing

company.UpdateAddress(address);
repo.Save(company); 
```

为了更新地址，我们使用它来定位它，并将其`Id`替换为具有**相同**ID 的新地址对象。

*   因此 Address 仍然是一个值对象吗？
*   我对更新的地址使用*相同*的ID 是否正确，或者根据定义（作为值对象）我们应该**替换**Id。
*   如果地址仅在公司实体的上下文中具有身份，我们是否应该在我们的模型中明确这一点，也许生成一个仅在实体内部唯一的 ID（可能使用实体的 ID 作为计算的一部分）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T11:44:52.033

> 因此 Address 仍然是一个值对象吗？

我会说不，只要你给 Address 一个身份，它就不再是一个值对象。这意味着您不再只关心它的属性，而是开始重视应用程序中的地址生命周期，跟踪其状态的变化等。

> 我对更新的地址使用相同的 ID 是否正确，或者根据定义（作为值对象）我们应该替换 Id。

我不会重用地址 ID。从域的角度来看，当公司搬迁时，地址本身不会发生变化。该地址仍将有有效的门牌号和建筑物。由该身份定义的地址仍然存在，您甚至可以想象为其他公司重用它。因此，当公司搬家时，只需更改 Company 和 Address 之间的关联以指向具有新 ID 的新地址。

> 如果地址仅在公司实体的上下文中具有身份，我们是否应该在我们的模型中明确这一点，也许生成一个仅在实体内部唯一的 ID（可能使用实体的 ID 作为计算的一部分）？

仅仅因为您觉得需要在公司内部挑选出不同的地址并不意味着您必须给它们一个 Id 并使它们成为实体而不是值对象。例如，如果您想对公司内部的地址进行排名、定义主地址等，您可以使用值对象完美地做到这一点。地址值对象将保持不变，您可以只在 Company 中拥有一个索引集合、一个 PrimaryAddress 字段等。

# java - Android非静态字符串到静态字符串错误

> ID：10121118
> 
> 赞同：2
> 
> 时间：2012-04-12T09:42:40.313
> 
> 标签：java, android, sqlite, static, non-static

我正在 android 中构建一个数据库类，它从 getIntent().getStringExtra(name) 函数收集字符串非静态数据。我将这个值放入一个简单的字符串变量（非静态）中。

当我尝试在静态字符串中使用它时，出现错误 - “无法对非静态字段进行静态引用”。

我该如何解决这个问题？这是我的代码：

```
package ent.com;

import android.app.Activity;
import android.content.Context;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.database.sqlite.SQLiteOpenHelper;
import android.os.Bundle;

public class SetSql extends Activity{

String saveExtra = getIntent().getStringExtra("save");

public static final String KEY_ROWID = "_id";
public static final String KEY_SAVE = "save_name";
public static final String KEY_STADUIM = "stadium_size";
public static final String KEY_FINANCE = "total_money";
public static final String KEY_PLAYERS = "players";

private static String DATABASE_NAME = "save" + saveExtra;
private static final String DATABASE_TABLE = "save_data";
private static final int DATABASE_VERSION = 1;

private static class DbHelper extends SQLiteOpenHelper{

    public DbHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

}

} 
```

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:02:45.650

尝试这个

```
String saveExtra = null; 
private static String DATABASE_NAME = "save" ; 
```

在 OnCreate

```
String saveExtra = getIntent().getStringExtra("save");
DATABASE_NAME += saveExtra; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T09:57:11.613

您的静态变量`DATABASE_NAME`在加载 SetSql 类后立即初始化，而实例变量`saveExtra`仅在创建实例时才初始化。

您可以`DATABASE_NAME`在 SetSql 类构造函数中设置值，但要注意它会影响SetSql 的**所有**实例，而不仅仅是接收意图的实例。

恕我直言，最简单的选择是设置`DATABASE_NAME`为实例变量，如`saveExtra`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T09:57:22.940

从活动级别删除这一行`String saveExtra = getIntent().getStringExtra("save");` ，并将其写入您的`onCreate()`.

只需在活动级别声明您的变量 saveExtra 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T09:57:51.767

```
private static String saveExtra =null; 
```

在

```
onCreate 
```

用这个

```
saveExtra = getIntent().getStringExtra("save"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T09:50:31.260

尝试使用静态“getDatabaseName”方法来访问您的字符串。

# entity-framework - 实体框架，如何仅验证指定属性

> ID：10121121
> 
> 赞同：0
> 
> 时间：2012-04-12T09:42:53.667
> 
> 标签：entity-framework, validation

我有一个演示类“用户”，如下所示：

```
public partial class User {
    [Key]
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int ID { get; set; }

    [StringLength(30)]
    [Required]
    public string LoginName { get; set; }

    [StringLength(120)]
    [Required]
    [DataType(DataType.Password)]
    public string Pwd { get; set; }

    [StringLength(50)]
    public string Phone { get; set; }

    [StringLength(100)]
    public string WebSite { get; set; } 
```

... ... }

如您所见，“登录名”和“密码”是“必填项”。

有时，我只想更新用户的“网站”，所以我这样做：

```
 public void UpdateUser(User user , params string[] properties) {
        this.rep.DB.Users.Attach(user);
        this.rep.DB.Configuration.ValidateOnSaveEnabled = false;
        var entry = this.rep.DB.Entry(user);
        foreach(var prop in properties) {
            var entProp = entry.Property(prop);
            //var vas = entProp.GetValidationErrors();
            entProp.IsModified = true;
        }
        this.rep.DB.SaveChanges();
        this.rep.DB.Configuration.ValidateOnSaveEnabled = true;
    } 
```

像这样的参数“user”：new User(){ ID = 1, WebSite = "http://www.stackoverflow.com" }

注意，我没有指定“LoginName”和“Pwd”

此功能可以正常工作，但我不会将 ValidateOnSaveEnabled 设置为 false。

当 ValidateOnSaveEnabled 为真时，是否有任何方法仅验证“WebSite”？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T09:22:17.500

我得到一个解决方案。首先定义PartialValidationManager：

```
public class PartialValidationManager {

    private IDictionary<DbEntityEntry , string[]> dics = new Dictionary<DbEntityEntry , string[]>();

    public void Register(DbEntityEntry entry , string[] properties) {
        if(dics.ContainsKey(entry)) {
            dics[entry] = properties;
        } else {
            dics.Add(entry , properties);
        }
    }

    public void Remove(DbEntityEntry entry) {
        dics.Remove(entry);
    }

    public bool IsResponsibleFor(DbEntityEntry entry) {
        return dics.ContainsKey(entry);
    }

    public void ValidateEntity(DbEntityValidationResult result) {
        var entry = result.Entry;
        foreach(var prop in dics[entry]){
            var errs = entry.Property(prop).GetValidationErrors();
            foreach(var err in errs) {
                result.ValidationErrors.Add(err);
            }
        }
    }
} 
```

2、将此Manager添加到My DbContext：

```
public class XmjDB : DbContext {

    public Lazy<PartialValidationManager> PartialValidation = new Lazy<PartialValidationManager>();

    protected override System.Data.Entity.Validation.DbEntityValidationResult ValidateEntity(DbEntityEntry entityEntry , IDictionary<object , object> items) {
        if(this.PartialValidation.Value.IsResponsibleFor(entityEntry)) {
            var result = new DbEntityValidationResult(entityEntry , new List<DbValidationError>());
            this.PartialValidation.Value.ValidateEntity(result);
            return result;
        } else
            return base.ValidateEntity(entityEntry , items);
    } 
```

……

更新方法：

```
 public void UpateSpecifyProperties(T t, params string[] properties) {
        this.DB.Set<T>().Attach(t);
        var entry = this.DB.Entry<T>(t);
        this.DB.PartialValidation.Value.Register(entry , properties);
        foreach(var prop in properties) {
            entry.Property(prop).IsModified = true;
        }
        this.DB.SaveChanges();
        this.DB.PartialValidation.Value.Remove(entry);
    } 
```

好的，它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:00:18.753

[据我所知](http://social.msdn.microsoft.com/Forums/ar/adodotnetentityframework/thread/cacc3156-6b5f-4412-a8b8-a1279d28a536)，执行的`SaveChanges`验证总是验证整个实体。在您的代码中注释了对属性进行选择性验证的技巧，但它不是`SaveChanges`操作的一部分。

# css - 为什么 jquery ui 按钮在 Firefox 和 Chrome 中看起来不同

> ID：10121131
> 
> 赞同：0
> 
> 时间：2012-04-12T09:43:20.937
> 
> 标签：css, jquery-ui, firefox, google-chrome

我已经上传了一个示例页面 [https://bobdn.com/Temp.aspx](https://bobdn.com/Temp.aspx)。

此页面只有一个 jquery UI 按钮。

为什么这在 Firefox 中看起来很小。填充和字体大小看起来都很大。它在镀铬中看起来不错。

如何使两个浏览器的大小（填充，字体等）相等？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T11:08:55.153

我猜它是`<input>`元素的不一致渲染。我可以验证每个浏览器之间的渲染是不一致的，有 2px 的高度差。

如果您可以改用一个`<button>`元素，您可能会发现它在不同浏览器之间的渲染更加一致，尽管您很可能必须自己调整填充。

完成后，您需要尝试显式设置任何相关样式，而不是依赖默认值。这包括：行高、填充、字体大小、边框宽度等等。每个浏览器都有自己的默认值。如果要保持一致性，则必须提供替换默认值的 css。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T19:23:10.523

我通过明确设置默认值解决了这个问题。
前任。我创建了一个带有 padding:2px 的 input.navigation_button CSS 类（Chrome 在我的按钮上有零填充）。

# plugins - 尝试使用 Java 中的插件配置活动 MQ 代理，应该在哪里 属性指向？

> ID：10121136
> 
> 赞同：1
> 
> 时间：2012-04-12T09:43:38.063
> 
> 标签：plugins, jms, activemq

我正在尝试配置一个安装了插件的 activemq 代理，但似乎无法在代理配置文件中正确获取插件类的限定名称。我已经粘贴了错误消息，然后是下面的代理配置。基本上在元素中我指定 class="file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin" 这是 XmlValidationPlugin.class 文件的绝对路径（有尝试将 .class 附加到上面的路径，但我得到了同样的错误）。最初我假设类属性应该指向 .class 文件，但尝试将其指向 .java 并且仍然无法正常工作。我已经阅读了关于开发插件、常见问题解答、spring 文档等的活动 MQ 常见问题解答。

我的类路径是 .;JAVA_HOME\lib;C:\Marcus\JavaProjects\Project;C:\Marcus\JavaProjects\Project\build\prod\classes 和 JAVA_HOME 是：C:\Program Files\Java\jdk1.7.0_03

所有 java 源代码都位于 C:\Marcus\JavaProjects\Project\src 中，.class 文件位于 C:\Marcus\JavaProjects\Project\build\prod\classes 中（类中的文件结构反映了 src 中的文件结构，例如com.foo.jms.amqplugin.XmlValidationPlugin 将在 classes/com/foo/jms/amqplugin 中拥有其 .class 文件）

有问题的插件是 XmlValidationPlugin.java，位于包中的文件夹 src 中：com.foo.jms.amqplugin

我曾尝试将 XmlValidationPlugin.class 放在 JAR 中并将 JAR 放在 activemqinstalldir/lib 中（正如向其他遇到类似问题的人所推荐的那样），但这并没有帮助。

我已经花了一天半的时间，如果有人知道 plugins 类属性的值应该是什么，我将不胜感激，因为我已经尝试了一切......提前致谢！

错误输出顶部：

```
C:\Program Files\apache-activemq-5.5.1>bin\activemq xbean:file:C:/Marcus/JavaProjects/Project/config/custom-broker.xml
Java Runtime: Oracle Corporation 1.7.0_03 C:\Program Files\Java\jdk1.7.0_03\jre
  Heap sizes: current=15872k  free=14246k  max=506816k
    JVM args: -Dcom.sun.management.jmxremote -Xmx512M -Dorg.apache.activemq.UseDedicatedTaskRunner=true -Djava.util.logging.config.file=logging.properties -Dactivemq.classpath=C:\Program Files\apache-
activemq-5.5.1\bin\../conf;C:\Program Files\apache-activemq-5.5.1\bin\../conf; -Dactivemq.home=C:\Program Files\apache-activemq-5.5.1\bin\.. -Dactivemq.base=C:\Program Files\apache-activemq-5.5.1\bin\
..
ACTIVEMQ_HOME: C:\Program Files\apache-activemq-5.5.1\bin\..
ACTIVEMQ_BASE: C:\Program Files\apache-activemq-5.5.1\bin\..
Loading message broker from: xbean:file:C:/Marcus/JavaProjects/Project/config/custom-broker.xml
 INFO | Refreshing org.apache.activemq.xbean.XBeanBrokerFactory$1@7a8ba4: startup date [Thu Apr 12 10:38:26 CEST 2012]; root of context hierarchy
ERROR: java.lang.RuntimeException: Failed to execute start task. Reason: org.springframework.beans.factory.BeanDefinitionStoreException: Failed to load type: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin. Reason: java.lang.ClassNotFoundException: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin; nested exception is java.lang.ClassNotFoundException: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin
java.lang.RuntimeException: Failed to execute start task. Reason: org.springframework.beans.factory.BeanDefinitionStoreException: Failed to load type: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin. 
Reason: java.lang.ClassNotFoundException: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin; nested exception is java.lang.ClassNotFoundException: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin
        at org.apache.activemq.console.command.StartCommand.runTask(StartCommand.java:98)
        at org.apache.activemq.console.command.AbstractCommand.execute(AbstractCommand.java:57)
        at org.apache.activemq.console.command.ShellCommand.runTask(ShellCommand.java:143)
        at org.apache.activemq.console.command.AbstractCommand.execute(AbstractCommand.java:57)
        at org.apache.activemq.console.command.ShellCommand.main(ShellCommand.java:85)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    ... 
```

经纪人配置文件：

```
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:amq="http://activemq.apache.org/schema/core"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
  http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd">

    <!-- Allows us to use system properties as variables in this configuration file -->
  <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
      <value>file:${activemq.base}/conf/credentials.properties</value>
    </property>
  </bean>

  <!--The <broker> element is used to configure the ActiveMQ broker. -->
  <broker xmlns="http://activemq.apache.org/schema/core" brokerName="localhost"
    dataDirectory="${activemq.base}/data">

        ...

    <!--plugin-->
    <plugins>
      <bean xmlns="http://www.springframework.org/schema/beans" 
            id="xmlValidationPlugin"  
            class="com.foo.jms.amqplugin.XmlValidationPlugin"/>
    </plugins>

  </broker>

</beans> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:10:07.843

> 基本上在元素中我指定 class="file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin" 这是 XmlValidationPlugin.class 文件的绝对路径（有尝试将 .class 附加到上面的路径，但我得到了同样的错误）。最初我假设类属性应该指向 .class 文件，但尝试将其指向 .java 并且仍然无法正常工作。

您得到的错误似乎来自类加载器。

```
Reason: java.lang.ClassNotFoundException: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin; nested exception is java.lang.ClassNotFoundException: file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin 
```

类加载器需要一个完全限定的类名，而不是类文件的路径。尝试指定完全限定的类名而不是类文件的路径。

代替：

```
file:C:/Marcus/JavaProjects/Project/build/prod/classes/com/foo/jms/amqplugin/XmlValidationPlugin 
```

采用：

```
com.foo.jms.amqplugin.XmlValidationPlugin 
```

并确保 CLASSPATH 环境变量将包含：C:/Marcus/JavaProjects/Project/build/prod/classes

如果 ActiveMQ 使用一些自定义类加载器来加载插件（我不知道细节），您可能需要以一些 ActivemMQ 特定的方式指定类路径。

# android - 使用 Android 在 PhoneGap 上启用视口

> ID：10121138
> 
> 赞同：0
> 
> 时间：2012-04-12T09:43:49.500
> 
> 标签：android, cordova, viewport

PhoneGap：1.5.0，安卓：2.3.4

我在我的 HTML 中添加了一个视口标签，如下所示：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no;"> 
```

但它不起作用。我有一个宽度 = 320px 的窗口，但它应该是 480px。

当我用谷歌搜索这个问题时，我发现了这个：

将这两行添加到`onCreate()`：

```
this.appView.getSettings().setUseWideViewPort(true);
this.appView.getSettings().setLoadWithOverviewMode(true); 
```

但是在我插入这两行之后，我无法再启动到 WebView 了！相反，我得到了以下异常：

```
ActivityThread.performLaunchActivity(ActivityThread$ActivityRecord, Intent) line: 2496 
```

[这是异常截图](http://dl.dropbox.com/u/15595413/temp/error.png)

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-13T02:51:27.023

试试这个代码：

活动文件：

```
public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                WindowManager.LayoutParams.FLAG_FULLSCREEN | 
                WindowManager.LayoutParams.FLAG_FORCE_NOT_FULLSCREEN);
        super.loadUrl("file:///android_asset/www/index.html");
    } 
```

.html 文件

```
<meta name="viewport" content="width=device-width,height=device-height,user-scalable=no,target-densitydpi=250,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" /> 
```

用 android AndroidManifest.xml`android:screenOrientation="landscape"` 横向显示全屏

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-27T01:02:14.727

我已经在这里回答了我的修复：[https](https://stackoverflow.com/a/28755743/4612666) ://stackoverflow.com/a/28755743/4612666 基本上将 AndroidManifest.xml min/target 版本更改为：

```
<uses-sdk android:minSdkVersion="7" /> 
```

可以玩的版本，不太确定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-21T09:56:39.053

刚刚测试，偏好不是完整的解决方案，请执行以下操作：

配置.xml：`<preference name="EnableViewportScale" value="true" />`

主要活动，在 loadurl 之后的设置中启用视口：

```
super.loadUrl(Config.getStartUrl(),1);   
WebSettings settings = appView.getSettings(); 
settings.setUseWideViewPort(true); 
settings.setLoadWithOverviewMode(true); 
```

# xcode4 - Xcode 4 - IOS - 模拟器不可用作构建目标

> ID：10121143
> 
> 赞同：14
> 
> 时间：2012-04-12T09:44:24.553
> 
> 标签：xcode4, ios-simulator

我有一个奇怪的问题......我无法找到模拟器作为设备来测试我的应用程序。有人知道如何解决吗？在一个新项目中，它是可用的。

![奇怪的](../Images/f36cba829b0bf99e0e72def542d31eac.png)

问候， EZFrag

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-02T04:41:32.597

这就是发生在我身上的事情……当我更新到最新版本的 XCode (4.3.2) 时，我没有费心去卸载以前的版本。我错误地在不了解 5.1 的旧版本 XCode 中打开了我的 iOS 5.1 目标项目，因此模拟器不可用。所以我会检查以下内容：

*   查看您当前运行的 XCode 版本
*   尝试检查您的**iOS 部署目标**...（目标 -> 部署）。如果选择 iOS 5.1 将其更改为 iOS 5.0（模拟器将立即显示）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-15T09:34:43.290

除了 G.Bickham 的回答，请确保下载了 iOS 模拟器。

要验证下载状态，请转到 Xcode 的**Preferences > Downloads > Components > iOS Simulator**

![在此处输入图像描述](../Images/e8acaa22978d78861b6801a5ae21dd11.png)

# css - 如何在下拉导航css中将第二级添加到子菜单

> ID：10121146
> 
> 赞同：0
> 
> 时间：2012-04-12T09:44:40.183
> 
> 标签：css, navigation, drop-down-menu

我创建了下面列出的导航菜单：

```
<div class="menu">
    <ul>
        <li>
            <a href="index.php" target="_self" >Home</a>
        </li>
        <li>
            <a href="preparation.php" target="_self" >Gallery</a>
            <ul>
                <li>
                    <a href="digital.php" target="_self">Storybooks</a>
                </li>
                <li>
                    <a href="preparation.php" target="_self">Preparation</a>
                </li>
                <li>
                    <a href="ceremony.php" target="_self">Ceremony</a>
                </li>
                <li>
                    <a href="private.php" target="_self">Personal Shooting</a>
                </li>
                <li>
                    <a href="firstdance.php" target="_self">First Dance</a>
                </li>
                <li>
                    <a href="details.php" target="_self">Details</a>
                </li>
            </ul>
        </li>
        <li>
            <a href="login.php" target="_self" >Customers</a>
        </li>
        <li>
            <a href="about.php" target="_self" >About</a>
        </li>
        <li>
            <a href="contact.php" target="_self" >Contact</a>
        </li>
    </ul>
</div> 
```

目前这个菜单的 CSS 是：

```
.menu {
    margin: 0px;
    padding: 0px;
    font-family: "Times New Roman";
    font-size: 14px;
    font-weight: bold;
    color: #6D6D6D;
}
.menu ul {
    height: 26px;
    list-style: none;
    margin: 0;
    padding: 0;
}
.menu li {
    float: left;
    padding: 0px;
}
.menu li a {
    color: #6D6D6D;
    display: block;
    font-weight: normal;
    line-height: 26px;
    margin: 0px;
    padding: 0px 25px;
    text-align: center;
    text-decoration: none;
}
.menu li a:hover, .menu ul li:hover a {

    background: #ca9875 url("menu_images/hover.gif") bottom center no-repeat;
    color: #6D6D6D;
    text-decoration: none;
}
.menu li ul {
    /*background:#333333;*/
    /*background: #B32267;*/
    background: white;
    display: none;
    height: auto;
    padding: 0px;
    margin: 0px;
    border: 0px;
    position: absolute;
    /*width: 225px;*/
    width: 135px;
    z-index: 200;
    /*top:1em;
     /*left:0;*/
}
.menu li:hover ul {
    display: block;
}
.menu li li {
    background: url('menu_images/sub_sep.gif') bottom left no-repeat;
    display: block;
    float: none;
    margin: 0px;
    padding: 0px;
    /*width: 225px;*/
    width: 135px;
}
.menu li:hover li a {
    background: none;
}
.menu li ul a {
    display: block;
    height: 26px;
    font-size: 13px;
    font-style: normal;
    margin: 0px;
    padding: 0px 10px 0px 15px;
    text-align: left;
}
.menu li ul a:hover, .menu li ul li:hover a {
    background: #ca9875 url('menu_images/hover_sub.gif') center left no-repeat;
    border: 0px;
    color: #ffffff;
    text-decoration: none;
}
.menu p {
    clear: left;
} 
```

我想知道是否有办法将二级子菜单添加到“故事书”类别？我的意思是当我将鼠标悬停在“故事书”上时，我想查看右侧的另一个子菜单。这可以用css吗？感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T09:59:08.690

我在上面编辑了您的代码以使其正常工作，请参阅[http://jsfiddle.net/BVvc6/1/](http://jsfiddle.net/BVvc6/1/)以获取新代码。

注意：我在 Storybooks 下方添加了两个菜单点，分别称为 Storybook 1 和 Storybook 2。CSS 被添加到现有代码的底部（上面没有更改）。

编辑：您应该稍微清理一下您的 CSS 代码，例如使用 CSS 选择器`>`来匹配特定的 DOM 级别。

# c# - Api 控制器声明了多个 Get 语句

> ID：10121152
> 
> 赞同：43
> 
> 时间：2012-04-12T09:45:12.587
> 
> 标签：c#, asp.net-mvc-4, asp.net-web-api, asp.net-routing

在 MVC4 中使用新的 Api Controller，我发现了一个问题。如果我有以下方法：

`public IEnumberable<string> GetAll()`

`public IEnumberable<string> GetSpecific(int i)`

这将起作用。但是，如果我想检索一些不同类型的不同数据，它默认为`GetAll`方法，即使`$.getJSON`设置为`GetAllIntegers`方法：

`public IEnumberable<int> GetAllIntergers()`

*（错误的命名约定）*

我有可能做到这一点吗？

`GetAll`我可以在 Web API 控制器中只有一个方法吗？

我认为更容易想象我想要实现的目标。这是一段代码，用于显示我希望能够做的事情，在一个单一的`ApiController`：

```
public IEnumerable<string> GetClients()
{ // Get data
}

public IEnumerable<string> GetClient(int id)
{ // Get data
}

public IEnumerable<string> GetStaffMember(int id)
{ // Get data
}

public IEnumerable<string> GetStaffMembers()
{ // Get data
} 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-04-12T11:13:43.190

这一切都在路由中。默认的 Web API 路由如下所示：

```
config.Routes.MapHttpRoute( 
    name: "API Default", 
    routeTemplate: "api/{controller}/{id}", 
    defaults: new { id = RouteParameter.Optional } 
); 
```

使用默认路由模板，Web API 使用 HTTP 方法来选择操作。结果，它将不带参数的 GET 请求映射到`GetAll`它可以找到的第一个请求。要解决此问题，您需要定义包含操作名称的路由：

```
config.Routes.MapHttpRoute( 
   name: "ActionApi", 
   routeTemplate: "api/{controller}/{action}/{id}", 
   defaults: new { id = RouteParameter.Optional } 
); 
```

之后，您可以使用以下 URL 提出请求：

*   api/yourapicontroller/GetClients
*   api/yourapicontroller/GetStaffMembers

这样你就可以`GetAll`在Controller中有多个。

这里更重要的一点是，使用这种路由风格，您必须使用属性来指定允许的 HTTP 方法（如 [HttpGet]）。

还有一个将基于默认 Web API 动词的路由与传统方法混合的选项，这里有很好的描述：

*   [Web API：混合传统和基于动词的路由](http://blog.appliedis.com/2013/03/25/web-api-mixing-traditional-verb-based-routing/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-03-03T18:00:54.947

以防其他人面临这个问题。这是我解决这个问题的方法。使用控制器上的 [Route] 属性路由到特定的 url。

```
[Route("api/getClient")]
public ClientViewModel GetClient(int id)

[Route("api/getAllClients")]
public IEnumerable<ClientViewModel> GetClients() 
```

# c++ - 我如何在这里使用新的展示位置？

> ID：10121157
> 
> 赞同：4
> 
> 时间：2012-04-12T09:45:28.967
> 
> 标签：c++, memory-management, new-operator

我有一个内存区域，将用于多个队列。例如，我分配了 1024 字节的内存，我需要两个队列。第一个队列将占用前 512 个字节，第二个队列将占用接下来的 512 个字节。

但是，我的队列由 C++ 类表示。使用placement new 运算符，我如何构造每个队列对象。以下方法是否正确？

```
Queue *q1, *q2;
void *mem = malloc( 1024 );

*q1 = new (mem) Queue;
*q2 = new (mem+512)Queue; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T09:48:30.993

我会做以下事情：

```
Queue* mem = static_cast<Queue*>(malloc(2 * sizeof(Queue));
Queue* q1 = new (mem) Queue;
Queue* q2 = new (mem+1) Queue; 
```

如果两个队列彼此恰好相距 512 个字节很重要，那么您的原始建议几乎是正确的：

```
char* mem = static_cast<char*>(malloc(1024));
Queue* q1 = new (mem) Queue;
Queue* q2 = new (mem+512) Queue; 
```

这假设`sizeof(Queue) <= 512`. 强制转换为的原因`char*`是指针算术 with`void*`在 C++ 中是非法的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T09:53:33.473

除非 sizeof(Queue) == 512，除非你有一个非常专业的实现，否则它可能不是，那么你的方法是行不通的。您需要确保将实际节点分配在 malloc 给定的内存片上。至于使用placement new，而不是隐瞒内存对齐的潜在问题：

```
 char* mem = static_cast< char* >( malloc( 1024 ) );
 Queue* q1 = new ( mem ) Queue;
 Queue* q1 = new ( mem + 512 ) Queue; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T09:56:38.213

这对我来说看起来很奇怪。我看不出这样做的理由。您需要免费保存“mem”

当我一次想要两个队列时，我会这样做

```
class DoubleQueue {
   public Queue q1;
   public Queue q2;
}

...
DoubleQueue dq = new DoubleQueue; 
```

或者

```
Queue queue [] = new Queue [2]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:03:59.647

看来，您在两个分配运算符的 lhs 上都有未初始化指针的指针取消引用，因此，您尝试将地址分配给值。

对我来说，这段代码意味着 Queue 类位于数据块的顶部，对它一无所知（您没有 Ctor 参数，表示内存块大小）。也许给 Queue 对象一个指向内存块的指针和一个指向它的 Ctor 的块大小更方便？

# php - 为什么我不能使用此代码删除数据？

> ID：10121160
> 
> 赞同：0
> 
> 时间：2012-04-12T09:45:35.803
> 
> 标签：php, xampp

我用php和xampp写了一个笔记本，不知何故我的删除功能不起作用有人能找出问题吗？

```
admin   %   global  ALL PRIVILEGES  Yes     Edit Privileges Edit Privileges
database-specific   ALL PRIVILEGES  No  Edit Privileges Edit Privileges
admin   localhost   global  ALL PRIVILEGES  Yes     Edit Privileges Edit Privileges
database-specific   ALL PRIVILEGES  No  Edit Privileges Edit Privileges
root    127.0.0.1   global  ALL PRIVILEGES  Yes     Edit Privileges Edit Privileges
root    localhost   global  ALL PRIVILEGES  Yes     Edit Privileges Edit Privileges

 ALTER TABLE `note` CHANGE `id` `id` INT( 100 ) NOT NULL AUTO_INCREMENT ,
CHANGE `topic` `topic` VARCHAR( 1000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL ,
CHANGE `topicoutline` `topicoutline` VARCHAR( 2000 ) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL ,
CHANGE `timestamp` `timestamp` TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00' 
```

```
 <?php
    $userName = "admin";
    $password = "admin";
    $hostname = "localhost";
    $databaseName = "notebook";
    $tableName = "note";
    $myDB = mysql_connect("localhost", $userName, $password);

if ($myDB) { print "Database Connect succeeded<p>"; }
else { print "Database Connect failed<p>"; die(1);}

//connect and astart using the database

$status = mysql_select_db($databaseName, $myDB);
if ($status) 
{ echo "Select Database $databaseName succeeded<p>"; }
else 
{ echo "Select Database $databaseName failed<p>";}

#$result = mysql_query('Select * from note', $myDB );

 #while ($row = mysql_fetch_row($result)) {

    #echo $row[0] . ", "; #display results
    #echo $row[1] . ", ";
    #echo $row[2] . ", ";
    #echo $row[3] . "<p>";
#}
#mysql_free_result($result); # release memory
#mysql_close($myDB);

  function AddTopic() {
      global $myDB, $this_script;

      if (isset ($_POST['topic']))
      $topic = $_POST['topic'];
      else 
      return;

      if (isset ($_POST['topicoutline']))
      $topicoutline = $_POST['topicoutline'];
      else 
      return;

      if($topic == "" || $topicoutline == "")
      return;

      $query = "insert into note (topic, topicoutline, timestamp) values('$topic', '$topicoutline', now());";
      $result = mysql_query($query, $myDB);

      if (!$result) mysql_error($myDB);
      else header("Location: $this_script"); #redirect to Show all
      }

  function ShowAll() {
       global $myDB;
      $query="Select * from note;";
      $result = mysql_query($query, $myDB );
    while ($row = mysql_fetch_object($result)) {
    echo $row->id . "<br>";
    echo $row->topic . "<br>";
    echo $row->topicoutline . "<br>";
    echo $row->timestamp . "<p>";
    }       

     mysql_free_result($result);
    }

    function td($item){
    return "<td>$item</td>\n";
    }

    function linktodelete($url, $prompt){

    return "<a href = '$url'>$prompt</a>";

    }

    function FrontPage() {

       global $myDB, $this_script;
       deleteTopic();
       AddTopic();

    if (isset($_REQUEST['findthis'])) 
    $where = $_REQUEST['findthis'];
    else $where = '';
    $query = 'Select * from note';
    if ($where) 
    $query = $query . " where topic like '%$where%' or topicoutline like '%$where%'";
    $query = $query .";" ;
    $result = mysql_query($query, $myDB );
    print "<table border='1' bgcolor='#AADDFF' width='80%'>\n";

    print "<tr><td>id</td> <td>topic</td> <td>topicoutline</td> <td>timestamp</td></tr> \n";

    while ($row =mysql_fetch_object($result)) {
    $id = $row->id;
    print "<tr>";

    print td($row->id). td($row->topic). td($row->topicoutline). td($row->timestamp). td(linktodelete($this_script . "?cmd=del&id=$id","Delete"));
    print "</tr>\n";

    }

    print "<table>\n";
    mysql_free_result($result);

    print DisplayFindForm();
    print DisplayNameAdditionForm();
    }
  //showAll();

  function deleteTopic() {
  global $myDB, $this_script;
  if (isset($_REQUEST['$id']))
    $id = $_REQUEST['id'];
    else
    $id = '';
    $query = "delete from note where id='$id';";
    $result = mysql_query($query, $myDB);
  if (!$result) mysql_error($myDB);
  else header("Location: $this_script");
  }

    function DisplayNameAdditionForm() {
    global $this_script;
    print "
    <hr>
    <form method='POST' action='$this_script'>
    <input type='hidden' name='cmd' value='add'>
    topic <input type='text' name='topic' size='100'>
    topicoutline <input type='text' name='topicoutline' size='100'>
    <input type='submit' value=' Add ' name='B1'>
    </form>
    ";
    }

    function DisplayFindForm() {
    global $this_script;
    print "
    <hr>
    <form method='POST' action='$this_script'>
    <input type='hidden' name = 'cmd' value='find'>
    <input type='text' name = 'findthis' size='20'>
    <input type='submit' value=' Find name ' name='B1'>
    </form>
    ";
    }

  FrontPage();

  ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:48:01.073

```
if (isset($_REQUEST['$id']))
                     ^ 
```

必须删除美元符号。

# magento-1.5 - Magento中的价格表

> ID：10121161
> 
> 赞同：1
> 
> 时间：2012-04-12T09:45:37.533
> 
> 标签：magento-1.5

能否指导我们如何构建基于 ajax 的价格表以显示在 magento 的左侧栏中，或者让我知道是否有任何免费扩展

# java - 有没有办法使用 MBean 记录 jvm GC 活动？

> ID：10121163
> 
> 赞同：0
> 
> 时间：2012-04-12T09:45:58.450
> 
> 标签：java, jvm

是否可以使用 MBean 记录 jvm GC 活动、cpu 使用情况或其他 jvm 信息？如果是这样，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T06:29:49.923

```
 ClassLoadingMXBean clMxBean = ManagementFactory.getClassLoadingMXBean();

    System.out.println("loadedClassCount:" + clMxBean.getLoadedClassCount());
    System.out.println("totalLoadedClassCount:" + clMxBean.getTotalLoadedClassCount());
    System.out.println("unloadedClassCount:" + clMxBean.getUnloadedClassCount());

    List<GarbageCollectorMXBean> gcMxBeans = ManagementFactory.getGarbageCollectorMXBeans();
    for(GarbageCollectorMXBean gcMxBean : gcMxBeans)
    {
        System.out.println("\ngcMxBean: " + gcMxBean.getName() +
                 ", collection count:" + gcMxBean.getCollectionCount() +
                  ", Collection time:" + gcMxBean.getCollectionTime() + 
                ", Memory Pool Names:" + Arrays.deepToString(gcMxBean.getMemoryPoolNames())  );
    }

    OperatingSystemMXBean osMxBean = ManagementFactory.getOperatingSystemMXBean();
    double systemLoadAverageInLast1Minute = osMxBean.getSystemLoadAverage();
    int availableProcessors = osMxBean.getAvailableProcessors();
    System.out.println("\nlast 1 minute load average over all CPUs: " + systemLoadAverageInLast1Minute);
    System.out.println("last 1 minute load average per CPU: " + (systemLoadAverageInLast1Minute/availableProcessors) ); 
```

# ios - 如何使用 NSURLIsExcludedFromBackupKey 或 kCFURLIsExcludedFromBackupKey？

> ID：10121165
> 
> 赞同：3
> 
> 时间：2012-04-12T09:46:03.057
> 
> 标签：ios, storage, data-storage

我的应用程序被拒绝，因为我将应用程序内购买数据保存在 iPhone 上的 Documents 文件夹中。

> 可以重新创建但必须保留以使您的应用程序正常运行的数据 - 或者因为客户希望它可以离线使用 - 应该使用“不备份”属性进行标记。对于`NSURL`对象，添加`NSURLIsExcludedFromBackupKey`属性以防止相应的文件被备份。对于`CFURLRef`对象，使用相应的`kCFURLIsExcludedFromBackupKey`属性。

但我希望用户即使离线也能使用数据，所以我将使用`kCFURLIsExcludedFromBackupKey`or `NSURLIsExcludedFromBackupKey`。他们之间有什么不同？

问题是如何使用它们中的任何一个，它将返回什么以及如何使用这些返回的数据？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T10:34:38.960

```
NSError *error = nil;

BOOL result = [fileURL setResourceValue:[NSNumber numberWithBool:YES] forKey:NSURLIsExcludedFromBackupKey error:&error]; 
```

# jsp - JSP EL可以做直接属性访问吗

> ID：10121166
> 
> 赞同：3
> 
> 时间：2012-04-12T09:46:10.263
> 
> 标签：jsp, el

这真让我吃惊！我的 JSP 中有以下代码。

```
<c:param name="title" value="${slideShow.title}" /> 
```

这段代码一直有效，直到我重构了 SlideShow 类并公开了所有属性并删除了 getter/setter。所以在我看来，EL 只适用于 getter 而不是直接属性访问。这是真的 ？有没有办法让它使用直接属性而不是通过 getter ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:37:58.593

JSP EL 严格依赖于 Java Bean 规范，因此它不能使用其他约定来访问属性值。

实际上，您可以阅读有关[StackOverflow EL 标签描述的信息](https://stackoverflow.com/tags/el/info)

因此可以调用非 getter 方法（不是属性），但只能从某些 EL 版本调用：

> 从 EL 2.2 开始，它作为 Servlet 3.0 / JSP 2.2（Tomcat 7、Glassfish 3、JBoss AS 6 等）的一部分进行维护，如果需要，可以使用参数调用非 getter 方法。
> 
> 例如 ${bean.find(param.id)} 与

```
public Something find(String id) {
    return someService.find(id);
} 
```

# c# - 如何将多级字典分组数据提取到 CSV

> ID：10121168
> 
> 赞同：0
> 
> 时间：2012-04-12T09:46:31.043
> 
> 标签：c#, linq, dictionary, pivot

我想将下面的数据透视函数的结果提取到 csv V 文件中。有谁知道如何以更通用的方式完成此操作而无需编写大量手动代码？在这个阶段，库的名称并不重要，但如果也可以通过从预加载的数组或列表等中读取来动态设置库，那可能会很好......

非常感谢提前 M

```
public static Dictionary<TKey1,   Dictionary<TKey2,Dictionary<TKey3,Dictionary<TKey4,TValue>>>> PivotLinq<TSource, TKey1, TKey2,TKey3,TKey4, TValue>(
this IEnumerable<TSource> source, Func<TSource, TKey1> key1Selector, Func<TSource, TKey2> key2Selector, Func<TSource, TKey3> key3Selector, Func<TSource, TKey4> key4Selector,
   Func<IEnumerable<TSource>, TValue> aggregate)
    {
        return source.GroupBy(key1Selector).Select(
        x => new
        {
            X = x.Key,
            Y = x.GroupBy(key2Selector).Select(
            z => new
            {
                Z = z.Key,
                V =z.GroupBy(key3Selector).Select( 
                 w => new 
                 {
                     W=w.Key ,
                     B = w.GroupBy(key4Selector).Select(
                      c=> new 
                      {
                          C=c.Key ,
                          D=aggregate(c)
                      }).ToDictionary(e=>e.C, o=>o.D)
                 }
                      ).ToDictionary(e=>e.W, o=>o.B)
            }
                 ).ToDictionary(e=>e.Z , o=>o.V  )
            }).ToDictionary(e=>e.X,o=>o.Y);

        } 
```

# objective-c - iOS以编程方式从照片库中选择图片

> ID：10121172
> 
> 赞同：4
> 
> 时间：2012-04-12T09:46:46.767
> 
> 标签：objective-c, ios, xcode, uiimagepickercontroller

我有个问题。是否有可能从代码中选择来自 iOS 设备照片库的一组给定图片？我不想使用 UIImagePickerController 因为我想为用户决定我想在我的应用程序中引用哪些图片。

没有找到任何可行的方法，因为所有问题都与 UIImagePickerController 有关或相关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T09:55:09.947

提示您可以使用资产库框架。阅读文档：http: [//developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/AssetsLibraryFramework/_index.html](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/AssetsLibraryFramework/_index.html)

或者您可以使用以下代码：[http ://www.fiveminutes.eu/accessing-photo-library-using-assets-library-framework-on-iphone/](http://www.fiveminutes.eu/accessing-photo-library-using-assets-library-framework-on-iphone/)

# php - JQGrid：在 JQGrid 中通过 post 获取多个选中的行值

> ID：10121174
> 
> 赞同：7
> 
> 时间：2012-04-12T09:46:48.610
> 
> 标签：php, javascript, database, jqgrid, checkbox

我的 php 文件中有一个 JQGrid，我已将其放入一个表单中。在提交表单时，我只想要 JQGrid 中的检查值。

```
<script type="text/javascript">
    $(function() {
        $("#list1").jqGrid({
            url:'revMemberJson.php',
            datatype: 'json',
            mtype: 'GET',
            loadonce: true,
            // jsonReader: { repeatitems: false },
            colNames:['Name','Mobile'],
            colModel :[ 
                {name:'name', index:'name',width: 100,searchoptions: { sopt: ['eq', 'ne','cn']}}, 
                {name:'mobile', index:'mobile',search: false,width: 120}
            ],
            pager: '#pager',
            rowNum: 5,
            rowList:[5,20,30],
            rownumbers: true,
            multiselect:true,
            sortname: 'id',
            sortorder: 'desc',
            viewrecords: true,
            height: 'auto',
            width: 420, 
            shrinkToFit: false,
            gridview: true,
            caption: 'Members'
        });
        jQuery("#list1").jqGrid('navGrid','#pager',{edit:false,add:false,del:false});

    });

    var myGrid = $('#list1'),
    selRowId = myGrid.jqGrid ('getGridParam', 'selrow'),
    celValue = myGrid.jqGrid ('getCell', selRowId, 'mobile');

</script> 
```

我已经使用下面的代码来获取检查值，但是所有的东西都是用 java 脚本制作的。但我必须获取更新数据库的值。所以我需要通过邮寄获得价值。

请给我方法..

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-12T16:00:55.537

你应该使用

```
var selRowIds = myGrid.jqGrid ('getGridParam', 'selarrrow'); 
```

的

```
var selRowId = myGrid.jqGrid ('getGridParam', 'selrow'); 
```

获取具有所选行 ID 的数组。您可以使用`JSON.stringify(selRowIds)`或`selRowIds.join(',')`转换为可以轻松发送到服务器的形式的数组。

我认为您可以在[答案](https://stackoverflow.com/a/3588732/315935)中找到一些其他信息（请参阅[演示](http://www.ok-soft-gmbh.com/jqGrid/DataToMultiSelect2.htm)）。

# ios - 我可以开始仅使用 iPad 2 和 iPhone 构建 iOS 应用程序吗？

> ID：10121179
> 
> 赞同：1
> 
> 时间：2012-04-12T09:47:09.483
> 
> 标签：ios

我没有 Mac，所以我想知道是否可以仅使用 iPad 2 和 iPhone 开始构建 iOS 应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T09:48:09.297

非常简短的回答：不。

Xcode 不能在 iOS 上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:00:34.917

如果你想要简短的回答，那就是“**不**”

长答案：

1.  ipad2上有一些有趣的应用程序可以创建另一个应用程序....但只是为了玩，完全不实用。
2.  如果你有一台 PC（windows 或 linux），你可以运行 VMvare，安装 OSX。然后你可以安装 Xcode，并开发 ios 应用程序。请记住，Xcode 是苹果平台开发的关键。
3.  如果您想开发应用程序而不是尝试，请购买 Mac。

阅读本文了解更多信息：[在 Linux 中开始 iPhone 应用程序开发？](https://stackoverflow.com/questions/276907/starting-iphone-app-development-in-linux)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T09:56:02.987

你可以使用第三方软件，但最后你总是需要编译一个 XCode。除非您使用网络解决方案。考虑到仍然没有同一个用户的本地编程过期。

观看链接：

```
http://phonegap.com/
http://www.appcelerator.com
http://www.melablog.it/post/10228/creare-applicazioni-per-iphone-senza-conoscere-objective-c-e-cocoa-5-idee-per-tutte-le-necessita 
```

……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-14T14:07:21.370

简短回答：否
如果删除有问题的唯一单词，您可以通过 iPad 或 iPhone 远程连接到 Mac

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-26T02:53:14.893

实际上，您可以使用 Koder 之类的 html 编辑应用程序在 iOS 中创建可安装的 Web 应用程序，但不要指望利用摄像头或振动器等硬件功能，因为您仍然是在无 chrome 浏览器上运行的网页。无论如何，祝您构建 Web 应用程序好运！

# scala - 在 Scala 中按类型进行通用收集

> ID：10121180
> 
> 赞同：6
> 
> 时间：2012-04-12T09:47:20.650
> 
> 标签：scala, manifest, scala-2.9

在 Scala 2.9.1 中

和

```
def collectFirstOfT[T](la: List[_])(implicit m:Manifest[T]) : Option[T] = {
  la.collect{case x if m.erasure.isAssignableFrom(x.getClass) => x}.
    headOption.asInstanceOf[Option[T]]}

class A
class B 
```

为什么这个表达式：

```
val oB:Option[B] = collectFirstOf(List(new A,new B)) 
```

编译但收集 Some(A)，但

```
val oB =collectFirstOf[B](List(new A,new B)) 
```

工作正常。

如何从 Option[T] 推断 T？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:09:17.440

这个：

```
val oB:Option[B] = collectFirstOfT(List(new A,new B)) 
```

相当于这个：

val oB:Option[B] = collectFirstOfT[Nothing](List(new A,new B))

既然`Nothing`是一切的子类，那么它可以从`A`. 唉，它也可以从 分配`B`，这意味着您可以将一个分配`Option[Nothing]`给一个`Option[B]`。

有趣的事实：这是真的，因为`Option`它是协变的。如果不是，则`T`必须推断为`B`，这将使它起作用。

有趣的事实 2：此代码无法在昨天的主干上编译。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T12:44:29.503

您必须将以下行视为两个独立的部分，= 的左侧和右侧：

```
val oB: Option[B] = collectFirstOf(List(new A,new B)) 
```

您在这里期望的是，collectFirstOf 表达式（右值）的类型应该从值 oB 的类型中推断出来。编译器无法做到这一点。您必须具体说明您期望的类型。举个例子：

```
val v: Long = 1 + 4 
```

表达式 1 + 4 的类型是 Int。然后将此 int 转换为 Long。编译器不会，也无法推断您希望 1 或 4 为 Long：

因此，要解决您的问题，您需要告诉编译器您期望什么类型，否则它假定为 java.lang.Object：

```
val oB = collectFirstOf[B](List(new A,new B)) 
```

所以清单被正确分配，一切都很好。那么为什么以下甚至编译：

```
val oB:Option[B] = collectFirstOfT(List(new A,new B))
oB: Option[B] = Some(A@10f3a9c) 
```

乍一看，这似乎不应该工作，但确实如此。这是因为 collectFirstOfT 实际上返回了一个 Option[Nothing]，它可以安全地转换为 Option[B]：

```
scala> val f = collectFirstOfT(List(new A,new B))
f: Option[Nothing] = Some(A@baecb8)

scala> f.asInstanceOf[Option[B]]
res4: Option[B] = Some(A@baecb8) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:15:37.770

因为编译器不能`T`从 agruments 中推断出来，所以你必须明确地写出来。在第一种情况下`collect`接受所有列表。

# bash - makefile 中的多行 bash 命令

> ID：10121182
> 
> 赞同：148
> 
> 时间：2012-04-12T09:47:24.520
> 
> 标签：bash, makefile

考虑到每个命令都在自己的 shell 中运行，那么在 makefile 中运行多行 bash 命令的最佳方法是什么？例如，像这样：

```
for i in `find`
do
    all="$all $i"
done
gcc $all 
```

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2012-04-12T10:13:15.070

您可以使用反斜杠来续行。但是请注意，shell 接收连接成一行的整个命令，因此您还需要用分号终止某些行：

```
foo:
    for i in `find`;     \
    do                   \
        all="$$all $$i"; \
    done;                \
    gcc $$all 
```

但是，如果您只想获取`find`调用返回的整个列表并将其传递给`gcc`，则实际上不一定需要多行命令：

```
foo:
    gcc `find` 
```

或者，使用更传统的 shell`$(command)`方法（注意`$`转义）：

```
foo:
    gcc $$(find) 
```

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2015-03-16T19:48:29.957

As indicated in the question, **every sub-command is run in its own shell**. This makes writing non-trivial shell scripts a little bit messy -- *but it is possible!* The solution is to consolidate your script into what make will consider a single sub-command (a single line).

## Tips for writing shell scripts within makefiles:

1.  Escape the script's use of `$` by replacing with `$$`
2.  Convert the script to work as a single line by inserting `;` between commands
3.  If you want to write the script on multiple lines, escape end-of-line with `\`
4.  Optionally start with `set -e` to match make's provision to abort on sub-command failure
5.  This is totally optional, but you could bracket the script with `()` or `{}` to emphasize the cohesiveness of a multiple line sequence -- that this is not a typical makefile command sequence

Here's an example inspired by the OP:

```
mytarget:
    { \
    set -e ;\
    msg="header:" ;\
    for i in $$(seq 1 3) ; do msg="$$msg pre_$${i}_post" ; done ;\
    msg="$$msg :footer" ;\
    echo msg=$$msg ;\
    } 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2020-07-09T16:39:34.377

ONESHELL 指令允许编写多行配方以在同一个 shell 调用中执行。

```
all: foo

SOURCE_FILES = $(shell find . -name '*.c')

.ONESHELL:
foo: ${SOURCE_FILES}
    FILES=()
    for F in $^; do
        FILES+=($${F})
    done
    gcc "$${FILES[@]}" -o $@ 
```

但是有一个缺点：特殊前缀字符（'@'、'-' 和 '+'）的解释不同。

[https://www.gnu.org/software/make/manual/html_node/One-Shell.html](https://www.gnu.org/software/make/manual/html_node/One-Shell.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-07T15:30:27.057

当然，编写 Makefile 的正确方法是实际记录哪些目标取决于哪些源。在平凡的情况下，建议的解决方案将`foo`依赖于自身，但当然，`make`它足够聪明，可以放弃循环依赖。但是如果你在你的目录中添加一个临时文件，它会“神奇地”成为依赖链的一部分。最好一劳永逸地创建一个明确的依赖关系列表，也许通过脚本。

GNU make 知道如何运行以从一组文件中`gcc`生成可执行文件，所以也许你真正需要的只是`.c``.h`

```
foo: $(wildcard *.h) $(wildcard *.c) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-12T09:57:10.117

仅调用命令有什么问题？

```
foo:
       echo line1
       echo line2
       .... 
```

而对于你的第二个问题，你需要`$`通过使用来逃避`$$`，即`bash -c '... echo $$a ...'`。

编辑：您的示例可以重写为单行脚本，如下所示：

```
gcc $(for i in `find`; do echo $i; done) 
```

# php - CSV 按字段排序并仅查看选定的行

> ID：10121183
> 
> 赞同：0
> 
> 时间：2012-04-12T09:47:27.720
> 
> 标签：php, sorting, csv, documentation

我一直试图弄清楚如何首先阅读 Google docs CSV（实时）以显示为自定义 HTML。

CSV 有 50 行，每行有 15 个单元格。

经过一番搜索，我发现了这一点：

```
<?PHP

$file_handle = fopen("https://docs.google.com/spreadsheet/pub?key=0Aus5xZRHSuhydGpmcXBRN0Z2WXM5Sks3TlgydF92R1E&single=true&gid=3&output=csv", "r");

while (!feof($file_handle) ) {

$line_of_text = fgetcsv($file_handle, 1024);

print "<custom code>" . $line_of_text[0] . $line_of_text[1]. $line_of_text[2] . $line_of_text[3] . $line_of_text[4] . $line_of_text[5] . $line_of_text[6] . $line_of_text[7] . $line_of_text[8] . $line_of_text[9] .$line_of_text[10] . $line_of_text[11] . $line_of_text[12] . $line_of_text[13] . $line_of_text[14] . $line_of_text[15] . "<br>";
}

fclose($file_handle);

?> 
```

但我需要的是仅查看第一个单元格“A2”或第一个“$line_of_text[0]”和标题（第一行）中具有值“（T01S）”的行。

我正在考虑只是显示“desired_line”对我没有帮助，就好像我在许多页面中间添加一行会显示错误的行一样。

除了第一个单元格之外，还有什么简单的方法可以显示一个完整的行吗？所以我可以在那个字段上有一个自定义代码？而且，如果我添加更多字段，我不需要每个页面代码？

经过几个小时的搜索，我很乐意得到任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T02:36:14.947

好的，我找到了一种更简单的方法，使用谷歌自己的 API！

```
http://spreadsheets.google.com/tq?tqx=out:html&tq=select+A,B,C,D,E,F,I,J+where+A=%27%28T01S%29%27&key=0Aus5xZRHSuhydGpmcXBRN0Z2WXM5Sks3TlgydF92R1E 
```

这个页面引导我走向正确的方向：[OUseful.Info、博客……</a>](http://blog.ouseful.info/2009/05/18/using-google-spreadsheets-as-a-databace-with-the-google-visualisation-api-query-language/)

[](http://blog.ouseful.info/2009/05/18/using-google-spreadsheets-as-a-databace-with-the-google-visualisation-api-query-language/)

[这是谷歌自己的页面：](http://blog.ouseful.info/2009/05/18/using-google-spreadsheets-as-a-databace-with-the-google-visualisation-api-query-language/)[谷歌文档查询语言参考](https://developers.google.com/chart/interactive/docs/querylanguage)

谷歌页面有一个很好的编码器来查询他们页面上的字符串。

因此，只需使用链接字符串，我就得到了我正在寻找的东西。

# list - 商店没有加载

> ID：10121184
> 
> 赞同：0
> 
> 时间：2012-04-12T09:47:29.403
> 
> 标签：list, sencha-touch-2

我正在使用 Sencha V2。我正在尝试使用 Users.json 文件中的值填充我的列表。

我的列表文件中的代码是

```
Ext.define('iPolis.view.personlist',{
    extend:'Ext.List',
    xtype: 'personlist',
    requires: [
        'Ext.List',
        'Ext.form.FieldSet',
        'Ext.Button'

    ],

    config: {
              fullscreen:true,
              items: [
                       {
                         xtype:'toolbar',
                         docked:'top',
                         title:'iPolis',
                          items:[
                                      {
                                          ui:'back',
                                           icon:'home',
                                           iconCls:'home',
                                           iconMask:true,
                                            id: 'homebtn',
                                            handler:function ()
                                                   {
                                                    }
                                      },

                          ]
                       },

                         {
                    xtype : 'list',
                    store : 'personListStore',
                    itemTpl : '<div class="contact">HI <br/> {name}</div>'

                        }
                    }
              ]

    }
}); 
```

并且商店正在使用以下方法调用文件：

```
 Ext.define('iPolis.store.personListStore', {
            extend: 'Ext.data.Store',
storeId:'personListStore',
            model : 'iPolis.model.personListModel',

            proxy : {
                type : 'ajax',
                url : '/users.json',
                reader: {
                    type: 'json',
                    rootProperty: 'users'
                }
            },
             autoLoad: true
    }); 
```

我的 json 文件的代码是：

```
{
    "users": [
       {
           "id": 1,
           "name": "Ed Spencer",
           "email": "ed@sencha.com"
       },
       {
           "id": 2,
           "name": "Abe Elias",
           "email": "abe@sencha.com"
       }
    ]
} 
```

我得到一个空白屏幕。我已经尝试了一切，但屏幕上没有显示任何数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:17:31.973

在您的列表中，商店是`personStore`您尝试使用的`personListStore`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:34:13.120

```
Ext.define('iPolis.store.personListStore', {
    extend: 'Ext.data.Store',
    config:{
    model : 'iPolis.model.personListModel',
    storeId:'personListStore',
    proxy : {
        type : 'ajax',
        url : '/users.json',
        reader: {
            type: 'json',
            rootProperty: 'users'
        }
    },
     autoLoad: true  }  }); 
```

试试这个可能对你有帮助。

# c - Visual Studio 2010 中的 GStreamer hello world 程序

> ID：10121186
> 
> 赞同：5
> 
> 时间：2012-04-12T09:47:30.373
> 
> 标签：c, visual-studio-2010, gstreamer

我正在尝试在 Visual Studio 2010 中运行一个简单的 GStreamer 程序（ [http://gstreamer.freedesktop.org/data/doc/gstreamer/head/manual/html/chapter-helloworld.html ）。](http://gstreamer.freedesktop.org/data/doc/gstreamer/head/manual/html/chapter-helloworld.html)

我已经包含了所需的库和其他头文件。 ![可执行目录](../Images/4013fd005c34baaf2678b0a448208a25.png) ![包括目录](../Images/3bf85ebf0bf28c00dd8f305dc87556ed.png) ![图书馆目录](../Images/de839ae3b365bc814ef05d5f8b7f577b.png) ![参考目录](../Images/86bfddd91c64d40cdbcd104a4f397d5a.png)

现在程序编译但给了我链接错误。

```
gstream.obj : error LNK2019: unresolved external symbol _gst_object_get_type referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_main_loop_run referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_element_set_state referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_print referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_signal_connect_data referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_element_link_many referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_element_link referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_bin_add_many referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_bin_get_type referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_object_unref referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_bus_add_watch referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_pipeline_get_bus referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_pipeline_get_type referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_object_set referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_type_check_instance_cast referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_element_factory_make referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_pipeline_new referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_printerr referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_main_loop_new referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _gst_init referenced in function _main
gstream.obj : error LNK2019: unresolved external symbol _g_error_free referenced in function "int __cdecl bus_call(struct _GstBus *,struct _GstMessage *,void *)" (?bus_call@@YAHPAU_GstBus@@PAU_GstMessage@@PAX@Z)
gstream.obj : error LNK2019: unresolved external symbol _g_free referenced in function "int __cdecl bus_call(struct _GstBus *,struct _GstMessage *,void *)" (?bus_call@@YAHPAU_GstBus@@PAU_GstMessage@@PAX@Z)
gstream.obj : error LNK2019: unresolved external symbol _gst_message_parse_error referenced in function "int __cdecl bus_call(struct _GstBus *,struct _GstMessage *,void *)" (?bus_call@@YAHPAU_GstBus@@PAU_GstMessage@@PAX@Z)
gstream.obj : error LNK2019: unresolved external symbol _g_main_loop_quit referenced in function "int __cdecl bus_call(struct _GstBus *,struct _GstMessage *,void *)" (?bus_call@@YAHPAU_GstBus@@PAU_GstMessage@@PAX@Z)
gstream.obj : error LNK2019: unresolved external symbol _gst_pad_link referenced in function "void __cdecl on_pad_added(struct _GstElement *,struct _GstPad *,void *)" (?on_pad_added@@YAXPAU_GstElement@@PAU_GstPad@@PAX@Z)
gstream.obj : error LNK2019: unresolved external symbol _gst_element_get_static_pad referenced in function "void __cdecl on_pad_added(struct _GstElement *,struct _GstPad *,void *)" (?on_pad_added@@YAXPAU_GstElement@@PAU_GstPad@@PAX@Z)
MSVCRTD.lib(crtexew.obj) : error LNK2019: unresolved external symbol _WinMain@16 referenced in function ___tmainCRTStartup
C:\Users\vickey\Documents\Visual Studio 2010\Projects\gstream\Debug\gstream.exe : fatal error LNK1120: 27 unresolved externals
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我错过了什么？

# iphone - FMDB 如何在 Sqlite iPhone dev 上查询日期范围内的数据

> ID：10121188
> 
> 赞同：1
> 
> 时间：2012-04-12T09:47:32.073
> 
> 标签：iphone, ios, sqlite, date, fmdb

我正在尝试对有日期字段的表执行查询，并且我想查询一系列值 where 子句如下所示：

```
[db executeQuery:@"select * from test where myDate BETWEEN date('now','-7 days') and date('now')"]; 
```

但这似乎不起作用:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:28:52.380

如果您使用`DATETIME`带有表声明的列，您可以这样做：

```
[db executeQuery:@"SELECT * FROM test WHERE myDate BETWEEN ? and ?", [[NSDate dateWithTimeInterval:-86400*7 sinceDate:[NSDate date]], [NSDate date]]; 
```

请注意，这`-86400`是一天中的秒数，负数表示“前几天”，就像您的问题一样。

另请注意，`BETWEEN`语法包括您设置的日期的第二个。`WHERE myDate > ? and myDate < ?`如果您需要非包容性匹配，请使用。

# linq-to-sql - 如何使用这一公共 IEnumerable 查找（表达式 > 谓词）？

> ID：10121193
> 
> 赞同：0
> 
> 时间：2012-04-12T09:47:43.523
> 
> 标签：linq-to-sql, predicate

如何正确使用下面的代码？

```
public IEnumerable<T> Find(Expression<Func<T, bool>> predicate) 
```

我需要返回一个特定对象的 IEnumerable，但我需要将集合对象转换为 Queryable 并将结果再次转换为 List？

**下面是我的实现，不知道对不对，我是用代码对通用存储库进行单元测试的。**

```
 public IEnumerable<tbl_SBAem_Attendee> Find(Expression<Func<tbl_SBAem_Attendee, bool>> predicate)
        {
            var listtblsbaemAttendee = new  List<tbl_SBAem_Attendee>();
            IEnumerable<tbl_SBAem_Attendee> enumerableAttendee=new List<tbl_SBAem_Attendee>();

            for (var i = 0; i < 10; i++)
            {
                var tblSbAemAttendee = new tbl_SBAem_Attendee
                                           {
                                               AT_AID = i,
                                               AT_Address = "Address1" + i,
                                               AT_Address2 = "Address2" + i,
                                               AT_City = "City",
                                               AT_Email = "rene_florendo2005@yahoo.com.ph",
                                               AT_EventID = null,
                                               AT_FirstName = "Rene" + i,
                                               AT_LastName = "Florendo" + i,
                                               AT_GID = null,
                                               AT_Org = "Rene's Club",
                                               AT_Phone = "888-8888",
                                               AT_Phone2 = "999-8888",
                                               AT_RegID = null,
                                               AT_SendInfo = null,
                                               AT_State = "NJ",
                                               AT_Title = "Mr",
                                               AT_Zip = "4102",
                                               AT_date = null,
                                               AT_opt1 = "option1",
                                               AT_opt2 = "option2",
                                               AT_opt3 = "option3",
                                               AT_opt4 = "option4",
                                               AT_opt5 = "option5",
                                               AT_opt6 = "option6",
                                               AT_userID = null,
                                               AttendeeID = 1
                                           };
                listtblsbaemAttendee.Add(tblSbAemAttendee);
            }
            var result= listtblsbaemAttendee.AsQueryable().Where(predicate);
            return result.ToList();
        } 
```

非常感谢任何帮助或建议。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:53:50.227

如果我没记错的话：

`Where(Expression<Func<T, bool>>)`是 IQueryable 的扩展

但

`Where(Func<T, bool>>)`是 IEnumerable 的扩展。

所以尝试改变你的函数的参数类型（或重载它），你不需要强制转换为 Queryable 来使用你的谓词（不要认为你需要表达式）

**编辑**

另一种方法是编译你的表达式（var predicatefunc = predicate.Compile()），并在你的“Where”子句中使用它。但我认为这不是最好的方法......

# actionscript-3 - 多用户 RPG 数据库

> ID：10121199
> 
> 赞同：0
> 
> 时间：2012-04-12T09:48:07.267
> 
> 标签：actionscript-3

我正在制作一个基于 Flash 回合制的 RPG 来练习 OOP（谁没有：P）我在武器、物品和所有爵士乐方面都有很好的设置。虽然我目前正在考虑如何制作我的角色。

目前我有一个扩展类的`player`and类。`enemy``battler`

```
 Battler
      /  \
     /    \
 Player  Enemy 
```

我的`player`课程有一些函数可以初始化播放器本身，添加图形等等。我的`party`班级调用`player`，传递一个像这样的参数： player.setup(1) ，其中 1 是 playerID。

为了澄清这是我的播放器伪代码：

```
{   setup(player_id)
    player =  **??????player_id??????????**
    name = player.name
    character_name = player.character_name
    character_index = player.character_index
    weapon_id = player.returnWeapon
 /*---------
    armor1_id = player.returnArmor //increase for other body parts
 ----------*/
    level = player.level
} 
```

我的问题，或者更多的问题是我将如何存储玩家数据。我需要有很多玩家，因为这是一个派对中有很多玩家的游戏。

我将如何实际使用类似的东西`player.returnArmor`？因为当我这样做时它只是调用一个函数，它不会知道那个玩家是谁（我想我可以使用参数，`player.returnArmor(player)`但我认为有更好的方法来做到这一点。

欢迎使用任何语言，但请不要使用汇编语言作为示例；)、C++、Actionscript 3、Ruby 和/或 Java 都可以。请帮我！先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T16:41:28.920

使用实体系统可能值得考虑，其中游戏中的每个项目都被视为可以单独管理的不相关属性（位置、速度、位图/网格）的集合。这往往会使难题变得更容易（可扩展性、同步、存储）。

*   [http://www.tomseysdavies.com/2011/01/23/entity-systems/](http://www.tomseysdavies.com/2011/01/23/entity-systems/)
*   [http://www.richardlord.net/blog/what-is-an-entity-framework](http://www.richardlord.net/blog/what-is-an-entity-framework)
*   [http://www.richardlord.net/blog/why-use-an-entity-framework](http://www.richardlord.net/blog/why-use-an-entity-framework)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T15:30:44.217

在 AS3 中，您可以拥有静态和实例函数。如果你调用`player.returnarmor()`，你调用的是一个静态函数。你想要一个实例函数，并为你想要的盔甲值的玩家实例调用它。

如果你有几个（<4）个字符，你可以只为每个命名变量，但超过 3 或 4 个，你应该只为它们提供一个数组或其他容器。

```
var mainProtagonist:player;
var spunkySidekick:player;
var whiteMage:player;
var players:Array = new Array();
players.push(mainProtagonist);
players.push(spunkySidekick);
players.push(whiteMage); 
```

然后要获得玩家的盔甲......我们会说你想要勇敢的伙伴的盔甲：

```
players[1].returnarmor();
// or
spunkySidekick.returnarmor(); 
```

在战斗中使用时，您可能有一个现有所有玩家的数组，以及另一个数组，其中只有当前队伍/战斗中的玩家。这样你的敌人就可以随机瞄准玩家，而且只能来自当前正在战斗的玩家。

# windows - 下次登录时更改密码...vbscript

> ID：10121207
> 
> 赞同：0
> 
> 时间：2012-04-12T09:48:34.613
> 
> 标签：windows, vbscript

我有以下代码“应该”勾选框以在下次登录时更改本地用户密码，但我不断收到错误。

该帐户已在本地创建并在服务器上。

请提供任何帮助。

由于我们环境中的服务器较旧，我必须在 vbscript 而不是 powershell 中执行此操作。

代码：

```
' get computer name
Set oWshNet = CreateObject("WScript.Network" )
sComputerName = oWshNet.ComputerName

'Set Account Testuser Password Expired parameter
Set objUser = GetObject("WinNT:// " & sComputerName & "/Testuser")
objUser.Put "PasswordExpired", 1
objUser.SetInfo 
```

错误：

account.vbs(6, 1) (null): 未找到网络路径。

****** *** *****编辑****** ** *** ** *** ********

 **想通了：（感谢谷歌！）

```
Set oShell = CreateObject("WScript.Shell")
Const SUCCESS = 0

sUser = "TestUser"

' get the local computername with WScript.Network,
' or set sComputerName to a remote computer
Set oWshNet = CreateObject("WScript.Network")
sComputerName = oWshNet.ComputerName

Set oUser = GetObject("WinNT://" & sComputerName & "/" & sUser)

oUser.Put "PasswordExpired", 1
oUser.SetInfo

oShell.LogEvent SUCCESS, "Password Attribute Changed" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T13:25:43.917

谢谢。

答案是：

```
Set oShell = CreateObject("WScript.Shell") 
Const SUCCESS = 0 

sUser = "TestUser" 

' get the local computername with WScript.Network, 
' or set sComputerName to a remote computer 
Set oWshNet = CreateObject("WScript.Network") 
sComputerName = oWshNet.ComputerName 

Set oUser = GetObject("WinNT://" & sComputerName & "/" & sUser) 

oUser.Put "PasswordExpired", 1 
oUser.SetInfo 

oShell.LogEvent SUCCESS, "Password Attribute Changed" 
```**

# python - apt-get 的需求文件，类似于 pip

> ID：10121210
> 
> 赞同：30
> 
> 时间：2012-04-12T09:49:08.390
> 
> 标签：python, pip, apt, apt-get

我喜欢如何使用 pip 要求管理依赖项。在 apt-get 的情况下是否有类似的东西？

[http://www.pip-installer.org/en/latest/requirements.html#requirements-file-format](http://www.pip-installer.org/en/latest/requirements.html#requirements-file-format)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-12T11:57:05.373

您的问题是您希望在一个文件中包含系统依赖项列表，以便能够使用一个命令安装它。

我不建议您在系统依赖项中包含软件包的版本。在“ *build-essential* ”或“ *uuid-dev* ”等软系统依赖项中，您通常需要最新版本的软件包。在诸如 python、postgres 或其他的“硬依赖”中，通常版本是在包本身的名称中指定的，例如“ *python2.6-dev* ”或“ *postgresql-8.4* ”。*您可能在定义软件包的确切版本时遇到的另一个问题是， postgresql-8.4*的 8.4.11-1 版本可能在三个月或一年后不会在存储库中可用，您最终将安装当前版本在回购中。

例子。您可以使用项目所需的系统包创建一个名为“requirements.system”的文件：

```
python-virtualenv
python2.6-dev
uuid-dev
python-pip
postgresql-8.4 
```

然后，在您的 INSTALL 文件中说明如何安装系统包。

```
# Install system depencences by running
cat ~/project/install/requirements.system | xargs sudo aptitude install 
```

我们已经运行这个配置大约两年了，不得不从头开始重新创建环境几次，我们从来没有遇到过问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-03-26T04:05:13.810

我们在工作中使用[aptfile](https://github.com/seatgeek/bash-aptfile)格式。它只是一个内置了一些帮助程序的 bash 包装器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-31T11:35:12.673

我通常使用`apt list --installed | awk -F/ '{print $1}' | grep -v Listing... > installed_packages.txt`.

解释：

*   `apt list --installed`回显当前安装的软件包列表，包括版本
*   `awk -F/ '{print $1}'`摆脱软件包版本，这使文件独立于您的发行版（Mint、Ubuntu、Debian 稳定/测试之间的下游兼容性，上游不是必需的）
*   `grep -v Listing...`摆脱 apt 的“交互式”显示（第一行）
*   然后所有这些都通过管道传输到单个文件

然后，您可以通过`cat installed_packages.txt | xargs apt install -y`使用所述文件的每一行作为 apt 的参数在另一个系统上安装。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-04-25T01:32:31.300

由于 apt 接受来自 stdin 的输入，因此最简单的方法是：

```
$ cat requirement.txt
gcc
cmake

$ apt install < requirement.txt
Reading package lists... Done
Building dependency tree       
Reading state information... Done
0 upgraded, 0 newly installed, 0 to remove and 3 not upgraded. 
```

# php - PHP 使用 Include Inside 函数

> ID：10121211
> 
> 赞同：10
> 
> 时间：2012-04-12T09:49:09.683
> 
> 标签：php

我试图制作一个可以如下调用的函数，

```
view( 'archive', 'post.php' ); 
```

这个函数真正做的是这个。

```
include( 'view/archive/post.php' ); 
```

这样做的原因是，如果将来我将目录扩展为`view/archive/another_level/post.php`我不想回到我的代码中的任何地方并更改所有包含路径。

目前这是我的函数所拥有的，除了似乎包含在函数内部被调用，而不是在函数被调用时被调用......

```
function view( $view, $file )
    {
        switch ( $view )
        {
            case 'archive'  : $view = 'archive/temp';   break;
            case 'single'   : $view = 'single';     break;
        }

        include( TEMPLATEPATH . "/view/{$view}/{$file}" );
    } 
```

我怎样才能让这个函数正确地包含文件？

编辑：

没有显示错误。感谢@Ramesh 的错误检查代码，`ini_set('display_errors','On')`我能够看到包含的文件上还有其他“未显示”错误，这似乎导致文件不显示......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-12T09:59:55.497

该用例已[明确记录](http://es.php.net/manual/en/function.include.php#example-136)：

> 如果包含出现在调用文件中的函数内部，则被调用文件中包含的所有代码的行为就好像它已在该函数中定义一样。因此，它将遵循该函数的变量范围。此规则的一个例外是在包含发生之前由解析器评估的魔术常量。

恕我直言，将基本路径保持在常量中（您似乎在某种程度上已经这样做了）甚至进行全站点搜索和替换（在任何体面的编辑器中都是 30 秒的任务）比重写所有包含的内容要简单得多文件以使用全局变量。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-11-30T04:31:48.740

这是解决问题的一种方法：

更改调用函数的方式，使其如下所示：

```
include( view('archive','post') ); 
```

你的函数看起来像这样：

```
<?php
function view( $view, $file )
{
    switch ( $view )
    {
        case 'archive': $view = 'archive/temp'; break;
        case 'single' : $view = 'single';       break;
    }

    return TEMPLATEPATH . "/view/{$view}/{$file}";
}
?> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T09:56:42.673

我认为您应该阅读有关**变量范围**的信息。

[http://php.net/manual/en/language.variables.scope.php](http://php.net/manual/en/language.variables.scope.php)

> 变量的范围是定义它的上下文。

因此，如果您在函数中包含文件，则其内容仅在该函数的上下文中可用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-12T09:58:44.470

虽然您实际上并没有说明您遇到的确切问题是什么，但我怀疑这是您包含的文件不可用的变量。`include`部分解决这个问题的一个稍微可怕的方法是在你的语句之前添加这一行：

```
extract($GLOBALS); 
```

这会将全局范围内的所有变量导入到您的函数中。*但是*，这不会使该功能完全符合您的要求。考虑这段代码：

```
function some_func () {
  $x = 2;
  view('archive', 'post.php');
}

$x = 1;

some_func(); 
```

在包含的文件中， 的值`$x`将是`1`，而不是`2`您想要/期望的值。这是因为`$GLOBALS`只包含来自全局范围的数据，它不包含来自`some_func()`. 在 PHP 中没有访问“父”作用域中的变量的机制。

总而言之，您要使用的方法（将其包装在函数中）将不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-12T10:01:26.200

```
function view( $view, $file )
{
    switch ( $view )
    {
        case 'archive'  : $view = 'archive/temp';   break;
        case 'single'   : $view = 'single';     break;
    }

    include( TEMPLATEPATH . "/view/".$view."/".$file );
} 
```

这对我有用。您也可以在案例中使用包含，或者甚至更好地构建整个 url 以每次都包含在案例中。

# sql-server - 无法使用 pymssql 连接到 SQL Server 数据库，但可以使用底层 freetds tsql 连接

> ID：10121212
> 
> 赞同：15
> 
> 时间：2012-04-12T09:49:10.043
> 
> 标签：sql-server, tsql, freetds, pymssql

我不知道为什么会收到此错误并且找不到任何解决方案。我可以使用 freetds tsql 连接到 SQL Server 数据库，但是在使用`pymssql.connect`.

具体错误是：

> pymssql.OperationalError: (18456, "Login failed for user 'xxx'.DB-Lib 错误消息 18456, 严重性 14:\n一般 SQL Server 错误: 检查来自 SQL Server 的消息\nDB-Lib 错误消息 20002, 严重性 9:\ n自适应服务器连接失败\n")

我将 freetds 的配置设置为：

```
[custom_config]
    host = myhost
    port = 1433
    tds version = 7.0
    encryption = request
    dump file = /tmp/freetds.log 
```

跑步：

```
tsql -S custom_config -U tsmv -P xxx 
```

返回：

```
locale is "en_US.UTF-8"
locale charset is "UTF-8"
using default charset "UTF-8"
1> 
```

这允许我查询数据库。

但是，运行：

```
python
>> import pymssql
>> pymssql.connect(server='custom_config', user='user', password='xxx',    database='database') 
```

引发上述错误。

我正在使用 Linux CentOS、python 2.6.6、freetds 0.92 dev（我尝试过使用 tdsver=7.0 编译的其他版本）。

freetds 日志是：

```
log.c:196:Starting log file for FreeTDS 0.92
on 2012-04-12 10:39:15 with debug flags 0x4fff.
iconv.c:330:tds_iconv_open(0x1391b70, ISO-8859-1)
iconv.c:187:local name for ISO-8859-1 is ISO-8859-1
iconv.c:187:local name for UTF-8 is UTF-8
iconv.c:187:local name for UCS-2LE is UCS-2LE
iconv.c:187:local name for UCS-2BE is UCS-2BE
iconv.c:349:setting up conversions for client charset "ISO-8859-1"
iconv.c:351:preparing iconv for "ISO-8859-1" <-> "UCS-2LE" conversion
iconv.c:391:preparing iconv for "ISO-8859-1" <-> "UCS-2LE" conversion
iconv.c:394:tds_iconv_open: done
net.c:205:Connecting to xx.x.x.xxx port 1433 (TDS version 7.1)
net.c:270:tds_open_socket: connect(2) returned "Operation now in progress"
net.c:310:tds_open_socket() succeeded
util.c:156:Changed query state from DEAD to IDLE
net.c:741:Sending packet
0000 12 01 00 34 00 00 00 00-00 00 15 00 06 01 00 1b |...4.... ........|
0010 00 01 02 00 1c 00 0c 03-00 28 00 04 ff 08 00 01 |........ .(......|
0020 55 00 00 02 4d 53 53 51-4c 53 65 72 76 65 72 00 |U...MSSQ LServer.|
0030 c7 39 00 00            -                        |.9..|

net.c:555:Received header
0000 04 01 00 25 00 00 01 00-                        |...%....|

net.c:609:Received packet
0000 04 01 00 25 00 00 01 00-00 00 15 00 06 01 00 1b |...%.... ........|
0010 00 01 02 00 1c 00 01 03-00 1d 00 00 ff 0a 00 0f |........ ........|
0020 a0 00 00 02 00         -                        |.....|

login.c:1057:detected flag 2
login.c:782:quietly sending TDS 7+ login packet
token.c:328:tds_process_login_tokens()
net.c:555:Received header
0000 04 01 00 72 00 51 01 00-                        |...r.Q..|

net.c:609:Received packet
0000 04 01 00 72 00 51 01 00-aa 5e 00 18 48 00 00 01 |...r.Q.. .^..H...|
0010 0e 1d 00 4c 00 6f 00 67-00 69 00 6e 00 20 00 66 |...L.o.g .i.n. .f|
0020 00 61 00 69 00 6c 00 65-00 64 00 20 00 66 00 6f |.a.i.l.e .d. .f.o|
0030 00 72 00 20 00 75 00 73-00 65 00 72 00 20 00 27 |.r. .u.s .e.r. .'|
0040 00 74 00 73 00 6d 00 76-00 27 00 2e 00 0c 4d 00 |.t.s.m.v .'....M.|
0050 43 00 53 00 2d 00 44 00-41 00 54 00 41 00 42 00 |C.S.-.D. A.T.A.B.|
0060 41 00 53 00 45 00 00 01-00 fd 02 00 00 00 00 00 |A.S.E... ........|
0070 00 00                  -                        |..|

token.c:337:looking for login token, got  aa(ERROR)
token.c:122:tds_process_default_tokens() marker is aa(ERROR)
token.c:2588:tds_process_msg() reading message 18456 from server
token.c:2661:tds_process_msg() calling client msg handler
dbutil.c:85:_dblib_handle_info_message(0x14e2e30, 0x1391b70, 0x7fff8b047e40)
dbutil.c:86:msgno 18456: "Login failed for user 'xxx'."
token.c:2674:tds_process_msg() returning TDS_SUCCEED
token.c:337:looking for login token, got  fd(DONE)
token.c:122:tds_process_default_tokens() marker is fd(DONE)
token.c:2339:tds_process_end: more_results = 0
    was_cancelled = 0
    error = 1
    done_count_valid = 0
token.c:2355:tds_process_end() state set to TDS_IDLE
token.c:2370:                rows_affected = 0
token.c:438:tds_process_login_tokens() returning TDS_FAIL
login.c:466:login packet accepted
util.c:156:Changed query state from IDLE to DEAD
util.c:331:tdserror(0x14e2e30, 0x1391b70, 20002, 0)
dblib.c:7929:dbperror(0x1383c70, 20002, 0)
dblib.c:7981:20002: "Adaptive Server connection failed"
dblib.c:8002:"Adaptive Server connection failed", client returns 2 (INT_CANCEL)
util.c:361:tdserror: client library returned TDS_INT_CANCEL(2)
util.c:384:tdserror: returning TDS_INT_CANCEL(2)
dblib.c:1443:dbclose(0x1383c70)
dblib.c:258:dblib_del_connection(0x7fa462faf540, 0x1391b70)
mem.c:615:tds_free_all_results()
dblib.c:305:dblib_release_tds_ctx(1)
dblib.c:5882:dbfreebuf(0x1383c70)
dblib.c:739:dbloginfree(0x1533a40) 
```

我完全不知道为什么这不起作用。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-02-14T14:53:25.917

“自适应服务器连接失败”似乎是一条相当笼统的消息，但这里有一些可以尝试的方法。

1.  此邮件列表线程 ( [http://lists.ibiblio.org/pipermail/freetds/2010q3/026060.html](http://lists.ibiblio.org/pipermail/freetds/2010q3/026060.html) ) 表示使用不正确的 TDS 协议会导致“自适应服务器连接失败”消息。在chewynougat 的日志中似乎并非如此，但也许它对其他人有所帮助。

2.  此常见问题解答提供了很多尝试步骤： [https](https://github.com/pymssql/pymssql/blob/87f4383ec153962b7ca7e63a05042d3f09005178/docs/faq.rst) ://github.com/pymssql/pymssql/blob/87f4383ec153962b7ca7e63a05042d3f09005178/docs/faq.rst ，

一种是尝试通过 tsql -H 测试 tds 连接，它绕过从 conf 读取，只读取传入的值。鉴于上面的 conf 包含端口和协议版本，可能值得与 tsql -C 一起检查以查看是否需要调整。

3.  此外，在常见问题解答的底部，它指出

    > 真正的“登录不正确”消息的代码 = 18456 和严重性 = 14

那是正在发送的错误消息，因此也许可以尝试登录审核 ( [http://msdn.microsoft.com/en-us/library/ms175850.aspx](http://msdn.microsoft.com/en-us/library/ms175850.aspx) ) 以查看 pymssql 是否正确传递了您的凭据。

4.  同一部分讨论了混淆 mssql.connect 的不同字符集，因此也可以尝试使用基本密码（即 ASCII 65-90）以确保在翻译过程中不会丢失任何内容。看起来 Aki 和日语一起工作，所以也许这也是一个原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-14T10:22:21.673

我遇到了同样的问题。幸运的是，我发现了问题所在。我的机器上有两个不同版本的 FreeTDS。我通过以下方式安装了其中一个（v 0.91）：

```
 sudo apt-get install freetds-dev 
```

后来我发现它不是最后一个版本，我从 freetds.org 下载了 Freetds 的 tar 文件。当我运行 tsql -C. 它显示了正确的路径，我正确地操纵了 freetds.conf。通过更改环境变量（[http://www.freetds.org/userguide/envvar.htm](http://www.freetds.org/userguide/envvar.htm)），我可以连接到数据库。但是，每次我尝试通过 Pymssql 连接时都会出错。

最后，我查看了日志文件，发现 Python 使用的是旧版本（v 0.91），但我的最后一个版本是 0.95。

```
>>> import os
>>> os.environ['TDSDUMP'] = 'stdout'
>>>
>>> import pymssql
>>> conn = pymssql.connect(server="sqlserverhost") 
```

所以，我删除了 0.91 版本：

```
sudo apt-get purge freetds-common 
```

并且 pymssql 使用正确的配置连接到正确的版本。

它也可能对您有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-22T06:46:13.783

尝试遵循 pymssql 文档中的新注释：azure 需要照顾用户部分。这太奇怪了，但有效。ms sql 仓库使在 linux/mac 上的工作变得如此困难..

[http://pymssql.org/en/latest/azure.html](http://pymssql.org/en/latest/azure.html)

重要提示：请勿将 username@server.database.windows.net 用于相关 connect() 调用的用户参数！您必须改用较短的 username@server 表单！

[![在此处输入图像描述](../Images/32c18456d24eea460e6aae9a6db8e9e1.png)](https://i.stack.imgur.com/fAAiD.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-10-23T15:07:19.947

我通过安装时遇到了同样的问题，`pip install pymssql`因为它安装了一个预先构建的不支持加密的特定于操作系统的二进制轮。

即使我已经安装了特定版本的 freetds，我也期望会使用它。安装而不是提供`pip install --no-binary pymssql pymssql`了一个有效的安装。

如果您想加密您的数据库连接，您需要首先构建/安装 freetds，然后按照此处所述安装 pymssql。

在这种情况下，我强烈建议确保您的 freetds.conf 文件指定“require”而不是“request”，以避免默默地退回到未加密的流量。对 SQL 关键字使用`tcpdump -A`和 grepping 可以帮助确定流量是否真正加密。

# java - 在类 URLClassPath 的调试模式下具有 MyEclipse 隐式断点

> ID：10121214
> 
> 赞同：17
> 
> 时间：2012-03-10T08:44:28.160
> 
> 标签：java, eclipse

我是初学者`MyEclipse IDEA`。我使用`8.6.1`它的版本。我的问题是：当我在调试模式下执行我的程序时，`MyEclipse`去`sun.misc.URLClassPath`上课，我必须`Resume`断点（通过`F8`按键）并继续执行我的程序。`MyEclipse`留在`URLClassPath`以下线程堆栈中的类：

```
1\. URLClassPath$JarLoader.<init>(URL, URLStreamHandler, HashMap) line: 581  
2\. URLClassPath$JarLoader.ensureOpen() line: 631    
3\. URLClassPath$JarLoader.getJarFile(URL) line: 641 
4\. URLClassPath$JarLoader.ensureOpen() line: 631 
```

`jar`注意：当我的项目中存在某些文件时会发生此事件，`Build-Path`但是当我的应用程序很简单时，不会出现此问题，并且第一个断点是我的第一个断点。

为什么会发生这个事件？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-09-10T07:13:32.823

我已经重现了该错误，并且无法调试该应用程序。我发现解决此问题的唯一方法是：转到“window->Preferences->Java->Debug”并禁用“暂停执行未捕获的异常”

现在可以调试应用程序并且调试器在用户断点处停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-13T08:05:35.933

中断的唯一原因是遇到断点时。MyEclipse（或 Eclipse）本身不添加任何断点。我建议您再次调试应用程序，当它在 sun.misc.URLClassPath 中中断时，转到调试透视图中的 Breakpoints 选项卡并检查您设置的所有断点。如果你双击每个断点，它应该带你到相关的源文件。希望您可以弄清楚断点是如何到达那里的，但要删除断点，请右键单击断点并选择删除。

另外，请注意，默认情况下，eclipse 会因未捕获的异常而中断（尽管看起来这不是您的问题）。这可以通过转到调试首选项 Window->Java->Debug 来更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-14T06:04:38.140

解决方案： **在调试状态下，只需在预调试中搜索窗口断点 > 并取消选中 [捕获位置] 选项。**

# c# - WPF中的会话管理

> ID：10121220
> 
> 赞同：0
> 
> 时间：2012-04-12T09:49:21.370
> 
> 标签：c#, wpf

我必须创建一个 WPF 桌面应用程序，允许我在每次密码/用户名正确时打开一个会话，我已经创建了我的 WPF 界面，并且我已经创建了我的数据库来测试每次密码/用户名是否存在于我的数据库，当我点击登录按钮时，我必须打开一个新会话，有人可以帮我吗？

```
string connectionString = @"Server=SHAGGY-PC\SQLEXPRESS;Database=gestion;Trusted_Connection=True;";
SqlConnection cnn = new SqlConnection(connectionString);
cnn.Open();
SqlCommand cmd = new SqlCommand("Select * FROM [session] WHERE login ='" + textBox1.Text + "'and password ='" + pass + "'", cnn);
cmd.CommandType = CommandType.Text;
SqlDataAdapter adapter = new SqlDataAdapter();
adapter.SelectCommand = cmd;
DataSet dataSet = new DataSet();
adapter.Fill(dataSet);
if (dataSet.Tables[0].Rows.Count > 0)
{
  //open new session
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:54:55.430

WPF 默认情况下不知道会话的概念。会话通常是与网络相关的事物。您需要创建一个“会话对象”，它就像一个新的 SessionObj() 一样简单。会话表只是一个日志？如果它包含数据（例如网络上的序列化数据），那么您不会创建新会话，而是从数据库中加载它？

# jquery - 所有其他（不是这个）

> ID：10121222
> 
> 赞同：2
> 
> 时间：2012-04-12T09:49:26.207
> 
> 标签：jquery, this

我在同一页面中重复了不同的 div。这是简化的示例：http: [//jsfiddle.net/8gPCE/16/](http://jsfiddle.net/8gPCE/16/)

我尝试做的是：
- 点击一个绿色，只有他的红色淡出
- 另一个红色淡入
- 当我点击到其他任何地方，如背景时，所有红色淡入

我一直在尝试一个小时，但我没有同时找到这 3 件事。

像这样的东西不起作用。（我只尝试前两件事）：

```
$(function(){

    $(".green").click(function() {
        $(this).siblings(".red").fadeOut("slow");
        $(this).parent().not(this).children(".red").fadeIn("slow");
    });

}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T09:52:58.300

您必须使用类选择器并执行类似的操作

```
//when you click on an element with class green
$(".green").click(function() {
    //select his red sibling
    var sib =  $(this).siblings(".red");
    //fade it out
    sib.fadeOut("slow");
    //select all red elements that are not the red sibling and fade them in
    $(".red").not(sib).fadeIn("slow");
}); 
```

[http://jsfiddle.net/8gPCE/2/](http://jsfiddle.net/8gPCE/2/)

要实现其他行为，请添加

```
$(window).on("click", function(e){
    if(!$(e.target).hasClass('green')){
        $(".red").fadeIn("slow");
    }
}); 
```

在这里摆弄[http://jsfiddle.net/8gPCE/7/](http://jsfiddle.net/8gPCE/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:00:49.757

这应该处理所有问题

```
$(".green").click(function(e) {
    e.stopPropagation();
    $(this).siblings(".red").fadeOut("slow");
    $('.green').not(this).siblings(".red").fadeIn("slow");
});

$(document).click(function() {
   $('.red').fadeIn();
}); 
```

演示在[http://jsfiddle.net/8gPCE/11/](http://jsfiddle.net/8gPCE/11/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T09:54:58.960

首先，您应该将 id 选择器更改为 class one :
`$("#green")`to `$(".green")`。
要记住的另一件事是，这两个表达式 (`$(this).siblings()`和`$(this).parent().children()`) 表示相同的意思，这意味着您的代码可以翻译为：

```
 $(".green").click(function() {
    $(this).siblings(".red").fadeOut("slow").fadeIn("slow");
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T09:56:10.740

我刚刚更新了你的小提琴，这应该可以解决问题：

```
$(function(){

    $(".green").click(function() {
        $(this).siblings(".red").fadeOut("slow");
        $(this).parents('.photo').siblings().children(".red").fadeIn("slow");
    });

})​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T10:03:52.203

```
 $(".green").click(function() {
            //Show all red
            $('.red').fadeIn();
            //fade only this
            $(this).siblings(".red").fadeOut("slow");
            });

// click anywhere
        $(document).bind('click', function(e) {
                var $clicked = $(e.target);
                if (! $clicked.hasClass("green"))
                { 
                   $('.red').fadeIn();
                }
            }); 
```

# objective-c - 适用于 iPad 的 UItableView 单元格内容大小

> ID：10121223
> 
> 赞同：3
> 
> 时间：2012-04-12T09:49:29.000
> 
> 标签：objective-c, ios, ipad

嗨，我面临一个奇怪的问题。

我为 iPad 创建了 UITableView。

当我检查单元格宽度时，我发现它是 320，但对于 iPad，我需要 768 和 1024。

下面的屏幕显示了表格视图，其中单元格显示在表格中

当我添加滚动条时`UIScrollView *previewScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, cell.contentView.frame.size.width, 250)];`

```
 NSLog(@"cell.contentView.frame.size.widt  %f",cell.contentView.frame.size.width); 
```

滚动条仅显示 320 宽度（**cell.contentView.frame.size.width**）区域。我应该怎么做才能设置 iPad 大小的单元格内容视图

![屏幕](../Images/1688a1105e711732fe090d26039563c9.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T09:54:14.353

您应该正确使用 autoResizingFlags。创建时，单元格只有 320px 宽度，但在显示时会更大。

在创建滚动视图时试试这个：
`previewScrollView.autoresizingFlags = UIViewAutoresizingFlexibleWidth;`

这应该可以，但是当您甚至需要更多控制时，您仍然可以使用 tableView 委托方法：`tableView:willDisplayCell:atIndexPath:`

# java - 获取灰度或黑白图像的每个像素的像素值？

> ID：10121226
> 
> 赞同：2
> 
> 时间：2012-04-12T09:49:42.007
> 
> 标签：java, image, histogram, pixels

有人可以建议我获取灰度图像每个像素的实际像素值的方法吗？

我用这段代码来获取像素。但它只是给了我一个像素的红色值？我不知道黑白或灰度图像是否包含RGB像素，所以请告诉我，我使用的方法是对还是错？而且当我为我的图像绘制直方图时，它与同一图像的 imajeJ 直方图完全相反。所以我想我获取灰度图像像素的方法是错误的

因此，如果它是错误的，那么获取像素的正确方法是什么。这是我的代码

```
 PlanarImage image = JAI.create("fileload", "C:\\16bit images\\alpXray.tiff");
 BufferedImage bi = image.getAsBufferedImage();
  int[] bins = new int[256];
 int b=0;
for (int x = 0; x < bi.getWidth(); x++) {

         for (int y = 0; y < bi.getHeight(); y++) {

             int p= bi.getRaster().getSample(x, y,b); // (1)  b=0 for red (2)b=1 for green(3) b=2 for bule

           p=p/256;

           bins[p]++;  
       }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:01:05.623

RGB 图像的每个通道都是灰度的。事实上，如果您将单个通道（GIMP、photoshop）可视化，您只会看到灰色阴影。

通常要将 rgb 图像转换为灰色，您需要获取每个通道的三个值并进行算术平均值。或者干脆你采取一个单一的渠道。如果我误解了这个问题，请告诉我..

编辑：好的。如果您有 3 通道灰度图像，您可能有 3 个通道，每个通道具有相同的值。所以只需为每个像素取单个通道的值。如果您只有一个通道（16 位），请使用该像素。

# wordpress - post_nav_link 导航可以与 WordPress 自定义页面模板一起使用吗？

> ID：10121230
> 
> 赞同：1
> 
> 时间：2012-04-12T09:50:02.973
> 
> 标签：wordpress, blogs

我正在使用自定义页面模板在我想要销售的 WordPress 主题中构建不同的博客布局。除了 post_nav_link 导航（上一篇 | 下一篇）之外，一切都运行良好。wordpress codex 说 post_nav_links 不适用于自定义页面模板，但我真的不想重新开始。我可以做些什么来使 post_nav_link 导航与自定义页面模板一起工作？

法典参考：http: [//codex.wordpress.org/Next_and_Previous_Links](http://codex.wordpress.org/Next_and_Previous_Links)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T10:56:51.040

试试这个，它适用于我的自定义模板，您可能需要添加 args`query_posts`但关键是偏移量。

```
$paged = get_query_var('paged');

$offset = 0;
if ($paged != 0 ) {
    //$paged -1 because there is no page 1, just 0 and 2 And page 0 is skipped
    $offset = ($paged-1) * get_query_var('posts_per_page') ;
}
query_posts('offset=' . $offset);
if (have_posts()) : while (have_posts()) : the_post();
       // the loop 
```

和分页：

```
<div id="pagination">
    <div id="pagination-previous"><?php previous_posts_link('previous'); ?></div>
    <div id="pagination-next"><?php next_posts_link('next'); ?></div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-14T10:10:49.617

谢谢@janw，我会在早上试试这个。在我这样做之前，您能否与我确认这是否是 PHP 标记第一批代码的正确方法？

```
 <?php query_posts("posts_per_page=3"); ?> <!-- Do I keep this line? -->
        <?php $paged = get_query_var('paged'); ?>
        <?php $offset = 0;
        if ($paged != 0 ) {
            //$paged -1 because there is no page 1, just 0 and 2 And page 0 is skipped
            $offset = ($paged-1) * get_query_var('posts_per_page') ;
        } ?>
        <?php query_posts('offset=' . $offset); ?>
        <?php if (have_posts()) : while (have_posts()) : the_post(); ?> 
```

# hdf5 - HDF5 与 ROOT 框架的集成

> ID：10121233
> 
> 赞同：4
> 
> 时间：2012-04-12T09:50:15.597
> 
> 标签：hdf5, root-framework

我与[ROOT](http://en.wikipedia.org/wiki/ROOT)进行了广泛的合作，它有自己的数据文件格式，但由于各种原因，我们想切换到[HDF5](http://www.hdfgroup.org/HDF5/)文件。不幸的是，我们仍然需要一些在格式之间转换文件的方法。有谁知道这样做的任何现有图书馆？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T20:46:45.000

您可以查看 rootpy，它具有通过 PyTables 将 ROOT 文件转换为 HDF5 的功能： [http ://www.rootpy.org/commands/root2hdf5.html](http://www.rootpy.org/commands/root2hdf5.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T20:04:35.097

如果您仍然对这个问题感兴趣，最近对[rootpy](https://github.com/rootpy/rootpy)的[root2hdf5](http://www.rootpy.org/commands/root2hdf5.html)脚本和[root_numpy](https://github.com/rootpy/root_numpy)包（root2hdf5 用于将 TTrees 转换为 NumPy 结构化数组）进行了重大改进：

```
root2hdf5 -h
usage: root2hdf5 [-h] [-n ENTRIES] [-f] [--ext EXT] [-c {0,1,2,3,4,5,6,7,8,9}]
                 [-l {zlib,lzo,bzip2,blosc}] [--script SCRIPT] [-q]
                 files [files ...]

positional arguments:
  files

optional arguments:
  -h, --help            show this help message and exit
  -n ENTRIES, --entries ENTRIES
                        number of entries to read at once (default: 100000.0)
  -f, --force           overwrite existing output files (default: False)
  --ext EXT             output file extension (default: h5)
  -c {0,1,2,3,4,5,6,7,8,9}, --complevel {0,1,2,3,4,5,6,7,8,9}
                        compression level (default: 5)
  -l {zlib,lzo,bzip2,blosc}, --complib {zlib,lzo,bzip2,blosc}
                        compression algorithm (default: zlib)
  --script SCRIPT       Python script containing a function with the same name 
                        that will be called on each tree and must return a tree or 
                        list of trees that will be converted instead of the 
                        original tree (default: None)
  -q, --quiet           suppress all warnings (default: False) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-10T06:30:49.337

截至我上次检查时（几个月前），root2hdf5 有一个限制，它无法处理数组的 TBranches。出于这个原因，我编写了一个 bash 脚本：[root2hdf](https://github.com/ghollisjr/root2hdf)（对不起，非创意名称）。

它将一个 ROOT 文件和文件中 TTree 的路径作为输入参数，并生成源代码并编译为可以在 ROOT 文件上运行的可执行文件，将它们转换为 HDF5 数据集。

它也有一个限制，它不能处理复合 TBranch 类型，但我不知道 root2hdf5 也可以。

# hibernate - 休眠中的条件保存或更新

> ID：10121236
> 
> 赞同：1
> 
> 时间：2012-04-12T09:50:33.600
> 
> 标签：hibernate, hql

我有一个具有日期属性的映射类。我想 saveOrUpdate 此类的对象，以便只有当它比存储的旧时才更新已经存在的对象。

我将如何做到这一点（如果可能的话，整齐而有效地）？

我有很多这样的类，所以我希望避免为所有这些类编写大量的自定义 HQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:04:23.640

不知道这是如何在 java 中实现的，但我相信你可以做类似的事情。

仅供参考，以下类是特定于 NHibernate

您可以扩展`DefaultSaveOrUpdateEventListener`类并覆盖该`PerformSaveOrUpdate`方法，在此方法中您可以编写自定义代码，帮助您识别其中具有 Date 属性的类（具有所有这些类都需要实现的抽象类/接口），然后设置这个属性，然后调用基`SaveOrUpdate`方法。

然后在构建`Configuration`时添加此侦听器。请参阅 Hibernate 文档以了解如何执行此操作。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T09:52:31.960

尝试查看 Spring 中的 HibernateTemplate.saveOrUpdate 。它具有与 required.bieng 开源相同的功能，您可能会看到代码以及实现

# java - OpenGL 不会绑定我的纹理

> ID：10121237
> 
> 赞同：-1
> 
> 时间：2012-04-12T09:50:43.570
> 
> 标签：java, opengl, bufferedimage

我已经解决了问题，以下是我的做法，

RenderEngine中的绑定代码：

```
public int bindTexture(String location)
{
    BufferedImage texture;
    File il = new File(location);

    if(textureMap.containsKey(location))
    {
        glBindTexture(GL_TEXTURE_2D, textureMap.get(location));
        return textureMap.get(location);
    }

    try 
    {
        texture = ImageIO.read(il); 
    }
    catch(Exception e)
    {
        texture = missingTexture;
    }

    try
    {
        int i = glGenTextures();
        ByteBuffer buffer = BufferUtils.createByteBuffer(texture.getWidth() * texture.getHeight() * 4);
        Decoder.decodePNGFileToBuffer(buffer, texture);
        glBindTexture(GL_TEXTURE_2D, i);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, texture.getWidth(), texture.getHeight(), 0, GL_RGBA, GL_UNSIGNED_BYTE, buffer);
        textureMap.put(location, i);
        return i;
    }
    catch(Exception e)
    {
        e.printStackTrace();
    }

    return 0;
} 
```

和PNG解码器方法：

```
public static void decodePNGFileToBuffer(ByteBuffer buffer, BufferedImage image)
{
    int[] pixels = new int[image.getWidth() * image.getHeight()];
    image.getRGB(0, 0, image.getWidth(), image.getHeight(), pixels, 0, image.getWidth());

    for(int y = 0; y < image.getHeight(); y++)
    {
        for(int x = 0; x < image.getWidth(); x++)
        {
            int pixel = pixels[y * image.getWidth() + x];
            buffer.put((byte) ((pixel >> 16) & 0xFF));
            buffer.put((byte) ((pixel >> 8) & 0xFF));
            buffer.put((byte) (pixel & 0xFF)); 
            buffer.put((byte) ((pixel >> 24) & 0xFF));
        }
    }

    buffer.flip();
} 
```

我希望这可以帮助任何有同样问题的人 PS`textureMap`只是一个 HashMap，其中 String 为键，Integer 为值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T09:57:08.070

你的顺序完全错了。你需要：

1.  使用 glGenTextures 生成纹理名称/ID - 将该 ID 存储在变量中
2.  使用 glBindTexture 绑定该 ID
3.  只有这样您才能使用 glTexImage 上传数据

在您的绘图代码中，您正在调用整个纹理加载，这是低效的，而且您每次都在重新创建一个新的纹理名称。使用贴图将纹理文件名映射到 ID，并且仅在尚未分配 ID 时 Gen/Bind/TexImage 纹理。否则，只需绑定它。

# python - Python日期时间时间戳问题

> ID：10121249
> 
> 赞同：0
> 
> 时间：2012-04-12T09:51:28.360
> 
> 标签：python

我试图创建一个以时间戳为键的字典。代码是：

```
 >>> stamp = datetime.datetime(2012, 4, 12, 12, 26, int('13'))
    >>> new_dict = {}
    >>> new_dict[stamp] = 'one'
    >>> print new_dict
    {datetime.datetime(2012, 4, 12, 12, 26, 13): 'one'}
    >>> print stamp
    2012-04-12 12:26:13 
```

为什么不将键作为“2012-04-12 12:26:13”，而是将表达式“datetime.datetime()”作为键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:00:39.197

'2012-04-12 12:26:13' 是一个字符串，`stamp`在您的示例中是一个`datetime.datetime`对象。

您可以将日期时间对象直接用作字典中的键，如[文档](http://docs.python.org/library/datetime.html)中所述（两个相同的日期时间将具有相同的哈希）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T09:55:18.977

因为`stamp`是`datetime.datetime`对象。当您`print`执行此操作时，将打印一个表示该对象的字符串。如果您想要`str`钥匙，请尝试

```
new_dict[str(stamp)] = 'one' 
```

# sql - SQL Server 使用触发器中的插入值创建登录

> ID：10121253
> 
> 赞同：1
> 
> 时间：2012-04-12T09:52:00.713
> 
> 标签：sql, sql-server

我在 sql serevr 2012 中有一个用户表，并希望使用用户表上插入触发器中的插入值创建相应的数据库登录用户。

一切似乎都正常，只是我无法在插入的表中正确使用引用的值，尽管我已经测试了该值以确保它存在

是否有可能创建登录过程不能接受变量

```
ALTER TRIGGER [dbo].[addsyslogin] 
   ON [dbo].[Users]
   FOR  INSERT
AS 
BEGIN
    SET NOCOUNT ON;
    SET QUOTED_IDENTIFIER OFF;

    Declare @u varchar(10);
    SELECT @u=i.userid from inserted i;

    print @u;

CREATE LOGIN [@u] WITH PASSWORD='water123GH', DEFAULT_DATABASE=[waterdb], DEFAULT_LANGUAGE=[British], CHECK_EXPIRATION=OFF, CHECK_POLICY=ON

END 
```

我研究了quoted_identifiers，但我仍然有这个问题。

实际情况是，数据库用户实际上是使用 userid=@u 而不是 @u 中的值创建的。

感谢您的笔记和反馈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:57:57.073

尝试这个：

```
SET @SQL = 'CREATE LOGIN ' + @u+ ' WITH PASSWORD = ''water123GH'', DEFAULT_DATABASE=[waterdb], DEFAULT_LANGUAGE=[British], CHECK_EXPIRATION=OFF, CHECK_POLICY=ON';
EXECUTE(@SQL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:05:15.743

这是一件很奇怪的事情，但你需要......

*   允许多行
*   提升权限
*   使用动态 SQL

其他注意事项：

*   我建议您在 master 中需要一个由触发器调用的单独存储过程来处理升级
*   如果您不需要升级，那么您的权限太高了

粗略的代码：

```
ALTER TRIGGER [dbo].[addsyslogin] ON [dbo].[Users] FOR  INSERT
WITH EXECUTE AS --soemthing
AS 
SET NOCOUNT ON;

Declare @u varchar(10), @uid int;

SELECT TOP 1 @uid = i.userid, @u = i.userid
FROM inserted i
ORDER BY i.userid;

WHILE @u IS NOT NULL
BEGIN
    SET @SQL = 'CREATE LOGIN ' + @u+ ' WITH PASSWORD = ''water123GH'', DEFAULT_DATABASE=[waterdb], DEFAULT_LANGUAGE=[British], CHECK_EXPIRATION=OFF, CHECK_POLICY=ON';

    EXECUTE(@SQL);

    SET @u = NULL;

    SELECT TOP 1 @uid = i.userid, @u = i.userid
    FROM inserted i
    WHERE i.userid > @uid
    ORDER BY i.userid;

 END

 GO 
```

# express - ExpressJS - 从其他文件夹加载部分视图

> ID：10121256
> 
> 赞同：0
> 
> 时间：2012-04-12T09:52:13.307
> 
> 标签：express

在我的视图文件夹中，我有一个名为“events”的文件夹在这里，我有一个模板：**register.ejs**

在我的 views 文件夹中，还有一个名为**members**的文件夹，其中包含一个名为**register_profile的视图**

在 events/register.ejs 中，我有：

```
<%-partial('/views/members/register_profile', {locals: {stuff: things}})%> 
```

但是，在运行该应用程序时，我得到：未能找到视图“members/register_profile”

我已经尝试了各种路径变化，但没有任何效果......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:54:23.090

抱歉……来自文档……

```
<%-partial('../members/register_profile', {locals: {stuff: things}})%> 
```

我错过了 ../ 部分

# eclipse - Eclipse 中的 Drools Java 7 支持

> ID：10121257
> 
> 赞同：2
> 
> 时间：2012-04-12T09:52:15.940
> 
> 标签：eclipse, drools, java-7

我在配置为使用 JRE 1.7 的 Eclipse (Indigo) 中创建了一个 Drools 项目。但是我收到一个指向我的 .drl 文件的错误：

com/sample/DroolsTest$Message：不支持的major.minor 51.0版

com.sample.DroolsTest.Message 类由 .drl 文件导入。Drools 运行时是 5.2.1（也尝试使用 5.3.0.Final）。

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T22:50:50.823

这个异常似乎与 Drools 没有任何关系，但它是一个通用的 Java 错误。如果您尝试使用比用于编译它的 JDK 更旧的 JRE 执行 Java 类，则会发生这种情况。例如，如果您使用 JDK7 编译该类，然后尝试使用 JDK6 执行它，则会收到此错误。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-04T09:54:00.823

只是详细说明上面的答案和评论。我安装了 JRE6 和 JRE7，JRE7 是默认的。我必须做两件事才能从 drools 示例项目中删除错误。

1.  将项目的 JRE 设置为 1.6 Project properties->Java Build Path->Libraries。删除 JRE System Library 1.7 并添加 Library->JRE System Library->Alternate JRE->JRE6
2.  将项目的编译器合规级别设置为 1.6。项目属性->Java 编译器->选中启用项目特定设置并将编译器合规级别设置为 1.6。

# entity-framework-4 - 首先在 EF 代码中枚举

> ID：10121258
> 
> 赞同：2
> 
> 时间：2012-04-12T09:52:17.113
> 
> 标签：entity-framework-4, enums, code-first

请，首先如何在实体框架代码中使用枚举。我希望在我的课堂“Annonce”中我可以拥有这个属性

```
public Status EtatAnnonce { get; set; } 
```

和状态是这样定义的

```
public enum Status
{
    Pending,
    Approved
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T09:58:46.837

您需要创建一个转换器字段以将值作为 int 存储在数据库中。

```
public int MyEnumValueInt {get;set;}

[NotMapped]
public MyEnum MyEnumValue
{
    get{ return (MyEnum)MyEnumValueInt;
    set{ MyEnumValueInt = (int)value;
} 
```

注意：枚举支持将在 EF 5 中得到改进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-24T10:26:16.207

将指向你

[EF5 不创建枚举列](https://stackoverflow.com/questions/14647874/ef5-does-not-create-enum-columns)

先总结一下实体框架代码中的枚举支持：

EF4：不支持

EF5: only supported if you are targeting .net framework 4.5 and higher

EF6: only supported if you target .net 4.0 and higher

Cheers!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:01:32.517

我已经回答了关于 EF 中枚举的两个问题；这些应该可以帮助您：

[使用 EF 代码优先的枚举 - 播种 DB 然后使用的标准方法？](https://stackoverflow.com/questions/6344032/enums-with-ef-code-first-standard-method-to-seeding-db-and-then-using/6344096#6344096)

和

[EF 4.1 Code First - 将枚举包装器映射为复杂类型](https://stackoverflow.com/questions/5667473/ef-4-1-code-first-map-enum-wrapper-as-complex-type/5673768#5673768)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-13T05:17:18.387

您可以在模型中使用私有属性将数据映射到您想要的任何属性类型。

```
// Model
public class Piece
{

    // Subclass Piece to add mappings for private properties
    public class PieceConfig : EntityTypeConfiguration<Piece>
    {
        public PieceConfig()
        {
            Property(b => b.dbtype); // needed for EF to see the private property
        }
    }

    [Column("type", TypeName = "VARCHAR")]
    private string dbtype { get; set; }

    [NotMapped]
    public PIECE type
    {
        get { return (PIECE)Enum.Parse(typeof(PIECE), dbtype); }
        set { dbtype= value.ToString(); }
    }
} 
```

然后您只需将配置添加到您的 OnModelCreating 方法

```
modelBuilder.Configurations.Add(new Piece.PieceConfig()); 
```

# java - Java AppletContext 和 showDocument() 方法

> ID：10121269
> 
> 赞同：0
> 
> 时间：2012-04-12T09:53:24.423
> 
> 标签：java, applet

```
 import java.awt.*;
    import java.applet.*;
    import java.net.*;
    /*<applet code=CodeBase width=300 height=300>
    </applet>*/
    public class CodeBase extends Applet
    {
      String sn,br;
      URL url;

    public void start()
    {
     AppletContext ac=getAppletContext();
     url=getCodeBase();
     try{
            ac.showDocument(new URL(url+"a.html"));
    System.out.println("Hello");
   // ac.showDocument(new URL("D:Java Programs//Applet//a.html"));
        }
        catch(MalformedURLException e)
     {
        showStatus("Url not found");
    }

    }

    } 
```

此代码不显示`a.html`in 小程序的文档。当我们使用`AppletContext.showDocument()`方法时，它会在指定的 URL 处显示文档，但它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:12:14.383

作为第一个建议，更改：

```
ac.showDocument(new URL(url+"a.html")); 
```

至：

```
ac.showDocument(new URL(url,"a.html")); 
```

但更好的是，在之前/之后添加一些健全性检查。就像是：

```
URL urlPlus = new URL(url+"a.html");
System.out.println(urlPlus);
URL urlComma = new URL(url,"a.html");
System.out.println(urlComma);
// ... 
```

最后一部分就是我所说的“健全性检查调试”。使用带有调试器的 IDE 进行检查更容易，但如果不这样做，请使用*“如有疑问，请**打印出来！** ”的原则。*

# windows - 无法验证 Dreamspark 帐户

> ID：10121278
> 
> 赞同：0
> 
> 时间：2012-04-12T09:54:09.277
> 
> 标签：windows, windows-phone-7, account

我们目前正在尝试将我们的 Windows Phone 7 应用程序部署到手机，并且需要在此过程中注册应用程序中心开发人员帐户。我们都有与我们都去的大学相关联的 Dreamspark 帐户，但是当我们尝试注册 (https://users.create.msdn.com/Register) 时，网站不知何故无法识别我们的帐户。

另一种选择是支付 80 美元来获得一个帐户，但当我们应该能够免费注册时，我们宁愿避免额外的费用。

以前有没有其他人遇到过同样的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T13:17:58.270

您是否尝试登录您的梦想公园并尝试在应用程序中心注册？我验证 Dreamspark 帐户时没有任何问题。登录 Dream Spark 并尝试将您的帐户与 apphub 关联后，请检查您的电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-30T07:14:41.013

仅注册@dreamspark 是不够的..您必须自己注册才能发布您的应用程序。查看链接[https://www.dreamspark.com/Student/Windows-Phone-7-App-Development.aspx](https://www.dreamspark.com/Student/Windows-Phone-7-App-Development.aspx)！转到选项3并单击链接进行注册

# java - 将 XML 文档转换为字符串

> ID：10121279
> 
> 赞同：0
> 
> 时间：2012-04-12T09:54:13.040
> 
> 标签：java, xml

我正在使用以下代码更改 xml 文档：

```
DocumentBuilderFactory fty1 = DocumentBuilderFactory.newInstance();
   fty1.setNamespaceAware(true);
   DocumentBuilder builder1 = fty1.newDocumentBuilder();
   ByteArrayInputStream bais1 = new ByteArrayInputStream(tr1.getBytes());//tr1=xml string
   Document xmldoc1=builder1.parse(bais1);
   xmldoc1.getElementsByTagName("userID").item(0).setTextContent("123123132"); 
```

xmldoc1 包含更改后的表单。现在如何将其转换为字符串，以便可以将新文档传递给其他人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:09:59.083

```
Transformer transformer = TransformerFactory.newInstance().newTransformer();
transformer.setOutputProperty(OutputKeys.INDENT, "yes");        
StringWriter sw = new StringWriter();
StreamResult result = new StreamResult(sw);
DOMSource source = new DOMSource(xmldoc1);
transformer.transform(source, result);
String xmlString = sw.toString(); 
```

# android-layout - 如何将焦点设置在顶部项目上？

> ID：10121280
> 
> 赞同：1
> 
> 时间：2012-04-12T09:54:14.203
> 
> 标签：android-layout

我有一个滚动视图，但是在运行代码时，我发现顶部的某些项目是隐藏的。我想从最上面显示这个滚动视图。请帮我。代码在这里

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<ScrollView
    android:id="@+id/scrollView1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" 
    android:scrollbars="none"
    android:scrollX="0px">

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical" >

         <ImageView
            android:id="@+id/img_logo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:src="@drawable/logo"
            android:focusable="true" 
            android:layout_marginTop="1dip" />

        <ImageView
            android:id="@+id/img_logo"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:src="@drawable/jvdbanner" />

        <ListView
            android:id="@+id/main_list"
            android:layout_width="fill_parent"
            android:layout_height="279dip"
            android:background="#84CFE7"
            android:cacheColorHint="#00000000"
            android:divider="#000000"
            android:dividerHeight="1dip"
            android:focusable="false"
            android:fadingEdge="none"
            android:scrollbars="none" />

        <View
            android:layout_width="fill_parent"
            android:layout_height="2dip"
            android:layout_marginTop="5dip"
            android:background="#ffffff" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="10dip"
            android:text="Copyright @ 2012- JVD Properties, Inc."
            android:textColor="#ffffff"
            android:textSize="13sp" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="5dip"
            android:text="All Rights Reserved."
            android:textColor="#ffffff"
            android:textSize="13sp" />
    </LinearLayout>
</ScrollView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T17:18:09.767

试试这个代码..希望它对你有用

```
final ScrollView main = (ScrollView) findViewById(R.id.scrollView1);

    main.post(new Runnable() {

        public void run() {

            main.scrollTo(0,0);
        }
    }); 
```

# qt - Qt App 构建中未来问题中的时钟偏差和修改时间

> ID：10121282
> 
> 赞同：0
> 
> 时间：2012-04-12T09:54:21.663
> 
> 标签：qt

我是 Qt 新手并开始开发应用程序，但*在为真实设备构建项目时出现以下错误。*同样在模拟器应用程序上运行良好，它只会在为真实设备构建/运行时出错。 *它也不会在项目文件夹目录中创建任何 sis 包。*请帮我解决这个问题。

bq。make[1]：警告：检测到时钟偏差。您的构建可能不完整。C:\QtSDK\Symbian\SDKs\Symbian1Qt473\epoc32\tools\make.exe：警告：检测到时钟偏差。您的构建可能不完整。进程“C:\QtSDK\Symbian\SDKs\Symbian1Qt473\epoc32\tools\make.exe”正常退出。构建项目 umrahqml 时出错（目标：Symbian 设备）执行构建步骤“Make”时

*该错误与时钟偏差问题和修改时间问题有关。任何想法？* 我的应用程序快完成了，但由于上述错误无法创建 sis 包，因此无法测试。

任何想法/帮助将不胜感激。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:10:26.473

确保您的计算机时钟设置为正确的日期/时间。

# c++ - C++11 中 lambda 的非确定性损坏

> ID：10121291
> 
> 赞同：6
> 
> 时间：2012-04-12T09:54:42.897
> 
> 标签：c++, visual-studio-2010, visual-c++, lambda, c++11

受到 Herb Sutter 引人入胜的演讲[Not your Father's C++](http://channel9.msdn.com/Events/Lang-NEXT/Lang-NEXT-2012/-Not-Your-Father-s-C-)的启发，我决定使用 Microsoft 的 Visual Studio 2010 再看看最新版本的 C++。我对 Herb 关于 C++ 是“安全”的断言特别感兴趣，因为我没有听说过 C ++11 解决了众所周知的向上 funarg 问题。据我所知，C++11 没有解决这个问题，因此不是“安全的”。

您不想返回对局部变量的引用，因为局部变量是在函数返回后将不再存在的堆栈帧上分配的，因此，函数将返回一个指向已分配内存的悬空指针，这将导致非-确定性数据损坏。C 和 C++ 编译器知道这一点，并在您尝试返回指向本地的引用或指针时警告您。例如，这个程序：

```
int &bar() {
  int n=0;
  return n;
} 
```

导致 Visual Studio 2010 发出警告：

```
warning C4172: returning address of local variable or temporary 
```

但是，C++11 中的 lambda 可以很容易地通过引用捕获局部变量并返回该引用，从而产生等效的悬空指针。考虑以下函数`foo`，它返回一个捕获局部变量`n`并返回它的 lambda 函数：

```
#include <functional>

std::function<int()> foo(int n) {
  return [&](){return n;};
} 
```

这个看似无害的函数是内存不安全的，也是损坏数据的来源。调用此函数以在一个位置获取 lambda，然后调用 lambda 并在另一个位置打印其返回值，将为我提供以下输出：

```
1825836376 
```

此外，Visual Studio 2010 没有给出警告。

对我来说，这看起来像是语言中一个非常严重的设计缺陷。即使是最简单的重构也可以使 lambda 跨堆栈帧，默默地引入非确定性数据损坏。然而，关于这个问题的信息似乎很少（例如在 StackOverflow 上搜索“upwards funarg”和 C++ 没有得到任何结果）。人们是否意识到这一点？是否有人正在研究解决方案或描述解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T12:37:10.067

这不是特定于 lambdas 的，当涉及到生命周期时，你可以做很多坏事（你已经注意到了至少一种情况）。尽管与 C++03 相比，C++11 在某些方面可能更安全，但 C++ 并未强调内存安全。

这并不是说 C++*不*想要安全，但我想说的是“不要为你不使用的东西买单”通常会妨碍添加安全防护（不考虑像可能会阻止对所有无效程序发出诊断的问题）。如果你能解决向上的函数问题*而不*影响其他所有情况的性能，那么标准委员会就会感兴趣。（我并不是说，我认为这是一个有趣且*困难*的问题。）

由于您似乎正在追赶，那么到目前为止作者（和其他人）的智慧通常是避免对 lambda 表达式（例如`[&, foo, bar]`）使用按引用捕获全部捕获，并且要小心 by-一般参考捕获。您可以将 lambda 表达式的捕获列表视为 C++ 中必须注意生命周期的另一个地方；或者另一种观点是将 lambda 表达式视为函子的对象文字符号（实际上它们是这样指定的）。当你设计一个关于生命周期的类类型时，你必须小心：

```
struct foo {
    explicit foo(T& t)
        : ref(t)
    {}

    T& ref;
};

foo make_foo()
{
    T t;
    // Bad
    return foo { t };
    // Not altogether different from
    // return [&t] {};
} 
```

在这方面，lambda 表达式不会改变编写“明显”错误代码的现状，并且它们继承了所有预先存在的警告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T17:16:46.490

如果你试图让自己幸福地不知道内存处理，你就不能简单地在任何复杂的 C++ 项目中工作。有数百种语言更好地针对这种范式。C++没有垃圾回收是有原因的；它确实不适合您要使用 C++ 的场景

据说，在您的 lambda 示例中，一个简单的更改将使您的 lambda 示例完全安全：

```
#include <functional>

std::function<int()> foo(int n) {
  return [=](){return n;}; //now n is copied by value
} 
```

# java - 丢弃字符串[] java中的空值

> ID：10121303
> 
> 赞同：0
> 
> 时间：2012-04-12T09:55:36.777
> 
> 标签：java, android

我通过解析api来获取一些值，现在我想检查是否通过解析值变为null，那么值不应该被添加到字符串数组中，如果有一些值那么只应该被添加到string[] . 请帮助这是我的代码：

```
String[] title_array=null;
myparseobj=new XMLParser();
if(myparseobj.xmlParsing(url,"item","title") != null){
    title_array=myparseobj.xmlParsing(url,"item","title");
} 
```

但这不起作用请帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:00:59.913

`myparseobj=new XMLParser();`
`String val = myparseobj.xmlParsing(url,"item","title");`
`if(!((val == null)||("null".equalsIgnoreCase(val))){`
``title_array=myparseobj.xmlParsing(url,"item","title"); }``

# javascript - 孩子的 CSS 全局类问题

> ID：10121306
> 
> 赞同：0
> 
> 时间：2012-04-12T09:55:50.267
> 
> 标签：javascript, jquery, html, css

我有一个 html 的全局类

```
<div class="wrapper">

<div class="content"></div>

</div> 
```

和CSS是

```
.div { width:auto; display:block }

.content {  width:100px;  height:50px; } 
```

在 .content div 上，我不需要“display:block”类。但它适用于运行时。我给了显示：继承；但它不起作用。有没有其他方法可以删除显示样式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T09:58:33.267

```
.content {  width:100px;  height:50px; display: inline; } 
```

或其他显示属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T09:58:56.280

你可以这样做：

```
.content {  width:100px;  height:50px; display:inline }
//or display:none or whatever your standard default is 
```

`inline`是默认值，请参阅[MDN Ref](https://developer.mozilla.org/en/CSS/display)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T09:59:49.553

```
.div { width:auto; display:block } 
```

这可能不起作用....对于上面提供的 html cos 没有名为 div 的类

你能做的是

```
.content {  width:100px;  height:50px; display:inline} 
```

# android-twitter - 在 OAuth 身份验证中出现错误

> ID：10121311
> 
> 赞同：1
> 
> 时间：2012-04-12T09:56:12.473
> 
> 标签：android-twitter

```
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221): Error during OAUth retrieve request token
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221): oauth.signpost.exception.OAuthCommunicationException: Communication with the service provider failed: Permission denied (maybe missing INTERNET permission)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at oauth.signpost.AbstractOAuthProvider.retrieveToken(AbstractOAuthProvider.java:214)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at oauth.signpost.AbstractOAuthProvider.retrieveRequestToken(AbstractOAuthProvider.java:69)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at com.qa.android.OAuthRequestTokenTask.doInBackground(OAuthRequestTokenTask.java:37)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at com.qa.android.OAuthRequestTokenTask.doInBackground(OAuthRequestTokenTask.java:1)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at android.os.AsyncTask$2.call(AsyncTask.java:185)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1068)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:561)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at java.lang.Thread.run(Thread.java:1096)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221): Caused by: java.net.SocketException: Permission denied (maybe missing INTERNET permission)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.harmony.luni.platform.OSNetworkSystem.createStreamSocketImpl(Native Method)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.harmony.luni.platform.OSNetworkSystem.createStreamSocket(OSNetworkSystem.java:187)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.harmony.luni.net.PlainSocketImpl.create(PlainSocketImpl.java:266)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at java.net.Socket.checkClosedAndCreate(Socket.java:872)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at java.net.Socket.connect(Socket.java:1019)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.conn.ssl.SSLSocketFactory.connectSocket(SSLSocketFactory.java:317)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:129)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:348)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at oauth.signpost.commonshttp.CommonsHttpOAuthProvider.sendRequest(CommonsHttpOAuthProvider.java:64)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    at oauth.signpost.AbstractOAuthProvider.retrieveToken(AbstractOAuthProvider.java:177)
04-12 15:19:29.317: E/com.qa.android.OAuthRequestTokenTask(221):    ... 9 more 
```

这是我得到的错误。请帮我解决这些问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-22T18:20:23.043

您需要互联网许可才能执行该操作。您可以将此权限添加到清单文件中。

# string - 将城市名称缩短为人类可读代码的算法

> ID：10121312
> 
> 赞同：0
> 
> 时间：2012-04-12T09:56:12.833
> 
> 标签：string, algorithm, url, geolocation

我在这个项目的 url 中使用区域和城市。现在许多地区和城市的名称可能很长，而缩短的地区/城市信息的组合可能会导致歧义。

是否有一种简单的方法可以以某种方式自动缩短单词，使它们仍然有意义且可读，但被缩短而不只是切断结尾？

就像将不来梅港变成 Brmhvn 或将康涅狄格州纽黑文变成 NewHvn-Cnctct？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T18:14:01.360

世界城市列表中有 2797245 个城市，可从[http://www.maxmind.com/app/worldcities免费获得](http://www.maxmind.com/app/worldcities)

我会设计类似于

```
{Country TLD}/{Abbreviation for state, province or prefecture}/{Trim of county or district}/{Trim of city} 
```

一些例子，

*   www.example.com/US/NY/-/NewYork
*   www.example.com/US/NY/ *Westcheste* /MtVernon（[纽约州威彻斯特县的弗农山](http://en.wikipedia.org/wiki/Mount_Vernon,_New_York)） *- 县被修剪为 10 个前字符。城市名称中常用词的缩写*
*   www.example.com/DE/Bavaria/Munich
*   www.example.com/JP/Tohoku/Miyagi/Sendai（[仙台](http://en.wikipedia.org/wiki/Sendai,_Miyagi)）

对于该地区，您可能需要考虑使用[ISO 3166 代码](http://en.wikipedia.org/wiki/ISO_3166)。因此，慕尼黑和仙台的上述示例看起来像

*   www.example.com/JP/Tohoku/ *JP-04* /仙台
*   www.example.com/DE/DE-BY/慕尼黑*_*

其他线索

*   [HASC](http://en.wikipedia.org/wiki/Hierarchical_administrative_subdivision_codes)（分级行政区划代码），用于表示国家/地区细分的名称，例如州、省、地区。
*   [http://en.wikipedia.org/wiki/ISO_3166-2:US](http://en.wikipedia.org/wiki/ISO_3166-2:US)
*   [http://www.statoids.com/uus.html](http://www.statoids.com/uus.html)

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:15:10.257

如果您希望较短的版本对人类有意义，我认为这非常复杂，因为它不是很明显什么可以正确代表全名。

例如：我自己的城市赫尔辛堡。只给这个名字，我会把它分成每个音节一个字母。Hel-Sing-Borg -> HSB。但我从未见过有人使用这个缩写词。我认识的每个人都使用 HBG。

简而言之，我会说创建一个为任何给定游戏制作逻辑首字母缩写词的函数相当容易，但很难尝试制作一个人类可识别的函数。

如果你只是想从名字中剪掉一些字母，那可能会容易得多，但你可能想和一位英语教授谈谈，以了解可以在不影响可读性的情况下剪掉名字的哪些部分。但这是可能的，而且很可能有一些关于我们如何阅读你可以参考的单词的公开研究。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T10:29:40.713

最好建议您采用现有的代码列表，而不是自己编写代码列表。例如，您可以使用[IATA 代码](http://www.nationsonline.org/oneworld/airport_code.htm)或[邮政编码](http://www.geopostcodes.com/)，甚至电话拨号代码（找到您自己的链接）。

# ruby-on-rails - 在同一服务器上的两个不同应用程序中运行 sphinx

> ID：10121323
> 
> 赞同：2
> 
> 时间：2012-04-12T09:56:49.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sphinx, thinking-sphinx

我有两个有搜索功能的小应用程序。它们完全是两个不同的应用程序，具有不同的数据库等。

现在问题出现在 pid 文件中。有时只有在应用程序上搜索原因时我才这样做

```
rake ts:start 
```

在一个上它说另一个实例已经在运行。如何更改此设置，以便 sphinx 继续为这两个应用程序运行。我正在使用 Capistrano 进行开发。

结构是这样的：

```
 /home/me/my_app_1/production/current
  /home/me/my_app_2/production/current 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T11:17:59.623

在这两个应用程序中，您必须创建一个`config/sphinx.yml`可以包含各种配置变量的变量，其中一个允许您指定 sphinx 服务器的端口。当您在一个应用程序中手动定义端口时，如下所示：

```
development:
  port: 9313
test:
  port: 9314
production:
  port: 9316 
```

在另一个：

```
development:
  port: 9317
test:
  port: 9318
production:
  port: 9319 
```

然后调用`rake ts:rebuild`两个应用程序。Thinking sphinx 将为 sphinx 生成新的配置文件，为每个应用程序和应用程序中的每个环境设置不同的 sphinx 实例。

# c++ - 相等的 C++ STL 容器内容算法

> ID：10121324
> 
> 赞同：2
> 
> 时间：2012-04-12T09:56:54.110
> 
> 标签：c++, algorithm, stl, containers

STL 或 Boost 是否包含用于比较不同类型容器*内容的算法。*如果没有人写过这样的算法。我会称之为`equal_contents`或干脆`equals`。当断言某些算法为不同的输入容器类型返回相同的内容时，这很有用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T09:59:08.257

是的，有[std::equal](http://www.sgi.com/tech/stl/equal.html)算法。您需要将迭代器传递给该算法，容器的类型无关紧要。

# javascript - 如何替换 DOM 节点并在之后包装它？

> ID：10121325
> 
> 赞同：0
> 
> 时间：2012-04-12T09:56:58.153
> 
> 标签：javascript, jquery, replacewith

我有一个 div，我将其替换为 textarea，例如：

```
var $targetDiv = $('#the-div');
var $newDiv = $('#the-new-div');

$targetDiv.replaceWith($newDiv); 
```

这会变成：

```
<div id="the-div"></div> 
```

进入：

```
<div id="the-new-div"></div> 
```

我将如何包装`<div id="the-new-div"></div>`一个名为 的 div `<div id="the-new-div-wrapper">`？

所以结果会变成：

```
<div id="the-new-div-wrapper">
<div id="the-new-div">
</div>
</div> 
```

```
$targetDiv.replaceWith($newDiv).wrap('<div id="the-new-div-wrapper"' />') 
```

似乎不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:00:17.833

先做包装

```
$targetDiv.wrap('<div id="the-new-div-wrapper" />').replaceWith($newDiv); 
```

或者分成两行：

```
$targetDiv.replaceWith($newDiv);
$newDiv.wrap('<div id="the-new-div-wrapper" />'); 
```

[小提琴](http://jsfiddle.net/VcPQG/)

您的代码中还有一个错字：`$targetDiv.replaceWith($newDiv).wrap('<div id="the-new-div-wrapper"' />')`有一个额外的撇号，不应该在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:07:54.653

试试这个

```
$targetDiv.replaceWith($newDiv.wrap('<div id="the-new-div-wrapper"' />')); 
```

它实际上会在批次替换目标 div 之前包装 div，但会达到相同的结果。

看这里

[http://jsfiddle.net/WgW6Y/](http://jsfiddle.net/WgW6Y/)

# php - PHP 输入验证 - 需要注意的事项？

> ID：10121329
> 
> 赞同：0
> 
> 时间：2012-04-12T09:57:13.987
> 
> 标签：php, validation, input

我正在创建一个验证用户输入的文本的函数。由于我对输入文本有多种用途，因此我希望该功能涵盖尽可能多的领域，以考虑让用户在网站的任何部分输入文本的安全问题。我目前使用各种代码来根据需要验证各种输入，并试图将其安全部分整合到一个函数中，并将正则表达式（电子邮件、电话、密码验证）整合到另一个可以在整个网站上使用的函数中。

我有一个与此相关的问题。

在根据数据库中的信息检查输入时，我使用这一位过滤来清理用户输入：

```
$find = strtoupper($find); 
$find = strip_tags($find); 
$find = trim ($find);
$_SESSION['find'] = $find;
$keywords_array = explode(' ', $find); 
```

如果我使用`strip_tags`在上面应用的过滤之前验证这样的输入是否有意义：

```
if (preg_match("#\bscript\b#",$_POST['search']))
        {
            // Get user ip
            // Log client details to DB
            $GLOBALS['errorFocus'] = "autofocus class='thisInputIsError'";
            $GLOBALS['searchError'] = '<p>Your IP has been logged!</p>';
        } 
```

如果是这样，我应该注意哪些其他标签？

另外，关于我要组合的功能，我还应该注意哪些其他事项？

任何涵盖此内容的好教程的链接也很棒:)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:00:11.407

php 确实内置了过滤和验证，请阅读[http://php.net/manual/en/book.filter.php](http://php.net/manual/en/book.filter.php)如果您想要自定义过滤 HTML 内容， 您也可以考虑[使用 HTMLpurifier或 tidy](http://htmlpurifier.org/)

# iphone - 当它是一个属性时创建一个 UILabel

> ID：10121334
> 
> 赞同：1
> 
> 时间：2012-04-12T09:57:36.233
> 
> 标签：iphone, ios, xcode, properties, uilabel

我想我在这里有点愚蠢，但我想知道你是否可以对此有所了解。

我有一个带有视图和按钮的单视图应用程序。在我的`viewControllers`按钮操作中，我想在屏幕上创建一个标签。

如果我创建一个标签：`UIlabel * label = [UIlabel alloc] initwithframe...`它工作正常。

但是，如果我给我的 viewController 一个 uilabel 属性，然后尝试使用以下命令创建一个标签：`self.mylabel = [UILabel alloc] initWithFrame...`当我添加标签时，它不会出现。

我知道还有其他方法可以实现这一点，但我只是想知道为什么会发生这种情况，除非我是个大白痴！

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:03:23.297

确保将其作为子视图添加到 viewController 的视图中。

`[self.view addSubview:label]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T13:15:39.213

在您将标签添加到视图中时，您的标签很可能为零。如果您确定您的标签至少被正确分配，那么在它的@property 声明中明确检查它是如何保留（或不保留）的。

例如，如果您声明它是**弱**的，那么您需要初始化并使用范围内的标签。

在将标签添加到视图的代码上放置一个断点，以便为您提供有关正在发生的事情的线索。

# android - 图像识别将图像转换为android中的文本

> ID：10121340
> 
> 赞同：1
> 
> 时间：2012-04-12T09:57:53.300
> 
> 标签：android, image-processing, text

我现在正在做一个图像到文本转换的项目，我经历了各种过程，比如精明算法等等，但没有得到解决方案。最后我在下面的链接中得到了一个[视频](http://www.youtube.com/watch?v=2Mds_NDQotc&feature=plcp&context=C428f513VDvjVQa1PpcFNa26jZifCC1B9NUmb71uufeBy1RolOQLg=)

我现在需要完全相同的应用程序我该如何实现这个请给我一个解决方案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:18:04.273

我相信你想从图片中识别字符，这里有一些相关的帖子

[是否有适用于 Android 的免费 OCR 库？](https://stackoverflow.com/questions/1106202/android-ocr)

[我应该在 Android 中使用哪种 OCR Java 库？](https://stackoverflow.com/questions/1062578/what-kind-of-ocr-java-library-should-i-use-in-android)

Android 相机的概念验证词输入 [http://code.google.com/p/wordsnap-ocr/](http://code.google.com/p/wordsnap-ocr/)

# iphone - @autoreleasepool 在循环中还是在@autoreleasepool 中循环？

> ID：10121345
> 
> 赞同：25
> 
> 时间：2012-04-12T09:58:13.373
> 
> 标签：iphone, objective-c

在循环操作时将大量**自动释放的对象放入自动释放池中是一种很好的做法。**我发现有人将@autoreleasepool 放入循环，但其他人将循环放入@autoreleasepool。

1：

```
while ([rs next]) {
    @autoreleasepool {
        NSDictionary *dict = [self dictFromXX];
        //...
    }
} 
```

2：

```
@autoreleasepool {
    while ([rs next]) {
        NSDictionary *dict = [self dictFromXX];
        //...
    }
} 
```

哪个更好？或者代码1和2之间有什么区别？

谢谢！

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-12T10:09:00.440

在您的第一个示例中，每次迭代都会耗尽池。如果迭代的主体涉及大量自动释放的对象，这是有道理的。

第二个示例只会在循环后耗尽池一次。

因此，如果循环的内部导致内存膨胀，请选择选项一。如果整个循环的内存膨胀是可以接受的，那么循环然后使用选项二。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T10:05:36.243

在第一个示例中，autoreleasepool 在迭代开始时创建，并在迭代结束时被耗尽。在第二种情况下，池被创建一次，只有在循环完成后才被销毁。如果您使用第二种变体，那么您可能会获得很大的内存开销，因为所有自动释放的对象仅在最后才被释放。但是，您应该考虑需要处理的数据量。在大多数情况下，第二个变体是更优选的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T10:03:18.257

我会选择第 2 版。

当块完成时，`@autoreleasepool`块将释放所有接收到的对象`autorelease`。这将需要一些时间，因为它需要一些 cpu 周期，并且根据对象的不同，使用的时间可能比预期的要高得多。

我认为 custom`@autoreleasepool`仅在处理 > 20MB 的许多数据或在非主线程中处理 Data 时才有意义。

所以。我建议避免“短” `@autoreleasepool`。因为它可能会减慢您的执行速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:00:16.637

这是使用 Core Data 和 autoreleasepools 的另一种方法：

使用对您很重要的[高效导入数据](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdImporting.html)[的非常大的分层数据集测试核心数据](http://cocoawithlove.com/2008/03/testing-core-data-with-very-big.html)`Wrap the contents of the outer loop in an NSAutoreleasePool init/release and NSManagedObjectContext save`是解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T10:10:07.627

取决于将释放多少待处理的项目。图像自动释放池就像你的垃圾一样，放置未使用的东西，稍后再扔。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-12T10:22:09.697

> `@autoreleasepool`块比直接使用实例更有效`NSAutoreleasePool`；即使您不使用 ARC，也可以使用它们。- [NSAutoreleasePool 类参考](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSAutoreleasePool_Class/Reference/Reference.html)

您通常不需要自动释放池，如果您这样做是因为您处于循环中并自动释放大量对象，那么选项 1 比 2 更有意义，因为您试图避免循环创建的尖峰。使用选项 2 的时间是如果没有设置自动释放池（例如，如果您在后台或在后台执行选择器`+load`），但无论如何您都应该尝试使用 GCD。

总之，如果您没有很长的方法并且需要在自动释放池中包装一个循环，那么在大多数情况下选择选项 1。如果在没有设置自动释放池的情况下调用该方法，那么`@autorelease`首先需要做的是。

# chef-infra - 如何在托管 Chef 节点上使用 ark

> ID：10121348
> 
> 赞同：0
> 
> 时间：2012-04-12T09:58:26.327
> 
> 标签：chef-infra, cookbook

我在托管厨师节点的运行列表中添加了方舟食谱。现在我想在另一本食谱中使用方舟，就在方舟食谱之后。

我在方舟食谱之后的食谱中加入了方舟食谱。代码如下所示：

```
include_recipe "ark" 
```

下载 olio

```
subversion "checkout-olio" do
  repository "https://svn.apache.org/repos/asf/incubator/olio/"
  revision "HEAD"
  destination "/usr/local"
  action :checkout
end 
```

安装faban

```
ark "install-faban" do
  url "http://java.net/projects/faban/downloads/download/faban-kit/faban-kit-022311.tar.gz"
  version "1.0"
  path "/usr/local"
  append_env_path true
end 
```

当我上传此文件并运行客户端时，会发生以下错误：

```
NoMethodError: undefined method `url' for Chef::Resource::Ark 
```

有人可以告诉我问题出在哪里吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T19:41:00.630

我没有用过这本食谱，但看起来 ark 的属性是 release_url 而不是 url：

```
 release_url: url for tarball, .tar.gz, .bin (oracle-specific), .war, and .zip currently supported. Also supports special syntax :name:version:apache_mirror: that will auto-magically construct download url from the apache mirrors site 
```

# windows - SVN 提交后挂钩批处理窗口

> ID：10121349
> 
> 赞同：3
> 
> 时间：2012-04-12T09:58:32.220
> 
> 标签：windows, batch-file, svn, visualsvn-server, post-commit-hook

我有一个运行 Visual SVN Server 的 Windows Server 来存储我们的存储库。该服务器上还有我们的测试副本。

我正在尝试设置一个简单的 SVN 提交后挂钩，以便每次我提交某些内容时它都会自动更新该测试副本

在提交后挂钩的 Visual SVN 中，我已经像这样设置了

```
"C:\Program Files (x86)\VisualSVN Server\bin\updatescripts.bat" D:\inetpub\TESTCOPY 
```

然后那个批处理文件有一个像这样的简单更新

```
PATH=%PATH%;"C:\Program Files (x86)\VisualSVN Server\bin\"
svn update %1 
```

如果我通过双击它或从命令行运行服务器中的批处理文件，则可以正常工作。从我的笔记本电脑提交某些内容时，它会冻结并且不会给我任何错误并锁定测试副本，因此我需要进入并运行清理。

Visual SVN 服务作为网络服务运行，并且此帐户对服务器上的 bin 文件夹和测试副本具有完全访问权限。

知道如何设置一个简单的 svn update post commit hook 吗？

谢谢费德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-25T18:49:55.467

你正在运行`svn update`命令。您到底要更新什么工作副本？

传递的参数是***存储库的路径***。这不是指向工作目录，而是指向包含 Subversion 主存储库的目录。这是存储提交后挂钩的同一目录。

Subversion 挂钩无权访问用户的工作目录，因此您无法操作用户的文件。挂钩脚本通常应该使用`svnlook`而不是`svn`. 通过这样做，您可以防止自己陷入任何麻烦。

如果您知道位置，则可以在服务器上更新 Subversion 工作副本：

```
PATH=%PATH%;"C:\Program Files (x86)\VisualSVN Server\bin\"
set SVN_WORK_DIR=C:\SVN\workdir"
svn update %SVN_WORK_DIR% 
```

但是，我不推荐这样做，因为它与 Subversion 相关联。进行提交的用户必须等到更新完成后，Subversion 才会将提示的控制权返回给用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T13:48:49.813

我遇到了类似的问题，结果证明 SVN 喜欢使用正斜杠而不是反斜杠的路径。

尝试这个：

```
set MYPATH=%1

:: Transform backslashes to forward slashes
set MYPATH=%MYPATH:^\=/%

svn update %MYPATH% 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T18:43:04.647

在尝试了一百万种不同的东西之后，这对我有用......

我把它放在我的提交后挂钩 "C:\Program Files\VisualSVN Server\bin\svn.exe" update "C:\my path\" 其中我的路径是要更新的工作副本的路径

我还必须更改服务以作为本地系统运行

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-25T15:29:18.793

这*真的*不是你想要的方式。你应该做的是使用像[Jenkins](http://jenkins-ci.org/)这样的东西来监视你的存储库。Jenkins 可以监视您的存储库，并在它发生更改时更新您的测试副本、启动构建、运行自动化测试等。

# html - div 标题只显示一次

> ID：10121360
> 
> 赞同：0
> 
> 时间：2012-04-12T09:59:12.033
> 
> 标签：html, mouseover

我正在使用这段代码：

```
<div id="m1" class="drag"; title="CARS"
   style="position:absolute; left:0px; top:0px; width:32px; height:32px;">
 <img src="http://mapicons.nicolasmollet.com/wp-content/uploads/mapicons/shape-default/color-ff8a22/shapecolor-color/shadow-1/border-dark/symbolstyle-white/symbolshadowstyle-dark/gradient-no/sportscar.png"
   width="32" height="32" alt="" />
</div> 
```

当我将鼠标移到它上面时，它正确显示了标题 CARS，然后我将标记拖到谷歌地图上，一个新的标记替换了我刚刚拖动的标记，但标题 CARS 不再显示在原始标记的同一位置曾是。

有没有办法解决这个问题？我试过 this.title 但它使标记不可拖动。

在此先感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:02:01.393

将标题赋予 img，而不是 div

编辑：

我认为错误在于您的javascript。

```
// Append icon
  var img = document.createElement("img");
  img.src = obj.firstChild.getAttribute("src");
  img.style.width = "32px";
  img.style.height = "32px";
  m.appendChild(img);
  drag_area.replaceChild(m, obj); 
```

我想你不见了

> img.title = obj.firstChild.getAttribute("title");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:07:47.007

我相信他的意思是这样的

```
<div id="m1" class="drag"; style="position:absolute; left:0px; top:0px; width:32px; height:32px;"><img title="CARS" src="http://mapicons.nicolasmollet.com/wp-content/uploads/mapicons/shape-default/color-ff8a22/shapecolor-color/shadow-1/border-dark/symbolstyle-white/symbolshadowstyle-dark/gradient-no/sportscar.png" width="32" height="32" alt="" /></div> 
```

我将标题属性从 div 移动到图像。

# html - SAP UI5：IE 中的对象预期错误

> ID：10121361
> 
> 赞同：-1
> 
> 时间：2012-04-12T09:59:14.190
> 
> 标签：html, internet-explorer, sapui5

我正在使用 SAP UI5，但不知道为什么`object expected`在 ie 中运行 index.html 文件时它会显示在第 347 行。

```
 <html>
       <head>
              <meta content="IE=edge" http-equiv="X-UA-Compatible">

              <script src="resources/sap-ui-core.js"
                      type="text/javascript"
                      id="sap-ui-bootstrap"
                      data-sap-ui-libs="sap.ui.commons,sap.ui.ux3"
                      data-sap-ui-theme="sap_goldreflection" >
              </script>

<script type="text/javascript" src="OPM_CM.js"></script>
              <script>
                     sap.ui.localResources("opm");
                     var view = sap.ui.view({id:"OPM_CM1", viewName:"opm.OPM_CM", type:sap.ui.core.mvc.ViewType.JS});
                     //view.placeAt("content");

                     buildShell();
              </script>

       </head>
       <body class="sapUiBody" role="application">
              <div id="content"></div>
       </body>
</html> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T05:43:10.600

这可能是因为 sap 对象不可用。

```
<script>
     function init(){
            sap.ui.localResources("opm");
                 var view = sap.ui.view({id:"OPM_CM1", viewName:"opm.OPM_CM", type:sap.ui.core.mvc.ViewType.JS});
                 //view.placeAt("content");

                 buildShell();
     }
     window.addEventListener('load',init);
          </script> 
```

将您的代码添加到函数并在正文 onload 上调用它可能会成功。注意：还请提供有关您遇到的错误的更多详细信息。

# android - 在活动android中添加动态输入文本和按钮

> ID：10121363
> 
> 赞同：1
> 
> 时间：2012-04-12T09:59:20.257
> 
> 标签：android, android-layout, dynamic

我有一个带有输入文本的应用程序，用户必须在其中插入信息和旁边的按钮“+”来输入文本。我想让我的表单动态化，当用户按下“+”按钮时，动态显示另一个文本输入和另一个“+”按钮，该过程以相同的方式重复。

我创建了 xml 文件 sample_content：

```
 <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignLeft="@+id/attempt"
                android:layout_alignParentBottom="true"
                android:text="TextView" />

            <Button
                style="?android:attr/buttonStyleSmall"
                android:layout_width="36dp"
                android:layout_height="32dp"
                android:layout_alignParentRight="true"
                android:layout_alignParentTop="true"
                android:layout_marginRight="22dp"
                android:text="+" />

            <EditText
                android:layout_width="229dp"
                android:layout_height="wrap_content"
                android:layout_alignParentTop="true"
                android:layout_marginRight="14dp"
                android:layout_toLeftOf="@+id/addKey"
                android:background="@drawable/inputtext_corner"
                android:ems="10"
                android:textSize="18sp" >

                <requestFocus />

            </EditText>

        </RelativeLayout> 
```

在我的活动中，我放了 AddDeviceActivity：

```
 inflater = LayoutInflater.from(AddDeviceActivity.this);
                Button addKey = (Button) findViewById(R.id.addKey);

                addKey.setOnClickListener(new Button.OnClickListener() {
                    public void onClick(View v) {
                        final RelativeLayout canvas = (RelativeLayout) AddDeviceActivity.this.findViewById(R.id.my_canvas);
                        final View childView = inflater.inflate(R.layout.sample_component, canvas, false);
                        //  TODO: Look up the 5 different signatures of the addView method, 
                        //  and pick that best fits your needs
                        canvas.addView(childView);
                    }
                }); 
```

但是这个解决方案不起作用，因为当我添加第一个输入文本和第一个按钮时，我不知道如何使第二个按钮在我的 AddDeviceActivity 中动态工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:06:33.797

只是想知道你是否可以这样做：

让您的活动实现`OnClickListener`并将此方法添加到您的活动中：

```
public void onClick(View v) {
    final RelativeLayout canvas = (RelativeLayout) AddDeviceActivity.this.findViewById(R.id.my_canvas);
    final View childView = inflater.inflate(R.layout.sample_component, canvas, false);
    canvas.addView(childView);
    ((Button)childView.findViewById(R.id.addKey)).setOnClickListener(AddDeviceActivity.this);
} 
```

然后更改您的初始代码以使用

```
addKey.setOnClickListener(this); 
```

而不是匿名内部类。

我没有对此进行测试，但不明白为什么它不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T11:50:40.217

看看这个，在方法中传递`null`而不是`canvas`对象`inflate()`

```
 addKey.setOnClickListener(new Button.OnClickListener() {
                        public void onClick(View v) {
                            final RelativeLayout canvas = (RelativeLayout) AddDeviceActivity.this.findViewById(R.id.my_canvas);
                            final View childView = inflater.inflate(R.layout.sample_component, null, false);
                            //  TODO: Look up the 5 different signatures of the addView method, 
                            //  and pick that best fits your needs
                            canvas.addView(childView);
                        }
                    }); 
```

# javascript - Javascript Youtube 抓取 XML 数据，想附加到一个 div，不适用于所有版本的 IE

> ID：10121365
> 
> 赞同：1
> 
> 时间：2012-04-12T09:59:26.933
> 
> 标签：javascript, xml, json, youtube, appendchild

这是示例： [http ://www.jackthe7th.com/jts_test.php](http://www.jackthe7th.com/jts_test.php)

发生的事情是我使用 JSON 为播放列表中的每个视频获取 XML 数据，然后尝试将该数据附加到 div。它甚至不需要在除 IE 之外的每个浏览器中将数据附加到 div 中，这包括所有版本的 IE。在 IE 中，它不附加任何内容，并且全部显示在页面顶部。几天来我已经尝试了数百种组合来尝试解决这个问题，不管它在 IE 中没有让步。我知道这有点复杂，但如果有人能提供帮助，那就太好了！

所有代码都是 html 或 javascript，太长，无法在此处发布，因此请检查页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:33:48.187

从 IE 控制台调用`document.getElementsByName('vid_thumb_title')`返回一个长度为零的数组，[每个 w3c 规范名称不是 div 元素上的有效属性，](http://www.w3.org/TR/html4/struct/global.html#edef-DIV)并且 IE javascript 引擎一直非常挑剔，只检查名称是有效属性的元素上的名称。

# c - 用于网络文件处理的 Map reduce 方法

> ID：10121366
> 
> 赞同：2
> 
> 时间：2012-04-12T09:59:27.910
> 
> 标签：c, networking, mapreduce

我有一个非常大的网络捕获文件，其中包含一个特定的整数字段。

```
RECORD 1 : value 987

RECORD 2 : value 878

RECORD 3 : value 823

      ..
      ..
      ..
      ..
      .. 
```

我想扫描网络文件并找到该整数字段的 5 个最流行的值。传统的线性算法方法需要我保存所有唯一的整数字段值和字段值的出现频率。我正在考虑使用 map-减少算法来解决这个问题。

我的`map()`函数将提取整数值并将其存储在数组中。

```
A = [987, 878, 823 ......].Map(x => x,freq(x)) 
```

我的`reduce()`功能将

`freq5 = A.reduce( 0, (x > y) ? x : y)`或类似的东西来找出前 5 个最常见的值。

这种方法有意义吗？

对程序的执行时间会有什么影响。？

# export-to-excel - 从返回超过 23000 行的数据库查询生成 excel 文件时出错

> ID：10121368
> 
> 赞同：0
> 
> 时间：2012-04-12T09:59:33.657
> 
> 标签：export-to-excel

尝试从返回超过 23000 行的数据库查询生成 excel 文件时出现错误。但是对于较少的行数，它会给出正确的 excel 文件。

你能告诉我这种限制是否存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-16T05:23:23.267

要解决您的问题，请提供以下问题的答案。

1.  您的查询的行数是多少？
2.  你得到什么错误？
3.  你用的Excel是哪个版本的？

Excel 2003 有 65536 行的限制，如果您的查询返回的行数超过 65536 行，则使用 E​​xcel 2007（1048576 行）。

# eclipse - 在eclipse中重构时引用被调用者

> ID：10121374
> 
> 赞同：1
> 
> 时间：2012-04-12T09:59:58.303
> 
> 标签：eclipse, refactoring

假设有这样的方法：

```
public int a() {
   return 1 + b();
} 
```

是否可以在 Eclipse 中对表达式应用“引入参数”重构，`b()`以便调用者实际调用被调用者的方法 b？像这样：

```
o.a()         // old
o.a( o.b() )  // new 
```

当我这样做时，它基本上将字符串“b（）”复制并粘贴到调用中，这没有任何意义，因为此方法在被调用者而不是调用者上。但也许你知道一个窍门？

或者，是否可以使用“更改方法签名”重构并在引用被调用者的默认值中使用表达式？这样我就可以创建一个新参数`a()`并让它具有类似的默认值`${this}.b()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:51:15.367

您可以间接执行此操作：

1.  引入间接`o.a()`（调用它`a_tmp`）
2.  重构`a_tmp`从`return o.a()`到`return o.a(o.b())`
3.  排队`a_tmp`

# process - 在 1 个 cpu 上绑定 1 个单个进程并在其他 CPU 上移动所有 IRQ、deamins、rpci

> ID：10121377
> 
> 赞同：2
> 
> 时间：2012-04-12T10:00:12.237
> 
> 标签：process, linux-kernel, scheduled-tasks, affinity

我有一台 16 核的 Linux 机器。

```
// uname -a
Linux lndbxdev01 2.6.24.7-108.el5rt #1 SMP PREEMPT RT 
Mon Mar 23 10:58:10 EDT 2009 x86_64 x86_64 x86_64 GNU/Linux

// OS detail
Red Hat Enterprise Linux Server release 5.3 (Tikanga) 
```

我想安排进程亲和性，以便 1 个 CPU 完全专用于 1 个进程。

当我说完全专用时，我的意思是我真的想将任何其他正在运行的守护进程`IRQ-nnnn, rpciod/nn`等绑定到所有可用的 CPU，除了我的进程感兴趣的那个。（在我的操作系统上，我可以数出大约 500 个进程）。

1.  这样做是安全的还是我应该关心让它们中的一些在它们当前运行的 CPU 上？
2.  如果我至少绑定 IRQ，性能会更好吗？

由于这些连接到经常触发的中断，因此它们会导致频繁的进程上下文切换，因为内核必须调用它们。

我期待以下好处：

1.  因为会有一个进程运行一个 CPU，所以根本不会有进程上下文切换。
2.  在该 CPU 上分配给我的进程的时间片将增加，因此它会在进程上下文切换（如果有）之前运行更长时间。

亲切的问候 AFG

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-22T22:19:42.070

我想 cpusets 可以帮助你克服这个问题。您可以为其中一个 CPU 定义一个独占的 cpuset，并将进程绑定到该特定的 cpuset。

[http://www.kernel.org/doc/man-pages/online/pages/man7/cpuset.7.html](http://www.kernel.org/doc/man-pages/online/pages/man7/cpuset.7.html)

您可能会发现 cset 有用：

[http://code.google.com/p/cpuset/](http://code.google.com/p/cpuset/)

如果您不愿意使用它们中的任何一个，那么您需要编写自己的 c 代码来安排特定 cpu 上的进程（使用 sched_setaffinity）并禁用该特定 cpu 上的所有中断。

我希望它有所帮助。

# linker - Mingw：未定义的参考链接与 boost program_options

> ID：10121381
> 
> 赞同：2
> 
> 时间：2012-04-12T10:00:19.813
> 
> 标签：linker, undefined-reference, mingw-w64

我正在使用 ming64 (gcc 4.5.4)，我的测试程序如下所示：

```
#include <fstream>
#include <map>
#include <set>
#include <string>
#include <boost/program_options.hpp>
#include <boost/program_options/detail/config_file.hpp>

int main()
{
    std::ifstream ifs("");
    std::map<std::string, std::string> parameters;
    std::set<std::string> options;

    for (boost::program_options::detail::config_file_iterator i(ifs, options, true), e; i != e; ++i)
    {
        parameters[i->string_key] = i->value[0];
    }

    return 0;
} 
```

当我编译它时，我得到：

```
Linking CXX executable main.exe
CMakeFiles\main.dir/objects.a(main.cpp.obj): In function `basic_config_file_iterator':
C:/Users/test/Desktop/po/src/include/boost/program_options/detail/config_file.hpp:147: undefined reference to `boost::program_options::detail::common_config_file_iterator::common_config_file_iterator(std::set<std::string, std::less<std::string>, std::allocator<std::string> > const&, bool)'
C:/Users/test/Desktop/po/src/include/boost/program_options/detail/config_file.hpp:150: undefined reference to `boost::program_options::detail::common_config_file_iterator::get()'
CMakeFiles\main.dir/objects.a(main.cpp.obj): In function `boost::eof_iterator<boost::program_options::detail::common_config_file_iterator, boost::program_options::basic_option<char> >::increment()':
C:/Users/test/Desktop/po/src/include/boost/program_options/eof_iterator.hpp:75: undefined reference to `boost::program_options::detail::common_config_file_iterator::get()'
collect2: ld returned 1 exit status
mingw32-make[2]: *** [main.exe] Error 1
mingw32-make[1]: *** [CMakeFiles/main.dir/all] Error 2
mingw32-make: *** [all] Error 2 
```

我与`-Lpath_to_lib`和链接`-llibboost_program_options-mgw45-mt-1_48`。并且有两个文件：

```
libboost_program_options-mgw45-mt-1_48.dll  libboost_program_options-mgw45-mt-1_48.dll.a 
```

nm 为库提供以下输出：

```
$ nm libboost_program_options-mgw45-mt-1_48.dll|grep common_config_file_iterator
000000006395e0a0 d .data$_ZTIN5boost12eof_iteratorINS_15program_options6detail27common_config_file_iteratorENS1_12basic_optionIcEEEE
000000006395e0c0 d .data$_ZTIN5boost15iterator_facadeINS_15program_options6detail27common_config_file_iteratorEKNS1_12basic_optionIcEENS_21forward_traversal_tag
ERS6_xEE
000000006395e440 d .data$_ZTIN5boost15program_options6detail27common_config_file_iteratorE
000000006395f6a0 d .data$_ZTVN5boost15program_options6detail27common_config_file_iteratorE
0000000063962d60 r .rdata$_ZTSN5boost12eof_iteratorINS_15program_options6detail27common_config_file_iteratorENS1_12basic_optionIcEEEE
0000000063962de0 r .rdata$_ZTSN5boost15iterator_facadeINS_15program_options6detail27common_config_file_iteratorEKNS1_12basic_optionIcEENS_21forward_traversal_ta
gERS6_xEE
0000000063963560 r .rdata$_ZTSN5boost15program_options6detail27common_config_file_iteratorE
0000000063933ce0 t .text$_ZN5boost15program_options6detail27common_config_file_iterator7getlineERSs
0000000063933cf0 t .text$_ZN5boost15program_options6detail27common_config_file_iteratorD0Ev
0000000063933ec0 t .text$_ZN5boost15program_options6detail27common_config_file_iteratorD1Ev
0000000063934080 t .text$_ZN5boost15program_options6detail27common_config_file_iteratorD2Ev
00000000639100a0 t _GLOBAL__I__ZN5boost15program_options6detail27common_config_file_iteratorC2ERKSt3setISsSt4lessISsESaISsEEb
000000006390da90 T _ZN5boost15program_options6detail27common_config_file_iterator10add_optionEPKc
000000006390e6d0 T _ZN5boost15program_options6detail27common_config_file_iterator3getEv
             U _ZN5boost15program_options6detail27common_config_file_iterator7getlineERSs
0000000063933ce0 T _ZN5boost15program_options6detail27common_config_file_iterator7getlineERSs
000000006390e3f0 T _ZN5boost15program_options6detail27common_config_file_iteratorC1ERKSt3setISsSt4lessISsESaISsEEb
000000006390e3f0 T _ZN5boost15program_options6detail27common_config_file_iteratorC2ERKSt3setISsSt4lessISsESaISsEEb
             U _ZN5boost15program_options6detail27common_config_file_iteratorD0Ev
0000000063933cf0 T _ZN5boost15program_options6detail27common_config_file_iteratorD0Ev
             U _ZN5boost15program_options6detail27common_config_file_iteratorD1Ev
0000000063933ec0 T _ZN5boost15program_options6detail27common_config_file_iteratorD1Ev
0000000063934080 T _ZN5boost15program_options6detail27common_config_file_iteratorD2Ev
000000006390d900 T _ZNK5boost15program_options6detail27common_config_file_iterator14allowed_optionERKSs
000000006395e0a0 D _ZTIN5boost12eof_iteratorINS_15program_options6detail27common_config_file_iteratorENS1_12basic_optionIcEEEE
000000006395e0c0 D _ZTIN5boost15iterator_facadeINS_15program_options6detail27common_config_file_iteratorEKNS1_12basic_optionIcEENS_21forward_traversal_tagERS6_x
EE
000000006395e440 D _ZTIN5boost15program_options6detail27common_config_file_iteratorE
0000000063962d60 R _ZTSN5boost12eof_iteratorINS_15program_options6detail27common_config_file_iteratorENS1_12basic_optionIcEEEE
0000000063962de0 R _ZTSN5boost15iterator_facadeINS_15program_options6detail27common_config_file_iteratorEKNS1_12basic_optionIcEENS_21forward_traversal_tagERS6_x
EE
0000000063963560 R _ZTSN5boost15program_options6detail27common_config_file_iteratorE
000000006395f6a0 D _ZTVN5boost15program_options6detail27common_config_file_iteratorE 
```

未定义引用的原因是什么（相同的代码在 linux 上工作得很好）？

# xml - 使用 XSLT 递归构建“路径”

> ID：10121387
> 
> 赞同：1
> 
> 时间：2012-04-12T10:00:49.443
> 
> 标签：xml, xslt, recursion

我有一个问题，目前不知道解决它;-(

我有一个类别结构作为输入文档（xml）并且想要构建一个路径结构。我只能使用 xslt 并想生成一个新的 xml 结构。

输入结构如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<Positions>
    <Positionen>
        <ID>1</ID>
        <Parent></Parent>
    </Positionen>

    <Positionen>
        <ID>2</ID>
        <Parent>1</Parent>
    </Positionen>

    <Positionen>
        <ID>3</ID>
        <Parent>1</Parent>
    </Positionen>

    <Positionen>
        <ID>4</ID>
        <Parent>2</Parent>
    </Positionen>

    <Positionen>
        <ID>5</ID>
        <Parent>4</Parent>
    </Positionen>

    <Positionen>
        <ID>6</ID>
        <Parent>2</Parent>
    </Positionen>

</Positions> 
```

输出结构应该是这样的：

```
<?xml version="1.0" encoding="UTF-8"?>
<Positions>
    <Positionen>
        <ID>1</ID>
        <Parent></Parent>
        <Path>1</Path>
    </Positionen>

    <Positionen>
        <ID>2</ID>
        <Parent>1</Parent>
        <Path>1/2</Path>
    </Positionen>

    <Positionen>
        <ID>3</ID>
        <Parent>1</Parent>
        <Path>1/3</Path>
    </Positionen>

    <Positionen>
        <ID>4</ID>
        <Parent>2</Parent>
        <Path>1/2/4</Path>
    </Positionen>

    <Positionen>
        <ID>5</ID>
        <Parent>4</Parent>
        <Path>1/2/4/5</Path>
    </Positionen>

    <Positionen>
        <ID>6</ID>
        <Parent>2</Parent>
        <Path>1/2/6</Path>
    </Positionen>

</Positions> 
```

如何使用带有递归的 xslt 来做到这一点？希望得到一些帮助。提前致谢。罢工

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T12:26:26.403

**这个问题的一些答案很好但效率很低（O（N ^ 2））。**

之所以如此，是因为每个`Positionen`元素的路径都是从头开始构建的。平均路径长度为 N/2，有 N 个`Positionen`元素。这意味着构建所有路径至少需要 N*N/2 次操作——这是二次时间复杂度。

**这是一个更有效的 O(N*log(N)) - 可以是偶数 (O(N) - 线性) 解决方案，以防`Positionen`输出中的元素未排序**是可以接受的：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common" exclude-result-prefixes="ext">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kChildren" match="Positionen" use="Parent"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="/">
  <xsl:variable name="vrtfPass1">
    <xsl:apply-templates select="node()|@*"/>
  </xsl:variable>

  <xsl:variable name="vPass1" select="ext:node-set($vrtfPass1)"/>

  <xsl:apply-templates select="$vPass1/*" mode="pass2"/>
 </xsl:template>

 <xsl:template match="/*">
  <xsl:copy>
    <xsl:apply-templates select="Positionen[not(number(Parent))]" mode="path"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="Positionen" mode="path">
  <xsl:param name="pPath"/>

  <xsl:copy>
    <xsl:apply-templates select="node()|@*"/>
    <Path><xsl:value-of select="concat($pPath, ID)"/></Path>
  </xsl:copy>
  <xsl:apply-templates select="key('kChildren', ID)" mode="path">
   <xsl:with-param name="pPath" select="concat($pPath, ID, '/')"/>
  </xsl:apply-templates>
 </xsl:template>

 <xsl:template match="/*" mode="pass2">
  <xsl:copy>
       <xsl:apply-templates select="node()|@*">
         <xsl:sort select="ID" data-type="number"/>
       </xsl:apply-templates>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**：

```
<Positions>
    <Positionen>
        <ID>1</ID>
        <Parent></Parent>
    </Positionen>
    <Positionen>
        <ID>2</ID>
        <Parent>1</Parent>
    </Positionen>
    <Positionen>
        <ID>3</ID>
        <Parent>1</Parent>
    </Positionen>
    <Positionen>
        <ID>4</ID>
        <Parent>2</Parent>
    </Positionen>
    <Positionen>
        <ID>5</ID>
        <Parent>4</Parent>
    </Positionen>
    <Positionen>
        <ID>6</ID>
        <Parent>2</Parent>
    </Positionen>
</Positions> 
```

**产生了想要的正确结果：**

```
<Positions>
   <Positionen>
      <ID>1</ID>
      <Parent/>
      <Path>1</Path>
   </Positionen>
   <Positionen>
      <ID>2</ID>
      <Parent>1</Parent>
      <Path>1/2</Path>
   </Positionen>
   <Positionen>
      <ID>3</ID>
      <Parent>1</Parent>
      <Path>1/3</Path>
   </Positionen>
   <Positionen>
      <ID>4</ID>
      <Parent>2</Parent>
      <Path>1/2/4</Path>
   </Positionen>
   <Positionen>
      <ID>5</ID>
      <Parent>4</Parent>
      <Path>1/2/4/5</Path>
   </Positionen>
   <Positionen>
      <ID>6</ID>
      <Parent>2</Parent>
      <Path>1/2/6</Path>
   </Positionen>
</Positions> 
```

**请注意**：

每个路径都是通过将当前`ID`路径添加到父路径（仅计算一次）产生的——一个 O(1) 操作。总共有 N 条路径，这是 O(N)。

最后的排序使得时间复杂度 O(N*log(N)) - 仍然比二次的好得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T11:19:24.430

试试这个 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:key name="Pos" match="Positionen" use="ID" />

   <!-- Match Positionen elements normally -->
   <xsl:template match="Positionen">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
         <Path>
            <!-- Get parent path -->
            <xsl:apply-templates select="key('Pos', Parent)" mode="parent" />
            <!-- End of path -->
            <xsl:value-of select="ID" />
         </Path>
      </xsl:copy>
   </xsl:template>

   <!-- Template used to recursively match parents -->
   <xsl:template match="Positionen" mode="parent">
      <xsl:apply-templates select="key('Pos', Parent)" mode="parent" />
      <xsl:value-of select="concat(ID, '/')" />
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

这首先正常匹配**Positionen**元素，然后根据**Parent**值递归匹配父元素。请注意，它还使用**xsl:key通过****ID**更快地查找元素。

当应用于您的示例 XML 时，将输出以下内容：

```
<Positions>
   <Positionen>
      <ID>1</ID>
      <Parent/>
      <Path>1</Path>
   </Positionen>
   <Positionen>
      <ID>2</ID>
      <Parent>1</Parent>
      <Path>1/2</Path>
   </Positionen>
   <Positionen>
      <ID>3</ID>
      <Parent>1</Parent>
      <Path>1/3</Path>
   </Positionen>
   <Positionen>
      <ID>4</ID>
      <Parent>2</Parent>
      <Path>1/2/4</Path>
   </Positionen>
   <Positionen>
      <ID>5</ID>
      <Parent>4</Parent>
      <Path>1/2/4/5</Path>
   </Positionen>
   <Positionen>
      <ID>6</ID>
      <Parent>2</Parent>
      <Path>1/2/6</Path>
   </Positionen>
</Positions> 
```

# ios - 从核心数据发送电子邮件

> ID：10121393
> 
> 赞同：0
> 
> 时间：2012-04-12T10:01:13.340
> 
> 标签：ios

我想创建一个类似 CoreDataBooks 示例[http://developer.apple.com/library/ios/#samplecode/CoreDataBooks/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/CoreDataBooks/Introduction/Intro.html)的应用程序。我的想法是，在将数据填充到字段后发送一封包含这些新数据的电子邮件。这可能吗？我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:06:07.290

只有使用 Web 服务才能在**后台**发送邮件。您可以在虚拟主机上安装一些 php 脚本，...而不是您拥有 Web 服务。然后，您可以`NSMutableURLRequest`使用`NSURLConnection`.

如果你想用内部邮件框架（MFMailComposeViewController）在前面发送邮件，你应该看[这里](http://www.iostipsandtricks.com/using-apples-mail-composer/)。

# android - android切换按钮状态设置texview文本

> ID：10121394
> 
> 赞同：1
> 
> 时间：2012-04-12T10:01:16.307
> 
> 标签：android, textview, togglebutton

我有一个切换按钮，当设置为 on 位置时，将提示设置为我的 textview 之一

> “公斤”

. 文本视图的初始提示是

> “英石”

如果拨动开关处于关闭位置，则应显示。

当我第一次启动应用程序时，textview 显示

> “英石”

（起初可以，因为切换开关处于关闭位置）现在当我按下切换开关时，它会转到打开位置并显示

> “公斤”

在 textView 中（这也可以。）

现在问题来了。如果我再次单击切换（关闭位置），则 textView 保持为

> “公斤”

有谁知道我如何将其设置为始终在关闭状态下显示“st”，在打开状态下始终显示“kg”。

提前谢谢了

```
addListenerOnButton();

      }

      public void addListenerOnButton() {

        unitToggle = (Button) findViewById(R.id.unitToggle);
       final TextView tw1 = (TextView)findViewById(R.id.tw1);

        unitToggle.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

               StringBuffer result = new StringBuffer();
               tw1.setHint("kg"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:14:19.880

```
 unitToggle.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

           StringBuffer result = new StringBuffer();
           if(tw1.getHint().toString().equals("kg"))
                tw1.setHint("st");             
           else
                tw1.setHint("kg"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:15:46.927

造成上述问题的主要原因是尚未实现的逻辑。

当您第一次单击该按钮时，它将文本设置为“kg”，它将始终在任何次数的单击时设置。既然你已经写了声明

***tw1.setHint("公斤");***

在您的 onClick() 方法中，而不保留按钮的状态。*强调文字*。

为了使其正确，请使用布尔标志并在每次单击时更改其状态并根据标志值设置文本。

最好的方法是使用具有内置开/关状态的 ToggleButton，因此您不需要使用 on 布尔标志并根据按钮状态设置提示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:16:15.580

尝试

```
private boolean on=false;

 unitToggle.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

           StringBuffer result = new StringBuffer();
           if(on){
                tw1.setHint("kg");
                on = true;
           }else{
               tw1.setHint("st");
               on = false;
           } 
```

# c++ - 由于缺少头文件而导致的段错误

> ID：10121401
> 
> 赞同：0
> 
> 时间：2012-04-12T10:01:33.283
> 
> 标签：c++, linux, g++, shared-libraries

在构建共享对象时，我忘记将第 3 方“仅标头”库标头 (.h) 文件放入正确的路径中。它建造得很好——回顾起来令人惊讶。

在我的共享对象中使用该第 3 方库时，在运行时恰好发生了段错误。

我不明白的部分是当我将这些头文件复制到用 指定的路径时`#include`，我无法导致段错误。我什至没有重新构建对象。非常奇怪的是，当我 mv 头文件所在的目录时，它仍然有效 - 没有段错误。但是，当我完全 rm 目录时，它崩溃了。它是否查找当前目录和子目录的头文件？我在标准中也有那个只有标题的库（？）`/usr/local/include`

我以前没有使用过共享对象。我通常创建静态对象并将它们包含在构建中。我用来创建有问题的共享对象的标志是`-shared -fPIC`

我想了解这种行为。由于部署，这很有趣。在生产机器上部署时是否需要包含这些头文件？本质上，我不想将其作为依赖项，因为它是“仅标头”库。

**编辑**

代码：

```
#include <rapidjson/document.h>
#include <rapidjson/writer.h>
#include <rapidjson/stringbuffer.h>

void MyClass::myFunction()
{
    rapidjson::StringBuffer string;
    rapidjson::Writer<rapidjson::StringBuffer> jsonWriter(string);
} 
```

这是调试会话的链接：http: [//pastebin.com/a0FaQwf1](http://pastebin.com/a0FaQwf1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:09:39.980

为了运行程序，您永远不需要向用户提供头文件。

您的库可能只是优化了默认值，这就是为什么它在编译时丢失时不会失败的原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:35:52.377

对奇怪的移动/删除行为的解释可能是共享对象在移动过程中仍被加载到内存中，并保留了包含目录中某些内容的打开文件句柄。

你知道，在 ext2/3/4 下打开的文件连接到 inode 而不是 dir 路径。因此移动打开的文件不会造成伤害。另一方面，IIRC 也删除不会造成伤害。inode 的释放将被延迟，直到所有进程都关闭了文件。也许这只是发生在你的 mv 和 rm 之间。

# refresh - 在拆分视图应用程序（钛）中刷新主窗口

> ID：10121402
> 
> 赞同：0
> 
> 时间：2012-04-12T10:01:46.013
> 
> 标签：refresh, titanium-mobile, uisplitview

我正在为 iPad 做一个 Splitview 应用程序，每次用户单击一个按钮（此按钮在 master_window 但在另一个 JavaScript 文件中）时，我都必须刷新我的 tableview（即在我的主窗口中）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T06:33:58.557

`MASTERWINDOW FILE`在你说的里面创建一个函数

```
function updateTable(){ // update your table here}; 
```

现在，在你里面`App.js file`，包括你的`MASTERWINDOW FILE`

并这样做：

```
Ti.App.updateTable= updateTable; 
```

`Ti.App`将使您的函数全局化，以便您可以从应用程序的任何位置调用它。您可以在按钮单击事件中调用它。

# sql - GROUP BY 子句中的 SQL 地理数据类型列

> ID：10121403
> 
> 赞同：5
> 
> 时间：2012-04-12T10:01:52.597
> 
> 标签：sql, sql-server, tsql, group-by, sqlgeography

我正在使用 SQL Server 并创建一个脚本，该脚本将从我的数据库中获取工作人员的地理位置。脚本如下。

```
SELECT w.display_name, w.geo_location
FROM jobs j WITH(NOLOCK)
INNER JOIN workers w WITH(NOLOCK) ON w.worker_id = j.worker_id
WHERE ..... 
```

问题是我想添加`GROUP BY w.display_name, w.geo_location`到脚本中，因为显示了重复的记录。将数据类型为 geography 的列添加到 group by 子句会导致引发错误。

当我添加它时抛出的错误是：

> “地理”类型没有可比性。它不能在 GROUP BY 子句中使用。

有没有解决的办法？我无法转换`w.geo_location`为`VARCHAR`地理数据类型中需要的 a 。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-10-14T13:56:58.617

如果您想继续使用 group by 语法，您可以将 geo 列转换为文本并再次返回：

```
SELECT w.display_name, geography::STGeomFromText(w.geo_location.STAsText(), 4326) as Location
FROM jobs j WITH(NOLOCK)
INNER JOIN workers w WITH(NOLOCK) ON w.worker_id = j.worker_id
WHERE .....
GROUP BY w.display_name, w.geo_location.STAsText() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-12T11:09:40.253

你可以使用`row_number()`这样的东西。

```
declare @g geography;
set @g = geography::STGeomFromText('LINESTRING(-122.360 47.656, -122.343 47.656)', 4326);

declare @T table
(display_name varchar(10), geo_location geography)

insert into @T values ('1', @g)
insert into @T values ('1', @g)
insert into @T values ('1', @g)

insert into @T values ('2', @g)
insert into @T values ('2', @g)

select display_name, geo_location
from 
  (
    select *,
           row_number() over(partition by display_name, geo_location.ToString() order by (select 0)) as rn
    from @T
  ) as T
where rn = 1 
```

结果：

```
display_name geo_location
------------ --------------------------------------------------------------------------------
1            0xE610000001148716D9CEF7D34740D7A3703D0A975EC08716D9CEF7D34740CBA145B6F3955EC0
2            0xE610000001148716D9CEF7D34740D7A3703D0A975EC08716D9CEF7D34740CBA145B6F3955EC0 
```

# javascript - JQuery droppable() 无法识别“this”对象引用

> ID：10121406
> 
> 赞同：1
> 
> 时间：2012-04-12T10:02:02.637
> 
> 标签：javascript, jquery, object, droppable

我有一个像这样的对象：

```
function ImageHolder(Attributes, Parent)
{
    this.Id = Attributes['Id'];
    this.Parent = Parent;

    this.Element = $('<div/>');

        this.msg = "hello world";

    this.Parent.append(this.Element);

    this.handleDrop = function(e, ui)
    {
        alert(this.msg);

    };

    this.Element.droppable({drop: this.handleDrop});
} 
```

然后我创建一个像这样的对象：

```
holder = new ImageHolder(A,B); 
```

但是当我尝试将一些东西放到元素上时，我收到了这个错误：

```
this.msg is undefined 
```

我在这里做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:05:28.070

复印一份；

```
var thisCopy = this; 
```

在以下功能之前，然后像这样替换......

```
this.handleDrop = function(e, ui)
{
    alert(thisCopy.msg);

}; 
```

# android - 如何在 Android 上的 PayPal 中实现延迟链式付款

> ID：10121407
> 
> 赞同：0
> 
> 时间：2012-04-12T10:02:07.600
> 
> 标签：android, paypal, paypal-adaptive-payments

谁能告诉我如何在 android 应用程序中实现 PayPal 的延迟链式付款。我正在为 android PayPal_MPL_1.5.5.44_Android-Developer-Package 使用最新版本的 sdk。我在这个 sdk 中没有发现任何关于延迟付款的提及。关于自适应支付文档，我们应该为此指定 actionType="PAY_PRIMARY"。但是我没有发现这样的能力。

我已经在应用程序中实现了连锁支付，但目前资金会立即从主要收款人发送到次要收款人，没有任何延迟。

是否可以使用 sdk for android 实现这样的功能？

将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T15:24:58.713

得到了支持的答复。

> 不，无法使用 Android SDK 包提交延迟链式付款，因为没有方法可以让您这样做。确认的形式是 SDK 中没有任何方法可以将支付类型设置为“PAY_PRIMARY”，也没有方法执行链的第二条腿

# php - My SQL 数据库中的表名列表

> ID：10121411
> 
> 赞同：0
> 
> 时间：2012-04-12T10:02:24.540
> 
> 标签：php, mysql

任何人都可以帮助我如何显示数据库中的表名列表吗？我尝试了（从选项卡中选择 *）查询。但它不起作用。请帮助我...我需要使用 My SQL 进行查询...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:03:42.813

首先使用该数据库，`use mydatabase;` 然后使用列出表`show tables;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:12:49.547

或者更基于标准的方法 -

```
SELECT TABLE_NAME
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = 'db_name' 
```

[INFORMATION_SCHEMA.TABLES](http://dev.mysql.com/doc/refman/5.5/en/tables-table.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:39:55.553

用这个-

```
show tables; 
```

但是，如果您以前使用的是不同的数据库，那么使用-

```
use database_name; 
```

然后使用 `show tables;`

# jquery - 我可以在jsp中提醒struts2属性标签吗？

> ID：10121412
> 
> 赞同：1
> 
> 时间：2012-04-12T10:02:33.747
> 
> 标签：jquery, jsp, struts2

如上所述的问题，无论如何我可以在jsp中使用alert（）吗？我尝试这样做，但我的 jquery 失败了。

这是我尝试过的：

```
alert(<s:property value='fab'/>); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:18:00.137

您缺少引号：

```
alert("<s:property value='fab'/>"); 
```

...如果你想像 Dave Newton 所说的那样逃避 JavaScript，你应该这样做：

```
alert("<s:property value='fab' escapeJavaScript='true'/>"); 
```

[您可以在此处](http://struts.apache.org/2.1.8/docs/property.html)`property`找到有关标签的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:23:22.930

警报函数需要提供一个有效的 javascript 对象，这样才能发出警报。

最常见的是，至少在我的情况下，这将是一个字符串对象，您可以这样做......

```
alert("My Text"); 
```

或者，您可以警告一个对象，例如整数...

```
alert(1); 
```

或对对象的引用...

```
var myObject = {};
alert(myObject); 
```

* * *

在您的情况下，也许您想尝试如下警告字符串...

```
alert("<s:property value='fab'/>"); 
```

...注意使用引号将值括起来，这告诉 javascript 解析器它应该被视为一个字符串。

# iphone - SQL LITE 中的 XCODE 4.3.2 如何编写“LIKE”关键字

> ID：10121417
> 
> 赞同：-1
> 
> 时间：2012-04-12T10:02:51.580
> 
> 标签：iphone

Iphone 目前我正在写这样的查询

rs=[db executeQuery:@"SELECT * from FormData where flgActive=1 and FirstName like ?", filtercondition];

上面的这个查询只在我们写全名时显示数据。

我想如果“a”像关键字，那么所有带有“a”的名称都应该获取数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:15:59.570

```
 NSString *searchfilter = [NSString stringWithFormat:@"%@*",@"a"];
strValue = [NSString stringWithFormat:@"SELECT * FROM YuurTable where FirstName like[c] %@", searchfilter]; 
```

你也可以在条件中直接使用“a”，

* * *

这些底线可能不适用于你

```
 const char *sql = [strValue UTF8String];

    NSString *requireddata=[NSString stringWithUTF8String:(char *)sqlite3_column_text(selectAllStmt, 3)]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:52:01.827

试试这个查询，

```
 NSString stringWithFormat:@"SELECT * from FormData where flgActive=1 and FirstName like %@%%",prefixString]; 
```

# css - Google 字体无法在 Google Chrome 中正确显示

> ID：10121419
> 
> 赞同：1
> 
> 时间：2012-04-12T10:03:01.160
> 
> 标签：css, google-chrome, fonts

我正在使用 Google 字体“Righteous”，这在我的 Mac 和 PC 上的每个浏览器上都显示得很好。然而，我的客户注意到，在他的 Google Chrome 副本上，字体以一种非常奇怪的方式显示，请看截图：

![在此处输入图像描述](../Images/86071312e0b520f1182c9e7b699bebad.png)

有人知道是什么原因造成的吗？是浏览器问题还是可以在代码或 CSS 中纠正的问题？

CSS 非常基础：

```
h1, h2, h3, h4 { font-weight:normal; font-family: 'Righteous', cursive; } 
```

正如我所说，在我的 Chrome 版本中它很好！非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T13:58:27.050

用户可能在他/她的系统上有一个字体被称为`Righteous`干扰，但我不确定这种可能性有多大。除非我是盲人，否则你还没有发布它的链接，所以我不能发表太多评论。作为对关于 chrome 控制台的@kubedan 的回应，这并不意味着什么，只是 chrome 抱怨谷歌没有`HTTP Headers`用字体发回权利。

# iphone - iCarousel 从右到左滚动从左到右移动

> ID：10121429
> 
> 赞同：3
> 
> 时间：2012-04-12T10:03:28.007
> 
> 标签：iphone, ios, ipad, icarousel

我将 iCarousel 用于我的 ipad 应用程序，轮播类型为 iCarouselTypeLinear。在从右到左滚动时，它正在从左到右移动。

请帮我解决这个问题。

# jquery - jQuery Cycle 插件动画非常生涩

> ID：10121430
> 
> 赞同：1
> 
> 时间：2012-04-12T10:03:29.053
> 
> 标签：jquery, jquery-ui, jquery-animate, jquery-cycle

我只是使用 jQuery Cycle 构建了一个不错的滑块：http: [//pxl.development.krout.nl/websitesnederland/](http://pxl.development.krout.nl/websitesnederland/)

现在我正在尝试将该滑块集成到我们的网站[http://pxl.development.krout.nl/](http://pxl.development.krout.nl/)中，但我无法让它像示例一样顺利运行。

我尝试了很多东西，但如果不生涩，我就无法让它工作。

有人知道解决方案吗？那很好啊！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:31:24.750

如果您看到工作示例包含这些内容

```
 <script src="js/jquery-ui-min.js"></script>
    <script src="js/jquery.cycle.all.min.js"></script>
    <script src="js/script.js"></script> 
```

除了 jquery.min.js

因此，在您的网站中，您更改了文件名并修改了代码？？

因为在您的站点中包含不同的文件

```
 <script type="text/javascript" src="http://pxl.development.krout.nl/templates/js/library.js"></script>
    <script type="text/javascript" src="http://pxl.development.krout.nl/templates/js/slider.js"></script> 
```

你明白我的意思吗？

**更新**

尝试这样做，在你的slider.js中，第17到25行替换为这个

```
 if(bForward == true || bForward == 1) {
                $(oNext).animate({
                    'left': $(window).width()+'px'
                });
            } else {
                $(oNext).animate({
                    'left': '-'+$(window).width()+'px'
                });
            } 
```

# android - 应用程序如何在用户的主屏幕上显示横幅广告？

> ID：10121436
> 
> 赞同：1
> 
> 时间：2012-04-12T10:03:48.147
> 
> 标签：android, exploit

我手机上的一个应用程序在手机闲置一段时间后在我的主屏幕上显示横幅广告。触摸广告外部会隐藏 AdView。看看下面的照片：

![一只忙碌的猫](../Images/e468e7c26baddb96489fb867ad37ab1b.png)

我不确定哪个特定的应用程序是原因。开发商是如何做到这一点的？他如何将 AdView 添加到主屏幕？

安卓 2.3

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:08:08.163

这可能是后台服务在后台运行的原因，因此您在主屏幕中查看添加。请查看以下文档[Android 后台服务](https://stackoverflow.com/questions/7159604/android-background-service) 和 [http://developer.android.com/reference/android/app/Service.html](http://developer.android.com/reference/android/app/Service.html)

# actionscript-3 - 在 as3 中补间停止下一个补间发生，直到最后一个补间完成

> ID：10121439
> 
> 赞同：0
> 
> 时间：2012-04-12T10:03:53.983
> 
> 标签：actionscript-3

如何停止下一个补间动作开始，直到前一个补间完成在 as3.0 中播放？

而且我想阻止补间在同一个对象上发生两次。

基本上我有一个容器（电影剪辑），其中有 n 个电影剪辑（排列为砖）。当我单击容器时，目标（砖）将消失（将 scaleX 和 alpha 设为“o”）。我也在跟踪关闭了多少砖。

但问题是，如果我快速双击，补间似乎会发生两次。对于同一块砖，计数似乎也增加了。如何解决这个问题呢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T12:44:58.820

**补间后补间**

使用事件处理程序等待第一个补间完成，例如

```
myTween.addEventListener(TweenEvent.MOTION_FINISH, onFinish);

function onFinish(e:TweenEvent):void {

         ... // Call the next tween here

} 
```

* * *

**双击问题**，

单击按钮后立即删除按钮单击的事件侦听器，例如：

```
my_btn.addEventListener(MouseEvent.CLICK, onClick);

function onClick(e:MouseEvent){

        my_btn.removeEventListener(MouseEvent.CLICK, onClick);

        myTween.start();

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T19:08:55.647

您使用 Tweener 的任何原因。如今，Greensock 的 Tweenmax/lite 软件包似乎已成为行业标准。

您似乎遇到的问题是您多次启动补间。如果所有块都需要同时收缩，我可能会使用 for 循环并在每个块上运行补间。

但是，您必须确保的是，一旦单击它就可以删除单击事件处理程序，直到它完成，这样就不会再次单击它。

我还建议使用 TweenMax/Lite，因为它有一个叫做 TimelineMax/Lite 的东西，您可以在其中复合一堆补间，无论是同时还是交错，并在该 Timeline 对象上侦听一个 COMPLETE 事件。当该事件触发时，您可以重新激活点击或在动画完成后执行您需要执行的任何操作。

TimelineMax 具有一些不错的功能，例如 reverse 和 timeScale。

你能粘贴一些代码吗？这也将帮助我们帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T12:55:51.017

您可以使用[Tweener](http://code.google.com/p/tweener/)并使用

`isTweening()`或`autoOverwrite = false`解决这个问题。

我已经有一段时间没有使用这些属性/函数了，但我确信 Tweener 中的某些东西可以轻松做到这一点。

# ruby - 如何手动构建 AST？

> ID：10121444
> 
> 赞同：9
> 
> 时间：2012-04-12T10:04:23.357
> 
> 标签：ruby, parsing, abstract-syntax-tree, lexer, ll

我目前正在学习解析，但我对如何生成 AST 有点困惑。我编写了一个解析器，可以正确验证表达式是否符合语法（当表达式符合时它是沉默的，当它不符合时会引发异常）。我该从哪里开始构建 AST？我发现了很多关于构建我的 LL(1) 解析器的信息，但在构建 AST 方面却很少。

我当前的代码（用非常简单的 Ruby 编写，包括词法分析器和解析器）可以在 github 上找到：[https ://gist.github.com/e9d4081b7d3409e30a57](https://gist.github.com/e9d4081b7d3409e30a57)

有人能解释一下我是如何从目前拥有的东西变成 AST 的吗？

或者，如果您不熟悉 Ruby，但知道 C，您能否告诉我如何在[递归下降解析](http://en.wikipedia.org/wiki/Recursive_descent_parser)维基百科文章中为 C 代码构建 AST。

请注意，我不想使用像 yacc 或 antlr 这样的解析器生成器来为我完成工作，我想从头开始做所有事情。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T12:40:47.087

您需要将匹配的每个符号与构造树的那一小部分的回调相关联。例如，让我们采用一个相当常见的构造：嵌套函数调用。

```
a(b()) 
```

您在此处的终端令牌类似于：

*   L_PAREN = '('
*   R_PAREN = ')'
*   标识符 = [az]+

您的非终结符号类似于：

*   FUNCTION_CALL = 标识符、L_PAREN、R_PAREN
*   或者;
*   FUNCTION_CALL = 标识符，L_PAREN，FUNCTION_CALL，R_PAREN

显然，上述规则的第二种选择`FUNCTION_CALL`是递归的。

您已经有一个解析器知道它找到了一个有效的符号。您缺少的一点是将回调附加到规则，该规则接收其组件作为输入并返回一个值（通常）表示 AST 中的该节点。

想象一下，如果我们上面的规则中的第一个替代方案`FUNCTION_CALL`有一个回调：

```
Proc.new do |id_tok, l_paren_tok, r_paren_tok|
  { item: :function_call, name: id_tok, args: [] }
end 
```

这意味着匹配产生的 AST：

```
a() 
```

将会：

```
{
  item: :function_call,
  name: "a",
  args: []
} 
```

现在将其推断为更复杂的`a(b())`. 因为解析器是递归的，它会识别第`b()`一个，回调函数返回我们上面的内容，但使用“b”而不是“a”。

现在让我们定义附加到与第二种选择匹配的规则的回调。它非常相似，除了它还处理它传递的参数：

```
Proc.new do |id_tok, l_paren_tok, func_call_item, r_paren_tok|
  { item: :function_call, name: id_tok, args: [ func_call_item ] }
end 
```

因为解析器已经识别`b()`并且 AST 的那部分是从您的回调中返回的，所以现在生成的树是：

```
{
  item: :function_call,
  name: "a",
  args: [
    {
      item: :function_call,
      name: "b",
      args: []
    }
  ]
} 
```

希望这能给你一些思考的食物。将您匹配的所有标记传递到构造非常小的 AST 部分的例程中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T05:46:00.467

好的，所以我又来了（不，这个答案与 Scintilla 本身无关；虽然它曾经是我的编程语言/编译器设计冒险的一部分）。

你考虑过使用[**Lex**](http://en.wikipedia.org/wiki/Lex_%28software%29) / [**Yacc**](http://en.wikipedia.org/wiki/Yacc)吗？这就是它们存在的主要原因（= 解析；编写 Lexers 和 Parsers，因此是构建`AST`s 的方式），而且它们绝对是 C 友好的。

* * *

这是一个粗略的例子（取自我自己的开源[MathMachine](http://sourceforge.net/projects/mathmachine/)编译器）。

**mm_lexer.l**（词法分析器）

```
%{
/*
MathMachine
Copyright (C) 2009-2011 Dr.Kameleon

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>
*//*

MM_LEXER.L

*/

#include "mathmachine.h"

#include <stdio.h>
#include "y.tab.h"

void count();
%}

DIGIT           [0-9]
LETTER          [a-zA-Z_]
HEX         [a-fA-F0-9]
BINARY          [0-1]

%%
^[ \t]*"//".*\n             { /* This is a '//' single-line comment */ }
^[ \t]*"#!".*\n             { /* This is a '#!' single-line comment */ }
"use"                   { count(); return(USE); }
"set"                   { count(); return(SET); }
"let"                   { count(); return(LET); }
"ret"                   { count(); return(RET); }
"put"                   { count(); return(PUT); }
"get"                   { count(); return(GET); }
"if"                    { count(); return(IF); }
"else"                  { count(); return(ELSE); }
"loop"                  { count(); return(LOOP); }
"save"                  { count(); return(SAVE); }
"exec"                  { count(); return(EXEC); }

"true"                  { count(); return(TRUE); }
"false"                 { count(); return(FALSE); }

{LETTER}({LETTER}|{DIGIT})*     { count(); return(ID); }

{DIGIT}+                { count(); return(DECIMAL);     /* DECIMAL NUMBER */}
0"h"{HEX}+              { count(); return(HEXADECIMAL); /* HEXADECIMAL NUMBER */}
0"b"{BINARY}+               { count(); return(BINARY);  /* BINARY NUMBER */}  
{DIGIT}+"."{DIGIT}+         { count(); return(REAL);    /* REAL NUMBER */}

\"(\\.|[^\\"])*\"           { count(); return(STRING); }

"=="                    { count(); return(EQ_OP); }
"<="                    { count(); return(LE_OP); }
">="                    { count(); return(GE_OP); }
"<"                 { count(); return(LT_OP); }
">"                 { count(); return(GT_OP); }
"!="                    { count(); return(NE_OP); }

"-->"                   { count(); return(RANGE); }

"("                 { count(); return('('); }
")"                 { count(); return(')'); }
"{"                 { count(); return('{'); }
"}"                 { count(); return('}'); }
"["                 { count(); return('['); }
"]"                 { count(); return(']'); }

"-"                 { count(); return('-'); }
"+"                 { count(); return('+'); }
"*"                 { count(); return('*'); }
"/"                 { count(); return('/'); }

"="                 { count(); return('='); }
";"                 { count(); return(';'); }
","                 { count(); return(','); }
":"                 { count(); return(':'); }
"."                 { count(); return('.'); }
"?"                 { count(); return('?'); }
"%"                 { count(); return('%'); }
"&"                 { count(); return('&'); }
"$"                 { count(); return('$'); }
"#"                 { count(); return('#'); }
"@"                 { count(); return('@'); }
"|"                 { count(); return('|'); }
"!"                 { count(); return('!'); }
"~"                 { count(); return('~'); }
"^"                 { count(); return('^'); }

[ \t\v\n\f]             { count(); }
.                   { /* ignore it */ } 

%%

int yycolumn = 0;

void count()
{
    int i;

    for (i = 0; yytext[i] != '\0'; i++)
        if (yytext[i] == '\n')
            yycolumn = 0;
        else if (yytext[i] == '\t')
            yycolumn += 8 - (yycolumn % 8);
        else
            yycolumn++;

    // ECHO;
    yylval.str=strdup(yytext);
} 
```

* * *

**mm_parser.y**（解析器）

```
%{
/*
MathMachine
Copyright (C) 2009-2011 Dr.Kameleon

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>
*//*

MM_PARSER.Y

*/

#include "mathmachine.h"
#include <stdio.h>
#include <string.h>

void yyerror(const char *str)
{
    fflush(stdout);
    printf("\n%*s\n%*s\n", yycolumn, "^", yycolumn, str);
}

int yywrap()
{
    return 1;
}
%}

%union 
{
    char* str;
    mm_st_exec*         _st_exec;
    mm_st_use*          _st_use;
    mm_st_set*          _st_set;
    mm_st_ret*          _st_ret;
    mm_st_let*          _st_let;
    mm_st_get*          _st_get;
    mm_st_loop*             _st_loop;
    mm_st_if*           _st_if;
    mm_st_put*          _st_put;
    mm_st_save*         _st_save;
    mm_condition*           _condition;
    mm_argument*            _argument;
    mm_function_call*       _function_call;
    mm_expression_node*     _expression_node;
    mm_statement*           _statement;
    mm_statement_list*      _statement_list;
    mm_expression_list*     _expression_list;
    mm_id_list*         _id_list;
    comparison_operator_type    _comparison_op_type;
}

%token <str> SET LET PUT GET IF ELSE LOOP USE SAVE LOAD TIME RET EXEC
%token <str> ID DECIMAL HEXADECIMAL BINARY REAL STRING
%token <str> EQ_OP LE_OP GE_OP LT_OP GT_OP NE_OP RANGE
%token <str> TRUE FALSE

%type <str> number boolean 

%type <_comparison_op_type> comparison_operator

%type <_function_call> function_call

%type <_id_list> id_list

%type <_condition> condition
%type <_argument> argument

%type <_expression_node> expression

%type <_expression_list> expression_list

%type <_st_exec> exec_statement
%type <_st_use> use_statement
%type <_st_ret> ret_statement
%type <_st_let> let_statement
%type <_st_get> get_statement
%type <_st_loop> loop_statement
%type <_st_if> if_statement
%type <_st_put> put_statement
%type <_st_set> set_statement
%type <_st_save> save_statement

%type <_statement> statement

%type <_statement_list> statement_list block main

%left '+' '-'
%left '*' '/' '%'
%nonassoc UMINUS

%expect 11

%start main

%%

//---------------------------
// The Basic Elements
//---------------------------

number
    :   DECIMAL     { $$ = $1; }                
    |   HEXADECIMAL { $$ = $1; }            
    |   BINARY      { $$ = $1; }            
    |   REAL        { $$ = $1; }            
    ;

boolean
    :   TRUE        { $$ = $1; }
    |   FALSE       { $$ = $1; }
    ;

function_call
    :   ID '(' ')'          { $$ = new mm_function_call($1,NULL); }
    |   ID '(' expression_list ')'  { $$ = new mm_function_call($1,$3); }
    ;

argument
    :   number      { $$ = new mm_argument($1,number); }
    |   STRING      { $$ = new mm_argument($1,alpha); }
    |   boolean     { $$ = new mm_argument($1,boolean); }
    |   function_call   { $$ = new mm_argument($1,function); }
    |   ID      { $$ = new mm_argument($1,variable); }  
    ;

comparison_operator
    :   EQ_OP       { $$ = eq_operator; }
    |   LT_OP       { $$ = lt_operator; }
    |   GT_OP       { $$ = gt_operator; }
    |   LE_OP       { $$ = le_operator; }
    |   GE_OP       { $$ = ge_operator; }
    |   NE_OP       { $$ = ne_operator; }
    ;

//---------------------------
// The Building Blocks
//---------------------------

id_list
    :   ID              { $$ = new mm_id_list(); 
                          $$->addId($1); }                      
    |   id_list ',' ID          { $1->addId($3); $$=$1; }
    ;

expression
    :   argument                    { $$ = new mm_expression_node($1);  }
    |   '(' expression ')'              { $$ = $2;  }
    |   expression '+' expression           { $$ = new mm_expression_node(new mm_argument((char*)"+",oper),$1,$3,operator_node); }
    |   expression '-' expression           { $$ = new mm_expression_node(new mm_argument((char*)"-",oper),$1,$3,operator_node); }
    |   expression '*' expression           { $$ = new mm_expression_node(new mm_argument((char*)"*",oper),$1,$3,operator_node); }
    |   expression '/' expression           { $$ = new mm_expression_node(new mm_argument((char*)"/",oper),$1,$3,operator_node); }
    |   expression '%' expression           { $$ = new mm_expression_node(new mm_argument((char*)"%",oper),$1,$3,operator_node); }
    |   expression '^' expression           { $$ = new mm_expression_node(new mm_argument((char*)"^",oper),$1,$3,operator_node); }
    |   '-' argument %prec UMINUS           {  }
    ;

expression_list
    :   expression              { $$ = new mm_expression_list(); 
                              $$->addExpression(new mm_expression($1)); }                       
    |   expression_list ',' expression      { $1->addExpression(new mm_expression($3)); $$=$1; }
    ;

condition
    :   expression                  { $$ = new mm_condition(new mm_expression($1),empty_operator,NULL); }
    |   expression comparison_operator expression       { $$ = new mm_condition(new mm_expression($1), $2, new mm_expression($3)); }
    ;

//---------------------------
// The Statements
//---------------------------

exec_statement
    :   EXEC STRING ';'             { $$ = new mm_st_exec($2); }
    ;

use_statement
    :   USE STRING ';'              { $$ = new mm_st_use($2); /*printf("USE statement : %s\n",$2);*/ }
    ;

set_statement
    :   SET ID '(' id_list ')' '=' expression ';'   { 
                                    mm_st_ret* rt = new mm_st_ret(new mm_expression($7));
                                    mm_statement_list* stlist = new mm_statement_list();
                                    mm_statement* st = new mm_statement(ret_statement,rt);
                                    stlist->addStatement(*st);
                                    $$ = new mm_st_set($2,$4,stlist); 
                                }
    |   SET ID '(' id_list ')' '=' block        { $$ = new mm_st_set($2,$4,$7); }
    ;

let_statement
    :   LET ID '=' expression ';'           { $$ = new mm_st_let($2,new mm_expression($4)); }
    ;

get_statement
    :   GET ID ';'                  { $$ = new mm_st_get($2); }
    ;

ret_statement
    :   RET expression ';'              { $$ = new mm_st_ret(new mm_expression($2)); }
    ;

put_statement
    :   PUT expression_list ';'             { $$ = new mm_st_put($2); }
    ;

if_statement
    :   IF '(' condition ')' block          { $$ = new mm_st_if($3,$5,NULL); }
    |   IF '(' condition ')' block ELSE block       { $$ = new mm_st_if($3,$5,$7); }
    ;

loop_statement
    :   LOOP '(' condition ')' block            { $$ = new mm_st_loop($3,$5); }
    ;

save_statement
    :   SAVE expression_list '@' STRING ';'     { $$ = new mm_st_save($2,$4); }
    ;

statement
    :   exec_statement              { $$ = new mm_statement(exec_statement,$1); }
    |   use_statement               { $$ = new mm_statement(use_statement,$1); }
    |   set_statement               { $$ = new mm_statement(set_statement,$1); }
    |   let_statement               { $$ = new mm_statement(let_statement,$1); }
    |   get_statement               { $$ = new mm_statement(get_statement,$1); }
    |   ret_statement               { $$ = new mm_statement(ret_statement,$1); }
    |   put_statement               { $$ = new mm_statement(put_statement,$1); }
    |   if_statement                { $$ = new mm_statement(if_statement,$1); }
    |   loop_statement              { $$ = new mm_statement(loop_statement,$1); }
    |   save_statement              { $$ = new mm_statement(save_statement,$1); }
    ;

//---------------------------
// The Main Loop
//---------------------------

statement_list
    :   statement               { $$ = new mm_statement_list(); $$->addStatement(*$1); }
    |   statement_list statement        { $1->addStatement(*$2); $$ = $1; }
    ;

block 
    :   '{' statement_list '}'          { $$ = $2; }
    ;

main
    :   statement_list              { Base->Statements = $1; }
    ;

%% 
```

* * *

***旁注：**不幸的是，我无法为您提供任何特定于 Ruby 的帮助（因为我不仅是一个绝对的新手，而且实际上 - 出于某种未知原因 - 我讨厌它）；但是，即使在 C 中，我希望这会给你一个粗略的想法...... :-)*

# matlab - Matlab垂直线在使用保持和区域（）时不断出现

> ID：10121446
> 
> 赞同：1
> 
> 时间：2012-04-12T10:04:34.920
> 
> 标签：matlab

当我绘制该区域时，我无法摆脱这条不断出现的垂直线，这让我开始烦恼；

```
[x y] = ginputExtra(4)

x =    0.1947    0.6118    0.8329    0.4136    
y =    0.5746    0.8173    0.4225    0.3553

area([x x(1)],[y y(1)])
[x y] = ginputExtra(4,true)

x =    0.5087    0.6881    0.4954    0.3204    
y =    0.4961    0.2382    0.1566    0.3566

hold on;
area([x x(1)],[y y(1)],'FaceColor',[1 0 0]) 
```

![面积图](../Images/6ceb9cf1a32ebbd2a3e6901aea30afa2.png)

有什么办法可以避免这条线？

顺便说一句：我使用的 ginputExtra 方法调用..

```
function [x y] = ginputExtra(n,booText)
% INPUT
% n:            Number of points to plot
% booText:      Boolean (default false) command to display point number in
%               the plot.

% Author:   Lasse Nørfeldt (Norfeldt) 
% Date:     2012-04-09

if nargin ==2
    bText = booText;
else
    bText = false;
end
H = gca;
set(H, 'YLimMode', 'manual'); set(H, 'XLimMode', 'manual');
set(H, 'YLim', get(H,'YLim')); set(H, 'XLim', get(H,'XLim'));

numPoints = n; xg = []; yg = [];
for i=1:numPoints
    [xi yi] = ginput(1);
    xg = [xg xi]; yg = [yg yi];
    if i == 1
        hold on;
        plot(H, xg(i),yg(i),'ro');
        if bText text(xg(i),yg(i),num2str(i),'FontSize',14); end
    else
        plot(xg([i-1:i]),yg([i-1:i]),'r');
        if bText text(xg(i),yg(i),num2str(i),'FontSize',14); end
    end    
end
hold off;

x = xg; y = yg; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:14:13.853

您的问题可能在于按 area() 进行绘图，因为它似乎主要用于堆叠多个 vecotrs。如果您稍微缩小一点并从蓝色区域的第一个点看到一条类似的垂直线，则区域函数很可能是问题所在。

功能：

```
fill([x x(1)],[y y(1)],COLOR) 
```

可能会为您解决问题，因为它绘制了一个填充的多边形。

/托马斯

# jquery - 如何在加载和单击按钮时运行函数？

> ID：10121447
> 
> 赞同：0
> 
> 时间：2012-04-12T10:04:39.423
> 
> 标签：jquery

我希望在页面加载时调用以下方法：

我不知道怎么做，因为它不是硬编码的命名函数，比如说'function search()'

我意识到必须有一种简单的方法可以在我的页面上使用 jQuery 来执行/引用此函数

非常感谢阅读

```
$(function() {
    $('#searchButton').click(function() {
        var url = $('#AbsolutePath').val() + 'AuditLog.mvc/IndexSearch';
        var iPage = (parseInt($('#txtPage').val())).toString();

        var data = {
            StartDate: $('#StartDate').val(),
            EndDate: $('#EndDate').val(),
            sUser: $('#SearchTextBoxUser').val()
        };

        $('#txtPage').val(iPage);
        $("#ResultsList").load(url, data, function() {
            $('#LoadingGif').empty(); $("#paging").hide(); $("#paging").show();
        });

        LoadCharts(); 
        $('#LoadingGif').empty().html('<img src="' + $("#AbsolutePath").val() + 'Content/images/ajax-loader.gif" alt="Loading image" />');
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:08:24.700

您的代码仅在`click`事件中执行......如果您想在页面加载时执行并且`click`事件执行以下操作：

```
function processClickEvent() {
    var url = $('#AbsolutePath').val() + 'AuditLog.mvc/IndexSearch';
    var iPage = (parseInt($('#txtPage').val())).toString();
    var data = {
        StartDate: $('#StartDate').val(),
        EndDate: $('#EndDate').val(),
        sUser: $('#SearchTextBoxUser').val()
    };
    $('#txtPage').val(iPage);
    $("#ResultsList").load(url, data, function () {
        $('#LoadingGif').empty();
        $("#paging").hide();
        $("#paging").show();
    });
    LoadCharts();
    $('#LoadingGif').empty().html('<img src="' + $("#AbsolutePath").val() + 'Content/images/ajax-loader.gif" alt="Loading image" />');
}
$(function () {
    // execute on click event
    $('#searchButton').click(processClickEvent);
    // execute on load
    processClickEvent();
}); 
```

这将代码分开 - 我创建了一个新函数，然后在事件`processClickEvent`触发它的执行并在加载时执行它`click``#searchButton`

# c - MPI在集群上的简单测试程序

> ID：10121448
> 
> 赞同：1
> 
> 时间：2012-04-12T10:04:48.663
> 
> 标签：c, file, openmpi, mpich

```
#include <math.h>
#include <time.h>
#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
/*-------------------------------------*/
#include<fcntl.h>
#include<unistd.h>
#include<sys/stat.h>
#include<sys/time.h>
#include<sys/mman.h>
#include<sys/types.h>
#include <mpi.h>

#define PERMS 0600
#define PAGE 4096

int ntask=0, mytask=0;

void
write_result (char *detail)
{
    int fd;

    char *filename = (char *) malloc (1000*sizeof(char));

    sprintf(filename, "%d", mytask);

    strcat(filename,".fa");

    fd = open (filename, O_CREAT | O_RDWR, S_IRWXU);

    write (fd, detail, strlen (detail));

    close (fd);
}

char *
mmaping (char *source)
{
    int src;
    char *sm;
    struct stat statbuf;

    if ((src = open (source, O_RDONLY)) < 0)
    {
        perror (" open source ");
        exit (EXIT_FAILURE);
    }

    if (fstat (src, &statbuf) < 0)
    {
        perror (" fstat source ");
        exit (EXIT_FAILURE);
    }
    printf("task->%d\n",mytask);
    printf("total task->%d\n",ntask);

    int piece = statbuf.st_size/PAGE;
    int share = piece/ntask;

    printf("share->%d\n",share);
    sm = mmap (0,statbuf.st_size/ntask, PROT_READ, MAP_SHARED | MAP_NORESERVE,src, mytask*share*PAGE);

    printf("%lld\n",(long long int) statbuf.st_size);

    if (MAP_FAILED == sm)
    {
        perror (" mmap source ");
        exit (EXIT_FAILURE);
    }

    return sm;
}

int main(int argc, char **argv)
{

    MPI_Init(&argc, &argv);
    MPI_Comm_size(MPI_COMM_WORLD, &ntask);
    MPI_Comm_rank(MPI_COMM_WORLD, &mytask);

    char *x = mmaping(argv[1]);
    printf("%d\n",strlen(x));

    write_result(x);

    MPI_Finalize();
    return 0;
} 
```

每个线程读取一个文件的一部分并将其写下来。

在本地机器上工作得很好（mpich）在集群上出错（openmpi）

我的程序在函数 write_result 中的 close(fd) 处终止。

这是错误消息

```
[kalkyl3:30022] *** Process received signal ***
[kalkyl3:30022] Signal: Segmentation fault (11)
[kalkyl3:30022] Signal code: Address not mapped (1)
[kalkyl3:30022] Failing at address: 0x2b9d952d7000
[kalkyl3:30022] [ 0] /lib64/libpthread.so.0() [0x371900f4a0]
[kalkyl3:30022] [ 1] /lib64/libc.so.6() [0x371892fcef]
[kalkyl3:30022] [ 2] ./a.out(write_result+0x58) [0x400df8]
[kalkyl3:30022] [ 3] ./a.out(main+0x4c) [0x400e6c]
[kalkyl3:30022] [ 4] /lib64/libc.so.6(__libc_start_main+0xfd) [0x371881ecdd]
[kalkyl3:30022] [ 5] ./a.out() [0x400ba9]
[kalkyl3:30022] *** End of error message *** 
```

在搜索了相关问题后，我猜测问题可能来自文件打开和关闭过程。由一个特定线程打开的文件应该由同一个线程关闭。也许 openmpi 无法识别哪个线程打开了它，哪个线程关闭了它。但它在 MPICH 上运行良好。

# ios - 如何从 ALAsset 保存压缩的 JPEG

> ID：10121450
> 
> 赞同：4
> 
> 时间：2012-04-12T10:04:57.913
> 
> 标签：ios

我有一个从 ALAssetLibrary 检索到的对象 ALAsset 我想推断压缩 JPEG 以便将其发送到 Web 服务。

任何建议从哪里开始？

编辑：我找到了一种将 NSData 从 ALAsset 中取出的方法

```
ALAssetRepresentation *rappresentation = [asset defaultRepresentation];
Byte *buffer = (Byte*)malloc(rappresentation.size);
NSUInteger buffered = [rappresentation getBytes:buffer fromOffset:0.0 length:rappresentation.size error:&err]; 
```

但我找不到通过调整大小和压缩图像来减小图像大小的方法。我的想法是有类似的东西：

```
UIImage *myImage = [UIImage imageWithData:data];
//resize image
NSData *compressedData = UIImageJPEGRepresentation(myImage, 0.5); 
```

但是，首先，即使不调整大小，仅使用这两行代码压缩数据就比数据大。其次，我不确定调整 UIImage 大小的最佳方法是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T15:23:13.333

从以下位置获取 CGImage 很容易`ALAssetRepresentation`：

```
ALAssetRepresentation repr = [asset defaultRepresentation];
// use the asset representation's orientation and scale in order to set the UIImage
// up correctly
UIImage *image = [UIImage imageWithCGImage:[repr fullResolutionImage] scale:[repr scale] orientation:[repr orientation]];
// then do whatever you want with the UIImage instance 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T15:00:34.723

您可以使用

```
[theAsset thumbnail] 
```

或者;

压缩后可能会导致更大的文件，您需要调整图像大小：

```
+ (UIImage *)imageWithCGImage:(CGImageRef)cgImage scale:(CGFloat)scale orientation:(UIImageOrientation)orientation 
```

# java - Android设备上的for循环非常慢

> ID：10121455
> 
> 赞同：3
> 
> 时间：2012-04-12T10:05:14.997
> 
> 标签：java, android, performance, for-loop, heap-memory

我在尝试为 android 设备编写位图操作算法时遇到了一个问题。

我有一个 1680x128 像素的位图，需要对其应用过滤器。但是这个非常简单的代码片段实际上花了将近 15-20 秒才能在我的 Android 设备上运行（带有 1Ghz 处理器的 xperia ray）。

所以我试图找到瓶颈并尽可能减少代码行，最终得到循环本身，它几乎花费了相同的时间来运行。

```
for (int j = 0; j < 128; j++) {
    for (int i = 0; i < 1680; i++) {
         Double test = Math.random();
    }
} 
```

这样的设备在没有困难操作的简单 for 循环中花费这么多时间是否正常？

我对在移动设备上编程非常陌生，所以如果这个问题可能很愚蠢，请原谅。

更新：现在通过一些更简单的操作更快地得到它。

但回到我的主要问题：

```
public static void filterImage(Bitmap img, FilterStrategy filter) {
    img.prepareToDraw();
    int height = img.getHeight();
    int width = img.getWidth();
            RGB rgb;
    for (int j = 0; j < height; j++) {
        for (int i = 0; i < width; i++) {
            rgb = new RGB(img.getPixel(i, j));
            if (filter.isBlack(rgb)) {
                img.setPixel(i, j, 0);
            } else
                img.setPixel(i, j, 0xffffffff);
        }
    }
    return;
} 
```

上面的代码是我真正需要在设备上运行得更快的代码。（几乎立即）你看到它有任何优化潜力吗？

RGB 只是一个计算红色、绿色和蓝色值的类，如果所有三个颜色部分都低于 100 或任何其他指定值，则过滤器仅返回 true。围绕 img.getPixel(i,j) 或 setPixel 的循环已经需要 20 秒或更长时间。这是一项如此昂贵的手术吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:07:43.903

这可能是因为创建了太多 Double 类型的对象。因此它增加了堆大小并且设备开始冻结。

一种解决方法是

```
double[] arr = new double[128]
for (int j = 0; j < 128; j++) {
    for (int i = 0; i < 1680; i++) {
         arr[i]  = Math.random();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T11:56:22.540

首先，Stephen C 提出了一个很好的论点：尽量避免创建一堆 RGB 对象。

`getPixel`其次，您可以通过一次调用来替换相对昂贵的调用[`getPixels`](http://developer.android.com/reference/android/graphics/Bitmap.html#getPixels%28int%5B%5D,%20int,%20int,%20int,%20int,%20int,%20int%29)

我做了一些快速测试，并设法将运行时间减少到 10% 左右。试试看。这是我使用的代码：

```
int[] pixels = new int[height * width];
img.getPixels(pixels, 0, width, 0, 0, width, height);

for(int pixel:pixels) {
    // check the pixel
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T10:14:41.370

下面的文档中有一个可能会影响性能的随机免责声明，请尝试自己创建一个实例而不是使用静态版本，我以粗体突出显示了性能免责声明：

返回一个伪随机双精度 n，其中 n >= 0.0 && n < 1.0。此方法重用 Random 的单个实例。此方法是线程安全的，因为对 Random 的访问是同步的，但这会损害可伸缩性。**应用程序可能会从为其每个线程分配 Random 中发现性能优势。**

尝试创建自己的随机作为类的静态字段以避免同步访问：

```
private static Random random = new Random(); 
```

然后按如下方式使用它：

```
double r = random.nextDouble(); 
```

如果您不需要双精度，还可以考虑使用 float (random.nextFloat())。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T11:09:37.493

> RGB 只是一个计算红色、绿色和蓝色值的类，如果所有三个颜色部分都低于 100 或任何其他指定值，则过滤器仅返回 true。

一个问题是您正在创建`height * width`RGB 类的实例，只是为了测试单个 pizel 是否为黑色。将该方法替换为将要测试的像素作为参数的静态方法调用。

* * *

更一般地说，如果您不知道为什么某些代码很慢……请**分析一下**。在这种情况下，分析器会告诉您在 RGB 构造函数中花费了大量时间。内存分析器会告诉您正在创建大量 RGB 对象并进行垃圾收集。

# ruby - 检查套接字客户端是否仍然连接

> ID：10121457
> 
> 赞同：2
> 
> 时间：2012-04-12T10:05:16.167
> 
> 标签：ruby, sockets, networking

我想实现一个 while 循环，只要客户端连接到我的套接字就运行。这将是基于线程的，所以我想确保一旦客户端断开连接，线程就会关闭。

1.  问题：如何检查客户端是否仍然连接到我的套接字？

2.  问题：如果我像这样启动它，当连接关闭时线程是否已经关闭： Thread.start(socket.accept) do |client| ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T20:19:53.467

看一下这个，

```
require 'socket'                
th=[]
server = TCPServer.open(2000)

loop do
  Thread.start(server.accept) do |client|
    client.puts "server started.."

    # Something

    th = Thread.list
    th.each do |t|
      if t.status == "sleep" # checks all client status
        f = t.kill           # kills thread if client is disconnected
      end
    end
  end
end 
```

您可以终止线程，或者您可以使用该线程将客户端的 IP 地址存储在数组中，并与确切客户端的 IP 地址进行比较。（如 t.addr）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-08T19:27:45.013

```
server = TCPServer.open 12345

loop {
  Thread.start(server.accept) do |client|
    ...
    puts "client is offline!" if client.closed?
    ...
    client.close
  end
} 
```

你可以检查“关闭？” 在“客户”中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T10:23:56.357

我没有编程红宝石的经验。如果它是 .Net，那么如果没有某种保活协议，你所假装的事情是不可能的。如果服务器在 x 秒后没有从客户端获取数据，则假定客户端已断开连接。客户端必须有一个计时器，以便在不通信时向服务器发送一些东西。

# ios - 使用三次轻击手势从数组中删除特定图像

> ID：10121463
> 
> 赞同：0
> 
> 时间：2012-04-12T10:05:35.887
> 
> 标签：ios, xcode

当用户按下按钮时，会创建一个 UIImageView (image1) 并添加到一个名为 array3 的 NSMutable 中。我可以在屏幕上移动图像，但用户必须能够删除特定图像，所以我添加了一个三连拍手势。手势工作正常，但是，当我三重拍时，所有图像都被删除，或者只删除最后一个：

只有最后一个：

```
[image1 removeFromSuperview]; 
```

他们全部：

```
For (UIImageView *image in array3){ [image removeFromSuperview]; } 
```

我似乎无法只删除点击的图像

为了检测手势，我在 touchesbegan 下添加了这个：

```
UITouch *touch = [touches anyObject];
NSUInteger tapCount = [touch tapCount];
Switch (tapCount) {
case3:
[self trippleTap];
Break; 
```

在案例 3 上方，我添加了案例 1 和案例 2...

然后...

```
-(void)trippleTouch{    [image1 removeFromSuperview];} 
```

# javascript - 在运行时将事件处理程序附加到每个表格单元格

> ID：10121467
> 
> 赞同：1
> 
> 时间：2012-04-12T10:05:52.483
> 
> 标签：javascript, jquery

我在设计时创建了一个表，并在运行时向其中添加了行。我想将鼠标悬停事件附加到显示相应工具提示的第一列的每一行。

```
for(ctr=0;ctr<noOfRows;ctr++){
   var myTable=document.getElementById("myTable");
   var newRow = myTable.insertRow(1);

   var cell0 = newRow.insertCell(0);
   cell0.innerHTML="Cell Data"+"<div class='hiddenToolTip' id='tip"+ctr+"'>"+tooltip+"</div>";

   cell0.onmouseover=function(){
        $("#tip"+ctr).show('blind',500);
   };

   cell0.onmouseout=function(){
        $("#tip"+ctr).hide();
   };
} 
```

问题是“ctr”变量总是作为“onmouseover”和“onmouseout”函数中的最大值出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:12:49.173

只需在函数参数中传递它并使用元素的 id 获取 ctrl 的值，如下所示

```
cell0.onmouseover=function()
{      
    $(this).children("div[id^='tip'] ").show('blind',500);    
    }; 
```

检查此示例：[Javascript：使用 DOM 添加 OnMouseOver 和 OnMouseOut](http://triaslama.wordpress.com/2008/02/02/javascript-adding-onmouseover-and-onmouseout-using-dom/)

# ruby-on-rails - 使用 form_for 返回：nil:NilClass 的未定义方法 `join'

> ID：10121468
> 
> 赞同：3
> 
> 时间：2012-04-12T10:05:54.700
> 
> 标签：ruby-on-rails

尝试使用 form_for 时出现此错误：

_feedback_form.html.erb：

```
<%= form_for @support, :html => { :method => :post } do |f| %>
    <%= f.text_area :content, :class => "quick_feedback_form", :input_html => { :maxlength => 450 } %>
    <%= f.hidden_field :email, :value => current_user.email %>
    <div><%= f.submit "Send!", :disable_with => "Sending...", :class => "button white" %></div>
<% end %> 
```

运行此返回此错误：

```
NoMethodError in Pages#guardian

Showing /home/alex/myapp/app/views/supports/_feedback_form.html.erb where line #1 raised:

undefined method `join' for nil:NilClass 
```

@support 变量已创建并且不是 nil - 我可以从日志中看到它。这在 Rails 3.0 中也运行良好，但现在在迁移到 Rails 3.2 后，它不知何故坏了。

这是一类支持变量。这用于向管理员发送电子邮件反馈：

```
class Support < ActiveRecord::Base
include ActiveModel::Validations

  validates_presence_of :content 
  # to deal with form, you must have an id attribute
  attr_accessor :id, :email, :sender_name, :content

  def initialize(attributes = {})
    attributes.each do |key, value|
      self.send("#{key}=", value)
    end
    @attributes = attributes
  end

  def read_attribute_for_validation(key)
    @attributes[key]
  end

  def to_key
  end

  def save
    if self.valid?
      Feedback.support_notification(self).deliver
      return true
    end
    return false
  end
end 
```

尝试了不同的东西，但仍然看不出这里有什么问题。导轨 3.2.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:33:43.957

我认为问题是你的`to_key`方法。你在这里定义这个方法有什么原因吗？它已在 中定义`ActiveRecord::Base`，因此您将覆盖内部方法。如果您只是将其从模型中取出，那应该可以解决您的问题。

如果您出于某种原因确实想在`to_key`这里定义，请记住对于`persisted`模型（例如`ActiveRecord`模型），它应该返回一个包含模型关键属性的数组。所以它应该看起来像这样：

```
def to_key
  [self.id]
end 
```

你为什么要包括在内`ActiveModel::Validations`？这是为您完成的`ActiveRecord::Base`。

# html - 自定义数据属性替代方案？

> ID：10121469
> 
> 赞同：2
> 
> 时间：2012-04-12T10:05:56.393
> 
> 标签：html, xhtml

以下代码在一个 while 循环中，其中包含来自数据库的值。我将这些值存储在 jQuery 的自定义数据属性中。

```
<div class='pending-information' data-id='$id' data-pid='$position' data-sid='$sid' data-image='$image' data-counter='$counter' data-start='$start'></div> 
```

专业的方法是什么？此方法在 XHTML1 中无效。那么为 jQuery 存储属性/值的常用方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:11:08.630

> 专业的方法是什么？

正是您正在做的事情 -`data-*`属性是执行此操作的常用方法。

> 此方法在 XHTML1 中无效

所以呢？XHTML 不会扩展到新版本 - 从现在开始它是 HTML 5，`data-*`属性是要走的路。

# emacs - 如何让我的软件包在 el-get 之后立即安装（使用 el-get）

> ID：10121470
> 
> 赞同：1
> 
> 时间：2012-04-12T10:06:00.560
> 
> 标签：emacs, elisp

有一个类似于包管理器的[el-get emacs 项目。](https://github.com/dimitri/el-get)

我的 init.el 中有：

```
;; ==== el-get stuff ========================================================
(add-to-list 'load-path "~/.emacs.d/el-get/el-get") 
  (unless (require 'el-get nil t) 
    (url-retrieve "https://raw.github.com/dimitri/el-get/master/el-get-install.el" 
                  (lambda (s) 
                    (end-of-buffer) 
                    (eval-print-last-sexp))))
;; ==== el-get ==============================================================
(setq my-packages 
      (append 
       '(nav) 
       (mapcar 'el-get-source-name el-get-sources))) 
(el-get 'sync my-packages) 
```

所以在第一次运行时，如果它没有安装并且它可以工作，它将安装 el-get，在下一步中我希望它使用 el-get 安装 nav（emacs 包），但它在第一次运行时不起作用（在 el-get 之后安装）甚至在安装完成之前运行。

我怎样才能使它相似：首先运行 -> 安装 el-get -> 安装我的包？

我认为这里的核心问题是如何等到安装 el-get ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T21:22:52.070

你也许会寻找[getelget.el](https://bitbucket.org/Kamiel/.emacs.d/src/ac8b20b003bd72c7dc494fee203afa5c57dc3a34/site-lisp/getelget.el?at=master)

只需设置 el-get-packages、el-get-sources；

```
;; path to local config                                                                                                                                                                                            
(add-to-list 'load-path
             (concat
              (file-name-as-directory user-emacs-directory) "site-lisp/"))

(load-library "getelget.el") 
```

您也可以使用此功能

```
(el-get-sync) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:40:32.763

我使用 el-get 来管理我的所有包裹。我非常喜欢它。这是我的 init.el 中的修改片段

```
(unless (require 'el-get nil t)
  (setq el-get-install-branch "master")
  (with-current-buffer
      (url-retrieve-synchronously
       "https://raw.github.com/dimitri/el-get/master/el-get-install.el")
    (end-of-buffer)
    (eval-print-last-sexp))
  (el-get-emacswiki-refresh el-get-recipe-path-emacswiki t)) 
```

有了这个`init.el`，如果我去任何新计算机，我只需要将新的 init.el 放在适当的位置并启动 emacs。

上面的代码片段检查天气 el-get 是否可用。如果它不可用，它会安装 rigtaway。

一旦 el-get 下来，它将占用其余的软件包。

# content-management-system - 如何使用 Plone 作为文档管理器？

> ID：10121474
> 
> 赞同：2
> 
> 时间：2012-04-12T10:06:13.763
> 
> 标签：content-management-system, plone

我希望为我的公司创建一个文档存储库。原因是我的公司有很多文件，他们没有版本跟踪。这意味着每个人一直在使用不同的版本。

Plone 对我来说是新事物，我是从我的一个好朋友那里知道的。太糟糕了，他已经不在了，无法回答我的问题。我相信他，我希望实现他的想法，将 Plone 用作我公司的文档存储库。

我已经安装了 Plone 并设法查看默认的 Plone 页面，添加所有公司的用户名并将徽标更改为我公司的徽标。现在最大的问题是，如何设置文档存储库？我想到的是为用户创建一个“页面”来添加文件、下载文件、搜索文件并阅读其描述。

有什么线索可以让我去吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T14:11:46.417

Reusable, Same problem here. We started to use Plone as our main DMS 4 weeks ago (inserting existing docs at present).

For working copies, we use iterate (insert `plone.app.iterate` under `eggs` in your `buildout.cfg`).

For versioning, `Products.CMFEditions`. I believe this worked out of the box.

For creating new workflow, look into `plone.app.workflowmanager` and read the docs.

In a [previous question](https://stackoverflow.com/questions/9788737/the-holy-grail-of-plone-workflow) we asked, we were still looking at Dexterity which has alot going for it but eventually we decided on adapting an existing content type based on Archetypes.

As for inserting files, as long as the description is ok, they will be found through the in-built search functionality, but you might consider using Iterate mentioned above to make sure that nobody is using the same file twice.

As your new, as I am, the [docs](http://collective-docs.readthedocs.org/en/latest/index.html#) seem hard at first but are actually quite good.

And this [book](http://www.martinaspeli.net/plone-book) is still giving me the foundation we need to keep adding functionality.

Good luck

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-13T05:23:25.367

我认为，您应该在原版 Plone 安装方面走得很远，而无需开发自己的扩展或其他自定义附加产品。因此，我建议您从[Plone 4 用户手册](http://plone.org/documentation/manual/plone-4-user-manual)开始，了解您可以开箱即用的所有操作。

正如@Speediro 所提到的，主要内容类型内置了版本控制支持（实际上您没有在任何地方看到提到的*CMFEditions*），但它没有为文件上传激活。虽然，[正如手册中简要提到的](http://plone.org/documentation/manual/plone-4-user-manual/managing-content/versioning-plone-v3.3)：*可以通过“类型”下的“站点设置”→“克隆配置”面板将内容项配置为启用/禁用版本控制*。

[*工作副本支持*](http://plone.org/documentation/manual/plone-4-user-manual/managing-content/working-copy)(`plone.app.iterate`) 也应该已经在站点设置的附加面板上等待激活。

然而，在 Plone Collective (=community) Developer Docs 或 Professional Plone 4 Development 之前，我推荐[Practical Plone 3](https://www.packtpub.com/practical-plone-3-beginners-guide-to-building-powerful-websites/book)。它有一些过时的图形（因为它是为 Plone 3 制作的），但它是用户手册之后的下一步。例如，如何定义内容规则以发送内容更新的电子邮件通知（仍然通过浏览器，无需编码）。或者如何使用`Products.PloneFormGen`.

当您真的需要编写自己的代码时，是时候使用 Professional Plone 4 和 Collective Docs。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T14:46:08.467

如果您没有开发人员来管理您的东西，我建议您继续使用官方 Plone，没有自定义代码并且只使用广泛使用的插件。

我是说：

*   保持默认主题（旭日形）
*   使用默认的克隆内容类型
*   只自定义标志
*   在插件控制面板中激活 plone.app.iterate
*   不要玩工作流，因为他们需要知道你在做什么。默认情况下，文件具有其文件夹的可见性。这意味着如果您可以看到该文件夹​​，您将能够看到其中的所有文件。您可以为 ZMI 下的文件激活默认工作流。
*   使用collective.quickupload插件

由于 Plone 正在做索引，而索引意味着大量空间，您的数据库将非常快速地增长到巨大的规模。因此，您必须以系统管理员的身份处理此问题；

# ios5 - Childbrowser 插件在 Phonegap 中不起作用

> ID：10121475
> 
> 赞同：1
> 
> 时间：2012-04-12T10:06:24.247
> 
> 标签：ios5, cordova, backbone.js, requirejs

我正在使用与 Phonegap 或 Cordova 捆绑的 Backbone、Require 和 Underscore。

我尝试使用 childbrowser 插件，但它不起作用。我按照这里的说明进行操作。 [http://blog.digitalbackcountry.com/2012/03/installing-the-childbrowser-plugin-for-ios-with-phonegapcordova-1-5/](http://blog.digitalbackcountry.com/2012/03/installing-the-childbrowser-plugin-for-ios-with-phonegapcordova-1-5/)

```
define([
'jquery',
'backbone',
'underscore',
'base64',
'mobile',
'const',
    'child',
'text!template/login/login.tpl.html'
],function($, Backbone, _, base64, Mobile, Const, ChildBrowser, template){

var EncodeAuth = function(user,pass)
{
    var _tok = user + ':' + pass;
    var _hash = Base64.encode(_tok);
    return "Basic "+ _hash;
}

var LoginView = Backbone.View.extend({
    events:{
    "click .login-btn" : "Login",
    "click .connection-btn" : "OpenSite"
    },

    initialize: function(){
    },

    Login: function(){
        Const.USERNAME = $("#username").val();
        Const.PASSWORD = $("#password").val();
        if(!Const.USERNAME || !Const.PASSWORD)
        {
            navigator.notification.alert("Invalid Username/Password!");
            $("input").val("");
        }else{

            var auth = EncodeAuth(Const.USERNAME,Const.PASSWORD);

            var sendAuthorization = function (xhr) {
              xhr.setRequestHeader('Authorization', auth)
            };

            this.model.save(this.model, {
                beforeSend : sendAuthorization,
                success: function(model,result){
                    if(result.ErrorMessage === null)
                    {
                        alert(JSON.stringify(result.Message));
                        $("input").val("");
                    }
                    else
                    {
                        alert(JSON.stringify(result.ErrorMessage));
                        $("input").val("");
                    }
                },
                error: function(model,result){
                    alert("Remote server returned an error. Not Found");
                    $("input").val("");
                }
            });
        }
    },
        OpenSite: function(){
            window.plugins.ChildBrowser.showWebPage("http://www.google.com");
        }
});
return LoginView;
 }); 
```

有任何想法吗？

# xml - 在 Perl 中使用 XML::XPath 模块获取节点值

> ID：10121476
> 
> 赞同：7
> 
> 时间：2012-04-12T10:06:26.727
> 
> 标签：xml, perl, xpath

我正在使用下面的代码从 XML 文件中获取节点的值：

```
use XML::XPath;
use XML::XPath::XMLParser;

my $pt1 = XML::XPath->new(filename => 'test1.xml');

my $nodeset = $pt1->find('/file1/table/tname'); 

foreach my $node ($nodeset->get_nodelist) 
{
   print $node->getNodeValue."\n";
} 
```

**'test1.xml' 的内容如下：**

```
<file1>
    <table>
        <tname>_sys_ident</tname>
        <ttype>regular</ttype>
        <col>
            <name>_sys_ident_asp</name>
            <type>varchar(16)</type>
            <fkey>_sys_asp</fkey>
            <attr>PRIMARY KEY</attr>
        </col>
    </table>
</file1> 
```

我想打印**tname**的值（即**_sys_ident**）。但是上面的代码没有打印任何东西。

如果我在 for 循环中使用以下内容：

```
print XML::XPath::XMLParser::as_string($node); 
```

然后，它给出以下输出：

```
<tname>_sys_ident_asp</tname> 
```

我不想要这个完整的节点名称和值字符串。**我只想要节点值。** 这是我第一次尝试 XML 和 XPath。请告诉我我做错了什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-12T10:20:48.670

`getNodeValue`用于[属性](https://metacpan.org/pod/XML::XPath::Node::Attribute)节点。对于[elements](https://metacpan.org/pod/XML::XPath::Node::Element)，您需要以下`string_value`方法：

```
foreach my $node ($nodeset->get_nodelist) 
{
   print $node->string_value."\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-14T01:34:53.517

对于您的 xpath，请尝试 /file1/table/tname/text()

# opencv - 尝试交叉编译opencv时出错

> ID：10121479
> 
> 赞同：0
> 
> 时间：2012-04-12T10:06:35.700
> 
> 标签：opencv, arm, codeblocks

我正在尝试用opencv的功能交叉编译一个非常简单的测试程序。

我正在使用 Ubuntu 11.10 和 Codeblocks，当我编译我的代码时，它对我来说是这样的：

```
||warning: ../../lib/libopencv_core.so, needed by /root/arm-lib/lib/libopencv_highgui.so, not found (try using -rpath or -rpath-link)|
||warning: ../../lib/libopencv_imgproc.so, needed by /root/arm-lib/lib/libopencv_highgui.so, not found (try using -rpath or -rpath-link)|
||=== Build finished: 0 errors, 2 warnings ===| 
```

当我尝试在 ARM 中执行这个软件时，我得到了分段错误（核心转储）。

我在代码块上使用的标志是：

-L/usr/local/lib -L/lib/libbxml2.so.2 -lpthread -lrt -lxml2 -lz -lopencv_highgui -lopencv_core -lopencv_imgproc

你有什么建议？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T14:29:09.320

您的命令行有一个明显的问题：`-L`必须仅用于添加库目录，但是，您使用它来包含一个文件`-L/lib/libbxml2.so.2`，这是错误的。

很可能你想做：

```
-L/usr/local/lib -L/lib -lxml2 -lpthread -lrt -lxml2 -lz -lopencv_highgui -lopencv_core -lopencv_imgproc 
```

现在，错误很明显：系统在您包含的路径中找不到 libopencv_core.so 和 libopencv_imgproc.so `-L`。我建议您找到这些文件，然后使用`-L`标志添加适当的目录。

# iphone - 如何将 iPhone 日历事件导入我的应用程序？

> ID：10121480
> 
> 赞同：0
> 
> 时间：2012-04-12T10:06:35.847
> 
> 标签：iphone, events, import, calendar, ekevent

我正在寻找一些将 iPhone 日历事件导入我的应用程序的教程/指南。

任何人都可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T11:30:30.527

```
-(void)EventList{

EKEventStore *eventStore = [[EKEventStore alloc] init];
if([eventStore respondsToSelector:@selector(requestAccessToEntityType:completion:)]) {
    // iOS 6 and later
    ReadCalendar = TRUE;

    [eventStore requestAccessToEntityType:EKEntityTypeEvent completion:^(BOOL granted, NSError *error) {
        if (granted){
            //---- codes here when user allow your app to access theirs' calendar.
            [self performCalendarActivity];
        }else
        {
            //----- codes here when user NOT allow your app to access the calendar.
        }
    }];
}
else {
    //---- codes here for IOS < 6.0.
    [self performCalendarActivity];
} 
```

}

```
-(void)performCalendarActivity{
   self.eventStore = [[EKEventStore alloc] init];

   eventsList = [[NSMutableArray alloc] initWithArray:0];

    // Get the default calendar from store.
    self.defaultCalendar = [self.eventStore defaultCalendarForNewEvents];

    eventsList= [[self fetchEventsForToday] mutableCopy]; 
```

}

```
-(NSArray *)fetchEventsForToday {
NSDate *startDate;
    NSDate *endDate;
    startDate = [NSDate date];
    endDate = [NSDate dateWithTimeIntervalSinceNow:86400];

// Create the predicate. Pass it the default calendar.
NSArray *calendarArray = [NSArray arrayWithObject:defaultCalendar];
NSPredicate *predicate = [self.eventStore predicateForEventsWithStartDate:startDate endDate:endDate
                                                                calendars:calendarArray];

// Fetch all events that match the predicate.
NSArray *events = [self.eventStore eventsMatchingPredicate:predicate];

return events; 
```

}

# javascript - 从 Maven 控制 JSLint (javascript-maven-plugin)

> ID：10121482
> 
> 赞同：1
> 
> 时间：2012-04-12T10:06:48.783
> 
> 标签：javascript, maven

使用 javascript-maven-plugin 时，有没有办法从 pom.xml 控制 JSLint 的执行？

虽然我发现这个插件在其他方面非常有用，但 JSLint 的执行似乎非常严格，我还没有找到任何绕过它的方法。

我正在使用适用于 Eclipse 的 Aptana Studio 插件，它还使用 JSLint 验证代码，但它允许忽略某些“错误”，例如找不到“控制台”。

# php - 在 foreach 循环中修改数组值

> ID：10121483
> 
> 赞同：126
> 
> 时间：2012-04-12T10:06:57.010
> 
> 标签：php, arrays, object, foreach

我想知道是否可以编辑`foreach`循环中正在处理的当前对象

我正在处理一组对象`$questions`，我想在我的数据库中查找与该问题对象相关的答案。因此，对于每个问题，请获取答案对象并更新循环`$question` **内**的电流，以便我可以在其他地方输出/处理。`foreach`

```
foreach($questions as $question){
    $question['answers'] = $answers_model->get_answers_by_question_id($question['question_id']);
} 
```

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2012-04-12T10:08:55.557

有两种方法可以做到这一点

```
foreach($questions as $key => $question){
    $questions[$key]['answers'] = $answers_model->get_answers_by_question_id($question['question_id']);
} 
```

这样您就可以保存密钥，因此您可以在主`$questions`变量中再次更新它

或者

```
foreach($questions as &$question){ 
```

添加`&`将保持`$questions`更新。但我会说第一个是推荐的，即使它更短（见 Paystey 的评论）

根据[PHP`foreach`文档](http://php.net/manual/en/control-structures.foreach.php)：

> 为了能够直接修改循环内的数组元素，在 $value 之前加上 &。在这种情况下，该值将通过引用分配。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-01-25T11:03:47.727

当然`array_map`，如果使用容器实现`ArrayAccess`来派生对象只是一种更智能的语义方式来解决这个问题？

数组映射语义在我见过的大多数语言和实现中都是相似的。它旨在根据输入数组元素返回修改后的数组（高级忽略语言编译/运行时类型首选项）；循环旨在执行更多逻辑。

对于通过 ID / PK 检索对象，取决于您是否使用 SQL（似乎建议），我会使用过滤器来确保我得到一组有效的 PK，然后用逗号内爆并放入 SQL`IN()`子句中返回结果集。它通过 SQL 进行一次调用而不是多次调用，从而优化了一些`call->wait`循环。最重要的是，我的代码对于具有一定能力的任何语言的人都可以很好地阅读，而且我们不会遇到可变性问题。

```
<?php

$arr = [0,1,2,3,4];
$arr2 = array_map(function($value) { return is_int($value) ? $value*2 : $value; }, $arr);
var_dump($arr);
var_dump($arr2); 
```

对比

```
<?php

$arr = [0,1,2,3,4];
foreach($arr as $i => $item) {
    $arr[$i] = is_int($item) ? $item * 2 : $item;
}
var_dump($arr); 
```

如果您知道自己在做什么将永远不会有可变性问题（请记住，如果您打算覆盖，则`$arr`可以始终`$arr = array_map`明确。

# image - packbits 压缩是 RLE 的另一个名称吗

> ID：10121484
> 
> 赞同：1
> 
> 时间：2012-04-12T10:07:03.797
> 
> 标签：image, compression

我对 packbits 压缩感到困惑。我使用 faststone 图像转换器将 jpg 图像转换为 tiff packbits 压缩。然后我运行 imagemagicks 识别工具来查看使用的压缩算法，它说它是 RLE。那么这是否意味着 packbits 和 RLE 指的是相同的压缩算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T14:55:40.280

是的。 [packbits](http://en.wikipedia.org/wiki/PackBits)只是带有特定方案的游程编码，用于标记文字与重复字节。

# python - Django TestCase 不使用辅助数据库上的事务

> ID：10121485
> 
> 赞同：8
> 
> 时间：2012-04-12T10:07:04.387
> 
> 标签：python, django, multiple-databases

我正在使用 Django 1.3.1。我有两个数据库，我的一些模型在一个数据库中，一些在另一个数据库中。这两个数据库都是 contrib.gis.db.backends.postgis 数据库。

令我惊讶的是，Django 的 TestCase 并没有回滚我在两次测试之间在辅助数据库中所做的更改。

在下面的代码中，myproject.models.WellOwner 是一个非常简单的模型，基本上只有一个字段“name”。路由器说它应该在辅助数据库中。第一个测试中的断言成功，第二个测试失败：

```
from django.test import TestCase
from myproject.models import WellOwner

class SimpleTest(TestCase):
    def test1(self):
        WellOwner.objects.create(name="Remco")
        self.assertEquals(1, WellOwner.objects.count())  # Succeeds

class SimpleTest2(TestCase):
    def test2(self):
        # I would expect to have an empty database at this point
        self.assertEquals(0, WellOwner.objects.count())  # Fails! 
```

我假设 Django 将其包装在默认数据库上的事务中，而不是辅助数据库上。这是一个已知问题吗？有解决办法吗？也许在 1.4 中？我的 Google-fu 失败了。

（如果我在设置中将 DATABASE_ROUTERS 更改为 [] 以便所有内容都进入同一个数据库，问题就会消失）

我将添加路由器的整个代码，以防有帮助：

```
SECONDARY_MODELS = ('WellOwner', ...)

import logging
logger = logging.getLogger(__name__)

class GmdbRouter(object):
    """Keep some models in a secondary database."""

    def db_for_read(self, model, **hints):
        if model._meta.app_label == 'gmdb':
            if model._meta.object_name in SECONDARY_MODELS:
                return 'secondary'

        return None

    def db_for_write(self, model, **hints):
        # Same criteria as for reading
        return self.db_for_read(model, **hints)

    def allow_syncdb(self, db, model):
        if db == 'secondary':
            if model._meta.app_label in ('sites', 'south'):
                # Hack for bug https://code.djangoproject.com/ticket/16353
                # When testing, create django_site and south in both databases
                return True

            return self.db_for_read(model) == 'secondary'
        else:
            # Some other db
            if model._meta.app_label == 'gmdb':
                # Our models go in the other db if they don't go into secondary
                return self.db_for_read(model) != 'secondary'

            # Some other model in some other db, no opinion
            return None 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T21:25:45.283

尝试这个：

```
class MyTestCase(TestCase):
    multi_db = True 
```

[https://docs.djangoproject.com/en/1.2/topics/testing/#django.test.TestCase.multi_db](https://docs.djangoproject.com/en/1.2/topics/testing/#django.test.TestCase.multi_db)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-23T19:35:53.577

请注意，`multi_db`自 Django 2.2 以来已弃用。
要使用的新选项是[`databases`](https://docs.djangoproject.com/en/2.2/topics/testing/tools/#django.test.TransactionTestCase.databases).

# android - 在 phonegap 中执行数据库操作时出现不必要的错误

> ID：10121486
> 
> 赞同：0
> 
> 时间：2012-04-12T10:07:08.630
> 
> 标签：android, sql, cordova

我正在使用phonegap在Android中执行一些DB（SQL）操作......虽然一切正常，但在查询执行时我也遇到了不必要的错误......这是我的代码

```
var db = window.openDatabase("something", "1.0",
                            "PhoneGap Demo", 0);
                    db.transaction(someFunction, errorCB);

function someFunction(tx) {

    tx.executeSql('SELECT md5_value from md5_table where category = 1', [],
            gettingMd5QuerySuccess, errorCB);

}

function gettingMd5QuerySuccess(tx, results) {

        tx.executeSql('UPDATE md5_table set md5_value = "' + tempValue
            + '" where category = 1', successCB, errorCB);

    }

function errorCB(err) {
    alert("Error processing SQL: " + err);
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T13:46:27.533

我在做一个语法错误...我需要替换

```
tx.executeSql('UPDATE md5_table set md5_value = "' + tempValue
        + '" where category = 1', successCB, errorCB); 
```

经过

```
tx.executeSql('UPDATE md5_table set md5_value = "' + tempValue
        + '" where category = 1', [], successCB, errorCB); 
```

# java - TabHost 与其内容之间的通信

> ID：10121491
> 
> 赞同：1
> 
> 时间：2012-04-12T10:07:26.947
> 
> 标签：java, android, tabs, android-tabhost

让我们想象一下以下结构：

```
ActivityA ---->  contains TabHostA, Button1

TabHostA  ---->  in one of its tabs holds the ActivityB that contains TextView1 
```

TabHost 充满了一个意图：

```
TabSpec tab = mTabHost.newTabSpec("tab1").setIndicator("tab1")
        .setContent(new Intent(this, ActivityB.class));
mTabHost.addTab(tab); 
```

我想在按下 Button1 时更改 TextView1。如何从 ActivityA 访问 TextView1 或与 ActivityB 和 ActivityA 通信以进行此更改？

请不要尝试更改“选项卡模型”，因为它来自更复杂的问题（如果有兴趣在片段中搜索 MapViews），这就是它的独特工作方式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:13:19.407

也许是这样？

```
((TabActivity) getParent()).getTabHost() 
```

然后您可以编辑给定选项卡的 TextView。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:36:40.643

您可以使用`BroadCastReciever`，当`Button`按下 时，从 广播它`ActivityA`，然后在`ActivityB`其中注册自己`BroadCastReciever`将接收广播并更改内容`TextView`

# css - 如何在 URL 栏上显示图像

> ID：10121494
> 
> 赞同：-1
> 
> 时间：2012-04-12T10:07:49.083
> 
> 标签：css, styles, favicon

我想在浏览器的 URL 栏上显示图像和一些文本。

我可以使用标签显示图像，`<link type="image/x-icon" href="../../images/iconFav.bmp" rel="shortcut icon" />`但无法在图像旁边显示文本。

实际上我想做的就像 stackoverflow 在 URL 栏上显示一个图像，我想显示一个图像和几个文本:) Otehr 示例是看看`https://developers.facebook.com/docs/reference/fql/`哪个显示图像并`facebook.com`在 URL 栏上显示图像和旁边的图像

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:10:08.393

该文本（显示在 favicon.ico 旁边）是 HTML[标题元素](http://www.w3schools.com/tags/tag_title.asp)：

```
<html><head><title>Your text here</title></head></html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:14:26.120

该图标未显示，因为 BMP 不是受支持的图标文件格式。为了获得最佳支持，请使用 ICO 文件。请参阅：[http ://en.wikipedia.org/wiki/Favicon#File_format_support](http://en.wikipedia.org/wiki/Favicon#File_format_support)

如果您愿意，可以使用[Favicon.co.uk](http://www.favicon.co.uk/)将您的图像转换为 ICO 格式

然后像这样链接到它：

```
 <link href="/location/of/favicon.ico" rel="shortcut icon" /> 
```

然后在标签`<title>Your Title</title>`内使用标题`<head>`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T10:14:39.880

您需要阅读网站图标。还要确保您使用正确的文档类型和正确的收藏图标链接。您需要使用转换器将您的 favicon 转换为 ico 文件：我更喜欢这个： http: [//www.prodraw.net/favicon/index.php](http://www.prodraw.net/favicon/index.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T10:26:28.653

我认为您指的是 SSL 扩展验证信息。现代浏览器显示在 HTTPS 下运行的站点，域为蓝色或绿色（取决于购买的 SSL 证书的类型）。

有关扩展验证的更多详细信息，请访问[http://en.wikipedia.org/wiki/Extended_Validation_Certificate](http://en.wikipedia.org/wiki/Extended_Validation_Certificate)但实际上无法控制文本 - 它可以是您网站的域，例如 facebook.com，也可以是您的组织名称，例如“贝宝公司。” 并且需要购买 SSL 证书，并且仅在使用 SSL 浏览时才会显示在您的网站上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-23T10:37:21.917

我认为如果该站点是安全的并由某些组织验证，则会出现该文本。但我能够通过使用在位置栏上显示图像`<link type="image/x-icon" href="../../images/iconFav.bmp" rel="shortcut icon"/>`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-12T10:11:02.950

这是不可能的。在 https 站点上，一些浏览器会在图像（站点名称）旁边放置一些东西，以表明您正在以安全的方式访问该站点，但是程序员无法控制这一点，它是内置在浏览器中的。您可以控制图标图像，仅此而已。

# c++ - 模板类继承语法

> ID：10121503
> 
> 赞同：1
> 
> 时间：2012-04-12T10:08:35.230
> 
> 标签：c++

我的意图是有一些基类`CBaseClass`，除其他外，用作某些类型成员的容器`CBaseMember`；然后得出一个`CDerivedClass : public CBaseClass`成立`CDerivedMember : public CBaseMember`。

我不能使用一个指针并用一个对象`CBaseMember`初始化它，因为它是一种多重继承情况，有一个与实现无关但需要对. 很多肮脏的铸造是我非常想避免的。`CDerivedMember``CDerivedClass``CDerivedMember``CBaseClass``CDerivedClass`

我对这个问题的解决方案是制作`CBaseClass`一个模板，如下所示：

```
//declaration
template <class Member>
CBaseClass
{
protected:
    virtual void GenericMethod();
    virtual void VirtualMethod() = 0;

    Member* member;
};

//definition
template <class Member>
void CBaseClass<Member>::GenericMethod()
{
    member->SomeMemberMethod();
} 
```

然后`CDerivedClass`从它继承，像这样：

```
//declaration
CDerivedClass : public CBaseClass<CDerivedMember>
{
protected:
    virtual void VirtualMethod();
};

//definition
void CDerivedClass::VirtualMethod()
{
    member->SomeDerivedMethod();
} 
```

可以预见的是，这不起作用（`CBaseClass<CDerivedMember>::GenericMethod()`由于显而易见的原因尚未解决），但不幸的是我不知道如何更改我的代码以表示我想要它的意思。

谁能解释这些事情是如何正确完成的 - 或者为我的问题提出另一种解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:00:01.460

我怀疑您想摆脱模板，因为您提供的代码段会起作用（如果您将`class`关键字添加到类型的声明中）。

**如果您想避免从`CBaseMember*`to向下转换`CDerivedMember*`，您可以使用动态绑定和协方差来处理这种情况**：

```
class CBaseClass {
  private:
    CBaseMember* const baseMember;
  protected:
    virtual CBaseMember* member() const {
    //      ^^^^^^^^^^^
      return baseMember;
    }
    /* everything else you need here. Just never ever access `baseMember` directly */
};
class CDerivedClass : public CBaseClass {
  private:
    CDerivedMember* const derivedMember;
  protected:
    virtual CDerivedMember* member() const {
    //      ^^^^^^^^^^^^^^
      return derivedMember;
    }
    /* everything else you need here. Just never ever access `derivedMember` directly */
}; 
```

但是，这仅在您永远不会将成员更改为指向其他地方的情况下才有效，因为您无法使用 setter 来实现此技巧：`virtual void CBaseClass::member(CBaseMember*)`无法使用`virtual void CDerivedClass::member(CDerivedMember*)`.

请注意，您仍然会随身携带`baseMember`指针`CDerivedClass`，尽管它从未使用过。因此，如果内存对您很重要，那么这可能不可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:28:01.350

好吧，您可以将脏类型转换保存在一个地方，封装在您的类中。因此，它不再是真正的脏了。

```
class CBaseMember {
public:
    virtual void SomeMemberMethod(){}
};

class CDerivedMember : public CBaseMember {
public:
    virtual void SomeMemberMethod() { /* do other stuff */ }
    virtual void SomeDerivedMethod() {}
};

//declaration
class CBaseClass
{
protected:
    virtual void GenericMethod();
    virtual void VirtualMethod() = 0;

    CBaseMember* member;
    virtual CBaseMember * getMember() {
    return member;
    }
};

//definition
void CBaseClass::GenericMethod()
{
    getMember()->SomeMemberMethod();
}

//declaration
class CDerivedClass : public CBaseClass
{
protected:
    virtual void VirtualMethod();
    virtual CDerivedMember * getMember() {return static_cast<CDerivedMember *>(member);}
};

//definition
void CDerivedClass::VirtualMethod()
{
    getMember()->SomeDerivedMethod();
} 
```

总之，您`getMember()`在派生类的方法中进行了脏类型转换。此时，您应该确定成员的类型是`CDerivedMember`无论如何。因此，只要您知道您拥有的指针是类型的，`CDerivedClass`您就可以在不进行类型转换的情况下访问它`CDerivedMember`。如果你必须回退到一个`CBaseClass`指针，你自然会`CBaseMember`在访问它的成员时回退到。

# google-app-engine - appengine 会在中国工作吗？

> ID：10121505
> 
> 赞同：20
> 
> 时间：2012-04-12T10:08:42.170
> 
> 标签：google-app-engine

我们的一些客户想知道 - 查看一些关于信息不一致的帖子。

[http://code.google.com/p/googleappengine/issues/detail?id=1144](http://code.google.com/p/googleappengine/issues/detail?id=1144)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-12T10:15:11.963

答案是“**不**”，现在和很久以后。

*   cz google 支持他在中国的服务，
*   但不是中国政府。
*   apppot 被中国周围的大防火墙阻止了。

*顺便说一句，当奥巴马访问中国时，它起作用了。*

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-09-30T11:45:04.073

根据我进行的测试，App Engine 本身似乎没有在中国被屏蔽，但 appspot.com 域被屏蔽了。因此，如果您可以使用自己的域，那么 App Engine 应该适合您。实际上，如果您使用`yourapp.appsp0t.com`（用零代替 o），那么它目前似乎也可以正常工作，尽管从长远来看，我并不真正建议依赖这种解决方法；它将打开您的应用程序和您的用户，使其受到来自运行者的中间人 (MITM) 攻击`appsp0t.com`。

以下是一些可用于检查中国可用性和性能的工具：

*   [http://www.greatfirewallofchina.org/](http://www.greatfirewallofchina.org/)
*   [http://www.websitepulse.com/help/testtools.china-test.html](http://www.websitepulse.com/help/testtools.china-test.html)
*   [http://www.dotcom-monitor.com/WebTools/website-speed-test.aspx](http://www.dotcom-monitor.com/WebTools/website-speed-test.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-12T18:29:09.983

不是直接的，因为谷歌DNS服务器被“防火墙”封锁了，所以在中国无法访问myapp.appspot.com。

但是，您可以通过设置反向代理服务器来解决问题，它将 myapp.com 重定向到 myapp.appspot.com。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-31T20:14:45.547

使用自定义域名怎么样？

这将绕过 DNS 解析。但是为appengine分配的google IP地址范围是否被中国屏蔽了？如果是这样，那么您必须使用反向代理解决方案。

# php - 页面底部的 tcpdf 位置页脚

> ID：10121506
> 
> 赞同：2
> 
> 时间：2012-04-12T10:08:44.200
> 
> 标签：php, email, footer, tcpdf

我正在使用 tcpdf 将 pdf 添加到系统发送的电子邮件中。当电子邮件到达时，办公室将其打开并打印出 pdf 并将其发布给未在系统上设置电子邮件的客户。问题是当 tcpdf 生成 pdf 时，它会将页脚直接放在信函的内容之下。这样做的问题是pdf使用公司的信头模板并将页眉放在正确的位置，但页脚应该放在页面底部，但它会根据内容的位置移动，其中为了使它看起来像他们的信头一样需要在底部。

我目前正在使用以下内容（我知道 POSTS 是不安全的，当我完成所有操作时，我很快就会对那个进行排序）：

```
 <?php

    $message = $_POST[emailformmessage];
    $cf_id = $_POST[cf_id];
    $leadname = $_POST[leadname];
    $postcode = $_GET[postcode];
    $address = $_GET[address];
    $date = $_GET[date];
    $town = $_GET[town];
    $business = $_POST[businessname];

    $html = "<html>
    <head>
    <style>

    .container {width:680px; font-family:Arial, Helvetica, sans-serif; font-size:44px;}

    .header {margin-left:50px; margin-right:50px; margin-top:15px;}

    .customeraddress {color:#000;margin-left:65px; margin-right:65px; margin-top:25px; text-align:left;}

    .delivered {color:#fff; background:#344EA2; margin-left:80px; margin-top:5px; text-align:center;padding:15px; margin-right:80px;}

    .titles_L {color:#fff; background:#13155C; margin-left:80px; margin-top:5px; text-align:center; padding:5px; width:250px; float:left; font-weight:bold;}

    .titles_R {color:#fff; background:#13155C; margin-top:5px; text-align:center; padding:5px; margin-right:80px; width:250px; float:left; font-weight:bold;}

    .body-text { background:#fff;color:#333; margin-left:65px; margin-top:5px; text-align:left; padding:15px 0px 15px 0px; margin-right:65px; overflow:auto;}

    .terms {color:#fff;margin-left:80px; margin-top:5px; text-align:center;  padding:15px; margin-right:80px;}

    .footer {margin-left:50px; margin-top:5px; text-align:left; font-size:40px; padding:15px; margin-right:50px; color:#000; overflow:auto;}

    .footer a {}

    .footer_left {float:left; width:100px;}

    .footer_right {float:left;}

    .clear {clear:both; float:none;}

    .footerclear {clear:both; float:none; width:100%; padding:8px;}

    .pricerow {}

    .emailpricesgasoil {width:240px; float:left;  padding-bottom:15px; padding-top:15px; margin:2px 0px 2px 0px;background:#f4f4f4;color:#EE3B33;}

    .emailpricesderv {width:240px; float:left;  padding-bottom:15px; padding-top:15px; margin:2px 0px 2px 0px;background:#f4f4f4;color:#EE3B33;}

    .emailpriceskero {width:240px; float:left;  padding-bottom:15px; padding-top:15px; margin:2px 0px 2px 0px;background:#f4f4f4;color:#EE3B33;}

    .emailfueldescgasoil {width:250px; float:left;  padding-bottom:15px; padding-top:15px;margin:2px 0px 2px 0px;background:#f1f1f1;}

    .emailfueldescderv {width:250px; float:left;  padding-bottom:15px; padding-top:15px; margin:2px 0px 2px 0px;background:#f1f1f1;}

    .emailfueldesckero {width:250px; float:left;  padding-bottom:15px; padding-top:15px;  margin-top:2px; margin:2px 0px 2px 0px; background:#f1f1f1;}
    </style>
    </head>
    <body>

    <div class=\"container\">

    <img class=\"header\" src=\"http://key4design.co.uk/chandlers/images/chandlers_header.jpg\" width=\"996\" height=\"326\">

    <div class=\"customeraddress\">
    $leadname<br/>
    $business<br/>
    $address<br/>
    $town<br/>
    $postcode<br/>
    $date<br/>
    </div>
    <div class=\"clear\"></div>

    <div class=\"body-text\">
     $message</div>
    <div class=\"clear\"></div>
    <div class=\"footer\">
    <img class=\"footerimg\" src=\"http://key4design.co.uk/chandlers/images/chandlers_footer.jpg\" width=\"996\" height=\"261\">
    <div class=\"footerclear\"></div>
    </div>

    </body>
    </html>";
    $old_limit = ini_set("memory_limit", "16M");
    require_once("./pdf/config/lang/eng.php");
    require_once("./pdf/tcpdf.php");
    $pdf = new TCPDF("portrait", PDF_UNIT, "a3", true, "UTF-8", false);
    // set font
    $pdf->SetFont("helvetica", "", 10);
    // add a page
    $pdf->AddPage();
    $pdf->writeHTML($html, true, false, true, false, "");
    // reset pointer to the last page
    $pdf->lastPage();
    //Close and output PDF document
    if(!file_exists("./pdf/doc/file.pdf") || is_writable("./pdf/doc/file.pdf"))
    $pdf->Output("./pdf/doc/file.pdf", "F");
    else
    exit("./pdf/doc/file.pdf");
    ?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:53:48.710

似乎您只在页脚中添加了一个图像，为什么不使用[图像功能](http://www.tcpdf.org/doc/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352)

```
$pdf->AddPage();
$pdf->writeHTML($html, true, false, true, false, "");
$pdf->Image('http://key4design.co.uk/chandlers/images/chandlers_footer.jpg', 100, 350);
// reset pointer to the last page
$pdf->lastPage(); 
```

您可能必须禁用默认页脚

```
$pdf->setPrintFooter(false); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-18T11:43:00.673

```
$pdf->SetAutoPageBreak(false); 
```

这将防止 tcpdf 自动生成下一页，您可以在同一页面上调整页脚。

# javascript - 将十六进制字符串转换为 BYTE 数组 JS

> ID：10121507
> 
> 赞同：1
> 
> 时间：2012-04-12T10:08:52.357
> 
> 标签：javascript, node.js, websocket, socket.io

我已经有一段时间了，而且我是使用 JS 编程的新手。我正在使用 JS、HTML5、node 和 socket.io 制作游戏。我现在正在研究协议，我正在发送十六进制的服务器字符串。

字符串的示例是：00010203040506070809

我很难将其转换为：0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09

我打算做的是获取这些自定义数据包并根据这些数据包在我的服务器上进行切换。例如：

```
BYTE HEADER | + Packet
0x00        | 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 
```

然后我调用： parsepacket(header, data, len);

```
function parsepacket(header, data, len){
switch(header)
{
case '0x00':    // not hexed
console.log('The client wants to connect');
// Do some stuff to connect
break;

case '0x01':
console.log('0x01');
break;

case '0x02':
console.log('0x02!');
break;
}
}; 
```

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-12T10:24:27.277

我不确定这是您所追求的，但您可以将字符串转换为十六进制值数组，如下所示：

```
var str = "00010203040506070809",
    a = [];

for (var i = 0; i < str.length; i += 2) {
    a.push("0x" + str.substr(i, 2));
}

console.log(a); // prints the array
console.log(a.join(" ")); // turn the array into a string of hex values
​console.log(parseInt(a[1], 16));​ // parse a particular hex number to a decimal value 
```

# ruby-on-rails - 铁路协会有一个

> ID：10121511
> 
> 赞同：1
> 
> 时间：2012-04-12T10:09:11.970
> 
> 标签：ruby-on-rails, associations

我有麻烦需要您的帮助：有 1 个模型员工具有 1 个属性“employee_type”。一名员工只有一种类型。员工有 3 种类型（“初学者”、“普通”、“专业”，未来可能会增加）。所以我认为有3种方法可以实现它。

1.  employee_type 属性是字符串类型，它是“beginner”，或“normal”，或“pro”。然后在助手中，我需要在选择框视图中定义显示 3 类型的方法。这样，缺点是“每当我想添加更多类型时，我必须插入原始代码”
2.  创建只有 3 条记录“beginner”、“normal”、“pro”的employee_type 表。而employee_type属性为整型，保存employee_type表记录的id。employee 表和employee_type 表没有任何关联。用这种方式，优点是容易插入更多类型。缺点是“如果我想查找员工类型，我必须运行 EmployeeType.find(employee.employee_type)”
3.  创建employee_type 表，它与employee 有1-1 关系并使用has_one。通过这种方式，优势很容易通过employee.employee_type 找到员工类型。缺点是很难管理多少类型的员工

还有比他们更好的方法吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:26:38.463

这是一对多的情况。您必须使用以下方案：

```
class Employee < ...
  belongs_to :employee_type

class EmployeeType < ...
  has_many :employees 
```

# facebook - 在 Javascript SDK 中处理 Facebook 访问令牌过期

> ID：10121514
> 
> 赞同：3
> 
> 时间：2012-04-12T10:09:28.517
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我正在使用 Facebook Javascript SDK [http://developers.facebook.com/docs/reference/javascript/](http://developers.facebook.com/docs/reference/javascript/)来验证和批准我的 Facebook 应用程序。我的 SDK 代码如下：

```
window.fbAsyncInit = function() 
{
    FB.init({
        appId : 'MY_APP_ID', 
        status : true, // check login status
        cookie : true, // enable cookies to allow the server to access the session
        xfbml : true,  // parse XFBML
        oauth : true
    });

    FB.login(function(response) 
    {
        if (response.authResponse) 
        {
            var userFBAccessToken  =  response.authResponse.accessToken;
            console.log('userFBAccessToken: ' + userFBAccessToken);
            FB.api('/me', function(response) 
            {
                console.log('Good to see you, ' + response.name + '.');
                FB.logout(function(response) {
                    console.log('Logged out.');
                });
            });
        } else {
            console.log('User cancelled login or did not fully authorize.');
        }
    }, {scope: 'user_activities,user_notes,user_photos,user_videos,user_status,offline_access'});
};  

// Load the SDK Asynchronously
(function() {
    var e = document.createElement('script'); e.async = true;
    e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
    document.getElementById('fb-root').appendChild(e);
}()); 
```

我对offline_access 弃用感到困惑。我的问题是，如果我在我的应用程序高级设置页面中启用“弃用离线访问”选项：

1.  我从 response.authResponse.accessToken 收到的访问令牌的到期时间是多少。是2小时还是60天？（现在和 2012 年 5 月 1 日之后的持续时间是多少）

2.  如果只有 2 小时，我怎样才能将其延长到 60 天？

3.  检索到的访问令牌是仅在用户在线时有效，还是在用户离线时有效？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:32:17.270

1+2。有效期为2小时。到期后您将需要对其进行延期。此处在“客户端 OAuth 和通过新端点延长 Access_Token 到期时间”下解释了扩展请求： [https ://developers.facebook.com/roadmap/offline-access-removal/](https://developers.facebook.com/roadmap/offline-access-removal/)

1.  应始终有效。

# ios - 在 iPhone 应用程序上加密本地数据的最佳方法

> ID：10121519
> 
> 赞同：0
> 
> 时间：2012-04-12T10:09:44.070
> 
> 标签：ios, encryption

我有一个在 iPhone 上本地存储数据的应用程序。我想加密数据，所以我很困惑应该使用哪种方法。我在应用程序中使用了 Core Data 框架。

NSFileManager (NSFileProtectionKey)、CoreData (NSFileProtectionKey)、NSData (NSDataWritingOptions) 是选项，或者还有其他方法。请给我一些建议

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:20:35.630

使用[钥匙串服务](https://developer.apple.com/library/mac/#documentation/security/Reference/keychainservices/Reference/reference.html)。

但是您现在需要加密数据，您需要私钥或密码。然后我会说，只有当用户在使用您的应用程序时需要进行身份验证时，加密才有意义。然后您可以使用输入的密码对数据进行加密。在这里，您可以使用类似 PBKDF2 的函数对数据进行 AES256 加密，以生成加密密钥（感谢[Robert](https://stackoverflow.com/users/150978/robert)）。但是提供代码示例会走得很远。自己读！:)

但也要知道：从 iOS 4 开始，“磁盘”空间已经使用设备 PIN 进行了加密！

# mysql - 创建索引耗时过长

> ID：10121521
> 
> 赞同：15
> 
> 时间：2012-04-12T10:09:50.347
> 
> 标签：mysql, innodb

大约 2 个月前，我将 EnWikipedia 数据（http://dumps.wikimedia.org/enwiki/20120211/）导入 mysql。

导入 EnWikipedia 数据后，我在 mysql 中的 EnWikipedia 数据库的表中创建索引大约 2 个月。

现在，我已经到了在“pagelinks”中创建索引的地步。

但是，似乎需要无限的时间才能通过这一点。

因此，我检查了剩余的时间，以确保我的直觉正确与否。

结果，预计剩余时间为 60 天（假设我从头开始再次在“pagelinks”中创建索引。）

```
My EnWikipedia database has 7 tables: 
"categorylinks"(records: 60 mil, size: 23.5 GiB), 
"langlinks"(records: 15 mil, size: 1.5 GiB), 
"page"(records: 26 mil, size 4.9 GiB), 
"pagelinks"(records: 630 mil, size: 56.4 GiB), 
"redirect"(records: 6 mil, size: 327.8 MiB), 
"revision"(records: 26 mil, size: 4.6 GiB) and "text"(records: 26 mil, size: 60.8 GiB). 
```

我的服务器是... Linux 版本 2.6.32-5-amd64 (Debian 2.6.32-39)，内存 16GB，2.39Ghz Intel 4 core

创建索引需要这么长时间的普遍现象吗？有没有人有一个更好的解决方案来更快地创建索引？

提前致谢 ！

* * *

PS：我做了以下操作来检查剩余时间。

参考资料（对不起，下页是用日语写的）：[http ://d.hatena.ne.jp/sh2/20110615](http://d.hatena.ne.jp/sh2/20110615)

**第一个。我在“pagelink”中有记录。**

```
 mysql> select count(*) from pagelinks;
 +-----------+ 
 | count(*)  |
 +-----------+ 
 | 632047759 |
 +-----------+ 
 1 row in set (1 hour 25 min 26.18 sec) 
```

**第二。我得到了每分钟增加的记录数量。**

getHandler_write.sh

```
 #!/bin/bash

 while true
 do
   cat <<_EOF_
 SHOW GLOBAL STATUS LIKE 'Handler_write';
 _EOF_
   sleep 60
 done | mysql -u root -p -N 
```

命令

```
$ sh getHandler_write.sh
 Enter password:
 Handler_write   1289808074
 Handler_write   1289814597
 Handler_write   1289822748
 Handler_write   1289829789
 Handler_write   1289836322
 Handler_write   1289844916
 Handler_write   1289852226 
```

**第三。我计算了记录的速度。**

根据 2\. 的结果，记录的速度为

```
 7233 records/minutes 
```

**第四。那么剩余时间为**

```
 (632047759/7233)/60/24 = 60 days 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T10:23:27.003

这些是相当大的表，所以我预计索引会很慢。6.3 亿条记录是要索引的大量数据。需要注意的一件事是分区，如果数据集很大，没有正确分区的表，性能会很慢。这里有一些有用的链接： [在慢速索引上使用分区，](https://stackoverflow.com/questions/3695768/table-with-80-million-records-and-adding-an-index-takes-more-than-18-hours-or-f)您还可以尝试查看用于构建索引的缓冲区大小设置（默认为 8MB，对您的大表执行此操作会减慢您的速度。[缓冲区大小文档](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html#sysvar_myisam_sort_buffer_size)

# iphone - 运行扫描测试时出现 Zxing 错误

> ID：10121523
> 
> 赞同：1
> 
> 时间：2012-04-12T10:10:02.470
> 
> 标签：iphone, ios, zxing, barcode-scanner

**'text' 可能会被弃用，因为ZXingWidgetController.m**中的接收器类型未知

 **`[self presentResultForString:[twoDResult text]];
[self presentResultPoints:[twoDResult points] forImage:image usingSubset:subset];
[self performSelector:@selector(alertDelegate:) withObject:[[twoDResult text] copy] afterDelay:0.0]; decoder.delegate = nil;` 请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T14:40:47.033

见[问题 1198](http://code.google.com/p/zxing/issues/detail?id=1198)。

由于我无法复制它，所以它被关闭为无法复制。

评论表明这可能不是 svn 甚至 2.0 版本中的问题。（但我一直无法弄清楚“代码现代化”是什么意思。）

您提到的 github 存储库多年未更新。你可能最好使用[https://github.com/zxing/zxing](https://github.com/zxing/zxing)每隔几分钟从 svn 自动更新一次。**

# vba - 几个项目后 for-each 循环上的运行时错误 13

> ID：10121529
> 
> 赞同：1
> 
> 时间：2012-04-12T10:10:11.403
> 
> 标签：vba, excel, foreach, runtime-error

我正在尝试在 Outlook 的所有子文件夹中列出 Excel 中的所有电子邮件：

我已经搜索和研究了几个星期，但没有任何运气。

```
'Requires reference to Outlook library
Option Explicit

Public Sub ListOutlookFolders()

    Dim olApp As Outlook.Application
    Dim olNamespace As Outlook.Namespace
    Dim olFolder As Outlook.MAPIFolder
    Dim rngOutput As Range
    Dim lngCol As Long
    Dim olItem As Outlook.MailItem

    Dim rng As Excel.Range
    Dim strSheet As String
    Dim strPath As String

    Set rngOutput = ActiveSheet.Range("A1")

    Set olApp = New Outlook.Application
    Set olNamespace = olApp.GetNamespace("MAPI")

    For Each olFolder In olNamespace.Folders
        rngOutput = olFolder.Name
        rngOutput.Offset(0, 1) = olFolder.Description
        Set rngOutput = rngOutput.Offset(1)
        For Each olItem In olFolder.Items
            Set rngOutput = rngOutput.Offset(1)
            With rngOutput
                .Offset(0, 1) = olItem.SenderEmailAddress ' Sender
            End With
        Next

        Set rngOutput = ListFolders(olFolder, 1, rngOutput)
    Next

    Set olFolder = Nothing
    Set olNamespace = Nothing
    Set olApp = Nothing

End Sub

Function ListFolders(MyFolder As Outlook.MAPIFolder, Level As Integer, theOutput As Range) As Range        
    Dim olFolder As Outlook.MAPIFolder
    Dim olItem As Outlook.MailItem
    Dim lngCol As Long

    For Each olFolder In MyFolder.Folders
        theOutput.Offset(0, lngCol) = olFolder.Name
        Set theOutput = theOutput.Offset(1)

        If (olFolder.DefaultItemType = olMailItem) And (Not olFolder.Name = "Slettet post") Then
            For Each olItem In olFolder.Items
                If olItem.Class = olMail Then
                    With theOutput
                        .Offset(0, 1) = olItem.SenderEmailAddress ' Sender
                    End With
                    Set theOutput = theOutput.Offset(1)
                End If
            Next olItem <--- ERROR 13 here
        End If
        If olFolder.Folders.Count > 0 Then
            Set theOutput = ListFolders(olFolder, Level + 1, theOutput)
        End If
    Next olFolder
    Set ListFolders = theOutput.Offset(1)

End Function 
```

该代码可以正常运行 10-20 个项目，然后在上述行中给我一个运行时错误 13，当我点击调试时，它告诉我 olItem = Nothing ！？- 当我点击单步时，代码再次运行良好一段时间。

我试图插入“ON ERROR”，但我的列表不包含所有电子邮件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:36:23.913

我向你展示我的代码:)

更改
`Dim olItem As Outlook.MailItem`
为
`Dim olItem As Object`

并非所有文件夹项目都是邮件项目，因此请避免`olItem`以这种方式确定变量的尺寸。此更改在我的机器上运行良好，而最初我遇到了与您相同的错误

# wcf - 如何避免 wcf xml 响应中的 html 代码？

> ID：10121531
> 
> 赞同：0
> 
> 时间：2012-04-12T10:10:14.493
> 
> 标签：wcf

我写了一种获取详细信息的方法。在休息客户端得到这样的响应。

```
<string xmlns="http://schemas.microsoft.com/2003/10/Serialization/">&lt;Meetings&gt;&#xD;
&lt;Meeting&gt;&#xD;
&lt;Id&gt;1&lt;/Id&gt;&#xD;
&lt;Name&gt;Meeting1&lt;/Name&gt;&#xD;
&lt;Place&gt;SR Nagar&lt;/Place&gt;&#xD;
&lt;Time&gt;12/4/12 12:30pm&lt;/Time&gt;&#xD;
&lt;/Meeting&gt;&#xD;
&lt;Meeting&gt;&#xD;
&lt;Id&gt;2&lt;/Id&gt;&#xD;
&lt;Name&gt;Meeting2&lt;/Name&gt;&#xD;
&lt;Place&gt;Begumpet&lt;/Place&gt;&#xD;
&lt;Time&gt;12/4/12 1:00pm&lt;/Time&gt;&#xD;
&lt;/Meeting&gt;&#xD;
&lt;/Meetings&gt;&#xD;
</string> 
```

在呈现的 html 中变得正确。

```
<Meetings> <Meeting> <Id>1</Id> <Name>Meeting1</Name> <Place>SR Nagar</Place> <Time>12/4/12 12:30pm</Time> </Meeting> <Meeting> <Id>2</Id> <Name>Meeting2</Name> <Place>Begumpet</Place> <Time>12/4/12 1:00pm</Time> </Meeting> </Meetings> 
```

如何在 wcf 的代码中处理它以避免 <

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:14:27.853

您的服务操作返回`string`并且您正在将 XML 写入该字符串。它总是看起来像这样，浏览器正确显示它只是因为它隐藏`string`了标签并取消了内容。

要返回真正的 XML，您不能将`string`其用作返回值。尝试使用例如`XElement`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:20:39.847

在您的`[OperationContract]`方法中，不是返回一个字符串，而是返回一个`Meeting`对象数组。该类`Meeting`应包含您要返回的属性：

```
[DataContract]
public class Meeting
{
    [DataMember]
    public int Id { get; set; }
    [DataMember]
    public string Name { get; set; }
    [DataMember]
    public string Place { get; set; }
    // etc...
} 
```

如果您使用的是 .NET 4.0 及更高版本，则不需要`[DataContract]`and属性。`[DataMember]`

# c# - Wix 自定义操作结果未保存到文件

> ID：10121534
> 
> 赞同：1
> 
> 时间：2012-04-12T10:10:28.833
> 
> 标签：c#, wix

我创建了一个使用 SQL Server 数据库或本地 SQLite 数据库的 C# 应用程序。为了同步这两者，我创建了一个命令行转换器（也是 C#），它从 SQL Server 数据库创建 SQLite 文件。
一切正常，在 Wix 安装程序中，我不包含 SQLite 数据库文件。这可以节省空间并且更安全，因为数据库包含定价信息（SQL Server 在我们公司网络之外不可见）。在安装程序中，我创建了一个自定义操作来运行转换器（为清楚起见，简化了 XML）。

```
<CustomAction Id="SQLConvert"
              FileKey="SqlConverter.exe"
              ExeCommand="-sqlitefile:[INSTALLDIR]Database.db3"
              Execute="commit"
              Impersonate="yes"
              Return="ignore" />
<InstallExecuteSequence>
    <Custom Action="SQLConvert" Before="InstallFinalize">NOT REMOVE ~= "ALL"</Custom>
    <RemoveExistingProducts After="InstallFinalize" />
</InstallExecuteSequence> 
```

这将启动转换器（它不会隐藏运行），但找不到生成的文件（或日志）。文件保存在哪里？它应该已经保存在安装目录中。转换器通过 ExeCommand 选项获取此信息。

# memcached - 为什么 com.danga.MemCached.MemCachedClient 无法获取 net.rubyeye.xmemcached.XMemcachedClient 设置的值

> ID：10121537
> 
> 赞同：0
> 
> 时间：2012-04-12T10:10:47.630
> 
> 标签：memcached

作为标题。
我使用 net.rubyeye.xmemcached.XMemcachedClient 将值设置为 memcached 服务器使用的键“key1”。
但我无法取回使用 com.danga.MemCached.MemCachedClient 使用相同密钥的值。
此外，我还检查了 memcached 服务器中的真实密钥，密钥没有编码。
PS：键中没有特殊字符，只是简单的单词。
XMemcachedClient 版本：1.3.5
MemCachedClient 版本：2.5.0

# android - 如何隐藏EditText上的软键盘

> ID：10121539
> 
> 赞同：0
> 
> 时间：2012-04-12T10:10:52.177
> 
> 标签：android, android-softkeyboard, android-keypad

即使在“单击”时，我也想在 EditText 上隐藏软键盘。我的意思是说我的活动中不应该有可见的软键盘，因为我有自己的键盘来输入数据。请帮助我...谢谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:15:17.130

```
 editText_input_field.setOnTouchListener(otl);

 private OnTouchListener otl = new OnTouchListener() {
 public boolean onTouch (View v, MotionEvent event) {
        return true; // the listener has consumed the event
}
}; 
```

来源：[如何在android中单击edittext时阻止虚拟键盘？](https://stackoverflow.com/questions/1845285/how-to-block-virtual-keyboard-while-clicking-on-edittext-in-android)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:13:12.620

将 EditText 小部件的 inputType 设置为`null`这样，

```
editTExt.setInputType(TYPE_NULL); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-07T11:09:43.787

将以下代码粘贴到您的 xml 文件中的 edittext 标记下

```
android:textIsSelectable="true" 
```

# c# - 我可以从 Windows Phone 7 中的另一个 xaml 页面导航到数据透视项目吗？

> ID：10121544
> 
> 赞同：1
> 
> 时间：2012-04-12T10:11:13.260
> 
> 标签：c#, silverlight, windows-phone-7, xaml, pivot

我尝试使用此代码导航到另一个页面中的数据透视项，但它仍然无法正常工作

```
private void Nada1_Click(object sender, RoutedEventArgs e)
    {
        NavigationService.Navigate(new Uri("/Nada.xaml?PivotNada.SelectedIndex=0", UriKind.Relative));
    } 
```

谁能帮我 ？

之前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T11:03:24.190

我已经描述了如何在这里轻松完成（[http://wp7pivottest.codeplex.com](http://wp7pivottest.codeplex.com)上的示例项目） [http://invokeit.wordpress.com/2012/04/01/navigate-to-selected-pivot-item- wpdev-wp7dev/](http://invokeit.wordpress.com/2012/04/01/navigate-to-selected-pivot-item-wpdev-wp7dev/)

```
public enum PivotDef
{
   One,
   Two,
   Three,
   Four,
}

public static PivotDef SelectedPivot;

protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
{
   switch (SelectedPivot)
   {
      case PivotDef.One:
         this.pvtControl.SelectedItem = this.pvt1;
         break;

      case PivotDef.Two:
         this.pvtControl.SelectedItem = this.pvt2;
         break;

      case PivotDef.Three:
         this.pvtControl.SelectedItem = this.pvt3;
         break;

      case PivotDef.Four:
         this.pvtControl.SelectedItem = this.pvt4;
         break;
   }

   base.OnNavigatedTo(e);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-29T01:40:13.617

```
protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
{
  string strItemIndex;
  if (NavigationContext.QueryString.TryGetValue("goto", out strItemIndex))
  {
    myPivot0.SelectedIndex = Convert.ToInt32(strItemIndex);
  }
  base.OnNavigatedTo(e);
} 
```

请注意，这`myPivot0`是您的枢轴的名称（根据您的枢轴名称更改它）。然后，导航：

```
NavigationService.Navigate(new Uri("/ContactP.xaml?goto=0", UriKind.RelativeOrAbsolute)); 
```

其中`ContactP.xaml`包含枢轴。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T12:49:42.913

这是为您提供的解决方案。只需将以下代码添加到目标页面：

```
protected override void OnNavigatedTo(System.Windows.Navigation.NavigationEventArgs e)
{
    if (NavigationContext.QueryString.ContainsKey("PivotNada.SelectedIndex"))
    {
        int selectedIndex = -1;
        if(int.TryParse(NavigationContext.QueryString["PivotNada.SelectedIndex"].ToString(), out selectedIndex))
        {
            if(selectedIndex != -1)
            {
                pivot.SelectedIndex = selectedIndex;
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:28:16.170

将该索引值作为查询字符串传递，然后更新 onNNavigatedTo 函数中的 pivot.selectedindex 值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T10:30:08.183

您应该能够在 OnNavigatedTo 方法中设置选定的枢轴索引。也请查看[http://christian-helle.blogspot.co.uk/2011/02/working-around-pivot-selectedindex.html](http://christian-helle.blogspot.co.uk/2011/02/working-around-pivot-selectedindex.html)。

# windows - “区域设置”配置及其与 Windows API 的关系

> ID：10121548
> 
> 赞同：0
> 
> 时间：2012-04-12T10:11:41.890
> 
> 标签：windows, api, configuration, locale, createfile

系统的语言环境配置或该系统的键盘类型配置无论如何都会影响在内核级别调用哪个 API？具体来说，如果一个程序正在调用“CreateFile()”API，那么 Windows API 文档说明该调用被委托给 CreateFileA 或 CreateFileW。如果该程序正在中国的带有中文键盘的系统上运行，那么将调用这两个函数中的哪一个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:24:55.007

Unicode 和 Locale 是两个完全正交的概念。

关于`CreateFileA`vs `CreateFileW`- 控制它的设置是编译时设置：如果应用程序被编译为使用 Unicode 字符集运行，`CreateFileW`则将被调用，如果编译设置表明应用程序应编译为多字节应用程序，然后`CreateFileA`将被调用。

如果您使用的是 Visual Studio C++，请检查应用程序的项目设置。在配置属性下，在名为“常规”的页面上将设置“字符集” - 这可以设置为“使用 Unicode 字符集”或“使用多字节字符集”。此设置的效果是自动将另一个属性表添加到解决方案 - 在属性管理器下可见：“Unicode 支持”属性表添加了预处理器定义“ `_UNICODE,UNICODE`”-“多字节字符支持”属性表改为添加“_MBCS ”。

现在，如果您查看定义，`CreateFile`您会发现它本身就是一个宏，并且当您构建应用程序时，`CreateFile`代码中的所有调用都将解析为`CreateFileW`如果`UNICODE`已定义则`CreateFileA`调用，否则调用。

`UNICODE`用于`windows.h`在 Windows API 调用的 Wide 和 Ansi 版本之间切换。

`_MBCS`并被`_UNICODE`Microsoft C 运行时标头（主要是 tchar.h）用于将 c 库从支持单字节切换到多字节再到支持该功能的 unicode 字符。

# git - 没有 .git 扩展名的 git clone

> ID：10121553
> 
> 赞同：0
> 
> 时间：2012-04-12T10:11:55.943
> 
> 标签：git, ssh

我正在使用 git 和使用 ssh 的远程仓库。一切都很好。远程存储库是生产服务器，我想将“git push”到不应具有 .git 扩展名的上级目录。现在我如何在没有 .git 的情况下添加远程仓库？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:14:44.233

只需指定 git clone 命令的完整路径：

```
git clone <original-repo> <directory-path> 
```

如果远程仓库已经存在，它是否具有 .git 扩展名并不重要，将其添加为具有完整路径的远程仓库。

此外，您应该阅读有关部署 git 存储库的相关资源。比如[这个](http://toroid.org/ams/git-website-howto)

# javascript - Flash 嵌入是否被视为 Active X？

> ID：10121558
> 
> 赞同：1
> 
> 时间：2012-04-12T10:12:08.587
> 
> 标签：javascript, flash, activex, embedding

不确定这是否已经得到解答，但我想试一试。

我想知道，是什么原因导致 Active X 控件以及 Flash 嵌入是否会被视为一个控件？我正在使用 swfobject 嵌入闪存。

我没有在我的应用程序中嵌入任何 Windows Media Player 或 XHR。

那真的很有帮助。

谢谢。

K。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T00:07:56.110

在 Internet Explorer 中运行的 Flash Player 是一个 ActiveX 控件。

# c++ - std::thread - 命名你的线程

> ID：10121560
> 
> 赞同：67
> 
> 时间：2012-04-12T10:12:13.090
> 
> 标签：c++, multithreading, c++11

新的 C++ 有这个 std::thread 类型。奇迹般有效。现在我想给每个线程一个名称以便于调试（就像 java 允许的那样）。使用 pthreads 我会这样做：

```
pthread_setname_np(pthread_self(), "thread_name"); 
```

但是我怎么能用 c++0x 做到这一点？我知道它在 Linux 系统下使用 pthreads，但我想让我的应用程序可移植。有可能吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-04-12T10:19:33.647

一种可移植的方法是维护一个名称映射，以线程 ID 为键，从`thread::get_id()`. `thread_local`或者，如评论中所建议的，如果您只需要从线程内访问名称，则可以使用变量。

如果您不需要可移植性，那么您可以从中获取底层`pthread_t`代码`thread::native_handle()`并使用它做任何您喜欢的特定于平台的恶作剧。请注意，`_np`线程命名函数的意思是“非 posix”，因此不能保证它们在所有 pthreads 实现中都可用。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-05-27T21:36:49.340

尝试制作一个包装器来处理许多 Linux 和 Windows。请根据需要进行编辑。

```
#ifdef _WIN32
#include <windows.h>
const DWORD MS_VC_EXCEPTION=0x406D1388;

#pragma pack(push,8)
typedef struct tagTHREADNAME_INFO
{
   DWORD dwType; // Must be 0x1000.
   LPCSTR szName; // Pointer to name (in user addr space).
   DWORD dwThreadID; // Thread ID (-1=caller thread).
   DWORD dwFlags; // Reserved for future use, must be zero.
} THREADNAME_INFO;
#pragma pack(pop)

void SetThreadName(uint32_t dwThreadID, const char* threadName)
{

  // DWORD dwThreadID = ::GetThreadId( static_cast<HANDLE>( t.native_handle() ) );

   THREADNAME_INFO info;
   info.dwType = 0x1000;
   info.szName = threadName;
   info.dwThreadID = dwThreadID;
   info.dwFlags = 0;

   __try
   {
      RaiseException( MS_VC_EXCEPTION, 0, sizeof(info)/sizeof(ULONG_PTR), (ULONG_PTR*)&info );
   }
   __except(EXCEPTION_EXECUTE_HANDLER)
   {
   }
}
void SetThreadName( const char* threadName)
{
    SetThreadName(GetCurrentThreadId(),threadName);
}

void SetThreadName( std::thread* thread, const char* threadName)
{
    DWORD threadId = ::GetThreadId( static_cast<HANDLE>( thread->native_handle() ) );
    SetThreadName(threadId,threadName);
}

#elif defined(__linux__)
#include <sys/prctl.h>
void SetThreadName( const char* threadName)
{
  prctl(PR_SET_NAME,threadName,0,0,0);
}

#else
void SetThreadName(std::thread* thread, const char* threadName)
{
   auto handle = thread->native_handle();
   pthread_setname_np(handle,threadName);
}
#endif 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-04-12T10:16:01.457

您可以使用`std::thread::native_handle`来获取底层实现定义的线程。本机没有标准功能。

[你可以在这里](http://en.cppreference.com/w/cpp/thread/thread/native_handle)找到一个例子。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-01-16T20:23:29.317

对于windows [调试器]，你可以很容易地使用“正常”的方法； [http://msdn.microsoft.com/en-gb/library/xcb2z8hs.aspx](http://msdn.microsoft.com/en-gb/library/xcb2z8hs.aspx)

只需要您可以通过以下方式获取的线程ID

```
#include <windows.h>
DWORD ThreadId = ::GetThreadId( static_cast<HANDLE>( mThread.native_handle() ) ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-05-30T21:16:47.567

我都在早于 c++11 的系统中看到了这一点（我们基本上发明了我们自己的 Thread 类，它与 std::thread 非常相似）和我最近写的一个。

基本上，池实际上将 std::thread 向下放置了 2 层——你有一个 PoolThread 类，它包含一个 std::thread 以及它的名称、ID 等元数据以及将它链接到其控制池的控制结构，以及线程池本身。您想在大多数线程代码中使用线程池有几个原因：
1) 您可以对用户隐藏所有显式的“分离”、“加入”、在 std::thread 构造上启动线程等。这会产生更安全和更清洁的代码。
2) 更好的资源管理：线程过多会比线程过少更严重地削弱性能。构建良好的池可以执行高级操作，例如自动负载平衡和清理挂起或死锁的线程。
3) 线程重用：std::thread 本身最容易通过在自己的线程上运行每个并行任务来使用。但是线程创建和销毁很昂贵，如果你不小心的话，很容易淹没并行处理的速度提升。因此，让池线程从队列中提取工作任务并仅在接收到某些信号后退出通常更有意义。
4) 错误处理：std::thread 只是一个执行上下文。如果您正在运行的任务引发未处理的异常或 std::thread ITSELF 失败，则该进程将在那里崩溃。要进行容错多线程，您需要一个 Pool 或类似的东西，它可以快速捕获此类事情并至少在进程终止之前发出有意义的错误消息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-02T14:52:16.900

在头文件中执行：

```
const std::string & ThreadName(const std::string name=""); 
```

在 src 文件中执行：

```
const std::string & ThreadName(const std::string name)
{
    static std::atomic_int threadCount{0};
    const thread_local std::string _name = name + std::to_string(threadCount.fetch_add(1));
    return _name; 
} 
```

用法：

```
void myThread()
{
   ThreadName("myThread"); // Call once at very beginning of your thread creation
   ...
   std::cout << ThreadName() << std::endl; // Anyplace in your code
} 
```

# c# - 在运行时加载和执行程序集

> ID：10121564
> 
> 赞同：0
> 
> 时间：2012-04-12T10:12:33.457
> 
> 标签：c#, load, runtime, .net-assembly

我有一个应用程序需要在运行时加载和执行程序集。

加载项或插件方法在我的情况下不起作用，因为程序集的数量将达到数百个，并且将在运行时加载和执行适当的程序集。

我正在寻找两件事：

*   加载和执行其内部结构在编译时我知道的程序集的示例代码。
*   确保加载程序集的稳定性性能和安全性或真实性的最佳实践。

我的应用程序代码逻辑如下所示：

```
public static void Main()  
{  
    foreach (string filename in directory.GetFiles())  
    {  
        Assembly assembly = LoadAssemblyFromFile(filename);  
        object instance = CreateInstanceOfClassXyzInAssembly(assembly);  
        instance.CallSomeMethodWithKnownInterface();  
        instance = null;  
        UnloadAssembly(assembly);  
    }  
} 
```

# c# - System.IO.File' 不包含 Unity3D 中“AppendAllText”错误的定义？

> ID：10121565
> 
> 赞同：4
> 
> 时间：2012-04-12T10:12:39.897
> 
> 标签：c#, monodevelop, xamarin.android, unity3d

我对 Unity3d 非常陌生，并试图打开一个现有项目。播放时显示以下错误。

资产/脚本/DataAccess.cs(39,30)：错误 CS0117：`System.IO.File' does not contain a definition for`AppendAllText'

我不知道如何解决这个问题。我被困在这里。

如果有人解决这个问题，将不胜感激。

提前致谢...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T19:51:04.883

我遇到了这个问题，我的团队中没有其他人可以复制它。

我们的目标是 iOS 平台，出于某种原因，我的 Build 设置神奇地变回了 Web Player。将此 BACK 更改为 iOS 为我解决了这个问题。

在 Mac 上，我去了 File ==> Build Settings...

“Unity”图标在 Web Player 旁边，所以我将其切换到 iOS 并点击“Switch Platform”按钮。它重新导入了一堆东西，完成后，编译器错误消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T12:03:49.240

你可以试试[`File.AppendText`](http://msdn.microsoft.com/en-us/library/system.io.file.appendtext.aspx)：

```
using(StreamWriter sw = File.AppendText(
          Application.persistentDataPath + "error.log"))
{
    sw.Write(e.ToString());
} 
```

这可能不是最好的方法，但它应该有效。我不知道 AppendAllText 是否包含隐式换行符-从文档中似乎没有-但您可能想要`.WriteLine`。

# php - 将 JSON 转换为多维 JavaScript 数组

> ID：10121569
> 
> 赞同：1
> 
> 时间：2012-04-12T10:12:51.590
> 
> 标签：php, javascript, json

我从服务器收到如下 JSON：

```
{"0":{"0":"image1.jpg","1":"texthere","2":"0"},"1":{"0":"image66.jpg","1":"texthere","2":"1"},"2":{"0":"image12.jpg","1":"texthere","2":"2"},"3":{"0":"image44.jpg","1":"texthere","2":"3"},"4":{"0":"image34.jpg","1":"texthere","2":"4"},"5":{"0":"image33.jpg","1":"texthere","2":"5"},"6":{"0":"image21.jpg","1":"texthere","2":"6"},"7":{"0":"image32.jpg","1":"texthere","2":"7"},"8":{"0":"image13.jpg","1":"texthere","2":"8"},"9":{"0":"image11.jpg","1":"texthere","2":"9"},"10":{"0":"image03.jpg","1":"texthere","2":"10"},"length":"12"} 
```

编写此代码的开发人员使用[JSON_FORCE_OBJECT](http://php.net/manual/de/function.json-encode.php)作为 PHP 中 json_encode 方法的参数。

在 JavaScript 中是否有任何“魔法”（即，不是自定义函数）将此结构转换为多维数组？

我想要类似的东西：

```
[["image1.jpg","texthere","2"],["image66.jpg","texthere","1"]]... 
```

免责声明： - 我正在寻找本机实现（不是 JQuery）；- PHP 最终可以更改（如果需要）；

任何帮助表示赞赏，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:21:24.367

不是魔术，但您可以遍历数据并测试它具有什么类型的值。

一个基本的例子如下。不过，它没有我想要在生产代码中进行的错误检查。

```
var data = {"0":{"0":"image1.jpg","1":"texthere","2":"0"},"1":{"0":"image66.jpg","1":"texthere","2":"1"},"2":{"0":"image12.jpg","1":"texthere","2":"2"},"3":{"0":"image44.jpg","1":"texthere","2":"3"},"4":{"0":"image34.jpg","1":"texthere","2":"4"},"5":{"0":"image33.jpg","1":"texthere","2":"5"},"6":{"0":"image21.jpg","1":"texthere","2":"6"},"7":{"0":"image32.jpg","1":"texthere","2":"7"},"8":{"0":"image13.jpg","1":"texthere","2":"8"},"9":{"0":"image11.jpg","1":"texthere","2":"9"},"10":{"0":"image03.jpg","1":"texthere","2":"10"},"length":"12"};

function data_to_array(data) {
    var array = [];
    for (var key in data) {
        var value = data[key];
        if (typeof value === 'string') {
            array[key] = value;
        } else {
            array[key] = data_to_array(value);
        }
    }
    return array;
}

var array = data_to_array(data);
console.log(array); 
```

`hasOwnProperty`如果您的对象原型可能被弄乱，请确保添加检查。您可能还应该添加一个检查以确保仅将整数键添加到数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:29:47.590

我能想到的最简单的方法是使用正则表达式将 JSON 从对象文字转换为数组文字。

不幸的是，西蒙考威尔比这种方法更神奇。

```
//I don't know why you don't want a custom function.
function dataToArray(data)
{
    data = data.replace(/"[0-9]+":/g,"");          //Remove all index keys
    data = data.replace(/,"length":"[0-9]+"/g,""); //Remove length key-value pair
    data = data.replace(/{/g,"[");                 //Change the left brackets
    data = data.replace(/}/g,"]");                 //Change the right brackets

    return JSON.parse(data);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:53:48.980

没有内置函数。如果你有 JSON 字符串，你可以做字符串替换，否则你必须循环如下所示。

```
var dataObject = {"0":{"0":"image1.jpg","1":"texthere","2":"0"},"1":{"0":"image66.jpg","1":"texthere","2":"1"},"2":{"0":"image12.jpg","1":"texthere","2":"2"},"3":{"0":"image44.jpg","1":"texthere","2":"3"},"4":{"0":"image34.jpg","1":"texthere","2":"4"},"5":{"0":"image33.jpg","1":"texthere","2":"5"},"6":{"0":"image21.jpg","1":"texthere","2":"6"},"7":{"0":"image32.jpg","1":"texthere","2":"7"},"8":{"0":"image13.jpg","1":"texthere","2":"8"},"9":{"0":"image11.jpg","1":"texthere","2":"9"},"10":{"0":"image03.jpg","1":"texthere","2":"10"},"length":"12"};

function getArray(object){
     var array = [];
     for(var key in object){
        var item = object[key];
        array[parseInt(key)] = (typeof(item) == "object")?getArray(item):item;
     }
     return array;
}

var dataArray = getArray(dataObject); 
```

# c++ - 安全快速的 FFT

> ID：10121574
> 
> 赞同：15
> 
> 时间：2012-04-12T10:13:13.780
> 
> 标签：c++, performance, c++11, fft

受到 Herb Sutter 引人入胜的演讲[Not your Father's C++](http://channel9.msdn.com/Events/Lang-NEXT/Lang-NEXT-2012/-Not-Your-Father-s-C-)的启发，我决定使用 Microsoft 的 Visual Studio 2010 再看看最新版本的 C++。Herb 声称 C++ 是“安全且快速”的，我特别感兴趣，因为我写了很多性能关键代码。

作为基准，我决定尝试用多种语言编写相同的简单 FFT 算法。

我想出了以下使用内置`complex`类型和`vector`集合的 C++11 代码：

```
#include <complex>
#include <vector>

using namespace std;

// Must provide type or MSVC++ barfs with "ambiguous call to overloaded function"
double pi = 4 * atan(1.0);

void fft(int sign, vector<complex<double>> &zs) {
    unsigned int j=0;
    // Warning about signed vs unsigned comparison
    for(unsigned int i=0; i<zs.size()-1; ++i) {
        if (i < j) {
            auto t = zs.at(i);
            zs.at(i) = zs.at(j);
            zs.at(j) = t;
        }
        int m=zs.size()/2;
        j^=m;
        while ((j & m) == 0) { m/=2; j^=m; }
    }
    for(unsigned int j=1; j<zs.size(); j*=2)
        for(unsigned int m=0; m<j; ++m) {
            auto t = pi * sign * m / j;
            auto w = complex<double>(cos(t), sin(t));
            for(unsigned int i = m; i<zs.size(); i+=2*j) {
                complex<double> zi = zs.at(i), t = w * zs.at(i + j);
                zs.at(i) = zi + t;
                zs.at(i + j) = zi - t;
            }
        }
} 
```

请注意，此函数仅适用于`n`-element 向量，其中`n`是 2 的整数幂。任何寻找适用于任何人的快速 FFT 代码的人都`n`应该查看[FFTW](http://www.fftw.org/)。

据我了解，`xs[i]`C 中用于索引 a 的传统语法`vector`不进行边界检查，因此不是内存安全的，并且可能成为内存错误的来源，例如非确定性损坏和内存访问违规。所以我`xs.at(i)`改用了。

现在，我希望这段代码“安全且快速”，但我不是 C++11 专家，所以我想要求改进这段代码，使其更加惯用或高效？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-12T10:58:14.083

我认为您在使用 at() 时过于“安全”。在大多数情况下，使用的索引很容易验证，因为它受到 for 循环中容器大小的限制。

例如

```
 for(unsigned int i=0; i<zs.size()-1; ++i) { 
    ...
    auto t = zs.at(i); 
```

我唯一留下的 at()s 是 (i + j)s。它们是否总是受到约束并不是很明显（尽管如果我真的不确定我可能会手动检查 - 但我对 FFT 的熟悉程度不足以在这种情况下发表意见）。

每次循环迭代也会重复一些固定计算：

```
int m=zs.size()/2;
pi * sign
2*j 
```

并且 zs.at(i + j) 被计算了两次。

优化器可能会捕获这些 - 但如果您将此视为性能关键，并且您有计时器对其进行测试，我会将它们提升到循环之外（或者，在 zs.at(i + j ），只需在第一次使用时参考），看看这是否会影响计时器。

谈到第二次猜测优化器：我确信对 .size() 的调用将被内联，至少是对内部成员变量的直接调用 - 但考虑到你调用它的次数，我也会尝试预先为 zs.size() 和 zs.size()-1 引入局部变量。它们也更有可能以这种方式被放入寄存器中。

我不知道所有这些对您的总运行时间有多大影响（如果有的话） - 其中一些可能已经被优化器捕获，并且与所涉及的计算相比差异可能很小 - 但值得射击。

至于习惯用语，我唯一的评论是 size() 返回一个 std::size_t （这通常是 unsigned int 的 typedef - 但使用该类型更习惯用语）。如果您确实想使用 auto 但避免警告，您可以尝试将 ul 后缀添加到 0 - 不过我不确定我会说这是惯用的。我想您在这里不使用迭代器已经不太习惯了，但是我可以理解为什么您不能（轻松地）这样做。

**更新**

我尝试了我所有的建议，它们都有可衡量的性能改进——除了 i+j 和 2*j 预计算——它们实际上导致了轻微的减速！我认为他们要么阻止了编译器优化，要么阻止了它在某些事情上使用寄存器。

总的来说，我得到了 > 10% 的性能。这些建议的改进。我怀疑如果对第二个循环块进行一些重构以避免跳转，那么可能会有更多 - 并且这样做启用 SSE2 指令集可能会带来显着的提升（我确实按原样尝试过，并看到了轻微的减速）。

我认为重构以及在 cos 和 sin 调用中使用 MKL 之类的东西应该会带来更大、更不脆弱的改进。而且这些东西都不会依赖于语言（我知道这最初是与 F# 实现进行比较的）。

**更新 2**

我忘了提到预先计算 zs.size()*确实*有所作为。

**更新 3**

还忘了说（直到@xeo 在对 OP 的评论中提醒） i < j 检查之后的块可以归结为 std::swap。这更惯用并且至少具有相同的性能 - 在最坏的情况下应该内联到与编写相同的代码。事实上，当我这样做时，我发现性能没有任何变化。在其他情况下，如果移动构造函数可用，它可能会导致性能提升。

# javascript - 如何在没有 Flash 的情况下使用 PHP 上传任何背景图像中的图像？

> ID：10121577
> 
> 赞同：0
> 
> 时间：2012-04-12T10:13:27.580
> 
> 标签：javascript, file-upload

![在此处输入图像描述](../Images/e21b49651564f31db86f29985593707e.png)

首先，我将使用鼠标选择区域（显示为黄色背景的区域），然后我想使用 Uplodify 或 ajax 函数上传图像。

如何使用 PHP 选择该区域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T06:42:44.180

您可以使用 javascript 函数来执行此功能...

有了这个，你必须使用PHP的图像功能......

# c - 如何识别两个不同版本的gcc是否兼容？

> ID：10121578
> 
> 赞同：9
> 
> 时间：2012-04-12T10:13:33.153
> 
> 标签：c, gcc

有时我会从不同的设计团队获得库。一个使用 gcc 3.x，另一个使用 gcc 4.x。如何确定这两个库是否兼容？我知道这是 libstdc++ 的问题，但你能给我一个明确的答案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:21:11.337

这是一个很好的起点

[http://gcc.gnu.org/onlinedocs/gcc/Compatibility.html](http://gcc.gnu.org/onlinedocs/gcc/Compatibility.html)

本文讨论了不同工具之间的二进制兼容性（它也可以应用于库）。当不同的工具是不同版本的 gcc 时，这仍然适用。要检查的一件主要事情是应用程序二进制接口 (ABI) 一致性。

这个[SO 帖子](https://stackoverflow.com/questions/2801938/gcc-abi-compatibility)说，因为 GCC 3.4.0 ABI 是向前兼容的。IE 使用较旧版本制作的库可以与较新版本链接，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:26:53.407

此命令可能会有所帮助：

> 字符串 - YourProgram | grep 海合会

# php - 显示来自 MySQL 的数据的 jQuery 下拉菜单

> ID：10121579
> 
> 赞同：0
> 
> 时间：2012-04-12T10:13:43.423
> 
> 标签：php, jquery, mysql, menu, drop-down-menu

我正在尝试在我的网站上开发一项功能，该功能会自动从我的表格中获取可用的路线并将它们填充到 jQuery 自动完成文本框中，该文本框会在输入时显示结果

我已经设法将查询放在一起，并且效果很好……但是没有添加 jQuery

这是自己的代码

```
<?PHP  
mysql_connect('localhost', 'sample', 'sample'); 
mysql_select_db('winning'); 
$sql = "SELECT distinct rout_to FROM search_v ORDER BY rout_to ASC" ; 
$result = mysql_query($sql); 
echo '<div class="ui-widget"><select id="combobox" name="arrival_label">'; 
while ($row = mysql_fetch_array($result)) echo "<option value='" . $row['rout_to'] . "'>" . $row['rout_to'] . "</option>"; 

echo "</select></div>"; ?> 
```

当我从 jquery ui 库中测试自动完成组合框时，它自己运行良好，没有 php 数据

我的问题是，我怎样才能让这两个玩得很好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:27:37.670

```
<?php
    $autocomplete = array();
    mysql_connect('localhost', 'sample', 'sample'); 
    mysql_select_db('winning');
    $sql = mysql_query('SELECT distinct rout_to FROM search_v ORDER BY rout_to ASC');
    $r = $db->query($q);
    while ($row = mysql_fetch_array($result))
      $autocomplete[] = $row['rout_to'];
    }
?>
<script type="text/javascript">
  $(function() {
    var availableItems = [ <?php print '"'.implode('","', $autocomplete).'"'; ?> ];
    $("#combobox").autocomplete({
      source: availableItems,
      minLength: 3
    });
  });
</script> 
```

注意：刚刚写出来，可能需要定制。

编辑：在您的 HTML 中，您需要一个`input`带有 id 的元素`combobox`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:38:56.610

您可能想尝试使用 Jquery UI 的自动完成插件。

```
<?php
    $autocomplete = array();
    mysql_connect('localhost', 'sample', 'sample'); 
    mysql_select_db('winning');
    $sql = mysql_query('SELECT distinct rout_to FROM search_v ORDER BY rout_to ASC');
    $r = $db->query($q);
    while ($row = mysql_fetch_array($result))
      $autocomplete[] = $row['rout_to'];
    }
?>
<script>
    $(function() {
        var availableTags = [
          <?php foreach($autocomplete as $a){
              echo '"'.$a.'",';
          }?>
        ];
        $( "#tags" ).autocomplete({
            source: availableTags
        });
    });
</script> 
```

HTML 代码：

```
<div class="ui-widget">
    <label for="tags">Tags: </label>
    <input id="tags">
</div> 
```

我认为在这种情况下，您将不再使用选择标签而是输入标签。我希望它有所帮助。

谢谢，戴夫

# c# - 带有自定义过滤器的自定义 Arrayadapter

> ID：10121581
> 
> 赞同：2
> 
> 时间：2012-04-12T10:13:56.357
> 
> 标签：c#, xamarin.android, android-arrayadapter

我将简要回顾一下我正在尝试做的事情：我想用我自己的对象填充 AutoCompleteTextView 的 DropDown。这些对象包含 3 个字符串。在 list_item_view 中应该是 2 个字符串。这个列表应该是可过滤的。

现在一些代码，我到目前为止所做的：

我的 CustomAdapter 看起来像这样：

```
public class CustomerAdapter : ArrayAdapter<CustomerSingle>, IFilterable
{
    private ws_test.Test ws=null;
    public static List<CustomerSingle> _contactList;
    private Activity _activity;
    private CustomerAdapterFilter filter = null;

    public CustomerAdapter(Activity activity, Context context,int resourceId)//List<CustomerSingle> assets)
    :base(context,resourceId)//,assets)
    {
        _activity = activity;
        ws=new ws_test.Test();
        _contactList = new List<CustomerSingle>();
    }

    public static List<CustomerSingle> getCustomerList()
    {
        return _contactList;
    }

    public void Add(CustomerSingle item)
    {
         _contactList.Add(item);
    }

    public override int Count
    {
        get { return _contactList.Count; }
    }

    public override long GetItemId(int position)
    {
        return _contactList[position].id;
    }

    public override View GetView(int position, View convertView, ViewGroup parent)
    {
        var view = convertView ?? _activity.LayoutInflater.Inflate(Resource.Layout.details, parent, false);
        var contactName = view.FindViewById<TextView>(Resource.Id.Name);
        var contactAddress = view.FindViewById<TextView>(Resource.Id.Address);
        contactName.Text = _contactList[position].name;// +"\n" + _contactList[position].address;
        contactAddress.Text = _contactList[position].address;

        return view;
    }

    public override Filter Filter
    {
        get
        {
            return new CustomerAdapterFilter();
        }
    }

    public override void NotifyDataSetChanged()
    {
        base.NotifyDataSetChanged();
    }

    public override void NotifyDataSetInvalidated()
    {
        base.NotifyDataSetInvalidated();
    }
} 
```

CustomerSingle 看起来像这样：

```
public class CustomerSingle
{
    public string no { get; set; }
    public string name { get; set; }
    public string address { get; set; }
    public int id { get; set; }

    public CustomerSingle(string no, string name, string address, int id)
    {
        this.address = address;
        this.name = name;
        this.no = no;
        this.id = id;
    }
} 
```

好的，现在我需要一个自己的过滤器我在这里尝试做的事情：

```
public class CustomerAdapterFilter:Filter
{
    protected object mLock = new object();
    protected List<CustomerSingle> mOriginalValues = null;

    protected override FilterResults PerformFiltering(Java.Lang.ICharSequence prefix)
    {

        FilterResults results = new FilterResults();
        if (mOriginalValues == null) {
            lock(mLock) {
                mOriginalValues = new List<CustomerSingle>(CustomerAdapter._contactList);

            }
        }

        if (prefix == null || prefix.Length() == 0) {
            lock (mLock) {
                List<CustomerSingle> list = new List<CustomerSingle>(mOriginalValues);
                IntPtr listptr = list.
                results.Values = list;
                results.Count = list.Count;
            }
        } else {
            String prefixString = prefix.ToString().ToLowerInvariant();

            List<CustomerSingle> values = mOriginalValues;
            int count = values.Count;

            List<CustomerSingle> newValues = new List<CustomerSingle>(count);

            for (int i = 0; i < count; i++) {
                CustomerSingle value = values.ElementAt(i);
                String valueText = value.ToString().ToLowerInvariant();

                // First match against the whole, non-splitted value
                if (valueText.StartsWith(prefixString)) {
                    newValues.Add(value);
                } else {
                    String[] words = valueText.Split(' ');
                    int wordCount = words.Length;

                    for (int k = 0; k < wordCount; k++) {
                        if (words[k].StartsWith(prefixString)) {
                            newValues.Add(value);
                            break;
                        }
                    }
                }
            }

            results.Values = (Object) newValues;
            results.Count = newValues.Count;
        }

        return results;
    }

    protected override void PublishResults(Java.Lang.ICharSequence constraint, Filter.FilterResults results)
    {
        //noinspection unchecked
        var mObjects = results.Values;
        if (results.Count > 0)
        {
            NotifyDataSetChanged();
        }
        else
        {
            notifyDataSetInvalidated();
        }
    }
} 
```

我的问题是，我无法从 Java.Lang.Object 转换为我的 CustomerSingle...有人有想法吗？

谢谢！

更新：我在过滤器中更改为 JavaList 并在 CustomerSingle 处对 Java.Lang.Object 进行了扩展

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T14:31:22.857

使您的 CustomerSingle 类成为 Java.Lang.Object 的子类：

`public class CustomerSingle : Java.Lang.Object`

更新：

我的猜测是这一行：

`results.Values = (Object) newValues;`

正在尝试转换为 System.Object 而不是 Java.Lang.Object，请尝试 (Java.Lang.Object) 代替。

# jquery - 如何将类名传递给选择器？

> ID：10121584
> 
> 赞同：0
> 
> 时间：2012-04-12T10:14:10.467
> 
> 标签：jquery, asp.net, asp.net-mvc-3

我的表中有一个按钮，我想在单击按钮时删除一个完整的行。？请不要尝试修改我使用的逻辑。

目前，当单击按钮时，我得到了它`id`，并且基于此，`id`我需要从具有相同类名的 DOM 中删除一个元素（完整行）。

JavaScript

```
$(".removeAKA").click(function () {
    // alert($(this).val());
    var id = this.id;
    alert(id);
    $("." + id).remove();
}); 
```

​HTML

```
<tr class="aka 1" id="sdf">
  <td>AKA 1</td>
  <td><input class="text-box single-line" id="aka_1_" name="aka[1]" type="text" value="2" /></td>
  <td><input type="button" class="removeAKA" id="aka 1" value="Delete" /></td>
</tr>​ 
```

[这是我在 jsfiddle 中的代码](http://jsfiddle.net/EFmRM/4/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:28:52.130

如果您想保留空格，请**演示：** [http](http://jsfiddle.net/59RA2/9/) : //jsfiddle.net/59RA2/9/**或** [http://jsfiddle.net/59RA2/31/](http://jsfiddle.net/59RA2/31/) **或** [http://jsfiddle.net/59RA2/32/](http://jsfiddle.net/59RA2/32/)

希望这可以帮助。

我已将空格替换为，`.`因为当 Jquery 尝试解释您的代码时无法识别空格。

**或者**

您还可以使用`$(this).closest('tr').remove();`删除行。

**或者** 您可以使用 `$("table ."+id).remove();`

更远：

[jQuery：选择器（带空格的类名）](https://stackoverflow.com/questions/1988483/jquery-selector-question-classname-with-space)

[jQuery删除具有非标准id字符的表格行](https://stackoverflow.com/questions/4382832/jquery-remove-table-row)

**引用**

> 类名中不能有空格。你有两个类：
> 
> 这个 div 有两个类：panel 和 current。这很容易选择：
> 
> $("div.panel.current")... 这意味着选择所有具有类面板和类当前的 div。

**代码**

只需将空格替换为 . 如果您愿意，它会起作用，否则您之间不能有空格。

祝你好运，加油！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:41:57.470

try

```
$(this).parent().remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T11:45:13.853

删除 id 和 classname 中的空格。这不是正确的命名约定。使用 'aka1' 或 'aka_1' 而不是 'aka 1' 。然后你的代码就可以工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T04:24:01.857

试试这个...

```
$(this).parent().remove(); 
```

我已经在 jsfiddle 中测试了这个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T10:21:06.623

类名和 ID 中不能有空格。删除空格，正确格式化您的 HTML，它将起作用。

你的例子：http: [//jsfiddle.net/EFmRM/7/](http://jsfiddle.net/EFmRM/7/)

孤立的例子：http: [//jsfiddle.net/Pz5pF/](http://jsfiddle.net/Pz5pF/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-12T10:22:52.307

尝试这个

```
$(".removeAKA").click(function () { 
   $(this).remove();
}); 
```

//id不能包含空格

# sql - 当您使用别名引用字段时，为什么 SQL UPDATE FROM 会静默失败？

> ID：10121591
> 
> 赞同：1
> 
> 时间：2012-04-12T10:14:34.740
> 
> 标签：sql, postgresql

昨天我发现了一些关于 SQL 的奇怪之处，或者至少是**PostreSQL**。看看下面并解释为什么第一个查询什么都不做，而第二个查询正好。

```
-- this silently does nothing
update bodycontent 
    set body = replace(body, '~' || u.oldusername, '~' || u.newusername)
    from usermigration u;

-- this works as expected
update bodycontent 
    set body = replace(body, '~' || oldusername, '~' || newusername)
    from usermigration u; 
```

更新：我认为每个人都忽略了这个问题的重点，笛卡尔积是一个原始意图：将会有 N x M 更新，这是设计使然。

我需要从 bodycontent.xml 替换迁移表中每一行中存在的所有用户名对。

而且，我再说一遍，第二个版本按预期工作，但第一个版本没有更新。我只想知道为什么。

```
| usermigration table    |
--------------------------
oldusername | newusersname
--------------------------
johndoe     | johnd
john.smith  | johnsmith 
```

这是 PostgreSQL 中的错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T15:06:26.097

您缺少**WHERE**子句（不能写为直接`JOIN`条件）。附加表`usermigration`必须以某种方式绑定到`bodycontent`要更新的表，或者每一行`bodycontent`都有与其中行一样多的更新候选`usermigration`- 两个表之间的笛卡尔积。

没有办法知道哪个会被应用并坚持下去。在这方面，两种说法都是错误的。例如，如果其中有 1000 行，`usermigration`其中 1000 行将`bodycontent`导致**1 000 000**个更新候选者，然后可以选择 1000 个。

如果你在一个语句中加入一个或多个表，那么如果没有一个子句将子句的结果连接到更新的表，`UPDATE`它**几乎没有任何意义。**`WHERE``FROM`

考虑[手册中有关 UPDATE 语句](http://www.postgresql.org/docs/current/interactive/sql-update.html)的这些**注释**：

> 当存在 FROM 子句时，实质上发生的情况是目标表连接到 from_list 中提到的表，连接的每个输出行代表目标表的更新操作。使用 FROM 时，应确保连接为要修改的每一行生成最多一个输出行。换句话说，目标行不应连接到来自其他表的多个行。如果是这样，那么只有一个连接行将用于更新目标行，但将使用哪一个是不容易预测的。

请注意，语句`FROM`中的子句`UPDATE`是对 SQL 标准的**PostgreSQL 扩展。**其他 DBMS 使用不同的语法，例如`JOIN`要更新的表的显式 s（在 tSQL 中）不适用于 PostgreSQL。

* * *

### 回答评论中的其他问题

这个查询应该可以工作，***主要是***¹

```
UPDATE bodycontent b
SET    body = replace(b.body, u.oldusername, u.newusername)
FROM   usermigration u
WHERE  b.body LIKE ('%' || u.oldusername || '%'); 
```

¹结果还是**模棱两可**。可以找到多个匹配项。不确定，将应用哪一个。问题是您的**要求本质上是模棱两可的**。可以有多个（重叠）匹配的用户名，并且应用更新的**顺序**是相关的（但未定义）。该`UPDATE`声明完美地反映了您有缺陷的要求。

这`'~' ||`部分是怎么回事？

# jquery - Adobe Flex 是开源的吗？

> ID：10121594
> 
> 赞同：0
> 
> 时间：2012-04-12T10:14:40.030
> 
> 标签：jquery, apache-flex, extjs, adobe

我想知道 Adob​​e Flex 开源和免费意味着任何人都可以使用和销售使用 Flex 开发的产品吗？我擅长逻辑，但每当涉及 UI、布局、设计、CSS 时，我在这方面就很差。我想要一个可以解决我的 UI 相关问题的解决方案。我知道 jQuery，但是这有助于我只提供网格等小部件，我想要解决方案，让我免于担心 UI 相关问题。

Adobe Flex是可以解决我问题的产品吗？我也很期待 extjs，作为一个 jQuery 开发者，我学习 extjs 容易吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T14:31:31.743

> 我想知道adobe flex是开源的

是的，大部分 Adob​​e Flex 都在[Mozilla 公共许可](http://opensource.adobe.com/wiki/display/flexsdk/Legal+Stuff)下可用。

> 意味着任何人都可以使用和销售使用 flex 开发的产品？

这是正式向您的律师提出的问题。但是，我相信是的，并且有一家销售商业[Flex Components](http://www.flextras.com)的企业。

随着[Flex 迁移到 Apache](http://incubator.apache.org/flex/)，Flex 的大部分内容将在[Apache 2.0 许可](http://www.apache.org/licenses/LICENSE-2.0.html)下发布。许多人认为它比 Mozilla 公共许可证更自由。

但是，我不是律师，这不构成法律建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:32:26.450

所有关于许可的信息都可以在这里找到：http: [//opensource.adobe.com/wiki/display/flexsdk/Legal+Stuff](http://opensource.adobe.com/wiki/display/flexsdk/Legal+Stuff)

# c - 如何使用指向数组的指针访问未知大小的二维数组

> ID：10121600
> 
> 赞同：0
> 
> 时间：2012-04-12T10:14:48.907
> 
> 标签：c, multidimensional-array

我正在为一个新项目修改现有代码。我被指示删除动态内存分配并使用静态声明。

有一个变量 arrp，之前它是一个双指针，将使用 malloc 为其分配内存，并将作为 2D 数组访问。

现在我已将其更改为指向数组的指针，即：char (*arrp)[];

arrp 指向的二维数组的大小只有在运行时才能知道。我的问题是，如果未声明大小，编译器会抛出错误（'char (*)[]' : unknown size)

请参考以下代码，我做了这样的事情

```
char (*arrp)[]; //This will be from different module, 
        //I have declared as local variable for our reference

char (*parr)[2];

char arr[3][2];

parr = &(arr[0]);   
arrp = (char (*)[])&(arr[0]);

//inside loops for i, j
...

printf("%c",parr[i][j]); // This works fine
printf("%c",arrp[i][j]); // Error :'char (*)[]' : unknown size) 

....
//Some code 
```

声明 arrp 时无法获取数组的大小。有没有办法消除这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:51:40.637

指向数组的指针有助于一次跳过整个数组。（即使用单个增量）它通过知道要跳转的数组的列宽来做到这一点。因此，如果不知道列大小，恐怕您指向数组的指针对您毫无用处。

但是，如果您有一个支持可变长度数组（ C99 ）的现代编译器，那么它非常简单

```
int foo ( int m, int n )
{
    int a[m][n];
    int (*ptr)[n]=a;
    a[0][2] = 78;
    printf("%d", ptr[0][2]);

} 
```

# delphi - 使用特定字符集修剪字符串

> ID：10121601
> 
> 赞同：5
> 
> 时间：2012-04-12T10:14:55.683
> 
> 标签：delphi, delphi-xe

Delphi 中是否有与 Cocoa 等效的功能`stringByTrimmingCharactersInSet`？

我需要的是消除在字符串开头或结尾找到的字符集中包含的所有字符。可以没有，一个或多个开始或结束字符串...

在 Delphi 中执行此操作的最有效方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T10:39:28.750

据我所知，不存在这样的 RTL 函数。但是您可以查看[JCL 项目](http://wiki.delphi-jedi.org/wiki/JCL_Download)[`JclStrings`](http://jcl.svn.sourceforge.net/viewvc/jcl/trunk/jcl/source/common/JclStrings.pas?view=markup)的单元部分，其中包括和 功能。[`StrTrimCharsLeft`](http://wiki.delphi-jedi.org/wiki/JCL_Help:StrTrimCharsLeft@AnsiString@TSysCharSet)[`StrTrimCharsRight`](http://wiki.delphi-jedi.org/wiki/JCL_Help:StrTrimCharsRight@AnsiString@TSysCharSet)

```
function StrTrimCharsLeft(const S: string; const Chars: TCharValidator): string; overload;
function StrTrimCharsLeft(const S: string; const Chars: array of Char): string; overload;
function StrTrimCharRight(const S: string; C: Char): string;
function StrTrimCharsRight(const S: string; const Chars: TCharValidator): string; overload;
function StrTrimCharsRight(const S: string; const Chars: array of Char): string; overload; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:25:44.080

据我所知，RTL 不包含这样的功能。您可以使用正则表达式来填补空白：

```
function MyTrim(const Input: string; const TrimChars: string): string;
begin
  Result := TRegEx.Replace(Input, Format('^[%s]*', [TrimChars]), '');
  Result := TRegEx.Replace(Result, Format('[%s]*$', [TrimChars]), '');
end; 
```

我很确定这不是性能最好的解决方案，但很难找到更简单的解决方案。

# eclipse - 使用 JSF 的企业 Web 应用程序结构

> ID：10121611
> 
> 赞同：2
> 
> 时间：2012-04-12T10:15:21.893
> 
> 标签：eclipse, jsf, jakarta-ee, architecture, web

我正在开发将 JSF 与 Eclipse IDE 结合使用的企业 Web 应用程序。但是我在 JSF Web 应用程序架构师方面没有经验，只是不熟悉名称类、项目、包、网页、模板页面等。是否可以像以下这样命名包：CompanyName.systemName.controller（会有控制器）CompanyName.systemName.Model（里面会有托管的bean和其他东西）

甚至如何为我的项目选择最佳结构（文件夹、类、包、网页、模板页面等的平均架构）。如果有人有想法？如果有示例项目，我会很高兴。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T08:07:53.730

如果您从架构的角度来看，您的 JSF 应用程序应该非常像任何其他架构良好的 Java-Web 应用程序一样。

对于打包，我喜欢首先按功能（如核心、gui）来划分，然后按业务单元级别划分。

就像是：

```
com.comp.core.db.beans
com.comp.extension.ui.extension //If my application is going to give extension point for others to implement, extend the functionality.
com.comp.core.ui.controller 
```

在类似的注释页面上，配置文件可以分成单独的逻辑单元。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T12:38:24.453

这些都是很好的包名。有些人喜欢按目的对包进行分组：

```
org.mycompany.myapp.controller
org.mycompany.myapp.dao
org.mycompany.myapp.service
etc... 
```

对于较大的应用程序，我喜欢按功能对它们进行分组：

```
org.mycompany.myapp.billing
org.mycompany.myapp.signup
org.mycompany.myapp.webservices
etc... 
```

至于文件夹结构，一个好的 Maven 原型会很有帮助。这是一个网页，它很好地介绍了使用 Maven 原型设置几种类型的 JSF 项目：[http ://www.javaserverfaces.org/get-started](http://www.javaserverfaces.org/get-started)

# list - 无法第二次更改“构建列表使用”的值

> ID：10121612
> 
> 赞同：0
> 
> 时间：2012-04-12T10:15:22.383
> 
> 标签：list, adobe, components, aem

我使用 CMS Adob​​e Day CQ5 创建了一个站点。我在页面组件“列表”上使用并发现了一个错误。无法第二次更改“构建列表使用”的值。重现步骤：

1.  将“列表”添加到页面
2.  右键单击组件->编辑->设置以下参数：使用=子页面构建列表
3.  选择父页面
4.  点击确定（参数保存，页面显示列表）
5.  右键单击组件 -> 编辑 -> 尝试设置：使用 = 固定列表构建列表

结果：无法第二次更改构建列表的值。我在互联网上的 Adob​​e 网站上没有找到解决此问题的方法:( 以前有没有人遇到过这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-17T09:28:43.567

我找到了解决这个问题的方法，而且非常简单。您需要将属性为“jsr:prinaryType”=“cq:EditConfig”的子节点添加到组件的节点，并向该节点添加一个 chold 节点。最后一个节点具有属性“jcr:primaryType”=“cq:EditListenersConfig”和“afteredit”=“REFRESH_PAGE”。这将允许通过他的对话在每个编辑组件后自动重新加载页面。

最后，组件的文件夹应该只有一个 XML 文件“_cq_editConfig.xml”，其中包含以下几行：

```
<?xml version="1.0" encoding="UTF-8"?>
<jcr:root xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
jcr:primaryType="cq:EditConfig">
    ....
    <cq:listeners jcr:primaryType="cq:EditListenersConfig" afteredit="REFRESH_PAGE"/>
    ....
</jcr:root> 
```

# javascript - 单击时向 jquery 下拉脚本添加隐藏功能

> ID：10121613
> 
> 赞同：0
> 
> 时间：2012-04-12T10:15:23.387
> 
> 标签：javascript, jquery, drop-down-menu

我目前正在使用以下脚本来操作我的下拉菜单，以便当用户单击菜单项时会出现下拉菜单，并且他们当前可以单击屏幕外的任何位置以使菜单消失，但我想知道 id 如何添加功能到通过再次单击菜单项使下拉菜单消失（同时保留单击项目外部任何位置的选项）。这很难实施吗？

```
$(document).ready(function() {
    /* for keeping track of what's "open" */
    var activeClass = 'dropdown-active', showingDropdown, showingMenu, showingParent;
    /* hides the current menu */
    var hideMenu = function() {
        if(showingDropdown) {
            showingDropdown.removeClass(activeClass);
            showingMenu.hide();
        }
    };

    /* recurse through dropdown menus */
    $('.dropdown').each(function() {
        /* track elements: menu, parent */
        var dropdown = $(this);
        var menu = dropdown.next('div.dropdown-menu'), parent = dropdown.parent();
        /* function that shows THIS menu */
        var showMenu = function() {
            hideMenu();
            showingDropdown = dropdown.addClass('dropdown-active');
            showingMenu = menu.show();
            showingParent = parent;
        };
        /* function to show menu when clicked */
        dropdown.bind('click',function(e) {
            if(e) e.stopPropagation();
            if(e) e.preventDefault();
            showMenu();
        });
        /* function to show menu when someone tabs to the box */
        dropdown.bind('focus',function() {
            showMenu();
        });
    });

    /* hide when clicked outside */
    $(document.body).bind('click',function(e) {
        if(showingParent) {
            var parentElement = showingParent[0];
            if(!$.contains(parentElement,e.target) || !parentElement == e.target) {
                hideMenu();
            }
        }
    });
}); 
```

这是我根据以下答案的尝试：

```
/* function to show menu when clicked */
dropdown.bind('click',function(e) {
    if (!dropdown.data('open')) {
    dropdown.data'(open', true);
    // open menu
    } else {
    dropdown.data('open', false);
    // close menu
    }

}); 
```

虽然我遇到了错误，所以我认为我玩错了或者可能覆盖了一些东西？这只是上面代码的一部分，因为它是我用这个答案编辑的唯一部分。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:22:19.327

您可以做的是使用 jQuery.data() 并有一个名为 open 的变量，例如，根据状态为真或假。所以你可能是这样的。

```
if (!dropdown.data('open')) {
dropdown.data'(open', true);
// open menu
} else {
dropdown.data('open', false);
// close menu
} 
```

# c# - 如何使用 C# 访问 iOS App 的 Documents 文件夹

> ID：10121616
> 
> 赞同：3
> 
> 时间：2012-04-12T10:15:29.500
> 
> 标签：c#, iphone, .net, ios, windows

我想将文件从 Windows (c#) 推送到 iPad 并稍后取回。我没有网络连接，所以我需要通过 USB 电缆进行此操作。

我找到了 Manzana，但似乎不支持 iTunes FileSharing。

有什么提示吗？我用谷歌搜索了很多，但找不到任何有用的东西。

有一些功能，如“AMDeviceStartHouseArrest”，但我不知道如何使用它们来获取我的文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T09:53:48.090

有一种方法可以完成这项工作。

感谢 Simon 的一篇博文 (http://blog.victornet.de/2011/04/10/c-manzana-iphoneipad-hausarrest/) 和一些邮件，它终于奏效了。

我现在将 Manzana 与 Simon 的扩展一起使用：

```
MobileDevice.AMDeviceStartHouseArrestService(iPhoneHandle,      
MobileDevice.CFStringMakeConstantString(bundleIdentifier), null, ref hService, 0); 
```

为特定应用程序启动“Housearrest”（通过 bundleIdentifier）使其“/Documents”文件夹可通过默认的 Manzana 方法访问。所以没有必要越狱iDevice。最后，我可以将文件推送到 iDevice 并读回它们。

再次感谢西蒙的大力支持！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T00:13:00.727

我不太确定你在问什么。如果您想访问 ipad 上的标准文件，可以将其设置为 USB 大容量存储设备。我相信如果您传入正确的路径，标准 IO 方法（System.IO）将能够读取和写入设备。如果您正在谈论访问应用程序文件，由于 iOS 的安全问题，我认为这是不可能的（至少不是以标准的、非越狱的方式）

# jsf - jsf core/primefaces中树结构下的数据表

> ID：10121617
> 
> 赞同：0
> 
> 时间：2012-04-12T10:15:36.137
> 
> 标签：jsf, jsf-2, tree, datatable, primefaces

我陷入了一个相当奇怪的境地。

我有一个要求，我需要一个树结构来定义元素列表。当我们单击树中的任何这些元素时。它应该展开它下面的部分以显示链接到该元素的 2 个并排数据表。

我可以使用 JSF 2.0 核心甚至 primefaces 3.1。

可能吗 ？？

任何人都可以请帮助...任何建议将不胜感激。

**更新**

我的模型是这样的：

```
class Shop{
    boolean isoperational;
    String name;
    List<Item> items;
    List<boolean> itempresent;
    List<Employee> employees; 
} 
```

我需要树节点上的商店名称以及 isoperational 复选框；当我们单击该节点时，它应该打开 2 个数据表。

*   一个包含项目列表和 itempresent 复选框。

*   其他包含员工名单。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:25:29.087

根据您的回复进行编辑（如果我理解正确的话）。请注意，这是从头开始编写的，因此某些属性名称可能会有所不同。关键是根据单击的行从树表中设置一个活动集合。通过 actionListener 设置一个 ID，然后该操作将 mycontroller.activeCollection 设置为您要显示的列表。然后数据表通过普通帖子或 ajax 重新呈现，其值取决于您单击的行。

标记

```
<p:treeTable value="#{myController.treenode}" var="item">
    <p:column>
        <h:commandLink action="#{myController.setActiveShop}" value="set">
            <f:setPropertyActionListener target="#{myController.shipName}" value="#{item.shop.name}"/>
        </h:commandButton>
    </p:column>
</p:treeTable>

<p:dataTable value="#{myController.activeShop.items" rendered="#{!empty myController.activeShop}" var="item">
   <p:column>#{item.name}</p:column>
</p:datatable>

<p:dataTable value="#{myController.activeShop.employees" rendered="#{!empty myController.activeShop}" var="item">
   <p:column>#{item.name}</p:column>
</p:datatable> 
```

控制器

```
@ManagedBean
@ViewScoped // Or @SessionScoped... something that can cache lists, not sure how this would be done with requestscope
public class MyController{
    private List<Shop> shopList; // Set this from a datasource. Or use only shopTree below to store your shops..
    private Shop activeShop;
    private String shopName;
    private TreeNode shopTree; // Generate this from shopList

    // insert getters and setters

    private setActiveShop(){
        for(Shop s : shipList)
            if(s.getName().equals(shopName)
                activeShop = s;
    }
} 
```

# jquery - jquery 中的 nth-child() 问题

> ID：10121622
> 
> 赞同：2
> 
> 时间：2012-04-12T10:15:51.637
> 
> 标签：jquery, css

你好朋友以下是我的代码

HTML

```
<div class="quick_link">
    <ul>
        <li>iPad App Edition</li>
        <li>About us</li>
        <li>Digital Edition</li>
        <li>Press Room</li>
        <li>Privacy & Terms of Use</li>
        <li>Site Map</li>
        <li>Contact Us</li>
        <li>Community Guidelines</li>
    </ul>
</div> 
```

jQuery

```
$(document).ready(function(){
    $('.quick_link li:nth-child(even)').css('color','red');
})​ 
```

[使用此代码，我可以更改您可以在此处](http://jsfiddle.net/9Nbhp/2/)看到的每个偶数孩子的颜色。但问题是我想改变每四个孩子的颜色，但我不知道该怎么做

请帮帮我

提前致谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T10:18:45.957

`n`为此使用变量：http: [//jsfiddle.net/9Nbhp/3/](http://jsfiddle.net/9Nbhp/3/)

```
.quick_link li:nth-child(4n) 
```

你可以在这里找到文档[http://api.jquery.com/nth-child-selector/](http://api.jquery.com/nth-child-selector/)

正如 Jensgram 指出的，您可以在[http://www.w3.org/TR/selectors/#nth-child-pseudo找到有关 nth-child 选择器的详细说明](http://www.w3.org/TR/selectors/#nth-child-pseudo)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T02:46:23.600

尝试这个：

```
$('.quick_link>ul>li:nth-child(even)').css('color','red'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:19:45.770

请参阅[http://api.jquery.com/nth-child-selector/](http://api.jquery.com/nth-child-selector/)

```
:nth-child(3n+1) 
```

# c# - 如何在 C# 中制作可以转换为 DateTime 的类？

> ID：10121630
> 
> 赞同：14
> 
> 时间：2012-04-12T10:16:10.030
> 
> 标签：c#, datetime, packing

我怎样才能上课，可以转换为 DateTime。但是我需要在我的班级打包时进行。例如：

```
object date1 = new MyDateTime();
DateTime date2 = (DateTime)date1; 
```

我直接需要这个工作示例。

我知道怎么做，但我的方法不用打包也行。我不确定有没有办法做到这一点。

请帮忙。

PS。我需要直接将对象转换为 DateTime。因此，必须先打包 MyDateTime。显式效果很好，但如果你有打包的对象，它也无济于事。它必须使用普通的铸造来铸造，比如

```
(DateTime) (object) MyDateTime 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-12T10:18:50.683

您似乎追求的是继承，能够将派生类实例“存储”在基类型的变量中，如下所示：

```
Stream s = new FileStream(); 
```

它是引擎盖下的事实`FileStream`并不会因为您`Stream`戴着护目镜指向它而丢失。

`DateTime`是`struct`, 并且`struct`不支持继承 - 所以这是***不可能***的。

**另一种选择**是用于[用户定义转换](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/user-defined-conversion-operators)`explicit`的关键字（在语法上*看起来*像强制转换）。这让你至少可以在你的班级和更多的糖之间进行交流。*`DateTime`*

 *这可能看起来像：

```
class MyDateTime
{
    private DateTime _inner;

    public static explicit operator DateTime(MyDateTime mdt)
    {
        return mdt._inner;
    }
} 
```

您可以对对应`implicit`关键字执行相同操作：

```
public static implicit operator DateTime(MyDateTime mdt)
{
    return mdt._inner;
} 
```

然后，您可以隐式地进行“强制转换”：

```
DateTime date = new MyDateTime(); 
```

**另一种选择**是使用您自己的适配器类进行包装`DateTime`，该类在内部使用 a`DateTime`然后从此类继承以创建`MyDateTime`. 然后`DateTime`，您可以使用这个适配器类，而不是在您的代码库中使用。

我在`SmartDateTime`样式类中看到过类似的事情，其中`DateTime`​​对空值以及是否已设置有更好的理解。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-12T10:19:25.120

你可以使用

```
class MyDateTime
{
    public static explicit operator DateTime(MyDateTime dt)
    {
        return new DateTime(); // Convert dt here            
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-08T02:24:46.990

我将创建一个扩展方法来执行完成转换所需的步骤，而不是直接转换。某种转换是必要的，因为 DateTime 不能被继承，所以直接转换是不可能的。

```
public static class DateTimeExtensions
{
    public static MyDateTime ToMyDateTime(this DateTime dt)
    {
        //conversion logic
        return myDataTime;
    }
    public static DateTime ToDateTime(this MyDateTime mdt)
    {
        //conversion logic
        return dateTime;
    }
} 
```

这样，您将像这样使用代码：

```
DateTime dt = mdt.ToDateTime(); 
```

或者

```
MyDateTime mdt = dt.ToMyDateTime(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:19:55.110

您需要在 MyDateTime 类上编写一个显式转换运算符，以调用 Datetime 上的构造函数之一。[这是一个例子](http://msdn.microsoft.com/en-us/library/xhbhezf4%28v=vs.80%29.aspx)。*

# asp.net-mvc - 从 Razor 视图获取字符串的最佳方法

> ID：10121631
> 
> 赞同：0
> 
> 时间：2012-04-12T10:16:11.997
> 
> 标签：asp.net-mvc, razor

我想让我的 Razor 视图返回它呈现的 html 字符串，以便控制器从视图返回呈现的 html 字符串，而不仅仅是视图。我在 ASP.NET MVC 中找不到本地方法来执行此操作。有什么解决方法吗？

通过说明性示例：

```
 public ActionResult Index()
        {
            return View().ToString; //View has no ToString() method but this is what I am trying to do
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:23:32.087

您可以使用`Html.Partial`返回一个`MvcHtmlString`视图。

您可以在 中找到`Partial`方法 `System.Web.Mvc.Html.PartialExtensions`。

这里有关于此方法的更多信息：http: [//msdn.microsoft.com/en-us/library/ee402898.aspx](http://msdn.microsoft.com/en-us/library/ee402898.aspx)

我个人将它用于我的 RenderPartials（复数）扩展方法：

```
 public static void RenderPartials<T>(this HtmlHelper helper, 
            string partialViewName, IEnumerable<T> models, string htmlFormat)
        {
            if (models == null)
                return;

            foreach (var view in models.Select(model => 
                  helper.Partial(partialViewName,model, helper.ViewData)))
            {
                helper.ViewContext.HttpContext.Response
                  .Output.Write(htmlFormat, view);
            }
        } 
```

**更新**

要将视图呈现为控制器中的字符串，您可以执行以下操作（尽管它看起来有点像 hack）：

```
var htmlHelper = new HtmlHelper(new ViewContext(), new ViewPage());
var viewString = htmlHelper.Partial("PartialViewName"); 
```

我说它有点像黑客的原因是因为 HtmlHelper 被设计用于您的视图而不是您的控制器或模型中。话虽如此，如果它有效并且没有替代方法可以对解析的视图进行字符串化，那么它可能对您有用。

鉴于对您的问题的修改，您将寻找如下内容：

```
public string Index()
{
    var htmlHelper = new HtmlHelper(new ViewContext(), new ViewPage());
    return htmlHelper.Partial("PartialViewName");
} 
```

如果上面的代码没有正确创建 htmlHelper，你可以像这样创建它：

```
TextWriter writer = new StringWriter();
var htmlHelper = new HtmlHelper(new ViewContext(ControllerContext, 
                new RazorView(ControllerContext, "","",true,null), 
                new ViewDataDictionary(), 
                new TempDataDictionary(), writer), new ViewPage()); 
```

# python - 查询一个字符串

> ID：10121646
> 
> 赞同：2
> 
> 时间：2012-04-12T10:17:57.103
> 
> 标签：python, django

我有以下字符串：

```
string = 'amount=2000|captureDay=0|captureMode=AUTHOR_CAPTURE|currencyCode=978|merchantId=002020000000001|orderId=|transactionDateTime=2012-04-12T12:09:56+02:00|transactionReference=1212943|keyVersion=1|authorisationId=0020000006791167|complementaryCode=|maskedPan=|paymentMeanBrand=IDEAL|paymentMeanType=CREDIT_TRANSFER|responseCode=00' 
```

我怎样才能从中做出查询。

我希望能够使用`item['amount']`which 返回`2000`

编辑：

到目前为止我已经尝试过：

```
dict = string.split('|') 
```

输出是：

```
['amount=2000', 'captureDay=0', 'captureMode=AUTHOR_CAPTURE', 'currencyCode=978', 'merchantId=002020000000001', 'orderId=', 'transactionDateTime=2012-04-12T12:09:56+02:00', 'transactionReference=1212943', 'keyVersion=1', 'authorisationId=0020000006791167', 'complementaryCode=', 'maskedPan=', 'paymentMeanBrand=IDEAL', 'paymentMeanType=CREDIT_TRANSFER', 'responseCode=00'] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T10:44:13.447

您可以将整个字符串替换为 Django 的 QueryDict `|`。`&`

请参阅[QueryDict 文档](https://docs.djangoproject.com/en/dev/ref/request-response/#querydict-objects)

例如

```
In [1]: from django.http import QueryDict

In [2]: sample = 'amount=2000|captureDay=0|captureMode=AUTHOR_CAPTURE|currencyCode=978|merchantId=002020000000001|orderId=|transactionDateTime=2012-04-12T12:09:56+02:00|transactionReference=1212943|keyVersion=1|authorisationId=0020000006791167|complementaryCode=|maskedPan=|paymentMeanBrand=IDEAL|paymentMeanType=CREDIT_TRANSFER|responseCode=00'

In [3]: qdict = QueryDict(sample.replace('|','&'))

In [4]: qdict
Out[4]: <QueryDict: {u'orderId': [u''], u'keyVersion': [u'1'], u'transactionReference': [u'1212943'], u'paymentMeanType': [u'CREDIT_TRANSFER'], u'maskedPan': [u''], u'currencyCode': [u'978'], u'paymentMeanBrand': [u'IDEAL'], u'complementaryCode': [u''], u'amount': [u'2000'], u'authorisationId': [u'0020000006791167'], u'responseCode': [u'00'], u'captureMode': [u'AUTHOR_CAPTURE'], u'captureDay': [u'0'], u'transactionDateTime': [u'2012-04-12T12:09:56 02:00'], u'merchantId': [u'002020000000001']}> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T10:21:57.390

```
string = 'amount=2000|captureDay=0|captureMode=AUTHOR_CAPTURE|currencyCode=978|merchantId=002020000000001|orderId=|transactionDateTime=2012-04-12T12:09:56+02:00|transactionReference=1212943|keyVersion=1|authorisationId=0020000006791167|complementaryCode=|maskedPan=|paymentMeanBrand=IDEAL|paymentMeanType=CREDIT_TRANSFER|responseCode=00'
items = dict(item.split('=', 1) for item in string.split('|'))

print items['amount'] 
```

第一个拆分（在管道符号上）产生一个“x=y”格式的字符串列表。第二个拆分采用其中的每一个并返回两个元素的列表。然后将这个 2 元素列表的列表输入到`dict()`构造函数中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T10:21:41.600

去做：

```
>>> {i.split("=")[0]:i.split("=")[1] for i in string.split('|')} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:21:29.577

```
dict(e.split("=", 1) for e in string.split("|")) 
```

# algorithm - algorithm - 如何求解算术表达式 DAG？

> ID：10121657
> 
> 赞同：10
> 
> 时间：2012-04-12T10:18:31.447
> 
> 标签：algorithm, data-structures, graph, tree, directed-acyclic-graphs

[The Algorithm Design Manual](http://www.algorist.com/)中有两个相关的 excises 。

基本上，我知道如何解决第一个消费税，**但我不知道如何*使用第一个解决方案作为提示***来解决第二个消费税。

## 算术表达式*树的消费税*

![算术表达式树](../Images/3dcc4fc66526425a7f6a3492f8534e53.png)

> 上面是一个算术表达式树。假设算术表达式以树的形式给出。每个叶子都是一个整数，每个内部节点都是标准算术运算之一（+，-，*，/）。例如，表达式 2 + 3 * 4 + (3 * 4)/5 由上图中的树表示。给出一个计算这样一个表达式的 O(n) 算法，其中树中有 n 个节点。

好的，这并不难。我的解决方案是这样的：

```
 public float evaluate() {
        return evaluate(root);
    }

    private float evaluate(Node_EX _node) {
        if (_node.left == null || _node.right == null)
            return Float.parseFloat(_node.key);
        String op = _node.key;
        if (op == "+") {
            return evaluate(_node.left) + evaluate(_node.right);
        } else if (op == "-") {
            return evaluate(_node.left) - evaluate(_node.right);
        } else if (op == "*") {
            return evaluate(_node.left) * evaluate(_node.right);
        } else {
            return evaluate(_node.left) / evaluate(_node.right);
        }
    } 
```

我只是使用递归的方式来解决表达式树的结果。

## 算术表达式*DAG的 Excise*

![算术表达式 dag](../Images/2631d832386230803adff649e07defc0.png)

> 假设一个算术表达式被给出为一个 DAG（有向无环图），其中删除了公共子表达式。每个叶子都是一个整数，每个内部节点都是标准算术运算之一（+，-，*，/）。例如，表达式 2 + 3 * 4 + (3 * 4)/5 由上图中的 DAG 表示。给出一个 O(n + m) 算法来评估这样一个 DAG，其中 DAG 中有 n 个节点和 m 个边。**提示：修改树案例的算法以达到所需的效率。**

好的，描述中有这样一个提示：**提示：针对树的情况修改一个算法，以达到预期的效率。**

实际上，我对这个提示感到很困惑。对于一个典型的树相关的事情，我们通常可以使用递归来解决。但是，如果这是一个图，我的第一个直觉是使用 BFS 或 DFS 来解决它。那么我如何将 BFS 或 DFS 与树相关联，尽管 DFS 实际上是递归的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-12T10:24:41.943

我相信，为了达到预期的效率，问题希望您避免重新评估您已经访问过的树的部分。一旦您到达并评估了 DAG 中的某个子树（树中的每个节点都代表以该节点为根的子树），您可以存储结果值并将其与该子树相关联。然后，当您再次访问它时，您可以检查您是否已经预先计算了该值并只是检索它而不是再次评估它。

有许多不同的方法可以存储和检索这些值，一种简单的方法是修改节点的结构以允许可缓存的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-18T04:37:24.693

可以使用给定 DAG 上的 DFS 来解决该问题。

*   我们将保存对空气动力学表达式的公共部分的重新计算。

*   例如：在做 DFS 时， * 会从 ( / ) 节点重新遇到。( / ) 和 * 之间的边是交叉边，这意味着 (*) 的左右子树已经被求值。因此，我们将利用这一点并节省重新计算。

*   然而，要实现这一点，我们需要保存节点上的操作结果。

*   复杂度为 O(n+m)，因为它是正常的 DFS 遍历，其中一些额外的内存用于存储中间结果。

希望这可以帮助。

# php - 从动作助手发送数据到局部视图

> ID：10121659
> 
> 赞同：0
> 
> 时间：2012-04-12T10:18:38.487
> 
> 标签：php, zend-framework, helpers, zend-view

我想从 Action Helper 发送一些数据来查看 Partial，但我无法做到这一点，以获得清晰的画面。这是我正在使用的所有相关代码。

在我的`layout.phtml`我使用这个占位符。生成按需导航菜单。

```
<?php echo $this->placeholder('action-navigation'); ?> 
```

所以当我在我的控制器或操作方法中需要它时，我可以简单地使用这个代码。

```
$this->_helper->navigation()->renderActionNavigation(); 
```

我正在使用的动作助手是。

```
class Zend_Controller_Action_Helper_Navigation extends Zend_Controller_Action_Helper_Abstract
{
    private $_view = null;

    public function direct()
    {
        $this->_view = $view = Zend_Layout::getMvcInstance()->getView();
        $this->_view->placeholder('action-navigation');
        return $this;
    }

    public function renderActionNavigation()
    {   
        $config = new Zend_Config_Xml(
            APPLICATION_PATH.'/configs/navigation.xml', strtolower(
                $this->getRequest()->getControllerName().
                $this->getRequest()->getActionName()
            )
        );
        $container = new Zend_Navigation($config);

        // here i want to send $container to _action-navigation.phtml.

        $this->_view->addScriptPath(APPLICATION_PATH.'/layouts/')->render('partials/_action-navigation.phtml');
    }
} 
```

这是我的部分观点`_action-navigation.phtml`

```
$this->placeholder('action-navigation')->captureStart();

//i want to get zend_navigation instance. from the above action helper here.

$this->placeholder('action-navigation')->captureEnd(); 
```

我在将数据从动作助手发送到部分视图时遇到问题`_action-navigation.phtml`，我该怎么做？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:32:50.897

使用[`partial()`](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.initial.partial)代替`render()`：

```
$this->_view->partial('partials/_action-navigation.phtml', array('nav' => $container)); 
```

在你的部分：

```
$this->nav // to get your container 
```

# android - 如何从应用程序后台录制视频：Android

> ID：10121660
> 
> 赞同：65
> 
> 时间：2012-04-12T10:18:43.317
> 
> 标签：android, service, media, video-capture

我正在开发一个应用程序，它可以使用`Service`.

***问题描述 ：***

在我的应用程序录制将被安排。如果用户想从下午 1 点到下午 3 点录制视频，他将安排任务并可以退出应用程序。应用程序将在下午 1 点至下午 3 点自动开始录制。

***我还做了什么：***

我用谷歌搜索了我的查询，但没有得到解决方案。很多文章都说不可能。但是在[Google Play](https://play.google.com/)中有一些应用程序（例如[MyCar Recorder](https://play.google.com/store/apps/details?id=dadny.recorder.lite.google)）可以从应用程序的背景录制视频。

*我得到了[一篇](http://pickerwengs.blogspot.in/2011/05/android-background-video-recorder-on.html)关于相同的文章，但它不起作用。*

***实现此功能的方法是什么？***

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-02-19T07:32:52.757

1-我创建了一个活动来启动这样的服务：

```
package com.android.camerarecorder;

import android.app.Activity;
import android.content.Intent;
import android.hardware.Camera;
import android.os.Bundle;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.widget.Button;

public class CameraRecorder extends Activity implements SurfaceHolder.Callback {
    private static final String TAG = "Recorder";
    public static SurfaceView mSurfaceView;
    public static SurfaceHolder mSurfaceHolder;
    public static Camera mCamera ;
    public static boolean mPreviewRunning;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mSurfaceView = (SurfaceView) findViewById(R.id.surfaceView1);
        mSurfaceHolder = mSurfaceView.getHolder();
        mSurfaceHolder.addCallback(this);
        mSurfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        Button btnStart = (Button) findViewById(R.id.StartService);
        btnStart.setOnClickListener(new View.OnClickListener()
        {
            public void onClick(View v)
            {
                Intent intent = new Intent(CameraRecorder.this, RecorderService.class);
                intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                startService(intent);
                finish();
            }
        });

        Button btnStop = (Button) findViewById(R.id.StopService);
        btnStop.setOnClickListener(new View.OnClickListener()
        {
            public void onClick(View v)
            {
                stopService(new Intent(CameraRecorder.this, RecorderService.class));
            }
        });
    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {

    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub

    }
} 
```

2 - 现在我创建**了一个服务来在后台录制视频，**如下所示：

```
 package com.android.camerarecorder;
    import java.io.IOException;
    import java.util.List;
    import android.app.Service;
    import android.content.Intent;
    import android.graphics.PixelFormat;
    import android.hardware.Camera;
    import android.hardware.Camera.Size;
    import android.media.MediaRecorder;
    import android.os.IBinder;
    import android.util.Log;
    import android.view.SurfaceHolder;
    import android.view.SurfaceView;
    import android.widget.Toast;

    public class RecorderService extends Service {
        private static final String TAG = "RecorderService";
        private SurfaceView mSurfaceView;
        private SurfaceHolder mSurfaceHolder;
        private static Camera mServiceCamera;
        private boolean mRecordingStatus;
        private MediaRecorder mMediaRecorder;

        @Override
        public void onCreate() {
            mRecordingStatus = false;
            //mServiceCamera = CameraRecorder.mCamera;
            mServiceCamera = Camera.open(1);
            mSurfaceView = CameraRecorder.mSurfaceView;
            mSurfaceHolder = CameraRecorder.mSurfaceHolder;

            super.onCreate();
            if (mRecordingStatus == false)
                startRecording();
        }

        @Override
        public IBinder onBind(Intent intent) {
            // TODO Auto-generated method stub
            return null;
        }

        @Override
        public void onDestroy() {
            stopRecording();
            mRecordingStatus = false;

            super.onDestroy();
        }   

        public boolean startRecording(){
            try {
                Toast.makeText(getBaseContext(), "Recording Started", Toast.LENGTH_SHORT).show();

                //mServiceCamera = Camera.open();
                Camera.Parameters params = mServiceCamera.getParameters();
                mServiceCamera.setParameters(params);
                Camera.Parameters p = mServiceCamera.getParameters();

                final List<Size> listSize = p.getSupportedPreviewSizes();
                Size mPreviewSize = listSize.get(2);
                Log.v(TAG, "use: width = " + mPreviewSize.width 
                            + " height = " + mPreviewSize.height);
                p.setPreviewSize(mPreviewSize.width, mPreviewSize.height);
                p.setPreviewFormat(PixelFormat.YCbCr_420_SP);
                mServiceCamera.setParameters(p);

                try {
                    mServiceCamera.setPreviewDisplay(mSurfaceHolder);
                    mServiceCamera.startPreview();
                }
                catch (IOException e) {
                    Log.e(TAG, e.getMessage());
                    e.printStackTrace();
                }

                mServiceCamera.unlock();

                mMediaRecorder = new MediaRecorder();
                mMediaRecorder.setCamera(mServiceCamera);
                mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
                mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
                mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
                mMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);
                mMediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.DEFAULT);
                mMediaRecorder.setOutputFile("/sdcard/video.mp4");
                mMediaRecorder.setVideoFrameRate(30);
                mMediaRecorder.setVideoSize(mPreviewSize.width, mPreviewSize.height);
                mMediaRecorder.setPreviewDisplay(mSurfaceHolder.getSurface());

                mMediaRecorder.prepare();
                mMediaRecorder.start(); 

                mRecordingStatus = true;

                return true;
            } catch (IllegalStateException e) {
                Log.d(TAG, e.getMessage());
                e.printStackTrace();
                return false;
            } catch (IOException e) {
                Log.d(TAG, e.getMessage());
                e.printStackTrace();
                return false;
            }
        }

        public void stopRecording() {
            Toast.makeText(getBaseContext(), "Recording Stopped", Toast.LENGTH_SHORT).show();
            try {
                mServiceCamera.reconnect();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            mMediaRecorder.stop();
            mMediaRecorder.reset();

            mServiceCamera.stopPreview();
            mMediaRecorder.release();

            mServiceCamera.release();
            mServiceCamera = null;
        }
    } 
```

它将在您的 SD 卡中创建一个文件 video.mp4。您可以更改代码以添加更多功能，但基本功能是通过此代码实现的，即在后台录制视频。

**注意：我已经通过按钮单击活动启动了服务，但您可以通过任何其他方式启动它，例如广播接收器等。**

希望能帮助到你！！干杯。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-10T06:45:36.957

是的，您可以像这样录制背景视频：

首先，使用服务创建一个视频应用程序。不要将其视图设置为不可见。如果您在服务中这样做，那会更好，因为...

其次，您可以使用 AlarmManager 来设置特定时间的闹钟，然后在那个时候，通过使用意图，再次启动您的服务。要停止您的应用程序，您也可以使用 AlarmManager。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-02-27T05:43:41.870

以下是一些很酷的 android 项目，它们具有相同的一些变化：

[https://github.com/zeitgeist87/SpartanTimeLapseRecorder/blob/master/src/at/andreasrohner/spartantimelapserec/recorder/VideoRecorder.java](https://github.com/zeitgeist87/SpartanTimeLapseRecorder/blob/master/src/at/andreasrohner/spartantimelapserec/recorder/VideoRecorder.java) - 控制相机的FPS

[https://www.sisik.eu/blog/android/media/camera2-from-service](https://www.sisik.eu/blog/android/media/camera2-from-service) - 来自背景摄像头的图像

[https://github.com/kevalpatel2106/android-hidden-camera/blob/master/hiddencamera/src/main/java/com/androidhiddencamera/HiddenCameraService.java](https://github.com/kevalpatel2106/android-hidden-camera/blob/master/hiddencamera/src/main/java/com/androidhiddencamera/HiddenCameraService.java)

[https://github.com/botyourbusiness/android-camera2-secret-picture-taker](https://github.com/botyourbusiness/android-camera2-secret-picture-taker) - 官方

[https://gist.github.com/joseph-zhong/c2a52a5507d6588bec2db9869c860114](https://gist.github.com/joseph-zhong/c2a52a5507d6588bec2db9869c860114)

[https://github.com/ulysses4ever/Background-VideoRecorder](https://github.com/ulysses4ever/Background-VideoRecorder)

# jquery - jQuery ajax 请求在 Firefox 上成功，但在 Internet Explorer 上没有

> ID：10121663
> 
> 赞同：0
> 
> 时间：2012-04-12T10:18:51.383
> 
> 标签：jquery, ajax, internet-explorer, firefox

我想检查下面显示的 url 是否可以访问。在 Firefox 上，当页面未运行时请求失败，但也没有显示错误。在 Internet Explorer 上，始终显示“成功”。我该如何解决这个问题，以便也支持 IE？为什么仍然不显示错误？提前致谢！

```
var link = "http://localhost:8387/nscalemc/";

$.ajax({
    type: "GET",
    url: link,
    crossDomain: true,
    dataType: "script",
    success: function() {
        alert("success")
    },
    error: function() {
        alert("error");
    }
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:20:42.913

Ajax GET 请求通常被 IE 缓存。您将需要手动禁用缓存：

```
$.ajaxSetup ({
        cache: false
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:28:39.603

**最好的解决方案，而不是在 $.ajaxSetup**
添加

```
cache: false 
```

到你的 $.ajax 电话。

**另一个快速修复**
将“GET”更改为“POST”，因为 POST 没有被缓存。这是否是可行的解决方法取决于您的解决方案。

# android - Android SDK 更新（修订版 18）导致 NullPointer 异常

> ID：10121665
> 
> 赞同：0
> 
> 时间：2012-04-12T10:19:07.990
> 
> 标签：android, nullpointerexception, revision

慢慢地，但我肯定会更新 android SDK...</p>

今天我将 SDK 更新到版本 18 并且我的项目（在更新完美运行之前）即使我只是从 Eclipse 启动它也会引发 NullPointer 异常。我正在使用带有 android ADT 的 eclipse，并且在更新 SDK 后也更新了这部分。我还尝试了“修复项目属性”，但没有结果。

与此同时，我的项目很大，所以一开始我只是发布 LogCat 消息，如果有人需要更多就说出来，我会发布它。但我真的很失望，每次我更新 SDK 时，我的项目都会抛出一些新的、神秘的错误（遇到修订版 17 的外部库问题……）。

希望有人可以帮助我！无论如何，我认为这不是代码的问题。他们在我不知道的地方改变了一些东西：/

**[更新]**

我有一些额外的时间来调试代码。问题出现在构造函数中。它看起来像这样（惊喜，惊喜）：

```
@Override
public void onCreate(Bundle _savedInstanceState) 
{   /// Einstiegspunkt der Android App
    super.onCreate(_savedInstanceState);       
    setContentView(R.layout.login);
    LoadSharedPreferences();
} 
```

在活动尝试转到 LoadSharedPrefrences 方法后引发异常...

**[更新：第 49 行代码]**

```
...
SharedPreferences data = getSharedPreferences(_saveUserDataRef, MODE_PRIVATE);
String tmpUsername = data.getString("username", null);
String tmpPassword = data.getString("password", null);
username.setText(tmpUsername);
password.setText(tmpPassword);
... 
```

如果您希望应用程序为您记住这些数据，此代码段会保存用户名和密码。所以你不需要每次登录都写。

日志猫：

```
04-12 12:09:47.615: D/dalvikvm(1094): GC_EXTERNAL_ALLOC freed 47K, 48% free 2835K/5379K, external 0K/0K, paused 78ms
04-12 12:09:47.686: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$START@401462d0,-1,0,-1,0)
04-12 12:09:47.686: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$END@4011b730,-1,0,-1,0)
04-12 12:09:47.696: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$START@401462d0,-1,0,-1,0)
04-12 12:09:47.696: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$END@4011b730,-1,0,-1,0)
04-12 12:09:47.696: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$START@401462d0,-1,0,-1,0)
04-12 12:09:47.696: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$END@4011b730,-1,0,-1,0)
04-12 12:09:47.696: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$START@401462d0,-1,0,-1,0)
04-12 12:09:47.696: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$END@4011b730,-1,0,-1,0)
04-12 12:09:47.716: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$START@401462d0,-1,0,-1,0)
04-12 12:09:47.716: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$END@4011b730,-1,0,-1,0)
04-12 12:09:47.716: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$START@401462d0,-1,0,-1,0)
04-12 12:09:47.716: I/[POST_RESELECT](1094): [spanChange] (o, oldStart, newStart, oldEnd, newEnd)=(android.text.Selection$END@4011b730,-1,0,-1,0)
04-12 12:09:47.716: D/AndroidRuntime(1094): Shutting down VM
04-12 12:09:47.716: W/dalvikvm(1094): threadid=1: thread exiting with uncaught exception (group=0x400205a0)
04-12 12:09:47.726: E/AndroidRuntime(1094): FATAL EXCEPTION: main
04-12 12:09:47.726: E/AndroidRuntime(1094): java.lang.RuntimeException: Unable to start activity ComponentInfo{de.tzm.seanwesenheitsliste/de.tzm.seanwesenheitsliste.SEAnwesenheitslisteMainActivity}: java.lang.NullPointerException
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1830)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1851)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.app.ActivityThread.access$1500(ActivityThread.java:132)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1038)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.os.Looper.loop(Looper.java:150)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.app.ActivityThread.main(ActivityThread.java:4277)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at java.lang.reflect.Method.invokeNative(Native Method)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at java.lang.reflect.Method.invoke(Method.java:507)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at dalvik.system.NativeStart.main(Native Method)
04-12 12:09:47.726: E/AndroidRuntime(1094): Caused by: java.lang.NullPointerException
04-12 12:09:47.726: E/AndroidRuntime(1094):     at de.tzm.seanwesenheitsliste.SEAnwesenheitslisteMainActivity.LoadSharedPreferences(SEAnwesenheitslisteMainActivity.java:49)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at de.tzm.seanwesenheitsliste.SEAnwesenheitslisteMainActivity.onCreate(SEAnwesenheitslisteMainActivity.java:32)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
04-12 12:09:47.726: E/AndroidRuntime(1094):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1794)
04-12 12:09:47.726: E/AndroidRuntime(1094):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:46:43.293

我无法从您的帖子中看出哪一行是第 49 行，但我的猜测是：

要么：`data`在`null`之后`getSharedPreferences(_saveUserDataRef, MODE_PRIVATE);`

or：其中一个`tmpUsername`or`tmpPassword`是`null`在试图从中获取它们之后`data`。

你能试试看是不是这样吗？如果是这样，您将知道下一步该去哪里解决问题。

# ssis - 我在哪里可以找到 SSIS 脚本组件中的 PreExecute 方法？

> ID：10121670
> 
> 赞同：0
> 
> 时间：2012-04-12T10:19:31.763
> 
> 标签：ssis

我试图在我的 SSIS 包中调用 Net.TCP WCF 服务。我已经设置了脚本组件，在服务参考中将 .NET Framework 更改为 3.5。我正在根据以下链接中提供的示例创建示例包。

[如何配置 SSIS 包以使用 WCF 访问 Web 服务](http://blogs.msdn.com/b/dbrowne/archive/2010/07/08/how-to-configure-an-ssis-package-to-access-a-web-service-using-wcf.aspx)

链接声明要覆盖该*`PreExecute`*方法，但我无法在 SQL 2008 R2 的脚本组件中找到该方法。

我的包中的脚本组件以以下代码开头：

```
[System.AddIn.AddIn("ScriptMain", Version = "1.0", Publisher = "", Description = "")]
public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase 
```

但是，上述文章中编写的示例具有以下代码：

```
[Microsoft.SqlServer.Dts.Pipeline.SSISScriptComponentEntryPointAttribute]
public class ScriptMain : UserComponent 
```

我试过只是复制代码来修复相关的引用，但它没有在哪里包含对*`UserComponent`*.

有人可以指出我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T19:35:52.667

### 问题原因：

您正在使用*Control Flow*选项卡*`Script Task`*上的可用选项，而不是*Data Flow Task*中可用的转换。***`Script Component`***

 **### SSIS 2008 R2 包说明了差异：

*在Business Intelligence Development Studio (BIDS) 2008 R2*中创建一个 SSIS 包，并将其命名为*`SO_10121670.dtsx`*.

BIDS 将默认显示*控制流*选项卡。从工具箱中拖放，*`Script Task`*如下*`Data Flow Task`*所示。

![控制流](../Images/5ec94708cc1803824cf2af389d9372c6.png)

双击*脚本任务*以查看*`Script Task Editor`*. 在*脚本任务编辑器*上，单击*脚本*页面，然后单击*`Edit Script...`*

![脚本任务编辑器](../Images/466f11d0bcb3d0199ed0eb4270525d55.png)

*`Integration Services Script Task`*代码编辑器将打开。您会注意到该类*`ScriptMain`*继承自`Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase`

[MSDN 文章](http://blogs.msdn.com/b/dbrowne/archive/2010/07/08/how-to-configure-an-ssis-package-to-access-a-web-service-using-wcf.aspx)中的示例不使用此*Script Task*。

![脚本任务](../Images/2c221deaa348547c8d38da040066c2ff.png)

在“*控制流*”选项卡上，双击“*数据流任务*”以切换到“*数据流*”选项卡。**`Script Component`**从*Toolbox的**Data Flow Transformations*部分拖放一个。

 *![数据流任务](../Images/c6ef77f387dce489acaf02c1382c9358.png)

拖放*Script Component*时，*`Select Script Component Type`*将出现对话框。您必须选择适合您要求的合适的一种。此示例将类型设置为，*`Source`*以便我们可以查看脚本编辑器。单击*`OK`*。

![选择脚本组件类型](../Images/362c5053527494891b29f50f37131e7c.png)

双击*脚本组件*以查看*`Script Transformation Editor`*. 在*脚本转换编辑器*上，单击*脚本*页面，然后单击*`Edit Script...`*

![脚本转换编辑器](../Images/8d53cdb9dd59acf6cc7b796d862e9583.png)

*`Integration Services Script Component`*代码编辑器将打开。您会注意到该类*`ScriptMain`*继承自`UserComponent`. [这是您在MSDN 博客文章](http://blogs.msdn.com/b/dbrowne/archive/2010/07/08/how-to-configure-an-ssis-package-to-access-a-web-service-using-wcf.aspx)中练习 WCF 示例代码时需要使用的组件。

您可以在您一直在寻找**`PreExecute`**的代码中看到该方法。*`Script Component`*

![脚本组件](../Images/ed019d77f06e43dfcabc574f3e147295.png)***

# amazon-s3 - 如何检索 CloudFront 分配正在使用的 S3 存储桶的名称？

> ID：10121672
> 
> 赞同：1
> 
> 时间：2012-04-12T10:19:40.697
> 
> 标签：amazon-s3, amazon-web-services, amazon-cloudfront

有什么方法可以向 CloudFront API 询问它在 Amazon S3 上使用的存储桶的名称吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:56:05.557

这可以通过[GET Distribution](http://docs.amazonwebservices.com/AmazonCloudFront/latest/APIReference/GetDistribution.html)操作实现：

> 要获取有关分发的信息，请对 2012-03-15/distribution/ 资源执行 GET。

*查看Responses*部分中的示例语法，其中特别包括`S3Origin`or的片段`CustomOrigin`，例如缩写：

```
<Distribution xmlns="http://cloudfront.amazonaws.com/doc/2012-03-15/">
   <!-- ... -->
   <DistributionConfig>
      <S3Origin>
         <DNSName>myawsbucket.s3.amazonaws.com</DNSName>
         <OriginAccessIdentity>origin-access-identity/cloudfront/E127EXAMPLE51Z</OriginAccessIdentity>
      </S3Origin>   
      <!-- ... -->
   </DistributionConfig>
</Distribution> 
```

请注意，*仅当您使用 Amazon S3 源进行分配*时才会返回 S3Origin 元素，而*仅当您使用自定义源进行分配时才会返回 CustomOrigin 元素*。此外，*有关 CustomOrigin 元素和 S3Origin 元素的更多信息，请参阅[DistributionConfig 复杂类型](http://docs.amazonwebservices.com/AmazonCloudFront/latest/APIReference/DistributionConfigDatatype.html)。*

# objective-c - 使用 Restkit 手动添加 ManagedObject

> ID：10121676
> 
> 赞同：0
> 
> 时间：2012-04-12T10:20:07.407
> 
> 标签：objective-c, ios, core-data, nsmanagedobject, restkit

我应该如何手动将托管对象添加到 Restkit 托管对象存储？我正在使用 Restkit 为 SQLite 数据库播种一系列托管对象。Restkit 的所有功能似乎都面向序列化和反序列化对象，但它似乎没有提供用于从其对象存储中手动添加（或删除）对象的 API。

RestKit 添加了一个 NSManagedObject(ActiveRecord) 类别，可用于通过各种类方法检索托管对象，但是我找不到添加新托管对象或删除托管对象的方法。

我是否应该引用 managedObjectContext RestKit 的对象管理器，然后直接操作数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T07:50:51.677

> 我是否应该引用 managedObjectContext RestKit 的对象管理器，然后直接操作数据库？

我绝不是 RestKit 的专家，但这似乎是要走的路。

我不认为 RestKit 试图取代 Core Data，它只是添加了一些方便的东西来设置数据库和在对象通过 Web 服务时转换它们。您在本地对它们所做的一切仍然是您的责任，因此请使用 Core Data 方法。

# java - 如何在android中设置内容长度？

> ID：10121677
> 
> 赞同：1
> 
> 时间：2012-04-12T10:20:12.570
> 
> 标签：java, android, content-length

我想`request.getContentLength()`在服务器客户端 JSP 页面中获取内容大小。但是 request.getContentLength() 总是返回-1，我不知道为什么？

安卓片段代码：

```
URL uri = new URL(actionUrl);
HttpURLConnection conn = (HttpURLConnection) uri.openConnection();
//conn.setChunkedStreamingMode(100);
conn.setConnectTimeout(setTimeOut>0?setTimeOut:timeoutConnection);
conn.setReadTimeout(setTimeOut>0?setTimeOut:timeoutConnection);  
conn.setDoInput(true);
conn.setDoOutput(true);
conn.setUseCaches(false);
conn.setRequestMethod("POST");
conn.setRequestProperty("Connection", "keep-alive");

//conn.setRequestProperty("content-length", "10");
//conn.addRequestProperty("content-length", "20");
conn.setFixedLengthStreamingMode(30);

conn.setRequestProperty("Charsert", ENCODING);
conn.setRequestProperty("Content-Type", "multipart/form-data"
                + ";boundary=" + java.util.UUID.randomUUID().toString());
conn.connect(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T10:28:33.350

您正在使用[conn.setChunkedStreamingMode(100)](http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html#setChunkedStreamingMode%28int%29)当内容长度事先未知时，它将有效地启用 100 字节块的[分块传输编码。](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)

如果您事先知道要在请求正文中发送的内容的长度，请使用[conn.setFixedLengthStreamingMode(int len) 。](http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html#setFixedLengthStreamingMode%28int%29)

# mysql - 多行的 SQL 查询

> ID：10121680
> 
> 赞同：1
> 
> 时间：2012-04-12T10:20:27.563
> 
> 标签：mysql, sql

我有一个看起来像这样的表：

```
---------------------------
|housing_id | facility_id |
---------------------------
|    1      |      7      |
|    1      |      4      |
|    2      |      7      |
--------------------------- 
```

现在我想要做的是获取所有 Housing_id 的设施 ID 为 7 和 4。所以在这种情况下查询应该只返回 Housing_id 1。数据库是mysql。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T10:26:54.750

另一种方法是 -

```
SELECT housing_id
FROM mytable
WHERE facility_id IN (4,7)
GROUP BY housing_id
HAVING COUNT(DISTINCT facility_id) = 2 
```

**更新**- 受 Josvic 评论的启发，我决定进行更多测试，并认为我会包括我的发现。

使用此查询的好处之一是很容易修改以包含更多设施 ID。如果您想查找所有具有 facility_ids 1、3、4 和 7 的 Housing_id，您只需执行以下操作 -

```
SELECT housing_id
FROM mytable
WHERE facility_id IN (1,3,4,7)
GROUP BY housing_id
HAVING COUNT(DISTINCT facility_id) = 4 
```

所有这三个查询的性能因所采用的索引策略而有很大差异。无论使用何种索引，我都无法在我的测试数据集上从依赖子查询版本中获得合理的性能。

Tim 提供的自联接解决方案在给定两列上单独的单列索引的情况下表现非常好，但随着条件数量的增加，表现并不那么好。

这是我的测试表上的一些基本统计数据 - 500k 行 - 147963 个 Housing_ids，facility_id 的潜在值在 1 到 9 之间。

以下是用于运行所有这些测试的索引 -

```
SHOW INDEXES FROM mytable;
+---------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+
| Table   | Non_unique | Key_name            | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type |
+---------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+
| mytable |          0 | UQ_housing_facility |            1 | housing_id  | A         |      500537 |     NULL | NULL   |      | BTREE      |
| mytable |          0 | UQ_housing_facility |            2 | facility_id | A         |      500537 |     NULL | NULL   |      | BTREE      |
| mytable |          0 | UQ_facility_housing |            1 | facility_id | A         |          12 |     NULL | NULL   |      | BTREE      |
| mytable |          0 | UQ_facility_housing |            2 | housing_id  | A         |      500537 |     NULL | NULL   |      | BTREE      |
| mytable |          1 | IX_housing          |            1 | housing_id  | A         |      500537 |     NULL | NULL   |      | BTREE      |
| mytable |          1 | IX_facility         |            1 | facility_id | A         |          12 |     NULL | NULL   |      | BTREE      |
+---------+------------+---------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+ 
```

测试的第一个查询是依赖子查询 -

```
SELECT SQL_NO_CACHE DISTINCT housing_id
FROM mytable
WHERE housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=4)
AND housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=7);

17321 rows in set (9.15 sec)

+----+--------------------+---------+-----------------+----------------------------------------------------------------+---------------------+---------+------------+--------+---------------------------------------+
| id | select_type        | table   | type            | possible_keys                                                  | key                 | key_len | ref        | rows   | Extra                                 |
+----+--------------------+---------+-----------------+----------------------------------------------------------------+---------------------+---------+------------+--------+---------------------------------------+
|  1 | PRIMARY            | mytable | range           | NULL                                                           | IX_housing          | 4       | NULL       | 500538 | Using where; Using index for group-by |
|  3 | DEPENDENT SUBQUERY | mytable | unique_subquery | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | func,const |      1 | Using index; Using where              |
|  2 | DEPENDENT SUBQUERY | mytable | unique_subquery | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | func,const |      1 | Using index; Using where              |
+----+--------------------+---------+-----------------+----------------------------------------------------------------+---------------------+---------+------------+--------+---------------------------------------+

SELECT SQL_NO_CACHE DISTINCT housing_id
FROM mytable
WHERE housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=1)
AND housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=3)
AND housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=4)
AND housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=7);

567 rows in set (9.30 sec)

+----+--------------------+---------+-----------------+----------------------------------------------------------------+---------------------+---------+------------+--------+---------------------------------------+
| id | select_type        | table   | type            | possible_keys                                                  | key                 | key_len | ref        | rows   | Extra                                 |
+----+--------------------+---------+-----------------+----------------------------------------------------------------+---------------------+---------+------------+--------+---------------------------------------+
|  1 | PRIMARY            | mytable | range           | NULL                                                           | IX_housing          | 4       | NULL       | 500538 | Using where; Using index for group-by |
|  5 | DEPENDENT SUBQUERY | mytable | unique_subquery | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | func,const |      1 | Using index; Using where              |
|  4 | DEPENDENT SUBQUERY | mytable | unique_subquery | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | func,const |      1 | Using index; Using where              |
|  3 | DEPENDENT SUBQUERY | mytable | unique_subquery | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | func,const |      1 | Using index; Using where              |
|  2 | DEPENDENT SUBQUERY | mytable | unique_subquery | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | func,const |      1 | Using index; Using where              |
+----+--------------------+---------+-----------------+----------------------------------------------------------------+---------------------+---------+------------+--------+---------------------------------------+ 
```

接下来是我使用 GROUP BY ... HAVING COUNT ... 的版本

```
SELECT SQL_NO_CACHE housing_id
FROM mytable
WHERE facility_id IN (4,7)
GROUP BY housing_id
HAVING COUNT(DISTINCT facility_id) = 2;

17321 rows in set (0.79 sec)

+----+-------------+---------+-------+---------------------------------+-------------+---------+------+--------+------------------------------------------+
| id | select_type | table   | type  | possible_keys                   | key         | key_len | ref  | rows   | Extra                                    |
+----+-------------+---------+-------+---------------------------------+-------------+---------+------+--------+------------------------------------------+
|  1 | SIMPLE      | mytable | range | UQ_facility_housing,IX_facility | IX_facility | 4       | NULL | 198646 | Using where; Using index; Using filesort |
+----+-------------+---------+-------+---------------------------------+-------------+---------+------+--------+------------------------------------------+

SELECT SQL_NO_CACHE housing_id
FROM mytable
WHERE facility_id IN (1,3,4,7)
GROUP BY housing_id
HAVING COUNT(DISTINCT facility_id) = 4;

567 rows in set (1.25 sec)

+----+-------------+---------+-------+---------------------------------+-------------+---------+------+--------+------------------------------------------+
| id | select_type | table   | type  | possible_keys                   | key         | key_len | ref  | rows   | Extra                                    |
+----+-------------+---------+-------+---------------------------------+-------------+---------+------+--------+------------------------------------------+
|  1 | SIMPLE      | mytable | range | UQ_facility_housing,IX_facility | IX_facility | 4       | NULL | 407160 | Using where; Using index; Using filesort |
+----+-------------+---------+-------+---------------------------------+-------------+---------+------+--------+------------------------------------------+ 
```

最后但并非最不重要的自我加入 -

```
SELECT SQL_NO_CACHE a.housing_id
FROM mytable a
INNER JOIN mytable b
    ON a.housing_id = b.housing_id
WHERE a.facility_id = 4 AND b.facility_id = 7;

17321 rows in set (1.37 sec)

+----+-------------+-------+--------+----------------------------------------------------------------+---------------------+---------+-------------------------+-------+-------------+
| id | select_type | table | type   | possible_keys                                                  | key                 | key_len | ref                     | rows  | Extra       |
+----+-------------+-------+--------+----------------------------------------------------------------+---------------------+---------+-------------------------+-------+-------------+
|  1 | SIMPLE      | b     | ref    | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | IX_facility         | 4       | const                   | 94598 | Using index |
|  1 | SIMPLE      | a     | eq_ref | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | test.b.housing_id,const |     1 | Using index |
+----+-------------+-------+--------+----------------------------------------------------------------+---------------------+---------+-------------------------+-------+-------------+

SELECT SQL_NO_CACHE a.housing_id
FROM mytable a
INNER JOIN mytable b
    ON a.housing_id = b.housing_id
INNER JOIN mytable c
    ON a.housing_id = c.housing_id
INNER JOIN mytable d
    ON a.housing_id = d.housing_id
WHERE a.facility_id = 1
AND b.facility_id = 3
AND c.facility_id = 4
AND d.facility_id = 7;

567 rows in set (1.64 sec)

+----+-------------+-------+--------+----------------------------------------------------------------+---------------------+---------+-------------------------+-------+--------------------------+
| id | select_type | table | type   | possible_keys                                                  | key                 | key_len | ref                     | rows  | Extra                    |
+----+-------------+-------+--------+----------------------------------------------------------------+---------------------+---------+-------------------------+-------+--------------------------+
|  1 | SIMPLE      | b     | ref    | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | IX_facility         | 4       | const                   | 93782 | Using index              |
|  1 | SIMPLE      | d     | eq_ref | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | test.b.housing_id,const |     1 | Using index              |
|  1 | SIMPLE      | c     | eq_ref | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | test.b.housing_id,const |     1 | Using index              |
|  1 | SIMPLE      | a     | eq_ref | UQ_housing_facility,UQ_facility_housing,IX_housing,IX_facility | UQ_housing_facility | 8       | test.d.housing_id,const |     1 | Using where; Using index |
+----+-------------+-------+--------+----------------------------------------------------------------+---------------------+---------+-------------------------+-------+--------------------------+ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-12T10:23:13.520

```
SELECT housing_id
FROM mytable
WHERE housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=4)
AND housing_id IN (SELECT housing_id FROM mytable WHERE facility_id=7) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-12T10:35:56.370

您也可以进行自我 JOIN，最快的一个将在很大程度上取决于您的表中有多少数据。

```
SELECT a.housing_id
FROM mytable a
INNER JOIN mytable b
ON a.housing_id = b.housing_id AND a.facility_id <> b.facility_id
WHERE a.facility_id = 4 AND b.facility_id = 7 
```

# java - 禁用 TreeGrid XML 缓存

> ID：10121690
> 
> 赞同：2
> 
> 时间：2012-04-12T10:20:46.923
> 
> 标签：java, gwt, caching, smartgwt

我有一个具有 XML 数据源的树网格。现在，即使更改了 XML 并刷新页面，也会显示旧树而不是新树。我也尝试将数据源设置为`setPreventHTTPCaching(true);`.

# objective-c - 将 JSON 解码为 NSArray 或 NSDictionary

> ID：10121693
> 
> 赞同：12
> 
> 时间：2012-04-12T10:20:48.687
> 
> 标签：objective-c, json

我希望解码下面的JSON数据：

```
{
    "content":
    [   
        {
            "1":"a",
            "2":"b",
            "3":"c",
            "4":"d",
            "mark":"yes"
        }
    ]
} 
```

不确定是放在 NSArray 还是 NSDictionary

欢迎任何评论

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-12T10:25:31.490

您使用的是哪个 iOS 版本？在 iOS 5 中，您有`NSJSONSerialization`解析 JSON 数据的类，如果您需要针对较旧的 iOS 或 MAC OSX，您应该使用第三方库，例如`SBJSON`. 发布的字符串将是一个带有一个字典的数组的 NSDictionary。可以使用密钥访问该数组`@"content"`

在代码中：

```
NSString * jsonString = @"blblblblblb";
NSStringEncoding  encoding;
NSData * jsonData = [jsonString dataUsingEncoding:encoding];
NSError * error=nil;
NSDictionary * parsedData = [NSJSONSerialization JSONObjectWithData:jsonData options:kNilOptions error:&error]; 
```

在 SWIFT 2.0 中：

```
 let jsonString = "blblblblblb"
    let encoding = NSUTF8StringEncoding
    let jsonData = jsonString.dataUsingEncoding(encoding)
    guard let jData = jsonData else {return}
    do {
        let parsedData = try NSJSONSerialization.JSONObjectWithData(jData, options: [])
    } catch let error {
        print("json error: \(error)")
    } 
```

[更新] 该`NSJSONSerialization`课程也可用于 10.7 我的评论不正确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T10:42:22.780

该特定字符串将解码为 NSDictionary，因为最外面的是一个 JSON 对象，它映射到我见过的每个 JSON 实现的 NSDictionary。如果要处理任意字符串，则需要测试返回的内容

```
NSError *jsonError;
id parsedThing = [NSJSONSerialization JSONObjectWithData:data options:0 error:&jsonError];
if (parsedThing == nil)
{
    // error
}
else if ([parsedThing isKindOfClass: [NSArray class]])
{
    // handle array, parsedThing can be cast as an NSArray safely
}
else
{
    // handle dictionary, parsedThing can be cast as an NSDictionary
    // NB only dictionaries and arrays allowed as long as NSJSONReadingAllowFragments 
    // not specified in the options
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-10T09:57:18.237

`stringWithContentsOfFile:encoding:`已弃用`iOS<6`

为了`iOS 6+`

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"contents" ofType:@"json"];
NSError * error=nil;
NSString *jsonString = [NSString stringWithContentsOfFile:filePath encoding:nil error:&error];
NSData * jsonData = [jsonString dataUsingEncoding:nil];
NSArray * parsedData = [NSJSONSerialization JSONObjectWithData:jsonData options:kNilOptions error:&error]; 
```

`contents.json`文件在您的捆绑包中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:25:21.833

您可以执行以下操作：

```
NSData *data = ...; //JSON data
NSError *jsonError = nil;
[NSJSONSerialization JSONObjectWithData:data options:0 error:&jsonError]; 
```

您将返回一个`NSDictionary`包含一个包含五个对象`NSArray`的单个对象。`NSDictionary``NSString`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-17T11:02:15.050

我使用了谷歌语音识别 API，我得到了一个无法在 iOS 上直接解析的 json 响应。结果样本如下：

首先，我尝试说 Hello 1 2 3，这被识别没有问题。Json 响应是：

```
{"result":[]}

{"result":[{"alternative":[{"transcript":"hello 123","confidence":0.59780568},{"transcript":"hello 1 2 3"}],"final":true}],"result_index":0} 
```

或者当谈得太久时，我得到了一个 404 HTML，如下所示：

```
<html><title>Error 400 (Bad Request)!!1</title></html> 
```

当我胡言乱语时，我得到了：

```
{"result":[]} 
```

因此，为了解析所有此类响应，我使用了以下代码：

```
 NSString *msg = @"Could not synthesize !";

    NSString *responseString = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
    NSLog(@"responseString: %@",responseString);
    if([responseString containsString:@"transcript"]&&responseString.length>25)
    {

        responseString = [responseString stringByReplacingOccurrencesOfString:@"{\"result\":[]}" withString:@""];

        NSDictionary *dictionary = [NSJSONSerialization JSONObjectWithData:[responseString dataUsingEncoding:NSUTF8StringEncoding] options:kNilOptions error:nil];

        if(dictionary!=nil)
            if(dictionary.allValues.count>0)
            {

                NSArray *array =[dictionary valueForKeyPath:@"result.alternative.transcript"];

                if(array)
                {
                    NSArray *array2 = [array objectAtIndex:0];
                    if(array2)
                    {
                        NSLog(@"%@",[array2 objectAtIndex:0] );
                        msg = [array2 objectAtIndex:0];
                    };
                }
            }
    }

    UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Google Response" message:msg delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
    [alert show]; 
```

希望这可以帮助某人。

# facebook - 事件表和 FB 事件页面上的 Facebook start_time 有什么区别？

> ID：10121694
> 
> 赞同：3
> 
> 时间：2012-04-12T10:21:01.773
> 
> 标签：facebook, facebook-graph-api, facebook-fql

我正在使用[资源管理](https://developers.facebook.com/tools/explorer)器来测试这个[事件](https://www.facebook.com/events/359724487410779)

FQL 到[事件表](https://developers.facebook.com/docs/reference/fql/event/)：fql?q={'events': 'select eid, name, start_time from event where eid = 359724487410779'} - 返回 start_time = 1337410800
转换 1337410800 给出 2012 年 5 月 19 日星期六 07:00:00（格林威治标准时间） )

FB api 资源管理器中的事件对象：[https](https://graph.facebook.com/359724487410779) ://graph.facebook.com/359724487410779 - 返回 start_time = 2012-05-19T00:00:00

浏览器中的事件对象：[https](https://graph.facebook.com/359724487410779) ://graph.facebook.com/359724487410779 - 返回 start_time = 2012-05-18T14:00:00

FB 页面[https://www.facebook.com/events/359724487410779](https://www.facebook.com/events/359724487410779) - UTC+02 2012 年 5 月 18 日星期五晚上 11:00 至凌晨 4:00

如何获得正确的当地时间，例如基于 Facebook API 的 FB 事件页面（2012 年 5 月 18 日星期五晚上 11:00）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-16T18:30:46.610

1.  事件表 - 它包含事件的时间（格林威治标准时间），如果它在太平洋地区（见[这里](https://developers.facebook.com/docs/reference/api/event/)） - 所以 1337410800 会给你格林威治标准时间 5 月 19 日上午 7 点 -> 这是太平洋标准时间 5 月 18 日晚上 11 点 - 这是如果您删除时区，则该事件。

2.  FB api explorer 中的事件对象 - 它返回转换为您的 Facebook 个人资料时区的时间 - 例如（EST）给我 2012-05-18T17:00:00。同样，这将转换为欧洲中部时间 5 月 18 日晚上 11 点

3.  浏览器中的事件对象 - 即直接调用 FB API - 为您提供 PST 时区的开始时间（太平洋标准时间下午 2 点 -> 欧洲/阿姆斯特丹时区晚上 11 点）

4.  FB页面明显有LOCAL时间

**回答您的问题**- 我个人会使用 Graph API 调用并将**start_time**从太平洋转换为 UTC。然后使用“ **timezone: Europe/Amsterdam** ”将UTC时间转换为本地时间。

# sql - 连接 VB Script 和 SQL Plus ，将值传递给 Query

> ID：10121695
> 
> 赞同：0
> 
> 时间：2012-04-12T10:21:04.770
> 
> 标签：sql, scripting, vbscript, sqlplus

从文本文件读取后，我尝试使用存储在变量中的值连接到 SQLplus，并尝试更新表，但出现以下错误：“未终止的字符串常量这是代码的样子，感谢 Guido 的帮助我在第 1 步上。谁能指出错误。If & Else Part 中的一些错误，SQL 查询或连接错误

```
dim fs, txt, line, yesno , cust_id
set fs = CreateObject("Scripting.FileSystemObject")
set txt = fs.OpenTextFile("E:\batchfiletest\Eapp3\scotia1.txt", 1, false) 

' loop through all the lines
do while not txt.AtEndOfStream
    line = txt.readLine

' read the character and store it in a variable
    yesno = Mid(line, 127, 1)
    cust_id = Mid(line, 1,20)   

' execute the correct query
    if yesno = "Y" then

    set WshShell = CreateObject("WScript.Shell")
    set oEnv=WshShell.Environment("Process") 
    cmdString = "E:\oracle\product\10.2.0\db_1\BIN\sqlplusw.exe -S sysman/csaadmin@convcsd

    UPDATE csa_sli_all.T_CONV_quote set HOLD_CODE = 'CAQ' where quote_id =  cust_id ;
    commit;"

    Set oExec = WshShell.Exec(cmdString)

     ELSE  
    set WshShell = CreateObject("WScript.Shell")
    set oEnv=WshShell.Environment("Process") 
    cmdString = "E:\oracle\product\10.2.0\db_1\BIN\sqlplusw.exe -S sysman/csaadmin@convcsd

    UPDATE csa_sli_all.T_CONV_quote set HOLD_CODE = 'PVQ' where quote_id =  cust_id ;
    commit;"

    Set oExec = WshShell.Exec(cmdString)

    end if
loop
MsgBox "Press OK to close when done reading the output." 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:15:20.003

正常的更快更安全的方法是这样的

```
Const sConnectionStringOracle =  "Provider=OraOLEDB.Oracle;Data Source=xxxx.xxxxx;User id=xxx;password=xxx"
Set oConn = Server.CreateObject("ADODB.Connection")
oConn.open sConnectionStringOracle
sql = "UPDATE csa_sli_all.T_CONV_quote set HOLD_CODE = 'CAQ' where quote_id = " & cust_id
oConn.execute(sql)
'rest of the database transactions
oConn.close
Set oConn = nothing 
```

您可以添加错误捕获、日志记录等。只要确保您在使用它的电脑上安装了 Oracle OleDb 驱动程序即可。如果您需要使用 Sql*Plus，则将所有事务写入一个 sql 文本文件并只运行一次。然后，您可以在出现错误时执行和调试 sql。

格茨

# c# - 如何向 3000 多个客户发送同一封电子邮件

> ID：10121698
> 
> 赞同：-7
> 
> 时间：2012-04-12T10:21:10.417
> 
> 标签：c#, asp.net, email, outlook

我想向 3000 多个客户发送相同的电子邮件，最好、最短的方法是什么？是否有工具可以获取电子邮件地址列表和电子邮件正文？注意：我有邮件服务器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:31:15.030

```
List<Customer> customerList = GetAllCustomers();

string subject = "Hello World";
string content = GetContent();

// Loop through all customers and send e-mail to each
foreach(Customer customer in customerList)
{
   MailMessage newMail = new MailMessage("you@yourcompany.com", customer.Email, subject, content);

   newMail.IsBodyHtml = true;

   SmtpClient sender = new SmtpClient();

   sender.Send(newMail);
} 
```

如果您有客户个性化的电子邮件，您可以在循环中移动 GetContent()。

我希望你得到他们的许可给他们发送电子邮件。我与您共享此代码的前提是它**不会**被用于向人们发送垃圾邮件。

# api - HDFS 中 hflush 和 hsync api 的区别

> ID：10121705
> 
> 赞同：8
> 
> 时间：2012-04-12T10:21:45.030
> 
> 标签：api, filesystems, hadoop, hdfs

有人可以突出技术细节以及何时使用哪个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-25T02:43:52.950

在当前的 HDFS(0.23.3) 实现中，`hflush`和`hsync`是相同的。[hsync](http://www.grepcode.com/file/repo1.maven.org/maven2/org.apache.hadoop/hadoop-common/0.23.3/org/apache/hadoop/fs/Syncable.java#Syncable.hsync%28%29)调用`hflush`. `hflush`保证刷新的数据对新读者可见。不能保证数据已刷新到数据节点上的持久存储。因此，`hflush`如果数据节点发生故障，使用可能会丢失一些数据。`hsync`旨在保证所有数据都写入磁盘设备但**现在没有实现**。

在 alpha HDFS 2.0.* 中，正确实现了[hsync 。](http://www.grepcode.com/file/repo1.maven.org/maven2/org.apache.hadoop/hadoop-common/2.0.2-alpha/org/apache/hadoop/fs/Syncable.java#Syncable.hsync%28%29)

您可以在[HBase、HDFS 和持久同步](http://hadoop-hbase.blogspot.com/2012/05/hbase-hdfs-and-durable-sync.html)中获得更多详细信息。

# windows - 在 Windows 服务器上设置 RabbitMQ 集群

> ID：10121706
> 
> 赞同：3
> 
> 时间：2012-04-12T10:21:47.563
> 
> 标签：windows, erlang, rabbitmq, cluster-computing

我正在尝试在 Windows 服务器上设置 RabbitMQ 集群，这需要使用共享的 Erlang cookie 文件。根据文档，我需要做的就是确保不同机器上的根目录包含相同的 .erlang.cookie 文件。所以我所做的是在两台机器上找到这些文件并用相同的共享版本覆盖它们。

之后，所有 rabbitmqctl 命令在新文件版本的机器上都失败，并显示“无法连接到节点...”错误消息。我试图重新启动 RabbitMQ Windows 服务，但还是 rabbitmqctl 抱怨。我什至在那台机器上重新安装了 RabbitMQ，但随后 .erlang.cookie 被重置回旧版本。每当我尝试使用新版本的 cookie 文件时，rabbitmqctl 都会失败。当我恢复旧版本时，它运行良好。

基本上我被卡住了，在我解决这个问题之前无法继续进行集群设置。任何帮助表示赞赏。

更新：收到 RabbitMQ 的答复：“rabbitmqctl 将从用户主目录获取 cookie，而服务将从 C:\windows 获取它。因此，您需要将它们彼此同步，以及与其他同步机器。”

这基本上意味着 cookie 文件需要在两个位置进行替换：C:\Windows 和 current_user。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T23:27:38.990

你有上述正确的。该服务将`C:\Windows`在您用于`rabbitmqctl.bat`查询状态时使用 cookie，它正在使用您的用户目录 ( `%USERPROFILE%`) 中的 cookie。

当 cookie 不匹配时，错误看起来像

```
C:\Program Files (x86)\RabbitMQ Server\rabbitmq_server-2.8.2\sbin>rabbitmqctl.bat status
Status of node 'rabbit@PC-FOOBAR' ...
Error: unable to connect to node 'rabbit@PC-FOOBAR': nodedown

DIAGNOSTICS
===========

nodes in question: ['rabbit@PC-FOOBAR']

hosts, their running nodes and ports:
- PC-FOOBAR: [{rabbit,49186},{rabbitmqctl30566,63150}]

current node details:
- node name: 'rabbitmqctl30566@pc-foobar'
- home dir: U:\
- cookie hash: Vp52cEvPP1PukagWi5S/fQ== 
```

`%HOMEDIR%`在 Windows 上，`%HOMEPATH%`RabbitMQ `U:\`cookie还有一个问题...一个它组成一个并写在那里。这让我在试图让它工作时把头撞在桌子上很长一段时间。一旦我发现了这个问题，很明显 cookie 文件就是问题所在（如记录所示），它们只是在一个奇怪的位置（未记录在 AFAIK 中）。

希望这能解决一些人在 Windows 上设置 RabbitMQ 集群的痛苦。

# php - 是否有可能对 RedBeanPHP 中的表结构故意严格？

> ID：10121708
> 
> 赞同：3
> 
> 时间：2012-04-12T10:22:02.707
> 
> 标签：php, redbean

我真的很喜欢 RedBeanPHP 的概念。正在开发中的人不必担心使用数据库，RedBean 会为您完成这一切。表格在您工作时自行形成，当您对表格感到满意时，您可以冻结它们。我看到的唯一问题是当您将项目移动到新系统时。ORM 的重要部分之一是数据库表是从 PHP 模型创建的，这意味着您不必经常导出数据库结构以保证其安全。我看不出这将如何使用 RedBean 来完成，因为它在随着时间的**推移**反复使用可变数据后形成了表结构。

我意识到事先定义表的结构会削弱首先使用RedBean的点，但我至少想在开发过程中以“动态模式”使用RedBean之后在PHP中定义数据库的结构，所以在系统之间移动项目不会那么痛苦。

我希望我的顾虑足够清楚，可以让曾经使用过 RedBeanPHP 并且可能以前遇到过这个问题的人能够解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T15:02:51.160

刚刚发现可以在 RedBean 中使用元数据来强制类型：

```
$bean->setMeta('cast.myproperty', 'text'); 
```

在这里找到：[http ://redbeanphp.com/extra/meta_data](http://redbeanphp.com/extra/meta_data)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T15:35:29.043

可以扩展该`R::freeze`方法以创建一个空的 sqlite 数据库并用`R::syncSchema`结构填充它。然后在生产中，任务可以使用相同的方法来反转过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-17T12:22:59.410

我还没有执行它，但我的想法是制作一个使用 FUSE 加载所有 bean 类型的迁移脚本，并迭代地为每种 bean 类型创建一个带有假数据的 bean（基于 bean 的元数据信息）并存储它。这将基于模型重新创建表结构，然后脚本将截断表并将生产数据导入其中。

不是很优雅，因为您需要在模型中的某处声明数据库结构，但是使用零配置是不可能实现的。

# php - php socket_write 覆盖阻塞和非阻塞套接字

> ID：10121711
> 
> 赞同：0
> 
> 时间：2012-04-12T10:22:25.207
> 
> 标签：php, sockets, unix

我编写了通过 unix 本地套接字与服务器通信的 php 脚本。1) 连接 2) 使用 socket_write() 发送消息（90% 的时间是小块，10% 是大块） 3) 得到答案 4) 关闭连接

现在，我有简单的 socket_write() 实现，如[php 手册](http://php.net/manual/en/function.socket-write.php)“jean at briskula dot si 03-Feb-2011 03:00”的评论中所建议的那样

似乎它在阻塞模式下工作正常，但我想为 socket_write 实现超时，因此我认为（需要）在调用 socket_write() 时使用非阻塞模式。

**阻塞模式比非阻塞模式有什么优势吗？是否有理由实现超时？如何正确认识它们？有什么例子吗？**

试着写了一会儿，但是得到了===FALSE，可能每次调用socket_write()之前都需要socket_select()？

附言。从服务器读取答案时，这个问题对于 socket_read() 也是实际的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:43:57.580

对于通过套接字向后端系统发送数据/从后端系统接收数据的 PHP（面向 Web）脚本，同时没有机会进行其他处理（这基本上是您首先要使用非阻塞模式的原因） ，处理非阻塞模式引起的并发症是没有意义的。

所以，坚持阻塞模式。

# asp.net-mvc-2 - Asp.Net MVC 2 模型与 ASPNetSpell 文本框绑定

> ID：10121713
> 
> 赞同：0
> 
> 时间：2012-04-12T10:22:32.990
> 
> 标签：asp.net-mvc-2

如何将模型中的一些数据绑定到 ASPNetSpell 文本框？

```
<ASPNetSpell:SpellTextBox ID="SpellTextBox1" runat="server">Some text to spell check</ASPNetSpell:SpellTextBox> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:38:26.613

看起来它是服务器控件，您不能在 ASP.NET MVC 中使用它。

[您可以在那里](https://stackoverflow.com/questions/3972777/spell-checker-for-my-asp-net-mvc-application)或[那里](https://stackoverflow.com/questions/3810962/is-there-a-spell-checker-for-asp-net-mvc)或[那里](http://forums.asp.net/t/1629017.aspx/1)找到一些用于 asp.net mvc 项目的拼写检查器。

更新：你抓住我。有用。上次不小心查了官网。您是否检查了“如何”示例？

[ASPNetSpell 入门](http://aspnetspell.com/Getting_Started)

[ASPNetSpell 和 MVC](http://aspnetspell.com/MVCInstallation)

[ASPNetSpell 和 .Net Razor 框架](http://aspnetspell.com/Razor)

# iphone - Xcode UIProgressBar 不增加

> ID：10121715
> 
> 赞同：4
> 
> 时间：2012-04-12T10:22:48.903
> 
> 标签：iphone, objective-c, ios, cocoa-touch, uiprogressview

我正在尝试增加进度条并在标签上显示百分比。但是，当调用“incrementaProgres”函数时，两者都保持不变。`IBOutlets`正确链接`xib`并测试，当函数被调用时，变量具有正确的值。谢谢

来自代表：

```
loadingViewController *theInstanceP = [[loadingViewController alloc] init];
[theInstanceP performSelectorOnMainThread:@selector(incrementaProgres:) withObject:[NSNumber numberWithFloat:0.15] waitUntilDone:YES]; 
```

加载视图类：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [spinner startAnimating];
    [progress setProgress:0.0];
}

- (void)incrementaProgres: (CGFloat)increment{

    [progress setProgress:(progresInc + increment)];
    carrega.text = [NSString stringWithFormat: @"%f", (progresInc + increment)];

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:27:27.607

进度条的[进度](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIProgressView_Class/Reference/Reference.html)值介于`0.0`和之间`1.0`，您的代码将其设置为 的增量`15.0`，超出范围。你的增量应该是`0.15`，不是`15.0`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:27:17.123

进度是一个介于 0.0 和 1.0 之间的值。

编辑：你试过打电话`[myView setNeedsDisplay];`吗？

第二次编辑：

也许有一个混淆：`viewDidLoad`在你呈现视图之前被调用。因此，在您在此处显示的代码`incrementaProgres:`中调用 before `viewDidLoad`。

# java - 如何使用 JAXB 从 XML 中写入和读取特殊字符和符号

> ID：10121717
> 
> 赞同：2
> 
> 时间：2012-04-12T10:22:53.223
> 
> 标签：java, xml, jaxb

有一个用于生成 XML 文件的`JavaRCP`应用程序`JAXB`，它基本上从文本框中获取输入（也包括特殊字符）以保存在 xml 中并通过从 xml 中解组来显示相同​​的内容。

用户正在复制控制台输出（可能包含特殊字符）并粘贴到文本框中并将其保存到 xml 中。

```
xml 版本="1.0" 编码="UTF-8"

jaxb 版本是 JDK 1.6_21 中的 2.1.10。

```

解组时，收到解组异常：

```
[org.xml.sax.SAXParseException: An invalid XML character (Unicode: 0x1b) was found in the element content of the document]
```

解组 xml 时发现无效的 XML 字符。我在这个论坛上搜索了一些帮助，发现链接很少，但它们都没有解决方案或解决方法。谁能指导我。

我尝试过使用其他编码类型，但没有成功。在保存/编组之前，我是否需要用等效的字符代码替换该字符？

以下是更接近我的问题的链接： [Saving an escape character 0x1b in an XML file](https://stackoverflow.com/questions/4134438/saving-an-escape-character-0x1b-in-an-xml-file) [Invalid Characters in XML](https://stackoverflow.com/questions/730133/invalid-characters-in-xml)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:43:47.687

描述此问题的[JAXB 错误报告](http://java.net/jira/browse/JAXB-226)已关闭，解释如下：

> 抱歉，这只是 XML 中的一个限制。
> 
> 在 XML 中，不允许使用控制字符。[请参阅http://www.w3.org/TR/REC-xml/#NT-Char](http://www.w3.org/TR/REC-xml/#NT-Char)上的允许字符列表
> 
> 这不是逃避[http://www.w3.org/TR/REC-xml/#sec-references](http://www.w3.org/TR/REC-xml/#sec-references)的问题。像 \u001C 这样的字符根本不是 XML 中的有效字符。无法传输包含这些字符的字符串。
> 
> 您的选择是提出自己的字符串编码方案以使您的字符串“XML 安全”，或者使用二进制编码，例如 base64。

因此，绝对没有办法在 XML 中表示这些字符。如果这些字符串的精确表示对您的应用程序不重要，您可以删除这些字符或用一些占位符替换它们，否则您必须使用一些安全的编码方案（例如 Base64）对这些字符串进行编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:59:28.143

是的，您不想删除 CONTROL CHAR，您可以转义字符。
您可以使用 java.net.URLEncoder 在服务器端对数据进行编码，然后在客户端使用 java.net.URLDecoder 对其进行解码。
它就像魅力一样，我已经将它用于相同的目的并且工作正常。

如果您在代码中手动替换 0x1b，则有一天您会发现其他一些 CONTROL CHAR。所以我认为更好的方法是使用编码器/解码器，如果你想保存数据否则远程它。

你可以在这里参考我的问题：[非法字符 - CTRL-CHAR](https://stackoverflow.com/questions/4849387/illegal-character-ctrl-char)

# c# - 使用 protogen 为每个文件输出一个 C# 类？

> ID：10121719
> 
> 赞同：2
> 
> 时间：2012-04-12T10:23:16.607
> 
> 标签：c#, protocol-buffers, protogen

是否可以基于单个 .proto 文件让 protogen 输出多个文件（每个类一个）？

我正在使用一个非常大的 .proto 文件，该文件输出大约 200 个类，目前都在一个文件中。我需要使用生成的类的地方之一是内存高度受限的环境（Windows Phone 后台代理）。

我希望能够在受约束的环境中加载的程序集中只包含必要的类，但是当生成的类都在一个文件中时不能轻易做到这一点。如果我可以将它们输出到多个文件，我只能链接到我在程序集中需要的受约束环境的文件。

有没有办法让 protogen 在单独的文件中输出类？我看不到此选项，目前仅使用该`umbrella-classname`选项。

手动编辑生成的文件不是一种选择，所以如果 protogen 不能这样做，是否有另一个可用的命令行工具可以拆分包含多个类的文件？（为了避免重新发明轮子。）

**更新**
我正在使用`Google.ProtocolBuffers.dll`继承的决定并且不容易改变。
编辑/拆分 .proto 文件也不可行。（除非作为自定义步骤。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T13:02:32.763

我们在 csharp_options 中有一个选项，但它没有实现：

```
// Whether to generate a single file for everything within the
// .proto file (false), or one file per message (true).
// This option is not currently honored; please log a feature
// request if you really want it.
optional bool multiple_files = 4; 
```

鉴于您必须删除相关文件*并确保您拥有正确的所有依赖项*，听起来它实际上不会为您节省很多工作而不是我建议的解决方案，即将您的原始文件拆分为单独的文件您说这“也不可能”，但基本上这就是我目前所能建议的全部 -*为什么*这不是一种可能性？

编辑：我刚刚有了另一个想法。您可能会运行`protoc`步骤`protogen`（如果您没有另外指定，现在会自动完成）将`.proto`文件解析为其描述符。然后在另一个程序中加载描述符，像对任何其他 protobuf 消息一样对其进行变异（从它创建一个构建器，编辑消息，构建），然后保存描述符。然后，您可以在剩余的描述符上使用 protogen，并仅生成您想要的类...

# javascript - 具有不同 y 轴/刻度的分组条形图

> ID：10121720
> 
> 赞同：1
> 
> 时间：2012-04-12T10:23:20.170
> 
> 标签：javascript, d3.js

我正在尝试创建一个包含 70 个样本和 2 个系列的分组条形图。与此示例类似：

[http://bl.ocks.org/882152](http://bl.ocks.org/882152)

然而，一个系列是 [0 ... 1]，另一个系列是 [0 ... 1.000.000]。我无法用我的数字重新创建示例。

我也不太明白这个例子。不应该是变量切换，即x -> y，y0 -> x0 和y1 -> x0？还是它们不代表 x 和 y 轴？

谢谢！

编辑：

这是一个演示我的问题的示例（查看控制台）。 [http://jsfiddle.net/kQSGF/3/](http://jsfiddle.net/kQSGF/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-14T03:45:30.823

问题似乎来自规模定义：

```
var x = d3.scale.linear().domain([0, 1]).range([h, 0]); 
```

域设置为 [0,1] 但只有您的第一个数据系列实际上属于该范围。您可以考虑将域设置为数据范围，并反转输出范围，以便将数据中的值而不是“非”值量显示为条形：

```
var x = d3.scale.linear().domain(d3.extent(d3.merge(data))).range([0,h]); 
```

请注意，您仍然不太可能看到较小的数据系列，因为您的数据范围差异很大

# sql - 在 MSaccess 数据库中插入日期。

> ID：10121728
> 
> 赞同：0
> 
> 时间：2012-04-12T10:23:47.217
> 
> 标签：sql, date, dojo

我想执行一个插入查询来插入一些包含日期的值集。我收到数据类型不匹配错误。

在我的访问数据库中，我设置了 Ass_date`(as Short date(Format 4/13/2012)(i.e MM/dd/yyyy))`和 Ass_Time `(as Long Time(Format 5:13:00PM(i.e hh:mm:ss tt))`，Sch_Date 和 Sch_Time 也是如此。

我让用户从 DojoDateTextBox 输入一个值作为日期，从 DojoTimeTextBox 输入一个值作为时间，当用户输入一个值时，我以字符串的形式以这种格式获取它们 Date`(2012-04-13)`和 Time `(T17:45:00)( which is 5:45:00PM)`。我使用 :: 检索这些值

```
String assdate = request.getParameter("assigneddatename");
String asstime = request.getParameter("assignedtimename"); 
```

他们我正在使用 Query :: 将其插入数据库

```
String sql2= "insert into ATT_Table(Assigned_To_ID,Assigned_By_ID,Env_ID,Product_ID,Project_ID,Act_Number,Act_Type,Status,Sch_Date,Sch_Time,Ass_Date,Ass_Time,Percent_Complete,Description,Comments) values('"+var1+"','"+var2+"',"+var3+","+var4+","+var5+","+actnum+",'"+acttype+"','"+status+"',#"+schdate+"#,"+schtime+",#"+assdate+"#,"+asstime+","+percent+",'"+descr+"','"+comm+"')"; 
```

请帮助我了解如何在数据库中插入日期的值。谢谢 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T12:06:30.377

时间也是日期数据类型。您需要将时间用“#”符号括起来，就像对日期所做的那样。

# c# - 如何在 mvc 中执行注册直至验证帐户？

> ID：10121730
> 
> 赞同：0
> 
> 时间：2012-04-12T10:23:52.243
> 
> 标签：c#, jquery, asp.net-mvc, rest

我不知道如何提出这个问题，甚至想不出合适的标题，但我会一步一步来。
我有一个休息服务项目，还有一个 MVC3 项目。
我的 MVC3 项目通过 ajax 访问其余服务。
即：内部mvc视图

```
<script type="text/javascript">
    $(document).ready(function () {
        $("#submit").click(function () {
            $.ajax({
                url: 'http://localhost:2222/RestService/User/Register',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    RollNumber: $("#username").val(),
                    Email: $("#email-address").val(),
                    Password: $("#password").val(),
                    Birthday: $("#bday").val()
                }),
                success: function (response) {
                    if (response == true) {
                        window.location.replace('@Url.Action("Index", "Home")');
                    } else {
                        showtooltip('Registration failed.');
                    }
                },
                error: function (xhr, ajaxOptions, error) {
                    showtooltip(xhr.status + ': ' + error);
                }
            });
        });
    });
</script> 
```

如果用户注册成功，mvc 会自动发送一封邮件。
即：电子邮件内容示例：

```
WELCOME TO NEWWEBSITE!

You have successfully registered!
.
.
.
To validate your email address, please go to the link below:

http://localhost:1111/NewWebsite/Auth/Verify?verificationid=3DE4ED727750215957F8A1E4B117C38E7250C33&email=sampleemail%40yahoo.com 
```

然后我不知道下一步该怎么做。
如果用户点击链接来验证他的帐户，我如何从链接中获取信息？

我创建了一个用于验证的 Rest 服务

```
[WebGet(UriTemplate = "RestService/User/Verify?verificationid={verificationid}&email={email}", ResponseFormat = WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json)]
public bool VerifyAccount(string verificationid, string email)
{
    RestLogicClass.RestLogic.UserComponent svc = new RestLogicClass.RestLogic.UserComponent();
    return svc.ValidateEmail(new RestLogicClass.Entities.UserEmail() { EmailAddress = HttpUtility.HtmlDecode(email), ValidateKey = verificationid });
} 
```

可以通过以下方式调用此服务：

```
http://localhost:2222/RestService/User/Verify?verificationid={verificationid}&email={email} 
```

如果电子邮件已经过验证，那么它必须向用户显示来自 mvc 的“Verify.cshtml”页面。
可以通过以下方式访问此页面：

```
http://localhost:1111/NewWebsite/Auth/Verify 
```

希望你明白我的解释。我是这种数据处理的新手，所以如果您有更好的想法，请分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:32:20.240

为了显示Verify.cshtml。我认为你应该有一个动作名称

```
public ActionResult Verify(string verificationid, string email)
{
    //// call the service from here and validate 
    //// if valid then return View();
} 
```

此外，当您生成电子邮件时，请使用此 url 生成。

# jquery - 如何防止项目隐藏在使用 jQuery 的滚动窗格内连接的可排序列表中？

> ID：10121731
> 
> 赞同：1
> 
> 时间：2012-04-12T10:23:52.457
> 
> 标签：jquery, html, scroll, jquery-ui-sortable

我有几个相互连接的 jQuery 可排序列表。由于两个列表都很长，它们位于设置为溢出时滚动的 div 中。从一个拖放到另一个工作，但该项目在此过程中不可见。当它试图离开滚动部分时它变得不可见。

这是列表：

![在此处输入图像描述](../Images/b4618abc25732522f99b87a86d007292.png)

在这里我将一个项目拖到外面，它开始被可滚动窗格的外部隐藏：

![在此处输入图像描述](../Images/06e11b6bad96a04dba8249d622586796.png)

这是该问题的视频：[https ://vimeo.com/40218644](https://vimeo.com/40218644)

任何想法如何使该项目不被页面的其余部分隐藏？

# php - PHP preg_replace：MY_NEW_CLASS 到 My_New_Class

> ID：10121733
> 
> 赞同：0
> 
> 时间：2012-04-12T10:23:57.300
> 
> 标签：php, preg-replace

我在 PHP 中有一个字符串，`MY_NEW_CLASS`我想将其转换为`My_New_Class`.

这是否可以使用 preg_replace 或者我应该爆炸下划线上的字符串，strtolower 它，ucfirst 它，然后将它内爆在一起？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:33:00.503

`preg_replace`我认为它本身并不能真正做到这一点，但回调并不难：

```
$str = preg_replace_callback('/(?<=\b|_)./',
                             function ($m) { return strtoupper($m[0]); },
                             strtolower($str)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:33:08.400

为什么使用正则表达式？

```
function camelize( $string ){

    return strtoupper( $string{0} ) . strtolower( substr( $string, 1 ) );

}

function camelizeClass( $class ){

    $parts = explode( '_', $class );
    array_walk( $parts, function( &$value, $key ){
        $value = camelize( $value );
    });
    return implode( '_', $parts );

}

echo camelizeClass( 'MY_NEW_CLASS' ); // My_New_Class 
```

# asp.net-mvc-3 - ASP.NET MVC3 WebGrid - 自定义的服务器端排序

> ID：10121735
> 
> 赞同：4
> 
> 时间：2012-04-12T10:24:02.023
> 
> 标签：asp.net-mvc-3, sorting, razor, webgrid

有没有办法在调用 sort 时覆盖默认的 MVC3 WebGrid 排序行为来调用我的控制器（它将执行服务器端排序并返回数据）？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-25T18:42:43.580

您可以将服务器端排序的数据以及关于有多少记录的信息传递给 webgrid。 [http://msdn.microsoft.com/en-us/magazine/hh288075.aspx](http://msdn.microsoft.com/en-us/magazine/hh288075.aspx)有一个有用的演练。我正在做数据库级别的排序/过滤/分页，以尽量减少传递的数据量。如果我传递客户拥有的所有 70,000 个对象以便他们可以在第 1 页上看到 25 个对象，我认为我的网络服务器不会喜欢我。这几乎是您需要的一切，除了仅包装您的 IEnumerable 集合的非常轻量级的视图模型带有一些额外的分页数据。

由于 web 网格仅使用查询字符串 vars 来决定您需要使用 get 方法表单做什么。并且您需要以 webgrid 知道如何读取它的方式在查询字符串中包含排序字段/方向。所以你最终会得到像 localhost/example/admin/thing?thingName=Hyatt&City=&State=TX&Country=&sort=city&sortdir=ASC 这样的网址

控制器：

```
 public ActionResult Index(string thingName, string city, string state, string country, int page = 1)
            {
                const int pageSize = 25;                
                int totalRecords = 0; 
                IEnumerable<Thing> things = ThingModel.GetPagedSortedLocationsForCustomer(customerId, sort, sortdir, out totalRecords, pageSize, page, thingName, city, state, country);

                PagedThings viewModel = new PagedThings(pageSize, page, totalRecords, things);

                return View(viewModel);
            } 
```

看法：

```
@model ExampleCompany.Area.ViewModels.PagedThings 

@{  

using (Html.BeginForm("Index", "ThingaMaBob", System.Web.Mvc.FormMethod.Get))
{

    <label for="ThingName">ThingName</label>@Html.TextBox("ThingName", "")
    <label for="City">City</label>@Html.TextBox("City", "")
    <label for="State">State</label>@Html.TextBox("State", "")
    <label for="Country">Country</label>@Html.TextBox("Country", "")
    <input type="submit" value="Filter" />

    <br />
    var grid = new WebGrid(canPage: true, rowsPerPage: Model.PageSize, canSort: true);
    grid.Bind(Model.Things, rowCount: Model.TotalRows, autoSortAndPage: false);
    grid.Pager(WebGridPagerModes.All);

        @grid.GetHtml(htmlAttributes: new { id = "grid"},
        columns: grid.Columns(
            //ommitted
            grid.Column("thingName", "Thing"),
        ));

    Html.Hidden(grid.SortFieldName, grid.SortColumn);
    Html.Hidden(grid.SortDirectionFieldName, grid.SortDirection == SortDirection.Ascending ? "ASC" : "DESC");
} 
```

模型：

```
public static IEnumerable<Thing> GetPagedSortedThingsForCustomer(int customerid, String sortby, String sorttype, out int totalRecords, int pageSize, int pageIndex, string thingName, string city, string state, string country)
        {
            var tmp = new List<Thing>();
            int total = 0;

            dynamic dr = OurDBUtility.ReturnDR("ExampleProc_GetThingsSortedPaged", ConnectionInfo.ExampleConnection, customerid, sortby, sorttype, pageSize, pageIndex, thingName, city, state, country);
            {
                while (dr.Read())
                {
                    var tmpThing = new Thing();
                    tmpThing.LoadFromDr(dr);
                    tmp.Add(tmpThing);
                    if (total == 0)
                    {
                        total = (int)dr["TOTAL_THINGS"];
                    }
                }
            }
            totalRecords = total;

            return tmp;
        } 
```

Proc with dynamic sql - 是的，如果你愿意，你可以使用 Linq-to-Sql 或其他技术，但我是老派：

```
 CREATE PROCEDURE ExampleProc_GetThingsSortedPaged
      ( @CustomerId  int
       , @sortby    nvarchar(60)
      , @sorttype   nvarchar(60)
      , @pageSize int
      , @pageIndex int
      , @thingName nvarchar(255) = null
      , @city nvarchar(30) = null
      , @state nvarchar(30) = null
      , @country char(2) = null
      )
    as

        DECLARE @strSql      nvarchar(3000) 
        --calculate paging rows
        declare @startRow int, @endRow int
        --e.g. if you have a page size of 10, page 1 = 1 - 10, page 2 = 11 -20 
        set @startRow = ((@pageIndex - 1) * @pageSize) + 1
        set @endRow = @startRow + @pageSize - 1

        if @thingName = ''
            set @thingName = null
        if @city = ''
            set @city = null
        if @state = ''
            set @state = null
        if @country = ''
            set @country = null

        --return total for webgrid, accounting for filter
        declare @totalThings int
        select @totalThings = COUNT(*)
        from EXAMPLE_TABLE T with(nolock)
        where CUSTOMER_ID = @CustomerId
            AND (T.THING_NAME LIKE @thingName + '%' OR @thingName is null)              
            AND (T.CITY LIKE @city + '%' or @city is null) 
            AND (T.STATE LIKE @state + '%' or @state is null) 
            AND (T.COUNTRY = @country or @country is null)

        DECLARE @ParameterDefinition AS NVARCHAR(200)

        set @ParameterDefinition = '@totalThings int, @CustomerId INT, @startRow INT, @endRow INT, @thingName nvarchar(255), @city nvarchar(30), @state nvarchar(30), @country char(2)'

        --When we need to do dynamic sql it is better to use paramterization, but you cannot do (ORDER BY @sortBy).     
        SET @strSql = N'SELECT * from
                        (
                        select ROW_NUMBER() OVER (ORDER BY T.' + @sortby + ' ' + @sorttype + ') as Row, 
                            @totalThings  [TOTAL_THINGS],
                             T.THING_ID, T.THING_NAME, T.ADDRESS, T.CITY,  T.STATE, 
                            T.ZIP_CODE, T.COUNTRY 
                        FROM EXAMPLE_TABLE T
                        WHERE T.CUSTOMER_ID = @CustomerId 
                          AND (T.THING_NAME LIKE @thingName + ''%'' OR @thingName is null)              
                          AND (T.CITY LIKE @city + ''%'' or @city is null) 
                          AND (T.STATE LIKE @state + ''%'' or @state is null) 
                          AND (T.COUNTRY = @country or @country is null)
                           ) paged
                        where Row between @startRow and @endRow 
                        ORDER BY Row'

        --print @strSql
        EXECUTE sp_executesql @strSql, @ParameterDefinition, @totalThings, @CustomerId, @startRow, @endRow, @thingName, @city, @state, @country

    GO 
```

使用 CTE 进行处理：

```
CREATE PROCEDURE ExampleProc_GetThingsSortedPaged
  ( @CustomerID  int
  , @sortby    nvarchar(60)
  , @sorttype   nvarchar(60)
  , @pageSize int = 25
  , @pageIndex int = 1
  , @thingName nvarchar(255) = null
  , @city varchar(30) = null
  , @state nvarchar(30) = null
  , @country char(2) = null
  )
as

declare @startRow int
declare @endRow int

SET @startRow = ((@pageIndex - 1) * @pageSize) + 1;
SET @endRow = @startRow + @pageSize - 1;

set @sortby = replace(LOWER(@sortby), '_', '')
SET @sorttype = LOWER(@sorttype)

if @sorttype != 'asc' and @sorttype != 'desc'
begin
      set @sorttype = 'asc'
end

;with cte_things as (
      SELECT 
            CASE
                  WHEN @sortby ='country' AND @sorttype = 'asc'  then row_number() over (order by C.COUNTRY_NAME ASC)
                  WHEN @sortby ='country' AND @sorttype = 'desc' then row_number() over (order by C.COUNTRY_NAME DESC)

                  WHEN @sortby ='state' AND @sorttype = 'asc'  then row_number() over (order by STATE ASC) 
                  WHEN @sortby ='state' AND @sorttype = 'desc' then row_number() over (order by STATE DESC)

                  WHEN @sortby ='city' AND @sorttype = 'asc'  then row_number() over (order by CITY ASC)
                  WHEN @sortby ='city' AND @sorttype = 'desc' then row_number() over (order by CITY DESC)

                  WHEN @sortby ='thingname' AND @sorttype = 'desc' then row_number() over (order by THING_NAME DESC) 
                  ELSE row_number() over (order by THING_NAME ASC)
            END AS Row
            ,T.THING_ID, T.THING_NAME, T.THING_TYPE, T.ADDRESS, T.CITY, T.STATE
            , T.ZIP_CODE, T.COUNTRY_CODE, C.COUNTRY_NAME, T.PHONE_NUMBER
            , T.LATITUDE, T.LONGITUDE
            FROM EXAMPLE_TABLE L 
            join COUNTRIES C 
                  on C.COUNTRY_CODE = L.COUNTRY_CODE
            where
                  T.CUSTOMER_ID = @CustomerId 
                  and L.CITY = ISNULL(@city, CITY)
                  and L.STATE = ISNULL(@state, STATE)
                  and L.COUNTRY_CODE = ISNULL(@country, L.COUNTRY_CODE)
                  and L.THING_NAME = ISNULL(@thingName, THING_NAME)
)
, cte_total as (select COUNT(*) as TOTAL_THINGS from cte_things)
, cte_all as (select cte_things.*, cte_total.TOTAL_THINGS from cte_things cross join cte_total)

SELECT * FROM cte_all
where
      Row >= @startRow
      and Row <= @endRow  
ORDER BY Row

GO 
```

# c# - 在c#中将docx另存为pdf，无法正确导出excel图表

> ID：10121737
> 
> 赞同：0
> 
> 时间：2012-04-12T10:24:09.013
> 
> 标签：c#

我想以编程方式创建 docx 文件。我需要在其中包含 excel 图表，然后我必须将其导出为 pdf。为此，我使用 C# 4.0 和 Microsoft.Office.Interop。

问题是在导出的 pdf 文件中，图表的 1/5 部分被削减了。这是问题的一个例子：

[2shared.com 链接到 pdf 文件](http://www.2shared.com/document/kbcM31UD/Doksi.html)

如果我尝试保存在 xps 中，也会发生这种情况。

如果我将excel图表复制并粘贴到word中，然后它会以某种方式工作......

还有另一个问题。图表是随机缩小的。这取决于在脚本编写过程中excel图表是否可见（这张图片是从word 2010中捕获的，我用红色圈出了问题）：

![在此处输入图像描述](../Images/df3c24f42c6656ad22e3f47b878c05e7.png)

我将 Excel 图表创建为 InlineShapes，使用 AddOLEObject 方法 classtype: "Excel.Chart.8" 。我将它们的大小设置为 200x200（wrdInlineShape.Width，wrdInlineShape.Height）

亚当说我应该包括源代码。它很长，但给你：

```
Microsoft.Office.Interop.Word.Application app = new Microsoft.Office.Interop.Word.Application();
app.Visible = true;
Word.Document doc = app.Documents.Open(@"D:\programozás\OHV\template.docx");
string classtype = "Excel.Chart.8";
object oEndOfDoc = "\\endofdoc";
Bookmark titleBookMark = doc.Bookmarks.get_Item("title");
titleBookMark.Range.Text = "I love OHV";

for (int xi = 1; xi <= 2; xi++)
{
    //  Microsoft.Office.Interop.Word.Range wrdRng = doc.Bookmarks.get_Item(ref oEndOfDoc).Range;
    Bookmark shapeBookMark = doc.Bookmarks.get_Item("shape" + xi );
    Bookmark subtitleBookMark = doc.Bookmarks.get_Item("title" + xi);
    subtitleBookMark.Range.Text = "Super Subject";
    Word.InlineShape wrdInlineShape = doc.InlineShapes.AddOLEObject(classtype, Range: shapeBookMark.Range);
    if (wrdInlineShape.OLEFormat.ProgID == classtype)
    {
        object verb = Word.WdOLEVerb.wdOLEVerbHide;
        wrdInlineShape.OLEFormat.DoVerb(ref verb);
        Random rn = new Random();
        Excel.Workbook obook = (Excel.Workbook)wrdInlineShape.OLEFormat.Object;
        Excel.Worksheet sheet = (Excel.Worksheet)obook.Worksheets["Sheet1"];

        for (int i = 1; i <= 5; i++)
        {
            ((Microsoft.Office.Interop.Excel.Range)sheet.Cells[i, 1]).Value = i + ".";
            for (int c = 2; c <= 3; c++)
            {
                ((Microsoft.Office.Interop.Excel.Range)sheet.Cells[i, c]).Value = rn.Next(1, 5);
                ((Microsoft.Office.Interop.Excel.Range)sheet.Cells[i, c]).Value = rn.Next(1, 5);
            }
            ((Microsoft.Office.Interop.Excel.Range)sheet.Cells[i, 4]).Value = "";
        }

        wrdInlineShape.Width = 200;
        wrdInlineShape.Height = 200;
        Excel.Chart chart = obook.ActiveChart;
        obook.ActiveChart.ApplyLayout(9, Excel.XlChartType.xlColumnClustered);
        obook.ActiveChart.ChartTitle.Caption = "BMEVIHVA109 - Jelek és Rendszerek\n XY kurzus - Dr Erős Péter";
        obook.ActiveChart.ChartTitle.Font.Size = 6;

        chart.ChartArea.Fill.ForeColor.SchemeColor = 41;
        Console.WriteLine(chart.ChartArea.Fill.ForeColor.RGB);
        chart.ChartArea.Fill.BackColor.SchemeColor = 23;
        Console.WriteLine(chart.ChartArea.Fill.BackColor.RGB);
        chart.ChartArea.Fill.TwoColorGradient(Microsoft.Office.Core.MsoGradientStyle.msoGradientHorizontal, 1);

        obook.ActiveChart.SetSourceData(sheet.get_Range("A1", "B5"));
        obook.ActiveChart.Legend.Delete();
        chart.ChartArea.RoundedCorners = true;
        Excel.Axis axis = (Excel.Axis)chart.Axes(
        Excel.XlAxisType.xlCategory,
        Excel.XlAxisGroup.xlPrimary);
        axis.HasTitle = true;
        axis.AxisTitle.Text = "54 kérdőív";
        axis.AxisTitle.Font.Size = 6;
        axis.HasMajorGridlines = true;

        axis = (Excel.Axis)chart.Axes(
        Excel.XlAxisType.xlValue,
        Excel.XlAxisGroup.xlPrimary);
        axis.HasTitle = false;
        axis.HasMajorGridlines = true;
        axis.MaximumScale = 5;
        axis.MinimumScale = 0;
        wrdInlineShape.Width = 200;
        wrdInlineShape.Height = 200;
        Microsoft.Office.Interop.Word.Range tableRange = doc.Bookmarks.get_Item("table" + xi).Range;

        //  sheet.UsedRange.Copy();
        doc.SetDefaultTableStyle("Light List - Accent 4", false);
        Table table = doc.Tables.Add(tableRange, 3, 2);
        Object style = "Table Grid 1";
        table.set_Style(ref style);
        table.Cell(1, 1).Merge(table.Cell(1, 2));
        table.Cell(1, 1).Range.Text = "Válaszok száma";
        table.Cell(1, 1).Range.Font.Bold = 2;
        table.Cell(2, 1).Range.Text = "This works lol";
        table.Cell(2, 2).Range.Text = "This works lol 2 2";
        table.Cell(3, 1).Range.Text = "This works lol";
        table.Cell(3, 2).Range.Text = "This works lol 2 2";
        table.Cell(4, 1).Range.Text = "This works lol";
        table.Cell(4, 2).Range.Text = "This works lol 2 2";
        table.Borders.OutsideLineWidth = WdLineWidth.wdLineWidth225pt;
    }
}
//     doc.InlineShapes.AddPicture(@"D:\programozás\OHV\OHV\OHV\bin\Debug\Capture.JPG", false, true);
doc.SaveAs2(@"D:\programozás\OHV\Doksi.docx");

Console.WriteLine("Exit");
try
{
    //Novacode.DocX docx = Novacode.DocX.Load(@"D:\programozás\OHV\Doksi.docx");
    //docx.SaveAs(@"D:\programozás\OHV\Doksi.pdf");
    doc.ExportAsFixedFormat(@"D:\programozás\OHV\Doksi.pdf",WdExportFormat.wdExportFormatPDF);
    doc.Close();
    app.Quit();
}
catch (Exception e)
{
    Console.WriteLine(e.Message);
    Console.ReadLine();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T13:38:13.320

我找到了解决方法。

我将刚刚制作的excel图表剪切到剪贴板，然后将其粘贴到同一个地方，然后等待2秒钟，然后继续下一张图表。剪切/粘贴似乎将图表转换为另一种类型的单词对象，即通过 pdf 正确导出。

```
 wrdInlineShape.Range.Cut();
            shapeBookMark.Range.Paste();
            Thread.Sleep(2000); 
```

（shapeBookMark 是我放置图表的原始范围。需要等待 2 秒，否则 Word 会冻结并显示错误消息）

# android - 相机Phonegap插件

> ID：10121738
> 
> 赞同：0
> 
> 时间：2012-04-12T10:24:16.140
> 
> 标签：android, cordova, camera

我使用Phonegap 编写了一个Android 应用程序。现在我需要使用相机，但是由于用于相机的 Phonegap API 使用相机 Intent，它为我提供了带有手机本机控件的相机；相反，我想实现自己的控件。为了获得这一点，我认为我不必使用相机意图，而是应该使用长过程（实现框架布局、CameraPreview 等）来绘制我自己的控件。我可以在新应用程序中执行此操作，但在 Phonegap 插件中它不起作用，因为每次我尝试运行程序时，它都会显示消息“失败，因为：无法在未调用 Looper 的线程内创建处理程序。准备（）”。任何想法？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T14:35:30.263

有很多解决这个线程问题的答案。

[无法在未调用 Looper.prepare() 的线程内创建处理程序](https://stackoverflow.com/questions/3875184/cant-create-handler-inside-thread-that-has-not-called-looper-prepare)

[无法在 AsyncTask 中为 ProgressDialog 调用 Looper.prepare() 的线程内创建处理程序](https://stackoverflow.com/questions/3614663/cant-create-handler-inside-thread-that-has-not-called-looper-prepare-inside-a)

[无法在未调用 Looper.prepare() 的线程内创建处理程序](https://stackoverflow.com/questions/5009816/android-cant-create-handler-inside-thread-that-has-not-called-looper-prepare)

# forms - Zope 表单：添加一个按钮以自动填充某些字段

> ID：10121739
> 
> 赞同：0
> 
> 时间：2012-04-12T10:24:27.313
> 
> 标签：forms, zope

在 Plone4/Zope3 下，我有一个添加新对象的表单。

我想在第一个字段之后添加一个按钮，以执行以下操作： - 用户输入第一个字段的值 - 他按下这个新按钮 - 服务器将尝试根据第一个字段猜测剩余字段和一个外部数据库。- 然后用户必须检查所有字段是否正常，然后提交表单。

我不是 zope 专家，我花了一些时间试图弄清楚如何做到这一点。

创建子表单是个好主意吗？

如果没有，我可以在表单中添加一个新按钮：我尝试了类似 @button.buttonAndHandler(_(u'Essai')) def essai(self, action): print "button essai"

但后来我有以下问题： - 如何在第一个字段之后而不是在底部呈现按钮？- 如何在不提交表单的情况下更新剩余字段？- 如何保留我添加此 essai 按钮时消失的“添加”和“取消”按钮。

任何提示？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T10:23:28.527

我建议使用 javascript 来解决这个问题。使用 jquery，您可以在第一个字段 (http://api.jquery.com/after) 后面直接包含一个额外的按钮。在按钮操作中，询问浏览器视图以获取 json (http://docs.python.org/library/json.html) 中的搜索结果，并填写其他表单字段，例如：

```
jq('my-button').click(function(event) {
    event.preventDefault();
    var first_field= jq('#first-field-id').val();
    jq.getJSON('/@@my-browser-view?value=' + value, function(result) {
        jq('#other-field-id').val(result.val_for_other_field);
        ...
    });
}); 
```

# android - 只重新布置孩子而不是所有的树

> ID：10121742
> 
> 赞同：8
> 
> 时间：2012-04-12T10:24:34.770
> 
> 标签：android, layout

我正在尝试通过视图回收来重新创建`ListView`（和`AbsListView`）逻辑。我需要这个，但我们可以说它只是为了理解 Android 逻辑。

假设我的子项是相同的（相同的布局），使用固定的高度`RelativeLayout`。

在滚动期间，我正在重用幽灵子视图并为当前项目设置属性。它工作正常，因为我在滚动期间使用`View.offsetTopAndBottom()`而`invalidate()`不是请求布局以进行优化。

我的问题是更新孩子（`RelativeLayout`）。

取决于项目，我想隐藏或显示`ImageView`这个项目。为此，我只是使用`iconImage.setVisibility( GONE )`and `iconImage.setVisibility( VISIBLE )`。

由于我正在阻止`requestLayout`，它似乎`setVisibility()`无法正常工作。

如果我使用`requestLayout`，所有树都将自行测量和布局，这不是滚动用户体验的好方法。

有没有办法只在回收子项上请求布局？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-09-12T10:08:31.110

您需要通过更改视图通知您的 listView，因此`notifyDataSetChanged();`像这样从 Uithread 调用：

```
 final ArrayAdapter adapter = ((ArrayAdapter) getListAdapter());
    runOnUiThread(new Runnable() {
        @Override
        public void run() {
            adapter.notifyDataSetChanged();
        }
    }); 
```

# php - 正则表达式 - 将 html 标签替换为双引号

> ID：10121743
> 
> 赞同：0
> 
> 时间：2012-04-12T10:24:35.623
> 
> 标签：php, regex

如何更换

```
<option value="X"   >XXX</option>
<option value="Y"   >YYY</option>
<option value="ZZ"   >ZZZ</option> 
```

我想替换所有选项标签，我需要像下面这样打印

```
"XXX" "YYY" "ZZZ" .... 
```

不熟悉模式。帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T10:57:37.837

如果你知道输入总是有这种格式，你当然可以用正则表达式来做。例如

```
<?php
$pattern = '/<\/?option[^>]*>\n?/';
$replacement = '"';
$subject = '<option value="X"   >XXX</option>
<option value="Y"   >YYY</option>
<option value="ZZ"   >ZZZ</option>';
$limit = -1;
$count = 0;
$result = preg_replace ($pattern, $replacement, $subject, $limit, $count);
?> 
```

打印 $result 将输出

```
"XXX""YYY""ZZZ" 
```

如果您想要额外的空格，您可以运行另一个替换并将所有替换`""`为`" "`.

致所有潜在的反对者。不要教条主义。在许多情况下，正则表达式可以满足需要，而且它们更容易实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T11:05:33.767

猜猜这应该工作..

```
$output = preg_replace("~<option[^>]*?>([^<>]*?)</option[^>]*?>~","$1",trim($html)); 
```

# c++ - 函数 latin2cyr 在 C++ 中反之亦然

> ID：10121745
> 
> 赞同：0
> 
> 时间：2012-04-12T10:24:37.137
> 
> 标签：c++, string, stl

使用 C++ STL 将 AnsiString 转换为 Cyrillic 的最简单/最佳方法是什么！

在 php 中它会是

```
<?php
  // функция превода текста с кириллицы в траскрипт
  function encodestring($st)
  {
    // Сначала заменяем "односимвольные" фонемы.
    $st=strtr($st,"абвгдеёзийклмнопрстуфхъыэ_",
    "abvgdeeziyklmnoprstufh'iei");
    $st=strtr($st,"АБВГДЕЁЗИЙКЛМНОПРСТУФХЪЫЭ_",
    "ABVGDEEZIYKLMNOPRSTUFH'IEI");
    // Затем - "многосимвольные".
    $st=strtr($st, 
                    array(
                        "ж"=>"zh", "ц"=>"ts", "ч"=>"ch", "ш"=>"sh", 
                        "щ"=>"shch","ь"=>"", "ю"=>"yu", "я"=>"ya",
                        "Ж"=>"ZH", "Ц"=>"TS", "Ч"=>"CH", "Ш"=>"SH", 
                        "Щ"=>"SHCH","Ь"=>"", "Ю"=>"YU", "Я"=>"YA",
                        "ї"=>"i", "Ї"=>"Yi", "є"=>"ie", "Є"=>"Ye"
                        )
             );
    // Возвращаем результат.
    return $st;
  }
?> 
```

我更喜欢使用 STL Containers，需要帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:35:23.363

您也可以在 C++ 中使用相同的代码样式。查看 std::map 容器。在最新的标准 C++11 中，您还可以以非常方便的方式对其进行初始化：

```
map letters = 
 {{ "f", "ф"},
  { "h", "х"},
  //and so on
 }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T14:34:37.767

最后我写了我自己的函数，它运行良好！我认为它会完成我的工作，但没有那么优化！试图像这样使用 map.find() smth 但是.....

```
AnsiString Latin2Cyr(AnsiString inStr)
{
    int l=inStr.Length();
    if (!l) return "";

    AnsiString strLat[]={"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"};
    AnsiString strCyr[]={"а","б","с","д","е","ф","г","х","и","дж","к","л","м","н","о","п","к","р","с","т","у","в","у","кс","й","з"};
    AnsiString outStr="";
    typedef multimap<AnsiString,AnsiString> mmp;
    mmp mStr;
    int ln=(sizeof(strLat))/(sizeof(AnsiString));
    for (int i = 0; i < ln; i++) mStr.insert(mmp::value_type(strLat[i],strCyr[i]));
    AnsiString k=""; mmp::iterator it;
    for (int j = 1; j <l+1; j++) {
        for ( it=mStr.begin(); it!= mStr.end();++it ){
            outStr+=((*it).first==inStr.SubString(j,1))? (*it).second : k ;
        }
    }
    return outStr;
} 
```

有什么优化它的想法吗？

# c# - 获取使用 DataTable.Select() 获取的行旁边的行

> ID：10121747
> 
> 赞同：2
> 
> 时间：2012-04-12T10:24:51.427
> 
> 标签：c#, datatable, datarow

我有下一个数据的 DataTable 对象：

```
Id Value
1   val1
3   val2
2   val3 
```

我接下来选择一行：

```
 table.Select("Id=1"); 
```

这个查询给了我行

```
 1 val1 
```

接下来我要取所选行旁边的行，即行

```
 3 val2 
```

我能以某种方式做到这一点吗？是否可以？也许有类似行在表格中的位置的东西，我可以通过增加这个值来选择下一行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T10:28:08.840

`DataTable.Rows.IndexOf()` 是我唯一能想到的。

如何：

```
var rows=table.Select("Id=1");
var indexOfRow=table.Rows.IndexOf(rows[0]); //since Id only 1 match

var nextRow=table.Rows[indexOfRow+1]; 
```

例子：

```
 DataTable dt = new DataTable();
    dt.Columns.Add("ID", typeof (int));
    dt.Columns.Add("AnotherID", typeof(int));
    dt.Columns.Add("Content", typeof(string));
    dt.PrimaryKey = new[] {dt.Columns["ID"]};

    // Add some data
    dt.Rows.Add(1, 10, "1");
    dt.Rows.Add(2, 11, "2");
    dt.Rows.Add(3, 12, "3");
    dt.Rows.Add(4, 13, "4");

    var index = dt.Rows.IndexOf(dt.Rows.Find(3));

    // index is 2

    Console.WriteLine(dt.Rows[index+1]); 
```

在 Linqpad 中输出

> 数据行
> ID 4另一个 ID
> 13
> 内容 4

希望有帮助

# blackberry - 如何在黑莓中寻找流媒体

> ID：10121748
> 
> 赞同：0
> 
> 时间：2012-04-12T10:25:09.930
> 
> 标签：blackberry, java-me, streaming, mmapi

我正在使用以下代码转发流媒体。但这给了我在媒体上不允许的例外情况。

有没有办法在黑莓中寻找流媒体？

```
private void forwardPlayer(){
            if(isPlaying){
                try {
                    long prevTime = player.getMediaTime()/1000000;

                    final long newTime = prevTime + 5;
                    if(newTime <= player.getDuration()/1000000){

                        Thread t = new Thread(new Runnable() {

                            public void run() {
                                try {
                                    player.setMediaTime(newTime * 1000000);
                                } catch (final MediaException e) {
                                    UiApplication.getUiApplication().invokeLater(new Runnable() {

                                        public void run() {
                                            Dialog.inform("forward "+e.toString());
                                        }
                                    });
                                }
                            }
                        });
                        t.start();

                    }
                } catch (final Exception e) {
                    UiApplication.getUiApplication().invokeLater(new Runnable() {

                        public void run() {
                            Dialog.inform("forward "+e.toString());
                        }
                    });
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T16:43:10.343

冒着陈述显而易见的风险，您无法在媒体上寻找的原因几乎可以肯定是因为不可能这样做。

一种解决方案是将远程媒体源中的数据流式传输到缓冲区中，然后您可以在该缓冲区中查找。查看[流媒体 - 从头到尾](http://supportforums.blackberry.com/t5/Java-Development/Streaming-media-Start-to-finish/ta-p/488255)查看参考代码。

# selenium - 停止 selenium 服务器，直到文件上传

> ID：10121750
> 
> 赞同：2
> 
> 时间：2012-04-12T10:25:16.093
> 
> 标签：selenium, selenium-rc

我正在使用 Selenium 的文件上传任务。

这里的问题是，上传文件需要 5-10 秒的时间。但我必须停止 Selenium 服务器，直到它完全上传。

这是一些示例代码。

```
selenium.type("id=Fileuploader","c:\\mypic.jpg");
selenium.click("id=submmit"); 
```

它给出了错误，因为该`selenium.click`语句在语句之后立即执行，`selenium.type`而没有等待文件完全上传。

那么，我应该在这里使用什么来停止 Selenium 服务器（服务器必须等待一段时间）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T12:34:51.270

异步请求总是很难跟踪。文件上传的时候页面肯定有一些变化，所以找找，等着看。

您可以尝试[waitForCondition()](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#waitForCondition%28java.lang.String,%20java.lang.String%29)。

或某种[isElementPresent()](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#isElementPresent%28java.lang.String%29)魔术

```
final int TIMEOUT = 10000;  // ten seconds
long targetTime = System.currentTimeInMillis() + TIMEOUT;
while((System.currentTimeInMillis() < targetTime)) {
    if (selenium.isElementPresent("xpath=something")) {
        break;
    }
} 
```

**编辑**：如果没有新元素，则至少必须进行某种更改。例如，如果您的异步上传更改了`value`某个隐藏`input`元素，您可以使用[getValue()](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#getValue%28java.lang.String%29)进行测试，或者只是一个智能定位器：

```
isElementPresent("xpath=//input[@type='hidden' and contains(@value,'mypic.jpg')]"); 
```

**EDIT2**：如果我们检查的元素（在这种情况下，图片预览）在上传之前就已经存在，那么它就是不可见的，我们可以通过[isVisible()进行测试](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#isVisible%28java.lang.String%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:52:15.957

如果最坏，你总是可以`Thread.sleep()`在代码中使用一些。但最好的方法是看[高级用法——显式和隐式等待](https://www.selenium.dev/documentation/webdriver/waits/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T10:14:38.430

上传文件后，新元素即将出现，显示已上传元素的预览。

所以，我用

```
selenium.isVisible("xpath of new preview element") 
```

把它放在循环中。它会起作用的。

谢谢你。

# objective-c - 委托模式的 UML

> ID：10121763
> 
> 赞同：3
> 
> 时间：2012-04-12T10:26:03.960
> 
> 标签：objective-c, delegates, uml

我想在 UML 中对委托模式（针对 Objective-C）进行建模。请问它的正确介绍是什么？

例如：

我的类 BaseXMLParser 有一个符合 ParserDelegate 接口的委托。ParserDelegate 中的方法将在 UI 类中实现

ps：对不起我的英语

![委托模式](../Images/7b7ad5c4b3e050f651996b5a4ca26fd1.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T20:42:39.123

而不是使用`<<ParserDelegate>>`你应该使用`<<Interface>>`，而不是`delegate`你的接口名称是`ParserDelegate`。您也不必`ParserDelegate`在实现类 ( `UI`) 中编写接口 ( ) 中定义的方法。我也会给出一个方向的参考`BaseXMLParser`，`ParserDelegate`因为我认为委托没有理由调用客户端类。

# eclipse-plugin - 如何在插件激活器中获得选择服务

> ID：10121764
> 
> 赞同：0
> 
> 时间：2012-04-12T10:26:22.257
> 
> 标签：eclipse-plugin

我需要以某种方式获取激活器中选择服务的参考。我试过这个：

```
IWorkbench wb = PlatformUI.getWorkbench();
IWorkbenchWindow ww = wb.getActiveWorkbenchWindow();
ww.getSelectionService().addSelectionListener(new GlobalSelectionListener()); 
```

但`ww`总是`null`。我还没有找到另一个代码来获取选择服务参考。此代码仅在 Eclepse 完全初始化时才有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:34:57.360

您需要确保在 Display 线程上调用 getActiveWorkbenchWindow() 以获得非空返回。

尝试：

```
final IWorkbench workbench = PlatformUI.getWorkbench();
workbench.getDisplay().asyncExec(new Runnable() {
  public void run() {
    IWorkbenchWindow window = workbench.getActiveWorkbenchWindow();
    if (window != null) {
      // do something
    }
  }
}); 
```

该示例来自 org.eclipse.ui.IStartup 的 javadoc。如果您希望在初始化工作台后尽快执行您的代码，您应该考虑扩展[org.eclipse.ui.startup](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fextension-points%2Forg_eclipse_ui_startup.html)扩展点。

# windows-phone-7 - NullException 错误 WP7

> ID：10121765
> 
> 赞同：-3
> 
> 时间：2012-04-12T10:26:23.457
> 
> 标签：windows-phone-7, xaml

![空异常](../Images/42740dda5f4c3ffaab0d75005c9d987d.png)

我在 App.cs 中收到此错误，任何帮助，我尝试清理并再次构建但没有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:36:57.073

有问题的行不应该如下： -

```
PhoneApplicationService.Current.UserIdleDetectionMode = IdleDetectionMode.Disabled; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:38:59.533

如果您删除了`<PhoneApplicationService>`from `App.xaml`，它将为空。要么实例化它，要么确保`<PhoneApplicationService>`它存在于你的 XAML 中。

# python - 字符串替换python

> ID：10121767
> 
> 赞同：4
> 
> 时间：2012-04-12T10:26:24.957
> 
> 标签：python

我应该如何从 python 中的句子中替换一个确切的单词。我使用了 .replace() 函数，但如果它是单词的一部分，它也会替换单词，例如“he is missing”并且我替换“is”，输出是“he msing”。我尝试在要匹配的单词之前和之后插入空格，但是如果它在句子的开头，它就不能删除这个词，如果它后面跟着一个标点符号，那么它也是。我在想它可以通过正则表达式来完成，但想不到这样做。还有其他方法吗，请告诉我

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T10:27:37.683

使用单词边界`\b`来标记字母数字字符和任何其他字符之间的位置：

```
newString = re.sub(r'\boldword\b', r'newword', oldString) 
```

# authentication - Symfony2：清除cookie后首次尝试登录不起作用

> ID：10121769
> 
> 赞同：2
> 
> 时间：2012-04-12T10:26:29.323
> 
> 标签：authentication, symfony

尝试登录时，Symfony2 告诉我我提供了错误的凭据。第二次尝试有效。任何想法为什么会发生这种情况？要重现该行为，我必须注销、清除 cookie、再次进入登录页面并再次登录。

我正在使用 FOSUserBundle。

配置.yml：

```
framework:
#esi:             ~
secret:          asdfsadfasdf
#translator:      { fallback: en }
charset:         UTF-8
router:          { resource: "%kernel.root_dir%/config/routing.yml" }
form:            true
csrf_protection: true
validation:      { enable_annotations: true }
templating:      { engines: ['twig'], assets_version: v1.2 } #assets_version: SomeVersionScheme
translator:      { fallback: de }

session:    
    default_locale:  de
    auto_start:     false
    lifetime:       1000000
... 
```

安全性.yml：

```
security:
encoders:
    Symfony\Component\Security\Core\User\User: plaintext

role_hierarchy:
    ROLE_ADMIN:       ROLE_USER
    ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

providers:
    fos_userbundle:
        id: fos_user.user_manager

firewalls:
    dev:
        pattern:  ^/(_(profiler|wdt)|css|images|js)/
        security: false
    login:
        pattern:  ^/login$
        security: false

    public:
        pattern:   ^/.*
        form_login:
            provider: fos_userbundle
            check_path: /login_check
            remember_me: true
        remember_me:
            key:      aaasfasdfasdfsadfsadf
            lifetime: 1296000 #15 days in second
            path:     /
        anonymous: true
        logout: true

access_control:
    - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY}
    - { path: ^/register, roles: IS_AUTHENTICATED_ANONYMOUSLY}
    #- { path: ^/_internal, roles: IS_AUTHENTICATED_ANONYMOUSLY, ip: 127.0.0.1 }
    - { path: ^/events/create, roles: ROLE_USER }
    #...
acl:
    connection: default 
```

路由.yml：

```
_imagine:
    resource: .
    type:     imagine

_index:
    resource: "@AjadoEventHubBundle/Controller/IndexController.php"
    type:     annotation

fos_comment_api:
    type: rest
    resource: "@FOSCommentBundle/Resources/config/routing.yml"
    prefix: /api

fos_user_security:
    resource: "@FOSUserBundle/Resources/config/routing/security.xml"
... 
```

@FOSUserBundle/Resources/config/routing/security.xml：

```
<routes xmlns="http://symfony.com/schema/routing"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/routing http://symfony.com/schema/routing/routing-1.0.xsd">

    <route id="fos_user_security_login" pattern="/login">
        <default key="_controller">FOSUserBundle:Security:login</default>
    </route>

    <route id="fos_user_security_check" pattern="/login_check">
        <default key="_controller">FOSUserBundle:Security:check</default>
    </route>

    <route id="fos_user_security_logout" pattern="/logout">
        <default key="_controller">FOSUserBundle:Security:logout</default>
    </route>

</routes> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T14:08:55.823

在我看来，这是您启用匿名身份验证时的预期行为：

*   您请求您的应用程序 url，而没有被记录 => 使用您的会话 ID 创建会话 cookie
*   创建匿名令牌
*   你清除 cookie => 没有更多的会话 id 来识别你
*   下一个请求，没有令牌附加到您的登录请求...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-30T03:10:41.443

我不熟悉 symfony，但是，当身份验证检查寻找有效的 cookie 时，我遇到了同样的问题，但是 cookie 是在检查之后创建的——因此导致它第二次通过，而不是第一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-30T12:41:30.070

默认情况下，Symfony 要求在提交表单之前必须存在会话

从文档

> ```
> # by default, a session must exist before submitting an authentication request
> # if false, then Request::hasPreviousSession is not called during authentication
> # new in Symfony 2.3 
> ```

为了克服这个问题，您可以在“security.yml”中将“require_previous_session”（默认为true）设置为false，就像在“form_login”下一样：require_previous_session：false

[您可以在以下链接SecurityBundle Configuration ("security")](http://symfony.com/doc/current/reference/configuration/security.html)中的 Symfony 文档中阅读有关它的更多信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-30T16:45:01.417

# gnu - 如何以 pdf 格式阅读信息文档？

> ID：10121773
> 
> 赞同：0
> 
> 时间：2012-04-12T10:26:53.833
> 
> 标签：gnu, texinfo

（几乎）所有 GNU 程序都提供可以使用`info <topic>`. 这使用 TUI 来显示文档。我不喜欢这个，因为它很难读。给定`.texi`-files，on 也可以从文档中生成一个 pdf 文件，但这使得手动下载源包成为必要。有没有办法从`.info`-files 生成 pdf 文档？

*如果合适，请将此问题移至 superuser.com。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T15:29:18.750

您可以使用其他阅读器，例如 tkinfo 或 pinfo。或者只是使用浏览器访问[https://gnu.org/software/program-name](https://gnu.org/software/program-name)。我还没有找到将信息文件转换为 pdf 的内容。

# php - Symfony2 - 自定义“默认”登录表单上的错误

> ID：10121775
> 
> 赞同：2
> 
> 时间：2012-04-12T10:27:13.817
> 
> 标签：php, symfony

我正在使用 Symfony2 文档中显示的基本登录表单来允许用户进行身份验证。

但是，我发现它在样式方面有点缺乏。

因为它是使用基本 HTML 而不是表单生成器创建的，所以我无法使用表单主题。登录尝试失败产生的错误将在表单上方的一个块中输出。为了看起来像我构建的其他表单，我希望将错误消息放在与错误相关的输入框旁边。

我开始着手将表单更改为使用表单生成器创建的表单，但是当涉及到创建自定义身份验证类的重大任务时，我陷入了困境。

那么，有没有办法拆分错误对象并将它们放在相关输入旁边，还是我应该继续使用完全自定义的表单和自定义身份验证器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:15:46.447

您可以简单地使用自己的表单，而无需使用完全不同的身份验证提供程序。 [http://symfony.com/doc/current/book/security.html#using-a-traditional-login-form](http://symfony.com/doc/current/book/security.html#using-a-traditional-login-form)

创建控制器操作、指向该操作的 /login 路由和您自己的模板。检查字段名称是否为 _username 和 _password 以便它可以立即工作，或者直接去[配置它们](http://symfony.com/doc/current/reference/configuration/security.html#reference-security-firewall-form-login)。

# c++ - C中的IP地址搜索算法或库

> ID：10121781
> 
> 赞同：1
> 
> 时间：2012-04-12T10:27:44.223
> 
> 标签：c++, c, linux, network-programming, ip

我有一个网络应用程序正在制作基于 ip_address 的防火墙。我在我的应用程序中找到客户端的源 ip，然后，如果客户端的 ip 在我的配置文件中 ips 的子网中，那么我拒绝或接受该 ip。

在配置文件中，可能有不同的ip格式。它可以是单个 ip`192.168.0.1`或子网`192.168.0.1/24`或间隔（如`192.168.0.1-192.168.0.37`. 这些 ip 地址是从配置文件中读取的，如果客户端 ip 在其中之一中，则采取行动。

它是在来自conf文件的ips中搜索客户端ip。python中有一些算法可以解决这些问题。但是是否有适合这项工作的C或c++库。它将解析这些格式的ips并搜索客户端?.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:54:05.637

> 是否有适合这项工作的 C 或 C++ 库？

我不知道。

但是如果我必须编写这样的库，那么我会使用整数（IPv4 为 32 位）。排序和检查将更快。范围可以用 64 位值寻址。

相比之下，使用字符串会非常缓慢。

# java - 如何在 GWT CellTree 中选择父节点时选择所有子节点？

> ID：10121792
> 
> 赞同：2
> 
> 时间：2012-04-12T10:28:44.030
> 
> 标签：java, gwt, checkbox, tree

我`CellTree`在其中使用了`CompositeCell`包含`CheckBoxCell`在每个父节点和子节点上的内容。

现在我想在选择父节点时选择所有子节点。我怎样才能做到这一点？

以下是我的代码。

```
public class CellTreeExample implements EntryPoint {
    /**
     * A list of songs.
     */
    private static class Playlist {
        private final String name;
        private final List<String> songs = new ArrayList<String>();

        public Playlist(String name) {
            this.name = name;
        }

        /**
         * Add a song to the playlist.
         * 
         * @param name
         *            the name of the song
         */
        public void addSong(String name) {
            songs.add(name);
        }

        public String getName() {
            return name;
        }

        /**
         * Return the list of songs in the playlist.
         */
        public List<String> getSongs() {
            return songs;
        }
    }

    /**
     * A composer of classical music.
     */
    private static class Composer {
        private final String name;
        private final List<Playlist> playlists = new ArrayList<Playlist>();

        public Composer(String name) {
            this.name = name;
        }

        /**
         * Add a playlist to the composer.
         * 
         * @param playlist
         *            the playlist to add
         */
        public Playlist addPlaylist(Playlist playlist) {
            playlists.add(playlist);
            return playlist;
        }

        public String getName() {
            return name;
        }

        /**
         * Return the rockin' playlist for this composer.
         */
        public List<Playlist> getPlaylists() {
            return playlists;
        }
    }

    /**
     * The model that defines the nodes in the tree.
     */
    private static class CustomTreeModel implements TreeViewModel {

        private final List<Composer> composers;

        /**
         * This selection model is shared across all leaf nodes. A selection
         * model can also be shared across all nodes in the tree, or each set of
         * child nodes can have its own instance. This gives you flexibility to
         * determine how nodes are selected.
         */
        private MultiSelectionModel<String> selectionModel = new MultiSelectionModel<String>();
        private MultiSelectionModel<Playlist> playlistSelectionModel = new MultiSelectionModel<Playlist>();
        private MultiSelectionModel<Composer> composerSelectionModel = new MultiSelectionModel<Composer>();
        private final Cell<String> contactCell;
        static List<HasCell<String, ?>> hasCells = new ArrayList<HasCell<String, ?>>();
        private final Cell<Playlist> playlistCell;
        static List<HasCell<Playlist, ?>> playlistHasCells = new ArrayList<HasCell<Playlist, ?>>();
        private final Cell<Composer> composerCell;
        static List<HasCell<Composer, ?>> composerHasCells = new ArrayList<HasCell<Composer, ?>>();
        public CustomTreeModel(final MultiSelectionModel<String> selectionModel,final MultiSelectionModel<Playlist> playlistSelectionModel,final MultiSelectionModel<Composer> composerSelectionModel) {
            this.selectionModel = selectionModel;
            this.playlistSelectionModel = playlistSelectionModel;
            this.composerSelectionModel = composerSelectionModel;

            // Create a database of information.
            composers = new ArrayList<Composer>();

            // Add compositions by Beethoven.
            {
                Composer beethoven = new Composer("Beethoven");
                composers.add(beethoven);

                Playlist concertos = beethoven.addPlaylist(new Playlist("Concertos"));
                concertos.addSong("No. 1 - C");
                concertos.addSong("No. 2 - B-Flat Major");
                concertos.addSong("No. 3 - C Minor");
                concertos.addSong("No. 4 - G Major");
                concertos.addSong("No. 5 - E-Flat Major");

                Playlist quartets = beethoven.addPlaylist(new Playlist("Quartets"));
                quartets.addSong("Six String Quartets");
                quartets.addSong("Three String Quartets");
                quartets.addSong("Grosse Fugue for String Quartets");

                Playlist sonatas = beethoven.addPlaylist(new Playlist("Sonatas"));
                sonatas.addSong("Sonata in A Minor");
                sonatas.addSong("Sonata in F Major");

                Playlist symphonies = beethoven.addPlaylist(new Playlist("Symphonies"));
                symphonies.addSong("No. 2 - D Major");
                symphonies.addSong("No. 2 - D Major");
                symphonies.addSong("No. 3 - E-Flat Major");
                symphonies.addSong("No. 4 - B-Flat Major");
                symphonies.addSong("No. 5 - C Minor");
                symphonies.addSong("No. 6 - F Major");
                symphonies.addSong("No. 7 - A Major");
                symphonies.addSong("No. 8 - F Major");
                symphonies.addSong("No. 9 - D Minor");
            }

            // Add compositions by Brahms.
            {
                Composer brahms = new Composer("Brahms");
                composers.add(brahms);
                Playlist concertos = brahms.addPlaylist(new Playlist("Concertos"));
                concertos.addSong("Violin Concerto");
                concertos.addSong("Double Concerto - A Minor");
                concertos.addSong("Piano Concerto No. 1 - D Minor");
                concertos.addSong("Piano Concerto No. 2 - B-Flat Major");

                Playlist quartets = brahms.addPlaylist(new Playlist("Quartets"));
                quartets.addSong("Piano Quartet No. 1 - G Minor");
                quartets.addSong("Piano Quartet No. 2 - A Major");
                quartets.addSong("Piano Quartet No. 3 - C Minor");
                quartets.addSong("String Quartet No. 3 - B-Flat Minor");

                Playlist sonatas = brahms.addPlaylist(new Playlist("Sonatas"));
                sonatas.addSong("Two Sonatas for Clarinet - F Minor");
                sonatas.addSong("Two Sonatas for Clarinet - E-Flat Major");

                Playlist symphonies = brahms.addPlaylist(new Playlist("Symphonies"));
                symphonies.addSong("No. 1 - C Minor");
                symphonies.addSong("No. 2 - D Minor");
                symphonies.addSong("No. 3 - F Major");
                symphonies.addSong("No. 4 - E Minor");
            }

            // Add compositions by Mozart.
            {
                Composer mozart = new Composer("Mozart");
                composers.add(mozart);
                Playlist concertos = mozart.addPlaylist(new Playlist("Concertos"));
                concertos.addSong("Piano Concerto No. 12");
                concertos.addSong("Piano Concerto No. 17");
                concertos.addSong("Clarinet Concerto");
                concertos.addSong("Violin Concerto No. 5");
                concertos.addSong("Violin Concerto No. 4");
            }

            hasCells.add(new HasCell<String, Boolean>() {

              private CheckboxCell cell = new CheckboxCell(true, false){

                /* (non-Javadoc)
                 * @see com.google.gwt.cell.client.CheckboxCell#render(com.google.gwt.cell.client.Cell.Context, java.lang.Boolean, com.google.gwt.safehtml.shared.SafeHtmlBuilder)
                 */
                @Override
                public void render(Context context, Boolean value, SafeHtmlBuilder sb) {
                    // TODO Auto-generated method stub
                    super.render(context, value, sb);
                }

              };

              public Cell<Boolean> getCell() {
                return cell;
              }

              public FieldUpdater<String, Boolean> getFieldUpdater() {
                return null;
              }

              public Boolean getValue(String object) {
                return selectionModel.isSelected(object);
              }
            });

            contactCell = new CompositeCell<String>(hasCells){
                /* @Override
                 public void render(Context context, String value, SafeHtmlBuilder sb) {
                     System.out.println("STRING...."+value+"    ....");
                   //sb.appendHtmlConstant("<table><tbody><tr>");
                     sb.appendHtmlConstant(value);
                   super.render(context, value, sb);
                   //sb.appendHtmlConstant(value+"</tr></tbody></table>");
                 }*/

                 @Override
                 protected Element getContainerElement(Element parent) {
                   // Return the first TR element in the table.
                   return parent.getFirstChildElement().getFirstChildElement().getFirstChildElement();
                 }

                 @Override
                 protected <X> void render(Context context, String value,
                     SafeHtmlBuilder sb, HasCell<String, X> hasCell) {
                   Cell<X> cell = hasCell.getCell();
                   cell.render(context, hasCell.getValue(value), sb);
                   sb.appendHtmlConstant(value);
                   //sb.appendHtmlConstant("</td>");
                 }
            };

            playlistHasCells.add(new HasCell<Playlist, Boolean>() {

                  private CheckboxCell cell = new CheckboxCell(true, false){

                    /* (non-Javadoc)
                     * @see com.google.gwt.cell.client.CheckboxCell#render(com.google.gwt.cell.client.Cell.Context, java.lang.Boolean, com.google.gwt.safehtml.shared.SafeHtmlBuilder)
                     */
                    @Override
                    public void render(Context context, Boolean value, SafeHtmlBuilder sb) {
                        // TODO Auto-generated method stub
                        super.render(context, value, sb);
                    }

                  };

                  public Cell<Boolean> getCell() {
                    return cell;
                  }

                  public FieldUpdater<Playlist, Boolean> getFieldUpdater() {
                    return null;
                  }

                  public Boolean getValue(Playlist object) {
                    return playlistSelectionModel.isSelected(object);
                  }
                });
            playlistCell = new CompositeCell<Playlist>(playlistHasCells){
                                 @Override
                 protected Element getContainerElement(Element parent) {
                   // Return the first TR element in the table.
                   return parent.getFirstChildElement().getFirstChildElement().getFirstChildElement();
                 }

                 @Override
                 protected <X> void render(Context context, Playlist value,
                     SafeHtmlBuilder sb, HasCell<Playlist, X> hasCell) {
                   Cell<X> cell = hasCell.getCell();
                   cell.render(context, hasCell.getValue(value), sb);
                   sb.appendHtmlConstant(value.getName());
                   //sb.appendHtmlConstant("</td>");
                 }
            };

            composerHasCells.add(new HasCell<Composer, Boolean>() {

                  private CheckboxCell cell = new CheckboxCell(true, false){

                    /* (non-Javadoc)
                     * @see com.google.gwt.cell.client.CheckboxCell#render(com.google.gwt.cell.client.Cell.Context, java.lang.Boolean, com.google.gwt.safehtml.shared.SafeHtmlBuilder)
                     */
                    @Override
                    public void render(Context context, Boolean value, SafeHtmlBuilder sb) {
                        // TODO Auto-generated method stub
                        super.render(context, value, sb);
                    }

                  };

                  public Cell<Boolean> getCell() {
                    return cell;
                  }

                  public FieldUpdater<Composer, Boolean> getFieldUpdater() {
                    return null;
                  }

                  public Boolean getValue(Composer object) {
                    return composerSelectionModel.isSelected(object);
                  }
                });
            composerCell = new CompositeCell<Composer>(composerHasCells){
                                 @Override
                 protected Element getContainerElement(Element parent) {
                   // Return the first TR element in the table.
                   return parent.getFirstChildElement().getFirstChildElement().getFirstChildElement();
                 }

                 @Override
                 protected <X> void render(Context context, Composer value,
                     SafeHtmlBuilder sb, HasCell<Composer, X> hasCell) {
                   Cell<X> cell = hasCell.getCell();
                   cell.render(context, hasCell.getValue(value), sb);
                   sb.appendHtmlConstant(value.getName());
                   //sb.appendHtmlConstant("</td>");
                 }
            };
        }

        /**
         * Get the {@link NodeInfo} that provides the children of the specified
         * value.
         */
        public <T> NodeInfo<?> getNodeInfo(T value) {
            if (value == null) {
                // LEVEL 0.
                // We passed null as the root value. Return the composers.

                // Create a data provider that contains the list of composers.
                ListDataProvider<Composer> dataProvider = new ListDataProvider<CellTreeExample.Composer>(composers);

                // Create a cell to display a composer.
                Cell<Composer> cell = new AbstractCell<Composer>() {
                    @Override
                    public void render(Context context, Composer value, SafeHtmlBuilder sb) {
                        if (value != null) {
                            sb.appendEscaped(value.getName());
                        }
                    }
                };

                // Return a node info that pairs the data provider and the cell.
                return new DefaultNodeInfo<Composer>(dataProvider, composerCell);
            } else if (value instanceof Composer) {
                // LEVEL 1.
                // We want the children of the composer. Return the playlists.
                ListDataProvider<Playlist> dataProvider = new ListDataProvider<Playlist>(((Composer) value)
                        .getPlaylists());
                Cell<Playlist> cell = new AbstractCell<Playlist>() {
                    @Override
                    public void render(Context context, Playlist value, SafeHtmlBuilder sb) {
                        if (value != null) {
                            sb.appendEscaped(value.getName());
                        }
                    }
                };
                return new DefaultNodeInfo<Playlist>(dataProvider, playlistCell);
            } else if (value instanceof Playlist) {
                // LEVEL 2 - LEAF.
                // We want the children of the playlist. Return the songs.

                ListDataProvider<String> dataProvider = new ListDataProvider<String>(((Playlist) value).getSongs());
                /*CellList<String> cellList = new CellList<String>(contactCell);
                dataProvider.addDataDisplay(cellList);*/
                // Use the shared selection model.
                return new DefaultNodeInfo<String>(dataProvider, contactCell, selectionModel, null);
            }

            return null;
        }

        /**
         * Check if the specified value represents a leaf node. Leaf nodes
         * cannot be opened.
         */
        public boolean isLeaf(Object value) {
            // The leaf nodes are the songs, which are Strings.
            if (value instanceof String) {
                return true;
            }
            return false;
        }
    }

    public void onModuleLoad() {
        final MultiSelectionModel<String> selectionModel =
              new MultiSelectionModel<String>();
        final MultiSelectionModel<Playlist> playlistSelectionModel =
              new MultiSelectionModel<Playlist>();
        final MultiSelectionModel<Composer> composerSelectionModel =
              new MultiSelectionModel<Composer>();
        // Create a model for the tree.
        TreeViewModel model = new CustomTreeModel(selectionModel,playlistSelectionModel,composerSelectionModel);

        /*
         * Create the tree using the model. We use <code>null</code> as the
         * default value of the root node. The default value will be passed to
         * CustomTreeModel#getNodeInfo();
         */
        CellTree tree = new CellTree(model, null);

        tree.setKeyboardSelectionPolicy(KeyboardSelectionPolicy.ENABLED);

        // Open the first playlist by default.
        TreeNode rootNode = tree.getRootTreeNode();
        TreeNode firstPlaylist = rootNode.setChildOpen(0, true);
        firstPlaylist.setChildOpen(0, true);

        // Add the tree to the root layout panel.
        RootLayoutPanel.get().add(tree);
    }
} 
```

我的处理程序代码是：

```
playlistSelectionModel.addSelectionChangeHandler(new SelectionChangeEvent.Handler() {

            @Override
            public void onSelectionChange(SelectionChangeEvent event) {
                Set<Playlist> playlistSet = playlistSelectionModel.getSelectedSet();
                Iterator<Playlist> itr = playlistSet.iterator();
                while (itr.hasNext()) {
                    Playlist selectedPlaylist = itr.next();
                    System.out.println("sel: " + selectedPlaylist.getName());
                    if (selectedPlaylist != null){
                        for (String song : selectedPlaylist.getSongs()) {
                            selectionModel.setSelected(song, true);
                        }
                    }
                }

            }
        });

        composerSelectionModel.addSelectionChangeHandler(new SelectionChangeEvent.Handler() {

            @Override
            public void onSelectionChange(SelectionChangeEvent event) {
                Set<Composer> composerSet = composerSelectionModel.getSelectedSet();
                Iterator<Composer> itr = composerSet.iterator();
                while (itr.hasNext()) {
                    Composer selectedComposer = itr.next();
                    if (selectedComposer != null) {
                        for (Playlist playlist : selectedComposer.getPlaylists()) {
                            playlistSelectionModel.setSelected(playlist, true);
                        }
                    }
                }
            }
        });
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T20:55:12.637

你需要两个`SelectionModel`s。
将 a 添加`SelectionChangeHandler`到`SelectionModel`您的父节点并在处理程序中检索父对象的所有子对象并在它们上调用[MultiSelectionModel.setSelected(Obj,true)](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/view/client/MultiSelectionModel.html#setSelected%28T,%20boolean%29)。

播放列表和歌曲是这样的：

**更新**：基于评论：

```
playListSelectionModel.addSelectionChangerHandler(new SelectionChangeEvent.Handler(SelectionChangeEvent event) {
    ArrayList<PlayList> playLists; // all playlists
    for (PlayList playlist:playlists) {
        boolean isSelected = playlistSelectionModel.isSelected(playlist);
        for (String song : selectedPlaylist.getSongs()) {
           selectionModel.setSelected(song, isSelected);
        } 
    }
}}; 
```

当 playListSelectionModel 是`SingleSelectionModel`. 如果它是一个`MultiSelectionModel`你需要两个循环。

# javascript - Javascript Image onload 事件绑定

> ID：10121797
> 
> 赞同：14
> 
> 时间：2012-04-12T10:29:30.037
> 
> 标签：javascript, html, javascript-events

所以我有这段代码循环遍历数组并加载图像并在加载图像时通知。

```
for (var i = 0; i < arr.length; i++) {                
    var imageObj = new Image();
    imageObj.src = url[i];
    imageObj.onload= (function(i){
                return function(){
                    console.log(i, 'loaded');
                }
            })(i);

} 
```

它工作正常。但是，如果我尝试这样做，它将无法正常工作

```
imageObj.addEventListener('onload', function(
    console.log(i, 'loaded');
}, false); 
```

问题是什么？在这种情况下，我有什么办法可以避免使用闭包吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-12T10:45:56.567

问题的一部分：事件不是被调用的`onload`，而是`load`。

```
imageObj.addEventListener('load', function() { /* ... */ }, false); 
```

除此之外，由于`i`事件侦听器函数之外的更改，您需要一个闭包。

# cocoa - 如何将整数传递给模型类

> ID：10121798
> 
> 赞同：1
> 
> 时间：2012-04-12T10:29:32.673
> 
> 标签：cocoa, properties, integer

这个我有点麻烦！我确实查看了很多帖子，但无法使其正常工作。以前在我的应用程序中，我通过将数据分配给属性来设法在类之间传递数据。我不确定我在这里哪里出错了，所以任何帮助将不胜感激。我知道下面的代码不是很好，我正在寻找字典来帮助，但现在我想让它工作。

```
- (IBAction)checkAnswers:(id)sender
{
// The following if statements check user input and checks to see if it is the right answer.
// The .text parts are uitextfield properties and then shows an image of a tick if correct.
// It then assigns one to a variable and sums them up at the end (blag)    
if ([eyepiece.text isEqualToString:@"Eyepiece"]) {
    UIImage *image = [UIImage imageNamed:@"Tick.png"];
    [eyepieceTick setImage:image];
    a = 1;
}

if ([focussingKnobs.text isEqualToString:@"Focussing knobs"]) {
    UIImage *image = [UIImage imageNamed:@"Tick.png"];
    [focussingTick setImage:image];

    b = 1;
}

if ([objectiveLens.text isEqualToString:@"Objective lenses"]) {
    UIImage *image = [UIImage imageNamed:@"Tick.png"];
    [objectiveTick setImage:image];
    c = 1;
}

if ([stage.text isEqualToString:@"Stage"]) {
    UIImage *image = [UIImage imageNamed:@"Tick.png"];
    [stageTick setImage:image];
    d = 1;
}
if ([mirror.text isEqualToString:@"Mirror"]) {
    UIImage *image = [UIImage imageNamed:@"Tick.png"];
    [mirrorTick setImage:image];
    e = 1;
}

blag = a + b + c + d + e;

// Here I update a label with the score    

finalScore = [[NSString alloc] initWithFormat:@"%D", blag];
[score setText:finalScore];

// This is probably where I'm going wrong.  I'm allocating a model class called 
// Level_3_Brain and trying to assign a new property in that class (cellsLevelThree) 
// with the score.   

// Level_3_Brain *level = [[Level_3_Brain alloc] init];
// level.cellsLevelThree = blag;

// Updated to
    [Level_3_Brain sharedInstanceOfLevel3].cellsLevelThree = blag;

// I then set them all back to zero so that the score doesn't go above 5 
a = 0, b = 0, c = 0, d = 0, e = 0; 
blag = 0;

} 
```

我的模型类 .h 现在有：

```
@interface Level_3_Brain : NSObject 

+ (id)sharedInstanceOfLevel3;

@property (nonatomic) int cellsLevelThree;

@end 
```

我的 .m 现在有这段代码来自 Singleton 文章：

```
@implementation Level_3_Brain
@synthesize cellsLevelThree;

static Level_3_Brain *sharedInstanceOfLevel3 = nil;

// Get the shared instance and create it if necessary.
+ (Level_3_Brain *)sharedInstanceOfLevel3 {
if (sharedInstanceOfLevel3 == nil) 
{
sharedInstanceOfLevel3 = [[super allocWithZone:NULL] init];
}

return sharedInstanceOfLevel3;

}

// We can still have a regular init method, that will get called the first time the Singleton is used.

- (id)init
{
self = [super init];

if (self) {
    // Work your initialising magic here as you normally would
}

NSLog(@"%@", cellsLevelThree);

return self;
}

// Your dealloc method will never be called, as the singleton survives for the duration of your app.
// However, I like to include it so I know what memory I'm using (and incase, one day, I convert away from Singleton).
-(void)dealloc
{
// I'm never called!
// [super dealloc];
}

/ We don't want to allocate a new instance, so return the current one.
+ (id)allocWithZone:(NSZone*)zone {
return [self sharedInstanceOfLevel3];
}

// Equally, we don't want to generate multiple copies of the singleton.
- (id)copyWithZone:(NSZone *)zone {
return self;
}

@end 
```

不幸的是，我现在收到错误“在 id 类型的对象上找不到属性‘cellsLevelThree’。请帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:38:49.013

您在评论中正确地确定了您“出错”的地方：问题不在于您错误地设置了值，而在于您将其设置在方法本地的全新实例上，并且退出该方法后立即丢弃。

通常，您的模型类应该在应用程序启动时创建，并在应用程序的整个生命周期内保持可用。这通常使用[*单例*](http://www.johnwordsworth.com/2010/04/iphone-code-snippet-the-singleton-pattern/)来完成。

# android - string.xml 中的 Android 引用字符串

> ID：10121802
> 
> 赞同：16
> 
> 时间：2012-04-12T10:29:42.287
> 
> 标签：android, android-layout

是否可以在 strings.xml 中引用字符串

例如：

```
<string name="application_name">@string/first_name Browser</string>
<string name="first_name">Chrome</string> 
```

根据要求，我可以将 first_name 的值切换为“Chrome”、“Firefox”或“Opera”。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-12T10:35:33.123

您可以给出字符串资源的参考，但限制如下

```
<string name="first_name">Chrome</string>
<string name="application_name">@string/first_name</string> // gives "Chrome"
<string name="application_name">Chrome @string/first_name</string> // gives "Chrome @string/first_name"
<string name="application_name">@string/first_name Chrome </string> // gives error 
```

如果内容以“@”开头，那么 Android 认为这是一个引用字符串，请参见最后一个给出错误的案例，因为 Android 的工具将 @ 和下一个字符串作为字符串的引用名称，它会尝试找到一个名为“@”的资源string/first_name Chrome" 不存在。

您可以使用*字符串格式*来动态分配子字符串，例如`<string name="application_name">%1$s browser</string>`

使用

```
String text = String.format(res.getString(R.string.application_name), "Chrome"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-10-25T10:53:39.037

是的，您可以这样做，而无需添加任何 Java/Kotlin 代码，使用这个允许您仅在构建时使用 XML 的小型库。因此，对于您的情况，您必须像这样设置字符串：

```
<string name="template_application_name">${first_name} Browser</string>
<string name="first_name">Chrome</string> 
```

然后在运行 gradle 插件之后，你会得到这个：

```
<string name="application_name">Chrome Browser</string> 
```

这是图书馆的链接：[https ://github.com/LikeTheSalad/android-string-reference](https://github.com/LikeTheSalad/android-string-reference)

免责声明：我是这个库的作者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T10:37:45.950

strings.xml 中的字符串是固定的，不能在运行时更改。您必须为每种情况定义一个字符串，并在代码中进行切换。

```
String name;

if (/* browser is Chrome*/) {
    name = getString(R.string.first_name_chrome);
} else if (/* browser is Firefox */) {
    name = getString(R.string.first_name_firefox);
} 
```

但是，您可以让应用程序自动为不同的语言选择正确的字符串。这可以通过将字符串文件放在本地化文件夹（values-en、values-fr、values-pl 等）中来完成。

[您可以在http://www.icanlocalize.com/site/tutorials/android-application-localization-tutorial/](http://www.icanlocalize.com/site/tutorials/android-application-localization-tutorial/)阅读有关本地化的更多信息

# c# - JSON.net - 字段是字符串或列表

> ID：10121804
> 
> 赞同：19
> 
> 时间：2012-04-12T10:29:59.477
> 
> 标签：c#, windows-phone-7, json.net

我有一种情况，`JSON`从`REST`服务返回的返回一个电影对象列表，所有这些都包含大量信息。该服务结果中的几个字段`REST`会根据可用信息而变化。

一个例子：一部电影总是有一些屏幕截图（图像）、演员和导演。根据所讨论的电影，可能有一个或多个图像、一个或多个演员和一个或多个导演。几个案例的示例 JSON：

```
{
    "title": "Movie title",
    "images": [
        "http://www.url.com/img_0.jpg",
        "http://www.url.com/img_1.jpg",
        "http://www.url.com/img_2.jpg",
        "http://www.url.com/img_3.jpg",
        "http://www.url.com/img_4.jpg"
    ],
    "actors": [
        "Steven Berkoff",
        "Nikolaj Coster-Waldau",
        "Julie Cox"
    ],
    "directors": "Simon Aeby"
},
{
    "title": "Another movie",
    "images": "http://www.url.com/img_1.jpg",
    "actors": "actor 1"
    "directors": [
        "Justin Bieber",
        "Justin Timberlake"
    ]
} 
```

问题是，使用 JSON.net，我怎样才能创建一个转换器来处理这个问题？我一直在网上搜索，但仍然没有找到解决方案。

同一个问题的另一个旋转：如果一个字段是字符串列表或简单字符串，我如何让 JSON.NET 以任何一种方式创建一个列表（如果只是一个简单的字符串，则创建一个包含一个成员的列表）

编辑：这个 REST 服务是我无法控制的

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-12T11:06:45.907

~~好吧，我这样做是为了好玩，但无论如何，不​​要认为有用或最好的方法......~~

将“动态”属性声明为对象，然后创建获取属性的方法，例如 ImagesAsList 或 ImagesAsString。我用扩展方法做到了......

```
var movies = JsonConvert.DeserializeObject<List<Movie>>(str); 
```

班级

```
class Movie
{

    [JsonProperty("title")]
    public string Title { get; set; }

    [JsonProperty("images")]
    public object Images { get; set; }

    [JsonProperty("actors")]
    public object Actor { get; set; }

    [JsonProperty("directors")]
    public object Directors { get; set; }
} 
```

扩展方法

```
static class MovieExtension
{
    public static List<string> ImagesAsList(this Movie m)
    {
        var jArray = (m.Images as JArray);
        if (jArray == null) return null;

        return jArray.Select(x => x.ToString()).ToList();
    }

    public static string ImagesAsString(this Movie m)
    {
        return m.Images as string;
    }

} 
```

 ~~**编辑**

阅读@yamen 评论后，我做了一些更改，例如：

```
var settings = new JsonSerializerSettings();
settings.Converters.Add(new MoviesConverter());

var movies = JsonConvert.DeserializeObject<List<Movie>>(str, settings); 
```

班级

```
class Movie
{

    [JsonProperty("title")]
    public List<string> Title { get; set; }

    [JsonProperty("images")]
    public List<string> Images { get; set; }

    [JsonProperty("actors")]
    public List<string> Actor { get; set; }

    [JsonProperty("directors")]
    public List<string> Directors { get; set; }
} 
```

转换器

```
class MoviesConverter : JsonConverter
{
    public override bool CanConvert(Type objectType)
    {
        return (objectType == typeof(string)) || (objectType == typeof(List<string>)) ;
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        if (reader.TokenType == JsonToken.StartArray)
        {
            var l = new List<string>();
            reader.Read();
            while (reader.TokenType != JsonToken.EndArray)
            {
                l.Add(reader.Value as string);

                reader.Read();
            }
            return l;
        }
        else
        {
            return new List<string> { reader.Value as string };
        }
    }

    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        //ToDo here we can decide to write the json as 
        //if only has one attribute output as string if it has more output as list
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-12T11:05:03.237

您将无法直接序列化到对象，但您可以手动执行此操作而无需太多努力。JSON.Net 包含 LINQ to JSON。首先定义一个方法，即使底层的 JSON 不是一个数组，它也总是返回一个类型为 T 的列表：

```
public List<T> getSingleOrArray<T>(JToken token)
{
    if (token.HasValues)
    {
        return token.Select(m => m.ToObject<T>()).ToList();
    }
    else
    {
        return new List<T> { token.ToObject<T>() };
    }
} 
```

示例用法：

```
JObject m1 = JObject.Parse(@"{
""title"": ""Movie title"",
""images"": [
    ""http://www.url.com/img_0.jpg"",
    ""http://www.url.com/img_1.jpg""
],
""actors"": [
    ""Steven Berkoff"",
    ""Julie Cox""
],
""directors"": ""Simon Aeby""
}");

JObject m2 = JObject.Parse(@"{
""title"": ""Another movie"",
""images"": ""http://www.url.com/img_1.jpg"",
""actors"": ""actor 1"",
""directors"": [
    ""Justin Bieber"",
    ""Justin Timberlake""
]
}");

IList<String> m1_directors = getSingleOrArray<string>(m1["directors"]);
IList<String> m2_directors = getSingleOrArray<string>(m2["directors"]); 
```

m1_directory 是一个包含单个元素的列表，m2_directors 是一个包含两个元素的列表。~~

# javascript - 如何发送查询

> ID：10121806
> 
> 赞同：-1
> 
> 时间：2012-04-12T10:30:04.860
> 
> 标签：javascript, asp.net

如何将查询从 javascript 发送到 asp.net，然后 asp.net 将其返回 javascript？

```
var=select * from read//send to asp.net
asp.net return values to javascript 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T10:37:05.280

不。

您不能将原始 SQL 查询从客户端 JavaScript 发送到您的服务器，而不会使自己面临严重的安全问题。

而是设计一个 API。

1.  确定您需要进行哪些类型的查询
2.  决定你需要什么用户输入
3.  编写接受 POST 或 GET 请求的 ASP.NET 程序（取决于请求是否[安全](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.1)）
4.  从 ASP.NET 进行查询，确保[避免 SQL 注入](http://bobby-tables.com/csharp.html)
5.  让 ASP.NET 程序以结构化格式（例如[JSON](http://json.org)或 XML）返回数据
6.  使用 XMLHttpRequest 或 JSON-P（可能通过诸如[YUI](http://yuilibrary.com/yui/docs/io/)或[jQuery](http://api.jquery.com/jQuery.ajax/)之类的库从 JavaScript 发出 HTTP 请求，包括您需要插入到查询中的参数

# java - jQuery 主题到 Richfaces 组件

> ID：10121808
> 
> 赞同：1
> 
> 时间：2012-04-12T10:30:09.620
> 
> 标签：java, jquery-ui, jsf, richfaces, themes

有人可以告诉我 jquery 主题是否可以应用于richfaces 组件。具体来说，我现在正在使用 Richfaces 的 dataTable 和 dataScoller 组件。我能够将 ui-widget-header 添加到列标题，但无法将其他主题类（例如 ui-corner-all）添加到 dataTable。我什至在 js 文件的帮助下成功地为 dataScroller 按钮添加了 ui 按钮主题。但是，当通过单击 dataScoller 呈现 dataTable 时，将应用基本的蓝色主题。

有人可以告诉我是否可以将 jQuery 的主题应用于上述组件和 Richfaces 的其他组件。

注意：：我已经使用了rich:jquery，但它没有产生任何结果。

# jquery - jQuery.map() 中的“this”关键字

> ID：10121810
> 
> 赞同：1
> 
> 时间：2012-04-12T10:30:36.607
> 
> 标签：jquery, firebug

我想知道两者之间的区别：

```
$('a').map(function(){return this})
$.map($('a'), function(){return this}) 
```

`firebug`当我在控制台中测试它们时，它们的行为会有所不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T11:02:55.687

刚刚经过简单测试，它们的表现确实不同。后者上下文中的“this”引用了窗口对象。但是，在遍历传入的对象/数组时，您确实可以访问当前元素：

```
$('a').map(function(){
    return this
});
$.map($('a'), function(el){
    return el;
}); 
```

后者通常用于非 jQuery 对象和数组，而前者用于此目的。

有关更多信息，请参阅文档：

[http://api.jquery.com/map/](http://api.jquery.com/map/)

[http://api.jquery.com/jQuery.map/](http://api.jquery.com/jQuery.map/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:34:09.417

没有区别，我认为

```
$('a').map(function(){return this}) 
```

是一个包装器

```
$.map($('a'), function(){return this}) 
```

实际上这是 jQuery 源代码

```
map: function( callback ) {
    return this.pushStack( jQuery.map(this, function( elem, i ) {
        return callback.call( elem, i, elem );
    }));
}, 
```

编辑 - 当然（我认为这是理所当然的）`this`当你调用一个集合时引用当前元素，`.map()`而当你迭代一个集合时它引用窗口对象`$.map()`

# sql-server-2008 - 每日、每周、每月和每年的报告

> ID：10121811
> 
> 赞同：0
> 
> 时间：2012-04-12T10:30:41.910
> 
> 标签：sql-server-2008, reporting-services, group-by, report

我正在使用 SSRS 2008 R2 生成报告。在我的报告中，我必须每天、每周、每月和每年生成报告。

我的表中有日期列，我尝试对这个日期进行分组，它工作正常，但我需要每天、每周、每月和每年显示。我怎样才能按这些分组。有人能帮我一下吗。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T14:17:36.540

您可以根据需要创建任意多个级别的组。（可能有一些上限，但四层分组不会有问题。）继续右键单击您的 tablix 并选择“添加组...”

使用 VB 公式指定分组，例如：

```
=Month(Fields!ColumnA.Value) 
```

然后在组标题中显示为：

```
=MonthName(Month(Fields!ColumnA.Value)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T14:17:07.137

您可以在报告服务或 sql 逻辑中使用日期部分功能为您提供分组所需的数据

=DatePart(DateInterval.Month, Today())

# git - 如何在提交时在 GIT 中强 制执行 issue#

> ID：10121814
> 
> 赞同：1
> 
> 时间：2012-04-12T10:31:06.047
> 
> 标签：git, github, git-svn

我们正在设置 GIT。我们想让用户强制在评论开头输入问题#。像“问题 3222：修复结果变化”。有没有办法配置某种正则表达式，以便在提交之前进行此检查？

谢谢，萨蒂什

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:44:28.753

你可以看看[*pre-commit* hook](https://book.git-scm.com/book/en/v2/Customizing-Git-Git-Hooks)。

# c# - 使用不同语言和 MVVM 的用户会话

> ID：10121821
> 
> 赞同：0
> 
> 时间：2012-04-12T10:31:37.027
> 
> 标签：c#, session, mvvm

我正在使用 MVVM 和 Prism编写**桌面应用程序，但遇到以下问题。**除了标签等，还需要以不同的语言存储数据。

例如，在美国，用户可能能够使用英语或西班牙语登录（因为他们是母语人士）。

*   如果用户在进入产品详细信息表单时使用西班牙语登录，则产品描述将针对西班牙语保存到数据库中。
*   如果他们使用英语登录，产品描述将保存到数据库并与英语相关。

目前我唯一的想法如下：
- 一个全局可访问的 ApplicationViewModel 包含 CurrentLoggedInUser 属性

我想知道的是如何在使用 MVVM 时保存当前登录的用户选择的语言，尤其是在桌面应用程序中？
*注意选择的语言可能与操作系统所在的语言和区域设置*

不同 当使用 MVVM 时，其他人如何解决这个问题并在不同的窗口/用户控件之间维护用户的“会话”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:45:39.610

您需要做的就是将当前语言存储在某个地方，也许是一个[LCID](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.lcid.aspx)。

通常，这用于加载特定于语言的资源文件，该文件负责大多数与语言相关的情况。控件等只是将所有字符串存储在资源中，因此它们不需要直接访问当前语言。

对于您确实需要访问该语言的情况，例如知道将数据库字符串保存在哪里，那么是的，该语言应该作为一些静态/单例公开，或者更理想的是，应该将其注入到任何 ViewModel 中。

# php - 从数据库中检索不包括 html 标记的数据

> ID：10121823
> 
> 赞同：0
> 
> 时间：2012-04-12T10:31:54.707
> 
> 标签：php, mysql, html

如何从数据格式为的数据库中检索数据

```
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;\&quot;&gt;Classic Developers, a destination that offers every one luxurious and fulfilling yet affordable lifestyle. It is one of the emerging real estate developers in the country having diverse range of activities in varied business domain. We are a certified company having large scale projects in progress.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;\&quot;&gt;&lt;br /&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&quot;\&quot;&gt;Classic Developers with its dynamic professional work force and uncompromising attitude in terms of construction methodologies and quality control procedures, we offer you Efficient, Elegant and Economical place, which will be called your home, your happiness. We are here not only for a residential place but to fulfill your dream of having a home with modern day comfort and soothing ambience. We not only offer modern structures with latest amenities but ensure all the valued customers with Earthquake resistant and VASTU compliant construction.&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt; 
```

我需要没有 html 标签和其他样式的值。只有我想要的是里面的文字。我怎样才能用 php 检索它。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T10:33:13.890

[http://php.net/manual/en/function.strip-tags.php](http://php.net/manual/en/function.strip-tags.php)

一旦你从数据库中得到它，在你回显它之前在它上面运行这个函数：

```
$content = strip_tags($content); 
```

**编辑**

该问题已被编辑以显示特殊字符而不是原始 HTML。如果*是*这种风格，请尝试以下方式：

```
$content = strip_tags(htmlspecialchars_decode($content)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:35:05.573

从数据库中获取列后，您可以使用`strip_tags()`方法来清理输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:35:13.390

如果您不想要@Ben Griffiths 建议的简单解决方案并且您仍然需要纯数据库处理，那么请查看正则表达式 - 请参阅[MySQL regex replace?](https://stackoverflow.com/questions/3161395/mysql-regex-replace)

# android - 从电子邮件意图中删除逗号 (EXTRA_EMAIL)

> ID：10121826
> 
> 赞同：1
> 
> 时间：2012-04-12T10:32:11.400
> 
> 标签：android

我在我的 Android 应用程序中使用电子邮件意图。它工作正常，但是当电子邮件被移植到电子邮件应用程序时，它总是在电子邮件地址行中添加一个逗号。我尝试使用字符串添加电子邮件地址，但它仅适用于字符串数组。有没有机会删除那个逗号？

这是我的代码：

```
String stremailaddress;
stremailaddress = "myemail@whatever.com";
String emailaddress[] = { stremailaddress };
emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, emailaddress); 
```

这是电子邮件应用程序中电子邮件地址行的样子：

```
myemail@whatever.com, 
```

我希望它看起来像这样：

```
myemail@whatever.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:39:51.047

您无法更改此行为，因为逗号是由电子邮件应用程序本身插入的。除非您编写了自己的电子邮件应用程序来消除逗号，否则您必须忍受这一点。虽然最后有一个逗号并没有什么坏处，因为如果电子邮件应用程序插入它，那么它也可能会在发送邮件之前处理它。

插入逗号的唯一原因是为了方便您手动添加更多电子邮件地址。因此，如果您不想添加更多地址，请忽略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:39:46.333

这取决于电子邮件应用程序，以及它如何选择显示它收到的电子邮件地址列表。所以，不，你对此无能为力。

（反正也没关系。）

# php - php脚本调用批处理文件时出错

> ID：10121827
> 
> 赞同：0
> 
> 时间：2012-04-12T10:32:14.373
> 
> 标签：php, batch-file

我有文件 php 脚本`run.php`：

```
#!/usr/bin/php
<?php
$typeTest = $argv[1];    
`aaa.bat $typeTest`;    
?> 
```

和批处理文件`aaa.bat`

```
@echo off
set a=%1
echo %a% 
```

但是，当`php run.php string_here`在命令行窗口上运行时会出错

```
'∩╗┐@echo' is not recognized as an internal or external command,
operable program or batch file. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:47:02.370

不确定您使用的是哪个编辑器，但它似乎在文件开头输入了无效字符。有人说更改文件的编码是可行的，但是上次我遇到这个问题时它对我不起作用。我建议下载notepad++（它是免费的），然后编辑文件并使用该程序重新保存。

编辑：我倾向于使用 ANSI 进行编码（因为无论如何它都是在记事本中选择的默认值），没有任何问题。鉴于文件的大小，您可以在记事本中重新输入并使用 ANSI 保存（不要在记事本中打开并重新保存，因为它可能不会显示字节标记供您删除）

# android - Android：如何在某些路径后面绘制位图？

> ID：10121830
> 
> 赞同：0
> 
> 时间：2012-04-12T10:32:18.417
> 
> 标签：android

任务如下：

仅在路径后面绘制某些位图的一部分（用户用手指绘制路径）。它必须看起来像用户用他的手指绘制这个位图。它类似于任务：用手指擦除一些图片，但方法应该不同。

我知道 OpenGL 是可能的，但起初我正在寻找标准 android 画布和视图绘图的更轻的选项。

我已经在 APIDemos 中看到了 FingerPaint 示例（请不要参考它）。

我对某人执行此任务的真实经验或任何其他可以提供帮助的信息、链接或代码感兴趣。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:38:59.700

你说不要让*你*参考 FingerPaint，但你有没有想过这个样本可能确实有答案？

您可以将其调整为相互叠加的两个视图……您隐藏在下面的图像和作为顶部遮罩的手指画视图。您使用颜色 0x00000000 进行“绘画”，即完全透明，从而在下面的视图中显示图像。

# google-fusion-tables - 将图例添加到 Google Fusion Table

> ID：10121834
> 
> 赞同：0
> 
> 时间：2012-04-12T10:32:44.407
> 
> 标签：google-fusion-tables

我正在尝试添加从 Google Fusion Table Layer Builder 创建的图例 ta 地图，但似乎没有任何事情发生。图例不显示。这是示例代码。[示例代码](http://kenyaelectionmaps.blogspot.com/2012/04/sample-code.html)

```
 <!DOCTYPE html>
 <html>
 <head>
 <style>
 #map-canvas { width:500px; height:400px; }
 </style>
 <script type="text/javascript"
 src="http://maps.google.com/maps/api/js?sensor=false">
 </script>
 <script type="text/javascript">
 var map;
 var layerl0;
 function initialize() {
  map = new google.maps.Map(document.getElementById('map-canvas'), {
    center: new google.maps.LatLng(0.428462803418747, 37.760009765625),
    zoom: 6,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });
  layerl0 = new google.maps.FusionTablesLayer({
    query: {
      select: "'geometry'",
      from: 3435376
    },
    map: map
  });
  // Create the legend and display on the map
    var legend = document.createElement('div');
    legend.id = 'legend';
    var content = [];
    content.push('<h3>Legend</h3>');
    content.push('<p><div class="color red"></div>No</p>');
    content.push('<p><div class="color green"></div>Yes</p>');
    content.push('<p>*Data is fictional</p>');
    legend.innerHTML = content.join('');
    legend.index = 1;
    map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legend);
}
google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>
<body>
<div id="map-canvas"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T23:27:45.083

图例标签只允许在字段集标签内。

[http://www.w3schools.com/html5/tag_legend.asp](http://www.w3schools.com/html5/tag_legend.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T13:16:40.927

您的图例确实显示了，至少是文字。您需要添加一些 CSS 样式，例如将背景设置为白色等。有一个很好的示例

[http://gmaps-samples.googlecode.com/svn/trunk/fusiontables/legend_template.html](http://gmaps-samples.googlecode.com/svn/trunk/fusiontables/legend_template.html)

请参阅 Legend() 和 updateLegend() 函数。

**更新** 这确实是一个 CSS 问题。我的更改标记为 ADDED 或 CHANGED

```
var legend = document.createElement('div');
legend.id = 'legend';

// ADDED
legend.style.padding = '10px';
legend.style.backgroundColor = 'white';
legend.style.borderStyle = 'solid';
legend.style.borderWidth = '1px';
legend.style.textAlign = 'left';

var content = [];
content.push('<h3>Legend</h3>');
// CHANGED
//content.push('<p><div class="color red"></div>No</p>');
//content.push('<p><div class="color green"></div>Yes</p>');
content.push('<p style="background-color: #51D950;">No</p>');
content.push('<p style="background-color: #C84939;">Yes</p>');

content.push('<p>*Data is fictional</p>');
legend.innerHTML = content.join('');
legend.index = 1;
map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(legend); 
```

# ruby-on-rails - 如何使用 RSpec 模拟登录？

> ID：10121835
> 
> 赞同：55
> 
> 时间：2012-04-12T10:32:49.103
> 
> 标签：ruby-on-rails, rspec, factory-bot

我已经使用 Rails 几年了，并且已经制作了几个可以通过的应用程序，这些应用程序正在生产中。我一直避免做任何测试，但我决定纠正它。我正在尝试为我为已经启动并运行但正在不断修订的工作编写的应用程序编写一些测试。我担心任何更改都会破坏事情，所以我想启动并运行一些测试。我已经阅读了 RSpec 书，观看了一些截屏视频，但我很难开始（这让我觉得只有在你真正完成之后才能理解）。

我正在尝试编写应该是对我的 ReportsController 的简单测试。我的应用程序的问题在于，几乎整个事情都位于身份验证层后面。如果您没有登录，则没有任何作用，因此我必须先模拟登录，然后才能发送一个简单的 get 请求（尽管我想我应该编写一些测试以确保没有登录就无法正常工作-我会到后来）。

我已经用 RSpec、Capybara、FactoryGirl 和 Guard 建立了一个测试环境（不确定要使用哪些工具，所以使用了 Railscasts 的建议）。到目前为止，我编写测试的方式是像这样在 FactoryGirl 中创建一个用户；

```
FactoryGirl.define do
  sequence(:email) {|n| "user#{n}@example.com"}
  sequence(:login) {|n| "user#{n}"}
  factory :user do
    email {FactoryGirl.generate :email}
    login {FactoryGirl.generate :login}
    password "abc"
    admin false
    first_name "Bob"
    last_name "Bobson"
  end
end 
```

然后像这样写我的测试；

```
require 'spec_helper'

describe ReportsController do
  describe "GET 'index'" do
    it "should be successful" do
      user = Factory(:user)
      visit login_path
      fill_in "login", :with => user.login
      fill_in "password", :with => user.password
      click_button "Log in"
      get 'index'
      response.should be_success
    end
  end
end 
```

这失败了；

```
 1) ReportsController GET 'index' should be successful
     Failure/Error: response.should be_success
       expected success? to return true, got false
     # ./spec/controllers/reports_controller_spec.rb:13:in `block (3 levels) in <top (required)>' 
```

有趣的是，如果我将测试更改为`response.should be_redirect`，则测试通过了，这向我表明一切都在正常运行，但登录没有被识别。

所以我的问题是我必须做什么才能使这个登录工作。我是否需要在数据库中创建与 FactoryGirl 凭据匹配的用户？如果是这样，FactoryGirl 的意义何在（我什至应该使用它）？我该如何在测试环境中创建这个假用户？我的身份验证系统是一个非常简单的自制系统（基于[Railscasts 第 250 集](http://railscasts.com/episodes/250-authentication-from-scratch)）。这种登录行为大概必须为我的几乎所有测试复制，那么我如何在我的代码中执行一次并让它在任何地方都适用？

我意识到这是一个大问题，所以我感谢您的关注。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-12T10:43:00.143

The answer depends on your authentication implementation. Normally, when a user logs in, you'll set a session variable to remember that user, something like `session[:user_id]`. Your controllers will check for a login in a `before_filter` and redirect if no such session variable exists. I assume you're already doing something like this.

To get this working in your tests, you have to manually insert the user information into the session. Here's part of what we use at work:

```
# spec/support/spec_test_helper.rb
module SpecTestHelper   
  def login_admin
    login(:admin)
  end

  def login(user)
    user = User.where(:login => user.to_s).first if user.is_a?(Symbol)
    request.session[:user] = user.id
  end

  def current_user
    User.find(request.session[:user])
  end
end

# spec/spec_helper.rb
RSpec.configure do |config|
  config.include SpecTestHelper, :type => :controller
end 
```

Now in any of our controller examples, we can call `login(some_user)` to simulate logging in as that user.

* * *

I should also mention that it looks like you're doing integration testing in this controller test. As a rule, your controller tests should only be simulating requests to individual controller actions, like:

```
it 'should be successful' do
  get :index
  response.should be_success
end 
```

This specifically tests a single controller action, which is what you want in a set of controller tests. Then you can use Capybara/Cucumber for end-to-end integration testing of forms, views, and controllers.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-04-12T09:20:03.970

**在spec/support/controller_helpers.rb**中添加帮助文件并复制下面的内容

```
module ControllerHelpers
    def sign_in(user)
      if user.nil?
        allow(request.env['warden']).to receive(:authenticate!).and_throw(:warden, {:scope => :user})
        allow(controller).to receive(:current_user).and_return(nil)
      else
        allow(request.env['warden']).to receive(:authenticate!).and_return(user)
        allow(controller).to receive(:current_user).and_return(user)
      end
    end
  end 
```

**现在在spec/rails_helper.rb**或**spec/spec_helper.rb** 文件中添加以下行

```
require 'support/controller_helpers'

RSpec.configure do |config|

    config.include Devise::TestHelpers, :type => :controller
    config.include ControllerHelpers, :type => :controller

  end 
```

现在在您的控制器规范文件中。

```
describe  "GET #index" do

    before :each do        
        @user=create(:user)
        sign_in @user
    end
      ...
end 
```

[设计官方链接](https://github.com/plataformatec/devise/wiki/How-To:-Stub-authentication-in-controller-specs)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-04T20:31:29.240

由于我无法使@Brandan 的答案起作用，但基于它和[这篇文章](http://nosuchthingastwo.com/rspec-macros/)，我得出了这个解决方案：

```
# spec/support/rails_helper.rb
Dir[Rails.root.join("spec/support/**/*.rb")].each { |f| require f } # Add this at top of file

...

include ControllerMacros # Add at bottom of file 
```

和

```
# spec/support/controller_macros.rb
module ControllerMacros

  def login_as_admin
    admin = FactoryGirl.create(:user_admin)
    login_as(admin)
  end

  def login_as(user)
    request.session[:user_id] = user.id
  end

end 
```

然后在您的测试中，您可以使用：

```
it "works" do
  login_as(FactoryGirl.create(:user))
  expect(request.session[:user_id]).not_to be_nil
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-06T20:56:41.033

在功能测试中使用用户登录的最简单方法是使用 Warden 的[助手 #login_as](http://www.rubydoc.info/github/hassox/warden/Warden/Test/Helpers)

```
login_as some_user 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-09T19:28:49.390

对于那些不使用设计的人：

`spec/rails_helper.rb`：

```
require_relative "support/login_helpers"

RSpec.configure do |config|
  config.include LoginHelpers
end 
```

`spec/support/login_helpers.rb`：

```
module LoginHelpers
  def login_as(user)
    post "/session", params: { session: { email: user.email, password: "password" } }
  end
end 
```

并在规格中：

```
login_as(user) 
```

# c - 在 C 中打开和写入多个文件

> ID：10121838
> 
> 赞同：4
> 
> 时间：2012-04-12T10:32:54.083
> 
> 标签：c, unix, file-descriptor

输入是大约 70GB 的单个文件，其每一行都包含客户信息。一个程序读取这个文件并为每个客户制作一个文件。有 8000 个客户，但我们必须为 40000 个客户提供服务。目前 UNIX 排序命令用于按客户端对文件进行排序，然后写入客户端文件。这样，程序只打开了一个文件处理程序来创建文件。我们不想使用 sort 命令，因为它消耗大约 1.5 小时。然而，这意味着打开的 8000 个文件处理程序需要保持打开状态。内核参数可能需要修改。是否可以在不更改内核参数的情况下打开这么多文件。我尝试浏览 libevent 网站，但不确定这是否是正确的解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-12T10:41:37.877

You don't necessarily need 8000 file handles open at the same time, nor do you need to sort the data. Sorting is a waste unless you need each clients lines sorted as well.

Presumably, you can identify the client by some item on the line. Let's say (for example) it's the first 8 characters on each line, then your pseudo-code looks like this:

```
delete all files matching "*_out.dat"
for each line in file:
    key = left (line, 8)
    open file key + "_out.dat" for append
    write line to file
    close file 
```

That's it. Simple. Only one file open at a time and no time wasted sorting.

Now there are *further* improvements that could be made to that, amongst them being:

1.  Don't close the file for the previous line unless the next line has a different key. This will catch situations where you have a hundred records in a row for the same key and will hold the file open in that case.

2.  Maintain a cache of open file handles like a most recently used list (say 16 different keys). Again, this will prevent closure until a file handle has to be reused but it will laso handle the situation where clusters are more efficient (such as customer 1,2,3,7,1,2,3,2,2,3,7,4,...).

But the basic theory remains the same: don't try to open 8000 (or 40000) files at once when you can get by with less.

* * *

Alternatively, just process the data, stashing it all into a database and using queries to then create each file with a series of queries. Whether that's *faster* than the solution above should be tested, as in fact should *every* suggestion given here. *Measure, don't guess!*

* * *

Now, since I've invoked that optimisation mantra, let's do some timings, keeping in mind that this is specific to my hardware and may be different on yours.

Start with the following script, which generates a one-million-line file where the first eight characters of each line are a random number between `10000000` and `10032767` inclusive. We'll use characters 5 through 8 inclusive to give us the customer number, ten thousand customers at roughly a hundred lines per customer:

```
#!/bin/bash
line='the quick brown fox jumps over the lazy dog'
for p0 in 1 2 3 4 5 6 7 8 9 0 ; do
 for p1 in 1 2 3 4 5 6 7 8 9 0 ; do
  for p2 in 1 2 3 4 5 6 7 8 9 0 ; do
   for p3 in 1 2 3 4 5 6 7 8 9 0 ; do
    for p4 in 1 2 3 4 5 6 7 8 9 0 ; do
     for p5 in 1 2 3 4 5 6 7 8 9 0 ; do
      ((x = 10000000 + $RANDOM))
      echo "$x$line"
     done
    done
   done
  done
 done
done 
```

The file size produced is about 50M. We can scale it up to 100M by simply concatenating 2 copies of it to another file, and this gives us about two hundred lines per customer.

* * *

Now, examine the following program:

```
#include <stdio.h>
#include <string.h>
#include <errno.h>

#define FOUT_STR "1234_out.dat"

int main (void) {
    FILE *fIn, *fOut;
    char outFile[sizeof (FOUT_STR)];
    char buff[1000];

    if ((fIn = fopen ("data.dat", "r")) == NULL) {
        printf ("Error %d opening 'data.dat'\n", errno);
        return 1;
    }

    memcpy (outFile, FOUT_STR, sizeof (FOUT_STR));
    if ((fOut = fopen (outFile, "w")) == NULL) {
        printf ("Error %d opening '%s'\n", errno, outFile);
        fclose(fIn);
        return 1;
    }

    while (fgets (buff, sizeof (buff), fIn) != NULL) {
        fputs (buff, fOut);
    }

    fclose (fOut);
    fclose (fIn);
    return 0;
} 
```

This gives a baseline figure for just writing all entries to a single file, and takes under a second to run.

* * *

Now let's have one which opens a new file every two hundred lines - this is the behaviour you'd see if the file was already sorted by customer:

```
#include <stdio.h>
#include <string.h>
#include <errno.h>

#define FOUT_STR "1234_out.dat"

int main (void) {
    FILE *fIn, *fOut;
    char outFile[sizeof (FOUT_STR)];
    char buff[1000];
    char custNum[5];
    int i = -1;

    if ((fIn = fopen ("data.dat", "r")) == NULL) {
        printf ("Error %d opening 'data.dat'\n", errno);
        return 1;
    }

    fOut = NULL;
    while (fgets (buff, sizeof (buff), fIn) != NULL) {
        i++;
        if ((i % 200) == 0) {
            if (fOut != NULL)
                fclose (fOut);
            sprintf (custNum, "%04d", i / 200);
            memcpy (outFile, FOUT_STR, sizeof (FOUT_STR));
            memcpy (outFile, custNum, 4);
            if ((fOut = fopen (outFile, "w")) == NULL) {
                printf ("Error %d opening '%s'\n", errno, outFile);
                break;
            }
        }
        fputs (buff, fOut);
    }
    if (fOut != NULL)
        fclose (fOut);

    fclose (fIn);
    return 0;
} 
```

This takes about 2s (0:00:02) for the 100M file, and testing it with a 200M and 400M file indicates that it scales linearly. That means that with a sorted 70G file, you're looking at about 1400s or 0:23:20\. Note that this would be on top of your sort cost which you have as 1.5h (1:30:00), giving you a total cost of 1:53:20.

* * *

Now let's implement out simplistic program which simply opens each file for append for every line:

```
#include <stdio.h>
#include <string.h>
#include <errno.h>

#define FOUT_STR "1234_out.dat"

int main (void) {
    FILE *fIn, *fOut;
    char outFile[sizeof (FOUT_STR)];
    char buff[1000];

    if ((fIn = fopen ("data.dat", "r")) == NULL) {
        printf ("Error %d opening 'data.dat'\n", errno);
        return 1;
    }

    while (fgets (buff, sizeof (buff), fIn) != NULL) {
        memcpy (outFile, FOUT_STR, sizeof (FOUT_STR));
        memcpy (outFile, &(buff[4]), 4);
        if ((fOut = fopen (outFile, "a")) == NULL) {
            printf ("Error %d opening '%s'\n", errno, outFile);
            break;
        }
        fputs (buff, fOut);
        fclose (fOut);
    }

    fclose (fIn);
    return 0;
} 
```

When we run this with the 100M file, it takes 244s (0:04:04). And again, testing with a 200M and 400M file indicates linear scaling. So, for the 70G file, that's going to be 47:26:40, not *really* what you would call an improvement over your sub-two-hour sort-and-process option.

* * *

However, let's try a different tack, with the following program, which maintains a hundred file handles each time through the input file (done a hundred times):

```
#include <stdio.h>
#include <string.h>
#include <errno.h>

#define FOUT_STR "1234_out.dat"

int main (void) {
    FILE *fIn, *fOut[100];
    char outFile[sizeof (FOUT_STR)];
    char buff[1000];
    int seg, cust;
    char segNum[3], custNum[3];

    for (seg = 0; seg < 100; seg++) {
        sprintf (segNum, "%02d", seg);

        if ((fIn = fopen ("data.dat", "r")) == NULL) {
            printf ("Error %d opening 'data.dat'\n", errno);
            return 1;
        }

        for (cust = 0; cust < 100; cust++) {
            sprintf (custNum, "%02d", cust);

            memcpy (outFile, FOUT_STR, sizeof (FOUT_STR));
            memcpy (outFile+0, segNum, 2);
            memcpy (outFile+2, custNum, 2);
            if ((fOut[cust] = fopen (outFile, "w")) == NULL) {
                printf ("Error %d opening '%s'\n", errno, outFile);
                return 1;
            }
        }

        while (fgets (buff, sizeof (buff), fIn) != NULL) {
            if (memcmp (&(buff[4]), segNum, 2) == 0) {
                cust = (buff[6] - '0') * 10 + buff[7] - '0';
                fputs (buff, fOut[cust]);
            }
        }

        for (cust = 0; cust < 100; cust++) {
            fclose (fOut[cust]);
        }

        fclose (fIn);
    }

    return 0;
} 
```

This is a slight variation which actually processes the input file a hundred times, each time only processing the lines meant for a hundred individual output files.

When this is run on the 100M file, it takes about 28s (0:00:28). Once again, that seems to scale linearly for a 200M and 400M file, so the 70G file should take 5:26:40.

Still not even close to the sub-two-hour figure.

* * *

So what happens when we open a thousand output files at a time:

```
#include <stdio.h>
#include <string.h>
#include <errno.h>

#define FOUT_STR "1234_out.dat"

int main (void) {
    FILE *fIn, *fOut[1000];
    char outFile[sizeof (FOUT_STR)];
    char buff[1000];
    int seg, cust;
    char segNum[2], custNum[4];

    for (seg = 0; seg < 10; seg++) {
        sprintf (segNum, "%01d", seg);

        if ((fIn = fopen ("data.dat", "r")) == NULL) {
            printf ("Error %d opening 'data.dat'\n", errno);
            return 1;
        }

        for (cust = 0; cust < 1000; cust++) {
            sprintf (custNum, "%03d", cust);

            memcpy (outFile, FOUT_STR, sizeof (FOUT_STR));
            memcpy (outFile+0, segNum, 1);
            memcpy (outFile+1, custNum, 3);
            if ((fOut[cust] = fopen (outFile, "w")) == NULL) {
                printf ("Error %d opening '%s'\n", errno, outFile);
                return 1;
            }
        }

        while (fgets (buff, sizeof (buff), fIn) != NULL) {
            if (memcmp (&(buff[4]), segNum, 1) == 0) {
                cust = (buff[5] - '0') * 100 + (buff[6] - '0') * 10 + buff[7] - '0';
                fputs (buff, fOut[cust]);
            }
        }

        for (cust = 0; cust < 1000; cust++) {
            fclose (fOut[cust]);
        }

        fclose (fIn);
    }

    return 0;
} 
```

That takes about 12s for the 100M file, and would give us 2:20:00, coming close to the sort but not quite there.

* * *

Unfortuntely, when we go the next logical step, trying to opening up the entire 10000 files in one hit, we see:

```
Error 24 opening '1020_out.dat' 
```

meaning that we've finally come to the limit (standard input, standard output, standard error and about 1019 other file handles), which indicates that 1024 handles is about all we are allowed.

So maybe the sort-and-process method *is* the best way to go.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:40:02.623

我不知道 Unix 平台的限制，但是在 Windows 中，您可以使用 WINAPI 打开任意数量的文件，也可以使用 _setMaxstdio 设置打开文件句柄的最大数量，默认情况下为 512（使用 fopen）。

[这是一个类似的解决方案，可以帮助你！](https://stackoverflow.com/questions/6059919/c-c-system-portable-way-to-change-maximum-number-of-open-files)

# web-services - 在 PERL 中访问 Web 服务

> ID：10121844
> 
> 赞同：0
> 
> 时间：2012-04-12T10:33:18.693
> 
> 标签：web-services, perl

我正在从 perl 脚本访问托管在 IIS 中的 Web 服务。我有一个服务中的方法，它返回一个字符串数组。我无法读取服务的响应。通过使用 Dumper，我打印了服务返回的响应，在那里我可以看到数组值，但我无法访问数组值。如何访问从 Web 服务方法返回的 thr 数组值。

perl中的方法调用：

```
my $method2 = SOAP::Data->name('getCustInfo')->attr({xmlns => 'http://tempuri.org/'});
my @param=(SOAP::Data->name(custId=>$custid));
my $response1= $soap->call($method2=>@param);
print $response1;

print Dumper $response1;

@result11=$response1->result;
print Dumper $response1;
$i=-1;
foreach my $result(@result11)
{
  ++$i;
  print $result[$i];
} 
```

我用来访问该方法的上述代码，我正在尝试打印它，但它无法正常工作： HASH(0x3a84518)$VAR1 = undef;
问题是什么。

谢谢，
阿维纳什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T12:44:17.183

在知道响应之前检查呼叫是否发生。

使用严格；使用警告；

```
use SOAP::Lite +trace=>"debug"; # it debugs whether the connection is set or not

my ($soap,$proxy,$uri);

eval {
    $soap  = new SOAP::Lite
             proxy=>$proxy,
             uri=>$uri;
};

    if ( $@ ){
     print " Service Down\n";
     } 
```

对于soap调用，它需要代理和uri，请在eval中检查它们是否可访问。

# c# - .net 紧凑框架的 ThreadStatic

> ID：10121845
> 
> 赞同：1
> 
> 时间：2012-04-12T10:33:36.667
> 
> 标签：c#, multithreading, compact-framework

我们如何`ThradStatic`在 .net compact framework 3.5 中重现行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:38:18.973

我会建议一个静态（在本例中为 appdomain 静态）字典，由线程 ID 索引，并使用 Thread.Current 将相关的 getter 和 setter 索引到字典中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-09T04:49:50.177

您可以使用`LocalDataStoreSlot`在线程终止时自动丢弃对象的类。

例如：

```
private static readonly LocalDataStoreSlot nameSlot = Thread.AllocateDataSlot();

public string Name
{
    get { return (string)Thread.GetData(nameSlot); }
    set { Thread.SetData(nameSlot, value); }
} 
```

# .net - 字符串连接：最终字符串值不等于最新值

> ID：10121847
> 
> 赞同：0
> 
> 时间：2012-04-12T10:33:41.080
> 
> 标签：.net, vb.net, string, operators, string-concatenation

我有一个关于字符串连接的简单问题。以下是代码。我想问为什么 s6 = "abcde" 而不是 "akcde"？我已将 s2 值更改为“k”。

```
Public Class Form1
    Public s1 As String = "a"
    Public s2 As String = "b"
    Public s3 As String = "c"
    Public s4 As String = "d"
    Public s5 As String = "e"
    Public s6 As String = ""
    Public s7 As String = "k"

    Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
        s6 = s1 & s2 & s3 & s4 & s5
        s2 = s7
        MessageBox.Show(s6) 's6 = abcde

    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:36:12.160

因为当您将值分配给 s6 - 创建一个基于 s1 - s5 串联的新字符串 - 之后更改 s2 对 s6 中的值没有影响

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T11:26:07.793

当您将值存储在 s6 中时，它会存储为“abcde”，然后在您更改 s2 的值之后，因此 s6 不受影响，因为它不存在于表达式“s2=s7”中

因为编译器只得到 s2 和 s7，所以它的工作原理是，当您更改任何一个变量时，编译器不会检查每个变量.....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T10:38:24.513

当你这样做时：

```
s6 = s1 & s2 & s3 & s4 & s5 
```

`s6`contains `abcde`，一个由连接产生的新字符串。

然后更改变量的值`s2`——这不会改变`s6`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:38:39.047

当连接 2 个字符串时，会生成一个新字符串，因为字符串是不可变的。即使您修改了一个字符串，也会生成一个新的字符串。为了证明这一点，只需尝试

```
s1 = "foo"
s2 = s1
s1 = s1 + "bar" 's2 == 'foo' 
```

经验法则：不要将字符串变量视为对字符串的引用，而应将其视为值对象，就像 int 或 bool 变量一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T10:40:40.263

你只是在做你的分配并以错误的顺序连接，改变这个；

```
Public Class Form1
    Public s1 As String = "a"
    Public s2 As String = "b"
    Public s3 As String = "c"
    Public s4 As String = "d"
    Public s5 As String = "e"
    Public s6 As String = ""
    Public s7 As String = "k"

    Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
        s2 = s7
        s6 = s1 & s2 & s3 & s4 & s5
        MessageBox.Show(s6) 's6 = abcde

    End Sub
End Class 
```

# dojo - dojo：dijit.layout.BorderContainer 与其子级之间的差距

> ID：10121855
> 
> 赞同：0
> 
> 时间：2012-04-12T10:34:01.627
> 
> 标签：dojo, dijit.layout

我按照以下站点在 dojo 中进行了一些布局： [http://dojotoolkit.org/documentation/tutorials/1.7/dijit_layout/](http://dojotoolkit.org/documentation/tutorials/1.7/dijit_layout/) 问题是 BorderContainer 与其子级之间存在差距。如何消除它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:37:32.470

将`gutters`属性设置为 false。

```
new BorderContainer({
    ...
    gutters: false
}); 
```

# c# - 如何使用 C# MVC3 在同一请求中将对象共享给类

> ID：10121859
> 
> 赞同：0
> 
> 时间：2012-04-12T10:34:27.260
> 
> 标签：c#, asp.net-mvc-3

我有一个 C# MVC3 站点。但是，我需要在同一个请求中将对象共享给多个类。
其他请求无法访问/不知道共享对象存在。
请求结束后，应该删除共享对象。

此示例代码可以将对象分配给每个请求，而不是仅在一个请求中共享对象。

```
Class ShareObjects
{
    private static SomeThing _Data = null;
    public static SomeThing Data
    {
        get
        {
            if (_Data == null)
            {
                _Data = new SomeThing();
            }

            return _Data;
        }
    }
}

Class ObjectA
{
    public ObjectA()
    {
        var data = ShareObjects.Data;
        //Do stuff
    }
}

Class ObjectB
{
    public ObjectB()
    {
        var data = ShareObjects.Data;
        //Do stuff
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T08:14:14.117

您可以将代码添加到 global.asax.cs：

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    var customContext = CustomHttpContext.Initialize(new HttpContextWrapper( Context) );
} 
```

正如您在上面的代码中所见，我们所做的是将它挂在 HttpContext 上。CustomHttpContext Initialize 例程如下所示：

```
public static CustomHttpContext Initialize(HttpContextBase httpContextBase)
{
    Guard.IsNotNull(httpContextBase, "httpContext");

    // initialize only once
    if (! httpContextBase.Items.Contains(key))
    {
        CustomHttpContext newCustomHttpContext = new CustomHttpContext();
        httpContextBase.Items[key] = newCustomHttpContext;
        return newCustomHttpContext;
    }
    return Get(httpContextBase);
} 
```

完成后。您可以通过提供上下文来调用 CustomHttpContext：

```
CustomHttpContext.Get(HttpContext).PropA; 
```

希望这可以帮助。

# binary - 移位中的字节序依赖，按位运算符

> ID：10121860
> 
> 赞同：2
> 
> 时间：2012-04-12T10:34:33.717
> 
> 标签：binary, endianness, bit, bit-shift

处理掩码或从整数中提取单个位的任何操作是否取决于字节顺序？我已经编写了一些代码，但只能访问一种类型的硬件，我无法真正检查它的运算符是否与字节序无关。如果您发现任何错误，请告诉我。注意：此代码是为家庭作业问题和个人启发而编写的：

```
 void PrintDecimalIntegerInBinary (long long n) 
 {  
    PrintDecimalInBinaryRecursion(n, n >= 0);
 }

 void PrintDecimalInBinaryRecursion (long long n, bool sign) 
 {
    if (n == 0) {
        cout << (sign ? 0x0 : 0x1);
    }
    else {
        PrintDecimalInBinaryRecursion((unsigned long long)n >> 1, sign);
    cout << (n & 0x1);
    }     
 } 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T10:37:58.067

字节序仅决定数据的存储方式，而不是处理方式。因此，任何按位运算符或位移都不受字节序的影响。具体来说，`0x1`无论字节顺序如何，都意味着同样的事情。

# python - 在 Python 中除以大数

> ID：10121861
> 
> 赞同：7
> 
> 时间：2012-04-12T10:34:35.810
> 
> 标签：python

我正在尝试在 Python 中划分一些大数，但我得到了一些奇怪的结果

```
NStr = "7D5E9B01D4DCF9A4B31D61E62F0B679C79695ACA70BACF184518" \
       "8BDF94B0B58FAF4A3E1C744C5F9BAB699ABD47BA842464EE93F4" \
       "9B151CC354B21D53DC0C7FADAC44E8F4BDF078F935D9D07A2C07" \
       "631D0DFB0B869713A9A83393CEC42D898516A28DDCDBEA13E87B" \
       "1F874BC8DC06AF03F219CE2EA4050FA996D30CE351257287" 

N = long(NStr, 16)
f2 = 476

fmin = N / float(f2)

print N - (fmin * float(f2)) 
```

这`0.0`按预期输出。但是，例如，如果我将代码更改为

```
fmin = N / float(f2)
fmin += 1 
```

我仍然得到输出`0.0`

我也尝试使用十进制包

```
fmin = Decimal(N) / Decimal(f2)
print Decimal(N) - (fmin * Decimal(f2)) 
```

但这给了我一个输出`-1.481136900397802034028076389E+280`

我假设我没有告诉 python 如何正确处理大量数字，但我不知道从哪里开始。

我还应该补充一点，最终目标是计算

```
fmin = ceil(N / float(f2)) 
```

尽可能长且准确

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T11:07:27.043

扩展我的评论，如果和`N`s严格大于 0，那么`f2``long`

```
 fmin = (N - 1) // f2 + 1 
```

完全正确`ceil(N / float(f2))`（但比使用浮点数更准确）。

（使用`//`而不是`/`整数除法是为了与 Python 3.x 兼容，无需额外的努力。）

这是因为`N // f2`给你（基本上）`floor(N / float(f2))`，所以`N // f2 + 1`几乎总是和`ceil`. 但是，when`N`是 , 的倍数`f2`太大`N // f2 + 1`（`+1`不应该存在），但使用可以`N - 1`解决此问题，并且不会破坏另一种情况。

（这对任何一个都不起作用`N`，`f2`小于或等于0，但可以单独处理）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-12T10:43:43.123

`fmin`是`float`在您将长整数除以浮点数之后。它的值为`1.84952718165824e+305`。加1根本不会改变它，精度根本不高。

如果您改为进行整数除法，则`fmin`仍然是`long`：

```
>>> fmin = N / f2
>>> fmin
18495271816582402193321106509793602189617847415669131056768139225220221855498293
49983070478076000952025038039460539798061570960870927236986153971731443029057201
52035339202255934728764897424408896865977423536890485615063959262845076766281553
766072964756078264853041334880929452289298495368916583660903481130L
>>> N - (fmin * f2)
111L 
```

当然，您不会`0`因为整数除法而丢弃结果的小数部分。但现在，加 1*会*有所不同：

```
>>> N - ((fmin+1) * f2)
-365L 
```

使用该`Decimal`模块不会改变问题：

```
>>> from decimal import Decimal, getcontext
>>> fmin = Decimal(N) / Decimal(f2)
>>> fmin
Decimal('1.849527181658240219332110651E+305') 
```

仍然没有无限的精度，即使你设置`Decimal.getcontext().prec = 2000`了，你仍然不会得到精确的 0。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-12T11:28:18.827

如果您需要精度，请完全避免浮点运算。由于 python 具有任意精度整数，您可以使用基本整数算术计算除法的上限。假设除数和除数都是正数，这样做的方法是在除法之前将除数 - 1 添加到除数。在你的情况下：

```
fmin = (N + f2 - 1) / f2 
```

在 Python 3.x 上，使用`//`运算符而不是`/`获取整数除法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-12T11:06:05.873

`Fraction`来自[`fractions`](http://docs.python.org/library/fractions.html)模块可能有用：

```
>  : N = Fraction(N)   
>  : f2 = Fraction(f2)
>  : fmin = N / f2
>  : print N-f2*fmin
0
>  : fmin += 1
>  : print N-f2*fmin
-476 
```

但是，如果您的唯一目标是计算`ceil(N / float(f2))`，您可以使用：

```
>  : fmin = N/f2 + int(ceil((N % f2) / float(f2)))
>  : print fmin
184952718165824021933211065097936021896178474156691310567681392252202218554982934998307047807600095202503803946053979806157096087092723698615397173144302905720152035339202255934728764897424408896865977423536890485615063959262845076766281553766072964756078264853041334880929452289298495368916583660903481131 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-12T10:50:32.557

对于这种操作，浮点数根本没有足够的精度。

您可以使用 提高`decimal`模块的精度`getcontext()`。例如使用 65536 位小数：

```
from decimal import Decimal, getcontext
getcontext().prec = 2**16 
```

然后：

```
>>> print Decimal(N) - (fmin * Decimal(f2))
-2E-65228 
```

仍然不是 0 而是更接近 :)

请参阅[此答案](https://stackoverflow.com/a/2796005/17911)以`ceil()`对`Decimal`对象执行操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-12T10:52:52.540

我还在 python 2.7.2 中发现了类似的行为：

```
In [17]: N
Out[17]: 8803749384693223444020846698661754642258095369858506383021634271204825603217187705919415475641764531639181067832169438773077773745613648054092905441668
8183122792368821460273824930892091174018634908205253603559871152770444609114256540750019592650731223893254070047675403322419289706083795604293822590057017991L

In [18]:

In [18]: (fmin * float(f2))
Out[18]: 8.803749384693223e+307
In [19]: N - (fmin * float(f2))
Out[19]: 0.0

In [20]: (fmin * float(f2))
Out[20]: 8.803749384693223e+307

In [21]: N == (fmin * float(f2))
Out[21]: False

In [22]: N < (fmin * float(f2))
Out[22]: False

In [23]: N > (fmin * float(f2))
Out[23]: True 
```

由于我不明白的原因，似乎从 long 中减去 float 会产生 0。

解决方案似乎是将两者都转换为`decimal.Decimal`：

```
In [32]: decimal.Decimal(N) - decimal.Decimal(fmin * float(f2))
Out[32]: Decimal('4.099850360284731589507226352E+291') 
```

# python - 如何使用 python 在本地显示带有 html-forms 的网站并收集用户输入？

> ID：10121864
> 
> 赞同：3
> 
> 时间：2012-04-12T10:34:53.450
> 
> 标签：python, user-input, forms

我是一名行为科学家，通常通过让参与者在计算机上完成一些任务并记录他们的反应来收集数据（我使用 pyglet 包装器[PsychoPy](http://www.psychopy.org/)编写程序）。即程序在本地运行，数据在本地存储。

现在我想知道是否有一种方法可以使用 Python 向用户显示带有 html-forms 的（本地）网站并收集（本地）输入。这个想法的原因是，目前每当我想显示复选框、单选按钮或输入字段时，我都会使用 wxPython。这工作得很好，但是在 wxPython 中编程和布局有点麻烦，我更喜欢带有表单的 html。

一个要求是它需要朗姆酒，没有任何边框，地址字段，菜单栏，......原因是我需要它以全屏模式（我目前打开一个非全屏pygflet窗口的大小屏幕以隐藏桌面），以便参与者只能在表格上工作。

**因此，我正在寻找一种方法来（a）在没有菜单栏或其他任何内容的 pyglet 窗口上方显示 html 网站，包括 html 表单，（b）在单击“确定”按钮时收集输入（即，表单已发送），（ c) 控制查看本网站之前和之后显示的内容，以及 (d) 这一切都应该在本地发生！**

我的想法是当参与者点击以下示例图片中的“发送”按钮并显示下一页时收集数据。

![示例表格](../Images/1f2330f8a7aa33cfd0818f7fb005bf23.png)

**更新：**我使用 Windows（XP 或 7）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T22:08:33.460

这是一个使用 Qt Webkit 渲染 HTML 的解决方案。默认导航请求处理程序由检查提交的表单请求的函数包装。该表单使用“get”方法，因此数据包含在请求的 url 中，并且可以通过这种方式检索。原始请求被拒绝，您可以根据需要更改显示网页的内容。

```
from PyQt4 import QtGui, QtWebKit

app = QtGui.QApplication([])
view = QtWebKit.QWebView()

# intercept form submits
class MyWebPage(QtWebKit.QWebPage):
    def acceptNavigationRequest(self, frame, req, nav_type):
        if nav_type == QtWebKit.QWebPage.NavigationTypeFormSubmitted:
            text = "<br/>\n".join(["%s: %s" % pair for pair in req.url().queryItems()])
            view.setHtml(text)
            return False
        else:
            return super(MyWebPage, self).acceptNavigationRequest(frame, req, nav_type)
view.setPage(MyWebPage())

# setup the html form
html = """
<form action="" method="get">
Like it?
<input type="radio" name="like" value="yes"/> Yes
<input type="radio" name="like" value="no" /> No
<br/><input type="text" name="text" value="Hello" />
<input type="submit" name="submit" value="Send"/>
</form>
"""
view.setHtml(html)

# run the application
view.show()
app.exec_() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T09:04:21.723

正如 AdamKG 所提到的，使用网络框架将是一个不错的选择。由于 Django 和类似的东西在这里可能有点过分，所以使用像“ [flask](http://flask.pocoo.org) ”或“ [bottle](http://bottlepy.org) ”这样的微型网络框架将是一个不错的选择。

此[链接](http://bottlepy.org/docs/dev/tutorial_app.html)通过分步说明演示如何通过待办事项应用程序制作简单的表单。它假设先前的知识为零。

您也只能在本地运行它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T11:54:57.810

您想要一个简单的解决方案，所以只需编写一个 http 服务器并运行您的简单页面。

使用**python.BaseHTTPServer**，编写一个**15 行**的Web 服务器：

```
import BaseHTTPServer

class WebRequestHandler(BaseHTTPServer.BaseHTTPRequestHandler):
    def do_GET(self):
        if self.path == '/foo':
            self.send_response(200)
            self.do_something()
        else: 
            self.send_error(404)

    def do_something(self):
        print 'hello world'

server = BaseHTTPServer.HTTPServer(('',80), WebRequestHandler)
server.serve_forever() 
```

很简单，但我建议使用一些网络框架。他们也很容易。

例如，[**web.py**](http://webpy.org/src/todo-list/0.3)。这是你想要的**50 行代码**：

1.  [安装 web.py](http://webpy.org/install)
2.  创建一个包含 2 个文件的目录：

    > ```
    > ./
    > |-- app.py
    > `-- templates
    >     `-- index.html 
    > ```

3.  索引.html

    > $def with (form, ret)
    > 
    > ```
    > <html>
    > <head>
    >                 <title> another site </title>
    > </head>
    > <body>
    >         <h1> hello, this is a web.py page </h1>
    > 
    >         <form action="" method="post">
    >                 $:form.render()
    >         </form>
    > 
    >         <h2>$:ret</h2>
    > 
    > </body>
    > </html> 
    > ```

4.  app.py 逻辑文件：

    > ```
    > import web
    > 
    > ### Url mappings
    > 
    > urls = (
    >      '/', 'Index', )
    > 
    > ### Templates 
    > render = web.template.render('templates')
    > 
    > class Index:
    >     form = web.form.Form(
    >         web.form.Textbox('fav_name', web.form.notnull, description="Favorite Name:"),
    >         web.form.Textbox('cur_name', web.form.notnull, description="Current Name:"),
    >         web.form.Button('Send Away'),
    >     )
    > 
    >     def GET(self):
    >         """ Show page """
    >         form = self.form()
    >         return render.index(form, "")
    > 
    >     def POST(self):
    >         """ handle button clicked """
    >         form = self.form()
    >         if not form.validates():
    >             return render.index(form, "INPUT ERROR")
    > 
    >         # save data by ur method, or do some task
    >         #pyglet.save_data(form.d.fav_name, form.d.cur_name)
    >         #pyglet.draw(some_pic)
    >         #os.system(some_cmd)
    > 
    >         form = self.form()
    >         return render.index(form, "YOUR DATA SAVED")
    > 
    > app = web.application(urls, globals())
    > 
    > if __name__ == '__main__':
    >     app.run() 
    > ```

5.  在您的 Windows 中运行此服务器：

    > 蟒蛇应用程序.py 9999

6.  打开浏览器：http: [//127.0.0.1 :9999/](http://127.0.0.1:9999/)

顺便说一句，如果你的数据只是字符串，你可以通过 sqlite 将它们保存在 web.by 中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T07:10:30.110

> 这个想法的原因是，目前每当我想显示复选框、单选按钮或输入字段时，我都会使用 wxPython。这工作得很好，但是在 wxPython 中编程和布局有点麻烦，我更喜欢带有表单的 html。

您可以结合 HTML 的易用性，并仍然使用带有 Python 后端的[Flex](http://www.adobe.com/products/flex.html)创建本机 Windows 应用程序。

如果您不喜欢 Flex，那就多一点 - 涉及 - 但仍然是原生 Windows 应用程序生成器是[Camelot](http://www.python-camelot.com/)

### 编辑

而不是再次输入它 - 我建议 Adob​​e 上的[django + flex + pyamf](http://www.adobe.com/devnet/flex/articles/flex_django.html)文章也用屏幕截图解释了这一切。您可以用 flask 或 bottle 替换 django，因为它们更轻量级，但是 PyAMF 库为 django 提供本机支持，这就是在示例中使用它的原因。

*PyAMF 为 Python 提供[Action Message Format](http://en.wikipedia.org/wiki/Action_Message_Format)（与 Flash 运行时交换对象的二进制协议）支持。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-14T15:10:07.337

我的建议是：

1.  使用一些 python 服务器，例如`SimpleHTTPServer`. 它是必需的，因为表单上的提交按钮将信息发送到服务器。在那里你应该以某种方式管理收到的信息；
2.  将您的浏览器配置为使用其中一种 Kiosk 扩展，这甚至不允许使用 Alt+F4。一个例子是Firefox 的[Open Kiosk](https://addons.mozilla.org/en-US/firefox/addon/open-kiosk/)扩展
3.  或者，如果您通常与脚本有密切关系，您可以创建一个脚本，该脚本在执行时将同时运行 python 服务器并在浏览器中打开您的 html 文件。这将大大减轻您对小组中每个主题的设置工作。

编辑：我读过你需要浏览器窗口上的 pyglet。这可以包含在步骤 3 的脚本中，使用“始终在顶部”选项和 pyglet 的绝对定位（我可以说这在 Linux 上可能会更简单，可以从持久 LiveUSB 运行 - 只是一个想法！）

编辑（关于发布的评论）：我认为最可靠的输出选项是磁盘（文件或数据库）而不是 RAM（运行 python 对象），然后你从文件中读取信息。然后，如果发生意外（系统挂起、电源故障），已经输入的数据会在那里。

我不知道如何做的唯一（也是最重要的）部分是在服务器端处理表单“提交”的内容。可能应该创建一些服务器端脚本文件（php，python）并将其保留在服务器根目录中，因此服务器将接收包含信息的 http 请求，并将信息发送到脚本，然后处理处理和文件/数据库存储活动。

这可能会引起您的兴趣：“当客户端需要将数据作为请求的一部分发送到服务器时，例如在上传文件或提交完整的表单时，使用 POST 请求方法。” （来自维基百科的“POST（HTTP）”条目）

在另一个链接中，关于使用`SimpleHTTPServer`自身处理 POST 请求的一些想法：http: [//islascruz.org/html/index.php/blog/show/Python%3A-Simple-HTTP-Server-on-python..html](http://islascruz.org/html/index.php/blog/show/Python%3A-Simple-HTTP-Server-on-python..html)

希望这可以帮助。

# wordpress - 重定向到自定义 Wordpress 登录页面 - 但仍有忘记密码链接

> ID：10121865
> 
> 赞同：1
> 
> 时间：2012-04-12T10:34:54.793
> 
> 标签：wordpress

我使用在[将 Wordpress 的登录/注册页面重定向到自定义登录/注册页面中](https://stackoverflow.com/questions/1976781/redirecting-wordpresss-login-register-page-to-a-custom-login-registration-page)找到的代码- 按照帖子标题所说的那样做......

但是，现在当用户登陆我的自定义登录页面但忘记了他们的密码时，我无法包含“恢复密码”链接......

我可以看到这是因为“wp-login.php?action=lostpassword”以“wp-login.php”开头，所以忘记密码链接只是被重定向到自定义登录页面......但不知道该怎么做做它...

任何人都可以建议一种方法吗？还是另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T17:47:17.240

您好，请使用它而不是您在之前的答案中得到的。

1-将其放入您的主题的功能文件中

```
add_filter('site_url',  'wplogin_filter', 10, 3);
function wplogin_filter( $url, $path, $orig_scheme )
{
$old  = array( "/(wp-login\.php)/");
$new  = array( "account/"); //this can be change to login or whatever or may remain there
return preg_replace( $old, $new, $url, 1); 
```

2- 使用 .htaccess 重定向：在 RewriteBase / 之后添加一个新规则，在你的 .htaccess 中推送这个----> RewriteRule ^account$ wp-login.php

注意：请注意，帐户术语在您的函数片段和 .htaccess 中，并且会出现在您的永久链接中，而不是 wp-login.php。因此，您的 url 将与上面的 register/lgin/lostpassword 操作代码类似：

www.yoursite.com/account/?action= 注册

www.yoursite.com/account/?action=登录

www.yoursite.com/account/?action= lostpassword

希望它对我的英语有所帮助和抱歉，我的法语更好；）

# ios - 在 didFinishSavingWithError 之后如何关闭图像选择器？

> ID：10121866
> 
> 赞同：2
> 
> 时间：2012-04-12T10:34:57.197
> 
> 标签：ios, uiimagepickercontroller

我想要做的就是在警报显示图片已保存或未保存之后，选择器应该被解雇，但我无法找出如何。

我这样呈现图像控件：

```
[self presentModalViewController:imagePicker animated:YES]; 
```

我知道我需要关闭modalviewcontroller，因为我是为取消案例做的，但我不知道在哪里放置它，以便在图像保存后它存在。

```
- (void) imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
    {
        UIImage *image = [info objectForKey:@"UIImagePickerControllerOriginalImage"];

        UIImageWriteToSavedPhotosAlbum(image, self, @selector(image:didFinishSavingWithError:contextInfo:), nil);
    }

- (void)image:(UIImage *)image didFinishSavingWithError:(NSError *)error contextInfo:(void *)contextInfo
{
    UIAlertView *alert;

    // Unable to save the image  
    if (error)
        alert = [[UIAlertView alloc] initWithTitle:@"Error" 
                                           message:@"Unable to save image to Photo Album." 
                                          delegate:self cancelButtonTitle:@"Ok" 
                                 otherButtonTitles:nil];
    else // All is well
        alert = [[UIAlertView alloc] initWithTitle:@"Success" 
                                           message:@"Image saved to Photo Album." 
                                          delegate:self cancelButtonTitle:@"Ok" 
                                 otherButtonTitles:nil];
    [alert show];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:04:03.810

您必须在本地和 alertview 委托方法中创建 UIImagePickerController 的实例，只需将其关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:59:44.597

如果您使用过 peserntmodelviewcontrolleranimated: 那么使用`dismissModalViewControllerAnimated:`

# unit-testing - 将编码控件添加到 UIMap（编码 UI 测试）

> ID：10121867
> 
> 赞同：0
> 
> 时间：2012-04-12T10:34:57.540
> 
> 标签：unit-testing, mstest, coded-ui-tests, handwriting

我想在我的 UIMap.cs（不是 UIMap.Designer.cs）中添加一个手写的编码控件。

例如，当我录制：时`writing in a texBox`，我在 UIMap.Designer.cs 中得到以下代码：

```
public class Recorded_Writing_In_forRecordParams
{
    public string UIForRecordEditText = "forRecord";
}

public class UIMainWindowWindow : WpfWindow
{
    public UIMainWindowWindow()
    {
        this.SearchProperties[WpfWindow.PropertyNames.Name] = "MainWindow";
        this.SearchProperties.Add(new PropertyExpression(WpfWindow.PropertyNames.ClassName, "HwndWrapper", PropertyExpressionOperator.Contains));
        this.WindowTitles.Add("MainWindow");
    }

    public WpfEdit UIForRecordEdit
    {
        get
        {
            if ((this.mUIForRecordEdit == null))
            {
                this.mUIForRecordEdit = new WpfEdit(this);
                this.mUIForRecordEdit.SearchProperties[WpfEdit.PropertyNames.AutomationId] = "forRecord";
                this.mUIForRecordEdit.WindowTitles.Add("MainWindow");
            }

            return this.mUIForRecordEdit;
        }
    }

    private WpfEdit mUIForRecordEdit;
} 
```

我想在我的`CodedUITest`. 有没有办法`TextBox`在`UIMap.cs`自己的编码中搜索或在我的中搜索`TestMethod`？哪个是最好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T08:49:00.900

感谢您的回答，但我通过以下方式自行解决了我的问题：

**UIMap.cs**

```
public partial class TestLittleAppUIMap
{
    private MyWindow mMyWindow;
    public MyWindow MMyWindow
    {
        get
        {
            if (this.mMyWindow == null)
            {
                this.mMyWindow = new MyWindow();
            }
            return this.mMyWindow;
        }
    }
}

public class MyWindow : WpfWindow
{ 
    private WpfEdit mWpfEdit;

    public MyWindow()
    {
        this.SearchProperties[WpfWindow.PropertyNames.Name] = "MainWindow";
        this.SearchProperties.Add(new PropertyExpression(WpfWindow.PropertyNames.ClassName, "HwndWrapper", PropertyExpressionOperator.Contains));
        this.WindowTitles.Add("MainWindow");
    }

    public WpfEdit MWpfEdit
    {
        get
        {
            if ((this.mWpfEdit == null))
            {
                this.mWpfEdit = new WpfEdit(this);
                #region Search Criteria
                this.mWpfEdit.SearchProperties[WpfEdit.PropertyNames.AutomationId] = "forOwn";
                this.mWpfEdit.WindowTitles.Add("MainWindow");
                #endregion
            }
            return this.mWpfEdit;
        }
    } 
```

**CodedUI 测试**

```
[TestMethod]
public void TestLittleAppOwnMap()
{
    this.UIMap.MMyWindow.MWpfEdit.DrawHighlight();
    Playback.Wait(2500);
} 
```

它几乎是设计师类的副本。

要直接在中搜索，`TestMethod`您可以这样：

```
[TestMethod]
public void TestLittleAppOwn()
{
    WpfWindow w = new WpfWindow();
    w.SearchProperties[WpfWindow.PropertyNames.Name] = "MainWindow";
    w.SearchProperties.Add(new PropertyExpression(WpfWindow.PropertyNames.ClassName, "HwndWrapper", PropertyExpressionOperator.Contains));
    w.DrawHighlight();

    WpfEdit e = new WpfEdit(w);
    e.SearchProperties[WpfEdit.PropertyNames.AutomationId] = "forOwn";
    e.SetProperty("Text","myText");
    e.DrawHighlight();
    Playback.Wait(2500);
} 
```

只需`Playback.Wait`稍等片刻即可显示亮点。

# html - 在 Handlebars/Blaze #each 循环中访问集合索引

> ID：10121870
> 
> 赞同：3
> 
> 时间：2012-04-12T10:35:10.533
> 
> 标签：html, meteor, meteor-blaze

我在搞乱流星排行榜的例子。假设我想在把手#each 循环中显示项目的索引：

```
{{#each players}}
  {{> player}}
{{/each}}

<template name="player">
  <div class="player {{selected}}">
    <span class="index">{{index}}</span>
    <span class="name">{{name}}</span>
    <span class="score">{{score}}</span>
  </div>
</template> 
```

通常人们会为此编写一个车把助手，但我无法弄清楚如何让它与 Meteor 集合一起使用。

如何做到这一点？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-02-28T18:01:13.193

Blaze 现在有一个@index 功能：

```
{{#each players}}
  {{> player index=@index}}
{{/each}}

<template name="player">
  <div class="player {{selected}}">
    <span class="index">{{index}}</span>
    <span class="name">{{name}}</span>
    <span class="score">{{score}}</span>
  </div>
</template>

Template.player.helpers({
  index() {
    var data = Template.currentData();
    if( data ) {
      return data.index;
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T10:44:12.253

为这个问题添加一个答案。我不得不花几个小时弄清楚

在您的客户中

`Template.player.data = function(data){`

`if(type){`

`return Template[ 'player' ](data);`

`}`

`}`

在您的模板中

`{{#each players}}`

`{{data this}}`

`{{/each}}`

这将无缝工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-13T05:03:03.330

这就是我解决这个问题的方法——不是一个完美的解决方案——通过使用 Mongo 通常创建增加价值的索引这一事实。

```
Template.item.index = function() {
    return Items.find().count() - Items.find({_id: {$lte: this._id}}).count() + 1
} 
```

然后我在模板中使用它，如下所示：{{index}}

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-16T00:59:36.493

如果您只是想显示 mongo 生成的 id，只需使用 _id

```
 <span class="id">{{_id}}</span> 
```

它将显示集合中的唯一索引 ID。不会很漂亮

我可能误解了你的问题。对不起，如果我这样做了。

# android - 无法实例化活动 ComponentInfo

> ID：10121872
> 
> 赞同：0
> 
> 时间：2012-04-12T10:35:15.700
> 
> 标签：android

当我尝试在自己的 android 应用程序中集成 andengine.jar 和 e3roid.jar 时，我总是面临这个错误。请帮我。

```
04-12 15:53:13.667: E/AndroidRuntime(1263): FATAL EXCEPTION: main
04-12 15:53:13.667: E/AndroidRuntime(1263): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.e3roid.examples/com.e3roid.examples.SplashScreenActivity}: java.lang.ClassNotFoundException: com.e3roid.examples.SplashScreenActivity in loader dalvik.system.PathClassLoader[/data/app/com.e3roid.examples-1.apk]
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1660)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1752)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.app.ActivityThread.access$1500(ActivityThread.java:123)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:993)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.os.Looper.loop(Looper.java:126)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.app.ActivityThread.main(ActivityThread.java:3997)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at java.lang.reflect.Method.invokeNative(Native Method)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at java.lang.reflect.Method.invoke(Method.java:491)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at dalvik.system.NativeStart.main(Native Method)
04-12 15:53:13.667: E/AndroidRuntime(1263): Caused by: java.lang.ClassNotFoundException: com.e3roid.examples.SplashScreenActivity in loader dalvik.system.PathClassLoader[/data/app/com.e3roid.examples-1.apk]
04-12 15:53:13.667: E/AndroidRuntime(1263):     at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:251)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at java.lang.ClassLoader.loadClass(ClassLoader.java:548)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at java.lang.ClassLoader.loadClass(ClassLoader.java:508)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.app.Instrumentation.newActivity(Instrumentation.java:1022)
04-12 15:53:13.667: E/AndroidRuntime(1263):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651)
04-12 15:53:13.667: E/AndroidRuntime(1263):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T16:50:14.263

您的错误特定于 e3roid。

检查项目 E3roidExamples 的“订购和导出”。

Java 构建路径 --> 排序和导出。

**e3roid.jar 可能是“未选中”**

请检查并在设备上再次运行。

它应该工作:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:46:00.120

当您未在清单文件中使用正确名称声明活动时，会出现此问题。但有时它只是因为您的 java 文件没有落入您正在引用的正确包中。

只需查看您的启动屏幕包名称并删除一次并检查它是否给出任何错误..如果没有，那么问题就是因为那个）...再次放置它并清理项目并运行...

而且你的闪屏类也应该是公开的

# c# - C# Trackbar 自定义颜色

> ID：10121873
> 
> 赞同：2
> 
> 时间：2012-04-12T10:35:19.583
> 
> 标签：c#, winforms, custom-controls

这可能是一个非常全球性的问题，但我们开始吧：

我想知道如何制作像 Virtualbox 这样的轨迹栏。他们有一个底部有自定义颜色的轨迹栏，以显示您是否为虚拟系统分配了过多的 RAM。
现在我的问题是：如何给我的轨迹栏自定义颜色？
我已经阅读了有关 e.graphics 等并覆盖其他功能的内容，但我似乎找不到任何关于此的信息）：。

如果您知道我的意思，并且有好的教程和/或示例的资源，那就太棒了！因为我真的不知道去哪里找了:(。

我正在用 C#、WinForms 编程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T14:56:55.230

正如[Hans 提到](https://stackoverflow.com/a/3752781/884410)的，标准的轨迹栏非常有限。您可以通过属性更改[背景颜色。](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.backcolor.aspx)`TrackBar.BackColor`否则，您将不得不创建一个自定义控件并覆盖 OnPaint 方法：

```
partial class MyTrackBar : System.Windows.Forms.TrackBar
{       
    protected override void  OnPaint(System.Windows.Forms.PaintEventArgs e)
    {
        e.Graphics.FillRectangle([Brush color], ClientRectangle);
    }
} 
```

第三种选择是使用已经创建的轨迹栏。像[免费的 CodeProject trackbar](http://www.codeproject.com/Articles/14378/Advanced-TrackBar-Slider-Control-with-MAC-Style-C)或[商业的 Devexpress](http://www.devexpress.com/Products/NET/Controls/WinForms/Editors/Editors/RangeTrackBarControl.xml)之一。

# iphone - Twitter用户/搜索问题

> ID：10121874
> 
> 赞同：0
> 
> 时间：2012-04-12T10:35:24.543
> 
> 标签：iphone, ios, xcode, ipad, twitter

我正在尝试使用以下网址通过新的 iOS Twitter 框架搜索用户.. [https://api.twitter.com/1/users/search.json?q=%@&page=2&per_page=20](https://api.twitter.com/1/users/search.json?q=%@&page=2&per_page=20)

该 api 说每页最多搜索 20 人.. [https://dev.twitter.com/docs/api/1/get/users/search](https://dev.twitter.com/docs/api/1/get/users/search)

所以我设置 page=2 来获取 40 人，但它仍然获取 20 人。

这是 twitter 框架中的错误还是我必须做的其他事情..

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T10:42:22.027

No matter what query you run, you'll get 20 people back. The reason to set `page` is so that you can page through the results.

`page=1&per_page=20` returns the first 20 people.`page=2&per_page=20` returns the next 20 people. And so on.

# asp.net - 在线程内调用存储过程以更新多条记录

> ID：10121876
> 
> 赞同：3
> 
> 时间：2012-04-12T10:35:34.640
> 
> 标签：asp.net, multithreading, parallel-processing, task-parallel-library, procedure

我正在尝试为各种唯一实体调用存储过程。单个实体的存储过程大约需要 33 秒。所以我决定用线程来调用它。

以下是我做过的一些试验：

```
public bool ExecuteTaxRateLinkingParallel(int mapID, int createdBy)
{
    try
    {
        int snapshotID = (int)(HttpContext.Current.Session[GlobalConstant.snapShotID]);
        List<TaxEntity> taxEntities = new List<TaxEntity>();
        List<Task> tasks = new List<Task>();
        using (var ctx = new TopazDbContainer())
        {
            taxEntities = ctx.TaxEntities.AsParallel().Where(t => t.IsActive == true).ToList<TaxEntity>();
        }

        Parallel.ForEach<TaxEntity>(taxEntities, (entity) =>
        {
            //SqlConnection connection; SqlTransaction trans; SqlCommand command;
            // break this into pieces of 5
            var task = Task.Factory.StartNew(() =>
            {
                using (var pctx = new TopazDbContainer())
                {
                    try
                    {
                        int taxEntityID = entity.TaxEntityID;
                        pctx.CommandTimeout = 5000;
                        //string connectionString = System.Configuration.ConfigurationManager.ConnectionStrings["TOPAZDBConnectionStringParallel"].ConnectionString;
                        //connection = new SqlConnection(connectionString);
                        //command = new SqlCommand("dbo.[Usp_TaxRatesLinkingParallel]", connection);
                        //trans = connection.BeginTransaction();
                        //command.CommandType = CommandType.StoredProcedure;
                        //command.Parameters.AddWithValue("@MapID", mapID);
                        //command.Parameters.AddWithValue("@UserID", createdBy);
                        //command.Parameters.AddWithValue("@TaxEntityID", taxEntityID);
                        //command.Parameters.AddWithValue("@SnapshotID", snapshotID);
                        //connection.Open();
                        //command.CommandTimeout = 5000;
                        //command.ExecuteReader().AsParallel();

                        pctx.ContextOptions.LazyLoadingEnabled = true;

                        //pctx.ExecuteStoreCommand("Exec [Usp_TaxRatesLinkingParallel] @MapID={0},@UserID={1},@TaxEntityID={2},@SnapshotID{3}", new SqlParameter("MapID", mapID), new SqlParameter("UserID", createdBy), new SqlParameter("TaxEntityID", taxEntityID), new SqlParameter("SnapshotID", snapshotID));
                        var param = new DbParameter[] { new SqlParameter("UserID", createdBy), new SqlParameter("TaxEntityID", taxEntityID), new SqlParameter("SnapshotID", snapshotID) };
                        pctx.ExecuteStoreCommand("Exec [Usp_TaxRatesLinkingParallel] @MapID,@UserID,@TaxEntityID,@SnapshotID", param);

                        //var result = output.FirstOrDefault();
                    }
                    catch (TaskCanceledException tx)
                    {
                    }
                    catch (Exception e)
                    {
                    }
                    finally
                    {
                        pctx.SaveChanges();
                        pctx.Connection.Close();
                    }
                }
            }, TaskCreationOptions.PreferFairness);

            tasks.Add(task);

            try
            {
                Task.WaitAll(tasks.ToArray());
            }
            catch (AggregateException ae)
            {
                ae.Handle((x) =>
                {
                    if (x is UnauthorizedAccessException)
                    {
                        return true;
                    }
                    else
                    {
                        return false;
                    }
                });
            }
            catch (Exception ex)
            {
                throw ex;
            }
        });

        return true;
    }
    catch (Exception ex)
    {
        TopazErrorLogs.AddTopazErrorLogBL(ex, 1, 1);
        throw new TopazCustomException(GlobalConstant.errorMessage);
    }
} 
```

对于上述某些语句，SP 似乎运行良好，但是当我从应用程序或后端检查时，记录没有得到更新。

需要帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T14:56:50.193

如果您还没有使用 .NET 4.5，您可以使用这些扩展方法来异步执行您的命令。

```
using System.Diagnostics.Contracts;
using System.Threading.Tasks;
using System.Xml;

namespace System.Data.SqlClient
{
    public static class SqlCommandExtensions
    {
        public static Task<SqlDataReader> ExecuteReaderAsync(this SqlCommand command)
        {
            Contract.Requires(command != null);
            return ExecuteReaderAsync(command, null);
        }

        public static Task<SqlDataReader> ExecuteReaderAsync(this SqlCommand command, object state)
        {
            Contract.Requires(command != null);
            return Task.Factory.FromAsync<SqlDataReader>(command.BeginExecuteReader, command.EndExecuteReader, state);
        }

        public static Task<XmlReader> ExecuteReaderXmlAsync(this SqlCommand command)
        {
            Contract.Requires(command != null);
            return ExecuteReaderXmlAsync(command, null);
        }

        public static Task<XmlReader> ExecuteReaderXmlAsync(this SqlCommand command, object state)
        {
            Contract.Requires(command != null);
            return Task.Factory.FromAsync<XmlReader>(command.BeginExecuteXmlReader, command.EndExecuteXmlReader, state);
        }

        public static Task<int> ExecuteNonQueryAsync(this SqlCommand command)
        {
            Contract.Requires(command != null);
            return ExecuteNonQueryAsync(command, null);
        }

        public static Task<int> ExecuteNonQueryAsync(this SqlCommand command, object state)
        {
            Contract.Requires(command != null);
            return Task.Factory.FromAsync<int>(command.BeginExecuteNonQuery, command.EndExecuteNonQuery, state);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-13T14:12:05.147

您在此处执行的不是异步数据库查询。请看一看：

[ASP.NET MVC 4 中使用基于任务的异步编程模型 (TAP) 的异步数据库调用](http://www.tugberkugurlu.com/archive/asynchronous-database-calls-with-task-based-asynchronous-programming-model-tap-in-asp-net-mvc-4)

下面是一个带有新的 async / await 特性的异步数据库调用示例：

```
public async Task<IEnumerable<Car>> GetCarsAsync() {

    var connectionString = 
        ConfigurationManager.ConnectionStrings["CarGalleryConnStr"].ConnectionString;

    var asyncConnectionString = new SqlConnectionStringBuilder(connectionString) {
        AsynchronousProcessing = true
    }.ToString();

    using (var conn = new SqlConnection(asyncConnectionString)) {
        using (var cmd = new SqlCommand()) {

            cmd.Connection = conn;
            cmd.CommandText = selectStatement;
            cmd.CommandType = CommandType.Text;

            conn.Open();

            using (var reader = await cmd.ExecuteReaderAsync()) {

                return reader.Select(r => carBuilder(r)).ToList();
            }
        }
    }
} 
```

您可以在博文中找到详细信息。

# java - 使用所有请求参数将请求从一个jsp转发到另一个jsp？

> ID：10121877
> 
> 赞同：3
> 
> 时间：2012-04-12T10:35:35.423
> 
> 标签：java, jsp, web-applications

我有这种情况。用户在浏览器中的 jsp 表单上输入一些内容并提交。在 servlet 中，我处理请求并将 jsp page1 显示给只有继续按钮的客户端。现在单击继续，我想将此请求转发到另一个 jsp page2，所有请求参数都出现在 page1 上。基本上我还想获取第 2 页第一个请求中存在的所有请求参数？我不明白我应该怎么做？根据我的理解，我认为我不能使用 jsp 转发，只有当我们想要从 jsp（在服务器端）而不是在客户端转发时，它才会起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T10:41:32.610

There are two ways to implement that:

*   output all parameters in hidden fields, and submit them in the 2nd request
*   store everything in the session

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:42:06.583

Following are a pair of ways to achieve this

1.  Put the information in session object in first request and access it from session object in second.

2.  On the intermediate page displayed, have hidden form elements which will carry the values and send it back on continuing.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-21T00:35:20.993

您可以使用 Servlet Forward 将所有请求参数传递给另一个 JSP 或 Servlet：

```
getServletContext().getRequestDispatcher("/yourJSP.jsp").forward(request, response); 
```

Servlet forward 会将已有的请求转发给另一个 JSP 或 Servlet，因此所有的请求参数和属性都会对目标 JSP 或 Servlet 可用（可以使用 Servlet forward 的原因是 JSP 翻译后也是一个 Servlet）。

您可能会发现以下资源很有用：

[将数据从 servlet 传递到 jsp](https://www.programmergate.com/pass-data-servlet-jsp/)

[Servlet 重定向与转发](http://www.mysamplecode.com/2011/06/java-servlet-redirect-vs-forward.html)

# php - 在用户的世界地图上显示地理位置

> ID：10121879
> 
> 赞同：1
> 
> 时间：2012-04-12T10:35:38.633
> 
> 标签：php, gd, geo

我正在尝试制作一个简单的脚本，它以 lon/lat 作为参数并在单词图图像上放置一个点，简单。

```
<?php

if(empty($long))$long = 56.946536;
if(empty($lat)) $lat = 24.10485;

$im = imagecreatefromjpeg("earth_310.jpg");
$red = imagecolorallocate ($im, 255,0,0);

$scale_x = imagesx($im);
$scale_y = imagesy($im); 

$pt = getlocationcoords($lat, $long, $scale_x, $scale_y);

imagefilledrectangle($im,$pt["x"]-2,$pt["y"]-2,$pt["x"]+2,$pt["y"]+2,$red);

header("Content-Type: image/png");
imagepng($im);
imagedestroy($im);

function getlocationcoords($lat, $lon, $width, $height)
{  
   $x = (($lon + 180) * ($width / 360));
   $y = ((($lat * -1) + 90) * ($height / 180));
   return array("x"=>round($x),"y"=>round($y));
}
?> 
```

请注意，我使用的是以下坐标“56.946536, 24.10485”。如果您将它们粘贴到谷歌地图中，​​它会显示“拉脱维亚里加”，因此坐标似乎是正确的。

现在这是脚本的结果：

![在此处输入图像描述](../Images/3164014a41c8871ca41f3a78ba3ece8b.png)

完全关闭，显示非洲附近某处的点。

看来*getlocationcoords*计算坐标错误。有什么建议可以解决这个问题吗？谢谢！

节点：我不能使用谷歌地图或任何其他服务，我必须这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-14T20:20:20.387

ok, so the problem was really stupid, I mixed up longitude with latitude, they should have went other way around, now everything works. lol

# sql-server - 将 SSRS R2 报告部署到非 R2 服务器

> ID：10121880
> 
> 赞同：2
> 
> 时间：2012-04-12T10:35:47.447
> 
> 标签：sql-server, sql-server-2008, deployment, reporting-services, sql-server-2008-r2

我使用 SSRS 2008 R2 开发了报告，但现在需要部署到 R2 之前的服务器（SSRS 2008 SP2）。这是可能的还是必须升级服务器？

我需要保留所有当前元素，包括量规和气泡图等等

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T12:23:30.703

您可以通过如下报表项目在 Business Intelligence Development Studio 中设置报表的目标服务器版本

1.  打开一个包含 BIDS 中所有报表的报表项目
2.  单击顶部菜单上的“项目”；然后是“*项目名称*属性”
3.  在配置属性 -> 常规 -> 部署下，您可以在 TargetServerVersion 属性中看到。
4.  将此更改为 SQL Server 2008
5.  点击“确定”

这将允许您通过具有正确目标版本的 BIDS 部署报告。如果 2008 年不支持这些元素（例如地图和迷你图），您可能必须从报告中删除这些元素。

![目标服务器版本](../Images/7aa8fa8821a351b57879945acc42d462.png)

# php - 从项目价格计算中回显整数（来自数组）

> ID：10121881
> 
> 赞同：0
> 
> 时间：2012-04-12T10:35:47.693
> 
> 标签：php

我有一个棘手的问题，希望能得到一些建议。

客户设定价格，然后该价格决定了可以购买该商品的客户数量。

我认为我希望从表单中设置项目价格，然后在循环中执行计算，将其保存在数组中，然后仅将数组中的整数回显到由 ajax onlclick 填充的选项框。

至少我认为那是怎么做的。

例如

itemPrice=50，因此只有以下客户可以购买该商品。50,25,10,5,2 或 1，因为这些是计算中唯一的整数（这应该作为组合框或滑块提供）。

```
$itemprice = 50
for ($i=1, $i < $itemprice, ++$i) {
$array .= $i
}

for each {
is_int($array){
$NoOfCustomersList .= <option value="$NoOfCustomers">$NoOfCustomers</option> 
//(or jQuery slider)
}
} 
```

免责声明

至少这在我看来是这样的，我是 php 新手，所以上面的内容可能是胡言乱语

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:43:56.337

如果你的意思是你只想要除 50 的数字，你可以这样做

```
$itemPrice = 50;
$array = array();

for ( $i = 1; $i <= $itemPrice; $i++ ){
    if ( $itemPrice % $i == 0 ){ $array[] = $i; }
}

foreach( $array as $item ){
    echo '<option value="', $item ,'"/>', $item ,'</option>';
} 
```

# android - 如何在必应地图上显示多个图钉

> ID：10121885
> 
> 赞同：0
> 
> 时间：2012-04-12T10:35:57.483
> 
> 标签：android, geolocation, bing-maps

我想在 bing 地图中使用纬度和经度显示多个图钉，有什么例子可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T16:54:08.687

Sure, head over to the [Bing Maps V7 Interactive SDK](http://www.bingmapsportal.com/ISDK/AjaxV7#Pushpins5), they have a whole section regarding the usage of Pushpins, including one example that adds 50 of them on the map using random latitude and longitude coordinates.

# mysql - 如何在相关子查询中计算 MySQL 中的移动平均值？

> ID：10121887
> 
> 赞同：2
> 
> 时间：2012-04-12T10:36:12.330
> 
> 标签：mysql, correlated-subquery, moving-average

我想创建一个时间线报告，针对时间线中的每个日期显示数据集中最新 N 个数据点的**移动**平均值，该数据集中具有一些度量值和测量日期。我有一个包含每天的日历表来提供日期。我可以计算一个时间线，用相关子查询相当简单地显示该日期之前的**总体**平均值（实际情况比这复杂得多，但它基本上可以简化为这样）：

```
SELECT  c.date
,       (   SELECT  AVERAGE(m.value) 
            FROM    measures as m
            WHERE   m.measured_on_dt <= c.date
        ) as `average_to_date`
FROM    calendar c
WHERE   c.date between date1 AND date2  -- graph boundaries
ORDER BY c.date ASC 
```

我花了几天时间阅读这个问题，但没有找到任何好的解决方案。有人建议 LIMIT 可能在子查询中工作（当前版本的 MySQL 在子查询中支持 LIMIT），但是 LIMIT 适用于返回集，而不是进入聚合的行，因此添加它没有区别。

我也不能编写带有 LIMIT 的非聚合 SELECT 然后聚合它，因为在 FROM 语句中不允许关联子查询。所以这（可悲）不起作用：

```
SELECT  c.date
,       SELECT AVERAGE(last_5.value)
        FROM (  SELECT  m.value
                FROM    measures as m
                WHERE   m.measured_on_dt <= c.date
                ORDER BY m.measured_on_dt DESC
                LIMIT 5
              ) as `last_5`
FROM    calendar c
WHERE   c.date between date1 AND date2  -- graph boundaries
ORDER BY c.date ASC 
```

我在想我需要完全避免使用子查询方法，看看我是否使用巧妙的连接/行编号技术和用户变量来做到这一点，然后聚合它，但是当我正在处理这个问题时，我想我会问是否有人知道更好的方法吗？

更新：好的，我已经为这个例子简化了一个解决方案。它依赖于一些用户变量的技巧来从日历日期向后编号度量。它还与日历表（而不是子查询）进行交叉乘积，但这具有导致行编号技巧失败的不幸副作用（用户变量在发送到客户端时进行评估，而不是在行被评估）所以为了解决这个问题，我不得不将查询嵌套一层，对结果进行排序，然后将行编号技巧应用于该集合，然后它就可以工作了。

此查询仅返回有度量的日历日期，因此如果您想要整个时间线，您只需选择日历并 LEFT JOIN 到此结果集。

```
set @day = 0;
set @num = 0;
set @LIMIT = 5;

SELECT  date
,       AVG(value) as recent_N_AVG
FROM
(  SELECT *
  ,      @num := if(@day = c.date, @num + 1, 1) as day_row_number
  ,      @day := day as dummy
  FROM 
  ( SELECT  c.full_date
    ,       m.value
    ,       m.measured_on_dt
    FROM    calendar c 
    JOIN    measures as m
    WHERE   m.measured_on_dt <= c.full_date
    AND     c.full_date BETWEEN date1 AND date2  
    ORDER BY c.full_date ASC, measured_on_dt DESC
  ) as full_data
) as numbered
WHERE day_row_number <= @LIMIT
GROUP BY date 
```

行编号技巧可以推广到更复杂的数据（我的度量是在需要汇总的多个维度中）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:22:05.330

如果您的时间线是连续的（每天 1 个值），您可以像这样改进您的第一次尝试：

```
SELECT c.date,
       ( SELECT AVERAGE(m.value) 
         FROM   measures as m
         WHERE  m.measured_on_dt 
                    BETWEEN DATE_SUB(c.date, INTERVAL 5 day) AND c.date
       ) as `average_to_date`
FROM    calendar c
WHERE   c.date between date1 AND date2  -- graph boundaries
ORDER BY c.date ASC 
```

如果您的时间线中有漏洞，这将导致平均值少于 5 个。

# c++ - Visual C++ 2010 连接到 MySQL

> ID：10121891
> 
> 赞同：2
> 
> 时间：2012-04-12T10:36:32.110
> 
> 标签：c++, mysql, database, connection

在过去的 4 天里，我一直在尝试完成以下任务： - 创建 MySQL 数据库 - 在 c++ win32 应用程序中连接到数据库，以便我可以使用数据和/或编辑数据。

到目前为止一切顺利，我正在使用以下内容： - 带有 64 位 Windows 7 家庭版的 Packard Bell - Visual C++ Express 2010 - 下载并安装了 mysql 5.5（选择完整安装）

我使用 mysql 终端和创建一个简单的数据库没有问题，但是在我的 c++ 代码中建立与它的连接是一个主要障碍。一些教程、论坛等建议直接连接，而另一些建议使用 ODBC。第一个建议导致 Visual Studio 在包含头文件时无法找到源文件的大量问题：mysql_connection.h

cppconn/驱动程序.h

cppconn/exception.h

ETC...

找不到这些问题的解决方案，所以我转向 ODBC 并找到以下代码：

（见下一篇，不允许发布超过2个链接）

该代码实际上可以编译，但找不到任何东西。请参阅下面的屏幕：http: //imageshack.dk//viewimage.php?file=/imagesfree/ [CD525364.jpg](http://imageshack.dk//viewimage.php?file=/imagesfree/CD525364.jpg)

我找不到问题的解决方案。此 ODBC 数据源“mysql”已手动设置，如下所示： http://imageshack.dk//viewimage.php?file=/imagesfree/ [WEG25517.jpg](http://imageshack.dk//viewimage.php?file=/imagesfree/WEG25517.jpg)

我已经阅读了使用正确的目录和库设置 Visual Studio 的官方 mysql 文档，并且由于代码编译，这不是问题吗？

我真的很感激任何帮助或建议:) 在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:48:57.037

您是否配置了项目属性？我假设你已经在 C:\MySQL 安装了 MySQL

打开visual studio-->解决方案资源管理器-->右键-->属性-->C/C++-->常规-->添加包含目录-->点击编辑写入C:\MySQL\include（或者在哪里曾经安装过 MySQL 并找到它的包含文件夹）。

现在在同一个属性对话框中导航到链接器->常规->“添加其他库目录”->（写入包含 .dll 或 .lib 文件的文件夹的路径，例如 C:\MySQL\Connector ODBC）

在相同的属性对话框中导航到链接器 --> 输入 --> 附加依赖项 --> （写下您要使用的 .lib 文件的名称，例如 libmysql.lib 或您要使用的任何其他库，它们位于“附加”上方图书馆目录”）。

希望它会帮助你。

# linqpad - Linqpad - 输出到锚点以使用标题

> ID：10121899
> 
> 赞同：1
> 
> 时间：2012-04-12T10:37:12.603
> 
> 标签：linqpad

我有一个存储异常消息的数据库。我想创建一个获取这些异常的查询，但我不想转储大量文本，而是希望它是“按需”的。

我认为将异常放入这样的锚标记中，然后在需要时通过将鼠标悬停在上面来阅读消息会起作用......显然不是。

```
var logsForErrors = (from error in Logs
         select new {
              error = LINQPad.Util.RawHtml("<a title='"+ error.Exception+"'></a>"),
              errorDate = error.Date,
              errorMessage = error.Message
         }).Take(10);

logsForErrors.Dump(); 
```

这是抛出异常（大声笑） - “无法解析自定义 HTML：”

编码异常消息

```
...RawHtml("<a title='"+ Uri.EscapeDataString(error.Exception)+"'></a>") 
```

> 消息无法将表达式 'RawHtml((("h__TransparentIdentifier0.error.Exception)) + "'>"))' 转换为 SQL 并且无法将其视为本地表达式。将生成新错误

有任何想法吗？- 我也愿意接受替代解决方案。

我只想要一个消息容器，而不是直接转储到输出中，因为它太大了！

谢谢，科汉

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T11:09:38.130

您是否尝试过在最近的测试版中使用“结果到 DataGrids”模式？它可能只是你需要的，而无需编写任何其他内容。

编辑：您的错误可能是由于在没有转义文本的情况下发出 HTML。最简单的解决方案是使用 XElement 而不是字符串调用 Util.RawHtml。您可以编写一个扩展方法来执行您想要的操作，如下所示：

```
public static class Extensions
{
    public static object Tooltipize (this string data)
    {
        if (string.IsNullOrEmpty (data) || data.Length < 20) return data;
        return Util.RawHtml (new XElement ("span", new XAttribute ("title", data), data.Substring (0, 20)));
    }
} 
```

把它放到**我的扩展**中，你可以从任何查询中使用它。

# php - PHP scandir 浏览器视图通过 WAMP 显示网络共享文件 (file://)。适用于本地主机但不适用于 IP 地址

> ID：10121903
> 
> 赞同：0
> 
> 时间：2012-04-12T10:37:37.693
> 
> 标签：php, file-io, localhost, external, wamp

也许我很愚蠢，或者误解了 WAMP 限制或浏览器限制，但我已经使用 scandir 函数递归地使用 Ajax 创建了一个 PHP 文件浏览器视图，它可以很好地显示来自我们的网络共享 (\computername\share) 的文件.

[我可以在访问http://localhost](http://localhost)时启动文件，但是如果我从同一台 localhost 机器访问 http://[our_external_ip_address] 则文件不会打开。状态栏中的路径在两者上显示相同（例如 file://computername/share/filename.zip）。我最终想将文件放在与我们的 Web 主机位于同一域的网络共享上。

请帮忙。我对 PHP 和 JS 相当称职，但是当涉及到网络主机之类的东西时，我感到很吃力。TIA。

詹姆士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-13T09:13:31.157

非常感谢 DaveRandom - 该解决方案允许从外部 Web 客户端启动来自 UNC 路径的 PDF / Word / Zip 文件。

**文件 1: - index.php**

```
<?php
    $filename= *** insert UNC path to file *** // e.g. \\share\computername\New Document.doc
    $extension= pathinfo($filename, PATHINFO_EXTENSION); // Gets extension for file
    $displayFilename= *** insert shorten filename *** // e.g. New Document.doc
?>

<a href="filehandler.php?name=<?php echo $filename; ?>&ext=<?php echo $extension; ?>&shortname=<?php echo $displayFilename; ?>"><?php echo $displayFilename; ?></a> 
```

**文件 2：-filehandler.php**

```
<?php
$filename = $_GET['name'];
$extension = $_GET['ext'];
$shortfilename = $_GET['shortname'];
if ($extension == "pdf")
{
    header("Content-type: application/pdf"); // act as a pdf file to browser
}
if ($extension == "doc")
{
    header("Content-type: application/msword"); // act as a doc file to browser
}
if ($extension == "zip")
{
    header("Content-type: application/zip"); // act as a zip file to browser
}
header("Content-Disposition: inline; filename='$shortfilename'"); 

$file = readfile($filename);
echo $file;
?> 
```

# c# - 开始使用带有证书身份验证的 WCF 路由 - 陷入 XML 地狱

> ID：10121906
> 
> 赞同：2
> 
> 时间：2012-04-12T10:37:56.600
> 
> 标签：c#, wcf, wcf-routing

我有一个简单的 WCF 客户端 -> 服务器结构，其中客户端引用服务器的 WCF 服务。使用 X509 证书完成身份验证。

我想为我的服务添加一种简单形式的冗余。意思是让多台服务器运行，并让客户端使用一个路由器，如果主服务器死机，该路由器将透明地故障转移到备用服务器。
很简单，对吧？

我使用了[hello world](http://msdn.microsoft.com/en-us/library/dd795218.aspx)示例代码，只是将路由器的 app.config 文件更改为类似于我的客户端的文件。
然后我将我的客户指向路由器。

我的痛苦得到的唯一回报是`An insecured or incorrectly secured fault`例外，内心的例外说：
`The message could not be processed. This is most likely because the action 'http://www.MyCompany.com/MyApp/api/IMyCompanyMyAppService/GetItems' is incorrect or because the message contains an invalid or expired security context token or because there is a mismatch between bindings. The security context token would be invalid if the service aborted the channel due to inactivity. To prevent the service from aborting idle sessions prematurely increase the Receive timeout on the service endpoint's binding.`

显然，所有这些原因都是公然的谎言（该`GetItems`方法*已*实现，绑定没有不匹配，因为我从客户端配置中复制粘贴了它们，并且我的接收超时没有任何问题）。

现在我不知道该怎么办；我有一种预感，这可能与我使用的身份验证方法（X509 证书）有关，但我真的不知道。

附上服务器、路由器和客户端的配置。

```
<!--SERVER CONFIGURATION-->
  <system.serviceModel>
    <bindings>

            <basicHttpBinding>
        <binding name="MyAppService_BasicHttpBindingConfigurationSSL" 
                                 maxBufferPoolSize="1073741824" maxBufferSize="1073741824" maxReceivedMessageSize="1073741824">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="1073741824"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Transport">
            <transport clientCredentialType="Basic" proxyCredentialType="None"/>
          </security>
        </binding>
      </basicHttpBinding>

      <wsHttpBinding>
        <binding name="MyAppService_BindingConfiguration" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="1073741824"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Message">
            <transport/>
            <message clientCredentialType="Certificate" negotiateServiceCredential="false" establishSecurityContext="false"/>
          </security>
        </binding>
        <binding name="MyAppService_BindingConfigurationOverSSL" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="1073741824"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="TransportWithMessageCredential">
            <transport/>
            <message clientCredentialType="Certificate" negotiateServiceCredential="false" establishSecurityContext="false"/>
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>

    <services>
      <service name="MyCompany.MyApp.MyAppService.Server.Service.MyCompanyMyAppService" behaviorConfiguration="MyAppService_Behavior">
        <!-- Non-SSL endpoint -->
        <endpoint name="MyAppServiceEndpoint"
                                    address="http://localhost:8087/MyAppService" 
                                    binding="wsHttpBinding" 
                                    bindingNamespace="http://www.MyCompany.com/api/binding" 
                                    bindingConfiguration="MyAppService_BindingConfiguration" 
                                    behaviorConfiguration="WSDLBehavior" 
                                    contract="MyCompany.MyApp.MyAppService.Common.Services.IMyCompanyMyAppService"/>
        <!-- SSL endpoint -->
        <endpoint name="MyAppServiceEndpointSSL" 
                                    address="https://localhost:8088/MyAppService" 
                                    binding="wsHttpBinding" 
                                    bindingNamespace="http://www.MyCompany.com/api/binding" 
                                    bindingConfiguration="MyAppService_BindingConfigurationOverSSL" 
                                    behaviorConfiguration="WSDLBehavior" 
                                    contract="MyCompany.MyApp.MyAppService.Common.Services.IMyCompanyMyAppService"/>
        <!--BasicHttpBinding-->
        <!--SSL BasicHttpBinding -->
        <endpoint name="MyAppServiceEndpointBasicSSL" 
                                    address="https://localhost:8088/MyAppServiceBasic" 
                                    bindingConfiguration="MyAppService_BasicHttpBindingConfigurationSSL" 
                                    binding="basicHttpBinding" 
                                    contract="MyCompany.MyApp.MyAppService.Common.Services.IMyCompanyMyAppService" />
        <!-- Non-SSL Metadata endpoint -->
        <endpoint name="MyAppServiceBinding" address="http://localhost:8087/mex" binding="mexHttpBinding" behaviorConfiguration="WSDLBehavior" contract="IMetadataExchange"/>
      </service>
    </services>

    <behaviors>
      <endpointBehaviors>
        <behavior name="WSDLBehavior">
          <!--<wsdlExtensions />-->
        </behavior>
      </endpointBehaviors>

      <serviceBehaviors>
        <behavior name="MyAppService_Behavior">
          <serviceCredentials>
            <userNameAuthentication userNamePasswordValidationMode="Custom" 
                                                                        customUserNamePasswordValidatorType="MyCompany.MyApp.MyAppService.Server.Service.MyAppUsernamePasswordValidator, MyCompany.MyApp.MyAppService.Server" />

            <clientCertificate>
              <authentication certificateValidationMode="PeerOrChainTrust" revocationMode="NoCheck"/>
              <certificate/>              
            </clientCertificate>
            <serviceCertificate storeLocation="LocalMachine" 
                                                                storeName="My" x509FindType="FindBySubjectName" findValue="server.dev.MyApp.MyCompany.com"/>
          </serviceCredentials>
          <!-- Allow the service to handle a high load of calls and sessions -->
          <serviceThrottling maxConcurrentCalls="300" maxConcurrentInstances="500" maxConcurrentSessions="30000"/>
          <serviceMetadata httpGetEnabled="true" httpGetUrl="http://localhost:8087/mex" httpsGetEnabled="false" httpsGetUrl="https://localhost:8088/mex"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>

  </system.serviceModel>

<!--ROUTER CONFIGURATION-->  
<system.serviceModel>
    <services>
      <!--ROUTING SERVICE -->
      <service behaviorConfiguration="routingData"
          name="System.ServiceModel.Routing.RoutingService">
        <host>
          <baseAddresses>
            <add  baseAddress="http://localhost:8000/MyAppService"/>
          </baseAddresses>
        </host>
        <endpoint address=""
                  binding="wsHttpBinding"
                  name="reqReplyEndpoint"
                  contract="System.ServiceModel.Routing.IRequestReplyRouter" />
        <endpoint address="mex"
                  binding="mexHttpBinding"
                  contract="IMetadataExchange"  />
      </service>
    </services>

    <bindings>
      <basicHttpBinding>
        <binding name="MyAppServiceEndpointBasicSSL" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Transport">
            <transport clientCredentialType="Basic" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
      <wsHttpBinding>
        <binding name="MyAppServiceEndpoint" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="1073741824"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Message">
            <transport/>
            <message clientCredentialType="Certificate" negotiateServiceCredential="false" establishSecurityContext="false"/>
          </security>
        </binding>
        <binding name="MyAppServiceEndpointSSL" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="1073741824"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="TransportWithMessageCredential">
            <transport/>
            <message clientCredentialType="Certificate" negotiateServiceCredential="false" establishSecurityContext="false"/>
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>

    <behaviors>
      <serviceBehaviors>
        <behavior name="routingData">
          <serviceMetadata httpGetEnabled="True"/>
          <routing filterTableName="routingTable1" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <client>
      <endpoint address="http://localhost:8087/MyAppService" binding="wsHttpBinding"
        bindingConfiguration="MyAppServiceEndpoint" contract="MyCompanyMyAppService.IMyCompanyMyAppService"
        name="MyAppServiceEndpoint">
        <identity>
          <certificate encodedValue="AwAAAAEAAAAUAAAAS2hv3zJGGxe4T0jo4fwcBgc2fbogAAAAAQAAABYCAAAwggISMIIBf6ADAgECAhDtT0KoiuHcoERR+GfWnIJJMAkGBSsOAwIdBQAwHzEdMBsGA1UEAxMUZGV2LmNybS5sZXZlcmF0ZS5jb20wHhcNMTExMTA5MDgyNDQ2WhcNMTMxMjMwMjIwMDAwWjAmMSQwIgYDVQQDExtzZXJ2ZXIuZGV2LmNybS5sZXZlcmF0ZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMsBWu9R/c65MNdQRDkCi4w5uyxp4Hh5FK0hyUh9LzObQuSuMvqYc+cW1OuI1b4G1RBNOwGOzxUeK+dPX6Q5Y96qcmOk5+eJyPOg2dtHaOujGvaW1MN/sVJPMy6xgCtJ6iSe9xDYYmxcha2quZK3LGGvW3d3/QznBqY+XwK6kbHXAgMBAAGjUDBOMEwGA1UdAQRFMEOAEP3fipkit68H++sodJuSZSWhHTAbMRkwFwYDVQQDExBjcm0ubGV2ZXJhdGUuY29tghAluuQuFlNJpU+Yh7Yf725TMAkGBSsOAwIdBQADgYEAZVECKrndJdjMYnfSb2bCByv24mpgE2yCuhm2Ey+cSEwP31aKrHIVNAcVDPd7k1/R4qsWU6I8PHjVCeCHTMnf+EE/1IV0lbCj/PD/D3by+m/7hEKdtzk6VHJyJLmLyO6fIJc14XPI4qC/KVuUS97UjNpWcICZFgM64Vb7MUW5thE=" />
        </identity>
      </endpoint>
      <endpoint address="https://localhost:8088/MyAppService" binding="wsHttpBinding"
        bindingConfiguration="MyAppServiceEndpointSSL" contract="MyCompanyMyAppService.IMyCompanyMyAppService"
        name="MyAppServiceEndpointSSL" />
      <endpoint address="https://localhost:8088/MyAppServiceBasic" binding="basicHttpBinding"
        bindingConfiguration="MyAppServiceEndpointBasicSSL" contract="MyCompanyMyAppService.IMyCompanyMyAppService"
        name="MyAppServiceEndpointBasicSSL" />
    </client>
    <!--ROUTING SECTION -->
    <routing>
      <filters>
        <filter name="MatchAllFilter1" filterType="MatchAll" />
      </filters>
      <filterTables>
        <filterTable name="routingTable1">
          <add filterName="MatchAllFilter1" endpointName="MyAppServiceEndpoint" />
        </filterTable>
      </filterTables>
    </routing>
  </system.serviceModel>

<!--CLIENT CONFIGURATION-->  
<system.serviceModel>
    <client>
      <endpoint address="http://localhost:8087/MyAppService" binding="wsHttpBinding"
        bindingConfiguration="MyAppServiceEndpoint" contract="MyCompanyMyAppService.IMyCompanyMyAppService"
        name="MyAppServiceEndpoint">
        <identity>
          <certificate encodedValue="AwAAAAEAAAAUAAAAS2hv3zJGGxe4T0jo4fwcBgc2fbogAAAAAQAAABYCAAAwggISMIIBf6ADAgECAhDtT0KoiuHcoERR+GfWnIJJMAkGBSsOAwIdBQAwHzEdMBsGA1UEAxMUZGV2LmNybS5sZXZlcmF0ZS5jb20wHhcNMTExMTA5MDgyNDQ2WhcNMTMxMjMwMjIwMDAwWjAmMSQwIgYDVQQDExtzZXJ2ZXIuZGV2LmNybS5sZXZlcmF0ZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMsBWu9R/c65MNdQRDkCi4w5uyxp4Hh5FK0hyUh9LzObQuSuMvqYc+cW1OuI1b4G1RBNOwGOzxUeK+dPX6Q5Y96qcmOk5+eJyPOg2dtHaOujGvaW1MN/sVJPMy6xgCtJ6iSe9xDYYmxcha2quZK3LGGvW3d3/QznBqY+XwK6kbHXAgMBAAGjUDBOMEwGA1UdAQRFMEOAEP3fipkit68H++sodJuSZSWhHTAbMRkwFwYDVQQDExBjcm0ubGV2ZXJhdGUuY29tghAluuQuFlNJpU+Yh7Yf725TMAkGBSsOAwIdBQADgYEAZVECKrndJdjMYnfSb2bCByv24mpgE2yCuhm2Ey+cSEwP31aKrHIVNAcVDPd7k1/R4qsWU6I8PHjVCeCHTMnf+EE/1IV0lbCj/PD/D3by+m/7hEKdtzk6VHJyJLmLyO6fIJc14XPI4qC/KVuUS97UjNpWcICZFgM64Vb7MUW5thE=" />
        </identity>
      </endpoint>
      <endpoint address="https://localhost:8088/MyAppService" binding="wsHttpBinding"
        bindingConfiguration="MyAppServiceEndpointSSL" contract="MyCompanyMyAppService.IMyCompanyMyAppService"
        name="MyAppServiceEndpointSSL" />
      <endpoint address="https://localhost:8088/MyAppServiceBasic" binding="basicHttpBinding"
        bindingConfiguration="MyAppServiceEndpointBasicSSL" contract="MyCompanyMyAppService.IMyCompanyMyAppService"
        name="MyAppServiceEndpointBasicSSL" />
    </client>
    <bindings>
      <basicHttpBinding>
        <binding name="MyAppServiceEndpointBasicSSL" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
          maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
          messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
          useDefaultWebProxy="true">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <security mode="Transport">
            <transport clientCredentialType="Basic" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="UserName" algorithmSuite="Default" />
          </security>
        </binding>
      </basicHttpBinding>
      <wsHttpBinding>
        <binding name="MyAppServiceEndpoint" closeTimeout="00:01:00" openTimeout="00:01:00"
          receiveTimeout="00:10:00" sendTimeout="00:01:00" bypassProxyOnLocal="false"
          transactionFlow="false" hostNameComparisonMode="StrongWildcard"
          maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text"
          textEncoding="utf-8" useDefaultWebProxy="true" allowCookies="false">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00"
            enabled="false" />
          <security mode="Message">
            <transport clientCredentialType="Windows" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="Certificate" negotiateServiceCredential="false"
              algorithmSuite="Default" establishSecurityContext="false" />
          </security>
        </binding>
        <binding name="MyAppServiceEndpointSSL" closeTimeout="00:01:00"
          openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
          bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
          maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text"
          textEncoding="utf-8" useDefaultWebProxy="true" allowCookies="false">
          <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
            maxBytesPerRead="4096" maxNameTableCharCount="16384" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00"
            enabled="false" />
          <security mode="TransportWithMessageCredential">
            <transport clientCredentialType="None" proxyCredentialType="None"
              realm="" />
            <message clientCredentialType="Certificate" negotiateServiceCredential="true"
              algorithmSuite="Default" establishSecurityContext="false" />
          </security>
        </binding>
      </wsHttpBinding>
    </bindings>

  </system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-15T15:47:13.493

好吧，目前似乎没有解决方案；
WCF 似乎只支持 Windows 凭据方法（请参阅[此处](http://blogs.microsoft.co.il/blogs/applisec/archive/2011/12/12/wcf-routing-and-message-security.aspx)）。
所以它回到了绘图板......如果有人感兴趣 -[这](https://stackoverflow.com/q/10163513/537913)就是我进入的方向。

# html - IE9：Arial 的错误渲染（加粗）

> ID：10121910
> 
> 赞同：3
> 
> 时间：2012-04-12T10:38:02.850
> 
> 标签：html, css, internet-explorer

我已经在 Chrome、FF 和 IE8 中测试了我的页面，所有浏览器都以这种方式呈现文本：

![在此处输入图像描述](../Images/8572606eec3f3e7a7a912c8df0b9e69d.png)

它的定义如下：

```
font-family: 'Arial', sans-serif;
font-size: 0.75em;  
font-weight: bold; 
```

我尝试过以不同的方式声明 Arial，使用 px 而不是 em 并且还定义了数字（600、800）的权重......但 IE9 的渲染仍然比其他浏览器“更大胆”：

![在此处输入图像描述](../Images/53318b7a759b81c5ee249737293cd91a.png)

有什么帮助吗？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-28T18:30:21.370

`600`您可能会遇到不同的问题，因为您说您尝试`Arial`了. 这种切换将发生在 和 的s上。`Arial``Arial Black``font-weight``800``900`

要`Arial`在 IE 9 中使用粗体而不切换到`Arial Black`，请使用...

```
font-family: Arial, sans-serif;
font-size: 0.75em;  
font-weight: 700; 
```

这也应该解决 Firefox 中的相同问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-12T10:47:27.737

这个问题之前已经在 StackOverflow上[回答过了。](https://stackoverflow.com/questions/8676336/why-does-internet-explorer-9-render-arial-stronger-than-other-browsers "回答")这是一个浏览器问题，IE9 呈现不同的字体。它使用一种称为 DirectWrite 的 ClearType 技术。

在我个人看来，这不是什么大问题。网站永远不会在每个浏览器中看起来都完全相似。如果它真的困扰你，可以添加 IE-Hacks（例如强制浏览器使用 IE8 渲染），但我不推荐它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-12T10:53:37.097

只是为了权衡一下，您可以在 HTML 中放置一个元标记作为一种快速解决方法，它会告诉 IE9 模拟 IE8，恢复原始呈现。

为此，请放置`<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8" />`在您的部分中。

然而，这将以牺牲您可能需要的其他 IE9 功能为代价，例如更好的 HTML5 和 CSS3 支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T10:42:03.710

IE 通常让我头疼。我要做的是使用条件 CSS 并从 IE css 中删除粗体

```
<!--[if IE 9]>
    <link rel="stylesheet" type="text/css" href="/ie9.css" />
<![endif]--> 
```

然后像这样定义它

```
font-family: 'Arial', sans-serif;
font-size: 0.75em; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T10:48:20.047

`font-weight:bold`当我不小心设置了 body 标签时，我遇到了这个问题。出于某种原因，IE9 使我所有的 Arial 文本都比其他浏览器更粗。

# c# - 如果文件是在过去一小时内创建的，则从 FTP 下载文件

> ID：10121911
> 
> 赞同：2
> 
> 时间：2012-04-12T10:38:09.193
> 
> 标签：c#, .net, ftp

我需要从 FTP 上的特定文件夹下载文件，但只下载创建时间在最后一小时内的文件。所以基本上我需要列出该文件夹中的所有文件，然后只下载时间戳在执行时间超过一小时内没有差异的文件。关于如何解析 FTP 上文件的时间戳的任何想法？我不能使用任何 3rd-party FTP 客户端库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:03:33.453

主要任务可能不是读取文件时间戳，而是确定它在最后一小时内被修改。如果您的服务器位于同一时区，那么它将与您的时间相同。如果没有，将会有一些时间偏移。如果您一直使用同一台服务器，则可以以相当可靠的方式解决此问题。但是，如果您在世界各地使用多台服务器，那么这会变得有点复杂。所以要注意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-13T10:56:27.507

这就是我现在想出的。当然有一些更优雅的方式来处理这个但是......

```
foreach (var fileName in filesNamesFromFtpFolder)
        {
            FtpWebRequest request = (FtpWebRequest)FtpWebRequest.Create(@"ftp://" + host + @"/" + folder + @"/" + fileName);

            request.Method = WebRequestMethods.Ftp.GetDateTimestamp;
            request.Proxy = null;

            using (FtpWebResponse resp = (FtpWebResponse)request.GetResponse())
            {
                if (DateTime.Now.Subtract(TimeSpan.FromMinutes(60)) < resp.LastModified)
                {
                    //download this file...
                }
            }
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-15T05:41:19.377

不幸的是，没有真正可靠和有效的方法来使用 .NET 框架提供的功能来检索目录中所有文件的修改时间戳，因为它不支持 FTP `MLSD`。该`MLSD`命令以标准化的机器可读格式提供远程目录列表。命令和格式由[RFC 3659](https://datatracker.ietf.org/doc/html/rfc3659#section-7)标准化。

您可以使用的替代方案，由 .NET 框架支持：

*   `ListDirectoryDetails`方法（FTP`LIST`命令）检索目录中所有文件的详细信息，然后处理 FTP 服务器特定格式的详细信息

    DOS/Windows 格式：[C# 类解析 WebRequestMethods.Ftp.ListDirectoryDe​​tails FTP 响应](https://stackoverflow.com/q/7060983/850848#39771146)
    *nix 格式：[解析 FtpWebRequest ListDirectoryDe​​tails 行](https://stackoverflow.com/q/1013486/850848#40045894)

*   `GetDateTimestamp`方法（FTP`MDTM`命令）单独检索每个文件的时间戳。一个优点是响应由[RFC 3659](https://datatracker.ietf.org/doc/html/rfc3659#section-3)标准化为`YYYYMMDDHHMMSS[.sss]`. 缺点是您必须为每个文件发送单独的请求，这可能效率很低。文件修改时间为您解析为[`LastModified`属性](https://docs.microsoft.com/en-us/dotnet/api/system.net.ftpwebresponse.lastmodified)：

    ```
    const string uri = "ftp://example.com/remote/path/file.txt";
    FtpWebRequest request = (FtpWebRequest)WebRequest.Create(uri);
    request.Method = WebRequestMethods.Ftp.GetDateTimestamp;
    FtpWebResponse response = (FtpWebResponse)request.GetResponse();
    Console.WriteLine("{0} {1}", uri, response.LastModified);
    if (response.LastModified > DateTime.Now.Subtract(TimeSpan.FromHours(1)))
    {
        // download
    } 
    ```

* * *

更简单的方法是使用（我知道你不能）支持现代`MLSD`命令或可以在给定时间限制的情况下直接下载文件的第 3 方 FTP 客户端实现。

例如[WinSCP .NET 程序集](https://winscp.net/eng/docs/library)既支持时间限制`MLSD`又支持[时间限制](https://winscp.net/eng/docs/file_mask#size_time)。

甚至还有一个针对您的特定任务的示例：[如何仅传输新的/修改的文件？](https://winscp.net/eng/docs/faq_script_modified_files#no_old_files)
该示例适用于 PowerShell，但可以轻松转换为 C#：

```
// Setup session options
SessionOptions sessionOptions = new SessionOptions
{
    Protocol = Protocol.Ftp,
    HostName = "ftp.example.com",
    UserName = "username",
    Password = "password",
};

using (Session session = new Session())
{
    // Connect
    session.Open(sessionOptions);

    // Download files modified with the last hour
    TransferOptions transferOptions = new TransferOptions();
    transferOptions.FileMask = "*>=1H";
    session.GetFiles(
        "/remote/path/*", @"C:\local\path\", false, transferOptions).Check();
} 
```

另请参阅[时间限制](https://winscp.net/eng/docs/file_mask#size_time)的语法。

*（我是WinSCP的作者）*

# iphone - 合并具有透明度的两个图像时出现奇怪的颜色行为

> ID：10121912
> 
> 赞同：2
> 
> 时间：2012-04-12T10:38:14.403
> 
> 标签：iphone, ios, core-graphics, objective-c++, alphablending

这是一个已经被问过的问题，但是我遇到了一个我在任何地方都找不到并且我不理解的问题。

我的目标很简单：绘制背景图像，然后在其上绘制具有透明度的图像。一开始效果很好，当顶部图像的透明度很弱时，但是一旦顶部图像几乎透明，我就会在结果图像上得到奇怪的颜色。

这是原图： [原图http://img406.imageshack.us/img406/7452/bidou.jpg](http://img406.imageshack.us/img406/7452/bidou.jpg)

这是我逐渐透明的图像： [mask http://img515.imageshack.us/img515/4464/loltest31.png](http://img515.imageshack.us/img515/4464/loltest31.png)（我在绘图时调整它的大小；我试图将其设为原始大小，以防我的问题来自插值或类似的东西，但它没有解决问题......）

现在有了一些透明度的面具： [面具步骤4 http://img19.imageshack.us/img19/3791/loltest4.png](http://img19.imageshack.us/img19/3791/loltest4.png)

结果： [![结果步骤 4](../Images/a8284230f5948bb1f680d7de86b1363e.png)](https://i.stack.imgur.com/wiIMn.jpg)

最后一个结果是，当蒙版上的透明度（我从不更改颜色数据，只有 alpha 值）几乎完成时（alpha=7（从 0 到 255））： [![结果步骤 1](../Images/79ba170cc8078ed0bfd82e809069eb16.png)](https://i.stack.imgur.com/BWSyH.jpg)

如您所见，结果上出现了一些奇怪的颜色，例如帽子顶部的红点，并且透明度似乎不是在所有地方都处于同一水平（虽然是，因为我通过保存蒙版来检查它）。更重要的是，结果图像的某些区域是完全透明的，即使我从不修改原始图像并且总是先绘制它。

当遮罩完全透明时，结果与原始图像相同，但只要 alpha 不为 0，就会产生那些奇怪的彩色像素。

我尝试了不同的混合模式，但没有成功。

这是我在代码中执行此操作的一种方式：

```
 UIImage *bottomImage = self.originalImage;
    UIImage *image       = [self getUIImage];

    CGSize newSize = mySize;
    UIGraphicsBeginImageContext( newSize );

    // Use existing opacity as is
    [bottomImage drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];

    // Apply supplied opacity if applicable
    [image drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];

    resultImage = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext(); 
```

还有另一种方式（最后是相同的）：

```
CGSize mySize = self.originalImage.size;
UIGraphicsBeginImageContextWithOptions(mySize, YES, 0);
CGContextRef globalContext = UIGraphicsGetCurrentContext();

CGContextSaveGState(globalContext);

CGContextSetBlendMode(globalContext, kCGBlendModeNormal);
CGContextDrawImage(globalContext, CGRectMake(0, 0, mySize.width, mySize.height), self.originalImage.CGImage);
CGContextDrawImage(globalContext, CGRectMake(0, 0, mySize.width, mySize.height), [self getUIImage].CGImage);

CGImageRef   resultRef = CGBitmapContextCreateImage(globalContext);
UIImage*     resultImage = [UIImage imageWithCGImage:resultRef];

CGContextRestoreGState(globalContext);
UIGraphicsEndImageContext(); 
```

任何人，任何想法？我想不出我没有尝试过的任何事情......

编辑：一个简单的 4*2 图像的结果：

```
 Empty:
0: 0; 0; 0; 16
1: 0; 0; 0; 16
2: 0; 0; 0; 0
3: 0; 0; 0; 0
4: 0; 0; 0; 0
5: 0; 0; 0; 0
6: 0; 0; 0; 0
7: 0; 0; 0; 0

 Bottom drawn:
0: 0; 0; 0; 255
1: 128; 0; 0; 255
2: 128; 128; 0; 255
3: 0; 128; 0; 255
4: 0; 128; 128; 255
5: 0; 0; 128; 255
6: 128; 0; 128; 255
7: 128; 128; 128; 255

 foreground:
0: 0; 0; 0; 7
1: 128; 0; 0; 7
2: 128; 128; 0; 7
3: 0; 128; 0; 7
4: 0; 128; 128; 7
5: 0; 0; 128; 7
6: 128; 0; 128; 7
7: 128; 128; 128; 7

 front drawn:
0: 0; 0; 0; 255
1: 0; 128; 128; 192
2: 128; 128; 0; 0
3: 0; 128; 0; 255
4: 0; 128; 128; 255
5: 0; 0; 128; 255
6: 128; 0; 128; 0 
```

# android - 为什么我不能在工具栏中的 Eclipse 菜单“窗口”中使用“运行 Android lint” 我可以运行它，可以吗？

> ID：10121920
> 
> 赞同：7
> 
> 时间：2012-04-12T10:38:53.027
> 
> 标签：android, eclipse, android-lint

我刚刚为 Eclipse 更新了 SDK 和 ADT，现在有一件事让我很困惑：我不能从菜单“Window”中使用“Run Android Lint”。但我可以从 Eclipse 工具栏运行它，或者在我的项目上单击鼠标右键，然后单击“Android 工具”——“运行 lint”。我不确定这是来自 Android 的错误，还是我通过更新做错了什么。有没有人和我一样的问题？谢谢！

最好的问候，卡特里娜飓风

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-16T22:59:10.607

不要从 Window 运行它，而是在 Project Explorer 中右键单击您的项目，然后从 Android Tools **Run Lint: Check for Common Errors**

请注意，在您执行此操作之前，可能需要通过同一菜单执行“清除 Lint Markers”。

# c# - 为什么是业务逻辑？

> ID：10121924
> 
> 赞同：-4
> 
> 时间：2012-04-12T10:39:07.820
> 
> 标签：c#, sql, architecture, transactions, business-logic

让我们想象一下在网站上执行的任何常见操作。

用户按下按钮后，应用程序应该：

1.  检查是否允许操作的条件（用户权限，某些对象的一致性，关系等）
2.  更新数据库记录
3.  报告

这是业务逻辑层的关注点，因为它写在大量书籍中。实际上，我们首先从 DB 中读取数据，然后将数据写入 DB。如果在我们检查期间任何其他用户/进程更改了数据，我们会将无效结果放入数据库中。似乎这个问题应该是众所周知的，但我仍然找不到好的解决方案。

问题是：为什么我们需要没有机会维护业务事务的业务逻辑层？

你可能会说 TransactionScope。那么，您如何防止读取数据被外部进程更改？如何从业务层升级锁定？如果有可能，那么它不会比在存储过程中进行事务更昂贵吗？

无法将部分逻辑带入数据库 - 只有整体。第 1 部分和第 2 部分必须在同一个事务中实现，此外，必须锁定读取数据，直到进行更新。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:50:13.590

我真的认为你从错误的角度争论这个问题。首先，在您的具体示例中，似乎没有任何迹象表明一个用户的投票变化会使另一个用户影响投票的尝试无效。所以，如果我打开页面，有 200 票投给了该项目，然后我点击了 upvote，我真的不在乎其他 10 个人是否同时做了同样的事情。因此，验证可以由业务层运行，如果结果是投票可以通过，则可以使用单个 SQL 语句以原子方式完成更新（例如 UPDATE Votes SET VoteCount = VoteCount+1 WHERE ID= @ID)，或者带有 UPDLOCK 的选择并更新包装在事务中。ORM 和开发人员采用后一种方法的趋势既不存在也不存在，

现在，如果要求对投票计数的更新实际上使我的投票无效，那么情况就完全不同了。在这种情况下，我们使用乐观或悲观并发是绝对正确的，但这些（显然）不适用于数百人可能同时为同一个项目投票的网站。这里的问题不是实现，而是允许多人处理同一个项目的本质。

因此，总而言之，没有什么能阻止您在数据库之外拥有一个业务层并保持增量原子性。同时，您希望享受将业务逻辑置于数据库之外的好处（这本身就是一篇文章，但我认为这是一个很大的好处）。

# jquery - jsonp跨域请求响应在解析时给出null

> ID：10121925
> 
> 赞同：2
> 
> 时间：2012-04-12T10:39:14.057
> 
> 标签：jquery, json, cross-domain, jsonp

我尝试使用 jquery 发出跨域请求。这就是客户端的样子，

```
<script src="js/jquery-1.6.2.min.js"></script>
<script type="text/javascript">
$(document).ready( function(){
    $.ajax({
        type: 'GET',
        url: "http://www.xserver.com/xdomainhandler.php",
        processData: true,
        data: {
            type:"gotohell"
        },
        dataType: "json",
        success: function (data) {
            myglob=data;
            var repo=JSON.parse(myglob);
            alert(repo.type);
        },
        error : function(XMLHttpRequest, textStatus, errorThrown){
            alert('ends up in error state');

        }
    });
});
</script> 
```

接收此请求的服务器页面代码将如下所示：

```
<?php
header('Access-Control-Allow-Origin: *');  
header('Expires: ' . gmdate('r', 0));
header('Content-type: application/json');
session_cache_limiter('nocache');

$arr = array ('response'=>'success','comment'=>'test comment here','type'=>$_GET['type']);
echo json_encode($arr);
?> 
```

但是当我完成请求/响应过程时，我在“repo”变量中什么也没有。我使用萤火虫检查了响应，它显示了类似的响应，

`{"response":"success","comment":"test comment here","type":"gotohell"}`

我还在它显示的萤火虫的 DOM 面板中 检查了**myglob变量，**

```
Object { response="success", comment="test comment here", type="gotohell"} 
```

但是当我将 myglob 解析为 repo 时，它什么也没显示……我哪里出错了。有人可以帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T10:41:55.740

你不需要解析它，因为 jQuery 会为你解析它，所以避免

```
 var repo=JSON.parse(myglob); 
```

然后打电话

```
 alert(data.type); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:42:10.987

因为您提供`dataType: 'json'`的 jQuery 已经解析了响应 - 再次解析它会导致错误。删除以下行：

```
var repo = JSON.parse(myglob); 
```

# python - 初始化未知长度的numpy数组

> ID：10121926
> 
> 赞同：71
> 
> 时间：2012-04-12T10:39:14.543
> 
> 标签：python, arrays, numpy

我希望能够即时“构建”一个 numpy 数组，我事先不知道这个数组的大小。

例如我想做这样的事情：

```
a= np.array()
for x in y:
     a.append(x) 
```

这将导致 a 包含 x 的所有元素，显然这是一个微不足道的答案。我只是好奇这是否可能？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2012-04-12T11:04:00.850

构建一个 Python 列表并将其转换为 Numpy 数组。每次追加 + O( *n* ) 转换为数组需要分摊 O(1) 时间，总共需要 O( *n* )。

```
 a = []
    for x in y:
        a.append(x)
    a = np.array(a) 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-12T10:57:33.567

你可以这样做：

```
a = np.array([])
for x in y:
    a = np.append(a, x) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-03-27T22:34:05.497

由于 y 是可迭代的，我真的不明白为什么要追加调用：

```
a = np.array(list(y)) 
```

会的，而且速度更快：

```
import timeit

print timeit.timeit('list(s)', 's=set(x for x in xrange(1000))')
# 23.952975494633154

print timeit.timeit("""li=[]
for x in s: li.append(x)""", 's=set(x for x in xrange(1000))')
# 189.3826994248866 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T01:07:00.973

对于后代，我认为这更快：

```
a = np.array([np.array(list()) for _ in y]) 
```

您甚至可以传入一个生成器（即 [] -> ()），在这种情况下，内部列表永远不会完全存储在内存中。

* * *

回应以下评论：

```
>>> import numpy as np
>>> y = range(10)
>>> a = np.array([np.array(list) for _ in y])
>>> a
array([array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object),
       array(<type 'list'>, dtype=object)], dtype=object) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-08-08T21:19:54.620

```
a = np.empty(0)
for x in y:
    a = np.append(a, x) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-02T07:47:25.837

I wrote a small utility function. (most answers above are good. I feel this looks nicer)

```
def np_unknown_cat(acc, arr):
  arrE = np.expand_dims(arr, axis=0)
  if acc is None:
    return arrE
  else:
    return np.concatenate((acc, arrE)) 
```

You can use the above function as the following:

```
acc = None  # accumulator
arr1 = np.ones((3,4))
acc = np_unknown_cat(acc, arr1)
arr2 = np.ones((3,4))
acc = np_unknown_cat(acc, arr2) 
```

# node.js - Node.js——关于 POST 中的字段的问题

> ID：10121927
> 
> 赞同：0
> 
> 时间：2012-04-12T10:39:20.357
> 
> 标签：node.js

我正在查看这个 Gist（尝试使用比平常更难的节点（我知道这仍然很简单：P））：[https ://gist.github.com/833401](https://gist.github.com/833401)

我想知道为什么我们必须指定

```
connection.write('?track=' + this.track); 
```

在末尾？它已经在请求 URL 中建立。这种行为是否特定于 Twitter 的 API，或者这是某种带有 Node 中 POST 请求的 Node 语义？

期待您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T10:50:52.307

它特定于 twitter API。您通常不需要对正常的发布请求执行此类操作。

# java - Ant Java 任务：如何在没有 shell 重定向的情况下将输出输出到控制台和文件 - 始终记录构建输出

> ID：10121929
> 
> 赞同：7
> 
> 时间：2012-04-12T10:39:25.760
> 
> 标签：java, ant

我正在使用 ant 启动 Java 程序。

在程序终止后，我不想“松开”输出。所以我使用属性' `output`'将输出存储在一个文件中。

```
<java classname="..." fork="true" output="....txt"> 
```

不幸的是，我不再有任何控制台输出。**在控制台和**txt 文件中输出输出的好方法是什么。

我正在寻找替代方案

```
ant mytast > myFile.txt 
```

因为我不希望“用户”必须使用外壳重定向“> ..”。. 如果他/她不选择重定向，则输出将丢失。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-12T14:46:14.263

Ant 有办法记录输出。[http://ant.apache.org/manual/Tasks/recorder.html](http://ant.apache.org/manual/Tasks/recorder.html)。

> 记录器是当前构建过程的侦听器，将输出记录到文件中。
> 
> 可以同时存在多个记录器。每个记录器都与一个文件相关联。文件名用作记录器的唯一标识符。第一次使用未使用的文件名调用记录器任务将创建一个记录器（使用提供的参数）并将其添加到构建的侦听器中。使用此文件名对记录器任务的所有后续调用都将修改该记录器状态（是否记录）或其他属性（如日志记录级别）。

看起来满足你的需要。

```
 <compile >
        <record name="log.txt" action="start"/>
        <javac ...
        <record name="log.txt" action="stop"/>
    <compile/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T10:49:32.697

如果程序写入一个文件描述符（例如标准输出），您可以将其仅重定向到一个位置（因此要么是控制台，要么是文件，而不是两者）。

要实现多重重定向，您有两种选择：

*   使用外部方法复制该文件描述符（例如 tee 命令正是这样做的——即使对于 Windows 也有实现：请参见[此处](http://code.google.com/p/wintee/)和[此处](http://www.chipstips.com/?p=129)。
*   将相同的信息从java程序中写入两个不同的输出（例如标准输出和标准错误），然后您可以使用传统方式重定向一个，另一个转到控制台

我不推荐第二种方法，因为它会使您的代码变得混乱，并且您通常无法完全控制所写的标准错误（想想对 3rd 方函数的调用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-08T07:19:02.670

您可以使用记录任务。我认为这将满足您的需求。

[https://ant.apache.org/manual/Tasks/recorder.html](https://ant.apache.org/manual/Tasks/recorder.html)

# android - 尽管 ListView 的 getCount() 工作正常，但 ListView 不显示

> ID：10121932
> 
> 赞同：0
> 
> 时间：2012-04-12T10:39:39.590
> 
> 标签：android, listview, sqlite

列表视图没有出现的这个问题似乎很奇怪。首先让我发布我在活动中涉及的功能代码：受保护的ListView mListView；

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    this.setContentView(R.layout.result);       
    mListView = (ListView)this.findViewById(R.id.wrdList);

    handleIntent(getIntent());
}

private void handleIntent(Intent intent) {
    if (Intent.ACTION_SEARCH.equals(intent.getAction())) {
        String word = intent.getStringExtra(SearchManager.QUERY);
        //use the query to search your data somehow

        //Columns to be selected in database
        String sel[] = {"_id", "wort", DictDBHelper.get2LtrLang()};
        Cursor SrhRet = mSrhHelper.searchWord(word, sel);
        //Columns to be showed in ListView
        String col[] = {"wort", DictDBHelper.get2LtrLang()};
        showList(SrhRet, col);
        SrhRet.close();
    } else if (Intent.ACTION_VIEW.equals(intent.getAction())) {

    }
}

/*
 * Set the TextView to print how many words are found in database 
 */
protected void setCount(int count) {
    TextView tv = (TextView)this.findViewById(R.id.wrdCount);
    tv.setText(String.valueOf(count));
}

/*
 * Set the adapter to show the list
 * First parameter specifies the cursor of rows to be shown in ListView
 * Second one specifies columns
 */
protected void showList(final Cursor SrhRet, String[] from) {

    int[] to = new int[]{R.id.entry, R.id.detail};

    SimpleCursorAdapter adapter = new SimpleCursorAdapter(this, 
            R.layout.listitem, SrhRet, from, to, 
            CursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER);
    mListView.setAdapter(adapter);
    setCount(mListView.getCount());

    mListView.setOnItemClickListener(new OnItemClickListener(){         
        @Override
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            // Build the Intent used to open WordActivity with a specific word Uri
            Intent wordIntent = new Intent(getApplicationContext(), WordActivity.class);
            Uri data = Uri.withAppendedPath(DictionaryProvider.ENTRY_CONTENT_URI,
                                            String.valueOf(id));
            wordIntent.setData(data);
            //Required by the update 
            SrhRet.close();
            mSrhHelper.updateHist(id);
            startActivity(wordIntent);
        }
    });
} 
```

这些是处理可搜索输入的函数。我已经追踪了所有涉及的变量，但几乎没有发现任何异常。但是，每次我尝试此功能时，TextView 都会显示 ListView 应包含的正确数字！这些函数以前工作得很好，我有另一个从这个派生的活动调用这些工作得很好的函数。

我使用 listitem.xml 作为 ListView 项目中的内容：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >
<TextView 
    android:id="@+id/entry"
    android:layout_height="wrap_content"
    android:layout_width="match_parent"
    android:textSize="17dp" />   
<TextView 
    android:id="@+id/detail"
    android:layout_height="wrap_content"
    android:layout_width="match_parent" /> 
```

还有我的 result.xml。我已经仔细检查了方向。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical">
<TextView 
    android:id="@+id/wrdCount"
    android:layout_height="wrap_content"
    android:layout_width="match_parent" />
<ListView
    android:id="@+id/wrdList"
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:layout_weight="1" />
</LinearLayout> 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:34:36.047

我认为您的问题是 this :`SrhRet.close();`在您的`handleIntent(Intent intent)`方法中。

请尝试在`onDestroy()`活动的方法中关闭光标。

# c# - Log4Net 是否可以附加到结构正确的 XML 文档？

> ID：10121933
> 
> 赞同：3
> 
> 时间：2012-04-12T10:39:43.047
> 
> 标签：c#, xml, log4net

我遇到的问题是它只是将 XML 标记写入文件，但它不是格式正确的 XML 文件。

该文件只是按如下方式填充：

```
<LogEntry><Date>12/04/2012 11:16:26</Date><Message>An error message.</Message><StackTrace>..StackTrace omitted..</StackTrace></LogEntry>
<LogEntry><Date>12/04/2012 11:21:27</Date><Message>Another error message.</Message><StackTrace>..StackTrace omitted..</StackTrace></LogEntry>
<LogEntry><Date>12/04/2012 11:21:37</Date><Message>More messages.</Message><StackTrace>..StackTrace omitted..</StackTrace></LogEntry> 
```

我有什么方法可以附加到结构正确的 XML 文档中吗？

理想情况下，它会如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Logs>
    <LogEntry><Date>12/04/2012 11:16:26</Date><Message>An error message.</Message><StackTrace>..StackTrace omitted..</StackTrace></LogEntry>
    <LogEntry><Date>12/04/2012 11:21:27</Date><Message>Another error message.</Message><StackTrace>..StackTrace omitted..</StackTrace></LogEntry>
    <LogEntry><Date>12/04/2012 11:21:37</Date><Message>More messages.</Message><StackTrace>..StackTrace omitted..</StackTrace></LogEntry>
</Logs> 
```

我正在使用的代码是：

```
public class MyXmlLayout : XmlLayoutBase
{
    protected override void FormatXml(XmlWriter writer, LoggingEvent loggingEvent)
    {
        writer.WriteStartElement("LogEntry");

        writer.WriteStartElement("Date");
        writer.WriteString(loggingEvent.TimeStamp.ToString(CultureInfo.CurrentCulture));
        writer.WriteEndElement();

        writer.WriteStartElement("Message");
        writer.WriteString(loggingEvent.RenderedMessage);
        writer.WriteEndElement();

        writer.WriteStartElement("StackTrace");
        writer.WriteString(loggingEvent.ExceptionObject.StackTrace);
        writer.WriteEndElement();

        if (loggingEvent.ExceptionObject.InnerException != null)
        {
            writer.WriteStartElement("InnerException");
            writer.WriteString(loggingEvent.ExceptionObject.InnerException.ToString());
            writer.WriteEndElement();
        }

        writer.WriteEndElement();
    }
} 
```

对此的配置是：

```
<log4net>
  <appender name="LogFileAppender" type="log4net.Appender.RollingFileAppender" >
    <param name="File" value="Logs/log.xml" />
    <param name="AppendToFile" value="true" />
    <rollingStyle value="Size" />
    <maxSizeRollBackups value="10" />
    <maximumFileSize value="10MB" />
    <staticLogFileName value="true" />
    <layout type="MyNamespace.MyXmlLayout" />
  </appender>

  <root>
    <level value="DEBUG" />
    <appender-ref ref="LogFileAppender" />
  </root>
</log4net> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T12:19:10.837

该类`XmlLayoutBase`不支持您要查找的内容。原因很简单：如果它必须确保 xml 始终格式正确，那么每当向文件中添加条目时，它就需要覆盖关闭的根节点。简单地将 xml 片段附加到文件中更容易、更快捷。

# .net - .NET 进程内存使用 = 5x CLR 堆内存？

> ID：10121943
> 
> 赞同：8
> 
> 时间：2012-04-12T10:40:11.267
> 
> 标签：.net, memory, process, clr, heap-memory

我正在尝试解决一些内存使用问题。总的来说，我的应用程序收集了一些数据值并使用 C1 WPF 图表和数据网格将它们可视化，最终将所有内容放入 PDF 报告中。

使用 YourKit 分析我的进程我面临的情况是，CLR 堆大小约为 120MB（这很好），而进程内存大小约为 580MB。这几乎是我的实际 CLR 堆大小的内存消耗的 5 倍。我的 CLR 峰值大小为 220MB，而进程内存分配为 710MB。

我很清楚我的对象堆、堆栈等需要一些开销。在 Java JVM 中，我习惯的典型因素约为 1.5 倍。

如何解释这种过多的内存开销？这些进程是否只是分配空闲的备用堆空间？如果是，这是否解释了 710MB 与 220MB？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-22T14:54:25.970

这里有几个额外的说明。尽管我不确定您所说的“CLR 堆大小”是什么意思。根据您使用的 .NET 运行时，CLR 使用 8 或 9 个不同的堆 - 因此您在堆大小与 VM 大小中看到的内存说明了*一些*差异：

1.  Loader Heap：包含 CLR 结构和类型系统
2.  高频堆：statics, MethodTables, FieldDescs, interface map
3.  低频堆：EEClass、ClassLoader 和查找表
4.  存根堆：用于 CAS、COM 包装器、P/Invoke 的存根
5.  大对象堆：需要超过 85k 字节的内存分配
6.  GC Heap：用户分配给应用程序私有的堆内存
7.  JIT 代码堆：由 mscoreee（执行引擎）和用于托管代码的 JIT 编译器分配的内存
8.  进程/基堆：互操作/非托管分配、本机内存等
9.  **在 .NET 5 中添加**：[固定对象堆 (POH)](https://devblogs.microsoft.com/dotnet/internals-of-the-poh/)

可能导致过多内存使用的另外两个项目是内存碎片（主要发生在 LOH 或大型对象堆上）或大量线程。

内存碎片的原因有很多，排除这种情况的最佳方法是使用 WinDbg 分析 GC 堆上每个段的段大小。

就大量线程而言，您为应用程序使用的每个线程分配了 1MB（对于 x86 进程）或 4MB（对于 x64 进程）的堆栈空间。该内存被放置在进程/基堆中。因此，如果您有 100 个线程，则最多可以额外使用 100MB/400MB 的内存。

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T12:58:31.363

如果托管堆的总大小明显小于应用程序使用的私有字节，则很可能您正在分配非托管内存并且（可能）没有正确处理它。实现 IDisposable 的图形对象、流和其他对象需要`Dispose()`在它们超出范围之前调用它们的方法或将它们放在`using(){}`语句中，以便清理任何非托管资源。使用像 ANTS Memory Profiler 这样的工具可以向您展示您的内存是如何分配的以及哪些对象实现了 IDisposable。

# emacs - 将 Emacs 变量传递给 minibuffer shell 命令

> ID：10121944
> 
> 赞同：8
> 
> 时间：2012-04-12T10:40:17.617
> 
> 标签：emacs, emacs23

我可以通过点击快速运行 shell 命令`M-!`。我想做的一件事是对当前文件执行 shell 快速操作。一个例子是通过 perforce 检出文件：

`M-!` `p4 edit buffer-file-name` `RET`

（是的，有 perforce 集成，但我对 minishell/变量问题而不是特定的工作流程更感兴趣）

当然，`buffer-file-name`在命令发送到 shell 之前不会评估变量。

有没有一种简单的即时方式来做到这一点？还是我必须推出自定义 elisp 函数？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-03T10:01:13.713

当前的 Emacs 似乎内置了一些东西来达到预期的效果，在`M-!`( `shell-command`) 按下后`<down>`，您将在提示符上获得当前正在访问的文件名。现在您可以对其进行编辑以添加要在其上运行的命令。

其中`dired-mode`将为您提供光标当前所在的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-12T14:11:02.457

确实使用 Cu M-: 几乎是正确的。我不太确定使用`shell-quote-argument`in`eval-to-shell-argument`因为它仅适用于字符串，因此无法用于`eval-to-shell-argument`插入数字或符号。您可以尝试以下方法：

```
(defun sm-minibuffer-insert-val (exp)
  (interactive
   (list (let ((enable-recursive-minibuffers t))
           (read-from-minibuffer "Insert: "
                                 nil read-expression-map t
                                 'read-expression-history))))
    (let ((val (with-selected-window (minibuffer-selected-window)
                 (eval exp)))
          (standard-output (current-buffer)))
      (prin1 val))) 
```

然后在你的 minibuffer 中绑定这个函数`(define-key minibuffer-local-map [?\M-:] 'sm-minibuffer-insert-val)`。当然，如果您只想插入缓冲区文件名，那么您`execute-shell-command-on-buffer`就更简单了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-12T14:07:31.963

我*确实*推出了自己的 elisp 函数，它看起来像这样：

```
(defun execute-shell-command-on-buffer (shell-command-text)
    (interactive "MShell command:")
    (shell-command (format shell-command-text (shell-quote-argument buffer-file-name)))
    ) 
```

[https://gist.github.com/2367513](https://gist.github.com/2367513)

我将它绑定到`M-"`，所以现在我的示例可以通过以下方式完成：

`M-"``p4 edit %s``RET`

我不会接受这个作为答案，因为我确实要求不需要函数的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T12:32:14.567

你不能用 来做到这一点`M-!`，但你可以从 minibuffer 中评估任意 elisp，所以编写一个函数并不是绝对必要的：

`M-:` `(shell-command (format "p4 edit %s" (shell-quote-argument buffer-file-name)))` `RET`

但是，在这种情况下，我认为`eshell`您要使用的是：

`M-x` `eshell-command` `RET` `p4 edit (eval buffer-file-name)` `RET`

**编辑：**不幸的是，这不起作用，因为在`*eshell cmd*`评估时选择了缓冲区。一种解决方案是：

`M-x` `eshell-command` `RET` `p4 edit (eval buffer-file-name (other-buffer nil t))` `RET`

（不太优雅，抱歉。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-12T12:37:54.187

您可以使用`C-u M-:`(`eval-expression`带有通用前缀参数) 来评估任何 Lisp 表达式并将其值插入当前缓冲区中的点（包括迷你缓冲区，只要您`enable-recursive-minibuffers`设置为非`nil`值）。

在您的示例中：`C-u M-: buffer-file-name RET`.

请注意，表达式的结果以 Lisp 形式打印：也就是说，以这样一种方式引用，以便后续调用`read`将构造一个`equal`Lisp 值。对于字符串，这意味着用双引号括起来，这可能会被劣质 shell 解释为您所期望的。但是，您可能会遇到包含特殊字符的字符串的问题，这需要 Elisp 和 shell 进行不同的转义。

更正确的方法使用`shell-quote-argument`，如 phils 的解决方案。这是一个快速定义，它读取 Lisp 表达式并将其值插入到点作为正确引用的 shell 单词：

```
(defun eval-to-shell-argument (form)
  (interactive "XEval: ")
  (insert (shell-quote-argument form))) 
```

通过使用 a`"X"`作为 的参数，读取和评估步骤会自动发生`interactive`。

**编辑添加**：正如@tenpn 所指出的，上述解决方案不适用于插入缓冲区局部变量，例如弹出的小`buffer-file-name`缓冲区（更准确地说，它插入了小缓冲区的缓冲区局部值，这不太可能`M-!`有用）。这是一个似乎可行的修订版。如果 minibuffer 处于活动状态，它会使先前选择的窗口的缓冲区在读取和评估表达式时暂时处于活动状态。

**最终编辑**：从@Stefan 的回答中，我看到我应该习惯于`(minibuffer-selected-window)`找到先前选择的窗口。我还添加了一个`(format "%s" ..)`允许插入非字符串值，同时仍然引用字符串中的特殊字符。这是最终版本：

```
(defun eval-to-shell-argument ()
  (interactive)
  (let* ((buffer
          (if (minibufferp)
              (window-buffer (minibuffer-selected-window))
            (current-buffer)))
         (result
          (with-current-buffer buffer
            (eval-minibuffer "Eval: "))))
    (insert (shell-quote-argument (format "%s" result))))) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-12T16:55:15.873

每个人似乎都在滚动他们自己的版本，所以这是我的——它将替换当前文件名或标记的 dired-files 或当前的 dired 文件，只要 a`%`在 shell 命令中。它遵循相同的约定，`M-!`因此我将其绑定到该约定。

```
(defun my-shell-command (command &optional output-buffer error-buffer)
  "Run a shell command with the current file (or marked dired files).
In the shell command, the file(s) will be substituted wherever a '%' is."
  (interactive (list (read-from-minibuffer "Shell command: "
                                           nil nil nil 'shell-command-history)
                     current-prefix-arg
                     shell-command-default-error-buffer))
  (cond ((buffer-file-name)
         (setq command (replace-regexp-in-string "%" (buffer-file-name) command nil t)))
        ((and (equal major-mode 'dired-mode) (save-excursion (dired-move-to-filename)))
         (setq command (replace-regexp-in-string "%" (mapconcat 'identity (dired-get-marked-files) " ") command nil t))))
  (shell-command command output-buffer error-buffer)) 
```

# c# - 具有更高权限的 .NET 启动进程

> ID：10121947
> 
> 赞同：8
> 
> 时间：2012-04-12T10:40:30.467
> 
> 标签：c#, .net, process, admin-rights

我正在尝试通过 C# 应用程序执行具有管理员权限的程序，该程序仅使用用户权限调用。

代码

```
 ProcessStartInfo psi;
        try
        {
            psi = new ProcessStartInfo(@"WINZIP32.EXE");

            psi.UseShellExecute = false;
            SecureString pw = new SecureString();
            pw.AppendChar('p');
            pw.AppendChar('a');
            pw.AppendChar('s');
            pw.AppendChar('s');   
            pw.AppendChar('w');
            pw.AppendChar('o');
            pw.AppendChar('r');
            pw.AppendChar('d');
            psi.Password = pw;
            psi.UserName = "administrator";

            Process.Start(psi);
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        } 
```

它确实启动了 winzip，但只有用户权限。是不是我做错了什么，或者甚至可以启动具有更高权限的进程？

谢谢你！

编辑：这是问题背后的原因，也许它有助于理解我真正需要的东西。

> 例如，我使用 winzip 来大致了解我的代码有什么问题。实际问题是，我们公司使用一个程序的两个版本。但在您启动任何版本之前，您需要使用 regsvr32（具有管理员权限）导入一个 dll 文件。现在我想编写一个程序，让用户选择版本，导入 dll 并启动正确的应用程序。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-12T10:55:46.140

您需要将[ProcessStartInfo.UseShellExecute](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.useshellexecute.aspx)设置为`true`并将[ProcessStartInfo.Verb](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.verb.aspx)设置为`runas`：

```
Process process = null;
ProcessStartInfo processStartInfo = new ProcessStartInfo();

processStartInfo.FileName = "WINZIP32.EXE";

processStartInfo.Verb = "runas";
processStartInfo.WindowStyle = ProcessWindowStyle.Normal;
processStartInfo.UseShellExecute = true;

process = Process.Start(processStartInfo); 
```

这将导致应用程序以管理员身份运行。然而，UAC 会提示用户确认。如果这不是可取的，那么您需要添加一个[清单](http://msdn.microsoft.com/en-us/library/bb756929.aspx)以永久提升主机进程特权。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-12T11:05:15.577

[您可以使用CreateProcessAsUser 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682429%28v=vs.85%29.aspx)(Win32 API)作为另一个用户（甚至是管理员）运行进程。CreateProcessAsUser 接受用户令牌作为第一个参数，即模拟令牌。

您必须使用 DLLImport 从 Windows DLL 加载函数。

看看我在我的一个项目中使用的这个示例实现：

```
 [StructLayout(LayoutKind.Sequential)]
internal struct PROCESS_INFORMATION
{
    public IntPtr hProcess;
    public IntPtr hThread;
    public uint dwProcessId;
    public uint dwThreadId;
}

[StructLayout(LayoutKind.Sequential)]
internal struct SECURITY_ATTRIBUTES
{
    public uint nLength;
    public IntPtr lpSecurityDescriptor;
    public bool bInheritHandle;
}

[StructLayout(LayoutKind.Sequential)]
public struct STARTUPINFO
{
    public uint cb;
    public string lpReserved;
    public string lpDesktop;
    public string lpTitle;
    public uint dwX;
    public uint dwY;
    public uint dwXSize;
    public uint dwYSize;
    public uint dwXCountChars;
    public uint dwYCountChars;
    public uint dwFillAttribute;
    public uint dwFlags;
    public short wShowWindow;
    public short cbReserved2;
    public IntPtr lpReserved2;
    public IntPtr hStdInput;
    public IntPtr hStdOutput;
    public IntPtr hStdError;

}

internal enum SECURITY_IMPERSONATION_LEVEL
{
    SecurityAnonymous,
    SecurityIdentification,
    SecurityImpersonation,
    SecurityDelegation
}

internal enum TOKEN_TYPE
{
    TokenPrimary = 1,
    TokenImpersonation
}

public class ProcessAsUser
{

    [DllImport("advapi32.dll", SetLastError = true)]
    private static extern bool CreateProcessAsUser(
    IntPtr hToken,
    string lpApplicationName,
    string lpCommandLine,
    ref SECURITY_ATTRIBUTES lpProcessAttributes,
    ref SECURITY_ATTRIBUTES lpThreadAttributes,
    bool bInheritHandles,
    uint dwCreationFlags,
    IntPtr lpEnvironment,
    string lpCurrentDirectory,
    ref STARTUPINFO lpStartupInfo,
    out PROCESS_INFORMATION lpProcessInformation);

    [DllImport("advapi32.dll", EntryPoint = "DuplicateTokenEx", SetLastError = true)]
    private static extern bool DuplicateTokenEx(
    IntPtr hExistingToken,
    uint dwDesiredAccess,
    ref SECURITY_ATTRIBUTES lpThreadAttributes,
    Int32 ImpersonationLevel,
    Int32 dwTokenType,
    ref IntPtr phNewToken);

    [DllImport("advapi32.dll", SetLastError = true)]
    private static extern bool OpenProcessToken(
    IntPtr ProcessHandle,
    UInt32 DesiredAccess,
    ref IntPtr TokenHandle);

    [DllImport("userenv.dll", SetLastError = true)]
    private static extern bool CreateEnvironmentBlock(
    ref IntPtr lpEnvironment,
    IntPtr hToken,
    bool bInherit);

    [DllImport("userenv.dll", SetLastError = true)]
    private static extern bool DestroyEnvironmentBlock(
    IntPtr lpEnvironment);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool CloseHandle(
    IntPtr hObject);

    private const short SW_SHOW = 5;
    private const uint TOKEN_QUERY = 0x0008;
    private const uint TOKEN_DUPLICATE = 0x0002;
    private const uint TOKEN_ASSIGN_PRIMARY = 0x0001;
    private const int GENERIC_ALL_ACCESS = 0x10000000;
    private const int STARTF_USESHOWWINDOW = 0x00000001;
    private const int STARTF_FORCEONFEEDBACK = 0x00000040;
    private const uint CREATE_UNICODE_ENVIRONMENT = 0x00000400;
    private const int STARTF_RUNFULLSCREEN = 0x00000020;

    private static bool LaunchProcessAsUser(string cmdLine, IntPtr token, IntPtr envBlock)
    {
        bool result = false;

        PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
        SECURITY_ATTRIBUTES saProcess = new SECURITY_ATTRIBUTES();
        SECURITY_ATTRIBUTES saThread = new SECURITY_ATTRIBUTES();
        saProcess.nLength = (uint)Marshal.SizeOf(saProcess);
        saThread.nLength = (uint)Marshal.SizeOf(saThread);

        STARTUPINFO si = new STARTUPINFO();
        si.cb = (uint)Marshal.SizeOf(si);

        //if this member is NULL, the new process inherits the desktop
        //and window station of its parent process. If this member is
        //an empty string, the process does not inherit the desktop and
        //window station of its parent process; instead, the system
        //determines if a new desktop and window station need to be created.
        //If the impersonated user already has a desktop, the system uses the
        //existing desktop.

        si.lpDesktop = @"WinSta0\Default"; //Modify as needed
        si.dwFlags = STARTF_USESHOWWINDOW | STARTF_FORCEONFEEDBACK;
        si.wShowWindow = SW_SHOW;

        //Set other si properties as required.

        result = CreateProcessAsUser(
        token,
        null,
        cmdLine,
        ref saProcess,
        ref saThread,
        false,
        CREATE_UNICODE_ENVIRONMENT,
        envBlock,
        null,
        ref si,
        out pi);

        if (result == false)
        {
            int error = Marshal.GetLastWin32Error();
            string message = String.Format("CreateProcessAsUser Error: {0}", error);
            Debug.WriteLine(message);

        }

        return result;
    }

    /// <summary>
    /// LaunchProcess As User Overloaded for Window Mode 
    /// </summary>
    /// <param name="cmdLine"></param>
    /// <param name="token"></param>
    /// <param name="envBlock"></param>
    /// <param name="WindowMode"></param>
    /// <returns></returns>
    private static bool LaunchProcessAsUser(string cmdLine, IntPtr token, IntPtr envBlock,uint WindowMode)
    {
        bool result = false;

        PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
        SECURITY_ATTRIBUTES saProcess = new SECURITY_ATTRIBUTES();
        SECURITY_ATTRIBUTES saThread = new SECURITY_ATTRIBUTES();
        saProcess.nLength = (uint)Marshal.SizeOf(saProcess);
        saThread.nLength = (uint)Marshal.SizeOf(saThread);

        STARTUPINFO si = new STARTUPINFO();
        si.cb = (uint)Marshal.SizeOf(si);

        //if this member is NULL, the new process inherits the desktop
        //and window station of its parent process. If this member is
        //an empty string, the process does not inherit the desktop and
        //window station of its parent process; instead, the system
        //determines if a new desktop and window station need to be created.
        //If the impersonated user already has a desktop, the system uses the
        //existing desktop.

        si.lpDesktop = @"WinSta0\Default"; //Default Vista/7 Desktop Session
        si.dwFlags = STARTF_USESHOWWINDOW | STARTF_FORCEONFEEDBACK;

        //Check the Startup Mode of the Process 
        if (WindowMode == 1)
            si.wShowWindow = SW_SHOW;
        else if (WindowMode == 2)
        { //Do Nothing
        }
        else if (WindowMode == 3)
            si.wShowWindow = 0; //Hide Window 
        else if (WindowMode == 4)
            si.wShowWindow = 3; //Maximize Window
        else if (WindowMode == 5)
            si.wShowWindow = 6; //Minimize Window
        else
            si.wShowWindow = SW_SHOW;

        //Set other si properties as required.
        result = CreateProcessAsUser(
        token,
        null,
        cmdLine,
        ref saProcess,
        ref saThread,
        false,
        CREATE_UNICODE_ENVIRONMENT,
        envBlock,
        null,
        ref si,
        out pi);

        if (result == false)
        {
            int error = Marshal.GetLastWin32Error();
            string message = String.Format("CreateProcessAsUser Error: {0}", error);
            Debug.WriteLine(message);

        }

        return result;
    }

    private static IntPtr GetPrimaryToken(int processId)
    {
        IntPtr token = IntPtr.Zero;
        IntPtr primaryToken = IntPtr.Zero;
        bool retVal = false;
        Process p = null;

        try
        {
            p = Process.GetProcessById(processId);
        }

        catch (ArgumentException)
        {

            string details = String.Format("ProcessID {0} Not Available", processId);
            Debug.WriteLine(details);
            throw;
        }

        //Gets impersonation token
        retVal = OpenProcessToken(p.Handle, TOKEN_DUPLICATE, ref token);
        if (retVal == true)
        {

            SECURITY_ATTRIBUTES sa = new SECURITY_ATTRIBUTES();
            sa.nLength = (uint)Marshal.SizeOf(sa);

            //Convert the impersonation token into Primary token
            retVal = DuplicateTokenEx(
            token,
            TOKEN_ASSIGN_PRIMARY | TOKEN_DUPLICATE | TOKEN_QUERY,
            ref sa,
            (int)SECURITY_IMPERSONATION_LEVEL.SecurityIdentification,
            (int)TOKEN_TYPE.TokenPrimary,
            ref primaryToken);

            //Close the Token that was previously opened.
            CloseHandle(token);
            if (retVal == false)
            {
                string message = String.Format("DuplicateTokenEx Error: {0}", Marshal.GetLastWin32Error());
                Debug.WriteLine(message);
            }

        }

        else
        {

            string message = String.Format("OpenProcessToken Error: {0}", Marshal.GetLastWin32Error());
            Debug.WriteLine(message);

        }

        //We'll Close this token after it is used.
        return primaryToken;

    }

    private static IntPtr GetEnvironmentBlock(IntPtr token)
    {

        IntPtr envBlock = IntPtr.Zero;
        bool retVal = CreateEnvironmentBlock(ref envBlock, token, false);
        if (retVal == false)
        {

            //Environment Block, things like common paths to My Documents etc.
            //Will not be created if "false"
            //It should not adversley affect CreateProcessAsUser.

            string message = String.Format("CreateEnvironmentBlock Error: {0}", Marshal.GetLastWin32Error());
            Debug.WriteLine(message);

        }
        return envBlock;
    }

    public static bool Launch(string appCmdLine /*,int processId*/)
    {

        bool ret = false;

        //Either specify the processID explicitly
        //Or try to get it from a process owned by the user.
        //In this case assuming there is only one explorer.exe

        Process[] ps = Process.GetProcessesByName("explorer");
        int processId = -1;//=processId
        if (ps.Length > 0)
        {
            processId = ps[0].Id;
        }

        if (processId > 1)
        {
            IntPtr token = GetPrimaryToken(processId);

            if (token != IntPtr.Zero)
            {

                IntPtr envBlock = GetEnvironmentBlock(token);
                ret = LaunchProcessAsUser(appCmdLine, token, envBlock);
                if (envBlock != IntPtr.Zero)
                    DestroyEnvironmentBlock(envBlock);

                CloseHandle(token);
            }

        }
        return ret;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T11:21:35.783

参考：
[如何在 C# 中以管理员模式启动进程以](https://stackoverflow.com/questions/2532769/how-to-start-a-process-as-administrator-mode-in-c-sharp)
[编程方式提升进程权限？](https://stackoverflow.com/questions/133379/elevating-process-privilege-programatically)

```
 var psi = new ProcessStartInfo
    {
        FileName = "notepad",
        UserName = "admin",
        Domain = "",
        Password = pass,
        UseShellExecute = true,
        RedirectStandardOutput = true,
        RedirectStandardError = true,
        Verb = "runas";
    };
    Process.Start(psi); 
```

//

```
var pass = new SecureString();
pass.AppendChar('s');
pass.AppendChar('e');
pass.AppendChar('c');
pass.AppendChar('r');
pass.AppendChar('e');
pass.AppendChar('t');
Process.Start("notepad", "admin", pass, ""); 
```

**//Vista或更高检查**

```
if (System.Environment.OSVersion.Version.Major >= 6)
{
   p.StartInfo.Verb = "runas";
} 
```

**参考：** [如何以管理员权限运行/启动新进程？](http://forums.asp.net/t/1303870.aspx/1) ASP.net 论坛

> 另一种方法是模拟管理员用户。您可以通过调用 Logon 函数并模拟您将获得其令牌的用户来执行此操作。要在代码中模拟用户，请查看： [WindowsImpersonationContext 类](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx) 。使用 GetCurrentUser 检查 [http://www.csharpfriends.com/Forums/ShowPost.aspx?PostID=31611](http://www.csharpfriends.com/Forums/ShowPost.aspx?PostID=31611)查看模拟是否成功。

代码片段：

```
System.Diagnostics.Process process = null;
System.Diagnostics.ProcessStartInfo processStartInfo;

processStartInfo = new System.Diagnostics.ProcessStartInfo();

processStartInfo.FileName = "regedit.exe";

if (System.Environment.OSVersion.Version.Major >= 6)  // Windows Vista or higher
{
   processStartInfo.Verb = "runas";
}
else
{
   // No need to prompt to run as admin
}

processStartInfo.Arguments = "";
processStartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Normal;
processStartInfo.UseShellExecute = true;

try
{
   process = System.Diagnostics.Process.Start(processStartInfo);
}
catch (Exception ex)
{
   MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
}
finally
{
   if (process != null)
   {
      process.Dispose();
   }
} 
```

**//用管理员登录试试这个，我还没有测试过..**

```
[DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
        public static extern bool LogonUser(String lpszUsername, String lpszDomain, String lpszPassword,
            int dwLogonType, int dwLogonProvider, out SafeTokenHandle phToken);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
        public extern static bool CloseHandle(IntPtr handle);

        // Test harness.
        // If you incorporate this code into a DLL, be sure to demand FullTrust.
        [PermissionSetAttribute(SecurityAction.Demand, Name = "FullTrust")]
        private void button1_Click(object sender, EventArgs e)
        {
            SafeTokenHandle safeTokenHandle;
            const int LOGON32_PROVIDER_DEFAULT = 0;
            //This parameter causes LogonUser to create a primary token.
            const int LOGON32_LOGON_INTERACTIVE = 2;
            bool returnValue = LogonUser("administrator", "", "password",
                LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT,
                out safeTokenHandle);

            Console.WriteLine("LogonUser called.");

            if (false == returnValue)
            {
                int ret = Marshal.GetLastWin32Error();
                Console.WriteLine("LogonUser failed with error code : {0}", ret);
                throw new System.ComponentModel.Win32Exception(ret);
            }
            using (safeTokenHandle)
            {
                Console.WriteLine("Did LogonUser Succeed? " + (returnValue ? "Yes" : "No"));
                Console.WriteLine("Value of Windows NT token: " + safeTokenHandle);

                // Check the identity.
                Console.WriteLine("Before impersonation: "
                    + WindowsIdentity.GetCurrent().Name);
                // Use the token handle returned by LogonUser.
                WindowsIdentity newId = new WindowsIdentity(safeTokenHandle.DangerousGetHandle());
                using (WindowsImpersonationContext impersonatedUser = newId.Impersonate())
                {
                    System.Diagnostics.Process process = null;
                    System.Diagnostics.ProcessStartInfo processStartInfo;

                    processStartInfo = new System.Diagnostics.ProcessStartInfo();

                    processStartInfo.FileName = "regedit.exe";

                    //if (System.Environment.OSVersion.Version.Major >= 6)  // Windows Vista or higher
                    //{
                    //    processStartInfo.Verb = "runas";
                    //}
                    //else
                    //{
                    //    // No need to prompt to run as admin
                    //}

                    processStartInfo.Arguments = "";
                    processStartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Normal;
                    processStartInfo.UseShellExecute = true;

                    try
                    {
                        process = System.Diagnostics.Process.Start(processStartInfo);
                    }
                    catch (Exception ex)
                    {
                        MessageBox.Show(ex.Message, "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    }
                    finally
                    {
                        if (process != null)
                        {
                            process.Dispose();
                        }
                    }

                    // Check the identity.
                    Console.WriteLine("After impersonation: "
                        + WindowsIdentity.GetCurrent().Name);
                }
                // Releasing the context object stops the impersonation
                // Check the identity.
                Console.WriteLine("After closing the context: " + WindowsIdentity.GetCurrent().Name);
            }
        } 
```

# c# - 获取 dll 中的根配置文件路径

> ID：10121949
> 
> 赞同：1
> 
> 时间：2012-04-12T10:40:33.747
> 
> 标签：c#, asp.net, windows

我有一个（网站|windows）应用程序和一个dll（类库）。我想获取 dll 中的根（网站|windows）配置文件路径。

我用不同的 assembly.get 尝试了 ConfigurationManager.OpenExeConfiguration，但它们总是给出 dll 配置路径。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T12:35:15.417

嗨发现了这个并且效果很好

```
 Configuration config;

        if (System.Web.HttpContext.Current != null &&
            System.Web.HttpContext.Current.Request.PhysicalPath.Equals(String.Empty) == false)
        {
            config = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(HttpRuntime.AppDomainAppVirtualPath);
        }
        else
        {
            config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);
        } 
```

基本上，如果它是一个网站，它将获得 web.config，如果它是一个 Windows 应用程序，它将获得 app.exe.config

# iphone - 如何将数据库从一台 iPhone 设备转移到另一台设备并连接到新数据库？

> ID：10121956
> 
> 赞同：1
> 
> 时间：2012-04-12T10:41:02.483
> 
> 标签：iphone, ios, xcode

我有一个使用 Core Data 的应用程序。我有两个设备 A 和 B。我需要提供将我的数据库从设备 A 复制到设备 B 的可能性（如果设备 B 愿意，可以使用这些数据库）。

1）现在我一开始就用Core Data创建了一个应用程序。Xcode 自动将 app.xcdatamodeld 文件插入到我的应用程序包中，并将代码添加到 AppDelegate 文件中以连接它

问题：如何使用 Documents 文件夹中的 app.xcdatamodeld？（如果我从其他设备复制文件，该文件将位于 Documents 文件夹中。）我应该更改哪些设置和代码才能实现这一点？

2) 将 app.xcdatamodeld 文件从 A 设备的 Documents 文件夹传输到 B 设备的 Documents 文件夹的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T11:23:00.120

您可以在任何地方使用模型文件，只需在设置时进行设置`NSManagedObjectModel`：

```
// Create a path pointing at your model in the Documents folder
NSURL *modelURL = [NSURL fileURLWithPath:modelPath];
NSManagedObjectModel *managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL]; 
```

您可以使用 iCloud 传输您的 .xcdatamodeld（实际上是一个文件夹）或您的 .xcdatamodel。

# c++ - (Swig to python)导入错误：动态模块没有定义init函数

> ID：10121957
> 
> 赞同：7
> 
> 时间：2012-04-12T10:41:04.850
> 
> 标签：c++, python, swig

我正在尝试通过 swig 将我的 c++ 代码移植到 python。

当我完成构建 py、pyd、cxx 和 lib 文件时，在 Python（命令行）下，我键入“module Dnld”，它显示-> **import error:dynamic module does not define init function**。以下是我的代码，

*进一步：添加我的构建步骤以避免误解，谢谢 Mark Tolonen*

1.  文件->新建->项目->Windows控制台应用程序->选择DLL和空项目（无unicode）
2.  将我的 SerialComm 文件夹添加到项目中（包括 DownloaderEngine.h Serial.h PortEnumerator.h 等）。
3.  配置属性->c/c++->附加包含目录->C:\Python27\include
4.  配置属性->链接器->常规->输出文件->$(OutDir)\Dnld.pyd
5.  配置属性->链接器->输入->附加包含目录->C:\Python27\libs\python27.lib and .\SerialComm\setupapi.lib
6.  添加 Dnld.i ，进行自定义构建
7.  Dnld.i 属性页->命令行->swig -c++ -python $(InputPath)
8.  Dnld.i 属性页->输出->$(InputName)_warp.cpp
9.  构建、创建 Dnld_wrap.cxx、Dnld.py
10.  在我的项目中添加Dnld_wrap.cxx，全部重建，创建Dnld.pyd，就这样

（环境：XP SP3 with VC2008）

```
//DownloaderEngine.h
class __declspec(dllexport) CDownloaderEngine
{
public:
    CDownloaderEngine();

    virtual ~CDownloaderEngine();

    signed char OpenPort(signed char _ucPort, unsigned long _ulBaudRate, unsigned char _ucParity,
        unsigned char _ucStopBits,unsigned char _ucData);

    ....
};

//DownloaderEngine.cpp
CDownloaderEngine::CDownloaderEngine()
{
    ....
}

CDownloaderEngine::~CDownloaderEngine()
{
    ....
}

//DownloaderEngine.i
 %module Dnld

 %include <windows.i>
 %include <std_vector.i>
 %include <std_map.i>
 %{
    #define SWIG_FILE_WITH_INIT
    #include ".\SerialComm\DownloaderEngine.h"
 %}

 /* Parse the header file to generate wrappers */
 %include ".\SerialComm\DownloaderEngine.h" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T14:38:39.477

没有足够的信息，因为问题可能在于您如何构建它。例如，使用您指定的文件，从 VS2008 命令提示符构建应该类似于：

```
swig -python -c++ DownloaderEngine.i
cl /LD /W4 /Fe_Dnld.pyd /Ic:\Python27\include downloaderEngine_wrap.cxx -link /LIBPATH:c:\Python27\libs DownloaderEngine.lib 
```

**编辑**：您的构建步骤看起来正确，但有一件事是 .pyd 文件应该被命名`_Dnld.pyd`（注意下划线）。

生成的`Dnld.py`调用`import _Dnld`（.pyd），因此您将`import Dnld`（.py）在您的 Python 脚本中。

例子：

```
>>> import Dnld
>>> engine = Dnld.CDownloaderEngine()
>>> result = engine.OpenPort(...) 
```

如果我在不带下划线的情况下重命名 .pyd，则会出现以下错误：

```
>>> import Dnld
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: dynamic module does not define init function (initDnld) 
```

所以我相信这会解决你的问题。我很高兴帮助你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-12T10:35:10.317

作为记录，这里是错误消息的另一个可能原因

```
ImportError: dynamic module does not define init function (init<mylibrary>): 
```

在为 Python3 设置 Swig 时运行 Python2，反之亦然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T03:15:16.633

这个我花了一段时间才弄清楚。[从这里](http://mail.python.org/pipermail/cplusplus-sig/2008-August/013592.html)的 python.org 邮件列表来看，问题似乎在于 python 期望模块 Foo 提供函数 initFoo。那么问题是为什么 Dnld 不提供 initDnld。由于 swig 应该处理其中的大部分，这可能是因为 swig 不希望完成的库被称为 Dnld（如果它需要 dnld 或 D_nld 或其他任何东西，它将失败，但重命名文件会修复它。）请注意，这适用于 python 的任何 C 扩展，包括由 pyrex/cython 和 boost 生成的扩展。

# c# - IEnumerable Data Specific Ordering I've an object that is include property ID with values between 101 and 199\. How to order it like 199,101,102 ... 198? In result I want to put last item to f 问问题 问问题 2012-04-12T10:41:18.377 250 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I've an object that is include property ID with values between 101 and 199\. How to order it like 199,101,102 ... 198? In result I want to put last item to first. Rails import from csv to model I have a csv file with dump data of table and I would like to import it directly into my database using rails. I am currently having this code: csv_text = File.read("public/csv_fetch/#{model.table_name}.csv") ActiveRecord::Base.connection.execute("TRUNCATE TABLE #{model.table_name}") puts "\nUpdating table #{model.table_name}" csv = CSV.parse(csv_text, :headers => true) csv.each do |row| row = row.to_hash.with_indifferent_access ActiveRecord::Base.record_timestamps = false model.create!(row.to_hash.symbolize_keys) end with help from here.. Consider my Sample csv: id,code,created_at,updated_at,hashcode 10,00001,2012-04-12 06:07:26,2012-04-12 06:07:26, 2,00002,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode 13,00007,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode 43,00011,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode 5,00012,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode But problem with this code is : It is generating `id' as autoincrement 1,2,3,.. instead of what in csv file. The timestamps for records where there is 0000-00-00 00:00:00 defaults to null automatically and throws error as the column created_at cannot be null... Is there any way I can do it in generic way to import from csv to models? or would i have to write custom code for each model to manipulate the attributes in each row manually?? c#c#-4.0 4 7 回答 7 This answer is useful 7 所需的顺序没有意义（一些推理会有所帮助），但这应该可以解决问题： int maxID = items.Max(x => x.ID); // If you want the Last item instead of the one // with the greatest ID, you can use // items.Last().ID instead. var strangelyOrderedItems = items .OrderBy(x => x.ID == maxID ? 0 : 1) .ThenBy(x => x.ID); 于 2012-04-12T10:47:40.790 回答 This answer is useful 1 取决于您是对列表中最大的项目感兴趣，还是对列表中的最后一个项目感兴趣： internal sealed class Object : IComparable { private readonly int mID; public int ID { get { return mID; } } public Object(int pID) { mID = pID; } public static implicit operator int(Object pObject) { return pObject.mID; } public static implicit operator Object(int pInt) { return new Object(pInt); } public int CompareTo(Object pOther) { return mID - pOther.mID; } public override string ToString() { return string.Format("{0}", mID); } } List myList = new List { 1, 2, 6, 5, 4, 3 }; // the last item first List last = new List { myList.Last() }; List lastFirst = last.Concat(myList.Except(last).OrderBy(x => x)).ToList(); lastFirst.ForEach(Console.Write); Console.WriteLine(); // outputs: 312456 // or // the largest item first List max = new List { myList.Max() }; List maxFirst = max.Concat(myList.Except(max).OrderBy(x => x)).ToList(); maxFirst.ForEach(Console.Write); Console.WriteLine(); // outputs: 612345 于 2012-04-12T11:14:24.530 回答 This answer is useful 0 怎么样 var orderedItems = items.OrderBy(x => x.Id) var orderedItemsLastFirst = orderedItems.Reverse().Take(1).Concat(orderedItems.Skip(1)); 这将多次迭代列表，因此可能会更有效但不会使用太多代码。 如果更快的速度很重要，您可以编写一个专门的 IEnumerable 扩展，允许您在不转换为中间 IEnumerable 的情况下进行排序和返回。 于 2012-04-12T11:00:21.813 回答 This answer is useful 0 结果我想把最后一项放在第一位 首先对列表进行排序 List <int>values = new List<int>{100, 56, 89..}; var result = values.OrderBy(x=>x); 添加用于交换元素的扩展方法List <t>static void Swap<t>(this List <t>list, int index1, int index2) { T temp = list[index1]; list[index1] = list[index2]; list[index2] = temp; } 使用后 result .Swap(0, result.Count -1); 于 2012-04-12T10:48:33.910 回答 This answer is useful 0 编辑：错过了关于您首先想要最后一项的部分。你可以这样做： var objectList = new List<dataobject>(); var lastob = objectList.Last(); objectList.Remove(lastob); var newList = new List<dataobject>(); newList.Add(lastob); newList.AddRange(objectList.OrderBy(o => o.Id).ToList()); 如果您正在谈论正常排序，您可以使用 linq 的 order by 方法，如下所示： objectList = objectList.OrderBy(ob => ob.ID).ToList(); 于 2012-04-12T10:45:15.757 回答 This answer is useful 0 您可以使用单个 Linq 语句来实现这一点。 var ordering = testData .OrderByDescending(t => t.Id) .Take(1) .Union(testData.OrderBy(t => t.Id).Take(testData.Count() - 1)); 以相反的方向排序并取前 1 个，然后以“正确的方式”排序并取除最后一个以外的所有内容并将它们合并在一起。这种方法有很多变体，但上述方法应该有效。 这种方法也适用于任意列表，无需知道最大数量。 于 2012-04-12T10:51:44.500 回答 This answer is useful -3 var myList = new List<myobject>(); //initialize the list var ordered = myList.OrderBy(c => c.Id); //or use OrderByDescending if you want reverse order 于 2012-04-12T10:49:09.493 回答 Related 3 xml - 实体名称必须紧跟在实体引用中的 " 2 symfony - Symfony2 DomCrawler 链接 5 awk - 如何用awk计算序列中的残基总数？ 1 npapi - 如何使用 OpenGL 编写 mac npapi 插件？ 1 javascript - 如何用json返回简单数据 1 java - 如何打开带有小部件的新窗口？ 1 javascript - 继承对象并将变量传递给它，javascript 1 c# - 当内存数据库刷新到磁盘时指定sqlite文件的位置 1 c# - 清理 BitmapSource 的集合 3 php - 如何以 JSON 格式发送图像和日期 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：10121960
> 
> 赞同：0
> 
> 时间：
> 
> 标签：c#, c#-4.0

I've an object that is include property **ID** with values between 101 and 199\. How to order it like `199,101,102 ... 198`?

In result I want to put last item to first.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-12T10:47:40.790

所需的顺序没有意义（一些推理会有所帮助），但这应该可以解决问题：

```
int maxID = items.Max(x => x.ID); // If you want the Last item instead of the one
                                  // with the greatest ID, you can use
                                  // items.Last().ID instead.
var strangelyOrderedItems = items
    .OrderBy(x => x.ID == maxID ? 0 : 1)
    .ThenBy(x => x.ID); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T11:14:24.530

取决于您是对列表中最大的项目感兴趣，还是对列表中的最后一个项目感兴趣：

```
internal sealed class Object : IComparable<Object>
{
   private readonly int mID; 
   public int ID { get { return mID; } }
   public Object(int pID) { mID = pID; }

   public static implicit operator int(Object pObject) { return pObject.mID; }
   public static implicit operator Object(int pInt) { return new Object(pInt); }

   public int CompareTo(Object pOther) { return mID - pOther.mID; }
   public override string ToString() { return string.Format("{0}", mID); }
}

List<Object> myList = new List<Object> { 1, 2, 6, 5, 4, 3 };

// the last item first
List<Object> last = new List<Object> { myList.Last() };
List<Object> lastFirst = 
   last.Concat(myList.Except(last).OrderBy(x => x)).ToList();

lastFirst.ForEach(Console.Write);
Console.WriteLine();
// outputs: 312456     

// or

// the largest item first
List<Object> max = new List<Object> { myList.Max() };
List<Object> maxFirst = 
   max.Concat(myList.Except(max).OrderBy(x => x)).ToList();

maxFirst.ForEach(Console.Write);
Console.WriteLine();
// outputs: 612345 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-12T11:00:21.813

怎么样

```
var orderedItems = items.OrderBy(x => x.Id)
var orderedItemsLastFirst = 
    orderedItems.Reverse().Take(1).Concat(orderedItems.Skip(1)); 
```

这将多次迭代列表，因此可能会更有效但不会使用太多代码。

如果更快的速度很重要，您可以编写一个专门的 IEnumerable 扩展，允许您在不转换为中间 IEnumerable 的情况下进行排序和返回。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T10:48:33.910

> 结果我想把最后一项放在第一位

首先对列表进行排序

```
List<int> values = new List<int>{100, 56, 89..}; 
var result = values.OrderBy(x=>x); 
```

添加用于交换元素的扩展方法`List<T>`

```
static void Swap<T>(this List<T> list, int index1, int index2)
{
     T temp = list[index1];
     list[index1] = list[index2];
     list[index2] = temp;
} 
```

使用后

```
result .Swap(0, result.Count -1); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-12T10:45:15.757

编辑：错过了关于您首先想要最后一项的部分。你可以这样做：

```
var objectList = new List<DataObject>();
var lastob = objectList.Last();
objectList.Remove(lastob);
var newList = new List<DataObject>();
newList.Add(lastob);
newList.AddRange(objectList.OrderBy(o => o.Id).ToList()); 
```

如果您正在谈论正常排序，您可以使用 linq 的 order by 方法，如下所示：
`objectList = objectList.OrderBy(ob => ob.ID).ToList();`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-12T10:51:44.500

您可以使用单个 Linq 语句来实现这一点。

```
var ordering = testData
    .OrderByDescending(t => t.Id)
    .Take(1)
    .Union(testData.OrderBy(t => t.Id).Take(testData.Count() - 1)); 
```

以相反的方向排序并取前 1 个，然后以“正确的方式”排序并取除最后一个以外的所有内容并将它们合并在一起。这种方法有很多变体，但上述方法应该有效。

这种方法也适用于任意列表，无需知道最大数量。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-04-12T10:49:09.493

```
var myList = new List<MyObject>();
//initialize the list
var ordered = myList.OrderBy(c => c.Id); //or use OrderByDescending if you want reverse order 
```</myobject></dataobject></dataobject></t></t></t></int></int>

# ruby-on-rails - Rails 从 csv 导入模型

> ID：10121961
> 
> 赞同：1
> 
> 时间：2012-04-12T10:41:27.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, csv, data-import

我有一个带有表转储数据的 csv 文件，我想使用 rails 将它直接导入我的数据库。

我目前有这个代码：

```
csv_text = File.read("public/csv_fetch/#{model.table_name}.csv")
ActiveRecord::Base.connection.execute("TRUNCATE TABLE #{model.table_name}")
puts "\nUpdating table #{model.table_name}"
csv = CSV.parse(csv_text, :headers => true)
csv.each do |row|
  row = row.to_hash.with_indifferent_access
  ActiveRecord::Base.record_timestamps = false
  model.create!(row.to_hash.symbolize_keys)
end 
```

[在这里](https://stackoverflow.com/a/4410880/985051)的帮助下..

考虑我的示例 csv：

```
id,code,created_at,updated_at,hashcode
10,00001,2012-04-12 06:07:26,2012-04-12 06:07:26,
2,00002,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode
13,00007,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode
43,00011,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode
5,00012,0000-00-00 00:00:00,0000-00-00 00:00:00,temphashcode 
```

但是这段代码的问题是：

*   它生成 'id' 作为自动增量 1,2,3,.. 而不是 csv 文件中的内容。
*   记录的时间戳`0000-00-00 00:00:00`自动默认为 null 并引发错误，因为 created_at 列不能为 null ...

有什么方法可以以**通用方式从 csv 导入模型**？还是我必须为每个模型编写自定义代码来手动操作每一行中的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:55:10.933

对于问题1，我建议你输出`row.to_hash.symbolize_keys`，例如

```
# ...
csv.each do |row|
  #...
  hash = row.to_hash.symbolize_keys
  Rails.logger.info "hash: #{hash.inspect}"
  model.create!(hash)
end 
```

查看是否分配了“id”。

对于问题 2，我认为在日期存储“0000-00-00”而不是 nil 不是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-17T17:35:35.730

提供像'id'这样的字段和时间戳字段也手动解决了它......

```
model.id = row[:id] 
```

如果模型中存在 created_at、updated_at 则类似。

# multithreading - Thread safety for arrays in D?

> ID：10121966
> 
> 赞同：2
> 
> 时间：2012-04-12T10:41:54.320
> 
> 标签：multithreading, thread-safety, d

Please bear with me on this as I'm new to this.

I have an array and two threads.

First thread appends new elements to the array when required

```
myArray ~= newArray; 
```

Second thread removes elements from the array when required:

```
extractedArray = myArray[0..10];
myArray = myArray[10..myArray.length()]; 
```

Is this thread safe? What happens when the two threads interact on the array at the exact same time?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-12T20:39:31.887

不，它*不是*线程安全的。如果您跨线程共享数据，那么您需要通过诸如[同步语句](http://dlang.org/statement.html#SynchronizedStatement)、[同步函数](http://dlang.org/class.html#synchronized-functions)和[互斥锁](http://dlang.org/phobos/core_sync_mutex.html)[`core.atomic`](http://dlang.org/phobos/core_atomic.html)等工具自己处理使其成为线程安全的。

但是，需要指出的另一件主要事情是 D 中的所有数据默认情况下都是线程本地的。因此，除非明确[共享，否则您](http://dlang.org/migrate-to-shared.html)*无法*跨线程访问数据。因此，您通常根本不必担心线程安全。只有当您明确共享数据时，它才是一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T11:23:49.607

这不是线程安全的

这有经典的丢失更新竞赛：

附加意味着检查数组以查看它是否可以就地扩展，如果不能，则需要在副本忙时进行（O（n）时间）副本，其他线程可以切片，当复制完成时件将返回

您应该考虑使用更容易使线程安全的链表实现

Java使用[此处描述](http://www.cs.rochester.edu/u/michael/PODC96.html)`ConcurrentLinkedQueue`的列表来实现它，您可以使用标准库中的[`core.atomic.cas()`](http://dlang.org/phobos/core_atomic.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-12T12:17:02.023

它不是线程安全的。解决这个问题的最简单方法是用`synchronized`块包围数组操作。更多关于它的信息：http: [//dlang.org/statement.html#SynchronizedStatement](http://dlang.org/statement.html#SynchronizedStatement)

# javascript - Javascript Error in Chrome: Me, something I'm missing or a bug in Chrome?

> ID：10121969
> 
> 赞同：1
> 
> 时间：2012-04-12T10:41:57.923
> 
> 标签：javascript, google-chrome

I doubt the last option, but probably one of the first two. Can anybody tell me which?

I'm getting the error in the screen shot.

```
<html>
<head>
<script type="text/javascript">
var html = "<script></script>";
</script>
</head>
<body>
</body>
</html> 
```

![Screenshot of Error](../Images/a895dbcd2d790c7d862848423add3d60.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-12T10:44:30.483

这在每个浏览器中都是一个问题，脚本块在第一个字符串处终止`</script>`，因此如果该字符串出现在您的代码中的任何位置，它将导致脚本块过早终止。

如果您想在 JS 中将此作为变量，请使用：

```
var html = unescape("%3Cscript%3E%3C/script%3E"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T10:48:07.643

您还可以使用 \ 正确呈现该字符：

```
var html = "<script><\/script>"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T10:47:22.137

那不是错误。这是脚本标签的正确行为，您所做的相当于不转义字符串中的引号。

```
var string = 'My mother's awesome.'; 
```

解决问题的一种简单方法是拆分`</script>`标签，如下所示：

```
var html = "<script></"+"script>"; 
```

# asp.net - Google Map API 2 localization problems

> ID：10121972
> 
> 赞同：1
> 
> 时间：2012-04-12T10:42:08.193
> 
> 标签：asp.net, google-maps, localization

How can I change language used on map buttons and terms of use ? I am using Google Maps API 2 (to be exact ASP.NET [GoogleMap](http://googlemap.codeplex.com/) control v4.1) Does this depends from browser language. I can see on some sites that this text is localized and can't find any way to do that.

Here is the screenshot of text that I would like to localize:

![enter image description here](../Images/70e9827e7a59931d277fc00af7ea8df4.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-12T11:17:25.227

包含 gMap2 库时使用 hl 参数

例如：强制克罗地亚语被用作语言：（`hl=hr`）

```
<script 
 src="http://maps.google.com/maps?hl=hr&file=api&amp;v=2&amp;sensor=false&amp;key=yourKey"
 type="text/javascript"></script> 
```

* * *

使用 V3 时，参数名称将是**语言**而不是**hl**

# java - running selenium test on an headless server with htmlunit

> ID：10121976
> 
> 赞同：2
> 
> 时间：2012-04-12T10:42:30.777
> 
> 标签：java, selenium, webdriver, htmlunit

Hi I'm trying to run a simple selenium test on an headless server. I want to use `HtmlUnit` because the server has only `128 mb` of ram so `xvfb+firefox` is unsuitable.

when i run:

`java -jar selenium-server.jar -htmlSuite *webdriver http://example.com test.html log.html`

i get this error:

`java.lang.RuntimeException: com.thoughtworks.selenium.SeleniumException: No webdriver session id given`

I guess the problem is I have no `htmlunit` browser installed. Isn't it?

How can I install the htmlunit browser?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-13T12:38:23.350

I think your code has some syntax error. I had used selenium server to run a html test suite without webdriver and used the following code:-

java -jar selenium-server.jar -htmlSuite "*browsername" "baseURL" "TestSuite name along with the path" "path and name of report to be generated"

hopefully this will help you..

# ruby-on-rails - 使用 mongoid/mongodb 提取、建模和更改数据模型

> ID：10121977
> 
> 赞同：1
> 
> 时间：2012-04-12T10:42:41.937
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid, database

[如果可能的话，我正在寻找一种更好的方法来使用令人惊叹的mongoid ODM](http://mongoid.org/)驱动程序来操作现有的 mondodb 数据模型。

假设您有一个[嵌入式一对多](http://mongoid.org/docs/relations/embedded/1-n.html)数据模型，如下所示：

```
class User
  include Mongoid::Document

  field :nickname
  embeds_many :watchlists
end

class Watchlist
 include Mongoid::Document

 field :html_url
 field :description
 field :tags_array, type: Array
 embedded_in :user
end 
```

现在，对于所有**用户**，您只想提取每个**监视列表**的一部分，当且仅当它具有

```
tags_array == ["ruby", "web", "framework"] 
```

只返回几个字段（不是整个监视列表文档）：

1.  关注列表的 html_url 内容
2.  关注列表的描述内容

和

1.  相关的父昵称（ User.nickname ）

我试过这样的事情：

```
1.9.2p290 :574 > Competitor = Struct.new(:html_url, :description, :user)
=> #<Class:0xed08de8>
1.9.2p290 :575 > competitors = []
=> []
1.9.2p290 :576 >  User.all.map do |user|
1.9.2p290 :577 >     user.watchlists.all.map do |wl|
1.9.2p290 :578 >           if wl.tags_array == ["ruby", "web", "framework"]
1.9.2p290 :579?>                 competitors << Competitor.new(wl.html_url, wl.description, wl.user.nickname)
1.9.2p290 :580?>           end
1.9.2p290 :581?>     end
1.9.2p290 :582?> end 
```

这里有一些结果：

```
1.9.2p290 :585 > competitors
=> [#<struct html_url="https://github.com/rails/rails", description="Ruby on Rails", user="lgs">, #<struct html_url="https://github.com/sinatra/sinatra", description="Classy web-development dressed in a DSL (official / canonical repo)", user="lgs">]
1.9.2p290 :586 > competitors.size
=> 2
1.9.2p290 :599 > competitors[0][:html_url]
=> "https://github.com/rails/rails"
1.9.2p290 :600 > competitors[1][:html_url]
=> "https://github.com/sinatra/sinatra"
1.9.2p290 :601 > 
```

但我想知道，是否有更好、更智能、更快、高效、有效、美观（或只是**“不同”**）的方式来做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T12:04:32.617

你做两件事：

*   使用 db 查询过滤用户，而不是在应用程序中过滤
*   只从数据库中获取你需要的字段，而不是整个用户对象（假设你在用户中有一些其他的东西，为了简洁你在这里省略了）

    ```
    Competitor = Struct.new(:html_url, :description, :user)
    competitors = []
    User.where('watchlists.tags_array' => %w[ruby web framework]).
        only(:nickname, :watchlists).each do |u|
      u.watchlists.where(:tags_array => %w[ruby web framework]).each do |wl|
        competitors << Competitor.new(wl.html_url, wl.description, u.nickname)
      end
    end 
    ```

PS：可能你不想使用`map`on `User.all`，如果你有很多繁重的用户文档，它会需要很多内存。此外，您没有使用映射的用户，而是`competitors`自己在数组中收集结果，所以`each`应该可以正常工作。

# mysql - 在 JOIN 中选择最小值

> ID：10121979
> 
> 赞同：0
> 
> 时间：2012-04-12T10:42:58.520
> 
> 标签：mysql, database

我有两个表（仅列出对问题重要的字段）：

t_groups

*   INT groupId PRIMARY
*   VARCHAR(255) 语法

t_goods

*   INT goodId PRIMARY
*   INT 组 ID
*   INT价格
*   VARCHAR(255) 名称

现在我需要一个查询，它选择组名和每个组中最便宜的商品的名称。尝试这样做：

```
SELECT gr.groupId, grname, g.name
FROM t_groups AS gr
LEFT JOIN (SELECT * FROM t_goods ORDER BY PRICE ASC LIMIT 1) AS g
ON g.groupId = gr.groupId 
```

但它不起作用——在 g.name 字段中返回 NULL。可以很容易地解释：

JOIN 语句中的 SELECT 首先选择最便宜的商品，然后尝试按 groupId 对其进行“过滤”。显然，它只适用于最便宜的商品所属的组。

我该如何解决任务？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-12T11:15:33.123

## 为什么您的查询不起作用

```
SELECT gr.groupId, grname, g.name
FROM t_groups AS gr
LEFT JOIN (SELECT * FROM t_goods ORDER BY PRICE ASC LIMIT 1) AS g
ON g.groupId = gr.groupId 
```

内部查询选择数据库*中绝对最便宜的商品*（不考虑组）。因此，当您`LEFT JOIN`将此结果集分组时，只有实际包含普遍最便宜商品的组才有匹配的行（该组应该`g.name`正确填充列）。但是，由于`LEFT JOIN`工作方式的原因，所有其他组都将`NULL`作为`g`.

## 正确的解决方案

首先，您需要在每个组中选择最便宜的价格。这很简单：

```
SELECT groupId, MIN(price) AS minPrice FROM t_goods GROUP BY (groupId) 
```

然而最便宜的价格是没有关联的`goodId`。问题是这样写是没有意义的：

```
/* does not make sense, although MySql has historically allowed it */
SELECT goodId, groupId, MIN(price) AS minPrice FROM t_goods GROUP BY (groupId) 
```

原因是您不能选择未分组的列（即`goodId`），除非您将其包装在聚合函数（例如`MIN`）中：我们不知道您想要从共享相同的列中选择*哪* 一个。`goodId``groupId`

`goodId`获取每组中最便宜商品的正确、便携方式是

```
SELECT goodId, temp.groupId, temp.minPrice
FROM (SELECT groupId, MIN(price) AS minPrice FROM t_goods GROUP BY groupId) temp
      JOIN t_goods ON temp.groupId = t_goods.groupId AND temp.minPrice = t_goods.price) 
```

上面的查询首先找出每个组的最便宜的价格，然后再次加入到货物表中以查找该`goodId`组内具有该价格的商品的 s。

**重要提示：**如果多个商品在一组中具有相同的最便宜价格，则此查询将返回*所有*商品。如果您只希望每个组有*一个*结果，则必须指定决胜局，例如：

```
SELECT MIN(goodId), temp.groupId, MIN(temp.minPrice)
FROM (SELECT groupId, MIN(price) AS minPrice FROM t_goods GROUP BY groupId) temp
      JOIN t_goods ON temp.groupId = t_goods.groupId AND temp.minPrice = t_goods.price)
GROUP BY temp.groupId 
```

有了这个查询，您就可以找到每组中最便宜的商品的名称和价格（最低的`goodId`将用作决胜局）：

```
SELECT groupId, grname, gd.name, t3.minPrice
FROM t_groups AS gr
LEFT JOIN (SELECT MIN(goodId) AS goodId, t1.groupId, MIN(t1.minPrice) AS minPrice
           FROM (SELECT groupId, MIN(price) AS minPrice FROM t_goods GROUP BY groupId) t1
                 JOIN t_goods ON t1.groupId = t_goods.groupId AND t1.minPrice = t_goods.price
           ) t2
) t3 ON gr.groupId = t3.groupId
LEFT JOIN t_goods gd ON t3.goodId = gd.goodId 
```

这个最终查询在其“外部”级别执行两个连接：

*   使用“`goodId`每个组的最便宜的价格”表加入组以获得`goodId`最便宜的价格
*   然后与商品表连接以获取商品的名称`goodId`

即使多种商品都以最便宜的价格捆绑在一起，它也将只生产一种商品。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-12T11:15:54.540

你可以这样做：

```
select 
  t_groups.grname as `name of group`,
  t_goods.name as `name of good`
from (
  select 
    groupId, 
    min(price) as min_price
  from t_goods 
  group by groupId
) as mins
inner join t_goods
  on mins.groupId = t_goods.groupId and mins.min_price = t_goods.price
inner join t_groups
  on mins.groupId = t_groups.groupId 
```

这是如何工作的：

*   `mins`子查询获取每个 groupId 的最低价格
*   加入`mins`到`t_goods`拉出所有在他们的组中具有最低价格的商品。请注意，如果有多个最低价格的商品，这可能会返回一个组中的多个商品
*   然后加入以`t_groups`获取组名

* * *

您的查询可能返回 NULL，因为它正在`left join`处理一个只有一行的子查询。

# jsp - Whats a good way to specify links and filepaths in jsps?

> ID：10121981
> 
> 赞同：1
> 
> 时间：2012-04-12T10:43:01.700
> 
> 标签：jsp, struts2, jstl

Wanted to know how to specify links and jsp filepaths in jsps. Is it better to specify them on the jsp itself or if its better to keep them all in a constants file so that it is easier to change things if the path to a jsp changes or the url of a link changes.

By the way I also use the Struts2 framework and JSTL tags on my pages.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-12T11:49:57.973

请注意您所说的灵活性是什么意思，但是包含 jsp S2 提供了一种非常干净和有效的方式来将一个 JSP 包含在另一个 JSP 中。

```
<s:include value="myJsp.jsp" /> 
```

它还将提供传递任何附加参数的方法。有关详细信息，请参阅文档

*   [S2 包含标签](http://struts.apache.org/2.3.1/docs/include.html)

要指定链接，您可以使用`<s:url>`标记。`%{url}`将被评估为使用 s:url 标签定义的 url。在 Welcome 和 HelloWorld 页面上，我们使用两个不同的 Struts 标签来创建链接。我们创造

*   资源链接
*   直接链接，以及
*   与参数的链接。

有关详细信息，请参阅文档中的详细信息

1.  [S2 网址标签](http://struts.apache.org/2.3.1/docs/url.html)
2.  [使用标签](http://struts.apache.org/2.3.1/docs/using-tags.html)

还有其他方法可以更灵活地包含 jsp，例如根据从 action 设置的 JSP 值在运行时包含 jsp，但是如果没有关于您的用例的任何进一步信息，很难建议。

# java - XSLT 转换中的 StackOverFlowError

> ID：10121987
> 
> 赞同：1
> 
> 时间：2012-04-12T10:43:31.807
> 
> 标签：java

我正在尝试使用 QueWeb Framework 提供的 com.queplix.core.utils.xml.TransletWrapper 类转换 xml 文件。我在下面的代码 @line transletWrapper.transform(source, new StreamResult(out) 中得到 StackOverFlowError , transletName, transletParams);

任何帮助将不胜感激..坦克！

```
char[] data = XMLHelper.writeObject(report);

// Do XSLT.
StreamSource source = new StreamSource(new CharArrayReader(data));
CharArrayWriter out = new CharArrayWriter(data.length);

try {
   transletWrapper.transform(source, new StreamResult(out), transletName, transletParams);
    } catch (GenericSystemException ex) {
       throw new GenericSystemException("Cannot transform source: \n", ex);
    } 
```

# java - Enums 共享静态查找方法

> ID：10121988
> 
> 赞同：30
> 
> 时间：2012-04-12T10:43:42.807
> 
> 标签：java, enums

我有以下枚举：

```
public enum MyEnum{
    A(10, "First"), //
    B(20, "Second"), //
    C(35, "Other options");

    private Integer code;
    private String description;

    private MyEnum(Integer code, String description) {
        this.code = code;
        this.description = description;
    }

    public Integer getCode() {
        return code;
    }

    public String getDescription() {
        return description;
    }

    public static MyEnum getValueOf(Integer code) {
        for (MyEnum e : MyEnum.values()) {
            if (e.getCode().equals(code)) {
                return e;
            }
        }
        throw new IllegalArgumentException("No enum const " + MyEnum.class.getName() + " for code \'" + code
                + "\'");
    }
} 
```

哪个工作正常。存在-`getValueOf`方法是因为在与外部合作伙伴通信时，我们只获取要映射到的代码（他们选择）。我需要描述，因为我需要在 GUI 中显示一个有意义的短语。

但我现在有许多类似的枚举类。都有自己的代码和描述，他们需要相同的查找功能。我希望`getValueOf`- 方法是通用的，所以我不需要为基本相同的方法支持 30 多个不同的枚举。

为了解决这个问题，我想创建一个抽象类来定义这个方法并实现一些常见的逻辑，但是这是不可能的，因为我不能扩展`Enum`。

然后我尝试使用以下方法制作一个实用程序类：

```
public static <T extends Enum<T>> T getValueOf(Enum<T> type, Integer code) {...} 
```

但是带有枚举的泛型令人困惑，我不明白如何让它工作。

基本上我想知道的是：为枚举定义通用实用程序的好方法是什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-04-12T10:50:08.283

您需要将实际的枚举类对象作为参数传递给您的方法。然后您可以使用`Class.getEnumConstants()`.

为了能够访问`getCode()`实例，您应该在接口中定义它并让所有枚举类型都实现该接口：

```
interface Encodable {
    Integer getCode();
}

public static <T extends Enum<T> & Encodable> T getValueOf(Class<T> enumClass, Integer code) {
    for (T e : enumClass.getEnumConstants()) {
        if (e.getCode().equals(code)) {
            return e;
        }
    }
    throw new IllegalArgumentException("No enum const " + enumClass.getName() + " for code \'" + code
            + "\'");
}

...

public enum MyEnum implements Encodable {
    ...
}

MyEnum e = getValueOf(MyEnum.class, 10); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-12T11:01:10.940

这有点棘手，因为该`values()`方法是静态的。您实际上需要反射，但有一种很好的方法可以使用标准库功能隐藏它。

首先，使用所有枚举类型通用的方法定义一个接口：

```
public interface Common {
    Integer getCode();
    String getDescription();
} 
```

然后，让你所有的枚举实现这个接口：

```
public enum MyEnum implements Common {...} 
```

您想要的静态方法如下所示：

```
public static <T extends Enum<T> & Common> T getValueOf( Class<T> type, Integer code ) {
    final EnumSet<T> values = EnumSet.allOf( type );
    for(T e : values) {
        if(e.getCode().equals( code )) {
            return e;
        }
    }
    throw new IllegalArgumentException( "No enum const " + type.getName() + " for code \'" + code + "\'" );
} 
```

# java - JavaFX 应用程序图标

> ID：10121991
> 
> 赞同：193
> 
> 时间：2012-04-12T10:43:45.943
> 
> 标签：java, javafx, javafx-2, javafx-8, stage

是否可以使用 JavaFX 更改应用程序图标，还是必须使用 Swing 来完成？

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2012-04-12T11:08:40.320

假设您的阶段是“阶段”并且文件在文件系统上：

```
stage.getIcons().add(new Image("file:icon.png")); 
```

根据下面的评论，如果它被包装在一个包含 jar 中，则需要使用以下方法：

```
stage.getIcons().add(new Image(<yourclassname>.class.getResourceAsStream("icon.png"))); 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2012-10-10T21:10:40.823

我试过这个，它完全有效。代码是：

```
stage.getIcons().add(
   new Image(
      <yourclassname>.class.getResourceAsStream( "icon.png" ))); 
```

icon.png 与源文件位于同一文件夹下。

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2013-03-04T16:30:50.833

初学者的完整程序 :) 该程序为 StackOverflowIcon 设置图标。

```
import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.image.Image;
import javafx.scene.layout.StackPane;
import javafx.stage.Stage;

public class StackoverflowIcon extends Application {

    @Override
    public void start(Stage stage) {
        StackPane root = new StackPane();
        // set icon
        stage.getIcons().add(new Image("/path/to/stackoverflow.jpg"));
        stage.setTitle("Wow!! Stackoverflow Icon");
        stage.setScene(new Scene(root, 300, 250));
        stage.show();
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

**输出截图**

![JavaFX 截图](../Images/de3ff6b5b5d9401782c42a1d0cca3ece.png)

> 为 JavaFX 8 更新

无需更改代码。它仍然可以正常工作。在 Java 1.8(1.8.0_45) 中测试和验证。路径可以设置为本地或远程两者都支持。

```
stage.getIcons().add(new Image("/path/to/javaicon.png")); 
```

或者

```
stage.getIcons().add(new Image("https://example.com/javaicon.png")); 
```

![在此处输入图像描述](../Images/c2fb0e0b83e3ceb8fb863418aeefcfc6.png)

希望能帮助到你。谢谢！！

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-04-05T08:30:33.690

您可以将其添加到 fxml 中。舞台级别

```
<icons>
    <Image url="@../../../my_icon.png"/>
</icons> 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-10-25T12:26:19.573

如果您有一个图像文件夹并且图标保存在该文件夹中，请使用此

```
stage.getIcons().add(new Image(<yourclassname>.class.getResourceAsStream("/images/comparison.png"))); 
```

如果您直接从您的包中使用它，这不是一个好习惯，请使用这个

```
stage.getIcons().add(new Image(<yourclassname>.class.getResourceAsStream("comparison.png"))); 
```

如果你有一个文件夹结构并且你有你的图标在里面使用

```
stage.getIcons().add(new Image(<yourclassname>.class.getResourceAsStream("../images/comparison.png"))); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-22T13:51:50.307

您如何看待在您的 src 目录中创建新包，即 image.icons 并将您的 .png 图像移到那里？比你只需要写：

```
Image image = new Image("/image/icons/nameOfImage.png");
primaryStage.getIcons().add(image); 
```

这个解决方案非常适合我，但我仍然不确定它是否正确（这里是初学者）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-05-25T11:18:52.130

```
stage.getIcons().add(new Image(<yourclassname>.class.getResourceAsStream("/icon.png"))); 
```

If your icon.png is in resources dir and remember to put a '/' before otherwise it will not work

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-28T12:19:17.863

```
stage.getIcons().add(new Image(ClassLoader.getSystemResourceAsStream("images/icon.png"))); 
```

图像文件夹需要在资源文件夹中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-09-30T15:33:27.873

```
stage.getIcons().add(new Image(<yourclassname>.class.getResourceAsStream("/icon.png" ))); 
```

您可以使用此方法添加多个不同尺寸的图标。图像应该是同一图像的不同尺寸，并且将选择最佳尺寸。 `eg. 16x16, 32,32`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-12-03T11:21:09.980

您可以使用此代码行轻松地将图标放入您的应用程序

stage.getIcons().add(new Image("图像路径") );

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-04T14:11:03.043

如果您运行 jar 文件，Michael Berry 指定的代码将更改标题栏和任务栏中的图标。快捷方式图标无法更改。

如果您运行使用 com.zenjava 编译的本机程序，您必须添加程序图标的链接：

```
<plugin>
    <groupId>com.zenjava</groupId>
    <artifactId>javafx-maven-plugin</artifactId>
    <version>8.8.3</version>
    <configuration>
    ...
        <bundleArguments>
            <icon>${project.basedir}/src/main/resources/images/filename.ico</icon>
        </bundleArguments>
    </configuration>
</plugin> 
```

这将在快捷方式和任务栏上添加一个图标。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-07-17T13:24:54.753

```
stage.getIcons().add(new Image("/images/logo_only.png")); 
```

在 src 文件夹中创建 images 文件夹并从中获取图像是一个好习惯。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-12-11T04:31:54.600

我在我的应用程序中使用了这个

```
Image icon = new Image(getClass().getResourceAsStream("icon.png"));
window.getIcons().add(icon); 
```

这里的窗口就是舞台。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-08-27T20:03:04.903

在运行时切换图标：

除了这里的回复，我发现一旦你第一次为你的应用程序分配了一个图标，你不能通过在你的舞台上添加一个新图标来切换它（如果你需要切换你的图标，这将很有帮助应用程序从开/关启用/禁用）。

要在运行时设置新图标，请在尝试添加新图标之前使用 getIcons().remove(0)，其中 0 是您要覆盖的图标的索引，如下所示：

```
//Setting icon by first time (You can do this on your start method).
stage.getIcons().add(new Image(getClass().getResourceAsStream("enabled.png")));

//Overriding app icon with a new status (This can be in another method)
stage.getIcons().remove(0);
stage.getIcons().add(new Image(getClass().getResourceAsStream("disabled.png"))); 
```

要从其他方法或类访问阶段，您可以在主类中为阶段创建一个新的静态字段，以便可以通过封装在您可以从应用程序中的任何位置访问的静态方法从 start() 方法之外访问它.

```
public class MainApp extends Application {
    private static Stage stage;
    public static Stage getStage() { return stage; }

    @Override public void start(Stage primaryStage) {
        stage = primaryStage
        stage.getIcons().add(new Image(getClass().getResourceAsStream("enabled.png")));
    }
}

public class AnotherClass {
    public void setStageTitle(String newTitle) {
        MainApp.getStage().setTitle(newTitle);
        MainApp.getStage().getIcons().remove(0);
        MainApp.getStage().getIcons().add(new Image(getClass().getResourceAsStream("disabled.png")));
    }
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2018-11-28T19:11:19.307

如果您`Invalid URL or resource not found`将 icon.png 放在工作区的“bin”文件夹中。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2012-10-16T09:25:59.393

在 JavaFX 的标题栏上插入自己的图标的另一种简单方法是使用以下方法将图像添加到主阶段：

```
Image ico = new Image("resources/images/iconLogo.png");
stage.getIcons().add(ico); 
```

确保您的导入 javafx.scene.image.Image （如果使用像 netbeans 这样的 ide，这应该会自动为您完成）。

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2016-08-17T20:30:05.190

我试过这个并且它有效：

```
stage.getIcons().add(new Image(getClass().getResourceAsStream("../images/icon.png"))); 
```

# iphone - 在两个不同点之间画线

> ID：10121992
> 
> 赞同：0
> 
> 时间：2012-04-12T10:43:46.067
> 
> 标签：iphone, ios

我想在两点之间画线。这是我的代码。但上下文记忆为0。

```
CGContextRef context = UIGraphicsGetCurrentContext();

        CGContextSetLineWidth(context, 2.0);

        CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceRGB();

        CGFloat components[] = {0.0, 0.0, 1.0, 1.0};

        CGColorRef color = CGColorCreate(colorspace, components);

        CGContextSetStrokeColorWithColor(context, color);

        CGContextMoveToPoint(context, 0, 0);
        CGContextAddLineToPoint(context, 300, 400);

        CGContextStrokePath(context);
        CGColorSpaceRelease(colorspace);
        CGColorRelease(color); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T10:47:31.187

您需要在方法中的 UIView 子类中调用您的代码`drawRect:`。 `UIGraphicsGetCurrentContext()`当您不在绘图上下文中时，将获得 NULL (0)。

您也可以查看[文档](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UIKitFunctionReference/Reference/reference.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T10:59:32.863

这是一个非常有用的教程，可以满足您的需要。

[http://trailsinthesand.com/exploring-iphone-graphics-part-1/](http://trailsinthesand.com/exploring-iphone-graphics-part-1/)

经历一次..！

# java - Android 复选框组

> ID：10121997
> 
> 赞同：12
> 
> 时间：2012-04-12T10:44:07.817
> 
> 标签：java, android, checkbox, groupbox

我正在尝试对一组复选框应用某种验证（例如，两个相互矛盾的项目不能一起检查）所以我想以某种方式对 Check Box 对象进行分组，并在整个组上应用类似 RequiredFieldValidator 的东西，然后在那个验证器中我将注册侦听器并对我的 Check Boxes 对象进行全面检查。

我想象的是一个看起来像这样的代码：

```
CheckBoxView allMyCheckBoxes = new CheckBoxView(checkbox1,checkbox2,checkbox3); //varargs
validate(allMyCheckBoxes); 
```

Validate 将包含相互矛盾的复选框和所有内容的逻辑。

这是否已经在 Android 的某个地方实现了？如果没有，有人尝试过类似的东西吗？（希望在这里与我们分享）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:53:33.103

此逻辑将允许选择一个和多个复选框

```
 private Checkbox day = (checkbox)findviewbyid(R.id.day);
 private Checkbox night =(checkbox)findviewbyid(R.id.night);

 day.setOnCheckedChangeListener(new OnCheckedChangeListener() {

    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        if (!night.isChecked() && !day.isChecked()) {
            night.setChecked(true);
        }

    }
});
night.setOnCheckedChangeListener(new OnCheckedChangeListener() {

    @Override
    public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        if (!day.isChecked() && !night.isChecked()) {
            day.setChecked(true);
        }

    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-24T19:37:23.677

这就是我所做的。不确定这是否适合您，但您可以将其用作开始。我的复选框我不需要任何检查侦听器，但如果您愿意，可以将它们添加到每个复选框

```
public class MainActivity extends AppCompatActivity implements View.OnClickListener {
    private CheckBox chk1, chk2, chk3;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    chk1 = (CheckBox) findViewById(R.id.checkbox1);
    chk2 = (CheckBox) findViewById(R.id.checkbox2);
    chk3 = (CheckBox) findViewById(R.id.checkbox3);
    if (chk1.isChecked()) {
        chk1.setChecked(false);
    }
        else if(chk2.isChecked()){
          chk2.setChecked(false);
         }
    else {
        chk3.setChecked(false);
    }
    chk1.setOnClickListener(this);
    chk2.setOnClickListener(this);
    chk3.setOnClickListener(this);
    }

    @Override
    public void onClick(View view) {
    switch(view.getId()){
        case R.id.checkbox1:
        chk1.setChecked(true);
        chk2.setChecked(false);
        chk3.setChecked(false);
        break;
        case R.id.checkbox2:
        chk2.setChecked(true);
        chk3.setChecked(false);
        chk1.setChecked(false);
        break;
        case R.id.checkbox3:
        chk3.setChecked(true);
        chk2.setChecked(false);
        chk1.setChecked(false);
        break;
    }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-12T13:13:53.653

您可以使用单选按钮并设置它们的不同组。

如果您发现单选按钮是可行的方法，[本文档](http://developer.android.com/reference/android/widget/RadioButton.html)和[本教程应该可以帮助您。](http://developer.android.com/resources/tutorials/views/hello-formstuff.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-11-30T08:45:02.333

另一个提示。

这种方式可以简单地注册监听器。

```
private CheckBox[] chkBoxs;
private Integer[] chkBoxIds = {R.id.a, R.id.b, R.id.c .....};

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    chkBoxs = new CheckBox[chkBoxIds.length];
    for(int i = 0; i < chkBoxIds.length; i++) {
        chkBoxs[i] = (CheckBox) findViewById(chkBoxIds[i]);
        chkBoxs[i].setOnCheckedChangeListener(this);
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-22T12:47:34.360

```
binding.overPhone.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

            @Override
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                if (isChecked) {
                    binding.overPhone.setChecked(true);
                    binding.overMail.setChecked(false);
                }else{
                    binding.overPhone.setChecked(false);
                    binding.overMail.setChecked(true);
                }
            }
        });
        binding.overMail.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

            @Override
            public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                if (isChecked) {
                    binding.overPhone.setChecked(false);
                    binding.overMail.setChecked(true);
                }else{
                    binding.overPhone.setChecked(true);
                    binding.overMail.setChecked(false);
                }
            }
        }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-08T20:15:58.117

这是允许从两个中选择一个复选框的逻辑，如果您想从多个中选择一个然后更改它。

```
checkBoxHightoLow.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
        @Override
        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
            if (checkBoxLowToHigh.isChecked()) {
                checkBoxLowToHigh.setChecked(false);
                checkBoxHightoLow.setChecked(isChecked);
            } else if (!checkBoxLowToHigh.isChecked()) {
                checkBoxHightoLow.setChecked(isChecked);

            }
        }
    });
    checkBoxLowToHigh.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
        @Override
        public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
            if (checkBoxHightoLow.isChecked()) {
                checkBoxHightoLow.setChecked(false);
                checkBoxLowToHigh.setChecked(isChecked);
            } else if (!checkBoxHightoLow.isChecked()) {
                checkBoxLowToHigh.setChecked(isChecked);

            }
        }
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-10T12:21:57.873

对类似于单选按钮的复选框进行验证的最佳方法

```
 // Implements your activity     
 CompoundButton.OnCheckedChangeListener 
 // Declare global variables
private CheckBox cbDriver, cbPickDrop;
private String strCB;

// Bind components and set listeners in onCreate()
cbDriver = (CheckBox) findViewById(R.id.driverCB);
cbPickDrop = (CheckBox) findViewById(R.id.pickDropCB);
cbDriver.setOnCheckedChangeListener(this);
cbPickDrop.setOnCheckedChangeListener(this);

// write this method inside your activity
@Override
public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
    switch (buttonView.getId()){
        case R.id.driverCB:
            if (isChecked) {
                cbPickDrop.setChecked(false);
                strCB = cbDriver.getText().toString();
                DialogManager.showToast(MyActivity.this, strCB);
            }
            break;
        case R.id.pickDropCB:
            if (isChecked) {
                cbDriver.setChecked(false);
                strCB = cbPickDrop.getText().toString();
                DialogManager.showToast(MyActivity.this, strCB);
            }
            break;
    }

} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-03-18T18:35:23.003

使用`ButterKnife`库：

```
@BindViews({R.id.checkbox_1, R.id.checkbox_2, R.id.checkbox_3, R.id.checkbox_4})
List<CheckBox> checkBoxes; 
```

```
private void setChecked(int id){
        for(int i = 0; i < checkBoxes.size(); i++){
            if(checkBoxes.get(i).getId() != id){
                checkBoxes.get(i).setChecked(false);
            }else{
                checkBoxes.get(i).setChecked(true);
            }
        }
    }

@OnClick({R.id.checkbox_1, R.id.checkbox_2, R.id.checkbox_3, R.id.checkbox_4})
    void onCheckBoxClick(View view){
        switch (view.getId()){
            case R.id.checkbox_1:
                uncheckOthers(view.getId());
                break;

            case R.id.checkbox_2:
                uncheckOthers(view.getId());
                break;

            case R.id.checkbox_3:
                uncheckOthers(view.getId());
                break;

            case R.id.checkbox_4:
                uncheckOthers(view.getId());
                break;
        }
    } 
```