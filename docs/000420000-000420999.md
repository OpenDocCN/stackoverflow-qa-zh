# StackOverflow 问答 000420000-000420999

# air - 在 Adob e AIR 上渲染

> ID：420006
> 
> 赞同：0
> 
> 时间：2009-01-07T11:44:23.480
> 
> 标签：air, media, multimedia

我的同事在他的[博客](http://rob.crabapples.net/2009/01/rendering-on-top-of-adobe-air.htm)上发布了一个问题。他指的是在 adobe air 中渲染 MPEG-4 流。他基本上想知道两件事。

> 是否有任何技术文章浮动...
> 
> 1.  描述 AIR 的渲染方式。
>     
>     
> 2.  描述了一种以不影响 AIR 性能的方式在 AIR 表面上绘画的技术？

SO社区有答案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T11:42:28.750

由于 AIR 应用程序是加载 swf 或 html / javascript 内容的容器，我认为问题是：“flash 如何呈现”。所以我建议阅读一些关于 flv 视频编解码器的内容。

# java - 在 Eclipse 中方便地将一个类移动到不同的包中，而不需要 svn

> ID：420013
> 
> 赞同：20
> 
> 时间：2009-01-07T11:45:09.797
> 
> 标签：java, eclipse, svn, move

从我移动文件时，`old.package to new.package`我希望发生两件事：

1.  更新对该类的所有引用（在项目的所有文件中），以便使用新包
2.  `svn move old/package/Foo.java new/package/Foo.java`

我在 Eclipse Ganymede 中使用颠覆性的。当我只是将文件从一个包拖到另一个包时，所有引用都会更新，并且文件会在文件系统上移动。但是 SVN 不知道这一点，因此该`svn move old/package/foo.java new/package/Foo.java`命令在不存在时（显然）`old/package/Foo.java`不起作用（因为 eclipse 已经移动了它）。

有没有办法让 eclipse 进行重构但使用 svn 将文件移动到文件系统上？我希望我只是错过了一些明显的东西:-)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-07T12:13:50.427

我使用[Subclipse](http://subclipse.tigris.org/)，它*确实*支持在包之间移动文件

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-13T20:40:43.933

我一直在尝试，并认为我找到了方法：

1）使用右键单击拖动上下文菜单（或您想要的任何SVN方法）乌龟移动文件。

2）使用Windows文件系统将其移回。

3) 在 Eclipse 中拖动移动文件以更新所有引用。

4）提交 - 它显示为删除/添加，但它保存了历史记录，并且它确实在一次提交中更改了包引用（保持每个提交可构建）。

老问题，但我一直在回过头来，所以这是我的文档！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T17:46:07.853

尤瓦尔是对的。这听起来像是 Subversive 中的一个（非常不幸！）缺陷。（没有使用 Subversive 的经验，我不能肯定地说）Subclipse 肯定会通过在 Eclipse 中连接到正确的 API 来正确处理这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T12:17:54.927

您不能同时进行这两项操作，因为仅移动文件是不够的。需要修改这些文件才能再次编译您的代码。所以用 Eclipse 重构，让 Subclipse 在移动之后发挥它的魔力（删除旧文件，添加新文件）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-07T11:50:56.400

如果您让 Eclipse 进行重构，那么它肯定会在您提交根目录时对 SVN 应该获取的实际文件进行更改？我不认为移动会削减它，SVN 将不得不从其原始目录中发现该文件丢失，但从新目录中重新添加它。这是一个棘手的情况，我不知道最好的方法是什么，我只是进行重构，然后亲自提交根，即使这不会是一个举动。

# delphi - 为什么有时我会收到“无效的交易对象”异常？

> ID：420022
> 
> 赞同：1
> 
> 时间：2009-01-07T11:48:49.573
> 
> 标签：delphi, dbx

这段代码有问题吗？
有时我会得到一个未处理的“无效事务对象”异常：

```
procedure BlaBla;
var
  TD: TDBXTransaction;
begin
  TD := SQLConnection.BeginTransaction;
  try
    SQLConnection.ExecuteDirect('some sql command');
    SQLConnection.ExecuteDirect('some sql command');
    SQLConnection.CommitFreeAndNil(TD);
  except
    SQLConnection.RollbackFreeAndNil(TD);
  end;
end; 
```

这个异常是向用户提出的，所以我认为它是由 RollbackFreeAndNil 提出的，因为所有的休息都在 try..except 中。

我应该用另一个 try..except 来包装 RollbackFreeAndNil 吗？真是一团糟。

我正在使用 Delphi 2009、带有 Firebird 2.1 的 DBX 和 Devart 的驱动程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T14:12:32.043

如果 CommitFreeAndNil 抛出异常会发生什么？

将调用 RollbackFreeAndNil。那么TD有效吗？

你吃的是例外，因此是证据。不要那样做；重新抛出：

```
procedure BlaBla;
var
  TD: TDBXTransaction;
begin
  TD := SQLConnection.BeginTransaction;
  try
    SQLConnection.ExecuteDirect('some sql command');
    SQLConnection.ExecuteDirect('some sql command');
  except
    SQLConnection.RollbackFreeAndNil(TD);
    raise;
  end;
  SQLConnection.CommitFreeAndNil(TD);
end; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-03T19:17:04.473

问题是如果 SQLConnection 未连接到数据库，则 SQLConnection.BeginTransaction 返回 nil。然后我得到了无效事务对象的异常。

我从没想过会这样。它应该尝试连接或引发异常。返回 nil 对我来说没有意义。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-02T22:12:29.330

有时是您使用 cxdbmemo 之类的组件执行各种程序并给您错误。您必须删除该组件（或类似的东西）并正常进行交易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-25T08:13:46.210

```
SQLConnection.DBXConnection.BeginTransaction(TDBXIsolations.ReadCommitted); 
```

# sql-server-2005 - 线程使用 50-100% CPU 使用率：MSVCR80.dll!endthreadex

> ID：420027
> 
> 赞同：0
> 
> 时间：2009-01-07T11:50:48.150
> 
> 标签：sql-server-2005, multithreading

我有 sql 2005 sp1，并且注意到很多**MSVCR80.dll!endthreadex** 线程使用 Process Explorer 占用了服务器上的所有 CPU，并且它们永远不会消失，直到你杀死它，或者重新启动 sql server？有没有人知道任何解决方法，例如如何结束或停止它，因为这种情况每天都在发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-31T09:02:16.617

**MSVCR80.dll!endthreadex**没有任何意义。MSVCR80 DLL 用于执行用 Visual Studio 2005 编译的 C++ 代码（我猜 SQLServer 2005 是在 Visual Studio 2005 中编译的）。您可以检查以确保您安装了最新的[C++ Redistributable](http://www.microsoft.com/downloads/details.aspx?familyid=200B2FD9-AE1A-4A14-984D-389C36F85647&displaylang=en)软件包。

SQLServer 将在运行时启动工作线程。这很正常。如果您看到这些线程占用了 CPU，那么这意味着您的数据库正在运行。用户正在查询数据库或数据库正在尝试解决由于您不断重新启动而无法完成的内部工作。

使用 Process Explorer 诊断 SQLServer 性能问题不会让您走得太远。您应该使用 SQL Server Profiler 来识别数据库中正在执行的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T21:54:29.200

这是一篇关于使用 Process Explorer 和 ProcMon 追踪类似问题的非常好的文章：

[慢速系统案例](http://blogs.technet.com/markrussinovich/archive/2008/09/24/3126858.aspx "慢速系统案例")

# iphone - 使用 UIImage 时的内存管理

> ID：420031
> 
> 赞同：3
> 
> 时间：2009-01-07T11:51:40.113
> 
> 标签：iphone, cocoa-touch, memory-management

我的应用程序大量使用 UIImage 对象根据用户输入和之前设置的图像更改单个 UIImageView 上的图像。我使用 [UIImage imageNamed:] 创建我的 UIImage 对象。

我想这不是使用 UIImage 的最佳方式，因为我的内存使用量会随着时间的推移而不断增加并且永远不会下降。（当我使用对象分配运行应用程序时才知道这一点，而且我没有使用其他 NSString 变量，只有 BOOL 和 UIImage）

我应该如何有效地使用 UIImage 和 UIImageView 对象来保持低内存？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T12:18:21.917

```
[UIImage imageNamed:] 
```

缓存您正在加载到内存中的图像。如果您想一遍又一遍地重复使用同一组图像，这很好，但如果您不断显示不同（或大）图像，那么您应该使用：

```
NSString *fileLocation = [[NSBundle mainBundle] pathForResource:fileName ofType:extension];
NSData *imageData = [NSData dataWithContentsOfFile:fileLocation];

[UIImage imageWithData:imageData]; 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-07T09:17:54.007

正如@russtyshelf所说，要使用图像管理内存，您必须将图像文件转换为数据并将其转换为图像，但之后您必须使图像实例为零以清理缓存内存。即在 viewdidload() 你必须写成：

```
let image = [UIImage imageWithData:imageData]; 
```

并且在控制器的 deinit 或切换视图期间，您的图像必须为零，即

```
image = nil 
```

# .net - 在 Windows 2000 上运行引导程序

> ID：420035
> 
> 赞同：1
> 
> 时间：2009-01-07T11:52:12.670
> 
> 标签：.net, bootstrapper

有什么方法可以在 Windows 2000 SP4 上使用 .NET 2.0 WinForms 应用程序运行 VS2008 生成的 setup.exe 引导程序？如果我尝试运行它，它会给我一条关于 Kernel32.dll 中缺少 HeapSetInformation 的错误消息，并且它不会运行。

我尝试手动安装 Windows Installer 3.1 和 .NET 2.0 Framework，但 setup.exe 仍然显示相同的错误消息。我必须直接使用 Setup.msi 在 Windows 2000 上安装我的应用程序。引导程序是否仅限于在 XP 和更高版本上使用？

它在 Windows XP 上运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T12:00:08.987

引导程序通常会在 %TMP% 文件夹的子文件夹中创建一个日志文件。日志中是否有任何信息？

其他论坛的用户建议安装[适用于 Windows 2000 SP4 (KB891861) 的更新汇总 1](http://www.microsoft.com/DOWNLOADS/details.aspx?familyid=B54730CF-8850-4531-B52B-BF28B324C662&displaylang=en)来解决此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T12:13:11.800

不幸的是，没有登录文件`profile/Temp`或`C:\windows\Temp`

更新汇总确实有效，谢谢！

# internet-explorer - 如何阻止 IE 在一个范围内“移动”文本 ?

> ID：420042
> 
> 赞同：0
> 
> 时间：2009-01-07T11:55:11.807
> 
> 标签：internet-explorer

谦虚地寻求（当然）IE的帮助。我有一个 div，它是一个简单的背景色块 (#greenback)，它包含另外两个 div。第一个（#billboard）是一些居中的文本，第二个（#picright）包含一个图像。它们彼此相邻排列，左侧是文本，右侧是图像。

在大多数 FF 等中看起来不错，但 IE 对文本 div 做了如下奇怪的事情：（绿色框内的蓝色矩形显示文本 div 的范围；图像 div 以白色边框。）

IE6 将文本部分移出边界到文本 div 的右侧，使其与图像重叠。

[替代文字 http://www.conservationenterprises.com/staging/jan08/IE6.png](http://www.conservationenterprises.com/staging/jan08/IE6.png "IE6")

IE7 将其部分移出边界到文本 div 的顶部。[替代文字 http://www.conservationenterprises.com/staging/jan08/IE7.png](http://www.conservationenterprises.com/staging/jan08/IE7.png "IE7")

IE8 至少将文本保持在 div 的范围内，但忽略了我试图实现的任何内部 div 居中。

[替代文字 http://www.conservationenterprises.com/staging/jan08/IE8.png](http://www.conservationenterprises.com/staging/jan08/IE8.png)

我在文本 div 上尝试了 holly hack，但这似乎没有任何区别（或者是我在 css 中的位置？）。

非常感谢任何帮助...

谢谢，帕特里克。

我的 CSS：（请不要笑，这仍然是我的第一个拼凑在一起的样式表！）

```
#greenback { position: relative;
width: 800px ;
height: 250px ;
background-color: #7EBB11 ;
border: 3px solid #112D82 ;
}

#picright { position: relative ;
float: right;
display: block;
margin-top: 11px;
margin-right: 11px;
margin-bottom: 11px;
max-width: 50%;
max-height: 218px;
border: 3px solid white;
vertical-align: middle ;
}

#greenback>#billboard {/*display:table for Mozilla and Opera*/
display: table ;
position: static ;
}

#billboard  { /* for IE*/
width: 45% ;
height: 99% ;
background-color: #7EBB11 ;
font-family: Optima, Calibri, Candara, Century-Gothic, 
Arial, sans-serif;
font-size: 160% ;
color: #ffffff ;    
position: relative; 
border: 2px solid blue;
}

#billboard div { /*for IE*/
position: absolute;
float: left ;
top: 50%;
}

#billboard>div { /*for Mozilla and Opera*/
display: table-cell ; 
vertical-align: middle ;
position: static;
}

#billboard div div {
position: relative ;
top: -50%;
}

/* Hides from IE5-mac \*/
* html .billboard {height: 1%;}
/* End hide from IE5-mac */ 
```

和我的html：

```
<div id="greenback">
<img src="kids.jpg" alt="kids" id="picright" />
<div id="billboard"><div><div><p>We help businesses,<br>communities and nature<br>take better care<br>of each other.</p>
</div></div></div></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T12:09:33.650

没有 HTML 很难说，但你不应该在同一个元素上使用`position: absolute`and `float: left`- 这真的没有意义。

您可能不应该`position`为此在样式表中的任何地方使用。除非您正在编写脚本，否则通常会远离它。

编辑：试一试：

```
<style>

#greenback {
    width: 800px ;
    height: 250px ;
    background-color: #7EBB11 ;
    border: 3px solid #112D82 ;
}

#picright {
    float: right;
    display: block;
    margin: 11px 11px 11px 20px;
    width: 50%;
    height: 218px;
    border: 3px solid white;
}

#billboard  {
    width: 45% ;
    height: 99% ;
    border: 2px solid blue;
    float: right;
}

#billboard p {
    text-align: center;
    margin: 0;
    border: 1px solid red;
    margin-top: 50px;
    font-family: Optima, Calibri, Candara, Century-Gothic, Arial, sans-serif;
    font-size: 160% ;
    color: #ffffff ;
}
</style>

<div id="greenback">
    <img src="kids.jpg" alt="kids" id="picright" />
    <div id="billboard"><p>We help businesses,<br>communities and nature<br>take better care<br>of each other.</p></div>
</div> 
```

# testing - 广泛使用软件的可用性测试

> ID：420057
> 
> 赞同：1
> 
> 时间：2009-01-07T12:03:51.180
> 
> 标签：testing, usability, usability-testing

有谁知道我在哪里可以找到广泛使用的软件的可用性测试结果？

我希望能够就以下方面做出明智的决定：

*   要在我的软件中复制哪些现有软件包
*   如何在多个包（程序、组件等）之间进行选择。

真的，我会很感激这里的任何事情。
我感兴趣的是：网站、办公软件、电子邮件客户端，应有尽有。
我想要客观的经验信息，了解在特定情况下什么是好的，什么不是。

这个问题的灵感来自[我](https://stackoverflow.com/questions/416766/is-markdown-friendly-enough-for-non-technical-users#416905)对[这个关于 markdown](https://stackoverflow.com/questions/416766/is-markdown-friendly-enough-for-non-technical-users)的问题的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T12:16:14.120

对于初学者，您可以尝试[界面耻辱大厅，](http://homepage.mac.com/bradster/iarchitect/shame.htm)以及[名人堂](http://homepage.mac.com/bradster/iarchitect/fame.htm)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T12:17:52.103

[useit.com 定期](http://www.useit.com/)颁发 10 个最佳 X 奖，例如2009年10[个最佳内部网、](http://www.useit.com/alertbox/intranet_design.html)[2008 年 10 个最佳应用程序 UI](http://www.useit.com/alertbox/application-design.html)等。

如果我没有说清楚，useit.com 是[Jakob Nielsen的网站，前 10 名是](http://en.wikipedia.org/wiki/Jakob_Nielsen_(usability_consultant) "Jakob Nielsen 的维基百科条目")[NN/g](http://www.nngroup.com/about/ "尼尔森诺曼集团")进行的可用性研究的结果。

# perl - 如何在 Perl 中复制符号链接？

> ID：420058
> 
> 赞同：6
> 
> 时间：2009-01-07T12:04:15.797
> 
> 标签：perl, symlink

如何在 Perl 程序中复制符号链接（而不是它指向的文件），同时保留所有符号链接属性（例如所有者和权限）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T12:13:26.637

在 Perl 中，您可以使用该`readlink()`函数找出符号链接的目的地。

您还可以使用该`lstat()`函数读取符号链接的权限（而不是`stat()`读取符号链接指向的文件的详细信息）。

实际上，如果没有额外的帮助，就无法在新符号链接上设置所有权，因为 Perl 不会公开`lchown()`系统调用。为此，您可以使用`Lchown`CPAN 中的 Perl 模块。

假设有足够的权限（nb：未经检查的代码）

```
 use Lchown;
 my $old_link = 'path to the symlink';
 my $new_link = 'path to the copy';

 my $dst = readlink($old_link);
 my @stat = lstat($old_link);

 symlink $dst, $new_link;
 lchown $stat[4], $stat[5], $new_link;  # set UID and GID from the lstat() results 
```

您无需担心符号链接上的权限 - 它们始终显示为`-rwxrwxrwx`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T12:51:15.233

模块[File::Copy::Recursive](http://search.cpan.org/~dmuey/File-Copy-Recursive/Recursive.pm)负责这一点。默认情况下，它将复制符号链接并尝试保留所有权。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-07T12:01:50.610

根据您关于绝对与相对目标路径、目录层次结构等的用例，使用[链接](https://perldoc.perl.org/functions/link.html)创建指向要复制的符号链接的硬链接也可能已经足够了。Perl 在许多平台上也支持不需要额外的包并且创建硬链接。

# windows - 从 Windows 调用 Linux 进程并接收标准输出

> ID：420059
> 
> 赞同：2
> 
> 时间：2009-01-07T12:04:59.023
> 
> 标签：windows, linux, process, invocation

我在我们公司有一个遗留应用程序，它建立在......嗯；经典 VB (VB 6)。它有一个在 Linux 服务器上运行的优化器（CPLEX MIP Solver）组件，并且是用 Java 开发的。

如果我们想提供一个 Windows UI 来调用远程 linux 服务器上的优化器实例；我应该如何实施它？

优化器将输出有关其进度的消息，并且需要在 UI 上显示。

目前我想到了两个选择。

1.  使用 PLINK 调用 linux 进程。不确定它是否可以将 STDOUT 带到 Windows。
2.  构建一个小型 java 应用程序并将其作为守护程序加载到 linux 服务器上并通过 TCP 进行通信。

不胜感激专家建议。感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T12:46:06.023

您还可以使用 SSH 运行命令并捕获其输出，例如，对于 .NET [http://www.codeproject.com/KB/IP/sharpssh.aspx](http://www.codeproject.com/KB/IP/sharpssh.aspx)

您可以使用密钥自动执行登录过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T12:35:45.907

PLINK 选项是迄今为止最容易实现的（前提是您有类似于[`system()`](http://linux.die.net/man/3/system)Win32 API 中的调用的东西）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T13:25:16.023

如果组件是用 Java 编写的，为什么不在 Windows 上使用它呢？如果不是，我误解了你，你有源代码吗？如果是，只需将其复制到 Windows 并重新编译。如果它真的是特定于 Linux 的，[Cygwin](http://www.cygwin.com/)也可能是一个不错的选择。但是，它仍然需要原始源代码。

# sharepoint - 从 SharePoint MOSS 中的 OSSSearchResults.aspx 中删除范围下拉列表

> ID：420064
> 
> 赞同：1
> 
> 时间：2009-01-07T12:07:08.507
> 
> 标签：sharepoint, search, moss

在 SharePoint 中搜索时，结果将返回到名为 OSSSearchResults.aspx 的页面。

此页面具有搜索范围下拉列表，即站点：部门

如何删除此范围，以便整个网站集始终在搜索，而不管我所在的网站如何？

祝一切顺利

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-12T19:06:01.647

您可以通过 Sharepoint 的配置禁用上下文范围。我有类似的问题，[在这里](https://stackoverflow.com/questions/325757/sharepoint-search-redirect-from-osssearchresults-aspx-to-search-centre)描述。在我的情况下，我需要从 OSSSearchResults 页面重定向到搜索中心，或者只是禁用那些重定向到该页面的范围。可以在[此处找到带有一些解释的配置示例](http://www.sharepointusecases.com/index.php/2008/11/configuring-scopes-dropdown/)

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-25T23:51:42.567

尝试一些简单的 Javascript 来设置值并动态隐藏下拉菜单。任务完成！

```
<script language="javascript" type="text/javascript">
var objDDL = document.getElementById("ctl00_g_edb49d82_8042_45e7_b0f7_2fa3fbed4ae6_SBScopesDDL");
if( objDDL ) {
    objDDL.selectedIndex = 0;
    objDDL.style.display="none";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-14T13:43:05.950

只需将这个类从 core.css 继承到您的主题中：

SELECT.ms-searchbox{ 可见性：隐藏；}

然后选择将消失。

享受 ！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T15:11:56.307

这是 Windows SharePoint Services V3.0 搜索的搜索页面，它几乎是一成不变的。它不像 MOSS 2007 搜索中心那样灵活，您可以在其中自定义搜索 Web 部件、搜索范围等等。WSS 搜索只允许您搜索单个站点和子站点。不支持跨站点搜索 - 您需要企业搜索解决方案才能做到这一点。

现在，我猜您不想或不需要投资 MOSS 2007。但是您可以考虑在您的 WSS 服务器旁边设置一个新的 Search Server 2008 Express（免费）。这以低成本为您提供企业搜索功能。让 MSS 2008 索引您的所有 WSS 网站集，并让用户从 MSS 2008 服务器上的搜索中心网站进行搜索。

然而，一个缺点是您的 WSS 站点上的小搜索框仍将指向 OSSSearchResults.aspx 页面。您将需要安装另一个搜索框以将用户引导至 MSS 2008 搜索中心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-11T13:59:25.710

您可以直接编辑该文件，尽管这不是推荐的做法。该文件`\12\TEMPLATE\LAYOUTS\osssearchresults.aspx`位于第 97 行，相关控件位于第 97 行：

```
<SPSWC:SearchBoxEx id="SearchBox" runat="server" 
          GoImageUrl="/_layouts/images/gosearch.gif" 
          GoImageUrlRTL="/_layouts/images/gosearch.gif" 
          DropdownModeEx=ShowDD_DefaultURL
          ScopeDisplayGroupName = ""
          FrameType="None" 
          ShouldTakeFocusIfEmpty=true /> 
```

# c++ - 最佳跨平台 C++/QT4 开发环境

> ID：420065
> 
> 赞同：7
> 
> 时间：2009-01-07T12:07:32.750
> 
> 标签：c++, eclipse, qt4, cmake, kdevelop

我想使用 C++ 和 QT4 开发跨平台应用程序。我在 Linux 和 Windows (MinGW) 上都编码。

目前我正在使用 KDevelop，它是 QMake 集成。在 Windows 上，我正在尝试带有 QT 集成插件的 Eclipse。然而，在两个系统上移动源和更新配置文件/IDE 项目文件是乏味的。

我正在研究使用 CMake，因为它可以生成 Makefile、KDevelop 项目文件和 Eclipse 项目文件。

你怎么看？你用什么来进行这种开发？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-07T12:31:49.253

[QtCreator](http://labs.trolltech.com/blogs/category/qtcreator/)呢？它仍处于测试阶段，但它非常轻巧，使用它编写代码真的很有趣。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T19:15:01.467

I've been using the new QtCreator and like it so far. Still beta though and may be missing a few tools or features that you need. QtDesigner is integrated with it. It uses QMake project (.pro) files behind the scenes, so you or other programmers can just use those directly on the command line (qmake and make) along with their favorite text editor if they don't want or can't use an IDE at some point. [http://trolltech.com/developer/qt-creator](http://trolltech.com/developer/qt-creator)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T12:43:28.993

我不明白为什么你必须在两个平台上都使用 IDE。我在 Linux 上使用 KDevelop，对于每个测试，我只是将源同步到 mac 和 windows，并在每个本地进行/测试。如果出现问题，我会在 Linux 上的原始资源中修复它。

我很少想在 mac/win 上编辑一些东西，为此任何像样的编辑器就足够了（BBedit/Notepad++）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T13:06:36.793

我会推荐 CMake 来完成这项任务。一旦掌握了窍门，就可以很容易地使用 FindQT CMake 模块创建使用 QT 的跨平台应用程序或库。

有使用 CMake 作为构建系统的开源 QT 和 KDE 项目，因此如果您需要查看真实用例（我做过），可以查看他们的代码。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T13:16:28.070

[`qt-apps.org environment tools`](http://qt-apps.org/index.php?xcontentmode=4260)列出了许多免费的开发环境，以及更通用的开发工具。[`kde-apps.org environment tools`](http://www.kde-apps.org/index.php?xcontentmode=260)还有另外一堆工具，其中一些也可以在 Windows 上运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T13:24:22.780

您可以在 Windows 和 Linux 上使用 Eclipse 中提到的 Qt 插件。当您从一个平台转移到另一个平台时，您唯一需要做的就是再次运行 qmake 以确保您的 make 文件正确且是最新的。但我相信（我没有尝试过）你可以配置你的 eclipse 环境来处理自动构建时的 qmake 执行。请注意，Qt 插件还允许您执行您在 Qt Designer 中所做的一切。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T12:21:30.630

[Qt 设计师](http://trolltech.com/products/appdev/developer-tools/developer-tools?currentflipperobject=73543fa58dda72c632a376b97104ff78)呢？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-26T15:57:28.653

Eclipse 是一个非常非常好的候选者（你得到一个很好的 SVN 集成，Mylyn 用于很棒的任务和其他很棒的插件的世界）但有时你必须处理奇怪的问题。否则它是一个很棒的 IDE。注意：非常适合 Java 开发。

# silverlight - Silverlight 中是否可以将 DataGrid 的列标题文本绑定到资源字符串？

> ID：420067
> 
> 赞同：2
> 
> 时间：2009-01-07T12:08:12.543
> 
> 标签：silverlight, xaml

我需要将 DataGrid 的列标题文本绑定到 XAML 文件中的资源字符串。有人知道这是否可能吗？

列标题定义如下所示，但我想用资源文件中的文本替换“MyHeaderText”：-

```
<data:DataGridTextColumn Header="MyHeaderText" Binding="{Binding SomeData}" IsReadOnly="True"/> 
```

资源字符串将在 UserControl.Resources 部分中设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T14:51:50.707

标题显示区域是有限的。您可以通过使用字符串而不是 UIElement 来实现这一点。确保您的 xaml 文件中有“系统”命名空间的 xmlns，如下所示：

```
xmlns:sys="clr-namespace:System;assembly=mscorlib" 
```

然后在您的 UserControl 的资源部分中定义以下内容：

```
<sys:String x:Key="MyHeader">My Header Text</sys:String> 
```

然后你基本上可以按照 Sorskoot 所说的去做，而且你不应该收到错误：

```
<data:DataGridTextColumn Header="{StaticResource MyHeader}" Binding="{Binding SomeData}" IsReadOnly="True" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T13:36:35.703

你有没有尝试过类似的东西：

```
<data:DataGridTextColumn Header="{StaticResource SomeData}" 
                         IsReadOnly="True"/> 
```

其中“SomeData”是您的资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T16:01:58.880

请注意，如果需要，您可以做的不仅仅是使用文本值，而是需要使用 HeaderStyle 属性而不是 Header 属性。

# javascript - 最高效的 javascript/AJAX 工具包？

> ID：420069
> 
> 赞同：9
> 
> 时间：2009-01-07T12:08:48.127
> 
> 标签：javascript, ajax

什么是最高效的 Javascript/AJAX 工具包？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-07T12:10:18.967

jQuery 目前看起来很流行，而且是轻量级的。

*   [http://jquery.com/](http://jquery.com/)

他们的 API 构造和设计都很好，生成的代码往往非常简洁。

有些人可能会觉得它太简洁了 - 品味问题。在较大的项目中，我有时最终会使用 YUI——它的重量级要大得多，但对于大型代码库，我发现阅读一些更明确的东西更容易。

*   [http://developer.yahoo.com/yui/](http://developer.yahoo.com/yui/)

真的，这是一个主观的问题。最有效的将取决于对您的编码风格最有意义的内容、您正在尝试做的事情以及您正在与之交互的内容。

祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-07T12:13:29.897

根据[这个比较](http://blog.creonfx.com/javascript/dojo-vs-jquery-vs-mootools-vs-prototype-performance-comparison)，jQuery 做得相当不错。当然比原型更好。就我个人而言，我也喜欢 jQuery 的流畅界面模型和简洁性。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-07T12:53:25.840

这实际上取决于您要实现的环境，框架和目标......

其实最好的答案是：多学一个……没有灵丹妙药。

在我选择一个时，MooTools 是性能最高的，现在一天的性能差异非常有限。

如果在 ASP.NET ajax 中有一个开箱即用的控件，我会为自己使用以下规则（我在 ASP.NET 中编写了很多代码）。如果我需要编写自定义的东西，我会使用 Mootools。（您也可以在 asp.net ajax 中执行此操作，但我个人认为我在 Mootools 中编写了更好更快的代码）

要考虑的另一件事：jquery 与 asp.net ajax 配合得很好（=您可以在同一页面上同时使用两者），而 Mootools 则不能（这是一种设计决策，使 mootools 的性能更高一些）。在我看来，如果您需要在同一页面上使用多个框架，则会产生大量不必要的开销。

我知道我只考虑了 Mootools 和 jquery，而还有很多其他框架（Yui，它的命名空间很重 = 更冗长 = 为什么我不喜欢它 :)），但大多数其他框架（Dojo 套件，. ..) 尝试抽象出 javascript 的 javascript 特性...我尽量不这样做。

一些有用的链接：

[Clientside 写了一篇很好的文章，说明了他选择 Mootools 的原因](http://www.clientcide.com/3rd-party-libraries/mootools-followup/)（在 CNET 工作时）

[以及他重新评估它的后续行动。](http://www.clientcide.com/best-practices/jquery-and-the-ajax-experience-programming-to-the-pattern-and-what-really-makes-one-framework-different-from-another/)

[另一个比较页面](http://mootools.net/slickspeed/)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-07T16:44:03.907

选择对您最熟悉的库。

随着两件事的发生，效率上的差异将变得越来越不重要。

1.  [浏览器在解释 Javascript 方面变得越来越好。](http://ejohn.org/blog/javascript-performance-rundown/)
2.  [大多数主要的 Javascript 库都计划采用一个单一的选择器引擎，Sizzle](http://ajaxian.com/archives/a-great-example-of-sharing-sizzle-engine-in-dojo-foundation)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T23:23:23.180

我喜欢[jQuery](http://jquery.com/)。爱它。想与之交配。我讨厌*一切。*不要让我开始*任何事情。*我恨它。但我喜欢 JQuery。

力量和功能是壮观的。

它设计精良且易于使用。

[文档](http://docs.jquery.com/Main_Page)完整、准确、详细、清晰且最新。每个函数都用代码示例和一个工作示例进行了解释。

有一个很好的[插件](http://plugins.jquery.com/)集合。

还有一个[JQuery UI](http://ui.jquery.com/)库，它提供了另外一层功能——拖放、模式对话框、各种控件等。

我已经使用 JQuery 多年了，它从来没有让我失望过。对于我经常使用的任何其他库/语言/工具/计算机，我真的不能这么说。jQuery 是惊人的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T12:11:33.613

“最高效”很难判断，但我使用过 Prototype 和 Mootools，这两种工具都很容易上手。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T12:14:48.117

[Dojo Toolkit](http://www.dojotoolkit.org/)也不错，可定制、可主题化等。

编辑：在[Cletus 发布的比较](http://blog.creonfx.com/javascript/dojo-vs-jquery-vs-mootools-vs-prototype-performance-comparison)链接中，它适用于每个经过测试的平台，也是最快的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T12:19:02.320

我们在工作中使用 Mootools，它非常好用且轻量级。至于效率，谁能说得清？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-07T12:32:25.723

根据您必须使用 AJAX 做什么，您可以查看 jQuery 或[ExtJs](http://www.extjs.com) ( [http://www.extjs.com](http://www.extjs.com) )

正如在前面的答案中已经说过的那样，jQuery 非常高效且轻量级，几乎可以满足您的所有需求。

如果你需要非常丰富的 UI，ExtJs 有非常好的特性和非常完整的 API，但从我的经验来看，它是相当重的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-07T16:58:53.503

对于一般的 javascript 开发，我使用[Jquery](http://jquery.com)，对于 AJAX，我使用[Xajax](http://xajaxproject.org/)和 PHP，这太棒了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T13:04:21.837

这实际上归结为偏好问题，并且在较小程度上取决于您使用的平台。只看客户端实现，我是 jQuery 的忠实粉丝，因为我喜欢它提供的简洁语法。我也在不同的项目中使用 Prototype、YUI 和 Mootools，但仍然更喜欢 jQuery。

根据您的平台，还有其他可能性。例如，如果您使用 .Net，AJAXPro 和 Microsoft AJAX 提供了一些非常快速和简单的方法来将完整的 AJAX 基础结构添加到您的解决方案中。我不是 MS AJAX 的粉丝，但我无法争辩一些可以用它完成的快速而肮脏的技巧。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-07T13:24:38.927

[Prototype](http://www.prototypejs.org/)有一些很好的 Ajax 支持，还有很多清晰的[例子](http://www.prototypejs.org/api/ajax/request)可以帮助你。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-07T22:08:20.710

我发现即使有所有不同的 AJAX 工具包，我仍然更容易手动编写 AJAX。编写 AJAX 调用相当简单，您不必处理由于一些抽象代码而在后台发生的事情。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-14T03:51:00.073

感谢您的回答...我现在可以说 jQuery、EXT 是有利的。我还在检查 YUI 和 Ajax。谢谢！:)

我同意。道场很难。我试过了，结果很难。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-14T03:54:17.443

您也可以尝试使用原型库的 scriptaculous

[http://script.aculo.us/](http://script.aculo.us/)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-15T10:12:54.673

每个浏览器都有一个（漂亮的）TaskSpeed 基准测试，您可以在[http://dante.dojotoolkit.org/taskspeed/](http://dante.dojotoolkit.org/taskspeed/)

结果整理到 [http://dante.dojotoolkit.org/taskspeed/report/charts.html](http://dante.dojotoolkit.org/taskspeed/report/charts.html)[](http://dante.dojotoolkit.org/taskspeed/report/charts.html)

# css - 强制描述小部件换行

> ID：420076
> 
> 赞同：2
> 
> 时间：2009-01-07T12:12:06.483
> 
> 标签：css, firefox, xul

我试图在要包装的 XUL 应用程序中获取描述，即使它包含长行。

例如，如果我将以下内容保存为 .xul 文件并在 Firefox 中打开它，它看起来很好并且可以适当地换行：

```
<?xml version="1.0"?>
 <?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
 <window
    id="theWindow"
    title="The Window"
    style="overflow: auto;"
    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
    xmlns:html="http://www.w3.org/1999/xhtml"
    >

  <vbox flex="1" style="max-width: 200px; overflow:auto; border: 1px dotted black; padding: 2px;">
    <description style="border: 1px solid black; padding: 2px;">test</description>
    <description style="border: 1px solid black; padding: 2px;">test test test test test test test test test test test test test test test test test test test test test</description>
  </vbox>
</window> 
```

但是，如果我删除大行中的空格，它不会被包裹，我只是得到一个滚动条来查看该行：

```
<?xml version="1.0"?>
 <?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
 <window
    id="theWindow"
    title="The Window"
    style="overflow: auto;"
    xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
    xmlns:html="http://www.w3.org/1999/xhtml"
    >

  <vbox flex="1" style="max-width: 200px; overflow:auto; border: 1px dotted black; padding: 2px;">
    <description style="border: 1px solid black; padding: 2px;">test</description>
    <description style="border: 1px solid black; padding: 2px;">testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest</description>
  </vbox>
</window> 
```

当长线达到 200 像素限制时，有什么方法可以使用 CSS 或其他任何方法强制换行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-12T18:16:38.187

Firefox 3.1 支持这个：[http ://www.css3.info/preview/word-wrap/](http://www.css3.info/preview/word-wrap/)

> word-wrap 属性是由 Microsoft 发明并添加到 CSS3 中的。它允许长单词能够被打破并换行到下一行。它有两个值；正常或断词。目前在 IE、Safari 和 Firefox 3.1 (Alpha) 中支持此功能。

对于旧（和当前）版本的 Firefox，没有标准的方法（谷歌是我的朋友）。有些人建议使用`<br />`在单词中间添加的小脚本。使用*word-wrap:break-word*并希望用户最终升级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-09T19:56:39.873

最初 ChatZilla 用于将空的 <img> 元素分散到输出中，这些元素将作为长单词可以换行的点，尽管后来改为 <wbr> 元素。

# c - 无法在 DevC++ 中的语句后声明变量

> ID：420095
> 
> 赞同：1
> 
> 时间：2009-01-07T12:18:00.857
> 
> 标签：c, variables, declaration

这里的问题是，在函数中已经有一些语句之后，我不能在函数中声明变量。在开始时声明工作正常，但在某些事情之后，它会给出一个解析错误。例如：

```
int main()
{
 int b;
 b = sisesta();
 float st[b];

 return 0;
} 
```

我想声明一个数组`st`，其大小由另一个函数返回，但它不允许我这样做！说“在浮动之前解析错误”。顺便说一句，这是在 C 语言中，但我想它与在其他语言中具有相同语法的语言相同。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T12:28:19.243

在 C99 之前的 C 标准中，您必须在函数的开头声明局部变量。从 C99 开始，不再需要这样做。

由于 Dev-C++ 附带 gcc 并且最近的 gcc 版本确实部分支持 C99，因此您可以尝试添加`-std=c99`到 Dev-C++ 设置中的 gcc 参数列表以触发 C99 模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T12:23:49.503

C语言中的老兄，您必须在开始时声明所有变量。您不能在语句之间声明

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T08:57:16.407

事实证明，我只是有一个旧版本的 DevC++，它不支持较新的标准，最新版本的语句工作正常，无论如何感谢您的帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T12:39:59.703

你可以[`malloc()`](http://www.cl.cam.ac.uk/cgi-bin/manpage?3+malloc)选择`float*`你想要的大小（[`free()`](http://www.cl.cam.ac.uk/cgi-bin/manpage?3+free)事后记住）：

```
int main()
{
 int b;
 float *st;

 b = sisesta();

 if((st = malloc(sizeof float * b)) == NULL){exit 1;}

 /* blah blah */

 free(st);
 return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-18T12:11:27.280

即使在 C89 中，在函数开头进行所有声明也只是一种风格选择 - 您在代码中遇到的问题是您试图在未知大小的堆栈上声明一个数组，这是不允许的直到 C99。如果您要执行相同的代码，但将“float st[b]”替换为“b”为常量的语句，它将起作用，例如“float st[10]”

# .net - Retrieving application settings after a name change?

> ID：420097
> 
> 赞同：0
> 
> 时间：2009-01-07T12:18:18.297
> 
> 标签：.net, winforms, configuration

I have a Windows forms application that contains per-user settings. I'm using Properties.Settings.Default.Upgrade() to preserve these settings between versions and everything is fine. Recently I had to change the exe name of my application, so after an upgrade, all settings revert to default values.

I guess the settings system thinks it is a different application, so my question is, is there some way to retrieve the settings of another application (the old one)?

System.ConfigurationManager has a few methods for opening config-files other than that of the current application, (i.e.System.Configuration.ConfigurationManager.OpenMappedExeConfiguration) but they all seem to open specific config files.

I want to read per-user settings, and these are buried in obscure locations in the LocalSettings folder, so I wouldn't know what to pass in to these methods.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-05T15:51:59.767

For completeness.. I ended up with this hack. Ugly, but it works.

In Main method
// Only do upgrade check if we have no settings if (string.IsNullOrEmpty(Properties.Settings.Default.Categories)) { UpgradeAppSettings(); }

With these methods in the same class.

```
 private static void UpgradeAppSettings()
  {
     try // Fail silently! This hack is not important enough to cause problems
     {
        List<string> paths = new List<string>();
        paths.Add(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData));
        paths.Add(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData));

        foreach (string path in paths)
        {
           string companypath = System.IO.Directory.GetDirectories(path, "COMPANYNAME").FirstOrDefault();
           if (companypath != null)
           {
              string appfolder = System.IO.Directory.GetDirectories(companypath, "OldName.exe_*").FirstOrDefault();

              if (appfolder != null)
              {
                 // Get the highest version of the app that contains a user.config file
                 var version =
                    System.IO.Directory.GetDirectories(appfolder)
                    .Select(
                       d => new
                       {
                          Path = d,
                          Version = CreateVersion(new System.IO.DirectoryInfo(d).Name),
                          ConfigFile = System.IO.Directory.GetFiles(d, "user.config").FirstOrDefault()
                       }
                    )
                    .Where(v => v.Version != null && v.ConfigFile != null)
                    .OrderByDescending(v => v.Version)
                    .FirstOrDefault();
                 if (version != null)
                 {
                    string text = System.IO.File.ReadAllText(version.ConfigFile);

                    // Change the namespace for serialized categories
                    text = text.Replace(
                       "http://schemas.microsoft.com/clr/nsassem/OldName/OldName",
                       "http://schemas.microsoft.com/clr/nsassem/OldName/NewName");

                    var doc = XDocument.Parse(text);
                    var settings = doc.Descendants("setting");

                    // These are the settings we are interested in
                    ApplySetting(settings, "Categories", s => Properties.Settings.Default.Categories = s);
                    ApplySetting(settings, "ActiveCategoryFilter", s => Properties.Settings.Default.ActiveCategoryFilter = s);
                    ApplySetting(settings, "ActiveCategoryFilterDisplayName", s => Properties.Settings.Default.ActiveCategoryFilterDisplayName = s);
                    ApplySetting(settings, "ListViewLayout", s => Properties.Settings.Default.ListViewLayout = s);
                    ApplySetting(settings, "SplitterSizes", s => Properties.Settings.Default.SplitterSizes = s);
                    ApplySetting(settings, "EditorSizes", s => Properties.Settings.Default.EditorSizes = s);
                    ApplySetting(settings, "WindowStates", s => Properties.Settings.Default.WindowStates = s);
                    ApplySetting(settings, "WindowStates", s => Properties.Settings.Default.WindowStates = s);
                    break;
                 }
              }
           }
        }
     }
     catch { }
  }

  private static void ApplySetting(IEnumerable<XElement> settings, string name, Action<string> action)
  {
     var cat = settings.FirstOrDefault(s => s.Attribute("name") != null && s.Attribute("name").Value == name);
     if (cat != null)
     {
        action(cat.Value);
     }
  } 
```

# c++ - 这是'type variableofType()'函数还是对象？

> ID：420099
> 
> 赞同：4
> 
> 时间：2009-01-07T12:18:22.803
> 
> 标签：c++, function, pointers

```
#include<iostream>
class name
{
public:
    int a;
    name():a(0){};
};
void add(name * pname)
{
    pname = NULL;
}
int main()
{
    name varName();
    name * pName = new name();
    add(pName);
    add(&varName);//error C2664: 'add' : cannot convert parameter 1 from 'name __cdecl *)(void)' to 'name *'
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-07T12:24:32.667

错误出现在 main 函数的第一行：

```
name varName(); 
```

您**没有**使用默认构造函数创建类*名*的实例，实际上是在声明一个名为*varName*的新函数，没有参数，它返回一个*名称*实例。

你应该写：

```
name varName; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T13:00:00.443

我认为值得告诉你一个类似的问题，这也会引起麻烦：

```
struct foo { };
struct bar { bar(foo f); };

int main() {
  // does *not* create a bar object initialized by a default constructed 
  // foo object.
  bar b(foo());
} 
```

真正的 b 是一个返回 a 的函数，并将`bar`一个指向函数的指针作为第一个参数，该函数返回一个不带参数的 foo 。它与以下内容相同：

```
bar b(foo(*)()); 
```

如果要创建由默认构造的 foo 初始化的 bar 对象，请在参数周围加上括号。这使它看起来不再像函数声明，编译器会像你想要的那样解释它：

```
bar b((foo())); 
```

* * *

还有一些不明显的情况应该出现编译器错误。GCC 弄错了，但 Comeau 又弄对了。考虑以下代码段

```
struct foo {
  static bool const value = false;
};

int main() {
  int v(int(foo::value));
} 
```

您可能会期望这需要静态常量，并将其强制转换为，将变量`int`初始化为? 不，它不会根据标准，因为初始化器可以解释为声明，根据纯语法分析，如下所示`v``0`

```
struct foo {
  static int value;
};

// valid, parentheses are redundant! Defines `foo::value`.
int (foo::value); 
```

每当初始化器可以被解释为声明时，在这种情况下整个声明将声明一个函数。因此，in 中的行`main`声明了一个如下所示的函数，省略了多余且无意义的括号

```
int v(int foo::value); 
```

而这在解析函数声明时会导致编译器错误，因为函数参数名可能没有被限定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T14:35:17.163

还值得注意的是，您的 add() 函数没有任何持久效果——它所做的只是为 pname 分配一个值，这是您传递给它的指针的副本。如果您想真正拥有该分配棒，则需要通过引用将指针作为“name *＆pname”传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T12:26:46.797

```
name varName(); 
```

被解释为局部函数声明。要调用默认构造函数，请使用

```
name varName; 
```

反而。最令人烦恼的是，是的。

# asp.net-mvc - 对 HTTP POST 请求的正确响应是什么？

> ID：420103
> 
> 赞同：30
> 
> 时间：2009-01-07T12:20:02.303
> 
> 标签：asp.net-mvc, http, http-headers

对于 POST 方法，W3 规范说：

> 如果在源服务器上创建了资源，则响应应该是 201（已创建）并包含描述请求状态并引用新资源的实体和 Location 标头（参见第 10.4 节）。

[http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p2-semantics-05.txt](http://www.ietf.org/internet-drafts/draft-ietf-httpbis-p2-semantics-05.txt)（第 8.5 节）

标准响应实际上似乎是向新创建的资源发送重定向。

我正在使用 ASP.NET MVC 构建我的网站，并尝试遵循规范，因此创建了一个`ResourceCreatedResult`类：

```
public class ResourceCreatedResult : ActionResult
{
    public string Location { get; set; }
    public override void ExecuteResult(ControllerContext context)
    {
        context.HttpContext.Response.Clear();
        context.HttpContext.Response.StatusCode = 201;
        context.HttpContext.Response.ClearHeaders();
        context.HttpContext.Response.AddHeader("Location", Location);
    }
} 
```

我的动作看起来像这样：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult CreateNew(string entityStuff)
{
    Entity newEntity = new Entity(entityStuff);
    IEntityRepository entityRepository = ObjectFactory.GetInstance<IEntityRepository>();
    entityRepository.Add(newEntity);

    ActionResult result = new ResourceCreatedResult()
        { Location = Url.Action("Show", new { id = newEntity.Id }) };
    return result;
} 
```

但是，IE、Firefox 和 Chrome 都无法重定向到新资源。我是否搞砸了生成正确的响应，或者网络浏览器不期望这种类型的响应，而是依靠服务器发送重定向响应？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-24T13:01:57.460

`HTTP 201: Created`明确地说，浏览器（包括 Firefox 3 和 IE8 等现代浏览器）不会“接受提示”，而是通过对 Location 标头中提供的 URI 的 GET 请求来跟进响应。

如果您希望浏览器转到 Location 标头中提供的 URI，则应`HTTP 303: See Other`改为发送状态。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-07T12:52:44.153

发布后重定向或发布/重定向/获取是您的应用程序必须做的事情以使用户友好。

**编辑**. 这超出了 HTTP 规范。如果我们在 POST 后简单地返回 201，浏览器后退按钮的行为就会很糟糕。

请注意，Web 服务请求（不响应浏览器）完全遵循标准，并且不会在发布后重定向。

它是这样工作的。

1.  浏览器发布数据。

2.  您的应用程序验证数据。如果它是无效的，你用表单来回复，这样他们就可以修复它并发布。

3.  您的应用程序以重定向响应。

4.  浏览器获取重定向并执行 GET。

5.  您的应用程序看到 GET 并做出响应。

现在 - 嘿presto！-- 后退按钮有效。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-27T04:42:03.003

我的解决方案是响应“201 Created”，其中包含一个简单页面，其中包含指向新资源的链接，以及使用 location.replace() 的 javascript 重定向。

这使得相同的代码可以用于 API 和浏览器请求，可以很好地使用 Back 和 Refresh 按钮，并在旧浏览器中优雅地降级。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T13:25:41.017

如规范中所述，响应应该是带有重定向的 HTTP 201。因此，浏览器供应商不必强制执行正确的答案......

您应该尝试更改为 30x 代码以查看它是否被正确重定向。如果是这样，这是一个浏览器问题，否则它可能来自您的代码（我不知道 ASP.NET 中的任何内容，所以我无法“验证”您的代码）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-27T04:57:59.087

难道这不应该只在“创建”某些东西时才算，因此一个简单的重定向到行动应该就足够了吗？

# c++ - Symbian C++ - 移除或隐藏组件（即 CEikLabel）

> ID：420109
> 
> 赞同：2
> 
> 时间：2009-01-07T12:23:15.417
> 
> 标签：c++, symbian, carbide

看似简单的问题，但我无法解决。

我想在某个时候隐藏 CEikLabel。我想要一个像..

```
myLabel->SetVisible(EFalse); 
```

或者..

```
myLabel->RemoveFromView(); 
```

我意识到我可以使用`myLabel->SetTextL(_L(""));`，但这不是我想做的。

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T13:18:30.530

MakeVisible(TBool aVisible) 怎么样？

也[可以在 Symbian 论坛中阅读](http://discussion.forum.nokia.com/forum/showthread.php?t=107472)

# inversion-of-control - Castle Windsor - 嵌套运行时依赖项

> ID：420114
> 
> 赞同：1
> 
> 时间：2009-01-07T12:24:38.190
> 
> 标签：inversion-of-control, castle-windsor

我正在使用 Castle Windosr 容器。我希望能够在运行时指定一些构造函数依赖项，这显然可以通过使用带有字典的 Resolve 重载来完成，一切都很好。但是，如果我想为根的依赖项指定运行时依赖项，那么我迷路了，目前我已经通过显式创建每个项并将其嵌入来解决。本质上它是一个装饰器场景，我想获得一个实例decator，同时在运行时为正在装饰的对象提供依赖项。有任何想法吗？我宁愿不必做我在下面做的事情，也不想让 decarator 构造函数填充下面的对象，因为有时依赖项会不一样。

```
 public static IActivity GetActivityFromIoC(string key, Message message, Audit audit)
        {

            IActivity activity = IoC.Resolve<IActivity>(key, new Dictionary<
                                                                              string, object>(){
                { "message", message }
                });

            IActivity auditingActivity = IoC.Resolve<IActivity>("auditing.activity", new Dictionary<
                                                                              string, object>(){
            { "activity", activity },     
            { "message", message },
            { "audit", audit }

                });

            return auditingActivity;

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-22T22:11:53.890

您可能可以通过编写自己的[ISubDependencyResolver](http://api.castleproject.org/html/M_Castle_MicroKernel_ISubDependencyResolver_Resolve.htm)实现来处理此问题，该实现将为您完成。单独的容器不允许这样做，而且很可能永远不会。为什么？简短的回答是 - 通过这样做，您可以对组件的依赖关系做出假设，这是一个禁忌，容器就是从调用者那里删除这种知识。

# javascript - 用 javascript 做书签

> ID：420118
> 
> 赞同：1
> 
> 时间：2009-01-07T12:25:36.020
> 
> 标签：javascript

我想使用 javascript 代码为我的网页制作书签。我想要一个 javascript 代码来制作一个应该在新窗口中打开的书签。

我正在使用火狐。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T12:32:26.707

使用这个功能：

```
function bookmark_us(url, title){
if (window.sidebar) // firefox
    window.sidebar.addPanel(title, url, "");
else if(window.opera && window.print){ // opera
    var elem = document.createElement('a');
    elem.setAttribute('href',url);
    elem.setAttribute('title',title);
    elem.setAttribute('rel','sidebar');
    elem.click();
}
else if(document.all)// ie
    window.external.AddFavorite(url, title);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T12:52:33.220

在 Firefox 中，目前没有办法做到这一点（并且在 bugzilla中[提交了跟踪此缺陷的错误）](https://bugzilla.mozilla.org/show_bug.cgi?id=214530)

“无法做到这一点”是指您可以使用 Dreas 提供的功能，但您将仅限于添加默认为侧边栏的书签。最终用户将不得不手动取消选中“在侧边栏中打开”选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T13:40:59.097

询问 Mozilla 用户组之一（可能是[mozilla.dev.tech.xul](http://groups.google.com/group/mozilla.dev.tech.xul/topics)或[mozilla.dev.tech.xpcom](http://groups.google.com/group/mozilla.dev.tech.xpcom/topics)）。可以想象，您可以创建正确的 XPCOM 对象来访问浏览器的书签管理器——这需要启用权限（用户必须明确批准此操作）。不能移植到其他浏览器（显然），也许不是这样做的好方法。

我见过的大多数促进书签的网站（[Jesse Ruderman 的书签页面](https://www.squarefree.com/bookmarklets/webdevel.html)就是一个很好的例子）只是要求用户将适当的书签拖到他们选择的书签文件夹中，这似乎比尝试自动添加更直接/简单书签的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T18:58:00.300

```
function bookmark_us(url, title){
    if (window.sidebar) // firefox
        window.sidebar.addPanel(title, url, "");
    else if(window.opera && window.print){ // opera
        var elem = document.createElement('a');
        elem.setAttribute('href',url);
        elem.setAttribute('title',title);
        elem.setAttribute('rel','sidebar');
        elem.click();
    } else if (document.all) // ie
        window.external.AddFavorite(url, title);
} 
```

When used with:

```
<a href="#" onclick="bookmark_us('http://www.yahoo.com/', 'Yahoo!');return false;">Bookmark Us</a> 
```

The above function no longer works as desired in Opera 9.x. It simply navigates to www.yahoo.com.

* * *

To make a link that pops up the Add Bookmark dialog in Opera 9.x, use the following:

```
function bookmark_us(url, title) {
    if (window.sidebar && window.sidebar.addPanel) // firefox
        window.sidebar.addPanel(title, url, "");
    else if (window.external && 'undefined' != typeof window.external.AddFavorite) // ie
        window.external.AddFavorite(url, title);
}

<a href="http://www.yahoo.com/" rel="sidebar" title="Yahoo!" onclick="bookmark_us(this.href, this.title);return false;">Bookmark Us</a> 
```

# .net - ASP.NET 许可 DLL

> ID：420121
> 
> 赞同：-1
> 
> 时间：2009-01-07T12:26:50.963
> 
> 标签：.net, dll, licensing

我已将我的 .NET 应用程序编译为 Web 部署项目，并收集了一堆包含背后代码等的 DLL。

我想知道保护这些 DLL 的最流行的方法是什么？

在我的搜索过程中出现了几次许可，任何人都可以对此有所了解吗？

或者欢迎任何其他想法谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T12:44:37.010

[如果你看这里](https://stackoverflow.com/questions/413246/protect-asp-net-source-code)，我想你可以找到你的答案。有很多不错的许可证，但请阅读如何保护代码。

# asp.net - 回发破坏了我的 GridView 列中的用户控件

> ID：420130
> 
> 赞同：3
> 
> 时间：2009-01-07T12:29:49.240
> 
> 标签：asp.net, gridview, user-controls, asp.net-2.0

我有一个 ASP.NET GridView，它使用模板列和用户控件来允许我动态构建数据网格。现在我正在实现用于插入行的事件处理程序。为此，我创建了一个默认值数组并将其添加到充当数据源的数据表中。但是，当我的 OnLoad 事件在回发时触发时，我的所有模板列都不再具有用户控件。我的 gridview 最终只是一片空白，里面什么都没有，我的按钮列也消失了（其中包含添加行、删除行和保存按钮）。

我的行添加事件就是这样做的：

```
 public void AddDataGridRow()
    {
        List<object> defRow = new List<object>();

        for (int i = 0; i < fieldNames.Count; i++)
        {
            defRow.Add(GetDefaultValueFromDBType(types[i]));   
        }

        dt.Rows.Add(defRow);
    } 
```

它是从用户控件中的按钮触发的，该控件的实现如下：

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        ((Scoresheet)(this.Page)).AddDataGridRow();
    } 
```

我的加载事件在第一次运行时会做很多事情来设置 GridView，但我不会通过使用 IsPostBack 属性来再次运行它。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
            Initialize();
    } 
```

任何人都知道为什么我的用户控件消失了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T14:41:28.117

您必须在每个 page_load 上将控件添加到网格中，而不仅仅是 (!Postback)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T14:31:21.257

您在用户控件和 GridView 上有 EnableViewState=true 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T14:40:12.130

是否由 Initialize() 调用 AddDataGridRow() 方法？你基本上有两个选择：

1.  在每个回发上绑定网格并且不使用视图状态（性能损失）
2.  仅在第一次绑定 Grid（如果 (!IsPostBack)），并确保您的用户控件保持其视图状态。

从您的代码中，尚不清楚用户控件是否保持视图状态以及它们在其中的内容。甚至不清楚您显示的方法的执行顺序是什么。没有绑定逻辑，所以即使你不断添加行，网格可能仍然没有被绑定。请详细说明一下并显示整个页面的代码隐藏。

# c# - Response.Redirect 使用不同的引用者

> ID：420136
> 
> 赞同：1
> 
> 时间：2009-01-07T12:31:58.660
> 
> 标签：c#, asp.net, response.redirect, referrer, referer

我在 aspx 网页中有以下代码：

```
Response.Redirect("/Someurl/"); 
```

我还想通过重定向发送一个不同的推荐人，例如：

```
Response.Redirect("/Someurl/", "/previousurl/?message=hello"); 
```

这在 Asp.net 中是可能的还是仅由浏览器处理的引荐来源网址？

干杯斯蒂芬

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T12:42:43.880

推荐人是只读的，并且是这样的。我不知道你为什么需要它，但你可以发送查询变量而不是

```
Response.Redirect("/Someurl/"); 
```

你可以打电话

```
Response.Redirect("/Someurl/?message=hello"); 
```

并在那里得到你需要的东西，如果有帮助的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T12:50:55.500

`Response.Redirect`向浏览器发送一个应答代码（HTTP 302），浏览器又发出一个新请求（至少这是预期的行为）。另一种可能性是使用`Server.Transfer`（请参阅[此处](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.transfer.aspx)）不返回浏览器。无论如何，他们都没有解决你的要求。也许就您的案例提供更多详细信息可以帮助找到另一种解决方案。;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T12:39:06.570

推荐人完全来自客户端浏览器（也可能对您撒谎）

# java - 如何避免 java 项目中出现不需要的日志消息？

> ID：420140
> 
> 赞同：0
> 
> 时间：2009-01-07T12:32:41.887
> 
> 标签：java, nls

在我的 java 项目中，我在一个`messages.properties`文件中外部化了一堆字符串。在其各自`Messages.java`的文件中，我有相同数量的公共静态字符串类型属性，因此我可以访问这些外部化文本。

然后，我实现了一个名为 的方法`getString`，它接收常量的名称作为其参数并返回所需的文本。这样，就无需在`Messages.java`文件中声明所有公共静态字符串类型的属性。

但是在这样做之后，我的日志中充满了“ *NLS 未使用的消息*”消息。

您知道是否有办法防止记录这些警告消息？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T12:58:06.860

你的`Messages`课——听起来像是在扩展`org.eclipse.osgi.util.NLS`。

如果是这种情况，它旨在满足要求：

*   提供编译时检查消息是否存在。
*   避免同时包含键和值的映射的内存使用（在资源包方法中就是这种情况）。
*   良好的 i18n 支持。

即 NLS`Message.staticVariable`使用`staticVariable`在 messages.properties 中找到的值填充 的值。

警告日志提供有关文件`Messages.java`和`messages.properties`文件之间不匹配的信息。

您的`getString()`方法听起来好像没有使用 NLS 的任何优点，因此正如其他人所建议的，您最好使用 ResourceBundle。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T12:39:52.293

Messages 听起来像是您编写的一个类，因为我在我的 JDK 6 javadocs 中没有看到它。

听起来您已经尝试重新发明 java.util.ResourceBundle。我建议改用它并放弃你的课程。它将具有正确处理 I18N 的额外优势。

我没有看到硬编码类中的公共静态消息密钥有任何价值。这只是您必须维护的另一件事。如果我理解您的操作正确，我会丢弃您的 Messages 并改用 ResourceBundle。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T14:04:20.173

正如[jamesh](https://stackoverflow.com/users/37213/duffymo)所说，[duffymo](https://stackoverflow.com/users/4737/jamesh)`Messages`是我写的一个类，它扩展了`org.eclipse.osgi.util.NLS`. 它有一个私有的静态属性，它的类型是……ResourceBundle！

[jamesh](https://stackoverflow.com/users/4737/jamesh)，感谢您详细介绍 NLS 的工作方式。

根据您的回答，我`Messages`从项目中删除了我的类，并在需要使用外部化字符串的类上添加了一个 ResourceBundle 类型的属性。另外，我这样做的方式是不需要更改访问外部化字符串的行。

我们项目中的文件数量减少了，代码保持和以前一样干净，并且没有更多的日志警告。

谢谢你们。你摇滚。

# git - 让 git 自动提交

> ID：420143
> 
> 赞同：165
> 
> 时间：2009-01-07T12:34:18.013
> 
> 标签：git

我想使用 git 记录对文件的所有更改。

有没有一种方法可以让 git 'commit' 在每次文件更新时自动发生 - 所以对文件的每次更改都会有一个新的提交？

理想情况下，我希望我的用户甚至不知道 git 在幕后运行。然后，用户可以潜在地“撤消”对文件的更改——这可以通过从 git 中拉出以前的版本来实现。

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-01-07T12:40:30.047

在 Linux 上，您可以使用**inotifywait**来在每次更改文件内容时自动执行命令。

编辑：以下命令在保存后立即提交 file.txt：

```
inotifywait -q -m -e CLOSE_WRITE --format="git commit -m 'autocommit on change' %w" file.txt | sh 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-06-08T14:52:17.637

较早的**inotifywait**答案很棒，但它并不是一个完整的解决方案。正如所写，它是对文件中的一次更改的一次性提交。它不适用于编辑文件创建具有原始名称的新 inode 的常见情况。 **inotifywait -m**显然是按 inode 跟踪文件，而不是按名称。此外，在文件更改后，如果没有**git add**或**git commit -a**，它不会为**git commit**暂存。进行一些调整，这是我在 Debian 上用来跟踪我的日历文件的所有更改的内容：

 ****/etc/rc.local：

```
 su -c /home/<username>/bin/gitwait -l <username> 
```

/home/<用户名>/bin/gitwait：

```
 #!/bin/bash
#
# gitwait - watch file and git commit all changes as they happen
#

while true; do

  inotifywait -qq -e CLOSE_WRITE ~/.calendar/calendar

  cd ~/.calendar; git commit -a -m 'autocommit on change'

done 
```

这可以概括为等待文件和/或目录列表以及相应的**inotifywait**进程，并在文件更改时重新启动每个**inotifywait 。**

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-10-20T12:33:46.200

当我自己遇到这个问题时，之前推荐**inotifywait的答案让我朝着正确的方向前进，所以我写了一个小脚本。**首先，这只能递归地查看整个文件夹（与 Lester Buck 的示例相反），但后来我也想在其他地方查看文件，所以我扩展了它。

结果是一个当前称为的**脚本**`gitwatch`，因为它就是这样做的：它监视文件或文件夹的更改（使用 inotifywait），并将它们提交到 git 存储库。

您可以在 github 上找到脚本、更多信息和说明：[https ://github.com/nevik/gitwatch](https://github.com/nevik/gitwatch)

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2010-05-07T11:38:39.543

[git-wip](http://github.com/bartman/git-wip "git-wip")是一个非常适合我的解决方案。“WIP”代表“进行中的工作”。每次运行 'git wip' 时，更改都会提交到单独的分支。它可以在命令行上运行，但有 vim 和 emacs 的扩展，可以在每次写入文件时自动运行 git-wip。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-12-22T11:42:45.013

我想在 Windows 中执行此操作，并发现最好的方法是使用[Directory Monitor](https://directorymonitor.com/)检查更改，然后在检测到更改时运行它：

程序：cmd.exe

参数：/CC:\pathToBatchFile.bat

该批处理文件包含：

```
c:
cd c:\gitRepoDirectory\
(if exist "%PROGRAMFILES(X86)%" (
"%PROGRAMFILES(X86)%\git\bin\sh.exe" --login -i -c "git commit -am AutoCommitMessage"
) else (
"%PROGRAMFILES%\git\bin\sh.exe" --login -i -c "git commit -am AutoCommitMessage"
)) 
```

我还尝试在其中使用另一个命令来添加文件（`"%PROGRAMFILES(X86)%\git\bin\sh.exe" --login -i -c "git add *.*"`），但我认为我不能正常工作。

我还制作了一个提交后挂钩，其中包含：

```
#!/bin/sh
git.exe pull -v --progress  "origin"
git.exe push    --progress  "origin" master:master
curl.exe -s https://webserverdomain.com/updateFromGitHook.x?r=repoName 
```

（如果有任何冲突，那么它会中止 pull 并中止 push，但是没有任何明确的方法可以说明已经发生了 - 最后我们因为这个缺陷而放弃了整个想法。）

该 curl 命令告诉我的服务器它需要对代码进行拉取。在 php 中处理它所需要的只是：

```
<?
$r = $_GET['r'];
if (!empty($c)) {
    //use system instead of exec if you want the output to go back to the git client
    exec("cd /path/to/repo/parent/$r; sudo git reset --hard HEAD; sudo git pull;");
    echo "\n\nServer: Updated\n\n";
} else {
    echo "\n\nServer: UPDATE FAILED\n\n";
}
?> 
```

唯一的问题是它需要由 root 用户而不是 apache 用户运行，所以我还必须制作一个包含以下内容的文件`/etc/sudoers.d/`：

```
www-data ALL = NOPASSWD: /usr/bin/git 
```

对我来说，我认为这非常有效。目录监视器可以配置为在启动时运行并最小化启动，它可以监视几个不同的文件夹

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-10-16T17:39:26.633

Inotify 听起来确实是适合这项工作的工具。

有一个名为[incron](http://inotify.aiken.cz/?section=incron&page=about&lang=en)的工具可能正是您正在寻找的。您可以在 crontab 之类的东西中指定文件或文件夹（以及事件类型，例如“更改”、“创建”、“取消链接”），以及在发生此类事件时运行的命令。

与 inotifywait （类似于穷人的 cron `sleep 10;do stuff`）相比，这将捕获每个事件，而不仅仅是第一个。

我自己没有使用过它，但从文档来看，设置起来并不复杂。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-11-23T09:57:42.270

```
#!/bin/bash
git commit -a -m "autoupdate `date +%F-%T`"
git push 
```

使用当前日期和时间自动推送。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-11-04T19:43:21.447

我编写了一个程序[GitPrime](http://www.artemissoftware.net/display/art/2011/11/04/Introducing+GitPrime+-+auto+save+for+your+local+Git+repositories)来为您的本地 Git 存储库提供自动保存功能。现在很容易回滚到你破坏它之前！[Bitbucket 存储库](https://bitbucket.org/brendanp/git-prime)。

这应该适用于任何支持 bash shell 的平台，包括 Windows+Cygwin。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-10-14T06:19:26.480

如果有人试图从 Powershell 执行此操作，我使用以下方法取得了成功：

```
& "C:\Program Files (x86)\Git\bin\sh.exe" -c "cd D:\PATH\TO\REPO && git add --all  &&  git commit -m 'Automatic Commit Message Goes Here' && git push origin master" 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-02-14T12:43:47.967

我喜欢的两个解决方案是[etckeeper——](http://etckeeper.branchable.com/)它[可以适应](https://serverfault.com/a/411512)除以下之外的自定义目录`/etc`：

```
mkdir /foo
etckeeper -d /foo init`
etckeeper -d /foo commit 'message' 
```

和[gitwatch](https://github.com/nevik/gitwatch) - 特别是[如何使用它`supervisord`](https://github.com/nevik/gitwatch/wiki/gitwatch-as-a-service-on-Debian-with-supervisord)的说明。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-07T15:01:07.517

如果您知道文件的名称并且只想监视一个（或几个文件），您可以简单地每隔几分钟调用一次“git commit”来实现这一点。如果文件没有改变，git只会抱怨，你必须忽略这个错误，但除此之外，不会有损坏。

除此之外，您还需要将这些文件标记为“自动提交”，以便也能够手动提交。这样，用户可以看到自动更改以及更大的“逻辑”更改，这些更改伴随着提交注释来解释自上次手动提交以来发生的更改。

例如，使用“AUTOCOMMIT”作为提交消息。稍后，您可以编写一个工具来使用 git log 清除这些提交（以找出要杀死的修订），或者您可以尝试使用暴力冲突解决策略创建一个分支 AUTOCOMMIT 来敲击“手动提交”。

另一种选择是使用 git 低级命令来构建您自己的专用存储库。

最后，您可以在执行自动提交时将文件复制到一个新名称（“$filename.ac”）以区分手动和自动版本。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-03-11T15:03:39.703

听起来您正在寻找类似于[etckeeper](http://joeyh.name/code/etckeeper/)的东西，它旨在自动将您对 /etc/* 的所有更改检查到 git（或您想要的任何 VCS）中，但我看不出它不能与文件一起使用的原因除了 /etc 中的那些。

如果您只想处理一个文件，那可能并不完美，但如果您想跟踪给定目录中的所有内容，我认为值得一试。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-06-12T17:58:35.090

当用户更改文件时，此脚本不会运行，但它可以作为 cron 作业运行（通过将其放入 /etc/cron.* 目录），这也是一个合理的解决方案。

该脚本将遍历您的 /srv/www 目录（将其更改为存储所有站点的位置），添加、提交和推送所有文件，并将所有内容记录到 /var/log/gitlog.txt

```
now=$(date +"%m.%d.%Y_%T")
logfile='/var/log/gitlog.txt'

for dir in /srv/www/*/
do
echo -e '\n' >> $logfile
echo "autocommit $dir $now" >> $logfile
echo "--------------------------" >> $logfile

cd $dir
git add . >> $logfile
git commit -am "autocommit $now" >> $logfile
git push origin master >> $logfile
done 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-05-31T15:09:37.427

# 对于 Windows

根据[这篇关于 autocommit](https://puvox.software/blog/windows-automatically-commit-push-git-repository-once-in-every-x-day-minute-hours/)的文章，您应该创建`.bat`包含内容的文件：

```
git add -u
git commit -m "your commit message"
git push origin master 
```

并执行`Task Scheduler`. 如果您不知道如何逐步操作，请参阅该文章。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-07T12:37:22.983

我很确定您需要将其连接到您的用户正在使用的任何编辑器中。您可以编写一些东西来轮询更改，但根据使用模式，轮询频率可能需要非常高，以确保它获取的是单个更改而不是多个更改。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-30T23:50:00.493

我遇到了同样的问题，在 mac launchd 上为您提供了一个很好的解决方案。它将监视文件或目录，如果有更改，您可以运行应用程序或其他任何东西...

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-06-15T13:03:17.443

我制作了这个小 shell 脚本来监视文件状态并在构建成功时触发诸如 git commit 之类的命令。

随意下载并尝试。

[https://github.com/nzvincent/nzvincent-github/blob/master/inotify-tools/inotify.sh](https://github.com/nzvincent/nzvincent-github/blob/master/inotify-tools/inotify.sh)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-11-30T23:13:13.243

这不满足问题的“理想”部分，但这是我看到的最接近我想要的答案的问题，所以我认为它可以放在这里。不过，我的第一个 stackoverflow 帖子，如果我弄错了，请道歉。

以下脚本可确保自动提交已保存的更改，但*会*提示用户输入提交。（我意识到我的场景与 git-noob 的有点不同）。

```
 # While running, monitors the specified directory, and when a file therein 
# is created or edited and saved, this prompts the user for a commit message.
# The --exclude is to avoid extra prompts for the changes made to 
# version control directories.

# requires inotify-tools

inotifywait --exclude '/\..+' -m  path/to/directory -e modify -e create |
        while read path action file; do
                gnome-terminal -e 'bash -c "cd path/to/directory; 
                                            git add *; 
                                            echo What did you just do??; 
                                            read varname; 
                                            git commit -m \"$varname\""'
        done 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-08-22T13:38:15.660

有几种选择：

*   可以[`git-etc`](https://arcanis.me/projects/git-etc)在预定义的时间间隔内自动提交更改。
*   还有一个[看门人](https://facebook.github.io/watchman/)
*   和[gitwatch](https://github.com/gitwatch/gitwatch)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-10-06T16:05:53.813

*   git 文件 (autocommit.sh)

    *   ```
        `git add .
         git commit -am "auto commit"
         git push` 
        ```

*   批处理文件 (*.bat)

    *   `%windir%\system32\CMD.exe /k git-bash.exe c:/yourapp/autocommit.sh`
*   窗口任务计划程序

    *   创建任务

对我来说它有效希望它会帮助一些人

# ruby - Ruby 块和不带括号的参数

> ID：420147
> 
> 赞同：10
> 
> 时间：2009-01-07T12:34:29.247
> 
> 标签：ruby, parentheses

我提取了简单的例子：

```
require 'pp'
x = 1..3
pp x.map do |i| {:value => i, :double => (i*2)} end
pp x.map { |i| {:value => i, :double => (i*2)} }

pp(x.map do |i| {:value => i, :double => (i*2)} end)
pp(x.map { |i| {:value => i, :double => (i*2)} }) 
```

我想知道为什么第一个 pp 产生：

```
[1, 2, 3] 
```

虽然所有的订单都在给：

```
[{:value=>1, :double=>2}, {:value=>2, :double=>4}, {:value=>3, :double=>6}] 
```

我认为它与运算符优先级有关。我在哪里可以找到好的解释？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T12:39:24.120

那是因为你打电话

```
pp x.map 
```

并将一个块传递给 pp （忽略它）

如《[Ruby 编程](http://phrogz.net/ProgrammingRuby/language.html#blocksclosuresandprocobjects)》一书中所述

> 大括号优先级高；do 的优先级较低

因此，有效地，大括号绑定到离它们最近的函数调用（x.map），而 do 绑定到最远的函数调用（pp）。这有点简单，但它应该可以解释这种情况

# continuous-integration - 如何使用 CruiseControl.NET 实现夜间构建

> ID：420148
> 
> 赞同：5
> 
> 时间：2009-01-07T12:34:45.080
> 
> 标签：continuous-integration, cruisecontrol.net

我已经为我的项目设置了 Cruisecontrol.net cs，该项目有许多模块和组件，这些模块和组件可以在构建机器上按日期构建并存储在文件夹中。问题是我需要为应用程序进行设置（wpf non web ) 问题是，由于有许多模块和不同的解决方案可以构建并最终制作产品（dll）等。任何关于提出将创建夜间设置以及使用什么设置包的设置策略的建议（更简单的东西或者根据你的说法会花费更少的时间）我打算在构建机器上安装一些东西，它会从文件夹（什么文件夹？）中提取文件并进行设置......

一个说明这一点的链接是[Firefox 的 nightly build](https://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/2008/)。

任何建议家伙

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-29T20:25:40.990

我发现这个系统对我来说工作得很好。我假设 VS 2005/2008 和 C#，但相同的原则适用于其他编译器和语言，只是替换你自己的风格。

**使用 CC.NET**

*   如果有多个位置使用，请使用 scheduleTrigger 检查所有源
*   使用 MSBuild 构建所需的每个解决方案（假设 VS 2005/2008）、nant 或任何最适合编译组件项目的构建工具
*   使用 MSBuild 创建 WIX 安装程序，尽管我也使用 MSBuild 创建 InnoSetup 和 Wise Installation Studio 安装
*   使用 MSBuild 为您希望构建脚本控制的任何项目更新 AssemblyInfo.cs 文件
*   使用源代码管理命令行签入更新的 AssemblyInfo.ca 文件
*   最后使用 MSBuild 将输出安装程序复制到放置服务器中的新文件夹。我使用主要产品可执行文件中的时间戳来制作时间戳以及生成的版本号来命名文件夹（../Builds/Product/vMmrp - DATE TIME/）

我还想在最后生成一封构建通知电子邮件。

至于**安装程序建议**，需要权衡取舍。

要快速生成，请使用 NSIS 或 Inno Setup 等脚本安装程序。缺点是不兼容 Windows Installer。

对于 Windows Installer 产品，使用 Wise 或 InstallShield 第一次生成速度更快，但工具昂贵，而且我发现我的安装脚本的维护成本很高。第一次使用 WIX 往往要贵得多（学习曲线 + 尖括号税），但随后更容易维护，因为它都是 XML 并且命令行工具易于使用。

我在使用 Inno Setup 进行安装捆绑方面取得了一些成功，因为 Windows Installer 捆绑和链接（至少对于 Windows XP 而言）是一个真正的痛苦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T13:16:53.297

我们使用[了可视化构建](http://www.kinook.com/VisBuildPro/)和明智的安装程序创建，并发现高度直观且易于创建设置。实际的 CC.NET 项目做了一些事情，首先它检查以确保自我们上次创建安装程序以来所有需要的部分都已成功构建（我们允许安装程序按需以及每晚安排）如果它们没有成功构建我们重建所有组件，一旦它们（或者如果它们已经）成功构建，我们然后调用 VisualBUildPro 并让它创建安装程序。Visual Build Pro 为实际安装程序处理所有复制和调用 Wise。创建安装程序后，我们将其发布到每个人都期望的目的地。我们还为构建服务器上的电子邮件发布者修改了 XSL，

如果可以的话，关于夜间构建的一些事情你应该尝试设置一个符号服务器并让每个安装程序上传带有源代码信息的符号。这也是创建任何文档（D'Oxygen；SandCastle）以及运行可用的全套测试的好时机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T13:31:43.017

看看[WiX](http://wix.sourceforge.net/)。此工具集允许以 XML 格式定义设置项目，然后从该 XML 生成 msi。项目以 XML 定义的事实为您提供了很大的灵活性，可以在构建期间动态修改此 XML（如果需要）。

它与 MSBuild 集成 - 请参阅[本文](http://msdn.microsoft.com/en-us/magazine/cc163456.aspx)，还可以与 NAnt 很好地配合使用 - 请参阅[本文](http://weblogs.asp.net/lorenh/archive/2004/05/09/128899.aspx)。

# c++ - 从固定内存偏移中获取值：Visual C++ Programming

> ID：420151
> 
> 赞同：0
> 
> 时间：2009-01-07T12:35:00.463
> 
> 标签：c++, visual-c++

我想编写一个简单的应用程序，能够从另一个进程（应用程序）分配的内存中检索某些数据。

假设我已经知道一个进程的 id，并且我想始终从一个固定的偏移量（如 0x523F1C）获取该进程的内存中的一个值，这在用户模式下是否可行，还是必须在内核模式下？

任何提示或信息都非常感谢。

我的环境是 Windows XP，我使用 Visual C++ 和 Qt 作为 GUI。

提前致谢 ：）

编辑：

(a) 谢谢各位。基本上它正在工作（当设置一个断点并挂钩它的值时它是正确的），但是在进行正常发布构建时，获得的值始终是初始化的:(

将不得不做更多的工作来弄清楚...

(b) 由于我试图从中获取价值的应用程序不是我编写的，我还可以使用进程间通信/共享内存技术吗？

编辑2：

再次感谢您的快速回复！:D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T12:42:43.723

使用 ReadProcessMemory - 您需要一个具有 PROCESS_VM_READ 访问权限的句柄来访问另一个进程 [1]，但如果您是管理员（或者可能，如果您有 SE_DEBUG 权限），它应该很简单。

```
BOOL WINAPI ReadProcessMemory(
  __in   HANDLE hProcess,
  __in   LPCVOID lpBaseAddress,
  __out  LPVOID lpBuffer,
  __in   SIZE_T nSize,
  __out  SIZE_T* lpNumberOfBytesRead
); 
```

[1]

```
HANDLE hProc = OpenProcess(PROCESS_VM_READ, false, pid); 
```

编辑：b）不，除非您使用 CreateRemoteThread - 但您通常需要将自己的 DLL 填充到远程进程中，然后才能在该进程中有意义地创建线程。这是先进的，有趣的和危险的:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T13:26:28.953

如果您正在进行进程间通信/共享内存，我建议您使用[Boost::Interprocess](http://www.boost.org/doc/libs/1_35_0/doc/html/interprocess.html)代替，因为它会让生活变得更轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T12:39:31.937

有一个[ReadProcessMemory()](http://msdn.microsoft.com/lv-lv/library/ms680553(en-us,VS.85).aspx)函数，但您必须自己找到使用它的要求。我认为您可能需要将自己设置为该过程的调试器。

# visual-studio - 输出窗口到文件 (Visual Studio 2005)

> ID：420154
> 
> 赞同：7
> 
> 时间：2009-01-07T12:35:50.320
> 
> 标签：visual-studio, visual-studio-2005, window, customization

在 Visual Studio 2005 中，如何将写入输出窗口的内容保存到文件中（我无法更改写入输出窗口的代码，并且写入很多；我只想将输出窗口内容保存到文件中)?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T00:55:30.410

"File" -> "SaveOutputAs..." 让您将输出窗口的内容保存到文件中，但我想您想在调试时将输出重定向到文件？我仍在寻找自己的方法来做到这一点..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-10T20:05:59.900

您可以在 Visual Studio 的命令行参数中重定向输出流。

右键单击您的项目 →*属性*→*配置属性*→*调试*→*命令参数*。

在你的论点之后，只需添加：

```
> outputfile.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T01:10:27.223

如果您指的是调试/跟踪窗口的输出，您可以在运行时使用[DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)捕获它，而无需运行 Visual Studio。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-03T05:04:17.513

[我刚刚在这里](https://stackoverflow.com/questions/2586933/how-do-i-redirect-output-from-the-visual-studio-debugger/2756199#2756199)回答了一个非常相似的问题。我自己使用这种方法来捕获、过滤和记录调试输出到 Windows Vista 32 位上的文件。我使用 Visual Studio 2005 并使用 C++ 工作，所以这也可能对您有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T12:40:06.660

[ATLTrace 工具](http://msdn.microsoft.com/en-us/library/khbh432d(VS.80).aspx)拦截 ATLTRACE 调用。您可以将任何进程的输出保存到文件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T12:41:09.450

您是否在.NET 中进行开发？用于写入输出窗口的代码是什么？

如果您使用 Trace.WriteLine 或 Debug.WriteLine，您可以使用 TextWriterFileListener 类将所有消息自动写入文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T13:01:55.727

如果应用程序在命令窗口中运行，您可以使用旧的 DOS 重定向命令“>”将输出重定向到文件。

例如。

```
c:\>dir > out.txt 
```

...将 dir 命令的输出重定向到名为 out.txt 的文件。您应该能够对您的应用程序执行相同的操作。

这*将*阻止输出进入控制台，但您始终可以访问日志文件以获取所需的信息。

# javascript - WebtextEdit 执行 Javascript 函数

> ID：420162
> 
> 赞同：0
> 
> 时间：2009-01-07T12:38:01.157
> 
> 标签：javascript

我需要执行整个 javascript 函数。

发现我做错了什么：

```
var edit = igedit_getById("FG2100RefNo");
var editText = edit.getText();
alert(!isNaN(editText)); 
```

但是，这只检查并显示一个消息框。

我需要执行以下 javascript：

```
<script language=Javascript>
  <!--
  function isNumberKey(evt)
  {
     var charCode = (evt.which) ? evt.which : event.keyCode
     if (charCode > 31 && (charCode < 48 || charCode > 57))
        return false;

     return true;
  }
  //--> 
```

```
onkeypress="return isNumberKey(event)" 
```

**如何使用 webtextedit 执行此操作：**

```
var edit = igedit_getById("FG2100RefNo");
var editText = edit.getText();
function isNumberKey(evt)
{
    var charCode = (evt.which) ? evt.which : event.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57)) return false;
    return true;
}
return isNumberKey(editText) 
```

我只有`onkey`事件属性值来插入代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T12:56:38.017

您的`onkeypress="return isNumberKey(event)"`功能足以强制用户仅输入数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-27T19:30:56.010

您可以从服务器端将客户端函数名称提供给控件的`ClientSideEvents.KeyPress`属性。

C＃：

```
FG2100RefNo.ClientSideEvents.KeyPress = "isNumberKey"; 
```

您必须更新 的定义`isNumberKey`以接受提供的参数并使用控件的取消操作的方法。

ClientSideEvents 参考： [http ://help.infragistics.com/Help/NetAdvantage/ASPNET/2009.1/CLR3.5/html/Infragistics35.WebUI.WebDataInput.v9.1~Infragistics.WebUI.WebDataInput.WebTextEdit~ClientSideEvents.html](http://help.infragistics.com/Help/NetAdvantage/ASPNET/2009.1/CLR3.5/html/Infragistics35.WebUI.WebDataInput.v9.1~Infragistics.WebUI.WebDataInput.WebTextEdit~ClientSideEvents.html)

# c++ - 如何在 C++ 中获取 DLL 文件的版本信息

> ID：420185
> 
> 赞同：13
> 
> 时间：2009-01-07T12:45:20.410
> 
> 标签：c++, windows, dll, version

我需要获取我在 Visual Studio 2008 C++ 中创建的 DLL 文件的版本信息。我如何得到它？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-07T13:34:48.313

感谢您的回答。

这对我有用：

```
WCHAR fileName[_MAX_PATH];
DWORD size = GetModuleFileName(g_dllHandle, fileName, _MAX_PATH);
fileName[size] = NULL;
DWORD handle = 0;
size = GetFileVersionInfoSize(fileName, &handle);
BYTE* versionInfo = new BYTE[size];
if (!GetFileVersionInfo(fileName, handle, size, versionInfo))
{
    delete[] versionInfo;
    return;
}
// we have version information
UINT                len = 0;
VS_FIXEDFILEINFO*   vsfi = NULL;
VerQueryValue(versionInfo, L"\\", (void**)&vsfi, &len);
aVersion[0] = HIWORD(vsfi->dwFileVersionMS);
aVersion[1] = LOWORD(vsfi->dwFileVersionMS);
aVersion[2] = HIWORD(vsfi->dwFileVersionLS);
aVersion[3] = LOWORD(vsfi->dwFileVersionLS);
delete[] versionInfo; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-07T12:49:55.097

如果您想要以编程方式访问，请参阅MSDN 中的[版本信息](http://msdn.microsoft.com/en-us/library/ms646981(VS.85).aspx)以了解您需要的 API 和数据结构。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T12:56:27.767

看起来您需要访问 VS_VERSION_INFO 资源；[http://www.microsoft.com/msj/0498/c0498.aspx](http://www.microsoft.com/msj/0498/c0498.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T12:46:55.790

当您在 Windows 资源管理器中打开它时，它应该在属性（版本选项卡）中

# vba - ADO & DAO 介绍

> ID：420192
> 
> 赞同：-1
> 
> 时间：2009-01-07T12:47:45.677
> 
> 标签：vba, vb6, ado, dao

我正在寻找一些介绍 VBA 中 DAO 和 ADO 用法的材料。我遇到的大多数材料都提供了如何使用它们的示例。我正在寻找一个更广泛的基于理论的定义，它们是什么、它们是如何产生的以及它们的使用要求。

谢谢问候tksy

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-08T11:14:23.027

如果您同时考虑 ADO 和 DAO，那么您可能对将 MS Access 或 Jet 作为数据源感兴趣，在这种情况下，以下知识库文章很有用：

[选择 ADO 或 DAO 来使用 Access 数据库](http://msdn.microsoft.com/en-us/library/aa164825(office.10).aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-07T12:51:25.407

请参阅[使用数据访问对象 (DAO)](http://msdn.microsoft.com/en-us/library/aa266542(VS.60).aspx)和[Microsoft ActiveX 数据对象 (ADO)进行数据访问](http://msdn.microsoft.com/en-us/library/ms675532(VS.85).aspx)

# sql-server - 流程维度失败并显示消息“发生来自 WriteFile 的 FileStore 错误”？

> ID：420193
> 
> 赞同：5
> 
> 时间：2009-01-07T12:47:50.577
> 
> 标签：sql-server, database-design, olap

我正在尝试使用**SQL Server 2005 Analysis** Services*处理**维度*。这在过去没有问题，但最近失败了。

 **该维度使用单个表中的 4 列进行分层（整个多维数据集使用单个表）。

收到的错误消息（无论我是否处理整个多维数据集或维度，无论我是否“处理已满”）是这样的：

```
File system error: A FileStore error from WriteFile occurred. Physical file: 
\\?\L:\Microsoft SQL Server\MSSQL.3\OLAP\Data\MSMDCacheRowset_xxx.tmp.
Logical file: . . 
```

我的猜测是，这与不断增长的数据量有关（当前特定表中有 1500 万行）。

*   它以前工作过（没有进行任何更改）
*   该处理在显示错误之前读取了 1100 万行
*   显示错误时服务器上的物理内存已用完
*   谷歌搜索错误消息会导致一些命中，表明列大小是一个问题。

谁能指出我正确的方向？我想一种出路可能是尝试使用较小的列（varchar(x) 而不是 varchar(y)），但感觉就像是绕过问题而不是解决问题。

最好的问候
埃里克·拉尔森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T13:42:20.747

检查所有相关维度的维度属性“ProcessingGroup”。如果设置为`'ByTable'`尝试将其设置为`'ByAttribute'`

这可能会导致处理大维度（成员数、属性数等）问题的原因是因为在使用该`ByTable`设置时，它会尝试将整个维度放入内存中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-11T07:54:19.087

此错误的其他原因可能是 .asstore 文件的大小限制。如果 ProcessUpdate 定期处理的文件大小和尺寸约为 4Gb，则必须使用 ProcessFull 对其进行处理以解决此问题。

我在[这里找到了这个解决方案](http://geekswithblogs.net/darrengosbell/archive/2007/04/29/SSAS-ProcessUpdate---Too-much-of-a-good-thing.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-09T20:42:41.147

对引发错误的维度进行全面重新处理对我有用。

# linq - LINQ to SQL 对象中的最大列数？

> ID：420195
> 
> 赞同：1
> 
> 时间：2009-01-07T12:48:28.563
> 
> 标签：linq, sql-server-2005, linq-to-sql

我在 SQL 2005 下的表中有 62 列，并且 LINQ to SQL 不处理更新，尽管读取工作正常，我尝试将表重新添加到模型中，创建了一个新的数据模型但没有任何效果，我我猜我已经达到了对象的最大列数限制，谁能解释一下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T12:55:24.977

我怀疑身份或时间戳列（在 SQL 服务器上自动生成的东西）存在一些问题。确保在模型中以这种方式标记任何自动生成的列。您可能还想看看它是如何处理并发的。如果您有触发器在更新（更改值）后更新行上的任何值并且它正在检查更新时的所有列，这将导致更新失败。通常，我创建带有时间戳列的表——LINQ2SQL 在我生成模型并单独使用它进行并发时会选择它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T14:02:24.280

解决了，以下两种之一

-我正在使用未设置为主键的 UniqueIdentifier 列

- 设置唯一 ID 主键，在服务器资源管理器中检查同一列的属性，它仍然没有显示为主键，刷新连接，在模型上删除同一个表，瞧。

所以我假设我之前对我的模型进行了更改，从模型中删除了表并从服务器资源管理器中添加了相同的表，而没有刷新连接，并且它从来没有工作过。

问题是，VS Server Explorer 是否维护它自己的表模式并且每次在数据库中进行更改时都需要刷新连接？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T12:53:36.120

LINQ to SQL 将处理的列数没有限制。

您是否成功更新了其他表？

您访问表格内容的方式还有什么不同？

# wcf - 迁移到 WCF 服务的 IIS 7、Windows Server 2008 的好处和缺陷

> ID：420205
> 
> 赞同：1
> 
> 时间：2009-01-07T12:52:15.123
> 
> 标签：wcf, iis, windows-server-2008, wcf-binding

我们目前使用 IIS 6 和 Windows Server 2003 作为我们的 Web 和应用程序服务器。我们的 Web 服务器对我们的应用程序服务器进行 WCF 服务调用。

我们希望迁移到 IIS 7 和 Windows Server 2008，以便我们可以使用推荐的 netTcpBinding（目前我们使用的是 basicHttpBinding）。

（除此之外，我们还将从 SQL Server 2005 迁移到 2008）

有人对上述的好处和陷阱有什么看法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T06:05:08.610

正如您所提到的，IIS 6 仅支持各种基于 HTTP 的绑定。IIS7 支持所有绑定，包括 TCP/IP、命名管道（用于同一台机器上的超快速进程内调用）和 MSMQ 队列。

有关在 IIS6 和 IIS7 中托管 WCF 的详细比较，请参阅此 MSDN 文章：[使用 WAS 扩展您的 WCF 服务超越 HTTP](http://msdn.microsoft.com/en-us/magazine/cc163357.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-07T10:05:42.083

IIS 7 使用完全不同的（并且改进了很多！）配置模型；Metabase 已经消失，取而代之的是基于 .config 文件的分层和可插拔模型。如果由于遗留原因无法将 IIS 6 配置移植到 IIS 7 模型，请务必安装 IIS 6 Metabase Compatibility Layer 功能。我在工作中使用一个 Web 应用程序，它在 IIS 6 和 7 上运行良好，除此之外没有其他修改。

从事物的声音来看，您的应用程序并没有那么深入地嵌入到 IIS 中，因此除了上述之外，您根本不应该遇到许多其他问题。两者的兼容性非常好。

# web-applications - 使用 EJB 3.0、JPA、JBoss 上的动态 Web 项目的 Java EE 应用程序的项目架构/组织

> ID：420222
> 
> 赞同：7
> 
> 时间：2009-01-07T12:58:44.440
> 
> 标签：web-applications, jpa, jakarta-ee, ejb-3.0

我有一个包含不同动态 Web 项目的 webapp，每个项目通常都包含一个 EJB 项目。我们希望让它们保持交互，例如通过 JNDI 使用彼此的 EJB 中的 bean 和类，共享同一个数据库或使用它们自己的数据库。但我们也希望能够在不同的服务器上保留不同的项目。

就架构和组织而言，此类项目的正确重点是什么？

我们应该如何使用 EAR？一只耳朵来统治他们并在黑暗中束缚他们？（对不起，必须做那个 LOTR 参考），或者每个服务器/Web 项目的 EAR，等等？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T20:11:27.677

磁盘空间很便宜，但是如果你把所有东西都放在一个 EAR 中，你的应用服务器很可能会运行它们，即使你想要的只是服务 A。你最好打破常用的 EJB 并自己部署它们，并且每个单独的服务的组件在他们自己的 EAR 中。

然后，以 JBoss 为例，您可以简单地将工件直接复制到要在其上运行它们的任何服务器的部署目录中。

OrderManagement.ear InventoryManagement.ear StoreFront.ear

然后，您可以在任何特定服务器上拥有全部、部分或一无所有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-09T20:18:30.923

EJB 是模块化的，因此根据您要提供的服务，您应该提供适当的 EAR 以进行部署。此外，尝试使用 MBean 并将它们部署为独立的服务。管理界面在调试和测试时有很大帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-12T03:17:00.563

请记住错误修复/升级和回归测试场景。您在同一个 EAR 中拥有的 EJB 模块越多，需要回归测试的功能点就越多，即使您仅对其中一个模块进行了修复或添加了新功能也是如此。

# java - compare() 和 compareTo() 有什么区别？

> ID：420223
> 
> 赞同：118
> 
> 时间：2009-01-07T12:59:16.247
> 
> 标签：java

`compare()`Java的和`compareTo()`方法有什么区别？这些方法是否给出相同的答案？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2009-01-07T13:05:40.493

来自[JavaNotes](http://web.archive.org/web/20090126135350/http://leepoint.net/notes-java/data/expressions/22compareobjects.html)：

*   `a.compareTo(b)`:
    **Comparable interface :**比较值并返回一个int，它告诉值比较小于、等于还是大于。
    如果您的类对象具有**自然顺序**，请实现`Comparable<T>`接口并定义此方法。所有具有自然排序的 Java 类都实现了`Comparable<T>`- 示例：`String`、[包装类](http://www.javatpoint.com/wrapper-class-in-java)、`BigInteger`

*   `compare(a, b)`：
    **比较器接口：** 比较两个对象的值。这是作为`Comparator<T>`接口的一部分实现的，**典型的用途是定义一个或多个小的实用程序类来实现它，传递给方法，例如`sort()`或 用于对数据结构进行排序，例如`TreeMap`和`TreeSet`**。您可能希望为以下内容创建一个 Comparator 对象：

    *   **多重比较**。提供几种不同的排序方式。例如，您可能希望按名称、ID、年龄、身高等对 Person 类进行排序……您将为其中的每一个定义一个 Comparator 以传递给`sort()`方法。
    *   **系统类**为您无法控制的类提供比较方法。例如，您可以为字符串定义一个比较器，按长度比较它们。
    *   **策略模式**实现策略模式，在这种情况下，您希望将算法表示为可以作为参数传递、保存在数据结构中等的对象。

如果你的类对象有一个自然的排序顺序，你可能不需要 compare()。

* * *

摘要来自[http://www.digizol.com/2008/07/java-sorting-comparator-vs-comparable.html](http://www.digizol.com/2008/07/java-sorting-comparator-vs-comparable.html)

**可比较**
可比较的对象能够将自己与另一个对象进行比较。

**比较**
器 比较器对象能够比较两个不同的对象。该类不是比较它的实例，而是比较其他一些类的实例。

* * *

用例上下文：

**可比接口**

equals 方法和`==`and`!=` **运算符**测试相等/不等式，但**不提供测试相对值的方法**。
一些类（例如，String 和其他具有自然顺序的类）实现了`Comparable<T>`定义`compareTo()`方法的接口。如果您想将它与or方法一起使用，
您将需要在您的类中实现。`Comparable<T>``Collections.sort()``Arrays.sort()`

**定义一个比较器对象**

您可以创建比较器以**任意方式对任何类进行排序**。
例如，`String`该类定义了[`CASE_INSENSITIVE_ORDER`比较器](http://www.java2s.com/Code/JavaAPI/java.lang/StringCASEINSENSITIVEORDER.htm)。

* * *

两种方法之间的差异可以与以下概念相关联：
**有序集合**：

对集合进行排序时，这意味着您可以以特定（非随机）顺序（a`Hashtable`未排序）在集合中迭代。

具有**自然顺序**的 Collection不仅是有序的，而且是**排序**的。定义自然顺序[可能很困难！](https://blog.codinghorror.com/sorting-for-humans-natural-sort-order/)（如[自然字符串顺序](http://web.archive.org/web/20090310030619/http://weblogs.java.net/blog/skelvin/archive/2006/01/natural_string.html)）。

* * *

[HaveAGuess](https://stackoverflow.com/users/57344/haveaguess)在[评论](https://stackoverflow.com/questions/420223/what-is-the-difference-between-compare-and-compareto/420240?noredirect=1#comment46816131_420240)中指出了另一个区别：

*   `Comparable`是在实现中，从界面上看不到，所以当你排序时，你真的不知道会发生什么。
*   `Comparator`让您放心，订单将被明确定义。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-07T13:00:56.383

**`compareTo()`**来自[**`Comparable`**](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)界面。

**`compare()`**来自[**`Comparator`**](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)界面。

两种方法都做同样的事情，但是每个接口在稍微不同的上下文中使用。

[Comparable](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)接口用于对实现类的对象进行自然排序。该`compareTo()`方法称为自然比较法。[Comparator](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)接口用于对实现类的对象进行总排序。有关详细信息，请参阅链接了解何时使用每个接口。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-07T13:08:41.860

**相似之处：**
两者都是比较两个对象的自定义方法。
两者都返回`int`描述两个对象之间的关系。

**区别：** 方法`compare()`是实现了[`Comparator`](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)接口就必须实现的方法。它允许您将两个对象传递给方法，并返回`int`描述它们的关系。

```
Comparator comp = new MyComparator();
int result = comp.compare(object1, object2); 
```

如果您实现了接口，则该方法`compareTo()`是您有义务实现的方法。[`Comparable`](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)它允许将对象与相似类型的对象进行比较。

```
String s = "hi";
int result = s.compareTo("bye"); 
```

**摘要：**
基本上它们是比较事物的两种不同方式。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-07T13:08:09.927

这些方法不必给出相同的答案。这取决于您调用它们的对象/类。

如果您正在实现自己的类，并且您知道要在某个阶段进行比较，则可以让它们实现 Comparable 接口并相应地实现 compareTo() 方法。

如果您正在使用 API 中的某些类，这些类未实现 Comparable 接口，但您仍想比较它们。即用于排序。您可以创建自己的实现 Comparator 接口的类，并在其 compare() 方法中实现逻辑。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-07-20T11:10:40.937

使用 Comparator，我们可以**为一个类编写 n 个比较逻辑**。

例如

对于汽车类

我们可以有一个 Comparator 类来根据汽车型号进行比较。我们还可以有一个 Comparator 类来根据车型年份进行比较。

**车类**

```
public class Car  {

    int modelNo;

    int modelYear;

    public int getModelNo() {
        return modelNo;
    }

    public void setModelNo(int modelNo) {
        this.modelNo = modelNo;
    }

    public int getModelYear() {
        return modelYear;
    }

    public void setModelYear(int modelYear) {
        this.modelYear = modelYear;
    }

} 
```

**比较器 #1 基于型号**

```
public class CarModelNoCompartor implements Comparator<Car>{

    public int compare(Car o1, Car o2) {

        return o1.getModelNo() - o2.getModelNo();
    }

} 
```

**比较器 #2 基于型号年份**

```
public class CarModelYearComparator implements Comparator<Car> {

    public int compare(Car o1, Car o2) {

        return o1.getModelYear() - o2.getModelYear();
    }

} 
```

**但这在Comparable**接口的情况下是不可能的。

在 Comparable 接口的情况下，我们**在 compareTo() 方法中只能有一个逻辑**。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-01-19T06:12:32.860

**Comparable**接口包含一个调用的方法`compareTo(obj)`，该方法只接受一个参数，并将自身与同一类的另一个实例或对象进行比较。

**Comparator**接口包含一个调用方法`compare(obj1,obj2)`，该方法接受两个参数，它比较来自相同或不同类的两个对象的值。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-07T13:06:06.873

具有此方法的对象与其合作者的关系是不同的。

`compareTo()`是接口[Comparable](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)的一个方法，因此它用于将这个实例与另一个实例进行比较。

`compare()`是接口[Comparator](http://java.sun.com/javase/6/docs/api/java/util/Comparator.html)的一个方法，因此它用于比较另一个类的两个不同实例。

如果您愿意，实现`Comparable`意味着可以轻松比较类的实例。
实现`Comparator`意味着，实例适合比较（其他类的）不同对象。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-12-04T02:53:21.817

```
compareTo(T object) 
```

来自 java.lang.Comparable 接口，用于将此对象与另一个对象进行比较，以给出该对象小于的负 int 值，0 表示等于，或正值表示大于另一个。这是更方便的比较方法，但必须在您要比较的每个类中实现。

```
compare(T obj1, T obj2) 
```

来自 java.util.Comparator 接口，在一个单独的类中实现，该类比较另一个类的对象，为小于的第一个对象给出负 int 值，等于或大于第二个对象的正值。当你不能让一个类实现 compareTo() 时需要它，因为它是不可修改的。当您需要不同的方式来比较对象时，也可以使用它，而不仅仅是一种方式（例如按名称或年龄）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-07T13:03:38.190

`compareTo()`在一个对象上调用，以将其与另一个对象进行比较。 `compare()`在某个对象上调用以比较其他两个对象。

不同之处在于定义进行实际比较的逻辑的位置。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-07T13:08:33.110

主要区别在于接口的使用：

Comparable（具有 compareTo()）需要比较对象（以便使用 TreeMap 或对列表进行排序）以实现该接口。但是，如果该类没有实现 Comparable 并且由于它是 3rd 方库的一部分而您无法更改它怎么办？然后你必须实现一个比较器，它使用起来有点不太方便。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-05-27T10:18:31.980

还有一点：

*   `Comparable`用于定义类中对象的**默认**排序
*   `Comparator`用于定义要传递给方法的**自定义排序。**

[比较器与可比较](https://www.baeldung.com/java-comparator-comparable#comparator-vs-comparable)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-07T13:06:55.420

当你想对包含 Object Foo 的 List 进行排序时，Foo 类必须实现 Comparable 接口，因为 List 的排序方法就是使用这个方法。

当您想编写一个比较其他两个类的 Util 类时，您可以实现 Comparator 类。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-12-19T07:40:22.560

员工表
**名称、DoB、工资**
Tomas , 2/10/1982, 300
Daniel , 3/11/1990, 400
Kwame , 2/10/1998, 520

**Comparable**接口允许您对对象列表进行排序，例如Employees 参考一个主要字段——例如，您可以使用**CompareTo()**方法按名称或薪水排序

```
emp1.getName().compareTo(emp2.getName()) 
```

**Comparator**接口为此类需求提供了更灵活的接口，其唯一方法是**compare()**

```
public interface Comparator<Employee> {
 int compare(Employee obj1, Employee obj2);
} 
```

示例代码

```
public class NameComparator implements Comparator<Employee> {

public int compare(Employee e1, Employee e2) {
     // some conditions here
        return e1.getName().compareTo(e2.getName()); // returns 1 since (T)omas > (D)an 
    return e1.getSalary().compareTo(e2.getSalary()); // returns -1 since 400 > 300
} 
```

}

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-08-09T22:42:51.413

还有一个技术方面也应该强调。假设您需要来自客户端类的比较行为参数化，并且您想知道是否使用`Comparable`或`Comparator`用于这样的方法：

```
class Pokemon {
    int healthPoints;
    int attackDamage;
    public void battle (Comparable<Pokemon> comparable, Pokemon opponent) {
        if (comparable.compareTo(opponent) > 0) { //comparable needs to, but cannot, access this.healthPoints for example
            System.out.println("battle won");
        } else {
            System.out.println("battle lost");
        }
    }
} 
```

`comparable`将是 lambda 或对象，并且无法`comparable`访问`this`Pokemon 的字段。（在 lambda 中，`this`指的是 lambda 范围内的外部类实例，如程序文本中所定义。）所以**this 不**成立，我们必须使用`Comparator`带有两个参数的 a。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-04-10T09:14:11.907

使用 Comparable 接口根据多个值进行排序，例如 age,name,dept_name... 对于一个值，使用 Comparator 接口

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2013-03-11T10:53:04.723

```
Important Answar
String name;
int roll;

public int compare(Object obj1,Object obj2) { // For Comparator interface
    return obj1.compareTo(obj1);
}

public int compareTo(Object obj1) { // For Comparable Interface
    return obj1.compareTo(obj);
} 
```

这里的`return obj1.compareTo(obj1)`or`return obj1.compareTo(obj)`语句只取Object；原语是不允许的。例如

```
name.compareTo(obj1.getName()) // Correct Statement. 
```

但

```
roll.compareTo(obj1.getRoll()) 
// Wrong Statement Compile Time Error Because roll 
// is not an Object Type, it is primitive type. 
```

名称是字符串对象，所以它工作。如果要对学生的卷号进行排序，请使用以下代码。

```
public int compareTo(Object obj1) { // For Comparable Interface
    Student s = (Student) obj1;
    return rollno - s.getRollno();
} 
```

或者

```
public int compare(Object obj1,Object obj2) { // For Comparator interface
    Student s1 = (Student) obj1;
    Student s2 = (Student) obj2;
    return s1.getRollno() - s2.getRollno();
} 
```

# linq-to-sql - 是否可以反转 Linq 2 SQL 对象图的 DataContractSerialization 的单向行为？

> ID：420232
> 
> 赞同：1
> 
> 时间：2009-01-07T13:02:21.157
> 
> 标签：linq-to-sql, serialization

“按照惯例，主外键关系的父侧属性标记为序列化。双向关联中的另一侧不序列化。”

是否有可能以某种方式扭转这种情况，以便子方序列化父方？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T16:48:07.440

这似乎是不可能的。我没有使用 DataContractSerializer，而是选择使用 XmlSerializer 并仅控制实体之间的“可见性”，使它们看起来合适，要么是公共的，要么是内部的。这与 XmlInclude 而不是 KnownType 属性一起使我能够完成我最初想要的。

# asp.net - 登录时运行自定义代码

> ID：420237
> 
> 赞同：0
> 
> 时间：2009-01-07T13:04:08.343
> 
> 标签：asp.net, sharepoint, login

我在我的共享点自定义母版页上使用了 asp.net 登录控件。一切正常，我可以毫无问题地登录我的网站。

但是，我想在用户登录后运行一些代码，或者根据用户的角色执行重定向。

以前有人做过这种事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T13:15:01.973

您可以通过编程方式测试角色`User.IsInRole`

编辑：在从 ASP.NET 登录控件重定向时，检查表单身份验证令牌并在令牌存在时运行您的自定义代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T14:26:26.760

登录控件 (System.Web.UI.WebControls.Login) 有一个事件 LoggedIn ( [http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.loggedin.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.loggedin.aspx) )。只需订阅它并将您的代码放在处理程序中。我没有使用过 sharepoint，我是从 ASP.NET 的角度讲的。

# c++ - 使用 boost shared_ptr

> ID：420261
> 
> 赞同：9
> 
> 时间：2009-01-07T13:14:33.173
> 
> 标签：c++, boost

我必须使用智能指针，我发现 boost 中的“shared_ptr”看起来不错。我下载了 boost 库，在那里我可以看到许多文件和库。有没有办法只使用 shared_ptr ？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T13:19:46.987

[`boost bcp`](http://www.boost.org/doc/libs/1_37_0/tools/bcp/bcp.html)是你的朋友。它允许从其树中提取单个 boost 库。我过去成功地使用了它。shared_ptr 仅包含标题，因此这对您特别有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T13:26:26.847

您可以按照 litb 的建议使用 bcp，但如果您担心拖入额外的库代码，则不应该这样做。一般来说，Boost 遵循“你只需为你使用的东西付费”的 C++ 哲学。因此，如果您仅包含 shared_ptr 标头，这就是您的代码将使用的全部内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T13:26:25.803

如果您在 Windows 上使用最新版本的 Visual C++，BoostPro 在此处提供了一个方便的免费安装程序：[http://www.boostpro.com/products/free](http://www.boostpro.com/products/free)。

否则，或者如果您已经下载了源代码分发，您实际上应该能够立即开始使用 shared_ptr 和朋友，因为 shared_ptr 库是“仅头文件”——不需要编译 .cpp 文件。

# c# - C# 访问 System.Object[] 中的数据

> ID：420275
> 
> 赞同：2
> 
> 时间：2009-01-07T13:18:47.487
> 
> 标签：c#

我正在用 C# 编码，并且我有一本包含大量数据的字典。其中一个成员是“孩子”，但是当我尝试写出它的值时，我得到： System.Object[]

我知道 children 包含数据，可能是嵌套数据，但我不确定它是否是列表、字典、数组等。

如何写出“孩子”中的所有数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T13:24:16.197

任何实例化的 .NET 类型对“ToString()”的默认响应是写出完全限定的类型名称。

System.Object[] 意味着您有一个数组，其中每个元素的类型都是“对象”。这个“盒子”可以包含任何东西，因为 .NET 中的每种类型都派生自 Object。以下内容可能会告诉您数组在实例化类型方面真正包含的内容：

```
foreach (object o in children)
  Console.WriteLine(o != null ? o.GetType().FullName : "null"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T13:25:15.743

它是一个`object`引用数组，因此您需要对其进行迭代并提取对象，例如：

```
// could also use IEnumerable or IEnumerable<object> in
// place of object[] here
object[] arr = (object[])foo["children"];

foreach(object bar in arr) {
    Console.WriteLine(bar);
} 
```

如果您知道对象是什么，则可以进行转换等 - 或者您可以使用 LINQ OfType/Cast 扩展方法：

```
foreach(string s in arr.OfType<string>()) { // just the strings
    Console.WriteLine(s);
} 
```

或者您可以测试每个对象：

```
foreach(object obj in arr) { // just the strings
    if(obj is int) {
        int i = (int) obj;
        //...
    }
    // or with "as"
    string s = obj as string;
    if(s != null) {
        // do something with s
    }
} 
```

除此之外，您将不得不添加更多细节......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T13:53:09.430

（注意我没有在VS中测试这段代码，在这里工作内存）。

```
object[] children = (object[])foo["children"];
foreach(object child in children)
    System.Diagnostics.Debug.WriteLine(child.GetType().FullName); 
```

这应该转储孩子的类名。

如果您在 foo["children"] 上进行 foreach 操作，那么您不应该因为找不到公共迭代器而失败，因为根据定义，数组有一个（除非我错过了什么）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-18T15:21:51.880

我意识到这个线程已经有一年多了，但我想发布一个我找到的解决方案，以防有人试图从使用 Cook Computing XML-RPC 库返回的 System.Object[] 中获取数据。

返回 Children 对象后，使用以下代码查看其中包含的键/值：

```
foreach (XmlRpcStruct rpcstruct in Children)
        {
            foreach (DictionaryEntry de in rpcstruct)
            {
                Console.WriteLine("Key = {0}, Value = {1}", de.Key, de.Value);
            }
            Console.WriteLine();
        } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T07:08:47.127

"I know that children contains data, probably nested data, but I'm unsure if it's a list, dictionary, array, etc"

So the childreen is IEnumerable or not a collection

try this code

```
void Iterate(object childreen)
{
  if(data is IEnumerable)
     foreach(object item in data)
      Iterate(item);
  else Console.WriteLine(data.ToString());
} 
```

# bash - 在 bash 中将文本附加到 stderr 重定向

> ID：420278
> 
> 赞同：13
> 
> 时间：2009-01-07T13:21:27.933
> 
> 标签：bash, exec, stderr

现在我正在使用 exec 将 stderr 重定向到错误日志

```
exec 2>> ${errorLog} 
```

唯一的缺点是我必须以时间戳开始每次运行，因为 exec 只是将文本直接推送到日志文件中。有没有办法重定向 stderr 但允许我向它附加文本，例如时间戳？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-07T15:31:18.967

这很有趣。我问过一个非常了解 bash 的人，他这样告诉我：

```
 foo() { while IFS='' read -r line; do echo "$(date) $line" >> file.txt; done; }; 
```

首先，它创建了一个从标准输入读取一行原始输入的函数，而对 IFS 的赋值使其不会忽略空白。读取一行后，它会在输出前附加适当的数据。然后你必须告诉 bash 将 stderr 重定向到该函数中：

```
exec 2> >(foo) 
```

您写入 stderr 的所有内容现在都将通过 foo 函数。请注意，当您在交互式 shell 中执行此操作时，您将不会再看到提示，因为它已打印到 stderr，并且 foo 中的读取是行缓冲的 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-08T14:45:04.140

你可以简单地使用：

```
exec 1> >( sed "s/^/$(date '+[%F %T]'): /" | tee -a ${LOGFILE}) 2>&1 
```

这不会完全解决您关于提示未显示的问题（它会在短时间内显示，但不是实时的，因为管道会缓存一些数据......），但会在标准输出和中显示输出 1:1文件。

唯一的问题是，我无法解决的是，从一个函数中执行此操作，因为这会打开一个子shell，其中 exec 对主程序无用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-28T14:20:00.270

此示例重定向 stdout 和 stderr 而不会丢失原始 stdout 和 stderr。stdout 处理程序中的错误也会记录到 stderr 处理程序。文件描述符保存在变量中并在子进程中关闭。Bash 很小心，不会发生碰撞。

```
#! /bin/bash

stamp ()
{
  local LINE
  while IFS='' read -r LINE; do
    echo "$(date '+%Y-%m-%d %H:%M:%S,%N %z') $$ $LINE"
  done
}

exec {STDOUT}>&1
exec {STDERR}>&2
exec 2> >(exec {STDOUT}>&-; exec {STDERR}>&-; exec &>> stderr.log; stamp)
exec > >(exec {STDOUT}>&-; exec {STDERR}>&-; exec >> stdout.log; stamp)

for n in $(seq 3); do
  echo loop $n >&$STDOUT
  echo o$n
  echo e$n >&2
done 
```

这需要当前的 Bash 版本，但由于[Shellshock](https://en.wikipedia.org/wiki/Shellshock_%28software_bug%29)，现在人们可以依赖它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-17T09:21:27.043

```
cat q23123  2> tmp_file ;cat tmp_file | sed -e "s/^/$(date '+[%F %T]'): /g" >> output.log; rm -f tmp_file 
```

# syntax - 此表达式具有 int 类型，但在这里与类型 unit 一起使用

> ID：420294
> 
> 赞同：3
> 
> 时间：2009-01-07T13:27:21.993
> 
> 标签：syntax, f#

我正在尝试在 F# 中获得此 vb.net 代码的完全等效（非功能性）：

```
Function FastPow(ByVal num As Double, ByVal exp As Integer) As Double
   Dim res As Double = 1
   If exp < 1 Then
      If exp = 0 Then Return res
      exp = -exp
      num = 1 / num
   End If
   Do While exp > 1
      If exp Mod 2 = 1 Then 
         res = res * num
      num = num * num
      exp = exp >> 1
   Loop
   Return res * num
End Function 
```

我写了这个：

```
let FastPow num exp =
   let mutable ex = exp
   let mutable res = 1
   let mutable n = num
   if ex < 1 then
      if ex = 0 then res
      ex <- -ex
      n <- 1 / n
   while ex > 1 do
      if (ex % 2 = 1) then 
         res <- res * n
      n <- n * n
      exp >>> 1
   res * n 
```

但是在 res 的“if ex = 0 then res”行中，我得到了一个错误：
“这个表达式的类型为 int，但在这里与类型单元一起使用”。我不明白为什么它会给我这个错误。
编辑：我实际上也收到了警告：
“这个表达式应该有'unit'类型，但有'int'类型。”
在“如果（例如 % 2 = 1）那么”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T14:42:18.083

在 F# 中，函数的返回值是函数中计算的最后一个表达式。因此，让我们关注以下内容：

```
 if ex < 1 then
      if ex = 0 then res    (* <--- this is not an early return *)
      ex <- -ex             (* <--- F# evaluates this code after the *)
      n <- 1 / n            (*      if statement *) 
```

此外，if 语句具有返回值，这也恰好是 if 语句中执行的最后一个值。如果 if 语句不是函数的返回值，则它应该具有返回类型`unit`。请注意，变量赋值的返回类型为`unit`.

我们需要重写您的代码以适应您的提前返回，因此我们可以这样做：

```
let FastPow2 num exp =
    if exp = 0 then 1
    else
        let mutable ex = exp
        let mutable res = 1
        let mutable n = num
        if ex < 1 then
            ex <- -ex
            n <- 1 / n
        while ex > 1 do
            if (ex % 2 = 1) then  (* still have a bug here *)
                res <- res * n
            n <- n * n
            exp >>> 1  (* <--- this is not a variable assignment *)
        res * n 
```

我们仍然有一个错误，尽管我认为 F# 在错误的地方报告了错误。该表达式`exp >>> 1`返回一个 int，它不分配任何变量，因此它不等同于您的原始 C# 代码。我认为您的意思是改用该`ex`变量。我们可以按如下方式修复您的代码：

```
let FastPow2 num exp =
    if exp = 0 then 1
    else
        let mutable ex = exp
        let mutable res = 1
        let mutable n = num
        if ex < 1 then
            ex <- -ex
            n <- 1 / n
        while ex > 1 do
            if (ex % 2 = 1) then 
                res <- res * n
            n <- n * n
            ex <- ex >>> 1
        res * n 
```

现在你的功能是固定的，但它真的很丑。让我们将其转换为更惯用的 F#。您可以将 if 语句替换为模式匹配，并将 while 循环替换为递归：

```
let FastPow2 num exp =
    match exp with 
    | 0 -> 1
    | _ ->
        let rec loop ex res n =
            if ex > 1 then
                let newRes = if ex % 2 = 1 then res * n else res
                loop (ex >>> 1) newRes (n * n)
            else res * n

        let ex, n = if exp < 1 then (-exp, 1 / num) else (exp, num)
        loop ex 1 n 
```

好多了！还有一些空间可以美化这个功能，但你明白了:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T14:12:34.057

问题在于 if 语句要解析为值而不是单位，您需要“then”部分和“else”部分，两者都解析为相同的类型。

例如：

```
let a = if true then 1;; 
```

将产生相同的错误 - 表达式的类型为 int 但与类型单元一起使用。

然而：

```
let a = if true then 1 else 0;; 
```

将评估为 int 而不会出错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T14:24:50.367

这几乎是你所能得到的，因为其他人已经说过你不能跳出函数的中间，并且有一个地方是你不更新变量（在时间的底部）。

```
let FastPow num exp =
   let mutable exp = exp
   let mutable res = 1
   let mutable n = num
   match exp with
   | O -> n <- num
   | _ when exp < 1 ->
      exp <- -exp
      n <- 1 / n
   | _ ->
       while exp > 1 do
          if (exp % 2 = 1) then 
             res <- res * n
          n <- n * n
          exp <- exp >>> 1
   res * n 
```

如果写得更实用，我会更漂亮。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T13:53:57.963

这意味着之后`then`应该有一些表达式，但你有整数值。你不能从函数的中间跳出来。

**编辑**

“如果”没有奏效是因为

```
ex >>> 1

should be

ex <- ex >>> 1 
```

这是有效的代码：

```
let FastPow num exp =
    let calcExp num exp = 
        let mutable res = 1.0
        let mutable n   = num
        let mutable ex  = exp
        while ex > 1 do
            if ((ex % 2) = 1) then  
                res <- res * n
            n <- n * n
            ex <- ex >>> 1
        res * n

    match exp with
    | ex when ex = 0 -> 1.0
    | ex when ex < 0 -> calcExp (1.0/num) -exp
    | _ -> calcExp num exp 
```

我只是将计算作为单独的函数取出，最后检查参数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T15:42:45.543

感谢您的回答。这是当前的非功能版本。

```
let FastPow num exp =
   let mutable ex = exp
   let mutable res = 1.0
   let mutable n = num
   if ex = 0 then 1.0
   else 
      if ex < 1 then
         ex <- -ex
         n <- 1.0 / n
      while ex > 1 do
         if (ex % 2 = 1) then res <- res * n
         n <- n * n
         ex <- ex >>> 1
      res * n 
```

现在我有了一个工作版本，我将尝试使其更具功能性，但这超出了这个问题的范围。编辑：我得到了我预期的更好的结果，所以我将发布针对速度优化的递归版本（比迭代版本略快，比我的计算机中的 C# 迭代版本（!!!）快 10%）：

```
let rec loop res num exp =
   if exp = 0 then res
   elif (exp % 2) = 1 then loop (res * num) (num * num) (exp / 2)
   else loop res (num * num) (exp / 2)

let FP num exp =
   let n = if exp < 0 then 1.0 / num else num
   loop 1.0 n (Math.Abs(exp)) 
```

# windows - 为什么某些 PDF 在使用 Lighttpd 服务时在 IE 中下载时会挂起

> ID：420295
> 
> 赞同：2
> 
> 时间：2009-01-07T13:27:26.377
> 
> 标签：windows, internet-explorer, pdf, lighttpd

我们有许多使用 Lighttpd 托管的 PDF，但是当它们在 IE (7.0.5730.13) 中下载时，文件下载在最后挂起并且没有完成。例如

[http://static.vouchercodes.co.uk/printable/87-burger-king-voucher.pdf](http://static.vouchercodes.co.uk/printable/87-burger-king-voucher.pdf)

[http://static.vouchercodes.co.uk/printable/10-gbk.pdf](http://static.vouchercodes.co.uk/printable/10-gbk.pdf)

这在 OSX 10.5 和 Windows XP 上的 Firefox (3.0.5) 中都可以正常工作，但在 IE 7 上则不行。

可以在[http://www.mytton.net/so-pdf-q.png看到挂起下载的截图](http://www.mytton.net/so-pdf-q.png)

这没有本地化到一台机器上，并且已在其他 IE7 Windows PC 上复制。该问题仅影响 vuevocodes.co.uk 站点上的 PDF，因为其他具有 PDF 的站点可以正常工作。

它也被其他版本的 IE7/IE6 复制，但不一致。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T13:58:23.210

我相信这是IE下acrobat插件的渐进式下载问题。

您的 lighttpd 服务器正在回答 a `HTTP/1.1 206 Partial Content`，这有时会导致 acrobat 客户端中的下载进度出现奇怪的停止

一些导致解决该问题的方法：

*   在创建 pdf 文件时不要使用“另存为优化的快速 Web 视图”选项
*   取消选中 Acrobat Reader 的“允许后台下载整个文件”首选项
*   禁用服务器的字节服务容量（但显然不推荐这样做）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T14:40:38.710

该问题与字节服务有关。[请参阅http://httpd.apache.org/docs/1.3/misc/known_client_problems.html](http://httpd.apache.org/docs/1.3/misc/known_client_problems.html)的字节服务部分

> The Adobe Acrobat Reader plugin makes extensive use of byteranges and prior to version 3.01 supports only the multipart/x-byterange response. Unfortunately there is no clue that it is the plugin making the request. If the plugin is used with Navigator, the above workaround works fine. But if the plugin is used with MSIE 3 (on Windows) the workaround won't work because MSIE 3 doesn't give the Range-Request clue that Navigator does. To workaround this, Apache special cases "MSIE 3" in the User-Agent and serves multipart/x-byteranges. Note that the necessity for this with MSIE 3 is actually due to the Acrobat plugin, not due to the browser.

This is also an issue in Lighttpd and is documented at [http://redmine.lighttpd.net/issues/show/171](http://redmine.lighttpd.net/issues/show/171) with a workaround (tested and works) at [note 8](http://redmine.lighttpd.net/issues/show/171#note-8).

# r - 有哪些学习 R 的好书、网络资源和项目？

> ID：420296
> 
> 赞同：25
> 
> 时间：2009-01-07T13:27:28.407
> 
> 标签：r

我有一本名为《计算机科学家统计》的书以及我的工程统计教科书，所以我正在考虑使用其中的各种问题和示例来学习 R，这可能是一个好的开始。但是任何人都可以推荐包含 R 信息的书籍和网站，特别是如果它们是为具有一定统计学知识的人设计的吗？作为一名学习软件工程的大学生，是否有任何大中型项目或现实世界的情况可以使用 R 来感受它？

# 也可以看看

*   [关于 R 的可理解文档](https://stackoverflow.com/questions/72860/understandable-documentation-about-r)，其中有一些指向 R 文档的链接。还有一些基本信息/教程网站。
*   [学习 R 语言](https://stackoverflow.com/questions/192369/books-for-learning-the-r-language)的书籍，主要介绍学习 R 的书籍。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-07T13:56:37.397

这基本上是我的书签的转储，以及我桌上的东西。

入门：

1.  关于 R的[教程视频](http://www.decisionsciencenews.com/?p=261)
2.  John Cook为程序员[介绍R](http://www.johndcook.com/R_language_for_programmers.html)
3.  R[参考卡](http://cran.r-project.org/doc/contrib/Short-refcard.pdf)
4.  互动教程：[R 简介](https://www.datacamp.com/)

先进的：

1.  R[画廊](http://addictedtor.free.fr/graphiques/)
2.  R[维基](https://rads.stackoverflow.com/amzn/click/com/158488486X)
3.  高级统计[的 Quick-R](http://www.statmethods.net/advstats/index.html)

图书：

1.  [R Book](https://rads.stackoverflow.com/amzn/click/com/0470973927)（涵盖基础知识、经典统计测试、基本统计建模（ANOVA、ANCOVA、GLM、非线性模型等）、高级统计建模（树模型、时间序列分析、空间统计、生存分析、模拟)，并玩弄图形输出。
2.  [R 图形](https://rads.stackoverflow.com/amzn/click/com/158488486X)（如何使 R 图形看起来清晰）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-30T13:54:48.723

我发现 Patrick Burns 的**The R Inferno**对了解 R 很有帮助

来自*R 地狱*：

> **摘要：**如果您正在使用 R 并且您认为自己在地狱中，那么这是适合您的地图。

[http://lib.stat.cmu.edu/S/Spoetry/Tutor/R_inferno.pdf](http://lib.stat.cmu.edu/S/Spoetry/Tutor/R_inferno.pdf)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T18:43:00.290

我最喜欢的 R 书籍是Robert Gentlemen 的[R Programming for Bioinformatics](https://rads.stackoverflow.com/amzn/click/com/1420063677)。它不会在你学习语言的同时教你统计学，而是从程序员的角度呈现语言。我认为这本书提供的背景比任何在线资源都好。这是从第一次学习 R 时不太了解统计数据的生物学家/程序员的角度来看的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-10-29T03:20:20.603

这是普林斯顿大学的一本真正的 R 基础书籍，免费

[https://sites.google.com/site/undergraduateguidetor/](https://sites.google.com/site/undergraduateguidetor/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T15:06:30.203

这是 Brendan O'Connor 今天刚写的一篇博文，其中有一些学习 R 的技巧。 [爱它又恨它，R 已经成熟](http://anyall.org/blog/2009/01/love-it-and-hate-it-r-has-come-of-age/)

另外，我赞同 Jason 对“The R Book”的推荐。它很贵，但比购买其他几本书并对它们都感到失望要便宜。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-15T18:40:52.520

几年前，我在一门本科统计学课程中使用了 R，该课程使用[现代应用统计学和 S-PLUS](https://rads.stackoverflow.com/amzn/click/com/0387988254)作为其文本（该版本现已绝版，但这[本书](https://rads.stackoverflow.com/amzn/click/com/0387954570)似乎等效）。

通常，R 与 S 足够兼容，因此您可以使用大量的 S 资源。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T13:51:49.527

综合[R 档案网络](http://lib.stat.cmu.edu/R/CRAN/)似乎很有希望。这是两个链接之外的[R 书单。](http://www.r-project.org/doc/bib/R-books.html)也许一些[S-plus 信息](http://www.insightful.com/)也可以推广到 R。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-28T15:53:49.590

我刚刚发现了[Rosetta Code](http://rosettacode.org/wiki/Main_Page)网站，它同时使用多种不同的语言发布问题和解决方案。它包括 R 示例。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-09-10T17:52:38.417

哥伦比亚大学的 Andrew Gelman 撰写了这本出色的书，其中包含许多示例和可下载的数据文件，供您根据书中提出的概念进一步学习。 [链接文本](http://www.stat.columbia.edu/~gelman/arm/software/ "使用回归和多级/层次模型的统计建模")

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-07-26T15:18:20.327

我发现本教程以图形方式很好地呈现，易于访问且快速：

[http://www.statmethods.net/index.html](http://www.statmethods.net/index.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-09-11T06:20:45.183

irc.freenode.net 的#R 频道是提问的好地方。rseek.org 也非常方便，因为 google 否则会将 R 与其他内涵混为一谈

# linq - LINQ 中的完整搜索测试（自定义过滤器查询）

> ID：420299
> 
> 赞同：2
> 
> 时间：2009-01-07T13:27:54.023
> 
> 标签：linq, tdd, full-text-search

我有一张桌子，上面有餐厅名称列表和指向另一个包含美食类型的桌子的链接。

我想在我的网页上提供一个搜索框，在输入时，会在数据库中搜索每个单词并返回结果。我正在寻找一种不涉及设置 sql 全文搜索的解决方案，因为我希望能够使用 Linq to SQL 对其进行测试。

从我的旧代码中，我有一个函数可以在给定输入文本的情况下创建一个查询过滤器，并根据它返回所有结果。

```
Private Function SetupQuery(ByVal searchText As String) As String
    Dim searchFields As New List(Of String)

    searchFields.Add("Name")
    searchFields.Add("Postcode")
    searchFields.Add("Cuisine")

    Dim firstCol As Boolean = True

    Dim a() As String
    Dim j As Integer
    a = searchText.Trim.Split(" ")

    Dim filter As String = ""

    Dim compareString As String
    For Each col As String In searchFields
        For j = 0 To a.GetUpperBound(0)
            compareString = a(j).ToUpper()
            compareString = compareString.Trim()

            If firstCol Then
                filter = filter & col & " LIKE '" & compareString & "%' "
                firstCol = False
            Else
                filter = filter & " or " & col & " LIKE '" & compareString & "%' "
            End If
        Next
    Next

    Return filter
End Function 
```

这对搜索字段进行了硬编码，然后遍历搜索文本中的每个单词以构造 OR LIKE 过滤器。

我确信我可以在我的 LINQ 代码中使用它，但它似乎不是一个优雅的解决方案，特别是因为这些列是硬编码的，并且没有使用 LINQ 如何使用它们。

任何人都可以推荐一种更好的方法来做到这一点，或者在这个方向上提供一些提示吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T13:34:18.283

我不知道这会影响您的测试，但可以使 LinqtoSQL 与全文索引一起工作，只需稍作调整：

*   [LinqToSql 和全文搜索 - 可以吗？](https://stackoverflow.com/questions/67706/linqtosql-and-full-text-search-can-it-be-done)
*   [http://sqlblogcasts.com/blogs/simons/archive/2008/12/18/LINQ-to-SQL---Enabling-Fulltext-searching.aspx](http://sqlblogcasts.com/blogs/simons/archive/2008/12/18/LINQ-to-SQL---Enabling-Fulltext-searching.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T17:33:38.707

您可以使用全文搜索并仍然使用 LINQ to SQL。您可以创建一个存储过程并让 LINQ 调用它。除了找到完全匹配之外，您还可以返回：

*   简单搜索特定单词或短语
*   词库搜索单词的同义词形式——在 IE 上搜索可能会返回对 Internet Explorer 和 IE 的点击（基于词库的扩展搜索）；在 Bombay 上的搜索也可能返回 Mumbai 的命中（基于词库的替换搜索）
*   将返回单词的所有不同语言形式（称为代数）的搜索对 bank 的搜索将返回对银行、银行、银行、银行和银行等的命中（搜索词银行的所有变格和/或变位）
*   口音不敏感的搜索 - 对咖啡馆的搜索会将点击返回到咖啡馆和咖啡馆

[http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx](http://weblogs.asp.net/scottgu/archive/2007/08/16/linq-to-sql-part-6-retrieving-data-using-stored-procedures.aspx)

[http://www.simple-talk.com/sql/learn-sql-server/sql-server-full-text-search-language-features/](http://www.simple-talk.com/sql/learn-sql-server/sql-server-full-text-search-language-features/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T17:02:25.930

这可能不是最好的方法，但如果你总是将搜索文本作为字符串拆分为三个数组，那么你可以尝试使用这个：

```
from t in temp
where t.Name == a(0)
|| t.Postcode == a(1)
|| t.Cuisine == a(2)
select t 
```

我通常做 C#，所以 VB 中的任何东西都很自然，但我认为 LINQ 语法应该是相似的

# unicode - Lisp：在将八位字节流转换为具有格式错误的字节的 EUC-JP 时，需要帮助从 SBCL 获得正确的行为

> ID：420300
> 
> 赞同：2
> 
> 时间：2009-01-07T13:28:59.247
> 
> 标签：unicode, lisp, sbcl

以下在这种特殊情况下不起作用，抱怨你给它的任何东西都不是一个字符。

```
(handler-bind ((sb-int:character-coding-error
                 #'(lambda (c)
                      (invoke-restart 'use-value #\?))))
    (sb-ext:octets-to-string *euc-jp* :external-format :euc-jp))
```

其中`*euc-jp*`是包含 EUC-JP 编码文本二进制的变量。

我也试过`#\KATAKANA_LETTER_NI`了，而不是 #\? 也只是“”。到目前为止没有任何效果。

任何帮助将不胜感激！

编辑：要重现，请使用 drakma`*EUC-JP*`获取[http://blogs.yahoo.co.jp/akira_w0325/27287392.html 。](http://blogs.yahoo.co.jp/akira_w0325/27287392.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:46:00.503

SBCL 1.0.18 中有一个如下所示的表达式`mb-util.lisp`：

```
(if code
    (code-char code)
    (decoding-error array pos (+ pos bytes) ,format
                    ',malformed pos)) 
```

I'm not very familiar with SBCL's internals, but this looks like a bug. The consequent returns a character, while the alternative returns a string (no matter what you give to it via `USE-VALUE`, it's always converted into a string by way of the `STRING` function; see the definition of `DECODING-ERROR` in `octets.lisp`).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T20:58:58.620

这个对我有用：

```
CL-USER> (handler-bind ((sb-int:character-coding-error
                         #'(lambda (c)
                             (declare (ignore c))
                             (invoke-restart 'use-value #\?))))
           (sb-ext:octets-to-string (make-array '(16)
                                                :element-type '(unsigned-byte 8)
                                                :initial-contents '#(181 65 217 66 164 67 181 217 164 223 164 222 164 185 161 163))
                                    :external-format :euc-jp))
"?A?B?C休みます。" 
```

可能`*euc-jp*`不是（向量（无符号字节 8））？

# php - 使用 PHP 和 XPath 进行屏幕抓取

> ID：420304
> 
> 赞同：1
> 
> 时间：2009-01-07T13:31:48.537
> 
> 标签：php, xpath, screen-scraping

有谁知道在使用 XPath 提取数据时如何维护文本格式？

我目前正在提取所有块

`<div class="info"> <h5>title</h5> text <a href="somelink">anchor</a> </div>`

从一个页面。问题是当我访问 nodeValue 时，我只能得到纯文本。如何捕获包括格式在内的内容，即代码中的 h5 和静止图像？

提前致谢。我在谷歌上搜索了所有可以想象的组合，但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T13:37:29.760

如果您将它作为 DomElement $element 作为 DomDocument $dom 的一部分，那么您将需要执行以下操作：

```
$string = $dom->saveXml($element); 
```

元素的 NodeValue 实际上是文本值，而不是结构化的 XML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-08T09:42:25.613

我想添加到 Ciaran McNulty 的答案

您可以在 SimpleXml 中执行相同的操作，例如：

```
$simplexml->node->asXml(); // saveXml() is now an alias 
```

并扩大报价

> 元素的 NodeValue 实际上是文本值，而不是结构化的 XML。

你可以这样想你的节点：

```
<div class="info">
    <__toString()> </__toString()>
    <h5>title</h5>
    <__toString()> text </__toString()>
    <a href="somelink">anchor</a>
    <__toString()> </__toString()>
</div> 
```

调用`$element->nodeValue`类似于调用`$element->__toString()`只会获取 __toString() 元素的地方。我创建的想象`__toString()`被正式定义为[`XML_TEXT_NODE`](http://us.php.net/manual/en/domxml.constants.php).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-10T21:14:59.623

**[XPath 语言](http://www.w3.org/TR/xpath)被设计为嵌入到另一种语言（如 DOM API、XSLT、XQuery 等）中，不能单独使用**。原始问题没有指定所需的嵌入是什么。

**当 XPath 嵌入[XSLT](http://www.w3.org/TR/xslt)**时，下面是一个非常简单且简短的解决方案。

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>

    <xsl:template match="div[@class='info']">
       <xsl:copy-of select="."/>
    </xsl:template>
</xsl:stylesheet> 
```

**应用于此 xml 文档时**：

```
<html>
    <body>
        <div class="info">
            <h1>title1</h1> text1
            <a href="somelink1">anchor1</a>
        </div>
        Something else here
        <div class="info">
            <h2>title2</h2> text2
            <a href="somelink2">anchor2</a>
        </div>
        Something else here
        <div class="info">
            <h3>title3</h3> text3
            <a href="somelink3">anchor3</a>
        </div>
    </body>
</html> 
```

**产生想要的结果**：

```
<div class="info">
  <h1>title1</h1> text1
    <a href="somelink1">anchor1</a>
</div>
        Something else here
<div class="info">
  <h2>title2</h2> text2
  <a href="somelink2">anchor2</a>
</div>
        Something else here
<div class="info">
  <h3>title3</h3> text3
  <a href="somelink3">anchor3</a>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T13:38:49.867

您需要确保您的 xpath 查询“结束”在`<div class="info">`. 但是，由于 XPath 的工作方式，您仍然会在单独的节点中获得所有“子标签”。你只需要连接它们。

您也可以使用 XPath 的[连接](http://www.w3schools.com/Xpath/xpath_functions.asp)功能，但是，因为我没有使用它，我不能说您可能会遇到什么问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T13:54:02.580

`div/node()`应该做的伎俩。

示例输入：

```
<div class="info">
  some <h5>title</h5> text <a href="somelink">anchor</a> more text
</div> 
```

示例 XSLT 样式表：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:template match="/">
        <newtag>
                <xsl:copy-of select="div/node()"/>
        </newtag>
</xsl:template>

</xsl:stylesheet> 
```

示例输出：

```
<?xml version="1.0" encoding="utf-8"?>
<newtag> some<h5>title</h5> text <a href="somelink">anchor</a> more text</newtag> 
```

# amazon-web-services - 有用的 EC2 AMI 的来源

> ID：420310
> 
> 赞同：2
> 
> 时间：2009-01-07T13:34:17.177
> 
> 标签：amazon-web-services, amazon-ec2, amazon-ami

使用 Amazon 自己的[客户端库](http://developer.amazonwebservices.com/connect/entry.jspa?externalID=552&categoryID=187)（或[替代品](http://code.google.com/p/typica/)），您可以获得可用的预打包 AMI 的列表，但该界面绝对是为可编写脚本而非可读性而设计的。[Elasticfox](http://developer.amazonwebservices.com/connect/entry.jspa?externalID=609)更好，但仍然无法轻松查看 AMI 的*功能*、允许用户评分等。

是否有一个集中的地方可以让我轻松找到用于特定目的的 AMI？用于 Apache、OpenMQ、MySQL 之类的 AMI？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T14:30:43.677

这是共享 AMI 的[列表](http://developer.amazonwebservices.com/connect/kbcategory.jspa?categoryID=101)。恐怕您无法通过标题或描述中的关键字自动搜索列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T15:22:54.570

你看过[这个清单](http://developer.amazonwebservices.com/connect/kbcategory.jspa?categoryID=101&resultOffset=0&sortField=9&sortOrder=0&filterEntryTypeID=-1)吗？它与 elasticfox 列表一样混乱，但包含描述。

听起来有人应该筛选这个页面并使其可搜索..

# stack - 堆栈 - 为什么是 PUSH 和 POP？

> ID：420315
> 
> 赞同：13
> 
> 时间：2009-01-07T13:35:38.607
> 
> 标签：stack

我想知道为什么我们使用术语“push”和“pop”来添加/删除堆栈中的项目？是否有一些物理隐喻导致这些术语很常见？

我唯一的建议是类似于[手枪的弹簧弹匣](http://www.istockphoto.com/file_thumbview_approve/2645114/2/istockphoto_2645114_9mm_handgun_magazine.jpg)，子弹被“推”入其中并可以“弹出”出来，但这似乎不太可能。

第二个堆栈琐事问题：为什么大多数 CPU 将调用堆栈实现为在内存中**向下**增长，而不是向上增长？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-07T13:39:36.557

对于第二个问题，维基百科有一篇关于控制堆栈的 CS 哲学的文章：

[http://en.wikipedia.org/wiki/LIFO](http://en.wikipedia.org/wiki/LIFO)

首先，也在维基百科上：

> 一个常用的比喻是弹簧加载的自助餐厅堆栈中的一堆盘子的想法。在这样的堆叠中，只有顶板对用户可见和可访问，所有其他板保持隐藏。随着新盘子的添加，每个新盘子都成为堆叠的顶部，将每个盘子隐藏在下面，将盘子堆向下推。当顶板从堆叠中移除时，可以使用它们，板弹回，第二个板成为堆叠的顶部。这个比喻说明了两个重要原则：后进先出原则是一个；第二个是堆栈的内容是隐藏的。只有顶板是可见的，所以要查看第三块板上的内容，必须移除第一块和第二块板。这也可以写成FILO-First In Last Out，即

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-07T13:49:58.767

我相信弹簧加载的板叠是正确的，作为术语 PUSH 和 POP 的来源。

特别是，麻省理工学院的东校区公共食堂在 1957 年至 1967 年的时间范围内装有弹簧加载的盘子。Tech Model Railroad Club 会使用 PUSH 和 POP 这两个术语。我想这就是起源。

Tech Model Railroad Club 无疑影响了 Digital Equipment Corporation (DEC) PDP-6 的设计。PDP-6 是最早在硬件中具有面向堆栈指令的机器之一。指令是 PUSH、POP、PUSHJ、POPJ。

[http://ed-thelen.org/comp-hist/pdp-6.html#Special%20Features](http://ed-thelen.org/comp-hist/pdp-6.html#Special%20Features)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-07T14:11:19.987

对于第二个问题：小型系统上的汇编程序程序员倾向于编写从内存中的低地址开始的代码，并随着更多代码的添加而增长到更高的地址。

正因为如此，使堆栈向下增长允许您在物理内存的顶部启动堆栈，并允许两个内存区域相互增长。这简化了这种琐碎环境中的内存管理。

即使在具有隔离 ROM/RAM 固定数据分配的系统中，也最容易自下而上构建，从而替换上述说明的代码部分。

虽然这种琐碎的内存方案已经很少见了，但硬件实践仍在继续。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-07T13:37:58.057

把它想象成一个 pez 分配器。你可以在上面推一个新的。然后从顶部弹出它。

当我想到 push 和 pop 时，我总是这么想。（虽然可能不是很有历史意义）

**你在问自己 PEZ 到底是什么？** 见评论。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-07T14:00:19.167

关于您的“第二个微不足道的问题”：我在定义“向上”和“向下”的含义时看到了相当大的不一致！从早期开始，一些制造商和作者在页面顶部绘制低地址的内存图（大概模仿读取页面的顺序），而其他人将高地址放在页面顶部（大概模仿方格纸坐标或建筑物的楼层）。

当然，堆栈的概念（以及可寻址内存的概念）独立于这种视觉隐喻。可以实现一个在任一方向“增长”的堆栈。事实上，我经常看到下面的技巧（在裸机级实现中）用于在两个堆栈之间共享内存区域：

```
+---+---+--------   -------+--+--+--+
|   |   |   ->   ...   <-  |  |  |  |
+---+---+--------   -------+--+--+--+
^                                   ^
Stack 1      both stacks      Stack 2
base        "grow" toward        base
              the middle 
```

所以我的回答是，从概念上讲，堆栈*永远不会*“向下”或“向上”增长，而只是从它们的基础增长。单个堆栈可以在任一方向上*实现*（或者在*任何*方向上都可以实现，如果它使用带有垃圾收集的链接表示，在这种情况下，元素可能位于节点空间中的*任何位置*）。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-07T13:38:37.883

头韵总是很有吸引力（看看我在那里做了什么？），这些词很短，头韵，暗示性。旧的 BASIC 命令 peek 和 poke 也是如此，它们具有并行 k 的额外优势。

一个常见的物理隐喻是自助餐厅的盘子分配器，其中弹簧加载的盘子堆叠使您可以从顶部取出一个盘子，但下一个盘子会上升到相同的位置。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T13:40:06.370

[此页面](http://www.embeddedrelated.com/usenet/embedded/show/79584-1.php)上的答案几乎可以回答堆栈方向问题。如果我必须总结一下，我会说它是向下完成的，以保持与古代计算机的一致。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T13:41:05.150

我认为最初的故事是因为一些开发人员看到了盘子堆（就像你经常在自助餐厅看到的那样）。你把一个新盘子推到堆栈的顶部，你也从顶部弹出一个。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T14:00:26.547

至于在内存中向下增长的堆栈，请记住，在处理分层数据结构（树）时，大多数程序员都乐于在页面顶部绘制一个底部（或树干）的页面......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-11T06:44:49.877

我知道这个线程真的很老，但我对第二个问题有一个想法：

在我看来，堆栈会增长，即使内存地址会减少。如果你要在一张纸上写一大堆数字，你会从左上角开始，从 0 开始。然后你会从左到右增加数字，然后从上到下。所以说堆栈是这样的：

```
000 001 002 003 004 000 001 002 003 004 000 001 002 003 004
005 006 007 008 009 005 006 007 008 009 005 006 007 008 009 
010 011 012 013 014 010 011 012 013 014      010 011 012 013 014 
015 016 017 018 019 015 016 017 018 019 015 016 017 018 019 
020 021 022 023 024 020 021 022 023 024 020 021 022 023 024
025 026 027 028 029 025 026 027 028 029 025 026 027 028 029

```

其中粗体数字表示堆栈内存，非粗体数字表示堆栈未使用的内存地址。每个相同编号的块代表调用堆栈增长的程序的一个阶段。

即使内存地址向下移动，堆栈也在向上增长。

同样，对于弹簧加载的板堆，
如果您从堆的顶部取下一个板，您会称其为第一个板（最小的数字），对吗？甚至认为它是最高的。程序员甚至可以称它为第零板。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-14T16:29:26.107

对于堆栈为什么会变小的问题，我想它是用来节省内存的。

如果您从堆栈内存的顶部（最高值地址）开始并工作到零，我认为检查您是否已到达地址`$0x00000000`比分配一个变量来为您提供堆栈的最大高度并检查是否更容易不是你已经到达那个地址。

我认为这可以更容易地检查您是否到达可寻址空间的末尾，因为无论有多少可用内存，堆栈的限制总是`$0x00000000`.

# iis - 在 buildserver 上针对基于 iis 的 Web 项目运行 StyleCop

> ID：420319
> 
> 赞同：0
> 
> 时间：2009-01-07T13:36:42.053
> 
> 标签：iis, stylecop

如何在构建服务器上针对基于 iis 的 web 项目运行 stylecop？Buildserver 在持续集成中运行，我希望它自动化。

有了一个库，我可以在 .csproj 中添加几行并完成。我相信它是一个网站应用项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T14:15:17.547

它是 Web 应用程序项目还是 Visual Studio 中的网站？使用前一个选项，它被编译成一个程序集，因此您可以在构建程序集时始终从构建脚本运行 StyleCop。

或者，您可以在 VisualStudio 中将 StyleCop 作为插件运行，但您可能在这里要求自动化。我认为这完全取决于您的构建过程。有多种构建配置，因此请详细说明您在此构建服务器上实际执行的操作。持续集成？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T15:04:55.957

项目类型不可能，项目需要转换。

# c# - validateImageData 参数和 Image.FromStream()

> ID：420337
> 
> 赞同：14
> 
> 时间：2009-01-07T13:40:55.010
> 
> 标签：c#, .net, image-processing

我担心这个重载中的第三个参数 validateImageData。该文档没有对此进行太多解释，它仅说明它会导致图像数据被验证但没有详细信息，究竟做了什么来验证图像数据？

```
public static Image FromStream (
    Stream stream,
    bool useEmbeddedColorManagement,
    bool validateImageData
) 
```

我想在 Web 应用程序中使用它，所以，我想知道如果我将 validateImageData 设置为 true 会发生什么，我想确定用户上传的是有效图像，是否建议将 validateImageData 设置为 true或者如果抛出异常是否足以捕获异常？此外，将 validateImageData 设置为 true 是否会以任何方式影响性能？（用户可以上传最大 250k 大小的图像）

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T14:27:11.813

从反射器中，我们看到：

```
if (validateImageData)
{
    num = SafeNativeMethods.Gdip.GdipImageForceValidation(new HandleRef(null, zero));
    if (num != 0)
    {
        SafeNativeMethods.Gdip.GdipDisposeImage(new HandleRef(null, zero));
        throw SafeNativeMethods.Gdip.StatusException(num);
    }
} 
```

所以我们看到调用了[GdipImageForceValidation](http://msdn.microsoft.com/en-us/library/ms534041(VS.85).aspx)（回想一下，System.Drawing 只是 GDI+ 的一个包装器）。这个函数的文档不是很好：

> 此功能强制验证图像。

不是很有用。但是，重点是 - 询问图像文件以确保可以安全加载。这可能会导致整个图像被加载到内存中。

如果您接受用户的输入，我当然会将此标志设置为 true - 您永远不知道用户将上传哪种文件（格式错误或其他）。安全总比后悔好。这就是为什么默认是`true`.

另请注意，**不**建议将 GDI+ 用于服务器环境。你最好使用`System.Windows.Media.Imaging`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T14:31:57.950

通过仔细阅读反射器内部，您会看到默认情况下，.NET 总是调用 GDI+ 库中名为 GdipImageForceValidation 的本机 API（通过为 validateImageData 参数传递 true）。我在 MSDN 中找不到太多关于本机[API 的](http://social.msdn.microsoft.com/Search/en-US/?query=GdipImageForceValidation&ac=8)信息，只有[this](http://msdn.microsoft.com/en-us/library/ms534041.aspx)，它告诉我们的只是函数本身的名称。但是，根据[Justin Roger](http://weblogs.asp.net/justin_rogers/archive/2004/03/31/105296.aspx)关于通过 .NET 以最快的方式加载图像的帖子，这种方法似乎会导致性能下降。期望任何“验证”步骤都会影响性能也是直观的。

但是，如果您为 validateImageData 参数指定 false，.NET 将显式触发[非托管代码安全](http://msdn.microsoft.com/en-us/library/system.security.permissions.securitypermissionflag.aspx) [需求](http://msdn.microsoft.com/en-us/library/system.security.codeaccesspermission.demand.aspx)，这意味着框架作者认为强制图像验证是必要的，以保证托管代码是安全的，并最终能够相信调用者*所说*的代表图像的数据。因此，虽然为 validateImageData 指定 flase 可能会提高性能，但在不[完全信任的](http://blogs.msdn.com/eugene_bobukh/archive/2005/05/06/415217.aspx)安全上下文中，它可能会产生异常，并且您最好相信您认为是图像的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T13:56:13.513

我记得读过该参数的一些问题。看到[这篇](http://blogs.msdn.com/omars/archive/2004/03/29/100941.aspx)文章（它很老但只是要小心）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T13:51:16.330

为什么不尝试看看设置该标志而不设置该标志会发生什么？

无论哪种情况，您都应该处理任何可能引发的异常。

# testing - 单独的“调试”和“发布”构建？

> ID：420343
> 
> 赞同：47
> 
> 时间：2009-01-07T13:42:03.353
> 
> 标签：testing, debugging, release, release-management

我认为最好发布您的开发人员实际测试过的软件版本；因此，我倾向于从项目/makefile 中删除“调试”目标，以便只有一个版本可以构建（并测试、调试和发布）。

出于类似的原因，我不使用“断言”（另请参阅[断言总是不好的吗？](https://stackoverflow.com/questions/419406/are-assertions-always-bad#419410) ...）。

那里的一个人争辩说，“调试”版本的原因是它更容易调试：但是，我反驳说，您最终可能希望支持和​​调试您发布的任何内容，因此您需要构建一个发布您可以在必要时进行调试……这可能意味着启用调试符号并禁用某些优化，即使在“发布”版本中也是如此。

有人说“这是个坏主意”；这是我几年前制定的一项政策，被以下因素烧毁：

*   一些开发人员正在测试他们的调试版本而不是发布版本
*   一些开发人员的编写错误，仅在发布版本中出现
*   该公司在测试不充分后发布了发布版本（它**是否**完全足够？）
*   被要求调试发布版本

从那时起，我看到不止一个其他开发商店遵循这种做法（即没有单独的调试和发布版本）。

你的政策是什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-07T13:48:52.403

拥有单独的调试和发布版本是一个好主意，因为它确实使开发更容易。

但是调试版本应该只用于开发，而不是用于测试。您仅测试发布版本。而且您不使用开发人员来测试这些构建，而是使用测试人员。

这是一个简单的政策，可以两全其美，IMO。

**编辑：**作为对评论的回应，我认为很明显调试和发布版本（可以）生成不同的代码。想想“-DDEBUG”与“-DNDEBUG”，以及“#if defined(DEBUG)”等。

因此，测试最终交付的代码至关重要。如果您*确实*在调试和发布版本中生成了不同的代码，这意味着要测试两次——不管它是否由同一个人测试。

然而，调试符号并不是什么大问题。始终使用调试符号构建，保留未剥离的二进制文件的副本，但发布剥离的二进制文件。只要您以某种方式用内部版本号标记每个二进制文件，您就应该始终能够识别哪个未剥离的二进制文件对应于您必须调试的剥离的二进制文件......

如何在调试器中从外部源中剥离二进制文件和加载符号取决于平台。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-07T13:54:34.950

这可能是次要的，但它补充了其他人在这里所说的内容。拥有 QA 测试发布版本的优点之一是，随着时间的推移，由于开发人员需要找出 QA 中出现问题的原因，软件的内置调试和日志记录功能将得到提升。

开发人员需要调试发布构建的越多，当客户开始遇到问题时，您将拥有更好的工具。当然，开发人员没有理由将发布版本作为开发周期的一部分。

此外，我不知道有哪家软件公司有足够长的周期来承担在版本测试期间将 QA 从调试版本切换到发布版本的开销。必须进行完整的 QA 周期是经常发生的事情，而且很少发生。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-07T13:47:56.820

我们的政策是让开发人员在调试版本上工作，但其他所有人（QA、BA、销售等）都运行发布版本。昨天我不得不修复一个只出现在发布版本中的错误，很明显发生了什么，因为它只出现在发布版本中

这是这家商店的第一个，我在这里已经 18 个月左右了。

当发布版本与调试版本做不同的事情时，事情变得棘手 - 是的，我去过地狱，在一些非常古老、非常粗糙的生产代码中看到了这一点。

如果配置之间的唯一区别是调试符号和优化，我认为没有理由不同时拥有两者。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-07T14:46:54.363

> 所以你需要构建一个版本，如果有必要可以调试......这可能意味着启用调试符号，并禁用一些优化，即使在“发布”版本中也是如此。

嗯...听起来您正在对我进行调试构建...对吗？

您出错的部分是以下语句：

> 我认为最好发布您的开发人员实际测试过的软件版本

***开发人员不测试代码。测试测试代码。***

您的单元测试应该测试**所有**构建配置。不要让您的开发人员将一只手绑在背后工作 - 让他们使用他们可以使用的所有调试工具。调试版本就是其中之一。

关于断言：断言的使用很大程度上取决于您是否按合同进行编程。如果你这样做了，那么断言只是在调试构建中检查合同。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-07T13:54:05.357

根据我在链接线程中的回答，出于非常相似的原因，我们也使用相同的构建进行调试和发布。与算法级别的手动优化相比，优化器带来的 10%-20% 的性能提升往往非常小。单个构建消除了许多潜在的错误。具体来说;

*   未初始化的变量和小的缓冲区溢出可能最终在调试和优化发布版本中产生非常不同的结果。

*   即使有可用的符号信息，调试优化的版本也可能很困难，因为对象与源不匹配，例如变量可能已被优化并且代码可能已被重新安排。因此，在经过测试的发布版本中报告的错误可能更难以追踪，因此更耗时。

在自动回归测试下比较了未优化和优化的构建，优化提供的性能提升并没有提供足够的额外价值来拥有两个构建。值得注意的是，我开发的软件非常消耗 CPU（例如创建和操作大型表面模型）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-07T14:22:58.857

使用 Java 开发时，我讨厌非调试版本。当抛出异常时，您不会获得任何行信息，这使得很难甚至不可能跟踪错误。此外，使用 Java 5 或更高版本，调试和非调试之间的运行时差异约为 5%，所以这真的没有问题，对于今天的硬盘，大小不再重要。

从好的方面来说，使用调试版本：

*   堆栈跟踪包含您需要的所有信息
*   可以检查变量
*   如果您在生产中遇到问题，您可以简单地附加到正在运行的进程，而无需先停止服务器来安装调试版本。
*   你不会被聪明的优化错误抓住
*   构建更简单（只有一个工件）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-07T14:56:17.230

开发人员使用调试版本，QA 和其他人使用发布版本，我们称之为“生产”。这样做的主要优点是在调试构建中，我们可以添加大量额外的代码和断言。一些对象包含额外的信息，除了在调试器中查看代码时没有用。有些对象会定期验证自己，以确保所有状态信息都是一致的。这些东西使调试版本慢得多，但它们帮助我们找到了在生产构建中很难找到的错误。

正如我所说，我们所有的 QA 和性能测试都使用生产版本，我们偶尔会遇到在生产中出现但在调试中没有出现的问题。但它们相对较少，作为开发人员，调试调试版本而不是生产版本的优势远远超过了这个问题。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-07T13:48:07.163

我认为这取决于项目规模以及您使用的构建系统和测试类型。

如果您有一个自动构建系统，并且在给定构建上运行单元和功能测试很简单，那么您应该永远不会遇到多种构建类型的任何问题。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-07T13:55:47.180

由于您在问题中列出的所有原因，我一直订阅“交付您调试的内容，以便您可以调试您发布的内容”方法。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-12T18:49:02.960

在我看来，这个讨论缺少一个非常重要的观点：

这真的取决于它是什么样的项目！

如果您创建本机 (C/C++) 项目，您实际上将被迫创建调试版本，这仅仅是因为编译器优化在某些情况下会使调试几乎不可能。

如果您创建 Web 应用程序，您可能希望简单地构建一个可以在运行时启用日志记录功能的构建（尽管“构建”对于某些 Web 应用程序具有误导性）。

虽然原生 C++ 项目和 PHP Web 应用程序显然不是所有类型的项目，但我希望我的观点得到了理解。

PS：在为 C# 开发时，您会遇到边界情况，因为尽管使用调试版本会禁用编译器优化，但根据我的经验，您不会遇到与 C++ 几乎一样多的差异

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-07T13:48:18.847

在这里，我们以调试模式开发并在发布模式下进行所有单元测试。我们是一家只有几个（12 岁以下）应用程序的小商店，支持从 Classic ASP、ASP.Net、VB.Net 和 C# 等各种应用程序。我们也有专人处理所有的测试，调试的问题会反馈给开发人员。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-07T13:50:00.997

我们总是同时构建两者，甚至从未考虑过不这样做。启用调试选项会增加您的代码大小并降低性能，在测试时可能不是您的软件类型的问题，但如果客户正在运行您的代码和 5 个其他应用程序怎么办......

测试问题可以通过使用自动化测试来解决，因此当您认为您已准备好发布时，可以轻松地测试您的发布版本。您的开发人员或公司未能正确测试发布版本并不是发布和调试版本理念的失败，而是您的开发人员和/或公司的失败。

关于你的最后一点，我从来没有被要求调试发布版本，只是为了修复它......

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-07T13:50:51.417

这是一个权衡。鉴于 CPU 周期很便宜并且越来越便宜，而人工周期仍然很昂贵，因此只维护大型复杂程序的单个版本——调试（山墙）版本是很有意义的。

总是使用断言总是比从不使用它们更安全的策略。如果生成单独的调试和发布版本，请重新启用`#define`您需要的任何 d 符号，以确保在发布版本中也启用了断言。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-07T16:07:33.247

我认为权衡很简单：是的，只有发布版本，您才能真正测试实际发布的内容。另一方面，您确实为开发人员的调试方便和/或用户的性能付出了代价，因此您需要检查这两种情况。

在大多数大中型项目中，易于调试**将**确保最终为您的用户提供更好的产品。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-07T16:19:31.850

看到这个[你最有争议的编程观点是什么？](https://stackoverflow.com/questions/406760/whats-your-most-controversial-programming-opinion#406945)

引用：

> 意见：“调试”和“发布”版本之间永远不会有不同的代码
> 
> 主要原因是发布代码几乎从未经过测试。最好在测试中运行与在野外运行相同的代码。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-11-29T03:28:07.737

通过删除“调试目标”，您将迫使开发人员在软件的发布版本上进行调试。这在实践中可能意味着两件事：

1）“发布版本”将禁用优化（否则开发人员不能使用调试器）

2) 任何构建都不会有特殊的 PREPROCESSOR 宏来改变它们的执行。

所以你真正要做的是合并发布和调试配置，而不是仅仅消除“调试”模式。

我个人在 iOS 开发中做到了这一点，没有任何不良影响。我们编写代码所花费的时间不到实际情况的 1%，因此优化并不是重要的贡献者。在这种情况下，它们确实似乎确实导致了错误的增加，但即使没有，用一种方法进行测试，然后用不同的代码提供给 QA 的想法只是引入了一个要考虑问题的因素。

另一方面，在某些情况下，优化是必要的，它们是有用的，甚至有足够的时间来测试两者。通常，调试和发布之间的变化非常小，根本不会给任何人带来任何问题。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-07T13:47:34.030

如果你有一个真正的 QA 团队可以完全测试这个东西，我会说在你接近发布之前进行调试构建，然后确保在同一个构建上完成一个完整的 QA 周期。出门。

尽管至少在一种情况下，我们发布了一些仍然包含一些调试代码的东西。唯一的后果是它的运行速度有点慢，而且日志文件非常大。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-01-07T13:48:59.533

在我的公司，我们既有 Debug 又有 Release。- 开发人员使用调试版本正确查找和修复错误。- 我们正在使用 TDD，因此我们有一个在我们的服务器上运行的大型测试套件，用于测试调试和发布构建配置以及我们拥有的 64/32 构建。

因此，如果使用“调试”配置可以帮助开发人员更快地找到错误，那么没有理由不使用它——当代码进入服务器（待进一步测试）或审查时，我们使用“发布”配置。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-01-07T13:51:42.133

我很久以前就学会了使用 .PDB 文件构建发布版本，以便我可以调试发布版本。许多程序员往往忘记的是，当您运行调试版本时，关闭所有优化，您完全在调试一个不同的程序。它可能表现得像发布版本（大部分情况下），但它仍然是与发布版本不同的程序。

此外，调试发布版本并不难。如果你得到一个崩溃转储，你无论如何都必须能够做到。

# c++ - C ++ ctor问题（linux）

> ID：420350
> 
> 赞同：1
> 
> 时间：2009-01-07T13:47:31.877
> 
> 标签：c++, linux, constructor, elf, segmentation-fault

*   环境：linux，通过g++从几个C++文件创建的用户空间应用程序（结果是一个ELF）

*   遍历构造函数列表时出现问题（SIGSEGV）

```
    ( __CTOR_LIST__ )

```

（注意：通过此列表调用的代码是每个类的一种系统初始化， *而不是*我编写的构造函数代码）

*   当我正确理解每个编译单元（从 .cpp 创建的每个 .o）都会在

```
    __CTOR_LIST__ 

```

*   当我通过程序通过 GDB 时，问题（SIGSEGV）不存在

*   为了调试这个我正在寻找一种在调用**之前添加自己的代码代码的方法**

```
    “_do_global_ctors_aux”

```

有什么提示吗？

谢谢，

乌韦

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T14:07:31.400

这有很多可能的原因。您访问尚未创建的对象的范围（因为未定义跨不同翻译单元创建对象的顺序）我认为在这种情况下很可能，并且范围为您的构建环境中的错误。

要使自己的函数在其他构造函数之前被调用，您需要在[此处](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#index-pointer-arguments-2151)`constructor (priority)`描述一个属性。GCC 为每个文件的构造函数输入部分保留优先级。它按照这些优先级的顺序将它们联系起来。在我的 linux 系统的链接器脚本中，该代码如下所示（使用 输出）：`ld -verbose`

```
 .ctors          :
  {
    /* gcc uses crtbegin.o to find the start of
       the constructors, so we make sure it is
       first.  Because this is a wildcard, it
       doesn't matter if the user does not
       actually link against crtbegin.o; the
       linker won't look for a file to match a
       wildcard.  The wildcard also means that it
       doesn't matter which directory crtbegin.o
       is in.  */
    KEEP (*crtbegin.o(.ctors))
    KEEP (*crtbegin?.o(.ctors))
    /* We don't want to include the .ctor section from
       the crtend.o file until after the sorted ctors.
       The .ctor section from the crtend file contains the
       end of ctors marker and it must be last */
    KEEP (*(EXCLUDE_FILE (*crtend.o *crtend?.o ) .ctors))
    KEEP (*(SORT(.ctors.*)))
    KEEP (*(.ctors))
  } 
```

您可能希望给它一个低优先级以使其在具有更高优先级编号的其他已注册 ctor 函数之前执行。但是从外观上看，似乎没有编号的构造函数将首先执行。完全不确定。最好你试一试。如果你想在 _do_global_ctors_aux 之前调用你的函数，你必须释放`_init`当你的程序被 ELF 加载器加载时通常执行的原始函数（查看`-init`ld 的选项）。我已经有一段时间没有搞砸它了，但我记得它必须做一些初始化的私密细节，所以我不会尝试替换它。尝试使用我链接到的构造函数属性。但是，要非常小心。您的代码可能会在`cout`构造其他重要对象之前执行。

**更新**：我做了一个测试，它实际上是反向执行 ctor 函数。因此，首先链接的 ctor 函数稍后执行。这段代码恰好在 gcc 源代码的 crtstuff.c 中：

```
 func_ptr *p;
  for (p = __CTOR_END__ - 1; *p != (func_ptr) -1; p--)
    (*p) (); 
```

我做了一个小测试：

```
void dothat() { }
struct f {
    f() { dothat(); }
} f_;
void doit() __attribute__((constructor (0)));
void doit() { }
int main() { } 
```

与`--print-map`产量等相关的输出是：

```
.ctors          0x080494f4       0x10
 *crtbegin.o(.ctors)                 
 .ctors         0x080494f4        0x4 /usr/lib/gcc/i686-pc-linux-gnu/4.3.2/crtbegin.o
 *crtbegin?.o(.ctors)                                                                
 *(EXCLUDE_FILE(*crtend?.o *crtend.o) .ctors)                                        
 .ctors         0x080494f8        0x4 /tmp/ccyzWBjs.o                                
 *(SORT(.ctors.*))                                                                   
 .ctors.65535   0x080494fc        0x4 /tmp/ccyzWBjs.o                                
 *(.ctors)                                                                           
 .ctors         0x08049500        0x4 /usr/lib/gcc/i686-pc-linux-gnu/4.3.2/crtend.o 
```

注意`.ctors.65535`我们的属性 priority 是如何隐式创建的部分`0`。现在，如果您给予它优先级，gcc 会发出警告，这是完全正确的：p

> test.cpp:7：警告：从 0 到 100 的构造函数优先级保留用于实现

我通过中断`doit`and对其进行了测试`dothat`，它以我们期望的顺序调用它们。玩得开心！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T14:01:43.063

有可能你被所谓的“静态初始化命令惨败”给咬了。

基本上，当有多个翻译单元（即 C++ 源文件），并且每个文件定义一个全局对象时，C++ 编译器/链接器无法确定首先构造哪个。如果`x`依赖于`y`先构造，但偶然编译/链接导致`x`先构造`y`，程序通常会崩溃。[有关详细信息，请参阅C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/ctors.html)的第 [10.12] 项。条目 [10.13] 包含一个解决方案——“首次使用时构造”成语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T17:15:14.857

不是你问的问题，而是...

在 C++/g++ 中，您可以拥有一个类，其中声明的 [header] 方法永远不会在源 [.cc] 文件中实际定义，只要这些方法从未被调用。

因此，您可以将当前代码文件复制到一个临时目录，对它们进行 hack 和 slash 工作，运行 [手动] 二进制搜索，并相当快地隔离问题。

不优雅，但非常有效。

* * *

除了臭名昭著的*“静态初始化顺序”*问题之外，还有更多深奥的案例，例如[*Charles Bailey*](https://stackoverflow.com/questions/406010/passing-pointer-to-an-array-of-arrays-through-function#406032)[最近在SO上向我指出的案例（见评论）。](https://stackoverflow.com/questions/406010/passing-pointer-to-an-array-of-arrays-through-function#406032)

 *```
 E.g Mixing:  int p [] = { 1,2,3 };
          And:  extern int * p; 
```

会产生类似的 coredump 问题。

# ruby-on-rails - 如何使用activerecord获取最后N条记录？

> ID：420352
> 
> 赞同：181
> 
> 时间：2009-01-07T13:47:54.060
> 
> 标签：ruby-on-rails, ruby, activerecord

在`:limit`查询中，我将获得前 N 条记录。获取最后 N 条记录的最简单方法是什么？

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2012-01-27T08:37:42.703

这是 Rails 3 方式

```
SomeModel.last(5) # last 5 records in ascending order

SomeModel.last(5).reverse # last 5 records in descending order 
```

* * *

## 回答 #2

> 赞同：170
> 
> 时间：2009-01-07T14:07:43.490

## 更新答案 (2020)

您只需使用[last](https://apidock.com/rails/ActiveRecord/FinderMethods/last)方法即可获取最后 N 条记录：

`Record.last(N)`

例子：

`User.last(5)`

按 id 降序返回 5 个用户。

## 已弃用（旧答案）

我认为像这样的活动记录查询会让你得到你想要的（'Something'是模型名称）：

```
Something.find(:all, :order => "id desc", :limit => 5).reverse 
```

**编辑**：如评论中所述，另一种方式：

```
result = Something.find(:all, :order => "id desc", :limit => 5)

while !result.empty?
        puts result.pop
end 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2011-12-16T05:52:29.947

在 rails 3.1 中执行此操作的新方法是`SomeModel.limit(5).order('id desc')`

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2017-07-26T18:28:24.450

# 对于 Rails 5（可能还有 Rails 4）

### 坏的：

```
Something.last(5) 
```

因为：

```
Something.last(5).class
=> Array 
```

所以：

```
Something.last(50000).count 
```

可能会炸毁你的记忆或永远消失。

### 好方法：

```
Something.limit(5).order('id desc') 
```

因为：

```
Something.limit(5).order('id desc').class
=> Image::ActiveRecord_Relation

Something.limit(5).order('id desc').to_sql
=> "SELECT  \"somethings\".* FROM \"somethings\" ORDER BY id desc LIMIT 5" 
```

后者是一个未评估的范围。你可以链接它，或者通过`.to_a`. 所以：

```
Something.limit(50000).order('id desc').count 
```

......需要一秒钟。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2014-07-09T08:45:24.630

对于**Rails 4 及以上版本：**

你可以尝试这样的事情如果你想要**第一个最旧的条目**

```
YourModel.order(id: :asc).limit(5).each do |d| 
```

* * *

如果你想要**最后的最新条目**，你可以尝试这样的事情..

```
YourModel.order(id: :desc).limit(5).each do |d| 
```

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2010-09-08T16:24:11.413

解决方案在这里：

```
SomeModel.last(5).reverse 
```

由于 rails 是惰性的，它最终会使用 SQL 访问数据库，例如：“SELECT `table`.* FROM `table` ORDER BY `table`. `id`DESC LIMIT 5”。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-02-14T08:40:27.450

如果您需要对结果设置一些排序，请使用：

```
Model.order('name desc').limit(n) # n= number 
```

如果您不需要任何排序，并且只需要保存在表中的记录，则使用：

```
Model.last(n) # n= any number 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-05-04T15:54:59.747

你试一试：

```
Model.order("field_for_sort desc").limit(5) 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-07-10T13:46:20.803

在我的 Rails`(rails 4.2)`项目中，我使用

```
Model.last(10) # get the last 10 record order by id 
```

它有效。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-11-05T07:11:49.103

我们可以在 rails 5.2中使用`Model.last(5)`or`Model.limit(5).order(id: :desc)`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-01-21T19:29:57.320

我发现这个查询对于使用我喜欢的“pluck”方法来说更好/更快：

```
Challenge.limit(5).order('id desc') 
```

这给出了一个 ActiveRecord 作为输出；所以你可以像这样使用 .pluck ：

```
Challenge.limit(5).order('id desc').pluck(:id) 
```

在使用最佳 SQL 代码的同时快速将 id 作为数组提供。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-08-22T00:22:00.567

假设 N = 5 并且您的模型是`Message`，您可以执行以下操作：

```
Message.order(id: :asc).from(Message.all.order(id: :desc).limit(5), :messages) 
```

看一下sql：

```
SELECT "messages".* FROM (
  SELECT  "messages".* FROM "messages"  ORDER BY "messages"."created_at" DESC LIMIT 5
) messages  ORDER BY "messages"."created_at" ASC 
```

关键是子选择。首先，我们需要定义我们想要的最后一条消息是什么，然后我们必须按升序对它们进行排序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-12-18T17:06:07.873

如果您的模型中有一个默认范围指定 Rails 3 中的升序，您将需要使用 reorder 而不是上面 Arthur Neves 指定的 order：

```
Something.limit(5).reorder('id desc') 
```

或者

```
Something.reorder('id desc').limit(5) 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-10T09:48:12.953

一个简单的答案是：

```
Model.limit(5).order(id: :desc) 
```

这个解决方案有一个问题，因为`id`它不能成为当时创建记录的唯一决定因素。

更可靠的解决方案是：

```
Model.order(created_at: :desc).limit(5) 
```

正如其他人指出的那样，也可以使用`Model.last(5)`. 唯一的问题是它返回`Array`，而不是`Model::ActiveRecord_Relation`。

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2009-01-07T13:52:31.960

在查询中添加 :order 参数

# xaml - XmlDataProvider Source="pack://application:,,,/FinanceExplorer/Equity.xml"

> ID：420362
> 
> 赞同：1
> 
> 时间：2009-01-07T13:50:20.887
> 
> 标签：xaml

有人可以在这里解释源属性中的语法吗？“pack：”和“application：”到底是什么，为什么是 3 个逗号？我找不到任何体面的描述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T13:53:43.550

[这是关于Pack URI Scheme](http://msdn.microsoft.com/en-us/library/aa970069.aspx)的 MS 文档

三个逗号表示位于本地程序集项目文件夹根目录中的 XAML 资源文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-16T04:50:08.030

packageURI实际上是URI中的URI，因此通过将其正斜杠转换为逗号进行编码。

因此，三重逗号实际上是编码的正斜杠。

你也可以更换类似的东西

```
pack://application:,,,/logo.jpg 
```

有了这个

```
/logo.jpg 
```

运行时将前缀 pack://application:,,,。

# url - 为什么有些 URL 同时包含数字 id 和名称？

> ID：420380
> 
> 赞同：4
> 
> 时间：2009-01-07T13:55:27.883
> 
> 标签：url, seo

我想知道为什么指向个人资料的链接看起来像：

```
http://stackoverflow.com/users/ID/NAME 
```

不仅仅是：

```
http://stackoverflow.com/users/ID 
```

甚至更好：

```
http://stackoverflow.com/users/NAME 
```

可以有几个同名的用户吗？或者一个用户可以有多个名字？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-07T14:09:15.903

所有 SO-URL 的形式都是 id/description，其中 ID 是唯一的，并且描述是可选的。So[`/users/12890/arne-burmeister`](https://stackoverflow.com/users/12890/arne.burmeister)与 相同，[`/users/12890/huhu`](https://stackoverflow.com/users/12890/huhu)与[`/questions/420380/why-does-the-link-to-the-user-profile-have-both-id-and-name`](https://stackoverflow.com/questions/420380/why-does-the-link-to-the-user-profile-have-both-id-and-name)相同[`/questions/420380/foo`](https://stackoverflow.com/questions/420380/foo)。检索只使用 ID，但它对于 google 排名要好得多，当用户/问题/what-ever-should-be-found 出现在 URL 中时（对于人类来说，这更具描述性 ;-)。

顺便说一句，通过 ID 检索比通过这么大的文本字符串检索要快。当然，如果有人更改了他们的用户名或问题，该 URL 仍然有效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T13:59:21.087

最后一个斜线之后的部分似乎与 SEO 相关（即使 url 更具表现力）。
在我测试的网址上，您可以用您想要的任何内容替换该部分，它仍然有效。所以网址`http://stackoverflow.com/users/37086/othername`仍然指向您的个人资料。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T13:59:17.407

我假设仅对名称字符串进行数据库查找会比对主键进行数字查找更昂贵，即使名称列已被索引。然后添加名称以使 URL 对用户和 SEO 更友好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T13:59:21.073

对此有用户[语音请求](https://web.archive.org/web/20110225223053/http://stackoverflow.uservoice.com:80/pages/general/suggestions/28927-user-page-urls)。如果您希望这种情况发生，uservoice 是讨论/投票的正确场所。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T14:10:37.307

你在 SO 上的名字不是唯一的，点击用户并输入 Josh，我们有一整页。所以必须要有身份证。至于为什么别人猜的名字和我的一样好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T13:59:21.087

尝试更改或删除名称，看看会发生什么。

我认为这只是为了让您的 URL 告诉您预期的内容，但应用程序不需要（或实际使用）该信息。

如果我没记错的话，亚马逊对他们的书做了一些非常相似的事情：他们在 URL 中有 ASIN（他们的内部 ID）和书名，但只查找 ASIN。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T13:59:40.447

只是推测：ID 允许非常快速地检索配置文件页面显示的数据。这个名字只适用于人类，被忽略了，因为我更容易拒绝你是 rkj 而我是 phihag，而不是你的 ID 是 37086 而我的 ID 是 35070。

# ruby-on-rails - 收集 Rails 应用程序使用统计信息的最佳方法

> ID：420382
> 
> 赞同：6
> 
> 时间：2009-01-07T13:56:12.717
> 
> 标签：ruby-on-rails, ruby, statistics

我有一个 Rails 应用程序，用户可以在其中设置他们的域并将内容发布到它们上。我需要收集公共流量统计信息，例如浏览量等。这个功能的一个很好的例子是我可以作为客户看到的 flickr 使用统计信息。

问题是收集使用信息的最佳方式是什么。应该通过解析日志文件来完成，还是应该在运行时收集并存储在数据库中？是否有任何工具或 Rails 插件已经提供了这个？

这个解决方案应该可以很好地扩展，即使每月有数千个域和数百万次浏览量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T15:55:59.433

谷歌分析可能是你最好的选择......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-08T07:26:33.003

这完全取决于您要记录的内容。

我已经开始在 beta 生产系统中使用[http://github.com/smtlaissezfaire/enhanced_query_analyzer/tree/master来记录查询。](http://github.com/smtlaissezfaire/enhanced_query_analyzer/tree/master)您当然可以在 application.rb 中使用前置过滤器执行类似于日志页面查看的操作

如果您*需要*或*想要*使用数据库，不想与 google 共享您的信息，并且正在使用 mysql，我建议您查看存档存储引擎

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T16:27:01.710

请与您的主人确认。其中一些默认提供 Urchin 统计信息。

除此之外，大多数人使用谷歌分析。如果您需要极细粒度的信息，您可以尝试使用类似[这样](http://rails-analyzer.rubyforge.org/ "轨道分析器")的工具对您的 production.log 进行一些后期处理。如果您在调度程序（如 cron ）上进行后处理，那么您不必担心性能或扩展太多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T16:01:16.723

最简单的解决方案可能只是购买[Mint](http://haveamint.com/)或使用 Google Analytics。

# c# - 如何从绑定到 List 的绑定源中获取正确的映射名称 ，或匿名类型，在 DataGridTableStyle 上使用？

> ID：420386
> 
> 赞同：15
> 
> 时间：2009-01-07T13:58:27.110
> 
> 标签：c#, datagrid, compact-framework, bindingsource, datagridtablestyle

我正在尝试创建一个 DataGridTableStyle 对象，以便我可以控制 DataGrid 的列宽。我创建了一个绑定到列表的 BindingSource 对象。实际上，它绑定到通过 Linq 以下列方式创建的匿名类型列表（为了清楚我在做什么而更改了变量名称）：

```
List<myType> myList = new List<myType>(someCapacity);
.
...populate the list with query from database...
.

var query = from i in myList
            select new
            {
                i.FieldA,
                i.FieldB,
                i.FieldC
            };

myBindingSource.DataSource = query;
myDataGrid.DataSource = myBindingSource; 
```

然后我创建一个 DataGridTableStyle 对象并将其添加到数据网格中。但是，它永远不会应用我设置的表格样式属性，因为我似乎无法设置正确的 myDataGridTableStyle.MappingName 属性。

我已经在 Google 上搜索了大约 1/2 小时，并且在一堆不同的论坛中不断看到指向同一个问题的链接（字面意思是相同的文本，就像有人刚刚复制并粘贴了这个问题......我讨厌那个......） . 无论如何，这些建议都不起作用，就像那个人在所有其他网站上所说的那样。

那么这里有人知道我需要将 MappingName 属性设置为什么才能让我的 TableStyle 真正正常工作吗？我可以从哪里获取名字？（它不能为空...仅适用于绑定到 DataTable 或 SqlCeResultSet 等的 BindingSource）。

我认为这可能是我使用 Linq 创建匿名、更专业版本的对象的问题，其中仅包含我需要的字段。我应该尝试将 BindingSource 直接绑定到 List 对象吗？或者甚至可能将 DataGrid 直接绑定到 List 对象并完全跳过绑定源。

谢谢

PS - C#，紧凑框架 v3.5

更新：

我在下面发布了一个答案，解决了我的问题。不管这是否是最好的方法，它确实奏效了。如果您遇到与我相同的问题，值得一看。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-07T16:42:09.013

我已经找到了使这项工作的方法。我会把它分成几部分...

* * *

```
List<myType> myList = new List<myType>(someCapacity);
.
...populate the list with query from database...
. 
```

* * *

```
DataGridTableStyle myDataGridTableStyle = new DatGridtTableStyle();
DataGridTextBoxColumn colA = new DataGridTextBoxColumn();
DataGridTextBoxColumn colB = new DataGridTextBoxColumn();
DataGridTextBoxColumn colC = new DataGridTextBoxColumn();

colA.MappingName = "FieldA";
colA.HeaderText = "Field A";
colA.Width = 50; // or whatever;

colB.MappingName = "FieldB";
.
... etc. (lather, rinse, repeat for each column I want)
.

myDataGridTableStyle.GridColumnStyles.Add(colA);
myDataGridTableStyle.GridColumnStyles.Add(colB);
myDataGridTableStyle.GridColumnStyles.Add(colC); 
```

* * *

```
var query = from i in myList
            select new
            {
                i.FieldA,
                i.FieldB,
                i.FieldC
            };

myBindingSource.DataSource = query.ToList(); // Thanks Marc Gravell

// wasn't sure what else to pass in here, but null worked.
myDataGridTableStyle.MappingName = myBindingSource.GetListName(null); 

myDataGrid.TableStyles.Clear(); // Recommended on MSDN in the code examples.
myDataGrid.TablesStyles.Add(myDataGridTableStyle);
myDataGrid.DataSource = myBindingSource; 
```

* * *

所以基本上，DataGridTableStyle.MappingName 需要知道它映射到什么类型的对象。由于我的对象是匿名类型（使用 Linq 创建），所以直到运行时我才知道它是什么。在我将匿名类型的列表绑定到绑定源之后，**我可以使用 BindingSource.GetListName(null) 来获取匿名类型的字符串表示。**

需要注意的一件事。如果我只是将 myList（类型为“myType”）直接绑定到绑定源，则可以使用字符串“myType”作为 DataGridTableStyle.MappingName 的值。

希望这对其他人有用！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-08-25T21:01:14.480

只是为了添加到此页面上已有的答案集合中......

我只是对试图使用 Windows 窗体和紧凑框架（对于 Windows Mobile 6.5）开发我的第一个应用程序的同样问题感到沮丧。

通过上面 Marc Gravell 的评论，我发现确实可以让运行时 MappingName 检查 DataGrid 的属性。这样做我发现当我`List<MyType>`直接绑定到 DataGrid 的 DataSource 属性时，DataGrid 实际上是在寻找一个 MappingName 为的 DataGridTableStyle

```
"List`1" 
```

`List<MyType>`而不是或`MyType`...的任何组合

所以...通过将“List`1”放在 DataGridTableStyle 集合编辑器的映射名称中（在设计时），我能够自定义列和其他属性，而无需在运行时创建它们。

我只是希望这会为已经提供的答案增加更多内容。感谢大家为我提供指导方针。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T14:03:44.683

查询返回`IEnumerable<T>`一些`T`，但大多数绑定源（ASP.NET 除外）需要`IList`（例如任何`IList<T>`实现） - 尝试添加`.ToList()`- 即

```
myBindingSource.DataSource = query.ToList(); 
```

A`BindingList<T>`可能工作得更好（如果它在 CF 3.5 中受支持），因为它对一些常见的绑定场景有更好的支持；如果你需要这个（并且假设`BindingList<T>`存在于 CF 3.5 上），你可以添加一个扩展方法：

```
static BindingList<T> ToBindingList<T>(this IEnumerable<T> data)
{
    return new BindingList<T>(new List<T>(data));
} 
```

然后调用：

```
myBindingSource.DataSource = query.ToBindingList(); 
```

`IList`为了完整起见， is的替代方案`IListSource`（甚至`Type`对于纯元数据场景），这就是为什么`DataSource`通常键入为`object`; 如果不是因为这个问题，编译器可能已经能够告诉你问题（即如果`DataSource`被定义为`IList`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-23T14:20:06.050

我遵循了这个答案，发现 MappingName 始终是底层类名（示例中的 myType ）。

因此，似乎将集合通过 BindingSource 无论如何都可以解决问题，并且不需要 BindingSource.GetListName(null)。

此外，我发现不需要 ToList() 查询，因为 BindingSource 也会为您执行此操作。

非常感谢 Jason Down 让我走上正轨。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-31T08:38:40.910

我在设置列宽时遇到了同样的问题。经过大量的研发，我将代码更改如下，并且工作正常。代码：

```
DataGridTableStyle tableStyle = new DataGridTableStyle();
tableStyle.MappingName = dgCustom.DataSource.GetType().Name; 
```

`dgCustom`DataGrid ID 在哪里`dgCustom.DataSource.GetType().Name`工作得很好。

# javascript - 通过 javascript 设置漂亮的打印标签

> ID：420396
> 
> 赞同：0
> 
> 时间：2009-01-07T13:59:57.060
> 
> 标签：javascript, internet-explorer, pretty-print

我试图让 pretty.js 使用这个 js 来美化 CODE 标签中的代码：

```
onload_functions.push(function() {
    var node_list=document.getElementsByTagName('code');
    for (i=0; i < node_list.length; i++) {
        node_list[i].setAttribute('class','prettyprint');
    }
    prettyPrint();
}); 
```

这适用于 Firefox :) 但 IE 没有。我究竟做错了什么？

[您可以在http://sam.xnet.tk](http://sam.xnet.tk)看到它（非）工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T14:23:43.737

这将非常简单，并且适用于所有带有 jQ​​uery 的浏览器。

```
$(function() {
    $('code').addClass('prettyprint');
    prettyPrint();
}); 
```

编辑：它在 IE 中不起作用的原因是因为 IE 使用 'className' 而不是 'class' 只是为了让生活变得悲惨。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T14:20:34.057

如果代码元素有任何其他类名，这将在 IE 中产生混乱。使用（特定于 IE 的）JavaScript 属性`className`可能会起作用。我评论了`onload`您网站上的功能。顺便说一句，您嵌入 JavaScript 的方式将破坏未来兼容标准的浏览器，请参阅[W3C 验证器为您的站点输出的结果](http://validator.w3.org/check?verbose=1&uri=http%3A%2F%2Fsam.xnet.tk%2F)。最简单的解决方案是将代码移动到外部文件。

# c# - 基于整数设置布尔值

> ID：420404
> 
> 赞同：6
> 
> 时间：2009-01-07T14:03:25.930
> 
> 标签：c#, coding-style, readability

我发现这个语句是一些旧代码，我花了一秒钟才弄清楚......

```
IsTestActive = (TestStateID == 1 ? true : false); 
```

如果我错了，请纠正我，但这和这个不一样吗？：

```
IsTestActive = (TestStateID == 1); 
```

如果是，你为什么要使用第一个？哪个更具可读性？（我认为是后者，但我想看看其他人的想法。）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-07T14:04:39.500

是的，完全一样。

是的，后者更具可读性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T15:11:24.360

```
IsTestActive = (TestStateID == 1); 
```

绝对更具可读性。

你*可以*为定义一个常量做一个案例

```
ACTIVE = 1 
```

然后将布尔变量替换`IsTestActive`为

```
(TestStateID == ACTIVE) 
```

现在的代码方式，如果状态发生变化而不更新布尔值，则布尔值的状态`IsTestActive`将是错误的。`TestStateID`绕过布尔值并测试您所追求的信息的真实来源将消除此错误的可能性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T14:06:09.717

不，使用第一个版本没有实际理由，世界并不完美，[程序员也不完美。](http://thedailywtf.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T16:31:35.897

可读性取决于您在何处使用此构造。我经常发现类似的东西

```
(TestStateID == 1 ? true : false) 
```

更具可读性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-06-04T09:46:53.950

好吧，我不知道其他语言，但在 PHP 中使用类型转换更容易：

```
$IsTestActive = (boolean)$TestStateId; 
```

# regex - 如何替换正则表达式匹配并在 Perl 中映射替换？

> ID：420410
> 
> 赞同：3
> 
> 时间：2009-01-07T14:05:49.343
> 
> 标签：regex, perl, substitution

IE：

```
echo H#97llo | MagicPerlCommand 
```

标准输出：

```
Hallo 
```

MagicPerlCommand 类似于

```
perl -pnle "s/#(\d+)/chr(\1)/ge" 
```

（但这不起作用）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T14:10:19.147

在您的 MagicPerlCommand 中更改`\1`为。评估替换表达式时（即）`$1`，`\digit`反向引用样式不起作用。`s///e`

这在 Windows 和 Linux 上对我有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T14:15:22.897

根据[`j_random_hacker`](https://stackoverflow.com/users/47984/jrandomhacker)答案，您必须使用`$1`而不是`\1`.

这是因为`/e`对正则表达式使用 ' ' 修饰符意味着右手边只是另一个正常的 Perl 表达式，而不是正则表达式替换。由于它是 Perl，因此您必须使用 Perl 的语法作为括号引用，而不是通常的正则表达式语法。

# c# - 如何使用 C# 更改 Crystal 报表中的图像

> ID：420412
> 
> 赞同：1
> 
> 时间：2009-01-07T14:07:05.567
> 
> 标签：c#, .net, crystal-reports, report

如何使用 C# 在 Crystal 报表中更改图像（其 OLE 对象）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-06T11:34:16.087

您可以将 CRAXDRT.dll 和 CrystalDecisions.Shared.dll 添加到您的引用中，然后您可以使用以下代码：

```
 CRAXDRT.Report report2 = new CRAXDRT.Report();
                CRAXDRT.Application app2 = new CRAXDRT.Application();
                report2 = app2.OpenReport("YourReportName.rpt", OpenReportMethod.OpenReportByDefault);
                for (int i = 1; i < report2.Sections.Count + 1; i++)
                {
                    for (int j = 1; j < report2.Sections[i].ReportObjects.Count + 1; j++)
                    {
                        try
                        {
                            CRAXDRT.OleObject to2 = (CRAXDRT.OleObject)report2.Sections[i].ReportObjects[j];
                            CRAXDRT.OleObject to3 = report2.Sections[i].AddPictureObject("NewOleName.bmp", to2.Left, to2.Top);
                            to3.Height = to2.Height;
                            to3.Width = to2.Width;
                            report2.Sections[i].DeleteObject(to2);
                        }
                        catch (Exception) { }
                    }
                } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T10:34:41.047

Suppose you have your image in a Bitmap object, save it to MemoryStream in Bitmap format,
Create a DataSource, create DataTable in it with 1 DataColumn with type of byte array

```
MemoryStream ms; //contains saved bitmap~!!!
DataTable dt = new DataTable();
dt.Columns.Add(new DataColumn("img", typeof(Byte[])));
DataRow row = dt.NewRow();
row["img"] = ms.ToArray(); 
```

also have the report (or subreport of your report) bound to DataSource with schema as above insert Image object bound to the "img" column to report

# javascript - 有没有办法在 JavaScript 中检测下载的开始？

> ID：420417
> 
> 赞同：6
> 
> 时间：2009-01-07T14:08:01.867
> 
> 标签：javascript, html, iframe, download

在我们当前的项目中，我们提供了一个 PDF 下载，用户可以通过他提交的 HTML 表单对其进行自定义。动态生成 PDF 需要几秒钟，我想将其可视化，例如通过禁用提交按钮直到下载开始。不幸的是，我找不到检测下载何时开始的方法*。所以我不知道何时重新启用提交按钮。

我已经尝试将 IFrame 指定为我的 HTML 表单的目标，希望`onload`能够触发该事件。然而，事实并非如此——可能是因为 PDF 是使用“ `Content-disposition: attachment`”标头发送的，并且它实际上并未加载到 IFrame 中。

我现在能想到的唯一解决方案是将 PDF 生成到服务器上的临时文件中，我想避免这种情况。

*）让我澄清一下：我不需要知道下载是否完成，或者即使它真的开始了。我想检测浏览器询问用户是打开还是保存文件的点。我猜这发生在浏览器收到 HTTP 标头时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T17:22:43.063

如果我是你，我会用信息对服务器进行 AJAX 调用，生成文件，然后将文件名/id/whatever 返回到 javascript，然后使 window.location 类似于 download.php?id=x （但文件已经生成，所以它只是设置标题并将其读出）此时您可以重新启用提交。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T14:18:43.153

您想要的是能够检测下载文件的大小何时从 0 变为正值。据我所知，使用 javascript 是不可能做到这一点的——您需要一个可以访问客户端文件系统的插件。

推荐的解决方法：每次下载创建一个会话。让客户端轮询服务器关于下载的状态。这可能是“不存在”、“未开始”、“开始”、“完成”。您需要一些服务器端的工作来保持和更新下载状态以及 AJAX 框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T14:19:56.927

最简单的解决方案是（慷慨地）估计时间并这样做。这是一个 hack，但它提供了预期的效果。另一种选择可能是使用 Ajax 提交带有回调的表单，以提交表单并让生成器将详细信息返回到调用页面。[http://www.jquery.com/](http://www.jquery.com/)可能是该选项的一个很好的起点。

# c# - 异常拒绝处理

> ID：420423
> 
> 赞同：0
> 
> 时间：2009-01-07T14:12:02.810
> 
> 标签：c#, winforms, exception

我尝试了两种捕获意外未处理异常的方法：

```
static void Main()
        {
            AppDomain.CurrentDomain.UnhandledException += 
                new UnhandledExceptionEventHandler(ErrorHandler.HandleException);

            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            try
            {
                Application.Run(new OCR());
            }
            catch (Exception ex)
            {
                ErrorWindow errorWindow = new ErrorWindow(ex);
                errorWindow.ShowDialog();
                Application.Exit();
            }
        } 
```

当我使用 Visual Studio 执行应用程序时，一切正常。如果我在 bin\Debug 文件夹中使用 exe 文件，则不会处理异常。应用程序的行为就像 catch 块不存在一样。我不知道发生了什么事。有任何想法吗？

**编辑：负载**中的例外不是王位

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T14:14:24.317

那么，我认为您的表单`OnLoad`方法或`Load`事件中有异常。这是一个臭名昭著的问题，IDE 使其行为不同并没有帮助。基本上，您需要确保您的`OnLoad`/`Load`不要扔... 也许把它`catch`放在那里，然后设置一个您可以在之后检查的属性？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T14:42:57.787

我应该处理 System.Windows.Forms.Application.ThreadException - 然后它工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T14:35:08.207

在处理 J# 代码时，我遇到了一个有趣的问题。

假设抛出的异常是类型`FreakyException`。现在，`FreakyException`从`FreakyExceptionBase`类继承，而后者又从`Exception`类继承。诀窍是它们每个都在自己的程序集中定义。说，`FreakyExceptionBase`驻留在 中`ExceptionBases.dll`，但`FreakyException`它本身驻留在 中`Worker.dll`。您的应用程序仅引用`Worker.dll`，但不引用`ExceptionBases.dll`.

在这种情况下，您`catch(Exception)`将无法捕捉`FreakyException`到，因为 .NET 将无法找出指定`FreakyException`实际继承 form的继承链`Exception`。

这发生在 J# 代码中，因为 J# 异常继承自`java.lang.exception`，而我的项目没有引用 J# 库。当引用 J# 时，问题就消失了。

也许您的应用程序也是如此？

# c# - 将控制台输出镜像到文件

> ID：420429
> 
> 赞同：92
> 
> 时间：2009-01-07T14:13:30.730
> 
> 标签：c#, .net, file, text, console

在 C# 控制台应用程序中，是否有一种智能方法可以将控制台输出镜像到文本文件？

目前我只是将相同的字符串传递给两者`Console.WriteLine`并`InstanceOfStreamWriter.WriteLine`在日志方法中。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-01-07T14:35:38.673

这可能是某种更多的工作，但我会反过来。

为控制台实例化一个`TraceListener`，为日志文件实例化一个；此后`Trace.Write`在您的代码中使用语句而不是`Console.Write`. 之后删除日志或控制台输出或附加另一个日志记录机制变得更容易。

```
static void Main(string[] args)
{
    Trace.Listeners.Clear();

    TextWriterTraceListener twtl = new TextWriterTraceListener(Path.Combine(Path.GetTempPath(), AppDomain.CurrentDomain.FriendlyName));
    twtl.Name = "TextLogger";
    twtl.TraceOutputOptions = TraceOptions.ThreadId | TraceOptions.DateTime;

    ConsoleTraceListener ctl = new ConsoleTraceListener(false);
    ctl.TraceOutputOptions = TraceOptions.DateTime;

    Trace.Listeners.Add(twtl);
    Trace.Listeners.Add(ctl);
    Trace.AutoFlush = true;

    Trace.WriteLine("The first line to be in the logfile and on the console.");
} 
```

据我所知，您可以在应用程序配置中定义侦听器，从而可以在不接触构建的情况下激活或停用日志记录。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2011-08-03T13:17:39.233

这是一个简单的类，它是 TextWriter 的子类，以允许将输入重定向到文件和控制台。

像这样使用它

```
 using (var cc = new ConsoleCopy("mylogfile.txt"))
  {
    Console.WriteLine("testing 1-2-3");
    Console.WriteLine("testing 4-5-6");
    Console.ReadKey();
  } 
```

这是课程：

```
class ConsoleCopy : IDisposable
{

  FileStream fileStream;
  StreamWriter fileWriter;
  TextWriter doubleWriter;
  TextWriter oldOut;

  class DoubleWriter : TextWriter
  {

    TextWriter one;
    TextWriter two;

    public DoubleWriter(TextWriter one, TextWriter two)
    {
      this.one = one;
      this.two = two;
    }

    public override Encoding Encoding
    {
      get { return one.Encoding; }
    }

    public override void Flush()
    {
      one.Flush();
      two.Flush();
    }

    public override void Write(char value)
    {
      one.Write(value);
      two.Write(value);
    }

  }

  public ConsoleCopy(string path)
  {
    oldOut = Console.Out;

    try
    {
      fileStream = File.Create(path);

      fileWriter = new StreamWriter(fileStream);
      fileWriter.AutoFlush = true;

      doubleWriter = new DoubleWriter(fileWriter, oldOut);
    }
    catch (Exception e)
    {
      Console.WriteLine("Cannot open file for writing");
      Console.WriteLine(e.Message);
      return;
    }
    Console.SetOut(doubleWriter);
  }

  public void Dispose()
  {
    Console.SetOut(oldOut);
    if (fileWriter != null)
    {
      fileWriter.Flush();
      fileWriter.Close();
      fileWriter = null;
    }
    if (fileStream != null)
    {
      fileStream.Close();
      fileStream = null;
    }
  }

} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-07T14:22:08.967

查看[log4net](http://logging.apache.org/log4net/index.html)。使用 log4net，您可以设置控制台和文件附加程序，它们可以使用单个日志语句将日志消息输出到两个位置。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-07T15:08:25.520

您不能使用`>`命令将输出重定向到文件吗？

```
c:\>Console.exe > c:/temp/output.txt 
```

如果您需要镜像，您可以尝试查找`tee`将输出拆分为文件的 win32 版本。

请参阅[https://superuser.com/questions/74127/tee-for-windows](https://superuser.com/questions/74127/tee-for-windows)从 PowerShell运行**tee**

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-07T14:24:12.253

您可以将 TextWriter 类子类化，然后使用[Console.SetOut](http://msdn.microsoft.com/en-us/library/system.console.setout.aspx)方法将其实例分配给 Console.Out - 这与将相同的字符串传递给 log 方法中的两个方法特别是相同的事情。

另一种方法可能是声明您自己的 Console 类并使用 using 语句来区分这些类：

```
using Console = My.Very.Own.Little.Console; 
```

要访问标准控制台，您需要：

```
global::Console.Whatever 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-09-21T01:01:27.563

编辑：此方法提供了重定向来自第三方包的控制台信息的可能性。重写 WriteLine 方法对我的情况很好，但是您可能需要重写其他 Write 方法，这取决于第三方包。

首先，我们需要创建 StreamWriter 固有的新类，比如 CombinedWriter；

然后用 Console.Out 初始化一个新的 CombinedWriter；

最后，我们可以通过 Console.SetOut 将控制台输出重定向到新类的时刻；

以下代码是对我有用的新类。

```
public class CombinedWriter : StreamWriter
{
    TextWriter console;
    public CombinedWriter(string path, bool append, Encoding encoding, int bufferSize, TextWriter console)
        :base(path, append, encoding, bufferSize)
    {
        this.console = console;
        base.AutoFlush = true; // thanks for @konoplinovich reminding
    }
    public override void WriteLine(string value)
    {
        console.Write(value);
        base.WriteLine(value);
    }
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-07T14:23:02.240

[Log4net](http://logging.apache.org/log4net/index.html)可以为您做到这一点。你只会写这样的东西：

```
logger.info("Message"); 
```

配置将确定打印输出将转到控制台、文件还是两者。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-10-04T12:10:47.810

我认为您已经使用的是最好的方法。一种基本镜像输出的简单方法。

首先在开头声明一个全局TextWriter：

```
private TextWriter txtMirror = new StreamWriter("mirror.txt"); 
```

然后制作一个写法：

```
// Write empty line
private void Log()
{
    Console.WriteLine();
    txtMirror.WriteLine();
}

// Write text
private void Log(string strText)
{
    Console.WriteLine(strText);
    txtMirror.WriteLine(strText);
} 
```

现在，不要使用 ，而是`Console.WriteLine("...");`使用`Log("...");`。就那么简单。它甚至更短！

* * *

如果你移动光标位置（`Console.SetCursorPosition(x, y);`）可能会有一些麻烦，但其他效果很好，我自己也使用它！

## 编辑

`Console.Write();`当然，如果你不只使用 WriteLines，你可以用同样的方式制作一个方法

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-09-11T01:00:13.163

正如 Arul 所建议的， using`Console.SetOut`可用于将输出重定向到文本文件：

```
Console.SetOut(new StreamWriter("Output.txt")); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-08-26T00:08:10.267

使用继承自 StreamWriter 的类的决定以及用户 Keep Thinking 的建议是有效的。但我必须添加到构造函数base.AutoFlush = true：

```
{
    this.console = console;
    base.AutoFlush = true;
} 
```

以及对析构函数的显式调用：

```
public new void Dispose ()
{
    base.Dispose ();
} 
```

否则，文件在他记录所有数据之前关闭。

我将其用作：

```
CombinedWriter cw = new CombinedWriter ( "out.txt", true, Encoding.Unicode, 512, Console.Out );
Console.SetOut (cw); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-09-17T22:37:30.580

感谢您继续思考提供出色的解决方案！我添加了一些进一步的覆盖以避免记录某些控制台写入事件（出于我的目的），这些事件仅适用于控制台显示。

```
using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace RedirectOutput
{
    public class CombinedWriter  : StreamWriter
    {
        TextWriter console;
        public CombinedWriter(string path, bool append, TextWriter consoleout)
            : base(path, append)
        {
            this.console = consoleout;
            base.AutoFlush = true;
        }
        public override void Write(string value)
        {
            console.Write(value);
            //base.Write(value);//do not log writes without line ends as these are only for console display
        }
        public override void WriteLine()
        {
            console.WriteLine();
            //base.WriteLine();//do not log empty writes as these are only for advancing console display
        }
        public override void WriteLine(string value)
        {
            console.WriteLine(value);
            if (value != "")
            {
                base.WriteLine(value);
            }
        }
        public new void Dispose()
        {
            base.Dispose();
        }
    }
    class Program
    {
        static void Main(string[] args)
        {
            CombinedWriter cw = new CombinedWriter("combined.log", false, Console.Out);
            Console.SetOut(cw);
            Console.WriteLine("Line 1");
            Console.WriteLine();
            Console.WriteLine("Line 2");
            Console.WriteLine("");
            for (int i = 0; i < 10; i++)
            {
                Console.Write("Waiting " + i.ToString());
                Console.CursorLeft = 0;
            }
            Console.WriteLine();
            for (int i = 0; i < 10; i++)
            {
                Console.Write("Waiting " + i.ToString());
            }
            Console.WriteLine();
            Console.WriteLine("Line 3");
            cw.Dispose();
        }
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-10-27T18:54:02.207

如果您从不受控制的代码（例如 3rd 方库）复制控制台输出，则应覆盖 TextWriter 的所有成员。代码使用了这个线程的想法。

用法：

```
using (StreamWriter writer = new StreamWriter(filePath))
{
   using (new ConsoleMirroring(writer))
   {
       // code using console output
   }
} 
```

ConsoleMirroring 类

```
public class ConsoleMirroring : TextWriter
{
    private TextWriter _consoleOutput;
    private TextWriter _consoleError;

    private StreamWriter _streamWriter;

    public ConsoleMirroring(StreamWriter streamWriter)
    {
        this._streamWriter = streamWriter;
        _consoleOutput = Console.Out;
        _consoleError = Console.Error;

        Console.SetOut(this);
        Console.SetError(this);
    }

    public override Encoding Encoding { get { return _consoleOutput.Encoding; } }
    public override IFormatProvider FormatProvider { get { return _consoleOutput.FormatProvider; } }
    public override string NewLine { get { return _consoleOutput.NewLine; } set { _consoleOutput.NewLine = value; } }

    public override void Close()
    {
        _consoleOutput.Close();
        _streamWriter.Close();
    }

    public override void Flush()
    {
        _consoleOutput.Flush();
        _streamWriter.Flush();
    }

    public override void Write(double value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }
    public override void Write(string value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(object value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(decimal value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(float value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(bool value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(int value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(uint value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(ulong value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(long value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(char[] buffer)
    {
        _consoleOutput.Write(buffer);
        _streamWriter.Write(buffer);

    }

    public override void Write(char value)
    {
        _consoleOutput.Write(value);
        _streamWriter.Write(value);

    }

    public override void Write(string format, params object[] arg)
    {
        _consoleOutput.Write(format, arg);
        _streamWriter.Write(format, arg);

    }

    public override void Write(string format, object arg0)
    {
        _consoleOutput.Write(format, arg0);
        _streamWriter.Write(format, arg0);

    }

    public override void Write(string format, object arg0, object arg1)
    {
        _consoleOutput.Write(format, arg0, arg1);
        _streamWriter.Write(format, arg0, arg1);

    }

    public override void Write(char[] buffer, int index, int count)
    {
        _consoleOutput.Write(buffer, index, count);
        _streamWriter.Write(buffer, index, count);

    }

    public override void Write(string format, object arg0, object arg1, object arg2)
    {
        _consoleOutput.Write(format, arg0, arg1, arg2);
        _streamWriter.Write(format, arg0, arg1, arg2);

    }

    public override void WriteLine()
    {
        _consoleOutput.WriteLine();
        _streamWriter.WriteLine();

    }

    public override void WriteLine(double value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(decimal value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(string value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(object value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(float value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(bool value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(uint value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(long value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(ulong value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(int value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(char[] buffer)
    {
        _consoleOutput.WriteLine(buffer);
        _streamWriter.WriteLine(buffer);

    }
    public override void WriteLine(char value)
    {
        _consoleOutput.WriteLine(value);
        _streamWriter.WriteLine(value);

    }
    public override void WriteLine(string format, params object[] arg)
    {
        _consoleOutput.WriteLine(format, arg);
        _streamWriter.WriteLine(format, arg);

    }
    public override void WriteLine(string format, object arg0)
    {
        _consoleOutput.WriteLine(format, arg0);
        _streamWriter.WriteLine(format, arg0);

    }
    public override void WriteLine(string format, object arg0, object arg1)
    {
        _consoleOutput.WriteLine(format, arg0, arg1);
        _streamWriter.WriteLine(format, arg0, arg1);

    }
    public override void WriteLine(char[] buffer, int index, int count)
    {
        _consoleOutput.WriteLine(buffer, index, count);
        _streamWriter.WriteLine(buffer, index, count);

    }
    public override void WriteLine(string format, object arg0, object arg1, object arg2)
    {
        _consoleOutput.WriteLine(format, arg0, arg1, arg2);
        _streamWriter.WriteLine(format, arg0, arg1, arg2);

    }

    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            Console.SetOut(_consoleOutput);
            Console.SetError(_consoleError);
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-01-30T09:13:53.303

实际上，您可以通过实现您自己的从 TextWriter 继承的类并覆盖 WriteLine 方法来创建 Console.Out 到 Trace 的透明镜像。

在 WriteLine 中，您可以将其写入 Trace，然后可以将其配置为写入文件。

我发现这个答案很有帮助： [https ://stackoverflow.com/a/10918320/379132](https://stackoverflow.com/a/10918320/379132)

它实际上对我有用！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-07-15T14:22:55.690

我的答案是基于[投票最多的未接受的答案](https://stackoverflow.com/a/6927051/197591)，也是[投票最少的答案](https://stackoverflow.com/a/33376268/197591)，我认为这是迄今为止最优雅的解决方案。就您可以使用的流类型而言，它更加通用（`MemoryStream`例如，您可以使用 a ），但为简洁起见，我省略了[后一个答案](https://stackoverflow.com/a/33376268/197591)中包含的所有扩展功能。

```
class ConsoleMirrorWriter : TextWriter
{
    private readonly StreamWriter _writer;
    private readonly TextWriter _consoleOut;

    public ConsoleMirrorWriter(Stream stream)
    {
        _writer = new StreamWriter(stream);
        _consoleOut = Console.Out;
        Console.SetOut(this);
    }

    public override Encoding Encoding => _writer.Encoding;

    public override void Flush()
    {
        _writer.Flush();
        _consoleOut.Flush();
    }

    public override void Write(char value)
    {
        _writer.Write(value);
        _consoleOut.Write(value);
    }

    protected override void Dispose(bool disposing)
    {
        if (!disposing) return;
        _writer.Dispose();
        Console.SetOut(_consoleOut);
    }
} 
```

用法：

```
using (var stream = File.Create(Path.Combine(Path.GetTempPath(), AppDomain.CurrentDomain.FriendlyName)))
using (var writer = new ConsoleMirrorWriter(stream))
{
    // Code using console output.
} 
```

# c# - 自动属性和结构不混合？

> ID：420433
> 
> 赞同：64
> 
> 时间：2009-01-07T14:14:34.847
> 
> 标签：c#, c#-3.0, struct, automatic-properties

[在回答这个帖子](https://stackoverflow.com/questions/414981/directly-modifying-listt-elements)时踢了一些小结构，我意外地遇到了以下情况：

以下结构，使用 int 字段是完全合法的：

```
struct MyStruct
{ 
    public MyStruct ( int size ) 
    { 
        this.Size = size; // <-- Legal assignment.
    } 

    public int Size; 
} 
```

但是，使用自动属性的以下结构无法编译：

```
struct MyStruct
{ 
    public MyStruct ( int size ) 
    { 
        this.Size = size; // <-- Compile-Time Error!
    } 

    public int Size{get; set;}
} 
```

返回的错误是“'this'对象在其所有字段都分配给之前不能使用”。我知道这是结构的标准过程：必须从结构的构造函数中直接（而不是通过属性的 set 访问器）分配任何属性的支持字段。

一种解决方案是使用显式支持字段：

```
struct MyStruct
{ 
    public MyStruct(int size)
    {
        _size = size;
    }

    private int _size;

    public int Size
    {
        get { return _size; }
        set { _size = value; }
    }
} 
```

（请注意，VB.NET 不会有这个问题，因为在 VB.NET 中，所有字段在首次创建时都会自动初始化为 0/null/false。）

在 C# 中使用带有结构的自动属性时，这似乎是一个不幸的限制。从概念上考虑，我想知道这是否不是一个合理的地方，允许在结构的构造函数中调用属性集访问器的异常，至少对于自动属性？

这是一个小问题，几乎是一个极端情况，但我想知道其他人对此有何看法......

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-01-07T14:17:23.533

从 C# 6 开始：这不再是问题

* * *

Becore C# 6，您需要调用默认构造函数才能使其工作：

```
public MyStruct(int size) : this()
{
    Size = size;
} 
```

这里更大的问题是你有一个可变结构。这**从来都不**是一个好主意。我会做到的：

```
public int Size { get; private set; } 
```

*在技​​术*上不是一成不变的，但足够接近。

使用最新版本的 C#，您可以对此进行改进：

```
public int Size { get; } 
```

现在*只能*在构造函数中分配。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T14:21:08.487

您可以通过首先调用默认构造函数来解决此问题：

```
struct MyStruct 
{
    public MyStruct(int size) : this() 
    {
        this.Size = size; // <-- now works
    }

     public int Size { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-11T05:50:18.773

这个问题的另一个模糊解决方法是在[托管可扩展性框架](http://www.codeplex.com/MEF)`Tuple`的临时类中发现的（通过[Krzysztof Koźmic](http://kozmic.pl/archive/2008/09/24/framework-tips-xi-what-is-this.aspx)）：

```
public struct TempTuple<TFirst, TSecond>
{
    public TempTuple(TFirst first, TSecond second)
    {
        this = new TempTuple<TFirst, TSecond>(); // Kung fu!
        this.First = first;
        this.Second = second;
    }

    public TFirst First { get; private set; }
    public TSecond Second { get; private set; } 
```

（来自 Codeplex 的完整源代码：[Tuple.cs](http://www.codeplex.com/MEF/SourceControl/changeset/view/28358#391337)）

我还注意到[CS0188](http://msdn.microsoft.com/en-us/library/w29h4276.aspx)的文档已更新为添加：

> 如果您在尝试初始化结构构造函数中的属性时看到此错误，解决方案是更改构造函数参数以指定支持字段而不是属性本身。**结构中应避免使用自动实现的属性，因为它们没有支持字段，因此无法从构造函数以任何方式初始化。**

所以我认为这意味着官方指导是在你遇到这个问题时在你的结构中使用旧样式的属性，这可能比目前探索的其他两个替代方案中的任何一个都不那么晦涩（并且更易读）。

# c# - MX 记录查询失败

> ID：420437
> 
> 赞同：1
> 
> 时间：2009-01-07T14:15:47.967
> 
> 标签：c#, interop, dns, unmanaged

我是一个托管代码的人，所以当我与非托管代码互操作时，它不像宣传的那样工作，我会抽搐。有人可以向我解释为什么当命令行工作时这会返回没有 MX 记录`nslookup`？

```
[DllImport("dnsapi", EntryPoint = "DnsQuery_W", CharSet = CharSet.Unicode, SetLastError = true, ExactSpelling = true)]
private static extern int DnsQuery([MarshalAs(UnmanagedType.VBByRefStr)]ref string pszName, QueryTypes wType, QueryOptions options, int aipServers, ref IntPtr ppQueryResults, int pReserved);

string domain = "HomeTechnologySolutions.com";
int num1 = DnsQuery(ref domain, QueryTypes.DNS_TYPE_MX, QueryOptions.DNS_QUERY_BYPASS_CACHE, 0, ref ptr1, 0);
if (num1 != 0)
{
    throw new Win32Exception(num1)
} 
```

返回的错误代码表示“未找到给定 DNS 查询的记录”

令人担忧的是，这是我发现的第一个未通过此测试的域，但我被告知它“经常”发生。（没有人能经常为我定义，但我正在努力）

无论如何，当我通过命令提示符执行 nslookup 时，我会返回：

```
> set type=mx
> hometechnologysolutions.com
Server:  dhcp.removedtoprotectedtheguilty.com
Address:  10.0.0.9

hometechnologysolutions.com
        primary name server = ns1.streetsimple.com
        responsible mail addr = hostmaster.streetsimple.com
        serial  = 11
        refresh = 900 (15 mins)
        retry   = 600 (10 mins)
        expire  = 86400 (1 day)
        default TTL = 3600 (1 hour) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T14:24:38.383

从这里使用 'dig' 时，我也没有收到`MX`针对该特定域名返回的任何记录。

您引用的“nslookup”结果来自域的`SOA`记录，不包括任何`MX`记录。记录会在 DNS 响应的`SOA`“授权”部分返回，即使您提出的特定问题没有记录也是如此。

在没有`MX`记录的情况下，邮件传输代理 (MTA) 会将`A`主机的`MX`记录视为优先级为 0 的记录，并尝试与该地址建立 SMTP 连接。

[请参阅RFC 5321](http://tools.ietf.org/rfcmarkup?doc=5321)的第 5.1 节。请注意，尽管这是最近的 RFC，但此行为也存在于以前版本的 SMTP 规范中。

# debugging - 如何最好地在 WinDBG 崩溃脚本中为可执行名称命名？

> ID：420442
> 
> 赞同：2
> 
> 时间：2009-01-07T14:17:50.177
> 
> 标签：debugging, scripting, windbg, crash-dumps

### 背景资料

为了保存故障转储，我在注册表项`cdb.exe`的`Debugger`值中传递了一个脚本：`AeDebug`

```
C:\progra~1\debugg~1\cdb.exe -p %ld -e %ld -g -y SRV*c:\mss*http://msdl.microsoft.com/download/symbols -c "$<d:\tgticker\Dumps\RDFD.cdbscript" 
```

这是脚本的第一部分：

```
as /c CrashFirstModule .printf "%mu", @@c++((*(ntdll!_LDR_DATA_TABLE_ENTRY**)&@$peb->Ldr->InLoadOrderModuleList.Flink)->BaseDllName.Buffer) 

.logopen /t d:\tgticker\dumps\${CrashFirstModule}_process.log

* (...) 
```

### 问题

使用符号，这完全符合我的意愿，我得到具有合理名称的日志文件，例如：

*   `LHCBDRDT.exe_process_147c_2009-01-06_23-10-05-371.log`

但是，如果符号不可用，我会得到一个这样的日志文件名：

*   `${CrashFirstModule}_process_17a8_2009-01-06_23-10-01-124.log`

这是因为 alias 命令设置别名失败。别名命令是我从[DumpAnalysis.org 获得的](http://www.dumpanalysis.org/blog/index.php/2008/08/13/generating-file-name-for-dump-command/ "DumpAnalysis.org：为 .dump 命令生成文件名")。此命令从图像的 PEB 标头中提取名称，使用`ntdll.dll`. 没有操作系统的符号，它不知道在哪里可以找到它从 ntdll.dll 调用的函数。

### 问题

有谁知道或有命令将图像的名称作为别名用于在这些情况下仍然有效的文件名？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-24T20:15:07.133

所以几年后我在这里得到了答案。

# 答案

在没有符号文件的情况下，这是我找到的获取崩溃可执行文件名称的最佳方法，以便可以在文件名中使用它来编写日志文件或从脚本进行崩溃转储：

```
aS ${/v:CrashFirstModule} "UnknownModule"
.foreach /pS b /ps b (name {.imgscan}) { .if($spat("${name}","*.exe") !=0){aS ${/v:CrashFirstModule} "${name}"; .break} } 
```

在这两行之后，`CrashFirstModule`将别名为“UnknownModule”或可执行文件的名称。这仅在可执行文件以“.exe”结尾时才有效，但这对我来说似乎是合理的，并且在我使用它的情况下工作正常。`.if`如果您需要支持“.com”之类的内容，您可以添加另一个来处理其他结尾。

## 答案：解释

### .imgscan

`.imgscan`给出可执行模块列表，其中包括 .exe、.dll、.drv 等。这是查找可执行文件名称的起点。

```
0:000> .imgscan
MZ at 01000000, prot 00000002, type 01000000 - size 14000
  Name: notepad.exe
MZ at 73070000, prot 00000002, type 01000000 - size 27000
  Name: WINSPOOL.DRV
MZ at 762b0000, prot 00000002, type 01000000 - size 49000
  Name: comdlg32.dll
MZ at 76f50000, prot 00000002, type 01000000 - size 13000
  Name: Secur32.dll
MZ at 77380000, prot 00000002, type 01000000 - size 91000
  Name: USER32.dll
MZ at 77420000, prot 00000002, type 01000000 - size 103000
  Name: COMCTL32.dll
MZ at 77ba0000, prot 00000002, type 01000000 - size 5a000
  Name: msvcrt.dll
MZ at 77c00000, prot 00000002, type 01000000 - size 48000
  Name: GDI32.dll
MZ at 77c50000, prot 00000002, type 01000000 - size a0000
  Name: RPCRT4.dll
MZ at 77e40000, prot 00000002, type 01000000 - size 102000
  Name: KERNEL32.dll
MZ at 7c800000, prot 00000002, type 01000000 - size c3000
  Name: ntdll.dll
MZ at 7c8d0000, prot 00000002, type 01000000 - size 7ff000
  Name: SHELL32.dll
MZ at 7d180000, prot 00000002, type 01000000 - size 52000
  Name: SHLWAPI.dll
MZ at 7d1e0000, prot 00000002, type 01000000 - size 9c000
  Name: ADVAPI32.dll 
```

### .foreach

`.foreach`用于遍历图像列表。`/pS`指定第一个值在列表中的距离。`/ps`指定值之间的距离。（b = 11 in hex）这是必要的，因为`.foreach`将在空格上分隔。使用这些参数，列表变为：

```
0:000> .foreach /pS b /ps b (name {.imgscan}) { .echo name }
notepad.exe
WINSPOOL.DRV
comdlg32.dll
Secur32.dll
USER32.dll
COMCTL32.dll
msvcrt.dll
GDI32.dll
RPCRT4.dll
KERNEL32.dll
ntdll.dll
SHELL32.dll
SHLWAPI.dll
ADVAPI32.dll 
```

### $spat

`$spat`是 MASM 通配符字符串匹配函数。它将第一个参数与第二个参数中的模式匹配。它不区分大小写，因此这将匹配 NOTEPAD.EXE 以及 NotePad.eXe 等。

```
.if($spat("${name}","*.exe") !=0) {.echo "found it!"} 
```

### ${}

`${}`是别名解释器。您可以将`${<alias name>}`别名值写入字符串中的任何位置。如果您在命令中使用别名，则可以直接使用它，所以`.echo CrashFirstmodule`会 echo out `notepad.exe`。在您实际上是指别名的名称的情况下，您可以将其指定为`${/v:<alias name>}`仅解析为别名的名称。重新分配别名时，这种扩展预防是必要的。`aS CrashFirstModule "${name}"`会导致将别名设置`UnknownModule`为`notepad.exe`，因为`CrashFirstModule`在执行命令之前会扩展为它的值。

### 作为

`aS`是分配别名的命令之一。 `aS`由 ; 终止 或行尾，并将“从条目中删除。以下行将别名`CrashFirstModule`为`UnknownModule`：

```
aS ${/v:CrashFirstModule} "UnknownModule" 
```

### 。休息

`.break``.foreach`在找到匹配项后结束。

## 结尾

这就是构成我正在使用的命令的所有部分。我希望其他人从这个问题和答案中得到一些好处！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-08T13:10:17.680

为什么不使用 peb 信息？以下是您需要的：

```
?? @$peb->ProcessParameters 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T13:12:16.497

`ntdll.dll`将出现在每个进程中，所以我猜问题是符号加载。

无论如何，这应该可以摆脱换行符：

 ~~~~```
.foreach(Module {lm 1m}) { aS CrashApp Module; .break } 
```~~  ~~```
.foreach(Module {lm 1m a $exentry}) { aS CrashApp Module } 
```

# visual-studio - 打开 Visual Studio 解决方案时如何使文件显示

> ID：420451
> 
> 赞同：1
> 
> 时间：2009-01-07T14:20:18.423
> 
> 标签：visual-studio, projects-and-solutions

我需要添加一个 C# 解决方案，其中包含将作为软件库安装程序的一部分分发的示例。该解决方案将包含有关如何使用产品 API 的各种示例。

我希望能够显示一个简单的“快速启动”文件，解释在 Visual Studio 中打开解决方案时如何运行示例。

有没有办法告诉 Visual Studio 在解决方案/项目打开时打开特定的文本文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T14:30:38.200

威尔说了什么。

解决方案的 UI 状态（例如打开哪些文件进行编辑）存储在一个解决方案文件中，每个用户都应该有一个单独的副本，因此通常不会签入共享版本控制：即不是 *.sln 文件，而是我认为 *.suo 文件（但请注意，这是一个不会“合并”的二进制文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T14:34:35.073

实际上，我认为不可能让解决方案文件打开特定内容甚至脚本操作。

也许您可以为您的库创建一个 MSI 设置（如果您还没有）并且不提供带有示例代码的解决方案，而是提供一个由 MSI 安装在正确位置的项目模板，以便在 VisualStudio 中立即作为模板使用? 然后有人可以轻松地“新建项目”，选择演示模板并使用您的示例代码获取项目预设。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T15:36:42.873

听起来解决方案或项目模板将是最佳选择。这将允许您在用户的文件 - 新建对话框中创建一个条目（类似于“新类库”等）。在 VS 2008 中，这些更容易创建 - 文件 -> 导出模板。模板只是项目的 zip (s) 使用您可以修改的 xml 清单文件。清单模式的一部分允许您指定要以 HTML 或文本形式打开的文件。模板可以作为安装程序包的一部分相对容易地安装。

这里有更多关于一般概念的信息：http: [//msdn.microsoft.com/en-us/library/6db0hwky.aspx](http://msdn.microsoft.com/en-us/library/6db0hwky.aspx)

以及有关如何在启动时以各种模式打开文件的架构参考：http: [//msdn.microsoft.com/en-us/library/ys81cc94.aspx](http://msdn.microsoft.com/en-us/library/ys81cc94.aspx)

如果您需要提供更多指导/向导，请考虑 Guidance Automation Toolkit。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T14:37:04.960

只需制作一个调用 devenv /useenv yoursolution.sln 的 .bat 文件（使用 VS env）——这样你可以让事情变得有点花哨；）

# macos - 在 Mac OS finder 中打开终端

> ID：420456
> 
> 赞同：682
> 
> 时间：2009-01-07T14:21:21.417
> 
> 标签：macos, terminal, finder

是否有类似于 Mac OS 的“在此处打开命令窗口”Windows Powertoy 的东西？我通过谷歌搜索找到了几个插件，但想看看哪些插件最适合那里的开发人员。

* * *

## 回答 #1

> 赞同：900
> 
> 时间：2011-08-13T23:51:03.450

从 Mac OS X Lion 10.7 开始，终端完全包含此功能即服务。与大多数服务一样，这些默认情况下是禁用的，因此您需要启用它以使其显示在“服务”菜单中。

> 系统偏好设置 > 键盘 > 快捷方式 > 服务

在文件夹启用**新终端**。**Folder 处**还有New Terminal Tab ，它将在最前面的 Terminal 窗口中创建一个选项卡（如果有的话，它将创建一个新窗口）。这些服务适用于所有应用程序，而不仅仅是 Finder，它们对文件夹以及在文本中选择的绝对路径名进行操作。

您甚至可以为它们分配命令键。

服务出现在每个应用程序菜单的“服务”子菜单中，以及上下文菜单中（按住 Control 键单击或右键单击文件夹或路径名）。

当您在 Finder 中**选择文件夹时**，文件夹中的**新终端**服务将激活。您不能简单地打开文件夹并“就地”运行服务。返回父文件夹，选择相关文件夹，然后通过服务菜单或上下文菜单激活服务。

 **此外，如果您将文件夹（或路径名）拖到终端应用程序图标上，Lion Terminal 将打开一个新的终端窗口，您也可以拖到现有窗口的标签栏以创建新标签。

最后，如果您将文件夹或路径名拖到选项卡上（在选项卡栏中）并且前台进程是外壳程序，它将自动执行“cd”命令。（拖动到选项卡中的终端视图仅会自行插入路径名，就像在旧版本的终端中一样。）

您也可以从命令行或 shell 脚本执行此操作：

```
open -a Terminal /path/to/folder 
```

这是将文件夹/路径名拖到终端应用程序图标上的命令行等效项。

在相关的说明中，Lion Terminal 还具有用于查找手册页的新服务：**在终端中打开手册页**会在新的终端窗口中显示选定的手册页主题，并且**在终端中搜索手册页**对选定的文本执行“apropos”。前者还理解手册页引用（“open(2)”）、手册页命令行参数（“2 open”）和手册页 URL（“x-man-page://2/open”）。

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2009-01-10T17:42:53.843

这：

[https://github.com/jbtule/cdto#cd-to](https://github.com/jbtule/cdto#cd-to)

这是一个小应用程序，您可以将其拖入 Finder 工具栏，图标非常适合。它适用于终端、xterm（在 X11 下）、iterm。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2010-08-19T07:26:06.523

我发现作为替代方案不可或缺的一个应用程序是[DTerm](http://www.decimus.net/dterm.php)，它实际上在您的应用程序中打开了一个迷你终端。此外，它适用于几乎所有的东西——Finder、XCode、PhotoShop 等。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-03-08T00:52:25.350

澄清（感谢@vgm64）：如果您已经在终端中，这可以让您在不离开终端的情况下快速切换到最顶层的 Finder 窗口。这样，您可以避免使用鼠标。

我已将以下内容添加到我的`.bash_profile`，以便我可以随时输入`cdff`终端。

```
function ff { osascript -e 'tell application "Finder"'\
 -e "if (${1-1} <= (count Finder windows)) then"\
 -e "get POSIX path of (target of window ${1-1} as alias)"\
 -e 'else' -e 'get POSIX path of (desktop as alias)'\
 -e 'end if' -e 'end tell'; };\

function cdff { cd "`ff $@`"; }; 
```

这是来自[这个 macosxhints.com 终端提示](http://www.macosxhints.com/article.php?story=20060719155640762)。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-04-13T04:28:48.883

在这里查看[打开终端](http://jo.irisson.free.fr/?p=59)。它可能与“在此处打开命令窗口”最相似。我用过`>cdto`，这非常相似，但这似乎在处理空间方面要好一些……但并不完美。

它非常棒的是能够“*在应用程序启动时检测按键事件并使用它们来修改脚本的行为*”，从而允许脚本在调用时在最前面的终端窗口中打开一个新选项卡按住 ⌘ 键。巧妙的把戏。

还要注意 PCheese 的回答；它可能对重度终端用户更有用！

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2010-08-15T11:08:30.453

*vgm64*和*d0k*发布了非常漂亮和纤薄的**Open Terminal Here**的更新版本。改变是由*詹姆斯大卫洛*做出的。[他在他的网站](http://jameslow.com/2010/04/22/openterminalhere-and-anthere/)上发布了新版本。只需下载 OpenTerminalHere.zip，解压缩，将包移动到 Library/Scripts 文件夹，然后将其从那里拖到 Finder 工具栏。

 ***它的特别之处在于，如果 Terminal.app 窗口已经打开，它**总是会打开一个新选项卡。**很有用！我还注意到，应用程序按钮的样式比 redacted 发布的 cdto 更适合 Snow Leopard Finder.app*样式*。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-01-07T14:35:36.333

此外，您可以使用 command-C 从查找器中复制项目，跳转到终端（例如使用 Spotlight 或 QuickSilver）输入“cd”并简单地使用 command-v 粘贴

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-08-05T14:23:50.273

我为查找工具栏创建了一个包含 3 个应用程序的捆绑包。其他两个应用程序：

*   使用当前选择打开 Textmate
*   使用当前文件夹打开 GitX

有关更多信息，请参见此处： http: [//nslog.de/posts/71](http://nslog.de/posts/71)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-10T17:07:54.223

如果您安装 Big Cat Scripts ( [http://www.ranchero.com/bigcat/](http://www.ranchero.com/bigcat/) )，您可以添加自己的上下文菜单（右键单击）项目。我不认为它带有 Open Terminal Here applescript，但我使用这个脚本（老实说，我不记得是我自己写的，还是从别人的例子中提取的）：

* * *

```
on main(filelist)
    tell application "Finder"
        try
            activate
            set frontWin to folder of front window as string
            set frontWinPath to (get POSIX path of frontWin)
            tell application "Terminal"
                activate
                do script with command "cd \"" & frontWinPath & "\""
            end tell
        on error error_message
            beep
            display dialog error_message buttons ¬
                {"OK"} default button 1
        end try
    end tell
end main 
```

* * *

类似的脚本还可以在右键单击时为您提供文件的完整路径，我发现这更加有用。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-11T13:55:05.040

它比你要求的要多一点，但我推荐 Cocoatech 的路径查找器给任何希望查找器有更多汁液的人。它包括一个用于打开当前目录的终端窗口的工具栏按钮，或在每个 Finder 窗口底部带有终端命令行的可伸缩窗格。加上我现在不能没有的许多其他功能。非常成熟、稳定的软件。 [http://cocoatech.com/](http://cocoatech.com/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-11-05T22:25:44.640

好的，我意识到这有点晚了......也许在写这篇文章的时候这个替代方案不可用？

无论如何，我发现通过 Fink 安装 pos 包（在这种情况下是先决条件，也许对于那些使用 MacPorts 的人来说有类似的东西？）是最简单的解决方案。你得到两个命令：

1.  posd - 给出最前面的 Finder 窗口的当前目录（您可能为其创建别名 cdf=cd posd）
2.  fdc - 将最前面的 Finder 窗口的当前目录切换到终端密码。这与 'open ' 略有不同。它总是打开一个新的查找器窗口。

是的，您必须在编写 cdf 之前切换到终端窗口，但我想这与单击 Finder 工具栏中的按钮相比相当便宜。它也适用于 iTerm，您不必下载单独的 Finder 工具栏按钮来打开 iTerm 窗口。这与 PCheese 提出的方法相同，但您不必弄乱 .bash_profile。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-02-06T13:56:32.130

如果像我一样关闭 Finder 工具栏，此服务会在每个文件夹的上下文菜单中添加一个项目：http: [//blog.leenarts.net/2009/09/03/open-service-here/](http://blog.leenarts.net/2009/09/03/open-service-here/)

这还允许您打开在 Finder 树视图中看到的任何文件夹。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-08-17T19:39:10.413

我主要使用这个功能：

```
cf() {
  cd "$(osascript -e 'tell app "Finder" to POSIX path of (insertion location as alias)')"
} 
```

您还可以为脚本分配一个快捷方式，如下所示。

重用现有选项卡或创建新窗口（终端）：

```
tell application "Finder" to set p to POSIX path of (insertion location as alias)
tell application "Terminal"
    if (exists window 1) and not busy of window 1 then
        do script "cd " & quoted form of p in window 1
    else
        do script "cd " & quoted form of p
    end if
    activate
end tell 
```

重用现有选项卡或创建新选项卡（终端）：

```
tell application "Finder" to set p to POSIX path of (insertion location as alias)
tell application "Terminal"
    if not (exists window 1) then reopen
    activate
    if busy of window 1 then
        tell application "System Events" to keystroke "t" using command down
    end if
    do script "cd " & quoted form of p in window 1
end tell 
```

始终创建一个新选项卡（iTerm 2）：

```
tell application "Finder" to set p to POSIX path of (insertion location as alias)
tell application "iTerm"
    if exists current terminal then
        current terminal
    else
        make new terminal
    end if
    tell (launch session "Default") of result to write text "cd " & quoted form of p
    activate
end tell 
```

与 10.7 中添加的服务相比，前两个脚本有两个优点：

*   他们使用标题栏上的文件夹，而不是要求您先选择一个文件夹。
*   如果最前面的选项卡不忙，它们会重用它，例如运行命令、显示手册页或运行 emacs。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-07-30T11:18:40.837

OSX 10.6 上的 AppleScript 中有一个错误。（2 个终端窗口打开）。我通过在激活后添加关闭命令来解决这个问题。这将关闭第一个终端窗口。

```
on run
    tell application "Finder"
        try
            activate
            set frontWin to folder of front window as string
            set frontWinPath to (get POSIX path of frontWin)
            tell application "Terminal"
                activate
                close
                do script with command "cd \"" & frontWinPath & "\""
            end tell
        on error error_message
            beep
            display dialog error_message buttons ¬
                {"OK"} default button 1
        end try
    end tell
end run 
```

# visual-studio-2005 - Visual Studio 将升级的 Web 应用程序作为网站打开

> ID：420468
> 
> 赞同：3
> 
> 时间：2009-01-07T14:24:50.053
> 
> 标签：visual-studio-2005, web, web-applications

我最近将一个 1.1 Web 项目升级为 2.0 Web 应用程序。通过升级向导并执行“升级到 Web 应用程序”操作后，一切看起来都很好。然而，在关闭并重新打开 Visual Studio 后，它坚持将项目视为一个网站，而不是一个 Web 应用程序，并且缺少“升级到 Web 应用程序”选项。我非常了解这两种项目类型之间的差异，但是有没有人清楚地了解 csproj/sln/etc 中的差异。告诉 Visual Studio 它是什么类型的项目的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T14:33:17.713

回答我自己的问题：

我在这里找到了一些信息：http: [//hamang.net/2008/11/03/bug-vs-2008-web-application-project-opened-as-web-site/](http://hamang.net/2008/11/03/bug-vs-2008-web-application-project-opened-as-web-site/)

这篇文章是关于 VS 2008 的，但信息似乎与 2005 年相关，并且所描述的解决方案有效。

总结：.sln 文件有一个“Project”节点，在网站项目中指向项目的文件夹，但在 Web 应用程序项目中指向 .csproj/.vbproj 文件本身。此外，可能还有一个 .webinfo 文件，其中包含项目的 Visual Studio 路径信息；删除这个文件解决了这个问题。

我发现了很多关于升级的教程，但关于 Visual Studio 如何“理解”项目类型的详细信息却很少。如果有人有更多关于细节的信息（.webinfo 文件是做什么用的？），将不胜感激。

# macos - Mac OS 对应 Sysinternals 和 Powertoys

> ID：420476
> 
> 赞同：6
> 
> 时间：2009-01-07T14:27:14.933
> 
> 标签：macos

作为具有 Windows 背景的开发人员，我总是发现不同的[Powertoys](http://www.microsoft.com/windowsxp/Downloads/powertoys/Xppowertoys.mspx)和[Sysinternals](http://technet.microsoft.com/en-us/sysinternals/default.aspx)应用程序是帮助编程的宝贵工具。开发人员在 Mac 世界中是否有类似的事情需要注意？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T14:37:33.040

Mac OS 中包含许多此类工具，有些工具可从 Apple 单独获得。

没有与 Mac 等效的注册表——一切都在文件系统中的某个地方——你可以使用 fs_usage 来观察它。在终端中：

`sudo fs_usage`

查看[Instruments](http://www.apple.com/macosx/developertools/instruments.html)，它是 Apple 开发人员工具分发的一部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T18:27:54.803

[用于 Mac OS X 的 10 大 DTrace 脚本](http://dtrace.org/blogs/brendan/2011/10/10/top-10-dtrace-scripts-for-mac-os-x/)是一篇文章，描述了 10 个非常有用的工具，它们是 Mac 上的一些 Sysinternals 工具（如 ProcessMon、FileMon 等）的等效工具。

[该帖子的作者在制作DTraceToolkit](http://www.brendangregg.com/dtrace.html#DTraceToolkit)时创建了一些脚本，他说苹果随后对其进行了定制和增强，以便默认包含在 Mac OS X 中。

一些脚本名称看起来以“noop”一词结尾，这可能有点令人困惑——它实际上是“snoop”。就像监视系统活动一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T14:42:57.413

Mac OS X 带有很多 unix 工具，例如 sar、top 等。您具体需要哪些指标？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T14:39:17.980

不是这样的。一些 Powertoys 实现了操作系统内置的功能，一些可作为各种实用程序使用。

至于 Sysinternals，有很多。如果您需要详细信息，我需要更好地了解您使用的内容，但您可能仅从终端窗口复制 90% 的功能。学习如何使用 bash 和普通的 Unix 实用程序将是一项非常好的技能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-13T02:18:05.990

[http://newosxbook.com/index.php?page=downloads](http://newosxbook.com/index.php?page=downloads)提供了几乎完全相同的对应物，尽管是在 CLI 模式下——好处是它们也可以在（越狱的）iOS 上工作。

# cocoa - Cocoa 应用程序中的性能调优

> ID：420478
> 
> 赞同：0
> 
> 时间：2009-01-07T14:27:34.930
> 
> 标签：cocoa, performance, macos

我正在开发一个 Cocoa 应用程序，它不断与 Web 服务通信以获取最新数据。这大大降低了应用程序的性能。对 Web 服务的调用是异步进行的，但是调用的数量很大。

我可以通过哪些方式提高应用程序的性能？当 Cocoa 应用程序与 Web 服务通信时，是否有一个很好的文档/文章可以提供最佳实践？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T14:33:47.117

您应该尝试Mac OS X 开发工具附带的[Shark](http://developer.apple.com/tools/sharkoptimize.html) - 非常适合挖掘您的调用堆栈，并且应该允许您限制网络库和朋友。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T14:40:00.490

我认为，如果您使用 Shark，您只会发现您的应用程序正在阻止等待服务器返回的答案。跨机器分割的代码很难进行基准测试，因为标准工具只能对图片的一部分进行基准测试。

听起来您需要考虑将呼叫捆绑到更少的事务中……您的瓶颈几乎可以肯定是网络。支持将多个调用作为调用数组发送怎么样？答案也一样？也许您可以在本地缓冲调用，并且每秒仅将它们作为单个事务发送几次？

托尼

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T15:25:53.957

是的！Apple 实际上有一些非常简洁的性能指南，涵盖了很多技巧和技术，我相信您会找到与您自己的应用程序相关的内容。可能还有一些特定于 10.5 的其他指南我还没有看到，但这里有三个我过去发现有用的指南。

*   [性能概述](http://developer.apple.com/documentation/Performance/Conceptual/PerformanceOverview/Introduction/chapter_1_section_1.html#//apple_ref/doc/uid/TP40001410-CH202-DontLinkElementID_32)
*   [可可性能指南](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaPerformance/CocoaPerformance.html)
*   [可可拉丝性能指南](http://developer.apple.com/DOCUMENTATION/Performance/Conceptual/Drawing/DrawingPerformance.html)

不过，最重要的是，您需要使用性能工具来准确查看瓶颈发生在哪里。有时它可能在您最不期望的地方。

# sql-server - SQL Server 2008 维护计划因数据库正在使用而失败

> ID：420479
> 
> 赞同：0
> 
> 时间：2009-01-07T14:27:59.737
> 
> 标签：sql-server

我已经在我们的 Sql Server 2008 数据库上创建了几个维护计划，这些计划执行备份（完整和差异）以在一夜之间运行，但它们一直失败并显示数据库当前正在使用中的消息。

在计划运行维护计划期间，我们通常几乎没有流量，因此我不确定为什么会出现此错误。是否有我可以添加到维护计划的命令或我可以对计划进行的配置更改以允许计划执行？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T15:07:35.973

我可以代表 2000/2005 年并说备份不应受到正在使用的数据库的影响。维护计划中是否还有其他可能导致此问题的步骤？您是否设置了维护计划的报告/日志记录选项以写入日志文件？这可能会提供更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T15:08:01.060

似乎我的一个数据库在恢复状态下“卡住”了。从计划中删除该数据库似乎可以解决问题。现在要弄清楚是什么导致该数据库“卡住”了......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-14T18:49:11.247

如果在维护计划期间几乎没有流量，那么您应该将数据库置于只读模式或使其脱机，这样所有事务都将暂停，同时您可以进行备份。这完全一样。

# asp.net - 使用 AjaxPro 传递变量

> ID：420483
> 
> 赞同：0
> 
> 时间：2009-01-07T14:29:14.413
> 
> 标签：asp.net, vb.net, ajaxpro

前几天我发现[了这个 AJAX .NET 框架](http://www.ajaxpro.info/)，到目前为止我很享受使用它。但是，我无法弄清楚的一件事（文档是相当糟糕的 atm）是如何通过 AJAX 脚本传递变量。这是我到目前为止所拥有的：

```
//default2.aspx.vb
  <AjaxPro.AjaxMethod()> _
  Public Shared Function testSomething(ByVal value As String) As String
     Return value
  End Function
  Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
     AjaxPro.Utility.RegisterTypeForAjax(GetType(Default2))
  End Sub

//default2.aspx
  <a href="#" onclick="doTest(1);">test something</a>
  <div id="temp" style="margin:15px 15px 0px 5px; padding:10px;"></div>
  <script type="text/javascript">
     function doTest(x){
         Default2.testSomething(doTest_callback,x)
     }
     function doTest_callback(res,x){
         alert(res.value);
         document.getElementById("temp").innerHTML = ">>>> " + x + " <<<<"
     }
  </script> 
```

我还有其他几个可以正常工作的测试函数，它们执行相对更复杂的操作。任何人都知道如何使用 AjaxPro 传递变量？也欢迎替代方法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T20:29:01.753

我知道这是一个旧的，但我一直在使用 AjaxPro，并且仍然在 .NET 4 中使用它——它仍然可以解决问题。

如果你想通过回调传递一个额外的变量并在结果中取回它，请在回调之后传递值并使用 res.context 来检索它。

像这样：

```
function CallSomething()
{
   DoServerSide.MethodName(arg1, arg2, CallbackFunction, ExtraVar);
}

function CallbackFunction(res)
{
  var result = res.value;
  var extra = res.context;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-20T00:11:50.493

使用 AjaxPro，您首先传递参数，然后将回调函数作为最后一个参数。如果您在此处使用匿名函数，则可以同时访问响应和原始值。它看起来像这样：

```
function doTest(x){
    Default2.testSomething(x, function(res){
        doTest_callback(res.value, x);
    });
}
function doTest_callback(resonseValue,originalValue){
    alert("response: " + responseValue);
    alert("original: " + originalValue);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T15:42:18.820

我使用那个框架已经有一段时间了（版本 6.9.22.2，所以情况可能发生了一些变化）——你看过[ASP.NET AJAX 框架](http://www.asp.net/ajax/)吗？我不知道 Michael 在这件事上做了多少工作——当然，他关于这件事的博客文章在 2007 年 7 月左右就枯竭了。

无论如何，如果我理解你的问题，你想：

1.  将值传递给您的服务器端方法
2.  在回调方法的某处使用该值

首先，要将变量传递给您的方法，它们不应该在回调函数的名称之前吗？

要检索回调中的初始值，我可以：

1.  将它们作为 JSON 返回对象的一部分返回
2.  将它们存储在两个函数范围之外的变量中

使用选项 2，您将拥有：

```
<a href="#" onclick="doTest(1);">test something</a>
<div id="temp" style="margin:15px 15px 0px 5px; padding:10px;"></div>
<script type="text/javascript">
   var initialValue;

   function doTest(x){
     initialValue= x;
     Default2.testSomething(x, doTest_callback)
   }

   function doTest_callback(res){
     alert(res.value);
     document.getElementById("temp").innerHTML = ">>>> " + initialValue + " <<<<"
   }
</script> 
```

这样做的主要缺点是，如果用户在您仍在处理第一个请求时使用不同的值触发您的“doTest”方法，那么在 doTest_callback 中查询它时，initialValue 的值很可能已经改变。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T17:27:19.327

唔。您是否注意到任何 JavaScript 错误？如果您安装了 Firefox 和[FireBug](http://getfirebug.com/)，JavaScript 控制台中是否有任何错误？

听起来组件生成的 JS 文件有问题。

# c# - 从 C# 应用程序打开 txt 文件

> ID：420484
> 
> 赞同：4
> 
> 时间：2009-01-07T14:29:22.603
> 
> 标签：c#, command-line, cmd, environment-variables, notepad

以下代码假设从我的 C# 应用程序打开 CMD 并打开文件 text.txt。

我试图将文件路径设置为环境变量，但是当记事本打开时，它会查找 %file%.txt 而不是 text.txt

知道为什么吗？

```
System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.EnableRaisingEvents=false;
        proc.StartInfo.EnvironmentVariables.Add("file", "c:\\text.txt");
        proc.StartInfo.UseShellExecute = false;
        proc.StartInfo.FileName = "notepad";

        proc.StartInfo.Arguments="%file%";
        proc.Start();
        proc.WaitForExit();

        Console.WriteLine(proc.ExitCode); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T14:50:31.437

如果您的目的是使用 .txt 文件启动编辑器（如问题标题所示），只需使用：

```
Process.Start("C:\\text.txt") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T14:35:46.413

简短的版本是我怀疑你将不得不更直接地传递 arg，即

```
 proc.StartInfo.Arguments = @"""c:\text.txt"""; 
```

虽然你可以设置环境变量（*在*进程中使用），但我认为你不能在进程启动期间使用它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T14:37:47.797

你想用 %file% 完成什么？notepad.exe 的命令行参数是您要打开的文件。你需要做这样的事情：

```
proc.StartInfo.Arguments = "c:\\text.txt"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T14:34:21.843

一个明显的问题是您将 UseShellExecute 设置为 false。这意味着您正在直接执行记事本，而无需通过命令 shell cmd.exe 传递。因此环境变量没有被扩展。

我不确定您要实现什么（为什么需要添加环境变量？），但以下方法可行：

```
 System.Diagnostics.Process proc = 
        new System.Diagnostics.Process(); 
    proc.EnableRaisingEvents = false; 
    proc.StartInfo.EnvironmentVariables.Add("file", "c:\\text.txt"); 
    proc.StartInfo.UseShellExecute = false; 
    proc.StartInfo.FileName = "cmd.exe";
    proc.StartInfo.Arguments = "/c notepad %file%"; 
    proc.Start(); 
    proc.WaitForExit(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T14:34:26.493

设置 UseShellExecute = true

这样它应该使用 cmd.exe 处理器来扩展 %file% 变量

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T14:37:55.567

尝试这个：

```
proc.StartInfo.Arguments = System.Environment.GetEnvironmentVariable("file"); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T14:41:26.680

也许它与 StartInfo.Arguments 的工作方式有关。如果你找不到更好的东西，这对我有用：

```
proc.StartInfo.FileName = "cmd";
proc.StartInfo.Arguments="/c notepad %my_file%"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T15:04:56.727

我敢打赌你需要设置**WorkingDirectory**才能让它工作。 **NOTEPAD.exe**通常位于**%SYSTEMROOT% (C:\windows)**但默认为**%SYSTEMROOT%\system32**。试试下面的。

```
System.Diagnostics.Process proc = new System.Diagnostics.Process();
        proc.EnableRaisingEvents=false;
        proc.StartInfo.WorkingDirectory = "%SYSTEMROOT%";
        proc.StartInfo.EnvironmentVariables.Add("file", "c:\\text.txt");
        proc.StartInfo.UseShellExecute = false;
        proc.StartInfo.FileName = "notepad";

        proc.StartInfo.Arguments="%file%";
        proc.Start();
        proc.WaitForExit();

        Console.WriteLine(proc.ExitCode); 
```

# coldfusion - 为什么 ColdFusion 的设计者决定从 1 而不是 0 索引数组？

> ID：420510
> 
> 赞同：14
> 
> 时间：2009-01-07T14:37:57.267
> 
> 标签：coldfusion, history

我真的很好奇这个，有谁知道他们为什么打破这个惯例？

谢谢， 夏兰

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-07T15:52:49.407

@Cory：你会惊讶地知道谁潜伏在 StackOverflow 上。:-)

你说得很对。CFML 的最初设计是允许非程序员构建复杂的 Web 应用程序。ColdFusion\CFML 是第一种专门为构建 Web 应用程序而设计的语言。早在 1995 年，Web 主要是静态 HTML，而典型的“Web 开发人员”并没有做太多的编程。该语言本身被设计为尽可能简单，这就是为什么它仍然是最快/最容易学习的语言之一。

它可能会导致一些混乱，尤其是当 ColdFusion 代码直接与 Java 或 .NET 交互时。然而，它只是成为那些“怪癖”之一。2000/2001 年，当 CF 被重新构建为 Java EE 应用程序时，该决定被重新考虑，但向后兼容性阻止了这种变化。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-07T14:47:21.677

有两种约定，一种适用于大多数编程语言，一种适用于大多数非程序员。他们可能是针对那些不从 0 开始计数的人。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-07T14:47:54.360

如果我不得不猜测，那是因为 ColdFusion 旨在吸引新手，基于 1 的数组可能更有意义 - 第一项是数字 1，第二项是数字 2，依此类推。

奇怪的是我们计算机科学家！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-07T14:49:05.027

好吧，除非我们有任何原始设计师，否则除了推测之外，做任何事情都很难。但是在前世使用过CF，我有一些想法。

如果您查看原始语言，它是为希望构建动态应用程序而没有太多复杂性的人设计的 RAD 类型开发。我仍然记得他们最终发布用户定义函数时的喜悦，因此我不必到处使用标签。

基于此，人们必须处理的语言的各个方面（例如数组）将变得更加“友好”，这是有道理的。对我来说，看到 array[0] 非常有意义。但对于尚未了解这一范式的新人来说，这没有任何意义。为什么要访问位置“0”的对象？

有趣的是，既然 CF 是后端的 Java，您实际上必须处理索引从 1 开始的情况，以及索引从 0 开始的情况。因此，通过尝试提供帮助，它们实际上增加了更多的复杂性语言已经成长。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-06-27T07:55:26.617

作为一个不同的旋转，让我们问为什么在某些语言中数组索引从零开始？对于计算离散对象（如数组元素），这没有什么意义，而且从人类的角度来看也不自然。

这最初似乎源于诸如 C 之类的语言（尽管我并不是说它首先出现在 C 中：我不知道，并且对此无关紧要），其中语言及其编程相当接近耦合到内存管理（`malloc`等）。一些 C 语言的自负与引擎盖下内存中的内容非常接近。变量就是一个例子：除了变量名，我们总是忙于变量所在（或*开始于*）的内存地址以及指针等。

所以我们来到 C 中的数组，它们的索引方式是，有一系列元素驻留在内存中，从数组变量的基本内存位置开始，每个元素都偏移数据类型的大小（例如：一个字符是一个字节，等等）。所以要在内存中找到数组中的每个元素，我们这样做：

```
arrayBaseAddress + (whichElementItIsInTheArray * sizeOfDataType) 
```

在用 C 语言做事时，确实会发现自己确实是这样思考的，因为它与计算机在后台必须执行的操作非常接近，以找到代码想要的值。

因此`whichElementItIsInTheArray`用于偏移内存地址（以 为单位 `sizeOfDataType`）。

显然，如果一个数组索引从 1 开始，它将在内存中偏移一个，出于所有意图和目的，在第一个元素实际驻留的位置之间`sizeOfDataType`浪费`sizeOfDataType`大量内存。`arrayBaseAddress`

有人可能会认为这无关紧要，但在过去所有这些都被实施的日子里，内存就像黄金一样：不能就这样浪费掉。所以有人可能会想“好吧，好吧，只是`whichElementItIsInTheArray`在引擎盖下偏移 -1，然后就可以完成了。然而，就像内存一样，时钟周期是黄金，所以与其浪费处理，这个想法是程序员只需要习惯一种不自然的计数方式。

因此，在这些情况*下，*有正当理由从索引 0 开始数组。

在我看来（现在这已进入编辑倾向）当随后的“花括号”语言出现（如 Java）时，无论它是否真的相关，它们只是效仿，因为“这就是它的完成方式”。而不是“这种方式有意义”。

另一方面，更现代的语言，以及更远离计算机内部运作的语言，有人停下来思考“我们为什么要这样做？”，以及“在这种语言及其预期用途的背景下，这是否使感觉？”。我同意这里的答案是——坚定地——“不”。在很多情况下，将数组索引偏移 -1 或只是忽略第零个元素的内存的资源浪费不再是相关的考虑因素。那么，纯粹出于遗留原因，为什么要让语言和程序员不得不将他们自然计算事物的方式抵消一分呢？没有正当理由这样做。

在 C 中，有一个数组元素`a[0]`。这是数组的*第一个*元素（不是“第零”元素），如果这是数组的全部范围，它的长度是*one*。所以这里的特殊行为是编程语言的一部分，而不是“在现实生活中”（我们大多数人居住的地方）计算/枚举事物的方式。那为什么还要坚持呢？

这里的一些人用“当我们出生时，我们不是一个，我们是零”来反驳这个“从哪里开始索引”的论点。这是真的，但那是测量一个连续的东西，并且不一样。所以与谈话无关。数组是离散项的集合，在测量离散项的数量（即：计数）时，我们从一个开始。

这如何增加对话？好吧，这并不多，但这是看待同一件事的不同方式。我想这是对这个概念的一种合理化/反应，有些人认为从 1 开始的数组索引在某种程度上是“错误的”。这没有错，从人类的角度来看，这比从零开始更正确。因此，让人类像人类一样编写代码，并让机器根据需要来理解它。基本上，我们从一开始就从零开始计算它们只是因为遗留技术限制，如果我们不再需要，就没有必要延续这种做法。

当然，所有“IMO”。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-07T14:52:56.363

数一数你一只手的手指数。你是从 0 开始计数还是从 1 开始计数？

与现实生活密切相关的抽象概念总是更容易理解和应用（例如：考虑物理“堆栈”，然后考虑抽象数据结构）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-14T14:00:56.410

从 0 开始数组的概念在 C 语言中得到普及。FORTRAN 和 COBOL 等较早的语言从 1 开始计算数组（在 COBOL 中实际上称为表）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-07T14:46:24.520

数组的起点没有约定。例如，大多数基础知识也从 1 开始。有些语言允许您在任何您喜欢的地方开始数组，或者允许数组索引是枚举等（例如 Ada）。C 在 0 处使用了 sting 的概念，许多语言都遵循了这一概念，但并非所有语言都如此。他们不这样做的一个原因是从 1 开始的数组更加直观。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T15:50:20.910

即使在 Java API 的编程世界中，也有一个有趣的例外，即从 0 开始的计数：JDBC API。它从 1 开始计数，这让每个第一次访问数据库的程序员都感到惊讶。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-01-26T20:08:23.983

也许这不仅仅是门外汉的事情......我认为大多数接近任何网络语言的人至少都在摆弄javascript（10,15年前也是如此）。基于 0 的索引并不那么陌生。

我喜欢以 1 开始索引/位置（对于字符串）的语言的一点是，您可以执行以下操作

```
<cfif find("c","cat")> 
```

评估`true`是否找到 c，它会。

而像 javascript 这样的基于 0 的语言

```
if ("cat".indexOf("c")) { 
```

评估为`false`，所以你需要说类似`if ("cat".indexOf("c") >= 0) {`

然而，语言之间的翻译是一个小麻烦，不能忘记，因为忘记这样做，或者忘记填充你的数组会导致数据翻译失败，而在两种风格之间切换会导致挫败感。

我认为，如果 Allaire 知道网络最终会在哪里以及客户端和服务器如何真正协同工作，我们就会拥有从 0 开始的索引。

# python - python安装在豹子上

> ID：420515
> 
> 赞同：1
> 
> 时间：2009-01-07T14:38:58.793
> 
> 标签：python, macos, osx-leopard, easy-install

我承认我完全被 python 安装弄傻了。有人可以帮助我如何安装模块

我想玩 PyGame、PyOpenGL 等。所以我安装了它们，但每次我输入“import pygame”时都会出现错误消息。

到目前为止，这是我的环境。

在 .bash_profile

```
PATH=${PATH}:/System/Library/Frameworks/Python.framework/Versions/Current/bin 
```

使用 easy_install PyOpenGL 放置了这个

```
/Library/Python/2.5/site-packages/PyOpenGL-3.0.0b8-py2.5.egg 
```

定位 pygame 模块

```
dchong:~ danielchong$ locate pygame
/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/py2app/recipes/pygame.py
/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/py2app/recipes/pygame.pyc

dchong:~ danielchong$ locate pyopengl
/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/py2app/recipes/pyopengl.py
/System/Library/Frameworks/Python.framework/Versions/2.5/Extras/lib/python/py2app/recipes/pyopengl.pyc 
```

当我运行 python

```
Python 2.5.1 (r251:54863, Jan 17 2008, 19:35:17) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import pygame
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named pygame 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T14:43:59.500

首先，我不是 OS X 上默认 python 安装的超级粉丝，主要是因为它通常是一个相当旧的版本。如果我使用 macports 包，我发现一切都会更好。

easy_install 似乎与 macports 包一起工作得更好，但也许这只是因为我懒得弄清楚默认安装的所有细微差别。

从我那里可以看到，看起来包的路径设置不正确。您确定您使用的是正确的 site-packages 目录吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T15:04:20.550

见[http://farmdev.com/thoughts/66/python-3-0-on-mac-os-x-alongside-2-6-2-5-etc-/](http://farmdev.com/thoughts/66/python-3-0-on-mac-os-x-alongside-2-6-2-5-etc-/)

# .net - 微软 HxS 文件格式

> ID：420524
> 
> 赞同：4
> 
> 时间：2009-01-07T14:40:24.343
> 
> 标签：.net, file-format

我想知道是否有人有 Help 2.0 HxS 文件的文件格式参考？

我见过一些 3rd-party 查看者，所以很明显有人遇到了对文件格式进行逆向工程的麻烦，但我无法通过 Google 追踪任何内容。

我有兴趣为 MSDN 文档创建更好的界面，并且只想访问 HTML。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-12T12:15:06.763

您可以使用 Microsoft [HxComp](http://msdn.microsoft.com/en-us/library/bb164592(VS.80).aspx)工具（Visual Studio SDK 的一部分）来反编译和编译 HxS 文件。然后我想这只是读取生成的*html*文件夹中的 HTML 文件并将它们转换为新格式的问题。似乎生成的所有其他文件夹都与样式/格式有关。现在转换可能不是微不足道的，因为输出文件仍然是 HTML（不幸的是不是像 XML 这样更直接的东西）并且包含一些脚本块和其他内容。您的程序需要了解文件的一般结构。不过，我不确定您想对输出 HTML 做多少工作，尽管我认为您无法以任何更简单的格式获得它（如果这是您想要的）。

最后，您的程序可能需要读取 HxC/HxT/HxK 文件（分别为集合定义、目录、索引）以找出文档的结构。幸运的是，这些只是普通的 XML 文件！

希望这足以让你开始......

**编辑**：您还可以看到非常相似的[这个问题/答案。](https://stackoverflow.com/questions/180365/how-do-you-open-a-hxs-file)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-12T19:44:47.820

根据到目前为止的答案，看起来您需要反转这些帮助文件的所有信息都在这里。我会提供更多帮助或建议，但看起来您已经掌握了它……获取 HTML 并不是难事。似乎能够找到您想要的内容并理解这些文件中包含的所有信息将是困难的部分。

如果您仍然需要帮助，请告诉我。我在各种 Microsoft 压缩/存档格式方面做了很多工作......

# php - PHP warnings cause script to halt on IIS running FastCGI

> ID：420525
> 
> 赞同：6
> 
> 时间：2009-01-07T14:40:34.267
> 
> 标签：php, iis-6, windows-server-2003, fastcgi

We are migrating to a new server running Windows 2003 and IIS 6\. When my PHP code runs, it has a warning on a particular line (which I'm expecting at the moment but will fix shortly). However, when it hits the warning, it immediately halts processing and returns a 500 error in the HTTP header. Normally, I would expect PHP to output the warning, but continue processing the script.

Is there something in the configuration for IIS, FastCGI, or PHP that would be returning 500 errors when PHP hits a warning?

**To clarify:** I don't want to suppress the warnings; I want them to display. I do not want the script to stop processing on warnings.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T15:23:11.107

Figured out the issue. `log_errors` in php.ini was set to `On`, but `error_log` was unset. This was causing PHP to stop everything. After setting `display_errors` to `on`, the warnings now display so I can see where things are breaking in the output.

This thread was helpful: [http://forums.iis.net/p/1146102/1856222.aspx#1856222](http://forums.iis.net/p/1146102/1856222.aspx#1856222)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T14:52:26.800

I don't know about IIS or FastCGI, but afaik php has no such option. You can however set `error_reporting` (in your `php.ini`) to

```
E_COMPILE_ERROR|E_RECOVERABLE_ERROR|E_ERROR|E_CORE_ERROR 
```

to make warnings go away.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T15:07:29.517

That depends very much on your PHP code as well, if you are doing something complicated within the code and an error occurs, web servers sometimes throw 500 errors. I would suggest you:

1.  Put an `@` on the line to suppress the error, i.e :

    $x=@my_function($y);

2.  See your web server logs for the exact error message you get, then post it here and perhaps we could offer you a better solution.

# sql-server-2005 - SQL 2005：我应该推出自己的日志传送吗？

> ID：420530
> 
> 赞同：4
> 
> 时间：2009-01-07T14:41:25.200
> 
> 标签：sql-server-2005

我正在研究使用日志传送来进行灾难恢复，但我收到了关于是使用内置的东西还是使用我自己的东西的混合消息。请问你推荐哪个，如果你喜欢自己滚动，内置的东西有什么问题？如果我要重新发明轮子，我不想犯同样的错误！（我们有工作组版。）提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-12T13:26:27.820

您的问题实际上有两个部分：

1.  原生日志传送是否足够好？

2.  如果不是，我应该使用谁的日志传送？

这是我的两分钱，但就像你已经发现的那样，很多都是基于意见。

关于第一个问题 - 本机日志传送适用于小型实现 - 例如，1-2 台服务器、少量数据库和全职 DBA。在这样的环境中，本地日志传送缺乏监控、警报和管理不是问题。如果它坏了，你不会出汗，因为它相对容易修复。什么时候会断？例如，如果有人在灾难恢复服务器上恢复之前意外删除了事务日志备份文件。（自动化流程时常发生。）

当您超过几台服务器时，缺乏管理自动化开始成为一个问题。您需要更好的自动电子邮件警报、日志传送延迟超过 X 分钟/小时时的警报、文件复制时间过长时的警报、更轻松地处理多个辅助服务器等。这就是人们转向替代解决方案的时候。

关于第二个问题 - 我会这样说。我为 Quest Software 工作，该公司是 SQL Server 备份和恢复产品 LiteSpeed 的制造商。我经常与使用我们的产品和其他产品（如 Idera SQLSafe 和 Red Gate SQL Backup）的数据库管理员交谈，以简化他们的备份管理。我们构建了 GUI 工具来自动化日志传送过程，为您提供一个漂亮的图形仪表板，准确显示您的瓶颈所在，并帮助确保当您的主数据中心出现故障时您的屁股被覆盖。我们出售很多许可证。:-)

如果您推出自己的脚本 - 当然可以 - 当您的数据中心出现故障时，您将完全孤身一人。您将没有可拨打的支持热线，没有工具可以帮助您，也无法告诉您的同事“打开此 GUI 并单击此处进行故障转移”。您将尝试在灾难中引导他们完成 T-SQL 脚本。手头有大量时间的专业 DBA 有时更喜欢编写自己的脚本，这确实为您提供了很大的控制权，但您必须确保有足够的时间来构建和测试它们，然后再将您的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T21:39:37.803

您是否考虑过镜像？这是一些[文档](http://www.microsoft.com/technet/prodtechnol/sql/2005/dbmirror.mspx)，以确定您是否可以这样做

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T14:49:50.347

如果您决定自己动手，[这里有一个很好的指南](http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1327798,00.html)。

我假设你走这条路是因为企业版太贵了？

如果您不需要“实时备份”，但真的只想要经常更新的备份，我认为这种方法很有意义。

* * *

**还有一件事：**

确保您定期验证您的备份策略是否有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T21:19:22.540

我很确定它在标准版中可用，因为我们正在发货，但我不确定 Workgroup 版 - 它相当精简。

我一直支持包解决方案，但主要是因为我更信任整个 MSFT 开发团队，而不是我自己，但这肯定是有代价的。其次，**您自己推出的任何解决方案都必须附带延迟通知，以便您立即知道它是否不起作用**- 我们只有多少次发现备份解决方案不起作用时有人需要备份吗？另外，诚实地考虑一下您设计和推出自己的解决方案需要多少时间，包括错误修复和维护——您真的可以更便宜地做到这一点吗？也许你可以，但也许不是。

此外，我们在使用 Workgroup 版本时遇到的一个问题是它一次只支持 5 个连接，并且如果您获得的用户多于该版本，它似乎会开始断开连接，因此我们不得不升级到 Standard。如果我们让它们无人看管甚至几秒钟，我们就会收到 ASP.NET 错误，即我们的连接已关闭，这给我们带来了各种问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T21:34:48.687

我希望这将接近您想要节省几美元的最后一个地方，特别是考虑到如果您搞砸了可能产生的后果。你宁愿你的工作上线吗？我什至不认为我会承认，如果我觉得我有机会做对吗？

你个人在这方面的好处是什么？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-05T22:06:16.503

我尝试了内置的日志传送，发现它存在一些实际问题，所以我开发了自己的。我在[这里](http://sqlblogcasts.com/blogs/davidwimbush/archive/2009/07/05/roll-your-own-log-shipping.aspx)写了博客。

PS：为了记录，您肯定会在 Workgoup 版本中获得日志传送。我不知道这个仅限企业的事情是从哪里开始的。

# java - 如何使用 JAXB 确保架构可扩展性

> ID：420533
> 
> 赞同：2
> 
> 时间：2009-01-07T14:41:35.667
> 
> 标签：java, web-services, jaxb

如果我在 Glassfish v2 下使用 JAXB 作为 Metro Web Services 的一部分，如何告诉 JAXB 添加：

```
 <xsd:any/> and <xsd:anyAttribute/> 
```

标记到我生成的复杂类型，这样如果我将来进行更改以向我的响应对象添加元素或属性，那么我当前的客户端不会中断。

JAXB 文档似乎有些欠缺。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T16:21:42.627

只需使用 java.lang.Object 类型。JAXB 默认会生成 xsd:any。我已经成功地从 web 服务方法返回了一个 org.w3c.dom.Node 实例，java.lang.Object 作为返回类型。我想象 xsd:anyAttribute 会有类似的东西 - 也许使用 Object 返回类型和 XmlAttribute JAXB 注释？

补充：下面的注解看起来像是达到了你的目标。两者都是 JAXB 2.0 规范的一部分。

@XmlAnyAttribute @XmlAnyElement

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-09T10:18:54.090

好的，这就是我的工作方式：

```
import java.util.List;
import java.util.Map;
import javax.xml.bind.annotation.XmlAnyAttribute;
import javax.xml.bind.annotation.XmlAnyElement;
import javax.xml.bind.annotation.XmlType;
import javax.xml.namespace.QName;
import org.w3c.dom.Element;

public class SchemaExtensible
{
    @XmlAnyElement(lax=true)
    private List<Element> otherElements;

    @XmlAnyAttribute
    private Map<QName,Object> otherAttributes;
} 
```

这并不理想，因为现在我必须为每个想要扩展的响应类扩展这个类（在某些情况下，这会阻止我从请求类扩展）。如果可以增强这 2 个方法和字段级别的注释以允许在类级别添加它们，那么他们可能只是说“将适当的标签添加到架构中，如果遇到就丢弃数据”，这将是甜蜜的。

架构片段最终看起来像这样：

```
<xs:complexType name="SchemaExtensible">
  <xs:sequence>
    <xs:any processContents="lax" namespace="##other" minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
    <xs:anyAttribute namespace="##other" processContents="skip"/>
 </xs:complexType> 
```

对我来说，只允许响应对象的这种可扩展性比 Web 服务版本控制更可取，因为它允许您根据需要一点一点地发展模式，而无需管理许多不同版本的麻烦，也无需担心任何现有客户端如果您将单个新属性或元素添加到响应对象，则会中断。

# c# - 如何在 WPF 中制作模板窗口？

> ID：420538
> 
> 赞同：20
> 
> 时间：2009-01-07T14:42:48.770
> 
> 标签：c#, wpf, wpf-controls

所以我正在构建一个应用程序，它将有很多窗口，所有窗口都具有相同的基本布局：

1.  一个主窗口
2.  顶部角落的徽标
3.  标题栏
4.  底部的状态显示
5.  窗口特定控件的区域。

目前我必须在每个窗口中重新创建这个结构。理想情况下，我希望将此布局编码在一个地方，也许是为了便于使用而定制的 Window 子类。有没有人有任何关于如何开始的线索，或者以前遇到过类似问题的经验？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-01-08T00:40:50.543

您可以创建一个以窗口为目标的新 ControlTemplate 来完成此操作，如下所示。

```
<ControlTemplate x:Key="WindowControlTemplate1" TargetType="{x:Type Window}">
    <Border 
        Background="{TemplateBinding Background}" 
        BorderBrush="{TemplateBinding BorderBrush}" 
        BorderThickness="{TemplateBinding BorderThickness}"
        >
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="0.93*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="0.21*"/>
                <ColumnDefinition Width="0.79*"/>
            </Grid.ColumnDefinitions>

            <ContentPresenter 
                Grid.ColumnSpan="2" 
                Grid.Row="1" 
                Content="{TemplateBinding Content}" 
                ContentTemplate="{TemplateBinding ContentTemplate}"
                />
            <ResizeGrip 
                HorizontalAlignment="Right" 
                x:Name="WindowResizeGrip" 
                VerticalAlignment="Bottom" 
                IsTabStop="False" 
                Visibility="Collapsed" 
                Grid.Column="1" 
                Grid.Row="2"
                />
            <TextBlock Text="My Logo" />
            <TextBlock Grid.Column="1" Text="My Title"/>
            <StatusBar Height="20" Grid.ColumnSpan="2" Grid.Row="2"/>
        </Grid>
    </Border>

    <ControlTemplate.Triggers>
        <MultiTrigger>
            <MultiTrigger.Conditions>
                <Condition Property="ResizeMode" Value="CanResizeWithGrip"/>
                <Condition Property="WindowState" Value="Normal"/>
            </MultiTrigger.Conditions>
            <Setter Property="Visibility" TargetName="WindowResizeGrip" Value="Visible"/>
        </MultiTrigger>
    </ControlTemplate.Triggers>
</ControlTemplate> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T16:08:11.687

如果您有足够的勇气进行重大的架构转变，您可以考虑来自 Microsoft 的 Patterns & Practices 人员的[CompositeWPF （以前代号为 Prism）。](http://www.microsoft.com/CompositeWPF)

您感兴趣的是能够在外壳（即窗口）中定义“区域”，然后使用视图来填充这些区域。它使用 Model-View-Presenter 模式来允许从模型中独立开发“视图”，而不是随着时间的推移可以轻松地重新定位，因为 shell 只定义区域并且不直接与放置在其中的内容耦合。主要是这有助于将外壳与视图和视图相互分离，并使单元测试更容易......等等等等。

尽管您的情况是 CompositeWPF 旨在解决的应用程序类型之一，但它是一个巨大的飞跃，并且一开始会减慢您的速度。

作为 CompositeWPF 的一部分，您将需要采用可能会使新手感到困惑的各种模式，例如 UnityContainer、控制反转、MVP（或模型/视图/视图模型）和依赖注入。

我记得当我第一次开始对示例应用程序感到困惑时，因为其中一些视图是如何创建的并不明显！统一容器将实例化对象并神奇地调用参数化构造函数。

CompositeWPF 是您问题的一种优雅的解决方案，但不是一个简单或直接的解决方案。在我的上一个项目中使用了 CompositeWPF，我打算在下一个适当的应用程序中再次使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T20:00:01.500

最简单的方法是为窗口特定控件创建 WPF 一个“页面”，并在主窗口中放置一个“框架”。您甚至可以通过这种方式创建一个不错的导航。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-01-07T14:48:29.647

你究竟为什么要使用“很多窗户”？为什么不只是一个带有选项卡控件的窗口？还是带有用户控件的单个窗口？

无论如何，要回答您的问题，用户控件是您想要获得您所描述的功能的一种方式。

创建一个新的 Window 类，并使其具有“Childrens”属性，该属性允许将对象嵌入到您希望“窗口特定控件”所在的停靠面板中。

启动新窗口时，实例化窗口类型和具有特定控件的用户控件，将用户控件添加到窗口的 Children 属性，然后显示窗口。您甚至可以绑定事件处理程序、DataContexts 以及目前没有的东西。

# c# - 有没有办法在 c# 中获取对调用对象的引用？

> ID：420541
> 
> 赞同：25
> 
> 时间：2009-01-07T14:43:37.520
> 
> 标签：c#, reflection

我想知道的是是否有可能（例如）遍历堆栈帧，检查每个调用对象以查看是否与接口匹配，如果是则从中提取一些数据。

是的，我知道这是不好的做法，我想知道这是否可能。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-07T14:50:08.553

不，没有 - 至少在不使用某种描述的分析/调试 API 的情况下不会。您可以遍历堆栈以找到调用*方法*，但需要注意的是它真的很慢并且由于 JIT 优化可能不准确。这不会告诉你调用*对象*是什么（如果确实有的话）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T15:02:22.333

如果你想得到类型，你可以试试这个：

`new StackFrame(1).GetMethod().DeclaringType`

正如 Jon 指出的那样，如果您遇到 JIT 优化，可能会出现问题。

至于从对象中获取数据，我认为这是不可能的。

# 编辑

只是为了详细说明优化问题，请使用以下代码：

```
class stackTest
{
    public void Test()
    {
        StackFrame sFrame = new StackFrame(1);
        if (sFrame == null)
        {
            Console.WriteLine("sFrame is null");
            return;
        }

        var method = sFrame.GetMethod();

        if (method == null)
        {
            Console.WriteLine("method is null");
            return;
        }
        Type declaringType = method.DeclaringType;
        Console.WriteLine(declaringType.Name);
    }

    public void Test2()
    {
        Console.WriteLine(new StackFrame(1).GetMethod().DeclaringType.Name);
    }
}

class Program
{
    static void Main(string[] args)
    {

        stackTest s = new stackTest();
        s.Test();
        Console.WriteLine("Doing Test2");
        s.Test2();
        Console.ReadLine();

    }
} 
```

我们应该让 Program 到控制台两次，当你在调试器中运行时，你会这样做。当您在发布模式下不使用调试器运行时，您将获得第一个 Test 函数的输出。这可能是因为内联比较复杂，但是，第二种方法会导致空引用异常。

这段代码的另一个危险是，在 MS 改进了 JIT 编译器，可能在 2.0 中工作的东西可能会在未来的版本中崩溃和烧毁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T14:49:18.087

看到这个问题：
[你可以使用反射来找到当前正在执行的方法的名称吗？](https://stackoverflow.com/questions/44153/can-you-use-reflection-to-find-the-name-of-the-currently-executing-method)

它不是重复的，但该问题的答案也将回答您的问题。

# internet-explorer - 在弹出窗口的 Web 应用程序上使用 IE 开发工具栏

> ID：420542
> 
> 赞同：16
> 
> 时间：2009-01-07T14:43:51.997
> 
> 标签：internet-explorer

我们正在开发仅 IE 的 Web 应用程序，它作为弹出窗口运行 - 没有任何工具栏。除了使用 IE 工具栏上的按钮之外，有没有办法调用 IE 开发人员的工具栏，因为它不可见？

谢谢！

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-11T17:35:47.347

是的。您需要关闭安全选项“允许网站打开没有地址或状态栏的窗口”。

在 IE9 中，菜单选项位于（相信在 8 中相同）：转到工具/Internet 选项/安全/（为您的站点选择正确的区域）/“其他”下的“自定义级别”在“允许网站打开没有地址的窗口或状态栏”，选择“禁用”。

现在，您的模态对话框中应该有一个地址栏，并且可以按 F12 打开 IE 开发人员工具栏。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T14:53:55.860

在窗口处于活动状态时按 CTRL-n。它将在非弹出窗口中打开相同的 URL，并带有工具栏。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T14:47:32.847

我遇到了同样的问题，我被迫修改我的代码，以便如果我们显示工具栏，我可以从配置文件中读取一个服务器变量。这样，当我们在 dev 或 qa 中时，我们会显示工具栏，但在生产中我们会隐藏它。

如果有人知道更好的方法，希望他们会加入。

# 编辑

哦，这对于模态对话框 window.showModalDialog （或者如果即支持它 window.open(page,"modal=yes") ）根本不起作用，并且 ctrl-n 也不起作用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T01:16:09.600

如果您可以使用 IE8 beta/RC，请尝试在弹出窗口中按 F12。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-06-28T10:31:32.267

复制弹出窗口的 url 链接并在单独的窗口或选项卡中打开

# .net - 将 Unity 容器信息导出到 xml 配置

> ID：420546
> 
> 赞同：1
> 
> 时间：2009-01-07T14:46:17.780
> 
> 标签：.net, dependency-injection, inversion-of-control, unity-container

在 Microsoft Unity 中，您可以从现有 XML 配置配置容器，但有没有相反的方法？从初始化的容器导出相应的 XML 配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T15:13:53.473

在“潜水”了 Unity 源代码之后，我的结论是现在不可能。

# sql-server - 如何限制 SQL 查询 CPU 使用率？

> ID：420554
> 
> 赞同：1
> 
> 时间：2009-01-07T14:47:21.990
> 
> 标签：sql-server, performance, sql-server-profiler

运行通过我的 ASPX 页面构建的大型 SQL 查询后，我看到 sql profiler 中列出了以下两项。

```
 Event Class            TextData                                           ApplicationName             CPU    Reads   Writes
    SQL:BatchCompleted     Select N'Testing Connection...'               SQLAgent - Alert Engine     1609     0 0
    SQL:BatchCompleted     EXECUTE msdb.sbo.sp_sqlagent_get_perf_counters SQLAgent - Alert Engine     1609     96    0 
```

这些 CPU 与查询相同，那么该查询实际上需要 1609*3=4827 吗？

case 也会发生同样的事情：

```
Audit Logout 
```

**我可以限制这个吗？**我正在使用 sql server 2005。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T18:43:10.563

首先，您在 SQL Profiler 中看到的一些内容是累积的，因此您不能总是将数字相加。例如，SPCompleted 事件将显示构成它的所有 SPStatementCompleted 事件的总时间。不确定这是否是您的问题。

提高 CPU 的唯一方法是实际*改进您的查询*。确保它使用索引，最小化读取的行数等。与经验丰富的 DBA 一起研究其中一些技术，或者[阅读一本书](https://stackoverflow.com/questions/244447/what-are-the-best-resources-for-getting-better-with-sql)。

我能想到的唯一其他缓解措施是限制运行查询*的 CPU 数量*（这称为*并行度*或**DOP**）。您可以在服务器级别设置它，或在查询级别指定它。如果您有一个多处理器服务器，这可以确保单个长时间运行的查询不会接管机器上的所有处理器——它将留下一个或多个处理器空闲给其他查询运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T14:51:36.240

SQL Server 2008 有一个新的“资源调控器”可能会有所帮助。我不知道您是否使用 SQL Server 2008，但您可能想看看[这里](http://technet.microsoft.com/en-us/library/bb933944.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T20:05:37.603

不，总共需要 1609 毫秒的 CPU。持续时间是多少？我打赌相同或更多，因为我怀疑 SQL 代理查询是否使用并行性。

您是否尝试使用 CPU 减少后台进程？如果是这样，那么您可以通过禁用 SQL 代理（例如，没有备份）并使用[开关 -x重新启动 SQL Server 来减少功能](http://msdn.microsoft.com/en-us/library/ms190737(SQL.90).aspx)

您也无法停止“审核注销”事件……这就是您断开或关闭连接时发生的情况。

但是，您是否正在最大化处理器？如果是这样，您需要区分用于查询的“用户”内存和用于分页或（上帝禁止）在 RAID 5 磁盘上生成奇偶校验的“系统”内存。

高 CPU 通常可以通过更多 RAM 和更好的磁盘配置来解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-24T09:59:02.237

这是连接字符串的问题。如果审核注销占用了您的 CPU 太多，请尝试使用不同的连接字符串。

# wcf - WCF：是否可以在双工通道中使用流模式？

> ID：420569
> 
> 赞同：4
> 
> 时间：2009-01-07T14:50:41.763
> 
> 标签：wcf, streaming, duplex

在 WCF 中，合约可以切换到流模式，以传输大消息。

在阅读和测试之后，在我看来，流模式不能用于双工通道（带有 OneWay 调用和回调接口的通道）。

是这样吗？双工和流媒体不能互相使用吗？或者有什么办法吗？

（我正在尝试将一个大文件上传到服务并使用回调报告进度）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-23T12:43:31.570

要将文件从客户端加载到服务器，可以使用以下代码：服务

```
 [ServiceContract(SessionMode=SessionMode.Required, CallbackContract=typeof(IFreeBoxServiceCallBack))]
    public interface IFreeBoxService
    {
        [OperationContract(IsOneWay = true)]
        void sendFile(byte[] bytes, int offset, int count);

        [OperationContract(IsOneWay = true)]
        void sendFileName(string fileName);
    }

[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode=ConcurrencyMode.Multiple)]
    public class FreeBoxService:IFreeBoxService
    {
        string path = "D:\\repository\\";
        string fileName = "";
        IFreeBoxServiceCallBack callBack = null;

        public FreeBoxService()
        {
            callBack = OperationContext.Current.GetCallbackChannel<IFreeBoxServiceCallBack>();
        }

        public void sendFileName(string fileName)
        {
            this.fileName = fileName;
        }

        public void sendFile(byte[] bytes, int offset, int count)
        {
            using (FileStream fileStream = new FileStream(path + fileName, FileMode.Append, FileAccess.Write))
            {
                fileStream.Write(bytes, offset, count);
                fileStream.Close();
                fileStream.Dispose();
            }
        }} 
```

客户：

```
private void sendFileToServer()
        {
            FileStream fs = new FileStream(fullName,FileMode.Open,FileAccess.Read);
            int bytesRead = 0;
            bytes = new byte[15000];

            proxy.sendFileName("someFile.xml");

            while ((bytesRead = fs.Read(bytes, 0, 15000))>0)
            {
                proxy.sendFile(bytes, 0, bytesRead);
            }
            fs.Close();
            fs.Dispose();
        } 
```

.config

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <services>
      <service name="FreeBoxServiceLib.FreeBoxService" behaviorConfiguration="MyServiceBehevior">
        <endpoint address="" contract="FreeBoxServiceLib.IFreeBoxService"
                  binding="netTcpBinding">
        </endpoint>
        <endpoint address="MEX" binding="mexTcpBinding" contract="IMetadataExchange"/>
        <host>
          <baseAddresses>
            <add baseAddress="net.tcp://localhost:8080/FreeBoxService/"/>
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="MyServiceBehevior">
          <serviceMetadata />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

传递字节数组总是更好。我想，不需要描述回调函数吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T16:44:25.370

出于好奇，我正要开始对您的问题进行一些测试，但随后 Google 向我透露了可能更好地回答您的问题的两个样本。

[此 CodeProject 示例](http://www.codeproject.com/KB/WCF/WCF_FileTransfer_Progress.aspx)显示了带有进度条的流式文件传输，而不使用双工通道。

[此示例](http://blogs.thinktecture.com/buddhike/archive/2007/09/06/414936.aspx)显示了更多相同的内容，但对流的处理方式有所不同。

此外，与 WCF 相关的所有事情的一个非常好的资源是[iDesgin.net](http://idesign.net/idesign/DesktopDefault.aspx?tabindex=5&tabid=11)。主要人物是 Juval Lowy，他写了一些关于 WCF 的最佳书籍。他们有几十个优秀的 WCF 示例可供您下载（尽管他们烦人地要求您提供每个示例的电子邮件地址）。更重要的是，他们还编写了一个 ServiceProcessEx 类，它极大地扩展了 ServiceProcess 的功能，尤其是在双工通道方面。（我不确定它是否与流媒体有很多关系……我还没有做过）。

希望其中一些对您有所帮助。

# c# - 类文件中的接口

> ID：420581
> 
> 赞同：1
> 
> 时间：2009-01-07T14:52:52.913
> 
> 标签：c#, interface

我的接口和该接口的具体实现是否应该分成两个单独的文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T14:55:14.953

如果您希望其他类实现该接口，这可能是一个好主意，即使只是为了清洁。任何查看您的界面的人都不应该每次都查看您的实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T14:54:19.340

如果只有一种实现：为什么是接口？

如果有多个实现：你把其他的放在哪里？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T14:57:25.480

如果不同的文件是指程序集中的不同 xxx.cs 文件，那么通常由于我自己的做法，我会说是的 - 但这取决于您使用的内部标准。如果您只是为自己编程，那么我会说这是一种很好的编码实践，它使所有内容保持干净且易于阅读。任何给定文件中的代码块越小，就越容易遵循（在合理范围内），显然你可以开始进入部分类，如果你不控制它，事情就会变得荒谬。

通常，我将我的项目保存在一个逻辑文件夹结构中，其中项目的一部分可能被分配到文件夹 DAL 或 BM 中，并且在其中我可能有许多逻辑命名的文件夹，每个文件夹都包含许多文件：一个接口，一个实现和任何特定于这些的辅助类。

但是，话虽如此，如果您在开发人员团队中工作，则应采用您的团队/内部最佳实践。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T15:10:36.607

单独的文件... FTW！您甚至可能希望根据代码的可扩展性创建单独的项目/程序集。至少它可能应该在一个单独的命名空间中。

**接口的全部意义在于使用该接口的代码不关心实现。** 因此，它们应该尽可能松散地关联，如果它们在同一个文件中，它们就不会如此。

但正如@balabaster 所说，这取决于您团队的实践（尽管它们并不总是“最佳实践”）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T15:12:04.000

是的，对于他们被称为的类`partial class`，看看[链接文本](http://msdn.microsoft.com/en-us/library/wa80x488(VS.80).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T15:15:09.000

一般的经验法则，是的。接口意味着它可以由其他类实现，当它们清楚地位于单独的文件中时，它更干净，更容易管理。

更重要的是，根据您的应用程序将采用的分离和隔离级别，您甚至可能希望**将您的接口放在它自己的项目**中。然后消费项目将引用接口项目，而不是每个承载该接口实现的程序集。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T15:18:11.303

是的，即使一个人给出了反驳论点，例如只有一种实现，或者他/她预见到很长一段时间内只有一种实现，或者他/她是唯一的用户/开发人员等。如果有多个实现，多个用户等，那么很明显您希望将它们保存在单独的文件中。那么为什么只在一种实现的情况下要区别对待呢？

# .net - 您会在新的企业开发中使用 EnterpriseServices 吗？

> ID：420597
> 
> 赞同：2
> 
> 时间：2009-01-07T14:55:59.040
> 
> 标签：.net, architecture, com+

您可能已经知道，托管代码（.NET 应用程序）可以通过[EnterpriseServices](http://msdn.microsoft.com/en-us/library/ms973484.aspx)使用 COM+ ，从而使*分布式事务*、*资源池*和*同步*等问题“更易于编程”，因为这些解决方案是作为应用程序的支持基础设施由 COM+ 提供的.

如果您的应用程序服务器驻留在 Windows 域中，COM+ *“通过提供线程池、对象池和即时对象激活自动使您的应用程序更具可扩展性。COM+ 还通过提供事务支持来帮助保护数据的完整性，甚至如果事务跨越网络上的多个数据库”* [（MS 源）](http://msdn.microsoft.com/en-us/library/ms686988(VS.85).aspx)

**因此，假设您必须在一家尚未**编写可重用的 COM+ 组件的公司中从头开始构建一个大型应用程序，因此您**不必**依赖于该技术。

这将是一个大系统，但你知道随着时间的推移它会变得更大。假设它类似于一个大型 ERP，分布式事务一直在进行。最后，假设系统核心将驻留在 Microsoft Windows 域中……通过 System.EnterpriseServices (ES) 采用 COM+ 成为一种选择。您必须将一些组件提供给第三方，您可以通过 WCF 来实现。

那么，知道这项技术是可用的并且您的环境是兼容的，您会使用它吗？

如果答案是否定的，COM+ 提供的所有服务，如[分布式事务](http://msdn.microsoft.com/en-us/library/system.transactions.aspx)，在完全托管的环境中是否可用且易于使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T15:56:45.437

如果您尚未与 COM 结婚，我可能不会使用 EnterpriseServices。今天早上我在想一个类似的问题，如果你有使用 COM 的经验，那么 EnterpriseServices 是天赐之物。展望未来，我会选择更现代的 (.NET) 基础架构，因为

1.  更容易找到开发人员（和培训）
2.  第 3 方软件将专注于 .NET
3.  MS PSS 更适用于 .NET 开发（我知道他们并没有逐步淘汰 COM 支持，但尝试调用两个不同的问题并确定响应时间）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T23:56:25.407

不。

当我们在 COM+ 中使用 .Net 时，我们遇到了无穷无尽的问题（主要是 COM+ 中无法解决的内存泄漏 - 由我们无法影响的各种 COM+ 互操作位引起）。我们更改为 WCFServices 公开业务层功能并将我们的分布式事务保持在最低限度（即事务在 WCF 服务内完成 - 您可以真正做到这一点的唯一方法）。使用内置的 .Net Transaction 东西可以处理我们处理事务所需的一切。

我会坚持使用各种 WCF 服务层来公开功能。在内部保留一层，并在与内部层通信的外部层上提供暴露的服务。它有点重，但似乎以后可以很好地扩展并提供您期望（和要求）的安全性。

# memory - 如何测试内存泄漏？

> ID：420599
> 
> 赞同：6
> 
> 时间：2009-01-07T14:56:16.823
> 
> 标签：memory, memory-leaks

我们有一个包含数百个可能的用户操作的应用程序，并考虑如何增强内存泄漏测试。

目前，它的发生方式是这样的：在手动测试软件时，如果出现我们的应用程序消耗太多内存，我们使用内存工具，查找原因并修复它。这是一个相当缓慢且效率不高的过程：问题发现较晚，并且依赖于开发人员的善意。

我们该如何改进呢？

*   在内部检查某些操作（例如“关闭文件”）是否恢复了一些内存并记录下来？
*   在我们的单元测试中断言内存状态（但这似乎是一项乏味的任务）？
*   不定期手动定期检查？
*   每次实施新的用户故事时都包括该检查吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T15:09:22.070

哪种语言？

我会使用 Valgrind 之类的工具，尝试完全运行程序并查看它报告的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T15:18:40.023

第一道防线：

*   针对开发人员的常见内存分配相关错误的检查列表
*   编码指南

第二道防线：

*   代码审查
*   静态代码分析（作为构建过程的一部分）
*   内存分析工具

如果您使用非托管语言（如 C/C++），您可以通过劫持内存管理函数有效地发现大部分内存泄漏。例如，您可以跟踪所有内存分配/释放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-08T00:13:21.927

在我看来，问题的核心与其说是发现内存泄漏，不如说是知道何时测试它们。你说你有很多用户操作，但你没有说什么用户操作*序列*是有意义的。如果您可以随机生成有意义的序列，我会强烈反对随机测试。在随机测试中，您将测量

*   代码覆盖率（使用`gcov`or [`valgrind`](http://valgrind.org)）
*   内存使用情况（带[`valgrind`](http://valgrind.org)）
*   覆盖用户操作本身

“覆盖用户操作”是指如下陈述：

*   对于每对动作 A 和 B，如果有一个有意义的动作序列，其中 A 紧跟 B，那么我们已经测试了这样的序列。

如果这不是真的，那么您可以询问 A 和 B 对中的哪一部分是正确的。

如果您有足够的 CPU 周期来负担它，那么在每次提交到源代码存储库之前或在夜间构建期间，您可能还会从运行[`valgrind`](http://valgrind.org)或其他内存检查工具中受益。

自动化！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T15:02:44.673

在我的公司，我们为我们的应用程序编写了一个无穷无尽的操作路径。java 垃圾收集器应该清理所有未使用的映射和列表之类的东西。所以我们让应用程序从无尽的动作路径开始，看看内存使用大小是否在增长。

检查哪些字段没有被删除，您可以使用 JProfiler for Java。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-29T17:25:37.963

用您的自定义版本替换***new***和*delete*并记录分配/解除分配的每一个行为。

一般来说（不是关于测试，而是从根源上解决问题），智能指针有助于避免这个问题。幸运的是，C++11 标准提供了新的方便的智能指针类（`shared_ptr`, `unique_ptr`）。

# c++ - 是否有一种直接的方法来反转三角形（上或下）矩阵？

> ID：420612
> 
> 赞同：13
> 
> 时间：2009-01-07T15:00:22.713
> 
> 标签：c++, math, matrix, linear-algebra, triangular

我正在尝试实现一些基本的线性代数运算，其中一个运算是三角（上和/或下）矩阵的求逆。有没有简单稳定的算法来做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-07T15:08:19.887

是的，使用[反向替换](http://en.wikipedia.org/wiki/Triangular_matrix#Forward_and_back_substitution)。矩阵求逆的标准算法是求其 LU 分解（分解为下三角矩阵和上三角矩阵），对三角块使用反代换，然后将结果组合得到原始矩阵的逆矩阵。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-29T12:49:46.287

如果可以，请不要颠倒它。它是数值线性代数的基本戒律之一。

将矩阵 L 本身保存在内存中并计算

```
inv(L)b
```

每当您需要使用 inv(L) 做其他事情时，使用反向替换。

请注意，用于反转它的惯用算法需要求解系统

```
inv(L)[1 0 0 ...],
inv(L)[0 1 0 ....],
inv(L)[0 0 1 ....]
```

依此类推，因此您会发现根本不反转它要容易得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-06T18:07:57.003

给定一个下三角矩阵 L，反向代换可以让您快速求解系统 L x = b 的任意右侧 b。

要反转 L，您可以求解此系统的右侧 e1=(1,0,...,0), e2=(0,1,...,0), ..., en=(0 ,0,...,1) 并将得到的解向量组合成一个（必须是下三角）矩阵。

如果您对封闭形式的解决方案感兴趣，则逆的对角元素是原始对角元素的逆元素，并且当您远离对角线时，逆元素的其余元素的公式会变得越来越复杂.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T15:09:13.333

如果您谈论的是单精度实数，请查看 LAPACK 例程[STRTRI](http://www.netlib.org/lapack/single/strtri.f)和[STRTI2](http://www.netlib.org/lapack/single/strti2.f)的源代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-01T18:53:16.357

作为三角矩阵 A 的 B 逆，您可以使用以下 MATLAB 代码：

```
n = size(A,1);
B = zeros(n);
for i=1:n
    B(i,i) = 1/A(i,i);
    for j=1:i-1
        s = 0;
        for k=j:i-1
            s = s + A(i,k)*B(k,j);
        end
        B(i,j) = -s*B(i,i);
    end
end 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-07T15:10:50.773

哇，这几乎是数值分析课程内容的一半。[标准算法会做，这里](http://www.alglib.net/matrixops/other/invtriangular.php)有一堆固定代码。这个问题和大多数其他常见数值分析问题的最终来源是[Numerical Recipes](http://www.nr.com/)。

# java - 从 Java 访问 .NET/dll 库/组件？

> ID：420617
> 
> 赞同：6
> 
> 时间：2009-01-07T15:01:16.517
> 
> 标签：java, .net

是否有从 .NET 到 Java 的廉价或免费网关？我正在寻找一些具有 C/C++ 和 .NET 驱动程序的数据采集硬件——我*真的*不想在 .NET 中进行任何编程。

更新：我还没有做我最初想做的事情，但我做了类似的事情，使用 JNA 从 DLL 封装一些函数，以便从 Java 控制 USB 硬件设备。（DLL 来自设备制造商）它工作得非常好。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T15:09:59.183

您也可以尝试使用[JNA](https://github.com/twall/jna)访问本机库。JNA 使 Java 程序可以轻松访问本机共享库（Windows 上的 DLL），而无需编写 Java 代码以外的任何内容——不需要 JNI 或本机代码。如果他们的 API 相当直接，这可能是阻力最小的路径。

请参阅他们调用一些本机代码（printf 和 GetSystemTime）的[入门指南。](https://github.com/twall/jna/blob/master/www/GettingStarted.md)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T15:04:24.857

嗯，有[JNBridge](http://www.jnbridge.com/index.htm)和[EZ JCom](http://www.ezjcom.com/dotnet.html)，只是来自谷歌搜索。

您也可以使用[IKVM](http://www.ikvm.net/)，这是一种略有不同的方法。

（有什么理由不想学习 .NET，出于兴趣？这是一个不错的平台，C# 是一门可爱的语言……）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T15:04:29.677

如果他们有驱动程序的 C++ 版本，那么您可以使用 JNI 围绕它编写一个包装器，然后在 Java 中加载它。JNI 可能有点痛苦，但它可以让你使用他们的驱动程序的 C++ 版本，如果你不想的话，根本不必处理 .Net。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T17:06:42.520

我偏爱使用 C# 深入研究的建议，因为它与 Java 非常相似。我这样做并使用 IKVM 来编译我最喜欢的 Java 库。到 .NET 程序集，并且您可以 [几乎] 启动所有核心 Java 运行时类，因此如果您厌倦了尝试找到正确的 C# 集合类型，您可以随时返回 java.util。（虽然没有通用集合。不知道为什么。）

根据您使用的平台，您也有多种免费 IDE 选择。对于 Windows，您可以免费获得 Visual Studio Express，但我也使用[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)。您还可以在 Linux 上获得 Mono IDE（我认为还有一些 Unix 版本？）。

如果您已经了解 Java，那么 C# 的学习曲线就会很浅。由于我仍然不明白的原因，我只炸掉了不知从何而来的地雷上的 1.5 个肢体，但解决方法很容易找到。最糟糕的事情是该死的开发人员文档，**因为**速度太慢了。我真的很怀念 JavaDoc 的活泼。不仅在线文档速度慢得令人难以置信，问题还因某人决定将类摘要、构造函数和方法/属性全部放在单独的页面上而变得更加复杂，因此它只需要很长时间。有人说要获取文档安装程序并在本地安装文档以稍微改善体验。我想这不是一个坏主意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T15:19:28.803

如果你有一个 Java 应用程序，那么其他人提到的 JNI 将是要走的路。你写了一些包装类，就是这样。

如果编写包装是一项太大的任务（取决于您必须包装的方法数量），请查看[SWIG](http://www.swig.org/ "痛饮")。我认为它会自动生成包装器，但我从未真正使用过它。

如果您想用 Java 语言编写代码，但不关心您的程序是否会在 JRE/JVM 上运行，那么您不妨使用 Microsoft J#。基本上，它编写的 Java 代码被编译为 .NET 字节码，并且可以使用驱动程序的 .NET 类以及现有的 Java 类。使用 J#，如果您现有的 Java 代码比 Java 1.4 更新，您将遇到问题，请查看如何解决这些[问题。](https://stackoverflow.com/questions/311599/how-to-use-generics-in-a-world-of-mixed-java-versions)

从那时起，您以后可以添加 J#、C# 或任何其他 .NET 语言的代码。但是，您不会轻易回到 JRE/JVM。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-31T19:31:08.523

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程间桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

# c# - 使用画笔和钢笔的指南

> ID：420620
> 
> 赞同：8
> 
> 时间：2009-01-07T15:02:24.470
> 
> 标签：c#, .net, gdi

制作 gdi 画笔和钢笔有多贵？我应该在添加需要的基础上创建它们并将它们包装在使用中以便快速处理它们，还是应该创建一个类似于 System.Drawing.Brushes 类的静态类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-07T18:40:36.013

IMO，它们足够高效，您通常不应该创建用于多个方法调用的长期实例，但效率低到您应该只在特定方法中创建每个实例一次，而不是每次创建一个新实例需要画一些东西。

换句话说，不要在类中存储用于在每次`OnPaint`调用时绘制文本的自定义画笔，也不要为在 OnPaint 调用中绘制的每一行文本创建一个新画笔。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T16:54:28.863

我在尝试使用静态画笔在负载下的 Web 应用程序中自定义绘制图像时遇到了异常。

我不知道技术原因，但我认为画笔和钢笔不是线程安全的，所以我会根据需要以线程安全的方式创建它们，并在该范围内处理它们，可能使用*using*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T18:29:41.650

对于我们可配置的 GUI，我们认为在绘制控件时我们会尝试将它们放在“使用”中（需要时重新创建），并认为如果需要我们会进行优化。

它不是必需的。

这是 WinCE 上的 WinForm，这通常意味着它擅长在桌面上显示可能稍微慢的东西（例如，反射在 WinCE 上感觉要昂贵得多）所以除非你在桌面上进行一些需要很多性能的疯狂图像处理，然后我认为您应该可以在需要时创建它们。

IIRC 使用画笔。GDI 中的集合可能是一种选择，因为这可以确保它们在最后被缓存和处理，尽管我不确定那里的线程安全。

# c# - 如何在 C# 中将日期转换为 MM/DD/YY 格式

> ID：420623
> 
> 赞同：30
> 
> 时间：2009-01-07T15:02:46.513
> 
> 标签：c#, date

在我的 Asp.net 网页中，我需要在其中一个文本框中显示今天的日期，所以在我的表单加载中，我编写了以下代码

```
textbox1.text = System.DateTime.Today.ToShortDateString(); 
```

这条线给了我像 1/7/09 这样的日期，但我想要像 01/07/09 这样的日期，无论如何我可以在 C# 中将此日期转换为 mm/dd/yy 格式吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-01-07T15:04:58.007

```
 DateTime.Today.ToString("MM/dd/yy") 
```

查看文档以获取[自定义日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)以获取更多信息。

（哦，我希望这个应用程序不适合其他文化。这种格式真的会让很多人感到困惑......老实说，我从来没有理解过整个月/日/年的事情。这看起来很奇怪就这样的规模而言，去“中/低/高”。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-06-09T09:34:25.983

> DateTime.Today.ToString("MM/dd/yy")
> 
> 查看文档以获取自定义日期和时间格式字符串以获取更多信息。
> 
> （哦，我希望这个应用程序不适合其他文化。这种格式真的会让很多人感到困惑......老实说，我从来没有理解过整个月/日/年的事情。这看起来很奇怪就这样的规模而言，去“中/低/高”。）

其他文化确实是个问题。例如，葡萄牙语中的代码返回 01-01-01 而不是 01/01/01。我也不明白为什么...

为了解决这个问题，我做了这样的事情：

```
 IFormatProvider yyyymmddFormat = new System.Globalization.CultureInfo(String.Empty, false);
        return date.ToString("MM/dd/yy", yyyymmddFormat); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T15:05:35.837

您是否尝试过以下方法？：

```
textbox1.text = System.DateTime.Today.ToString("MM/dd/yy"); 
```

请注意，未来 2 位数的年份可能会很糟糕......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T15:05:24.573

研究使用[`ToString()`](http://msdn.microsoft.com/en-us/library/zdtaw1bw.aspx)具有指定格式的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-26T12:51:02.717

看，在这里您只能通过传递格式字符串来获取日期。您可以根据您的要求获得不同的日期格式，如下所示：

```
DateTime.Now.ToString("M/d/yyyy"); 
```

> **结果：** “2016 年 9 月 1 日”

```
DateTime.Now.ToString("M-d-yyyy"); 
```

> **结果：** “9-1-2016”

```
DateTime.Now.ToString("yyyy-MM-dd"); 
```

> **结果：** “2016-09-01”

```
DateTime.Now.ToString("yyyy-MM-dd hh:mm:ss"); 
```

> **结果：** “2016-09-01 09:20:10”

有关更多详细信息，请查看[自定义日期和时间格式字符串的 MSDN 参考](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

# visual-studio - 在设计时在 Visual Studio .net 中绘制一条线

> ID：420625
> 
> 赞同：3
> 
> 时间：2009-01-07T15:04:03.377
> 
> 标签：visual-studio, visual-studio-2008, drawing

我公司的老板希望能够像在 Visual Basic 6.0 中一样在 Visual Studio.net 中画线。到目前为止，我发现的唯一方法是使用 system.drawing 的运行时方法，它当然只在运行时有效，对于他想做的事情不太实用。

是否有任何第三方控件（免费或其他）会在设计时给他一个按钮来绘制线条？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T15:09:30.713

使用[Visual Basic Powerpack](http://msdn.microsoft.com/en-us/vbasic/bb735936.aspx)（免费，来自 Microsoft，VB.Net 的制造商）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T06:20:28.713

最好的选择是绘制一个标签并将其属性设置如下：

1.  清除`Text`财产。
2.  将`Autosize`属性设置为`False`。
3.  按要求设置`BackColor`。
4.  将`Enabled`属性设置为`False`（否则可以在运行时移动）。
5.  使用`Shift`+ 箭头调整标签大小，例如`Shift`+`↑</kbd> to make a thin line and `Shift`+`←</kbd> to make a small line.``

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-09-01T08:51:31.490

在设计时绘制一条线的最佳方法是添加`PictureBox`并设置其属性，如下所示：

1.  `BackColor`- 选择你想要的颜色
2.  `Size`- 例如：宽度=1 高度=300

# visual-studio-2008 - 构建设置时如何删除只读属性

> ID：420631
> 
> 赞同：0
> 
> 时间：2009-01-07T15:04:42.470
> 
> 标签：visual-studio-2008, windows-mobile, installation

我的 Windows Mobile 应用程序的设置是使用 VS2008 创建的。它包含几个要复制到目标设备的数据文件。

这些文件在开发机器上是只读的（因为它们受源代码控制）。设置保留了只读属性，在这种情况下这是一个问题。

如何告诉安装项目放弃目标机器上这些文件的只读属性？

TIA,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T16:25:48.063

您*必须*在包装前将其移除。CABWIZ 只是将文件原样（属性和所有）放入 CAB。[INF 格式](http://msdn.microsoft.com/en-us/library/ms938406.aspx)没有为只读属性（或与此相关的任何属性）提供任何规定，只有复制的行为（覆盖、如果不存在则写入等）。

您可以添加预构建步骤并使用它来启动自定义应用程序（或批处理文件）以在打包之前更改属性（如果需要，还可以在构建后恢复它）。

# windows - 将 USB 驱动器映射到 Windows 中的 USB 集线器和端口

> ID：420638
> 
> 赞同：0
> 
> 时间：2009-01-07T15:05:51.423
> 
> 标签：windows, usb

映射所有 USB 驱动器插入位置的最佳方法是什么？理想情况下，我希望能够从根集线器递归开始并继续向下查找连接的 USB 驱动器以及它们连接到的端口（哪个物理 USB 插槽）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T17:56:16.367

在我的情况下，这是内核和用户模式代码的组合，使生活更轻松，但我确信您只能在用户模式下使用[SetupDiXXX](http://msdn.microsoft.com/en-us/library/ms792954.aspx) Api 完成所有这些操作。
我认为[USBView](http://msdn.microsoft.com/en-us/library/cc526325.aspx)应用程序使用不同的方法。[您可以在此处查看](http://msdn.microsoft.com/en-us/library/ms792954.aspx)USBView 实用程序 (C#) 的示例实现。
在一般的 google for USBView 中，您会发现很多相关信息。

# batch-file - 来自批处理文件的 http Web 请求

> ID：420646
> 
> 赞同：14
> 
> 时间：2009-01-07T15:07:40.887
> 
> 标签：batch-file, httpwebrequest

我需要从 Plesk 的 Task Scheduler 执行一个 http web 请求（使用 Windows/ASP.NET 上的共享主机；无论如何都没有 Powershell）。考虑过为此使用批处理文件。

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T15:12:18.710

看看[curl](http://curl.haxx.se/)。它是一个用于发出 Web 请求的跨平台命令行工具（类似于 wget，如果您以前使用过它）。您应该可以从批处理文件中调用它。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-04-03T12:47:52.060

没有外部二进制文件 - 只有内置的 Windows 功能 -> [https://github.com/npocmaka/batch.scripts/blob/master/hybrids/jscript/winhttpjs.bat](https://github.com/npocmaka/batch.scripts/blob/master/hybrids/jscript/winhttpjs.bat)

这是`jscript/.bat`混合的，可以像简单的蝙蝠一样被称为。示例用法（我使用[http://requestb.in/](http://requestb.in/)进行测试）：

```
 call winhttpjs.bat "http://requestb.in/xxxxxx" -method POST -header hdrs.txt -reportfile reportfile2.txt

  call winhttpjs.bat "http://requestb.in/xxxxxx" -method GET -header hdrs.txt -reportfile reportfile3.txt -saveTo c:\somezip.zip 

  call winhttpjs.bat "http://requestb.in/xxxxxx" -method POST -header hdrs.txt -reportfile reportfile2.txt -saveTo responsefile2 -ua "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36"  -body-file some.json 
```

头文件格式应如下所示（如果使用`-header`命令参数传递）：

```
Header-1: Value-1
ExampleHeader: Value2 
```

不支持多部分请求（尽管我计划添加这样的功能（某天））

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T15:10:32.957

您可以尝试使用[wget for Windows](http://gnuwin32.sourceforge.net/packages/wget.htm)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T15:11:45.327

你允许安装什么*？*[例如，您可以在 Windows](http://www.christopherlewis.com/WGet/WGetFiles.htm)上使用wget吗？或者编写一个 .NET 可执行文件来完成您使用 WebClient 或 HttpWebRequest 所需的一切？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T15:12:19.647

我建议[wget](http://www.gnu.org/software/wget/)或[curl](http://curl.haxx.se/download.html)。Win32 版本适用于两者。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T15:14:11.327

“curl”实用程序基本上是美妙的 libcurl 库的命令行包装器，它将处理几乎任何 http 请求或响应。它免费免费提供。

# c# - System.Windows.Forms.TextBox 中未显示 Unicode 字符

> ID：420659
> 
> 赞同：12
> 
> 时间：2009-01-07T15:10:38.260
> 
> 标签：c#, user-interface, forms, unicode, textbox

当我从 VisualStudio 调试器将这些字符剪切并粘贴到此处时，这些字符显示良好，但在调试器和我试图显示此文本的 TextBox 中，它只显示正方形。

3-9月受流向主要向季季影响，其流向为22个方向，南北达3个；10个方向为南向，10月至44月至2019年至东南节，或为\n月份向其流向\2节。 r\n注意\r\n附近有火山爆发的危险，航行时严加注意\r\n

我认为 TextBox 支持 Unicode 文本。知道如何让这个文本显示在我的应用程序中吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-07T15:25:25.003

您需要安装和使用支持这些字符的字体。并非所有字体都支持所有字符。[] 框字符是“不支持”的字体表示

默认情况下，文本框可能使用 MS Sans Serif，因此请将其更改为 Arial 或其他内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T17:27:35.927

我从使用 TextBox 更改为使用 RichTextBox，现在字符显示在 RichTextBox 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-25T06:54:52.357

我面临着类似的问题。

*正确读取文件*而不是`TextBox`控制是问题。

```
StreamReader reader = new StreamReader(inputFilePath, Encoding.Default, true) 
```

[**从这个**](https://stackoverflow.com/questions/592824/c-help-reading-foreign-characters-using-streamreader/592925#592925)复制。

对我有用，而且不用切换到`RichTextBox`.

# c# - 属性的内部设置器可以序列化吗？

> ID：420662
> 
> 赞同：30
> 
> 时间：2009-01-07T15:10:56.873
> 
> 标签：c#, .net, serialization

有没有办法在 C# 中使用内部设置器序列化属性？
我知道这可能有问题 - 但如果有办法 - 我想知道。

**例子：**

```
[Serializable]
public class Person
{
    public int ID { get; internal set; }
    public string Name { get; set; }
    public int Age { get; set; }
} 
```

**序列化*Person*类的实例的代码：**

```
Person person = new Person();
person.Age = 27;
person.Name = "Patrik";
person.ID = 1;

XmlSerializer serializer = new XmlSerializer(typeof(Person));
TextWriter writer = new StreamWriter(@"c:\test.xml");
serializer.Serialize(writer, person);
writer.Close(); 
```

**结果（缺少 ID 属性）：**

```
<?xml version="1.0" encoding="utf-8"?>
<Person xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Name>Patrik</Name>
  <Age>27</Age>
</Person> 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-01-07T15:23:35.940

如果是一个选项，[`DataContractSerializer`](https://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer(v=vs.110).aspx)（.NET 3.0）可以序列化非公共属性：

```
[DataContract]
public class Person
{
    [DataMember]
    public int ID { get; internal set; }
    [DataMember]
    public string Name { get; set; }
    [DataMember]
    public int Age { get; set; }
}
...
static void Main()
{
    Person person = new Person();
    person.Age = 27;
    person.Name = "Patrik";
    person.ID = 1;

    DataContractSerializer serializer = new DataContractSerializer(typeof(Person));
    XmlWriter writer = XmlWriter.Create(@"c:\test.xml");
    serializer.WriteObject(writer, person);
    writer.Close();
} 
```

使用 xml（重新格式化）：

```
<?xml version="1.0" encoding="utf-8"?>
<Person xmlns:i="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="http://schemas.datacontract.org/2004/07/">
    <Age>27</Age>
    <ID>1</ID>
    <Name>Patrik</Name>
</Person> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T15:26:35.250

您可以实现[IXmlSerializable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)，不幸的是，这否定了 XmlSerializer 最重要的好处（声明式控制序列化的能力）。[DataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)（基于 xml）和[BinaryFormatter](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.formatters.binary.binaryformatter.aspx)（基于二进制）可以用作 XmlSerializer 的替代品，它们各有优缺点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-07T15:18:04.500

我认为~~唯一的替代~~方法是实现[IXmlSerializable](http://www.developerfusion.com/code/4639/customize-xml-serialization-using-ixmlserializable/)并自己编写/解析对象 xml。

**编辑：**阅读评论后，[DataContractSerializer](http://www.danrigsby.com/blog/index.php/2008/03/07/xmlserializer-vs-datacontractserializer-serialization-in-wcf/)看起来很有趣；）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T15:20:07.273

如果您正在执行“默认”XML 序列化，它只会查看公共属性。实施`IXmlSerializable`将使您能够准确控制序列化的内容。如果您正在执行“标准”.NET 序列化，它将查看字段 - 而不是属性，因此您的对象仍将被正确序列化，而无需实现任何额外的接口。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T15:21:36.117

不是我不做一些工作就发现的。我相信这是因为`XmlSerializer`生成的那个使用反射来生成一个新类（它在一个新的程序集中，所以看不到`internal`成员/方法）。

使用[XmlSerialization PreCompilier](http://www.sellsbrothers.com/tools/#XmlSerializerPreCompiler)生成代码，然后根据您的目的将其修改为内部类可能会有一些里程，因此您可以执行以下操作：

```
XmlSerializer serializer = new MyPersonXmlSerializer(); 
```

另一种选择（可能更可取）是实现[IXmlSerializable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable(VS.80).aspx)，它将指导自动生成的代码做正确的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-10T22:43:16.137

这当然是可能的。我想用 来说明一个解决方案`XElement`，顺便说一句，我已经非常喜欢这个解决方案。如果您不想这样做，则不需要使用`XmlSerializer`or`DataContractSerializer`或任何类或属性注释，例如`[DataContract]`or `[Serializable]`。此外，下面的示例还显示了您如何在我的示例中进行交换`private set`，`internal set`顺便说一句：

```
using System;
using System.Linq;
using System.Xml.Linq;

namespace SerializationTesting
{

    class Person
    {

        // Notice how this object type uses private setters, something that the traditional XmlSerializer will complain about if you don't use a wrapper class..
        public string Name { get; private set; }
        public DateTime Birthday { get; private set; }
        public long HeightInMillimeters { get; private set; }
        public Gender Gendrality { get; private set; }

        // Generate a serialized XElement from this Person object.
        public XElement ToXElement()
        {
            return new XElement("person",
                new XAttribute("name", Name),
                new XAttribute("birthday", Birthday),
                new XAttribute("heightInMillimeters", HeightInMillimeters),
                new XAttribute("gendrality", (long)Gendrality)
            );
        }

        // Serialize this Person object to an XElement.
        public static Person FromXElement(XElement x)
        {
            return new Person(
                (string)x.Attribute("name"),
                (DateTime)x.Attribute("birthday"),
                (long)x.Attribute("heightInMillimeters"),
                (Gender)(long)x.Attribute("gendrality")
            );
        }

        public Person(string name, DateTime birthday, long heightInMillimeters, Gender gender)
        {
            Name = name;
            Birthday = birthday;
            HeightInMillimeters = heightInMillimeters;
            Gendrality = gender;
        }

        // You must override this in conjunction with overriding GetHashCode (below) if you want .NET collections (HashSet, List, etc.) to properly compare Person objects.
        public override bool Equals(object obj)
        {
            if (obj.GetType() == typeof(Person))
            {
                Person objAsPerson = (Person)obj;
                return Name == objAsPerson.Name && Birthday == objAsPerson.Birthday && HeightInMillimeters == objAsPerson.HeightInMillimeters && Gendrality == objAsPerson.Gendrality;
            }
            return false;
        }

        // You must override this in conjunction with overriding Equals (above) if you want .NET collections (HashSet, List, etc.) to properly compare Person objects.
        public override int GetHashCode()
        {
            return Name.GetHashCode() ^ Birthday.GetHashCode() ^ HeightInMillimeters.GetHashCode() ^ Gendrality.GetHashCode();
        }

        // This allows us to compare Person objects using the == operator.
        public static bool operator ==(Person a, Person b)
        {
            return a.Equals(b);
        }

        // This allows us to compate Person objects using the != operator.
        public static bool operator !=(Person a, Person b)
        {
            return !a.Equals(b);
        }
    }

    public enum Gender
    {
        Male,
        Female
    }

    class Program
    {
        static void Main(string[] args)
        {
            // Create first person (note how UTC time saves and loads properly when casting).
            Person personOne = new Person("Alexandru", DateTime.UtcNow, 1000, Gender.Male);
            // Save the first person to a local file on the hard disk.
            personOne.ToXElement().Save("PersonOne.dat");
            // Create second person (not using UTC time this time around).
            Person personTwo = new Person("Alexandria", DateTime.Now, 900, Gender.Female);
            // Save the second person to a local file on the hard disk.
            personTwo.ToXElement().Save("PersonTwo.dat");
            // Load the first person from a local file on the hard disk.
            XDocument personOneDocument = XDocument.Load("PersonOne.dat");
            Person personOneLoadedFromDocument = Person.FromXElement(personOneDocument.Elements().First());
            // Load the second person from a local file on the hard disk.
            XDocument personTwoDocument = XDocument.Load("PersonTwo.dat");
            Person personTwoLoadedFromDocument = Person.FromXElement(personTwoDocument.Elements().First());
            // Serialize the first person to a string and then load them from that string.
            string personOneString = personOne.ToXElement().ToString();
            XDocument personOneDocumentFromString = XDocument.Parse(personOneString);
            Person personOneLoadedFromDocumentFromString = Person.FromXElement(personOneDocumentFromString.Elements().First());
            // Check for equalities between persons (all outputs will be "true").
            Console.WriteLine(personOne.Equals(personOneLoadedFromDocument));
            Console.WriteLine(personTwo.Equals(personTwoLoadedFromDocument));
            Console.WriteLine(personOne == personOneLoadedFromDocument);
            Console.WriteLine(personTwo == personTwoLoadedFromDocument);
            Console.WriteLine(personOne != personTwo);
            Console.WriteLine(personOneLoadedFromDocument != personTwoLoadedFromDocument);
            Console.WriteLine(personOne.Equals(personOneLoadedFromDocumentFromString));
            Console.WriteLine("Press any key to exit.");
            Console.ReadKey();
        }
    }
} 
```

正如预期的那样，上面控制台应用程序中所有相等检查的输出将是`true`。这不会受到诸如必须跟踪编码或解析数据的方式之类的烦恼，因为它会为您完成所有这些，并且不会将您的类限制为像这样的公共设置`XmlSerializer`器。

# sharepoint - 以编程方式编辑 Sharepoint Wiki 内容

> ID：420671
> 
> 赞同：7
> 
> 时间：2009-01-07T15:12:57.133
> 
> 标签：sharepoint, sharepoint-wiki

我想以编程方式编辑我的 Sharepoint Wiki 内容。优点之一是自动将索引添加到 Wiki 环境。

有没有人能够做到这一点？语言无关紧要，但寻找脚本解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-01-27T17:03:45.770

是的。我推出了自己的 Metaweblog API，它以编程方式管理 Sharepoint 2010 和 2007 中的 wiki 页面。

我的消息来源：

*   [http://sites.google.com/site/sharepointwikiuploader/](http://sites.google.com/site/sharepointwikiuploader/)
*   [http://blogs.msdn.com/b/dwinter/archive/2008/06/28/migrating-wiki-pages-remotely-part-01.aspx](http://blogs.msdn.com/b/dwinter/archive/2008/06/28/migrating-wiki-pages-remotely-part-01.aspx)（第 1 - 6 部分）

SP 2010 和 2007 的服务代码几乎相同，但有一些注意事项：

*   在 2010 年，无需担心管理 wiki 链接标记（例如 [[brackets]]）。
*   在 2007 年，wiki 标记会根据您的请求进行转换，因此您必须在发回之前将其重新转换为 Wiki 标记。在回发时，您**不能**使用 UpdateListItems，您必须使用 Copy 服务。这是因为 UpdateListItems 将逃避任何 wiki 标记，从而有效地使您的努力毫无用处。
*   在我们的环境中，我们要求在签入之前填写*RecordType 。也许这是标准的？*如果您不设置此字段，您的页面将保持检出状态。因此，我有一个为 SP2007 设置此字段的条件。
*   2010 年，SP 在原始 WikiField 值中添加了一堆标记，如果缺少它可能会弄乱布局。我只是将它插入到 WLW 发布的值周围，然后在获取时将其删除。见下文。

我使用第一个链接中的复制服务来创建和更新 wiki 页面。在 2010 年，您*可以*使用 Lists 服务进行更新，但不能添加。我使用图像服务将图像自动上传到图片库。

这是一个将“ms-wikilinks”替换为 wiki 标记的函数：

**注意：**我使用 HTMLAgilityPack 以防返回的标记格式错误。您也可以使用 Regex 来执行此操作。我还使用 Microsoft Anti-XSS 4.1 库来清理标记。

**注意 2：**我的 UrlDecode 函数不依赖于 System.Web，[取自此处](http://csharpfeeds.com/post/10343/Html_and_Uri_String_Encoding_without_System.Web.aspx)。

```
/// <summary>
/// Sharepoint 2007 is mean and converts [[wiki links]] once the page is saved in the Sharepoint editor.
/// Luckily, each link is decorated with class="ms-wikilink" and follows some conventions.
/// </summary>
/// <param name="html"></param>
/// <returns></returns>
private static string ConvertAnchorsToWikiLinks(this string html)
{
    HtmlDocument htmlDoc = new HtmlDocument();

    htmlDoc.LoadHtml(html);

    var anchorTags = (from d in htmlDoc.DocumentNode.Descendants()
                      where d.Attributes.Contains("class") && d.Attributes["class"].Value == "ms-wikilink"
                      select d).ToList();

    foreach (var anchor in anchorTags)
    {
        // Two kinds of links
        // [[Direct Link]]
        // [[Wiki Page Name|Display Name]]
        var wikiPageFromLink = UrlDecode(anchor.Attributes["href"].Value.Split('/').LastOrDefault().Replace(".aspx", ""));
        var wikiPageFromText = anchor.InnerText;

        HtmlNode textNode = null;

        if (wikiPageFromLink == wikiPageFromText)
        {
            // Simple link
            textNode = HtmlTextNode.CreateNode("[[" + wikiPageFromText + "]]");
        }
        else
        {
            // Substituted link
            textNode = HtmlTextNode.CreateNode(String.Format("[[{0}|{1}]]", wikiPageFromLink, wikiPageFromText));
        }

        if (textNode != null)
        {
           anchor.ParentNode.ReplaceChild(textNode, anchor);
        }
    }

    return htmlDoc.DocumentNode.InnerHtml;
} 
```

剥离 SharePoint 的 HTML 的函数是：

```
/// <summary>
/// Gets editable HTML for a wiki page from a SharePoint HTML fragment.
/// </summary>
/// <param name="html"></param>
/// <returns></returns>
public static string GetHtmlEditableContent(string html)
{
    HtmlDocument htmlDoc = new HtmlDocument();

    htmlDoc.LoadHtml(html);

    HtmlNode divNode = (from d in htmlDoc.DocumentNode.Descendants()
                        where d.Attributes.Contains("class") && d.Attributes["class"].Value == "ms-rte-layoutszone-inner"
                        select d).FirstOrDefault();
    HtmlNode divNode2 = (from d in htmlDoc.DocumentNode.Descendants()
                         where d.Attributes.Contains("class") && d.Attributes["class"].Value.StartsWith("ExternalClass")
                         select d).FirstOrDefault();

    if (divNode != null)
    {
        // SP 2010
        return divNode.InnerHtml;
    }
    else if (divNode2 != null)
    {
        // SP 2007 or something else
        return divNode2.InnerHtml.ConvertAnchorsToWikiLinks();
    }
    else
    {
        return null;
    }
} 
```

最后，添加该标记的函数：

```
/// <summary>
/// Inserts SharePoint's wrapping HTML around wiki page content. Stupid!
/// </summary>
/// <param name="html"></param>
/// <returns></returns>
public static string InsertSharepointHtmlWrapper(string html, SharePointVersion spVersion)
{
    // No weird wrapper HTML for 2007
    if (spVersion == SharePointVersion.SP2007)
        return Microsoft.Security.Application.Sanitizer.GetSafeHtmlFragment(html);

    HtmlDocument htmlDoc = new HtmlDocument();

    htmlDoc.LoadHtml(@"<table id='layoutsTable' style='width:100%'>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class='ms-rte-layoutszone-outer' style='width:99.9%'>
                                            <div class='ms-rte-layoutszone-inner' style='min-height:60px;word-wrap:break-word'>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <span id='layoutsData' style='display:none'>false,false,1</span>");

    HtmlNode divNode = (from d in htmlDoc.DocumentNode.Descendants()
                        where d.Attributes.Contains("class") && d.Attributes["class"].Value == "ms-rte-layoutszone-inner"
                        select d).FirstOrDefault();

    divNode.InnerHtml = Microsoft.Security.Application.Sanitizer.GetSafeHtmlFragment(html);

    return htmlDoc.DocumentNode.InnerHtml;
} 
```

这很好用。

*   页面仍然保留最后修改和正确的用户
*   页面将保留其所有历史记录
*   页面更易于管理

我正在考虑发布我的 API，我认为对于我们这些想要更好地管理我们的 Sharepoint wiki 的人来说，这并不是很多代码。通过 WLW，我可以获得自动图像上传、更好的 HTML 编辑支持以及对 PreCode Snippet 等插件的支持。这很棒！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T16:01:51.247

SharePoint wiki 只是一种特殊类型的文档库。在尝试执行此操作时，我遇到了一些奇怪的事情。

SharePoint wiki 页面由一个模板文件和一个列表项组成。查看页面时，列表项中的字段将插入到模板文件中。因此，要更新 wiki 页面，您只需更新列表项中的正确字段。（顺便说一句，这也意味着您无法像获取普通文档库中的文件一样获取原始模板。到目前为止，我发现获取模板本身的唯一方法是通过 SharePoint Designer 下载它。）

此外，当您以编程方式访问列表项时，SharePoint 会自动呈现 wiki 内容。因此，我永远无法获取包含“[[My Link Name]]”的内容，例如，SharePoint 总是会返回呈现的 HTML，例如：

```
<A class=ms-wikilink href="/MyWikiLibrary/MyLinkName.aspx">My Link Name</A> 
```

不过，通过一些正则表达式工作，您应该能够将其转换回原始 wiki 内容。

# mysql - 如何在关系数据库中存储与 IPv6 兼容的地址

> ID：420680
> 
> 赞同：35
> 
> 时间：2009-01-07T15:14:34.273
> 
> 标签：mysql, ipv6

我怎么做？

目前，不会使用 IPv6，但我需要设计应用程序以使其支持 IPv6。有必要在 MySQL 数据库中存储 IP 地址和 CIDR 块（也是 BGP NLRI，但这是另一回事）。我一直为 IPv4 使用 INT + 为 masklen 使用 TINYINT，但 IPv6 是 128 位的。

什么方法最适合呢？`2xBIGINT`? `CHAR(16)`用于二进制存储？`CHAR(39)`用于文本存储？`8xSMALLINT`在专门的桌子上？

你会推荐什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-07T15:17:20.103

我不确定哪个是 MySQL 的*正确*答案，因为它本身还不支持 IPv6 地址格式（尽管“ [WL#798: MySQL IPv6 support](http://dev.mysql.com/worklog/task/?id=798) ”表明它将在 MySQL v6.0 中，当前文档不支持这一点）。

但是，在您提出的建议中，我建议使用 2 * BIGINT，但请确保它们是未签名的。在 IPv6 中的 /64 地址边界处有一种自然分割（因为 /64 是最小的网络块大小），这将与它很好地对齐。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-02-06T04:25:01.523

请注意，IPv6 地址的最大长度（包括范围标识符）为 46 个字节，由标准 C 标头中的 INET6_ADDRSTRLEN 定义。对于 Internet 使用，您应该能够忽略[区域标识符](http://en.wikipedia.org/wiki/IPv6_address#Link-local_addresses_and_zone_indices)（%10、#eth0 等），但请注意[getaddrinfo](http://en.wikipedia.org/wiki/Getaddrinfo)返回的结果何时比预期的要长。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T15:38:21.810

如果您倾向于 char(16)，请务必改用 binary(16)。binary(n) 没有排序规则或字符集的概念（或者更确切地说，它是一个字符集/排序规则为“二进制”的 char(n)）。mysql 中 char 的默认值是 latin1_swedish_ci，这意味着它将尝试对 latin1 中有效代码点的字节值进行不区分大小写的排序和比较，这将给你带来各种意想不到的问题。

另一种选择是使用十进制 (39, 0) 零填充无符号，效率不如两个 bigint（十进制在当前版本的 mysql 中每九位使用 4 个字节），但允许您将其全部保存在一列中并打印出来很好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T15:53:28.127

我会选择完整的 39 个字符的“标准”打印格式：-

```
“2001:0db8:85a3:0000:0000:8a2e:0370:7334”

```

40 带有一个空终止符。

这是 *nix 命令行工具使用的格式，并且，IPV6 地址的格式是 normaly(?) 报告的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T15:22:49.920

IP 地址是否将由二进制有意义的程序使用？还是存储文本表示会更好？此外，使用 IPv6，您一般不太可能使用地址，而更可能使用主机名。这是否相关部分取决于应用程序。CHAR(16) 将是一个糟糕的选择；char 用于字符数据，不喜欢 IPv6 地址中普遍存在的零字节大流。2 x BIGINT 会让人不舒服 - 两个字段实际上是一个字段（加上存储的值是大端还是小端？）。我使用了固定大小的 BINARY 类型，或者如果它不可用，则使用 blob 类型。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-18T05:27:45.037

我正在处理一个最长前缀匹配的项目，因此我将地址分成 4 个整数用于 IPv4 地址。它运作良好。我会将其扩展到 IPv6 地址。

# iis - 无法获取 IIS ISAPI Tomcat 连接器以将 BASIC 身份验证传递给 Tomcat

> ID：420693
> 
> 赞同：1
> 
> 时间：2009-01-07T15:18:16.983
> 
> 标签：iis, authentication, tomcat, isapi-redirect

我们已经使用 isapi_redirect.dll 成功地将 IIS 配置为前置 2 个 Tomcat 实例。它做的每件事都很聪明，我们很高兴。然而，现在我们使用其中一个 Tomcat 实例通过 AXIS 提供 Web 服务。这需要 BASIC Auth，并且 .NET 客户端失败。
+ .NET 客户端可以通过浏览到“site:8180”绕过 IIS，它们很好
+ Java 客户端可以访问 IIS，ISAPI 将它们通过，它们使用基本的身份验证就可以了。
+ 命中 IIS 的 .NET 客户端无法使用相同的 unpw 进行身份验证。

Fiddler 报告此会话：
HTTP/1.1 401 未经授权
日期：2009 年 1 月 7 日星期三 14:31:59 GMT
服务器：Microsoft-IIS/6.0
WWW-Authenticate：NTLM
X-Powered-By：ASP.NET
Pragma：No-cache
Cache -控制：无缓存
过期：星期三，1969 年 12 月 31 日 19:00:00 EST
WWW-认证：基本领域 =“每日控制模块”
内容类型：文本/html；字符集 = utf-8
内容长度：954
代理-支持：基于会话的身份验证

它启动了一个看起来像基本身份验证对话框的内容，但它不是要求我们针对 Daily Control Module 进行身份验证，而是要求我们针对 Windows 服务器进行身份验证。果然，IIS 服务器要求 N​​TLM 身份验证。如果我将整个服务器设置为使用基本身份验证，我会从 Fiddler 得到这个：
HTTP/1.1 401 Unauthorized
Content-Length: 1656
Content-Type: text/html
Server: Microsoft-IIS/6.0
WWW-Authenticate: Basic realm="serverName "
X-Powered-By：ASP.NET
日期：2009 年 1 月 7 日，星期三，格林威治标准时间 15:08:32

叹。Basic，但现在Basic Realm 更改为IIS 服务器。因此，如果我将整个服务器设置为针对基本领域、日常控制模块进行身份验证，那么我会得到：
HTTP/1.1 401 Unauthorized
Date: Wed, 07 Jan 2009 15:11:45 GMT
服务器：Microsoft-IIS/6.0
WWW-验证：基本领域 =“每日控制模块”
X-Powered-By：ASP.NET
编译指示：无缓存
缓存控制：无缓存
过期：星期三，1969 年 12 月 31 日 19:00:00 EST
WWW-验证：基本领域="日控模块"
Content-Type: text/html;charset=utf-8
Content-Length: 954

双 WWW-Auth 标头很奇怪，不是吗？无论如何，无论我是否指定域，使用直接针对 Tomcat 的相同 unpw 进行身份验证都会失败。

此时：
+ Anon 关闭
+ Integrated Windows Auth 关闭
+ Basic auth 开启，realm 配置为 Daily Control Module

感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T19:56:10.337

目录安全的配置是什么？

您确定只启用了基本身份验证吗？

另一点是。也许在 iis 级别您应该​​使用匿名身份验证。而tomcat负责实现基本身份验证交换？

问题的根源（来自您发布的标题）是.net 客户端认识到该站点支持 ntlm 身份验证。并尝试使用该协议进行身份验证。Java 客户端只是忽略了 ntlm 选项，因此它使用站点支持的任何其他身份验证协议。

您应确保未在站点和文件级别启用集成身份验证。

# asp.net - ASP.NET：谁能在Repeater或ListView控件中提供一些C#分页代码供我学习

> ID：420699
> 
> 赞同：-5
> 
> 时间：2009-01-07T15:20:12.750
> 
> 标签：asp.net

ASP.NET：谁能在Repeater 或ListView 控件中提供一些C# 分页代码供我学习。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T15:40:10.853

这是我创建的用于放入 GridView 的 PagerTemplate 的寻呼机控件。这不是最复杂的东西，但它显示了寻呼机控件如何“看到”它所属的网格并呈现下拉菜单以跳转到特定页面。

数据分页器.ascx

```
<%@ Control Language="C#" AutoEventWireup="true" EnableViewState="true" CodeFile="DataPager.ascx.cs" Inherits="Resources_Controls_DataPager" %>
<div>
    <div style="float:right;">
        <asp:ImageButton id="PageFirst"
            CommandName="Page"
            CommandArgument="First"
            runat="server" />
        <asp:ImageButton id="PagePrev"
            CommandName="Page"
            CommandArgument="Prev"
             runat="server" />
        &nbsp;&nbsp;Page 
        <asp:DropDownList id="pagesDropDown"
            autopostback="true"
            OnSelectedIndexChanged="pagesDropDown_SelectedIndexChanged"
            runat="server" />
        <asp:Label id="pageTotalPages" runat="server" />&nbsp;&nbsp;
        <asp:ImageButton ID="PageNext"
            CommandName="Page"
            CommandArgument="Next"
            runat="server" />
        <asp:ImageButton ID="PageLast"
            CommandName="Page"
            CommandArgument="Last"
            runat="server" />
    </div>
    <div style="clear:both;"></div>
</div> 
```

数据分页器.ascx.cs

```
public partial class Resources_Controls_DataPager : System.Web.UI.UserControl
{
    #region Property: ParentGrid
    public GridView ParentGrid
    {
        get { return (GridView)Parent.Parent.Parent.Parent; }
    }
    #endregion

    protected void Page_Load(object sender, EventArgs e)
    {
        FillPage();
    }

    public void FillPage()
    {
        if (ParentGrid != null && pagesDropDown.Items.Count == 0)
        {
            pagesDropDown.Items.Clear();
            for (int ix = 0; ix < ParentGrid.PageCount; ix++)
            {
                ListItem item = new ListItem((ix + 1).ToString());
                item.Selected = (ix == ParentGrid.PageIndex);
                pagesDropDown.Items.Add(item);
            }

            if (pagesDropDown.Items.Count == 0)
                pagesDropDown.Items.Add(new ListItem("0"));

            pageTotalPages.Text = String.Format("of {0}", ParentGrid.PageCount);
        }
    }

    protected void pagesDropDown_SelectedIndexChanged(object sender, EventArgs e)
    {
        ParentGrid.PageIndex = pagesDropDown.SelectedIndex;
    }
} 
```

# ruby-on-rails - capistrano 中的主服务器

> ID：420700
> 
> 赞同：2
> 
> 时间：2009-01-07T15:20:28.100
> 
> 标签：ruby-on-rails, ruby, capistrano

我在 capistrano 中有一项任务，其中只有在服务器被标记为主要服务器时，我只想运行一条线。是否有我可以在任务中引用的变量或方法？'基本的？' 或“主要”似乎不起作用。

我还尝试了类似于以下内容的方法：

```
after "deploy", "task1"
after "deploy", "task2"
after "deploy", "task3"

task :task1, :roles => :app do
  *code*
end

task :task2, :roles => :app, :only => {:primary => true} do
  *code for just primary server*
end

task :task3, :roles => :app do
  *more code*
end 
```

但即使这样似乎也不起作用（所有三个任务都在每台服务器上运行）。

我已经断断续续地工作了几天，但我的搜索没有运气。想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T19:21:56.973

我已经解决了这个问题，但它并不漂亮。我发现你需要在每个任务的基础上使用'primary => true'。查看代码，capistrano 似乎在任务运行之前生成了任务将在其上运行的服务器列表。

# javascript - 将图像复制粘贴到 JavaScript 富文本编辑器中

> ID：420701
> 
> 赞同：3
> 
> 时间：2009-01-07T15:21:23.323
> 
> 标签：javascript, image, richtextbox, gmail, copy-paste

我正在寻找一种富文本编辑器控件，该控件具有某种允许用户将图像复制粘贴到其中的方式，例如 Google Mail。我想我希望有某种方法可以将剪贴板上图像的二进制内容传达给浏览器（并且可能将这些内容存储在我可以访问的隐藏元素中）。如果您想不出包含此功能的富文本编辑器 - 谁能想到使用 JavaScript 完成此任务的方法？

这只需要在 IE5+ 上运行，但欢迎任何可能在 IE 上运行的解决方案。

任何帮助表示赞赏 - 如果这个问题的任何部分不清楚，请在评论中告诉我。

谢谢，

多姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-20T11:05:20.097

在 Google 邮件中发生的情况是，当您将图像拖入富文本区域时，它会收到带有图像 URL 的[拖放](https://developer.mozilla.org/En/DOM/Window.ondragdrop)事件。如果图像在线，您可以让 javascript 捕获它并插入`<img>`标签。如果图像在用户文件系统上，它将不起作用（出于安全原因）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-21T08:51:17.253

如果安装了[Chrome Frame](http://code.google.com/chrome/chromeframe/)，这将在 IE 中工作：http: [//strd6.com/2011/09/html5-javascript-pasting-image-data-in-chrome/](http://strd6.com/2011/09/html5-javascript-pasting-image-data-in-chrome/)

# django - 如何在 django 模板中向自定义模板过滤器添加多个参数？

> ID：420703
> 
> 赞同：101
> 
> 时间：2009-01-07T15:21:36.443
> 
> 标签：django, django-templates

## 这是我的自定义过滤器：

```
from django import template

register = template.Library()

@register.filter
def replace(value, cherche, remplacement):
    return value.replace(cherche, remplacement) 
```

## 以下是我尝试在模板文件中使用它导致错误的方法：

```
{{ attr.name|replace:"_"," " }}
{{ attr.name|replace:"_" " " }}
{{ attr.name|replace:"_":" " }}
{{ attr.name|replace:"cherche='_', remplacement=' '" }} 
```

我查看了[django 的文档](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/)和[书籍](http://www.djangobook.com/en/beta/chapter10/)，但只找到了使用单个参数的示例......甚至可能吗？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2009-01-08T02:35:47.863

这是可能的并且相当简单。

Django 只允许您的过滤器使用一个参数，但没有理由不能将所有参数放入一个字符串中，使用逗号分隔它们。

因此，例如，如果您想要一个过滤器来检查变量 X 是否在列表 [1,2,3,4] 中，您将需要一个看起来像这样的模板过滤器：

```
{% if X|is_in:"1,2,3,4" %} 
```

现在我们可以像这样创建你的模板标签：

```
from django.template import Library

register = Library()

def is_in(var, args):
    if args is None:
        return False
    arg_list = [arg.strip() for arg in args.split(',')]
    return var in arg_list

register.filter(is_in) 
```

创建 arg_list 的行是一个生成器表达式，它在所有逗号上拆分 args 字符串并调用 .strip() 以删除任何前导和尾随空格。

例如，如果第三个参数是一个 int 则只需执行以下操作：

```
arg_list[2] = int(arg_list[2]) 
```

或者，如果它们都是整数：

```
arg_list = [int(arg) for arg in args.split(',')] 
```

编辑：现在通过使用键、值对作为参数来专门回答您的问题，您可以使用 Django 用来解析 URL 中的查询字符串的同一类，这也有利于根据您的 settings.py 正确处理字符编码.

因此，与查询字符串一样，每个参数都由 '&' 分隔：

```
{{ attr.name|replace:"cherche=_&remplacement= " }} 
```

然后你的替换函数现在看起来像这样：

```
from django import template
from django.http import QueryDict

register = template.Library()

@register.filter
def replace(value, args):
    qs = QueryDict(args)
    if qs.has_key('cherche') and qs.has_key('remplacement'):
        return value.replace(qs['cherche'], qs['remplacement'])
    else:
        return value 
```

您可以加快速度，但可能会出现一些不正确的替换：

```
qs = QueryDict(args)
return value.replace(qs.get('cherche',''), qs.get('remplacement','')) 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-06-25T07:26:45.503

像这样很容易。

```
@register.filter(name='one_more')
def one_more(_1, _2):
    return _1, _2

def your_filter(_1_2, _3)
    _1, _2 = _1_2
    print "now you have three arguments, enjoy"

{{ _1|one_more:_2|your_filter:_3 }} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-01-24T14:34:52.333

将您的标签注册为简单标签，而不是过滤器。这些可以采用多个参数。调用它的语法会有些不同，但这只是语法糖的变化。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2020-04-07T10:56:42.347

**它比您想象的要简单** 您可以为此

使用***simple_tag 。***

```
from django import template
register = template.Library()

@register.simple_tag
def multiple_args_tag(a, b, c, d):
   #do your stuff
   return 
```

**在模板中**：

```
{% multiple_args_tag 'arg1' 'arg2' 'arg3' 'arg4' %} 
```

> 注意：不要忘记重新运行服务器。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-01-07T15:34:57.930

根据文档的[这一部分](http:////docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)是不可能的：

自定义过滤器只是接受一两个参数的 Python 函数：

*   变量（输入）的值——不一定是字符串。
*   参数的值——这可以有一个默认值，或者完全省略。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-07T15:32:35.423

此功能已在 2013 年 Django 的 Trac 中标记为 WONTFIX：http: [//code.djangoproject.com/ticket/1199](http://code.djangoproject.com/ticket/1199)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-04-08T13:16:58.760

**<我的站点>/globaltags/replace.py**

```
from django.template import Library

import re

register = Library()

def search(value, search):
    return re.sub(search, '#f4x@SgXXmS', value)

def replace(value, replace):
    return re.sub('#f4x@SgXXmS', replace, value)

register.filter(search)
register.filter(replace) 
```

**在模板中：**

```
{{ "saniel"|search:"s"|replace:"d" }} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-09-28T07:52:03.110

你可以简单地这样做：

```
{% assign find_total_issued = dailysalesreport | find: "TotalIssued":"13" %}

public static List<object> Find(object collection, string column, string value) 
```

它将到达目的地，因为函数的抽象是`sjare`。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-03-13T20:08:44.317

这是一个坏主意，但有效：

```
{{ xml|input_by_xpath:"{'type':'radio','xpath':'//result/value'}" }} 
```

和

```
@register.filter
def input_by_xpath(device, args): 
    args = eval(args)
    ...
    result = "<input type=\"%s\" value=\"%s\" name=\"%s\"/>"%(args['type'],value,args['xpath'])
    return mark_safe(result) 
```

# c# - 将错误直接从应用程序记录到 FogBugz

> ID：420704
> 
> 赞同：0
> 
> 时间：2009-01-07T15:21:37.037
> 
> 标签：c#, wpf, bug-tracking, fogbugz

我有几个 WPF 应用程序，我希望用户能够将*这些应用程序中的错误直接*记录到我的 FogBugz 数据库中。有什么办法可以做到这一点？另外，我将如何做到这一点，以便当他们的案件得到解决时，应用程序会告诉他们这件事？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T15:26:47.400

我建议使用[FogBugz API ，但是您可以使用](http://www.fogcreek.com/FogBugz/docs/60/topics/advanced/API.html)[ScoutSubmit](http://www.fogcreek.com/FogBugz/docs/60/topics/customers/BugzScout.html)机制 FogBugz执行相同的操作，该机制允许应用程序在 API 存在之前将崩溃数据发布到 FogBugz。

无论哪种方式，如果您让用户提供他们的电子邮件地址，那么您使用 FogBugz 的团队可以在他们解决案例时向他们发送便条。如果您使用API​​，那么您可以定期查询案例的状态以查看是否已解决。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T15:35:56.337

您可以打开一个带有显示 FogBugz 的 WebBrowser WPF 控件的窗口。

# mysql - SQL Server / MySQL / Access - 以低效的方式加速插入许多行

> ID：420705
> 
> 赞同：5
> 
> 时间：2009-01-07T15:22:36.693
> 
> 标签：mysql, sql-server, ms-access

**设置**

我必须在 SQL Server 2000/2005、MySQL 或 Access 中插入几百万行。不幸的是，我没有一种简单的方法来使用批量插入或 BCP 或任何其他普通人会做的方式。插入将发生在一个特定的数据库上，但该代码需要与 db 无关——所以我不能进行批量复制、SELECT INTO 或 BCP。但是，我可以在插入之前和之后运行特定查询，具体取决于我要导入的数据库。

例如。

```
If IsSqlServer() Then
    DisableTransactionLogging();
ElseIf IsMySQL() Then
    DisableMySQLIndices();
End If

... do inserts ...

If IsSqlServer() Then
    EnableTransactionLogging();
ElseIf IsMySQL() Then
    EnableMySQLIndices();
End If 
```

**问题**

我可以对 SQL Server 做任何有趣的事情来加速这些插入吗？

例如，我可以发出一个命令来告诉 SQL Server，“嘿，不要费心在事务日志中记录这些事务”。

或者我可以说，“嘿，我有一百万行进来了，所以在我完全完成之前不要更新你的索引”。

```
ALTER INDEX [IX_TableIndex] ON Table DISABLE
     ... inserts
ALTER INDEX [IX_TableIndex] ON Table REBUILD 
```

（注意：以上索引禁用仅适用于 2005，不适用于 2000。如果您知道在 2000 上执行此操作的方法，则可以加分）。

MySQL 和 Access 呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T02:56:17.853

这里会影响性能的最重要的事情是（听起来像）您正在对数据库执行一百万个不同的 INSERT。每个 INSERT 都被视为单个操作。如果您可以将其作为单个操作执行，那么您几乎可以肯定会获得巨大的性能提升。

MySQL 和 SQL Server 都支持没有表名的常量表达式的“选择”，所以这应该作为一个语句工作：

```
INSERT INTO MyTable(ID, name)
SELECT 1, 'Fred'
UNION ALL SELECT 2, 'Wilma'
UNION ALL SELECT 3, 'Barney'
UNION ALL SELECT 4, 'Betty' 
```

我不清楚 Access 是否支持这一点，没有 Access 可用。但是，据我所知，Access 确实支持 SELECT 中的常量，并且您可以将上述内容强制转换为 ANSI SQL-92（所有 3 个引擎都应该支持；它与您的“数据库不可知论”一样接近）会得到）只需添加

```
FROM OneRowTable 
```

到每个单独的 SELECT 的末尾，其中“OneRowTable”是一个只有一行虚拟数据的表。

这应该让您在远少于一百万条 INSERT 语句中插入一百万行数据——并且诸如索引重新洗牌之类的事情将只完成一次，而不是一百万次。在那之后，您可能对其他优化的需求要少得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T15:40:18.857

这是一个常规过程还是一次性事件？

过去，我只是编写了当前索引的脚本，删除它们，插入行，然后重新添加索引。

SQL Management Studio 可以从右键菜单中编写索引...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T15:29:46.070

对于 SQL Server：

1.  您可以将恢复模式设置为“简单”，这样您的事务日志将保持较小。之后不要忘记退后。
2.  禁用索引实际上是一个好主意。这将适用于 SQL 2005，而不适用于 SQL Server 2000。

    更改 [TABLE_NAME] 上的索引 [INDEX_NAME] 禁用

并启用

```
alter index [INDEX_NAME] on [TABLE_NAME] rebuild 
```

然后一一插入行。你必须要有耐心，但至少它会更快一些。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T15:31:25.987

如果这是一次性的事情（或者它经常发生足以证明自动化的合理性），还要考虑删除/禁用所有索引，然后在插入完成时再次添加/重新启用它们

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T16:17:06.473

将恢复模式设置为简单的问题在于它会影响同时输入数据的任何其他用户，因此会使他们的更改无法恢复。

Samre 禁用索引的事情，这对每个人都禁用，并且可能使数据库运行得比蛞蝓慢。

建议您批量运行导入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T21:56:58.847

如果这不是需要非常快速读取的内容，您可以在 MySQL 上的表中执行[“插入延迟” 。](http://dev.mysql.com/doc/refman/5.1/en/insert-delayed.html)这允许您的代码继续运行，而无需等待插入实际发生。这确实有一些限制，但如果您主要关心的是让程序快速完成，这可能会有所帮助。请注意，有很多情况可能无法按预期运行。检查[文档](http://dev.mysql.com/doc/refman/5.1/en/insert-delayed.html)。

不过，我不知道此功能是否适用于 Access 或 MS SQL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T22:01:58.117

您是否考虑过使用工厂模式？我猜你正在为此编写代码，所以如果使用工厂模式，你可以编写一个返回具体“IDataInserter”类型类的工厂，该类可以完成这项工作。

这仍然允许您与数据无关，并为每种类型的数据库获得最快的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T23:15:00.530

SQL Server 2000/2005、MySQL 和 Access 都可以直接从 tab / cr 文本文件加载，它们只是有不同的命令来完成。如果您有 case 语句来确定您要导入哪个数据库，只需弄清楚他们对导入文本文件的偏好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-10T02:29:54.590

您可以使用 DTS (2000) 或 SSIS (2005) 构建一个包来执行此操作吗？DTS 和 SSIS 都可以从同一个源中提取并通过管道输出到不同的潜在目的地。如果可以，请选择 SSIS。那里有很多好的、快速的技术以及嵌入 IsSQLServer、IsMySQL 等逻辑的功能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-02T17:14:35.860

值得考虑[将您的刀片分成更小的批次](http://database-programmer.blogspot.com/2008/06/database-performance-1-huge-inserts.html)；具有大量查询的单个事务将很慢。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-01-07T15:38:04.790

您可以考虑在批量插入期间使用 SQL 的批量日志恢复模型。

[http://msdn.microsoft.com/en-us/library/ms190422(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms190422(SQL.90).aspx)

[http://msdn.microsoft.com/en-us/library/ms190203(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms190203(SQL.90).aspx)

您还可以在插入期间禁用目标表上的索引。

# c# - linq2sql：无法使用已在使用的键添加实体

> ID：420718
> 
> 赞同：17
> 
> 时间：2009-01-07T15:26:49.350
> 
> 标签：c#, linq-to-sql

我有一个 linq2sql 设置，其中从客户端发送对象（通过 flolinefx 灵活）并将它们附加到一个新的数据上下文，如下所示：

我还有一个在整个会话中使用的“全局”数据上下文。

```
 public static void Update(Enquiry enquiry)
    {
        OffertaDataContext db = new OffertaDataContext();

        db.Enquiries.Attach(enquiry);
        db.Refresh(RefreshMode.KeepCurrentValues, enquiry);

        db.SubmitChanges();
    } 
```

这种方法通常可以正常工作，但过了一段时间我收到错误“无法添加具有已使用密钥的实体”。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2011-02-19T17:47:03.787

我收到此错误，这是因为我忘记将数据库中的主键字段设置为“身份规范”（自动增量）。当我改变这个时，我很好。嗬！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T17:16:12.500

我认为如果您是已加载`Attach`的*实体*，则会发生此错误。`DataContext`

导致错误的代码与您在此处显示的完全一样吗？创建新的后`OffertaDataContext`，您是否在 ? 之前查询任何内容`Attach`？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-02-04T20:17:30.347

这可能不是你的问题（我不能说），但它是我的，当人们用谷歌搜索它可能会帮助其他人。如果您没有使用内置的 Linq-to-SQL 设计器或 SQLMetal 东西来生成 Linq-to-SQL 类，或者如果您忘记将 ID 列设置为 IDENTITY，则您的列上可能缺少属性名为“IsDbGenerated”的属性。确保您的列属性看起来像这样：

```
<Column(Name:="ID", DbType:="Int NOT NULL IDENTITY", CanBeNull:=False, IsPrimaryKey:=True, IsDbGenerated:=True)> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-12T12:58:12.703

如果您一次插入多个实体，您可能只是尝试将重复的实体插入到当前数据上下文中。我知道这太简单了，但它只是发生在我自己身上。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-07T17:08:52.687

您是否尝试在使用 0 键创建 LinqEntities 的情况下一次性添加多个新对象？

过去，当我尝试将项目添加到页面上的表格中时，我遇到过这个问题，然后当我尝试删除或更新这些项目时，倍数的键为 0。所以显然它不知道该怎么做我的要求...

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T17:14:41.130

这就是我一直在做的来解决这个错误。基本上，您可以根据主键找到该行在数据库中的位置。如果它不存在，则插入它。否则，您从数据库中获取版本并更新所有必要的字段。

```
public static void Update(Enquiry enquiry)
{
    JobsDataContext db = new JobsDataContext();

    var enquiries = from e in db.Enquiries
                    where e.PKID == enquiry.PKID
                    select e;

    if (enquiries.Count() < 1)
    {
        db.Enquiries.InsertOnSubmit(enquiry);
    }
    else
    {
        Enquiry updateEnquiry = enquiries.Single();

        updateEnquiry.LengthMm = enquiry.LengthMm;
        updateEnquiry.ShippedQty = enquiry.ShippedQty;
        updateEnquiry.StatusCode = enquiry.StatusCode;
    }

    db.SubmitChanges();
} 
```

如果您一直对数据库模式进行更新，这可能会变得乏味，因为您必须回到这里来更新代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-14T12:43:35.363

即使您的 TEntity（此处为区域）ID 是标识符列，也请尝试此操作；就这样，您的 SP 或模型没有任何变化：

```
public void InitForm()
{
    bnsEntity.DataSource = CacheManagement.cachedAreas;
    newID = CacheManagement.cachedAreas.LastOrDefault().areaID + 1;
    grdEntity.DataSource = bnsEntity;
}

private void tsbNew_Click(object sender, EventArgs e)
{
    var newArea = new Area();
    newArea.areaID = (byte)newID++;
    dataContext.GetTable<Area>().InsertOnSubmit(newArea);
    bnsEntity.Add(newArea);
    grdEntity.MoveToNewRecord();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-08-20T12:15:47.503

我对 Noah 有类似的方法，但我使用存储过程来验证是否存在具有该 PK 的记录，这样实体不会加载到上下文中，更新代码只涉及两行代码，不需要将来当您从表中添加/删除字段时发生更改，仅当表的 PK 更改时才需要更改 SP：

```
bool existe = Convert.ToBoolean(dbc.spSConfigReportesPeriodicos(configReportesPeriodicos.CodigoCliente));

if (existe)
{
    dbc.ConfigReportesPeriodicos.Attach(configReportesPeriodicos);
    dbc.Refresh(RefreshMode.KeepCurrentValues, configReportesPeriodicos);
}
else
{
    dbc.ConfigReportesPeriodicos.InsertOnSubmit(configReportesPeriodicos);
}
dbc.SubmitChanges(); 
```

这是存储过程：

```
ALTER PROCEDURE dbo.spSConfigReportesPeriodicos
(
    @codigoCliente int
)
AS

IF EXISTS(SELECT 1 FROM dbo.ConfigReportesPeriodicos WHERE CodigoCliente = @codigoCliente)
    RETURN 1
ELSE
    RETURN 0

RETURN 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-01T06:46:33.387

你不应该做那种检查来确定你是否需要使用更新或插入——这是 Linq 要做的！

这是我正在处理的项目中的一个示例（对不起，它在 VB.Net 中:)），它演示了如何解决这个问题。

该代码尚未优化且非常丑陋 - 但它明白了这一点。您可以忽略它从复选框列表中提取值的位 - 这只是显示您如何更新子实体。

这是包含更新的 OnUpdating 方法（这是截断的代码）：

```
Protected Sub LinqDataSource22_Updating(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.LinqDataSourceUpdateEventArgs) Handles LinqDataSource22.Updating

            ' The main entity
            Dim updatedObject As FeedbackDraft = e.NewObject

            updatedObject.Modified = DateTime.Now
            updatedObject.ModifiedBy = UserHelper.GetCurrentUserName

            ' Example: Modify the updated object
            Dim aList As RadioButtonList = FeedbackFormView.FindControl("MyRadioButtonList")
            If aList IsNot Nothing AndAlso Not String.IsNullOrEmpty(aList.SelectedValue) Then
                updatedObject.aProperty = aList.SelectedValue
            End If

            ' Main context - for updating parent entity
            Using ctx As New CustomDataContext()

                ' Example: ... more modification of the main entity
                updatedObject.Status = "Draft"

                ' Deal with child items
                ' Secondary context - for checking against existing data in DB and removing items that have been unselected in the form
                Using ctx2 As New CustomDataContext()

                    ' We need to pull the record from the database to get the full constructed object graph
                    ' This method does a linq query to retrieve the FeedbackDraft object by ID
                    Dim originalObject As FeedbackDraft = GetOriginalFeedbackDraft(ctx2, updatedObject.FeedbackId)

                    ' ... truncated ...

                    ' Loop through CheckBoxList items and updated our entity graph
                    For Each li As ListItem In cbList.Items

                        ' ... code to work with ListItem truncated ...

                        Dim c As New ChildObject()
                        updatedObject.ChildObjects.Add(c)
                        ' Set the child collection to insert - this is using the main context
                        ctx.ChildObjects.InsertOnSubmit(c)

                        ' We can also delete things using the secondary context
                        Dim o as OtherChildObject()
                        o = GetOtherChildObjectById(updatedObject.FeedbackId)
                        ctx2.OtherChildObjects.DeleteOnSubmit(o)
                        ctx2.SubmitChanges()

                    Next
                End Using

                ' You can do further child object updates here...

                ' Now, attach main object for update
                ctx.PartnerFeedbackDrafts.Attach(updatedObject, e.OriginalObject)
                ctx.SubmitChanges()

            End Using

            e.Cancel = True

        End Sub 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-30T13:48:04.677

从数据库中选择主键为“BOB”的行后，我遇到了这个问题。然后我会用`dc.ExecuteCommand("TRUNCATE TABLE ShippingReport");`and do截断表`SubmitChanges()`，认为这会摆脱该字段，我可以使用相同的键插入另一个，但是在尝试插入时我得到了 OP 的错误。只需要`dc = new DataContext();`在第一次 SubmitChanges 之后为我修复它，因为该对象仍然存在于 DataContext 中，这基本上就是 bruno conde 的回答所说的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-04-13T10:00:41.187

就我而言，它发生在我检索到一个条目，然后尝试使用新条目更新该条目的情况下。Brainfart 可能会说，这些事情虽然发生了。:p

```
public void UpdateEntry(Entity entity)
{
    var oldEntry = select ....
    var updatedEntity = new Entity{...}; // mix of entity and oldEntry

    _repository.Update<Entity>(updatedEntity);
} 
```

变成

```
public void UpdateEntry(Entity entity)
{
    var oldEntry = select ....

    oldEntry.CreationDate = entity.CreationDate {...}

    _repository.Update<Entity>(oldEntry);
} 
```

# sql - 给定表列表，如何识别未使用/冗余列？

> ID：420722
> 
> 赞同：2
> 
> 时间：2009-01-07T15:27:15.357
> 
> 标签：sql, database

[这是在 iSeries/DB2 数据库上，如果有什么不同的话]

我想编写一个过程来识别保留为空白或零的列（给定表列表）。

假设我可以从中央系统表中提取表和列定义，我应该如何检查上述情况？我的第一个猜测是为每一列动态生成一个语句，例如：

```
select count(*) from my_table where my_column != 0 
```

并检查这是否返回零行，但有没有更好/更快/标准的方法来做到这一点？

NB 这只需要处理简单的字符、整数/小数字段，没什么花哨的！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-16T21:28:03.130

是的，通常情况下，我会在 SQL Server 中执行以下操作：

```
SELECT
REPLACE(REPLACE(REPLACE(
'
    SELECT COUNT(*) AS [COUNT NON-EMPTY IN {TABLE_NAME}.{COLUMN_NAME}]
    FROM [{TABLE_SCHEMA}].[{TABLE_NAME}]
    WHERE [{COLUMN_NAME}] IS NOT NULL
        OR [{COLUMN_NAME}] <> 0
'
, '{TABLE_SCHEMA}', c.TABLE_SCHEMA)
, '{TABLE_NAME}', c.TABLE_NAME)
, '{COLUMN_NAME}', c.COLUMN_NAME) AS [SQL]
FROM INFORMATION_SCHEMA.COLUMNS c
INNER JOIN INFORMATION_SCHEMA.TABLES t
    ON t.TABLE_TYPE = 'BASE TABLE'
    AND c.TABLE_CATALOG = t.TABLE_CATALOG
    AND c.TABLE_SCHEMA = t.TABLE_SCHEMA
    AND c.TABLE_NAME = t.TABLE_NAME
    AND c.DATA_TYPE = 'int' 
```

通过对整个查询执行 UNION 并检查每列上的 IS_NULLABLE ，您可以变得更有趣，显然您可能对不同的数据类型有不同的要求，并跳过标识列等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-16T13:29:07.757

要检查 DB2 上仅包含 NULL 的列：

1.  在您的数据库上执行 RUNSTATS ( [http://www.ibm.com/developerworks/data/library/techarticle/dm-0412pay/](http://www.ibm.com/developerworks/data/library/techarticle/dm-0412pay/) )
2.  通过查询 SYSSTAT.TABLES 和 SYSSTAT.COLUMNS 检查数据库统计信息。比较 SYSSTAT.TABLES.CARD 和 SYSSTAT.COLUMNS.NUMNULLS 会告诉你你需要什么。一个例子可能是：

```
 select t.tabschema, t.tabname, c.colname 
 from sysstat.tables t, sysstat.columns c 
 where ((t.tabschema = 'MYSCHEMA1' and t.tabname='MYTABLE1') or 
        (t.tabschema = 'MYSCHEMA2' and t.tabname='MYTABLE2') or 
        (...)) and 
      t.tabschema = c.tabschema and t.tabname = c.tabname and
      t.card = c.numnulls 
```

有关系统统计信息的更多信息，例如：http: [//publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/r0001070.htm) ?topic=/com.ibm.db2.udb.doc/admin/r0001070.htm和[http： //publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/r0001073.htm](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.doc/admin/r0001073.htm)

同样，您可以使用 SYSSTAT.COLUMNS.AVGCOLLEN 检查空列（只是它似乎不适用于 LOB）。

编辑：并且，要检查仅包含零的列，请尝试比较 SYSSTAT.COLUMNS 中的 HIGH2KEY 和 LOW2KEY。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T20:44:58.600

我假设您的意思是您想知道给定列的所有行中是否有任何值。如果您的列可能有“空白”，您可能需要在 WHERE 子句中添加 OR NOT NULL 以获得正确答案。

# wcf - 模型 - 视图 - ViewModel & WCF - WCF 是模型吗？

> ID：420723
> 
> 赞同：4
> 
> 时间：2009-01-07T15:27:17.760
> 
> 标签：wcf, mvvm, stress-testing

我只是在学习 Model/View/ViewModel 模式及其变体（DataModel/View/ViewModel，或 Model/View/Presenter）。

我想知道的是：如果我将此模式与 WCF 服务一起使用，该服务是模型（DataModel），还是需要一个单独的模型来封装 WCF 服务层？

当我使用 WCF 作为 DataModel 时，如果不模拟整个 WCF 服务，我的 ViewModel 是不可测试的，因为对 WCF 的调用需要管理连接。此 ViewModel 中的调用如下所示：

```
List<Sam.Alyza.WcfInterface.Website> rc = null;
Service<Sam.Alyza.WcfInterface.IServiceWebsites>.Use(alyzaSvc =>
{
  rc = new List<Sam.Alyza.WcfInterface.Website>(alyzaSvc.GetSites());
}); 
```

为了让我的 ViewModel 可测试，我尝试添加一个单独的 DataModel 来抽象 WCF 连接。在此之后 ViewModel 是可测试的，调用看起来像这样：

```
List<Sam.Alyza.WcfInterface.Website> rc = new List<Sam.Alyza.WcfInterface.Website>(_datamodel.GetSites()); 
```

问题：现在需要测试的大部分代码都移到了 DataModel 中，这同样需要测试 WCF。ViewModel 中剩下的是一个可以测试的薄壳。但是由于主要代码移到了 DataModel 中，所以测试 ViewModel 是毫无用处的。

所以对我来说，使用 WCF 向 View / ViewModel 应用程序添加一个单独的 DataModel 层似乎确实增加了很多工作，但可测试性并没有变得更好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-08T15:41:04.173

Woot，在解决这个问题两天后，我找到了一个我可以忍受的解决方案：

如上面的代码示例所示，我使用这个帮助类来管理我的 WCF 连接（因为正确处理了 Close vs Abort）：

```
public delegate void UseServiceDelegate<T>(T proxy);

public static class Service<T>
{
  public static ChannelFactory<T> _channelFactory;

  public static void Use(UseServiceDelegate<T> codeBlock)
  {
    if (_channelFactory == null)
      _channelFactory = new ChannelFactory<T>("AlyzaServiceEndpoint");
    IClientChannel proxy = (IClientChannel)_channelFactory.CreateChannel();
    bool success = false;
    try
    {
      codeBlock((T)proxy);
      proxy.Close();
      success = true;
    }
    finally
    {
      if (!success)
      {
        proxy.Abort();
      }
    }
  }
} 
```

正如我的问题所见，这是我的 ViewModel 中使用此类的方式：

```
Service<Sam.Alyza.WcfInterface.IServiceWebsites>.Use(alyzaSvc =>
{
  rc = new List<Sam.Alyza.WcfInterface.Website>(alyzaSvc.GetSites());
}); 
```

要模拟 WCF 接口，我需要创建和托管模拟 WCF 服务，更改所有连接字符串。很多工作只是为了添加一些测试。

我找到了一种更简单的方法：创建一个实现接口的模拟服务很简单：

```
public class MockWebsiteService : WcfInterface.IServiceWebsites
{
  internal List<Sam.Alyza.WcfInterface.Website> _websites = new List<Sam.Alyza.WcfInterface.Website>();
  internal int _GetSitesCallCount;

  IEnumerable<Sam.Alyza.WcfInterface.Website> Sam.Alyza.WcfInterface.IServiceWebsites.GetSites()
  {
    _GetSitesCallCount++;
    return _websites;
  }
} 
```

唯一的问题是：**如何让 ViewModel 调用这个模拟类而不是服务？**
解决方案：Service.Use() 确实管理连接。通过添加覆盖连接管理的功能，我可以将自己的 WCF 模拟对象偷偷带入 Service.Use()。
为此，我需要一种方法让 Service.Use() 调用 WCF 以外的东西（查看#DEBUG 部分）：

```
public static class Service<T>
{
#if DEBUG
  public static T DebugOverride = default(T);
#endif
  public static ChannelFactory<T> _channelFactory;

  public static void Use(UseServiceDelegate<T> codeBlock)
  {
#if DEBUG
    if (!Object.Equals(DebugOverride, default(T)))
    {
      codeBlock(DebugOverride);
      return;
    }
#endif
    if (_channelFactory == null)
      _channelFactory = new ChannelFactory<T>("AlyzaServiceEndpoint");
    IClientChannel proxy = (IClientChannel)_channelFactory.CreateChannel();
    bool success = false;
    try
    {
      codeBlock((T)proxy);
      proxy.Close();
      success = true;
    }
    finally
    {
      if (!success)
      {
        proxy.Abort();
      }
    }
  }
} 
```

通过将此测试钩子添加到服务中，我可以在我的测试中潜入任何实现 T 的对象：

```
MockWebsiteService mockmodel = new MockWebsiteService();
Service<WcfInterface.IServiceWebsites>.DebugOverride = mockmodel;
// run my tests here 
```

对我来说，这是模拟 WCF 服务的好方法！

PS：我知道由于#if DEBUG，测试不会在发布中编译。如果你在乎，就把他们踢出去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-04-28T12:03:27.933

我们使用依赖注入来解决这个问题，将服务客户端（或者服务客户端的工厂）注入到 ViewModel 中。像这样的东西：

```
interface IClientFactory
{
    TClient CreateClient<TClient>();
}

class ClientFactory : IClientFactory
{
    TClient CreateClient<TClient>() 
    {
       var channelFactory = new ChannelFactory<TClient>("AlyzaServiceEndpoint");
       var proxy = (TClient)channelFactory.CreateChannel();
       return proxy;
    }
}

public ViewModel 
{
    public ViewModel(IClientFactory clientFactory)
    {
       _clientFactory = clientFactory;
    }

    private void DoWcfStuff()
    {
        using (var proxy = _clientFactory.CreateClient<IClientChannel>())
        {
           var result = proxy.GetThings();
        }
    }
}

public ViewModelTests
{
    public void Setup()
    {
       _mockFactory = new MockClientFactory();
       _viewModel = new ViewModel(_mockFactory);
    }

    [Test]
    public void Test() 
    {
       var testResult = new Result();
       var mockClient = _mockFactory.CreateClient<IClientChannel>();

       mockClient.SetResultForGetThings(testResult);

       // put the viewmodel through its paces.
    }

    private class MockClientFactory : IClientFactory
    {
        MockClient _mockClient;

        public MockClientFactory()
        {
          _mockClient = new MockClient();
        }

        public TClient CreateClient<TClient>()
        {
           if (typeof(TClient) == typeof(IClientChannel))
           {
              return _mockClient;
           }
        }
    }

    private class MockClient : IClientChannel
    {
        void SetupGetThingsResult(Result result)
        {
           _result = result;
        }

        Result GetThings() 
        {
           return _result;
        }
    }
} 
```

我已经展示了一个使用手动代码模拟的示例。通常我会使用像[Moq](http://code.google.com/p/moq/)这样的 Mocking 框架。

# c++ - 如何在 C++ 中将成员变量指针转换为泛型类型

> ID：420726
> 
> 赞同：2
> 
> 时间：2009-01-07T15:29:18.457
> 
> 标签：c++, class, pointers, member-pointers

我的应用程序中有类似的代码：

```
class A
{
  public: int b;
}

class C
{
  public: int d;
}

void DoThings (void *arg1, MYSTERYTYPE arg2);

A obj_a;
C obj_c;

DoThings(&obj_a, &A::b);
DoThings(&obj_c, &C::d); 
```

问题是 - MYSTERYTYPE 应该是什么？void* 和 int 都不起作用，尽管如果通过 printf 输出值 &A::b 就可以正常打印。

澄清：是的，&A::b 是在 C++ 下定义的。是的，我正在尝试将偏移量分配给班级成员。是的，我很棘手。

编辑：哦，我可以使用 offsetof()。不管怎么说，还是要谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T15:48:19.480

您有一个指向两个不相关类的数据成员指针。好吧，您找不到可以同时保存两个指针的通用类型。它仅在函数参数是指向派生成员的数据成员指针时才有效，因为如果基包含它，它也保证包含该成员：

```
struct a { int c; }; struct b : a { }; int main() { int b::*d = &a::c; } 
```

* * *

**更新**：我想我应该写下为什么上面的内容从隐式转换`a::*`为。`b::*`毕竟，我们通常`b*`必须`a*`！考虑：

```
struct a { };
struct b : a { int c; };
struct e : a { };
int main() { int a::*d = &b::c; e e_; (e_.*d) = 10; /* oops! */ } 
```

如果以上是有效的，你真的会搞砸了。以上是无效的*，*因为从`b::*`to`a::*`的转换不是隐式的。如您所见，我们分配了一个指向 b::c 的指针，然后我们可以使用一个根本不包含它的类来取消引用它！( `e`)。编译器强制执行此顺序：

```
int main() { int b::*d = &b::c; e e_; (e_.*d) = 10; /* bug! */ } 
```

它现在*无法*编译，因为`e`它不是从`b`成员指针指针所属的类派生的。好的！但是，以下内容非常有效并且可以编译，当然（更改了类`a`和`b`）：

```
struct a { int c; };
struct b : a { };
struct e : a { };
int main() { int e::*d = &a::c; e e_; (e_.*d) = 10; /* works! */ } 
```

* * *

为了使其适用于您的情况，您必须将您的函数设为模板：

```
template<typename Class>
void DoThings (int Class::*arg) { /* do something with arg... */ } 
```

现在，编译器将自动推断给定成员指针所属的正确类。您必须在成员指针旁边传递实例才能实际使用它：

```
template<typename Class>
void DoThings (Class & t, int Class::*arg) { 
    /* do something with arg... */ 
    (t.*arg) = 10;
} 
```

如果您只想设置一些在编写 DoThings 时已经知道的成员，则以下内容就足够了：

```
template<typename Class>
void DoThings (Class & t) {  
    t.c = 10;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T15:44:52.467

您是否只是尝试使用恰好存在于对象`A`或`C`对象中的整数地址调用函数？在这种情况下，Jeff McGlynn 的答案就是要走的路。

否则，如果你真的想要做一些需要 C++ 奇怪的指向成员的工具的棘手事情（而且你几乎可以肯定不是）：

由于类`A`和`C`不相关，您将需要一个模板函数来处理两者：

```
template <typename T>
void DoThings(int T::*x); 
```

如果`C`实际上是从 派生的`A`，则以下将起作用：

```
void DoThings(int A::*x); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T16:22:18.757

&A::b 和 &C::d 是无意义的，没有关联的地址。您是否正在尝试获取成员的偏移量？

你确定你不想要类似下面的东西吗？

```
DoSomething(&obj_a,&obj_a.b); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-05T14:47:45.107

如果您按照 j_random_hacker 的建议使用模板，并且编译器在您调用函数时知道每个类的类型，那么您问题的字面答案是“ `template <typename CLASS> void DoThings (CLASS * object, int CLASS::*MEMBER)`”。

以下是它如何适合您的示例：

```
#include <iostream>

class A {
public: 
    int b;
};

class C {
public: 
    int d;
};

template <typename CLASS>
void DoThings (CLASS * object, int CLASS::*MEMBER)
{
    std::cout << object->*MEMBER << std::endl;
}

A obj_a = { 2 };
C obj_c = { 4 };

int main (int argc, const char * argv[])
{
    DoThings(&obj_a, &A::b);
    DoThings(&obj_c, &C::d);
    return 0;
} 
```

# c++ - 在 C++ 中，我可以在其范围之外定义指向私有类成员的指针吗？

> ID：420727
> 
> 赞同：4
> 
> 时间：2009-01-07T15:29:27.007
> 
> 标签：c++, pointers

考虑：

```
class C {
private:
   class T {int a, b;};
};

C::T *p; 
```

正如预期的那样，这会产生一个编译错误，指出 C::T 在第 6 行的上下文中是私有的。

现在将其更改为指向成员的指针：

```
class C {
private:
   class T {int a, b;};
};

int C::T::*p; 
```

这一次，gcc 3.2.3 版仍然发出同样的抱怨，但 gcc 3.4.3 版让它通过了。根据标准，哪个是正确的行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T15:35:12.517

由于除了班级本身之外的任何地方`T` *都*看不见`C`，我无法想象它会被允许。

在 Comau 上试过这个，他也这么跟我说。可悲的是，我对标准的了解不够，所以不能指向你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T15:47:08.687

要添加到*xtofl*的帖子，请参阅标准的第 11 章（[class.access]）：

> 一个类的成员可以是
> 
> ——**私有**的；也就是说，它的名称只能被
> 声明它的类的成员和朋友使用。
> 
> —**受保护**；也就是说，它的名称只能被声明它的类的成员和朋友以及从这个类派生的类的成员和朋友使用（见 11.5）。
> 
> —**公开的**；也就是说，它的名称可以在任何地方使用而不受访问限制。

# asp.net-2.0 - 我可以将 Silverlight 2.0 与 ASP.NET 2.0 一起使用吗？

> ID：420731
> 
> 赞同：0
> 
> 时间：2009-01-07T15:30:10.217
> 
> 标签：asp.net-2.0, silverlight-2.0

我正在开发一种用于连接数据库的内部工具。我目前的原型是使用 ASP.NET 2.0 用 C# 编写的，目的是使用 javascript 优化一些客户端操作。

但是，我希望利用 Silverlight 来简化用户界面开发。为此，我是否需要将服务器升级到 ASP.NET 3.5，或者我是否可以在 ASP.NET 2.0 中创建必要的 Web 服务以与客户端 Silverlight 控件集成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:22:23.093

从服务器的角度来看，它只是提供一个带有 XAP 扩展名的文件。所以 Silverlight 应用程序本身不是问题。

您需要注意的地方是托管 Silverlight 应用程序的网页。这可以是一个使用对象标签或 JavaScript 的简单 HTML 页面，你可以。但是，您也可以使用 ASP.NET asp:Silverlight 服务器端控件，在这种情况下，您需要确保 System.Web.Silverlight.dll 与您的应用程序一起部署，并且使用 System.Web 确实具有 3.5 依赖项. 扩展名。

因此，如果您想独立于服务器环境，最好避免使用 asp:Silverlight 控件。

服务器上可能需要的另一件事是将 XAP MIME 类型设置为 application/x-silverlight-app。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T15:33:31.897

是的 Sivler light 可以和asp.net 2.0一起使用，也可以部署到PHP等其他平台

# dependency-injection - 依赖注入带来的性能问题

> ID：420732
> 
> 赞同：7
> 
> 时间：2009-01-07T15:30:23.760
> 
> 标签：dependency-injection

在我的分析器报告中，我越来越多地看到使用依赖注入进行基于模拟的测试的结果。许多依赖项是静态的，但是因为我们想单独测试方法，所以它们被更改为实例成员，如下例所示：

```
class ShortLivedThing {
   IDependency1 dep1;
   IDependency1 dep2;
   IDependency1 dep3;
   ...

   int TheRealData;

   // Constructor used in production 
   public ShortLivedThing() {
     dep1 = new Dep1(); dep2 = new Dep2(); dep3 = new Dep3();
   }

   // DI for testing 
   public ShortLivedThing(IDependency1 d1, IDependency2 d2, IDependency3 d3) { 
     dep1 = d1(); dep2 = d2(); dep3 = d3();
   }
} 
```

反过来，大多数时候依赖项还有其他依赖项等等。*这导致每次*在测试之外进行方法调用时都会实例化（主要是“静态”）对象树。每个对象都非常小（只有几个指针），但树效应将其转化为不断增加的性能影响。

我们对于它可以做些什么呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-07T15:38:54.867

在我看来，您需要利用适当的依赖注入框架可以为您提供的功能。不要使用不同的构造逻辑进行测试/生产。

使用 spring，单例注入仅在容器启动时执行。每次都进行原型注射。每次运行单元测试时，也会完成完整的接线，如果它正在接线的话。所以分析单元测试通常不是一个好主意。

也许您使用的单例范围太少而原型范围太多？（原型 = 每次都有新实例）

spring 注入的好处是您可以使用范围代理，这意味着您的对象图可以如下所示：

```
 A Singleton
 |
 B Singleton
 |
 C Prototype (per-invocation)
 |
 D Singleton
 |
 E Session scope (web app)
 |
 F Singleton 
```

并且每个请求只会为每个会话创建 1 个 C 实例和一个 E 实例。A、B、D 和 F 是单例。如果它不是 web 应用程序，则默认情况下您没有会话范围，但您也可以制作自定义范围（“窗口”范围对于窗口桌面应用程序来说听起来很酷）。这里的线索是您可以在任何级别“引入”范围，有效地您可以拥有十层单例对象，并且突然之间会出现一些会话范围。（这确实可以彻底改变您在分层架构中实现某些横切功能的方式，但这是另一回事）

我认为，这确实可以在 DI 模型中尽可能少地创建对象。

尽管这是 Java 的 Spring，但我相信许多其他 DI 框架应该支持类似的特性。也许不是最简约的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T15:55:24.880

我认为你应该只有“DI构造函数”。您调用此构造函数进行测试和生产。

```
class ShortLivedThing {
   IDependency1 dep1;
   IDependency1 dep2;
   IDependency1 dep3;
   ...

   int TheRealData;

   public ShortLivedThing(IDependency1 d1, IDependency2 d2, IDependency3 d3) { 
     dep1 = d1; dep2 = d2; dep3 = d3;
   }
} 
```

这样，每次在测试之外进行方法调用时，您就不会遇到实例化对象树的问题。当然，对于生产，您必须在参与对象本身*之外*正确连接您的对象，这是一件好事。

总而言之：不要追求 50% DI / 50% 硬编码，而要追求 100% DI。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T15:44:05.387

传递引用怎么样？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T15:54:15.193

如果您关心的是缓慢的测试，请尝试并行运行它们，并且不要让测试过程中断您的程序员。

自动化这个过程：

*   当有人签入时，在存储库之外进行构建。
*   在此构建上运行测试。
*   E - 将结果邮寄给签到的开发人员。

最好不要对实际存储库进行首次签入。把它变成一个临时的，并以此为基础进行构建。您可以选择执行性能测试、样式检查等，并将这些内容包含在电子邮件中。如果您这样做，请在自动化流程中添加一个步骤：

*   如果测试通过（并且满足可选条件），则将新代码与实际存储库合并。

通过这种方式，缓慢的测试就不用担心了。此外，当开发人员需要知道她的代码是否破坏了某些东西或实现了预期的性能提升时，她只需签入并等待为她生成的电子邮件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T15:54:10.730

我能想到的最好的办法是将所有依赖项放入一个“上下文”对象中，然后在所有实例之间共享。这应该会在一定程度上缓解性能问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T18:00:57.200

如果您的目标是 .NET，请查看[Autofac](http://code.google.com/p/autofac/)。它具有各种范围（单例、工厂、容器）来调整创建方面，确定性处置以控制资源使用，并允许使用 GeneratedFactories 和 lambda 表达式来配​​置组件并避免反射成本。

# search - Sphinx 如何存储空字段，这对性能有何影响？

> ID：420733
> 
> 赞同：0
> 
> 时间：2009-01-07T15:30:58.157
> 
> 标签：search, full-text-search, sphinx, thinking-sphinx

我正在考虑使用询问 sphinx 来索引许多字段（数百个），其中许多字段将为空。我的问题是有多少空字段会影响性能？

这种情况不是由于数据异常非规范化，而是由于对搜索界面的要求以及可以搜索的内容。基本上我将在索引模型中动态构建索引配置，并且可能最终会产生相当多的空字段。

我的猜测是这的性能/成功取决于 Sphinx 对空值所做的事情......如果它简单地忽略它们，那么我应该没问题，但如果它实际上在其索引中存储该字段为空，我可以有一个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T16:56:57.983

显然，当前版本的 Sphinx 限制为每个索引 32 个文本字段（无限数字），所以我必须将数据分成几个不同的索引来实现这一点，除非所有数据都可以用数字表示（我的不能）。回到绘图板！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T11:47:50.920

大量的空字段不会对性能产生太大影响。许多空字段的主要问题是它们会占用大量内存。

# pdf - 更改现有 PDF 分页的最佳方法

> ID：420739
> 
> 赞同：2
> 
> 时间：2009-01-07T15:32:51.743
> 
> 标签：pdf, pdf-manipulation

我们有一个生成为 A5 横向页面的 PDF。有了这个，我们需要做一个 A4 纵向页面格式的 PDF，方法是将源 PDF 的 2 页放在结果 PDF 的每一页上。

你知道可以做那种 PDF 操作的好图书馆吗？这应该发生在 ASP.NET Web 应用程序的服务器端，尽可能少地部署在服务器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T10:55:29.653

为了完整起见，我将补充说[PDFjam](http://go.warwick.ac.uk/pdfjam)比通过 Postscript 和 psnup 更直接。它包括“pdfnup”，它可能可以做你想做的事。但是您的应用程序有几个缺点：

*   它基本上只是 pdfTeX 和包“pdfpages”的包装器

*   脚本主要是为类Unix系统编写的，只谈通过cygwin在Windows上工作

TeX 安装与 cygwin 的组合并不完全符合您“尽可能少地部署在服务器上”的规范。

但是，如果您正在寻找开源解决方案，那么 pdf(La)TeX 确实擅长这种 pdf 操作。最好的方法可能是查看 pdfnup 的功能，并在 .NET 中复制您需要的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T15:58:32.017

过去我使用过[PDF Toolkit](http://www.accesspdf.com/pdftk/) (GPL)。我认为它可以满足您的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T16:06:09.523

[psutils](http://www.tardis.ed.ac.uk/~ajcd/psutils/)有一个名为 psnup 的实用程序，它将对 Postscript 文件执行此操作。[您可以使用多种方法（例如pdf2ps](http://orion.math.iastate.edu/burkardt/g_src/pdf2ps/pdf2ps.html) ）中的任何一种将 PDF 转储到 postscript ，在其上运行 psnup 并使用[ps2pdf](http://pages.cs.wisc.edu/~ghost/doc/AFPL/6.50/Ps2pdf.htm)或[Distiller](http://www.adobe.com/products/acrobat/)转换回 PDF 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T20:34:26.477

将两张 A5 页面合并为一张 A4 页面应该与将两张 A4 页面合并为一张 A3 页面完全相同（比例除外），并且在提出这个问题两周后，这个问题在[这里得到了回答。](https://stackoverflow.com/questions/465271/gluing-imposition-pdf-documents/466110#466110)

# sql - 获取数据库中表的列表以及每个表中的字段

> ID：420741
> 
> 赞同：92
> 
> 时间：2009-01-07T15:34:05.250
> 
> 标签：sql, tsql

我正在考虑创建一个基本的 ORM（纯粹是为了好玩），并且想知道，有没有办法返回数据库中的表列表以及每个表的字段？

使用它，我希望能够遍历结果集（在 C# 中），然后对结果集中的每个表说，执行此操作（例如，使用反射来创建一个将执行或包含 xyz 的类）。

除此之外，还有哪些好的 SQL Server 在线博客？我知道这个问题实际上是关于在 Sql Server 中使用系统 SP 和数据库，我对一般查询没问题，所以我对一些涵盖此类功能的博客感兴趣。

谢谢

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2009-01-07T17:31:09.990

这是你想要的：

**使用对象目录视图**

```
 SELECT T.name AS Table_Name ,
       C.name AS Column_Name ,
       P.name AS Data_Type ,
       P.max_length AS Size ,
       CAST(P.precision AS VARCHAR) + '/' + CAST(P.scale AS VARCHAR) AS Precision_Scale
FROM   sys.objects AS T
       JOIN sys.columns AS C ON T.object_id = C.object_id
       JOIN sys.types AS P ON C.system_type_id = P.system_type_id
WHERE  T.type_desc = 'USER_TABLE'; 
```

**使用信息模式视图**

```
 SELECT TABLE_SCHEMA ,
       TABLE_NAME ,
       COLUMN_NAME ,
       ORDINAL_POSITION ,
       COLUMN_DEFAULT ,
       DATA_TYPE ,
       CHARACTER_MAXIMUM_LENGTH ,
       NUMERIC_PRECISION ,
       NUMERIC_PRECISION_RADIX ,
       NUMERIC_SCALE ,
       DATETIME_PRECISION
FROM   INFORMATION_SCHEMA.COLUMNS; 
```

参考：我的博客 - [http://dbalink.wordpress.com/2008/10/24/querying-the-object-catalog-and-information-schema-views/](http://dbalink.wordpress.com/2008/10/24/querying-the-object-catalog-and-information-schema-views/)

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-01-07T15:36:38.473

表 ::

```
SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE='BASE TABLE' 
```

列 ：：

```
SELECT * FROM INFORMATION_SCHEMA.COLUMNS 
```

或者

```
SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME='your_table_name' 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-10-31T21:33:04.253

获取数据库中所有表和字段的列表：

```
Select *
From INFORMATION_SCHEMA.COLUMNS
Where TABLE_CATALOG Like 'DatabaseName' 
```

获取表中所有字段的列表：

```
Select *
From INFORMATION_SCHEMA.COLUMNS
Where TABLE_CATALOG Like 'DatabaseName' And TABLE_NAME Like 'TableName' 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-10-24T17:57:25.417

我测试了一些解决方案，发现

```
Select *
From INFORMATION_SCHEMA.COLUMNS 
```

为您提供当前/默认数据库的列信息。

```
Select *
From <DBNAME>.INFORMATION_SCHEMA.COLUMNS 
```

，不带 < 和 >，为您提供数据库 DBNAME 的列信息。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-07T15:36:53.030

```
SELECT * FROM INFORMATION_SCHEMA.COLUMNS 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-07T15:41:51.270

您在这里的另一个内置朋友是系统存储过程 SP_HELP。

示例用法::

```
sp_help <MyTableName> 
```

它返回的信息比您真正需要的要多得多，但至少 90% 的可能需求将得到满足。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-11T22:06:15.997

把它扔出去 - 现在很容易复制/粘贴到一个单词或谷歌文档中：

```
PRINT '<html><body>'
SET NOCOUNT ON
DECLARE @tableName VARCHAR(30)
DECLARE tableCursor CURSOR LOCAL FAST_FORWARD FOR
    SELECT T.name AS TableName 
      FROM sys.objects AS T
     WHERE T.type_desc = 'USER_TABLE'
     ORDER BY T.name
OPEN tableCursor
FETCH NEXT FROM tableCursor INTO @tableName
WHILE @@FETCH_STATUS = 0 BEGIN
    PRINT '<h2>' + @tableName + '</h2>'
    PRINT '<pre>'
    SELECT LEFT(C.name, 30) AS ColumnName,
           LEFT(ISC.DATA_TYPE, 10) AS DataType,
           C.max_length AS Size,
           CAST(P.precision AS VARCHAR(4)) + '/' + CAST(P.scale AS VARCHAR(4)) AS PrecScale,
           CASE WHEN C.is_nullable = 1 THEN 'Null' ELSE 'No Null' END AS [Nullable],
           LEFT(ISNULL(ISC.COLUMN_DEFAULT, ' '), 5)  AS [Default],
           CASE WHEN C.is_identity = 1 THEN 'Identity' ELSE '' END AS [Identity]
    FROM   sys.objects AS T
           JOIN sys.columns AS C ON T.object_id = C.object_id
           JOIN sys.types AS P ON C.system_type_id = P.system_type_id
           JOIN INFORMATION_SCHEMA.COLUMNS AS ISC ON T.name = ISC.TABLE_NAME AND C.name = ISC.COLUMN_NAME
    WHERE  T.type_desc = 'USER_TABLE'
      AND  T.name = @tableName
    ORDER BY T.name, ISC.ORDINAL_POSITION
    PRINT '</pre>'
    FETCH NEXT FROM tableCursor INTO @tableName

END

CLOSE tableCursor
DEALLOCATE tableCursor
SET NOCOUNT OFF
PRINT '</body></html>' 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-03-01T22:12:05.937

`SELECT * FROM INFORMATION_SCHEMA.COLUMNS`忘记所有

`SELECT TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNS`获取所有表名。在sqlserver上试一下，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T15:42:23.313

这将为您提供所有用户创建的表：

```
select * from sysobjects where xtype='U' 
```

要获得 cols：

```
Select * from Information_Schema.Columns Where Table_Name = 'Insert Table Name Here' 
```

另外，我发现[http://www.sqlservercentral.com/](http://www.sqlservercentral.com/)是一个非常好的数据库资源。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-10T16:59:21.973

这将返回由数据库参数指定的数据库名称、表名称、列名称和列的数据类型：

```
declare @database nvarchar(25)
set @database = ''

SELECT cu.table_catalog,cu.VIEW_SCHEMA, cu.VIEW_NAME, cu.TABLE_NAME,   
cu.COLUMN_NAME,c.DATA_TYPE,c.character_maximum_length
from INFORMATION_SCHEMA.VIEW_COLUMN_USAGE as cu
JOIN INFORMATION_SCHEMA.COLUMNS as c
on cu.TABLE_SCHEMA = c.TABLE_SCHEMA and c.TABLE_CATALOG = 
cu.TABLE_CATALOG
and c.TABLE_NAME = cu.TABLE_NAME
and c.COLUMN_NAME = cu.COLUMN_NAME
where cu.TABLE_CATALOG = @database
order by cu.view_name,c.COLUMN_NAME 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-01-03T06:24:27.863

对于 MYSQL：

```
Select *
From INFORMATION_SCHEMA.COLUMNS
where TABLE_SCHEMA = "<DatabaseName>" 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-05-02T06:57:23.950

我找到了一种使用 SQL 开发人员获取特定数据库的表和列详细信息的简单方法。

```
Select *FROM USER_TAB_COLUMNS 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2020-04-14T08:30:08.077

在 Microsoft SQL Server 中，您可以使用它：

```
declare @sql2 nvarchar(2000)
        set @sql2  ='
use ?
if (  db_name(db_id()) not in (''master'',''tempdb'',''model'',''msdb'',''SSISDB'')  )
begin   

select
    db_name() as db,
    SS.name as schemaname,
    SO.name tablename,
    SC.name columnname,
    ST.name type,
    case when ST.name in (''nvarchar'', ''nchar'')
        then convert(varchar(10), ( SC.max_length / 2 ))
        when ST.name in (''char'', ''varchar'')
        then convert(varchar(10), SC.max_length)
        else null
    end as length,
    case when SC.is_nullable = 0 then ''No'' when SC.is_nullable = 1 then ''Yes'' else null end as nullable,
    isnull(SC.column_id,0) as col_number
from sys.objects                  SO
join sys.schemas                  SS
    on SS.schema_id = SO.schema_id
join sys.columns             SC
on SO.object_id     = SC.object_id
left join sys.types               ST
    on SC.user_type_id = ST.user_type_id and SC.system_type_id = ST.system_type_id
    where SO.is_ms_shipped = 0 
end
'

exec sp_msforeachdb @command1 = @sql2 
```

这将向您显示所有用户定义数据库中的所有表和列（及其定义）。

# sql-server-2005 - 我可以看到电子邮件地址中的空格，但 SQL SERVER 不能？

> ID：420746
> 
> 赞同：4
> 
> 时间：2009-01-07T15:35:46.400
> 
> 标签：sql-server-2005

我正在尝试清理 sql server 中的一些电子邮件地址。我可以看到有问题的电子邮件的示例，它们看起来像这样：

```
abc123 @xyz.com 
```

但是，当我尝试运行查询以找到这样的人时，请说：

```
NOT CHARINDEX(' ',LTRIM(RTRIM([Email_Address]))) = 0 
```

或者

```
Email_Address like '% %' 
```

我的查询没有返回任何结果。

知道什么给出了吗？

感谢您的快速回答。这是一个非破坏空间——Char(160)。sql ASCII() 函数派上用场找到它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T15:37:21.217

它肯定是一个空间还是其他一些非打印字符？

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T15:38:06.397

出现两种可能：

1.  它不是空格字符。检查它是否有 TAB 或非打印 ASCII 字符。

2.  那里什么都没有，而且你的显示字体很奇怪。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T15:39:26.190

它可能不是来自您的空格键的实际空间。我会说尝试将结果转储到文本文件，用记事本打开它，从记事本复制并粘贴“空格”。

我希望他们不要更改记事本的原因之一是缺乏对更高级字符的支持，这使您可以执行此类操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T15:48:36.110

我会将它转储到 Vim 或 UltraEdit 或 [插入选择的文本编辑器] 并以十六进制查看。然后您可以轻松判断这是空格字符还是其他字符。

# django - 如何在 Django 中进行文本完整历史记录？

> ID：420749
> 
> 赞同：10
> 
> 时间：2009-01-07T15:36:02.033
> 
> 标签：django, django-models, concurrency, parallel-processing, atomic

我想拥有用户编辑的大型文本字段的完整历史记录，使用 Django 存储。

我看过的项目：

*   [Django 完整历史记录（谷歌代码）](http://code.google.com/p/fullhistory/)
*   [Django ModelHistory](http://code.google.com/p/django-modelhistory/)和
*   [Django FullHistory](http://code.djangoproject.com/wiki/FullHistory)

我有一个特殊的用例，它可能超出了这些项目提供的范围。此外，我对这些项目的文档记录、测试和更新情况持谨慎态度。无论如何，这是我面临的问题：

我有一个模型，就像这样：

```
from django.db import models

class Document(models.Model):
   text_field = models.TextField() 
```

这个文本字段可能很大 - 超过 40k - 我想要一个自动保存功能，每 30 秒左右保存一次字段。很明显，如果有很多每个 40k 的保存（如果压缩，可能仍然是 10k），这可能会使数据库变得非常大。我能想到的最佳解决方案是在最近保存的版本和新版本之间保持差异。

但是，我担心涉及并行更新的竞争条件。我想到了两种不同的比赛条件（第二个比第一个严重得多）：

1.  **HTTP 事务竞争条件**：用户 A 和用户 B 请求文档 X0，并分别进行更改，产生 Xa 和 Xb。Xa 被保存，X0 和 Xa 之间的区别是“Xa-0”（“a less not”），Xa 现在作为正式版本存储在数据库中。如果 Xb 随后保存，它将覆盖 Xa，差异为 Xb-a（“b 减去 a”）。

    虽然不理想，但我并不过分担心这种行为。文档相互覆盖，用户 A 和 B 可能不知道彼此（每个都从文档 X0 开始），但历史记录保持完整性。

2.  **数据库读取/更新竞争条件**：有问题的竞争条件是 Xa 和 Xb 同时保存超过 X0。将有（伪）代码，例如：

    ```
     def save_history(orig_doc, new_doc):
         text_field_diff = diff(orig_doc.text_field, new_doc.text_field)
         save_diff(text_field_diff) 
    ```

    如果 Xa 和 Xb 都从数据库中读取 X0（即 orig_doc 是 X0），它们的差异将变为 Xa-0 和 Xb-0（相对于序列化的 Xa-0 然后 Xb-a，或者等效地 Xb-0 然后 Xa-乙）。当您尝试将差异修补在一起以生成历史记录时，它会在补丁 Xa-0 或 Xb-0（两者都适用于 X0）上失败。历史的完整性已经受到损害（或者已经受到损害？）。

    一种可能的解决方案是自动协调算法，它可以*事后*检测这些问题。如果重建历史失败，人们可能会假设发生了竞争条件，因此将失败的补丁应用于历史的先前版本，直到它成功。

我很高兴收到一些关于如何解决这个问题的反馈和建议。

顺便说一句，就它是一种有用的出路而言，我注意到这里讨论了 Django 原子性：

*   [Django：如何防止同时修改数据库条目](https://stackoverflow.com/questions/320096/django-how-can-i-protect-against-concurrent-modification-of-data-base-entries)，这里：
*   [Django中的原子操作？](https://stackoverflow.com/questions/280075/atomic-operations-in-django)

非常感谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-11T19:13:32.800

这是我为保存对象的历史所做的工作：

对于 Django 应用程序历史：

**历史/__init__.py：**

```
"""
history/__init__.py
"""
from django.core import serializers
from django.utils import simplejson as json
from django.db.models.signals import pre_save, post_save

# from http://code.google.com/p/google-diff-match-patch/
from contrib.diff_match_patch import diff_match_patch

from history.models import History

def register_history(M):
  """
  Register Django model M for keeping its history

  e.g. register_history(Document) - every time Document is saved,
  its history (i.e. the differences) is saved.
  """
  pre_save.connect(_pre_handler, sender=M)
  post_save.connect(_post_handler, sender=M)

def _pre_handler(signal, sender, instance, **kwargs):
  """
  Save objects that have been changed.
  """
  if not instance.pk:
    return

  # there must be a before, if there's a pk, since
  # this is before the saving of this object.
  before = sender.objects.get(pk=instance.pk)

  _save_history(instance, _serialize(before).get('fields'))

def _post_handler(signal, sender, instance, created, **kwargs):
  """
  Save objects that are being created (otherwise we wouldn't have a pk!)
  """
  if not created:
     return

  _save_history(instance, {})

def _serialize(instance):
   """
   Given a Django model instance, return it as serialized data
   """
   return serializers.serialize("python", [instance])[0]

def _save_history(instance, before):
  """
  Save two serialized objects
  """
  after = _serialize(instance).get('fields',{})

  # All fields.
  fields = set.union(set(before.keys()),set(after.keys()))

  dmp = diff_match_patch()

  diff = {}

  for field in fields:
    field_before = before.get(field,False)
    field_after = after.get(field,False)

    if field_before != field_after:
      if isinstance(field_before, unicode) or isinstance(field_before, str):
      # a patch
        diff[field] = dmp.diff_main(field_before,field_after)
      else:
        diff[field] = field_before

  history = History(history_for=instance, diff=json.dumps(diff))
  history.save() 
```

**历史/models.py**

```
"""
history/models.py
"""

from django.db import models

from django.contrib.contenttypes.models import ContentType
from django.contrib.contenttypes import generic

from contrib import diff_match_patch as diff

class History(models.Model):
     """
     Retain the history of generic objects, e.g. documents, people, etc..
  """

  content_type = models.ForeignKey(ContentType, null=True)

  object_id = models.PositiveIntegerField(null=True)

  history_for = generic.GenericForeignKey('content_type', 'object_id')

  diff = models.TextField()

  def __unicode__(self):
       return "<History (%s:%d):%d>" % (self.content_type, self. object_id, self.pk) 
```

希望对某人有所帮助，并将不胜感激。

请注意，这并**没有**解决我最关心的竞争条件。如果在 _pre_handler "before = sender.objects.get(pk=instance.pk)" 在另一个实例保存之前被调用，但在另一个实例更新历史记录之后，当前实例首先保存，将会有一个 'broken历史”（即乱序）。值得庆幸的是 diff_match_patch 尝试优雅地处理“非致命”中断，但不能保证成功。

一种解决方案是原子性。不过，我不确定如何使上述竞争条件（即_pre_handler）成为跨所有Django 实例的原子操作。HistoryLock 表或内存中的共享哈希（memcached？）会很好 - 建议？

如前所述，另一种解决方案是协调算法。但是，并发保存可能存在“真正的”冲突，需要用户干预才能确定正确的协调。

显然，将历史拼凑起来并不是上述片段的一部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T23:24:24.380

**存储问题：**我认为您应该只存储文档的两个连续有效版本的差异。正如您所指出的，当进行并发编辑时，问题就变成了获取有效版本。

**并发问题：**

1.  你能像[Jeff 建议](https://stackoverflow.com/questions/420749/how-to-do-text-full-history-in-django#421400)的那样一起避免它们，或者通过锁定文档来避免它们吗？
2.  如果不是，我认为您最终会成为**在线协作实时编辑器（如 Google Docs** ）的范式。

要获得您正在打开的蠕虫罐的**图解视图，请****[在 9 分 21 秒观看这个谷歌技术讲座](http://www.youtube.com/watch?v=GfeUCT-tRJQ#t=9m21s)**（它是关于 Eclipse 的协作实时编辑）

[或者，在Wikipedia 关于协作实时编辑器的文章中](http://en.wikipedia.org/wiki/Collaborative_real-time_editor)，有一些专利详细说明了处理这些并发的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T18:18:57.007

为了管理差异，您可能需要研究 Python 的[difflib](http://docs.python.org/library/difflib.html)。

关于原子性，我可能会像 Wiki（Trac 等）一样处理它。如果自用户上次检索后内容已更改，请请求他们用新版本覆盖。如果您将文本和差异存储在同一记录中，使用您发布的链接中的技术避免数据库竞争条件应该不难。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-08T00:38:04.543

我假设您的自动保存会在用户实际按下保存按钮之前保存草稿版本，对吧？

如果是这样，您不必保留草稿保存，只需在用户决定真实保存后处理它们，并且只保留真实/显式保存的历史记录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T15:30:09.267

从那以后，我也发现了[django-reversion](http://code.google.com/p/django-reversion/)，它似乎运行良好并且得到积极维护，尽管它不能有效地将小差异存储到大段文本中。

# database - 当没有可用的导出选项时，如何在旧 DOS 应用程序中导出数据？

> ID：420762
> 
> 赞同：0
> 
> 时间：2009-01-07T15:38:30.297
> 
> 标签：database, export, legacy, raima

我的客户给我们的任务是**使用 RAIMA 数据库**从遗留 DOS 系统中导出数据，以便可以将其导入到我们为他们编写的新系统中。看起来数据是以平面文件格式存储的，尽管当我们打开文件时，大部分文本都是乱码。

我们确实在我们打开的文件顶部看到了 Raima 数据库管理器……我们尝试用谷歌搜索该术语，似乎它是一种旧的数据库格式。不用说编写软件的供应商不再支持它。有没有其他方法可以让我们导出这些数据？

**有没有办法自动从屏幕上抓取数据？**

**笔记**

这是一个简单的发票系统，所有信息都在应用程序的一个屏幕上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T15:42:04.017

[Raima](http://www.raima.com/products/)似乎还在继续，可能值得给他们发一封邮件或看看他们的新产品是否向后兼容。失败是对应用程序进行逆向工程以从中转储数据或找出文件格式的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T15:53:56.147

了解所使用的 Raima Database Manager 版本会有所帮助；**db_Vista**或**RDM**或**Velocis**或**RDM Embedded**？编写 DOS 应用程序的大致时代将有助于缩小可能的版本。

RDM Embedded 在 2000 年左右由 Centura 作为开源发布，然后重命名为 db.linux。您可能会在源代码中找到一些信息，这些信息可以阐明它们是如何构建文件的。

无论如何，db_Vista 诞生于 1982 年，因此它很可能是一个 B-Tree 文件/索引系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T16:18:56.360

对于 Raima 数据管理器版本 3.21A[这篇文章](http://www.ddj.com/184408900?pgno=2#02d9_0008)表明该应用程序可能是用 C 语言编写的，并且它使用 **Raima 数据定义语言**来构建文件 - 在文件中查找类似的内容，检查 .dbd 和 .tbl - 您可能需要查看他们使用具有十六进制模式的VI。数据结构很可能嵌入其中一个文件中。

**编辑：**

这里有一些链接可能会引导您了解更多信息

[http://www.raima.com/](http://www.raima.com/)

[http://www.raima.com/database_technology/rdm.php3](http://www.raima.com/database_technology/rdm.php3) [http://www.raima.com/database/download.php3](http://www.raima.com/database/download.php3)

[http://database.ittoolbox.com/topics/t.asp?t=411&p=415&h1=411&h2=412&h3=415](http://database.ittoolbox.com/topics/t.asp?t=411&p=415&h1=411&h2=412&h3=415)

[http://www.faqs.org/faqs/databases/free-databases/](http://www.faqs.org/faqs/databases/free-databases/)

[http://www.ittia.com/products/ittia_odbc.html](http://www.ittia.com/products/ittia_odbc.html)

[http://www.mactech.com/articles/mactech/Vol.07/07.02/db_VistaIII/index.html](http://www.mactech.com/articles/mactech/Vol.07/07.02/db_VistaIII/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T15:51:30.783

DOS 应用程序会在 Windows XP 的命令窗口中运行吗？如果是这样，您也许可以将数据剪切并粘贴到文本编辑器或电子表格中。

我想到了另一个想法。您可以使用 Java Robot 甚至简单的 Win API 代码将击键发送到命令窗口以翻阅记录。这就是你的战斗的一半。看起来命令窗口有一个“全选”选项，将其与“复制”命令结合起来，你应该被设置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T15:51:40.563

作为第二种选择（或者可能是最后的手段），如果 Raima 无法帮助您，您可以使用自动化工具从屏幕上刮下信息并进行分析。鉴于它是一个 DOS 应用程序，如果它可以在 Windows 控制台窗口中运行，我会使用像[Eggplant](http://www.testplant.com/)、[TestComplete](http://www.automatedqa.com/products/testcomplete/)或[HighTest](http://www.vtsoft.com/)这样的工具。这些工具主要是为通过 GUI 或 UI 进行测试自动化而设计的，但非常适合这类工作。我认为 Hightest 过去曾经有一个 DOS 版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T16:02:20.013

另一种选择可能是使用 dos 应用程序必须将所有应用程序数据打印到文本文件的任何报告机制（通过 prn: 的重定向），然后从纯文本格式解析它 - 这将是很多工作（尽管正则表达式可以快速解析出多余的废话）但我已经做到了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T16:09:28.610

您可能还应该花 20 分钟排除数据库格式在那个时代并不常见的可能性——db3、Paradox、Filemaker 或类似的东西——但文件扩展名已重命名。尝试在 Excel 中打开或指定格式的类似文件（如果需要，请先将额外的过滤器添加到 Excel）。Borland 的 Database Desktop 过去也很适合这种检查。

这是一个长远的目标，但是当一些“晦涩”的文件格式被证明是更常见的东西（尤其是 db3）的模糊版本时，它对我来说是有回报的。在 DOS 时代之外，我发现模糊的 Access 文件也时不时出现。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-09T00:56:25.667

Raima（至少我使用的版本）带有一个名为 datdump 的工具，它以人类可读的格式写出数据文件。还有一个名为 dbexp 的工具，它可以从 Raima 数据库生成 CSV 文件。

我敢打赌，Raima 的优秀人员可以帮助你。我知道他们还在。我看到他们的网站甚至在其支持区域中发布了他们的数据文件的文件格式。这可能会因 Raima 的版本而异，但应该让您对如何开始编写自己的提取代码有一个很好的了解。

# visual-studio - 如何在 T4 模板中获得智能感知？

> ID：420766
> 
> 赞同：53
> 
> 时间：2009-01-07T15:39:30.463
> 
> 标签：visual-studio, visual-studio-2008, intellisense, t4

在尝试这些教程（[T4 教程：创建可重用代码生成模板](http://www.olegsych.com/2008/09/t4-tutorial-creating-reusable-code-generation-templates/)）时，我注意到虽然我使用的是纯 c#，但我没有得到任何智能感知，可能是因为文件扩展名 (.tt)

无论如何都没有告诉 Visual Studio 将这些 .tt 文件视为 .cs 文件，从而获得正确的智能感知帮助？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-08-10T06:17:53.487

[Resharper可以在](http://www.jetbrains.com/resharper/)[ForTea 插件](https://github.com/MrJul/ForTea)的帮助下做到这一点，该插件增加了对编辑 T4 (.tt) 文件的支持。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2010-08-18T05:08:11.033

[http://visualstudiogallery.msdn.microsoft.com/en-us/60297607-5fd4-4da4-97e1-3715e90c1a23](http://visualstudiogallery.msdn.microsoft.com/en-us/60297607-5fd4-4da4-97e1-3715e90c1a23)

给你一个插件...

瓦西姆。

**编辑**

也适用于 Visual Studio 2012：[有形 T4 编辑器 2.3.0](https://marketplace.visualstudio.com/items?itemName=tangibleengineeringGmbH.tangibleT4Editor230plusmodelingtoolsforVS2012)
也适用于 Visual Studio 2015：[有形 T4 编辑器 2.3.0](https://marketplace.visualstudio.com/items?itemName=tangibleengineeringGmbH.tangibleT4Editor230plusmodelingtoolsforVS2015)
也适用于 Visual Studio 2017：[有形 T4 编辑器 2.4.0](https://marketplace.visualstudio.com/items?itemName=tangibleengineeringGmbH.tangibleT4Editor240plusmodelingtoolsforVS2017)
也适用于 Visual Studio 2019：[有形 T4 编辑器 2.5 .0](https://marketplace.visualstudio.com/items?itemName=tangibleengineeringGmbH.tangibleT4Editor2019)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-23T19:13:48.947

您可以在 t4editor.tangible-engineering.com 下载有形的 T4 编辑器，它在免费版中也为最重要的命名空间提供了 Intelli-Sense。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-08T11:47:35.223

您可以购买专业版的 T4 Editor。它在独立的 .tt 文件中运行良好，但不幸的是，由于专业版 T4 Editor 和 T4 本身编译模板的方式不同，您将收到本教程报告的错误错误，该教程依赖于[T4 Toolbox](http://www.codeplex.com/t4toolbox)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-24T10:13:18.410

正如[Scott Hanselman 还指出](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)的那样，您可能期望从 T4 上的一些视频和文章中获得的智能感知并未内置到 VS2008 中，您需要 Clarius 的 T4 编辑器，但他们确实有一个社区版，其中包含[一些极简主义的](http://www.visualt4.com/features.html)功能你开始了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-11-25T00:09:24.527

我发现 devart T4 编辑器具有我在 Visual Studio 扩展中免费寻找的所有功能。都是原生的。感觉就像编辑任何其他源文件。

[https://www.devart.com/t4-editor/download.html](https://www.devart.com/t4-editor/download.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-06T15:06:45.240

由于某些原因，我无法安装其他答案中提到的扩展。我的解决方案是使用 Visual Studio Code 来编辑 .tt 文件。VS Code 有一些不错的 t4 synthax highlighter 插件。

# html - IE中的上标下划线

> ID：420770
> 
> 赞同：4
> 
> 时间：2009-01-07T15:41:11.193
> 
> 标签：html, css, internet-explorer, underline, superscript

我会简短一些，因为我的时间不多，所以如果这不是我希望的那么详细，我深表歉意。

我有一些代码：

```
print("<a href='#'>Some text<sup>&reg;</sup> some more text</a>"); 
```

在 FF 中，这就像我想要的那样工作，整个链接都带有下划线。但是在 IE 中，除了 ® 下的链接看起来像连字符上方的符号并且看起来相当荒谬之外，该链接都带有下划线。

我尝试了在 Google 上找到的几个建议，但没有一个对达到预期效果很有帮助。不幸的是，在底部添加边框不是一种选择。到目前为止，最好的解决方案是用 CSS 在 sup 标记处完全打破下划线，这样它在 FF 中仍然可以正常工作，同时在 IE 中看起来也不那么愚蠢。

如果有人可以帮助解决这个问题，我将不胜感激，我宁愿不通过网站删除`<sup>`标签，因为我被告知如果我不能解决这个困境，我将不得不这样做。

更新：使用 sup {"text-decoration:none" } 解决方案，它现在就可以了。到处都有 reg 标记，所以整个网站都必须更新，这比我们都决定的更麻烦。感谢那些回答的人。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T15:49:07.620

该`<sup>`标签不适用于商标和注册符号之类的东西。

我更喜欢用 css 来做：

```
<span style='font-size:75%;vertical-align:super;text-decoration:none'>&reg</span> 
```

如果您可以设置 .reg 类：

```
.reg {
    font-size:75%;
    vertical-align:super;
    text-decoration:none
} 
```

为了：

```
<span class='reg'>&reg;</span> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-04T12:15:01.273

有时您不允许将类添加到链接或用任何元素包装它。当您需要使用第三方代码时，这种情况并不少见。顺便说一句，元素也有同样的问题。

在这种情况下，您可以使用以下内容：

1.  为 Firefox 保留下划线（一切正常）
2.  为 Chrome 使用这样的样式（它和 IE 有同样的问题，甚至更难）：

    ```
    [风格]
    晚安{
        文字装饰：无；
        显示：内联块；// 没有这个先前的属性将不起作用
        边框底部：1px 实心；
        行高：1.5em；// 这个和下面的属性用于移位
        边距顶部：-1em；// 使边框与下划线对齐的元素
                           // 可以使用相对位置或其他。
    }
    一个子{
        文字装饰：无；
        显示：内联块；
        垂直对齐：中间；
        边框底部：1px 实心；
        行高：0.7em；
    }
    [/风格]
    [a href="what-aczone-can-do-for-you.aspx"]Text-Jj_Jj[sub]Jj[/sub][sup]Jj[/sup]moreText[/a]

    ```

    *   对不起标签中的 []s，我仍然无法理解这个 f*** 系统是如何制作代码示例的 - 当我尝试按照它想要的格式进行格式化时，我变得一团糟。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T17:24:17.570

好吧，这不是一个优雅的解决方案，基本上使用边框而不是下划线。您必须根据“Active、Visted 等”对其颜色进行编码

```
<style type="text/css">
   a.u {
       text-decoration: none; 
       border-bottom: 1px solid black;
       display: inline;
   }
</style>

<a href="#123" class="u">CHEESE<sup>&reg;</sup></a> 
```

埃里克

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-27T02:27:37.057

Eric 的解决方案是最接近的。他不需要，`display: inline`因为`<a>`元素是内联元素。他唯一缺少的是`line-height`，您可以在 IE 6 和 IE 7 上看到边框底部。否则，您将看不到线条。

```
<style type="text/css">
   a.u {
       text-decoration: none; 
       border-bottom: 1px solid black;
       line-height: 1.5em;
   }
</style>

<a href="#123" class="u">CHEESE<sup>&reg;</sup></a> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-27T09:48:20.440

我让它像这样工作

```
print(< a href='#' class="underline">Some text< sup >&reg;< /sup > some more text< /a >)  
.underline {text-decoration:none; border-bottom:1px solid #FFF;} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T15:50:33.657

好吧，我同意它看起来很糟糕，但这似乎只是 IE 结合下划线和上标的方式。`a sup`如果你不能用边框作弊，我建议你按照你的 CSS 计划删除下划线。有一个名为 IE 的唯一属性，`text-underline-position`但恐怕它在这里没有任何帮助。

为了任何不知道的人的利益，这将是：

```
a sup{text-decoration:none;} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T17:07:03.627

正如 Diodeus 所说，一些研究倾向于同意，我知道 reg 标记无论如何都不会进入 sup 元素。

因此，假设我们只解决 sup/underline 问题而忘记了我们指的是 reg 标记，我所知道的使它们“看起来”相同的唯一解决方案是制作`vertical-align: baseline`或杀死`text-decoration`sup。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-06-03T21:42:15.397

border-bottom 解决方案将把线放在任何“p”、“q”或“y”下面，而不是穿过字母的底腿。这比下划线低 2px。

另一种方法是使 <a> 位置：相对
使 <sup> 位置：绝对；顶部：-3px；文字装饰：无；

添加一个额外的   在</sup>之后

# c# - foreach 与通用列表，使用值类型时检测第一次迭代

> ID：420774
> 
> 赞同：19
> 
> 时间：2009-01-07T15:42:01.723
> 
> 标签：c#, .net

当`foreach`遍历一个通用列表时，我经常想对列表中的第一个元素做一些不同的事情：

```
List<object> objs = new List<object>
{
    new Object(),
    new Object(),
    new Object(),
    new Object()
};

foreach (object o in objs)
{
    if (o == objs.First())
    {
        System.Diagnostics.Debug.WriteLine("First object - do something special");
    }
    else
    {
        System.Diagnostics.Debug.WriteLine("object Do something else");
    }
} 
```

这将输出：

```
    第一个目标 - 做一些特别的事情
    对象做其他事情
    对象做其他事情
    对象做其他事情

```

这一切都很好，花花公子。

但是，如果我的通用列表是值类型，则此方法将失败。

```
List<int> ints = new List<int> { 0, 0, 0, 0 };
foreach (int i in ints)
{
    if (i == ints.First())
    {
        System.Diagnostics.Debug.WriteLine("First int - do something special");
    }
    else
    {
        System.Diagnostics.Debug.WriteLine("int Do something else");
    }
} 
```

这将输出：

```
    First int - 做一些特别的事情
    First int - 做一些特别的事情
    First int - 做一些特别的事情
    First int - 做一些特别的事情

```

现在我知道我可以重新编码以添加`boolean`标志变量或传统`for`循环，但我想知道是否有任何方法可以确定 foreach 循环是否在其循环的第一次迭代中。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-07T15:44:29.347

好吧，您可以使用显式迭代对其进行编码：

```
using(var iter = ints.GetEnumerator()) {
  if(iter.MoveNext()) {
     // do "first" with iter.Current

     while(iter.MoveNext()) {
       // do something with the rest of the data with iter.Current
     }
  }
} 
```

布尔标志选项（带`foreach`）可能更容易......这就是我（几乎）总是做的！

另一种选择是 LINQ：

```
if(ints.Any()) {
  var first = ints.First();
  // do something with first
}

foreach(var item in ints.Skip(1)) {
  // do something with the rest of them
} 
```

上面的缺点是它试图查看列表 3 次......因为我们知道它是一个列表，那很好 - 但如果我们只有一个`IEnumerable<T>`，那么迭代它一次是明智的（因为源可能无法重新读取）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T15:46:37.813

前段时间我写了[SmartEnumerable](http://www.yoda.arachsys.com/csharp/miscutil/usage/smartenumerable.html)（MiscUtil 的一部分），它可以让你知道当前元素是第一个还是最后一个，以及它的索引。这可能对您有所帮助……它是 MiscUtil 的一部分，它是开源的 - 当然，您可以在相同的许可证下使用 SmartEnumerable。

示例代码（来自网页的c'n'p）：

```
using System;
using System.Collections.Generic;

using MiscUtil.Collections;

class Example
{
    static void Main(string[] args)
    {
        List<string> list = new List<string>();
        list.Add("a");
        list.Add("b");
        list.Add("c");
        list.Add("d");
        list.Add("e");

        foreach (SmartEnumerable<string>.Entry entry in
                 new SmartEnumerable<string>(list))
        {
            Console.WriteLine ("{0,-7} {1} ({2}) {3}",
                               entry.IsLast  ? "Last ->" : "",
                               entry.Value,
                               entry.Index,
                               entry.IsFirst ? "<- First" : "");
        }
    }
} 
```

编辑：请注意，虽然它适用于具有不同引用的引用类型，但如果你给它一个列表，其中第一个引用出现在列表的其他地方，它仍然会失败。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-07T15:45:40.703

```
foreach(int i in ints.Take(1))
{
 //do first thing
}

foreach(int i in ints.Skip(1))
{
  //do other things
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-07T15:49:02.240

由于您已经在使用 LINQ，您可以这样做：

```
var list = new List<Int32>();

// do something with list.First();

foreach (var item in list.Skip(1))
{
    // do other stuff
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T15:46:22.057

您遇到的问题是因为值类型的相等性基于实际值，而不是引用本身。具体来说，在您的示例中，您的列表全为零，因此它询问 currentItem == firstItem 是否，并且由于它们都为零，所以这始终是正确的。对于这种事情，我总是使用布尔标志。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T15:45:56.457

而不是 if `(i == ints.First())`，如果你使用它会起作用`if (i.Equals(ints.First())`吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T15:46:25.380

如果您真的不想使用布尔值，您可以执行以下操作：

```
List<int> ints = new List<int> { 0, 0, 0, 0 };

System.Diagnostics.Debug.WriteLine("First int - do something special" + ints.FirstOrDefault().ToString());
foreach (int i in ints.Skip(1))
{
    {
        System.Diagnostics.Debug.WriteLine("int Do something else");
    }
} 
```

但这似乎有点..奇怪:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-11-25T07:57:41.923

从另一个答案编辑方式：

```
IList<object> objs = new List<object>
{
    new Object(),
    new Object(),
    new Object(),
    new Object()
};

// to access first element: objs[0]
// to access last element: objs[objs.Count - 1]

System.Diagnostics.Debug.WriteLine("First object - do something special");

foreach (object o in objs.Skip(1))
{
    System.Diagnostics.Debug.WriteLine("object Do something else");
} 
```

关于参考链接：

使用`Skip`：[Enumerable.Skip 方法（IEnumerable，Int32）](https://msdn.microsoft.com/en-us/library/bb358985(v=vs.110).aspx)

使用`IList<T>`：[列表或 IList](https://stackoverflow.com/questions/400135/listt-or-ilistt)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-05T02:13:38.107

`Select()`可以返回当前元素的索引。使用简单的扩展方法，您可以这样做：

```
var ints = new List<int> { 1, 2, 3, 4 };

foreach (var item in ints.SelectWithIndex())
{
    if (item.index == 0)
        Console.WriteLine($"First: {item.val}");
    else
        Console.WriteLine($"{item.val}");
} 
```

扩展方法`SelectWithIndex`为列表的每个值添加一个索引（它返回一个具有字段的元组列表：`val`和`index`）。

```
static class MyExtensions
{
    public static IEnumerable<(T val, int index)> SelectWithIndex<T>(this List<T> list)
    {
        return list.Select((i, j) => CreateValIndex(i, j));
    }

    public static (T val, int index) CreateValIndex<T>(T val, int index)
    {
        return (val, index);
    }
} 
```

# installation - .NET 程序不断安装旧版本

> ID：420783
> 
> 赞同：2
> 
> 时间：2009-01-07T15:42:59.553
> 
> 标签：installation, version, uninstallation

我在使用 .NET 程序时遇到了一个相当烦人且耗时的问题。我们的客户都使用我们在 Visual Studio 2005 中编写的软件（运行 .NET framework 3.5）。该应用程序是一个安装项目，它从另一个项目中获取其文件。问题是，每当我进行代码更改并将新版本上传到服务器时，某些电脑不会得到更改。以下是我们为升级所做的步骤：

1.  使用添加/删除程序卸载旧软件。
2.  重新启动机器。
3.  访问我们的网站并运行 setup.msi 文件。
4.  安装新软件。
5.  运行应用程序。

问题是当他们运行应用程序时，他们仍然得到旧版本。它只发生在某些没有特定模式的电脑上。我很肯定这不是互联网缓存，因为一位同事直接通过 ftp 将 msi 文件复制到那里。我们通过将安装目录（包括清单、部署、exe 和所有这些东西）复制到他们的 PC 上来解决这个问题。这似乎有效，但它不应该是必要的。我难住了。我什么都试过了。我不能重复这个问题——设置对我来说很好；即使我有旧版本，它也会升级它。Windows 是否以某种方式缓存设置或我应该知道的事情？请帮助:) 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T15:50:38.523

我遇到过这种情况，其中 MSI 的 GUID 之一在构建之间没有更改。

还要检查版本号。我也发生过这种情况，唯一的修订号发生了变化（1.0.0.0 -> 1.0.0.1 还不够，必须是 1.0.1.x）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T15:46:41.573

该问题可能与下载端的 chaching 有关。如果是我，我会确保 msi 在其名称中包含版本号（例如 MyAppInstaller_1.1.3.msi），以确保下载时不会发生任何奇怪的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T08:53:16.157

你确定你使用的是 3.5 和 2005？

如果您使用的是 2008，请参阅[关于 MSI 支持与另一个的区别的讨论](https://stackoverflow.com/questions/290011/net-install-package-sometimes-not-completely-removing-previous-versions)。

话虽如此，这并不能解释不一致的行为 - 它应该始终是错误的。也许在某些情况下，人们正在执行显式卸载并成功？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T15:53:02.857

您确定目标用户在安装新版本之前正在卸载旧版本吗？我遇到过没有卸载旧版本的用户的问题，新版本没有覆盖它。您可以尝试以下方法

*   将安装程序中的默认目录设置为与旧版本不同的位置。
*   给快捷方式一个不同的名称（附加版本号）。

因为我不认为缓存会做这样的事情（如果文件是通过浏览器下载的，它们会在完成后下载到特定位置，而不是保存在缓存中）。

编辑：Morechillies 可能会有所作为。一些公司可能正在尝试复制网络。它可能是代理缓存......但我并不真正相信。

# svn - CruiseControl.NET 和 TortoiseSVN

> ID：420788
> 
> 赞同：5
> 
> 时间：2009-01-07T15:45:00.093
> 
> 标签：svn, tortoisesvn, cruisecontrol.net

**CruiseControl.NET 中的源代码**控制块可以针对 TortoiseSVN 吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T15:55:18.983

CCNet 设计用于使用 svn.exe 形式的颠覆客户端，而不是直接使用 tortoisesvn（tortoisesvn 已编译 svn 客户端库）。

一般来说，使用 tortoisesvn 自动化命令的唯一优势是方便用户交互的对话框 - 通常使用 ccnet，您最不想要的就是任何会引发对话框的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T15:48:32.863

它不能专门使用 Tortoise，但它可以与 Subversion 对话。

更多信息[在这里](http://confluence.public.thoughtworks.org/display/CC/Using+CruiseControl+with+Subversion)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T15:48:26.547

我不确定你的意思，但我认为答案是：CC.NET 可以使用 Subversion，看看：[http ://confluence.public.thoughtworks.org/display/CCNET/Subversion+Source+Control +阻止](http://confluence.public.thoughtworks.org/display/CCNET/Subversion+Source+Control+Block)

# java - 静态导入方法的好用例是什么？

> ID：420791
> 
> 赞同：150
> 
> 时间：2009-01-07T15:46:02.387
> 
> 标签：java, static-import

刚刚收到评论说我的方法的静态导入不是一个好主意。静态导入是来自 DA 类的方法，该类主要具有静态方法。因此，在业务逻辑的中间，我有一个显然似乎属于当前类的 da 活动：

```
import static some.package.DA.*;
class BusinessObject {
  void someMethod() {
    ....
    save(this);
  }
} 
```

审阅者并不热衷于我更改代码，我也没有，但我确实同意他的观点。没有静态导入的一个原因是它在定义方法的位置令人困惑，它不在当前类中，也不在任何超类中，因此识别它的定义需要一些时间（基于 Web 的评论系统没有可点击IDE 之类的链接 :-) 我真的不认为这很重要，静态导入仍然很新，很快我们都会习惯于定位它们。

但另一个我同意的原因是，不合格的方法调用似乎属于当前对象，不应该跳转上下文。但如果它真的属于，扩展那个超类是有意义的。

那么，什么时候*静态*导入方法才有意义呢？你什么时候做的？你/你喜欢不合格电话的样子吗？

编辑：流行的观点似乎是静态导入方法，如果没有人将它们混淆为当前类的方法。例如来自 java.lang.Math 和 java.awt.Color 的方法。但是如果 abs 和 getAlpha 不是模棱两可的，我不明白为什么 readEmployee 是。与许多编程选择一样，我认为这也是个人喜好。

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-01-07T17:01:59.613

这是 Sun 发布该功能时的指南（强调原文）：

> 那么什么时候应该使用静态导入呢？**非常节俭！**仅当您想要声明常量的本地副本或滥用继承（常量接口反模式）时才使用它。...如果您过度使用静态导入功能，它可能会使您的程序不可读和不可维护，并用您导入的所有静态成员污染其名称空间。您的代码的读者（包括您，在您编写代码几个月后）将不知道静态成员来自哪个类。从一个类中导入所有的静态成员对可读性尤其有害；如果您只需要一两个成员，请单独导入它们。

（[https://docs.oracle.com/javase/8/docs/technotes/guides/language/static-import.html](https://docs.oracle.com/javase/8/docs/technotes/guides/language/static-import.html)）

我想特别指出两个部分：

*   **仅**当您想“滥用继承”时才使用静态导入。在这种情况下，您会想拥有 BusinessObject`extend some.package.DA`吗？如果是这样，静态导入可能是一种更简洁的处理方式。如果您从未梦想过扩展`some.package.DA`，那么这可能是对静态导入的不良使用。不要仅仅在打字时使用它来保存几个字符。
*   **导入单个成员。**说`import static some.package.DA.save`而不是`DA.*`。这将使查找此导入方法的来源变得更加容易。

就个人而言，我很少使用这种语言特性*，*而且几乎总是只使用常量或枚举，从不使用方法。对我来说，这种权衡几乎是不值得的。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-01-07T18:32:14.983

静态导入的另一个合理用途是使用 JUnit 4。在早期版本的 JUnit 方法中，例如`assertEquals`和`fail`继承自测试类扩展`junit.framework.TestCase`.

```
// old way
import junit.framework.TestCase;

public class MyTestClass extends TestCase {
    public void myMethodTest() {
        assertEquals("foo", "bar");
    }
} 
```

在 JUnit 4 中，测试类不再需要扩展`TestCase`，而是可以使用注解。然后，您可以从以下位置静态导入断言方法`org.junit.Assert`：

```
// new way
import static org.junit.Assert.assertEquals;

public class MyTestClass {
    @Test public void myMethodTest() {
        assertEquals("foo", "bar");
        // instead of
        Assert.assertEquals("foo", "bar");
    }
} 
```

JUnit[文档](http://junit.sourceforge.net/doc/cookbook/cookbook.htm)以这种方式使用它。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-01-07T18:20:53.150

[Effective Java, Second Edition的](http://www.oracle.com/technetwork/java/effectivejava-136174.html)*第 19*条末尾指出，如果您发现自己**大量**使用实用程序类中的常量，则可以使用静态导入。我认为这个原则适用于常量和方法的静态导入。

```
import static com.example.UtilityClassWithFrequentlyUsedMethods.myMethod;

public class MyClass {
    public void doSomething() {
        int foo = UtilityClassWithFrequentlyUsedMethods.myMethod();
        // Can be written less verbosely as
        int bar = myMethod();
    }
} 
```

这有优点也有缺点。它以丢失有关方法定义位置的一些即时信息为代价使代码更具可读性。然而，一个好的 IDE 会让你去定义，所以这不是什么大问题。

您仍然应该谨慎使用它，并且仅当您发现自己多次使用导入文件中的内容时。

**编辑：**更新为更具体的方法，因为这就是这个问题所指的。无论导入什么（常量或方法），该原则都适用。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2018-03-01T07:11:08.253

我认为静态导入对于在使用 utils 类（如`Arrays`和`Assertions`.

[不知道为什么，但罗斯跳过了他引用的文档](https://docs.oracle.com/javase/8/docs/technotes/guides/language/static-import.html)中提到这一点的最后一句话。

> 使用得当，静态导入可以通过删除类名重复的样板来使您的程序更具可读性。

基本上从这个博客复制：[https ://medium.com/alphadev-thoughts/static-imports-are-great-but-underused-e805ba9b279f](https://medium.com/alphadev-thoughts/static-imports-are-great-but-underused-e805ba9b279f)

例如：

**测试中的断言**

这是我认为我们都同意的最明显的案例

```
Assertions.assertThat(1).isEqualTo(2);

// Use static import instead
assertThat(1).isEqualTo(2); 
```

**Utils 类和枚举**

在使用 utils 类时，可以在许多情况下删除类名，从而使代码更易于阅读

```
List<Integer> numbers = Arrays.asList(1, 2, 3);

// asList method name is enough information
List<Integer> numbers = asList(1, 2, 3); 
```

java.time 包有一些应该使用的情况

```
// Get next Friday from now, quite annoying to read
LocalDate.now().with(TemporalAdjusters.next(DayOfWeek.FRIDAY));

// More concise and easier to read
LocalDate.now().with(next(FRIDAY)); 
```

**何时不使用的示例**

```
// Ok this is an Optional
Optional.of("hello world");

// I have no idea what this is 
of("hello world"); 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-01-07T15:57:13.423

我同意从可读性的角度来看它们可能存在问题，应该谨慎使用。但是当使用一个常见的静态方法时，它们实际上可以增加可读性。例如，在 JUnit 测试类中，诸如此类的方法`assertEquals`是显而易见的。类似的方法来自`java.lang.Math`.

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-01-07T16:35:07.887

我经常将它用于颜色。

```
static import java.awt.Color.*; 
```

颜色不太可能与其他颜色混淆。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-03-19T23:24:53.643

我建议在将 OpenGL 与 Java 一起使用时使用**静态导入**，这是属于*“大量使用实用程序类中的常量”*类别的用例

考虑到

```
import static android.opengl.GLES20.*; 
```

允许您移植原始 C 代码并编写可读的内容，例如：

```
glActiveTexture(GL_TEXTURE0);
glBindTexture(GL_TEXTURE_2D, texture);
glUniform1i(samplerUniform, 0);
glBindBuffer(GL_ARRAY_BUFFER, vtxBuffer);
glVertexAttribPointer(vtxAttrib, 3, GL_FLOAT, false, 0, 0); 
```

而不是那种普遍存在的丑陋：

```
GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, texture);
GLES20.glUniform1i(samplerUniform, 0);
GLES20.glBindBuffer(GLES20.GL_ARRAY_BUFFER, vtxBuffer);
GLES20.glVertexAttribPointer(vtxAttrib, 3, GLES20.GL_FLOAT, false, 0, 0); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-10-30T16:37:04.727

在将数学繁重的代码从 C/C++ 移植到 java 时，我使用“import static java.lang.Math.*”。数学方法将 1 映射到 1，并且在没有类名限定的情况下更容易区分移植的代码。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-07T15:48:56.047

由于您刚才提到的问题，静态导入是我从未使用过且不打算使用的唯一 Java 的“新”功能。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-05-25T13:16:22.577

谈论单元测试：大多数人对*mocking*框架提供的各种静态方法使用静态导入，例如`when()`或`verify()`.

```
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when; 
```

当然，当使用唯一的断言时，您应该使用`assertThat()`它来静态导入所需的 hamcrest 匹配器，如下所示：

```
import static org.hamcrest.Matchers.*; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-11-09T18:09:12.087

我发现这在使用实用程序类时非常方便。

例如，而不是使用：`if(CollectionUtils.isNotEmpty(col))`

我可以改为：

```
import static org.apache.commons.collections.CollectionUtils.isNotEmpty;
if(isNotEmpty(col)) 
```

当我在代码中多次使用此实用程序时，哪个 IMO 增加了代码的可读性。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-07T15:57:48.010

它们有助于减少冗长，特别是在调用大量导入方法的情况下，并且本地方法和导入方法之间的区别很明显。

一个例子：涉及对 java.lang.Math 的多次引用的代码

另一个：[一个 XML 构建器类](http://practicalxml.sourceforge.net/apidocs/net/sf/practicalxml/builder/XmlBuilder.html)，其中将类名添加到每个引用会隐藏正在构建的结构

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-07-26T10:30:13.407

我认为静态导入对于 gettext 样式的 NLS 来说很简洁。

```
import static mypackage.TranslatorUtil._;

//...
System.out.println(_("Hello world.")); 
```

这既将字符串标记为必须提取的字符串，又提供了一种简单而干净的方法来用其翻译替换字符串。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-08-25T16:16:21.693

IMO 静态导入是一个相当不错的功能。绝对正确的是，对静态导入的严重依赖使代码不可读，难以理解静态方法或属性属于哪个类。然而，根据我的经验，它成为一个有用的特性，尤其是在设计`Util`提供一些静态方法和属性的类时。每当提供静态导入时出现的歧义可以通过建立代码标准来规避。根据我在一家公司的经验，这种方法是可以接受的，并且可以使代码更清晰、更易于理解。`_`最好我在前面的静态方法和静态属性中插入字符*（不知何故从C中采用）*. 显然，这种方法违反了 Java 的命名标准，但它使代码更加清晰。例如，如果我们有一个 AngleUtils 类：

```
public class AngleUtils {

    public static final float _ZERO = 0.0f;
    public static final float _PI   = 3.14f;

    public static float _angleDiff(float angle1, float angle2){

    }

    public static float _addAngle(float target, float dest){

    }
} 
```

在这种情况下，静态导入提供了清晰性，并且代码结构对我来说看起来更优雅：

```
import static AngleUtils.*;

public class TestClass{

    public void testAngles(){

        float initialAngle = _ZERO;
        float angle1, angle2;
        _addAngle(angle1, angle2);
    }
} 
```

马上有人可以分辨出哪个方法或属性来自静态导入​​，它隐藏了它所属的类的信息。我不建议对作为模块组成部分并提供静态和非静态方法的类使用静态导入，因为在这些情况下，了解哪个类提供某些静态功能很重要。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-01-07T17:42:38.750

您需要在以下情况下使用它们：

*   您希望使用`switch`带有枚举值的语句
*   你想让你的代码难以理解

* * *

## 回答 #16

> 赞同：-5
> 
> 时间：2009-01-07T16:22:54.120

我尽可能使用它们。如果我忘记了，我有 IntelliJ 设置来提醒我。我认为它看起来比完全限定的包名称要干净得多。

# python - 从 CPython 迁移到 Jython

> ID：420792
> 
> 赞同：24
> 
> 时间：2009-01-07T15:46:10.123
> 
> 标签：python, migration, jython, cpython

我正在考虑将我的代码（大约 30K LOC）从 CPython 移动到 Jython，以便我可以更好地与我的 java 代码集成。

是否有我应该查看的清单或指南来帮助我进行迁移？有没有人有做类似事情的经验？

通过阅读[Jython 站点](http://jython.sourceforge.net/docs/differences.html)，大多数问题似乎都太模糊而无法困扰我。

我确实注意到：

*   线程安全是个问题
*   Unicode 支持似乎完全不同，这对我来说可能是个问题
*   mysqldb 不行，需要换成zxJDBC

还要别的吗？

相关问题：[编写适用于 CPython、Jython 和 IronPython 的 python 代码的一些策略是什么](https://stackoverflow.com/questions/53543/what-are-some-strategies-to-write-python-code-that-works-in-cpython-jython-and-i)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-04-05T13:03:03.387

首先，我不得不说 Jython 的实现非常好。大多数事情“正常工作”。

以下是我遇到的一些情况：

*   当然，C 模块不可用。

*   open('file').read() 不会自动关闭文件。这与垃圾收集器的差异有关。这可能会导致打开文件过多的问题。最好使用“with open('file') as fp”成语。

*   设置当前工作目录（使用 os.setcwd()）适用于 Python 代码，但不适用于 Java 代码。它模拟所有与文件相关的当前工作目录，但只能为 Jython 这样做。

*   XML 解析将尝试验证外部 DTD（如果可用）。由于解析器将通过网络下载 DTD，这会导致 XML 处理代码的速度大幅下降。我[报告了这个问题](http://bugs.jython.org/issue1268)，但到目前为止它仍未修复。

*   __ del __ 方法在 Jython 代码中很晚才被调用，而不是在对对象的最后一个引用被删除之后立即调用。

有一个[旧的差异列表](http://jython.sourceforge.net/archive/21/docs/differences.html)，但没有最近的列表。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-07T17:01:35.137

到目前为止，我注意到了另外两个问题：

*   不能保证字符串实习 'a' 是 'a' （它只是 CPython 上的一个实现侥幸）。这可能是一个严重的问题，并且确实存在于我正在移植的一个库中（Jinja2）。单元测试（一如既往）是你最好的朋友！

```
Jython 2.5b0（主干：5540，2008 年 10 月 31 日，13:55:41）
>>> 'a' 是'a'
真的
>>> s = 'a'
>>> 'a' 是 s
错误的
>>> 'a' == s   
真的
>>> intern('a') 是实习生
真的

```

这是关于 CPython 的同一会话：

```
Python 2.5.2（r252:60911，2008 年 10 月 5 日，19:24:49）
>>> 'a' 是'a'
真的
>>> s = 'a'
>>> 'a' 是 s
真的
>>> 'a' == s
真的
>>> intern('a') 是实习生
真的

```

*   os.spawn* 函数未实现。而是使用 subprocess.call。我真的很惊讶，因为使用 subprocess.call 的实现很容易，而且我相信他们会接受补丁。

（我一直在做和你类似的事情，最近移植了一个应用程序）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-19T07:31:54.273

我从其他答案和我的经验中收集了一个 wiki。随意编辑和添加东西，但请尽量坚持实用的建议，而不是列出损坏的东西。这是与 Jython 站点[不同的旧列表。](http://jython.sourceforge.net/archive/21/docs/differences.html)

## 资源管理

Jython 不使用引用计数，因此资源在被垃圾回收时被释放，这比您在等效的 CPython 程序中看到的要晚得多

*   `open('file').read()`不会自动关闭文件。最好使用`with open('file') as fp`成语。
*   __ del __ 方法在 Jython 代码中很晚才被调用，而不是在对对象的最后一个引用被删除之后立即调用。

## MySQL 集成

`mysqldb`是 ac 模块，因此在 jython 中不起作用。相反，您应该使用`com.ziclix.python.sql.zxJDBC`与 Jython 捆绑在一起的 .

替换以下 MySQLdb 代码：

```
connection = MySQLdb.connect(host, user, passwd, db, use_unicode=True, chatset='utf8') 
```

和：

```
url = "jdbc:mysql://%s/%s?useUnicode=true&characterEncoding=UTF-8&zeroDateTimeBehavior=convertToNull" % (host, db)
connections = zxJDBC.connect(url, user, passwd, "com.mysql.jdbc.Driver") 
```

您还需要将所有内容替换`_mysql_exception`为`zxJDBC`.

最后，您需要将查询占位符从 替换`%s`为`?`。

## 统一码

*   您不能在 Jython 中表达非法的 unicode 字符。尝试类似的事情`unichr(0xd800)`会导致异常，并且`u'\ud800'` 在代码中包含文字只会造成严重破坏。

## 丢失的东西

*   当然，C 模块不可用。
    *   所以没有[NumPy](http://numpy.scipy.org/)或[SciPy](http://www.scipy.org/)。
*   os.spawn* 函数未实现。而是使用 subprocess.call。

## 表现

*   对于大多数工作负载，Jython 将比 CPython 慢得多。报告的速度要慢 3 到 50 倍。

## 社区

The Jython project is still alive, but is not fast-moving. The [dev mailing list](http://sourceforge.net/mailarchive/forum.php?forum_name=jython-dev) has about 20 messages a month, and there seem to be only about 2 developers commiting code lately.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-11T11:03:51.723

前段时间，当我将一个项目从 CPython 切换到 Jython 时，我意识到时间关键部分的速度降低了高达 50 倍。正因为如此，我留在了 CPython。

但是，现在的版本可能已经改变了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-05T13:10:55.233

您可能还想研究[JPype](http://jpype.sourceforge.net/)。我不确定它与 Jython 相比有多成熟，但它应该允许 CPython 访问 Java 代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-12-16T21:28:04.387

最近，我和一个小组一起为我学校的一位教授做一个项目。早期，我们决定用 Python 编写项目。我们绝对应该使用 CPython。我们用 Python 编写了程序，我们所有的单元测试最终都成功了。因为大多数人已经在他们的计算机上安装了 Java，而不是 Python，所以我们决定将其部署为 Jython jar。因此，我们使用 Swing 编写了 GUI，因为它包含在 Java 的标准库中。

我第一次使用 Jython 运行程序时，它立即崩溃了。一方面，csv.reader 的“.fieldnames”似乎总是无。因此，我不得不更改我们代码的几个部分来解决这个问题。

我的代码的另一部分也崩溃了，它在 CPython 上运行良好。Jython 指责我在分配任何东西之前引用了一个变量（这让我发疯了，事实并非如此）。这是一个例子：[ActiveState's Code Recipe's external sort](http://code.activestate.com/recipes/466302-sorting-big-files-the-python-24-way/)

更糟糕的是，表演很糟糕。基本上，这段代码结合了几个 CSV 文件，其中一个大约 2 GB。在 CPython 中，它在 8.5 分钟内运行。在 Jython 中，它在 25 分钟内运行。

这些问题发生在 2.5.2rc2（撰写本文时的最新版本）。

# c# - 初始化多维数组

> ID：420800
> 
> 赞同：0
> 
> 时间：2009-01-07T15:47:14.507
> 
> 标签：c#, arrays, initialization

```
 Checkbox[,] checkArray = new Checkbox[2, 3]{{checkbox24,checkboxPref1,null},                                    {checkbox23,checkboxPref2,null}}; 
```

我收到错误。我该如何初始化它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:06:53.467

好的，我想我明白这里发生了什么。您正在尝试使用此语法在类级别初始化数组，其中一个复选框也是类级别变量？我对么？

你不能那样做。此时您只能使用静态变量。您需要将初始化代码移动到构造函数中。在班级级别执行以下操作：

```
 CheckBox[,] checkArray; 
```

然后在你的构造函数中：

```
public Form1()
        {
            InitializeComponent();
            checkArray = new CheckBox[2, 3] { { checkbox24,checkboxPref1,null}, {checkbox23,checkboxPref2,null}};
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T15:51:50.753

int[,] 我的数组；myArray = new int[,] {{1,2}, {3,4}, {5,6}, {7,8}};

对我来说……

托尼

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-07T15:53:08.300

我唯一看到你的代码有问题的是它是一个复选框，而不是一个复选框。大写“B”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T15:58:44.903

确保所有变量（checkbox24、checkboxPref1、checkbox23 和 checkboxPref2）都是 CheckBox 类型

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T16:01:38.347

在构造函数中初始化数组的每个元素并且它工作。.

# ruby - 从 Ruby 中的类方法调用私有实例方法

> ID：420813
> 
> 赞同：20
> 
> 时间：2009-01-07T15:49:33.533
> 
> 标签：ruby, oop, access-specifier

我可以创建一个可以被类方法调用的私有实例方法吗？

```
class Foo
  def initialize(n)
    @n = n
  end
  private # or protected?
  def plus(n)
    @n += n
  end
end

class Foo
  def Foo.bar(my_instance, n)
    my_instance.plus(n)
  end
end

a = Foo.new(5)
a.plus(3) # This should not be allowed, but
Foo.bar(a, 3) # I want to allow this 
```

抱歉，如果这是一个非常基本的问题，但我无法通过谷歌搜索找到解决方案。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-07T15:54:19.920

在 Ruby 中，使用 private 或 protected 并没有那么大的作用。您可以在任何对象上调用 send 并使用它拥有的任何方法。

```
class Foo
  def Foo.bar(my_instance, n)
    my_instance.send(:plus, n)
  end
end 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T20:37:56.477

你可以像 Samuel 展示的那样做，但它确实绕过了 OO 检查......

在 Ruby 中，您只能在同一个对象上发送私有方法，并且只对同一个类的对象进行保护。静态方法驻留在元类中，因此它们位于不同的对象（以及不同的类）中 - 因此您无法按照自己的意愿使用私有或受保护。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-08T00:51:02.333

你也可以使用`instance_eval`

```
class Foo
  def self.bar(my_instance, n)
    my_instance.instance_eval { plus(n) }
  end
end 
```

# sharepoint - SSP 搜索数据库中的内容源名称在哪里

> ID：420816
> 
> 赞同：1
> 
> 时间：2009-01-07T15:50:23.330
> 
> 标签：sharepoint, moss, sharepoint-2007, moss2007enterprisesearch

**我需要在SSP 搜索数据库**（或存储它的任何其他地方）中找到包含**内容源名称**（以及**ContentSourceId**）的表。我可以通过 SharePoint 对象模型访问它，但我希望通过 db 表访问它（根据 Microsoft 的说法，这不是一个好习惯）。 我们查看了所有表，我们得到的最接近的表是 MSSCrawlContent，没有 Content Source Name。接近解决问题的文章是[this](http://admincompanion.mindsharp.com/BillBlog/Lists/Posts/Post.aspx?List=2d22afa2-592b-471a-9cd1-4e8de8a2abc0&ID=83)

 **任何人都知道内容源名称的存储位置吗？

顺便说一句 - 需要访问此信息的应用程序位于同一域但在不同的机器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T11:50:36.437

内容源名称和其他一些设置存储在注册表中。例如，在我的服务器中，它们位于 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office Server\12.0\Search\Applications\0fd855c3-777f-4f92-94f6-164b00b29062\Gather\Portal_Content\ContentSources，名称在 ...\ContentSources\0 \内容来源名称。如果您直接在注册表中更改某些设置，则需要重新启动“Office SharePoint Server Search”服务。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-08T14:01:10.897

这不是一个好的做法，因为它的位置可能会随着未来的修补程序和服务包而改变。如果您可以通过 OM 找到它，为什么要在表格中找到它？

另外，考虑到搜索将在未来的版本中发生重大变化，我怀疑这个领域是最容易被改变的领域之一。

jt

# jboss - jboss-service.xml 中 mbean 中的“xmbean-dd”属性是什么意思？

> ID：420819
> 
> 赞同：1
> 
> 时间：2009-01-07T15:51:23.577
> 
> 标签：jboss, jmx

例如，

```
 <mbean code="org.jnp.server.NamingBeanImpl" 
          name="jboss:service=NamingBeanImpl" 
          xmbean-dd="resource:xmdesc/NamingBean-xmbean.xml">
   </mbean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T01:18:02.137

> 如果此 MBean 服务使用 JBoss XMBean 描述符来定义模型 MBean 管理接口，可选的 xmbean-dd 属性指定 XMBean 资源的路径

根据文档中的[3.4.2.1 SARDeployer MBean](http://www.jboss.org/file-access/default/members/jbossas/freezone/docs/Server_Configuration_Guide/4/html/JBoss_MBean_Services-The_SARDeployer_MBean.html#The_SARDeployer_MBean-The_DTD_for_the_MBean_service_descriptor_parsed_by_the_SARDeployer)部分。

基本上，这意味着对于通常没有参数或操作描述的 StandardMBean，您可以在 XML 文件中提供它们。`resource:`前缀指向`$SERVER/conf`目录。查看. `resource:xmdesc/`_`resource:jboss-service.xml`

# c# - 如何正确锁定值类型？

> ID：420825
> 
> 赞同：17
> 
> 时间：2009-01-07T15:52:11.250
> 
> 标签：c#, locking

我正在阅读有关线程和锁定的信息。通常的做法是您不能（也不应该）锁定值类型。

所以问题是，锁定值类型的推荐方法是什么？我知道有几种方法可以做一件事，但我还没有看到一个例子。虽然 MSDN 论坛上有一个很好的帖子，但我现在似乎找不到。

谢谢

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-07T15:54:16.910

使用另一个对象作为锁。

```
int valueType;
object valueTypeLock = new object();

void Foo()
{
    lock (valueTypeLock)
    {
        valueType = 0;
    }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-07T16:04:51.117

您的问题的措辞使我认为您并不完全理解锁定。你不锁定数据，你锁定是为了保护数据的完整性。您锁定的对象是无关紧要的。重要的是您在代码的其他区域中锁定相同的对象，这些区域会改变受保护的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T16:03:57.543

根据您的情况，您可能可以通过利用 System.Threading.Interlocked 来避免使用锁，Jon 的示例中的相同代码变为：

```
System.Threading.Interlocked.Exchange(valueType,0) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T16:21:43.297

我总是使用一个单独的变量来锁定：

```
object syncObj = new object();

void Foo()
{
  lock(syncObj)
  {
    // do some stuff
  }
} 
```

无论如何，锁定值类型是没有意义的，因为值类型是不可变的并且不能被修改。锁定“this”也是有问题的，因为“this”对外部世界是可见的。

有关 Monitor 最初打算如何使用的一些信息，请参阅[Monitor（同步）](http://en.wikipedia.org/wiki/Monitor_%28synchronization%29)

# f# - 你能嵌套一个“双重缺点”模式匹配吗？

> ID：420832
> 
> 赞同：1
> 
> 时间：2009-01-07T15:53:28.627
> 
> 标签：f#, pattern-matching

我想加强一种模式以仅匹配通过附加验证功能的数字。

```
let (|IsValid|_|) n = ...

let (|Nil|One|Two|) (l : int list) =
    match l with 
    | a :: b :: t -> Two(a + b)
    | a :: t      -> One(a)
    | _           -> Nil 
```

'One' 的情况很简单：

```
 | IsValid(a) :: t -> One(a) 
```

“二”的情况对我来说并不明显。它需要验证数字的总和。我可以在不使用 when-guard 的情况下做到这一点吗？

...

编辑：我可以像这样使用 when-guard（带有返回布尔值的 isValid 函数）：

```
 | a :: b :: t when isValid a + b -> Two(a + b) 
```

这不如仅仅匹配一个模式那么优雅；更糟糕的是，a + b 被应用了两次。

另请注意，这是我的实际代码的简化版本（例如，我不是试图简单地匹配不同长度的列表） - 问题是关于双 cons 模式的嵌套匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:02:31.340

当你这样做时：

```
| a :: b :: t -> ... 
```

您不一定要匹配列表中的两个元素。最好使用`[]`而不是`t`完全匹配两个元素——`t`可以是更多元素的列表。

```
 | a :: b :: [] -> Two (a+b) 
```

这将确保您匹配两个且仅两个元素——免费错误检查！即使您希望该函数仅接受 0、1 或 2 个元素的列表，我也建议您这样做。所以，

*编辑：*

```
let (|MatchTwo|_|) = function
    | a :: b :: t -> Some(a + b :: t)
    | _ -> None
let (|Nil|One|Two|) (l : int list) = match l with 
    | MatchTwo(IsValid(a) :: t) -> Two(a)
    | IsValid(a) :: t  -> One(a)
    | _ -> Nil 
```

是的，使用`when`. 这是一团糟。模式匹配就是这样，在匹配中应用函数真的没有意义。但请考虑我之前提到的内容。根据您的示例：

```
match l with
| a :: b :: t when isValid (a+b) -> Two (a+b)
| a :: t when isValid (a) -> One a
| _ -> Nil 
```

如果 isValid 在第一个模式上为假，则第二个模式将匹配长度大于一个的列表 - 被警告。在你的模式中尽可能具体，如果你想匹配一个元素，那就去做。

如果您用于组合 a 和 b（在本例中为 +）的任何操作在计算上都很昂贵，那么您必须`when`在测试 isValid 并返回变体类型之前删除并使用 let 语句。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-09T16:27:52.043

我的解决方案：添加一个“帮助”识别器，其返回值旨在用于父模式：

```
let (|MatchTwo|_|) = function
    | a :: b :: t -> Some(a + b :: t)
    | _ -> None 
```

像这样使用它：

```
let (|Nil|One|Two|) (l : int list) =
    match l with 
    | MatchTwo(IsValid(a) :: t) -> Two(a)
    |          IsValid(a) :: t  -> One(a)
    | _                         -> Nil 
```

# ruby - 如何安装库？

> ID：420838
> 
> 赞同：1
> 
> 时间：2009-01-07T15:54:23.553
> 
> 标签：ruby, rubygems

我正在尝试安装“libxml”Gem（[http://libxml.rubyforge.org/install.xml](http://libxml.rubyforge.org/install.xml)），它说 libxml 需要安装一些其他库才能正常构建和运行：

```
 * libm      (math routines: very standard)
  * libz      (zlib)
  * libiconv
  * libxml2 
```

我安装了 RubyGems 但我想知道例如“libiconv”是否也是一个 gem？

上面这些库的下载安装方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-07T15:58:30.193

我猜你正在运行某种Linux。只需打开您的包管理器并查找库。应该很容易

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-07T15:58:39.863

您应该能够在安装时将包含依赖项参数发送给 gem。

```
gem install libxml --include-dependencies 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T17:58:08.610

这些都是与 Ruby 没有任何关系的 C 库，因此没有打包为 Gem。您必须通过操作系统的包管理器安装它们，或者，如果您的操作系统没有*包*管理器，则手动安装它们。

但是，如果您的操作系统*确实*有包管理器，那么您最好通过操作系统包管理器而不是通过 RubyGems 安装 libxml-ruby，这样所有依赖项都会自动得到满足。在 Debian-ish 系统上，该软件包被称为`libxml-ruby`或类似的东西。

# hash - 密码盐如何帮助抵御彩虹表攻击？

> ID：420843
> 
> 赞同：237
> 
> 时间：2009-01-07T15:55:59.230
> 
> 标签：hash, cryptography, salt, rainbowtable

我在理解密码盐的用途时遇到了一些麻烦。据我了解，主要用途是阻止彩虹表攻击。然而，我见过的实现这一点的方法似乎并没有真正让问题变得更难。

我看过许多教程建议将盐用作以下内容：

```
$hash =  md5($salt.$password) 
```

原因是哈希现在不是映射到原始密码，而是密码和盐的组合。但是说`$salt=foo`and `$password=bar`and `$hash=3858f62230ac3c915f300c664312c63f`。现在有彩虹表的人可以反转哈希并提出输入“foobar”。然后他们可以尝试所有密码组合（f、fo、foo、... oobar、obar、bar、ar、ar）。获取密码可能需要几毫秒的时间，但其他时间不多。

我见过的另一个用途是在我的 linux 系统上。在 /etc/shadow 中，散列密码实际上*与*salt 一起存储。例如，“foo”的盐和“bar”的密码将散列为：`$1$foo$te5SBM.7C25fFDu6bIRbX1`. 如果黑客能够以某种方式获得此文件，我看不出盐的用途，因为`te5SBM.7C25fFDu6bIRbX`已知的反向哈希包含“foo”。

感谢任何人都可以对此有所了解。

**编辑**：感谢您的帮助。总结一下我的理解，盐使散列密码更加复杂，从而使其不太可能存在于预先计算的彩虹表中。我之前误解的是我假设所有哈希都存在彩虹表。

* * *

## 回答 #1

> 赞同：258
> 
> 时间：2009-01-07T16:50:10.820

破解单个密码时，公共盐**不会使字典攻击更难。**正如您所指出的，攻击者可以访问散列密码和盐，因此在运行字典攻击时，她可以在尝试破解密码时简单地使用已知的盐。

公开的盐有两件事：让破解大量密码列表变得更加耗时，并且使得使用彩虹表变得不可行。

要理解第一个，请想象一个包含数百个用户名和密码的密码文件。如果没有盐，我可以计算“md5(attempt[0])”，然后扫描文件以查看该哈希是否出现在任何地方。如果存在盐，那么我必须计算“md5(salt[a] .attempt[0])”，与条目 A 进行比较，然后是“md5(salt[b] .尝试[0])”，与条目 B 进行比较等。现在我`n`要做的工作是原来的两倍，`n`文件中包含的用户名和密码的数量在哪里。

要了解第二个，您必须了解彩虹表是什么。彩虹表是常用密码的预先计算哈希值的大列表。再次想象一下没有盐的密码文件。我所要做的就是浏览文件的每一行，取出散列密码，然后在彩虹表中查找。我永远不必计算单个哈希。如果查找比散列函数（它可能是）快得多，这将大大加快破解文件的速度。

但是如果密码文件是加盐的，那么彩虹表必须包含预先散列的“salt.password”。如果盐足够随机，这不太可能。我的常用预哈希密码列表（彩虹表）中可能会有“hello”、“foobar”和“qwerty”之类的东西，但我不会有“jX95psDZhello”之类的东西或“LPgB0sdgxfoobar”或“dZVUABJtqwerty”预计算。那会使彩虹表大得令人望而却步。

因此，salt 将攻击者减少到每次尝试每行一次计算，当再加上足够长、足够随机的密码时，它（一般来说）是不可破解的。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2009-01-07T17:06:20.227

其他答案似乎没有解决您对该主题的误解，所以这里是：

## 盐的两种不同用途

> 我看过许多教程建议将盐用作以下内容：
> 
> `$hash = md5($salt.$password)`
> 
> [...]
> 
> 我见过的另一个用途是在我的 linux 系统上。在 /etc/shadow 中，散列密码实际上与 salt 一起存储。

您**始终**必须将盐与密码一起存储，因为为了验证用户在您的密码数据库中输入的内容，您必须将输入与盐结合起来，对其进行散列并将其与存储的散列进行比较。

## 哈希的安全性

> 现在有彩虹表的人可以反转哈希并提出输入“foobar”。
> 
> [...]
> 
> 因为 te5SBM.7C25fFDu6bIRbX 的反向散列已知包含“foo”。

不可能像这样反转散列（至少在理论上）。“foo”的哈希值和“saltfoo”的哈希值**没有任何**共同之处。即使在密码散列函数的输入中更改一位也应该完全改变输出。

这意味着您不能使用通用密码构建彩虹表，然后再用一些盐“更新”它。你必须从一开始就考虑盐分。

这就是为什么您首先需要彩虹桌的全部原因。因为您无法从哈希中获取密码，所以您预先计算了最可能使用的密码的所有哈希，然后将您的哈希与它们的哈希进行比较。

## 盐的质量

> 但是说`$salt=foo`

“foo”将是一个**极差**的盐选择。通常你会使用一个随机值，用 ASCII 编码。

此外，每个密码都有自己的盐，与系统上的所有其他盐不同（希望如此）。这意味着，攻击者必须单独攻击每个密码，而不是希望其中*一个*哈希值与她数据库中的值之一匹配。

## 攻击

> 如果黑客能够以某种方式获得此文件，我看不出盐有什么用途，

彩虹表攻击**总是**需要`/etc/passwd`（或使用任何密码数据库），否则您将如何将彩虹表中的哈希与实际密码的哈希进行比较？

至于目的：假设攻击者想要为 100,000 个常用英语单词和典型密码（想想“秘密”）构建一个彩虹表。如果没有盐，她将不得不预先计算 100,000 个哈希值。即使使用 2 个字符的传统 UNIX salt（每个是 64 个选项之一`[a–zA–Z0–9./]`：），她也必须计算和存储 4,096,000,000 个哈希值……这是一个相当大的改进。

* * *

## 回答 #3

> 赞同：88
> 
> 时间：2009-01-07T15:59:47.773

使用盐的想法是使暴力破解比普通的基于字符的密码更难猜测。彩虹表通常在构建时考虑到特殊字符集，并且并不总是包含*所有*可能的组合（尽管它们可以）。

所以一个好的盐值将是一个随机的 128 位或更长的整数。这就是彩虹表攻击失败的原因。通过为每个存储的密码使用不同的盐值，您还可以确保为一个特定的盐值构建的彩虹表（如果您是具有单个盐值的流行系统可能会出现这种情况）不会让您访问所有一次输入密码。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2009-01-10T16:30:37.857

还有一个很好的问题，有许多非常周到的答案——+1 ！

我没有看到明确提到的一个小点是，通过向每个密码添加随机盐，您实际上可以保证**碰巧选择相同密码的两个用户会产生不同的哈希值。**

## 为什么这很重要？

想象一下美国西北部一家大型软件公司的密码数据库。假设它包含 30,000 个条目，其中 500 个具有密码*bluescreen*。进一步假设黑客设法获得了这个密码，比如通过从用户发给 IT 部门的电子邮件中读取该密码。如果密码未加盐，黑客可以在数据库中找到散列值，然后简单地对其进行模式匹配以访问其他 499 个帐户。

对密码加盐可确保 500 个帐户中的每一个都有唯一的（盐+密码），为每个帐户生成不同的哈希，从而将违规减少到单个帐户。并且让我们希望，任何可能天真到在电子邮件中写明文密码的用户都无法访问下一个操作系统的未记录 API。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-07-13T19:18:17.090

我正在寻找一种应用盐的好方法，并找到了这篇带有示例代码的优秀文章：

[http://crackstation.net/hashing-security.htm](http://crackstation.net/hashing-security.htm)

作者建议每个用户使用随机盐，这样获得盐的访问权不会使整个哈希列表变得容易破解。

> 要存储密码：
> 
> *   使用 CSPRNG 生成长随机盐。
> *   将盐添加到密码中，并使用标准加密散列函数（例如 SHA256）对其进行散列。
> *   将盐和哈希都保存在用户的数据库记录中。
> 
> 验证密码：
> 
> *   从数据库中检索用户的盐和哈希。
> *   将盐添加到给定密码并使用相同的散列函数对其进行散列。
> *   将给定密码的哈希值与数据库中的哈希值进行比较。如果它们匹配，则密码正确。否则，密码不正确。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-01-07T16:11:35.173

盐可以使彩虹表攻击失败的原因是，对于 n 位盐，彩虹表必须比没有盐的表大小大 2^n 倍。

您使用“foo”作为盐的示例可以使彩虹表大 1600 万倍。

鉴于 Carl 的 128 位 salt 示例，这会使表变大 2^128 倍——现在已经很大了——或者换一种说法，人们多久才能拥有这么大的便携式存储空间？

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-01-08T00:21:31.160

大多数破坏基于散列的加密的方法都依赖于暴力攻击。彩虹攻击本质上是一种更有效的字典攻击，它旨在使用低成本的数字存储来创建一个可能的密码子集到哈希的映射，并促进反向映射。这种攻击之所以有效，是因为许多密码要么相当短，要么使用几种基于单词的格式之一。

在密码包含更多字符并且不符合常见的基于单词的格式的情况下，此类攻击是无效的。使用强密码开始的用户不会容易受到这种攻击。不幸的是，许多人没有选择好的密码。但是有一个妥协，你可以通过添加随机垃圾来改进用户的密码。所以现在，他们的密码可以有效地变为“hunter2908!fld2R75{R7/;508PEzoz^U430”，而不是“hunter2”，这是一个更强大的密码。但是，由于您现在必须存储这个额外的密码组件，这会降低更强的复合密码的有效性。事实证明，这种方案仍然有净收益，因为现在每个密码，即使是弱密码，不再容易受到相同的预先计算的哈希/彩虹表的影响。相反，每个密码哈希条目仅易受唯一哈希表的攻击。

假设您有一个密码强度要求较弱的网站。如果您完全不使用密码盐，那么您的哈希值很容易受到预先计算的哈希表的影响，那么有权访问您的哈希值的人将因此可以访问大部分用户的密码（但是许多使用易受攻击的密码，这将是相当大的百分比）。如果您使用恒定密码盐，那么预先计算的哈希表不再有价值，因此有人将不得不花时间为该盐计算自定义哈希表，但他们可以逐步这样做，计算涵盖更大排列的表的问题空间。最易受攻击的密码（例如简单的基于单词的密码、非常短的字母数字密码）将在数小时或数天内被破解，不太易受攻击的密码将在数周或数月后被破解。随着时间的推移，攻击者将获得越来越多用户的密码访问权限。如果您对每个密码都使用唯一的盐，那么需要几天或几个月的时间才能访问每个易受攻击的密码。

如您所见，当您从无盐升级到恒定盐再到唯一盐时，您在每一步破解易受攻击的密码的努力都会增加几个数量级。没有盐，您的用户密码中最弱的密码可以轻松访问，使用恒定盐，坚定的攻击者可以访问这些弱密码，使用唯一的盐，访问密码的成本会提高到如此高，以至于只有最坚定的攻击者才能获得访问权限到一小部分易受攻击的密码，然后只付出巨大的代价。

正是这种情况。您永远无法完全保护用户免受错误密码选择的影响，但是您可以将泄露用户密码的成本提高到一个水平，即使泄露一个用户的密码也会非常昂贵。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-07T16:06:02.300

加盐的目的之一是破坏预先计算的哈希表。如果有人有一个包含数百万个预先计算的哈希的列表，即使他们知道哈希和盐，他们也无法在他们的表中查找 $1$foo$te5SBM.7C25fFDu6bIRbX1。他们仍然必须蛮力。

正如 Carl S 所提到的，另一个目的是使暴力破解哈希列表更加昂贵。（给他们所有不同的盐）

即使盐是公开的，这两个目标仍然可以实现。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-07T16:06:38.320

据我所知，盐的目的是使字典攻击更难。

众所周知，许多人会使用常用词而不是看似随机的字符串作为密码。

因此，黑客可以利用这一点而不是仅仅使用蛮力。他不会寻找像 aaa、aab、aac 这样的密码……而是使用单词和常用密码（比如指环王的名字！;)）

因此，如果我的密码是 Legolas，黑客可以尝试并通过“几次”尝试来猜测它。但是，如果我们对密码进行加盐，它变成了 fooLegolas，那么哈希值就会不同，因此字典攻击将不成功。

希望有帮助！

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-07T16:26:09.887

我假设您正在使用 PHP --- md5() 函数，以及 $ 前面的变量 --- 然后，您可以尝试查看这篇文章[Shadow Password HOWTO](http://tldp.org/HOWTO/Shadow-Password-HOWTO-2.html)特别是第 11 段。

另外，如果你害怕使用消息摘要算法，你可以尝试真正的密码算法，例如[mcrypt](http://cl.php.net/mcrypt)模块提供的，或者更强大的消息摘要算法，例如提供[mhash](http://us3.php.net/mhash)模块的算法（sha1、sha256 和其他）。

我认为更强的消息摘要算法是必须的。已知 MD5 和 SHA1 存在冲突问题。

# vb.net - 完整的 Linq 查询而不是 Fluent-NHibernate 的 Lambda？

> ID：420848
> 
> 赞同：2
> 
> 时间：2009-01-07T15:56:32.693
> 
> 标签：vb.net, linq, nhibernate, fluent-nhibernate

我正在尝试使用 Fluent-NHibernate 的查询方法，如下所示：

```
public T[] Query<T>(Expression<System.Func<T, bool>> where)
        {
            return _session.Linq<T>().Where(where).ToArray();
        } 
```

我正在使用 VB，所以要发送一个 lambda 表达式，我可以用这样的行调用它：

```
Dim products = flRepos.Query(Of Product)(Function(p As Product) p.Id > 5) 
```

这种语法是正确的，但是 Fluent 对 Linq to Nhibernate 的底层使用存在一个问题，该问题在使用 VB lambda 表达式时会中断。

我不使用 lambda 表达式很好，我只是不知道如何重写该行以不使用 lambda。

作为参考，在 VB 中使用完整的 linq 查询确实适用于 Linq 2 Nhibernate。这个查询对我来说很好：

```
Dim product = (From p In session.Linq(Of Product)() _ 
                        Where p.Id = testId _ 
                        Select p).FirstOrDefault() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T15:27:24.763

当前的 NHibernate LINQ 模型有很多怪癖，不幸的是，这些问题在 NHibernate 2.1 发布之前不会真正得到解决。NHibernate 核心需要进行一些更改才能真正完全支持它，因此它将成为 2.1 版本的完整/集成部分，而不是 contrib。[Ayende 几个月前发布了一篇博客更新，概述了当前的警告/计划](http://ayende.com/Blog/archive/2008/09/11/NHibernate-2.0-and-Linq.aspx)。

# c++ - 读取应用程序的清单文件？

> ID：420852
> 
> 赞同：41
> 
> 时间：2009-01-07T15:57:01.553
> 
> 标签：c++, windows, visual-c++, manifest

有没有一种简单的方法来读取应用程序已经嵌入的清单文件？

我在考虑替代数据流的思路？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-01-07T20:57:53.740

Windows 清单文件是 Win32 资源。换句话说，它们嵌入到 EXE 或 DLL 的末尾。您可以使用 LoadLibraryEx、FindResource、LoadResource 和 LockResource 来加载嵌入的资源。

这是一个提取自己的清单的简单示例...

```
BOOL CALLBACK EnumResourceNameCallback(HMODULE hModule, LPCTSTR lpType,
    LPWSTR lpName, LONG_PTR lParam)
{
    HRSRC hResInfo = FindResource(hModule, lpName, lpType);
    DWORD cbResource = SizeofResource(hModule, hResInfo);

    HGLOBAL hResData = LoadResource(hModule, hResInfo);
    const BYTE *pResource = (const BYTE *)LockResource(hResData);

    TCHAR filename[MAX_PATH];
    if (IS_INTRESOURCE(lpName))
        _stprintf_s(filename, _T("#%d.manifest"), lpName);
    else
        _stprintf_s(filename, _T("%s.manifest"), lpName);

    FILE *f = _tfopen(filename, _T("wb"));
    fwrite(pResource, cbResource, 1, f);
    fclose(f);

    UnlockResource(hResData);
    FreeResource(hResData);

    return TRUE;   // Keep going
}

int _tmain(int argc, _TCHAR* argv[])
{
    const TCHAR *pszFileName = argv[0];

    HMODULE hModule = LoadLibraryEx(pszFileName, NULL, LOAD_LIBRARY_AS_DATAFILE);
    EnumResourceNames(hModule, RT_MANIFEST, EnumResourceNameCallback, NULL);
    FreeLibrary(hModule);
    return 0;
} 
```

或者，您可以使用 Windows SDK 中的 MT.EXE：

```
>mt -inputresource:dll_with_manifest.dll;#1 -out:extracted.manifest 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-01-08T06:54:48.260

您可以使用命令行清单工具提取/替换/合并/验证清单`mt.exe`，该工具是 Windows SDK 的一部分：

```
C:\Program Files\Microsoft SDKs\Windows\v6.1>mt /?
Microsoft (R) Manifest Tool version 5.2.3790.2075
...
> To extract manifest out of a dll:
mt.exe -inputresource:dll_with_manifest.dll;#1 -out:extracted.manifest 
```

不同地点：

*   C:\Program Files\Microsoft SDKs\Windows\v6.1\bin
*   C:\Program Files (x86)\Windows Kits\10\bin\10.0.18362.0\x86

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-12-27T10:06:28.110

在记事本中打开文件。事情是纯文本的。

![屏幕抓取](https://i.stack.imgur.com/vdIxg.jpg)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-07T16:28:03.660

[这里](http://weblogs.asp.net/kennykerr/archive/2007/07/10/manifest-view-1-0.aspx)有一个清单查看器工具——我不知道作者是否会提供源代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-06-16T05:55:12.337

如果 Resource Tuner 支持 x64 代码，它会很好，但截至今天，它仍然只适用于 32 位应用程序。Resource Hacker（最新的公开测试版）确实支持 x86 和 x64，可从此处获得： http: [//angusj.com/resourcehacker/](http://angusj.com/resourcehacker/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-25T15:32:57.943

在编译的应用程序中查看/编辑清单的最简单方法是使用资源调谐器： [http ://www.restuner.com/tour-manifest.htm](http://www.restuner.com/tour-manifest.htm)

在某些情况下，它比 MS 的 mt.exe 更强大，而且它是一个可视化工具。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-13T00:41:20.627

从 Roger 的代码开始工作，这是我使用的代码。它假定 Manifest 位于 id #1。我猜这是 .exe 的默认设置。请参阅 Wedge 的评论，如果您使用 DLL，您可能还必须检查 id #2。

```
 HMODULE module = ::LoadLibraryEx(pathname, NULL, LOAD_LIBRARY_AS_DATAFILE);
    if (module == NULL)
        return false;
    HRSRC resInfo = ::FindResource(module, MAKEINTRESOURCE(1), RT_MANIFEST); // resource id #1 should be the manifest
    if (resInfo) {
        HGLOBAL resData = ::LoadResource(module, resInfo);
        DWORD resSize = ::SizeofResource(module, resInfo);
        if (resData && resSize) {
            const char *res = (const char *)::LockResource(resData); // the manifest
            if (res) {
                // got the manifest
            }
            ::UnlockResource(resData);
        }
        ::FreeResource(resData);
    }
    ::FreeLibrary(module); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-28T07:52:32.227

通过从项目中删除开发人员许可证 ( `*_TemporaryKey.pfx`) 或更改 .pfx 的名称来解决此问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-10T08:07:57.230

附带提醒：请记住，清单也可以是与应用程序同名的独立文件（由“.manifest”扩展）。

因此，如果您想检查在运行时真正使用了哪个清单，则必须考虑到这一点。

# .net - CAS（代码访问安全）的目的是什么？

> ID：420854
> 
> 赞同：8
> 
> 时间：2009-01-07T15:57:36.573
> 
> 标签：.net, security, code-access-security

我参与过这么多 Web 应用程序，但从未使用过 CAS，也许也从未觉得有必要使用它。

什么时候需要使用 CAS？人们真的在他们的应用程序中使用它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T10:24:29.507

我想我必须是荒野中唯一的声音，并且不同意这里的其他响应者。
正如我在几个月前对类似问题的[回答中所阐述的那样，在某些特定情况下，CAS](https://stackoverflow.com/questions/170844/anyone-really-using-code-access-security-to-protect-their-assemblies-and-or-metho/171235#171235)*是*可行的方法。当然，这仅适用于您非常注重安全并处理敏感系统的情况，并且考虑到这只是提供了额外的防御层，您可能无法到达需要它的地方您修复了应用程序中的所有其他严重问题。
同样，CAS 使您能够以非常精细的方式限制您的应用程序可以做什么，而不仅仅是您的用户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T16:00:26.897

CAS 实际上只在桌面应用程序中有用（可以这么说），您希望限制通过网络运行的应用程序（例如）能够在本地计算机上执行的操作。我发现，即使在这种情况下，愚弄 CAS 也会让人头疼。默认配置通常是最明智的。

这种类型的模型对于 Web 应用程序显然没有多大用处，因为您隐含地信任应用程序中的所有代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T16:34:22.570

The only place I have ever encountered CAS is in Sharepoint where it is used to limit what a custom assembly in the BIN directory can have access to (e.g., the sharepoint object model). Many people think CAS is too complex and not worth the trouble, so they end up throwing the assembly in the GAC. But if you do that, then you better scrutinize the code for any security risks.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T16:55:29.220

[VSTO](http://en.wikipedia.org/wiki/VSTO)是一项有用的技术，可让您从 Office 文档运行以 .NET 语言编写的托管代码，而不是使用 VBA。它需要在客户端机器上以两种方式使用 caspol：

*   权限办公室从部署 DLL 的位置运行 DLL。

*   允许 Office 从打开 Office 文档的位置运行 DLL。

我发现 caspol 是一场噩梦，我认为，就像 Makefiles 一样，只有 1 个 caspol 脚本是从头开始编写的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T16:03:30.870

我从未见过它使用过。

它的存在只是为了让你可以说你的代码应该运行的最高安全级别。它更像是一种诉讼保护机制，而不是其他任何东西，因为你可以声称你的代码不可能被授权执行某个功能.

就个人而言，我认为这是浪费时间，因为它没有为底层操作系统提供真正的保护。

这里有一些来自微软的更多信息：http: [//msdn.microsoft.com/en-us/library/930b76w0 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/930b76w0(VS.71).aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T16:41:57.267

我在学习 WPF 时遇到过一次。在[本](http://blogs.msdn.com/coding4fun/archive/2006/11/30/1178206.aspx)数独教程中使用它来加载其他用户的插件。为插件创建了一个特殊的应用程序域，几乎没有访问权限，并使用 .NET 远程处理进行通信。本教程提供了一些关于安全插件加载的很好的见解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T18:02:39.707

我必须同意这里的其他观点——CAS 是其中一种在纸面上看起来不错的东西，但我*从未*见过它在严肃的 LOB 应用程序中使用过，而且我可能永远也不会。令我惊讶的是，人们经常在面试中问与 CAS 相关的问题——现在*这*完全没有意义。:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-24T16:23:18.340

CAS 的一个示例是在 WPF 托管的浏览器应用程序 (.xbap) 中。

问题在于如何保护客户端免受在浏览器托管的 appdomain 中运行的托管代码的影响。

为此，WPF（更准确地说，PresentationHost.exe）创建了一个具有受限权限的 appdomain。在其边界内运行的代码以一组有限的权限运行（例如，没有文件 IO、没有注册表访问、只有安全打印等）。

考虑 CAS 有用性时要考虑的另一个观点是，有人编写将安装在客户端机器上的库。您如何保护客户端机器及其网络免受浏览器中运行的部分受信任代码的影响，例如作为调用这些库的 WPF 应用程序的一部分？CAS 帮助完成了这里的难题，提出了适当的要求，因此部分受信任的代码只能访问安全公开的功能。

# javascript - 如何使用 jquery 将 div 加载到 html 中

> ID：420856
> 
> 赞同：1
> 
> 时间：2009-01-07T15:57:59.600
> 
> 标签：javascript, jquery, ruby-on-rails

我正在尝试根据下拉列表中的更改将 div 加载到页面中。我要么想显示一个具有 state/zip 或 Province/postal_code 的 div，（每个都是一个文件），但我得到一个“406 Not Acceptable [ [http://localhost/profiles/residency]](http://localhost/profiles/residency]) ”

这是我的 JQuery 代码：

```
$(function(){
    $("#profile_country").change(onSelectChange);
});

function onSelectChange() {
    var selected = $("#profile_country option:selected");
    var selectedText = selected.text();

    if (selectedText == 'United States') {
        $("#residency").load("/profiles/residency");
    }
    else {
        $("#residency").load("/profiles/residency");
    }
} 
```

现在我很茫然，我的“驻留法”应该是什么？在我的路线文件中放什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:11:30.527

A `406 Not Acceptable` response means the `Content-Type` of the data to be returned is not of a type specific in the `Accept` header. I suggest you use [Firebug](http://www.getfirebug.com) to diagnose further.

More information from the W3C [HTTP/1.1 Status Code Definitions](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T16:16:42.997

The problem could be with the Content-Type of your request : Error 406 is usually related to the "Accept" headers so I suppose jquery ask for a specific Content-Type that does not match what the web server gives...

Look at the headers you send when your URL is called. You may have to change your file name to ".html"

# c# - 相当于C#中java的ConcurrentHashMap？

> ID：420860
> 
> 赞同：9
> 
> 时间：2009-01-07T15:58:33.610
> 
> 标签：c#

有没有什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-10-06T15:08:21.410

有一个通用 Dictionary 类用于实现关联数组（又名哈希表）。最近 MS 推出了 ConcurrentDictionary 类： http: [//msdn.microsoft.com/en-us/library/dd287191.aspx](http://msdn.microsoft.com/en-us/library/dd287191.aspx)，这可能是您想要的。它是.Net 4+。:(

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-13T15:19:46.360

ConcurrentHashMap 的基本思想是它是线程安全的，不需要锁。所以所有的“使用锁的想法”基本上就像你说的“使用Java”。

在内部，您使用一些 CAS（比较和交换）操作并保证无论线程如何运行，某些不变量始终保持正确。由于您没有互斥（唯一的原子操作是硬件中的 CAS 操作），因此您完全避免了死锁的可能性，并且通常也有一些性能提升。当然，数据结构的实现（很多）更复杂（这就是为什么准备好一个很酷，否则实现它甚至证明它实际上可以与更多线程一起工作是一件很痛苦的事情）。

我希望 .NET 框架中也有这样的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T19:16:10.683

I'm not familiar with the `ConcurrentHashMap` you're talking about. Perhaps you could define what function it performs that you'd like to have in C# too.

If you just want to guarantee that a collection is thread-safe for concurrent access then you're best off defining your own lock strategy to control access to it.

The `Hashtable.Synchronised(...)` method seen in earlier versions of the .NET framework has been removed (along with the hiding of all ICollection.SyncRoot implementations via explicit implementations in `System.Collections.Generic`). This is because whenever you lock on a publicly accessible object, you're opening up the possibility for other callers to lock on your objects in ways that you can't control, and therefore deadlocks become possible.

Also, a 'synchronised' collection can only guarantee that calls to individual members are safe, however many scenarios involve 'transactions' including many members. Consider the following example:

```
if (collection.Contains(item))
    collection.Get(item); 
```

The `map` object (whatever type it is) might guarantee that both the `Contains` and `Get` methods are thread-safe, but it can't guarantee that the item is still contained in the map by the time `Get` is called. Instead you should use code like this:

```
private readonly object _mapLock = new object();

public void Method()
{
    lock (_mapLock)
    {
        if (collection.Contains(item))
            collection.Get(item);
    }
} 
```

@Oskar suggests using `ReaderWriterLock`. This class has a terrible implementation with worse performance than simple locking. If you're using newer versions of the framework, use `ReaderWriterLockSlim` instead.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-07T16:04:09.930

C#（连同 .NET 的其余部分）有一个 Hashtable...它位于 System.Collections 中。我不确定java中的“并发”HashMap是什么，但是当只有一个作者和任意数量的读者时，Hashtable应该是线程安全的……除此之外，你必须自己管理并发。

# sql-server - 如何使用动态 from 子句创建存储过程

> ID：420863
> 
> 赞同：0
> 
> 时间：2009-01-07T15:58:53.407
> 
> 标签：sql-server

我有一个应用程序的问题，它一遍又一遍地使用相同的存储过程来填充下拉列表中的人员信息。问题是，随着数据的变化，有时人们已经不在了。我有两个视图可供选择，但我想根据应用程序的状态动态更改正在使用的视图。

对于新记录，我只想看到当前的人。如果我正在更新现有记录，我可能希望查看所有人，因为现有记录可能引用不再是当前的人。

我将如何将视图名称传递给我的存储过程，以便从中进行选择？

我已经尝试添加：

```
@view varchar(50)

select a, b from @view 
```

但是我收到一条错误消息，指出我必须声明变量@view。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:05:00.210

如果您只使用两个视图并且知道它们的名称，则可以只将一个位参数传递给一个过程。

```
@useFirstView bit

IF @useFirstView = 1 
   -- select from firstView
ELSE
   -- select from secondView 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T16:06:55.807

您可以在 SP 中创建语句并调用：

```
exec sp_executesql @sql 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-01T15:00:23.167

我想知道完全相同的事情，我在 MSDN 论坛中遇到了这个线程：

[http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/fa523f21-5a8b-421f-99ce-9bb2ec30e848](http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/fa523f21-5a8b-421f-99ce-9bb2ec30e848)

最后看看 Sami Samir 的答案 - 至少对我来说它提供了一个完美的解决方案，我希望它也会为你做同样的事情。

在具有相同字段的固定数量的表/视图之间进行动态选择的动态 SQL 听起来并不正确——难以调试并且容易出错/黑客攻击。

祝一切顺利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T16:07:27.210

您可以使用动态 SQL 来解决您的问题。

```
DECLARE @sqlCommand varchar(1000)
SET @sqlCommand = 'SELECT a, b from FROM ' + @view
EXEC (@sqlCommand) 
```

但我不认为这是最好的解决方案。你可能应该有一个像这样的查询

```
If @IsActiveFlag = TRUE THEN
  SELECT * FROM People WHERE IsActive = 1
ELSE
  SELECT * FROM People
ENDIF 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-07T16:07:47.863

您是否尝试过在存储过程中声明一个变量并将参数分配为它的值？

例如，假设您有一个名为 @view 的参数：

> 声明@viewName nvarchar(50)
> 
> 设置@viewName = @view

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-07T16:24:15.537

您只是错过了变量的声明

```
DECLARE @view VARCHAR(50)
SET @view = 'myView'
SELECT a,b FROM @view 
```

或者如果在存储过程中使用

```
CREATE PROCEDURE SelectFromView
{
    @view VARCHAR(50)
}
AS
BEGIN

    DECLARE @sqlCommand varchar(1000)
    SET @sqlCommand = 'SELECT a, b from FROM ' + @view
    EXEC (@sqlCommand)

END 
```

提防 SQLInjection 攻击，如前所述。

[编辑] 使用来自 Nathan Koop 的代码更正了动态 sql 创建的使用，谢谢。[/编辑]

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-07T16:46:11.640

你的想法很诱人，但这不被支持（为什么这里的人甚至建议声明一个变量？）或者，换句话说，你做错了。

FROM 子句接受表/视图/函数名称（硬编码，不是来自 varchar 变量）或表变量。表变量如下所示：

```
DECLARE @table TABLE (a int, b int). 
```

请注意，它是 TABLE 类型，而不是 VARCHAR。之后，您可以执行以下操作：

```
SELECT a,b FROM @table. 
```

但显然这不是你想要的。我建议使用 sp_executesql （仅当您设置视图/表名称，而不是来自用户数据或类似名称时）或 IF-ELSE 语句。

# ruby-on-rails - 在 RSpec 控制器规范中测试 RJS 的最佳方法是什么？

> ID：420864
> 
> 赞同：6
> 
> 时间：2009-01-07T15:59:18.473
> 
> 标签：ruby-on-rails, rspec

确保在 Controller 操作中生成正确的 RJS 的最佳方法是什么？

例如，我想确保 div 突出显示为：

```
def new
  render :update do |page|
    page.visual_effect :highlight, :some_div
  end
end 
```

**Rant：** 这很快成为我使用 RSpec 一年后对它感到厌倦的原因之一。这应该是一个简单的问题，但似乎没有人能回答。

我一再被告知 RSpec 指定行为，而我在这里尝试做的只是“测试代码”。据我所知，突出显示 :some_div 是一种行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-19T23:02:30.373

是否无法为响应的输出设置控制器测试并查找一些 javascript 格式？

```
 xhr :get, :new
  response.should be_success
  response.should have_text("... test for JS response ...") 
```

我也可能会使用 Selenium 在客户端上进行更全面的测试，而 Controller 测试更像是一种“健全性”检查。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T14:32:42.760

rspec 为您提供了包装 assert_select_rjs 的 have_rjs 助手。以下是一些细节：

[http://jonathan.tron.name/2007/11/24/rspec-and-inline-rjs](http://jonathan.tron.name/2007/11/24/rspec-and-inline-rjs)

不幸的是 assert_select_rjs 只涵盖：

```
:replace, :replace_html, :show, :hide, :toggle, :remove and :insert_html 
```

所以这不会处理你问题中的visual_effect。然而，ARTS 插件确实支持视觉效果。

[http://github.com/timocratic/arts/tree/master](http://github.com/timocratic/arts/tree/master)

您应该能够将其与 rspecs new 'spec/interop/test' 结合使用。

[http://blog.davidchelimsky.net/2009/2/2/rspec-works-with-test-unit](http://blog.davidchelimsky.net/2009/2/2/rspec-works-with-test-unit)

# c# - 为什么 UTF8Encoding.GetBytes 不发出字节顺序标记？

> ID：420867
> 
> 赞同：13
> 
> 时间：2009-01-07T16:00:21.780
> 
> 标签：c#, .net, unicode, encoding, utf-8

该片段说明了一切:-)

```
UTF8Encoding enc = new UTF8Encoding(true/*include Byte Order Mark*/);
byte[] data = enc.GetBytes("a");
// data has length 1.
// I expected the BOM to be included. What's up? 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-07T16:06:41.503

您不希望*每次*调用 GetBytes 时都使用它，否则您将无法（例如）一次写入文件一行。

通过使用[GetPreamble](http://msdn.microsoft.com/en-us/library/system.text.encoding.getpreamble.aspx)公开它，调用者可以在适当的点（即在其数据的开头）插入前导码。我同意文档可能会更清晰。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-07T16:28:31.100

谢谢你俩。以下工作，LINQ 使组合变得简单:-)

```
UTF8Encoding enc = new UTF8Encoding(true);
byte[] data = enc.GetBytes("a");
byte[] combo = enc.GetPreamble().Concat(data).ToArray(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T16:07:24.573

因为预计`GetBytes()`会被调用很多次......你需要使用：

```
byte[] preamble = enc.GetPreamble(); 
```

（仅在序列开始时调用它）并写下它；*这*是 BOM 所在的位置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-09T14:07:08.427

请注意，一般情况下，无论如何您都不需要 UTF-8 的字节顺序标记。它的主要目的是区分 UTF16 BE 和 UTF16 LE。没有 UTF8 LE 和 UTF8 BE 这样的东西。

# sql - 如何混淆 SQL Sprocs？

> ID：420878
> 
> 赞同：8
> 
> 时间：2009-01-07T16:03:40.430
> 
> 标签：sql, stored-procedures, obfuscation

有没有办法隐藏/保护/混淆 MS SQL 存储过程？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-07T16:06:57.977

I can vaguely understand obfuscating code if it's extremely advanced in what it does, but I think obfuscating your SQL may not be worth the hassle.

Anyway, a lot of the SQL I've seen around here comes obfuscated as standard.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T16:09:45.770

If you must hide it, how about the "WITH ENCRYPTION" clause?

[http://blog.sqlauthority.com/2007/07/01/sql-server-explanation-of-with-encryption-clause-for-stored-procedure-and-user-defined-functions/](http://blog.sqlauthority.com/2007/07/01/sql-server-explanation-of-with-encryption-clause-for-stored-procedure-and-user-defined-functions/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-07T16:10:32.523

See the ENCRYPTION option for the CREATE PROCEDURE statement.

[http://msdn.microsoft.com/en-us/library/ms187926.aspx](http://msdn.microsoft.com/en-us/library/ms187926.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-07T16:20:21.287

No. At least, not in a way that is irreversible. SQL Server 2000's "WITH ENCRYPTION" can be reversed to get the original plaintext. The pseudo-code and a T-SQL script that illustrates this is here: [http://education.sqlfarms.com/education/ShowPost.aspx?PostID=783](http://education.sqlfarms.com/education/ShowPost.aspx?PostID=783)

Note: I haven't tried it with SQL 2005 or above, but my guess is it is just as vulnerable.. As the MSDN docs state:

> ENCRYPTION Indicates that SQL Server will convert the original text of the CREATE PROCEDURE statement to an **obfuscated** format.

Emphasis is mine.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-07T16:27:20.447

One option would be to place just the sensitive portions of the stored procedure in a CLR stored procedure, and obfuscate that assembly using a professional obfuscation product.

[http://msdn.microsoft.com/en-us/library/ms131094.aspx](http://msdn.microsoft.com/en-us/library/ms131094.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-07T16:46:43.433

如果你知道的话很容易可逆，但对大多数浏览代码的人来说是可怕的。十六进制编码你的存储逻辑，然后用 EXEC(@hexEncodedString) 执行。
看到这个[帖子](https://stackoverflow.com/questions/200545/attempted-sql-injection-attack-what-are-they-trying-to-do)。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-03-18T14:24:15.997

老帖子，我知道。但我是通过搜索“我为什么要混淆 SQL？”来到这里的。我刚刚安装了一个名为 ApexSQL Refactor（无从属关系）的免费产品，它提供了一个混淆组件。

它提供了几种不同的选项来使您的代码难以阅读。我不确定为什么要提供这样的功能，因为其他人注意到加密存储过程的能力。无论如何，这是它可以从其混淆功能返回的输出示例。

```
CrEAtE Procedure spInsertOrUpdateProduct @ProductNumber nVarChar(25),
@ListPrice Money aS IF exIsTS(selECt * FROm Production.Product WHere
ProductNumber=@ProductNumber AnD ListPrice>1000) uPdatE Production.
Product sET ListPrice=(ListPrice-100) where ProductNumber=
@ProductNumber elsE INSerT intO Production.Product(ProductNumber,
ListPrice) SelECT @ProductNumber,@ListPrice GO SElEct * fRoM
Production.Product gO iNsERT iNTo Production.UnitMeasure(
UnitMeasureCode,Name,ModifiedDate) vAlUeS(N'FT2',N'Square Feet',
'20080923'); Go 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T16:12:05.827

You could use the ENCRYPTION clause when creating the stored procedure.

This would rely on not leaving the source SQL on the customer machine though.

See here for more info:

[http://msdn.microsoft.com/en-us/library/ms187926(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms187926(SQL.90).aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T16:08:26.303

You can always write ordinary code in C# (or VB) and store it outside the database in a DLL.

Then you don't have to worry about obfuscating your SQL.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T16:11:25.940

If you're really worried about someone getting into the DB and seeing the source for the procedure, then as S. Lott said, you can port the procedure to C#. I would recommend LINQ.

However, the database itself should probably be protected from people accessing the code for procedures that shouldn't be. You can restrict a user or group's rights to only have EXECUTE access to a proc if needed.

# visual-studio-2008 - 我的工作项目在 TFS 中消失了

> ID：420888
> 
> 赞同：0
> 
> 时间：2009-01-07T16:05:55.310
> 
> 标签：visual-studio-2008, tfs, tfs-workitem

我们在我的工作场所使用带有 TFS 的 VS2008 进行源代码控制，它工作正常，但是今天我们在尝试将待处理的更改与工作项关联时遇到了问题。通常，当我想将更改与工作项关联时，我只需转到“待定更改”窗口顶部的第二个选项卡，检查适合更改的工作项并签入。但是今天，我所有的工作项都不见了从列表中。我可以从下拉框中选择一个合适的查询，这很好，所以项目就在那里。

我认为问题可能与“我的工作项”查询与错误的 TFS 项目（我们的 TFS 服务器上有两个）相关联，但我不知道如何解决这个问题。我的大多数同事都发生了同样的问题，但有一些（可能的）变化。

那么...**如何将“我的工作项”恢复**到待处理的更改窗口？

编辑：问题在某种程度上仍然存在，但我通过删除团队资源管理器中的第二个项目来解决它。这是可以接受的（目前），因为该项目当前不活动。我不满足于这是一个很好的长期解决方案，但是......

编辑：我知道我可能没有提供足够的信息让任何人了解真正的问题，但我会暂时保持下去，以防有人遇到同样的问题并知道如何解决它：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T14:03:40.537

我第一次看到这种情况是当我将签入与工作项相关联并且查询已更改为另一个团队项目时。你能检查查询是从正确的团队项目中提取的吗？

要检查的另一件事是 TFS 服务器的事件日志是否有任何异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T14:09:10.137

关闭 Visual Studio 的所有实例并在命令行中尝试：“devenv.exe /resetuserdata”

# castle-windsor - 如何告诉 Windsor 向所有注册的实现 IMustBeIntercepted 的组件添加拦截器

> ID：420891
> 
> 赞同：5
> 
> 时间：2009-01-07T16:06:20.037
> 
> 标签：castle-windsor

如果我在 Windsor 注册了几个组件。

IAnimal 提供 BigAnimal IPerson 提供 SmellyPerson IWhale 提供 BlueWhale

等等..非常标准的组件注册

以上所有类型都实现了 IMustBeIntercepted，我如何告诉容器为所有实现 IMustBeImplemented 的类型添加一个拦截器，以便在调用 Resolve 时返回一个 BigAnimal，因为它匹配时定义了一个拦截器。我知道我可以为每一个都这样做，但我想避免它的额外 XML 配置或程序配置

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-22T20:59:31.963

只需创建一个这样的界面：

```
public interface IMustBeIntercepted {} 
```

和这样的设施：

```
public class InterceptionFacility : AbstractFacility {
    protected override void Init() {
        Kernel.ComponentRegistered += new Castle.MicroKernel.ComponentDataDelegate(Kernel_ComponentRegistered);
    }

    void Kernel_ComponentRegistered(string key, Castle.MicroKernel.IHandler handler) {
        if(typeof(IMustBeIntercepted).IsAssignableFrom(handler.ComponentModel.Implementation)) {
            handler.ComponentModel.Interceptors.Add(new InterceptorReference(typeof(TestInterceptor)));
        }
    }
} 
```

`<facility>`然后使用标签将设施注册到容器。现在所有实现的组件都`IMustBeIntercepted`将被拦截器拦截`TestInterceptor`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T20:09:30.157

刚刚写了这个宝贝：

```
 public static BasedOnDescriptor WithInterceptor(this BasedOnDescriptor reg, string interceptorComponentName) {
        return reg.Configure(x=> x.Configuration(
                Child.ForName("interceptors").Eq(
                    Child.ForName("interceptor").Eq(
                        "${" + interceptorComponentName + "}"
                ))));
    } 
```

# c# - 我怎么知道这个 C# 方法是否是线程安全的？

> ID：420895
> 
> 赞同：52
> 
> 时间：2009-01-07T16:06:43.750
> 
> 标签：c#, concurrency, static-methods

我正在为 ASP.NET 缓存项删除事件创建回调函数。

文档说我应该调用一个对象上的方法或我知道将存在的调用（将在范围内），例如静态方法，但它说我需要确保静态是线程安全的。

第 1 部分：我可以做哪些事情来使其成为非线程安全的？

第 2 部分：这是否意味着如果我有

```
static int addOne(int someNumber){
    int foo = someNumber;
    return foo +1; 
} 
```

我打电话给 Class.addOne(5); 和 Class.addOne(6)；同时，根据哪个调用首先设置 foo，我可能会返回 6 或 7 吗？（即竞争条件）

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-07T16:16:21.733

addOne函数*确实*是线程安全的，因为它不访问任何其他线程可以访问的数据。局部变量不能在线程之间共享，因为每个线程都有自己的堆栈。但是，您必须确保函数参数是值类型而不是引用类型。

```
static void MyFunction(int x) { ... } // thread safe. The int is copied onto the local stack.

static void MyFunction(Object o) { ... } // Not thread safe. Since o is a reference type, it might be shared among multiple threads. 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-01-07T16:11:24.143

不，addOne 在这里是线程安全的——它只使用局部变量。这是一个*不是*线程安全的示例：

```
 class BadCounter
 {
       private static int counter;

       public static int Increment()
       {
             int temp = counter;
             temp++;
             counter = temp;
             return counter;
       }
 } 
```

在这里，两个线程可以同时调用 Increment，最终只增加一次。（`return ++counter;`顺便说一句，使用同样糟糕——上面是同一件事的更明确的版本。我扩展了它，所以它更明显是错误的。）

什么是线程安全和不是线程安全的细节可能非常棘手，但一般来说，如果你没有改变任何状态（除了传递给你的状态，无论如何 - 那里有点灰色区域），那么*通常*没问题.

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-01-07T19:14:04.213

线程问题（我最近也一直在担心）来自使用具有单独缓存的多个处理器内核，以及基本的线程交换竞争条件。如果不同内核的缓存访问相同的内存位置，它们通常不会知道另一个，并且可能会单独跟踪该数据位置的状态，而不会返回到主内存（甚至是在所有内存中共享的同步缓存）例如 L2 或 L3 的核心），出于处理器性能的原因。因此，即使是执行顺序互锁技巧在多线程环境中也可能不可靠。

如您所知，纠正此问题的主要工具是锁，它提供了一种独占访问机制（在同一锁的争用之间）并处理底层缓存同步，以便各种受锁保护的访问相同的内存位置代码部分将被正确序列化。您仍然可以在谁获得锁的时间和顺序之间存在竞争条件，但是当您可以保证锁定部分的执行是原子的（在该锁的上下文中）时，这通常更容易处理。

您可以在任何引用类型的实例上获得锁（例如，从 Object 继承，而不是像 int 或 enums 这样的值类型，而不是 null），但了解对象上的锁对访问没有内在影响是非常重要的对于该对象，它只与其他获取同一对象锁定的尝试进行交互。由类使用适当的锁定方案来保护对其成员变量的访问。有时，实例可能会通过锁定自身来保护对其自身成员的多线程访问（例如`lock (this) { ... }`），但通常这不是必需的，因为实例往往只由一个所有者持有，并且不需要保证对实例的线程安全访问。

更常见的是，一个类创建一个私有锁（例如，`private readonly object m_Lock = new Object();`为每个实例中的单独锁以保护对该实例的成员的访问，或`private static readonly object s_Lock = new Object();`为一个中央锁来保护对该类的静态成员的访问）。Josh 有一个更具体的使用锁的代码示例。然后，您必须对类进行编码以适当地使用锁。在更复杂的情况下，您甚至可能希望为不同的成员组创建单独的锁，以减少对不一起使用的不同类型资源的争用。

所以，回到你原来的问题，一个只访问它自己的局部变量和参数的方法将是线程安全的，因为它们存在于当前线程特定的堆栈上它们自己的内存位置，并且不能被访问其他地方——除非你在传递它们之前跨线程共享这些参数实例。

仅访问实例自己的成员（无静态成员）的非静态方法——当然还有参数和局部变量——不需要在单个所有者使用的实例的上下文中使用锁（不需要需要是线程安全的），但是如果打算共享实例并希望保证线程安全访问，则该实例将需要使用特定于该实例的一个或多个锁来保护对其成员变量的访问（锁定实例本身是一种选择）——而不是让调用者在共享不打算线程安全共享的东西时围绕它实现自己的锁。

访问从未被操作过的只读成员（静态或非静态）通常是安全的，但如果它持有的实例本身不是线程安全的，或者如果您需要保证对它的多次操作的原子性，那么您可能需要也可以使用您自己的锁定方案来保护对它的所有访问。在这种情况下，如果实例对自身使用锁定，它可能会很方便，因为您可以简单地通过多次访问实例来获得对实例的锁定以实现原子性，但如果是单次访问，​​则不需要这样做对自身使用锁来使这些访问单独成为线程安全的。（如果不是您的班级，您必须知道它是自锁还是使用您无法从外部访问的私人锁。）

最后，可以从实例中访问不断变化的静态成员（由给定方法或任何其他方法更改）——当然还有访问这些静态成员并且可以从任何人、任何地点、任何时间调用的静态方法——它们有最需要使用负责任的锁定，没有它绝对不是线程安全的，并且可能会导致不可预知的错误。

在处理 .NET 框架类时，Microsoft 在 MSDN 中记录了给定的 API 调用是否是线程安全的（例如，所提供的通用集合类型的静态方法（例如）`List<T>`是线程安全的，而实例方法可能不是——但要特别检查确定）。绝大多数时候（除非它明确说明它是线程安全的），它不是内部线程安全的，因此您有责任以安全的方式使用它。即使个别操作在内部实现线程安全，如果代码执行任何需要原子的更复杂的操作，您仍然需要担心代码的共享和重叠访问。

一个重要的警告是迭代集合（例如 with `foreach`）。即使对集合的每次访问都获得了稳定状态，也不能内在保证它不会在这些访问之间发生变化（如果其他任何地方都可以访问它）。当集合在本地保存时，通常没有问题，但是可以更改的集合（由另一个线程或在循环执行期间！）可能会产生不一致的结果。解决此问题的一种简单方法是使用原子线程安全操作（在您的保护锁定方案内）来制作集合的临时副本（`MyType[] mySnapshot = myCollection.ToArray();`) 然后遍历锁外的本地快照副本。在许多情况下，这避免了一直持有锁的需要，但是根据您在迭代中所做的事情，这可能还不够，您只需要一直防止更改（或者您可能已经拥有它在里面一个锁定的部分，防止访问更改集合以及其他东西，所以它被覆盖了）。

所以，线程安全设计有一点艺术，知道在哪里以及如何获得锁来保护事物在很大程度上取决于你的类的整体设计和使用。很容易变得偏执并认为您必须为所有事情都加锁，但实际上这是关于找到保护事物的正确层。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-07T16:14:08.243

你的方法很好，因为它只使用局部变量，让我们稍微改变一下你的方法：

```
static int foo;

static int addOne(int someNumber)
{
  foo=someNumber; 
  return foo++;
} 
```

这不是线程安全的方法，因为我们正在接触静态数据。然后需要将其修改为：

```
static int foo;
static object addOneLocker=new object();
static int addOne(int someNumber)
{
  int myCalc;
  lock(addOneLocker)
  {
     foo=someNumber; 
     myCalc= foo++;
  }
  return myCalc;
} 
```

我认为这是一个愚蠢的示例，我只是这样做了，如果我正确阅读它，那么 foo 就没有意义了，但是嘿，这是一个示例。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-07T16:26:38.077

正在进行一些研究，可让您检测非线程安全代码。例如[微软研究院](http://research.microsoft.com/en-us/projects/chess/)的国际象棋项目。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-07T16:12:30.477

如果它正在修改函数外部的某些变量，这将只是一个竞争条件。你的例子没有这样做。

这基本上就是您要寻找的。线程安全意味着该函数：

1.  不修改外部数据，或
2.  对外部数据的访问已正确同步，因此任何时候只有一个功能可以访问它。

外部数据可以是存储中的东西（数据库/文件），也可以是应用程序内部的东西（变量、类的实例等）：基本上是在函数范围之外的任何地方声明的任何东西。

您的函数的非线程安全版本的一个简单示例是：

```
private int myVar = 0;

private void addOne(int someNumber)
{
   myVar += someNumber;
} 
```

如果您在没有同步的情况下从两个不同的线程调用它，则查询 myVar 的值会有所不同，具体取决于查询是在对 addOne 的所有调用完成之后发生，还是查询发生在两个调用之间，或者查询发生在任何一个之前电话。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T16:14:35.403

在上面的例子中没有。

线程安全主要与存储状态有关。您可以通过执行以下操作使上述示例成为非线程安全的：

```
static int myInt;

static int addOne(int someNumber){
myInt = someNumber;
return myInt +1; 
} 
```

这意味着由于上下文切换线程 1 可能会调用 myInt = someNumber 然后进行上下文切换，假设线程 1 只是将其设置为 5。然后想象线程 2 进来并使用 6 并返回 7。然后当线程1 再次唤醒它将在 myInt 中有 6 而不是它正在使用的 5 并返回 7 而不是预期的 6。:O

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-07T16:41:38.093

在任何地方，[线程安全](http://es.wikipedia.org/wiki/Thread-Safety)意味着您在访问资源时不会有两个或更多线程发生冲突。通常静态变量——在 C#、VB.NET 和 Java 等语言中——使你的代码*线程不安全*。

在 Java 中存在*synchronized*关键字。但是在 .NET 中，您可以获得程序集选项/指令：

```
 class Foo
{
    [MethodImpl(MethodImplOptions.Synchronized)]
    public void Bar(object obj)
    {
        // do something...
    }
} 
```

非线程安全类的示例应该是*单例*，具体取决于此模式的编码方式。通常它必须实现一个*同步*的实例创建器。

如果不想要*同步方法*，可以尝试加锁方法，比如*自旋锁*。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T16:11:43.787

对两个线程可以同时使用的对象的任何访问都不是线程安全的。

您在第 2 部分中的示例显然是安全的，因为它仅使用作为参数传入的值，但如果您使用对象范围的变量，您可能必须用适当的锁定语句包围访问

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-07T16:11:50.430

`foo`在并发或顺序调用之间不共享，因此`addOne`是线程安全的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-07T16:17:57.297

在您的示例中 'foo' 和 'someNumber' 安全的原因是它们驻留在堆栈上，并且每个线程都有自己的堆栈，因此不共享。

一旦数据有可能被共享，例如，作为全局或共享指向对象的指针，那么您可能会发生冲突并且可能需要使用某种类型的锁。

# sql - 在 SQL Server 企业管理器中创建图表 (SQL 2000)

> ID：420919
> 
> 赞同：2
> 
> 时间：2009-01-07T16:11:46.810
> 
> 标签：sql, sql-server

为了能够在 SQL Server 企业管理器中创建图表，我需要用户的最低权限级别是多少？

我目前被设置为数据阅读器，我无法创建图表。（我不希望能够达到这个权限级别）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-07T16:35:51.460

数据库图表功能实际上是一个非常强大的模式编辑器 - 您也可以更改表/字段和关系。（不知道他们为什么这样做）。我想您需要相当高的权限才能创建图表，因为可以编辑 - 可能是所有者或 ddladmin。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-12T20:27:17.847

经过一些进一步的调查，使用 dbo 角色，我能够创建数据库图表。

# .net - 为什么我不能将 ASP.NET Framework 版本显示为 3.5？

> ID：420941
> 
> 赞同：4
> 
> 时间：2009-01-07T16:17:47.907
> 
> 标签：.net, version

有人可以向我确认，当我的应用程序是用 .NET 3.5 编写时，此代码

```
System.Environment.Version.Major.ToString() 
```

会产生这个

```
2.0.50727.1433 
```

我刚刚迁移到 3.5，我迁移的第一个应用程序是一个内部网站。我认为一个非常简单的指标是在我的应用程序版本旁边添加框架版本，但上面的文本是正在生成的。

我有限的研究表明 .NET 3.5 是 2.0 的“风味”，因此底层框架版本将继续为 2.0。IIS 应用程序池设置表明是这种情况。

这是正确的还是我可以让我的应用程序显示 3.5？

干杯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-07T16:21:23.860

因为 .NET 3.5 使用 CLR 运行时版本 2。3.5 只是在 2.0 运行时之上构建的一组程序集。内部 API 无法区分。这里有一些代码会告诉你是否存在 3.5：

[http://blogs.msdn.com/astebner/archive/2007/11/29/6608419.aspx](http://blogs.msdn.com/astebner/archive/2007/11/29/6608419.aspx)

请注意，这不会告诉您您的代码是否实际上是针对 3.5 运行的，但无论如何您都应该在清单中注意这一点。

# c# - .NET 泛型：使用 Activator 创建的类型作为泛型显示错误的类型？需要解决方法

> ID：420944
> 
> 赞同：1
> 
> 时间：2009-01-07T16:18:25.910
> 
> 标签：c#, .net, generics

这真的让我今天很难过。我确信它很简单，但是......这是我的示例代码：

```
using System;
using System.Collections;

namespace ConsoleApplication1
{
    class Program
    {
        public ArrayList SomeProp { get; set; }

        static void Main(string[] args)
        {
            // Get the Type of a property by reflection.
            Type myPropType = typeof(Program).GetProperty("SomeProp").PropertyType;

            // Create an instance of the determined Type.
            var x = Activator.CreateInstance(myPropType);

            // Now try to use that instance, passing to a method that takes a generic.
            WhatAmI(x);

            Console.ReadKey();
        }

        private static void WhatAmI<T>(T x)
        {
            Console.WriteLine("T is: " + typeof(T).FullName);
            Console.WriteLine("x is: " + x.GetType().FullName);
        }
    }
} 
```

这里的输出是：

```
T is: System.Object
x is: System.Collections.ArrayList 
```

基本上这里发生的事情是我在某个班级有一些财产。它来自什么/来自哪里并不重要。重要的部分是我获得了该属性的 PropertyInfo。从那里我用 Activator 创建了它的类型的一个新实例。

现在，如果我将该创建的实例传递给一个接受泛型参数的函数，泛型类型总是作为对象出现，因为 Activator.CreateInstance() 返回一个对象，所以“var x”是一个对象，在这种情况下不是，一个数组列表。

我需要做的是让泛型类型成为实际类型，在他的情况下是“ArrayList”。

我知道我可以使用一个 Activator.CreateInstance() 来代替，但我不能在该方法的尖括号中使用类型 (PropertyInfo.PropertyType)。

我也可以只转换返回的对象，例如：

```
myPropType x = (myPropType)Activator.CreateInstance(myPropType); 
```

但显然这不会编译......另外它无论如何都不会有效，因为演员是编译时，而且我直到运行时才知道类型，但从概念上讲它是我需要的......

所以我坚持使用这种类型，但我不知道如何将它传递给 WhatAmI() 方法，并且 T 是 ArrayList，而不是 Object。

想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T16:23:40.173

要在运行时使用 a 调用泛型方法`Type`，您需要使用反射 -`MakeGenericMethod`特别是，类似于：

```
typeof(Program).GetMethod("WhatAmI",
    BindingFlags.Static | BindingFlags.NonPublic)
    .MakeGenericMethod(x.GetType()).Invoke(null, new object[] { x }); 
```

否则，编译器`<T>`从变量类型推断 -`object`在这种情况下。

这里的一方面是你可以通过只进行*一次*反射来改进事情- 即不要使用`Activator`，而是使用通用约束：

```
 private static void WhatAmI<T>() where T : new()
    {
        T x = new T();
        Console.WriteLine("T is: " + typeof(T).FullName);
        Console.WriteLine("x is: " + x.GetType().FullName);
    } 
```

定义*没有*arg 的方法，但使用默认构造函数；然后：

```
 // Get the Type of a property by reflection.
    Type myPropType = typeof(Program).GetProperty("SomeProp").PropertyType;

    // Now call a generic method just using the type
    typeof(Program).GetMethod("WhatAmI",
        BindingFlags.Static | BindingFlags.NonPublic)
            .MakeGenericMethod(myPropType).Invoke(null, null); 
```

仅使用类型调用方法 - 实例是在方法*内部*创建的。这通常比重复反射更快。

# java - java包名称约定失败

> ID：420945
> 
> 赞同：9
> 
> 时间：2009-01-07T16:18:40.730
> 
> 标签：java, naming-conventions

我刚刚开始学习 Java SE 并且对包名称的通常 Java 约定没有问题，例如`com.example.library_name_here.package_name_here`

除了。

我一直注意到在一些相当知名的软件包中未能遵守这一点。

*   [J线](http://jline.sourceforge.net/)：`jline.*`
*   雅各布：（`com.jacob.*`没有 jacob.com [）](https://sourceforge.net/projects/jacob-project/)
*   [JNA](https://github.com/twall/jna/)：（`com.sun.jna.*`网站上的免责声明说注意：Sun 不赞助这个项目，即使包名称 (com.sun.jna) 可能暗示其他情况。）

所以我想知道，是否存在通常的反向域名约定失效的情况，并且有很好的方法来解决它？我能想到的唯一情况是围绕域名所有权问题（例如，您更改项目托管/域名，或者已经有一个众所周知的包对您的域具有“抢注权”，或者您对域的所有权运行出去&别人抢购它）。

编辑：如果我使用我公司的域名，并且我们被收购或分拆，我们应该如何处理包名？保持它们相同或重命名？（我认为从引用包的编译类然后丢失的角度来看重命名是不好的）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-07T16:24:08.347

这是一个命名约定。没有真正的要求甚至期望包名映射到域名。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-07T16:39:22.233

一般的想法是两个组织不会拥有同一个域，因此将域名用作包的一部分可确保没有命名空间冲突。然而，这只是一个建议。

有人有充分的理由在 sun 命名空间中拥有包。如果他们提供公共 API 的实现，通常需要在 API 的命名空间中实现类。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-07T17:21:28.793

如果您正在逐步提高 Java 学习曲线，我会更担心使您的打包结构清晰，以便您可以轻松找到所需的类。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T18:15:06.500

Packages are used to avoid ambiguity and collisions between components built by various entities. As long as you follow the convention, and nobody illicitly uses your slice of the package namespace pie, you shouldn't need to worry about what others have used.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T16:23:06.523

唯一重要的事情（恕我直言）是包名称的部分按重要性“排序”，即您不会以 gui.myprog、util.myprog、main.myprog 结尾，而是以 myprog.gui、myprog 结尾.util 和 myprog.main。包名是否真的以顶级域开头，后跟域名与我无关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-07T16:24:44.867

您不能将语言关键字用作包名称的一部分，这是无法应用域名约定的另一种情况 - [LONG Building Technologies运气不好](http://long.com/)

但是，约定就是这样，约定，它存在的唯一原因是它最大限度地减少了不同项目意外选择相同包名称的可能性。如果你跟不上，那也不是什么大问题。

# sql - 视图中的日期范围 - 这正常吗？

> ID：420948
> 
> 赞同：1
> 
> 时间：2009-01-07T16:19:02.350
> 
> 标签：sql, views, enterprise

我最近开始在一家拥有庞大“企业”应用程序的公司工作。在我的上一份工作中，我设计了数据库，但在这里我们有一个我不属于的整个数据库架构部门。

他们的数据库中的一个奇怪的事情是他们有一堆视图，而不是让用户提供他们想要查看的日期范围，而是加入一个（全局临时）表“TMP_PARM_RANG”以及一个开始和结束日期。每次主应用程序开始处理请求时，它做的第一件事就是“ `DELETE FROM TMP_PARM_RANG`;” 然后插入其中。

这似乎是一种奇怪的做事方式，而且不是很安全，但这里的其他人似乎都可以接受。这是正常的，还是我的不安有道理？

**更新** 我应该提到他们使用事务和每个客户端的锁，所以它可以防止大多数并发问题。此外，实际上有数十个甚至数百个视图都依赖于`TMP_PARM_RANG`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-07T16:28:18.527

如果数据库是oracle，可能是全局临时表；每个会话都会看到自己的表版本，插入/删除不会影响其他用户。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-07T16:32:26.597

我理解正确吗？

有这样的观点：

```
SELECT * FROM some_table, tmp_parm_rang
  WHERE some_table.date_column BETWEEN tmp_parm_rang.start_date AND tmp_parm_rang.end_date; 
```

然后在某些前端，用户输入日期范围，应用程序执行以下操作：

1.  从 TMP_PARM_RANG 中删除所有现有行
2.  使用用户值将新行插入 TMP_PARM_RANG
3.  从视图中选择所有行

我想知道对 TMP_PARM_RANG 的更改是提交还是回滚，如果是，什么时候？它是临时表还是普通表？基本上，根据这些问题的答案，多个用户并行执行该过程可能并不安全。人们希望如果是这种情况，他们早就发现并解决了这个问题，但谁知道呢？

即使它以线程安全的方式完成，对数据库进行更改以进行简单的查询操作也没有多大意义。这些 DELETE 和 INSERT 正在生成完全没有必要的重做/撤消（或非 Oracle 数据库中的任何等效项）。

实现相同目标的一种简单且更正常的方法是执行此查询，将用户的输入绑定到查询参数：

```
SELECT * FROM some_table WHERE some_table.date_column BETWEEN ? AND ?; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-07T16:27:30.040

这张表一定有一些商业原因。我已经看到了日期硬编码的视图，它们实际上是一个分区视图，并且他们使用日期作为分区字段。我还看到加入表格，例如在处理夏令时时想象一个返回 DST 期间发生的所有活动的视图。而且这些东西都不会删除并插入表中……这很奇怪

因此，要么有更深层次的原因需要挖掘，要么只是当时似乎是一个好主意，但为什么这样做已经作为部落知识丢失了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-07T16:23:31.577

就个人而言，我猜这将是一个非常奇怪的事件。从你所说的两个方法同时调用该过程可能会非常有趣。

通常，日期范围作为视图上的过滤器完成，而不是由存储在其他表中的外部值驱动。

我能看到的唯一理由是，如果有一个多步骤过程，一次只执行一次，并且跨多个存储过程的多个操作需要日期。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-07T16:58:11.960

我想这会让他们支持多个范围。例如，他们可以返回 2008 年 1 月 1 日和 2009 年 1 月 1 日以及 2006 年 1 月 1 日和 2007 年 1 月 1 日之间的所有日期，以将 2006 年的数据与 2008 年的数据进行比较。你不能用一对绑定参数来做到这一点。另外，我不知道 Oracle 是如何对视图进行查询计划缓存的，但也许与此有关？随着日期列作为视图的一部分被检查，服务器可以缓存一个始终假定日期将被检查的计划。

只是在这里抛出一些猜测:)

另外，你写道：

> 我应该提到他们使用事务和每个客户端的锁，所以它可以防止大多数并发问题。

虽然这可以防止由于并发导致的数据一致性问题，但当涉及到由于并发导致的性能问题时，它会受到伤害。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-07T16:26:49.277

他们是否还在应用程序中添加一个来为主键生成下一个唯一值？

似乎共享状态的概念无法理解这些人，或者共享状态的原因也无法理解。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-07T16:27:25.953

对我来说，这听起来像是一个非常奇怪的算法。我想知道它如何处理并发 - 它是否包含在事务中？

在我看来，有人只是不确定如何编写他们的 WHERE 子句。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T16:56:14.053

这些视图可能用作临时表。在 SQL Server 中，我们可以为此目的使用表变量或临时表 (# / ##)。尽管专家不建议创建视图，但我已经为我的 SSRS 项目创建了很多视图，因为我正在处理的表不相互引用（没有 FK，说真的！）。我必须解决数据库设计中的缺陷；这就是为什么我经常使用视图。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T18:12:43.730

在这里使用您评论的全局临时表 GTT 方法，该方法对于多用户系统肯定是安全的，所以那里没有问题。如果这是 Oracle，那么我想检查系统是否正在使用适当级别的动态采样以便适当地加入 GTT，或者调用 DBMS_STATS 以提供有关 GTT 的统计信息。

# mysql - MySQL Non-Negative INT Columns

> ID：420964
> 
> 赞同：4
> 
> 时间：2009-01-07T16:22:36.603
> 
> 标签：mysql

I want to do the following query:

```
UPDATE `users` SET balance = (balance - 10) WHERE id=1 
```

But if the balance will become a negative number I want an error to be returned. Any ideas on if this is possible?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-07T16:27:45.827

If you do

```
UPDATE `users` SET balance = (balance - 10) WHERE id=1 and balance >=10 
```

You should be able to detect that a row was not modified.

Note that while another answer suggests using an unsigned int column, this may not work:

Create a test table

```
create table foo(val int unsigned default '0');
insert into foo(val) values(5); 
```

Now we attempt to subtract 10 from our test row:

```
update foo set val=val-10;
Query OK, 1 row affected, 1 warning (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 1

mysql> select * from foo;
+------------+
| val        |
+------------+
| 4294967295 |
+------------+ 
```

This was on mysql 5.0.38

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T16:30:21.190

You can make the balance field of the users table an unsigned int:

```
ALTER TABLE `users` CHANGE `balance` `balance` INT UNSIGNED; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T16:27:51.740

This sort of things is done by [triggers](http://dev.mysql.com/doc/refman/5.0/en/triggers.html). MySql have support for triggers only since 5.0.2.

```
DELIMITER $$
CREATE TRIGGER balance_check BEFORE INSERT ON user FOR EACH ROW
BEGIN
    IF new.balance < @limit_value THEN
        -- do something that causes error. 
        -- mysql doesn't have mechanism to block action by itself
    END IF;
END $$
DELIMITER ; 
```

Triggers in MySql are quite rudimentary. You have to hack things around to do some things (e.g. cause error).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T16:29:50.690

I dont think you can do this with a simple query. you should use a mysql user defined function that manage that before update the row. or a trigger

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T20:24:17.723

只是一个不适合作为评论的提示。我只是想从 32047 中减去 32000（不是负结果）并且遇到了错误。同样令人困惑的是，我遇到了 BIGINT 错误，但我的减法是在 SMALLINT 列上！（这仍然没有意义。）

如果即使您的“余额”是正数，您也收到“超出范围”错误，请尝试在查询末尾添加“限制 1”。也许这是 MySQL 中的一个错误？

```
mysql> update posts set cat_id=cat_id-32000 where timestamp=1360870280;
ERROR 1690 (22003): BIGINT UNSIGNED value is out of range in '(`xxxxx`.`posts`.`cat_id` - 32000)'

mysql> update posts set cat_id=cat_id-32000 where timestamp=1360870280 limit 1; 
Query OK, 1 row affected (6.45 sec)
Rows matched: 1  Changed: 1  Warnings: 0 
```

在我的情况下，时间戳是唯一的（我只是检查确定），但在创建表时没有明确定义为唯一。那么为什么这里的“限制1”是必要的呢？但谁在乎，它有效！

# vb.net - LINQ to SQL 查询语法

> ID：420976
> 
> 赞同：1
> 
> 时间：2009-01-07T16:25:01.200
> 
> 标签：vb.net, linq, linq-to-sql

我有几个以组织表为中心的表，该表仅包含唯一的 ID 值。然后，每个组织都可以位于特定位置并具有特定名称。棘手的部分是组织支持位置和名称更改，每次更改都有指定的生效日期。对于这个例子，我有 4 个相关的表：

组织：ID（PK、int、身份）

位置：ID (PK, int, identity), Name (varchar), AltLat (float), AltLong (float)

组织位置：组织ID（FK，int），位置（FK，int），eff_date（日期时间）

组织名称：组织ID（FK，int），名称（ntext），eff_date（日期时间），图标（nvarchar（100））

我需要检索的是截至特定日期在给定位置的所有位置以及所有组织的列表，并将它们投影到我的业务实体中。换句话说，我将提供一个日期，并且需要返回每个位置，该组织与 organization_location 条目相关，其中最近的 eff_date 小于提供的日期。每个组织都一样，我需要截至日期的名称。

这是我开始的，但它似乎不起作用：

```
Dim query = From loc In dc.Locations _
           Where loc.AltLong IsNot Nothing And loc.AltLat IsNot Nothing _
           Select New AnnexA.Entities.AnnexALocation With {.ID = loc.ID, .Name = loc.Location, .Y = loc.AltLat, .X = loc.AltLong, _
                            .Units = From ol In loc.organization_locations Let o = ol.Organization.organization_names.Where(Function(ed) (ol.eff_date < Date.Parse("1/1/2011"))).OrderByDescending(Function(od) (od.eff_date)).First() Select New AnnexA.Entities.AnnexAMillitaryUnit With {.ID = o.ID, .Name = o.name, .IconPath = o.icon}} 
```

我更喜欢 VB 语法，但如果你只能给我一个 C# 查询，我可以使用它。我尝试了一些其他变体，但无论我尝试哪种括号组合，我最终都会收到有关预期“}”或成员不属于实体集的语法错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-07T19:47:24.067

我想我理解你在这里想要做什么，看起来一些简单的连接可以摆脱你在查询结束时所做的所有复杂事情。（它在 C# 中，但它应该非常直接地用于 VB）

```
from loc in dc.Locations
join ol in dc.organization_locations on loc.ID equals ol.location
join orn in dc.organization_names on ol.organization_id equals orn.organization_id
where loc.AltLong != null
  && loc.AltLong != null
  && ol.eff_date < Date.Parse("1/1/2011")
orderby ol.eff_date
select new AnnexA.Entities.AnnexAMillitaryUnit 
    { ID = loc.ID, Name = orn.name, IconPath = orn.icon} 
```

让我知道这是否有效或是否需要任何微调...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T15:52:23.060

我需要考虑组织的最近（截至给定日期）位置和组织名称。不只是在日期之前。例如，采取美国总统选民奥巴马。在此示例中，有 3 个位置：他的家、Hay-Adams 酒店和白宫。在过去的几个月里，他也已经在3个职称上消失了：参议员奥巴马，总统选出奥巴马，很快就会成为奥巴马总统。

如果您将日期“2008 年 1 月 1 日”传递到此查询中，您应该返回所有 3 个位置，其中“参议员奥巴马”（组织名称）属于他的“房子”（组织位置），另外两个使用我们的样本，位置中不应有“组织”。如果您要在“12/1/2008”之日起，他仍然在技术上居住在他的家中，但随后他有“总统选民奥巴马”的标题，所以结果将反映这一点。如果您要通过今天的日期，他的名字仍然是“总统选民奥巴马”，但他的位置改为“Hay-Adams Hotel”。如果您输入“2009 年 1 月 20 日”之后的任何日期，他的头衔将是“奥巴马总统”，他的位置将是“白宫”。

我希望这是有道理的，即使你对政治不感兴趣或者不是来自美国。我需要结果来向我展示所有内容的位置以及在给定时间点所有内容的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T14:21:54.837

我最终使用以下代码完成了这项工作：

```
Dim query4 = From loc In dc.Locations _
                 Let curNames = (From ons In dc.organization_names _
                                Where ons.eff_date <= ssDate _
                                Order By ons.eff_date Descending _
                                Group ons By ons.organization_id Into gNames = Group _
                                Select New With { _
                                    Key .Key = organization_id, _
                                    .Result = gNames.Take(1)}) _
                                    .SelectMany(Function(a) (a.Result)) _
                Let curLocs = (From oLocs In dc.organization_locations _
                               Where oLocs.eff_date <= ssDate _
                               Order By oLocs.eff_date Descending _
                               Group oLocs By oLocs.organization_id Into gLocs = Group _
                               Select New With { _
                                Key .Key = organization_id, _
                                .Result = gLocs.Take(1)}) _
                                .SelectMany(Function(a) (a.Result)) _
                Where loc.AltLat IsNot Nothing And loc.AltLong IsNot Nothing _
                Select New AnnexA.Entities.AnnexALocation With { _
                    .ID = loc.ID, .Name = loc.Location, .Y = loc.AltLat, .X = loc.AltLong, _
                    .Units = From curLoc In curLocs _
                             Where curLoc.location = loc.ID _
                             From curName In curNames _
                             Where curName.organization_id = curLoc.organization_id _
                             Select New AnnexA.Entities.AnnexAMillitaryUnit With { _
                                .ID = curLoc.organization_id, _
                                .Name = curName.name, _
                                .IconPath = curName.icon}} 
```

感谢您花时间看这个！

# .net - 将 ComboBox 绑定到 IList 并使用 SelectedValue

> ID：420998
> 
> 赞同：5
> 
> 时间：2009-01-07T16:28:59.367
> 
> 标签：.net, winforms, data-binding, combobox, selectedvalue

我的`ComboBox`设置如下，（如果重要的话）`KVPList`在哪里：`IList``KeyValuePair`

```
comboBox.DisplayMember = "Value";
comboBox.ValueMember = "Key";
comboBox.DataSource = KVPList; 
```

然后我设置了一个绑定`SelectedValue`，绑定到一个`BindingSource`（到一个`DataSet`）。无论出于何种原因，在显示表单时组合框总是显示为空白。但是，它已正确填充（`IList`显示的值很好并且可以选择）。

现在，我已尽我所能进行追踪，它似乎在绑定时最初正确设置了 SelectedValue，但随后在某处它被重置为`null`. 我也玩过事情被调用的顺序，但无济于事。

任何人都可以对此有所了解或提出解决方法吗？

作为记录，在同一个表单上，我在同一个表单上还有另一个`ComboBox`，它`SelectedValue`绑定到同一个`BindingSource`. `DataSource`是 a ，而`DataSet`不是 an `IList`，它就像一个魅力。`DataTable`从中制作 a 可能是一种选择`IList`，但它似乎有很多额外的开销；我正在`IList`从枚举中生成。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-07T17:11:52.620

哎哟。在这个基本上浪费了半天之后，我已经弄清楚了。这完全是我的错误。

被`KVPList`设置为`IList`of ，但数据字段的类型为。本质上，数据绑定会触发并设置属性。然后and绑定会触发，再次检查。由于is 的类型为, not ，因此它找不到匹配项，因此将其设置为 null。`KeyValuePair<`**`short`**`,string>`**`int`**`SelectedValue``DisplayMember``ValueMember``SelectedValue``ValueMember``short``int`

装箱和拆箱一定会发生一些有趣的事情，但我现在太累了，无法理解为什么。

我会留下这个问题，以防其他人遇到同样的问题。很难追踪，因为我希望它要么尝试强制转换，要么抛出异常，而不是默默地变为 null。毕竟，`short`and`int`都是值类型，最后我检查的`(int)10 == (short)10`是正确的。*******~~~~*********