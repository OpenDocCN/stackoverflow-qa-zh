# StackOverflow 问答 10951000-10951999

# php - Zend_Db 自定义查询到 db 行而不是数组

> ID：10951009
> 
> 赞同：1
> 
> 时间：2012-06-08T14:41:10.747
> 
> 标签：php, zend-framework, zend-db, zend-db-table

当我在我的 DbTable 上调用 fetchAll() 时，我会在 DbTable 中定义的正确 DbRow 类中得到结果。

但是当我像这样创建自定义查询时，我会在数组中得到结果。是否有任何参数可以强制在 DbRows 中接收此数据，或者我应该自己创建行并用这些数组填充它们？

```
$query = $this->_dbTable->getDefaultAdapter()->select()
        ->from('doctor.doctor')
        ->joinInner('facility.doctorfacility', 'facility.doctorfacility.doctor_id = doctor.doctor.id')
        ->joinInner('facility.facility', 'facility.doctorfacility.facility_id = facility.facility.id')
        ->where(implode(' AND ', $conds));

return $this->_dbTable->getDefaultAdapter()->fetchAll($query); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T18:26:53.977

> “但是当我像这样创建自定义查询时，我会在数组中得到结果”

你得到一个数组，因为你`Zend_Db_Adapter_Abstract::fetchAll()`根据代码中的 docblock 调用它返回一个数组： -

```
/**
 * Fetches all SQL result rows as a sequential array.
 * Uses the current fetchMode for the adapter.
 *
 * @param string|Zend_Db_Select $sql  An SQL SELECT statement.
 * @param mixed                 $bind Data to bind into SELECT placeholders.
 * @param mixed                 $fetchMode Override current fetch mode.
 * @return array
 */
public function fetchAll($sql, $bind = array(), $fetchMode = null) 
```

> “当我在我的 DbTable 上调用 fetchAll() 时，我会在 DbTable 中定义的正确 DbRow 类中得到结果。”

当您执行此操作时，您将`Zend_Db_Table_Abstract::fetchAll()`根据代码中的 docblock 调用 which 返回`Zend_Db_Table_Rowset`：-

```
/**
 * Fetches all rows.
 *
 * Honors the Zend_Db_Adapter fetch mode.
 *
 * @param string|array|Zend_Db_Table_Select $where  OPTIONAL An SQL WHERE clause or Zend_Db_Table_Select object.
 * @param string|array                      $order  OPTIONAL An SQL ORDER clause.
 * @param int                               $count  OPTIONAL An SQL LIMIT count.
 * @param int                               $offset OPTIONAL An SQL LIMIT offset.
 * @return Zend_Db_Table_Rowset_Abstract The row results per the Zend_Db_Adapter fetch mode.
 */
public function fetchAll($where = null, $order = null, $count = null, $offset = null) 
```

> “是否有任何参数可以强制在 DbRows 中接收此数据，或者我应该自己创建行并用这些数组填充它们？”

不，没有，但如果您在正确的对象上调用正确的方法，您将返回您的行集。

为此，请更改此行：-

```
$query = $this->_dbTable->getDefaultAdapter()->select() 
```

到：-

```
$query = $this->_dbTable->select() 
```

这一行：-

```
return $this->_dbTable->getDefaultAdapter()->fetchAll($query); 
```

到：-

```
return $this->_dbTable->fetchAll($query); 
```

那应该可以为您提供所需的东西。如果您卡在 ZF 中，查看代码总是值得的，它是迄今为止最好的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:15:55.107

您不能强制它，因为数据将来自多个表，因此 zend_db 无法进行映射。它留给我们将数据映射到实体。

如果您想要对象数组，则可以更改获取模式。

> Zend_Db::FETCH_OBJ：返回对象数组中的数据。默认类是 PHP 内置类 stdClass。结果集的列可用作对象的公共属性。

仅供参考：[获取模式](http://framework.zend.com/manual/en/zend.db.adapter.html#zend.db.adapter.select.fetch-mode)

一些框架，如 Doctrine，将允许我们提供映射器，我们可以在其中传递自定义映射器对象。

# c++ - 未处理的异常 - OpenCV - cvReleaseCapture 和 cvReleaseImage - C++

> ID：10951016
> 
> 赞同：1
> 
> 时间：2012-06-08T14:41:47.043
> 
> 标签：c++, exception, opencv, iplimage, unhandled

我有一个程序使用 OpenCV 库（版本 2.4.1）从笔记本电脑的网络摄像头（或任何其他连接的摄像头）捕获视频并将其保存到 .avi 文件。当我在 Visual Studio 2010 中调试时，在程序的最后，当 CvCapture 或 IplImage 被释放时，我得到一个未处理的异常。这是代码：

```
 // WriteRealTimeCapturedVideo.cpp : Defines the entry point for the console application.
    #include "stdafx.h"
    #include "cv.h"
    #include "highgui.h"
    #include <stdio.h>

    int main()
    {
        CvCapture* capture = cvCaptureFromCAM( 1 ); //CV_CAP_ANY
        if ( !capture )
        {
            fprintf( stderr, "ERROR: capture is NULL \n" );
            getchar();
            return -1;
        }
        // Create a window in which the captured images will be presented
        cvNamedWindow( "mywindow", CV_WINDOW_AUTOSIZE );

        double fps = cvGetCaptureProperty (capture, CV_CAP_PROP_FPS);

        CvSize size = cvSize((int)cvGetCaptureProperty( capture, CV_CAP_PROP_FRAME_WIDTH), (int)cvGetCaptureProperty( capture, CV_CAP_PROP_FRAME_HEIGHT));

        #ifndef NOWRITE
        CvVideoWriter* writer = cvCreateVideoWriter("Capture.avi", CV_FOURCC('M','J','P','G'), fps, size); //CV_FOURCC('M','J','P','G')
        #endif

        int width = (int)(cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_WIDTH));
        int height = (int)(cvGetCaptureProperty(capture, CV_CAP_PROP_FRAME_HEIGHT));

        IplImage* frame = cvCreateImage( cvSize( width,height ), IPL_DEPTH_8U, 1);

        while ( 1 )
        {
            // Get one frame
            frame = cvQueryFrame( capture );
            if ( !frame ) 
            {
                fprintf( stderr, "ERROR: frame is null...\n" );
                getchar();
                break;
            }
            cvShowImage( "mywindow", frame );
            #ifndef NOWRITE
            cvWriteToAVI( writer, frame );
            #endif
            char c = cvWaitKey(33);
            if( c == 27 ) break;
        }
        #ifndef NOWRITE
        cvReleaseVideoWriter( &writer );
        #endif
        cvDestroyWindow( "mywindow" );
        cvReleaseImage( &frame );
        cvReleaseCapture( &capture );
        return 0;
    } 
```

我发现我必须将 tbb.dll 和 tbb_debug.dll 放在与源代码（.cpp 文件）相同的目录中，程序才能运行。这些 dll 可以从 Intel 下载。

视频捕获工作，即出现窗口并显示视频，但无论我如何重新排列发布声明都会出现异常。如果我删除了发布声明（除了 VideoWriter），我不会得到异常，但是生成的 .avi 文件无法打开。当用户按下 Esc 键时，程序退出 while 循环。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:49:34.143

来自 openCV 文档：

> cvQueryFrame
> 
> 从相机或文件中抓取并返回帧
> 
> IplImage* cvQueryFrame(CvCapture* 捕获);
> 
> 捕获视频捕获结构。
> 
> 函数 cvQueryFrame 从相机或视频文件中抓取一帧，解压缩并返回。这个函数只是 cvGrabFrame 和 cvRetrieveFrame 在一次调用中的组合。**返回的图像不应由用户发布或修改。**

所以你不必分配或释放“框架”

删除：

```
IplImage* frame = cvCreateImage( cvSize( width,height ), IPL_DEPTH_8U, 1); 
```

和

```
cvReleaseImage( &frame ); 
```

并更换

```
frame = cvQueryFrame( capture ); 
```

和

```
IplImage* frame = cvQueryFrame( capture ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T04:23:52.053

我认为这条线引起了问题

```
IplImage* frame = cvCreateImage( cvSize( width,height ), IPL_DEPTH_8U, 1); 
```

尝试其他代码，例如

```
IplImage* frame = cvCreateImage( cvSize( width,height ), IPL_DEPTH_8U, 3); 
```

# xcode - 如何构建一些 Xcode

> ID：10951018
> 
> 赞同：0
> 
> 时间：2012-06-08T14:42:01.193
> 
> 标签：xcode, math, ios5

基本上，一个人需要筹集的总金额是 3000 英镑，所以我希望这是筹集资金的起始值，然后我希望他们能够输入他们到目前为止筹集了多少。该值将从 3000 英镑中获取并显示在屏幕上，但问题在于我现在如何才能将新的总价值设为 3000 英镑 - 筹集的资金，所以下次他们输入筹款金额时，它会减去表格新值。

这是我到目前为止所拥有的：

```
float mR; 
float total = (3000-mR);
mR = total-([moneyRaised.text floatValue]);

moneyRaised.text = @"";
leftToRaise.text = [[NSString alloc] initWithFormat:@"£%.2f", mR]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:08:17.687

在解决这个问题时，不仅要决定你现在想做什么，还要决定你将来可能想做什么。如果这是用于学习目的的一次性程序，请随意跳过。

*   你要跟踪交易吗？（按金额？日期？贡献者？）
*   需要多少用户才能影响数据？（本地数据？SQL？）
*   您会调整应用程序以实现不同的目标吗？（同时进球？）
*   您还需要如何查看数据？（条目表？目标列表？）

在设计应用程序时，从所有这些大范围的问题开始可能会让人不知所措，但是当您拥有概念验证并需要扩展以满足您的最终目标时，对它们有一个总体想法是很好的。

也就是说，本地存储数据有三种方式：NSUserDefaults、CoreData 和 plist。我对您的数据的建议是一个`plist`文件（每个目标一个）。这存储了一个键值对列表，并且可以是任意长度。如果您（或您的最终用户）是唯一应该能够影响数据的人，那么这是一个很好的方法。比较这三个这里有一个特别好的答案：[我应该使用 NSUserDefaults 还是 plist 来存储数据？](https://stackoverflow.com/questions/7058858/should-i-use-nsuserdefaults-or-a-plist-to-store-data)

对于需要提供给许多不同用户的数据，它变得更加复杂，这实际上取决于您的可用资源、预算、技能、潜在用户数量等。

如果您询问如何设置一个接口来连接您提供的代码，那完全是另一回事，我建议您在自己处理任何事情之前先找到一些基本教程来运行。

# javascript - 如何使用javascript识别网格中特定列的复选框

> ID：10951020
> 
> 赞同：0
> 
> 时间：2012-06-08T14:42:05.157
> 
> 标签：javascript

我已经发布了这个问题。抱歉，我未能添加任何代码。该线程已关闭。道歉。我又来打扰大家了。

无论如何，我只想识别 radgrid 中特定列的复选框？我有两列。和两个按钮。如果我单击一个按钮，我需要单独选中/取消选中该特定列的复选框。请帮忙？我已经试过了。现在网格中的所有复选框都被选中/取消选中。

请在下面找到代码。

```
var inputs = document.getElementsByTagName("input"); //or document.forms[0].elements;

   for (var i = 0; i < input.length; i++) 
   {
       if (input[i].type == "checkbox") 
       {
           if (input[i].checked) {
               input[i].checked = false;
           }
           else 
           {
               input[i].checked = true;
           }
       }
   } 
```

请告诉我如何单独选择特定列的复选框？

HTML 代码：

```
 <html xmlns="http://www.w3.org/1999/xhtml">

<head id="Head1" runat="server">
   <script language="javascript" type="text/javascript">

       function clickbutton()
        {
           debugger;

           var inputs = document.getElementsByTagName("input"); //or document.forms[0].elements;

           for (var i = 0; i < input.length; i++) 
           {
               if (input[i].type == "checkbox") 
               {
                   if (input[i].checked) {
                       input[i].checked = false;
                   }
                   else 
                   {
                       input[i].checked = true;
                   }
               }
           }   

       }

</script>
</head>
<body class="BODY">
    <form id="mainForm" method="post" runat="server">
        <asp:ScriptManager ID="ScriptManager1" runat="server" />

        <!-- content start -->
        <telerik:RadAjaxManager ID="RadAjaxManager1" runat="server">
            <AjaxSettings>
                <telerik:AjaxSetting AjaxControlID="RadGrid1">
                    <UpdatedControls>
                        <telerik:AjaxUpdatedControl ControlID="RadGrid1" />
                    </UpdatedControls>
                </telerik:AjaxSetting>
                <telerik:AjaxSetting AjaxControlID="clrFilters">
                    <UpdatedControls>
                        <telerik:AjaxUpdatedControl ControlID="RadGrid1" />
                        <telerik:AjaxUpdatedControl ControlID="clrFilters" />
                    </UpdatedControls>
                </telerik:AjaxSetting>
            </AjaxSettings>
        </telerik:RadAjaxManager>
        <telerik:RadGrid ID="RadGrid1" AutoGenerateColumns="False" 
            AllowSorting="True" ClientSettings-Scrolling-AllowScroll="true"
            AllowFilteringByColumn="True" Width="1251px" runat="server" OnColumnCreating="RadGrid1_ColumnCreating"  
            OnItemCommand="RadGrid1_ItemCommand" 
            OnNeedDataSource="RadGrid1_NeedDataSource" Skin="Gray"
             OnItemDataBound="RadGrid1_ItemDataBound"  OnItemCreated="RadGrid1_ItemCreated"
           >
            <FooterStyle HorizontalAlign="Center" VerticalAlign="Middle" />
            <AlternatingItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />
            <ItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />
            <PagerStyle Mode="NumericPages" />
            <MasterTableView>

<RowIndicatorColumn>
<HeaderStyle Width="20px"></HeaderStyle>
</RowIndicatorColumn>

<ExpandCollapseColumn>
<HeaderStyle Width="20px"></HeaderStyle>
</ExpandCollapseColumn>
            </MasterTableView>

            <SelectedItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />
            <HeaderStyle HorizontalAlign="Center" VerticalAlign="Middle" />

<ClientSettings>
    <Selecting AllowRowSelect="True" />
<Scrolling AllowScroll="True"></Scrolling>
</ClientSettings>

<FilterMenu EnableTheming="True">
<CollapseAnimation Type="OutQuint" Duration="200"></CollapseAnimation>
</FilterMenu>

            <EditItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />
            <ActiveItemStyle HorizontalAlign="Right" VerticalAlign="Middle" />
            <FilterItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />

        </telerik:RadGrid>

        <br />

        &nbsp;&nbsp;&nbsp;
        <p>

        </p>

    </form>
</body>
</html> 
```

我正在动态创建复选框和按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T14:53:24.720

```
document.forms[ 0 ].addEventListener( 'click', function( e ) {
    if ( e.target.nodeName === 'input' ) {
        // This gets the index of the parent (supposedly the TD)
        // inside the parent of the parent (supposedly the TR).
        var i = [].indexOf.call( e.target.parentNode.parentNode,
            e.target.parentNode );

        // So uncheck all the checkboxes of this column.
        // Sending to another function is better or the code
        // becomes cluttered.
        uncheckColumn( i );
    }
};

function uncheckColumn( index ) {
    // For each TD
    [].forEach.call( document.getElementById( 'tr-id' ).children[ index ],
        function( column ) {
        column.firstElementChild.checked = column.firstElementChild.checked
            ? false : true;
    } );
} 
```

然而，这需要现代浏览器。对于旧版浏览器的支持，请查看 jQuery。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:54:07.833

您需要为自己制定一个计划，以便在创建复选框后再次查找它们。您可以通过多种方式执行此操作，但一种方法是根据它们所在的列为复选框分配名称属性并使用 document.getElementsByName()（而不是标记名）。

您可能还想研究使用 CSS 类来识别您的元素。我个人经常使用 jQuery，使用 jQuery 很容易按类找到一组元素。

$('.classname') 是使用 jQuery 选择器查找具有类 'classname' 的元素的示例；

祝好运并玩得开心点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:54:19.167

认为这些使用 JQuery 更容易完成。

但是……如果`input`标签真的相互交替，那么您可以使用模运算来伪选择它们。

做了一个例子：

[http://jsfiddle.net/gnRQj/](http://jsfiddle.net/gnRQj/)

# mysql - 将密码与用户名分开存储

> ID：10951028
> 
> 赞同：5
> 
> 时间：2012-06-08T14:42:34.933
> 
> 标签：mysql, security, password-protection

在最近关于高调网站被黑客攻击的新闻文章之后，我最近对我的网站安全性进行了概述。领英

所以我的问题是：

如何将用户的密码与其用户名和其他信息完全分开存储？这样，黑客只能潜在地获得密码而不是相应的用户名。

编辑：我忘了说我已经将密码存储为哈希（并加盐）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:49:20.040

不管你怎么做，仍然需要一种身份验证机制将用户名/密码绑定在一起，所以你想做的事情是徒劳的。

与其走这条路，不如将密码存储为无法解密的哈希值，这是[公认的最佳实践](https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet)。

[http://blog.moertel.com/articles/2006/12/15/never-store-passwords-in-a-database](http://blog.moertel.com/articles/2006/12/15/never-store-passwords-in-a-database)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T15:07:34.923

我认为添加安全性的最佳方法是与 Google 帐户使用相同。当您使用正确的密码（使用您想要的任何算法在数据库中编码，但我建议使用 Bcrpyt）登录时，您将在手机上收到一个密码。您可以使用电子邮件来完成。它变得越来越复杂，您还可以添加盐和其他东西以使事情更难破解。

请记住，如果您可以创建它，则可以反转它。总是。这只是如何，时间，有时是金钱和意志的问题。

对于你的问题，没有。您始终需要将用户名（即：帐户）与密码联系起来。我想您可以将其存储在两台服务器上的两个数据库中，并使用带盐和哈希的多台服务器，但正确且可接受的方法是简单地使用我所说的算法进行编码并进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:13:21.100

在您的网站上保持用户名和密码分开的最干净的方法是根本**不保留密码。**

将密码和身份验证委托给 Google 等第三方服务并实施 OpenID。
[http://openid.net/](http://openid.net/)
那么您将只是存储用户名并且您将不知道密码数据，因此您不可能发起破坏，密码和用户名将永远不必连接到您的系统中一点也不。
这是 Jeff Atwood 关于这个主题的：http:
[//www.codinghorror.com/blog/2010/11/your-internet-drivers-license.html](http://www.codinghorror.com/blog/2010/11/your-internet-drivers-license.html)

**编辑：**针对下面的评论，如果您的 google 帐户被盗用，那么很可能所有附属帐户都被盗用。这就是为什么像谷歌这样的安全认证方案是必不可少的。没有必要在这里重新发明轮子。您可以使用两步验证进一步保护您的 Google 帐户
[http://www.codinghorror.com/blog/2012/04/make-your-email-hacker-proof.html](http://www.codinghorror.com/blog/2012/04/make-your-email-hacker-proof.html)
我看不出每个网站都应该期望采取行动的理由作为一个独特的身份验证器......它以牺牲安全性为代价促进了网络碎片化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:02:31.170

不要存储密码，而是存储密码的*哈希值*。

幸运的是，mysql为此提供了一个安全的（单向）散列函数：[`PASSWORD()`](http://dev.mysql.com/doc/refman/5.1/en/encryption-functions.html#function_password)

您的查询只是保存哈希而不是纯文本密码，如下所示：

```
update user_table set
password = PASSWORD(?)
where user_id = ? 
```

可以这样检查：

```
select * from user
where user_id = ?
and password = PASSWORD(?); // returns the row if password correct 
```

mysql 官方文档中的[Password Hashing in MySQL](http://dev.mysql.com/doc/refman/5.1/en/password-hashing.html)文章彻底解释了这一切。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T15:14:47.927

根据我阅读的内容，LinkedIn 使用 SHA1 加密使用未加盐的加密散列密码。似乎也“加盐”你的密码会更明智。如果您为每个用户使用随机盐腌制，那么您的状态非常好。如果不：

这意味着在散列之前生成随机位字符串并将它们连接到您的密码中。此外，您还存储每个用户的随机位字符串，并在用户提供哈希密码时从数据库中提取它

密码是“加盐的”（与为用户存储的盐连接），然后对该加盐字符串进行散列并使用数据库中的用户散列密码进行验证 这几乎可以肯定地保证唯一的散列并使密码的散列表更加困难逆向工程回到逻辑密码，因为散列函数的输出还依赖于知道为每个用户分配的自定义盐。

如果有人知道为什么linkedIn 不对他们的哈希值加盐，我很想听听你的意见。从我读过的所有内容来看，SHA1 很容易随着时间的推移而被破译。

# ruby-on-rails - capistrano 部署：迁移不存在

> ID：10951035
> 
> 赞同：0
> 
> 时间：2012-06-08T14:43:05.280
> 
> 标签：ruby-on-rails, ruby-on-rails-3, capistrano, rvm-capistrano

这是我的第一个 Rails 项目，与 capistrano 一起工作真的很愉快。

我当前的问题是我需要将 cap deploy:migrate 和 cap:deploy:migration 作为单独的任务运行。我相信应该有一个 cap deploy:migration 结合了这些。

这是我的终端输出：

```
kris$ cap staging deploy:migration
      triggering load callbacks
     * executing `staging'
    the task `deploy:migration' does not exist 
```

我的设置使用多阶段，并使用 RVM capistrano 插件。

这是我的宝石文件：

```
source 'https://rubygems.org'

gem 'rails', '3.2.1'

group :development do
  gem 'sqlite3'
end

group :production do
  gem 'mysql2'
end

group :test do
  gem 'sqlite3'
  gem 'ZenTest'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end

#formtastic 2.2 breaks activeadmin
gem "formtastic", "~> 2.1.1"
gem "activeadmin", "~> 0.4.3"

# meta_search required for activeadmin
gem 'meta_search'

gem 'jquery-rails'
gem "paperclip", "~> 3.0"

gem 'acts_as_list'
 gem 'unicorn'

# Deploy with Capistrano
 gem 'capistrano'
 gem 'rvm-capistrano'

gem 'mail'
gem 'friendly_id' 
```

这是我的配置/部署文件：

```
set :rvm_ruby_string, 'ruby-1.9.3-p194@xxx'                     # Or:
#set :rvm_ruby_string, ENV['GEM_HOME'].gsub(/.*\//,"") # Read from local system

require "rvm/capistrano"                               # Load RVM's capistrano plugin.
require "bundler/capistrano"

# set :verbose ,1

require 'capistrano/ext/multistage'
set :stages, %w(staging production)
set :default_stage, "staging"
set :deploy_via, :remote_cache

set :user, "webm"
# set :deploy_via, :remote_cache
set :use_sudo, false

set :scm, "git"
set :repository, "git@xx.beanstalkapp.com:/xx.git"

# :branch is being set in stage files

default_run_options[:pty] = true
# ssh_options[:forward_agent] = true

after "deploy", "deploy:cleanup" # keep only the last 5 releases

namespace :deploy do
    %w[start stop restart].each do |command|
        desc "#{command} unicorn server"
        task command, roles: :app, except: {no_release: true} do
            run "#{sudo} service unicorn_#{server_configuration} #{command}"
        end
    end

    desc "build missing paperclip styles"
    task :build_missing_paperclip_styles, :roles=> :app do
        run "cd #{release_path}; RAILS_ENV=production bundle exec rake paperclip:refresh:missing_styles"
    end
    after "deploy:update", "deploy:build_missing_paperclip_styles"

    task :setup_config, roles: :app do
        puts "#making symlink to nginx sites-enabled"
        run "#{sudo} ln -fs #{current_path}/config/server/#{server_configuration}/nginx.conf /etc/nginx/sites-enabled/#{server_configuration}"
        puts "#making symlink to unicorn service script"
        run "#{sudo} ln -fs #{current_path}/config/server/#{server_configuration}/unicorn_init.sh /etc/init.d/unicorn_#{server_configuration}"
        puts "#making a the new config directory"
        run "mkdir -p #{shared_path}/config"
        run "sunique 1"
        put File.read("config/database.yml"), "#{shared_path}/config/database.yml"
        run "sunique 0"
        puts "Now edit the config files in #{shared_path}."
    end
    after "deploy:setup", "deploy:setup_config"

    task :symlink_config, roles: :app do
        run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"

        puts "#for reference:"
        puts "#rvm wrapper 1.9.3@ac_helenefrance_01 ruby-1.9.3-p194@#{server_configuration} unicorn cap"
        puts "#now be sure to run: sudo update-rc.d unicorn_#{server_configuration} defaults"
    end
    after "deploy:finalize_update", "deploy:symlink_config"

    # desc "Make sure local git is in sync with remote."
    # task :check_revision, roles: :web do
        # if :isRemote == false
            # unless `git rev-parse HEAD` == `git rev-parse beanstalk/#{branch}`
                # puts "WARNING: HEAD is not the same as beanstalk/#{branch}"
                # puts "Run `git push` to sync changes."
                # exit
            # end
        # end
    # end
    #before "deploy", "deploy:check_revision"
end 
```

任何有关为什么`deploy:migration`损坏的帮助都会非常有帮助。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:44:11.527

你忘了一个**s**，如`cap deploy:migrations`

# c++ - 指定 64 位对齐

> ID：10951039
> 
> 赞同：14
> 
> 时间：2012-06-08T14:43:25.287
> 
> 标签：c++, gcc, alignment

给定一个结构定义，如

```
struct foo {
    int a, b, c;
}; 
```

什么是最好的（最简单、最可靠和可移植的）方法来指定它应该始终与 64 位地址对齐，即使在 32 位构建上也是如此？我将 C++11 与 GCC 4.5.2 一起使用，并希望也支持 Clang。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-08T14:46:52.980

既然您说您正在使用 GCC 并希望支持 Clang，那么 GCC 的`aligned` [属性](http://gcc.gnu.org/onlinedocs/gcc-4.5.2/gcc/Type-Attributes.html)应该可以解决问题：

```
struct foo {
    int a, b, c;
} __attribute__((__aligned__(8))); // aligned to 8-byte (64-bit) boundary 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-08T15:20:01.223

以下是*相当*可移植的，因为它将适用于许多不同的实现，但不是全部：

```
union foo {
    struct {int a, b, c; } data;
    double padding1;
    long long padding2;
};

static char assert_foo_size[sizeof(foo) % 8 == 0 ? 1 : -1]; 
```

这将无法编译，除非：

*   编译器添加了一些填充以`foo`使其达到 8 的倍数，这通常只会由于对齐要求而发生，或者
*   的布局`foo.data`极其奇怪，或者
*   其中一个`long long`和`double`大于 3 个整数，并且是 8 的倍数。这并不一定意味着它是 8 对齐的。

鉴于您只需要支持 2 个编译器，并且 clang 在设计上与 gcc 相当兼容，因此只需使用`__attribute__`它即可。如果您现在想编写可以（希望）在您未测试的编译器上工作的代码，请只考虑做其他事情。

C++11 增加了`alignof`，你可以测试而不是测试大小。它会消除误报，但仍然会给您留下一些一致的实现，在这些实现上，联合无法创建您想要的对齐，因此无法编译。此外，我的`sizeof`技巧非常有限，如果你的结构有 4 个整数而不是只有 3 个整数，它根本没有帮助，而同样的事情有`alignof`。我不知道 gcc 和 clang 支持哪些版本`alignof`，这就是为什么我一开始没有使用它的原因。我不会认为这很难做到。

顺便说一句，如果实例`foo`是动态分配的，那么事情会变得更容易。首先，我怀疑 glibc 或类似`malloc`的实现无论如何都会 8 对齐 - 如果有一个 8 字节对齐的基本类型，那么`malloc`我认为 glibc`malloc`总是这样做，而不是担心是否有任何给定平台。其次，`posix_memalign`要确定。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-07-08T06:31:39.477

你应该使用`__attribute__((aligned(8))`. 但是，我发现此描述仅确保分配的结构大小是 8 字节的倍数。它不能确保起始地址是倍数。

例如。我使用`__attribute__((aligned(64))`，malloc 可能会返回一个 64Byte 长度的结构，其起始地址为 0xed2030。

如果要对齐起始地址，则应使用对齐的alloc： [gcc对齐分配](https://www.gnu.org/software/libc/manual/html_node/Aligned-Memory-Blocks.html)。`aligned_alloc(64, sizeof(foo)`将返回 0xed2040。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-08T14:46:23.553

便携的？我真的不知道真正便携的方式。GCC 有`__attribute__((aligned(8)))`, 其他编译器也可能有等价物，您可以使用预处理器指令检测它们。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-08T15:39:17.460

我很确定 gcc 4.5.2 已经足够老了，它还不支持标准版本，但是 C++11 添加了一些专门用于处理对齐的类型——`std::aligned_storage`除`std::aligned_union`其他外（参见 §20.9.7.6 了解更多信息）细节）。

在我看来，最明显的方法是使用 Boost 的实现`aligned_storage`（或 TR1，如果你有的话）。如果您不希望这样，我仍然会认真考虑在您的大多数代码中使用标准版本，并且只需编写它的一个小实现供您自己使用，直到您更新到实现该标准的编译器。然而，可移植代码看起来仍然与大多数使用类似`__declspec(align...`或`__attribute__(__aligned__, ...`直接使用的代码略有不同。

特别是，它只是给你一个请求大小的原始缓冲区和请求的对齐。然后由您决定使用诸如placement new之类的东西在该存储中创建您类型的对象。

对于它的价值，这里有一个`aligned_storage`基于 gcc`__attribute__(__aligned__,...`指令的快速实现：

```
template <std::size_t Len, std::size_t Alignment>
struct aligned_storage {
    typedef struct {
        __attribute__(__aligned__(Alignment)) unsigned char __data[Len];
    } type;
}; 
```

一个快速测试程序来展示如何使用它：

```
struct foo {
    int a, b, c;

    void *operator new(size_t, void *in) { return in; }
};

int main() {
    stdx::aligned_storage<sizeof(foo), 8>::type buf;

    foo& f = *new (static_cast<void*>(&buf)) foo();

    int address = *reinterpret_cast<int *>(&f);

    if (address & 0x3 != 0)
        std::cout << "Failed.\n";

    f.~foo();

    return 0;
} 
```

当然，在实际使用中，您会包装/隐藏我在这里展示的大部分丑陋。如果你这样离开它，（理论/未来）可移植性的价格可能过高。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-09-06T03:44:21.557

`[[gnu::aligned(64)]] in c++11 annotation std::atomic <int64_t> ob [[gnu::aligned(64)]]`

# entity-framework-4 - 在 EF Database First 项目中更新模型

> ID：10951040
> 
> 赞同：10
> 
> 时间：2012-06-08T14:43:27.637
> 
> 标签：entity-framework-4, edmx, ef-database-first

我继承了一个首先使用实体​​框架数据库的项目。当我更新数据库时，我试图弄清楚如何更新模型类，但我无法弄清楚。到目前为止，我所做的是将名为 Test 的列添加到数据库中的表中，然后在模型浏览器中，我右键单击 .edmx 文件并选择从数据库中更新模型，然后按照出现的向导中的选项进行操作. 现在，当我查看打开 .edmx 文件时呈现的数据库关系图时，我可以看到测试列已添加到表中。问题是对应的C#模型类没有更新。我认为我不必手动更新它，因为文件顶部有此消息

```
//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------ 
```

所以问题是，我如何更新这个模型文件？有什么我必须跑来做的吗？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-08T15:15:22.373

您应该有一个生成模型类的 T4 模板（扩展名 .tt）。

当您保存 .edmx 文件时，它可能不会运行，例如，如果它位于不同的项目中。

您可以通过在解决方案资源管理器中右键单击它并选择“运行自定义工具”来手动运行它。

# android - 从 Android 设备访问图像

> ID：10951041
> 
> 赞同：-1
> 
> 时间：2012-06-08T14:43:34.150
> 
> 标签：android, image

如何访问路径为“DCIM/Camera/test.jpg”的图像？（当我在 Android File Transfer 中打开 Android 设备时，DCIM 位于顶级目录中。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:58:50.817

现在我们知道您正在尝试将其加载到 ImageView 中：

```
ImageView imageView = (ImageView) findViewById(R.id.yourImageView);
Bitmap bMap = BitmapFactory.decodeFile("/sdcard/DCIM/Camera/" + yourFileName);
imageView.setImageBitmap(bMap); 
```

正如 Aerrow 所提到的，您需要确保您在清单中具有适当的权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

# bean-validation - 列表和列表元素的 Jsr 303 验证

> ID：10951046
> 
> 赞同：1
> 
> 时间：2012-06-08T14:43:37.480
> 
> 标签：bean-validation

我正在努力定义我的 jsr 303 验证规则，即为我的容器 bean 重新定义默认组。

```
@GroupSequence({Container.class, Container.Step2.class})
public class Container {
@NotNull
private String def;

@Valid
@Size(min = 20, groups = Container.Step2.class)
private List<Element> elems = new LinkedList<Element>();

public interface Step2{}
}

public class Element{
@NotNull
private String foo;
} 
```

当且仅在以下情况下，我希望验证容器 bean 的大小：

*   def 属性有效
*   没有任何带有 elems 集合的 Elements bean 的验证错误

如果我使用默认组验证容器：

```
Container c = new Container();
...
validator.validate(c) 
```

即使内部元素 bean 存在验证错误，也会触发 size 验证器。

如果我从容器类中删除 @GroupSequence（跳过重新定义容器的默认组）并将自己的 GroupSequence 定义为：

```
@GroupSequence({Default.class, Container2.Step2.class}) 
public interface AllValid{} 
```

然后使用 AllValid 组进行验证：

```
Container c = new Container();
...
validator.validate(c, Container2.AllValid.class); 
```

一切都按预期工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T08:22:16.213

我决定查看 hibernate-validator 的源代码来调查这个问题。它看起来像在验证根 bean 之后执行关联的级联验证。两种验证（根 bean 和关联的验证）都是使用“目标组”执行的。“目标组”是指作为验证方法的最后一个参数传递的组。如果没有传递组/组参数，则将“默认组”设置为“目标组”。就我而言，我重新定义了根 bean 的默认组，因此调用：

```
validator.validate(c) 
```

强制使用组序列验证 Container bean：Default,Container.Step2.class。就在该元素列表被验证之后（使用默认组）。在这种情况下，Container 和 elems 是独立验证的。

如果有人知道使我的验证与默认组一起工作的任何技巧，请评论我的帖子，但现在我将继续使用显式组验证容器，即

```
validator.validate(c, Container2.AllValid.class); 
```

# c++ - 在 C++ 中定义枚举类型的静态变量

> ID：10951050
> 
> 赞同：1
> 
> 时间：2012-06-08T14:43:45.060
> 
> 标签：c++

```
class Game
{
public:
    static void Start();

private:
    static bool IsExiting();
    static void GameLoop();

    static void ShowSplashScreen();
    static void ShowMenu();

    enum GameState { Uninitialized, ShowingSplash, Paused,
                    ShowingMenu, Playing, Exiting };

    Game::GameState Game::_gameState = Game::Uninitialized;
    static sf::RenderWindow _mainWindow;
};
Game::GameState Game::_gameState;
RenderWindow Game::_mainWindow; 
```

错误现在在首先运行的函数中

```
void processEvents(){// error: first defined here ???
    Event event;
    while(App.pollEvent(event)){
        if(event.type == Event::Closed)
                App.close();
    }
} 
```

还有其他错误，例如在函数中定义了多个 `Game::_gameState' 它在 Game 类中声明的其他函数中给出了相同的错误

```
void Game::Start(void) { // multiple definition of `Game::_gameState'
    if (_gameState != Uninitialized)
        return;

    _mainWindow.create(VideoMode(1200, 900, 32), "Game",
            Style::Close);
    _gameState = Game::ShowingSplash;

    while (!IsExiting()) {
        GameLoop();
    }

    _mainWindow.close();
} 
```

我修复了错误，但又出现了一个

```
while (!IsExiting()) {  //undefined reference to Game::IsExiting
    GameLoop();
}

_mainWindow.close(); 
```

}

我不知道它是静态 bool 函数，其他函数可以正常工作，但这个是 bool 并给我错误

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:47:48.730

`GameState`enum 在类的范围内声明`Game`。因此，当您在该类的范围之外引用它时，您必须使用完全限定的类型名称（这包括定义`_gameState`字段的实例。我还建议您给它一些初始值。例如：

```
Game::GameState Game::_gameState = Game::Uninitialized; 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:46:35.233

因为`enum GameState`包含在`class Game`您需要相应地限定变量的范围内：

```
Game::GameState Game::_gameState; 
```

# c# - 从 URL 链接获取 rel 值

> ID：10951052
> 
> 赞同：0
> 
> 时间：2012-06-08T14:43:50.247
> 
> 标签：c#, .net, xml, xml-parsing

我有一个 xml 文件，其中有两个链接。如果它确实获得了它的 href 值，我需要检查是否存在与 rel next 的链接。

```
<a:link rel="prev" type="application/atom+xml" type="application/atom+xml" href="/v3.2/en-us/" />
<a:link rel="next" type="application/atom+xml" type="application/atom+xml" href="/v3.2/en-us/" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:04:38.673

如何将 xml 读入 XDocument 并使用 LINQ 查找下一个元素。

```
XDocument x = XDocument.Parse("<xml><link rel=\"prev\" type=\"application/atom+xml\" href=\"/v3.2/en-us/\" /> <link rel=\"next\" type=\"application/atom+xml\" href=\"/v3.2/en-us/\" /></xml>");

XElement link = x.Descendants("link")
                 .FirstOrDefault(a => a.Attribute("rel").Value == "next");

String href = string.Empty;
if(link != null)
{
     href = link.Attribute("href").Value; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:30:34.733

You can use [this public xml library](https://github.com/ChuckSavage/XmlLib/) and then get the value with:

```
XElement root = XElement.Load(file); // or .Parse(string)
string href = root.XGetElement<string>("//a:link[@rel={0}]/href", null, "next");
if(null != href)
    ... link was found ... 
```

That should work with the `a:link`, but if it doesn't try it without the `a:`. It would depend on where a's namespace was declared. If it is in the root node it should be fine.

`XGetElement()` is basically a combination of `XPathElement("//a:link[@rel={0}]").Get<string>("href", null)`. `Get()` also being a part of the library for getting values from nodes, checking first for an attribute by the name and then for a child node.

# php - 使用哈希保护密码

> ID：10951054
> 
> 赞同：0
> 
> 时间：2012-06-08T14:44:04.867
> 
> 标签：php, encryption, hash, md5

我正在阅读保护密码的不同技术。我知道，无论你采取什么预防措施，从长远来看，你只会减缓一个坚定的黑客。我研究了 bcrypt 在 PHP 和 PBKDF2 中的使用。

现在忽略您如何创建哈希。如果一组说 4 个或更多随机选择的 ASCII 字符在预定位置输入到散列中，这会有什么用。有不同长度的哈希吗？因此，如果您只计算字符数，您可以让一种类型说 md5 看起来像另一种类型？

我知道这再次只会减慢知道您正在这样做的人的速度，并且他们会获得您用来放置随机字符的位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:52:41.523

在散列中放置随机字符以使其安全是没有意义的。因为最终您必须找到实际的哈希值并与根据用户输入计算生成的哈希值进行比较。

更好的是，为哈希使用种子。假设`hash`是一个通用函数，并且`$seed`是一个种子，你可以这样做，

```
$seed = 'a_constant_value';
$seeded_hash = hash( $seed . $password ); 
```

如果您不希望种子成为常量，请将用户的另一个凭据添加到哈希中。

```
$seed = 'a_constant_value';
$user_credential = 'any_data_of_this_user';
$seeded_hash = hash( $seed . $user_credential. $password ); 
```

在此确保此*用户凭据*对于每个用户都是不变的。它可以是用户的生日、血型。

# java - 如何检索字符串中匹配模式的索引？

> ID：10951064
> 
> 赞同：0
> 
> 时间：2012-06-08T14:44:48.780
> 
> 标签：java, regex, string

我正在寻找字符串中的模式。该模式可以匹配多次。如何检索每个匹配项的索引？

例如，如果我正在寻找需要值 0,3`al`的字符串中的模式。`albala`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T14:49:04.167

```
import java.util.regex.*;

class TestRegex
{
    public static void main(String[] args)
    {
        Pattern p = Pattern.compile("al");
        Matcher m = p.matcher("albala");
        while(m.find())
            System.out.println(m.start());
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:50:53.753

试试这个：

```
public static void main(String[] args) {
    Pattern pattern = Pattern.compile("al");
    Matcher matcher = pattern.matcher("albala");
    while (matcher.find()) {
        System.out.print("I found the text \"");
        System.out.print(matcher.group());
        System.out.print("\" starting at index ");
        System.out.print(matcher.start());
        System.out.print(" and ending at index ");
        System.out.print(matcher.end());
        System.out.print(".\n");
    }
} 
```

您可以在测试工具中找到此示例[（Java 教程 > 基本类 > 正则表达式）](http://docs.oracle.com/javase/tutorial/essential/regex/test_harness.html)

# node.js - nodejs knox 放入 s3 导致 403

> ID：10951065
> 
> 赞同：5
> 
> 时间：2012-06-08T14:44:50.640
> 
> 标签：node.js, amazon-s3, knox-amazon-s3-client

我正在尝试在 nodejs 项目中使用 knox 上传到 Amazon s3 存储桶，但无法通过 403 错误。我已确保正确设置了密钥、秘密和存储桶。我真的可以在这里从那些有更多经验的人那里得到一些帮助。

我的节点代码如下：

```
var upload_test = function(){

var client = knox.createClient(
    {
      key: config.aws.key
    , secret: config.aws.secret
    , bucket: config.aws.bucket
    }
);

fs.readFile('test.pdf', function(err,buf){
    var req = client.put('6530/test.pdf', {
        'Content-length': buf.length,
        'Content-Type': 'application/pdf'
    });
    req.on('response',function(res){
        if(res.statusCode === 200){
            console.log('Success!');
            req.on('data',function(chunk) {
                console.log(chunk);
            });
        }
        else {
            console.log("Error statusCode: " + res.statusCode);
            console.log("URL: " + req.url);
            req.on('data',function(chunk){
                console.log(chunk);
            });
        }
    });
}); 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T12:06:28.327

For future viewers:

My similar problem was solved by changing my bucket name to all lowercase letters

digitalKarma --> digitalkarma

# c# - 从字符串中填充复选框数组名称

> ID：10951075
> 
> 赞同：1
> 
> 时间：2012-06-08T14:45:58.510
> 
> 标签：c#, arrays, string, checkbox

我正在尝试使用从字符串派生的复选框名称填充复选框数组。我想替换以下代码：

```
 public void CheckBox_1()
    {
        CheckBox[] boxes_1 = new CheckBox[4];

        boxes_1[0] = A0;
        boxes_1[1] = A1;
        boxes_1[2] = A2;
        boxes_1[3] = A3;

        for (int i = 0;i < 4;i++)   
        {
            boxes_1[i].Enabled = checkBox1.Checked == true ? true : false;
        }
    } 
```

像这样：

```
 public void CheckBox_1()
    {
        CheckBox[] boxes_1 = new CheckBox[4];

        for (int i = 0; i < 4; i++)
        {
            boxes_1[i] = ("A" + i);
        }

        for (int i = 0; i < 4; i++)
        {
            boxes_1[i].Enabled = checkBox1.Checked == true ? true : false;
        }
    } 
```

我可以很容易地将复选框名称转换为字符串，但尚不清楚如何完成此操作。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:54:13.033

您可以使用包含对象的[Control.Controls](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.controls.aspx)来获取所有`CheckBox`控件`OfType<T>`，然后过滤`Name`以“A”开头的 s。

```
var container = ...control with the checkboxes...;

foreach(var cb in container.Controls.OfType<CheckBox>().Where(c => c.Name.StartsWith("A")))
{
   cb.Enabled = checkBox1.Checked;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:54:40.323

我建议不要为了创建容易出错且难以理解的代码而摆弄反射，而是建议将相关复选框分组到容器控件中，例如`GroupBox`.

然后它非常简单易读：

```
// consider renaming
public void CheckBox_1()
{
    var relatedCheckBoxes = GroupBox1.Controls.OfType<CheckBox>();
    foreach (var chk in relatedCheckBoxes)
        chk.Enabled = checkBox1.Checked; // you might want to pass this checkbox as argument instead
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:05:40.453

假设复选框可以嵌套在某个公共容器内的其他控件中，这可能会起作用：

```
 private void CheckBox_1()
    {
        foreach (var checkbox in FindChildren<CheckBox>(container, c => c.Name.StartsWith("A")))
        {
            checkbox.Enabled = checkBox1.Checked == true ? true : false;
        }
    }

    public static IEnumerable<T> FindChildren<T>(Control parent, Func<T, bool> filter)
        where T : Control
    {
        var search = new Stack<Control>();
        search.Push(parent);

        while (search.Count > 0)
        {
            parent = search.Pop();

            foreach (Control child in parent.Controls)
            {
                T typed = child as T;

                if (typed != null && filter(typed))
                {
                    yield return typed;
                    continue;
                }

                search.Push(child);
            }
        }
    } 
```

# mule - mule中URL的最大长度是多少？

> ID：10951077
> 
> 赞同：0
> 
> 时间：2012-06-08T14:46:16.480
> 
> 标签：mule

我正在使用 http:outbound-endpoint。地址字段的最大长度是多少？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:19:13.423

Mule HTTP 传输 XML 模式和底层都没有`java.net.URI`施加限制，所以真正的限制来自 HTTP URL 本身，这已在这个 SO 问题中讨论过：[URL 的最大长度是多少？](https://stackoverflow.com/a/417184/387927)

# objective-c - Objective-C 中装饰器模式的幼稚实现

> ID：10951080
> 
> 赞同：7
> 
> 时间：2012-06-08T14:46:23.713
> 
> 标签：objective-c, ios, oop, design-patterns, decorator

我从*Cocoa Design Patterns*一书中读到，装饰器模式用于许多`Cocoa`类，包括`NSAttributedString`（不继承自`NSString`）。我[查看了一个实现`NSAttributedString.m`](http://www.koders.com/objectivec/fid6E9728FBD2B4BDFC1619FCCB27155000FDBEED8A.aspx)，它超出了我的想象，但我很想知道 SO 上的任何人是否已经成功实现了这个模式并且他们愿意分享。

要求改编自此[装饰器模式参考](http://en.wikipedia.org/wiki/File:Decorator_UML_class_diagram.svg)，并且由于在 Objective-C 中没有抽象类，`Component`并且`Decorator`应该与抽象类足够相似并服务于它们的原始目的（即我不认为它们可以是协议，因为你必须能够做到`[super operation]`。

我会很高兴看到你的一些装饰器实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:12:07.220

我在我的一个应用程序中使用了它，其中我有一个单元格的多个表示我有一个有边框的单元格，一个有额外按钮的单元格和一个有纹理图像的单元格我还需要单击更改它们一个按钮

这是我使用的一些代码

```
//CustomCell.h
@interface CustomCell : UIView

//CustomCell.m
@implementation CustomCell

- (void)drawRect:(CGRect)rect
{
    //Draw the normal images on the cell
}

@end 
```

对于带边框的自定义单元格

```
//CellWithBorder.h
@interface CellWithBorder : CustomCell
{
    CustomCell *aCell;
}

//CellWithBorder.m
@implementation CellWithBorder

- (void)drawRect:(CGRect)rect
{
    //Draw the border
    //inset the rect to draw the original cell
    CGRect insetRect = CGRectInset(rect, 10, 10);
    [aCell drawRect:insetRect];
} 
```

现在在我的视图控制器中，我将执行以下操作

```
CustomCell *cell = [[CustomCell alloc] init];
CellWithBorder *cellWithBorder = [[CellWithBorder alloc] initWithCell:cell]; 
```

如果以后我想切换到另一个单元格，我会这样做

```
CellWithTexture *cellWithBorder = [[CellWithTexture alloc] initWithCell:cellWithBorder.cell]; 
```

# asp.net - 在编辑事件中捕获文学文本

> ID：10951081
> 
> 赞同：0
> 
> 时间：2012-06-08T14:46:27.327
> 
> 标签：asp.net, .net, gridview

单击编辑按钮时，我想获取文字文本。我已经编写了代码来执行此操作，但是当我运行程序时出现此异常

```
"Specified argument was out of the range of valid values. Parameter name: index" 
```

**.aspx 代码：**

```
<gridview id="gridview3" onrowediting="edit>
    <coulmn>

        <asp:TemplateField HeaderText="description" Visible="true">
            <ItemTemplate>
             <asp:Literal ID="id6" runat="server" Text='<%#Eval("description") %>' >
             </asp:Literal>
            </ItemTemplate>
             <EditItemTemplate>
                 <asp:TextBox ID="TextBox1" Text='<%#Eval("description") %>'  
 runat="server" ></asp:TextBox>

            </EditItemTemplate>
            <FooterTemplate>

            <asp:TextBox ID="TextBox3"  runat="server" ></asp:TextBox>

            </FooterTemplate>
        </asp:TemplateField>

        <asp:TemplateField HeaderText="Agree" Visible="true">
            <ItemTemplate>

             <asp:Literal ID="id5" runat="server" Text='<%#Eval("option1") %>' >
             </asp:Literal>
            </ItemTemplate>
             <EditItemTemplate>
                 <asp:TextBox ID="TextBox11" Text='<%#Eval("option1") %>' 
              runat="server" ></asp:TextBox>

            </EditItemTemplate>
            <FooterTemplate>

            <asp:TextBox ID="TextBox4"  runat="server" ></asp:TextBox>    

            </FooterTemplate>
        </asp:TemplateField>
          <asp:TemplateField HeaderText="Disagree" Visible="true">
            <ItemTemplate>

             <asp:Literal ID="id4" runat="server" Text='<%#Eval("option2") %>' >
             </asp:Literal>
            </ItemTemplate>
             <EditItemTemplate>
                 <asp:TextBox ID="TextBox5" Text='<%#Eval("option2") %>' runat="server">         
                 </asp:TextBox>
            </EditItemTemplate>
            <FooterTemplate>

            <asp:TextBox ID="TextBox6"  runat="server" ></asp:Text>

            </FooterTemplate>
        </asp:TemplateField>

        <asp:TemplateField HeaderText="Action" Visible="true">
            <ItemTemplate>
                <asp:LinkButton ID="LinkButton5" Text="Edit" CommandName="edit" 

           runat="server"></asp:LinkButton>
            </ItemTemplate>
        </asp:TemplateField>
    </coulmn>
</gridview>

**code behind:**

protected void edit(object sender, GridViewEditEventArgs e)
{
    Literal l = GridView2.Rows[0].Cells[3].Controls[1] as Literal;
    Label5.Text = l.Text;

    gridview3.EditIndex = e.NewEditIndex; 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:58:54.297

请试试这个

```
Literal l = GridView2.Rows[e.NewEditIndex].FindControl("id6") as Literal;
Label5.Text = l.Text; 
```

# php - AJAX 调用中的会话

> ID：10951089
> 
> 赞同：0
> 
> 时间：2012-06-08T14:46:44.947
> 
> 标签：php, jquery, ajax, session, fancybox

我的网站有问题。

请参阅该页面：

*   /index.php <- session_start()
*   /includes/functions.php
*   /modules/feedback.php <- 读一些 $_SESSION
*   /gui/savefeedback.php <- 读一些 $_SESSION
*   /ajaxGateway.php

在 index.php 中有一个链接。当我按下该链接时，会出现一个 fancybox2 弹出窗口。我将该网址传递给fancybox (/gui/savefeedback.php?somestuff=blablabla)

在那个框中，我有一个带有 textarea 和一个提交按钮的表单。我使用 $_SESSION 变量来配置一些 GUI 元素。在该页面中，我使用带有 AJAX 调用的 jQuery，例如 /ajaxGateway?action=feedback

AjaxGateway 简单解析命令并包含 /feedback.php?vote=1&comment=aaaaaaaaaa

问题！！在 /modules/feedback.php 我无法读取 $_SESSION 变量。

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:48:36.727

你需要`session_start();`在那个页面（/modules/feedback.php）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:07:02.447

`if(!isset($_SESSION)) session_start();` 如果您的会话已经在另一个页面上启动，则使用它启动每个页面`session_start();`可能会引发错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:49:19.833

假设您正在使用 cookie，那么每个 AJAX 请求处理 cookie 的方式与您手动浏览 URL 的方式完全相同......

[请参阅此处](http://www.bennadel.com/blog/1995-AJAX-Requests-Get-And-Set-Cookies-Like-Any-Other-HTTP-Request.htm)了解更多信息

为了确认一切正常，如果您手动浏览到这些 URL 会发生什么？你`session_start()`在每一页上吗？

# android - 为什么 AlertDialog 突然消失了，按返回键后又出现了？

> ID：10951098
> 
> 赞同：0
> 
> 时间：2012-06-08T14:47:08.997
> 
> 标签：android, android-alertdialog

我有一个一次调用两个方法的按钮。那就是alarm()和sms()。当我点击按钮时，AlertDialog 会出现，但在我按下“STOP”按钮之前就消失了。它消失后不久，我收到了短信。如果我按下后退按钮，AlertDialog 会再次出现。看来我出了车祸什么的。

**onCreate() 方法：**

```
btnAlarm = (Button) findViewById(R.id.btnAlarm);
        btnAlarm.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                alarm();
                sms();

            }
        }); 
```

**警报（）方法：**

```
public void alarm()
    {
        Alarm1 = MediaPlayer.create(MySetting.this, R.raw.lingcoll);

        //Turn on the alarm sound
        Alarm1.setLooping(true); // Set looping
        Alarm1.start();

        AlertDialog.Builder builder = new AlertDialog.Builder(MySetting.this);
        builder.setMessage(R.string.alert_stop)
            .setIcon(android.R.drawable.ic_alert)
            .setTitle(R.string.alert_dialog_warning)
            .setCancelable( false )
            .setPositiveButton(R.string.alert_btnStop, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int id) {

                    Alarm1.stop();
                    MySetting.isAlarm = false;

                }
            });

        AlertDialog alert = builder.create();
        alert.show();

        } 
```

**短信（）方法：**

```
public void sms() 
    {   

        TextView a = (TextView) findViewById(R.id.txtPhoneNo);

            String phoneNo = a.getText().toString();

            String message = "My Application works!";

                    PendingIntent pi = PendingIntent.getActivity(this, 0,
                new Intent(this, FinalSetting.class), 0);                
                SmsManager sms = SmsManager.getDefault();
                sms.sendTextMessage(phoneNo, null, message, pi, null);

    } 
```

LogCat 看起来不错，所以我不知道是什么问题。有谁知道如何防止这种情况？？？非常感谢提前..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:00:10.187

听起来某处有上下文切换。您将 contextView 设置在某处或某事正在崩溃。

我认为您只是将 contextView 设置在某处，因为当您回击时，您的 Dialog 在堆栈中仍然存在。还要确保您关闭对话框 onclick。

最后，您可能需要检查您在 onclick 对话框中使用的变量是否必须是最终的。Eclipse 通常会捕捉到这一点，但它可能会导致崩溃。

# prestashop - Prestashop 翻译模块出错

> ID：10951102
> 
> 赞同：0
> 
> 时间：2012-06-08T14:47:40.583
> 
> 标签：prestashop

正如标题所说，当我尝试翻译模块（任何语言的任何模块）时，此错误消息出现在空白屏幕中：***[处理此指令时发生错误]***

这个问题的可能原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T11:24:20.307

特定的 PHP 选项和指令可能被禁用，从而导致此错误。

# c# - 并行运行多个图像操作导致 OutOfMemory 异常

> ID：10951108
> 
> 赞同：3
> 
> 时间：2012-06-08T14:48:01.663
> 
> 标签：c#, asp.net, asp.net-mvc, multithreading, out-of-memory

我正在一个网站上工作，我需要能够将 4000x6000 左右的图像拆分为 4 个部分（在许多其他任务中），并且我需要这对多个用户来说尽可能快。

我目前的代码是

```
var bitmaps = new RenderTargetBitmap[elements.Length];

using (var stream = blobService.Stream(key))
{
    BitmapImage bi = new BitmapImage();
    bi.BeginInit();
    bi.StreamSource = stream;
    bi.EndInit();

    for (var i = 0; i < elements.Length; i++)
    {
        var element = elements[i];

        TransformGroup transformGroup = new TransformGroup();
        TranslateTransform translateTransform = new TranslateTransform();
        translateTransform.X = -element.Left;
        translateTransform.Y = -element.Top;
        transformGroup.Children.Add(translateTransform);

        DrawingVisual vis = new DrawingVisual();
        DrawingContext cont = vis.RenderOpen();
        cont.PushTransform(transformGroup);
        cont.DrawImage(bi, new Rect(new Size(bi.PixelWidth, bi.PixelHeight)));
        cont.Close();

        RenderTargetBitmap rtb = new RenderTargetBitmap(element.Width, element.Height, 96d, 96d, PixelFormats.Default);
        rtb.Render(vis);
        bitmaps[i] = rtb;
    }
}

for (var i = 0; i < bitmaps.Length; i++)
{
    using (MemoryStream ms = new MemoryStream())
    {
        PngBitmapEncoder encoder = new PngBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(bitmaps[i]));
        encoder.Save(ms);
        var regionKey = WebPath.Variant(key, elements[i].Id);
        saveBlobService.Save("image/png", regionKey, ms);
    }
} 
```

我正在运行多个线程，这些线程将作业从队列中取出。我发现如果这部分代码一次被 4 个线程命中，我会得到 OutOfMemory 异常。我可以通过将上面的所有代码包装在 a 中来阻止这种情况发生，`lock(obj)`但这并不理想。我尝试只包装第一个 using 块（从磁盘读取文件并拆分），但我仍然遇到内存不足异常（这部分代码执行得非常快）。

*   考虑到这应该占用的内存量，这很正常吗？
*   我可以做任何优化吗？
*   我可以增加可用内存吗？

更新：

根据 Moozhe 的帮助，我的新代码

```
public static void GenerateRegions(this IBlobService blobService, string key, Element[] elements)
{
    using (var stream = blobService.Stream(key))
    {
        foreach (var element in elements)
        {
            stream.Position = 0;
            BitmapImage bi = new BitmapImage();
            bi.BeginInit();
            bi.SourceRect = new Int32Rect(element.Left, element.Top, element.Width, element.Height);
            bi.StreamSource = stream;
            bi.EndInit();

            DrawingVisual vis = new DrawingVisual();
            DrawingContext cont = vis.RenderOpen();
            cont.DrawImage(bi, new Rect(new Size(element.Width, element.Height)));
            cont.Close();

            RenderTargetBitmap rtb = new RenderTargetBitmap(element.Width, element.Height, 96d, 96d, PixelFormats.Default);
            rtb.Render(vis);

            using (MemoryStream ms = new MemoryStream())
            {
                PngBitmapEncoder encoder = new PngBitmapEncoder();
                encoder.Frames.Add(BitmapFrame.Create(rtb));
                encoder.Save(ms);
                var regionKey = WebPath.Variant(key, element.Id);
                blobService.Save("image/png", regionKey, ms);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:41:43.473

如果您尝试并行调用 4000x6000 图像的 DrawImage，那么您将度过一段糟糕的时光。您裁剪它为时已晚，当您将其渲染到 RenderTargetBitmap 时，它已经在内存中呈现全尺寸。

不要使用变换裁剪图像源，而是尝试使用 BitmapImage.SourceRect 属性，如下所示：

BitmapImage.SourceRect = new Rect(element.Left, element.Top, element.Width, element.Height);

您可能想在调用 BeginInit() 之前尝试放置它，并完全摆脱转换。

编辑：实际上，在您的情况下，您必须在 for 循环的每次迭代中更改 SourceRect 。请记住，您必须将 DrawImage 中的 Size 参数更改为元素大小。

# iphone - MFMessageComposeViewController 没有调用它的委托方法

> ID：10951111
> 
> 赞同：4
> 
> 时间：2012-06-08T14:48:08.887
> 
> 标签：iphone, objective-c, ios, xcode, mfmessagecomposeview

嗨，我正在使用 MFMessageComposeViewController 在我的 iOS 项目中发送短信，我的代码如下所示，

```
 MFMessageComposeViewController *message = [[MFMessageComposeViewController alloc] init];
    message.delegate = self;
    message.recipients = [NSArray arrayWithObject:@"xxxxxx"];
    message.body = @"blha blah,,,,";
    [self presentModalViewController:message animated:YES]; 
```

在我的代码中，我定义了 MFMessageComposeViewControllerDelegate 方法**didFinishWithResult**但是当任务完成时，控制没有调用这个 didFinishWithResult 委托方法。可能是什么问题？

提前感谢任何帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-08T14:50:43.020

你必须设置[`mailComposeDelegate`](http://developer.apple.com/library/ios/#DOCUMENTATION/MessageUI/Reference/MFMessageComposeViewController_class/Reference/Reference.html#//apple_ref/doc/uid/TP40009668-CH1-SW5)

```
 message.messageComposeDelegate = self; 
```

# asp.net - 从母版页中的用户控件访问页面公共属性

> ID：10951113
> 
> 赞同：0
> 
> 时间：2012-06-08T14:48:16.623
> 
> 标签：asp.net, reflection, user-controls, master-pages

我正在尝试从用户控件访问母版页内页面的公共属性，该用户控件也在同一母版页内。我见过的大多数示例都建议我将属性中的值放在页面上的隐藏元素中，并通过获取对母版页的引用并使用类似的东西来访问它

```
Dim mstr As MasterPage = Page.Master
Dim element = mstr.FindControl("hiddenField1"), HiddenField) 
```

或以其他方式将值放入 cookie、URL 等并从用户控件中读取。

但是我能够使用

```
Protected Sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load
    Dim mstr As MasterPage = Page.Master
    Return CallByName(mstr.Page, "ProductCounter", [Get])
End Sub 
```

由于我的解决方案适用于

> CallByBame 基本上为您提供“后期绑定”，即“在运行时找出方法”，而不是编译器为您找出方法的“早期绑定”。

[从这个答案](https://stackoverflow.com/a/1299939/394381)

我想知道，考虑其他解决方案。考虑到性能、安全性、类型安全等，第二种方式仍然是实现这一目标的劣势方法吗？

编辑：[Icarus](https://stackoverflow.com/a/10951374/394381)的答案适用于 asp..net Web 应用程序，但不适用于 asp.net 网站。我正在寻找一个适用于后者的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:04:06.380

如果我理解正确，您根本不需要使用反射。你应该能够在你的控制中做这样的事情（C#，对不起）：

```
//Assume "MyPage" is the Page inside the MasterPage
MyPage myPage = this.Page as MyPage;
if(myPage!=null)
{
    var publicProperty = myPage.PublicProperty;
} 
```

**更新**：提供一个简化的例子。

Site.Master：

```
<asp:ContentPlaceHolder ID="MainContent" runat="server">        
</asp:ContentPlaceHolder>
<%--this is the user control on the MasterPage--%>
<uc1:WebUserControl1 ID="WebUserControl11" runat="server" /> 
```

假设您有另一个页面，名为“About”，它使用此 Site.Master，并且此“About”页面有一个名为“PublicProperty”的公共属性，如下所示：

```
public string PublicProperty {
        get { 
            return ViewState["Key"] as string; 
        } 
        set { 
            ViewState["Key"] = value; 
        } 
} 
```

现在，在您的 WebUserControl 中，您可以安全地执行此操作，例如在 Page_Load 上：

```
 protected void Page_Load(object sender, EventArgs e)
 {
        About p = this.Page as About;
        if (p != null){
            var prop = p.PublicProperty;
            //Do Something cool with it
        }
 } 
```

# progress-4gl - 如何在 OpenEdge SQL 中模拟 SELECT ... LIMIT、OFFSET？

> ID：10951114
> 
> 赞同：3
> 
> 时间：2012-06-08T14:48:18.357
> 
> 标签：progress-4gl, openedge

在大多数 SQL 实现中，能够选择查询中返回的所有行的“滑动窗口”子集是很常见的事情。一个常见的用例是分页。例如，假设我有一个搜索页面，每页有 10 个结果。对于支持`LIMIT`和`OFFSET`关键字的实现，用于返回每个页面结果的查询如下：第一页将使用`SELECT ... LIMIT 10 OFFSET 0`，第二页将使用`SELECT ... LIMIT 10 OFFSET 10`，第三页将使用`SELECT ... LIMIT 10 OFFSET 20`，等等（注意在`OFFSET`之前生效`LIMIT`）。

无论如何，我试图在 OpenEdge 的 SQL 引擎中模仿这个功能。我已经发现`SELECT TOP`它基本上等同于`LIMIT`，但是我找不到任何类似的东西`OFFSET`（我认为没有*确切的*等价物）。SQL Server 和 Oracle 也缺少`OFFSET`，但它们分别有一个名为`ROWCOUNT`and的伪`ROWNUM`列，可用于模拟嵌套选择的行为（请参阅[此处](https://stackoverflow.com/a/2135449/215168)和[此处](https://stackoverflow.com/a/470571/215168)）。

在[10.2B SQL 参考](http://documentation.progress.com/output/OpenEdge102b/pdfs/dmsrf/dmsrf.pdf)文档中，p49 有一个标题为**TOP 子句**的小节，它在底部说

> `SELECT TOP`是 Oracle 功能的等效`ROWNUM` 功能。请注意，`SELECT TOP`它只是根据结果集大小的限制来定义的，优化器确定如何使用此限制来实现最佳数据访问。因此，`SELECT TOP`并不具有所有用于定义 Oracle`ROWNUM` 短语含义的“程序规则”。

然而，这似乎是不准确的，因为根据`TOP`'s 的语法它不能用作像`ROWNUM`can 这样的谓词（例如，我不能说`SELECT * FROM Customer WHERE TOP > 5 AND TOP < 10`）。所以在功能`TOP`上**不**等同于`ROWNUM`.

有什么办法可以模仿`OFFSET`，还是我运气不好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-11T14:42:50.207

OpenEdge 11.2 增加了对 SQL查询的支持[`OFFSET`和`FETCH`子句；](http://documentation.progress.com/output/OpenEdge112/oe112html/wwhelp/wwhimpl/js/html/wwhelp.htm#href=Data%20Management/SQL%20Reference/05dmsrfStmt.132.45.html#480988)`SELECT`低于 11.2 的 OpenEdge 版本不支持`OFFSET`/ `FETCH`。

来自[11.2 产品文档](http://communities.progress.com/pcom/docs/DOC-107875)“SQL 参考”文档：

```
The OFFSET clause specifies the number of rows to skip, before starting to return rows
from the query expression. The FETCH clause specifies the number of rows to return,
after processing the OFFSET clause. 
```

值得注意的是**`TOP`and `OFFSET`/`FETCH`子句是互斥的**——`TOP`不能在使用`OFFSET`or的查询中使用`FETCH`。

## 文档中的示例查询：

跳过前 10 行并返回其余符合条件的行：

```
SELECT OrderID,OrderDate,custID,filler
FROM dbo.Orders OFFSET 10; 
```

返回前 10 行而不跳过任何行：

```
SELECT OrderID,OrderDate,custID,filler
FROM dbo.Orders
ORDER BY OrderDate DESC, OrderID DESC
FETCH FIRST 10 ROWS ONLY; 
```

返回查询结果集中的第 51 到 60 行：

```
SELECT OrderID,OrderDate,custID,filler
FROM dbo.Orders
ORDER BY OrderDate DESC, OrderID DESC
OFFSET 50 ROWS FETCH NEXT 10 ROWS ONLY; 
```

# java - 将 System.in 设置为从 JTextField 中读取

> ID：10951116
> 
> 赞同：2
> 
> 时间：2012-06-08T14:48:23.300
> 
> 标签：java, input, inputstream, system.in

我正在寻找有关如何`System.in`用`InputStream`直接从`JTextField`.

到目前为止，我的方法几乎是反复试验。我目前有；

```
JTextField input = new JTextField();

System.setIn(new InputStream() {
  int ptr = 0;
  @Override
  public int read() throws IOException {
     int c;
     try {
        c = input.getText().charAt(ptr);
     }
     catch (IndexOutOfBoundsException ioob) {
        return 0;
     }
     ptr++;
     return c;
  }
}); 
```

`NoSuchElementException`当输入为空并且我假设永远找不到分隔符时，这会产生一个尝试读取的结果。

我错过了什么方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T20:47:36.743

好吧，这是我用来让它正常工作的方法。如果有人可以改进这个答案，那么请随意。

```
final LinkedBlockingQueue<Character> sb = new LinkedBlockingQueue<Character>();

final JTextField t = new JTextField();
t.addKeyListener(new KeyListener() {
  @Override
  public void keyTyped(KeyEvent e) {
    sb.offer(e.getKeyChar());
  }
  ...
});

System.setIn(new BufferedInputStream(new InputStream() {
  @Override
  public int read() throws IOException {
    int c = -1;
    try {
      c = sb.take();            
    } catch(InterruptedException ie) {
    } 
    return c;           
  }
})); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:57:50.547

你看了一半，但是：

来自 Javadocs

> 此方法会一直阻塞，直到输入数据可用、检测到流结束或引发异常。

[http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStream.html#read%28%29](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStream.html#read%28%29)

所以你的方法应该只是等待一个键被按下。通过处理 NoSuchElementException 或检查有多少（新？）字符可用的 KeyListener。

此 InputStream 的语义与控制台不同，因此您需要对如何处理编辑做出一些设计决策，而不仅仅是按键。

# asp.net - 在我的新 hostgator 服务器上存储 .vb 和 .dll 文件的位置

> ID：10951119
> 
> 赞同：0
> 
> 时间：2012-06-08T14:48:32.020
> 
> 标签：asp.net, directory, structure, placement

我正在将我的投资组合转移到我的新服务器上。我有几个打嗝，但这是我坚持的一个。

在我的旧服务器上，我的 Web 空间的根目录中有两个名为“App_Data”和“bin”的目录。我将未编译的代码文件（.vb 文件）放在“App_Data”目录中，将“.dll”文件放在 bin 目录中。在我的新服务器上，我无法在根目录中创建新目录。我联系了 HostGator，他们说我的问题是特定于应用程序的。

.dll 文件非常重要，因为我需要它来连接到 mySql

这是我的服务器设置的样子（右侧）

[http://i67.photobucket.com/albums/h313/Epro95/Screenshotfrom2012-06-08113103.png](http://i67.photobucket.com/albums/h313/Epro95/Screenshotfrom2012-06-08113103.png)

另外我已经尝试过 App_Code 文件夹，但不起作用。

这段代码的工作方式非常

暗淡的新闻作为新闻源

新闻 = 新的新闻源（）

newsLabel.text = newsfeed.generateNews()

数据类（这是他们应该被调用的吗？）为我处理所有的 mySql 管道。

# javascript - 从 dojo.form.Multiselect 中选择和删除项目

> ID：10951120
> 
> 赞同：3
> 
> 时间：2012-06-08T14:48:34.097
> 
> 标签：javascript, dojo

我在向导对话框上有两组 dojo.form.Multiselect 框。他们有能力在他们之间传输项目，比如这个例子：[Testing Multiselect from Widget](http://download.dojotoolkit.org/release-1.7.1/dojo-release-1.7.1/dijit/tests/form/test_MultiSelect.html)。我在表单上还有一个复选框，当用户点击它时，我需要：

1.  选择第一个多选框中的所有项目
2.  通过 addSelected() 将它们移动到右侧选择框
3.  清除所有项目的第一个列表

inversertSelection 选项不起作用，因为如果在单击复选框时选择了任何项目，则只会选择和移动未选择的项目。我在 API 中看不到执行此操作的方法，也没有在代码圈中看到可靠的方法。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T20:25:02.430

通过查看 Dojo Docs 和其他代码找到了解决方案：

```
var selectItem1 = dijit.byId('firstSelectBox');

// Deselect all and invert to Select all
selectItem1.set("value",[]);
selectItem1.invertSelection();

//Move items to right box
var selectItem2 = dijit.byId('secondSelectBox');
selectItem2.addSelected(selectItem1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T07:39:28.657

基本上 addSelected 对 select 进行 dom 查询，以查看哪些选项被标记为 selected ：

```
query("option",this.containerNode).filter(function(n){
return n.selected; // Boolean
}); 
```

因此您基本上可以通过以下方式选择所有内容：

```
query("option", myMultiSelect.containerNode).forEach(function(n){
    n.selected = true; // Boolean
}); 
```

然后使用 addSelected... 这样的东西应该可以解决问题。

# multithreading - 多线程究竟是如何工作的？

> ID：10951124
> 
> 赞同：2
> 
> 时间：2012-06-08T14:48:43.193
> 
> 标签：multithreading, concurrency, scalability

我想知道多线程究竟是如何解决可伸缩性问题的。我的基本理解是当请求进入时，分配一个新线程来处理请求。但是幕后究竟发生了什么。

我目前正在启动一个项目，我必须构建一个存储云来处理 1000 次 GET、PUT、DELETE 操作。多线程会解决可扩展性问题，还是应该研究事件服务器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T19:17:38.740

多线程允许一次运行多个线程。在多核机器上，这意味着两个线程*可以*真正并行运行，其工作量是一次运行一个线程的两倍。理想情况下，在具有 4 个线程的 4 核机器上，您完成的工作量几乎是单线程的 4 倍。

为此，您需要一个*可以*通过多个线程独立运行来解决的问题。您需要相当聪明才能弄清楚如何将程序分解为线程。而且，大多数时候，您需要*非常*聪明地防止这些线程破坏彼此的数据（或者更糟糕的是，巧妙地破坏它）。虽然有时可以几乎独立地运行线程，就像同一程序的不同会话一样，如果你能做到这一点，那就太好了。

多线程可以扩展，您可以使所有内核工作。在 4 核机器上，您完成的工作量是 4 倍——希望如此。如果你升级到 16 核机器，你会得到另外 4 倍的增长——如果你做了一些非常聪明的编程的话。如果您吹嘘自己比竞争对手快 50%，那么您最好在竞争对手之前使用多线程。

否则，请使用单线程解决方案。这要简单得多。（对我来说，数千听起来并不是很多数据。如果它可以达到数百万，那么多线程可能是值得的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:55:59.810

多线程可以提供帮助，因为通常正常的 HTTP 执行包含许多 I/O。如您所知，IO 操作很繁重并且需要很长时间。因此，在实践中，当您有 1 个请求需要获取 A 类的实例和 B 类的实例时，如果您创建 2 个线程，一个用于访问 A 实例，另一个用于从数据库访问 B 类的实例，您可以将每个实例加载到单独的线程上，这样您将更有可能线程 A 执行其代码，而线程 B 在 IO 上被阻塞，反之亦然。因此，使用多线程可以赢得 IO 处理时间。

这是第一个好处。使用多线程的另一个好处是，您不必为传入连接保留空线程，而是使用异步事件处理模型。有一个很棒的实现使用了这种称为[netty](http://www.jboss.org/netty)的技术，每秒可以处理 50 000 + 个请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:57:45.770

多线程唯一擅长的是多核计算。

通常事件模型更轻量级，因为您可以完全控制代码执行。例如，如果您当前正在获取和处理 HTTP 标头并且需要唤醒其他一些线程，这意味着：

*   完整的处理器状态被保存；
*   当前的 cpu 缓存被严重破坏；
*   一些代码运行；
*   完整的处理器状态得到恢复。

在事件模型中，您将拥有结束整个周期、保存数据并参加另一个事件的完全权利。第二个事件将等到您完成工作。但是，您通过劫持工作代码所喷出的时间通常要长得多。

内存管理也很重要：在线程模型中，您需要锁来同步对重要数据的访问，而事件模型不需要锁，也不需要每个线程特定数据的额外内存。

这也是网络服务器背后的重点：这样 nginx 可以处理数千个连接而不会破坏机器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-25T13:46:03.073

线程是任务的最小单位。当一个任务/线程正在等待 i/o 或其他事情时，它将脱机，其他线程将开始执行。这发生在几微秒内。此外，如果我们有多个处理器，我们可以同时运行那么多线程。

我们需要谨慎对待我们可以制作的线程。一个线程不应依赖于另一个线程的输出。在这种情况下，多线程概念将给出快速的结果。有时我们需要依赖其他线程。那时我们使用同步。

如果您的所有操作都可以采用并行路径，那么多线程可以提高性能。如果操作相互依赖，那么您可以查看事件服务器。

# java - 通过 HTTP 代理连接到 FTP 服务器

> ID：10951129
> 
> 赞同：3
> 
> 时间：2012-06-08T14:48:50.923
> 
> 标签：java, proxy, ftp, ftp4j

我正在使用 it.sauronsoftware.ftp4j 通过 Internet 在端口 21 上连接到 FTP 服务器。

我通过 HTTP 代理进行连接，所以我使用的是 HTTPTunnelConnector。

我能够连接并登录到 FTP 并将模式设置为被动没有问题

现在，当我尝试下载文件、LIST 文件或任何其他需要数据连接的文件时，我从 FTP 服务器收到“425 无法打开数据连接”。所以，我能够建立常规的 FTP 连接，但是数据连接是个问题。

现在，让我感到困惑的是，有 10-15% 的时间，数据连接实际上是通过的，而且我能够下载文件！当我立即重新运行我的程序时，它再次失败并显示 425 错误代码，并继续这样做，直到它再次神奇地工作。

这让我认为这可能是一个端口问题——数据连接被一个阻塞的端口停止，有时幸运地找到一个可以连接的开放端口——但这是一个没有根据的猜测。

有没有人经历过类似的事情？我的猜测是否是 HTTP 代理中的端口问题，或者可能是 FTP 服务器前面的防火墙中的端口问题，听起来正确吗？

编辑：我将 FTPCommunicationListener 附加到客户端。这是通信日志（检查 IP 地址、用户名和密码）

```
Connected, logging in
Sent: USER username
Received: 331 Password required for username
Sent: PASS password
Received: 230 Logged on
Sent: FEAT
Received: 211-Features:
Received:  MDTM
Received:  REST STREAM
Received:  SIZE
Received:  MLST type*;size*;modify*;
Received:  MLSD
Received:  AUTH SSL
Received:  AUTH TLS
Received:  PROT
Received:  PBSZ
Received:  UTF8
Received:  CLNT
Received:  MFMT
Received: 211 End
Sent: OPTS UTF8 ON
Received: 200 UTF8 mode enabled
Sent: TYPE A
Received: 200 Type set to A
Sent: PASV
Received: 227 Entering Passive Mode (xx,xx,xx,xx,xx,xx)
Sent: REST 0
Received: 350 Rest supported. Restarting at 0
Sent: RETR /directory/file.csv
Received: 425 Can't open data connection.
it.sauronsoftware.ftp4j.FTPException [code=425, message= Can't open data connection.]
    at it.sauronsoftware.ftp4j.FTPClient.download(FTPClient.java:3330)
    at it.sauronsoftware.ftp4j.FTPClient.download(FTPClient.java:3213)
    at it.sauronsoftware.ftp4j.FTPClient.download(FTPClient.java:3078)
    at FtpTest.getFileOutputStream(FtpTest.java:131)
    at FtpTest.main(FtpTest.java:18) 
```

发送：QUIT 接收：221 再见

# c# - C#中的日期时间转换问题

> ID：10951130
> 
> 赞同：1
> 
> 时间：2012-06-08T14:48:52.083
> 
> 标签：c#, datetime

我有以下 SQL 片段：

```
WHERE YEAR(wo.audt_created_dttm) >= 2011 - 3 --narrows down to a year
AND YEAR(wo.audt_created_dttm) >= 2006 -- bad data less than 2006
AND wo.audt_created_dttm < DATEADD(mm, 1, CAST(CAST(1 * 3 as varchar) + '/01/' +  CAST(2011 as varchar) as DateTime)) 
```

我将其翻译成 LINQ to SQL（用于 LINQPad 中的测试目的），如下所示：

```
int year = 2012, quarter = 1;
DateTime timeframe = new DateTime(year, (quarter * 3), 01).AddMonths(1); 

where wo.Audt_created_dttm.Value.Year >= year - 3 && wo.Audt_created_dttm.Value.Year >= 2006
    && wo.Audt_created_dttm < timeframe && (s.Id =="NM" || s.Id == "TH") && 
    (wo.Clsdt_date ?? new DateTime(3000, 01, 01)) < DateTime.Now 
```

但是，对于实际的解决方案，我不想专门定义年份或季度。我希望年份和季度是最新的。

这一年，我试图这样做：

```
DateTime timeframe = new DateTime(timeframe.Year, (quarter * 3), 01).AddMonths(1); 
```

但编译器根本不喜欢这样。然后我尝试了这个：

```
DateTime setYear = new DateTime();
DateTime timeframe = new DateTime(setYear.Year, (quarter * 3), 01).AddMonths(1) 
```

那也没有用。我不知道如何做一年或季度，希望有任何建议

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T14:56:29.543

> 我希望年份和季度是最新的。

要获取当前季度的第一天，您可以使用以下代码：

```
var now = DateTime.Now;
var quarter = (now.Month - 1)/3;
var timeframe = new DateTime(now.Year, 3*quarter + 1, 1); 
```

`timeframe`将包含 2012-04-01、2012-07-01、2012-10-01 等，具体取决于当前日期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:52:42.817

你想要当前的年份吗？

```
 DateTime.Today.Year 
```

# iphone - UISegmentedView 中的 UIButton 没有被按下

> ID：10951132
> 
> 赞同：2
> 
> 时间：2012-06-08T14:48:59.257
> 
> 标签：iphone, ios, cocoa-touch, cocoa, uisegmentedcontrol

我在 UISegmentedView 的一个 UISegments 中放置了一个自定义 UIButton，但不知何故，这个按钮没有被按下。我使用以下代码：

```
UIButton* button=[UIButton buttonWithType:UIButtonTypeCustom];
button.frame=CGRectMake(0, 0, 103, 30);
[button addTarget:self action:@selector(handleSaleChange:) forControlEvents:UIControlEventAllTouchEvents];
button.backgroundColor=[UIColor redColor];
[[[self.segmentControl subviews]objectAtIndex:2] addSubview:button];
[self.segmentControl bringSubviewToFront:button]; 
```

知道为什么我会遇到这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:04:36.723

该按钮是*subview 的子视图*，因此它不会很快触发，因为分段控件无论如何都会捕获其触摸。将其添加为控件的子视图，然后重试。

# jquery - 如何在 jquery 中以相反的方式制作动画？

> ID：10951135
> 
> 赞同：0
> 
> 时间：2012-06-08T14:49:13.980
> 
> 标签：jquery, jquery-animate

我正在使用 jquery 为垂直条设置动画，但它是从上到下的，而我需要从下到上。

这是酒吧的css：

```
.progress_bar_cal{
height:0px;
width:24px;
-moz-border-radius:5px;
-webkit-border-radius:5px;
border-radius:5px;
background:url(../img/grow.jpg);
margin-right:1px;
margin-top:2px;
} 
```

这是jQuery：

```
$('.progress_bar_cal').each(function(){
    var percent = $(this).attr('title');
    $(this).animate({height : percent},1000);   
}); 
```

关于如何使其工作的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:52:36.023

如果`.progress_bar_cal`在一个元素内，`position: absolute`你应该看到栏从下到上展开`bottom : 0``position: relative`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:51:52.343

如果您希望元素从底部打开，则需要将其绝对定位到元素的底部：

```
<div id="container">
    <div class="slideMe"></div>
</div> 
```

样式如下：

```
#container {
    position: relative;
    height:   300px;
}
.slideMe {
    position: absolute;
    bottom:   0;
    display:  none;
} 
```

小提琴：http: [//jsfiddle.net/jonathansampson/nCGYD/](http://jsfiddle.net/jonathansampson/nCGYD/)

# entity-framework - 删除时实体框架代码优先并发

> ID：10951142
> 
> 赞同：0
> 
> 时间：2012-06-08T14:49:29.933
> 
> 标签：entity-framework, concurrency

在实体框架代码优先中，如果 SaveChanges 方法失败是因为它试图更新用户刚刚在另一台机器上删除的记录，我如何告诉 EF 插入记录而不是更新它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:07:28.403

一种解决方案（也许不是最好的）是将调用 SaveChanges() 的代码放在 try/catch 块中。如果发生异常，请检查记录是否被删除，并将实体的状态设置为 EntityState.Added 并再次调用 SaveChanges。

# c# - 使用更新面板防止 RadUpload Control 回发

> ID：10951145
> 
> 赞同：2
> 
> 时间：2012-06-08T14:49:45.580
> 
> 标签：c#, asp.net, file-upload, updatepanel, postback

我正在尝试使用 RadUpload 控件，但是，在任何按钮上单击页面回发。为了解决这个问题，我尝试使用 updatePanel 并将按钮放在 updatePanel 中，以便只发生部分回发。原因是 RadUpload 控件在回发时失去了它的价值。我正在动态创建所有控件，作为 asp.net 和 C# 的初学者，这对我来说很棘手。

这是代码：

```
Button aButton = new Button();
aButton.ID = newControls[1].ID + "_Button";
aButton.Click += new EventHandler(aButton_Click);
aButton.UseSubmitBehavior = false;

AsyncPostBackTrigger trigger = new AsyncPostBackTrigger();
trigger.ControlID = aButton.ID;
trigger.EventName = "Click";

UpdatePanel container = new UpdatePanel();
container.ID = newControls[1].ID + "_Container";
container.ChildrenAsTriggers = true;
container.UpdateMode = UpdatePanelUpdateMode.Conditional;
container.Triggers.Add(trigger);
container.ContentTemplateContainer.Controls.Add(aButton);

tcControl.Controls.Add(container);

static void aButton_Click(object sender, EventArgs e)
{
    // Do Something
} 
```

我知道我可能做错了什么哈哈，但任何建议都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T17:19:19.647

您是否在回发时再次创建控件？如果我没记错的话，应该在 init 或 preinit 上再次创建控件，以便将视图状态加载到其中。

这个视频[http://www.asp.net/web-forms/videos/aspnet-ajax/how-to-dynamically-add-controls-to-a-web-page](http://www.asp.net/web-forms/videos/aspnet-ajax/how-to-dynamically-add-controls-to-a-web-page)显示类似的东西，我猜，否则星期一我可以在工作时在我的电脑上查找我自己的代码。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-18T13:10:10.623

我已经通过从页面中完全删除此上传控件并用加载外部上传页面（只是一个弹出窗口）的按钮替换它来解决这个问题。我无法找到我最初想要的解决方案，但我目前的解决方案就是我现在所拥有的。

# java - 使用 LineNumberReader 类显示 line/word/#line

> ID：10951146
> 
> 赞同：0
> 
> 时间：2012-06-08T14:49:46.437
> 
> 标签：java, line-numbers

我们假设创建一个方法： • 文件中的行数 • 文件中的字数，以及 • 文件中不包括空格的字符数。即文件：xxx.txt有120行，317字，4154个字符

• 逐行搜索给定字符串的文件。输出必须包含行号，后跟包含搜索参数的行的内容。例如，将以下内容作为输入字符串：Java，其中 Java 是搜索字符串，输出将是这样的：

5：在爪哇岛上

9：JAVA的人喜欢java。

在本练习中使用 LineNumberReader 类

我很难过。当我运行我的代码时，我不断收到一个 I/O 错误，说流已关闭。

这是我的代码。我有线条、文字、人物的部分。但我无法让第二部分工作

```
public String wordCount()
{
    try
    {
        int wordCount = 0,
            numberCount = 0,
            lineCount = 1,
            characterCount = 0;

        String c = " "; 

        FileReader r = new FileReader(f);
        LineNumberReader lnr = new LineNumberReader(r);
        StreamTokenizer t = new StreamTokenizer(r);
        ArrayList <String> results = new ArrayList<String>();

        t.resetSyntax();
        t.whitespaceChars(0, ' ');
        t.wordChars('a','z');
        t.wordChars('A','Z');
        t.wordChars('0','9');

        t.eolIsSignificant(true);

        while(t.nextToken() != StreamTokenizer.TT_EOF)
        {
            switch(t.ttype)
            {
            case StreamTokenizer.TT_NUMBER:
                numberCount++;
                break;
            case StreamTokenizer.TT_WORD:
                characterCount += t.sval.length();
                wordCount++;
                break;
            case StreamTokenizer.TT_EOL:
                lineCount++;
                break;
            case StreamTokenizer.TT_EOF:
                break;
                default:

            }
        }

        r.close();
    BufferedReader bf = new BufferedReader(new FileReader(f));
    BufferedWriter out = new BufferedWriter(new FileWriter("test.txt"));
    BufferedWriter output = new BufferedWriter(new FileWriter("output.txt"));
    int recCount = 0;
    String record = null;
       while ((record = bf.readLine()) != null) {
          recCount++;
          out.write(recCount + ": " + record);
          out.newLine();
       }
    out.close();

    String ask = "Enter Word";

String find = JOptionPane.showInputDialog(ask);
String word = find;

while(lnr.readLine() != null )
    {
        String line = lnr.readLine();
        if (line.indexOf(word) >= 0)
        {
            results.add(lnr.getLineNumber() + line);
        }
    } 
    lnr.close();

       String str = f.getName() + " has " +  lineCount + " line(s), " +
                 wordCount + " word(s), " +
                 characterCount  + " characters. " + "\n These lines contain"
               + "the word in search of:" ;
       for(int index=0; index<results.size();index++)
       {
           if(results !=null)
           {
               str+= results.get(index) + "\n";
           }
        }

     return str;
    } 
```

我注意到它打破了这部分代码。如果我将代码注释掉，它会减去我想要做的部分。

```
String ask = "Enter Word";

String find = JOptionPane.showInputDialog(ask);
String word = find;

while(lnr.readLine() != null )
    {
        String line = lnr.readLine();
        if (line.indexOf(word) >= 0)
        {
            results.add(lnr.getLineNumber() + line);
        }
    } 
lnr.close(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:00:33.257

在你的循环中

```
while(lnr.readLine() != null ) 
```

您尝试从 中读取`lnr`，它依赖于`r`您之前关闭的 。

`r`解决方案：在完全完成文件之前不要关闭。由于您想再次打开文件，最简单的方法是将上述循环移到 . 之前，`r.close()`因为循环不依赖于`out`.

另外，当你写

```
while(lnr.readLine() != null)
{
  String line = lnr.readLine(); 
```

您正在跳过行（您在循环条件中读取一个，它被丢弃，然后您将下一行读入`line`. 您可以这样做：

```
String line = null;
while((line = lnr.readLine()) != null)
{
  // rest of the loop 
```

这将读取下一行，将其分配给`line`并检查`null`每次执行循环

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:01:15.663

我认为你的问题可能是这条线

```
r.close(); 
```

正在关闭文件的句柄。因此，当您稍后尝试阅读它时，您将无法再看到它。尝试删除该关闭。

**编辑：** 见阿提拉的更详细的答案:)

# c# - 按钮单击事件 C#

> ID：10951147
> 
> 赞同：1
> 
> 时间：2012-06-08T14:49:48.247
> 
> 标签：c#, methods

所以我有一个带有几个字段的 Windows 表单来接受数据并写入 SQL 数据库。我的 button_click 事件负责处理除了验证用户输入之外的所有工作。这些是通过不同的方法处理的。我的问题是，如果用户输入不正确，我如何在显示消息框后重置表单？也许只是使用按钮单击事件来启动一个单独的方法，以便我可以更好地控制它？

```
private void enter_button_Click(object sender, EventArgs e)
{
    restart:
    try {
        try {
                Validate(fname);
                Validate(lname);
                Validate(city);
                Validate(state);
        } catch (Exception ex) {
            MessageBox.Show(ex.Message);
            if (ex != null) {
                fname.Clear();
                lname.Clear();
                city.Clear();
                state.Clear();
                goto restart;
            }
        }
        try {
            exValidate(address);
        } catch (Exception ex1) {
            MessageBox.Show(ex1.Message);
            if (ex1 != null) {
                address.Clear();
                goto restart;
            }
        }
        //blah blah...write to database.
    }
    // ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:57:35.540

您在按钮单击中有太多逻辑。就个人而言，我宁愿验证每个领域失去焦点。如果您不想这样做，请创建一个类似 bool ValidateForm() 的方法并将所有验证逻辑包装在那里。如果至少一个内部验证失败，则返回 false。还要创建一个类似 void ClearForm() 的方法，在其中包装所有逻辑以清除所有字段。请记住，模块化代码总是好的，这样您就可以重用您的逻辑，在这里您将清除和验证逻辑与特定事件（按钮单击）联系起来。

所以在 Enter 点击你想要的

```
if(!ValidateForm())
{
   MessageBox.Show("Invalid Form");
   ClearForm();
   return;
}
SaveForm(); 
```

我强烈建议不要使用 GOTO 指令！这是一种非常危险的做法，可能会将您的代码变成意大利面条式的噩梦。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:57:55.570

```
if (MessageBox.Show(Exception.Message) == System.Windows.Forms.DialogResult.OK)
{
    //Clear all needed controls here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:00:33.540

Lots of problems with your code. Why do you check if `ex!=null` after you display it in the `MessageBox`? And using goto labels is not standard in C#.

The nested try is not nice either. Seperate your code a bit, as in have a seperate function that takes care of just validating the data. Your button click handler should not have to do all this work. So you would have a `validate()` function that takes care of validation logic and a `clearForm()`.

That would essentially untangle all the mess in your button click handler and it would simply have to do something along the lines of:

```
if (validate())
  //save to db
else
  clearForm() 
```

Also you should rethink your design, function should only throw exception if it is really needed. Do you need to throw an exception because one form input was not in a valid format?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:00:52.057

Just drop the `goto`s. And let the user fix the wrong entries. When he has done it, he will click on the button again. If you go to `restart:` you might be caught in an endless loop.

If you clear all the fields when an error occurs, the user will have to reenter all the fields. Just tell him which fields are wrong and why, so that he can just fix the bad entries and can click the button when he fixed the problems.

And by the way, using `goto` is really ugly. Use it only in very very rare situations!

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T15:51:58.437

My suggestion would be use a background worker thread to handle the logic and just have the background worker triggered by button_click. That way you can terminate the background worker thread if the user makes a mistake and restart the whole process via button_click.

Sources:

[how to keep a control disabled till a thread ends](https://stackoverflow.com/questions/10024018/how-to-keep-a-control-disabled-till-a-thread-ends/10025636#10025636)

[http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

# sql - 获取所有公司的最后6个订单

> ID：10951148
> 
> 赞同：-1
> 
> 时间：2012-06-08T14:49:50.790
> 
> 标签：sql, sql-server

我有 2 张桌子.. 一张客户桌子.. 和订单表格.. 我正在尝试从每个客户那里获得最后 6 个订单，但是对于所有客户来说……我很难考虑如何做到这一点哈哈..今天是星期五...有什么帮助/想法吗？..如果您需要知道，我正在使用 microsoft sql server studio

这是我现在拥有的代码

```
select /*top 6*/ c.Company_name, oh.qms_control_nbr, c.reminder_notice 
from orderheader oh inner join clients c on oh.prnt_id = c.id
where c.status = 'Active'
group by c.company_name, oh.date_ordered, oh.qms_control_nbr, c.reminder_notice
order by c.company_name asc, c.reminder_notice asc, oh.Date_ordered desc 
```

这给了我每个客户的所有订单，..只想限制到最后 6 个

所以..它可能会给出这样的结果

```
_company_____              __order-num___
company a                     1111
company a                     1112
company a                     1113
company a                     1114
company a                     1115
company a                     1116
company b                     1221
company b                     1222
company b                     1433
company b                     1524
company b                     1345
company b                     1436 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:55:52.570

您可以使用[`ROW_NUMBER`](http://msdn.microsoft.com/en-us/library/ms186734.aspx)OLAP 函数来获得：

*根据相关的新信息进行编辑。* 我认为这应该得到你正在寻找的东西：

```
SELECT c.Company_name, oh.qms_control_nbr, c.reminder_notice 
FROM (SELECT t.*,
             ROW_NUMBER() OVER (PARTITION BY prnt_id ORDER BY date_ordered DESC) AS RN
      FROM orderheader t) oh
JOIN clients c
  ON oh.prnt_id = c.id
WHERE c.status = 'Active'
  AND oh.rn < 7
ORDER BY c.company_name asc, c.reminder_notice asc, oh.Date_ordered desc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:53:59.693

```
select top 6 o.* from clienttable c
inner join orderstable o on c.columname = o.columnname
order by o.OrderProcessDate desc 
```

用正确的列替换`columnname`和。`OrderProcessDate`

# storyboard - 按下外部时 UIPopoverController 不会自动关闭

> ID：10951150
> 
> 赞同：0
> 
> 时间：2012-06-08T14:50:01.180
> 
> 标签：storyboard, uinavigationbar, toolbar, uipopovercontroller, dismiss

我需要在 iPad 导航栏左上角的三个按钮。从这里的另一篇文章中，我收到了在此处放置工具栏的建议，因为导航栏只允许一个左侧栏项目。现在有三个按钮（创建、重新排序、删除），每个按钮都会打开另一个弹出框。

坏事是在工具栏内点击不会关闭任何弹出窗口。如果我在导航栏的可见部分内部以及下方的任何位置（弹出框之外）点击，弹出框就会消失。但是当我点击位于导航栏上方的工具栏的剩余区域时（由于翻译，它应该比英文按钮要求的更宽），弹出框不会消失。更糟糕的是，如果我点击任何一个按钮，它的弹出框就会出现，覆盖在现有的按钮上。我什至可以堆叠相同的弹出框。

我可以想象一种停止覆盖弹出框的方法（在显示新弹出框之前，检查旧弹出框），但是在工具栏的空白区域中点击呢？

非常感谢任何帮助 - 包括如何在导航栏的左半部分添加三个按钮的其他提示。

问候，诺比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T10:27:48.960

最后，可以在这里找到解决方案：

[从 self.navigationItem（在 UINavigationController 内部）打开时，UIPopoverController 未解除](https://stackoverflow.com/questions/11578117/uipopovercontroller-not-dismissed-when-opened-from-self-navigationitem-inside-u)

诀窍是将 的设置`passThroughViews`为。`UIPopoverController``nil`

# java - 使用 JSF 和 PrimeFaces 进行自适应轮询

> ID：10951151
> 
> 赞同：4
> 
> 时间：2012-06-08T14:50:07.977
> 
> 标签：java, ajax, jsf, primefaces, polling

为了刷新数据，我使用 primefaces `poll`：

`<p:poll id="myPoll" interval="#{controller.interval}"/>`

并想用微调器控制更新间隔。

```
<p:spinner  value="#{controller.interval}">
  <p:ajax process="@this" update="myPoll"/>
</p:spinner> 
```

bean 属性的值按预期更新，但轮询间隔没有。轮询由生成的脚本执行，其中包括间隔值。如何强制`poll`重新生成更新脚本以包含新值而不提交/重新渲染整个表单？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T20:02:21.940

如果你给它一个`widgetVar`然后你可以用javascript操作它。

```
widget_form_j_idt19.stop();
widget_form_j_idt19.timer = 1;
widget_form_j_idt19.cfg.frequency = 1;
widget_form_j_idt19.start(); 
```

只需将其放入脚本中，您就可以在 ajax 更新后将其更新为您想要的任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-14T19:39:26.173

在这里解决：

我面临着类似的行为，只需在 bean 中设置值并将民意调查嵌入面板中，该面板可以在每次民意调查后进行更新。否则，poll 只是 js 代码，并没有添加到 DOM 中。否则，您可能会在回调参数上执行 js 并在客户端刷新值。

```
 <p:outputPanel id="infoPanel" >
    <h:panelGrid columns="1">
        <h1>TESTING POLLING</h1>
        <h:outputText id="ts" value="TS Update:#{testPollBean.timeStamp}"/>
        <h:outputText id="callNum" value="Call Number:#{testPollBean.callNumber}°"/>
        <h:outputText id="interval" value="Interval:#{testPollBean.interval} second"/>
        <h:outputText id="Stop" value="Stop:"#{testPollBean.stopPolling}"/>
    </h:panelGrid>  
</p:outputPanel>

<h:panelGrid id="panelPolling">
    <p:poll id="durrPolling" async="true" stop="#{testPollBean.stopPolling}"
        interval="#{testPollBean.interval}" 
        process="@this" partialSubmit="true" listener="#{testPollBean.listener}"
        update="panelPolling infoPanel" widgetVar="polling"
        autoStart="true" rendered="true"/>
</h:panelGrid>

@ViewScoped
@Named(value = "testPollBean")
public class TestPollBean implements Serializable {

    private static final long serialVersionUID = 1L;
    private static final Logger LOG = Logger.getLogger(TestPollBean.class);
    private Calendar calendar;
    private Date timeStamp;
    private Date nextCall;
    private int callNumber;
    private int interval;
    private boolean stopPolling;
    private boolean listenerBusy;

    @PostConstruct
    public void init() {
        this.calendar = Calendar.getInstance();
        this.timeStamp = calendar.getTime();
        this.nextCall = null;
        this.callNumber = 0;
        this.interval = 1;
        stopPolling = false;
        listenerBusy = false;
    }

    public void listener() {
        callNumber ++;
        LOG.info("-> Poll "+ callNumber + "° on thread " + Thread.currentThread().getId());
        if (!listenerBusy) {
            listenerBusy = true; // skip any other concurrence call 

            if (callNumber >= 30) {
                //stopPolling = true;
                this.interval = 30;
            }

            if (callNumber < 20) {
                this.timeStamp = calendar.getTime();
                calendar.add(Calendar.SECOND, interval);
                nextCall = calendar.getTime();

                LOG.info("\t > Attennding "+ callNumber + "° call on  thread " + Thread.currentThread().getId() + ". Sleeping ..." );
                try {
                    Thread.sleep(5000);
                } catch (InterruptedException e) {
                    LOG.info("\t\t E R R O R ! ! ! \t > Attennding "+ callNumber + "° call on  thread " + Thread.currentThread().getId() );
                }
                //Later on we will try to adapt dynamically the interval.
            } else  {
                LOG.info("\t > Attennding inmediately "+ callNumber + "° call on  thread " + Thread.currentThread().getId() + "." );
            }
            LOG.info("<-  Poll "+ callNumber + "° on thread " + Thread.currentThread().getId());

            listenerBusy = false;
        } else {
            LOG.info("<- Listener on thread " + Thread.currentThread().getId() + " dismiss call " + callNumber + "° cause is already busy.");
        }
    }
    + Getters / Setters 
```

恕我直言; 不要玩弄已经完成和工作的事情。

# dojo - dojo 小部件 ID 冲突

> ID：10951155
> 
> 赞同：0
> 
> 时间：2012-06-08T14:50:12.850
> 
> 标签：dojo

我这样写 My dojo Widgets 的 ctor。

```
 constructor: function(params){
        var r = this.inherited(arguments);
        this.params = params;
        //other ctor works
        return r;
    } 
```

我用 JSON 响应作为 ctor 参数来实例化小部件。like`new MyWidget(res)`
并且 JSON 响应包含`id`类似的属性`{id: 5, text: 'Hallo'}`

现在`_WidgetBase`构造函数将此 id 视为 Widget Id 并抛出`Tried to register widget with id==6 but that id is already registered`。因为可能还有其他一些小部件也在获取`id: 6`另一个*主题*。

而且我无法更改 JSON 对输出的响应，`subject_id`因为它需要更改很多东西。

我需要在小部件实例化后获取该 ID。

那么处理这个问题的好设计是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:55:01.123

有趣的问题！这是我的解决方案：http: [//jsfiddle.net/phusick/z9u8a/](http://jsfiddle.net/phusick/z9u8a/)

```
var Widget = declare(_WidgetBase, {

    postscript: function() {
        var id = arguments[0]["id"];
        delete arguments[0]["id"];
        this.inherited(arguments);
        this.params.id = id;
    },

    constructor: function(params) {                      
        // your constructor here
    }            

});

var widget1 = new Widget({ id: 1, text: 'Hallo 1'});
var widget2 = new Widget({ id: 1, text: 'Hallo 2'}); 
```

**编辑：**我做了一些清理工作，所以你只需要添加`postscript`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T07:31:23.143

你真的需要将 json 属性直接映射到你的小部件吗？如果没有，那么在你的小部件中只有一个 json 属性，并且在实例化时： new myWidget({jsonObj:res}); 那么你可以有一个返回 this.jsonObj.id 的 getJsonId() 函数；

# selenium - 当画布元素在 Selenium 中没有名称或 ID 时，如何自动执行画布对象上的操作？

> ID：10951159
> 
> 赞同：1
> 
> 时间：2012-06-08T14:50:29.870
> 
> 标签：selenium, webdriver, selenium-rc

我有一个用于数字签名的画布对象...我想尝试使用硒自动执行该操作...

我发现，

```
selenium.clickAt("canvas_element_name","co-ordinates"); 
```

可以做得很好...`（坐标如“30, 40”）..但情况是没有给定画布元素的名称...By.xpath 不能与 selenium.clickAt 结合使用.. .

我发现的另一种方法是，

```
driver.findElement(By.xpath("html/body/form/div/canvas")).click();
driver.findElement(By.xpath("html/body/form/div/canvas")).click(); 
```

但是，两者都没有工作......我什至尝试尝试，抓住第二种方法......

请。在线程中找到 HTML 代码，以获取页面中元素的想法...

[https://sqa.stackexchange.com/questions/3253/how-to-automate-the-action-on-a-canvas-object-when-the-canvas-element-has-no-na](https://sqa.stackexchange.com/questions/3253/how-to-automate-the-action-on-a-canvas-object-when-the-canvas-element-has-no-na)

对此有任何建议和解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T00:36:43.213

我在您在另一个问题中发布的源代码中看不到任何`<canvas>`元素。

如果元素隐藏在 a `<frame>`or`<iframe>`元素中，则必须[`driver.switchTo()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.TargetLocator.html)（对于 WebDriver）或[`selenium.selectFrame()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#selectFrame%28java.lang.String%29)（对于 Selenium RC）首先使用框架。

如果它是动态创建的（通过 JS），你必须[等待它](http://seleniumhq.org/docs/04_webdriver_advanced.html#explicit-and-implicit-waits) [变得可用](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#isElementPresent%28java.lang.String%29)。

# javascript - 用特殊字符在Javascript中排序

> ID：10951167
> 
> 赞同：4
> 
> 时间：2012-06-08T14:50:57.793
> 
> 标签：javascript, arrays, sorting

我有一个包含以下值的数组

```
asd sdf dsdf 1sadf *sdf !sdf @asdf _asd .sadf (sadf )sadf #sadf 
^asdf &asdf %asdf -sadf =sadf +sadf -sdf 
```

我想按以下方式在javascript中将它分为三个部分。

1.  以特殊字符开头的单词
2.  从数字开始的单词
3.  从字母开始的单词。

所以这应该是排序数组的序列。

**编辑**：这是我一直在尝试的功能：

```
function naturalSort(a, b) {
   a = a.path.toLowerCase();
   b = b.path.toLowerCase();
   var re = /(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,
  sre = /(^[ ]*|[ ]*|[_]*$)/g,
  dre = /(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,
  hre = /^0x[0-9a-f]+$/i,
  ore = /^0/,
   // convert all to strings and trim()
  x = a.toString().replace(sre, '') || '',
  y = b.toString().replace(sre, '') || '',
   // chunk/tokenize
  xN = x.replace(re, '\0$1\0').replace(/\0$/, '').replace(/^\0/, '').split('\0'),
  yN = y.replace(re, '\0$1\0').replace(/\0$/, '').replace(/^\0/, '').split('\0'),
   // numeric, hex or date detection
  xD = parseInt(x.match(hre)) || (xN.length != 1 && x.match(dre) && Date.parse(x)),
  yD = parseInt(y.match(hre)) || xD && y.match(dre) && Date.parse(y) || null;
   // first try and sort Hex codes or Dates
   if (yD)
    if (xD < yD) return -1;
    else if (xD > yD) return 1;
   // natural sorting through split numeric strings and default strings
   for (var cLoc = 0, numS = Math.max(xN.length, yN.length); cLoc < numS; cLoc++) {
    // find floats not starting with '0', string or 0 if not defined (Clint Priest)
    oFxNcL = !(xN[cLoc] || '').match(ore) && parseFloat(xN[cLoc]) || xN[cLoc] || 0;
    oFyNcL = !(yN[cLoc] || '').match(ore) && parseFloat(yN[cLoc]) || yN[cLoc] || 0;
    // handle numeric vs string comparison - number < string - (Kyle Adams)
    if (isNaN(oFxNcL) !== isNaN(oFyNcL)) return (isNaN(oFxNcL)) ? -1 : 1;
    // rely on string comparison if different types - i.e. '02' < 2 != '02' < '2'
    else if (typeof oFxNcL !== typeof oFyNcL) {
     oFxNcL += '';
     oFyNcL += '';
    }
    if (oFxNcL <= oFyNcL) return -1;
    if (oFxNcL >= oFyNcL) return 1;
   }
   return 0;
  } 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-09T08:48:59.793

老实说，我根本不知道您发布的功能是做什么的。

以下方法使用位置出现来比较字符串的第一个字符。具有相同第一个字符的字符串会定期排序。

顺便说一句，没有测试空字符串。

```
function MySort(alphabet)
{
    return function(a, b) {
        var index_a = alphabet.indexOf(a[0]),
        index_b = alphabet.indexOf(b[0]);

        if (index_a === index_b) {
            // same first character, sort regular
            if (a < b) {
                return -1;
            } else if (a > b) {
                return 1;
            }
            return 0;
        } else {
            return index_a - index_b;
        }
    }
}

var items = ['asd','sdf', 'dsdf', '1sadf', '*sdf', '!sdf', '@asdf', '_asd', '.sadf', '(sadf', ')sadf', '#sadf', '^asdf', '&asdf', '%asdf', '-sadf', '=sadf', '+sadf', '-sdf', 'sef'],
sorter = MySort('*!@_.()#^&%-=+01234567989abcdefghijklmnopqrstuvwxyz');

console.log(items.sort(sorter)); 
```

输出：

```
["*sdf", "!sdf", "@asdf", "_asd", ".sadf", "(sadf", ")sadf", "#sadf", "^asdf", 
 "&asdf", "%asdf", "-sadf", "-sdf", "=sadf", "+sadf", "1sadf", 
 "asd", "dsdf", "sdf", "sef"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-06-07T02:00:02.783

两个简单的解决方案：

**使用 Intl.Collat​​or**

```
myArray.sort(Intl.Collator().compare) 
```

**使用 localeCompare**

```
myArray.sort((a, b) => a.localeCompare(b)) 
```

**Intl.Collat​​or**性能更高

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-31T01:54:51.963

这也可以工作：

```
function sortArray(a, b) {
  const digitRegex = /^\d/;
  const alphabetRegex = /^[a-zA-Z]/;
  const symbolRegex = /^[^\w\s]/;

  const scoreA =  symbolRegex.test(a) * 1 || digitRegex.test(a) * 10 || alphabetRegex.test(a) * 100;
  const scoreB =  symbolRegex.test(b) * 1 || digitRegex.test(b) * 10 || alphabetRegex.test(b) * 100;

  if (scoreA !== scoreB) {
    return scoreA - scoreB;
  }

  if (a < b) {
    return -1;
  } else if (a > b) {
    return 1;
  }

  return 0;
}

const a = ['def', '%rec', '456', '^we', '123', 'abc'].sort(sortArray);

console.log(a);
```

# java - 从下到上创建类实例的 XML 表示？

> ID：10951169
> 
> 赞同：1
> 
> 时间：2012-06-08T14:51:15.060
> 
> 标签：java, xml, dom, creation

我正在考虑以`toString()`类似的方式编写一个方法，以便它返回类实例的 XML 表示。

首先我想把它写成

```
public Element toElement() {
    // create Element instance and fill it
} 
```

但是我无法在`Element`里面创建空实例，因为`Element`创建需要`Document`实例来调用它`createElement()`。

所以我重写了方法

```
public Element toElement(Document doc) {
   Element ans = doc.createElement("myclasstag");

   // filling ans

   return ans;
} 
```

但是后来我得到了运行时异常，因为在实例附加到父层次结构之前`HIERARCHY_REQUEST_ERR`无法填充实例。`Element`

所以我要重写方法如下

```
public Element toElement(Document doc, Element parent) {

   Element ans = doc.createElement("myclasstag");
   parent.appendChild(ans);

   // filling ans

   return ans;
} 
```

但是这样我就不需要返回 ans 因为它已经附加到它应该在的地方，所以它变成了

```
public void append(Document doc, Element parent) {

   Element ans = doc.createElement("myclasstag");
   parent.appendChild(ans);

   // filling ans
} 
```

这是现在绝对不喜欢`toString()`的。

是否可以像这样从下到上创建 XML 实例`toString()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:59:57.847

使用[XStream](http://xstream.codehaus.org/index.html)，我可以这样做：

```
package com.adarshr;

import com.thoughtworks.xstream.XStream;

class Parent {
    private String name;
    private int age;

    public Parent(String name, int age) {
        this.name = name;
        this.age = age;
    }
}

public class Test {
    private Parent parent = new Parent("Abcd", 30);

    public static void main(String[] args) throws Exception {
        System.out.println(new Test());
    }

    @Override
    public String toString() {
        return new XStream().toXML(this);
    }
} 
```

哪个打印：

```
<com.adarshr.Test>
  <parent>
    <name>Abcd</name>
    <age>30</age>
  </parent>
</com.adarshr.Test> 
```

当然，它是完全可定制的。

# actionscript-3 - 在 Flash CS5.5 上调试时如何查看其他类变量？

> ID：10951174
> 
> 赞同：0
> 
> 时间：2012-06-08T14:51:40.703
> 
> 标签：actionscript-3, flash, debugging

我正在尝试调试一个 actionscript 3.0 应用程序，但除了当前代码所在的类之外，我看不到其他类的静态变量。

例如，如果我有这个：

```
public class Main extends Sprite{
     public static var myVar:Number = 12
}
public class theBreakPointReliesOnThisClass {
>>breakpoint<< public function executeALotOfThingsBasedOnExternalVar ():void {
          if(Main.myVar == 12) {
               //stuff to execute
           }
       }
} 
```

如何从调试器访问 Main.myVar？我还想在运行时更改它的值。Flash IDE可以做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:54:15.227

我会推荐你[​​ Monster Debugger](http://demonsterdebugger.com/)，它可以让你在运行时改变变量的值。

# mercurial - 我如何退出退出？

> ID：10951176
> 
> 赞同：0
> 
> 时间：2012-06-08T14:51:43.627
> 
> 标签：mercurial, backout

我最近提交了一大堆我不打算提交的文件，然后退出了。意识到我已经删除了所有更改，我在撤销之前使用“提交的文件”更新了修订版。但我可以将它们作为更改的文件重新提交。

是否有可能退出退出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:54:35.807

如果您安装了[MqExtension](http://mercurial.selenic.com/wiki/MqExtension)，您可以简单地`hg strip`提交您不想要的任何提交，尽管您只有在尚未推送它们时才应该真正这样做。这通常比尝试提交一系列退出以回到您想要的位置更容易和更整洁。

# javascript - Javascript等待函数结束，包括来自node.js的异步MYSQL查询？

> ID：10951181
> 
> 赞同：3
> 
> 时间：2012-06-08T14:51:57.170
> 
> 标签：javascript, node.js

在调用下面的行之前，我遇到了等待函数完成的 Javascript 问题。前面的函数包括[Javascript MYSQL](https://github.com/felixge/node-mysql)查询调用（node.js 的库之一）。然后它看起来像：

```
function first() {
    /**
    * a lot processes to execute
    * including Asynchronous processes
    * like running Queries using Javascript MYSQL Library from node.js
    */
    console.log("I am the first one!");
}

first();
console.log("I am the second one!"); 
```

然后，当我执行此操作时，它的发生如下：

```
I am second one!
I am first one! 
```

我如何通过保持队列顺序使它们运行？

***注意：***现在对于所有混淆问题的人，请再次跳转/关注我新创建的问题：
每个人都请关注/跳转到这个新问题： [Node.js MYSQL to detection the INSERT/UPDATE completeness of a Query?](https://stackoverflow.com/questions/10951916/node-js-mysql-to-detect-the-insert-update-completeness-of-a-query)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:53:53.490

将第二个函数的回调传递给对第一个函数的调用。在第一个函数结束时，调用回调：

```
function one(parm, callback) {
    // do something
    callback();
}
function two() {
    // do something else
}

one("my parm", two); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:56:32.827

您需要构建代码以使用回调

```
function first (callback) {

// do your stuff

callback.call();
}

first(function () { console.log("I am the second"; }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:21:33.120

您遇到的问题在以前用其他语言编程过的人中很常见`JavaScript`，例如`c/java`，您认为`JavaScript`会执行以下操作：

```
 Line of code1\. Execute,when it's done go to the next.
 Line of code2\. Execute,when it's done go to the next.
 Line of code3\. Execute,when it's done go to the next. 
```

JavaScript 中实际发生的情况更像是：

```
 Line of code1\. Execute
 Line of code2\. Execute
 Line of code3\. Execute 
```

为了`JavaScript`按照您的预期工作，您需要以面向事件的方式对其进行编程，这意味着您需要指定要以特定顺序运行的功能。为此，`JavaScript`您需要使用`callbacks`，例如：

```
 function1 (parameter A,function2){
        //...   
        function2(parameter B,function3)} 

 function2 (parameter B,function3){//...} 

 function3 (){//...} 
```

您可以对上面的示例进行更多概括，但是我认为这样保留它更容易理解。您可以在网上找到很多关于此的文章。搜索的第一个结果`google`给了我这个[链接](http://recurial.com/programming/understanding-callback-functions-in-javascript/)。

快乐编码！

# wordpress - thebuggenie 的 .htaccess 配置

> ID：10951200
> 
> 赞同：0
> 
> 时间：2012-06-08T14:53:05.440
> 
> 标签：wordpress, apache

我是apache配置的初学者。我正在尝试安装在 apache 上运行的 buggenie。我已经在 ubuntu 11 上成功安装了 thebuggenie，但是当我启动它时，我遇到了显示问题（没有 CSS，只有 html）和其他登录问题。我想这是由于不正确的 .htaccess 配置。请帮助我指出正确的方向或可能的解决方案。

我的设置是

*   /var/www/wordpress - http://mylocalhost/wordpress - 有效
*   /var/www/thebuggenie-3.1.8/thebuggenie - 不工作

.htaccess 文件的位置 - /var/www/wordpress/.htaccess - /var/www/thebuggenie-3.1.8/thebuggenie/.htaccess

/etc/apache2/apache.conf 包含

```
AccessFileName .htaccess 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:11:05.943

我认为您需要查看错误精灵配置。似乎那是 CSS / IMAGES/ 或 JS 文件不使用良好的基本路径。

# c# - Linq-to-SQL 反向包含

> ID：10951204
> 
> 赞同：1
> 
> 时间：2012-06-08T14:53:35.137
> 
> 标签：c#, linq-to-sql

我将如何在 Linq-to-SQL 查询中反转包含，以便我可以检查是否`Title`或`Description`包含列表中的任何单词，例如：

```
var query = context.Shapes.Where(x => x.Title.Contains(words)); 
```

这是我现在所拥有的，但这与我所需要的相反。

```
 List<string> words = Search.GetTags(q);
 //words = round,circle,square

 using(ShapesDataContext context = new ShapesDataContext())
 {
    var query = context.Shapes.Where(x => words.Contains(x.Title) || 

    words.Contains(x.Description));
 }

// Item 1: Title = Elipse , Decsription = This is not round circle
//This should be a match! but words doesn't contain 
//"This is not round circle", only round and circle so no match 
```

**更新**

我现在有

```
 var query = context.Shapes.Where(x => words.Any(w => x.Title.Contains(w) || x.Description.Contains(w)))
  int s = query.Count(); 
```

但现在我收到异常`int s = query.Count();`消息“本地序列不能在查询运算符的 LINQ to SQL 实现中使用，但包含运算符除外。” 有谁知道如何解决它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T14:56:26.097

你要

```
x => words.Any(w => x.Title.Contains(w) || x.Description.Contains(w)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:43:48.653

不是最有效的，但我做到了：

```
 List<string> words = Search.GetTags(q);
 using(ShapesDataContext context = new ShapesDataContext())
 {
   IQueryable<Shape> query = Enumerable.Empty<Shape>().AsQueryable();
   foreach (var word in words)
   {
     query = query.Union(context.Shapes.Where(x => x.Title.Contains(word) || x.Description.Contains(word)));
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:58:12.783

你在寻找类似 NOT-IN 集合查询的东西吗？

那么这篇博文可能会有所帮助

[http://introducinglinq.com/blogs/marcorusso/archive/2008/01/14/the-not-in-clause-in-linq-to-sql.aspx](http://introducinglinq.com/blogs/marcorusso/archive/2008/01/14/the-not-in-clause-in-linq-to-sql.aspx)

高温高压

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-01T19:49:46.480

我的解决方案是使用子查询（子选择）

```
 dim searchTerms as new list of(string) 'search terms here

  dim Result = (From x In DB.items Where 
                    (
                      searchTerms.Count = 0 Or
                      (From z In searchTerms Where x.SearchableText.Contains(z) Select z).Count > 0
                    )
                    Select x).ToList() 
```

# mysql - 用一个查询插入大量列

> ID：10951205
> 
> 赞同：0
> 
> 时间：2012-06-08T14:53:45.137
> 
> 标签：mysql, insert, upsert

我正在尝试在我的测试服务器上执行以下代码：

```
Insert into CURRENT values (2, 962, 123.45, 30, 0, '2012-06-08 10:41:23', 100, 80, 
  'Rainy', 120, 50, '2012-06-08 10:14:27', 19300.10, 150.27, 30000, null, 1, 0) 
  ON DUPLICATE KEY UPDATE (WEIGHT, TWEIGHT, OVERRIDE, WEATHER_TS, TEMP, HUMIDITY, 
CONDITIONS, T_HIGH, T_LOW, TRAVELTIME, LOAD, PRICE, AVAILABLE, FREQUENCY, ACTIVE, DIS); 
```

值`2`和`962`是外键，'2' 是主键 (ID)。

我一直收到`(`之前重量的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:58:50.603

根据[MySQL 手册](http://dev.mysql.com/doc/refman/5.1/en/insert.html)，您做得不太对。在该`UPDATE`部分中，您需要将其视为常规更新查询。所以它看起来像：

```
ON DUPLICATE KEY UPDATE WEIGHT=2, TWEIGHT=962... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T14:58:01.680

像这样使用它

```
Insert into CURRENT 
values (2, 962, ...) 
ON DUPLICATE KEY UPDATE WEIGHT = 2, TWEIGHT = 962, ... 
```

# python - 类特殊方法行为 __complex__

> ID：10951211
> 
> 赞同：0
> 
> 时间：2012-06-08T14:54:01.360
> 
> 标签：python

我有一个定义`__complex__`特殊方法的类。我的类不是标准数字类型（int、float 等），但它的行为类似于我为 、 等定义的特殊`__add__`方法`__sub__`。

我想`__complex__`返回我的复数值对象，而不是 python 期望的标准复数值。因此，当我尝试返回我的对象​​而不是标准复数时，Python 会引发以下错误。

> TypeError: *: 'complex' 和 'MyNumericClass' 的不支持的操作数类型

最好的方法是什么？

* * *

编辑：

```
# Python builtins
import copy
# Numeric python
import numpy as np

class MyNumericClass (object):
    """ My numeric class, with one single attribute """
    def __init__(self, value):
        self._value = value

    def __complex__(self):
        """ Return complex value """
        # This looks silly, but my actual class has many attributes other
        # than this one value.
        self._value = complex(self._value)
        return self

def zeros(shape):
    """
    Create an array of zeros of my numeric class

    Keyword arguments:
      shape -- Shape of desired array
    """
    try:
        iter(shape)
    except TypeError, te:
        shape = [shape]
    zero = MyNumericClass(0.)
    return fill(shape, zero)

def fill(shape, value):
    """
    Fill an array of specified type with a constant value

    Keyword arguments:
      shape -- Shape of desired array
      value -- Object to initialize the array with
    """
    try:
        iter(shape)
    except TypeError, te:
        shape = [shape]
    result = value
    for i in reversed(shape):
        result = [copy.deepcopy(result) for j in range(i)]
    return np.array(result)

if __name__ == '__main__':
    a_cplx = np.zeros(3).astype(complex)
    print a_cplx
    b_cplx = zeros(3).astype(complex)
    print b_cplx 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:00:10.090

几个选项：

1.  定义`__rmul__`（或定义`__mul__`和翻转乘法操作数）。
2.  在乘法之前将您的`MyNumericClass`实例转换为。`complex`

# html - 从 C# 中的 XML 节点中提取 HTML 表

> ID：10951213
> 
> 赞同：0
> 
> 时间：2012-06-08T14:54:05.513
> 
> 标签：html, xml, html-table, extract, html-agility-pack

我在 XML 节点中有以下 HTML：

```
<table cellpadding="5"><tr><td><strong>Date </strong></td><td><strong>Event</strong>
</td><td><strong>Pro</strong></td><td><strong>Act</strong></td><td>
<strong>Prev</strong></td></tr><tr><td>Jun 8 12:30</td><td>Announcement</td><td>0.300  
%</td><td>0.100  %</td><td>0.700  %</td></tr></table><br />

<h2>News</h2><ul><li><a href="http://www.link1.com">News Text</a> Source <br/>Fri, Jun 8 
2012, 12:34 GMT</li></ul><br /><div class="class1">
<a href="http://link2.com"><img src="http://link3.com" border="0"></img></a> 
```

我需要能够抓住桌子。不幸的是，所有这些都在一个 XML 节点中，所以我不能再使用 doc.SelectSingleNode 了。我将解析我得到的数据，但由于后半部分元素不断变化，我必须能够将它作为变量而不是静态字符串传递给 XElement.Parse。

我正在使用 HtmlAgilityPack。如果有人只知道如何提取表格，我将非常感谢正确方向的一点，因为我完全被卡住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:40:39.680

```
Match match = Regex.Match(descr.ToString(), @"<table\s*(.+?)\s*</table>"); 
```

我拒绝告诉你我做错了什么:)

# css - CSS - 使用 :hover 方法与图像混淆

> ID：10951221
> 
> 赞同：1
> 
> 时间：2012-06-08T14:54:21.717
> 
> 标签：css, hover, image

在 CSS 中使用 :hover 方法时，我对正确的做法感到困惑。在此示例中，我有一张照片，在悬停时会更改为另一张照片。据我了解，有两种选择，尽管我不清楚如何完成，哪一种是最佳选择。

**选项1：**

我的 HTML 中有两张图片。在这个例子中，我是否应该将它们定位在完全相同的位置，然后在悬停时隐藏一个？

[http://jsfiddle.net/C5bKZ/4/](http://jsfiddle.net/C5bKZ/4/)

**选项 2：**

我在我的 HTML 中创建了一个空 div，并使用 CSS 添加背景图像，然后在悬停时让新的背景图像浮动。

[http://jsfiddle.net/C5bKZ/9/](http://jsfiddle.net/C5bKZ/9/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T14:59:57.347

您可以通过多种方式完成此操作：

1.  滑动背景：您可以将单个图像（并排有两个图像）作为背景，并在父元素悬停时简单地重新定位它。

2.  绝对定位这两个图像，一个在另一个之上，并在鼠标悬停时隐藏最上面的一个，从而显示第二个。

3.  将两个图像并排放置在父级中，将溢出设置为 hitten（隐藏第二个图像）。当用户将鼠标悬停在父级上时，隐藏第一个，这会将第二个移动到视图中。

对于您发布的第一个示例，您可以添加以下 CSS：

```
.image {
    width:    180px;
    height:   270px;
    overflow: hidden;
}

.image:hover :first-child {
    display:  none;
} 
```

小提琴：http: [//jsfiddle.net/jonathansampson/C5bKZ/10/](http://jsfiddle.net/jonathansampson/C5bKZ/10/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T14:59:22.357

您的选择都是可行的，但就最佳性能而言，如果可能的话，我会这样做：

1.  制作一张图像，其中包含两个图像，一个在另一个之上。
2.  使用仅具有一个图像尺寸的容器元素。（即这个新图像的一半高度）
3.  然后在`:hover`更改`background-position`

这种技术称为精灵/精灵。

好处是：

*   你只有一张图片
*   浏览器只需要发出 1 个 http 请求
*   鼠标悬停和下一个图像加载之间没有延迟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:00:20.073

实现选项 1 的简单方法如下：

```
<a href="#" class="myLink"><img src="img1.jpg" class="img_on" /><img src="img2.jpg" class="img_off" /></a> 
```

那么CSS看起来像这样：

```
.img_off, .myLink:hover .img_on{display:none;}
.myLink:hover .img_off{display:block;} 
```

对于第二个选项，问题是在第一次悬停时，由于图像尚未加载，总会有轻微的闪烁。

我还发现第一个选项更容易维护。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:00:22.307

您可以通过添加像这样的悬停选择器和最初隐藏项目的类来使其更易于管理：

**HTML**

```
<div class="image">
    <img src="http://teamcoding.ca/leisure/wp-content/uploads/2012/06/373036_320675657996371_1880708219_n.jpeg"   id="image1"/>
    <img class="hover" src="http://teamcoding.ca/leisure/wp-content/uploads/2012/06/373040_295769990493061_127804360_n.jpeg"/>
</div> 
```

**​CSS**

 **```
.image { display: inline; }
.image img.hover { display:none; }
.image:hover img { display:none; }
.image:hover img.hover { display:inline; }
​ 
```

[http://jsfiddle.net/hunter/ZHNDU/](http://jsfiddle.net/hunter/ZHNDU/)**

# java - 使用 SimpleXML 的 XML 声明标记

> ID：10951223
> 
> 赞同：16
> 
> 时间：2012-06-08T14:54:36.677
> 
> 标签：java, xml

我开始使用带有 Java 注释（[链接](http://simple.sourceforge.net/download/stream/doc/tutorial/tutorial.php#namesoace)）的简单 XML 框架，但我不明白如何`<?xml version="1.0" encoding="UTF-8" ?>`在 XML 文件中预先设置 XML 声明标记。所以我的问题是：如何将 XML 声明作为第一个标签？

```
package simplexml;

import org.simpleframework.xml.Attribute;
import org.simpleframework.xml.Element;
import org.simpleframework.xml.Root;

@Root
public class Example {

    @Element
    private String text;

    @Attribute
    private int index;

    public Example(String text, int index) {
        this.text = text;
        this.index = index;
    }

    public String getMessage() {
        return text;
    }

    public int getId() {
        return index;
    }
} 
```

测试：

```
public static void main(String[] args) {
        Serializer serializer = new Persister();
        Example example = new Example("Example message", 123);
        File result = new File("example.xml");

        try {
            serializer.write(example, result);
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

产生：

```
<example index="123">
   <text>Example message</text>
</example> 
```

我想拥有的：

```
<?xml version="1.0" encoding="UTF-8" ?>
<example index="123">
   <text>Example message</text>
</example> 
```

谢谢！另外，我在哪里可以查到这些东西？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-13T20:15:56.940

我使用 Spring for Android 发送 XML 请求，并面临同样的问题。这是基于@implicit_knowledge 的解决方案使其工作的代码，以防万一有人需要它。

```
RestTemplate restTemplate = new RestTemplate();             
restTemplate.getMessageConverters().add(new StringHttpMessageConverter());              
Serializer serializer = new Persister(new Format("<?xml version=\"1.0\" encoding= \"UTF-8\" ?>"));
restTemplate.getMessageConverters().add(new SimpleXmlHttpMessageConverter(serializer));
restTemplate.postForObject(URL, udata, String.class); 
```

# assembly - 无法编译 fasm 文件

> ID：10951230
> 
> 赞同：0
> 
> 时间：2012-06-08T14:54:48.323
> 
> 标签：assembly, fasm

我正在尝试编译 asm-xml。但我收到以下错误：

```
error: illegal instruction. 
```

受影响的线路是：

```
section '.asmdata' writeable 
```

任何人都可以帮我解决这个问题吗？

先感谢您，

问候 F

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T13:49:42.097

您正在编译错误的文件。您应该编译与您的平台相对应的程序集文件**elf.asm**或**win32.asm**。*asm-xml.asm*本身并不是一个完整的汇编程序。

# css - 使用百分比浮动的儿童不会在 Chrome 中填充 100% 的容器

> ID：10951233
> 
> 赞同：2
> 
> 时间：2012-06-08T14:54:57.817
> 
> 标签：css, google-chrome, layout, webkit, css-float

我想不通这个。

它似乎在 IE8+ 和 Firefox 中工作，但 Chrome 显示它“错误”（也许它是正确的，谁知道）：

![](../Images/f57fbc5cec43835b0b56d52885fa4d7f.png)

我正在使用 Bootstrap，所以我不确定这是否会影响任何事情。

[http://jsfiddle.net/kamranayub/zVbHz/3/](http://jsfiddle.net/kamranayub/zVbHz/3/)

出于我的目的，条形需要是流动的，因此像素宽度不起作用。我不确定 IE/Firefox 是否掩盖了问题以及 Chrome 是否对我诚实。

如果您无法弄清楚，对于一组流畅的进度条还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:44:14.147

我看到了你的问题。我想它以相同的方式四舍五入所有百分比，因此当您将它们彼此相邻浮动时，总宽度会发生明显变化。

为了将其保持在最大 1px 的总误差，我会确保所有右边缘都是从主容器定义的，最后一个接触右边缘，而不是依靠浏览器来补偿舍入误差。看一下这个：

[http://jsfiddle.net/9nZYt/1/](http://jsfiddle.net/9nZYt/1/)

```
.progress {
    position:relative;
    border: 1px solid black;
    box-sizing: border-box;
}
.progress .bar {
    position:absolute;
    left:0;
    border-right: 1px solid white;
}
.progress .bar:first-child {
    border-right:none;
}

.progress .bar.bar-remaining {
    filter: none;
    background: red;
} 
```

和

```
<div class="progress">
    <div class="bar bar-remaining" style="width: 100%"></div>
    <div class="bar bar-remaining" style="width: 75%"></div>
    <div class="bar" style="width: 50%"></div>
    <div class="bar" style="width: 25%"></div>
</div> 
```

[您可以使用 CSS 的nth-child](http://duckduckgo.com/?q=nth-child)选择器而不是硬编码宽度或标记中的特殊类来定位单个 div 。

但在我看来它仍然有点难看，你必须玩一点才能让你的圆角重新看起来正确。

[在HTML5 Canvas](http://dev.opera.com/articles/view/html-5-canvas-the-basics/)上绘制它并使用这个基于 html 的版本作为后备怎么样？

**编辑**：我对引导程序一无所知，但希望这仍然适用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:48:49.060

你的问题是因为你的进度条的大小。它的宽度是`514px`5`div`秒，里面有 20% 的宽度。所以每个内部`div`s 的宽度是`514px/5 = 102.80px`并且它只是省略了小数值。尝试给出进度条的宽度`515px`并删除红色框的右边距。

编辑1：你需要尽量保持进度条的宽度是`div`里面s个数的乘积。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-08T15:31:19.093

Set the padding and margins to zero. That should fix the gap you are seeing.

# python - 将列表转换为 numpy 数组时的 dtype 用法

> ID：10951234
> 
> 赞同：0
> 
> 时间：2012-06-08T14:55:03.280
> 
> 标签：python, arrays, numpy

`dtype`创建 numpy 数组时，我很困惑。我正在从花车列表中创建它们。首先让我注意这不是打印问题，因为我已经这样做了：`np.set_printoptions(precision=18)`.

这是我的清单的一部分：

```
In [37]: boundary
Out[37]: 
[['3366307.654296875', '5814192.595703125'],
 ['3366372.2244873046875', '5814350.752685546875'],
 ['3366593.37969970703125', '5814844.73492431640625'],
 ['3367585.4779052734375', '5814429.293701171875'],
 ['3367680.55389404296875', '5814346.618896484375'],
 ....
 [ 3366307.654296875     ,  5814192.595703125     ]] 
```

然后我将它转换为一个 numpy 数组：

```
In [43]: boundary2=np.asarray(boundary, dtype=float)   
In [44]: boundary2
Out[44]: 
array([[ 3366307.654296875     ,  5814192.595703125     ],
       [ 3366372.2244873046875 ,  5814350.752685546875  ],
       [ 3366593.37969970703125,  5814844.73492431640625],
        ....
       [ 3366307.654296875     ,  5814192.595703125     ]])
# the full number of significant digits is preserved. 
# this also works with:
In [45]: boundary2=np.array(boundary, dtype=float)

In [46]: boundary2
Out[46]: 
array([[ 3366307.654296875     ,  5814192.595703125     ],
     [ 3366372.2244873046875 ,  5814350.752685546875  ],
     [ 3366593.37969970703125,  5814844.73492431640625],
     ...
     [ 3366307.654296875     ,  5814192.595703125     ]])

# This also works with dtype=np.float
In [56]: boundary3=np.array(boundary, dtype=np.float)
In [57]: boundary3
Out[57]: 
array([[ 3366307.654296875     ,  5814192.595703125     ],
       [ 3366372.2244873046875 ,  5814350.752685546875  ],
       [ 3366593.37969970703125,  5814844.73492431640625],
       ....
       [ 3366307.654296875     ,  5814192.595703125     ]]) 
```

这就是我感到困惑的原因，如果我使用`dtype=np.float32`它**似乎**丢失了有效数字：

```
In [58]: boundary4=np.array(boundary, dtype=np.float32)   
In [59]: boundary4
Out[59]: 
array([[ 3366307.75,  5814192.5 ],
       [ 3366372.25,  5814351\.  ],
       [ 3366593.5 ,  5814844.5 ],
       [ 3367585.5 ,  5814429.5 ],
       ...
       [ 3366307.75,  5814192.5 ]], dtype=float32) 
```

我之所以说它**似乎**是因为显然数组是相同的。我无法直接查看数据，但检查`np.allclose`返回 True：

```
In [65]: np.allclose(boundary2, boundary4)
Out[65]: True 
```

所以，如果你读到这里，我希望你明白我为什么感到困惑，也许有人可以回答以下两个问题：

1.  为什么要`dtype=float32`“隐藏”我的数据？
2.  我应该担心它还是可以安全地继续使用`dtype=float`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:03:26.020

所有浮点类型都具有有限的精度。它们可以存储的有效位数取决于浮点类型中的位数。如果您提供或as `float`，则使用 64 位（“双精度”），产生大约 16 个有效十进制数字。对于，使用 32 位（“单精度”），产生大约 8 个有效十进制数字。所以没有什么是“隐藏的”，你只是看到有限浮点精度的影响。 返回，因为所有值都接近您选择的浮点类型的限制。`numpy.float``numpy.float64``dtype``numpy.float32``numpy.allclose()``True`

# java - FileChannel 不断写代码问题

> ID：10951238
> 
> 赞同：0
> 
> 时间：2012-06-08T14:55:26.137
> 
> 标签：java

我有以下代码，在**j for 循环**中**out.write()**仅写入**j == 0**，然后 bytesThisWritten 为0。

```
 boolean append = true;
    FileChannel out = new FileOutputStream(dirToSave + fileName, append).getChannel();
    ByteBuffer dataBuffer = ByteBuffer.allocate(ScanDataStructConstants.NUM_DETECTORS * 4);
                dataBuffer.order(ByteOrder.LITTLE_ENDIAN);
                FloatBuffer floatBuffer = dataBuffer.asFloatBuffer();
                long bytesThisWritten = 0;
                for(int i = 0; i < ScanDataStructConstants.NUM_VIEWS_PER_ROTATION; i++)
                {
                    if(!taskWorker.isCancelled())
                    {
                        taskWorker.setTaskProgress(i); 
                        //write auxHeader
                        AuxHeader auxHeader = auxHeaderArray.getOneAuxHeader(i);                    
                        byteWritten = byteWritten + out.write(auxHeader.getJavoAuxHeader().getCmdByteBuffer()); 
                        System.out.println("DataMgr write auxHeader i=" + i + ", byteWritten=" + byteWritten);

                        //write data                               
                        for(int j = 0; j < ScanDataStructConstants.NUM_ROWS; j++)
                        {                           
                            if(!taskWorker.isCancelled())
                            {
                                float[] oneRow = scanDataArray.getOneRowDataFromAView(i, j);                           
                                floatBuffer.rewind();
                                floatBuffer.put(oneRow);
                                bytesThisWritten = out.write(dataBuffer);
                                byteWritten = byteWritten + bytesThisWritten;
                                if(i == 0)
                                {
                                    System.out.println("DataMgr write data i,j=" + i + "," + j + 
                                            ", bytesThisWritten=" + bytesThisWritten + 
                                            ", byteWritten=" + byteWritten + 
                                            " oneRow.size=" + oneRow.length + 
                                            ", oneRow[0]" + oneRow[0]);
                                }
                            }
                            else
                            {
                                status = ReturnStatusEnum.CANCELED_FAILURE;
                                break;
                            }
                        }
                    }
                    else
                    {
                        status = ReturnStatusEnum.CANCELED_FAILURE;
                        break;
                    }
                } 
```

对于打印输出，我知道源数据不为空：

```
DataMgr write auxHeader i=0, byteWritten=4256
DataMgr write data i,j=0,0, bytesThisWritten=3584, byteWritten=7840 oneRow.size=896, oneRow[0]-0.012269974
DataMgr write data i,j=0,1, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.012150764
DataMgr write data i,j=0,2, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.0056562424
DataMgr write data i,j=0,3, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.006008148
DataMgr write data i,j=0,4, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.0064029694
DataMgr write data i,j=0,5, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.010842323
DataMgr write data i,j=0,6, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.01802063
DataMgr write data i,j=0,7, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.0023899078
DataMgr write data i,j=0,8, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.0068216324
DataMgr write data i,j=0,9, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.005973816
DataMgr write data i,j=0,10, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.012469292
DataMgr write data i,j=0,11, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.013271332
DataMgr write data i,j=0,12, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]6.542206E-4
DataMgr write data i,j=0,13, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.008749008
DataMgr write data i,j=0,14, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.012054443
DataMgr write data i,j=0,15, bytesThisWritten=0, byteWritten=7840 oneRow.size=896, oneRow[0]-0.008696556 
```

在**i for 循环**中它似乎有效，但仅在**j 循环**中它只写一次。FileChannel 处于附加模式，并且通道未在**i loop**中关闭。我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:59:37.200

将**j 循环**更改为以下将解决此问题。似乎 FloatBuffer 有一些特殊的属性。

```
for(int j = 0; j < ScanDataStructConstants.NUM_ROWS; j++)
                    {                           
                        if(!taskWorker.isCancelled())
                        {
                            float[] oneRow = scanDataArray.getOneRowDataFromAView(i, j);                              
                            dataBuffer.rewind();
                            FloatBuffer floatBuffer = dataBuffer.asFloatBuffer();
                            floatBuffer.put(oneRow);
                            bytesThisWritten = out.write(dataBuffer);
                            bytesWritten = bytesWritten + bytesThisWritten;
                            if(i == 0)
                            {
                                System.out.println("DataMgr write data i,j=" + i + "," + j + 
                                        ", bytesThisWritten=" + bytesThisWritten + 
                                        ", byteWritten=" + bytesWritten + 
                                        " oneRow.size=" + oneRow.length + 
                                        ", oneRow[0]" + oneRow[0]);
                            }                               
                        }
                        else
                        {
                            status = ReturnStatusEnum.CANCELED_FAILURE;
                            break;
                        }
                    }
                } 
```

# php - php 5.2.17 看不到 FreeType 从 2.2.1 升级到 2.4.9

> ID：10951241
> 
> 赞同：0
> 
> 时间：2012-06-08T14:55:47.320
> 
> 标签：php, upgrade, redhat, freetype

我正在尝试将 freetype 安装从 2.2.1 升级到 2.4.9。我已经在其他三台服务器上完成了此操作，并且升级顺利，但是其中一台，php 只是看不到新的 freetype。以下是我使用的步骤：

安装 Freetype: ./configure make && make install

重新编译php-5.2.17：./configure --prefix=/usr/local\--sysconfdir=/etc\--localstatedir=/var\--with-openssl=/usr\--with-curl=/usr /local/lib \ --enable-sockets \ --enable-track-vars \ --with-oci8=/opt/oracle/product/11.1.0.6/ \ --with-zlib=yes \ --with-apxs2 =/usr/local/apache2/bin/apxs\--enable-sigchild\--with-java=/usr/java/jdk1.6.0_21\--with-gd\--with-freetype-dir=/usr /include/freetype2 \ --enable-gd-native-ttf \ --with-ldap

此后，freetype-config --ftversion 报告 2.4.9，但 php -i 显示 2.2.1。我怀疑问题出在 freetype 目录上，但这似乎是正确的。有人有想法么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T18:35:52.050

我解决了。freetype 使用的默认前缀路径应该用于 --with-freetype-dir。默认情况下，freetype 使用 --prefix=/usr/local，因此使用该路径重建 php 解决了我的问题，并且 php -i 显示正确的 freetype 版本 2.4.9。

# ios - Facebook Graph API批量请求使用iOS的朋友的个人资料图片？

> ID：10951247
> 
> 赞同：1
> 
> 时间：2012-06-08T14:56:01.113
> 
> 标签：ios, facebook, facebook-graph-api, profile, image

寻找一种方法来获取用户所有朋友的个人资料图片 URL。我知道获取每个用户 ID 并“滚动”每个 ID 的方法（https://www.graph.facebook.com/3422098/picture），但是这会不必要地占用大量时间。

我正在尝试弄清楚如何使用批处理请求（http://developers.facebook.com/blog/post/2011/03/17/batch-requests-in-graph-api/）并获得所有一口气的URL，不幸的是我无法弄清楚。

我可以得到一个朋友列表..

```
NSString *jsonRequest1 = @"{ \"method\": \"GET\", \"relative_url\": \"me/friends\" }";
NSString *jsonRequestsArray = [NSString stringWithFormat:@"[%@]", jsonRequest1];
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObject:jsonRequestsArray forKey:@"batch"];
[facebook requestWithGraphPath:@"me" andParams:params andHttpMethod:@"POST" andDelegate:self]; 
```

共同的朋友..

NSString *jsonRequest1 = @"{ \"method\": \"GET\", \"relative_url\": \"me/mutualfriends/61309973?limit=20\" }"; NSString *jsonRequestsArray = [NSString stringWithFormat:@"[%@]", jsonRequest1]; NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObject:jsonRequestsArray forKey:@"batch"]; [facebook requestWithGraphPath:@"me" andParams:params andHttpMethod:@"POST" andDelegate:self];

但我不知道如何获取个人资料图片。

感谢你们提供的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:23:55.653

对于所有朋友要求`/me/friends?fields=name,picture`

对于共同的朋友，要求`/me/mutualfriends/[OTHER ID]/?fields=name,picture`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:25:50.497

> 我正在尝试弄清楚如何使用批处理请求 [...] 来执行此操作并一次性获取所有 URL，不幸的是我无法弄清楚。

你想得到*实际*的图像吗？

Graph API 不返回图像数据，无论是否批处理。它只返回图像 URL。

如果您不想处理通常的 /userid/picture URL 返回的重定向，那么您可以查询名为“个人资料图片”的相册的用户相册连接，并获取该相册的照片 - 这为您提供了实际的据我所知，没有重定向的 URL。但这需要获得用户的明确许可才能阅读他们的照片……</p>

# delphi - Delphi minmax HashTable 调试 - 关闭

> ID：10951248
> 
> 赞同：-1
> 
> 时间：2012-06-08T14:56:05.693
> 
> 标签：delphi, hashtable, minmax, reversi

解决了，stuid bug

```
function Tform1.Boardtostr(const aboard:Tboard):string; 
var a,b:integer; 
begin 
  result:=''; 
  for a:= 1 to 8 do 
  begin 
    for b:=1 to 8 do 
    begin 
      if board[b][a] = -1 then //<--should be aboard instead of board
        result:=result+'0' 
      else if board[b][a] = 0 then//<--should be aboard instead of board
        result:=result+'1' 
      else if board[b][a] = 1 then //<--should be aboard instead of board
        result:=result+'2'; 
    end; 
  end; 
 end; 
```

====================================

我是 Sum GNU Anti Reversi 作者。我想为我的 Delphi 程序添加哈希表。我使用的是 Delphi 2010。我在 minmax 函数中添加了哈希表。我不知道那台计算机给出了错误的分数。请帮助我谢谢。原创节目

[http://sourceforge.net/projects/antireversi8x8/files/Delphi_v0.6c3_Eng/SumAntiReversi8x8v0.6c3src.zip/download](http://sourceforge.net/projects/antireversi8x8/files/Delphi_v0.6c3_Eng/SumAntiReversi8x8v0.6c3src.zip/download)

哈希表版本：

[https://sourceforge.net/projects/antireversi8x8/files/Debug-Will%20delete/debuging.zip/download](https://sourceforge.net/projects/antireversi8x8/files/Debug-Will%20delete/debuging.zip/download)

修改部分：

```
 aHashTable :TStringHash;
  aHashTable :=TStringHash.Create;

 function TForm1.AI(Aboard:Tboard;ComputerIsRed:Boolean):string; 
 ....
 //   if (a + b < 46) and  (c > 4) and (Realdepth > 5) then
 //   a:=minMaxStart(Aboard,ComputerIsRed,Realdepth,thinkstep)
 // else
 //    a:=minMaxRandom(Aboard,ComputerIsRed,Realdepth,thinkstep);
 a:=minMaxRandom(Aboard,ComputerIsRed,Realdepth,thinkstep);//<-To test hash table
 ...
 function TForm1.MinMaxRandom(Aboard:Tboard;SideIsRed:Boolean;depth:integer;var aithinkstep:string):integer; 

var a,b,c,d,bestvalue,   value:integer;templist:tstringlist;tempboard:Tboard;oldaithinkstep:string;aithinksteplist:Tstringlist; 
begin 
aHashTable.clear; 
Application.ProcessMessages; 
Score(Aboard,a,b);
if a = 0 then
begin
if SideIsRed then
  result:= 2000
else
  result:= -2000; 
exit; 
end; 
if b = 0 then 
begin 
if SideIsRed then
  result:= -2000
else
  result:= 2000;
exit;
end; 
if (depth<=0) or (a+b>63) then 
begin 
    result:= EvaluateScore(Aboard,SideIsRed);  
exit; 
end;
templist := Tstringlist.Create; 
bestvalue:=-INF
if SideIsRed Then
MakeRedMove(Aboard,templist)
else
MakeBlackMove(Aboard,templist);
  if templist.Count = 0 then 
begin 
if SideIsRed Then
  MakeBlackMove(Aboard,templist)
else
  MakeRedMove(Aboard,templist);

if templist.Count = 0 then // both red and black no move
begin
  templist.Free;
    result:= EvaluateScore(Aboard,SideIsRed);
  exit;
end;
result := -MinMax(Aboard,Not SideIsRed,depth,aithinkstep);//);

templist.Free; 
exit; 
end;
...
end;

function TForm1.MinMax(Aboard:Tboard;SideIsRed:Boolean;depth:integer;var aithinkstep:string):integer; 
 var a,b,c,d,bestvalue, value:integer;templist:tstringlist;tempboard:Tboard;oldaithinkstep,bestaithinkstep:string; 
 Application.ProcessMessages; 
 bestaithinkstep:=aithinkstep; 
  Score(Aboard,a,b); 
  if a = 0 then 
  begin 
  if SideIsRed then
    result:= 2000 
  else
   result:= -2000;
exit;
end;
if b = 0 then
begin
  if SideIsRed then
    result:= -2000
 else
   result:= 2000;
 exit;
end;
if (depth<=0) or (a+b>63) or StopThink then
begin
  result:= EvaluateScore(Aboard,SideIsRed);
exit;
end; 
templist := Tstringlist.Create; 
bestvalue:=-INF;
if SideIsRed Then 
  MakeRedMove(Aboard,templist) 
else
  MakeBlackMove(Aboard,templist); 
if templist.Count = 0 then
begin
  if SideIsRed Then
   MakeBlackMove(Aboard,templist)
  else
    MakeRedMove(Aboard,templist);
  if templist.Count = 0 then // both red and black no move
  begin
    templist.Free;
    result:= EvaluateScore(Aboard,SideIsRed);
   exit;
 end;
 aithinkstep := aithinkstep +'->PASS'; 
 result := -MinMax(Aboard,Not SideIsRed,depth,aithinkstep); 
 templist.Free; 
 exit; 
end;
tempboard:=Aboard;
oldaithinkstep :=aithinkstep;
if aHashTable.ValueOf(boardtostr(aboard)+Booltostr(SideIsRed)+inttostr(depth)) = -1 then //Hash test 
begin
For a:= 0 to templist.Count-1 do 
begin 
  Application.ProcessMessages; 
aithinkstep := oldaithinkstep; 
  d:= strtoint(templist[a]); 
  b:= d div 8 +1 ; 
  c:= d mod 8; 
  if c = 0 then 
   begin 
  b:=b-1; 
  c:=8; 
   end; 
 aithinkstep := aithinkstep+'->'+intTostr(c)+','+intTostr(b); 
 Aboard:=tempboard; 
 if SideIsRed Then
 RedboardUpdate(Aboard,strToint(templist[a]))
  else
  BlackboardUpdate(aboard,strToint(templist[a]));
  value:= -MinMax(Aboard,Not SideIsRed,depth-1,aithinkstep);

  if value > bestvalue then
  begin
    bestvalue:=value;
    bestaithinkstep := aithinkstep;
  end;
end;
  aHashTable.Add(boardtostr(tempboard)+Booltostr(SideIsRed)+inttostr(depth),bestvalue);
end
else
  BestValue:= aHashTable.ValueOf(boardtostr(aboard)+Booltostr(SideIsRed)+inttostr(depth)); 
templist.Free; 
aithinkstep :=bestaithinkstep; 
Result:= bestvalue; 
end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:38:16.797

我没有时间下载/检查您的代码，但是如果我对您的理解正确，您正试图通过将已评估的位置存储在哈希表中来加速最小极大搜索，然后首先查看您是否已经拥有对该职位的评估。

如果是这种情况，调试此类问题的方法是拥有一个兼具两者的版本，即进行哈希表存​​储/查找以及完整评估，然后在每个阶段比较结果。这样，当两个结果不同时，您应该能够立即看到，这应该让您了解问题所在。

# javascript - 更改 jqPlot 上的单个刻度线

> ID：10951250
> 
> 赞同：1
> 
> 时间：2012-06-08T14:56:06.413
> 
> 标签：javascript, jqplot

当在 中绘制一些东西时`jqPlot`，总是有一个负数（即使数据从不是负数），这很好，因为它使图表有更多的填充并且更容易看到。

无论如何，我的问题是当数据的数字非常低时，`jqPlot`例如将负刻度标记显示为 -.2。是否可以将其设置为偶数，例如 -.5？

基本上，**我只想手动将刻度数更改为所需的值。这可能吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T20:56:40.637

您可以使用轴上刻度的最小值和最大值。这是代码：

```
var plot = $.jqplot('graph', [dataSet], {
    // ...
    axes : {
        xaxis : {
            min : 'X',
            max : 'X',
            // ...
        },
        yaxis : {
            min : 'X',
            max : 'X',
            // ...
        }
    },
    // ...
}); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-10T21:47:30.107

如果它涉及手动更改刻度和设置其他选项，例如，正如@maliayas 建议使用 min/max 玩的那样，并不能帮助您始终使用`jQuery`.

有关如何[使用 jQuery 手动更改刻度的示例，请参阅此示例。](http://jsfiddle.net/Boro/AqKZz/)

# sum - 使用 SlickGrid 聚合/列的总和

> ID：10951253
> 
> 赞同：5
> 
> 时间：2012-06-08T14:56:19.613
> 
> 标签：sum, slickgrid, aggregation, aggregator

我只是想对一列求和并在表格底部显示总数。从查看示例看来，使用聚合器似乎是做到这一点的最佳方式。但是，当我简单地添加

`dataView.setAggregators([ new Slick.Data.Aggregators.Sum("value") ], false);`

什么都没发生。我已经尝试了几个小时，只是为了让一个基于分组示例的简单聚合器工作，但是分组示例太复杂了，我无法准确说出我需要什么。

编辑：替代修复：对于其他人来说，我最终没有使用聚合器。这些数据以 Javascript 形式提供，这使生活变得更加轻松。可以从那里计算总数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T14:10:07.190

首先请注意，仅显示小计（您拥有的组的小计）的总作品，我不相信总计尚未实施......尽管如果您确实想要每个小计组，您必须定义 3 个代码区域，而不仅仅是 1 个

首先，您像以前一样声明聚合器

```
dataView.setAggregators([ new Slick.Data.Aggregators.Sum("value") ], false); 
```

第二，您还需要将它（要显示的功能）附加到您的列中`groupTotalsFormatter`

```
var columns = [
  ...
  {id: "cost", name: "Cost", field: "cost", width: 90, sortable: true, groupTotalsFormatter: sumTotalsFormatter}
]; 
```

最后定义函数来显示它并用你想要显示的内容对其进行编码

```
function sumTotalsFormatter(totals, columnDef) {
  var val = totals.sum && totals.sum[columnDef.field];
  if (val != null) {
    return "total: " + val;
  }
  return "";
} 
```

如果您缺少这些行中的任何一行，您将看不到任何显示，这是正常的

# java - 为什么我不能将一个动作重定向到 Struts2 中的另一个动作？

> ID：10951255
> 
> 赞同：9
> 
> 时间：2012-06-08T14:56:19.990
> 
> 标签：java, struts2

我正在使用 Struts2。我有一个对话框，其中包含通过“search_users”操作更新的人员列表。在此列表旁边，我有一个表单，您可以在提交表单时通过调用“add_user”操作来添加另一个人。

我想要做的是，一旦执行了 add_user 操作，列表就会使用“search_user”操作进行更新。

我尝试在 struts.xml 中使用结果类型“重定向”，如下所示：

```
<action name="search_users" class="org.apache.struts.gestion_edt.controller.adm_proyectos.BLSubequipo" method="searchUsers">
            <result name="success">list.jsp</result>
        </action>

        <action name="add_user" class="org.apache.struts.gestion_edt.controller.adm_proyectos.BLTipoEntregable" method="addUser">
            <result name="success" type="redirectAction">search_users</result>
        </action> 
```

但这不起作用。我究竟做错了什么？有什么我不知道的东西我应该添加到 struts.xml 文件中吗？

这是我得到的错误信息：

```
"Caused by: There is no result type defined for type 'redirect-action' mapped with name 'success'.  Did you mean 'redirectAction'? - result - file:/.../struts.xml:59:44
    at ..." 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-08T17:22:05.117

当前配置：

```
<action name="add_user" class="org.apache.struts.gestion_edt.controller.adm_proyectos.BLTipoEntregable" method="addUser">
   <result name="success" type="redirectAction">search_users</result>
</action> 
```

根据[文档](http://struts.apache.org/2.3.1.2/docs/redirect-action-result.html)正确的格式是：

```
<action name="add_user" class="org.apache.struts.gestion_edt.controller.adm_proyectos.BLTipoEntregable" method="addUser">
    <result type="redirectAction">
        <param name="actionName">search_users</param>
        <!--<param name="namespace">/secure</param> This is optional if your action where you are redirecting is in the same namespace you can leave this, if your action is in some other name space then provide the namespace--> 
    </result>
</action> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-03T17:41:10.510

当前使用**Struts 2.3.20**，这有效：

```
<result type="redirectAction">myAction</result> 
```

我在以前的版本中没有确认。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:09:22.270

我不是 Struts 大佬，但根据文档，您的重定向在语法上似乎不正确：[http ://struts.apache.org/2.1.6/docs/redirect-action-result.html](http://struts.apache.org/2.1.6/docs/redirect-action-result.html)

```
<package name="public" extends="struts-default">
    <action name="login" class="...">
        <!-- Redirect to another namespace -->
        <result type="redirect-action">
            <param name="actionName">dashboard</param>
            <param name="namespace">/secure</param>
        </result>
    </action>
</package> 
```

# java - NetBeans - 启动画面？

> ID：10951256
> 
> 赞同：1
> 
> 时间：2012-06-08T14:56:22.763
> 
> 标签：java, netbeans, splash-screen

在文件>>项目属性>>应用程序对话框中，我看到一个标有启动画面的文本字段，允许您指定可用作启动画面的图像的路径。所以我设置了一个图像，但它不起作用。当我运行项目时，它没有出现？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:08:13.310

有几种方法可以做到这一点，您可以在[如何创建启动画面（Java 教程 > 使用 JFC/Swing 创建 GUI > 使用其他 Swing 功能）中查看更多详细信息](http://docs.oracle.com/javase/tutorial/uiswing/misc/splashscreen.html)

*   使用`java -splash:<file name> <class name>`
*   在文件中使用`Main-Class: <class name>`和`SplashScreen-Image: <image name>``manifest.mf`

特别是对于 NetBeans，您可以查看以下教程：[Splash Screen Beginner Tutorial - NetBeans Wiki](http://wiki.netbeans.org/Splash_Screen_Beginner_Tutorial)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:00:18.897

我怀疑这仅适用于 Web Start 项目。它会将初始屏幕的路径放在 .jnlp 文件中，然后 Java 将在执行 Web Start 应用程序时显示该图像。

# javascript - 为什么 Ajax 不发布到服务器？

> ID：10951257
> 
> 赞同：0
> 
> 时间：2012-06-08T14:56:25.393
> 
> 标签：javascript, ajax, spring-mvc

有人可以看看以下内容并告诉我我的服务器没有收到来自我的 ajax 的任何调用吗？警报弹出但对服务器没有任何影响？？

JSP代码：

```
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>This is a project to show how to use RESTful</title>
</head>
<body>

<script src="<%=request.getContextPath()%>/js/jquery.js"></script>
<script src="<%=request.getContextPath()%>/js/add.js"></script>

<H1>Add Employee</H1>

<p>
<form name="htmlform">
<table border=1>
    <thead><tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
    </tr></thead>

    <tr>
        <td><input  type="text" name="ID" maxlength="5" size="3"></td>
        <td><input  type="text" name="Name" maxlength="10" size="10"></td>
        <td><input  type="text" name="Email" maxlength="10" size="10"></td>
    </tr>

</table>
<input type="button" value="Save Employee" onclick="doAjaxPost();" />
<p>
<p>
</form>
[<a href="http://localhost:8080/RESTful/service/employees">List all Employees</a> | <a href="add.jsp">Employee Form Test</a>]

</body>
</html> 
```

添加.JS代码：

```
function doAjaxPost() {  

    alert("doAjaxPost called");

       $.ajax({
            contentType : "application/json",
            dataType : 'json',
            type : "PUT",
            url : contexPath + "/service/employee",
            data : $(this).serializeObject(), 

            success : function(data) {
                alert("Thanks for submitting.  \n\n" + response.result);
               // response
            },
            error : function(request, status, error) {
                   alert('Error: ' + e); 
            }
        });
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:59:30.700

```
url : contexPath + "/service/employee", 
```

你有没有定义的机会`contexPath`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:00:06.067

您在该行中拼写错误的任何机会`contexPath`（假设`contextPath`在某处定义）：

```
url : contexPath + "/service/employee", 
```

**编辑**：看看你在哪里得到上下文，这会起作用：

```
url : "<%=request.getContextPath()%>/service/employee", 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-09T08:23:14.400

其他两个答案都是有效的。但是根据我的说法，在 jsp 页面中使用 scriptlets 是一件坏事。

取而代之的是，您可以将值**“/service/employee”**作为参数传递给`url:`. 因为如果您有正确的映射或 url，那么它只会将此值附加到此页面上的当前 url 并执行它。

我在我的应用程序中使用了它，它的工作非常好。

希望这对您有所帮助。干杯。

# spring - Spring 3 匹配通配符是严格的，但是找不到元素'jee：jndi-lookup'的声明

> ID：10951262
> 
> 赞同：8
> 
> 时间：2012-06-08T14:56:44.573
> 
> 标签：spring, hibernate, db2, jndi

所以我有一个类似于这里的问题......

[Spring 3.0 错误：匹配的通配符是严格的，但找不到元素的声明](https://stackoverflow.com/questions/8651781/spring-3-0-error-the-matching-wildcard-is-strict-but-no-declaration-can-be-fou)

我的 pom 看起来像这样

```
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop"
xmlns:p="http://www.springframework.org/schema/p" xmlns:mvc="http://www.springframework.org/schema/mvc"
xmlns:tx="http://www.springframework.org/schema/tx"
xmlns:jee="http://www.springframework.org/schema/jee"
xsi:schemaLocation="http://www.springframework.org/schema/beans
      http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
      http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
      http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
      http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
      http://www.springframework.org/schema/jee/spring-jee-2.5.xsd">
...
<jee:jndi-lookup id="dataSource" jndi-name="jdbc/db" resource-ref="true" /> 
```

但是当我尝试在 Websphere 上运行该服务时，我得到以下信息......

```
Line 16 in XML document from ServletContext resource [/WEB-INF/context/loyalty-servlet.xml] is invalid; nested exception is org.xml.sax.SAXParseException: cvc-complex-type.2.4.c: The matching wildcard is strict, but no declaration can be found for element 'jee:jndi-lookup'. 
```

似乎这与我的链接不同，因为我已经在命名空间中有架构。有任何想法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-08T19:01:51.293

请注意其他项目的模式`xsi:schemaLocation`- 来自属性的每个命名空间 URI`xmlns:*`都应该跟在其各自的 XSD 位置之后：

```
 xsi:schemaLocation="
     http://www.springframework.org/schema/beans 
     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd       
     http://www.springframework.org/schema/mvc 
     http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
     http://www.springframework.org/schema/context 
     http://www.springframework.org/schema/context/spring-context-3.0.xsd        
     http://www.springframework.org/schema/aop 
     http://www.springframework.org/schema/aop/spring-aop-3.0.xsd       
     http://www.springframework.org/schema/tx 
     http://www.springframework.org/schema/tx/spring-tx.xsd       
     http://www.springframework.org/schema/jee
     http://www.springframework.org/schema/jee/spring-jee-2.5.xsd"> 
```

# javascript - 使用全局变量作为动作绑定方法的参数

> ID：10951266
> 
> 赞同：1
> 
> 时间：2012-06-08T14:57:02.017
> 
> 标签：javascript, jsf-2

因为我不是 javascript 也不是 jsf 专家，所以我问是否可以定义一个全局变量，然后将其作为参数传递给动作绑定方法。也许举个例子会更清楚...... :)

在我的 xhtml 代码中应该是这样的：

```
...
<script type="text/javascript">
  var isEdit = "false";

  //<![CDATA[ 
    function editSelected(selBox, inputFiled)
    {
      var htmlstring = selBox.options[selBox.selectedIndex].text;
      inputFiled.value = htmlstring;
      isEdit = "true";
    }
  //]]>
</script>

...

<h:commandLink
  styleClass="waiButton"
  value="#{lakshmiMsg.commonButtonAdd}"
  action="#{detailController.addCreator(**isEdit**)}"
  rendered="#{detailModel.mode != detailModel.viewMode}">
</h:commandLink>
... 
```

这样的事情可能吗？如果没有，是否有其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:07:24.007

让您的 JavaScript 更新隐藏的表单字段可能会更好地处理此类事情。commandLink 上的操作在服务器上进行评估，而 JavaScript 中的函数在浏览器中运行。

使用隐藏的表单字段，您可以在 addCreator 方法中检查它（不是作为参数，而是从请求中）以查看您是否处于编辑模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:19:48.710

您可以通过 JS 更改隐藏的输入字段。例如

```
<h:inputHidden id="edit" value="#{bean.edit}" /> 
```

和

```
document.getElementById("form:edit").value = isEdit; 
```

另一种方法是不要`editSelected()`在 JS 中完成这项工作，而是用`<f:ajax>`魔法在纯 JSF 中完成这项工作。由于代码不完整且没有足够的自我记录，因此对此的功能要求尚不清楚，因此我无法为此提供启动示例。

# php - 尝试使用 openssl 调试 PHP 代码

> ID：10951267
> 
> 赞同：1
> 
> 时间：2012-06-08T14:57:11.967
> 
> 标签：php, encryption

我正在尝试调试以下代码。我正在使用 try and catch 块，但它仍然没有显示任何错误消息。该代码过去在 5.3.8 版本中运行良好，但在升级到 5.3.13 后停止运行。我打开了 display_errors true 但无法得到错误。我收到“网站出现编程错误”消息。你能告诉我任何建议吗？

```
error_reporting(-1);
$conf['error_level'] = 2;
ini_set('display_errors', TRUE);
ini_set('display_startup_errors', TRUE);

    $SIZE = 32;
    $IV_SIZE = 16;
    $CIPHER = 'aes-256-ofb';  
    try {

         $secret = openssl_random_pseudo_bytes($SIZE);
       } 
    catch (Exception $e) {
             die ('Error occurred: ' . $e->getMessage());
         }

    $iv = openssl_random_pseudo_bytes($IV_SIZE);

    try {

        $first = openssl_encrypt( $_POST['first_name'], $CIPHER, $secret, FALSE, $iv);
       } 
    catch (Exception $e) 
    {
        die ('Error occurred: ' . $e->getMessage());
    } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-08T15:04:45.787

在设置 display_errors 之前添加这一行：

```
error_reporting(E_ALL); 
```

我的猜测是它只是在早期的 php 版本中工作，但在升级后就坏了。我认为开放的 SSL 库不会抛出异常，因此将其包装在 try/catch 块中不会做任何事情。

# database - 这是标准化错误吗？

> ID：10951269
> 
> 赞同：0
> 
> 时间：2012-06-08T14:57:24.343
> 
> 标签：database, database-design

这与我的上一个问题相似，但它更归结为问题。

我正在设计一个系统来安排任务；大多数时候重复的任务。例如，用户可以将“扫地”安排在每周的周一、周三和周五进行。

我可以从日程表中判断一项任务是否应该在任何特定的日子完成，最重要的是我可以判断它是否应该在当天完成。然后，我必须向工作人员显示当前任务的列表（并将其发送到站点周围的手机）。

然后用户表明他们已经开始了任务（所以我们需要一个状态Task-Started）以及他们何时完成了一项任务（Task-Worked）。如果工人没有很好地完成工作，检查任务的人可以“失败”它，进入结束状态任务失败。一个任务也可以有其他一些状态，但这对于这个问题的范围来说应该足够了。

我想知道是否应该在数据库中创建每个任务发生的**实例**，从而允许我针对该任务的**特定实例存储****状态**。我想另一种看待它的方式是我在数据库中创建“到期”的初始状态，或“今天到期”以及它到期的实际日期时间（或至少是机会窗口的日期时间）做任务）。

 **但是-无论如何，这种状态**总是**可以派生的，因为这是我从中生成“今天的”任务列表的地方，所以它确实感觉像是一个规范化错误——感觉就像我在重复无论如何都可以派生的数据。

优点：

*   它将允许生成的“到期”任务具有准确的日期时间，从而保护它免受只会影响未来几天的时间表的更改（尽管授予我的 Schedule-History 表允许我获取旧数据）。

*   可以调整特定日期的日程安排，以防当天发生异常情况。

*   它在数据库中创建了一个正式的状态，而不是派生它（我只是编造的吗？）。

缺点：

*   它需要一个后台进程来生成这些实例（或生成“Due”或“Due-Today”状态，具体取决于您如何看待它）。

我想我的问题归结为：

1) 如果日程表只是一个确切的日期时间列表，则没有问题，因为每个条目都描述了任务本身。事实是：这个日期时间的这个任务。一旦该任务完成，我们就会针对它存储事实。

2）然而，重复计划只是描述了每个任务应该在什么时候，而不是描述实际发生的情况。

我希望这有点道理。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T04:00:04.547

我会将其建模为**task schedule**，其中将包含诸如任务发生在哪一天以及下一次到期时间等信息。

作为每天的后台作业，您将查看时间表并确定它们是否在今天发生。如果是这样，您将创建一个**任务**记录，并更新下一个截止日期。下一个截止日期是一种非规范化，但我认为它让生活更轻松。这取决于您的调度逻辑变得多么复杂以及您拥有多少数据。

任务表是任务计划的子表。任务表将包含到期日期、状态、分配给等。同时，您会将这些任务发送到手机（我会在第一个任务成功完成后启动的第二个任务中执行此操作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T22:41:46.093

将“任务”和“任务实例”分开，但不要在任务到期时生成新实例。

在启动时生成它（并将结束时间和成功状态保留为 NULL）。任务实例完成后，将这些 NULL 替换为具体值。

因此，不需要后台进程，但您始终可以确定何时：

*   到期任务未启动（实例表中无行）
*   或启动的任务尚未完成（NULL 结束时间）
*   或者完成的任务有多成功（通过检查结束时间为非空的任务实例的成功状态）。**

# java - 生成随机 unix 时间戳

> ID：10951273
> 
> 赞同：1
> 
> 时间：2012-06-08T14:57:37.463
> 
> 标签：java, unix-timestamp

如何在特定时间生成随机 unix 时间戳。例如获取今天和明天之间的随机 unix 时间平均值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:07:21.683

```
long randomEpoch = epoch1 + Math.abs(new Random().nextLong()) % (epoch2-epoch1); 
```

其中`epoch1`和`epoch2`是两次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:00:42.073

通过生成两个时间戳来获取所需的范围。减去差值（绝对值）。获取一个介于 0 和 1 之间的随机数。将差值乘以随机数。将结果添加到较早的时间图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:06:01.743

此代码专门获取今天和明天之间的随机时间。

```
public Date randTime(){
    Date now = new Date();
    Date today = new Date(now.getFullYear(), now.getMonth(), now.getDay(), 0, 0, 0, 0);
    return new Date(today.getTime() + (long)(Math.random() * 86400000));
} 
```

# unit-testing - xcode 4.3 单元测试

> ID：10951274
> 
> 赞同：0
> 
> 时间：2012-06-08T14:57:43.730
> 
> 标签：unit-testing, xcode4.3, sentestingkit

我是 xcode 和 Objective-c 的新手。我还决定在我的项目中添加单元（逻辑）测试。测试工作正常（使用 OCUnit 和 SenTestingKit）。我不明白的是它是如何`build for testing`工作的。让我解释..

我编写了一个简单的单元测试来检查一个空数组 - 使用

```
STAssertTrue([array count] ==0, @"Should have an empty array, but it is not"); 
```

这构建得很好并且测试通过了。

现在，如果我将其从 0 更改为 1，则构建失败。为什么构建失败对我来说没有意义 - 代码没有任何错误。在我看来，构建实际上正在运行代码并且断言正在断言。

如果方法要返回一个包含一个元素的数组，如何通过代码一步来确定方法中的问题？在这个简单的例子中问题很明显，但如果要测试的方法更深入，则需要逐步解决问题。像这样运行单元测试似乎不太容易使用——除非我完全错过了一些东西。

我的问题是：如何逐步完成失败的单元测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:18:52.543

如果您不希望损坏的测试导致构建失败，则需要关闭项目中的“**构建后测试”设置。**如果将来您的构建由于您的测试而失败，您可以通过执行它们（产品 -> 测试）并设置断点来调试您的测试用例，就像调试任何其他代码一样。Xcode 并非总是如此，但正如您所说，您正在使用 4.3。

您还问“为测试而构建”是什么意思。这个问题涵盖了相同的领域：[Xcode 4 术语“为测试而构建/为运行而构建/为分析而构建/为归档而构建”](https://stackoverflow.com/questions/5580961/xcode-4-terms-build-for-testing-build-for-running-build-for-profiling-bui)

# emacs - emacs：添加空格确实换行

> ID：10951279
> 
> 赞同：3
> 
> 时间：2012-06-08T14:57:54.790
> 
> 标签：emacs

我想看到一个没有换行的乳胶表，所以我改为使用`M-x toggle-truncate-lines`.

但是，如果我在两个乳胶符号“&”之间添加一些空格，则该行将在我做最后一个空格的地方换行。我假设emacs已经解释了一定数量的空格。我怎样才能避免这种情况？

感谢任何提示，佐丹奴

GNU Emacs 23.3.1 (i386-mingw-nt5.1.2600)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T20:48:27.423

这里有两个不同的问题。首先是长线的视觉截断。这就是这样`toggle-truncate-lines`做的。如果它被打开，那么一条比窗口宽度长的线会被换行，所以它都适合屏幕。然而，这种包装纯粹是视觉的——实际的文件并没有改变，Emacs 只是修改了它的显示方式。

第二个问题是段落填充。如果`auto-fill-mode`打开，Emacs 会在它比设置的阈值更宽时自动断开一条长线。默认情况下，我认为它通常设置为 72。因此，每当一行超过 72 个字符时，Emacs 就会添加一个换行符将长行分成两行。这实际上会更改文件，并且与窗口的实际宽度无关。

在您的情况下，听起来 Emacs 是自动填充您不想填充的行。你有几个选择。最快的方法就是关闭`auto-fill-mode`，您可以这样做`M-x auto-fill-mode`。您还可以将 设置`fill-column`为一个较大的数字，以使阈值大于 72。您可以使用 临时执行此操作`C-x f 100 <RET>`，将 100 替换为您希望线条的宽度。要进行更永久的更改，您可以将首选填充列添加到 .emacs：

```
(set-default fill-column 100) 
```

# wcf - 我们是否需要在 WCF 服务器和客户端中指定相同的绑定？

> ID：10951282
> 
> 赞同：0
> 
> 时间：2012-06-08T14:58:02.847
> 
> 标签：wcf, wcf-binding

从客户端调用 wcf 服务时出现以下错误。

> 由于 EndpointDispatcher 的 ContractFilter 不匹配，接收方无法处理带有 Action '' 的消息。这可能是因为合约不匹配（发送方和接收方之间的操作不匹配）或发送方和接收方之间的绑定/安全不匹配。检查发送方和接收方是否具有相同的合同和相同的绑定（包括安全要求，例如消息、传输、无）。

它说发送者和接收者需要使用相同的绑定。这是否意味着，如果我`BasicHttpBinding`在服务器上使用相同的绑定需要在客户端中指定？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T08:21:32.367

> 它说发送者和接收者需要使用相同的绑定。这是否意味着，如果我在服务器上使用 BasicHttpBinding，则需要在客户端中指定相同的绑定？

在简单的情况下**Yes**。

但是有时，当客户端和服务器之间涉及**路由器**时，它们可以使用不同的绑定进行通信。例如。当服务使用 tcp 绑定 (netTcp) 并且客户端在实际情况下使用 http 绑定(basicHttp) 时，它们无法相互通信，但它们之间有[路由服务](http://msdn.microsoft.com/en-us/library/ee517421.aspx)使得通信成为可能。当然，路由服务必须使用基本的 http 绑定。

# 4d-database - 如何浏览文件路径，然后在 4D 表单的变量中显示该路径？

> ID：10951286
> 
> 赞同：1
> 
> 时间：2012-06-08T14:58:22.530
> 
> 标签：4d-database

我正在尝试创建一个 4D 表单，它允许我浏览我的服务器以查找特定文件，然后一旦选择，将该文件的路径显示为表单中的变量。到目前为止，我什至无法打开资源管理器窗口来浏览文件，但我对 4D 整体还是很陌生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:25:42.193

看一下“[选择文档”](http://doc.4d.com/4D-Language-Reference-13/System-Documents/Select-document.301-738105.en.html)命令。

> 选择文档命令显示一个标准的打开文档对话框，允许用户设置一个或多个文件并返回所选文件的名称和/或完整访问路径。

该链接适用于 4Dv13，但对于 v11 和 v12 应该是类似的。

如果您想立即访问内容，请改用[Open Document](http://doc.4d.com/4D-Language-Reference-13/System-Documents/Open-document.301-738110.en.html)。

编辑以添加代码示例

```
C_TEXT($tFirstFileSelected) // this doesn't seem to be getting filled
C_TEXT(tFileNamePlusPath) // use process var to display on form (can't use local)
ARRAY TEXT($atFilesSelected;0) // local array to hold all paths for file(s) selected

Select document("";"*";"Pick File";0;$atFilesSelected;$tFirstFileSelected)

// if only one file is selected the path will be in the first array element
tFileNamePlusPath:=$atFilesSelected{1} 
```

# perl - 调用 SUPER::new()

> ID：10951292
> 
> 赞同：6
> 
> 时间：2012-06-08T14:58:50.780
> 
> 标签：perl, oop, base-class

我已经看到了两种`new`在派生类中实现该方法的方法。

方法一：

```
sub new {
    my $invocant = shift;
    my $class   = ref($invocant) || $invocant; 
    my $self = {};
    bless($self, $class);
    $self = $self->SUPER::new( @_ );
    return($self);
} 
```

方法二：

```
sub new {
  my $self = shift;
  my $class = ref($self) || $self;
  return $self if ref $self;
  my $base_object = $class->SUPER::new(@_);
  return bless ($base_object, $class);
} 
```

我不确定我理解有什么区别。谁能解释一下？

* * *

从您的评论和回答中，我可以看出这`ref()`部分很糟糕。

但是使用`SUPER::new(@_)`呢？在第一个示例中，hashref 被祝福到派生类中，然后调用该对象的`SUPER`'s`new`并将其保存到同一个对象中。

另一方面，在第二个示例中，基对象是从类的`SUPER`s`new`方法创建的，并被祝福到新类中。

这两种方式有什么区别？看起来第一个用基础对象覆盖了对象。第二个似乎是“双重祝福”。我很困惑。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T19:57:36.853

为什么不只是：

```
sub new {
    my $class = shift;
    my $self = $class->SUPER::new(@_);
    $self->do_some_additional_init();
    return $self;
}; 
```

- 唯一的例外是层次结构中最深的基类，它应该调用`bless $self, $class;`或者可能调用`my $self = fields::new($class);`，以防万一`use fields`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T15:20:50.863

**更新**

你问：

> *这两种方式有什么区别？看起来第一个用基础对象覆盖了对象。第二个似乎是“双重祝福”。我很困惑。*

振作起来。您展示的两种方法中的每一种本身都令人困惑，并且都不应该被效仿。

方法一祝福 DerivedClass 类的对象存在，然后使用该对象调用某个 AncestorClass 的分配器/构造器，替换自身。现在，AncestorClass::new 可能也使用了不幸的`ref($yuck) || $yuck`习语，这意味着新对象将被祝福进入 DerivedClass。因此，一个 DerivedClass 对象用于构造另一个来替换它。可疑。

如果接收者是一个对象，方法二返回它的接收者（$self）。（注意，`ref($self)`当它只需要检查一次时，会检查两次。）也就是说，在方法二下`$o->new()`返回完全相同。`$o`如果接收者*不是*对象而是类名，也就是说，如果我们调用了`DerivedClass->new`，则调用 AncestorClass::new。但是超类'方法的第一个参数是'DerivedClass'，想必超类并没有硬编码它的`bless`ed包名，所以后面的重新加持是没有意义的。

只是不要担心这些例子。相反，请咨询[perlobj](http://perldoc.perl.org/perlobj.html)和[perlootut](http://perldoc.perl.org/perlootut.html)以安全和理智地使用 SUPER。

**原始答案**

啊，我的眼睛！

正如 daxim 所评论的，方法一是一种令人反感的方法，它允许人们从与现有对象相同的类中构造一个对象：

```
my $o1 = MethodOne->new();
my $o2 = $o1->new();        # $o2 is a clone of $o1\.  No, wait, it isn't!
                            # It's a brand new, "empty" object.  Ha,
                            # fooled you. 
```

方法二是（我认为）*这种令人困惑的做法的解决方法。*如果被调用 ，您的方法二将返回**完全相同的对象。**`new()`

```
my $o1 = MethodTwo->new();
my $o2 = $o1->new();         # $o2 is a new MethodTwo.  No, wait, it isn't!
                             # It's a brand new object.  No, wait, it isn't!
                             # It's a /exactly the same object/ as $o1\.  Ha,
                             # fooled you. 
```

也不要使用。:) 可能在某些应用程序中，上述任何一种语义都非常有意义。我只是不会`new()`在这些应用程序中命名该方法......

# matlab - 将句柄从一个 m 文件传递 到另一个 m 文件

> ID：10951298
> 
> 赞同：0
> 
> 时间：2012-06-08T14:59:20.157
> 
> 标签：matlab, user-interface, handles

在我的“主”窗口中，我有一个按钮可以打开另一个窗口“列表”。在列表窗口中，我有两个列表框，左边的一个有名字，右边的一个我给它添加名字。但是，一旦单击“列表”窗口上的“确定”按钮，我就无法将添加的名称传递到“主”窗口。

```
function Done_Button_Callback(hObject, eventdata, handles)

    SelectedFaults = get(handles.SelectedFaults_Listbox,'String');  
    set(Main, handle.Faults_Listbox,'String',SelectedFaults)   
    close(Insert_Fault) 
```

我得到的错误是：

```
 ??? No appropriate method, property, or field Faults_Listbox for class handle.

Error in ==> Insert_Fault>Done_Button_Callback at 380

set(Main, handle.Faults_Listbox,'String',SelectedFaults)

Error in ==> gui_mainfcn at 96
    feval(varargin{:});
  Error in ==> Insert_Fault at 42

gui_mainfcn(gui_State, varargin{:});
??? Error while evaluating uicontrol Callback 
```

两个 m 文件都在同一个目录中。我被困住了。谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:38:42.450

您的代码没有显示变量“句柄”是如何定义的。您指的是 “handles” 吗? 在这种情况下，handles结构是Insert_Fault图自带的，与Main图的handles结构无关。

如果要修改主窗口中的列表框，可以将 Faults_Listbox 的句柄从主图窗传递给 Insert_Fault 图，例如通过 [userdata 或 appdata](http://www.mathworks.de/help/techdoc/creating_guis/f5-998352.html)。

下面的代码应该做你想做的事。

在主要：

```
% Callback of a button in main that opens the Insert_Fault figure
function Open_Insert_Fault_Callback(hObject, eventdata, handles)
Insert_Fault('UserData', struct('Mainhandles', handles)); 
```

在 Insert_Fault 中：

```
function Done_Button_Callback(hObject, eventdata, handles)
SelectedFaults = get(handles.SelectedFaults_Listbox,'String');  

userdata=get(handles.figure1, 'UserData');
Mainhandles=userdata.mainhandles;

set(Mainhandles.Faults_Listbox,'String',SelectedFaults)   
close(Insert_Fault) 
```

# java - Eclipse 中的 Web 应用程序库为空 - 未找到“jar”

> ID：10951306
> 
> 赞同：9
> 
> 时间：2012-06-08T14:59:42.293
> 
> 标签：java, eclipse, spring, jar

最近，我在 Eclipse Indigo 中开发的 Spring MVC Java 应用程序似乎失去了与我所有 jar 所在的“lib”文件夹的连接（不再为我的项目找到 jar）。

我该如何解决？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-08T14:59:44.353

对我来说，修复很简单：

*   在 Eclipse 菜单中转到此处：项目 | 属性 | 项目方面
*   确保选择“Java”和“动态 Web 项目”
*   点击确定

您*可能*还需要这样做：

*   在 Eclipse 菜单中转到此处：项目 | 属性 | Java 构建路径 | 图书馆
*   删除“Web 应用程序库”
*   点击“添加库”
*   选择“网络应用程序库”。点击下一步”
*   在下拉列表中选择您的项目
*   点击确定

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-06-30T07:45:40.623

对我来说，Brad Parks 的答案在 Eclipse Luna ( 4.4.2 ) 中不起作用，即添加**Web 应用程序库**没有效果......仍然是空的。

我所要做的就是配置**Web 部署程序集**...我的库位于 WEB-INF 中，这又类似于 -`/{project}/web/WEB-INF/lib` 当我添加了如下所示的**部署程序集条目时，**

[![在此处输入图像描述](../Images/d2c511683a9bb0607eb357a56caea843.png)](https://i.stack.imgur.com/g55Oc.png)

然后在这两个下面，我为目录中的每个 jar 都有一个条目，`{project}/web/WEB-INF/lib`其中 Deploy Path as `WEB-INF/lib`.

此部署程序集自动填充了我的`Web App Libraries`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-25T13:38:52.687

如果您已导入现有项目，则首先将 Server(Window>Preference>Server>Run Time environment) 添加到您的工作空间，然后重新导入您的项目。

或选项 2 转到项目属性 > 目标运行时并选择您的服务器

这应该将网络库添加到您的项目中。

# android - 错误 = 来自 qubuf 的无效参数是什么意思

> ID：10951312
> 
> 赞同：0
> 
> 时间：2012-06-08T15:00:02.383
> 
> 标签：android, buffer, arguments

我想知道什么

```
Error = Invalid argument from qbuf 
```

方法。

当我按下视频播放器上的主页按钮时会发生这种情况。这是新事物还是其他人以前见过类似的东西。

我在谷歌上找不到任何东西，尤其是标签 v412_utils

这显示在 Nexus S 设备上

日志猫

```
 06-08 10:57:59.257: I/windowChanged(15072): surface Created init
06-08 10:57:59.382: W/IInputConnectionWrapper(203): showStatusIcon on inactive InputConnection
06-08 10:57:59.382: V/RenderScript_jni(203): surfaceDestroyed
06-08 10:57:59.386: E/Surface(203): surface (identity=2589) is invalid, err=-19 (No such device)
06-08 10:57:59.386: E/Surface(203): surface (identity=2589) is invalid, err=-19 (No such device)
06-08 10:57:59.394: E/Surface(203): surface (identity=2589) is invalid, err=-19 (No such device)
06-08 10:58:00.937: I/playMedia(15072): playing Video
06-08 10:58:00.953: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:00.988: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.019: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.050: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.078: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.121: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.152: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.179: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.210: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.253: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.285: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.316: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.347: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.378: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.417: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.437: D/dalvikvm(110): GC_EXPLICIT freed 90K, 41% free 6305K/10631K, external 2194K/2740K, paused 115ms
06-08 10:58:01.449: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.480: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.511: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.554: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.585: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.621: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.652: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.687: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.714: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.746: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.781: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.812: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.847: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.882: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.914: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.949: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:01.984: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.015: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.050: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.085: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.117: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.152: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.187: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.218: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.253: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.289: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.320: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.355: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.390: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.414: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.445: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.488: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.523: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.554: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.589: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.613: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.648: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.683: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.718: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.749: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.785: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.820: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.851: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.886: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.917: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.953: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:02.988: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.023: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.058: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.097: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.117: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.152: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.183: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.222: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.246: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.281: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.316: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.347: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.382: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.417: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.449: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.484: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.515: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.550: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.585: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.617: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.656: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.691: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.714: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.749: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.781: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.816: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.851: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.882: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.917: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.953: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:03.984: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.019: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.050: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.085: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.121: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.156: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.191: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.222: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.253: E/v4l2_utils(76): Error = Invalid argument from qbuf
06-08 10:58:04.281: I/showRecord(15072): showing record menu 
```

暂停菜单

```
protected void onPause()

{

    Log.i("VideoPlayer", "onPauseCalled");
    super.onPause();

    PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    surfaceCreated = false;
    focusFirst = false;
    if(!pm.isScreenOn())
    {
        pauseMedia();
        Log.i("onPause", " save states to be called");
        if(saveAllowed)
            saveStates();
        view.setVisibility(View.GONE);
        //Log.i("onPause", "visibility GOne");
        removeListeners();
        doCleanUp();
    }

} 
```

就像我说的那样，这只发生在我按下主页按钮时。屏幕关闭和打开和其他情况下工作。只需在主页按钮上即可。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:21:14.997

我找到了我认为的答案。这是因为我在进行其他活动时不会暂停我的媒体或移除我的 Surface View。我认为它在 onResume() 上失败了。我允许它暂停媒体并将 Visibility 设置为在 pm 之外是 Screen on 并且它停止给我那个错误

# c# - asp:ImageButton 链接地址

> ID：10951315
> 
> 赞同：0
> 
> 时间：2012-06-08T15:00:10.060
> 
> 标签：c#, asp.net, button, hyperlink, imagebutton

我想我今天一直站在电脑前，因为我想不出与 asp:imageButton 相关的最基本的事情。

我只想有一个 ImageButton 在单击时转到外部链接。我不想使用 OnClick 和 CodeBehind 进行重定向。有没有办法在.aspx 中设置它？

asp:HyperLink 或内部带有 Image 标签的 LinkBut​​ton 也可以，但我不希望图像被蓝色超链接边框包围。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:04:34.800

如果你不想使用 CodeBehind，有没有理由使用服务器端控件？为什么不使用 HTML 锚 (<a>) 标签并在其中放置一个 <img> 标签。这样，您可以将 href 设置为您想要将用户带到的任何链接。

如果您仍想使用 ImageButton，请将 OnClientClick 属性设置为调用 JavaScript 方法。或者，您可以将 ClientIdMode 设置为“静态”并使用 javascript/jquery 为 onclick 事件添加事件处理程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T15:11:43.930

您可以使用 JavaScript，而不是使用 OnClick。

```
<script type="text/javascript">

function redirectTo()
{
    window.location = "YOUR URL";
}

</script> 
```

进而：

```
<asp:imageButton ... OnClientClick="redirectTo();" ... /> 
```

# performance - Canvas vs DOM - HTML5 中最有效的图像显示方法是什么？

> ID：10951319
> 
> 赞同：7
> 
> 时间：2012-06-08T15:00:15.003
> 
> 标签：performance, html, canvas, image

StackOverflow 用户

在制作 html5 应用程序/网站时，对于像画廊这样的情况，在浏览器中顺序或同时显示大量图像，使用 canvas 元素是否合理？

只要我们只是在谈论呈现图像，那么使用画布并在其上绘制图像而不是使用 DOM 元素 <img> 标签有什么意义吗？还会有一些图像处理，如 CSS3 转换/移动/缩放/缩放和手势识别（拖动、触摸/点击、可能捏合等），据我所知，它们适用于画布和 img标签。

尽可能多地保留“html5”风格并考虑性能也很重要。例如，将来画布元素是否会被浏览器越来越多地使用和优化会很重要，而 <img> 是否会更快也很重要。

由于我们正在考虑开发一个通用的 html5 应用程序，在桌面和移动设备上工作，性能和速度是一个非常重要的因素。但是，比较 canvas 和 <img> 的测试主要针对 javascript 浏览器游戏。在这种情况下，动画并不像内存消耗和整体性能那么重要。

有没有关于这个特定方面的资源/研究？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:08:26.413

```
UseCanvas = NeedCanvas ? true : false 
```

这个操作你真的不需要画布，而且用画布开发需要更长的时间，因为它要复杂得多。

使用`<img>`带有 javascript 的标签不仅可以提高兼容性，还可以提高速度和可访问性——绝对所有带有浏览器的东西都可以运行 CSS 和 Javascript。此外还有 SEO 因素，我很确定画布中的图像不会被索引。

不要为了使用 HTML5 技术而使用 HTML5 技术。当您想要开始扭曲图像并让用户在它们上绘制以便您可以导出/保存时，这就是您需要画布的地方。

# php - 通过 HTTPS 访问时，$_SERVER['HTTPS'] 如何为空？

> ID：10951325
> 
> 赞同：3
> 
> 时间：2012-06-08T15:00:29.647
> 
> 标签：php, apache, https

`$_SERVER['HTTPS']`当我实际通过 https 访问页面时，我遇到了空的问题。

根据 的[文档`$_SERVER`](http://php.net/manual/en/reserved.variables.server.php)，通过 HTTPS 访问页面时，这应该是非空的。

[为 mod_ssl](http://httpd.apache.org/docs/2.0/mod/mod_ssl.html)编写文档

> 该模块提供了大量 SSL 信息作为 SSI 和 CGI​​ 命名空间的附加环境变量。

这是否意味着我需要明确

```
SetEnv HTTPS on 
```

在 Apache 中，如果 PHP 作为 mod_php 运行来`$_SERVER['HTTPS']`设置？

我试图弄清楚我的系统是否有问题，或者我是否看到正常行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:25:26.773

要在 .htaccess 中正确使用[SetEnv](http://httpd.apache.org/docs/2.0/mod/mod_env.html) ，您需要**mod_env**模块，例如：

```
<IfModule mod_env.c>
   SetEnv HTTPS on
</IfModule> 
```

否则，**$_SERVER["HTTPS"]**将为空..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:07:20.060

我相信这`SetEnv`不适用于 PHP 模块；你`mod_userdir`有没有机会使用？这可能会产生影响。

或者，您可以使用这种检测：

```
if (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off'
    || $_SERVER['SERVER_PORT'] == 443) {

    $secure_connection = true;
} 
```

顺便说一句，如果您的站点是负载平衡的并且平衡器在内部通过常规 HTTP 连接运行，这也可能发生。

**更新**

我不确定是否`mod_userdir`总是有这种效果，即使它没有使用。

至于这个例子，而不是给`$secure_connection`你分配一个值（确保没有人在看）将它写入`$_SERVER['HTTPS']`自己:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:08:58.107

您使用的是 Apache 2.x 还是 1.x？[我在$_SERVER](http://www.php.net/manual/en/reserved.variables.server.php#84919)的 PHP 文档上找到了一条评论，它说它不会使用 Apache 1 进行设置。

# postgresql - 如何让 NSIS 在另一个用户的 %APPDATA% 中创建文件？

> ID：10951330
> 
> 赞同：1
> 
> 时间：2012-06-08T15:00:36.757
> 
> 标签：postgresql, nsis, appdata

我为 postgresql 9.1 编写了一个 NSIS 安装程序脚本。安装程序正常工作，但重新启动后，服务未启动（安装后，数据库正常启动）

我猜这是因为 postgres 服务用户的 %APPDATA% 中没有 pgpass.conf 文件。据我了解我的安装脚本，pgpass.conf 文件被添加到运行安装程序的用户的 %APPDATA% （在我的例子中是管理员帐户）。这无济于事。

我尝试了以下方法，将 pgpass.conf 添加到所有用户，bt 我想这会将它添加到一种通配符，而不是每个用户的 %APPDATA% ：

```
SetShellVarContext "all"
SetOutPath "$APPDATA\postgresql"
File config\pgpass.conf
SetShellVarContext "current"
SetOutPath "$APPDATA\postgresql"
File config\pgpass.conf 
```

我在文档中找不到 c:/Users/postgres 的宏名称。这可能是实现它的一种方式。但是对于 WindowsXP，7，我希望我需要一种可移植的方式来处理 /Users 目录。

我希望我可以使用 SetShellVarContext "postgres" 之类的东西，然后让 NSIS 在 c:\Users\postgres\AppData\postgresql 中写入 pgpass.conf 文件。

有没有办法做到这一点 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:37:03.120

没有记录的方法可以在没有令牌句柄的情况下为另一个用户获取 shell 文件夹（并且要获取令牌句柄，您需要用户密码，或者如果用户已登录，如果您以 SYSTEM 身份运行，则可以获取他们的令牌）

然后我们搬到无证领土；您可以尝试[此宏](http://nsis.sourceforge.net/GetUserShellFolderFromRegistry)或以[GetProfilesDirectory](http://sourceforge.net/tracker/?func=detail&aid=3303907&group_id=22049&atid=373085#comment1)作为根目录自己构建路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T23:38:25.720

`SetShellVarContext ALL`将为您提供`%programdata%`位置（在 Win7 中），这是与位置不同的`%appdata%`位置（也从`$APPDATA`NSIS 中获得。（符号链接使它们看起来是相同的......但它们是完全不同的目录！！！）

NSIS 将根据all 与 current 切换将上下文从 更改`%APPDATA%`为。但仍然使用var。 `%PROGRAMDATA%``SetShellVarContext``$APPDATA`

所以简而言之，我猜测您的文件将位于错误的位置。我相信您只想以管理员身份安装，但让 postgres 的本地用户拥有一个附加文件`pgpass.conf`。

根据它的Win7或WinXP设置一个变量，因为您要写入的路径都不同。

要进行测试，只需将文件写入您知道 postgres 用户所在的位置！

```
StrCpy $WINVER_VAR "C:\Users\postgresql\AppData\Roaming" ;;or whatever based on OS
SetOutPath "$WINVER_VAR\postgresql" 
```

或者更好的是使用

```
File /oname=$WINVER_VAR\postgresql\pgpass.conf pgpass.conf 
```

只需从安装程序复制到您想要的位置，并且在管理员目录中没有其他未使用的副本。

注意：在 XP 中`%APPDATA%`是在文档和设置中...我不记得确切的路径。所以你必须验证！

要添加到系统上的每个用户...查看“定位插件”或获取系统上所有用户的列表，然后执行相同操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-06T05:23:09.547

SID（安全标识符）是用于标识 Windows NT 的用户帐户、组、域或计算机的安全标识符。系统使用帐户 SID 而不是他们的个人资料用户名进行操作。SID 在创建时分配给每个帐户，因此如果您要使用相同的名称和密码再次创建帐户，SID 当然会有所不同。重新创建帐户将导致生成新的 SID。它们是独一无二的，如果你拿起我放下的东西..

宏：

```
;=#
;= ${GETUSERSID} $0 "Username"
;       $0          = The returning SID value
;       "Username"  = The username of the account you wish the SID
;                   If the username is an empty value, then the SID of the
;                   current user will be given to $0.
!define GETUSERSID "!insertmacro _GETUSERSID"
!macro _GETUSERSID _RESULT _USER
      System::Store S
      StrCpy $0 ${_USER}
      StrCmp $0 "" 0 +2
      ExpandEnvStrings $0 "%USERNAME%"
      System::Call "*(&t1024)i.r1"
      System::Call "advapi32::LookupAccountName(tn,tr0,ir1,*i1024,tn,*i1024,*in)i.r0"
      IntCmp $0 1 0 +2 +2
      System::Call "advapi32::ConvertSidToStringSid(ir1,*t.s)"
      IntCmp $0 1 +2 0 0
      Push error
      System::Free $1
      System::Store L
      Pop "${_RESULT}"
!macroend

${GETUSERSID} $0 "Username"
MessageBox MB_ICONINFORMATION|MB_OK "User's SID:$\r$\n$$0 is holding $0" IDOK 
```

下面是一个列出主机 PC 上所有注册用户帐户的示例：

```
System::Call "netapi32::NetQueryDisplayInformation(wn,i1,i0,i-1,i${NSIS_MAX_STRLEN},*i.R0,*i.R1)i.R4"
${If} $R4 = 0
    ${For} $R4 1 $R0
        System::Call "*$R1(i.R2,i.R3,i,w,i,i)"
        IntFmt "$R2" ${STR} $R2
        IntFmt "$R3" ${STR} $R3
        ${GetUserSID} "$R2" "$R5"
        IntOp $R1 $R1 + 24
        DetailPrint "-----------------"
        DetailPrint "Name: $R2"
        DetailPrint "SID: $R5"
        DetailPrint "$R3"
    ${Next}
    System::Call "netapi32::NetApiBufferFree(iR1)"
${EndIf} 
```

现在我不确定这是否可行（可能是前提，但总是有 ACL），但这里有一个例子（如果我正确理解你的问题）来暗示你在问什么。

```
${GETUSERSID} $0 "postgres"
ReadRegStr $1 HKU "$0\Volatile Environment" "APPDATA"
DetailPrint "APPDATA: $1"
AccessControl::GrantOnFile $1 "USER" "ListDirectory + GenericRead + GenericExecute" 
AccessControl::EnableFileInheritance $1
SetOutPath "$1\postgresql"
File config\pgpass.conf 
```

这只是一个快速修复..甚至不确定这是否会奏效，但也许是您朝着正确方向迈出的一步？希望这可以帮助！

# java - 为什么Java中String.Replace之后String值没有改变？

> ID：10951333
> 
> 赞同：2
> 
> 时间：2012-06-08T15:00:42.220
> 
> 标签：java, string

我对以下程序有疑问

请看下面的程序

```
public class Kiran {

    public static void main(String args[]) {

        String str = "Test";

        str.replace('T', 'B');

        System.out.println("The modified string is now " + str);
    }

} 
```

我所期待的是，一旦我运行这个程序，我应该看到 putput 为 Best，但令我惊讶的是输出是 Test。

谁能告诉我，为什么会这样？？

提前致谢 。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-08T15:01:44.040

字符串在 Java 中是不可变的，这意味着您无法更改它们。当您调用 replace 方法时，您实际上是在创建一个新字符串。

您可以执行以下操作：

```
String str = "Test";
str = str.replace('T', 'B'); 
```

这是一个重新分配。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T15:01:52.133

`String.replace`不改变字符串内容，而是返回替换的结果。您应该改为执行以下操作

```
str = str.replace('T', 'B'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T15:02:55.957

Java 中的字符串是不可变的——它们不能被改变。当您使用 str.replace 之类的函数时，它不会就地更改字符串，而是返回一个新的 String 对象，其中包含您请求对其进行的更改。这在[String 的文档中进行](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#replace%28char,%20char%29)了解释：

> 返回一个新字符串，该字符串是用 newChar 替换此字符串中所有出现的 oldChar 所产生的。

为了将来参考，Java 的文档非常详尽，并详细解释了方法期望的参数、返回的内容以及它们具有的副作用（如果有的话）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-08T15:02:58.550

字符串类是不可变的。因此，您对 String 对象所做的任何操作都将返回一个**新**的String 对象。

您必须将`replace`操作的结果分配给一个 String 变量，这样您才能得到结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-08T15:30:03.400

`String`对象在java中是不可变的，即每当对a进行修改`String`而不是修改它时`String`，都会在内存中创建一个新对象。

该方法在堆内存中`str.replace('T', 'B')`创建了一个新`String`对象，但该对象未被任何字符串变量引用。要引用该对象，您必须将其分配给您的`String`变量：

```
str = str.replace('T', 'B'); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T15:13:52.627

除了上述答案之外，如果您要广泛修改（添加/删除）数据，最好使用 StringBuffer（线程安全）或 StringBuilder（非线程安全）并在完成修改后将其转换为 String .

# php - PHP：move_uploaded_file() 无法打开流：没有这样的文件或目录

> ID：10951334
> 
> 赞同：22
> 
> 时间：2012-06-08T15:00:42.683
> 
> 标签：php, apache, file-upload

我试图让 PHP 将上传的文件从 tmp 目录移动到我的网络服务器上的某个永久位置。看起来很简单，但我收到了这个错误：

`Unable to move 'C:\UniServer\tmp\php3F62.tmp' to 'static/images/slides/1/1.jpg'`

很直接，对吧？它找不到目标文件夹。

我的问题是：**如何引用所需的目标目录？**

引用是否相对于脚本在服务器上的位置？还是相对于 URL？还是`PHP DOCUMENT_ROOT`？还是操作系统的文件系统？或者是其他东西？

我在 PHP 文档中或在 SO 上的任何类似问题中都找不到答案。

任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-06-08T15:09:53.370

跟踪路径的一种简单方法就是在 index.php 中定义绝对路径

```
define ('SITE_ROOT', realpath(dirname(__FILE__))); 
```

然后像这样使用它：

```
move_uploaded_file($_FILES['file']['tmp_name'], SITE_ROOT.'/static/images/slides/1/1.jpg'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-03-19T14:58:40.030

我在上传时遇到了同样的问题。看看我的例子，也许它可以帮助你。

我创建的文件名为“uploads”。

```
$uploads_dir = 'uploads/';
$name = $_FILES['userfile']['name'];
if (is_uploaded_file($_FILES['userfile']['tmp_name']))
{       
    //in case you want to move  the file in uploads directory
     move_uploaded_file($_FILES['userfile']['tmp_name'], $uploads_dir.$name);
     echo 'moved file to destination directory';
     exit;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:02:55.800

它来自脚本在服务器上的位置！此外，您需要在此文件夹中具有写入权限：

```
'static/images/slides/1/1.jpg' 
```

相反，最好以这种方式使用绝对路径：

```
'C:\UniServer\***\static\images\slides\1\1.jpg 
```

使用绝对路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-27T10:43:13.707

```
$destination = dirname(dirname(dirname(dirname(__FILE__))))."/runtime/tmp/";
chown($destination, 0755);
move_uploaded_file($info['tmp_name'], $destination.$info['name']); 
```

这是我的解决方案，我只是使用 mkdir 创建一个目录来放置我想要移动的图片。希望它有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-07T09:36:11.573

我认为这会帮助你而不会给你任何错误：

```
$image = $_FILES['image']['name'];
$image_temp =$_FILES['image']['tmp_name'];
$target='C:/xampp/htdocs/jer/images/'.basename($_FILES['image']['name']);
move_uploaded_file($image_temp, "$target");
insert into images (images) values ('$target'); 
```

# java - 不同平台上不同的 ZipOutputStream 结果

> ID：10951337
> 
> 赞同：1
> 
> 时间：2012-06-08T15:00:55.737
> 
> 标签：java, servlets, stream, zip

我有生成 zip 输出流的代码，然后我通过 servlet 的响应流发送该流。在我的 Mac 上进行开发测试时，一切正常，但是，当我将代码放在我的服务器 (RHEL) 上时，zip 存档似乎已损坏。当我尝试使用 jar 列出文件的内容时，我得到：

java.util.zip.ZipException：打开 zip 文件时出错

但奇怪的是，使用 jar 提取归档文件（但是其他解压缩文件失败）。

为了进一步测试，我确保 zip 文件的内容与来自我的 mac 和 RHEL 的内容完全相同。在这两种情况下，zip 文件的大小完全相同，但是哈希值 (MD5) 不同。

正如我所说，生成 zip 文件的代码以及内容完全相同，所以我不知道发生了什么。我相当确定我的 zip 文件创建是正确的，因为它在其中一个平台上工作。在 RHEL 服务器上生成 zip 文件时没有任何问题的迹象。

想法？谢谢您的帮助。

编辑：这是代码...

```
// first add the kml document
ZipOutputStream stream = new ZipOutputStream(response.getOutputStream());
stream.putNextEntry(new ZipEntry("doc.kml"));
stream.write(kml.getBytes(), 0, kml.length());
stream.closeEntry();

File image = null;
byte[] bytes = null;
FileInputStream fstream = null;

// include the images for each type
File images = new File("/tmp/images");
String filename = null;

for(Type type: types) {
  filename = type.getName() + ".png";
  image = new File(images, filename);
  bytes = new byte[(int)image.length()];

  fstream = new FileInputStream(image);
  fstream.read(bytes);

  stream.putNextEntry(new ZipEntry(filename));
  stream.write(bytes);
  stream.closeEntry();

  fstream.close();
}

stream.finish();
stream.flush();
stream.close(); 
```

EDIT2：情节变厚了，只要存档中只有一个图像，似乎 RHEL zip 流就可以了。希望这足以让谷歌帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T18:23:38.340

几个问题：

*   不要使用 . 将字符串转换为字节`getBytes()`。这将使用平台字符集，在不同的平台上可能会有所不同。始终使用*显式*字符集，例如`getBytes("UTF-8")`. 此外，从 getBytes() 返回的长度与字符串的长度无关。
*   读取文件时，不要将它们完全读入内存（这不会缩放）。使用固定大小的 byte[] 和 while 循环在 InputStream 和 OutputStream 之间进行复制。网上有数千个此代码的示例。（或使用 commons io 之类的东西`IOUtils.copy`）
*   与上一点相关，`InputStream.read()`有返回值，*不要忽略*。再次，您应该在您发现的任何示例中看到这一点，这些示例展示了将 InputStream 复制到 OutputStream 的最佳方式。

# javascript - 即时创建一个空白的 HTML 空间 Javascript

> ID：10951340
> 
> 赞同：39
> 
> 时间：2012-06-08T15:01:21.480
> 
> 标签：javascript

如何使用 javascript 即时创建空白空间？以下不适用于我..

```
var blank = document.createElement("&nbsp;");
div.appendChild(blank); 
```

* * *

## 回答 #1

> 赞同：103
> 
> 时间：2012-06-08T15:05:49.890

尝试使用这个：

```
myElement.appendChild( document.createTextNode( '\u00A0' ) ); 
```

如果您想要/需要更多空间，请使用几个，`\u00A0`例如：

```
myElement.appendChild( document.createTextNode( '\u00A0\u00A0' ) ); 
```

* * *

这个：

```
document.createEntityReference('nbsp'); 
```

不适用于所有浏览器，因此**请避免使用它**。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-08T15:04:05.303

如果您真的只想附加一个空格字符，请使用以下命令：

```
div.innerHTML += ' '; 
```

或者

```
div.innerHTML += '&nbsp;'; 
```

对于 HTML 实体。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-06-08T15:03:07.953

你在找`document.createTextNode(' ')`我相信。

这只能用于纯文本，不能用于实体。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:07:37.393

```
document.getElementById("mydiv").innerHTML +="!"; 
```

有效（我使用感叹来表示结果的即时性，用你想要的替换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T15:09:22.333

你可以这样做；但如果你想要一些空白空间，也许 css 会更好（边距，填充，......）

```
var span = document.createElement("span");
span.innerHTML = "&nbsp;"; // (if this doesn't work try " ")
anyElement.appendChild(span); // make sure anyElement actually points to a DOM element 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-10T04:21:38.230

你可以使用这个：

```
document.getElementById("your-button").firstChild.data = '\u00A0'; 
```

它对我有用；）

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-12-23T01:25:12.380

这可以帮助！

```
var blank = document.createElement("br");
    /*this creates a br(for a break) element dynamically */
myElement.appendChild(blank);
    /* myElement could be any HTML element like div , 
    span , img etc created dynamically , 
    var myElement = document.createElement("your element") */ 
```

您可以多次附加 br 以获得那么多空行。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2017-10-26T13:25:42.877

```
<body>
<table id="nadis">

</tr>
</table>

</body>

var numarray = ["1.1", "12.20", "151.12", 1000.23,12451.0733];
    var highetlen = 0;
    for(var i=0; i<numarray.length; i++){
        var n = numarray[i].toString();
      var res= n.split(".");
      n = res[0];

      if(highetlen < n.length){
        highetlen = n.length;
      }

    }

    for(var j=0; j<numarray.length; j++){
        var s = numarray[j].toString();
      var res= s.split(".");
      s = res[0];

        if(highetlen > s.length){
      var finallevel = highetlen - s.length;

      var finalhigh = "";
      for(k=0;k<finallevel;k++){
      finalhigh = finalhigh+ '&#160; ';
      }
        numarray[j] = finalhigh + numarray[j];
      }
      var nadiss = document.getElementById("nadis");
      nadiss.innerHTML += "<tr><td>" + numarray[j] + "</td></tr>";
    } 
```

# python - 使用多列的 Pandas DataFrame 聚合函数

> ID：10951341
> 
> 赞同：91
> 
> 时间：2012-06-08T15:01:32.727
> 
> 标签：python, pandas

有没有一种方法可以编写`DataFrame.agg`方法中使用的聚合函数，该函数可以访问多个正在聚合的数据列？典型的用例是加权平均、加权标准差函数。

我希望能够写出类似的东西

```
def wAvg(c, w):
    return ((c * w).sum() / w.sum())

df = DataFrame(....) # df has columns c and w, i want weighted average
                     # of c using w as weight.
df.aggregate ({"c": wAvg}) # and somehow tell it to use w column as weights ... 
```

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-06-09T22:07:32.317

是的; 使用该`.apply(...)`函数，该函数将在每个 sub- 上调用`DataFrame`。例如：

```
grouped = df.groupby(keys)

def wavg(group):
    d = group['data']
    w = group['weights']
    return (d * w).sum() / w.sum()

grouped.apply(wavg) 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-11-04T18:16:27.610

可以从 groupby 对象返回任意数量的聚合值`apply`。简单地说，返回一个系列，索引值将成为新的列名。

让我们看一个简单的例子：

```
df = pd.DataFrame({'group':['a','a','b','b'],
                   'd1':[5,10,100,30],
                   'd2':[7,1,3,20],
                   'weights':[.2,.8, .4, .6]},
                 columns=['group', 'd1', 'd2', 'weights'])
df

  group   d1  d2  weights
0     a    5   7      0.2
1     a   10   1      0.8
2     b  100   3      0.4
3     b   30  20      0.6 
```

定义将传递给的自定义函数`apply`。它隐式接受 DataFrame - 意味着`data`参数是 DataFrame。`agg`请注意它如何使用多个列，而groupby 方法无法做到这一点：

```
def weighted_average(data):
    d = {}
    d['d1_wa'] = np.average(data['d1'], weights=data['weights'])
    d['d2_wa'] = np.average(data['d2'], weights=data['weights'])
    return pd.Series(d) 
```

`apply`使用我们的自定义函数调用 groupby方法：

```
df.groupby('group').apply(weighted_average)

       d1_wa  d2_wa
group              
a        9.0    2.2
b       58.0   13.2 
```

如其他答案中所述，您可以通过将加权总数预先计算到新的 DataFrame 列中来获得更好的性能，并避免`apply`完全使用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-06-21T18:21:35.253

我的解决方案类似于 Nathaniel 的解决方案，只是它针对单个列，并且我不会每次都深度复制整个数据帧，这可能会非常慢。解决方案 groupby(...).apply(...) 的性能增益约为 100x(!)

```
def weighted_average(df, data_col, weight_col, by_col):
    df['_data_times_weight'] = df[data_col] * df[weight_col]
    df['_weight_where_notnull'] = df[weight_col] * pd.notnull(df[data_col])
    g = df.groupby(by_col)
    result = g['_data_times_weight'].sum() / g['_weight_where_notnull'].sum()
    del df['_data_times_weight'], df['_weight_where_notnull']
    return result 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-02-10T23:07:57.237

我经常这样做，发现以下内容非常方便：

```
def weighed_average(grp):
    return grp._get_numeric_data().multiply(grp['COUNT'], axis=0).sum()/grp['COUNT'].sum()
df.groupby('SOME_COL').apply(weighed_average) 
```

这将计算所有数字列的加权平均值`df`并删除非数字列。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-11-23T21:36:22.717

以下（基于 Wes McKinney 的回答）完全符合我的要求。我很高兴知道是否有更简单的方法可以在`pandas`.

```
def wavg_func(datacol, weightscol):
    def wavg(group):
        dd = group[datacol]
        ww = group[weightscol] * 1.0
        return (dd * ww).sum() / ww.sum()
    return wavg

def df_wavg(df, groupbycol, weightscol):
    grouped = df.groupby(groupbycol)
    df_ret = grouped.agg({weightscol:sum})
    datacols = [cc for cc in df.columns if cc not in [groupbycol, weightscol]]
    for dcol in datacols:
        try:
            wavg_f = wavg_func(dcol, weightscol)
            df_ret[dcol] = grouped.apply(wavg_f)
        except TypeError:  # handle non-numeric columns
            df_ret[dcol] = grouped.agg({dcol:min})
    return df_ret 
```

该函数`df_wavg()`返回一个按“groupby”列分组的数据框，并返回权重列的权重总和。其他列是加权平均值，或者如果不是数字，则该`min()`函数用于聚合。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-02-19T18:51:17.720

完成此通孔`groupby(...).apply(...)`是不合格的。这是我一直使用的解决方案（主要使用kalu的逻辑）。

```
def grouped_weighted_average(self, values, weights, *groupby_args, **groupby_kwargs):
   """
    :param values: column(s) to take the average of
    :param weights_col: column to weight on
    :param group_args: args to pass into groupby (e.g. the level you want to group on)
    :param group_kwargs: kwargs to pass into groupby
    :return: pandas.Series or pandas.DataFrame
    """

    if isinstance(values, str):
        values = [values]

    ss = []
    for value_col in values:
        df = self.copy()
        prod_name = 'prod_{v}_{w}'.format(v=value_col, w=weights)
        weights_name = 'weights_{w}'.format(w=weights)

        df[prod_name] = df[value_col] * df[weights]
        df[weights_name] = df[weights].where(~df[prod_name].isnull())
        df = df.groupby(*groupby_args, **groupby_kwargs).sum()
        s = df[prod_name] / df[weights_name]
        s.name = value_col
        ss.append(s)
    df = pd.concat(ss, axis=1) if len(ss) > 1 else ss[0]
    return df

pandas.DataFrame.grouped_weighted_average = grouped_weighted_average 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-05-08T16:13:48.910

这是一个具有以下好处的解决方案：

1.  您无需提前定义函数
2.  您可以在管道中使用它（因为它使用 lambda）
3.  您可以命名结果列

：

```
df.groupby('group')
  .apply(lambda x: pd.Series({
'weighted_average': np.average(x.data, weights = x.weights)}) 
```

您还可以使用相同的代码来执行多个聚合：

```
df.groupby('group')
  .apply(lambda x: pd.Series({
'weighted_average': np.average(x.data, weights = x.weights), 
'regular_average': np.average(x.data)})) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-22T17:45:04.183

您可以通过以下方式实现此功能：

```
(df['c'] * df['w']).groupby(df['groups']).sum() / df.groupby('groups')['w'].sum() 
```

例如：

```
df = pd.DataFrame({'groups': [1, 1, 2, 2], 'c': [3, 3, 4, 4], 'w': [5, 5, 6, 6]})
(df['c'] * df['w']).groupby(df['groups']).sum() / df.groupby('groups')['w'].sum() 
```

结果：

```
groups
1    3.0
2    4.0
dtype: float64 
```

# android - EditText 正确验证

> ID：10951347
> 
> 赞同：0
> 
> 时间：2012-06-08T15:02:02.043
> 
> 标签：android, regex, android-edittext

我想让 EditText 进行一些简单的验证。我希望它以逗号前 8 个符号和逗号后 2 个符号的格式获得十进制数。

我在这里找到了一些示例，但我无法弄清楚为什么它们不适合我。我试图设置 InputFilter，但我无法创建有效的正则表达式。

```
public class DecimalDigitsInputFilter implements InputFilter {

    Pattern mPattern;

    public DecimalDigitsInputFilter(final int digitsBeforeZero,
            final int digitsAfterZero) {
        mPattern = Pattern.compile("place for my regex");
    }

    @Override
    public CharSequence filter(final CharSequence source, final int start,
            final int end, final Spanned dest, final int dstart,
            final int dend) {

        Matcher matcher = mPattern.matcher(dest);
        if (!matcher.matches()) {
            return "";
        }
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:20:02.523

A`TextWatcher`可能是您的替代方案。看：

[Android TextWatcher.afterTextChanged 与 TextWatcher.onTextChanged](https://stackoverflow.com/questions/476848/android-textwatcher-aftertextchanged-vs-textwatcher-ontextchanged)

[http://www.androidadb.com/class/android/text/TextWatcher.java.html](http://www.androidadb.com/class/android/text/TextWatcher.java.html)

这样您就不必使用正则表达式，并且可以在显示更好之前检查文本。

# haskell - Haskell：非严格的布尔运算

> ID：10951353
> 
> 赞同：7
> 
> 时间：2012-06-08T15:02:25.053
> 
> 标签：haskell, lazy-evaluation

无论如何在Haskell中定义如下函数？

```
or True      True      = True
or True      undefined = True
or True      False     = True
or undefined True      = True
or undefined False     = undefined
or undefined undefined = undefined
or False     True      = True
or False     undefined = undefined
or False     False     = False 
```

我目前没有它的用​​例（尽管我会对它感兴趣），如果可能的话，我只是感兴趣。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-08T15:36:57.747

这在标准 Haskell 中是不可能的，但可以通过 Conal Elliott在[lub库中实现的不安全技巧来完成。](http://hackage.haskell.org/package/lub)

基本上，您编写两个函数：

```
orL True _ = True
orL False x = x

orR = flip orL 
```

然后您可以定义`or a b`为 and 的（`lub`关于“定义”顺序的最小上限）。`orL a b``orR a b`

在操作上，它并行运行两个计算并选择第一个成功的，杀死另一个。

即使按照您的建议工作，它也有重要的缺点。首先，`lub`只有当它的论点一致时才安全（除非底部相等）。如果你取`lub True False`，结果将是不确定的，从而违反了纯洁性！其次，在某些情况下，并行运行这两种计算的性能开销可能会变得很重要（`foldr or False`例如，尝试计算一个大列表的 a ！）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-08T15:06:25.177

根据您的评估顺序（检查值的顺序），您可以编写一个惰性版本：

```
Prelude> True || undefined
True
Prelude> undefined || True
*** Exception: Prelude.undefined

Prelude> :t or
or :: [Bool] -> Bool

Prelude> or [True, undefined]
True 
```

事实上，Haskell 中的默认定义会表现得像这样，因为 Haskell 是一种惰性语言。

但是，如果不先查看该值，就无法“跳过”未定义的值，这会将其评估为底部，这会导致您的表达式未定义。

请记住，惰性值是其中包含幽灵的礼物：

![在此处输入图像描述](../Images/bc89688b269052ea67aa26660c6e15ad.png)

如果你看看盒子里面，鬼可能会抓住你。

如果检查底部很重要（例如，作为测试套件的一部分），您可以将它们视为异常，[并拦截它们](http://hackage.haskell.org/package/ChasingBottoms)。但是你不会在纯函数中这样做。

# javascript - 使用 GruntJs 缩小脚本

> ID：10951354
> 
> 赞同：3
> 
> 时间：2012-06-08T15:02:25.117
> 
> 标签：javascript, minify, uglifyjs, gruntjs

我有几个 js 文件，我似乎可以让 GruntJs 正确地连接/缩小。

如果我单独做每一个，他们工作得很好。

如果我单独组合然后尝试仅缩小组合文件，它也不起作用。

这是错误：
![在此处输入图像描述](../Images/e79295d9891b3d43d9aba38bafae0bae.png)

有想法该怎么解决这个吗？或者可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T16:09:02.740

GruntJs 和我在 Derick 的回答的评论中提到的 BOM 目前存在问题。

你可以在这里找到问题：[https ://github.com/cowboy/grunt/issues/218#issuecomment-6329807](https://github.com/cowboy/grunt/issues/218#issuecomment-6329807)

在 Visual Studio 中手动删除 BOM

打开文件>文件>高级保存选项>将编码设置为“没有签名的Unicode”>“确定”应该将其删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T15:21:01.663

澄清并确保我理解：

*   您有 2 个单独的文件。我们称它们为 File1 和 File2
*   如果你自己缩小 File1，它工作正常
*   如果你自己缩小 File2，它工作正常
*   如果将 File1 和 File2 连接在一起，然后缩小，则会出现此错误

那是对的吗？

如果是这样，您可能在某处缺少分号，并且遇到了由 ASI（自动分号插入）引起的错误。

（请注意，这是基于您提供的有限信息的猜测。您需要发布有关文件、代码等的更多详细信息，才能真正给出更好的答案）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-26T10:33:10.263

在 File1 和 File2 的连接过程中，您需要添加一个**分隔符：';'** 在您的选择中

例如 ，

```
concat : {
             options : {
                  seperator  :';'
             },
             dist : {
                 src : [ 'path/to/src/*.js'],
                 dest :  'path/to/dest.js'
             }
   } 
```

# coldfusion - ColdFusion 8 - 插入重复的行

> ID：10951356
> 
> 赞同：0
> 
> 时间：2012-06-08T15:02:32.307
> 
> 标签：coldfusion, coldfusion-8

这是今天早上才开始的。我昨天工作的一个 CFC，它对表进行了简单的插入，开始插入重复的行（每个插入 2 行）。我删除了一堆无关的代码并简化了它和同样的事情。所以我只将 cfquery 移动到一个单独的页面，并硬编码为 3 个值 - 相同的东西 - 插入了 2 行。如果我将相同的查询复制并粘贴到 mysql 中，它会按预期工作 - 只插入一行。所以我为不同的表写了一个新的简单查询，它也在那里发生。

但是 - 我们系统中的其他页面/功能没有这样做。只是看似我创造的任何新事物，或者我昨天和今天早上正在做的事情。

MySQL 中的自动增量正在推进，我在其中放入了一个 datetime 列并用#now()# 填充它，这确实显示了行之间的时间戳略有不同。但是 - CF 调试器只显示一个插入查询，即使 CF 似乎触发了两次。

我已经重新启动了 CF 服务，但没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:44:23.643

简单来说，*$#$^!~@! 火狐。

浏览器中的某些东西似乎导致了这种情况。我将不得不进一步测试，但切换浏览器后一切恢复正常。

# haskell - GHC-api 和类型检查类约束

> ID：10951360
> 
> 赞同：4
> 
> 时间：2012-06-08T15:03:01.183
> 
> 标签：haskell, ghc, ghc-api

我正在尝试使用 ghc-api 构建一个简单的类似 ghci 的控制台。我已经到了可以提取`Type`'s 的表达式使用`exprType`和评估它们的地步。还有一种简单的方法可以检查表达式的类型是否具有给定类的实例？

编辑：似乎我正在寻找的功能需要一个`InstEnv`，但我不知道在哪里可以找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T01:42:33.903

该`isInstance`方法可以满足您的要求。

ghci 中的示例：

```
> :set -XTemplateHaskell
> import Language.Haskell.TH
> $(stringE . show =<< (isInstance ''Functor . (: []) =<< [t| [] |]))
"True"
> $(stringE . show =<< (isInstance ''Show . (: []) =<< [t| Maybe Int |]))
"True"
$(stringE . show =<< (isInstance ''Show . (: []) =<< [t| (Int -> Bool) |]))
"False" 
```

它的类型 sig 是

```
isInstance :: Name -> [Type] -> Q Bool 
```

`''`即，您为类命名（使用或使用函数检索`mkName`），然后传递类型以检查该类（如果该类是多参数类型类，则需要多个类型）。然后它将在 Q monad 中返回 True 或 False。

# mysql - HQL：计算集合中的空值

> ID：10951361
> 
> 赞同：0
> 
> 时间：2012-06-08T15:03:06.050
> 
> 标签：mysql, sql, hibernate, hql

我需要一个查询来计算某些实体（学生）的集合（Student.absences）中的空值（Absence.excuse）。

到目前为止，我设法创建了这个查询：

```
SELECT s, SUM(CASE WHEN a.excuse IS NULL THEN 1 ELSE 0 END)
    FROM Student AS s 
LEFT JOIN s.absences a 
WHERE s.class = :class 
GROUP BY s
ORDER BY s.ordinal 
```

这有效，但前提是学生已经在缺勤表中有一些缺勤（有或没有借口）。如果学生根本没有缺勤，则返回 1。但我不知道这怎么可能。如果没有缺席，它会将 a.excuse 评估为 NULL 吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:08:46.333

尝试

```
SELECT s, SUM(CASE WHEN (a.excuse IS NULL and a.id IS NOT NULL) THEN 1 ELSE 0 END) 
```

# database - ms访问数据库字符编码

> ID：10951364
> 
> 赞同：0
> 
> 时间：2012-06-08T15:03:12.913
> 
> 标签：database, ms-access

我有这个非常旧的访问数据库，当我正常打开它时，我没有得到正确的文本，只有一些乱码，能够读取内容的唯一方法是导出到文本文件，然后使用编码打开该文本文件“阿拉伯语 (Windows-1256)”

我如何永久修复该数据库（使用 access 2010）？

如何管理访问数据库字符编码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T16:11:18.940

唯一的方法是将每个数据库表导出到文本文件，然后更改文本文件编码，然后再次导入（在新的 MySql 数据库中）。

我找不到更直接的方法来做到这一点，但它奏效了。

# php - 使用 ISO 8601 日期转换的 php 字符串的可能原因增加了一小时

> ID：10951366
> 
> 赞同：1
> 
> 时间：2012-06-08T15:03:22.820
> 
> 标签：php, datetime, strtotime, iso8601

基本上我有这个：

```
$data_start = '2012-06-07T13:00:00Z';

if (($timestamp = strtotime($data_start)) === false) {
    return "The string ($data_start) is bogus";
} else {
    return "$data_start == " . date('l dS \o\f F Y H:i:s', $timestamp);
} 
```

它正在返回：

```
"Thursday 07th of June 2012 14:00:00" 
```

为什么 strtotime 又增加了 1 个小时！？与时区有什么关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:08:01.243

$data_start 上的最后一个 Z 表示日期为 UTC 时间。我想您当地的时区是 UTC +1 吗？

如果你想始终使用 UTC 时间，你可以使用类似的东西： date_default_timezone_set ('UTC') 绕过你的本地时区设置

# ado.net - 在 Hub-Spoke 架构中使用 SyncOrchestrator 可以吗？

> ID：10951370
> 
> 赞同：0
> 
> 时间：2012-06-08T15:03:38.813
> 
> 标签：ado.net, sync, microsoft-sync-framework

经过太多时间研究 Microsoft Sync Framework 和相关技术，我仍然不确定这个问题的答案……我可以在 Hub-Spoke 架构中使用 SyncOrchestrator 功能吗？基本上，我正在编写一个必须能够在“断开连接”模式下运行的客户端，因此它需要维护本地数据存储，并同步到中央数据库（不会发生点对点同步）。那么，SyncOrchestrator 适合这个吗？在客户端应用程序上使用 SyncAgent 似乎要容易得多，但是我不确定我是否正确使用它。

提前感谢您提供的任何建议。微软在这个领域有很多技术和技术版本，我有点头晕……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T11:54:47.840

是的，您可以在中心辐射或点对点方案中使用同步协调器。syncorchestrator 使用的较新的同步提供程序允许您灵活地移动集线器数据库，而无需重新初始化同步社区，并且在使用批量操作时还提供了更好的性能。

# windows-7 - 有没有办法让 Microsoft Speech SDK 只关注我以编程方式查找的命令？

> ID：10951371
> 
> 赞同：2
> 
> 时间：2012-06-08T15:04:03.633
> 
> 标签：windows-7, speech-recognition, sapi

在 Windows XP 中，语音 SDK 可以很好地与我们的应用程序配合使用，因为它没有尝试像在 Windows 7 中那样做。在 Windows 7 中，语音 SDK 尝试解释用户说出的每个命令并控制整个操作系统。

我们宁愿只关注我们的应用程序可以识别的十几个命令。

有没有办法通过关闭其他功能来只关注这些命令？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:21:30.537

您使用的是共享识别器还是进程内识别器？听起来您需要一个专用于您的应用程序的进程内识别器。请参阅[使用 System.Speech.Recognition 打开 Windows 语音识别](https://stackoverflow.com/q/6633521/90236)或[SAPI 和 Windows 7 问题](https://stackoverflow.com/questions/4213035/sapi-and-windows-7-problem)，这可能有助于指向其他信息。

从[System.Speech.Recognition 和 Microsoft.Speech.Recognition 有什么区别？](https://stackoverflow.com/q/2977338/90236)

> 桌面识别器旨在运行 inproc 或共享。共享识别器在使用语音命令控制任何打开的应用程序的桌面上很有用。服务器识别器只能运行 inproc。当单个应用程序使用识别器或需要识别 wav 文件或音频流（共享识别器无法处理音频文件，只能处理来自输入设备的音频）时，使用 Inproc 识别器。

# javascript - JS 对象字面量和 JSON 字符串有什么区别？

> ID：10951376
> 
> 赞同：5
> 
> 时间：2012-06-08T15:04:14.167
> 
> 标签：javascript, json

我对人们所说的 Object Literals、JSON、JavaScript Objects 的确切含义感到困惑，对我来说它们看起来很相似：

```
{foo: 'bar', bar : 'baz'} 
```

AFAIK，上面是对象文字，json以及javascript对象，不是吗？

对象字面量和 json 意思是一样的吗？

各位大佬怎么区分哪个是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T15:07:36.267

该变量`jsonString`包含一个 JSON 字符串：

```
var jsonString = '{"foo": "bar", "bar" : "baz"}' 
```

该变量`javascriptObject`包含一个使用对象字面量初始化的 javascript 对象：

```
var javascriptObject =  {foo: 'bar', bar : 'baz'} 
```

您可以使用 将 json 字符串转换为 javascript 对象[`JSON.parse`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/parse)，然后使用[`JSON.stringify`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/stringify).

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-08T15:11:15.320

**JSON**只是一种数据格式，类似于 XML。真正的 JSON 应该有用双引号括起来的键，如下所示：

```
{"foo":"bar"} 
```

**JavaScript 对象**是 JavaScript 语言的一部分，并且具有相关的东西，例如原型。

**对象字面量**是用括号创建一个 javascript 对象，而不是使用`new`关键字 or `Object.create()`。

```
//object literal
var foo = {};

//equivalent
var foo = new Object(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-08T15:07:32.913

> AFAIK，上面是对象文字，json以及javascript对象，不是吗？

它是一个对象字面量。它创建一个对象。

它不是 JSON，因为它不符合语法（它是对象文字符号的子集）。没有引用键，并且在值周围使用了错误类型的引号（`'`而不是）。`"`

> 你们如何区分哪个是什么？

语境。

JSON 通常不会出现（嵌入）在 JavaScript 程序的中间。它是一种数据格式，通常显示为整个文件（或 HTTP 响应）。

当某物需要一个对象时，它可以从对象文字或变量（或函数调用的返回值等）中获取一个。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-08T15:08:18.893

JSON 起源于 JavaScript 的对象文字表示法，它本身就是一个字符串。这解释了相似性，当只是看着它。今天，JSON 被用作序列化各种数据的通用手段，然后再通过某个网络提交或存储它。

```
// this is a JSON variable
var json = '{"foo": "bar", "bar" : "baz"}';

// obj is a JavaScript obj, defined by the object literal on the right hand side
var obj = {foo: 'bar', bar : 'baz'}; 
```

*   **JSON** - 序列化对象；类似于在 JS 中定义对象的语法
*   **对象字面**量 - 在 JS 中定义对象的简写语法
*   **对象**- 定义的结果，例如，对象字面量

在 JS 中，您可以使用以下方法将 JSON 字符串转换为对象

```
var obj = JSON.parse( json ); 
```

并通过以下方式获取对象（不包括附加函数）的 JSON 表示

```
var json = JSON.stringify( obj ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-08T15:05:29.933

根据[规范](http://json.org)，在 JSON 中，**所有**字符串，无论是值还是关键字，都应该用双引号括起来。

如果您的示例包含以下内容，它将是一个有效的 JSON 字符串：

```
{"foo": "bar", "bar": "baz"} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T15:52:29.700

**对象字面量：**

参考[Mozilla](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Core_Language_Features#Object_literals/)，

> 对象字面量是对象的零或多对属性名称和关联值的列表，用花括号 ({}) 括起来。

**Javascript 对象：**

参考[Mozilla](https://developer.mozilla.org/en/JavaScript/Guide/Working_with_Objects/)，

> 在 JavaScript 中，对象是一个独立的实体，具有属性和类型

**JSON：**

引用[mozilla](https://developer.mozilla.org/en/JSON)和[mozilla](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON)

> JSON（JavaScript Object Notation）是一种数据交换格式。它非常类似于 JavaScript 语法的一个子集，尽管它不是一个严格的子集。JSON 是一种用于序列化对象、数组、数字、字符串、布尔值和 null 的语法。它基于 JavaScript 语法但又有所不同：有些 JavaScript 不是 JSON，有些 JSON 不是 JavaScript。

***用松散的话说，***

An`object`是一个可以具有属性和类型的 javascript 变量。

An`object literal`是一种将属性和关联值分配给 的方法`object`。

JSON 更严格地`object literal`用于数据交换，它被包装为字符串。

（通常，严格性是允许所有语言使用它，我们不能`function`用作值，`key`应该始终用双引号引起来（在对象文字中它不是强制性的））

# objective-c - 单例属性不能在外部类中使用

> ID：10951377
> 
> 赞同：0
> 
> 时间：2012-06-08T15:04:23.303
> 
> 标签：objective-c, ios

我创建了一个名为“GCTurnBasedMatchHelper”的单例，它在标头中包含以下代码：

```
@property (nonatomic, retain) NSString *pick1; 
```

在实现中，我有以下几行：

```
#import "GCTurnBasedMatchHelper.h"
//Some implementation code in here...
@synthesize pick1;

- (void) pick{
int r = arc4random() % 2;
if (r==0) {
    pick1 =[[NSString alloc] initWithFormat:@"Askerer"];
    NSLog(@"%@", pick1);
} else {
    pick1 =[[NSString alloc] initWithFormat:@"Answerer"];
    NSLog(@"%@", pick1);
    }
} 
```

如何从另一个类实现 ViewController.m 访问 pick1 的值？以及如何从 GCTurnBasedMatchHelper.m 中的 ViewController.m 访问其他属性？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:08:16.490

您可以`ViewController.m`通过执行以下操作来访问 Singleton 类的属性：

```
[[GCTurnBasedMatchHelper sharedInstance] pick1]; 
```

假设，`-sharedInstance`您的 Singleton 的初始化方法是什么，即：

```
+(GCTurnBasedMatchHelper*)sharedInstance {

   //Singleton setup here

} 
```

棘手的一点是访问`ViewController.m`来自 Singleton 的属性。我建议为您的 Singleton 创建一个`Data Source`或`Delegate`返回您想要的属性。

```
 -(NSMutableArray*)viewControllerProperty {

        return self.myViewControllerPropertyArray;

  } 
```

假设`-viewControllerProperty`是`Delegate`您的单身人士的一种方法。在您的单例中，您现在可以`ViewController`通过从您的单例中调用它来访问类属性。

```
[self.delegate viewControllerProperty]; 
```

当然，我没有展示创建和/或设置委托，也没有展示其他明显的东西，比如@synthesizing。我认为您可以解决这个问题，因为它不在您的问题范围内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:10:41.833

首先，您在 View Controller 中导入文件：`#import "GCTurnBasedMatchHelper"`.

然后

```
NSString *string = [[GCTurnBasedHelper sharedHelper] pick1] //accessing the value of pick1 
```

你的逻辑也有错误。当你用 1 修改 (%) 一个数字时，你总是会得到 0。你应该用 2 来修改它（假设你希望两种结果都有 50% 的机会）。

# c# - 属性参数中的 Lambda

> ID：10951378
> 
> 赞同：4
> 
> 时间：2012-06-08T15:04:24.413
> 
> 标签：c#, .net, attributes, lambda

为什么我们不能添加一个 lambda 作为属性参数？例如我想做：

```
[MyAttribut(Transform= {object => object.ToSomethingElse()})] 
```

我应该明白 C# 中的 lambda 只是闭包吗？

编辑：通过查看所有答案，让我准确了解大多数人似乎不知道的一件事：Lambda 字面意思是编译时结构，除非它是一个闭包。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:06:39.510

属性的参数需要是编译时常量。

来自 MSDN -[属性参数类型](http://msdn.microsoft.com/en-us/library/ms177221.aspx)：

> 传递给属性的值必须在编译时为编译器所知。

它们也仅限于以下类型：

*   布尔
*   字符，无符号字符
*   短，无符号短
*   整数，无符号整数
*   长，无符号长
*   __int64，无符号 __int64
*   浮动，双
*   wchar_t
*   char* 或 wchar_t* 或 System::String*
*   系统::类型 ^
*   系统::对象 ^
*   枚举

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T15:07:42.790

属性参数仅限于以下类型的常量值：

*   简单类型（bool、byte、char、short、int、long、float 和 double）

*   细绳

*   系统类型

*   枚举

*   对象（对象类型的属性参数的参数必须是上述类型之一的常量值。）

*   上述任何类型的一维数组

[http://msdn.microsoft.com/en-us/library/aa288454%28VS.71%29.aspx](http://msdn.microsoft.com/en-us/library/aa288454%28VS.71%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-01T15:56:37.083

尽管您不能直接执行此操作，但您可以在运行时更新您的属性。

[请参阅我对Attribute Constructor With Lambda](https://stackoverflow.com/questions/11004909/attribute-constructor-with-lambda/26144418)问题的回答。

有一个代码示例演示了这个想法。这是我用来从资源中获取显示名称而无需复制名称以进行属性初始化的方法。我仍然必须确保资源文件中的名称匹配。为了帮助确保它保持同步，您可以进行单元测试，或者您可以创建一个使用多个 lambda 进行映射的系统（一个用于属性，另一个用于资源）...

# python - 使用许多（按名称等于）键进行查询

> ID：10951380
> 
> 赞同：0
> 
> 时间：2012-06-08T15:04:27.767
> 
> 标签：python, django, django-templates

例如，我有主键列表 [1,2,3,4] 我想做这样的事情：

```
Player.objects.order_by('-cup_points').exclude(pk=[1,2,3,4]) 
```

但参数必须是字符串或数字，而不是“列表”。我可以这样做吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T15:07:40.360

使用`__in`查找：

```
Player.objects.order_by('-cup_points').exclude(pk__in=[1,2,3,4]) 
```

请参阅：[https ://docs.djangoproject.com/en/dev/ref/models/querysets/#in](https://docs.djangoproject.com/en/dev/ref/models/querysets/#in)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-08T15:06:24.677

OP：“ .. 参数必须是字符串或数字，而不是'列表'。我可以这样做吗？”

是的，给定

```
li = [1,2,3,4]
', '.join(str(i) for i in li) 
```

产量：

```
'1, 2, 3, 4' 
```

一个字符串，可满足您将列表转换为字符串的需要，然后您可以在上面的方法中使用该字符串。

# linux - 有没有编译 Xen 源代码而无需修改系统的 Linux 发行版？

> ID：10951383
> 
> 赞同：0
> 
> 时间：2012-06-08T15:04:34.007
> 
> 标签：linux, virtualization, xen

是否有任何 Linux 发行版在全新安装后编译 Xen 4.1？

到目前为止，我已经尝试安装以下内容：

*   Ubuntu 12.04（使用依赖项编译良好，但 XM 等工具存在 Python 错误，因为 Python 将库安装在错误的目录中。在线建议的所有修复都不起作用）
*   Debian 6（需要修补和重新编译内核，我不想进入）

我需要它从源代码编译，因为我可能需要对部件进行修改。

有点不寻常的问题，但我希望有人知道这个问题的快速答案。非常感谢一些帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T22:11:43.470

它应该适用于 debian 测试。如果您使用 debian 准备好的源代码会更容易。

# javascript - 主干 MVC 视图不会在同步时更新

> ID：10951389
> 
> 赞同：0
> 
> 时间：2012-06-08T15:04:47.407
> 
> 标签：javascript, backbone.js, underscore.js

我一直在努力学习 Backbone。

我设置了模型集合，每个模型都有自己的视图，每次模型与服务器同步时都应该渲染。服务器发回模型的 ID。**它似乎在模型 ID 设置*之前***渲染。如果您查看 console.log() 输出，我让它在渲染之前打印模型的 id。我还让它在每个事件发生时打印它。我得到：

```
undefined (model id)
add
change:id
change (not sure what changes here?)
sync 
```

另外，我让它在 2 秒 pause 后更改模型的 name 属性`model.save('name', 'New Name')`。这会导致另一个同步事件，**但视图不会更新**。

这是工作代码：http: [//jsfiddle.net/flackend/brB7y/1/](http://jsfiddle.net/flackend/brB7y/1/)

或者在这里查看：

```
var game_library;

(function($) {

    _.templateSettings = {
        interpolate: /\{(.+?)\}/g
    };    

    var GameModel = Backbone.Model.extend({
        url: '/gh/gist/response.json/2895708/',
        name: undefined,
        initialize: function() {

            // Create a view for this model
            this.view = new GameView({model: this});

            // Sync model with server
            this.save();

            // Bind events
            this.on('sync', this.view.render());
            this.on('all', this.console);
        },
        console: function(event, model, changes) {

            console.log('['+ ++this.i +']-------------(event[:attr], model, changes)----------------');
            console.log(event);
            console.log(model);
            console.log(changes);
        },
        i: 0
    });

    var GameCollection = Backbone.Collection.extend({
        model: GameModel
    });

    var GameView = Backbone.View.extend({
        el: $('#holder'),
        template: $('#game-template').html(),
        render: function() {

            var template = _.template(this.template);
            console.log(this.model.id);
            this.$el.html(template(this.model.toJSON()));
        }
    });

    // Instantiate new game collection
    game_library = new GameCollection;

    // Add a game
    // Note: can only pass in 1 ID from gist, so only add 1 game.
    var games = [
        new GameModel({name: 'Skyrim'})
    ];

    // Note: `game_library.add(new GameModel({name: 'Skyrim'}));` does
    // not work for some reason having to do with instances...
    game_library.add(games);

    // 2 sec later...
    window.setTimeout(function() {

        game_library.get(1).save('name', 'The Elder Scrolls V: Skyrim');
    }, 2000);
})( jQuery ); 
```

感谢您的帮助！​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:22:57.430

删除那里的括号：

```
// Bind events
this.on('sync', this.view.render/*()*/);
this.on('all', this.console); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:30:39.467

[在http://jsfiddle.net/brB7y/2/](http://jsfiddle.net/brB7y/2/)更新了要点。我已将您的刷新调用移至有效的本地函数。我不确定这背后的技术原因，但这是我以前使用它的方式。

# c# - 在泛型中实现算术？

> ID：10951392
> 
> 赞同：16
> 
> 时间：2012-06-08T15:04:58.357
> 
> 标签：c#, .net, generics

[是否可以像使用 C++ 模板](http://nonchalantlytyped.net/blog/2010/04/24/church-numerals-in-c/)一样在 C# 泛型中实现基本算术（至少是加法）？我一直在尝试让它们正常工作，但 C# 不允许您多次声明相同的泛型类型，就像使用模板一样。

广泛的谷歌搜索没有提供答案。

编辑：谢谢，但我正在寻找一种在编译时进行算术运算的方法，在泛型类型中嵌入诸如 Church 数字之类的东西。这就是我链接我所做的文章的原因。泛型类型的算术*，*而不是泛型类型*实例的*算术。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T15:16:54.747

不幸的是，您不能对泛型类型使用算术运算

```
T Add(T a, T b)
{
    return a + b; // compiler error here
} 
```

在 c# 中不起作用！

但是您可以创建自己的数字类型并重载运算符（算术、相等和`implicit`, `explicit`）。这使您可以非常自然地使用它们。但是，您不能使用泛型创建继承层次结构。您将不得不使用非泛型基类或接口。

我只是用矢量类型做的。这里有一个缩短的版本：

```
public class Vector
{
    private const double Eps = 1e-7;

    public Vector(double x, double y)
    {
        _x = x;
        _y = y;
    }

    private double _x;
    public double X
    {
        get { return _x; }
    }

    private double _y;
    public double Y
    {
        get { return _y; }
    }

    public static Vector operator +(Vector a, Vector b)
    {
        return new Vector(a._x + b._x, a._y + b._y);
    }

    public static Vector operator *(double d, Vector v)
    {
        return new Vector(d * v._x, d * v._y);
    }

    public static bool operator ==(Vector a, Vector b)
    {
        if (ReferenceEquals(a, null)) {
            return ReferenceEquals(b, null);
        }
        if (ReferenceEquals(b, null)) {
            return false;
        }
        return Math.Abs(a._x - b._x) < Eps && Math.Abs(a._y - b._y) < Eps;
    }

    public static bool operator !=(Vector a, Vector b)
    {
        return !(a == b);
    }

    public static implicit operator Vector(double[] point)
    {
        return new Vector(point[0], point[1]);
    }

    public static implicit operator Vector(PointF point)
    {
        return new Vector(point.X, point.Y);
    }

    public override int GetHashCode()
    {
        return _x.GetHashCode() ^ _y.GetHashCode();
    }

    public override bool Equals(object obj)
    {
        var other = obj as Vector;
        return other != null && Math.Abs(other._x - _x) < Eps && Math.Abs(other._y - _y) < Eps;
    }

    public override string ToString()
    {
        return String.Format("Vector({0:0.0000}, {1:0.0000})", _x, _y);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T15:07:09.207

[如果我的回答似乎不合时宜，请随时提供更多说明。]

至少 C# 语言中的运算符没有通用约束。[正如 Jon Skeet 用Unconstrained Melody](http://code.google.com/p/unconstrained-melody/)证明的那样，约束实际上可能在 CLR 本身中完全有效。

您可以对约束做的最好的事情是提供接口/自定义类来公开您需要的操作。您将无法提供原语（除非您`implicit`可能还实现了运算符），但它至少可以让您为数学部分创建通用代码。

通用约束允许编译器根据最小公分母（由约束或缺少的指定）推断可用成员。大多数时候，泛型是不受约束的，因此只给你`object`语义。

* * *

*或者*，避免使用约束并使用`dynamic`来临时存储泛型变量，然后假设（通过鸭子类型）它具有相关的运算符：

```
class Program
{
    static void Main(string[] args)
    {
        var result = Add<int, long, float>(1, 2);
        Console.WriteLine(result); // 3
        Console.WriteLine(result.GetType().FullName); // System.Single
        Console.Read();
    }

    static T3 Add<T1, T2, T3>(T1 left, T2 right)
    {
        dynamic d1 = left;
        dynamic d2 = right;
        return (T3)(d1 + d2);
    }
} 
```

这涉及 DLR 并且会产生一些性能开销（我没有确切的数字），特别是如果您希望计算对性能至关重要。

* * *

我不确定你的意思是“多次声明相同的泛型”，这有效：

```
class Tuple<T1, T2> // etc.

var myTuple = new Tuple<int, int>(1, 2); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-17T06:51:15.953

朋友们，在 C# 中对此的直观答案是 RTTI 并从对象类来回转换

```
enter code here

class MyMath
{
    public static T Add<T>(T a, T b) where T: struct
    {
        switch (typeof(T).Name)
        {
            case "Int32":
                return (T) (object)((int)(object)a + (int)(object)b);
            case "Double":
                return (T)(object)((double)(object)a + (double)(object)b);
            default:
                return default(T);
        }
    }
}

class Program
{
    public static int Main()
    {
        Console.WriteLine(MyMath.Add<double>(3.6, 2.12));
        return 0;
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-03-07T11:02:45.473

是的，它可以通过使用动态类型变量来完成。

例子：

```
T Add(T value1, T value2)
{           
        dynamic a = value1;
        dynamic b = value2;
        return (a + b);
} 
```

更多参考请[点击这里](https://stackoverflow.com/questions/8122611/c-sharp-adding-two-generic-values)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-08-12T07:58:03.187

**它来了！**

查看此[.NET 博客文章](https://devblogs.microsoft.com/dotnet/preview-features-in-net-6-generic-math/)。

*从 .NET 6 开始，如果您愿意启用语言预览功能，*则可以启用对此的支持。这意味着无法保证该功能将在更高版本的框架（.NET 7+）中存在（或以相同的方式工作）。

如果您对此感到满意，请继续阅读以了解如何为您的项目启用此功能。您将能够使用接口，例如`INumber`并`IFloatingPoint`创建程序，例如：

```
using System;

Console.WriteLine(Sum(1, 2, 3, 4, 5));
Console.WriteLine(Sum(10.541, 2.645));
Console.WriteLine(Sum(1.55f, 5, 9.41f, 7));

static T Sum<T>(params T[] numbers) where T : INumber<T>
{
    T result = T.Zero;

    foreach (T item in numbers)
    {
        result += item;
    }

    return result;
} 
```

`INumber`目前来自`System.Runtime.Experimental`NuGet 包。我上面示例的项目文件看起来像

```
<Project Sdk="Microsoft.NET.Sdk">

    <PropertyGroup>
        <EnablePreviewFeatures>true</EnablePreviewFeatures>
        <OutputType>Exe</OutputType>
        <TargetFramework>net6.0</TargetFramework>
        <Nullable>enable</Nullable>
        <LangVersion>preview</LangVersion>
    </PropertyGroup>

    <ItemGroup>
        <PackageReference Include="System.Runtime.Experimental" Version="6.0.0" />
    </ItemGroup>

</Project> 
```

还有诸如`IAdditionOperators`和之类的接口，`IComparisonOperators`因此您可以通用地使用特定的运算符。

老实说，我已经等待了很长时间才能得到支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-09T07:44:05.473

*关于与和泛型的**算术`Enums`*相关的答案。

如果您正在专门寻找按位运算符（例如 '&', `|`），`^`将 with`Enums`用作通用约束；`IConveritible`除了作为约束之外添加是`System.Enum`一种可行的解决方法。

```
public static bool Contains<T>(this T container, T Value) where T : Enum, IConvertible
{
    return (container.ToInt32(null) & Value.ToInt32(null)) != 0;
}

public static T Insert<T>(this ref T container, T Value) where T : struct, Enum, IConvertible
{
    // this is slow and a proof of concept, not recommend for frequent use
    container = (T)Enum.ToObject(typeof(T), container.ToInt32(null) | Value.ToInt32(null));

    return container;
} 
```

# andengine - AndEngine 示例不起作用

> ID：10951393
> 
> 赞同：1
> 
> 时间：2012-06-08T15:04:59.810
> 
> 标签：andengine, augmented-reality, game-center, git-branch

我真的需要为我的应用程序使用这个示例： [https](https://github.com/nicolasgramlich/AndEngineExamples/blob/GLES2-AnchorCenter/src/org/andengine/examples/AugmentedRealityExample.java) ://github.com/nicolasgramlich/AndEngineExamples/blob/GLES2-AnchorCenter/src/org/andengine/examples/AugmentedRealityExample.java （尼古拉斯亲自建议我这样做），但它不起作用。我的意思是，我正在使用 GLES2-AnchorCenter 分支，但似乎不存在“SimpleBaseAugmentedRealityGameActivity”，所以我无法扩展它，并且在使用 import org.andengine.extension.augmentedreality.SimpleBaseAugmentedRealityGameActivity 时出现错误；

我究竟做错了什么？？谢谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T13:58:21.997

您需要将增强现实扩展的 jar 文件导入到项目的构建路径中。就个人而言，即使这样对我也不起作用，所以我只是将项目页面中的源代码[作为](http://code.google.com/p/andengineaugmentedrealityextension/)Java 类添加到我的应用程序中，之后一切都运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T10:57:27.017

使用检查 GLES2-AnchorCenter 分支

`git clone https://github.com/nicolasgramlich/AndEngineAugmentedRealityExtension.git -b GLES2-AnchorCenter`.

在 Eclipse 中将其添加为项目（我假设您对 AndEngine GLES2-AnchorCenter 分支执行相同操作）将在 bin 文件夹中为您自动构建 JAR 文件。您可以在项目中使用该 JAR 文件，因为它包含 SimpleBaseAugmentedRealityGameActivity 类。

# java - 使用标签打印机将 Java 打印到特定页面大小

> ID：10951394
> 
> 赞同：3
> 
> 时间：2012-06-08T15:05:08.300
> 
> 标签：java, printing, thermal-printer

我正在尝试使用标签打印机（具体来说是 EPSON TM-T88V）来吐出 PNG 图像。

我可以让它打印得很好，除非我打印图像尺寸（220x175，72dpi 再次具体）打印的图像顶部有一堆空白，我认为这是浪费纸张。

关于如何减少纸张浪费的任何想法？我希望它只打印图像，最小的空白，然后剪纸。

这是我的代码

```
 AttributeSet aset = new HashAttributeSet();
    aset.add(new PrinterName(printerName, null));
    /* locate a print service that can handle the request */
    PrintService[] services = PrintServiceLookup.lookupPrintServices(DocFlavor.INPUT_STREAM.PNG, aset);

    if (services.length >= 1) {
        /* create a print job for the chosen service */
        DocPrintJob pj = services[0].createPrintJob();

        DocAttributeSet das = new HashDocAttributeSet();
        das.add(PrintQuality.HIGH);
        das.add(MediaSizeName.ISO_A7); // I know the problem is here somewhere. This Media size seems to work best currently

        try {
            /* 
            * Create a Doc object to hold the print data.
            */
            Doc doc = new SimpleDoc(imageByteIs, DocFlavor.INPUT_STREAM.PNG, das);

            /* print the doc as specified */
            pj.print(doc, null);

        } catch (PrintException e) { 
            System.err.println(e);
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T20:56:34.777

您可以通过以下方式找到可用的纸张尺寸：

```
PrintService printService = PrintServiceLookup.lookupDefaultPrintService();
Media[] res = (Media[]) printService.getSupportedAttributeValues(Media.class, null, null);
for (Media media : res) {
    if (media instanceof MediaSizeName) {
        MediaSizeName msn = (MediaSizeName) media;
        MediaSize ms = MediaSize.getMediaSizeForName(msn);
        float width = ms.getX(MediaSize.INCH);
        float height = ms.getY(MediaSize.INCH);
        System.out.println(media + ": width = " + width + "; height = " + height);
    }
} 
```

找到最适合您的纸张尺寸的可用 MediaSizeName 后，只需将其添加到 MediaSizeName.ISO_A7 的位置即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T09:36:04.830

这是我用于在边距为 10 毫米的 A4 纸上打印的设置。

```
int width = Math.round(MediaSize.ISO.A4.getX(MediaSize.MM));
int height = Math.round(MediaSize.ISO.A4.getY(MediaSize.MM));
das.add(new MediaPrintableArea(10, 10, width-20, height-20, MediaPrintableArea.MM)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T22:06:12.383

添加一个[MediaPrintableArea](http://docs.oracle.com/javase/7/docs/api/javax/print/attribute/standard/MediaPrintableArea.html)：

```
das.add(new MediaPrintableArea(0.05, 0.05, 0.05, 0.05, MediaPrintableArea.INCH)); 
```

# android - android z-index问题

> ID：10951398
> 
> 赞同：1
> 
> 时间：2012-06-08T15:05:28.830
> 
> 标签：android, css

我们有一个正在尝试与 android 一起使用的 webapp，但遇到了 z-index 问题。我们正在使用带有大量自定义 javascript 的 asp.net。在 chrome、firefox、ie7、8、9 和 kindle 中一切都很好，但 android 似乎并不尊重我们动态创建的 div 上的特定 z-index。

所以我们有一个带有网格控件的模态对话框，当您选择一个网格项目时，它会显示一个带有按钮的菜单。这些都是div。因此，模态对话框 div 的 z-index 比所有其他页面 div 高，而菜单 div 的 z-index 最高。在 android 上，菜单 div 出现在模态对话框 div 下。

我已经尝试了很多方法来让这个菜单显示在模态对话框的顶部，例如在显示菜单后询问 z-index（这是正确的，所有绝对项的最高 z-index），分配一个新的显示后更高的 z-index，移动 div 的顺序等，似乎没有任何东西像在所有其他浏览器中那样将它放在对话框的顶部。

# c# - 将值从 Windows 窗体传递到控制台应用程序

> ID：10951401
> 
> 赞同：2
> 
> 时间：2012-06-08T15:05:42.153
> 
> 标签：c#, .net, soap, server-side

所以我有一个程序通过 Windows 表单接收用户凭据，现在通过 MessageBox 我正在显示用户输入，我想要做的是将它传递到我的控制台应用程序中，这样如果用户输入正确的凭据然后它在控制台应用程序中继续，我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:11:30.607

您可能需要添加一个 while 循环来在控制台应用程序中查找 txt 文件。在您的 Windows 窗体应用程序中，您可以将成功或失败消息写入 txt 文件。（为安全添加加密）当您写下控制台应用程序应该读取的信息并从那里继续时。

```
Algorithm:
1.console application start
2\. console app while loop until txt file detected
3\. forms app show input screen
4\. user enter credential
5\. write success or failure into txt file
6\. read txt file
7\. continue based on credential result
8\. Remove txt file 
```

由于表单也在控制台应用程序项目中（我从您的措辞中假设）您可以执行以下操作

```
class Program
{
    public static object abc;
    static void Main(string[] args)
    {
        //do something here if required
        Form1 frm = new Form1();
        if (frm.ShowDialog() == System.Windows.Forms.DialogResult.OK)
        {
            //login success do what ever on success
            Console.WriteLine("Login success");
            Console.WriteLine(abc.ToString());
        }
        else
        {
            Console.WriteLine("Login failure");
            Console.WriteLine(abc.ToString());
            //login failure
        }
        Console.ReadLine();
    }
} 
```

以及登录表单类中的登录按钮单击事件

```
 private void Login_Click(object sender, EventArgs e)
    {
        if(true)
        {
            Program.abc = "any success object here";
            //on successful login
        this.DialogResult= System.Windows.Forms.DialogResult.OK;
        }
        else
        {
            Program.abc = "any failure object here";
            this.DialogResult = System.Windows.Forms.DialogResult.Cancel;
        }
    } 
```

谢谢，

埃森

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:14:58.220

您可以在表单应用程序中托管 wcf 服务。然后使控制台应用程序成为客户端。使用 wcf 创建面向服务的系统非常容易。请参阅[此处](http://www.codeproject.com/Articles/16765/WCF-Windows-Communication-Foundation-Example)获取教程。如果您遵循这种方法，您将学到很多东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:19:04.057

使用 IPC（进程间通信）和命名管道。它很容易在两个进程之间实现，请查看[http://msdn.microsoft.com/en-us/library/bb546085.aspx](http://msdn.microsoft.com/en-us/library/bb546085.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:37:59.673

本质上，您可能必须使用一些本机 Windows API 函数（Alloc/FreeConsole）并使用 WinForms 控制器。

半伪代码：

```
[DllImport("kernel32.dll", SetLastError = true, CallingConvention = CallingConvention.Winapi)]
[return: MarshalAs(UnmanagedType.Bool)]
private static extern bool AllocConsole();

[DllImport("kernel32.dll", SetLastError = true, CallingConvention = CallingConvention.Winapi)]
[return: MarshalAs(UnmanagedType.Bool)]
private static extern bool FreeConsole();

//--- form code
if (Do_validation() && AllocConsole())
{
    this.Hide();
    this.ShowInTaskbar = false;
    Enter_Console_Code();
    FreeConsole();
    System.Threading.Thread.Sleep(50); //FreeConsole sometimes doesn't finish closing straight away which means your form flickers to the front and then minimizes.
    this.ShowInTaskbar = true;        
    this.Show(); 
}
//---

private void Enter_Console_Code()
{ 
    string line = string.Empty;
    while ((line = Console.ReadLine()) != "q")
        Console.WriteLine(line); //pointless code ftw!
} 
```

本质上，这段代码所做的是执行您的“GUI”验证步骤，然后如果成功，它会尝试为应用程序分配一个控制台。分配控制台后，它通过完全隐藏 GUI 并仅显示新控制台（关闭控制台顺便关闭应用程序）进入“控制台模式”。执行“控制台模式”代码，然后关闭控制台并返回 GUI。

# ajax - 为什么如果我在同一页面中有多个具有相同输入文件 ID 的表单，它只需要第一个 ID？

> ID：10951402
> 
> 赞同：0
> 
> 时间：2012-06-08T15:05:42.227
> 
> 标签：ajax

我在同一个文件中有多个表格，例如

```
<form name="myForm">
<input type="hidden" value="1" id="lastphp">
<a onclick="ajaxFunction()" class="folloo">
</form>
<form name="myForm">
<input type="hidden" value="2" id="lastphp">
<a onclick="ajaxFunction()" class="folloo">
</form>
<form name="myForm">
<input type="hidden" value="3" id="lastphp">
<a onclick="ajaxFunction()" class="folloo">
</form>
<form name="myForm">
<input type="hidden" value="4" id="lastphp">
<a onclick="ajaxFunction()" class="folloo">
</form> 
```

但是当我点击任何链接时，它总是采用第一个 ID 1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:51:23.233

ID 需要对页面唯一，因为它是该元素的键。

为什么不将 id="lastphp" 更改为 class="lastphp" 并将表单传递给函数？

```
<form name="myForm">
    <input type="hidden" value="1" class="lastphp">
    <a onclick="ajaxFunction(this.parentNode)" class="folloo">Test</a>
</form>
<form name="myForm">
    <input type="hidden" value="2" class="lastphp">
    <a onclick="ajaxFunction(this.parentNode)" class="folloo">Test</a>
</form>
<form name="myForm">
    <input type="hidden" value="3" class="lastphp">
    <a onclick="ajaxFunction(this.parentNode)" class="folloo">Test</a>
</form>
<form name="myForm">
    <input type="hidden" value="4" class="lastphp">
    <a onclick="ajaxFunction(this.parentNode)" class="folloo">Test</a>
</form> 
```

像这样处理它

```
function ajaxFunction(form) {
    var lastphp = form.getElementsByClassName("lastphp")[0].value;
    alert(lastphp);
} 
```

使用 jQuery 之类的框架可以轻松得多。

# objective-c - 我的类别的 +load 没有被调用，但仅在存档构建中

> ID：10951407
> 
> 赞同：1
> 
> 时间：2012-06-08T15:05:57.890
> 
> 标签：objective-c, ios

我正在开发一个静态库，其中包括为库外的类定义的几个类别。我使用`+load`类别上的方法来执行一些类初始化。这适用于调试和发布构建，但是当我为临时测试或应用商店分发构建和存档时，没有一个类别的`+load`方法被调用。

我正在将我的所有库和使用它们的应用程序与`-ObjC`and`-all_load`标志链接起来，就像我说的，在通过 Xcode 加载到设备上的调试和发布版本中，一切正常。只有当我通过 iTunes 加载存档版本时，我才会遇到问题。

有人知道可能出了什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:06:06.427

好吧，这看起来是由于 Xcode 4.3 中的一个错误造成的。当我使用 Xcode 4.2 编译时，一切正常。

# encryption - 使用 AES 使用弱密钥进行加密

> ID：10951409
> 
> 赞同：1
> 
> 时间：2012-06-08T15:06:05.353
> 
> 标签：encryption, cryptography, key, aes

我正在使用 AES 加密一些数据，问题是我必须使用仅包含 4 位数字的密钥（如密码），因此任何人都可以循环 9999 次来找到我的密钥并解密我的文本。我在这里加密的数据是一条短信。

有什么想法可以避免这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:13:52.170

编辑：删除了我关于添加盐的评论，指出这一点的每个人都是正确的。您也许可以增加解密的时间复杂度，这样暴力攻击将花费非常长的时间。

编辑：阅读：[https ://security.stackexchange.com/questions/6719/how-would-you-store-a-4-digit-pin-code-securely-in-the-database](https://security.stackexchange.com/questions/6719/how-would-you-store-a-4-digit-pin-code-securely-in-the-database)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T19:14:32.160

您可以采取与 ATM 机相同的方法：在某人输入错误的 PIN 三次后，该帐户暂时无效（您也可以设置一个沿用超时）并且该用户必须采取某种操作（例如单击一个电子邮件中的确认链接）以响应他/她的帐户。

您还必须使用该用户的唯一属性（最好是在该用户注册时随机生成的字符串）对 PIN 进行加盐。我还建议为所有硬编码或从配置文件读取的哈希添加额外的盐（如果您的数据库被破坏但其余部分没有被破坏，则很有用）。

这种方法仍然使您容易受到有人选择单个 PIN 并暴力破解用户名的攻击。您可以通过对 IP 地址应用相同的策略来对此采取一些对策，但这仍然远非最佳。

编辑：如果您的目标是加密流量而不是散列 PIN，您应该使用 HTTPS 或其他基于公钥加密的协议，这样您就不必使用您的 PIN 来加密这些 SMS。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T17:17:06.060

不，没有。您可以随心所欲地向 PBKDF 添加盐和迭代计数，但最终攻击者只有 10K 次尝试通过，这只是花生。

唯一明智的做法是让一个单独的实体执行解密。它可以将自己的秘密熵添加到密钥种子中，并使用强密钥。然后，该实体将对使用 PIN 的身份验证进行限制。

您可能想仔细查看*系统的安全架构*，看看是否可以更改某些内容来避免此问题（访问控制、其他登录凭据等）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:11:29.110

假设您只能输入 4 位数字，请使用发件人的电话号码或类似的东西在应用程序中填充密钥长度？

# jsf - 登录到 CSS 文件而不是实际的 JSF 页面后，容器管理的身份验证重定向

> ID：10951410
> 
> 赞同：0
> 
> 时间：2012-06-08T15:06:06.923
> 
> 标签：jsf, login, richfaces

我们在 JBoss 5.1 上有一个带有 RichFaces 3.3.3 的 JSF 1.2 应用程序。当我们重新启动服务器并在应用程序中首次登录时，我们将被重定向到以下 URL 上的空白页面

> [https://our.domain.com/a4j/s/3_3_3.Finalorg/richfaces/renderkit/html/css/extended_classes.xcss/DATB/eAF7sqpgb-jyGdIAFrMEaw__](https://our.domain.com/a4j/s/3_3_3.Finalorg/richfaces/renderkit/html/css/extended_classes.xcss/DATB/eAF7sqpgb-jyGdIAFrMEaw__)

它仅在重新部署和重新启动服务器后的第一次登录时发生。第二次登录，从那时起它工作正常。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:34:52.320

容器管理的身份验证将自动重定向到触发身份验证检查的第一个 HTTP 请求。

它重定向到 CSS 文件只能意味着实际页面是从浏览器缓存而不是直接从服务器请求的，而 CSS 文件是直接从服务器请求的，无论是完全还是通过条件 GET。

您需要解决 2 个问题：

1.  创建一个过滤器，告诉浏览器**不要**缓存受限页面。将此过滤器映射到与安全约束相同的 URL 模式。这样浏览器将永远不会从缓存中请求它们。这是通过在响应中设置以下标头来完成的

    ```
    response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1.
    response.setHeader("Pragma", "no-cache"); // HTTP 1.0.
    response.setDateHeader("Expires", 0); // Proxies. 
    ```

2.  从身份验证检查中排除 CSS/JS/图像等静态资源。在这些资源的 URL 模式上添加另一个允许所有安全约束，例如`/a4j/*`、`/resource/*`、`/static/*`等或您拥有的任何内容。这样，服务器将永远不会对这些请求进行身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:19:13.727

你能发布你的 web.xml 文件吗？如果可能，请尝试将丰富面孔 jar 中的 css 外部化。似乎在第一次加载 css 时出现了一些异常或者花费了太多时间。发布您的 web.xml

# authentication - SAML 身份提供程序与远程 Active Directory 域的互操作性

> ID：10951411
> 
> 赞同：0
> 
> 时间：2012-06-08T15:06:17.803
> 
> 标签：authentication, active-directory, saas, saml-2.0

我们有一个使用身份提供者基于 SAML 2.0 身份验证的 SaaS 系统，我们希望提供多种登录方式、表单身份验证、Facebook 等。理想情况下，是否可以使用 Active-Directory 将 SAML 系统连接到远程应用程序获得对 API 的访问权限，但最重要的是能够使用远程活动目录的身份验证作为登录 SaaS 系统的一种方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T14:34:00.157

查看 Ping Identity 中的 PingFederate 和 PingOne（注意：我为 Ping 工作）。我们拥有完整的 IDP**和**SP 支持（SAML1.1、2.0、WS-Fed（被动））以及对 LDAP、SFDC、OpenID 和其他云身份提供商（LinkedIn、Facebook 等）的支持。我们还通过 Oauth2 和 WS-Trust 支持 Web 服务安全性。

# python - Python - 按地址引用内存中的对象

> ID：10951416
> 
> 赞同：3
> 
> 时间：2012-06-08T15:06:28.203
> 
> 标签：python

这是一个愚蠢的问题，但我只是对此感到好奇。

假设我在 Python shell 中并且有一些要查询的数据库对象。我愿意：

`db.query(queryString)`

查询返回响应`<QueryResult object at 0xffdf842c>`或类似的东西。

但后来我说“哦！我忘了放`result = db.query(queryString)`，这样我才能真正使用我的查询结果！”

那么是不是有一些方法可以让我引用内存中的对象？

像`result = reference('<QueryResult object at 0xffdf842c>')`什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T15:08:27.857

你可以做：

```
>>> result=_ 
```

在外壳。`_`表示最后计算的对象。

例子：

```
>>> iter(range(10))
<listiterator object at 0x10ebcccd0>
>>> result=_
>>> result
<listiterator object at 0x10ebcccd0>
>>> list(result)
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

您还可以通过键入来查看对象的字符串表示形式（如果对象类型支持）`repr(_)`

# ios - 在 iOS 5 中隐藏 iAd

> ID：10951418
> 
> 赞同：1
> 
> 时间：2012-06-08T15:06:35.943
> 
> 标签：ios, ios4, ios5, iad

> **可能重复：**
> [如何隐藏 iAD](https://stackoverflow.com/questions/10909226/how-to-hide-iad)

我目前有一个场景，在用户不活动一定程度后，我必须显示 iAd。一旦它在不活动后出现，我想在用户活动一定时间后再次自动隐藏 iAD。如何在一定时间后强制关闭或隐藏 iAd？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:43:24.320

由于 iAd 基本上只是一个 UIView，您可以调用 setHidden 或更改 alpha。

您可以使用 performSelector:withObject:afterDelay 在一定时间后显示您的 iAd，如下所示：

```
[self performSelector:@selector(hideAd:) withObject:nil afterDelay:3] 
```

隐藏它也是如此。

# c++ - 当我拥有此 AD 域的管理员帐户时，如何模拟另一个域用户？

> ID：10951420
> 
> 赞同：0
> 
> 时间：2012-06-08T15:06:45.663
> 
> 标签：c++, active-directory, dns, impersonation, shared-directory

我正在开发一个 Windows 软件，当您输入域管理员帐户时，它可以显示域中的所有用户、组和共享文件夹信息。我在获取一些共享文件夹信息时遇到了一些麻烦，因为这些文件夹甚至没有向域管理员授予共享权限（删除共享选项卡中的每个人）。GetFileSecurity 或 GetNamedSecurityInfo 返回错误代码 5)。但是作为域管理员，我认为我可以访问我的域计算机中共享文件夹的权限信息（只是 ACL，不需要完全访问权限）。

我了解了以其他用户身份登录的模拟方法，如果我以在共享文件夹的共享选项卡中被授予读取权限的域用户身份登录，我可以成功获取 ACL。但这里的问题是，我不知道实际环境中域用户的密码，即使我知道他们的用户名并且可以更改他们的密码。

那么，当我已经拥有域管理员帐户时，如何获取域用户的访问令牌来模拟，或者还有其他方法吗？

我使用 C++ 和 ADSI 开发它。下面是登录和获取 NTFS 安全说明方法：

BOOL ADDirectorySearch::logOnByUserPassword(CString strDomainName, CString strUserName, CString strPassword) {

```
CString strFullUserName = strDomainName + _T("\\") + strUserName;
HANDLE hToken;
BOOL bResult;
bResult = LogonUser(strFullUserName, strDomainName, strPassword, LOGON32_LOGON_NEW_CREDENTIALS, LOGON32_PROVIDER_DEFAULT, &hToken);
if (bResult == FALSE)
{
    MyMessageBox_Error(_T("logOnByUserPassword Error."), _T("Error"));
    return FALSE;
}
else
{
    bResult = ImpersonateLoggedOnUser(hToken);
    if (bResult == FALSE)
    {
        MyMessageBox_Error(_T("logOnByUserPassword Error."), _T("Error"));
        return FALSE;
    }
    else
    {
        return TRUE;
    }
} 
```

}

PSECURITY_DESCRIPTOR ADDirectorySearch::getNTFSSecDescriptor2(CString strFileName, CString strServerName, CString strServerIP) {

```
//CString strServerNameWithSlash = _T("\\\\") + strServerName;//"\\\\veotax3";
CString strFilePathName = _T("\\\\") + strServerName + _T("\\") + strFileName;//"\\\\veotax3\\nrdc1001";
CString strFilePathName2 = _T("\\\\") + strServerIP + _T("\\") + strFileName;//"\\\\192.168.1.7\\nrdc1001";
_bstr_t bstrFilePathName = strFilePathName;

BOOL bSuccess = FALSE;
PSECURITY_DESCRIPTOR pSecDescriptorBuf = NULL;
DWORD dwSizeNeeded = 0;label2:;
   bSuccess = GetNamedSecurityInfoW(bstrFilePathName, SE_FILE_OBJECT, DACL_SECURITY_INFORMATION, NULL, NULL, NULL, NULL, &pSecDescriptorBuf);
   //bSuccess = GetFileSecurityW(bstrFilePathName, DACL_SECURITY_INFORMATION, NULL, 0, &dwSizeNeeded);
   if (ERROR_SUCCESS != bSuccess)
   {
       if (strFilePathName != strFilePathName2)
       {
           strFilePathName = strFilePathName2;
           bstrFilePathName = strFilePathName2;
           goto label2;
       }
       else
       {
           MyMessageBox_Error(_T("getNTFSSecDescriptor2 Error."), _T("Error"));
           return NULL;
       }
   }
   else
   {
        return pSecDescriptorBuf;
   } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T23:54:29.560

我读了你的另一个问题。我想我明白你想做什么。为了实现您的目标，您需要具有[模拟级别](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686632%28v=vs.85%29.aspx)“模拟”或“委托”的访问令牌。你可以通过不同的方式得到它。提供密码是最直接的方法。另一种方法是设置一台机器来进行[协议转换](http://msdn.microsoft.com/en-us/library/ff649317.aspx)。

我个人的建议是避免冒充。只需确保所有共享文件夹都已授予域管理员读取权限。正如我在另一个问题中所展示的，这根本不是安全妥协。如果愿意，域管理员始终可以通过某种方式读取文件夹。

[另外，仅供参考， SysInternals](http://live.sysinternals.com/)提供了一些现有的工具来做类似的事情。

从 SysInternals 查看 AccessChk.exe 和[AccessEnum.exe](http://live.sysinternals.com/)

他们都遭受与您现在面临的相同的权限问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T22:27:37.127

在创建包含配置文件或家庭驱动器的共享时忘记授予管理员访问权限是常见错误。权限通常由*CREATOR OWNER*驱动，而继承在此类共享中被破坏。管理员进入内部的唯一方法是**取得所有权**。取得所有权当然会给最终用户带来问题。在某些情况下，如果很清楚谁是特定文件夹的所有者（例如，文件夹名称等于用户帐户名称），您可以使用脚本获取所有权-> 设置管理员权限-> 将权限设置回收集的用户帐户名称从文件夹名称。如果您仍然感兴趣，我可以在这里发布代码

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-07T12:35:22.800

您不能也不应该“冒充”任何您没有密码的帐户 - 因此无权使用 - 因为即使您是管理员并且可以更改他或她的密码 - 除非明确授权。除非获得授权，否则您也不应该修改您不是其所有者的任何文件夹的权限。成为“管理员”并不意味着您是神一样的生物，并且您不受公司政策的约束。

这一切都与“问责制”有关——账户不仅要允许或拒绝访问，还要记录和审计谁做了什么，从而对谁负责。有一些法律要求可以要求识别和控制有权访问某种敏感信息的人 - 并限制可以访问这些信息的人数。Windows 具有审计用户操作的工具——包括文件访问。

这就是为什么 Windows 不允许您代表任何用户行事，除非明确允许 - 即使您是管理员。

也有充分的理由从文件夹中删除管理员的访问权限 - 管理员总是可以访问某些内容的事实并不意味着他或她可以这样做 - 未经许可这样做可能会给您带来麻烦。从（某些）管理员那里删除权限意味着您不能“错误地”访问未明确允许访问的文件。

在正确设置的系统中，日志也被发送到大多数管理员但具有高权限的管理员无权访问的不同机器 - 以确保执行和审核公司有关数据保护的政策，而管理员无法清除日志以隐藏其踪迹。

# java - xml 解析错误错误由于：解析错误：字符引用“�”是无效的 XML 字符，解组失败

> ID：10951421
> 
> 赞同：0
> 
> 时间：2012-06-08T15:06:51.837
> 
> 标签：java, xml, xml-parsing

> 块引用

解析器在 ¾Ë°Ú¾î¿° ¾ó¸¶³ª °Å¸±°Í°°¾Æ¿° 失败，消息 Unmarshaling failed due to :
Parsing Error :

```
Character reference "&#56227;" is an invalid XML character.

converted internally to &#65533;&#752;&#1726;&#61424; &#65533;&#56227;&#56755;&#65533; &#65533;&#376;&#65533;&#65533;&#880;&#65533;&#65533;&#447;&#65533; &#65533;&#65533; &#65533;&#65533;&#65533;&#65533; &#65533;&#1008;&#65533; &#65533;&#1460;&#176;&#65533;? by parser while parsing 
```

有效地在 ³ 字符上失败。

现在我的问题是我必须通过什么选择？我尝试将数据放入 cdata 部分，但仍然失败。
我在**jdk 1.4 中使用旧的 castor.jar 和 xerces.jar** ，我无法更改。添加更多详细信息 - 大文件中有 xml 数据，例如 ¾Ë°Ú¾î¿° ¾ó¸¶³ª °Å¸±°Í°°¾Æ¿°data> 现在使用 sax 解析器处理此文件。在 strartElement 上，我们再次开始收集数据，在 endElement 上，我们尝试使用

```
 Events dom = (Events) um.unmarshal(new StringReader(xmlChunk.toString())); 
```

正如您所知道的，此时数据将通过 sax 解析器有效地转换为实体，我们正在对数据进行编组，如上图所示。

我能够处理相同的文件，而无需更改 jdk 或 win7 框上的代码。它在内部将其转换为不同的字符实体。
在win7上处理时相同的代码工作正常！！！它内部正在改变的角色实体是-

```
converted internally to &#190;&#203;&#176;&#218;&#190;&#238;&#191;&#176; &#190;&#243;&#184;&#182;&#179;&#170; &#176;&#197;&#184;&#177;&#176;&#205;&#176;&#176;&#190;&#198;&#191;&#176; &#179;&#202; &#193;&#246;&#177;&#221; &#199;&#207;&#176;&#237; &#192;&#214;&#180;&#194;&#176;&#197;? by parser while parsing 
```

. 现在我在这里不知所措，这没有任何意义......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:36:04.747

假定的实体`&#56227;`是 Unicode 代理字符范围内的 DBA3。这意味着您的输入要么是 UCS-16 / UTF-16，要么是乱码。如果这是 UCS-16，那么字符实体表示是无效的 XML。XML 规范说：

> 字符 ::= #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]

和

> 使用字符引用引用的字符必须与 Char 的产生式相匹配。

* * *

更改 XML 解析器的平台不太可能解决此问题。

我会查看您用于处理输入文本（以确保您没有得到错误的字符编码）和生成字符引用的机制。创建后者时，您需要测试代理对“代码单元”，并将它们组合成代码点，然后从代码点生成字符引用。

* * *

另一件事是，如果您尝试使用 CDATA 的字符引用将二进制数据嵌入 XML 文档中......不要！它行不通。您必须将二进制数据转换为 Hex 或 Base64 或类似的东西，并将其嵌入*到*文档中。

# javascript - $(window).resize 和 $("#foo").scroll 上的触发函数

> ID：10951424
> 
> 赞同：0
> 
> 时间：2012-06-08T15:07:03.430
> 
> 标签：javascript, jquery

想在 $(window).resize 和 $("#foo").scroll 上触发相同的功能。

[http://jsfiddle.net/ySukf/1/](http://jsfiddle.net/ySukf/1/)

需要`#stick`贴在上面`#foo`。问题是`#stick`在滚动和调整窗口大小时 的位置有点跳跃。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:20:08.383

[这是一个解决方案](http://jsfiddle.net/vQKAt/1/)

首先，我们再添加两个容器——一个`.content`div inside`#foo`和一个`.inner`div inside `#stick`：

```
<div id="foo">
    <div class="content">
        <p>Lorem ipsum dolor sit amet.</p>
        <div id="stick">
            <div class="inner">stick</div>
        </div>
        <p>...</p>
    </div>
</div>​ 
```

请注意，`#anchor`它已经消失了。

容器的 css 被分成两半：

```
#foo {
    position: relative;
    margin: 50px auto;
    width: 200px;
    height: 200px;
}
#foo .content {
    width: inherit;
    height: inherit;
    overflow: auto;
} 
```

我们将以下内容应用于`#stick`. 内盒从外盒继承其大小。

```
#stick {
    width: 100px;
    height: 50px;
}
#stick .inner {
    width: inherit;
    height: inherit;
    background: pink;
}
#stick.stuck .inner {
    position: absolute;
    top: 0;
} 
```

几乎所有事情都在 css 中处理 - javascript 是：

```
$(document).ready(function() {
    $("#foo .content").scroll(stickyTop);
    $(window).resize(stickyTop);
});

function stickyTop() {
    //position is now relative to #foo
    if ($("#stick").position().top < 0)
        $("#stick").addClass('stuck');
    else
        $('#stick').removeClass('stuck');
}​ 
```

# vb.net - 使用 System.Net.Sockets SendFile 后检索数据

> ID：10951425
> 
> 赞同：1
> 
> 时间：2012-06-08T15:07:05.580
> 
> 标签：vb.net, sockets, sendfile

我正在 VB.NET 中编写一个简单的 TCP 客户端/服务器来传输各种大小的文件。我决定使用 System.Net.Sockets 的命令 SendFile 通过套接字传输字节。

在接收端，我检索字节的代码运行良好，但偶尔传输会随机停止。

我发现通过在检索下一个数据块之间设置一个小的睡眠延迟可以使传输 100% 稳定。

我检索数据的代码（直到没有可用数据）被简化为：

```
While newSocket.Available > 0
    Threading.Thread.Sleep(100)
    newSocket.ReceiveFrom(data, Remote)
End While 
```

我真的很讨厌使用睡眠延迟，并且认为必须有适当的方法/函数来从 SendFile 检索数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:16:50.640

Socket.Available 返回到目前为止已接收但尚未读取的字节总数。因此，如果您读取数据的速度快于数据的传入速度（这在慢速网络上很可能发生），即使客户端仍在发送数据，也不会再读取数据。

如果客户端为它发送的每个文件都与服务器建立新连接，您可以简单地将其更改为如下内容：

```
While newSocket.Connected
    If newSocket.Available > 0 Then
        newSocket.ReceiveFrom(data, Remote)
    End If
End While 
```

但是，我建议改用异步调用，例如 BeginReceive。然后，只要有要处理的数据，您的委托就会被调用，而不是在一个恒定的循环中等待。有关示例，请参见此链接：

[http://msdn.microsoft.com/en-us/library/dxkwh6zw.aspx](http://msdn.microsoft.com/en-us/library/dxkwh6zw.aspx)

# string - 在程序集上复制两个字符串

> ID：10951426
> 
> 赞同：2
> 
> 时间：2012-06-08T15:07:06.943
> 
> 标签：string, assembly, copy, masm, irvine32

## 这是复制 2 个字符串的代码

```
TITLE Copying a String (CopyStr.asm)
INCLUDE Irvine32.inc
.data
source BYTE "This is the source string",0
target BYTE SIZEOF source DUP(0)
.code
main PROC
mov esi,0 ; index register
mov ecx,SIZEOF source ; loop counter
L1:
mov al,source[esi] ; get a character from source
mov target[esi],al ; store it in the target
inc esi ; move to next character
loop L1 ; repeat for entire string
exit
main ENDP
END main 
```

* * *

移动 esi,0 ; 索引寄存器

为什么它假定索引将从 0 开始它是如何知道 SOURCE 的索引是 0 我认为它应该是

```
mov esi , offset Source 
```

？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:13:43.607

看一下

```
mov al,source[esi] ; get a character from source 
```

`esi`是“**扩展**源**索引****”**寄存器，它将偏移存储在源（字符串）中（有关 ESI/EDI 寄存器的更多信息，请参见[此处](https://stackoverflow.com/questions/1856320/purpose-of-esi-edi-registers)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:19:46.503

`source`在*.data*部分，这个符号是字符串的起始地址。**esi**寄存器存储从`source`地址开始的字节偏移量。**eax**寄存器的下半部分接收内存在基地址的内容加上**esi**`source`内的偏移量（0, 1, 2, 3, ... 随着循环的进行）。

# javascript - 在 Highcharts 上动画 div 非常慢

> ID：10951436
> 
> 赞同：0
> 
> 时间：2012-06-08T15:07:24.853
> 
> 标签：javascript, svg, highcharts

我正在编写一个使用 Highcharts 的应用程序，在一个实例中，我希望在图表底部有一个“滑块”，在图表上垂直向上延伸。移动滑块将根据用户在图表上移动滑块的位置更新页面的其他部分。

问题是当在 Highchart（图像或 div）上绘制任何东西时，性能变得绝对不可接受。滑块根本无法跟上鼠标的移动[请在此处查看 jsfiddle](http://jsfiddle.net/4ghhf/68/)。注意 - 这仅在处理大量数据点时发生（在我的情况下这绝对是不可避免的）。

除了不在图表顶部绘制之外，我能做些什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:42:55.880

我怀疑缓慢是因为当 div 滑过它时，浏览器必须重新绘制图表（无论是整体还是部分）。使用大量数据集来重新绘制图表，这变得非常缓慢。

有解决方案，但并非所有解决方案总是可以接受的：

*   您可以尝试通过以较低的速率对其进行采样来减少数据集中的点数。
*   您可以尝试开窗，以便查看器仅显示整个集合中的一个范围。例如，如果您有 10,000 个数据点，您的窗口可以沿着数据集滑动，一次只显示 1,500 个点，而不是全部 10,000 个点。
*   转向不同的技术，例如 Flash 或 Silverlight。

但是，就像我说的那样，并非所有这些甚至其中任何一个都对您有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T08:46:28.743

我注意到，当您在图表上拖动滑块时，它仍然会突出显示数据点。您可能应该在拖动滑块时在图表的该部分设置指针事件：无，这将允许浏览器不检查该子树中的指针事件（如果您有很多数据点可能会有些昂贵，特别是如果您在悬停时更新这些元素）。

# post - 使用 Backbone.js 发布到 Yii PHP 框架

> ID：10951443
> 
> 赞同：6
> 
> 时间：2012-06-08T15:07:41.683
> 
> 标签：post, backbone.js, yii, xmlhttprequest, csrf

我正在尝试使用 Backbone.js 模型保存到我的 Yii Web 应用程序，但即使模型是序列化表单并且我使用 Backbone.sync 设置标题，我也会收到“无法验证 CSRF 令牌”响应。

模型（表单中包含 CSRF 令牌并将其作为“YII_CSRF_TOKEN”属性发送）：

```
var v = new ModelName ($('.formclass').serializeJSON()); 
```

JSON序列化器：

```
 //form.serializeJSON
 (function( $ ){
 $.fn.serializeJSON=function() {
 var json = {};
 jQuery.map($(this).serializeArray(), function(n, i){
 json[n['name']] = n['value'];
 });
 return json;
 };
 })( jQuery ); 
```

骨干网.sync：

```
Backbone.old_sync = Backbone.sync;
     Backbone.sync = function(method, model, options) {
     var new_options =  _.extend({
         beforeSend: function(xhr) {
             console.log('backbone sync');
             var token = model.get('X_CSRF_TOKEN');
             console.log('token ='+token)
             if (token) xhr.setRequestHeader('YII_CSRF_TOKEN', token);
         }
     }, options)
        Backbone.old_sync(method, model, new_options);
 }; 
```

我也尝试将标题设置为“X_CSRF_TOKEN”，但无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T12:52:33.383

如果您在 localhost 上工作，您可能需要设置一个虚拟主机才能执行 cookie 身份验证，如此线程中所述：[this thread](http://www.yiiframework.com/forum/index.php/topic/26901-csrf-validation/page__p__129470__hl__enable+c+rf#entry129470)

IE 和 Chrome 不接受来自 localhost 的 cookie，这可能是原因

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-06T12:11:19.143

**YII_CSRF_TOKEN**不是标题，它只是一个表单值。根据[这一](https://github.com/yiisoft/yii/blob/1.1.12/framework/web/CHttpRequest.php#L967)行，我们的请求必须包含

*   一个 CSRF cookie，它已经由第一个非 XHR 页面加载设置
*   **名为YII_CSRF_TOKEN**的表单数据值

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T09:57:14.307

如果您使用 save() 发送数据，则必须在参数中发送 cookie 和会话 ID。请参阅此博客文章的缓存版本（因为它现在离线）：[http ://webcache.googleusercontent.com/search?q=cache:tML1kmL08ikJ:blog.opperator.com/post/15671431847/backbone-js-sessions-和-认证+&cd=1&hl=en&ct=clnk](http://webcache.googleusercontent.com/search?q=cache:tML1kmL08ikJ:blog.opperator.com/post/15671431847/backbone-js-sessions-and-authentication+&cd=1&hl=en&ct=clnk)**

# python - 如何迭代文件中的条目以创建具有唯一值的字典并计算可能多次出现的每个值的平均值？

> ID：10951445
> 
> 赞同：0
> 
> 时间：2012-06-08T15:07:43.473
> 
> 标签：python

我有一个看起来像这样的表：

```
id  value
AGA 0.211
AGA 0.433
AGA 0.123
AGH 0.002
DHI 0.063
DHI 0.193
DHI 0.004
KHI 0.543
KHI 0.064
HID 0.234 
```

对于每个 id，有时会有不同的值。我想计算每个 id 有多少个入口，每个 id 的平均值和值的总和，所以结果会是这样的：

```
id      cnt   sum   av
AGA     3     0.76  0.25
AGH     1     0.002 0.002
DHI     3     0.26  0.008
KHI     2     0.607 0.304
HID     1     0.234 0.234 
```

我认为最好先制作一本字典，在其中计算每个条目，但之后就卡住了，不知道是否最好将字典的值作为数组（带有cnt、sum和av）和然后使用Cnt的范围来计算，但想不出办法！这是我走了多远：

```
idDict = {}
for line in file:
    line = line.rstrip()
    f = line.split()
    id = f[0]
    idDict[id] = idDict.get(id, 0) + 1 
```

但是如果我已经在这里用cnt创建了字典，我不知道如何遍历每个id来进行sum和av计算:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:26:05.570

这是一种开始的方法[`defaultdict`](http://docs.python.org/dev/library/collections.html#collections.defaultdict)：

```
from collections import defaultdict

mylist=[('AGA' ,0.211), ('AGA' ,0.433), ('AGA' ,0.123), ('AGH' ,0.002), 
        ('DHI', 0.063), ('DHI' ,0.193), ('DHI' ,0.004), ('KHI' ,0.543),
        ('KHI' ,0.064), ('HID' ,0.234)]

mydict = defaultdict(list)
for key, val in mylist:
    mydict[key].append(val)

summary = {}
for key, val in mydict.items():
    summary[key] = len(val), sum(val), sum(val)/len(val)

print summary
#Output:
{'KHI': (2, 0.60699999999999998, 0.30349999999999999), 
 'HID': (1, 0.23400000000000001, 0.23400000000000001), 
 'AGA': (3, 0.76700000000000002, 0.25566666666666665), 
 'DHI': (3, 0.26000000000000001, 0.08666666666666667), 
 'AGH': (1, 0.002, 0.002)} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:39:14.287

由于您表中的数据似乎已排序，实际上没有必要先将所有内容放入字典中，但这可能会使事情更清楚。但我猜你的桌子可能会变得很大，所以第二次存储所有东西是一个资源杀手......

```
def sum_up(id, list):
    counted = len(list)
    summed = sum(list)
    avrg = summed/counted
    # print, insert or do whatever needed with the lines:
    print counted, summed, avrg

last_id = None
current = []
for line in file:
    (id, value) = line.split()
    if last_id != id:
        if last_id is not None:
            # evaluate last id
            sum_up(last_id, current)
            current = []
        # remember id
        last_id = id
    # append to current ids entries
    current.append(value)

# do the last id, if there is any:
if len(current) > 0:
    sum_up(last_id, current) 
```

我没有测试那个代码，但你应该明白了。它看起来有点复杂，但是当你有 >100k 行左右时，你应该会感觉到首先将所有内容加载到内存中然后处理它的不同之处

# c++ - 从文本文件加载 std::map

> ID：10951447
> 
> 赞同：7
> 
> 时间：2012-06-08T15:07:45.287
> 
> 标签：c++, map, text-parsing

这是一件非常简单的事情，所以我想保持它听起来很简单。我想要的只是从文件中加载一堆键值对，并将它们填充到地图中。我并不关心文本的结构，只要它易于阅读即可。

我现在拥有的是：

*   带有 xsd 生成代码的 xml（矫枉过正）
*   协议缓冲区（也是矫枉过正）
*   INI 样式文本文件

我喜欢 INI 文件的语法，但我不想为此编写解析器。在我看来，我会做很多人在我之前做过的事情。没有某种库可以读取这样的简单结构化文件吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T15:30:20.567

由于您似乎想要人类可能的最简单的东西，我将建议一些非常简单的东西，根据您的地图内容可能会或可能不会工作。如果您的地图数据值是包含空格的字符串，这将不起作用。如果它们是不带空格的字符串或数字，则您已设置。

这不是经过测试的代码，但它很接近且简单，因此即使它没有完全编译，你也应该没问题。只需将 KeyType 和 ValueType 更改为 int、string、float 或您在文件中实际使用的任何内容。

设置文件，如：

```
key value
key2 value2
key3 value3
key4 value4 
```

读起来像：

```
KeyType key;
ValueType value;

std::map<KeyType, ValueType> myMap;
while (infile >> key >> value)
    myMap[key] = value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:58:50.023

如果您在 MS 世界中，您可以使用

```
GetPrivateProfileSectionNames
GetPrivateProfileString
WritePrivateProfileString 
```

从ini文件或regestry中读取。如果要编写 Unicode，请确保新创建的文件获取 UTF16 的 BOM。

# java - JComboBox 中每个项目的多种颜色

> ID：10951449
> 
> 赞同：12
> 
> 时间：2012-06-08T15:08:03.917
> 
> 标签：java, swing, combobox, render

我正在尝试制作一个对不同项目使用不同颜色的 ComboBox。我写了一些测试代码，但它似乎不起作用。添加渲染器会导致程序崩溃，但将其注释掉会使框显示在框架中。

有什么我遗漏的还是我做错了？我尝试使用[自定义 ComboBox Renderer](http://docs.oracle.com/javase/tutorial/uiswing/components/combobox.html#renderer)教程作为示例。

这是我的代码：

**TestComboColor.java**

```
import java.awt.Color;

import javax.swing.JComboBox;
import javax.swing.JFrame;

public class TestComboColor {

    static Color[] colors = {Color.BLUE, Color.GRAY, Color.RED};
    static String[] strings = {"Test1", "Test2", "Test3"};

    public static void main(String[] args)
    {
        JFrame frame = new JFrame("JAVA");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JComboBox cmb = new JComboBox();
        ComboBoxRenderer renderer = new ComboBoxRenderer(cmb);

        renderer.setColors(colors);
        renderer.setStrings(strings);

        cmb.setRenderer(renderer);

        frame.add(cmb);
        frame.pack();
        frame.setVisible(true);
    }
} 
```

**组合框渲染器.java**

```
import java.awt.Color;
import java.awt.Component;

import javax.swing.JComboBox;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.ListCellRenderer;

public final class ComboBoxRenderer extends JPanel implements ListCellRenderer
{

    private static final long serialVersionUID = -1L;
    private Color[] colors;
    private String[] strings;

    JPanel textPanel;
    JLabel text;

    public ComboBoxRenderer(JComboBox combo) {

        textPanel = new JPanel();
        textPanel.add(this);
        text = new JLabel();
        text.setOpaque(true);
        text.setFont(combo.getFont());
        textPanel.add(text);
    }

    public void setColors(Color[] col)
    {
        colors = col;
    }

    public void setStrings(String[] str)
    {
        strings = str;
    }

    public Color[] getColors()
    {
        return colors;
    }

    public String[] getStrings()
    {
        return strings;
    }

    @Override
    public Component getListCellRendererComponent(JList list, Object value,
            int index, boolean isSelected, boolean cellHasFocus) {

        if (isSelected)
        {
            setBackground(list.getSelectionBackground());
        }
        else
        {
        }

        if (colors.length != strings.length)
        {
            System.out.println("colors.length does not equal strings.length");
            return this;
        }
        else if (colors == null)
        {
            System.out.println("use setColors first.");
            return this;
        }
        else if (strings == null)
        {
            System.out.println("use setStrings first.");
            return this;
        }

        text.setText(strings[index]);
        text.setForeground(colors[index]);
        text.setBackground(getBackground());
        return text;

    }

} 
```

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-08T15:39:05.083

你是这个意思吗？

![测试组合颜色](../Images/3fb6aeab7454db9ae379529d54d57ca6.png)

```
import java.awt.Color;
import java.awt.Component;
import javax.swing.*;

public class TestComboColor {

    static Color[] colors = {Color.BLUE, Color.GRAY, Color.RED};
    static String[] strings = {"Test1", "Test2", "Test3"};

    public static void main(String[] args)
    {
        JFrame frame = new JFrame("JAVA");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JComboBox cmb = new JComboBox(strings);
        ComboBoxRenderer renderer = new ComboBoxRenderer(cmb);

        renderer.setColors(colors);
        renderer.setStrings(strings);

        cmb.setRenderer(renderer);

        frame.add(cmb);
        frame.pack();
        frame.setVisible(true);
    }
}

class ComboBoxRenderer extends JPanel implements ListCellRenderer
{

    private static final long serialVersionUID = -1L;
    private Color[] colors;
    private String[] strings;

    JPanel textPanel;
    JLabel text;

    public ComboBoxRenderer(JComboBox combo) {

        textPanel = new JPanel();
        textPanel.add(this);
        text = new JLabel();
        text.setOpaque(true);
        text.setFont(combo.getFont());
        textPanel.add(text);
    }

    public void setColors(Color[] col)
    {
        colors = col;
    }

    public void setStrings(String[] str)
    {
        strings = str;
    }

    public Color[] getColors()
    {
        return colors;
    }

    public String[] getStrings()
    {
        return strings;
    }

    @Override
    public Component getListCellRendererComponent(JList list, Object value,
            int index, boolean isSelected, boolean cellHasFocus) {

        if (isSelected)
        {
            setBackground(list.getSelectionBackground());
        }
        else
        {
            setBackground(Color.WHITE);
        }

        if (colors.length != strings.length)
        {
            System.out.println("colors.length does not equal strings.length");
            return this;
        }
        else if (colors == null)
        {
            System.out.println("use setColors first.");
            return this;
        }
        else if (strings == null)
        {
            System.out.println("use setStrings first.");
            return this;
        }

        text.setBackground(getBackground());

        text.setText(value.toString());
        if (index>-1) {
            text.setForeground(colors[index]);
        }
        return text;
    }
} 
```

# jquery-ui - 使用多个字段值的 jquery-ui 自动完成

> ID：10951459
> 
> 赞同：0
> 
> 时间：2012-06-08T15:08:20.640
> 
> 标签：jquery-ui, jquery-ui-autocomplete

我有一堆字段（名字、姓氏等），我希望能够将任何已填充或部分填充的值传递给自动完成服务器端，以便我可以在查询中使用它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:08:22.683

我通过在关注各个字段的任何更改或自动完成“选择”事件上更新自动完成“源”来做到这一点。

```
jQuery('#people_new_user input[type="text"]').each(
    function(index, element) {
        var field = element.name;
        jQuery(element)
            .focus(setSourceUser)
            .autocomplete({
          source: "/cf/AutoComplete/People?current="+field,
          select: selectUser
        });
    }); 
```

上面的代码设置了一个名为“setSourceUser”的“focus”事件处理程序和一个名为“selectUser”的自动完成“select”事件处理程序。

```
function setSourceUser(event)
{
  var endPart = "";
  jQuery('#people_new_user input[type="text"]').each(
    function(index, ielement) {
      var ifield = ielement.name;
      var ival = ielement.value;
      if (ival != '')
      {
          endPart += '&field=' + ifield;
          endPart += '&value=' + ival;
      }
    }).each(
    function(index, element) {
      var field = element.name;
      jQuery(element)
                .autocomplete("option", "source", 
                    "/cf/AutoComplete/People?current="+field+endPart);
    });
} 
```

上面的“setSourceUser”函​​数从所有字段中获取所有值（在第一个“each”函数中）并为源构建一个“endPart”，然后为每个字段设置自动完成“源”选项。我不会显示“select”回调，因为它会执行与此问题无关的其他内容，然后调用“setSourceUser”。源最终类似于`/cf/AutoComplete/People?current=last_name&field=first_name&value=p&field=last_name&value=tomblin`自动完成本身提供的“术语”值。

在服务器端，我的函数（在这种情况下是用 Mason 和 Perl 编写的）在“LIKE”sql 语句中使用`&field=foo&value=bar`对（跳过其中 field == current 的那些，因为自动完成在 中传递了更当前的值）。`term`然后我以 JSON 格式返回找到的结果。（如果有超过 50 个结果，我不会打扰，因为列表会太长。）

```
% $r->content_type('application/json');
<% JSON::to_json( \@suggestions, { utf8 => 1, allow_blessed => 1,
    convert_blessed => 1, } ) |n %>
% $m->abort;
<%ARGS>
@field => undef
@value => undef
$current => undef
$term => undef
</%ARGS>
<%INIT>
use RTx::SearchBuilder::Records::Peoples;

$current =~ s/people_//g;

my $people = RTx::SearchBuilder::Records::Peoples->new(Handle => CFHandle());
my $fn = scalar(@field);
for my $i (0...$fn-1)
{
  my $f = $field[$i];
  next if !defined($f);
  my $v = $value[$i];
  if ($f ne $current)
  {
    $people->Limit(
        FIELD       =>  $f,
        OPERATOR    =>  'LIKE',
        VALUE       =>  '%'.$v.'%',
        ENTRYAGGREGATOR =>  'AND');
  }
}

$people->Limit(
    FIELD       =>  $current,
    OPERATOR    =>  'LIKE',
    VALUE       =>  '%'.$term.'%',
    ENTRYAGGREGATOR =>  'AND');

my @suggestions;

# If there are too many results, skip it and make them narrow it down a bit
# more
if ($people->Count < 50)
{
  while (my $person = $people->Next)
  {
    my $suggestion = { label => $person->$current, value => $person };
    push @suggestions, $suggestion;
  }
}
</%INIT> 
```

# jquery - Jquery删除特定类上方的项目

> ID：10951465
> 
> 赞同：1
> 
> 时间：2012-06-08T15:08:33.723
> 
> 标签：jquery

我有 3 页。每个都具有以下结构，但具有唯一的类：“**模块 a** ”或“**模块 b** ”或“**模块 c** ”。

仅当类为下面的“**模块 b** ”时，如何使用 JQuery **.body**和**.subtitle**删除。

 ****第 1 页：**

```
<section class="main">
   <h1 class="subtitle" />
   <div class="body" />
   <div class="module a" />
</section> 
```

**第2页：**

```
<section class="main">
   <h1 class="subtitle" />
   <div class="body" />
   <div class="module b" />
</section> 
```

**第 3 页：**

```
<section class="main">
   <h1 class="subtitle" />
   <div class="body" />
   <div class="module c" />
</section> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:12:31.237

像这样的东西？

```
$('.module.b')
  .prevAll('.body,.subtitle')
  .remove() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:12:11.770

尝试如下，

```
$('.module.b').siblings('.body, .subtitle').remove(); 
```

或者

```
$('.module.b').parent().find('.body, .subtitle').remove(); 
```

注意上面的意思是一个同时具有类和（2个类）`.module.b`的元素。`module``b`

如果`module b`您的意思是 1 类规则，那么在这种情况下应该像`module_b`上面那样替换`.module.b`为`module_b`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:12:05.803

```
$('.module.b').parent('.main').find('.subtitle, .body').remove(); 
```

我认为这应该可以解决问题！

希望有帮助:)**

# c# - JsonArray.Parse(...) 错误

> ID：10951466
> 
> 赞同：3
> 
> 时间：2012-06-08T15:08:34.647
> 
> 标签：c#, windows, json, windows-runtime, arrays

我正在为 Windows 8 开发一个新闻应用程序（在 C#、XAML 中）。[不幸的是，我在异步下载 JSON-Feed（通过http://jsonlint.com/](http://jsonlint.com/)验证）后遇到了一个奇怪的错误。下载成功，然后我想解析结果：`var items = Windows.Data.JsonArray.Parse(result);`.

当我运行代码时，出现以下错误：

`Invalid character at position 0.`和`Invalid JSON string.`

Json.JsonArray 是 Microsoft 的一个新库。我还尝试了 Newtonsoft 的 JSON 库，但出现了同样的错误。我究竟做错了什么？

这是完整的代码：

```
// Retrieve recipe data from Azure
var client = new HttpClient();
client.MaxResponseContentBufferSize = 1024*1024; // Read up to 1 MB of data
var response = await client.GetAsync(new Uri("http://contosorecipes8.blob.core.windows.net/AzureRecipes"));
var result = await response.Content.ReadAsStringAsync();

// Parse the JSON recipe data
var recipes = JsonArray.Parse(result.Substring(1, result.Length - 1)); 
```

此代码片段来自 Microsoft 动手实验室 (Contoso CookBook)。我也试过没有源中的“[”和“]”（没有效果）......

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T16:13:49.137

我可以使用以下方法下载并解析结果：

```
static async Task<JsonValue> DownloadJsonAsync(string url)
{
    var client = new HttpClient();
    client.MaxResponseContentBufferSize = 1024 * 1024;
    var data = await client.GetByteArrayAsync(new Uri(url));
    var encoding = Encoding.UTF8;
    var preamble = encoding.GetPreamble();
    var content = encoding.GetString(data, preamble.Length, data.Length - preamble.Length);
    var result = JsonValue.Parse(content);
    return result;
} 
```

响应中的 BOM 显然没有正确处理，这导致一个`'\xfeff'`字符在开始时杀死了解析器。剥离前导和解析读起来很好。否则，按原样解析它会抛出`FormatException`带有消息的 a：`Encountered unexpected character 'ï'.`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T18:08:06.070

稍作修改后，我就可以运行您的代码。UTF8 字符串的字节顺序标记似乎触发了来自 Windows.Data.Json 的 JsonArray.Parse() 问题。

在不使用额外编码的情况下解决它的一种方法是在 ReadAsStringAsync() 之后替换 BOM 字符，例如

```
result = result.Replace('\xfeff', ' '); 
```

或更好

```
if (result.Length > 1 && result[0] == '\xfeff'){
    result = result.Remove(0, 1);
} 
```

# sql-server - SQL Server BIDS 数据操作

> ID：10951468
> 
> 赞同：0
> 
> 时间：2012-06-08T15:08:41.663
> 
> 标签：sql-server, bids

我有一个 Excel 源和一个 OLE 数据库目标。对于列映射，我需要首先对列执行一些数据操作。

如何从要映射到目标列之一的源列中获取子字符串？

如何在我的一列上使用查找表来获取与查找表关联的值，然后将该值映射到我的目标列之一？

我想尽可能多地使用 C# 脚本。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:15:43.790

您可以使用派生列转换来获取源列的子字符串。

表达

```
 SUBSTRING(COLUMN_NAME,START,END) 
```

在派生列选项卡中选择添加为新行。然后在目标中映射此新列。对于查找转换，请参阅我对 SO 问题之一的回复 [查找转换](https://stackoverflow.com/questions/10944968/create-a-ssis-package-to-copy-data-from-oracle-to-sql-server/10945532#10945532)

为了在 C# 中执行此操作，将脚本组件拖到设计器上。选择输入和输出，然后添加一个新列（示例 NewColumn 作为名称）

```
 public class ScriptMain:UserComponent
  {

  public override CreateNewOutputRows()
  {
    int space = Row.SourceColumnName.IndexOf(' ');
  Row.NewColumn= Row.SourceColumnName.Substring(0,space)

  //If you need to retrieve the characters after second dot then
  //int firstDot=Row.Column.IndexOf('.')
  //int secondDot=Row.Column.IndexOf('.',firstDot+1)
 // Row.Newcolumn=Row.SourceColumnName.Substring(secondDot,Row.SorceColumnName.Length)
  }
  } 
```

# actionscript-3 - AS3游戏元素结构

> ID：10951469
> 
> 赞同：0
> 
> 时间：2012-06-08T15:08:45.787
> 
> 标签：actionscript-3, inheritance

我试图弄清楚如何最好地为我的游戏设置一种通用游戏元素类。我想尝试和创建的也是一个类似的结构..

GameElementPositionMovement（根类）->GameElementVisual（处理所有图形）->GameElementPersonality（处理游戏逻辑）

然后我希望能够通过创建 GameElementPersonality 的实例来设置不同的个性（怪物、英雄、图标等），但在它的构造函数中也能够设置视觉和定位/移动方面。

我在另一个问题中提到了这一点，然后回来的答案是......

> 您似乎需要一种“数据模型”类来存储逻辑和一个可视（“视图”）类。视觉类不应该从数据模型继承，它应该使用它。这是与 OOP 相关的问题：IS vs HAS（继承 vs 组合）

但我不确定我是否理解这一点。没有任何视觉数据的位置/运动，似乎是一个很好的第一个根类，然后添加视觉方面（GameElementVisual），最后添加个性“特征”（GameElementPersonality），如盔甲、伤害、健康等

因此，我将定位/运动、视觉和逻辑分开，并且我认为我所布置的层次结构将是做到这一点的最佳方式，但这不是一个好的方式吗？它应该更平坦吗？使用 GameElementPositionMovement，创建视觉和逻辑实例并将其存储在自身中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:39:31.213

您可以创建一个类似这样的结构：

（伪代码）
**元素数据**

```
//it doesn't have to extend any particular class
//however it would be nice if it could  dispatch events and register listeners
class ElementData implements IEventDispatcher
{
    public function ElementData() //constructor 
    {
        //do some stuff
    }

    public function setSomeProperty(value:int):void
    {
        //
    }

    public function doSomeCrazyStuff():void
    {
        //
    }
} 
```

**元素视觉**

```
class ElementVisual extends MovieClip //or just Sprite or even DiplayObjectContainer
{
    public function ElementVisual(elementData)
    {
        //constructor takes an instance of ElementData class

        elementData.addEventListener(CHANGE, onDataChange)

        elementData.doSomeCrazyStuff();
        if (userCliked)
        {
            elementData.setSomeProperty(15);
        }   

        //you can have here some interactions with user (keyboard, mouse)
        //then it can communicate with elenemtData and 'listen' what it says.
    }

    function onDataChange
    {
        //react accordingly
    }
} 
```

**一些视觉表现（你可能需要很多）**

```
class Monster extends ElementVisual
{
    //do all the graphic, animations etc
} 
```

然后您需要一个类来设置所有数据、视觉效果等……在最简单的实现中，它可以是“文档类”。

这不是一个合适的 MVC 模型——它是一个简单的例子，展示了将逻辑与可视化解耦的概念。

MVC 不是唯一的解决方案，还有其他所谓的“设计模式”可能有用......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:53:03.407

是的，MVC 的想法是保持事物解耦，在您的情况下，您最终会将所有内容粉碎到一个继承链中，您最终会得到一种类型的对象，该对象继承了另一个对象的所有属性，该对象继承了另一个对象的所有属性另一个对象，因此您将拥有一个代表一切的事物的实例，这就是为什么这不是一个很好的模式。

相反，如果您有一个 GameElementPositionMovement 类（您的主类），则创建一个 GameElementVisual 实例和 GameElementPersonality 实例（或多个实例，如果需要）。然后，任何时候在 GameElementPersonality 中对属性进行更改（或者如果您选择创建集合，则在集合中的任何属性）都可以调度事件，主类 GameElementPositionMovement 可以侦听调度的事件，并且当它获取时可以设置/传递GameElementPersonality 实例或数组到 GameElementVisual。然后在 GameElementVisual 中，您一直在处理基于当前模型的绘图，模型与视图逻辑分离，您可能还希望在单独的类或 GameElementPositionMovement 中处理控制。（控制是模型的修改，

通过这种方式，模型保持干净的控制逻辑和视图逻辑，它清楚地分开了什么去哪里，实际上只有视图类型取决于模型，控制器类型取决于视图，但是如果为模型建立了接口每个视图控制器都需要以这种方式相互通信，您可以用实现接口的新类替换任何这些部分（在小型游戏中不太可能出现问题，但设计有助于这种能力以及未来的可扩展性）。

# javascript - 在 HTML 表单中输入数字

> ID：10951471
> 
> 赞同：-5
> 
> 时间：2012-06-08T15:08:49.687
> 
> 标签：javascript, jquery

我在 HTML 中有 10 个小文本字段框，我希望用户在其中输入数字 1 到 10 - 相同的数字不能在另一个框中输入两次。我正在努力研究如何在 Javascript/jQuery 中实现这一点。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:18:53.407

只需使用值创建一个数组并检查是否重复。

```
var formdata=new Array(); 
formdata[0]=document.getElementByid('id').value;
formdata[1]=document.getElementByid('id').value;
formdata[2]=document.getElementByid('id').value; 
```

现在使用以下命令检查数组中的重复项 - 我想以下问题对堆栈溢出很有用： [在 JavaScript 数组中查找重复值的最简单方法](https://stackoverflow.com/questions/840781/easiest-way-to-find-duplicate-values-in-a-javascript-array)。如果断点是一个，只需向用户显示一个 alert() 以租用数据。

除了使用 documents.getElementById() 您还可以使用

```
oForm = document.forms[index];
oText = oForm.elements["text_element_name"].value; OR 
oText = oForm.elements[index].value; 
```

更多信息请访问： [http ://www.javascript-coder.com/javascript-form/javascript-get-form.phtml](http://www.javascript-coder.com/javascript-form/javascript-get-form.phtml)

# asterisk - 星号 + NAT。要么被叫要么被叫

> ID：10951472
> 
> 赞同：1
> 
> 时间：2012-06-08T15:08:50.173
> 
> 标签：asterisk, nat

我的 Asterisk 设置如下： - 我有 2 个 grandstream GXP 2000 电话连接到我的路由器 - 我的小型 linux 服务器（带星号）也连接到路由器

我有一个来自我的 isp 提供商的动态 IP，但我注册了 DynDNS

当我开始时，我可以打电话给人们并与他们交谈。如果有人给我打电话，电话就会响起，我可以听到他们说话。他们听不到我的声音。我发现这是因为 directmedia / canreinvite 设置。所以我把它设置为：

canreinvite=否 直接媒体=否

现在，人们可以打电话给我，我可以接听。但是，由于这种变化，我可以打电话给人们，但只要他们接听，我就听不到他们的声音，我只听到静电。当我删除我添加的两行时，一切都恢复了以前的样子。

可能是什么问题 ？5060 端口转发到我的服务器，以及 1000 - 2000 udp 响。

问候，数字

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T15:31:16.083

首先，您可能应该阅读 Asterisk 提供的 sip.conf.sample 文件。具体来说，请阅读 NAT 支持部分。canreinvite 和 directmedia（顺便说一下，它们的设置相同）尝试绕过 Asterisk 在涉及呼叫的 UA 之间直接设置 RTP 流。因此，虽然该设置受 NAT 影响，但它并不一定控制通道驱动程序相对于 NAT 的行为 - 因此您仍然遇到问题也就不足为奇了。

在不知道相关 UA 是否正在发送 rport 的情况下，很难确定您的设置应该是什么。话虽如此，根据您的问题描述，您可能希望将 [general] 部分中的 'nat' 参数设置为：

```
nat = force_rport,comedia
; or, depending your version
nat = yes 
```

请注意，您可以逐个对等地设置 nat，但出于安全原因，不鼓励这样做。

此外，您可能还需要探索 extern* 设置，例如 externhost。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T11:23:23.777

好的，为处于相同情况的其他人提供一些信息： - 检查您的编解码器，确保在 Asterisk CLI（命令行界面）中没有错误。我有错误，但它有效，所以我不在乎。这是一个错误 - 升级到星号 1.8 - 设置 directmedia = no - 它的更新范围为 10000 到 20000（我错过了 0）。

这一切都解决了这个问题。

# c# - 跨本地数据库使用 INSERT INTO

> ID：10951478
> 
> 赞同：2
> 
> 时间：2012-06-08T15:09:25.733
> 
> 标签：c#, tsql, exception-handling, ado.net, sql-server-express

警告：我是 C# 和 SQL 的新手（使用 C# 不到 2 个月，使用 SQL 不到 6 个月）

我已经为此工作了几天，我开始认为我在问不可能的事情。

我有两个本地数据库。第一个是从第三方接收数据的临时数据库。此数据采用 XML 格式，并且其中确实有重复记录。

我将数据插入 Temp 数据库，然后想使用 INSERT INTO.. 将唯一记录移动到 Final 数据库中。

我已经创建并测试了插入到 sql 中的内容，它可以正常工作。这是一个例子：

```
INSERT INTO Final.dbo.R_DATA
(C1, C2,..)
SELECT distinct     C1, C2, ...
FROM Temp.dbo.R_DATA
WHERE NOT EXISTS(Select *
FROM Final.dbo.R_DATA
WHERE (R_DATA.C1=Final.dbo.R_DATA.C1)) 
```

这行得通。我什至尝试为 Final.dbo.R_DATA 创建一个同义词，并在查询中替换它——再次在 SQL Express 中它也可以工作。我还设置了两个查询（有和没有同义词，作为存储过程，并且它们都在 SQL Express 中工作。

然后我尝试使用以下命令从 C# 运行相同的查询。

```
string sqlConnStr = @"DataSource=.\SQLEXPRESS;AttachDbFilename=W:\SQL\**Temp.mdf;Integrated Security=True;Connect Timeout=120;User Instance=True";
FileInfo SQLfile = new FileInfo(@"W:\SQL\MOVETEST.sql"); 
```

MOVETEST 是我正在尝试的 sql 脚本 - 我将上述查询转换为一个过程，然后将该过程放在 sql 中

```
string script = SQLfile.OpenText().ReadToEnd();
SqlConnection connection = new SqlConnection(sqlConnStr);
connection.Open();
Server server = new Server(new ServerConnection(connection)); 
```

我正在从一个表单中运行它——为了测试它是在一个按钮点击上，但我希望它成为一个更长的过程的一部分，当/如果我让它工作。这是为了让我看到连接是打开的

```
StatusMessage.AppendText(connection.ServerVersion + " " + connection.State);
server.ConnectionContext.ExecuteNonQuery(script);
connection.Close(); 
```

它在 server.ConnectionContect.ExecuteNonQuery(script); 错误发生 - 无论我尝试什么，我都会收到无效对象错误。我在想没有办法将数据从一个数据库中的表插入到另一个数据库中，或者我错过了什么。我想我可以通过以下方式完成这项工作：

1.  将 Temp.R_DATA 中的不同行提取到该 Temp db 中的新 tempR_DATA 表中。
2.  使用 bulkcopy 将整个 TempR_DATA 表移动到 dbo.FINAL
3.  连接到 dbo.Final 并在那里运行查询以从 FINAL.dbo.temp.R_DATA 插入 FINAL.dbo.R_DATA （使用 where not exists）。

但我真的很想避免所有这些读写，因为有些事情告诉我它会很慢。

那么我忽略了什么？欢迎任何和所有评论，我觉得这是一个概念问题（我如何尝试这样做）而不是语法等。

康拉德询问了确切的错误：

```
System.Data.SqlClient.SqlException was unhandled   Message=Invalid object name '**Final.dbo.RELEASE_DATA'.   Source=.Net SqlClient Data Provider   ErrorCode=-2146232060   Class=16   LineNumber=3   Number=208   Procedure=MoveRELEASE_DATA   Server=\\.\pipe\37E36041-6FB1-4D\tsql\query   State=1   StackTrace:
       at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
       at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
       at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
       at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
       at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async)
       at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
       at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
       at DataLoader.Imports.button2_Click(Object sender, EventArgs e) in c:\mydocs\visual studio 2010\Projects\PathFinder\PathFinder\Imports.cs:line 363
       at System.Windows.Forms.Control.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
       at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
       at System.Windows.Forms.Control.WndProc(Message& m)
       at System.Windows.Forms.ButtonBase.WndProc(Message& m)
       at System.Windows.Forms.Button.WndProc(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
       at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
       at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(IntPtr dwComponentID, Int32 reason, Int32 pvLoopData)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.Run(Form mainForm)
       at DataLoader.Program.Main() in c:\mydocs\visual studio 2010\Projects\PathFinder\PathFinder\Program.cs:line 18
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.Runtime.Hosting.ManifestRunner.Run(Boolean checkAptModel)
       at System.Runtime.Hosting.ManifestRunner.ExecuteAsAssembly()
       at System.Runtime.Hosting.ApplicationActivator.CreateInstance(ActivationContext activationContext, String[] activationCustomData)
       at System.Runtime.Hosting.ApplicationActivator.CreateInstance(ActivationContext activationContext)
       at System.Activator.CreateInstance(ActivationContext activationContext)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssemblyDebugInZone()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)        
   at System.Threading.ThreadHelper.ThreadStart()   InnerException: 
```

这是错误消息-相同-无效对象，每当我尝试跨数据库插入时都会收到此消息。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:15:00.630

此代码应该可以工作：

```
using (SqlConnection connection = new SqlConnection("DataSource=..."))
using (SqlComamnd command = connection.CreateCommand())
{
    command.CommandText = "INSERT INTO ...";

    connection.Open();
    int i = command.ExecuteNonQuery(); // number of rows inserted
} 
```

我还建议将查询包装在存储过程中。

# android - 未找到 ksoap2 HttpTransport 类

> ID：10951482
> 
> 赞同：2
> 
> 时间：2012-06-08T15:09:39.760
> 
> 标签：android, ksoap2

我在 Android 应用程序中使用 KSOAP2。

我找到了使用 HttpTransport 类的示例，但 eclipse 在 ksoap2-android-assembly-2.6.5-jar-with-dependencies.jar 中找不到它。

但是找到了 HttpTransportSE 类。

为什么我不能使用 HttpTransport 类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:23:50.200

首先检查 jar 文件是否正确包含在您的类路径中。

假设您的类路径设置正确并且 jar 文件已正确添加。然后将jar文件的扩展名从.jar更改为.zip，解压jar文件，然后检查HttpTransport类是否在zip文件中。

如果 jar 文件中没有类文件“HttpTransport.class”，那么它将无法在您的代码中找到。

# mysql - 这个 MySQL 语法有什么问题吗？

> ID：10951487
> 
> 赞同：1
> 
> 时间：2012-06-08T15:10:31.897
> 
> 标签：mysql, mysql-workbench

```
select 
    (`Setup` + `run` + `cleanup`) / `QNTY`
from 
    the_table 
where 
    date_field >= "2012-01-01" and
    Num = 4; 
```

每次我在 MySQL 工作台中执行此查询时，工作台应用程序都会立即崩溃。好像我以前做过很多次，不知道是什么问题。

我唯一能想到的是空值的问题。有时 ( `Setup`++ `run`)`cleanup`会返回 null，有时也会返回`QNTY`null。

我刚刚检查过，这个查询也会导致崩溃：

```
select 
    (`Setup` + `run` + `cleanup`) / `QNTY`
from 
    the_table
where 
    date_field >= "2012-01-01" and
    (`Setup` + `run` + `cleanup`) is not null and
    `QNTY` is not null and
    `QNTY` != 0 and
    Num = 4 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:17:12.493

我会尝试

```
select 
    (coalesce(Setup, 0) + coalesce(run, 0) + coalesce(cleanup, 0)) / QNTY
from 
    the_table
where 
    date_field >= '2012-01-01' and
    Num = 4 and
    coalesce(QNTY, 0) <>0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:25:43.653

看起来像评论中 Darkwater23 建议的工作台中的错误。我在旧的 MySQL 查询浏览器上进行了尝试，它使用 null 和零以及所有​​内容执行得很好。

# mysql - ExpressionEngine->要备份哪些表？

> ID：10951488
> 
> 赞同：4
> 
> 时间：2012-06-08T15:10:36.483
> 
> 标签：mysql, mysqldump, expressionengine

我们有一个部署过程，我们需要在将发布提交到我们的实时服务器之前创建一个“回滚”点。

我们有一个登台服务器，所有候选发布代码都在其中进行测试。现在这个登台服务器还包括在发布之前修改的所有频道数据、内容等。除了我们的全局变量之一 {site_url_https} 之外，这两个表是相同的副本

我们将在发布前创建生产服务器数据库的 mysqldump 以创建回滚点。然后，我们将创建暂存服务器数据库的 mysqldump 并将其应用到生产服务器的数据库以完成发布。

为了在应用发布之前提供回滚点，我需要备份哪些表？这应该包括对内容、频道数据、类别、自定义字段等的所有更改。我需要将哪些表从暂存服务器“复制”到生产服务器？

我有一个脚本来创建 SQL 备份文件，并将在测试后发布。

另外，我可以从脚本中调用一个函数来将模板表与模板文件同步吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T13:33:15.083

如果您不使用某些功能（如评论、条目版本控制等），其中一些可能没有实际意义。

要备份所有内容、类别和评论：

*   exp_category_posts
*   exp_channel_data
*   exp_channel_entries_autosave
*   exp_channel_titles
*   exp_comments
*   exp_relationships
*   exp_revision_tracker

备份字段/通道/类别结构和设置：

*   exp_categories
*   exp_category_field_data
*   exp_category_fields
*   exp_category_groups
*   exp_channel_fields
*   exp_channel_member_groups
*   exp_channels
*   exp_entry_ping_status
*   exp_entry_versioning
*   exp_field_formatting
*   exp_field_groups
*   exp_fieldtypes
*   exp_file_categories
*   exp_file_dimensions
*   exp_file_watermarks
*   exp_files
*   exp_layout_publish
*   exp_status_groups
*   exp_status_no_access
*   exp_statuses
*   exp_upload_no_access
*   exp_upload_prefs

要备份模板和相关：

*   exp_global_variables
*   exp_snippets
*   exp_specialty_templates
*   exp_template_groups
*   exp_template_member_groups
*   exp_template_no_access
*   exp_templates

备份会员相关数据：

*   exp_member_bulletin_board
*   exp_member_data
*   exp_member_fields
*   exp_member_groups
*   exp_member_homepage
*   exp_member_search
*   exp_members
*   exp_module_member_groups

要更一般地备份新模块、扩展、更改站点设置的安装：

*   exp_accessories
*   exp_actions
*   exp_extensions
*   exp_html_buttons
*   exp_modules

如果您使用的是 MSM：

*   exp_sites

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T14:53:35.913

这确实是一个问题，很大程度上取决于您正在开发/更新的网站类型。我通常会用来自 staging 的数据库覆盖整个生产数据库 - 但如果您有一个具有评论/或其他成员输入的站点，它会变得更加复杂。

# c# - PictureBox 不会出现 C#

> ID：10951492
> 
> 赞同：0
> 
> 时间：2012-06-08T15:11:01.260
> 
> 标签：c#, forms, picturebox

我正在尝试做一个逻辑门程序。我正在尝试`PictureBox`使用 NOT 类创建一个，问题是当我在 form1 中调用 create 方法时它不会出现，而`PictureBox`当我单击列表项时它不会出现。问题是（我认为）即使我使用该`FindForm()`方法，它也不知道它在 form1 中。并从表格中调用它

```
---Source Code for NoT class---

class NOT: Shape
{
    PictureBox px = new PictureBox();    
    Image img = Image.FromFile(@"C:\NOT.png");
    public NOT(int x, int y) : base(x,y)
    {
        px.FindForm();
        px.Visible = true;
        px.Enabled = true;

    }

    public override void CreatePicture()
    {
        Point p1 = new Point(xx, yy);
        px.Image = img;
        px.Location = p1;

        px.Show();      
    }
}

---Source code for the SHape Class---
abstract class Shape
{
    protected int xx, yy;    //private Point location;

    public Shape(int X, int Y)
    {
        xx = X;
        yy = Y;
    }

    public abstract void CreatePicture();
}
private void nOTToolStripMenuItem_Click(object sender, EventArgs e)
    {
        nt.CreatePicture();

    }
NOT nt = new NOT(12,23); 
```

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:16:38.570

您需要通过将图片框添加到表单控件集合来将其与表单相关联。调用`FindForm()`只返回当前分配的表格；在您的情况下，它将返回`null`。

```
public override void CreatePicture(Form form)
{
    Point p1 = new Point(xx, yy);
    px.Image = img;
    px.Location = p1;

    form.Controls.Add(px);

    px.Show();      
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:20:22.967

您必须添加图片框。例如，如果 PictureBox 在面板中：

```
panel.Controls.Add(); 
```

如果它是你刚刚输入的形式`Controls.Add();`

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:19:17.270

您必须将 PictureBox 放置到窗体中才能绘制它：

```
PictureBox px = new PictureBox();
....
px.Parent = YouFormForExample;//Component who is draw this picture box 
```

# entities - 我可以在没有危险的情况下切换使用“entities.SingleOrDefault”==>“entities.Find”吗？

> ID：10951494
> 
> 赞同：1
> 
> 时间：2012-06-08T15:11:11.177
> 
> 标签：entities, dbcontext

在我的 WCF 服务的业务逻辑中，大部分需要定位实体的地方，我都使用这种语法：

```
public void UpdateUser(Guid userId, String notes)
{
    using (ProjEntities entities = new ProjEntities())
    {
          User currUser = entities.SingleOrDefault(us => us.Id == userId);
          if (currUser == null)
               throw new Exception("User with ID " + userId + " was not found");
    }
} 
```

我最近发现`DbContext`有`Find`方法，我知道我现在可以这样做：

```
public void UpdateUser(Guid userId, String notes)
{
    using (ProjEntities entities = new ProjEntities())
    {
          User currUser = entities.Find(userId);
          if (currUser == null)
               throw new Exception("User with ID " + userId + " was not found");
    }
} 
```

注意：“userId”属性是表的主键。

我读到，当使用`Find`方法实体框架时，首先检查实体是否已经在本地内存中，如果是的话 - 从那里带来它。否则 - 访问数据库（相`SingleOrDefault`对于总是访问数据库）。

我想知道我现在是否将所有用途都转换为`SingleOrDefault`to`Find`是否有任何潜在危险？

`Find`如果我使用它从内存而不是数据库中获取数据，是否有可能获得一些尚未更新的旧数据？

如果我在内存中有用户，并且有人更改了数据库中的用户，会发生什么 - 如果我现在总是使用这个“内存”副本而不是**总是**从数据库中获取最新更新的副本，这会不会有问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T20:29:57.223

> *如果我使用 Find 并且它从内存而不是数据库中获取数据，我是否有可能获得一些尚未更新的旧数据？*

我想你已经在这里回答了你自己的问题。是的，使用`Find`您最终可能会返回与您的数据库不同步的实体，因为您的上下文具有本地副本。

在不了解您的具体应用的情况下，任何人都无法告诉您更多信息；您是长时间保持上下文活动还是打开它，进行更新并关闭它？显然，您保留上下文的时间越长，您就越容易检索到最新的实体。

我可以想到两种策略来解决这个问题。第一个在上面概述；打开你的上下文，做你需要的，然后处理它：

```
using (var ctx = new MyContext())
{
    var entity = ctx.EntitySet.Find(123);
    // Do something with your entity here...
    ctx.SaveChanges();
} 
```

其次，您可以检索实体的[DbEntityEntry](http://msdn.microsoft.com/en-GB/library/system.data.entity.infrastructure.dbentityentry%28v=vs.103%29.aspx)并使用该`GetDatabaseValues`方法使用数据库中的值对其进行更新。像这样的东西：

```
var entity = ctx.EntitySet.Find(123);

// This could be a cached version so ensure it is up to date.
var entry = ctx.Entry(entity);
entry.OriginalValues.SetValues(entry.GetDatabaseValues()); 
```

# css - 广告和媒体设备

> ID：10951500
> 
> 赞同：0
> 
> 时间：2012-06-08T15:11:51.997
> 
> 标签：css

在我的网页上，我有四列，我是普通电脑，广告看起来不错，但是当我在我的 iPhone 上将某些列放大并挤入其他列时。有谁知道如何在移动设备上保持列的大小相同. 该页面主要是HTML。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:16:44.223

轮到你了`scale`。您可以在 html 中使用它：

```
<meta name = "viewport" content = "initial-scale = 1.0, user-scalable = no"> 
```

这是有关此的更多信息：

[http://developer.apple.com](http://developer.apple.com/library/IOs/#documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html)

更新：

是的，有不同的方式来改变设计取决于设计。

例如，一种方法是：

```
<link type="text/css" rel="stylesheet" media="only screen and (max-device-width: 480px)" href="iPhone.css"> 
```

所以这个 css 只会占用你的手机，所以为此做不同的设计样式表。

同样的事情是：

```
@media handheld, only screen and (max-device-width: 480px) {
    /* overrides or style additions for iPhone */
} 
```

如果您不想创建新的 stylesheet.css ，假设您想更改 1,2 类。

但想法是一样的。

有 JS 方式，花药取决于你的项目应用程序做什么和构建

谷歌知道所有这些东西。

这是一篇对您有用的帖子：

```
http://stackoverflow.com/questions/3839809/detect-iphone-ipad-purely-by-css 
```

# c++ - 将对象从一个派生类更改为另一个

> ID：10951504
> 
> 赞同：3
> 
> 时间：2012-06-08T15:11:57.310
> 
> 标签：c++, polymorphism

我有几个类共享一个公共基类，只是它们的方法工作方式不同。所以在下面的例子中，加法器和乘法器是相同的，只是它们的计算方式不同。

有没有办法即时将“a”更改为乘数？我是否需要实现将派生类相互转换的方法？例如类似的东西

`a = a.asMultiplier()`?

正如您在下面的代码中看到的那样，我尝试将 reinterpret_cast 转换为乘数，但没有成功，它仍然像加法器一样工作。(gcc OS X v4.2.1)

```
#include <iostream>

class Base {
protected:
    int a,b;    
public:
    Base(int a, int b) {
        this->a = a;
        this->b = b;
    }  
    virtual ~Base() { }    
    virtual int calculate() = 0;
};

class Adder : public Base {    
public:
    Adder(int a, int b) : Base(a, b) {

    }      
    int calculate() {
        return this->a + this->b;
    }
};

class Multiplier : public Base {    
public:
    Multiplier(int a, int b) : Base(a, b) {    
    }  

    int calculate() {
        return this->a * this->b;
    }
};

int main() {

    Base* a = new Adder(3,4);
    Base* m = new Multiplier(3,4);

    std::cout << "Adder gives " << a->calculate() << std::endl;
    std::cout << "Multiplier gives " << m->calculate() << std::endl;

    a = reinterpret_cast<Multiplier*>(a);

    std::cout << "Now adder gives " << a->calculate() << std::endl;

    delete a;
    delete m;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T15:16:54.330

解决这个问题的最好方法是实现一个复制构造函数，采用基类：

```
class Multiplier : public Base {    
public:
    Multiplier(int a, int b) : Base(a, b) {    
    }  

    explicit Multiplier(const Base& iBase) : Base(iBase.a, iBase.b) {    
    }  

    int calculate() {
        return this->a * this->b;
    }
}; 
```

但由于我不是这里最先进的 c++ 开发人员，它可能不正确，或者其他人可能有更好的想法，只是尝试:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T15:15:09.217

我建议将对象的数据与其操作分离。这样，您可以轻松地从另一个对象构建一个对象，从而超越数据。因此，您的“转换”将如下所示：`Multiplier m = new Multiplier(a);`

在 C++ 中，按照您要求的方式进行操作是不可能的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-08T15:15:39.253

在我看来，您需要对数据进行操作的实用程序类：将您的基类更改为 Data 类，其目的只是存储数据并将数据显式传递给`Adder`等`Multiplier`类。

如果在上述重构之后有意义，您仍然可以在实用程序类中使用继承：在这种情况下，base 还将对 Data 对象进行操作，而不是 Data 本身

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-08T15:21:25.420

更改设计可能是个好主意。一般来说，当基类和派生类共享某种共性时，我会说使用继承是一个好主意，不仅在数据方面，而且在行为方面。虽然不是很有帮助的建议，但我建议您阅读一些有关面向对象设计原则的书籍。试图以你现在的方式转换类型真的没有意义。

# xml - 在 xslt 中使用 xpath 更新 xml

> ID：10951511
> 
> 赞同：1
> 
> 时间：2012-06-08T15:12:19.017
> 
> 标签：xml, xslt, xpath

我有一个 xml；我需要动态更新一些值。

例如：

```
 <School>
  <class name=1>
   <students>10</students>
   <teacher>3</teacher>
  </class>
  <class name=2>
   <students>102</students>
   <teacher>13</teacher>
  </class>
</School> 
```

在其他 xml 中的位置：

我将有 xpath 和相应的值例如：

```
 <data>
  <path>/school/class['name' = 1]/students</path><value>20</value>
 </data> 
```

所以当我通过 xslt 查询时

默认xml会被获取，数据相关的xml也会被获取，需要替换对应的值。

是否可以通过 xslt .. 来做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:16:54.540

XSLT 会将 XML 文档转换为另一种形式（包括另一个 XML 文档）。这通常是您执行此操作的方式，方法是创建一个发生一些转换的新输出文件。然后您可以删除旧文件并替换为新文件。

编辑：重新阅读您的帖子后，我想您还问是否可以处理两个 XML 文档作为 XSLT 的输入，答案是肯定的，您可以。看一下“document()”函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:13:01.343

首先，有几条评论：

1.  您的 XML 格式不正确（属性值应括在引号中）
2.  XPath 表达式`/school/class['name' = 1]/students`可能不会像您期望的那样做；) ... 谓词`'name' = 1`将字符串`'name'`与整数进行比较`1`并返回 false，这意味着您的表达式将始终返回一个空节点集。要选择 name 属性为 1 的类，你宁愿写：`/school/class[@name = 1]/students`

回到你的问题！

使用标准 XSLT 1 或 2，您无法执行动态 XPath 表达式。这在 XSLT 3.0 中应该是可能的，并且可能使用专有扩展（取决于您的处理器）来实现。

XQuery 之类的语言（及其更新工具）可能更合适（当然，如果您可以调整 XPath 表达式以符合 XQuery）。

如果您仍然需要使用 XSLT，我通常执行此类任务的方式是将生成 XSLT 转换作为第一步，然后将其作为第二步执行。

第一步本身可以是一个 XSLT 转换，它将在生成的 XSLT 转换中复制您的 XPath 表达式。运行第二步时，这些 XPath 表达式只是普通的静态 XPath 表达式......

# javascript - 在 ember.js 中将参数传递给 init

> ID：10951513
> 
> 赞同：21
> 
> 时间：2012-06-08T15:12:31.897
> 
> 标签：javascript, ember.js

如何将`init()`参数传递给或访问传递给ember.js`create()`内部的参数`init()`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-08T20:52:45.867

只需使用`this.get('theProperty')`

**例子：**

```
var data = {
    foo: "hello",
};

var MyModel = Em.Object.extend({
    init: function() {
        this._super();
        var foo = this.get('foo');
        alert(foo);
    }
});

MyModel.create(data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-02T15:46:15.760

使用闭包并创建一个新的 init 函数，将关闭的参数传递给它的原型 init 函数。此外，这样您最终不会覆盖敏感属性，例如方法。注意：在构造函数设置了所有属性之后调用 init

```
Class = Ember.Object.extend({
 init:function(response){
  console.log(this.get("msg")+this.get("msg_addressee")+"?");
  console.log(response);
 },
 msg:"SUP, "
});

var arg = "not much.";

obj = Class.create({
 init:function(){
  console.log("output:");
  this._super(arg);
  console.log("indeed, "+arg);
 },
 msg_addressee:"dude"
});

//output:
//SUP, dude?
//not much.
//indeed, not much. 
```

# excel - 计算 Excel 数据透视表总计的百分比

> ID：10951516
> 
> 赞同：4
> 
> 时间：2012-06-08T15:12:36.520
> 
> 标签：excel, pivot-table, percentage

我有包含阶段、团队和早期或晚期的 Excel 源数据。我创建了一个数据透视表来总结如下数据：

```
 Team 1               |  Team 2              |
Phase       Early | Late | Total | Early | Late | Total | Grand Total
---------------------------------------------------------------------
Phase 1       2       3      5       0       1      1          6
Phase 2       4       5      9       2       2      4         13
Phase 3       5       6     11       1       1      2         13
Grand Total  11      14     25       3       4      7         32 
```

我想计算总数的百分比（因此，团队 1 的总数除以团队 1 的总数 - 或 11/25 表示 44% 早，然后总迟到除以总数，或 14/25 56% 迟到）。

我尝试使用数据透视表下方的公式，效果很好，但如果源数据没有列中的记录，它们就会失控（因此，如果 Team 2 没有迟到的项目，该列就会消失）。是否有一种简单的修复方法或方法可以将数据透视表保持在一定数量的行或列？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T17:02:12.427

无需从数据透视表单独构建公式，您只需设置数据透视表即可直接计算百分比。这样您就不必担心数据透视表中有多少列和行。在 Excel 2010（2007 s/b 也一样）中，转到数据透视表工具功能区，然后在选项和计算下单击下拉显示值为并选择父列总计的百分比。

# sql - 为第一个主键列添加新条目时如何自动增加表中的第二个主键列

> ID：10951519
> 
> 赞同：3
> 
> 时间：2012-06-08T15:13:03.417
> 
> 标签：sql, sql-server

当为第一个主键列添加新条目时，我正在尝试找到一种方法来自动增加表中的第二个主键列。我想这里最好有一个例子，所以这里有。

假设我有一张桌子：

```
CREATE TABLE T
(
     SecNum INT NOT NULL,
     EntryID INT NOT NULL,
     Value FLOAT,
) CONSTRAINT [PK_T] PRIMARY KEY CLUSTERED 
(
    [SecNum] ASC,
    [EntryID] ASC
) 
```

我会运行以下语句：

```
INSERT INTO T (SecNum, Value) VALUES (0, 10) 
```

我的表应该如下所示：

```
SECNUM | ENTRYID | VALUE
-------------------------
   0         0       10 
```

我会运行以下语句：

```
INSERT INTO T (SecNum, Value) VALUES (0, 10) 
```

我的表应该如下所示：

```
SECNUM | ENTRYID | VALUE
-------------------------
   0         0       10
   0         1       10 
```

我会运行以下语句：

```
INSERT INTO T (SecNum, Value) VALUES (1, 20) 
```

我的表应该如下所示：

```
SECNUM | ENTRYID | VALUE
-------------------------
   0         0       10
   0         1       10
   1         0       20 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:38:21.203

这可以使用`INSTEAD OF`触发器：

```
CREATE TRIGGER TriggerName
ON T
INSTEAD OF INSERT
AS
    -- THIS TOP BIT IS OPTIONAL, IT WILL ALLOW ENTRY ID TO BE OVERRIDDEN IF 
    -- IT IS SUPPLIED TO THE INSERT AND WILL NOT VIOLATE THE PRIMARY KEY
    IF NOT EXISTS 
        (   SELECT  1
            FROM    T
                    INNER JOIN inserted i
                        ON i.SecNum = T.secNum
                        AND i.EntryID = T.EntryID
            UNION
            SELECT  1
            FROM    inserted
            WHERE   EntryID IS NULL
        )
        BEGIN
            INSERT T (SecNum, EntryID, Value)
            SELECT  SecNum, EntryID, Value
            FROM    inserted
        END
    ELSE
    -- IF OVERRIDE ABILITY IS NOT REQUIRED JUST USE THE BELOW INSERT
        BEGIN
            INSERT T (SecNum, EntryID, Value)
            SELECT  i.SecNum, COALESCE(LastID, 0), i.Value
            FROM    inserted I
                    LEFT JOIN 
                    (   SELECT  SecNum, MAX(T.EntryID) + 1 [LastID]
                        FROM    T
                        GROUP BY SecNum
                    ) T
                        ON T.SecNum = i.SecNum

        END 
```

[这里的例子](http://sqlfiddle.com/#!3/776ca/2)

**然而**，这不是很优雅。值得一问是否真的有必要？您能否摆脱使用代理主键并用于动态`ROW_NUMBER()`创建条目 ID 的情况？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:31:12.693

您的问题可以通过使用`instead of insert`触发器来解决

```
 create trigger Trigger1 on T INSTEAD OF INSERT
 as
 begin                                  
       insert into T(SecNum,EntryID,Value)
       select SecNum,
             (select count(*) from T where SecNum = i.SecNum) as EntryID, 
             value 
       from inserted i
 end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T19:54:34.910

像这样的东西怎么样：

```
INSERT INTO T (SecNum, Value, EntryId)
SELECT 0, 10, count(*)
FROM T WHERE SecNum = 0 
```

它不是最干净的解决方案，而且性能也很差。但它应该完成工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T20:04:01.607

这是如何在不将值存储在表中的情况下执行此操作（我不确定您为什么要存储它）

**桌子**

```
DECLARE @T TABLE
    (
      SecNum INT NOT NULL,
      EntryID INT,
      Value FLOAT
    ) 
```

**数据**

```
INSERT  INTO @T
        ( SecNum, Value )
VALUES  ( 0, 10 )
INSERT  INTO @T
        ( SecNum, Value )
VALUES  ( 0, 10 )
INSERT  INTO @T
        ( SecNum, Value )
VALUES  ( 1, 20 ) 
```

**询问**

```
SELECT  SecNum,
        ROW_NUMBER() OVER ( PARTITION BY value ORDER BY Value ) - 1 AS EntryID,
        Value
FROM    @T 
```

**结果**

```
SecNum  EntryID Value
0          0    10
0          1    10
1          0    20 
```

如果 EntryID 随 SecNum AND Value 发生变化，请使用以下查询：

```
SELECT  SecNum,
        ROW_NUMBER() OVER ( PARTITION BY Value,SecNum ORDER BY Value, SecNum ) - 1 AS EntryID,
        Value
FROM    @t 
```

**结果 2**

```
SecNum  EntryID Value
0           0   10
0           1   10
1           0   10
1           0   20 
```

# javascript - 在 Safari 手机上播放（和重播）声音

> ID：10951524
> 
> 赞同：7
> 
> 时间：2012-06-08T15:13:28.157
> 
> 标签：javascript, audio, mobile-safari

当网站上出现新消息时，我需要播放声音。它在 Chrome 和 Safari 上运行良好，但我无法在 Safari 移动设备上运行。我看到必须使用用户操作来初始化声音，所以我尝试了：

```
var sound = new Audio('./path/to/my/sound.mp3');
var hasPlayed = false;

$('body').bind('click touchstart', function() {
  sound.load();
});    

sound.addEventListener('play', function() {
  hasPlayed = true;
});

var playSound = function() {
  if(hasPlayed) {
    sound.currentTime = 0;
  }
  sound.play();
} 
```

不幸的是，声音仍然没有播放。我也尝试过使用[Buzz](http://buzz.jaysalvat.com/)库，问题是一样的。

所以，问题是：如何在移动浏览器上以编程方式播放声音？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-06T09:30:30.717

首先：iOS（5.01、5.1）上的 Mobile Safari 中的 HTML5 音频支持[相当有限](http://buildingwebapps.blogspot.fr/2012/04/state-of-html5-audio-in-mobile-safari.html)。但我设法让一些小的“事件类型”声音在我的 iPad 2 网络应用程序中工作。由于您只为您的应用程序讨论一个声音文件，因此您不必依赖音频精灵技巧（即将多个 MP3 合并到一个 MP3 文件中，并根据您想要的声音更改合并文件中的播放位置被播放）。

正如您所注意到的，您无法在 Mobile Safari 中自动播放音频，也就是说，如果用户没有点击某个元素。从技术上讲，音频必须在与单击事件相同的调用堆栈中**播放（而不是加载）。**但是，当 Mobile Safari 创建音频对象时，您可能会遇到 0.5 秒的延迟。这是解决此“问题”的方法：

*   在您的应用程序开始时（在加载/初始化时），向 HTML 文档添加一个单击处理程序，该处理程序会在用户单击/点击应用程序中的任何位置时立即开始播放您的音频文件。这将强制 Safari 开始加载音频。
*   监听音频准备好播放时触发的“播放”事件，并立即暂停。
*   现在在需要时再次开始播放音频（无延迟）。

下面是一些快速的 JavaScript 代码：

```
function initAudio() {
    var audio = new Audio('./path/to/my/sound.mp3');
    audio.addEventListener('play', function () {
        // When the audio is ready to play, immediately pause.
        audio.pause();
        audio.removeEventListener('play', arguments.callee, false);
    }, false);
    document.addEventListener('click', function () {
        // Start playing audio when the user clicks anywhere on the page,
        // to force Mobile Safari to load the audio.
        document.removeEventListener('click', arguments.callee, false);
        audio.play();
    }, false);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-18T20:41:52.880

对于那些遇到这个问题并且 Jeroen 的解决方案在这里不起作用的人来说，这是一个有效的解决方案，并确保正确执行正确的范围界定。

确保在页面加载时调用 initAudio。即在您的 Init 函数或 document.ready ($(function(){});) 中的 jquery

```
function initAudio(){
    var audio = new Audio('./path/to/my/sound.mp3');
    var self = this;
    //not sure if you need this, but it's better to be safe
    self.audio = audio;
    var startAudio = function(){
                         self.audio.play();
                         document.removeEventListener("touchstart", self.startAudio, false);
                     }
    self.startAudio = startAudio;

    var pauseAudio = function(){
                         self.audio.pause();
                         self.audio.removeEventListener("play", self.pauseAudio, false);
                     }
    self.pauseAudio = pauseAudio;

    document.addEventListener("touchstart", self.startAudio, false);
    self.audio.addEventListener("play", self.pauseAudio, false);
} 
```

# c# - 我可以在 WinForms 窗格中使用 OpenFileDialog 吗？

> ID：10951526
> 
> 赞同：2
> 
> 时间：2012-06-08T15:13:40.390
> 
> 标签：c#, winforms, openfiledialog

有没有办法在我的 WinForms 窗体的窗格中获取 OpenFileDialog？

我想制作一个 2 窗格的“打开文件对话框”，在一个窗格中我收集在另一个窗格中选择的文件，该窗格可以在文件夹之间浏览。我知道，我可以自己滚动它，但是如果我可以使用 OpenFileDialog 作为一个组件来插入它会更容易......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:23:17.063

只要付出足够的努力，你几乎可以做任何事情，但我会在这个问题上选择“不”。它从来没有打算做你想做的事情，而且无论如何都不太适合你的范式。滚动你自己的或寻找某人已经创建的东西，我会说......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:21:43.540

没有办法将 OpenFile Dialogue 控件**放入**Winforms。唯一的选择是使用自定义控件或为自己设计一个。它非常简单，为左侧窗格中的文件夹创建一个树视图，为文件创建一个列表框右窗格。

# c# - 对 C# 处理程序的 AJAX 请求以使用 ActiveDirectory 进行身份验证

> ID：10951530
> 
> 赞同：0
> 
> 时间：2012-06-08T15:14:04.140
> 
> 标签：c#, ajax, security, authentication, active-directory

所以我正在使用 jQuery Mobile 开发一个移动网络应用程序，我需要从应用程序的远程服务器请求一些数据。我从 C# SOAP Web 服务或从`IHttpHandler`返回 JSON 的服务中获取数据。在返回任何数据之前，我需要以某种方式通过 Web 服务/处理程序进行身份验证。我希望使用 ActiveDirectory，并通过 AJAX 请求以某种方式将用户名和散列密码传递给服务器。问题是，在 C# 中使用 ActiveDirectory 进行身份验证的示例涉及将纯文本用户名和密码传递给`PrincipalContext.ValidateCredentials`. 有什么方法可以安全地将凭据传递给 C# 服务并让它通过 AD 进行身份验证，而无需知道纯文本密码？

**编辑：**我想也许我可以在客户端散列密码，将其传递给服务器，让服务器获取所请求用户的 AD 密码并以相同的方式对其进行散列，然后进行比较，但[无法获取 AD 密码](https://stackoverflow.com/questions/6009768/getting-the-password-of-a-user-from-active-directory)。

**编辑：**查看[aSSL](http://assl.sullof.com/assl/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:00:04.860

如果您正在使用 jquery ui 开发移动网络，它不会存在于设备上，它将存在于您的网络服务器上（iis，如果它是一个网络应用程序）。您的应用程序可以使用 Windows 身份验证针对它需要查询的服务进行身份验证，但这取决于用于运行应用程序的用户/在您这边使用的模拟。
问题是您的应用程序和此服务如何在它们和互联网之间进行通信。如果互联网无法访问该服务，我不知道您应该担心多少安全传输。
您还可以查看基于 ad fs / ad fs 2 的安全解决方案和 wcf 集成选项，例如[此处](http://blogs.msdn.com/b/appfabriccat/archive/2010/12/14/ad-fs-2-0-to-secure-wcf-and-workflow-services-hosted-in-windows-server-appfabric.aspx)的说明。
这些解决方案实现了您正在谈论的概念，AD FS 是对传递的凭据进行身份验证/验证并向应用程序/服务返​​回令牌的服务。通常与 AD FS 的通信使用 ssl 来保护传输层，并对消息进行签名，以确保没有人在中间弄乱它们。
当然，您可以自己实现这样的机制。您不需要从活动目录中获取密码，您只需使用[此处提供的代码示例查看是否可以验证传递的凭据（用户名/密码）](https://stackoverflow.com/a/499716/1394380)

# c# - Xna：绘制动态 alpha 地图

> ID：10951540
> 
> 赞同：0
> 
> 时间：2012-06-08T15:14:58.780
> 
> 标签：c#, graphics, xna

我需要在 xna 中绘制简单的 alpha 地图，这取决于当前的游戏状态。我无法在资源中保存多种 alpha 贴图，所以我想动态绘制它们。

例如，精灵可以部分隐藏在墙后。

我考虑使用 System.Drawing，但是当我包含这个 dll 时，会与 Xna 命名空间发生冲突。有没有另一种方法可以在 xna 中绘制简单的位图？

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:00:17.123

您不应该使用 System.Drawing 类。这些适用于位于系统 RAM 中的图像。而是使用 XNA 来操作位于 GPU 内存中的纹理。

您可以使用[SetRenderTarget()](http://msdn.microsoft.com/en-us/library/ff434434%28v=xnagamestudio.40%29.aspx)将纹理设置为渲染目标。这将导致在纹理上执行进一步的绘制调用。这样，您可以在纹理上绘制所有内容。但是，您将没有绘制圆形、正方形等的方法。为此，您应该使用相应的几何图形创建顶点缓冲区或使用精灵模板。

# macos - 以编程方式确定 OSX 上的文件内容类型

> ID：10951544
> 
> 赞同：0
> 
> 时间：2012-06-08T15:15:08.063
> 
> 标签：macos, nsfilemanager

我正在处理内容格式在 OSX 的多个版本上发生变化的文件，以前是 ASCII，然后是 JSON，现在是二进制 plist。所以我需要确定它是什么类型的文件，以便我可以使用 JSON API 将其解析为文本，或者将 plist 加载为字典/数组。

我可以使用 /usr/bin/file 命令告诉我文件内容类型，但我更喜欢以编程方式执行此操作。有这方面的 Cocoa API 吗？

我查看了 NSFileManager attributesOfItemAtPath:error: 但这只是返回 NSFileTypeRegular，这没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T21:18:00.307

没有与文件匹配的 Cocoa API。有多种不同的 Cocoa（和 CF）API 来处理“文件类型”，但它们混合了扩展和经典的 Mac Finder 信息，这不是您想要的。

正如 H2CO3 所暗示的那样，您想要的是 libmagic。但是你想要 BSD 版本。它是 Fine Free File Command 源代码的一部分，与 OS X 的内置文件命令来源相同，它是 BSD 许可的，并且更新更频繁。

您可以从[http://www.darwinsys.com/file/](http://www.darwinsys.com/file/)获得它，但也可以从 Homebrew 或 MacPorts 获得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:32:23.593

这可能对您有所帮助：http: [//sourceforge.net/projects/libmagic/](http://sourceforge.net/projects/libmagic/) 这是 Linux 上 Libmagic 的手册页；因为这不是一个完全依赖于操作系统的库，所以这很可能在不修改 Mac 的情况下也可以工作。见[http://linux.die.net/man/3/libmagic](http://linux.die.net/man/3/libmagic)

# c++ - VS2010 的并发运行时和 unbounded_buffer >，有什么陷阱吗？

> ID：10951549
> 
> 赞同：3
> 
> 时间：2012-06-08T15:15:27.120
> 
> 标签：c++, visual-studio-2010, visual-c++, concurrency-runtime

我想从 dll 传递堆分配的对象。显然，[必须正确管理内存](http://blogs.msdn.com/b/oldnewthing/archive/2006/09/15/755966.aspx)。有没有人看到我设计的以下狡猾方案有问题：

```
unbounded_buffer<shared_ptr<T>> buf; 
```

我知道 shared_ptr 为包含的对象隐藏了一个删除器，因此在 dll 边界上单独使用它应该不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T16:21:07.407

以下是我从 MSFT 收到的关于该问题的信息：

1.  是的，您可以在使用 CreateThread 手动创建的线程上使用消息块（如 unbounded_buffer）。

2.  消息不能跨越 dll 边界，因为它的分配和删除必须发生在同一个 dll 中。一些消息块（如转换器）分配新消息。所以他们也面临同样的问题。unbounded_buffer> 非常好用，只是它不能解决上述问题。type 模板参数是指消息中的有效负载类型（即消息）。这不是信封的类型。

3.  在稳定状态下，数据流网络的吞吐量非常好。性能损失的主要来源是在建立网络时消息块的链接和取消链接。在 Visual Studio 2010 中，send 和 asend 等消息启动命令会遭受这种性能损失。我们已经在即将发布的 Visual Studio 中解决了这个问题。没有计划将修复移植到 VS2010。一种潜在的解决方法是实现一个始终连接到数据流网络的简单 ISource 消息块。使用此块向网络发起消息（agents.h 中的 _Originator 是 ISource 块的示例）。

# php - 寻找最大收入日

> ID：10951550
> 
> 赞同：0
> 
> 时间：2012-06-08T15:15:28.410
> 
> 标签：php, mysql

我有一个包含以下字段的表收入

```
+----+-----------+-------------+---------------+
| id | member_id | amount_paid | datetime_paid |
+----+-----------+-------------+---------------+ 
```

我想运行查询以查找前 10 个最大收入天数。实现这一目标的最快方法是什么？该表有很多数据。

问候，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:19:08.083

尝试执行它的基本查询：

```
SELECT DATE(`datetime_paid`) AS `Max Revenue`
    FROM `revenue`
    ORDER BY `amount_paid` DESC
    GROUP BY DATE(`datetime_paid`)
    LIMIT 10; 
```

这向您显示了前 10 个最大付费天数。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T15:19:04.117

假设您的`datetime_paid`列是某种日期或时间类型（[请参阅 MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-types.html)），以下应该可以工作。

```
SELECT SUM( `amount_paid` ) AS `amount`, DATE( `datetime_paid` ) as `date`
  FROM yourTable
  GROUP BY `date`
  ORDER BY `amount` DESC
  LIMIT 10 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:21:26.750

首先，您需要按付款日期对结果进行分组。这可以通过选择`DATE(datetime_paid) as payday`，然后按 分组来完成`payday`。要获得总数，请选择`SUM(amount_paid) as total`。最后，要获得前 10 名，请按`total desc`和排序`limit 10`。

您的最终查询应如下所示：

```
SELECT DATE(`datetime_paid`) AS `payday`, SUM(`amount_paid`) AS `total`
FROM `table_name_here`
GROUP BY `payday`
ORDER BY `total` DESC
LIMIT 10 
```

您可能需要将该`ORDER BY`行更改为`ORDER BY SUM(amount_paid) DESC`，我不记得在排序时是否允许使用字段别名。

# sql-server - 如何将 rake:db:prepare 与 mssqlserver 一起使用？

> ID：10951558
> 
> 赞同：0
> 
> 时间：2012-06-08T15:15:52.557
> 
> 标签：sql-server, ruby-on-rails-3, jruby

我正在尝试使用 MS SQL 服务器设置 Rails 测试。目前，Rails 在同一个 SQL 服务器实例上的正常开发环境环境下工作得很好。

我最初尝试通过手动创建一个数据库，该数据库与我用于开发的登录名相同，称为 PRODUCT_TEST。数据库创建良好。

当我运行 rake db:test:prepare 我得到了这个

```
C:\Code\git.product>rake db:test:prepare
rake aborted!
ActiveRecord::JDBCError: CREATE DATABASE permission denied in database 'master'.: CREATE DATABASE PRODUCT_TEST 
```

所以看起来它会丢弃并重新创建数据库。

我将用户添加到数据库服务器的所有角色中，然后再次尝试并得到了这个。

```
C:\Code\git.product>rake db:test:prepare --trace
** Invoke db:test:prepare (first_time)
** Invoke db:abort_if_pending_migrations (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute db:abort_if_pending_migrations
** Execute db:test:prepare
** Invoke db:test:load (first_time)
** Invoke db:test:purge (first_time)
** Invoke environment
** Execute db:test:purge
rake aborted!
The driver encountered an unknown error: Cannot open database "PRODUCT_TEST" requested by the login. The login failed.
C:/Program Files/jruby-1.7.0.preview1/lib/ruby/gems/shared/bundler/gems/activerecord-jdbc-adapter-e49ec53fb369/lib/arjdbc/jdbc/connection.rb:91:in `initialize'
C:/Program Files/jruby-1.7.0.preview1/lib/ruby/gems/shared/bundler/gems/activerecord-jdbc-adapter-e49ec53fb369/lib/arjdbc/jdbc/adapter.rb:33:in `initialize' 
```

数据库不再存在并已被删除。我对我创建的用户和“sa”用户都进行了尝试，但都不起作用。我可以在企业管理器和 Rails 中使用任何一种方式连接到数据库服务器和我的开发数据库。

database.yml 看起来像这样

```
test:
  adapter: jdbcmssql
  username: sa
  password: password
  host: 127.0.0.1
  database: PRODUCT_TEST 
```

知道我做错了什么吗？

谢谢。

注意：使用 Rails 3.2.3、JRuby 1.7.0.preview、Microsoft SQL Server Express Edition (64-bit) 10.50.1617.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T15:15:54.400

修复：我手动重新创建了 PRODUCT_TEST 数据库并将该帐户分配为所有者。这次该工具没有删除数据库并且能够正确访问它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-08T07:05:25.263

我发现将默认数据库设置为“master”解决了这个问题。

安全 > 登录 >*点击登录*> 默认数据库：master

# shell - 是否可以标记并保存特定的 bash 脚本行号并在该保存的位置重新启动脚本？

> ID：10951561
> 
> 赞同：1
> 
> 时间：2012-06-08T15:15:56.413
> 
> 标签：shell, numbers, line

我需要知道是否可以标记 bash 脚本行号，然后在保存的行号处重新启动该脚本。

代码：

```
#!/bin/bash
while read -r line; do #I'm reading from a big wordlist
command1 using $line
command2 using $line
done 
```

具体来说，有没有办法将脚本的当前 $line 号自动写入单独的文本文件，以便脚本从指定的行号开始，这样我就不必从头开始一切，以防万一必须停止脚本？

是否有意义？

非常感谢你 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:02:16.547

这可能会有所帮助：

```
#!/bin/bash

TMP_FILE="/tmp/currentLineNumber"                         # a constant

current_line_count=0                                      # track the current line number

processed_lines_count=0

# Verify if we have already processed some stuff.
if [ -r "${TMP_FILE}" ]; then
  processed_lines_count=$(cat ${TMP_FILE})
fi

while read -r line; do                                    # I 'm reading from a big wordlist

    # Skip processing till we reach the line that needs to be processed.

    if [ $current_line_count -le $processed_line_count ]; then

      # do nothing as this line has already been processed
      current_line_count=$((current_line_count+1))        # increment the counter
      continue

    fi

    current_line_count=$((current_line_count+1))
    echo $current_line_count > ${TMP_FILE}                # cache the line number

    # perform your operations
    command1 using $line
    command2 using $line

done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:50:06.887

这应该有效：

```
 #!/bin/bash
    I=`cat lastline`;
    A=0;

    while read -r line; do
           if [$A>=$I]; then
               command1 using $line
               command2 using $line
               (( I++ ))
               echo "$I" > "lastline";
           fi;
           (( A++ ))
    done 
```

请记住，如果要重新启动，则必须删除最后一行。:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-09T03:10:20.303

仅限 bash 的解决方案很好，但您可以通过使用其他工具来简化重新启动，从而获得更好的性能。就像您问题中的脚本一样，以下内容采用标准输入上的单词表。

```
#!/bin/sh

# Get the current position, or 0 if we haven't run before
if [ -f /tmp/processed ]; then
  read processed < /tmp/processed
else
  processed=0
fi

# Skip up to the current position
awk -v processed="$processed" 'NR > processed' | while read -r line; do

  # Run your commands
  command1 using $line
  command2 using $line

  # Record our new position
  processed=$((processed + 1))
  echo $processed > /tmp/processed

done 
```

哦，我写这个的方式，它与 Bourne shell 兼容，所以它不需要 bash。

# mysql - 数据库 mongoDB 或 mysql

> ID：10951562
> 
> 赞同：0
> 
> 时间：2012-06-08T15:16:00.537
> 
> 标签：mysql, json, mongodb

我正在为交易、折扣和优惠券创建一个搜索引擎。首先，我使用我的引擎从一些网站收集交易并将这些交易写入数据库。所以一个记录有一个：

记录：名称、折扣、价格、纬度、经度

现在我正在使用 mysql，但是如果我使用 mongodB，我的搜索引擎会更快，因为所有结果都是类似的 json 格式

如果我有 1,000,000 条记录 mysql 或 mongoDB 有什么更好的解决方案？我需要更快的搜索。

[http://test.pluspon.com](http://test.pluspon.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:19:39.813

对于您的用例，MongoDB 确实会更快。您可以轻松地在分片环境中使用多个 mongo 实现处理，不会有任何阻塞，甚至会为您的用例带来更多性能提升。

但请记住，速度基准和快速数据处理并不是您应该关心的唯一事情。与更成熟的企业数据库相比，MongoDB 还处于非常年轻的年龄。但是对于您命名的用例，我建议您使用它。

此外，正如所评论的，还有其他 NoSQL 数据库可以在某些情况下为您提供更好的帮助。阅读[此博客](http://nosql.mypopescu.com/)以获得更多了解

# solr - 针对 TrieDoubleField 的 Solr 范围查询会以负值表现出意外？

> ID：10951563
> 
> 赞同：0
> 
> 时间：2012-06-08T15:16:00.777
> 
> 标签：solr, search-engine, range

我已经搜索了所有溢出/交换站点，并在 Google 上研究了几个小时，但无济于事，所以我希望有人是 Solr 天才，可以告诉我哪里出错了。

我们正处于以前的搜索服务器和 Solr 之间的过渡，这要求我们暂时将地理数据存储在单独的纬度和经度字段中。我已经使用`solr.TrieDoubleField`众多来源推荐的字段定义了这些字段。

```
<fieldType name="tdouble" class="solr.TrieDoubleField" precisionStep="8" omitNorms="true" positionIncrementGap="0"/>
<field name="latitude_1" type="tdouble" indexed="true" stored="false" multiValued="false" required="false" />
<field name="longitude_1" type="tdouble" indexed="true" stored="false" multiValued="false" required="false" /> 
```

我遇到的问题是针对经度值（主要小于零）的范围查询根本不起作用。奇怪的是，如果我将查询值输入为正数，则范围有效，但这并不能激发信心。

这是一个示例查询：

```
longitude_1:[-95 TO -94] 
```

这不返回任何结果。但是，如果我用正数查询，如下所示：

```
longitude_1:[94 TO 95] 
```

我得到了这些结果（`fl=longitude_1`为了简洁起见）：

```
<doc>
  <str name="longitude_1">-94.60046</str>
</doc>
<doc>
  <str name="longitude_1">-94.03403</str>
</doc>
<doc>
  <str name="longitude_1">-94.03403</str>
</doc> 
```

我注意到这些值显示在`<str>`标签中，但我假设这是 internal 的字符串输出表示`TrieDoubleField`。如果不是这种情况，那么我的架构或 Solr 配置中可能有其他问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:57:56.827

减号可能会被解释为查询运算符（意​​味着该子句被禁止）。您应该尝试[转义](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/queryparsersyntax.html#Escaping%20Special%20Characters)它（使用反斜杠）。

# c# - 完整无向图的最有效实现

> ID：10951564
> 
> 赞同：3
> 
> 时间：2012-06-08T15:16:11.247
> 
> 标签：c#, graph-theory, heuristics, ant-colony

**问题背景**

我目前正在开发一个蚁群系统算法框架。我想我会先尝试他们应用到的第一个问题：旅行推销员问题（TSP）。我将使用 C# 来完成这项任务。

所有 TSP 实例将由一个完整的无向图组成，每个边有 2 个不同的权重。

**问题**

到目前为止，我只使用了邻接列表表示，但我读过它们只推荐用于稀疏图。由于我不是最了解数据结构的人，所以我想知道实现无向完整图的最有效方法是什么？

如果需要，我可以提供更多详细信息。

感谢您的时间。

**更新**

**重量澄清**。每条边都会有两个与之关联的值：

1.  两个城市之间的距离（ d(i,j) = d(j,i) 两个方向的距离相同）
2.  蚂蚁在特定边缘沉积的信息素量

**操作**。我将在图表上执行的操作的小总结：

*   对于每个节点，该特定节点上的蚂蚁将必须遍历与所有入射边关联的值

**问题说明**

蚁群优化算法可以“解决” TSP，因为这是它们首次应用于 . 我说“解决”是因为它们是称为元启发式优化的算法家族的一部分，因此它们从不保证返回最优解。

关于手头的问题：

*   蚂蚁会知道如何完成一次旅行，因为每只蚂蚁都会有记忆。
*   每次蚂蚁访问一个城市时，它都会将该城市存储在它的记忆中。
*   每次蚂蚁考虑访问一个新城市时，它都会在其记忆中搜索并选择一条出边，前提是该边不会将其引导至已访问过的城市。
*   当没有更多的边时，蚂蚁可以选择它已经完成了一次旅行；在这一点上，我们可以通过回溯它的记忆来回溯蚂蚁创建的旅程。

研究文章详情：[蚁群系统文章](http://www.idsia.ch/~luca/acs-bio97.pdf)

**效率考虑**

我更担心运行时间（速度）而不是内存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-18T17:16:45.843

首先，这里有邻接列表与矩阵的一般指南[。](https://stackoverflow.com/q/2218322/1092746) 不过，这是一个相当低级、非特定的讨论，因此它可能不会告诉您任何您不知道的事情。

我认为，要点是：如果你经常发现自己需要回答这个问题，“我需要知道节点 i 和节点 j 之间边缘的距离或信息素水平”，那么你可能需要矩阵形式，因为这个问题可以在 O(1) 时间内回答。

您确实提到需要迭代与节点相邻的边——这里可能会出现一些巧妙和微妙的地方。如果您不关心迭代的顺序，那么您就不会关心数据结构。如果您非常关心顺序，并且您预先知道顺序，并且它永远不会改变，那么您可以将其直接编码到邻接列表中。如果您发现自己总是想要，例如最大或最小浓度的信息素，您可能想尝试一些更有条理的东西，例如优先队列。这真的取决于你在做什么类型的操作。

最后，我知道您提到您对速度比对内存更感兴趣，但我不清楚您将使用多少图形表示。如果只有一个，那你真的不在乎。但是，如果每只蚂蚁都在构建自己的图表示，那么您可能比您想象的更关心，并且邻接表将让您携带不完整的图表示；不利的一面是，当蚂蚁在其边界进行探索时，建立表征需要时间。

最后，我知道您说您正在处理完整的图和 TSP，但值得考虑的是您*是否*需要使这些例程适应可能的图上的其他一些问题，如果是，那该怎么办。

I lean toward adjacency lists and/or even more structure, but I don't think you will find a clean, crisp answer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:55:29.230

既然你有一个完整的图表，我认为最好的表示是二维数组。

```
public class Edge
{
//change types as appropriate
  public int Distance {get;set;}
  public int Pheromone {get;set;}
}

int numNodes;
Edge[,] graph = new Edge[numNodes,numNodes];
for(int i = 0; i < numNodes; i++)
{
  for(int j = 0; j < numNodes; j++)
  {
    graph[i][j] = new Edge();
    //initialize Edge
  }
} 
```

如果您有很多节点，并且不按此图中的索引“记住”节点，那么拥有一个将 a 映射`Node`到图中的索引的字典可能是有益的。进行反向查找也可能会有所帮助（`List`此处将是适当的数据结构。这将使您能够根据图中的那个节点。

# php - 在 OSX Lion 上从 PHP 运行 wkhtmltopdf 会导致错误

> ID：10951566
> 
> 赞同：-1
> 
> 时间：2012-06-08T15:16:20.473
> 
> 标签：php, pdf

我收到这个错误，我不知道是否有办法将 libiconv.2.dylib 更新到版本 8.0.0 ？

```
dyld: Library not loaded: /Applications/MAMP/Library/lib/libiconv.2.dylib
Referenced from: /Applications/MAMP/Library/lib/libxml2.2.dylib
Reason: Incompatible library version: libxml2.2.dylib requires version 8.0.0 or later, but libiconv.2.dylib provides version 7.0.0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T22:28:34.067

我有一个理论，如果你正在运行一个二进制文件并且它在 CLI 中运行良好，但在 PHP 中运行良好，那么你需要正确设置你的环境变量。`PATH`通常，命令对和的差异最为敏感，`HOME`这些差异在 PHP 系统调用中设置得非常少。[尝试使用此问题](https://stackoverflow.com/questions/9967217/inkscape-inside-php-apache-doesnt-render-fonts-to-png)的答案将这些从您的命令行复制到您的 PHP 环境中。

# ruby-on-rails - Ruby/Rails 中的 Zipcode 、 to_i 和前导零

> ID：10951578
> 
> 赞同：3
> 
> 时间：2012-06-08T15:17:07.223
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试将在参数中传递的邮政编码保存为`"07306"`, 和`"03452"`，但`to_i`似乎正在将这些字符串值转换为验证之前`7306`和`3452`验证之前，因此验证一直失败。

如何防止 Ruby 删除前导零？

邮政编码是数据库中的一个整数字段，验证使用以下方式检查邮政编码的格式：

```
validates_format_of :zip, :with => /\A[+\-]?\d+\Z/, :message => "Please enter a valid US zipcode" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T15:20:34.607

`0`在谈论整数时，在概念上没有前导是没有意义的。使用时格式化邮政编码（即确保格式正确，`0`从 int 转换为 str 时添加前导），或将其保存为字符串

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T15:24:32.803

将其保存为字符串将缓解该问题，并且如果您决定支持可能包含或不包含字母的外国邮政编码，也将有助于面向未来的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:47:08.767

是的，我同意出于这个原因将 zip 存储为整数是没有意义的。我还认为您需要非常确定您的应用程序中永远不需要非美国邮政编码。有了这些警告，虽然......

如果由于某种原因无法修改数据库，可以修改邮政编码的 get 方法，如下所示：

```
def zip
  val = read_attribute(:zip).to_s
  val.length < 5 ? add_leading_zeros(val) : val
end

def add_leading_zeros(val)
  while val.length < 5 do
    val = "0" + val.to_s
  end
  val
end 
```

这有点hacky，如果您可以将DB字段修改为字符串（varchar），我真的不建议这样做。

您可能还想修改您正在使用的验证，因为它将允许少于 5 个字符的邮政编码通过。

也许使用这样的东西：

```
validates_format_of :zip, :with => /^\d{5}$/ 
```

编辑：我将把这个答案留在这里，但我只是注意到 OP 已经改变了数据库中的字段类型......所以，是的，我现在输入所有这些感觉有点傻。

# php - Foreach 没有插入 MySQL 的字段

> ID：10951581
> 
> 赞同：1
> 
> 时间：2012-06-08T15:17:16.693
> 
> 标签：php, mysql, database, insert, foreach

我有一个包含作者、书籍、主题、出版商等的数据库。

在我的一个表格中，我插入了所有书籍信息，其中一个信息是哪些作者（来自数据库）编写了特定的书籍。

我在 author 表和 book 表之间有一个多对多的关系，它们之间的表名为`book_author`。我在书本表单中所做的是将从`select multiple`php 中选择的作者 ID`book_author`与书的 ISBN 一起插入表中，因此每个带有 author_ID 组合的 book_ISBN 在该表中都是唯一的（即使我没有将组合设置为主键，因为我在该表中没有更多信息）。

问题是我的 foreach 语句只会在数据库中插入一次，而且如果我选择了许多作者（通常超过 2 个），它根本不会插入任何东西。

编辑：作者在`select multiple`

我已经检查过`var_dump()`并且该数组具有正确的 ID，例如在选择 2 个作者后：

`array(2) { [0]=> string(1) "3" [1]=> string(1) "2" }`

我什至检查了每个查询是否正确生成，同样的例子：

`string(77) "INSERT INTO book_author (book_ISBN, author_ID) VALUES ('87979695faae','3')"`

`string(77) "INSERT INTO book_author (book_ISBN, author_ID) VALUES ('87979695faae','2')"`

但是问题仍然存在，我不知道该怎么做，这是我的代码：

```
if (!isset($_POST["authors"])){
        header("Location: addBook.php");        
        exit;
}

var_dump($_POST["authors"]);

$authors = $_POST["authors"];

foreach ($authors as $author) 
{
    $sqlAuthor = "INSERT INTO book_author (book_ISBN, author_ID)
        VALUES ('$isbn','$author')";

    var_dump($sqlAuthor);

    mysql_query($sqlAuthor);
} 
```

我的怀疑是这个`mysql_query($sqlAuthor);`，但我不确定......

编辑：我`die`按照指示使用了该功能，这是我得到的错误

```
Cannot add or update a child row: a foreign key constraint fails (`library`.`book_author`, CONSTRAINT `FK_written1` FOREIGN KEY (`book_ISBN`) REFERENCES `book` (`book_ISBN`)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:25:24.690

该错误告诉您出了什么问题：在设置数据库的某个地方，您添加了一个外键约束，并且在尝试插入数据时没有遵守它。我个人建议只删除外键，但如果出于其他原因需要它，那么您将需要更新您的插入以真正注意约束。

# java - 如何在 Spring Security 中检查加盐密码？

> ID：10951583
> 
> 赞同：3
> 
> 时间：2012-06-08T15:17:20.673
> 
> 标签：java, authentication, spring-security, salt

我正在使用 Spring 3 并从 MySQL 数据库中获取用户。

现在，在测试中，我有一个使用 MD5 密码的用户。我可以使用它进行身份验证。

但是，我们希望在散列密码的方式上更加安全。我们想：

```
MD5(username + salt + password) 
```

salt 是存储在用户记录中的随机字符串。但我似乎无法弄清楚在哪里/如何做到这一点。这是我到目前为止所拥有的：

**用户道**

```
public class UserDao {

    public static Users findUserByUsername(String paUsername) {
        String hql = "from Users where username = :username";

        List<Users> list = null;
        Users user = null;

        try {
            IO io = new IO("web");   // custom Hibernate framework
            IOQuery query = new IOQuery();
            query.setStatement(hql);
            query.setParameter(new IOParameter("username", paUsername));

            list = io.runQuery(query);

            if (list.isEmpty()) {
                return null;
            }

            return list.get(0);

        } catch (Exception ex) {
            return null;
        }
    }
} 
```

**UserDetailsS​​erviceImpl**

```
@Service("userDetailsService")
public class UserDetailsServiceImpl implements UserDetailsService {

    @Autowired
    private UserDao userDao;

    @Override
    public UserDetails loadUserByUsername(String paUsername) throws UsernameNotFoundException {
        Users user = userDao.findUserByUsername(paUsername);

        if(user == null) {
            throw new UsernameNotFoundException("User not found");
        }

        return new User(
                user.getUsername(),
                user.getPassword(),
                user.getEnabled(),
                true,
                true,
                true,
                getAuthorities(Enums.UserRoles.IT));
    }

    private Collection<? extends GrantedAuthority> getAuthorities(Enums.UserRoles paRole) {
        List<GrantedAuthority> authList = getGrantedAuthorities(getRoles(paRole));
        return authList;
    }

    private List<String> getRoles(Enums.UserRoles paRole) {
        List<String> roles = new ArrayList<>();

        if (paRole.equals(Enums.UserRoles.USER)) {
            roles.add(Enums.UserRoles.USER.name());
        } else if (paRole.equals(Enums.UserRoles.IT)) {
            roles.add(Enums.UserRoles.USER.name());
            roles.add(Enums.UserRoles.IT.name());
        }

        return roles;
    }

    private static List<GrantedAuthority> getGrantedAuthorities(List<String> paRoles) {
        List<GrantedAuthority> authorities = new ArrayList<>();
        for (String role : paRoles) {
            authorities.add(new SimpleGrantedAuthority(role));
        }
        return authorities;
    }
} 
```

**用户详情服务**

```
public class UserDetailService implements UserDetailsService {

    @Override
    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {
        return new UserDetailsServiceImpl().loadUserByUsername(username);        
    }
} 
```

**安全应用上下文**

```
<beans:bean id="loginSuccessHandler" class="com.myapp.security.LoginSuccessHandler" />
<beans:bean id="loginFailureHandler" class="com.myapp.security.LoginFailureHandler" />
<beans:bean id="detailsService" class="com.myapp.security.UserDetailService" /> 
```

关于我需要做什么的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:25:15.290

这是我的应用程序用来设置密码编码的安全配置片段：

```
<sec:authentication-manager alias="authenticationManager">
    <sec:authentication-provider ref="authenticationProvider" />
</sec:authentication-manager>

<bean id="authenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
    <property name="userDetailsService" ref="userDetailsServiceImpl"/>
    <property name="passwordEncoder" ref="cryptoPasswordEncoder" />
</bean>

<bean id="cryptoPasswordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder" /> 
```

我们不需要在[DaoAuthenticationProvider](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/authentication/dao/DaoAuthenticationProvider.html)中设置 Salt 源，因为[BCryptPasswordEncoder](http://static.springsource.org/spring-security/site/docs/3.1.x/apidocs/org/springframework/security/crypto/bcrypt/BCryptPasswordEncoder.html)使用它自己的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:27:28.007

采用 ：

```
public class PasswordEncoder extends org.springframework.security.authentication.encoding.MessageDigestPasswordEncoder{             

    public PasswordEncoder() {
        super("MD5");
    }

    @Override
    public String encodePassword(String originalPassword, Object salt) {
            // here supply salt = username + saltString
        String encryptedPassword =  super.encodePassword(originalPassword, salt);           
        return encryptedPassword;
    }

} 
```

# google-cloud-datastore - 在 sql 或 gql 数据库中存储元组？

> ID：10951586
> 
> 赞同：0
> 
> 时间：2012-06-08T15:17:29.850
> 
> 标签：google-cloud-datastore, tuples

这可能是一个非常简单的问题，但我正在努力解决这个问题。

你能帮我找到一种方法将两条表单数据作为元组存储在 GAE 数据存储中吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T00:49:14.747

You need to store it as two separate properties.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T18:59:36.733

您可以将它们存储为两个单独的属性，或者，如果它们具有相同的数据类型，则可以将它们放在[ListProperty](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#ListProperty)中。

# php - 更新网页的特定区域而不重新加载整个页面

> ID：10951591
> 
> 赞同：0
> 
> 时间：2012-06-08T15:17:42.847
> 
> 标签：php, javascript, jquery, ajax, dynamic

我有一个简单的 PHP 脚本，它从文本文件中读取特定的短语并在网页上随机显示一个。为了显示另一个随机短语，目前必须刷新整个页面。我的问题是 - 有没有办法只更新包含短语的页面区域，每次单击按钮时显示一个新短语？目前，下面的 PHP 包含在使用 CSS 样式化的 h1 标记中。然后我在它下面添加一条评论，告诉用户刷新页面以显示另一个随机短语。理想情况下，我希望将此评论更改为一个按钮，这样用户就不必每次都刷新整个页面。

这是用于显示随机短语的简单 PHP：

```
$str = file_get_contents('words.txt'); //Take the contents from the file to the variable
$result = explode(',',$str); //Split it by ','
echo $result[array_rand($result)]; //Return a random entry from the array. 
```

任何帮助将不胜感激。

干杯，汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:27:07.217

我曾经开始学习 PHP/AJX 的示例，摘自[Using jQuery](http://openenergymonitor.org/emon/node/107) ...

**创建一个 php 脚本来接收 http 请求并从数据库中获取数据**

```
//--------------------------------------------------------------------------
// Example php script for fetching data from mysql database
//--------------------------------------------------------------------------
$host = "localhost";
$user = "root";
$pass = "root";

$databaseName = "ajax01";
$tableName = "variables";

//--------------------------------------------------------------------------
// 1) Connect to mysql database
//--------------------------------------------------------------------------
include 'DB.php';
$con = mysql_connect($host,$user,$pass);
$dbs = mysql_select_db($databaseName, $con);

//--------------------------------------------------------------------------
// 2) Query database for data
//--------------------------------------------------------------------------
$result = mysql_query("SELECT * FROM $tableName");          //query
$array = mysql_fetch_row($result);                          //fetch result    

//--------------------------------------------------------------------------
// 3) echo result as json 
//--------------------------------------------------------------------------
  echo json_encode($array); 
```

## 客户端示例

### 输出：

此元素将由 jquery 访问并替换此文本

```
<script id="source" language="javascript" type="text/javascript">

$(function () 
{
  //-----------------------------------------------------------------------
  // 2) Send a http request with AJAX http://api.jquery.com/jQuery.ajax/
  //-----------------------------------------------------------------------
  $.ajax({                                      
    url: 'api.php',                  //the script to call to get data          
    data: "",                        //you can insert url argumnets here to pass to api.php
                                     //for example "id=5&parent=6"
    dataType: 'json',                //data format      
    success: function(data)          //on recieve of reply
    {
      var id = data[0];              //get id
      var vname = data[1];           //get name
      //--------------------------------------------------------------------
      // 3) Update html content
      //--------------------------------------------------------------------
      $('#output').html("<b>id: </b>"+id+"<b> name: </b>"+vname); //Set output element html
      //recommend reading up on jquery selectors they are awesome 
      // http://api.jquery.com/category/selectors/
    } 
  });
}); 

</script>
</body> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:20:17.697

我能想到的两种方法：

1.  每次刷新都加载一堆，比如说 10 个，但只显示其中的 1 个。单击一个按钮循环通过其他 9。
2.  使用 AJAX 并在每个按钮单击时实际加载一个新短语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:26:19.923

使用[jQuery](http://jquery.com/)这很容易：

html:

```
<div id="random"></div>
<input type="button" id="update" /> 
```

javascript:

```
<script>
$("#update").on("click", function() {
    $.ajax({
        url: "/randomwords.php",
        success: function(data) { $("#random").html(data); }
    });
});
</script> 
```

`randomwords.php`是您上面的片段，没有其他任何内容。

# actionscript-3 - 上传图像并将其转换为 Flash 可以使用的格式

> ID：10951593
> 
> 赞同：0
> 
> 时间：2012-06-08T15:17:55.133
> 
> 标签：actionscript-3, flash

前言：我是 Flash 和 ActionScript 世界的 100% 新手，正在为一个潜在项目进行研究。

设计一个可以导入多种光栅和矢量格式的工具，然后将它们转换为可供 Flash 应用程序使用的介质，是否现实？实际上，我正在考虑设计一个 Flash Web 应用程序，它允许用户上传文件（特别是矢量文件）并在屏幕上操作它们（目前，只是移动它们，没什么疯狂的）。

相当多的问题是从特定的矢量格式转换为所需的格式。我的问题实际上是这样的：我应该尝试将它们转换成什么格式以便在我的应用程序中进行操作？这些文件不需要重新下载——它们会上传、转换、转换为字节数组，然后保存在数据库中进行检索。

理想情况下，我会在 Flash 应用程序上进行转换，具体取决于它最终的容易程度。也就是说，还考虑在将其粘贴在数据库中的 Web 服务端进行此操作（以我选择的任何语言来支持它）。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T18:58:29.967

为什么 SWF 格式本身不是一种选择？鉴于您已经准备好播放器，这将更容易实现。SWF 是一种很好的矢量图形格式，我对 SVG 不是很熟悉，但我的简短经验让我说，SWF 至少在很多方面都不比 SVG 差，而且可能很多时候更好（它自然是压缩，例如与 SVG 不同）。

没有多少免费工具可以让您通过图形编辑器操作 SWF 文件，但如果您的 SWF 只包含图形，除了少数例外，GNash 可以很好地显示它，还有 HXswfMl 项目允许编译 SWF从他们的 XML 描述。但是考虑到您自己也想制作一个这样的编辑器，我认为这不是您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:32:53.653

你可以用光栅图像做几乎所有事情，但矢量将是一个问题。有一个 SVG 库 ( [http://code.google.com/p/as3svgrendererlib/](http://code.google.com/p/as3svgrendererlib/) ) 可以处理基本的东西。至于其他矢量格式……好吧，您必须编写自己的解析器。

# jquery - “滚动旅程”网页如何运作

> ID：10951594
> 
> 赞同：2
> 
> 时间：2012-06-08T15:18:07.063
> 
> 标签：jquery, html, css

很抱歉，如果以前有人问过这个问题，我真的不知道如何措辞这个问题。这是[一个流行的例子](http://space.angrybirds.com/launch/)，[另一个](http://www.google.com/green/storyofsend/desktop/)我的意思是，当用户向下滚动页面并且页面本身实际上在一个固定路径中平移场景时，根本不需要滚动的方向。

这些网站是如何运作的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T15:21:02.583

虽然您可以自己编写所有这些代码，但我建议您使用惊人的[jQuery 滚动路径](http://joelb.me/scrollpath/)。

阅读[文档](https://github.com/JoelBesada/scrollpath#readme)。这很简单。

* * *

这是一个报价：

> 该插件使用画布风格的语法来绘制路径，使用方法 moveTo、lineTo 和 arc。为了帮助获得正确的路径，可以在初始化插件时启用带有路径的画布覆盖。
> 
> 可以使用鼠标滚轮、上/下箭头键和空格键进行滚动。空格键的滚动速度比箭头键快，按住 shift 键的同时按空格键会向后滚动。还包括一个自定义滚动条，它允许单击和拖动滚动。默认情况下启用滚动条。
> 
> 该插件还允许使用 CSS 转换来旋转整个页面。这可以沿着路径完成，也可以围绕当前位置完成。在不支持 CSS 变换的浏览器中，所有的旋转都会被忽略，但路径仍然会被遵循。这意味着该插件可以在所有浏览器中正常降级。

# android - Android 守护进程类型功能

> ID：10951598
> 
> 赞同：3
> 
> 时间：2012-06-08T15:18:44.283
> 
> 标签：android

如果我通过 UI 线程中的 AsyncTask 生成一个线程，当 UI 线程终止时该线程是否被终止？

我的 AsyncTask（从 UI 中生成）执行操作，然后酌情调用通知管理器（我的应用程序功能的一部分）。这很好用，但是当应用程序退出时通知会停止，我假设这是因为 UI 线程已经终止，因此孩子也是如此。

我确实考虑过一项服务（假设最初它的执行类似于守护程序），但后来读到这些服务在 UI/主线程上运行，因此不会在 UI 线程终止时持续存在。

我的问题真的是如何获得从 Android 应用程序生成的守护程序的功能？我不需要生成父进程之外的权限，并且它不需要在重新启动后保持不变。

通过NDK的POSIX API'ish线程还是我完全错了？

只在 Android 上呆了几天，所以仍在尝试摸索。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:30:33.983

> If I spawn a thread via AsyncTask from the UI thread, is this thread killed when the UI thread terminates?

Not automatically and not immediately. The thread will run to completion, or until Android terminates the process, whichever comes first.

> I did consider a service (assuming initially it would perform similar to a daemon) but then read that these run on the UI/main thread so would not be persistent across the UI thread termination.

Services are not really a "daemon" in classic Linux sense. A service is automatically in the background from a UI standpoint. It is not automatically in the background from a threading standpoint. Any work the service does that will take some time should be done on a background thread. The difference is that with a service running, Android will not be as prone to terminate your process quite as quickly.

> My question really is how can I get the functionality of a daemon spawned from an Android app?

That depends on what features of a "daemon" you are trying to obtain, which you neglected to describe in your question.

> POSIX API'ish threads through the NDK

That will do you no good. Your threads will still be terminated when your process terminates.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:35:18.337

线程在进程内执行。当应用程序被销毁时，Android 会挂起（供以后重用）或终止应用程序的进程，这会占用所有线程。所以守护进程必须是一个断开连接的进程，而不是一个线程。Android 被故意设置为阻止您启动这些（尽管子进程`Runtime.exec()`及其亲属很简单）。我认为你可以通过在 NDK 中 fork/exec()'ing 来做你想做的事，但是手机必须植根才能运行生成的应用程序，这会产生很多问题。尤其重要的是，有根电话的保修通常无效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:41:43.227

我必须实现几乎相同的功能：触发通知表单背景。

这相当简单：启动一个服务并从服务中生成一个新线程。

在许多情况下，Android 平台提供了一些开箱即用的好东西，您不必自己启动线程。

例如：

*   如果您的线程应该等待某些事情，您可以使用 AlarmManager 安排定期“唤醒”事件，该事件将负责在后台运行
*   或者，如果您需要在后台与后端同步数据，您可以使用 SyncAdapter API，它也负责在后台运行。

正如[CommonsWare](https://stackoverflow.com/users/115145/commonsware)刚刚建议的那样：

> 这取决于您尝试获得的“守护程序”的哪些功能，而您在问题中忽略了这些功能。

# c# - 在 .NET Web 应用程序中获取当前目录

> ID：10951599
> 
> 赞同：120
> 
> 时间：2012-06-08T15:18:50.303
> 
> 标签：c#, asp.net, .net, directory, filepath

所以我有一个网络项目，我正在尝试使用 c# 方法获取网站的根目录`Directory.GetCurrentDirectory()`。我不想使用静态路径，因为文件位置将来会发生变化。此方法在我的 imageProcess.aspx.cs 文件中运行，但我认为它会返回：

```
C:\Users\tcbl\documents\visual studio 2010\Projects\ModelMonitoring\ModelMonitoring\imageProcess.aspx.cs 
```

相反，我得到：

```
C:\Program Files\Common Files\Microsoft Shared\DevServer\10.0\ 
```

谁能解释为什么会发生这种情况以及可能的解决方案是什么？非常感谢。

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2012-06-08T15:19:31.840

当前目录是系统级功能；它返回启动服务器的目录。它与网站无关。

你想要`HttpRuntime.AppDomainAppPath`。

如果你在一个 HTTP 请求中，你也可以调用`Server.MapPath("~/Whatever")`.

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2014-12-16T08:51:43.233

使用此代码：

```
 HttpContext.Current.Server.MapPath("~") 
```

详细参考：

`Server.MapPath`指定映射到物理目录的相对或虚拟路径。

*   `Server.MapPath(".")`返回正在执行的文件（例如 aspx）的当前物理目录
*   `Server.MapPath("..")`返回父目录
*   `Server.MapPath("~")`返回应用程序根目录的物理路径
*   `Server.MapPath("/")`返回域名根目录的物理路径（不一定和应用的根目录相同）

一个例子：

假设您将一个网站应用程序 ( [http://www.example.com/](http://www.example.com/) ) 指向

```
C:\Inetpub\wwwroot 
```

并在

```
D:\WebApps\shop 
```

例如，如果您调用`Server.MapPath`以下请求：

```
http://www.example.com/shop/products/GetProduct.aspx?id=2342 
```

然后：

```
Server.MapPath(".") returns D:\WebApps\shop\products
Server.MapPath("..") returns D:\WebApps\shop
Server.MapPath("~") returns D:\WebApps\shop
Server.MapPath("/") returns C:\Inetpub\wwwroot
Server.MapPath("/shop") returns D:\WebApps\shop 
```

如果 Path 以正斜杠 (/) 或反斜杠 () 开头，则该`MapPath`方法返回一个路径，就好像 Path 是一个完整的虚拟路径一样。

如果 Path 不以斜杠开头，则该`MapPath`方法返回相对于正在处理的请求的目录的路径。

*注意：在 C# 中，@ 是逐字字面字符串运算符，这意味着该字符串应该“按原样”使用，而不是针对转义序列进行处理。*

脚注

`Server.MapPath(null)`也会`Server.MapPath("")`产生这种效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-12T17:21:36.803

对于点网 6，我使用：

```
AppContext.BaseDirectory 
```

很酷的一点是，它在 asp.net 和控制台应用程序上都是一样的。

# logic-programming - 将 Maude 表达式转换为字符串

> ID：10951602
> 
> 赞同：2
> 
> 时间：2012-06-08T15:18:58.260
> 
> 标签：logic-programming, maude-system

有没有办法将 Maude 表达式转换为字符串？

我正在寻找相当于 Haskell 的`show`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:19:00.320

没有真正干净的解决方案。您可以将表达式转换为元术语，metaPrettyPrint 它，将生成的 Qid 转换为字符串并将它们连接起来，但您仍然需要处理词汇问题，例如在哪里插入空格。

（来自[莫德邮件列表](http://lists.cs.uiuc.edu/pipermail/maude-help/2012-June/000578.html)）

# python - PyQt4中的资源文件

> ID：10951608
> 
> 赞同：8
> 
> 时间：2012-06-08T15:19:12.123
> 
> 标签：python, pyqt4, embedded-resource

我试图理解 PyQt4 中的一个例子（simpletreemodel.pyw）我看到了代码

```
import simpletreemodel_rc 
```

但是我看不到该模块在示例代码中的使用位置当我检查模块 simpletreemodel 时，我看到：

```
 from PyQt4 import QtCore

qt_resource_data = b"\
\x00\x00\x07\xb9\
\x47\
\x65\x74\x74\x69\x6e\x67\x20\x53\x74\x61\x72\x74\x65\x64\x09\x09\
\x09\x09\x48\x6f\x77\x20\x74\x6f\x20\x66\x61\x6d\x69\x6c\x69\x61\
\x72\x69\x7a\x65\x20\x79\x6f\x75\x72\x73\x65\x6c\x66\x20\x77\x69\
\x74\x68\x20\x51\x74\x20\x44\x65\x73\x69\x67\x6e\x65\x72\x0a\x20\
\x20\x20\x20\x4c\x61\x75\x6e\x63\x68\x69\x6e\x67\x20\x44\x65\x73\
\x69\x67\x6e\x65\x72\x09\x09\x09\x52\x75\x6e\x6e\x69\x6e\x67\x20\
\x74\x68\x65\x20\x51\x74\x20\x44\x65\x73\x69\x67\x6e\x65\x72\x20\ 
```

这个模块应该做什么？谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-08T15:30:13.850

`.qrc`您看到的是文件包含的资源的逐字节转储。您没有显式访问模块内的对象。只需导入它，您就可以通过它们的原始名称（和路径）访问这些资源，但前面有一个冒号。

```
pixmap = QPixMap(':/images/filename.jpg') 
```

**更新**：QRC 文件是一个 XML 文件，如下所示：

```
<RCC>
  <qresource prefix="/images">
    <file alias='filename.jpg'>images/filename.jpg</file>
  </qresource>
</RCC> 
```

然后生成它，使用：

```
pyrcc4 -o images_rc.py images.qrc 
```

# google-app-engine - 在 Appengine 数据存储区中运行过滤器查询

> ID：10951612
> 
> 赞同：0
> 
> 时间：2012-06-08T15:19:14.707
> 
> 标签：google-app-engine

我想运行查询

```
SELECT * FROM users WHERE uname='foo' AND passwd='bar' 
```

这总是返回 None。我的表有与查询匹配的条目。我觉得它必须与索引有关。我将 index.yaml 编辑为

```
indexes:

- kind: users
  ancestor: no
  properties:
  - name: uname
    direction: asc
  - name: passwd
    direction: asc 
```

但是当我定义时`uname=db.TextProperty(required=True,indexed=True)`，它返回一个奇怪的错误说

```
<class 'google.appengine.ext.db.ConfigurationError'>: indexed must be False. 
      args = ('indexed must be False.',) 
      message = 'indexed must be False.' 
```

我称之为奇怪，因为当我用谷歌搜索错误时，完全匹配为零。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:45:49.443

您是否尝试在管理控制台的数据存储查看器中运行查询。它建议您创建索引。

但是，文本属性不可索引。根据[文档](https://developers.google.com/appengine/docs/python/datastore/typesandpropertyclasses#TextProperty)

> 与 StringProperty 不同，TextProperty 值的长度可以超过 500 个字符。但是，TextProperty 值未编入索引，不能用于过滤器或排序顺序。

# perl - 使用 Perl Mechanize 单击具有 id 但没有名称的按钮

> ID：10951620
> 
> 赞同：1
> 
> 时间：2012-06-08T15:19:56.967
> 
> 标签：perl, mechanize

我正在尝试使用 Perl Mechanize 单击按钮，但有一些曲折，因为我试图将相同的脚本应用于不同的站点，每个站点都具有相同的按钮 id 属性，但表单上的数字不同页面，按钮没有名称，只有一个 ID。

当您只知道 id 时，有什么方法可以单击按钮？

如果做不到这一点，确定包含给定 id 按钮的表单数量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:40:53.723

请参阅[HTML::Form](http://p3rl.org/HTML%3a%3aForm)：

```
for my $form ($mech->forms) {
    if $form->find_input('#theid') {
        # this is the one
    }
} 
```

# lisp - LISP 二项式系数，阶乘

> ID：10951621
> 
> 赞同：2
> 
> 时间：2012-06-08T15:19:57.923
> 
> 标签：lisp, elisp, factorial, binomial-coefficients

我是 lisp 的新手，我尝试在 lisp 中编写一个程序，计算二项式系数迭代（阶乘）但不是递归的。我试过everthing，全局函数，局部函数（阶乘）），但我的程序不起作用，例如当我命令：（binom（7 4））时，出现错误

```
 SELECT ALL
(defun binom-coef(a b)   
       (if (or (< a b) (< b 0))
       nil            )    

       (flet fakul(n)    ; factorial
               (cond ((= n 0) 1)
              (t (* n (fakul (- n 1))))))
   (/ (fakul a) (* (fakul b) (fakul(- a b))))) 
```

我还有一个问题，如何在 emacs 中编译？

（我尝试在缓冲区 -> *scatch* ->（加载“binom-coeff.el”但只有一条错误消息......）

非常感谢， ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T17:17:42.953

无论您是在 Common Lisp 还是 emacs-lisp 中学习/编程，您都必须下定决心。它们相似但不同，在学习时，混乱可能是一个障碍。

要学习 Emacs Lisp，请阅读：

Emacs Lisp 编程简介 [http://www.gnu.org/software/emacs/emacs-lisp-intro/](http://www.gnu.org/software/emacs/emacs-lisp-intro/) 或输入 emacs M-: (info "(eintr)Top") RET

要了解 Common Lisp，请查看[http://cliki.net/Getting+Started](http://cliki.net/Getting+Started)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-11T03:21:06.447

你最好的办法是用 EMACS 安装 SLIME。它使用 SBCL，它是 common lisp 的一个版本。尝试 CC CC 或 CC CK 编译。然后CC CZ打开一个新的缓冲区并运行程序。我也在努力自学。在学习一门新语言的同时学习 EMACS 并不是一件容易的事。至少对我来说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-12T20:39:17.843

我喜欢这个教程[http://steve-yegge.blogspot.com/2008/01/emergency-elisp.html](http://steve-yegge.blogspot.com/2008/01/emergency-elisp.html)它非常简短而且内容丰富。

如果它是您想要的省略号，只需在右括号后使用 Cx Ce 即可。你在那里有很多错误。

```
(defun binom-coef(a b)
  ;; (if (or (< a b) (< b 0)) nil)
  ;; Wery strange expression. (if CONDITION IF-TRUE IF-FALSE). You
  ;; didn't set IF-FALSE, so it's nil by default, 
  ;; and you set IF-TRUE to nil. It allways returns nil.

  ;; If you want to leave from function when wrong args given
  (block nil
    (if (or (< a b) (< b 0)) (return))
  ;; can be throw/catch also

    ;; (flet fakul(n)
    ;;   ;; wrong usage of flet. It's used like let, (flet ((name1 args1
    ;;   ;; body1) (name2 args2 body2) ... )
    ;;   ;; BODY-WHERE-FUNCTIONS-ARE-VISIBLE)
    ;;   (cond
    ;;     ((= n 0) 1)
    ;;     (t (* n (fakul (- n 1))))
    ;;     ))

    (flet ((fakul (n)
             (cond
               ((= n 0) 1)
               (t                       ; shound be like (< 0 n)
                 (* n (fakul (- n 1))))
               )))
      (fakul 5)
      ;; => 120
      (/ (fakul a) (* (fakul b) (fakul(- a b))))
      ;; ^ Inside flet ^
      ))
  )
(binom-coef 8 3)  ; <= look, it's not (8 3), because (8 3) means
                  ; execute function `8' with argument 3\. If you
                  ; wanted to pass list with 8 and 3, it should be
                  ; (quote (8 3)), or simply '(8 3)
;; => 56 
```

# django - 如何在模型选择字段的查询集中使用模型字段？

> ID：10951628
> 
> 赞同：0
> 
> 时间：2012-06-08T15:20:29.450
> 
> 标签：django, django-forms, django-queryset

我希望能够在餐桌上举办派对。首先我需要显示表单，所以我创建了一个模型表单，其中包含一个名为 open_tables 的额外字段。这必须是每个标记为 AVAILABLE 且具有容量的表。问题是我不知道如何从查询集中引用 number_in_party 字段。我已经绑定了 self.base_fields，但 self 不起作用。我试过 SeatPartyForm.model.number_in_party，但还是不行。这发生在 get 上，此时 number_in_party 已填充。有没有办法做这个查询？

```
class SeatPartyForm( ModelForm):

open_tables = forms.ModelChoiceField(queryset=Table.objects.filter(status__exact=Table.AVAILABLE).exclude(max_capacity__lt =  model.base_fields['number_in_party']))
class Meta:
    model = Party
    fields = ('name', 'number_in_party')` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T07:03:35.013

You don't know the actual `number_in_party` before user fills in one. The server-side Django form cannot do the limitation automatically for you.

Thus you need to either change `open_tables` after `number_in_party` is available, via javascript; or split the form to two parts, in the first part user fills in `number_in_party`, in the second part, in server side you could filter `open_tables` according to the ready value of `number_in_party`.

# objective-c - 从 NSDictionary 访问数据

> ID：10951629
> 
> 赞同：0
> 
> 时间：2012-06-08T15:20:30.783
> 
> 标签：objective-c, ios

我正在使用以下方法来访问有关对象的数据。第一个 NSLog 显示所有数据。第二个 NSLog 显示“帧”数据，结果如下： NSRect: {{168, 102}, {5, 5}}

如何从 NSRect 访问第一组坐标，然后从第一对访问横坐标？

```
-(void) moveTheShape:(NSTimer*)timer
{
    NSDictionary *userInfo = [timer userInfo];
    NSLog(@"Info:  %@",userInfo);
    //Info:  <Shape: 0x68b6c30; frame = (151 352; 5 5); layer = <CALayer: 0x68b6c00>>
    NSDictionary *frame = [userInfo  valueForKey:@"frame"];
    NSLog(@"frame: %@", frame);
    //NSRect: {{168, 102}, {5, 5}}
} 
```

正确的解决方案：

```
-(void) moveTheShape:(NSTimer*)timer
{
Shape *userInfo = [timer userInfo];
NSLog(@"Info:  %@",userInfo);
CGPoint origin = userInfo.frame.origin;
NSLog(@"result: %f", origin.x);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:27:38.227

CGRect 存储为 NSValue 您需要`CGRectValue`从`NSValue`

使用以下

```
NSValue *value = [userInfo valueForKey:@"frame"];
CGRect rect = [value CGRectValue]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:05:23.840

如果我对 userInfo 类型的预感是正确的：

```
-(void) moveTheShape:(NSTimer*)timer
{
    Shape *userInfo = [timer userInfo];
    CGPoint origin = userInfo.frame.origin;
    // Do stuff with origin
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:24:53.237

int 横坐标 = frame.origin.x; 将为您提供 x 值。您使用 frame.size.width 和 frame.size.height 来获取尺寸。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:28:28.173

哈，`abscissa`我今天的新词！

无论如何，您的意思是 CGRect，因为 iPhone 使用 CoreGraphics，而不是 FoundationKit 用于所有 UIKit 矩形。

至于访问结构的内部变量（准确地说是 CGPoint 和 CGSize），只需在将帧存储到 CGRect 变量后使用常规的旧点表示法，如下所示：

```
NSValue *value = [userInfo objectForKey:@"frame"];
CGRect frameVar = [value CGRectValue];
frameVar.origin = CGPointMake(someCoord, someOtherCoord); 
```

# perl - 更改目录并抓取 xml 文件以解析 perl 中的某些数据

> ID：10951636
> 
> 赞同：1
> 
> 时间：2012-06-08T15:20:55.177
> 
> 标签：perl

我正在尝试解析位于一个目录的子目录中的特定 XML 文件。出于某种原因，我收到错误消息说文件不存在。如果该文件不存在，它应该移动到下一个子目录。

这是我的代码

```
 use strict;
        use warnings;
        use Data::Dumper;
        use XML::Simple;

        my @xmlsearch = map { chomp; $_ } `ls`;

        foreach my $directory (@xmlsearch) {
            print "$directory \n";
            chdir($directory) or die "Couldn't change to [$directory]: $!";
            my  @findResults = `find   -name education.xml`;

         foreach my $educationresults (@findResults){
            print $educationresults;
            my $parser = new XML::Simple;
            my $data = $parser->XMLin($educationresults);
            print Dumper($data);
            chdir('..');         
         }

        }

      ERROR
      music/gitar/education.xml
      File does not exist: ./music/gitar/education.xml 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:43:32.350

使用`chdir`您所做的方式会使代码 IMO 的可读性降低。您可以为此使用[File::Find](https://metacpan.org/module/File%3a%3aFind)：

```
use autodie;
use File::Find;
use XML::Simple;
use Data::Dumper;

sub findxml {
    my @found;

    opendir(DIR, '.');
    my @where = grep { -d && m#^[^.]+$# } readdir(DIR);
    closedir(DIR);

    File::Find::find({wanted => sub {
        push @found, $File::Find::name if m#^education\.xml$#s && -f _;
    } }, @where);
    return @found;
}

foreach my $xml (findxml()){
    say $xml;
    print Dumper XMLin($xml);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:42:31.947

每当您发现自己依赖反引号来执行 shell 命令时，您应该考虑是否有适当的 perl 方法来执行此操作。在这种情况下，有。

`ls`可以替换为`<*>`，这是一个简单的 glob。该行：

```
my @array = map { chomp; $_ } `ls`; 
```

只是一种迂回的说法

```
chomp(my @array = `ls`);  #  chomp takes list arguments as well 
```

但当然正确的方法是

```
my @array = <*>;  # no chomp required 
```

现在，所有这一切的简单解决方案就是做

```
for my $xml (<*/education.xml>) { # find the xml files in dir 1 level up 
```

这将覆盖一级目录，没有递归。对于完全递归，使用`File::Find`：

```
use strict;
use warnings;
use File::Find;

my @list;
find( sub { push @list, $File::Find::name if /^education\.xml$/i; }, ".");

for (@list) {
    # do stuff
    # @list contains full path names of education.xml files found in subdirs
    # e.g. ./music/gitar/education.xml
} 
```

您应该注意，不需要更改目录，根据我的经验，不值得麻烦。而不是这样做：

```
chdir($somedir);
my $data = XMLin($somefile);
chdir(".."); 
```

只需这样做：

```
my $data = XMLin("$somedir/$somefile"); 
```

# asp.net - Asp.net 文件上传到共享位置

> ID：10951637
> 
> 赞同：0
> 
> 时间：2012-06-08T15:20:58.747
> 
> 标签：asp.net

我有这个负载平衡的 asp.net 应用程序，它需要将文件上传到共享位置。Web 应用程序不会被模拟，这意味着它将使用网络服务凭据跨越机器边界。现在我的问题是，我需要将上传文件的文件夹的权限分配给哪个帐户？我怎么能说这些网络服务器的网络服务需要写权限呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:33:03.273

如果您的服务器是 AD 域的一部分，那么您可以从安全权限对话框中添加服务器本身以获得读/写权限（在文件共享服务器中）。请记住在搜索 Active Directory 时选择“计算机”。根据您的设置，可能必须从 Active Directory 的根目录搜索或选择“整个目录”。您必须添加属于负载平衡环的所有服务器才能在文件共享服务器的目录中获得权限。

如果您的服务器不在 AD 域内，那么您本地服务器的网络服务将没有任何安全上下文可写入另一台服务器；这意味着只有通用权限才能起作用（例如，向“每个人”授予写权限）。

否则，您将不得不使用 UNC 身份验证。[此处发布了](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/0cbd77b7-5c6c-4a86-bc3a-e06eb888fa17)一个示例。

# c# - SQL Server 2008 R2 查询通知上的死锁 (SqlDependency)

> ID：10951645
> 
> 赞同：2
> 
> 时间：2012-06-08T15:21:28.233
> 
> 标签：c#, sql-server-2008, sqldependency

我在 SQL Server 2008 R2 上遇到了死锁问题。在 SQL Profiler 中查看死锁图时，问题似乎源于查询通知：

```
 <resource-list>
   <keylock hobtid="72057654759522304" dbid="6" objectname="MyDB.sys.query_notification_814081939" indexname="cidx" id="lock15ab2aa80" mode="RangeX-X" associatedObjectId="72057654759522304">
    <owner-list>
     <owner id="process5c5708" mode="RangeX-X"/>
    </owner-list>
    <waiter-list>
     <waiter id="process4e9ae08" mode="RangeS-U" requestType="wait"/>
    </waiter-list>
   </keylock>
   <keylock hobtid="72057654759522304" dbid="6" objectname="MyDB.sys.query_notification_814081939" indexname="cidx" id="lock15e56a300" mode="RangeS-U" associatedObjectId="72057654759522304">
    <owner-list>
     <owner id="process4e9ae08" mode="RangeS-U"/>
    </owner-list>
    <waiter-list>
     <waiter id="process5c5708" mode="RangeS-U" requestType="wait"/>
    </waiter-list>
   </keylock>
  </resource-list> 
```

这些查询通知是使用 SQLDependency 实现的。更新由 SQLDependency 监视的表时似乎发生了死锁。

我不太了解死锁图语法。KeyLock 模式[仅在使用可序列化事务隔离级别时为 RangeS-U。](http://msdn.microsoft.com/en-us/library/ms191272%28v=sql.105%29.aspx)， 对 ？

我也读过这个[问题](https://stackoverflow.com/questions/446729/sql-server-2005-key-range-locks-in-read-committed-transaction-isolation-level)......我应该激活 READ_COMMITED_SNAPSHOT 吗？

谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:39:46.083

不能确定，但​​这里有一些想法......

导致通知的语句可能在通知传递之前未完成。因此，当从服务代理接收到通知并对通知采取任何操作时，它可能仍然具有活动锁。

也许您的通知收件人正在尝试清理队列或在生成第一个通知的事务完成之前从队列中获取第二个通知。

生成通知的 DML 是否在多步骤事务中运行？是在多步骤事务中运行的接收通知的代码。（即您是否使用了 begin tran 或等价物？）。

跟踪死锁图中提到的进程并了解哪些代码持有 RangeX-X 锁以及哪些代码持有 RangeS-U 可能很有用。

您可能希望发布一些生成通知的代码和接收通知的代码的最小示例。

这里还有一个关于通知和多个订阅的已知有点类似死锁问题的 Microsoft KB。

[MS KB975090 可能相关，但不完全相同。](http://support.microsoft.com/kb/975090)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T09:36:46.253

其背后的主要原因是事务太长并且涉及的对象太多。

正如我在问题中所说，触发 SqlDependency 的表包含对数据库中每个对象的引用。在同一个事务中更新一堆对象意味着查询通知系统会锁定这个大表。因此，您很快就会陷入僵局。

2 个解决方案（由 MS 建议）：

*   减少交易的长度和复杂性。
*   在大交易之外执行触发通知系统的请求。

# c# - 请解释 !SyncBlk 的 windbg 命令

> ID：10951654
> 
> 赞同：5
> 
> 时间：2012-06-08T15:22:19.593
> 
> 标签：c#, command, windbg, sos

首先，是否有用于获取每个 sos 命令的帮助和参数的命令`windbg`？

其次，我想了解`!syncblk`输出

```
Index SyncBlock MonitorHeld Recursion Owning Thread Info  SyncBlock Owner
  201 05b9493c          979         1 05bc1040   bcc  45   022f3490 System.Collections.ArrayList
 2875 05b4c914            1         1 17b99e10  1af8 290   024862d8 MyClass
 2945 05b4b66c            1         1 17d1a290  12c0 752   02482940 MyClass 
```

`MonitorHeld`显示 # 持有的监视器`synblk`。1 用于写入，2 用于读取，但列的其余部分是什么意思？

假设我有一个 C# 代码

```
MyClass MyObj;
MyObj = new MyClass(); 
```

现在如果我这样做

```
lock (MyObj)
{
} 
```

`syncblk`所有者栏会显示“MyClass”吗？同样，当我运行此`!SyncBlk`命令时，它到底向我显示了什么？它是否向我显示了`lock()`and `Monitor.Enter`and `Mutex`() 和其他锁定机制的数量？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T15:59:57.797

要获得 SOS 命令的帮助，请键入`!help`或`!sos.help`. 要获得有关特定命令的帮助，请键入`!help <command>`. SOS 的帮助文本也[可以在线获取](http://msdn.microsoft.com/en-us/library/bb190764.aspx)。在线版本为您提供了该命令的概述。有关其他详细信息，请使用`!help syncblk`.

的输出`!syncblk`显示了线程 ID（下面输出中的标头 #1）、对象和用于锁定的对象的类型（标头 #2）。

```
 +-------#1-------+  +-----#2------+
Index SyncBlock MonitorHeld Recursion Owning Thread Info  SyncBlock Owner
  201 05b9493c          979         1 05bc1040   bcc  45   022f3490 System.Collections.ArrayList
 2875 05b4c914            1         1 17b99e10  1af8 290   024862d8 MyClass
 2945 05b4b66c            1         1 17d1a290  12c0 752   02482940 MyClass 
```

1) 第一个值是线程对象，第二个是本机线程 ID，最后一个是 WinDbg 线程 ID。

2）第一个值是用于锁定的对象，第二个值是该对象的类型。

`!syncblk`仅涵盖内部 .NET 锁，因此`Mutex`（这是一个内核对象）不在此处涵盖。

在您的示例中，运行 lock 语句的代码的线程 ID 将与`MyObj`指向的地址和类型一起显示`MyClass`。

# javascript - 在文本区域中替换 为 \n 在 IE9 中不起作用

> ID：10951661
> 
> 赞同：0
> 
> 时间：2012-06-08T15:22:50.270
> 
> 标签：javascript, internet-explorer-9, newline, line-breaks

我的问题很简单。我正在尝试将`<br/>`字符串中的所有字符替换为并在元素`\n`中显示所有结果字符串。`<textarea>`代码：

```
textarea.innerHTML = s.innerHTML.replace(/(\r\n|[\r\n])/g, '').replace(/<br[\s\/]?>/gi, '\n'); 
```

在文本区域内，我应该看到由“\n”分隔的行。它适用于任何浏览器，包括 IE6，但不适用于 IE9。怎么了？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T15:24:24.420

尝试使用`value`的属性`textarea`，而不是`innerHTML`。

# asp.net-mvc - MVC 4 @Scripts“不存在”

> ID：10951669
> 
> 赞同：202
> 
> 时间：2012-06-08T15:23:08.733
> 
> 标签：asp.net-mvc, razor

我刚刚创建了一个 ASP.NET MVC 4 项目并使用 Visual Studio 2012 RC 为`Index`和`Create`操作创建了控制器和 Razor 视图。

当我开始运行应用程序并浏览到`Create`视图时，显示以下错误：

> 编译器错误消息：CS0103：当前上下文中不存在名称“脚本”

问题是以下代码自动添加到视图底部：

```
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

为什么脚本不存在？

我查看了 Assembly System.Web.Mvc.dll, v4.0.0.0 中的基本网页类

我可以看到以下可用的辅助属性：

*   阿贾克斯
*   html
*   网址

但是没有任何名称为脚本。

有任何想法吗？

**编辑：**

我的 Web.config 文件如下所示（与 Visual Studio 创建的文件相同）：

```
 <system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
      </namespaces>
    </pages>
  </system.web.webPages.razor> 
```

**编辑＃2：**

人们在博客上介绍如何使用`@Scripts`帮助程序：

*   [斯科特·汉塞尔曼博客](http://www.hanselman.com/blog/VisualStudio2012RCIsReleasedTheBigWebRollup.aspx)
*   [Codebetter.com](http://codebetter.com/howarddierking/2012/06/04/web-optimization-in-visual-studio-2012-rc)

`@Scripts`然而，刚刚将 Visual Studio 2012 RC 安装到全新的 Windows 8 安装中，即使 Visual Studio 将其添加到生成的视图中，我仍然无法使用！

**解决方案如下。**

我不知道如何关闭它，因为最终更新似乎解决了这个问题。我仔细检查了我是否使用新项目执行了全新安装。但是在经过各种更新并且没有明显的手动干预之后，我所做的同样失败的项目现在可以正常工作了。感谢所有的想法，但当时肯定有问题；）

* * *

## 回答 #1

> 赞同：270
> 
> 时间：2013-02-10T16:18:19.233

这里的关键是添加

```
 <add namespace="System.Web.Optimization" /> 
```

到两个 web.config 文件。我的情况是我在项目和主/根 web.config 中都有 System.Web.Optimization 引用，但 @Scripts 仍然无法正常工作。您需要将命名空间引用添加到 Views web.config 文件以使其工作。

**更新：**

自 MVC 4 发布以来，System.Web.Optimization 现已过时。如果您从空白解决方案开始，则需要安装以下 nuget 包：

```
Install-Package Microsoft.AspNet.Web.Optimization 
```

您仍然需要在 web.config 文件中引用 System.Web.Optimization。有关更多信息，请参阅此主题：

[如何为 MVC-3-converted-to-4 应用添加对 System.Web.Optimization 的引用](https://stackoverflow.com/questions/9475893/how-to-add-reference-to-system-web-optimization-for-mvc-3-converted-to-4-app)

正如许多人指出的那样，在上述步骤之后可能需要**重新启动 VS**才能完成这项工作。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-06-08T18:47:13.430

`@Styles`并且`@Scripts`是`System.Web.Optimization`图书馆提供的 2 个新助手。顾名思义，它们分别捆绑和缩小 CSS 和 JavaScript 文件或资源。

尝试`System.Web.Optimization`通过`@using`指令或通过包含命名空间`web.config`

~~[http://ofps.oreilly.com/titles/9781449320317/ch_ClientOptimization.html#BundlingAndMinification](http://ofps.oreilly.com/titles/9781449320317/ch_ClientOptimization.html#BundlingAndMinification)~~

**更新**

Microsoft 已将捆绑/缩小移动到一个名为`Microsoft.AspNet.Web.Optimization`. 您可以从[nuget](http://nuget.org/packages/Microsoft.AspNet.Web.Optimization)下载程序集。

这篇[文章](http://msdn.microsoft.com/en-us/vs11trainingcourse_aspnetandvisualstudio_topic5.aspx)将对你有用。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2013-10-14T17:39:36.937

上面少了一个小步骤，我在另一篇文章中找到了。添加后

```
<add namespace="System.Web.Optimization" /> 
```

到您的`~/Views/web.config`命名空间，**关闭并重新打开 Visual Studio。** 这是我必须做的才能让它工作。

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2012-06-15T18:06:25.260

我正在使用区域，并且刚刚遇到这个问题，我只是将命名空间从根 web.config 复制到区域 web。配置，它现在可以工作了！！

```
 <add namespace="System.Web.Helpers" />
    <add namespace="System.Web.Mvc" />
    <add namespace="System.Web.Mvc.Ajax" />
    <add namespace="System.Web.Mvc.Html" />
    <add namespace="System.Web.Optimization" />        
    <add namespace="System.Web.Routing" />
    <add namespace="System.Web.WebPages" /> 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2012-06-16T02:59:11.090

我遇到了同样的问题，我使用 WinMerge 来帮助我追踪这个问题。但当我对其进行更多研究时，我发现 Rick 有一个完美的[博客文章](http://blogs.msdn.com/b/rickandy/archive/2012/06/12/asp-net-mvc-4-beta-to-mvc-rc-upgrade-instructions.aspx)。

概括：

*   添加`<add namespace="System.Web.Optimization"/>`到两个 web.config 文件
*   跑`Install-Package -IncludePrerelease Microsoft.AspNet.Web.Optimization`
*   更新捆绑代码
*   更新布局文件
*   最后一步是更新其他 10 个库。我没有，它工作得很好。所以看起来你可以拖延这个（除非我已经更新了其中的一个或多个）。:)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2012-07-03T07:13:26.843

我遇到过同样的问题：

我使用的 System.Web.Optimization 版本对于 MVC4 RC 来说已经过时了。

我使用 VS 2010 中的包管理器更新了我的包。

在这个[MSDN 博客](http://blogs.msdn.com/b/rickandy/archive/2012/06/12/asp-net-mvc-4-beta-to-mvc-rc-upgrade-instructions.aspx)中，Andy 先生谈到了如何将您的 MVC 4 Beta 项目更新为 MVC 4 RC。更新我的包得到了为我解决的脚本（尤其是网络优化）：

要安装最新的 System.Web.Optimization 包，请使用包管理器控制台（工具 -> 库包管理器 -> 包管理器控制台）并运行以下命令：

```
Install-Package -IncludePrerelease Microsoft.AspNet.Web.Optimization 
```

在您的参考资料中使用包中包含的 System.Web.Optimization 文件。

更新其他包：工具菜单 -> 库包管理器 -> 管理解决方案的 NuGet 包。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-06-16T00:40:43.953

创建一个新的 MVC 4 RC 互联网应用程序并运行它。导航到使用相同代码的登录

```
 @section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

允许 Login.cshtml 工作的是 Views\Web.config 文件（不是应用根版本）包含

```
<namespaces>

    <add namespace="System.Web.Optimization"/>

  </namespaces> 
```

为什么您的创建视图不起作用而登录是？

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-06-02T09:23:01.853

在剃刀视图顶部导入 System.Web.Optimization，如下所示：

```
@using System.Web.Optimization 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-08-08T12:22:43.487

我遇到了这个问题，但是在运行命令时：

```
Install-Package -IncludePrerelease Microsoft.AspNet.Web.Optimization 
```

我收到了一个神秘的信息（在第一杯咖啡之前一定要喜欢一个伟大的双关语）：

> 安装包：此平台不支持指定的加密算法。

我在 Windows XP SP3 上运行它（不是选择），我发现我必须遵循用户*artsnob*在[ASP.NET 论坛上发布的说明](http://forums.asp.net/t/1807607.aspx/1)

*   请卸载 Nuget 并尝试重新安装。如果您无法执行此操作，请以管理员身份登录。
*   转到工具 => 扩展管理器 => 选择“Nuget 包管理器” => 卸载
*   通过搜索“Nuget”=> 安装再次安装它。
*   如果还是不行，请尝试安装，1.7.x版本，我在上一篇文章中提到过（不是说，你必须使用以前的版本，如果可以正常，我们可以报告这个错误，并获得最新版本的补丁）。

一旦我运行了它，我就可以运行命令行来更新 Web.Optimization。

希望这可以节省一些人的挖掘。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-06-08T16:14:48.120

写吧

```
@section Scripts{
    <script src="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/bundles/jqueryval")"></script>
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-07-10T17:51:04.693

我从 Beta 升级到 RC 并面临“脚本”不存在问题。在网上冲浪，最终的解决方案是 N40JPJ 所说的加上另一个 workaroudn：

在 View\Web.config 中复制以下内容：

```
 <namespaces>
    <add namespace="System.Web.Mvc" />
    <add namespace="System.Web.Mvc.Ajax" />
    <add namespace="System.Web.Mvc.Html" />
    <add namespace="System.Web.Routing" />
    <add namespace="System.Web.Optimization"/>
    <add namespace="System.Web.Helpers"/>
  </namespaces> 
```

以及 View\Shared_Layout.cshtml 中的以下内容

```
@if (IsSectionDefined("scripts")) 
{
       @RenderSection("scripts", required: false)
} 
```

希望能帮助到你。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-13T15:37:54.910

将项目从 MVC3 升级到 MVC4 时，我遇到了非常相似的错误。

> 编译器错误消息：CS0103：名称 [blah] 在当前上下文中不存在

就我而言，我的几个 Web.Config 中有过时的版本号。

1.  我需要在项目中的每个 Web.Config 中将 System.Web.Mvc 版本号从“3.0.0.0”更新为“4.0.0.0”。
2.  我需要将项目中每个 Web.Config 中的所有 System.Web.WebPages、System.Web.Helpers 和 System.Web.Razor 版本号从“1.0.0.0”更新为“2.0.0.0”。

**前任：**

```
<configSections>
  <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
    <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
    <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
  </sectionGroup>
</configSections>

...

<compilation debug="true" targetFramework="4.0">
  <assemblies>
    <add assembly="System.Web.Helpers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add assembly="System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
  </assemblies>
</compilation> 
```

*请务必查看每个 Views 目录中的 Web.Configs。*

您可以阅读有关[将 ASP.NET MVC 3 项目升级到 ASP.NET MVC 4 的](http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253806)更多信息。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-02-26T07:30:20.873

显然，您创建了一个没有“脚本”文件夹的“空”项目类型。我的建议 - 创建一个带有完整“脚本”文件夹的“基本”项目类型。

对于所有开发人员。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-05-16T08:44:21.027

只需从控制器的创建和编辑剃刀视图中删除/隐藏代码。

```
 @section Scripts {  

   @Scripts.Render("~/bundles/jqueryval")  
 } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-05-23T13:25:04.153

1.  ：删除查看页面。
2.  : 添加命名空间 webconfig（在视图目录中）
3.  : 创建视图试试看！

祝你好运...

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-09-06T15:37:42.167

还有一个问题 - 花了很长时间试图解决同样的问题 - 即使它是在 web.config 中为 root 和 Views 的根定义的。原来我错误地将它添加到`<system.web><pages><namespaces>`, 而不是`<system.web**.webPages.razor**><pages><namespaces>`元素。

真的很容易错过！

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-10-18T01:00:00.937

当我进入具有此代码的页面时：

```
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

发生此错误：**错误。处理您的请求时发生错误。**

这个异常记录在我的日志中：

```
System.Web.HttpException (0x80004005): The controller for path '/bundles/jqueryval' was not found or does not implement IController.
   em System.Web.Mvc.DefaultControllerFactory.GetControllerInstance(RequestContext requestContext, Type controllerType)
... 
```

我已经尝试了此页面上的所有提示，但没有一个为我解决。所以我查看了我的 Packages 文件夹并注意到我有两个版本的 System.Web.Optmization.dll：

*   Microsoft.AspNet.Web.Optimization.1.1.0 **(v1.1.30515.0 - 68,7KB)**
*   Microsoft.Web.Optimization.1.0.0-beta **(v1.0.0.0 - 304KB)**

我的项目引用了旧的 beta 版本。我只更改了对较新版本 (69KB) 的引用，一切正常。

我认为这可能对某人有所帮助。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-10-18T01:21:03.250

这有一个明显的解决方案。我后来也遇到了同样的问题。与Assembly References 或...无关。当您有复杂的页面结构时，它会发生在MVC Partial 视图的层次结构调用中。因此，在每个页面（可能是母版页或部分页面）上分别调用/渲染每个部分将导致看不到页面的所需部分，如以下代码：

```
@RenderSection("Scripts", required: false) 
```

这只是强制页面查找和呈现相关部分，并在失败的情况下向您显示像您这样的错误消息。

所以我建议你跟踪你的页面（如程序跟踪）从 master 到它的所有部分到**Detect Dependencies**。也许这是一项糟糕的工作，但这里没有其他选择。

**并不是说根据我的经验，编程中的某些条件情况会导致无法向您显示正确的错误会导致问题。**

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-12-06T12:48:48.380

在将区域添加到没有任何区域的项目后，我遇到了这个问题。为了摆脱它，只需将带有根 Views 文件夹的 web.config 复制到该区域的 Views 文件夹中，它就开始工作了。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-03-14T22:11:13.020

我通过在 _Layout.cshtml 中添加这部分代码来解决 MvcMusicStore 中的这个问题

```
@if (IsSectionDefined("scripts")) 
{
       @RenderSection("scripts", required: false)
} 
```

并从 Edit.cshtml 中删除此代码

```
 @section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

运行程序 inshallah 将与您一起工作。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-10-14T08:08:12.103

对我来说，这解决了这个问题，在 NuGet 包管理器控制台中写入以下内容：

```
update-package microsoft.aspnet.mvc -reinstall 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-10-25T16:33:33.247

当我最近开始使用 MVC4 时，我在使用空模板创建项目时遇到了上述问题。解决问题的步骤。

1.  Goto `TOOLS`--> `Library Package Manager`-->`Packager Manager Console` 粘贴下面的命令并回车 `Install-Package Microsoft.AspNet.Web.Optimization` 注意：等待安装成功。
2.  转到根级别的 Web.Config 文件并在页面命名空间部分中添加以下命名空间。添加`<namespace="System.Web.Optimization" />`
3.  转到 Views 文件夹中的 Web.Config 并按照步骤 2 操作。
4.  构建解决方案并运行。

步骤 1 中提到的包将向解决方案引用中添加一些系统库，例如 System.Web.Optimization 不是 MVC4 中空模板的默认引用。

我希望这有帮助。谢谢

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-07-25T16:47:31.527

如果您添加到 web.config 并且它仍然显示消息，那么您需要关闭您的项目并重新打开它，现在它将存在并且 @Styles.Render("") 和 @Scripts.Render() 将正常工作。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2013-04-14T20:55:29.477

试试这个：

```
@section Scripts 
{
    Scripts.Render("~/bundles/jqueryval")  // <- without ampersand at the begin
} 
```

# java - 在 Java 中检查 NULL 对象的最佳方法

> ID：10951671
> 
> 赞同：2
> 
> 时间：2012-06-08T15:23:23.893
> 
> 标签：java, list, null

我有一个解决方案来**检查从对象中提取的 NULL**值，但是我觉得可能有比我在这里做的最好的方法。所以请建议我使用代码片段的**最佳方法:)**

我会将我的 xml 内容传递给解组方法，然后将 unmarshalledValues 传递给空检查方法（即 ValidateInputFiled ）

```
Contents unmarshalledValues = unmarshalingContent( xml ); 
inputCheck = ValidateInputField( unmarshalledValues ); 
```

我的 XML 元素有一个 POJO，如下所述，

```
 @XmlRootElement( name = "contents" )
    public class Contents
    {
        @XmlElement
        String A;

        @XmlElement
        String B;

        @XmlElement
        String C;

        @XmlAttribute
        String D;

       public String getA()
      {
        return A;
      }

       public String getB()
      {
        return B;
      }

       public String getC()
      {
        return C;
      }

       public String getD()
      {
        return D;
      }
} 
```

我已经定义了 ValidateInputFiled 如下所述

```
public Boolean ValidateInputField( Contents unmarshalledValues )
    {
        int checker = 0;
        Boolean listCheck = false;

        // Extracting unmarshalled values from xml
        String A= unmarshalledValues.getA();
        String B= unmarshalledValues.getB();
        String C = unmarshalledValues.getC();
        String D= unmarshalledValues.getD();

        if ( A== null || A.isEmpty() )
        {
            checker++;
        }

        if ( B== null || B.isEmpty() )
        {
            checker++;
        }

        if ( C== null || C.isEmpty() )
        {
            checker++;
        }

        if ( D== null || D.isEmpty() )
        {
            checker++;
        }

        if ( checker == 0 )
        {
            listCheck = true;
        }

        return listCheck;

    } 
```

在这里，我希望避免对每个字符串值（即 A、B、C、D）进行 NULL 检查，而是可以只使用集合或列表对 Contents 或 unmarshalledValues 进行空检查吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T15:26:44.513

```
public static boolean isNullOrEmpty(String a) {
    return a == null || a.isEmpty();
} 
```

为每个值调用它。您可能想考虑将它们全部添加到列表中，然后遍历它们，如果它们是 !isNullOrEmpty 则增加检查器以节省代码膨胀，如果您有很多字段。

PS：将您的字段设为私有以保留封装。

pps：不要`return checker == 0;`为了保持代码整洁而使用单独的布尔值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T15:33:28.460

那是你要找的吗？

```
public Boolean ValidateInputField(Contents unmarshalledValues) {
    // Extracting unmarshalled values from xml
    String A = unmarshalledValues.getA();
    String B = unmarshalledValues.getB();
    String C = unmarshalledValues.getC();
    String D = unmarshalledValues.getD();
    return checkNull(A, B, C, D);
}

private static boolean checkNull(String... strings) {
    for (String string : strings) {
        if (string == null || string.isEmpty()) {
            return false;
        }
    }
    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:31:04.010

我使用 apache commons StringUtils 库来处理这类事情。它有一个检查，包括 null 或空格，以及其他组合，具体取决于您如何处理空格。Jeff 给了你很多代码，但我喜欢它们包含的其他方法。

如果值 == null，您还可以通过将 getter 编码为返回 "" 来完全避免空值。这样您就不必检查每个字段是否为空。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T16:19:42.940

commons-lang 有一个可以使用的 Validate 类：

```
Validate.notNull( unmarshalledValues.getA() ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-03T09:37:53.867

Java 8 的非反射解决方案，不使用一系列 if，将流式传输所有字段并检查是否为空：

```
return Stream.of(id, name).allMatch(Objects::isNull); 
```

在避免反射锤的同时，这仍然很容易维护。这将为空属性返回 true。

# codeigniter - codeigniter 查找表单查询

> ID：10951678
> 
> 赞同：0
> 
> 时间：2012-06-08T15:23:53.700
> 
> 标签：codeigniter, codeigniter-url

嘿伙计们希望你能帮助我..

我被要求修复一个不工作的人的查询。修复查询是一个相当简单的问题，但我似乎无法找到该查询所在的位置。我知道 php 和 mysql，但对 codeigniter 框架并不熟悉。任何方式，导致查询被调用的形式有

action="/support/managemyaccount/profile/search"

如果你能帮我弄清楚查询将在哪个文件中，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:30:44.390

The file should be called `support.php`, under the `application/controllers` folder.

Within that file, you should find only one class. Within that class, look for a method named `managemyaccount`. That's where your query is most likely to be.

# linux - 没有 X 的 Mesa3D

> ID：10951679
> 
> 赞同：1
> 
> 时间：2012-06-08T15:24:00.577
> 
> 标签：linux, mono, opengl-es-2.0, directfb, linux-from-scratch

在过去的 2 天里，我一直在搜索这个主题，但没有找到任何最新的答案。我有一个基于最新开发[LFS](http://www.linuxfromscratch.org/lfs/)（基于 Kernel 3.4.1）但没有安装 X 服务器的测试项目。而且我想使用将使用 OpenGL ES 2.x 的 Mono（或不使用）构建一个应用程序。

我可以使用 Mesa3D，但在他们的网站上，它取决于 X。我看到了 DRI，但它仍然基于 X。我偶然发现了带有 DirectFBGL 的[DirectFB](http://www.directfb.org/)，但后者大约有 8 年的历史......

所以问题是：有没有办法在 Linux 内核 3.4.1 上使用 Mono（或不使用）在没有 X 的情况下运行 OpenGL ES 2.x？

编辑 1：我现在的目标是 x86 或 x64 PC。那么使用 OpenGL ES 是否明智？

# mysql - mysql触发器在更新时更新父记录

> ID：10951680
> 
> 赞同：0
> 
> 时间：2012-06-08T15:24:07.990
> 
> 标签：mysql, triggers, parent-child

我有两张桌子，一张叫`note_category`，另一张叫`fs_note`。
`note_category`表结构为：

```
ID | CTG_ENG_TITL | CTG_PARENT_ID 
```

`fs_note`表结构为：

```
ID | NOTE_CAT | CRNT_YEAR_VAL| PRV_YEAR_VAL 
```

我想在`fs_note`表上创建触发器以进行以下操作：

1.  添加后：根据类别表层次将最后插入的记录的`CRNT_YEAR_VAL`和添加`PRV_YEAR_VAL`到其父注释中。
2.  删除前：根据分类表层级从其父注释中减去要删除的记录的`CRNT_YEAR_VAL`和。`PRV_YEAR_VAL`
3.  更新前：与第 2 项相同。
4.  更新后：执行与第 1 项相同的操作。

问题是我希望它是递归的，因为我有无限的类别深度，例如，如果我有：

```
Note1:
    Note1.1:
        Note1.1.1
        Note1.1.2
    Note1.2:
        Note1.2.1 
```

我希望将 的值`Note1.2.1`添加到 的值中，并将`Note1.2`的值添加到 的值中。然后将和的值添加到 的值中，以此类推。`Note1.1.1``Note1.1.2``Note1.1``Note1.1``Note1.2``Note1`

任何想法如何做到这一点？

# ruby-on-rails - before_destroy 回调会停止但也会更新模型？

> ID：10951685
> 
> 赞同：0
> 
> 时间：2012-06-08T15:24:31.030
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在使用回调来停止销毁操作，而是想设置 :archived_at 字段。问题是，我的 before_destroy 中的“return false”会导致回滚，从而消除我的更新。解决方案？

```
class MarkArchived
  def before_destroy(model)
    update_attribute(:archived_at, Time.now) and return false
  end
end

class User < ActiveRecord::Base
  before_destroy MarkArchived
end

class Account < ActiveRecord::Base
  before_destroy MarkArchived
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:32:57.767

如果我理解正确，您希望您的一些对象（或某些类别的对象）被存档，永远不会被销毁？我认为[这颗宝石](https://github.com/radar/paranoia)可能适合您使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-08T19:18:34.530

像这样的东西？

```
def hide_or_destroy
  if shifts.any?
    update(hidden: true)
  else
    destroy
  end
end 
```

# arrays - 如何在数组中搜索字符串

> ID：10951687
> 
> 赞同：48
> 
> 时间：2012-06-08T15:24:50.153
> 
> 标签：arrays, vba

是否有一个简单的（单行）在 VBA 的数组中搜索字符串？还是我需要遍历每个元素并将其与目标字符串进行比较？

编辑：它是一个一维数组。我只需要知道*一个*字符串是否在数组中的某个位置。

IE：

```
names(JOHN, BOB, JAMES, PHLLIP) 
```

如何确定“JOHN”是否在数组中，它需要最小，因为它将重复大约 5000 次，我不希望该函数减慢整个过程。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-06-08T16:31:36.577

如果你想知道是否在数组中找到了字符串，试试这个函数：

```
Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean
  IsInArray = (UBound(Filter(arr, stringToBeFound)) > -1)
End Function 
```

正如[SeanC 所](https://stackoverflow.com/a/10952084/190829)指出的，这必须是一维数组。

**例子：**

```
Sub Test()
  Dim arr As Variant
  arr = Split("abc,def,ghi,jkl", ",")
  Debug.Print IsInArray("ghi", arr)
End Sub 
```

（以下代码根据[HansUp](https://stackoverflow.com/questions/10951687/how-to-search-for-string-in-ms-access-vba-array#comment14354047_10952705)的评论更新）

如果你想要数组中匹配元素的索引，试试这个：

```
Function IsInArray(stringToBeFound As String, arr As Variant) As Long
  Dim i As Long
  ' default return value if value not found in array
  IsInArray = -1

  For i = LBound(arr) To UBound(arr)
    If StrComp(stringToBeFound, arr(i), vbTextCompare) = 0 Then
      IsInArray = i
      Exit For
    End If
  Next i
End Function 
```

这也假设一个一维数组。请记住 LBound 和 UBound 是从零开始的，因此索引 2 表示第三个元素，而不是第二个。

**例子：**

```
Sub Test()
  Dim arr As Variant
  arr = Split("abc,def,ghi,jkl", ",")
  Debug.Print (IsInArray("ghi", arr) > -1)
End Sub 
```

**如果您有一个特定的示例，请用它更新您的问题，否则示例代码可能不适用于您的情况。**

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-04-15T12:00:21.183

另一种选择是使用字典而不是数组：

```
Dim oNames As Object
Set oNames = CreateObject("Scripting.Dictionary")
'You could if need be create this automatically from an existing Array
'The 1 is just a dummy value, we just want the names as keys
oNames.Add "JOHN", 1
oNames.Add "BOB", 1
oNames.Add "JAMES", 1
oNames.Add "PHILIP", 1 
```

因为这会给你一个单行

```
oNames.Exists("JOHN") 
```

字典提供的优势是精确匹配而不是部分匹配`Filter`。假设您有一个数组中的原始名称列表，但正在寻找“JO”或“PHIL”，除了我们开始的四个人之外，他们实际上是两个新人。在这种情况下，`Filter(oNAMES, "JO")`将匹配*可能*不需要的“JOHN”。用字典，它不会。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-06-02T01:46:51.477

另一个强制精确匹配（即没有部分匹配）的选项是：

```
Function IsInArray(stringToBeFound As String, arr As Variant) As Boolean
  IsInArray = Not IsError(Application.Match(stringToBeFound, arr, 0))
End Function 
```

[您可以在http://msdn.microsoft.com/en-us/library/office/ff835873(v=office.15).aspx](http://msdn.microsoft.com/en-us/library/office/ff835873(v=office.15).aspx)阅读有关 Match 方法及其参数的更多信息

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-08T15:48:52.383

有一个函数将返回找到的所有字符串的**数组**。

`Filter(sourcearray, match[, include[, compare]])`
sourcearray 必须是一维
的 该函数将返回数组中包含`match`字符串的所有字符串

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-04-15T03:54:00.533

这是另一个答案。它工作快速、可靠（参见 atomicules 的回答）并具有紧凑的调用代码：

```
' Returns true if item is in the array; false otherwise.
Function IsInArray(ar, item$) As Boolean
    Dim delimiter$, list$

    ' Chr(7) is the ASCII 'Bell' Character.
    ' It was chosen for being unlikely to be found in a normal array.
    delimiter = Chr(7)

    ' Create a list string containing all the items in the array separated by the delimiter.
    list = delimiter & Join(ar, delimiter) & delimiter

    IsInArray = InStr(list, delimiter & item & delimiter) > 0
End Function 
```

**示例用法：**

```
Sub test()
    Debug.Print "Is 'A' in the list?", IsInArray(Split("A,B", ","), "A")
End Sub 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-06-17T07:57:34.473

更简单的功能也适用于 Apple OS：

```
Function isInArray(ByVal stringToBeFound As String, ByVal arr As Variant) As Boolean
Dim element
For Each element In arr
    If element = stringToBeFound Then
        isInArray = True
        Exit Function
    End If
Next element
End Function 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-08-04T13:08:05.340

这是我的代码，灵感来自@atomicules

```
Public Function IsName(name As String) As Boolean
  Dim names As Object
  Set names = CreateObject("System.Collections.ArrayList")

  names.Add "JOHN"
  names.Add "BOB"
  names.Add "JAMES"
  names.Add "PHLLIP"

  IsName = names.Contains(name)

End Function 
```

这是用法：

```
If IsName("JOHN") Then ... 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-15T04:19:25.557

如果它是一个常量列表，那么您可以使用 Select Case，如下所示：

```
Dim Item$: Item = "A"

Select Case Item
  Case "A", "B", "C"
    ' If 'Item' is in the list then do something.
  Case Else
    ' Otherwise do something else.
End Select 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-02-22T10:12:48.730

**完成对 Jimmy Pena 接受的答案的评论**

> *正如[SeanC 所](https://stackoverflow.com/a/10952084/190829)指出的，这**必须**是一维数组。*

以下示例调用演示了该`IsInArray()`函数不能*仅对**1-dim*数组调用，也*可*用于**“平面”2-dim**数组：

```
Sub TestIsInArray()
    Const SearchItem As String = "ghi"
    Debug.Print "SearchItem = '" & SearchItem & "'"
    '----
    'a) Test 1-dim array
    Dim Arr As Variant
    Arr = Split("abc,def,ghi,jkl", ",")
    Debug.Print "a) 1-dim array " & vbNewLine & "   " & Join(Arr, "|") & " ~~> " & IsInArray(SearchItem, Arr)
    '----

        '//quick tool to create a 2-dim 1-based array
        Dim v As Variant, vals As Variant                                       
        v = Array(Array("abc", "def", "dummy", "jkl", 5), _
                  Array("mno", "pqr", "stu", "ghi", "vwx"))
        v = Application.Index(v, 0, 0)  ' create 2-dim array (2 rows, 5 cols)

    'b) Test "flat" 2-dim arrays
    Debug.Print "b) ""flat"" 2-dim arrays "
    Dim i As Long
    For i = LBound(v) To UBound(v)
        'slice "flat" 2-dim arrays of one row each
        vals = Application.Index(v, i, 0)
        'check for findings
        Debug.Print Format(i, "   0"), Join(vals, "|") & " ~~> " & IsInArray(SearchItem, vals)
    Next i
End Sub 
```

```
Function IsInArray(stringToBeFound As String, Arr As Variant) As Boolean
'Site: https://stackoverflow.com/questions/10951687/how-to-search-for-string-in-an-array/10952705
'Note: needs a "flat" array, not necessarily a 1-dimensioned array
  IsInArray = (UBound(Filter(Arr, stringToBeFound)) > -1)
End Function 
```

**VB 编辑器的即时窗口中的结果**

```
SearchItem = 'ghi'
a) 1-dim array 
   abc|def|ghi|jkl ~~> True
b) "flat" 2-dim arrays 
   1          abc|def|dummy|jkl|5         False
   2          mno|pqr|stu|ghi|vwx         True 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-04T17:52:29.883

您可以在没有 wrapper 函数的情况下使用以下内容，但它提供了更好的 API：

```
Function IsInArray(ByVal findString as String, ByVal arrayToSearch as Variant) as Boolean
  IsInArray = UBound(Filter(arrayToSearch,findString)) >= 0
End Function 
```

该`Filter`函数具有以下签名：

`Filter(sourceArray, stringToMatch, [Include As Boolean = True], [Compare as VbCompareMethod = vbBinaryCompare])`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-10T22:39:42.177

声明可能更`Case`简单地适合某些应用程序：

```
select case var
case "a string", "another string", sVar
  'do something
case else
  'do something else
end select 
```

# sql-server - Sql Server transform a select row into multiple rows base on time values

> ID：10951692
> 
> 赞同：0
> 
> 时间：2012-06-08T15:25:13.523
> 
> 标签：sql-server, sql-server-2005

Please look the following query:

```
SELECT ID, START, END FROM TABLEA 
```

the result is:

```
ID       START                      END
1        2012-06-07 19:32:00        2012-06-08 06:00:00
2        2012-06-08 06:00:00        NULL 
```

But I want really a result like this:

```
START                      END
2012-06-07 19:32:00        2012-06-07 23:59:59
2012-06-08 00:00:00        NULL 
```

The id no matters.

And look at this example:

```
 ID       START                      END
    1        2012-06-06 19:32:00        2012-06-08 06:00:00
    2        2012-06-08 06:00:00        NULL 
```

It Must be:

```
 START                      END
        2012-06-06 19:32:00        2012-06-06 23:59:59
        2012-06-07 00:00:00        2012-06-07 23:59:59
        2012-06-08 00:00:00        NULL 
```

The idea is to generate rows with the start and end values within the same day.

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:39:22.880

The following solution does everything you want, all in SQL. It merges overlapping and contiguous timespans (including wholly-overlapping timespans) and also breaks out multi-day timespans by date using a calendar table.

```
declare @TimeSheetEntries table 
    ( 
    ID int identity not null primary key, 
    [Start] datetime not null, 
    [End] datetime null 
    ); 

declare @CalendarTable table
(
    CalDate datetime
)

DECLARE @CurDate datetime = '2000-01-01 00:00:00';

WHILE @CurDate <= '2020-12-31'
BEGIN
    INSERT INTO @CalendarTable
    SELECT @CurDate;

    SELECT @CurDate = DATEADD(day,1,@CurDate);
END

insert into @TimeSheetEntries 
    ( 
    [Start], 
    [End] 
    ) 
select 
    '2012-06-06 19:32:00', 
    '2012-06-08 06:00:00' 
union all select 
    '2012-06-08 06:00:00', 
    NULL
union all select 
    '2012-06-08 02:00:00', 
    '2012-06-08 03:00:00' 
union all select 
    '2012-01-01 14:09:00', 
    '2012-01-01 17:30:00'
union all select
    '2012-01-01 18:30:00', 
    '2012-01-01 19:30:00';

WITH ClockData AS
(
    SELECT ID, [Start], [End] AS EffectiveEnd, [Start] AS LastStart, 1 AS NumTimespans
    FROM @TimeSheetEntries ts
    WHERE NOT EXISTS 
    (
        SELECT tsWhere.ID FROM @TimeSheetEntries tsWhere 
        WHERE
            tsWhere.ID <> ts.ID -- don't match yourself!
            AND tsWhere.[Start] < ts.[Start]
            AND
            (
                -- Three types of things we don't want our outer SELECT to return
                -- 1) Completed timespans with another appointment's end date sitting inside;
                -- 2) Incomplete timespans (NULL ClockedOut) with another appointment's end date after ClockedIn
                -- 3) Any timespan wholly inside another one
                (ts.[End] IS NULL AND tsWhere.[End] >= ts.[Start]) OR
                (ts.[End] IS NOT NULL AND tsWhere.[End] BETWEEN ts.[Start] AND ts.[End]) OR
                (tswhere.[End] > ts.[End])
            )
    )

    UNION ALL

    SELECT cd.ID, cd.[Start], ts.[End] AS EffectiveClockout, ts.Start AS LastStart, cd.NumTimespans + 1 AS NumTimespans
    FROM @TimeSheetEntries ts
    INNER JOIN ClockData cd
            ON ts.[Start] BETWEEN cd.[Start] AND cd.EffectiveEnd AND ts.ID <> cd.ID 
                AND (ts.[End] IS NULL OR ts.[End] > cd.EffectiveEnd)
),
MergedTimespans AS
(
    SELECT [ID], [Start], [EffectiveEnd], [LastStart]
    FROM ClockData cd
    WHERE NumTimespans = (SELECT MAX(NumTimespans) FROM ClockData WHERE ID = cd.ID)
)
SELECT 
    CASE 
        WHEN mt.Start > cal.CalDate 
            THEN mt.Start 
        ELSE cal.CalDate 
    END AS [Start],
    CASE 
        WHEN (mt.EffectiveEnd IS NOT NULL AND mt.EffectiveEnd >= DATEADD(day,1,cal.CalDate)) OR (mt.EffectiveEnd IS NULL AND cal.CalDate < CAST(mt.LastStart AS date)) THEN DATEADD(second, -1,DATEADD(day,1,cal.CalDate))
        ELSE mt.EffectiveEnd
    END AS [End]
FROM MergedTimespans mt
    INNER JOIN @CalendarTable cal
        ON (mt.EffectiveEnd IS NULL AND cal.CalDate BETWEEN CAST(mt.Start AS date) AND mt.LastStart) -- Handle NULL end dates
         OR (mt.EffectiveEnd IS NOT NULL AND cal.CalDate BETWEEN CAST(mt.Start AS date) AND mt.EffectiveEnd)
ORDER BY Start 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:36:57.990

```
 with       cte
      AS ( SELECT   MIN(START) AS MinStart ,
                    MAX(START) AS MaxStart
           FROM     TableA
           UNION ALL
           SELECT   DATEADD(DAY, 1, MinStart) ,
                    MaxStart
           FROM     cte
           WHERE    DATEADD(DAY, 1, MinStart) BETWEEN MinStart AND MaxStart
         )
SELECT  MinStart AS START ,
        DATEADD(millisecond, -3, FLOOR(CAST(MinStart AS FLOAT)) + 1) AS [End]
FROM    cte 
```

# php - json_encode 没有转义 UTF-8 w/PHP 5.2.8

> ID：10951703
> 
> 赞同：0
> 
> 时间：2012-06-08T15:25:57.020
> 
> 标签：php, json

尝试使用 jQuery 解析时会导致 JSON 非法。整个文档，数据库连接是用 UTF-8 编码的。

编码

```
header('Content-Type: application/json; charset=utf-8');
echo (json_encode($products)); 
```

这是输出**（更新）**：

```
{
  "D8": {
    "title": "Green A\/C U\/V Dye Self-Measure bottle treats 32 véhicules 8 oz. (237 ml)",
    "image": "http:\/\/www.supercool.ac\/wp-content\/uploads\/2011\/10\/D8.png",
    "Description": "<ul>\n<li>Efficace dans le R-134a et R-12 systèmes de réfrigération<\/li>\n<li>Detectable when exposed to U\/V light<\/li>\n<li>Compatible avec PAG, ester, les huiles minérales et<\/li>\n<li>Ne contient pas de solvants!<\/li>\n<li>Will not harm A\/C systems or recovery equipment<\/li>\n<li>Universal A\/C Dye Safe for Hybrid and<br \>\n&nbsp;Véhicules électriques<\/li>\n<li>Partie # D8<\/li>\n<\/ul>\n"
  }
} 
```

这不应该默认转义吗？我能做些什么来逃避它？

**更新：**

json_encode 正在破坏 HTML（描述字段）。它产生了一个无效的 br 标签`<br />`，注意正斜杠。我认为这仅限于 5.2.8。为了纠正这个问题，我只是去掉了 br 标签作为临时解决方案，直到我可以说服主机升级。

```
preg_replace('/\<br\s\/>/', '', string); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:35:12.360

[http://codepad.org/oWMMVwsE](http://codepad.org/oWMMVwsE)

PHP 将对 utf8 字符进行编码。

[http://jsfiddle.net/](http://jsfiddle.net/)

jQuery 可以很好地解析它。

如果您将其回显到浏览器，请不要忘记浏览器将解释 utf8 编码并显示字符。因此必须从 CLI 或源中读取 json 编码的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:36:49.810

您的输出在最后一个属性值之后有一个逗号：

```
 },
} 
```

这是无效的 JSON。看起来您的 PHP 副本具有严重损坏的`json_encode`.

我会考虑在全新安装 PHP 的干净虚拟机上尝试您的代码。

# c++ - 如何使用 C++ 在 Win 上读写 UTF16 文件

> ID：10951706
> 
> 赞同：1
> 
> 时间：2012-06-08T15:26:06.933
> 
> 标签：c++, windows, utf, wofstream, wifstream

关于这一点有很多关于 SO 的问题，但其中大多数都没有提到将 wstring 写回文件。因此，例如，我发现这是为了阅读：

```
// open as a byte stream
std::wifstream fin("/testutf16.txt", std::ios::binary);
// apply BOM-sensitive UTF-16 facet
fin.imbue(std::locale(fin.getloc(),
    new std::codecvt_utf16<wchar_t, 0x10ffff, std::consume_header>));
// read  
std::wstring ws;
for(wchar_t c; fin.get(c); )
{
    std::cout << std::showbase << std::hex << c << '\n';
    ws.push_back(c);
} 
```

我尝试了类似的东西来写作：

```
 std::wofstream wofs("/utf16dump.txt", std::ios::binary);
    wofs.imbue(std::locale(wofs.getloc(),
        new std::codecvt_utf16<wchar_t, 0x10ffff, std::consume_header>));
    wofs << ws; 
```

但它会产生垃圾，（或 Notpad++ 和 vim 无法解释它）。正如标题 Im on Win、本机 C++、VS 2010 中所述。

输入文件：

```
t€stUTF16✡
test 
```

结果是这样的：

```
tâ‚¬stUTF16âœ¡
test 
```

转换为十六进制：

```
0000000: 7400 ac20 7300 7400 5500 5400 4600 3100  t.. s.t.U.T.F.1.
0000010: 3600 2127 0d00 0a00 7400 6500 7300 7400  6.!'....t.e.s.t.
0000020: 0a                                       
                     ... 
```

vim 正常输出：

> t^@¬ s^@t^@U^@T^@F^@1^@6^@!'^M^@ ^@t^@e^@s^@t^@

编辑：我最终使用了 UTF8。Andrei Alexandrescu 说这是最好的编码，所以没有大的损失。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:37:40.927

您的*类似*代码 - 不是。您删除了`std::ios::binary`样式，尽管[文档](http://msdn.microsoft.com/en-us/library/ee292208.aspx)说

> 字节流应写入二进制文件；如果写入文本文件，它可能会损坏。

ASCII 模式下的 NL->CRLF 转换不会对 UTF-16 文件做任何漂亮的事情，因为它将插入一个字节 0x0D 而不是两个字节 0x00 0x0D。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-20T17:11:43.330

如果您使用`C++11`标准，这很容易（因为有很多额外的包含`"utf8"`可以永远解决这个问题）。

但是如果你想使用旧标准的多平台代码，你可以使用这种方法来编写流：

1.  [阅读有关流的 UTF 转换器的文章](http://www.codeproject.com/Articles/38242/Reading-UTF-8-with-C-streams)
2.  `stxutif.h`从上面的来源 添加到您的项目
3.  以 ANSI 模式打开文件并将 BOM 添加到文件的开头，如下所示：

    ```
    std::ofstream fs;
    fs.open(filepath, std::ios::out|std::ios::binary);

    unsigned char smarker[3];
    smarker[0] = 0xEF;
    smarker[1] = 0xBB;
    smarker[2] = 0xBF;

    fs << smarker;
    fs.close(); 
    ```

4.  然后打开文件`UTF`并在那里写下你的内容：

    ```
    std::wofstream fs;
    fs.open(filepath, std::ios::out|std::ios::app);

    std::locale utf8_locale(std::locale(), new utf8cvt<false>);
    fs.imbue(utf8_locale); 

    fs << .. // Write anything you want... 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:44:14.940

对于输出，您想使用`generate_header`而不是`consume_header`.

请参阅[http://en.cppreference.com/w/cpp/locale/codecvt_mode](http://en.cppreference.com/w/cpp/locale/codecvt_mode)

# tfs - TFS 或 Teamcity，如何自动部署到各种环境？

> ID：10951714
> 
> 赞同：3
> 
> 时间：2012-06-08T15:27:05.073
> 
> 标签：tfs, continuous-integration, teamcity

寻求有关如何处理此场景的建议。

我们有 3 个环境：Dev、QA 和 Production。

目前将代码推送到每个环境是一个手动过程，想知道 Cruisecontrol 或 TeamCity 之类的东西如何简化这个过程。

我们如何以自动化的方式推送到各种环境？

应该如何设置 TFS 来实现这一点？即主分支，功能分支等。

场景：

Developer#1 将他们的更改推送到 Dev 和 QA 服务器。Developer#2 将他们的更改推送到 Dev 和 QA 服务器。

现在我们只需要将 Developer#1 的更改推送到生产环境。

主分支是否应该只有应该投入生产的代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-09T02:08:29.647

为了控制推送到每个环境的内容，KMoraz 的方法是正确的，使用分支和合并。

现在，对于构建和部署自动化，我一直在使用的最新设置是 Team City。

我的设置是：

*   **主干构建**：每次提交时编译，运行所有单元测试，生成代码覆盖率报告，运行 FxCop

*   **静态分析构建**：每晚针对 Trunk 运行，执行 Duplicate Finder（Team City）、[ConQAT 代码克隆分析](http://conqat.cs.tum.edu/index.php/ConQAT)、[StatSVN](http://statsvn.org/)和 Resharper 代码检查（Team City）

*   **DEV 部署**（依赖于 Trunk 构建）：每次提交时，如果 Trunk 构建成功，应用程序会自动部署到 DEV 环境，使用带有配置转换的 MS WebDeploy。

*   **QA 部署**：移动到 QA 时，通过 Team City 的界面（单击按钮）手动触发。使用带有配置转换的 MS WebDeploy 将应用程序部署到 QA 服务器。

您还可以根据需要为不同的分支设置构建，尤其是为稳定版本的发布创建的分支。

关键部分是有不同的 Visual Studio 构建配置（就像你有*"Release"*和*"Debug"*，你应该有*"Dev"*，*"QA"*等），你应该使用 web.config 转换顺序让 WebDeploy 为您配置环境。这样，您将拥有不同的*web.Dev.config*、*web.QA.config*转换，每个构建配置一个，具有特定的设置。

特洛伊·亨特 (Troy Hunt) 有一系列出色的帖子，名为“你部署错了！” 它指导您完成自动构建和部署的设置。

[http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity.html](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity.html)

设置它时对我非常有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T22:10:21.990

> 现在我们只需要将 Developer#1 的更改推送到生产环境。

-Developer #1 将他的代码签入到 Dev 分支。在 QA 验证了他的更改之后，现在您将更改合并到 Main 分支并从 Main 构建一个用于生产的版本。

> 主分支是否应该只有应该投入生产的代码？

-是的。理想情况下，生产版本应该从主分支构建。

> 我们如何以自动化的方式推送到各种环境？

- 在 TFS 中，一种常见的做法是为每个分支和/或构建类型定义构建定义。除了源代码和构建类型之外，每个定义还可以有自己的任务，即：运行单元测试、发布到特定文件夹、将构建工件部署到[实验室管理](http://www.microsoft.com/visualstudio/en-us/scenarios/virtual-lab-management)等。

```
ProjectName-Main-Gated 
ProjectName-Dev-CI
ProjectName-Dev-Nightly
ProjectName-Test-CI 
```

# javascript - 我的 PIXASTIC“Lighten.js”过滤器 Javascript 和 HTML5 代码不起作用

> ID：10951717
> 
> 赞同：0
> 
> 时间：2012-06-08T15:27:16.013
> 
> 标签：javascript, image-processing, html5-canvas, pixastic

这是我的代码，我做错了什么？图像当前显示在浏览器中，但没有变亮...

这是我的 HTML 代码，链接到从他们的下载站点构建的 custom.js 文件（它包括核心和减轻，仅此而已）

```
<!DOCTYPE HTML>
<html>
    <head>
        <script type="text/javascript" charset="utf-8" src="pixastic.custom (5).js"></script>
        <style>
            body {
                margin: 0px;
                padding: 0px;
            }
            #myCanvas {
                border: 1px solid #9C9898;
            }
        </style>
        <script>
            window.onload = function() {
                var canvas = document.getElementById("myCanvas");
                var context = canvas.getContext("2d");
                var imageObj = new Image();
                imageObj.onload = function() {
                    var options ={};
                    Pixastic.process(imageObj, "lighten", options)
                        {amount : .5
                    };
                    options.resultCanvas;
                    context.drawImage(imageObj, 80, 60);
                }

                imageObj.src = "IMAG8703.jpg";
            };
        </script>
    </head>
    <body>
        <canvas id="myCanvas" width="2000" height="4000"></canvas>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T20:06:39.490

看起来您的选项语法是错误的。直接在`process`函数中传递选项，如下所示：

```
Pixastic.process(imageObj, "lighten", {amount: .5}); 
```

或者，使用这样的数量初始化`options`变量：

```
var options = {amount: .5};
Pixastic.process(imageObj, "lighten", options); 
```

**编辑：** 此外，它在文档中指出，通过调用`options.resultCanvas`，您可以获得新的画布。所以，听起来你想要做的是这样设置：

```
canvas = options.resultCanvas; 
```

# java - 完全覆盖的代码能否具有低于 100% 的 EclEmma 覆盖率？

> ID：10951718
> 
> 赞同：5
> 
> 时间：2012-06-08T15:27:19.077
> 
> 标签：java, eclipse, code-coverage, emma, eclemma

我只是写了一些简单的示例代码来确保我正确安装了 EclEmma。我没有得到 100% 的覆盖率，我不明白为什么。突出显示意味着它与类名有关。这是我的代码，带有相应的 JUnit 测试，EclEmma 突出显示它的方式：

![算术课](../Images/14c27ca50c160dd22949603f24bab623.png)

![算术类测试](../Images/b839fb8add288d19c3acc25b82afda9d.png)

覆盖结果表明，三个指令`Arithmetic`没有受到影响，即使这两种实际方法似乎都被完全覆盖：

![覆盖信息](../Images/58d37c6ccc2eaae6df7bf33e9ccc59d3.png)

我已经阅读[了有关基本块覆盖的 EclEmma 文档](http://emma.sourceforge.net/faq.html#q.blockcoverage)，但我仍然感到困惑。我不确定错过了哪些基本块。起初，我认为 EclEmma 可能只是忽略了类的字节码，但`ArithmeticTest`似乎处理得很好。

我有两个密切相关的问题：

1.  这是否表明我安装/配置 EclEmma 的方式存在问题？
2.  完全覆盖的代码具有高但不是完全 100% 的 EMMA 覆盖率是否正常/可接受，如果是，它是如何工作的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T15:31:07.147

您的代码暗示了一个默认构造函数，Emma 无法正确标记该构造函数，因为它没有文本块。

由于它没有在文本块中正确标记，Emma 无法将覆盖日志与文本文件相关联，并且看起来有些代码没有被覆盖；因为，您运行了一些字节码，但无法注册行日志记录。稍后当报告元素读取行日志时，他们找不到默认构造函数的行号，并且它在唯一有意义的地方突出显示错误，即类声明行。

默认构造函数看起来像

```
public Arithmetic() {
  super();
} 
```

其中 super 是将构造的隐含的第一条指令`Object`。虽然您可能会忽略它的存在，但编译器会为您添加它。那就是你得到“3行”而不是1行的地方。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T15:30:43.110

我认为您要么需要测试实例化`Arithmetic`，要么声明其构造函数`private`以禁止实例化

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-08T15:30:27.693

IIRC，您需要实例化该类的一个实例来练习语言提供的构造函数。

# jquery - jScrollPane scrollTo（水平）设置，奇怪的闪烁

> ID：10951721
> 
> 赞同：0
> 
> 时间：2012-06-08T15:27:29.223
> 
> 标签：jquery, jquery-plugins, scroll, jscrollpane

我对 jScrollPane 插件有一个奇怪的问题。经过几天使用几种设置，我仍然没有发现我的错误。问题是当使用 jScrollPane 中的 scrollTo 函数时，它会变得很奇怪。要了解我的意思，请访问此[http://jsfiddle.net/DJb6U/](http://jsfiddle.net/DJb6U/)，然后单击“单击我”灰色 div。当 div 滚动时，查看 RESULT 的左侧。滚动向左移动 1 个像素，然后向右移动。我在这里做错了什么？我错过了什么还是这是一个错误？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T16:06:58.870

[在此处输入链接描述](http://jscrollpane.kelvinluck.com/)我也遇到了同样的问题，但可以通过使用 jScrollPane.js 文件末尾的插件定义属性来解决它。

看看它们，值得一试。

下面的代码给出了一个相当合理的解决方案：

```
showMe.find('.scroll-pane').jScrollPane({
    autoReinitialiseDelay: 10
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T06:55:18.483

我已经为一些项目以类似的方式实现了 jCarousel。它没有同样的问题，而且很容易实现和定制。

[http://sorgalla.com/jcarousel/](http://sorgalla.com/jcarousel/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T02:00:36.563

这是组件的错误。

请参阅[http://jscrollpane.kelvinluck.com/scroll_to_animate.html](http://jscrollpane.kelvinluck.com/scroll_to_animate.html)。该页面与您遇到的问题相同。

在[http://jscrollpane.kelvinluck.com/script/jquery.jscrollpane.js的](http://jscrollpane.kelvinluck.com/script/jquery.jscrollpane.js)**第 756**行设置断点以开始解决问题。

数学在这里没有帮助。该组件在计算方面做得不太好。它留下了精度。

# .net - WF4 - Rehosted Workflow Designer - 启用 PropertyInspectorView 的只读视图

> ID：10951723
> 
> 赞同：3
> 
> 时间：2012-06-08T15:27:32.887
> 
> 标签：.net, workflow, workflow-foundation-4, designer, workflow-rehosting

我编写了一个重新托管 Workflow 4 Designer (System.Activities.Presentation.WorkflowDesigner) 并显示 PropertyInspectorView 以允许修改活动参数的应用程序。我想做的是禁用设计器视图的修改（不能在其上放置新活动、重新排序、删除活动等），但在用户突出显示活动时仍使属性视图可编辑。基本上我希望能够部署绘制但未配置的工作流，并让其他人填写活动参数​​。

我尝试过的每个解决方案都会禁用整个设计器和属性视图。我尝试在视图上将 IsEnabled 设置为 false，并将 ReadOnlyState.IsReadOnly 设置为 true。

关于如何实现这种行为的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T12:05:54.847

我有同样的问题。WorkflowDesigner 控件没有这样的功能。我需要这样：

```
_Wd = new WorkflowDesigner();

//Setting WorkflowDesigner

_Wd.View.PreviewDragEnter += View_PreviewDrop;
_Wd.View.PreviewDrop += View_PreviewDrop;
_Wd.View.PreviewKeyDown += View_PreviewKeyDown;

void View_PreviewKeyDown(object sender, System.Windows.Input.KeyEventArgs e)
{
    e.Handled = true;
}

void View_PreviewDrop(object sender, DragEventArgs e)
{
    e.Handled = true;
} 
```

# heroku - Sinatra config.ru 加载错误

> ID：10951730
> 
> 赞同：2
> 
> 时间：2012-06-08T15:27:58.087
> 
> 标签：heroku, sinatra, datamapper

经过长时间的中断后，我想看看 Sinatra，所以我寻找了一个样板来让它在 Heroku 上快速运行，并找到了这个 > [https://github.com/froots/sinatra-heroku-boilerplate](https://github.com/froots/sinatra-heroku-boilerplate)

它似乎拥有我需要的一切，所以我做了*bundle install*，但每当我启动霰弹枪时，我都会遇到这个错误：

```
Something went wrong while loading config.ru

NameError: uninitialized constant Object::DataMapper 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T11:22:25.360

在 Gemfile 中，第 5 行 - 它应该是`gem 'data_mapper'`，而不是`gem "datamapper", ">=1.1.0"`

更新 gemfile 后，再做一次`bundle install`

**更新：**

我已经向作者提交了一个拉取请求来修复他的代码：[https ://github.com/froots/sinatra-heroku-boilerplate/pull/2](https://github.com/froots/sinatra-heroku-boilerplate/pull/2)

# spring-mvc - Spring MVC 打开 PDF 作为视图

> ID：10951731
> 
> 赞同：3
> 
> 时间：2012-06-08T15:28:04.903
> 
> 标签：spring-mvc

哪个是呈现现有 PDF 的合适视图类？抽象视图？

我正在通过网络服务获取 PDF，所以我不希望继承 AbstractPdfView 来呈现 PDF。

我想保留返回 ModelAndView 的 Spring 控制器类，这意味着编写我自己的 AbstractView 子类来将 PDF 写入 ServletOutputStream。Spring MVC 中提供的任何其他内置支持？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T07:33:15.140

我同意@Biju Kunjummen 的回答，但使用 iText 也可以很好地生成 PDF。

这是控制器方法的代码片段。

```
@RequestMapping(value = "/common/reportgenerator/generatePDF")
    public void generatePdf(HttpServletRequest req,HttpServletResponse res)
    {
        res.setContentType("text/html;charset=UTF-8");
        ServletOutputStream outStream=null;
        try 
        {
            String calledFrom = req.getHeader("referer");
            calledFrom=req.getRequestURL().substring(0,req.getRequestURL().lastIndexOf("/"))+"/ReportGenerator.egp";
            calledFrom += "?isPdf=yes&"+req.getQueryString();
            System.out.println(calledFrom+"?isPdf=yes&"+req.getQueryString());

            InputStream input = new URL(calledFrom).openStream();
            StringWriter writer = new StringWriter();
            CopyUtils.copy(input, writer);

            //System.out.println(writer.toString());

            res.setContentType("application/pdf");
            res.setHeader("Content-Disposition", "attachment;filename=report.pdf");
            outStream = res.getOutputStream();

            ITextRenderer renderer = new ITextRenderer();

            renderer.setDocument(calledFrom);
            renderer.layout();
            renderer.createPDF(outStream);

        } 
        catch (Exception e) 
        {
            new AbcException(e,exceptionHandlerService);
        }
        finally
        {
            try
            {
                outStream.flush();
                outStream.close();
            }
            catch(Exception ex)
            {
                new AbcException(ex,exceptionHandlerService);
            }

        }

    } 
```

希望这对您有所帮助。干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:27:29.537

我认为最好的方法是使用 HttpServletResponse 简单地将其流式传输：

```
OutputStream out = response.getOutputStream();

out.write(..); //buffer and write.. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-26T10:46:11.890

没有这样的课。

您必须手动写入该文件。请在此处查看答案： [使用 Spring MVC 在浏览器新窗口中显示存储在网络服务器上的 PDF 文件](https://stackoverflow.com/questions/15773247/display-the-pdf-file-stored-on-the-webserver-on-brower-new-window-using-spring-m)

我已将该代码更改为：

```
 // get absolute path of the application
 ServletContext context = request.getSession().getServletContext();
 String appPath = context.getRealPath("/");
 // construct the complete absolute path of the file
 String fullPath = appPath + "WEB-INF/pdfs/201507.pdf"; 
```

另外，请参阅不下载 pdf 并将 inputStream 放在 finally 块中的答案。

# spring - 在 @Bean 方法中创建的 Spring @Configuration bean 未由 CGLIB 增强

> ID：10951739
> 
> 赞同：2
> 
> 时间：2012-06-08T15:28:29.023
> 
> 标签：spring, spring-annotations

我正在尝试创建一个 MainConfig，它使用 @Bean 方法而不是 @Import 来导入另一个 Config，如下所示：

```
@Configuration
public class MainConfig {

  @Bean
  public Service service() {
    return new Service(infrastructureConfig().database());
  }

  @Bean
  public OtherService otherService() {
    return new OtherService(infrastructureConfig().database());
  }      

  @Bean
  public InfrastructureConfig intrastructureConfig() {
    return new InfrastructureConfig();
  }

}

@Configuration
public class InfrastructureConfig {

  @Bean
  public Database database() {
    return new Database();
  }

  ...
} 
```

使用这种技术时，会创建两次数据库，因为 Spring 似乎没有考虑 InfrastructureConfig 上的 @Configuration 注解。使用@Import 时，它工作正常。

我不想使用@Import，因为我想像这样模拟我的 InfrastructureConfig：

```
@Configuration
public class TestConfig extends MainConfig {

  @Override
  public InfrastructureConfig infrastructureConfig() {
    return mock(InfrastructureConfig.class);
  }
} 
```

我错过了什么还是不支持？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:38:23.707

当我第一次尝试 Spring Java 配置时，我想我做了同样的假设，当它不起作用时我感到很惊讶。

我不确定这是解决这个问题的最佳方法，但我已经成功使用了以下方法。

要包含该 @Configuration 类，您可以将此注释添加到您的`MainConfig`：

`@ComponentScan(basePackages = "org.foo", includeFilters = {@Filter(filterType = ANNOTATION, value = CONFIGURATION)}, excludeFilters = {@Filter(filterType = ASSIGNABLE_TYPE, value = MainConfig)})`

由于@Configuration 类也是组件扫描的候选对象，因此您可以扫描所有使用@Configuration 注释的类。由于您要放置此注释，因此`MainConfig`您需要使用 ASSIGNABLE_TYPE 过滤器排除它，因为您将获得循环引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T19:41:55.870

我开了一张 Spring 票[SpringSource JIRA](https://jira.springsource.org/browse/SPR-9485)，他们说这是一个已知的限制，它按设计工作。

# php - 安全密码存储

> ID：10951740
> 
> 赞同：3
> 
> 时间：2012-06-08T15:28:30.987
> 
> 标签：php, security, passwords, md5, password-protection

假设我有成千上万的用户，我想让密码非常安全。现在，我知道这`md5()`不是最安全的使用方法，但是我认为可以做的就是加盐（我知道这不是什么新鲜事）。因此，为此我正在考虑创建两个表，一个名为`accounts`，它将包含与帐户相关的所有信息，一个名为表列`salt`，第二个表将被称为类似`auth`并具有字段`account_id, password`

首先，我在注册时创建一个盐（随机生成）

```
$salt = "#52/sBsO8"; 
```

然后所有提供的信息都转到`accounts`salt 是其中之一

然后在成功将信息放入数据库后，我创建了要存储在`auth`表中的密码，这样密码不是用户输入的密码的 md5，而是盐的 md5 和用户输入的密码

所以密码`auth`是

```
$password = md5($user_entered_password . $salt); 
```

测试字符串：PHP 代码

```
$password = "123";
$salt = "#52/sBsO8";
echo md5($password) ." / ";
echo md5($password . $salt); 
```

输出：`202cb962ac59075b964b07152d234b70 / dfbf0b257c5182af0ae893c2680f4594`

问题是：这是一种非常安全的密码处理方式吗？由于`md5()`解密网站，有很多方法可以猜测密码。解密网站实际上并没有解密，`md5()`它们只是拥有数百万个字符串的 md5 哈希值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:40:33.960

md5 可能是“流行”散列算法中最不安全的。
由于您使用的是 PHP，因此更好的选择是`crypt`： http: [//php.net/manual/en/function.crypt.php](http://php.net/manual/en/function.crypt.php)

```
crypt($password, $salt) 
```

有关各种散列方法的良好比较，请参阅[Jeff Atwood 关于密码散列的帖子](http://www.codinghorror.com/blog/2012/04/speed-hashing.html)

关于蛮力基准测试的摘录：

**MD5** 23070.7 M/s
**SHA-1** 7973.8 M/s
**SHA-256** 3110.2 M/s
**SHA-512** 267.1 M/s
**NTLM** 44035.3 M/s
**DES** 185.1 M/s
**WPA/WPA2** 348.0 k/s

越低越好，尽管[现在 DES 太短而无法考虑](http://en.wikipedia.org/wiki/EFF_DES_cracker)（56 位，感谢@thebod）。

**编辑：**

虽然上面的基准方法中没有列出，但`crypt`支持的最佳哈希方法是河豚，这里有一个使用它的例子：

```
// $salt has to be built with exactly these components:
// '$2a$' . $2DigitsNumberAroundTen . '$' . $TwentyTwoLetters
$salt = '$2a$07$somesillystringforsalt';
crypt( $password, $salt ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:19:45.957

1.  密码的哈希函数应该很**慢**（需要一些计算时间）。大多数哈希算法的设计速度很快，但这使得为每种盐创建彩虹表变得更加容易。
2.  盐应该是**随机**的，并且应该为每个存储的密码单独生成。该盐必须与哈希一起存储，但不是秘密的（可以是纯文本）。盐使字典攻击更加困难，不同的盐使彩虹表变得不切实际。
3.  理想情况下，您可以稍后为新硬件调整计算时间，而不会破坏现有的哈希值。

这就是为什么你应该使用**bcrypt**来散列你的密码，它是专门为散列密码而设计的。不要害怕使用 bcrypt！它不仅适用于高安全性站点，而且使用起来就像使用 md5 哈希一样简单。

建议使用完善的库，如[phpass](http://www.openwall.com/phpass/)，如果您想了解 PHP 如何生成此类哈希，可以阅读这篇[文章](http://www.martinstoeckli.ch/php/php.html#ssl_bcrypt)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-08T15:41:13.490

为什么你认为这更安全？用户输入密码。假设用户不是白痴并选择了他只知道的东西。如果那个人用 输入它有什么不同`salt`？

这实际上使它更加不安全，因为如果一个人拿到桌子，那个人就有事情要做。

您最好将精力花在确保计算机安全、网络安全以及教您的用户使用合理且安全的密码上。

# javascript - javascript比较运算符不一致

> ID：10951741
> 
> 赞同：0
> 
> 时间：2012-06-08T15:28:32.417
> 
> 标签：javascript

谁能解释为什么这里`a = [] ? 1 : 2`a 等于 1 而这里`b = [] == true ? 1 : 2`b 等于 2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T15:42:10.087

[为什么 ('0' ? 'a' : 'b') 的行为与 ('0' == true ? 'a' : 'b')](https://stackoverflow.com/questions/7496727/why-does-0-a-b-behave-different-than-0-true-a-b)不同。

简而言之：

*   当您有一个在布尔上下文中评估的值时，它会被传递给以[`ToBoolean`](http://ecma-international.org/ecma-262/5.1/#sec-9.2)转换**为布尔值**。

*   如果将值与之比较，则会[使用 ECMAScript 规范第 11.9.3 节中](http://ecma-international.org/ecma-262/5.1/#sec-11.9.3)`==`的算法。在此算法中，两个操作数都**转换为字符串或数字**，并比较这些值。

 *** * *

## 更详细的解释

**`a = [] ? 1 : 2`**

通过调用将条件[转换](http://ecma-international.org/ecma-262/5.1/#sec-11.12)为布尔值`ToBoolean(GetValue(lref))`。现在我假设对于对象，`GetValue`只返回对象本身并且[所有对象的*计算*结果为**`true`**](http://ecma-international.org/ecma-262/5.1/#sec-9.2).

由于数组只是对象，因此该表达式的结果是`1`.

**`b = [] == true ? 1 : 2`**

如前所述，这里正在进行相当多的类型转换。

首先，`true`转换为数字：

> 7\. 如果 Type(y) 为 Boolean，则返回比较结果 x == ToNumber(y)。

[`false`转换为`0`并`true`转换为`1`](http://ecma-international.org/ecma-262/5.1/#sec-9.3)。

所以我们有

```
[] == 1 
```

然后第 9 步适用：

> 9\. 如果 Type(x) 是 Object 并且 Type(y) 是 String 或 Number，
> 则返回比较结果 ToPrimitive(x) == y。

这意味着`[]`转换为原始值（字符串或数字）。如果您遵循该[`ToPrimitive`函数](http://ecma-international.org/ecma-262/5.1/#sec-9.1)（和[第 8.12.8 节](http://ecma-international.org/ecma-262/5.1/#sec-8.12.8)），您会发现数组通过将其元素与`,`. 由于空数组没有元素，结果是一个空字符串。

所以我们最终得到

```
"" == 1 
```

然后适用第 5 步：

> 5\. 如果 Type(x) 是 String，Type(y) 是 Number，返回比较结果 ToNumber(x) == y。

[一个空字符串被转换为`0`](http://ecma-international.org/ecma-262/5.1/#sec-9.3)，因此`0 == 1`是**`false`**并且条件运算符返回`2`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:31:30.223

因为数组是一个对象，并且当在布尔比较的上下文中评估一个对象时，它是“真实的”，但并不完全正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:40:59.807

在第一个示例中，数组被转换为一个布尔值，它产生 true，因为它不是 null、未定义、“”、0 或 false。

在第二个示例中，由于等于运算符，您将获得类型转换。来自 mdn：

> 如果两个操作数的类型不同，JavaScript 会转换操作数，然后应用严格比较。如果任一操作数是数字或布尔值，则尽可能将操作数转换为数字。

在控制台中尝试了以下操作：

```
Number(true) //gives 1
Number([])   //gives 0 
```

因此，当转换为数字时，它们是不相等的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:30:32.597

在中，如果不是或`a = [] ? 1 : 2`则返回。`1``[]``null``undefined`

在中，如果是，`b = [] == true ? 1 : 2`它会返回，但不是，所以它返回。`1``[]``true``2`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T15:31:08.597

第一个是分配，因此必须达到真实（但不等同于任何东西）。将空等同于真将是错误的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T15:31:27.237

`[]`因为用返回 true初始化数组而`[] == true`不是:-)**

# asp-classic - 阻止用户在登录之前查看 PDF？

> ID：10951744
> 
> 赞同：2
> 
> 时间：2012-05-03T21:26:17.113
> 
> 标签：asp-classic

我在一个旧的 Classic ASP 网站上工作，并且有一个目录，其中包含一些 PDF 文档。有没有办法阻止用户通过直接链接（www.example.com/example.pdf）访问所述 pdf 文档，直到他们登录？如果是这样，我会怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T22:17:34.540

ASP 是否具有内置成员资格提供程序，该提供程序通过该目录中的 web.config 中的几行来控制访问

[http://msdn.microsoft.com/en-us/library/yh26yfzy%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/yh26yfzy%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T22:18:26.553

以下来自 Microsft 的文章解释了如何使用经典 ASP 保护对某些页面的访问。

[如何使用简单的 ASP 代码密码保护您的 ASP 页面](http://support.microsoft.com/kb/301464)

这里有几个附加链接，它们都适用于 ASP.NET，但也许您可以在经典 ASP 中使用相同的想法。

[主题：如何密码保护我网站的子文件夹，以拒绝匿名访问？](http://forums.iis.net/t/1041594.aspx)

这是一篇类似的文章：[使用表单身份验证保护文件夹](http://www.codefixer.com/asp-net/tutorials/protecting-folders-with-forms-authentication.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T14:45:34.137

我想你的网站已经有一个登录基础设施。

如果不是，您应该将其添加为第一件事 | [http://www.evolt.org/node/28652](http://www.evolt.org/node/28652)。

然后创建页面并将其放在您要保护的资源的位置。例如替换`http://youwebsite.com/dir1/dir2/file.pdf`为`http://yourwebsite.com/dir1/dir2/getfilepdf.asp`.

在您的新脚本中检查用户是否已登录，如果没有将其发送回登录页面。如果用户通过了正确的身份验证，则读取该文件并将其返回给浏览器`Response.BinaryWrite`。

网络上充满了样本。阅读本文 | [http://support.microsoft.com/kb/307603](http://support.microsoft.com/kb/307603)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T04:17:24.313

列出您的文档的页面上的密码保护不会阻止对文档的直接访问。例如，如果您的文档按文件夹视图列出或从任何网页链接，那么地球上的每个搜索引擎和蜘蛛都已经知道文档在您的站点中的位置。所以这就是你可以做的......

首先将文档文件夹移动到根级别以下，然后使用 FileSystemObject 传递文档。对于超过 2-4 Mb 的文档，您应该以“块”的形式交付它们。

现在您可以在下载脚本中添加一个条件来验证用户的登录状态或重定向到登录。您的评论链接现在看起来像：

```
http://somesite.com/load-pdf.asp?id=mydocuent.pdf 
```

如果您按文件夹视图提供文档列表，您仍然可以使用 FileSystemObject。

# google-chrome - 强制 chrome 选项卡崩溃

> ID：10951748
> 
> 赞同：3
> 
> 时间：2012-06-08T15:28:57.247
> 
> 标签：google-chrome, google-chrome-extension

我正在尝试制作一个扩展程序，该扩展名将所有选项卡崩溃在Chrome窗口中，以便它们在打开Chrome时不会加载（当标签太多时）。

但是当我尝试使用

> chrome.tabs.update(null, {url:"chrome://crash"})

或者

> chrome.tabs.update(null, {url:"about:crash"})

他们不工作，虽然使用

> chrome.tabs.update(null, {url:"chrome://tasks"})

效果很好

有什么解决方法可以做到这一点吗？

当这也有效时，我想循环所有打开的标签来做同样的事情，我不知道怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-18T21:37:27.157

您可以简单地获取所有活动窗口并遍历其选项卡，然后将其 url 更改为 data:text/html

```
chrome.windows.getAll({populate : true}, function (window_list) {
    var list = [];
    for(var i=0;i<window_list.length;i++) {
        list = list.concat(window_list[i].tabs);
    }
    for(var y=0;y<list.length;y++) {
         var jsRunner = {'code': 'window.stop()'};
         chrome.tabs.executeScript(list[y].id, jsRunner);
            if(!list[y].url.match(/data\:text\/html/gi)){
                chrome.tabs.update(list[y].id, {url:"data:text/html,<meta charset=\"utf-8\"><title>" + list[y].title + "</title><h1 style='text-align:center;'><a style='text-decoration:none;' href='" + list[y].url + "'>" + list[y].url + "</a></h1>"});
            }
    }
}); 
```

您可以下载扩展并尝试[http://d.pr/f/wXaZ](http://d.pr/f/wXaZ)

# mod-deflate - 如何使用 .htaccess 文件为 php 禁用 mod_deflate？

> ID：10951749
> 
> 赞同：0
> 
> 时间：2012-06-08T15:29:01.933
> 
> 标签：mod-deflate

如何使用文件禁用`mod_deflate`PHP`.htaccess`

1.  对于特定目录中的文件
2.  对于所有扩展名为 .php 的文件？

* * *

我都试过了：

```
# for URL paths that begin with "/foo/bar/"
SetEnvIf Request_URI ^/foo/bar/ no-gzip=1

# for files that end with ".php"
<FilesMatch \.php$>
    SetEnv no-gzip 1
</FilesMatch> 
```

他们不工作，我不知道为什么。此时我想对目录中的所有文件完全禁用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:42:55.283

看一下这个。并回复是否适合您：

**SetEnvIfNoCase Request_URI ".php$" no-gzip dont-vary**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:38:39.140

让我们简化问题，并在您让每个部分工作时慢慢使其变得更加复杂。

首先，您在评论中说：“当我尝试访问服务器上的特定 php 文件时，FF 告诉我存在压缩问题”

首先，查看禁用 mod_deflate 时是否会出现问题。注释掉 apache 配置文件中的 deflate 行。

如果确实可以解决问题，请重新启用 mod_deflate，然后将它们添加到托管您网站的虚拟主机中（不要乱用 .htaccess，这只会增加另一层复杂性）：

```
SetEnvIfNoCase Request_URI "\.(php)$" no-gzip dont-vary 
```

试试 PHP 文件，看看它们是否仍然被压缩。

如果这有效，则添加其他条件

```
SetEnvIfNoCase Request_URI "^/foo/bar/.*" !no-gzip !dont-vary 
```

最后 - 把这一切都放在你的 .htaccess 文件和 Ta-dah 中！

# windows-8 - 关于 windows Metro 线程模型

> ID：10951750
> 
> 赞同：0
> 
> 时间：2012-06-08T15:29:11.530
> 
> 标签：windows-8, microsoft-metro

有人可以解释 Windows Metro 中的线程模型吗？我真的对此感到困惑。

我知道 WWAHost.exe 创建了第一个 MTA（主线程？），我们还有一个 UI 线程（STA？）和一些工作线程（STAorMTA？）

并且只有主线程可以更新到 UI 线程。那么当用户触摸一个按钮时，然后发生了什么？对不起，我的英语很糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T05:00:19.013

[CoreApplication 类](http://msdn.microsoft.com/en-us/library/windows/apps/windows.applicationmodel.core.coreapplication.aspx)文本中有一些关于它的内容：

> 系统在运行应用程序时将此对象创建为单例。它作为应用程序单线程单元 (ASTA) 运行。从应用程序单例创建的线程，例如视图提供程序（见下面的示例），应归类为多线程单元 (MTAThread)。

# delphi - 如何在 Delphi XE2 中安装 JCL html2 帮助？

> ID：10951753
> 
> 赞同：3
> 
> 时间：2012-06-08T15:29:29.233
> 
> 标签：delphi, jedi

我尝试使用[JCL](http://sourceforge.net/projects/jcl/)安装程序从[最新最好](http://sourceforge.net/projects/jcl/files/JCL%20Releases/JCL%202.3%20Build%204197/)的 JCL 安装 html2 帮助，选择将其与 DXE2 帮助集成的选项，它破坏了 DXE2 帮助：*即*当我在 IDE 中启动帮助查看器时，它告诉我没有索引/目录。经过一番折腾，我能够使用[这个答案](https://stackoverflow.com/a/5431744/222450)来恢复 DXE2 帮助，此时我尝试使用 h2reg 手动安装 JCL 帮助。这似乎行不通。我在内容或索引中看不到任何 JCL 主题，当我搜索我知道应该在那里的东西时，我什么也找不到。

有没有人成功安装此帮助并将其与 DXE2 中的 IDE 帮助集成？如果是这样，怎么做？

编辑添加：h2reg 日志文件的相关部分似乎是这样的：显然我错过了一个关键部分：我应该能够从我下载的 JCL 帮助中的内容构建它吗？

```
===============================================================================
10:38:34 AM   [Reg_Namespace] - Lines To Process = 1
10:38:34 AM     <nsName>="Jedi.Jcl"
10:38:34 AM     <nsColfile>="C:\VCL\JCL\help\JclVcl_COL_MASTER.HxC"
10:38:34 AM     <nsDesc>="JEDI Code Library VCL package"
10:38:34 AM     +Mode = Not Enabled
10:38:34 AM   ** Reg Error **: Cound not register Namespace: "Jedi.Jcl", because Col file not found "C:\VCL\JCL\help\JclVcl_COL_MASTER.HxC"
-------------------------------------------------------------------------------
10:38:34 AM   [Reg_Title] - Lines To Process = 1
10:38:34 AM     <nsName>="Jedi.Jcl"
10:38:34 AM     <TitleID>="JclVcl"
10:38:34 AM     <LangID>=""
10:38:34 AM     <HxS_HelpFile>="C:\VCL\JCL\help\JclVcl.HxS"
10:38:34 AM     <HxI_IndexFile>="C:\VCL\JCL\help\JclVcl.HxI"
10:38:34 AM     <HxQ_QueryFile>=""
10:38:34 AM     <HxR_AttrQueryFile>=""
10:38:34 AM     <HxsMediaLoc>=""
10:38:34 AM     <HxqMediaLoc>=""
10:38:34 AM     <HxrMediaLoc>=""
10:38:34 AM     <SampleMediaLoc>=""
10:38:34 AM   ** Reg Error **: Namespace name not found on this PC "Jedi.Jcl"
------------------------------------------------------------------------------- 
```

# iphone - 覆盖 Apple 的 UIButton Highlight

> ID：10951755
> 
> 赞同：0
> 
> 时间：2012-06-08T15:29:32.683
> 
> 标签：iphone, objective-c, xcode, ipad, uibutton

我有一个按钮，我在其中设置它的图像及其选定和突出显示的状态图像，如下所示：

```
 UIImage *buttonImage = [UIImage imageNamed:@"btn_learn_pad"];
        self.learnMoreButton = [[UIButton alloc] initWithFrame:CGRectMake(50, 0, buttonImage.size.width, buttonImage.size.height)];
        [self.learnMoreButton setImage:buttonImage forState:UIControlStateNormal];
        [self.learnMoreButton setImage:[UIImage imageNamed:@"btn_learn_focus_pad"] forState:UIControlEventTouchUpInside | UIControlStateHighlighted | UIControlStateSelected];
        [self.learnMoreButton addTarget:self action:nil forControlEvents:UIControlEventTouchUpInside]; 
```

这仍然会在选择时将 Apple 的较暗 alpha 覆盖在图像顶部。如何消除这种影响？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:41:01.390

而不是 setImage:forState 使用`setBackgroundImage:forState`：

```
[self.learnMoreButton setBackgroundImage:[UIImage imageNamed:@"btn_learn_pad"] forState:UIControlStateNormal];
[self.learnMoreButton setBackgroundImage:[UIImage imageNamed:@"btn_learn_focus_pad"] forState:UIControlStateHighlighted]; 
```

# salesforce - VLOOKUP 销售人员

> ID：10951756
> 
> 赞同：1
> 
> 时间：2012-06-08T15:29:34.307
> 
> 标签：salesforce, vlookup

```
VLOOKUP( $ObjectType.I__c.Fields.ISO_Code__c,  
$ObjectType.I__c.Fields.Name,   Case__r.Account.BillingCountry) + '-' + IF(OR(TEXT(Case__r.Account.Type) = 'Cargo Agent',TEXT(Case__r.Account.Type) = 'C Associate') ,'C','P') + '-' +  LEFT(Case__r.Account.ICode__c,7) 
```

这允许我上传类似这种格式的内容`JO-P-NA44694-2.pdf`，但用户也可以上传类似`[[JO-P-NA44694-2]].pdf`或`--JO-P-NA44694-2-][.pdf`. 我怎样才能阻止它，并让用户只能上传这样的东西`JO-P-NA44694-2.pdf`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:51:10.147

使用像这样的正则表达式`REGEX(Name, "[a-zA-Z0-9]{2}-[a-zA-Z0-9]{1}-[a-zA-Z0-9]{7}-[a-zA-Z0-9]{1}")`

# asp.net - 调试第一次运行 asp.net 应用时出现的错误

> ID：10951759
> 
> 赞同：1
> 
> 时间：2012-06-08T15:29:51.223
> 
> 标签：asp.net, global-asax

我正在开发一个仅在第一次运行该应用程序时出错的 asp.net 应用程序。错误消息是**{"Response is not available in this context."}**并且应用程序在 Application_Error 函数的 global.asax.cs 页面中中断。

堆栈跟踪值是：在 System.Web.HttpApplication.get_Response() at pcMDnet.Global.Application_Error(Object sender, EventArgs e) in C:\BuildDir\1.0.1.05\GIS\pcMDnet\Global.asax.cs:line 364 在 System.Web.HttpApplication.RaiseOnError()

我该如何调试这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:44:18.933

此错误是由于 IIS7 集成管道中的设计更改导致 Application_Start 事件中的请求上下文不可用。

`Application_BeginRequest`为了解决这个问题，请在该点删除对内容的引用，或者对内容存在的位置进行一次初始化。

参考： http: [//mvolo.com/iis7-integrated-mode-request-is-not-available-in-this-context-exception-in-applicationstart](http://mvolo.com/iis7-integrated-mode-request-is-not-available-in-this-context-exception-in-applicationstart)

# javascript - 在第一次点击时切换

> ID：10951760
> 
> 赞同：0
> 
> 时间：2012-06-08T15:29:58.423
> 
> 标签：javascript, toggle

我尝试了两种不同的方法来切换播放器上的播放/暂停按钮，但出于某种原因，这两种方法都不适用于第一次点击。

这个，据说检查音频的状态，看看它是暂停还是结束：

```
function togglePlayPause() { 
var audioPlayer = document.getElementsByTagName('audio')[0];
var playpause = document.getElementById("playpause"); 
if (audioPlayer.paused || audioPlayer.ended) { 
     playpause.title = "pause"; 
     playpause.innerHTML = "pause"; 
} 
else { 
         playpause.title = "play"; 
     playpause.innerHTML = "play"; 
     } 
} 
```

或者我试过这个，它只是通过 onClick 切换`toggle(this)`：

```
 function toggle(obj) {
    if (obj.className== 'playButton') {
        obj.className = 'pauseButton';
        obj.title = "PAUSE"; 
        obj.innerHTML = "PAUSE";
    } else {
        obj.className = 'playButton';
        obj.title = "PLAY"; 
        obj.innerHTML = "PLAY";
        }
    } 
```

第一次单击按钮时都不会切换，尽管第一种方法确实从默认的内部“播放”更改为“播放”，所以我猜这是：

```
<a href="#" id="start" onclick="playPause();togglePlayPause();"><div title="play" class="playButton" id="playpause">PLAY</div></a> 
```

在这两种方法中，后续点击都可以正常工作。知道为什么会这样吗？它可能与调用 audioPlayer 变量的方式有关吗？数组从 0 开始。（我抓着稻草。）

像往常一样非常感谢！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-08T15:32:41.607

I would go without creating functions, I would check if the link is clicked then proceed to the events that would be fired.

so something like `$("#start").click(function(){});` in can be tried.

First, have the jQuery library included in your HTML header.

Then create a new javascript file, included it as well (usually this is put after the jQuery included)

In your new javascript file write the following

```
$(document).ready(function() {
   $("#start, #stop, #play, #pause").click(function() { //you can have more or less selectors (selectors are the ones with #)
       //Your code goes here
   });
}); 
```

Here is a fiddle for that solution. [http://jsfiddle.net/JRRm2/1/](http://jsfiddle.net/JRRm2/1/) (tidier text: [http://jsfiddle.net/JRRm2/2/](http://jsfiddle.net/JRRm2/2/))

# android - Android：停止声音通知

> ID：10951761
> 
> 赞同：1
> 
> 时间：2012-06-08T15:29:59.830
> 
> 标签：android, android-notifications, notificationmanager

我使用 NotificationManager 播放声音。但是当我按任意键时，我不知道如何停止它。例如，后退按钮。太感谢了~~~^^

```
NotificationManager manager 
    = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE); 

Notification notification = new Notification(); 
notification.sound=Uri.parse("android.resource://" 
    + getPackageName() + "/" +R.raw.fin); 

manager.notify(1, notification); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:34:03.263

我相信 NotificationManager 使用 MediaPlayer 播放声音。默认情况下，这会播放您的整个声音。所以你需要打电话给 mediaplayer.stop。您是否尝试过取消通知？[通知 取消](http://developer.android.com/reference/android/app/NotificationManager.html#cancel%28int%29)

# asp.net - sql语句返回当前行的下一行/上一行

> ID：10951762
> 
> 赞同：0
> 
> 时间：2012-06-08T15:30:02.410
> 
> 标签：asp.net, sql-server, sql-server-2008, select

我相信这在 mysql 中是可能的，但是 sql server 2008 呢？例如：

```
 **ID             Type**
   11111          dgf-324-fhj
   11111          sdg-654-fhd
   22222          djg-234-dfh
   23333          uoi-738-sdf 
```

如果类型是 PK，假设我的查询返回第一行 11111，我如何创建一个 SQL 语句来解析我到下一行或上一行？任何帮助或指向正确方向的方法都会很棒。该程序是asp.net/c#/visual studio 2010，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:54:45.520

请记住，表代表一组*无序*的行。因此，除非您指定订单，否则“下一个”和“上一个”的概念没有任何意义。在您的示例中，除非您指定订单，否则不能保证给定的 Select 语句返回 say `dgf-324-fhj`before 。`sdg-654-fhd`但是，让我们假设按类型排序我们可以使用这样的排名函数：

```
With OrderedItems As
    (
    Select Id, Type, Row_Number() Over ( Order By Type ) As Num
    From SourceData
    )
Select Id, Type
From OrderedItems
Where Num = 2 
```

[SQL 小提琴](http://www.sqlfiddle.com/#!3/12963/2)示例

我还要提一下这种方法存在问题。如果有人在您查询第 1 行后插入一个成为“新”行 2 的新行，您将得到与预期不同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:34:12.713

看看这个关于分页的答案：[What is the best way to pagate results in SQL Server](https://stackoverflow.com/questions/109232/what-is-the-best-way-to-paginate-results-in-sql-server)

如果您想一次执行一行，那么您只需将 RowNum 过滤器一次更改为 1。

# netbeans - NetBeans 无法打开

> ID：10951764
> 
> 赞同：0
> 
> 时间：2012-06-08T15:30:10.030
> 
> 标签：netbeans

尝试打开 NetBeans 时，它似乎开始运行，因为我可以在 TaskManager 窗口中看到 netbeans.exe。但是，它从来没有打开任何东西，只是挂在那里运行，直到我从任务管理器中停止它。它以前一直有效，直到似乎在我的笔记本电脑上安装了 HP QuickTest Pro 之后。

我尝试重新启动我的笔记本电脑，安装了最新的 netbeans 7.1.2，从不同的 USERDIR 启动它，没有任何帮助并且出现相同的症状。

messages.log 都显示了一件事——最后一行是

* * *

加载 HP QuickTest Professional Java 支持（版本 11.0.0.0）(SUN 1.7.0)

这似乎是 netbeans 冻结的地方.... 我的问题是为什么 netbeans 启动尝试加载 QuickTeste java？如何阻止它？

有什么建议么？

提前致谢。

李艳

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T17:28:23.373

尝试卸载“HP QuickTest Professional Java Support (version 11.0.0.0) (SUN 1.7.0)”

启动 NetBeans

如果可行，则重新安装 HP * 东西...如果您不需要它，则不重新安装...

# jquery - 设置 Ajax 请求/响应时遇到问题

> ID：10951765
> 
> 赞同：1
> 
> 时间：2012-06-08T15:30:11.450
> 
> 标签：jquery, ajax, asp-classic, datatables

我有一个构建表格的页面。该页面上没有其他内容，而是从查询中填充的表。

我需要通过 jQuery/ajax 调用这个页面，并以某种方式将它返回到这个函数中。

这是需要调用页面并将页面返回值提供给 sOut 变量的 jQuery 函数。

我正在使用数据表。

```
/* Formatting function for row details */
function fnFormatDetails(oTable, nTr) {
    var aData = oTable.fnGetData(nTr);
    var sOut = '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">';
    sOut += '<tr><td>Rendering engine:</td><td>' + aData[1] + ' ' + aData[4] + '</td></tr>';
    sOut += '<tr><td>Link to source:</td><td>Could provide a link here</td></tr>';
    sOut += '<tr><td>Extra info:</td><td>And any further details here (images etc)</td></tr>';
    sOut += '</table>';

    return sOut;
} 
```

我需要以某种方式更改 sOut，因此它 = 对 ajax 页面的调用。

ajax页面的路径是。`"ajax/order_history_orderlines.asp"`

ajax 页面期望发送一个参数，即提供 orderID 的 aData[1]。

谁能帮我弄清楚如何让 sOut 抓取 ajax 页面？

我正在努力完成的更好的例子。

```
/* Formating function for row details */
function fnFormatDetails(oTable, nTr) {
    var aData = oTable.fnGetData(nTr);
    var sOut = 'ajax/order_history_orderlines.asp?orderid=' + aData[1];

    return sOut;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:39:38.260

使用 jQuery：

```
$.ajax({
  url: 'ajax/order_history_orderlines.asp?orderid=' + aData[1],
  success: function(data) {
  /* do something with your data here */
  }
}); 
```

# c# - .Net 使用 Web 服务十六进制值 0x1F，是无效字符。第 1 行，位置 1

> ID：10951767
> 
> 赞同：0
> 
> 时间：2012-06-08T15:30:19.780
> 
> 标签：c#, .net, xml, web-services, soap

我在过去几天构建了一个演示，从国家气象局的网络服务导入数据，今天它坏了：

System.Xml.XmlException - {“''，十六进制值 0x1F，是无效字符。第 1 行，位置 1。”}

我将 WSDL 作为 Web 引用导入并直接使用对象，而不是手动进行 SOAP 调用或加载 XML。

[http://graphical.weather.gov/xml/DWMLgen/wsdl/ndfdXML.wsdl](http://graphical.weather.gov/xml/DWMLgen/wsdl/ndfdXML.wsdl)

[http://graphical.weather.gov/xml/](http://graphical.weather.gov/xml/)

有想法该怎么解决这个吗？这是一些简化的代码：

```
using gov.weather.graphical;
...
string sList = "30.267,-97.743 30.267,-97.743 32.9612,-96.8372 33.1097,-96.6695";       
ndfdXML service = new ndfdXML();
string sResult;
DateTime startDate = Convert.ToDateTime(DateTime.Now.ToShortDateString() + " 00:00:00 AM");
DateTime endDate = Convert.ToDateTime(startDate.ToShortDateString() + " 23:59:59 PM");

string sListCurrent = aList[x].ToString();
sResult = service.NDFDgenLatLonList(sList, productType.glance, startDate, endDate, unitType.e, wpt); 
```

# ios - 对如何修复这些错误（iOS）感到困惑......有什么建议吗？

> ID：10951770
> 
> 赞同：7
> 
> 时间：2012-06-08T15:30:22.463
> 
> 标签：ios, ios5

我对 iOS 开发完全陌生，并且使用一本书来学习。按照前几章中的说明，我编写了一个简短的应用程序（代码如下）。它只需要一些文本输入并更改标签的文本以匹配它。但是，在模拟器中运行代码时，单击文本字段时出现以下错误：

> 2012-06-08 11:26:06.595 HelloNoun [14926:f803] 打开'/Users/clhu/Library/Application Support/iPhone Simulator/5.1/Library/Caches/com.apple.keyboards/images/1859589221'失败：'没有这样的文件或目录' (2)
> 
> 2012-06-08 11:26:06.702 HelloNoun [14926:f803] 'INSERT INTO store VALUES (?,?,?,?,?,?,?,?)' 约束失败 (19)

然后，当我按下按钮设置标签时，我也会收到以下错误：

> 2012-06-08 11:27:09.050 HelloNoun [14926:f803]-[UIView 文本]：无法识别的选择器发送到实例 0xb75ac80
> 
> 2012-06-08 11:27:09.051 HelloNoun [14926:f803] ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[UIView 文本]：无法识别的选择器发送到实例 0xb75ac80”
> 
> ***首先抛出调用栈：
> 
> (0x13c7022 0x1558cd6 0x13c8cbd 0x132ded0 0x132dcb2 0x21a7 0x13c8e99 0x1414e 0x140e6 0xbaade 0xbafa7 0xba266 0x393c0 0x395e6 0x1fdc4 0x13634 0x12b1ef5 0x139b195 0x12ffff2 0x12fe8da 0x12fdd84 0x12fdc9b 0x12b07d8 0x12b088a 0x11626 0x1dad 0x1d15) terminate called throwing an exception(lldb)

我已经检查了我的联系并多次回顾了我的步骤，并没有看到任何明显的错误（尽管我对此绝对很陌生）。谁能帮我指出正确的方向？谢谢！

* * *

这是代码：

```
// ViewController.h

#import <UIKit/UIKit.h>

@interface ViewController : UIViewController
@property (strong, nonatomic) IBOutlet UILabel *userOutput;
@property (strong, nonatomic) IBOutlet UITextField *userInput;

- (IBAction)setOutput:(id)sender;

@end 
```

和

```
// ViewController.m

#import "ViewController.h"

@implementation ViewController
@synthesize userOutput;
@synthesize userInput;

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)viewDidUnload
{
    [self setUserOutput:nil];
    [self setUserInput:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (IBAction)setOutput:(id)sender 
{
    self.userOutput.text = self.userInput.text;
}
@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T16:01:25.537

我以前从未见过第一个错误，但您可以尝试删除路径处的缓存文件夹`/Users/clhu/Library/Application Support/iPhone Simulator/5.1/Library/Caches`。模拟器应该足够聪明以重新创建它。

对于第二个错误，我通常会看到当我将属性连接到 NIB 中的错误视图时。看起来该属性`userOutput`指向的是 UIView 而不是 UITextField。您可以检查您的 NIB 中的连接或通过将以下行添加到 `setOutput:`.

```
NSLog(@"%@", self.userOutput); 
```

您日志中的输出应该类似于

`<UITextField: 0x6fea9f0; frame = (0 0; 100 31); clipsToBounds = YES; opaque = NO; layer = <CALayer: 0x6fec700>>`

# c# - defining a circle on x-y axis

> ID：10951787
> 
> 赞同：1
> 
> 时间：2012-06-08T15:31:06.377
> 
> 标签：c#, pixel, geometry

I have such a grid square disk. Every grid represents a pixel. My aim is to most accurately aprroximate this disk as a circle (max from inside). Radius of the circle should be 1 so I have to define a x-y plane whose minimum and maximum values -1, +1 respectively. So pixel 35 is the origin (0,0). By the way I don't want to draw a circle, I just need such a circle which gives me the coordinates of every single pixel.

For example: for pixel 3, it should give me a coordinate approximately (0 , 0.8). I can define such a circle, but I am not sure about coordinates. I don't ask any code but some tips or advices would be appreciated. I am also using emgucv library for this project. Should I define this coordinates from scratch or is there any pre-defined class or something that speed me up.

thanks

![enter image description here](../Images/0b6748260e3bca0973e6504e94c00368.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:34:48.540

要计算像素到原点相对于圆半径的距离，您只需要半径即可。为此，您可以通过“磁盘”的（四分之一）周界并计算最小/最大距离（根据您的需要）。结果是圆的半径

要获得像素的相对距离，请计算像素到原点的距离并将其除以上述测量的半径

# java - Rotate JLabel 90 Degrees Java

> ID：10951794
> 
> 赞同：0
> 
> 时间：2012-06-08T15:31:19.643
> 
> 标签：java, swing, rotation, jlabel, imageicon

I have an image within a Jlabel which I want to rotate 90 degrees right when the user hits the button. I've attempted it myself, but with various errors. I was told the best way to do it was to use Graphics2D?

Main Class:

```
private void SearchButtonActionPerformed(java.awt.event.ActionEvent evt) {        
BufferedImage image;
        try {
            image = ImageIO.read(file);
            Image scaled = image.getScaledInstance(Jlabel1.getWidth(), Jlabel1.getHeight(), 5);
            Jlabel1.setIcon(new ImageIcon(scaled)); 
```

Button:

```
 private void rotateButtonActionPerformed(java.awt.event.ActionEvent evt) {
        Graphics2D userImage = (Graphics2D)JLabel1.getGraphics();
    userImage.rotate(Math.toRadians(90));
    userImage.drawImage(JLabel1, JLabel1.getHeight(), JLabel1.getWidth());
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:02:11.920

You should never ever use Component.getGraphics() for drawing on a component. Instead, you should always overwrite paintComponent and work with the Graphics object that gets passed to it.

> Component.getGraphics() simply can't work. Java uses a callback mechanism for drawing graphics. You are not supposed to "push" graphics information into a component using getGraphics(). Instead you are supposed to wait until Java calls your paint()/paintComponent() method. At that moment you are supposed to provide the Component with the drawings you would like to do.
> 
> This mechanism is necessary so Java can support graphics systems which don't remember window contents when it is obscured (e.g. overlayed by another window). When the window becomes visible again, such graphics systems have to ask the application to reconstruct the window content. Therefore, paint()/paintComponent() is supposed to be the memory of a component. getGraphics(), however, doesn't have any recollection of previous drawing operations. So once a drawing done via getGraphics() is lost, it can't be reconstructed. There is nothing in there that stores the old drawing data, and there is nothing in AWT/Swing which informs getGraphics() to do some re-drawing.
> 
> In addition, there are situations where Component.getGraphics() simply returns null. This is a defined behavior of the method. And finally, most users of getGraphics() forget to dispose the Graphics object after usage.

[http://www.pscode.org/guifaq.html](http://www.pscode.org/guifaq.html)

# python - Python 2十进制的Sin，cos等？

> ID：10951795
> 
> 赞同：3
> 
> 时间：2012-06-08T15:31:23.220
> 
> 标签：python, decimal, precision, trigonometry

在 Python 2.6 中，我发现 Decimal 的等价物`sqrt(pi)`是

```
Decimal(pi).sqrt() 
```

sin、cos 或其他（反）三角函数有类似的东西吗？

[文档](http://docs.python.org/library/decimal.html)只提到如何计算和`cos`计算`sin`。`Decimal(pi).cos()`不存在也不存在`from decimal import cos`

**更新**：使用默认三角函数的问题在于，`Decimal`如果我每次想计算某些东西时将它们从浮点数转换回来，它就会失去使用的意义。`Decimal`（在每个计算周围打字也很烦人，但我想我可以做一个包装函数）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T15:40:10.890

请参考这里。

[http://docs.python.org/library/decimal.html#decimal-recipes](http://docs.python.org/library/decimal.html#decimal-recipes)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T18:25:33.637

Decimal 库旨在支持正确舍入的以 10 为底的算术，主要用于需要精确控制舍入的财务计算。它不是一个通用的任意精度库。

如果您需要通用的任意精度库，请查看[mpmath](http://code.google.com/p/mpmath/ "数学")或[gmpy2](http://code.google.com/p/gmpy/ "gmpy2")。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-08T15:40:07.030

三角函数在[数学模块中](http://docs.python.org/library/math.html#trigonometric-functions)

所以：

```
>>> decimal.Decimal(math.cos(0.1))
Decimal('0.99500416527802570954008842818439006805419921875') 
```

如果您正在寻找 Python 中支持三角函数的多精度数学库，那么 Decimal 不是。看看[mpmath](http://mpmath.org/)。Mpmath 支持任意精度的[三角函数](http://mpmath.googlecode.com/svn/trunk/doc/build/functions/trigonometric.html)；十进制没有。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-08T16:03:12.643

sin(a) 和 cos(a) 的值仅是特定角度的有理数（请参阅[链接](https://planetmath.org/RationalSineAndCosine)），因此您不能将 sin(a) 或 cos(a) 的值存储为小数而不损失精度。这违背了将 sin 和 cos 值转换为 Decimal 并具有将 sin 和 cos 值返回为 Decimal 的内置函数的目的。

此外，您不能将所有有理数存储为 Decimal 而不会丢失精度，因为 python 的小数是`(-1)**_sign * _int * 10**_exp`这样的，因此有理数的除数必须为 10，Decimal 才能以全精度存储它。

我猜@carrot-top 的 mpmath 建议或一些数值算法（如泰勒级数近似）是你能得到的最好的。

# java - 使用java将文本和图像发送到php

> ID：10951797
> 
> 赞同：2
> 
> 时间：2012-06-08T15:31:27.130
> 
> 标签：java, php, string, image

这是我关于stackoverflow的第一个问题，所以如果您对我提出/解释它的方式有任何评论，我很乐意接受任何指示。

所以这里是：

我想将文本和图像都发送到服务器上的 php 脚本。我可以成功地将两者分开发送，但不能一起发送。到目前为止，我将它用于字符串：

```
String dataSend = URLEncoder.encode("User","UTF-8") +"="+URLEncoder.encode(username,"UTF-8");
URL url = new URL(urlCopyImage);            
URLConnection connection = url.openConnection();
connection.setDoOutput(true);
OutputStreamWriter out = new OutputStreamWriter(connection.getOutputStream());    
out.write(dataSend);
out.close(); 
```

对于我使用的图像：

```
URL url = new URL(urlCopyImage);            
URLConnection connection = url.openConnection();
connection.setDoOutput(true);
ImageIO.write(image,"PNG", connection.getOutputStream()); 
```

我可以以某种方式将这两者结合起来吗？

在 php 脚本中，我只使用`$_POST`接收字符串和我使用的图像：

```
$incomingData = file_get_contents('php://input'); 
```

欢迎任何提示。

作为记录，我使用 php 文件在服务器上创建一个包含此图像的文件。用户名对于指定目录很有用。

编辑：

感谢您的回答，尽管我还不太了解，但我已经能够使其工作。

```
 MultipartEntity multipart = new MultipartEntity();
    multipart.addPart("User", new StringBody(username));
    ByteArrayOutputStream os = new ByteArrayOutputStream();
    ImageIO.write(image, "png", os);
    InputStream is = new ByteArrayInputStream(os.toByteArray());
    ContentBody cb = new InputStreamBody(is, "something.png");
    multipart.addPart("Image", cb);

    HttpPost post = new HttpPost(urlCopyImage);
    post.setEntity(multipart);

    HttpClient client = new DefaultHttpClient();
    HttpResponse response = client.execute(post); 
```

我正在将 contentbody 交给一个 inputstreambody，它从 ImageIO 获取字节流。那太棒了。但我没有得到的是 inputstreambody 的第二个参数应该做什么。虽然这行得通，但感觉不对。

顺便说一句，这是php代码：

```
$user = $_POST['User'];
copy($_FILES['Image']['tmp_name'],$filename); 
```

如果有人能解释我在这里做什么，我将不胜感激。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:10:15.037

使用 Apache HTTP 客户端发出 MIME 类型 multipart/form-data 的 POST 请求，并为二进制数据和文本添加部分。

在 PHP 端，您可以通过 $_FILE 读取文件

请参阅我前段时间写的这篇博[文 http://zybnet.com/java-http-client-and-post-requests/](http://zybnet.com/java-http-client-and-post-requests/)

# android - android SOCKS proxy

> ID：10951799
> 
> 赞同：0
> 
> 时间：2012-06-08T15:31:38.353
> 
> 标签：android, socks

I have the following code in my (test) android project:

```
 URL u = new URL("http://www.google.com");

        InetSocketAddress sa = InetSocketAddress.createUnresolved("127.0.0.1", 1080);
        Proxy proxy = new Proxy(Proxy.Type.SOCKS, sa);
        HttpURLConnection conn = (HttpURLConnection) u.openConnection(proxy); 
```

Then I have implemented a SOCKS server listening on port 1080.

The problem I have is that in the SOCKS4 connection request, the destination address and port is not "ip for google":80 but rather 127.0.0.1:1080, i.e. the proxy address.

If I return ok, I start getting HTTP data.

Am I doing something wrong or is there a bug in the SOCKS-client?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T12:53:02.783

我有一个级别较低但可能对您有用的解决方案：

这适用于我在运行[SSHTunnel](https://play.google.com/store/apps/details?id=org.sshtunnel&hl=en)的根 Nexus 4 上的 Android 4.3 上：

```
 SocketAddress proxyAddr = new InetSocketAddress("127.0.0.1", 1984);  
    SocketAddress hostAddr = new InetSocketAddress(address, port);
    java.net.Proxy proxy = new java.net.Proxy(java.net.Proxy.Type.SOCKS, proxyAddr);
    socket = new Socket(proxy);
    socket.connect(hostAddr); 
```

注意：我还安装了[iptables beta](https://play.google.com/store/apps/details?id=com.mgranja.iptables&hl=en)，但不确定是否需要。

为此，要与模拟器一起使用，请将 IP 更改为 10.0.2.2，这是您主机的 Android 别名。当然，您必须在您的机器上运行本地 SOCKS 代理。

# php - 安装 CMS 时 Web 服务器无法写入目录

> ID：10951803
> 
> 赞同：2
> 
> 时间：2012-06-08T15:31:48.377
> 
> 标签：php, apache, permissions, content-management-system, selinux

我有一个用于本地 Web 开发的本地独立 LAMP 堆栈。我尝试安装多个 CMS，它们都使用 PHP 将数据写入 MySQL 数据库和网络服务器上的文件（Concrete5、Symphony、GetSimple CMS）。

但是，当我尝试安装其中任何一个时，我会收到错误消息，每个状态都类似于“我需要更改的文件不可被网络服务器写入”。

具体5错误信息：

> 错误：Web 服务器访问文件和配置目录
> /config /packages 和 /files 目录必须可由您的网络服务器写入

Symphony 错误消息：

> 缺少日志文件
> 
> Symphony 尝试创建日志文件但失败。确保安装文件夹是可写的。

显然这是一个权限问题，但是我尝试将 apache 的 www 目录的所有者和组（当然是递归的）更改为 root、apache 用户和组以及我自己的用户和组的许多不同组合，并设置权限使用 chmod 一直到 777，但我仍然从所有系统中得到相同的错误。

我可以将常规静态文件（如 phpinfo）放到 www 目录中，apache 可以很好地提供它，但无论我如何更改 CMS 的权限，都无法写入服务器。到底是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T17:17:06.107

如果您使用 seLinux，仅使用 . 授予权限是不够的`chmod`。您还必须授予 apache 写入这些文件夹的权限。

更多信息可以在这里找到：http: [//fedoraproject.org/wiki/SELinux/apache](http://fedoraproject.org/wiki/SELinux/apache)

# sql - Updating non PK fields in SQL Server 2008

> ID：10951804
> 
> 赞同：0
> 
> 时间：2012-06-08T15:31:56.010
> 
> 标签：sql

![enter image description here](../Images/7863b56b825b3a17dd72161f625b9086.png)

My `mainTable` has column primaryCode. These codes are incorrect and need to be updated based on the `updateCodes` table. The incorrect codes are in the column `primaryCode` on `mainTable` and `primaryCode` on the updateCodes table. The descrip column is the correct version. Since I'm not sure how `rollback` works, below is my query for fixing the problem; I think it's right, but not sure.

edit: There are many more codes in my mainTable than these. These are just the ones that need to be updated. I don't know if that will affect the query or not.

```
update mainTable
set mainTable.primaryCode=update.descrip
from mainTable
inner join updateCodes on mainTable.primaryCode=updateCodes.descrip 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:38:50.667

像这样的东西怎么样：

```
UPDATE MainTable SET MainTable.primaryCode = UpdateCodes.descrip
FROM MainTable
INNER JOIN UpdateCodes 
ON MainTable.primaryCode = UpdateCodes.primaryCode 
```

加入“错误”的值以获得更新的正确值......

# javascript - 清除 JQuery 中的文本字段值

> ID：10951809
> 
> 赞同：70
> 
> 时间：2012-06-08T15:32:10.363
> 
> 标签：javascript, jquery, forms, input

我知道这是一个简单的问题，但由于某种原因，这对我不起作用。我有一个每次更改下拉菜单时都会触发的功能。这是假设获取文本字段的当前值的相关代码，如果存在值，请清除 .change 函数中包含的值：

```
var doc_val_check = $('#doc_title').attr("value");
    if (doc_val_check.length > 0) {
        doc_val_check == "";
    } 
```

我觉得我错过了一些非常简单的东西。

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2012-06-08T15:33:19.083

```
doc_val_check == "";   // == is equality check operator 
```

应该

```
doc_val_check = "";    // = is assign operator. you need to set empty value

                       // so you need = 
```

您可以像这样编写完整的代码：

```
var doc_val_check = $.trim( $('#doc_title').val() ); // take value of text 
                                                     // field using .val()
    if (doc_val_check.length) {
        doc_val_check = ""; // this will not update your text field
    } 
```

要使用 a 更新您的文本字段，`""`您需要尝试

```
$('#doc_title').attr('value', doc_val_check); 
// or 
$('doc_title').val(doc_val_check); 
```

但我认为你不需要上述过程。

* * *

### 简而言之，只有一行

```
$('#doc_title').val(""); 
```

### 笔记

`.val()`用于设置/获取文本字段中的值。有参数它充当setter，没有参数充当getter。

阅读更多关于**[`.val()`](http://api.jquery.com/val)**

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-08T15:36:53.940

如果要清除文本字段，请使用：

```
$('#doc_title').val(""); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-06-04T05:05:12.703

您可以使用此行清除它

```
$('#TextBoxID').val(""); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-08T15:34:56.600

而不是所有这些：

```
$('#doc_title').attr("value", ""); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-06-08T15:35:38.703

你需要的是：

```
if ($('#doc_title').val()) {
  $('#doc_title').val('');
} 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-06-25T08:51:27.810

简单来说，您可以使用以下代码清除表单中的所有文本字段、文本区域、下拉列表、单选按钮、复选框。

```
function reset(){
    $('input[type=text]').val('');  
    $('#textarea').val(''); 
    $('input[type=select]').val('');
    $('input[type=radio]').val('');
    $('input[type=checkbox]').val('');  
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-06-08T15:35:07.057

如果你使用的是 jQuery，那么你可以使用这个：

```
// var doc_val_check = $('#doc_title').val(); - No need of this!
if ($('#doc_title').val().length > 0) {
    $('#doc_title').val("");
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-04-29T10:16:37.967

我们可以用它来清除文本

```
$('input[name="message"]').val(""); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-11-07T14:33:23.577

在大多数情况下，您只需设置 .val() 方法。所有答案都非常准确，只是想将我的结果发布给可能需要通过呈现的客户端 ID 设置值的任何人。

```
 $('#' + '<%= doc_title.ClientID %>').val(null); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-06-08T15:36:42.183

您正在`doc_val_check`与一个空字符串进行比较。您想将空字符串分配给`doc_val_check`

所以应该是这样的：

`doc_val_check = "";`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-12-10T06:45:58.060

用于`jQuery.prototype.val`获取/设置字段值：

```
var value = $('#doc_title').val();    // get value
$('#doc_title').val('');    // clear value 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-12T09:35:19.220

> ```
>  First Name: <input type="text" autocomplete="off" name="input1"/>
>     <br/>
>     Last Name: <input type="text" autocomplete="off" name="input2"/>
>     <br/>
>     <input type="submit" value="Submit" />
> </form> 
> ```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-24T19:20:58.113

```
$('#[element id]').val(null); 
```

或者

```
$('.[element class]').val(null); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-01-06T23:30:14.743

如果您想拥有带有可见空白文本的元素，只需执行以下操作：

```
$('#doc_title').html('&nbsp;'); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-01-06T05:51:43.333

尝试使用这个：

```
function checkValue(){
  var value = $('#doc_title').val();
  if (value.length > 0) {
        $('#doc_title').val("");
        $('#doc_title').focus();  // To focus the input 
    }
    else{
    //do something
    }
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<body>
<input type="text" id="doc_title" value="Sample text"/>
<button onclick="checkValue()">Check Value</button>
</body>
```

# vi - Vim: Losing file in buffer

> ID：10951810
> 
> 赞同：1
> 
> 时间：2012-06-08T15:32:12.207
> 
> 标签：vi

I'm using vi as my editor on a Mac OS X and I'm able to switch back and for between files in the buffer using the commands **:bp** and **:bn**. What I notice is that if files are not committed to Subversion then if I switch away from a file that is not committed to Subversion then it it doesn't save in the buffer.

However there's one file in particular that vi does not save in the buffer (even after I commit it to Subversion). Whenever I switch away from it using the commands mentioned above the only way I can go back to it is to open it manually.

For example if I'm working on foo.txt and then switch to bar.txt using the command **:bn**. If I then list the buffers using **:ls** only bar.txt is listed. Must be something that I'm missing about vi buffers.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:40:45.460

`:bd`是缩写`:bdelete`，它卸载缓冲区并将其从缓冲区列表中删除。

如果要在缓冲区之间来回切换，请使用`:bn`and `:bN`。`:bN`相当于`:bp`。

# java - Java not garbage collecting memory

> ID：10951812
> 
> 赞同：12
> 
> 时间：2012-06-08T15:32:15.603
> 
> 标签：java, performance, memory, garbage-collection

I am reading a very large file and extracting some small portions of text from each line. However at the end of the operation, I am left with very little memory to work with. It seems that the garbage collector fails to free memory after reading in the file.

My question is: Is there any way to free this memory? Or is this a JVM bug?

I created an SSCCE to demonstrate this. It reads in a 1 mb (2 mb in Java due to 16 bit encoding) file and extracts one character from each line (~4000 lines, so should be about 8 kb). At the end of the test, the full 2 mb is still used!

The initial memory usage:

```
Allocated: 93847.55 kb
Free: 93357.23 kb 
```

Immediately after reading in the file (before any manual garbage collection):

```
Allocated: 93847.55 kb
Free: 77613.45 kb (~16mb used) 
```

This is to be expected since the program is using a lot of resources to read in the file.

However then I garbage collect, but not all the memory is freed:

```
Allocated: 93847.55 kb
Free: 91214.78 kb (~2 mb used! That's the entire file!) 
```

I know that manually calling the garbage collector doesn't give you any guarantees (in some cases it is lazy). However this was happening in my larger application where the file eats up almost all available memory, and causes the rest of the program to run out of memory despite the need for it. This example confirms my suspicion that the excess data read from the file is not freed.

Here is the SSCCE to generate the test:

```
import java.io.*;
import java.util.*;

public class Test {
    public static void main(String[] args) throws Throwable {
        Runtime rt = Runtime.getRuntime();

        double alloc = rt.totalMemory()/1000.0;
        double free = rt.freeMemory()/1000.0;

        System.out.printf("Allocated: %.2f kb\nFree: %.2f kb\n\n",alloc,free);

        Scanner in = new Scanner(new File("my_file.txt"));
        ArrayList<String> al = new ArrayList<String>();

        while(in.hasNextLine()) {
            String s = in.nextLine();
            al.add(s.substring(0,1)); // extracts first 1 character
        }

        alloc = rt.totalMemory()/1000.0;
        free = rt.freeMemory()/1000.0;
        System.out.printf("Allocated: %.2f kb\nFree: %.2f kb\n\n",alloc,free);

        in.close();
        System.gc();

        alloc = rt.totalMemory()/1000.0;
        free = rt.freeMemory()/1000.0;
        System.out.printf("Allocated: %.2f kb\nFree: %.2f kb\n\n",alloc,free);
    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-08T15:35:47.887

制作子字符串时，**您的子字符串会保留对原始字符串的 char 数组的引用**（这种优化使得处理字符串的许多子字符串非常快）。因此，当您将子字符串保存在`al`列表中时，您会将整个文件保存在内存中。为避免这种情况，请使用将字符串作为参数的构造函数创建一个新字符串。

所以基本上我建议你这样做

```
 while(in.hasNextLine()) {
        String s = in.nextLine();
        al.add(new String(s.substring(0,1))); // extracts first 1 character
    } 
```

String(String) 构造函数的源代码明确指出它的用途是修剪“包袱”：

```
 164       public String(String original) {
  165           int size = original.count;
  166           char[] originalValue = original.value;
  167           char[] v;
  168           if (originalValue.length > size) {
  169               // The array representing the String is bigger than the new
  170               // String itself.  Perhaps this constructor is being called
  171               // in order to trim the baggage, so make a copy of the array.
  172               int off = original.offset;
  173               v = Arrays.copyOfRange(originalValue, off, off+size);
  174           } else {
  175               // The array representing the String is the same
  176               // size as the String, so no point in making a copy.
  177               v = originalValue;
  178           }
  179           this.offset = 0;
  180           this.count = size;
  181           this.value = v; 
```

**更新：** OpenJDK 7 更新 6 解决了这个问题。使用更新版本的人没有这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T15:38:20.123

确保不要保留您不再需要的参考资料。

您仍然有对`al`and的引用`in`。

`al = null; in = null;`在调用垃圾收集器之前尝试添加。

~~此外，您需要了解如何`substring`实施。**`substring`保留原始字符串，并且对同一`char[]`数组使用不同的偏移量和长度。**~~

 ~~```
al.add(new String(s.substring(0,1))); 
```~~ 

~~不确定是否有更优雅的复制子字符串的方法。也许`s.getChars()`对你也更有用。~~

从 Java 8 开始， substring现在*会*复制字符。您可以自己验证构造函数是否调用了`Arrays.copyOfRange`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-08T15:38:19.233

System.gc() 并不能保证 JVM 会进行垃圾收集 - 它只是向 JVM 提出建议，它可以尝试进行垃圾收集。由于已经有大量可用内存，JVM 可能会忽略该建议并继续运行，直到它觉得有必要这样做。

在文档[http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#gc()中阅读更多信息](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#gc())

另一个关于它的问题可以在[System.gc() 什么时候做](https://stackoverflow.com/questions/66540/system-gc-in-java)

# sql-server - SQL Server Sould 我为每个用户创建一个登录名（不同于 sql server 中的“用户”概念）

> ID：10951818
> 
> 赞同：0
> 
> 时间：2012-06-08T15:32:25.537
> 
> 标签：sql-server, database

我正在模拟一个电子商务平台，用户注册，它可以是普通用户（只购买产品）或掌柜（在平台上拥有一个商店，并向包括普通用户和掌柜在内的所有用户销售产品）。我想知道如果用户注册，系统是否应该为它创建一个登录名（CREATE LOGIN @login_name WITH PASSWORD = @password）和一个用户（CREATE @usr_name FOR LOGIN @login_name）？是否有可能所有功能都作为 dbo 实现并将它们集成到客户端应用程序（桌面客户端或 Web 应用程序）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:45:04.330

除非您为最终用户提供对数据库的直接访问权限，否则应仅为您的 Web 应用程序维护和配置用户，并且不允许访问数据库。您可以（并且可能应该）为数据库创建分层用户级别的帐户，这样您就不会总是使用系统管理员从您的网络应用程序运行简单的检索/更新查询 - 只是我的看法

（从评论移到答案）

# java - Why make defensive copies in getters inside immutable classes?

> ID：10951820
> 
> 赞同：18
> 
> 时间：2012-06-08T15:32:44.150
> 
> 标签：java

This question is about good programming practices and avoiding potential holes.
I read Joshua Bloch's Effective Java and here is what I wonder:
Why should I consider making defensive copies in getter methods in my immutable class with no mutators in it?
And second: why should I make my fields *final* in addition to *private* ? Is this only about performance (not security) ?

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-06-08T15:37:05.030

我相信这种情况可以证明这种说法是合理的：

```
public class Immutable {

    private final String name;

    private Date dateOfBirth;

    public Immutable(String name, Date dateOfBirth) {
        this.name = name;
        this.dateOfBirth = dateOfBirth;
    }

    public String getName() {
        return name;
    }

    public Date getDateOfBirth() {
        return dateOfBirth;
    }

} 
```

`getName()`很好，因为它也返回不可变对象。但是该`getDateOfBirth()`方法可能会破坏不变性，因为客户端代码可以修改返回的对象，因此也可以修改对象`Immutable`：

```
Immutable imm = new Immutable("John", new Date());

imm.getName(); //safe
Date dateOfBirth = imm.getDateOfBirth();
//hundreds of lines later
dateOfBirth.setTime(0);  //we just modified `imm` object 
```

返回不可变对象和原语是安全的（因为它们是按值返回的）。但是，您需要制作可变对象的防御性副本，例如`Date`：

```
public Date getDateOfBirth() {
    return new Date(dateOfBirth.getTime());
} 
```

并将集合包装在不可变视图中（如果它们是可变的），例如参见[`Collections.unmodifiableList()`](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#unmodifiableList%28java.util.List%29)：

```
public List<Integer> getSomeIds() {
    return Collections.unmodifiableList(someIds);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-12T16:41:23.457

Java 中的对象引用是混杂的；如果将对象引用传递给方法，则该方法将无法知道还有谁可能对同一对象具有引用，或者同样他们可能会尝试用它做什么。同样，如果一个方法返回一个对象引用，也无法知道接收者会用它做什么。因此，如果一个类型允许任何拥有引用的人对其进行变异，那么拥有对此类对象的引用的实体可以确保它不会被变异的唯一方法是保留对私有对象的引用，外部从未有过，并且永远不会得到参考。

此处显示的防御性复制样式的替代方法（每次请求信息时都构造一个新对象实例）是让对象的信息检索方法接受一个可变对象并用检索到的信息填充该对象。这种方法要求请求信息的代码在调用方法检索信息之前构造一个（可能是空白的）对象来接受信息，但如果使用循环来检索、简要检查并丢弃 100 个根据信息，构造一个每次循环都可以重用的对象可能比构造 100 个新对象更快，每个对象都只会短暂使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:45:08.573

仅当您在 getter 中返回的对象是可变的时，您才应该进行防御性复制，因为客户端可能会更改您的对象状态。

关于最后一个问题，没有必要将字段设为 final，而是将它们设为最终授权，一旦创建对象就无法修改。

事实上，如果您需要在创建对象后修改其某些字段，这也可以，但您必须确保客户端代码无法区分对象状态已被更改。您必须使不可变的是对象的外部可见状态，而不是内部状态。

例如，String 类在创建时不会计算它的哈希码，它会在第一次需要时计算它，然后将其缓存在私有可变字段中。

我假设你的类被声明为 final 或只有私有构造函数，否则它的子类可能会以不可预知的方式改变你的非 final 字段......

一些示例代码来澄清：

```
public final class Question {      //final class to assure that inheritor could not
                                   // make it mutable

    private int textLenCache = -1;     //we alter it after creation, only if needed  
    private final String text;

    private Date createdOn;

    public Immutable(String text, Date createdOn) {
        Date copy=new Date(createdOn.getTime() ) //defensive copy on object creation

        //Ensure your class invariants, e.g. both params must be non null
        //note that you must check on defensive copied object, otherwise client 
        //could alter them after you check.
        if (text==null) throw new IllegalArgumentException("text");
        if (copy==null) throw new IllegalArgumentException("createdOn");

        this.text= text;  //no need to do defensive copy an immutable object
        this.createdOn= copy;
    }

    public int getTextLen() {  
         if (textLenCache == -1)
            textLenCache=text.length();   //client can't see our changed state, 
                                          //this is fine and your class is still 
                                          //immutable
         return textLenCache;    
    }

    public Date getCreatedOn() {
        return new Date(createdOn.getTime());         //Date is mutable, so defend!
    }

} 
```

**编辑**：

需要构造函数可变参数上的防御性副本有两个原因：

1.  创建对象后，客户端代码可能会更改参数的状态。您需要复制参数以避免这种可能性。例如，如果 String 对象构造函数 [String(char[] value)](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#String%28char%5B%5D%29)使用了您提供的 char 数组而不复制它：您将能够通过更改您在构造函数中提供的 char 数组来更改 String 内容。

2.  您希望确保可变对象状态在您检查它的约束和将它复制到您的字段中的时间之间不会发生变化。为此，您始终必须检查参数本地副本的约束。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T15:38:05.270

虽然封闭类可能是不可变的，但其 getter 方法返回的引用可能是可变的，允许调用者修改不可变的传递状态。例子：

```
public class MyImmutable
{
  private final StringBuilder foo = new StringBuilder("bar");

  public StringBuilder getFoo()
  {
    return foo; // BAD!
  }
} 
```

您应该使用*private*进行封装（防止类依赖于您的类的实现细节）。您应该使用*final*来确保您不会错误地修改该字段，如果它不应该被修改（是的，它*可能*有助于提高性能）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-13T09:36:48.643

我稍微修改了 Tomasz Nurkiewicz 的答案，以说明为什么将 dateOfBirth 设为 final 并不能防止它被客户端类更改：

```
 public class Immutable {

        private final String name;
        private final Date dateOfBirth;

        public Immutable(String name, Date dateOfBirth) {
            this.name = name;
            this.dateOfBirth = dateOfBirth;
        }

        public String getName() { return name;  }

        public Date getDateOfBirth() { return dateOfBirth;  }

        public static void main(String[] args) {

            //create an object
            Immutable imm = new Immutable("John", new Date());

            System.out.println(imm.getName() + " " + imm.getDateOfBirth());

            //try and modify object's intenal
            String name = imm.getName(); //safe because Integer is immutable
            name = "George";             //has no effect on imm

            Date dateOfBirth = imm.getDateOfBirth();
            dateOfBirth.setTime(0);  //we just modified `imm` object

            System.out.println(imm.getName() + " " + imm.getDateOfBirth());
        }
    }

    **Output:** 
    John Wed Jan 13 11:23:49 IST 2016
    John Thu Jan 01 02:00:00 IST 1970 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-08T15:38:25.103

> 为什么我应该考虑在我的不可变类的 getter 方法中制作防御性副本，而其中没有修改器？

*这仅在返回的对象不是不可变的情况下才有用。*

**像这样的深度**不变性对于防止不可变类持有的任何对象的更改很有用。

考虑你有一个对象缓存。每当从缓存中检索并更改对象时，您都会冒着修改缓存中值的风险。

> 除了私有之外，我为什么还要将我的字段设为最终字段？

只是为了帮助您实现不变性并防止值在设置后意外或交付更改（例如，通过子类化）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-08T15:39:11.510

1 如果你不做防御性副本，你可以让你的对象被发出，一旦发出，你的类不再是不可变的，调用者可以自由改变对象。

```
public class Immutable {
   private List<Object> something;

   public List<Object> getSomething(){
      return something; // everything goes for a toss, once caller has this, it can be changed
   }
} 
```

2 如果您的字段只是私有的而不是最终的，这意味着您可以重新初始化该字段，但如果您的字段是最终的，它将只初始化一次而不是多次，并且您实现了不变性。

# selenium - Selenium Grid2 / Selenium RC - 其他系统上的远程节点正在连接/注册到 HUB 但未执行测试

> ID：10951823
> 
> 赞同：1
> 
> 时间：2012-06-08T15:32:46.143
> 
> 标签：selenium, selenium-rc, selenium-webdriver, testng, selenium-grid

我有两台机器。一个正在运行`selenium hub`完整的测试套件，而另一个我想执行这些测试，所以我`node/rc`在第二台机器上运行，它注册到集线器，因为它显示集线器页面“ [http://localhost:4444/grid/console?config=true&configDebug =true](http://localhost:4444/grid/console?config=true&configDebug=true) " 正在显示它的条目。

问题是当我执行命令从第一台机器运行这些测试时，它不会在第二台机器上开始执行。

**运行测试时，我在集线器控制台中多次收到以下消息：**

*2012 年 6 月 8 日下午 7:32:56 org.apache.http.impl.client.DefaultRequestDirector tryConnect INFO：连接到目标主机时捕获 I/O 异常 (java.net.NoRouteToHostException)：没有到主机的路由：连接2012 年 8 月 7:32:56 PM org.apache.http.impl.client.DefaultRequestDirector tryConnect INFO：连接到目标主机时捕获 I/O 异常 (java.net.NoRouteToHostException)：没有到主机的路由：连接 6 月 8 日, 2012 7:32:56 PM org.apache.http.impl.client.DefaultRequestDirector tryConnect 信息：重试连接。*

如果我在已经运行`node/rc`的第一台机器上`hub`运行，它将按预期执行这些测试。

我刚刚将之前由 selenium RC 运行的测试套装迁移到 selenium 网格。测试是用 Java 编写的并使用 TestNG。

我是否还需要更改 TestNG 文件中的某些内容？我已经安装和配置`ant/java`并放置`selenium-server-standalone<version no>.jar`在第二台机器上。还需要什么吗？

请继续提出建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:49:30.607

检查您的机器是否可以根据您的网格配置和正在使用的端口相互通信。

你可以使用`telnet <hostservername> <portnumber>` . `telnet node.suman.com 4445`来自 Hub 机器和`telnet hub.suman.com 4444`节点的示例。

在命令行上运行后的两个命令都应该说 -

```
Trying <some IP>...
Connected to node.suman.com.
Escape character is '^]'. 
```

# c++ - 假设 boost::uuid 不会返回重复项是否安全？

> ID：10951828
> 
> 赞同：2
> 
> 时间：2012-06-08T15:33:10.207
> 
> 标签：c++, boost, uuid, boost-uuid

我正在使用 boost uuid 来生成会话 ID。

```
std::string SessionGenerator::generate()
{
    boost::uuids::uuid id = m_rgen();
    m_ss.clear();
    m_ss.str("");
    m_ss << id;

    return m_ss.str();
} 
```

假设我永远不会得到副本是否安全，或者我应该对活动会话进行检查？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T15:40:12.020

这得看情况。

> 当 UUID 由定义的机制之一生成时，它们要么**保证是唯一的**，**与所有其他生成的**UUID 不同（也就是说，它以前从未生成过，也永远不会再次生成），要么**极有可能是唯一的**（取决于机制）。

这意味着问题可能出在您使用的发电机上。他们说他们正在使用[ITU-T 规范](http://www.itu.int/ITU-T/studygroups/com17/oid/X.667-E.pdf)。

让我们转到文档的第 7 页。如果您使用时间并且可以假设：

*   系统时间不会改变。
*   用于识别机器的节点 ID 不会改变。

然后你至少可以断言：

*“UUID 将不同于所有其他生成的 UUID”*，因为时间流逝且粒度为 100 ns。

如果您需要与其他机器共享生成的 UUID 或时间会发生变化，可能会发生冲突（不要忘记在许多国家/地区每年两次有时间调整）。这就是为什么有一个*时钟序列*字段。此外，它非常小，因此在这种情况下，您可以断言：

*“UUID 极有可能是唯一的。”*

如果您使用的是随机数生成器而不是这个，那么您只能断言：

*“UUID 极有可能是唯一的。”* 因为随机数生成器的要求不是生成唯一的数字（但是使用好的随机数生成器，您*极有可能极有*可能*）*。

因此，在*正常*情况下（例如，如果您没有将一张网卡从一台计算机移动到另一台计算机并且您将时间更改回过去）我想您可以假设它们是唯一的（使用时间）。如果您使用的是随机数生成器，您不能假设它们是唯一的，但极有可能是唯一的（关于碰撞概率......嗯......如果它发生在一个好的随机数生成器上，你应该留在下一场流星雨的家）。

**参考资料**
[http://blogs.msdn.com/b/oldnewthing/archive/2008/06/27/8659071.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2008/06/27/8659071.aspx)
[http://en.wikipedia.org/wiki/Birthday_attack](http://en.wikipedia.org/wiki/Birthday_attack)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:40:53.940

如果单个生成器正在生成所有 uuid，则应保证它们是唯一的。免责声明，我没有查看代码或文档来验证这一点，但这是一个设计目标。

有不同类别的 uuid，其中一些包括来自运行它的机器或环境的位。这些将减少与其他地方生产的 ID 发生冲突的机会。

即使在最坏的情况下，由于 RAM 错误而破坏 ID 的机会也远高于生成两个相同 ID 的机会。没有人担心这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:41:47.763

不，你不能假设你**永远不会**得到重复。
**但是**您可以查看[维基百科](http://en.wikipedia.org/wiki/Universally_unique_identifier)以获得重复的概率。
而且由于`boost`遵循 ITU 规范，我认为您可以假设永远不会有重复。

# php - PHP 数据库连接注意事项

> ID：10951829
> 
> 赞同：2
> 
> 时间：2012-06-08T15:33:14.857
> 
> 标签：php, database, pdo, odbc

我正在用 PHP 编写一个新的应用程序，它将作为商业应用程序向公众发布。到目前为止，我的经验一直是 PHP 中的 MySQL 数据库。

最终用户负责提供数据库功能，PHP 应用程序将简单地连接到它并使用它。

我的问题是，由于我不知道用户将使用什么数据库，我该如何在 PHP 中支持它？

我的问题是：

*   ODBC 是正确的方法吗？我在下面提到了 ODBC，但如果 ODBC 不是正确的使用方法，同样的问题适用于任何建议的方法。

*   使用 ODBC 函数而不是 PHP 中的 MySQL 等效项是否会丢失任何功能/特性？

*   我需要记住任何与安全相关的事情吗？例如，我在以前的应用程序中使用过 mysql_real_escape_string()。什么是 ODBC 等价物（甚至需要它吗？）

*   我假设 PHP 可以使用 ODBC 连接到 MySQL 数据库？MySQL 是否需要以某种方式进行配置以允许这样做？

*   性能方面，ODBC 是否可以接受？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:46:30.853

对于支持和性能，您最好的选择可能是 PDO（PHP 数据库对象）。这是 PHP 的核心，支持所有主要的数据库系统，将本机处理转义字符串等。

为了保持不可知，你不能只使用 MySQL 的东西，例如所有 SQL 数据库都不支持的 LIMIT add。

但话虽如此，请先检查。如果客户端有一个 noSQL 数据库，或者使用带有唯一连接字符串的 Amazon（例如），那么您就有麻烦了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:37:38.067

> 我的问题是，由于我不知道用户将使用什么数据库，我该如何在 PHP 中支持它？

这是在 PHP 中使用数据库抽象的链接。

数据库抽象库的目的是创建与多个数据库服务器通信的一致性。这样想，为了让您的应用程序支持多个数据库，它需要不同的代码行来在每个数据库上执行相同的功能。使用抽象库，应用程序只需要一组代码即可与库支持的任何数据库进行通信。这极大地增加了可用于 PHP 应用程序的数据库服务器选项的数量。

[http://www.hosting.com/support/programming/using-adodb-to-build-a-database-agnostic-php-application](http://www.hosting.com/support/programming/using-adodb-to-build-a-database-agnostic-php-application)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:47:36.220

我可能会标准化 PDO；它抽象了大量的数据库并公开了一个统一的接口，它是用 C 语言编写的，大多数人都会默认安装它。

这里要注意；并非所有数据库都支持相同的 SQL 语法，因此您可能也必须为此进行准备。虽然这很棘手，但一种方法是在 PDO 和您的类之间定义一个辅助类；这个助手类会将业务逻辑调用转换为实际的 SQL。您可以提供一个适用于 MySQL 并让您的用户创建其他的吗？:)

# jquery - jQuery howto : 悬停链接 div 淡入，鼠标移出链接或 div ， div 淡出

> ID：10951830
> 
> 赞同：2
> 
> 时间：2012-06-08T15:33:15.893
> 
> 标签：jquery, hover, show-hide, mouseenter, mouseleave

好的，请考虑以下情况。

我有 2 个链接，都在

*   标签中包含的标签。

    基本上，将鼠标悬停在链接 A 上会触发一个盒子的动画，在该盒子下方淡入淡出，并且在链接 A 的 mouseout 和盒子的 mouseOut 上，盒子淡出。

    与链接 B 相同，它触发不同框的动画。

    在链接和框之间发生了一些 php 条件。

    ```
    <ul class="links">
    <li class="linkA"><a><span>Hover here to see BOX A</span></a></li>
    <li class="linkB"><a><span>Hover me to see BOX B</span></a></li>
    </ul>

    <?php if ( is_user_logged_in() ) { ?>
    <div id="boxA">
    Some content here for Box A
    </div>
    <?;}

    else { ?>
    <div id="boxB" >
    Content for Box B
    </div>
    <?php }
    ?> 

    <style>
    ul,
    li {list-type:none; display:inline}
    li.linkA a {display:block; width:20px; height:20px; background:url(my_image_A.png) no-repeat;}
    li .linkB a {display:block; width:20px; height:20px; background:url(my_image_B.png) no-repeat;}

    boxA,
    boxB {width:300px;height:180px;border:4px solid #00aaff;background:yellow; display: none;}
    <script>

    jQuery(".linkA").hover(function() {
    jQuery("#boxA").fadeIn('fast').css('display', 'block');
     }, function() {
    jQuery("#boxA").fadeOut('fast')
    });
    </script> 
    ```

    它只是无法正常工作。一旦鼠标离开链接，这些框就会消失。我希望该框保持可见，直到鼠标离开链接和/或框...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:38:54.497

使用以下 jQuery：

```
$(".linkA").mouseover(function() {
    $("#boxA").fadeIn('fast');
}).mouseout(function () {
    $("#boxA").fadeOut('fast');
});​

$(".linkB").mouseover(function() {
    $("#boxB").fadeIn('fast');
}).mouseout(function () {
    $("#boxB").fadeOut('fast');
});​ 
```

看这个[活生生的例子](http://jsfiddle.net/hKzAW/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:41:49.777

```
$(".linkA").on('hover', function(e) {
    if(e.type == 'mouseenter') {
      $("#boxA").fadeIn('fast');
    } else {
      $("#boxA").fadeOut('fast');
    }
});​ 
```

做一个悬停，不需要为每个链接编写单独的悬停语句。

### 如果您的链接只有一个类，则可以使用如下所示。

```
$(".linkA, .linkB").on('hover', function(e) {
    if(e.type == 'mouseenter') {
      $("#box" + this.className.replace('link','')).fadeIn('fast');
    } else {
      $("#box" + this.className.replace('link', '')).fadeOut('fast');
    }
});​ 
```

**[演示](http://jsfiddle.net/thecodeparadox/9EJuR/2/)**

### 笔记

你不需要`display: block`，因为 jQuery 在它的时候使用了这个`.fadeIn()`。

# python - 处理多个同时 SFTP 连接

> ID：10951831
> 
> 赞同：1
> 
> 时间：2012-06-08T15:33:18.657
> 
> 标签：python, sftp, paramiko

我正在实现一个 SFTP 服务器，使用[https://github.com/rspivak/sftpserver](https://github.com/rspivak/sftpserver)作为参考。推出我自己的解决方案的原因是自定义身份验证方案和特殊的 chrooting 和黑/白名单标准。

我现在的问题是一次处理多个连接。我当前的循环如下所示：

```
# Wait for a connection
conn, addr = server_socket.accept()

# Open a transport for this connection
tr = Transport(conn)

# Load our private host key
key = RSAKey.from_private_key_file("sftp.key")
tr.add_server_key(key)

# Tell server to support SFTP
tr.set_subsystem_handler("sftp", SFTPServer, sftp.ChrootedSFTP)

# Start a SSH server for this connection and serv it
server = auth.ChrootedAuthServer(db_factory, "/path/to/chroot")
tr.start_server(server=server)

# Wait for client to establish SSH connection
ch = tr.accept() 
```

我的解决方案不必非常快。只能处理大约 10 个同时连接，每个连接每隔一段时间推送一次数据。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-07-13T20:36:49.077

以防万一有人可能需要python中的简单多线程sftp服务器：问题中提到的基于paramiko的sftpserver模块可以很容易地转换为多线程版本。这是一个例子：[https ://gist.github.com/Girgitt/2df036f9e26dba1baaddf4c5845a20a2](https://gist.github.com/Girgitt/2df036f9e26dba1baaddf4c5845a20a2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-21T10:19:28.680

我知道这是一个旧线程，当我遇到稍微相似的要求时，我遇到了这个问题。虽然，我真的不想实现一个完整的 sftp 服务器，但我已经开始使用 paramiko 来做到这一点。

实际上，我想要的是提供对文件系统*抽象*的 sftp 访问，该文件系统实际上是由定义良好的 api 提供的。

我开始推出自己的解决方案，只是意识到只需重新关注我真正需要的东西就可以更容易地做到这一点。因此，尽管这不能直接回答问题，但我认为在此处添加对我的解决方案的引用可能对其他任何以这种方式绊倒的人有用。

我的解决方案是混合使用 openssh 和 paramiko。

使用此解决方案，设置套接字连接、身份验证/密钥交换等的所有 ^繁重的工作，以及我的 sftp 服务器将只执行协议命令。请注意，这种区别是可能的，因为 sftp 只是一个“子系统”，ssh 服务器进程通过“实现”子系统的命令的标准输入/标准输出与它通信（参考：[http ://docstore.mik.ua/orelly/网络_2ndEd/ssh/ch05_07.htm](http://docstore.mik.ua/orelly/networking_2ndEd/ssh/ch05_07.htm) )

因此，要以一种非常全面的方式回答最初的问题——如果您有兴趣简单地为某些东西（在这种情况下为 chroot'd 文件系统）提供类似 sftp 的*接口*，您甚至不必担心处理多个同时的 sftp 连接——让 opensshd 为你做这件事。只需扩展 paramiko 工具来实现您的自定义 sftp 实例，独立于传输和通道。

以防万一，这是我的方法的要点：[https ://gist.github.com/lonetwin/3b5982cf88c598c0e169](https://gist.github.com/lonetwin/3b5982cf88c598c0e169)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:16:36.717

您可以使用`subprocessing`or`threading`模块为客户端连接的每个实例生成一个单独的进程，您的主循环负责管理线程。

您可以通过实例化连接并一直等待客户端连接来做到这一点，当发生这种情况时，您可以打开一个子进程，将连接的处理程序传递给子进程，然后为新连接创建一个新的处理程序。

# linq-to-entities - LINQ-To-Entities 查询 - 数据库上发生了什么以及本地发生了什么？

> ID：10951836
> 
> 赞同：1
> 
> 时间：2012-06-08T15:33:35.557
> 
> 标签：linq-to-entities

在我的 WCF 服务的业务逻辑中，我有一个允许按一个或多个列过滤用户的功能。我做过滤的方式是这样的：

```
public List<UserDto> GetUsersByFilters    (
                                              String ssn, 
                                              List<Guid> orderIds, 
                                              List<MaritalStatusEnum> maritalStatuses, 
                                              String name, 
                                              int age
                                          )
{
    using (MyProjEntities entities = new MyProjEntities())
    {
        IQueryable<User> users = entities.Users;

        // Filter By SSN (check if the user's ssn matches)
        if (String.IsNullOrEmusy(ssn) == false)
            users = users.Where(us => us.SSN == ssn);

        // Filter By Orders (check fi the user has all the orders in the list)
        if (orderIds != null)
            users = users.Where(us => UserContainsAllOrders(us, orderIds));

        // Filter By Marital Status (check if the user has a marital status that is in the filter list)
        if (maritalStatuses != null)
            users = users.Where(pt => maritalStatuses.Contains((MaritalStatusEnum)us.MaritalStatus));

        // Filter By Name (check if the user's name matches)
        if (String.IsNullOrEmusy(name) == false)
            users = users.Where(us => us.name == name);

        // Filter By Age (check if the user's age matches)
        if (age > 0)
            users = users.Where(us => us.Age == age);

        return users.ToList();
    }
}

private   Boolean   UserContainsAllOrders(User user, List<Guid> orderIds)
{
    return orderIds.All(orderId => user.Orders.Any(order => order.Id == orderId));
} 
```

我的问题是： **数据库上发生了哪些查询以及本地发生了什么？**

显然，我不希望每次都将数据库中的所有用户都提取到我的记忆中......

我假设因为“按订单过滤”使用本地函数 - 无法在数据库上完成，所以这是在本地完成的。我对吗 ？

如果是这样 - 这是否意味着之后发生的所有事情也会在本地发生？

如果没有“按订单过滤”怎么办？一切都会在数据库端完成吗？

LINQ-TO-EF 是否知道如何将“婚姻状况”查询“翻译”为数据库端查询？（我正在检查用户的婚姻状况枚举是否存在于传递给函数的枚举列表中）。

谢谢 ！

**[编辑：对不起。我不知道为什么代码没有自动着色]**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:52:31.693

如果您将鼠标悬停在不同的“where”语句上，您会注意到它们是 IQueryable 的（或者至少它们应该是）......只要您不断将 Iqueryable “where's”附加到彼此，该语句就应该保留一个 Iqueryable （而不是每次都调用数据库）。

当您最终在底部执行 ToList 时，您将真正调用数据库。

实际上，在您构建 linq to ent 语句时观察非常重要，并确保您不会无意中调用返回 IEnumerable 的扩展，而不是您想要的。如果您不小心调用了返回 IEnumerable 的扩展程序，然后开始调用“skip”和“take”，尝试进行 sql 侧分页，那么您将错过......您将跳过并占用内存对象而不是创建优化的 sql 查询。

至于到底发生了什么，如果您打开分析器并观察调用 ToList（或任何其他 IEnumerable 扩展）时提交的 sql 查询，那将是最有趣的。Linq to Ent 通常会构建一个非常优化的 sql 语句。添加一个 Iqueryable Skip and Take 例如，Linq to Ent 将为 RowNumber 和类似的东西生成必要的 sql，以便它可以有效地执行 sql 服务器端分页。（请注意，随着查询变得越来越复杂，Linq to Ent 更难创建最优化的查询。如果复杂的查询开始花费太长时间，最好捕获正在提交的 sql，因为通常可以编写自己的更优化的在这些情况下查询）。

您也可以通过这种[方式跟踪 sql](https://stackoverflow.com/questions/137712/sql-tracing-linq-to-entities)

# excel - 使用 VBA 防止 Excel 中的单元格重叠

> ID：10951837
> 
> 赞同：6
> 
> 时间：2012-06-08T15:33:39.403
> 
> 标签：excel, vba, cell

我想知道是否有一种方法可以防止单元格的文本重叠到相邻的单元格中，而无需调整单元格本身的大小，或者将单元格内容设置为换行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-05T13:47:18.220

早上好。有一种方法可以干净地做到这一点：

*   选择范围
*   右键单击>“设置单元格格式”>“对齐”选项卡
*   在文本对齐区域中，从“水平”下拉菜单中选择“填充”

在 VBA 中，看起来像：

```
Sub AwayWithYouConfusingOverlap()
    Range("A1").HorizontalAlignment = xlFill
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-08T15:39:57.923

除了您提到的两种方法（重新调整单元格大小并将其设置为换行）之外，唯一的方法是在相邻单元格中放置文本。[编辑：我忘记了另一种方法，正如 Siddharth Rout 指出的那样，如果将单元格格式化为“缩小以适应”（在对齐>文本控件下），字体大小将自动缩小，以使内容适合单元格宽度。 ] 如果您只想在单元格的边缘截断长文本，只有当文本将流入的单元格具有自己的内容时，Excel 才会执行此操作。

自动执行此操作的最快方法是：

1.  遍历所有包含内容的单元格。
2.  如果它们还没有内容，则在水平相邻的单元格中放置一个空格。

请注意，您应该对具有溢出内容的单元格的左侧和右侧的两个单元格执行此操作，或者检查文本是左对齐还是右对齐，以帮助确定需要填充两个水平相邻单元格中的哪一个。

如果您只想对本来会溢出的单元格执行此操作，那么您必须做一些更复杂的事情。你不得不：

1.  遍历所有包含内容的单元格。
2.  检查与当前单元格相邻的单元格是否为空白。如果没有，您可以跳过此单元格并继续下一个单元格。
3.  将当前单元格的内容复制到空白列中的单元格（最好在新的临时工作表上）。
4.  告诉您的临时列自动调整大小（以找出所需的单元格宽度）。
5.  如果临时列的自动大小宽度大于源列的宽度，则单元格内容将溢出 - 因此您需要在相邻单元格中放置一个空格。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-10T14:44:13.490

我最近发现了一种干净的方法来防止相邻单元格中的重叠文本出现：

*   选择范围
*   右键单击>格式化单元格>对齐>复选框换行

结果可能看起来很丑，因为不同的行可能以不同的高度显示。但是，仍然可以通过强制所有行具有相同的高度来修复所有问题：

*   选择范围
*   右键单击最左边的列（包含行号）> 行高> 输入所需的值。

而已 ...

我希望我的法语不会掩盖我的英语，至少不会太多。

* * *

此解决方案的优点是还可以用于打印（如果您想防止溢出到其他空白页），因为您不需要额外的列。

可以在 VBA 中执行相同的过程：

```
With Range("A1:H100")
    .WrapText = True ' enable wrapping, will autoformat height
    .rows.RowHeight = 12.75 ' set back to default height, overflow is removed
End With 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-24T19:11:54.587

我只在重叠单元格旁边的单元格中放置了一个空格。它不再重叠。我在整个电子表格中复制并粘贴该单元格

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-02T12:14:57.223

我通过以下步骤解决了我的问题：

1.  选择范围（对于我的情况，我通过按 ctrl+A 选择了所有区域）
2.  右键单击>“格式化单元格”
3.  转到“对齐”选项卡
4.  从“文本对齐”区域，从“水平”下拉菜单中选择“对齐”选项
5.  然后按确定

之前是：[![在此处输入图像描述](../Images/4ec4c80f44e1ee3ff884a4d167ba8d89.png)](https://i.stack.imgur.com/R7ZfF.png)

然后是： [![在此处输入图像描述](../Images/85d2d56a1cb711181a436ba9295c3b13.png)](https://i.stack.imgur.com/8Iap0.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-02T21:30:06.327

我只需在要停止重叠的列的右侧插入一列，然后以小磅值输入一个字符。然后将其一直复制到电子表格中，并将列的宽度缩小到 0.5，使其几乎不引人注意。这样您就不会影响公式，并使您的电子表格更易于阅读。

# sinatra - Sinatra Padrino 简单应用程序无法运行

> ID：10951839
> 
> 赞同：0
> 
> 时间：2012-06-08T15:33:54.833
> 
> 标签：sinatra, thin, webrick, padrino

我已经使用数据映射器编写了一些简单的 Sinatra 应用程序。

我想试试帕德里诺。

去 padrinorb.com

头版上有

```
gem install padrino
padrino g project myapp -d datamapper -b
cd myapp
padrino g admin
padrino rake dm:migrate seed
padrino start 
```

所有这些命令似乎都很顺利。然后当我输入 padrino start 时，它运行 webrick（对吗？）但没有任何效果 - 所有请求都被视为 404。帕德里诺 0.10.6

我敢肯定它很简单。我有在其他应用程序中工作的数据映射器。我在 OS X 10.7 上，使用 ruby​​ 1.9.2。关于有什么问题的任何想法？

额外的问题 - 是否有 padrino 的讨论论坛？

```
 Ref: 
 Snow-Pro:magnus tandersen$ padrino start
  => Padrino/0.10.6 has taken the stage development at http://0.0.0.0:3000
 [2012-06-08 11:16:02] INFO  WEBrick 1.3.1
 [2012-06-08 11:16:02] INFO  ruby 1.9.2 (2011-07-09) [x86_64-darwin11.3.0]
 [2012-06-08 11:16:02] INFO  WEBrick::HTTPServer#start: pid=39918 port=3000
  DEBUG -      GET (0.0241ms) / - 404 Not Found
 DEBUG -      GET (0.0136ms) /__sinatra__/404.png - 304 Not Modified 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T16:15:28.777

试着去

```
http://localhost:3000/admin 
```

# php - 有没有更好的方法来合并数据和 HTML 标记

> ID：10951842
> 
> 赞同：1
> 
> 时间：2012-06-08T15:34:07.440
> 
> 标签：php, html

我有一张从数据库中获取信息的表格……它是一个足球比分表。

在此表中，我有一列包含徽标“i”，当我将其悬停时，它会打开一个工具提示弹出窗口并提供有关匹配的信息...

这就是它的样子

![我的工具提示的外观示例](../Images/9e222274c37c441361b368ef4c218f53.png)

所以要发布这个工具提示的信息，我使用标签的`title`属性，`img`在标题中我有这个代码`title="<?php echo $row['InfoData'].""; ?>"`来获取数据。

在我写的数据库中

```
Arena AufSchalke, Gelsenkirchen<br><br>
<table id='it'>
<tr><td>8' Klose</td>      <td align='right'>Arnautovic 42'</td></tr>
<tr><td>23', 47' Özil</td> <td align='right'>Harnik 51'</td></tr>
<tr><td>28' Podolski</td>  <td align='right'> </td></tr>
</table> 
```

我的问题是每次我想在数据库中填写信息时，我都必须再次编写所有这些 html 代码并将右侧对齐到右侧，并且在 css 中我在表格的 TD 之间进行填充`#it td {padding-right: 5px; padding-left: 5px;}`

所以我想要一个解决方案来避免这样做？我怎么能做的快？无需添加所有这些代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:37:36.440

您不应该将所有 HTML 存储在数据库中。仅将*数据*存储在数据库中。我不确定到底发生了什么，因为我不懂那种语言，但是您应该将这些数字中的每一个存储在数据库的列中，并在 PHP 中查询它们。每个数字都有一个变量，然后以表格格式打印出来。像下面一行这样简单的东西就可以工作：

```
<tr><td> </td>   <td align='right'><?php echo $variable_name; ?></td></tr> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:40:25.930

有一张表格，列出在每场比赛中得分的球员。然后运行查询以获取这些玩家，在 php 中构建字符串，然后将其放在标题中。

```
$string = "<table>";

$r = mysql_query("SELECT * FROM scorers WHERE game=$game_id");
while($a = mysql_fetch_assoc($r)) {
   $string .= "<tr><td>".$a['player_name']."</td></tr>";
}

$string .= "</table>";

echo "<img src='x' title='".$string."' />"; 
```

显然，这只是一个示例，并不完全是预期的结果。但它展示了如何从数据中构建一个字符串，然后将其放入标题属性中。你应该能够锻炼如何做剩下的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:43:26.610

如果没有更多信息，很难具体说明，但您不应该将 HTML 存储在数据库中是对的。相反，将各个数据片段存储为字段。要存储数据数组，您可以使用[关联表](http://en.tekstenuitleg.net/articles/software/database-design-tutorial/one-to-many.html)，或者将数组[序列化](http://php.net/manual/en/function.serialize.php)并将其存储为文本（不要忘记在返回时取消[序列化](http://php.net/manual/en/function.unserialize.php)！）

假设您的`$row`价值看起来像这样：

```
 array(
        'InfoName'=>'Astana Arena, Astana',
        'InfoList'=>array(
            'Klose 48\'',
            'Gómez 76\'',
            'Podolski 85\''
        )
    ) 
```

您的代码将如下所示：

```
 $html = $row['InfoName'];
        $html .= '<br><br><table>';
        foreach ($row['InfoList'] as $r) {
            $html .= '
                <tr>
                    <td>&nbsp;</td>
                    <td align="right">'.$r.'</td>
                </tr>
            ';
        }
        $html .= '</table>';
        echo htmlentities($$html); 
```

`htmlentities`如果要将 HTML 存储在 HTML 元素的属性值中，则调用是必要的。

**文档**

PHP `htmlentities`- [http://us3.php.net/manual/en/function.htmlentities.php](http://us3.php.net/manual/en/function.htmlentities.php)

PHP `foreach`- [http://us3.php.net/manual/en/control-structures.foreach.php](http://us3.php.net/manual/en/control-structures.foreach.php)

PHP `serialize`- [http://php.net/manual/en/function.serialize.php](http://php.net/manual/en/function.serialize.php)

PHP `unserialize`- [http://php.net/manual/en/function.unserialize.php](http://php.net/manual/en/function.unserialize.php)

一对多关系教程 - [http://en.tekstenuitleg.net/articles/software/database-design-tutorial/one-to-many.html](http://en.tekstenuitleg.net/articles/software/database-design-tutorial/one-to-many.html)

# iphone - 获取的属性 - 谓词

> ID：10951844
> 
> 赞同：1
> 
> 时间：2012-06-08T15:34:14.263
> 
> 标签：iphone, objective-c, core-data, nspredicate, fetched-property

我有一个关于在 NSPredicate 中使用获取的属性的问题（见下文“我的问题”）。这与获取获取的属性的谓词无关。为了澄清和其他可能也面临这个问题的人，我尝试制作一个小型示例项目。

# 示例项目

使用 Fetched Properties 的需求来了，因为我的应用程序因违反 iOS 数据存储指南而被拒绝。他们在[QA1719](http://developer.apple.com/library/ios/#qa/qa1719/_index.html)中写道：

> 应用程序应避免将应用程序数据和用户数据混合在同一个文件中。

我认为这对于更轻松的 iCloud 同步可能是必要的，也可能有助于迁移。

那么，如何做到这一点呢？

我使用了一个预加载的 sqlite 数据库，我在第一次启动时从包路径中复制了该数据库，并用于保存用户编辑。因为您不应该混合预加载数据和用户数据，所以我试图将它们分开。

主要问题是，不可能在不同的商店之间建立关系（[跨商店关系](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreData/Articles/cdRelationships.html#//apple_ref/doc/uid/TP40001857-SW5)）。

我还没有找到 Fetched Property Project 的样本，所以我在这里尝试自己制作。

对于示例，有：

1.  存储在持久存储 Books.sqlite 和
2.  一种使书籍成为您最喜欢的书籍的方法。这存储在持久存储 UserData.sqlite 中。

实体是：

```
--------------                --------------
|   Books    |                |   Favorite |
--------------                --------------
- author                      - favorite
- title        --- 1 : 1 ---  - books_title 
```

实体 'Books' 用于 PreloadedData，'Favorite' 应该包含 UserData。

*收藏标签只是一个例子，它也可能是用户制作的笔记（可用的谓词）或者如果这本书是租给其他人的......*

在我的 xcdatamodeld（Xcode 编辑器）中，我添加了两个配置（PreloadStore、UserStore）。每个包含只包含所需的实体。

它们与（其他一切都来自样板）一起使用：

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {
...
if (![__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:@"PreloadStore" URL:storeURL options:nil error:&error]) {
...
if (![__persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:@"UserStore" URL:storeURLUserData options:nil error:&error]) { 
```

我在带有谓词的书籍中创建了一个获取的属性 link_favorite

```
books_title == $FETCH_SOURCE.title 
```

示例项目可以在**[这里](https://www.dropbox.com/s/fup0v370qtsbvgz/Books.zip)****下载**。它正在工作，除了谓词（按收藏书籍过滤）。

# 我的问题

我想仅按最喜欢的那些书过滤我在 Books 中的获取。我尝试使用

```
fetchRequest.predicate = [NSPredicate predicateWithFormat:@"favorite_link.favorite == 1"]; 
```

在`MasterViewController.m`（fetchedResultsController）中，但这只会导致崩溃。

我想我必须使用[类似 here](https://stackoverflow.com/questions/6449615/fetched-properties-inside-nsfetchedresultscontrollers-predicate)和 COUNT 或 SUBQUERY 的东西，但我想不通。

在此先感谢您的帮助！

**- 编辑：**

我做了一个简单的 NSArray 提取（核心数据），下面是工作：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"ANY link_favorite.favorite == 1"];
result = [result filteredArrayUsingPredicate:predicate]; 
```

但是我如何在 NSFetchedResultsController 的 SUBQUERY 中翻译这个（[试过这篇博客文章](http://funwithobjc.tumblr.com/post/2726166818/what-the-heck-is-subquery)）？错误的是：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SUBQUERY(contents, $x, $x.link_favorite.favorite == 1).@count > 0"] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T08:03:06.400

子查询需要我们这里没有的关系。所以这在我看来是行不通的。您可以切换 fetchedResultsController 中的实体，通过 fetched 属性检索您需要的数据到相关的书籍对象。如果为了节省时间，您可以（就像您已经做的那样）存储最相关的数据，以便在您最喜欢的对象内的 tableview 中显示，并且仅当用户选择一个单元格并且您进入详细视图时才检索其他数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:16:11.027

> 我使用了一个预加载的 sqlite 数据库，我在第一次启动时从包路径中复制了该数据库，并用于保存用户编辑。

自带预加载数据本身并没有什么问题。您可能应该只在捆绑包中提供一个 JSON 文件，并在初始应用程序加载时对其进行解析并将其导入 Core Data。这将简化您尝试做的事情，并且不会对 Apple 产生反感。如果您这样做，您的其余问题将变得无关紧要。有不止一种方法可以做到这一点。

另外，您是否有理由将“收藏”设为自己的实体？为什么不能在名为“isFavorite”的图书实体上创建一个布尔值？

# c++ - 将C中的图像加载到无符号字符

> ID：10951845
> 
> 赞同：0
> 
> 时间：2012-06-08T15:34:20.803
> 
> 标签：c++, c, image, image-processing, cuda

我无法制作一个小程序来转换为灰度。我必须将 BMP 文件加载到 unsigned char 并将其发送到 CUDA 函数（我发现了这个： http: [//www.mindfiresolutions.com/Image-Processing-with-CUDA-650.php](http://www.mindfiresolutions.com/Image-Processing-with-CUDA-650.php)）。

我使用过 CImg，但它无法将值保存为 unsigned char 并发送到 CUDA 函数（返回值不是灰度图像）。如何将图像加载到 unsigned char 作为

`px[0] = R , px[1] = G, px[2] = B, px[3] = A`等等。

也许我正在测试太小的图像？（10 x 10 像素）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:16:26.860

第一步是将图像文件加载到内存中

如果是bmp，有一个很简单的[bitmap loading lib](http://easybmp.sourceforge.net/)。然后，一旦您将它作为 CPU 上的 unsigned char[] 数组，您就可以使用任何 CUDA 函数将其复制到 GPU 并对其进行处理。

[opencv 图像处理](http://opencv.willowgarage.com/wiki/OpenCV%20GPU%20FAQ)库现在很好地支持 CUDA，它的 GPU 图像格式是开始在 CUDA 中编写自己的图像处理任务的一个非常好的地方。

当然，它具有您可能想要的所有加载/保存/显示功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:20:41.863

很久以前，我编写了[cuda-grayscale](http://code.google.com/p/cuda-grayscale/)，这是一个演示应用程序，展示了如何集成[OpenCV和 CUDA：它使用](http://code.opencv.org/projects/OpenCV/wiki/WikiStart)[OpenCV](http://code.opencv.org/projects/OpenCV/wiki/WikiStart)从磁盘加载图像并使用 CUDA 将其转换为灰度。

您可以下载它并查看[项目页面](http://code.google.com/p/cuda-grayscale/)上的代码。基本上，我创建了一个新`float`数组来存储原始`unsigned char`数据并将其发送到 GPU 进行处理。

# android - android以编程方式在radiogroup按钮之间添加填充

> ID：10951848
> 
> 赞同：14
> 
> 时间：2012-06-08T15:34:32.853
> 
> 标签：android, radio-button, padding, margin, radio-group

我在 xml 中有一个单选组，按钮是通过编程方式生成的。如何以编程方式在按钮之间添加间距。

我认为这有点像`LayoutParams`，但我的对象没有明显`setPadding`或`setMargins`方法。

这就是我正在尝试的

```
RadioButton currentButton = new RadioButton(context);
            currentButton.setText(item.getLabel());
            currentButton.setTextColor(Color.BLACK);

            //add padding between buttons
            LayoutParams params = new LayoutParams(context, null);
            params. ... ??????
            currentButton.setLayoutParams(params); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-08T15:38:28.340

**填充**

普通`LayoutParams`没有应用填充的方法，但视图有。由于 RadioButton 是视图的子类，因此您可以使用[View.setPadding()](http://developer.android.com/reference/android/view/View.html#setPadding%28int,%20int,%20int,%20int%29)，例如：

```
currentButton.setPadding(0, 10, 0, 10); 
```

这会在顶部添加 10px 填充，在底部添加 10px。如果您想使用 px 之外的其他单位*（例如`dp`）*，您可以[`TypedValue.applyDimension()`](http://developer.android.com/reference/android/util/TypedValue.html#applyDimension%28int,%20float,%20android.util.DisplayMetrics%29)先将它们转换为像素。

**边距**

边距应用于某些特定的 LayoutParams 类，这些类[是 MarginLayoutParams](http://developer.android.com/reference/android/view/ViewGroup.MarginLayoutParams.html)的子类。确保在设置边距时使用特定的子类，例如，`RadioGroup.LayoutParams`而不是通用的 ViewGroup.LayoutParams *（当您的父布局是 a 时`RadioGroup`）*。然后你可以简单地使用[`MarginLayoutParams.setMargins()`](http://developer.android.com/reference/android/view/ViewGroup.MarginLayoutParams.html#setMargins%28int,%20int,%20int,%20int%29).

样本：

```
RadioGroup.LayoutParams params 
           = new RadioGroup.LayoutParams(context, null);
params.setMargins(10, 0, 10, 0);
currentButton.setLayoutParams(params); 
```

# java - 从 JBoss AS 7 上的类路径加载 URL 资源

> ID：10951849
> 
> 赞同：1
> 
> 时间：2012-06-08T15:34:34.167
> 
> 标签：java, url, classloader, jboss7.x

[从 Java 中的类路径加载资源的 URL](https://stackoverflow.com/questions/861500/url-to-load-resources-from-the-classpath-in-java)描述了如何使用 a`URLStreamHandler`来启用 url-paths，例如`new URL("classpath:org/my/package/resource.extension")`

我想在 JBoss AS 7 上使用相同的方法，但调用`java.net.URL.setURLStreamHandlerFactory(URL.java:1102)`结果 `java.lang.Error: factory already defined`

所以 AS 7 已经`URLStreamHandlerFactory`设置好了，这只能完成一次。

是否有其他方法可以为 jboss 上`URLStreamHandler`的前缀注册 a ，`classpath:`或者我什至可以使用`vfs`?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-25T18:47:44.977

很老的线程，但我得到了一些有用的答案。正如 JBoss 问题中的“David Lloyd”所言：

> 在 AS7 中，这只是使用包含协议处理程序工厂的模块名称调用 org.jboss.modules.Module#registerURLStreamHandlerFactoryModule() 并确保该模块具有 META-INF/services/java 的问题。 net.URLStreamHandler 文件。或者，您可以在 jboss.protocol.handler.modules 系统属性中指定模块名称，它的工作方式与 java.protocol.handler.pkgs 类似，只是它不接受来自应用程序类路径的包名称列表，而是接受一个列表来自引导模块加载器的模块名称。

完整的细节在这里：[https ://issues.jboss.org/browse/AS7-1562](https://issues.jboss.org/browse/AS7-1562)

好吧，就我而言，我只是将实现更改为使用 Spring 的 PathMatchingResourcePatternResolver：

```
ResourcePatternResolver patternResolver = new PathMatchingResourcePatternResolver();
  try {
    Resource [] mappingLocations = patternResolver.getResources("classpath*:" + myBaseXmlPath + "/**/*.xml");
    for(int i = 0; i < mappingLocations.length; i++) {
      // do whatever you want ...
      System.out.println(mappingLocations[i].getFile());
    }
  }
  catch(IOException e) {
    throw new RuntimeException(e);
  } 
```

它已经通过代理类加载器来处理“vfs”。

# security - Tomcat 安全约束 - 禁用 HTTPS Web 应用程序上的文件访问

> ID：10951850
> 
> 赞同：1
> 
> 时间：2012-06-08T15:34:44.547
> 
> 标签：security, tomcat, https, constraints

首先是背景——

1.  我在 Tomcat 中有一个正在运行的 JSF 1.1.14 Web 项目。

2.  Tomcat 在 HTTPS 上托管相同（SSL 已配置并运行良好）

为了实现上面的 2.，我们在 web-app 的 web.xml 中有以下配置 -

```
<!-- ======= TRANSPORT GUARANTEE CONSTRAINT Starts ======= -->
<security-constraint>
<web-resource-collection>
<web-resource-name>URL reserved for Acquisition application</web-resource-name>
<url-pattern>/*</url-pattern>
<http-method>POST</http-method>
<http-method>GET</http-method>
</web-resource-collection>
<user-data-constraint>
<transport-guarantee>CONFIDENTIAL</transport-guarantee>
</user-data-constraint>
</security-constraint>
<!-- ======= TRANSPORT GUARANTEE CONSTRAINT Ends ======== --> 
```

以上，我相信是 Tomcat 的行业标准方法。

问题是我们需要通过网络应用禁用 *.xhtml 访问，并继续对整个网络应用使用 HTTPS。

在理想的环境中，这很容易使用下面的代码片段来实现……再次在 web.xml 文件中 -

```
<!-- ======= Direct .xhtml access constraint - Starts ======= -->
<security-constraint>
<display-name>Restrict direct access to XHTML files</display-name>
<web-resource-collection>
<web-resource-name>XHTML files</web-resource-name>
<url-pattern>*.xhtml</url-pattern>
</web-resource-collection>
<auth-constraint />
</security-constraint>
<!-- ======= Direct .xhtml access constraint - Ends ======= --> 
```

问题是，即使在使用上述内容后，我也能够使用 web-app URL 查看 *.xhtml 文件的来源。

当 HTTPS 安全约束被移除时，情况就完美了。我的直觉是 HTTPS 安全约束压倒了文件访问约束。

我已经搜索了高低，但还没有找到任何与这两者一起工作的东西。

请帮助找到可以在 HTTPS Web 应用程序上禁用文件访问的方法。

谢谢。

丘拉纳

# iphone - 在 iPhone / iPad 上，如何在不使用图像的情况下制作带有凹槽的 Button？

> ID：10951853
> 
> 赞同：0
> 
> 时间：2012-06-08T15:34:56.253
> 
> 标签：iphone, ios, ipad, uikit, uibutton

iPhone/iPad 上的一些 Apple 应用程序喜欢使用***带有凹槽的 UIButton***。

一个例子是：

![在此处输入图像描述](../Images/549ce5eb9b94da7179cd04b37080f6e5.png)

***请注意，按钮周围有一个“凹槽”***。是否有内置方法可以在不使用图像的情况下为 UIButton 添加它们？如果没有，那么有什么好的方法可以做到呢？现在我正在考虑向按钮层添加 3 个 CALayer 层，（1）一个具有深灰色（顶部）到浅灰色（底部）渐变作为最低级别层，（2）一个黑色和较小的覆盖层1，和（3）颜色渐变层。这是其中一个按钮的更大版本：

![在此处输入图像描述](../Images/33b7ed9684081b60bba2721d51b9cf00.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:34:10.383

尝试在 UIView 中设置您的 UIButton。设置按钮的边框宽度和边框颜色以匹配黑色轮廓。

使按钮在视图中居中，然后使视图略大于带有灰色背景的按钮。

最后，设置：

```
view.layer.cornerRadius = {the button's corner radius};
view.layer.masksToBounds = YES; 
```

我没有对此进行测试，但似乎它应该可以在不过多弄乱图层的情况下工作。

编辑：确保#import < QuartzCore /QuartzCore。>

# ruby-on-rails - 如何构建合适的 form_tag

> ID：10951863
> 
> 赞同：0
> 
> 时间：2012-06-08T15:35:30.583
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我想构建一个 form_tag，允许我向客户发布新便条。我的 rake 路线如下所示：

```
[hchq (master)]$ rake routes
    user_notes GET    /users/:user_id/notes(.:format)          notes#index
               POST   /users/:user_id/notes(.:format)          notes#create
 new_user_note GET    /users/:user_id/notes/new(.:format)      notes#new
edit_user_note GET    /users/:user_id/notes/:id/edit(.:format) notes#edit
     user_note GET    /users/:user_id/notes/:id(.:format)      notes#show
               PUT    /users/:user_id/notes/:id(.:format)      notes#update
               DELETE /users/:user_id/notes/:id(.:format)      notes#destroy
         users GET    /users(.:format)                         users#index
               POST   /users(.:format)                         users#create
      new_user GET    /users/new(.:format)                     users#new
     edit_user GET    /users/:id/edit(.:format)                users#edit
          user GET    /users/:id(.:format)                     users#show
               PUT    /users/:id(.:format)                     users#update
               DELETE /users/:id(.:format)                     users#destroy
      sessions POST   /sessions(.:format)                      sessions#create
   new_session GET    /sessions/new(.:format)                  sessions#new
       session DELETE /sessions/:id(.:format)                  sessions#destroy
       clients GET    /clients(.:format)                       clients#index
               POST   /clients(.:format)                       clients#create
    new_client GET    /clients/new(.:format)                   clients#new
   edit_client GET    /clients/:id/edit(.:format)              clients#edit
        client GET    /clients/:id(.:format)                   clients#show
               PUT    /clients/:id(.:format)                   clients#update
               DELETE /clients/:id(.:format)                   clients#destroy
          root        /                                        clients#index
        signup        /signup(.:format)                        users#new
        signin        /signin(.:format)                        sessions#new
       signout DELETE /signout(.:format)                       sessions#destroy 
```

我可以只发布到笔记上的创建操作，还是需要获取 new_user_note_path？为什么？我在控制器中有一个 @client 实例变量。

这是我目前拥有的：

```
<%= form_tag(new_user_note_path, method: :get) do |f| %>
    <%= render 'shared/error_messages', object: f.object %> 
    <div class="field">
        <%= f.text_area :content, placeholder: "Compose new note" %> 
    </div>
<%= f.submit "New Note"%> 
<% end %> 
```

这让我遇到了这个错误：

![在此处输入图像描述](../Images/91efbf4d1f44ee4802576799a8302fdf.png)

我认为需要发生的是我需要构建一个 form_tag 来点击控制器的 create 或 new_user_note 操作。我认为它需要点击 new_user_note，现在我考虑更多以便它可以设置客户端 ID。它是否正确？

如果是这样，我该如何构建我的 form_tag？我需要传递带有 client_id 的隐藏字段吗？

另外，关于 new 和 create 操作，我的笔记控制器应该是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:39:59.980

1.  由于 user 是一种资源，因此您应该`:post`to `users_notes_path`，这将由 处理`notes#create`，因为它意味着资源
2.  同样，既然 user 是一种资源，为什么不是 user `form_for`？（或 simpleform/formtastic/whated 适合你）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T20:05:59.720

您的用户资源是否映射到用户模型？如果是这样，那么 form_for 是你最好的选择。使用 form_for 时传入实例变量

`<%= form_for @user do |f| %>`

# javascript - 指针事件：无 VML raphael 解决方案

> ID：10951868
> 
> 赞同：5
> 
> 时间：2012-06-08T15:35:57.007
> 
> 标签：javascript, svg, raphael

我已经`pointer-events: none`使用 jQuery 在 Raphael 元素上实现了，如下所示：

```
var raphaelElement = Raphael.ellipse(x,y,w,h);
$(raphaelElement.node).css({'pointer-events': 'none'}); 
```

这工作正常，但当然在 IE8 中，Raphael 使用 VML 而不是 SVG，这个解决方案失败了。

有没有人有另一种解决方案来让 Raphael 元素忽略事件。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T17:57:18.333

使 IE8（及更早版本）工作的唯一方法是实际捕获事件，并在事件处理程序中：

2.  隐藏元素 ( `.style.display='none'`)
3.  使用[`elementFromPoint()`](http://msdn.microsoft.com/en-us/library/ie/ms536417.aspx) 方法找到'catcher'下面的下一个元素
4.  [在该元素上重新创建并触发事件](https://stackoverflow.com/questions/5839281/is-there-a-built-in-way-to-make-custom-events-in-javascript-natively)（另请参见[this](https://stackoverflow.com/questions/8423800/how-to-invoke-the-mouseenter-event-programmatically-via-jquery)）
5.  再次展示捕手（`.style.display=''`）

这种通用方法（减去第 3 步）已在 IE 上使用了 10 多年，以允许用户直接在光标下拖动元素，同时仍检测下方可能放置目标元素的“鼠标悬停”。

# asp.net - ASP.NET 项目仍然引用旧项目名称

> ID：10951869
> 
> 赞同：-1
> 
> 时间：2012-06-08T15:36:00.117
> 
> 标签：asp.net, vb.net

所以我有这个我重命名的asp.net web 应用程序。我更改了程序集名称、根命名空间、更改了所有 aspx 文件继承行以具有新名称。但由于某种原因，它仍然引用旧的程序集名称。所以主页加载，但有一个按钮提交给 pgRequest.aspx，我在事件查看器中收到此错误。

跟进：所以我重新创建了解决方案、项目并为所有表单添加了现有项目。我仍然得到这个问题。

这是从 pgMain.aspx 提交的代码

```
 <form id="frmNew" name="frmNew" action="pgRequest.aspx" method="post" target="_blank">
            <input type="hidden" value="frmNew" name="hdnSource"><button id="cmdNewSubmit" name="cmdNewSubmit" type="submit" value="NEW"><IMG alt="Open Form" src="images/new.gif"><span class="button_message">Open New Form</span></button>
        </form> 
```

这是来自事件查看器的错误消息。

```
Could not load type 'Old_Name.pgRequest'.
--------------------
Could not load type 'Old_Name.pgRequest'.
Stack Trace:
   at System.Web.UI.TemplateParser.ParseString(String text, VirtualPath virtualPath, Encoding fileEncoding)
   at System.Web.UI.TemplateParser.ParseReader(StreamReader reader, VirtualPath virtualPath)
   at System.Web.UI.TemplateParser.ParseFile(String physicalPath, VirtualPath virtualPath)
   at System.Web.UI.TemplateParser.ParseInternal()
   at System.Web.UI.TemplateParser.Parse()
   at System.Web.UI.TemplateParser.Parse(ICollection referencedAssemblies, VirtualPath virtualPath)
   at System.Web.Compilation.BaseTemplateBuildProvider.get_CodeCompilerType()
   at System.Web.Compilation.BuildProvider.GetCompilerTypeFromBuildProvider(BuildProvider buildProvider)
   at System.Web.Compilation.BuildProvidersCompiler.ProcessBuildProviders()
   at System.Web.Compilation.BuildProvidersCompiler.PerformBuild()
   at System.Web.Compilation.BuildManager.CompileWebFile(VirtualPath virtualPath)
   at System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile)
   at System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile)
   at System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean noAssert)
   at System.Web.Compilation.BuildManager.CreateInstanceFromVirtualPath(VirtualPath virtualPath, Type requiredBaseType, HttpContext context, Boolean allowCrossApp, Boolean noAssert)
   at System.Web.UI.PageHandlerFactory.GetHandlerHelper(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath)
   at System.Web.UI.PageHandlerFactory.System.Web.IHttpHandlerFactory2.GetHandler(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath)
   at System.Web.HttpApplication.MapHttpHandler(HttpContext context, String requestType, VirtualPath path, String pathTranslated, Boolean useAppConfig)
   at System.Web.HttpApplication.MapHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)
--------------------
Could not load type 'Old_Name.pgRequest'.
Stack Trace:
   at System.Web.UI.TemplateParser.ProcessException(Exception ex)
   at System.Web.UI.TemplateParser.ParseStringInternal(String text, Encoding fileEncoding)
   at System.Web.UI.TemplateParser.ParseString(String text, VirtualPath virtualPath, Encoding fileEncoding)
--------------------
Could not load type 'Old_Name.pgRequest'.
Stack Trace:
   at System.Web.UI.TemplateParser.GetType(String typeName, Boolean ignoreCase, Boolean throwOnError)
   at System.Web.UI.TemplateParser.ProcessInheritsAttribute(String baseTypeName, String codeFileBaseTypeName, String src, Assembly assembly)
   at System.Web.UI.TemplateParser.PostProcessMainDirectiveAttributes(IDictionary parseData)

For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:33:15.567

发现了问题。虽然我在开发源代码中更改了 page 指令的 Inherits 行，但在我正在测试的已部署版本上并没有更改。部署更正的 aspx 文件解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:03:54.593

您必须更改每个资源文件中的所有名称。尝试使用 CTRL+F 并输入确切的名称，然后选中它下面的所有框并在整个项目中搜索。那应该这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-20T09:54:35.123

我刚刚删除了 Microsoft ASP.net 临时文件，它确实有效。路径：C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files

您检查您正在使用的版本并重置 IIS。

# c++ - VS2010中的C99：uint8_t*非法使用类型

> ID：10951876
> 
> 赞同：2
> 
> 时间：2012-06-08T15:36:31.200
> 
> 标签：c++, visual-studio-2010, visual-c++, c99

我正在使用 VC2010，试图为 Linux 编译一些用 C99 编写的库。以下行给出错误 C2275：'uint8_t'：非法使用此类型作为表达式

```
uint8_t * G = (uint8_t*)calloc(N ,sizeof(uint8_t)); 
```

subhint: stdint.h(21) : 见 'uint8_t' 的声明，那一行是：

```
typedef unsigned char uint8_t; 
```

然后是累积的问题：错误C2065：'G'：未声明的标识符等。这里有什么非法的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T15:36:33.260

已经回答了一个类似的问题： [错误 C2275：非法使用此类型作为表达式](https://stackoverflow.com/questions/9903582/error-c2275-illegal-use-of-this-type-as-an-expression)

**答：** 当您将源文件命名为 *.c 时，MSVC 假定它正在编译 C，即 C89。所有函数局部变量都需要在函数的开头声明。

解决方法包括： - 在函数开头声明/初始化所有局部变量 - 将源文件重命名为 *.cpp 或等效文件并编译为 C++。

# c++ - 使用什么架构来暗示一个类中的两种行为？

> ID：10951877
> 
> 赞同：1
> 
> 时间：2012-06-08T15:36:31.193
> 
> 标签：c++, architecture

我正在尝试创建一个同时代表两种不同行为的类。如下所示：

```
class IMouse {
public:
    virtual void Walk() const = 0;
};

class TSimpleMouse : public IMouse {
public:
    void Walk() const;
};

class IBat {
public:
    virtual void Fly() const = 0;
};

class TSimpleBat : public IBat {
public:
    void Fly() const;
};

template <class TMouse, class TBat>
class TSuperCreatureImpl {
public:
    void Do() const {
        Walk();
        Fly();
    }
};

typedef TSuperCreatureImpl<TSimpleMouse, TSimpleBat> TSimpleSuperCreature; 
```

这对我来说很重要，因为我想做不同的 typedefs。这似乎很简单。

但我也希望 Fly 和 Walk 方法具有参数（例如速度）。我应该如何修改架构以便有机会为不同的生物使用许多 typedef？

如果没有 Mouse 和 Bat 的默认构造函数，如何更改架构？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:48:34.770

```
template <class TMouse, class TBat>
class TSuperCreature : public TMouse, public TBat
{
  public:
    void do() const {
        this->walk();
        this->fly();
    }
}; 
```

> 但我也希望 Fly 和 Walk 方法具有参数（例如速度）。我应该如何修改架构以便有机会为不同的生物使用许多 typedef？非常感谢。

您可以为函数提供默认参数...

```
virtual void Walk(double meters_per_second = 1.1) const = 0; 
```

编辑

> （来自下面的评论）假设我们需要 2 个生物：第一个走得快，飞得慢，第二个正好相反。这意味着我们必须编写 2 个 typedef。但我不知道如何在这里使用速度常数。架构的哪些部分必须有参数？

一种选择是执行以下操作：

```
template <class TMouse, class TBat, int walk_speed, int fly_speed>
class TSuperCreature : public TMouse, public TBat
{
  public:
    void do() const {
        this->walk(walk_speed);
        this->fly(fly_speed);
    }
}; 
```

如果您想使用`double`s，则不允许它们作为模板参数（至少在 C++03 中不允许），但作为一种技巧，您可以接受一对数字并将它们划分在模板中，或者更准确地说，您可以提供政策课……

```
template <class TMouse, class TBat, class Speeds>
class TSuperCreature : public TMouse, public TBat
{
  public:
    void do() const {
        this->walk(Speeds::walk_speed);
        this->fly(Speeds::fly_speed);
    }
};

struct Speeds__Fly_Fast__Walk_Slow   // yes I know double underscores are reserved - I don't care!
{
    static const double walk_speed = 0.5; // m/s
    static const double fly_speed = 10;
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:51:34.590

为什么不简化。

有一个以移动方法为参数的移动接口；

```
enum MovementMethod { Walk, Fly, Swim };

class MoveInterface
{
    public:
        virtual void move(MovementMethod method) = 0;
};
// TMouse/TBat inheret from the MoveInterface

template <class TMouse, class TBat>
class TSuperCreatureImpl : public TMouse, public TBat
{
    public:
        virtual void move(MovementMethod /*method*/) 
        {
            TMouse::move(Walk);
            TBat::move(Fly);
        }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T15:54:05.533

如果您一次只需要一种特殊行为，我会应用策略模式。然后，您的 Do-Method 可以调用当前策略，即 walk 或 fly。您可以拥有一个 CurrentBehaviour，在需要时选择它。

此外，我会想到一个装饰器，在需要时简单地添加所需的行为。即，当您需要超级生物时，您有一系列行为并添加鼠标和蝙蝠。当需要一个也可以吠叫的超级生物时，只需添加一个狗行为。

# colors - 像框体文本颜色

> ID：10951886
> 
> 赞同：1
> 
> 时间：2012-06-08T15:37:03.387
> 
> 标签：colors, facebook-social-plugins, facebook-likebox

使用“深色”配色方案，我无法让我喜欢的框流的实际文本以白色显示。

标题和所有链接等看起来不错，但帖子的主体是黑色或深灰色，因此几乎无法阅读。

```
 <div style="background-color:#000000;" class="fb-like-box" 

data-href="http://www.facebook.com/wecouldbeastronauts" data-width="260" data-height="250" data-colorscheme="dark" 

data-show-faces="false" data-border-color="#000000" data-stream="true" data-header="false"></div> 
```

是我的代码。我再次访问了 facebook 开发网站以重新制作它，认为我一定是弄错了，但这也有同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T14:00:23.457

无法更改社交插件中内容的颜色，因此您别无选择，只能坚持 Facebook 提供的原始配色方案`light`和`dark`.

在彩色（又名）`dark`故事的方案文本中，应该在黑色背景上完美地看到（好吧，对于那些喜欢深色背景的人来说）......`grey``#999`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T19:54:41.867

好吧，无论我选择“浅色”还是“深色”，评论插件都会将文本显示为超深灰色。两者看起来像这样：

[http://scrubclubrecords.com/example.jpg](http://scrubclubrecords.com/example.jpg)

有没有一个地方我们可以编辑默认的“light”和“dark” css 以某种方式提取？

# java - Android Java 如何在活动中连接 IP 摄像机

> ID：10951891
> 
> 赞同：1
> 
> 时间：2012-06-08T15:37:22.837
> 
> 标签：java, android, android-activity, connection, ip-camera

我正在寻找任何提示或指导来开发像 cam viewer 这样的应用程序。所以我将通过使用 IP 地址和端口在我的 android 应用程序上看到实时视频。

我搜索了这个问题，但在任何地方都找不到正确的答案，所以请在这方面帮助我。我需要创建一个具有此功能的 android 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T15:42:59.727

我对此进行了一些研究，我认为大多数应用程序都是专门针对相机型号编写的。IP 摄像头似乎没有任何标准。

我将为每个相机型号配备一个适配器。通过查看相机的 Web 服务器创建的网页，调查特定型号以找到视频的 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T17:23:38.933

许多 IP 摄像头提供对“视频”的访问，因为图像（通常为 jpg 格式）其他允许您访问字节流，其他则有这两种选择。有一些提供 sdk 的摄像头，因此您可以访问视频并通过 http 调用远程控制它们。正如@Steve H. 建议的那样，为每个模型创建一个适配器是个好主意。如果 cam 允许您以图像序列的形式访问视频，那么您可以读取图像并使用 ImageView 显示它们，并每*n*毫秒更新一次。

# ruby - Ruby：在倒排索引中搜索部分匹配

> ID：10951892
> 
> 赞同：1
> 
> 时间：2012-06-08T15:37:23.597
> 
> 标签：ruby, full-text-search

我需要在倒排索引中搜索部分匹配，以下代码适用于完全匹配但不适用于部分匹配。从[http://rosettacode.org/wiki/Inverted_Index](http://rosettacode.org/wiki/Inverted_Index)的示例中重新设计了这个（在 Ruby1.9.3 中不再适用）

请问如何做到这一点最有效？请不要建议使用 Lucene、Sphinx 等，除非您知道一个轻量级、简单和纯 Ruby 解决方案，并且想自己做。

```
@data = {"contents"=>["1.txt", "2.txt"], "of"=>["1.txt", "2.txt"], "file"=>["1.txt", "2.txt"], "one"=>["1.txt"], "two"=>["2.txt"]}

def search words
  result = []
  words.each do |word|
    result << @data[word] if @data[word] #should do a partial match
  end
  result
end

p search ['of'] #=> [["1.txt", "2.txt"]]
p search ['one'] #=> [["1.txt"]]
p search ['on']  #=> []                    <<should become [["1.txt"]] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:00:03.450

定义`search`如下：

```
def search words
  words.map do |word|
    matches = @data.keys.select {|key| key.include?(word)}
    matches.map {|match| @data[match] }
  end      
end

p search ['of'] #=> [[["1.txt", "2.txt"]]]
p search ['one'] #=> [[["1.txt"]]]
p search ['on']  #=> [[["1.txt", "2.txt"], ["1.txt"]]] - note that "contents" contains "on" 
```

# javascript - 为什么 ("foo" === new String("foo")) 在 JavaScript 中评估为 false？

> ID：10951906
> 
> 赞同：100
> 
> 时间：2012-06-08T15:38:05.607
> 
> 标签：javascript, object, equality

我打算在比较字符串值时一直使用 === （三等号，严格比较），但现在我发现

```
"foo" === new String("foo") 
```

是错误的，与此相同：

```
var f = "foo", g = new String("foo");
f === g; // false 
```

当然：

```
f == g; // true 
```

那么是否建议始终使用 == 进行字符串比较，或者始终在比较之前将变量转换为字符串？

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2012-06-08T15:39:56.050

`"foo"`是一个字符串*原语*。（这个概念在 C# 或 Java 中不存在）

`new String("foo")`是装箱的字符串对象。

`===`运算符[对原语和对象的行为](http://ecma-international.org/ecma-262/5.1/#sec-11.9.6)不同。
比较原语（相同类型）时，`===`如果它们都具有相同的值，则返回 true。

比较对象时，`===`仅当它们引用同一个对象时才会返回 true（通过引用进行比较）。因此，`new String("a") !== new String("a")`.

在您的情况下，`===`返回 false 因为操作数属于不同类型（一个是原始类型，另一个是对象）。

* * *

基元根本不是对象。运算符不会返回
原语。`typeof``"object"`

当您尝试访问原始属性（将其用作对象）时，Javascript 语言会将其装箱到对象中，每次都会创建一个新对象。这在[规范](http://ecma-international.org/ecma-262/5.1/#sec-8.7.1)中有所描述。

这就是为什么不能将属性放在原语上的原因：

```
var x = "a";
x.property = 2;
alert(x.property) //undefined 
```

每次编写时`x.property`，都会创建一个*不同*的盒装`String`对象。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-06-08T15:40:26.397

使用`===`,

*   一个对象永远不等于任何东西，除了另一个对自身的引用。

*   如果它们的类型和值相同，则一个基元与另一个基元相比是相等的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-08T15:51:26.120

这个`new`词在这里是一个罪犯（*像往常一样*，我可以说）......

当你使用时，你明确地表达了你使用*对象*`new`的愿望。这可能会让您感到惊讶，但这是：

 *```
var x = new String('foo');
var y = new String('foo');
x === y; 
```

...会给你一个强大的`false`。很简单：比较的不是对象的内部，而是对象的引用。当然，它们是不相等的，因为创建了两个不同的对象。

您可能想要使用的是*转换*：

```
var x = String('foo');
var y = String('foo');
x === y; 
```

......正如预期的那样，这将给你带来结果，所以你可以永远`true`与你的平等者一起欢欣和繁荣。`foos`)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-08T15:40:24.977

`foo`是纯字符串并且`new String("foo")`是对象字符串

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-08T18:47:56.257

从 node.js REPL（如果安装了命令行上的“节点”）：

```
> "foo" === (new String("foo")).valueOf()
true
> "foo" === new String("foo")
false
> typeof("foo")
'string'
> typeof(new String("foo"))
'object'
> typeof((new String("foo")).valueOf())
'string'
```*

# sql - TSQL“FOR BROWSE”选项有什么用？

> ID：10951907
> 
> 赞同：12
> 
> 时间：2012-06-08T15:38:12.243
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我正在处理一个查询，并且在选择语句的 TSQL“FOR BROWSE”选项上找到了 Microsoft 提供的最少文档。

我已经看到 FOR BROWSE 记录为游标的一个选项，但是我找不到任何使用它的好例子，或者在 SELECT 语句上使用 FOR BROWSE 的原因。

在 TSQL SELECT 语句中使用 FOR BROWSE 的充分理由是什么？

我正在使用 SQL Server 2008 和 2012。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-11T03:03:23.880

据我所知。它似乎是一个用于在应用程序中实现[乐观并发控制](http://en.wikipedia.org/wiki/Optimistic_concurrency_control)的接口，其中一个或多个用户将同时访问和更新来自同一源的数据。它似乎还可以与兼容的前端库 ( [DB-Library](http://msdn.microsoft.com/en-us/library/aa936940%28v=sql.80%29.aspx) ) 结合使用。但是，这似乎是一种有些过时的机制，因为您可以在不使用“ [For Browse](http://msdn.microsoft.com/en-us/library/aa936959%28v=sql.80%29.aspx) ”语句的情况下实现上述所有功能。这可以通过创建两个 DBPROCESS 结构来进一步证实，这两个结构是 DB-Library（不推荐使用的 C 库）调用“ [dbopen](http://msdn.microsoft.com/en-us/library/aa937054%28v=sql.80%29.aspx) ”的结果。

> 此外，浏览模式需要两种 DBPROCESS 结构：一种用于选择数据，另一种用于根据选择的数据进行更新。[源代码](http://msdn.microsoft.com/en-us/library/aa936959%28v=sql.80%29.aspx)

下面是结合 DB-Library 使用“For Browse”查询[的示例。](http://manuals.sybase.com/onlinebooks/group-cnarc/cng1110e/dblib/@Generic__BookTextView/28874;pt=39614)

最终，可以合理地得出结论，为了向后兼容，这种机制仍然存在。因此，除非您使用 DB-Library 维护基于 C 的客户端，否则我不会太担心这个 sql“ [for 子句](http://msdn.microsoft.com/en-us/library/ms173812.aspx)”。

**其他一些来源**

*   [SQL Server 参考手册 - 浏览模式](http://manuals.sybase.com/onlinebooks/group-asarc/srg1100e/sqlref/@Generic__BookTextView/60782;pt=61017)
*   [有关 FOR BROWSE 选项的附加信息](http://support.microsoft.com/kb/885146)
*   [使用浏览模式而不是光标](http://manuals.sybase.com/onlinebooks/group-as/asg1250e/sqlug/@Generic__BookTextView/51945;pt=52136)

**再观察**

> 用 FOR BROWSE 声明的游标必须仅在 OPEN CURSOR 操作期间等待未提交的更改（由任何人，包括游标所有者进行）。游标打开后，后续更改不会导致游标等待。当游标重新打开时，它可能会被未提交的更改阻止。[源代码](http://www.sql-server-performance.com/forum/threads/for-browse.1637/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-15T08:21:15.697

可能需要将 FOR BROWSE 附加到 SQL SELECT 语句或在 SQL Server 连接上使用 SET NO_BROWSETABLE ON 来检索更详细的架构信息。

如果应用程序通过 ODBC 层与 SQL Server 直接或间接交互，这可能很有用，因为 ODBC 函数[SQLColAttribute](https://technet.microsoft.com/en-us/library/aa177861%28v=sql.80%29.aspx)返回的某些详细信息将返回空字符串，除非 SQL SELECT 附加了 FOR BROWSE。

For example, if your C++ app uses [libodbc++](http://libodbcxx.sourceforge.net/libodbc++/progref/) and you get a result set from the query SELECT * FROM A, B you will not be able to retrieve the table names of the columns from the ResultSetMetaData object. However, if you add FOR BROWSE, the table names will be populated corretly.

# api - socketio 视频流

> ID：10951914
> 
> 赞同：1
> 
> 时间：2012-06-08T15:38:39.153
> 
> 标签：api, node.js, webkit, socket.io

目前，我在本地机器上开发了一个 node.js 和 socket.io 应用程序，以测试一些新的 Web 技术和 API。

目前我有一个用户能够登录到我的应用程序并在页面上以 html5 视频元素显示他们的网络摄像头流。现在该元素的来源是这样的：

```
<video id="self" autoplay="" style="display: inline; " src="blob:http%3A//192.168.1.20%3A1234/29768571-e561-4b28-9ebe-bf53d2ee13ad"></video> 
```

我已启用加入应用程序请求的其他用户查看他们的流，因此我将**blob:http%3A//192.168.1.20%3A1234/29768571-e561-4b28-9ebe-bf53d2ee13ad**部分传递给他们流用户。现在在我的本地网络上进行测试，第二个用户在 blob 上收到 404 错误。有什么我想念的吗？socket.io 也将能够保持该流不断流式传输吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:44:49.153

您不能将 BLOB 的地址传递给其他客户端，您拥有的地址特定于该页面。您应该发送视频的内容，而不是地址。

# javascript - Node.js MYSQL 来检测查询的插入/更新完整性？

> ID：10951916
> 
> 赞同：1
> 
> 时间：2012-06-08T15:38:48.910
> 
> 标签：javascript, jquery, mysql, node.js, asynchronous

我正在使用[来自 Node.js 的 Javascript MySQL 库](https://github.com/felixge/node-mysql)。这很棒，但我无法检测到 INSERT/UPDATE 查询过程的完整性（或）结束。我如何检测它？

例如：

```
function start_query() {
    conn.query(
        'INSERT .....',
        function(err, rows, fields) {
            if (err) {
                console.log("Err!");
            } else {
                console.log("INSERTED!");
            }
        }
    );
}
start_query();
console.log("QUERY DONE!"); 
```

当我运行它时，它返回：

```
QUERY DONE!
INSERTED! 
```

该过程正在反向返回，我没有检测到查询的 END POINT。
我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T15:41:48.870

Node.js 以异步方式完成所有不受 CPU 限制的事情——例如文件操作、网络/数据库访问——这是保持它尽可能快的必要条件。

**因此，您需要在回调函数**中完成查询后做任何应该发生的事情：

```
function start_query(callback) {
    conn.query('INSERT .....', function(err, rows, fields) {
        if(err) {
            console.log("Err!");
        } else {
            console.log("INSERTED!");
        }
        callback();
    });
}
start_query(function() {
    console.log("QUERY DONE!");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:42:06.720

`query`是一个异步函数。`function(err,rows,fields)`仅在查询完成时调用。它是一个回调函数，由于它的事件 I/O，它在 NodeJS 环境中被广泛使用。您将函数注册到事件，当它们完成时，它们会被回调。

# tsql - 在触发器内记录

> ID：10951921
> 
> 赞同：3
> 
> 时间：2012-06-08T15:39:11.480
> 
> 标签：tsql, triggers, sql-server-2000

我正在尝试编写 SQL Server 2000 触发器。

对于每个插入语句，我想将插入的值记录到日志表中，然后进行一些处理。处理失败时如何防止日志记录被回滚？

那似乎我需要一个**内部自治**事务来将日志记录在其中。在 SQL Server 2000 上使用 T-SQL 是否可行？

我希望实现不会造成太多开销。或者如果处理失败，我该如何优雅地管理它并且不让它回滚原始插入。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:02:21.553

我强烈建议**不要**在触发器中进行任何类型的处理。

您无法控制触发触发器的时间和频率 - 因此，请确保您的触发器非常精简 - 最多将一行（或几行）插入“审核”或“要处理的作业”表中，作为“标记”以供以后处理。但实际上不要在触发器中开始/执行处理。

单独处理实际处理，例如使用 SQL 代理作业或其他东西。由于这将独立于您的原始语句运行，因此“嵌套”事务和类似的东西也不会有任何问题。

# matlab - 在图像 Matlab 中隐藏文本

> ID：10951924
> 
> 赞同：0
> 
> 时间：2012-06-08T15:39:33.183
> 
> 标签：matlab, steganography

我已经设法使用这种简单的方法将一个图像隐藏到另一个图像中。

```
Cover = imread('qw.jpg', 'jpg');
Hidden = imread('qwe.jpg', 'jpg');
n = 1; % Number of bits to replace

Processed = uint8(bitor(bitand(Cover, bitcmp(2^n - 1, 8)) , bitshift(Hidden, n - 8)));
Hidden = uint8(bitand(255, bitshift(Processed, 8 - n)));

figure, imshow(Processed)
figure, imshow(Hidden) 
```

我想在封面图片中存储文本，我已经尝试过

```
dec2bin(text,8) 
```

将文本转换为二进制，但我无法继续进行，即如何存储的输出

```
de2bin() 
```

在封面的lsb中一点一点。谁能帮忙？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T08:47:03.890

您可以像这样编写 dec2bin() 语句

例如

```
 c=dec2bin(text,8); 
```

c 持有 char 数组试试这个但不要将文本直接转换为二进制首先将它们转换为 uint8 格式然后使用 dec2bin() 语句

# ios5 - iOS MKMapKit init 的位置不是用户位置

> ID：10951925
> 
> 赞同：1
> 
> 时间：2012-06-08T15:39:36.977
> 
> 标签：ios5, mkmapview

我知道这可能很简单，但我似乎无法通过互联网找到任何东西：

我要做的就是加载带有一些纬度和经度坐标的地图。如果有人可以删除片段或将我链接到我将不胜感激的资源。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:51:46.260

我希望这有帮助：

```
 CLLocationCoordinate2D zoomLocation;
    float zoom;

    CLLocationCoordinate2D longPointLightLocation;
    //the coords for Long Point Lighthouse, Provincetown, MA
    longPointLightLocation.latitude = 42.033126;
    longPointLightLocation.longitude = -70.168621;
    [mapView setCenterCoordinate:longPointLightLocation animated:NO];
    zoomLocation = longPointLightLocation;
    zoom = 50;

    MKCoordinateRegion viewRegion = MKCoordinateRegionMakeWithDistance(zoomLocation, zoom*METERS_PER_MILE, zoom*METERS_PER_MILE);
    [mapView setRegion:[mapView regionThatFits:viewRegion] animated:NO]; 
```

# algorithm - 相同的 BST

> ID：10951927
> 
> 赞同：2
> 
> 时间：2012-06-08T15:39:43.223
> 
> 标签：algorithm, data-structures, computer-science

如果两棵树包含相同的元素集但可能具有不同的结构，则称它们是相同的。例如 4,3,5 和 5,4,3

如何检查两棵树是否相同？

我能想到的一种方法是使用散列。对于第一棵树中的每个元素，相应的计数都会增加。对于第二棵树中的每个元素，计数都会递减。最后，哈希为空，我们确定树是相同的。时间复杂度：O(N) 空间复杂度：O(N)

但是，这种方法没有利用树是 BST 还是简单的二叉树。

方法2：对数组中的两棵树进行中序遍历。我们有两个具有排序数据的数组。进行线性搜索以检查数组是否相同。时间复杂度：O(N) 空间复杂度：O(N)

但是，我想知道是否存在更好的解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-08T20:00:07.917

*这回答了最初措辞的问题，即在相同结构和元素的意义上树的**身份之后。***

比较按顺序（或任何其他）顺序将不起作用：不同的树具有相同的遍历。例如，树木

![在此处输入图像描述](../Images/72ba2d60f1383bd1033ad06aa5571f5c.png)
^([[来源](https://github.com/akerbos/sesketches/blob/gh-pages/src/so_10951927.tikz)])

有相同的中序遍历`a,b,c,d,e`。您可以使用[*两个*（不同的）遍历](https://cs.stackexchange.com/q/439/98)并分别检查它们是否相同。

然而，经典的解决方案是递归算法：

```
 equal Leaf(x)       Leaf(y)       => x == y
| equal Node(x,l1,r1) Node(y,l2,r2) => x == y && equal(l1,l2) && equal(r1,r2)
| equal _             _             => false; 
```

它同时在两棵树上执行树遍历，并花费时间 Θ(n)，n 是各自节点数的最大值。

* * *

关于更新的问题，检查按元素相等的顺序遍历就足够了。请注意，根据定义，BST 的中序遍历是存储元素的排序列表，因此这种方法是正确的。以递归形式，这是算法：

```
 inorder Leaf(x)     = [x]
| inorder Node(x,l,r) = (inorder l) ++ [x] ++ (inorder r);

  equal []     []     = true
| equal x1::r1 x2::r2 = x1 == x2 && (equal r1 r2)
| equal _      _      = false;

  sameElems t1 t2 = let 
                      e1 = inorder t1
                      e2 = inorder t2
                    in
                      equal e1 e2
                    end; 
```

如果列表连接可以在时间 O(1) 内完成，则在时间 Θ(n) 和空间 Θ(n) 中运行；迭代解决方案当然同样好，并且可能具有更好的常数。

如果您想在 o(n) 时间内执行此检查，您甚至无法查看每个元素。一般来说，两棵树都包含成对的不同元素，因此您不能利用任何范围，因此我每个一般的元素相等检查都需要时间 Ω(n)（假设一个更快的算法并构造两棵它失败的树）。

不过，空间可以做得比 O(n) 更好。如果您[巧妙地](http://www.geeksforgeeks.org/archives/6358)按顺序实现¹，您只需要 O(1) 额外空间（指向当前元素的指针，一些管理计数器/标志）。

* * *

1.  请注意，此算法会暂时破坏树，因此不适合并发设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:50:15.387

散列的问题是，如果你有两个二叉搜索树，`{2, 1, 3}`并且`{0, 0, 6}`它们可以有相同的总散列码，你仍然有不同的元素。

顺序遍历方法可能是最有效的方法，而且我怀疑这`O(n)`是您可以得到的最好的方法`n`，因为您需要进行相等比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:52:30.433

您的后一种解决方案似乎比您的前一种更好，因为后者的最坏情况时间是 O(N)，最好的情况（有序遍历中的第一个元素不同）将是 Ω(1)，而对于前者的最佳情况时间仍然是 Ω(N)，因为您必须等到最后才能确定。

但是，作为对后者的优化，您不能只使用指向每棵树中当前元素的指针而不是复制所有数据吗？用于按顺序遍历树的算法（至少具有自然排序）不需要制作任何数据副本。这样你的空间复杂度将是 O(1)。

# google-app-engine - 什么时候不应该使用 App Engine 的全文搜索 API？

> ID：10951936
> 
> 赞同：20
> 
> 时间：2012-06-08T15:40:04.673
> 
> 标签：google-app-engine, full-text-search

到目前为止，我已经使用 App Engine 的全文搜索来帮助搜索数据存储区中的现有实体。这涉及为每个实体创建至少一个`Document`，并以某种方式将两者联系在一起。而且每次更改实体时，都必须更改对应的`Documents`.

我的问题是，为什么不把我的所有数据都存储进去`Documents`，然后忘记 Datastore 实体呢？与数据存储区不同，搜索 API 支持更丰富的[查询语言](https://developers.google.com/appengine/docs/python/search/overview#Query_Language_Overview)，可以处理多个不等式过滤器和布尔运算符。

我是否遗漏了有关搜索 API 设计的某些内容，这些内容会妨碍使用它来完全替换数据存储区？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-20T17:37:23.027

根据[Java文档](https://developers.google.com/appengine/docs/java/search/)

> 但是，索引搜索最多只能找到 10,000 个匹配文档。App Engine 数据存储区可能更适合需要检索非常大的结果集的应用程序。

虽然我不认为这是一个常见的用例。

更现实的是，使用 Datastore 按键获取实体会便宜很多（大概也更快）。使用搜索 API，您可以使用 Index.get() 按 ID 查找文档，或者通过将 ID 存储在字段中并在该字段上搜索来复制 ID。

以下是费用明细：

```
- Index.get():     $0.10 /  10,000 or 0.00001 per get
- Index.search():  $0.13 /  10,000 or 0.000013 per get
- Datastore get(): $0.06 / 100,000 or 0.0000006 per get 
```

如您所见，Datastore get 比 Search API 选项便宜得多（比 Index.get() 便宜 16 倍）。

如果您的数据结构使用大量直接获取和少量复杂搜索，那么数据存储区在成本方面将是明显的赢家。

注意：我没有包括使用 Index.search() 方法存储重复数据的额外成本，因为这取决于您存储的实体数量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-18T17:48:27.157

只需将数据放在两者中 - 存储很便宜，并且取决于您的应用程序执行多少写入操作，进行更新也可能很便宜。为了方便查询和按键获取单个实体 - 使用 memcache 和数据存储。对于复杂查询，请使用搜索 API。一旦宣布定价，您就必须做出权衡。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-18T18:47:11.987

现在每次我在searchdoc中索引一个实体，我也索引实体的序列化版本。
实际上，它通过搜索 api 搜索文档并提取序列化字段比从数据存储中获取相同数量的实体要快得多 **。**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-08T22:13:45.997

你不会：

1.  失去 memcache 的任何好处

2.  面临较低的配额。“我们预计，一旦该功能从实验阶段毕业，我们的免费配额将涵盖每天约 1,000 次搜索”我看不到您获得的读取次数，但我相信数据存储的读取次数更高。我查看了[https://developers.google.com/appengine/docs/quotas#Resources](https://developers.google.com/appengine/docs/quotas#Resources)

    此外，对于实体更新，我们通过更新或新看跌期权收取不同的费用。似乎索引没有更新，而是作为新文档添加（这就是我正在做的事情）。没有指数定价的细节，很难确切知道，但更新一个实体上的一两个索引值可能比放置一个新的整个指数更便宜。我猜这取决于你的数据。

    最后，索引的总索引大小现在为 250M，而数据上限为 1 GB。那时的数据存储更大，还没有关于索引额外定价成本的消息。

3.  需要制定一个备用计划。如果索引损坏，我现在不知道备份或恢复索引。拥有实体中的数据意味着可以重新创建搜索索引。您现在可以使用管理控制台备份数据存储。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-26T20:58:07.070

除了查询大型数据集的性能成本外，数据存储还具有允许数据高度一致的优势。查看[此链接](https://cloud.google.com/datastore/docs/articles/balancing-strong-and-eventual-consistency-with-google-cloud-datastore/)以获取有关强一致数据与最终一致数据的更多信息。

应该假设存储在 Search API 索引中的文档*最终是一致*的。

# hibernate - 休眠作为 WebSphere 7 上的 JPA 2.0 提供程序

> ID：10951938
> 
> 赞同：4
> 
> 时间：2012-06-08T15:40:08.453
> 
> 标签：hibernate, jpa-2.0, websphere-7

我们正在尝试使用 Hibernate 作为 WebSphere Application Server 7.0 上的 JPA 提供程序。但是我们遇到了以下异常。

> javax.ejb.EJBException：注入失败；嵌套异常是：
> 
> java.lang.IllegalStateException：尚未为 PU 创建 EntityManagerFactory：PuId=data_commonweb#data_ejb_common.jar#data_common
> 
> **原因**：java.lang.IllegalStateException：EntityManagerFactory 尚未为 PU 创建：PuId=data_commonweb#data_ejb_common.jar#data_common

`Persistense.xml`如下：

```
 <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>jdbc/db_ds</jta-data-source>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.DB2Dialet"/>
        <property name="hibernate.transaction.factory_class" value="org.hibernate.transaction.JTATransactionFactory" />
        <property name="hibernate.transaction.manager_lookup_class" value="org.hibernate.transaction.WebSphereExtendedJTATransactionLookup"/>
        <property name="openjpa.TransactionMode" value="managed"/>
        <property name="hibernate.show_sql" value="true"/>
        <property name="hibernate.format_sql" value="true"/>
    </properties>
</persistence-unit> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-26T18:37:13.183

经过认真研究，我在这里发现了一个变化：

[http://forum.spring.io/forum/spring-projects/data/115284-jpa2-with-spring-data-deployed-on-websphere-7-without-websphere-jpa2-feature-pack](http://forum.spring.io/forum/spring-projects/data/115284-jpa2-with-spring-data-deployed-on-websphere-7-without-websphere-jpa2-feature-pack)

JPA2 with spring-data deploying on Websphere 7 WITHOUT Websphere JPA2 feature pack Mar 22nd, 2012, 08:52 PM 经过一天的研究，终于找到了无需安装Websphere JPA2功能即可在Websphere 7或更低版​​本上运行JPA 2的方法盒。

Websphere 7 默认支持 JPA1，但在尝试运行 JPA2 时会产生类加载器问题，并且一如既往，Websphere 没有任何明确的文档来解决此限制。这是一个非常简单的解决方案来解决这个问题：

1.  Persistence.xml 文件修复

解决此问题的两种方法：

*   摆脱 persistence.xml 文件。或者
*   将 persistence.xml 重命名为 persistence_WAS.xml

示例代码代码：

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="persistenceXmlLocation" value="classpath:META-INF/persistence_WAS.xml"/>
</bean> 
```

这是因为默认情况下，J2EE 容器在 web 应用程序的 META-INF/ 下查找 persistence.xml 并保留此文件将导致 websphere7 初始化 JPA1 忽略使用 JPA2 的请求。通过使用 Spring Data 配置，摆脱 persistence.xml 是我的选择。（抛出 XML 版本属性的验证异常无效）

2.  手动初始化您的持久性管理器（删除对 Websphere 的依赖） LocalContainerEntityManagerFactoryBean 由 Spring 提供以创建持久性管理器。

（或使用 JPA API 初始化您自己的 Persistence Manager）

在 PersistentUnitInfo 中传递您所需的值。

3.  将 XML Parsing Jars 添加到您的应用程序库中

这是因为一旦我们将 Websphere 的类加载器策略更改为最后一个父级，它就无法初始化 XML 解析库

以下是完整列表：

*   xalan-2.7.jar
*   xbean-2.2.0.jar
*   xbean_xpath-2.2.0.jar
*   xercesImpl-2.6.2.jar
*   xml-apis-2.8.jar
*   xmlpublic-2.2.0.jar
*   XmlSchema-1.4.7.jar
*   xpp3-1.1.3.4.O.jar
*   xstream-1.2.1.jar

    4.  更改 Websphere 应用程序服务器上的类加载器策略

在从您的 WAR 或 EAR 文件加载所有 JAR 之后，让 Websphere 最终加载其内部和扩展 JAR - PARENT_LAST 在这里起到了作用。

这是更新路径 � 步骤

在下面`Applications > Application Types > WebSphere enterprise applications`

选择部署的应用程序：

`Enterprise Applications > JPA2-Application > Manage Modules`

选择 WAR 文件，例如。`JPA2-Application.war`

将 Class loader order 设置更改为 Classes loaded with local class loader first(parent last) 在 Class loader viewer 下，您可以看到 ClassLoader - Search Order - 您可以看到 EAR 中的 Jars 和类首先加载。

在我的情况下不需要额外的库（步骤 3）

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-15T07:27:43.390

对于所有与 JPA 相关的问题，我们都收到了这个错误。我们通过遵循[https://www.ibm.com/developerworks/mydeveloperworks/wikis/form/anonymous/api/library/53181ccd-bcd4-431f-b968-0b5f6d46d652/document/192a432b-28bb-4080-解决了将 Hibernate 配置为 JPA 的问题b037-345e5d83da76/attachment/61e74f67-1d60-4120-ba25-ad7264c9f4f6/media/AlternateJPAProviders_TestReport.pdf](https://www.ibm.com/developerworks/mydeveloperworks/wikis/form/anonymous/api/library/53181ccd-bcd4-431f-b968-0b5f6d46d652/document/192a432b-28bb-4080-b037-345e5d83da76/attachment/61e74f67-1d60-4120-ba25-ad7264c9f4f6/media/AlternateJPAProviders_TestReport.pdf)。

# php - PHP中数组合并的对面

> ID：10951941
> 
> 赞同：8
> 
> 时间：2012-06-08T15:40:18.900
> 
> 标签：php

好的，两个数组：

```
$first = array(1,2,3,4,5,6,7,8,9,10);
$second = array(1,2,3,4,5); 
```

有没有办法（如果可以帮助的话，不循环它们）做一个 array_merge 风格的函数，它返回这个数组：

```
$new = array(6,7,8,9,10); 
```

如果找到匹配项，则不会返回它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-08T15:43:03.380

看[`array_diff()`](http://php.net/array_diff)

```
$new = array_diff($first, $second);
print_r($new);

/*
Array
(
    [5] => 6
    [6] => 7
    [7] => 8
    [8] => 9
    [9] => 10
)
*/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-08T15:42:43.147

[`array_diff()`](http://us.php.net/manual/en/function.array-diff.php)应该这样做：

```
<?php
$array1 = array("a" => "green", "red", "blue", "red");
$array2 = array("b" => "green", "yellow", "red");
$result = array_diff($array1, $array2);

print_r($result);
?>

Array
(
    [1] => blue
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T15:42:58.123

它不是十字路口，而是不同之处

[http://www.php.net/manual/en/function.array-diff.php](http://www.php.net/manual/en/function.array-diff.php)

```
array_diff ( $array1 , $array2) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-08T15:41:34.443

您正在以离散的方式寻找一个交集：

[http://php.net/manual/en/function.array-intersect.php](http://php.net/manual/en/function.array-intersect.php)

**编辑：**哎呀，你想要相反的东西。

**编辑2：**给你，你想要不同：

[http://php.net/manual/en/function.array-diff.php](http://php.net/manual/en/function.array-diff.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-08T15:44:17.563

试试这个：

```
$new = array_diff($first , $second ); 
```

# lua - lua metatable __lt __le __eq 强制布尔转换返回值

> ID：10951942
> 
> 赞同：3
> 
> 时间：2012-06-08T15:40:22.683
> 
> 标签：lua, operator-overloading, metatable

在元表中重载`__eq`、`__lt`和`__le`总是将返回值转换为布尔值。

有没有办法访问实际的返回值？

这将在以下小 lua 脚本中用于为参数创建表达式树

用法：

```
print(_.a + _.b - _.c * _.d + _.a) 
         -> prints "(((a+b)-(c*d))+a)" which is perfectly what I would like to have 
```

但它不起作用，`print(_.a == _.b)`因为返回值被转换为布尔值

ps： print 应该稍后用处理表达式树的函数替换

-- 从 lua 脚本中截取 --

```
function binop(op1,op2, event)
    if op1[event] then return op1[event](op1, op2) end
    if op2[event] then return op2[event](op1, op2) end
    return nil
end

function eq(op1, op2)return binop(op1,op2, "eq") end
...
function div(op1, op2)return binop(op1,op2, "div") end

function exprObj(tostr)
    expr =  { eq = binExpr("=="), lt = binExpr("<"), le = binExpr("<="), add = binExpr("+"), sub=binExpr("-"), mul = binExpr("*"), div= binExpr("/") }
    setmetatable(expr,  { __eq = eq, __lt = lt, __le = le, __add = add, __sub = sub, __mul = mul, __div = div, __tostring = tostr })
    return expr
end

function binExpr(exprType)
    function binExprBind(lhs, rhs)
        return exprObj(function(op) return "(" .. tostring(lhs) ..  exprType .. tostring(rhs) .. ")" end)
    end
    return binExprBind
end

function varExpr(obj, name)
    return exprObj(function() return name end)
end

_ = {}
setmetatable(_, { __index = varExpr }) 
```

- 折断 -

修改 lua vm 是一个选项，但是如果我可以使用官方版本会很好

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T16:36:46.157

并非没有入侵 Lua 本身。这些并不是让操作符做任意事情的方法，比如 C++ 操作符重载；他们打算*完全按照他们所说*的去做。

Lua 会让你信守这个承诺。

# android - 在 onCreateView 运行后替换片段视图

> ID：10951958
> 
> 赞同：1
> 
> 时间：2012-06-08T15:41:04.190
> 
> 标签：android, android-layout, android-fragments

我有一个片段，有两种视图模式，一个编辑模式和一个只读模式。用户可以通过在两种模式下都可用的微调器中选择的状态之间移动来切换模式。

创建片段时，我选择只读或编辑布局以根据我管理的对象的状态进行扩展。一旦用户选择了新的状态，模式就可以从只读模式切换到编辑模式。发生这种情况时，我需要用只读视图替换编辑视图。

如何替换片段中的现有视图？在 Activity 中，我会使用我想要使用的布局调用 setContentView。

我试过了：

*   使视图无效，但不再调用 onCreateView。
*   用片段事务替换片段，但不会改变布局。

注意：这是针对 Android 4.0 的，我不能使用兼容性库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:08:47.537

如果您想将所有内容保存在一个片段中：

我不完全确定您的布局看起来如何，但我想我只是将两个布局都放入 a[`ViewFlipper`](http://developer.android.com/reference/android/widget/ViewFlipper.html)并根据选择的内容更改它的显示子项。

示例片段布局

```
<LinearLayout android:orientation="vertical" ..>
    <Spinner ../>

    <ViewFlipper android:id="@+id/flipper" ..>
        <ReadOnlyLayout />
        <EditLayout />
    </ViewFlipper>

</LinearLayout> 
```

然后您可以简单地使用[`setDisplayedChild()`](http://developer.android.com/reference/android/widget/ViewAnimator.html#setDisplayedChild%28int%29)在两种布局之间切换，具体取决于您拥有的状态。

```
ViewFlipper vf = (ViewFlipper) getView().findViewById(R.id.flipper);
vf.setDisplayedChild(1); 
```

请注意，子索引从 0 开始。

也可以使用两个独立的片段*（如 Barak 所建议的）*。我想这只是一个设计选择。

# mysql - mysql删除触发器

> ID：10951959
> 
> 赞同：1
> 
> 时间：2012-06-08T15:41:12.307
> 
> 标签：mysql, triggers

所以我有**3 张桌子**：

```
tbl_client(clientpk, name, etc)
tbl_address(address_pk, street1, street2 etc) 
tbl_client_address (client_address_pk, clientpk_fk, addresspk_fk) 
```

我对**触发器**不太熟悉，所以也许有人可以告诉我如何实现这一点，当我删除客户端时，它也会删除`tbl_client_address`. 我知道这可以通过引用来完成，但事实是，由于`tbl_client_address`被删除，我还希望删除与该客户相关的地址。

可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:46:01.260

如果您使用的是 innodb，则可以向主表添加约束：

约束`myForeignKey`外键 ( `typeId`) 引用`types`( `id`) ON DELETE CASCADE ON UPDATE CASCADE

而不必乱用触发器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T17:08:50.653

您希望在删除客户端记录时删除地址记录这一事实表明您可能根本不需要 tbl_client_address 解析表。如果给定地址实际上可以与多个客户端相关联，则仅需要 tbl_client_address 表（如果是这种情况，您不希望根据 tbl_client 记录的删除自动级联删除）。所以我要说的是，您应该考虑是否仅拥有一个 tbl_address.clientpk_fk 字段就足够了，完全删除 tbl_client_address 表，然后使用 Jeff 建议的约束来级联 tbl_client 记录删除。

# django-templates - 如何将多个表单附加到 Django 中的单个提交按钮？

> ID：10951963
> 
> 赞同：0
> 
> 时间：2012-06-08T15:41:29.700
> 
> 标签：django-templates, django-views, python-2.7

这是一个非常菜鸟的问题，但我无法弄清楚。我想在我的 Django 模板中为 2 个（或者可能最终更多）表单使用单个提交。这是我在模板中所做的，但显然不正确。

```
<html><body>
<form action="" method="post" enctype="multipart/form-data">     
        {% csrf_token %}
       <p>Please insert .raw file {{ form }} </p>
</form>
<form action="" method="post" enctype="multipart/form-data">
       <p>Please insert .xml file {{ form }} </p>
    <input type="submit" value="Confirm" />
    <input type="reset" value="Reset" class="button">
</form> 
```

我的 forms.py 文件看起来像这样

```
from django import forms # for UploadFileForm 
```

class DocumentForm(forms.Form): docfile = forms.FileField(label='选择一个文件', help_text='文件大小没有限制')

这是我的看法

```
def Upload(request):
# Handle file upload
if request.method == 'POST': # If form is submitted
    form = DocumentForm(request.POST, request.FILES)
    if form.is_valid():
        newdoc = Document(docfile = request.FILES['docfile'])
        newdoc.save()
        # Redirect to Processing window until processing is complete
        return HttpResponseRedirect('') # Takes me right back to the upload Page
else:
return render_to_response(
    'Upload.html',
    {'form': form},
    context_instance=RequestContext(request) 
) 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-25T16:25:08.017

感谢 MindVirus，但我想做的事情要简单得多。这只是在我的表单中添加更多 FileFields 的问题，就可以了。这是解决方案：将当前的 forms.py 更改为：

```
class DocumentForm(forms.Form): 
    form1 = forms.FileField()
    form2 = forms.FileField() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T19:05:51.503

请参阅[https://github.com/AndrewIngram/django-extra-views/blob/master/extra_views/multi.py#L185](https://github.com/AndrewIngram/django-extra-views/blob/master/extra_views/multi.py#L185)。

# javascript - 提交按钮未提交

> ID：10951970
> 
> 赞同：1
> 
> 时间：2012-06-08T15:41:44.127
> 
> 标签：javascript, validation, button

我有一个简单的 html 登录表单，在提交之前使用 javascript 进行了验证。当我尝试提交未满足验证条件的表单时，我会像往常一样收到验证警报。但是，当它们遇到时，提交按钮变得无响应。

这是表单的 html 代码：

```
<form action="staff_login_process.php" class="myform" enctype="multipart/form-data" method="post" onsubmit="return validLog()">

            <fieldset>

            <div id="apply_width">

                    <div id="field_area">

                            <h2 class="white">Login</h2>

                                <label for="username">Username<span>*</span>
                                </label> <input type="text" name="email" value="" id="username" class="float_right" />

                                <label for="password">Password<span>*</span>
                                </label><input type="password" name="password" value="" id="password" class="float_right" />
                                <a class="red" href="">Forgot Password</a>

                    </div>

                    <input type="submit" value="Login" class="button" />

            </div>

            </fieldset>

        </form> 
```

这是负责验证的Javascript代码：

```
function validLog() {

var username = document.getElementById('username');
var password = document.getElementById('password');

if(notEmpty(username, "Please enter username")){
    if(notEmpty(password, "Please enter password")){
    }
}

return false;

} 

function notEmpty(elem, helperMsg){
if(elem.value.length == 0){
    alert(helperMsg);
    elem.focus(); // set the focus to this input
    return false;
}
return true;
} 
```

我不知道该怎么做才能使这项工作正常进行，并且无法发现我在这里出错的地方，所以任何建议都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:43:38.453

你的`validLog()`函数总是返回`false`

改变

```
if(notEmpty(username, "Please enter username")){
    if(notEmpty(password, "Please enter password")) {
        return false;
    }
}

return true; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T15:45:29.167

由于`notEmpty`函数返回本身`true`or `false`，请简单地尝试

```
function validLog() {

   var username = document.getElementById('username'),
       password = document.getElementById('password');

   return notEmpty(username, "Please enter username") 
       && notEmpty(password, "Please enter password");
} 
```

因此，如果您的两个值都不为空，则将提交表单

# java - 适用于 7 英寸平板电脑的 android xlarge 布局

> ID：10951977
> 
> 赞同：2
> 
> 时间：2012-06-08T15:42:03.987
> 
> 标签：java, android-layout, android

我想为三星 Galaxy Note（5.3 英寸显示屏）和 Acer Iconia Tab A100（7 英寸显示屏）使用不同的布局。但是，它们都使用**res/layout-large中声明的布局**

[如此处](http://developer.android.com/guide/practices/screens_support.html#DeclaringTabletLayouts)所述，从 Android 3.2 开始，开发人员可以根据屏幕宽度声明布局，而不是使用现在已弃用的*large*、*xlarge*和其他限定符。所以我会在**res/layout-sw600dp**中为 Acer Iconia Tab A100 声明一个不同的布局。

但是，如果平板电脑安装了 Android 3.0，有没有办法为 2 台设备实现不同的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T16:03:21.877

您可以尝试获取`DeviceModel`in 代码并根据它是什么设备加载布局...

请参阅[http://developer.android.com/reference/android/os/Build.html#MODEL](http://developer.android.com/reference/android/os/Build.html#MODEL)

否则：当两个设备共享相同的布局时有什么问题？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T16:03:33.043

在 Android 3.2 之前，您可以尝试使用屏幕密度和分辨率来导出物理尺寸，并在运行时根据该计算选择不同的资源（按名称）。然而，考虑到不同尺寸的平板电脑的数量，准确性很难保证。

我建议您尝试设计一个在 5" 和 7" 平板电脑上都可以正常工作的 UI 设计。

# android - 在 Android 中通过 CODE ONLY 更改进度条颜色

> ID：10951978
> 
> 赞同：76
> 
> 时间：2012-06-08T15:42:05.180
> 
> 标签：android, colors, progress-bar

我有一个使用 ProgressBar 类的进度条。

只是这样做：

```
progressBar = new ProgressBar(this, null, android.R.attr.progressBarStyleHorizontal); 
```

我需要使用如下输入值更改那个颜色：

```
int color = "red in RGB value".progressBar.setColor(color) 
```

或类似的东西...

我不能使用**XML 布局**，因为进度条可以为用户定制。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-02-25T06:31:34.700

这将很有帮助，不需要做这么多的编码:)

```
ProgressBar spinner = new android.widget.ProgressBar(
            context,
            null,
            android.R.attr.progressBarStyle);

spinner.getIndeterminateDrawable().setColorFilter(0xFFFF0000,android.graphics.PorterDuff.Mode.MULTIPLY); 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2017-03-22T20:16:20.707

如果您需要为背景和进度条着色不同的颜色。

**progress_drawable.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@android:id/background">
        <shape android:shape="rectangle" >
            <solid android:color="@color/white" />
        </shape>
    </item>
    <item android:id="@android:id/progress">
        <clip>
            <shape>
                <solid android:color="@color/green" />
            </shape>
        </clip>
    </item>
</layer-list> 
```

它可以以编程方式分解其层列表项，并分别为它们着色：

```
LayerDrawable progressBarDrawable = (LayerDrawable) progressBar.getProgressDrawable();
Drawable backgroundDrawable = progressBarDrawable.getDrawable(0);
Drawable progressDrawable = progressBarDrawable.getDrawable(1);

backgroundDrawable.setColorFilter(ContextCompat.getColor(this.getContext(), R.color.white), PorterDuff.Mode.SRC_IN);
progressDrawable.setColorFilter(ContextCompat.getColor(this.getContext(), R.color.red), PorterDuff.Mode.SRC_IN); 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2015-08-14T22:11:43.373

**更新**

在较新版本的 Android（21 个作品）中，您只需使用`setProgressTintList`.

要将其设置为红色，请使用：

```
//bar is a ProgressBar
bar.setProgressTintList(ColorStateList.valueOf(Color.RED)); 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2012-06-14T08:45:49.420

当我在此处找到有关某个主题的帮助但不记得链接时，我正在发布我的完整解决方案，该解决方案非常适合我的需求：

```
 // Draw a simple progressBar from xml
    progressBar = new ProgressBar(this, null, android.R.attr.progressBarStyleHorizontal);

    // Convert the color (Decimal value) to HEX value: (e.g: #4b96a0)
    String color = colorDecToHex(75, 150, 160);

    // Define a shape with rounded corners
    final float[] roundedCorners = new float[] { 5, 5, 5, 5, 5, 5, 5, 5 };
    ShapeDrawable pgDrawable = new ShapeDrawable(new RoundRectShape(roundedCorners,     null, null));

    // Sets the progressBar color
    pgDrawable.getPaint().setColor(Color.parseColor(color));

    // Adds the drawable to your progressBar
    ClipDrawable progress = new ClipDrawable(pgDrawable, Gravity.LEFT, ClipDrawable.HORIZONTAL);
    progressBar.setProgressDrawable(progress);

    // Sets a background to have the 3D effect
    progressBar.setBackgroundDrawable(Utils.getActivity().getResources()
            .getDrawable(android.R.drawable.progress_horizontal));

    // Adds your progressBar to your layout
    contentLayout.addView(progressBar); 
```

这是将 DECIMAL 颜色值转换为 HEXADECIMAL 的代码：

```
public static String colorDecToHex(int p_red, int p_green, int p_blue)
{
    String red = Integer.toHexString(p_red);
    String green = Integer.toHexString(p_green);
    String blue = Integer.toHexString(p_blue);

    if (red.length() == 1)
    {
        red = "0" + red;
    }
    if (green.length() == 1)
    {
        green = "0" + green;
    }
    if (blue.length() == 1)
    {
        blue = "0" + blue;
    }

    String colorHex = "#" + red + green + blue;
    return colorHex;
} 
```

我认为最后一种方法不是那么干净，但效果很好。

希望这会有所帮助，在这个进度条上浪费了太多时间。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2015-11-27T08:17:23.337

这适用于 AppCompat：

```
DrawableCompat.setTint(progressBar.getProgressDrawable(), tintColor); 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2012-06-08T15:54:35.800

可以通过在可绘制的进度条上设置颜色过滤器来为进度条着色：

```
Drawable drawable = progressBar.getProgressDrawable();
drawable.setColorFilter(new LightingColorFilter(0xFF000000, customColorInt)); 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2017-09-22T11:09:11.573

如果您想以编程方式更改进度条的颜色，那么您复制此代码它正在 100% 工作

```
 mainProgressBar.getIndeterminateDrawable().setColorFilter(Color.GREEN, PorterDuff.Mode.MULTIPLY); 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2021-05-02T13:29:19.740

## 科特林 2021：

```
progressBar.indeterminateTintList = ColorStateList.valueOf(Color.WHITE) 
```

您还可以使用 getColor() 传递资源

如果不是不确定的，您可能需要这 2 个：

```
setSecondaryProgressTintList

setProgressTintList 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-02-17T02:35:39.603

`progressbar.setIndeterminateTintList(ColorStateList.valueOf(Color.RED));`

它仅适用于 API 21 以上

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-03-15T09:32:05.997

我通过**drawable**在**xml中给出了****默认颜色**。

 ****我以编程方式更改了它。

**活动_splasg.xml**：

```
<ProgressBar
       android:id="@+id/splashProgressBar"
       android:progressDrawable="@drawable/splash_progress_drawable"
       android:layout_width="match_parent"
       android:layout_height="wrap_content"
       android:max="100"
       android:progress="50"
       style="?android:attr/progressBarStyleHorizontal"
       android:layout_alignParentBottom="true" /> 
```

**splash_progress_drawable.xml**：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@android:id/background">
        <shape>
            <solid
                android:color="@android:color/transparent" />
        </shape>
    </item>

    <item
        android:id="@android:id/progress">
        <clip>
            <shape>
                <solid
                    android:color="#e5c771" />
            </shape>
        </clip>
    </item>

</layer-list> 
```

现在如何以**编程方式更改 ProgressDrawable 颜色**。

```
ProgressBar splashProgressBar = (ProgressBar)findViewById(R.id.splashProgressBar);

Drawable bgDrawable = splashProgressBar.getProgressDrawable();
bgDrawable.setColorFilter(Color.BLUE, android.graphics.PorterDuff.Mode.MULTIPLY);
splashProgressBar.setProgressDrawable(bgDrawable); 
```

希望这会帮助你。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-09-12T20:13:28.663

布局 = activity_main.xml：

```
<ProgressBar
    android:id="@+id/circle_progress_bar_middle"
    style="?android:attr/progressBarStyleHorizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_centerInParent="true"
    android:max="100"
    android:rotation="-90"
    android:indeterminate="false"
    android:progressDrawable="@drawable/my_drawable_settings2" /> 
```

在 Java 活动/片段中：

```
ProgressBar myProgressBar = (ProgressBar) view.findViewById(R.id.circle_progress_bar_middle);
myProgressBar.setProgressDrawable(getResources().getDrawable(R.my_drawable_settings1)); 
```

drawable/mipmap 文件夹中的 my_drawable_settings1.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:id="@android:id/progress">
        <shape
            android:innerRadius="55dp"
            android:shape="ring"
            android:thickness="9dp"
            android:useLevel="true">

            <gradient
                android:startColor="#3594d1"
                android:endColor="@color/white"
                android:type="sweep" />
        </shape>
    </item>
</layer-list> 
```

其中 my_drawable_settings1 和 my_drawable_settings2.xml 有不同的颜色。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-03-31T18:15:39.000

`setColorFilter`不推荐使用带有 2 个参数的另一个答案，指向使用的另一个答案`LightingColorFilter`对我来说都没有用，所以

```
val progressBar = ProgressBar(context, null, android.R.attr.progressBarStyle).apply {

    val colorFilter = PorterDuffColorFilter(
        ContextCompat.getColor(context, R.color.yourColor),
        PorterDuff.Mode.MULTIPLY
    )

    indeterminateDrawable.colorFilter = colorFilter
} 
```

这将以编程方式为您提供带有颜色的圆形进度条

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-01-09T07:17:02.280

试试这个：

```
progress_wheel.getIndeterminateDrawable().setColorFilter(Color.parseColor(getPreferences().getString(Constant.SECOND_COLOR, Constant.SECONDARY_COLOR)), android.graphics.PorterDuff.Mode.MULTIPLY); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-01-17T17:35:05.390

> 试试这个代码：

```
 CircularProgressIndicator  circularProgressIndicator = findViewById(R.id.tenant_progress_color);
    circularProgressIndicator.setIndicatorColor(color);
    circularProgressIndicator.setTrackColor(R.color.gray); 
```****

# c# - c# 将子类声明为类型超类

> ID：10951982
> 
> 赞同：8
> 
> 时间：2012-06-08T15:42:21.447
> 
> 标签：c#, inheritance

对于这个继承问题，我似乎找不到令人满意的答案。为什么有时要声明这样的子类型：

```
Shape myCircle = new Circle(); 
```

而这其他时间？

```
Circle myShape = new Circle(); 
```

Circle 是......的子类**/子类**`Shape`

我一直在阅读的 OO 书籍似乎没有一致性，并且我可以理解的解释。人们已经向我展示了为圆形、正方形等实例化的 Shapes 类的示例……但是我不明白您何时使用第一个声明和第二个声明。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T15:48:30.073

通常希望以[多态](http://en.wikipedia.org/wiki/Polymorphism_in_object-oriented_programming)方式处理具体类的对象，以避免在可以避免它们的地方创建对特定类型的依赖关系。例如，如果您创建 a`Circle`的目的是绘制它，并且`Draw()`是 a 的方法`Shape`，那么最好将其声明`myCircle`为形状，以防您稍后决定将其替换为正方形。

另一方面，如果您打算对 做一些特定的事情`Circle`，例如设置它的半径，那么您需要声明`myCircle`为`Circle`，因为`SetRadius()`在 上可能不可用`Shape`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T15:48:01.020

也许您有一个形状列表，并且您并不特别关心它们是哪种形状，因为您需要对该列表执行的操作对所有形状都是通用的（即绘制），您可能希望将它们添加到列表中，例如这个

```
List<Shape> shapeList = new List<Shape>();
shapeList.Add(new Circle());
shapeList.Add(new Rectangle());
foreach (Shape shape in shapeList)
{
    shape.Draw();
} 
```

通过这种方式，您可以访问实际上是不同类型但共享共同父对象的形状的一般方法。然后，如果你想做一些特定于圈子的事情，你可以使用像这样的相同列表。

```
foreach (Shape shape in shapeList)
{
    if (!(shape is Circle)) continue;
    Circle circle = shape as Circle;
    circle.Radius = 100;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T16:16:53.507

除了@dasblinkenlight 的答案之外，您还可以使用第一个声明，而不是第二个声明，因为您希望将`myCircle`object的行为限制为`Circle`的成员。

那是因为`Circle`是 的子类`Shape`，这意味着 的所有成员都`Shape`将被 继承`Circle`，并且在某些情况下，因为您使用的是 C#（并且覆盖成员并不总是规则，就像在 Java 中一样），被覆盖。

你不能做相反的事情：

```
Circle myCircle = new Shape(); 
```

原因在[这里](http://wiki.answers.com/Q/Can_a_super_class_varialble_can_reference_a_subclass_object_in_java)描述。

否则，如果您使用第二个声明，`myCircle`将是一个`Circle`对象，使用`Circle`.

# oracle - 如何验证用户权限是否已被撤销以在oracle中执行sp

> ID：10951983
> 
> 赞同：0
> 
> 时间：2012-06-08T15:42:24.677
> 
> 标签：oracle, permissions

我执行以下命令来撤销用户执行特定 SP 的权限：

```
REVOKE EXECUTE ON SOME.SP_NAME FROM SOME_USER; 
```

我想查询一下执行权限是否被成功撤销。

是否有一些查询会向我显示所有权限`SOME_USER`，`SOME.SP_NAME`以便我现在可以直观地验证这`EXECUTE`不是其中之一。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:47:48.513

```
select * from all_tab_privs where grantee = 'SOME_USER' and table_name = 'SP_NAME' and table_schema = 'SOME' 
```

编辑：

ALL_TAB_PRIVS 工作正常。这是我自己的一个会话：

```
SQL> create procedure myproc is begin null; end;
  2  /

Procedure created.

SQL> grant execute on myproc to x11414;

Grant succeeded.

SQL> select * from all_tab_privs where table_name = 'MYPROC';

GRANTOR                        GRANTEE                                          
------------------------------ ------------------------------                   
TABLE_SCHEMA                   TABLE_NAME                                       
------------------------------ ------------------------------                   
PRIVILEGE                                GRA HIE                                
---------------------------------------- --- ---                                
W13582                         X11414                                           
W13582                         MYPROC                                           
EXECUTE                                  NO  NO                                 

SQL> revoke execute on myproc from x11414;

Revoke succeeded.

SQL> select * from all_tab_privs where table_name = 'MYPROC';

no rows selected 
```

编辑#2：如果您可以访问它，DBA_TAB_PRIVS 可能会更好。ALL_TAB_PRIVS 仅限于：

> 授予用户是授予者、被授予者、所有者或启用的角色或 PUBLIC 是被授予者的对象

# java - JPA实体设计/不能删除实体

> ID：10951984
> 
> 赞同：0
> 
> 时间：2012-06-08T15:42:26.050
> 
> 标签：java, jpa, orm, playframework

我虽然我想要的很简单，但我找不到任何解决我的问题的方法。我正在使用 playframework 1.2.3，它使用 Hibernate 作为 JPA。所以我认为playframework与问题无关。

我有一些课程（我省略了不相关的字段）

```
public class User {
  ...
}

public class Task {
  public DataContainer dataContainer;
}

public class DataContainer  {
  public Session session;
  public User user;
}

public class Session  {
  ...
} 
```

所以我有从 Task 到 DataContainer 以及从 DataContainer 到 Session 的关联，并且 DataContainer 属于一个用户。DataContainers 可以始终具有相同的用户，但每个实例的会话必须不同。并且任务的 DataContainer 在每个实例中也必须不同。DataContainer 可以有或没有会话（它是可选的）。我只使用单向关联。应该足够了。

换句话说：每个任务**必须**有一个 DataContainer。每个 DataContainer **必须**有一个/相同的 User 并且**可以**有一个 Session。

要创建数据库模式，我使用 JPA 注释：

```
@Entity
public class User extends Model {
  ...
}

@Entity
public class Task extends Model {
  @OneToOne(optional = false, cascade = CascadeType.ALL)
  public DataContainer dataContainer;
}

@Entity
public class DataContainer extends Model  {
  @OneToOne(optional = true, cascade = CascadeType.ALL)
  public Session session;

  @ManyToOne(optional = false, cascade = CascadeType.ALL)
  public User user;
}

@Entity
public class Session extends Model {
  ...
} 
```

*顺便说一句：模型是一个播放类，并提供主要 id 作为 long 类型。*

当我为每个实体创建一些对象并“连接它们”时，我的意思是关联，它工作正常。但是当我尝试删除一个 Session 时，我得到了一个违反约束的异常，因为 DataContainer 仍然引用我要删除的 Session。

我希望 DataContainer 的 Session（字段）将分别设置为 null 外键（session_id）应该在数据库中取消设置。这没关系，因为它是可选的。

我不知道，我想我有很多问题。我使用了正确的注释`@OneToOne`吗？

我在互联网上发现了一些额外的注释和属性： `@JoinColumn`以及`mappedBy`反向关系的属性。但我没有，因为它不是双向的。或者是双向关联。本质上？

另一种尝试是使用在更新或删除时`@OnDelete(action = OnDeleteAction.CASCADE)`从 s 更改为的约束：`NO ACTION`

```
ADD CONSTRAINT fk4745c17e6a46a56 FOREIGN KEY (session_id)
      REFERENCES annotation_session (id) MATCH SIMPLE
      ON UPDATE NO ACTION ON DELETE CASCADE; 
```

但在这种情况下，当我删除会话时，DataContainer 和 User 将被删除。这对我来说是错误的。

* * *

*编辑：* 我正在使用 postgresql 9，jdbc 的东西包含在 play 中，我唯一的 db 配置是
`db=postgres://app:app@localhost:5432/app`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-08T16:36:39.153

您应该使用 OneToOne 还是 ManyToOne？使用最能描述情况的关联。如果多个 DataContainer 可能具有相同的会话，则它是 ManyToOne。如果只有一个 DataContainer 可能有一个给定的会话，那么它就是 OneToOne。

现在，如果您删除会话，并且 DataContainer 仍然引用它，那么您当然会遇到异常。这就是 FK 的用途：它确保您不能拥有引用不存在会话的 DataContainer。因此，要删除会话，您应该首先更新所有引用它的数据容器。

由于您的关联是单向的，因此您需要一个查询来执行此操作：

```
select dc from DataContainer dc where dc.session = :session 
```

执行此查询，遍历结果，并将会话设置为空。然后，删除会话。

如果您的关联是双向的，您可以简单地执行以下操作：

```
for DataContainer dc : session.getDataContainers() {
    dc.setSession(null);
} 
```

您还可以使用更新查询在单个查询中完成所有操作。但请注意，不会对会话中已加载的 DataContainer 进行这些更改：

```
update DataContainer dc set dc.session = null where dc.session = :session 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:13:03.887

不确定，但是使用的数据库是什么？它是由休眠自动加载的，还是您使用自己的 DDL 查询来创建它。如果是，请检查是否在数据库级别建立了约束，验证 DataContainer 表中的 sessionId 外键是否可为空

# php - Vbulletin 致命错误 / php

> ID：10951987
> 
> 赞同：0
> 
> 时间：2012-06-08T15:42:44.410
> 
> 标签：php, vbulletin

我为我的 vbulletin 套件安装了修改并收到此错误

```
Fatal error: Using $this when not in object context in /var/www/forum/includes/class_hook.php on line 57 
```

显然，有些用户在使用带有 vbadvanced 的 mod 时会出现此错误，但没有提供支持。

也许有人可以弄清楚。我没有任何php知识，所以我提前道歉

这是第 53 - 58 行

```
53  * Sets the plugin list array
54  */
55  function set_pluginlist(&$pluginlist)
56  {
57      $this->pluginlist =& $pluginlist;
58  } 
```

我希望有人可以帮助我，也不是很多信息：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:46:16.157

同样的问题似乎得到了解决。尝试查看：[VBulletin 论坛](http://www.vbulletin.org/forum/showthread.php?t=279463)。

让我从那里引用：

> 我已上传 vBAdvanced 问题的修复程序，请重新下载 zip 文件并重新上传`/dbtech/livewall/hooks/process_templates_complete.php`

该帖子的链接：[http ://www.vbulletin.org/forum/showpost.php?s=0de19e68ada2bc70d3698e851f0cce9e&p=2306225&postcount=12](http://www.vbulletin.org/forum/showpost.php?s=0de19e68ada2bc70d3698e851f0cce9e&p=2306225&postcount=12)

希望有用！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T15:51:10.143

重新上传您在 ASCII 模式下使用的修改。