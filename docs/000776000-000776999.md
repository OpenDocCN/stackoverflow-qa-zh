# StackOverflow 问答 000776000-000776999

# c++ - 通过指向基类对象的指针使用指向派生类对象的指针进行操作

> ID：776004
> 
> 赞同：5
> 
> 时间：2009-04-22T06:59:32.983
> 
> 标签：c++, inheritance, pointers

我有这个代码来代表银行：

```
class Bank {
    friend class InvestmentMethod;
    std::vector<BaseBankAccount*> accounts;
public:
//... 
```

BaseBankAccount 是银行中所有账户的抽象类：

```
class BaseBankAccount {
    public:
        BaseBankAccount() {}
        virtual int getInterest() const = 0;
        virtual int getInvestedSum() const = 0;
        virtual void increaseDepositSum(int additionalSum) = 0;
        virtual void close(std::string& reason) = 0;
        virtual ~BaseBankAccount() {}
}; 
```

问题是，当我通过指向基类对象的指针使用指向派生类对象的指针进行操作时，我可以调用的方法集受到 BaseBankAccount 公共接口的限制——无论 REAL 对象是什么类型。

例如，并不是每个账户都可以选择增加投资金额——所以，我没有在基类中包含这个方法：

```
class BankAccount: public BaseBankAccount {
protected:
    BaseDeposit* deposit;
    double sumInvested;
public:
    BankAccount(int sum, int term, int inter): sumInvested(sum), depositTerm(term), interest(inter) {}
    int getInterest() const { return interest; }
    int getInvestedSum() const { return sumInvested; }
    void prolong(int increaseTerm) {
        depositTerm += increaseTerm;
    }
    void increaseInvestment(double addition) {
            sumInvested += addition;
    }
    virtual ~BankAccount() {}
}; 
```

然后，我想称之为：

```
Bank bank1(...);
bank1.accounts[i]->increaseInvestment(1000.0); 
```

那么，在这种情况下，我该怎么做才能访问派生类对象的接口呢？据我所知，每次需要调用特定功能时**向下转换为具体类型****并不好**。
再创建一个由此派生的抽象类来扩展接口？
为我需要实现的每种特定类型创建并行层次结构（看起来有点繁重）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-22T07:53:34.710

从基类访问更多派生类特性的一种解决方案是访问者模式。

```
class BaseBankAccount {
public:
    ...
    virtual void AcceptVisitor(IVisitor& v) = 0;
};

class AccountTypeA : public BaseBankAccount {
public:
   void TypeAFeature() {...}

   void AcceptVisitor(IVisitor& v)
   {
       v.VisitAccountTypeA(*this);
   }
};

class AccountTypeB : public BaseBankAccount {
public:
   void TypeBFeature() {...}

   void AcceptVisitor(IVisitor& v)
   {
       v.VisitAccountTypeB(*this);
   }
};

class IVisitor {
public:
    virtual void VisitAccountTypeA(AccountTypeA& account) = 0;
    virtual void VisitAccountTypeB(AccountTypeB& account) = 0;
};

class ConcreteVisitor : public IVisitor{
public:
    void VisitAccountTypeA(AccountTypeA& account) 
    {
         account.TypeAFeature(); //Can call TypeA features
    }

    void VisitAccountTypeB(AccountTypeB& account) 
    {
         account.TypeBFeature(); //Can call TypeB Features
    }
}; 
```

这种相互作用并不是立即显而易见的。你在你的基类中定义了一个纯虚方法 AcceptVisitor，它接受一个 IVisitor 类型的 Object 作为参数。IVisitor 在层次结构中的每个派生类都有一个方法。每个派生类都以不同的方式实现 AcceptVisitor，并调用与其具体类型（AccountTypeA 和 AccountTypeB）对应的方法，并将对自身的具体引用传递给该方法。您实现的功能在派生自 IVisitor 的对象中使用更多派生类型的层次结构。维基百科：[访客模式](http://en.wikipedia.org/wiki/Visitor_pattern)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T07:29:50.913

对基类公共接口的限制（顺便说一句，您发布的内容中是否缺少一些“虚拟”）是 C++ 所做的。如果您需要访问仅属于派生类的特定函数，则需要使用 dynamic_cast 将指针强制转换为该类。

如果您发现需要大量使用 dynamic_cast，那么您的设计可能需要，但如果不知道您正在处理的业务领域的确切细节，很难对此发表评论。

解决该问题的一种可能方法是提供访问帐户组件的方法。例如，基类方法 GetPortfolio() 可以返回投资组合对象指针，但仅适用于具有投资组合的账户类。对于其他类，您将其 GetPortfolio() 方法定义为返回 NULL。一旦你有了投资组合指针，你就可以在投资组合接口（它本身可能代表一个类层次结构）而不是 BankAccount 上工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T07:30:54.140

为什么需要“访问派生类对象的接口”？

如果您提供 BaseBankAccount 子类的示例以及您要调用的方法，这可能有助于讨论的目的。

我假设您的 BaseBankAccount 类中的纯方法也应该是虚拟的？

如果要调用 BaseBankAccount 子类的方法，通常需要将这些方法（作为虚拟方法）添加到 BaseBankAccount 基类。如果这些方法对 BaseBankAccount 的所有子类都没有意义，那么您可能需要重新考虑您的类设计。

例如

```
class BaseBankAccount {
    public:
        BaseBankAccount() {}

        virtual void someNewMethod () = 0;

        // ...
};

class SavingsBankAccount : public BaseBankAccount {
    public:
        virtual void someNewMethod () {
            // ...
        }

        // ...
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T07:26:23.137

不得不沮丧，虽然总是有风险，但有时是不可避免的。例如，在将模板引入 Java 之前，您必须在使用标准集合时一直向下转换，因为它们仅适用于对象。

我假设当您向下转换时，您使用 dynamic_cast 使其安全。我还假设您的基类中的所有内容都是虚拟的，而您只是在此代码中省略了它。

具体到您的问题，没有一个正确的答案。一般来说，当您将一堆派生类聚集到一个异构集合中时，您要么将集合用作“位桶”，要么打算在最低公分母（基类的接口）上工作。

如果情况是前者，那么向下转型，虽然丑陋，但可能是必要的。如果是后者，那么您必须问自己为什么要以不同方式处理特定的子类型，以及是否可以更改基类的实现以某种方式调用派生类中的相关内容（例如，通过派生类方法）。

无论哪种情况，您可能首先要重新考虑异构集合是否有意义，在某些情况下确实没有意义。例如，为每种主要类型的帐户分别维护集合，并有一个返回聚合的“getAllAccounts”方法可能是有意义的？

# sql-server - 使用存储过程搜索数据库表的最佳方法是什么？

> ID：776009
> 
> 赞同：-1
> 
> 时间：2009-04-22T07:00:24.497
> 
> 标签：sql-server

我想知道使用存储过程（比如说文本搜索）搜索数据库表的最佳方法是什么？

我应该注意哪些点？

如果你们想了解更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T07:22:27.063

此查询将为您提供名称与您的关键字匹配的表的列表

SELECT name FROM sysobjects WHERE xtype = 'U' AND name LIKE '%keyword%'

# c# - 绕过处置进行测试

> ID：776018
> 
> 赞同：1
> 
> 时间：2009-04-22T07:22:44.723
> 
> 标签：c#, tdd, typemock

我正在尝试测试一种方法。我想确保该方法（调用服务）中有一个方法调用，代码如下所示：

```
using(proxy = new Proxy())
{ 
      proxy.CallService();
} 
```

我将代理与假对象交换（使用 TypeMock），但由于在块末尾放置的假对象而出错。我不想删除那个“使用”块。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T07:25:00.007

使模拟对象也期望被处置。（我不知道 TypeMock，但在其他一些模拟框架中，这只是`Dispose`在“记录”阶段调用自己的情况。）事实上，我会说如果没有那个测试无论如何都是错误的，因为大概你希望确定代理*正在*被处置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T07:26:40.203

只需指示您的代理模拟也期待调用`Dispose()`。如果你使用反射模拟，你需要做这样的事情

```
var proxyMock = MockManager.Mock(typeof(Proxy));
// set up regular calls to proxy, e.g.
proxyMock.ExpectCall("CallService");
proxyMock.ExpectCall("Dispose"); 
```

`Dispose()`对于自然模拟，请在您的 using 块中调用 to 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T07:27:12.107

使假对象实现 IDisposable：

```
class FakeObject : IDisposable
{
    public void Dispose() {}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T13:36:05.763

免责声明：我在 Typemock 工作
如果您使用的是 Arrange Act Assert API，您可以在创建假对象时使用 Members.ReturnRecursiveFakes（注意：这是 5.2.0 版的默认设置）这也会自动伪造 Dispose 方法.

所以你的测试将是这样的：

```
var fake = Isolate.Fake.Instance<Proxy>(Members.ReturnRecursiveFakes);
Isolate.WhenCalled(() => fake.CallService()).IgnoreCall();
Isolate.Swap.NextInstance<Proxy>().With(fake);

UnderTest classUnderTest = new ClassUnderTest();
classUnderTest.MethodUnderTest(); // assuming the Proxy instance is used here.

Isolate.Verify.WasCalledWithAnyArguments(()=>fake.CallService()); 
```

我想补充一下 Jon Skeet 所说的，我将创建一个单独的测试，以确保调用 Dispose 方法。
我认为在每种测试方法中断言一件事是一种很好的做法，这样当测试中断时，您会立即知道原因。

# java - java JAXB和继承

> ID：776021
> 
> 赞同：3
> 
> 时间：2009-04-22T07:24:30.397
> 
> 标签：java, jaxb

我想创建一个列表不同类型的类，它们都是从同一个超类继承的。
我从一个 xsd 文件开始，我想创建 java 类并在运行时加载具有列表节点的 xml 文件。
我的问题是定义将创建 java 类的 xsd。

我正在使用 JAXB 2.0 eclipse 插件。

最后我想拥有一个`List<superClass>`。
我可以用一个简单的 JAXB 来做吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-22T08:20:11.310

如果您还没有 xsd，我不明白为什么要从 xsd 开始。如果您对架构不感兴趣，它将从 java 代码开始并从那里生成 XSD。

您可以按如下方式注释列表：

```
@XmlElements({
    @XmlElement(name = "child1", type = Child1.class),
    @XmlElement(name = "child2", type = Child2.class),
    @XmlElement(name = "child3", type = Child3.class)})
private final List<IChild> children = new ArrayList<IChild>(); 
```

`IChild`的子类的接口在哪里`superClass`。这将生成一个 XSD 架构，正如您所描述的那样。

# rdf - 语义网：RDF 开发教程

> ID：776030
> 
> 赞同：6
> 
> 时间：2009-04-22T07:27:21.887
> 
> 标签：rdf, semantic-web

我是语义网的新手。我想开始创建一些基本的 RDF 文档并发布它们以了解它是如何工作的。我找到了很多关于概念、词汇等的信息，但我找不到任何与开发相关的东西，因为开发是什么需要环境，需要什么工具。我来自.net 背景。是否有任何关于如何开始和在网页中使用 rdf 的教程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T12:20:55.370

一开始真的很容易混淆，但它最终足够简单。我喜欢这个关于 RDFa 的 UMBC 股票[视频教程](http://www.youtube.com/watch?v=ldl0m-5zLz4)，它首先解释了 RDF，为您提供了一个很好的人类可读的参考符号 (N3)，然后向您展示了如何使用 RDFa 属性将 RDF 放入普通网页中。

我还开始发布[我自己的](http://feelitlive.com/events/2008/11/12/WC1E/7HY/ULU/Nizlopi)关于音乐事件的 RDFa，并发现[RDFa 蒸馏](http://www.w3.org/2007/08/pyRdfa/)器可以方便地将我的 RDFa 翻译成替代语法（有很多），以便我可以检查我的工作。

如果 RDFa 适合您的用例，请查看 RDFa.info wiki 以[查看常见错误](http://rdfa.info/wiki/Common-publishing-mistakes)。甚至 MySpace 也弄错了其中一些。

应该注意的是，RDFa 不是发布 RDF 的唯一方式，但它是最棒的 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T08:03:28.400

用于处理一组语义三元组（主题、谓词、值）的最著名的 API 称为 Jena：请参阅[http://jena.sourceforge.net/](http://jena.sourceforge.net/)。有一个简单的[教程](http://jena.sourceforge.net/tutorial/RDF_API/index.html)，您将在其中学习操作简单的三元组 (RDF) 存储。

从这个开始，稍后您将学习 RDFS/OWL（本体的东西）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T08:59:50.137

我建议阅读有关语义网络技术（例如[链接文本](https://rads.stackoverflow.com/amzn/click/com/0262012421 "语义网入门第二版")）的介绍。然后，您可以开始研究那里的语义网络工具。可以在[链接文本](http://esw.w3.org/topic/SemanticWebTools/ "ESW Wiki :: SemanticWebTools")中找到这些工具的完整列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T07:28:47.487

有关 .NET 的 RDF API，请参阅[http://razor.occams.info/code/semweb/](http://razor.occams.info/code/semweb/)

# c++ - 使用 shared_ptr 时如何检测循环

> ID：776042
> 
> 赞同：24
> 
> 时间：2009-04-22T07:33:32.777
> 
> 标签：c++, garbage-collection, shared-ptr, reference-counting

shared_ptr 是 Boost 库中的引用计数智能指针。

引用计数的问题是它不能处理循环。我想知道如何在 C++ 中解决这个问题。

请不要提出诸如“不要循环”或“使用弱点”之类的建议。

**编辑**

我不喜欢只使用 weak_ptr 的建议，因为显然如果你知道你会创建一个循环，那么你就不会有问题。如果您在运行时生成 shared_ptrs，您也无法知道在编译时会有一个循环。

因此，请自行删除其中使用 weak_ptr 的答案，因为我特别要求不要有那种答案......

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-22T11:49:06.033

`shared_ptr`表示*所有权*关系。而`weak_ptr`代表*意识*。拥有多个相互拥有的对象意味着您在架构方面存在问题，这可以通过将一个或多个*自己的*'s 更改为*意识到*'s（即`weak_ptr`'s）来解决。

我不明白为什么建议`weak_ptr`被认为是无用的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-08-07T08:38:05.530

我理解您对被轻率地告知使用`weak_ptr`来破坏循环引用和我自己的烦恼，当我被告知循环引用是不好的编程风格时，我几乎感到愤怒。

你特别问你如何发现循环引用。事实是，在一个复杂的项目中，一些参考周期是间接的并且难以发现。

答案是你不应该做出让你容易受到循环引用的错误声明。我是认真的，我在批评一种非常流行的做法——盲目地对所有事情使用 shared_ptr。

您应该在设计中清楚哪些指针是所有者，哪些是观察者。

供业主使用`shared_ptr`。

供观察者使用`weak_ptr`——所有这些，而不仅仅是那些你认为可能是一个循环的一部分。

如果您遵循这种做法，那么循环引用不会引起任何问题，您无需担心它们。当然，当您想使用它们时，您将需要编写大量代码来将所有这些`weak_ptr`s 转换为s - Boost 确实无法胜任这项工作。`shared_ptr`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-22T07:51:43.937

检测周期相当容易：

*   将计数设置为一些较大的数字，例如 1000（确切大小取决于您的应用程序）
*   从您感兴趣的先驱者开始，并遵循它的指示
*   对于您遵循的每个指针，减少计数
*   如果在到达指针链的末端之前计数下降到零，则有一个循环

然而，它不是很有用。而且通常不可能解决引用计数指针的循环问题——这就是为什么发明了替代垃圾收集方案（如生成清除）的原因。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-22T07:55:19.340

我还没有找到比绘制大型 UML 图和寻找周期更好的方法。

为了调试，我使用一个实例计数器进入注册表，如下所示：

```
template <DWORD id>
class CDbgInstCount
{
public:
#ifdef _DEBUG
   CDbgInstCount()   { reghelper.Add(id, 1); }
   CDbgInstCount(CDbgInstCount const &) {  reghelper.Add(id, 1); }
   ~CDbgInstCount()  { reghelper.Add(id, -1); }
#else
#endif
}; 
```

我只是需要将它添加到有问题的类中，然后查看注册表。

（ID，如果给出例如 'XYZ!' 将被转换为字符串。不幸的是，您不能将字符串常量指定为模板参数）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T08:27:28.467

`boost::weak_ptr`和可能的组合`boost::shared_ptr`？[这篇](http://www.aspfree.com/c/a/C-Sharp/SatView-Pointer-Perfect-part-3-5/3/)文章可能很有趣。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T14:09:51.873

请参阅这篇关于在图中[检测周期](https://stackoverflow.com/questions/261573/best-algorithm-for-detecting-cycles-in-a-directed-graph/770690)的帖子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T04:53:54.573

找到循环的通用解决方案可以在这里找到：

[测试链表是否有循环的最佳算法](https://stackoverflow.com/questions/34249/best-algorithm-to-test-if-a-linked-list-has-a-cycle)

这假设您知道列表中对象的结构，并且可以跟踪每个对象中包含的所有指针。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-05-26T18:20:46.173

您可能需要像[Mark and Sweep](http://www.geeksforgeeks.org/mark-and-sweep-garbage-collection-algorithm/)这样的垃圾收集器技术。该算法的思想是：

1.  保留一个列表，其中包含对分配的所有内存块的引用。
2.  在某些时候你启动垃圾收集器：
    1.  它首先标记它仍然可以在不使用引用列表的情况下访问的所有块。
    2.  它通过列表擦除每个无法标记的项目，这意味着它不再可访问，因此它没有用。

由于您正在使用`shared_ptr`任何仍然存在的指针，因此您无法到达应该被视为循环的成员。

### 执行

下面我描述一个非常幼稚的例子，说明如何实现`sweep()`部分算法，但是它将`reset()`所有剩余的指针放在收集器上。

此代码存储`shared_ptr<Cycle_t>`指针。该类`Collector`负责跟踪所有指针并在`sweep()`执行时将其删除。

```
#include <vector>
#include <memory>

class Cycle_t;
typedef std::shared_ptr<Cycle_t> Ref_t;

// struct Cycle;
struct Cycle_t {
  Ref_t cycle;

  Cycle_t() {}
  Cycle_t(Ref_t cycle) : cycle(cycle) {}
};

struct collector {
  // Note this vector will grow endlessy.
  // You should find a way to reuse old links
  std::vector<std::weak_ptr<Cycle_t>> memory;

  // Allocate a shared pointer keeping
  // a weak ref on the memory vector:
  inline Ref_t add(Ref_t ref) {
    memory.emplace_back(ref);
    return ref;
  }
  inline Ref_t add(Cycle_t value) {
    Ref_t ref = std::make_shared<Cycle_t>(value);
    return add(ref);
  }
  inline Ref_t add() {
    Ref_t ref = std::make_shared<Cycle_t>();
    return add(ref);
  }

  void sweep() {
    // Run a sweep algorithm:
    for (auto& ref : memory) {
      // If the original shared_ptr still exists:
      if (auto ptr = ref.lock()) {
        // Reset each pointer contained within it:
        ptr->cycle.reset();

        // Doing this will trigger a deallocation cascade, since
        // the pointer it used to reference will now lose its
        // last reference and be deleted by the reference counting
        // system.
        //
        // The `ptr` pointer will not be deletd on the cascade
        // because we still have at least the current reference
        // to it.
      }
      // When we leave the loop `ptr` loses its last reference
      // and should be deleted.
    }
  }
}; 
```

然后你可以像这样使用它：

```
Collector collector;

int main() {
  // Build your shared pointers:
  {
    // Allocate them using the collector:
    Ref_t c1 = collector.add();
    Ref_t c2 = collector.add(c1);

    // Then create the cycle:
    c1.get()->cycle = c2;

    // A normal block with no cycles:
    Ref_t c3 = collector.add();
  }

  // In another scope:
  {
    // Note: if you run sweep an you still have an existing
    // reference to one of the pointers in the collector
    // you will lose it since it will be reset().
    collector.sweep();
  }
} 
```

我用 Valgrind 对其进行了测试，没有列出内存泄漏或“仍然可访问”的块，因此它可能按预期工作。

关于此实现的一些注意事项：

1.  内存向量会无限增长，你应该使用[一些内存分配技术](https://www.tutorialspoint.com/operating_system/os_memory_allocation_qa2.htm)来确保它不会占用你所有的工作内存。
2.  有人可能会争辩说，没有必要使用`shared_ptr`（其工作方式类似于引用计数 GC）来实现这样的垃圾收集器，因为标记和清除算法已经完成了这项工作。
3.  我没有实现 mark() 函数，因为它会使示例复杂化，但这是可能的，我将在下面解释。

最后，如果您关心（2），这种实现并非闻所未闻。CPython（Python 的主要实现）确实使用了引用计数和标记和扫描的混合，但主要是出于[历史原因](https://stackoverflow.com/questions/9062209/why-does-python-use-both-reference-counting-and-mark-and-sweep-for-gc)。

### 实现`mark()`功能：

要实现该`mark()`功能，您需要进行一些修改：

需要向 中添加一个`bool marked;`属性`Cycle_t`，并使用它来检查指针是否被标记。

您将需要编写如下所示的`Collector::mark()`函数：

```
void mark(Ref_t root) {
  root->marked = true;

  // For each other Ref_t stored on root:
  for (Ref_t& item : root) {
    mark(item);
  }
} 
```

然后你应该修改`sweep()`函数以删除标记，如果指针被标记，否则`reset()`指针：

```
void sweep() {
  // Run a sweep algorithm:
  for (auto& ref : memory) {
    // If it still exists:
    if (auto ptr = ref.lock()) {
      // And is marked:
      if (ptr->marked) {
        ptr->marked = false;
      } else {
        ptr->cycle.reset();
      }
    }
  }
} 
```

这是一个冗长的解释，但我希望它对某人有所帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-04T19:31:52.960

回答老问题，您可以尝试使用侵入式指针，这可能有助于计算资源被引用的次数。

```
#include <cstdlib>
#include <iostream>

#include <boost/intrusive_ptr.hpp>

class some_resource
{
    size_t m_counter;

public:
    some_resource(void) :
        m_counter(0)
    {
        std::cout << "Resource created" << std::endl;
    }

    ~some_resource(void)
    {
        std::cout << "Resource destroyed" << std::endl;
    }

    size_t refcnt(void)
    {
        return m_counter;
    }

    void ref(void)
    {
        m_counter++;
    }

    void unref(void)
    {
        m_counter--;
    }
};

void
intrusive_ptr_add_ref(some_resource* r)
{
    r->ref();
    std::cout << "Resource referenced: " << r->refcnt()
              << std::endl;
}

void
intrusive_ptr_release(some_resource* r)
{
    r->unref();
    std::cout << "Resource unreferenced: " << r->refcnt()
              << std::endl;
    if (r->refcnt() == 0)
        delete r;
}

int main(void)
{
    boost::intrusive_ptr<some_resource> r(new some_resource);
    boost::intrusive_ptr<some_resource> r2(r);

    std::cout << "Program exiting" << std::endl;

    return EXIT_SUCCESS;
} 
```

这是返回的结果。

```
Resource created 
Resource referenced: 1 
Resource referenced: 2 
Program exiting 
Resource unreferenced: 1
Resource unreferenced: 0 
Resource destroyed
*** Program Exit *** 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-09-20T03:03:25.413

如果你有带有共享指针的 Cycles，你将会有内存泄漏。因此，如果您转储内存泄漏对象，您可以查看这些类型以找到实际循环。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-10-20T14:28:08.407

我认为您确实在要求[诸如 Java 的垃圾收集之类的东西](https://stackoverflow.com/q/1910194/111307)。[这个问题](https://stackoverflow.com/questions/34373460/feasibility-of-automatic-cycle-breaker-for-stdshared-ptr)讨论了一个“自动循环断路器” `shared_ptr`。

你*可以*在你的程序中有`shared_ptr`循环并让每个对象释放，但这违背了流行的建议。流行的建议是[通过使用](https://ddanilov.me/shared-ptr-is-evil/#reference-cycles)参与循环的对象之一来[打破循环。`shared_ptr``weak_ptr`](https://ddanilov.me/shared-ptr-is-evil/#reference-cycles)

如果你坚持`shared_ptr`在你的程序中保留一个循环，你仍然可以这样做，但你必须在销毁时*手动*打破循环。`shared_ptr`

这很像记住手动调用`delete`一个对象，所以你可以看到为什么不推荐它。

```
struct B;

struct A {
    shared_ptr<B> b;
    void prepForShutdown() {
        b = nullptr; // unlink from b.
    }
    ~A() { puts("~A"); }
};

struct B {
    shared_ptr<A> a;
    ~B() { puts("~B"); }
};

int main() {
    shared_ptr<A> a = make_shared<A>();
    shared_ptr<B> b = make_shared<B>();
    a->b = b;
    b->a = a;

    a->prepForShutdown();  // Break the cycle
    // Without this, either dtor cannot run, because A holds a reference 
    // to b and B holds a reference to A.

    a = nullptr;
    b = nullptr;

} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-04-22T14:05:21.150

我知道你说“没有weak_ptr”，但为什么不呢？让你的头与一个weak_ptr 到尾巴，以及与一个weak_ptr 到头的尾巴将防止循环。

# resources - 让您了解 Microsoft 技术的最重要信息资源？

> ID：776059
> 
> 赞同：0
> 
> 时间：2009-04-22T07:41:25.177
> 
> 标签：resources

我正在寻找一种信息资源（首选 RSS）来了解 Microsoft 的最新动态。对我来说，这将包括软件版本、服务包、MS 研究项目、API、商业新闻，可能还有很多我什至不知道存在的东西。

有没有类似的东西，或者我必须从第一原理中收集这些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T08:45:21.140

我不认为你会找到一个 RSS 来统治他们，可以这么说 ;)，但[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/default.aspx)肯定会让你了解 MS 发生的事情的脉搏，因为他积极参与了很多 M$的项目自然知道，还有很多其他MS产品的博客。

恕我直言，ScottGu 的博客对于任何开发人员来说都是必不可少的阅读材料。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T07:48:43.710

我也发现很难找到一个这样的资源。我通过关注瑞典的开发人员布道者的 RSS 获得了我的大部分信息（我会说足够快）。他们通常能很快地传达相关新闻。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T07:52:37.757

我目前正在使用 Google Reader 处理相同的问题，收集来自公司各地的各种开发人员和团队博客。我还跟进了一些似乎与公司未来技术战略相关的 CodePlex 项目。

MSDN 也不错，但并不总是最新的。

# python - django 中的“生成器对象”是什么？

> ID：776060
> 
> 赞同：5
> 
> 时间：2009-04-22T07:41:35.427
> 
> 标签：python, generator

我正在使用 Django 投票包，当我在 shell 中使用 get_top() 方法时，它返回类似**“0x022f7AD0 处的生成器对象**，我以前从未见过这样的东西，你如何访问它，它是什么？

我的代码：

```
v=Vote.objects.get_top(myModel, limit=10, reversed=False)
print v
<generator object at 0x022f7AD0> 
```

注意：我认为**get_top**只会返回一个不错的 myModel 列表，我可以执行类似**v.name**等的操作

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-22T07:55:01.230

如果你想要一个列表，只需在你的生成器对象上调用 list() 。

python 中的生成器对象类似于惰性列表。只有在您迭代它们时才会评估这些元素。（因此它的调用列表会评估所有这些。）

例如，您可以这样做：

```
>>> def f(x):
...  print "yay!"
...  return 2 * x
>>> g = (f(i) for i in xrange(3))    # generator comprehension syntax
>>> g
<generator object <genexpr> at 0x37b6c0>

>>> for j in g: print j
... 
yay!
0
yay!
2
yay!
4 
```

仅在迭代 f 时查看 f 是如何评估的。您可以在此处找到有关该主题的优秀材料：[http ://www.dabeaz.com/generators/](http://www.dabeaz.com/generators/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-22T08:11:20.923

生成器是一种迭代器。迭代器是一种可迭代对象，与任何其他可迭代对象一样，

您可以使用 for 循环遍历每个项目：

```
for vote in Vote.objects.get_top(myModel, limit=10, reversed=False):
    print v.name, vote 
```

如果需要按索引访问项目，可以将其转换为列表：

```
top_votes = list(Vote.objects.get_top(myModel, limit=10, reversed=False))
print top_votes[0] 
```

但是，您只能对迭代器的特定实例进行一次迭代（与更通用的可迭代对象不同，如列表）：

```
>>> top_votes_generator = Vote.objects.get_top(myModel, limit=3)
>>> top_votes_generator
<generator object at 0x022f7AD0>
>>> list(top_votes_generator)
[<Vote: a>, <Vote: b>, <Vote: c>]
>>> list(top_votes_generator)
[] 
```

有关创建自己的生成器的更多信息，请参阅[http://docs.python.org/tutorial/classes.html#generators](http://docs.python.org/tutorial/classes.html#generators)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T08:10:28.523

嗯嗯

我已经阅读[了这个](http://www.dalkescientific.com/writings/NBN/generators.html)和[这个](http://www.neotitans.com/resources/python/python-generators-tutorial.html)，现在事情已经很清楚了；

实际上我可以通过做将生成器转换为列表

```
mylist=list(myGenerator) 
```

# sql - SQL 全文搜索

> ID：776061
> 
> 赞同：0
> 
> 时间：2009-04-22T07:41:47.827
> 
> 标签：sql, sql-server, full-text-search

我已经在 SQL Server 2008 express 中设置了全文搜索功能。这就是我所做的：

```
-- STEP 1: Create catalog
create fulltext catalog HtmlSearch

-- STEP 2: Fill catalog
create fulltext index on docs
(WordHtml)
key index IX_docs_1
on HtmlSearch
with change_tracking auto

-- STEP 3: Search
select * from docs
where freetext(*, 'beleid') 
```

表格文档有一行，其中字段 WordHtml 具有 (html) 内容。当我执行第 3 步时，什么也没有发生。我确信 html 文档中存在“beleid”一词。查询结果为 0 条记录。那么我做错了什么？我是否必须在某个地方配置该字段为 Html？所以，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-14T13:29:26.957

一个类似的查询在我拥有的数据库上工作，所以我会看看设置。以下是您可以尝试的一些事情：

无论如何，该索引现在似乎对您没有任何好处，所以我会放弃它并尝试重新创建它。我只熟悉 2005，但你使用的语法看起来不像我的。你可以试试（适当滴后）

```
CREATE FULLTEXT Catalog HtmlSearch AS DEFAULT;

GO

CREATE FULLTEXT INDEX ON docs
( WordHtml Language English )
KEY INDEX IX_docs_1
WITH CHANGE_TRACKING auto;

GO 
```

我假设 WordHtml 是您要索引的列的名称。如果是这样，那么这与我在 2005 年所做的一致。

接下来，您可以尝试显式填充全文索引。这可能不是必需的，但我总是在创建全文索引后这样做。

```
ALTER FULLTEXT INDEX ON docs
START FULL POPULATION;

GO 
```

# wpf - Silverlight WPF 应用程序中的 SetTop 问题

> ID：776063
> 
> 赞同：0
> 
> 时间：2009-04-22T07:43:47.980
> 
> 标签：wpf, silverlight

我无法在 Silverlight 应用程序中使用 SetTop 属性 Canvas。以下是重现问题的最少代码

```
from System import TimeSpan
from System.Windows import Application, Duration, PropertyPath
from System.Windows.Controls import Canvas, TextBlock
from System.Windows.Media import SolidColorBrush, Colors
from System.Windows.Media.Animation import (
    DoubleAnimation, Storyboard, RepeatBehavior
)

root = Canvas()

root.Children.Clear()
root.Resources.Clear()
#root.Background = SolidColorBrush(Colors.Black)

parent = Canvas(Width = 100, Height = 100)
parent.Background = SolidColorBrush(Colors.Black)
parent.SetTop(root, 0)
parent.SetLeft(root, 0)

parent2 = Canvas(Width = 100, Height = 100)
parent2.Background = SolidColorBrush(Colors.Blue)
parent2.SetTop(root, 100)

root.Children.Add(parent)

Application.Current.RootVisual = root 
```

* * *

“parent2.SetTop(root, 100)” 行改变了 parent1 的显示位置。

这种行为令人惊讶。我什至没有将 parent2 添加为子对象之一，但它仍在影响布局。

有人可以解释我做错了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T07:53:12.217

我认为您正在“向后”使用 SetTop。SetTop 在 Canvas 的子控件上设置附加属性，这样做：

```
parent2.SetTop(root,100) 
```

**将根**的 Canvas.Top 属性设置为 100（不是 parent2）（因此也会移动根的所有子项）。你应该做的是：

```
root.SetTop(parent, 0) 
```

这会将父级的 Canvas.Top 属性设置为 0。

[有关MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.settop.aspx)的更多信息。

# linux - 惊喜！shell 建议使用命令行开关

> ID：776071
> 
> 赞同：16
> 
> 时间：2009-04-22T07:48:38.450
> 
> 标签：linux, bash, shell, command-line

我注意到 bash shell 可以为您的命令建议命令行开关。

只需键入您的命令、破折号 (-) 并键入选项卡。shell 将显示可用的开关。

例如，尝试：

```
andy@andyx:~$ java - 
```

并按标签 - 惊喜！

![截屏](https://i.stack.imgur.com/TYqIS.png)

问题是：

**如何与此功能交互。即，如果我编写一个要从控制台运行的程序，那么告诉 shell 哪些开关可用的 API 是什么？**

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-22T07:51:07.883

您已经发现了 Bash 的[可编程完成](http://www.gnu.org/software/bash/manual/bashref.html#Programmable-Completion)功能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T07:53:18.223

看：

```
$ man bash 
```

特别是，标题为“READLINE”的部分和“Programmable Completion”小节

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-25T15:50:52.140

仅供参考：在 Ubuntu 和/或 Debian 中，脚本位于 /etc/bash_completion.d/

# assemblies - 在 C# 中获取已发布的 XBAP 版本

> ID：776074
> 
> 赞同：2
> 
> 时间：2009-04-22T07:49:53.377
> 
> 标签：assemblies, version, xbap

我目前在本地机器上发布了一个 XBAP，它在 XMAL 中构建了一个“关于”画布，我想显示发布的版本号，但我似乎只能获得程序集版本号。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-26T14:57:14.593

首先确保将以下程序集添加到项目引用中：System.Deployment。然后您可以像这样访问当前版本：

```
using System.Deployment.Application;

... 

if (ApplicationDeployment.IsNetworkDeployed)
    VersionTextBlock.Text = 
       ApplicationDeployment.CurrentDeployment.CurrentVersion.ToString(); 
```

`CurrentDeployment`在本地调试时为 null，因此您`IsNetworkDeployed`只能在从发布位置运行时检索版本信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-24T18:23:39.837

使用 .NET 3.0 我正在使用

`Version ver = System.Reflection.Assembly.GetExecutingAssembly().GetName().Version;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T08:25:01.337

我见过某处说要使用：

System.Deployment.ApplicationDeployment.CurrentVersion

但是当使用 System.Deployment 时，似乎没有 System.Deployment.ApplicationDeployment 可供访问！

这可能不是一个解决方案，但可能指向正确的方向。如果有人已经使用它，也许他们可以对此事有更多的了解。

# .net - 如何在 .NET（Excel 插件）中捕获 OutOfMemoryException

> ID：776080
> 
> 赞同：3
> 
> 时间：2009-04-22T07:52:02.843
> 
> 标签：.net, out-of-memory

我的 .net 插件中出现 OutOfMemory 异常。该插件正在使用大量托管和非托管对象。有没有办法捕获这个异常？

更新：我认为任何应用程序如果处理大量需要处理且不定期释放的数据，都会出现 OutofMemory 异常。假设我有一种方法可以分析内存中的某些结构。我给它 300 个结构，它将每个结构加载到内存中，分析它们并完成处理。在这个操作中，内存使用量是 X。现在如果我给它处理 3000 个结构，它将分析内存中的 3000 个结构，内存使用量将达到 10X。

**更新**

这个问题只出现在 Excel 2007 中，而不出现在 Excel 2003 中，这就是为什么我要求 MSDN 人员调查它的原因。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T08:02:11.010

在 .Net 中，当运行时无法为您的应用程序分配请求的内存时，它会抛出 OutOfMemoryException。因此，处理此类异常的实际工作很少。

而不是抓住它，你应该首先防止它发生。忽略异常不会使问题消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T08:02:40.117

如果你得到一个 OutOfMemoryException，你的程序已经死亡、不复存在、被传递，它不再存在并且已经去见它的制造者了。

但严重的是，它无法恢复一些已用完的内存，因此您无能为力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T13:56:13.153

它可能是垃圾收集器让你。尝试定期强制收集。

如果这没有帮助，请阅读：[http ://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/](http://www.simple-talk.com/dotnet/.net-framework/the-dangers-of-the-large-object-heap/)

# asp.net - 单击 MasterPage 中的链接按钮时出错

> ID：776099
> 
> 赞同：0
> 
> 时间：2009-04-22T07:56:46.293
> 
> 标签：asp.net, vb.net

我收到以下错误。视图状态 MAC 验证失败。如果此应用程序由 Web Farm 或集群托管，请确保配置指定相同的 validationKey 和验证算法。AutoGenerate 不能在集群中使用。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

异常详细信息：System.Web.HttpException：视图状态 MAC 验证失败。如果此应用程序由 Web Farm 或集群托管，请确保配置指定相同的 validationKey 和验证算法。AutoGenerate 不能在集群中使用。

源错误：

生成此未处理异常的源代码只能在调试模式下编译时显示。要启用此功能，请按照以下步骤之一，然后请求 URL：

1.  在产生错误的文件顶部添加“Debug=true”指令。例子：

或者：

2) 将以下部分添加到应用程序的配置文件中：

请注意，第二种技术将导致给定应用程序中的所有文件都以调试模式编译。第一种技术将导致仅在调试模式下编译该特定文件。

重要提示：在调试模式下运行应用程序确实会产生内存/性能开销。在部署到生产场景之前，您应该确保应用程序已禁用调试。

堆栈跟踪：

[HttpException (0x80004005): 无法验证数据。] System.Web.Configuration.MachineKeySection.GetDecodedData(Byte[] buf, Byte[] 修饰符, Int32 start, Int32 length, Int32& dataLength) +2546780 System.Web.UI.ObjectStateFormatter .Deserialize（字符串输入字符串）+214

[ViewStateException：无效的视图状态。Client IP: 127.0.0.1 Port: User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2; .NET CLR 2.0.50727) ViewState: 9xQG6dYJ5zq2jCqMiucYRNTojwFlEGYjCH2OQX2PsmFzIZhHtD11AD5JBQmMuoIw105QqG46Ew4o8mVXLBG+T9hl2qqjTTQ/jlivQHaLBjR/cojc5VTk2aZUCmDSZBt/z1yzV8kJLFYrNmIkKAztL+ eeZho/zZmCVfRAIcCyhIc=Referer：[http://localhost:1124/Login/ApproveAppointments.aspx](http://localhost:1124/Login/ApproveAppointments.aspx) 路径：/Login/ApproveAppointments.aspx]

[HttpException (0x80004005)：视图状态 MAC 验证失败。如果此应用程序由 Web Farm 或集群托管，请确保配置指定相同的 validationKey 和验证算法。AutoGenerate 不能在集群中使用。] System.Web.UI.ViewStateException.ThrowError(Exception inner, String persistedState, String errorPageMes​​sage, Boolean macValidationError) +116 System.Web.UI.ObjectStateFormatter.Deserialize(String inputString) +251 System. Web.UI.ObjectStateFormatter.System.Web.UI.IStateFormatter.Deserialize(String serializedState) +4 System.Web.UI.Util.DeserializeWithAssert(IStateFormatter formatter, String serializedState) +37 System.Web.UI.HiddenFieldPageStatePersister.Load() +220 System.Web.UI.Page.LoadPageStateFromPersistenceMedium() +83 System.Web.UI.Page.LoadAllState() +35 System.Web.UI。

我尝试了源错误中给出的代码。但无法解决。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-22T09:41:03.813

确保您在集群中所有机器上的 web.configs 中放置了相同的机器密钥，例如

```
<machineKey validationKey="AAABBBCCCDDD111222333444AAABBBCCCDDD111222333444AAABBBCCCDDD111222333444" decryptionKey="AAABBBCCCDDD111222333444" validation="SHA1"/> 
```

# latex - 高级 LaTeX 教程/书籍

> ID：776102
> 
> 赞同：7
> 
> 时间：2009-04-22T07:58:53.187
> 
> 标签：latex

我已经使用 LaTeX 大约 3-4 年了。在那段时间里，我得到了我需要的东西，最常见的是谷歌搜索。但是，我想学习 LaTeX 的一些更高级的功能，例如编辑甚至创建我自己的类文件和 bibtex 样式。我以前使用过一些相当强大的类文件，但我很难理解语法，因为它相当晦涩。

有谁知道我可以用来学习 LaTeX 的这些高级功能的好教程（或书）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-22T13:54:14.720

对于真正高级的东西，没有什么能比描述 LaTeX 类本身的[dtx 文件更好。](http://www.tex.ac.uk/cgi-bin/texfaq2html?label=dtx)你的 TeX 发行版可能没有发货，所以从 CTAN 获取它们；dtx 文件在安装之前通常会去掉注释，但您可以使用 LaTeX 编译它们以使注释和代码很好地排版。

[TUGboat](http://www.tug.org/TUGboat/)也有一些高级文章。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-22T08:06:23.120

看看[LaTeX Companion](https://rads.stackoverflow.com/amzn/click/com/0321514432)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-22T09:25:38.233

看看这些问题的答案：

*   [LaTeX 的最佳实践](https://stackoverflow.com/questions/193298/best-practices-in-latex)
*   [学习 LaTeX 基础知识的最快方法是什么？](https://stackoverflow.com/questions/109371/what-is-the-fastest-way-to-learn-latex-basics)（尤其是[第二个答案](https://stackoverflow.com/questions/109371/what-is-the-fastest-way-to-learn-latex-basics/109682#109682)有一些很好的参考）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-12T09:02:55.670

这些年来，我一直在使用几本书，

1.  Helmut Kopka 和 Patrick W. Daly 的 LaTeX 指南
2.  由 Frank Mittelbach、Michel Goossens、Johannes Braams 和 David Carlisle 撰写的 LaTeX Companion（计算机排版工具和技术）

和经典

1.  LaTeX：Leslie Lamport 的文档准备系统

还，

1.  [http://www.ctan.org/tex-archive/info/lshort/english/](http://www.ctan.org/tex-archive/info/lshort/english/)上的软书是一本中等不错的书。

此外，如上所述，当您开始使用新的样式文件时，请养成阅读 dtx 文件的习惯。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-16T08:28:33.990

[Wikibook](http://en.wikibooks.org/wiki/Latex)中涵盖了其中一些高级主题。还有[对 LaTeX2e 的（不是这样）简短介绍](http://tobi.oetiker.ch/lshort/lshort.pdf)。

# .net - 在vb中获取项目中文件的路径

> ID：776103
> 
> 赞同：2
> 
> 时间：2009-04-22T07:59:07.367
> 
> 标签：.net, vb.net, file-io

我在 vb.net 中运行 Windows 应用程序。我在名为 XmlFiles 的文件夹中有一个名为 mail.xml 的 xml 文件。在 default.aspx.vb 中，我必须获取 mail.xml 的路径。我要编写什么代码来实现它可能的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T08:10:26.293

您可以使用 Path 类的 GetFullPath 静态方法：

```
Dim fileName As string = "myfile.ext"
Dim path1 As string = "mydir"
Dim path2 As string = "\mydir"
Dim fullPath As string

fullPath = Path.GetFullPath(path1)
Console.WriteLine("GetFullPath('{0}') returns '{1}'", _
    path1, fullPath)

fullPath = Path.GetFullPath(fileName)
Console.WriteLine("GetFullPath('{0}') returns '{1}'", _
    fileName, fullPath)

fullPath = Path.GetFullPath(path2)
Console.WriteLine("GetFullPath('{0}') returns '{1}'", _
    path2, fullPath)

' Output is based on your current directory, except
' in the last case, where it is based on the root drive
' GetFullPath('mydir') returns 'C:\temp\Demo\mydir'
' GetFullPath('myfile.ext') returns 'C:\temp\Demo\myfile.ext'
' GetFullPath('\mydir') returns 'C:\mydir' 
```

示例来自[MSDN](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath(VS.80).aspx)。

另一种方法是使用 FileInfo 类的 fullName 属性（继承自 FileSystemInfo），请参见下面的用法：

```
Sub DisplayFileSystemInfoAttributes(ByVal fsi As FileInfo)
    ' Assume that this entry is a file.
    Dim entryType As String = "File"

    ' Determine if this entry is really a directory.
    If fsi.Attributes = FileAttributes.Directory Then
        entryType = "Directory"
    End If

    ' Show this entry's type, name, and creation date.
    Console.WriteLine("{0} entry {1} was created on {2:D}", _
        entryType, **fsi.FullName**, fsi.CreationTime)
End Sub 
```

也来自[MSDN](http://msdn.microsoft.com/en-us/library/system.io.filesysteminfo.fullname.aspx)。

# c# - 在 C# 中将查询字符串转换为字典的最佳方法

> ID：776107
> 
> 赞同：70
> 
> 时间：2009-04-22T08:00:13.073
> 
> 标签：c#

我正在寻找将查询字符串从 HTTP GET 请求转换为字典并再次返回的最简单方法。

我认为一旦查询以字典形式对查询进行各种操作会更容易，但我似乎有很多代码只是为了进行转换。有什么推荐的方法吗？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-04-22T08:04:05.870

`HttpUtility.ParseQueryString()`将查询字符串解析为一个`NameValueCollection`对象，将后者转换`IDictionary<string, string>`为一个简单的`foreach`. 然而，这可能是不必要的，因为`NameValueCollection`它有一个索引器，所以它的行为非常像字典。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-06-17T02:18:33.387

这是我通常的做法

```
Dictionary<string, string> parameters = HttpContext.Current.Request.QueryString.Keys.Cast<string>()
    .ToDictionary(k => k, v => HttpContext.Current.Request.QueryString[v]); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-04-22T08:03:50.520

怎么样[`HttpUtility.ParseQueryString`](http://msdn.microsoft.com/en-us/library/ms150046.aspx)？

只需添加对 System.Web.dll 的引用

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2015-10-30T05:16:17.750

与 Sean 相同，但使用 Linq（以及可以复制和粘贴的功能）：

```
public static Dictionary<string, string> ParseQueryString(string queryString)
{
   var nvc = HttpUtility.ParseQueryString(queryString);
   return nvc.AllKeys.ToDictionary(k => k, k => nvc[k]);
} 
```

此外，问题还询问了如何将其恢复为查询字符串：

```
public static string CreateQueryString(Dictionary<string, string> parameters)
{
   return string.Join("&", parameters.Select(kvp => 
      string.Format("{0}={1}", kvp.Key, HttpUtility.UrlEncode(kvp.Value))));
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-03-14T20:47:40.087

只需为单声道兼容解决方案执行此操作

```
Regex.Matches(queryString, "([^?=&]+)(=([^&]*))?").Cast<Match>().ToDictionary(x => x.Groups[1].Value, x => x.Groups[3].Value) 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2019-01-17T20:20:16.270

在 ASP.NET Core 中，使用[ParseQuery](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.webutilities.queryhelpers.parsequery)。

```
var query = HttpContext.Request.QueryString.Value;
var queryDictionary = Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(query); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-08-12T14:28:08.107

我喜欢[Jon Canning 答案](https://stackoverflow.com/a/15419842/522150)的简洁性，但为了多样化，这是他答案的另一种选择，它也适用于缺乏`HttpUtility.ParseQueryString()`实用程序的受限环境，如 Windows Phone 8：

```
 public static Dictionary<string, string> ParseQueryString(String query)
    {
        Dictionary<String, String> queryDict = new Dictionary<string, string>();
        foreach (String token in query.TrimStart(new char[] { '?' }).Split(new char[] { '&' }, StringSplitOptions.RemoveEmptyEntries))
        {
            string[] parts = token.Split(new char[] { '=' }, StringSplitOptions.RemoveEmptyEntries);
            if (parts.Length == 2)
                queryDict[parts[0].Trim()] = HttpUtility.UrlDecode(parts[1]).Trim();
            else
                queryDict[parts[0].Trim()] = "";
        }
        return queryDict;
    } 
```

实际上，对处理 url 编码值（如上述解决方案）进行解码的 Canning 答案的一个有用改进是：

```
 public static Dictionary<string, string> ParseQueryString2(String query)
    {
       return Regex.Matches(query, "([^?=&]+)(=([^&]*))?").Cast<Match>().ToDictionary(x => x.Groups[1].Value, x => HttpUtility.UrlDecode( x.Groups[3].Value ));
    } 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-10-11T00:22:25.460

一个没有 HttpUtility 的班轮

```
var dictionary = query.Replace("?", "").Split('&').ToDictionary(x => x.Split('=')[0], x => x.Split('=')[1]); 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-01-08T21:12:32.957

还有另一种方法：

```
NameValueCollection nvcData = HttpUtility.ParseQueryString(queryString);
Dictionary<string, string> dictData = new Dictionary<string, string>(nvcData.Count);
foreach (string key in nvcData.AllKeys)
{
    dictData.Add(key, nvcData.Get(key));
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-12-05T02:07:08.160

最简单的：

```
Dictionary<string, string> parameters = new Dictionary<string, string>();

for (int i = 0; i < context.Request.QueryString.Count; i++)
{
    parameters.Add(context.Request.QueryString.GetKey(i), context.Request.QueryString[i]);
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-02-09T22:06:19.947

您可以通过使用`FromQueryAttribute`

```
public void Action([FromQuery] Dictionary<string, string> queries)
{
    ...
} 
```

PS如果您想为每个键获取多个值，您可以将字典更改为`Dictionary<string, List<string>>`

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-01-24T16:34:10.767

而不是*转换* `HttpContext.Request.QueryString`为`Dictionary<>`，尝试使用

```
HttpContext.Request.Query 
```

这已经是一个`Dictionary<string, StringValues>`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-01-07T11:53:06.667

我在为 Azure WebJob 寻找相同的解决方案时偶然发现了这篇文章，希望这可以帮助其他人做同样的事情。

如果要编写 Azure WebJob，则使用`GetQueryParameterDictionary()`扩展方法。

```
var queryParameterDictionary = request.GetQueryParameterDictionary(); 
```

其中*request*是 type`HttpRequest`并且*queryParameterDictionary* 现在是 type`IDictionary<string, string>`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-05-21T15:02:44.710

AspNet Core 现在自动包含可用于类似于具有键访问器的字典的内容。`[HttpRequest](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httprequest).[Query](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.httprequest.query)`

但是，如果您需要将其转换为日志记录或其他目的，您可以将该逻辑提取到扩展方法中，如下所示：

```
public static class HttpRequestExtensions
{
  public static Dictionary<string, string> ToDictionary(this IQueryCollection query)
  {
    return query.Keys.ToDictionary(k => k, v => (string)query[v]);
  }
} 
```

然后，您可以像这样在 httpRequest 上使用它：

```
var params = httpRequest.Query.ToDictionary() 
```

* * *

**延伸阅读**

*   [如何将查询字符串解析为 .NET 中的 NameValueCollection](https://stackoverflow.com/q/68624/1366033)
*   [在.Net中将查询字符串转换为键值对](https://stackoverflow.com/q/9669839/1366033)
*   [是否可以从查询字符串中获取字典？](https://stackoverflow.com/q/22707788/1366033)

# asp.net - 通过邮件发送 HTML 元素

> ID：776109
> 
> 赞同：1
> 
> 时间：2009-04-22T08:00:56.580
> 
> 标签：asp.net

我想通过单击链接打开邮件客户端。我正在使用这段代码：

System.Diagnostics.Process.Start("mailto:email address?subject=[subject text]&body=http://google.com'>here");

它打开邮件客户端，但我无法获得链接（此处）。它应该作为链接出现。有没有办法通过 IsBodyHtml=true 来做到这一点？任何人都可以帮忙吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T08:06:46.567

您所做的只是创建一个 mailto: 链接，该链接刚刚传递给默认电子邮件客户端进行处理。尽管大多数电子邮件客户端都支持地址、主题和正文，但我认为没有任何方法可以强制使用特定的正文格式，这完全取决于客户端应用程序对该内容的处理方式。

将其更改为“请访问[http://google.com](http://google.com) ”还不够吗？大多数电子邮件客户端会在您阅读电子邮件时自动超链接任何看起来像链接的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T08:23:28.460

如果要打开用户默认的邮件客户端，只需使用 mailto 链接

```
<a href="mailto:asdf@asdf.com">text</a> 
```

我真的不明白您在何时何地运行“Proccess.Start”代码，但如果您想通过浏览器打开一个邮件客户端，一个“mailto”链接是要走的路。

您可以为打开的电子邮件设置主题，但仅此而已（取决于默认邮件客户端）。做更多像发送等将是一个安全风险。

如果您需要做更复杂的事情，请创建一个表单供用户填写。

# python - 如何使用 YouTube API 从 YouTubeVideoFeed 对象获取公共频道 URL？

> ID：776110
> 
> 赞同：1
> 
> 时间：2009-04-22T08:01:09.140
> 
> 标签：python, youtube, feed, youtube-api

我正在使用 Python 版本的 YouTube API 来获取使用以下 URL 的 YouTubeVideoFeed 对象：

> [http://gdata.youtube.com/feeds/api/users/USERNAME/uploads](http://gdata.youtube.com/feeds/api/users/USERNAME/uploads)

*注意：我已将 USERNAME 替换为我需要关注的帐户。*

到目前为止，获取提要、迭代条目、获取玩家网址、标题和缩略图都非常简单。但现在我想在页面上添加一个“访问频道”链接。我不知道如何从提要中获取频道的“公共”URL（在这种情况下，是用户的默认频道）。据我所知，直接存储在提要中的唯一 URL 指向的是`http://gdata.youtube.com/`，*而不是*公共站点。

如何根据提要链接到频道？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T18:09:41.487

好吧，如果您想自己构建 URL，则 youtube.com/user/USERNAME 是一个非常安全的选择，但我认为您想要的是链接 rel='alternate'

您必须从提要中获取链接数组并迭代以找到替代项，然后获取 href

就像是：

```
client = gdata.youtube.service.YouTubeService()

feed = client.GetYouTubeVideoFeed('http://gdata.youtube.com/feeds/api/users/username/uploads')

for link in feed.link:
  if link.rel == 'alternate':
    print link.href 
```

输出：

[http://www.youtube.com/profile_videos?user=username](http://www.youtube.com/profile_videos?user=username)

最正确的做法是从用户个人资料提要中获取“备用”链接，因为从技术上讲，上述 URL 指向上传的视频，而不是主频道页面

```
feed = client.GetYouTubeUserEntry('http://gdata.youtube.com/feeds/api/users/username')

for link in feed.link:
  if link.rel == 'alternate':
    print link.href 
```

输出： [http ://www.youtube.com/profile?user=username](http://www.youtube.com/profile?user=username)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T08:29:51.847

你可能会混淆用户名......当我使用我的用户名时，我会看到我的公共页面 [http://gdata.youtube.com/feeds/api/users/drdredel/uploads](http://gdata.youtube.com/feeds/api/users/drdredel/uploads) 他们在你的 gmail 用户名和你的 youtube 用户名之间有一些古怪的区别. 还是我误解了你的问题？

# http - 如果我有多个 REST api 版本，那么默认版本应该是什么？

> ID：776113
> 
> 赞同：1
> 
> 时间：2009-04-22T08:02:14.893
> 
> 标签：http, rest

我有一个 REST api，它将通过自定义 HTTP 标头或请求参数接受一个版本。我这样做是因为我不希望 URI 包含 del.icio.us 之类的版本。例如**[http://server/api/v1/](http://server/api/v1/) ...**

现在在我的设计中，HTTP 标头的优先级高于请求参数。如果用户根本不提供任何版本会发生什么？我应该默认使用最旧的版本，还是默认使用最新版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T08:08:27.763

为什么不简单地制作所需的版本并在它不存在时抛出错误？

如果这不是一个选项，那么您必须使用最旧的版本，否则如果您升级并且不保持向后兼容性，您将破坏现有客户端。

当然，如果您不介意破坏现有客户端，则使用最新版本可能更方便。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T20:16:35.643

根本不要版本化 URI。相反，只需对表示进行版本化。这样，客户端可以决定他们想要使用哪个版本的 API，并且可以很好地降级。

例子：

```
GET /contacts/3 HTTP/1.1
Accept: application/myapp-v2+xml

HTTP/1.1 200 OK
Content-Type: application/myapp-v2+xml 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T22:33:28.983

如果您的 API 定义了用于访问资源的特定 URI 或 URI 命名约定，则您的 API 不是 RESTful。URI 构造的版本控制对于任何 REST API 来说都不是问题。请参阅[http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)了解更多信息。

# python - 多个同时网络连接 - Telnet 服务器，Python

> ID：776120
> 
> 赞同：16
> 
> 时间：2009-04-22T08:03:44.983
> 
> 标签：python, sockets, telnet

我目前正在用 Python 编写一个 telnet 服务器。它是一个内容服务器。人们将通过 telnet 连接到服务器，并呈现纯文本内容。

我的问题是服务器显然需要支持多个同时连接。我现在的当前实现只支持一个。

这是我开始使用的基本概念验证服务器（虽然程序随着时间的推移发生了很大变化，但基本的 telnet 框架没有）：

```
import socket, os

class Server:
    def __init__(self):
        self.host, self.port = 'localhost', 50000
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.socket.bind((self.host, self.port))

    def send(self, msg):
        if type(msg) == str: self.conn.send(msg + end)
        elif type(msg) == list or tuple: self.conn.send('\n'.join(msg) + end)

    def recv(self):
        self.conn.recv(4096).strip()

    def exit(self):
        self.send('Disconnecting you...'); self.conn.close(); self.run()
        # closing a connection, opening a new one

    # main runtime
    def run(self):
        self.socket.listen(1)
        self.conn, self.addr = self.socket.accept()
        # there would be more activity here
        # i.e.: sending things to the connection we just made

S = Server()
S.run() 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-22T11:54:36.097

在[twisted](http://twistedmatrix.com/)中实现：

```
from twisted.internet.protocol import Factory, Protocol
from twisted.internet import reactor

class SendContent(Protocol):
    def connectionMade(self):
        self.transport.write(self.factory.text)
        self.transport.loseConnection()

class SendContentFactory(Factory):
    protocol = SendContent
    def __init__(self, text=None):
        if text is None:
            text = """Hello, how are you my friend? Feeling fine? Good!"""
        self.text = text

reactor.listenTCP(50000, SendContentFactory())
reactor.run() 
```

测试：

```
$ telnet localhost 50000
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
Hello, how are you my friend? Feeling fine? Good!
Connection closed by foreign host. 
```

说真的，当涉及到异步网络时，twisted 是要走的路。它以单线程单进程方法处理多个连接。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T08:16:13.940

您需要某种形式的异步套接字 IO。看看[这个解释](http://squirl.nightmare.com/medusa/async_sockets.html)，它讨论了低级套接字术语的概念，以及用 Python 实现的相关示例。那应该为您指明正确的方向。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-03-07T17:47:24.277

回复晚了，但唯一的答案是 Twisted 或线程（哎哟），我想为 MiniBoa 添加一个答案。

[http://code.google.com/p/miniboa/](http://code.google.com/p/miniboa/)

Twisted 很棒，但它是一个相当大的野兽，可能不是单线程异步 Telnet 编程的最佳介绍。MiniBoa 是一个轻量级的异步单线程 Python Telnet 实现，最初是为 mud 设计的，非常适合 OP 的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-22T09:10:38.113

为了真正轻松取胜，使用 SocketServer 和 SocketServer.ThreadingMixIn 实现您的解决方案

看看这个回显服务器示例，它看起来与您正在做的事情非常相似：[http ://www.oreillynet.com/onlamp/blog/2007/12/pymotw_socketserver.html](http://www.oreillynet.com/onlamp/blog/2007/12/pymotw_socketserver.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T08:06:46.100

如果您愿意接受一些概念上的挑战，我会考虑使用扭曲的。

作为扭曲的一部分，您的案例应该很容易实现。 [http://twistedmatrix.com/projects/core/documentation/howto/servers.html](http://twistedmatrix.com/projects/core/documentation/howto/servers.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-10T21:53:34.770

Use threading and then add the handler into a function. The thread will call every time a request i made:

Look at this

```
 import socket               # Import socket module
import pygame
import thread
import threading,sys

s = socket.socket()         # Create a socket object
host = socket.gethostname() # Get local machine name
port = 12345                # Reserve a port for your service.
s.bind((host, port))
print ((host, port))
name = ""
users = []

def connection_handler (c, addr):
      print "conn handle"
      a = c.recv (1024)
      if a == "c":
         b = c.recv (1024)
      if a == "o":
         c.send (str(users))
         a = c.recv (1024)
         if a == "c":
            b = c.recv (1024)
      print a,b

s.listen(6)                 # Now wait for client connection.
while True:
   c, addr = s.accept()
   print 'Connect atempt from:', addr[0]
   username = c.recv(1024)
   print "2"
   if username == "END_SERVER_RUBBISH101":
      if addr[0] == "192.168.1.68":
         break
   users.append(username)
   thread.start_new_thread (connection_handler, (c, addr)) #New thread for connection

print 
s.close() 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-22T15:10:49.513

首先，购买 Comer 的[TCP/IP 编程](http://www.cs.purdue.edu/homes/dec/netbooks.html)书籍。

在这些书中，Comer 将为服务器提供几种替代算法。有两种标准方法。

*   每个请求的线程。

*   按请求处理。

您必须选择这两者之一并实施。

在 thread-per 中，每个 telnet 会话都是整个应用程序中的一个单独线程。

在 process-per 中，您将每个 telnet 会话分叉到一个单独的子进程中。

您会发现在 Python 中处理每个请求的过程要容易得多，而且它通常可以更有效地使用您的系统。

Thread-per-request 适用于快速来去匆匆的事情（例如 HTTP 请求）。Telnet 有长时间运行的会话，其中子进程的启动成本不支配性能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-22T12:00:17.677

如果你想用纯python（无扭曲）来做，你需要做一些线程。如果您以前没有看过它，请查看： [http ://heather.cs.ucdavis.edu/~matloff/Python/PyThreads.pdf](http://heather.cs.ucdavis.edu/~matloff/Python/PyThreads.pdf)

第 5/6 页左右是一个*非常*相关的示例；）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-05-08T12:12:46.547

试试 MiniBoa 服务器？它恰好有 0 个依赖项，不需要扭曲或其他东西。MiniBoa 是一个非阻塞异步远程登录服务器，单线程，正是您所需要的。

[http://code.google.com/p/miniboa/](http://code.google.com/p/miniboa/)

# mysql - MySQL是否允许使用点创建数据库？

> ID：776123
> 
> 赞同：27
> 
> 时间：2009-04-22T08:04:38.880
> 
> 标签：mysql, database, naming-conventions

MySQL 是否允许创建`.`名称中带有点 () 的数据库？

我正在使用 MySQL 5.1.22。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-22T08:09:03.520

您不能在数据库名称中使用点。另外，我会避免在任何标识符中使用它。一个常见的约定是改用下划线。它将起到同样的作用，并且会避免很多混乱。如果您**确实**有充分的理由在表或字段名称中使用奇怪的或非法的字符，那么您必须对其进行转义。

要在 MySQL 中转义标识符，请使用反引号：

```
SELECT `select`, `some.field name`, `crazy()naming+here`
FROM `my-=+table` 
```

在我看来，不管是否*需要*，养成对所有字段名称进行反引号的习惯是一种很好的做法，但那是另一回事了。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-04-22T08:11:09.647

您可以[根据文档](http://dev.mysql.com/doc/refman/5.1/en/identifiers.html)`.`在 MySQL 5.1.6 中使用名称。

但是，正如已经说过并将再次说过的那样，*请*不要这样做。对于你认为你现在正在解决的每一个问题，你将创建五个稍后会咬你的问题。自从 。用于限定名称 - 例如`database.table`，否则`table.column`您每次使用时都必须引用您的数据库名称。*

你可以用反引号来做到这一点：

```
CREATE TABLE `do.not.do.this` (col INT); 
```

或者如果您设置以下选项，则使用双引号：

```
SET sql_mode='ANSI_QUOTES';
CREATE TABLE "asking.for.problems" (col INT); 
```

[* 不完全正确 - 您必须引用任何不是字母数字或`_`or的字符`$`，但是 . 在你的名字中是一个特别麻烦的选择。]

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-22T08:10:29.803

在 MySQL 5.1.6 之前，数据库和表名不能包含`/`, `\`, `.`, 或文件名中不允许的字符（请参阅[8.2\. Schema Object Names](http://dev.mysql.com/doc/refman/5.1/en/identifiers.html)）。在 5.1.6 之后的版本中，您必须用反引号 ( ```) 引用您的表名 - 但正如其他人也建议的那样：您不应该这样做以防止任何不必要的麻烦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T08:07:21.277

MySQL 5.0.22 似乎不允许它：

```
% mysqladmin -uroot -pXXX create foo.bar
mysqladmin: CREATE DATABASE failed; error: 'Incorrect database name 'foo.bar'' 
```

即使它确实允许，我也强烈建议不要这样做。

至少，您必须在使用它的每个查询中使用反引号来转义对该数据库的任何引用。

# .net - 3 层 .NET 应用程序资源

> ID：776126
> 
> 赞同：1
> 
> 时间：2009-04-22T08:04:57.367
> 
> 标签：.net, design-patterns, n-tier-architecture, business-logic-layer

我的一个朋友在 3-Tier 应用程序设计和开发方面没有太多经验，他想扩展他在这个主题上的知识。你能给我指出好的在线资源或书籍吗？如果他们从原则开始，那就太好了。我认为[本教程](http://www.asp.net/Learn/data-access/)是一个很好的起点。

你最喜欢什么资源？

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T08:08:40.010

你可以看看

[http://dotnetslackers.com/articles/aspnet/Three-Tier-Architecture-With-ASP-NET.aspx](http://dotnetslackers.com/articles/aspnet/Three-Tier-Architecture-With-ASP-NET.aspx) 和 [http://weblogs.asp.net/bsimser/archive/2006/08/13/3_2d00_tier-architecture-与-asp.net-2.0.aspx](http://weblogs.asp.net/bsimser/archive/2006/08/13/3_2d00_tier-architecture-wtih-asp.net-2.0.aspx)

MSPress 也有很多关于 .NET MCP 考试的书籍可以涵盖这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T08:25:05.820

他可能想从以下书开始：

[N 层架构基础 (.NET 2.0)](http://www.pdsa.com/Products/ProductDetail.aspx?prod=51)

[![封面](https://i.stack.imgur.com/OlSj4.jpg)](https://i.stack.imgur.com/OlSj4.jpg)

然后查看以下书籍以获取更多最新信息：

[使用 LINQ 进行 WCF 多层服务开发](https://rads.stackoverflow.com/amzn/click/com/1847196624)

[书籍封面 http://ecx.images-amazon.com/images/I/51ckQayArLL._SL500_AA240_.jpg](http://ecx.images-amazon.com/images/I/51ckQayArLL._SL500_AA240_.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T08:16:43.953

我不认为您提到的链接是在讲述有关 3 层（或 N 层）的内容。也许您正在混合[N-layer 和 N-tier](http://davidhayden.com/blog/dave/archive/2005/07/22/2401.aspx)的定义？这些有不同的含义。

关于 N 层的一个很好的解释可以在这个网站上找到：[什么是 N 层架构？](https://stackoverflow.com/questions/312187/what-is-n-tier-architecture).

N 层不一样，但我会先了解 N 层，然后再研究 N 层。由于您提到的链接是 ASP.NET，我认为在[Imar.Spanjaars.com](http://imar.spaanjaars.com/)上找到的关于在[ASP.NET 2.0](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=420)和[ASP.NET 3.5](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476)中使用层的教程非常有趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T08:25:06.600

最适合您的是 Imar Spaanjaars 撰写的系列文章。[您可以在此处](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476)和[此处](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=416)找到该系列。

[http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476) [http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=416](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=416)

# nhibernate - NHibernate：排他锁

> ID：776136
> 
> 赞同：14
> 
> 时间：2009-04-22T08:09:28.713
> 
> 标签：nhibernate, locking

在 NHibernate 中，我想检索一个实例，并在表示数据库中检索到的实体的记录上放置一个排他锁。

现在，我有这个代码：

```
With.Transaction (session, IsolationLevel.Serializable, delegate
{
    ICriteria crit = session.CreateCriteria (typeof (TarificationProfile));

    crit.SetLockMode (LockMode.Upgrade);

    crit.Add (Expression.Eq ("Id", tarificationProfileId));

    TarificationProfile profile = crit.UniqueResult<TarificationProfile> ();

    nextNumber = profile.AttestCounter;

    profile.AttestCounter++;

    session.SaveOrUpdate (profile);
}); 
```

如您所见，我将此条件的 LockMode 设置为“升级”。`updlock`这会为使用和`rowlock`锁定提示的 SQL Server 发出一条 SQL 语句：

```
SELECT ... FROM MyTable with (updlock, rowlock) 
```

但是，我希望能够使用真正的独占锁。也就是说，在我释放锁之前，防止其他人可以读取相同的记录。换句话说，我希望能够使用`xlock`锁定提示，而不是`updlock`.

我不知道如何（或什至）我能做到这一点....也许有人可以给我一些提示:)

如果真的有必要，我可以使用 NHibernate 的 SQLQuery 功能，并编写自己的 SQL Query，但是，我想尽可能避免这种情况。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-02-11T13:33:42.060

HQL DML 查询将在不需要锁定的情况下完成您的更新。

这在 NHibernate 2.1 中可用，但尚未在参考文档中。Java [hibernate 文档](http://docs.jboss.org/hibernate/stable/core/reference/en/html/batch.html#batch-direct)非常接近 NHibernate 实现。

假设您使用的是 ReadCommitted Isolation，那么您可以安全地在事务中读取您的值。

```
With.Transaction (session, IsolationLevel.Serializable, delegate
{
    session.CreateQuery( "update TarificationProfile t set t.AttestCounter = 1 + t.AttestCounter where t.id=:id" )
        .SetInt32("id", tarificationProfileId)
        .ExecuteUpdate();

    nextNumber = session.CreateQuery( "select AttestCounter from TarificationProfile where Id=:id" )
        .SetInt32("id", id )
        .UniqueResult<int>();
} 
```

根据您的表名和列名，生成的 SQL 将是：

```
update TarificationProfile
set    AttestCounter = 1 + AttestCounter
where  Id = 1 /* @p0 */

select tarificati0_.AttestCounter as col_0_0_
from   TarificationProfile tarificati0_
where  tarificati0_.Id = 1 /* @p0 */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-02-11T08:45:18.950

我怀疑它可以从 NHibernate 完成。就个人而言，我会使用存储过程来完成您想要完成的事情。

**更新：**鉴于持续的反对票，我将对此进行扩展。Frederick 正在询问如何从他的 ORM 层使用锁定提示，这是他的底层数据库引擎的语法和实现特定的细节。这是尝试执行此类操作的错误级别 - 即使可能（它不是），它在所有 NHibernate 支持的数据库中始终如一地工作的可能性也非常低。

很棒的 Frederick 的最终解决方案不需要先发制人的独占锁（这会降低性能并且通常是一个坏主意，除非您知道自己在做什么），但我的回答是有效的。任何偶然发现这个问题并想要从 NHibernate 执行独占锁定读取的人 - 首先：不要，其次：如果必须，使用存储过程或 SQLQuery。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-05T23:07:29.710

如果您阅读的所有内容都是使用 Serializable 的 IsolationLevel 完成的，并且所有的写入也是使用 Serializable 的 IsolationLevel 完成的，那么我不明白为什么您需要自己对数据库行进行任何锁定。

所以序列化保证了数据的安全，现在我们仍然有可能死锁的问题......

如果死锁不常见，那么当您遇到死锁时，只需将 [start transaction, read, update, save] 放在重试循环中就足够了。

否则，可以使用直接生成的简单“select for update”语句（例如，不使用 nhibernate）来阻止另一个事务在更改之前读取该行。

但是我一直在想，如果更新速度快到足以导致大量死锁，那么 ORM 可能不是更新的正确工具，或者数据库模式可能需要重新设计以避免必须读取/写入的值（例如读取数据时计算）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T09:11:39.203

如果要确保从数据库读取的值在事务期间不会更改，则可以使用隔离级别“可重复读取”。但是您必须在所有关键事务中执行此操作。或者，您使用升级锁将其锁定在关键阅读事务中。

# selenium - 减小 selenium 框架的大小

> ID：776161
> 
> 赞同：2
> 
> 时间：2009-04-22T08:18:31.327
> 
> 标签：selenium, selenium-rc, web-testing

我是否要减小 selenium 框架的大小，以增加我正在测试的网站的框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T08:22:02.943

您可以在多窗口模式下启动 Selenium 服务器：

> -multiWindow：让您进入测试网站在单独窗口中执行的模式，并且 selenium 支持框架

[http://seleniumhq.org/docs/05_selenium_rc.html#server-options](http://seleniumhq.org/docs/05_selenium_rc.html#server-options)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T18:19:33.350

如果您想在完成多窗口模式后调整窗口大小，您也可以执行 getEval("window.resizeTo(X, Y); window.moveTo(0,0);") 其中 X 和 Y 是宽度，你想要的窗口的高度。

# asp.net - ASP.NET 树视图排序

> ID：776162
> 
> 赞同：2
> 
> 时间：2009-04-22T08:18:32.810
> 
> 标签：asp.net, sorting, treeview

我习惯于 winform`TreeView`具有`Sorted`自动管理节点排序的属性。我现在必须按字母顺序对 ASP.NET 进行排序`TreeView`，但我很惊讶我找不到任何类似的属性或回调方法。

有什么方法可以在 ASP.NET 中自动实现此操作，还是我必须以正确的顺序手动排序和插入我的节点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T08:26:50.823

您需要编写自己的排序功能，但添加此功能相当简单。

[http://blog.mdk-photo.com/post/C-Extentionmethod-Tree-Node-View-Sort().aspx](http://blog.mdk-photo.com/post/C-Extentionmethod-Tree-Node-View-Sort().aspx)

.NET 3.5 支持扩展方法，因此您可以向预先存在的系统类添加功能。注意`this`方法参数的语法。[更多信息在这里](http://weblogs.asp.net/scottgu/archive/2007/03/13/new-orcas-language-feature-extension-methods.aspx)

```
public static void Sort(this TreeView tv)
{
    TreeNodeCollection T = tv.Nodes.Sort();
    tv.Nodes.Clear();
    tv.Nodes.AddRange(T);
}

public static void Sort(this TreeNode tn)
{
    TreeNodeCollection T = tn.ChildNodes.Sort();
    tn.ChildNodes.Clear();
    tn.ChildNodes.AddRange(T);
} 
```

第一个链接包含完成排序功能所需的其余代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T11:18:55.507

三年后，TreeView 仍然不支持原生排序。这是一个按字母顺序对所有节点进行排序的简单方法。

```
private void SortTreeNodes(TreeNodeCollection treeNodes)
{
    var sorted = true;

    foreach (TreeNode treeNode in treeNodes)
    {
        SortTreeNodes(treeNode.ChildNodes);
    }

    do
    {
        sorted = true;

        for (var i = 0; i < treeNodes.Count - 1; i++)
        {
            var treeNode1 = treeNodes[i];
            var treeNode2 = treeNodes[i + 1];

            if (treeNode1.Text.CompareTo(treeNode2.Text) > 0)
            {
                treeNodes.RemoveAt(i + 1);
                treeNodes.RemoveAt(i);

                treeNodes.AddAt(i, treeNode2);
                treeNodes.AddAt(i + 1, treeNode1);

                sorted = false;
            }
        }
    } while (!sorted);
} 
```

像这样称呼它

```
SortTreeNodes(myTreeView.Nodes); 
```

# .net - 将 .NET 中的企业服务用于不写入数据库的事务对象

> ID：776166
> 
> 赞同：0
> 
> 时间：2009-04-22T08:20:18.407
> 
> 标签：.net, com+

我正在考虑使用企业服务中的 DTC 来管理我需要运行的事务。该交易的不同寻常之处在于，该交易将影响我们通过本机接口访问的数据库和许多硬件设备。我很想知道这是否真的可能。即我可以编写一个类来访问硬件组件执行更新并支持通过企业服务回滚吗？到目前为止，我看到的所有示例都演示了一个数据库示例。

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T09:48:58.203

通过进一步阅读该主题，我认为我的问题的答案很简单。您不能使用 DTC 将事务管理到非数据库源（例如硬件设备）。

# .net - JclDotNet，以及一些使用汇编程序的奇怪调用模式

> ID：776174
> 
> 赞同：1
> 
> 时间：2009-04-22T08:22:18.230
> 
> 标签：.net, delphi, dll, runtime, host

我们有自己的粘合层代码thingamajig，它允许我们在我们的Win32 Delphi 程序中托管.NET 运行时。这使我们能够随着时间的推移逐步过渡到 .NET。

但是，我们不时会遇到一些问题，昨天我在 SO 上看到了一个关于 Jcl 的 .NET 主机实现的答案，所以我想看看是否有一些明显的差异。

原来有，但我不明白它做了什么，为什么，以及我是否需要这样做。我当然会尝试它，但我非常希望其他了解这个奇怪代码背后原因的人告诉我它的作用。

随着时间的推移，我们可能会切换到使用 Jcl 实现，但由于我们即将发布，除非为了解决当前问题绝对有必要，否则在这个级别的代码进行大修是不合理的，所以请不要t 只是建议我们切换。

无论如何，不​​同之处在于它们如何调用 .NET 函数以加载和绑定到 .NET 运行时，基本上它们如何调用从 .NET dll 导出的函数。

这是我的代码：

```
type
  TCorBindToRuntimeEx = function(pwszVersion: PWideChar;
    pwszBuildFlavor: PWideChar;
    startupFlags: DWord; rclsid, riid: PGUID;
    out ppv: IUnknown): Integer; stdcall;
...
var
  CorBindToRuntimeEx  : TCorBindtoRuntimeEx = nil;
...
CorBindToRuntimeEx := GetProcAddress(Runtimehandle, 'CorBindToRuntimeEx');
...
clsid := CLASS_CorRuntimeHost;
iid := IID_ICorRuntimeHost;
rc := CorBindToRuntimeEx('v2.0.50727', 'wks', 0, @clsid,
    @iid, UnkRuntimeEngine); 
```

现在，这里我只是简单地使用 GetProcAddress 将导出函数的地址加载到一个变量中，输入为`stdcall`函数指针，然后调用它。这行得通，有点。正如我所说，在少数情况下会出现一些奇怪的错误消息。

好的，这是他们的代码，并特别注意带有汇编代码的函数。

```
function CorBindToRuntimeEx(pwszVersion, pwszBuildFlavor: PWideChar;
  startupFlags: DWORD; const rclsid: TCLSID; const riid: TIID;
  out pv): HRESULT; stdcall;
{$EXTERNALSYM CorBindToRuntimeEx}
...
var
  _CorBindToRuntimeEx: Pointer = nil;

function CorBindToRuntimeEx;
begin
  GetProcedureAddress(_CorBindToRuntimeEx, mscoree_dll,
    'CorBindToRuntimeEx');
  asm
    mov esp, ebp
    pop ebp
    jmp [_CorBindToRuntimeEx]
  end;
end;
...
OleCheck(CorBindToRuntimeEx(PWideCharOrNil(ClrVer),
  PWideChar(ClrHostFlavorNames[Flavor]), Flags,
  CLASS_CorRuntimeHost, IID_ICorRuntimeHost,
  FDefaultInterface)); 
```

*请注意，我已经稍微重新格式化了代码以避免在 SO 上出现水平滚动条，但只是添加了一些换行符和一些缩进，代码是原样的。*

最后的调用可能无关紧要，它基本上会传递与我们相同的参数（请注意，我们将 0 作为选项值传递，但我们也尝试使用 Jcl 代码使用的相同特定参数，但问题仍然存在展示）。

所以，我的问题是，汇编代码是做什么的？我知道它在技术意义上是做什么的，我以前一直在编程汇编，所以它操纵堆栈指针。

问题是为什么它必须这样做。我只是不明白。

可能是堆栈帧毕竟*不是吗？* `stdcall`

今天请教我一些东西。

* * *

**编辑**：好的，相应地更改了我的代码，但我们的问题仍然存在，所以不是这样。看起来我毕竟会做一些 WinDbg 来挖掘第三方代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T10:27:55.667

汇编代码删除 CorBindToRuntimeEx 的堆栈帧。如果您调用 CorBindToRuntimeEx，则所有参数都被推入堆栈（=> stdcall）。然后该函数调用 GetProcedureAddress 来初始化全局 _CorBindToRuntimeEx 变量，该变量现在指向“CorBindToRuntimeEx”函数。

GetProcedureAddress 返回后必须调用 _CorBindToRuntimeEx 函数。但是这里我们有一个问题。Delphi 自动在代码中添加了“push ebp; mov ebp,esp”（“begin”所在的位置）。为了删除该堆栈帧，使用了“mov esp,ebp; pop ebp”。“jmp [_CorBindToRuntimeEx]”然后将执行指针设置为 _CorBindToRuntimeEx 函数，然后该函数使用来自我们的 CorBindToRuntimeEx 函数的返回地址。

# java - 在jsp中包含一个cpp文件

> ID：776175
> 
> 赞同：1
> 
> 时间：2009-04-22T08:22:22.020
> 
> 标签：java, c++, jsp

我对jsp很陌生...我目前正在做一个项目，我必须将读卡器与我的html页面连接起来。

我在 cpp 和 .h 文件中获得了读卡器代码。有什么办法可以将这些文件与我的 jsp 一起使用。或者我必须在 java 中重新编码并包含一个 .js 文件。

具体来说，我在我的页面上有一个用于 ID 的文本输入。我需要用卡的输入填充它。我得到了与卡交互并在 cpp 程序中提取该数字的代码。那么我可以从我的 html 页面调用该函数吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T09:06:11.370

为什么你需要将读卡器连接到 JSP 页面。这对我没有任何意义，我很抱歉。首先了解JSP是一种Java web技术，用于表示，运行在服务器上，向浏览器吐出HTML。因此，您在客户端上获得的是 HTML。

现在，您能否详细说明您要实现的目标？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T08:25:18.893

有几种方法可以做到这一点：

1.  如果您的 C++ 代码可以独立运行，您可以从您的 jsp 进行系统调用。
2.  您可以使用 Java-C++-bridge。
3.  您可以使用 Java 本机接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T08:27:04.710

如果您想从 java 中引用 C++ 代码，则必须查看 Java Native Interface。

有关更多信息，请参阅以下内容：

*   [维基百科](http://en.wikipedia.org/wiki/Java_Native_Interface)
*   [API 指南](http://java.sun.com/javase/6/docs/technotes/guides/jni/)
*   [PDF格式的好指南](http://www.google.com/url?sa=t&source=web&ct=res&cd=5&url=http%3A%2F%2Fwww.cs.umanitoba.ca%2F~eclipse%2F8-JNI.pdf&ei=_dTuSbLQD5HIMrCuhfcP&usg=AFQjCNEuHCkb0LSV2uZP5KkoK-0JNdEPew)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T09:37:48.300

jsp 呈现 HTML，在您将在浏览器中看到的部分中，您不再在您的 jsp 中，甚至不再在您的代码中。

如果您想从 HTML 页面读取卡片，则需要忽略您拥有 jsp 技术这一事实，并意识到您正在使用它的 HTML 技术。

因此，在尝试与 cpp 交互之前，您首先需要一个小程序、一些闪存、一些 activeX 或其他浏览器技术

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T11:25:15.437

如果您需要从卡中读取 JSP 无法帮助您。如果您以其他方式读取卡号并通过 POST 将其发送到 JSP，那么您不需要任何读取。您可能需要的是用户端的签名小程序，它将尝试从读卡器读取卡。然后我会建议你使用 javax.card - java 1.6 支持读取智能卡... [http://java.sun.com/javacard/](http://java.sun.com/javacard/)

# .net - .NET 中的视频处理

> ID：776179
> 
> 赞同：5
> 
> 时间：2009-04-22T08:23:48.477
> 
> 标签：.net, video

我想打开 .avi 文件（最好是任何视频文件），将该视频作为位图（数组）序列处理，然后将其显示在屏幕上或将其保存到文件中。

我在 .NET 中有哪些选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T10:14:13.167

事实证明，[Splicer](http://www.codeplex.com/splicer)是我的最佳选择。[它是DirectShow.Net](http://directshownet.sourceforge.net/)的开源包装器。编程模型非常简单，连我都能理解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T08:31:00.550

我一直在 CodeProject 上使用这个[C# AVIFile 包装器](http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx)来转换位图 - > AVI，它也可以做相反的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T08:54:21.787

以前来自 Microsoft 的托管 DirectX 包装器提供了一个 AudioVideoPlayback 程序集，可用于此，但这[基本上已经死了](http://www.thezbuffer.com/articles/364.aspx)

那篇文章列出了几个备选方案，为了完整起见，我将在此处列出（我不能说它们的相对优点）：

*   [DirectShow.Net](http://directshownet.sourceforge.net)
*   [托管 DirectShow](http://kristoffer.vinther.name/projects/managed-directshow)
*   [石灰绿色袜子](http://www.limegreensocks.com/DShow/)
    *   这似乎已在很大程度上被 DirectShow.Net 所包含

值得注意的是，不使用托管代码在 DirectShow 链中实现过滤器的原因之一是一次只能托管一个版本的 CLR [1]，因此版本不兼容的两个过滤器会以令人不快的方式失败（这与托管外壳插件的问题相同）。

但是，将其作为*应用程序*而不是过滤器进行应该没问题。

通过使用 DirectShow，您应该可以访问系统可解码的任何现有音频/视频流。

[1] 4.0 CLR[旨在消除](http://coolthingoftheday.blogspot.com/2009/01/pimping-your-win7-taskbar-extending.html)从 2.0 开始的所有 CLR 版本的这个问题。这是否是对现有扩展点的回顾性修复是一个悬而未决的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T20:52:33.903

您还可以免费下载用于非商业目的的 VideoLab.NET - www.mitov.com 并使用它。它包括演示如何使用一行代码从流中获取位图。

# java - 如何用 Swing 制作画布？

> ID：776180
> 
> 赞同：29
> 
> 时间：2009-04-22T08:24:29.660
> 
> 标签：java, swing, user-interface, java-canvas

我正在尝试使用 Java 制作一个绘画编辑器，其中我有一个工具栏，其中包含我想粘贴到画布中的对象。我正在使用 Swing 组件制作 GUI，但是当我寻找制作画布的方法时，我只找到了 AWT 的类画布。

有没有办法用 Swing 制作类似于画布的东西？（例如，JPanel？）我已经读过使用 AWT 的类画布和用 swing 制作的 GUI 将无法正常工作，是这样吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-22T08:36:42.127

为了在摇摆中制作自定义“画布”，您通常编写一个[`JPanel`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JPanel.html). 然后，您必须覆盖 的`protected paintComponent(Graphics g)`方法`JPanel`。

在paint方法中，您可以调用[`Graphics`](http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics.html)对象上的方法来实际绘制`JPanel`.

与往常一样，Java 教程对此有[很好的参考](http://docs.oracle.com/javase/tutorial/uiswing/painting/)，可以帮助您入门。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-22T08:27:28.763

您可能想要创建一个子类[`JPanel`](http://java.sun.com/javase/6/docs/api/javax/swing/JPanel.html)并实现您自己的方式来绘制您想要绘制到面板上的组件。

基本方法可能是将 a 分配[`MouseListener`](http://java.sun.com/javase/6/docs/api/java/awt/event/MouseListener.html)给 的子类`JPanel`，然后实现绘画功能。

基本思想可能是这样的：

```
class MyCanvas extends JPanel implements MouseListener
{
    Image img;      // Contains the image to draw on MyCanvas

    public MyCanvas()
    {
        // Initialize img here.
        this.addMouseListener(this);
    }

    public void paintComponent(Graphics g)
    {
        // Draws the image to the canvas
        g.drawImage(img, 0, 0, null);
    }

    public void mouseClicked(MouseEvent e)
    {
        int x = e.getX();
        int y = e.getY();

        Graphics g = img.getGraphics();
        g.fillOval(x, y, 3, 3);
        g.dispose();
    }

    // ... other MouseListener methods ... //
} 
```

上面的例子是不完整的（并且没有经过测试——它肯定不会编译），但它提供了一个关于如何实现`MyCanvas`一个用户可以点击并绘制圆圈的类的想法。

该`img`对象用于保存画布的图像。该`paintComponent`方法用于将`img`对象绘制到画布上。在该`mouseClicked`方法中，检索`Graphics`与之关联的对象`img`以便`fillOval`放到图像上。

由于其中一个要求是将图像粘贴到画布上，因此保留一些`Image`要粘贴到画布中的 s 可能是个好主意。也许是这样的：

```
Image[] myImages;    // Used to store images to paint to screen. 
```

然后，在例程中将图像绘制到`img`存储在`MyCanvas`：

```
g.drawImage(myImage[INDEX_OF_DESIRED_IMAGE], 0, 0, null); 
```

通过使用对象的[`drawImage`](http://java.sun.com/javase/6/docs/api/java/awt/Graphics.html#drawImage(java.awt.Image,%20int,%20int,%20java.awt.image.ImageObserver))方法，可以将[`Graphics`](http://java.sun.com//javase/6/docs/api/java/awt/Graphics.html)其他`Image`s绘制到`Image`s上。

* * *

至于关于 AWT 和 Swing 的问题，是的，您确实不想混合 AWT 和 Swing 中的组件，因为它们呈现 GUI 组件的方式不同。AWT 基于重量级组件，这意味着它们是用于绘制 GUI 的本机窗口，而 Swing 是基于轻量级组件，这意味着 GUI 由 Java 本身绘制，而不使用本机组件。

Sun[的用 AWT 和 Swing 绘制](http://www.oracle.com/technetwork/java/painting-140037.html)文章中提供了关于 AWT 和 Swing 区别的一个很好的指南。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-22T09:59:58.057

简单的子类`JComponent`。

`JPanel`是一个不合适的类。通常建议使用它，因为它似乎已`setOpaque(true)`自动调用它。实际上是 PL&F 做到了这一点，它是否真的发生取决于实施和供应商。

`Canvas`是重量级组件。也就是说它是由底层的窗口系统控制的。结果是它通常会被绘制在 Swing 组件的顶部，而不考虑 z 顺序或裁剪（将它放在滚动窗格中会产生奇怪的行为）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-30T14:02:31.733

您可能想查看 Minueto API。它是一个非常简单易用的图形 api，您可以结合 Java 事件监听来提供您的绘图能力。

[http://minueto.cs.mcgill.ca/](http://minueto.cs.mcgill.ca/)

# c++ - C++：可变模板参数（用于遗传算法）

> ID：776182
> 
> 赞同：1
> 
> 时间：2009-04-22T08:24:47.710
> 
> 标签：c++, templates, generics, oop

我正在使用 C++、MPI 和 CUDA 编写一个并行进化算法库。我需要从面向对象的设计中提取原始数据并将其粘贴到平面数组（或使用[stl-mpi](http://clustertech.com/index.php?Download:STL-MPI_Library)的 std::vector ）中，以便将其发送到节点或 cuda 设备。

完整的设计非常复杂，有很多继承来保持库的灵活性。但感兴趣的类别是：

**基因组类**- 包含数据向量。例如浮点数或布尔值。

**人口类**- 包含基因组对象的向量，并使用基因组对象进行初始化。

首先创建一个基因组对象，然后将对其的引用传递给种群类构造函数，该构造函数基于传递的对象创建自己的基因组向量。（希望这是有道理的！）

所以我想我会添加另一个成员向量，比如`rawData`人口类。但是 rawData 的类型需要取决于存储在基因组（或原始基因组对象）中的数据类型。
这就是问题所在，据我所知，没有办法动态设置传递给模板的类型。

我的伪代码是

```
class genome {
    std::vector<bool> data;
}

template <class T>
class population {
    std::vector<genome> population;
    std::vector<T> rawData;
    void PackDataIntoRawData();
}; 
```

然后当我创建人口（实际上是另一个类的成员对象）时，我会调用：

```
genome myBitGenome();
population<type of myBitGenome.data> pop(myBitGenome); 
```

有没有办法做到这一点，或者任何人都可以建议另一种方式来实现这一点。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T08:38:43.573

我真的不明白这个问题。你不需要把“原始数据”变成基因组吗？为什么需要存储它？如果你需要特殊的函数来处理不同种类的原始数据，你不需要模板，你可以简单地使用函数重载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T08:40:56.203

就动态类型而言，[boost::variant](http://www.boost.org/doc/html/variant.html)是一个非常强大的工具。

但是您的问题似乎相当简单，所以我建议您这样做：

```
template<typename DataPiece>
class Genome {
    typedef std::vector<DataPiece> Data;
    Data data;
}

template <class T_Genome>
class Population {
    std::vector<T_Genome> population;
    typedef typename T_Genome::Data Data;
    Data rawData;
    void PackDataIntoRawData();
}; 
```

然后使用它：

```
typedef Genome<bool> MyGenome;
MyGenome myBItGenome;
Population<MyGenome> pop( myBitGenome ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T08:42:53.547

我也不明白为什么需要将 rawData 存储为成员。

你看过boost序列化库吗？

您只需为每个类提供序列化函数或方法。已经提供了 STL 集合和原语的方法。

例如

```
template <class T_Genome>
class Population {
    template<class Archive>
    void serialize(Archive& ar, const unsigned int version)
    {
        using namespace boost::serialization;
        ar & BOOST_SERIALIZATION_NVP(population);
        // ...
    }

    // ...
}; 
```

# c# - 如何传播 WPF 数据绑定期间发生的错误和异常？

> ID：776193
> 
> 赞同：10
> 
> 时间：2009-04-22T08:25:58.830
> 
> 标签：c#, wpf, data-binding, xaml

我经常发现我不小心破坏了我的应用程序中的数据绑定。通过重命名属性而不是在 XAML 中重命名它，或者通过属性由于某种原因引发异常。

默认情况下，数据绑定错误会记录到调试输出中，抛出的异常会被捕获和抑制。

有没有一种简单的方法可以在记录调试输出后引发异常？

我想尽快知道数据绑定是否被破坏（理想情况下是在自动化测试中拾取它），并且不要冒险在人类测试之前它可能会被忽视。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-11T08:56:45.033

经过一番拖延后，我终于开始编写解决方案来解决我原来的问题。

我的解决方案使用`TraceListener`记录到输出窗口的自定义（最初由 John 建议）。发生错误时，输出窗口会自动显示并购买到前台。

这是我的`TraceListener`：

```
public class ErrorLogTraceListener : TraceListener
{
    public override void Write(string message)
    {
        ...
    }

    public override void WriteLine(string message)
    {
        ...
    }
} 
```

`TraceListener`在 System.Diagnostics 中定义。

自定义`TraceListener`必须连接到要使用的系统中。官方的做法是在注册表中设置一些东西，然后使用该`App.config`文件来配置`TraceListener`.

但是我发现有一种更简单的方法可以以编程方式执行此操作：

```
ErrorLogTraceListener listener = new ErrorLogTraceListener();
PresentationTraceSources.Refresh();

PresentationTraceSources.DataBindingSource.Listeners.Add(listener);
PresentationTraceSources.DataBindingSource.Switch.Level = SourceLevels.Error; 
```

`PresentationTraceSources`也定义在`System.Diagnostics`.

有关跟踪源的更多信息，请参阅 Mike Hillberg 的[博客](http://blogs.msdn.com/mikehillberg/archive/2006/09/14/WpfTraceSources.aspx)。

Bea Stollnitz 在她的[博客](http://www.beacosta.com/blog/?p=52)上有一些有用的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T10:40:07.540

看看[这篇博客文章](https://web.archive.org/web/20101116194923/http://www.beacosta.com/blog/?p=52)，它可能有助于解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-14T14:06:15.130

[使用 .net 4.0 Dynamics 在 WPF 和 Silverlight 中引发绑定异常](https://web.archive.org/web/20111031041617/http://ontheblog.net/cms/Home/tabid/36/EntryID/77/Default.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-26T18:50:47.660

我实现了一个与接受的答案非常相似的解决方案：

1.  派生一个`TraceListener`抛出而不是记录的
2.  将该侦听器添加到`PresentationTraceSources.DataBindingSource`

请[在 GitHub 上查看完整的解决方案](https://github.com/bblanchon/WpfBindingErrors)，它包括一个演示应用程序和一个单元测试项目。

![Visual Studio 中的异常](https://i.stack.imgur.com/5hVJF.png)

# c# - 如何防止上传 Warez。(asp.net, C#)

> ID：776201
> 
> 赞同：1
> 
> 时间：2009-04-22T08:29:58.727
> 
> 标签：c#, asp.net, upload

我的公司创建了一个应用程序，可以将大型附件从一个邮件收件人发送到另一个邮件收件人（因为大多数邮箱都非常有限）。

但是我们想知道如何防止上传warez？目前允许所有扩展，但我们可以将扩展限制为 zip 和图像。

但是，如果您压缩warez，您仍然可以上传这些。

是否有任何工具、方法或类似的东西来防止通过我们的系统上传warez？

更多信息：

这个项目是半公开的。它主要用于客户和公司之间的沟通。因此，始终需要我们公司的电子邮件地址（无论是在收件人中还是发件人中，但你们都知道操纵它是多么容易）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-22T08:35:13.160

首先定义什么是“warez”。

我很确定你会遇到问题。

您可能可以实施启发式方法来确定您正在发送应用程序并禁止它，但是您无法确定一个应用程序是盗版副本而另一个不是并且允许合法的应用程序同时禁止盗版的。

如果您控制服务器，并且担心人们会将盗版应用程序副本上传到您的服务器并使用它进行传播，那么我很确定您唯一的选择是咨询律师您有义务做什么.

我认为归结为您需要一个系统，版权所有者可以通知您存在盗版副本，并且您有一个系统可以在一段时间内删除所述内容。我认为这就是所有需要的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T08:36:08.197

**编辑**

如果正如您在编辑中所说，这是让客户向您发送东西，那么我会非常小心允许的电子邮件地址。有什么可以阻止有人输入分发电子邮件地址。例如，如果某个顽皮的人向 All@YourCompany.com 发送了一个大文件，它会被分发还是会被阻止

**原来的**

如果这是一个开放/公共系统，那么它将被滥用。有一些方法可以即时解压缩 zip 文件以检查其内容，甚至检查文件 mimetype 标头以执行更多限制，但这并不会改变某人可能想要合法发送演示文稿的 AVI 文件的事实，而其他人在上传盗版电影。

如果这是供贵公司内部使用，我建议以某种方式限制访问（将系统绑定到贵公司的 LDAP/ADSI 系统并让用户登录系统。

还可能需要设置一些文件大小限制，因为没有什么可以阻止一些脚本小子只是发送 1Gb 垃圾文本文件，只是为了滋扰并占用您的带宽

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T08:41:21.787

您可以随时重命名，例如，将 .rar 扩展名为 .jpg 并让下载者知道重命名文件以打开“Warez”。没有办法阻止它，只能随机抽样，自己测试，然后手动删除你不想要的东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T08:44:08.583

简短的回答：不，你不能。

您可以从列表中查找文件名，但这会失败（例如，您可能会禁止“MS Word”，但是如果有人升级了无辜的“MS Word.doc”，您就会失败。或者如果坏人将他的 exe 重命名为“MS W0rd" 你失败了。

您可以在文件中查找已识别的序列 - 一旦它们应用简单的加密或压缩就会失败。

您可以创建用户帐户并禁止行为不端的用户，但这会失败，因为您必须花费大量精力来监管它，并且在任何情况下用户都可以使用 Web 邮件地址创建多个帐户。

我的建议是让这个问题成为别人的问题。让用户将文件上传到其他人的系统（Microsoft SkyDrive、Amazon S3 等），然后他们可以担心法律方面的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T09:00:18.233

如果有人发送受密码保护的 RAR 存档以确保某些文档的安全性怎么办？你不可能看到它的内部——而且你不应该——而不是你的业务。

例如，我们的网络有几次访问权限问题。而且我需要在我的开发者机器上安装一些第三方组件。由于当时我无法访问我们的存储库，所以我刚刚收到了通过电子邮件发送给我的安装包。现在，一个局外人怎么可能决定文件“SomeCoolComponent.msi”是从互联网下载的warez副本还是我有权使用的100％合法副本？

我们曾经在大学时的电子邮件帐户突然将所有受密码保护的档案作为附件阻止。你猜怎么着？我没有停止加密它们。我停止使用该帐户。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T09:57:34.633

不 - 您无法使用工具或框架来防止这种情况。

您可以通过禁止/将违反政策的用户列入黑名单来防止这种情况。

尝试在代码中做所有事情并不总是最好的主意 - 有时一个简单的“违反规则，你会被禁止”政策是最好的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T09:25:11.137

假设您可以构建解压缩支持，您可以使用这种启发式方法来确定给定上传的存档是否是warez（源自真实世界的warez分发方法）：

*   获取存档中包含的文件名
*   如果存档包含（一个 .nfo 或一个 .diz 文件）和（一个 exe 或一个 msi 或包含上述之一的存档）阻止上传
*   如果存档包含一系列 zip/rars/00X 文件，则阻止上传
*   如果文件是 exe，请检查它是否是 SFX，如果它是 zip、rar 或 7z SFX，请检查嵌入式存档

否则，只需接受上传，确保您在 TOS 中明确声明公司不对用户上传负责。

# bash - 将文件移动到目录

> ID：776202
> 
> 赞同：9
> 
> 时间：2009-04-22T08:30:27.510
> 
> 标签：bash

我想将当前目录中与*特定模式匹配的所有文件移动到另一个目录。*

例如，我如何将所有以开头的文件移动`nz`到一个名为的目录`foobar`？我尝试使用`mv`它，但效果不佳。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-22T08:46:12.043

```
find . | grep "your_pattern" | xargs mv destination_directory 
```

执行以下操作：

*   查找当前目录中的所有文件
*   根据您的模式过滤它们
*   将所有生成的文件移动到目标目录

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-22T08:32:46.397

`mv nz* foobar`应该这样做。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-22T08:35:04.470

mv nz* foobar/

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T08:32:22.980

这会做到这一点，但如果您有任何以 nz 开头的目录，它也会移动这些目录。

```
for files in nz*
do
mv $files foobar
done 
```

编辑：如上所示，这完全超出了顶部。但是，对于更复杂的模式匹配，您可能会执行以下操作：

```
for files in `ls | grep [regexp]`
do
mv $files foobar
done 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T08:33:37.657

尝试使用安装在大多数 Linux 发行版上的“mmv”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-02-23T15:32:20.650

`mv nz* foobar/`

*   **mv** - 将移动或重命名文件
*   **nz** - 将获取所有以“nz”开头的项目
*   **foob​​ar/** - 是所有项目将进入的目录

# http - 如何解释 HTTP Accept 标头？

> ID：776212
> 
> 赞同：3
> 
> 时间：2009-04-22T08:35:33.737
> 
> 标签：http, rest

根据[HTTP1.1 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.1)，以下的 Accept 标头

```
Accept: text/plain; q=0.5, text/html, text/x-dvi; q=0.8, text/x-c 
```

被解释为

```
text/html and text/x-c are the preferred media types, but if they do not 
exist, then send the text/x-dvi entity, and if that does not exist, send 
the text/plain entity 
```

让我们将标题更改为：

```
Accept: text/html, text/x-c 
```

如果这两个都不被接受，会返回什么？例如，假设我只支持 application/json

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T08:40:49.997

也许你应该用**406 Not Acceptable**来回应。我就是这样读[这个](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)的。

还是**415 不支持的媒体类型**？

我会选择 406，因为在这种情况下，根据规范，响应应该包含一个替代列表。虽然我不清楚该列表应该是什么样子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T11:11:55.157

“如果存在 Accept 头字段，并且如果服务器无法发送根据组合 Accept 字段值可接受的响应，则服务器应该发送 406（不可接受）响应。” -- [RFC2616，第 14.1 节](http://greenbytes.de/tech/webdav/rfc2616.html#rfc.section.14.1.p.8)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T23:12:08.403

你有一个选择。您可以回复 406 并包含描述可用格式的“实体”（例如 HTML 或文本文件）；或者，如果您使用的是 HTTP 1.1，您可以发送您支持的格式，即使它未在 Accept 标头中列出。

（参见[RFC 2616](http://www.ietf.org/rfc/rfc2616.txt)的第 10.4.7 节）

> “注意：HTTP/1.1 服务器可以根据请求中发送的接受标头返回不可接受的响应。在某些情况下，这甚至可能比发送 406 响应更可取。鼓励用户代理检查一个传入的响应，以确定它是否可以接受。”

# flash - Flash：动态文本字段上的抗锯齿字符而不嵌入字体，日语

> ID：776216
> 
> 赞同：4
> 
> 时间：2009-04-22T08:37:34.700
> 
> 标签：flash, fonts, internationalization, textfield, antialiasing

我正在尝试在日本网站的 Flash 中实现动态文本字段的抗锯齿。这些文本字段的内容不是固定数据。

我没有嵌入字体的选项，因为嵌入所有字符会导致一个非常重的 swf 文件（3000kb+ 仅用于字体）。这是因为日语中有大量独特的字符（字面意思是数千个）。

基本上，任何使用动态文本字段的 Flash 站点都面临相同的选择：

1.  保持文件大小并仅使用设备字体（不使用抗锯齿）
2.  强制向用户下载 3mb+ 字体以显示平滑的抗锯齿字体。

我问过一些日本朋友，他们说“Shoganai！” （翻译：“没办法”）。有人有想法吗？

ps：不幸的是，silverlight 也不是一个选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T08:45:32.153

真正愚蠢的“解决方法”，我敢肯定它会被否决，但由于 flash.text.TextField 继承了 flash.display.DisplayObject，您可以使用内置过滤器（如 flash.filters.Blur）来模糊文本水平和垂直半个像素。

这将消耗更多的CPU。

**编辑：** 在使用 CS4 工作一点之后，我找到了一种完美的方法来做到这一点，而无需额外的 CPU 开销！结果看起来 1:1 与“静态文本”渲染完全一样。我相信在 CS3 下同样适用，因为我记得有一个类似的选项。

选择文本后，在属性下选择“Anti-alias”并选择“Custom Anti-alias”。将厚度设置为 100，将锐度设置为 0。这对我有用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-10T05:58:35.527

有许多可行的事情，但没有一个可能是你喜欢的。

*   升级到 Flash 10。字体没有抗锯齿的问题仅限于 windows：linux 和 macOS 都正确地抗锯齿设备字体。现在，从 Flash 10 开始，它也可以在 Windows 上运行，但您需要针对 Flash 10 进行编译才能使其工作。如果您有能力以 Flash 10 为目标，这可能是最好的方法。
*   限制您可以使用的字符数，并仅嵌入所需的字符。这适用于任何 Flash 版本，但在许多情况下可能不实用。
*   放弃并使用设备字体：如果在您的情况下以上两种方式都不可行，我认为这确实是一个shouganai案例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T04:48:35.567

运行时字体嵌入怎么样。

您可以从设备字体开始，同时在后台加载日文字体。加载日文字体后，您将调用将字体更新为加载的字体并进行嵌入。

查看 GAIA 框架，以便在内置时轻松嵌入运行时字体。

对于更新部分，我编写了一个记录字体及其文本格式的数组。然后，当加载字体时，它会引用循环并更新所有注册到它的文本字段的数组。

似乎行得通。

Shoganai是一个kop out......一路ganbatte！@

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T05:47:20.317

在 LiraNuna 的想法之上....

我在类似的路径上看到了[一篇文章](http://polygeek.com/253_flex_fading-and-masking-with-device-fonts)，但他们也打算进行蒙版……他们建议将影片剪辑绘制为位图。这也可能会释放 CPU，因为您的过滤器仅用于初始渲染，然后您可以摆脱它们。

# spring - 不使用Spring有什么问题

> ID：776219
> 
> 赞同：3
> 
> 时间：2009-04-22T08:39:00.187
> 
> 标签：spring, dependency-injection, inversion-of-control, model-view-controller

我试图理解春天。我已经阅读并完成了一些教程。我有点了解 IoC 范式以及 DI 是它在 Spring 中的实现这一事实。

我的问题是：不使用 Spring 你会失去什么？我知道这是一个很大的问题，而且有些主观。但是如果你能写几个点或者给出一个如果不使用 Spring 可能出现的问题的例子，我认为这会对我和其他许多人有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T09:50:43.057

Spring 不仅仅是另一个 IoC 工具（想想 DAO 相关的东西、方便的 MVC 支持、测试工具……）。在我看来，它已经逐渐成长为一种Java的“味道”。但这不是重点 :) 说到 IoC/DI，不使用它的松散是在应用程序中获得松散耦合的最简单方法，这与可重用性相关。显然，大多数人倾向于考虑另一个项目中组件的可重用性，根据我的经验，这种情况并不经常发生。当您必须对代码进行单元测试时，可重用性的最大好处就显现出来了。通过接口编程*和*使用 DI/IoC 使单元测试变得如此简单，以至于那些不愿意进行单元测试的人也会开始喜欢它。

在 UT 问题上的松散耦合和好处是您将失去的一件事。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-28T15:32:32.517

简而言之，您应用依赖注入来编写干净且可测试的代码。同样作为回报，您实现了一种设计，其中调用者知道使用哪个实现（注入）而不是被调用者（这就是著名的“好莱坞原则”）。现在，如果您不使用 Spring 和 Guice 等 DI 框架，您可以尝试使用工厂来实现依赖注入。但是工厂会带来样板代码的成本和在测试时难以清理的麻烦。有些人还在这些框架中发现了其他优势，即它们易于与属于不同层的框架集成，如 Struts、Hibernate 等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-19T14:27:33.100

我写了一篇关于人们为什么使用依赖注入框架（如 Spring 和 Google Guice）的文章。大多数教程都忽略了这一点，但恕我直言，这是最重要的。

如果您了解您遇到的问题，以及所有这些模式/框架解决了哪些问题，那么只有这样您才能做出好的软件和出色的架构选择。

在这里阅读：[http ://www.redcode.nl/blog/2010/01/dependency-injection-dissection](http://www.redcode.nl/blog/2010/01/dependency-injection-dissection)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T08:47:44.160

实际上没有问题。但是，如果您开始编写代码，您最终会得到一个类似于 Spring 的本土框架。使用 Spring 得到的好处是该框架已经更通用（比您自己的），您可以在许多不同的项目中使用它。最重要的（也许）是 Spring 经过了很好的测试，有很多用户在使用它。

当然，您也可以尝试其他框架，而不仅仅是 Spring。外面有很多...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T11:08:57.020

Spring 不仅仅是一个 DI 框架。有很多领域可以让您更轻松地进行编程：

*   JDBC、Hibernate、JMS 模板（显着减少代码行数）
*   方面编程
*   安全性（Spring 安全性）
*   春季MVC
*   春季网络服务

这些只是一些例子——还有更多。您不必使用上述任何一种，但它们都是成熟的、精心设计的框架的一部分，通常它们使事情变得更容易。

Spring的核心当然是依赖注入。对于小型项目，使用 DI 框架的好处可能并不明显，但对于大型和复杂的项目来说，好处就更明显了。Martin Fowler非常清楚地解释[了控制反转。](http://martinfowler.com/articles/injection.html)当然还有其他选择（例如 Guice），但我想说 Spring 现在是行业标准。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T08:51:10.923

一个油嘴滑舌的答案是您必须自己编写代码。我对 Spring 知之甚少（目前），但即使是构造函数注入的基本行为也需要大量代码，而使用 Spring 则需要两个编辑点：

在配置中：

```
 <sectionGroup name="spring">
    <section name="context" type="Spring.Context.Support.ContextHandler, Spring.Core"/>
    <section name="objects" type="Spring.Context.Support.DefaultSectionHandler, Spring.Core" />
  </sectionGroup>

  <spring>
    <context>
      <resource uri="config://spring/objects"/>
    </context>
    <objects xmlns="http://www.springframework.net">
      <object name="mediaLibrary" type="AlbumLibraryWPF.AlbumLibrary, AlbumLibrary"/>
    </objects>
  </spring> 
```

在代码中：

```
 IApplicationContext ctx = ContextRegistry.GetContext();
  library = (Library)ctx.GetObject("mediaLibrary"); 
```

您更愿意做什么：自己编写一个 DI 框架还是专注于构建您的解决方案？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T10:50:53.537

IoC 在 Java 语言中主要是一件好事，因为当大多数应用程序开始增长并且您不为模块化/松散耦合进行设计时，您最终会得到一大堆相互连接的类而没有合理的界限。

对于初学者，Spring 和其他 IoC/DI 框架让您从一开始就考虑模块化。这很重要，因为如果你的代码很好地模块化/松耦合，你最终会组件化和重用更多，从而导致更好的单元测试（如果你仍然进行单元测试）。

如果我想写一个 DAO，我可以预先定义它的接口：

```
interface IPersonDao {
  List<Person> getPersonsByTeam(String teamName);
} 
```

然后，我可以从 src 中“应用”Spring 的任何地方调用此接口的实现。假设我在服务层需要它：

```
class MyService {
  @Autowired
  IPersonDao svc;
} 
```

或在测试类中：

```
class TestPersonDao {
  @Autowired
  IPersonDao svc;

   @Test
  void testGetPersons(){
    List<Person> persons = svc.getPersonsByTeam("billing");
    Assert.assertDataSet(persons, "billing.xml");
  }
} 
```

此外，我的 Dao 实现可以隐藏数据访问的复杂性，而不会弄乱 Dao 合约。如果我需要休眠会话或持久性管理器，我只需声明：

```
class JpaPersonDao implements IPersonDao {

@PersistenceContext
EntityManager em;

  List<Person> getPersonsByTeam(String tm) {
    em.createQuery("...");
  }
} 
```

类的组件化需要一个注册表来连接协作 bean。这可以手动开发，但已经有 DI 框架可以做到这一点。此外，Spring 还有很多其他的东西，比如异常翻译、对方面编程的支持、mvc 框架、portlet 框架、与 hibernate、jpa 和/或其他 db 堆栈的集成，它们当然可以很好地与 Spring IoC 的东西集成。

# wpf - 用户控件与 SurfaceWindow

> ID：776223
> 
> 赞同：0
> 
> 时间：2009-04-22T08:40:24.117
> 
> 标签：wpf, windows, user-controls, dependencies

我正在尝试使用我在 UserControl 类中声明的值来更改 SurfaceWindow 类中的内容。现在我到目前为止所知道的是，我必须使用 DependencyProperty 从 UserControl 获取值，然后将其放入公共字符串中。

```
 public string MapValue
    {
        get { return (string)GetValue(MapValueProperty); }
        set { SetValue(MapValueProperty, value); }
    }

    public static readonly
        DependencyProperty MapValueProperty = DependencyProperty.Register("MapValue", typeof(string), typeof(MapManager)); 
```

现在我的问题是，我如何将公共字符串（在 UserControl 内）绑定到一个元素（在 SurfaceWindow 内）？

如果我使用 DependencyProperty，我是创建一个新类还是将它放在用户控件代码中？

如果有人可以帮助我解决这个问题，我会很高兴..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T12:29:34.720

据我所知，您正在尝试绑定到窗口中某个控件的依赖属性。

如果是这种情况，您可以在绑定声明中使用 ElementName 语法，例如：

```
<TextBlock Text="{Binding ElementName=MapControl, Path=MapValue}"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T12:34:42.430

我的窗口控件中已经有了这个：

`<Image x:Name="iGroundPlan" Source="{Binding ElementName=MapManager,Path=MapValue}" />`

（MapManager 是我的用户控件的名称）

但看起来它不起作用，我不知道为什么..它就像 Windows 永远不知道 MapValue 值何时在我的用户控件中更新 =\

# c# - 如何从局域网中的远程计算机连接到 Oracle？

> ID：776228
> 
> 赞同：0
> 
> 时间：2009-04-22T08:41:31.787
> 
> 标签：c#, oracle

我有存储 Oracle 数据库的计算机 A（IP = 10.20.30.40）。

数据源 = ORCL ，用户 = sa ，密码 = sa

* * *

我有计算机 B（IP = 10.20.30.44），我想将计算机 B 连接到计算机 A。

我怎样才能做到这一点？我需要的连接字符串是什么？有什么建议么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T08:55:52.423

您使用什么 Oracle 版本？

通常使用直接编辑 tnsnames.ora 文件（Oracle 10g 客户端的默认位置 = C:\oracle\product\10.2.0\client_1\NETWORK\ADMIN\tnsnames.ora）或 GUI 工具 -> 网络配置助手。

我的 tnsnames.ora 文件中的连接别名示例：

```
ORADB =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP)(HOST = 172.16.50.1)(PORT = 1521))
    )
    (CONNECT_DATA =
      (SERVICE_NAME = ora10gdb)
    )
  ) 
```

ORADB - 别名，当您从您的环境连接到数据库时，将其用作数据库名称

HOST - 是服务器主机名 PORT - 是 Oracle 服务端口名称（1521 是默认端口） SERVICE_NAME - 是 Oracle 数据库实例服务名称（可以是同一端口后面的同一服务器上的多个数据库实例）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T12:56:55.730

If you have a 10+ Oracle client on computer B, you can use the [EZCONNECT](http://www.orafaq.com/wiki/EZCONNECT) feature, which does not require to edit the TNSNAMES.ORA file : `sa/sa@10.20.30.40/1521:ORCL`. For instance :

```
sqlplus sa/sa@10.20.30.40/1521:ORCL 
```

# php - PHP IDE 的“封装字段”工具

> ID：776230
> 
> 赞同：0
> 
> 时间：2009-04-22T08:42:20.350
> 
> 标签：php, ide, code-generation

有谁知道一个 PHP IDE，它具有封装私有变量的工具，就像 Visual Studio 对 C#/VB/etc 所做的那样？事实上，任何支持 PHP 并包含代码生成工具的 IDE 都会受到关注。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T10:19:23.317

是和否；）

有些 IDE 支持 getter 和 setter 方法的代码生成。例如[用于 Eclipse 的商业 Zend Studio](http://www.zend.com)和带有 PHP 插件的免费[Aptana Studio 。](http://www.aptana.com)事实上，这与 C# 中的封装有点不同，因为你不会得到这个：

```
private String _name;

    public String Name

    {

        get { return _name; }

        set { _name = value; }

    } 
```

但是这样的：

```
<?php

class sample 
{
protected $myMember;

public function getMyMember()
{
    return $this->myMember;
}

public function setMyMember($myMember)
{
    $this->myMember = $myMember;
}
}
?> 
```

希望这个对你有帮助。

问候，马里奥

# sql - 奇怪的 SQL Server 查询问题

> ID：776235
> 
> 赞同：2
> 
> 时间：2009-04-22T08:45:14.213
> 
> 标签：sql, sql-server, sql-server-2005, stored-procedures

所以我对 SQL Server 存储过程有这个奇怪的问题。基本上我有这个漫长而复杂的过程。像这样的东西：

```
SELECT Table1.col1, Table2.col2, col3
FROM Table1 INNER JOIN Table2
     Table2 INNER JOIN Table3
     -----------------------
     -----------------------
     (Lots more joins)
WHERE Table1.Col1 = dbo.fnGetSomeID() AND (More checks)
     -----------------------
     -----------------------
(6-7 More queries like this with the same check) 
```

问题是在**Table1.Col1 = dbo.fnGetSomeID()**末尾检查 WHERE 子句。函数 dbo.fnGetSomeID() 返回一个简单的整数值**1**。因此，当我对函数调用应该是 SP的值**1进行硬编码时，只需要大约 15 秒。**但是当我用 WHERE 子句中的函数调用替换它时，大约需要 3.5 分钟。

所以我这样做：

```
DECLARE @SomeValue INT
SET @SomeValue = dbo.fnGetSomeID()
--Where clause changed
WHERE Table1.Col1 = @SomeValue 
```

所以现在这个函数只被调用一次。但还是一样的3.5分钟。所以我继续这样做：

```
DECLARE @SomeValue INT
--Removed the function, replaced it with 1
SET @SomeValue = 1
--Where clause changed
WHERE Table1.Col1 = @SomeValue 
```

仍然需要3.5分钟。为什么会影响性能？以及如何让它消失？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T13:08:44.063

即使 @SomeValue 设置为 1，当您有

```
WHERE Table1.Col1 = @SomeValue 
```

SQL Server 可能仍将 @SomeValue 视为变量，而不是硬编码的 1，这会相应地影响查询计划。并且由于 Table1 链接到 Table2，Table2 链接到 Table3 等等，所以运行查询的时间量被放大了。另一方面，当你有

```
WHERE Table1.Col1 = 1 
```

查询计划被 Table1.Col1 锁定为常数值 1。只是因为我们看到

```
WHERE Table1.Col1 = @SomeValue 
```

作为“硬编码”，并不意味着 SQL 以同样的方式看待它。每个可能的笛卡尔积都是候选者，需要对每个可能的 @SomeValue 进行评估。因此，标准建议适用 - 检查您的执行计划，如果需要，重写查询。

此外，这些连接列是否已编入索引？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T13:07:39.557

正如其他地方所提到的，执行计划会有所不同，具体取决于您采用的方法。我会查看两个执行计划，看看那里是否有明显的答案。

[这个问题](https://stackoverflow.com/questions/440944/sql-server-query-fast-but-slow-from-procedure)描述了一个类似的问题，在那种情况下的答案竟然涉及连接设置。

我自己也遇到了几乎完全相同的***问题*** [，](https://stackoverflow.com/questions/710439/why-is-my-inline-table-udf-so-much-slower-when-i-use-variable-parameters-rather-t)在这种情况下我发现使用较新的构造（SQL 2008 中的分析函数）显然会使优化器感到困惑。对于您来说可能不是这种情况，因为您使用的是 SQL 2005，但根据查询的其余部分，可能会发生类似的情况。

要查看的另一件事是您是否对 Table1.Col1 的值分布有偏差——如果优化器在您使用函数或变量而不是常量时使用一般执行计划，这可能会导致它选择次优加入比当它可以清楚地看到该值是一​​个特定的常数时。

如果所有其他方法都失败了，并且此查询不在另一个 UDF 中，您可以像以前一样预先计算 fnGetSomeID() UDF 的值，然后将整个查询包装在动态 SQL 中，将值作为 SQL 字符串中的常量提供。这应该会给你更快的性能，但每次都重新编译查询（在这种情况下这应该是一个很好的交易）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T00:46:01.877

您可以尝试使用 OPTIMIZE FOR 提示来强制执行给定常量的计划，但结果可能不一致；在 2008 年，您可以使用 OPTIMIZE FOR UNKNOWN

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T03:27:17.180

我认为由于优化器不知道函数做了多少工作，它会尝试最后评估它们。

我会尝试提前将函数的返回值存储在一个变量中，并在你的 where 子句中使用它。

此外，您可能想尝试模式绑定您的函数，因为显然有时它会[严重影响性能。](http://www.mssqltips.com/tip.asp?tip=1692)

您可以像这样绑定您的函数架构：

```
create function fnGetSomeID()
with schema_binding
returns int
... etc. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T10:24:46.720

另一件事要尝试。与其将 id 加载到变量中，不如将其加载到表中

```
if object_id('myTable') is not null drop myTable
select dbo.fnGetSomeID() as myID into myTable 
```

然后使用

```
WHERE Table1.Col1 = (select myID from myTable) 
```

在您的查询中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-11-12T03:01:38.300

> ```
>  (Lots more joins) 
> ```
> 
> WHERE Table1.Col1 = dbo.fnGetSomeID() AND（更多检查）

这不是一个好问题。最后，该值是由函数或子查询或变量返回还是常量都无关紧要。但确实如此，而且在某种程度的复杂性下，很难获得一致的结果。而且您无法真正调试它，因为您和这里的其他任何人都无法查看查询优化器的黑匣子。你所能做的就是戳它，看看它是如何表现的。

我认为查询优化器的行为不正常，因为查询中有很多表。当您告诉它查找时，`1`它会查看索引统计信息并做出不错的选择。*当您告诉它其他任何内容时，它假定它*应该根据它所 知道的内容加入，而不是相信您的函数/变量会返回一个选择性值。为此，Table1.Col1 必须具有不均匀的值分布。或者查询优化器不是，嗯，最优的。

无论哪种方式，估计的查询计划都应该有所不同。寻找添加（或有时删除）索引的机会。可能是 3.5 计划在很多情况下是合理的，而服务器真正想要的是更好的索引。

除此之外就是猜测。有时，可悲的是，答案在于找到产生一小组行的表子集，将它们放入临时表中，然后将其连接到其余表中。`OPTIMIZE FOR`提示也可能有用 。

但请记住，您提供的任何解决方案都是脆弱的，取决于数据和版本。

# visual-c++ - 创建txt文件

> ID：776240
> 
> 赞同：0
> 
> 时间：2009-04-22T08:46:41.650
> 
> 标签：visual-c++

在运行时的 MFC 应用程序项目中，我想创建一个 txt 文件，并且我想在其中存储一些数据，我不想在任何硬盘驱动器中创建记事本文件。它必须仅在应用程序中。当我单击 IDC_BUTTON1 时，它必须打开。然后用户必须决定是否将 txt 文件保存在硬盘中。

那么如何在执行期间创建一个记事本文件，以及在执行期间我必须打开和读取相同的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T08:54:32.833

您不需要文件，只需要内存中的变量来保存文本。您可以在 GUI 中的预览窗口中显示此文本。

如果用户想保存它，请将变量的内容写入光盘。如果您想在用户的默认文本编辑器中将此文件呈现给用户，您可以对刚刚创建的文件执行[ShellExecute()](http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx)。

**编辑：**您可以像这样调用函数

```
ShellExecute(
  NULL, 
  "open", 
  <path_to_textfile>, 
  NULL, 
  NULL, 
  SW_SHOWNORMAL); 
```

# c# - 如何将 Marshal.ReleaseComObject 与 Win32 本机函数一起使用

> ID：776244
> 
> 赞同：8
> 
> 时间：2009-04-22T08:48:09.400
> 
> 标签：c#, .net, com, interop

我正在玩这两个本机 win32 函数：

```
 [DllImport( "oleacc.dll" )]
    public static extern int AccessibleObjectFromWindow(
            IntPtr hwnd,
            int dwObjectID,
            ref Guid refID,
            ref Accessibility.IAccessible ppvObject );
    [DllImport( "oleacc.dll" )]
    public static extern uint AccessibleChildren(
        Accessibility.IAccessible paccContainer,
        int iChildStart, 
        int cChildren,
        [Out] object[] rgvarChildren,
        out int pcObtained ); 
```

而且我很难确定是否应该/需要对任何返回的对象调用 Marshal.ReleaseComObject 。我会很感激有人能在这个话题上启发我！这是一个示例用法：

```
 Accessibility.IAccessible test(
        int hWnd,
        string accessName )
    {
        Guid guidCOM = new Guid( 0x618736E0, 0x3C3D, 0x11CF, 0x81, 0xC, 0x0, 0xAA, 0x0, 0x38, 0x9B, 0x71 );
        Accessibility.IAccessible a = null;

        AccessibleObjectFromWindow(
            new IntPtr( hWnd ),
            -4,
            ref guidCOM,
            ref a );
        object[] children = new object[a.accChildCount];
        int z;
        AccessibleChildren( a, 0, children.Length, children, out z );
        foreach ( Accessibility.IAccessible a2 in children )
            try
            {
                if ( a2.get_accName( 0 ) == accessName )
                    return a2;
            }
            catch
            {
            }
        return null;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T08:59:36.020

`Marshal.ReleaseComObject`如果您确实需要让 GC 立即应用版本，而不是等待 GC 运行，这是一个有用的解决方法。除非你真的需要，否则最好不要使用它，因为它倾向于接管你的代码，你必须在任何地方应用它，包括你创建隐式引用的地方。

我怀疑 .Net 中 COM 互操作的最佳方法是围绕您正在使用的方法编写强类型包装类。这样就不可能引入隐式引用，并且会简化代码并确保 GC 更容易访问接口。我的一些牛人报告了使用这种方法获得了更好的内存行为——对象在 GC 运行时及时释放，不会留下任何神秘的引用。

一般来说，.Net 代码中引用的所有 COM 对象都以 RCW 对象的形式实现，该对象包含真正的 COM 引用——调用`ReleaseComObject`强制 RCW 将引用减一。这样，它类似于仅调用`Release`实际`IUnkown`实例。可能在您上面的示例中，没有必要拨打电话。

# 3d - 3D 渲染 - 这个问题叫什么？

> ID：776248
> 
> 赞同：1
> 
> 时间：2009-04-22T08:49:09.383
> 
> 标签：3d, rendering, polygon, papervision3d

希望这次是一个明智的问题......

在图片中看到上半部分的纹理看起来不错，但下半部分（在旋转一点之后）纹理正在分解，你可以看到形状的内部吗？多边形消失了？

这个问题叫什么？我需要知道，所以我知道修复它时要寻找什么！

顺便说一句，我正在 Papervision 中执行此操作。如果你有机会知道解决方法（或者如果可能的话），如果你能指出我正确的方向，我会允许你对自己感觉特别好。

[![这个叫什么？](https://i.stack.imgur.com/2QbpR.jpg "我的错误我无法命名")](https://i.stack.imgur.com/2QbpR.jpg "我的错误我无法命名")

多谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-22T08:58:03.107

我们称之为“z-fighting”——但更常见的术语是 z-ordering 或 z-buffer 问题。

我将尝试在没有图表的情况下解释问题 1。

3D 渲染器通过从后向前绘制多边形来工作。它通过将每个多边形分配给离散数量的位置之一来做到这一点。这适用于大多数场景。

当没有足够的插槽来决定哪个多边形在另一个多边形前面时，您会遇到问题。

要解决它 - 这将取决于您的应用程序，但有许多事情应该是所有人共有的：

1.  确保世界的边界框尽可能小。
2.  增加显示器的颜色深度。OpenGL 和 Direct3D 都可以将 z 槽的数量与显示器的分辨率联系起来。
3.  增加三角形的数量/减小三角形的大小。较小的三角形受此影响较小 - 但会降低性能，因为要绘制更多。

如果您在 Windows 上运行，则应将桌面设置为最高颜色分辨率。您的应用程序可能会将其作为默认使用。

可以在 OpenGL 和 Direct3D 渲染之间切换吗？如果是这样，那么尝试两者，一个可能会比另一个产生更好的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T08:52:00.407

不知何故，似乎是 Z 缓冲区问题。不过，我不熟悉你在那里使用的东西，所以我可能帮不上什么忙。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T09:01:59.727

它被称为[线性映射](http://en.wikipedia.org/wiki/Linear_mapping)，它是一种将纹理映射到多边形上的方法。但是这种方法没有进行透视校正，这会导致极端角度的纹理被破坏。

![线性映射](https://www.lysator.liu.se/~mikaelk/doc/perspectivetexture/tcube.gif) ![透视校正纹理映射](https://www.lysator.liu.se/~mikaelk/doc/perspectivetexture/ptcube.gif)

线性纹理映射（上）和透视校正纹理映射（下）。

唯一的解决方法是添加更多的多边形，这会影响性能（参见[这个](http://www.papervision3d.org/demos/LinearMapping/)演示）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T10:46:22.143

在我看来，它更像是一个出错的贴花，而不是 z-fighting。Z-fighting 通常有一些锯齿状的边缘。该特定三角形的投影矩阵可能是错误的（考虑到问题的程度取决于相机位置）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T08:57:56.383

您是否有多个重叠的纹理和/或多边形？

从这里看，当你有完全重合的表面时，你会遇到问题，但浮点错误意味着你不能始终看到正确的表面。

# c# - C#：应该在哪里放置事件处理程序委托？

> ID：776258
> 
> 赞同：4
> 
> 时间：2009-04-22T08:53:14.537
> 
> 标签：c#, event-handling, conventions

我有这堂课：

```
public class GenericEventArgs<T> : EventArgs
{
    public GenericEventArgs() : this(default(T)) {}
    public GenericEventArgs(T value) { Value = value; }
    public T Value { get; private set; }
} 
```

这个事件处理程序委托它：

```
public delegate void GenericEventHandler<T>(object sender, GenericEventArgs<T> e); 
```

我目前将这些放在同一个文件中的名称空间中。这被认为是坏的/凌乱的/等等吗？原因，一般来说，我会说每个文件应该只包含一个类。所以为了让它干净，我宁愿把这个`GenericEventArgs`类单独放在文件中。但是后来我有这个`GenericEventHandler<T>`代表，我不确定我应该放在哪里。它应该有自己的文件吗？就...那一行？（当然还有命名空间）

你通常是怎么做的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-22T08:57:26.133

有什么理由不使用`EventHandler<TEventArgs>`？我认为有一个等价物`EventArgs<T>`，但我现在看不到它......无论如何，我会`GenericEventArgs`输入`GenericEventArgs.cs`

就个人而言，当我想介绍我自己的委托类型（说实话，这种情况越来越少）时，我会创建一个`Delegates.cs`文件，其中包含命名空间的所有适当委托。然后我知道在哪里可以找到它们，而无需为单个声明创建文件.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T08:57:23.327

当我想创建自己的事件处理程序委托时，我曾经创建一个文件，该文件具有我在自己的事件处理程序委托中使用的 EventArgs 类的名称。例如“MyEventArgs.cs”。

该文件包含 MyEventArgs 类和使用此类的 MyEventHandler 委托。

然而，现在我使用现有的通用 EventHandler ( `EventHandler<T>`)，我只需要创建我的自定义 EventArgs 类。所以，这个“问题”对我来说不再存在。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T08:57:06.773

好吧，我会把这个`GenericEventArgs<T>`类放在它自己的文件中，叫做

GenericEventArgs_T.cs 在与其他所有内容相同的命名空间中。

而且我会将您的代表（如果有的话，还有事件）放在将要公开该事件的类中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-22T09:39:05.597

我会做您已经在做的事情，然后将所有未用于事件的委托放在一个名为 Delegates.cs 或类似文件的单独 .cs 文件中。

# c# - C#：如何将任意字符串解析为表达式树？

> ID：776265
> 
> 赞同：5
> 
> 时间：2009-04-22T08:55:16.793
> 
> 标签：c#, .net, parsing, expression-trees

在我正在进行的一个项目中，我必须使用一个相当奇怪的数据源。我可以给它一个“查询”，它会返回一个 DataTable。但是查询不是传统的字符串。它更像是......一组定义我想要的标准的方法调用。这些方面的东西：

```
var tbl = MySource.GetObject("TheTable");
tbl.AddFilterRow(new FilterRow("Column1", 123, FilterRow.Expression.Equals));
tbl.AddFilterRow(new FilterRow("Column2", 456, FilterRow.Expression.LessThan));
var result = tbl.GetDataTable(); 
```

从本质上讲，它支持所有标准的东西（布尔运算符、括号、一些函数等），但编写它的语法非常冗长且不适合日常使用。

我想制作一个小解析器来解析给定的表达式（如`"Column1 = 123 AND Column2 < 456"`）并将其转换为上述函数调用。另外，如果我可以在那里添加参数会很好，这样我就可以免受注入攻击。顶部的最后一点糖是如果它可以缓存解析结果并在要在另一个对象上重新执行相同的查询时重用它们。

所以我想知道 - 是否有任何现有的解决方案可以用于此，或者我是否必须推出自己的表达式解析器？这并不太复杂，但如果我可以节省两三天的编码时间和大量需要修复的错误，那将是值得的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-22T09:01:20.600

试试[讽刺](http://irony.codeplex.com/)。尽管缺少文档，但示例可以帮助您快速启动和运行。Irony 是一个用于解析代码和构建抽象语法树的项目，但您可能需要编写一些逻辑来创建适合您需求的表单。[DLR](http://dlr.codeplex.com/)可能是对此的补充，因为它可以从抽象语法树动态生成/执行代码（它用于 IronPython 和 IronRuby）。两者应该是很好的一对。

哦，它们都是一流的 .NET 解决方案和开源软件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T09:01:50.553

Bison 或 JavaCC 等将从语法生成解析器。然后，您可以使用自己的代码扩充树的节点以转换表达式。

OP 评论：我真的不想用我的软件发布第 3 方可执行文件。我希望它在我的代码中编译。

这两个工具都会生成*源代码*，您可以将其链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T18:15:01.440

我手工编写了一个解析器来精确地分析这种用法和复杂程度。大约花了2天时间。我很高兴我做到了，但我不会再这样做了。我会使用 ANTLR 或 F# 的 Fslex。

# ruby-on-rails - 动态 CMS，例如 ruby on rails 中的路由

> ID：776268
> 
> 赞同：7
> 
> 时间：2009-04-22T08:55:35.450
> 
> 标签：ruby-on-rails

我想创建一个类似 CMS 的网站，用户从一些通用页面开始，即

*   主页
*   关于
*   接触
*   ETC

并从那里可以动态添加子页面，例如

*   主页
    *   文章
        *   第1条
            *   某物
                *   别的东西
        *   第2条
*   关于
*   接触
*   ETC

为了实现这一点，我计划使用某种自我参照关联，例如

```
class Page < ActiveRecord::Base
  belongs_to :parent, :class_name => 'Page'
  has_many :children, :class_name => 'Page'
end 
```

我正在努力解决的一件事是路线生成。因为页面可以动态添加，所以我需要为这些页面动态生成路由，并且无法知道页面可以嵌套多少层

所以如果我从主页开始：/

然后开始添加页面，即

/articles/article1/something/something-else/another-thing

使用 rails 路由模型如何实现类似的效果？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-30T11:48:58.340

一旦你有办法为你的`Page`记录生成 URL 字符串（我将把这部分留给你），你可以映射每个页面`config/routes.rb`：

```
Page.all.each do |page|
  map.connect page.url, :controller => 'pages', :action => 'show', :id => page
end 
```

并让观察者挂钩页面模型以在发生变化时重新加载路由：

```
class PageObserver < ActiveRecord::Observer
  def reload_routes(page)
    ActionController::Routing::Routes.reload!
  end
  alias_method :after_save,    :reload_routes
  alias_method :after_destroy, :reload_routes
end 
```

不要忘记编辑`config/environment.rb`以加载观察者：

```
# Activate observers that should always be running
config.active_record.observers = :page_observer 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-22T13:19:42.010

这个问题的一种解决方案是从模型上的钩子中动态加载路由。`Slug`例如，我网站上模型的一个片段：

```
class Slug < ActiveRecord::Base

  belongs_to :navigable

  validates_presence_of :name, :navigable_id
  validates_uniqueness_of :name

  after_save :update_route

  def add_route
    new_route = ActionController::Routing::Routes.builder.build(name, route_options)
    ActionController::Routing::Routes.routes.insert(0, new_route)
  end

  def remove_route
    ActionController::Routing::Routes.routes.reject! { |r| r.instance_variable_get(:@requirements)[:slug_id] == id }
  end

  def update_route
    remove_route
    add_route
  end

  def route_options
    @route_options ||= { :controller     => navigable.controller, 
                         :action         => navigable.action, 
                         :navigable_id   => navigable_id,
                         :slug_id        => id }
  end

end 
```

这会在保存后以最高优先级（内存中的路由数组中的 0）插入路由。

此外，听起来您应该使用树管理插件，并且喜欢很棒的嵌套集或更好的嵌套集来管理您网站的树。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T09:09:23.313

您必须自己解析路线

```
map.connect '*url', :controller => 'pages', :action => 'show' 
```

现在，您的操作中应该有一个`params[:url]`可用的请求路径，它是一个由斜杠分隔的数组。一旦你有了这些字符串，从那里找到你需要的模型就很简单了。

那是凭记忆，已经很久了。希望对你有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T09:59:41.170

看看 RadiantCMS 来源，据我了解他们的自我描述，他们实现了该功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-27T18:04:28.510

我已经在 Rails gem 中实现了类似的功能，使用自引用关联和类似 js 接口的树来重新排序和嵌套“页面”。

模板语言和身份验证/授权留给开发人员实现。 [https://github.com/maca/tiny_cms](https://github.com/maca/tiny_cms)

# c# - 为什么我使用此 Linq to Sql 方法得到 InvalidOperationException？

> ID：776269
> 
> 赞同：3
> 
> 时间：2009-04-22T08:55:43.267
> 
> 标签：c#, sql, linq, linq-to-sql

执行以下 linq to sql 语句时：

```
 var stuff = from l in _db.SqlLinks
                select new
                           {
                               Link = l,
                               Rating = (from v in l.SqlLinkVotes
                                         where v.Tag == tagId
                                               && v.VoteDate >= since
                                         select v.Vote).Sum(),
                               NumberOfVotes = (from v in l.SqlLinkVotes
                                                where v.Tag == tagId
                                                      && v.VoteDate >= since
                                                select v.Vote).Count(),
                               NumberOfComments = (from v in l.SqlLinkVotes
                                                   where v.Tag == tagId
                                                         && v.VoteDate >= since
                                                         && v.Comment != ""
                                                   select v.Vote).Count()
                           }; 
```

我得到一个 System.InvalidOperationException（空值不能分配给 Int32）。

通过调试，我发现这来自动态对象的 Rating 属性。

当特定链接没有 SqlLinkVotes 时，Sum() 会产生一个空值，但 Rating 是一个 int，而 linq to sql 认为 Sum() 将产生一个 int，而不是一个可为空的 int。

我可以很容易地编写一个存储过程来解决这个问题，但我认为这对我来说是更好地理解 linq to sql 的好方法。

请帮忙！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T09:04:16.537

有一个[关于此的 Connect 线程](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=360365)建议您将结果`Sum()`转换为可为空的类型（`int?`在您的情况下）。我怀疑如果您希望评级不可为空，则可以使用 null-coalescing 运算符：

```
Rating = ((int?) (from v in l.SqlLinkVotes
                  where v.Tag == tagId
                     && v.VoteDate >= 
                  select v.Vote).Sum()) ?? 0 
```

无论如何，值得一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T09:04:29.113

看起来像简单地将 Rating 字段转换为可为空的 int 已修复它。

这对其他人来说是否明智？

```
var stuff = from l in _db.SqlLinks
                        select new
                                   {
                                       Link = l,
                                       Rating = (int?)(from v in l.SqlLinkVotes
                                                 where v.Tag == tagId
                                                       && v.VoteDate >= since
                                                 select v.Vote).Sum(),
                                       NumberOfVotes = (from v in l.SqlLinkVotes
                                                        where v.Tag == tagId
                                                              && v.VoteDate >= since
                                                        select v.Vote).Count(),
                                       NumberOfComments = (from v in l.SqlLinkVotes
                                                           where v.Tag == tagId
                                                                 && v.VoteDate >= since
                                                                 && v.Comment != ""
                                                           select v.Vote).Count()
                                   }; 
```

# winapi - MsgWaitForMultipleObjectsEx 和警报等待状态

> ID：776280
> 
> 赞同：0
> 
> 时间：2009-04-22T08:58:29.907
> 
> 标签：winapi

`MsgWaitForMultipleObjects()`是否可以使用/进入警报等待状态`MsgWaitForMultipleObjectsEx()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T01:16:54.473

如果您将 MWMO_ALERTABLE 标志指定为最后一个参数（dwFlags - 等待类型），则可以进入警报等待

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T09:28:15.887

`MsgWaitForMultipleObjectsEx`将线程置于警报等待状态。

[来自SleepEx](http://msdn.microsoft.com/en-us/library/ms686307.aspx)上的 MSDN ：

> 线程通过调用 SleepEx、MsgWaitForMultipleObjectsEx、WaitForSingleObjectEx 或 WaitForMultipleObjectsEx 进入警报等待状态，并将函数的 bAlertable 参数设置为 TRUE。

# c++ - C++中的restrict关键字是什么意思？

> ID：776283
> 
> 赞同：212
> 
> 时间：2009-04-22T08:59:06.690
> 
> 标签：c++, restrict-qualifier

我一直不确定，C++ 中的 restrict 关键字是什么意思？

这是否意味着赋予函数的两个或多个指针不重叠？还有什么意思？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2009-12-27T08:22:11.827

在他的论文[Memory Optimization](http://www.research.scea.com/research/pdfs/GDC2003_Memory_Optimization_18Mar03.pdf)中，Christer Ericson 说虽然`restrict`它还不是 C++ 标准的一部分，但许多编译器都支持它，他建议在可用时使用它：

> 限制关键字
> 
> ！新 1999 ANSI/ISO C 标准
> 
> ！尚不在 C++ 标准中，但被许多 C++ 编译器支持
> 
> ！只是一个提示，所以可能什么都不做但仍然符合
> 
> 限制限定的指针（或引用）...
> 
> ！...基本上是对编译器的承诺，对于指针的范围，指针的目标将只能通过该指针（以及从它复制的指针）访问。

在支持它的 C++ 编译器中，它的行为可能与 C 中的相同。

有关详细信息，请参阅此 SO 帖子： [C99 'restrict' 关键字的实际用法？](https://stackoverflow.com/questions/745870/realistic-usage-of-the-c99-restrict-keyword)

花半小时浏览一下 Ericson 的论文，很有趣，值得花时间。

**编辑**

我还发现 IBM 的[AIX C/C++ 编译器支持`__restrict__`关键字](http://www-01.ibm.com/support/knowledgecenter/SSLTBW_2.1.0/com.ibm.zos.v2r1.cbclx01/restrict_type_qualifier.htm?lang=en).

g++ 似乎也支持这一点，因为以下程序可以在 g++ 上干净地编译：

```
#include <stdio.h>

int foo(int * __restrict__ a, int * __restrict__ b) {
    return *a + *b;
}

int main(void) {
    int a = 1, b = 1, c;

    c = foo(&a, &b);

    printf("c == %d\n", c);

    return 0;
} 
```

我还发现了一篇关于使用的不错的文章`restrict`：

[揭秘 Restrict 关键字](http://cellperformance.beyond3d.com/articles/2006/05/demystifying-the-restrict-keyword.html)

**编辑2**

我遇到了一篇专门讨论在 C++ 程序中使用限制的文章：

[加载命中存储和 __restrict 关键字](http://assemblyrequired.crashworks.org/load-hit-stores-and-the-__restrict-keyword/)

此外，Microsoft Visual C++[也支持`__restrict`关键字](http://msdn.microsoft.com/en-us/library/5ft82fed(VS.80).aspx).

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2015-06-14T09:37:03.800

正如其他人所说，它**从 C++14 开始没有任何意义**，所以让我们考虑`__restrict__`与 C99 相同的 GCC 扩展`restrict`。

**C99**

`restrict`表示两个指针不能指向重叠的内存区域。最常见的用法是用于函数参数。

这限制了函数的调用方式，但允许更多的编译优化。

如果调用者不遵守`restrict`合同，可能会发生未定义的行为。

[C99 N1256 草案](http://www.open-std.org/JTC1/SC22/WG14/www/docs/n1256.pdf)6.7.3 /7“类型限定符”说：

> 限制限定符（如寄存器存储类）的预期用途是促进优化，并且从构成符合程序的所有预处理翻译单元中删除限定符的所有实例不会改变其含义（即，可观察的行为）。

和 6.7.3.1 “限制的正式定义”给出了血淋淋的细节。

**可能的优化**

维基[百科的例子](https://en.wikipedia.org/wiki/Restrict)很有启发*性。*

它清楚地显示了**它如何允许保存一条汇编指令**。

无限制：

```
void f(int *a, int *b, int *x) {
  *a += *x;
  *b += *x;
} 
```

伪组装：

```
load R1 ← *x    ; Load the value of x pointer
load R2 ← *a    ; Load the value of a pointer
add R2 += R1    ; Perform Addition
set R2 → *a     ; Update the value of a pointer
; Similarly for b, note that x is loaded twice,
; because x may point to a (a aliased by x) thus 
; the value of x will change when the value of a
; changes.
load R1 ← *x
load R2 ← *b
add R2 += R1
set R2 → *b 
```

有限制：

```
void fr(int *restrict a, int *restrict b, int *restrict x); 
```

伪组装：

```
load R1 ← *x
load R2 ← *a
add R2 += R1
set R2 → *a
; Note that x is not reloaded,
; because the compiler knows it is unchanged
; "load R1 ← *x" is no longer needed.
load R2 ← *b
add R2 += R1
set R2 → *b 
```

**海湾合作委员会真的做到了吗？**

`g++`4.8 Linux x86-64：

```
g++ -g -std=gnu++98 -O0 -c main.cpp
objdump -S main.o 
```

与`-O0`，它们是相同的。

与`-O3`：

```
void f(int *a, int *b, int *x) {
    *a += *x;
   0:   8b 02                   mov    (%rdx),%eax
   2:   01 07                   add    %eax,(%rdi)
    *b += *x;
   4:   8b 02                   mov    (%rdx),%eax
   6:   01 06                   add    %eax,(%rsi)  

void fr(int *__restrict__ a, int *__restrict__ b, int *__restrict__ x) {
    *a += *x;
  10:   8b 02                   mov    (%rdx),%eax
  12:   01 07                   add    %eax,(%rdi)
    *b += *x;
  14:   01 06                   add    %eax,(%rsi) 
```

对于初学者，[调用约定](https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI)是：

*   `rdi`= 第一个参数
*   `rsi`= 第二个参数
*   `rdx`= 第三个参数

GCC 输出比 wiki 文章更清晰：4 条指令与 3 条指令。

**数组**

到目前为止，我们节省了单条指令，但是如果指针表示要循环的数组，这是一个常见的用例，那么可以节省一堆指令，正如[supercat](https://stackoverflow.com/questions/745870/realistic-usage-of-the-c99-restrict-keyword/30827311?noredirect=1#comment59424338_30827311)和[michael](https://stackoverflow.com/a/745877/895245)所提到的。

考虑例如：

```
void f(char *restrict p1, char *restrict p2, size_t size) {
     for (size_t i = 0; i < size; i++) {
         p1[i] = 4;
         p2[i] = 9;
     }
 } 
```

因为`restrict`，智能编译器（或人类）可以将其优化为：

```
memset(p1, 4, size);
memset(p2, 9, size); 
```

哪个可能更有效，因为它可能在体面的 libc 实现（如 glibc）上进行了汇编优化 在[性能方面使用 std::memcpy() 或 std::copy() 更好吗？](https://stackoverflow.com/questions/4707012/c-memcpy-vs-stdcopy)，可能带有[SIMD 指令](https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions)。

如果没有限制，则无法进行此优化，例如考虑：

```
char p1[4];
char *p2 = &p1[1];
f(p1, p2, 3); 
```

然后`for`版本制作：

```
p1 == {4, 4, 4, 9} 
```

而`memset`版本使：

```
p1 == {4, 9, 9, 9} 
```

**海湾合作委员会真的做到了吗？**

GCC 5.2.1.Linux x86-64 Ubuntu 15.10：

```
gcc -g -std=c99 -O0 -c main.c
objdump -dr main.o 
```

，`-O0`两者是一样的。

与`-O3`：

*   有限制：

    ```
    3f0:   48 85 d2                test   %rdx,%rdx
    3f3:   74 33                   je     428 <fr+0x38>
    3f5:   55                      push   %rbp
    3f6:   53                      push   %rbx
    3f7:   48 89 f5                mov    %rsi,%rbp
    3fa:   be 04 00 00 00          mov    $0x4,%esi
    3ff:   48 89 d3                mov    %rdx,%rbx
    402:   48 83 ec 08             sub    $0x8,%rsp
    406:   e8 00 00 00 00          callq  40b <fr+0x1b>
                            407: R_X86_64_PC32      memset-0x4
    40b:   48 83 c4 08             add    $0x8,%rsp
    40f:   48 89 da                mov    %rbx,%rdx
    412:   48 89 ef                mov    %rbp,%rdi
    415:   5b                      pop    %rbx
    416:   5d                      pop    %rbp
    417:   be 09 00 00 00          mov    $0x9,%esi
    41c:   e9 00 00 00 00          jmpq   421 <fr+0x31>
                            41d: R_X86_64_PC32      memset-0x4
    421:   0f 1f 80 00 00 00 00    nopl   0x0(%rax)
    428:   f3 c3                   repz retq 
    ```

    两个`memset`电话符合预期。

*   没有限制：没有 stdlib 调用，只有 16 次迭代宽[循环展开](https://en.wikipedia.org/wiki/Loop_unrolling)，我不打算在这里重现 :-)

我没有耐心对它们进行基准测试，但我相信限制版本会更快。

**严格的别名规则**

该`restrict`关键字仅影响兼容类型的指针（例如 two `int*`），因为严格的别名规则表明别名不兼容的类型默认情况下是未定义的行为，因此编译器可以假定它不会发生并优化掉。

请参阅：[什么是严格的别名规则？](https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule)

**它对参考有用吗？**

根据 GCC 文档，它确实：[https](https://gcc.gnu.org/onlinedocs/gcc-5.1.0/gcc/Restricted-Pointers.html) ://gcc.gnu.org/onlinedocs/gcc-5.1.0/gcc/Restricted-Pointers.html语法：

```
int &__restrict__ rref 
```

甚至还有一个`this`成员函数的版本：

```
void T::fn () __restrict__ 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-22T09:01:59.540

没有什么。它被添加到 C99 标准中。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-22T09:03:43.140

[这](http://www.lysator.liu.se/c/restrict.html)是添加此关键字的原始建议。不过，正如迫切指出的那样，这是[C99](http://en.wikipedia.org/wiki/C99)的一项功能。它与 C++ 无关。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-12-05T17:47:27.817

由于某些 C 库的头文件使用关键字，C++ 语言将不得不对此做一些事情.. 至少忽略关键字，因此我们不必将关键字#define 为空白宏来抑制关键字.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-12-27T10:06:42.440

C++ 中没有这样的关键字。C++ 关键字列表可以在 C++ 语言标准的第 2.11/1 节中找到。`restrict`是 C 语言 C99 版本中的关键字，而不是 C++ 中的关键字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-13T14:03:53.710

有了`__restrict__`，`compiler`可以进行复杂的**优化**，因为程序员已经保证`__restrict__`修饰点指向绝对**不会相互重叠**的数据范围。`pointer**s**`

 **这通常是这种情况，因此为了实现高性能目标，您最多可以在代码中添加一个`__restrict__`装饰器`pointers`。

# java - 给定一个字符串，生成一个可以解析 *similar* 字符串的正则表达式

> ID：776286
> 
> 赞同：26
> 
> 时间：2009-04-22T09:00:13.677
> 
> 标签：java, regex

例如，给定字符串“2009/11/12”，我想得到正则表达式（“\d{2}/d{2}/d{4}”），所以我将能够匹配“2001/ 01/02”也是如此。

有什么可以做到的吗？相似的东西？关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-22T09:14:54.610

有[text2re](http://www.txt2re.com/)，一个免费的基于网络的“正则表达式示例”生成器。

不过，我认为这在源代码中不可用。我敢说没有自动正则表达式生成器可以在没有用户干预的情况下正确处理，因为这需要机器知道你想要什么。

* * *

请注意，text2re 使用基于模板、模块化且非常通用的方法来生成正则表达式。它生成的表达式有效，但它们比等效的手工表达式复杂得多。它不是*学习*正则表达式的好工具，因为它在设置示例方面做得非常糟糕。

例如，字符串`"2009/11/12"`将被识别为`yyyymmdd`模式，这很有帮助。该工具将其转换为*这个*125 个字符的怪物：

```
((?:(?:[1]{1}\d{1}\d{1}\d{1})|(?:[2]{1}\d{3}))[-:\/.](?:[0]?[1-9]|[1][012])[-:\/.](?:(?:[0-2]?\d{1})|(?:[3][01]{1})))(?![\d]) 
```

手工制作的内容仅占其中的五分之二（50 个字符）：

```
([12]\d{3})[-:/.](0?\d|1[0-2])[-:/.]([0-2]?\d|3[01])\b 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-22T09:08:58.383

不可能为您的问题编写通用解决方案。问题是任何生成器都可能不知道您要检查什么，例如是否也应允许“2312/45/67”？“2009.11.12”呢？

您可以做的是自己编写一个适合您的确切问题的生成器，但不可能有一个通用的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-22T09:37:32.323

我尝试了一种非常天真的方法：

```
class RegexpGenerator {

    public static Pattern generateRegexp(String prototype) {
        return Pattern.compile(generateRegexpFrom(prototype));
    }

    private static String generateRegexpFrom(String prototype) {
        StringBuilder stringBuilder = new StringBuilder();

        for (int i = 0; i < prototype.length(); i++) {
            char c = prototype.charAt(i);

            if (Character.isDigit(c)) {
                stringBuilder.append("\\d");
            } else if (Character.isLetter(c)) {
                stringBuilder.append("\\w");
            } else { // falltrought: literal
                stringBuilder.append(c);
            }
        }

        return stringBuilder.toString();
    }

    private static void test(String prototype) {
        Pattern pattern = generateRegexp(prototype);
        System.out.println(String.format("%s -> %s", prototype, pattern));

        if (!pattern.matcher(prototype).matches()) {
            throw new AssertionError();
        }
    }

    public static void main(String[] args) {
        String[] prototypes = {
            "2009/11/12",
            "I'm a test",
            "me too!!!",
            "124.323.232.112",
            "ISBN 332212"
        };

        for (String prototype : prototypes) {
            test(prototype);
        }
    }
} 
```

输出：

2009/11/12 -> \d\d​​\d\d/\d\d/\d\d
我是一个测试 -> \w'\w \w \w\w\w\w
我也是！ ！！-> \w\w \w\w\w！！！
124.323.232.112 -> \d\d​​\d.\d\d\d.\d\d\d.\d\d\d
ISBN 332212 -> \w\w\w\w \d\d​​\d \d\d\d

正如其他人已经概述的那样，这个问题的一般解决方案是不可能的。此类仅适用于少数情况

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-21T11:12:14.917

对不起，你们都说不可能的事情显然是可以完成的任务。它不能给出所有例子的结果，也许不是最好的结果，但你可以给它各种提示，它会让生活变得轻松。下面将举几个例子。

翻译结果的可读输出也将非常有用。就像是：

*   *“搜索：以非数字字母开头并以字符串结尾的单词：“ing”。*
*   或：*搜索： 包含 bbb 的文本，后跟 zzz*
*   或：*搜索：一个看起来如此的模式“aa/bbbb/cccc”，其中“/”是分隔符，“aa”是两位数，“bbbb”是任意长度的单词，“cccc”是介于两者之间的四位数字1900 年和 2020 年 *

也许我们可以用 SQL 类型的语言创建一个“反向翻译器”来创建正则表达式，而不是用极客的方式创建它。

以下是一些可行的示例：

```
class Hint: 
  Properties: HintType, HintString
  enum HintType { Separator, ParamDescription, NumberOfParameters }
  enum SampleType { FreeText, DateOrTime, Formatted, ... }
  public string RegexBySamples( List<T> samples, 
         List<SampleType> sampleTypes, 
         List<Hint> hints, 
         out string GeneralRegExp, out string description, 
         out string generalDescription)...

regex = RegExpBySamples( {"11/November/1999", "2/January/2003"}, 
                     SampleType.DateOrTime, 
                     new HintList( HintType.NumberOfParameters, 3 ));

regex = RegExpBySamples( "123-aaaaJ-1444", 
                         SampleType.Format, HintType.Seperator, "-" ); 
```

标记示例文本或输入它的 GUI，添加到正则表达式也是可能的。首先你标记一个日期（“样本”），然后选择这个文本是否已经格式化，或者如果你正在构建一个格式，还有格式类型是什么：自由文本、格式化文本、日期、GUID 或选择...从现有格式（您可以存储在库中）。

让我们为此设计一个规范，并使其开源......有人想加入吗？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-21T11:29:04.757

[洛雷托](http://konryd.blogspot.com/2007/08/making-code-editing-better-experience.html)几乎就是这样做的。这是一个开源实现，使用常见的最长子字符串来生成正则表达式。当然，需要多个示例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T09:11:13.603

不，您无法获得与您想要的可靠匹配的正则表达式，因为正则表达式不包含有关输入的语义信息（即它需要知道它正在为日期生成正则表达式）。如果问题仅与日期有关，我建议尝试多个正则表达式，看看其中一个是否匹配所有。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-22T09:11:41.387

我不确定这是否可能，至少在没有很多样本字符串和一些学习算法的情况下是不可能的。

有许多正则表达式可以匹配，简单的算法不可能选择“正确”的。您需要给它一些分隔符或其他要查找的东西，所以您不妨自己编写正则表达式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-22T13:47:10.400

听起来像是一个机器学习问题。您必须手头有多个示例（更多），并说明每个示例是否被视为匹配项。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-22T09:14:23.440

我不记得名字了，但如果我的计算单元理论对我有用，那理论上是不可能的:)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-27T08:57:29.590

我还没有找到任何东西，但是由于问题域*相对*较小（你会惊讶于有多少人使用最奇怪的日期格式），我已经能够编写某种“日期正则表达式生成器” . 一旦我对单元测试感到满意，我就会发布它——以防万一有人需要这种东西。

感谢所有回答的人（排除了 (.*) 的那个人 - 笑话很棒，但这个很糟糕 :) ）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-06-17T05:16:25.837

除了提供“好”输入的学习算法示例之外，您还可以提供“坏”输入，这样它就会知道不该寻找什么。例如，电话号码中没有字母。

# delphi - 标准的 URL 编码功能？

> ID：776302
> 
> 赞同：48
> 
> 时间：2009-04-22T09:05:15.537
> 
> 标签：delphi

是否有与此 .net 方法等效的 Delphi：

```
Url.UrlEncode()
```

**注意**
我已经好几年没有使用 Delphi 了。当我阅读答案时，我注意到当前标记的答案有几个评论和替代方案。我没有机会测试它们，所以我的答案基于最受支持的。
为了您自己的利益，请检查以后的答案，并在决定投票最佳答案后，以便每个人都可以从您的经验中受益。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-04-22T09:20:40.057

查看 indy IdURI 单元，它在 TIdURI 类中有两个静态方法，用于对 URL 进行编码/解码。

```
uses
  IdURI;

..
begin
  S := TIdURI.URLEncode(str);
//
  S := TIdURI.URLDecode(str);
end; 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-13T00:43:56.343

Another simple way of doing this is to use the HTTPEncode function in the HTTPApp unit - very roughly

```
Uses 
  HTTPApp;

function URLEncode(const s : string) : string;
begin
  result := HTTPEncode(s);
end 
```

* * *

**HTTPEncode** is deprecated in Delphi 10.3 - 'Use TNetEncoding.URL.Decode'

```
Uses
  NetEncoding;

function URLEncode(const s : string) : string;
begin
  result := TNetEncoding.URL.Encode(s);
end 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-08-17T13:53:04.390

I made myself this function to encode everything except really safe characters. Especially I had problems with +. Be aware that you can not encode the whole URL with this function but you need to encdoe the parts that you want to have no special meaning, typically the values of the variables.

```
function MyEncodeUrl(source:string):string;
 var i:integer;
 begin
   result := '';
   for i := 1 to length(source) do
       if not (source[i] in ['A'..'Z','a'..'z','0','1'..'9','-','_','~','.']) then result := result + '%'+inttohex(ord(source[i]),2) else result := result + source[i];
 end; 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-22T18:41:08.430

另一种选择是使用[Synapse库，它在](http://www.ararat.cz/synapse/doku.php/download)[SynaCode](http://synapse.ararat.cz/doc/help/synacode.html)单元 中具有简单的 URL 编码方法（以及许多其他方法） 。

```
uses
  SynaCode;
..
begin
  s := EncodeUrl( str );
//
  s := DecodeUrl( str );
end; 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-04-11T14:50:36.520

2018 年更新：下面显示的代码似乎已过时。见雷米的评论。

```
class function TIdURI.ParamsEncode(const ASrc: string): string;
var
  i: Integer;
const
  UnsafeChars = '*#%<> []';  {do not localize}
begin
  Result := '';    {Do not Localize}
  for i := 1 to Length(ASrc) do
  begin
    if CharIsInSet(ASrc, i, UnsafeChars) or (not CharIsInSet(ASrc, i, CharRange(#33,#128))) then begin {do not localize}
      Result := Result + '%' + IntToHex(Ord(ASrc[i]), 2);  {do not localize}
    end else begin
      Result := Result + ASrc[i];
    end;
  end;
end; 
```

来自印地。

* * *

无论如何，Indy 无法正常工作，因此**您需要查看这篇文章**： http:
[//marc.durdin.net/2012/07/indy-tiduri-pathencode-urlencode-and-paramsencode-and-more/](http://marc.durdin.net/2012/07/indy-tiduri-pathencode-urlencode-and-paramsencode-and-more/)

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2014-10-29T22:49:58.790

Since Delphi xe7 you can use [TNetEncoding.Url.Encode()](http://docwiki.embarcadero.com/Libraries/XE7/de/System.NetEncoding.TNetEncoding.URL)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-23T07:28:31.033

在非 dotnet 环境中，Wininet 单元提供对 Windows 的 WinHTTP 编码功能的访问： [InternetCanonicalizeUrl](http://msdn.microsoft.com/en-us/library/aa384342(VS.85).aspx)

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2014-04-16T12:38:09.193

In recent versions of Delphi (tested with XE5), use the URIEncode function in the REST.Utils unit.

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2013-11-08T05:20:24.033

I was also facing the same issue (Delphi 4).

I resolved the issue using below mentioned function:

```
function fnstUrlEncodeUTF8(stInput : widestring) : string;
  const
    hex : array[0..255] of string = (
     '%00', '%01', '%02', '%03', '%04', '%05', '%06', '%07',
     '%08', '%09', '%0a', '%0b', '%0c', '%0d', '%0e', '%0f',
     '%10', '%11', '%12', '%13', '%14', '%15', '%16', '%17',
     '%18', '%19', '%1a', '%1b', '%1c', '%1d', '%1e', '%1f',
     '%20', '%21', '%22', '%23', '%24', '%25', '%26', '%27',
     '%28', '%29', '%2a', '%2b', '%2c', '%2d', '%2e', '%2f',
     '%30', '%31', '%32', '%33', '%34', '%35', '%36', '%37',
     '%38', '%39', '%3a', '%3b', '%3c', '%3d', '%3e', '%3f',
     '%40', '%41', '%42', '%43', '%44', '%45', '%46', '%47',
     '%48', '%49', '%4a', '%4b', '%4c', '%4d', '%4e', '%4f',
     '%50', '%51', '%52', '%53', '%54', '%55', '%56', '%57',
     '%58', '%59', '%5a', '%5b', '%5c', '%5d', '%5e', '%5f',
     '%60', '%61', '%62', '%63', '%64', '%65', '%66', '%67',
     '%68', '%69', '%6a', '%6b', '%6c', '%6d', '%6e', '%6f',
     '%70', '%71', '%72', '%73', '%74', '%75', '%76', '%77',
     '%78', '%79', '%7a', '%7b', '%7c', '%7d', '%7e', '%7f',
     '%80', '%81', '%82', '%83', '%84', '%85', '%86', '%87',
     '%88', '%89', '%8a', '%8b', '%8c', '%8d', '%8e', '%8f',
     '%90', '%91', '%92', '%93', '%94', '%95', '%96', '%97',
     '%98', '%99', '%9a', '%9b', '%9c', '%9d', '%9e', '%9f',
     '%a0', '%a1', '%a2', '%a3', '%a4', '%a5', '%a6', '%a7',
     '%a8', '%a9', '%aa', '%ab', '%ac', '%ad', '%ae', '%af',
     '%b0', '%b1', '%b2', '%b3', '%b4', '%b5', '%b6', '%b7',
     '%b8', '%b9', '%ba', '%bb', '%bc', '%bd', '%be', '%bf',
     '%c0', '%c1', '%c2', '%c3', '%c4', '%c5', '%c6', '%c7',
     '%c8', '%c9', '%ca', '%cb', '%cc', '%cd', '%ce', '%cf',
     '%d0', '%d1', '%d2', '%d3', '%d4', '%d5', '%d6', '%d7',
     '%d8', '%d9', '%da', '%db', '%dc', '%dd', '%de', '%df',
     '%e0', '%e1', '%e2', '%e3', '%e4', '%e5', '%e6', '%e7',
     '%e8', '%e9', '%ea', '%eb', '%ec', '%ed', '%ee', '%ef',
     '%f0', '%f1', '%f2', '%f3', '%f4', '%f5', '%f6', '%f7',
     '%f8', '%f9', '%fa', '%fb', '%fc', '%fd', '%fe', '%ff');
 var
   iLen,iIndex : integer;
   stEncoded : string;
   ch : widechar;
 begin
   iLen := Length(stInput);
   stEncoded := '';
   for iIndex := 1 to iLen do
   begin
     ch := stInput[iIndex];
     if (ch >= 'A') and (ch <= 'Z') then
       stEncoded := stEncoded + ch
     else if (ch >= 'a') and (ch <= 'z') then
       stEncoded := stEncoded + ch
     else if (ch >= '0') and (ch <= '9') then
       stEncoded := stEncoded + ch
     else if (ch = ' ') then
       stEncoded := stEncoded + '+'
     else if ((ch = '-') or (ch = '_') or (ch = '.') or (ch = '!') or (ch = '*')
       or (ch = '~') or (ch = '\')  or (ch = '(') or (ch = ')')) then
       stEncoded := stEncoded + ch
     else if (Ord(ch) <= $07F) then
       stEncoded := stEncoded + hex[Ord(ch)]
     else if (Ord(ch) <= $7FF) then
     begin
        stEncoded := stEncoded + hex[$c0 or (Ord(ch) shr 6)];
        stEncoded := stEncoded + hex[$80 or (Ord(ch) and $3F)];
     end
     else
     begin
        stEncoded := stEncoded + hex[$e0 or (Ord(ch) shr 12)];
        stEncoded := stEncoded + hex[$80 or ((Ord(ch) shr 6) and ($3F))];
        stEncoded := stEncoded + hex[$80 or ((Ord(ch)) and ($3F))];
     end;
   end;
   result := (stEncoded);
 end; 
```

source : [Java source code](http://www.w3.org/International/O-URL-code.html)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2015-02-22T19:28:07.840

I have made my own function. It converts spaces to %20, not to plus sign. It was needed to convert local file path to path for browser (with file:/// prefix). The most important is it handles UTF-8 strings. It was inspired by Radek Hladik's solution above.

```
function URLEncode(s: string): string;
var
  i: integer;
  source: PAnsiChar;
begin
  result := '';
  source := pansichar(s);
  for i := 1 to length(source) do
    if not (source[i - 1] in ['A'..'Z', 'a'..'z', '0'..'9', '-', '_', '~', '.', ':', '/']) then
      result := result + '%' + inttohex(ord(source[i - 1]), 2)
    else
      result := result + source[i - 1];
end; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-22T09:16:28.100

AFAIK，您需要自己制作。

这是一个例子。

*   [HTTP编码](http://www.scalabium.com/faq/dct0126.htm)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-08-31T12:06:37.443

TIdUri or HTTPEncode has problems with unicode charactersets. Function below will do correct encoding for you.

```
function EncodeURIComponent(const ASrc: string): UTF8String;
const
  HexMap: UTF8String = '0123456789ABCDEF';

  function IsSafeChar(ch: Integer): Boolean;
  begin
    if (ch >= 48) and (ch <= 57) then Result := True    // 0-9
    else if (ch >= 65) and (ch <= 90) then Result := True  // A-Z
    else if (ch >= 97) and (ch <= 122) then Result := True  // a-z
    else if (ch = 33) then Result := True // !
    else if (ch >= 39) and (ch <= 42) then Result := True // '()*
    else if (ch >= 45) and (ch <= 46) then Result := True // -.
    else if (ch = 95) then Result := True // _
    else if (ch = 126) then Result := True // ~
    else Result := False;
  end;
var
  I, J: Integer;
  ASrcUTF8: UTF8String;
begin
  Result := '';    {Do not Localize}

  ASrcUTF8 := UTF8Encode(ASrc);
  // UTF8Encode call not strictly necessary but
  // prevents implicit conversion warning

  I := 1; J := 1;
  SetLength(Result, Length(ASrcUTF8) * 3); // space to %xx encode every byte
  while I <= Length(ASrcUTF8) do
  begin
    if IsSafeChar(Ord(ASrcUTF8[I])) then
    begin
      Result[J] := ASrcUTF8[I];
      Inc(J);
    end
    else if ASrcUTF8[I] = ' ' then
    begin
      Result[J] := '+';
      Inc(J);
    end
    else
    begin
      Result[J] := '%';
      Result[J+1] := HexMap[(Ord(ASrcUTF8[I]) shr 4) + 1];
      Result[J+2] := HexMap[(Ord(ASrcUTF8[I]) and 15) + 1];
      Inc(J,3);
    end;
    Inc(I);
  end;

  SetLength(Result, J-1);
end; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-02-25T23:07:52.487

I'd like to point out that if you care much more about correctness than about efficiency, the simplest you can do is hex encode every character, even if it's not strictly necessary.

Just today I needed to encode a few parameters for a basic HTML login form submission. After going through all the options, each with their own caveats, I decided to write this naive version that works perfectly:

```
function URLEncode(const AStr: string): string;
var
  LBytes: TBytes;
  LIndex: Integer;
begin
  Result := '';
  LBytes := TEncoding.UTF8.GetBytes(AStr);
  for LIndex := Low(LBytes) to High(LBytes) do
    Result := Result + '%' + IntToHex(LBytes[LIndex], 2);
end; 
```

# c++ - 在 C++ 中，如何使用模板函数作为 std::for_each 中的第三个参数？

> ID：776303
> 
> 赞同：3
> 
> 时间：2009-04-22T09:05:21.107
> 
> 标签：c++, templates, stl, foreach

我正在尝试使用 std::for_each 输出可能包含不同类型的向量的内容。所以我写了一个通用的输出函数，如下所示：

```
template<typename T> void output(const T& val)
{
    cout << val << endl;
} 
```

我想用它：

```
std::for_each(vec_out.begin(), vec_out.end(), output); 
```

但编译器在 for_each 语句中抱怨“无法推断模板参数”。还抱怨“一个函数模板不能作为另一个函数模板的参数”。

这不可能吗？我原以为编译器会知道 vec_o​​ut 的类型（它是向量），所以应该实例化函数“output(const double& val)”？

如果这不起作用，我如何在不编写手动循环的情况下获得类似的 STL 功能？

我对 C++ 很陌生，但仍在学习中 :-)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-22T09:11:54.447

尝试：

```
std::for_each(vec_out.begin(), vec_out.end(), output<T>); 
```

其中是类型 T`vec_out`的容器 ( )。`vector`

注意：该[`for_each`](http://www.sgi.com/tech/stl/for_each.html)算法的最后一个参数需要一个一元函子。有关使用函子的示例，请参阅链接。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-22T09:10:44.713

您必须传递模板的实例化。就像`output<int>`你的向量是整数向量一样。

例如：

```
template<typename T> void output(const T& val)
{
    cout << val << endl;
}

void main(int argc,char *argv[])
{
    std::vector<int> vec_out;
    std::for_each(vec_out.begin(), vec_out.end(), output<int>);
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-22T10:30:07.767

我只想添加正确的答案：如果您将模板函数包装在函数对象（又名函子）中，编译器可以推断出类型：

```
struct OutputFunctor
{
  template <typename T>
  void operator()(const T& val) const { output(val); }
};

void test()
{
  std::vector<int> ints;
  std::vector<float> floats;

  std::for_each(ints.begin(), ints.end(), OutputFunctor());
  std::for_each(floats.begin(), floats.end(), OutputFunctor());
} 
```

# c++ - ATL App 中的 TAB 控件背景，XP 样式

> ID：776304
> 
> 赞同：1
> 
> 时间：2009-04-22T09:05:23.727
> 
> 标签：c++, winapi, atl, xp-theme

我有一个 ATL 应用程序，其中包含一个包含 TAB 控件的对话框。该应用程序使用通用控件清单。

在具有视觉样式的 XP 下，选项卡控件背景与对话框和控件（主要是复选框）颜色不同，因此看起来很丑。

[截屏](http://www.codeproject.com/script/Membership/Uploads/175/ATLTAB.png)

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-06T08:07:57.273

显然，要使用 XP 视觉样式正确着色选项卡控制页面，需要做一件事。

在每个页面的 WM_INITDIALOG 处理程序中，调用 uxtheme API[`EnableThemeDialogTexture`](http://msdn.microsoft.com/en-us/library/bb773320(VS.85).aspx)

使用该`ETDT_ENABLETAB`标志，它会自动更改对话框及其所有子控件的背景颜色，以在选项卡上适当地绘制。

对话框页面不需要任何类型的透明标志，或者实际上任何与以前不同的样式位设置。如果您已覆盖DialogProc`WM_ERASEBKGND`或`WM_CTLCOLORDLG`在您的页面中，您将需要恢复为默认处理（返回`FALSE`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:51:28.340

复选框将向其父级发布 WM_CTLCOLORBTN 通知。如果对于复选框控件 ID，父窗口的消息处理程序返回

```
GetStockObject(HOLLOW_BRUSH) 
```

那么复选框应该用透明背景绘制，这应该会给你想要的外观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-15T18:32:03.223

[在这里](https://stackoverflow.com/questions/1042415/windows-xp-style-why-do-we-get-dark-grey-background-on-static-text-widgets)你可以找到你的问题的答案。

# c# - 如何在 C# 中的 MS Access 数据库中创建表

> ID：776305
> 
> 赞同：2
> 
> 时间：2009-04-22T09:05:58.360
> 
> 标签：c#

我需要在 MS Access 数据库中创建一个表。考虑一下，“ConfigStructure.mdb”是我的数据库名称，我需要用 C# 在这个数据库中创建一个表。

我怎样才能做到这一点？我尝试使用下面的代码，但它不起作用。

```
 OleDbConnection myConnection = new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" + frmMain.strFilePath + "\\ConfigStructure.mdb");
        myConnection.Open();
        string strTemp = " KEY Text, VALUE Text ";
        OleDbCommand myCommand = new OleDbCommand();
        myCommand.Connection = myConnection;
        myCommand.CommandText = "CREATE TABLE table1(" + strTemp + ")";
        myCommand.ExecuteNonQuery();
        myCommand.Connection.Close(); 
```

这是我得到的错误，

```
"System.Data.OleDb.OleDbException: Syntax error in field definition
System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object& executeResult)\r\n   at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object& executeResult)\r\n   at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object& executeResult)\r\n   at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method)" 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-22T09:23:59.143

代替

```
string strTemp = " KEY Text, VALUE Text "; 
```

和

```
string strTemp = " [KEY] Text, [VALUE] Text "; 
```

我认为这样做的原因是“KEY”和“VALUE”是 Access 或 SQL 中的保留关键字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T09:25:09.937

KEY 和 VALUE 都是[保留字](http://support.microsoft.com/kb/286335)。特别是它可能会挂在“KEY”上，因为您可以在命令中指定`PRIMARY KEY`为约束。`CREATE TABLE`

*如果您真的*想使用它们（不建议），请尝试使用不同的列名或用括号括起来（例如 [KEY] ）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T09:24:00.470

我怀疑问题是使用单词 KEY 作为列名 - 这可能是一个保留字。尝试使用不同的列名。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T09:25:51.680

“KEY”和“VALUE”是 MS Access 中的保留字。如果您希望将这些名称用于您的字段，则需要将它们括在方括号中：

```
string strTemp = " [KEY] Text, [VALUE] Text "; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T15:40:24.260

在我的计算机上，Windows 7 sp1 Professional 64 位，我找到了 Microsoft ADO Ext。2.8 用于*C:\Program Files\Common Files\System\ado\msadox28.dll*中的 DDL 和安全性。

它也可以作为参考：

![在此处输入图像描述](https://i.stack.imgur.com/BSyrT.png)

在参考文献中作为**ADOX包含**

![在此处输入图像描述](https://i.stack.imgur.com/nMmLj.png)

默认情况下，列创建为**text[255]**。以下是一些将列创建为不同数据类型的示例。

```
table.Columns.Append("PartNumber", ADOX.DataTypeEnum.adVarWChar, 6); // text[6]
table.Columns.Append("AnInteger", ADOX.DataTypeEnum.adInteger); // Integer 
```

我找到了这个数据类型列表来创建和读取访问数据库字段

> 访问文本 = adVarWChar
> 
> 访问备忘录 = adLongVarWChar
> 
> 访问数字字节 = adUnsignedTinyInt
> 
> 访问数字整数 = adSmallInt
> 
> 访问数字长整数 = adInteger
> 
> 访问数字单精度 = adSingle
> 
> 访问数字双精度 = adDouble
> 
> 访问数字 Replicatie-id = adGuid
> 
> 访问数字十进制 = adNumeric
> 
> 访问日期/时间 = adDate
> 
> 访问货币 = adCurrency
> 
> 访问自动编号 = adInteger
> 
> 访问是/否 = adBoolean
> 
> 访问超链接 = adLongVarWChar

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-04T11:23:12.007

您应该始终在这些 [] 中写入表和列的名称您的示例：

```
OleDbConnection myConnection = new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" + frmMain.strFilePath + "\\ConfigStructure.mdb");
myConnection.Open();
string strTemp = " [KEY] Text, [VALUE] Text ";
OleDbCommand myCommand = new OleDbCommand();
myCommand.Connection = myConnection;
myCommand.CommandText = "CREATE TABLE [table1](" + strTemp + ")";
myCommand.ExecuteNonQuery();
myCommand.Connection.Close(); 
```

完美运行。

# python - Appengine - 可以仅使用没有模型名称的键字符串来获取实体吗？

> ID：776324
> 
> 赞同：3
> 
> 时间：2009-04-22T09:15:04.530
> 
> 标签：python, google-app-engine

我希望能够有一个可以作用于许多不同类型的对象的视图

所有的视图将得到的是关键字符串，例如：

agpwb2xsdGhyZWFkchULEg9wb2xsY29yZV9hbnN3ZXIYAww

在不知道模型类型的情况下，是否可以仅从该键字符串中检索实体？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-27T23:34:25.050

不需要超类化，只需使用 db.get()：

```
from google.appengine.ext import db
key_str = 'agpwb2xsdGhyZWFkchULEg9wb2xsY29yZV9hbnN3ZXIYAww'
entity = db.get(key_str) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T09:18:19.280

如果你设计你的模型，让它们都使用一个通用的超类，那么应该可以使用类似的方法来检索你的对象：

```
entity = CommonSuperclass.get('agpwb2xsdGhyZWFkchULEg9wb2xsY29yZV9hbnN3ZXIYAww') 
```

# vb.net - 在 COM 对象上使用早期绑定

> ID：776331
> 
> 赞同：4
> 
> 时间：2009-04-22T09:18:14.790
> 
> 标签：vb.net, com, late-binding, option-strict

我有这段代码运行良好，并为我提供了用户开始菜单的路径：

```
 Dim oShell As Object = CreateObject("Shell.Application")
    MsgBox(oShell.NameSpace(11).Self.Path) 
```

这显然使用了后期绑定。现在说我想在 C# 或 VB.NET 严格模式下执行此操作，它们都不支持这种带有后期绑定的语法。

这可能吗？如何？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T09:48:22.453

如果你想用 COM 方式解决这个问题，你必须弄清楚在你的 VB 项目中添加哪个 COM 引用。

打开 regedit 并导航到`HKEY_CLASSES_ROOT\<class id>\CLSID`，即

```
HKEY_CLASSES_ROOT\Shell.Application\CLSID 
```

您将找到唯一标识 COM 组件的类 ID。

您现在可以在`HKEY_CLASSES_ROOT\CLSID`下面查找 COM 组件后面的文件：

```
HKEY_CLASSES_ROOT\CLSID\{13709620-C279-11CE-A49E-444553540000}\InProcServer32 
```

显示以下值：

```
%SystemRoot%\system32\SHELL32.dll 
```

现在转到 Visual Studio，并添加对此文件的引用（在“*添加引用*”对话框的“*浏览*”选项卡上）。如果您打开项目属性，您实际上会看到添加的 COM 组件的好听的名称是**Microsoft Shell Controls and Automation**。

 ***添加引用后，您可以`Shell.Application`按如下方式使用该对象：

```
Option Strict On

Module PrintStartMenuLocation

    Sub Main()
        Dim shell As New Shell32.Shell
        Dim folder As Shell32.Folder
        Dim folderItem As Shell32.FolderItem
        Dim startMenuPath As String

        folder = shell.NameSpace(Shell32.ShellSpecialFolderConstants.ssfSTARTMENU)
        folderItem = CType(folder.Items(0), Shell32.FolderItem)
        startMenuPath = folderItem.Path

        Console.WriteLine(startMenuPath)
    End Sub

End Module 
```

C# 中的版本如下所示：

```
class Program
{
    static void Main(string[] args)
    {
        Shell32.Shell shell = new Shell32.Shell();
        Shell32.Folder folder = shell.NameSpace(Shell32.ShellSpecialFolderConstants.ssfSTARTMENU);
        Shell32.FolderItem folderItem = folder.Items().Item(0) as Shell32.FolderItem;
        string startMenuPath = folderItem.Path;

        Console.WriteLine(startMenuPath);
    }
} 
```

但是，如果您只需要检索开始菜单文件夹的位置，您可以直接在 .NET 中使用

```
Dim path As String = System.Environment.GetFolderPath(Environment.SpecialFolder.StartMenu) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T09:46:56.873

那么实际上你可以使用反射：

```
Type shellType = Type.GetTypeFromProgID("Shell.Application", true);
object shell = Activator.CreateInstance(shellType);
object folder = shellType.InvokeMember("NameSpace", BindingFlags.InvokeMethod, null, shell, new object[] { 11 });
object self = folder.GetType().InvokeMember("Self", BindingFlags.GetProperty, null, folder, new object[] { });
object path = self.GetType().InvokeMember("Path", BindingFlags.GetProperty, null, self, new object[] { });
Console.WriteLine(path); 
```

不是我喜欢的那种代码，但在 C# 4.0 中，您可以使用[动态类型](http://geekswithblogs.net/sdorman/archive/2008/11/16/c-4.0-dynamic-programming.aspx)来清理这种混乱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T09:40:05.250

```
Dim DirPath As String = _
    System.Environment.GetFolderPath(Environment.SpecialFolder.StartMenu) 
```

请参阅[此处](http://visualbasic.about.com/od/usingvbnet/a/SpFldrs.htm)了解更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T09:24:41.137

如果我没记错的话，您所要做的就是将对象引用转换为适当的接口。如果您在 .NET 中使用 COM 对象，您通常会导入类型库，然后让接口随时可用。

# sql-server-2005 - SQL Server 2005 日期本地化

> ID：776333
> 
> 赞同：0
> 
> 时间：2009-04-22T09:19:39.327
> 
> 标签：sql-server-2005, date, localization

如果没有传递参数，我有一个默认为今天日期的程序。

```
CREATE Procedure GetDirectoryRenewalReminders    
(@DateToday datetime = Null)  
As     
If @DateToday Is Null   
Begin  
 Set @DateToday = GetDate()  
End  
...
Go 
```

当从英国的应用程序调用时，如何确保 GetDate() 值默认为当前英国时间，从澳大利亚的应用程序调用时默认为澳大利亚时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T09:31:52.853

您可以使用 GETUTCDATE() 从服务器获取 UTC 时间。然后你可以让客户端添加本地时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T09:32:10.793

客户端应用程序应将客户端位置的转换应用到 SQL Server 的标准日期时间......但您必须应用时区偏移量以使其在客户端中为 GMT。

然后与 GETUTCDATE() 进行比较

仅供参考：如果您是英国人，则 GMT 是 UTC ;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T09:32:10.840

它总是返回本地服务器时间。数据库服务器无法知道用户在时区方面的“位置”。您可以将时区偏移量传递给该过程。

# java - 从插件调用代码时出现问题：使用Checkstyle插件时出现“org.eclipse.jface”

> ID：776334
> 
> 赞同：20
> 
> 时间：2009-04-22T09:20:27.920
> 
> 标签：java, eclipse, eclipse-plugin, checkstyle, ibm-rational

我正在尝试在 Rational Software Architect 7.0.0.4 上使用 eclipse-cs 插件。

我最近卸载了旧的 beta2 版本并安装了 beta3。插件本身按照之前的配置工作。但是每当我尝试通过 Windows->Preferences->Checkstyle 重新配置检查规则时，我都会收到以下错误：

从插件调用代码时出现问题：“org.eclipse.jface”。

当我单击配置按钮并尝试在 UI 上重新配置特定的选定检查规则时，会发生这种情况。

以前有没有人遇到过这个问题，如何解决？

完整的错误列表和堆栈跟踪如下所示：

```
Stack trace:
java.lang.NoSuchMethodError: org/eclipse/swt/widgets/Text.setMessage(Ljava/lang/String;)V
at net.sf.eclipsecs.ui.config.RuleConfigurationEditDialog.createAdvancedSection(Unknown Source)
at net.sf.eclipsecs.ui.config.RuleConfigurationEditDialog.createDialogArea(Unknown Source)
at org.eclipse.jface.dialogs.TitleAreaDialog.createContents(Unknown Source)
at org.eclipse.jface.window.Window.create(Unknown Source)
at org.eclipse.jface.dialogs.Dialog.create(Unknown Source)
at net.sf.eclipsecs.ui.config.RuleConfigurationEditDialog.create(Unknown Source)
at org.eclipse.jface.window.Window.open(Unknown Source)
at net.sf.eclipsecs.ui.config.CheckConfigurationConfigureDialog$PageController.openModule(Unknown Source)
at net.sf.eclipsecs.ui.config.CheckConfigurationConfigureDialog$PageController.doubleClick(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer$1.run(Unknown Source)
at org.eclipse.core.runtime.SafeRunner.run(Unknown Source)
at org.eclipse.core.runtime.Platform.run(Unknown Source)
at org.eclipse.ui.internal.JFaceUtil$1.run(Unknown Source)
at org.eclipse.jface.util.SafeRunnable.run(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer.fireDoubleClick(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer.handleDoubleSelect(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer$4.widgetDefaultSelected(Unknown Source)
at org.eclipse.jface.util.OpenStrategy.fireDefaultSelectionEvent(Unknown Source)
at org.eclipse.jface.util.OpenStrategy.access$0(Unknown Source)
at org.eclipse.jface.util.OpenStrategy$1.handleEvent(Unknown Source)
at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)
at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)
at org.eclipse.jface.window.Window.runEventLoop(Unknown Source)
at org.eclipse.jface.window.Window.open(Unknown Source)
at net.sf.eclipsecs.ui.config.CheckConfigurationWorkingSetEditor.configureCheckConfig(Unknown Source)
at net.sf.eclipsecs.ui.config.CheckConfigurationWorkingSetEditor.access$6(Unknown Source)
at net.sf.eclipsecs.ui.config.CheckConfigurationWorkingSetEditor$PageController.doubleClick(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer$1.run(Unknown Source)
at org.eclipse.core.runtime.SafeRunner.run(Unknown Source)
at org.eclipse.core.runtime.Platform.run(Unknown Source)
at org.eclipse.ui.internal.JFaceUtil$1.run(Unknown Source)
at org.eclipse.jface.util.SafeRunnable.run(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer.fireDoubleClick(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer.handleDoubleSelect(Unknown Source)
at org.eclipse.jface.viewers.StructuredViewer$4.widgetDefaultSelected(Unknown Source)
at org.eclipse.jface.util.OpenStrategy.fireDefaultSelectionEvent(Unknown Source)
at org.eclipse.jface.util.OpenStrategy.access$0(Unknown Source)
at org.eclipse.jface.util.OpenStrategy$1.handleEvent(Unknown Source)
at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)
at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)
at org.eclipse.jface.window.Window.runEventLoop(Unknown Source)
at org.eclipse.jface.window.Window.open(Unknown Source)
at org.eclipse.ui.internal.OpenPreferencesAction.run(Unknown Source)
at org.eclipse.jface.action.Action.runWithEvent(Unknown Source)
at org.eclipse.jface.action.ActionContributionItem.handleWidgetSelection(Unknown Source)
at org.eclipse.jface.action.ActionContributionItem.access$2(Unknown Source)
at org.eclipse.jface.action.ActionContributionItem$5.handleEvent(Unknown Source)
at org.eclipse.swt.widgets.EventTable.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Widget.sendEvent(Unknown Source)
at org.eclipse.swt.widgets.Display.runDeferredEvents(Unknown Source)
at org.eclipse.swt.widgets.Display.readAndDispatch(Unknown Source)
at org.eclipse.ui.internal.Workbench.runEventLoop(Unknown Source)
at org.eclipse.ui.internal.Workbench.runUI(Unknown Source)
at org.eclipse.ui.internal.Workbench.createAndRunWorkbench(Unknown Source)
at org.eclipse.ui.PlatformUI.createAndRunWorkbench(Unknown Source)
at org.eclipse.ui.internal.ide.IDEApplication.run(Unknown Source)
at org.eclipse.core.internal.runtime.PlatformActivator$1.run(Unknown Source)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.runApplication(Unknown Source)
at org.eclipse.core.runtime.internal.adaptor.EclipseAppLauncher.start(Unknown Source)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(Unknown Source)
at org.eclipse.core.runtime.adaptor.EclipseStarter.run(Unknown Source)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.eclipse.core.launcher.Main.invokeFramework(Unknown Source)
at org.eclipse.core.launcher.Main.basicRun(Unknown Source)
at org.eclipse.core.launcher.Main.run(Unknown Source)
at org.eclipse.core.launcher.Main.main(Unknown Source) 
```

和会话数据：

```
Session Data:
eclipse.buildId=unknown
java.fullversion=J2RE 1.5.0 IBM J9 2.3 Windows XP x86-32 j9vmwi3223ifx-20070323 (JIT enabled)
J9VM - 20070322_12058_lHdSMR
JIT  - 20070109_1805ifx3_r8
GC   - WASIFIX_2007
BootLoader constants: OS=win32, ARCH=x86, WS=win32, NL=en_GB
Framework arguments:  -product com.ibm.rational.rsa.product.ide
Command-line arguments:  -os win32 -ws win32 -arch x86 -product com.ibm.rational.rsa.product.ide 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-08-16T12:06:42.500

`-clean`尝试使用该选项从控制台/终端启动 Eclipse 。

在 Windows 上：

```
Eclipse.exe -clean 
```

在 *nix 上：

```
./eclipse -clean 
```

或者如果 Eclipse 在您的 PATH 中

```
eclipse -clean 
```

这将清除您的插件缓存，也许它可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T14:23:29.550

我的简单猜测是 RSA 7.0 所基于的 Eclipse 版本缺少您的检查样式版本所需的一些方法。RSA 7.5 使用 Eclipse 3.4，我对它非常满意。

# c# - 每个 C# 程序都有一个 AppDomain 吗？

> ID：776338
> 
> 赞同：10
> 
> 时间：2009-04-22T09:22:39.943
> 
> 标签：c#, .net, appdomain

即使我们没有专门创建 AppDomain，是否每个 C# 程序都有一个 AppDomain？为什么需要它？如果我们不将第三方程序集加载到单独的 AppDomain 中，我已经阅读了有关第三方程序集会使整个应用程序崩溃的信息。我没有很好地理解这一点。任何人都可以解释这一点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-22T09:24:30.997

`AppDomain`很像一个进程，它是您的应用程序在其中运行的基础架构。需要在其中加载 .NET 程序集`AppDomain`才能运行。不需要将第三方程序集加载到单独`AppDomains`的 中，但如果这样做，它会在它们之间提供隔离（如两个单独的进程），并且其中一个发生故障不会影响另一个。应用程序域可以独立卸载。

例如，SQL Server 使用`AppDomain`s 在其进程中安全地加载 CLR 程序集。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T09:32:00.980

> 如果我们不使用 AppDomain，我已经阅读了有关导致崩溃的 3rd 方程序集

我认为您正在谈论将其他程序集加载到单独的应用程序域中。这样他们就可以与您的地址空间隔离，以防止他们的代码崩溃影响您。代价是与单独的应用程序域中的程序集进行通信更加困难并且具有性能损失，因为所有调用都需要跨越应用程序域边界进行军事处理。

这是一个相当高级的话题，我建议在[Richter](http://www.microsoft.com/learning/en/us/Books/6522.aspx)中阅读（其他书籍可用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T09:24:19.937

每个应用程序至少有一个应用程序域，是的。

我不知道关于第 3 方集会的说明是什么意思。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T09:26:34.223

每个程序至少有一个 appdomain，您可以创建任意数量的程序，但您很少需要超过一个。

它基本上是一个容器，其中以特定信任运行的代码正在运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T09:28:44.967

有一个默认的应用程序域，您的应用程序被加载到其中（每个实例都有自己的）。

崩溃意味着第三方程序集（即插件）如果您不将其加载到单独的应用程序域中，它将在崩溃时崩溃您的整个应用程序。因此，最好将插件加载到单独的应用程序域中，因为应用程序域中的崩溃只会导致该应用程序域崩溃，而其他域不会崩溃。[CLR 插件博客](http://blogs.msdn.com/clraddins/default.aspx)有一些关于此的文章。

需要注意的重要一点是，应用程序域不一定需要在同一进程或同一系统上，因此您基本上需要它来进行远程处理。

# php - 我如何做可读的网址？

> ID：776352
> 
> 赞同：3
> 
> 时间：2009-04-22T09:26:23.927
> 
> 标签：php, apache, mod-rewrite, lamp

假设我有网址[http://example.com/user/me](http://example.com/user/me)，其中 me 是用户名。当用户在地址栏中输入 url 时，我想显示用户的详细信息。我不想要诸如[http://example.com/user.php?user=me之类的网址](http://example.com/user.php?user=me)

任何帮助表示赞赏，在 LAMP 上工作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T09:28:56.447

一种方法是使用*apache 的*名为`mod_rewrite`. 然后，您可以重写`/user/([a-z]+)`指向的 url`/user.php?user=$1`

搜索文档以`mod_rewrite`获取详细信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T09:32:20.933

最简单的方法是（`.htaccess`在您的服务器配置或虚拟主机配置中）：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

这会将所有与文件、目录或符号链接不匹配的请求转发到您的`index.php`. 在那里，您可以检查请求 URI 以确定要做什么。实际上，您将需要某种知道如何解构 URL 以确定应该采取什么行动的调度程序。事实上，这可能会导致一些 MVC 实现——但这不是必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T10:21:17.647

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]

RewriteRule ^([A-Za-z0-9-]+)/?$ index.php?u=$1 
```

# c++ - 测试是否安装了字体（Win32）

> ID：776354
> 
> 赞同：4
> 
> 时间：2009-04-22T09:27:19.727
> 
> 标签：c++, winapi, fonts

如何测试是否安装了字体？

最终，我想实现一个类似 HTML 的字体选择，即当指定例如“Verdana,Arial”时，它应该选择安装的第一个字体。

[这个问题](https://stackoverflow.com/questions/113989/test-if-a-font-is-installed)为 .NET 提供了答案 - 似乎推荐的方法是创建字体，然后对实际使用的字体进行比较。

这是最有效的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T09:31:40.577

您可以尝试创建字体并查看您得到的结果（因此使用操作系统的字体名称匹配/替换）。

或者您可以枚举已安装的字体并自己进行匹配。

“最有效”的方式将取决于“匹配”的细节，并且很可能安装了多少字体。例如，在具有 50 种字体的系统上，您可能会发现性能与安装了 1000 种字体的系统有很大不同。

最后，您只能在代表性系统上进行分析，如果您首先接近（保持简单）结果是性能瓶颈。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-22T09:31:38.657

您可以使用 EnumFontFamiliesEx 枚举系统上的字体列表，或者如果您传递字体名称，则可以枚举该系列的字体。

# oracle - PL/SQL 中的移位运算符

> ID：776355
> 
> 赞同：10
> 
> 时间：2009-04-22T09:27:57.153
> 
> 标签：oracle, plsql, bitwise-operators

`shift`PL/SQL 中是否有运算符的替代方案？有`bitand`函数，但它只接受*binary_integer*类型的参数。

如果我需要检查非常长的数字的低位/高位（可能在行中设置），我该怎么办？

`C`里面有和`<<`运营`>>`商。我如何在 PL/SQL 中实现它们？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-30T19:53:50.703

以下答案与字节序无关，我的措辞基于小端格式......

您可以简单地将参数乘以（左移）或除以（右移）2 的 x 次方来移位位，其中 x 是要移位的位数。例如，如果我需要将数字 (255:11111111) 的低位字节向左移动 16 位，我将执行以下操作：

```
select 255 * power(2,16) from dual;  
-- the result will be (16711680:111111110000000000000000) 
```

相反，如果我想将值 16711680 向右移动 16 位，我将执行以下操作：

```
select 16711680 / power(2,16) from dual;
-- the result will be (255:11111111) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-22T11:16:31.260

从 Oracle 版本 8 开始，您可以在数据库中使用 java 代码。在 PL/SQL 中，您可以为 java 代码定义一个包装器。例如

```
PACKAGE BODY JAVA_CODE
IS
  function bitshift_left(x in number,
                         n in number) return number
  is language java name 'com.foo.Bitshift(java.lang.Integer, 
                                          java.lang.Integer) return java.lang.Integer';
END JAVA_CODE; 
```

在 java 代码中，您可以使用 shift 运算符。虽然有点笨拙，但它可以这样工作。

遗憾的是，这在 Oracle XE 中是不可能的，因为在那个“免费”版本中不支持 Java。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-22T11:56:11.383

这是我自己的 LPAD/RPAD 解决方案。

我以[Tom Kyte 包](http://asktom.oracle.com/tkyte/hexdec/hexdec.sql)为基础并对其进行扩展。

```
create or replace function bin_shift_right
(  p_bin in varchar2,
   p_shift in number default null) return varchar2
is
    l_len number;
    l_shift number;
begin
    l_shift := nvl(p_shift, 1);
    l_len := length(p_bin);
    if (l_len <= 0) then
        return null;
    end if; 
    if (l_shift > l_len) then
        l_shift := l_len;
    end if;

    return lpad(substr(p_bin, 1, l_len - l_shift), l_len, '0'); 
end bin_shift_right;

create or replace function shright
(  p_num in number,
   p_shift in number default null) return number
is
begin
    if (trunc(p_num) <> p_num OR p_num < 0) then
        raise PROGRAM_ERROR;
    end if;
    return nvl(to_dec(bin_shift_right(to_bin(p_num), p_shift), 2), 0);
end shright;
/ 
```

* * *

和测试

```
SQL>
SQL> select shright(123) from dual;

SHRIGHT(123)
------------
          61

SQL>
SQL> select shright(123, 2) from dual;

SHRIGHT(123,2)
--------------
            30

SQL>
SQL> select shright(123, 10) from dual;

SHRIGHT(123,10)
---------------

SQL> / 
```

# ruby - 如何在 Ruby 中解析包含通配符和字符类的字符串？

> ID：776362
> 
> 赞同：0
> 
> 时间：2009-04-22T09:29:10.987
> 
> 标签：ruby, parsing

我想编写一个脚本，它接受一个可能如下所示的参数：

```
abc(ag)de* 
```

`a`, `b`,`c`是文字字符。

`(ag)`意思是“一个'a'或'g'”。

`*`指任何一个字母或数字。

我希望脚本创建一个包含输入可以表示的所有可能字符串的数组。（目的是检查它们是否有可用的域名。）

输入也可以是`abc(ag)de(mnlop)`字符类以外的地方。

似乎第一个任务是将其拆分为一个或多个数组，所以第一个示例是......

```
[
  ['a'],
  ['b'],
  ['c'],
  ['a', 'g'],
  ['d'],
  ['e'],
  [
    'a', 'b', 'c', 'd', 'e', 'f', 'g',
    # etc...
  ]
] 
```

这就是我卡住的地方。我不知道如何将它分成这样的部分。

关于如何处理它的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T12:13:19.097

这是一个非常紧凑的解决方案。它绝不会针对性能进行优化，这会对您提供的模式施加一些限制，例如过多的通配符可能不是最好的主意。

这是代码

```
input1 = "abc(ag)de*"
input2 = "abc(ag)de(mnlop)"

class Array
  def append_suffixes!(suffixes)
    self.replace suffixes.map { |a| self.map { |p| p + a }}.flatten
  end
end

def generate_combinations(pattern)
  combinations = [""]
  pattern.scan(/\(([^)]+)\)|(\*)|(\w+)/) do |group,wildcard,other|
    new_suffixes = case
      when group    : group.split('')
      when wildcard : [*'a'..'z']
      when other    : other
      else raise "Unknown match!"
    end
    combinations.append_suffixes! new_suffixes
  end
  combinations
end

p generate_combinations(input1)
p generate_combinations(input2)
p generate_combinations("**").size 
```

运行上述代码的输出是（稍作编辑）：

```
["abcadea", "abcgdea", "abcadeb", "abcgdeb", "abcadec", 
 "abcgdec", "abcaded", "abcgded", "abcadee", "abcgdee", 
 "abcadef", "abcgdef", "abcadeg", "abcgdeg", "abcadeh", 
 "abcgdeh", "abcadei", "abcgdei", "abcadej", "abcgdej", 
 "abcadek", "abcgdek", "abcadel", "abcgdel", "abcadem", 
 "abcgdem", "abcaden", "abcgden", "abcadeo", "abcgdeo", 
 "abcadep", "abcgdep", "abcadeq", "abcgdeq", "abcader", 
 "abcgder", "abcades", "abcgdes", "abcadet", "abcgdet", 
 "abcadeu", "abcgdeu", "abcadev", "abcgdev", "abcadew", 
 "abcgdew", "abcadex", "abcgdex", "abcadey", "abcgdey", 
 "abcadez", "abcgdez"]

["abcadem", "abcgdem", "abcaden", "abcgden", "abcadel", 
 "abcgdel", "abcadeo", "abcgdeo", "abcadep", "abcgdep"]

676 # The number of two letter words i.e. 26*26 
```

如果您对上面的代码有任何疑问，请随时询问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T09:34:30.803

如果您的 * 仅表示单个字符，那么我想这至少是可以解决的。如果它的意思是“任何字符的零个或多个”，那么感觉好像您的解决方案空间接近于无限，因此很难将其作为实际的具体值返回。

我想我会通过以某种方式拆分变量部分来解决这个问题，弄清楚每个变量支持多少个变量，然后（从概念上）以嵌套方式循环所有变量，为最内层循环的每次迭代形成一个输出字符串。

对于“abc(ag)de*”的示例字符串，这将归结为这个（Python-ish 伪代码，我的 Ruby 不供公众使用）：

```
results = []
for x in "ag":
  for y in "abcdefghijklmnopqrstuvwxyz":
    results.append("abc%sde%s" % (x, y)) 
```

最后一行字符串中的 %s 是格式说明符，s 仅表示“字符串”，并将导致字符串后 % 运算符右侧的元组中的相应值插入到该位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T16:55:27.590

您本质上要求的是采用正则表达式并生成它匹配的所有字符串。

那是[Ruby 测验 #143](http://rubyquiz.com/quiz143.html)。查看左侧的解决方案。

# java - Java中的套接字编程

> ID：776366
> 
> 赞同：0
> 
> 时间：2009-04-22T09:30:13.497
> 
> 标签：java, sockets

我想运行一个使用套接字连接在 Java 中构建的客户端/服务器应用程序。如果我在同一台机器上同时运行服务器和客户端程序，客户端和服务器会按预期相互通信。但另一方面，如果在其他系统上运行客户端程序，我会得到一个异常

```
java.net.ConnectException: Connection timed out: connect
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
        at java.net.Socket.connect(Socket.java:519)
        at java.net.Socket.connect(Socket.java:469)
        at java.net.Socket.<init>(Socket.java:366)
        at java.net.Socket.<init>(Socket.java:180) 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T10:00:12.690

除了 Bhushan 所说的，检查它是否被防火墙阻止。特别是，Windows XP 的内置防火墙经常让我抓狂。

您还可以通过从客户端到服务器的 telnet'n 测试您的 TCP 连接（我假设您正在使用 TCP），即

client.host] telnet ip.of.server port.of.application

看看你得到什么回应。如果您得到的不是超时，那么您在 Socket 对象中使用了错误的地址/端口值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T09:37:15.460

您是如何在客户端创建 Socket 对象的？我们可以看到服务器和客户端的代码吗？可能是您在创建客户端 Socket 对象时使用 localhost。使用运行服务器的机器的 IP 地址或主机名代替 localhost。还要检查两台机器是否在同一个网络上并且可以互相看到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-16T14:11:25.643

我认为的主要问题是您必须打开端口。服务器和客户端使用相同的端口进行通信。在这种情况下，当您使用同一台机器时，所有端口都为它自己打开。但要连接单独的系统，您必须打开端口。实际上这是管理员打开端口的工作。

谢谢 Sunil Kumar Sahoo

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T06:34:46.357

听起来您的服务器上有防火墙（Windows 和 Linux 默认启用），您需要允许其他机器连接到您使用的端口。

# sharepoint - 在 Sharepoint 中自定义页面视图

> ID：776367
> 
> 赞同：1
> 
> 时间：2009-04-22T09:30:35.070
> 
> 标签：sharepoint, wss

我正在自定义页面文档库中显示的字段（单击站点操作->所有站点内容->页面显示的表格）。

比我更了解sharepoint的人建议我应该在激活功能时以编程方式从默认视图中删除我不想要的字段，所以我编写了这段代码，感觉很不雅解决方案，也不起作用。

```
SPWeb web = properties.Feature.Parent as SPWeb;

        if (web != null)
        {
            SPList list = web.Lists["Pages"] as SPList;
            if (list != null)
            {
                foreach (SPField field in list.Fields)
                {
                    if (field.Title != "Type" &&
                        field.Title != "Name" &&
                        field.Title != "Modified" &&
                        field.Title != "Checked Out To" &&
                        field.Title != "Page Layout")
                    {
                        if (list.DefaultView.ViewFields.Exists(field.InternalName))
                        {
                            list.DefaultView.ViewFields.Delete(field);                                
                        }
                    }
                }

                list.DefaultView.Update();
            }
        }
    } 
```

该代码肯定会在激活该功能时执行，所以我显然做错了什么。我已经寻找解决方案，所以如果我在谷歌或这个网站上遗漏了一些非常明显的东西，我深表歉意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T10:52:05.640

这是因为对 list.DefaultView.ViewFields 的更改超出了范围。在调用 Update() 之前，正在从数据库中刷新集合。尝试：

```
if (list != null)
{
    SPView view = list.DefaultView;

    foreach (SPField field in list.Fields)
    {
        if (field.Title != "Type" &&
            ...
            field.Title != "Page Layout")
        {
            if (view.ViewFields.Exists(field.InternalName))
            {
                view.ViewFields.Delete(field);                                
            }
        }
    }

    view.Update();
} 
```

# svn - 使用 Subversion 防止更改分支的最佳方法

> ID：776382
> 
> 赞同：10
> 
> 时间：2009-04-22T09:36:30.750
> 
> 标签：svn, branch

我们使用 Subversion 的方式是在主干、重要特性的特性分支（> 1 天的工作）和发布分支上工作。

一旦它们愉快地合并，我们就会删除功能分支，但我们希望保留发布分支，以防错误修复等需要它们。

我们每个人都至少会检查项目的根目录，因此我们都拥有整个目录结构（主干、分支、发布）的副本。尽管我可以教育人们检查他们是否针对主干工作，但他们最终可能会意外地针对发布分支工作。

防止这种情况发生的最好方法是什么？我正在考虑锁定发布分支中的所有文件，这有帮助吗？还有哪些其他选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T10:13:33.377

为什么每个人都检查了整个 SVN 层次结构？如果每个人都只检查了他们正在处理的主干/分支，那么出错的可能性就会大大降低。您无法检查尚未签出的分支中的某些内容。

[我可以支持Razzie](https://stackoverflow.com/questions/776382/best-way-to-prevent-changes-on-a-branch-with-subversion/776427#776427)提到的标记发布的做法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-22T10:53:05.810

我不知道有任何内置方法可以主动防止这种情况。您可能可以使用“存储库预挂钩”来做到这一点。这是一个在每次提交之前运行的小程序。如果失败，则整个提交将失败。请参阅Subversion 书中[有关挂钩的章节。](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.create.html#svn.reposadmin.create.hooks)

您的钩子脚本将检查即将提交的路径，并禁止一些。这可能会有所帮助： [http ://metacpan.org/pod/SVN::Hooks](http://metacpan.org/pod/SVN::Hooks)

也就是说，你真的确定要这样做吗？

我们还使用发布分支，并且我们*偶尔*会检查它们，通常是针对无法立即升级到最新版本的客户的关键错误修复。你确定你永远不需要那个吗？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-07T18:56:08.163

为什么要使用分支作为标签？我会建议：

1.  本地开发标准（即在我们要求您不承诺的地方不承诺）
2.  Subversion 进修培训（即为什么开发人员要检查整个 repo？）
3.  根据预期使用标签结构

话虽如此，并假设您将存储库层次结构布局为：

```
* repo
  - tags
  - trunk
  - branches 
```

尽管 SVN Book 反对以这种方式进行精细控制，但您也可以使用它`svn_access_file`来防止提交到分支上的任何内容？例如：

```
[repo:/]
@developers = rw

[repo:/branches]
@developers = r
@rel_engineers = rw 
```

如果您希望开发人员能够创建分支，那么您将不得不单独进入每个分支（这又回到了 SVN Book 的整个前提，首先建议不要使用该方法）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-22T09:44:20.060

不要浪费时间试图防止这种情况发生。如果开发人员在错误的分支上进行了更改，如果发生更改，只需将其还原，并确保将其传达给开发人员。

```
... hack hack hack ... on branch
$ svn ci -m "Feature-1337 implemented" branch
Revision 12345

...oops...

$ svn merge -c12345 branch trunk
$ svn ci -m "moved Feature-1337 from branch to trunk" trunk
$ svn merge -c-12345 branch branch
$ svn ci -m "reverted Feature-1337 on branch. it's intended only for trunk" branch 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-22T09:47:55.827

我认为删除“发布分支”并将它们改为标签是一个好习惯，因为这是标签的目的。

这并不能真正解决问题，尽管它可能会防止更多此类事故，因为您永远不应该在标签中工作。我同意布伦丁，如果它仍然发生，恢复这些更改，并踢开发人员:-)

# sql-server - 如何比较两个 MS SQL 数据库的结构？

> ID：776387
> 
> 赞同：4
> 
> 时间：2009-04-22T09:38:19.263
> 
> 标签：sql-server, sql-server-2005

我需要一个免费工具或某种技巧/技术来比较两个 Microsoft SQL 数据库的结构。最好是 MS SQL 2005。

我尝试使用的技术是从两个数据库生成脚本，然后比较这两个文件，但 SQL Server 以随机顺序生成对象。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-22T10:27:22.143

它仅免费试用 14 天，但[redgate sql compare](http://www.red-gate.com/products/index.htm)非常好且易于使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T09:42:35.837

我在我的开发数据库上使用这个工具：[http ://www.codeplex.com/ScriptDB。](http://www.codeplex.com/ScriptDB)

然后我将所有文件检入 svn 并比较生成的文件以查看我的实时数据库中需要更改的内容。为我工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T10:11:16.847

如果您有 Visual Studio 2008（数据库版），您可以使用它来比较 SQL 架构。

请注意，SQL Server 2008 支持需要更新：

[http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T15:40:27.007

同样适用于[RedGate SQL 比较](http://www.red-gate.com/products/index.htm)....我已经将它广泛用于非常大和复杂的数据库，并且每次都能成功。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-23T14:46:13.440

看看[dbForge Schema Compare for SQL Server](http://www.devart.com/dbforge/sql/schemacompare/)。它不是免费软件，但有 30 天免费试用期，30 天保证退款，而且您有可能获得免费许可证 - 请访问[免费许可证条件页面](http://www.devart.com/dbforge/sql/get-free-license.html)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-30T03:20:52.413

我根本不再使用 SQL Server 管理服务。对于开发和测试目的来说，它太陈旧和太慢了。

我使用Quest Software[的 TOAD for SQL Server](https://www.quest.com/products/toad-for-sql-server/software-downloads.aspx)。

它有一个模式比较功能，可以很好地比较结构（你也可以比较数据！），它还提供了一个向导来合并两个数据库之间的差异。所有这些 GUI 都可以在没有单个手动代码行的情况下进行控制！

它是非常集中的 GUI，具有非常强大的数据库管理工具，包括出色的模式和数据库数据比较器。

**披露：**不，我不为 Quest 工作，但我使用 TOAD 已有 10 多年了，而且效果很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-19T11:46:40.127

[SQL Server Schema Compare](http://www.xsql.com/download/sql_server_schema_compare/downloading/)对 MSSQL Express 是免费的，完整版可以试用 2 周。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-01-23T16:23:25.523

这个脚本（取自[这里](https://dba.stackexchange.com/a/183991/14815)）可以用来以粗略的方式完成它：

```
set nocount on;
-- Set the two variables newmodel and oldmodel to the appropriate database names and execute the script

declare @newmodel varchar(50), @oldmodel varchar(50);

Set @newmodel = '[NewModel to Compare]';
set @oldmodel = '[OldModel to Compare]';

Declare @Temp table (TABLE_SCHEMA varchar(40), TABLE_NAME varchar(40), COLUMN_NAME varchar(50), ORDINAL_POSITION int, IS_NULLABLE varchar(5), NullChange varchar(5), Comment varchar(50));

Declare @script varchar(5000);

set @script = '
Select nc.TABLE_SCHEMA, nc.TABLE_NAME, nc.COLUMN_NAME, nc.ORDINAL_POSITION, nc.IS_NULLABLE, IIF(nc.IS_NULLABLE <> oc.IS_NULLABLE, ''Yes'', ''No''), 
        IIF(oc.COLUMN_NAME IS NULL, convert(varchar(20), ''ADDED COLUMN''), convert(varchar(20), ''--'')) as Comment
    from {NEW}.INFORMATION_SCHEMA.COLUMNS nc
        LEFT join {OLD}.INFORMATION_SCHEMA.COLUMNS oc 
            on nc.TABLE_NAME = oc.TABLE_NAME and nc.COLUMN_NAME = oc.COLUMN_NAME
UNION ALL
    Select oc.TABLE_SCHEMA, oc.TABLE_NAME, oc.COLUMN_NAME, oc.ORDINAL_POSITION, oc.IS_NULLABLE, ''No'', ''DELETED COLUMN'' as Comment
    from {OLD}.INFORMATION_SCHEMA.COLUMNS oc
    where CONCAT(oc.TABLE_NAME, ''.'', oc.COLUMN_NAME) 
        not in (Select CONCAT(TABLE_NAME, ''.'', COLUMN_NAME) from {NEW}.INFORMATION_SCHEMA.COLUMNS)
';

Set @script = replace(@script, '{OLD}', @oldmodel);
Set @script = replace(@script, '{NEW}', @newmodel);

--print @script

Insert into @Temp
    exec(@script);

Select * from @Temp where Comment <> '--'
order by TABLE_NAME, ORDINAL_POSITION, COLUMN_NAME;
go 
```

# python - 使用 Doxygen 的 Qt 样式文档？

> ID：776388
> 
> 赞同：3
> 
> 时间：2009-04-22T09:38:34.427
> 
> 标签：python, documentation, doxygen

如何使用 Doxygen 生成 Qt 风格的文档（Trolltech 的 C++ Qt 或 Riverbank 的 PyQt 文档）？我正在记录 Python，我希望能够改进它产生的默认函数简介。

特别是，我希望能够看到函数简介中的返回类型（可以是用户指定的）和参数。

例如：

```
 Functions:

     int getNumber(self)
     str getString(self)
     tuple getTuple(self, int numberOfElements=2)

 Function Documentation:

     int getNumber(self)

           gets the number of items within a list as specified...

           Definition at line 63 of ....

     etc... 
```

如果不修改源代码就无法做到这一点，那么除了 Doxygen 之外，也许还有其他工具可以以这种方式处理 Python 文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T16:00:26.583

然后只使用Doxygen？[这将使您入门](https://engtech.wordpress.com/2007/03/20/automatic_documentation_python_doxygen/)：

> 这是使用 Doxygen 从 Python 源代码自动生成文档的指南。

显然，由于 Python 不是强类型的，因此指定参数的返回类型和预期类型将取决于您，文档编写者。无论如何，这只是最佳实践。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T10:01:16.447

如果你在做任何与 Python 相关的文档，我推荐[Sphinx](http://sphinx.pocoo.org/ "狮身人面像")。这是 python 的开发人员在他们的文档中使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T10:44:12.710

[此页面](http://doc.trolltech.com/4.4/qthelp.html)似乎详细介绍了创建 qt 样式文档的方法。
基本上有一个你用 qt 调用的工具，`qhelpgenerator`它创建一个`.qch`文件，可由 qt 助手食用。
我以前没有使用过它，但它看起来相当简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T16:07:32.247

您不必在代码中添加 doxygen 注释。您可以将文档放在其他地方。在 doxygen 手册中查看[此页面。](http://www.doxygen.nl/manual/docblocks.html#structuralcommands)

# language-agnostic - 软件开发的难点是什么？

> ID：776391
> 
> 赞同：1
> 
> 时间：2009-04-22T09:39:41.803
> 
> 标签：language-agnostic

对最终产品/输出有重大影响的软件开发的困难部分是什么？如何？

我期望的是，我应该“更多地”专注于哪些领域（如技术、需求……等）以开发更好的应用程序。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-22T09:44:34.367

软件开发的困难部分是沟通：您和您的团队成员、业务合作伙伴、客户和其他利益相关者之间的沟通。它对最终输出的影响最大。这些将采取书面和口头要求、最佳实践交流等形式。

如果你做对了，并且有一些有天赋的开发人员，相比之下，技术部分就会自己解决。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-22T09:46:51.833

最困难的部分是与人打交道。上帝我恨他们！

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-22T11:46:42.000

我将无耻地模仿[Code Complete](http://www.cc2e.com/)中 Steve McConnell 的台词，软件开发的首要难点是：**管理复杂性**。

管理交付功能、进度和代码质量。

管理制作正确的功能与完成功能。

管理需求，与客户充分沟通，以确信您正在构建的东西实际上是客户想要的。

管理团队和组件之间的协调。管理具有许多部分的系统集成，每个部分由不同的人构建并依赖于系统中的其他部分。

管理团队和个人动态。

管理适量的监督、跟踪、问责、规划和分析，以平衡开发速度与开发质量和可预测性。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-22T09:44:48.873

根据我的经验，我尝试遵循一句老话：“测量两次，切割一次。” 你花在需求收集和设计上的时间越多，你就能越快、越干净地实际实现和测试你的代码。

正如许多其他答案所同意的那样，沟通至关重要，并且取决于与您一起工作的人，可能具有挑战性或几乎不可能。需求很少是一成不变的，如果你的老板/客户不断地改变他们想要你做的事情，或者在你的项目之上堆积越来越多的功能，那么设计将变得很困难。不称职的经理或老板每周都会更改项目的要求，您可能会发现软件开发中最困难的部分*实际上是开发软件。*

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-22T09:44:55.707

沟通，沟通和沟通。在我参与的项目中，成功（或失败）几乎完全与与客户交谈的能力有关，客户很少是程序员（除了拥有一支称职的开发人员团队之外）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-22T09:57:54.507

规划。特别是如果你有幸每次都从事不同类型的项目。创建另一个网络社区的计划并不太难，几乎可以说这样的项目更多的是配置（即使使用编程语言）而不是软件开发。但是对于一个全新的项目的规划，可能涉及一些新技术，我总是发现最难的部分。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-22T11:14:01.687

第一个困难的部分是沟通。如果您使用的是传统的规范开发模型，这意味着确保您的需求和规范文档是正确的。正确的意思是开发团队和客户都同意（“但我想要功能 Y！”）。使用更敏捷的方法（您不会真正编写正式的需求文档），您必须与客户和您的利益相关者（营销、管理等）保持持续联系。敏捷可以通过始终保持沟通来摆脱没有大量需求文档的困扰。

沟通之后，我想说下一个困难的部分是测试。没有人喜欢编写测试。这很无聊。它的重复。但是，这意味着您可以在项目中添加或更改代码时进行自动回归测试，并且，好的单元测试可以为团队中的其他开发人员提供出色的 API 文档（方法 X 是如何工作的？阅读测试）。

测试后，我会说调度是下一个。除非您是项目经理，否则您可能不会接触到这一点，但是制定一个有足够回旋余地的良好开发计划（以防万一迟到等）可能会很痛苦。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-22T10:04:12.213

如果您在大型企业中进行开发，则需要在企业架构师制定的战略方向与项目经理的更多战术关注点之间取得平衡。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2021-03-08T11:11:33.793

Imo，最困难的事情是新的生产错误，它发生的不一致 - 没有明显的模式，不显示可搜索/预定的错误输出，并且发生在您的组织没有创建/触及并且没有第三方支持的系统层中。他们让 30 个人在国际桥接电话上通宵达旦，他们使原本完整、有效和好的项目变得毫无用处。它们导致指责游戏和解雇，快速、肮脏和低效的设计决策。

# java - 如何模拟客户端和服务器之间的套接字断开连接（在 Windows 上）？

> ID：776396
> 
> 赞同：4
> 
> 时间：2009-04-22T09:40:32.147
> 
> 标签：java, windows, tcp, sockets, system

我已经实现了一种“心跳解决方案”，我想看看当网络“宕机”时会发生什么，在真实条件下，特别是当套接字上没有流量时发生的情况。

问题： - 我只有一台电脑；- 我在 windows/java 上；

我想简单地拔下网线/停用网卡不会影响这两个进程，因为它们在同一个盒子上运行；有没有程序化的解决方案？一种强制关闭套接字的方法？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-22T09:51:10.293

我使用[TCPView](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)右键单击​​并关闭套接字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:56:52.110

如果您使用的是 Eclipse，则有一个 TCP/IP 监视器，窗口 -> 显示视图 -> 其他 -> 输入过滤器文本 = TCP/IP 并创建一个新的转发 tcp/ip，您可以在中间监视并停止它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-20T19:46:27.467

您还可以使用虚拟计算机模拟两台计算机。

我使用[VirtualBox](http://www.virtualbox.org/)让自己拥有更多的计算机 :D。

# c# - 如何将非通用 IList 转换为 IList ?

> ID：776397
> 
> 赞同：47
> 
> 时间：2009-04-22T09:41:00.617
> 
> 标签：c#

我有一个想要一个的课程`IList<T>`，但我有一个`Systems.Collection.IList`来自 NHibernate quere 的课程。

我想创建一个将其转换为`IList<T>`. 我该怎么做呢？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-04-22T09:44:22.510

如果您确定所有元素都继承自 T（或您使用的任何类型）

```
IList<T> myList = nonGenericList.Cast<T>().ToList(); 
```

如果您不确定：

```
IList<T> myList = nonGenericList.OfType<T>().ToList(); 
```

当然，您将需要 System.Linq 命名空间：

```
using System.Linq; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T09:52:55.250

`Cast`并`OfType`返回`IEnumerable<T>`实现，而不是`IList<T>`实现，因此它们对您没有用处。

呼唤。`Cast<T>().ToList`将导致列表的额外副本，这可能会对性能产生不利影响。

更好的（恕我直言）方法是只创建一个包装类并即时进行转换。你想要这样的东西：

```
class ListWrapper<T> : IList<T>
{
    private IList m_wrapped;

    //implement all the IList<T> methods ontop of m_wrapped, doing casts
    //or throwing not supported exceptions where appropriate.
    //You can implement 'GetEnumerator()' using iterators. See the docs for 
    //yield return for details
} 
```

这将具有不创建整个列表的另一个副本的优点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-07-17T22:54:10.513

弗雷德里克是正确的。但是 Nhibernate 也可以选择返回多个结果集。例如：

```
 IList multiResults = session.CreateMultiCriteria()
                .Add(pageCriteria)
                .Add(countCriteria)
                .List(); 
```

在上面的调用中，没有返回类型列表的选项。所以它必须像上面提到的那样铸造，像这样：

```
 IList<T> results = ((IList)multiResults[0]).Cast<T>().ToList();
            IList counts = (IList)multiResults[1]; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-22T09:44:31.963

一种方法是使用 Linq，例如`list.OfType<T>()`或`.Cast<T>()`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T09:44:02.823

你不能实现 NHibernate 返回一个 IList 吗？ICriteria 接口定义了一个`List<T>`方法...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-12-10T18:13:31.583

Frederik 是正确的，NHibernate 已经这样做了。

```
var data = query.List<MyType>(); 
```

这将产生您指定的类型的 IList。在这种情况下`IList<MyType>`。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2019-10-21T14:18:30.283

在这种情况下不需要使用 Linq（OfType() 或 .Cast）。NHibernate 实现就足够了。

你只需要使用：

```
var results= query.List<YourType>(); 
```

代替

```
var results= query.List<>(); 
```

# svn - 使用 Subversion 主干作为 DocumentRoot

> ID：776401
> 
> 赞同：0
> 
> 时间：2009-04-22T09:42:32.017
> 
> 标签：svn

如何在我的 subversion 上创建一个 svn 主干作为我的 VirtualHost 的 DocumentRoot，这样我就可以根据主干上的最新代码测试我的应用程序。（我的应用程序是用 PHP 编写的）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T09:50:55.473

我不确定你能否做到这一点，因为 svn 只存储对文件的更改，而不是整个文件（我认为）。

但是，您可以设置提交后挂钩脚本，这样当您提交脚本时就会执行，即像 stage.domain.com 这样的文件夹会运行 svn up 并获取最新版本的代码库。

[http://svnbook.red-bean.com/en/1.1/ch05s02.html](http://svnbook.red-bean.com/en/1.1/ch05s02.html)

可能是你正在寻找的。

亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T09:53:26.967

**编辑：**我想我误解了你的问题。您不能将文档根目录指向 SVN 存储库，但可以将文档根目录指向您签出 SVN 主干的目录。

* * *

~~那没问题。~~你应该~~然而~~保护您的`.svn`目录，使其无法通过网络服务器访问。

```
<DirectoryMatch "^/.*/(\.svn|CVS)/">
    Order deny,allow
    Deny from all
</DirectoryMatch> 
```

以上内容适用于 Apache 的服务器配置、虚拟主机配置或`.htaccess`. 您可以使用 IIS7 中的 URL 重写模块达到相同的效果。其他网络服务器肯定会提供一些类似的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T10:28:14.107

看看[SvnFs](http://www.jmadden.eu/index.php/svnfs/)（它使用[FUSE](http://fuse.sourceforge.net/)或衍生产品，如[macfuse](http://code.google.com/p/macfuse/)）。

我从未使用过它，我想知道以这种方式访问​​主干是否是个好主意。例如：SvnFs 是否真的对树干进行了可见的更改（或者树干会在安装时被固定为特定的修订版）？如果确实显示了更改，是立即显示，还是仅在实际请求文件时显示（我假设如果 Web 服务器检查文件的时间戳是否已更改，那么这将触发 SvnFs 返回最新的详细信息）？最重要的是，我假设 SvnFs 会产生一个只读文件系统（如果不是，那么我不会使用它......），那么如果您的 Web 服务器想要创建一些文件怎么办？

（嗯，实际上还有 FUSE 的[Cascade](http://apps.sourceforge.net/mediawiki/fuse/index.php?title=VersioningFileSystems)，它提供了读写访问权限……）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-20T17:34:47.757

结帐时添加路径（主干）。例如 svn co [https://subversion.assembla.com/svn/trunk](https://subversion.assembla.com/svn/trunk)。

# c# - 包含 View 的 View 中如何继承 DataContext？

> ID：776419
> 
> 赞同：4
> 
> 时间：2009-04-22T09:45:28.093
> 
> 标签：c#, wpf, mvvm, datacontext

我正在重建[Josh Smith 的 WPF CommandSink 示例](http://www.codeproject.com/KB/WPF/VMCommanding.aspx)，关于他的数据绑定，我有一些不明白的地方，尤其是当一个视图包含在另一个视图中时如何继承数据上下文，而另一个视图包含在具有数据上下文的窗口中。

*   所有数据绑定都在 XAML 文件中声明，窗口或任何一个视图后面绝对没有代码（很好）
*   顶部窗口将其 DataContext 定义为 CommunityViewModel 并简单地显示 CommunityView
*   **问题：**那么现在在 CommunityViewModel 中，`jas:CommandSinkBinding.CommandSink="{Binding}"`实际上做了什么？“CommandSink”是一个附加属性，所以这是“附加”来自 DemoWindow 的继承绑定作为 CommandSinkBinding 对象上名为“CommandSink”的附加属性的值吗？

*   **问题：**另外，PersonView 似乎没有 DataContext 但它有诸如`<TextBlock Text="{Binding Name}" Width="60" />`假定设置了绑定的行。那么 PersonView 会自动从 CommunityView 的行中获取绑定`ItemsSource="{Binding People}"`吗？

感谢您在这里的任何澄清。

**DemoWindow.xaml：**

```
<Window 
  x:Class="VMCommanding.DemoWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:view="clr-namespace:VMCommanding.View"
  xmlns:vm="clr-namespace:VMCommanding.ViewModel"
  FontSize="13"
  ResizeMode="NoResize"
  SizeToContent="WidthAndHeight" 
  Title="ViewModel Commanding Demo"   
  WindowStartupLocation="CenterScreen"
  >
  <Window.DataContext>
    <vm:CommunityViewModel />
  </Window.DataContext>

  <Window.Content>
    <view:CommunityView />
  </Window.Content>
</Window> 
```

**CommunityView.xaml：**

```
<UserControl 
  x:Class="VMCommanding.View.CommunityView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:jas="clr-namespace:VMCommanding"
  xmlns:view="clr-namespace:VMCommanding.View"
  xmlns:vm="clr-namespace:VMCommanding.ViewModel"  
  jas:CommandSinkBinding.CommandSink="{Binding}"
  >
    <UserControl.CommandBindings>
        <jas:CommandSinkBinding Command="vm:CommunityViewModel.KillAllMembersCommand" />
    </UserControl.CommandBindings>

    <DockPanel Margin="4">
        <ItemsControl
      DockPanel.Dock="Bottom" ItemsSource="{Binding People}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <view:PersonView />
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
        <Button 
      Command="vm:CommunityViewModel.KillAllMembersCommand"
      Content="Kill All"
      Margin="0,0,0,8"
      />
    </DockPanel>
</UserControl> 
```

**人视图.xml：**

```
<UserControl 
  x:Class="VMCommanding.View.PersonView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:jas="clr-namespace:VMCommanding"
  xmlns:vm="clr-namespace:VMCommanding.ViewModel"
  jas:CommandSinkBinding.CommandSink="{Binding}"
  >  
  <UserControl.CommandBindings>
    <jas:CommandSinkBinding Command="vm:PersonViewModel.DieCommand" />
    <jas:CommandSinkBinding Command="vm:PersonViewModel.SpeakCommand" />
  </UserControl.CommandBindings>

  <UserControl.Resources>
    <Style TargetType="{x:Type TextBlock}">
      <Setter Property="Margin" Value="0,0,6,0" />
      <Style.Triggers>
        <DataTrigger Binding="{Binding CanDie}" Value="False">
          <Setter Property="Foreground" Value="#88000000" />
        </DataTrigger>
      </Style.Triggers>
    </Style>
  </UserControl.Resources>

  <StackPanel Margin="2" Orientation="Horizontal">
    <TextBlock Text="Name:" FontWeight="Bold" />
    <TextBlock Text="{Binding Name}" Width="60" />
    <TextBlock Text="Age:" FontWeight="Bold" />
    <TextBlock Text="{Binding Age}" Width="40" />
    <Button 
      Command="vm:PersonViewModel.SpeakCommand"
      CommandParameter="Howdy partner!"
      Content="Speak"
      Margin="0,0,6,0"
      Width="60"
      />
    <Button
      Command="vm:PersonViewModel.DieCommand"
      Content="Die"
      Width="60"
      />
  </StackPanel>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T11:25:12.567

如果设置`ItemsSource`ItemsControl 的 ，则该控件中项的 DataContext 将直接映射到`ItemsSource`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T09:52:02.867

除非为控件显式指定一个控件，否则控件会继承其父级 DataContext。所以你的第二个问题的答案是肯定的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T12:25:53.323

PersonView 由 CommunityView (CommunityView.xaml:16) 中的 ItemsControl 的 DataTemplate 生成。

DataTemplates 自动将其视觉对象的 DataContext 分配给模板正在显示的数据。这就是 WPF 的工作原理。

CommunityView 通过从 Window 继承来获取其 DataContext 集。

附加的命令接收器属性在具有附加属性分配的对象的 CommandBindings 属性中包含的所有 CommandSinkBinding 对象上设置实例 CommandSink 属性。所以在CommunityView.xaml中，CommunityView中所有CommandSinkBindings(KillAll)的CommandSink都通过绑定设置为视图的DataContext。

CommandSink 属性用于在正确的目标（本例中为 ViewModel）上调用 Execute 和 CanExecute 函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-09T16:54:24.480

DataContext 是 FrameworkElement（所有 WPF 控件的基类）上的属性，并作为 DependencyProperty 实现。这意味着逻辑树中的所有后代元素共享相同的 DataContext。

# .net - 在.NET中解析带有未转义引号和逗号的CSV文件

> ID：776420
> 
> 赞同：0
> 
> 时间：2009-04-22T09:46:00.353
> 
> 标签：.net, string, parsing, csv

我想知道是否有人可以帮助我。

我必须从 csv 文件中解析数据并将其放入 db 表中。数据示例如下：

“第一场”、“第二场” **、** “第三场**”**、“第四场**”**

如您所见，字段中嵌入了引号和逗号。我使用的是 ADO.NET，但嵌入的引号存在问题。嵌入引号后的任何字段都将为空

例如，从上面的示例中，以下内容将被插入到 DB 表中。

```
first field  |  second, field   |  third     | NULL 
```

这是我正在使用的代码。

```
 Dim dataTable As New DataTable
    Dim dataAdapter As New OleDbDataAdapter

    Dim cmd As New OleDbCommand
    Dim path As String = "c:\"

        Dim conn As OleDbConnection = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" _
           & System.IO.Path.GetDirectoryName(filename) & ";Extended Properties=""Text;HDR=Yes;FMT=Delimited""")

        cmd.CommandText = "Select * FROM " & System.IO.Path.GetFileName(filename)
        dataAdapter.SelectCommand = cmd
        cmd.Connection = conn
        conn.Open()
        dataAdapter.Fill(dataTable) 
```

然后我将数据插入到 db 表中。

对此的任何建议或指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T12:09:04.020

到目前为止还没有真正理解答案。

据我所知，如果不添加额外的限制，就无法解析您的示例输入字符串。

这是你的第三个领域出现了问题。解析器如何判断在第三个和字段之间的“之后我们还没有完成第三个元素？通过检测以下字符不是逗号？如果第三个字段也包含逗号怎么办，是否允许？

```
"first field", "second , field", "third ", Field " ", "fourth field" 
```

那时，您将进入多次试验和错误解析（尽管我不是专家）。也就是说，解析器必须到达字段的 F，并意识到这是不可解析的，备份并在第三个字段中包含“，并继续下面的”......等

[即使是 Excel 也无法处理该字符串。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T09:04:53.513

凉爽的。感谢您的所有帮助。我正在处理的文件非常大，因此手动解析效率不高。

我已经通过获取带有转义引号的正确 csv 文件并在没有发生这种情况时添加验证和错误处理来解决了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T10:40:14.390

您可以尝试将分隔字段的引号与不检查以下正则表达式是否可以匹配前面或后面字符 @"\p{Z} *,\p{Z}* " 的引号区分开来，使用相同的概念，您可以通过附近的引号来区分文本中的逗号，而不是分隔逗号。运行这些启发式方法并转义与上述规则不匹配的逗号和引号应该会产生一个非常干净的结果当然可能有一些情况不能正常工作，但据我所知，如果 CSV 未转义，则不会更好的方法来处理这个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T10:43:58.407

如果您的代码不需要成为应用程序的一部分，但您只想生成 SQL 语句以从 CSV 数据更新数据库，您可能对我自己的[CSVFix](http://code.google.com/p/csvfix/)项目感兴趣，它是 FOSS 并允许您操作 CSV 数据在许多方面无需编程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T10:22:57.487

这可能有点挑战 - 但是编写代码来手动解析一行 csv 数据是相当简单的。

基本上你有两种可能的情况：

1.  保证每个字段都用双引号分隔的地方
2.  任何包含逗号的字符串都将用双引号括起来 - 如果您在带引号的字符串中有逗号，那么事情可能会变得有趣，因此您可能必须设置限制您想要变得多么聪明（提供的数据可以包含什么）。

对于第一种情况，基本上您所要做的就是在“，”组合上拆分字符串（这可能必须手动完成）-记住从第一列/项目中删除前导“，从最后一列中删除尾随” /item - 你几乎就在那里。

对于第二种情况，您必须做更多的工作 - a) 在每个逗号上拆分行，然后处理结果，将相邻的项目缝合在一起，其中项目以双引号开头但不以双引号结尾（您连接字段- 不要忘记包含逗号 - '直到找到以 " 结尾但不以 " 开头的相应项目) 或 b) 在每次迭代时循环遍历字符串，您从列表中拉出第一项（如果它开始使用“ then you're looking for” 来结束它，否则你只是在自己寻找一个逗号，并且在这两种情况下都允许因为你正在查看最后一列而找不到分隔符的边界情况。

希望这可以帮助。一点点。

# xml - 有没有办法为共享点开发自动生成 elements.xml 等文件？

> ID：776422
> 
> 赞同：1
> 
> 时间：2009-04-22T09:46:56.700
> 
> 标签：xml, sharepoint, deployment, code-generation

我已经在我的解决方案中匹配了“12 hive”结构，并且我正在使用 SPDeploy 创建和部署 .wsp 文件并部署到我的测试服务器。

我将在整个结构中添加一大堆文件，elements.xml 和 feature.xml 文件中有很多冗余。有没有人做过帮助创建这些文件的工作？

编辑：第一个评论者是完全正确的，它是 elements.xml 中的东西是手工制作的痛苦，虽然我很高兴我的所有 xml 尽可能自动生成......我想我有某种过敏对手写 xml 的反应...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T09:53:01.990

您是否尝试过[CodePlex 的 WSPBuilder](http://wspbuilder.codeplex.com/)？它为给定的功能生成必要的 feature.xml 文件。或者，也许您正在寻找一些带有 GUI 的工具来拖入一堆文件，并且 elements.xml 将被更新？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T14:43:24.197

我相信 Visual Studio Extensions for WSS 1.3 版（VSeWSS v1.3）可以做到这一点，但我不确定。它似乎是 SharePoint 开发工具的下一个进步。请注意，如果我没记错的话，它需要 Visual Studio 2008。

以下是一些您可能会觉得有用的链接：

*   [http://channel9.msdn.com/posts/kirke/SharePoint-for-Developers-Part-1-Introducing-VSeWSS-13/Default.aspx#Page=1](http://channel9.msdn.com/posts/kirke/SharePoint-for-Developers-Part-1-Introducing-VSeWSS-13/Default.aspx#Page=1)
*   [http://channel9.msdn.com/posts/kirke/SharePoint-for-Developers-Part-2-Working-with-Features/](http://channel9.msdn.com/posts/kirke/SharePoint-for-Developers-Part-2-Working-with-Features/)
*   [http://wiki.threewill.com/display/enterprise/Visual+Studio+Extensions+for+WSS+(VSeWSS)+1.3](http://wiki.threewill.com/display/enterprise/Visual+Studio+Extensions+for+WSS+(VSeWSS)+1.3)

请注意，该系列的第二篇博客侧重于功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T14:47:55.433

如果您想要自动生成的 feature.xml 文件，您可能必须切换到 VSeWSS 1.3，它是 Microsoft 用于构建 SharePoint 解决方案的官方工具。

但是使用 VSeWSS，您还必须更改解决方案结构，因为您无法将其与整个 12 个蜂巢结构相匹配。但它包含将文件和东西放在 12 个配置单元中的其他概念。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-29T22:30:10.413

为什么不从您的项目或项目中的特定元素文件创建您自己的 Visual Studio 模板？将项目中的任何文件导出到模板是重用手工制作的 CAML 文件的好方法。

# asp.net-mvc - ASP.NET MVC 和 LINQ 一般问题

> ID：776426
> 
> 赞同：16
> 
> 时间：2009-04-22T09:47:34.220
> 
> 标签：asp.net-mvc, linq-to-sql

我以前就这个话题问过几个问题。在我们能够在工作中实现 MVC 或 LINQ 之前，我们需要解决一些问题。

**ASP.NET MVC 中的多个记录集**

使用中的唯一 MVC 示例仅返回一个结果集。使用存储过程时，可以检索多个记录集，我们倾向于使用存储过程的全部原因有两个（我相信你们中的许多人也知道）。首先，如果我们需要传递参数，其次如果我们想要返回多个数据表。这在 ASP.NET 的 MVC 架构中怎么可能？

在[本教程](http://www.asp.net/learn/mvc/tutorial-11-vb.aspx)中，我们将了解如何检索数据。但是它使用`ViewData.Model`which 表示单个结果集，它没有解释如果返回多个结果集会发生什么，或者如何获取它们。

**强类型存储过程输出**

此外，ASP.NET 网站上使用 LINQ 对输出进行强类型解析的示例是通过使用 *.dbml 格式实现的，该格式是表模式的镜像，允许使用 LINQ 查找字段。伟大的。但是，如果您的输出是从不直接映射到视图或表的存储过程自定义的，会发生什么？我们如何从这些存储过程中解析列名？

在上一节中，我描述了[本教程](http://www.asp.net/learn/mvc/tutorial-11-vb.aspx)，但这也只显示了如何仅为表创建 LINQ to SQL，而不是存储过程的自定义输出。

**LINQ 列查找**

在工作中，我们运行一个宏，它将一堆类导出到我们的 App_Code 文件夹，因此预定义了存储过程参数。这样做是为了我们不必调用包含对数据库的额外调用的 DeriveParameters。我们不希望这种情况发生，因为现在有很多流量。如果我们使用 LINQ，如何解析列数据类型？每次定义参数时，是否都会调用数据库以找出参数的数据类型和名称？从那以后情况有变化吗？它仍然每次都调用 DeriveParameters 吗？这些缓存在某处吗？

**DBML 格式**

*.dbml 文件是否应该包含数据库中的所有表？我们有大约 15 个数据库，每个数据库中有很多很多表。

**每个输出的视图**

还有一点要添加到这篇文章中。将数据表示为视图而不是手动创建 dbml 类更好，即使它是自定义输出？还是在 dbml 文件中创建自定义类更好？

**这一定是最后一个问题，否则我会吃掉自己的胳膊**

*“无法将‘SingleResult`1[IntranetMVC.UserDetail]’类型的对象转换为‘IntranetMVC.UserDetail’类型。”*

这是功能：

```
 Function Index() As ActionResult
    ViewData("Message") = "Welcome to ASP.NET MVC!"

    Dim userDetail As UserDetail
    Dim office As IList(Of Office)
    Dim activeUser As IList(Of ActiveUser)
    Dim dept As IList(Of Department)

    Using db As PersonnelDataContext = New PersonnelDataContext
      Dim results As IMultipleResults = db.UserDetail(1168)

      userDetail = results.GetResult(Of UserDetail)()
      office = results.GetResult(Of Office)()
      activeUser = results.GetResult(Of ActiveUser)()
      dept = results.GetResult(Of Department)()
    End Using

    Return View(New IndexViewData(userDetail, office, activeUser, dept))
  End Function 
```

它发生在所有`userDetail, office, activeUser`和`dept`作业上，但我不知道为什么。现在，我还没有正确映射它们，但以部门一为例。我已将表模式拖放到 dbml 文件中，因此它肯定存在并且格式正确。

**更新**

这是我的实际代码。这不是最终的，我一直在玩它。似乎返回类型不正确，但我不确定为什么。当存储过程实际返回四组数据时，似乎认为只返回一个结果。其中一个集合只有一个结果，其他集合总是返回多行：

*无法转换类型为“SingleResult `1[IntranetMVC.Office]' to type 'System.Collections.Generic.IList`1 ”的对象*

```
Imports System.Data.Linq
Imports System.Reflection
Imports System.Data.Linq.Mapping

Partial Class PersonnelDataContext

  <FunctionAttribute(Name:="dbo.UserDetailProc"), _
  ResultType(GetType(UserDetail)), _
  ResultType(GetType(IList(Of Office))), _
  ResultType(GetType(IList(Of ActiveUser))), _
  ResultType(GetType(IList(Of Department)))> _
  Public Function UserDetail( _
                  <Parameter(Name:="User_Key", DbType:="Int")> ByVal User_Key As Integer, _
                  <Parameter(Name:="EditYN", DbType:="Char")> Optional ByVal EditYN As Char = "N") As IMultipleResults

    Dim result As IExecuteResult = Me.ExecuteMethodCall(Me, CType(MethodInfo.GetCurrentMethod(), MethodInfo), User_Key, EditYN)
    Return CType(result.ReturnValue, IMultipleResults)
  End Function
End Class 
```

**使固定**

好吧，我没有意识到，因为老实说我没有正确检查返回类型。我*假设*results.GetResult(Of MyType) （来自 IMultipleResults）会返回一个集合。相反，它只返回单个结果并将指针移动到集合中的下一项。不幸的是，GetResult 是返回结果的唯一公开方法，因此您必须遍历集合并将它们添加到通用列表中。

非常感谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-22T10:06:51.943

### ASP.NET MVC 中的多个记录集

是的 - 最肯定的。

首先你需要手动创建一个调用存储过程的方法，返回一个`IMultipleResults`结果。

[此博客文章](http://blogs.msdn.com/swiss_dpe_team/archive/2008/02/04/linq-to-sql-returning-multiple-result-sets.aspx)包含您需要的所有信息。这很容易做，非常容易和有效。

你需要做的是两个步骤。

1.  创建一个调用存储过程并返回多条记录的方法（参考上面的博文）。
2.  创建一个在视图中使用的简单类对象，控制器设置属性。

例如。

```
IndexViewData.cs
public class IndexViewData
{
    IList<Customers> Customers { get; set; }
    IList<Products> Products { get; set; }
} 
```

.

```
HomeController.cs
public ActionResult Index()
{
    IList<Customers> customers;
    IList<Products> products;

    // This grabs the multiple records from a single stored procedure. 
    // This code taken from the blog post link, above.
    using (NorthwindDataContext db = new NorthwindDatacontext)
    {
        IMultipleResults results = db.GetMultipleRecordSets(arg1, ....);
        customers = results.GetResult<Customer>();
        products = results.GetProducts<Product>();
    }

    // Now return the view, with the viewdata that is required.
    return View(new IndexViewData
                    {
                        Customers = customers,
                        Products = products
                    });
} 
```

.

```
Index.aspx
<%@ Page 
    Language="C#" 
    MasterPageFile="~/Views/Shared/Site.Master" 
    Inherits="System.Web.Mvc.ViewPage<IndexViewData>" %>

<% Html.RenderPartial("CustomersUserControl", 
                       ViewData.Model.Customers); %>

 <br/>

<h2>Products</h2>
<% foreach(var product in ViewData.Model.Products) { %>
Name: <%= product.Name %><br/>
<% } %>

... 
```

请注意，我没有进行任何错误检查等。这是一个非常快速的伪代码指南，可以帮助您入门。

注意#2：请注意索引视图是强类型的（它继承了 ViewPage.

### 强类型存储过程输出

我已经回答了，上面。请注意，您可以强烈键入您的*ISingleResult*存储过程。

### LINQ 列查找

好的，我想我明白你的意思，在这里。当您创建调用存储过程（ an`ISingleResult`或 an `IMultipleResult`）的方法时，您正在定义所需的参数，然后......将其视为硬编码。

当您将表拖放到 linq to sql 上下文 gui 画布上时，Visual Studio 会在*那里进行查找检查，然后*. 然后它在上下文的各种文件之一中创建类。例如。NorthwindDataContext.designer 等。所以，这是一个*一击的工作*。创建类后，设计器将其显示在画布上。没有***同步回数据库***。没有任何。纳达。齐尔奇。如果您更改数据库架构中的任何内容（例如，添加新字段、更改存储过程参数等），datacontext 将*不*知道它。您需要删除表格并将其拖放回来。

### 奖金技巧！

如果在将表或存储过程拖放到画布上时运行 SQL Profiler，则可以看到 Visual Studio 正在“查询”数据库以获取信息。:)

是的。这是火-n-忘记。一举成名。需要手动同步。

HTH。

### 更新

我注意到你又添加了两个 q，所以我会在这里添加我的答案。

### DBML 格式

这是个人决定。15个数据库！亲！这是一个公平的数字。无论如何，它归结为您的 Context 画布的可维护性。其次，每个上下文都会创建它自己的数据库连接。因此，如果您的方法决定调用 4 个上下文，那么您将有 4 个连接（和往返）到数据库，伙计 :)

### 每个输出的视图

就个人而言，我的所有表格都在 Context Canvas 上。我从不在我的代码中使用这些表类。它们是私有的，仅在我的存储库命名空间/项目/dll 中使用。然后我使用[POCO](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)类来移动我所有的东西。这使我的代码更干净，并且不依赖于存储库。

### 更新#2

### 这一定是最后一个问题，否则我会吃掉自己的胳膊

如果您已将存储的过程拖到 linq 上下文画布上，请将其删除。不需要对方法的引用`UserDetails(int userId)`。

现在，将以下代码（您需要将其转换为 VB.NET）添加到数据上下文的部分类（我假设您知道那是什么/意味着什么，顺便说一句）：-

```
[Function("UserDetails")] // <-- This is the name of your stored procedure.
[ResultType(TypeOf(UserDetail))]
[ResultType(TypeOf(Office))]
[ResultType(TypeOf(ActiveUser))]
[ResultType(TypeOf(Department))]
public IMultipleResults UserDetails(
    [Parameter(Name = "UserId", DbType = "Int")] int userId)
//                      /\____     /\_____         ____/\                    
// This is where u _define_ the stored proc arguments.
{
    IExecuteResult result = this.ExecuteMethodCall(this, 
           ((MethodInfo)MethodInfo.GetCurrentMethod())), userId);
// This is where all the stored proc arguments are set ____/\
// This can be multiple args. eg. userId, name, ...
    return (IMultipleResults)result.ReturnValue;
} 
```

然后像在之前的 VB.NET 代码中那样使用它。

问题（我猜）是您没有制定处理`IMultipleResults`. 您仍在使用旧的存储过程代码签名，它（默认情况下）仅作为单个记录集结果（即。`ISingleResult`）。

如果您从服务器资源管理器中将存储的内容拖放到 linq 上下文画布上，则这是默认设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T09:57:14.320

**ASP.NET MVC 中的多个记录集：**

如果您有返回 A 和 B 的存储过程。然后您创建一个特定的 ViewModel：

```
public class AB
{
  public A DataA { get; set; };
  public B DataB { get; set; };
} 
```

您还可以使用 ViewData 字典而不是 Model 属性（或与此属性结合使用）

**强类型存储过程输出**

您可以使用自定义字段为从存储过程返回的结果创建一个特定的类。

**LINQ 列查找**

不是 100% 确定这一点，但 LINQ 在设计时从存储过程中查找列字段名称和参数名称。

# c# - 为什么 C# foreach 语句中的迭代变量是只读的？

> ID：776430
> 
> 赞同：39
> 
> 时间：2009-04-22T09:48:21.363
> 
> 标签：c#, language-design

据我了解，C# 的 foreach 迭代变量是不可变的。

这意味着我不能像这样修改迭代器：

```
foreach (Position Location in Map)
{
     //We want to fudge the position to hide the exact coordinates
     Location = Location + Random();     //Compiler Error

     Plot(Location);
} 
```

我不能直接修改迭代器变量，而是必须使用 for 循环

```
for (int i = 0; i < Map.Count; i++)
{
     Position Location = Map[i];
     Location = Location + Random();

     Plot(Location);        
     i = Location;
} 
```

来自 C++ 背景，我认为 foreach 可以替代 for 循环。但是由于上述限制，我通常会回退到使用 for 循环。

我很好奇，使迭代器不可变的原因是什么？

* * *

编辑：

这个问题更多的是好奇问题，而不是编码问题。我很欣赏编码答案，但我不能将它们标记为答案。

另外，上面的例子过于简单化了。这是我想要做的 C++ 示例：

```
// The game's rules: 
//   - The "Laser Of Death (tm)" moves around the game board from the
//     start area (index 0) until the end area (index BoardSize)
//   - If the Laser hits a teleporter, destroy that teleporter on the
//     board and move the Laser to the square where the teleporter 
//     points to
//   - If the Laser hits a player, deal 15 damage and stop the laser.

for (int i = 0; i < BoardSize; i++)
{
    if (GetItem(Board[i]) == Teleporter)
    {
        TeleportSquare = GetTeleportSquare(Board[i]);
        SetItem(Board[i], FreeSpace);
        i = TeleportSquare;
    }

    if (GetItem(Board[i]) == Player)
    {
        Player.Life -= 15;
        break;
    }
} 
```

我不能在 C# 的 foreach 中执行上述操作，因为迭代器 i 是不可变的。我认为（如果我错了，请纠正我），这是特定于语言中 foreach 的设计。

我对为什么 foreach 迭代器是不可变的很感兴趣。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-23T03:22:05.883

让我们从一个愚蠢但说明性的例子开始：

```
Object o = 15;
o = "apples"; 
```

我们绝不会觉得我们只是把数字 15 变成了一串苹果。我们知道这`o`只是一个指针。现在让我们以迭代器形式执行此操作。

```
int[] nums = { 15, 16, 17 };

foreach (Object o in nums) {
     o = "apples";
} 
```

同样，这真的什么也没做。或者至少它*不会*做任何事情，如果它编译。它当然不会将我们的字符串插入到 int 数组中——这是不允许的，而且我们知道这`o`只是一个指针。

让我们举个例子：

```
foreach (Position Location in Map)
{
     //We want to fudge the position to hide the exact coordinates
     Location = Location + Random();     //Compiler Error

     Plot(Location);
} 
```

如果要编译，则`Location`在您的示例中，星号会引用 in 中的值`Map`，但随后您将其更改为引用新的`Position`（由加法运算符隐式创建）。在功能上它等同于这个（它可以编译）：

```
foreach (Position Location in Map)
{
     //We want to fudge the position to hide the exact coordinates
     Position Location2 = Location + Random();     //No more Error

     Plot(Location2);
} 
```

那么，为什么微软禁止你重新分配用于迭代的指针呢？澄清一件事——你不希望人们认为他们已经改变了你在循环中的位置。另一个易于实现：变量可能隐藏一些内部逻辑，指示正在进行的循环状态。

但更重要的是，您没有理由*要*分配给它。它表示循环序列的当前元素。如果您遵循 Coding Horror ，则为其分配值会违反“单一责任原则”或[Curly 定律。](http://www.codinghorror.com/blog/archives/000805.html)一个变量应该只意味着一件事。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-22T09:55:04.357

如果变量是可变的，那可能会产生错误的印象。例如：

```
string[] names = { "Jon", "Holly", "Tom", "Robin", "William" };

foreach (string name in names)
{
    name = name + " Skeet";
} 
```

有些人*可能*认为这会改变数组内容。它达到了一点，但这可能是一个原因。今晚我会在我的注释规范中查找它......

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-22T11:35:54.817

我认为这是人为的限制，没有必要这样做。为了证明这一点，请考虑此代码，并为您的问题提供可能的解决方案。问题是分配，但对象的内部变化不会出现问题：

```
using System;
using System.Collections.Generic;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {

            List<MyObject> colection =new List<MyObject>{ new MyObject{ id=1, Name="obj1" }, 
                                                    new MyObject{ id=2, Name="obj2"} };

            foreach (MyObject b in colection)
            {
             // b += 3;     //Doesn't work
                b.Add(3);   //Works
            }
        }

        class MyObject
        {
            public static MyObject operator +(MyObject b1, int b2)
            {
                return new MyObject { id = b1.id + b2, Name = b1.Name };
            }

          public void Add(int b2)
          {
              this.id += b2;
          }
            public string Name;
            public int id;
        }
    }
} 
```

我不知道这种现象，因为我总是按照我描述的方式修改对象。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-22T11:00:53.730

修改集合时，修改可能会产生不可预知的副作用。枚举器无法知道如何正确处理这些副作用，因此他们使集合不可变。

另请参阅此问题： [What is the best way to modify a list in a foreach](https://stackoverflow.com/questions/759966/what-is-the-best-way-to-modify-a-list-in-a-foreach/759985#759985)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T09:58:51.180

foreach 语句适用于 Enumerable。Enumerable 的不同之处在于它不了解整个集合，它几乎是盲目的。

这意味着它不知道接下来会发生什么，或者实际上在下一个迭代周期之前是否有任何事情。这就是为什么你经常看到 .ToList() 以便人们可以获取 Enumerable 的计数。

出于某种我不确定的原因，这意味着您需要确保您的集合在您尝试移动枚举器时不会发生变化。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T11:14:04.090

使用 IEnumerable 对象的条件是，当您使用 Enumerable 访问它时，基础集合不得更改。您可以假定 Enumerable 对象是原始集合的快照。因此，如果您在枚举时尝试更改集合，它将引发异常。然而，枚举中获取的对象根本不是不可变的。

由于 foreach 循环中使用的变量是循环块的本地变量，因此该变量在块外不可用。

# selenium - 您使用哪些属性进行 Selenium 测试？

> ID：776433
> 
> 赞同：4
> 
> 时间：2009-04-22T09:49:20.300
> 
> 标签：selenium

我们可以通过以下几种方式搜索网站上的特定字段：基于 css、名称、id、结构，甚至是找到的任何文本。您决定使用哪种方式？

什么是最好的做法？

*编辑：我从开发人员的角度问：如何编写代码，通过**一种**方法更容易使用 Selenium 进行测试（即：能够通过名称搜索所有这些代码）*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T10:02:29.440

我们通常远离 xml 结构，结果证明它会生成过于脆弱的测试。我们的内部组织禁止使用 CSS 名称，因为这是供设计人员操作的。您不希望您的测试中断，因为有人将样式从标题 1 更改为标题 2。

我们选择了主要基于 id 的解决方案。有时我们甚至使用 id 来检测 HTML 只是为了能够进行硒测试。

此外，我们还寻找文本（应用程序文本），但国际化使这有点痛苦；我们已经让我们的测试夹具语言环境知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T18:16:39.177

如果你能记住的话，ID 几乎总是最好的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-28T14:28:54.260

我倾向于使用 XPath 表达式来寻找 'id' 或 'name' 属性。

但是，如果您定期在 IE6 中执行测试，请注意使用 XPath 进行定位器表达式。与更高版本或 Firefox 相比，XPath 在 IE6 中的运行速度明显较慢。我有一个相当大的 SeleniumRC 测试套件，使用 IE6 需要三个多小时才能完成，而使用 Firefox 则需要一个小时。（所有这些时间都不是由 XPath 引起的，但它确实有很大贡献）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-01T19:41:40.247

过了一会儿，我发现了其他选择：创建自己的属性并为 Selenium IDE 构建 javascript 函数，以基于此属性生成 xpath。这并不难:)

它使生成和维护测试变得如此容易（当突然 span 变成 div 时；））

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-02-10T19:53:26.330

确保在整个代码中使用 id 将有很大帮助！即使该元素从 span 更改为 div，id 也保持一致。'name' 类似于 id。链接是不错的，但你必须注意链接文本不会是可能改变的东西。

这是我的定位器排名，从最好到不太好：id name link css ui xpath

# jquery - jquery：空但忽略文本节点

> ID：776434
> 
> 赞同：4
> 
> 时间：2009-04-22T09:49:21.220
> 
> 标签：jquery

说我的标记是：

```
<ul>
    <li id="num1">hello</li>
    <li id="num2"><p>hello</p></li>
    <li id="num3">sdf dfg</li>
    <li id="num4"></li>
    <li id="num5"><a>linky</a></li>
</ul> 
```

如何查询`ul`要返回`#num1, #num3 and #num4`的（没有子标签的）？

就像是：

```
$('ul').children('li:empty') 
```

但是从文档中：

```
:empty  Returns: Array<Element(s)>
Matches all elements that have no children (including text nodes). 
```

因为它包含文本，所以上面的查询只返回 me `#num4`。

我应该/可以做什么？

编辑：我也在使用 jQuery 1.1.4（不要问）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T09:56:02.420

[如何获取没有子元素但可能有文本的元素？](https://stackoverflow.com/questions/743957/how-to-get-elements-which-have-no-children-but-may-have-text)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T09:53:26.420

你可以试试这个：

```
$('ul').children().filter(function()
{
    return $(this).children().length != 0;
}); 
```

基本上，该函数检查直接子代的数量是否为零。它可能不是最优雅的解决方案，但至少它会起作用。

# apache - Apache 相当于 lighttpd url.rewriteonce？

> ID：776436
> 
> 赞同：1
> 
> 时间：2009-04-22T09:50:33.230
> 
> 标签：apache, mod-rewrite, lighttpd

我有这样的应用程序入口点。

```
/app/index.php <-- this is the main dispatcher. 
```

和 /app/ 下的应用程序特定文件夹

```
/app/todo/
/app/calendar/
/app/bugtrack/ 
```

每个应用程序文件夹都包含应用程序特定的文件。

我想通过应用程序下的所有请求通过/app/index.php。

以便。

```
/app/todo/list/today -> goes to /app/index.php
/app/ -> goes to /app/index.php
/app/bugtrack/anything/else goes to /app/index.php 
```

在我的 lighttpd 测试机器上，我可以通过编写这样的规则轻松地做到这一点。

```
url.rewrite-once = (
    "^\/app\/todo\/*"   => "/app/index.php",
    "^\/app\/calendar\/*"   => "/app/index.php",
    "^\/app\/bugtrack\/*"   => "/app/index.php",
) 
```

现在需要使用 .htaccess 和 mod_rewrite 使其在 Apache 上工作。

但无论我做什么，它都不起作用。

我在 /app/.htaccess 中写了以下内容

```
RewriteEngine on
RewriteRule .* index.php [QSA] 
```

例如，它适用于 /app/ 和 /app/todo/ 但对 /app/todo/list/today 无效。

任何人都可以给我任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T09:54:30.910

```
RewriteEngine On
RewriteBase /app
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . index.php [L] 
```

如果请求不是文件名或目录，则将其重写为 index.php。然后检查`$_SERVER[REQUEST_URI]`。

# c# - 如何从 C# 中的 MethodCallExpression 调用方法

> ID：776442
> 
> 赞同：21
> 
> 时间：2009-04-22T09:52:12.397
> 
> 标签：c#, .net, lambda, parameters

我有一个方法调用表达式并尝试调用该方法。我想出了一个办法，但我在检索参数值时遇到了问题，因为不是每个参数都用 ConstantExpression 描述。

```
Expression<Action<T>> = t => t.DoSomething(Par0, Par1, Par2);
MethodCallExpression methodCallExpression = selector.Body 
                                               as MethodCallExpression;

// get the information which is needed to invoke the method from the provided 
// lambda expression.
MethodInfo methodInfo = methodCallExpression.Method;
object[] arguments = methodCallExpression.Arguments.OfType<ConstantExpression>()
                            .Select(p => p.Value).ToArray();

// invoke the expression on every item within the enumerable
foreach (TSource item in source)
{ 
    methodInfo.Invoke(item, arguments);
} 
```

此外，我已经看到了一些其他调用该方法的方法，现在我不确定什么是正确的方法。

```
var func = expression.Compile();
var success = func.Invoke(); 
```

所以我的问题是，如何从中检索方法参数值`methodCallExpression.Arguments`？

或者有没有更简单的方法来实现我的目标？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-22T10:07:05.077

您无需担心检索参数和自己调用 MethodInfo，您可以让 .NET 为您完成。您需要做的就是创建一个包含该方法的 Lambda 表达式。

例如。

```
MethodCallExpression expression = GetExpressionSomeHow();
object result = Expression.Lambda(expression).Compile().DynamicInvoke(); 
```

这就是我在我的 Linq 提供程序中处理嵌套查询的方式。

编辑：实际上，看起来您可能已经在选择器变量中有一个 LambdaExpression。在这种情况下，您应该能够直接编译和调用它：

```
object result = selector.Compile().DynamicInvoke(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-09-25T23:25:35.883

编译表达式是一项非常密集的操作，因此只有在您计划重新使用该表达式时，我才会这样做。否则我会推荐反射方式；你会发现它执行得更快。切勿在紧密循环中调用 expression.Compile()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-17T10:30:33.100

@Ch00k <-- 谢谢，很好的解释。我只想补充一点

```
selector.Compile(); 
```

给你一个代表。对于实例方法，您需要一个实例来调用此方法。您将此实例作为参数传递给 DynamicInvoke ala

```
// Grab the method from MyClass - param1 and param2 are the actual parameters you
// want to pass to the method call.
Expression<Func<MyClass, TValue>> selector = (x => x.MyMethod(param1, param2));

// Create an instance of MyClass to call the method on
var myClass = new MyClass();

// Call the method on myClass through DynamicInvoke
object returnValue = selector.Compile().DynamicInvoke(myClass); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-24T15:15:04.033

如果您想将您的 expression.call 编译为 Action 或 Func，您可以这样做：

```
var method = typeof(MyType).GetMethod(nameof(MyType.MyMethod), BindingFlags.Public | BindingFlags.Static);
var parameter = Expression.Parameter(typeof(string), "s");
var call = Expression.Call(method, parameter);
var lambda = Expression.Lambda<Func<string, int>>(call, call.Arguments.OfType<ParameterExpression>());
var func = lambda.Compile();
int result = func("sample string input"); 
```

这使您可以简单地执行 func.Invoke("mystring") 或 func("my string");

这里的秘密是你需要传递你在创建 Expression.Call 时使用的相同参数，否则你会得到一个类型为“InvalidOperationException”的错误，变量 's' 类型是从范围 '' 引用的 'System.String' ，但它是没有定义的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-18T20:40:11.620

我会尝试这个来返回对象：

```
private static object _getValue(MethodCallExpression expression)
{
    var objectMember = Expression.Convert(expression, typeof(object));

    var getterLambda = Expression.Lambda<Func<object>>(objectMember);

    var getter = getterLambda.Compile();

    return getter();
} 
```

可以调用以下命令要快得多：

```
LambdaExpression l = Expression.Lambda(Expression.Convert(element, element.Type));
return l.Compile().DynamicInvoke(); 
```

# rest - REST Web 应用程序中的分页

> ID：776448
> 
> 赞同：341
> 
> 时间：2009-04-22T09:53:59.413
> 
> 标签：rest, sorting, pagination

这是[这个问题](https://stackoverflow.com/questions/676571/pagination-and-sorting-in-a-rails-restful-application)的更通用的重新表述（消除了 Rails 的特定部分）

我不确定如何在 RESTful Web 应用程序中的资源上实现分页。假设我有一个名为 的资源`products`，您认为以下哪种方法是最好的方法，以及为什么：

## 1\. 只使用查询字符串

例如。`http://application/products?page=2&sort_by=date&sort_how=asc`
这里的问题是我不能使用整页缓存，而且 URL 不是很干净且易于记忆。

## 2.使用页面作为资源和查询字符串进行排序

例如。`http://application/products/page/2?sort_by=date&sort_how=asc`
在这种情况下，看到的问题是它`http://application/products/pages/1`不是唯一资源，因为使用`sort_by=price`会产生完全不同的结果*，而*我仍然无法使用页面缓存。

## 3\. 使用页面作为资源和 URL 段进行排序

例如。`http://application/products/by-date/page/2`
我个人认为使用这种方法没有问题，但有人警告我这不是一个好方法（他没有给出理由，所以如果你知道*为什么*不推荐，请告诉我）

*任何*建议，意见，批评都非常受欢迎。谢谢。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-04-22T11:14:14.620

我同意 Fionn 的观点，但我会更进一步说，对我来说，页面**不是**资源，它是请求的属性。这让我只选择了选项 1 查询字符串。感觉刚刚好。我真的很喜欢[Twitter API](https://dev.twitter.com/rest/public)的宁静结构。不太简单，不太复杂，有据可查。无论是好是坏，当我在做某事时以一种方式与另一种方式做某事时，这是我的“首选”设计。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-04-22T10:15:59.360

我认为版本 3 的问题更多是“观点”问题——您将页面视为资源还是页面上的产品。

如果您将页面视为资源，这是一个完美的解决方案，因为对第 2 页的查询将始终产生第 2 页。

但是，如果您将页面上的产品视为资源，您就会遇到问题，即第 2 页上的产品可能会更改（旧产品已删除或其他），在这种情况下，URI 并不总是返回相同的资源。

例如，客户存储了指向产品列表页面 X 的链接，下次打开该链接时，相关产品可能不再出现在页面 X 上。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-12-04T19:55:40.320

HTTP 有很好的 Range 标头，也适合分页。你可以寄

```
Range: pages=1 
```

只有第一页。这可能会迫使您重新考虑什么是页面。也许客户想要不同范围的物品。Range 标头也可用于声明订单：

```
Range: products-by-date=2009_03_27- 
```

获得比该日期更新的所有产品或

```
Range: products-by-date=0-2009_11_30 
```

获取早于该日期的所有产品。'0' 可能不是最好的解决方案，但 RFC 似乎想要范围开始的东西。可能部署的 HTTP 解析器不会解析units=-range_end。

如果标题不是（可接受的）选项，我认为第一个解决方案（全部在查询字符串中）是一种处理页面的方法。但是请规范化查询字符串（按字母顺序排序（键=值）对）。这解决了“?a=1&b=x”和“?b=x&a=1”的微分问题。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2009-07-26T17:54:19.257

选项 1 似乎是最好的，因为您的应用程序将分页视为一种为同一资源生成不同视图的技术。

话虽如此，URL 方案是相对无关紧要的。如果您将应用程序设计为**[超文本驱动](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)**（因为所有 REST 应用程序都必须按照定义），那么您的客户端将不会自行构建任何 URI。相反，您的应用程序将向客户端提供链接，客户端将跟随它们。

您的客户可以提供的一种链接是分页链接。

所有这一切的令人愉快的副作用是，即使您改变了对分页 URI 结构的看法并在下周实现完全不同的东西，您的客户也可以继续工作而无需任何修改。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-05-04T17:09:22.593

我一直使用选项 1 的风格。缓存不是问题，因为在我的情况下数据经常更改。如果您允许页面的大小是可配置的，那么再次无法缓存数据。

我不觉得网址难以记住或不干净。对我来说，这是对查询参数的一种很好的使用。该资源显然是一个产品列表，查询参数只是告诉您希望列表如何显示 - 排序和哪个页面。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2010-03-16T23:26:07.623

奇怪的是，没有人指出选项 3 具有特定顺序的参数。 *http//application/products/Date/Descending/Name/Ascending/page/2* 和 *http//application/products/Name/Ascending/Date/Descending/page/2*

指向相同的资源，但具有完全不同的 url。

对我来说，选项 1 似乎是最容易接受的，因为它清楚地将**“我想要什么”**和**“我想要**什么”分开（它们之间甚至还有问号，哈哈）。可以使用完整的 URL 实现整页缓存（无论如何，所有选项都会遇到同样的问题）。

使用 URL 中的参数方法的唯一好处是干净的 URL。尽管您必须想出一些方法来编码参数并无损解码它们。当然你可以使用 URLencode/decode，但它会让 url 再次变得丑陋 :)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-03-08T16:54:13.517

寻找我遇到的这个网站的最佳实践：

[http://www.restapitutorial.com](http://www.restapitutorial.com)

在资源页面中有一个下载 .pdf 的链接，其中包含作者建议的完整 REST 最佳实践。其中有一个关于分页的部分。

作者建议添加对使用 Range 标头和使用查询字符串参数的支持。

**要求**

HTTP 标头示例：

```
Range: items=0-24 
```

查询字符串参数示例：

```
GET http://api.example.com/resources?offset=0&limit=25 
```

其中*offset*是开始的项目编号，*limit*是要返回的最大项目数。

**回复**

响应应包含一个 Content-Range 标头，指示正在返回的项目数以及尚待检索的总项目数

HTTP 标头示例：

```
Content-Range: items 0-24/66

Content-Range: items 40-65/* 
```

在 .pdf 中有一些针对更具体案例的其他建议。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-07-23T09:05:53.397

我更喜欢使用查询参数偏移量和限制。

**offset**：用于集合中项目的索引。

**限制**：用于项目计数。

客户端可以简单地不断更新偏移量，如下所示

```
offset = offset + limit 
```

下一页。

该路径被视为资源标识符。并且页面不是资源，而是资源集合的子集。由于分页通常是 GET 请求，因此查询参数最适合分页而不是标题。

参考：[https ://metamug.com/article/rest-api-developers-dilemma.html#Requesting-the-next-page](https://metamug.com/article/rest-api-developers-dilemma.html#Requesting-the-next-page)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-22T10:16:49.890

我目前在我的 ASP.NET MVC 应用程序中使用与此类似的方案：

例如`http://application/products/by-date/page/2`

具体是：`http://application/products/Date/Ascending/3`

但是，我对以这种方式在路由中包含分页和排序信息并不满意。

项目列表（在这种情况下为产品）是可变的。即下次有人返回包含分页和排序参数的url时，他们得到的结果可能已经改变。`http://application/products/Date/Ascending/3`因此，作为指向已定义的、不变的产品集的唯一 url的想法就消失了。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-22T14:05:42.773

我倾向于同意 slf 的观点，即“页面”并不是真正的资源。另一方面，选项 3 更简洁，更易于阅读，用户更容易猜到甚至在必要时输入。我在选项 1 和 3 之间纠结，但没有看到任何不使用选项 3 的理由。

此外，虽然它们看起来不错，但正如有人提到的那样，使用隐藏参数而不是查询字符串或 URL 段的一个缺点是用户无法添加书签或直接链接到特定页面。这可能是也可能不是问题，具体取决于应用程序，但只是需要注意的事情。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-22T11:41:57.470

我之前使用过解决方案 3（我写了很多 django 应用程序）。而且我不认为这有什么问题。它与其他两个一样可生成（以防您需要进行大规模刮擦等），并且看起来更干净。另外，您的用户可以猜测 url（如果它是面向公众的应用程序），人们喜欢能够直接去他们想要的地方，并且 url-guessing 感觉授权。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-13T23:59:22.633

我在我的项目中使用以下网址：

```
http://application/products?page=2&sort=+field1-field2 
```

这意味着 - “给我页面的第二页按 field1 升序，然后按 field2 降序”。或者，如果我需要更大的灵活性，我会使用：

```
http://application/products?skip=20&limit=20&sort=+field1-field2 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-06T05:00:54.307

我使用以下模式来获取下一页记录。 [http://application/products?lastRecordKey=?&pageSize=20&sort=ASC](http://application/products?lastRecordKey=?&pageSize=20&sort=ASC)

RecordKey 是在 DB 中保存顺序值的表的列。这用于从 DB 一次仅获取一页数据。pageSize 用于确定要获取多少条记录。sort 用于对记录进行升序或降序排序。

# c# - 从 .Net C# 调用 COM 对象

> ID：776455
> 
> 赞同：1
> 
> 时间：2009-04-22T09:56:25.790
> 
> 标签：c#, .net, com

我正在尝试从我的 C# 应用程序访问 COM dll(eObjectBroker)。以下是我做过的事情。

1.  运行 tlbimport`eObjectBroker.dll`以获取程序集。我得到两个程序集，`COMSVCLIB`从`eObjectBroker`. 所以我有`eObjectType.dll`和`COMSCVLIB.dll`

2.  我在我的 .Net c# 项目中添加了对这两个程序集的引用。我还添加了对`adodb.dll`作为函数调用的引用，该函数调用返回一个 Recordset 类型的对象。

3.  我为一个类创建实例`eObjectType`并调用它的一个函数。在这个电话中我得到了错误**`Object variable or with Block variable not set`**

我错过了什么？这是访问 COM dll 的正确方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T10:05:59.447

使用 VS2005 及以后您所要做的就是添加对已注册（使用 regsvr32.exe）COM dll 的引用，创建一个新实例并调用它的方法。我相信您将不得不实例化 COM 对象的主类，并通过该接口访问其他部分。

# apache-flex - Flex AS3 - 类之间的调度事件

> ID：776457
> 
> 赞同：1
> 
> 时间：2009-04-22T09:57:11.730
> 
> 标签：apache-flex, actionscript-3

我以为我在 Flex 中有自定义事件，但似乎没有。我试图通过在类之间调度事件而不是使用可怕的 parent.parent.parent 语句来松散地耦合我的应用程序。

我在自定义 HBox 类中有一个 ComboBox ...为简单起见，我正在执行以下操作

```
public function onComboBoxChange(event:MouseEvent):void {
    trace("dispatching event");
    dispatchEvent(new Event("hello"));
} 
```

我有一个自定义 List 类，我想响应该事件...

```
public function CustomList() {
    //...
    this.addEventListener(FlexEvent.INITIALIZE, onInit);
}

private function onInit(event:FlexEvent):void {
    this.addEventListener("hello", onHello);
}

private function onHello(event:Event):void {
    trace("oh hello");
} 
```

然而，事件监听器永远不会被调用。

CustomList 和 CustomHBox 都具有相同的父级。

我的印象是你可以从任何对象 dispatchEvent 并且所有其他活动对象都能够监听它。不是那么简单吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T10:11:58.810

您的列表需要直接在组合框上调用 addEventListener("hello")，或者组合框需要使用为 true 的气泡参数来调度事件。

您的事件概念缺少“冒泡”，您可以在[Adob​​e 网站](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000138.html)上阅读有关 Flash 事件的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T20:00:46.460

如果您的活动冒泡，您应该还是可以的。CustomList 和 CustomHBox 的父级将为您从 onComboBoxChange 调度的事件添加一个事件侦听器到 CustomHBox。事件处理程序应该在这个父类中，它将传递事件/执行需要在 CustomList 中执行的任何代码，即：

```
public class Main {

public var customList:CustomList;
public var customHBox:CustomHBox;
//...
public function init():void {
   customHBox.addEventListener(MyCustomEvent.EVENT_NAME, myCustomEventHandler, false, 0, true);
}
//...
public function myCustomEventHandler(event:MyCustomEvent):void {
   customList.update(event.data);
}
//...
} 
```

# ruby - 使用 ruby splat 运算符在哪里合法？

> ID：776462
> 
> 赞同：18
> 
> 时间：2009-04-22T09:58:23.087
> 
> 标签：ruby, arrays, syntax, operator-precedence, splat

Splats 很酷。它们不仅仅用于爆炸数组，尽管这很有趣。它们还可以转换为 Array 和展平数组（请参阅[http://github.com/mischa/splat/tree/master](http://github.com/mischa/splat/tree/master)了解它们所做的详尽列表。）

看起来无法对 splat 执行额外的操作，但在 1.8.6/1.9 中，以下代码会抛出“unexpected tSTAR”：

`foo = bar || *zap #=> unexpected tSTAR`

而这有效：

`foo = *zap || bar #=> works, but of limited value`

splat 可以出现在表达式中的什么位置？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-22T14:46:21.067

首先，优先级在这里不是问题，因为`foo = bar || (*zap)`效果并不好。一般的经验法则是您不能对 splat 执行其他操作。即使是简单的事情`foo = (*zap)`也是无效的。这也适用于 1.9。

话虽如此，您希望`foo = bar || *zap`做什么，如果它有效，那不同于`foo = bar || zap`？即使在像`a, b = bar || *zap`（这也不起作用）这样的情况下，也能`a, b = bar || zap`完成我认为是同一件事的事情。

这可能有意义的唯一情况是`a, b = foo, bar || *zap`. 您应该会发现，您希望使用它的大多数情况都包含在`a, b = foo, *(bar || zap)`. 如果这不包括你的情况，你可能应该问问自己，你真正希望通过编写这样一个丑陋的结构来完成什么。

* * *

## 编辑：

响应您的评论，`*zap || bar`相当于`*(zap || bar)`. 这表明 splat 的优先级有多低。它到底有多低？我能给你的最好答案是“相当低”。

但是，对于一个有趣的示例，请考虑一个`foo`采用三个参数的方法：

```
def foo(a, b, c)
  #important stuff happens here!
end 
```

`foo(*bar = [1, 2, 3])`将在赋值后 splat 并将参数分别设置为 1、2 和 3。比较`foo((*bar = [1, 2, 3]))`which 会抱怨参数数量错误（1 比 3）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-04-08T18:04:02.497

“splat 运算符”实际上根本不是运算符，而是 Ruby 语法中定义的标记。通读 Grammar.y 或 BNF 形式* 的 Ruby 语法会告诉你它被允许作为最后一个或唯一的参数：

*   在方法定义中（除了可选的 last `&foo`）
*   在方法调用中（除了可选的 last `&foo`）
*   在 as assignment 的 LHS 上，例如：`a, b, *cs = [1,2,3,4]`
*   在作业的 RHS 上，例如：`a, b, c = 1, 2, *[3,4,5]`
*   在 case 语句的 when 子句中

# entity-framework - ADO.NET 数据服务：如何根据外键过滤实体？

> ID：776473
> 
> 赞同：1
> 
> 时间：2009-04-22T10:04:52.070
> 
> 标签：entity-framework, filtering, wcf-data-services

无论如何，这可能是与实体框架相关的问题：

考虑以下简单的数据库模式：

```
CREATE TABLE Supplier(
    SupplierId int identity(1,1) not null primary key,
    DisplayName nvarchar(50)
)

CREATE TABLE Category(
    CategoryId int identity(1,1) not null primary key,
    DisplayName nvarchar(50)
)

CREATE TABLE Product(
    ProductId int identity(1,1) not null primary key,
    SupplierId int references Supplier.SupplierId,
    CategoryId int references Category.CategoryId,
    DisplayName nvarchar(50)
) 
```

我想要的是根据供应商和类别过滤产品。通常我只会提供一个类别 ID 和一个供应商 ID，但由于我通过 EF 公开我的数据库，数据服务不允许我做这样的事情：

```
$filter=SupplierId eq 1 and CategoryId eq 2 
```

这似乎是一个很常见的场景，所以它一定是可能的。但是怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T10:38:13.007

事实证明这很容易，这是如何完成的：

```
$filter=Product/Supplier/SupplierID eq 1 and Products/Category/CategoryID eq 1 
```

问候。

# subsonic - 使用 AndExpression 进行外连接

> ID：776479
> 
> 赞同：0
> 
> 时间：2009-04-22T10:09:44.883
> 
> 标签：subsonic

是否可以在 SubSonic 中进行这样的查询

```
SELECT * FROM [customer] 
LEFT OUTER JOIN [orders] ON [customer].[customerid] = [orders].[customerid] 
AND [orders].[deptid] = 2 
```

我使用以下 SubSonic (2.1) 代码进行了尝试：

```
SqlQuery q = DB.Select().From<Customer>()
    .LeftOuterJoin(orders.customerid, customer.customerid)
    .AndExpression(orders.deptid).IsEqualTo(2); 
```

当我在 SQL 探查器中查看已生成的查询时，它是：

```
SELECT * FROM [customer] 
LEFT OUTER JOIN [orders] ON [customer].[customerid] = [orders].[customerid] 
WHERE [orders].[deptid] = 2 
```

关键是 和 的区别`AND [orders].[deptid] = 2` ，`WHERE [orders].[deptid] = 2`这当然会导致 2 个不同的结果集。

这是我可以用 SubSonic 做的事情，还是我所做的 SubSonic 查询不正确？

谢谢你的帮助！！

编辑：例如我有 2 个客户，1 有几个订单，而第二个客户没有。仅包含联接的数据示例 (SELECT customerid, orderid, deptid FROM [customer] LEFT OUTER JOIN [orders] ON [customer].[customerid] = [orders].[customerid]) 将返回：

A 行：customerid 1、orderid 1、deptid 2

B 行：customerid 1，orderid 2，deptid 1

C 行：customerid 2，orderid NULL，deptid NULL

带有 AND 语句的 SQL 将返回行 A 和 C。我相信这是因为在连接过程中会评估 AND。

带有 WHERE 语句的 SQL 将只返回 A 行，因为 WHERE 在连接之后进行评估，然后只有 A 行的 deptid 为 2。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-22T10:29:58.830

> 关键是 AND [orders].[deptid] = 2 和 WHERE [orders].[deptid] = 2 的区别，这当然会导致 2 个不同的结果集。

两者都将返回相同的结果集。可能会有一些性能差异，但我不这么认为。作为现代数据库，更好地优化查询。

# xslt - 如何在 XSLT 中动态选择节点

> ID：776481
> 
> 赞同：1
> 
> 时间：2009-04-22T10:09:58.487
> 
> 标签：xslt

我有一个 XML 文件：

```
<?xml version="1.0" standalone="yes"?>
<Questionnaire>
  <Temp_GridTypeTable_6>
    <Column2>Select Yes/No</Column2>
  </Temp_GridTypeTable_6>
  <Temp_GridTypeTable_1>
    <Column2>Rank 1,2,3</Column2>
  </Temp_GridTypeTable_1>
  <Temp_GridTypeTable_1>
    <Column1>I needed the income</Column1>
    <Column2>Why did you take a job on this project?</Column2>
  </Temp_GridTypeTable_1>
  <Temp_GridTypeTable_1>
    <Column1>Other</Column1>
    <Column2></Column2>
  </Temp_GridTypeTable_1>
  <Temp_GridTypeTable_2>
    <Column2>Select "Yes/No"</Column2>
  </Temp_GridTypeTable_2>
  <Temp_GridTypeTable_2>
    <Column1>No jobs</Column1>
    <Column2>344</Column2>
  </Temp_GridTypeTable_2>
  <Temp_GridTypeTable_3>
    <Column2>Input</Column2>
  </Temp_GridTypeTable_3>
  <Temp_GridTypeTable_3>
    <Column1>Unit</Column1>
    <Column2>123</Column2>
  </Temp_GridTypeTable_3>
</Questionnaire> 
```

我想访问

```
<xsl:for-each select="Questionnaire/concat('Temp_GridTypeTablenode_',"1"))> 
```

但这种说法是行不通的。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-22T10:29:34.850

这是如何不使用 XML 的一个很好的例子。“Temp_GridTypeTable”和“Column”数字是数据，而不是结构，它们不应包含在元素名称中。那么你为什么不使用一些不那么痛苦的东西，说：

```
<Questionnaire>
  <Temp_GridTypeTable type="6">
    <Column num="2">Select Yes/No</Column>
  </Temp_GridTypeTable>
  <Temp_GridTypeTable type="1">
    <!-- ... -->
  <Temp_GridTypeTable>
  <!-- ... -->
</Questionnaire> 
```

话虽如此，对于您目前的情况，这是需要的：

```
<xsl:for-each select="Questionnaire/*[
  local-name()
  =
  concat('Temp_GridTypeTable_', '1')
]"> 
```

对于输入的“不那么痛苦”版本，这将是必需的：

```
<xsl:for-each select="Questionnaire/Temp_GridTypeTable[@type = 1]"> 
```

尽管第二个表达式更简单、更直接，但它的性能也会好得多。如果您能提供帮助，我建议您更改输入 XML。

* * *

编辑：跟进评论中展开的论点，我试图强调 the[`local-name()`](http://www.w3.org/TR/xpath#function-local-name)和[`name()`](http://www.w3.org/TR/xpath#function-name)XPath 函数之间的区别，以及区别在哪里很重要：

```
                            | XML 有命名空间 | XML 没有命名空间
----------------------------------------+---------- +------------------------
我关心命名空间 | 使用`name()` | 使用任一功能
                            | |
不关心命名空间 | 使用 `local-name()` | 使用任一功能

```

一般来说：如果您属于“不关心名称空间”组（大多数 XML 新手或临时 XML 用户都这样做），那么始终使用`local-name()`. 但是，当您获得的结果与您期望的结果开始出现分歧时，请准备好了解 XML 名称空间。此时，您不再属于上述组。

如果你属于“我关心命名空间”组，那么无论如何你都不需要这个建议。;-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T13:31:48.500

利用：

        **`Questionnaire/*[name() = concat('', $vSuffix)]`**

其中变量`$vSuffix`包含静态未知的字符串——在本例中为“1”。

**在 Tomalak 的答案中使用`local-name()`as 既不必要又冗长且不精确**，因为在一般情况下*，它允许选择具有各种（可能不需要和意外）名称的元素*，例如：

*   `OhMy:Temp_GridTypeTable_1`
*   `Different:Temp_GridTypeTable_1`
*   `UnWanted:Temp_GridTypeTable_1`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T10:55:19.173

您不能在运行时使用纯 XSLT 将字符串计算为 XPath 表达式。

您需要一个可以在运行时评估 xpath 表达式的扩展函数。参见例如[EXSLT 项目](http://exslt.org/dyn/index.html)。

在我的系统上，使用`xsltproc`，我可以完成你想要的：

```
<!-- load the saxon extensions -->
<xsl:stylesheet version="1.0" xmlns:xx="http://icl.com/saxon" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
...
...
<xsl:for-each 
    select="xx:evaluate(concat('Questionnaire/Temp_GridTypeTable_', '1'))"> 
```

在这里，我使用了来自 saxon 扩展库的评估函数。EXSLT 的评估函数应该以同样的方式工作。

XSLT 处理器/库必须具有某种`evaluate`内置功能。请参阅库的文档。

# linux - 软件设备是隐藏您使用开源这一事实的一种方式吗？

> ID：776484
> 
> 赞同：0
> 
> 时间：2009-04-22T10:12:35.703
> 
> 标签：linux, web-applications, open-source

我察觉到一种趋势，即当您广泛使用开源时，您应该追求软件设备，因为它提供了一种方法，可以避免您的客户询问它是如何开发的。

如果客户看到你向他们收取了很多钱却使用了大量免费的开源代码，那么他们会想要进行更深入的谈判，而不是他们根本无法在盒子里达到顶峰。

还有其他人观察到同样的趋势吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-22T14:48:47.630

我似乎记得至少有一个案例，制造商使用经过*调整*的 OSS 作为其设备的基础。当它被发现并且他们被要求提供他们反对的源代码时。随后法院采取行动，最终达成和解。

大概他们想出售“增值”产品，而不必将好东西送给竞争对手。

::搜索网络::

不止一种情况：

*   [SFLC 代表 Busybox 开发者提起 GPL 诉讼](http://www.linux.com/feature/119355)
*   [Verizon 解决 BusyBox 诉讼](http://www.itbusinessedge.com/topics/reader.aspx?oss=40091)
*   [Xterasys 同意解决 BusyBox 诉讼](http://www.efluxmedia.com/news_Xterasys_Agrees_to_Settle_BusyBox_Suit_11933.html)

看起来busybox就是这样，还有一袋薯条……

无论如何，所有这一切都表明，任何想要尝试在软件设备中隐藏 OSS 使用的人可能要三思而后行。如果那些肮脏的嬉皮黑客类型可以将 Verizon 带到和解桌上，那么他们也可以将您带到和解桌上。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T10:17:37.220

我不明白...您的客户肯定不想为那些开源工具的商业替代品的许可证支付不必要的费用。您使用这些工具的简单事实使产品便宜得多。如果您使用商业工具，那将意味着更高的费用。就这么简单。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-22T10:20:33.390

您使用开源的事实可能是您服务的一个非常强大的卖点。

如果您使用免费软件并向您的客户收费，就好像您使用的是商业许可的工具一样，那么您就没有诚实地经营您的业务 IMO。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T15:01:37.163

许多基于 BSD 的专有系统在启动时会打印出大量的微观 BSD 许可条款。我从来没有听到任何人抱怨，或者因为这些而建议 Unix 应该更便宜。

我也从未见过你提到的趋势。（接下来是什么，因为您使用高级语言而支付更少？）让您的销售人员向他们推销该软件如何帮助他们。我看不出谈判会发生怎样的变化，除非他们愿意自己建造（并设计和支持）；您的软件仍然为他们提供了如此多的价值。

# c# - 使用 NAnt，如何在面向 .NET 2.0 运行时使用 C# 3.0 编译器？

> ID：776489
> 
> 赞同：1
> 
> 时间：2009-04-22T10:14:15.310
> 
> 标签：c#, .net, .net-2.0, c#-3.0, nant

我正在使用 NAnt 0.85 来构建一个遗留项目。脚本本身使用**`csc`任务**（不是`msbuild`任务）并且工作正常。

该项目正在迁移到 .NET 3.5。我们已经在使用 VS2008 和 C# 3.0，同时仍然针对 .NET 2.0 框架运行时。

现在，当我们想要升级我们的 NAnt 脚本，使用 csc 任务编译 C#3.0 代码时，就会出现问题。

通过修改 nant.exe.config 以添加 net-3.5 框架部分，我设法使用 NAnt 编译 C#3.0 代码，但我仍然无法确保生成的程序集将在 .NET 2.0 运行时执行.

**更多问题**：如果我使用 LinqBridge 在没有 System.Core 和 .NET 3.5 运行时的情况下利用 Linq，则 csc 任务失败并给我一条错误消息，表明所有与 linq 相关的调用都是不明确的。事实上，NAnt csc 任务似乎会自动引用`System.Core.dll`，这会导致与我有效添加到该部分的唯一引用发生冲突`<references>`，在 csc 任务下：`LinqBridge.dll`.

你现在如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T10:28:34.120

在 .NET 2.0 上执行主要只是确保不添加对任何 .NET 3.5 特定库的引用。在现有库的 .NET 2.0 SP1 中添加了新类型（例如`DateTimeOffset`），还有其他一些微妙之处，但这是另一回事。

我*怀疑*LinqBridge 问题是由于`csc`使用了默认响应文件。有可能指定

```
noconfig="true" 
```

会解决这个问题。该文档指出`noconfig`“指示编译器不要使用对程序集的隐式引用”，这听起来像你想要的。

# java - 监控 Java 的系统资源使用情况

> ID：776493
> 
> 赞同：5
> 
> 时间：2009-04-22T10:16:34.150
> 
> 标签：java, monitoring

我正在尝试准备一些有关在 Windows XP 机器上运行的 Java 应用程序的 CPU 和内存使用情况（随时间变化）的统计数据。

是否有（免费）工具可以让我获得这些统计数据？我查看的大多数工具都可以分析 CPU 和堆使用的现有代码 - 但不提供进程本身的视图（从系统的角度来看）。

我尝试使用[IBM Performance Analysis Tool for Java](http://www.alphaworks.ibm.com/tech/pat4j)，但这似乎没有提供确定进程消耗的内存量的直接指标（类似于 ProcessExplorer 工具）。

任何指针将不胜感激。

亲切的问候， 迪努克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T13:13:26.703

我强烈建议您研究[Hyperic](http://www.hyperic.com)或[zenos 之](http://www.zenoss.com)类的工具。这些工具可以通过多种方式监控 Java 应用程序；通过 JMX MBean 或 SNMP 安装在系统上的代理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T10:35:19.690

[Sigar](http://support.hyperic.com/display/SIGAR/Home)可能会提供您想要的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T10:18:39.650

您可以随时尝试与 windows 捆绑在一起的**perfmon工具。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T18:06:16.887

你真的想要“监控”还是“配置文件”？对于生活的监控方面，还有 Jopr ( [http://www.jboss.org/jopr/](http://www.jboss.org/jopr/) )。

一般来说，您应该考虑到测量间隔越短，您对目标资源的负载就越大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T11:02:02.387

如果您的操作系统是 windows XP 32 或 64 位，最好的选择是 JNI 包装器。

JNI 包装器和评估密钥可 [在此处](http://www.teamdev.com/jniwrapper/features/) 获得一个月/试用期。这很容易配置（可用文档），并且可以提供有关特定进程的所有信息（工作集、页面文件、内存详细信息、cpu 信息..等）。

Perfmon 适用于 Vista 操作系统。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T10:25:44.313

[试试Netbeans IDE](http://www.netbeans.org)包中包含的分析器。有关他们的分析器详细信息的更多信息，请参见他们的[分析器页面](http://profiler.netbeans.org/)。

# python - 简单的网络服务器或网络测试框架

> ID：776495
> 
> 赞同：2
> 
> 时间：2009-04-22T10:17:32.853
> 
> 标签：python, web-services, testing, web-applications

需要测试一个复杂的 web 应用程序，该应用程序与远程 3rd 方基于 cgi 的 web 服务进行交互。我计划在一个虚拟网络服务器中实现一些第 3 方服务，这样我就可以完全控制测试用例。寻找一个简单的 python http webserver 或框架来模拟第 3 方界面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T12:06:00.347

使用[cherrypy](http://cherrypy.org)，看看Hello World：

```
import cherrypy

class HelloWorld(object):
    def index(self):
        return "Hello World!"
    index.exposed = True

cherrypy.quickstart(HelloWorld()) 
```

运行这段代码，你就可以在`localhost`端口上准备好一个非常快的 Hello World 服务器了`8080`！！很容易吧？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T10:36:19.983

您可能对 WSGI 服务最满意，因为它最像 CGI。

看看[werkzeug](http://werkzeug.pocoo.org/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T10:50:53.413

看一下标准模块 wsgiref：

[https://docs.python.org/2.6/library/wsgiref.html](https://docs.python.org/2.6/library/wsgiref.html)

该页面的末尾是一个小示例。像这样的东西可能已经足以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T10:20:07.713

我会调查[Django](http://www.djangoproject.com/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-27T16:52:21.133

模拟（或存根，或任何术语）urllib 或您用于与远程 Web 服务通信的任何模块可能更简单？

即使是简单的覆盖`urllib.urlopen`也可能就足够了：

```
import urllib
from StringIO import StringIO

class mock_response(StringIO):
    def info(self):
        raise NotImplementedError("mocked urllib response has no info method")
    def getinfo():
        raise NotImplementedError("mocked urllib response has no getinfo method")

def urlopen(url):
    if url == "http://example.com/api/something":
        resp = mock_response("<xml></xml>")
        return resp
    else:
        urllib.urlopen(url)

is_unittest = True

if is_unittest:
    urllib.urlopen = urlopen

print urllib.urlopen("http://example.com/api/something").read() 
```

在获得 API 密钥之前，我在[这里](http://github.com/dbr/themoviedb/blob/cc6fbb3c67df9bcedc14e2bcdfc1e56c06da0c33/stub_urllib.py)使用了非常相似的东西来模拟一个简单的 API。

# asp.net - 在 asp.net 中使用 Masterpage 进行 jQuery 验证

> ID：776502
> 
> 赞同：1
> 
> 时间：2009-04-22T10:19:31.507
> 
> 标签：asp.net, jquery

我在母版页中有一个 childpage.aspx，我正在尝试通过母版页验证子页中的必填字段，我在母版页中编写了以下代码以进行验证

```
$(document).ready(function()
    {
                var container = $('#sam586'); 
                $("#aspnetForm").validate(
                 { 
                    errorContainer: container,
                    //errorClass: "invalid",  
                    errorLabelContainer: $("#sam586"),
                    wrapper: 'li',
                    meta: "validate",
                    rules:
                    {
                        ctl00_ContentPlaceHolder1_txtUserName:
                        {
                           required:true
                        },
                        ctl00_ContentPlaceHolder1_txtPassword:
                        {
                            required:true
                        },
                        ctl00_ContentPlaceHolder1_txtFirstName:
                        {
                            required:true
                        },
                        ctl00_ContentPlaceHolder1_txtLastName:
                        {
                            required:true
                        },
                        ctl00_ContentPlaceHolder1_ddlDepartment:
                        {
                            required:true
                        },
                        ctl00_ContentPlaceHolder1_ddlDesignation:
                        {
                            required:true
                        },
                        ctl00_ContentPlaceHolder1_txtEmail:
                        {
                            required:true,
                            email:true
                        },
                        ctl00_ContentPlaceHolder1_ddlStatus:
                        {
                            required:true
                        },
                        ctl00_ContentPlaceHolder1_ddlRole:
                        {
                            required:true
                        }
                    },
                    messages:
                    {
                        ctl00_ContentPlaceHolder1_txtUserName:"Please enter username",
                        ctl00_ContentPlaceHolder1_txtPassword:"Please enter password",
                        ctl00_ContentPlaceHolder1_txtFirstName:"please enter first name",
                        ctl00_ContentPlaceHolder1_txtLastName:"Please enter last name",
                        ctl00_ContentPlaceHolder1_ddlDepartment:"Select Department",
                        ctl00_ContentPlaceHolder1_ddlDesignation:"Select Designation",
                        ctl00_ContentPlaceHolder1_txtEmail:"Enter proper email address",
                        ctl00_ContentPlaceHolder1_ddlStatus:"Select Status",
                        ctl00_ContentPlaceHolder1_ddlRole:"Select Role"
                    }
                });
            }); 
```

什么时候在单个 aspx 页面中尝试所有这些东西，它工作得很好。

但问题是我想在 div 标签名称中显示验证错误：（“sam586”）稍后将在 jquery 的帮助下转换为 graypopup 。所以任何人都可以帮助我，或者任何建议都是可以理解的。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T13:40:15.127

目前尚不清楚，但我猜您在查找内容控件时遇到了麻烦。

如果 ID 为“sam586”的控件在内容页面中，则其 ID 名称将在结果页面中损坏，$(“#sam586”) 将找不到它，因为它的 id 将是“ctl##_... _sam586” 我相信你现在已经知道了。

我已经看到了一些处理这个问题的方法：

为“sam586”分配一个唯一的类，以便您可以使用类 $(“.samsclass”) 找到它

只需使用属性语法查找以“sam586”结尾的任何标签：$("input[id$='sam586']")。

在内容页面（以及您希望母版页代码工作的任何内容页面）的 aspx 中创建一个 javascript 变量。将 clientID 分配给变量。您的母版页代码现在可以使用该变量。

在 content.aspx 中：

```
 script type="text/javascript">

    var samsvar = '#<%= sam586.ClientID %>';

 /script> 
```

在母版页中

```
$(samsvar).text(); 
```

# c++ - C++ 中循环移位（旋转）操作的最佳实践

> ID：776508
> 
> 赞同：115
> 
> 时间：2009-04-22T10:20:46.853
> 
> 标签：c++, c, rotation, bit-manipulation, c++-faq

左移和右移运算符（<< 和 >>）在 C++ 中已经可用。但是，我不知道如何执行循环移位或旋转操作。

如何执行“向左旋转”和“向右旋转”等操作？

在这里向右旋转两次

```
Initial --> 1000 0011 0100 0010 
```

应该导致：

```
Final   --> 1010 0000 1101 0000 
```

一个例子会很有帮助。

（编者注：如果旋转计数为零，或者编译为不只是单个旋转机器指令，那么在 C 中表达旋转的许多常见方式都会遭受未定义的行为。这个问题的答案应该记录最佳实践。）

* * *

## 回答 #1

> 赞同：124
> 
> 时间：2009-04-22T10:28:05.637

[另请参阅另一个旋转问题的此答案](https://stackoverflow.com/a/31488147/224132)的早期版本，其中包含有关 asm gcc/clang 为 x86 生成的内容的更多详细信息。

在 C 和 C++ 中表达旋转以避免任何未定义行为的最编译器友好的方式似乎是[John Regehr 的 implementation](http://blog.regehr.org/archives/1063)。我已经将它调整为按类型的宽度旋转（使用固定宽度的类型，如`uint32_t`）。

```
#include <stdint.h>   // for uint32_t
#include <limits.h>   // for CHAR_BIT
// #define NDEBUG
#include <assert.h>

static inline uint32_t rotl32 (uint32_t n, unsigned int c)
{
  const unsigned int mask = (CHAR_BIT*sizeof(n) - 1);  // assumes width is a power of 2.

  // assert ( (c<=mask) &&"rotate by type width or more");
  c &= mask;
  return (n<<c) | (n>>( (-c)&mask ));
}

static inline uint32_t rotr32 (uint32_t n, unsigned int c)
{
  const unsigned int mask = (CHAR_BIT*sizeof(n) - 1);

  // assert ( (c<=mask) &&"rotate by type width or more");
  c &= mask;
  return (n>>c) | (n<<( (-c)&mask ));
} 
```

适用于任何无符号整数类型，而不仅仅是`uint32_t`，因此您可以制作其他大小的版本。

**另请参阅具有大量安全检查[的 C++11 模板版本](https://gist.github.com/pabigot/7550454)`static_assert`（包括类型宽度是 2 的幂）**，例如，在某些 24 位 DSP 或 36 位大型机上并非如此。

我建议仅将模板用作名称明确包含旋转宽度的包装器的后端。 **整数提升规则意味着`rotl_template(u16 & 0x11UL, 7)`将执行 32 位或 64 位循环，而不是 16 位**（取决于 的宽度`unsigned long`）。Even由 C++ 的整数`uint16_t & uint16_t`提升`signed int`规则提升，除非在`int`不大于`uint16_t`.

* * *

**在 x86 上**，此版本[内联到单个`rol r32, cl`](https://gcc.godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAMzwBtMA7AQwFtMQByARg9KtQYEAysib0QXACx8BBAKoBnTAAUAHpwAMvAFYTStJg1DIApACYAQuYukl9ZATwDKjdAGFUtAK4sGe1wAyeAyYAHI%2BAEaYxCAArFykAA6oCoRODB7evnrJqY4CQSHhLFEx8baY9vkMQgRMxASZPn4JdpgO6bX1BIVhkdFxrXUNTdlD3b3FpYMAlLaoXsTI7BzmAMzByN5YANQma24KBPiCAHQI%2B9gmGgCC61g0ITuhACLYFnIA4td3ZhsMWy8u32biYCiUDXOlx%2B60220wewOtDwLEICihayutx%2BAHo8fiCTtUIlHCwxDsCABPRII/jEHbEVB1AiYAC0aC8gh29VAuIAVDsvMECGszAB9Ag7BjcxI0%2BoKIkklFiU47HZ4U6YVUMcwANn2LzJCgA1vsLDs0CxEnRMAqiDsAF7RVDqhgKN0/HYCuk7FgkBGiJQK1BUBlMgDueHQBAQEopCEMO0jMe5DEpRJj0Qp1NpJClqr5OJhtzxguFuskceloi8QZ2wGQyApLqYDi8Ylo6cwqMliZur1d7tIOwiXklW0MwB26FQtoYYA4BFOuJxZcEFarSYQNrDBEj0djkrwCtFEQtTFrtvVjdT6AtBiMzalTMFSh2ACUAPIBYs3HECoVBAADk3MRwyYSkFRrOtE0wVQCGIJgdn7F4dioRkWHrRth2ITBgHqdB6HBIlQ0ZPcoxjUhPQFQw72gq8J0fe0GBfS9uQ/b9B2lQtfwJPidmURkInoFgFWTBBpzwKgqGiRhJTI/cYwlfl70nW9rybGd50XetGGiJgWXYr8Ai4rdGF3RSJOPHYgKJekuF1Kjbi9Bk8IIojg1DbS7RzVUsM02d0WonZVCA3UdgUbcqAIHEyIMhFgiOYgvA6AQxMICTbNonYHJHQhFX0hh0FZVInWCo46FoIkGE7X0wWNeMAwWLlxJ2DRVC4AAxHYIDWLg5mfSUuFiOydgAdmXZyeOxW4qRpB41xFcV5IjCjDzNX8FLWuMyKqiAtoPONVGHTlUmAEI72FKUZhhMarGci00slLAtjmzAIAYGY6pNRFUIgNwAAkbnfMULAASQAFT5UrMBDCBVC%2B1kcputZ7puNVS20WtJTY068HOzBLq5H1M0ezlJSNBrOQ8nZKQWBdcJ2OCaWIFE5OCKdWsta16HpKIEwANycRZfzVMEIUlD6QQNSm9jMfV5blsw4sMiJ0z9RmY0TN6kzW8wzBRtG1WlPUDW%2B01UYx1cmAF1Ao0FIrMFDfmbeF%2BlWted4vkm9HXIIRZpXh6WDk%2BvYxrcHrVGhTEIB61lPr1WWZkN26Xl/WFQw0H4DqUlaEJ6nPDxCk63Xxi7XUlBPsTuz1HrdZ72loN6Pq%2B2Wzf%2BoGQfBqGYbhhGdiR/qNoe8XoklnUDhl%2Bq5YV8L9ZVhE1d9f1421nNdYPfWU4ek35bNynh993D/eIQOo8xS5Q5McPI%2BDtxY4geObvlpPt7uMa0%2BxP5XCkzbVsOvOYo0D132v/XOIUvrXyNn7AOu5aDw2HGNN%2B19P53C/hsUMYAwAPGCITCAYogEPmAAQyBe9FYQBwRdfBYpQq6jFBuMUkDw7XwjpQvBBC8BrDCiQsObgWHTidrg9A%2BCACyQg3BigAGrYHfMnFcOwDAsnpIxKcM4ryCwRGKXarp1QEAVLQ4UrMGBQhmr8DBC0xRiIkdI98MI/hwiBAiEEhjggYixGYyoSg7H/EBMCA4BjBBGLcVbZ4L4sZHERG4FEqJAmuIuJiNCeZuY2mIMGTM9ItbSjwI2bxP8qB/3IgAuBNDuEuNLsgUBhTwHHQdmdcuV8a4PTxMfWBBDRx0EcAwMUeAmCii0SQbcCDxqGxCQ5VkER8oL2HJ8UIcgdh8Iei00%2BOx%2BkEHgTUhOlsdilgbMgYc2S9m%2BgUALZAfkwaCEqKyNh6A/JuCIdOQK2lJQaPjMefYnVa7NMwCfaUBDGS0GERskZ2zVy7P2Y2H2ITRBPLQsEO8hhKQxg5ok5RRD3mp1yUVX%2BpjSwAHU8DGjwPNHpC4FRSQgDMdkCB2gNSYOgJgJJCYou5MQCZCF6jpgXhvGM8j8WEuJUhS8d4TC6g0HjAmRNJQCzEF4TAIqNDDmykhGgqgmWWRIjsUUw5wzbmQBJcCwYIhCwWAoWqLFJTJAaEwYScrbjivLldSM/LCY9NWfAwucZpXeEwPsrkkUpIECYdAtUwCImOrWr9eZndQaQ2hngJ0cMvWyrfmqENT0K7m0jeqweh9U3qlDFAf10UZ773qpAtYacK1tRug9PNSzpRJrlajWuap609UbZEkEEUoqBt4e2mVTiL4JIgNm7tAa5HNurqg/kPx7VMvDc6/ATBVnEEqZZT1A7fWSiLb2qBLa65hpahGs2gNgYxp7vG2GVAICNpTam0NR4uRtyraOrgubU1SR6hAHdJaq2U3LZW1CGga2%2Bzrd82Bjb32tvA8sm9A7ERXASTuphEc4Pes7QcHqo7kPII/j8QsHA5i0E4LEXgfgOBaFIKgTgfDLDWAigsJYTi/g8FIAQTQhG5jGhAGsXUpwACcY0HL8YrGNITFY1jSGIxwSQZGONUc4LwBQIAFXsYo4R0gcBYBIGSbzcglBdMDGALqNYfAOnRGUxACI8mJnMGIJSTgrHLRsEEJ%2BGqDn1OkCwGSIw4hPP4Fwh0AWtp5NwXaGOFYrHhSVHk8iCIiF7MeCwPJhCKJHMaaoAYYAChJF4EwOGT8NJyOsf4IIEQYh2BSBkIIRQKh1Ced0AkIhKBrDWH0HgCIynIBzGJNUZTHBWSfjWAPI46ADSmDo5YLgXAB64o7Epyo7RqguCKqMFopBAi4KmAMBIuQ0gCDWzkFI%2B2GCTH6DEVoi3Uo1GGI0TwzQ9BtGu10BoZ2Sg7dsLdw74xXtbfOxIOYChGPLD0AhTAkWNPSdI6QcjlHqMcFoayCs/kdh8eG/9Vrlhhy4EIHmdYCR5moCtCkuWfUZi8DU1oZOpBuNrA0KcNYdP5aSC4fx%2BWsRYhjX0JwWTMP5Pw6UyptjHG5haagDARAKAic82iPpiAhmYgqMkBoBVNAm4WcoNZzztmOXpdIM5uSbnOzye85OPzlGAtLbwMF/rlGwvIAi3r6L0nKNxYS5SJLKxKOpZYOluYmWmDZdy/lwrjA9eleEKIcQVWI%2B1bUPJ3QZh9CTha5NmwcWusUqo0qNKnBBvDZKsccbmOLDTdm/NioVR0grfcPdsYG2ipvemLt471RvtJFb%2BkJvH2nvVBe3drI63e%2BdFu93i7n3ujt6OBMP772LuA%2BB5VtjuEIdEZI3Jzz8PEfI5UTsSQpx6caB6rRqwWOdg46IPSfHw4PDE95qTg2FORdzGpXSgYWfadmFOLqfjQENBrH4y4EZ05w0Gm25xk14F911C4FODMCAMkAQN/0Ew0CAiAL5030U1sCF0pw0zFwgB02lxSTlwVxQFoC4H43oWkDVyUUsy10ox13sz1wN1c3cxN27DNy914EtyCxC083t0d24F4Gd1iw63d09xS1Zl90EP9yyxyzywKyK3D1kHK2jyoNkDj3q0o10FM2awm1P3Tw60zx6xzzdDz0/FUAWyr2cAgFcHb02yKH%2BxbzyHSHbz22qDH0eyuz7y%2BzryHy8JHxnwcLn0ex8MHxCMCL6GCP6nmEWBBwSDB1X3AOh1h14C32R1EhOR2AFnINOC4CPwgFxTBlCGwC%2BgxzT2x3wEv1JwJ1vxlyvz%2BDWHJ2F3U2p1fywBiCz2k1519y4VODGjCg51iFAI0DMEAKAi5xSIUw4EF1U2fxpx4y/x/z/wAKALWBALAOkzWA3zh0wJwOp2kzMG2NSN2LmOC1SWr0kCAA)(or `rol r32, imm8`) 编译器，因为编译器知道[x86 旋转和移位指令](http://felixcloutier.com/x86/RCL:RCR:ROL:ROR.html)以与 C 源代码相同的方式屏蔽移位计数。

编译器支持 x86 上的这种避免 UB 的习惯用法，`uint32_t x`用于`unsigned int n`变量计数移位：

*   clang：从 clang3.5 开始识别为可变计数轮换，在此之前有多个班次+或 insns。
*   gcc：[从 gcc4.9 开始识别为变量计数旋转](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=57157)，在此之前有多个班次+或 insns。gcc5 及更高版本也优化了维基百科版本中的分支和掩码，仅使用变量计数的`ror`or`rol`指令。
*   icc：[从 ICC13 或更早版本开始支持可变计数轮换](https://software.intel.com/en-us/forums/intel-c-compilers-in-inde/topic/580884)。当 BMI2 不能用于保存 MOV时，常量计数会`shld edi,edi,7`比`rol edi,7`某些 CPU（尤其是 AMD，还有一些 Intel）更慢并占用更多字节。`rorx eax,edi,25`
*   MSVC：x86-64 CL19：仅识别为常量计数旋转。（维基百科成语被识别，但分支和 AND 没有被优化掉）。使用x86（包括 x86-64）上的`_rotl`/`_rotr`内在函数。`<intrin.h>`

**ARM 的 gcc 使用`and r1, r1, #31`for variable-count 旋转，但实际旋转仍然使用一条指令**: `ror r0, r0, r1`。所以 gcc 没有意识到旋转计数本质上是模块化的。正如 ARM 文档所说，[“具有移位长度的 ROR `n`，超过 32 与具有移位长度的 ROR 相同`n-32`”](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0552a/BABFFEJF.html)。我认为 gcc 在这里会感到困惑，因为 ARM 上的左/右移位会使计数饱和，因此移位 32 或更多将清除寄存器。（与 x86 不同，移位掩盖计数与旋转相同）。它可能决定在识别旋转习语之前需要一个 AND 指令，因为非循环移位如何在该目标上起作用。

当前的 x86 编译器仍然使用额外的指令来屏蔽 8 位和 16 位循环的变量计数，这可能与它们在 ARM 上不避免 AND 的原因相同。这是一个错过的优化，因为性能不依赖于任何 x86-64 CPU 上的旋转计数。（出于性能原因，286 引入了计数屏蔽，因为它迭代地处理移位，而不是像现代 CPU 那样具有恒定延迟。）

顺便说一句，对于变量计数旋转，更喜欢右旋转，以避免编译器`32-n`在仅提供右旋转的 ARM 和 MIPS 等架构上实现左旋转。（这优化了编译时常数计数。）

有趣的事实：ARM 并没有真正的专用移位/旋转指令，它只是 MOV ，[源操作数在 ROR 模式下通过桶形移位器](https://cseweb.ucsd.edu/classes/wi14/cse30-c/lectures/PI_WI_14_CSE30_lecture_8_post.pdf): `mov r0, r0, ror r1`。因此，旋转可以折叠成用于 EOR 指令或其他东西的寄存器源操作数。

* * *

**确保使用无符号类型`n`和返回值，否则它不会是 rotate**。（x86 目标的 gcc 进行算术右移，移入符号位的副本而不是零，当您`OR`将两个移位的值放在一起时会导致问题。负符号整数的右移是 C 中实现定义的行为。）

此外，**请确保移位计数是无符号类型**，因为`(-n)&31`有符号类型可能是一个补码或符号/大小，而不是与您使用无符号或二进制补码获得的模块化 2^n 不同。（参见 Regehr 博客文章的评论）。 `unsigned int`在我看过的每个编译器上都做得很好，对于`x`. 其他一些类型实际上破坏了一些编译器的习惯用法识别，所以不要只使用与`x`.

* * *

**一些编译器为 rotates 提供了内在函数，**如果可移植版本不能在您的目标编译器上生成好的代码，这比 inline-asm 好得多。我所知道的任何编译器都没有跨平台内在函数。这些是一些 x86 选项：

*   英特尔文档[`<immintrin.h>`提供`_rotl`和`_rotl64`内在函数](https://www.intel.com/content/www/us/en/docs/intrinsics-guide/index.html#techs=SSE,SSE2,SSE3,SSSE3,SSE4_1,SSE4_2,AVX,AVX2,FMA,Other&text=rotl)，右移也是如此。MSVC 需要`<intrin.h>`，而 gcc 需要`<x86intrin.h>`。An`#ifdef`负责处理 gcc 与 icc。Clang 9.0 也有它，但在此之前它似乎没有在任何地方提供它们，[除了在 MSVC 兼容模式下与`-fms-extensions -fms-compatibility -fms-compatibility-version=17.00`](http://lists.llvm.org/pipermail/cfe-commits/Week-of-Mon-20160905/170179.html). 它为他们发出的 asm 很糟糕（额外的掩蔽和 CMOV）。
*   MSVC：[`_rotr8`和`_rotr16`](https://msdn.microsoft.com/en-us/library/yy0728bz(v=vs.140).aspx)。
*   gcc 和 icc（不是 clang）： `<x86intrin.h>`还提供`__rolb`/`__rorb`用于 8 位左/右旋转，`__rolw`/ `__rorw`（16 位）， `__rold`/ `__rord`（32 位），`__rolq`/ `__rorq`（64 位，仅针对 64 位目标定义）。对于窄轮换，实现使用`__builtin_ia32_rolhi`or `...qi`，但 32 位和 64 位轮换是使用 shift/or 定义的（没有针对 UB 的保护，因为其中的代码[`ia32intrin.h`](https://github.com/gcc-mirror/gcc/blob/master/gcc/config/i386/ia32intrin.h#L146)只需要在 x86 的 gcc 上工作）。GNU C 似乎没有任何跨平台`__builtin_rotate`功能`__builtin_popcount`（即使它不是一条指令，它也可以扩展到目标平台上的最佳功能）。大多数时候，您可以从 idiom-recognition 中获得好的代码。

```
// For real use, probably use a rotate intrinsic for MSVC, or this idiom for other compilers.  This pattern of #ifdefs may be helpful
#if defined(__x86_64__) || defined(__i386__)

#ifdef _MSC_VER
#include <intrin.h>
#else
#include <x86intrin.h>  // Not just <immintrin.h> for compilers other than icc
#endif

uint32_t rotl32_x86_intrinsic(rotwidth_t x, unsigned n) {
  //return __builtin_ia32_rorhi(x, 7);  // 16-bit rotate, GNU C
  return _rotl(x, n);  // gcc, icc, msvc.  Intel-defined.
  //return __rold(x, n);  // gcc, icc.
  // can't find anything for clang
}
#endif 
```

据推测，一些非 x86 编译器也具有内在函数，但我们不要扩展这个社区 wiki 答案以包含它们全部。（也许在[关于内在函数的现有答案](https://stackoverflow.com/a/776573/224132)中这样做）。

* * *

（这个答案的旧版本建议特定于 MSVC 的内联 asm（仅适用于 32 位 x86 代码），或[http://www.devx.com/tips/Tip/14043](http://www.devx.com/tips/Tip/14043)用于 C 版本。评论正在回复.)

**内联汇编破坏了许多优化**，[尤其是 MSVC 风格，因为它强制存储/重新加载输入](https://stackoverflow.com/questions/3323445/what-is-the-difference-between-asm-and-asm/35959859#35959859)。精心编写的 GNU C inline-asm rotate 将允许计数成为编译时常量移位计数的直接操作数，但如果要移位的值也是编译时常量，它仍然无法完全优化内联后。 **[https://gcc.gnu.org/wiki/DontUseInlineAsm](https://gcc.gnu.org/wiki/DontUseInlineAsm)**。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-04-22T10:35:58.970

因为它是 C++，所以使用内联函数：

```
template <typename INT> 
INT rol(INT val) {
    return (val << 1) | (val >> (sizeof(INT)*CHAR_BIT-1));
} 
```

C++11 变体：

```
template <typename INT> 
constexpr INT rol(INT val) {
    static_assert(std::is_unsigned<INT>::value,
                  "Rotate Left only makes sense for unsigned types");
    return (val << 1) | (val >> (sizeof(INT)*CHAR_BIT-1));
} 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2019-07-31T07:56:25.260

**C++20`std::rotl`和`std::rotr`**

它已经到了！[http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0553r4.html](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0553r4.html)并应将其添加到`<bit>`标题中。

[cppreference 表示](https://en.cppreference.com/w/cpp/numeric/rotl)用法如下：

```
#include <bit>
#include <bitset>
#include <cstdint>
#include <iostream>

int main()
{
    std::uint8_t i = 0b00011101;
    std::cout << "i          = " << std::bitset<8>(i) << '\n';
    std::cout << "rotl(i,0)  = " << std::bitset<8>(std::rotl(i,0)) << '\n';
    std::cout << "rotl(i,1)  = " << std::bitset<8>(std::rotl(i,1)) << '\n';
    std::cout << "rotl(i,4)  = " << std::bitset<8>(std::rotl(i,4)) << '\n';
    std::cout << "rotl(i,9)  = " << std::bitset<8>(std::rotl(i,9)) << '\n';
    std::cout << "rotl(i,-1) = " << std::bitset<8>(std::rotl(i,-1)) << '\n';
} 
```

给出输出：

```
i          = 00011101
rotl(i,0)  = 00011101
rotl(i,1)  = 00111010
rotl(i,4)  = 11010001
rotl(i,9)  = 00111010
rotl(i,-1) = 10001110 
```

当支持到达 GCC 时，我会尝试一下，GCC 9.1.0`g++-9 -std=c++2a`仍然不支持它。

该提案说：

> 标题：
> 
> ```
> namespace std {
>   // 25.5.5, rotating   
>   template<class T>
>     [[nodiscard]] constexpr T rotl(T x, int s) noexcept;
>   template<class T>
>     [[nodiscard]] constexpr T rotr(T x, int s) noexcept; 
> ```

和：

> 25.5.5 旋转 [bitops.rot]
> 
> 在以下描述中，让 N 表示`std::numeric_limits<T>::digits`。
> 
> ```
> template<class T>
>   [[nodiscard]] constexpr T rotl(T x, int s) noexcept; 
> ```
> 
> 约束：T 是无符号整数类型（3.9.1 [basic.fundamental]）。
> 
> 令 r 为 s % N。
> 
> 返回： 如果 r 为 0，则 x；如果 r 为正，`(x << r) | (x >> (N - r))`; 如果 r 是负数，`rotr(x, -r)`.
> 
> ```
> template<class T>
>   [[nodiscard]] constexpr T rotr(T x, int s) noexcept; 
> ```
> 
> 约束：T 是无符号整数类型（3.9.1 [basic.fundamental]）。令 r 为 s % N。
> 
> 返回： 如果 r 为 0，则 x；如果 r 为正，`(x >> r) | (x << (N - r))`; 如果 r 是负数，`rotl(x, -r)`.

还添加了A`std::popcount`来计算 1 的位数：[如何计算 32 位整数中设置的位数？](https://stackoverflow.com/questions/109023/how-to-count-the-number-of-set-bits-in-a-32-bit-integer/57285674#57285674)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-04-22T10:42:58.360

大多数编译器都有内部函数。Visual Studio 例如[_rotr8、_rotr16](https://docs.microsoft.com/en-us/cpp/intrinsics/rotr8-rotr16?view=vs-2019)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-12-05T20:50:36.793

明确：

```
template<class T>
T ror(T x, unsigned int moves)
{
  return (x >> moves) | (x << sizeof(T)*8 - moves);
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2010-04-27T11:55:02.130

如果 x 是 8 位值，则可以使用：

```
x=(x>>1 | x<<7); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-22T11:01:21.717

像这样的东西，使用标准的位集...

```
#include <bitset> 
#include <iostream> 

template <std::size_t N> 
inline void 
rotate(std::bitset<N>& b, unsigned m) 
{ 
   b = b << m | b >> (N-m); 
} 

int main() 
{ 
   std::bitset<8> b(15); 
   std::cout << b << '\n'; 
   rotate(b, 2); 
   std::cout << b << '\n'; 

   return 0;
} 
```

高温下，

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-04-22T11:40:05.370

详细来说，您可以应用以下逻辑。

如果位模式是整数 33602

```
1000 0011 0100 0010

```

然后你需要用 2 个右移位翻转：首先复制位模式，然后左移它：长度 - RightShift 即长度为 16 右移值为 2 16 - 2 = 14

左移 14 次后，您得到。

```
1000 0000 0000 0000

```

现在将值 33602 右移 2 次。你得到

```
0010 0000 1101 0000

```

现在在 14 次左移值和 2 次右移值之间取 OR。

```
1000 0000 0000 0000
0010 0000 1101 0000
====================
1010 0000 1101 0000
====================

```

你得到你的转移翻转价值。请记住，按位操作更快，甚至不需要任何循环。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-22T10:36:29.063

假设您想按位右移`L`，并且输入`x`是一个带`N`位的数字：

```
unsigned ror(unsigned x, int L, int N) 
{
    unsigned lsbs = x & ((1 << L) - 1);
    return (x >> L) | (lsbs << (N-L));
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-05-30T15:20:05.670

正确答案如下：

```
#define BitsCount( val ) ( sizeof( val ) * CHAR_BIT )
#define Shift( val, steps ) ( steps % BitsCount( val ) )
#define ROL( val, steps ) ( ( val << Shift( val, steps ) ) | ( val >> ( BitsCount( val ) - Shift( val, steps ) ) ) )
#define ROR( val, steps ) ( ( val >> Shift( val, steps ) ) | ( val << ( BitsCount( val ) - Shift( val, steps ) ) ) ) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-10-31T05:24:14.910

源代码 x 位数

```
int x =8;
data =15; //input
unsigned char tmp;
for(int i =0;i<x;i++)
{
printf("Data & 1    %d\n",data&1);
printf("Data Shifted value %d\n",data>>1^(data&1)<<(x-1));
tmp = data>>1|(data&1)<<(x-1);
data = tmp;  
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-16T02:13:28.073

另一个建议

```
template<class T>
inline T rotl(T x, unsigned char moves){
    unsigned char temp;
    __asm{
        mov temp, CL
        mov CL, moves
        rol x, CL
        mov CL, temp
    };
    return x;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-06-13T09:23:37.783

下面是[Dídac Pérez 答案](https://stackoverflow.com/questions/776508/circular-shift-operations-in-c/13732181#13732181)的略微改进版本，实现了两个方向，以及使用 unsigned char 和 unsigned long long 值的这些函数用法的演示。几个注意事项：

1.  这些函数被内联用于编译器优化
2.  我使用了一个`cout << +value`技巧来简洁地输出我在这里找到的无符号字符：[https ://stackoverflow.com/a/28414758/1599699](https://stackoverflow.com/a/28414758/1599699)
3.  为了清晰和安全，我建议使用显式`<put the type here>`语法。
4.  我使用 unsigned char 作为 shiftNum 参数，因为我在[此处](https://msdn.microsoft.com/en-us/library/336xbhcz.aspx)的“附加详细信息”部分中找到了内容：

> *如果附加表达式*为负或*附加表达式*大于或等于（提升的）*移位表达式*中的位数，则移位运算的结果未定义。

这是我正在使用的代码：

```
#include <iostream>

using namespace std;

template <typename T>
inline T rotateAndCarryLeft(T rotateMe, unsigned char shiftNum)
{
    static const unsigned char TBitCount = sizeof(T) * 8U;

    return (rotateMe << shiftNum) | (rotateMe >> (TBitCount - shiftNum));
}

template <typename T>
inline T rotateAndCarryRight(T rotateMe, unsigned char shiftNum)
{
    static const unsigned char TBitCount = sizeof(T) * 8U;

    return (rotateMe >> shiftNum) | (rotateMe << (TBitCount - shiftNum));
}

void main()
{
    //00010100 == (unsigned char)20U
    //00000101 == (unsigned char)5U == rotateAndCarryLeft(20U, 6U)
    //01010000 == (unsigned char)80U == rotateAndCarryRight(20U, 6U)

    cout << "unsigned char " << 20U << " rotated left by 6 bits == " << +rotateAndCarryLeft<unsigned char>(20U, 6U) << "\n";
    cout << "unsigned char " << 20U << " rotated right by 6 bits == " << +rotateAndCarryRight<unsigned char>(20U, 6U) << "\n";

    cout << "\n";

    for (unsigned char shiftNum = 0U; shiftNum <= sizeof(unsigned char) * 8U; ++shiftNum)
    {
        cout << "unsigned char " << 21U << " rotated left by " << +shiftNum << " bit(s) == " << +rotateAndCarryLeft<unsigned char>(21U, shiftNum) << "\n";
    }

    cout << "\n";

    for (unsigned char shiftNum = 0U; shiftNum <= sizeof(unsigned char) * 8U; ++shiftNum)
    {
        cout << "unsigned char " << 21U << " rotated right by " << +shiftNum << " bit(s) == " << +rotateAndCarryRight<unsigned char>(21U, shiftNum) << "\n";
    }

    cout << "\n";

    for (unsigned char shiftNum = 0U; shiftNum <= sizeof(unsigned long long) * 8U; ++shiftNum)
    {
        cout << "unsigned long long " << 3457347ULL << " rotated left by " << +shiftNum << " bit(s) == " << rotateAndCarryLeft<unsigned long long>(3457347ULL, shiftNum) << "\n";
    }

    cout << "\n";

    for (unsigned char shiftNum = 0U; shiftNum <= sizeof(unsigned long long) * 8U; ++shiftNum)
    {
        cout << "unsigned long long " << 3457347ULL << " rotated right by " << +shiftNum << " bit(s) == " << rotateAndCarryRight<unsigned long long>(3457347ULL, shiftNum) << "\n";
    }

    cout << "\n\n";
    system("pause");
} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-04-22T10:26:11.693

```
#define ROTATE_RIGHT(x) ( (x>>1) | (x&1?0x8000:0) ) 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-04-22T10:38:09.713

重载一个函数：

```
unsigned int rotate_right(unsigned int x)
{
 return (x>>1 | (x&1?0x80000000:0))
}

unsigned short rotate_right(unsigned short x) { /* etc. */ } 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2015-08-14T21:12:11.750

```
--- Substituting RLC in 8051 C for speed --- Rotate left carry
Here is an example using RLC to update a serial 8 bit DAC msb first:
                               (r=DACVAL, P1.4= SDO, P1.5= SCLK)
MOV     A, r
?1:
MOV     B, #8
RLC     A
MOV     P1.4, C
CLR     P1.5
SETB    P1.5
DJNZ    B, ?1

Here is the code in 8051 C at its fastest:
sbit ACC_7  = ACC ^ 7 ; //define this at the top to access bit 7 of ACC
ACC     =   r;
B       =   8;  
do  {
P1_4    =   ACC_7;  // this assembles into mov c, acc.7  mov P1.4, c 
ACC     <<= 1;
P1_5    =   0;
P1_5    =   1;
B       --  ; 
    } while ( B!=0 );
The keil compiler will use DJNZ when a loop is written this way.
I am cheating here by using registers ACC and B in c code.
If you cannot cheat then substitute with:
P1_4    =   ( r & 128 ) ? 1 : 0 ;
r     <<=   1;
This only takes a few extra instructions.
Also, changing B for a local var char n is the same.
Keil does rotate ACC left by ADD A, ACC which is the same as multiply 2.
It only takes one extra opcode i think.
Keeping code entirely in C keeps things simpler sometimes. 
```

# c++ - 使用 C++ 实现 Soundex 算法

> ID：776510
> 
> 赞同：3
> 
> 时间：2009-04-22T10:21:13.373
> 
> 标签：c++, soundex, algorithm

简而言之，Soundex 算法将一系列字符转换为代码。产生相同 Soundex 代码的字符被称为听起来相同。

*   代码为 4 个字符宽
*   代码的第一个字符始终是单词的第一个字符

字母表中的每个字符都属于一个特定的组（至少在本例中，此后的代码是我将坚持的规则）：

*   b, p, v, f = 1
*   c、g、j、k、q、s、x、z = 2
*   d, t = 3
*   l = 4
*   米，n = 5
*   r = 6
*   字母表中的每个其他字母都属于第 0 组。

其他值得注意的规则包括：

*   属于组 0 的所有字母都将被忽略，除非您提供的单词中的字母已用完，在这种情况下，其余代码将用 0 填充。
*   同一数字不能连续使用两次或多次，因此该字符被忽略。唯一的例外是上面带有多个 0 的规则。

例如，单词“Ray”将产生以下 Soundex 代码：R000（R 是所提供单词的第一个字符，a 是第 0 组的一部分，所以它被忽略，y 是第 0 组的一部分，所以它被忽略，没有更多字符，因此代码中剩余的 3 个字符为 0）。

我创建了一个已传递给它的函数 1）一个 128 个字符的数组，用于创建 Soundex 代码和 2）一个空的 5 个字符数组，用于在函数完成时存储 Soundex 代码（和就像大多数数组在我的程序中使用一样，通过引用传回）。

但是，我的问题是转换过程。我上面提供的逻辑在我的代码中并不完全有效。同时我不知道为什么。

```
// CREATE A SOUNDEX CODE
// * Parameter list includes the string of characters that are to be converted to code and a variable to save the code respectively.
void SoundsAlike(const char input[], char scode[])
{
    scode[0] = toupper(input[0]); // First character of the string is added to the code

    int matchCount = 1;
    int codeCount = 1;
    while((matchCount < strlen(input)) && (codeCount < 4))
    {
        if(((input[matchCount] == 'b') || (input[matchCount] == 'p') || (input[matchCount] == 'v') || (input[matchCount] == 'f')) && (scode[codeCount-1] != 1))
        {
            scode[codeCount] = 1;
            codeCount++;
        }
        else if(((input[matchCount] == 'c') || (input[matchCount] == 'g') || (input[matchCount] == 'j') || (input[matchCount] == 'k') || (input[matchCount] == 'q') || (input[matchCount] == 's') || (input[matchCount] == 'x') || (input[matchCount] == 'z')) && (scode[codeCount-1] != 2))
        {
            scode[codeCount] = 2;
            codeCount++;
        }
        else if(((input[matchCount] == 'd') || (input[matchCount] == 't')) && (scode[codeCount-1] != 3))
        {
            scode[codeCount] = 3;
            codeCount++;
        }
        else if((input[matchCount] == 'l') && (scode[codeCount-1] != 4))
        {
            scode[codeCount] = 4;
            codeCount++;
        }
        else if(((input[matchCount] == 'm') || (input[matchCount] == 'n')) && (scode[codeCount-1] != 5))
        {
            scode[codeCount] = 5;
            codeCount++;
        }
        else if((input[matchCount] == 'r') && (scode[codeCount-1] != 6))
        {
            scode[codeCount] = 6;
            codeCount++;
        }
        matchCount++;
    }

    while(codeCount < 4)
    {
        scode[codeCount] = 0;
        codeCount++;
    }
    scode[4] = '\0';

    cout << scode << endl;
} 
```

我不确定这是否是因为我过度使用了 strlen，但由于某种原因，当程序在第一个 while 循环中运行时，实际上没有任何字符被转换为代码（即实际上没有运行任何 if 语句）。

那么我做错了什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T12:05:30.377

代替

```
scode[codeCount] = 1; 
```

你应该写

```
scode[codeCount] = '1'; 
```

当你形成一个char数组时，前者实际上是第一个ascii字符，而后者是字符'1'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T10:24:26.113

C++ 不支持您似乎正在尝试使用的动态数组。您需要调查 std::string 类的使用。我本质上你的循环变成了这样：

```
void Soundex( const string & input, string & output ) {
   for ( int i = 0; i < input.length(); i++ ) {
       char c = input[i];        // get character from input
       if ( c === .... ) {       // if some decision
            output += 'X';       // add some character to output
       }
       else if ( ..... )  {       // more tests
       }
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T10:41:35.680

您正在调用 strlen() 而没有在字符串中添加任何空字符终止符。所以 strlen() 的返回值可以是任何东西。您*可以*通过在开始之前用 '\0' 填充“scode”来解决此问题，尽管最好有一个单独的计数器并在完成后添加 '\0'。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T10:42:45.693

这实际上是 C 实现而不是 C++。无论如何，你确定你的字符串是空终止的吗？否则 strlen 将不起作用。

这些建议将使您的代码更易于阅读和调试：

*   在开始之前将您的输入转换为小写。测试非法字符。
*   定义一个变量，将其设置为 input[matchCount] 并使用它。它将使代码更具可读性。
*   我建议用 switch-case 替换 if-else 语句。
*   适应默认情况（不调用 if-else 或 case 语句）

# c - 理解 C 中包含“++”和“->”运算符的表达式的评估

> ID：776512
> 
> 赞同：2
> 
> 时间：2009-04-22T10:21:48.943
> 
> 标签：c, operators, operator-precedence

考虑这个例子：

```
struct {
    int num;
} s, *ps;

s.num = 0;
ps = &s;
++ps->num;

printf("%d", s.num); /* Prints 1 */ 
```

它打印`1`。
所以我理解这是因为根据运算符优先级，`->`高于`++`，所以`ps->num`首先获取值（即 0）然后`++`运算符对其进行操作，因此将其递增为 1。

```
struct {
    int num;
} s, *ps;

s.num = 0;
ps = &s;
ps++->num;

printf("%d", s.num); /* Prints 0 */ 
```

在这个例子中，我得到`0`了，但我不明白为什么；第一个例子的解释应该和这个例子一样。但*似乎*这个表达式的计算方式如下：
首先，运算符`++`进行操作，然后对 进行操作`ps`，因此将其递增到下一个`struct`。只有 then`->`操作并且它什么都不做，因为它只是获取`num`下一个字段`struct`并且什么都不做。
但这与运算符的优先级相矛盾，运算符的`->`优先级高于`++`.

有人可以解释这种行为吗？

**编辑**：
在阅读了两个引用 C++ 优先级表的答案后，表明前缀`++`/`--`运算符的优先级低于`->`，我进行了一些谷歌搜索并提出了这个[链接](http://www.cs50.net/resources/cppreference.com/operator_precedence.html)，指出该规则也适用于 C 本身。它完全符合并完全解释了这种行为，但我必须补充一点，此链接中的表格与我自己的 K&R ANSI C 副本中的表格相矛盾。因此，如果您对哪个来源是正确的有建议，我想知道。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T10:29:28.330

后自增 ( `ps++`) 和前自增 ( `++ps`) 在 C 中具有不同的关联性。前者从左到右关联，而后者从右到左关联。查看[此](http://www.cppreference.com/wiki/operator_precedence)页面（尽管这是针对 C++ 的，因此优先级可能会产生误导）。

在上一个示例中，您将指针更改为`&s`. 您没有更改指针的值。如果需要递增`num`，则需要绑定`++`到`num`。

**详细解释：**

```
 ps++->num; 
```

一个（假设的）编译器在看到这个表达式时，可能会将`ps`对象推入堆栈，然后是`++`运算符、`->`运算符，最后是对象 -- `num`。在评估时，编译器应该从哪里开始？它着眼于可用的运算符 ie`++`和`->`. 它选择`ps++`还是`ps`？这里的优先级规则：由于`->`具有比 更高的优先级`++`，因此需要`->`将 with`num`作为一个操作数和`ps`另一个操作数进行处理。因此，正如您正确观察到的那样，表达式的值变为`ps->num`0。`ps`评估后会发生什么？还记得，堆栈上还剩下另一个运算符吗？因此，编译器将此应用于`ps`现在它指向过去的一个元素`&s`。

**脚注：**

ANSI/ISO C 标准不使用运算符优先语法。相反，它使用所谓的全因式语法。这通常涉及一个严格的语法定义，其中点缀着许多非终结符，如“primary-expression”和“shift-expression”等。这很难理解，但对于语言设计者或编译器供应商来说更容易理解。此外，这样的语法能够轻松地对优先级进行编码。但是，任何全因式语法都与运算符优先语法兼容，这是大多数书籍（和网站）所做的（有时也会搞砸）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T10:30:41.883

即使 ++ 具有更高的优先级，这也不会改变值 -> 操作，因为它是一个后增量。请参阅此代码，该代码也具有此行为的另一个示例：

```
int b = 5;
int a = b++ * 3;
b = 5;
int c = (b++) * 3;

printf("%i, %i, %i\n", a, b, c); // Prints 15, 6, 15

struct {
  int num;
} s, *ps;

s.num = 35;
ps = &s;
printf("%p\n", ps); // Prints the pointer
printf("%i\n", ps++->num); // Prints 35
printf("%p\n", ps); // Prints the increased pointer

printf("%d\n", s.num); /* Prints 35 */ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-22T10:39:51.487

b = ++a; 相当于：

```
a += 1;
b = a; 
```

b = a++; 相当于：

```
b = a;
a += 1; 
```

所以很清楚为什么你没有得到你想要的结果。你描述的东西相当于（++ps）->num。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T10:31:45.097

“优先级”基本上是一个派生属性；它遵循解析规则。++ps->num 被解析为 ++(ps->num) /* () 为澄清解析规则而添加 */ 而 ps++->num 只能被解析为 (ps++)->num。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T10:31:52.630

我想这是因为它们具有不同的优先级，并且在同一组中，它们具有特定的关联性（例如评估顺序）

[在这里](http://www.difranco.net/compsci/C_Operator_Precedence_Table.htm)检查。后缀运算符与指针解析具有相同的优先级，但前缀运算符的优先级较低。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T10:35:57.177

ps++->num 将指针 ps 加 1，然后读取其中的数据。由于 ps 就在堆栈上的 s 之后，我相信指针很可能会指向它自己，尽管我不确定，也不重要。基本上最初的程序是在做 ++(ps->num) 但没有括号。要实现相同的目的，但在访问数据之后，您必须执行 (ps->num)++，或者不使用括号：ps->num++。

而且由于 ps 只是一个指针，即使您更改了它的值， s 仍然保持不变。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T10:29:23.557

[在这里](http://www.cplusplus.com/doc/tutorial/operators/)可以看到++作为前缀的优先级低于->，但是作为后缀它的优先级与->相同，并且是从左到右求值的，所以先做ps++再做->。

编辑：这是针对 C++，而不是 C。所以我的回答不正确。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-01T20:06:28.873

Precedence is used to resolve ambiguous parsing. `++ps->num` could be parsed as `((++ps)->num)` or `(++(ps->num))`; the relative precedence of `++()` and `->` determines that the latter is the correct parsing.

For `ps++->num`, there is only one valid parsing: `((ps++)->num)`, so the precedence of the operators doesn't matter.

# sql-server - SQLServer 2005 将所有 INDEX 生成为 CREATE 语句？

> ID：776527
> 
> 赞同：0
> 
> 时间：2009-04-22T10:28:38.443
> 
> 标签：sql-server, sql-server-2005, indexing, scriptgenerate

我有两个具有相同结构的数据库，但其中一个缺少索引（我想我错过了），我的意思是该表还没有任何索引。

我计划为具有索引但在 Management Studio 中找不到任何可用方法的数据库生成 CREATE INDEX，是的，我们可以为表、视图等生成脚本，但我只需要编写 INDEXES 脚本而不是其他任何东西。

我知道如果我们使用 IF EXIST 生成脚本可以是解决方案，所以如果对象已经存在它不会重新创建，但再次为简单起见，我只想编写 INDEXES 脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T10:32:36.497

尝试这个：

![替代文字](https://4.bp.blogspot.com/_DG_jH7RGwFU/SbDXNsnDZhI/AAAAAAAAAsE/A0DUWQVyGLo/s320/Generate+Script+-+SQL+Server.png)

或者只需右键单击 Management Studio 中的索引并选择“脚本索引为 - 创建至 -”，然后根据需要选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T10:46:43.267

不仅仅针对您对索引的需求，而是使多个数据库在结构上保持同步的好方法是使用诸如 Redgate 的 SQL 比较或 AdeptSQL Diff 或类似工具之类的工具。这些将向您展示 2 个数据库之间的差异，并生成甚至运行所需的脚本以使它们同步。比尝试手动执行此操作要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-09T15:47:25.440

查看[http://samsudeenb.blogspot.com/2007/11/scripts-to-drop-and-recreate-indexes-in.html](http://samsudeenb.blogspot.com/2007/11/scripts-to-drop-and-recreate-indexes-in.html) - 我认为这就是您要寻找的。

或者 - 正如另一个答案所暗示的那样 - 您可能想要投资像 Redgate 这样的工具。

# .net - 如何在 WCF OperationContract 参数中生成 xs:Date

> ID：776534
> 
> 赞同：16
> 
> 时间：2009-04-22T10:30:11.777
> 
> 标签：.net, xml, wcf

对于仅表示日期的 OperationContract 参数（无时间组件或时区指示符），最好使用 xs:Date，以避免客户端和服务器之间的时区转换出现任何歧义或问题。

WCF 当前仅支持 xs:DateTime 用于序列化 DateTime 参数。

使用将被序列化为 xs:Date 的参数生成 OperationContract 的最简单方法是什么？

我正在考虑有一个自定义的.NET 类型“public struct DateOnly”或类似的，隐式转换到/来自标准 DateTime，它将以某种方式自动生成 wsdl 作为 xs:Date。

这可能吗，我将如何实施它？

如果可能的话，我怀疑该解决方案可能涉及在自定义类型上使用 XmlSchemaProviderAttribute，但是我在此属性上找到的任何文档似乎都有些不透明。

**更新**

我很难相信它会增加获得解决方案的可能性，但我会遵循该网站的建议并开始赏金。

为了清楚起见，赏金的条件是提供构造解决方案所需的所有信息，以便 WCF OperationContract 的参数可以是：

*   序列化为 ws:Date 并在生成的 WSDL 中如此描述。

*   可以是 System.DateTime 值，也可以隐式转换为/从 DateTime 转换。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-27T15:56:21.073

既然这引起了我的注意，我在 Connect 中创建了一个新建议，在[Please Fully Support xs:Date for Date-Only Parameters 和 DataMembers](https://connect.microsoft.com/wcf/feedback/ViewFeedback.aspx?FeedbackID=470869)中。我给它打了四颗星（重要）。

如果阅读本文的人认为这很重要（或不同意），请使用 Connect 对其进行投票或评论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-21T19:03:23.720

I've also got described issue. I've developed my own solution - WcfDate custom type. It is published here: [WCF Support for xs:date](http://www.codeproject.com/KB/WCF/WcfDate.aspx "WCF Support for xs:date")

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-28T10:16:23.637

您指定了将 xs:Date 作为操作中的参数的要求。问题是，有一种正式的方式来指定这些需求：WSDL。如果我这样做，我会使用*WSDL First*方法。从定义所需合同的 WSDL 开始，包括接口中的 xs:date，无论您想要它在哪里。然后使用 svcutil.exe 生成服务存根。记得传入 /serializer:xmlSerializer 。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-27T15:03:48.930

WCF 的默认序列化程序 (DataContractSerializer) 不支持它。但是 XmlSerializer 支持它。

1 - 将 [XmlSerializerFormat] 属性添加到您的合同...

```
[XmlSerializerFormat]
[ServiceContract]
public interface IMyContract
{
   MyType GetData();
} 
```

2 - 在 DataContract 类型中，将 [XmlElement(DataType = "date")] 添加到成员。

```
public class MyType
{
     [XmlElement(DataType = "date")]
     public DateTime BirthDate {get; set;}
} 
```

希望这可以帮助

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T14:21:06.650

不幸的是，WCF 不支持 xs:Date 类型。您必须创建自己的“DateOnly”结构，例如：

```
<DataContract()> _
public struct DateOnly
   <DataMember()> public Month as Integer
   <DataMember()> public Day as Integer
   <DataMember()> public Year as Integer
end struct 
```

# regex - 如何在 Perl 标量中只保留前五行？

> ID：776536
> 
> 赞同：4
> 
> 时间：2009-04-22T10:31:23.973
> 
> 标签：regex, perl, lines, scalar

从任何一种标量，我可以使用什么正则表达式来匹配它的前五行并丢弃其余的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-22T11:15:25.600

奇怪的请求，但这应该这样做：

```
#!/usr/bin/perl

use strict;
use warnings;

my $s = join '', map { "$_\n" } 1 .. 9;

my ($first) = $s =~ /^((?:.*\n){0,5})/;
my ($last) = $s =~ /((?:.*\n){0,5})$/;

print "first:\n${first}last:\n$last"; 
```

一个更常见的解决方案是这样的：

```
#!/usr/bn/perl

use strict;
use warnings;

#fake a file for the example    
my $s = join '', map { "$_\n" } 1 .. 9;    
open my $fh, "<", \$s
    or die "could not open in memory file: $!";

my @first;
while (my $line = <$fh>) {
    push @first, $line;
    last if $. == 5;
}

#rewind the file just in case the file has fewer than 10 lines
seek $fh, 0, 0;

my @last;
while (my $line = <$fh>) {
    push @last, $line;
    #remove the earliest line if we have to many
    shift @last if @last == 6;
}

print "first:\n", @first, "last:\n", @last; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T10:33:52.313

你为什么不直接使用`head`它？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-22T19:03:10.700

你不需要正则表达式。只需在对标量的引用上打开一个文件句柄，然后对任何其他类型的文件句柄执行相同的操作：

```
my $scalar = ...;

open my($fh), "<", \ $scalar or die "Could not open filehandle: $!";
foreach ( 1 .. 5 )
    {
    push @lines, scalar <$fh>;
    }
close $fh;

$scalar = join '', @lines; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T12:09:10.883

```
my ($first_five) = $s =~ /\A((?:.*\n){5})/;
my ($last_five) = $s =~ /((?:.*\n){5})\z/; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T12:16:24.970

正如布赖恩所说，你可以使用`head`or`tail`很容易地解决任何一个问题（前 5 行或后 5 行）。

但现在我想知道我是否正确理解了你的问题。当您说“对于任何类型的标量”时，您的意思是（无论出于何种原因）文件已经是标量吗？

如果不是，我认为最好的解决方案是根本没有正则表达式。使用[`$.`](http://perldoc.perl.org/perlvar.html#$INPUT_LINE_NUMBER)并正常或向后读取文件。要向后阅读，您可以尝试[`File::ReadBackwards`](http://search.cpan.org/~uri/File-ReadBackwards-1.04/ReadBackwards.pm)或[`File::Bidirectional`](http://search.cpan.org/~kianwin/File-Bidirectional-0.01/lib/File/Bidirectional.pm)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T14:15:33.670

人们缺少一些关键标志：

```
/(?m)((?:^.*\n?){1,5})/ 
```

如果没有多行标志，它只会查看第一行。同样通过使选项成为`\n`可选，我们可以取前五行，而不管第五*行*末尾的换行符。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T02:54:03.813

为什么不只使用带限制的拆分，它就是为此目的而设计的：

```
my @lines = (split /\n/, $scalar, 6)[0..4]; 
```

如果您希望将其作为具有五行的单个标量返回，请将其连接起来：

```
my $scalar = join('\n', @lines) . "\n"; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-03-14T12:15:07.100

```
use strict;

my $line; #Store line currently being read
my $count=$ARGV[1]; # How many lines to read as passed from command line
my @last; #Array to store last count lines
my $index; #Index of the line being stored

#Open the file to read as supplied from command line
open (FILE,$ARGV[0]);
while ($line=<FILE>)
{
    $index=$.%$count;  # would help me in filter just $count records of the file
    $last[$index]=$line; #store this value
}
close (FILE);

#Output the stored lines
for (my $i=$index+1;$i<$count;$i++)
{
    print ("$last[$i]");
}
for (my $i=$0;$i<=$index;$i++)
{
    print ("$last[$i]");
} 
```

# c# - 如何在 C# codeDom 中为 System.DateTime 使用 CodeObjectCreateExpression

> ID：776545
> 
> 赞同：0
> 
> 时间：2009-04-22T10:33:53.623
> 
> 标签：c#

这里我的方法'BOOL（）'返回一个布尔值。现在我需要做类似的事情来返回一个 DateTime 值。我用的时候，

```
new CodePrimitiveExpression(DATETIME()); 
```

其中 'DATETIME()' 返回一个 DateTime 值。但是当我尝试 CodePrimitiveExpression 时出现以下异常，

```
Invalid Primitive Type: System.DateTime. Consider using CodeObjectCreateExpression. 
```

**那么如何使用 CodeObjectExpression 来获取 DateTime 值。？**

这是附加的代码片段。

```
if (p.ParameterType == typeof(System.Boolean))
                return new CodeVariableDeclarationStatement(p.ParameterType, options.sVariableNamePrix + p.Name,
                    new CodePrimitiveExpression(BOOL()));
else if (p.ParameterType == typeof(System.DateTime))
                return new CodeVariableDeclarationStatement(p.ParameterType, options.sVariableNamePrix + p.Name,
                   // new CodeObjectCreateExpression(DATETIME())); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T12:17:29.787

您需要指定对象的类型（`DateTime`在这种情况下）和要传递给其构造函数的参数。

如果您希望生成的声明使用从您的`DATETIME()`方法返回的值，那么使用`DateTime(long ticks, DateTimeKind kind)`构造函数可能是最简单的。

```
// ...
else if (p.ParameterType == typeof(System.DateTime))
{
    DateTime dt = DATETIME();

    var ticks = new CodePrimitiveExpression(dt.Ticks);
    var kind = new CodeFieldReferenceExpression
        (
            new CodeTypeReferenceExpression("System.DateTimeKind"),
            dt.Kind.ToString()
        );

    return new CodeVariableDeclarationStatement
        (
            p.ParameterType,
            options.sVariableNamePrix + p.Name,
            new CodeObjectCreateExpression("System.DateTime", ticks, kind)
        );
} 
```

**编辑以回应评论...**

如果您希望生成的声明使用从您的`DATETIME()`方法返回的值，那么该值需要以`DateTime`某种方式传递给对象的构造函数。

我选择[`DateTime(long ticks, DateTimeKind kind)`构造函数](http://msdn.microsoft.com/en-us/library/w0d47c9c.aspx)是因为它是最简单的构造函数，可以让您准确地表示该值。（使用[任何其他构造函数](http://msdn.microsoft.com/en-us/library/system.datetime.datetime.aspx)都会使示例更复杂或更不准确。）

使用[`Ticks`](http://msdn.microsoft.com/en-us/library/system.datetime.ticks.aspx)and[`DateTimeKind`](http://msdn.microsoft.com/en-us/library/system.datetime.kind.aspx)只是表示相同的不同方式`DateTime`：

```
DateTime dt1 =
    new DateTime(630822816000000000, System.DateTimeKind.Unspecified);

DateTime dt2 = DateTime.Parse("1/1/2000 12:00:00 AM");

Console.WriteLine(dt1);           // displays "01/01/2000 00:00:00"
Console.WriteLine(dt2);           // displays "01/01/2000 00:00:00"
Console.WriteLine(dt1 == dt2);    // displays "True" 
```

# sql-server - SSIS不匹配加入

> ID：776554
> 
> 赞同：0
> 
> 时间：2009-04-22T10:36:28.360
> 
> 标签：sql-server, join, ssis, delete-row

我有两组数据需要加入，但是由于数据质量不是很好，所以还有一个额外的问题。

这两个数据集是 Calls（电话呼叫）和 Communications（关于电话呼叫创建的记录）。它们的 ID 分别称为 call_id 和 comm_id。通信记录也有 call_ids 来执行连接。问题是数据收集系统一开始就无法正常工作，而且我有大量的通信无法匹配到特定的呼叫。并非所有呼叫都会产生通信。

对于每一天，我都需要创建一个加入列表来执行一些分析。问题是由于缺少一些链接，我得到了 3 种不同的行类型：

*   只是打电话，
*   只是通讯，
*   链接通讯和通话。

我想要做的是对于给定日期的“Just Comm”行的每一行，我应该删除同一日期的“Just Call”行。我不需要通话中的任何值，我只需要知道通话发生了。如果我这样做，我将得到正确的行数，因为所有“just comms”都将删除一个“just call”行，据我所知，这是创建 comm 的调用。

我的问题是如何在 SSIS 中做到这一点。我已经到了拥有我的数据集的地步，其中包含我需要的所有数据，并且是我上面提到的 3 种行类型的混合。您如何建议我完成删除“Just Call”行的过程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T10:51:39.587

不确定 SSIS，但我可以给你一些 SQL 开始。

似乎您对呼叫并不太感兴趣，因为如果数据与通信不匹配，您愿意忽略数据。

对我来说，这听起来像是典型的 LEFT JOIN 情况：

```
SELECT
  call.call_id,
  call.some_data,
  comm.comm._id
  comm.some_data,
FROM
  Communications comm
  LEFT JOIN Calls call ON call.call_id = comm.call_id
WHERE
  <date filter: today> 
```

这将为您提供今天的所有通信，仅与那些正确链接的呼叫配对。今天的所有其他调用都不会出现在结果集中。

* * *

编辑：

从 OP 的评论到另一个答案：

> 我想获取所有无与伦比的通话和通讯记录。从通话记录开始，然后将它们与同一天的任何通信记录匹配到列表中。每个通讯记录只能使用一次。如果通话记录找不到具有匹配日期的未使用通讯，则它应保持为空...

我看到这种方法的一个关键问题：

哪些“通话”记录应该在程序结束后保留​​？TOP 17（其中 17 是今天的“通话/通讯”不匹配计数）？剩下什么？最近的电话？

在结果集中留下 17 条随机通话记录可能有什么价值？它们不携带任何有用的信息。它们并不比你划掉的那些好。您是否要在某处展示它们：为什么？

我会使用 LEFT JOIN 并简单地收集其余部分的计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:26:11.407

我不确定我是否完全理解您的问题，但也许您可以尝试使用 FULL OUTER JOIN：

```
SELECT
  CL.ID AS CALL_ID,
  CL.DATE AS CALL_DATE,
  CM.ID AS COMM_ID,
  CM.DATE AS COMM_DATE
FROM
  CALLS CL
  FULL JOIN
  COMMUNICATIONS CM ON
    (CM.CALL_ID = CALL.ID)
WHERE
  (CL.ID IS NULL) OR
  (CM.ID IS NULL) 
```

这将返回包含 NULL 呼叫 ID 或通信 ID 的所有行（即具有“断开链接”的行）。

然后，您可以将其用作视图（我们称之为*VCALLS_COMMS*）并将其连接到自身以查找具有匹配日期的行：

```
SELECT 
  VCC1.CALL_ID,
  VCC2.CALL_ID
FROM
  VCALLS_COMMS VCC1
  JOIN
  VCALL_COMMS VCC2 ON
    (VCC2.COMM_DATE = VCC1.CALL_DATE) 
```

可能不是你想要的，希望对你有帮助。

# sql-server - 单引号（'）在sql server 2005存储过程中插入问题

> ID：776560
> 
> 赞同：0
> 
> 时间：2009-04-22T10:38:54.580
> 
> 标签：sql-server, escaping

```
txtname.Text.Trim().Replace("'", "' + char(39) + '") 
```

上述语句不适用于存储过程

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T10:42:30.530

不要手动构建 sql。请改用参数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T10:45:06.483

你想做什么？如果您想让字符串“安全”嵌入到 SQL 查询中，您可能需要这样：

```
txtname.Text.Trim().Replace("'", "''") 
```

...但如果可能的话，我强烈建议您改用参数。然后，您无需担心单引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T10:44:53.083

[您可以在此处](http://it.toolbox.com/wiki/index.php/How_do_I_escape_single_quotes_in_SQL_queries%3f)找到解决方案。有一个指南如何使用参数或如何手动转义单引号。

希望这可以帮助..

# php - 使用 webclient 在 post 中上传文件，使用 php 接收和处理文件

> ID：776566
> 
> 赞同：0
> 
> 时间：2009-04-22T10:40:45.793
> 
> 标签：php, file-upload

我如何让 php 重新确认有一个文件正在由 vb webclient 上传到它

当前的php代码是这个

```
if(count($_FILES)==1) {
    //move_uploaded_file  
    ( $_FILES[0]["tmp_name"]  , "./imgs/curdesktop.png"  );

    file_put_contents("./nin.txt",print_r($_FILES));
} 
```

它现在所做的只是检查 FILE 数组并将属性打印到文本文件中。但是 vb 程序说文件上传没有错误，并且 $_FILES 数组返回 1 这对该数组无效

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T11:00:42.733

您将 print_r() 作为返回值的函数。首先检查 wat print_r 是否真的在屏幕上打印。（我认为它现在已经打印出来了）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:04:36.017

尝试使用[var_export()](http://www.php.net/var_export)：

```
file_put_contents("./nin.txt",var_export($_FILES,true)); 
```

传递**true**作为第二个参数将返回变量表示而不是输出它，因此内容应该写入文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T19:22:32.403

使 print_r($_FILES, true)。

# asp.net - ASP.NET 中 DropDown 内的 Treeview

> ID：776575
> 
> 赞同：2
> 
> 时间：2009-04-22T10:43:55.363
> 
> 标签：asp.net, treeview, drop-down-menu

我有一个需要以`TreeView`. 这样做了，但问题是，它在网页上占用了太多空间。

所以我想使用一个下拉菜单来保存树视图？？？从 CodeProject 获得的样本很少，但没有成功。

任何解决我的问题的指示或任何其他建议将不胜感激。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-09-13T07:00:13.130

尝试在 ajax 工具包控件中使用 dropdownExtendar。

这是一个例子......

```
<asp:UpdatePanel ID="upArea" runat="server">
 <ContentTemplate>
      <asp:TextBox ID="txtArea" runat="server" Width="100%" />
      <asp:DropDownExtender ID="txtArea_DropDownExtender" runat="server"  
        Enabled="True" TargetControlID="txtArea" DropDownControlID="CourseTreeView">
      </asp:DropDownExtender>
      <asp:TreeView ID="CourseTreeView" runat="server"
       OnSelectedNodeChanged="CourseTreeView_SelectedNodeChanged"                                       ShowLines="true" DataSourceID="xdsArea" PopulateNodesFromClient="false" BackColor="#99CCFF" Width="232px">                                                                                           <Nodes>
          <asp:TreeNode Text="Gouse" PopulateOnDemand="false" Value="-1" />
            </Nodes>
         </asp:TreeView>
         <asp:XmlDataSource ID="xdsArea" runat="server" DataFile="~/XMLFile.xml" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T10:50:02.570

您可以将它放在 a`<div>`中，如果它溢出，样式选项设置为滚动

```
<div style="height: 200px; width: 300px; overflow: auto;"> 
  //Treeview
</div> 
```

# flash - file.asc 和 file.far

> ID：776578
> 
> 赞同：2
> 
> 时间：2009-04-22T10:44:18.980
> 
> 标签：flash, file, video-streaming

你能告诉我文件扩展名`.asc`和`.far`文件扩展名之间的区别吗？每个使用的上下文是什么，可以`.far`用来代替`.asc`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-30T12:16:54.167

**.asc**文件是动作脚本**通信文件，是****用于为 Flash Media** **Server**创建应用程序的“类”文件。在 Flash Media Server 被命名之前，它曾经被称为 Flash Communcation Server。[你可以在这里](http://livedocs.adobe.com/fms/2/docs/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00000631.html)阅读更多关于它的信息。

 ****.far**文件较新。

> Flash Media Server 包括一个命令行存档编译器实用程序 far.exe，它允许您将服务器端脚本打包成一个 FAR 文件，该文件是一个类似于 ZIP 文件的存档文件，以简化部署。您还可以使用归档编译器实用程序将服务器端脚本文件编译为字节码（文件扩展名为 .ase），以加快加载应用程序实例所需的时间。
> 
> 大型应用程序可以包含存储在不同位置的多个服务器端脚本文件。一些文件位于应用程序目录中，而另一些则分散在服务器配置文件中定义的脚本库路径中。为了简化媒体应用程序的部署，您可以将服务器端 JS、ASC 和 ASE 文件打包到一个自包含的 Flash Media Server 存档文件（FAR 文件）中。
> 
> FAR 文件是一个包，其中包括主脚本文件（main.js、main.asc、main.ase、applicationName.js、applicationName.asc 或 applicationName.ase）和引用的任何其他脚本文件在主脚本中。

在[FMS LiveDocs](http://help.adobe.com/en_US/FlashMediaServer/3.5_Deving/WS5b3ccc516d4fbf351e63e3d11a0773d56e-7ff2.html)中，查看*Packaging server-side files*下。

# security - 使用 RunWithElevatedPrivileges 时如何更改“修改者”？

> ID：776579
> 
> 赞同：13
> 
> 时间：2009-04-22T10:44:30.230
> 
> 标签：security, sharepoint

我们有一个将文档上传到文档库的 Web 部件。上传文档的用户可能无法访问目标位置，因此添加文件的代码在[RunWithElevatedPrivileges](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spsecurity.runwithelevatedprivileges.aspx)块内执行。这意味着“修改者”字段始终设置为系统帐户。这是代码：

```
SPSecurity.RunWithElevatedPrivileges(
    delegate
    {
        using (SPSite elevatedSite = new SPSite(SPContext.Current.Site.Url))
        using (SPWeb targetWeb = elevatedSite.OpenWeb(webUrl))
        {
            targetWeb.AllowUnsafeUpdates = true;
            SPFile newFile = files.Add(filename, file);
            SPListItem item = newFile.Item;

            // TODO: Insert code to set Modified By

            item.SystemUpdate();
        }
    }
} 
```

“修改者”字段需要设置为当前用户的名称（在上面的 TODO 行），但以下尝试均无效：

```
item["Modified By"] = SPContext.Current.Web.CurrentUser;

item["Author"] = SPContext.Current.Web.CurrentUser;

item["Modified By"] = new SPFieldUserValue(
SPContext.Current.Web, SPContext.Current.Web.CurrentUser.ID,
SPContext.Current.Web.CurrentUser.Name);

item["Author"] = new SPFieldUserValue(
SPContext.Current.Web, SPContext.Current.Web.CurrentUser.ID,
SPContext.Current.Web.CurrentUser.Name); 
```

有谁知道允许更改“修改者”值的解决方案？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-19T13:42:18.497

我又做了一些测试...

```
item["Editor"] = SPContext.Current.Web.CurrentUser;
item["Author"] = SPContext.Current.Web.CurrentUser;
item.SystemUpdate(); 
```

创建者设置为当前用户，但修改者设置为系统帐户。

```
item["Editor"] = SPContext.Current.Web.CurrentUser;
item["Author"] = SPContext.Current.Web.CurrentUser;
item.Update(); 
```

创建者和修改者都设置为当前用户。

问题在于使用[SPListItem.SystemUpdate()](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem.systemupdate.aspx)与 API 文档所述完全相反，至少在以提升的权限运行时。

**注意：**在 SPSecurity.RunWithElevatedPrivileges 中运行时，SPContext.Current.Web.CurrentUser 会选择当前用户而不是系统帐户。（是否应该这样使用是另一个问题。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T12:40:28.610

解决此问题的一种方法是在提升权限**之前将当前登录的用户存储在内存中。**稍后在更新请求中，将“系统帐户”替换为您的变量。

见下文：

```
// Keep a reference of the Logged in user in memory
SPUser currentUser = SPContext.Current.Web.CurrentUser;

SPSecurity.RunWithElevatedPrivileges(
delegate
{
    using (SPSite elevatedSite = new SPSite(SPContext.Current.Site.Url))
    using (SPWeb targetWeb = elevatedSite.OpenWeb(webUrl))
    {
        targetWeb.AllowUnsafeUpdates = true;
        SPFile newFile = files.Add(filename, file);
        SPListItem item = newFile.Item;

        // Replace 'System Account' with current user
        item["Author"] = currentUser;
        item["Modified By"] = currentUser;

        item.SystemUpdate();
    }
}); 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-28T00:35:17.827

像 (Henrique Zacchi) 写的那样做，但是构建一个包装扩展方法，将 SPUser 作为附加参数。然后使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-07T10:43:27.620

RunWithElevatedPrivileges 总是在当前线程内使用 AppPool 的标识创建一个新线程。因此，在这个委托中，上下文属于系统帐户。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T14:52:40.257

也许模仿可能是帮助您解决问题的一种选择。

一些信息： http: [//dotnet.org.za/zlatan/archive/2007/08/05/sharepoint-2007-impersonation.aspx](http://dotnet.org.za/zlatan/archive/2007/08/05/sharepoint-2007-impersonation.aspx) [http://www.sharepointblogs.com/mirjam/archive/2006/11/ 02/impersonation-in-sharepoint-2007.aspx](http://www.sharepointblogs.com/mirjam/archive/2006/11/02/impersonation-in-sharepoint-2007.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T17:29:41.177

您是否尝试过这个而不是 SPSecurity.RunWithElevatedPrivileges？

```
using (WindowsImpersonationContext w = WindowsIdentity.Impersonate(IntPtr.Zero)) 
{
     //Do stuff here
} 
```

# levels - 300 级网络广播或发言是什么意思（在 MSDN、网络广播、培训等中）？

> ID：776591
> 
> 赞同：2
> 
> 时间：2009-04-22T10:47:35.807
> 
> 标签：levels

我想这要么是微软的一些计划，要么是美国范围内的计划。但是我不知道 300、400 等是什么意思。有人可以解释一下吗？这些数字是什么意思？是 MS 的东西还是更广泛的用途？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-26T14:27:49.347

由于其他链接已失效，[我有一个新](http://blogs.technet.com/b/ieitpro/archive/2006/09/29/459944.aspx)链接。

引用：

> **100 级说明：**
> 介绍性和概述性材料。假设在主题方面很少或没有专业知识，并涵盖主题概念、功能、特性和好处。
> 
> **200级描述：**
> 中间材料。假设知识水平为 100 级，并提供有关该主题的具体细节。
> 
> **300级描述：**
> 高级材料。假设有 200 级的知识，对现实环境中的特征有深入的了解，并且有很强的编码能力。提供产品/技术特性子集的详细技术概述，涵盖架构、性能、迁移、部署和开发。
> 
> **400级说明：**
> 专家材料。假定具有深厚的技术知识和经验，并且对主题有详细、透彻的理解。提供专家对专家的互动和专业主题的报道。

[这是有关 Microsoft 培训级别的另一个链接](http://www.misglobaltech.com.au/page/55-microsoft-training-level-descriptions)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T10:54:06.540

100, 200, ...白话在美国的大学中被广泛使用。大一（一年级）一般100个级别，二年级（二年级）200个，大三（三年级）300个等。

Microsoft 列出了它们的用法（请参阅 Kurt 的帖子）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T10:54:08.693

这大致模仿了大学课程通常的编号方式（至少在我知道的美国这里）。

请参阅： [大学课程编号@ Everything2](http://everything2.com/title/College%2520Course%2520Numbers)

# jquery - jquery 在更多页面上使用日期选择器

> ID：776602
> 
> 赞同：0
> 
> 时间：2009-04-22T10:50:37.360
> 
> 标签：jquery

我的javascript文件中有这个：

```
$("#birthdate").datepicker({
            changeMonth: true,
            changeYear: true,
            altFormat: 'dd-mm-yy',
            altField: '#birthdate',

             }); 
```

我有各种页面，其中包含需要日期选择器的字段。有时甚至超过一个页面上的日期选择器。我如何确定这也适用于具有例如类名“alternateDate”的字段？

我试过了

```
 $("#birthdate #alternateDate").datepicker({ 
```

但这行不通。

有任何想法吗？

**更新：**

嗯，日期格式仍然有问题。

```
$.datepicker.formatDate('dd-mm-yy');
            $(".datepicker").datepicker({
                changeMonth: true,
                changeYear: true,
             }); 
```

这是我的html

```
<label for="geboortedatum">Geboortedatum <em>*</em></label><br/><input type="text" class="datepicker" id="birthdate" name="birthdate" value="{$birthdate}"><br/> 
```

但日期选择器输入字段中的格式仍显示为 04/01/2009

意思是 mm/dd/yy

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T16:51:04.653

向要转换为日期选择器的字段添加一个类怎么样。例如：

```
<input type="text" id="birthDate" class="MyDatePickers">
<input type="text" id="alternateDate" class="MyDatePickers"> 
```

您可以通过以下方式激活：

```
$(".MyDatePickers").datepicker({
                    changeMonth: true,
                    changeYear: true,
                    dateFormat: 'dd-mm-yy'
                     }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T13:03:59.770

在您的示例中，您指的是两个 id（因为符号 #）。也许您可以尝试遍历 alternateDate 元素的集合：

> $('#birthdate.alternateDate').each(function(index){ $(this).datepicker({...}) });

免责声明：我不知道确切的 jquery 迭代语法，但我很肯定它是这样的。

# asp.net - 在 TreeView 控件中隐藏 ASP.NET SiteMap 节点

> ID：776608
> 
> 赞同：0
> 
> 时间：2009-04-22T10:51:37.683
> 
> 标签：asp.net, treeview, sitemap

我有一个包含所有节点的站点地图。我正在使用链接到 SiteMap 进行导航的 TreeView 控件。现在我想隐藏某些节点不出现在 TreeView 上。是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T11:20:52.153

是的，这绝对是可能的。我们这样做的方式是向我们不希望在站点地图中显示的节点添加一个自定义“IsPhantom”属性（以及在其他各种地方）：

```
<siteMapNode url="~/Welcome.aspx" title="Welcome" description="" isPhantom="true" /> 
```

然后在站点地图控件中，使用以下代码删除具有“IsPhantom”属性的节点：

```
protected void Page_Load(object sender, EventArgs e)
{
    TreeView1.TreeNodeDataBound += new TreeNodeEventHandler(TreeView1_TreeNodeDataBound);              
    SiteMapSource.Provider = this.CurrentProvider;
}

protected void TreeView1_TreeNodeDataBound(object sender, TreeNodeEventArgs e)
{
    SiteMapNode thisMapNode = (SiteMapNode)e.Node.DataItem;
    TreeNode parentTreeNode = e.Node.Parent;

    if (thisMapNode["isPhantom"] != null && thisMapNode["isPhantom"].ToLower().Equals(bool.TrueString.ToLower()) && parentTreeNode != null)
        parentTreeNode.ChildNodes.Remove(e.Node);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:00:46.650

基于什么标准？如果只想隐藏特定的单个节点，订阅 TreeView 的 NodeDataBound 事件并将整个项目（节点）设置为 Visible=false。

如果您需要以更好的方式执行此操作并提供更大的灵活性，我建议您实现自己的 SiteMapProvider。然后，您可以为每个站点地图节点设置一个属性 ShowInNavigation，并且可以在构建站点地图时进行设置。

# .net - Visual Studio 2008 中的“浏览器文件”是什么，我们为什么需要它？

> ID：776616
> 
> 赞同：3
> 
> 时间：2009-04-22T10:53:36.650
> 
> 标签：.net, visual-studio

在 VS 2008 网站中添加新文件时，我发现了一个名为“浏览器文件”的东西。有谁知道这是什么，如何使用以及何时使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T11:00:19.053

这些 .browser 文件是[浏览器定义文件架构（browsers 元素）](http://msdn.microsoft.com/en-us/library/ms228122(v=vs.100).aspx)（来自 MSDN 文档）：

> 浏览器定义文件包含各个浏览器的定义。在运行时，ASP.NET 使用请求标头中的信息来确定发出请求的浏览器类型。然后 ASP.NET 使用 .browser 文件来确定浏览器的功能，以及如何将标记呈现给该浏览器。
> 
> 这对于希望创建可在移动设备上查看的应用程序的 Web 开发人员很有用，他们利用控制适配器根据设备类型调整 ASP.NET Web 服务器控件的行为。有关详细信息，请参阅“另请参阅”部分中的链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T11:00:20.737

浏览器文件定义了某个浏览器的功能，可用于更改传输给客户端的标记。

[更多信息在这里](http://msdn.microsoft.com/en-us/library/ms228122.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T14:15:01.847

很高兴知道随着新移动设备的推出，此文件仍在更新。您可以在此处获取最新版本：http: [//mdbf.codeplex.com/](http://mdbf.codeplex.com/)。

# java - 在 PersonaC30 证卡打印机上进行 Jpanel 打印

> ID：776621
> 
> 赞同：2
> 
> 时间：2009-04-22T10:54:42.827
> 
> 标签：java, swing, printing

我正在使用 PersonaC30 卡片打印机在卡片上打印我的 Jpanel 数据。我的打印方法在纸质打印机上运行良好，但是当我用卡片打印机打印时，它没有打印我的数据。它在外部打印良好，但不适用于我的应用程序。

这是我的代码：

```
private void printCard(){

PrinterJob printjob = PrinterJob.getPrinterJob();
printjob.setJobName(" TESSCO CUSTOMER CARD ");

printjob.setPrintable (new Printable() {

public int print(Graphics pg, PageFormat pf, int pageNum){

    Paper card = pf.getPaper();
   // card.setImageableArea(0, 0, 153, 243);
    card.setSize(243, 154);
    pf.setPaper(card);
    pf.setOrientation(PageFormat.LANDSCAPE);

if (pageNum > 0){
return Printable.NO_SUCH_PAGE;
}
Graphics2D g2 = (Graphics2D) pg;

g2.translate(pf.getImageableX(), pf.getImageableY());
g2.translate( 0f, 0f );

jLayeredPane2.paint(g2);

return Printable.PAGE_EXISTS;
}
});
if (printjob.printDialog() == false)
return;

try {
        printjob.print();
      }
      catch (PrinterException ex) {
        System.out.println("NO PAGE FOUND."+ex);

      }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T11:20:52.747

试试这个。我添加了一些代码来调整面板图像的大小。

```
private void printCard() {

    PrinterJob printjob = PrinterJob.getPrinterJob();
    printjob.setJobName(" TESSCO CUSTOMER CARD ");

    Printable printable = new Printable() {

        public int print(Graphics pg, PageFormat pf, int pageNum) {

            if (pageNum > 0) {
                return Printable.NO_SUCH_PAGE;
            }

            Dimension size = jLayeredPane2.getSize();
            BufferedImage bufferedImage = new BufferedImage(size.width, size.height, BufferedImage.TYPE_INT_RGB);

            jLayeredPane2.print(bufferedImage.getGraphics());

            Graphics2D g2 = (Graphics2D) pg;
            g2.translate(pf.getImageableX(), pf.getImageableY());
            g2.drawImage(bufferedImage, 0, 0, (int) pf.getWidth(), (int) pf.getHeight(), null);

            return Printable.PAGE_EXISTS;
        }
    };

    Paper paper = new Paper();
    paper.setImageableArea(0, 0, 153, 243);
    paper.setSize(243, 154);

    PageFormat format = new PageFormat();
    format.setPaper(paper);
    format.setOrientation(PageFormat.LANDSCAPE);

    printjob.setPrintable(printable, format);
    if (printjob.printDialog() == false)
        return;

    try {
        printjob.print();
    } catch (PrinterException ex) {
        System.out.println("NO PAGE FOUND." + ex);

    }
} 
```

# c++ - 用 vector::iterator 或 at() 迭代 STL 向量有什么更快的方法？

> ID：776624
> 
> 赞同：61
> 
> 时间：2009-04-22T10:55:05.447
> 
> 标签：c++, performance, stl, vector, iterator

在性能方面，什么会更快？有区别吗？它依赖于平台吗？

```
//1\. Using vector<string>::iterator:
vector<string> vs = GetVector();

for(vector<string>::iterator it = vs.begin(); it != vs.end(); ++it)
{
   *it = "Am I faster?";
}

//2\. Using size_t index:
for(size_t i = 0; i < vs.size(); ++i)
{
   //One option:
   vs.at(i) = "Am I faster?";
   //Another option:
   vs[i] = "Am I faster?";
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-22T10:57:41.353

使用迭代器会导致指针递增（用于递增）和取消引用为取消引用指针。
使用索引，递增应该同样快，但查找元素涉及添加（数据指针+索引）和取消引用该指针，但差异应该是微不足道的。
`at()`还会检查索引是否在范围内，因此它可能会更慢。

500M 迭代的基准测试结果，向量大小 10，gcc 4.3.3 (-O3)，linux 2.6.29.1 x86_64:
`at()`: 9158ms
`operator[]`: 4269ms
`iterator`: 3914ms

YMMV，但如果使用索引使代码更具可读性/可理解性，您应该这样做。

# 2021 年更新

使用现代编译器，所有选项实际上都是免费的，但迭代器在迭代方面稍微好一点，并且更容易与 range-for 循环 ( `for(auto& x: vs)`) 一起使用。

代码：

```
#include <vector>

void iter(std::vector<int> &vs) {
    for(std::vector<int>::iterator it = vs.begin(); it != vs.end(); ++it)
        *it = 5;
}

void index(std::vector<int> &vs) {
    for(std::size_t i = 0; i < vs.size(); ++i)
        vs[i] = 5;
}

void at(std::vector<int> &vs) {
    for(std::size_t i = 0; i < vs.size(); ++i)
        vs.at(i) = 5;
} 
```

`index()`和生成的程序集`at()`是相同的[godbolt](https://godbolt.org/z/cv6Kv4b6f)，但循环设置要`iter()`短两个指令：

```
iter(std::vector<int, std::allocator<int> >&):
        mov     rax, QWORD PTR [rdi]
        mov     rdx, QWORD PTR [rdi+8]
        cmp     rax, rdx
        je      .L1
.L3:                              ; loop body
        mov     DWORD PTR [rax], 5
        add     rax, 4
        cmp     rax, rdx
        jne     .L3
.L1:
        ret
index(std::vector<int, std::allocator<int> >&):
        mov     rax, QWORD PTR [rdi]
        mov     rdx, QWORD PTR [rdi+8]
        sub     rdx, rax
        mov     rcx, rdx
        shr     rcx, 2
        je      .L6
        add     rdx, rax
.L8:                              ; loop body
        mov     DWORD PTR [rax], 5
        add     rax, 4
        cmp     rdx, rax
        jne     .L8
.L6:
        ret 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-22T11:09:13.023

为什么不写一个测试并找出答案？

**编辑：** 我的错 - 我以为我正在计时优化版本，但不是。在我的机器上，使用 g++ -O2 编译，迭代器版本比 operator[] 版本**稍慢**，但可能并不明显。

```
#include <vector>
#include <iostream>
#include <ctime>
using namespace std;

int main() {
    const int BIG = 20000000;
    vector <int> v;
    for ( int i = 0; i < BIG; i++ ) {
        v.push_back( i );
    }

    int now = time(0);
    cout << "start" << endl;
    int n = 0;
    for(vector<int>::iterator it = v.begin(); it != v.end(); ++it) {
        n += *it;
    }

    cout << time(0) - now << endl;
    now = time(0);
    for(size_t i = 0; i < v.size(); ++i) {
        n += v[i];
    }
    cout << time(0) - now << endl;

    return n != 0;
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-04-22T11:20:59.940

如果您不需要索引，请不要使用它。迭代器概念是为您提供最好的。迭代器很容易优化，而直接访问需要一些额外的知识。

索引用于直接访问。括号和`at`方法可以做到这一点。 `at`将与 不同`[]`，检查越界索引，因此它会更慢。

信条是：不要要求你不需要的东西。然后编译器不会为你不使用的东西向你收费。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-04-22T11:08:16.803

由于您正在考虑效率，因此您应该意识到以下变体可能更有效：

```
//1\. Using vector<string>::iterator:

vector<string> vs = GetVector();
for(vector<string>::iterator it = vs.begin(), end = vs.end(); it != end; ++it)
{
   //...
}

//2\. Using size_t index:

vector<string> vs = GetVector();
for(size_t i = 0, size = vs.size(); i != size; ++i)
{
   //...
} 
```

因为 end/size 函数只调用一次，而不是每次循环调用。无论如何，编译器很可能会内联这些函数，但这种方式可以确保。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-22T11:39:06.603

正如这里的其他人所说，做基准测试。

话虽如此，我认为迭代器更快，因为 at() 也进行范围检查，即如果索引超出范围，它会引发 out_of_range 异常。该检查本身可能会产生一些开销。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-22T10:57:44.910

我猜第一个变体更快。

但它依赖于实现。确保您应该分析您自己的代码。

**为什么要分析您自己的代码？**

因为这些因素都会改变结果：

*   哪个操作系统
*   哪个编译器
*   正在使用哪种 STL 实现
*   是否开启了优化？
*   ...（其他因素）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-19T19:53:37.760

这真的取决于你在做什么，但是如果你必须不断地重新声明迭代器，迭代器会变得更慢。在我的测试中，最快的迭代是向你的向量数组声明一个简单的 * 并迭代它。

例如：

向量迭代和每遍拉两个函数。

```
vector<MyTpe> avector(128);
vector<MyTpe>::iterator B=avector.begin();
vector<MyTpe>::iterator E=avector.end()-1;
for(int i=0; i<1024; ++i){
 B=avector.begin();
   while(B!=E)
   {
       float t=B->GetVal(Val1,12,Val2); float h=B->GetVal(Val1,12,Val2);
    ++B;
  }} 
```

矢量点击 90 次（0.090000 秒）

但是如果你用指针来做......

```
for(int i=0; i<1024; ++i){
MyTpe *P=&(avector[0]);
   for(int i=0; i<avector.size(); ++i)
   {
   float t=P->GetVal(Val1,12,Val2); float h=P->GetVal(Val1,12,Val2);
   }} 
```

矢量点击 18 次（0.018000 秒）

大致相当于...

```
MyTpe Array[128];
for(int i=0; i<1024; ++i)
{
   for(int p=0; p<128; ++p){
    float t=Array[p].GetVal(Val1, 12, Val2); float h=Array[p].GetVal(Val2,12,Val2);
    }} 
```

阵列点击 15 次（0.015000 秒）。

如果您消除对 avector.size() 的调用，则时间变得相同。

最后，用 [ ] 调用

```
for(int i=0; i<1024; ++i){
   for(int i=0; i<avector.size(); ++i){
   float t=avector[i].GetVal(Val1,12,Val2); float h=avector[i].GetVal(Val1,12,Val2);
   }} 
```

矢量点击 33 次（0.033000 秒）

用时钟（）计时

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-04-14T09:44:14.933

## 这取决于。

### *答案比现有答案显示的要微妙得多。*

`at`总是比迭代器或`operator[]`.
但对于`operator[]`与迭代器，它取决于：

1.  *你究竟*是如何使用`operator[]`.

2.  您的特定 CPU 是否具有*索引寄存器*（`ESI/EDI`在 x86 上）。

3.  有多少*其他*代码也使用传递给`operator[]`.
    （例如，您是否在同步中通过多个数组进行索引？）

原因如下：

1.  如果你做类似的事情

    ```
    std::vector<unsigned char> a, b;
    for (size_t i = 0; i < n; ++i)
    {
        a[13 * i] = b[37 * i];
    } 
    ```

    那么这段代码可能会比迭代器版本慢得多，因为它在循环的每次迭代中**执行一个*乘法*运算！**

    同样，如果您执行以下操作：

    ```
    struct T { unsigned char a[37]; };
    std::vector<T> a;
    for (size_t i = 0; i < n; ++i)
    {
        a[i] = foo(i);
    } 
    ```

    那么这可能**也会**比迭代器版本慢，因为`sizeof(T)`不是*2 的幂*`37`，因此每次循环时你（再次）乘以！

2.  *如果您的 CPU 有索引寄存器，那么如果使用索引寄存器可以释放另一个寄存器*以供循环使用，那么您的代码可以使用索引而不是迭代器执行同样甚至更好的性能。这*不是*你可以通过观察来判断的；您必须分析代码和/或反汇编它。

3.  如果多个数组可以共享同一个索引，那么代码只需要增加*一个*索引而不是增加多个迭代器，这减少了对内存的写入，因此通常会提高性能。但是，如果您只迭代单个数组，那么迭代器可能会更快，因为它避免了向现有基指针添加偏移量的需要。

一般来说，您应该**更喜欢迭代器**而不是索引，以及索引而不是指针，除非您遇到瓶颈，分析表明切换是有益的，因为*迭代器是通用的*，并且可能是最快的方法；它们不要求数据是可随机寻址的，这允许您在必要时交换容器。索引是下一个首选工具，因为它们仍然不需要直接访问数据——它们的失效频率较低，并且您可以例如用 a 替换 a`deque`而`vector`不会出现任何问题。指针应该是最后的手段，只有当迭代器在发布模式下还没有退化为指针时，它们才会被证明是有益的。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-22T10:59:08.307

第一个在调试模式下会更快，因为索引访问会在后台创建迭代器，但在发布模式下，所有内容都应该内联，差异应该可以忽略不计或为空

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-02-12T10:02:28.030

您可以使用此测试代码并比较结果！迪奥吧！

```
#include <vector> 
#include <iostream> 
#include <ctime> 
using namespace std;; 

struct AAA{
    int n;
    string str;
};
int main() { 
    const int BIG = 5000000; 
    vector <AAA> v; 
    for ( int i = 0; i < BIG; i++ ) { 
        AAA a = {i, "aaa"};
        v.push_back( a ); 
    } 

    clock_t now;
    cout << "start" << endl; 
    int n = 0; 
    now = clock(); 
    for(vector<AAA>::iterator it = v.begin(); it != v.end(); ++it) { 
        n += it->n; 
    } 
   cout << clock() - now << endl; 

    n = 0;
    now = clock(); 
    for(size_t i = 0; i < v.size(); ++i) { 
        n += v[i].n; 
    } 
    cout << clock() - now << endl; 

    getchar();
    return n != 0; 
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-22T11:01:55.523

我认为唯一的答案可能是在您的平台上进行测试。通常，在 STL 中唯一标准化的是集合提供的迭代器类型和算法的复杂性。

我会说这两个版本之间没有（差别不大） - 我能想到的唯一区别是当代码必须计算数组的长度时，它必须遍历整个集合（我'不确定长度是否存储在向量内的变量中，那么开销就无关紧要了）

使用“at”访问元素应该比使用 [] 直接访问它需要更长的时间，因为它会检查您是否在向量的范围内，如果超出范围则抛出异常（似乎 [] 通常只是使用指针算术 - 所以它应该更快）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-22T11:34:57.410

如果您使用 VisualStudio 2005 或 2008，为了从向量中获得最佳性能，您需要定义 _SECURE_SCL=0

默认情况下，_SECURE_SCL 处于启用状态，这使得迭代包含显着变慢。也就是说，将它留在调试版本中，它将更容易追踪任何错误。需要注意的是，由于宏会更改迭代器和容器的大小，因此您必须在共享 stl 容器的所有编译单元中保持一致。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-02-12T07:47:38.323

我现在在尝试优化我的 OpenGL 代码时发现了这个线程，并且想分享我的结果，即使线程很旧。

**背景：**我有 4 个向量，大小范围从 6 到 12。写入仅在代码开头发生一次，并且每 0.1 毫秒对向量中的每个元素进行一次读取

以下是首先使用的代码的精简版本：

```
for(vector<T>::iterator it = someVector.begin(); it < someVector.end(); it++)
{
    T a = *it;

    // Various other operations
} 
```

使用这种方法的帧速率约为每秒 7 帧 (fps)。

但是，当我将代码更改为以下时，帧速率几乎翻了一番，达到 15fps。

```
for(size_t index = 0; index < someVector.size(); ++index)
{
    T a = someVector[index];

    // Various other operations
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-04-13T03:08:45.097

这是我编写的代码，在 Code::Blocks v12.11 中编译，使用默认的 mingw 编译器。这会创建一个巨大的向量，然后使用迭代器、at() 和索引访问每个元素。每个都通过函数调用最后一个元素循环一次，并通过将最后一个元素保存到临时内存来循环一次。

使用 GetTickCount 完成计时。

```
#include <iostream>
#include <windows.h>
#include <vector>
using namespace std;

int main()
{
    cout << "~~ Vector access speed test ~~" << endl << endl;
    cout << "~ Initialization ~" << endl;
    long long t;
    int a;
    vector <int> test (0);
    for (int i = 0; i < 100000000; i++)
    {
        test.push_back(i);
    }
    cout << "~ Initialization complete ~" << endl << endl;

    cout << "     iterator test: ";
    t = GetTickCount();
    for (vector<int>::iterator it = test.begin(); it < test.end(); it++)
    {
        a = *it;
    }
    cout << GetTickCount() - t << endl;

    cout << "Optimised iterator: ";
    t=GetTickCount();
    vector<int>::iterator endofv = test.end();
    for (vector<int>::iterator it = test.begin(); it < endofv; it++)
    {
        a = *it;
    }
    cout << GetTickCount() - t << endl;

    cout << "                At: ";
    t=GetTickCount();
    for (int i = 0; i < test.size(); i++)
    {
        a = test.at(i);
    }
    cout << GetTickCount() - t << endl;

    cout << "      Optimised at: ";
    t = GetTickCount();
    int endof = test.size();
    for (int i = 0; i < endof; i++)
    {
        a = test.at(i);
    }
    cout << GetTickCount() - t << endl;

    cout << "             Index: ";
    t=GetTickCount();
    for (int i = 0; i < test.size(); i++)
    {
        a = test[i];
    }
    cout << GetTickCount() - t << endl;

    cout << "   Optimised Index: ";
    t = GetTickCount();
    int endofvec = test.size();
    for (int i = 0; i < endofvec; i++)
    {
        a = test[i];
    }
    cout << GetTickCount() - t << endl;

    cin.ignore();
} 
```

基于此，我个人认为“优化”版本比“非优化”版本更快迭代器比 vector.at() 慢，后者比直接索引慢。

我建议您自己编译并运行代码。

**编辑**：当我对 C/C++ 的经验较少时，此代码被写回。另一个测试用例应该是使用前缀增量运算符而不是后缀。那应该会改善运行时间。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-26T19:07:41.460

差异应该可以忽略不计。std::vector 保证其元素在内存中连续布局。因此，大多数 stl 实现将迭代器实现为 std::vector 作为普通指针。考虑到这一点，两个版本之间的唯一区别应该是第一个版本增加一个指针，而第二个版本增加一个索引，然后将其添加到指针中。所以我的猜测是第二个可能是一个非常快（就周期而言）的机器指令。

尝试检查编译器生成的机器代码。

然而，一般来说，如果它真的很重要，建议是进行分析。过早地思考这类问题通常不会给你太多回报。通常，您的代码的热点将位于您乍一看可能不会怀疑的其他地方。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-03-16T19:16:14.693

仅与原始问题略微相切，但最快的循环将是

`for( size_t i=size() ; i-- ; ) { ... }`

这当然会倒计时。如果您的循环中有大量迭代，这确实可以节省大量资金，但它只包含少量非常快速的操作。

因此，使用 [] 运算符访问，这可能比已经发布的许多示例更快。

# python - 使用 Twisted 的 twisted.web 类，我如何刷新我的传出缓冲区？

> ID：776631
> 
> 赞同：9
> 
> 时间：2009-04-22T10:57:50.057
> 
> 标签：python, twisted, multipart-mixed-replace

我使用 Twisted 制作了一个简单的 http 服务器，它发送 Content-Type: multipart/x-mixed-replace 标头。我正在使用它来测试我想设置为接受长期流的 http 客户端。

出现的问题是我的客户端请求挂起，直到*http.Request*调用 self.finish()，然后它一次接收所有多部分文档。

有没有办法手动将输出缓冲区刷新到客户端？我假设这就是我没有收到单独的多部分文档的原因。

```
#!/usr/bin/env python

import time

from twisted.web import http
from twisted.internet import protocol

class StreamHandler(http.Request):
    BOUNDARY = 'BOUNDARY'

    def writeBoundary(self):
        self.write("--%s\n" % (self.BOUNDARY))

    def writeStop(self):
        self.write("--%s--\n" % (self.BOUNDARY))

    def process(self):
        self.setHeader('Connection', 'Keep-Alive')
        self.setHeader('Content-Type', "multipart/x-mixed-replace;boundary=%s" % (self.BOUNDARY))

        self.writeBoundary()

        self.write("Content-Type: text/html\n")
        s = "<html>foo</html>\n"
        self.write("Content-Length: %s\n\n" % (len(s)))
        self.write(s)
        self.writeBoundary()
        time.sleep(2)

        self.write("Content-Type: text/html\n")
        s = "<html>bar</html>\n"
        self.write("Content-Length: %s\n\n" % (len(s)))
        self.write(s)
        self.writeBoundary()
        time.sleep(2)

        self.write("Content-Type: text/html\n")
        s = "<html>baz</html>\n"
        self.write("Content-Length: %s\n\n" % (len(s)))
        self.write(s)

        self.writeStop()

        self.finish()

class StreamProtocol(http.HTTPChannel):
    requestFactory = StreamHandler

class StreamFactory(http.HTTPFactory):
    protocol = StreamProtocol

if __name__ == '__main__':
    from twisted.internet import reactor
    reactor.listenTCP(8800, StreamFactory())
    reactor.run() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-29T14:30:35.980

使用`time.sleep()`可以防止扭曲完成其工作。要使其无法使用`time.sleep()`，您必须将控制权返回给 twisted。修改现有代码的最简单方法是使用[`twisted.internet.defer.inlineCallbacks`](http://twistedmatrix.com/documents/8.2.0/api/twisted.internet.defer.html#inlineCallbacks)，这是自切片面包以来的下一个最佳方法：

```
#!/usr/bin/env python

import time

from twisted.web import http
from twisted.internet import protocol
from twisted.internet import reactor
from twisted.internet import defer

def wait(seconds, result=None):
    """Returns a deferred that will be fired later"""
    d = defer.Deferred()
    reactor.callLater(seconds, d.callback, result)
    return d

class StreamHandler(http.Request):
    BOUNDARY = 'BOUNDARY'

    def writeBoundary(self):
        self.write("--%s\n" % (self.BOUNDARY))

    def writeStop(self):
        self.write("--%s--\n" % (self.BOUNDARY))

    @defer.inlineCallbacks
    def process(self):
        self.setHeader('Connection', 'Keep-Alive')
        self.setHeader('Content-Type', "multipart/x-mixed-replace;boundary=%s" % (self.BOUNDARY))

        self.writeBoundary()

        self.write("Content-Type: text/html\n")
        s = "<html>foo</html>\n"
        self.write("Content-Length: %s\n\n" % (len(s)))
        self.write(s)
        self.writeBoundary()

        yield wait(2)

        self.write("Content-Type: text/html\n")
        s = "<html>bar</html>\n"
        self.write("Content-Length: %s\n\n" % (len(s)))
        self.write(s)
        self.writeBoundary()

        yield wait(2)

        self.write("Content-Type: text/html\n")
        s = "<html>baz</html>\n"
        self.write("Content-Length: %s\n\n" % (len(s)))
        self.write(s)

        self.writeStop()

        self.finish()

class StreamProtocol(http.HTTPChannel):
    requestFactory = StreamHandler

class StreamFactory(http.HTTPFactory):
    protocol = StreamProtocol

if __name__ == '__main__':   
    reactor.listenTCP(8800, StreamFactory())
    reactor.run() 
```

这适用于Firefox，我想它正确回答了你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-29T00:41:01.403

原因似乎在[扭曲的常见问题解答中](http://twistedmatrix.com/trac/wiki/FrequentlyAskedQuestions#WhydoesittakealongtimefordataIsendwithtransport.writetoarriveattheothersideoftheconnection)进行了解释。在反应器线程可以自由运行之前，扭曲的服务器实际上不会向下划线连接写入任何内容，在这种情况下是在您的方法结束时。但是，您可以在每次睡眠之前使用[reactor.doSelect(timeout)](http://twistedmatrix.com/documents/current/api/twisted.internet.default.SelectReactor.html#doSelect)以使反应器将其写入连接的内容。

# xml - 增量交换格式

> ID：776633
> 
> 赞同：0
> 
> 时间：2009-04-22T10:57:58.713
> 
> 标签：xml, json

我需要一种格式来将数据从程序 A 传输到程序 B，显然我更喜欢使用标准格式。从表面上看，XML 非常适合这项工作，或者可能是 JSON。

美中不足的是，我需要增量格式：程序 A 不时将数据附加到文件中，然后程序 B 在准备好时将全部内容删除。根据我的阅读，XML 和 JSON 都不能做到这一点，因为它们都需要文件中的一个顶级元素。

有什么我想念的吗？

澄清：

我需要 XML 提供的那种结构，而 CSV 不需要。（好吧，我可以制作 CSV 的突变变体，其他任何东西都无法读取，但这就是我要避免的。）

A 不知道何时完成（取决于用户操作、网络连接的可用性和其他此类不可预测的变量），因此 A 不能说“现在我将写入最后一个结束标记并移交给 B”，因为 A 可能在 B 之前再次被调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T11:31:49.290

所以 A*总是*需要编写一个格式良好的文件，以便 B 可以随时读取它。

如果您使用 XML（这似乎很合适），您将始终必须编写格式良好的文档（例如，包含一个根节点和其中的子节点）。所以你必须在你的进程中维护一个 DOM 对象。根据内存消耗，这可能很好。

A 可以在有更新时写入。这里的问题是写入文件将花费有限的时间，并且您不希望 B 读取部分写入的文件。这里需要某种形式的文件完整的信号（使用临时文件作为信号量，重命名等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:02:22.933

CSV 怎么样？易于编写 - 如果您知道格式并且不需要额外的元信息，则易于解析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:03:30.603

如果我对您的理解正确，则工作流程如下：

*   在一段时间内，A 正在构建数据以放入文件中
*   一旦准备好，B就会消耗掉整个东西。

在这种情况下，XML 和 JSON 都很好，因为有一个不同的点，A 正在工作，而 B 在处理文件之前不会开始使用文件（与不断提供数据的始终打开的流相反）。

在 .NET 之类的东西中，您可以创建一个带有根元素的 XmlDocument，然后继续向其中添加节点，直到完成。

# winforms - 适用于 Windows 窗体的 Windows XP 控制面板控件

> ID：776634
> 
> 赞同：0
> 
> 时间：2009-04-22T10:58:03.457
> 
> 标签：winforms, controls, panel

我想要一个 UI 类似于 Windows XP 控制面板的应用程序。有人知道具有相同图标视图的控件吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T11:14:52.387

最接近此目的的控件是 ListView 控件，它使用大图标视图。

它将具有与控制面板类似的外观。除非您谈论的是 WindowsXP 中基于类别的控制面板，否则您将有多个控件和表单来处理此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T11:26:42.407

[此处](http://www.codeproject.com/KB/list/FileSystemListView.aspx)的文章展示了如何在您的应用程序中嵌入 Windows 文件查看器控件，请参阅我的答案[以](https://stackoverflow.com/questions/542378/embedding-a-file-explorer-instance-in-a-winforms-app-form/776741#776741)获取更多信息。

# asp.net - 从命令行复制 VS2008“发布网站”

> ID：776635
> 
> 赞同：36
> 
> 时间：2009-04-22T10:58:50.523
> 
> 标签：asp.net, visual-studio-2008, msbuild, publish

我正在尝试在构建脚本中复制 Visual Studio 2008 中此对话的确切功能： [![替代文字](https://i.stack.imgur.com/cMxdL.png)](https://i.stack.imgur.com/cMxdL.png)

这是一个 ASP.NET*网站*，而不是一个 Web*应用程序*。

我已经在 Google 上搜索了很多关于 MSBuild 的内容，但这似乎都与作为 ASP.NET Web 应用程序布局的解决方案有关：

[http://www.driebier.net/post/Using-MSBuild-to-deploy-visual-studio-2005-web-applications.aspx](http://www.driebier.net/post/Using-MSBuild-to-deploy-visual-studio-2005-web-applications.aspx) [http://blog.donnfelker.com/post/TFS-Build-Not-Publishing -Web-Applications.aspx](http://blog.donnfelker.com/post/TFS-Build-Not-Publishing-Web-Applications.aspx)

[本文](http://codingcockerel.co.uk/2008/05/18/how-to-publish-a-web-site-with-msbuild/)似乎与 ASP.NET 网站相关，但我发现在尝试使用这些建议进行构建时出现错误：

```
C:\dev\T&A>msbuild /t:_CopyWebApplication /property:OutDir=c:\temp\taweb\ /prope
rty:WebProjectOutputDir=c:\temp\taweb\

Microsoft (R) 构建引擎版本 3.5.30729.1
[Microsoft .NET 框架，版本 2.0.50727.3074]
版权所有 (C) Microsoft Corporation 2007。保留所有权利。

构建开始于 22/04/2009 11:50:42。
节点 0（_CopyWebApplication 目标）上的项目“C:\dev\T&A\TAWeb.sln”。
  构建解决方案配置“Debug|.NET”。
C:\dev\T&A\TAWeb.sln : 错误 MSB4057: 目标“_CopyWebApplication”不
 存在于项目中。
完成构建项目“C:\dev\T&A\TAWeb.sln”（_CopyWebApplication 目标）-
 失败的。

构建失败。

"C:\dev\T&A\TAWeb.sln" (_CopyWebApplication 目标) (1) ->
  C:\dev\T&A\TAWeb.sln : 错误 MSB4057: 目标“_CopyWebApplication”没有
项目中不存在。

0 个警告

1 个错误

经过时间 00:00:00.06

```

我尝试发布的解决方案（继承，不是我自己的）没有 .csproj 文件（我可以从 C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v9.0\ 导入 _CopyWebApplication 目标WebApplications\Microsoft.WebApplication.targets)

也许这是 Visual Studio 2005/2008 的区别？

无论如何，我觉得我在那里走错了路。

本质上，我只需要*完全*实现上述对话的功能，但从命令行。

非常感谢

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-10-28T23:24:34.593

以下命令使用默认设置复制“*发布网站”对话框。*

## 使用默认设置发布网站的命令

`aspnet_compiler -nologo -v / -p "C:\WebSite1" -u "C:\TargetPath"`

### 参考

1) 请参阅标题为“*您想要发布网站但您还没有 Visual Studio* ”的*社区内容...* [http://msdn.microsoft.com/en-us/library/20yh9f1b(classic).aspx](http://msdn.microsoft.com/en-us/library/20yh9f1b(classic).aspx)。

 **   Microsoft Visual Studio 2005 > Visual Studio 2005 命令提示符
*   Microsoft Visual Studio 2008 > Visual Studio 2008 命令提示符
*   Microsoft .NET Framework SDK v2.0 > SDK 命令提示符

[2) 请参阅http://msdn.microsoft.com/en-us/library/ms229863.aspx](http://msdn.microsoft.com/en-us/library/ms229863.aspx)上的“ASP.NET 编译工具 (Aspnet_compiler.exe)” 。

3) 以下演练摘录：*使用 XCOPY 部署 ASP.NET Web 应用程序*[http://msdn.microsoft.com/en-us/library/f735abw9.aspx](http://msdn.microsoft.com/en-us/library/f735abw9.aspx)

> 作为使用所有 .NET Framework 版本都支持的 XCOPY 命令行工具的替代方法，您可以使用位于 %SystemRoot%\Microsoft.NET\Framework\*版本 2 或更高版本*的新 .NET Framework 2.0 工具\Aspnet_compiler.exe 来编译和部署您的 Web 应用程序。有关详细信息，请参阅[ASP.NET 编译工具 (Aspnet_compiler.exe)](http://msdn.microsoft.com/en-us/library/ms229863.aspx)。

4) 以下摘自*如何：预编译 ASP.NET 网站以进行部署*，网址为[http://msdn.microsoft.com/en-us/library/ms227976.aspx](http://msdn.microsoft.com/en-us/library/ms227976.aspx)。

> 如果您的网站不是 Internet 信息服务 (IIS) 应用程序，因此在 IIS 元数据库中没有条目，请为 -v 开关使用以下值。
> 
> `aspnet_compiler -p physicalOrRelativePath -v / targetPath`
> 
> 在这种情况下，physicalOrRelativePath 参数指的是网站文件所在的完全限定目录路径，或相对于当前目录的路径。在physicalOrRelativePath 参数中允许使用句点(.) 运算符。-v 开关指定编译器将用于解析应用程序根引用的根（例如，使用波浪号 (~) 运算符）。当您为 -v 开关指定 / 的值时，编译器将使用物理路径作为根来解析路径。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T11:35:13.773

我认为您正在寻找[AspNetCompiler](http://msdn.microsoft.com/en-us/library/ms164291.aspx)任务

```
<Target Name="PublishToIIS" DependsOnTargets="Publish">
    <AspNetCompiler    
            VirtualPath="$(IISVirtualPath)"
            TargetPath="$(IISTargetPath)"
            PhysicalPath="$(MSBuildProjectDirectory)/trunk/InternalAppCS/Web.UI/"
            Force="true"
            Debug="$(IISDebug)"
     />

</Target> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-10-08T18:12:28.020

这种“神奇”的组合可以满足您的需求。) 只花了两天时间就为我的项目找到了正确的组合。) 关键是包含 _CopyWebApplication 目标和 ResolveReferences 目标。

```
msbuild "/t:_CopyWebApplication;ResolveReferences;publish" /p:OutDir="C:\inetpub\wwwroot\[appname]\bin\" /p:WebProjectOutputDir="C:\inetpub\wwwroot\[appname]" c:\directory\[appname].csproj 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-09-10T21:47:00.100

添加到您的 .csproj 文件中：

```
<Target Name="AfterBuild">
<Message Text="Copying to Deployment Dir:" />
<Copy SourceFiles="@(Content)" DestinationFolder="..\PreCompiledWeb\%(Content.RelativeDir)" />
<CreateItem Include="$(OutputPath)\*">
    <Output TaskParameter="Include" ItemName="Binaries"/>
</CreateItem>
<Copy SourceFiles="@(Binaries)" DestinationFolder="..\PreCompiledWeb\bin" /> 
```

为要发布到的文件夹更改“..\PreCompiledWeb”，或者您可以指定一个变量，例如：$(OutputFolder)，您可以传递它

然后转到您的网络应用程序的文件夹并执行以下操作：

```
msbuild /t:Build 
```

然后，您可以使用 xcopy 将这些文件复制到任何您想要的位置：

```
xcopy "..\PreCompiledWeb\*.*" "C:\MySite\" /e 
```

那应该这样做。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-22T11:23:37.390

我个人使用为我运行命令的 buildbot，我必须创建一个 VBS 脚本来为我执行上传。

我安装了[WinSCP](http://winscp.net)来完成 ftp 工作，然后编写了上传脚本：

```
Set WshShell = CreateObject("WScript.Shell")
sCmd1 = """C:\Program Files\WinSCP\winscp.com"" <myusername> /command ""option batch on"" ""option confirm off"" ""put " & DefaultPath & strResult & "\" & DefaultFileName & " /Usr/<myuser>/" & updateType & "/" & strResult & "/"" ""exit""" 
```

要从命令行预编译网站，我执行以下操作，但是我在 Web 服务器上执行此操作，而不是在上传之前：

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_compiler -p "D:\<mycompany>\Backedup\Web Sites\<mysite\Root" -v / 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-29T11:29:32.780

我一直在使用 msbuild 来完全按照您的描述进行操作。您是否尝试过这样设置属性？

```
 /property:"OutDir=c:\temp\taweb\;WebProjectOutputDir=c:\temp\taweb\" 
```

如果它仍然不起作用，请告诉我，我可以将我的 bat 文件发送给您，该文件启动 msbuild 脚本，执行 svn get，构建 assembly.info 文件，部署网站，最后运行 http get在站点主页上，只是为了确保它正确构建和部署。

希望对日韩有帮助

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-09-20T00:59:13.720

我一直在努力解决同样的错误（MSB4057：项目中不存在目标“_CopyWebApplication”。

是的。我使用的是 Web 应用程序项目（不是网站）。

我很困惑，因为我有一个项目有效，一个没有。因此，我与 ExamDiffPro 坐下来，开始比较项目文件。我发现项目文件底部包含的构建目标部分不同。

使用较新版本的 Visual Studio 创建了一个项目（正在运行）。另一个（不工作）是几年前创建的，多年来一直在升级到我正在使用的当前版本。随着新版本的 Visual Studio 可用，升级后的项目显然没有使用新的构建目标进行升级。

在正在运行的项目文件的底部，我发现了以下内容：

> `<Import Project="$(MSBuildBinPath)\Microsoft.VisualBasic.targets" />`
> 
> **`<Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v8.0\WebApplications\Microsoft.WebApplication.targets" />`**

第二个导入行不在导致问题的项目中。

我只是从工作文件中复制了导入，并将其粘贴到非工作文件中的相对位置，中提琴！

虽然这不是此线程中定义的初始问题的直接解决方案，但我希望这有助于其他一些偶然发现此线程的人，寻找类似问题，仅针对实际的 Web 应用程序项目。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-04-07T11:42:10.773

这是一个小 PowerShell 脚本，它构建一个解决方案，然后从中发布一个 Web 项目。

MSBuild 适用于 .Net 3.5，因此如果需要，请更改为“\v4.0\”。

```
$build = "$env:windir\Microsoft.NET\Framework\v3.5\MSBuild.exe"

$SolutionPath = "C:\Projects\AdminWebSite"
$SolutionFile = "AdminWebSite.sln"
$WebProjectFile = "Admin.Web\Admin.Web.csproj"
$OutputPath = "C:\PublishedSites\Hosts\adminweb"

& $build "$SolutionPath\$SolutionFile" /t:rebuild
& $build "$SolutionPath\$WebProjectFile" "/t:ResolveReferences;_CopyWebApplication;publish" /p:OutDir="$OutputPath\bin\" /p:WebProjectOutputDir="$OutputPath" 
```

“ResolveReferences”*必须*在“_CopyWebApplication”之前，否则依赖项会丢失。

此处给出的示例路径构建为：

*   C:\Project\AdminWebSite\AdminWebSite.sln
*   C:\Project\AdminWebSite\Admin.Web\Admin.Web.csproj

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-10-27T17:26:10.810

您收到的错误（C:\dev\T&A\TAWeb.sln : error MSB4057: The target "_CopyWebApplication" does not exist in the project）是由于两个问题。首先：目标 _CopyWebApplication 必须在 WebApplication 项目文件上调用，而不是解决方案。第二：一个网站没有项目文件，WebApplications有项目文件。

_CopyWebApplication 目标仅适用于发布 WebApplication 项目。使用 AspNetCompiler MSBuild 任务必须用于发布网站。

当您在 Visual Studio 2008 中发布网站时，输出的第二行是“预编译网站”。Visual Studio 显示的选项用于将网站地图直接发布到[AspNetCompiler](http://msdn.microsoft.com/en-us/library/ms164291%28v=VS.80%29.aspx)和[Aspnet_compiler.exe](http://msdn.microsoft.com/en-us/library/ms229863%28VS.80%29.aspx)的选项。

虽然我不是第一个说“使用 AspNet_compiler”的人，但我认为描述原因可能会有所帮助。附带说明一下，我认为 AspNet_compiler 可用于发布 webapp，但我需要进行更多测试。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-07-20T18:16:55.983

我使用 bat 文件使用 msbuild.exe（.net 3.5，vs 2008）在文件夹中“发布”我的网站（vbproj）。

> %msBuildDir%\msbuild "D:\Project1\Client\WebPresentation\ConsultaOperaciones.vbproj" /t:ResolveReferences;重建 /p:BuildingProject=true;OutDir=D:\Instalaciones\ultima\PublicacionWeb\OutDir\;WebProjectOutputDir=D: \Instalaciones\ultima\PublicacionWeb\WebProjectDir\

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-04-22T11:27:12.840

您无法自行重新创建“发布...”功能并没有什么神奇之处，特别是因为您的目标是网络文件共享。

它的核心就是将文件从一个地方复制到另一个地方。使用 NAnt，您可以通过[复制](http://nant.sourceforge.net/release/latest/help/tasks/copy.html)任务来完成此任务，或者您可以使用[exec](http://nant.sourceforge.net/release/latest/help/tasks/exec.html)任务来调用[xcopy](http://technet.microsoft.com/en-us/library/bb491035.aspx) 如果您使用的是 NAnt 以外的构建工具，我确信有对类似任务的支持。

如果您想留下原始代码和调试信息，可以排除以 .cs 或 .pdb 结尾的文件。NAnt copy 和 xcopy 都提供了简单的方法来做到这一点。

# javascript - 在 IE8 中使用 http URL 在 https 页面中导入 js 文件

> ID：776639
> 
> 赞同：1
> 
> 时间：2009-04-22T10:59:48.303
> 
> 标签：javascript, internet-explorer

好像在IE8中，如果使用https协议的页面需要导入一个.js文件，那么.js文件也需要使用https协议。

```
<script type="text/javascript" src="http://xxx/yourjs.js"></script> 
```

适用于除 IE8 以外的所有浏览器

```
<script type="text/javascript" src="https://xxx/yourjs.js"></script> 
```

适用于所有浏览器

我正在使用一个导入多个 .js 文件的用户控件。这意味着如果一个页面使用 https 协议，那么我必须更改用户控件，以便所有导入的 .js 文件都使用 https 协议。

你如何解决这个问题？
您如何评论这种 IE8 行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T11:03:19.437

在 HTTPS 上使用它

```
<script type="text/javascript" src="http://xxx/yourjs.js"></script> 
```

应该在所有浏览器中向用户发出警告——我希望 IE8 也会这样做，但也许这是一个新的“功能”，可以默默地忽略它。

您应该使用与请求相同的协议，或者始终使用 HTTPS 失败（尽管这对用户来说会更慢并且会给您的服务器带来更多负载）。

您可以指定不带方案的 URL - 应该使用当前的 URL（http 或 https）：

```
<script type="text/javascript" src="//xxx/yourjs.js"></script> 
```

编辑：发现参考说这是有效的：[RFC 2396](http://www.ietf.org/rfc/rfc2396.txt)

> ```
>  relativeURI   = ( net_path | abs_path | rel_path ) [ "?" query ] 
> ```
> 
> 以两个斜线字符开头的相对引用称为
> 网络路径引用，如第 3 节中所定义。这种
> 引用很少使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T11:39:14.043

这是正确的行为。您不希望非安全资源成为安全页面的一部分。在以前的 IE 版本中会显示警告，但我想感觉是太多人只是说“继续”而不知道其含义是什么。错误现在是静默的。您可以调整您的安全设置，但这只会修复您的浏览器（正如我所提到的，这不是一个好主意）。

确保您的页面资源在您的安全页面上都是安全的。（图片、Iframe 资源、脚本……很多！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:03:39.263

您确定这与使用混合内容安全设置无关吗？

可能值得检查您的浏览器设置，以查看您正在运行的区域设置为。

不过老实说，我喜欢我访问的网站保持一致，所以我希望通过 https 检索您的 javascript 文件。

# jquery - IE7 和 8 不会为附加在表格中的元素触发 jQuery 单击事件

> ID：776640
> 
> 赞同：13
> 
> 时间：2009-04-22T11:00:06.353
> 
> 标签：jquery, css, internet-explorer-8, internet-explorer-7

我有一个 IE 错误，我不确定如何修复。

使用 jQuery，我动态移动菜单以在鼠标悬停时出现在元素上。

我的代码（简化）如下所示：

```
$j = jQuery.noConflict();

$j(document).ready(function()
{
    //do something on the menu clicks
    $j('div.ico').click(function() { alert($j(this).parent().html()); });

    setUpActions('#tableId', '#menuId');
});

//on mouseover set up the actions menu to appear on mouseover
function setUpActions(tableSelector, menuSelector)
{
    $j(tableSelector + ' div.test').mouseover(function()
    {
        //note that append will move the underlying
        //DOM element with all events from it's old
        //parent to the end of this one.
        $j(this).append($j(menuSelector).show());
    });
} 
```

在 IE7、IE8 和 IE8-as-IE7 中移动后，该菜单似乎没有为菜单正确注册事件（是的，MS，这确实是 IE8 中的“新渲染引擎”，我们都相信你）。

它在其他所有方面都按预期工作。

您可以在**[此处查看基本演示](http://keithhenry.googlepages.com/WeirdIEbug.htm)**中的行为。

在演示中，您可以看到该问题的两个示例：

1.  按钮后面的图像应在悬停时更改（使用 CSS :hover 选择器完成）。它在第一次鼠标悬停时有效，但随后仍然存在。
2.  click 事件不会触发 - 但是使用开发工具您可以手动调用它并且它仍然被订阅。

可以在 IE8 的开发工具中看到（2）：

1.  在 IE8 中打开[页面](http://keithhenry.googlepages.com/WeirdIEbug.htm)
2.  打开开发工具
3.  选择“脚本”选项卡和“控制台”子选项卡
4.  类型：`$j('#testFloat div.ico:first').click()`手动调用任何订阅的事件
5.  页面会有提示

这意味着我*不会*丢失事件订阅，它们仍然存在，当我单击时，IE 只是没有调用它们。

有谁知道为什么会出现这个错误（不仅仅是因为 IE 的古老引擎）？

有解决方法吗？

会不会是我做错了什么，只是碰巧在其他所有事情上都按预期工作？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T09:00:09.717

奇怪的是，虽然您的点击事件没有在 IE 中触发，但如果您将其更改为 mousedown 或 mouse up 它会按预期工作，尽管您仍然存在图像悬停问题。

```
$j('div.ico').mouseup(function() { alert($j(this).parent().html()); }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-01T11:14:11.577

我有同样的问题，但以前的解决方案都没有奏效。问题原来是 IE7（我没有测试过其他版本的 IE）不会注册 .click 如果它被链接在一个动画函数之后。所以这**不起作用**：

```
$("div.menubar-item").animate({
    color:"#000"
}, 0)

.click(function()
{
    //not firing
}) 
```

但这会**起作用**

```
$("div.menubar-item").click(function()
{
    //firing!
})

$("div.menubar-item").animate({
    color:"#000"
}, 0) 
```

**编辑**：mouseenter、mouseleave 等也是如此。

**编辑 2**：如果您在点击后链接动画功能，它仍然会触发事件和动画，所以这也是“有效的”：

```
$("div.menubar-item").click(function()
{
    //firing!
})

.animate({
    color:"#000"
}, 0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T04:07:42.890

IE 不会将事件复制到动态附加到 DOM 的项目。

添加需要绑定的内容或使用 .live() 后尝试绑定点击事件

如果您正在使用 clone()，请记住传递 clone(true) 以显式请求复制事件处理程序。

```
var actionMenu = $j(menuSelector);

//actionMenu is now an Instance of jQuery, not the DOM object
//because jQuery is chainable

actionMenu.hide();

// notice the clone(true)

$j(this).append( actionMenu.clone(true) ); 
```

jQuery 是可链接的，因此您也可以用“jQuery”语法将其编写为：

```
var clone = $j(menuSelector)
               .clone(true)
               .css('background-color', $j(this).css('background-color') );

$j(this).append(clone); 
```

我认为您不需要显示/隐藏，因为它发生得如此之快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T11:03:41.133

我强烈建议使用最新的 jquery 中的 Live 事件。

这样你可以通过css类绑定到一开始没有创建的元素，但是当添加新元素时会添加点击绑定：

[http://docs.jquery.com/Events/live](http://docs.jquery.com/Events/live)

# c# - C#中的多对多对象到对象关系

> ID：776645
> 
> 赞同：8
> 
> 时间：2009-04-22T11:00:33.810
> 
> 标签：c#, .net, oop, object-oriented-database

我正在做一个小型教育项目来锻炼 perst.net。

我们有一个很小的设计问题，就是如何最好地解决两类对象之间的关系，即*参与者*和*冠军*。这是一个多对多的关系，因为*参与者*可以参加许多*锦标赛*，而*锦标赛*可以有多个*参与者*。

请告知如何在 C# 中做到最好，我应该使用“类似关系数据库”的技术课程吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-22T11:15:57.987

如果您正在寻找面向对象（或领域驱动设计）的方法，那么处理“连接”的第三个对象是完全错误的方法。您可以使用 ILists / Enumerables 和 Add... 方法来处理此问题，如下所示：

```
public class Participant
{
    private readonly IList<Championship> _championships = new List<Championship>();

    public IEnumerable<Championship> Championships
    {
        get { return _championships; }
    }

    internal void AddChampionship(Championship championship)
    {
        if (!_championships.Contains(championship))
            _championships.Add(championship);
    }
}

public class Championship
{
    private readonly IList<Participant> _participants = new List<Participant>();

    public IEnumerable<Participant> Participants
    {
        get { return _participants; }
    }

    public void AddParticipant(Participant participant)
    {
        if (_participants.Contains(participant)) return;
        _participants.Add(participant);
        participant.AddChampionship(this);
    }
} 
```

这里的关键是确保您仅从一侧管理关系 - 例如，在这种情况下，将通过调用 Championship.AddParticipant()

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T11:13:28.117

您可以使用 IEnumerable（或其他一些集合）属性建立任何关系，其中特定项目可以具有与其关联的多个项目。在您的示例中，这将如下所示：

```
class Participant {
   public IEnumerable<Championship> Championships { 
      get {
         return _championships;
      }
   }
   private List<Championship> _championships;
} 
```

一些重要的事情要记住：

*   始终将此设置为只读属性。这有时会让人们感到困惑，特别是如果你有一些可修改的东西，比如返回的 ICollection 而不是 IEnumerable。将属性设置为只读不会阻止修改*集合*，但会修改*整个列表*。

*   加载策略 - 您会注意到在上面的示例中集合没有初始化。您通常在构造函数中或第一次访问属性时执行此操作（称为延迟实例化） - 一般而言，延迟实例化会增加一些复杂性，但可以提高性能，特别是如果此集合不经常使用或您有很多此类特性。

*   一般来说，在多对多的情况下，选择一个类来“持有”另一个类是一个好主意（即参与者有冠军属性，但冠军没有参与者属性，反之亦然）。这减少了您必须编写的代码量，并减少了数据库的复杂性和表面积。如果另一个方向需要调用，请考虑方法调用而不是属性。请记住，关系意义上的多对多并不一定意味着这是常见的用例（作为用户，我可能只想将参与者添加到锦标赛而不是锦标赛到参与者）

*   如果您的收藏是可修改的，请记住，发送 Save 意味着它下面的收藏也应该被修改，如果它们被更改。这会增加很多复杂性（过去，我使用内部列表来存储添加/删除的项目）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T11:12:07.713

我不确定这是否适合您的设计或要求，但有可能......

显然，多对多关系最容易用管理该关系的第三个对象来表示。在您的情况下，它将是一个*冠军参与者*。与其在您的参与者类中拥有一个持有冠军的集合，反之亦然，而是让他们持有这个第三类的实例。Championparticipant*对象*管理这种关系。然后可以将其作为联结表直接序列化到数据库中。

# sql-server - SQL Server - 读取同一事务的未提交更改时的不一致行为

> ID：776653
> 
> 赞同：1
> 
> 时间：2009-04-22T11:02:11.917
> 
> 标签：sql-server, transactions, snapshot-isolation

使用具有隔离级别“读取提交快照”的 SQL 服务器，我们经常将数据写入数据库并在同一事务的上下文中进一步读取它。通常从数据库中读取时，我们会看到我们自己未提交的更改，但只有其他人所做的已提交更改。我们假设这是预期的行为。

我们现在发现，在一些相对罕见的情况下，我们看不到我们已经写入的值——只有以前提交的值。

任何想法可能导致不一致？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T11:22:54.693

有一些关于可能出错的好文章。也许他们可能会有所帮助

[Craig Freedman，Serializable vs. Snapshot Isolation Level](http://blogs.msdn.com/craigfr/archive/2007/05/16/serializable-vs-snapshot-isolation-level.aspx) 黑色/白色大理石类比

[Hugo Kornelis，4 篇文章“快照隔离：对完整性的威胁”](http://sqlblog.com/blogs/hugo_kornelis/archive/tags/Isolation/default.aspx)：DRI/FK 默默地更改为不同的隔离级别

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T13:35:19.003

事实证明，这是 SQL Server 中已知的不一致：当您从数据库中读取时，通常会看到您自己的事务未提交的更改（在所有隔离级别中），但这并不总是得到保证。在我的情况下，解决方法是使用`with (readuncommitted)`, 信任一种应用程序级锁定机制，以防止对相同数据的并发修改。

我从两位独立的数据库专家那里得到了同样的答案。不幸的是，我没有找到任何关于这个问题的书面参考。

# vb6 - 如何正确计算桌子的高度

> ID：776656
> 
> 赞同：0
> 
> 时间：2009-04-22T11:02:43.710
> 
> 标签：vb6, msflexgrid

如何计算 VB6 中 flexgrid 表的高度，使其仅包含填充的行数。

目前

```
myFlexGrid.Height = (myFlexGrid.CellHeight * myFlexGrid.Rows) ' paraphrased from code 
```

每行短约 3 个像素。添加幻数有点骇人听闻，并且希望无需求助即可完成此操作。

**更新：** 为了使事情复杂化，它还需要处理多行单元格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T14:14:16.077

RS Coneley 很接近，但这里是解释所有 DPI 设置的正确方法：

```
Me.MSFlexGrid1.Height = Me.MSFlexGrid1.CellHeight _
                      * (Me.MSFlexGrid1.Rows + Me.MSFlexGrid1.FixedRows) _
                      + (Screen.TwipsPerPixelY * 2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:29:08.107

你需要去

```
Me.MSFlexGrid1.Height = (Me.MSFlexGrid1.CellHeight) * (Me.MSFlexGrid1.Rows + _
Me.MSFlexGrid1.FixedRows) + 30 
```

30 是让它长两个像素，以显示围绕 flexgrid 运行的黑色边框。

禁用垂直滚动条也有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T09:01:46.910

这是我想出的最终代码

```
 For i = 0 To fgrComments.Rows - 1
        'Set MSFlexGrid to appropriate Cell
        myFlexGrid.Row = i

        'Set textbox to match the selected cell
        txtSizer.Width = myFlexGrid.ColWidth(2)
        txtSizer.Font = myFlexGrid.Font
        txtSizer.Text = myFlexGrid.Text

        'Call API to determine how many lines of text are in text box
        lLinesOfText = SendMessage(txtSizer.hwnd, EM_GETLINECOUNT, 0&, 0&)

        ' Update the running values
        lTotalNumberOfRows = lTotalNumberOfRows + lLinesOfText
        lCurrentHeight = lCurrentHeight + myFlexGrid.CellHeight
    Next i

    ' resize the grid
    Dim iSpacers As Integer
    iSpacers = Screen.TwipsPerPixelY * lTotalNumberOfRows
    myFlexGrid.Height = lCurrentHeight + iSpacers 
```

您将需要声明 SendMessage（[请参阅此处了解如何](http://vbcity.com/forums/topic.asp?tid=64808)）和 EM_GETLINECOUNT 的值，但您应该能够自己执行此操作:-)

它不会删除神奇的数字，但它确实使它们合理化，这对我来说已经足够接近了。

# smalltalk - Smalltalk 中的图像间通信。可能的？

> ID：776658
> 
> 赞同：6
> 
> 时间：2009-04-22T11:03:26.767
> 
> 标签：smalltalk, concurrency, squeak

我有一个图形遍历问题，它在 smalltalk 中精美而优雅地建模，但是对于一个 smalltalk 图像实例来说它太大了（在计算和存储方面）。因此，我想将问题划分为多个实例。

我的问题是，有什么好方法可以在 smalltalk 实例之间发送消息。有点像 MPI，但用于 smalltalk。

我应该提到我在 Squeak 上，但如果这个功能有点小谈话的味道，我可以应付。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T11:36:43.067

有一个名为 Hydra 的项目正在进行中，目标是让 Squeak 具备多核功能。Hydra 的主要功能之一也是图像间通信通道。

更多信息：

*   [Qwaq 发布 Hydra 多核 Squeak VM](http://news.squeak.org/2008/02/21/qwaq-releases-hydra-multi-core-squeak-vm/)
*   [HydraVM 开发笔记](http://squeakvm.org/~sig/hydravm/devnotes.html)
*   [[squeak-dev] [ANN] Hydra 现在可以进行有丝分裂](http://www.nabble.com/-squeak-dev---ANN--Hydra-now-can-do-mitosis-td22146618.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-22T12:28:45.970

看看[远程 Smalltalk](http://www.squeaksource.com/rST.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-24T13:42:44.827

[Open Croquet](http://www.opencroquet.org/)在概念上是一组相互通信的 Smalltalk 图像。也许它和它的岛屿可能很合适？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-01T08:01:17.010

为了完整起见，我敢于提及来自 Cincom VisualWorks 的 OpenTalk 库。OpenTalk 的主要优势在于，在许多情况下，您只需将其放入，其余代码就可以在网络上运行。它的基本思想是用本地代理替换远程对象并将消息发送到图像。

Cincom 的 VisualWorks 页面：[http ://www.cincomsmalltalk.com/main/products/visualworks](http://www.cincomsmalltalk.com/main/products/visualworks)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-03T09:47:49.350

在 Esug2012，Nick Papoulias 展示了[无缝](http://ss3.gemstone.com/ss/Seamless.html)。将运行工具的环境与开发映像分开是 Pharo 努力的一部分。

# c++ - 行进立方体问题

> ID：776664
> 
> 赞同：6
> 
> 时间：2009-04-22T11:05:20.570
> 
> 标签：c++, opengl, 3d, rendering, volume

我目前正在编写一个程序来使用 C++ 和 Opengl 实现 Marching Cube。

但是，我最好的参考仅来自[http://local.wasp.uwa.edu.au/~pbourke/geometry/polygonise/](http://local.wasp.uwa.edu.au/~pbourke/geometry/polygonise/)

在网络上，提供的代码是用 C 编写的。
我的问题是我不了解 triTable 和 edgeTable
以及它们之间的关系。

谁能帮助我解释或指导我将算法转换为代码？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-22T11:18:17.013

这些表用于找出如何细分曲面：

第一个表为您提供了插值所需的边。第二个表格为您提供了镶嵌的方式，即您必须在立方体内制作哪些三角形。

一个小例子：

假设，顶点 1 和 2 低于 iso 水平，cubeindex 应该是 3。

整个交叉点应该看起来像一个楔子。

如果您考虑一下，您必须在边缘上插值：0 和 9 以及 2 和 10。如果将其输入位域，则每个位对应于“边缘相交吗？” 你最终会得到这样的东西：

```
10 9 8 7 6 5 4 3 2 1 边
 1 1 0 0 0 0 1 0 1 0 相交？

```

你不会吗？

这正是 edgeTable[3] 的二进制值；) 0x30A = 1100001010

现在您可以编写一个函数，对这些边缘上的点进行线性插值以适合您的等值线。这些点将成为您在此单元内的表面。

但是如何镶嵌这个细胞/表面呢？

如果您查看 triTable[3]，您的脸上应该会浮现微笑 :)

在评论中的剩余困惑陈述之后添加：;-)

Marching Cubes 的作用：想象你有一个黑暗的房间，里面有一个点光源。它是标量强度值的体积光强度场的中心。您可以转到点 (x,y,z) 并测量那里的强度，例如 3 坎德拉。

您现在想要通过所有具有特定光强度的点来渲染表面。您可以想象这个等值面看起来像一个围绕点光源的球体。这就是我们希望Marching cubes 能够为我们提供的。

现在遍历房间中的所有点并将每个点标记为具有大致 iso 值的顶点，这在算法上将非常复杂，并且会导致大量顶点。然后我们必须以某种方式进行镶嵌。

所以：First Marching cubes 将整个体积分割成相同大小的立方体。如果基础数据具有某种基础离散性，则使用其倍数。我不会讨论另一种情况，因为这种情况很少见。比如我们把一个密度为 1mm 的网格放到一个 2mx5mx5m 的房间里

我们使用 5mmx5mmx5mm 的立方体。穿过它们应该便宜得多。

您现在可以想象，一些立方体的边缘与等值面相交。这些是有趣的。此代码标识它们：

```
立方体索引 = 0;
   如果 (grid.val[0]
```

如果 cubeindex 保持为零，则此特定立方体不会与等值面相交。如果 cubeindex > 0，您现在知道等值面穿过这个立方体，并且您想要渲染它内部的等值面。

请在你的脑海中想象一下。有关相交立方体的示例，请参见 [http://en.wikipedia.org/wiki/Marching_cubes](http://en.wikipedia.org/wiki/Marching_cubes) 。

您可以轻松获得的顶点是立方体边缘的顶点。只需在 2 个角点之间进行线性插值即可找到等值的位置并将顶点放在那里。但是哪些边相交？？？也就是 edgeTable[cubeindex] 中的信息。这是包含所有 if 的一大段代码，它将插值点作为顶点存储在 xyz 点数组中：vertlist[]。这篇文章如下：

```
获取位域 = edgeTable[cubeindex]
 如果在位域中标记边缘 1（位域中的位 1 设置为 1）
    vertlist[0] = 插值点，位于边 1 的某处
... 等等。

```

您现在有一个充满顶点的数组，但是如何将它们连接到三角形？这是 tritable 提供的信息。

其余的几乎就是我上面解释的内容。

那么如果仍然存在问题，请具体说明给您带来麻烦的代码。

# c# - ASP.NET 中的页面刷新

> ID：776665
> 
> 赞同：2
> 
> 时间：2009-04-22T11:05:34.657
> 
> 标签：c#, asp.net

保存对话框将文件保存到本地机器。但在那之后，我的页面就站在那里，在我的其余过程中什么也不做。我使用下面的代码打开一个保存对话框

```
protected void lnkbtnDownload_Click(object sender, EventArgs e)
{
  string fileName = startupPath + "bin\\Inbox.mdb";
  System.IO.FileInfo targetFile = new System.IO.FileInfo(fileName);

  if (targetFile.Exists)
  {
      Response.Clear();
      Response.AddHeader("Content-Disposition", "attachment; filename=" + targetFile.Name);
      Response.AddHeader("Content-Length", targetFile.Length.ToString());
      Response.ContentType = "application/octet-stream";
      Response.WriteFile(targetFile.FullName);                        
      Response.End();
  }
} 
```

html代码是：

```
<asp:Button id="lnkbtnDownload" runat="server" CausesValidation="false" 
  Text="Download" CssClass="buttonstyle"  OnClick="lnkbtnDownload_Click"></asp:Button> 
```

但是在文件保存到本地机器并且保存对话框关闭后，我的页面根本没有响应。保存对话框关闭后，我可以知道如何回发到页面吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-22T11:14:03.590

因为您正在调用 Response.End，所以这会停止页面的响应。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-23T23:45:51.307

将此代码放在 HttpHandler 中，然后从原始页面链接到该处理程序，传递处理程序所需的任何信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-22T11:10:26.673

我认为您应该打开一个执行此 Response.WriteFile 操作的弹出页面/处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-26T11:14:07.867

Mark Brackett 对类似问题的[回答](https://stackoverflow.com/questions/309979/asp-net-webforms-postback-then-open-popup "回答")在这里应该有效，但您不需要跨页回发 url 属性：

```
<script type="text/javascript">
   var oldTarget, oldAction;
   function newWindowClick(target) {
      var form = document.forms[0];
      oldTarget = form.target;
      oldAction = form.action;
      form.target = target;

      window.setTimeout(
         "document.forms[0].target=oldTarget;"
         + "document.forms[0].action=oldAction;", 
         200
      );
   }
</script>

<asp:LinkButton runat="server" id="lnkbtnDownload"
  CausesValidation="false" Text="Download" CssClass="buttonstyle" 
  OnClick="lnkbtnDownload_Click"
  OnClientClick="newWindowClick('download');" /> 
```

这将导致回发发生在新窗口中，并且您现有的响应处理将负责下载。为将来的交互/回发恢复原始窗口表单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T11:13:48.520

我想说您可以在 iframe 中运行此代码，或者您可以打开一个弹出窗口来触发文件下载。在这种情况下，您将覆盖响应，并且您希望加载的页面丢失。

因此，我会将这段代码移动到一个专用页面并实现上述两种解决方案之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T08:14:54.123

您不能用 2 个响应来回答单个请求（即按钮回发）。

但是，您可以将回发更改为重定向到单独的下载/确认页面，然后使用 iframe 启动下载。

看到[这个问题](https://stackoverflow.com/questions/156686/how-to-start-automatic-download-of-a-file-in-ie)

# oop - 如果不多次调用它们，您是否应该将代码重构为私有方法？

> ID：776666
> 
> 赞同：8
> 
> 时间：2009-04-22T11:05:47.370
> 
> 标签：oop, coding-style, scope, private

是否值得为仅在类中调用一次的代码提取私有方法，或者将代码留在父方法中（可能）并带有注释说明它的作用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-22T11:07:14.870

*如果它阐明了代码的意图，那么提取方法总是值得的。*

对于非常长的方法尤其如此。虽然评论很好，但它们并没有描述（至少不是以非常可靠的方式）它解释的过程在哪里结束以及下一个过程从哪里开始。有时，在您提取方法*之后*，常见的抽象只会变得更加明显。

如果您从事自动化单元测试（不一定是 TDD），那么对较小的方法块进行单元测试也会容易得多——尽管您可能必须为此公开您的方法，具体取决于您使用的测试框架.

关键是，较小的方法不会出错，尤其是当它们具有描述性名称时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T11:08:56.957

这样做有很大的好处。这完全是关于隐藏信息，并使意图非常明确。

在 Refactoring to Code 中，他们称之为组合方法，您可以将一个大方法分解为许多较小的方法。这有两件事。

首先，它减少了在处理父方法时需要担心的信息量。

其次，方法的名称应表明其意图，使代码更具可读性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T11:09:45.770

是的。

*   如上所述：它通常会阐明代码的意图。
*   即使*现在*只用一次，以后也可以更方便地重用代码。

补充一点：对于简单的辅助方法，您可能希望将它们设为静态（这样它们不依赖或更改其实例的状态），然后您可以将它们公开以便更容易重用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T11:11:00.930

对我来说，这取决于代码有多大，以及它与父方法的作用有多相关。如果代码很多（比如超过 5-10 行代码，或者超过父方法中代码总量的 50%），我会将其提取到私有方法中，以提高代码结构和可读性。否则，我会将其保留在带有描述性注释的父方法中。

我认为如果代码中有太多非常小的方法，可维护性和可读性会降低。我争取一个良好的平衡。但每当我怀疑时；我将其提取为私有方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T12:13:31.077

您应该根据您在其他地方使用时要公开的 API 和方法/属性的设计，将其重构为私有。您不应该考虑使用它来决定是否将其设为私有/公开。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-22T11:21:47.237

只是一个愚蠢的估计，但我想说大多数私有方法只在普通班级的几个地方被调用。但是，如上所述，如果您将所有功能分解为逻辑块，它会使您的代码更具可读性并且更易于测试/维护。重构是个好习惯

# java - Java 网络启动： 使用时忽略 ?

> ID：776667
> 
> 赞同：2
> 
> 时间：2009-04-22T11:06:40.300
> 
> 标签：java, java-web-start, jnlp

我在 Java 6 u 13（目前最新）下对 Java WebStart 应用程序进行现代化改造时遇到问题

我们希望使用新机制来拥有几个主配置文件，每个配置文件都有自己的配置，然后“包含”另一个自动生成的 jnlp 文件，以确保 jar 列表是准确的。经过相当多的戳，我已经使它工作，除了主文件中定义的属性在调用 Main 时对程序不可用的事实。

主 JNLP 看起来像（匿名）：

```
<jnlp>
  <information>
    <title>...</title>
    <vendor>...</vendor>
    <description>...</description>
    <description kind="short">...</description>
    <homepage href="http://....jnlp"/>
    <icon href="http://....gif"/>
    <!--          <offline-allowed/> -->
  </information>
  <security>
    <all-permissions/>
  </security>
  <resources>
    <j2se version="1.6+"/>
    <extension href="http://...extension.jnlp" />

    <property name="server.name" value="SERVER"/>
  </resources>
  <application-desc main-class="Main"/>
</jnlp> 
```

并且 extension.jnlp 看起来像：

```
<!-- Generated automatically.  Do not edit! -->
<jnlp>
  <information>
    <title>extension built 2009-04-22 12:39:58 CEST</title>
    <vendor>...</vendor>
  </information>
  <security><all-permissions/></security>
  <resources>
    <jar href="A.jar" />
    <jar href="B.jar" />
    <jar href="logback-classic-0.9.14.jar" />
    <jar href="logback-core-0.9.14.jar" />
    <jar href="slf4j-api-1.5.6.jar" />
  </resources>
  <component-desc />
</jnlp> 
```

我也尝试将属性放在 extension.jnlp 中。没有帮助。根据 Java Plugin Console 中的日志，JVM 被重用而不是重新启动。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T15:34:29.770

我正在努力解决同样的问题。
当我将`<property>`元素移动到扩展 jnlp 时，它可用于使用`System.getProperty()`.

但这对我来说不是一个解决方案，因为我想要扩展 jnlp，其中包含在 mastet jnlp 中定义的所有 jar 和属性。

看起来，

> 对于不受信任的应用程序，JNLP 文件中设置的系统属性只有在被认为是安全的情况下才会由 Java Web Start 设置。

如果想将自己的属性传递给 VM，那么它们的名称必须以`javaws.`or开头`jnlp.`。这些属性被认为是安全的。`<property>`元素必须包含`value`属性，例如

```
<property name="jnlp.my.property" value="a value" /> 
```

链接：

1.  [http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/developersguide/syntax.html#resources](http://docs.oracle.com/javase/6/docs/technotes/guides/javaws/developersguide/syntax.html#resources)
2.  [http://docs.oracle.com/javase/tutorial/deployment/doingMoreWithRIA/settingArgsProperties.html](http://docs.oracle.com/javase/tutorial/deployment/doingMoreWithRIA/settingArgsProperties.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-02T08:00:04.177

通过实验，我发现扩展文件中定义的属性比主 jnlp 文件中的属性要严格得多，并且那些不符合规则的属性会被默默地丢弃。

# javascript - 通过 javascript 打开 Outlook

> ID：776672
> 
> 赞同：3
> 
> 时间：2009-04-22T11:07:37.553
> 
> 标签：javascript, activex

有谁知道如何使用 Javascript 打开 Outlook？

使用此代码时出现异常（在 IE6 中）：

```
var outlookApp = new ActiveXObject("Outlook.Application"); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-22T11:14:01.610

您绝对可以这样做，代码如下所示：

```
var objO = new ActiveXObject('Outlook.Application');     
var objNS = objO.GetNameSpace('MAPI');     
var mItm = objO.CreateItem(0);     
mItm.Display();     
mItm.To = p_recipient;
mItm.Subject = p_subject;
mItm.Body = p_body;     
mItm.GetInspector.WindowState = 2; 
```

p_recipient、p_subject 和 p_body 是变量，传入。

您需要确保它在用户信任的网页上运行，否则会导致异常。
也就是说，它需要位于 IE 中的正确区域，并为该区域配置正确的设置。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-22T11:18:17.357

出于非常明显的安全原因，您无法通过 JavaScript 打开桌面应用程序。您给出的示例使用[ActiveX](http://en.wikipedia.org/wiki/ActiveX)，它是一种专有的 Microsoft 技术，仅在 Internet Explorer 中可用。

如果您只是想在用户电子邮件客户端中打开预先填写字段的消息组合，您可以使用[mailto:](http://www.google.co.uk/search?q=mailto)超链接前缀。这允许您指定收件人、主题和正文。例子：

```
<a href="mailto:me@domain.com?subject=You can specify subject too"> 
```

除非您需要专门使用 Outlook（如果是这种情况，我建议您可能需要重新审视您的要求），否则最好打开用户设置的任何默认电子邮件客户端。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-28T06:42:30.373

我似乎记得 Outlook 注册了它自己的 URI 方案（！），因此`outlook:`如果您真的想要这样做，您实际上可以从表单的超链接非常简单轻松地打开它。不幸的是，我不再拥有 Outlook 的副本，而且我已经尝试了很多年，所以我无法验证它是否仍然有效。

编辑补充：嗯！该链接在预览中显示为链接，但不在实际发布的答案中。无论如何，这里有一些 HTML 代码来阐明我的意思：

```
<a href="outlook:">Click here to launch Microsoft Outlook</a> 
```

# asp.net-mvc - POST动作方法的参数绑定

> ID：776673
> 
> 赞同：0
> 
> 时间：2009-04-22T11:07:52.513
> 
> 标签：asp.net-mvc, controller

您可以看到**GET Delete**操作方法将 DDW2File 对象传递给查看。是否可以以某种方式将此对象绑定回**POST Delete操作方法的****ddw2file**参数？现在我**有空值**。

 ****代码片段：

```
public class DDW2FileController : Controller
{
    ...

    public ActionResult Delete(string fileName)
    {
        return View(repository.GetFile(fileName));
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Delete(DDW2File ddw2file)
    {
        repository.Delete(file);
        return RedirectToAction("Index");
    }
}

...

public class DDW2File
{
    public string Name { get; set; }
    public long Length { get; set; }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T11:21:26.100

假设您的参数名称是 ddw2file 根据您在那里的签名，视图中的表单内的类似内容应该可以工作。

```
<%=Html.TextBox("ddw2file.Name")%>
<%=Html.TextBox("ddw2file.Length")%> 
```

# authentication - 使用 OAuth 进行服务器到服务器身份验证？

> ID：776679
> 
> 赞同：27
> 
> 时间：2009-04-22T11:09:52.260
> 
> 标签：authentication, authorization, oauth

我目前正在努力指定我公司的新合作伙伴/公共 API，这将是一个面向资源的 RESTful Web 服务。目前缺少的一块拼图是身份验证/授权。

要求是：

1.  最初它必须适用于服务器到服务器的环境，例如，服务器应用程序必须能够识别自己，以便我们知道谁在调用 API。
2.  将来，我们希望允许它模拟用户帐户，因此除了被识别的服务器之外，它还将拥有一个在有限时间内代表用户帐户的令牌。

OAuth 似乎非常适合 (2) 的工作流程，即获取令牌、重定向到用户输入其凭据以对其进行授权的网站，然后使用该令牌来识别/验证应用程序和用户。

*但是，根据我的阅读，我不知道它是否适合 (1) - 即是否有任何*方法可以使用 OAuth来识别调用应用程序而无需有效的用户特定令牌，因此不需要被重定向到一个网页让他们输入他们的凭据？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-06T07:06:32.293

实际上有两种 OAuth 规范，三足版和两足版。三足版本是最受关注的版本。

2-legged 版本正是您最初想要的，它允许应用程序通过共享密钥（非常类似于 Amazon 的 Web 服务模型，您将使用 HMAC-SHA1 签名方法）或通过公共/私钥系统（使用签名方法：RSA-SHA1）。坏消息是，它还没有像 3-legged 版本那样得到很好的支持，所以你现在可能需要做更多的工作。

基本上，2-legged OAuth 只是指定了一种“签名”（计算散列）几个字段的方法，这些字段包括当前日期、一个称为“nonce”的随机数以及您的请求参数。这使得模拟对您的 Web 服务的请求变得*非常困难。*

OAuth 正在缓慢但肯定地成为这类事情的公认标准——如果你接受它，从长远来看，你会得到最好的结果，因为人们可以利用各种可用的库来做到这一点。

让 2 条腿和 3 条腿同时工作现在有点棘手 - 但这是可能的（谷歌现在已经开始工作了）。 [http://code.google.com/apis/accounts/docs/OAuth.html](http://code.google.com/apis/accounts/docs/OAuth.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-22T11:12:15.590

是的，可以将令牌的生命周期设置为不过期，直到您这样说。因此，您将（手动）完成身份验证和授权，并保存授权令牌以供以后使用。

（您可以使用[任何测试客户端](http://term.ie/oauth/example/client.php)来帮助您完成该手动部分，或者在您自己实现服务器时：使用所谓的两足 OAuth。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T16:39:11.783

如果它只是关于服务器到服务器的通信，我会考虑使用基于 API 密钥的授权 - 就像 bit.ly 或 FriendFeed。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-08T11:49:14.413

格雷格：

我一直在研究 OAuth 核心的扩展，我认为它可能会满足您的需求。我们想针对我们自己的 API 编写应用程序，但我们认为不允许我们自己的应用程序（作为服务提供者）直接从用户/消费者应用程序收集凭据没有多大意义——因为我们已经被认为是受信任的派对我们自己。

该扩展允许第一方、第二方，当然还有第三方（传统的 OAuth），同时使用协议提供的令牌和机密的安全性以及签名等。

可以在[此处](https://demo.staging.fellowshiponeapi.com/v1/Util/AuthDocs.help)找到我们关于扩展的 beta 文档。

# html - 覆盖其他元素

> ID：776682
> 
> 赞同：0
> 
> 时间：2009-04-22T11:10:48.717
> 
> 标签：html, treeview, overlay

我有一个树视图，当它可见时会在网页上占用太多空间。因此，要求用户单击一个按钮以使其可见:) 但是这里的问题是，当该树视图（位于元素内）可见时，它会将其他元素向下移动，但我希望它覆盖（类似于什么当我们单击下拉菜单时发生）：P

非常感谢任何指针或任何其他可能的解决方案。

谢谢你：P

PS：如果解决方案不涉及闪光灯或 SilverLight 控件会更好：P 因为仅一个控件的负载会太大！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T11:17:45.330

您可以使用 CSS 绝对定位元素或浮动它，这两者都可以将其从页面流中删除。

以下是 MDC 对该`float`物业的评价（见[此处](https://developer.mozilla.org/En/CSS/Float)）：

> float 属性指定一个元素应该从正常流中取出并放置在其容器的左侧或右侧，文本和内联元素将环绕它。

以下是 MDC 所说的`position: absolute`（请参阅[此处](https://developer.mozilla.org/en/CSS/position#Values)）：

> 不要为元素留出空间。相反，将其定位在相对于其最近定位的祖先或初始包含块的指定位置。

史蒂夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:19:09.833

在 CSS 中将元素的位置设置为绝对

位置：绝对；

[http://www.w3schools.com/Css/pr_class_position.asp](http://www.w3schools.com/Css/pr_class_position.asp)

# wpf - 如何使这个 Xaml 成为模板？

> ID：776683
> 
> 赞同：1
> 
> 时间：2009-04-22T11:10:49.743
> 
> 标签：wpf, templates, xaml, refactoring

不使用代码，我怎样才能把它变成一个模板？

我有大约 10 个，而且我的代码越来越大。它工作得很好，我只是在寻找清理代码的方法，我只是对模板和资源动画和触发器不够熟悉来做到这一点。

提前致谢。

```
 <RadioButton Width="35" Height="35" Content="RadioButton" Visibility="Visible" IsChecked="False" Margin="2.5,2.5,2.5,2.5" Template="{DynamicResource RadioTemplate}" >
        <RadioButton.Resources>
            <ControlTemplate x:Key="RadioTemplate" TargetType="{x:Type RadioButton}">
                <BulletDecorator Background="Transparent">
                    <BulletDecorator.Bullet>
                        <StackPanel>
                            <Image Width="Auto" Height="Auto" Source="..\Content\img.png" Stretch="Fill" />
                        </StackPanel>
                    </BulletDecorator.Bullet>
                </BulletDecorator>
            </ControlTemplate>
        </RadioButton.Resources>
        <RadioButton.BitmapEffect>
            <OuterGlowBitmapEffect x:Name="imageGlow" GlowColor="#FFeeba00" Opacity="1" GlowSize="0" />
        </RadioButton.BitmapEffect>
        <RadioButton.Triggers>
            <EventTrigger RoutedEvent="ToggleButton.Checked">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation Storyboard.TargetName="imageGlow" Storyboard.TargetProperty="GlowSize" From="0" To="10" Duration="0:0:.15" AutoReverse="False" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
            <EventTrigger RoutedEvent="ToggleButton.Unchecked">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation Storyboard.TargetName="imageGlow" Storyboard.TargetProperty="GlowSize" From="10" To="0" Duration="0:0:.15" AutoReverse="False" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </RadioButton.Triggers>
    </RadioButton> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T12:09:12.850

您需要创建一种样式。

```
<Style x:Key="RadioStyle" TargetType="{x:Type RadioButton}">
    <Setter Property="Width" Value="35"/>
    <Setter Property="Height" Value="35"/>
    <Setter Property="Margin" Value="2.5"/>
    <Setter Property="BitmapEffect">
        <Setter.Value>
            <OuterGlowBitmapEffect GlowColor="#FFeeba00" Opacity="1" GlowSize="0" />
        </Setter.Value>
    </Setter>
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type RadioButton}">
                <BulletDecorator Background="Transparent">
                    <BulletDecorator.Bullet>
                        <StackPanel>
                            <ContentPresenter/>
                        </StackPanel>
                    </BulletDecorator.Bullet>
                </BulletDecorator>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
<!--Continued--> 
```

其余的（SO似乎切断了长代码片段）：

```
 <Style.Triggers>
        <EventTrigger RoutedEvent="ToggleButton.Checked">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="BitmapEffect.GlowSize" From="0" To="10" Duration="0:0:.15" AutoReverse="False" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="ToggleButton.Unchecked">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="BitmapEffect.GlowSize" From="10" To="0" Duration="0:0:.15" AutoReverse="False" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Style.Triggers>
</Style> 
```

对于每个按钮，您将拥有如下内容：

```
<RadioButton Style="{DynamicResource RadioStyle}" Visibility="Visible" IsChecked="False">
    <Image Width="Auto" Height="Auto" Source="..\Content\img.png" Stretch="Fill" />
</RadioButton> 
```

# linq-to-sql - LinqToSql 存储过程总是使参数可以为空。为什么？

> ID：776701
> 
> 赞同：1
> 
> 时间：2009-04-22T11:15:18.953
> 
> 标签：linq-to-sql, stored-procedures

每当我将存储过程拖放到上下文画布上时，存储过程的参数/参数都可以为空。

为什么是这样？是因为我如何在存储过程本身中声明我的参数吗？

除了在 Context 部分类中手动创建我的存储过程方法（或拖放到画布上，从自动生成的代码中剪切，移动到部分类，然后删除可为空的类型）.. 有没有办法解决这个问题？

这真的很令人沮丧:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T11:19:27.213

存储过程的参数始终可以为空（没有等效的“NOT NULL”子句可以添加到表中的列中），因此 Linq to SQL 几乎没有选择，只能在其生成的方法中反映这一点。

您最好的选择是检查（在过程本身中）是否已通过 NULL 并引发错误或将其替换为默认值。

# c# - 如何检查空值？

> ID：776703
> 
> 赞同：1
> 
> 时间：2009-04-22T11:15:31.573
> 
> 标签：c#, .net, subsonic

我有一个整数列，它可能有一个数字或没有分配给它（即数据库中的空值）。如何检查它是否为空？

我试过了

```
if(data.ColumnName == null)
{
    ...
} 
```

这也不起作用（因为 SubSonic 不对 ActiveRecord 使用可为空的类型（如果适用））

```
if(data.ColumnName.HasValue)
{
    ...
} 
```

如果存储在数据库中的值为 0，那么这将无济于事：

```
if(data.ColumnName == 0 /* or 0x000? */)
{
    ...
} 
```

DateTime 字段也可能出现同样的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T11:20:23.560

尝试：

如果（数据 == System.DBNull）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T13:13:53.163

了解如何做到这一点。SubSonic 有一种将值作为对象获取以允许空检查的方法：

```
if(data.GetColumnValue("Column Name") == null)
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:24:19.510

如果您的**数据**变量是强类型数据行，这可能会有所帮助：

```
if(data.IsNull("ColumnName")) { ... } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T12:20:13.307

DBNull 是空列的值。

DBNull 是一种值类型。值类型不能为空。

假设 SqlDataReader ...检查 null 是：

if (reader["colname") == DBNull.Value)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T13:26:18.313

查询数据库时处理那里的空值，使您在代码中的生活更轻松

SQL 示例

```
SELECT isNull(columnName, 0) FROM TABLENAME... 
```

或者

```
Select isNUll(columnName, 'N/A') FROM TABLENAME ... 
```

# fft - 快速傅里叶变换 - 多项式相乘？

> ID：776719
> 
> 赞同：2
> 
> 时间：2009-04-22T11:19:52.110
> 
> 标签：fft, multiplication

我只是不明白如何对两个多项式（例如 X^2+1 和 X+1）执行 FFT ......有人可以和我一起一步一步地完成这个过程吗？

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T12:16:04.643

只需使用您的多项式系数作为 fft 的输入：

```
octave:16> poly1=[1 0 1 0]
poly1 =

   1   0   1   0 
```

注意：这意味着 x^2+1

```
octave:17> poly2=[1 1 0 0]
poly2 =

   1   1   0   0

octave:18> ifft( fft(poly1).*fft(poly2))
ans =

   1   1   1   1 
```

这就是结果。解释为x^3+x^2+x+1，是两个多项式的乘积。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-27T06:41:31.067

但实际上这里发生的是卷积。

> ifft(fft(poly1).*fft(poly2))

相当于卷积（适当填充）。而卷积可以解释为两个多项式的乘法。去查一下卷积的定义（很简单），在纸上手工算出来。我希望它会为您提供很多关于这方面的信息......

保罗
中心空间软件

# c# - 运行与 Oracle 配合使用的 C# 程序时出错

> ID：776720
> 
> 赞同：1
> 
> 时间：2009-04-22T11:19:58.367
> 
> 标签：c#, oracle10g

我使用我的 C# 程序进行了设置（适用于 Oracle 10g）

当我尝试在不同的计算机上运行该程序时，我收到了以下错误消息：

无法加载 dll 'OraOps10.dll'

它可以是什么？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T11:35:23.757

如果您使用的是 Oracle ODP ( `Oracle.DataAccess.Client`) 而不是默认的 Microsoft ODP ( `System.Data.OracleClient`)，那么您必须先下载安装[Oracle 数据访问组件](http://www.oracle.com/technology/software/tech/windows/odpnet/index.html)，然后才能使用它。因此，安装 ODAC 必须是部署过程的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:30:14.050

要么没有安装 Oracle，要么由于某种原因找不到 oracle dll。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:34:38.470

我以前遇到过这个和各种 Oracle 错误。这通常是一个授权问题，当然前提是 Oracle 安装和配置正确。

找到“ORACLE_HOME”文件夹，右键单击并设置安全设置。确保 SYSTEM 帐户有权读取和执行文件夹中的文件以及所有子文件夹和文件。如果您从 Web 应用程序访问 Oracle，请为 ASP.NET 用户执行此操作。

有关更多信息，另请参阅： http: [//forums.oracle.com/forums/thread.jspa?threadID=67364](http://forums.oracle.com/forums/thread.jspa?threadID=67364)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T11:22:10.153

也许，只是也许，oracle 没有安装在这台“不同的计算机”上？

# apache-flex - Flex AS3 - 向 ItemRenderer 的所有实例发送事件

> ID：776722
> 
> 赞同：3
> 
> 时间：2009-04-22T11:20:46.507
> 
> 标签：apache-flex, actionscript-3, events

我有一个使用自定义 ItemRenderer 的列表。所有者（列表）有没有办法将我创建的自定义事件发送到它的 ItemRenderer 的所有实例？

例如，我想调度一个将文本添加到项目渲染器中的文本框的事件。一个或多个项目渲染器将能够根据某些用户交互来响应此事件。

有办法吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-22T11:46:56.397

如果您的自定义 ItemRenderer 实例以某种方式可以访问 List 实例，那么它很简单 - 只需注册您的事件处理方法：

```
theList.addEventListener(YourCustomEvent.CUSTOM_EVENT, itemRendererCustomHander); 
```

如果您没有直接访问权限（我假设），您仍然可以间接访问，例如通过 ItemRenderer 的类对象的委托。使 EventDispatcher 的子类的实例成为 ItemRenderer 类的静态属性，并在 ItemRenderer 构造函数中向其注册事件处理程序：

```
public class ItemRenderer {
    public static var eventDelegate:YourCustomEventDispatcher;

    public function ItemRenderer() {
        eventDelegate.addEventListener(YourCustomEvent.CUSTOM_EVENT, itemRendererCustomHander);
        (...)
    }

    public function itemRendererCustomHander(event:YourCustomEvent) {
        (...)
    }
} 
```

现在，当您创建 theList（在 ActionScript 中或在 MXML 组件的初始化事件处理程序中）时，创建一个新的 YourCustomEventDispatcher，为其提供对 theList 的引用，并将其添加到 ItemRenderer。YourCustomEventDispatcher 使用 theList 为 YourCustomEvent 注册一个私有事件处理程序，然后重新调度它。由于所有 ItemRenderer 实例已依次使用 YourCustomEventDispatcher 为 YourCustomEvent 注册，因此 theLists 的 YourCustomEvent 通过一跳到达所有 ItemRenderer。

这基本上是观察者设计模式的一种实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T13:16:41.160

要访问 List 实例并添加事件侦听器，您的渲染器可以实现 IDropInListItemRenderer 接口。

然后，您将被迫实现接口定义的 get listData 和 set listData 方法。当需要渲染器类的实例来渲染新项目时，框架将自动调用此方法，并且设置的 listData 将为您提供带有一些有用信息的 BaseListData 对象。

```
public function set listData(listData:BaseListData):void {
  var list:UIComponent = listData.owner; // the list component instance
  list.addEventListener(YourCustomEvent.CUSTOM_EVENT, itemRendererCustomHander);
} 
```

请注意，当使用更复杂的基于列表的组件（例如 DataGrid、AdvancedDataGrid 和 TreeList，您可以安全地将 BaseListData 对象转换为更具体的类（DataGridListData、TreeListData，...），以便访问一组其他信息正在使用此项目呈现器实例的上下文（例如，它将呈现 DataGrid 的哪一列）。

# c# - List<> 获取下一个元素或获取第一个

> ID：776725
> 
> 赞同：18
> 
> 时间：2009-04-22T11:20:59.330
> 
> 标签：c#

我想获取列表中的下一个元素，如果列表在末尾，我想要第一个元素。所以我只是想让它在换句话说。

```
 List<int> agents = taskdal.GetOfficeAgents(Branches.aarhusBranch);
    if (lastAgentIDAarhus != -1)
    {
        int index = agents.IndexOf(lastAgentIDAarhus);
        if (agents.Count > index + 1)
        {
            lastAgentIDAarhus = agents[index + 1];
        }
        else
        {
            lastAgentIDAarhus = agents[0];
        }
    }
    else
    {
        lastAgentIDAarhus = agents[0];
    } 
```

我对上面显示的自己的解决方案相当不满意，如果您有更好的解决方案，请告诉我:)

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-22T11:31:43.250

```
lastAgentIDAarhus = agents[index == -1 ? 0 : index % agents.Count]; 
```

MOD 运算符**%**的使用自动将索引切分为可能索引的范围。

模运算符是对 DIV (/) 运算符的补充，它返回两个整数相除的余数。例如，如果您将 9 除以 6，则结果为 1，余数为 3。MOD 运算符要求 3。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-04-10T16:54:00.793

或者简单地说：

```
public static T NextOf<T>(this IList<T> list, T item)
{
    var indexOf = list.IndexOf(item);
    return list[indexOf == list.Count - 1 ? 0 : indexOf + 1];
} 
```

例子：

```
List<string> names = new List<string>();

names.Add("jonh");
names.Add("mary");

string name = String.Empty;    

name = names.NextOf(null);   //name == jonh

name = names.NextOf("jonh"); //name == mary

name = names.NextOf("mary"); //name == jonh 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-22T13:12:51.463

作为对此略有不同的看法，这是一种扩展方法，您可以使用它来使任何 IEnumerable '循环'

```
 public static IEnumerable<T> AsCircularEnumerable<T>(this IEnumerable<T> enumerable)
  {
    var enumerator = enumerable.GetEnumerator();
    if(!enumerator.MoveNext())
      yield break;

    while (true)
    {
      yield return enumerator.Current;
      if(!enumerator.MoveNext())
        enumerator = enumerable.GetEnumerator();
    }
  } 
```

所以你可以像这样使用它

```
 var agents = new List<int> {1, 2, 3, 4, 123, 234, 345, 546};

  foreach(var i in agents.AsCircularEnumerable())
  {
    Console.WriteLine(i);
  } 
```

这将继续...... :)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-04-03T16:25:20.083

我喜欢[Vinicius](https://stackoverflow.com/a/15931918/1015595)使用扩展方法的想法。不幸的是，他发布的代码会引发异常。这是基于他的，但它不会抛出异常，并且非常简单易读（恕我直言）：

```
public static T Next<T>(this IList<T> list, T item)
{
    var nextIndex = list.IndexOf(item) + 1;

    if (nextIndex == list.Count)
    {
        return list[0];
    }

    return list[nextIndex];
} 
```

如果传入的项目不在列表中，它将返回列表中的第一项，因为在这种情况下`list.IndexOf(item)`将返回`-1`；

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T11:27:58.800

差别不大，但至少少了一些代码（至少在编辑器中）；o)

```
List<int> agents = taskdal.GetOfficeAgents(Branches.aarhusBranch);
if (lastAgentIDAarhus != -1)
{
    int index = agents.IndexOf(lastAgentIDAarhus);
    lastAgentIDAarhus = (agents.Count > index + 1 ? agents[index + 1] : agents[0]); 
}
else
{
    lastAgentIDAarhus = agents[0];
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-27T07:42:49.487

如果我们添加一些检查以避免常见错误，您怎么看？

```
public static class ListExtensions
{
    public static TType Next<TType>(this IList<TType> list, TType item)
    {
        if (list == null) return default(TType);

        var itemIndex = list.IndexOf(item);
        if (itemIndex < 0) return list.FirstOrDefault();

        var nextIndex = itemIndex + 1;

        return nextIndex >= list.Count 
            ? list.FirstOrDefault() 
            : list[nextIndex];
    }
} 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2017-05-30T15:01:34.907

字符串 line = lines[lines.FindIndex(x => x.Contains(item)) + 1];

# java - 如何在 tcp 套接字通信中读取输入流以获取 java 中的多种格式

> ID：776729
> 
> 赞同：0
> 
> 时间：2009-04-22T11:21:54.430
> 
> 标签：java, tcp

在基于 TCP 的通信中，我需要在 DataInputStream 上侦听/读取多种格式。比如write和writeUTF。

> 我需要识别另一端使用的模式以切换到该模式，例如使用 writeUTF(String) 时我需要使用 readUTF()，如果使用 write(byte[])，那么我应该能够切换读取（）以获取数据。
> 
> 我尝试使用 markSupported,mark,reset 但无法实现。我打算嗅探前几个字节以了解格式，然后切换到必要的格式。
> 
> 还请指定我是否可以使用任何其他输入/输出流进行 tcp 通信。
> 
> 我对网络通信有基本的了解。因此，我们将不胜感激任何解决此问题的帮助。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T11:26:50.033

我不太确定你在这里*真正*想要实现什么。您无法确定远程端正在使用什么方法，因为*一切都*将解决为发送字节流。

所以最后你会收到一个字节流，然后你必须确定它代表什么。您要识别的格式集是什么？你能列举这些吗？你能控制远端如何发送它们吗？如果是这样，我将实现某种形式的标头，这样（例如）第一个字节标识类型（例如字符串、数字数组等），然后您的客户端可以适当地切换模式。

如果您可以使用 Java 对象序列化和适当的对象流，那么您可以解析一个 Java 对象，然后使用 instanceof，例如

```
ObjectInputStream ois = new ObjectInputStream(is);
Object obj = ois.readObject();

if (obj instanceof String) {
   // do string-related stuff
} 
```

等等。这假设您可以更改远程端（虽然不确定！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-17T11:36:18.533

您将遇到的问题是，您可以使用 write() 进行任何操作，反之亦然。如果不对可能发送的数据类型做出一些假设，就无法区分差异。这可以用于某些特定情况，但不适用于一般情况。

读者无法可靠地知道 write(byte[]) 写入的长度。您可能会发现 read() 在大多数情况下会通过环回读取相同的长度，但它不会在真实网络上工作。

因此，发送方执行 write(byte[])，然后执行 writeUTF(String)。无法知道第一次写入持续了多长时间，因此无法确定 writeUTF 何时开始（同样，除非您对发送的数据类型做出假设）

解决您的问题的方法是发送一段数据的长度，后跟其数据类型。例如

write(bytes) 替换为 writeInt(bytes.length), write((byte) 1 /* bytes */), write(bytes)

writeUTF(bytes) 替换为 byte[] bytes = text.getBytes("UTF-8"); writeInt(bytes.length), write((byte) 2 /* UTF */), write(bytes)

这样，接收者就知道消息的长度及其类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:33:38.317

我建议看一下用于网络通信的[apache mina 框架。](http://mina.apache.org/)大多数（如果不是全部）低级网络功能都是由 mina 为您处理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T11:35:50.310

代替 DataInputStream，您可以使用 ObjectOutputStream 进行写入，使用 ObjectInputStream 进行读取。

你可以这样写：

```
 ObjectOutputStream objectOutputStream = new ObjectOutputStream(out);
    objectOutputStream.writeObject("xyz"); 
```

并像这样阅读：

```
 ObjectInputStream objectInputStream = new ObjectInputStream(in);
    Object obj = objectInputStream.readObject(); 
```

# .net - 设计客户端/服务器程序，设计问题（.Net）

> ID：776738
> 
> 赞同：2
> 
> 时间：2009-04-22T11:24:04.283
> 
> 标签：.net, client-server

我们正在设计一个客户端/服务器程序，我需要一些关于设计决策的帮助。

该程序的服务器端将作为服务在多个 Windows 服务器上运行，该服务正在监视这些服务器，需要时该服务将通过电子邮件向我们发送报告。

客户端将用于控制和管理服务器上运行的服务，但不会一直运行。

我的问题是我应该在哪里以及如何存储服务的配置。设置（smtp 等）将在客户端上定义，但在远程服务器上运行的服务（可能有很多）需要使用设置进行更新，并保留这些设置直到它们再次更新。

我可以想到两个选项，一个中央 Windows 共享，服务从中读取设置，或者当客户端点击“保存”时，设置将保存到每台服务器上的某个位置。

你会怎么办？有什么我应该注意的吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T11:29:04.100

我没有使用此类服务​​的经验，但建议可能是将设置存储在他们都可以访问的中央数据库中。因此，每次创建新服务器时，都会在数据库中创建一个新的设置条目。

只是把这个放到讨论中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T11:51:10.910

我开发了一个涉及客户端和多个服务器的系统。我的系统的要求包括它非常可靠和高度可用（这可能不是您的要求）。从这个角度来看，这里有一些想法：

*   如果您将设置存储在中央位置（文件共享或数据库），则您在分布式系统中创建了单点故障。一种解决方法是将设置存储在 2 个或更多中心位置。但是，您如何确保 2 个或更多位置同步？）

*   如果您将设置存储在每台服务器上，如果在您尝试保存设置时客户端/服务器与一台服务器的通信失败怎么办，或者如果其中一台服务器未启动怎么办。现在您遇到了服务器不同意设置的情况。那么，再一次，您如何确保多个服务器同步？

*   所以....想一想如何可靠地保持服务器同步，以及它们如何检测它们何时不同步。在我的系统中，服务器之间有一个主/从方案，带有序列号的心跳，以便从属可以不断地确保它们是同步的并且没有错过任何消息。如果 master 宕机了，系统会降级，但仍然可以工作，因此 master 不是灾难性的单点故障。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:55:02.727

这里有很多事情需要考虑。

显而易见的选择是存储库，无论是服务器端的注册表、文件还是数据库。当您的服务加载时，您会在一个集合中获取所有这些设置。但是，当您在服务器端添加一项服务以监控其他一些任务时会发生什么。

现在您遇到了问题，因为如果通过一台服务器在数据库中更新了参数，则需要将更新通知其他服务并且它们需要重新初始化。

您可以通过在许多服务之间引入许多 IPC 机制来克服这个问题，即队列、共享内存、管道、套接字。如果服务不是分布式的，我建议共享内存；如果不是，我建议在中央服务器或数据库上使用队列；作为更好的选择。然而，服务仍然需要协作一些如何向其他服务提供有关参数更新的提示。

# asp.net - Web.Config 问题

> ID：776740
> 
> 赞同：0
> 
> 时间：2009-04-22T11:24:28.480
> 
> 标签：asp.net, web-config

我有两个网络服务器，远程和本地。我有多个项目，其中一些托管在 REMOTE 上，一些托管在 LOCAL 上，一些托管在两者上。我在配置以下情况时遇到问题：

```
http://REMOTE/                   << contains 'main project'
http://REMOTE/doubleproject/     << contains 'doubleproject'
http://LOCAL/                    << contains 'doubleproject' 
```

所有项目的 Web.Config 中都有以下条目。

```
<configuration>
  <configSections>
    <sectionGroup name="system.web.extensions" 
    type="System.Web.Configuration.SystemWebExtensionsSectionGroup, 
          System.Web.Extensions, Version=3.5.0.0, Culture=neutral, 
          PublicKeyToken=31BF3856AD364E35">
    </sectionGroup>
  </configSections>
</configuration> 
```

**但是，版本号不同。'main project' 使用 1.1 版，而 'doubleproject' 使用 3.5 版。我在远程服务器上收到错误：**

*'部分或组名'system.web.extensions' 已定义。对此的更新可能只发生在定义它的配置级别。*'

*   [由于在http://LOCAL](http://LOCAL)上的使用，我无法删除“doubleproject”中的条目
*   我不能使用 <clear /> 或 <remove name="" />，主要是因为它不起作用:-)，其次是因为在 .NET 1.1 之后的 <configSections /> 中不允许使用 clear/remove
*   [由于在http://LOCAL](http://LOCAL)上的使用，我无法在“主项目”中将版本更改为 3.5 并删除“双项目”中的条目

***任何人对配置或解决方案的建议？谢谢！***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T11:30:19.010

您的子目录是否在 IIS 中设置为单独的应用程序？将其添加为单独的应用程序可能会消除对父 configSection 的依赖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T09:14:51.020

我已将此问题作为错误报告给 Microsoft。 [http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=434335](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=434335)

# design-patterns - 我所有的测试在 Nunit 中都被忽略了

> ID：776758
> 
> 赞同：2
> 
> 时间：2009-04-22T11:30:12.723
> 
> 标签：design-patterns, nunit, watin

我写了一个 HomePageClass

```
Imports System
Imports System.Collections.Generic
Imports System.Text.RegularExpressions
Imports System.Text
Imports WatiN.Core

Namespace TestDesign
    Public Class HomePage
        Inherits IE
        Public Const HomePageURL As String = "test"

        Public Sub New()
            MyBase.New(HomePageURL)
        End Sub

        Public Sub New(ByVal instance As IE)
            MyBase.New(instance.InternetExplorer)
        End Sub

        Public ReadOnly Property UserIDField() As TextField
            Get
                Return TextField(Find.ById(New Regex("txtuserName")))
            End Get
        End Property

        Public ReadOnly Property PasswordField() As TextField
            Get
                Return TextField(Find.ById(New Regex("txtPassword")))
            End Get
        End Property

        Public ReadOnly Property ContinueButton() As Button
            Get
                Return Button(Find.ById(New Regex("Submit")))
            End Get
        End Property

        Public ReadOnly Property UserRegistrationLink() As Link
            Get
                Return Link(Find.ByUrl("userregistration.aspx"))
            End Get
        End Property

        Friend Sub Login(ByVal username As String, ByVal password As String)
            UserIDField.TypeText(username)
            PasswordField.TypeText(password)
            ContinueButton.Click()
        End Sub

        'Friend Function GoToUserRegistration() As UserRegistrationPage
        '    UserRegistrationLink.Click()
        '    Return New UserRegistrationPage(Me)
        'End Function
    End Class
End Namespace 
```

还有一个 HomePagetestsClass

```
Imports System.Threading
Imports NUnit.Framework
Namespace TestDesign

<TestFixture()>_
Class HomePageTests

    <Test()> _
    Public Sub GoToHomePageTest()
        Dim home As New HomePage()
        Assert.IsTrue(home.ContainsText("Welcome"))
        home.Close()
    End Sub

    <Test()> _
    Public Sub Login()
        Dim home As New HomePage()
        home.Login("abc", "def")
        Assert.IsTrue(home.ContainsText("Welcome"))
        home.Close()
    End Sub
End Class 
```

谁能告诉我哪里错了。只是试图实现一个通用的测试模式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T11:49:06.017

您的测试被忽略的原因是所有 TestFixture 类都必须是公共的。如果您没有明确说明可见性级别，那么 .NET 假定您的类应该只在您的程序集中可见（Friend aka Internal 在 C# 中）。由于 NUnit GUI 不是您的程序集的一部分，因此它无法创建您的 TestFixture。简单换行：

```
Class HomePageTests 
```

至：

```
Public Class HomePageTests 
```

你会很高兴的。

# java - 为什么我的 NullPointerException 没有被我的 catch 块捕获？

> ID：776765
> 
> 赞同：4
> 
> 时间：2009-04-22T11:32:07.183
> 
> 标签：java, exception, java-me, try-catch, java-wireless-toolkit

我有一个线程，我在其中捕获一个大的、无所不包的 catch 块中的所有错误。我这样做是为了在我的应用程序中报告任何错误，而不仅仅是预期的错误。我的 Runnable 看起来像这样：

```
public final void run()
{
    try
    {
        System.out.println("Do things"); /* [1] */

        doUnsafeThings();
    }
    catch (Throwable t)
    {
        System.out.println("Catch"); /* [2] */

        recover();
    }
    finally
    {
        System.out.println("Finally"); /* [3] */
    }
} 
```

我希望 NPE 被 Throwable catch 块捕获。相反，[2] 处的输出不打印，[3] 也不打印。打印 [1] 处的输出。

我在控制台上得到的是：

```
Uncaught exception java/lang/NullPointerException. 
```

这到底是怎么回事？

对于法庭记录，我使用的是 J2ME，它在 Sun 的 WTK v2.5.2 模拟器中运行。

我很想把它归结为 JVM 实现的狡猾，但我不禁觉得我只是错过了一些东西。

为避免疑问而澄清（因为示例代码显然是从我的生产代码中改变的）

*   run 方法中的 try/catch/finally 块之外没有任何内容。
*   每个块的开头都有一个 System.out.println - 这些控制台语句后面的内容应该无关紧要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T13:16:42.530

答案证明我是个白痴。我会解释出了什么问题，但我们就称它为“其中一个错误”。

我暂时忘记了运行 runnable 的线程是一个自定义线程类（为了绕过一些诺基亚错误）。它`run()`在对方法的调用之间重复调用`canWait()`。

canWait 方法对失败负责，并且 run 根本没有失败。最重要的是，我有控制台盲，并且完全但不小心错误地引用了我的问题中的事件顺序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-22T11:54:47.767

听起来你需要一些试验和错误。我可以建议：

```
try {
    doEvilStuff();
} catch (NullPointerException ex) { 
    System.out.println("NPE encountered in body"); 
} catch (Throwable ex) {
    System.out.println("Regular Throwable: " + ex.getMessage());
} finally {
    etc...
} 
```

通过对 NullPointerException 进行显式捕获，如果异常来自 try 块或 catch/finally 块，应该会变得很明显。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-22T11:46:59.703

好吧，这是一个疯狂的猜测......但它可以解释事情。

*显然您的代码实际上*并非如此 - 所以我的猜测是您的 catch （或 finally ）块在记录任何内容之前正在做某事，*或者*它使用与 try 块不同的记录器。无论哪种方式，我都怀疑 catch 或 finally 块正在引发异常。

我不认为你有堆栈跟踪......

编辑：好的，如果它只是`System.out.println`，它是不是在争论中可能会发生爆炸？例如：

```
catch (Throwable t) {
    // Will go bang if t.getCause() returns null
    System.out.println(t.getCause().getMessage());
} 
```

如果它只是简单`System.out.println("Constant")`，那么它是非常奇怪的。

您是否知道（例如，从 try 块中的日志行）try 块实际到达了多远？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T12:06:43.543

当我查看您的代码时，recover() 似乎正在引发异常，因此 Jon 给出的建议非常值得遵循。

如果你给了我们一个堆栈跟踪，你可能会得到更好的帮助。

当我尝试捕获异常时，我会执行以下操作：

```
try {
  doSomethingBad();
} catch(Exception e) {
   try {
      LogException(...);
   } catch(Exception e) {}       
} finally {
} 
```

我不喜欢嵌套异常，但我不喜欢我的 catch 块抛出异常。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T13:11:04.527

正如您提到的那样，您正在使用`Runnable`- 这是否意味着您也正在使用多个线程？如果该`doUnsafeThings()`方法在内部再次产生了一个不同的线程并产生了异常，那么您可能无法在您的 catch 块所在的线程中获取它。见[http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.UncaughtExceptionHandler.html](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Thread.UncaughtExceptionHandler.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-17T05:30:21.610

捕获 NullPointerException 通常是一种不好的做法。

程序员通常在三种情况下捕获 NullPointerException：

```
The program contains a null pointer dereference. Catching the resulting exception was easier than fixing the underlying problem.
The program explicitly throws a NullPointerException to signal an error condition.
The code is part of a test harness that supplies unexpected input to the classes under test. 
```

在这三种情况中，只有最后一种是可以接受的。按照这个链接：

[捕获 NullPointerException](https://www.owasp.org/index.php/Catch_NullPointerException)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T11:40:48.720

线程是否有可能被其他代码杀死？一般来说，finally 块总是执行，除非线程被 System.exit() 或类似的东西异常终止。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-22T12:10:51.317

*   您确定您正在查看代码中的正确位置吗？即，您在堆栈跟踪中保护的 doUnsafeThings() 块是否存在？

*   可能你的构建方法有问题，你在调试旧版本的代码？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-22T13:01:35.097

只需在 doUnsafeThings() 中添加一些日志记录；查看该方法是否正在执行您期望的操作（例如，最后尝试捕获并记录某些内容）

# c# - 为什么此 XAML 出现错误：使用 ItemsSource 之前，Items 集合必须为空

> ID：776766
> 
> 赞同：14
> 
> 时间：2009-04-22T11:32:31.847
> 
> 标签：c#, wpf, mvvm

任何人都可以从这段代码中想到为什么 ItemsSource 行会得到一个

> ****在使用 ItemsSource****之前，项目集合必须为空。****

 ****错误？我发现的大多数解决方案都指向不正确的 XAML，例如我似乎没有的额外元素等。当我拿出

> ItemsSource="{绑定客户}"

它运行没有错误（但当然不显示我的客户列表）。

客户因此在 ViewModel 中定义，其中包含 3 个 CustomerViewModel：

```
Customer[] customers = Customer.GetCustomers();
IEnumerable<CustomerViewModel> customersViewModels = customers.Select(c => new CustomerViewModel(c));
this.Customers = new ReadOnlyCollection<CustomerViewModel>(customersViewModels.ToArray()); 
```

**关于在哪里看的任何建议？**

```
<UserControl x:Class="TestCommandSink123.View.CustomersView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestCommandSink123"
    xmlns:view="clr-namespace:TestCommandSink123.View"
    xmlns:vm="clr-namespace:TestCommandSink123.ViewModel"
    xmlns:sink="clr-namespace:TestCommandSink123.CommandSinkClasses"
    sink:CommandSinkBinding.CommandSink="{Binding}"
    >

    <UserControl.CommandBindings>
        <sink:CommandSinkBinding Command="vm:CustomersViewModel.CloseAllCustomersCommand"/>
    </UserControl.CommandBindings>

    <DockPanel>
        <ItemsControl
            DockPanel.Dock="Bottom" ItemsSource="{Binding Customers}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <view:CustomerView/>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
            <Button
                Command="vm:CustomersViewModel.CloseAllCustomersCommand"
                Content="Close All"
                Margin="0,0,0,8"
                />
        </ItemsControl>

    </DockPanel>
</UserControl> 
```

# 回答：

我确实确实有格式错误的 XAML，只是忽略了它，**Button 应该在 ItemsControl 之外**：

```
<ItemsControl
    DockPanel.Dock="Bottom" ItemsSource="{Binding Customers}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <view:CustomerView/>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl>
<Button
    Command="vm:CustomersViewModel.CloseAllCustomersCommand"
    Content="Close All"
    Margin="0,0,0,8"
    /> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-22T11:36:19.887

您正在尝试设置 ItemsControl 的 ItemsSource 但您已经有了孩子。这两个应该申请哪一个？您放在 ItemsControl 中的 Button 还是您作为 ItemsSource 交给它的集合？错误信息是完全合理的。

您必须从 ItemsControl 中删除按钮或删除 ItemsSource 属性。您不能同时插入项目和设置 ItemsSource。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T11:36:21.633

您的 ItemsControl 中有一个 Button。由于 ItemsControl 中已经有一个项目，它不允许您设置它的 ItemsSource 属性。

将 Button 声明向下移动到`</ItemsControl>`结束标记下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T11:37:24.207

你看过这个问题吗？这似乎是您问题的答案。

[“在使用 ItemsSource 之前，项目集合必须为空。”](https://stackoverflow.com/questions/683863/wpf-items-collection-must-be-empty-before-using-itemssource)

# java - 为什么派生类有时只能在重写方法中具有专门的类型？

> ID：776768
> 
> 赞同：2
> 
> 时间：2009-04-22T11:33:12.937
> 
> 标签：java, polymorphism

假设我有这个基类：

```
abstract public class Base {
    abstract public Map save();
    abstract public void load(Map data);
} 
```

令我惊讶的是，我可以在派生类中做到这一点：

```
public class Derived extends Base {
    @Override
    public Map<String, String> save() {    //Works
        ...
    }
    ...
} 
```

但我不能这样做：

```
public class Derived extends Base {
    @Override
    public void load(Map<String, String> data) {    // Fails
        ...
    }
    ...
} 
```

这里发生了什么？为什么我可以使用专门的返回类型而不是专门的参数类型？

更令人困惑的是，如果我保留 的原始声明`load`，我可以将其分配给更特殊的类型：

```
public class Derived extends Base {
    @Override
    public void load(Map data) {
        Map<String, String> myData = data;   // Works without further casting
        ...
    }
    ...
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-22T11:40:42.933

从专用类型到原始类型的隐式转换 - 这始终是“安全的”，因为使用原始类型的人无法做出任何假设。因此，希望`Map`从方法中得到原始结果的人并不介意他们得到`Map<String, String>`.

没有从原始类型到专用类型的隐式转换 - 如果有人将原始类型传递给*它*`Map`可能`load`具有非字符串键和值。这对于 . 的基类型声明是完全合法的`load`。

撇开泛型不谈，你的方法有点像这样：

```
public abstract class Base
{
    public abstract Object save();
    public abstract void load(Object x);
}

public class Derived extends Base
{
    @Override
    public String save() { ... } // Valid

    @Override
    public void load(String x) // Not valid
} 
```

删除泛型后，是否清楚为什么`save`这里调用正常，但`load`调用不行？考虑一下：

```
Base b = new Derived();
Object x = b.save(); // Fine - it might return a string
b.load (new Integer(0)); // Has to compile - but the override wouldn't work! 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T11:39:38.100

您不能将参数更改为，`load(Map<String, String> data)`因为如果您使用基类而不是专用类，则很容易违反这一点，如下所示：

```
Base base = new Derived()
base.load(new HashMap<Integer, Integer>()); 
```

这将调用派生的加载方法，但违反声明。因为泛型仅在编译时检查，所以无法检测到该错误。

只要返回值在子类中比在超类中更专业，返回值就没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:26:53.697

我认为问题在于，通常可以有两种按参数类型区分的方法。恰好需要选择一个。这需要查看未擦除的类型。这意味着这两种`load`方法是可区分的。所以我们有可区分的方法，但在擦除的形式中，只有一种方法存在。

这不是返回类型的问题，因为（在 Java 中）您可以拥有协变返回类型，但不能通过返回类型重载。

# windows - 如何为我们的 Subversion 设置解决“405 Method Not Allowed”？

> ID：776771
> 
> 赞同：5
> 
> 时间：2009-04-22T11:34:30.327
> 
> 标签：windows, svn, visualsvn-server

我们使用在 Windows Server 2003 上运行的 VisualSVN 服务器来提供我们的源代码。最近，我们将一个项目的一部分拆分为它自己的存储库中的一个新项目，然后使用`svn:externals`. 从那时起，我们在尝试使用 Subclipse 提交文件时遇到了问题。

我们得到的错误是：

> svn：提交失败（详情如下）：
> 
> svn: PROPFIND of '/svn': 405 Method Not Allowed ( [https://svn.ourserver.com](https://svn.ourserver.com) )

谷歌搜索了一段时间并没有真正帮助，我们的配置似乎是正确的。还应该注意的是，我们已经运行这个服务器一段时间了，没有这些问题，除了将项目分成两个存储库之外，没有对服务器进行任何更改（即配置文件相同）。

还应注意，这些错误仅在我们尝试一次签入多个文件时出现。如果我们一次签入一个文件，则没有错误。此外，据我们目前所知，它仅出现在 Subclipse 中，并且`Versions.app`(OS X) 似乎工作正常，所以这是我们目前的解决方法。

如何分析错误以找到原因并随后修复它？

我绝不是 SVN 大师，现在我一无所知。

* * *

似乎我们可以签入同一个包中的多个文件，但不能签入来自多个包的文件。此外，当我将项目“拆分”为两个存储库时，我使用新名称导入了原始存储库。我没有进行转储，然后导入该转储。这可能是我们问题的根源吗？如果是，我将如何解决？

经过一番折腾之后，似乎确实与签入不同存储库中的文件有关。如果我尝试同时在存储库 A 和存储库 B（由 引用`svn:externals`）中进行一次提交，则会收到错误消息。`Versions.app`正确处理这个问题，但我想它可能只是做了两个提交，而不是一个。Subclipse 惨遭失败。现在，我们只需进行多次提交，一个用于存储库 A，一个用于存储库 B，效果很好。如果比我聪明的人可以详细说明为什么会发生这种情况，这种设置是否愚蠢等等，请继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T03:57:22.767

**先决条件**：聘请优秀的管理员

**问题**：VisualSVN 服务器对其内部存储库的所有和任何部分使用基于路径的身份验证。默认访问级别 (AFAICR) - 适用`* = r`于 root 并且此设置继承到下面的所有节点（存储库的 root 也是），当您尝试提交到**没有良好 ACL**的新存储库（或配置错误）时，您**会遇到问题**

**解决**方法：在 VisualSVN Server MMC-applet 中检查新存储库的属性，并检查权限和用户。在最简单的情况下，在超级存储库（具有外部的存储库）中具有写权限（可以提交）的用户必须（如果策略允许）在子存储库（具有链接的存储库）中具有写权限资源）。

# asp.net-mvc - 使用 Html.ActionLink 在不同的控制器上调用动作

> ID：776781
> 
> 赞同：235
> 
> 时间：2009-04-22T11:35:55.533
> 
> 标签：asp.net-mvc

我正在尝试使用`ActionLink`. 我会用一个例子来说明我的问题。

我在 Hat 控制器的 Index 视图中，我正在尝试使用下面的代码来创建指向 Product 控制器的 Details 操作的链接。

```
<%= Html.ActionLink("Details", "Details", "Product", new { id=item.ID }) %> 
```

这不是在 Product 控制器上创建一个到 Details 的链接，而是在 Hat 控制器下生成一个到 Details 操作的链接，并将一个 Length 参数附加到它的末尾：

```
Hat/Details/9?Length=7 
```

由于这个问题，我无法`HTML.ActionLink`在控制器之间切换。如果您能指出我做错了什么，我将不胜感激。谢谢

PS：我使用的是MVC自带的默认路由设置

```
routes.MapRoute("Default", "{controller}/{action}/{id}", 
                     new { controller = "Home", action = "Index", id = "" } ); 
```

* * *

## 回答 #1

> 赞同：418
> 
> 时间：2009-04-22T13:37:07.600

你想要的是这个重载：

```
//linkText, actionName, controllerName, routeValues, htmlAttributes
<%=Html.ActionLink("Details", "Details", 
    "Product", new {id = item.ID}, null) %> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-06-24T14:31:38.157

使用该参数，您将触发错误的重载函数/方法。

什么对我有用：

```
<%= Html.ActionLink("Details", "Details", "Product", new { id=item.ID }, null) %> 
```

它触发 HtmlHelper.ActionLink(string linkText, string actionName, string controllerName, object routeValues, object htmlAttributes)

我正在使用 MVC 4。

干杯！

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-12-01T12:56:48.103

为了清楚起见，我建议使用命名参数编写这些帮助程序，如下所示：

```
@Html.ActionLink(
    linkText: "Details",
    actionName: "Details",
    controllerName: "Product",
    routeValues: new {
        id = item.ID
    },
    htmlAttributes: null
) 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-04-22T12:25:35.447

如果您获取 MVC Futures 程序集（我强烈推荐），则可以在创建 ActionLink 和 lambda 时使用泛型来构造路由：

```
<%=Html.ActionLink<Product>(c => c.Action( o.Value ), "Details" ) %> 
```

您可以在此处获取期货程序集：http: //aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId= [24471](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-22T12:21:14.413

你打错了 ActionLink 的过载。试试这个。

```
<%= Html.ActionLink("Details", "Details", "Product", new RouteValueDictionary(new { id=item.ID })) %> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-08-12T07:50:24.843

试试看它工作正常

```
 <%:Html.ActionLink("Details","Details","Product",  new {id=item.dateID },null)%> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-01-26T03:57:33.623

另一种解决方案是使用`Url`辅助对象来设置标签的`href`属性，例如：`<a>`

```
<a href="@Url.Action("Details", "Product",new { id=item.ID }) )">Details</a> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-04-10T10:05:08.370

请注意，详细信息是“产品”文件夹下的“查看”页面。

ProductId 是表的主键。这是来自 Index.cshtml 的行

```
 @Html.ActionLink("Details", "Details","Products" , new  {  id=item.ProductId  },null) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-09T06:23:32.963

这段代码在部分视图中对我有用：

```
<a href="/Content/Index?SubCategoryId=@item.Id">@item.Title</a> 
```

# java - 使用 JPA（带注释的实体）和 liquibase 进行休眠

> ID：776787
> 
> 赞同：36
> 
> 时间：2009-04-22T11:37:03.083
> 
> 标签：java, hibernate, jpa, liquibase

如果您使用 xml 映射， liquibase 是 hibernate 的**[hbm2ddl_auto](http://www.jroller.com/eyallupu/entry/hibernate_s_hbm2ddl_tool)**属性的完美替代品。但我使用 JPA 注释（休眠注释）。那么可以使用liquibase吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-18T05:55:42.643

是的，Liquibase 使用 hibernate 的元数据类，无论您使用 xml 映射还是注释，它们都是相同的。您确实需要一个休眠配置文件来指向 liquibase，但您的映射可以是 xml 或 jpa 注释。可以在[https://github.com/liquibase/liquibase-hibernate/wiki](https://github.com/liquibase/liquibase-hibernate/wiki)找到更多信息，但您可以使用“数据库 url”，例如

```
hibernate:classic:com/example/hibernate.cfg.xml 
```

如果你有一个休眠的 xml conf 文件或者

```
hibernate:ejb3:myPersistenceUnit 
```

如果您有 META-INF/persistence.xml，或者

```
hibernate:spring:com.example?dialect=org.hibernate.dialect.MySQL5Dialect 
```

如果您想基于包含注释实体的 java 包自动生成 JPA 配置。

# c - C中的位打包

> ID：776789
> 
> 赞同：2
> 
> 时间：2009-04-22T11:38:01.833
> 
> 标签：c, image, bit, packing, pack

我正在尝试将 RGB 图像转换为 ARGB 图像，基本上只是为 alpha 通道添加 255。我想知道是否有任何打包方法可以在没有迭代的情况下做到这一点？所以要遍历我的 RGB 数据并将 255 附加到每个像素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T11:41:23.260

C 没有“方法”......不，这听起来不像标准库中的例程。我认为您需要自己编写代码，使用如下代码：

```
void setAlpha(unsigned char *rgba, int width, int height, int alpha)
{
  int x, y;

  for(y = 0; y < height; y++)
  {
    for(x = 0; x < width; x++, rgba += 4)
    {
      rgba[3] = (unsigned char) alpha;
    }
  }
} 
```

基本假设：

*   打包顺序是内存中的 RGBA，即从像素开始到 alpha 字节的偏移量是 3。
*   图像存储在初始地址的左上角像素，按从右到左、从上到下的顺序。
*   没有填充或任何东西

还要注意循环的顺序；由于缓存，这会对实际性能产生巨大影响。这段代码按顺序接触到内存中距离较近的像素，好称为“好局部性”。

将指针更改为指向下一个像素而不是说明地址 ( `rgba[4 * y * width + 4 * x + 3]`) 也是一种优化，并且（对我而言）很容易理解。

# javascript - 重构许多 jQuery Ajax 调用 - 最佳实践？

> ID：776791
> 
> 赞同：5
> 
> 时间：2009-04-22T11:38:29.990
> 
> 标签：javascript, jquery, ajax

我有很多 JavaScript/jQuery 代码块来处理我的页面中的异步数据处理。每个代码块具有三个功能（代码不完整，仅用于说明目的）：

1.  封装`$.ajax`调用：

    ```
    function doSomething(data){

      // do some preprocessing 

      $.ajax({}); // some JQuery Ajax operation that accepts data

      // do some postprocessing
      return false;
    }
    ```

2.  处理响应：

    ```
    function handleResponse(result){  
      // process the result
      return false;
    }
    ```

3.  处理任何错误：

    ```
    function handleError(XMLHttpRequest, textStatus, errorThrown){  
      // gracefully handle the Error and present relevant information to user
      return false;
    }
    ```

在一个需要大量数据处理的页面中，我最终有很多这些似乎是重复的块，所以我决定进行一些重构。

我想会有不同的方法来解决这个问题。

1.  可以有一个可以跨 Ajax 调用重用的错误处理程序（很明显）。
2.  也许可以重用一些响应处理程序，但这将是不公平的，因为响应因调用而异。
3.  也许创建某种原型对象，提供基本功能并具有用于错误处理的静态方法（这可以在 JavaScript 中完成吗？）。

我只是想知道是否有人遇到过这个和/或是否有一个最佳实践解决方案？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-22T13:20:03.913

您可以使用 jQuery 中的 $.ajaxSetup({}) 方法来设置一些常见的 ajax 设置。

例如，如果您要在某个页面上一遍又一遍地发布到同一个 URL，您可以在 ajaxSetup.xml 中设置它。这意味着您必须向 Richard 提供的函数传递更少的参数。ajax 方法的第一个参数的任何属性都可以在 $.ajaxSetup() 中设置为默认值。

```
$.ajaxSetup({
    url: 'my/ajax/url'
    success: function() {
        // Do some default stuff on success
    },
    error: function() {
        // Do some default stuff on a failure
    }
    // etc...
}); 
```

它们可以在任何 ajax 调用中被覆盖。所以，现在你可以这样做：

```
$.ajax({data:{foo:'bar',bar:'foo'}}); 
```

您可以覆盖 URL，例如：

```
$.ajax({url:'different/ajax/url',data:{foo:'bar',bar:'foo'}}); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-22T11:52:49.317

我们经常为 Ajax 调用使用包装函数以简化使用，因此您可以这样做：

```
function NewAjax(url, data, success)
{
    $.ajax({
      url: url,
      data: data,
      success: success,
      fail: function ()
      {
        // Do generic failure handling here
      }
} 
```

但我通常更喜欢使用 jQuery ajax 事件绑定到每个 ajax 事件：

[http://docs.jquery.com/Ajax](http://docs.jquery.com/Ajax)

因此您可以绑定到每个 ajax 调用的每次失败或成功，例如：

ajaxError(回调) ajaxSuccess(回调)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:15:03.960

正如 Richard 所示，查看代码片段之间的不同之处并将它们作为参数传递给函数。Javascript 可以将函数作为参数传递，这可以消除大量冗余。

如果 url 没有改变，那么为什么将它作为参数传递，你可以有一个全局变量，它将具有 url 的主要部分，并且只传递改变的 url 部分。

# sql-server - 使用 INSERT/SELECT 语句插入 NULL 和 DEFAULT 值

> ID：776795
> 
> 赞同：3
> 
> 时间：2009-04-22T11:39:23.327
> 
> 标签：sql-server

在 MICROSOFT SQL SERVER 中有下表：

```
CREATE TABLE [T1]
(
    [ID] int IDENTITY (1, 1) NOT NULL,
    [col1] int NOT NULL,
    [col2] int NOT NULL,
    [col3] int NULL,
    [col4] datetime NOT NULL DEFAULT (getdate()),
    [col5] datetime NOT NULL DEFAULT (getdate())
) 
```

我想编写一个插入语句，从另一个表中选择 2 列并将所有其他列插入为 NULL 或默认值。这是我迄今为止尝试过的（但它不起作用）：

```
 INSERT INTO [T1] ([col1],[col2], [COL3])
SELECT [1column],[2column],NULL
FROM [T2] 
```

当我右键单击 T1 表并选择打开表时，该表只有 2 列，即使在对象资源管理器的“文件夹”列中也有所有列

我想要实现的是在 T1 中：在 Col1 和 COL2 中 SELECT 的结果和在 COL3 NULL 和在 COL4 和 COL5 中的默认值！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T11:44:09.947

```
INSERT INTO [T1] ([col1], [col2], [COL3])
SELECT [1column],[2column],NULL
FROM [T2] 
```

这应该可以正常工作，只需检查：

```
INSERT
INTO    [T1] ([col1], [col2], [col3])
SELECT  1, 2, NULL

SELECT  *
FROM    [T1]

id    col1  col2  col3  col4                     col5
---   ---   ---   ---   ---                      ---
1     1     2     NULL  2009-04-22 15:46:47.090  2009-04-22 15:46:47.090 
```

您收到的确切错误是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:05:07.523

表错误、查询错误或权限错误。

1.  右键单击 SSMS 中的表名，然后单击刷新。你看到 5 列吗？ `SELECT * FROM T1`会给你所拥有的。

2.  当你右击..打开表时，点击工具栏上的【SQL】按钮，你看到SELECT * FROM T1了吗？

3.  您没有`SELECT`其他列的权限，但有`INSERT`（不太可能）因此 MetaData 可见性阻止`SELECT *`工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T12:21:13.943

当您选择打开表格并且您已经有一个以前打开表格的窗口时，它将显示该窗口而不是打开另一个窗口。您看到的是表只有两列时的旧结果。

关闭该窗口并再次打开表以查看表的当前状态。

# asp.net-mvc - Azure 配置错误

> ID：776798
> 
> 赞同：1
> 
> 时间：2009-04-22T11:40:06.540
> 
> 标签：asp.net-mvc, azure

我正在测试 Azure，但我一直遇到这个问题——我不知道其他人是否经历过类似的事情。在本地，该解决方案运行良好 - 完全没有问题，但是当我将它放入云中时 - 我只是不断收到此错误？

有任何想法吗？

Azure 配置错误类型="Microsoft.Samples.ServiceHosting.AspProviders.TableStorageSessionStateProvider"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T19:23:11.310

听起来这在 Windows Azure 论坛上得到了回答：http: [//social.msdn.microsoft.com/Forums/en-US/windowsazure/thread/454e0186-241f-4dad-a67a-43a3774c1cec](http://social.msdn.microsoft.com/Forums/en-US/windowsazure/thread/454e0186-241f-4dad-a67a-43a3774c1cec)

# php - 在 PHP 中使用多语言创建网页

> ID：776807
> 
> 赞同：3
> 
> 时间：2009-04-22T11:43:12.333
> 
> 标签：php, html

我想用 PHP 开发一个多语言页面，例如英语/德语/日语.. 所以当我点击德语时，页面语言将变为德语，然后我点击英语将变为英语。请指导我这样做。提前致谢....

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-03T21:09:24.320

奇怪的是，这么多 php 开发人员似乎认为所有自然语言都有相同的语法。制作一个没有参数的翻译框架是不可能的。虽然该字符串`$lang['welcomeTo'] $sitename`对于大多数语言可能正确翻译（欢迎使用 stackoverflow），但对于土耳其语（例如应该在的位置`$sitename $lang['welcomeTo']`（stackoverflow'a hos geldiniz）或德语（Willkommen auf stackoverflow/Stackoverflow heißt Sie willkommen ）。当您尝试翻译具有多个变量的句子时，情况会变得更糟。

唯一的选择是使用参数化翻译（例如：函数）

```
Language::getCurrentLanguage()->translate('welcomeTo', array('sitename' => $sitename));

# Translation file for english (configfile-style):
welcomeTo=Welcome to $sitename

# Translation file for turkish:
welcomeTo=$sitename'a hos geldiniz

# Translation file for german:
welcomeTo=Willkommen auf $sitename
# Or
welcomeTo=$sitename heißt sie willkommen 
```

简而言之：如果您想要真正的 i18n，请使用函数来检索您的翻译，而不是变量。您可能还想查看 php 的[intl](http://us.php.net/manual/en/book.intl.php)扩展名。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-22T12:08:29.917

我们使用[http://php.net/manual/en/intro.gettext.php](http://php.net/manual/en/intro.gettext.php)的方式。工作正常，我们都已经在其他项目（非 PHP 项目）中使用[http://www.gnu.org/software/gettext/manual/gettext.html 。](http://www.gnu.org/software/gettext/manual/gettext.html)所以很容易开始。

我认为正确的方法取决于谁翻译文本！如果是开发人员，您可以对每种语言都有自己的看法。但是，如果您有其他人翻译文本，那么 gettext（翻译在专用文件中，并且有工具可以处理此类文件）是正确的选择！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T11:45:41.673

您可以使用会话来存储用户设置的语言。

```
$_SESSION["lang"] = "en";
$_SESSION["lang"] = $_GET["lang"]; 
// or this way, then you can do example.com/?lang=en 
```

然后创建一个包含翻译数组的文件。

```
$lang["en"]["welcome"] = "Welcome to the site"; 
```

然后另一个文件可能有德语翻译

```
$lang["de"]["welcome"] = "Willkommen auf der Webseite"; 
```

然后您只需使用会话调用 $lang 数组

```
echo $lang[$_SESSION["lang"]]["welcome"]; 
```

这是一个简化版本，您也可以使用对象来存储翻译。但我不建议使用数据库来存储翻译，因为这涉及到非常大的 SELECT 或非常多的 SELECT。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T20:45:43.690

通常你需要一个支持 UTF-8 的网站。这是通过文件头设置的。（并且可以通过 header() 设置）函数。

那么我猜你想要有英文和中文的网站。然后我建议有一个语言文件。也许是一个数组或一个对象，您可以在其中存储要在网站上显示的段落。然后你只需打印出那段。

然后要知道用户要求什么语言，我会使用 $_SESSION 来存储用户选择的语言。

然后您的语言文件可能如下所示

```
$lang["en"]["Welcome"] = "Welcome to the site"; 
```

然后中文欢迎文件会有这样的东西

```
$lang["ch"]["Welcome"] = "歡迎"; 
```

然后在您要打印的位置。你会做

```
echo $lang[$_SESSION["lang"]]["Welcome"]; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T21:39:54.200

构建多语言网站的一种有效方法是不使用硬编码标签，而是从适当的语言文件中检索它们，因为基本上您需要做的是在您的网站上定位不同的用户。如果您显示了存储在数据库中的数据，您可能应该考虑添加一些存储不同语言翻译的数据库表。例如，要在 C# 中完成一些工作，您可以使用存储标签值的资源文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T11:56:00.027

大多数框架都会有帮助你的助手。这是[Codeigniter](http://codeigniter.com/user_guide/helpers/language_helper.html)和[cakePHP](http://bakery.cakephp.org/tags/view/multiplelanguages)的初学者。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T20:45:49.990

您可以使用您喜欢的任何字符集键入 HTML 的内容部分。请务必正确[设置字符集和内容编码](http://www.electrictoolbox.com/php-set-content-encoding-type-header/)。例如，对于简单的 unicode，将其设置为 UTF-8。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-03T20:49:55.427

Rails 处理得[很好](http://weblog.rubyonrails.org/2008/11/18/new-rails-2-2-i18n-defaults)。您可能想查看有关如何执行此操作的想法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-14T12:12:50.343

正如格雷戈尔所说；gettext 对我来说是专业的方式......

这是一个很好的文章[链接](http://www.sourcerally.net/regin/49-How-to-get-PHP-and-gettext-working-%28ubuntu,-debian%29)

但我想补充一些要点

I-使用这种方法，如果您在 windows 下创建 po 文件，您将不得不使用 .po 和 .mo 文件，而不能在 linux 下使用它。或者在linux下创建的.po文件不能在windows下使用。

II- linux 可以自己创建 .po 文件，但在 Windows 中，我建议您使用诸如 poedit 之类的程序（您可以从其站点获取它：[http](http://www.poedit.net/) ://www.poedit.net/ ）

III- 某些语言环境存在字符问题。但我不记得他们是哪一个？:(

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-04-22T11:51:34.297

我个人翻译我的完整观点。因此，您将拥有如下文件结构：

```
application/
 someScript.php
views/
 de/
  someView.php
 en/
  someView.php
models/
 someModel.php 
```

然后按照 Olafur 的建议将语言存储在会话变量中并执行类似的操作。

```
 session_start(); //dont forget to call this somewhere
 $_SESSION['lang'] = 'en';
 //and then in somewehere else:
 include 'views/'.$_SESSION['lang'].'/someView.php'; //or whatever method is used to include views. 
```

**编辑**
您应该将输出与脚本分开。因此，您将拥有一个执行一些脚本编写工作的脚本，例如获取当前的 UNIX 时间戳，这将是上面示例中的 someScript.php：

```
 //someScript.php
  $timestamp = time(); 
```

现在我们可以直接在下面添加所有输出，但这会很难维护，所以我们在不同的文件中进行输出，这里是 someView.php 文件。所以“en”文件夹中的 someView.php 将是：

```
<html>
<head>
<title>Currect UNIX timestamp!</title>
</head>
<body>
<p>The current UNIX timestamp is: <?php echo $timestamp; ?> seconds</p>
</body></html> 
```

在“de”文件夹中，它实际上是同一个文件，但所有文本都是德语。

现在我们需要做的就是在我们的 someScript.php 中包含这些输出文件，因此我们将以下行添加到该脚本的底部：

```
 include '../views/'.$_SESSION['lang'].'/someView.php'; 
```

您应该在此处阅读有关 MVC 的更多信息：[http ://www.onlamp.com/pub/a/php/2005/09/15/mvc_intro.html](http://www.onlamp.com/pub/a/php/2005/09/15/mvc_intro.html)

**注意：**这个例子不是严格的 MVC，但这应该给你一个想法。

# c# - 连接查询的条件表示

> ID：776812
> 
> 赞同：0
> 
> 时间：2009-04-22T11:45:26.870
> 
> 标签：c#, nhibernate, criteria

有两个班

1 类 A[属性：-aid,aname]

2 类 B[属性：-bid,A,bname]

DropDownList ddlist；

```
ICriteria criteria = ActiveRecordMediator<B>.GetSessionFactoryHolder()
                     .CreateSession(typeof(B)).CreateCriteria(typeof(B))
                     .setFetchMode(“A”,FetchMode.JOIN); 
```

ddlistToLet.DataSource = criteria.List();

ddlistToLet.DataTextField = "bname";

ddlistToLet.DataValueField = "援助";

ddlistToLet.DataBind();

我收到这个错误

DataBinding：“B”不包含名为“aid”的属性。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T09:50:50.520

提供具有该值的属性。

```
class B
{
  public A A { get; set;}
  public aid { get { return A.aid; } }
} 
```

如果你不喜欢它，因为你不想改变你的类，那么你可以使用一个特殊的类来绑定到控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-17T19:37:45.010

将查询结果转换为更“绑定友好”的对象：

```
public class MyDTO {
  public string BeeName { get; set; }
  public string AId { get; set; }
}

// .. (snip) ..

ICriteria criteria = ActiveRecordMediator<B>.GetSessionFactoryHolder()
  .CreateSession(typeof(B)).CreateCriteria(typeof(B))
  .CreateCriteria(“A”)
  .SetProjection(Projections.ProjectionList()
    .Add(Projections.Property("bname", "BeeName"))
    .Add(Projections.Property("aid", "AId"))
  )
  .SetResultTransformer(Transformers.AliasToBean(typeof(MyDTO)));

IList<MyDTO> results = criteria.List<MyDTO>(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-23T01:04:17.977

当使用条件时，NHibernate 将返回一个二维结果数组。我认为下拉菜单无法了解底层对象结构是什么。查看结果，您应该能够调整绑定。

# internet-explorer - 具有集成安全性的 IE7 要求提供凭据，但 Firefox 不知道为什么？

> ID：776815
> 
> 赞同：0
> 
> 时间：2009-04-22T11:46:31.233
> 
> 标签：internet-explorer, firefox, networking, iis-6

我们在 W2003 服务器上为 IIS 中的集成安全性配置了一个网站。当我们尝试使用 IE 连接时，它要求我们提供网络凭据。如果我们提供这些凭据，我们会得到拒绝访问。

如果我们将 Firefox 配置为允许该网站作为受信任的 URI，我们可以毫无问题地连接和使用该网站。

有没有人知道发生了什么，或者我可以做些什么来解决这个问题。我早上大部分时间都在试图解决这个问题，但遇到了一堵砖墙。

该站点位于本地 Intranet 上，我已经在 IE 的本地 Internet 区域中设置了服务器，但这仍然没有什么区别。我们确实有一个代理服务器，但 IE 被配置为绕过本地地址。

亲切的问候诺埃尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T13:50:25.587

啊，这听起来很熟悉。这听起来就像我们在使用 SharePoint 服务器时遇到的问题——Firefox 会被重定向到登录并像魅力一样工作，但 IE 会受到挑战并失败。

[SharePoint、Office Live 加载项和 403 禁止](http://blogs.catalystss.com/blogs/marek_mazur/archive/2009/04/14/sharepoint-office-live-add-in-and-403-forbidden.aspx)

由于您在这里没有提到 SharePoint，我猜这不是所涉及的服务器端产品，但这听起来是一个非常相似的问题（我在您发布的请求中看到了有问题的办公室标题）。您是否从另一台装有 IE 7 的机器上遇到了这个问题，但不是那个“Office Live 加载项”？也许您的服务器应用程序正在对 Office 执行与 SharePoint 类似的检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:21:11.480

确保该站点位于允许转发凭据的受信任区域。此外，请确保尝试访问该站点的用户已通过 IIS 获得访问权限和/或在您的 web.config 中定义

在本地 Intranet 区域的安全区域中，确保选中转发 Windows 凭据的选项（我不相信它是本机的）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-11T07:48:01.493

感谢所有回复，我们最终将其追溯到服务器上运行的 WinHttp 代理服务。由于某种原因，它干扰了 IE 请求，但没有干扰 Firefox。一旦我们禁用它，一切正常。该服务被称为

**WinHTTP Web 代理自动发现服务**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-18T08:24:52.563

会是这样吗？

*Internet Explorer 必须认为请求的 URL 位于 Intranet（本地）上。如果请求的 URL 的计算机名称部分包含句点，Internet Explorer 会假定请求的地址存在于 Internet 上，并且不会自动传递任何凭据。没有句点的地址被认为在 Intranet（本地）上；Internet Explorer 自动传递凭据。唯一的例外是 Internet Explorer 中 Intranet 区域中包含的地址。*

资料来源：[KB atricle](http://support.microsoft.com/kb/258063)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T13:20:49.027

Here's the IE/FireFox Request/Response traffic. Thanks for offer of to examine them.

Regards Noel.

```
IE Request/Responses - Up To Networks Credentials Dialogue.
=================================================================
GET /tp2v3.administration.website/default.aspx HTTP/1.1
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, application/xaml+xml, application/vnd.ms-xpsdocument, application/x-ms-xbap, application/x-ms-application, application/x-silverlight, */*
Accept-Language: en-ie
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; OfficeLiveConnector.1.3; OfficeLivePatch.0.0)
Host: r1-08-qa
Connection: Keep-Alive

            HTTP/1.1 401 Unauthorized
            Content-Length: 83
            Content-Type: text/html
            Server: Microsoft-IIS/6.0
            WWW-Authenticate: Negotiate
            WWW-Authenticate: NTLM
            X-Powered-By: ASP.NET
            Date: Wed, 22 Apr 2009 12:58:16 GMT
            Proxy-Support: Session-Based-Authentication

            <html><head><title>Error</title></head><body>Error: Access is Denied.</body></html>

GET /tp2v3.administration.website/default.aspx HTTP/1.1
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, application/xaml+xml, application/vnd.ms-xpsdocument, application/x-ms-xbap, application/x-ms-application, application/x-silverlight, */*
Accept-Language: en-ie
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; OfficeLiveConnector.1.3; OfficeLivePatch.0.0)
Authorization: Negotiate YIIKQAYGKwYBBQUCoIIKNDCCCjCgJDAiBgkqhkiC9xIBAgIGCSqGSIb3EgECAgYKKwYBBAGCNwICCqKCCgYEggoCYIIJ/gYJKoZIhvcSAQICAQBuggntMIIJ6aADAgEFoQMCAQ6iBwMFACAAAACjggP9YYID+TCCA/WgAwIBBaEMGwpaQVJJT04uQ09NohswGaADAgECoRIwEBsESFRUUBsIcjEtMDgtcWGjggPBMIIDvaADAgEXoQMCATCiggOvBIIDq7C1jE6W4jMUYtnsMU9AWzIpvK5HReolYjn/P+j7d8LFRa0dpuNfYL2K/g6MBsP7CchH86C0GclXEIvZjxvX9mM9O3W9pZOoVQwsP/UTSe4Y19rZSDbMU3e7vhJy5jK8BYhRknncQ8aAKj3mQXLeQs5a7C3P6gZ8sJYgcvC29CTmjgV3BEMutrq0Z/6qmiB7pe6hB4RatCNSo2u9hmwR+prRmoV1fx4nd4q8QiQ9X3mfY3NbU4KIAoeTsEHV4vjHiLRx3SNuHaU5ug5PhOYCfF4ZAZLUy8Dy1q3I1+VRrrAlofJNKK8nG6KDwOKmE5mUSO2IPg3TlOrzJS4+qfMU7F1HFMs1naB7cC7fm976EM6CBchnTue3aLMlwsy+KrMmfjocxmHViCrKrrEADHj2aDkbzNy/wwdlqH58Jh5iLPhWwy9B/vLxmLl9s49AJ290KtoBNnrYMYr8pHI5r6JCz5nzcQfsyPA6I2uMUdugNCQGlHkZ1eNyJB81hNbEIxm5mplwsLJqoUYbkBtgThkomiA40CxUYT88bU/CL5O1uZqw+adBgh1+j8E8pg1XGKXX/xzdwYLLehSCgsU0/qlzDRU/vWC/RuaD2M+N3fBygSWaYq9M9gQwHzwoGaIm1j35W33DxUyg7XP9TOUFdw6HZNl6oaXDvBhgdSpRJXKdVbdPn7iUdNHWlw+GYAW75hKoS6zG4ZHyEtd/GiprooXh77WXLlCPO8GRJ+yfC1UPk7DB+hopVGV/a+Ipij6G2ZKqUt90L+nmAp731Sv+hkofudoxRrK6rmCnaqvy9OeKGezczKaWgYCp84TS0i84G8Xoa405AVOJIEvc7H8kUREAjD9H1ALAFv9Rm+4RUmsSB5bbkzf+q0RFtZpmJLnTsrPAQHI6dIcqL2DIIUk+8Lim7MXHvkl85wutcWl8DPt7PIs60p9iPZrLnznocf4N8tuEmBWomA9ELSGIwcyEH54qKg/0VREAKov5OwHe2QL0XcNg3l/cgOtvIygm3WsUgT5ECtHCl3+B40cu6EqOaGosc0e9iQE8SCi48VSZ5Z7EFFFHHFEKJCU7pF4IHTEfzbyAsFWt7MuywUmQ2KvUyMvSrM2/gBw02xcUX3Zlh5x7VxPH3WuYJenOJmQhUgsngvZgFvuDE1dBU601Klvr9Vb8wlpp27xHYS41bSfenww/3jlscIx7fu+uqiVNtAt/k83bb6yf5oKTykB5emsEqwTH4d3R6jfFA2cGx8VmIaSCBdEwggXNoAMCAReiggXEBIIFwH3aJUOOhnAvIFPRvPD3GEcFtKV35K9yhV6dZARcKIOdB2LtDhpAuVJP+qI8IO5NTkWGFRs2sKOiaylajmwJhxNBYSfDlYT/3uHtikblK3EMo4M5+Pg9w7GqnyCEOeIxfk5uu2PeGpbYRFJ2MblVcNDWnQYFlfE/Av3nnMAHljfKWpjrHfOobdovxVO8/e82+z0e8DkHQB5w1QZojhuqaez/1qprKeYDXJrABmnx515x9D7RC8JbULr6JK1umUwT/M2yJM9mfllWp4lmPhEmfWqGAFi9rgTO0TQ6/KzmI0KFgokdZwUpXEeTSCgkYYPP9kCZxSxFnUwxLyvft3CPwaFkuS/h8Nq4agnAmldYjtJ3pp/UdY53C9QxoE5Yv+PwfTJBNlDK1Yi01hUKhuKYkVVe06W/E6sXy/p3LQVgT8OipxDGRLK9alAijs2P4kKu3yrKJKxJdAzA1+8GeoTALCI3OMFTrZsaN2K+elJ6Pg2IM/ubuhyhQhl2urEMvAfROEShsuM6FOOWjmy7QoO/sMfjeY+k+XWJEVjJAM9b66zNqGtItLo4lJMgWPR4FNU4b6ihT/qCi6R6HgnfVJumIdj0pm4vZ5nLlSgU/QVVP9M94F+cb+b7b9r3x6ZJhxTcg0z8g1+ytbNIyGZ83gnfAsANnaiWFq5dL8Ize84RvFzWbLWKLivioo3UH6k9Q2hEvJ7bWhPZYrpyYo16pXL5JuBVNzDR1ue2O7ZA/IjAqZrINLpKS/rt1Z81N90hULihD8K3ReYs7GjaYLWp1MwU0AlACkconHZITZnFRiPFkeP4gYp7F/mRrcCWyndxUj3OTlURKspz7nt36okXn9cmov8hqmzwnDV6WeMW1kvbbygUVyFpITOoLSkMq3rmpWOJOVzd2WQ/YO5CsTNB9ZLcqCvHQf1Jtx3Ho+oyB4IR3XKA4HPKrtYtgi+9bha+wkki3VXreshSJhajYdaShNBVn6TgfiywNCG9YVQgac/GYEVO1m+fpYJjP95LkeqdX3vW5bhrmISyCg7yGAI5MwpthlMAA7B4i/BwLnoCfrDcaCtj5G0dj67LxsuOINNRs05rCmThcpVbDGoViBZII12oiaMQdSKBaoYiXOrPwHxrg9n1ks61MdgzzC7G6HMUISiHlkRE8LIldLLqcexjYhzKpSbH+Nvdf+Ku6GPCjOq/vMRExqZNQOjR6/DcLFKEl8yX3SXGkfIoCwW5aaG50gNRoL8/4UxODTfnsbxyrXUvpldSisU4HpVOFMK7lqmLUOkKUIIG855gaUnnPkUuPr1cW/XW0tSnIzluHOuxsSmSzAzQq4XnOYBC9zc+fYC+5xKzsej1xp66nI2f7hwvo4ruOEGjKXgVdzzQ6vHbIK1y5qUt42hRpi3Sj3kQXnIbHroni+z71xbrbBqR0lO5CQ0w7rnZ0jjIbj7jQeXQx2Dx/K5fBUL8YBAEcwDdsk1RyEbKODOvai/Tyxn33xmpOEjpbdck4vva5aNXtqy49pL2DxwUo/Ri9M8ZWWjaRShuok9exLz6JX3onjBPD9LAfPJrNoo7L3+z7NFw+OyHnCM1SA8xYmt/Jng+WTHd6SZUWJ/vOOfgUI3io1t7wegjmodb7yy+HAWUJO6fPhBWcGx6GquDc6CeVnGjtm+twgAUY0hQSjPZ9/yiHiYvhv+SbVBDHHK6RlkRP5CzwbXRVbkD9fI1ZmH1IBd9QRYAp0EnzeJSweYo8N5/DI+2/TesgFQw2bdBsn+xRlzA9S6SdmPJLp4Hhj2vSqgpCNxd2a0GKlfHbM6LIqJgKYLpI48e7DSH1pWzD7B43j8Fv6miuaGQU78RtxuTetnTo4njntoA/gR4LF7BqZuqoTeB+my3AoQSml83DvTfs68WcefxUDXbYdWh0LKWY7sZRHWefJ/miRNOxljvQf82c9jowkJFL5iKTQbaLKxRUe/6Yta39gaYO0c4
Connection: Keep-Alive
Host: r1-08-qa

            HTTP/1.1 401 Unauthorized
            Content-Length: 83
            Content-Type: text/html
            Server: Microsoft-IIS/6.0
            WWW-Authenticate: Negotiate oYGLMIGIoAMKAQGhCwYJKoZIgvcSAQIConQEcmBwBgkqhkiG9xIBAgIDAH5hMF+gAwIBBaEDAgEepBEYDzIwMDkwNDIyMTMwODQ5WqUFAgMC7LSmAwIBKakMGwpaQVJJT04uQ09NqiYwJKADAgEDoR0wGxsEaG9zdBsTcjEtMDgtcWEuemFyaW9uLmNvbQ==
            X-Powered-By: ASP.NET
            Date: Wed, 22 Apr 2009 13:08:49 GMT
            Proxy-Support: Session-Based-Authentication

            <html><head><title>Error</title></head><body>Error: Access is Denied.</body></html>

GET /tp2v3.administration.website/default.aspx HTTP/1.1
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, application/xaml+xml, application/vnd.ms-xpsdocument, application/x-ms-xbap, application/x-ms-application, application/x-silverlight, */*
Accept-Language: en-ie
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.1; .NET CLR 2.0.50727; .NET CLR 3.0.04506.30; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; OfficeLiveConnector.1.3; OfficeLivePatch.0.0)
Host: r1-08-qa
Connection: Keep-Alive
Authorization: Negotiate oYIKDjCCCgqiggoGBIIKAmCCCf4GCSqGSIb3EgECAgEAboIJ7TCCCemgAwIBBaEDAgEOogcDBQAgAAAAo4ID/WGCA/kwggP1oAMCAQWhDBsKWkFSSU9OLkNPTaIbMBmgAwIBAqESMBAbBEhUVFAbCHIxLTA4LXFho4IDwTCCA72gAwIBF6EDAgEwooIDrwSCA6t/KEYVjGYGHuzZHMIgzUJCcBM+502dyaVZeY71+YzvCb7ha2SI4lTu+8oifn8MK1Uj23nqFgFNvRelFfffPDkJYf+oGuYLSkrWsb1sh2mwt42NTd9zj2U0WNrPIR5QNACouDUyTNr4sOJiF9oNWB6ttnd8GowqdyZFqQP5So0SRn0MseHnF1slSZo07PQNIobI9EC8vfPYu3k8xlIpqdpem6tXxn/pYptOID3pV1tv1wgLcyR6YWcYgjfE5ath7LRoqRPe0w2a0c7OUDyqgiWuoe440eKhGGlMS3FrIVPrqXM4sBvembyaNTXxuk9XBXwEo28FARbFaZUdY1kjBhh4ziMQtoc8tEMbDP5i2qveOCx3LOXu2oL2TV3x9H6eAfPCOqidecOKv+EL9LZDaJzD6VFvNuBRo8Wil+z7E9/XBd91fBS5PHGDhCrp2GMf6o9B9ogCeBEBjC+alOmeYxoYB2qWasgZeOq9DhZ+NlQgR9ITtlzNVCQwu4/sE4TVw1mnLU/JXz3sXpQIVhQdG1iKK6JiKVJ1jLYjPHPB5dQZUOAKMaiTQ24MsE5hJf43GrIqh3oG44hY0JfiBbbBF9Ss1cI4tvZ6nAsAcAvE0ea+J25P6KXcDsBO08kE8jDOUKsENE0l0hcF084fz9lricM2zVi7qMg7KtbRufAKjP7oyiZHIQjAe9JQh7+1YSMXXKEKbA/HAI0AZBLwZOT2LXDwoy+JKlK3FNesJe8PpzrcMFOFYRw4Bv50IKZhglsekAZHVcyG0Maoibt4JbpilvASxbGoKA1qhpXRDuZnBGkgapsm4CQHDepSTBtRP+RjxvXXHsK4R4fyAnR7OeJRfoegdrkKsBEnmLOBFCmClaW4Z1bdRMDbgU1EAT5u/dAK7BXWzFHRGgJ6aNx7lBCmMBau0PFDLJzslqAQ5yM+RCx9knIQ8I7m+XNtxKWpSAYqg1RW4LccN1zGsiZAJhFCQztMtUmnY0F9C8k2xPbJ8uU57wY/kCB9Zy8rzgqaTNSsxih1UxPUwDMBvnEhbVQlTuv+P0nsSB5ERPbIcRc/0OrrHlc+iLeWXFwWvi9zIofQdDQzGqX1a0FJy3/AQNpmkoRO33GHJpXHUuuz92aD7auoNTObfFJlv/Febo9S5k6++lwZP4PJm/UA/bdJ6scAdYqXrIE/RQ3zwoVVnPxrw3M/T6ZE7nplrxKXU3Y7r2JH1NdLZmlvOdn/2YFVo99N9s5//OrRhgmnRxrRRECkggXRMIIFzaADAgEXooIFxASCBcAo8OmqGmZIMmXyPQxyeHuiNXnOsbTtwF/mNvGct9fCJEBOAdr0JtPmD/4PZGvfgtgF5Wq3XCKeS5At79Jk4x1hYDb5geZdVTirrGpta7Jc8gbdSsagNhIB86sotgte5s7389f78a0xqY/t2EV6PJy/59tGJHIGmElP1tDCvoFLsGLXx17KsRyVCwepRhefQolUq8h2FxmGJa5J8CFvXmOJjq8sytR4650vcSAKyazUpE3ygvsiQSWgzmOqPm54+IlHT8Wx32rhMWqCSRYasTbcaxaZXq8X6gQN5hO4jozrrM8xoEhbHjhEOJWqbeX85eh4p5ANk4Ggaly2JoMxwTa95TQdur3esMc5GRV7Bd/XVNpMPs9Iovvu43c+cJuMFgOCo1+0kCeTOXqGOJ/2qK2HjriEPV71q/re2VUf0sRgBdFKwPGRBge1KKFj/aTneN9L0YITPW3jBQzo1tptgpYlUSoK6LcKHm2V+zoIW+dfUVJlT1Zvgj7dSFJHz/Up70pKe0s7/5sW42zbB4g2ooaIWI9m0IVrn9ZdkTNbwwsJ/b6zyf1S+5d1vs5Hpp3DUSQe5D2EuAQPYPWWNKjhDK3KYbOZ8N/26qYXGxr/mLYLbR7xrRj3iDTHPUUyp2/whI+Cp09Bp4rZX9oFeKu6wWVsevMZXNSqdGWcJAjeK1vZKKmgXRxCrdhEf1RBPq78t+QLuzZSbNSX7ZUUPrgIAf7OvzEKBq1zt+NSf30++mPOF+0QGXNyusZQVIESsy4STIEMguM94m/8jykFfRM+m6a5dAKFAVCfwk36+4Vj+kR+4ZrwjQ+vpmluzrAencKuWOuFABZvZrZ/zxEn+NgaatBhfi71bxAan+i0q4+bJf1g/Lgamhuywdo7B9SjnLU2Y5vsWAn5Q0hMQOwTA9mf7Ba/652pmHaox3nAmBZFhTILD3loPjCAhT7LtylTBLEyWV2Mo9jTos17rM0zxVLkFz1uwW6Lvok8bxucMfvv6nUSggeg4ZVdvkCBUDwpDwykskbxJpIlnL1BBPlqBr9qOLYhhZgCXJkBvvB8i50NEtCMfBAGgHJyZo5xx8oYVk+kilunhHPAS8Z3D1bOyMyI4UZbNmHjstKW1/j3AedwQcwcC9Ws3nIlZW929+NJOQtsErkUz1tAFbH+lOc/CCtJkBfV8psAbj6mhaF4ZzR6hiGaz3U4Mf68eupzrlRd2bEeYv/pqM32lHW9yurtBipLux9bCZ4jCbZ8XXHcLmr1f1rDLV/nGEkiv07BDx6xDWZW//jY2D3P/sVovlMkgl/Qqd95ZJZvEIN6xtL0Rm1Pn3M19gb0K1MSx5gDGiKRn0BvQHgi/D2EW0eZ2cmI75zQfh4ztkd2G1HmYRqnp9V67lX1OZApWQPeBLarakgEZ3SQAQ0m9JaHQIdLX+pkrmJtqti0U1vF6Hk1IetZynH/29JGOiO2cKCpV+OsJQi/IfCRAwfCFxjIT1FpBtTPPCVe2U/8ca3NlrA0ftQIGS4lTGv/4A20dTEQo16s/B1ty9WXhf4M/OPq4BwJK9y7+pXzskxIDUymnMa3XdYuz90WnebDFv9y2eqThXVQ34TDmV7TnMiNU7KDeZ6gm/XYl0g0NxMZpHqXT+XElSgF2aUa0gyu9SPfFhWnBfq95hB8Af6ydvzWBs/PKROjg9wYvXDnJUegQpb0RTrry1cHCv950tFC0zh7XtQIZtXF2GBwrGZPasjSP1MAfitzAGUOlyVj16cQId3wRO/6XqJO8FLsIe6vngtpHQ8cVmg9EXiiVprtE7aoo8yTHllCX4ZutvL4AToNJVGEnea6FsSCDwRhUQLwTgh0fnpTjW9hW3aWbjjwbIjiwJVvHkn4G3xv7urHdXAWy91xM8McrZXL7pU32eCRfNQmoeuSBkekOQZFjz3nwaWfmcSAQIlJHn87NlJMZeLDhAHDtZd8z+mOp5prBP9TVA==

            HTTP/1.1 401 Unauthorized
            Content-Length: 83
            Content-Type: text/html
            Server: Microsoft-IIS/6.0
            WWW-Authenticate: Negotiate oX0we6ADCgEBonQEcmBwBgkqhkiG9xIBAgIDAH5hMF+gAwIBBaEDAgEepBEYDzIwMDkwNDIyMTMwODQ5WqUFAgMDKb2mAwIBKakMGwpaQVJJT04uQ09NqiYwJKADAgEDoR0wGxsEaG9zdBsTcjEtMDgtcWEuemFyaW9uLmNvbQ==
            X-Powered-By: ASP.NET
            Date: Wed, 22 Apr 2009 13:08:49 GMT
            Proxy-Support: Session-Based-Authentication

            <html><head><title>Error</title></head><body>Error: Access is Denied.</body></html> 
```

Network Credentials Dialogue then pop's up.

# FireFox Requests/Responses Till the 1st Successful Request.

```
GET /tp2v3.administration.website/default.aspx HTTP/1.1
Host: r1-08-qa
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-ie
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive

            HTTP/1.1 401 Unauthorized
            Content-Length: 83
            Content-Type: text/html
            Server: Microsoft-IIS/6.0
            WWW-Authenticate: Negotiate
            WWW-Authenticate: NTLM
            X-Powered-By: ASP.NET
            Date: Wed, 22 Apr 2009 13:11:04 GMT
            Proxy-Support: Session-Based-Authentication

            <html><head><title>Error</title></head><body>Error: Access is Denied.</body></html>

GET /tp2v3.administration.website/default.aspx HTTP/1.1
Host: r1-08-qa
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-ie
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Authorization: NTLM TlRMTVNTUAABAAAAB7IIogYABgAwAAAACAAIACgAAAAFASgKAAAAD05MWVNBR0hUWkFSSU9O

            HTTP/1.1 401 Unauthorized
            Content-Length: 83
            Content-Type: text/html
            Server: Microsoft-IIS/6.0
            WWW-Authenticate: NTLM TlRMTVNTUAACAAAADAAMADgAAAAFgomiKWBzG8sls3wAAAAAAAAAAIIAggBEAAAABQLODgAAAA9aAEEAUgBJAE8ATgACAAwAWgBBAFIASQBPAE4AAQAQAFIAMQAtADAAOAAtAFEAQQAEABQAegBhAHIAaQBvAG4ALgBjAG8AbQADACYAcgAxAC0AMAA4AC0AcQBhAC4AegBhAHIAaQBvAG4ALgBjAG8AbQAFABQAegBhAHIAaQBvAG4ALgBjAG8AbQAAAAAA
            X-Powered-By: ASP.NET
            Date: Wed, 22 Apr 2009 13:11:04 GMT
            Proxy-Support: Session-Based-Authentication

            <html><head><title>Error</title></head><body>Error: Access is Denied.</body></html>

GET /tp2v3.administration.website/default.aspx HTTP/1.1
Host: r1-08-qa
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.0.9) Gecko/2009040821 Firefox/3.0.9 (.NET CLR 3.5.30729)
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-ie
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 300
Connection: keep-alive
Authorization: NTLM TlRMTVNTUAADAAAAGAAYAHQAAAAYABgAjAAAAAwADABIAAAAEAAQAFQAAAAQABAAZAAAAAAAAACkAAAABYKIogUBKAoAAAAPWgBBAFIASQBPAE4AbgBsAHkAcwBhAGcAaAB0AE4ATABZAFMAQQBHAEgAVABY8nEGtCxA6AAAAAAAAAAAAAAAAAAAAADypTTGGfNQwTDfUA8dB2VSGiRZStKTPIU=

            HTTP/1.1 200 OK
            Date: Wed, 22 Apr 2009 13:11:04 GMT
            Server: Microsoft-IIS/6.0
            X-Powered-By: ASP.NET
            X-AspNet-Version: 2.0.50727
            Set-Cookie: ASP.NET_SessionId=30ys5zfxo1ove145a4zukkul; path=/; HttpOnly
            Cache-Control: private
            Content-Type: text/html; charset=utf-8
            Content-Length: 7501

            <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

            <html xmlns="http://www.w3.org/1999/xhtml" >
            <head id="ctl00_Head1"><title>
                TP2v3 Administration
            </title><link href="App_Themes/MSN_CherryBlossom/default.css" type="text/css" rel="stylesheet" /><link href="/TP2v3.Administration.WebSite/Static/Css/Style.css" type="text/css" rel="stylesheet" /><script type="text/javascript" src="/TP2v3.Administration.WebSite/Static/Scripts/Constants.aspx"></script><script type="text/javascript" src="/TP2v3.Administration.WebSite/Static/Scripts/Common.js"></script></head>
            <body class="RootSectionColour">

                <form name="aspnetForm" method="post" action="default.aspx" id="aspnetForm">
            <div>
            <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTgyODQ0Mzk3MQ9kFgJmD2QWAgIBD2QWAgICDw8WAh4EVGV4dAUESG9tZWRkZJ5c9WxhLKzCw+RVx9xZf+7hTJ7f" />
            </div>

                    <table border="0" cellpadding="5" cellspacing="0" style="width: 100%; height: 100%">
                        <tr>
                            <td style="width: 200px;" class="RootSectionColour" valign="top" >
                                <a href="/TP2v3.Administration.WebSite/"><img id="ctl00_Image2" border="0" src="static/images/adminlogo.gif" style="border-width:0px;" /></a>
                                <table border="0" cellpadding="0" cellspacing="5" style="width: 100%">
                                    <tr>
                            <td valign="top">
                                <div class="Menu">
            <div class="CurrentUser">ZARION\nlysaght</div><br />
            <div class="MenuItem ApplicationsSectionColour MenuItemNotSelected"><img src="/TP2v3.Administration.WebSite/Static/Images/applications16x16.gif" /> <a href="/TP2v3.Administration.WebSite/ApplicationConfiguration">Servers</a>
            </div>
            <div class="MenuItem SystemSectionColour MenuItemNotSelected"><img src="/TP2v3.Administration.WebSite/Static/Images/system16x16.gif" /> <a href="/TP2v3.Administration.WebSite/SystemConfiguration">System</a>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/Attributes">Attributes</a></div>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/BaseFields">Base Fields</a></div>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/Classes">Classes</a></div>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/CommonConfiguration">Common Config</a></div>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/PooledUserGroups">Pooled User Groups</a></div>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/SqlConnections">SQL Connections</a></div>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/WorkQueues">Work Queues</a></div>
            <div class="MenuItem SystemSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/SystemConfiguration/Diagnostics">Diagnostics</a></div>
            </div>
            <div class="MenuItem ModulesSectionColour MenuItemNotSelected"><img src="/TP2v3.Administration.WebSite/Static/Images/modules16x16.gif" /> <a href="/TP2v3.Administration.WebSite/Modules">Modules</a>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/DocLink">Document Link</a></div>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/DRT">DEC</a></div>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/EmailGateway">Email Gateway</a></div>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/Metrics">Metrics</a></div>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/TP2Monitor">TP2 Monitor</a></div>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/WorkRating">Work Rating</a></div>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/Converter">Converter</a></div>
            <div class="MenuItem ModulesSectionColour"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="/TP2v3.Administration.WebSite/Modules/Acknowledgement">Acknowledgements</a></div>
            </div>
            <div class="MenuItem UsersSectionColour MenuItemNotSelected"><img src="/TP2v3.Administration.WebSite/Static/Images/user16x16.gif" /> <a href="/TP2v3.Administration.WebSite/Users">Users</a>
            </div>
            <div class="MenuItem GroupsSectionColour MenuItemNotSelected"><img src="/TP2v3.Administration.WebSite/Static/Images/group16x16.gif" /> <a href="/TP2v3.Administration.WebSite/Groups">Groups</a>
            </div>
            </div>

                            </td>
                        </tr>
                    </table>
                            </td>
                            <td valign="top">
                                <div class=Breadcrumbs>
                                <table class="SimpleTable">
                                <tr>
                                <td>
                                <span id="ctl00_lblTrail">Home</span>
                                </tr>
                                </table>
                                </div>                    

                                <div class="Breadcrumbs RootSectionColour">
            <table class="SimpleTable"><tr><td>
            </td><td align="right">
            </td></tr></table>
            </div>

               <p><h1>touchpoint2 v3 Administration</h1></p>

               <table class="SimpleTable" cellpadding="4" cellspacing="12">
                <tr>
                    <td class="ApplicationsSectionColour HomePageSection">
                        <a href="/TP2v3.Administration.WebSite/ApplicationConfiguration"><img src="/TP2v3.Administration.WebSite/Static/Images/Applications48x48.gif" />   
                        Servers</a>
                                </td>
                    <td class="SystemSectionColour HomePageSection">
                         <a href="/TP2v3.Administration.WebSite/SystemConfiguration"><img src="/TP2v3.Administration.WebSite/Static/Images/System48x48.gif" />   
                       System</a> 
                    </td>
                </tr>
                <tr>
                    <td class="ModulesSectionColour HomePageSection">
                        <a href="/TP2v3.Administration.WebSite/Modules"><img src="/TP2v3.Administration.WebSite/Static/Images/Modules48x48.gif" />   
                       Modules</a>
                    </td>
                    <td class="UsersSectionColour HomePageSection">
                        <a href="/TP2v3.Administration.WebSite/Users"><img src="/TP2v3.Administration.WebSite/Static/Images/User48x48.gif" />   
                        Users</a> 
                    </td>
                </tr>
                <tr>
                    <td class="GroupsSectionColour HomePageSection">
                         <a href="/TP2v3.Administration.WebSite/Groups"><img src="/TP2v3.Administration.WebSite/Static/Images/Group48x48.gif" />   
                        Groups</a>
                    </td>
                    <td>         
                    </td>
                </tr>
               </table>

                            </td>
                        </tr>
                    </table>
                </form>
            </body>
            </html> 
```

Page then displays successfully.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T13:23:26.477

Given the other answers: what if you set up a dummy domain name in your client's hosts file, to fool Internet Explorer in thinking it's not a local address?

And maybe the following will get you into the right direction, though I doubt it:

I've set up many instances of Tomcat server sitting behind IIS (because part of the functionality of the site needed IIS to get, don't ask, Microsoft DRM running). If memory serves me well, Tomcat (or the ISAPI Tomcat Connector) would never be given the Basic Authentication headers supplied by Internet Explorer, as IIS took those away after failing to use the credentials for the Windows Authentication (which I did not ask for when sending the Authorization Required response in Tomcat...). However, in Firefox I could trick IIS by hitting Cancel in the login dialog. Next, a second dialog would be shown, which would then work fine. That second dialog would also show the realm specified in Tomcat, while the first would show some generic IIS message. Disabling Integrated Security in IIS did the trick for us.

So: are the prompts the same in Internet Explorer and Firefox? And maybe you can play around with hitting Cancel upon first login -- of course, that won't solve your problem, but maybe you get more details... Or maybe you can change the order of the supported authentication methods in IIS, or remove Basic Authentication altogether?

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T11:49:21.150

IE 并不总是能正确检测到本地地址。尝试关闭代理进行测试。

如果可行，请将服务器名称添加到“不使用...”代理设置。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-22T11:52:02.390

您是否尝试过使用[Fiddler](http://www.fiddler2.com/fiddler2/)或[Wireshark](http://www.wireshark.org/)之类的工具来查看客户端和服务器之间真正流动的内容？也许 Firefox 已经保存了凭据，或者服务器正在发送一个 Firefox 可以理解但 IE 不能理解的身份验证标头。

如果可以，请发布客户端发送的标头和服务器响应两者的标头——答案很可能在其中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-22T13:37:45.290

不确定这是否可行，但是当我在使用 spnego 身份验证和 firefox 时，我不得不：

关于：配置

寻找谈判

将服务器添加到trusted-uris

编辑：看起来 Firefox 正在使用旧的 NTLM，而 IE 正在协商身份验证，这有点解释了 firefox 工作的原因。我怀疑如果您将服务器添加到受信任的 spnego url，firefox 也会停止工作。

# php - 向 Zend Framework 站点添加新视图

> ID：776820
> 
> 赞同：3
> 
> 时间：2009-04-22T11:47:41.373
> 
> 标签：php, zend-framework

我们采用了一个用 Zend 框架编写的网站。我们没有编写站点，也没有使用过 Zend 框架，所以我有兴趣找到三件事。

1.  如何向站点添加新视图，将新文件夹添加到 application/views/scripts 目录似乎无济于事
2.  是否有任何关于如何向 zend 站点添加附属提要和设置的教程，您可以推荐吗？
3.  有没有学习框架的好教程？到目前为止，我发现的只是大量让我感到困惑的材料

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T12:21:12.523

按顺序回答您的问题：

1.  您必须找到控制器，它将出现您要添加的视图。有两种方法可以渲染视图脚本。第一个是视图脚本的命名约定。视图必须与控制器的操作名称相同。像“indexAction”和 index.phtml。另一种方法是在控制器中实例化一个视图对象，并在运行时给出一个带有视图名称的字符串。你可能想看看这段摘录：

    $view = new Zend_View(); $view->a = "干草"; $view->b = "蜜蜂"; $view->c = "海"; echo $view->render('someView.php');

我取自[http://framework.zend.com/manual/en/zend.view.controllers.html#zend.view.controllers.render](http://framework.zend.com/manual/en/zend.view.controllers.html#zend.view.controllers.render)

2.  我认为我不明白您所说的“附属提要”是什么意思……您是在谈论广告还是更像是内容联合？

3.  您应该阅读的第一件事可能是您可以在此处找到的 Zend 框架学习指南：[http](http://www.zend.com/community/downloads) ://www.zend.com/community/downloads 。那里有许多教程和操作指南，但是，本指南是直接从 Zend 制作的，应该涵盖主要主题。

问候，马里奥

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:45:33.933

Basically, views need corresponding controller actions. So the main index action (located, for example, in application/controllers/IndexController.php) would need a corresponding view at /application/views/scripts/index/index.phtml.

*example:* To reach an action within the Index Controller named fooAction() you would need a view file at /application/views/scripts/index/foo.phtml.

*example:* To reach the index action of contact controller you would need the controller at /application/controllers/ContactController.php (with an indexAction() inside it) and the view at /application/views/scripts/contact/index.phtml.

**Getting beyond the absolute basics...** view rendering can also be turned off or redirected but that is getting beyond the basics. Also if the app uses Zend_Layout there will be a layout file located somewhere like application/layouts/scripts/layout.phtml

Clear, concise and current ZF info can be strangely hard to come by. For tutorials check out:

1.  [The ZF Quickstart](http://framework.zend.com/docs/quickstart)
2.  [Rob Allen's tutorial](http://akrabat.com/zend-framework-tutorial/)
3.  [Some screencasts](http://mitchellhashimoto.com/zend-framework-tutorials/getting-started/)

For adding feeds I suppose you should check out the [framework's documentation for Zend_Feed](http://framework.zend.com/manual/en/zend.feed.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T12:02:38.373

您是否也添加了适当的 Zend_Controller ？[Zend_Controller QuickStart](http://framework.zend.com/manual/en/zend.controller.html#zend.controller.quickstart.go)是开始使用 MVC 的好地方。

您还可以查看[Zend_Tool](http://framework.zend.com/manual/en/zend.tool.project.html "Zend_Tool")，它提供了一个脚本来帮助创建必要的结构。

# java - 关于Java正则表达式的问题

> ID：776826
> 
> 赞同：3
> 
> 时间：2009-04-22T11:49:14.567
> 
> 标签：java, regex

我从数组列表中得到一个字符串：

```
array.get(0).toString() 
```

给出 TITLE = "blabla"

我想要字符串 blabla，所以我试试这个：

```
Pattern p = Pattern.compile("(\".*\")");
Matcher m = p.matcher(array.get(0).toString());
System.out.println("Title : " + m.group(0)); 
```

它不起作用：`java.lang.IllegalStateException: No match found`

我也尝试：

```
Pattern p = Pattern.compile("\".*\"");
Pattern p = Pattern.compile("\".*\"");  
Pattern p = Pattern.compile("\\\".*\\\""); 
```

我的程序中没有任何匹配项，但所有模式都适用于[http://www.fileformat.info/tool/regex.htm](http://www.fileformat.info/tool/regex.htm)

任何的想法？提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-22T12:05:09.647

几点：

[Matcher#group](http://java.sun.com/javase/6/docs/api/java/util/regex/Matcher.html)的 Javadoc指出：

> IllegalStateException - 如果尚未尝试匹配，或者之前的匹配操作失败

也就是说，在使用组之前，必须先使用`m.matches`（匹配整个序列），或`m.find`（匹配一个子序列）。

其次，您实际上想要`m.group(1)`, 因为`m.group(0)`是整个模式。

实际上，这在这里并不那么重要，因为所讨论的正则表达式以捕获括号开始和结束，因此 group(0) 与 group(1) 是相同的字符串，但如果您的正则表达式看起来像这样就很重要：`"TITLE = (\".*\")"`

示例代码：

```
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.junit.Test;

@SuppressWarnings("serial")
public class MatcherTest {

    @Test(expected = IllegalStateException.class)
    public void testIllegalState() {
        List<String> array = new ArrayList<String>() {{ add("Title: \"blah\""); }};
        Pattern p = Pattern.compile("(\".*\")");
        Matcher m = p.matcher(array.get(0).toString());
        System.out.println("Title : " + m.group(0));
    }

    @Test
    public void testLegal() {
        List<String> array = new ArrayList<String>() {{ add("Title: \"blah\""); }};
        Pattern p = Pattern.compile("(\".*\")");
        Matcher m = p.matcher(array.get(0).toString());
        if (m.find()) {
            System.out.println("Title : " + m.group(1));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-22T12:03:30.570

您需要首先在 Matcher 实例上调用`find()`or `matches()`：它们实际上执行正则表达式并返回它是否匹配。然后只有当它匹配时，您才能调用方法来获取匹配组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:00:17.520

您是否在字符串中包含双引号 (")？

您所有的正则表达式都已转义 "s，并且仅当列表中的字符串包含双引号字符时才会匹配。

# asp.net - 在 vb 中打开图像以发送到数据库 - Asp.Net

> ID：776827
> 
> 赞同：0
> 
> 时间：2009-04-22T11:49:16.783
> 
> 标签：asp.net, vb.net, image

我目前正在修补一个 asp.net 程序，我需要能够将图像发送到 SQL Server 2005 DB。当我使用 asp:fileupload 控件时它工作正常，但诀窍是当用户删除图像时，我应该用服务器中的图像替换它，在代码隐藏中说“空”。

我知道如何在 vb 中打开、使用和保存文本文件，但是我无法在任何地方找到有关如何以类似方式打开图像/二进制文件的任何信息，以便我可以将其用作更新时的 sql 参数询问。

下面是一个使用 fileupload 控件中的文件是多么容易的示例。

```
            Dim t_id As Integer = Convert.ToInt32(Request.QueryString("id"))

            打开（）

            暗淡图片 As New SqlParameter("@picture", pictureFileUpload.FileBytes)
            将 id 作为新的 SqlParameter("@id", t_id)

            myCommand = 新 SqlCommand("spChangeImage")
            myCommand.CommandType = CommandType.StoredProcedure
            myCommand.Connection = conn

            myCommand.Parameters.Add(图片)
            myCommand.Parameters.Add(id)

            myCommand.ExecuteNonQuery()
            关闭（）

```

现在我需要一种打开图像文件并以类似方式将其设置为参数的方法，但我不知道如何去做。所有搜索结果都集中在打开和查看 html 中的图像，我只需要二进制文件就可以在查询中使用它。我正在尝试使用 binaryreader，但即便如此我也不知道如何实际映射文件开始。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T11:51:25.793

[这](https://stackoverflow.com/questions/744589/how-do-you-store-a-picture-in-an-image-column/744603#744603)可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:19:54.027

就个人而言，当用户删除其值时，我不会将此图像存储在数据库中。我会将列设置为空。写入图像时，我会检测列是否为空，*然后*读取文件并将其写入响应。如果这样做，则无需将任何内容累积到本地缓冲区中，只需在读取每个缓冲区时将其写入响应即可。您可以使用 FileInfo.Length 来确定响应的内容长度。

如果您坚持将图像放入 DB，您还可以使用 FileInfo.Length 来确定保存图像所需的缓冲区大小。使用 BinaryReader 将此长度的字节读入缓冲区。然后缓冲区成为 SQL 命令的参数。

# sql - 表值函数中的动态视图名称

> ID：776830
> 
> 赞同：0
> 
> 时间：2009-04-22T11:49:51.897
> 
> 标签：sql, sql-server, sql-server-2005

我将视图名称作为表值函数中的参数传递，并且我想通过构建动态 SQL 并通过 sp_executesql() 执行它来从该视图中获取一些数据。尝试执行该函数时，出现错误：只能从函数内执行函数和扩展存储过程。

数据库管理系统：SQL Server 2005

任何解决方法？

```
set @SQLString = 
       N'select @Desc = Description from ' 
     + @TableName 
     + ' where Code = @Code;'

execute sp_executesql @SQLString, 
     N'@Code nvarchar(500), 
       @Desc nvarchar(500) OUTPUT', 
       @Code = @Code, 
       @Desc=@Desc OUTPUT; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T12:55:29.010

好吧，您可以将动态 SQL 包装在扩展存储过程中。那会奏效，但我（强烈）建议不要这样做。

SQL Server 要求用户定义的函数是确定性的（除了前面提到的扩展存储过程）——即函数的结果应该可以从输入参数中统一预测。由于存储过程可以从任何地方访问数据、使用随机数等，SQL Server 不允许您在函数中使用它们。

您还可以使用其他方法，例如使用数据预填充表变量、修改模式等，这取决于您的性能要求和模式设置方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T12:56:25.933

没有，除非你想通过调用像 xp_cmdshell 这样的扩展过程来进行环回查询

像这样，修改以满足您的需求

```
CREATE FUNCTION fnBla(@id int)
RETURNS int
AS
BEGIN
DECLARE @SQL varchar(500)
SELECT @SQL='osql -S' +@@servername +' -E -q "exec tempdb..prLog ''fnBla''"'
EXEC master..xp_cmdshell @SQL
RETURN @id
END 
```

只是为了让您知道我不会这样做，因为您正在创建一个环回查询并且没有执行最安全的代码，因为您不能使用 proc 而不是函数？

# svn - TortoiseSVN 菜单中是否有特殊命令可以清除目录的 svn-relation？

> ID：776831
> 
> 赞同：1
> 
> 时间：2009-04-22T11:50:15.780
> 
> 标签：svn, tortoisesvn

我将我的一个文件夹与一个 Subversion 存储库链接。目的是同步我的家庭个人文件夹和办公室个人文件夹。

后来，我放弃了。

现在，我想删除这个文件夹的存储库关系，而不会对里面的内容造成任何损害。我只是希望它恢复为标准的 Windows 文件夹。

我之前尝试搜索和删除`.svn`另一个与 SVN 相关的文件夹上的所有文件夹。但这并不顺利。

我正在寻找诸如“取消 SVN 关系”之类的命令。

有这样的事情吗？

**可能重复：** [“Un-SVN”工作副本](https://stackoverflow.com/questions/183114/un-svn-a-working-copy)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T11:53:12.170

使用`Export`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T12:01:41.837

在 TortoiseSVN 中，您可以导出到当前目录。然后 TortoiseSVN 将为您删除 .svn 目录（在您确认这是您想要做的之后）。

这不是标准的 Subversion 功能，但它是使用 TortoiseSVN 的最简单方法。所有其他客户端的推荐做法是导出到新目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T11:53:14.777

我通常只是删除包含要与 SVN 解除关联的内容的文件夹中隐藏的 .svn 文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T11:58:52.797

删除 .svn 文件夹就足够了。请参阅此[链接](http://www.daniweb.com/forums/thread61479.html)以获取它将为您完成工作的脚本。从那里复制：

```
FOR /F "tokens=*" %%G IN ('DIR /B /AD /S *.svn*') DO RMDIR /S /Q "%%G" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T12:13:33.837

只需 F3，.svn 删除所有找到的文件夹。甚至更好的出口

# flash - 如何实现基于 Flash 的 jabber 客户端？

> ID：776846
> 
> 赞同：0
> 
> 时间：2009-04-22T11:54:44.973
> 
> 标签：flash, iframe, xmpp, polling

我们正在尝试开发基于 Flash 的 jabber 客户端。我们如何在不实现 iframe 的情况下加载新页面时最大限度地减少轮询服务器的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-23T13:10:11.697

您可以查看在客户端存储一些数据。这通常在 Flash 游戏中完成以保存进度等。使用 Jabber，不需要像游戏那样使用这些数据进行“作弊”检测。

另一种选择可能是使用 LocalConnection 类来运行两个 Flash 小程序，一个将随页面重新加载，一个在隐藏框架中运行。隐藏的小程序将存储大部分信息以重新初始化主小程序。

另一种方法是一起消除问题，并通过 AJAX 或类似方式更新页面，而不是重新加载。

# diff - 如何比较 Linux 中的两个源代码树？

> ID：776854
> 
> 赞同：43
> 
> 时间：2009-04-22T11:58:23.750
> 
> 标签：diff

我有两个目录，其中包含一个项目的源文件，我几乎没有通过文档来继承这个项目。如何比较两个目录以查看差异是什么？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-04-22T12:03:50.350

试试这个：

```
diff -Naur dir1/ dir2/ 
```

*   该`-u`选项使输出更易于阅读。
*   该`-r`选项在所有子目录中递归
*   和选项`-N`只有`-a`在您想创建补丁文件时才真正需要。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-04-22T12:01:27.970

你可以试试[Meld](http://meld.sourceforge.net/)。这是一个很棒的视觉差异工具 ;-)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-04-22T12:03:49.430

```
diff -u -r dirA dirB 
```

将向您展示 dirA 和 dirB 中的文件之间的统一递归差异

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-22T12:01:45.973

您可以在 shell 中使用 diff 命令。或者安装[KDiff3 之](http://kdiff3.sourceforge.net/)类的工具。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-21T17:17:17.130

当我知道存在差异时，用于比较目录的 diff 命令不断告诉我我没有差异。

我没有直接使用 diff，而是使用 md5sum 的排序列表，然后将这些文件与 diff 进行比较：

```
find /path1/dir/ -type f -exec md5sum {} + | awk '{print $2 $1}' | sort >! path1.log
find /path2/dir/ -type f -exec md5sum {} + | awk '{print $2 $1}' | sort >! path2.log
gvimdiff path1.log path2.log 
```

如果路径的开始部分令人头疼，那就改变它。选择 Path1 窗口并输入：

```
:%s|path1|path2|g 
```

这将在第一个文件中将 path1 的所有实例替换为 path2，现在您的差异应该只显示差异。

# sql - 在 mysql 中重用计算列

> ID：776857
> 
> 赞同：1
> 
> 时间：2009-04-22T11:58:39.270
> 
> 标签：sql, mysql

如何在 MySQL 的 SQL 中重用计算列？说：我的查询类似于：-

```
SELECT 
    CONVERT_TZ(
        if(timestamp_start > last_update, timestamp_start, last_update), 
        'GMT', 
        user.timezone
    ) as time_usr_tz
from 
    shecdule
    inner join user on shecdule.user_id = user.user_id
where 
    CONVERT_TZ(
        if(timestamp_start > last_update, timestamp_start, last_update), 
        'GMT', 
        user.timezone
    )
    < CURRENT_TIMESTAMP(); 
```

如果您看到查询，则重复“CONVERT_TZ.....”部分。

这只是一个示例查询。实际上，我必须多次使用该计算列。因此，如果我在一个地方进行更改，我必须在许多地方进行更改。查询的大小也变得可怕。

有没有办法避免这种重复？

**更新** 我的原始查询中已经有子查询，所以子查询不是一个更好的选择。是否有可能以任何其他方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T12:01:51.027

```
SELECT  ctz
FROM    (
        SELECT  shecdule.*,
                CONVERT_TZ(
                if(timestamp_start > last_update, timestamp_start, last_update), 
                'GMT', 
                user.timezone
                ) AS ctz
        FROM    shecdule
        INNER JOIN
                user
        ON      user.user_id = s.user_id
        ) s
WHERE  ctz < CURRENT_TIMESTAMP() 
```

请注意，此查询不会有效地使用`timestamp_start`索引`last_update`。

请参阅我的博客文章中的性能详细信息：

*   [**选择时区的时间戳**](http://explainextended.com/2009/04/25/selecting-timestamps-for-a-time-zone/)

总之，你最好使用这个：

```
SELECT  ctz
FROM    (
        SELECT  shecdule.*,
                CONVERT_TZ(
                if(timestamp_start > last_update, timestamp_start, last_update), 
                'GMT', 
                user.timezone
                ) AS ctz
        FROM    shecdule
        INNER JOIN
                user
        ON      user.user_id = s.user_id
        WHERE   timestamp_start < CURRENT_TIMESTAMP() + INTERVAL 14 HOUR
                OR last_update < CURRENT_TIMESTAMP() + INTERVAL 14 HOUR
        ) s
WHERE  ctz < CURRENT_TIMESTAMP() 
```

此内部查询将对索引执行粗略过滤`timestamp_start`并`last_update` 使用索引（没有区域转换可以从 偏移超过`+14:00`几小时的时间`UTC`）。

然后，外部子查询将根据用户的时区对结果进行精细过滤。

如果你不喜欢子查询，你也可以使用：

```
SELECT  shecdule.*,
        CONVERT_TZ(
        if(timestamp_start > last_update, timestamp_start, last_update), 
        'GMT', 
        user.timezone
        ) AS ctz
FROM    shecdule
INNER JOIN
       user
ON      user.user_id = s.user_id
/* 
        WHERE   timestamp_start < CURRENT_TIMESTAMP() + INTERVAL 14 HOUR
                OR last_update < CURRENT_TIMESTAMP() + INTERVAL 14 HOUR
*/
HAVING  ctz < CURRENT_TIMESTAMP() 
```

# delphi - 在写入文件之前，我应该使用 TMemoryStream 作为有效的缓冲区吗？

> ID：776861
> 
> 赞同：4
> 
> 时间：2009-04-22T11:59:36.210
> 
> 标签：delphi, file-io

我正在使用 D6 Professional，需要从内存中已有的大量小字符串创建特定格式的文本文件。出于性能原因，我正在考虑使用 TMemoryStream 来整理文件数据，然后通过 TFileStream 将其一次性写入磁盘。

但是我有一半被遗忘的记忆（可能从 D6 之前的日子开始）在某处阅读 TMemoryStream 效率低下，尤其是在它达到其容量大小之后。我的 Delphi（和 Windows API）技能不足以自己检查 Classes.pas 代码。

（OFFTOPIC）尤其是这样的代码：（Classes.pas 的第 5152 行）：
NewCapacity := (NewCapacity + (MemoryDe​​lta - 1)) 而不是 (MemoryDe​​lta - 1);
（/题外话）

更让我担心的是，相关问题 [Using MemoryStream to write out to XML](https://stackoverflow.com/questions/486843/using-memorystream-to-write-out-to-xml)
的结论**不是**使用 TMemoryStream，但没有说明原因 - 无论是由于 TMemoryStream 本身，还是因为 TFileStream 或 I /O 设备驱动程序，或者只是相关代码的细节。

感谢您的任何建议
问候，
PhilW。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-22T12:09:14.270

一个普通的 TFileSram 也做缓冲，这足以优化 I/O。将 MemoryStream 放在前面只会增加开销。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-22T18:25:35.083

TFileStream 本身不执行缓冲，由操作系统处理，通常足以满足大多数目的。

我的建议是构建一个将数据写入流的方法，然后将 TSTream 参数传递给该方法。这样您就可以轻松地测试不同的选项，而不会影响您的程序。

例如：

```
Procedure TForm1.StreamMyObjects(aStream : tStream);
begin
  aStream.Write( MyString[1], Length( MyString ) * SizeOf( Char ));
  aStream.Write( CRLF, Length( CRLF ) * SizeOf( Char ));
  aStream.Write( MyOtherString[1], Length( MyOtherString ) * SizeOf( Char ));
  aStream.Write( CRLF, Length( CRLF ) * SizeOf( Char ));
end; 
```

如前所述，在 JCL 中，有一个 TJclBufferedStream ，然后您可以对其进行测试以查看是否有任何性能优势，这将根据您的写作内容和写作量而有所不同。例如，以下将测试 TFileStream 和 tJCLBufferedStream 以查看差异是什么（是的，我知道我错过了 TRY/FINALLY）：

```
var
  fstm : tFileSTream;
  fBufStm : tJCLBufferedStream;
  iTicks : Cardinal;
  fModes : word; // for SO formatting.
begin
  fModes := fmOpenReadWrite or fmCreate or fmShareExclusive;

  iTicks := GetTickCount;
  fstm := tFilestream.create('test1.txt',fModes);
  StreamMyObjects( fStm );
  fstm.free;
  ShowMessage('TEST1='+IntToSTr(GetTickCount-iTicks));

  iTicks := GetTickCount;
  fstm := tFilestream.create('test2.txt',fModes);
  fBufStm := tJclBufferedStream.create( fStm );
  StreamMyObjects( fBufStm );
  fBufStm.free;
  fstm.free;
  ShowMessage('TEST2='+IntToSTr(GetTickCount-iTicks));
end; 
```

在我的测试中，以下例程：

```
procedure TForm1.StreamMyObjects(aSTream: tStream);
var
  St : string;
  ix : integer;
begin
  for ix := 0 to 10000 do
    begin
      St := 'This is a string which is written to a stream. ' + IntToStr(ix);
      aStream.Write(st[1], Length(st) * SizeOf(Char) );
    end;
end; 
```

为 tFilestream 返回 47，为 tJCLBufferedStream 返回 16。没有循环，时间是微不足道的，这就是为什么你需要测试你的数据......以及你的写作量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T15:08:57.083

您可以使用 TStringList，并调用 SaveToFile 方法。TStringList 有一个优点，即当您向其中添加字符串时不会复制内存。

另一种选择是 Jedi JCL 类 TJclBufferedStream。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-23T14:23:20.537

正如其他人所提到的，在 TFileStream 前面添加一个 TMemoryStream 可能不会让你到达你需要到达的地方。

Julian Bucknall 在“The Delphi Magazine”文章中制作了一组免费软件单元和类，用于向 TStream 对象添加功能。我发现它们在我处理 TStream 对象（尤其是 TFileStream）的大部分过程中都非常有用。

下面的链接来自谷歌代码搜索，并提供对 aaStrms.pas 文件的直接访问。您将需要其他单位（aaIntDeq.pas、aaIntList.pas、aaRegEx.pas 和 aaStrBld.pas）来使用 aaStrms.pas 文件。这些都是非可视类，所以您需要做的就是包含该单元并实例化该类。

[http://www.google.com/codesearch/p?hl=en#7-hAM65i1Xc/disks/dmag70.zip|alfresco/AAStrms.pas&q=lang:pascal%20aaStrms](http://www.google.com/codesearch/p?hl=en#7-hAM65i1Xc/disks/dmag70.zip|alfresco/AAStrms.pas&q=lang:pascal%20aaStrms)

我建议 TaaWriteBufferFilter 类是您要使用的类。

高温下，

瑞安

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-23T07:34:05.607

我会调查是否值得你自己构建一个有限大小的缓冲区。将少量位写入 TFileStream 很慢（尤其是在存储卷上禁用延迟写入时），因为磁盘驱动程序必须在每个位上定位要写入的扇区。因此，如果您使用一个只有几个扇区大小的缓冲区（安全猜测是 512KB 或 1MB），并在缓冲区已满时写入，它会加快您的工作，而不必担心如何处理巨大的膨胀TMemoryStream。

# jsp - maven，jsp文件依赖

> ID：776874
> 
> 赞同：10
> 
> 时间：2009-04-22T12:01:36.627
> 
> 标签：jsp, maven-2

我正在使用 maven2 进行依赖管理。我有一个项目包含一些 Java 文件和一些 jsp 文件以及另一个项目，一个 web 项目，它依赖于第一个项目。如何从 Web 项目访问 jsp 文件？

我可以看到 jsp 文件被添加到`1-0-SNAPSHOT-sources.jar`而不是`1-0-SNAPSHOT.jar`（在 web 项目 pom.xml 中作为依赖项添加）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-05T16:41:25.413

我认为正确的 Maven 方法是将 JSP 文件放在 /src/main/webapp 下的 Web 项目中。如果由于某种原因无法做到这一点，您可以使用[Maven 依赖插件](http://maven.apache.org/plugins/maven-dependency-plugin/)将所需的文件复制到您的 web 应用程序中。或者，如果您有一个 WAR 项目，您可以使用[Overlay](http://maven.apache.org/plugins/maven-war-plugin/overlays.html)来复制 JSP 文件。第二个选项（我推荐）看起来像这样：

```
 <build>
      <plugins>
        <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-war-plugin</artifactId>
          <configuration>
            <overlays>
              <overlay>
                <groupId>myGroupId</groupId>
                <artifactId>myArtifactId</artifactId>
                <type>jar</type>
                <includes>
                  <include>**/*.jsp</include>
                </includes>
                <targetPath>WEB-INF/pages</targetPath>
              </overlay>
            </overlays>
          </configuration>
        </plugin>
      </plugins>
    </build> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-22T13:35:46.943

该解决方案的问题在于，在使用 Eclipse 进行开发时，项目不处理覆盖。所以，jsp是不可访问的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T05:22:34.867

我希望将依赖项 JAR 项目中的一些文件放入我的 WEB 项目中。

我已经这样做了，因此我不仅可以在打包 WAR 时获得这些文件，还可以在运行 maven servlet 容器插件（即 jetty:run 或 tomcat:run）时获得这些文件。

所以这对我有用：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-dependency-plugin</artifactId>
    <version>2.1</version>
    <executions>
        <execution>
            <id>copy-files-to-webapp-directory</id>
            <phase>compile</phase>
            <goals>
                <goal>unpack</goal>
            </goals>
            <configuration>
                <artifactItems>
                    <artifactItem>
                        <groupId>com.my.project</groupId>
                        <artifactId>my-amazing-project</artifactId>
                        <type>jar</type>
                        <overWrite>true</overWrite>
                        <outputDirectory>src/main/webapp</outputDirectory>
                        <includes>**/*.jsp, **/*.css, **/*.png</includes>
                    </artifactItem>
                </artifactItems>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

希望对寻找类似解决方案的人有所帮助

# sql-server - 我在哪里可以获得远程 Blob 存储示例数据库？

> ID：776888
> 
> 赞同：1
> 
> 时间：2009-04-22T12:05:10.550
> 
> 标签：sql-server

我正在研究 SQL server 2008 远程 blob 存储功能。

[http://www.codeplex.com/sqlrbs](http://www.codeplex.com/sqlrbs)

我遇到了这个网站。他们在这个网站上提到了示例数据库，你能建议我在哪里可以获得 RBS 数据库吗？

请建议，我可以在哪里获得有关 RBS 的更多信息。

提前致谢。苏达卡尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T12:27:21.853

大多数 SQL Server 2008 示例在此处共享：http: //msftdbprodsamples.codeplex.com/Release/ProjectReleases.aspx?ReleaseId= [18407](http://msftdbprodsamples.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=18407)

它可能有您正在寻找的数据库。

# uml - UML 是制作软件蓝图的正确语言吗？

> ID：776889
> 
> 赞同：3
> 
> 时间：2009-04-22T12:05:15.090
> 
> 标签：uml

上周我与一位同事就建筑（真正的建筑，如设计建筑）进行了交谈。在我们的谈话中，建筑蓝图为建筑师、土木工程师和承包商提供了建造某物所需的所有细节。它让我们俩都思考了软件工程的现状，并且没有普遍采用的方法来描述软件的设计。

我们有 UML，但我发现通常很难在不过于复杂的图表的情况下传达足够的细节。是否有使用精心设计的 UML 图设计的大型软件的好例子？

话又说回来，拥有大量的软件蓝图有用吗？毕竟重构和重建软件比重建摩天大楼要便宜得多。架构蓝图是软件设计的错误类比吗？你能想到更好的类比吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-22T12:10:37.230

我认为您无法将软件架构与*真实架构*进行比较。当你建造房子时，你必须提前计划好所有的事情，更重要的是你还*可以*提前计划几乎所有的事情。

最近我读到软件工程更类似于园艺而不是*真正的建筑*。我认为这种比较更接近现实：你不知道什么会成功，什么不会；您必须修改理论上看起来不错但被证明不切实际的事情，并且您可以在您的花园/软件变得更加完整的同时不断改进您的计划。

总而言之：软件蓝图的详细程度不应与建造房屋的蓝图相同，因为您经常会发现您根本无法坚持最初的计划。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T12:19:31.670

我会说设计软件比蓝图更接近 Mad-Libs

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T12:57:26.290

建筑蓝图是实际房屋的近乎精确的表示。它们通常不是符合房屋外观模型的抽象，它们是*房屋外观**的*代表。

 *与 UML/流程图/Rational Rose/每月方法论进行对比——这些都是模型。他们抽象出实现细节，并*假设*给定的模型（比如，OO）是软件应该是的样子，而*实际上*，软件总是打破这些抽象，因为模型不是一个好的表示。

从某种意义上说，这与解释力和可计算性有关：房屋蓝图是具有固定表达和固定输入的固定表示；而软件蓝图必须考虑可变输入，甚至可能是无限长度。允许插件或其他“计算”连接的软件现在具有相当于嵌入其中的图灵机操作员，这导致了*许多*不可预测性。因此，软件*相对于*房屋的输入空间在数学上更大，这意味着表示技术必须相应地在计算上更强大。这就是 UML*等人的地方。*跌倒 - 它们与真实软件不是同态的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T12:20:28.983

[在Software Factories: Assembling Applications with Patterns, Models, Frameworks, and Tools](https://rads.stackoverflow.com/amzn/click/com/0471202843)中提出的论点之一是 UML 是不够的。即使添加了约束，仍然不清楚。除此之外，它并没有充分表达作者的意图，以至于可以可靠地生成好的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T12:21:51.027

UML 很好，但粗略绘制的白板图照片在实践中同样好或更好（在时间/成本方面）

所以这更像是在发动攻击之前在沙地上制定策略，这种态度在大多数情况下似乎更有效。

除了一半的时间 UML 是由一些有很多想象力的人绘制的，并且在实际实施中没有投资。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T13:03:07.540

对于大型、计算密集、寿命长、对安全至关重要的软件系统，如 DoD 和 FAA 武器和传感器系统，蓝图**对于**长期成功至关重要。（呸，真是拗口 :)）如果没有为这些庞然大物制定一套蓝图，维护者，甚至是最初的开发者，当他们试图定位/修复错误或添加主要功能时，都会感到痛苦和沮丧。如果没有蓝图，整合变化，即使是很小的变化，都将成为一场高风险的游戏，失败可能意味着下游的生命损失。

话虽如此，UML 和它的后代 SysML，是（现在）城里唯一的游戏。建模和抽象是对抗模糊性和复杂性的重要工具，它们在未来将变得更加重要。他们越早被想要成长的人所接受，越好。

感谢聆听。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-09T23:55:31.947

我刚刚完成了一个成功的 C#/Sql Server 项目，我使用 UML 图充实了应用程序设计。该 UML 图避免了对应用程序设计做什么和不做什么的任何误解。所有的类关系以及类删除规则（复合、聚合、无）都被详细说明。除了几个易于理解的状态图和一些 OCL（对象约束语言）之外，与利益相关者讨论应用程序应该如何工作是一件轻而易举的事。UML 和 OCL 抽象出大量我能够避免的平凡和低级编程。UML 和 OCL 非常简单，用户可以理解幕后发生的事情。当我的用户询问计算是如何得出的时，我只是将他们引向 UML 和 OCL。还有什么比这更容易的？所以，是的，恕我直言 UML 非常适合制作软件蓝图。关于采用领域驱动开发有一些话要说。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-22T12:23:25.827

文本+图表的组合通常是解释您的架构如何工作的最佳方式。Rational Rose 只能让你走这么远。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-22T12:42:58.760

我认为任何比喻都只会延伸到此为止。将编程的某些方面与建造房屋进行比较，以及将不同方面与园艺/下棋/读字典进行比较，您将获得价值……

我认为在建筑中指定特定项目所需的详细程度更容易，因为管理建筑项目已经存在一段时间的普遍接受的做法。

也许在 50 年后，如果每个人都确定一种方法论，我们的行业也会发生类似的事情。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-22T13:07:08.857

以我的经验，uml 是垃圾。

您可以通过使用 TDD 获得更多，并获得 10000 倍的乐趣……通过参与并编写测试用例并查看对象如何交互。

UML 设计简直糟透了。我是编码员，不是数据输入类型的人。

在 TDD 之前，我用随机的纸片勾勒出基本的实体和关系，然后直接开始编码。

我没有看到这些工具被普遍使用，而且它们的受欢迎程度正在下降。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-22T13:34:48.137

我会说UML是有限的。是的，您可以表示基本的关系，但是当您考虑交互和约束（即使使用 OCL）时，您仍然没有得到太多

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-22T23:07:28.057

如果您想为软件团队提供“他们构建某些东西所需的所有细节”，那么就将您的精力投入到需求分析中并创建一个明确的功能规范。这将包含客户想要的每个功能的描述。如果这些描述包括 UML 图，那么一切都很好——在许多情况下，UML 是一种比英语/法语/德语/任何用于描述软件的语言更好的语言——但不要为了它而挂在创建 UML 图上。Joel on Software 有一系列关于如何编写功能规范的专题文章，它们非常值得一读 - 从这里开始：http: [//www.joelonsoftware.com/articles/fog0000000036.html](http://www.joelonsoftware.com/articles/fog0000000036.html)。

# java - 从 JComboBox 中删除边框

> ID：776893
> 
> 赞同：3
> 
> 时间：2009-04-22T12:07:41.557
> 
> 标签：java, border, jcombobox, noborder

你知道有什么方法可以从 Java 中的 JComboBox 中删除边框吗？我尝试以下代码

```
public class ComboFrame extends JFrame {
    public ComboFrame() {
        JPanel container = new JPanel();

        JComboBox cmb = new JComboBox(new String[] { "one", "two" });
        cmb.setBorder(BorderFactory.createEmptyBorder());
        container.add(cmb);

        getContentPane().add(container);
        pack();
    }
} 
```

和

```
public static void main(String[] args) throws Exception {
    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            new ComboFrame().setVisible(true);
        }
    });
} 
```

不要问为什么有人要从组合框上删除边框......我想这没有太大意义，但这就是它想要的方式，我真的很好奇它是否可以完成。我尝试了几种技巧，但都没有奏效。

最有效的是用

```
cmb.setUI(new BasicComboBoxUI()); 
```

这使边框消失，但改变了 L&F，如果可能的话，我需要保留 Windows L&F。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-22T15:34:58.127

我做了一些研究，发现[了这个错误](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4515838)

我为自己尝试过，它似乎确实影响了边界。您可能想自己尝试以下代码块中的一个或两个。

```
for (int i = 0; i < combo.getComponentCount(); i++) 
{
    if (combo.getComponent(i) instanceof JComponent) {
        ((JComponent) combo.getComponent(i)).setBorder(new EmptyBorder(0, 0,0,0));
    }

    if (combo.getComponent(i) instanceof AbstractButton) {
        ((AbstractButton) combo.getComponent(i)).setBorderPainted(false);
    }
} 
```

请务必注意，在错误条目的底部，您可以阅读以下内容：

> JButton 维护它自己的边框，因此 JComponent **paintBorder()**和**paintComponent()**不知道 JComboBox 边框。

祝你好运，

杰奇！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-25T14:18:32.220

如果您想使用 Windows L&F，您可以这样做`cmd.setUI(new WindowsComboBoxUI());` 。但是，如果您希望能够使用任何 L&F，则最好使用 Jeach 提出的解决方案。

# cab - 复合应用程序块中的开关模块

> ID：776895
> 
> 赞同：0
> 
> 时间：2009-04-22T12:08:19.933
> 
> 标签：cab

我是 CAB 框架的新手。通过示例 GPS 应用程序后，我了解了如何加载单个模块并显示其视图。

我有一个项目，其中有 3 个表格。我应该为此创建一个具有三个不同视图的单个模块，还是应该为此创建三个不同的模块。

如果我创建三个视图，我如何在这些视图之间切换。如果我正在创建三个不同的模块，我如何在这些模块之间切换。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-17T11:28:43.527

如果您总是将这三种形式一起使用，请将它们放在同一个模块中。如果您在给定时间只需要其中的一两个表单，请将它们放在单独的模块中，这样您就可以按需加载所需的表单。

我不明白“在模块之间切换”的确切含义。如果您参考如何在应用程序启动时选择要加载的模块，您可以通过覆盖引导程序中的 GetModuleCatalog 方法并在被覆盖的方法中创建模块目录来实现。如果您的意思是如何在应用程序的任何位置动态加载模块，您可以使用容器的 IModuleManager 对象中的 LoadModule 方法来实现。

# java - 评估业务规则引擎的标准

> ID：776901
> 
> 赞同：10
> 
> 时间：2009-04-22T12:09:16.517
> 
> 标签：java, enterprise, rule-engine, business-rules

我们正在购买业务规则引擎。我们希望使我们的核心应用程序可针对具有略微不同要求的不同客户进行定制。真正进行定制的人是分析师。即技术熟练的非程序员（通常具有科学学位）。

评估业务规则引擎的标准是什么？有开源的和商业的吗？您在易用性、文档、支持、价格等方面有何经验？

我们的应用程序是 Java 语言。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-27T21:40:14.000

我在业内领先的规则引擎担任顾问近三年。您将为商业规则引擎支付大量资金，并且需要确定您可能获得的功能和支持是否物有所值。所有规则引擎供应商都会声称他们是最好的；我能给你的最好建议是用你正在考虑的每个规则引擎做一个原型，它的范围有限，但代表了你需要的功能。不要让销售人员只是给你看一个花哨的演示；您应该积极构建原型。我见过太多人购买了一个真正不知道他们购买的是什么的规则引擎。就个人而言，如果您对规则引擎有兴趣，我会选择其中一个开源规则引擎（有人已经提到过 Drools）。然而，我会认真考虑与规则引擎一起不使用规则引擎的可能性。最初使用规则引擎（忽略学习曲线）可能会节省时间，但从长远来看，自定义解决方案可能会更好地满足您的特定需求。

以下是 Martin Fowler 网站上与您的问题相关的几个链接：

*   [http://www.martinfowler.com/bliki/RulesEngine.html](http://www.martinfowler.com/bliki/RulesEngine.html)
*   [http://www.martinfowler.com/bliki/DomainSpecificLanguage.html](http://www.martinfowler.com/bliki/DomainSpecificLanguage.html)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-22T12:23:33.767

[Drools](http://www.jboss.org/drools/)（以前是 Drools，后来是 JBoss Rules，又是 Drools）是一个非常好的开源规则引擎，绝对值得一看。

在我看来，评估规则引擎的最佳标准是：

*   是否可配置（否则您只需编写代码）
*   是否表现出色。
*   非技术人员更改规则有多容易
*   部署新规则集（以及取消部署旧规则集）有多容易。

一些规则引擎具有[业务规则管理](http://en.wikipedia.org/wiki/BRMS)系统 (BRMS)，Drools 也不例外。这使得非技术人员的部署更加容易。

通过网络上的文档和教程，甚至通过 IRC 频道，对 Drools 有很好的支持。

我还使用了 IBM Websphere Process Server 附带的规则引擎，发现它也非常好（尽管价格昂贵）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-04T21:21:15.203

我与许多商业供应商合作，与马丁不同，我与他们的很多客户交谈。现实情况是，业务规则管理系统在第一个项目中发挥作用并回报了在学习曲线等方面的投资，早在减少维护和增加业务用户的好处开始发挥作用之前。Drools 作为开源解决方案和领先的解决方案非常出色商业产品有： IBM/ILOG Rules（.Net、Java 和 COBOL） FICO Blaze Advisor（.Net、Java 和 COBOL） InRule Technology (.Net) Innovations Software (Java) Oracle 和 SAP 在其平台中都有规则引擎越来越完整。[我在http://jtonedm.com/category/product-news/](http://jtonedm.com/category/product-news/)上查看了很多新版本以及少数产品

Forrester 有一份关于我推荐的业务规则的不错的 wave 报告，并且在我的网站上有一篇讨论它的帖子（我会链接到该帖子，但 stackoverflow 不会让我添加第二个链接） - 如果您需要答案，请与我联系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-28T00:23:59.403

许多人决定他们想要一个规则引擎，他们想要的是一个完整的工作流管理过程，其中包括作为执行管道一部分的规则引擎。

工作流是动作的有向图。动作是发生的事情，例如规则集、计算、甚至网络服务调用。您应该能够有一个可以调用其他工作流的操作。

This allows your business analysts to do entire-process implementations, not just do simple if-then-else (hah, some commercial rule engines can't even do else! see the comment about evaluating options before deciding) rules, be it simple sequential rules or FCIRE (forward chaining inference rule engine). Most business analysts find simple sequential rulesets easier to think about. It needs to be done at the workflow level because the third parties that the BAs interpret into rules have a tendency to change their entire decision/acceptance/rejection/domagick processes with very little notice.

# c# - 找出运行 ac# 应用程序所需的所有文件

> ID：776902
> 
> 赞同：3
> 
> 时间：2009-04-22T12:10:26.683
> 
> 标签：c#, visual-studio-2008, all-files

我需要生成足以在任何机器上运行我的应用程序的所有文件的列表。我需要这个来安装程序。当我转到 bin/release 文件夹时，我可以看到一些 pdb 文件和一些配置文件，我认为这些文件是不需要的。我也尝试禁用 pdb 文件的生成，但它仍然为解决方案中存在的其他项目生成 pdb。

所以我需要在 Visual Studio 2008 中找到一种方法，它可以让我的应用程序运行所需的所有文件（.exe 和 .dll 以及其他文件）。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T12:14:03.383

您是否尝试过发布应用程序（构建 > 发布 [app]）？

这应该只是将所有基本文件复制到指定的文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T12:12:17.147

pdb 文件用于调试。在“发布”模式下构建应该排除这些文件。

您还可以在解决方案中创建安装项目。使用该项目可以查看包含文件的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:20:26.333

如果您进行发布构建或发布应用程序，那么您应该拥有应用程序所需的一整套程序集。

但是，它仍然可以依赖驻留在您机器的 GAC（全局程序集缓存）中的程序集。如果您认为 bin 文件夹中缺少程序集，请检查项目的引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T12:24:16.200

为了解决我们软件的这个确切问题，我们编写了一个简单的控制台应用程序，它在我们的项目目录中查找所有 .vbproj 和 .csproj 文件，然后将所有文件更改为发布模式（不创建 pdb 文件、文档文件等） .

然后由构建机器 (CruiseControl.Net) 在开始编译项目之前运行。

# multithreading - 线程/同步

> ID：776907
> 
> 赞同：1
> 
> 时间：2009-04-22T12:12:40.890
> 
> 标签：multithreading, synchronization

从概念和实施的角度来看，两者之间的真正区别是什么

信号量、互斥量、监视器？

我们说信号量是资源分配计数器……好吧，我明白了……

对于互斥量，我们说互斥量是二进制信号量......天哪，那是什么？？？

监视器保护对象的入口点......即只有一个线程可以获取它并且可以运行它的保护入口点之一？？？那么互斥锁有什么用？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T12:26:23.213

信号量是一种锁定机制，iirc 从概念上讲，它们可以配置为允许对一个对象进行多个访问；例如一次访问三个、一次访问四个等。

互斥是信号量的一种特殊情况，用于确保互斥，即在任何给定时间只有一个人可以访问受保护的资源。

需要注意的是，在等待访问共享资源时，信号量和互斥量都不能确保严格的顺序。当资源变得可访问时，一些等待线程将获得访问权限，但不保证将是哪个线程。从统计上讲，最终所有线程都将（必须）获得访问权限。

监视器通过按特定顺序排队等待的线程/进程来强制执行优先级，而不一定是它们如何到达。操作系统是监视器的一个示例——确保单个进程在任何给定时间都拥有 CPU。

# sql-server - 我的 ContainsTable 查询不起作用 - 请帮助 :)

> ID：776908
> 
> 赞同：0
> 
> 时间：2009-04-22T12:12:49.847
> 
> 标签：sql-server, full-text-search, containstable

我有一个全文目录设置。它的唯一键数为 117，包含 19 个项目。该表只有 19 行。

该表有一个名为 ClientGuid 的 NVARCHAR(50) 字段。这是一个指南，结尾有一些奇怪的文字。

例如..

1.  8b6ef4a504dd1a57f079180e7f6eb4a0(-)
2.  8b6ef4a504dd1a57f079180e7f6eb4a0（确定）

（不，我没有定义该文本字段数据 - 我们从第 3 方 API 采购它。

无论如何，这是我的 sql 和我针对它运行的查询。当我运行查询时，我得到零结果:(

```
ALTER FUNCTION [dbo].[Foo_HiJonSkeet]
(   
    @ClientGuid NVARCHAR(50)
)
RETURNS TABLE 
AS
RETURN 
(
    SELECT KEY_TBL.[Key] as LogEntryId,
        KEY_TBL.RANK as Relevance
    FROM CONTAINSTABLE(LogEntries, ClientGuid, @ClientGuid) AS KEY_TBL
)

SELECT * FROM  Foo_HiJonSkeet('8b') 
```

有什么建议么？服务器是 Sql Server 2008。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-10T22:57:18.053

您可以尝试以下构造：

```
SELECT * FROM  Foo_HiJonSkeet('"8b*"') 
```

在原始搜索词后添加双引号和星号。它应该工作。

但是如果所有搜索都与您上面发布的示例相似，我建议您使用`LIKE`语句而不是使用全文搜索。

# .net - NHibernate 和生命周期事件

> ID：776915
> 
> 赞同：1
> 
> 时间：2009-04-22T12:14:15.567
> 
> 标签：.net, nhibernate, entity

[有人可以举一个例子来说明 Ayende 在他的不编写自己的对象关系映射器](http://ayende.com/Blog/archive/2006/05/12/25ReasonsNotToWriteYourOwnObjectRelationalMapper.aspx)的 25 个理由列表中的第 17 项中所说的内容吗

这是 ADO.NET Entity Framework 可以做到的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T12:18:50.940

想象一个 AD 支持的成员模型，它也在 SQL 中存储信息。创建用户时，您可能希望能够在 AD 和 SQL 中创建用户。生命周期事件让您有机会拦截某些事件，如 Create Update 等。以允许您做某事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T12:42:40.773

NHibernate has an event system, where you get events (actually callbacks) when NHibernate is doing something with your entity. The call backs could be registered on the session or just implemented in the entity using an interface.

There are many examples of the usage of such a callback, and it could be vital for a project. Many people are writing audit logs using these callbacks. Or just updating some properties that are not stored in the database. Ayende probably means that with "fetching data from other locations as well".

I don't know if the entity framework has life cycle callbacks. NHibernate is very very very extensible and you can hook you custom code in to nearly every part. Generally I doubt that entity framework is that extensible.

# java - 在浏览器/多个页面上显示 100000 条记录

> ID：776917
> 
> 赞同：4
> 
> 时间：2009-04-22T12:14:54.897
> 
> 标签：java, jsp, jdbc

我想在浏览器/多个页面上显示 100000 条记录，对内存的影响最小。即每页 100 条记录。我想来回移动页面。我的疑问是
1\. 我可以保留内存中的所有记录吗？这是个好主意吗？

2) 我可以为每页进行数据库连接/查询吗？如果是这样，如何编写查询？

谁能帮帮我..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-22T12:18:30.033

在内存中维护这么多记录通常不是一个好主意。如果应用程序被多个用户同时访问，对内存的影响将是巨大的。

我不知道您使用的是什么 DBMS，但是在 MySQL 和其他几个数据库中，您可以依靠 DB 进行分页查询，例如：

```
SELECT * FROM MyTable
LIMIT 0, 100 
```

限制后的第一个数字是偏移量（它将跳过多少条记录），第二个是它将获取的记录数。

请记住，这是 SQL 在每个数据库上都没有相同的语法（有些甚至不支持它）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T12:19:19.690

我不会将数据保存在内存中（无论是在浏览器中还是在服务应用程序中）。相反，我会使用 SQL 浏览结果。

你如何做到这一点可能是特定于数据库的。有关 MySql 中的一个示例，请参见[此处](http://www.plus2net.com/sql_tutorial/sql_limit.php)。其他数据库将存在机制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T13:16:05.747

1）不，将所有记录都保存在内存中会破坏拥有数据库的意义。考虑拥有一个可滚动的结果集，这样您就可以获得所需的功能，而无需使用 SQL。您还可以调整一次提取的记录数，这样您加载的记录就不会超出您的需要。

2) Db 连接的创建和销毁成本很高，但任何严重的系统都会将连接池化，因此对性能的影响不会那么大。

如果您想更花哨，您可以完全取消页面，只需在用户滚动列表时加载更多记录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T12:19:14.807

这不是一个好主意，因为您正在使浏览器可执行文件包含所有这些。

当我有这样的事情要做时，我使用 javascript 来呈现页面，然后进行 ajax 调用以获取下一页。当您获取下一个表格时，显示下一个表格会有一点延迟，但用户已经习惯了。

如果您显示 100 条记录/页，请使用 json 从服务器传递数据，因为 javascript 可以快速解析它，然后使用 innerHTML 放置 html，因为 DOM 在呈现表格时要慢得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-22T17:19:59.123

正如其他人在这里提到的那样，将大量结果列表存储在内存中并不是一个好主意。查询每个页面的结果无疑是一种更好的方法。为此，您有两种选择。一种是使用您的 DBMS 提供的任何数据库特定功能来定位查询结果的特定子部分。另一种方法是使用 JDBC 提供的泛型方法来达到相同的效果。这可以防止您的代码被绑定到特定的数据库：

```
// get a ResultSet from some query
ResultSet results = ...
if (count > 0) {
    results.setFetchSize(count + 1);
    results.setFetchDirection(ResultSet.FETCH_FORWARD);
    results.absolute(count * beginIndex);
}
for (int rowNumber = 0; results.next(); ++rowNumber) {
    if (count > 0 && rowNumber > count) {
        break;
    }
// process the ResultSet below
...
} 
```

使用像 Spring JDBC 或 Hibernate 这样的库可以使这更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-22T12:18:30.127

在许多 SQL 语言中，您都有 LIMIT (mysql, ...) 或 OFFSET (mssql) 的概念。您可以使用这种东西来限制每页的行数

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T12:58:12.590

取决于数据。如果您正在缓存它，100k int 可能还不错。

T-SQL 有 SET @@ROWCOUNT = 100 来限制返回的记录数量。

但要正确执行并返回总页数，您需要更高级的分页 SPROC。

这是一个非常热门的话题，有很多方法可以做到这一点。

这是我写的一个旧 sproc 的示例

```
CREATE PROCEDURE Objects_GetPaged
(
    @sort VARCHAR(255),
    @Page INT,
    @RecsPerPage INT,
    @Total INT OUTPUT
)
AS
SET NOCOUNT ON

--Create a temporary table
CREATE TABLE #TempItems
(
    id INT IDENTITY,
    memberid int
)

INSERT INTO #TempItems (memberid) 
SELECT Objects.id 
FROM Objects
ORDER BY CASE @sort WHEN 'Alphabetical' THEN Objects.UserName ELSE NULL END ASC,
         CASE @sort WHEN 'Created'      THEN Objects.Created ELSE NULL END DESC,
         CASE @sort WHEN 'LastLogin'    THEN Objects.LastLogin ELSE NULL END DESC

SELECT @Total=COUNT(*) FROM #TempItems

-- Find out the first and last record we want
DECLARE @FirstRec int, @LastRec int
SELECT @FirstRec = (@Page - 1) * @RecsPerPage
SELECT @LastRec = (@Page * @RecsPerPage + 1)

SELECT *
FROM #TempItems 
INNER JOIN Objects ON(Objects.id = #TempItems.id)
WHERE #TempItems.ID > @FirstRec AND #TempItems.ID < @LastRec
ORDER BY #TempItems.Id 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-19T18:37:07.487

我建议您选择使用 CachedRowSet 。

CachedRowSet 对象是数据行的容器，将其行缓存在内存中，这使得无需始终连接到其数据源即可进行操作。

CachedRowSet 对象是一个断开连接的行集，这意味着它仅短暂地使用到其数据源的连接。它在读取数据以用行填充自身时连接到其数据源，并在将更改传播回其底层数据源时再次连接。

因为 CachedRowSet 对象将数据存储在内存中，所以它在任何时候可以包含的数据量取决于可用的内存量。为了绕过这个限制，CachedRowSet 对象可以从 ResultSet 对象中以数据块（称为页面）的形式检索数据。为了利用这种机制，应用程序使用 setPageSize 方法设置要包含在页面中的行数。换句话说，如果页面大小设置为 5，则一次会从数据源中获取包含 5 行数据的块。应用程序还可以选择设置一次可以获取的最大行数。如果最大行数设置为零，或者没有设置最大行数，则一次可以获取的行数没有限制。

设置属性后，必须使用方法填充或执行方法为 CachedRowSet 对象填充数据。以下代码行演示了使用方法填充。请注意，此版本的方法采用两个参数，一个 ResultSet 句柄和 ResultSet 对象中的行，从该行开始检索行。

```
CachedRowSet crs = new CachedRowSetImpl();
crs.setMaxRows(20);
crs.setPageSize(4);
crs.populate(rsHandle, 10); 
```

当此代码运行时，crs 将从第 10 行开始填充来自 rsHandle 的 4 行。

在类似的路径上，您可以构建在 JSP 上对数据进行分页的策略等等。

# javascript - 如何打开另一个窗口

> ID：776923
> 
> 赞同：-1
> 
> 时间：2009-04-22T12:18:23.343
> 
> 标签：javascript

> **可能重复：**
> [如何在新窗口中打开](https://stackoverflow.com/questions/10242908/how-to-open-in-new-window)

如何使用 javascript 在新窗口中打开页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T12:19:33.013

[窗口打开](http://www.javascript-coder.com/window-popup/javascript-window-open.phtml)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T12:19:46.177

试试这段代码：

```
window.open("http://www.google.com"); 
```

那就是如果你想打开一个新窗口。

祝你好运。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T12:19:52.027

你可以使用这个：

```
<script language="javascript" type="text/javascript">
<!--
function popitup(url) {
    newwindow=window.open(url,'name','height=200,width=150');
    if (window.focus) {newwindow.focus()}
    return false;
}

// -->
</script> 
```

你可以这样称呼它：

```
<a href="something.html" onclick="return popitup('something.html')">Link to popup</a> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T12:19:58.220

参考[http://www.javascript-coder.com/window-popup/javascript-window-open.phtml](http://www.javascript-coder.com/window-popup/javascript-window-open.phtml)

您可以将代码作为客户端事件附加到按钮上。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T12:51:11.983

或者您可以使用普通的旧 html 和目标属性。`<a href="link.html" target="_blank">`

# c# - 在绑定转发器时将 javascript 添加到链接的 OnClientClick 属性

> ID：776930
> 
> 赞同：3
> 
> 时间：2009-04-22T12:19:22.060
> 
> 标签：c#, asp.net, javascript

我试图让这个工作但没有成功：

```
<asp:Repeater ID="Repeater1" runat="server" OnItemCommand="btnDeleteFamily_Click">
 <HeaderTemplate>
    <table>
       <tr>
          <th width="90" valign="top"><%=getTag("name")%></th>
       </tr>
 </HeaderTemplate>
 <ItemTemplate>
       <tr>
       <td><%#Eval("chrname")%></td>
           <asp:LinkButton ID="btnDeleteFamily" CssClass="fRight ui-icon ui-icon-trash" runat="server" CommandName="delete" CommandArgument='<%#Eval("idmember")%>' OnClientClick='return confirm("<%= getTag("deletefamilymemberdialog") %>")' Text="" ValidationGroup="delete_family" />
       </td>
       </tr>
  </ItemTemplate>
  <FooterTemplate>
     </table>
  </FooterTemplate>
</asp:Repeater> 
```

单击 btnDeleteFamily OnClientClick 时，不会显示确认对话框。

getTag（后面代码中的方法）用于本地化以根据语言获取文本。我的意图是在 JavaScript 对话框中显示该消息，但我得到：

```
<a href="javascript:__doPostBack('ctl00$ContentPlaceHolder1$rptFamily$ctl01$btnDeleteFamily','')" class="fRight ui-icon ui-icon-trash" id="ctl00_ContentPlaceHolder1_rptFamily_ctl01_btnDeleteFamily" onclick='return confirm("<%= getTag("deletefamilymemberdialog") %>");'/> 
```

所以它不在服务器端处理 getTag 否则我会得到

```
onclick='return confirm("Are you sure that you want to delete this entry?");' 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T12:53:26.970

我认为将消息作为 javascript 变量写入页面是一个更好的解决方案：

```
<script>
   var deleteMemberDialogMessage = '<%= getTag("deletefamilymemberdialog") %>';
</script> 
```

还有你的中继器：

```
<asp:LinkButton ID="btnDeleteFamily" CssClass="fRight ui-icon ui-icon-trash"
    runat="server" CommandName="delete" CommandArgument='<%#Eval("idmember")%>' 
    OnClientClick='return confirm(deleteMemberDialogMessage)' Text="" 
    ValidationGroup="delete_family" /> 
```

顺便确保您的 deletefamilymemberdialog 消息没有单引号。

**编辑：**如果要将数据源中的值绑定到中继器，则应将列绑定到控件，而不是像这样的 Response.Write (<%=) ：

```
<asp:LinkButton ID="btnDeleteFamily" CssClass="fRight ui-icon ui-icon-trash"
 runat="server" CommandName="delete" CommandArgument='<%#Eval("idmember")%>' 
OnClientClick='<%# Bind("return confirm('{0}');'", "YourColumnName") %> Text="" 
ValidationGroup="delete_family" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-22T13:31:36.257

```
protected void Repeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    LinkButton lb = e.Item.FindControl("btnDelete") as LinkButton;
    if (lb != mull) {
         lb.OnClientClick = "whatever";
     }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:40:22.073

好像没问题，至少对我来说。

您可以在 firefox 中尝试它，并使用 WebDeveloper 工具栏或 Firebug 扩展，您将能够获得有关幕后发生的事情的更多信息。

也许页面上还有其他错误不允许此代码工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-04T21:49:58.740

如果您想在确认模式下使用 jQuery 对话框绑定到更新面板内中继器上的链接按钮，并且您要在确认后执行的代码对于每一行都不同，您可以这样设置：

向您的页面/控件添加一个 javascript 函数，如下所示：

```
function confirm(buttonFunctionForPostBack)
{
    $("#dialog").dialog('option', 'buttons', { 
              "Cancel": function() { 
                  $(this).dialog("close"); 
              },
              "Delete Payment": function () { 
                  eval(buttonFunctionForPostBack); 
                  $(this).dialog("close"); 
                  }
              }
    ).dialog('open');
} 
```

在你后面的代码中：

```
public void Repeater1_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
    LinkButton lb = e.Item.FindControl("deleteButton") as LinkButton;
    if (lb != null)
    {
        lb.OnClientClick = "confirm(\"" + this.Page.ClientScript.GetPostBackEventReference(lb, string.Empty) + "\");return false;";
    }
} 
```

在您的 aspx 页面中：

```
<asp:Repeater ID="Repeater1" runat="server" OnItemDataBound="Repeater1_ItemDataBound">
  <HeaderTemplate>
    <table>
       <tr>
          <th width="90" valign="top"></th>
       </tr>
 </HeaderTemplate>
 <ItemTemplate>
       <tr>
         <td><%#Eval("name")%></td>
         <td><asp:LinkButton ID="deleteButton" runat="server" CommandName="delete" CommandArgument='<%#Eval("id")%>' Text="Delete" />
         </td>
       </tr>
  </ItemTemplate>
  <FooterTemplate>
     </table>
  </FooterTemplate>
</asp:Repeater> 
```

这使您可以利用这样一个事实，即您可以在创建对话框后设置对话框的“按钮”选项。此外，它不需要任何额外的脚本变量。

# svn - 集市中的标签有什么意义？

> ID：776941
> 
> 赞同：5
> 
> 时间：2009-04-22T12:20:57.313
> 
> 标签：svn, version-control, bazaar

在 svn 领域长期露营后，我开始使用 bazaar。我以前也有过 cvs 的经验，我偶尔也会使用标签。

使用 svn，一旦你发布了一个版本，你就可以将你的 trunk 复制到标签中，例如 svn copy trunk tags/1.2.0 。在 bazaar 中，我创建了相同的存储库结构，但是没有 bzr 复制选项和 bzr 标签的存在让我思考。

事实是我发现标签要么很难使用，要么没用。如果我使用标签，我基本上将我的主干作为唯一的目录，当我达到里程碑时，我会对其进行标签。然后，当达到新的里程碑时，我会继续开发和标记。这使以下任务复杂化：

*   递归地比较新版本和旧版本（使用类似 svn 的方法：diff --brief -r）
*   修复旧版本，并创建增加补丁版本的新版本（使用类似 svn 的方法：svn 复制 2.0.0 2.0.1，然后将修复添加到 2.0.1 并提交）
*   无需检查即可获得所需的版本（如果您以类似 svn 的方式检查整个树，则您拥有所有版本和分支，并且只执行一次）

结果，我在 bzr 中使用了相同的 svn repo 结构，并且每次都对主干进行物理复制。这意味着在这种安排中我看不到 bzr tag 命令的任何实际用途。如果每个版本都包含所有版本号，为什么我应该用版本号标记整个 repo 版本？

谁能指出我在使用和理解 bzr repo 的标签时做错了什么？

* * *

**编辑**

所以据我所知，这个概念是每个版本都有不同的 bzr 分支（独立分支，来自主干通过 bzr 分支）。它就像svn，只是你没有将根目录放在存储库中。我仍然没有真正看到标签的任何特殊原因，除了如果你说 foo-1.0.0 foo-1.0.1 foo-2.0.0 foo-2.1.0 trunk

并假设我总是在分支之前标记版本，主干将为所有版本添加标签，而 foo-2.0.0 的标签中将包含 foo-1.0.0，但没有 foo-1.0.1，因为它是从 foo-1.0 分支的.0.

我仍然没有真正看到拥有和使用标签的必要性。我的标签隐含在我为该分支选择的目录名称中。我对特定的版本号并不真正感兴趣，我只是对它进入特定目录感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-22T13:28:35.107

**bzr 中的标签是什么？**

标签只是特定版本的一个易于记忆的句柄。您可以参考您的标签，而不是尝试记住`david@hrcsb.org-20090420170402-eql4vzvcifkz4fwy`或 revno ：`19721`

```
bzr export -r tag:foo-1.0.0.0 release-foo-1.0.0.0.tar.gz trunk/ 
```

**我如何管理 bzr 中的发布？**

听起来好像您将发布视为单独的开发线（又名：分支），所以我建议您标记您的主干，以便您知道您从哪里分支并创建单独的发布分支：

```
bzr tag -r 1234 -d trunk/ foo-1.0.0.0 
bzr branch -r 1234 trunk/ release-1.x 
```

当您为 1.x 版本进行错误修复时，您可以在 release-1.x 分支中进行，并标记每个点版本：

```
bzr tag -r 1255 -d release-1.x/ foo-1.0.0.1
bzr export -r tag:foo-1.0.0.1 release-foo-1.0.0.1.tar.gz release-1.x/ 
```

您的目录结构可能如下所示：

```
fooproj/
  release-1.x/
  release-2.x/
  trunk/ 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-22T13:12:30.310

好吧，基本上，您不应该尝试复制 SVN 目录结构。我不知道为什么 SVN 会这样，但基本上标签只是您 bzr 存储库中某个时间点的标记。当您想针对标签进行比较时，可以这样做

```
bzr diff -r tag:TAG_NAME 
```

因此，每当您发布版本时，只需标记它并按您的方式进行。没有什么比将某些东西移动到特定文件夹或任何东西更特别的了。

我建议您开始使用单独的分支而不是标签来处理您想要返回的内容，例如代码的 2.0.x 行，这样您就有一个 2.0.x 的分支，然后是 2.0 之类的标签.0 和 2.0.1 在里面。

另外，请查看[http://bazaar-vcs.org/Specs/Tagging](http://bazaar-vcs.org/Specs/Tagging)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T19:25:12.040

svn 中的标签更像是 svn 分支。您已经描述了很好地映射到 bzr 分支的工作流程。标签允许你有一个分支指向你的发布，所以任何人都可以从主干获得准确的发布版本：

bzr 分支树干 foo-1.0 -r tag:1.0

# ssis - 具有多个输入的 SSIS 脚本组件

> ID：776949
> 
> 赞同：3
> 
> 时间：2009-04-22T12:22:56.123
> 
> 标签：ssis

我正在寻找一种在 SSIS 中创建脚本组件的方法，该组件将接受多个输入。

我需要这个，所以我可以做一种自定义加入的形式。

一个脚本可以有多个输出但只有一个输入，这似乎真的很愚蠢，我确定我一定做错了什么。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T12:26:58.453

尝试在您的脚本组件之前放置一个 Union All 组件，而不是让列匹配，而是将列添加到输出中，以便每个进入的元素都在一个唯一的列中结束。

请记住，起初 SSIS 脚本组件将逐行处理项目，因此需要使用一些集合来完成自定义连接机制，并捕获在处理完所有行后触发的事件。

请记住，我假设您在数据流而不是控制流中使用脚本组件，并且假设您使用的是 SSIS 2005。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-01T20:45:51.127

我目前正在尝试使用 SSIS 变量将同步对象从一个脚本组件传递到另一个脚本组件。它相当笨拙，但是您可以有效地使用多个脚本组件来接受各种输入，然后使用 System.Threading 类将值从一个脚本组件同步到另一个脚本组件。

障碍是每个脚本都在自己的命名空间中，并且不能与其他脚本共享类（除非您想使用 SSIS 编译和部署自己的程序集）。我目前正在做的是（通过共享变量）传递对 object[] 的引用，其中包含对 ManualResetEvent、SSIS PipelineBuffer 和管道列索引数组的引用。

这足以让接收脚本重建另一个脚本的输入管道，将其抽干，然后发回信号表明它已完成。

它是功能性的，尽管我目前正在寻找解决方法，即（看起来）SSIS 在脚本组件的生命周期内两次调用“ProcessInput”。如果 SO 上的任何天才对此有解决方案，那么我认为我们已经有了一个 [笨拙] 解决方案来允许对单个脚本组件进行多个输入。

有接盘侠吗？

- - 编辑 - -

我已经启动并运行了 - 这个技巧是使用同步来防止 ProcessInput 的多线程调用尝试多次共享输入缓冲区。以下是我如何使其工作的粗略代码示例：

脚本组件 1：共享其输入...

```
using System;
using System.Collections;
using System.Threading;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;
using Microsoft.SqlServer.Dts.Pipeline;

[Microsoft.SqlServer.Dts.Pipeline.SSISScriptComponentEntryPointAttribute]
public class ScriptMain : UserComponent
{

    System.Collections.Generic.List<object> shared = null;
    System.Threading.ManualResetEvent sync;

    public override void ProcessInput(int InputID, PipelineBuffer Buffer)
    {
        lock (this)
        {
            if (InputID == 82)
            {
                if (shared == null)
                {
                    shared = new System.Collections.Generic.List<object>();
                    sync = new System.Threading.ManualResetEvent(false);
                    shared.Add(sync);
                    shared.Add(Buffer);
                    shared.Add(GetColumnIndexes(InputID));

                    IDTSVariables100 vars = null;

                    this.VariableDispenser.LockOneForWrite("Test", ref vars);

                    vars[0].Value = shared;
                    vars.Unlock();
                    sync.WaitOne();
                    System.Windows.Forms.MessageBox.Show("Done");
                }
            }
        }
    }
} 
```

...然后是脚本组件 2（它使用脚本组件 1 的输入）...

```
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;

[Microsoft.SqlServer.Dts.Pipeline.SSISScriptComponentEntryPointAttribute]
public class ScriptMain : UserComponent
{
    System.Threading.ManualResetEvent sync = null;
    InputXBuffer sharedBuffer = null;

    public override void Input0_ProcessInput(Input0Buffer Buffer)
    {
        lock (this)                 // Only 1 thread at a time
        {
            if (sharedBuffer == null)
            {
                object Test = null;
                while (Test == null)
                {
                    System.Threading.Thread.Sleep(100);
                    IDTSVariables100 vars = null;
                    this.VariableDispenser.LockOneForRead("Test", ref vars);
                    Test = vars[0].Value;
                    vars.Unlock();
                }

                var sharedList = Test as System.Collections.Generic.List<object>;

                if (sharedList != null)
                {
                    sync = sharedList[0] as System.Threading.ManualResetEvent;
                    var buffer = sharedList[1] as PipelineBuffer;
                    var bufferColumnIndexes = sharedList[2] as int[];
                    sharedBuffer = new InputXBuffer(buffer, bufferColumnIndexes);
                }
            }
       }

        while (sharedBuffer.NextRow())
        {
            // ... do stuff with Script Component 1's shared input here...
        }
        sync.Set();     // Signal script 1 that we're done
    }
} 
```

The scripts both share a read/write variable called "Test" - you can change the variable name to suite your needs. Hopefully the above serves as a working model for you to take this to the next level.

PS:- If you have the time & energy, writing a proper custom SSIS component really is the way to go for multi input scenarios.

# javascript - JavaScript：未定义！==未定义？

> ID：776950
> 
> 赞同：68
> 
> 时间：2009-04-22T12:23:14.203
> 
> 标签：javascript

*注意：根据[ECMAScript5.1 第 15.1.1.3 节](http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.1.3)，window.undefined 是只读的。*

*   *现代浏览器正确地实现了这一点。例如：Safari 5.1、Firefox 7、Chrome 20 等。*
*   *未定义仍然可以更改：Chrome 14，...*

当我最近将[Facebook Connect](http://en.wikipedia.org/wiki/Facebook_Platform#Facebook_Connect)与[Tersus](http://www.tersus.com)集成时，我最初收到错误消息`Invalid Enumeration Value`并`Handler already exists`尝试调用 Facebook API 函数。

原来问题的原因是

```
object.x === undefined 
```

当 'object' 中没有属性 'x' 时返回 false。

我通过在两个 Facebook 函数中用常规相等替换严格相等来解决这个问题：

```
FB.Sys.isUndefined = function(o) { return o == undefined;};
FB.Sys.containsKey = function(d, key) { return d[key] != undefined;}; 
```

这使事情对我有用，但似乎暗示 Facebook 的 JavaScript 代码和我自己的代码之间存在某种冲突。

什么可能导致这种情况？

提示：有据可查的是`undefined == null`while `undefined !== null`. 这不是这里的问题。问题是我们如何得到`undefined !== undefined`.

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-04-22T13:28:48.477

问题是 undefined 与使用 == 的 null 相比给出了 true。因此，对 undefined 的常见检查是这样完成的：

```
typeof x == "undefined" 
```

这确保了变量的类型实际上是未定义的。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-04-26T10:39:35.577

事实证明，你可以将 window.undefined 设置为任何你想要的，所以`object.x !== undefined`当 object.x 是*真正的*未定义时得到。就我而言，我无意中将 undefined 设置为 null。

看到这种情况发生的最简单方法是：

```
window.undefined = null;
alert(window.xyzw === undefined); // shows false 
```

当然，这不太可能发生。在我的情况下，这个错误有点微妙，相当于下面的场景。

```
var n = window.someName; // someName expected to be set but is actually undefined
window[n]=null; // I thought I was clearing the old value but was actually changing window.undefined to null
alert(window.xyzw === undefined); // shows false 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-07-02T17:33:28.100

我想发布一些关于 的重要信息`undefined`，初学者可能不知道。

看下面的代码：

```
 /* 
  * Consider there is no code above. 
  * The browser runs these lines only.
  */

   // var a;  
   // --- commented out to point that we've forgotten to declare `a` variable 

   if ( a === undefined ) {
       alert('Not defined');
   } else {
       alert('Defined: ' + a);
   }

   alert('Doing important job below'); 
```

如果您运行此代码，其中`a`从未使用 声明变量`var`，您将收到一个 ERROR EXCEPTION 并且令人惊讶地根本看不到任何警报。

您的脚本不会“在下面做重要的工作”，而是会意外终止，在第一行抛出未处理的异常。

* * *

这是检查`undefined`使用`typeof`关键字的唯一防弹方法，它就是为此目的而设计的：

```
 /* 
    * Correct and safe way of checking for `undefined`: 
    */

   if ( typeof a === 'undefined' ) {
       alert(
           'The variable is not declared in this scope, \n' +
           'or you are pointing to unexisting property, \n' +
           'or no value has been set yet to the variable, \n' + 
           'or the value set was `undefined`. \n' +
           '(two last cases are equivalent, don\'t worry if it blows out your mind.'
           );
   }

   /* 
    *  Use `typeof` for checking things like that
    */ 
```

此方法适用于所有可能的情况。

使用它的最后一个参数是它`undefined`可能会在早期版本的 Javascript 中被覆盖：

```
 /* @ Trollface @ */
        undefined = 2;
     /* Happy debuging! */ 
```

希望我足够清楚。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-04-23T09:28:19.937

使用`==`相等运算符而不是`===`.

```
undefined === undefined // true
null == undefined // true
null === undefined // false 
```

如果是未知属性，则`object.x === undefined`应该返回。`true``x`

在[*JavaScript 的*](http://assets.expectnation.com/15/event/3/JavaScript_%20The%20Good%20Parts%20Paper%201.pdf)[*坏部分*：好的部分一章中](http://assets.expectnation.com/15/event/3/JavaScript_%20The%20Good%20Parts%20Paper%201.pdf)*，Crockford 写道：*

 *> 如果您尝试从对象中提取值，并且该对象没有具有该名称的成员，则它会返回未定义的值。
> 
> 除了 undefined，JavaScript 还有一个类似的值叫做 null。它们是如此相似，以至于 == 认为它们是平等的。这让一些程序员误以为它们是可以互换的，导致代码像
> 
> ```
> value = myObject[name];
> if (value == null) {
>     alert(name + ' not found.');
> } 
> ```
> 
> 它正在将错误的值与错误的运算符进行比较。此代码有效，因为它包含两个相互抵消的错误。这是一种疯狂的编程方式。最好这样写：
> 
> ```
> value = myObject[name];
> if (value === undefined) {
>     alert(name + ' not found.');
> } 
> ```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-12-09T06:25:19.010

来自 - [JQuery_Core_Style_Guidelines](http://docs.jquery.com/JQuery_Core_Style_Guidelines)

*   全局变量：
    `typeof variable === "undefined"`

*   局部变量：
    `variable === undefined`

*   特性：
    `object.prop === undefined`

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-11-17T19:37:57.287

```
var a;

typeof a === 'undefined'; // true
a === undefined; // true
typeof a === typeof undefined; // true
typeof a === typeof sdfuwehflj; // true 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-23T08:58:47.433

一种）。我从来没有也永远不会相信任何声称可以在没有用户编码的情况下生成代码的工具，它是图形工具的两倍。

乙）。我在使用 Facebook Connect 时从未遇到过任何问题。`undefined===undefined`无论您身在何处，它仍然是在浏览器中运行的普通旧 JavaScript 代码。

简而言之，您需要提供证据证明您的 object.x 确实是未定义的，而不是 null 或其他，因为我相信您所描述的情况实际上是不可能的 - 没有冒犯:) - 我会说钱在 Tersus 代码中存在的问题上。

# language-agnostic - 什么时候加载类变量？

> ID：776954
> 
> 赞同：0
> 
> 时间：2009-04-22T12:24:00.007
> 
> 标签：language-agnostic, class

查看类定义的两种方式：

```
//definition: 1
public class MyClass{

    private MyObject obj = new MyObject();
    private String   str = "hello world";

    // constructor
    public MyClass(){

    }
}

// definition: 2
public class MyClass{

    private MyObject obj = null;
    private String   str = null;

    // constructor
    public MyClass(){
        obj = new MyClass();
        str = "HelloWorld";
    }    
} 
```

我的问题是：什么时候加载类变量。它们是如何加载的？

它们的初始化是如何发生的？如果它们的初始化可以像定义 1 中那样发生，那么构造函数的目的是什么？

哪种是定义类的首选方式，为什么？C++/C#/Java 之间的行为是否相同，或者这种行为在它们之间是否不同？

欢迎对上述任何澄清评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T12:40:03.260

这取决于语言，但大多数语言在调用构造函数之前都会初始化字段。通常我提倡在上下文中做事，初始化通常只在声明字段的地方相关。但是，正如约翰指出的那样，有时您需要做一些没有意义/不可能的事情。

此外，与往常一样，如果您的字段的初始化依赖于其他字段，则顺序很重要。在某些语言中，例如 ActionScript，这意味着声明的顺序决定了初始化的顺序：

**作品：**

```
public class Foo
{
    private var bar:Array = [1, 2, 3];
    private var baz:Array = bar.concat([4, 5, 6]);
} 
```

**不起作用：**

```
public class Foo
{
    private var baz:Array = bar.concat([4, 5, 6]);
    private var bar:Array = [1, 2, 3];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T12:29:40.367

构造函数是将类实例化为对象时运行的第一个函数。

类变量在实例化期间初始化，然后构造函数立即运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:30:30.287

在大多数语言中，实例字段（在我所知道的任何语言中都不称为类变量）将在实例构造期间初始化。它们实际上是构造函数的一部分，在实际构造函数代码之前执行。

您当然可以在显式构造函数代码中初始化它们（尽管如果您要将它们设置为其他值，请将设置保存为 null）。

您问构造函数的用途 - 您不能在初始化程序中完成所有操作。如果你需要循环什么的怎么办？

# c++ - 实现运算符重载的最佳方法是什么？

> ID：776960
> 
> 赞同：2
> 
> 时间：2009-04-22T12:24:51.110
> 
> 标签：c++, operator-overloading

在我在 C++ 中学到的所有东西中（不是很多），运算符重载似乎是最困难的。一般而言，何时最好将运算符重载编写为友元函数？我什么时候必须明确使用`*this`？使用临时对象总是不好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T12:29:16.357

没有什么神奇的 abort 运算符重载——这样的重载只是名称看起来很奇怪的函数。因此，您编写运算符重载的方式与编写命名函数的方式相同。事实上，首先编写一个命名函数通常是一个好主意——你以后总是可以将它更改为一个运算符。

您唯一需要注意的是编译器使用了几个运算符：

*   将东西存储在集合中时 operator=()
*   排序/搜索时操作符<()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-22T12:46:56.377

尼尔的回答是正确的。此外，[这个链接](http://www.parashift.com/c++-faq-lite/operator-overloading.html)提供了很多关于何时、何地、为什么以及如何在 C++ 中使用各种类型的运算符重载的有用信息。

一般来说，我会尝试坚持使用直观的重载——“+”运算符的使用应该反映类似于加法等的东西。如果你发现自己在用“+”运算符或类似的东西进行字符串比较，您可能应该改用标准函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-22T14:16:33.760

运算符重载的第一条规则：不要重载没有意义的运算符。例如，+ 运算符可能看起来像是将元素附加到列表的好选择，但事实并非如此：不是每个人都会发现这种用法是合乎逻辑的。

关于数学运算符，`friend`是不需要的。

定义它们的典型方法（尊重对称性和隐式转换）如下：

```
struct T {
    T& operator+=(T const& rhs) {
        // the actual addition code
        return *this;
    }
};
T const operator+(T const& lhs, T const& rhs) {
     return T(lhs) += rhs;
}; 
```

然而，这个组织并不适合像`Matrix`或 `Polynomial`乘法这样的算子，因为`*=(T const&)`算子并不是那么微不足道的。在这种情况下，我们将`operator*=(T const&)`在 之上定义，并且如果没有内部数据的访问器，则可以`operator*(T const&, T const&)`生成二进制文件——这种使用不是封装违规，而是封装强制——或用于优化目的。`operator*()``friend``friend`

如果您真的想消除大多数临时变量，请查看表达式模板（请参阅 Blitz++、boost.ublas、newmat，...），或等待 C++0x 右值引用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T20:45:19.590

All operators overloads as member-function take *this as lvalue,so you need friend in cases you don't want it such overload stream operators as << and >>.In most others cases the use of friends is to break the principle of least privilege. Other way to overload an operator ,which wasn't said, is to use a global function.

# c++ - 让不同的实例进行通信

> ID：776976
> 
> 赞同：1
> 
> 时间：2009-04-22T12:28:24.987
> 
> 标签：c++, object

假设我有同一个类的两个实例。该类有一个指向某些数据的指针，我希望实例交换指针作为某些私有函数算法的一部分，但不会通过通过公共函数直接访问它来向其他人妥协数据。

我的第一个想法是添加一个名为 exchange 的 bool 类型的静态变量和两个方法：一个私有的：void requestExchange() 和一个公共的：Data** respond()。requestExchange 会将 exchange 设置为 true，并紧跟来自所选实例的 respond()，它将执行以下操作：

```
if(exchange==true){
    exchange=false;
    return data;
}
else{return...?! 
```

那时我意识到我无法模拟“NO OP”，因为数据实际上可能是 NULL，所以据说一切都是响应。关于可以做什么的任何想法？

更新：我想了一下，因为请求-响应组合只会在结果为 NULL 有意义的上下文中调用（交换肯定是真的）我想我可以简单地返回 NULL 并模拟一个 NO OP这边走。因此，对于局外人来说 NULL 将毫无用处......但我仍然对建议感兴趣。必须有一种结构更完善的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T12:48:17.233

同一类的对象可以直接访问彼此的私有数据。例如，您经常在复制构造函数中看到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T12:50:07.277

你对问题的描述不是很清楚。为什么你不能让 respond() 成为一个私有函数？

使用静态类成员的想法充满了危险。如果两对这样的实例想要同时通信怎么办？如果一个人设置了交换标志，然后在调用响应（）之前死了怎么办？线程安全呢？

至于返回 NO-OP 或错误指示器，您可以使用异常（这就是它们的用途，但如果您的项目不使用异常，那么突然引入它们不是一个好主意），或者走 boost::选修的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:59:51.090

最好将您对返回数据和交换数据的担忧分开。

```
class Foo
{
public:
   Bar* data()
   {
      return pData;
   }
private:
   void exchangeData(Foo& Rhs)
   {
      if (this != &Rhs)
      {
         Bar* pTmp = pData;
         pData = Rhs.pData;
         Rhs.pData = pTmp;
      }
   }
   Bar* pData;
} 
```

希望它与您想要的一致？这个问题不是很清楚......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T13:06:04.507

我可能错过了你问题的重点。为什么这不符合您的要求？

```
class CMyClass  
{
public:
    void ExchangePointerWith( CMyClass& rhs );

private:
    void* m_MyPtr;
}; 
```

和：

```
void CMyClass::ExchangePointerWith(CMyClass &rhs)
{
    void*   tmp= m_MyPtr;
    m_MyPtr= rhs.m_MyPtr;
    rhs.m_MyPtr= tmp;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T15:34:46.350

使用 std::swap() 并构建您的类自己的交换方法，然后您就知道它应该是异常安全的。swap() 是大多数类应该实现的标准路由，以使它们对 STL 有效。

请记住，一个类自动成为它自己的朋友。因此它可以访问同一类的另一个实例的私有成员变量。请参阅（[C++ 中的 Friend 范围](https://stackoverflow.com/questions/437250/friend-scope-in-c/437507#437507)）

```
#include <algorithm>

class myX
{
    public:
        void swap(myX& rhs) throw()
        {
            std::swap(data,rhs.data);
        }
    private:
        void* data;
 }; 
```

# c# - 我应该在 C# 中使用 try{} 还是 using()？

> ID：776990
> 
> 赞同：4
> 
> 时间：2009-04-22T12:31:35.557
> 
> 标签：c#, using, try-catch

我是 C# 的新手，一直是帕斯卡爱好者，直到我在 Depth 中找到 C#。在 Delphi 中，有一个 try{} 语句也在 C# 中实现。

但是，我看到你们中的一些人提到“Using(){} 比 try{} 更好”。

这是一个例子：

```
 //This might throw an exception
   sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
   sock.Connect(ip, port);

   //Try statement
   try
   {
       sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
       sock.Connect(ip, port);
   catch
   {
   }

   //using(){}
   using(sock = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
   {
          sock.Connect(ip, port);
   } 
```

我的问题：

1.  如果异常发生在“using”语句中会发生什么？

2.  我什么时候应该使用“使用”而不是“尝试”，什么时候应该使用“尝试”而不是“使用”？

3.  “使用”声明的目的是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-22T12:36:48.617

使用和尝试是两件非常不同的事情，并且是完全正交的。

如果发生异常并且不在 try 块中，则堆栈展开，直到找到适当的异常处理程序。这与 using 语句无关。

`using {}`当您想确保在使用后正确整理对象时使用 - 在您的示例中，袜子将在 using 块之后正确处理。

`using`有关在网络（或 SO）上为“ ”使用 seach 的更多信息`IDisposable`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-22T12:34:54.287

在创建（和使用）实现 IDisposable 的新对象时使用 using 语句。即使在 using 块中引发异常，using 语句也将始终处理对象。

try/catch 语句通常用于完全不同的目的，但 try/catch/finally 或 try/finally 中的 finally 块与无条件执行的目的相同。using 语句为您购买自动调用配置。

推荐 David Hayden 的文章：[C# 代码审查 - C# Using Statement - Try / finally - IDisposable - Dispose() - SqlConnection - SqlCommand](http://davidhayden.com/blog/dave/archive/2005/01/13/773.aspx)

[关于 using 语句的](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)
[MSDN 文章 MSDN 关于 Try/Catch/Finally的文章](http://msdn.microsoft.com/en-us/library/dszsf989(VS.71).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-22T12:36:05.763

`using`与 try/catch 完全不同。一个`using`块用于确保一个`IDisposable`ist被释放，这意味着`Dispose()`被调用。尝试、捕捉并最终处理异常。`using`块类似于：

```
IDisposable d; try { d = m; } finally { d.Dispose(); } 
```

this 和 a 之间的区别在于`using`变量的范围，因为`using`它是在块内部创建的。

`m`是任何对象构造的占位符。有关详细信息，请参阅 MSDN 下的`using`, `IDisposable`。尤其是关于处置、垃圾收集和非托管资源的信息值得一读。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-22T12:36:15.873

using 语句确保 IDisposable 在使用后被释放。

异常用于捕获您无法解释的异常。

所以它们并不是真正可交换的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-22T13:10:16.383

这不是关于“尝试”，而是关于 try/ **finally**和/或 try/ **catch**。他们有完全不同的目的。

using 是一种更短且更友好的表示法`try{}finally{ Dispose() }`，因此是首选。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-22T12:40:58.170

using is just a try {} finally {} with the finally calling the dispose() method of something that implements IDispose. So as a good rule of thumb if the object supports IDispose ... use using{}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-22T12:37:25.200

Try-blocks 用于可能包含意外发生的事情（数据库失败，连接失败等）的代码块，它们应该仅用于此目的。准备好捕获异常是非常消耗资源的，如果你可以限制你对 try-catch-blocks 的使用，那就更好了。也就是说，它们是防御性编程的非常强大的工具，性能损失绝对值得，因为您可以从异常日志中收集大量有关问题的信息和统计信息。

Using-blocks 用于严格限定变量的范围，并且对于您在很短的时间内不需要的大量内存对象等事情很有用。它们基本上是给运行时的一条消息，“在这个块之后，摆脱对象”。

# vb.net - 使用 .NETCF 以编程方式添加和更新记录

> ID：776991
> 
> 赞同：0
> 
> 时间：2009-04-22T12:31:52.843
> 
> 标签：vb.net, windows-mobile, compact-framework

好的 - 我已经用 40 种不同的方式对这个搜索进行了措辞，我似乎在这里迷路了。

我发现的每个示例似乎都很高兴，您可以轻松地拖放数据网格并让用户填写它——然后他们就停下来了！我知道如何通过 LINQ 完成我所要求的一切。这显然不会在这里翻译。我真的应该先学习 ADO.NET，**然后再**学习 LINQ，但是不...

我需要知道如何使用设备上的 SQL CE 数据库在 .NETCF (Windows Mobile 5) 中执行以下操作。

1.  添加一条新记录并使用我提供的数据填充部分或全部字段。我不需要将记录添加到数据网格 - 有时用户甚至不会看到记录。如何添加新记录——将数据放入其中并保存？例如：创建一条新的交货记录，让程序将日期存储在一个字段中，将数字存储在另一个字段中。

2.  搜索记录，然后更新其中的数据。同样，使用 LINQ 我可以轻松地做到这一点——我一生都找不到任何没有它的例子。我可以找到很多填充数据绑定字段网格的示例，让用户进行更改然后将其保存。我不需要那样做。

假设我需要搜索满足条件的一条记录（customerID=10 和 orderID=1234），然后当（如果）找到该记录时，更新其中的一个字段。

如果您需要更多信息，请告诉我。我读了很多书，但似乎遗漏了一些东西！

提前致谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-22T13:35:21.630

对于#1，有几种方法。两种简单、常见的方法是：

*使用 SqlCeResultset，并用它创建一行，然后插入。*

```
using(SqlCeConnection connection = new SqlCeConnection(myConnString))
using (SqlCeCommand cmd = new SqlCeCommand())
{
    connection.Open();
    cmd.CommandText = "MyTable";
    cmd.CommandType = CommandType.TableDirect;
    cmd.Connection = Connection;
    SqlCeResultSet rs = cmd.ExecuteResultSet(ResultSetOptions.Updatable);

    SqlCeUpdatableRecord record = rs.CreateRecord();

    // do something to set your values in the record

    rs.Insert(record);
} 
```

*使用 SqlCeCommand，设置命令 SQL 并调用 ExecuteNonQuery。*

```
using (SqlCeConnection connection = new SqlCeConnection(myConnString))
using (SqlCeCommand cmd = new SqlCeCommand())
{
    connection.Open();
    cmd.CommandText = "INSERT INTO MyTable(Foo) VALUES('bar')";
    cmd.CommandType = CommandType.Text;
    cmd.Connection = Connection;
    cmd.ExecuteNonQuery();
} 
```

对于#2，它并没有太大的不同。使用可更新的结果集，查找记录，修改并调用 Update 或构建您的 SQL 并使用 ExecuteScalar 或 ExecutNonQuery 通过命令发送它。该代码与上面的代码足够相似，我将留给您自己解决。

快速搜索“SqlCeResultSet”和“示例”或“更新示例”会提供大量相关结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T18:17:12.717

谢谢，

在这和这里的代码之间，我想我正在路上。

```
Private Sub MenuItem2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MenuItem2.Click

    Dim con As SqlCeConnection

    con = New SqlCeConnection(("Data Source = " & Me.NorthwindDatabaseFullPath))
    con.Open()

    Dim sqlcdm As String = "INSERT INTO Orders VALUES(999, 'ALFKI', 1, 'RUDEDOG', '', '', '', '', '', 2, '11/15/1967', '11/16/1967', '11/17/1967', '23')"

    Dim SqlCeCommand As New SqlCeCommand(sqlcdm, con)

    SqlCeCommand.ExecuteNonQuery()

End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T11:52:37.077

[对于其他搜索这本书的人来说，这本书也有一个非常好的章节： http](http://my.safaribooksonline.com/0321174046) ://my.safaribooksonline.com/0321174046

我仍在努力解决这个问题，但取得了良好的进展，

谢谢您的帮助。

# .net - 我什么时候需要调用 form.ShowDialog(IWin32Window) 而不是 form.ShowDialog()？

> ID：776993
> 
> 赞同：1
> 
> 时间：2009-04-22T12:33:28.877
> 
> 标签：.net, winforms, modal-dialog

我有一些代码，它调用`form.ShowDialog(IWin32Window)`重载而不是重载`form.ShowDialog()`，但将当前活动窗口作为参数传递。

使用另一个重载似乎使行为保持不变。切换到更简单的重载是否安全？我什么时候想传入 IWin32Window 参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-22T12:48:53.767

该`IWin32Window`参数用于指定对话框的所有者。在这种情况下，它是一个接口，因此您可以将非托管窗口（例如，来自您正在使用的 COM 对象的窗口）作为对话框的所有者。

我不得不不同意这里的用户说您不应该指定所有者。事实上，尽可能为表单指定所有者总是可取的。虽然对话框可能不如非模态表单重要，但养成指定所有者的习惯总是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T12:39:31.077

如果您想在另一个应用程序或窗体中作为父窗体，您可以使用 IWin32Window 参数。

因此，例如，您可以获得另一个应用程序或表单的句柄，并将您的表单显示为该应用程序的一部分。[你可以在这里](http://ryanfarley.com/blog/archive/2004/03/23/465.aspx)找到更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T12:45:32.187

在正常情况下，您应该使用 void 构造函数。就像 Nathan 所说，如果您想显示具有特定所有者的对话框，请仅使用 IWin32Window 构造函数。这通常不是必需的。

ShowDialog() 的文档指出，“将表单显示为模式对话框，当前活动窗口设置为其所有者。” 因此，除非您明确需要将窗体的所有者设置为不是活动窗口的窗口，否则无需使用 ShowDialog(IWin32Window)。******************