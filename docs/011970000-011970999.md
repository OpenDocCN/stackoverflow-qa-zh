# StackOverflow 问答 11970000-11970999

# sed - sed：更改词序并替换

> ID：11970005
> 
> 赞同：1
> 
> 时间：2012-08-15T13:18:15.593
> 
> 标签：sed

我正在尝试替换；

```
randomtext{{XX icon}} 
```

经过

```
randomtext{{ref-XX}} 
```

..在一个文件中，其中 XX 可以是 2 或 3 个小写字母的任意序列。

* * *

我尝试用 awk 重新排列词序，然后用 sed 将“icon”替换为“ref-”；

```
awk '{print $2, $1}' 
```

..但是由于第一个单词之前和第二个单词之后都没有空格，所以它弄乱了大括号；

```
icon}} {{XX 
```

* * *

使用 sed 实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:27:48.577

```
 sed 's/{{\([a-z]\{2,3\}\)\sicon/{{ref-\1/' 
```

这一班轮使用替代命令`s/PATTERN/REPLACE/`。`{{`匹配两个括号。`\([a-z]\{2,3\}\)`捕获匹配 2 个或 3 个小写字母的模式。`\s`匹配一个空白。`icon`匹配文字字符串“icon”。然后我们替换匹配，即`{{....icon`用文字字符串`{{ref-`和捕获的 2 或 3 个字母的单词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:41:17.713

`#`这是一个使用哈希标签 ( ) 作为正则表达式分隔符的更通用的版本：

```
sed 's#{{\([^ ]*\) [^}]*#{{ref-\1#' 
```

*   `{{`将正则表达式锚定在双开花括号上。
*   `\([^ ]*\)`捕获所有内容，直到一个空间。
*   `[^}]*`吃完所有东西，直到结束花括号。

# cakephp - CakePHP 2.x 和 Atlassian Crowd

> ID：11970009
> 
> 赞同：1
> 
> 时间：2012-08-15T13:18:41.587
> 
> 标签：cakephp, single-sign-on, atlassian-crowd

我正在推出一些基于 cakePHP 的内部工具，并希望利用我们的 Crowd 实例进行用户管理。有没有人成功地将 Crowd 与 Cake 集成在一起？我是否像对待任何其他 LDAP 提供程序一样对待它？

# visual-studio-2008 - 当项目包含公共库时，如何阻止 Visual Studio 构建失败？

> ID：11970010
> 
> 赞同：1
> 
> 时间：2012-08-15T13:18:40.923
> 
> 标签：visual-studio-2008, msbuild, dependencies

我有一个视觉工作室解决方案（粗略地说）以下布局：

```
Common.dll
Proja (project which references Common.dll)
Projb (project which references Common.dll)
Main (Executable which references proja and projb) 
```

问题是有时当我编译时我得到

```
11>Proja : error PRJ0008 : Could not delete file 'c:\Blah blah blah\Main\Release\Ionic.Zip.dll'. 
```

...因为（我认为）proja 和 projb 都是同时构建的。由于它们最终都在同一个输出目录中，我猜测一个线程试图删除 Common.dll，而另一个线程正在使用它或类似的东西。

现在，如果只是我在编译项目，那很好，因为我总是可以点击重建按钮，并且在几次失败后，它会出现排序本身。更困难的问题是我们正在转向使用 Jenkins 并且一直失败。

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T08:37:39.197

摆弄了一下，但似乎最终解决问题的一点是将每个项目的中间和输出目录更改为`$(ProjectDir)\$(ConfigurationName`似乎已经解决了问题。我可以使用任意数量的处理器运行 MSBuild，它仍然成功 :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:26:07.830

从项目菜单、项目构建顺序、项目依赖项选项卡

这可能会有所帮助

# php - Opencart - 显示两个产品类别之一

> ID：11970014
> 
> 赞同：1
> 
> 时间：2012-08-15T13:19:04.550
> 
> 标签：php, opencart

我有 Opencart 1.5.1.3 并修改了 Meta 标题以显示“产品名称 - 产品类别”

> $product_info['name'] 。'-'。$category_info['名称']

问题是当某些产品属于两个或多个类别时。如何告诉打开的购物车使用任何一种产品类别？我真的不在乎哪一个:)

```
$this->language->load('product/product');

    $this->data['breadcrumbs'] = array();

    $this->data['breadcrumbs'][] = array(
        'text'      => $this->language->get('text_home'),
        'href'      => $this->url->link('common/home'),         
        'separator' => false
    );

    $this->load->model('catalog/category'); 
    $this->request->get['path'] = (isset($this->request->get['path']))? $this->request->get['path'] : $this->model_catalog_category->getCategoryPath($this->request->get['product_id']);

    if (isset($this->request->get['path'])) {
        $path = '';

        foreach (explode('_', $this->request->get['path']) as $path_id) {
            if (!$path) {
                $path = $path_id;
            } else {
                $path .= '_' . $path_id;
            }

            $category_info = $this->model_catalog_category->getCategory($path_id);

            if ($category_info) {
                $this->data['breadcrumbs'][] = array(
                    'text'      => $category_info['name'],
                    'href'      => $this->url->link('product/category', 'path=' . $path),
                    'separator' => $this->language->get('text_separator')
                );
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:45:34.980

您上面的代码假设您通过类别获得产品，而实际上这并不总是发生。相反，您想要执行以下操作

在中找到这一行`/catalog/controller/product/product.php`

```
$this->document->setTitle($product_info['name']); 
```

将其替换为以下内容

```
 $result = $this->db->query("
            SELECT `cd`.`name`
            FROM `" . DB_PREFIX . "product_to_category` `p2c`
            LEFT JOIN `" . DB_PREFIX . "category_description` `cd`
            ON `cd`.`category_id` = `p2c`.`category_id`
            WHERE `p2c`.`product_id` = '" . (int) $product_id . "'
            AND `cd`.`language_id` = '" . $this->confing->get('config_language_id') . "'
            ORDER BY `cd`.`category_id` DESC
            LIMIT 1
        ");

        $category_name = $result->num_rows ?  $result->row['name']: '';
        $this->document->setTitle($product_info['name'] . (empty($category_name) ? '' : ' - ' . $category_name)); 
```

这将始终显示最后创建的类别作为分配给产品的类别。如果未分配类别，它也不会显示类别（并隐藏 - ）

# ruby-on-rails - ActionView::Template::Error (can't dup Symbol): -- AWS 仅在图像质量下降的情况下出现问题

> ID：11970018
> 
> 赞同：0
> 
> 时间：2012-08-15T13:19:22.253
> 
> 标签：ruby-on-rails, amazon-s3, amazon-web-services, paperclip

我正在我的网站上进行一些图像优化。事情在开发机器上工作得很好，但在生产模式下我得到一个错误，即：

```
ActionView::Template::Error (can't dup Symbol): 
```

**这只发生在 aws 的情况下，如果我删除它，那么一切都会正常工作：**

我正在使用并且运行良好的代码：

```
 has_attached_file :attachment, {
             :styles => { 
                 :medium=>"654x346>",
                 :small => "260x400>",
                 :thumb => "75x75#",
                 :facebook_meta_tag => "200x200#" 
                 }, :include_updated_timestamp => false
             }.merge(PAPERCLIP_STORAGE_OPTIONS) 
```

但是现在我修改了它，它在开发环境中工作得很好，但在生产环境中却没有。

```
has_attached_file :attachment,
   :styles => {
     :medium => {
       :geometry => "654x346>",
       :quality => 60,
       :format => 'JPG'
     },
     :small => {
       :geometry => "260x400>",
       :quality => 60,
       :format => 'JPG'
     },
     :thumb => {
       :geometry =>"75x75#",
       :quality => 60,
       :format => 'JPG'
     },
     :facebook_meta_tag => {
       :geometry =>"200x200#",
       :quality => 50,
       :format => 'JPG'
     }
     }.merge(PAPERCLIP_STORAGE_OPTIONS) 
```

其他相关设置：

```
 PAPERCLIP_STORAGE_OPTIONS = {
      :storage => :s3, 
      :s3_credentials => "#{Rails.root}/config/amazons3.yml",
} 
```

amazons3.yml

```
production:
   access_key_id: XXXXxxxXXXXxxx
   secret_access_key: XXXXxxxXXXXxxxXXXXxxxXXXXxxxXXXXxxxXXXXxxx
   bucket: images.XXXXxxx.com 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T20:12:33.333

这是工作代码：

```
 has_attached_file :attachment, {
       :styles => {
         :medium => ["654x346>", :jpg],
         :small => ["260x400>", :jpg], 
         :thumb => ["75x75#", :jpg],
         :facebook_meta_tag =>["200x200#", :jpg] 
         }, 
          :convert_options => {
             :medium => "-quality 60",
             :small => "-quality 60",
             :thumb => "-quality 60",
             :facebook_meta_tag => "-quality 60" 
             } 
          }.merge(PAPERCLIP_STORAGE_OPTIONS) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-15T14:11:52.763

`ActionView::Template::Error`往往是视图内部引发的错误（Rails 将错误重新包装在内部视图中`ActionView::Template::Error exceptions`）。

为了帮助您更多，我需要查看回溯和所涉及的视图。

这不是一个真正的答案，但如果这有助于您找到原因，您不妨接受它。

# c - OpenCV傅里叶幅度 - 似乎不正确

> ID：11970023
> 
> 赞同：1
> 
> 时间：2012-08-15T13:19:35.713
> 
> 标签：c, image, opencv, fft, fftw

我相信我在尝试将傅里叶幅度谱转换为图像时遇到了缩放问题。

我正在研究自己的视觉里程计项目，以确定来自相机输入的连续帧之间的平移和旋转。我已经成功地使用傅立叶变换的相位相关确定了平移，但是确定旋转的一部分需要对幅度谱进行卷积。从本质上讲，我产生的幅度似乎并不正确，如下所示。

原图：
![在此处输入图像描述](../Images/7473c4f4103c455c6ab4c1e795e6ad2b.png)

幅度，使用 'mag = 255*(mag/max)' 缩放
![在此处输入图像描述](../Images/714e1c504b21a8b0874be7bd01984c26.png)

幅度，没有缩放
![在此处输入图像描述](../Images/b55fee4e75c3a3de4b13a250e6cbad26.png)

不幸的是，我需要关于我用来确定幅度的函数的帮助，我相信我的错误在于幅度的缩放，但我不确定。这个问题困扰了我一段时间，您的意见将不胜感激，谢谢。

```
void iplimage_dft(IplImage* img)
{
  IplImage*     img1, * img2;
  fftw_complex* in, * dft, * idft;
  fftw_plan     plan_f, plan_b;
  int           i, j, k, w, h, N;

  /* Copy input image */
  img1 = cvCloneImage(img);

  w = img1->width;
  h = img1->height;
  N = w * h;

  /* Allocate input data for FFTW */
  in   = (fftw_complex*) fftw_malloc(sizeof(fftw_complex) * N);
  dft  = (fftw_complex*) fftw_malloc(sizeof(fftw_complex) * N);

  /* Create plans */
  plan_f = fftw_plan_dft_2d(w, h, in, dft, FFTW_FORWARD, FFTW_ESTIMATE);

  /* Populate input data in row-major order */
    for (i = 0, k = 0; i < h; i++) 
    {
        for (j = 0; j < w; j++, k++)
        {
            in[k][0] = ((uchar*)(img1->imageData + i * img1->widthStep))[j];
           in[k][1] = 0.0;
        }
    }

  /* Forward & inverse DFT */
  fftw_execute(plan_f);

  /* Create output image */
  img2 = cvCreateImage(cvSize(w, h), 8, 1);

    //Find the maximum value among the magnitudes
    double max=0;
    double mag=0;
    for (i = 0, k = 1; i < h; i++){
        for (j = 0; j < w; j++, k++){
            mag = sqrt(pow(dft[k][0],2) + pow(dft[k][1],2));
            if (max < mag)
                max = mag;
        }
    }

  // Convert DFT result to output image
    for (i = 0, k = 0; i < h; i++)
    {
        for (j = 0; j < w; j++, k++)
        {
            double mag = sqrt(pow(dft[k][0],2) + pow(dft[k][1],2));
            mag = 255*(mag/max);
            ((uchar*)(img2->imageData + i * img2->widthStep))[j] = mag;
        }
    }   

  cvShowImage("iplimage_dft(): original", img1);
  cvShowImage("iplimage_dft(): result", img2);
  //cvSaveImage("iplimage_dft.png", img2,0 );
  cvWaitKey(0);

  /* Free memory */
  fftw_destroy_plan(plan_f);
  fftw_free(in);
  fftw_free(dft);
  cvReleaseImage(&img1);
  cvReleaseImage(&img2);
}

int main( int argc, char** argv )
{
    argv[1] = "image1.jpg";

    IplImage *img3 = cvLoadImage( argv[1], CV_LOAD_IMAGE_GRAYSCALE );
    iplimage_dft(img3);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:28:33.470

许多图像的光谱具有这样的特征 - 几个相对较高的峰值，而其余的场在幅度上非常小。看起来您正在正常化，只是细节丢失了，因为大部分频谱的幅度非常小。如果您想检查细节，我经常发现使用 log(mag(spectrum)) （甚至在某些情况下甚至 log(log(mag(spectrum))) 来生成图像更有用。

# java - developer.android.com 我的第一个 Android 应用 | 停止错误

> ID：11970024
> 
> 赞同：1
> 
> 时间：2012-08-15T13:19:36.163
> 
> 标签：java, android, eclipse, virtual-machine, avd

我试图运行我的第一个 android 应用程序，但我无法执行它。**我从developer.android.com**一步一步地按照说明进行操作。我只对代码使用了复制和粘贴。但是当我尝试运行我的应用程序时，AVD 给出错误**“不幸的是，我的第一个应用程序已经弯腰。”**

**屏幕截图在这里：** **AVD 设置**：[单击](http://postimage.org/image/qntrav3vb/) **LOG FILE**：[单击](http://hakkikonu.com/android_log.txt)

## AndroidManifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
        package="com.example.myfirstapp"
        android:versionCode="1"
        android:versionName="1.0" >

        <uses-sdk
            android:minSdkVersion="8"
            android:targetSdkVersion="15" />

        <application
            android:icon="@drawable/ic_launcher"
            android:label="@string/app_name"
            android:theme="@style/AppTheme" >

            <activity
                android:name=".MainActivity"
                android:label="@string/title_activity_main" >
                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </activity>

            <activity
                android:name=".DisplayMessageActivity"
                android:label="@string/title_activity_display_message" >
                <meta-data
                    android:name="android.support.PARENT_ACTIVITY"
                    android:value="com.example.myfirstapp.MainActivity" />
            </activity>

        </application>

    </manifest> 
```

**activity_main.xml**

```
<?xml version="1.0" encoding="utf-8"?>
        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="horizontal" >

        <EditText android:id="@+id/edit_message"
            android:layout_weight="1"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:hint="@string/edit_message"/>

        <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/button_send" 
            android:onClick="SendMessage"
            />

    </LinearLayout> 
```

**activity_display_message.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_centerVertical="true"
            android:text="@string/hello_world"
            tools:context=".DisplayMessageActivity" />

    </RelativeLayout> 
```

**字符串.xml**

```
<resources>

        <string name="app_name">My First App</string>
        <string name="menu_settings">Settings</string>
        <string name="title_activity_main">MainActivity</string>
        <string name="edit_message">Bir şeyler yaz</string>
        <string name="button_send">Send</string>
        <string name="hello_world">Hello world!</string>
        <string name="title_activity_display_message">My Message</string>

    </resources> 
```

**DisplayMessageActivity.java**

```
package com.example.myfirstapp;
        import android.app.Activity;
        import android.content.Intent;
        import android.os.Bundle;
        import android.widget.*;

        public class DisplayMessageActivity extends Activity {
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            // Get the message from the intent
            Intent intent = getIntent();
            String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);

            // Create the text view
            TextView textView = new TextView(this);
            textView.setTextSize(40);
            textView.setText(message);

            // Set the text view as the activity layout
            setContentView(textView);
        }
         } 
```

**MainActivity.java**

```
package com.example.myfirstapp;

            import android.app.Activity;
            import android.content.Intent;
            import android.os.Bundle;
            import android.view.Menu;
            import android.view.View;
            import android.widget.*;

            public class MainActivity extends Activity {

         public final static String EXTRA_MESSAGE = "com.example.myfirstapp.MESSAGE";

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            getMenuInflater().inflate(R.menu.activity_main, menu);
            return true;

        }

        public void sendMessage(View view) {
            Intent intent = new Intent(this, DisplayMessageActivity.class);

            EditText editText = (EditText) findViewById(R.id.edit_message);
            String message = editText.getText().toString();
            intent.putExtra(EXTRA_MESSAGE, message);
            startActivity(intent);

        }
          } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T13:24:15.693

按钮单击方法中的拼写错误，`s is not small its capital in xml layout file...`

```
public void SendMessage(View view) {
            ^ 
```

# ios - 在 iOS 中使用 icns 文件作为图像

> ID：11970025
> 
> 赞同：0
> 
> 时间：2012-08-15T13:19:39.210
> 
> 标签：ios, cocoa-touch, uiimage

有没有办法使用 icns 文件作为我猜的图像源`UIImage`？或者选择其中一种表示并调整大小？

`NSImage`可可触摸中似乎没有。

特别是我想用它们来绘制 UITableViewCell 的 imageView 部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:37:40.663

没有内置的方法可以做到这一点，我认为这样做没有什么好处。最好只使用您需要的尺寸并将它们作为单独的图像发送到您的应用程序中。如果您想在 UITableViewCell 中绘制图像，性能是一个重要方面，并且调整图像大小不会很快。

如果您确实需要许多不同尺寸的图像，并且真的不希望通过包含每种尺寸的图像来获得最佳性能，您可以使用 PDF 来利用矢量图形。有一篇关于这种技术的好文章：http: [//mattgemmell.com/2012/02/10/using-pdf-images-in-ios-apps/](http://mattgemmell.com/2012/02/10/using-pdf-images-in-ios-apps/)

老实说，不要尝试在您的 iOS 应用程序中使用 .icns 文件。它只是不同大小图像的容器，无论如何调整大小不是一个好主意。要么包含您需要的任何尺寸的单个图像，要么使用 PDF 文件使用矢量图形。

# c++ - 如何在没有 Boost 的情况下将 C++ 成员函数作为线程执行？

> ID：11970026
> 
> 赞同：2
> 
> 时间：2012-08-15T13:19:39.723
> 
> 标签：c++, multithreading, class-members

我正在使用一个支持线程的小型嵌入式 RTOS。我正在用 C++ 编程，并想创建一个类，它允许我将任何类的任意成员函数作为线程运行。RTOS 不直接支持从成员函数创建线程，但如果从线程中调用它们就可以正常工作。Boost::thread 在我的平台上不可用。

我目前正在通过一个朋友 thread_starter() 函数以临时方式启动线程，但似乎我必须为每个我想从中运行线程的类设置一个单独的线程。我当前的线程基类解决方案使用虚拟 run() 函数，但这有一个缺点，即我只能为一个类启动 1 个线程，并且仅限于 run() 函数 + 依次调用的任何内容（即我不能从 run() 优雅地运行任意函数）

理想情况下，我想要一个模板化的类“线程”，这样我就可以在类“X”成员函数中执行以下操作：

```
class X 
{
    run_as_thread(void* p)';
};

X x;
void* p = NULL;

template<X>
thread t(x, X::run_as_thread, p);

//somehow causing the following to be run as a thread :
x->run_as_thread(p); 
```

很抱歉，如果以前在这里做过死，但我似乎只能找到使用 Boost::thread 来完成此操作的参考，而这对我来说是不可用的。我也无权访问堆，因此所有全局变量都必须是静态的。

非常感谢，

麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:25:56.800

如果您的编译器足够现代以支持 C++11[线程功能](http://en.cppreference.com/w/cpp/thread)，那么您可以使用它。

也许是这样的：

```
class X
{
public:
    void run(void *p);
};

X myX;
void *p = nullptr;

std::thread myThread(std::bind(&X::run, myX, p)); 
```

现在`X::run`将作为线程运行。在线程完成后调用`std::thread::join`以清理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T13:36:31.690

假设你的 RTOS 工作起来有点像 pthreads，并且你没有 C++11（这可能会假设你的线程支持）你可以使用这种机制，但是你需要一个类中的静态方法，它需要一个指针到类的一个实例。因此（大致）

```
class Wibble
{
  public:
    static void *run_pthread(void *me)
    {
         Wibble *x(static_cast<Wibble *>(me));
         return x->run_thread_code();
    }
  private:
    void *run_thread();
};

Wibble w;
pthread_create(&thread, &attr, Wibble::run_pthread, &w); 
```

传递参数作为练习留给读者......

这可以通过一些努力来模板化，但这就是胆量需要工作的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:41:01.770

听起来您要问的是一种在类上异步运行任意成员函数的方法。我从您对虚拟`run()`功能的评论中得出：

> “这有一个缺点，我只能为一个班级启动 1 个线程”

...意味着您不喜欢该选项，因为它会导致所有函数调用在该线程中执行，而您想要的是能够将单个函数调用线程化，而不仅仅是创建面向对象的线程抽象。

您应该查看目标平台的线程池库。鉴于不了解您的实际平台或要求，我无法提供任何具体建议，但这应该为您提供一个搜索词，并希望获得一些富有成效的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T13:38:54.307

[在此处](https://stackoverflow.com/questions/11940209/how-to-pass-c-callbacks-between-unrelated-classes/11940405#11940405)查看我关于在非增强项目中的不*相关类之间传递 C++ 回调*的帖子。

# java - 在不同机器上使用 JasperReports API 运行代码时出现问题

> ID：11970032
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:19:54.393
> 
> 标签：java, jasper-reports

我创建了一个将使用*JasperReports API*的 Java 项目。我已经在*NetBeans*内部和外部（同一台机器）进行了测试，它工作正常。但是当我尝试在另一台机器上运行它时，报告不会加载。

我的代码是：

```
package reportmonitory;

import java.sql.*;
import net.sf.jasperreports.engine.JasperCompileManager;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.swing.JRViewer;
import javax.swing.*;

public class monthlyreport extends JFrame {

    Connection con;
    Statement stmt;
    ResultSet rs;

    void showReport() {
        try {
            String host = "jdbc:mysql://192.168.10.11/rmcdb";
            String uName = "root";
            String uPass = "";
            Class.forName("com.mysql.jdbc.Driver").newInstance();
            con = DriverManager.getConnection(host, uName, uPass);
            stmt = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);
            String reportName = "reports/finalreport.jasper";
            java.io.InputStream is = this.getClass().getClassLoader().getResourceAsStream(reportName);
            JasperPrint print = JasperFillManager.fillReport(is, null, con);
            JRViewer viewer = new JRViewer(print);
            viewer.setOpaque(true);
            viewer.setVisible(true);
            this.add(viewer);
            this.setSize(1000, 1000);
            this.setVisible(true);
            this.setDefaultCloseOperation(HIDE_ON_CLOSE);
        } catch (Exception ex) {
            System.out.println("CAUSE: " + ex.getCause());
            System.out.println("MESSAGE" + ex.getMessage());
            System.out.println("LOCAL MESSAGE" + ex.getLocalizedMessage());
            ex.printStackTrace();
        }
    }

    public static void main(String args[]) {
        new monthlyreport().showReport();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:26:15.253

以下是一些建议/要研究的事情：

*   防火墙后数据库的端口转发
*   指定端口以防数据库的连接端口已更改
*   确保 'reports/finalreport.jasper' 存在
*   包装（由于项目移动）
*   确保所有 .jar's / JasperReport API 文件都在那里
*   该项目调用的所有其他文件都在那里
*   网络问题/找不到主机名：192.168.10.11

编辑：

该错误来自无法找到“npa logo.jpg”。确保它存在于正确的路径上。我注意到您正在“C:\Users\mwaluda”上查找它，并且您正在 C:\Users\Aboud 上运行 JaspterReports。如果这是另一台机器，那条路径仍然有效吗？

# .htaccess - 如何使用 htaccess 更改 url

> ID：11970034
> 
> 赞同：0
> 
> 时间：2012-08-15T13:19:58.897
> 
> 标签：.htaccess

我有这个网址：

```
 merchantstore.php?merchant=100&product=208 
```

我想转换为：

```
/merchant-store-name/product-name 
```

商家商店名称替换 ?merchant=100 和产品名称替换 &product=208

我如何在 htacess 文件中做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T10:57:31.127

我建议您使用基于 PHP 的方法。在 .htaccess 中：

```
RewriteRule (.*) switchboard.php?orig_uri=$1 
```

这会捕获整个请求的 uri，并将其转发到中央交换机。然后在 switchboard.php 中，您可以访问请求的 uri，您可以沿着 '/' 符号explode()，然后查找与数据库中的名称相关联的 id-s。

```
$components = explode('/', $_GET['orig_uri']);
list( $merchant_name, $product_name ) = $components;

// get merchant id and product id from your database

// and serve suitable content by include-ing:
include 'merchant.php'; 
```

这是一种简单的方法，而且很容易扩展。它还有一个额外的优势，即不需要 mod-rewrite 魔法。

不要忘记添加适当的错误处理。

# openerp - 更改字段值并在按钮按下时触发 onchange 事件

> ID：11970035
> 
> 赞同：2
> 
> 时间：2012-08-15T13:20:04.267
> 
> 标签：openerp

非常简单的示例：我在发票对象上添加了`Change to default partner`按钮 ( )。`type="object"`当我按下它时，会调用一个函数，该函数会返回默认伙伴的 ID（或其他值）。如何更改`Partner`将触发`onchange`该字段事件的字段（它会像我从 UI 更改它一样做出反应）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T05:22:59.517

如果是按钮，则在按钮对象中将合作伙伴ID写入我们从您所说的函数中获得的发票对象，如果要执行合作伙伴的onchange函数，则调用按钮函数内部的onchange函数将返回一个字典并从该字典中获取“值”。例如：

```
def button_change_partner(self, cr, uid, ids, context=None):
    ##Your function to get partner id
    partner_details = self.onchange_partner_id(cr, uid, [], partner_id,context)#please replace with your actual onchange functionality and its arguments
    partner = partner_details['values']
    partner.update('partner_id': partner_id)
    self.write(cr, uid, ids, partner, context)
    return True 
```

# c# - C# VSTO 项目从 Excel 2010 更改为 Excel 2007

> ID：11970036
> 
> 赞同：2
> 
> 时间：2012-08-15T13:20:16.263
> 
> 标签：c#, excel, vsto

我在 VS2010 中有一个作为 Excel 2007 插件开发的解决方案。不幸的是，我的个人资料发生了一些事情，从那时起 VS 使用 Excel 2010 运行该解决方案。不知何故，我的个人资料已损坏，我的 VS 解决方案也已损坏，将 Office 库从 2007 年更改为 2010 年。我尝试将库更改回 2007 年，但每次我打开 VS 解决方案 VS 更改它。任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T19:58:50.163

您必须安装了**Office 2010**，它强制 VS.NET 使用**Office 14 PIA**。您仍然可以将加载项部署到**Office 2007**，您只需确保不使用任何**Office 2010**特定功能。

另请参阅[相关的 SO 帖子](https://stackoverflow.com/a/10602014/175679)。

# google-apps-script - 根据以下值更改单元格颜色

> ID：11970038
> 
> 赞同：1
> 
> 时间：2012-08-15T13:20:23.457
> 
> 标签：google-apps-script, google-sheets

我一直在到处寻找一种方法来根据谷歌电子表格中下面单元格的值来改变单元格的颜色。

如果下面的直接单元格的值是 > 或 < 或 = 为 0 ，则范围内的每个单元格都`A1:F1`需要更改颜色。

所以`A1`会一直看`A2`，`B1`会一直看`B2`等等。在我的表格中，我可能需要一个随机单元格范围，其值低于它，更改颜色。我也想使用命名范围，因为这永远不会改变。

我很想提供一个代码示例，但问题是我什至不知道在函数`onEdit()`和设置我认为的变量应该是什么之后从哪里开始。

```
function onEdit(){
  var e = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = e.getActiveSheet().getName('Basic');
  var items = e.getRangeByName('avgt1v1name').getValues();
  var values = e.getRangeByName('avg1t1b').getValues(); 
```

我不知道我应该使用 IF 语句还是使用 FOR 或 WHILE 进行循环。

对你的帮助表示感谢。

提前致谢。墨修斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T08:34:47.950

我猜...

```
function onEdit() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var s = ss.getSheetByName('Basic');
  var values = ss.getRangeByName('avg1t1b').getValues();

  var nameRange = ss.getRangeByName('avgt1v1name');
  var rowIndex = nameRange.getRowIndex();

  for (var i = 0; i <= values[0].length -1; i++) {
    var col = i + 1;
    var cell = values[0][i];
    if (cell != '' && (cell <= 0 || cell > 0) ) {
      nameRange.getCell(rowIndex, col ).setBackgroundColor('red');
      }
    else {nameRange.getCell(rowIndex, col ).setBackgroundColor('white');}
  }
}; 
```

当数字零出于某种原因在电子表格中时不起作用。[电子表格](https://docs.google.com/spreadsheet/ccc?key=0AnJTymuE8awLdHRXZUlVVjZTV1hNeHRGQ0liT3Z4eWc)。

# javascript - 如何从 SP.UI.ModalDialog 获取参数？

> ID：11970048
> 
> 赞同：7
> 
> 时间：2012-08-15T13:21:02.373
> 
> 标签：javascript, asp.net, sharepoint, sharepoint-2010

我尝试了其他在线建议但没有成功。

所以...

我打开 SharePoint 对话框的函数传递`agrs`到规定的`option`对象，如下所示：

**设置对话：**
这里没有什么神奇的……

```
 function openEmailDialog() {
        var options = SP.UI.$create_DialogOptions(),
            url = '../Pages/EmailDocument.aspx';

        options.title = "Email Documents";
        options.width = 1024;
        options.height = 400;
        options.allowMaximize = false;
        options.url = url;
        options.args = {  DidYouGetThis: true };

        SP.UI.ModalDialog.showModalDialog(options);
    }; 
```

下一个...

在打开目标 URL 时，大多数在线示例推荐使用以下 JavaScript`args`从对话框中提取 BACK，如下所示：

**获取参数：**
记住，这是一个新页面中的 JavaScript，刚刚作为对话框打开......

```
$(document).ready(function () {
    // This fails because "get_childDialog" doesn't exist
    var args = SP.UI.ModalDialog.get_childDialog().get_args();
}); 
```

这失败了，因为该`SP.UI.ModalDialog`对象没有`get_childDialog`功能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T13:42:58.780

采用`var args = window.frameElement.dialogArgs;`

[我用来参考的文章](https://web.archive.org/web/20160412004233/http://www.sharepointdevelopment.me/2011/06/passing-data-to-and-from-sharepoint-modal-dialogs/)。

[直播文章](https://platinumdogs.me/2013/03/05/sharepoint-passing-parameter-data-to-a-modal-dialog-and-ie7/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:49:29.620

这是一个讨论这个概念的教程。- [http://www.sharepointdevelopment.me/2011/06/passing-data-to-and-from-sharepoint-modal-dialogs/](http://www.sharepointdevelopment.me/2011/06/passing-data-to-and-from-sharepoint-modal-dialogs/)

# vb.net - 查找特定的打开文件对话框并填充

> ID：11970052
> 
> 赞同：1
> 
> 时间：2012-08-15T13:21:38.340
> 
> 标签：vb.net, window, find, findwindow, identify

我正在尝试找到一种方法来识别打开文件对话框并向“文件名”字段发送消息。之后它需要向按钮发送“Enter”键或“Open”命令。

我在 VB 中这样做，但如果有人也可以在 C# 中提供帮助，我相信我可以应付。

我整天都在研究 API 并提出了几种可能性，但我不熟悉如何在 DotNet4 中实现它。我曾经在 VB6 中使用 API，但现在情况似乎有些不同了。

如果有人可以为我提供一个小例子，我将不胜感激。

我看过的一些 API 是 FindWindow 和 FindWindowEx。

编辑：

我发现了一些值得一看的代码。此代码需要在模块内部使用。当我找到更多答案时，我会发布更多内容。

```
Imports System.Runtime.InteropServices
Imports System.Text

Module modEnumWindows

Private windowList As New ArrayList
Private errMessage As String

Public Delegate Function MyDelegateCallBack(ByVal hwnd As Integer, ByVal lParam As Integer) As Boolean
Declare Function EnumWindows Lib "user32" (ByVal x As MyDelegateCallBack, ByVal y As Integer) As Integer

Declare Auto Function GetClassName Lib "user32" _
    (ByVal hWnd As IntPtr, _
    ByVal lpClassName As System.Text.StringBuilder, _
    ByVal nMaxCount As Integer) As Integer

Declare Auto Function GetWindowText Lib "user32" _
   (ByVal hWnd As IntPtr, _
   ByVal lpClassName As System.Text.StringBuilder, _
   ByVal nMaxCount As Integer) As Integer

Private Function EnumWindowProc(ByVal hwnd As Integer, ByVal lParam As Integer) As Boolean

    'working vars
    Dim sTitle As New StringBuilder(255)
    Dim sClass As New StringBuilder(255)

    Try

        Call GetClassName(hwnd, sClass, 255)
        Call GetWindowText(hwnd, sTitle, 255)

        windowList.Add(sClass.ToString & ", " & hwnd & ", " & sTitle.ToString)

    Catch ex As Exception
        errMessage = ex.Message
        EnumWindowProc = False
        Exit Function
    End Try

    EnumWindowProc = True

End Function

Public Function getWindowList(ByRef wList As ArrayList, Optional ByVal errorMessage As String = "") As Boolean

    windowList.Clear()

    Try
        Dim del As MyDelegateCallBack
        del = New MyDelegateCallBack(AddressOf EnumWindowProc)
        EnumWindows(del, 0)
        getWindowList = True
    Catch ex As Exception
        getWindowList = False
        errorMessage = errMessage
        Exit Function
    End Try

    'wList.Clear()
    wList = windowList

End Function

End Module 
```

通过使用它，您将能够识别窗口文本、HWND 和类。希望这对人们有所帮助。对我来说，下一步将是确定我希望将数据发送到的字段。

# django - 将文件上传到 Amazon S3 时，Django 引发 OSError: Permission denied

> ID：11970061
> 
> 赞同：0
> 
> 时间：2012-08-15T13:22:12.597
> 
> 标签：django, amazon-s3

我使用[django-s3-folder-storage](https://github.com/jamstooks/django-s3-folder-storage)将 S3 集成到我的 Django 项目中，当我运行`python manage.py collectstatic`将静态文件上传到存储桶时可以，但是当我尝试将图像上传到管理站点中的存储桶时，它会引发错误`Permission denied`：

```
OSError at /admin/picture/picture/1/
[Errno 13] Permission denied: '/media/draw_share_picture'
Request Method: POST
Request URL:    http://127.0.0.1:8000/admin/picture/picture/1/
Django Version: 1.3.1
Exception Type: OSError
Exception Value:    
[Errno 13] Permission denied: '/media/draw_share_picture'
Exception Location: /home/ragnarok/Projects/drawshare/venv/lib/python2.7/os.py in makedirs, line 157
Python Executable:  /home/ragnarok/Projects/drawshare/venv/bin/python
Python Version: 2.7.3
Python Path:    
['/home/ragnarok/Projects/drawshare/drawShare',
 '/usr/lib/python2.7/site-packages/liquidluck-0.3-py2.7.egg',
 '/usr/lib/python2.7/site-packages/houdini.py-0.1.0-py2.7-linux-i686.egg',
 '/usr/lib/python2.7/site-packages/misaka-1.0.2-py2.7-linux-i686.egg',
 '/usr/lib/python2.7/site-packages/docutils-0.9.1-py2.7.egg',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7/site-packages/distribute-0.6.27-py2.7.egg',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7/site-packages/pip-1.1-py2.7.egg',
 '/home/ragnarok/Projects',
 '/usr/lib/python2.7/site-packages',
 '/home/ragnarok/Projects/drawshare/drawShare',
 '/usr/lib/python2.7/site-packages/PIL',
 '/usr/lib/python2.7/site-packages/gtk-2.0',
 '/usr/lib/python2.7/site-packages/setuptools-0.6c11.egg-info',
 '/home/ragnarok/Projects/drawshare/venv/lib/python27.zip',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7/plat-linux2',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7/lib-tk',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7/lib-old',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7/lib-dynload',
 '/usr/lib/python2.7',
 '/usr/lib/python2.7/plat-linux2',
 '/usr/lib/python2.7/lib-tk',
 '/home/ragnarok/Projects/drawshare/venv/lib/python2.7/site-packages'] 
```

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-04T16:35:30.217

你能做到吗，诸神黄昏？尝试在您的应用程序中运行[django-s3-folder-storage](https://github.com/jamstooks/django-s3-folder-storage)测试并告诉我您发现了什么。

```
python manage.py test s3_folder_storage 
```

# ios - Cocos2D 中的评分系统

> ID：11970067
> 
> 赞同：0
> 
> 时间：2012-08-15T13:22:51.970
> 
> 标签：ios, cocos2d-iphone, scoring

我的游戏有一个碰撞检测，当我的导弹击中敌人时，敌人就会消失。我想添加一个评分系统，每次我的导弹击中敌人时加 1 分。我将在下面发布我的游戏代码（我使用了 HelloWorldLayer.m）**

这是代码：

链接 - [http://pastebin.com/iGP83SCv](http://pastebin.com/iGP83SCv)

在碰撞部分，我只想让它在每次弹丸击中敌人“萌芽”时加 1 分，并在标签中显示分数。示例：得分：0000

PS，请尽可能简单地解释它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:38:54.307

`@synthesize`type 的“score”属性和 type`int`的“scoreLabel”属性`CCLabelTTF`。

将你的 score 属性初始化为“0”`-(void)init`

在第 126 行，将您的“分数”属性增加 1，并将该值设置为您的`CCLabelTTF`.

# c++ - winsock：使用 localhost (127.0.0.1) 时连接失败并出现错误 10049

> ID：11970069
> 
> 赞同：4
> 
> 时间：2012-08-15T13:22:58.423
> 
> 标签：c++, windows, sockets, winsock, connect

我写了一个类来封装一些winsock函数来模拟一个简单的TCP套接字来满足我的需要......

当我尝试运行一个简单的连接并发送数据到服务器测试时，“客户端”在其调用连接失败时出现了[MSDN 上的错误代码 10049 (WSAEADDRNOTAVAIL) 连接函数](http://msdn.microsoft.com/en-us/library/ms737625%28v=vs.85%29.aspx)

我正在做的是（下面的代码）： **服务器：**

1.  创建一个服务器套接字 -> 将其绑定到*端口 12345*
2.  将 Socket 置于监听模式
3.  来电接听

**客户**

1.  创建一个套接字 -> 将其绑定到一个随机端口
2.  调用 Connect：连接到*localhost，端口 12345*

=> 如上所述，连接调用失败并出现错误 10049

**这是包括“服务器”在内的主要功能：**

```
HANDLE hThread = NULL;
Inc::CSocketTCP ServerSock;
Inc::CSocketTCP ClientSock;

try
{

    ServerSock.Bind(L"", L"12345");
    ServerSock.Listen(10);

    //Spawn the senders-thread
    hThread = (HANDLE)_beginthreadex(nullptr, 0, Procy, nullptr, 0, nullptr);

    //accept
    ServerSock.Accept(ClientSock);

    //Adjust the maximum packet size
    ClientSock.SetPacketSize(100);

    //receive data
    std::wstring Data;
    ClientSock.Receive(Data);

    std::wcout << "Received:\t" << Data << std::endl;
}
catch(std::exception& e)
{... 
```

**客户端线程函数**

```
unsigned int WINAPI Procy(void* p) 
```

{

```
Sleep(1500);
try{
    Inc::CSocketTCP SenderSock;
    SenderSock.Bind(L"", L"123456");

    SenderSock.Connect(L"localhost", L"12345");

    //Adjust packet size
    SenderSock.SetPacketSize(100);

    //Send Data
    std::wstring Data = L"Hello Bello!";
    SenderSock.Send(Data);
}
catch(std::exception& e)
{
    std::wcout << e.what() << std::endl;
}... 
```

**连接函数**

```
 int Inc::CSocketTCP::Connect(const std::wstring& IP, const std::wstring& Port)
{
    //NOTE: assert that the socket is valid
    assert(m_Socket != INVALID_SOCKET);

    //for debuggin: convert WStringToString here
    std::string strIP = WStringToString(IP), strPort = WStringToString(Port);

    Incgetaddrinfo AddyResolver;
    addrinfo hints = {}, *pFinal = nullptr;

    hints.ai_family = AF_INET;

    //resolve the ip/port-combination for the connection process
    INT Ret = AddyResolver(strIP.c_str(), strPort.c_str(), &hints, &pFinal);
    if(Ret)
    {
        //error handling: throw an error description
        std::string ErrorString("Resolving Process failed (Connect): ");
        ErrorString.append(Inc::NumberToString<INT>(Ret));
        throw(std::runtime_error(ErrorString.c_str()));
    }

    /*---for debbuging---*/
    sockaddr_in *pP = (sockaddr_in*)(pFinal->ai_addr);
    u_short Porty = ntohs(pP->sin_port);
    char AddBuffer[20] = "";

    InetNtopA(AF_INET, (PVOID)&pP->sin_addr, AddBuffer, 20);
    /*--------------------------------------------------------*/

    if(connect(m_Socket, pFinal->ai_addr, pFinal->ai_addrlen) == SOCKET_ERROR)
    {
        int ErrorCode = WSAGetLastError();
        if((ErrorCode == WSAETIMEDOUT) || (ErrorCode == WSAEHOSTUNREACH) || (ErrorCode == WSAENETUNREACH))
        {
            //Just Unreachable
            return TCP_TARGETUNREACHABLE;
        }

        //real errors now
        std::string ErrorString("Connection Process failed: ");
        ErrorString.append(Inc::NumberToString<int>(ErrorCode));
        throw(std::runtime_error(ErrorString.c_str()));
    }

    return TCP_SUCCESS;
} 
```

**附加信息：** -Incgetaddrinfo 是一个封装 getaddrinfo 的函数对象... -当使用调试器单步执行它们或让它们单独运行时，没有一个服务器函数返回任何错误并按预期工作...

我很高兴听到你的建议，问题可能是什么......

**编辑：**当我**不**连接到时它可以工作`("localhost","12345")`，**但是**到`("",12345)`......当查看它的地址解析过程时，`getaddrinfo`它会给出**127.0.0.1**和`"localhost"`我的**真实 IP**`""`

为什么它不适用于我的环回 IP？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T15:13:00.837

你的问题有答案：

> ...它提供`127.0.0.1`了`"localhost"`我的真实 IP`""`

这意味着您的服务器绑定到接口的真实 IP 而不是`INADDR_ANY`，即它不侦听环回。

### 编辑0：

创建侦听套接字时，您实际上并不需要名称解析。只是`bind()`为了`INADDR_ANY`监听所有可用的接口（包括环回）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-29T07:52:13.307

就我而言，此错误是由于`htonl`在`INADDR_LOOPBACK`将其分配给`address.sin_addr.s_addr`.

确保您转换为网络字节顺序，否则您将得到`0x0100007f (1.0.0.127)`而不是`0x7f000001 (127.0.0.1)`for 您的环回地址，并且绑定将失败并显示 code `10049 (WSAEADDRNOTAVAIL)`。

# google-chrome - 最新版 Chrome 中的 CSS3 动画变化？

> ID：11970070
> 
> 赞同：3
> 
> 时间：2012-08-15T13:23:00.523
> 
> 标签：google-chrome, animation, css

看看这个 JSFiddle：http: [//jsfiddle.net/Grimdotdotdot/URrLW/](http://jsfiddle.net/Grimdotdotdot/URrLW/)

在 Firefox 中，它按预期进行动画处理 - 里面的红色圆圈一圈又一圈地转，外面的蓝色圆圈以不同的速度旋转并淡入淡出。

这曾经在 Chrome 中运行良好，但自从最新更新到 21.0.1180.75 m 后，外部蓝色圆圈已停止旋转。

这是 Chrome 上动画的 CSS：

```
@-webkit-keyframes spinPulse {
    0% { -webkit-transform:rotate(160deg); opacity:0; box-shadow:0 0 1px #2187e7; }
    40% { -webkit-transform:rotate(145deg); opacity:1;}
    80% { -webkit-transform:rotate(-320deg); opacity:0; }
    100% { -webkit-transform:rotate(-320deg); opacity:0; }
} 
```

问题是不透明度 - 如果我删除它，那么动画效果很好（虽然它会在最后跳转，因为你可以看到它）：http: [//jsfiddle.net/Grimdotdotdot/BVXwR/](http://jsfiddle.net/Grimdotdotdot/BVXwR/)

这是一个错误，还是我的 CSS 写错了？

加分项：如何在 IE9 中实现相同的动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:22:18.713

所以我也有类似的情况。我正在尝试为给定页面中的多个 div 设置动画，尽管它们在源代码中呈现，但它们（及其子元素）在最新的 Chrome 中完全不透明。我相信（就我而言）我已经解决了这个问题。我在 rails 应用程序中使用了thoughtbot 的人的 sass 和 Bourbon mixin lib，但情况相似。我不确定这是否真的可以被认为是一个错误，因为该解决方案在 webkit 规范中的某些地方确实有概述 - 事实上，就目前而言，Chrome 似乎是唯一能够做到这一点的人 - 正确 - 因为它看起来像他们刚刚开始支持这一点（尽管 safari 没有？）它被提及。无论如何，当尝试使用两者的动画填充模式为变换设置动画时，这一点很明显。我已经验证这适用于旧版本的 Chromium 和 Safari。这是自最近一次 Chrome 更新以来在我们的应用程序中发生的最近一个问题。无论如何，我的 sass 代码是这样的

```
.animation-tilefill {
  @include animation(tilefill 0.25s $ease-out-sine);
  @include animation-fill-mode(both); 
}
@mixin tilefill {
  0% {
    opacity: 0;
     // @include transform(scale(0.0)); // <= There's our issue
     // @include transform-origin(left top); 
  }
  80% {
     // @include transform(scale(1));
  }
  100% {
    opacity: 1;
  }
}
@-webkit-keyframes tilefill { @include tilefill; }
   @-moz-keyframes tilefill { @include tilefill; }
        @keyframes tilefill { @include tilefill; } 
```

您必须了解一点波旁威士忌和 sass 才能知道这是在做什么，但是对于这个答案的需要，只要说它动画缩放变换以及元素的不透明度就足够了。这段代码的问题与变换本身无关，而是**0.0 VALUE - 零值是关键**。如果你看这里：[Safari CSS Reference](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariCSSRef/Articles/StandardCSSProperties.html#//apple_ref/doc/uid/TP30001266-_webkit_animation_duration)，你会在动画填充模式中看到**两个**描述：

> “动画的初始关键帧在动画样式应用到元素后立即应用，动画的最终关键帧在动画的最终迭代完成后继续应用。初始关键帧仅影响 -webkit 具有非零值的动画-动画延迟。”

关键部分是**初始关键帧仅影响 -webkit-animation-delay 具有非零值的动画，**我的修复是将 transform(scale()) 中的值更改为非负值，例如：

```
 0% {
    opacity: 0;
     @include transform(scale(0.01)); // <= There's our issue
     @include transform-origin(left top); 
  } 
```

一旦改变，问题就解决了 - 希望这会有所帮助。我想知道有些人对此的支持有何看法:)

# perl - 如何将 Perl Moose 与插件一起用于主对象？

> ID：11970071
> 
> 赞同：4
> 
> 时间：2012-08-15T13:23:09.727
> 
> 标签：perl, inheritance, plugins, moose

我是Moose的新手。我必须创建一个应该加载多个插件的对象。结构是这样的：

*   主对象 -> 一些通用函数
*   插件 -> 主对象的扩展

插件位于服务器上的单独文件夹中。主对象必须加载插件，初始化它们并将对象存储在自身中。每个插件的返回值都必须经过主对象。因为主对象应该为调用者转换 JSON 结构中的每个返回值。

我会这样称呼：

```
my $main_obj = Main->new();
$main_obj->plugin('MainExtention')->get_title(); 
```

这是我的示例代码：

**主要对象：**

```
package Main;
use Moose;

has 'plugins' => (
    is          => 'rw',
);

has 'title' => (
    is          => 'rw',
    isa         => 'Str',
    reader  => '_get_title',
);

# load plugins
sub _load_modules {
  my $self = shift;

    my $path = "/usr/local/apache/sites/.../Plugins";
  push(@INC, $path);

  my @modules = _find_modules_to_load($path);

  eval { 
        my $plugins = {};
        foreach my $module ( sort @modules) {
            (my $file = $module) =~ s|::|/|g;
            (my $modname = $module) =~ s/.*?(\w+$)/$1/;
            require $file . '.pm';
            my $obj = $module->new();
            $plugins->{$modname} = $obj;
            1;
        }
        $self->plugins($plugins);
  } or do {
      my $error = $@;
      warn "Error loading modules: $error" if $error;
  };

}

# read plugins
sub _find_modules_to_load {
    my ($dir) = @_;
    my @files = glob("$dir/*.pm");

    my $namespace = $dir;
    $namespace =~ s/\//::/g;

    # Get the leaf name and add the System::Module namespace to it
    my @modules = map { s/.*\/(.*).pm//g;  "${namespace}::$1"; } @files;

    return @modules;
}

sub BUILD {
    my $self = shift;
    $self->_load_modules();
}

sub get_title {
    return 'main title'
}

1;
__PACKAGE__->meta->make_immutable; 
```

**目录“/usr/local/apache/sites/.../Plugins”中的插件 MainExtention：**

```
package MainExtention;
use Moose;

has 'title' => (
    is          => 'rw',
    isa         => 'Str',
    default     => 'Default',
);

sub get_title {
    return 'MainExtention Title';
}

1; 
```

这像这样工作：

```
my $main = Main->new();
my $plugins = $main->plugins();
print $plugins->{'MainExtention'}->get_title(); 
```

但这不是我将拥有的 :) 我将不是直接从插件而是从主对象获得插件的返回。有人有想法吗？第二个问题：有没有更简单的方法来加载插件？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:33:53.747

要加载插件，我建议使用[Module::Pluggable](https://metacpan.org/module/Module%3a%3aPluggable)，它可以从目录加载一堆包并根据需要实例化它们（或不实例化它们）。

如果您需要让主对象包装插件，只需在主对象上定义一个方法来执行您需要的任何操作：

```
package Main;
use Moose;

# Adds a plugins() method to Main that returns a list of all loaded plugin packages
use Module::Pluggable search_dirs => [ "/usr/local/apache/sites/.../Plugins" ];

# Used to store the plugins after ->new is called on each package
has loaded_plugins => (
    is => 'rw',
    isa => 'HashRef[Object]',
    lazy_build => 1,
    traits => [ 'Hash' ],
    handles => { _plugin => 'get' },
);

# Constructor for loaded_plugins, implied by lazy_build => 1
sub _build_loaded_plugins {
    my ($self) = @_;

    my %loaded_plugins;
    for my $plugin ($self->plugins) {
        $loaded_plugins{$plugin} = $plugin->new;
    }

    return \%loaded_plugins;
}

# Method for getting the processed title from any plugin
sub get_plugin_title {
    my ($self, $name) = @_;

    my $plugin = $self->_plugin($name);

    my $title = $plugin->get_title;

    # process the title according to whatever Main needs to do...
    ...

    return $title;
} 
```

然后，您的代码：

```
my $main = Main->new();
print $main->get_plugin_title('MainExtension'); 
```

如果您使用 Moose，我还建议您让所有插件实现一个[角色](https://metacpan.org/module/Moose%3a%3aManual%3a%3aRoles)，这可以帮助您发现插件是否已正确实现。

# foursquare - 使用 photos/add api 和一个简单的表单将照片添加到场地

> ID：11970073
> 
> 赞同：2
> 
> 时间：2012-08-15T13:23:17.513
> 
> 标签：foursquare

我正在尝试实现一个简单的表单，允许我将照片添加到场地（有 30 多个）。我按照[这里](http://www.stephenkeable.co.uk/blog/development/create-a-foursquare-web-based-photo-uploader/)的指南更改了一些内容以匹配当前的 api。当我使用上传器时，我得到下面的 JSON 响应。一切都井井有条吗？我收到了 200 条回复，但我没有看到将照片添加到各自的地点。我还为我用来上传的表单包含了我的 html，如果有什么问题，请看看让我知道。谢谢！

JSON响应：

```
{"meta":{"code":200},"notifications":[{"type":"notificationTray","item":{"unreadCount":0}}],"response":{"photo":{"id":"502ab14fe4b0ed9600d7722d","createdAt":1344975183,"prefix":"https:\/\/irs3.4sqi.net\/img\/general\/","suffix":"\/atVMrQ02CcgHIamCVmTugx4MCX4hIEVv1lLqbo24cnA.jpg","width":700,"height":525}}} 
```

表单 HTML：

```
<form action="https://api.foursquare.com/v2/photos/add" method="post" enctype="multipart/form-data" v="20120809" >
<p>Venue ID: <input type="text" name="venueId"></p>
<p><input  type="file" name="photo"></p>
<input type="hidden" name="oauth_token" value="MY OAUTH TOKEN">
<input type="submit">
</form> 
```

# javascript - 添加限制以使用箭头键移动 div

> ID：11970074
> 
> 赞同：1
> 
> 时间：2012-08-15T13:23:22.917
> 
> 标签：javascript

嗨，我已经添加了功能（在 stackoverflow 上找到），一旦用户按住其中一个箭头键，我的 div 就会向左或向右移动。一切正常。

我想知道有没有办法阻止 div 在到达“结束”或移动一定数量的像素后停止移动。

我的代码如下

```
$(document).keydown(function(e) {
switch (e.which) {
case 37:
    $('#block').stop().animate({
        left: '-=50'
    }); //left arrow key
    break;

case 39:
    $('#block').stop().animate({
        left: '+=50'
    }); //right arrow key
    break;

}
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:41:05.937

当然，看看这个小提琴：http: [//jsfiddle.net/ArtBIT/V7qcK/](http://jsfiddle.net/ArtBIT/V7qcK/)

```
var KEY = {
    LEFT: 37,
    RIGHT: 39
}
var boundaries = {
    left: 0,
    right: 200
}
$(document).keydown(function(e) {
    var position = $('#block').position();

    switch (e.which) {
    case KEY.LEFT:

        $('#block').stop().animate({
            left: Math.max(boundaries.left, position.left - 50)
        }); 
        break;

    case KEY.RIGHT:
        $('#block').stop().animate({
            left: Math.min(boundaries.right, position.left + 50)
        });
        break;
    }
});​ 
```

或者这个[http://jsfiddle.net/ArtBIT/8PWCR/1/](http://jsfiddle.net/ArtBIT/8PWCR/1/)用于 2D 运动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:34:40.750

获取电流`offset`然后处理它：

```
var max = 1000;

$(document).keydown(function(e) {
    switch (e.which) {

        case 37:
            if($('#block').offset().left > 50)
            {
                $('#block').stop().animate({ left: '-=50' });
            }
            break;

        case 39:
            if($('#block').offset().left < (max - 50)
            {
                $('#block').stop().animate({ left: '+=50' });
            }
            break;

    }
}); 
```

# javascript - 当您有自定义命名空间时，IE9 将 svg 附加到 DOM

> ID：11970075
> 
> 赞同：2
> 
> 时间：2012-08-15T13:23:26.357
> 
> 标签：javascript, jquery, html, svg, internet-explorer-9

我有这个问题，我被困了好几天了。我正在尝试将 svg 附加到 DOM。我在其中有自定义命名空间，当它们被添加到 DOM 中并且您尝试获取附加它们的父元素的 innerHTML 属性时，您会使用一些随机命名空间来获取它们。这仅在 IE9 中发生。

例子：

```
$(document).ready(function () {
 var svg = '<svg xmlns="http://www.w3.org/2000/svg" ns:attr="val" />';
 alert($("div").append(svg).html());
}); 
```

输出将是：

```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:NS1="" NS1:a:b="val" /> 
```

知道如何解决吗？我试图定义命名空间，但它不再工作了。这是一个 jsfiddle 链接[http://jsfiddle.net/RwNqk/3/](http://jsfiddle.net/RwNqk/3/)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:42:19.663

首先，您的 JSFiddle 中有一个 HTML 文档，而不是 XHTML。HTML 没有自定义命名空间，只有 XML/XHTML 有。

其次，您使用的是`ns`命名空间前缀，而没有定义该命名空间是什么。其他浏览器完全可以工作真是一个奇迹。

第三，即使你解决了这些问题，你（很遗憾）[也不能使用 jQuery 使用先前定义的命名空间前缀将元素塞入 DOM](https://stackoverflow.com/questions/11972852/add-xhtml-element-referencing-existing-namespace)：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:foo="hello"><head>
  <title>Using jQuery to add namespaced attribute</title>
</head><body>
  <div><p foo:bar="yes">one</p></div>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript"><![CDATA[
    var xhtml = '<p foo:bar="no">two</p>';
    alert($('div').html());
    try{ $('div').append(xhtml); }
    catch(e){ alert(e);          }
  ]]></script>
</body></html> 
```

第一个警报显示自定义命名空间有效：
`<p xmlns="http://www.w3.org/1999/xhtml" foo:bar="yes" xmlns:foo="hello">one</p>`

第二个警报显示失败：

```
[Firefox] "An invalid or illegal string was specified"  code: "12"
[Chrome]  Error: SYNTAX_ERR: DOM Exception 12
[IE9]     DOM EXception: SYNTAX_ERR (12) 
```

这与 IE9 或 SVG 无关。它主要与jQuery有关。（您可以`.innerHTML`在 IE9 和 FF 中设置 DOM 元素，它会按需要工作，但不能在 Chrome 中使用。）

# nuget - 在 Webmatrix 2 RC 中安装 Entity Framewok v5

> ID：11970076
> 
> 赞同：0
> 
> 时间：2012-08-15T13:23:28.550
> 
> 标签：nuget, webmatrix

我正在使用 Webmatrix 2 RC 中的 Entity Framework 进行项目，因此我需要使用 Entity Framework v.5 RC，因为以前版本和 .NET Framework 4.5 之间存在冲突。

我知道在 Webmatrix 中安装 NuGet 包的两种方法是来自 Webmatrix 功能区上的 NuGet 库和来自 ASP.NET 网页管理中的包管理器：任何一种解决方案都只建议实体框架 v4.3.1。

我已经使用 Visual Web Developer 的包管理器控制台下载了 Entity Framework v.5 RC，并将 EntityFramework.dll 复制到我项目的 bin 文件夹中。

此解决方案有效，但我想知道是否存在一种方法来安装不需要使用 Visual Web Developer 的不推荐的 NuGet 包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:21:49.873

您可以使用[nuget.exe](http://nuget.codeplex.com/releases/view/58939)或[NuGet Package Explorer](http://npe.codeplex.com/)，它们都是独立且轻量级的。不过，您仍然必须手动添加对文件的引用。

# variables - 如何使用 CMD 从列表或变量中重新打开程序

> ID：11970078
> 
> 赞同：0
> 
> 时间：2012-08-15T13:23:34.767
> 
> 标签：variables, batch-file, cmd

我有一段代码；

```
:check
for /f "tokens=1* delims==" %%A in ('"wmic process get description, commandline /format:list"') do (
  if "%%A"=="CommandLine" (
    set "cmd=%%B"
  ) else if "%%A"=="Description" (
    set "desc=%%B"
    setlocal enableDelayedExpansion
    set "desc=!desc:~0,-1!"
    set "cmd=!cmd:~0,-1!"
    if /i !desc! == %1         (
      echo !cmd! >>C:\test.txt
    )
    endlocal
  )
)
goto:eof 
```

这非常有效（这实际上是一个从批处理文件调用的函数，例如

```
call:check processname1.exe
call:check processname2.exe
call:check processname3.exe
etc... 
```

我想做的（如果可能的话）是，除了回显到文件之外，我希望能够创建 2 个变量。就像是;

```
processname1.exe processname3.exe   <-- (for each process 'checked' if it IS running, append its name to this variable)
commandlinepath1 commandlinepath2   <-- (for each process 'checked' if it IS running, append its path to this variable) 
```

如果这是可能的，然后我可以稍后在我的脚本中调用这些变量，我希望能够 tskill 正在运行的进程（如果可以制作上面的变量就足够简单了），然后再重新打开这些进程（使用原始路径中的命令行参数。这就是我迷路的地方。

我上面的代码（写入文件）。会给出类似的结果；

```
"C:\somefolder\someexe.exe" -some_parameter
"C:\some therfolder\someotherexe.exe"
"C:\another older\anotherexe.exe" param1 param2 
```

但是我需要做的是获取该文件的每一行（或变量，如果可能的话），然后运行它们（如果我将每一行复制到 windows 的 RUN 命令中，它可以工作，但通过 CMD 执行它不会） .

我尝试使用 for 循环打开文件，它确实如此，除了脚本等待进程完成之前继续（并且这些进程不会结束，因为它们是应用程序）。如果我尝试使用 START .. 那么它会加载一个新的 CMD 窗口？？

我需要做的（如果有更好的选择）是

*   对于一组预先确定的进程，检查它们是否正在运行
*   杀死那些（如果不是，忽略它）
*   删除一些文件（我可以这样做，杀死进程的原因是它们保持文件打开，防止删除）
*   重新打开所有最初运行的程序

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:52:03.320

不是直接的答案，但既然您已经使用 wmic，也许使用它的内置功能（查询、启动和停止）会使您的目标更容易实现？

我想出了以下内容：

```
@echo off
setlocal
for %%C in (notepad.exe) do (
    for /f "skip=1 tokens=2 delims==" %%F in ('wmic process where description^="%%C" get commandline /format:list') do (
    REM required to normalize unicode output from WMIC 
    set commandline=%%F
    REM '\=\\' required as wmic treats \ as escape char in query
    call wmic process where commandline='%%commandline:\=\\%%' terminate

    REM do your work here

    call wmic process call create '%%commandline%%'

    )
) 
```

它的作用：首先`for`提供进程名称。在我的示例中，它只是`notepad.exe`，但您可以使用 list: 调用`for (process1 process2 process3)`，或将其替换为`for /f`以提供来自文件的值。如果要使用带引号的名称，则必须从下一行 ( `description^="%%C"`) 中删除引号。
第二个`for`真正的工作：它获取与描述匹配的所有进程的列表，并依次停止和启动它们中的每一个。

要尝试它，只需将其放入 中`batfile.bat`，打开记事本并执行。
注意：如果你用一个文件打开记事本，要么指定一个绝对路径，要么通过资源管理器（双击）。这里的问题是当前目录 - 如果您的任何进程确实引用了相对路径，您也可能会偶然发现（不太可能，但并非不可能）

**最后但并非最不重要**的一点 - 在 powershell 中执行此操作将是最简单、最短和最可靠的。

# php - 与 iCloud 的联系人和提醒的网站同步

> ID：11970079
> 
> 赞同：4
> 
> 时间：2012-08-15T13:23:36.320
> 
> 标签：php, python, api, sync, icloud

我正在构建基于 Web 的自定义 CRM 系统，并已将联系人和提醒与 Google 应用程序同步，并且需要对 Apple iCloud 进行相同的操作。有什么办法吗？我还没有找到任何用于此目的的官方 API，CRM 是用 PHP 编写的，但我也可以为此目的使用 python。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:43:36.520

据我所知，无法直接与 iCloud 交互；它只能通过 iOS 或 Mac OS 应用程序，并通过使用 UI/NSDocument 类调用正确的 iCloud Objective-C API 来完成。由于您没有使用 Cocoa，更不用说 Objective-C，您很可能无法做到这一点。当然，我可能错了，因为我没有对此进行深入搜索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T01:56:10.507

我建议您使用 google 联系人 api 进行同步。然后，您可以告诉 iPhone 用户使用它而不是 iCloud。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-16T12:11:22.120

我同意第一个和第二个答案，因为我也没有找到任何解决方案来通过 PHP 访问大部分 iCloud 数据。似乎最好的解决方案是制作一个移动应用程序来完成大部分工作。这实际上可以节省大量时间。

但是，如果您可以让您的用户安装应用程序，那么请制作您自己的云。有一个开源软件，例如：下面的自己的云链接，非常擅长。

[https://owncloud.org/](https://owncloud.org/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-08-27T18:27:59.763

您可能想看看这个项目：[https](https://github.com/adammck/ruby-icloud) ://github.com/adammck/ruby-icloud 。它使用 Ruby 访问 iCloud 提醒。

# http - 是否可以将本地子域映射到另一个站点的子文件夹？

> ID：11970081
> 
> 赞同：0
> 
> 时间：2012-08-15T13:23:40.633
> 
> 标签：http, redirect, webserver, subdomain

我正在*www.my-domain.com*开发一个多语言电子商务网站。我的页面需要两种语言标记 - 一种用于网站界面 - 一种用于正在查看的产品。这有助于客户浏览外国产品，同时可以使用他们自己的语言访问菜单等。我使用子域来标记网站界面和目录来标记产品语言：*www.fr.my-domain.com/product-id/zht*。

我在*www.cloud-domain.com*有一个云文件存储桶。我正在使用云服务器为我的网站托管产品图片（250,000 JPGs @ 25GB）。图像分为支持的每种语言的文件夹：*www.cloud-domain.com/de/*；*www.cloud-domain.com/fr/*；*www.cloud-domain.com/it/*。

本着对每种语言的产品图像进行同子域 SEO 的精神，我想**透明地**映射目录，如下所示：

```
www.fr.my-domain.com/img/ to www.cloud-domain.com/fr/
www.de.my-domain.com/img/ to www.cloud-domain.com/de/
www.it.my-domain.com/img/ to www.cloud-domain.com/it/ 
```

如果不访问*www.cloud-domain.com*服务器配置，这可能吗？实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T12:56:40.963

如果您可以访问 www.fr.my-domain.com/img，这很容易。

有一个http状态码301（永久移动）。您在 www.fr.my-domain.com 上配置您的 apache（或 nginx），让它响应对 www.fr.my-domain.com/img 的每个请求，并使用指向 www.cloud-domain.com/ 的 301 响应FR/

我不清楚确切的语法，但你可以通过谷歌搜索找到

# sql - 批量插入问题

> ID：11970084
> 
> 赞同：1
> 
> 时间：2012-08-15T13:24:06.997
> 
> 标签：sql, sql-server, bulkinsert

在从 csv 文件批量插入期间，文件中的一行具有`00000100008`值，源（从中创建 csv 文件）和目标*`temptable`*都具有相同的字段（char（11））。

当我尝试插入时，出现以下错误：

```
Bulk load data conversion error (truncation) for row 1, column 1 (fieldname) 
```

如果我删除前导 0 并将此值更改为`100008`csv 文件中的值，然后进行批量插入，则目标表*`temptable`*显示`'++ 100008`为插入值。这是为什么？我如何在不带双加号的情况下处理价值？

这是脚本：

```
BULK
INSERT temptable
FROM 'c:\TestFile.csv'
WITH
(
    FIELDTERMINATOR = ',',
    ROWTERMINATOR = '\n'
)
GO 
```

**编辑：**来自 csv 文件的一些示例记录。

```
100008,111122223333,Mr,ForeName1,SurName1,1 Test Lane,London,NULL,NULL,NULL,wd25 123,test@email.com.com,NULL
322,910315715845,Ms,G,Dally,17 Elsie Street,NULL,NULL,GOOLE,NULL,DN146DU,test1@email1.com,
323,910517288401,Mrs,G,Tom,2 White Mead,NULL,NULL,YEOVIL,NULL,BA213RS,test3@tmail2.com, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:40:42.717

我的第一个想法是该文件保存在 Unix 系统上，并且您可能与不同样式的换行符不兼容。我的第一个建议是使用十六进制编辑器分析文本文件，以确定放在那里的字符。

++ 100008 基本上意味着 - 行格式与页眉不一致。解决这个问题 运行 dbcc checktable。

我希望这会对你有所帮助。

问候，

# c++ - 为什么要让我的应用程序存储引用而不是请求它两次这么慢？

> ID：11970087
> 
> 赞同：1
> 
> 时间：2012-08-15T13:24:29.803
> 
> 标签：c++

一个对象`memory`有一个带有签名的方法

```
BinaryPattern const& getPattern(unsigned int index) const; 
```

我在以下 for 循环中使用它：

```
for (unsigned int k = 0; k < memory->size(); k++) {
    const BinaryPattern s = memory->getPattern(k);
    w += s.at(i) * s.at(j);
} 
```

这是非常缓慢的。令人惊讶的是，我发现以下内容要快得多：

```
for (unsigned int k = 0; k < memory->size(); k++) {
    w += memory->getPattern(k).at(i) * memory->getPattern(k).at(j);
} 
```

“getPattern()”不做任何计算，它几乎只是返回存储在向量中的模式。

为什么当我将引用存储在变量中时速度会慢得多？我最初这样做是为了加快速度，因为我预计两次检索引用会更慢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T13:27:03.220

这是因为

```
const BinaryPattern s = memory->getPattern(k); 
```

通过调用对象的复制构造函数来制作对象的副本。由于您不想更改它，请改为存储参考：

```
const BinaryPattern& s = memory->getPattern(k);
//                 ^
//                 note this 
```

（由于使用`const`引用捕获右值会延长右值的生命周期，直到引用终止，所以如果更改签名`getPattern()`以返回副本而不是引用，这甚至可以工作。）

* * *

在优化的构建中（您没有比较调试构建，是吗？），编译器可能能够确定对函数的两次调用

```
memory->getPattern(k).at(i) * memory->getPattern(k).at(j) 
```

没有任何副作用，因此保留了对第一次调用获得的对象的引用并优化了第二次调用——到达我上面提出的代码。

显然，复制一个`BinaryPattern`对象的成本是不可忽视的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T13:27:21.837

因为您在这里创建副本

```
const BinaryPattern s = memory->getPattern(k); 
```

只需更改为

```
const BinaryPattern &s = memory->getPattern(k); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-15T13:27:25.580

在行

```
const BinaryPattern s = memory->getPattern(k); 
```

创建一个新实例，`BinaryPattern`并将返回值`getPattern`复制到其中。

你可能是说

```
const BinaryPattern& s = memory->getPattern(k); 
```

# android - 片段中的加载程序生命周期

> ID：11970088
> 
> 赞同：2
> 
> 时间：2012-08-15T13:24:33.480
> 
> 标签：android

当一个片段通过它的生命周期时，它如何影响加载器以及活动的生命周期如何影响加载器？

何时在片段和活动生命周期上下文中调用加载程序的 onAbandon()

# java - 仅当参数不为空时，休眠添加限制（等于）

> ID：11970089
> 
> 赞同：6
> 
> 时间：2012-08-15T13:24:41.427
> 
> 标签：java, hibernate

如何检查参数是否为空？根据我要添加或不添加限制的结果

如果 person.getLastName() == null 我不想添加相关限制，我该怎么做？

```
 persons = session.createCriteria(PersonEntity.class).add(
                Restrictions.eq("LastName", person.getLastName())).add(
                Restrictions.eq("FirstName", person.getFirstName())).add(
                Restrictions.eq("email", person.getUser().getEmail()))
                .list(); 
```

谢谢，塔尼亚

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-16T07:58:22.307

如果在一个方法中，你可以用一个正常的方法来做：

```
private void addRestrictionIfNotNull(Criteria criteria, String propertyName, Object value) {
    if (value != null) {
        criteria.add(Restrictions.eq(propertyName, value));
    }
} 
```

然后使用它：

```
Criteria criteria = session.createCriteria(PersonEntity.class);
addRestrictionIfNotNull(critera, "LastName", person.getLastName());
addRestrictionIfNotNull(critera, "FirstName", person.getFirstName());
addRestrictionIfNotNull(critera, "email", person.getEmail());

persons = criteria.list(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T13:52:00.657

您可以使用这样复杂的限制：

```
Restrictions.or(Restrictions.and(Restrictions.isNotNull("propName"), Restrictions.eq("propName", propValue)), Restrictions.isNull("propName")); 
```

如果我理解你是正确的，它会做你所期望的。

内部限制*Restrictions.eq("propName", propValue)*的结果只有在指定属性不为空时才会影响查询结果。

PS。我知道这似乎太模糊了，但现在我无法想象另一种方法来做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-26T02:38:08.660

如果您的`last_name`列在表中始终**不为空**，您可以尝试以下操作：

```
String lastName = .. ;

.add(Restrictions.sqlRestriction(lastName != null ? "this_.last_name = "+ lastName : "this_.last_name is not null ")) 
```

这`last_name`将是您的表列名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-06T10:36:26.297

所以，你可以这样做，

```
session = sessionFactory.getCurrentSession();
Criteria crit = session.createCriteria(PersonEntity.class).add(
                Restrictions.eq("FirstName", person.getFirstName())).add(
                Restrictions.eq("email", person.getUser().getEmail()));
if(person.getLastName()!=null){
crit.add(Restrictions.eq("LastName", person.getLastName()));
}
person=(PersonVO)crit.list(); 
```

# multithreading - 在非 UI 线程上运行 RIA 服务

> ID：11970092
> 
> 赞同：4
> 
> 时间：2012-08-15T13:24:58.607
> 
> 标签：multithreading, silverlight, backgroundworker, wcf-ria-services

我正在尝试从非 UI 线程进行 RIA 服务调用。
我通过打开新线程和后台工作人员进行了调用，但是对于这两种情况，回调都在 UI 线程上运行。
是否可以在调用者线程而不是 UI 上执行回调？
谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T17:47:43.827

**tl;博士**

*   使用 WCF
*   自己将结果编组到 UI 线程

**WCF RIA 是为在 UI 线程上工作而构建的**

WCF RIA 被设计为主要在 UI 线程上工作。这显然有很多优点和缺点。在你的情况下主要是缺点。我很难找到这个设计的权威文档，但是，关于这个主题的大多数问题都是通过确认 UI 线程来回答的。

*   [这是](http://forums.silverlight.net/post/522746.aspx)来自 WCF RIA QA 团队成员的帖子，指出仅 UI 线程处理。
*   Andy French[描述了编组到 UI 线程的回调](http://www.andyfrench.info/2010/06/wcf-ria-services-basics.html)：

> Domain Context Load 和 SubmitChanges 异步执行。它们从线程池中获取一个线程，对服务器进行必要的调用，当这些调用完成时，工作会自动编组回 UI 线程以修改实体集合并随后更新 UI（可能通过 INotificationChanged）。

如果您使用 WCF 获取您自己的数据，您可以在任何您喜欢的线程上进行操作。调用完成后，您将不得不编写（或借用）代码来更新 UI 线程上的 UI 以避免[跨线程异常](https://stackoverflow.com/q/3420282/117625)。

IMO，WCF RIA 的主要优点给简单的问题简单的解决方案：

*   用于在服务器和客户端之间重用代码的出色工具
*   服务和客户端代码始终兼容
*   向/从客户端/服务器传输数据相对简单
*   WCF RIA 强烈主张导致易于学习的编码模式

缺点使难题变得困难或不可能：

*   WCF RIA 有[强烈的固执己见](https://stackoverflow.com/questions/11144985/how-to-make-synchronous-ria-request/11177816#11177816)，不遵循这种意见是痛苦的或不可能的
*   所有操作都在 UI 线程上返回，通常会导致性能问题
*   有一些巫术可以实现最高数量的客户端+服务器代码重用

# c++ - FastCV 腐蚀/膨胀参数

> ID：11970093
> 
> 赞同：2
> 
> 时间：2012-08-15T13:25:03.407
> 
> 标签：c++, image-processing, opencv, android-ndk

我在安卓设备上同时使用 OpenCV 和 FastCV 来执行一些图像处理操作。在对帧进行阈值处理后，我得到了一张二值图像，在感兴趣区域附近存在适量的黑白噪声。

执行腐蚀，然后对图像进行膨胀，可以为我提供一个几乎无噪声的图像，可用于进一步处理，但是上述两个库都有其缺点。

**开放式CV**

```
Mat element = getStructuringElement(MORPH_RECT, Size(2 * erosionSize + 1, 2 * erosionSize + 1), Point(erosionSize, erosionSize));
erode(in, in, element);
element.release(); 
```

原谅我的神奇数字，但我对 OpenCV 侵蚀/扩张的简单调用看起来像上面那样。然后我可以修改它的erosionSize/dilationSize 参数，以调整该函数在消除噪音方面的积极程度。问题？性能是这里的重中之重，这个函数的运行速度比我想要的要慢。

**快速简历**

```
fcvFilterErode3x3u8_v2 (const uint8_t *__restrict src, unsigned int srcWidth, unsigned int srcHeight, unsigned int srcStride, uint8_t *__restrict dst, unsigned int dstStride) 
```

上面的 prototpye 是针对 FastCV 的 erode 实现的，这里没有参数来调整腐蚀的大小。鉴于 FastCV 已针对移动架构进行了优化，并且我怀疑它实际上利用了我用于测试的 Galaxy Nexus 中的 GPU，因此此功能比上述功能要快得多。但是，我需要在同一帧上多次循环和运行它以达到相同的侵蚀水平，从而牺牲了过程中的任何性能优势。

有没有人知道：

*   我可能在任一 API 中遗漏的任何方法都将快速执行并使用可调大小参数**或**
*   包含符合这两个要求并具有相当宽松许可证的功能的任何其他库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T08:11:59.707

如果您的意图是连续系统地执行这两种操作（腐蚀和膨胀），并且如果您可以对两者使用相同的参数大小，那么您可能想尝试使用 opencv 的专用函数应用一个开口：

[http://docs.opencv.org/doc/tutorials/imgproc/opening_closing_hats/opening_closing_hats.html](http://docs.opencv.org/doc/tutorials/imgproc/opening_closing_hats/opening_closing_hats.html)

从数学上讲，这相当于先执行腐蚀然后再膨胀，但是有优化的开环实现可以比连续应用这两个操作更快。

免责声明：我还没有检查 opencv 对这些操作的实现，但你会想试一试——当然，如果你还没有做过。

# javascript - Javascript - 显示 18 张图片然后停止

> ID：11970098
> 
> 赞同：1
> 
> 时间：2012-08-15T13:25:25.810
> 
> 标签：javascript, loops, background

我想要做的是改变背景图像 17 次，然后停止。当用户打开一个新页面时，应该会发生同样的事情，加载 17 张图像并停止。问题是，我对 javascipt 了解不多（我保证会学习。）我找到了一个脚本，它可以工作，但我猜我必须添加一个中断。我试过但没有成功。这是代码：

```
var imgArr = new Array(
    // relative paths of images
    'images/bgshow/1.jpg',
    'images/bgshow/2.jpg',
    'images/bgshow/3.jpg',
    'images/bgshow/4.jpg',
    'images/bgshow/5.jpg',
    'images/bgshow/6.jpg',
    'images/bgshow/7.jpg',
    'images/bgshow/8.jpg',
    'images/bgshow/9.jpg',
    'images/bgshow/10.jpg',
    'images/bgshow/11.jpg',
    'images/bgshow/12.jpg',
    'images/bgshow/13.jpg',
    'images/bgshow/14.jpg',
    'images/bgshow/15.jpg',
    'images/bgshow/16.jpg',
    'images/bgshow/17.jpg'
);

var preloadArr = new Array();
var i;

/* preload images */
for(i=0; i < imgArr.length; i++) {
    preloadArr[i] = new Image();
    preloadArr[i].src = imgArr[i];
}

var currImg = 1;
var intID = setInterval(changeImg, 150);

/* image rotator */
function changeImg() {
    $('#page-wrap').animate({opacity: 0}, 0, function() {
        $(this).css('background','url(' + preloadArr[currImg++%preloadArr.length].src +') top center no-repeat');
    }).animate({opacity: 1}, 0);
} 
```

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:27:18.593

`150ms`由于`setInterval(changeImg, 150)`调用，该脚本将不断更改图像。因此，要停止它，您需要在更改完所有图像后清除间隔。这可以在`changeImg`函数末尾完成，添加以下内容；

```
function changeImg() {
  // animation code...
  if (currImg == preloadArr.length) {
    clearInterval(intID);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:23:18.543

if ( `currImg == preloadArr.length`) 并不`clearInterval(intID);`总是运行`currImg == 0;`

实际上; `currImg++`添加之前或“ `if (currImg++ == preloadArr.length)`”

```
function changeImg() {
    // animation code...
    if (currImg++ == preloadArr.length) {
        clearInterval(intID);
    }
} 
```

# extjs - 模型中的唯一字段

> ID：11970100
> 
> 赞同：0
> 
> 时间：2012-08-15T13:25:34.023
> 
> 标签：extjs, sencha-touch-2

我正在寻找一种解决方案，将其中一个数据字段作为 sencha 模型中的唯一字段，不知何故我无法找到它的文档。这是代码

```
Ext.define('handfree.model.CategoryM', {
    extend: 'Ext.data.Model',
    requires: [
        'Ext.data.identifier.Uuid'
    ],
    config: {
        fields: [
            { name: 'id', type: 'int' },
            { name: 'name',     type: 'string' }
        ],
        idProperty: 'id',
        identifier : 'uuid'
    }
}); 
```

我需要“名称”字段是唯一的。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:43:19.883

假设您手动将记录弹出到存储中，您可以在存储中放置一个侦听器，并在添加记录时取消设置。

[http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Store-event-addrecords](http://docs.sencha.com/touch/2-0/#!/api/Ext.data.Store-event-addrecords)

# javascript - 如何在 htmltextbox 中为 textchanged 事件调用 javascript？

> ID：11970116
> 
> 赞同：3
> 
> 时间：2012-08-15T13:26:53.333
> 
> 标签：javascript, html

我有两个只读的html 文本框（`txtFrom`和）。`txtTo`这两个文本框用于显示来自 datepicker 的日期。

我的场景是当`txtTo`文本框充满日期时，我想调用一个 javascript 减去两个日期 ( `txtTo`- `txtFrom`) 并将结果输入另一个名为`txtDays`.

我怎样才能做到这一点？由于文本框是只读的，我无法调用`onkeypress`或事件。`onkeyup`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:28:33.493

您可以使用 javascript 的 onchange 事件。

**在 html 部分**

```
<asp:TextBox ID="txtTo" runat="server" onchange="DateComparisionJavascriptFun();"></asp:TextBox> 
```

**在 Javascript 块中**

```
<script type="text/javascript">
function DateComparisionJavascriptFun()
{
   alert("Validate dates here.");
}    
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T13:34:02.143

onchange 事件仅在文本字段失去焦点时触发，因此这可能对您不起作用。

如果您以编程方式更改日期字段的文本，那么您可能应该同时更改其他字段。

如果您要在多个地方执行此类操作，我强烈建议您使用[Knockout JS](http://knockoutjs.com/)之类的数据绑定框架，并使用带有计算属性的 ViewModel。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T13:41:31.363

你应该在那个日期选择器上有回调函数，当用户选择一个日期时它可以调用这个函数

不知道它是你的还是第三方的日期选择器，但是当用户选择一个日期并将其写入文本输入时，他应该定义回调，你应该能够在这个地方添加你的函数

# sharepoint - 按今年更新的项目过滤 cqwp

> ID：11970118
> 
> 赞同：0
> 
> 时间：2012-08-15T13:27:07.290
> 
> 标签：sharepoint, sharepoint-2010, cqwp

我只想显示“修改”字段在今年的项目。

过滤器字段允许我插入 - 或今天，或特定日期，或今天之前\之后的固定天数，但从今年年初开始的天数每天都在变化......

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T13:57:10.740

我看到没有人回答这个问题，

所以我会写我最后做了什么，也许它会对某人有所帮助。

我创建了一个计算列，如果该字段的值`Modified`在今年，则返回值“X”（在计算列公式中，我可以进行我想要的检查），如果不是，则返回值“Y”，

在 CQWP - 我按此列过滤。

# java - 让 XmlJavaTypeAdapter 和接口很好地发挥作用

> ID：11970119
> 
> 赞同：3
> 
> 时间：2012-08-15T13:27:14.737
> 
> 标签：java, jaxb

我有一个父子关系，其中子类：`Foo`是不可变的，并且没有定义默认的无参数构造函数。父类：`Bar`通过接口引用子类：`IFoo`。我已经定义了一个适配器来解决构造函数问题，但现在遇到了另一个问题，JAXB 抱怨此上下文不知道类 Foo。

如果我尝试通过引导我`JAXBContext`的 with来解决这个问题，`Foo.class`那么我会收到缺少默认构造函数的错误。

请注意，我正在尝试遵循[Unofficial JAXB Guide 3.2.1 中](http://jaxb.java.net/guide/Mapping_interfaces.html)描述的接口映射方法。

我需要采取不同的接口映射方法来解决这个问题吗？我怀疑使用标记每个接口实现`XmlRootElement`意味着我的适配器代码没有运行（如 Blaise Doughan 所述[）](https://stackoverflow.com/questions/11966714/xmljavatypeadapter-not-being-detected/11967459#11967459)。这让我想知道这两种方法是否本质上是不兼容的，并且我需要使用所描述的其他接口映射技术之一。

```
public interface IFoo {
  String getName();
  int getAge();
}

@XmlJavaTypeAdapter(FooAdapter.class)
@XmlRootElement
public class Foo implements IFoo {
  private final String name;
  private final int age;

  public Foo(String name, int age) {
    this.name = name;
    this.age = age;
  }

  public String getName() { return name; }
  public int getAge() { return age; }
}

public class FooAdapter extends XmlAdapter<AdaptedFoo, Foo> {
  @Override
  public Foo unmarshal(AdaptedFoo af) throws Exception {
    return new Foo(af.getName(), af.getAge());
  }

  @Override
  public AdaptedFoo marshal(Foo foo) throws Exception {
    AdaptedFoo ret = new AdaptedFoo();
    ret.setName(foo.getName());
    ret.setAge(foo.getAge());
    return ret;
  }
}

public class AdaptedFoo {
  private String name;
  private int age;

  public AdaptedFoo() {}

  @XmlAttribute
  public String getName() { return name; }
  public void setName(String name) { this.name = name; }

  @XmlAttribute
  public int getAge() { return age; }
  public void setAge(int age) { this.age = age; }
}

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Bar {
  @XmlAnyElement
  private IFoo foo;
  private int baz;

  public Bar() {}

  public IFoo getFoo() { return foo; }
  public void setFoo(IFoo foo) { this.foo = foo; }

  public int getBaz() { return baz; }
  public void setBaz(int baz) { this.baz = baz; }
}

public class Marshal {
  public static void main(String[] args) {
    Foo foo = new Foo("Adam", 34);
    Bar bar = new Bar();
    bar.setFoo(foo);
    bar.setBaz(10);

    try {
      JAXBContext jaxbContext = JAXBContext.newInstance(Bar.class, AdaptedFoo.class);
      Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

      // output pretty printed
      jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

      jaxbMarshaller.marshal(bar, System.out);
    } catch (JAXBException e) {
      e.printStackTrace();
    }
  }
} 
```

**堆栈跟踪**

```
$ java Marshal
javax.xml.bind.MarshalException
 - with linked exception:
[com.sun.istack.internal.SAXException2: class Foo nor any of its super class is known to this context.
javax.xml.bind.JAXBException: class Foo nor any of its super class is known to this context.]
        at com.sun.xml.internal.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:311)
        at com.sun.xml.internal.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:236)
        at javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:95)
        at Marshal.main(Marshal.java:20)
Caused by: com.sun.istack.internal.SAXException2: class Foo nor any of its super class is known to this context.
javax.xml.bind.JAXBException: class Foo nor any of its super class is known to this context.
        at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.reportError(XMLSerializer.java:235)
        at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.reportError(XMLSerializer.java:250)
        at com.sun.xml.internal.bind.v2.runtime.property.SingleReferenceNodeProperty.serializeBody(SingleReferenceNodePr
operty.java:102)
        at com.sun.xml.internal.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:341)
        at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.childAsSoleContent(XMLSerializer.java:582)
        at com.sun.xml.internal.bind.v2.runtime.ClassBeanInfoImpl.serializeRoot(ClassBeanInfoImpl.java:323)
        at com.sun.xml.internal.bind.v2.runtime.XMLSerializer.childAsRoot(XMLSerializer.java:483)
        at com.sun.xml.internal.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:308)
        ... 3 more
Caused by: javax.xml.bind.JAXBException: class Foo nor any of its super class is known to this context.
        at com.sun.xml.internal.bind.v2.runtime.JAXBContextImpl.getBeanInfo(JAXBContextImpl.java:573)
        at com.sun.xml.internal.bind.v2.runtime.property.SingleReferenceNodeProperty.serializeBody(SingleReferenceNodePr
operty.java:94)
        ... 8 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:18:01.370

如果您`@XmlElement`在属性上使用和注释`foo`并指定实现类型，那么您的用例应该可以工作。

```
 @XmlElement(type=Foo.class)
  private IFoo foo; 
```

**酒吧**

以下是您的`Bar`课程的更新版本

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Bar {
  @XmlElement(type=Foo.class)
  private IFoo foo;
  private int baz;

  public Bar() {}

  public IFoo getFoo() { return foo; }
  public void setFoo(IFoo foo) { this.foo = foo; }

  public int getBaz() { return baz; }
  public void setBaz(int baz) { this.baz = baz; }
} 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2011/05/jaxb-and-interface-fronted-models.html](http://blog.bdoughan.com/2011/05/jaxb-and-interface-fronted-models.html)

# java - JFreeChart - 如何在 StackedBarRenderer 中对多行进行颜色编码？

> ID：11970124
> 
> 赞同：1
> 
> 时间：2012-08-15T13:27:28.147
> 
> 标签：java, graph, jfreechart, graphing

我正在开发一个程序，该程序采用一组双精度并将它们全部显示在水平条形图的一行中。现在它可以工作，除了着色。我有不确定的行数，因此数据被添加到图表中，如下所示：

```
public CategoryDataset createDataset() {
    DefaultCategoryDataset bardataset1 = new DefaultCategoryDataset();
    for (int i = 0; i < nanoArray.length; i++) {
        bardataset1.addValue(nanoArray[i], "Packet" + i, "Class A");
        bardataset1.addValue(startgap, "Packet Gap" + i, "Class A");
    }
} 
```

这可以正确堆叠数据，但是因为大约有 300 个不同的 rowKey，它分配了 300 种不同的颜色。我附上了这张照片，向您展示它的样子：

[http://i.imgur.com/hg33P.png](http://i.imgur.com/hg33P.png)

如您所见，这使数据完全不可读。我想要的是看到红色和蓝色的交替颜色条。

编辑：我找到了答案；我使用了jcern的方法。我还编写了一个`for`循环，它遍历我的双精度数组的长度，并根据它是偶数还是奇数来分配颜色。

```
for (int i = 0; i < packetCount; i++) {
        setSeriesToolTipGenerator(i, new StandardCategoryToolTipGenerator());
        if (i % 2 == 0) {
            setSeriesPaint(i, new Color(255, 0, 0));
        } else {
            setSeriesPaint(i, new Color(0, 0, 0));
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:39:49.397

您需要创建一个新的渲染器并将其指定给绘图。

首先，您将创建一个具有您想要的两种颜色的渲染：

```
CategoryItemRenderer renderer = new StackedBarRenderer {
     private Paint[] colors = new Paint[] {
        new Color(255, 0, 0), 
        new Color(0, 0, 255)
     }

     public Paint getSeriesPaint(int series) {
       return colors[(series % 2)];
     }
}; 
```

然后，抓取绘图并指定要使用的渲染：

```
if(chart.getPlot() instanceof CategoryPlot){
  chart.getCategoryPlot().setRenderer(renderer);
} 
```

希望这能让你到达你想去的地方。

# c# - MVC delete 删除不相关的数据

> ID：11970125
> 
> 赞同：2
> 
> 时间：2012-08-15T13:27:29.503
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, icollection

我正在尝试删除一些数据（到底有多难？）但是每当我从模型对象中删除复杂类型的道具时，ICollection 道具的内容也会混合在一起。这是代码：

```
 [HttpPost, ActionName("Delete")]
    public ActionResult DeleteConfirmed(string name)
    {
        using (var db = new HoursDb())
        {
            db.Configuration.ProxyCreationEnabled = false;

            var schedule = db.Schedules.Where(s => s.ScheduleId == name)
                .Include(s => s.WeekSpec)
                .Include(s => s.WeekSpec.DaySpecs)
                .Include(s => s.ExceptionHoursSets)
                .Include(s => s.ExceptionHoursSets.Select(e => e.WeekSpec))
                .Include(s => s.ExceptionHoursSets.Select(e => e.WeekSpec.DaySpecs))
                .FirstOrDefault();
            if (schedule == null)
            {
                return View("404");
            }

            var daySpecs = new List<DaySpec>(schedule.WeekSpec.DaySpecs);
            foreach (var daySpec in daySpecs)
            {
                db.DaySpecs.Remove(daySpec);
            }
            db.WeekSpecs.Remove(schedule.WeekSpec);

            var exceptionHoursSets = new List<ExceptionHoursSet>(schedule.ExceptionHoursSets);
            foreach (var exceptionHoursSet in exceptionHoursSets)
            {
                daySpecs = new List<DaySpec>(exceptionHoursSet.WeekSpec.DaySpecs);
                foreach (var daySpec in daySpecs)
                {
                    db.DaySpecs.Remove(daySpec);
                    db.SaveChanges();
                }
                db.WeekSpecs.Remove(exceptionHoursSet.WeekSpec);
                db.SaveChanges();
                db.ExceptionHoursSets.Remove(exceptionHoursSet);
            }

            db.Schedules.Remove(schedule);
            db.SaveChanges();

            return RedirectToAction("Index");
        }
    } 
```

在我下线之前

```
db.WeekSpecs.Remove(schedule.WeekSpec); 
```

ExceptionHoursSets 有，比如说，三个项目。删除 WeekSpec 后，它的值为零。嗯。有任何想法吗？

## 更新

这是 HoursDb 类的代码：

```
using System.Data.Entity;
using LibraryAdmin.Models;
using System.Data.Entity.ModelConfiguration.Conventions;

namespace ####.DAL
{
    public class HoursDb : DbContext
    {
        public DbSet<DaySpec> DaySpecs { get; set; }
        public DbSet<WeekSpec> WeekSpecs { get; set; }
        public DbSet<ExceptionHoursSet> ExceptionHoursSets { get; set; }
        public DbSet<Schedule> Schedules { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
        }
    }
} 
```

此外，如果有帮助，DaySpecs 包含通用建筑物的开放和关闭时间；它们包含在 WeekSpecs 中。
Schedule 包含一个 WeekSpec 来描述一般的营业时间，以及一组 ExceptionHoursSets。
这些有 WeekSpecs 描述上述一般时间的例外情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:42:24.133

我的猜测是，在 WeekSpec 和 ExceptionHoursSet 之间的关系数据库中，您启用了级联删除选项。因此，当您删除 WeekSpec - 您删除了与 ExceptionHoursSet 中相同的 WeekSpec，并且因为您有级联删除 - EF 也会删除 ExceptionHoursSet 对象。

我认为这将是使用 Cascade Delete 选项进行关系而不使用 foreach 删除所有子对象的正确解决方案。当然——只有当你 100% 确定没有 Schedules 就不可能有 WeekSpecs/ExceptionHoursSet/DaySpecs 时，才应该使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:02:15.840

在初始化 var 计划后，将删除 ExceptionHoursSets 的 foreach 移到前面，以及删除除最后一个 db.SaveChanges 之外的所有内容，似乎都有效。不过，我仍然不知道它为什么会发生，而我所拥有的却没有，因此，感谢您提供任何其他信息。

# ruby-on-rails - 独立乘客拒绝访问 /tmp/passenger.1.0.747/generation-0/backends/ruby

> ID：11970127
> 
> 赞同：0
> 
> 时间：2012-08-15T13:27:32.643
> 
> 标签：ruby-on-rails, mongodb, passenger, resque

将在单机上运行的 Rails 服务器迁移到多机配置（VPC Loadbalancer 后面有 2 个乘客，1 个 mongo/redis）。但独立乘客抛出以下错误。任何建议的解决方案

```
[ pid=844 thr=11555480 file=utils.rb:176 time=2012-08-15 13:19:50.538 ]: *** Exception     Errno::EACCES in application (Permission denied - /tmp/passenger.1.0.747/generation-    0/backends/ruby.CmC4pRejK75qNudAHhowIO0Z80iJELkiZcQMxRtxnZCOsxXeVv9Jx0xwt) (process 844,     thread #<Thread:0x0000000160a530>):
from /var/lib/passenger-standalone/3.0.13-x86_64-ruby1.9.2-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_request_handler.rb:392:in `initialize'
from /var/lib/passenger-standalone/3.0.13-x86_64-ruby1.9.2-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_request_handler.rb:392:in `new'
from /var/lib/passenger-standalone/3.0.13-x86_64-ruby1.9.2-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_request_handler.rb:392:in `create_unix_socket_on_filesystem'
from /var/lib/passenger-standalone/3.0.13-x86_64-ruby1.9.2-linux-gcc4.6.3-1002/support/lib/phusion_passenger/abstract_request_handler.rb:174:in `initialize'
from /var/lib/passenger-standalone/3.0.13-x86_64-ruby1.9.2-linux-gcc4.6.3-1002/support/lib/phusion_passenger/rack/request_handler.rb:61:in `initialize' 
```

挖掘后，我的 production.rb 归非 root 'ubuntu' 所有，他对 /tmp/passenger.1.0.747/generation-0/backends/ruby 没有写访问权限。

## 进步了，但仍然不知道如何解决它。

解决方法：所以问题是，capistrano 部署 + 乘客部署作为非 root 导致所有这些文件夹权限问题。必须恢复到根部署才能解决它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:20:10.267

您可能需要更改包含 ruby​​.processd 文件的文件夹的权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T04:34:53.023

问题是通过 capistrano + 独立乘客进行的非 root 部署。解决方法：通过 capistrano 使用根部署，解决了文件夹问题。

# android - 如何基于谷歌的 Launcher2 创建安卓启动器

> ID：11970132
> 
> 赞同：1
> 
> 时间：2012-08-15T13:27:46.913
> 
> 标签：android

我正在尝试开发一个自定义启动器，但基于谷歌的 Launcher2，我有 Launcher2 的源代码，但是当我将它导入到 Eclipse 时，我得到了一堆错误。形成我正在搜索的内容，我认为我需要编译android源并将其添加到eclipse中。我已经按照这个[链接](http://source.android.com/source/initializing.html)编译了源代码，然后是[这个](http://pickerwengs.blogspot.pt/2011/02/android-how-to-develop-android-launcher.html)，但我一无所获。我该怎么做才能完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:48:46.240

Launcher2 应用程序使用 android SDK 中未包含的框架类。因此，您不能简单地复制 Launcher2 应用程序代码并构建它。我花了很多时间尝试手动复制依赖类，但它变得太复杂了。

Launcher2 与操作系统的集成度太高，无法复制。

# objective-c - asiformdatarequest.m 包含错误 asihttprequest

> ID：11970135
> 
> 赞同：0
> 
> 时间：2012-08-15T13:27:54.867
> 
> 标签：objective-c, ios, web-services, asihttprequest, asiformdatarequest

有人可以告诉我如何在 asiformdaterequest.m 类中纠正这些错误吗？谢谢 ！

[![这是其中一张图片，因为即使它们位于此链接中，我也无法为我的声誉上传图片](../Images/532f134e1859b275f0fee3ac1dc8eb4a.png)](https://i.stack.imgur.com/bXw1E.png)

[![这是另一个图像](../Images/7fe7c7d84876d25e42b9f87ae6686e9a.png)](https://i.stack.imgur.com/YCI3T.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:33:37.290

选择您的项目，转到目标，转到构建阶段，转到编译源，选择所有 asi 文件，双击并在框中输入以下内容：-fno-objc-arc。你需要编译那些没有弧的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:52:55.803

请注意[ASIHTTPRequest 不再受支持](http://allseeing-i.com/%5Brequest_release%5D;)

您应该使用以下替代方法：

[MKNetworkKit](https://github.com/MugunthKumar/MKNetworkKit) 或 [AFNetworking](https://github.com/AFNetworking/AFNetworking/)

# python - 用于打开 GTK 窗口/对话框并从中获取一些值的 Python 函数

> ID：11970136
> 
> 赞同：4
> 
> 时间：2012-08-15T13:27:56.783
> 
> 标签：python, gtk, window, pygtk, main

我正在编写一个执行一些图像处理的程序，但需要用户在主要处理发生之前在输入图像上输入一些标记。这是通过 Python/Numpy/Scipy 和 PyGTK 完成的。

作为使这成为可能的一种方法，我尝试了一个打开 GUI 的小脚本，并尝试从其主循环中取回一些值，但它不起作用：

```
import gtk

def getGuiInput(var):
    window = gtk.Window()

    button = gtk.Button('Will <var> be set to 10?')
    window.add(button)

    def submit(widget, event, var):
        var = 10
        gtk.main_quit()

    button.connect('button-press-event', submit, var)

    window.set_position(gtk.WIN_POS_CENTER)
    window.show_all()
    gtk.main()

var = 0
print "before, var is %d" % var
getGuiInput(var)
print "after, var is %d" % var 
```

我非常熟悉创建和布局小部件、连接事件以及使用回调和事件处理程序。

我想知道的是：如何将所有内容放在一个函数中，以便在我的主脚本中调用它以打开一个“输入窗口 GUI”，完成后向调用者返回一个值？如何从 gtk.main() 中获取一些值？

编辑：按照一个答案中给出的建议，我将 Window 小部件换成了 Dialog 小部件，但仍然没有得到我想要的：

```
import gtk

def run(var):

    dialog = gtk.Dialog("Entre em action")
    dialog.response(1)
    button = gtk.Button('Will <var> be set to 10?')
    dialog.add_action_widget(button, 1)
    button.show()

    def submit(widget, event, var):
        print var
        var = 10

    button.connect('button-press-event', submit, var)

    dialog.run()

var = 0
print "before, var is %d" % var

result = run(var)
print result

print "after, var is %d" % var 
```

感谢您的阅读，如果有任何概念上的缺陷，请纠正我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:49:35.033

在一个函数中，您可以将您的窗口创建为一个`gtk.Dialog`并执行此操作`dialog.run()`，这将运行第二个 GTK 主循环，该循环仅限于该对话框。（这意味着当辅助循环运行时，您将无法与程序中的其他窗口进行交互。）

如果您使用响应 ID 向对话框中添加按钮，或`dialog.response()`使用值调用，则该值将是 的*返回*`dialog.run()`值。

```
dialog.add_action_widget(button, 10)
# ...
print 'var is', var
var = dialog.run()
print 'var is now', var  # should be 10 if you clicked the button 
```

# regex - 带方括号的 Git grep 语法

> ID：11970137
> 
> 赞同：1
> 
> 时间：2012-08-15T13:27:57.650
> 
> 标签：regex, git

为什么`git log --grep=\[92\]`将提交与以下消息匹配：

```
Author: Aston, Ben (Foo-UK) <Ben.Aston@foo.co.uk>
Date:   Wed May 23 12:56:23 2012 +0000

[83] Favourites icon addition for release. <BA>

git-tfs-id: [http://fooppp012v:8080/tfs/TFS2010%20Collection]$/Foo/DnR;C210630 
```

看来正确的正则表达式格式不是我想的那样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:44:55.397

一起去`git log --grep=\\[92\\]`。现在你明白了吧？:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T13:53:09.870

以下对我们有用：

```
git log --grep='\[92\]' 
```

# c++ - C++ 模板 - 在元组及其类型的容器上进行模板化

> ID：11970138
> 
> 赞同：1
> 
> 时间：2012-08-15T13:28:02.693
> 
> 标签：c++, templates, stl, containers, tuples

我想在容器上有一个模板和两种元组类型，这样我就可以将以下两个函数合并为一个：

```
template<typename Container>
void vblock(int row, int col, const Container& container) {
  foreach( const typename Container::value_type& item, container ) {
    cell(row, col, item);
    ++row;
  }
}

template<typename container, typename T1, typename T2>
void vblock(int row, int col,
          const std::list<typename boost::tuple<T1, T2> >& container) {
  typedef boost::tuple<T1, T2> Tuple;
  foreach( const Tuple& item, container ) {
    cell(row, col, item.template get<0>());
    cell(row + 1, col, item.template get<1>());
    ++col;
  }
}

template<typename container, typename T1, typename T2>
void vblock(int row, int col,
          const std::set<typename boost::tuple<T1, T2> >& container) {
  typedef boost::tuple<T1, T2> Tuple;
  foreach( const Tuple& item, container ) {
    cell(row, col, item.template get<0>());
    cell(row + 1, col, item.template get<1>());
    ++col;
  }
} 
```

我已经检查了[C++ 模板 - 指定容器类型和它所拥有的容器元素类型](https://stackoverflow.com/questions/3454373/c-templates-specifying-a-container-type-and-that-containers-element-type-tha)以及[使用 STL 容器和 typedef 的 C++ 模板类](https://stackoverflow.com/questions/2240620/c-template-class-using-stl-container-and-a-typedef)，但它们没有回答我的问题。

[适合 STL 容器](https://stackoverflow.com/questions/406903/simple-c-templates-suited-for-stl-containers)的简单 C++ 模板问题与我的问题最相似，但我不知道如何为 boost::tuple 添加模板。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:39:23.983

把事情简单化：

```
template <typename C>
void vblock(int row, int col, C const & container)
{
    typedef typename C::value_type tuple_type;
    typedef typename boost::element<0, tuple_type>::type first_type;
    typedef typename boost::element<1, tuple_type>::type second_type;

    // ...
} 
```

您可以在函数声明中添加一些`enable_if`逻辑，以防止创建不可能的重载，但也许现在还不需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T06:13:18.343

Kerrek SB 的解决方案很好，适用于一般情况（我投了赞成票）。

最后，我选择了一个稍微不同的实现，它使用函数重载，这是一种可能的替代方案，特别是因为它不需要 enable_if 并且仍然很优雅：

```
template<typename Container>
void vblock(int row, int col, const Container& container) {
  foreach( const typename Container::value_type& item, container ) {
    vblock_cell_impl(row, col, item);
    ++row;
  }
}

template<typename T>
void vblock_cell_impl(int row, int col, const T& item) {
  cell(row, col, item);
}

template<typename T1, typename T2>
void hblock_cell_impl(int row, int col, const boost::tuple<T1, T2>& item) {
  cell(row, col, item.template get<0>());
  cell(row + 1, col, item.template get<1>());
} 
```

# assembly - Ollydbg 未知标识符错误

> ID：11970139
> 
> 赞同：0
> 
> 时间：2012-08-15T13:28:07.057
> 
> 标签：assembly, x86

```
10002579   . 6A 00          PUSH 0
1000257B   . 68 59020000    PUSH 259
10002580   . 8B11           MOV EDX,DWORD PTR DS:[ECX]
10002582   . 6A 00          PUSH 0
10002584     6A 05          PUSH 5
10002586     50             PUSH EAX
10002587     FF52 18        CALL DWORD PTR DS:[EDX+18]
1000258A     84C0           TEST AL,AL
1000258C     75 2B          JNZ SHORT Pigeon.100025B9
1000258E     8B4E 10        MOV ECX,DWORD PTR DS:[ESI+10]
10002591   . 68 D5070000    PUSH 7D5
10002596   . 68 0000FF00    PUSH 0FF0000
1000259B   . 68 90640110    PUSH Pigeon.10016490     ;ASCII "STR_PIGEON_SEND_ERR_NOEMONEY"
100025A0   . 8B39           MOV EDI,DWORD PTR DS:[ECX]
100025A2   . FF15 04300110  CALL DWORD PTR DS:[<&Common.CnStrGet>]   ;  Common.CnStrGet
100025A8   . 8B9424 5C04000>MOV EDX,DWORD PTR SS:[ESP+45C]
100025AF   . 83C4 04        ADD ESP,4
100025B2   . 50             PUSH EAX
100025B3   . 52             PUSH EDX
100025B4   . E9 30020000    JMP Pigeon.100027E9
100025B9   > 8B46 10        MOV EAX,DWORD PTR DS:[ESI+10] 
```

我需要将 10002584 上的 push 5 更改为 push c350，但在 ollydbg 上出现未知标识符错误

当我使用 0xC350 时，下面的代码会发生变化，并且 dll 文件无法正常运行。

怎么做 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:45:07.493

`push 0xc350`显然需要超过 2 个字节（即 的长度`push 5`）进行编码。它需要 5 个字节。

您不能将这 5 个字节压缩到 2 个字节的空间中。如果您尝试，您将覆盖并损坏以下说明：

```
10002586     50             PUSH EAX
10002587     FF52 18        CALL DWORD PTR DS:[EDX+18] 
```

您需要将`push 5`（以及可能的以下说明）替换`jmp`为将具有`push 0xc350`（以及被该 覆盖的说明`jmp`，如果有的话）并`jmp`返回的位置。

# haskell - List monad：`>>=` 和 `return` 行为之间的区别

> ID：11970140
> 
> 赞同：3
> 
> 时间：2012-08-15T13:28:07.883
> 
> 标签：haskell, monads

我刚刚开始使用 monad，我无法弄清楚为什么这两个表达式的计算方式不同：

```
ghci> [1,2] >>= \n -> ['a','b'] >>= \ch -> return (n,ch)
[(1,'a'),(1,'b'),(2,'a'),(2,'b')]

ghci> return ([1,2],['a','b'])
([1,2],"ab") 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T13:52:52.987

类型不同，所以行为不同是合理的

第一个表达式将类型检查为`Num t => [(t, Char)]`

在 (>>=) 中使用 [] 作为 monad 意味着它推断出 monad 应该是 List monad，并且在`List Monad` [http://en.wikibooks.org/wiki/Haskell/Understanding_monads/List](http://en.wikibooks.org/wiki/Haskell/Understanding_monads/List)的上下文中(>>=) 是 concatMap 并且返回是 (:[])。

```
[1,2] >>= \n -> ['a','b'] >>= \ch -> return (n,ch) 
```

是相同的

```
concatMap (\n -> concatMap (\ch -> [(n, ch)]) ['a', 'b']) [1,2] 
```

返回`[(1,'a'),(1,'b'),(2,'a'),(2,'b')]`

在你的第二个例子中，真正发生的是

表达式的类型更一般：

```
Prelude> :t return ([1,2],['a','b'])
return ([1,2],['a','b']) :: (Monad m, Num t) => m ([t], [Char]) 
```

因为你在 GHCi 中运行它，所以会发生一些事情。GHCi 可以认为是一个非常大的特殊 IO Monad。因此，由于没有指定 monad，所以当 GHC 尝试打印结果时，在这种情况下将采用`m`Monad 。`IO`

`t`也默认为 ，因此`Integer`结果表达式的类型为`:: IO ([Integer], [Char])`。

碰巧，所有使用的类型都有一个`Show`实例，因此 GHC 可以打印执行`IO`动作的结果，在这种情况下（由于动作被返回）与输入相同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-15T13:57:19.160

在 GHCi 中，您可以使用`:t`. 这样做表明您的表达式具有不同的类型：

```
ghci> :t [1,2] >>= \n -> ['a','b'] >>= \ch -> return (n,ch)
[1,2] >>= \n -> ['a','b'] >>= \ch -> return (n,ch)
  :: (Num t) => [(t, Char)]

ghci> :t return ([1,2],['a','b'])
return ([1,2],['a','b']) :: (Num t, Monad m) => m ([t], [Char]) 
```

因此，它们具有不同的值。

也许*你*对`return`. 但是，看看它的类型：

```
ghci> :t return
return :: Monad m => a -> m a 
```

`return`对它的论点一无所知——它只接受一个值，任何值，并将其置于默认的单子上下文中。

* * *

要准确了解评估这些表达式时会发生什么，您需要：

1.  Hoogle，查找列表的 monad 实例，以及
2.  第二个表达式的更具体的类型

[这是](http://hackage.haskell.org/packages/archive/base/latest/doc/html/src/GHC-Base.html#Monad)monad 实例：

```
instance  Monad []  where
    m >>= k             = foldr ((++) . k) [] m
    m >> k              = foldr ((++) . (\ _ -> k)) [] m
    return x            = [x]
    fail _              = [] 
```

（我们可以忽略`>>`and `fail`，因为我们没有使用它们。）

所以让我们扩展我们的表达式：

```
[1,2] >>= \n -> ['a','b'] >>= \ch -> return (n,ch) 
```

这样设置`m = [1, 2]`，`k = \n -> ['a','b'] >>= \ch -> return (n,ch)`我们得到：

```
foldr ((++) . (\n -> ['a','b'] >>= \ch -> return (n,ch))) [] [1,2] 
```

现在摆脱第二个`>>=`，`m = ['a', 'b']`并且`k = \ch -> return (n, ch)`：

```
foldr ((++) . (\n -> rest)) [] [1,2]
  where
    rest = foldr ((++) . (\ch -> return (n,ch))) [] ['a', 'b'] 
```

并且`return`很容易摆脱：

```
foldr ((++) . (\n -> rest)) [] [1,2]
  where
    rest = foldr ((++) . (\ch -> [(n,ch)]) [] ['a', 'b'] 
```

另一方面，第二个表达式的值：

```
return ([1,2],['a','b']) 
```

取决于*你在哪个单子*。在 list monad 中，它简单地变成：

```
[([1,2], ['a','b'])] :: [] ([Int], String) 
```

而在 Maybe monad 中，它是：

```
Just ([1,2], ['a', 'b']) :: Maybe ([Int], String) 
```

# javascript - javascript：函数和类有什么区别

> ID：11970141
> 
> 赞同：30
> 
> 时间：2012-08-15T13:28:18.197
> 
> 标签：javascript

我想知道函数和类之间有什么区别。都使用关键字function，这两者有明显区别吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-15T13:29:42.400

从技术上讲，没有类，它们都只是函数。任何函数都可以使用关键字作为构造函数调用，`new`并且该函数的原型属性用于对象继承方法。

“类”仅在概念上用于描述上述做法。

因此，当有人对您说“创建一个颜色类”或其他什么时，您会这样做：

```
function Color(r, g, b) {
    this.r = r;
    this.g = g;
    this.b = b;
}

Color.prototype.method1 = function() {

};

Color.prototype.method2 = function() {

}; 
```

当你分解它时，只有一个函数和一些`prototype`对该函数调用的属性的分配，所有通用的 javascript 语法，没有什么特别的。

当你说的时候，这一切都变得有点神奇`var black = new Color(0,0,0)`。然后，您将获得一个具有属性`.r`和`.g`的对象`.b`。该对象还将有一个隐藏的 [[prototype]] 链接到`Color.prototype`. 这意味着您可以说`black.method1()`即使对象`.method1()`中不存在`black`。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2017-08-18T14:46:37.063

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-15T13:43:55.200

在 javascript 中，没有类。javascript 使用原型继承而不是基于类的继承。很多人会提到javascript中的类，因为它更容易理解，但这纯粹是一个类比。

在基于类的继承中，您创建一个类（如果您愿意的话，是一个“蓝图”），然后从该类实例化对象。

在原型继承中，一个对象直接从另一个父对象实例化，而不需要任何“蓝图”。

有关类与原型继承的更多信息，请参阅[维基百科页面](http://en.wikipedia.org/wiki/Prototype-based_programming#Object_construction)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-06-07T07:55:55.353

## `function`构造函数和构造函数的区别`class`

javascript中的`class`关键字与构造函数非常相似，方式如下：

*   他们都使用javascript的原型继承系统
*   它们都用于创建具有以下语法的对象：`new myObj(arg1, arg2)`

构造函数和类非常相似，通常可以根据偏好互换使用。但是，javascript 对类的私有字段是构造函数无法实现的功能*（没有范围黑客）*

## 例子：

```
class PersonClass {
  constructor(name) {
    this.name = name;
  }

  speak () { console.log('hi'); }
}

console.log(typeof PersonClass); 
// logs function, a class is a constructor function under the hood.

console.log(PersonClass.prototype.speak);
// The class's methods are placed on the prototype of the PersonClass constructor function

const me = new PersonClass('Willem');

console.log(me.name); 
// logs Willem, properties assinged in the constructor are placed on the newly created object

// The constructor function equivalent would be the following:
function PersonFunction (name) {
  this.name = name;
}

PersonFunction.prototype.speak = function () { console.log('hi'); }
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-26T11:57:13.667

**班级**

> 一个类声明的作用域是它的包含块。在同一个块中声明一个类名两次是错误的。类定义没有被提升。

**功能**

> 函数声明是严格模式下的块作用域。

下表总结了类和函数之间的区别 [![在此处输入图像描述](../Images/49dd888ff0e142d66f8a4aa7e4c22e6f.png)](https://i.stack.imgur.com/hK9Rn.jpg)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-05T11:28:53.960

[本次演讲](https://www.youtube.com/watch?v=seX7jYI96GE&t=454s)强调了函数和类之间的一个关键区别，这表明函数是可以携带数据的行为，而相反，类是可以携带行为的数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-15T13:36:39.700

术语*类*通常用于面向对象的编程语言上下文中。类是将在实例化时创建的对象的模板。JavaScript 是一种基于原型的编程语言，因此使用术语类来描述 JavaScript 原型有点奇怪。在 JavaScript 中，原型被创建为函数

# iphone - 是否可以在 info.plist 中存储二维数组

> ID：11970144
> 
> 赞同：0
> 
> 时间：2012-08-15T13:28:36.010
> 
> 标签：iphone, objective-c, xcode

我有如下的 9x9 矩阵数组。我想将它作为游戏参数存储在本地的 iPhone 应用程序中。

```
int str2Darray[9][9] = { 

    {-1, -1, -1, 1, 1, 1, -1, -1, -1}, 
    {-1, -1, -1, 1, 1, 1, -1, -1, -1}, 
    {-1, -1, -1, 1, 1, 1, -1, -1, -1}, 
      {1, 1, 1, 1, 1, 1, 1, 1, 1}, 
      {1, 1, 1, 1, 0, 1, 1, 1, 1}, 
      {1, 1, 1, 1, 1, 1, 1, 1, 1}, 
    {-1, -1, -1, 1, 1, 1, -1, -1, -1}, 
    {-1, -1, -1, 1, 1, 1, -1, -1, -1}, 
    {-1, -1, -1, 1, 1, 1, -1, -1, -1}, 

}; 
```

是否可以将上述数组存储在`.plist`文件中？如果有的话，也请建议任何其他方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:42:33.527

您肯定不想将其存储在您的 Info.plist 中。正如已经说过的那样，这是关于您的应用程序的信息，而不是数据存储。而是在您的应用程序资源中放置一个单独的文件并将您的数据保存在其中。

您可以将数据转换为`NSNumbers`in的 2D 数组`NSArrays`并将其写入`NSArray`单独的 plist 文件，但这会产生很多开销。

相反，如果您已经知道数组的大小将始终为 9x9，我建议将数组传递给`NSData`对象并将其保存到文件中。

```
NSData *arrayData = [NSData dataWithBytes:str2Darray length:sizeof(int)*9*9];
[arrayData writeToFile:dataPath atomically:YES]; 
```

如果此数组表示您的游戏在任何时候的状态并且您想要保存它，以便用户在返回您的应用程序时可以继续，那么您应该将它保存到您的文档文件夹中。

```
NSString *docPath = NSSearchPathForDirectoriesInDomains(NSDocumentsDirectory, NSUserDomainMask, YES);
NSString *dataPath = [docPath stringByAppendingPathComponent:@"MyArrayData.txt"]; 
```

如果它代表关卡数据，或者您希望随游戏一起发布的游戏的启动配置，那么我建议您启动一个临时的简单的第二个项目。执行一次，获取保存的文件并将其放入您的项目资源中。

然后，您可以通过以下路径访问它：

```
NSString *dataPath = [[NSBundle mainBundle] pathForResource:@"MyArrayData" ofType:@"txt"];
int length = sizeof(int)*9*9;
str2DArray = (int *)malloc(length); // Assuming str2Darray is an ivar or already defined.
NSData *arrayData = [NSData dataWithContentsOfFile:dataPath];
[arrayData getBytes:&str2Darray length:length]; 
```

# c# - C# 在字符串数组列表中查找元素

> ID：11970145
> 
> 赞同：4
> 
> 时间：2012-08-15T13:28:37.923
> 
> 标签：c#

我现在几个小时都无法解决问题。这是一个简化的场景。假设有一个人的出价列表。我正在尝试找到出价最高的人并返回名称。我可以找到最高的出价，但是如何输出名称？

```
 List<String[]> list = new List<String[]>();
        String[] Bob = { "Alice", "19.15" };
        String[] Alice = {"Bob", "28.20"};
        String[] Michael = { "Michael", "25.12" };

        list.Add(Bob);
        list.Add(Alice);
        list.Add(Michael);

        String result = list.Max(s => Double.Parse(s.ElementAt(1))).ToString();

        System.Console.WriteLine(result); 
```

结果我得到 28.20，这是正确的，但我需要显示“Bob”。list.Select() 有很多组合，但没有成功。请问有人吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T13:32:01.533

从架构的角度来看，最好的解决方案是创建一个单独的类（例如 Person），其中包含每个人的两个属性 Name 和 Bid，以及一个包含人员列表的 Persons 类。

然后，您可以轻松地使用 LINQ 命令。

此外，不要将出价存储为字符串，而是考虑将出价作为浮点数或十进制值会更好（或将其存储为美分并使用 int）。

我没有手动编译器，所以我有点想不通：

```
public class Person
{
    public string Name { get; set; }
    public float  Bid  { get; set; }

    public Person(string name, float bid)
    {
        Debug.AssertTrue(bid > 0.0);
        Name = name;
        Bid = bid;
    }
}

public class Persons : List<Person>
{
    public void Fill()
    {
        Add(new Person("Bob", 19.15));
        Add(new Person("Alice" , 28.20));
        Add(new Person("Michael", 25.12));
    }
} 
```

在你的课堂上：

```
var persons = new Persons();
persons.Fill();

var nameOfHighestBidder = persons.MaxBy(item => item.Bid).Name;
Console.WriteLine(nameOfHighestBidder); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-15T13:31:02.680

您可以使用[Jon Skeet 的 MaxBy。](http://code.google.com/p/morelinq/source/browse/MoreLinq/MaxBy.cs)

对于用法，您可以看到[这个问题](https://stackoverflow.com/questions/11920344/faster-way-to-count-number-of-sets-an-item-appears-in) ，例如在这种情况下

```
list.MaxBy(s => Double.Parse(s.ElementAt(1)))[0] 
```

更多[在这里](http://code.google.com/p/morelinq/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-15T13:33:52.910

这适用于简单的示例。不确定真实的

```
var result = list.OrderByDescending(s => Double.Parse(s.ElementAt(1))).First(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-15T13:34:12.627

应该管用：

```
var max = list.Max(t => double.Parse(t[1]));
list.First(s => double.Parse(s[1]) == max)[0]; // If list is not empty 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-15T13:32:31.897

找到结果后，只需执行以下操作：

```
list.First(x=>x[1] == result)[0] 
```

# java - Java jpanel 的工作方式类似于窗口的拖放图标重新排列

> ID：11970147
> 
> 赞同：0
> 
> 时间：2012-08-15T13:28:47.690
> 
> 标签：java, swing, drag-and-drop

因此，当您将图标移动到新位置时，窗口会自动将其他图标向下推（我也想将它们向上推）。我想用 jcomponents 来做这个，特别是 jtables。

如果我可以跟踪哪个表在哪里（我需要将他们的订单保存在 xml 中），也可以获得奖励积分。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:42:09.547

没有开箱即用的机制来通过拖放重新排列组件，但自己做很容易。这是基本思想：

1) 使用 JLayeredPane 作为基础组件，并将您的表格放在默认图层上

2) 在其上添加一个透明组件，例如更高层。这将是你的玻璃板

3) 在玻璃窗格上安装一个 MouseMotionListener。当您检测到应该移动表格的拖动时，请继续执行 4。否则，将事件重新调度到底层组件。

4) 为拖动提供某种视觉反馈，例如一条半透明线来指示拖放位置。向用户显示当他释放鼠标时表格将出现的位置。

5) 如果拖动指示应该重新排列表格，只需在表格面板上重做布局以相应地定位它们。

如果您对其中一个步骤有具体问题，请随时发表评论。

# umbraco - 我在 Umbraco 的开发人员视图中看不到 Config 目录

> ID：11970149
> 
> 赞同：2
> 
> 时间：2012-08-15T13:28:56.983
> 
> 标签：umbraco

当我创建一个新的内容页面时，文档链接在发布后显示为空白，我想我需要查看：

```
<add key="umbracoUseDirectoryUrls" value="false" />

<add key="umbracoUseDirectoryUrls" value="true" /> 
```

看看它是否有效。但是，即使我具有管理员访问权限，我也无法在开发人员视图中找到 Config 文件夹。

请问有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:08:56.653

如果您希望能够通过 Umbraco 后端访问配置文件，则需要安装[Config Tree](http://our.umbraco.org/projects/developer-tools/config-tree)包。只有这样，配置树/文件夹才会出现在开发人员部分。

否则，您将不得不从本地文件系统对 web.config 和其他配置文件进行编辑。

# ios - 在视图中提高过渡平滑度

> ID：11970153
> 
> 赞同：2
> 
> 时间：2012-08-15T13:29:08.810
> 
> 标签：ios, animation, uiview, catransition, multiple-views

在我们的应用程序中，我们使用 CATransition 从一个视图过渡到另一个视图，但是我们缺少其他应用程序中的平滑度。因此，什么可以作为视图转换的替代解决方案或一些提高应用程序流平滑度的技巧。

问候

这里编辑的是我们正在使用的代码：

```
MyView *obj =[[MyView alloc]initWithFrame:CGRectMake(0,0,320,415)];
CATransition *animation = [CATransition animation];
[animation setDuration:0.3];
animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseOut];
[animation setType:kCATransitionPush]; 
[animation setSubtype:kCATransitionFromRight];  
[[self.superview layer] addAnimation:animation forKey:nil];

[self.superview addSubview:obj];
[obj release];

[self removeFromSuperview]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:47:59.723

如果没有任何代码/背景信息，将很难为您提供帮助，但我可以告诉您的一件事是动画期间的光栅化可以产生巨大的影响：

```
- (void)startAnimation {
    [myView.layer setShouldRasterize:YES]; //tell the layer to rasterize
    [myView.layer setRasterizationScale:[UIScreen mainScreen].scale]; //make sure it scales on retina devices

    double delayInSeconds = 0.1; // wait a bit to let it rasterize
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, delayInSeconds * NSEC_PER_SEC);
    dispatch_after(popTime, dispatch_get_current_queue(), ^(void) {
        //do
        //your
        //animation
        //here

        //where you're animation is finished (i.e. in a completion block)
        //tell the layer not to rasterize anymore
        [myView.layer setShouldRasterize:NO];
    }
} 
```

# .net - 具有多个 OrderBy 子句的 Linq 语句不起作用

> ID：11970155
> 
> 赞同：3
> 
> 时间：2012-08-15T13:29:18.550
> 
> 标签：.net, vb.net, linq, linq-to-entities

我有一个本地集合，我正在尝试使用 Linq 进行排序，但内存集合中返回的仍然按数字 ID 列 FailureID 排序。知道为什么这些 OrderBy 条款没有生效吗？

**目的**

```
Public Class OpenBuildFaultsViewModel

    Public Property FailureID As Int64
    Public Property ModelName As String
    Public Property ZoneName As String
    Public Property Fault As String
    Public Property FaultCode As String
    Public Property FaultCodeDetail As String
    Public Property FaultArea As String
    Public Property MajorAssembly As String
    Public Property SubAssembly As String
    Public Property ComponentAssembly As String
    Public Property BusinessTest As String
    Public Property AuditScore As String
    Public Property Comment As String
    Public Property ShortagePart As String
    Public Property CreatedBy As String
    Public Property FixedByID As Int32
    Public Property FixedByComment As String
    Public Property FixedByFaultRectificationID As Int32

End Class 
```

**订购方式**

```
Function Index() As ActionResult

        Dim data As IEnumerable(Of OpenBuildFaultsViewModel) = Session("Failures")

        Dim model = From fails In data.Where(Function(w) w.FixedByID.Equals(0)).
                                        OrderBy(Function(o) o.MajorAssembly).
                                        OrderBy(Function(o) o.SubAssembly).
                                        OrderBy(Function(o) o.ComponentAssembly).
                                        OrderBy(Function(o) o.BusinessTest).
                                        OrderBy(Function(o) o.FailureID)

        Return View(model)

    End Function 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T13:31:15.543

如果要按多个条件对数据进行排序，则必须`OrderBy`仅用于第一个条件。对于下一个，您应该使用`ThenBy`：

```
 Dim model = From fails In data.Where(Function(w) w.FixedByID.Equals(0)).
                                    OrderBy(Function(o) o.MajorAssembly).
                                    ThenBy(Function(o) o.SubAssembly).
                                    ThenBy(Function(o) o.ComponentAssembly).
                                    ThenBy(Function(o) o.BusinessTest).
                                    ThenBy(Function(o) o.FailureID) 
```

如果您`OrderBy`每次都使用，它会“忘记”之前的订单并完全按照后续标准重新排序，而忽略之前的订单。

顺便说一句，这`From fails In`部分没用；以下语句具有相同的含义：

```
 Dim model = data.Where(Function(w) w.FixedByID.Equals(0)).
                    OrderBy(Function(o) o.MajorAssembly).
                    ThenBy(Function(o) o.SubAssembly).
                    ThenBy(Function(o) o.ComponentAssembly).
                    ThenBy(Function(o) o.BusinessTest).
                    ThenBy(Function(o) o.FailureID) 
```

# jquery - 选择控制操作不起作用

> ID：11970156
> 
> 赞同：0
> 
> 时间：2012-08-15T13:29:21.517
> 
> 标签：jquery

我正在使用 jquery live 函数在页面上创建多个小部件，使用...

```
$('#mybutton').live('click', function(){
var first = $('#win-doors-pvc fieldset:first').html();   
$(first).find('select option:selected').attr('selected',false);   
$('#win-doors-pvc').append('<fieldset>'+first+'</fieldset>');
}); 
```

上面的代码成功地在字段集中重新创建了内容。

带有 var 的内容首先包含一个选择控件。我想通过使用来操纵该选择

```
$(first).find('select option:selected').attr('selected',false); 
```

取消选择已选择的内容。

为什么它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:40:13.853

见[http://jsfiddle.net/4MEbU/](http://jsfiddle.net/4MEbU/)：

```
$('#mybutton').live('click', function(){
var first = $('#win-doors-pvc fieldset:first');   
first.find('select option:selected').attr('selected',false);   
$('#win-doors-pvc').append('<fieldset>'+first.html()+'</fieldset>');
}); 
```

您的代码不起作用，因为您这样做了

```
var first = $('#win-doors-pvc fieldset:first').html(); 
```

then`first`是一个包含 html 的字符串，因此`$(first)`给出一个空对象。

而不是这个，`first`应该是对元素的引用（不是它的 html 代码）：

```
var first = $('#win-doors-pvc fieldset:first'); 
```

所以`first.find('select option:selected').attr('selected',false);`效果很好。

当你想要它的 html 代码时，只需使用`first.html()`

```
$('#win-doors-pvc').append('<fieldset>'+first.html()+'</fieldset>') 
```

**编辑**：

如果您希望新元素具有与第一个相同的`option`selected元素，则`select`可以移动自身：

```
$('#mybutton').live('click', function(){
    var first = $('#win-doors-pvc fieldset:first');
    $('#win-doors-pvc').append(first);
    $('#win-doors-pvc').prepend(first.clone(true,true));
});
​ 
```

在这里看到它：http: [//jsfiddle.net/4MEbU/3/](http://jsfiddle.net/4MEbU/3/)

# asp.net - UrlRewriter.NET - 简单的重写规则，但如何？

> ID：11970157
> 
> 赞同：2
> 
> 时间：2012-08-15T13:29:24.677
> 
> 标签：asp.net, url-rewriting, url-rewrite-module, urlrewriter.net

我刚刚从 Urlrewriter.net 安装了示例，但我似乎无法弄清楚解决问题的规则。

很简单：

如果用户导航到此页面：

```
http://localhost/UrlRewriteTest/Default.aspx?PageID=33 
```

网址应如下所示：

```
http://localhost/UrlRewriteTest/33 
```

或者可能

```
http://localhost/UrlRewriteTest/33.aspx 
```

我究竟做错了什么？这是我的 web.config：

```
<?xml version="1.0"?>
<configuration> 
  <configSections>
    <section name="rewriter" requirePermission="false" type="Intelligencia.UrlRewriter.Configuration.RewriterConfigurationSectionHandler, Intelligencia.UrlRewriter"/>
  </configSections>
    <system.web>
    <httpModules>
      <add name="UrlRewriter" type="Intelligencia.UrlRewriter.RewriterHttpModule, Intelligencia.UrlRewriter"/>
    </httpModules>
    <compilation targetFramework="4.0"/>
    <pages controlRenderingCompatibilityVersion="3.5" clientIDMode="AutoID"/>
  </system.web> 
  <rewriter>
    <rewrite url="~/(.+)" to="~/Default.aspx?PageID=$1"/> 
  </rewriter>
    <system.webServer>
        <modules runAllManagedModulesForAllRequests="true">
            <add name="UrlRewriter" type="Intelligencia.UrlRewriter.RewriterHttpModule" />
        </modules>
        <validation validateIntegratedModeConfiguration="false" />
    </system.webServer>
</configuration> 
```

这是第一步。更理想的是，PageID 应该被传递到数据库并返回页面名称而不是 ID，并且 URL 应该最终看起来像这样：

```
http://localhost/UrlRewriteTest/thename/ 
```

此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:34:21.347

你可以阅读 Scott Guthrie 关于 Url Rewriting 的文章 @ [http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)。

# iphone - 如何在 UITabBarController 中向 UINavigationController 添加右键？

> ID：11970164
> 
> 赞同：0
> 
> 时间：2012-08-15T13:29:57.950
> 
> 标签：iphone, ios, uinavigationcontroller, uitabbarcontroller, uinavigationbar

我有一个包含 UITabBarController 和 UINavigationController 的类（UITabBarController 的选项卡之一）：

```
 @interface HomeController : NSObject{
UINavigationController *maps;
UIBarButtonItem* national;

}

@property (retain, nonatomic) UIWindow *window;

@property (retain, nonatomic) UITabBarController *tabBarController;

@end 
```

在 .m 文件（初始化方法）中，这是我正在尝试的方式，但它不起作用：

```
self.tabBarController.viewControllers = [NSArray arrayWithObjects:adminController, maps, sitesController, nil]; 
```

我想把国家按钮作为我的 UINavigationController *maps 的 rightBarButtonItem，所以我在 init 方法（.m 文件）中插入了这些行：

```
 national= [[UIBarButtonItem alloc] initWithTitle:@"national" style:UIBarButtonItemStyleDone target:nil action:nil];
    maps.navigationItem.rightBarButtonItem = national;
    [national release]; 
```

因为我的类不是在 viewDidLoad 方法中插入该代码的视图（NSObject 的子类）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:30:10.907

Maps 本身并不是一个 viewController，而是一个管理视图的容器对象。在某些时候，地图有一个或多个 viewController——它应该总是有一个 rootViewController。所以试试这个：

```
...create and initialize maps
UIViewController *firstView = maps.rootViewController;
firstView.view; // force it to load its view, may or may not be necessary
firstView.navigationItem.rightBarButtonItem = national; 
```

# gcc - 获取默认 GCC 警告列表

> ID：11970165
> 
> 赞同：10
> 
> 时间：2012-08-15T13:29:59.143
> 
> 标签：gcc, warnings

我想知道当没有指定 -Wx 或 -W-no-x 标志时，是否可以获得在 GCC 中启用的警告列表？我需要这个，因为我有 2 个不同的 GCC 版本（即 3.3 和 4.3），它们对具有相同编译标志的相同代码的反应不同。

例如，没有附加警告选项的 4.3 在发生有符号到无符号比较时会引发警告，而 3.3 仅在 -Wsign-compare 标志时才会发出警告。所以，我想弄清楚，我应该将哪些标志添加到 gcc-3.3 以强制它检测 4.3 默认情况下的相同警告。

对于 4.3，我设法使用 获得这样的警告列表`gcc -Q --help=warnings | grep enabled`，但 3.3 似乎没有提供这样的功能。有谁知道，如何以其他方式完成？也许定义警告状态的源文件？

问候， 马文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-03T10:32:59.243

GCC 命令行选项通常在 gcc/common.opt 文件中定义。尝试在此文件中搜索“警告”关键字。

# jquery - 使用 jquery 将 9 个缩略图的画廊一次随机 1 个淡化，无需悬停

> ID：11970170
> 
> 赞同：0
> 
> 时间：2012-08-15T13:30:10.370
> 
> 标签：jquery, gallery, thumbnails, image-gallery

这个例子

[http://jsfiddle.net/wCb93/1/](http://jsfiddle.net/wCb93/1/)

...似乎是我需要的，除了我的图像是 137x109（9 张图像）。他们需要在没有悬停或鼠标激活的情况下连续随机淡入和淡出。3 x 3 设置对我来说是理想的，所以我认为它只需要一些调整。我只在 Flash 中工作过，所以这对我来说是全新的……所以请温柔一点！

该网站是

[http://www.incyteventures.com/index.html](http://www.incyteventures.com/index.html)

如您所见，不理想...任何帮助将不胜感激！

问候莱斯

再次感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:12:52.533

我已经分叉了 jsfiddle 并添加了 fadeIns。这是你想要的？ [http://jsfiddle.net/flyingsausage/JBmks/](http://jsfiddle.net/flyingsausage/JBmks/)

不要使用淡入淡出的构建，因为它们将您的元素 css 设置为

```
display:none 
```

在淡出动画结束时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T12:49:18.783

将此代码保存为 *.js 文件（我对其进行了一些修改）：

```
$(function(){
    changeImg();
})

function changeImg(){
    var randomNumber = Math.floor(Math.random()*(9));
    var theImage = $('#container > img').eq(randomNumber);

    if (theImage.css("opacity")==0){
        theImage.delay(500).animate({
            opacity:1
        },250, function(){
            changeImg();
        });
    } else {
        theImage.delay(500).animate({
            opacity:0
        },250, function(){
            changeImg();
        });
    }
} 
```

你应该看起来像这样：

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>fancy_fade_outs</title>
<style type="text/css">
img {
    display: block;
    width: 137px;
    min-height: 109px;
    margin-right: 9px;
    margin-bottom: 9px;
    opacity:0;
    border: 0;
    float: left;
}

#container {
    width: 438px; /* =(image width + margin right)*3  */
}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script><!-- jquery on google-->
<script src="fadeScript.js"></script><!-- path to your script-->
</head>

<body>
<div id="container">
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" />
<img src="http://dummyimage.com/50/000/000" /><div style="clear: both;"></div>
</div>
​
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:52:51.967

使用 jquery 选择器（ jQuery() 或 $() ）你有一个像数组一样的对象，通过使用 get() 方法你可以选择该集合的特定对象。所以你所要做的就是：使用选择器捕获图像，从 0 到对象长度选择一个随机数，调用 fadeToggle（需要 jQueryUI）。然后你 setInterval 到那个函数。注意：setInterval 的时间必须与fadeToggle 相同或更长，否则图像不会完全淡出。

# testing - QTP：尝试识别对象时无法使用 CSS 和索引属性

> ID：11970172
> 
> 赞同：1
> 
> 时间：2012-08-15T13:30:18.453
> 
> 标签：testing, automated-tests, qtp

我试图在我的脚本中运行下面的代码行，但我收到一条错误消息，指出在页面上找到了多个具有这些属性的对象。

```
Browser("browser").Page("page").WebElement("css:=.normalDayOfMonth").Click 
```

所以，我尝试添加一个索引，如下所示：

```
Browser("browser").Page("page").WebElement("css:=.normalDayOfMonth", "index:=0").Click 
```

但现在它根本没有检测到任何物体。谁能帮我解决这个问题？谢谢！

* * *

**编辑：**对于遇到此问题的任何其他人，事实证明我使用的是 QTP10，正如 Motti 在下面指出的那样，CSS 和 Xpath 支持仅在 QTP11 中添加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:33:07.133

QTP11 中添加了对使用`CSS`和`XPath`识别测试对象的支持，在您的评论中您说您正在使用 QTP10，这将解释您遇到问题的原因......

可能发生的情况是 QTP 被忽略`css`为无法识别的属性，因此您的描述与所有元素匹配，然后当您添加它时会带来无法单击`index:=0`的不可见元素之一（例如`HEAD`或）。`HTML`

如果您想要做的只是匹配，`className`您可以使用 QTP 的`class`标识属性`("class:=normalDayOfMonth")`。

顺便说一句，该`Highlight`函数是一个未记录的函数，类似于对象存储库的突出显示功能，并且在故障排除测试中非常有用。

# c++ - 从非托管 dll 中的 QThread 回调到托管 C++ 主线程

> ID：11970175
> 
> 赞同：0
> 
> 时间：2012-08-15T13:30:36.053
> 
> 标签：c++, multithreading, qt, callback

我想从在本机 dll 中创建的线程对我的托管包装器进行回调，我已经成功创建了我的线程并通过 Qt.s 框架信号和插槽进行了调用。

如何在非托管和托管 dll 之间从单独的线程向主线程进行回调？非托管在 QT c++ 中完成，通过 VS c++ 进行管理。

非托管 dll：main.cpp

```
typedef void (__stdcall * processCallback)(char*, int, int);
Thread* thread;
EXTEXPORT_VOID initdll(processCallback callback)
{
    /* Init MainThread - Runs eventloop */
    thread = new Thread(callback);
    thread ->start();
} 
```

thread.h - 运行方法，我在这里进行回调，但回调在我的新线程中继续，而不是在我的托管 dll 中创建它的主线程。为什么？

```
void run() {
    callback("Testing callback", 0, 0);
    exec();
} 
```

我需要这个回调是我的主线程，而不是我现在正在运行的线程。

托管 dll

```
/* From unmanaged to managed c++ */
[UnmanagedFunctionPointerAttribute(CallingConvention::StdCall)] 
public delegate void UnmanagedCallbackDelegate(char*, int, int);

typedef void (__stdcall * typeCallback)(char*, int, int); //Same def as in Unm. dll
public ref class cDLLThreadWrapper
{
    [DllImport("cDLL.dll", CallingConvention=CallingConvention::StdCall)] 
    static void initdll(typeCallback);

public:
    typeCallback callbackNative;
    UnmanagedCallbackDelegate^ m_CallbackDelegate;

    cDLLThreadWrapper()
    {

    }
    void init()
    {
        m_CallbackDelegate = gcnew UnmanagedCallbackDelegate(this, &cDLLThreadWrapper::UnhandledCallback);
        IntPtr ptr = Marshal::GetFunctionPointerForDelegate(m_CallbackDelegate);
        callbackNative = static_cast<typeCallback>(ptr.ToPointer());

        initdll(callbackNative);
    }
            void UnhandledCallback(char* data, int x, int y)
    {
        String^ callStr = gcnew String(data);
                    //AppDomain.GetCurrentThreadId())
        //I get here but the thread is wrong, it should be the main thread
                    //which called the initdll function from this wrapper.
    }
} 
```

正如我所说的回调有效，但由于某种原因我在错误的线程中得到它，回调不应该来自线程1 - >主线程吗？

这是一个非常简化的示例，但具体问题是为什么我的回调没有从新创建的线程转到主线程，而是留在新创建的线程中。我在哪里想错了？任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:46:31.917

您正在将回调作为直接调用执行，有什么让您感到惊讶的？如果你`callback(...)`在 Qt 中这样做，它也会在你的新线程中执行并继续。这相当于用`Qt::DirectConnection`类型声明信号槽连接。Qt 很聪明`Qt::QueuedConnection`，当调用者线程和目标线程不同时，它会在幕后为你做事。但是为了让它自动工作，源必须声明为`signal`，目标必须声明为`slot`，目标必须是 a `QThread`，并运行特定于 Qt 的事件循环。您在托管的 C++ 中运行了“一些”事件循环，但 Qt 不知道如何以及在其中发布什么内容。绝对不是一个`QObject`元数据，您的 .NET C++ 不会理解它。Qt 魔法只在 Qt 内部起作用。您必须了解事件是如何具体发布到您的 .NET C++ 并教您的 Qt 代码执行此操作的。我不是 .NET 专家，但以下内容看起来很有用

[如何在托管 C++ (C++/CLI) 中将 Qt 信号映射到事件](https://stackoverflow.com/questions/3915289/how-to-map-qt-signal-to-event-in-managed-c-c-cli)

# jakarta-ee - ServletContextListener - 属性 - 设置 java.sql.Connection 对象

> ID：11970176
> 
> 赞同：0
> 
> 时间：2012-08-15T13:30:42.587
> 
> 标签：jakarta-ee, servlets, nullpointerexception, database-connection, servlet-listeners

虽然我已经找到了这个问题的解决方案，但我想知道为什么它会这样工作。

我创建了一个实现 ServletContextListener 的类，并将一个对象设置为上下文属性，该对象旨在构建一个可用于所有应用程序的 java.sql.Connection (MySQL DBMS)。

正如 Java 教程所说，在 JDBC 4.0 发布之后，不再需要调用 Class.forName("...") 来初始化特定的驱动程序。

对于 JavaSE 项目是这样，但对于 Web 应用程序却不是这样。

例如，当我调用 createStatement() 时，Container 会抛出 NullPointerException，因为 java.sql.Connection 不存在。因此，我在 Connection "setter" 之上添加了 Class.forName("...") 并且它完美地工作。

注意：我使用 Netbeans。包含此示例的特定项目已将最新的 mysql-connector-java-5.1.21-bin.jar 设置为其库之一。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:44:26.067

> *我创建了一个实现 ServletContextListener 的类，并将一个对象设置为上下文属性，该对象旨在构建一个可用于所有应用程序的 java.sql.Connection (MySQL DBMS)。*

馊主意。您的 Web 应用程序现在不仅与 DB 具有线程不安全的交互，而且当 MySQL 决定回收连接时，您的 Web 应用程序也会在运行约 8 小时后崩溃，因为它已打开太久。不要那样做。使用连接池，只需按照标准 JDBC 习惯编写 JDBC 代码，即在尽可能短的范围内打开*和关闭所有资源。*

* * *

> *正如 Java 教程所说，在 JDBC 4.0 发布之后，不再需要调用 Class.forName("...") 来初始化特定的驱动程序。*
> 
> *对于 JavaSE 项目是这样，但对于 Web 应用程序却不是这样。*

如果将包含该`/META-INF/services/java.sql.Driver`文件的 JDBC 4.0 兼容驱动程序 JAR 文件放置在`/WEB-INF/lib`webapp 的文件夹中，而不是其他位置，那么对于 Web 应用程序也是如此。

* * *

> *例如，当我调用 createStatement() 时，Container 会抛出 NullPointerException，因为 java.sql.Connection 不存在。因此，我在 Connection "setter" 之上添加了 Class.forName("...") 并且它完美地工作。*

容器不可能抛出这个特定的异常。更有可能是您自己的代码做到了。顺便说一句，这个异常被抛出而不是 a 的事实`SQLException: no suitable driver`也表明您抑制了任何捕获的`SQLException`过程`DriverManager#getConnection()`并继续代码流，而不是抛出该异常和/或以某种方式中止代码流。这反过来也是一个坏主意。如果您绝对无法继续代码流，请不要抑制异常。

# objective-c - 如何在 Objective-C 中找出无法识别的选择器异常的位置？

> ID：11970177
> 
> 赞同：0
> 
> 时间：2012-08-15T13:30:44.003
> 
> 标签：objective-c

如何找出我的代码中的哪个位置导致了以下异常？

```
2012-08-15 09:24:27.414 TestProject[82870:17303] -[TestObj doIt]: unrecognized selector sent to instance 0x1106f320 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:41:52.517

*   转到断点导航器（左侧）
*   在底部你有一个+，
*   在所有异常上添加异常断点

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T14:31:20.643

最好的方法：添加一个断点来捕获所有异常，这将为您提供获取异常的代码行。从控制台，您将收到您在问题上发布的相同消息，因此，使用指针地址打印正在获取异常的对象。如果对象是垃圾（调试器不会打印它），这意味着您正在过度释放对象。如果你启用了僵尸，你会在你的类名上找到一个前缀 NSZombie__ 。这也意味着过度释放。如果你得到的类与你期望的不同，那么你在某个时候切换了对象并向错误的对象发送了一条消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T13:36:40.523

为抛出的异常设置断点。默认情况下，它会在抛出异常时暂停——在那里你会看到回溯和值。

如果它是完全随机的（例如不可重现），那么您可能会在启用僵尸的情况下运行 Instruments。

# jquery - jQuery.find() 找不到元素

> ID：11970182
> 
> 赞同：1
> 
> 时间：2012-08-15T13:31:10.677
> 
> 标签：jquery, find, selector

我是 jQuery 新手，我遇到了 find 函数的问题。我的代码中有以下两行 复制代码

```
console.log($('ul.gallery'));
console.log($("ul.gallery").find("img")); 
```

Opera Dragonfly 中的输出看起来像这样

[蜻蜓控制台输出](http://i46.tinypic.com/2hqcokk.png)

如您所见， find 函数没有找到 img 标签，但您也可以看到，它就在那里。我不知道这是否与那个奇怪的 <::after> 标签有关。我不知道这是从哪里来的。但我需要引用该 img 标签。而且拿不到。

//edit：<::after>标签在opera 12.01的dragonfly中显示，实际上它们在firefox中没有显示，但结果是一样的，它们没有被选中。如果我在静态 html 标签上使用选择器，它们就可以工作。也许我的困难是最近操纵 dom 的结果。

你能帮我么？亲切的问候安吉洛·汉内斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T17:17:59.637

所以我终于想通了。看起来，Opera Dragonfly 显示了在选择时不在 dom 中的元素。那非常令人困惑。但是非常感谢大家！

# android - 当 android 触发 ACTION_BATTERY_LOW

> ID：11970185
> 
> 赞同：7
> 
> 时间：2012-08-15T13:31:16.087
> 
> 标签：android, android-intent, broadcastreceiver

在我的应用程序中，我想在电池电量不足时做一些事情。当电池电量不足时，android 会触发`ACTION_BATTERY_LOW`并且当电池再次达到其良好的健康状态时，它会触发 Intent `ACTION_BATTERY_OKAY`。所以，我对此有三个问题：

1.Android实际触发的电池百分比是`ACTION_BATTERY_LOW`多少？

2.如果电池电量更低，它会重复触发相同的事件吗？

**3.我们可以配置android触发`ACTION_BATTERY_LOW`意图的电池百分比吗？**

我更关心第三点。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-15T14:03:21.530

不，您无法设置何时发送 ACTION_BATTERY_LOW 阈值。这是由 Android ROM 指定的系统级意图。这是在电池服务中设置值的代码：

```
mLowBatteryWarningLevel = mContext.getResources().getInteger(
            com.android.internal.R.integer.config_lowBatteryWarningLevel); 
```

请看以下代码，该代码是从电池服务的更新方法中的 Android 系统代码中截取的：

```
/* The ACTION_BATTERY_LOW broadcast is sent in these situations:
         * - is just un-plugged (previously was plugged) and battery level is
         *   less than or equal to WARNING, or
         * - is not plugged and battery level falls to WARNING boundary
         *   (becomes <= mLowBatteryWarningLevel).
         */
        final boolean sendBatteryLow = !plugged
            && mBatteryStatus != BatteryManager.BATTERY_STATUS_UNKNOWN
            && mBatteryLevel <= mLowBatteryWarningLevel
            && (oldPlugged || mLastBatteryLevel > mLowBatteryWarningLevel);

        sendIntent();

        // Separate broadcast is sent for power connected / not connected
        // since the standard intent will not wake any applications and some
        // applications may want to have smart behavior based on this.
        Intent statusIntent = new Intent();
        statusIntent.setFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY_BEFORE_BOOT);
        if (mPlugType != 0 && mLastPlugType == 0) {
            statusIntent.setAction(Intent.ACTION_POWER_CONNECTED);
            mContext.sendBroadcast(statusIntent);
        }
        else if (mPlugType == 0 && mLastPlugType != 0) {
            statusIntent.setAction(Intent.ACTION_POWER_DISCONNECTED);
            mContext.sendBroadcast(statusIntent);
        }

        if (sendBatteryLow) {
            mSentLowBatteryBroadcast = true;
            statusIntent.setAction(Intent.ACTION_BATTERY_LOW);
            mContext.sendBroadcast(statusIntent); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-15T14:01:09.350

该意图是从 BatteryService 触发的。您必须稍微分析一下代码，但我很确定它不会重复触发：

```
http://gitorious.org/android-eeepc/base/blobs/fda6fae156e31a287e3cfbf66e51ea1405cdf479/services/java/com/android/server/BatteryService.java 
```

它触发的实际值是在 android 资源中设置的，因此它只能在系统构建期间进行配置。这是我们的硬件，但对于运行 Android 的每个硬件平台，这可能会有所不同：

```
<!-- Display low battery warning when battery level dips to this value -->
<integer name="config_lowBatteryWarningLevel">15</integer>

<!-- Close low battery warning when battery level reaches this value -->
<integer name="config_lowBatteryCloseWarningLevel">20</integer> 
```

除非您正在开发自定义硬件平台，否则我不会对这些值的设置做出任何假设。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-22T08:57:35.400

还有另一种方法可以从“com.android.internal.R.integer”字段中检测“config_lowBatteryWarningLevel”。

```
enter code here

    try {
        Class clazz = Class.forName("com.android.internal.R$integer");
        Field field = clazz.getDeclaredField("config_lowBatteryWarningLevel");
        field.setAccessible(true);
        int LowBatteryLevel = _context.getResources().getInteger(field.getInt(null));

        Log.d("LowBattery","warninglevel " + LowBatteryLevel);
    } catch (ClassNotFoundException | NoSuchFieldException | IllegalAccessException e) {
        e.printStackTrace();

    } 
```

# python - Matplotlib：quiver 和 imshow 叠加，如何设置两个颜色条？

> ID：11970186
> 
> 赞同：9
> 
> 时间：2012-08-15T13:31:18.950
> 
> 标签：python, matplotlib, visualization, data-visualization, colorbar

我有一个图形，由 显示的图像`imshow()`、轮廓和由 设置的矢量场组成`quiver()`。我根据另一个标量对矢量场进行了着色。在我图的右边，我做了一个`colorbar()`. 这`colorbar()`表示显示的值`imshow()`（在我的情况下可以是正数和负数）。我想知道如何设置另一个颜色条，该颜色条将基于向量颜色所基于的标量值。有谁知道这是怎么做到的吗？

这是我能够制作的图像的示例。请注意，向量的颜色从蓝色变为红色。根据当前的颜色条，蓝色表示负数。但是我知道向量的颜色所代表的数量总是正的。

![在此处输入图像描述](../Images/3d3896a9f8630758f7d878e9fa6871ee.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T15:23:59.840

只需`colorbar`在每次绘图调用后立即调用两次。Pylab 将创建一个与最新绘图匹配的新颜色条。请注意，与您的示例一样，颤动值的范围为 0,1，而 imshow 采用负值。为清楚起见（此示例中未显示），我将使用不同的颜色图来区分这两种类型的图。

```
import numpy as np
import pylab as plt

# Create some sample data
dx = np.linspace(0,1,20)
X,Y = np.meshgrid(dx,dx)
Z  = X**2 - Y
Z2 = X

plt.imshow(Z)
plt.colorbar()

plt.quiver(X,Y,Z2,width=.01,linewidth=1)
plt.colorbar() 

plt.show() 
```

![在此处输入图像描述](../Images/03f9b9e95565d4df79aa35963d7bac23.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-30T15:04:17.720

运行 quiver 不一定会返回所需的可映射对象类型`colorbar()`。我认为这可能是因为我明确地“根据另一个标量对矢量场进行了着色”，就像 Heimdall 所说的那样。因此，Hooked 的回答对我不起作用。

我必须创建自己的可映射颜色条才能读取。我通过使用`Normalize`from`matplotlib.colors`数据来为我的箭袋矢量着色（我将其称为，它是一个与、、和`C`具有相同形状的数组。）`X``Y``U``V`

我的颤抖电话看起来像这样：

```
import matplotlib.pyplot as pl
import matplotlib.cm as cm
import matplotlib.colors as mcolors
import matplotlib.colorbar as mcolorbar
pl.figure()

nz = mcolors.Normalize()
nz.autoscale(C)

pl.quiver(X, Y, U, V, color=cm.jet(nz(C)))
cax,_ = mcolorbar.make_axes(pl.gca())
cb = mcolorbar.ColorbarBase(cax, cmap=cm.jet, norm=nz)
cb.set_label('color data meaning') 
```

给 colorbar 函数提供任何其他参数给了我各种错误。

![我的示例，其中矢量颜色显示第三个数据轴](../Images/c10fad5bb62428d1e8c459a5239a1ca4.png)

# php - 与 android 和 php 的联系人同步

> ID：11970189
> 
> 赞同：0
> 
> 时间：2012-08-15T13:31:31.127
> 
> 标签：php, android, http-post

我需要将我的所有联系人发送到服务器并仅返回正在使用我的应用程序的联系人。我正在使用 HttpPost 将数据发送到服务器。我正在考虑将其作为由分隔符分隔的字符串或作为 NameValuePair 发送。有没有更好的方法来进行联系人同步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:42:20.723

你在使用数据库吗？如果是这样，请创建一个连接到您的数据库的 php web 服务，根据您需要的条件进行查询并返回结果。然后您需要将结果编码到 json 数组中并使用 json 连接您的 android 应用程序并获取结果，这是一个如何在 android 中使用 json 的示例：

[http://www.vogella.com/articles/AndroidJSON/article.html](http://www.vogella.com/articles/AndroidJSON/article.html)

你可以使用更多的库：gson/json/jackson...都类似，你可以在谷歌上搜索并选择你更喜欢的一个

您可以使用 SOAP 而不是 json，我从未使用过它，但您可以尝试：[http ://code.google.com/p/ksoap2-android/](http://code.google.com/p/ksoap2-android/)

**不建议在android上直接连接数据库**

# asp.net-web-api - 当从请求创建 HttpResponseMessage 时，现在应该如何测试 API 控制器？

> ID：11970193
> 
> 赞同：1
> 
> 时间：2012-08-15T13:31:44.690
> 
> 标签：asp.net-web-api

现在，当创建响应`HttpResponseMessage<T>`和内容的构造函数消失了，如果你想测试你的控制器，你应该怎么做？`Request.CreateResponse<T>`应该改为使用，就像这样：

```
public HttpResponseMessage Post()
{
    // Do Something
    var response = Request.CreateResponse<SomeType>(System.Net.HttpStatusCode.OK, someObject);
    return response;
} 
```

现在要测试这样的控制器，我必须对`Request`对象进行存根，因为这是基类上的一个属性，我应该使用它来创建响应，但这不是我喜欢的，我想知道我是否可以通过其他方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:25:08.013

根据我的经验，如果您不需要修改 HttpResponseMessage，请避免在 ApiController 中使用它，这将使您的代码更简单：

```
public SomeType Post()
{
     // Do Something
     return someObject;
} 
```

如果无法避免，这是您的答案：

[使用 Request.CreateResponse 进行 ASP.NET WebApi 单元测试](https://stackoverflow.com/questions/10868673/asp-net-webapi-unit-testing-with-request-createresponse)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T10:56:41.917

如果您不返回 an`HttpResponseMessage`那么 WebApi 将调用 a`MediaTypeFormatter`为您将结果写入响应流（即它将使用 a为您`MediaTypeFormatter`创建一个`HttpResponseMessage`）。许多默认实现将执行类似于您上面的操作。最简单的解决方案是从您的函数返回`SomeType`，然后利用内置`MediaTypeFormatter`s 之一进行转换。您可以单独或一起测试这两种解决方案。

# java - 在 maven/java 项目中创建资源

> ID：11970196
> 
> 赞同：0
> 
> 时间：2012-08-15T13:32:00.250
> 
> 标签：java, maven

如何创建资源以使其位于项目的资源文件夹中？在下文中，“test.txt”是我要创建的文件，但变量：url 为空，所以我无法获得要创建的文件的路径。

```
 URL url= HashArray.class.getResource("test.txt");
    File file = new File(url.toURI()); 
```

该资源可能需要位于资源文件夹中，因为我需要在打包阶段将其与代码捆绑在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:43:12.837

这是行不通的，因为资源不是运行时位置。这是一个源位置。如果您尝试放置一个文件并运行您的程序，则 url 将不再为空。但它会指向您的目标/类文件夹（好吧，有很多可能性，取决于您如何启动它）但是，在大多数情况下，它不再是资源......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:56:14.580

maven 中的资源文件夹和 Java 中的资源之间没有关系。

`class.getResource`在类路径中找到资源，您可以将*txt*文件放在*资源文件夹*中，但为了使其在运行时可访问，您必须将其打包。

[如何打包资源](http://sourceforge.net/apps/mediawiki/fakegame/index.php?title=How_to_handle_resources_with_maven)

# php - Zend Framework - 访问资源类中的控制器和动作名称（继承 Zend_Controller_Resource_ResourceAbstract）

> ID：11970197
> 
> 赞同：0
> 
> 时间：2012-08-15T13:32:00.400
> 
> 标签：php, zend-framework, zend-controller

我需要创建自己的资源，它将一些信息发送到`Zend_View`实例，这取决于当前工作的控制器和操作。我有这个代码：

```
$view = $bootstrap->getResource('layout')->getView();
$front = $bootstrap->getResource('frontController');
$front->setRequest(new Zend_Controller_Request_Http);

$controller = $front->getRequest()->getControllerName();
$action = $front->getRequest()->getActionName();

$view->headTitle(
    $this->getPage()
        ->setController($controller)
        ->setAction($action)
        ->getTitle()
); 
```

但是`$controller`和`$action`是空的。我不知道我是否做错了什么或者在资源中无法访问控制器和操作名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:39:24.187

您无法访问资源中的请求对象，因为它还不存在。请求对象在应用程序启动后发生的调度期间设置。听起来应该将此逻辑移至控制器插件。

# php - 使用 PHP 从 TIMESTAMP 字段中获取通过日期 && 时间

> ID：11970200
> 
> 赞同：0
> 
> 时间：2012-08-15T13:32:10.573
> 
> 标签：php, mysql, sql, datetime

我在名为 created_at 的数据库中有一个字段，并以这种格式存储数据：

```
1980-11-28 04:05:25 
```

所以我想知道自该日期以来已经过去了多少时间，例如：3秒|| 5 分钟 || 22 小时 || 1 天 || 6 周 || 1 个月 || 3 年（注意 || 所以可以是任何选项，而不是全部）。我不知道我是否可以直接从使用 SQL 语言的查询含义中得到这个，我检查了这个 [1] 但找不到正确的函数来执行此操作。所以我想用 PHP 得到它，但要么不知道怎么做。有什么可以帮助我的吗？

[1] [http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:13:41.810

I'm unsure if there is a native PHP function that allows you to do this, however you can make one. I found this one at [http://css-tricks.com/snippets/php/time-ago-function/](http://css-tricks.com/snippets/php/time-ago-function/) and edited it to make it a bit more functional. Using this we can just simply put your `created_at` string through it and get the result.

```
// The function to get the final string
function timeago($tm,$lim=0) {
   $cur_tm = time(); $dif = $cur_tm-$tm;
   $pds = array('second','minute','hour','day','week','month','year','decade');
   $lngh = array(1,60,3600,86400,604800,2630880,31570560,315705600);
   for($v = sizeof($lngh)-1; ($v >= 0)&&(($no = $dif/$lngh[$v])<=1); $v--); if($v < 0) $v = 0; $_tm = $cur_tm-($dif%$lngh[$v]);
   $no = floor($no); if($no <> 1) $pds[$v] .='s'; $x=sprintf("%d %s",$no,$pds[$v]);
   if($lim>1 && ($v >= 1)&&(($cur_tm-$_tm) > 0)) $x .= ', ' . timeago($_tm,$lim-1); else $x .= ' ago';
   return $x;
}

// Run the MySQL query to get the string
$query = mysql_query("SELECT `created_at` FROM `table` LIMIT 1");
// Put the string into a PHP variable
$created_at = mysql_result($query,0);

// Show the results
echo timeago($created_at);
// This will output something like  '4 years ago' or '12 seconds ago'

// You can fine tune how accurate you want the function to make your 'time ago' string to be by adding a number as the second variable for the function
// For example:
echo timeago($created_at, 6);
// This will output something like '4 decades, 2 years, 7 months, 1 week, 15 hours, 49 minutes, 12 seconds ago' 
```

# c# - 读取错误 C#

> ID：11970202
> 
> 赞同：1
> 
> 时间：2012-08-15T13:32:16.983
> 
> 标签：c#, face-recognition

1.  我正在使用 luxand Face SDK 使用 Visual Studio 开发人脸识别应用程序。我正在尝试修改示例应用程序。在应用程序中，样本保存在计算机内存中，但我试图将其写入文件，然后再从中读取。代码摘录如下。

2.  该应用程序运行良好并保存文件。但是，当它尝试读取文件时，应用程序停止工作并且我收到错误“ **LiveRecognition_VS2008.exe 中发生'System.NullReferenceException'类型的未处理异常附加信息：对象引用未设置为对象的实例**”和这部分代码的突出显示“ *br1.Read(t1.templateData, 0, t1.templateData.Length)* ”

3.  请指导我是什么错误。我读错文件了？

```
        struct FaceTemplate { // 单个模板
                公共字节[]模板数据；
            }
            列出 faceTemplates；// 一组人脸模板（我们存储 10 个）

            字符串相机名称；
            布尔需要关闭=假；
            字符串用户名；

            // 释放 FSDKCam.GrabFrame 返回的 HBITMAP 句柄的 WinAPI 过程
            [DllImport("gdi32.dll")]
            静态外部布尔删除对象（IntPtr hObject）；

            公共表格1（）
            {
                初始化组件（）；
            }

            私人无效Form1_Load（对象发送者，EventArgs e）
            {

                if (FSDK.FSDKE_OK != FSDK.ActivateLibrary("# snip serial key #"))
                {
                    MessageBox.Show("请运行许可证密钥向导(开始-Luxand-FaceSDK-许可证密钥向导)", "激活FaceSDK时出错", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    应用程序.Exit();
                }

                FSDK.InitializeLibrary();
                FSDKCam.InitializeCapturing();

                字符串 [] 摄像机列表；
                整数计数；
                FSDKCam.GetCameraList(out cameraList, out count);

                如果（0 ==计数）{
                    MessageBox.Show("请附加相机", "错误", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    应用程序.Exit();
                }

                FSDKCam.VideoFormatInfo [] 格式列表；
                FSDKCam.GetVideoFormatList(ref cameraList[0], out formatList, out count);
                图片框1.Width = formatList[0].Width;
                图片框1.高度=格式列表[0].高度；
                this.Width = formatList[0].Width + 48;
                this.Height = formatList[0].Height + 116;

                相机名称 = 相机列表 [0];
            }

            私人无效Form1_FormClosing（对象发送者，FormClosingEventArgs e）
            {
                需要关闭=真；
            }

            私人无效按钮1_Click（对象发送者，EventArgs e）
            {
                this.button1.Enabled = false;
                int 相机手柄 = 0;

                int r = FSDKCam.OpenVideoCamera(ref cameraName, ref cameraHandle);
                如果 (r != FSDK.FSDKE_OK)
                {
                    MessageBox.Show("打开第一台相机时出错", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
                    应用程序.Exit();
                }
                btnRemember.Enabled = true;

                // 设置实时人脸检测参数
                FSDK.SetFaceDetectionParameters(false, false, 100);
                FSDK.SetFaceDetectionThreshold(3);

                // 列出我们存储人脸模板的位置
                faceTemplates = 新列表（）；

                而（！需要关闭）
                {
                    Int32 图像句柄 = 0;
                    if (FSDK.FSDKE_OK != FSDKCam.GrabFrame(cameraHandle, ref imageHandle)) // 从相机中抓取当前帧
                    {
                        应用程序.DoEvents();
                        继续;
                    }

                    FSDK.CImage 图像 = 新 FSDK.CImage(imageHandle);

                    图像 frameImage = image.ToCLRImage();
                    图形 gr = Graphics.FromImage(frameImage);

                    FSDK.TFacePosition facePosition = image.DetectFace();
                    // 如果检测到人脸，我们可以识别它
                    如果 (facePosition.w != 0)
                    {
                        gr.DrawRectangle(Pens.LightGreen, facePosition.xc - facePosition.w / 2, facePosition.yc - facePosition.w / 2,
                            脸位置.w, 脸位置.w);

                        // 创建一个新的人脸模板
                        FaceTemplate 模板 = 新的 FaceTemplate();

                        if (programState == ProgramState.psRemember || programState == ProgramState.psRecognize)
                            template.templateData = image.GetFaceTemplateInRegion(ref facePosition);

                        开关（程序状态）
                        {
                            case ProgramState.psNormal: // 正常状态 - 什么都不做
                                休息;

                            case ProgramState.psRemember: // 记住我状态 - 存储面部模板
                                faceTemplates.Add(模板);
                                label1.Text = "存储的模板：" + faceTemplates.Count.ToString();

                                if (faceTemplates.Count > 0)
                                {
                                    // 获取用户名
                                    输入名称 inputName = new InputName();
                                    输入名称.ShowDialog();
                                    用户名 = 输入名.用户名；

                                    FileStream fs = File.Open(userName + ".bin", FileMode.Create);
                                    BinaryWriter bw = new BinaryWriter(fs); //打开一个二进制写入器（写入文件流）
                                    bw.Write(template.templateData, 0, template.templateData.Length);
                                    bw.Close();
                                    fs.Close();
                                    programState = ProgramState.psRecognize;
                                }
                                休息;

                            case ProgramState.psRecognize: // 识别用户
                                布尔匹配=假；

                               /*

                                foreach（faceTemplates 中的 FaceTemplate t）
                                {
                                    浮动相似度 = 0.0f;
                                    人脸模板 t1 = t;
                                    FSDK.MatchFaces(ref template.templateData, ref t1.templateData, refsimilarity);
                                    浮动阈值 = 0.0f；
                                    FSDK.GetMatchingThresholdAtFAR(0.01f, 参考阈值); // 将 FAR 设置为 1%
                                    如果（相似度 > 阈值）
                                    {
                                        匹配=真；
                                        休息;
                                    }
                                }

                                */

                                FaceTemplate t1 = 新的 FaceTemplate();
                                FileStream fs1 = File.Open(userName + ".bin", FileMode.Open,FileAccess.Read);
                                BinaryReader br1 = 新的 BinaryReader(fs1);

                                br1.Read(t1.templateData, 0, t1.templateData.Length);
                                浮动相似度 = 0.0f;
                                FSDK.MatchFaces(ref template.templateData, ref t1.templateData, refsimilarity);
                                浮动阈值 = 0.0f；
                                FSDK.GetMatchingThresholdAtFAR(0.01f, 参考阈值); // 将 FAR 设置为 1%
                                如果（相似度 > 阈值）
                                {
                                    匹配=真；
                                }

                                如果（匹配）
                                {
                                    StringFormat 格式 = new StringFormat();
                                    format.Alignment = StringAlignment.Center;

                                    gr.DrawString(userName, new System.Drawing.Font("Arial", 16),
                                        新 System.Drawing.SolidBrush(System.Drawing.Color.LightGreen),
                                        facePosition.xc，facePosition.yc + facePosition.w * 0.55f，格式）；
                                }
                                休息;
                        }
                    }

                    // 显示当前帧
                    图片框1.Image = frameImage;

                    GC.Collect(); // 删除后收集垃圾

                    // 使 UI 控件可访问
                    应用程序.DoEvents();
                }

                FSDKCam.CloseVideoCamera(cameraHandle);
                FSDKCam.FinalizeCapturing();            
            }

            私人无效btnRemember_Click（对象发送者，EventArgs e）
            {
                faceTemplates.Clear();
                programState = ProgramState.psRemember;
                label1.Text = "看相机";
            }
        }
    }

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:46:03.140

`t1.templateData`是`null`。写入时，应先将长度存储到文件中。然后在读取时，读取大小，创建数组，然后读取其内容。

尝试这样的事情：

```
using ( BinaryWriter bw = new BinaryWriter(fs))
{
    bw.Write(template.templateData.Length);
    bw.Write(template.templateData, 0, template.templateData.Length);
}

using( BinaryReader br1 = new BinaryReader(fs1))
{
    int length = br1.ReadInt32();
    t1.templateData = new byte[length];
    br1.Read(t1.templateData, 0, t1.templateData.Length);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T13:48:58.597

你有一个空参考——去`br1.Read(t1.templateData, 0, t1.templateData.Length);`看看哪个没有设置（我打赌`t1.templateData`）

# asp.net-mvc-3 - 如何制作在 CSLA 框架上使用衍生对象的 Kendo UI 批处理网格

> ID：11970203
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:32:16.360
> 
> 标签：asp.net-mvc-3, inheritance, razor, kendo-ui, csla

我试图做的是为保存的产品创建一个“超级”实体类。根据产品在应用程序中的位置，某些额外属性是必需的（但并非总是如此）。

例如，当产品在网格中使用时，我希望有一个派生自实体的 ViewModel（继承所有公共字段），然后添加一个唯一标识符属性，如“rowNumber”，以便剑道 ui 轻松搜索网格 CRUD。

我以为我已经完成了所有这些工作，但我遇到了一个障碍……一切都很好并且运行正常，直到我单击批处理网格的“保存”。它执行该函数并且所有数据都存在，但是当它从 CRUD 返回时，它会中断。在萤火虫中，我看到一个异常被抛出，但它永远不会完成（ajax 微调器停留在那里）并且异常中的所有信息都是空的......

我不确定这是否是 c# 不能很好地与 CSLA 配合使用的问题。我不确定。

任何帮助，将不胜感激！我无法上传图像，因为我的代表不够高，否则我会放一张异常的图片，但我至少会放出 Firebug 控制台中出现的内容。其他关于它的一切都是空的......

**无限执行且无响应的异常：**

```
GET http://localhost:32574/Exception/SystemException/00000000-0000-0000-0000-000000000000 
```

**实体：** 这个文件是由 CodeSmith 模板自动生成的，所以它有点荒谬，但它包含出现在视图中的字段值（见下文）。视图上的内容与实体中的内容的例外是实体中未“展平”的字段，因为 Kendo UI 当前不支持可编辑网格内部的这一点。

**视图模型：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;

namespace Project.MVC.Models
{
    //The MetaData Class is where to put all annotations and validations
    [MetadataType(typeof(Project.Business.Shipment.ItemMetaDataClass))]
    public class ItemModel : Project.Business.Shipment.Item
    {
        public ItemModel()
        {
        }

        public long rowNumber { get; set; }

        public decimal Length { get; set; }
        public decimal Width { get; set; }
        public decimal Height { get; set; }

        [Display(Name = "UoMDim")]
        [UIHint("ItemGrid_RefUnitOfMeasurementListingDimension")]
        public string DimensionUnitOfMeasure { get; set; }

        [Display(Name = "UoMW")]
        [UIHint("ItemGrid_RefUnitOfMeasurementListingWeight")]
        public string WeightUnitOfMeasure { get; set; }

        [Display(Name = "Weight")]
        public decimal WeightValue { get; set; }

        [Display(Name = "Type")]
        [UIHint("ItemGrid_RefUnitTypeListing")]
        public string QuantityUnitOfMeasure { get; set; }

        [Display(Name = "Units")]
        public decimal QuantityValue { get; set; }
}
} 
```

**网格控制器：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using Kendo.Mvc.UI;
using Kendo.Mvc.Extensions;

namespace Project.MVC.Controllers
{
    [Authorize]
    public class ItemGridController : Csla.Web.Mvc.Controller
    {
        public ActionResult GetProducts([DataSourceRequest]DataSourceRequest request)
        {
            Project.MVC.Models.ShipmentModel shipmentModel = (Project.MVC.Models.ShipmentModel)ControllerBase.State.Object;

            return Json(shipmentModel.ItemModelList.ToDataSourceResult(request));
        }

        [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult CreateProducts([DataSourceRequest]DataSourceRequest request, [Bind(Prefix = "models")]IEnumerable<Models.ItemModel> itemsToAdd)
        {
            Project.MVC.Models.ShipmentModel shipmentModel = (Project.MVC.Models.ShipmentModel)ControllerBase.State.Object;
            var results = new List<Models.ItemModel>();

            if (ModelState.IsValid)
            {
                foreach (Models.ItemModel newItem in itemsToAdd)
                {

                    if (shipmentModel.ItemModelList.Count > 0)
                    {
                        var nextID = (from i in shipmentModel.ItemModelList
                                      select i.rowNumber).Max() + 1;

                        newItem.rowNumber = nextID;
                    }

                    shipmentModel.ItemModelList.Add(newItem);
                    results.Add(newItem);
                }
            }

            return Json(results.ToDataSourceResult(request, ModelState));
        }

        [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult UpdateProducts([DataSourceRequest]DataSourceRequest request, [Bind(Prefix = "models")]IEnumerable<Models.ItemModel> itemsToUpdate)
        {
            Project.MVC.Models.ShipmentModel shipmentModel = (Project.MVC.Models.ShipmentModel)ControllerBase.State.Object;
            var results = new List<Models.ItemModel>();

            foreach (var item in itemsToUpdate)
            {
                Models.ItemModel target = shipmentModel.ItemModelList.Find(i => i.rowNumber == item.rowNumber);
                if (target != null)
                {
                    target = item;
                }
            }

            return Json(ModelState.ToDataSourceResult());
        }

        [AcceptVerbs(HttpVerbs.Post)]
        public ActionResult DeleteProducts([DataSourceRequest]DataSourceRequest request, [Bind(Prefix = "models")]IEnumerable<Models.ItemModel> itemsToDelete)
        {
            Project.MVC.Models.ShipmentModel shipmentModel = (Project.MVC.Models.ShipmentModel)ControllerBase.State.Object;

            foreach (var item in itemsToDelete)
            {
                shipmentModel.ItemModelList.Remove(item);
            }

            return Json(ModelState.ToDataSourceResult());
        }
    }
} 
```

**看法：**

```
@model Project.MVC.Models.ShipmentModel
@using Kendo.Mvc.UI

@(Html.Kendo().Grid<Project.MVC.Models.ItemModel>()
    .Name("QuoteItemGrid")
    .Columns(columns =>
    {
        columns.Bound(i => i.FreightClass)
            .EditorTemplateName("ItemGrid_RefFreightClassListing")
            .Width(50);
        columns.Bound(i => i.Length).Width(30);
        columns.Bound(i => i.Width).Width(30);
        columns.Bound(i => i.Height).Width(30);
        columns.Bound(i => i.DimensionUnitOfMeasure)
            .EditorTemplateName("ItemGrid_RefUnitOfMeasurementListingDimension")
            .Width(50);
        columns.Bound(i => i.QuantityValue).Width(30);
        columns.Bound(i => i.QuantityUnitOfMeasure)
            .EditorTemplateName("ItemGrid_RefUnitTypeListing")
            .Width(50);
        columns.Bound(i => i.WeightValue).Width(30);
        columns.Bound(i => i.WeightUnitOfMeasure)
            .EditorTemplateName("ItemGrid_RefUnitOfMeasurementListingWeight")
            .Width(50);
        columns.Bound(i => i.NmfcCode).Width(50);
        columns.Bound(i => i.ItemDescription).Width(100);
        columns.Command(command =>
        {
            command.Destroy();
        }).Width(60);
    })
    .ToolBar(toolbar =>
    {
        toolbar.Create();
        toolbar.Save();
    })
    .Editable(editable => editable.Mode(GridEditMode.InCell).CreateAt(GridInsertRowPosition.Bottom))
    .Pageable()
    .Sortable()
    .Scrollable()
    .Resizable(resize => resize.Columns(true))
    .DataSource(dataSource => dataSource
        .Ajax()
        .Batch(true)
        .ServerOperation(false)
        .Events(events => events.Error("QuoteItemGrid_ErrorHandler"))
        .Model(model =>
        {
            model.Id(i => i.rowNumber);
            model.Field(i => i.DimensionUnitOfMeasure).DefaultValue("in");
            model.Field(i => i.WeightUnitOfMeasure).DefaultValue("lbs");
        })
        .Create(create => create.Action("CreateProducts", "ItemGrid"))
        .Read(read => read.Action("GetProducts", "ItemGrid"))
        .Update(update => update.Action("UpdateProducts", "ItemGrid"))
        .Destroy(destroy => destroy.Action("DeleteProducts", "ItemGrid"))
    )
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T06:52:29.123

我完全同意。理想情况下，基于 CSLA .NET 的对象是*域对象*，而不是数据对象，因此符合业务需求所需的形状，而不是数据库表或查询。

可悲的是，很多人最终（误用）像 ORM 一样使用 CSLA，因此拥有以数据为中心的对象，因此失去了框架的很多价值，并且除了需要创建和维护过于复杂的视图模型类型（应该是）业务类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T14:28:00.093

从架构的角度来看，我的团队最终认为将我们的数据库生成的实体与我们的视图如此紧密地联系起来是不明智的。尤其是现在该项目正在多个地方（.Net 应用程序、Webservices 应用程序等）使用。

因此，最终我们为每个实体创建了 ViewModel，以便我们可以灵活地跨多个平台使用我们的实体。这种重组消除了上述问题，因为实体现在从未出现在视图中。

但是请注意：如果您使用的是 Kendo UI，则必须“展平”您希望在单个组件中呈现的视图模型，这些组件是深层对象（例如，另一个对象中的对象）。目前，剑道并不支持这一点。我们正在使用 ValueInjecter。

希望这些信息也能对其他人有所帮助。

# vba - 非 ActiveSheet 范围内的 QueryTables

> ID：11970206
> 
> 赞同：1
> 
> 时间：2012-08-15T13:32:29.160
> 
> 标签：vba, excel

我一直把`QueryTables`结果放在 中`ActiveSheet`，但现在我想把它们放在另一张纸的一边。在下面的代码中，注释掉的行是我最初的，下面的“with”行是我的新尝试。

```
Dim QuerySheet As WorkSheet

Dim ttt As Integer
Set QuerySheet = ActiveWorkbook.Worksheets("ZZ$Temp$")
QuerySheet.Cells.Clear

QuerySheet.Cells(1, 1) = 1234
QuerySheet.Cells(2000, 50) = 5678

ttt = QuerySheet.Cells(1, 1)

' With ActiveSheet.QueryTables.Add(Connection:="URL;" & qurl, Destination:=DataSheet.Range(Cells(row_stock + iMax, 27), Cells(row_stock + iMax + 199, 27)))
With QuerySheet.QueryTables.Add(Connection:="URL;" & qurl, Destination:=QuerySheet.Range(Cells(row_stock + iMax, 27), Cells(row_stock + iMax + 199, 27)))
    .BackgroundQuery = True
    .TablesOnlyFromHTML = False
    .Refresh BackgroundQuery:=False
    .SaveData = True
End With 
```

我知道工作表存在，我在`1, 1`和处定义内容`2000, 50`。

我得到错误`Run-time error '1004' Method 'Range of object '_worksheet' failed.`

我还尝试激活`QuerySheet`并使用原始`With`.

我怎样才能`QueryTables`把东西放进去`QuerySheet`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T13:37:34.043

您需要在某处设置 QuerySheet。光靠`Dim`是不够的。添加

```
 Dim QuerySheet As WorkSheet
 set QuerySheet = Sheets("querysheet") 
```

（或任何工作表的名称）在您的代码之前。

然后，您必须更改以下内容以仅引用 QuerySheet（适用于 QuerySheet 的所有“单元格”和“范围”使用）。

```
With QuerySheet.QueryTables.Add(Connection:="URL;" & qurl, Destination:=QuerySheet.Range(QuerySheet.Cells(row_stock + iMax, 27), QuerySheet.Cells(row_stock + iMax + 199, 27))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:55:17.777

我发现以下工作。是的，所有表格参考都是必需的！

```
With Sheets("ZZ$Temp$").QueryTables.Add(Connection:="URL;" & qurl, Destination:=Sheets("ZZ$Temp$").Range(Sheets("ZZ$Temp$").Cells(row_stock + iMax, 27), Sheets("ZZ$Temp$").Cells(row_stock + iMax + 199, 27))) 
```

# c# - 如何编写更好的 linq to sql 查询 c#

> ID：11970208
> 
> 赞同：4
> 
> 时间：2012-08-15T13:32:33.310
> 
> 标签：c#, linq-to-sql

我如何编写查询，以便 foreach 不会使用。我目前的查询是：

```
IEnumerable<GuestRSVP> guestrsvps = db.GuestRSVPs.Where(p => p.CeremonyGuestPartyId == CeremonyGuestpartyId);
            foreach (var grsvp in guestrsvps)
            {
                db.GuestRSVPs.DeleteObject(grsvp);
            } 
```

如何在不使用 foreach 循环的情况下删除单个查询中的所有对象？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T13:35:02.337

```
var guestrsvps = db.GuestRSVPs
                   .Where(p => p.CeremonyGuestPartyId == CeremonyGuestpartyId);

db.GuestRSVPs.DeleteAllOnSubmit(guestrsvps);
db.SubmitChanges(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:41:51.597

尝试使用 Delete 方法并将 lambda 谓词传递给。片段应如下所示：

```
db.GuestRSVPs.Delete(p => p.CeremonyGuestPartyId == CeremonyGuestpartyId); 
```

[LINQ to SQL 扩展：使用 Lambda 表达式批量删除](http://weblogs.asp.net/jeffreyzhao/archive/2008/03/06/linq-to-sql-extension-batch-deletion-by-lambda-expression.aspx)

# wpf - 在我的应用程序中全局更改滚动条的宽度

> ID：11970212
> 
> 赞同：0
> 
> 时间：2012-08-15T13:32:56.030
> 
> 标签：wpf, webbrowser-control

我有一个在触摸屏计算机上运行的 WPF 应用程序。我想将应用程序中的所有滚动条更改为更宽。有没有办法在全球范围内做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:59:27.927

哟必须`override the default template of scrollViewer`增加垂直滚动条的宽度。要将模板应用于所有滚动条，请将覆盖样式放在您的应用资源中 -

```
<Style TargetType="{x:Type ScrollViewer}">
  <Setter Property="OverridesDefaultStyle" Value="True"/>
  <Setter Property="HorizontalContentAlignment" Value="Left" />
  <Setter Property="VerticalContentAlignment" Value="Top" />
  <Setter Property="Template">
    <Setter.Value>
      <ControlTemplate TargetType="{x:Type ScrollViewer}">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition/>
          </Grid.ColumnDefinitions>
          <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
          </Grid.RowDefinitions>

          <ScrollContentPresenter Grid.Column="1"/>

          <ScrollBar Name="PART_VerticalScrollBar"
            Value="{TemplateBinding VerticalOffset}"
            Width="40"
            Maximum="{TemplateBinding ScrollableHeight}"
            ViewportSize="{TemplateBinding ViewportHeight}"
            Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
          <ScrollBar Name="PART_HorizontalScrollBar"
            Orientation="Horizontal"
            Grid.Row="1"
            Grid.Column="1"
            Value="{TemplateBinding HorizontalOffset}"
            Maximum="{TemplateBinding ScrollableWidth}"
            ViewportSize="{TemplateBinding ViewportWidth}"
            Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>

        </Grid>
      </ControlTemplate>
    </Setter.Value>
  </Setter>
</Style> 
```

您可以将宽度设置`'PART_VerticalScrollBar'`为您想要的宽度（例如上面示例中的 40）。将此样式放在`Application Resources`(App.xaml) 下使其应用于整个应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:02:00.610

您需要`Style`在 Resources 内部创建一个指示`TargetType`.

此样式将应用于您的 xaml 文件中的所有 ScrollBar。

```
<Window.Resources>
    <Style TargetType="{x:Type ScrollBar}">
        ....
    </Style> 
```

# perl - 你能在 Perl 中对目录及其所有内容进行符号链接吗？

> ID：11970219
> 
> 赞同：1
> 
> 时间：2012-08-15T13:33:45.163
> 
> 标签：perl, unix, symlink

我对 Perl 很陌生，并且已经弄清楚如何对文件进行符号链接。您也可以对目录执行此操作吗？我想在某个目录和一个或多个其他目录之间建立一个符号链接，所以如果我在原始目录中编辑一个文件，更改将在符号链接目录中更新。这可能吗？

编辑：我为给定目录中的文件创建符号链接的 Perl 代码如下。

谢谢

```
#!/usr/bin/perl

$fileDirectory = "/home/Alan/Perl/Files/";
$symLinkDirectory = "/home/Alan/Perl/SymFiles/";

opendir ( DIR, $fileDirectory ) || die "Error in opening directory $fileDirectory\n";

while( ($fileName = readdir(DIR))){
    my $filePath = $fileDirectory.$fileName;
    symlink("$filePath","$symLinkDirectory".$fileName);
}

closedir(DIR); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:54:58.630

是的。在 Unix 文件系统上，当您操作其目录路径以实际上是指向另一个目录的符号链接的前缀开头的文件时，文件操作将自动发生在作为符号链接目标的目录中。

这包括“在符号链接路径上”执行的写入操作，这些操作实际上对真实文件生效；以及对原始目录路径中的文件执行的写入操作，这些操作将从符号链接路径中可见。

这实际上与 Perl 无关，但显然也适用于 Perl：

```
$ perl5.8 -e 'symlink("/HOME/dir1","/HOME/dir2"); 
              use File::Slurp qw(write_file); 
              write_file("/HOME/dir2/myfile", "File lives in dir1\n"); 
              write_file("/HOME/dir1/myfile2","File visible in dir2 too\n");'

$ ls -l /HOME/dir1
total 1
-rw-rw-r--+ 1 USER users 4 Aug 15 09:56 myfile
-rw-rw-r--+ 1 USER users 4 Aug 15 09:56 myfile2

$ ls -l /HOME/dir2
lrwxrwxrwx 1 USER users 22 Aug 15 09:56 /HOME/dir2 -> /HOME/dir1/

$ ls -l /HOME/dir2/myfile2
-rw-rw-r--+ 1 USER users 4 Aug 15 09:56 /HOME/dir2/myfile2

$ ls -l /HOME/dir1/myfile
-rw-rw-r--+ 1 USER users 4 Aug 15 09:56 /HOME/dir1/myfile 
```

*   我有一个真正的目录`dir1`。
*   我符号链接`dir2`指向`dir1`.
*   我在 中创建了一个文件`dir2`，但实际上它是在`dir1`
*   我在`dir1`. 它也可以通过`dir2`（符号链接）访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:38:01.173

符号链接依赖于文件系统。在 Linux 文件系统中，通常可以有目录的符号链接。符号链接不是副本/备份，它们只是一个真实文件/目录的快捷方式。

# java - 如何使用 OpenNLP 实现阿尔巴尼亚语的命名实体识别？

> ID：11970224
> 
> 赞同：4
> 
> 时间：2012-08-15T13:34:04.660
> 
> 标签：java, nlp, opennlp

我正在尝试阿尔巴尼亚语的 OpenNLP。为此，我正在使用 OPenNLP 并尝试为阿尔巴尼亚语的人员、位置和组织实体识别构建模型。我正在构建我自己的语料库，但我需要一位 Open NLP 专家来确认我以下疑问： 1- 我是否应该为每个模型构建一个单独的语料库，例如为 ner-person 构建一个只有标签存在的语料库？2-是否可以在同一语料库中标记人员、位置和组织，并使用它来训练能够提取所有三种实体类型的单个模型？3-是否有资源可以让我找到更多关于 OpenNLP 名称查找器模块中使用的算法的信息？

感谢您的回复，我真的需要您对我的论文的支持

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-12-08T17:07:14.913

1-我应该为每个模型建立一个单独的语料库，例如为ner-person建立一个只存在标签的语料库吗？IMO 是的......但是可以让模型包含多种名称类型。如果将它们分开，您可以更轻松地更新和迭代改进给定名称的模型，特别是如果它们是大型模型。

2-是否可以在同一语料库中标记人员、位置和组织，并使用它来训练能够提取所有三种实体类型的单个模型？是的，这是可能的，但是如果您计划在每种名称类型上构建并优化模型，那么将它们分开对我来说更容易。

3-是否有资源可以让我找到更多关于 OpenNLP 名称查找器模块中使用的算法的信息？最好的做法是下拉源代码并使用一些真实数据逐步执行代码......它基于最大熵。

# php - $ 与作为最后一个字符的换行符之前的位置不匹配

> ID：11970225
> 
> 赞同：2
> 
> 时间：2012-08-15T13:34:07.227
> 
> 标签：php, regex

$ 与作为最后一个字符的换行符之前的位置不匹配。

理想情况下 /1...$/ 应该匹配，但匹配发生在模式 /1....$/ 上，这似乎是错误的。

可能是什么原因？

[PHP 文档](http://www.php.net/manual/en/regexp.reference.anchors.php)还说，美元字符 ($) 是一个断言，仅当当前匹配点位于主题字符串的末尾或紧接在作为字符串中最后一个字符的换行符之前（默认情况下）时才为 TRUE。

```
$subject = 'abc#
123#
';
$pattern = '/1...$/';
preg_match_all($pattern,$subject,$matches); // no match 
```

**更新：** 由于换行符的 \r\n 格式，我怀疑额外的点。我做了以下实验并看到了一些提示。

```
$pattern = '/1...(.)$/';

echo bin2hex($matches[1]); // 28 
```

28 似乎等于 \r (CR) 所以基本上 $ 在 \n 之前而不是在 \r\n 之前匹配，这可能是我的问题的原因。

![在此处输入图像描述](../Images/4639ff838f30fd67253810d68958bbe3.png)

不可打印字符打开后的图像

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:30:55.960

问题是由于窗口文件和 linux 文件的换行符表示不同

为什么这个问题：

*   我在窗口中创建了 php 文件并转移到安装 PHP 的 linux 中。
*   Windows 使用 \r\n 来表示换行符，而 linux \n ==> 这就是为什么最初它需要额外的点来匹配。

下面的实验也证实了这一点：

```
$subject = 'abc#
123#
';
$pattern = '/1...(.)$/';
preg_match_all($pattern,$subject,$matches);
echo bin2hex($matches[1]); // 28 
// 28 is equivalent of \r or CR(carriage return) 
```

在 linux 系统中创建了新文件，并且 /1...$/ 捕获了匹配项:)

如果遇到同样的问题，我希望这可以节省某人的时间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T13:35:53.973

你的字符串是多行的。默认情况下，正则表达式不会做多行。您必须添加`m`修饰符才能发生这种情况。

例如：

```
/1...$/m 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-19T21:20:13.903

我已经在这个问题上停留了两天。我做了很多测试来找到这背后的任何逻辑，因为这完全取决于你的数据来自哪里（内部和受控与外部和不受控制）。在我的情况下，它是我网站上的输入字段 ( `<textarea>`)，可从各种浏览器（和各种操作系统）获得，并且在 JavaScript 中不存在模式测试/匹配/检查的此类问题。对于那些试图解决（或至少解决）在多行模式 (/m) 中的任何行的末尾 ($) 正确匹配模式的问题的人，这里有一个提示。

```
<?php 
// Various OS-es have various end line (a.k.a line break) chars:
// - Windows uses CR+LF (\r\n);
// - Linux LF (\n);
// - OSX CR (\r).
// And that's why single dollar meta assertion ($) sometimes fails with multiline modifier (/m) mode - possible bug in PHP 5.3.8 or just a "feature"(?).
$str="ABC ABC\n\n123 123\r\ndef def\rnop nop\r\n890 890\nQRS QRS\r\r~-_ ~-_";
//          C          3                   p          0                   _
$pat1='/\w$/mi';    // This works excellent in JavaScript (Firefox 7.0.1+)
$pat2='/\w\r?$/mi'; // Slightly better
$pat3='/\w\R?$/mi'; // Somehow disappointing according to php.net and pcre.org when used improperly
$pat4='/\w(?=\R)/i';    // Much better with allowed lookahead assertion (just to detect without capture) without multiline (/m) mode; note that with alternative for end of string ((?=\R|$)) it would grab all 7 elements as expected
$pat5='/\w\v?$/mi';
$pat6='/(*ANYCRLF)\w$/mi';  // Excellent but undocumented on php.net at the moment (described on pcre.org and en.wikipedia.org)
$n=preg_match_all($pat1, $str, $m1);
$o=preg_match_all($pat2, $str, $m2);
$p=preg_match_all($pat3, $str, $m3);
$r=preg_match_all($pat4, $str, $m4);
$s=preg_match_all($pat5, $str, $m5);
$t=preg_match_all($pat6, $str, $m6);
echo $str."\n1 !!! $pat1 ($n): ".print_r($m1[0], true)
    ."\n2 !!! $pat2 ($o): ".print_r($m2[0], true)
    ."\n3 !!! $pat3 ($p): ".print_r($m3[0], true)
    ."\n4 !!! $pat4 ($r): ".print_r($m4[0], true)
    ."\n5 !!! $pat5 ($s): ".print_r($m5[0], true)
    ."\n6 !!! $pat6 ($t): ".print_r($m6[0], true);
// Note the difference among the three very helpful escape sequences in $pat2 (\r), $pat3 and $pat4 (\R), $pat5 (\v) and altered newline option in $pat6 ((*ANYCRLF)) - for some applications at least.

/* The code above results in the following output:
ABC ABC

123 123
def def
nop nop
890 890
QRS QRS

~-_ ~-_
1 !!! /\w$/mi (3): Array
(
    [0] => C
    [1] => 0
    [2] => _
)

2 !!! /\w\r?$/mi (5): Array
(
    [0] => C
    [1] => 3
    [2] => p
    [3] => 0
    [4] => _
)

3 !!! /\w\R?$/mi (5): Array
(
    [0] => C

    [1] => 3
    [2] => p
    [3] => 0
    [4] => _
)

4 !!! /\w(?=\R)/i (6): Array
(
    [0] => C
    [1] => 3
    [2] => f
    [3] => p
    [4] => 0
    [5] => S
)

5 !!! /\w\v?$/mi (5): Array
(
    [0] => C

    [1] => 3
    [2] => p
    [3] => 0
    [4] => _
)

6 !!! /(*ANYCRLF)\w$/mi (7): Array
(
    [0] => C
    [1] => 3
    [2] => f
    [3] => p
    [4] => 0
    [5] => S
    [6] => _
)
 */
?> 
```

不幸的是，我无法访问具有最新 PHP 版本的服务器——我的本地 PHP 是 5.3.8，而我的公共主机的 PHP 是 5.2.17 版本。

# php - mysql导入大sql文件

> ID：11970229
> 
> 赞同：1
> 
> 时间：2012-08-15T13:34:17.947
> 
> 标签：php, mysql, database, phpmyadmin

> **可能重复：**
> [如何将 LARGE sql 文件导入 mysql 表](https://stackoverflow.com/questions/9337855/how-to-import-large-sql-files-into-mysql-table)

使用 php 我通过 odbc 导出了一些表，其中有很多行，它的大小约为 3GB。现在我需要将该表导入我的 mysql 数据库。但是当我尝试

> mysql -u root -p DB_development < HUGEdb.sql

过了一段时间，它说：被杀了。

通过 phpmyadmin 界面，这是不好的。

我的 sql 文件如下所示：

```
INSERT INTO `LINK_LA_TYP` VALUES
 ('1','8917181','1','24','2'),
 ('1','8934610','1','24','1'),
 ('1','9403766','1','30','1'),
 ('1','9422299','1','30','2'),
  many many many so far lines
 ('1','63139389','321','10017','1'); 
```

有什么方法可以导入这样的表吗？（来源和 bigdump 没有帮助）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:43:08.273

你正在杀死缓冲区！即使通过 MyAdmin，您也必须增加 PHP 内存。在尝试这个之前我有过类似的事情：编写一个 php 代码，同时循环这些行并每次清除变量（每行记录一个变量）然后从 PHP.ini 将您的 PHP Exec Time out 更改为 MAX

像这样的东西

```
$mysqlCode= "INSERT INTO `LINK_LA_TYP` VALUES ('1','8917181','1','24','2')";
mysql_query("$mysqlCode");
$mysqlCode=null; 
```

PS：我强烈建议不要推送缓冲区，您可能会超载服务器。最好最大化执行时间并保持刷新垃圾收集器，而不是杀死你的内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:07:25.720

我不知道它对你有什么用，但也许会有所帮助。只是一个建议；

我的转储：[https ://github.com/qeremy/mydump](https://github.com/qeremy/mydump)

您可以使用“mydump”导出您的数据，它会根据您的插入限制导出您的数据（参见_cfg.php:21）。导出后，将您的转储文件解压缩到一个目录，例如`local/muydump`，然后您将需要一些像这样的简单脚本；

```
$files = glob("local/mydump/*.sql");
foreach ($files as $file) {
   $sql = file_get_contents($file);
   $db->query($sql);
} 
```

我已经用这个脚本完成了一些数据库传输几个 gb 的数据（但不记得花了多长时间）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T13:47:06.423

如果语句的长度超过[max_allowed_pa​​cket](http://dev.mysql.com/doc/refman/5.6/en/server-system-variables.html#sysvar_max_allowed_packet)，这是一个数据包或任何生成/中间字符串的最大大小，那么您将无法执行此语句。在这种情况下，您应该将这个非常大的语句拆分为许多小语句。

# javascript - 如何在 setinterval 函数中访问 javascript 数组值

> ID：11970233
> 
> 赞同：0
> 
> 时间：2012-08-15T13:34:39.327
> 
> 标签：javascript

如何从 setinterval 中定义的函数中访问系列数据。当我尝试访问任何值，甚至数组长度时，它会显示未定义。

```
events: {
                load: function() {

                    // set up the updating of the chart each second
                    var series0 = this.series[0];
                    var series1 = this.series[1];
                    var series2 = this.series[2];
                    var series3 = this.series[3];
                    setInterval(function() {
                        var y = $.ajax({url: "/index.php/control/fetch/<?php echo $uid; ?>",async: false}).responseText;
                            y = y.split(" ");
                        var x = parseInt(y[0]);
                        //alert("x = " + series0[0]);
                        //alert("len is " + parseInt(series0.length));
                        series0.addPoint([x, parseFloat(y[1])], true, true);
                        series1.addPoint([x, parseFloat(y[2])], true, true);
                        series2.addPoint([x, parseFloat(y[3])], true, true);
                        series3.addPoint([x, parseFloat(y[4])], true, true);

                    }, 5000);
                }
            } 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:42:43.003

您需要在 setInterval 的回调函数之外**对此进行引用。**像这样的东西：

```
load : function() {
 ...
 var _self = this;
 setInterval(function() {
   console.log( _self.series );
 }, 5000);
} 
```

# spring - 你如何处理将空字符串反序列化为枚举？

> ID：11970238
> 
> 赞同：1
> 
> 时间：2012-08-15T13:34:48.730
> 
> 标签：spring, extjs, jackson

我正在尝试使用 JSON 将表单从 Ext JS 4 提交到 Spring 3 控制器。我正在使用 Jackson 1.9.8 进行序列化/反序列化，使用 Spring 的内置 Jackson JSON 支持。

我在新记录的域对象中有一个状态字段最初为空。提交表单时，它会生成以下 json（缩小到几个字段）

```
{"id":0,"name":"someName","status":""} 
```

提交后在服务器日志中看到以下内容

```
"nested exception is org.codehaus.jackson.map.JsonMappingException: Can not construct instance of com.blah.domain.StatusEnum from String value '': value not one of the declared Enum instance names" 
```

因此，杰克逊似乎期望一个有效的枚举值或根本没有值，包括一个空字符串。无论是在 Ext JS、Jackson 还是 Spring 中，我该如何解决这个问题？

我试图创建自己的 ObjectMapper，例如

```
public class MyObjectMapper extends Object Mapper {
    public MyObjectMapper() {
        configure(DeserializationConfig.Feature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT, true);
    }
} 
```

并将其作为属性发送给 MappingJacksonMappingView 但这不起作用。我也尝试将它发送到 MappingJacksonHttpMessageConverter 但这没有用。附带问题：我应该在自己的 ObjectMapper 中发送哪个？

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-26T18:23:27.737

您可以做的另一件事是`org.codehaus.jackson.map.JsonDeserializer`为您的特定枚举创建一个专门的反序列化器（extends），它对不匹配的事物具有默认值。我所做的是为枚举创建一个抽象的反序列化器，它采用它反序列化的类，当我遇到问题时它会加快这个过程。

```
public abstract class EnumDeserializer<T extends Enum<T>> extends JsonDeserializer<T> {
    private Class<T> enumClass;

    public EnumDeserializer(final Class<T> iEnumClass) {
        super();
        enumClass = iEnumClass;
    }

    @Override
    public T deserialize(final JsonParser jp,
                         final DeserializationContext ctxt) throws IOException, JsonProcessingException {
        final String value = jp.getText();
        for (final T enumValue : enumClass.getEnumConstants()) {
            if (enumValue.name().equals(value)) {
                return enumValue;
            }
        }
        return null;
    }
} 
```

那是通用类，基本上只需要一个枚举类，迭代枚举的值并检查下一个标记以匹配任何名称。如果他们这样做，则返回它，否则返回 null；

然后如果你有一个枚举 MyEnum 你会创建一个`EnumDeserializer`像这样的子类：

```
public class MyEnumDeserializer extends EnumDeserializer<MyEnum> {
    public MyEnumDeserializer() {
        super(MyEnum.class);
    }
} 
```

然后无论您在哪里声明`MyEnum`：

```
@JsonDeserialize(using = MyEnumDeserializer.class)
public enum MyEnum {
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:03:52.473

我不熟悉 Spring，但以防万一，在客户端处理它可能更容易：

```
Ext.define('My.form.Field', {
    extend: 'Ext.form.field.Text',

    getSubmitValue: function() {
        var me = this,
            value;

        value = me.getRawValue();

        if ( value === '' ) {
            return ...;
        }
    }
}); 
```

您还可以通过将其`allowBlank`属性设置为 来禁止提交空字段`false`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T13:48:51.923

最终在 EXT JS 模型中添加了默认值，因此总是有一个值。希望我不必这样做，但这没什么大不了的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-17T08:01:22.007

我有同样的问题。我正在读取带有一些空字符串的 JSON 流。我无法控制 JSON 流，因为它来自外部服务。而且我总是收到相同的错误消息。我在这里试过这个：

```
mapper.getDeserializationConfig().with(DeserializationConfig.Feature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT); 
```

但是没有任何效果。看起来像个虫子。

# java - 如何使用 WebDriver 更改 textarea 中的文本

> ID：11970240
> 
> 赞同：2
> 
> 时间：2012-08-15T13:34:58.063
> 
> 标签：java, webdriver, htmlunit

我无法使用 WebClient/HtmlUnit/Java 更改 textarea 中的文本。我试图用谷歌搜索它，但没有运气。任何人都可以帮忙吗？有源代码：

```
WebDriver driver = new HtmlUnitDriver();
driver.get("http://some_site.com");
driver.findElement(By.id("niEditor")).sendKeys("some value");
String test = findElement(By.id("niEditor")).getText(); // no changes 
```

和html中的标签：

```
<textarea class="tinyMCE newitem2" id="niEditor" name="description"> MANY TEXT </textarea> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T05:51:09.060

我这样做的方式（它对我有用）

```
driver.findElement(By.id("niEditor")).clear();
driver.findElement(By.id("niEditor").sendKeys("data"); 
```

第一行代码实际上将焦点转移到可能导致问题的文本区域。试试这个代码，让我们知道它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T19:36:24.443

为了获取文本，请使用以下命令：

```
String test = driver.FindElement(By.Id("niEditor")).GetAttribute("value"); 
```

这是用 C# 编写的，但在 Java 中应该有一个等价的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-13T23:50:36.790

如果清除和发送密钥无济于事：

`webdriver.findElement(<locator of previous element>).sendKeys(Keys.TAB, Keys.chord(Keys.COMMAND, "a"), "This text will replace text in textarea");`

# asp.net-mvc-3 - MVC3项目_Layout中的User.Identity.Name返回错误的用户

> ID：11970243
> 
> 赞同：3
> 
> 时间：2012-08-15T13:35:02.010
> 
> 标签：asp.net-mvc-3

在视图中，我们只有：@User.Identity.Name

除了我们的生产环境之外，一切都在每个环境中都能正常工作。如果 2 个或更多用户不断刷新他们的浏览器，最终返回的名称不是他们自己的。似乎这可能是一个缓存问题，但是缓存了什么，为什么？这种行为在 IE 和 Chrome 中是一致的，所以它不是一些时髦的 IE 缓存问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:09:51.897

我们在这里找到了解决方案：

[ASP.Net Httpcontext.Current.User 显示最后一个产生线程的用户](https://stackoverflow.com/questions/8939249/asp-net-httpcontext-current-user-shows-last-user-who-spawned-thread)

原来我只需要在 web.config 中添加以下内容：

```
<caching enabled="false" /> 
```

# jquery - jquery加载到iframe的父级

> ID：11970244
> 
> 赞同：0
> 
> 时间：2012-08-15T13:35:02.780
> 
> 标签：jquery, ajax, coldfusion

我有一个提交给 iframe 的表单。该框架处理coldfusion页面（基于表单输入，附件可以添加到Oracle中的项目。）有一个div，带有类测试，显示项目上当前附加的文档。我需要做的是，如果用户添加了附件然后提交了表单，请使用正确的附件重新加载“测试”div。这是我尝试过的对我不起作用的方法：

```
<!--- This is in my coldfusion processing page, after the form submit --->
<SCRIPT LANGUAGE="JAVASCRIPT">
$(document).ready(function(){
    $('.testing', parent.document).load('itemAttachments.cfm?_cf_nodebug=true&itemID=' + selectedItem, function(){
        alert();
    });
}); 
```

我什至没有收到警报，所以我知道这种语法在某种程度上是错误的。有谁看到我做错了什么？或者，还有其他方法可以做到这一点吗？谢谢。

**编辑**

如果这令人困惑：

**用户加载显示项目属性的初始表单，包括附加的文档>>用户可以选择附加新文档>>项目通过“附加”按钮附加，但直到实际表单提交>>在表单提交时才存储在数据库或服务器中，如果附加了新文档，它应该使用新的正确信息重新加载“测试”div（显示附加文档的 div）（即：它应该显示用户刚刚添加的文档）**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:35:04.670

正确的范围是 window.parent.document。

# asp.net - ASP.net gridview 在每条记录后评估数据字段

> ID：11970245
> 
> 赞同：1
> 
> 时间：2012-08-15T13:35:12.210
> 
> 标签：asp.net, gridview

嘿，我想知道是否可以在每次将新记录放入一行时评估数据字段？

我的gridview代码是这样的：

```
<asp:Panel ID="pnlGrid" runat="server">
    <div class="left_main_container" style="margin-bottom:20px;">
        <asp:GridView ID="grdView" runat="server" CssClass="GridViewStyle"
            AutoGenerateColumns="False" GridLines="None" Width="100%">
            <Columns>
                <asp:BoundField DataField="id" Visible="False" />
                <asp:BoundField DataField="theName" HeaderText="Name" />
                <asp:BoundField DataField="status" HeaderText="Status" />
            </Columns>
            <RowStyle CssClass="RowStyle" />
            <EmptyDataRowStyle CssClass="EmptyRowStyle" />
            <PagerStyle CssClass="PagerStyle" />
            <SelectedRowStyle CssClass="SelectedRowStyle" />
            <HeaderStyle CssClass="HeaderStyle" />
            <EditRowStyle CssClass="EditRowStyle" />
            <AlternatingRowStyle CssClass="AltRowStyle" />
        </asp:GridView>
    </div>
</asp:Panel> 
```

我需要评估的领域是状态。我需要找出状态是**yes**还是**no**。如果它**不是**，那么我需要将其设置为用户能够将其更改为**yes**的链接。

网格视图由以下代码填充：

```
 Dim objConn As MySqlConnection
    Dim objCmd As MySqlCommand

    objConn = New MySqlConnection(strConnString)
    objConn.Open()

    Dim strSQL As String
    strSQL = "SELECT id, status, " & _
                "CONCAT(' ', first_name, last_name) AS theName " & _
             "FROM(builder_requests) " & _
             "ORDER BY status, id DESC;"

    Dim dtReader As MySqlDataReader
    objCmd = New MySqlCommand(strSQL, objConn)
    dtReader = objCmd.ExecuteReader()

    grdView.DataSource = dtReader
    grdView.DataBind()

    dtReader.Close()
    dtReader = Nothing

    objConn.Close()
    objConn = Nothing 
```

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:47:02.680

我喜欢在你的代码隐藏中使用一个 TemplateField 和一个函数来做这种事情。

我假设您的状态字段是一个字符串字段而不是布尔值，但如果不让我知道，我可以调整示例。

替换你`BoundField`的...

标记：

```
 <asp:TemplateField>
            <ItemTemplate>
                <%# Eval("status")%>&nbsp;
                <asp:LinkButton ID="cmdChangeStatus" runat="server" CommandName="ChangeStatusToYes" CommandArgument='<%# Eval("id") %>'
                    Visible='<%# SetChangeStatusVisibility(Eval("status")) %>'>Change to Yes</asp:LinkButton>
            </ItemTemplate>
        </asp:TemplateField> 
```

并在函数后面添加代码...

代码：

```
Protected Function SetChangeStatusVisibility(status As Object) As String
    Dim strStatus As String = status.ToString()
    If strStatus = "no" Then
        Return "True"
    Else
        Return "False"
    End If
End Function 
```

然后您可以处理`GridView.RowCommand`事件以根据 CommandArgument 中的 id 值更改状态值:)

# python - 后台python程序检查GUI事件

> ID：11970246
> 
> 赞同：0
> 
> 时间：2012-08-15T13:35:18.467
> 
> 标签：python, wxpython

我正在考虑编写一个在后台运行并可以检查用户的 GUI 事件的 python 程序。

我的要求很简单：

1）当用户右键单击鼠标时，它可以显示一个选项；and when this option is chosen, my program should know this event.

2）当用户选择一个文件并单击一些预定义的组合键时，我的程序应该知道这个事件。

我应该怎么办？这是一个 GUI 程序吗？我也在想，这个程序可能是机器上的一个守护进程，可以检查用户的 GUI 事件，但我不确定我该怎么做。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T05:22:34.233

我一直在研究这个问题，虽然我没有明确的答案，但我认为分享我的发现会很好。

首先，根据[this question](https://stackoverflow.com/questions/10990643/wxpython-set-cursor-to-absolute-screen-location-and-click)的答案，wxPython无法跟踪或控制鼠标位置超出wxPython应用程序控制的区域。但是，正如我们在[这个问题](https://stackoverflow.com/questions/3337973/set-global-hotkey-with-python-2-6)的答案中看到的那样，**在某些情况下**，可以创建 wxPython 可以看到的系统范围的热键（尽管我们也可以看到这可能不是最佳解决方案）。

那么什么对 OP 有用呢？好吧，构建一个执行 OP 想要的跨平台应用程序似乎几乎是不可能的，所以我假设 OP 正在为 MS Windows 开发。按照前两个问题中的建议，我研究了[PyWin32 API](http://sourceforge.net/projects/pywin32/)。找到它的文档有点困难，但[这个问题](https://stackoverflow.com/questions/5481686/why-cant-i-find-any-pywin32-documentation-resources)提供了一些有用的链接。再深入一点，我发现[本教程适用于系统范围的热键](http://timgolden.me.uk/python/win32_how_do_i/catch_system_wide_hotkeys.html)以及[win32event.WaitForMultipleObjects](http://timgolden.me.uk/pywin32-docs/win32event__WaitForMultipleObjects_meth.html)和[win32event.WaitForSingleObject](http://timgolden.me.uk/pywin32-docs/win32event__WaitForSingleObject_meth.html)方法，如果 OP 可以找出正确的事件，则可能是 OP 需要捕获菜单点击的方法。

我知道这远非一个完整的答案，但希望这可以作为进一步研究的良好起点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T19:15:10.540

如果你说的是在 wxPython 程序中做这些事情，那么这一切都非常简单。第一个有一个 PopupMenu 小部件，第二个有一个 AcceratorTable。如果您想在 wxPython 程序之外捕获鼠标和键盘事件，那么您必须进入非常底层并挂钩到操作系统本身，这意味着确实没有任何好的方法可以跨平台. 你可能会想看看 ctypes 和类似的库来做那种事情。

# iphone - iOS 入门

> ID：11970249
> 
> 赞同：0
> 
> 时间：2012-08-15T13:35:28.577
> 
> 标签：iphone, xcode, ios4

我有一个我已经开发的 Android 应用程序，我的任务是为 iOS 平台重新创建它，该平台可以追溯到 iOS 4。

我已经购买了 Apple Developer License，并且我已经购买了 Mac Mini 并在其上安装了 XCode 4.4.1。我一直在尝试完成我发现的一些关于切换视图的各种教程，但我无法让它们中的任何一个工作。他们中的大多数人谈论在 IDE 中创建窗口应用程序或导航应用程序，但显然 4.4.1 以不同的方式做事，因为我在教程显示它们的地方看不到这些选项。然后，当打开引用的文件时，文件中的条目比教程开始时显示的要多得多。这两天我一直在摆弄这个，但仍然没有一个简单的无操作应用程序，只是在视图之间来回切换，这相当令人沮丧。

我查看了一些 4.4.1 教程，但它们似乎都使用了与 iOS 4 不兼容的情节提要。

有人对适用于 XCode 4.4.1 如何创建项目文件的 iOS 4 开发教程有任何建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T13:37:56.163

您可能应该从 iTunes U 上的斯坦福课程开始。它们是免费的，它们让您对最新最好的 iOS 有一个很好的基本了解。

从那里我会查看 treehouse.com 和 www.raywenderlich.com 上的教程。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:43:37.307

试试[Kirby Turner 和 Tom Harrington 的 Learning iPad Programming——](https://rads.stackoverflow.com/amzn/click/com/0321750403)它将引导您完成一个完整的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:46:29.363

这是我用过的书，我觉得它很棒。[开始 iPhone 4 开发](https://rads.stackoverflow.com/amzn/click/com/1430216263)(Apress)。

当然，这不会向您展示 iOS 5 的处理方式，即故事板，它们不能在 iOS 4 应用程序中使用。

除此之外，我在 google apple docs 上注意到，当您搜索某些内容时，并不总是首先出现，所以我会添加 google 站点参数，例如：“UIDocumentInteractionController site:developer.apple.com”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T19:38:35.670

你有几个问题需要克服，我认为你应该一次处理一个：

*   学习 Objective-C
*   在当前版本中通过故事板学习与 XCode 相处
*   学习在当前版本中与 XCode 相处，并且仍然使用旧的 NIB 文件而不是故事板。

所以这是我的建议

*   使用情节提要完成较新的教程。我喜欢 Ray Wenderlich 的那些。这样你就可以熟悉一般概念并学习 Objective-C
*   在新 XCode 版本中使用 NIB 文件而不是故事板构建应用程序，然后根据需要完成旧教程。如果您下载旧的完整项目会更好。

我不建议使用旧的 Xcode 版本，可以在这里找到[https://developer.apple.com/downloads/index.action](https://developer.apple.com/downloads/index.action)

# php - 使用 mcrypt 加密敏感数据

> ID：11970252
> 
> 赞同：1
> 
> 时间：2012-08-15T13:35:50.400
> 
> 标签：php, security, mcrypt, sensitive-data

大家好，我有一个关于加密/解密个人敏感信息的安全问题：身份（姓名、地址、电话号码）、银行详细信息（排序代码和帐号）授权人使用个人数据。现在主要的问题是： 1\. 我的方法足够安全吗？
2.有没有更好的方法？
3\. 我应该在哪里使用来自数据库或 $_SESSION 的密钥？（最好在哪里使用它们进行解密，以便用户查看他的详细信息）

这是代码：
`$iv = mcrypt_create_iv(32, MCRYPT_RAND);
$key = mcrypt_create_iv(32, MCRYPT_RAND);
$encrypted = mcrypt_encrypt(MCRYPT_RIJNDAEL_256, $key, $unencrypted, MCRYPT_MODE_CBC, $iv);`

那是为了在我将数据发送到数据库之前对其进行加密

`$decrypted = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, $key, $encrypted, MCRYPT_MODE_CBC, $iv );`

这就是解密方法。（使用上面示例中的 $encrypted、$key 和 $iv）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T15:23:44.767

加密任何敏感信息并将密钥存储在数据库中没有安全优势。这与锁定保险箱并将钥匙留在钥匙孔中相同。至少您需要将密钥存储在文件系统上，而不是数据库中。在这种情况下，如果您的数据库被泄露（例如由于 SQL 注入攻击），攻击者将无法解密它，因为他们没有密钥。

**编辑** 没有办法保护包含密钥的文件，因为 PHP 需要读取它才能进行所需的操作。但是，您可以使用 HSM（硬件安全模块）设备将密钥存储在那里。以[YubiHSM](http://yubico.com/yubihsm)为例。

# jira - 将 Rally 中的描述字段配置为纯文本

> ID：11970256
> 
> 赞同：0
> 
> 时间：2012-08-15T13:35:54.673
> 
> 标签：jira, rally, jira-plugin

我正在使用 RallyConnectorforJira-Ruby-2.7.4 在 Rally 和 JIRA 之间同步问题，但是 Rally 中的描述字段使用 HTML/Rich Text 并在同步时将标签插入到 JIRA 的描述字段中。例如

```
<div>
</div>
<div>Updating the description to see if sync is working the other way.</div>
<div>
</div>
<div>Another update, this time changing state to Open in Rally, which should move the issue to In Progress in JIRA. Also, will the JIRALink field now get picked up?</div>
<div>
</div>
<div>Will it let me move this to re-opened?</div>
<div></div>
<div>Changed the workflow in JIRA to see if this breaks the integration - will it update, but error, or not update at all?</div>
<div>
</div>
<div>Fixing the workflow - this should move to In Progress</div> 
```

JIRA 正在使用默认文本渲染器，并根据[http://www.rallydev.com/help/jira-installation-user-guide上的说明](http://www.rallydev.com/help/jira-installation-user-guide) *“您可以选择让任一系统中的描述字段仅包含纯文本，没有任何标记。”* ，但我在 Rally 中找不到任何说明或设置，可让我将描述字段定义为 Rally 中的纯文本。

如果我登录 Rally 并选择 Setup -> Workspaces -> Projects & Workspaces -> -> Work Products and Fields -> Description -> Edit 我会看到以下内容：

*   名称：描述
*   显示名称：说明
*   类型：文本
*   隐藏：未选中
*   出现次数：20
*   必需：未选中

但没有选项可以更改类型或仅指定纯文本。

是否可以将 Rally 中的描述字段设置为纯文本，以便在源字段中不插入 HTML 标记？或者我应该设置 jira_config.xml 中的某些内容来告诉它从 Rally 对面的字段中删除 HTML 标记？

谢谢，

安德鲁。

# php - 使用 PHP 在 Oracle 中将图像上传为 BLOB

> ID：11970258
> 
> 赞同：9
> 
> 时间：2012-08-15T13:35:55.910
> 
> 标签：php, oracle, upload, blob

谁能告诉我如何使用 PHP 将图像作为 BLOB 存储在 Oracle 数据库中？

一个工作的例子会很好。谢谢你。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-15T13:44:17.587

`$_FILES`您首先需要从#global 数组中获取正在上传的图像：

```
$image = file_get_contents($_FILES['image_field_name']['tmp_name']); 
```

然后在数据库中插入图像试试这个：

```
$sql = "INSERT INTO table (id, image) VALUES(1, empty_blob()) RETURNING image INTO :image";

$result = oci_parse($connection, $sql);
$blob = oci_new_descriptor($connection, OCI_D_LOB);
oci_bind_by_name($result, ":image", $blob, -1, OCI_B_BLOB);
oci_execute($result, OCI_DEFAULT) or die ("Unable to execute query");

if(!$blob->save($image)) {
    oci_rollback($connection);
}
else {
    oci_commit($connection);
}

oci_free_statement($result);
$blob->free(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-30T18:29:55.797

您也可以使用 PDO：

```
<?php

   include '../conexao_oracle.php';

   $db = $pdo;
   $db->beginTransaction(); // Essential!
   $mimetype = 'image/jpeg';
   $funcionario_id = 10;
   $stmt = $db->prepare(
       "INSERT INTO foto (mimetype, binario, funcionario_id) ".
       "VALUES (:mimetype, EMPTY_BLOB(), :funcionario_id) ".
       "RETURNING binario INTO :binario");
   $stmt->bindParam(':mimetype', $mimetype);
   $stmt->bindParam(':binario', $blob, PDO::PARAM_LOB);
   $stmt->bindParam(':funcionario_id', $funcionario_id);
   $blob = fopen('fotos/10.jpg', 'rb');
   $stmt->execute();
   $pdo->commit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-12T08:25:30.870

谢谢 DRiFTy，我在您的示例上构建了我的小型 JSON 查询。让我们澄清一下，您可以使用这两个示例保存大图像。

```
<?php
// Database parameters
$oci_user = 'YOUR_DB_USER';
$oci_pw = 'YOUR_DB_PASSWORD';
$oci_db = "(DESCRIPTION=(ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 000.000.000.000)(PORT = 1521)))(CONNECT_DATA=(SID=XXX)))"; 

// Get data from JSON imput
$data = json_decode(file_get_contents("php://input"),true);

// Now you can do some checks on date etc.
$img = $data['IMAGE'];
$jfid = $data['OBJECT_ID'];
$jfdate = $data['DATE'];

// Let's beginn with the blob upload
// We have 3 fiels in our table: OBJECT_ID,DATE,BLOBIMAGE
// First you fill your BLOB with an 'Empty' one and assign in PL/SQL style :img
$sql = "INSERT INTO ZAEHLER.METERAPP_BILD (OBJECT_ID,DATE,BLOBIMAGE)
VALUES (".$jfid.",to_date('".$jfdate."','DD/MM/YYYY'),empty_blob())
RETURNING BLOBIMAGE INTO :img";

$result = oci_parse($conn, $sql);
$blob = oci_new_descriptor($conn, OCI_D_LOB);
oci_bind_by_name($result, ":img", $blob, -1, OCI_B_BLOB);
oci_execute($result, OCI_NO_AUTO_COMMIT);

// Now let's check if we could connect to database or if we have to output something => 500
if(!$result){
    $err = oci_error();
    header('HTTP/1.0 500 Internal Server Error');
    header('Content-Type: application/json');
    $out = array('code' => '500', 'response' => '500 Internal Server Error / SQL connection problem', 'error sql' => $err[message]);
    echo json_encode($out);
}
// Can we same the image ($img) or not => 406
// This step saves the image to the db
if(!$blob->save($img)) {
    oci_rollback($conn);
    header('HTTP/1.0 406 Not Acceptable');
    header('Content-Type: application/json');
    $out = array('code' => '406', 'response' => '406 Not Acceptable / Wrong image type or JSON error');
    echo json_encode($out);
}
// If both was ok, we're going to commit and output an OK => 200
else {
    oci_commit($conn);
    header('HTTP/1.0 200 OK');
    header('Content-Type: application/json');
    $out = array('code' => '200', 'response' => '200 OK', 'response advanced' => 'Image saved', 'object_id' => $jfid, 'file date' => $jfdate);
    echo json_encode($out);
}

// Clean up
oci_free_statement($result);
$blob->free();
?> 
```

# google-maps - 谷歌地图标记的问题

> ID：11970259
> 
> 赞同：0
> 
> 时间：2012-08-15T13:36:08.363
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

正如您在我的[test.php](http://myrange.de/support/map/test.php)中看到的，标记工作正常。但是当我缩放地图以获得更好的概览时，标记会向北移动？？？如果我放大很多，标记移动到北海:-(这是一个已知的错误吗？还是我做错了什么？

```
<!DOCTYPE html>
<html>
<head>
<title>MyRange Driving Ranges world wide </title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=yes" />

<style type="text/css">
html { height: 100% }
body { height: 100%; margin: 30px; padding: 0px }
#map_canvas { height: 80% }
</style>
<script type="text/javascript"
  src="https://maps.google.com/maps/api/js?sensor=true">
</script>
<script type="text/javascript">
function initialize() {
var latlng = new google.maps.LatLng(51.1601369818597, 6.72036588191986);
var myOptions = {
  zoom: 16,
  center: latlng,
  mapTypeId: google.maps.MapTypeId.HYBRID
};
var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

var image = 'images/flag_red_big.png';

var myLatLng = new google.maps.LatLng(51.1601369818597, 6.72036588191986);
var golfMarker = new google.maps.Marker({ position: myLatLng, map: map, icon: image });

}
</script>
</head>
<body onload="initialize()">
<div align="center" id="map_canvas" style="width:100%; height:100%"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:00:12.043

图标的默认[锚点](https://developers.google.com/maps/documentation/javascript/reference#MarkerImage)（如果您没有定义它，您会得到它）位于图像的底部中心。

您需要使用[MarkerImage](https://developers.google.com/maps/documentation/javascript/reference#MarkerImage)的实例完全指定图标。

仅供参考 - 您的图标似乎移动了，因为标志底部和图像底部之间有很多空白空间（这是它当前锚定的位置）。

# php - 使用 SID 和 INSTANCE_NAME 将 oracle 与 pdo 连接

> ID：11970261
> 
> 赞同：3
> 
> 时间：2012-08-15T13:36:13.607
> 
> 标签：php, oracle, pdo

如何使用 PDO::__construct() 连接到 Oracle。

我拥有的是主机、端口、SID 和 INSTANCE_NAME。

寻找我创建的信息

```
 CONNECT username@[//]host[:port][/service_name][:server][/instance_name] 
```

在[http://docs.oracle.com/cd/E18283_01/network.112/e10836/naming.htm#i498306](http://docs.oracle.com/cd/E18283_01/network.112/e10836/naming.htm#i498306)，但我不知道如何将其“翻译”为 PDO。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:52:51.703

尝试这个：

```
oci:dbname=//host:port/SID/INSTANCE_NAME 
```

并查看[http://www.php.net/manual/en/ref.pdo-oci.connection.php](http://www.php.net/manual/en/ref.pdo-oci.connection.php)了解更多信息。用户名是单独传递的。

# c++ - 创建用 C (MFC) 格式化的字符串

> ID：11970264
> 
> 赞同：3
> 
> 时间：2012-08-15T13:36:25.020
> 
> 标签：c++, visual-studio-2010, mfc

如何在 VC++ (Visual Studio 2010) 中创建格式化字符串？

我可以这样创建：

```
CString str;
str.Format("%d bla %d", 10, 20); 
```

但我想要类似的东西：

```
CString str = MACRO_OR_FUNCTION("%d bla %d", 10, 20); 
```

我知道如何实现它，但如果它是由 MFC 实现的，我更喜欢使用它。

我的问题是：这是 MFC 中的宏或函数还是一些stand lib？例如，如果在 MFC 中有它，我将不会实现我的版本。我会更喜欢使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T14:54:20.237

你需要声明一个函数。

```
CString fn_s_Format( LPCTSTR pctszFormat, ... )
{
    CString s ;

    va_list argList;
    va_start( argList, pctszFormat );
    s.FormatV( pctszFormat, argList );
    va_end( argList );

    return s ;
} 
```

# c# - C# Excel 2010 工作簿打开错误

> ID：11970265
> 
> 赞同：6
> 
> 时间：2012-08-15T13:36:25.477
> 
> 标签：c#, excel-2010

我们最近从 Excel 2007 升级到 Excel 2010，我们发现现有代码开始失败。

异常消息：

> Office 检测到此文件存在问题。为帮助保护您的计算机，无法打开此文件。

我们已将其追溯到打开文件的行

```
excelApp.Workbooks.Open 
```

即使手动打开文件，受保护的视图消息框也会出现。

我们如何使用 C# 来解决这个问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-17T04:17:48.703

在您的声明之前查看使用[Application.FileValidation 属性 (Excel) 。](http://msdn.microsoft.com/en-us/library/office/ff822746.aspx)`Open`

> 返回或设置 Excel 在打开文件之前如何验证文件。读/写
> 
> 未通过验证的文件将在受保护的视图窗口中打开。如果您设置 FileValidation 属性，该设置将在应用程序打开的整个会话期间保持有效。

[您可以将其设置为MsoFileValidationMode 枚举](http://msdn.microsoft.com/en-us/library/microsoft.office.core.msofilevalidationmode.aspx)中的枚举值之一

> msoFileValidationDefault
> 
> msoFileValidationSkip

如果你将它设置`msoFileValidationSkip`在`Open`语句之前，它应该绕过检查。

就像是

```
excelApp.FileValidation = MsoFileValidationMode.msoFileValidationSkip; 
```

在公开声明之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-23T18:05:56.667

这里游戏迟到了，但这是一个常见的烦恼：您需要定义一个“受信任的位置”。

当您的代码尝试打开电子表格文件并且 *“Office 检测到此文件存在问题。为了帮助保护您的计算机，无法打开此文件”时，您并不是唯一遇到此问题的开发人员。*是一个非常无用的错误信息。

查看 Daniel Pineault 于 2010 年在 DevHut.net 上发布的可信位置代码：

[DevHut 代码示例：使用 VBScript 的可信位置](http://www.devhut.net/2010/06/23/vbscript-createset-trusted-location-using-vbscript/ "DevHut 代码示例：使用 VBScript 的可信位置")

我会因为在 C# 论坛上发布 VBA 而被拒绝投票，所以我最好不要发布 Daniel 代码的实现（是的，我是 VBA 开发人员，整天都在抨击 VBA 宏，而不是真正的编码员）尖尖的东西和花括号）。如果你真的想看 VBA，在另一篇帖子的回复中：

[https://stackoverflow.com/questions/2962728/office-trusted-locations/28115700#28115700](https://stackoverflow.com/questions/2962728/office-trusted-locations/28115700#28115700 "受信任位置的 VBA 代码")

我相信正确的称呼是“分享和享受”。

如果您重复使用该代码，请对原作者 Daniel Pineault 表示感谢：它已在“专家”网站上广泛发布，但未注明出处，这是相当粗鲁的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-04T10:54:22.703

我们有同样的问题。我们在 SQL 服务器上的 SSIS 包使用 Excel.Interop 来解析文件。有一天，我们在新服务器上安装了 Office 2010 x64，某些文件开始出现错误：

> Office 检测到此文件存在问题。为帮助保护您的计算机，无法打开此文件。

同时，其他服务器运行良好。我们发现 Excel 版本的区别：14.04763.1000 不起作用，但 14.0.7015.1000 对我们有用。最后一个版本号属于 Office 2010 SP2。最终我们下载了SP2并安装了它，结果错误消失了。

# vb.net - 尝试将数据库查询转换为字符串时出错

> ID：11970267
> 
> 赞同：0
> 
> 时间：2012-08-15T13:36:30.333
> 
> 标签：vb.net, asp.net-mvc-3

我正在尝试从数据库中提取一个整数，但出现错误

我在控制器中的代码是：

```
 Dim SeqNumQuery = From a In db.RequestedServices
                          Where a.RequestedServiceId = id
                          Select a.StationId

        Dim StationId As Integer = SeqNumQuery.ToString 
```

错误是：

范围变量“StationId”隐藏封闭块中的变量或先前在查询表达式中定义的范围变量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:41:09.977

我认为问题在于您的变量 ,`StationId`已在同一范围内的某处声明。尝试更改为：

```
Dim SeqNumQuery = From a In db.RequestedServices
                          Where a.RequestedServiceId = id
                          Select a.StationId

StationId = SeqNumQuery.ToString 
```

但请查看其他变量的用途。如果需要，请使用`StationId`变量名以外的其他名称，例如`RequestedServicesStationId`.

有关此错误的更多信息：

[范围变量隐藏封闭块中的变量或先前在查询表达式中定义的范围变量。](http://msdn.microsoft.com/en-us/library/bb763096%28v=vs.90%29.aspx)

* * *

在旁注中，我不明白您为什么使用`.ToString`扩展方法。这不会导致您的脚本引发异常，但是我建议将其更改为[`CInt()`](http://msdn.microsoft.com/en-us/library/s2dy91zy%28v=vs.71%29.aspx)：

```
StationId = CInt(SeqNumQuery) 
```

# maven - 将测试资源从一个子模块复制到其他子模块

> ID：11970270
> 
> 赞同：4
> 
> 时间：2012-08-15T13:36:37.853
> 
> 标签：maven

我有一个像这样的多模块 Maven 项目：

```
-project
+-sub-project1
+-sub-project2 
```

对于我的 JUnit 测试，我`persistence.xml`在`sub-project1/src/test/resources/META-INF`. 该项目是子项目2的依赖项，这样，我希望子项目2的测试使用与子项目1相同的测试persistence.xml，但它没有发生。

所以，我想知道为什么我可以让 maven 在测试阶段自动将此文件复制到其他子模块......也许我把这个文件放在文件`project/resources`夹中会更好，例如，然后复制它们......

我希望有人已经设法以某种方式工作，并且可以帮助我或展示如何做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T14:13:18.490

我设法让它像这样工作：

我创建了一个`project/assembly/test/resources/META-INF/persistence.xml`文件，并将其添加到我的 pom.xml 中：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-resources-plugin</artifactId>
    <executions>
        <execution>
            <id>copy-test-persistence-xml-resources</id>
            <phase>process-test-sources</phase>
            <goals>
                <goal>copy-resources</goal>
            </goals>
            <configuration>
                <outputDirectory>src/</outputDirectory>
                <resources>
                    <resource>
                        <directory>${project.parent.basedir}/assembly/</directory>
                        <filtering>true</filtering>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

它优雅地工作。

# c# - System.Forms.SaveFileDialog 的 OverwritePrompt 未翻译

> ID：11970274
> 
> 赞同：0
> 
> 时间：2012-08-15T13:36:53.887
> 
> 标签：c#, winforms

我正在使用 System.Forms.SaveFileDialog 。我的操作系统中的母语是日语。保存现有文件时，覆盖提示状态“xxx 已存在，您要替换它吗？” ，不应该是日语而不是英语，因为系统语言环境是日语？阿里加托..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T18:25:42.967

SaveFileDialog 类是围绕操作系统实现的对话框的薄包装器。你会在记事本中看到完全相同的内容。该对话框显示警告消息，而不是 .NET 代码。IFileDialog::SetOptions() 方法，FOS_OVERWRITEPROMPT 选项。默认情况下启用。

因此，您需要查看您的操作系统配置是否存在问题。就像英文版的 Windows，切换到日文作为默认语言。它使支持日语本地化的程序（包括 .NET）显示日语，但将所有操作系统对话框保留为英语。或者拥有安装了英语和日语语言包的终极版以及将 Thread.CurrentCulture 切换为英语的一些代码。如果不是您的代码，那么行为不端的 shell 扩展可以做到这一点。

# sql-server - SQL Server 查询按条件获取最后分组的行

> ID：11970282
> 
> 赞同：0
> 
> 时间：2012-08-15T13:37:21.793
> 
> 标签：sql-server, sql-server-2008, tsql

我有简单的 SQL Server 查询：

```
declare @table table (id int, name nvarchar(5), deleted bit)

insert into @table(id, name, deleted) values(1, 'A1', 0)
insert into @table(id, name, deleted) values(2, 'A1', 0)
insert into @table(id, name, deleted) values(3, 'A1', 0)
insert into @table(id, name, deleted) values(4, 'A1', 1)
insert into @table(id, name, deleted) values(5, 'A2', 0)
insert into @table(id, name, deleted) values(6, 'A2', 0)

select
    max(id) as id,
    name
from @table
where deleted = 0
group by name 
```

它返回到行

```
id  |name
--------------
3   |A1
6   |A2 
```

但应该只返回一个

```
id  |name
-------------- 
6   |A2 
```

因为 A1 的最后一个（或最大）id 被删除。

如何修复我的查询。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:43:02.527

因为你可以有这样的第三组：

```
insert into @table(id, name, deleted) values(7, 'A3', 1)
insert into @table(id, name, deleted) values(8, 'A3', 0) 
```

我假设您也希望返回以下内容，因为该名称的最高 id*未*标记为已删除：

```
id    name
----  ----
8     A3 
```

然后这个查询应该这样做：

```
;WITH x AS 
(
  SELECT id, name, deleted, 
    rn = ROW_NUMBER() OVER (PARTITION BY name ORDER BY id DESC)
  FROM @table
)
SELECT id = MAX(id), name 
FROM x
WHERE NOT EXISTS
(
  SELECT 1 FROM x AS x2 
  WHERE name = x.name 
  AND deleted = 1 AND rn = 1
)
GROUP BY name; 
```

如果您只希望在*没有*删除特定名称的行的情况下返回行，那么它会稍微简单一些：

```
SELECT id = MAX(id), name
FROM @table AS t
WHERE NOT EXISTS 
(
  SELECT 1 FROM @table 
  WHERE name = t.name AND deleted = 1
)
GROUP BY name; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T13:58:54.347

另一种方法：[http ://www.sqlfiddle.com/#!3/697d7/5](http://www.sqlfiddle.com/#!3/697d7/5)

```
create table t(id int, name nvarchar(5), deleted bit)

insert into t(id, name, deleted) values(1, 'A1', 0)
insert into t(id, name, deleted) values(2, 'A1', 0)
insert into t(id, name, deleted) values(3, 'A1', 0)
insert into t(id, name, deleted) values(4, 'A1', 1)
insert into t(id, name, deleted) values(5, 'A2', 0)
insert into t(id, name, deleted) values(6, 'A2', 0)

with no_deletions as
(
  select name
  from t
  group by name
  having max(nullif(cast(deleted as int),0)) is null
)
select    
    max(id) as id,
    name    
from t
where name in (select name from no_deletions)
group by name 
```

输出：

```
| ID | NAME |
-------------
|  6 |   A2 | 
```

# c# - 当 WPF 中 ItemsSource 的大小发生变化时如何闪烁应用程序背景？

> ID：11970286
> 
> 赞同：0
> 
> 时间：2012-08-15T13:37:40.347
> 
> 标签：c#, wpf, xaml, triggers

我的顶部菜单中显示了错误通知列表。

```
<MenuItem Header="{Binding NotificationList.UnreadCount}"
    HeaderStringFormat="Notifications ({0})"
    ItemsSource="{Binding NotificationList.Notifications}">
 </MenuItem> 
```

我想做的是通过将背景颜色更改为红色然后返回（ColorAnimation，1s，AutoRevert）来“闪烁”应用程序，每次 NotificationList 的大小发生变化（并且大于零）。NotificationList 已在视图更改时通知视图。

任何人都可以帮助我编写正确的**触发器以更改 ItemsSource 的大小**并在此触发器内**更改应用程序窗口的背景颜色**（而不是元素本身）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:51:04.827

我不知道如何使用触发器执行此操作，但您可以创建一个[附加行为](http://www.codeproject.com/Articles/28959/Introduction-to-Attached-Behaviors-in-WPF)，将处理程序添加到 ItemsSource 的 CollectionChanged 事件。

前提是您的主窗口的背景设置为 SolidColorBrush，如下所示

```
<Window ...>
    <Window.Background>
        <SolidColorBrush Color="{x:Static SystemColors.ControlColor}"/>
    </Window.Background>
    ...
</Window> 
```

这种附加行为可能如下所示：

```
public class ItemsControlBehaviours
{
    public static readonly DependencyProperty BlinkMainWindowOnItemsSourceChangeProperty =
        DependencyProperty.RegisterAttached(
            "BlinkMainWindowOnItemsSourceChange", typeof(bool), typeof(ItemsControlBehaviours),
            new PropertyMetadata(BlinkMainWindowOnItemsSourceChangePropertyChanged));

    public static bool GetBlinkMainWindowOnItemsSourceChange(ItemsControl itemsControl)
    {
        return (bool)itemsControl.GetValue(BlinkMainWindowOnItemsSourceChangeProperty);
    }

    public static void SetBlinkMainWindowOnItemsSourceChange(ItemsControl itemsControl, bool value)
    {
        itemsControl.SetValue(BlinkMainWindowOnItemsSourceChangeProperty, value);
    }

    private static void BlinkMainWindowOnItemsSourceChangePropertyChanged(
        DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        ItemsControl itemsControl = obj as ItemsControl;
        INotifyCollectionChanged collection;

        if (itemsControl != null &&
            (collection = itemsControl.ItemsSource as INotifyCollectionChanged) != null)
        {
            if ((bool)e.NewValue)
            {
                collection.CollectionChanged += ItemsSourceCollectionChanged;
            }
            else
            {
                collection.CollectionChanged -= ItemsSourceCollectionChanged;
            }
        }
    }

    private static void ItemsSourceCollectionChanged(
        object sender, NotifyCollectionChangedEventArgs e)
    {
        SolidColorBrush background =
            Application.Current.MainWindow.Background as SolidColorBrush;

        if (background != null)
        {
            ColorAnimation backgroundAnimation = new ColorAnimation
            {
                To = Colors.Red,
                Duration = TimeSpan.FromSeconds(1),
                AutoReverse = true
            };

            background.BeginAnimation(
                SolidColorBrush.ColorProperty, backgroundAnimation);
        }
    }
} 
```

请注意，这里的闪烁颜色和持续时间是硬编码的，您可能必须找到一种方法来参数化它们。

您现在可以在设置了 ItemsSource 属性的任何 ItemsControl 上使用此行为：

```
<ListBox ItemsSource="..." Background="Transparent"
    local:ItemsControlBehaviours.BlinkMainWindowOnItemsSourceChange="True" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T16:13:52.943

这可能不像您想要的那么简单，但它可以满足您的需求。所有这些代码都在我的测试工具的主窗口中，因此可能需要更改某些内容以适应您的具体情况。这个想法是一样的。

我们需要做的第一件事是设置自己以在集合更改时获取事件。我使用了一个可观察的集合，因为如果你正在绑定，我会假设这就是你正在使用的：

```
 ObservableCollection<String> m_NotificationList;
  // Propertized for binding purposes
  public ObservableCollection<String> NotificationList
  {
     get
     {
        return m_NotificationList;
     }
  }

  public MainWindow()
  {
     InitializeComponent();

     this.DataContext = this;

     m_NotificationList = new ObservableCollection<string>() { "hey", "ho", "lets", "go" };
     m_NotificationList.CollectionChanged += CollectionChangeCallback;
  } 
```

下一步是定义一些路由事件，我们可以在需要闪烁时将其发送到窗口。我们在主窗口的类定义中这样做，如上：

```
 public static readonly RoutedEvent FlashEvent =
     EventManager.RegisterRoutedEvent("Flash",
     RoutingStrategy.Tunnel, typeof(RoutedEventHandler), typeof(MainWindow));

  public event RoutedEventHandler Flash
  {
     add { AddHandler(FlashEvent, value); }
     remove { RemoveHandler(FlashEvent, value); }
  } 
```

现在我们需要在集合更新时定义回调，再次在主窗口的类定义中：

```
void CollectionChangeCallback(object sender, EventArgs e)
{
   // Don't fire if we don't want to flash
   if (m_NotificationList.Count > 0)
      window.RaiseEvent(new RoutedEventArgs(FlashEvent));
} 
```

现在我们转到 XAML 并向我们的 MainWindow 添加一个触发器，它处理我们刚刚创建的路由事件并执行我们想要执行的动画：

```
<Window.Triggers>
   <EventTrigger RoutedEvent="local:MainWindow.Flash" >
      <BeginStoryboard>
         <Storyboard>
            <ColorAnimation AutoReverse="True"
                                  Duration="0:0:1"
                                  FillBehavior="Stop"
                                  From="White"
                                  Storyboard.TargetName="window"
                                  Storyboard.TargetProperty="Background.Color"
                                  To="Red" />
         </Storyboard>
      </BeginStoryboard>
   </EventTrigger>
</Window.Triggers> 
```

这可以按照您在我的测试工具中的要求工作。这有点尴尬，但我找不到更好的方法来做到这一点。为清楚起见，我还将在此处包含带有代码隐藏的 XAML。它是一个空窗口，带有一个 MenuItem 和一个向集合添加字符串的按钮。您可以看到闪光以及事件如何结合在一起以实现它。

XAML：

```
<Window x:Class="WPFTestbed.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WPFTestbed"
        x:Name="window"
        Title="MainWindow"
        Width="525"
        Height="350">

   <Window.Triggers>
      <EventTrigger RoutedEvent="local:MainWindow.Flash" >
         <BeginStoryboard>
            <Storyboard>
               <ColorAnimation AutoReverse="True"
                                     Duration="0:0:1"
                                     FillBehavior="Stop"
                                     From="White"
                                     Storyboard.TargetName="window"
                                     Storyboard.TargetProperty="Background.Color"
                                     To="Red" />
            </Storyboard>
         </BeginStoryboard>
      </EventTrigger>
   </Window.Triggers>

   <StackPanel>
      <MenuItem x:Name="menu"
                Header="{Binding NotificationList.Count}"
                HeaderStringFormat="Notifications ({0})"
                ItemsSource="{Binding NotificationList}">
      </MenuItem>
      <Button Click="Button_Click"
              Content="Hi" />
   </StackPanel>
</Window> 
```

后面的代码（-包括空间）：

```
namespace WPFTestbed
{
   /// <summary>
   /// Interaction logic for MainWindow.xaml
   /// </summary>
   public partial class MainWindow : Window
   {
      public static readonly RoutedEvent FlashEvent =
         EventManager.RegisterRoutedEvent("Flash",
         RoutingStrategy.Tunnel, typeof(RoutedEventHandler), typeof(MainWindow));

      public event RoutedEventHandler Flash
      {
         add { AddHandler(FlashEvent, value); }
         remove { RemoveHandler(FlashEvent, value); }
      }

      ObservableCollection<String> m_NotificationList;

      public ObservableCollection<String> NotificationList
      {
         get
         {
            return m_NotificationList;
         }
      }

      public MainWindow()
      {
         InitializeComponent();

         this.DataContext = this;

         m_NotificationList = new ObservableCollection<string>() { "hey", "ho", "lets", "go" };
         m_NotificationList.CollectionChanged += CollectionChangeCallback;
      }

      void CollectionChangeCallback(object sender, EventArgs e)
      {
         if (m_NotificationList.Count > 0)
            window.RaiseEvent(new RoutedEventArgs(FlashEvent));
      }
      private void Button_Click(object sender, RoutedEventArgs e)
      {
         m_NotificationList.Add("Another");
      }
   }
} 
```

# javascript - 基于 jQuery cookie 打开和关闭面板

> ID：11970290
> 
> 赞同：0
> 
> 时间：2012-08-15T13:37:56.390
> 
> 标签：javascript, jquery

我有以下变量来存储一组 cookie 的值：

```
var filterDate = $.cookie('filterDate');
    var filterArea = $.cookie('filterArea');
    var filterCategory = $.cookie('filterCategory');
    var filterType = $.cookie('filterType');
    var filterLevel = $.cookie('filterLevel');
    var filterAge = $.cookie('filterAge');
    var filterAttendance = $.cookie('filterAttendance'); 
```

cookie 和变量的名称也是页面上某些元素的 id，例如：`<div id="filterDate"></div>`

我想要做的是非常最低限度（即尽可能少的代码）是检查是否有任何具有 open 的值，如果是，则运行里面的代码。

```
if (filterDate == 'open' || filterArea == 'open' || filterCategory == 'open' || filterType == 'open' || filterLevel == 'open' || filterAge == 'open' || filterAttendance == 'open') {
    $('#' + filter).find('.menuBox.nav ul').show();
    $('#' + filter).find('.menuBox.nav p').hide();
    $('#' + filter.find('h3 span').addClass('active');
} 
```

如何使上述内容`filter`适用于所有 cookie，而不必为每个 cookie 和面板复制它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:44:50.690

一个紧凑的解决方案可能是：

```
//The array below allows you to easily add new filters
var filterNames = ["filterDate", "filterArea", ..., "filterAttendance"];
for (var i in filterNames) {
    var filterName = filterNames[i];
    var filterStatus = $.cookie(filterName);
    if (filterStatus == 'open') {
        $('#' + filterName).find('.menuBox.nav ul').show();
        $('#' + filterName).find('.menuBox.nav p').hide();
        $('#' + filterName.find('h3 span').addClass('active');
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:46:50.720

我不清楚您是否希望根据过滤器名称触发不同的功能。如果是这样，您可以存储映射到 cookie 的所有函数，然后遍历 cookie 的名称，如果为真则触发相关函数：例如

```
var cookieList = ["filterDate", "filterArea"...];
var cookieMap = {"filterDate"=filterDateFn, "filterArea"=filterAreaFn...};

for (var i=0; i<numCookies; i++) {
if ($.cookie(cookieList[i]) == "open") {cookieMap[cookieList[i]]();} 
```

如果您只想运行一个函数，那么您可以跳过制作 cookieMap，只运行您想要的任何成功触发器，然后在该点中断 for 循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:52:31.510

制作一个 cookie 名称数组，然后生成一个对象（键：对值的映射），其中键是数组中的项目，值是适当 cookie 的值。然后使用循环遍历数组/对象：

```
var filters = ['filterA', 'filterB', 'filterC'],
    cookies1 = {},
    cookies2 = {};
for(var i = 0, f; f = filters[i++];) {
    // really here will be $.cookie(f); instead of 'open':
    cookies1[f] = cookies2[f] = 'open';
}

// make one of second cookies set 'closed' for testing purpose:
cookies2['filterA'] = 'closed';

function allOpen(cookies) {
    for(var i in cookies) {
        if(cookies[i] != 'open') {
            return false;
        }
    }
    return true;
}

alert(allOpen(cookies1) + ', ' + allOpen(cookies2));
​ 
```

# c# - MVC4 捆绑 CSS 失败意外令牌，找到“@import”

> ID：11970293
> 
> 赞同：51
> 
> 时间：2012-08-15T13:38:27.210
> 
> 标签：c#, asp.net-mvc, bundle, asp.net-optimization

我正在尝试使用捆绑来组合和缩小一些 CSS 文件。在我的 Global.aspx.cs`Application_Start`我有以下内容：

```
 var jsBundle = new Bundle("~/JSBundle", new JsMinify());
    jsBundle.AddDirectory("~/Scripts/", "*.js", false);
    jsBundle.AddFile("~/Scripts/KendoUI/jquery.min.js");
    jsBundle.AddFile("~/Scripts/KendoUI/kendo.web.min.js");
    BundleTable.Bundles.Add(jsBundle);

    var cssBundle = new Bundle("~/CSSBundle", new CssMinify());
    cssBundle.AddDirectory("~/Content/", "*.css", false);
    cssBundle.AddDirectory("~/Content/themes/base/", "*.css", false);
    cssBundle.AddFile("~/Styles/KendoUI/kendo.common.min.css");
    cssBundle.AddFile("~/Styles/KendoUI/kendo.default.min.css");
    BundleTable.Bundles.Add(cssBundle); 
```

在我的 .cshtml 文件中，我有以下内容：

```
<link href="/CSSBundle" rel="stylesheet" type="text/css" />
<script src="/JSBundle" type="text/javascript"></script> 
```

但是，当我查看我的 bundles CSS 文件的源代码时，它具有以下内容：

```
/* Minification failed. Returning unminified contents.
(40,1): run-time error CSS1019: Unexpected token, found '@import'
(40,9): run-time error CSS1019: Unexpected token, found '"jquery.ui.base.css"' 
```

.... 更多

关于如何解决这个问题的任何想法？

我确实将其缩小到以下行：

```
cssBundle.AddDirectory("~/Content/themes/base/", "*.css", false); 
```

如果我只有那行代码，我会得到同样的错误。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-08-28T20:33:35.073

这里有几个问题：

1.  css 问题是由于包含 jquery.ui.all.css，因为默认的 minifier 不支持以下导入，无论如何这不是您想要做的，因为它会双重包含所有 jquery ui css 文件。所以你想要做的不是使用 *.css，而是明确列出你想要包含的 jquery ui 文件：

    ```
     bundles.Add(new StyleBundle("~/Content/themes/base/css").Include(
            "~/Content/themes/base/jquery.ui.core.css",
            "~/Content/themes/base/jquery.ui.resizable.css",
            "~/Content/themes/base/jquery.ui.selectable.css",
            "~/Content/themes/base/jquery.ui.accordion.css",
            "~/Content/themes/base/jquery.ui.autocomplete.css",
            "~/Content/themes/base/jquery.ui.button.css",
            "~/Content/themes/base/jquery.ui.dialog.css",
            "~/Content/themes/base/jquery.ui.slider.css",
            "~/Content/themes/base/jquery.ui.tabs.css",
            "~/Content/themes/base/jquery.ui.datepicker.css",
            "~/Content/themes/base/jquery.ui.progressbar.css",
            "~/Content/themes/base/jquery.ui.theme.css")); 
    ```

2.  其次，您希望使用 Script/Styles.Render 方法，而不是像您正在做的那样显式引用捆绑 url，因为在调试模式下，帮助程序不会自动捆绑/缩小和呈现对每个脚本/样式资产的单独引用，并且还将捆绑内容的指纹附加到 url 中，以便浏览器缓存可以正常工作。

    ```
    @Scripts.Render("~/JSBundle") and @Styles.Render("~/CSSBundle") 
    ```

3.  您还可以使用 StyleBundle/ScriptBundle，它只是语法糖，无需传入新的 Css/JsMinify。

您还可以查看本教程以获取更多信息： [捆绑教程](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-25T18:17:20.253

或者，如果您当然需要这种灵活性，您可以为 CssMinify 编写自己的 BundleTransform。因此，例如，您在 BundleConfig.cs 中的代码如下所示：

```
using System;
using System.Web.Optimization;
using StyleBundle = MyNamespace.CustomStyleBundle;

public class BundleConfig
{
    public static void RegisterBundles(BundleCollection bundles)
    {
        bundles.Add(new StyleBundle("~/Content/themes/base/css")
            .IncludeDirectory("~/Content/themes/base", "*.css"));
    }
} 
```

那么你需要添加的是：

```
public class CustomStyleBundle : Bundle
{
    public CustomStyleBundle(string virtualPath, IBundleTransform bundleTransform = null)
        : base(virtualPath, new IBundleTransform[1]
            {
                bundleTransform ?? new CustomCssMinify()
            })
    {
    }

    public CustomStyleBundle(string virtualPath, string cdnPath, IBundleTransform bundleTransform = null)
        : base(virtualPath, cdnPath, new IBundleTransform[1]
            {
                bundleTransform ?? new CustomCssMinify()
            })
    {
    }
}

public class CustomCssMinify : IBundleTransform
{
    private const string CssContentType = "text/css";

    static CustomCssMinify()
    {
    }

    public virtual void Process(BundleContext context, BundleResponse response)
    {
        if (context == null)
            throw new ArgumentNullException("context");
        if (response == null)
            throw new ArgumentNullException("response");
        if (!context.EnableInstrumentation)
        {
            var minifier = new Minifier();
            FixCustomCssErrors(response);
            string str = minifier.MinifyStyleSheet(response.Content, new CssSettings()
            {
                CommentMode = CssComment.None
            });
            if (minifier.ErrorList.Count > 0)
                GenerateErrorResponse(response, minifier.ErrorList);
            else
                response.Content = str;
        }
        response.ContentType = CssContentType;
    }

    /// <summary>
    /// Add some extra fixes here
    /// </summary>
    /// <param name="response">BundleResponse</param>
    private void FixCustomCssErrors(BundleResponse response)
    {
        response.Content = Regex.Replace(response.Content, @"@import[\s]+([^\r\n]*)[\;]", String.Empty, RegexOptions.IgnoreCase | RegexOptions.Multiline);
    }

    private static void GenerateErrorResponse(BundleResponse bundle, IEnumerable<object> errors)
    {
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.Append("/* ");
        stringBuilder.Append("CSS Minify Error").Append("\r\n");
        foreach (object obj in errors)
            stringBuilder.Append(obj.ToString()).Append("\r\n");
        stringBuilder.Append(" */\r\n");
        stringBuilder.Append(bundle.Content);
        bundle.Content = stringBuilder.ToString();
    }
} 
```

如果您需要更多修复/错误，您可以在 FixCustomCssErrors 方法中扩展此逻辑。

# c# - 使用多个类时，一般处理 Try/Catch 块和错误的正确方法是什么？

> ID：11970294
> 
> 赞同：3
> 
> 时间：2012-08-15T13:38:27.153
> 
> 标签：c#, error-handling, try-catch, structure

我试图在这里理解程序的正确结构以促进一切。基本上在哪里“放”东西。

例如：

你有 2 节课。

1类是你的主要。

这两个类都有很多方法。

类 1 调用类 2 的一个实例并运行一个方法。该方法应该返回一个值。

问题 1：我应该在这个方法里面有一个 try/catch 块吗（在第 2 类中）？

问题 2：try/catch 块是否应该在我调用方法的地方（在第 1 类中）？

```
try
   method();
catch
... 
```

问题3：在执行类2中的方法时，当涉及到返回值时，我是否应该返回“错误代码”然后在调用类中处理此代码？

问题 4：当发生错误并且我需要“停止”程序时，我应该使用 if/else 语句以便代码仅在满足正确条件时才继续前进，还是应该更频繁地使用关键字“break”？

问题 5：出错的可能性是无穷无尽的，特别是如果你有大中型程序。你们如何处理用户运行程序时可能遇到的不可知错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T13:41:35.997

例外就是：例外。您不应该对常规程序流程使用异常。（如果你说，“哦，是的，我预料到了”，它可能不应该是一个例外。）

在需要处理的地方处理异常。如果您可以在该`try-catch`块不成功的情况下生存该功能，那么您应该在那里处理它。同样，如果您需要包装一些东西，您也可以添加一个`finally`块（`using`类似于`finally`C# 中的 - 它编译为`try-finally`，但不如自己编写它强大。它只是调用`.Dispose()`您指定的一次性对象）。

但是，如果您需要退出该函数，或者您正在运行一系列函数，这些函数需要在您的主类中全部成功，那么在您的 Class 1 中进行处理可能会更好。

**警告：**每条规则都有例外（哈！）。随着您编写更多程序，您可以直观地了解应该在哪里进行错误处理 - 但通常会有多个选项，并且可能不是很明确。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T13:41:52.567

一般来说，所有这些问题的答案都是“视情况而定”。显然，您需要做什么取决于情况的具体情况及其包含的应用程序。

从实践的角度来看，我通常遵循几个规则：
1\. 使用异常处理而不是错误代码
2\. 只有在我知道如何处理异常时才使用 try/catch

显然，在不知道该方法的作用以及您是否可以处理任何异常的情况下，没有人可以告诉您是否需要在方法中使用 try/catch。

错误代码是否真的适用取决于您。我一般认为它不适用；但是，有时它可能是。*在这些情况下，如果调用者总是*使用代码而不是传递它，我只认为它是适用的。“GetErrorCode”可能是错误代码适用的一个很好的例子。

您不可能“处理”（即补偿）“未知”错误。推荐的做法是不处理异常并让句柄优雅地终止，因为它处于未知状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:47:47.150

我大体上同意 David 和 Peter ...我要补充的一件事是要小心捕获异常时捕获的异常... [Richter](https://rads.stackoverflow.com/amzn/click/com/0735627045)有一个非常有趣的章节，关于异常处理以及应该如何继承异常与它们的实际实现方式相比......但即使如此，如果你发现自己一直在捕捉通用 Exception 类，它（IMO）仍然是懒惰的，或者至少是考虑不周的......

如果您正在执行文件读取/写入，您可能非常希望捕获适当的 IO 异常，但是如果说，如果抛出 NullReferenceException 并且您的 try/catch 只是保护，那么始终捕获最通用的 Exception 类可能会导致您遇到问题针对 IO 异常...您的 catch 块会尝试修复（假设是）一个 IO 异常，它可能会使您的代码处于非常不稳定的状态。

此外，在继续重新抛出原始错误时要非常小心，除非您确信您确实正确地处理了它......如果您编写了一个库并发布了它并吞下了所有错误，因为您认为自己在做最好的事情，那么使用您的库的人将无法调试正在发生的事情......异常也会被抛出到服务器日志中，因此被吞下的错误永远不会出现。

我主张捕获通用错误的一个地方是在 UI 层，您显然不想向用户显示 YSOD，但即便如此，您的捕获也可能会做一些日志记录或其他帮助您稍后调试的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T13:49:24.217

捕获异常并返回错误代码/布尔值会导致“箭头”代码，如下所示：

```
if(Func1())
{
   if (Func2())
   {
       if (Func3())
       {
       }
   }
} 
```

不幸的是，我维护了一个复杂的项目，其中异常被视为埃博拉病毒，并在它们萌芽时立即被遏制。它实际上只是让代码更难理解和维护。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T13:52:40.090

这取决于您如何可视化和构建应用程序。第 1 类和第 2 类是同一模块的一部分还是在不同的模块中？一般来说，一个模块提供“API”，“API”的调用者需要捕获错误和异常。看看[防御性编程](http://en.wikipedia.org/wiki/Defensive_programming)。

> 问题 1：我应该在这个方法里面有一个 try/catch 块吗（在第 2 类中）？

如果 Class 2 是一个单独的模块并且您不想将异常传播到调用者模块，那么可以。如果你想，那就不行。然后需要记录从此类/模块引发的异常。

如果第 1 类和第 2 类在同一个模块中，那么这又取决于您是否要处理内部类中的异常。

> 问题 2：try/catch 块是否应该在我调用方法的地方（在第 1 类中）？

如果您想确保 Class 1 不会引发更多异常，那么可以。

> 问题3：在执行类2中的方法时，当涉及到返回值时，我是否应该返回“错误代码”然后在调用类中处理此代码？

如果您想抛出异常以返回错误代码，这又是一个设计/实现决定。

> 问题 4：当发生错误并且我需要“暂停”程序时，我应该使用 if/else 语句以便代码仅在满足正确条件时才继续前进，还是应该更频繁地使用关键字“break”？

要使用break，您需要在调用者中使用一个循环。

> 问题 5：出错的可能性是无穷无尽的，特别是如果你有大中型程序。你们如何处理用户运行程序时可能遇到的不可知错误？

大型程序分为模块，可以由不同的开发人员编写。所以设计和接口契约在这里变得至关重要。

# php - 未定义变量通知 (PHP)

> ID：11970296
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:38:41.290
> 
> 标签：php

> **可能重复：**
> [PHP：“注意：未定义的变量”和“注意：未定义的索引”](https://stackoverflow.com/questions/4261133/php-notice-undefined-variable-and-notice-undefined-index)

我有一个包含这段代码的 member.php 页面：

```
<?php
    if (isset($_SESSION['teacherusername'])) 
    {
        $username = $_SESSION['teacherusername'];
    }
?> 
```

现在在teacherlogin.php 中，我使用“include”来包含member.php 页面中的代码。我遇到的问题是，如果我打开teacherlogin.php 页面，它会给我一个未定义的变量错误，说明： `Notice: Undefined variable: username in ... on line 25`

为什么它说它是未定义的，因为我已经在 member.php 页面中定义了它？

以下是teacherlogin.php 中的代码：

```
<?php
  // PHP code
  session_start(); 

    ini_set('display_errors',1); 
 error_reporting(E_ALL);

// connect to the database
include('connect.php');
include('member.php');

  /* check connection */
  if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    die();
  }

  // required variables (make them explciit no need for foreach loop)
  $teacherusername = (isset($_POST['teacherusername'])) ? $_POST['teacherusername'] : '';
  $teacherpassword = (isset($_POST['teacherpassword'])) ? $_POST['teacherpassword'] : '';
  $loggedIn = false;
  $active = true;

  if ($username){
      echo "You are already Logged In: <b>{$_SESSION['teacherforename']} {$_SESSION['teachersurname']}</b> | <a href='./teacherlogout.php'>Logout</a>";
  }
  else{

echo "Please Login";

}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:41:04.983

它仅在 if 块中定义。

```
$username = "";
if (isset($_SESSION['teacherusername'])) {
    $username = $_SESSION['teacherusername'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:40:53.523

`$username`没有在任何地方定义或使用。

与顶部 opteacherlogin.php 的 member.php 执行相同操作

> if (isset($_SESSION['teacherusername'])) {
> 
> ```
>  $username = $_SESSION['teacherusername']; 
> } 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:41:12.923

```
$username = null; // ad this line to member.php 
if (isset($_SESSION['teacherusername'])) {
   $username = $_SESSION['teacherusername']; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T13:41:56.643

该变量`$username`仅在用户登录时由您的 member.php 设置。尝试在您的teacherlogin.php 中使用`if(isset($username))`而不是`if($username)`。

# windows - 在 Windows 7 中将用户配置文件复制到默认配置文件

> ID：11970298
> 
> 赞同：0
> 
> 时间：2012-08-15T13:38:48.417
> 
> 标签：windows, windows-7, batch-file, profile, robocopy

我正在尝试找到一种方法，希望使用批处理文件将修改后的用户配置文件复制到默认用户配置文件，以便任何登录到计算机的用户都将采用配置文件设置。我们正在使用一个名为 pGina 的实用程序来调用通过 RADIUS 服务器登录的用户的默认配置文件，而不是让用户直接登录到域。目前，我们正在尝试为此使用 robocopy。

```
cd C:\Users\
rmdir Default /s /q
robocopy /COPY:DAT /R:5 /E C:\Users\user1 C:\Users\Default
pause 
```

有谁知道如何成功复制个人资料？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T20:35:38.690

这是我在搜索您的问题的答案时[发现的](http://www.msfn.org/board/topic/64605-copy-admin-profile-to-default-user/)

```
rem delete old Default User profile
RD /s /q "%systemdrive%\Profiles\Default User"

rem copy current user profile to default user profile
xcopy "%USERPROFILE%\*.*" "%systemdrive%\Profiles\Default User" /e /c /I /H /R /K /Y 
rem delete non-need some files 
del /f /q "%systemdrive%\Profiles\Default User\*.*" 
rem set default attributes
attrib +h "%systemdrive%\Profiles\Default User"

rem registry trick
rem no directly copy locked ntuser.dat file
rem use reg tools to save current user registry to file
reg save HKCU "%systemdrive%\Profiles\Default User\ntuser.dat"
rem set default attributes to hive file  
attrib +H +S "%systemdrive%\Profiles\Default User\ntuser.dat" 
```

# ruby - 从 Rails 应用程序到 Sinatra 应用程序的签名 cookie

> ID：11970303
> 
> 赞同：1
> 
> 时间：2012-08-15T13:38:57.107
> 
> 标签：ruby, ruby-on-rails-3, cookies, sinatra

我有两个应用程序，一个是 Sinatra 应用程序，另一个是 Rails 应用程序。我在 Rails 应用程序中设置了签名的 cookie，我需要将该 cookie 从浏览器发送到 Sinatra。

问题是如果 cookie 已签名，我如何从我的 Sinatra 应用程序中查看该 cookie 的内容？

这些应用程序位于具有不同子域的同一域下。这是可能的，甚至是安全的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:34:31.980

您确实可以在子域之间共享 cookie。您需要将cookie域设置为`.your-domain.com` 注意前导点，这很重要。

要读取 cookie，这两个站点必须共享 cookie 签名密钥。

在 Sinatra 中，您可以在 Rack 中设置它：[来自 Sinatra 常见问题解答](http://sinatrarb.com/faq.html)

```
use Rack::Session::Cookie, :key => 'rack.session',
                       :domain => 'foo.com',
                       :path => '/',
                       :expire_after => 2592000, # In seconds
                       :secret => 'change_me' 
```

因此，您需要设置与`Rails.application.config.cookie_secret`Rails 配置中相同的秘密

# facebook - 从 Open Graph 操作重定向到 facebook 应用注册

> ID：11970306
> 
> 赞同：0
> 
> 时间：2012-08-15T13:39:22.240
> 
> 标签：facebook, facebook-opengraph

我想在我的应用程序中使用以下流程

1.  用户点击时间线上发布的操作
2.  出现申请审批表
3.  用户批准申请
4.  用户被重定向到网站页面

基本上，它的工作方式与社交摄像头的工作方式相同。问题是 Open Graph 操作需要操作引用的对象中的 OG 元标记，我无法将其重定向到注册。
这似乎是一个非常基本的流程，但我找不到这样做的方法，任何人都可以解释它是如何完成的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:42:13.357

您必须从 Canvas URL 执行 JavaScript 重定向。

在 PHP 中，你会像这样回显 JavaScript -

```
echo "<script language=javascript>";
echo "top.location.href ='".$url."';";
echo "</script>";
exit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:05:27.130

# java - 如何在预期随后发生的 HttpURLConnection 中打开套接字

> ID：11970309
> 
> 赞同：0
> 
> 时间：2012-08-15T13:39:26.987
> 
> 标签：java, android

我正在开发一个需要我们服务器快速响应的 Android 应用程序。我们使用 HttpURLConnections 进行通信。为了减少延迟，我想通过在用户主动使用应用程序时打开套接字来“预热”连接，这样当我们收到发送数据的请求时，连接已经建立（假设由于超时，套接字未关闭服务器端）。我相信 URL.openConnection() 在实际发送数据之前实际上并没有打开这个套接字（尽管它的名字）。这个对吗？如果是这样，是否有更好的方法来简单地打开一个套接字并稍后将其传递给另一个 HTTPURLConnection 而不发送数据并使该套接字在保持活动状态期间保持打开状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:30:15.880

我认为这可能会帮助你

[https://github.com/Gottox/socket.io-java-client](https://github.com/Gottox/socket.io-java-client)

它是一个 IO 套接字，与服务器在“on”方法上接收数据保持连接，您也可以通过“emit”发送数据。

# sql - SQL选择用日期时间减去日期时间

> ID：11970311
> 
> 赞同：0
> 
> 时间：2012-08-15T13:39:32.203
> 
> 标签：sql, oracle, oracle10g

我有一个表中的 2 个不同字段，并且都具有相同格式的时间戳。

`7/18/2012 10:19:48 AM`
和
`7/18/2012 10:20:46 AM`

如何减去两个时间戳以获得持续时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:43:00.997

```
SELECT (firstDateColumn - secondDateColumn) * 24 * 60 difference_in_minutes
FROM yourtable 
```

如果日期是字符串，则先转换它们：

```
SELECT (TO_DATE(firstDateColumn, 'dd/mm/yyyy HH:MI:SS AM') - 
        TO_DATE(secondDateColumn, 'dd/mm/yyyy HH:MI:SS AM')) * 
        24 * 60 difference_in_minutes
FROM yourtable 
```

# c# - WebApi 中响应的 DelegatingHandler

> ID：11970313
> 
> 赞同：30
> 
> 时间：2012-08-15T13:39:43.930
> 
> 标签：c#, asp.net-mvc-4, asp.net-web-api, .net-4.5, dotnet-httpclient

我目前正在使用几个委托处理程序（派生自 的类`DelegatingHandler`）在请求发送之前对其进行处理，例如验证签名等。这一切都非常好，因为我不必在所有调用上重复签名验证（例如）。

我想对来自同一个 Web 请求的响应使用相同的原则。响应中是否有类似于 DelegatingHandler 的东西？一种在响应返回到方法之前捕获响应的方法，在某种程度上？

附加信息：我正在使用`HttpClient.PutAsync(...)`

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-08-15T14:01:21.213

是的。您可以在后续任务中执行此操作。

[我在这里](http://byterot.blogspot.co.uk/2012/05/aspnet-web-api-series-messagehandler.html)解释一下。

例如，这段代码（来自上面的博客）跟踪请求 URI 并在响应中添加一个虚拟标头。

```
public class DummyHandler : DelegatingHandler
{
    protected override async Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
    {
        // work on the request 
       Trace.WriteLine(request.RequestUri.ToString());

       var response = await base.SendAsync(request, cancellationToken);
       response.Headers.Add("X-Dummy-Header", Guid.NewGuid().ToString());
       return response;
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-07-29T01:23:05.677

这是拦截请求和响应的示例。重写的方法 SendAsync 用于捕获原始请求，而名为 ResponseHandler 的方法用于捕获响应。

**捕获原始请求和响应的示例**

```
using System.Net.Http;
using System.Threading.Tasks;
namespace webAPI_Test
{
    public class MessageInterceptor : DelegatingHandler
    {
        protected override System.Threading.Tasks.Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, System.Threading.CancellationToken cancellationToken)
        {
            // CATCH THE REQUEST BEFORE SENDING TO THE ROUTING HANDLER
            var headers = request.ToString();
            var body = request.Content.ReadAsStringAsync().Result;
            var fullRequest = headers + "\n" + body;

            // SETUP A CALLBACK FOR CATCHING THE RESPONSE - AFTER ROUTING HANDLER, AND AFTER CONTROLLER ACTIVITY
            return base.SendAsync(request, cancellationToken).ContinueWith(
                        task =>
                        {
                            // GET THE COPY OF THE TASK, AND PASS TO A CUSTOM ROUTINE
                            ResponseHandler(task);

                            // RETURN THE ORIGINAL RESULT
                            var response = task.Result;
                            return response;
                        }
            );
        }

        public void ResponseHandler(Task<HttpResponseMessage> task)
        {
            var headers = task.Result.ToString();
            var body = task.Result.Content.ReadAsStringAsync().Result;

            var fullResponse = headers + "\n" + body;
        }
    }
} 
```

要使用此方法，需要将类标识并注册为 MessageHandler。我将以下行添加到我的 Global.asax 文件中...

**示例如何注册新的 MessageInterceptor 类**

```
GlobalConfiguration.Configuration.MessageHandlers.Add(new MessageInterceptor()); 
```

这是我完整的 Global.asax 文件。注意 MessageInterceptor 是如何被引用的......

**显示 MessageInterceptor 集成的 Global.asax 完整版**

```
using System.Web.Http;
using System.Web.Mvc;
using System.Web.Optimization;
using System.Web.Routing;
namespace webAPI_Test
{
    // Note: For instructions on enabling IIS6 or IIS7 classic mode, 
    // visit http://go.microsoft.com/?LinkId=9394801

    public class WebApiApplication : System.Web.HttpApplication
    {
        protected void Application_Start()
        {
            AreaRegistration.RegisterAllAreas();

            WebApiConfig.Register(GlobalConfiguration.Configuration);
            FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
            RouteConfig.RegisterRoutes(RouteTable.Routes);
            BundleConfig.RegisterBundles(BundleTable.Bundles);

            GlobalConfiguration.Configuration.MessageHandlers.Add(new MessageInterceptor());
        }
    }
} 
```

# c++ - Visual Studio 2010 - C/C++ - Intellisense - 参数类型和名称与仅名称

> ID：11970314
> 
> 赞同：0
> 
> 时间：2012-08-15T13:39:43.837
> 
> 标签：c++, c, visual-studio-2010

试图让自己重新在 Visual Studio 2010 中学习 C++，但我注意到了这一点。

这些怎么不一样？
GetWindowRect 函数调用会显示参数类型和名称
-- 但是 --
CreateWindow 函数调用只会显示参数名称

# parsing - 用 amotoen 解析问题

> ID：11970318
> 
> 赞同：4
> 
> 时间：2012-08-15T13:39:53.877
> 
> 标签：parsing, clojure, peg

我正在尝试使用 Clojure 和[amotoen](https://github.com/richard-lyman/amotoen)编写语法来解析一种简单的语言来描述鼓循环。语言看起来像这样：–</p>

```
# Test Loop
# this is a comment

BPM: 100

Samples:
 BD: bd.wav
 SD: sd.wav
CHH: chh.wav
CSH: csh.wav

Body:
 BD: /---/---/---/---
 SD: ---/--/--/-/--/-
CHH: --/---/---/---/-
CSH: /---------------

# this is another comment 
```

我将语法定义如下：–</p>

```
(def g {
        :Whitespace '(| \space \newline \tab \, :Comment)
        :_* '(* :Whitespace)
        :_ [:Whitespace '(* :Whitespace)]
        :Comment [\# '(* (% \newline)) \newline]
        :BPM [\B \P \M \: :_* '(* :Number) \newline]
        :Number '(* :Digit)
        :Digit (a/lpegs '| "0123456789")
        :Samples [\S \a \m \p \l \e \s \: \newline '(* :SampleDef)]
        :SampleDef [:_* :Name \: :_* :File \newline]
        :Name '(* (% \:))
        :File '(* (% \newline))
        :Body [\B \o \d \y \: \newline '(* :Pattern)]
        :Pattern [:_* :Name \: :_* '(* (| \/ \-)) '(| \newline \$)]
        :Document [:_* :BPM :_* :Samples :_* :Body :_* \$]
       }) 
```

当我单独调用`pegasus`示例文件的每个部分时，它们会被正确解析。例如：--</p>

```
(pprint
  (a/pegasus
    :Body
    g
    (a/wrap-string
      "Body:\n
        BD: /---/---/---/---\n
        SD: ---/--/--/-/--/-\n
       CHH: --/---/---/---/-\n
       CSH: /---------------\n"))) 
```

但是，当我打电话时`(pprint (a/pegasus :Document g (a/wrap-string (slurp "sample.orc"))))`，我得到的只是`nil`。同样，如果我替换`(a/wrap-string (slurp "sample.orc"))`为包含`sample.orc`.

所以，我的问题是：谁能发现我的语法有什么问题？我完全没有想法，我已经盯着它看了几天了。我敢肯定这是一件令人尴尬的简单事情，但我就是看不到！

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T18:46:18.677

该`:Samples`规则使用`:Body`,`:File`可以为空，输入结束应标记为`:$`not `\$`。这是修改后的语法：

```
(def g                                                                                                                                                                  
  {                                                                                                                                                                     
   :Whitespace '(| \space \tab \, :Comment)                                                                                                                             
   :n* '(* (| \newline :Comment))                                                                                                                                       
   :_* '(* :Whitespace)                                                                                                                                                 
   :_ [:Whitespace '(* :Whitespace)]                                                                                                                                    
   :Comment [\# '(* (% \newline)) \newline]                                                                                                                             
   :BPM [\B \P \M \: :_* '(* :Number) \newline]                                                                                                                         
   :Number '(* :Digit)                                                                                                                                                  
   :Digit (a/lpegs '| "0123456789")                                                                                                                                     
   :Samples [\S \a \m \p \l \e \s \: \newline '(* :SampleDef)]                                                                                                          
   :SampleDef [:_* :Name \: :_* :File \newline]                                                                                                                         
   :Name '[(% \:) (* (% \:))]                                                                                                                                           
   :File '[(% \newline) (* (% \newline))]                                                                                                                               
   :Body [\B \o \d \y \: \newline '(* :Pattern)]                                                                                                                        
   :Pattern [:_* :Name \: :_* '(* (| \/ \-)) '(| \newline :$)]                                                                                                          
   :Document [:n* :BPM :n* :Samples :n* :Body :n* :$]                                                                                                                   
   })

;; sample.orc contains the example input from the question text
(pprint (a/pegasus :Document g (a/wrap-string (slurp "sample.orc"))))

;; output:
{:Document
 [{:n*
   ({:Comment [\# (\space \T \e \s \t \space \L \o \o \p) \newline]}
    {:Comment
     [\#
      (\space
       \t
       \h
       \i
       \s
       \space
       \i
       \s
       \space
       \a
       \space
       \c
       \o
       \m
       \m
       \e
       \n
       \t)
      \newline]}
    \newline)}
  {:BPM
   [\B
    \P
    \M
    \:
    {:_* {:Whitespace \space}}
    {:Number ({:Digit \1} {:Digit \0} {:Digit \0})}
    \newline]}
  {:n* \newline}
  {:Samples
   [\S
    \a
    \m
    \p
    \l
    \e
    \s
    \:
    \newline
    ({:SampleDef
      [{:_* {:Whitespace \space}}
       {:Name [\B \D]}
       \:
       {:_* {:Whitespace \space}}
       {:File [\b (\d \. \w \a \v)]}
       \newline]}
     {:SampleDef
      [{:_* {:Whitespace \space}}
       {:Name [\S \D]}
       \:
       {:_* {:Whitespace \space}}
       {:File [\s (\d \. \w \a \v)]}
       \newline]}
     {:SampleDef
      [{:_* ()}
       {:Name [\C (\H \H)]}
       \:
       {:_* {:Whitespace \space}}
       {:File [\c (\h \h \. \w \a \v)]}
       \newline]}
     {:SampleDef
      [{:_* ()}
       {:Name [\C (\S \H)]}
       \:
       {:_* {:Whitespace \space}}
       {:File [\c (\s \h \. \w \a \v)]}
       \newline]})]}
  {:n* \newline}
  {:Body
   [\B
    \o
    \d
    \y
    \:
    \newline
    ({:Pattern
      [{:_* {:Whitespace \space}}
       {:Name [\B \D]}
       \:
       {:_* {:Whitespace \space}}
       (\/ \- \- \- \/ \- \- \- \/ \- \- \- \/ \- \- \-)
       \newline]}
     {:Pattern
      [{:_* {:Whitespace \space}}
       {:Name [\S \D]}
       \:
       {:_* {:Whitespace \space}}
       (\- \- \- \/ \- \- \/ \- \- \/ \- \/ \- \- \/ \-)
       \newline]}
     {:Pattern
      [{:_* ()}
       {:Name [\C (\H \H)]}
       \:
       {:_* {:Whitespace \space}}
       (\- \- \/ \- \- \- \/ \- \- \- \/ \- \- \- \/ \-)
       \newline]}
     {:Pattern
      [{:_* ()}
       {:Name [\C (\S \H)]}
       \:
       {:_* {:Whitespace \space}}
       (\/ \- \- \- \- \- \- \- \- \- \- \- \- \- \- \-)
       \newline]})]}
  {:n*
   (\newline
    {:Comment
     [\#
      (\space
       \t
       \h
       \i
       \s
       \space
       \i
       \s
       \space
       \a
       \n
       \o
       \t
       \h
       \e
       \r
       \space
       \c
       \o
       \m
       \m
       \e
       \n
       \t)
      \newline]})}
  :$]} 
```

# c# - 从 ListBox 中获取子项无法获取未查看的子项

> ID：11970321
> 
> 赞同：0
> 
> 时间：2012-08-15T13:40:00.447
> 
> 标签：c#, wpf, xaml

我在 WPF 中有一个列表框，如下面的 XAML。它充满了 ListBoxItems，里面有一个复选框和一个标签。我的顶部项目之一是“全选”选项。当我单击全选选项时，我有一个遍历所有列表框项目的处理程序，它应该检查所有其他列表框子项上的所有复选框。问题是它只处理可见的子项，当它遇到不可见的列表框项时，VisualTreeHelper 在查找特定类型的对象（如 CheckBox）时似乎返回 null。看来 VisualTreeHelper 似乎在这里有问题。我用错了吗？任何帮助表示赞赏。另一个细节 - 如果我滚动并查看所有列表框项至少一次，它工作正常。

米

XAML - 一个包含大量子项的简单列表框（为简洁起见，仅显示第一个子项）

```
 <ListBox Grid.Row="0" Margin="0,0,0,0" Name="CharacterListBox">
        <ListBoxItem>
            <StackPanel Orientation="Horizontal">
                <CheckBox HorizontalAlignment="Center" VerticalAlignment="Center" Click="AllCharactersClicked"></CheckBox>
                <Label Padding="5">All Characters</Label>
            </StackPanel>
        </ListBoxItem> 
```

C# - 两个函数，第一个是一个辅助方法，它使用 VisualTreeHelper 遍历对象树（我在某个网站上找到了这个）。第二个函数是“全选”列表框项的单击处理程序。它遍历所有子项并尝试检查所有复选框。

```
 private T FindControlByType<T>(DependencyObject container, string name) where T : DependencyObject
    {
        T foundControl = null;

        //for each child object in the container
        for (int i = 0; i < VisualTreeHelper.GetChildrenCount(container); i++)
        {
            //is the object of the type we are looking for?
            if (VisualTreeHelper.GetChild(container, i) is T && (VisualTreeHelper.GetChild(container, i).GetValue(FrameworkElement.NameProperty).Equals(name) || name == null))
            {
                foundControl = (T)VisualTreeHelper.GetChild(container, i);
                break;
            }
            //if not, does it have children?
            else if (VisualTreeHelper.GetChildrenCount(VisualTreeHelper.GetChild(container, i)) > 0)
            {
                //recursively look at its children
                foundControl = FindControlByType<T>(VisualTreeHelper.GetChild(container, i), name);
                if (foundControl != null)
                    break;
            }
        }

        return foundControl;
    }

    private void AllCharactersClicked(object sender, RoutedEventArgs e)
    {

        MainWindow.Instance.BadChars.Clear();

        int count = 0;
        foreach (ListBoxItem item in CharacterListBox.Items)
        {
            CheckBox cb = FindControlByType<CheckBox>(item, null);                
            Label l = FindControlByType<Label>(item, null);
            if (cb != null && l != null)
            {
                count++;
                cb.IsChecked = true;

                if (cb.IsChecked == true)
                {
                    string sc = (string)l.Content;
                    if (sc.Length == 1)
                    {
                        char c = Char.Parse(sc);
                        MainWindow.Instance.BadChars.Add(c);
                    }
                }
            }

        }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:57:46.100

那些随处可见的视觉树行走方法是一种瘟疫。你几乎不需要这些。

只需将 绑定[`ItemsSource`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemssource.aspx)到包含 属性的对象列表`CheckBoxes`，创建[数据模板](http://msdn.microsoft.com/en-us/library/ms742521.aspx)( [`ItemTemplate`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplate.aspx)) 并将该属性[绑定](http://msdn.microsoft.com/en-us/library/ms752347.aspx)到`CheckBox`. 在代码中，只需遍历绑定到的集合`ItemsSource`并设置属性。

# asp.net-mvc - 做 PostAsync 为什么等待不起作用？

> ID：11970328
> 
> 赞同：4
> 
> 时间：2012-08-15T13:40:19.337
> 
> 标签：asp.net-mvc, asp.net-web-api

在一个 WebApi 项目中，我做了一个 Post 来将一些文件转换为另一个文件：

```
var post = client.PostAsync(requestUri, content);
post.Wait();
var result = post.Result; 
```

结果将包含转换后的文件，因此对我来说，当前线程在进一步使用结果之前等待响应很重要。

好吧，似乎它走得更远了，当然，结果还没有准备好……我在这里做错了吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T15:49:54.847

如果要同步做，不用调用`Wait()`，直接返回Result，`Result`属性阻塞调用线程，直到任务完成。

```
var response = client.PostAsync(requestUri, content).Result;
response.EnsureSuccessStatusCode(); 
```

在这里，result的内容还没有准备好，需要继续获取内容：

```
var responseBody = response.Content.ReadAsStreamAsync().Result; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-15T16:33:24.777

我已经看到 Cuong 推荐的方法会出现间歇性线程问题。相反，我建议您使用这种方法：

```
var response = client
      .PostAsync(requestUri, content)
      .ContinueWith( responseTask => {
           var result = responseTask.Result;
           // .... continue with your logic ...
       });

response.Wait(); 
```

[ContinueWith 方法](http://msdn.microsoft.com/en-us/library/dd270696.aspx)旨在保证您的代码将在原始任务完成或中止后运行。

# iphone - InitWithNibName 返回 viewController 但视图为零

> ID：11970331
> 
> 赞同：1
> 
> 时间：2012-08-15T13:40:25.880
> 
> 标签：iphone, ipad, xib, loadview

其他xib的自动加载很好，但不是这个。

当我推送这个视图控制器时，initWithNibName、loadView、viewDidLoad 和 viewWillAppear 都可以正常调用，但是在所有这些方法中视图（以及 @interface 中的所有 self.xxx 对象）都为零，并且在导航栏下留下了一个空窗口.

```
SettingsMain *newVC=[[SettingsMain alloc] initWithNibName:@"SettingsMain" bundle:nil];
[self.navigationController pushViewController:newVC animated:YES]; 
```

我想知道是否可以强制将 self.view 设置为 .xib、loadView 或 initWithNibName 中的内容，以便初始化所有插座等。

视图控制器具有标准代码，

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization

    }
    return self;
} 
```

问题是当 viewDidLoad 被触发时， self.view 为零。

# c - 错误：程序中出现杂散“#”（SWIG）

> ID：11970332
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:40:35.083
> 
> 标签：c, swig

我正在使用 RHEL 6 并尝试使用 SWIG 编译一些代码。

SWIG 文件名为 mySwig.i，看起来像

```
 %module base_module
   %{
     #include "base.h"
   %}
   %include "base.h" 
```

mySwig.i 文件保存在名为 foo 的文件夹中。文件夹 foo 还有其他 .h、.c 和 .cxx 文件。

我使用的命令是

```
 gcc -fpic -c foo/* 
```

输出是：

```
 foo/mySwig.i:1 error: expected identifier or '(' before '%' token
    foo/mySwig.i:3 error: stray '#' in program
    foo/mySwig.i:5 error: expected identifier or '(' before '%' token 
```

有谁知道如何解决这些错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T21:46:40.123

`gcc -fpic -c foo/*`将匹配目录 foo/ 中的*所有*文件。您只想匹配最有可能的 C 文件。`gcc -fpic -c foo/*.c`如果你真的想要，你可以做什么。

就我个人而言，我建议使用 CMake 或 Autotools 之类的东西，甚至只是一个 Makefile 来构建您的项目，而不是直接调用 cc。

# powershell - Add-ADGroupMember 找不到全局组

> ID：11970333
> 
> 赞同：0
> 
> 时间：2012-08-15T13:40:36.723
> 
> 标签：powershell, active-directory

我正在运行一个简单的命令：

导入-CSV $myfile | ForEach=Object {Add-AdGroupMember -Identity $mygroup -Members $_.Alias}

如果我所指的组是通用的，它就可以工作，但如果它是全球的，它就不行。是否需要使用开关来使其找到全局组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:52:46.557

我会尝试这样的事情：

```
$myGroup = Get-ADGroup ... #Play with the search scope, etc until you can get $myGroup set.  It's a better cmdlet for searching for groups because of those options. 
```

使用此页面了解更多详细信息：[http](http://technet.microsoft.com/en-us/library/ee617196) ://technet.microsoft.com/en-us/library/ee617196 - 然后，一旦 $mygroup 是您想要的，下一行就可以正常工作，或者可以修改为：

```
Import-CSV $myfile | % {$myGroup | Add-AdGroupMember -Members $_.Alias} 
```

# c# - 在 C# 中实现 C++/clr 的 auto_handle 功能

> ID：11970334
> 
> 赞同：0
> 
> 时间：2012-08-15T13:40:42.450
> 
> 标签：c#, .net, il, raii

我一直在寻找一种方法来确保在所有情况下都清理类的成员变量，例如类构造函数末尾的异常。

因为它们是成员变量，所以“try、catch”和“using”模式没有用处。我注意到 .NET C++ (C++ /clr:safe) 提供了智能指针（称为 msclr::auto_handle）的模拟，例如 auto_ptr 或 shared_ptr。这非常有用，因为我可以以非常干净的方式对有限资源（例如线程或套接字）进行确定性销毁。

我一直在分析使用 C++ /clr 生成的 IL，并注意到它实际上似乎所做的只是在修改封装数据的每个函数中使用 try/faults 向 IL 发送垃圾邮件。

我已经为任何感兴趣的人提供了 IL 列表。（try/fault 不是我添加的，是 C++/clr 编译器添加的）

```
 MyClass()
  {
        myDisposable.reset(gcnew MyDisposable());
        throw gcnew Exception("Hello World");
        // myDisposable needs to clean up now
        // because it is very large or locks a limited resource.
        // Luckily with RAII.. it does!
  } 
```

……变成……

```
 .try
  {
  IL_0006:  ldarg.0
  IL_0007:  ldloc.0
  IL_0008:  stfld      class msclr.'auto_handle<MyDisposable>' modreq([mscorlib]System.Runtime.CompilerServices.IsByValue) MyClass::myDisposable
  IL_000d:  ldarg.0
  IL_000e:  call       instance void [mscorlib]System.Object::.ctor()
  IL_0013:  ldarg.0
  IL_0014:  ldfld      class msclr.'auto_handle<MyDisposable>' modreq([mscorlib]System.Runtime.CompilerServices.IsByValue) MyClass::myDisposable
  IL_0019:  newobj     instance void MyDisposable::.ctor()
  IL_001e:  call       instance void msclr.'auto_handle<MyDisposable>'::reset(class MyDisposable)
  IL_0023:  ldstr      "Hello World"
  IL_0028:  newobj     instance void [mscorlib]System.Exception::.ctor(string)
  IL_002d:  throw
  IL_002e:  leave.s    IL_003c
  }  // end .try
  fault
  {
  IL_0030:  ldarg.0
  IL_0031:  ldfld      class msclr.'auto_handle<MyDisposable>' modreq([mscorlib]System.Runtime.CompilerServices.IsByValue) MyClass::myDisposable
  IL_0036:  callvirt   instance void [mscorlib]System.IDisposable::Dispose()
  IL_003b:  endfinally
  }  // end handler 
```

是否有类似的方法可以使用 C# 实现这一点，因为我的软件将非常复杂，而且我自己处理这一切将非常危险且容易出错。那么有没有人知道可以自动添加这个额外的 IL 代码以便我可以用 C# 模拟 RAII 的技术甚至构建后步骤？

编辑：（另一个例子）

```
 ref class MyClass
  {
  private:
        msclr::auto_handle<MyDisposable> myDisposable;

  public:
        MyClass()
        {
              myDisposable.reset(gcnew MyDisposable());
              throw gcnew Exception("Hello World");
              // myDisposable needs to clean up now because it is very large or locks a limited resource.
        }
  }; 
```

myDisposable 是一个成员变量。当从构造函数中抛出“Hello World”时，myDisposable 实际上会立即被释放。我可以在 C# 中获得相同的功能吗？我们已经确认 using 无法工作，因为它位于成员变量上，并且每个函数中的 try/catch 是一个非常糟糕的解决方案。

此致，

卡斯滕

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T17:05:25.877

C++/CLI 中的 auto_handle<> 模板类使用了一个特定于 C++/CLI 编译器的功能，称为“堆栈语义”。C++ 程序员非常熟悉的一个特性以及 RAII 背后的核心运行时支持。简而言之，编译器确保在作用域块的末尾调用析构函数。您会看到 IL 中发出的 .try/fault 块，以确保即使在代码引发异常时也调用析构函数。

auto_handle 类的析构函数调用它包装的对象的析构函数。这就是与 C++ 的相似性结束的地方，C++/CLI 类的析构函数是 IDisposable.Dispose() 方法。“真正的”析构函数是类的终结器，由`!classname`语法表示。

并且与 C# 的相似之处开始，它*完全*等同于**using**语句。它也确保调用 Dispose() 方法，并且还使用 try/finally 来确保即使有异常也会发生。*设计者没有在 C++/CLI 中添加using*关键字，而是简单地选择了 C++ 程序员更熟悉的语法。在 IDisposable 的使用中也可以看到，您不能调用 Dispose()，但必须使用*delete*运算符来调用它。

因此，如果您喜欢 C++/CLI 中的 auto_handle<>，那么您将有完全相同的理由喜欢在 C# 中*使用。*

请注意 C++ 中的 RAII 与托管代码中的 auto_handle/using 之间的巨大差异。您经常需要 RAII 来释放 C++ 中的内存，这在托管语言中是完全没有必要的。你也不能，这是垃圾收集器的工作。只有在创建继承 IDisposable 的对象时才*应该*使用*using 。*当然不是 .NET 中的每个类都可以。它也是可选的，不是必需的，类的终结器始终确保在未使用 Dispose() 及早完成时释放非托管资源。

在特殊情况下，由于严格的异常处理或跟踪对象生命周期的痛苦太大，跳过 Dispose() 调用当然是可以的。.NET 框架中此类的一个标准示例是 Thread 类。它有 5 个一次性原生资源，但没有实现 IDisposable。因为编写代码以确保它被调用往往会破坏使用线程的意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T17:04:27.343

您可以在 using 中使用成员变量：

```
class junk
{
    private IDisposable somevar;
    void SomeFunc()
    {
        using (somevar = SomeOtherFunc())
        {
           YesAnotherFunc();
        }
    }
} 
```

# silverlight - Silverlight 工具包扩展器按钮样式/图标

> ID：11970337
> 
> 赞同：0
> 
> 时间：2012-08-15T13:40:48.630
> 
> 标签：silverlight, toolkit, expander

我正在寻找一种简单的方法来更改 Silverlight Toolkit Expander 控件中的展开器按钮的样式。例如：

*   更小或更大的图标。
*   将图标替换为另一个图标。
*   更改正在使用的图标的颜色。

TIA

克雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T20:04:47.537

您所描述的本质上是 Expression Blend 所擅长的面包和黄油。在 Blend 中，您只需右键单击控件并选择编辑模板的副本。然后你会找到切换按钮，然后编辑那个模板。

否则，您需要在 ToolkitStyles.xaml 中找到扩展器的控制模板，尽管使用 Expression Blend 更容易。您会找到适用于所有四个方向的模板，然后展开。

快速解决方案搜索；

```
<Style TargetType="toolkit:Expander" x:Key="DefaultExpanderStyle"> 
```

应该生成您的默认模板，您可以直接编辑或制作副本（如果复制它，请确保重命名密钥名称），这样您就已经拥有所有状态和转换等。请记住，您的罪魁祸首将是模板内嵌入的 ToggleButton，用于您要编辑的任何方向扩展器。

希望这可以帮助。

# objective-c - cocoa-touch 依赖注入和动态加载代码

> ID：11970342
> 
> 赞同：2
> 
> 时间：2012-08-15T13:40:56.660
> 
> 标签：objective-c, cocoa-touch, cocoa-design-patterns

我正在考虑将现有的企业应用程序移植到 iPad。关键要求之一是有一个需要高度可定制/可扩展的基本功能应用程序。此外，从事定制和扩展工作的人员不是产品团队的一部分，也无权访问基本产品的代码（只有接口、文档和二进制文件）。为了实现这一点，当前的应用程序使用基于组件的架构，其中定义明确的组件用于组成 UI。对于给定的客户，这些组件中的任何一个都可以被扩展和使用，而不是开箱即用的组件，或者简单地与一个新的组件交换，该组件附着在接口上。

cocoa-touch 中是否有支持组件模型架构的库？（通过注册表/配置组成应用程序，团队开发人员以外的其他人可以轻松编辑）

塞比

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T12:39:54.487

也许你可以创建一个根视图控制器并注入多态子节点： [https ://github.com/jasperblues/Typhoon](https://github.com/jasperblues/Typhoon)

# java - 如何在 JAVA 中获取多级 JSON 格式的内容？

> ID：11970354
> 
> 赞同：0
> 
> 时间：2012-08-15T13:41:26.870
> 
> 标签：java

例如，一种如下的 JSON：

```
 { "x":"1","y":"2","z":{"a":"1","b":"2","c":"3"}} 
```

把它作为字符串放在 JSONObject 参数中：

```
 JSONObject jaob=new JSONObject(xxx) 
```

并且从 JSONObject 的方法“get（”x“）”我可以获得值“1”

```
 jaob.get("x") 
```

但是如何得到二级JSON格式“z”的“a”？？？

当我尝试通过

```
 JSONObject(jaob.get("z").toString()).get("a") 
```

但它不起作用。
有没有人有这个想法？
任何回应表示赞赏，谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T13:47:22.500

```
jaob.getJSONObject("Z").getString("a") 
```

或者，您可以使用 getLong 或 getString on `a`。

如果您阅读[javadocs](http://www.json.org/javadoc/org/json/JSONObject.html)，这很容易。你的不起作用的原因是`get`返回 a `java.lang.Object`not a `JSONObject`or `JSONArray`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T13:46:45.293

你有没有尝试过

```
JSONObject jaob = new JSONObject(xxx);

jaob.getJSONArray("z");

//or 

jaob.getJSONObject("z"); 
```

他们都根据 JSONObject 返回[JSONObject](http://www.json.org/javadoc/org/json/JSONObject.html)

# java - 有没有办法让所有注册的消息转换器？

> ID：11970358
> 
> 赞同：5
> 
> 时间：2012-08-15T13:41:36.630
> 
> 标签：java, spring, spring-mvc

我想以某种方式注入`HttpMessageConverter`在 Spring-MVC 中注册的所有实例。我可以成功注入所有已注册的内容。

```
private HttpMessageConverter[] converters;
@Autowired
public void setConverters(HttpMessageConverter[] converters) {
    this.converters = converters;
} 
```

但是，这仅在转换器在上下文中注册时才会注入（即，如果在 之外定义`<annotation-driven>`）。

我确实认为我会尝试`<beans:ref`在内部使用，`<annotation-driven><message-converters>`但 spring-web 3.1 不支持它。

是否有一些我可以注入的类可能具有我可以用来获取转换器的属性？理想情况下，我也希望看到它们在过滤器链中注册的顺序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T14:02:24.957

你是对的，消息转换器直接在使用`<mvc:annotation-driven/>`xml 标签注册的 RequestMappingHandlerAdapter 中实例化，并且 message-converters 子标签明确期望 bean 是内联定义的。

但是，一种解决方法是定义处理程序适配器并以这种方式注入转换器：

```
<bean name="handlerAdapter" class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter">
    <property name="webBindingInitializer">
        <bean class="org.springframework.web.bind.support.ConfigurableWebBindingInitializer">
            <property name="conversionService" ref="conversionService"></property>
            <property name="validator">
                <bean class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean">
                    <property name="providerClass" value="org.hibernate.validator.HibernateValidator"></property>
                </bean>
            </property>
        </bean>
    </property>
    <property name="messageConverters">
        <list>
            <ref bean="byteArrayConverter"/>
            <ref bean="jaxbConverter"/>
            <ref bean="jsonConverter"/>
            <bean class="org.springframework.http.converter.StringHttpMessageConverter"></bean>
            <bean class="org.springframework.http.converter.ResourceHttpMessageConverter"></bean>
            <bean class="org.springframework.http.converter.xml.SourceHttpMessageConverter"></bean>
            <bean class="org.springframework.http.converter.xml.XmlAwareFormHttpMessageConverter"></bean>
        </list>
    </property>
</bean>

<bean name="byteArrayConverter" class="org.springframework.http.converter.ByteArrayHttpMessageConverter"></bean>
<bean name="jaxbConverter" class="org.springframework.http.converter.xml.Jaxb2RootElementHttpMessageConverter"></bean>
<bean name="jsonConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"></bean>

<bean name="handlerMapping" class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping">
    <property name="useSuffixPatternMatch" value="false"></property>
</bean> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T13:45:55.643

Spring 将所有转换器置于`org.springframework.core.convert.ConversionService`. 您需要将该接口的一个实例注入到您的类中，您可以在 spring[文档](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#core-convert-ConversionService-API)中阅读更多内容（包括如何注入它的示例）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-25T12:43:54.023

您可以尝试注入一个 bean 类型`RequestMappingHandlerAdapter`，但根据您的配置，您可能没有实例！

# jquery - jQuery砌体问题

> ID：11970368
> 
> 赞同：0
> 
> 时间：2012-08-15T13:42:10.200
> 
> 标签：jquery, css, jquery-masonry

我的网页有点麻烦。我正在使用 jquery 插件砌体，它工作得很好，但是我遇到了一个我似乎可以解决的问题。

基本上，当单击一个按钮时，我隐藏了砌体所在的 div，该按钮工作正常，当我单击另一个按钮将其恢复时，它再次出现。所以这一切都很好，但是如果我在单击以恢复砖石之前调整浏览器的大小，所有砖石瓷砖都位于左上角的另一个之上。当我用萤火虫检查时，正确的定位被添加到每个 div 但似乎 css 忽略了这些但是当我刷新砖石时将每个瓷砖移动到它应该在的位置......关于如何解决这个问题的任何想法？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:55:15.667

修复它 - 我刚刚再次调用了 masonry 函数！：） 无论如何谢谢！

# c - 二叉搜索树删除函数错误

> ID：11970370
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:42:14.547
> 
> 标签：c, binary-search-tree

```
#include<stdlib.h>
#include<stdio.h>

typedef struct treenode
{
   int data;
   struct treenode *left;
   struct treenode *right;
}tnode;

tnode * insert(tnode *node,int data)
{ 
    if(node==NULL)
    {
       node=(tnode *)malloc(sizeof(tnode));
       node->data=data;
       node->left=node->right=NULL;
       return node;
    }

if(data>node->data)
{
    node->right=insert(node->right,data);
}
else if(data<node->data)
{
    node->left=insert(node->left,data);
}

return node;
 }

 tnode * find(tnode *node,int data)

  {
  if(node==NULL)
      return NULL;

if(node->data<data)
return find(node->right,data);

else if(node->data>data)
return find(node->left,data);

else
return node;
  }

 tnode* maximal(tnode *node)

{

 if(node==NULL)
    {
       return NULL;
    }

    if(node->right) 
      return maximal(node->right);

    else 
      return node;

}

 tnode* minimal(tnode *node)

 {
    if(node==NULL)
    {
       return NULL;
    }

    if(node->left) 
      return minimal(node->left);

    else 
      return node;
}

 tnode * delete(tnode *node,int data)

  {
       tnode *temp;

       if(node==NULL)
       {
              printf("Element Not Found");
       }

       else if(data < node->data)

       {
              node->left = delete(node->left, data);
       }

       else if(data > node->data)

      {
              node->right = delete(node->right, data);
      }

      else
      {
            /* Now We can delete this node and replace with either minimum element 
               in the right sub tree or maximum element in the left subtree */
            if(node->right && node->left)
            {
                    /* Here we will replace with minimum element in the right sub tree */
                    temp = minimal(node->right);
                    node -> data = temp->data; 
                    /* As we replaced it with some other node, we have to delete that node */
                    node -> right = delete(node->right,temp->data);
            }
            else
            {
                    /* If there is only one or zero children then we can directly 
                       remove it from the tree and connect its parent to its child */
                    temp = node;
                    if(node->left == NULL)
                            node = node->right;
                    else if(node->right == NULL)
                            node = node->left;
                    free(temp); /* temp is longer required */ 
            }
    }
    return node;

   }

   int main()

   {
      tnode *root=NULL,*temp;
      //int maximum,minimum;
      int op,n;
      do

         {
    printf("\n1.insertion");
    printf("\n2.deletion");
    printf("\n3.preorder");
    printf("\n4.inorder");
    printf("\n5.postorder");
    printf("\n6.minimal node");
    printf("\n7.maximum node");
    printf("\n8.find node");
    printf("\n9.quit");
    printf("\nenter your option:");
    scanf("%d",&op);

    switch(op)
    {
        case 1:
        printf("enter the element to be inserted:");
        scanf("%d",&n);
        root=insert(root,n);
        break;

        case 2:
        printf("enter the element to be deleted:");
        scanf("%d",&n);
        root=delete(root,n);
        break;

        case 6:
        temp=minimal(root);
        if(temp==NULL)
        printf("no elements in the tree");
        else
        printf("the minimum element found is:%d",temp->data);
        break;

        case 7:
        temp=maximal(root);
        if(temp==NULL)
        printf("no elements in the tree");
        else
        printf("the maximal element found is:%d",temp->data);
        break;

        case 8:
        printf("enter the element to be found:");
        scanf("%d",&n);
        temp=find(root,n);
        if(temp == NULL)
        printf("element not found");
        else
        printf("element found");
        break;

        default :
        exit(0);
    }
}while(op<9);

    return 0;

    } 
```

**当我编译时，很多错误都在打击我，所有错误都与删除函数以及如何释放指针有关（两个错误与释放指针有关）。我在寡妇平台上使用 gcc 来执行程序。**

错误如下： g++.exe -x c++ -c C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C -o C:\Users\HARSHA\DOCUME~1\GCCPRO ~1\ps2\BINARY~2.o -Wall -fpermissive C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:97：在“删除”之前解析错误

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:120: `->' 之前的语法错误

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:122: `->' 之前的语法错误

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:133: `temp' 未在此范围内声明

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:133：警告：ANSI C++ 禁止无类型声明“免费”

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:133: `int free' 重新声明为不同类型的符号

...\lib\gcc-lib\i386-mingw32\2.95.2........\include\stdlib.h:271: 先前声明的 `void free(void *)'

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:134: `}' 之前的解析错误

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C：在函数“int main()”中：

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:174：警告：逗号表达式的左侧操作数无效

C:\Users\HARSHA\DOCUME~1\GCCPRO~1\ps2\BINARY~2.C:174：类型`int' argument given to`删除'，预期指针

失败

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:47:46.167

g++ 编译 c++ 而不是 c 代码。delete 是 C++ 中的运算符，因此不能用于函数名。例如，尝试将函数 delete 的名称更改为 Delete（大写“D”）。

# delphi - 如何使多行函数原子化

> ID：11970372
> 
> 赞同：3
> 
> 时间：2012-08-15T13:42:14.477
> 
> 标签：delphi

我有一个必须完全运行、不中断并返回结果的函数。如果异步事件导致在它仍在执行时再次调用它，则必须以某种方式阻止该调用，直到第一次调用完成。

互斥体？还有什么？

* * *

[更新] 该函数在我的主窗体类中，从该类的两个方法调用：一个处理从 serail 端口读取的数据，另一个处理计时器到期。这两个似乎都在它们自己的线程中运行，因为一个函数的调用可以被另一个调用中断（对我来说，在应用程序级别，它们只是我在设计时放在我的主窗体上的组件）。

也许`TCriticalSection`？（但谷歌搜索不清楚我是否需​​要使用`acquire/release`或“进入/离开”，而且似乎由于代码是可能主窗体的简单函数，它将是可重入的）。

也许我要求的是一种使代码“不可重入”的方法，阻塞直到第一个条目完成？不管答案是什么，我认为我需要一个代码示例，或者一个 UTl :-(

（请注意，[此页面](http://www.thedelphigeek.com/2012/02/blaise-pascal-magazine-rerun-6.html)提供了许多有用的信息（我并没有完全理解，但对其他人来说看起来非常有用））

* * *

[更新] 这与 GUI 更新无关，只是每个发送一些 TCOP 数据的事件都应该收到响应。

虽然该应用程序有一个 GUI - 它是基于表单的 - 只是在我想显示一些调试信息的情况下，因为该应用程序将在没有显示器的 PC 上运行（是的，我知道它仍然有一个 GUI，但是不是我的问题/观点）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T13:48:22.883

将函数移动到没有异步事件的单独工作线程。

主线程中的异步事件应该将一些消息发布到某个队列中，因此当工作线程完成执行时，主线程将使用新参数再次启动它。

* * *

有更多信息的更新。假设（猜测）这些函数可以通过 RS232 接收到的数据或什么都没有，并且正在执行类似于 GUI 更新的操作，我将概述以下方法。

1.  使用窗体的 Windows 消息队列进行警报。
2.  使用一些互锁的队列对象进行数据传递。（是的，我知道我可以将指针放入 Windows 消息中，但我想要更多的类型安全性）
3.  使用外工作螺纹进行长加工。

更多细节：

1.  grep WM_USER 的 VCL 源代码并查看模式。您声明了 3 个消息 ID 常量：Work_Complete、Work_Request、Work_EmptyQueue。以及相应的消息方法形式。
2.  我会使用来自 OmniThreadLibrary 的就绪线程安全队列。但是您可以继承 System.Contnrs.TQueue 或 System.Generics.Collections.TQueue，将它们所有的数据传递方法封装到临界区。*总的来说，我建议你看看 OmniThreadLibrary 管道，如果它们适合你的话*
3.  这是硬件数据工作应用程序的标准方式。无论是 MS-DOS 设备驱动程序。或者一些嵌入式设备。您应该将快速和精益的数据保存与长期工作区分开来。

因此，RS232 事件处理程序将从 COM 读取数据，将其放入 TBytes，然后将该数据包添加到输入 TQueue。*更复杂一点的方法是查看 Queue 是否已经包含来自 COM 的数据并将新数据包与旧数据包聚合，而不是将新数据包分开。这需要更仔细的锁定，所以在这里聚合可能不值得*

计时器甚至会制作空包（零长度字节数组）并将其排入队列。*如果该计时器甚至还有一些数据要传递-那么它应该是变体记录或单独的输入队列或其他任何东西。但是没有信息，似乎计时器只发送任何信息，但警报本身*

根据您的说法，Timer 和 RS232 事件都在各自的线程中工作。我对此表示怀疑，但我必须相信你。

在将工作负载排入队列后（例如在输入队列的通知事件中），我会执行 win32 PostMessage（MainForm.Handle，work_request）。毕竟我们希望将线程控制集中在一个地方。*为了保持线程隔离，应该发布消息，没有 SendMessage 没有 TControl.Perform！*

在表单的 work_request 处理程序的主线程中，我会查看输入队列是否已经不是空的。如果没有，那么我会查看工作线程状态。如果它被暂停，我会恢复它。

工作线程看起来是输入队列有东西，虽然它有，但它会：

1.  从队列中提取数据包到本地变量
2.  做一些可能很长的处理
3.  制作输出“工作成果”包。假设是 GUI 更新，它可能只是键值对的集合，或者一些数据字段的记录，其中包含哪些数据字段已填充，哪些数据字段将被忽略。
4.  将该数据包排入输出队列（排队然后将 Work_Complete msg 发布到主窗体）
5.  循环到 1。

如果输入队列为空，则函数退出，线程执行 PostMessage Work_EmptyQueue 并暂停自身，直到稍后被唤醒以完成更多工作或被释放。

当 MainForm （再次在主线程中）收到 Work_Complete 时

1.  将输出队列中的所有数据包提取到本地变量中
2.  合并它们。（如果我有 p1=(label1='aaaa', label2='bbbb') 和 p2=(label3='cccc', label1='dddd') 那么累积的任务将被设置（label1='dddd', label2 ='bbbb', label3='cccc');
3.  应用它们（实际上是更新 GUI）

如果输出队列为空，则省略第 2 步和第 3 步（如果在上一步发生合并）。但不是第四。第 1 步和第 2 步是分开的。由于队列操作是线程互锁的，因此步骤 1 的目标是尽可能快地提取数据。保证金将在当地完成。

当 MainForm 收到 Work_EmptyQueue 时，它​​会检查输入队列现在是否不为空，并且可能会恢复工作线程。它可以选择对状态或其他任何东西进行一些 GUI 更新。

那是一个粗略的草图。它可以更好地雕刻给你一定的引用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-15T13:49:00.837

假设您担心来自同一个线程的重入，那么阻塞重入调用将导致典型的死锁。如果这是您的情况，那么您需要执行以下操作之一：

1.  确保不会发生重入调用，或者
2.  检测重入呼叫并通过将其添加到队列以供以后处理来推迟它，或者
3.  检测重入呼叫并忽略它。

很可能这些选项都不吸引您！

如果您担心来自不同线程的同时调用，那么您可以使用某种锁。例如，在 Windows 上，您通常会使用临界区。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-15T13:48:38.897

结合使用两种机制：

1.  使用 TCriticalSection 防止另一个线程进入。显然这只是多线程应用程序所必需的。
2.  使用再入门。这是一个简单的布尔值，用于防止从同一线程重新进入。如果您尝试保护的功能已经输入，则不要阻止，而是反弹。“反弹”意味着采取一些适当的行动，例如将所需的活动排队以供以后执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-16T17:37:57.483

另一种方法是当从一个事件源（例如，串行端口处理程序）进入关键函数时，在调用期间禁用另一个事件源（到期计时器）。通话后重新启用它。由于计时器已被禁用，您可以保证在通话期间其他事件源无法触发。

对于要处理串行数据包时关闭到期计时器的情况，这很简单。如果我们假设到期计时器用于跟踪一段时间内没有从串行端口接收到任何内容，则在接收到的串行数据时禁用到期计时器是合适的。处理完串行数据包后恢复/重启到期定时器。

相反的情况——在处理到期定时器时接收串行数据——可能有点棘手，因为您可能不想通过禁用串行数据接收器来冒丢失数据的风险。如果您的串行数据处理程序可以轻松暂停/恢复而不会丢失数据，那么您就完成了！否则，您最好的选择可能是在对象实例中使用布尔标志来指示关键函数何时执行。

如果一个串行数据包进来并且该标志为真，则将串行数据包推入一个列表以供稍后处理并立即返回。设置您的到期计时器处理程序以在从关键调用返回之前和之后立即检查该列表。如果列表非空，则处理列表中的所有项目。如果在您进入到期计时器处理程序时列表中有等待处理的数据包，您可能希望忽略到期计时器到期并继续处理。

在串行数据处理程序中，在调用关键函数之前和之后检查列表是否非空。之前检查将有助于确保串行数据包按照接收顺序进行处理。检查after将确保在处理当前数据包过程中到达的后续串行数据不会丢失。

如果有可能在不同的线程上调用串行数据事件处理程序，则应以线程安全的方式小心处理对布尔标志和列表的更新。如果串行事件处理程序（和到期计时器处理程序）保证在 UI 线程上执行，那么您不必担心这一点。

# css - 如何将 div （其中两个居中的文本都在里面）浮动到列表之外？

> ID：11970376
> 
> 赞同：0
> 
> 时间：2012-08-15T13:42:28.937
> 
> 标签：css, css-float, center

我想用 CSS 得到这样的东西。

![在此处输入图像描述](../Images/850ca2f99ce142d53afe8587151de9e1.png)

在左边的方格中，文本应该居中（垂直和水平），并带有一些像“5”这样的文本。条纹包含一些带有换行符的文本？

**更新**

谢谢大家的回答，你的技术很好。

我不能使用固定高度。因为上下 div 的内容是动态的，左边的应该根据灰色框的宽度（大小取决于上下的内容）。图像中的框也像表格行，它是众多之一..

我知道好的做法告诉使用 div 而不是 table，但这值得吗？很久以前我会用 table 完成它.. 但是使用 div 看起来有点不自然，我快疯了。:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:02:39.943

试试这样的 DEMO [http://jsfiddle.net/enve/PCNQd/3/](http://jsfiddle.net/enve/PCNQd/3/)

它兼容所有浏览器（已测试：IE6+、Chrome、Mozilla、Opera）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T13:53:40.553

这是如何完成的一个非常基本的示例。当然你必须做你问题的其他部分，但它给你一个基础:)

[http://jsfiddle.net/qp26m/](http://jsfiddle.net/qp26m/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T13:56:54.110

看这里：[http ://result.dabblet.com/gist/3360364/5e1586c78583dc31a495455e62327262c5ff2091](http://result.dabblet.com/gist/3360364/5e1586c78583dc31a495455e62327262c5ff2091)

请注意，垂直对齐也是居中的。

# c - 为什么编译器生成的代码会一遍又一遍地在相同的内存位置写入相同的内容？

> ID：11970378
> 
> 赞同：5
> 
> 时间：2012-08-15T13:42:37.363
> 
> 标签：c, optimization, gcc, llvm-clang

`clang`我使用and编译了以下代码，`gcc`并使用`-O3`：

```
#include <stdio.h>
#include <stdlib.h>

static void a(int n) {
  if (n == 0) return;

  printf("descending; a=%i\n", n);
  a(n-1);
}

int main() {
  a(5);
  return 0;
} 
```

这是生成的主要函数`gcc`（最后没有 NOP）：

```
08048310 <main>:
 8048310:   55                      push   %ebp
 8048311:   89 e5                   mov    %esp,%ebp
 8048313:   83 e4 f0                and    $0xfffffff0,%esp
 8048316:   83 ec 10                sub    $0x10,%esp
 8048319:   c7 44 24 04 05 00 00    movl   $0x5,0x4(%esp)
 8048320:   00 
 8048321:   c7 04 24 14 85 04 08    movl   $0x8048514,(%esp)
 8048328:   e8 c7 ff ff ff          call   80482f4 <printf@plt>
 804832d:   c7 44 24 04 04 00 00    movl   $0x4,0x4(%esp)
 8048334:   00 
 8048335:   c7 04 24 14 85 04 08    movl   $0x8048514,(%esp)
 804833c:   e8 b3 ff ff ff          call   80482f4 <printf@plt>
 8048341:   c7 44 24 04 03 00 00    movl   $0x3,0x4(%esp)
 8048348:   00 
 8048349:   c7 04 24 14 85 04 08    movl   $0x8048514,(%esp)
 8048350:   e8 9f ff ff ff          call   80482f4 <printf@plt>
 8048355:   c7 44 24 04 02 00 00    movl   $0x2,0x4(%esp)
 804835c:   00 
 804835d:   c7 04 24 14 85 04 08    movl   $0x8048514,(%esp)
 8048364:   e8 8b ff ff ff          call   80482f4 <printf@plt>
 8048369:   c7 44 24 04 01 00 00    movl   $0x1,0x4(%esp)
 8048370:   00 
 8048371:   c7 04 24 14 85 04 08    movl   $0x8048514,(%esp)
 8048378:   e8 77 ff ff ff          call   80482f4 <printf@plt>
 804837d:   31 c0                   xor    %eax,%eax
 804837f:   c9                      leave  
 8048380:   c3                      ret 
```

这是来自`clang`：

```
080483d0 <main>:
 80483d0:   55                      push   %ebp
 80483d1:   89 e5                   mov    %esp,%ebp
 80483d3:   56                      push   %esi
 80483d4:   83 ec 0c                sub    $0xc,%esp
 80483d7:   be 05 00 00 00          mov    $0x5,%esi
 80483dc:   8d 74 26 00             lea    0x0(%esi,%eiz,1),%esi
 80483e0:   89 74 24 04             mov    %esi,0x4(%esp)
 80483e4:   c7 04 24 e0 84 04 08    movl   $0x80484e0,(%esp)
 80483eb:   e8 04 ff ff ff          call   80482f4 <printf@plt>
 80483f0:   4e                      dec    %esi
 80483f1:   75 ed                   jne    80483e0 <main+0x10>
 80483f3:   31 c0                   xor    %eax,%eax
 80483f5:   83 c4 0c                add    $0xc,%esp
 80483f8:   5e                      pop    %esi
 80483f9:   5d                      pop    %ebp
 80483fa:   c3                      ret 
```

我的问题是：他们都生成代码，一遍又一遍地在堆栈上写入静态字符串的地址，是否有充分的理由？例如，为什么`clang`生成的代码看起来不像这样？

```
080483d0 <main>:
 80483d0:   55                      push   %ebp
 80483d1:   89 e5                   mov    %esp,%ebp
 80483d3:   56                      push   %esi
 80483d4:   83 ec 0c                sub    $0xc,%esp
 80483d7:   be 05 00 00 00          mov    $0x5,%esi
 80483dc:   8d 74 26 00             lea    0x0(%esi,%eiz,1),%esi
 80483e0:   c7 04 24 e0 84 04 08    movl   $0x80484e0,(%esp)
 80483e7:   89 74 24 04             mov    %esi,0x4(%esp)
 80483eb:   e8 04 ff ff ff          call   80482f4 <printf@plt>
 80483f0:   4e                      dec    %esi
 80483f1:   xx xx                   jne    80483e7 <main+0x17>
 80483f3:   31 c0                   xor    %eax,%eax
 80483f5:   83 c4 0c                add    $0xc,%esp
 80483f8:   5e                      pop    %esi
 80483f9:   5d                      pop    %ebp
 80483fa:   c3                      ret 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:59:41.823

主要原因是[ABI](https://en.wikipedia.org/wiki/Application_binary_interface)如何定义“堆栈框架”的所有权。简而言之，只要您调用一个函数，该函数就会获得当前堆栈帧的所有权（包括参数、返回地址和任何局部变量）。

它可以用它做*任何事情*。无法保证`printf()`堆栈框架中的任何内容都完好无损。虽然这样做是不好的做法，但函数可以这样做，并且我编写了与堆栈混淆的代码（例如在 C 解释器中，用 C 编写，它可以调用任何编译的函数，尤其是`printf()`.

所以不能保证`printf()`返回时指向静态字符串的指针还在栈上。请注意，编译器不能假设它`printf()`会起作用，因为您可以使用自定义实现链接到不同的 C 运行时`printf()`。

尝试调用 GCC 可以看到源代码的函数。对于这些，它可能会进一步优化堆栈。

**[编辑]**也许一个不同的例子使这更容易理解。在某些情况下，GCC 会优化函数参数传递。不是将它们压入堆栈，而是将它们传递到 CPU 寄存器中。让我们假设它`%eax`用于此目的。如果参数归调用函数所有，则不允许被调用函数修改`%eax`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:05:15.807

在 Mac OS X 应用程序二进制接口中，堆栈上传递的参数可能会被调用的例程修改。因此，在调用例程将格式字符串的地址放入堆栈的地方，被调用例程被允许写入堆栈上的那个位置。（一般不允许写入堆栈上更高[较早]的​​位置。）因此，调用例程无法知道，在被调用例程返回后，调用例程写入堆栈的参数没有改变。

这对于在使用它们执行计算时可能会修改其参数的例程来说是一种便利。例如，您可以有如下代码：

```
int foo(int x)
{
    x *= x;
    return x+3;
} 
```

显然，对于这么简单的代码，编译器实际上不需要将乘积存储在 x 中以完成计算返回值。但是，对于更复杂的例程，您可以看到编译器可能决定将值存储到 x 的位置。

作为一个 ABI 设计问题，您可能想知道是否最好禁止被调用例程使用此空间，以便调用者可以依赖不变的值。但是，以这种方式重复使用参数并不常见，而且编写新副本的成本很小。

另请注意，只有写入堆栈的格式字符串的**地址**可以更改。C 语义要求格式字符串的**内容**在被调用的例程中保持不变，因为它是 const char。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-15T14:03:59.300

简短的问题是函数调用。C 编译器不能真正保证函数调用中发生的事情（除非它是 C 内置函数之一，例如`strlen`）。因此，它不必围绕它们进行优化。考虑：

```
pthread_mutex_lock(&mutex);
val = 5;
pthread_mutex_unlock(&mutex); 
```

如果编译器推断对 val 的写入独立于对 的调用`pthread_mutex_lock`，那么它可以在锁定之前将其推送，然后就会出现大量混乱。

编译器必须假定必须完成函数调用之前的最后一次写入。如果写入发生在它确切知道发生了什么的代码块中（即，没有函数调用或只有内置函数），那么它可以随意优化并拉出不需要的写入。

编译器无法推断函数是否可以访问变量（至少在没有解决停止问题的情况下不能）。另一个函数可能在之前设置了地址，或者使用类似`dlsym`的东西来找出它自己的二进制文件的地址，即使那个符号没有被导出。

# tinymce - TinyMCE 和 br：不能将 br 设置为有效元素

> ID：11970390
> 
> 赞同：1
> 
> 时间：2012-08-15T13:43:10.630
> 
> 标签：tinymce

我有一段要粘贴在 tinyMCE 中：

这是段落：

```
<p>1 aaaaaaaaaaaaa<br />bbbbbbbbbbbbbb</p> 
```

我在 tinyMCE 中设置`p`和`br`作为有效元素，但我失去了`br`，我不知道为什么。

可能是因为我`br`喜欢`<br />`而不喜欢`<br>`？

如果我将完全删除有效元素选项，那么我也会得到`<br />`.

您知道如何`<br />`在 tinyMCE 中启用有效元素吗？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:37:54.257

tinyMCE [valid_elements](http://www.tinymce.com/wiki.php/Configuration%3avalid_elements)选项允许指定范围广泛的规则来“规范化”文档：它功能强大，但语法非常严格。特别是，不应使用空格作为规则的附加分隔符。

例如，要将有效元素限制为`<p>`且`<br />`仅，应使用此行：

```
...
valid_elements: 'p,br' // not valid_elements: 'p, br'
... 
```

# mongodb - 使用 MongoDB 引擎在 django-nonrel 中实现分层模型的最佳方法是什么？

> ID：11970393
> 
> 赞同：3
> 
> 时间：2012-08-15T13:43:14.280
> 
> 标签：mongodb, hierarchy, django-nonrel, django-mptt

本质上，我想复制 django-mptt 模块的功能，但在 django-nonrel 中使用 MongoDB 引擎。这样的事情已经存在了吗？

编辑：我知道有多种解决方案可以在[此处](http://docs.mongodb.org/manual/use-cases/category-hierarchy/)描述的 Mongo 中存储分层数据，但是在 Django 中实现它们的最佳方法是什么？

# xslt - 重复上层节点时，在 xml/xslt 中对相同节点的子节点进行分组/合并

> ID：11970395
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:43:33.180
> 
> 标签：xslt, nodes

作为对我的原始帖子[Group/merge childs of same nodes in xml/xslt](https://stackoverflow.com/questions/11900006/group-merge-childs-of-same-nodes-in-xml-xslt)的补充，我遇到了使该结构针对不同节点（层次结构中较高的节点）重复多次的问题，例如，

```
<Collection>
    <Questionnaire Name="Preferences" VersionID="3QW">
        <Subject ID="2355">
            <EventData Name="First Part">
                <FormData Name="Past">
                    <GroupData ID="xxx" Key="4" Temp="yyy">
                        <ItemData ID="zzz" Value="3"/>
                    </GroupData>
                    <GroupData ID="xxx" Key="4" Temp="yyy">
                        <ItemData ID="qqq" Value="4"/>
                    </GroupData>
                    ...
                </FormData>
                <FormData Name="Present">
                    <GroupData ID="yyy" Key="9" Temp="yyy">
                        <ItemData ID="www" Value="32"/>
                    </GroupData>
                    ...
                </FormData>             
            </EventData>
            <EventData Name="SecondPart">
                ...
            </EventData>
        </Subject>
        <Subject ID="9812">
            ...
        </Subject>
    </Questionnaire>    
</Collection> 
```

在尝试了我收到的建议的变化和其他一些事情之后，我被困住了。我认为它与多个级别有关（并且 GroupData 分布在它将成为子节点的上层/祖父节点上），然后它可能不再具有唯一的 ID。那么如何将每个 GroupData 节点的子节点放入一个 GroupData 节点（在 ID 上匹配，有时在 Key 上匹配，因为后者并不总是存在）？注意：相同的GroupData节点（具有相应的属性）必须在每个FormData节点中合并为一个GroupData节点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:12:23.367

Here are two XSLT 1.0 solutions.

One solution is to take Dimite's solution from your first question, and just expand the key to include FormData...

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kGDByIdKey" match="FormData/GroupData"
  use="concat(@ID, '+', @Key, '+', generate-id(..))"/>

 <xsl:template match="@*|node()">
     <xsl:copy>
       <xsl:apply-templates select="@*|node()"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match=
 "FormData/GroupData
    [generate-id()
    =
     generate-id(key('kGDByIdKey', concat(@ID, '+', @Key, '+', generate-id(..)))[1])
     ]">
    <xsl:copy>
      <xsl:apply-templates select=
       "@*|key('kGDByIdKey', concat(@ID, '+', @Key, '+', generate-id(..)))/node()"/>
    </xsl:copy>
 </xsl:template>

  <xsl:template match="GroupData"/>
</xsl:stylesheet> 
```

Another solution moves the grouping test from the template match condition to the the invoking xsl:apply-templates in the parent FormData ...

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kGDByIdKey" match="FormData/GroupData" use="concat(@ID, '+', @Key)" />

 <xsl:template match="@*|node()">
     <xsl:copy>
       <xsl:apply-templates select="@*|node()"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="FormData">
     <xsl:copy>
       <xsl:apply-templates select="
          @* |
          node()[not(self::GroupData)] |
          GroupData[generate-id() =
                    generate-id(key('kGDByIdKey', concat(@ID, '+', @Key))[1])]"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="FormData/GroupData">
     <xsl:copy>
       <xsl:apply-templates select="@*|
           key('kGDByIdKey', concat(@ID, '+', @Key))/node()"/>
     </xsl:copy>
 </xsl:template>
  <xsl:template match="GroupData"/>
</xsl:stylesheet> 
```

Both stylesheets assume that GroupData's parent is only ever FormData. Any GroupData which does not have a FormData parent is removed.

# php - 使用任何其他控制器类而不是默认控制器类

> ID：11970396
> 
> 赞同：0
> 
> 时间：2012-08-15T13:43:33.027
> 
> 标签：php, codeigniter, codeigniter-routing

我正在使用 CodeIgniter。这是我的路由文件

```
 $route['default_controller'] = 'pages/view/home';
    $route['(:any)'] = 'pages/view/$1'; 
```

在哪里

> pages 是控制器类， view 是它的函数， home 是该函数的参数。

现在，这是默认控制器。当我需要打开其他页面而不是“主页”时，我会从视图内部进行如下操作

```
href="<?php echo base_url('products');?> 
```

现在我想问的是，如果我创建一个新的控制器，我该如何使用该控制器的功能？因为我只是将第三个参数传递给 base_url() 函数。

显然我想我必须写 $routes，但是怎么写呢？因为所有的流量都传递给

> 页/视图

我尝试创建一个新控制器，但无法使用它。我的新控制器名为 new_controller，它有一个函数调用 new_function()

我写了 $route 如下

> $route['pages/view/product'] = 'new_controller/new_function';

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:04:37.743

如果您拿走您在那里放置的 (:any) 路线，您不必担心路线。我认为这会阻止所有其他控制器被加载。

如果您有一个名为“Stuff”的控制器

在你的 URL 中当你有 mysite.com/stuff/foo/param 代码点火器应该绕过默认的“页面”控制器并使用

我认为你最好做这样的事情

```
$route['page/(:any)'] = "page/view/$1"; 
```

并将您的默认设置更改为仅“页面”

这将打开您的新控制器，以便以正常的 codeigniter 方式使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:09:10.173

在 CodeIgniter 中，路由是按行评估的，所以首先你有默认路由，然后你放置新路由 $route['pages/view/product']，如果你想保留 (:any) 路由，这样，您就可以将例外路线放在 (:any) 路线之前。

# php - 无法从 post 变量中获取数组，服务器错误？

> ID：11970398
> 
> 赞同：0
> 
> 时间：2012-08-15T13:43:41.467
> 
> 标签：php, arrays

我有一个这样的选择倍数：

```
<select multiple name="viewers[]"> ... 
```

选择的值通过 ajax 作为数组发送到 php 脚本。在我的测试服务器上，这很好用：

```
$viewers = $_POST['viewers'];

foreach ($viewers as $v)
{
 //loop through array
} 
```

我刚刚将相同的脚本上传到生产服务器，运行相同版本的 php (5.2.17) ，但它失败了。在生产服务器上，$viewers 变成了一个值为“array”的字符串：

```
print_r($viewers)
//outputs Array
echo $viewers
//outputs Array 
```

是否有一些 php.ini 设置会强制 php 将 $viewers 视为实际数组？

更新：

我在生产服务器上做了 var_dump($_REQUEST) 并得到：

```
array(8) {
  ["viewers"]=>
  array(1) {
    [0]=>
    string(9) "lilamonte"
  }
  ["new_subject"]=>
  string(12) "Test Subject" 
```

在测试服务器上，我得到：

```
Array(5) {
  ["viewers"]=>
  array(1) {
    [0]=>
    string(10) "libothwell"
  }
  ["new_subject"]=>
  string(4) "test" 
```

一个有效，另一个无效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T18:46:18.553

是魔术引号引起了这个问题。显然，另一个管理员出于某种原因打开了它们。（我想不出所有计算中的任何东西——也许除了 IE6——这些年来给我带来的问题比魔术引号还要多……）

因此，php.ini 更改为：

`magic_quotes_gpc = Off`

# javascript - 桌上的Javascript事件处理程序？

> ID：11970399
> 
> 赞同：0
> 
> 时间：2012-08-15T13:43:43.057
> 
> 标签：javascript, html, events

快速提问，是否可以在 `<table>`元素上放置 onclick 事件处理程序？目前我每个都有一个处理程序`<tr>`来检测何时单击了一行，但我认为如果我可以为整个表设置一个事件处理程序然后使用 event.target 查找会更简单、更有效点击了哪一行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:44:28.437

是的，你可以这么做。事件将从行元素冒泡到表格。

您必须确定并处理 Internet Explorer 事件对象与其他浏览器中的事件对象之间的差异。具体来说，“目标”在 IE 中不称为“目标”；我认为它是“srcElement”，但我必须验证这一点。（*已验证*）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:10:37.667

听起来你想要事件委托：

jQuery：[http ://api.jquery.com/delegate/](http://api.jquery.com/delegate/)

原始：[http ://davidwalsh.name/event-delegate](http://davidwalsh.name/event-delegate)

# regex - 搜索/替换中的 Notepad++ 正则表达式反向引用语法 - \1 或 $1

> ID：11970405
> 
> 赞同：41
> 
> 时间：2012-08-15T13:43:58.143
> 
> 标签：regex, escaping, notepad++, replace, backreference

我尝试使用带有正则表达式的 Notepad++ 搜索/替换来用这些单词的较短版本替换特定单词。

* * *

我使用以下正则表达式匹配以`er`（但不是`er`作为单词）结尾的每个单词 - 并使用反向引用将匹配的单词替换为减去结尾的相同单词`r`：

*`Find what:`* **`([a-zA-z]+e)r`**

*`Replace with:`* **`$1`**

但它不会替换匹配的单词，即使它找到了它们。

**但是，如果我将反向引用语法更改为：**

*`Replace with:`* **`\1`**

一切正常。

* * *

为什么`$1`反向引用不起作用？

两种形式的反向引用有什么区别 -`\1`和`$1`？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-15T13:43:58.143

Notepad++ 的早期版本（v5.9.8 和更早版本）仅支持标准[POSIX](http://www.regular-expressions.info/posix.html)正则表达式。但是，在 6.0 版中添加了完整的[PCRE](http://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions)（Perl 兼容正则表达式）搜索/替换支持：

> [Notepad++ 6.0 中的新功能和增强功能：](http://notepad-plus-plus.org/news/notepad-6.0-release.html)
> 
> *   支持 PCRE（Perl 兼容正则表达式）。

这意味着如果您使用 Notepad++ v6.0 或任何更新版本（例如 v6.1.5），您可以使用 PCRE 语法，并使用`$1`而不是`\1`用于反向引用，但它与早期版本的 Notepad++ 不兼容（ 6.0 版之前）。除此之外，它们是相似的。

有关反向引用语法之间的差异以及新语法支持背后的原因的更多信息，请参阅[**替换字符串中的反向引用语法（为什么是美元符号？）**](https://stackoverflow.com/questions/2890700/backreferences-syntax-in-replacement-strings-why-dollar-sign)。

可以在[**此处**](http://docs.notepad-plus-plus.org/index.php/Regular_Expressions)找到有关如何在 Notepad++ 中使用正则表达式的有用教程。

# jquery - 页面上的多个 jQuery 图像/内容滑块

> ID：11970407
> 
> 赞同：0
> 
> 时间：2012-08-15T13:44:05.333
> 
> 标签：jquery, wordpress, slideshow

我有两个开发站点，一个是 Wordpress，另一个不是。

[http://www.zimmernutrition.com.php53-23.ord1-1.websitetestlink.com/（Wordpress](http://www.zimmernutrition.com.php53-23.ord1-1.websitetestlink.com/)网站）

[http://wtc.betaforming.com/communications/](http://wtc.betaforming.com/communications/)（非 Wordpress 网站）

两个站点都使用以下内容滑块：

[http://www.slidesjs.com/](http://www.slidesjs.com/)

两个站点都使用以下图像滑块：

[http://nivo.dev7studios.com/](http://nivo.dev7studios.com/)

在不使用 WP 的网站上，两个滑块都可以工作。在 WP 网站上，图像滑块（位于“特色产品”标题下）什么也不显示。查看代码，一切似乎都是正确的。

有什么想法吗？

谢谢

布雷特

# javascript - Javascript 不显示非标准字符

> ID：11970409
> 
> 赞同：1
> 
> 时间：2012-08-15T13:44:09.193
> 
> 标签：javascript, html, utf-8

所以这是代码：

```
<script type="text/javascript" charset="UTF-8"> 
    function loadScript("http://www.qppstudio.net/individualdays/noscroll/2012-08-15.js") { 
        document.write('<script type="text/javascript" charset="UTF-8" src="', url, '">', '<', '/', 'script>'); 
    }   
</script> 
```

包含在页眉中：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
```

页面显示 unicode 字符没有任何问题，预计发布的 javascript 写入页面的部分。脚本在不同域之间下载时是否以某种方式发生了变化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T13:52:00.157

大概。这是我第一次看到这个`charset`属性。我不确定你想用它来达到什么目的。如果服务器向您发送带有`iso-latin-1`编码的文件，但您告诉浏览器该文件具有`UTF-8`编码，会发生什么？浏览器不会将文件从一种编码转换为另一种编码；您可能希望的最好结果是浏览器尝试将字节流解释为`UTF-8`不起作用。

正确的解决方案是配置服务器以在 HTTP 响应标头中发送具有正确编码的文件。浏览器将查找此信息并使用此处指定的编码读取字节流。

不要忘记以正确的编码实际发送字节！这意味着：文件读取、复制到输出流 + 设置编码头，一切都必须完美运行，否则你会遇到奇怪的错误。

# java - 使用 Xstream 定义 XML 结构

> ID：11970410
> 
> 赞同：1
> 
> 时间：2012-08-15T13:44:15.527
> 
> 标签：java, xml, structure, xstream

我需要将一个 POJO 转换为以下 XML：

```
<Root>
  <Version>2.0</Version>
  <Name>John</Name>
  <Age>18</Age>
  <UserId>22491</UserId>
  <Country>USA</Country>
  <AnotherData>
    <Records>
      <AnotherRecord>
        <Field1>XXX</Field1>
        <Field2>XX</Field2>
        <Field3>CCCCCCCC</Field3>
        <Field4>XXX9000</Field4>
        <Field5>XXX00345</Field5>
      </AnotherRecord>
    </Records>
  </AnotherData>
</Root> 
```

我知道如何转换根标签下的字段，这不是问题。但是从 AnotherData 我的问题开始了。

为了表示上面的 xml，我需要一些像这样的类：

```
puclic class Root{
    public String Version;
    public String Name;
    public String Age;
    public String UserID;
    public String Country;
    public AnotherData AnotherData;
}

public class AnotherData{
    public Records Records;
}

public class Records{
    List<AnotherRecord> list;
}

public class AnotherRecord{
    public String Field1;
    public String Field2;
    public String Field3;
    public String Field4;
    public String Field5;
} 
```

但我不需要这种类结构，我喜欢以更简单的方式实现我的类，并在 xml 中“强制”标记结构。

我的课程如下所示，但保留上面的结构 xml。

```
puclic class Root{
    public String Version;
    public String Name;
    public String Age;
    public String UserID;
    public String Country;
    public AnotherData AnotherData;
    List<AnotherRecord> list;
}

public class AnotherRecord{
    public String Field1;
    public String Field2;
    public String Field3;
    public String Field4;
    public String Field5;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T13:15:55.517

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

我不相信 XStream 可以处理这个用例。如果您愿意使用其他技术，以下是如何使用 MOXy 完成的示例。使用`@XmlPath`扩展。

```
@XmlPath("AnotherData/Records/AnotherRecord")
List<AnotherRecord> list; 
```

**根**

下面是完全映射的`Root`类的样子。JAXB 不需要任何注释（请参阅： [http](http://blog.bdoughan.com/2012/07/jaxb-no-annotations-required.html) ://blog.bdoughan.com/2012/07/jaxb-no-annotations-required.html ），但由于文档中的 XML 元素与默认命名规则有些不匹配注释是必需的。

```
package forum11970410;

import java.util.List;
import javax.xml.bind.annotation.*;
import org.eclipse.persistence.oxm.annotations.XmlPath;

@XmlRootElement(name="Root")
public class Root{
    @XmlElement(name="Version")
    public String Version;

    @XmlElement(name="Name")
    public String Name;

    @XmlElement(name="Age")
    public String Age;

    @XmlElement(name="UserId")
    public String UserID;

    @XmlElement(name="Country")
    public String Country;

    @XmlPath("AnotherData/Records/AnotherRecord")
    List<AnotherRecord> list;
} 
```

**另一个记录**

```
package forum11970410;

import javax.xml.bind.annotation.XmlElement;

public class AnotherRecord{
    @XmlElement(name="Field1")
    public String Field1;

    @XmlElement(name="Field2")
    public String Field2;

    @XmlElement(name="Field3")
    public String Field3;

    @XmlElement(name="Field4")
    public String Field4;

    @XmlElement(name="Field5")
    public String Field5;
} 
```

**jaxb.properties**

要将 MOXy 指定为您的 JAXB 提供程序，您需要`jaxb.properties`使用以下条目添加一个在与域类相同的包中调用的文件（请参阅： [http ://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as -你的.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)）：

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

您可以使用以下演示代码来证明一切正常：

```
package forum11970410;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Root.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum11970410/input.xml");
        Root root = (Root) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(root, System.out);
    }

} 
```

**输入.xml/输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<Root>
   <Version>2.0</Version>
   <Name>John</Name>
   <Age>18</Age>
   <UserId>22491</UserId>
   <Country>USA</Country>
   <AnotherData>
      <Records>
         <AnotherRecord>
            <Field1>XXX</Field1>
            <Field2>XX</Field2>
            <Field3>CCCCCCCC</Field3>
            <Field4>XXX9000</Field4>
            <Field5>XXX00345</Field5>
         </AnotherRecord>
      </Records>
   </AnotherData>
</Root> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/09/xpath-based-mapping-geocode-example.html](http://blog.bdoughan.com/2010/09/xpath-based-mapping-geocode-example.html)
*   [http://blog.bdoughan.com/2010/10/how-does-jaxb-compare-to-xstream.html](http://blog.bdoughan.com/2010/10/how-does-jaxb-compare-to-xstream.html)

# asp.net-mvc - 通过 Html.BeginForm 将下拉列表中的选定值传递回控制器

> ID：11970413
> 
> 赞同：0
> 
> 时间：2012-08-15T13:44:21.160
> 
> 标签：asp.net-mvc, html-helper

在我看来，我有这段代码：

```
 <% using (Html.BeginForm("TradeUKKPIShowData", "Report")) //action/controller
 { %>
  <div style="padding: 10px; background-color: #eeeeee; width: 300px; border: 1px solid #cccccc;">
      <div style="float: left; width: 150px; padding-top: 3px;">
        <%: Html.Label("Select a Sunday:") %>
      </div>
      <div style="float: left; width: 150px;">
        <%: Html.DropDownListFor(model => model.SelectedSunday, Model.AllSundays) %>
      </div>
    <div class="clear"></div>
  </div>
  <div style="text-align:right; width: 272px; padding-top: 30px;">
    <input type="submit" id="search-submit" value="Submit"/>
  </div>
<% } %> 
```

控制器中的动作：

```
 public ActionResult TradeUKKPIShowData(DateTime date) //this date value is null thus error
  {
  var reportData = _reportingService.GetTradeUKKPISearches(date);
  ViewBag.reportdate = date;
  return View(reportData);
  } 
```

我收到一条错误消息，指出传递的参数 date 为 null 我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:49:12.373

ModelBinding 不适用于名为的参数`date`，因为它与您的选择字段的名称不同。在您的操作参数中使用正确的名称。

```
public ActionResult TradeUKKPIShowData(DateTime SelectedSunday) {} 
```

您还可以绑定您的 ViewModel（不知道类型，所以我使用`TypeOfYourViewModel`）

```
public ActionResult TradeUKKPIShowData(TypeOfYourViewModel model) 
{
     var reportData = _reportingService.GetTradeUKKPISearches(model.SelectedSunday);
     ViewBag.reportdate = date;
     return View(reportData);
} 
```

# wordpress - 如何仅在主页上调整 Buddypress BP 专辑缩略图的大小？

> ID：11970419
> 
> 赞同：0
> 
> 时间：2012-08-15T13:44:50.377
> 
> 标签：wordpress, thumbnails, buddypress

我在 Buddypress 安装中使用 BP Album 插件。

使用以下代码，我可以在主页上的一个块中显示最新的图像上传（最新照片）：

```
<?php $args = array(
    'action' => bp_album_picture,
    'max' => 5
); 
?>

    <?php if ( bp_has_activities( $args) ) : ?>

        <ul id="image-strip">

        <?php while (bp_activities()) : bp_the_activity(); ?>

            <li><?php echo implode(explode("</a>", bp_get_activity_content_body(), -1)); ?></li>

        <?php endwhile; ?>

        </ul>

    <?php endif; ?> 
```

我的问题是缩略图是 BP 相册设置中指定的大小（100 x 100 像素）。

我怎样才能让最新照片缩略图的大小不同（例如 50 x 50）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T01:17:34.080

所以你不想要图片链接......？

那么也许...

你可以做你的内爆/爆炸，在 <li> 之前删除 <a> 标签。

然后在 < img 和 src 之间再次内爆/爆炸并插入 class="yourthumbnail"

然后在<li>中回显结果

并添加到您的 CSS：

img.yourthumbnail { 宽度：50px; 高度：50px；}

# c# - BackgroundWorker 不处理异常

> ID：11970422
> 
> 赞同：0
> 
> 时间：2012-08-15T13:45:09.047
> 
> 标签：c#, multithreading

我真的在 Stackoverflow 上阅读了所有其他类似的主题。没有什么对我有用...我抛出“异常”类型的异常，但我无法处理异常。

我已经在 DoWork Progress 的 CompletedEvent 中尝试过（使用 try/catch，witch e.error ....）

```
void bgGetResponse_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    if (e.Error != null)
    {
        MessageBox.Show(e.Error.Message);
        ConvertByte(myFile);
        myFile= null;
    }
}

void bgGetResponse_DoWork(object sender, DoWorkEventArgs e)
{
    byte[] test= new byte[] { 1, 1, 0, 1, 1};
    //Here the error occured (just with  throw new Exception("error"))
    //The method only throws an exception (for test purposes)
    testResponse= _configManager.GetResponse(test, 0);
}

GetResponse(...)
{

   throw new Exception("..!");

} 
```

有任何想法吗？

感谢您的努力

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:01:42.970

我通常只是在工作方法中捕获它并将结果设置为它。

```
private void BGW_DoWork(object sender, DoWorkEventArgs e)
{
    ...
}
catch (Exception ex)
{
    e.Result = ex;
} 
```

然后查看 Completed 事件，

私人无效BGW_RunWorkerCompleted（对象发送者，RunWorkerCompletedEventArgs e）{ this.Cursor = Cursors.Default;

```
try
{
    Exception ex = e.Result as Exception;
    if (null != ex)
        throw ex; 
```

...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T13:49:10.220

如果通过“无法处理”您的意思是 can't use 的异常`catch`，那是真的。您只需使用 Error 属性。您可以在 Completed 事件处理程序中“抛出”它；但是你的堆栈框架会有所不同。

例如：

```
try
{
    if(e.Error != null) throw(e.Error)
    // handle success case
}
catch(MyException exception)
{
    // handle specific error.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:00:56.680

BackgroundWorkers DoWork 函数中发生的任何未处理的异常都将导致工作人员触发 RunWorkerCompleted，其中事件参数将包含错误。

# objective-c - Objective C 中的多态方法

> ID：11970424
> 
> 赞同：3
> 
> 时间：2012-08-15T13:45:23.413
> 
> 标签：objective-c, overloading

在 Java 中，您可以将多个构造函数放入一个类中，根据构造实例时使用的参数的类型和/或数量来调用这些构造函数。我假设在 Objective C 中有等价物。

我可以有一个多态方法吗？

我想构建一个根据是传递字符串还是双精度字符串的行为略有不同的方法？

这听起来很疯狂还是很容易？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T13:54:12.127

您正在考虑重载方法。由于在 Objective-C 中实现动态调度的方式，目前不可能将两个不相关的类型作为参数传递给相同（或同名）的方法并让它理解。

在 Objective-C 中，有两种相关但不同的方法来处理多种输入。让我们使用您的字符串或双精度示例作为可能的输入。在 Java 中，您可能有：

```
 void applyWidget(String s);
 void applyWidget(double d); 
```

这很好，但不是 Objective-C。在 Objective-C 中，您将使用两个不同的方法名称：

```
- (void)applyWidgetWithName: (NSString *)name;
- (void)applyWidgetWithValue: (double)value; 
```

每个方法中的逻辑与 Java 版本中的逻辑相同，但不同的名称让编译器将它们视为不同的方法（即使在 Java 中也是如此）。代码也成为自文档化的：通过阅读它，你会得到一个即使没有评论，也能了解正在发生的事情。或者，如果您只*需要*一个方法名称，则将参数类型更改为`id`并接受任何对象：

```
- (void)applyWidget: (id)widget; 
```

然后传递一个`NSString`或一个`NSNumber`包装你的`double`. 然后，在方法的实现中，使用Objective-C的自省方法来确定如何进行：

```
if ([widget isKindOfClass: [NSString class]]) {
    ...
} else if ([widget isKindOfClass: [NSNumber class]]) {
    double d = [widget doubleValue];
    ...
} 
```

这种方法本质上是告诉调用者“发送任何东西——我会适当地处理它”。如果没有大量文档，可能很难确定这种方法的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T13:48:59.753

绝对容易：

```
- (id)initWithSomeObject:(id)object
{
    if ([object isKindOfClass:[ClassOne class]) {
        // do something
    } else if ([object isKindOfClass:[ClassTwo class]) {
        // do something else
    } // etc.
    return self;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T13:48:33.250

是的，但是 objc 没有适当的重载。

所以你会看到类似的东西`initWithDouble:`，`initWithBool:`等等。这就是某些人的口味有点“罗嗦”的部分原因。

使用您的示例：

```
@interface MONClass

- (id)initWithString:(NSString *)pString;
- (id)initWithDouble:(double)pDouble;
... 
```

但以下是错误：

```
- (id)initWith:(NSString *)pString;
- (id)initWith:(double)pDouble; 
```

因为选择器是相同的——选择器中省略了参数/返回类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-21T06:08:59.937

基本上，Objective C 没有适当的方法重载。它将仅支持覆盖。假设如果你在同一个类中编写函数，

*   (void) 显示方法；
*   (void) showMethod:(int) aNumber;

这将在 Objective C 中支持。假设如果您编写如下函数，

*   (void) showMethod:(NSString*) aString;
*   (void) showMethod:(int) aNumber;

通过这种方式，编译器会给出错误，因为在 showMethod 的实现中存在冲突的参数类型。

# cocos2d-iphone - 将 cocos2d-x 项目移植到 android 时出错

> ID：11970425
> 
> 赞同：0
> 
> 时间：2012-08-15T13:45:26.883
> 
> 标签：cocos2d-iphone, android-ndk, cocos2d-x

我已经使用 Visual c++ 在 Windows 中成功运行了“逐步 Coos2dxSimpleGame 系列”（http://www.cocos2d-x.org/projects/cocos2d-x/wiki/Tutorials）。现在我想将此项目移植到安卓设备上，因此我将 HelloWorld、AppDelegate 和 GameOverScene 类及其头文件复制到 Classes 文件夹，并将资源复制到 /Resources 文件夹。然后我修改了 android.mk 文件以包含一个名为 GameOverScene.cpp 的新类，该类以前不存在。

然后我运行 ./build_native.sh 。错误信息在这里（http://www.cocos2d-x.org/attachments/1152/native_error.PNG）。我遵循的过程是否正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:58:27.997

我可以建议您的一件事是逐步遵循本教程

[http://magicscrollsofcode.blogspot.com/2011/09/quick-and-dirty-guide-to-getting.html](http://magicscrollsofcode.blogspot.com/2011/09/quick-and-dirty-guide-to-getting.html)

并且也不要忘记这一点： [http](http://www.cocos2d-x.org/boards/6/topics/8572?r=8577#message-8577) ://www.cocos2d-x.org/boards/6/topics/8572?r= 8577#message-8577 之后

这两件事曾经帮助了我很多:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-18T12:05:03.753

在 HelloWorldScene.h 中，更改：

```
HelloWorld::~HelloWorld();
HelloWorld::HelloWorld(); 
```

至：

```
~HelloWorld();
HelloWorld();` 
```

您不得在头文件的声明中添加类名（但必须在 cpp 文件中添加）。

# asp.net - 在会话结束时从服务器中删除临时文件

> ID：11970426
> 
> 赞同：1
> 
> 时间：2012-08-15T13:45:28.693
> 
> 标签：asp.net, vb.net, global-asax

在我的应用程序中，我根据用户选择的选项修改图像。每次我修改默认图像时，我都会保存并将其命名为用户 ID 并`date.now.tostring("yyyyMMddHHmmssf")`解决浏览器缓存问题。这很好用，但现在我可能最终会看到很多旧图像。

现在如何从`~/Images/Temp/userID`服务器上的文件夹中删除所有图像？我正在考虑使用`Session_End`or `Application_end`subs in `Global.asax`，但我认为我无法访问我的任何变量来获取临时图像的路径。

如何在会话结束或类似内容后删除这些临时文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:51:17.990

Session End 只对进程中的会话触发，并且不能保证（例如，服务器可能会断电并且不会触发）。Application End 不应该经常触发，并且（正如您所指出的）您可能没有执行清理所需的数据。

在会话结束时执行清理工作还*不错*，但对于这个特定问题，可能有更好、更确定的解决方案。

如果唯一命名是问题的根源，那么可以想到几个选项：

*   使用允许您定期运行 Windows 任务以识别旧图像并清理它们的命名约定。Powershell 对于这样的任务非常灵活。

*   在名称末尾使用不同的查询字符串参数提供图像以避免缓存（但保持文件名一致）。

    例子：`<img src="images/tim-medora.jpg?v=123" alt="picture" />`

*   通过处理程序动态提供图像。这使您可以控制缓存设置、改变查询字符串等。

*   为图像提供自定义扩展名并在 IIS 中为该扩展名设置不同的缓存设置。Web 浏览器对指向自定义扩展的图像标签没有问题，只要它是有效的图像。

# java - 如何理解happens-before一致

> ID：11970428
> 
> 赞同：15
> 
> 时间：2012-08-15T13:45:32.750
> 
> 标签：java, memory-model

在[JLS 的第 17 章中](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5)，引入了一个概念：happens-before 一致。

> 如果对于 A 中的所有读取 r，一组动作 A 在发生之前是一致的，其中 W(r) 是 r 看到的写入动作，但不是 hb(r, W(r)) 或存在在 A 中存在写入 w 使得 wv = rv 和 hb(W(r), w) 和 hb(w, r)"

在我的理解中，它等于下面的话：……，既不是……也不是……

所以我的前两个问题是：

*   我的理解正确吗？
*   “wv = rv”是什么意思？

它还给出了一个例子：17.4.5-1

```
Thread 1 Thread 2

B = 1; A = 2; 

r2 = A; r1 = B; 
```

在第一个执行顺序中：

```
1: B = 1;

3: A = 2;

2: r2 = A;  // sees initial write of 0

4: r1 = B;  // sees initial write of 0 
```

命令本身已经告诉我们两个线程是交替执行的，所以我的第三个问题是：左数是什么意思？

据我了解，r2 和 r1 都可以看到初始写入 0 的原因是 A 和 B 都不是 volatile 字段。所以我的第四个问题是：我的理解是否正确？

在第二个执行顺序中：

```
1: r2 = A;  // sees write of A = 2

3: r1 = B;  // sees write of B = 1

2: B = 1;

4: A = 2; 
```

根据happens-before一致性的定义，不难理解这个执行顺序是happens-before一致（如果我的第一个理解是正确的）。所以我的第五个和第六个问题是：现实世界中是否存在这种情况（读后写）？如果是这样，你能给我一个真实的例子吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-15T13:55:21.100

每个线程可以位于不同的内核上，并拥有自己的私有寄存器，Java 可以使用这些寄存器来保存变量的值，除非您强制访问一致的共享内存。这意味着一个线程可以写入存储在寄存器中的值，并且该值在一段时间内对另一个线程不可见，例如循环或整个函数的持续时间。（毫秒并不少见）

一个更极端的例子是读取线程的代码被优化，假设因为它从不改变值，它不需要从内存中读取它。在这种情况下，优化的代码永远不会看到另一个线程执行的更改。

在这两种情况下，使用`volatile`确保读取和写入以一致的顺序发生，并且两个线程看到相同的值。这有时被描述为总是从主内存中读取，尽管不一定是这样，因为缓存可以直接相互通信。（因此对性能的影响比您预期的要小得多）。

在普通 CPU 上，缓存是“连贯的”（不能保存陈旧/冲突的值）并且是透明的，而不是手动管理的。使数据在线程之间可见仅意味着在 asm 中执行实际的加载或存储指令以访问内存（通过数据缓存），并可选地等待存储缓冲区耗尽以给出排序 wrt。其他后期操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-12-26T16:41:59.903

**发生之前**

让我们看一下**并发**理论中的定义：

**原子性**- 是一种操作属性，可以作为单个事务完全执行，不能部分执行。例如`Atomic operations`[^([示例])](https://stackoverflow.com/a/65382071/4770877)

**可见性**- 如果一个线程进行了更改，它们对其他线程是可见的。`volatile`在 Java 5 之前`happens-before`

**排序**- 编译器能够更改源代码的操作/指令的顺序以进行一些优化。

例如`happens-before`，这是一种`memory barrier`有助于解决问题的`Visibility`方法。`Ordering`发生之前的好例子是`volatile`[^([About])](https://stackoverflow.com/a/59498520/4770877)，`synchronized`监控[^([About])](https://stackoverflow.com/a/59500618/4770877)

一个很好的例子`atomicity`是`Compare and swap`( ) 模式的( `CAS`) 实现，它应该是原子的并且允许在多线程环境中更改变量。如果满足以下条件，您可以编写自己的实现：`check then act``CTA``CTA`

*   `volatile + synchronized`
*   `java.util.concurrent.atomic`使用`sun.misc.Unsafe`（内存分配，没有构造函数调用的实例化......）从中`Java 5`使用`JNI`和 CPU 优势。

`CAS`算法有你的参数（A（地址），O（旧值），N（新值））。

```
If value by A(address) == O(old value) then put N(new value) into A(address), 
else O(old value) = value from A(address) and repeat this actions again 
```

## 发生之前

[官方文档](https://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5)

> 两个动作可以通过happens-before关系**排序。**如果一个动作发生在另一个动作之前，那么第一个动作对第二个动作**可见**并在第二个动作之前**排序**。

[![在此处输入图像描述](../Images/92c3b18193660b82c0b2e360bdbf6b92.png)](https://i.stack.imgur.com/ymS7O.png)

## 以volatile [^([关于])](https://stackoverflow.com/a/59498520/4770877)为例

> 对**volatile**字段的**写入****发生在**对该字段的每次后续**读取**之前。

 ******让我们看一下这个例子：

```
// Definitions
int a = 1;
int b = 2;
volatile boolean myVolatile = false;

// Thread A. Program order
{
    a = 5;
    b = 6;
    myVolatile = true; // <-- write
}

//Thread B. Program order
{
    //Thread.sleep(1000); //just to show that writing into `myVolatile`(Thread A) was executed before

    System.out.println(myVolatile); // <-- read
    System.out.println(a);  //prints 5, not 1
    System.out.println(b);  //prints 6, not 2
} 
```

**可见性**- 当`Thread A` **更改/写入**易**失性**变量时，它还会将所有先前的更改推送到**RAM - 主内存**因此所有**非易失性**变量都将是最新的并且对其他线程可见

**订购**：

*   **写入 volatile 变量 in 之前的`Thread A`**所有操作都将在之前调用。JVM 能够对它们重新排序，但保证**在写入 volatile 变量之前`Thread A`**不会调用任何操作。

*   **读取 volatile 变量后的`Thread B`**所有操作都将在之后调用。JVM 能够对它们重新排序，但保证**在读取 volatile 变量后`Thread B`**不会调用任何操作。

[[并发与并行]](https://stackoverflow.com/a/63744581/4770877)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T14:05:18.343

Java 内存模型定义了程序中所有操作的*部分排序*，称为*发生前*。
为了保证线程`Y`能够看到动作的副作用`X`（与是否`X`发生在不同的线程中无关），在和之间定义了*发生前的*关系。 如果这种关系不存在，JVM 可能会重新排序程序的操作。 现在，如果一个变量被多个线程共享和访问，并且（至少）一个线程写入，如果读取和写入不是按照*发生前*的关系排序的，那么你就有了数据竞争。`X``Y`

 *在正确的程序中没有数据竞争。
示例是 2 个线程`A`并`B`在 lock 上同步`X`。
`Thread A`获取锁（现在`Thread B`被阻塞）并执行写操作，然后释放锁`X`。现在`Thread B`获取锁`X`，并且由于所有操作`Thread A`都是*在释放*锁之前完成的`X`，因此它们在线程*之后*获取锁的操作*之前排序*（并且对 也是可见的）。 请注意，这发生在*同一个锁上*同步的操作上。在线程之间的关系同步之前*没有发生*`Thread B``X` *`A``Thread B`
***在不同的锁上*****

 *** * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-15T14:33:53.323

实质上是正确的。主要的一点是：除非您使用某种形式的同步，否则无法保证在您的程序顺序中写入之后的读取会看到该写入的效果，因为语句可能已被重新排序。

> 在现实世界中是否存在这种情况（读取看到稍后发生的写入）？如果是这样，你能给我一个真实的例子吗？

从挂钟的角度来看，显然，读取无法看到尚未发生的写入的效果。

从程序顺序的角度来看，因为如果没有适当的同步（发生在关系之前），语句可以重新排序，在程序中写入之前的读取可以在执行期间看到写入的效果，因为它已经执行在JVM写入之后。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-11T21:06:08.857

Q1：我的理解对吗？

答：是的

Q2：“wv = rv”是什么意思？

A: wv 的值与 rv 的值相同

Q3：左数是什么意思？

A：我认为是“表 17.4-A。语句重新排序导致的令人惊讶的结果 - 原始代码”中所示的语句 ID。但是你可以忽略它，因为它不适用于“Another execution order that is occurred-before compatible is:”的内容，所以左边的数字完全是狗屎。不要坚持下去。

Q4：在我的理解中，r2 和 r1 都可以看到初始写入 0 的原因是 A 和 B 都不是 volatile 字段。所以我的第四个问题是：我的理解是否正确？

答：这是一个原因。重新订购也可以。“程序必须正确同步，以避免在重新排序代码时出现违反直觉的行为。”

Q5&6：在第二个执行顺序中......所以我的第五个和第六个问题是：在现实世界中是否存在这种情况（读取看到稍后发生的写入）？如果是这样，你能给我一个真实的例子吗？

答：是的。代码中没有同步，每个线程读取都可以看到初始值的写入或其他线程的写入。

时间 1：线程 2：A=2

time 2: Thread 1: B=1 // 不同步，线程1的B=1可以在这里交错

时间 3: 线程 2: r1=B // r1 值为 1

时间 4: 线程 1: r2=A // r2 值为 2

注意“如果其动作集发生之前一致，则执行是发生之前一致”********

# irssi - Irssi awl (Advanced Windowlist) 溢出行为线

> ID：11970431
> 
> 赞同：0
> 
> 时间：2012-08-15T13:45:47.203
> 
> 标签：irssi

如您所见，当终端窗口足够窄时，通道和查询名称会溢出终端窗口的大小。我一直在尝试修改 AWL 设置，但似乎无法使其正常工作。

irssi 用户有什么想法吗？

![在此处输入图像描述](../Images/0be0f888e1ff69b59608823f4c984b81.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:14:19.600

引起怪癖的是其中一个频道名称中的 ö 字母。用 /window name 重命名它，现在一切正常。

# mysql - 修复通过交替 1,2,3 - 1,2,3 - 1,2,3 排序 MYSQL 结果的查询

> ID：11970444
> 
> 赞同：0
> 
> 时间：2012-08-15T13:46:48.567
> 
> 标签：mysql

我之前问过一个关于通过交替 (1,2,3 - 1,2,3 - 1,2,3) 行来排序 MYSQL 结果的问题，我找到了这个[答案](https://stackoverflow.com/questions/1959414/mysql-how-do-i-order-results-by-alternating-1-2-3-1-2-3-1-2-3-rows-i)

我试图将代码应用于我的情况，这就是我得到的：

```
SELECT 
x.id, 
x.pic0,
x.bio,
x.bio2,
x.site,
x.url,
x.applet
FROM 
(SELECT 
t.id, 
t.pic0,
t.bio,
t.bio2,
t.site,
t.url,
t.applet
CASE
WHEN @site != t.site THEN @rownum := 0
WHEN @site = t.site THEN @rownum := @rownum + 1
ELSE @rownum
END AS rank,
@site := t.site
FROM ".$table." t,
(SELECT @rownum := 0, @site ORDER BY t.site) r) x 
ORDER BY x.rank, x.site 
```

这是我得到的 MYSQL 错误 - 服务器正在使用 MYSQL 5.1

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CASE WHEN @site != t.site THEN @rownum := 0 WHEN @site = t.site THEN @rownum :' at line 18 
```

1.  我是一个完全的新手，这个查询，我什至无法理解它:) 所以我对它有什么问题一无所知。

2.  如何向此查询添加 WHERE 条件？

    WHERE bio LIKE 'value' 等等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:50:20.673

你错过了一个`,`

```
t.applet , CASE WHEN @site ...
         ^................................here 
```

在此处添加`where`：

```
FROM ".$table." t,
(SELECT @rownum := 0, @site ORDER BY t.site) r) x 

WHERE bio LIKE 'value'

ORDER BY x.rank, x.site 
```

# windows - gitbash（缓存密码密钥）：无法让 ssh-agent 在 Windows 上运行，修改了 .bashrc 和 .profile

> ID：11970447
> 
> 赞同：2
> 
> 时间：2012-08-15T13:46:56.843
> 
> 标签：windows, git, github, ssh-agent

谁能帮忙，我在 Windows 上，git 正在使用我的源设置为 github。

当然，每次我希望拉/推或任何我需要为 github 提供密钥的密码时。

根据我所阅读的内容，我需要编辑 ~/.profile 或 ~/.bashrc 并输入一些文本

> 见[https://help.github.com/articles/working-with-ssh-key-passphrases](https://help.github.com/articles/working-with-ssh-key-passphrases)

我已经这样做了很多次，我实际上在两个文件中都输入了它，但是当我打开一个新的 GitBash 窗口时，似乎什么都没有运行（我假设某些东西应该运行并根据上面的链接询问我的密码）。

因此，当然，每次 Push 或 Pull 都会再次要求我输入密码。

我显然在这里遗漏了一些东西，有人可以帮忙吗？

记住我在 Windows 上 :-) 并使用 git 附带的 gitbash for windows。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-26T04:39:37.817

好吧，经过大量调查，我发现了这个[记住密码，Windows下的Git bash](https://stackoverflow.com/questions/5727555/remember-password-git-bash-under-windows)

它准确地解释了需要什么，它与它出现的 linux 不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T15:46:02.843

如果您通过“https”方法克隆了存储库，现在尝试以“ssh”方式或其他方式进行推送/拉取，则可能会发生这种情况。看看这是否适合你：

```
git remote set-url origin git@github.com:your_account/your_repo.git 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-04T11:40:12.983

在 Windows 10 上，这对我有用

1.  运行 git bash
2.  `touch ~/.profile`
3.  `start ~/.profile`打开`.profile`
4.  将以下内容添加到`.profile`

```
#! /bin/bash 
eval `ssh-agent -s` 
ssh-add ~/.ssh/*_rsa 
```

这是基于[这个答案](https://stackoverflow.com/a/19792331/3274693)。唯一的区别是`.bashrc`没有工作，而是`.profile`工作。

# android - 无法解析 MySQL 数据库中的 JSON 数据

> ID：11970450
> 
> 赞同：0
> 
> 时间：2012-08-15T13:47:16.843
> 
> 标签：android, mysql, json, getjson

我正在开发一个需要我连接到 mysql 数据库并从中检索信息的 android 应用程序。我正在使用 php 脚本连接到服务器并对其进行查询，然后以 json 格式输出结果：

```
if(!mysql_connect($mysql_host,$mysql_user,$mysql_pass) || !mysql_select_db($mysql_db)){
die($conn_error);
}

$q=mysql_query("SELECT * FROM food");

  while($e=mysql_fetch_assoc($q))

          $output[]=$e;

       print(json_encode($output));

mysql_close();

?> 
```

这是我使用 HttpGet 获取数据并将其转换为字符串的 java 代码。然后它意味着解析数据并将其显示在屏幕上。

```
public class HttpExample extends Activity {

TextView httpStuff;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.httpex);
    httpStuff = (TextView) findViewById(R.id.tvHttp);

    GetMethodEx test = new GetMethodEx();
    String returned;
    try {
        returned = test.getInternetData();
        httpStuff.setText(returned);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

}

public class GetMethodEx {

    public String getInternetData() throws Exception {

        BufferedReader in = null;
        String data = "";
        String returnString = null;

        // httpGet

        try {

            HttpClient client = new DefaultHttpClient();
            URI website = new URI("http://10.0.2.2/connect.php");
            HttpGet request = new HttpGet();
            request.setURI(website);
            HttpResponse response = client.execute(request);
            in = new BufferedReader(new InputStreamReader(response
                    .getEntity().getContent()));
            StringBuffer sb = new StringBuffer("");
            String l = "";
            String nl = System.getProperty("line.separator");

            while ((l = in.readLine()) != null) {
                sb.append(l + nl);
            }
            in.close();
            data = sb.toString();
            // return data;
        } catch (Exception e) {
            Log.e("log_tag", "Error converting result " + e.toString());
        }
        // parse json data
        try {
            JSONArray jArray = new JSONArray(data);
            for (int i = 0; i < jArray.length(); i++) {
                JSONObject json_data = jArray.getJSONObject(i);
                Log.i("log_tag", "Foodname: " + json_data.getString("food"));
                // Get an output to the screen
                returnString += "\n\t" + jArray.getJSONObject(i);
            }
        } catch (JSONException e) {
            Log.e("log_tag", "Error parsing data " + e.toString());
        }
        return returnString;

    }

}

} 
```

它正在做我想做的一切，除了解析数据。当我只想要食物名称时，它只是在屏幕上显示数据库的全部内容。有人可以帮忙吗？谢谢

编辑：这是我的 php 脚本的 json 输出的屏幕截图

![在此处输入图像描述](../Images/73d0769646f6642eb992af854b4965d4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:08:33.790

尝试

```
returnString += "Foodname: " + json_data.getString("food") + "\n"; 
```

代替

```
returnString += "\n\t" + jArray.getJSONObject(i); 
```

我认为这只会显示食物名称。我现在无法测试它，因为我在我的手机上写这个。

# regex - Visual Studio 2010 中有没有办法用序列中的下一个数字进行查找/替换？

> ID：11970452
> 
> 赞同：2
> 
> 时间：2012-08-15T13:47:21.737
> 
> 标签：regex, visual-studio-2010, sequence, replace

首先让我说我是大学生学习编程，所以请尽可能简单地解释你的答案（我对正则表达式并不熟悉）。我要做的是找到一些文本组并将其替换为相同的文本，但在末尾附加一个数字，并按此顺序继续，直到与我的搜索匹配的所有文本都已被替换。
例如，假设我的代码中出现了 100 次文本“foo*”。我想要做的是将“foo*”替换为“foo1”、“foo2”、“foo3”、......、“foo100”</p>

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:23:59.200

您可以使用正则表达式和 String 的`Replace`方法来做到这一点。

但是`Regex` **没有任何关键字来继续序列**。你必须自己做！

```
Regex r=new Regex("foo");
r.Replace("foo hey hello",get100s("foo"));

public string get100s(string inp)
{
string s="";
for(int i=1;i<100;i++)s+=(inp+i);
return s;
} 
```

相反，您可以使用字符串的`Replace`方法来做同样的事情..

```
s.Replace("foo",get100s("foo")); 
```

# wix - WriteRegistryValues 忽略自定义操作添加的临时行

> ID：11970453
> 
> 赞同：1
> 
> 时间：2012-08-15T13:47:24.993
> 
> 标签：wix, windows-installer, custom-action

我正在写一个 WIX 脚本。

我有一个自定义操作，可以将行动态添加到注册表表中：

```
function AddRegistry() 
{
    var registryView = Session.Database.OpenView("SELECT * FROM Registry");
    registryView.Execute();

    var record = Session.Installer.CreateRecord(6);
    record.StringData(1) = "Unique123456";
    record.IntegerData(2) = 2;
    record.StringData(3) = "Software";
    record.StringData(4) = "my_registry_string";
    record.StringData(5) = "value";
    record.StringData(6) = "MyComponent";

    registryView.Modify(7, record); //InsertTemporary
    registryView.Close();

    return 1; //Ok
} 
```

自定义操作计划在“WriteRegistryValues”操作之前作为“立即”运行：

```
<CustomAction Id="AddRegistry" BinaryKey="CustomActionJS" 
              JScriptCall="AddRegistry" 
              Execute="immediate" Impersonate="no" />

<InstallExecuteSequence>
    <Custom Action="AddRegistry" Before="WriteRegistryValues" />
    <Custom Action="CheckRegistry" After="WriteRegistryValues" />
...
</InstallExecuteSequence> 
```

我添加了第二个自定义操作，它枚举注册表，并显示刚刚找到的所有条目（固定和临时）。

但是，当 WriteRegistryValues 正在执行时（据我所知，它被推迟了），它只写入固定的条目。我的动态条目被忽略，并且没有添加到注册表中。

相同注册表路径的固定注册表条目可以正常工作：

```
<Component Id="MyComponent">
    <RegistryValue Id="Unique11111" Root="HKLM" Key="Software" 
                   Name="my_fixed_value" Value="my_value" 
                   Action="write" Type="string"/>
</Component> 
```

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:11:39.470

我使用通用方法这样做：（例如在 C# 中使用 DTF 作为 ActiveScript 自定义操作，例如 JScript/VBScript不是MSI[的最佳实践）](http://blogs.msdn.com/b/robmen/archive/2004/05/20/136530.aspx)

```
private static void InsertRecord(Session session, string tableName, Object[] objects)
{
  Database db = session.Database; 
  string sqlInsertSring = db.Tables[tableName].SqlInsertString + " TEMPORARY";
  session.Log("SqlInsertString is {0}", sqlInsertSring);
  View view = db.OpenView(sqlInsertSring); 
  view.Execute(new Record(objects)); 
  view.Close(); 
} 
```

使用它看起来像

```
object[] fields = new object[] { .... };
InsertRecord(session, "TableName", fields); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T21:59:47.390

好的！

我认为这是我们的 - 将行添加到 Registry 表的 CA 必须在**InstallValidate**之前运行（在**WriteRegistryValues**之前运行）

如此变化

```
<Custom Action="AddRegistry" Before="WriteRegistryValues" /> 
```

至

```
<Custom Action="AddRegistry" Before="InstallValidate" /> 
```

解决了问题

# vb.net - 自动注销 vb.net

> ID：11970455
> 
> 赞同：2
> 
> 时间：2012-08-15T13:47:36.923
> 
> 标签：vb.net, winforms, timer

我正在尝试为我的 vb.net 桌面应用程序实现自动注销功能。这是代码：

```
Private Sub AutoLogOffTimer(ByVal myUIContext As globals)

         If myUIContext.parameters.LogOutTime <> 0 Then
            myTimer = New System.Windows.Forms.Timer()
            myTimer.Enabled = False
            'myTimer.Dispose()
            myTimer.Interval = (myUIContext.parameters.LogOutTime * 60 * 1000) - 20000
            AddHandler myTimer.Tick, AddressOf logOutUser
            myTimer.Start()
            Application.AddMessageFilter(Me)
         ElseIf myUIContext.parameters.LogOutTime = 0 Then
            Application.RemoveMessageFilter(Me)
            RemoveHandler myTimer.Tick, AddressOf logOutUser
            myTimer.Stop()
            myTimer.Enabled = False
         End If
      End Sub

 Public Function PreFilterMessage(ByRef m As Message) As Boolean Implements    IMessageFilter.PreFilterMessage

         ' Monitor message for keyboard and mouse messages
         Dim active As Boolean = m.Msg = &H100 OrElse m.Msg = &H101
         ' WM_KEYDOWN/U
         'active = active OrElse m.Msg = &HA0 ' OrElse m.Msg = &H200
         active = active OrElse m.Msg = &HA3 OrElse m.Msg = &H201 OrElse m.Msg = &H202 OrElse m.Msg = &H1 OrElse m.Msg = &H200 OrElse m.Msg = &H2 OrElse m.Msg = &H208 OrElse m.Msg = &H2A3 OrElse m.Msg = &H2A1
         ' WM_(NC)MOUSEMOVE
         active = active OrElse m.Msg = &H10 OrElse m.Msg = &H3 OrElse m.Msg = &H5
         ' WM_CLOSE, in case dialog closes
         If active Then
            myTimer.Enabled = False
            myTimer = New System.Windows.Forms.Timer()
            If _myUIContext.parameters.LogOutTime <> 0 Then
               myTimer.Interval = (_myUIContext.parameters.LogOutTime * 60 * 1000) - 20000
               Try
                  RemoveHandler myTimer.Tick, AddressOf logOutUser
               Catch ex As Exception
               End Try
               AddHandler myTimer.Tick, AddressOf logOutUser
               myTimer.Start()
               myTimer.Enabled = True
            ElseIf _myUIContext.parameters.LogOutTime = 0 Then
               myTimer = New System.Windows.Forms.Timer()
               myTimer.Stop()
            End If
         End If
         Return False
      End Function

 Private Sub logOutUser(ByVal sender As Object, ByVal e As EventArgs)

         If Not isLogoutWindowOpen Then
            If ComputeCpuUsage() < 1 Then
               LogoutWindow = New LogoutApp(20)
               AddHandler LogoutWindow.logOutCancel, AddressOf logOutCancel
               AddHandler LogoutWindow.logOutProceed, AddressOf logOutProceed

               LogoutWindow.MdiParent = Me
               LogoutWindow.Show()
               myTimer.Stop()

               isLogoutWindowOpen = True
            Else
               myTimer.Enabled = False
               myTimer.Start()
            End If

         End If

      End Sub

  Private Sub logOutCancel()

         myTimer = Nothing
         myTimer = New System.Windows.Forms.Timer()
         myTimer.Enabled = False
         myTimer.Stop()
         If _myUIContext.parameters.LogOutTime <> 0 Then
            myTimer.Interval = (_myUIContext.parameters.LogOutTime * 60 * 1000) - 20000
            myTimer.Start()
         End If
         myTimer.Enabled = True
         isLogoutWindowOpen = False
      End Sub 
```

问题是当我将注销时间设置为 1 分钟时，如果我不在我的应用程序上做任何事情，它会在 1 分钟后给我注销窗口。但是在我取消我的注销窗口消息并开始在我的应用程序上工作后，注销消息框不断出现。首先我认为我的计时器没有正确重置，但如果没有 myTimer.Enabled=False 应该可以解决问题。 Start() 绝对应该做到这一点，但这似乎也不起作用。我检查了我的预过滤器消息，但仍然没有运气。

任何帮助将非常感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:50:17.833

好的，我想我可能已经弄清楚了你的问题。

有时，Windows 计时器不关心它们是否被空引用，并继续在没有父级的情况下触发它们的事件。我认为您的问题在于您的 logOutCancel 代码中您正在清除对计时器的引用，但不是首先禁用它。

在设置 myTimer = Nothing 的行之前尝试调用 myTimer.Stop()。

或者，为什么您需要不断创建新的计时器？你不能停下来然后重新开始你原来的吗？

# salesforce - 如何确定将哪些配置文件分配给记录类型

> ID：11970460
> 
> 赞同：1
> 
> 时间：2012-08-15T13:47:48.757
> 
> 标签：salesforce, apex-code

我有 90 个配置文件和一堆记录类型。企业想知道谁有权访问当前记录类型（选择列表..）

我知道如何做到这一点的唯一方法是逐个配置文件并检查记录类型设置并查看它是否已列出。

有没有办法只生成一个列表或其他东西？通过点击或顶点？

编辑：

我尝试在 .profiles 上进行搜索，但 eclipse 不支持多行搜索。虽然它确实支持正则表达式，但我无法正确使用正则表达式，或者 eclipse 不喜欢我。考虑到我糟糕的编程技能（以及我对电脑大喊大叫的方式），可能是后者。这是我要搜索的字符串。

```
<recordType>Event.RTEvent</recordType>
    <visible>false</visible> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T12:51:53.647

对于这样的事情，我发现[Notepad++](http://notepad-plus-plus.org/download)有很大的帮助。如果您启用扩展搜索模式（查找菜单底部的一个简单单选按钮），它支持多行搜索，允许您抓取换行符（\r、\n 等）。通过在 Windows 资源管理器中导航到 Eclipse 项目的配置文件文件夹，选择所有文件，然后右键单击并选择“使用 Notepad++ 编辑”，在所有配置文件中执行此操作也非常简单。全部打开后，按 ctrl-F，启用扩展搜索模式，然后搜索如下内容：

```
Event.RTEvent</recordType>\n        <visible>false 
```

请注意，您可能需要根据数据缩进的程度调整 \n 之后的空格数。单击“在所有打开的文档中查找全部”，它将为您提供配置文件中该字符串的所有出现的列表。

# ajax - Ajax onreadystatechange 在 4 版本以下的 Firefox 中无法使用 ajax 同步请求

> ID：11970462
> 
> 赞同：0
> 
> 时间：2012-08-15T13:47:54.933
> 
> 标签：ajax, http, request, synchronous

我正在使用 ajax 和 jquery 发送**同步 http 请求**。

我必须使用同步请求，因为我想在评估服务器端脚本的结果后 **从 ajax 函数返回一些值。**

我知道同步请求会冻结浏览器，但由于我的要求，我将不得不执行此请求。

我也知道在同步请求中没有使用 onreadystatechange 函数，我们应该在发送请求后或在发送函数下方评估我们的结果。通过这样做，我的代码处于工作状态。

但是，我的问题是，当我使用**onreadystatechange**函数时，它**在 firefox >=4**版本中工作，但**在 firefox 4 以下版本中不工作**。

请。帮助我找出问题是代码还是浏览器。

我现在无法找出错误我无能为力...请帮助这是我的代码

```
function test(txt_obj) {  
    var keywords = txt_obj.value;
    var SHttpRequestObject = false;  
    var url = "/speller/server-scripts/ifmisspelled_words.html" + '?keywords=' + keywords);  
    var speller_res = 0;  
    if (window.XMLHttpRequest){  
    SHttpRequestObject = new XMLHttpRequest();  
    } else if (window.ActiveXObject){  
    SHttpRequestObject = new ActiveXObject("Microsoft.XMLHTTP");  
    }  
    SHttpRequestObject.open("POST", url, false);  
    if (SHttpRequestObject){  
    SHttpRequestObject.onreadystatechange = function() {  
    if (SHttpRequestObject.readyState == 4 && SHttpRequestObject.status == 200)  
    {  
    var result = eval("(" + SHttpRequestObject.responseText + ")");  
    if(result.error) {  
    speller_res = 1;  
    } else if(result.word_exist) {  
    speller_res = 1;  
    }  
    else if(result.word_not_exist)  {  
    speller_res = 0;  
    }  
    }  
    };  
    }  
    SHttpRequestObject.send(null);  
    return speller_res;  

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-28T23:04:38.437

来自[MDN](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest?redirectlocale=en-US&redirectslug=XMLHttpRequest "MDN")：

> onreadystatechange
> 
> 警告：这不能从本机代码中使用。您也不应该将其用于同步请求。

# asp.net - 自动生成表单回发中的 FileUpload

> ID：11970471
> 
> 赞同：0
> 
> 时间：2012-08-15T13:48:35.993
> 
> 标签：asp.net, file-upload, auto-generate

我有个问题。我有一个在`asp.net`. 一般都有`fileupload companent`。在此时间页面回发比再次生成表单并且所选文件消失。我的问题是如何将这个文件保存在内存中？

我在文件选择中持有这个文件夹吗？

你对此有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:03:54.873

这是由于 asp.net 中的安全性。您无法指定文件上传的值，回发会将其清除。你可以通过异步处理来解决这个问题。尝试使用 AjaxToolKit 中的 AsyncFileUpload 控件。[您可以在http://www.kruegerwebdesign.com/blog/async-file-uploading-using-asp-net](http://www.kruegerwebdesign.com/blog/async-file-uploading-using-asp-net)了解如何使用它。

# c++ - How to limit access to class function from main function?

> ID：11970474
> 
> 赞同：0
> 
> 时间：2012-08-15T13:48:43.590
> 
> 标签：c++, function, class

How to limit access to class function from main function?

Here my code.

```
class Bar
{
public: void doSomething(){}
};

class Foo
{
public: Bar bar;
//Only this scope that bar object was declared(In this case only Foo class)
//Can access doSomething() by bar object.
};

int main()
{
    Foo foo;
    foo.bar.doSomething(); //doSomething() should be limited(can't access)
    return 0;
} 
```

PS.Sorry for my poor English.

* * *

**Edit**: I didn't delete old code but I expand with new code. I think this case can't use friend class. Because I plan to use for every class. Thanks

```
class Bar
{
public:
    void A() {} //Can access in scope that object of Bar was declared only
    void B() {}
    void C() {}
};

class Foo
{
public:
    Bar bar;
    //Only this scope that bar object was declared(In this case is a Foo class)
    //Foo class can access A function by bar object

    //main function need to access bar object with B, C function
    //but main function don't need to access A function
    void CallA()
    {
        bar.A(); //Correct
    }
};

int main()
{
    Foo foo;
    foo.bar.A(); //Incorrect: A function should be limited(can't access)    
    foo.bar.B(); //Correct
    foo.bar.C(); //Correct
    foo.CallA(); //Correct
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T13:49:52.787

Make `Foo` a friend of `Bar`

```
class Bar
{
    friend class Foo;
private:
    void doSomething(){}
}; 
```

And also avoid making member variables `public`. Use `setters/getters` instead

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T13:50:25.610

You can define Foo as a friend class of Bar and make doSomething() private.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T13:53:25.673

Making `Bar bar` private inside `Foo` would do the trick, would it not? Then only the class `Foo` could use `bar`.

# javascript - 当浏览器窗口突然失去焦点时，如何从元素中删除：悬停？

> ID：11970483
> 
> 赞同：1
> 
> 时间：2012-08-15T13:49:09.890
> 
> 标签：javascript, jquery, magic-methods

例如：打开[这个简单的 jsfiddle](http://jsfiddle.net/scythargon/932Km/)并像这样放置您的窗口：![这](../Images/9bdc11f015c3e981b3449befb9de2830.png)：然后将光标放在 jsfiddle 红色区域上使其变为`:hover`（绿色），现在将光标移动到另一个窗口。区域仍然绿色！如何避免它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:50:42.277

您必须单击新窗口才能使悬停元素失去焦点。即使您将鼠标悬停在不同的窗口上，jsFiddle 窗口仍然具有焦点。在您单击新窗口之前，窗口焦点不会改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:01:49.627

我认为您不能明确删除：悬停。您可以做的是更改您的 css 以要求一些具有类的外部容器，然后在窗口失去焦点时将其删除：

JS

```
$(window).focus(function () {
    $("#outer").addClass('focusedContainer');
});
$(window).blur(function () {
    $("#outer").removeClass('focusedContainer'); 
});​ 
```

CSS

```
.button{
    background: red;
}
.focusedContainer>.button:hover{
    background: green;
} 
```

小提琴： http: [//jsfiddle.net/johnkoer/932Km/11/](http://jsfiddle.net/johnkoer/932Km/11/) ​</p>

# html - 在 CSS 中重新创建设计

> ID：11970487
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:49:24.310
> 
> 标签：html, css

如果文本是可变的并且我每次都不知道它的长度，如何在 CSS 中重新创建此文本效果？（它来自 CMS）

我还希望背景有轻微的不透明度，而不是文字。

![文字截图](../Images/224a6bb9ddde1b723e5e35cf131fa917.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:52:35.333

两个带填充的 div。背景将使用 rgba，因此您可以控制不透明度。例如：

```
div { padding: 10px; background: rgba(255,255,255,.5) } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T13:52:56.000

对于透明背景：

```
<element>{
    background-color: rgba(255,102,0,.75);
} 
```

最后一个值`a`是不透明度。要使其在 Internet-Explorer 中工作，请使用过滤器：

```
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#BFFF6600,endColorstr=#BFFF6600);
zoom: 1; 
```

前两个十六进制数字是不透明度 ( `0 = 00, 100% = FF`)，最后 6 个是十六进制值中的颜色。

要使段落与它们包含的文本长度完全相同，请使用以下命令：

```
p{
   display:inline-block;
   padding: <at will>;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:58:25.193

给内联或内联块元素一个半透明的背景和一点填充。RGBA 颜色最容易实现半透明。（有关浏览器兼容性，请参阅[http://caniuse.com/#search=rgba](http://caniuse.com/#search=rgba)）。

例子：

```
.text
{
    display: inline;
    background-color: rgba(255, 100, 0, 0.8);
    padding: 10px;
    color: #fff;
    font-weight: bold;
} 
```

[http://jsfiddle.net/6XUh7/](http://jsfiddle.net/6XUh7/)

# android - 带有 Android 的边框手势

> ID：11970491
> 
> 赞同：7
> 
> 时间：2012-08-15T13:49:40.757
> 
> 标签：android, android-gesture

我正在开发一个应用程序（在 Galaxy Nexus 上），我注意到当您从挡板底部滑动到屏幕上时，Google 实现了“Google Now”应用程序（chrome 浏览器也这样做了一段时间，而不是确定它是否仍然存在）。我一直在环顾四周，但无法确定他们是如何做到这一点的。有没有一种简单的方法来处理从边框而不是屏幕开始的手势？

我检查了开发人员页面以供参考，但我能找到的唯一文章在这里：

[http://developer.android.com/design/patterns/gestures.html](http://developer.android.com/design/patterns/gestures.html)

有没有其他地方可以获得这些信息？

[编辑]

我一直在尝试根据 Lain_B 的方法使边缘手势工作，但未能成功，但无法使其工作。这是我用来尝试检测手势的代码，但 logcat 总是输出零......

```
public class MainActivity extends Activity implements OnGestureListener {

private GestureDetector myGesture;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    myGesture = new GestureDetector(getBaseContext(),
            (OnGestureListener) this);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    Log.e("Flags Touch", "Flags: " + event.getEdgeFlags());
    return myGesture.onTouchEvent(event);
}

@Override
public boolean onDown(MotionEvent e) {
    Log.e("Flags", "Flags: " + e.getEdgeFlags());
    Log.e("Event", "onDown");
    // TODO Auto-generated method stub
    return false;
}

@Override
public void onLongPress(MotionEvent e) {
    Log.e("Event", "onLongPress");
    // TODO Auto-generated method stub

}

@Override
public void onShowPress(MotionEvent e) {
    Log.e("Flags", "Flags: " + e.getEdgeFlags());
    Log.e("Event", "onShowPress");
    // TODO Auto-generated method stub

}

@Override
public boolean onSingleTapUp(MotionEvent e) {
    Log.e("Event", "onSingleTapUp");
    // TODO Auto-generated method stub
    return false;
}

@Override
public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX,
        float distanceY) {
    // Log.e("Event", "onScroll");
    return false;
}

// these constants are used for onFling
private static final int SWIPE_MIN_DISTANCE = 120;
private static final int SWIPE_MAX_OFF_PATH = 250;
private static final int SWIPE_THRESHOLD_VELOCITY = 200;

@Override
public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,
        float velocityY) {

    Log.e("Event", "onFling");
    Log.e("Flags", "Flags: " + e1.getEdgeFlags());

    if (e1.getEdgeFlags() == MotionEvent.EDGE_LEFT) {
        // code to handle swipe from left edge
        Log.e("!!!!!", "Edge fling!");
    }

    try {
        // do not do anything if the swipe does not reach a certain length
        // of distance
        if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
            return false;

        // right to left swipe
        if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                && Math.abs(velocityX) < SWIPE_THRESHOLD_VELOCITY) {

        }
        // left to right swipe
        else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                && Math.abs(velocityX) < SWIPE_THRESHOLD_VELOCITY) {

        }
    } catch (Exception e) {
        // nothing
    }
    return false;

}
} 
```

[编辑 2]

使用 Lain_B 的请求输出...

（使用 Nexus 7）... 从挡板上可能的最左侧点开始，然后向右滑动到中间（ish）。

```
08-16 16:44:13.674: I/Fling(16702): Flags: 0
08-16 16:44:13.674: I/Fling(16702): e1: 2.5 711.5152
08-16 16:44:13.674: I/Fling(16702): e2: 215.4591 717.08105 
```

从屏幕中心点滑出屏幕（向右）

```
08-16 16:46:37.364: I/Fling(16702): Flags: 0
08-16 16:46:37.364: I/Fling(16702): e1: 392.5 758.1818
08-16 16:46:37.364: I/Fling(16702): e2: 783.4375 743.3334 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-15T14:01:20.127

我认为[MotionEvent.getEdgeFlags()](http://developer.android.com/reference/android/view/MotionEvent.html#getEdgeFlags%28%29)是您正在寻找的。然后，您可以将返回的值与[EDGE_LEFT](http://developer.android.com/reference/android/view/MotionEvent.html#EDGE_LEFT)、 EDGE_RIGHT 等进行比较，以查看触摸了哪个边缘。

```
if( event1.getEdgeFlags()&MotionEvent.EDGE_LEFT != 0 ){
    //code to handle swipe from left edge
} 
```

或者

```
if( e1.getX() < 5.0f ){
    //handle swipe from left edge
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-08T22:50:39.340

**依赖 MotionEvent.getEdgeFlags 是错误的。**有关更多信息，请参阅此讨论：[https ://groups.google.com/forum/?fromgroups=#!topic/android-developers/ZNjpzbkxeNM](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/ZNjpzbkxeNM)

从概念上讲，要检测边缘滑动，您需要检测拖动/滚动事件，并确保向下事件的原始“x”坐标在距边缘一定距离内。

最简单的方法是使用 GestureDetector 来检测拖动/滚动。幸运的是 SimpleOnGestureListener 的 onScroll 方法有你需要的一切。

所以像这样（如果您使用的是配置了 SimpleOnGestureListener 的 GestureDetector）：

```
 public boolean onScroll (MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) {

        if (e1.getX() < SOME_DISTANCE_FROM_SCREEN) {
           //your code  
           return true;
        }
        return false;
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-17T00:17:39.020

好吧，我的解决方案是完全不同的，因为我试图实现边缘滑动/边框滑动功能（类似于 iOS），但从右到左。

我创建了一个 Gesture Manager 类，它处理（现在）投掷并将手势（开始和结束）的距离与屏幕大小进行比较。

无论如何，这里是：

```
public class GestureManager {

private static final String TAG = GestureManager.class.getSimpleName();

private Context context;
private Presenter presenter;
private GestureDetector gesture;

public GestureManager(Context context, Presenter presenter) {
    this.context = context;
    this.presenter = presenter;
    this.gesture = new GestureDetector(context,
            new GestureDetector.SimpleOnGestureListener() {
                @Override
                public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
                    int deviceWidth = Helper.getDeviceWith();
                    //Log.d(TAG, "onFling e1: "+e1.getX()+" e2: "+e2.getX()+" deviceWidth: "+deviceWidth * 0.80);
                    if (context instanceof DeckMainActivity){
                        if (!presenter.isSideBarVisible() && e1.getX() > deviceWidth * 0.98 && e2.getX() > deviceWidth * 0.80) {
                            presenter.showSideBar();
                            return true;
                        }
                    }
                    return false;
                }

            });
}

public GestureDetector getGesture(){
    return gesture;
} 
```

希望能帮助到你 ：）

# java - 带有来自 URL 的自定义图标的 Android ListView

> ID：11970492
> 
> 赞同：0
> 
> 时间：2012-08-15T13:49:44.847
> 
> 标签：java, android, listview, icons

我需要在我的列表视图（或合适的替代方案）中显示从 json 提要中检索的选项列表。我有这个工作。我还能够使用 dhuckabys 主要图像加载器（https://github.com/DHuckaby/Prime）从 json 将图像 url 处理为可绘制对象。

我可以通过创建一个字符串数组并将其传递给适配器来显示一个文本列表，我只是想不出一种在列表中显示我的可绘制对象的方法。我发现的所有示例都显示了如何使用 drawables 文件夹中的图标。

理想情况下，我想通过我的 json 进行交互，处理图像 url 并添加可绘制对象和标题，以便它可以显示在列表中。

我试过制作自定义列表适配器但没有成功。

任何帮助或相关教程的链接都会有所帮助。我只能找到使用本地绘图的教程。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:43:21.360

首先创建一个自定义 xml 来扩充您的 listView 。在这个 xml 中添加一个 imageview 。那么在你得到图片的 URL 之后，你可以做这样的事情

```
 ImageView image = (ImageView) v.findViewById(R.id.avatar);

   image.setImageBitmap(getBitmap(image_url));

  public Bitmap getBitmap(String bitmapUrl) 
           {
               try  
               {
                 URL url = new URL(bitmapUrl);
                 return BitmapFactory.decodeStream(url.openConnection().getInputStream()); 
                }
                catch(Exception ex) {return null;}
} 
```

根据您的需要递归地或一次执行此操作。也很抱歉没有发布完整的代码，但这应该可以帮助您了解您需要做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:55:58.050

您可以使用此代码从 url 获取图像

```
URL url = new URL(imageUrl);
HttpURLConnection connection  = (HttpURLConnection) url.openConnection();

InputStream is = connection.getInputStream();
Bitmap img = BitmapFactory.decodeStream(is); 
```

您可以使用位图 obj 将图像设置为您的列表视图 希望这是您所需要的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:59:48.500

如果您想异步下载以避免滞后，请查看此库： [https ://github.com/nostra13/Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)

# ruby-on-rails - 寻找标记日期时间字段的 gem

> ID：11970496
> 
> 赞同：0
> 
> 时间：2012-08-15T13:50:02.843
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, datetime, gem

我得到了日期时间字段**order_confirmed_at**和**completion_confirmed_at**

```
class CoolModel < ActiveRecord::Base
  attr_accessible :order_confirmed, completion_confirmed

  def order_confirmed
    order_confirmed_at.present?
  end

  def order_confirmed=(state)
    if state and order_confirmed_at.blank?
      self.order_confirmed_at = Time.now
    end
    order_confirmed_at.present?
  end

  def completion_confirmed
    completion_confirmed_at.present?
  end

  def completion_confirmed=(state)
    if state and completion_confirmed_at.blank?
      self.completion_confirmed_at = Time.now
    end
    completion_confirmed_at.present?
  end
end 
```

...所以在我看来，我可以检查订单已确认并完成的复选框

事情是：这不仅是重复，而且这些东西显然看起来很标准。因此，为了节省我编写 gem 的时间：**是否有 rails gem/engine 这样做（或者可能是我不知道的 Rails 的一部分）？**

```
class CoolModel < ActiveRecord::Base
  #something like this 
  acts_even_coller_on :order_confirmed_at, :completion_confirmed_at
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:08:02.217

你可以重写setter方法。

```
def confirmed_at=(value)
  super value == "true" ? confirmed_at || Time.now : nil
end 
```

# javascript - ember-data 的单记录持久性

> ID：11970498
> 
> 赞同：0
> 
> 时间：2012-08-15T13:50:06.537
> 
> 标签：javascript, ruby-on-rails, ember.js, ember-data

在带有 ember-data（使用 1.0pre 版本）的 Ember.js 中，对数据的所有更改都保存到存储中的 defaultTransaction 中。当存储提交时`store.commit()`，对数据的所有更改都会保存回 API（使用 RESTAdapter）。

我想要更多地控制被持久化的对象。所以现在，我一直在获取 store 和 adapter 的实例，然后调用类似`adapter.createRecord(store, type, record)`或`updateRecord`where `type`is the `App.Person`model 和 record 是该模型的实例。

这是使用`DS.RESTAdapter`我认为不应该直接使用的内部位。虽然它有效，但我希望有更好的方法来获得对持久性的更多控制`store.commit()`。我的应用程序的业务逻辑和用户体验需要更好的控制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T18:15:29.817

```
transaction = router.get('store').transaction();
person = transaction.createRecord(App.Person);

person.set('name', 'Thanatos');

transaction.commit(); 
```

观看关于此的 yehuda 演示。 [http://www.cloudee.com/preview/collection/4fdfec8517ee3d671800001d](http://www.cloudee.com/preview/collection/4fdfec8517ee3d671800001d)

# c - 在 Linux 中安装一个新库，并从我的 C 代码中访问它

> ID：11970499
> 
> 赞同：0
> 
> 时间：2012-08-15T13:50:07.113
> 
> 标签：c, linux, makefile, static-libraries

我正在做一个需要我下载和使用[它](http://code.google.com/p/cubesat-space-protocol/downloads/detail?name=cubesat-space-protocol-0.9.tar.gz&can=2&q=)的项目。在下载的文件夹中，提取后我会看到三件事：

1.  一个名为“包含”的文件夹
2.  一个名为“src”的文件夹
3.  一个名为“Makefile”的文件

经过一番研究，我发现我必须导航到包含这些文件的目录，然后输入命令`make`。

它似乎在我的系统中安装了库。所以我尝试了一个应该使用库的示例代码：

```
csp_conn_t * conn;
csp_packet_t * packet;
csp_socket_t * socket = csp_socket(0);
csp_bind(socket, PORT_4);
csp_listen(socket, MAX_CONNS_IN_Q);

while(1) {
    conn = csp_accept(socket, TIMEOUT_MAX);
    packet = csp_read(conn, TIMEOUT_NONE);
    printf(“%S\r\n”, packet->data);
    csp_buffer_free(packet);
    csp_close(conn);
} 
```

这就是为代码的示例服务器端提供的所有内容。所以我决定将这些添加到顶部：

```
#include <csp.h>
#include <csp_buffer.h>
#include <csp_config.h>
#include <csp_endian.h>
#include <csp_interface.h>
#include <csp_platorm.h> 
```

以为我走在正确的轨道上，我尝试用 gcc 编译代码，但出现了这个错误：

```
csptest_server.c:1: fatal error: csp.h: No such file or directory
compilation terminated. 
```

我想我可能没有正确安装库，但是为了确保，我发现我可以通过运行这个命令来检查，并得到这个结果：

```
find /usr -iname csp.h
/usr/src/linux-headers-2.6.35-28-generic/include/config/snd/sb16/csp.h
/usr/src/linux-headers-2.6.35-22-generic/include/config/snd/sb16/csp.h 
```

所以看起来 csp.h 已安装，也许我在标题包含行中错误地引用了它？有什么见解吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:56:39.697

该`make`命令可能只是构建库，而不是安装它。你可以试试`sudo make install`。这是“常用”方法，但我建议您查看库的文档（如果有）。

`sudo`仅当您无权写入系统的包含和库目录时才需要该命令，这可能是您的情况。

另一种可能性（而不是安装库）是告诉 GCC 库的源代码和生成的二进制文件的位置（通过`gcc`命令的 -I 和 -L 选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T13:59:34.840

该 Makefile 不会安装任何东西，只是将源代码转换为二进制格式。

Linux内核中的`csp.h`与您的项目无关，它只是命名冲突，可能发生在三个字母名称中。

在您的情况下，我假设您需要将包含目录添加到服务器的编译标志中，例如`gcc -I/path/to/csp/include/csp csptest_server.c`.

（接下来，您将遇到链接器错误，因为您还需要指定`-L/path/to/csp -lcsp`以便链接器可以找到要链接的二进制代码。）

# wix - 如何找出运行 msi 安装程序的位置

> ID：11970500
> 
> 赞同：5
> 
> 时间：2012-08-15T13:50:09.910
> 
> 标签：wix

谁能告诉我如何找出运行 msi 安装程序的位置。

例如，我`Sample.msi`在桌面上的 InstallerExample 文件夹中有我的和 Manuals 文件夹。

我需要这些信息，以便我可以在 File/@Source 中使用它，如下所示。

```
<File Id="MyFileId" Name="MyFile" Source="[SourceDir]Manuals" KeyPath="yes" > 
```

`SourceDir`应该有价值`C:\Users\bla\Desktop\InstallerExample\Manuals`

如果有人能帮我解决这个问题，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:05:58.700

我只是遇到了同样的问题，因为我希望我的自定义操作从我的 MSI 所在的位置读取文件，所以我需要路径。我能够使用

```
TARGETDIR 
```

根据 MSDN 文档 TARGETDIR 是

```
the root destination directory for the installation 
```

同样根据 MSDN，SourceDir 是

```
the root directory that contains the source cabinet file or the source file tree of the installation package 
```

因此 SourceDir 属性指向一个真实的目录：您的 MSI 文件所在的目录。使用 msiexec /lvx* installer.log installer.msi 安装时，您可以在安装程序日志中看到这一点。

但是，由于某种原因，在解析 TARGETDIR 时会完全忽略 SourceDir。TARGETDIR 必须要么明确设置（例如在命令行上），要么解析为 ROOTDRIVE。如果 ROOTDRIVE 未明确设置，则它是具有最多可用空间的驱动器的根目录。

# c++ - 累积和ostringstream编译错误

> ID：11970503
> 
> 赞同：2
> 
> 时间：2012-08-15T13:50:17.987
> 
> 标签：c++

我在标记的行中收到以下编译错误：

> 错误：请求从 '<code>std::basic_ostream<char, std::char_traits<char>>' 转换为非标量类型 '<code>std::ostringstream'

你能帮我纠正我的例子吗？

```
#include <numeric>
#include <sstream>

using namespace std;

ostringstream ConvertLettersToNumbers(ostringstream acc, char input)
{
    if(isdigit(input))
    {
        return acc << input; // error
    }
    else
    {
        return acc << static_cast<int>(input); // error
    }
};

int main(int argc, char **argv)
{
    string stringToCovert = "ABC";

    ostringstream out = accumulate(stringToCovert.begin(), stringToCovert.end(),     
         string(), ConvertLettersToNumbers);

    string convertedString = out.str(); // expected "656667"

    return 0;
} 
```

**编辑**：我的第一个版本使用有效但很慢的字符串：

```
 string ConvertLettersToNumbers(string acc, char input)
    {
        if(isdigit(input))
        {
            return acc + input;
        }
        else
        {
            stringstream sstr;
            sstr << static_cast<int>(input);
            return acc + sstr.str();
        }
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:51:55.290

结果`acc << input`是`std::ostream&`。您丢失了原始流的具体类型。你可以通过演员来解决这个问题：

```
return static_cast<std::ostringstream&>(acc << input); 
```

* * *

如果这种情况经常出现，您可以想象一个可变模板化的助手：

```
return covariant_stream(acc, input, input2, "separator", input3); 
```

* * *

由于您的代码有许多其他错误，这里有一个固定的骨架：

```
#include <ostream>
#include <sstream>

#define using abusing

std::ostringstream & ConvertLettersToNumbers(std::ostringstream & acc, char input)
{
    return static_cast<std::ostringstream&>(acc << input);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:40:26.687

使用不同的算法。您不想将元​​素添加在一起（这就是`accumulate`目的），您希望将`transform`您的序列变成另一种序列。

考虑这种方法：

```
int ConvertLetterToNumber(char input)
{
    if(std::isdigit(input))
    {
        return input - '0';
    }
    else
    {
        return input;
    }
};

int main(int argc, char **argv)
{
    std::string stringToConvert = "ABC";
    std::ostringstream stream;
    std::transform(stringToConvert.begin(),
            stringToConvert.end(),
            std::ostream_iterator<int>(stream),
            ConvertLetterToNumber);

    std::string convertedString = stream.str();

    return 0;
} 
```

有关工作示例，请参见[此处](http://ideone.com/vaaHE)

# javascript - 是否可以将变量从 JavaScript 安全地传递到 Flash 应用程序？

> ID：11970507
> 
> 赞同：2
> 
> 时间：2012-08-15T13:50:36.447
> 
> 标签：javascript, actionscript-3, flash, security, browser

[JavaScript 和 Flash 应用程序之间的ExternalInterface API](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)调用在设计上有多安全？驻留在同一个 HTML 容器中（在客户端）？

**它可以被 - 按照设计 - 拦截吗？**

提示：ExternalInterface API 参考（上图）为

> ExternalInterface 类要求用户的 Web 浏览器支持**ActiveX®**或某些浏览器公开的用于插件脚本的**NPRuntime API。**请参阅 [http://www.mozilla.org/projects/plugins/npruntime.html](http://www.mozilla.org/projects/plugins/npruntime.html)。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:07:35.980

取决于你所说的拦截是什么意思？如果您信任`ExternalInterface`正在调用的页面/沙箱，那么它是安全的。我能想到的唯一攻击媒介是黑客修改`__flash__toXML`javascript 函数。

还有一点值得注意的[`ExternalInterface.call`是容易受到XSS攻击](http://lcamtuf.blogspot.co.uk/2011/03/other-reason-to-beware-of.html)；因此，如果参数来自用户，则必须始终对其进行清理。

# sql - 如何按第一列区分

> ID：11970508
> 
> 赞同：0
> 
> 时间：2012-08-15T13:50:39.557
> 
> 标签：sql, distinct

```
Select DISTINCT wpg.ID as id1,wr.ID as id2
FROM Table1 wpg
inner join Table2 wp ON wp.WpgId = wpg.ID
inner join Table3 wr ON wr.WpId = wp.ID 
```

我需要 wpg.Id distinct 怎么做？

我需要：

> 1 2
> 
> 2 3
> 
> 1 4

得到：

> 1 2
> 
> 2 3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:52:50.383

答案取决于您想对第二列做什么。我假设你想要最小值：

```
select
    wpg.ID as id1,
    min(wr.ID) as id2
from
    Table1 wpg
    inner join Table2 wp on wp.WpgId = wpg.ID
    inner join Table3 wr on wr.WpId = wp.ID
group by
    wpg.ID 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T13:53:08.957

```
select wpg.ID, min(wr.ID)
FROM Table1 wpg 
inner join Table2 wp ON wp.WpgId = wpg.ID 
inner join Table3 wr ON wr.WpId = wp.ID 
group by wpg.ID 
```

# ruby - 在 rspec 测试中放入方法

> ID：11970510
> 
> 赞同：23
> 
> 时间：2012-08-15T13:50:43.417
> 
> 标签：ruby, rspec

my_file_spec.rb：

```
require 'spec_helper'
require 'my_file'

module M
  describe C do
    it 'should print everything' do
      c = C.new
      c.meth.should == "something"
    end
  end
end 
```

我的文件.rb：

```
module M
  class C
    puts "class TEXT" # label1
    def meth
     puts "method TEXT" # label2
     return "something"
    end
  end
end 
```

输出是：

```
class TEXT

M::C
  should print everything

Finished in 0.75 seconds
1 example, 0 failures 
```

最后是一个问题：“为什么`label2`在测试运行后没有打印 -- ("method TEXT")？”

PS Ruby192，rspec2

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-08-15T14:04:08.717

尝试使用`$stderr.puts "method TEXT"`. 这对我有用。请注意，编写具有您需要手动检查的输出的测试被认为是不好的做法，但我想您已经知道......

# java - 如何在 JBoss EAP6/AS7 中的安全约束之前应用过滤器

> ID：11970514
> 
> 赞同：3
> 
> 时间：2012-08-15T13:51:01.287
> 
> 标签：java, jakarta-ee, jboss, security, jaspic

**编辑：** 在某些情况下，我使用自定义安全域并手动调用 request.login。我没有使用标准的 FORM 身份验证。

**编辑：** 似乎我真正想要的是一种使用jboss 中配置的自定义而不是 j_security_check来复制`<login-config>`功能的方法。`<security-domain>`

我需要能够在我的网络应用程序中做两件不同的事情。首先，我需要能够确定用户是否经过身份验证，如果不是，我想将他们重定向到登录页面。我为此使用了过滤器。其次，我需要确定用户是否具有正确的角色才能查看我的 webapp 中的某些页面。看起来 web.xml 文件中的 security-constraint 标记将是这项工作的合适工具，但始终先应用此规则，然后再应用任何过滤器。这意味着用户在被拒绝访问页面之前永远没有机会登录，因为他缺乏适当的角色。

我能想到的唯一解决方案是手动检查过滤器中的用户角色，而不是使用安全约束，但这并不是一个好的解决方案。我想知道这里是否缺少一些东西，因为这似乎是一个非常常见的用例。作为参考，我的过滤器和示例安全约束粘贴在下面。

**编辑：** 我使用过滤器检查授权的原因是因为您只能为特定错误定义一个错误页面（在这种情况下，403 访问被拒绝）。例如，具有“客户”角色的人尝试访问 searchCustomer 页面。我的安全约束将该页面限制为角色为“admin”或“user”的用户，因此会生成 403 错误并将用户重定向到配置的错误页面 error.xhtml。未登录的第二个用户尝试访问 main.xhtml。因为他没有登录，所以他缺少 3 个允许的角色之一，因此他也收到 403 错误并被重定向到 error.xhtml。但是，因为他没有登录，我宁愿将他重定向到登录页面。

```
<security-constraint>
    <display-name>SecureApplicationConstraint</display-name>
    <web-resource-collection>
        <web-resource-name>SecureApplication</web-resource-name>
        <description>SecureApplication</description>
        <url-pattern>/main.xhtml</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>admin</role-name>
        <role-name>user</role-name>
        <role-name>customer</role-name>
    </auth-constraint>
</security-constraint>
    <security-constraint>
    <display-name>SearchCustomerPage</display-name>
    <web-resource-collection>
        <web-resource-name>SecureApplication</web-resource-name>
        <description>SecureApplication</description>
        <url-pattern>/searchCustomer.xhtml</url-pattern>
    </web-resource-collection>
    <auth-constraint>
        <role-name>admin</role-name>
        <role-name>user</role-name>
    </auth-constraint>
</security-constraint>
<error-page>
    <error-code>403</error-code>
    <location>/error.xhtml</location>
</error-page> 
```

筛选：

```
@Override
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {

    HttpServletRequest req = (HttpServletRequest) request;   
    String uri = req.getRequestURI();

    if ((null != req.getUserPrincipal()) 
            || uri.endsWith("login.xhtml")
            || uri.endsWith("error.xhtml")
            || uri.contains(ResourceHandler.RESOURCE_IDENTIFIER)) {
        chain.doFilter(request, response);
    } else {
        HttpServletResponse res = (HttpServletResponse) response;
        res.sendRedirect(req.getContextPath() + "/login.xhtml?from=" + URLEncoder.encode(uri, "UTF-8"));
        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T08:29:29.093

您可以使用 Java EE 6 中的 JASPI/JASPIC API 来执行此操作。

出于某种原因或其他 JBoss 要求您首先激活此 API，但他们有一个关于如何执行此操作的 wiki 页面。

# c - 通过索引访问数组的项

> ID：11970515
> 
> 赞同：0
> 
> 时间：2012-08-15T13:51:02.390
> 
> 标签：c, optimization, compiler-construction

假设我在循环中使用数组的一项，例如

```
INS *in;
for (int i = 0; i < LEN; i++) {
    in = g_ins[i];
    if (strcmp(in->mne, str) == 0)
        return in;
} 
```

如果我使用索引引用每个引用，编译器会针对上面的内容进行优化，或者它真的一次又一次地访问每个索引？

```
for (int i = 0; i < LEN; i++) {
    if (strcmp(g_ins[i]->mne, str) == 0)
        return g_ins[i];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:52:18.973

很大程度上取决于您的编译器和编译器设置。

不过，一般我不会担心它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:30:07.220

如果有疑问，您可以尝试一下。例如，将您的两段代码放入函数中：

```
INS * f1 (INS *g_ins, const char * str)
{
    for (int i = 0; i < LEN; i++) {
        INS *in = &g_ins[i];
        if (strcmp(in->mne, str) == 0)
            return in;
    }
    return NULL;
}

INS * f2 (INS *g_ins, const char * str)
{
    for (int i = 0; i < LEN; i++) {
        if (strcmp(g_ins[i].mne, str) == 0)
            return &g_ins[i];
    }
    return NULL;
} 
```

然后用 -O2 和 -S 编译它们（例如。`gcc -std=c99 -O2 -S -Wall code.c -o code.s`）。-O2 设置优化级别，-S 告诉编译器生成汇编代码并停止。

然后看汇编代码。

即使您不太了解汇编程序，您也应该能够了解这两个函数的相对大小。对于您的函数，它们编译为相同的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:09:45.787

对于几乎任何级别的优化，编译器可能会为两个片段生成相同的代码。事实上，如果没有优化，没有显式局部变量的版本可能会更好，因为它不需要`g_ins[i]`显式存储 的值；它可能只是放入一个寄存器并使用两次。

但是，它确实取决于您使用的编译器和优化设置。而且这里的任何区别都不太可能是快速程序和慢速程序之间的区别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T14:10:54.670

大多数情况下，编译器会在正常设置中避免此类事情。您的变量是在循环之外声明的，编译器不确定在循环之后是否有进一步使用 INS *in。所以跳过这个阶段不会做太多优化，除了保存几个指令，但可能导致后期输出损坏。

# c# - 复合一些任意的正则表达式（或者，许多小的正则表达式比一个大的好）

> ID：11970519
> 
> 赞同：0
> 
> 时间：2012-08-15T13:51:12.853
> 
> 标签：c#, regex, performance

我有许多用户定义的`Regex`es 用于测试某些`string`s 以查看是否应该排除它们。

```
private readonly IEnumerable<Regex> exclusions = <some user defined source>;

static bool Exclude(string value)
{
    return this.exclusions.Any(regex => regex.IsMatch(value);
} 
```

我在想，有没有办法将集合`exclusions`组合成一个组合`exclusion` `Regex`，这样我就可以从`Exclude`函数中删除迭代，就像这样。

```
static bool Exclude(string value)
{
    return this.exclusion.IsMatch(value);
} 
```

这种方法是否可行，是否具有潜在的性能优势，还是只是将迭代的负担推到正则表达式处理器中？

* * *

**编辑**

所以，我可以简单地做，

```
var exclusion =
    new Regex(string.Join("|", exclusions.Select(e => e.ToString())); 
```

有没有更复杂的选择？

* * *

**编辑 2**

我已经决定，由于我无法控制正则表达式，因此盲目地组合它们是一种天真的方法，更可能导致错误而不是提高性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:01:24.897

逻辑或：

```
regex1 | regex2 | ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:01:30.560

我不明白您为什么要这样做，您当前的代码对我来说看起来不错，但我认为您可以获取定义正则表达式的所有字符串并将它们组合成一个这样的：

```
(?:(?:REGEX1)|(?:REGEX2)|(?:REGEX3)|(?:REGEX4)) 
```

# c# - C# (MVC3) 存储过程 LINQ SQL

> ID：11970521
> 
> 赞同：1
> 
> 时间：2012-08-15T13:51:29.767
> 
> 标签：c#, asp.net-mvc-3, linq, stored-procedures

我有一个问题，包括通过存储过程显示表中的**所有**数据。我正在使用 LINQ 访问我的存储过程，但问题是我的结果（显示的数据）只是我的表中的最后一行。我无法让它工作......如果有人可以帮助我/解释我做错了什么，我将不胜感激。

**模型：** `RecipeModel`

```
public class RecipeModel
{
.....
        public void GetAllRecipes()
        {
            DataClassesDataContext db = new DataClassesDataContext();        

            var result = db.p_get_all_recipes();

            foreach (var r in result)
            {
                this.recipeName = r.name;
                this.recipeDescription = r.description;
                this.recipeSteps = r.steps;
                this.createdAt = r.createdAt;
                this.updatedAt = r.updatedAt;
                this.ownerID = r.owner_id;
            }

        } 
```

**控制器**：`RecipeController`

```
public class RecipeController : Controller
{
        [HttpGet]
        public ActionResult Index()
        {
            RecipeModel rec = new RecipeModel();
            rec.GetAllRecipes();

            return View(rec);
} 
```

**查看（剃刀）**：`Index`

```
@model MVC3_LINQ_SP.Models.RecipeModel
@{
    ViewBag.Title = "Index";
}

<legend>Recipe </legend>

        <p>@Html.DisplayFor(model => model.rName)</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T13:59:41.317

您实际上并没有返回存储过程的值，`RecipeModel`而是覆盖了 的属性。

您应该创建一个 Recipe 类来保存存储过程的返回：

```
public class Recipe
{
    public string recipeName { get; set; }
    public string recipeDescription { get; set; }
    public string recipeSteps { get; set; }
    public DateTime createdAt { get; set; }
    public DateTime updatedAt { get; set; }
    public DateTime ownerID { get; set; }
} 
```

然后更改您的程序以填写此内容 - 我假设 db.p_get_all_recipes() 正在返回可查询或列表：

```
public IQueryable<Recipe> GetAllRecipes()
{
    DataClassesDataContext db = new DataClassesDataContext();

    return db.p_get_all_recipes().Select(r => new Recipe()
        {
        recipeName = r.name;
        recipeDescription = r.description;
        recipeSteps = r.steps;
        createdAt = r.createdAt;
        updatedAt = r.updatedAt;
        ownerID = r.owner_id;
        });

} 
```

然后你需要改变你的观点：

```
@model IQueryable<Recipe> 
```

和你的控制器动作：

```
[HttpGet]
        public ActionResult Index()
        {
            RecipeModel rec = new RecipeModel();    
            return View( rec.GetAllRecipes(););
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:01:43.120

您有一个`RecipeModel`类，其中有一个获取所有项目的方法（RecipeModel 的集合）。仔细看看你的方法。您正在循环遍历集合并一次又一次地设置类的属性（有效地类的对象）（覆盖到同一实例）

理想情况下，在循环中，您需要创建RecipeModel 的实例并设置值并将其添加到RecipeModel 的集合中。

我不会在你的 Model 类中混合这种方法。我会将它移到一个单独的类中，其中将有一个返回`RecipeModel`类列表的方法。一种存储方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T13:59:03.337

你的模型有问题。您从 SP 加载所有配方，然后在循环中尝试将结果中的值设置为 RecipeModel 字段。但是在您的周期中，如果您有多个配方，那么您接下来要做的是：在迭代 1 中，您从配方 1 中获取值并将它们设置为 RecipeModel，之后您将进入迭代 2，并将配方 2 中的所有值再次设置为相同对象 RecipeModel 已经具有配方 1 中的值，因此您只需覆盖这些值。

因此，您需要从数据库中为每个配方创建一个单独的 RecipeModel。您传递给视图的模型应该是一个食谱模型列表，并且在您的视图中，您应该有 foreach 循环，它将将食谱写入 html。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T13:59:22.280

您在以下 for 循环中覆盖您的局部变量：

```
foreach (var r in result)
{
    this.recipeName = r.name;
    this.recipeDescription = r.description;
    this.recipeSteps = r.steps;
    this.createdAt = r.createdAt;
    this.updatedAt = r.updatedAt;
    this.ownerID = r.owner_id;
} 
```

您需要将每次迭代添加到模型的新实例并返回一个`List`或其他集合类型。

# servicestack - ServiceStack OrmLite 在事务中使用 UserAuthRepository.CreateUserAuth 会不会出错

> ID：11970522
> 
> 赞同：2
> 
> 时间：2012-08-15T13:51:30.173
> 
> 标签：servicestack, ormlite-servicestack

我有一个复杂的工作流程，我想在一个事务中在多个表中创建行。其中一项操作是创建一个新的 UserAuth（来自 ServiceStack 身份验证功能）。

我假设事务中的所有数据库操作都应该在同一个连接上运行，如果这是真的，那么我认为在事务中调用 UserAuthRepository.CreateUserAuth 可能是个问题，因为它看起来好像使用自己的连接。

所以我的问题是，当我有如下所示的代码时，创建 UserAuth 是否会成为交易的一部分。如果没有，那么如何在交易中创建新用户？

```
 using (var db = Db.OpenDbConnection()) {
    using (var trans = db.OpenTransaction()) {

      ... do some databae operations via. db ...

      var userAuth = UserAuthRepository.CreateUserAuth(
        new UserAuth{UserName = "blabla"}, 
        "password"
      );

      ... do some more databae operations via. db ...

      trans.Commit(); 
    }
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:29:17.100

在内部，只要 ServiceStack 需要访问数据库，例如在[OrmLiteUserAuthRepository.CreateUserAuth](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Auth/OrmLiteAuthRepository.cs#L60)中，它就会请求并使用新连接，并在完成后立即处理它。

目前无法将其与自定义事务分开。

# wordpress - WordPress 艺术家

> ID：11970525
> 
> 赞同：0
> 
> 时间：2012-08-15T13:51:48.033
> 
> 标签：wordpress, plugins, profiles

我怎样才能在`wordpress`（在这里用谷歌搜索和搜索）进行以下操作：

歌手页面（10-20 位歌手），每个人都有：

*   传。
*   唱片。
*   提到他的帖子（可能是标签）。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:06:50.603

**这是您在 wordpress 后端需要做的所有事情**

*   自定义 UI 插件 [http://wordpress.org/extend/plugins/custom-post-type-ui/](http://wordpress.org/extend/plugins/custom-post-type-ui/)

*   自定义字段：（高级自定义字段插件） [http://www.advancedcustomfields.com/](http://www.advancedcustomfields.com/)

**如果你想编写你的functions.php，这就是你所需要的一切**

*   首先忘记自定义 ui 插件
*   自定义帖子类型：（register_post_type） [http://codex.wordpress.org/Function_Reference/register_post_type](http://codex.wordpress.org/Function_Reference/register_post_type)

*   自定义分类法：（register_taxonomy） [http://codex.wordpress.org/Function_Reference/register_taxonomy](http://codex.wordpress.org/Function_Reference/register_taxonomy)

*   自定义字段：（高级自定义字段插件） [http://www.advancedcustomfields.com/](http://www.advancedcustomfields.com/)

**脚步**

1 - 在您的 function.php 中注册您的帖子类型和分类（标签）

2 - 使用 acf 插件创建自定义字段

3 - 创建您的分类法（标签）

4 - 创建示例帖子

6 - 创建将获取签名者的页面模板 (WP_Query()) [http://codex.wordpress.org/Class_Reference/WP_Query](http://codex.wordpress.org/Class_Reference/WP_Query)

7 - 将模板与您网站的页面相关联。

# http - (HP QuickTest) 如何使用 QuickTest 获取 HTTP 状态？

> ID：11970531
> 
> 赞同：3
> 
> 时间：2012-08-15T13:52:08.940
> 
> 标签：http, vbscript, request, qtp

我正在创建一个 QuickTest 脚本，它获取页面的所有 URL，并检查代码为 200 的 http 请求的状态是否为 200。但我的问题是如何从 URL 获取 http 请求状态代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:56:27.863

这是我的解决方案：

```
Set Http = CreateObject("Microsoft.XMLHttp")
Set oDesc = Description.Create()
    oDesc("micclass").Value = "Link"
Set EditCollection = Browser("Browser").Page("Page").ChildObjects(oDesc)

URL_TEMP = EditCollection(i).GetROProperty("href")
Http.Open "GET" , URL_TEMP , false
Http.Send
msgbox Http.Status 
```

# vb6 - 在非VB环境下执行VB6 exe

> ID：11970535
> 
> 赞同：1
> 
> 时间：2012-08-15T13:52:16.250
> 
> 标签：vb6, exe

我使用`ADODC`组件和常用对话框创建了一个 Vb 应用程序/exe。但我无法在另一台未安装 VB6 的 PC 上运行该应用程序。

我是否必须在那台 PC 上安装一些额外的组件？（不想在那里安装VB6）。

如何`ODBC`使用我们从控制面板 -> 管理工具 -> 数据源 -> 添加新 -> mdb 手动执行的代码配置连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:03:12.827

您应该使用 VB6 打包和部署向导生成一个安装程序，该安装程序将嵌入您的应用程序运行所需的所有要求和依赖项。

该向导是 VB6 开发环境的一部分。检查 VB 开始菜单文件夹以找到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:07:24.667

按照本网站上的说明手动安装 comdlg32

[http://devonenote.com/2010/02/register-comdlg32-ocx-on-x64-win7/](http://devonenote.com/2010/02/register-comdlg32-ocx-on-x64-win7/)

comdlg32 不包含在 Vista 及更高版本中。

**注意**如果是 64 位操作系统，请注意放置文件的不同位置。它可能需要您以管理员身份运行 regsvr32.exe。只需按照上面链接上的说明进行操作。应该管用。

# bookmarks - 有没有办法在不使用 JS 的情况下获取书签信息？

> ID：11970537
> 
> 赞同：0
> 
> 时间：2012-08-15T13:52:19.723
> 
> 标签：bookmarks

我一直在对此进行一些研究，但我仍然不确定它是否可能。

有什么方法可以检索用户的书签并将其显示在页面上而不侵犯他们的隐私？我看到这两个线程在谈论使用 JS 来做到这一点：

[如何在 JavaScript 代码中获取书签工具栏信息？](https://stackoverflow.com/questions/3531025/how-to-get-bookmarks-toolbar-information-in-javascript-code)

[使用 javascript 显示所有书签](https://stackoverflow.com/questions/6390555/show-all-bookmarks-using-javascript)

**我没有考虑自动执行此操作，用户必须选择使用“从我的浏览器显示书签”或类似内容的按钮。**

是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T13:58:52.153

不是没有浏览器扩展。您可以为主要浏览器编写一个浏览器扩展，以检索信息并将其反馈到您的页面。

# perl - “perl test.pl”和“./test.pl”有什么区别？

> ID：11970541
> 
> 赞同：5
> 
> 时间：2012-08-15T13:52:41.130
> 
> 标签：perl

我观察到有两种执行 perl 程序的方法：

```
perl test.pl 
```

和

```
./test.pl 
```

这两者之间的确切区别是什么，哪一个是值得推荐的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-15T14:10:16.740

我会稍微改一下其他答案所说的内容。

*   第一种情况将运行名为“perl”的程序——大概是一个 Perl 语言解释器，并将值“test.pl”作为第一个参数传递给它。请注意，这将执行以下三件事之一，具体取决于“perl”是什么以及“test.pl”是什么：

    1.  `$PATH`如果“perl”在您的或 shell 别名中不作为可执行文件存在（通过运行检查`which perl`），您的 shell 将尝试查找不存在的可执行文件，并因`perl: Command not found`错误而失败。

    2.  如果“perl”是您路径中的可执行文件（或 shell 别名），但实际上不是 Perl 解释器程序，则它将被执行。例如，在 csh 中试试这个：

        ```
        alias perl echo
        which perl  # Will print "perl:    aliased to echo"
        perl test.pl # Will print "test.pl". NOT what you intended!
        unalias perl 
        ```

        这将执行您的“perl”别名并简单地回显单词“test.pl”

    3.  如果“perl”是路径中的可执行文件，它是真正的 perl 解释器，它会将“test.pl”作为第一个参数传递给它。在这种情况下，Perl 解释器会将此参数（因为它不以“-”开头）视为包含要执行的 Perl 代码的文件的名称，并尝试读取该文件，将其编译为 Perl 代码并执行它.

        请注意，由于正在运行的程序实际上是“perl”，而“test.pl”只是一个正在读入的文本文件，“test.pl”不需要具有“执行”Unix文件权限。

*   *第二种情况，shell 将尝试在您的当前目录*中找到一个名为“test.pl”的文件，并且 - 如果它存在并且是可执行的 - 尝试将其作为程序执行。

    *   如果文件不存在或者如果它的执行位没有设置，shell 将失败并出现“command not found”错误。

    *   如果文件设置了执行位，shell（或者实际上是 Unix 内核中的进程加载器）将尝试执行它。Unix 执行给定可执行文件的规则由文件的前 2 个字节控制，也就是“幻数”。

        有关幻数如何工作的非常好的深入报道，请参阅[`How does the #! work?`](https://stackoverflow.com/questions/3009192/how-does-the-work)SO 上的“”问题。

    *   在“幻数”为“#!”的特殊情况下 （又名“shebang”），加载程序将读取**文件的第一行**，并将该行的内容（无前 2 个字节）视为要运行的命令，而不是给定的可执行文件；并将可执行文件的路径作为另一个参数附加到它从 shebang 行读取的命令中。例如：

        *   如果“test.pl”是一个第一行为 的文本文件`#!/bin/sh -x`，内核将执行`/bin/sh -x ./test.pl`.

        *   **如果“test.pl”是一个第一行为 的文本文件`#!/usr/bin/perl`，内核将执行`/usr/bin/perl ./test.pl`**.

        *   **如果“test.pl”是一个第一行为 的文本文件`#!perl`，内核将执行`perl ./test.pl`**.

        *   如果“test.pl”是一个文本文件，其第一行是`my $var = 1;`（或任何其他它不知道如何处理的前 2 个字节），它要么会出错，要么（至少在 RedHat Linux 上）会假装在那里是一个隐含的`#!/bin/sh`shebang，并尝试将文件作为 Bourne Shell 脚本执行。这当然会失败，因为它是 Perl 代码，而不是 shell 脚本

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-15T13:55:17.523

在第一种情况下，您正在启动`perl`解释器并要求它使用您的文件并运行它。

在第二种情况下，您要求您的 shell 执行您的文件。这要求文件以

```
#!/<path to perl>/perl 
```

并且该文件设置了执行位。

最好的使用方法是最适合您的用例的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T13:55:33.870

*   第一个将始终将脚本作为`perl`代码运行。
    只有在 she-bang 中指定了 perl 的情况下，第二个才会这样做。否则，它将作为 shell 代码或 she-bang 中指定的任何内容运行（如果根本没有 she-bang，它将作为当前 shell 代码运行）。

*   `noexec`即使启用了挂载选项，也会执行第一个。
    在这种情况下，第二个将失败。

*   与执行位相同的东西。`+x`如果未设置，第一个将起作用，第二个将失败。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-15T13:54:37.317

第一个使用`perl`在您的`$PATH`. 第二个使用程序中所说的任何[shebang](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-17T10:16:56.783

如果你设置了文件的可执行权限，那么你可以通过./运行文件，或者使用perl filename.pl运行

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-07T21:05:23.013

**perl 测试.pl**

*   向 shell 指定您希望当前 Perl 可执行文件（在 $PATH 中找到）执行位于 $PATH 中的 test.pl 文件。
*   运行**which perl**可以快速查看默认的 perl 版本
*   运行**echo $PATH**以查看 '.' 的位置。（当前目录）是。'.' 之前的所有目录 将首先检查 test.pl 文件！请改用 ./test.pl，这样 shell 只会在当前目录中查找...除非您希望它在 $PATH 中搜索 test.pl 文件。

**./test.pl**

*   向 shell 指定您希望当前目录中的 test.pl 文件由 test.pl 文件中带有 she-bang 的行（以**#!**开头的行）中指定的可执行文件运行。

# html - netty 的 html 样式的用户指南文档是如何生成的？

> ID：11970548
> 
> 赞同：0
> 
> 时间：2012-08-15T13:52:57.873
> 
> 标签：html, markdown, netty, doc, generated

我正在阅读[Netty Project 3.x 用户指南](http://static.netty.io/3.5/guide/)，想知道文档是如何生成的、降价的还是其他的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T16:28:36.610

它曾经使用由[Trustin ApiViz开发的工具](http://code.google.com/p/apiviz/)

# python - 如何按字典中的值对字典列表进行排序？

> ID：11970553
> 
> 赞同：10
> 
> 时间：2012-08-15T13:53:15.167
> 
> 标签：python, list, sorting, dictionary

> **可能重复：**
> [在 Python 中，如何按字典的值对字典列表进行排序？](https://stackoverflow.com/questions/72899/in-python-how-do-i-sort-a-list-of-dictionaries-by-values-of-the-dictionary)

我正在编写一个 Python 3.2 应用程序，并且我有一个包含以下内容的字典列表：

```
teamlist = [{ "name":"Bears", "wins":10, "losses":3, "rating":75.00 },
            { "name":"Chargers", "wins":4, "losses":8, "rating":46.55 },
            { "name":"Dolphins", "wins":3, "losses":9, "rating":41.75 },
            { "name":"Patriots", "wins":9, "losses":3, "rating": 71.48 }] 
```

我希望列表按评级键中的值排序。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-15T13:55:28.880

用作[`operator.itemgetter`](http://docs.python.org/dev/library/operator#operator.itemgetter)键：

```
sorted(teamlist, key=operator.itemgetter('rating')) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-15T13:55:35.213

您可以将该`sorted`函数与引用您希望的任何字段的排序键一起使用。

```
teamlist_sorted = sorted(teamlist, key=lambda x: x['rating']) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:00:28.500

```
from operator import itemgetter
newlist = sorted(team_list, key=itemgetter('rating')) 
```

# python - 修改数据作为 Alembic 升级的一部分

> ID：11970555
> 
> 赞同：23
> 
> 时间：2012-08-15T13:53:18.930
> 
> 标签：python, sqlalchemy, alembic

作为 alembic 升级的一部分，我想修改一些数据库数据。

我以为我可以在迁移升级中添加任何代码，但以下失败：

```
def upgrade():
    ### commands auto generated by Alembic - please adjust! ###
    op.add_column('smsdelivery', sa.Column('sms_message_part_id', sa.Integer(), sa.ForeignKey('smsmessagepart.id'), nullable=True))
    ### end Alembic commands ###

    from volunteer.models import DBSession, SmsDelivery, SmsMessagePart

    for sms_delivery in DBSession.query(SmsDelivery).all():
        message_part = DBSession.query(SmsMessagePart).filter(SmsMessagePart.message_id == sms_delivery.message_id).first()
        if message_part is not None:
            sms_delivery.sms_message_part = message_part 
```

出现以下错误：

```
sqlalchemy.exc.UnboundExecutionError: Could not locate a bind configured on mapper Mapper|SmsDelivery|smsdelivery, SQL expression or this Session 
```

我不是很理解这个错误。我该如何解决这个问题，或者做这样的操作是不可能的？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-16T21:19:00.773

从您提供的代码摘录中很难理解您到底想要实现什么。但我会尝试猜测。所以下面的答案将基于我的猜测。

第 4 行 - 您从模块中导入内容（DBSession、SmsDelivery、SmsMessagePart），然后您尝试像在应用程序中一样操作这些对象。

该错误表明 SmsDelivery 是一个映射器对象 - 所以它指向某个表。映射器对象应绑定到有效的 sqlalchemy 连接。

这告诉我您跳过了 DB 对象的初始化（连接并将此连接绑定到映射器对象），就像您通常在应用程序代码中所做的那样。

DBSession 看起来像 SQLAlchemy 会话对象——它也应该有连接绑定。

Alembic 已经准备好并打开连接 - 用于更改您使用 op.* 方法请求的数据库模式。

所以应该有办法获得这种联系。

根据 Alembic 手册 op.get_bind() 将返回当前连接绑定：
要与连接的数据库进行完全交互，请使用上下文中可用的“绑定”：

```
from alembic import op
connection = op.get_bind() 
```

因此，您可以使用此连接将查询运行到 db。

PS。我假设您想对表中的数据进行一些修改。您可以尝试将此修改表述为一个更新查询。Alembic 具有执行此类更改的特殊方法 - 因此您无需处理连接。
[alembic.operations.Operations.execute](http://alembic.zzzcomputing.com/en/latest/ops.html?highlight=execute#alembic.operations.Operations.execute)

```
execute(sql, execution_options=None) 
```

使用当前迁移上下文执行给定的 SQL。

在 SQL 脚本上下文中，语句直接发送到输出流。但是，没有返回结果，因为此函数旨在生成可以在“离线”模式下运行的更改脚本。

参数： sql – 任何合法的 SQLAlchemy 表达式，包括：

*   一个字符串 sqlalchemy.sql.expression.text() 构造。
*   一个 sqlalchemy.sql.expression.insert() 构造。
*   一个 sqlalchemy.sql.expression.update()，
*   sqlalchemy.sql.expression.insert()，或
*   sqlalchemy.sql.expression.delete() 构造。SQL 表达式语言教程中描述的几乎所有“可执行”的东西。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-09-18T03:16:37.010

值得注意的是，如果您这样做，您可能希望在迁移中冻结您的 orm 模型的副本*，*如下所示：

```
class MyType(Base):
  __tablename__ = 'existing_table'
  __table_args__ = {'extend_existing': True}
  id = Column(Integer, ...)
  ..

def upgrade():
  Base.metadata.bind = op.get_bind()

  for item in Session.query(MyType).all():
    ... 
```

否则，您将不可避免地陷入您对模型进行更改并且以前的迁移*不再起作用*的情况。

特别注意，您要扩展 Base，而不是基本类型本身 (app.models.MyType)，因为您的类型可能会在某个时候消失，并且您的迁移将再次失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-19T11:23:23.873

您还需要导入 Base 然后

```
Base.metatada.bind = op.get_bind() 
```

在此之后，您可以像往常一样使用您的模型而不会出错。

# c++ - 如何为指针成员创建对象

> ID：11970558
> 
> 赞同：-1
> 
> 时间：2012-08-15T13:53:29.840
> 
> 标签：c++, pointers, scope

```
class A{
private:
    Fifi * fifi;
public setFifi(Fifi * aFifi){
    fifi = aFifi;
}
};

int main(){
    Fifi f;
    A a;
    a.setFifi(f);
} 
```

虽然在上面的代码中没有实现，但`class A`实际上是一个单例。我想知道的是，如果我仍然能够访问`fifi`主范围完成的成员。（假设 A 是单例）

或者`f`对象会丢失，我应该使用`new`关键字创建它以便仍然能够访问它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T13:56:06.073

首先`Fifi f();`是函数声明

我假设你的意思是：

```
Fifi f; 
```

在这种情况下`f`将在`main`完成时销毁

我建议您使用`std::shared_ptr`或在堆上`boost::shared_ptr`构建`Fifi`并将其存储在`A`(as `shared_ptr`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:56:16.650

```
Fifi f();
A a(); 
```

这些陈述没有做我认为你期望他们做的事情。简而言之，他们不会定义变量。

`class A`对我来说看起来不像单身人士。在它的当前状态下，它的状态在主要完成后将不会被保留（尽管我不确定你希望在`main`完成后如何访问它）。

# objective-c - 调用子类方法 - Cocos2d

> ID：11970565
> 
> 赞同：0
> 
> 时间：2012-08-15T13:54:18.457
> 
> 标签：objective-c, ios, oop, class, cocos2d-iphone

我正在阅读“Learning Cocos2d”一书，但我坚持一些基本的东西。

所以，有一个父类：GameplayLayer。其中，有一个“init”方法在这里创建主角的一个实例——“Viking”。Viking 是“GameCharacter”的子类，它是“GameObject”的子类。

```
 #pragma mark INIT PLAYER
        Viking *viking = [[Viking alloc] 
        initWithSpriteFrame:[[CCSpriteFrameCache sharedSpriteFrameCache]
        spriteFrameByName:@"viking.png"]];

        [viking setJoystick:leftJoystick];
        [viking setFireButton:fireButton];
        [viking setSecondaryButton:secondaryButton];
        [viking setCollisionLayer:collidableLayer]; // send collision layer to player
        [viking setPosition:ccp(screenSize.width * 0.35f, screenSize.height * 0.14f)];
        [viking setHealth:100];

        [sceneSpriteBatchNode addChild:viking z:1000 tag:kPlayerSpriteTagValue]; 
```

现在，Viking 有一个更新方法，每帧都会被 GameplayLayer 调用。它是父类，GameObject 也有这个 update 方法，如果不小心调用它会弹出一个错误消息——“GameObject update should be overridden”。

所以在我的代码中，我使用以下方法调用“Viking”的更新方法：

```
 #pragma mark UPDATE_METHOD
-(void) update:(ccTime)deltaTime
{
    CCArray *listOfGameObjects = 
    [sceneSpriteBatchNode children];
    for (GameObject *tempChar in listOfGameObjects) {
        CCLOG(@"engine found %@",tempChar);
        [tempChar updateStateWithDeltaTime:deltaTime
 andListOfGameObjects:listOfGameObjects];
    }

} 
```

因此，这应该调用 Viking 中的“updateStateWithDeltaTime”方法。但不知何故，它调用了 GameObject 中的父方法，上面写着“应该覆盖更新状态”。如何覆盖父方法？

非常感谢，

卡尔

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-15T14:20:20.250

您需要转换`tempChar`为`Viking`.

```
 for (GameObject *tempChar in listOfGameObjects) 
    {
        [(Viking *) tempChar updateStateWithDeltaTime:deltaTime
 andListOfGameObjects:listOfGameObjects];
    } 
```

因为您正在执行一个快速枚举 的 for 循环`GameObjects`，所以局部变量假定所有对象都是`GameObjects`. 您需要显式`tempChar`转换为 a`Viking`以便程序知道要在哪个类中查找该方法。

作为一个有趣的附注，如果`GameObject`没有与之前相同的方法`Viking`，您将在 XCode 中收到警告，告诉您它找不到您要求的方法（因为它需要知道每个对象这可能被称为有它）。

您可能想要检查您正在调用它的对象是否是正确的类（如果您只想在`Viking`对象上调用它）。您将`if ([GameObject isKindOfClass[Viking class])`在更新方法调用之上添加。

# javascript - 在 jQuery 手风琴式菜单中切换儿童的可见性

> ID：11970566
> 
> 赞同：0
> 
> 时间：2012-08-15T13:54:20.720
> 
> 标签：javascript, jquery, menu, accordion

我有一个简单的手风琴式菜单，它在 jQuery 的帮助下打开/关闭其子项：[jsFiddle](http://jsfiddle.net/errata/RtG2A/)。

如果我单击菜单项，一切正常 - 显示所选项目的子项，而所有其他不必要的子项隐藏。但是，我希望能够根据传递的一些变量（`id`）打开菜单树。

因此，在这个 jsFiddle 中，我创建了手动链接（在右侧），它应该在菜单中显示相应的项目（展开所有父项）并隐藏所有其他项。当我点击手动链接时，我设法只切换了一级子级，但是当我点击让我们说 4 级链接（在我的示例中为 11 类）时，什么也没有发生。我想做的是展开所选项目的所有父母并折叠所有其他不在所选孩子的树路径中的项目。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:14:07.563

我认为这个[jsFiddle 可以满足](http://jsfiddle.net/WAurj/5/)您的需求。

我没有测试过比你原来的小提琴更多的关卡，但我认为所有的父级、兄弟级和“表亲”元素都被考虑并根据用户点击的内容进行适当的切换。

# c# - 复制不同类型对象的最简单方法

> ID：11970567
> 
> 赞同：2
> 
> 时间：2012-08-15T13:54:34.933
> 
> 标签：c#, asp.net-mvc

所以可以说我有一个对象

```
class MyItem
{
     public string Name {get; set;}
     public string Description {get; set;}
} 
```

我想创建一个 ViewModel

```
class MyItemViewModel
{
     public string Name {get; set;}
     public string Description {get; set;}
     public string Username {get; set;}
} 
```

我想在控制器上获取 MyItem 类型的对象并自动填充 ViewModel。使用 MyItem 中包含的值（即，如果它有一个名为 Name 的属性，则自动填写它）。

我要避免的是`Model.Name = Item.Name`行列表。MyItemViewModel 也将具有不同的属性和显示值，因此我不能简单地将 MyItem 嵌入视图模型中。

是否有一种干净的编程方式可以在对象之间复制相同名称和类型的属性，或者我是否被手工操作卡住了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T13:57:13.690

您可以使用[AutoMapper](http://automapper.org/)来完成此任务。我在所有项目中都使用它来映射我的域模型和视图模型。

您只需在您的 : 中定义一个映射`Application_Start`：

```
Mapper.CreateMap<MyItem, MyItemViewModel>(); 
```

然后执行映射：

```
public ActionResult Index()
{
    MyItem item = ... fetch your domain model from a repository
    MyItemViewModel vm = Mapper.Map<MyItem, MyItemViewModel>(item);
    return View(vm);
} 
```

您可以编写一个自定义操作过滤器，它会覆盖 OnActionExecuted 方法并用相应的视图模型替换传递给视图的模型：

```
[AutoMap(typeof(MyItem), typeof(MyItemViewModel))]
public ActionResult Index()
{
    MyItem item = ... fetch your domain model from a repository
    return View(item);
} 
```

这使您的控制器操作非常简单。

AutoMapper 有另一种非常有用的方法，当您想要更新某些内容时，可以在您的 POST 操作中使用它：

```
[HttpPost]
public ActionResult Edit(MyItemViewModel vm)
{
    // Get the domain model that we want to update
    MyItem item = Repository.GetItem(vm.Id);

    // Merge the properties of the domain model from the view model =>
    // update only those that were present in the view model
    Mapper.Map<MyItemViewModel, MyItem>(vm, item);

    // At this stage the item instance contains update properties
    // for those that were present in the view model and all other
    // stay untouched. Now we could persist the changes
    Repository.Update(item);

    return RedirectToAction("Success");
} 
```

例如，假设您有一个包含 Username、Password 和 IsAdmin 等属性的 User 域模型，并且您有一个允许用户更改其用户名和密码但绝对不更改 IsAdmin 属性的表单。因此，您将拥有一个包含 Username 和 Password 属性的视图模型，该属性绑定到视图中的 html 表单，并且使用此技术您将只更新这 2 个属性，而不会更改 IsAdmin 属性。

AutoMapper 也适用于集合。一旦定义了简单类型之间的映射：

```
Mapper.CreateMap<MyItem, MyItemViewModel>(); 
```

在集合之间进行映射时，您不需要做任何特别的事情：

```
IEnumerable<MyItem> items = ...
IEnumerable<MyItemViewModel> vms = Mapper.Map<IEnumerable<MyItem>, IEnumerable<MyItemViewModel>>(items); 
```

所以不要再等了，在你的 NuGet 控制台中输入以下命令并享受表演：

```
Install-Package AutoMapper 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T13:59:34.147

你可能需要反思才能做到这一点

这是它的例子

完整：[通过反射的简单属性映射器：停止手动复制对象的每个属性！](http://www.codeproject.com/Articles/71598/Simple-properties-Mapper-by-reflection-Stop-copyin)

```
 /// <summary>
    /// Copies all the properties of the "from" object to this object if they exist.
    /// </summary>
    /// <param name="to">The object in which the properties are copied</param>
    /// <param name="from">The object which is used as a source</param>
    /// <param name="excludedProperties">Exclude these properties from the copy</param>
    public static void copyPropertiesFrom
    (this object to, object from, string[] excludedProperties)
    {
      Type targetType = to.GetType();
      Type sourceType = from.GetType();

      PropertyInfo[] sourceProps = sourceType.GetProperties();
      foreach (var propInfo in sourceProps)
      {
        //filter the properties
        if (excludedProperties != null
          && excludedProperties.Contains(propInfo.Name))
          continue;

        //Get the matching property from the target
        PropertyInfo toProp =
          (targetType == sourceType) ? propInfo : targetType.GetProperty(propInfo.Name);

        //If it exists and it's writeable
        if (toProp != null && toProp.CanWrite)
        {
          //Copy the value from the source to the target
          Object value = propInfo.GetValue(from, null);
          toProp.SetValue(to,value , null);
        }
      }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T13:59:48.523

如果您想从头开始做事，一些反射代码可以在这里为您提供帮助。性能不是很好，但肯定很容易设置和维护。检查此[SO 答案](https://stackoverflow.com/questions/1196991/get-property-value-from-string-using-reflection-in-c-sharp)中提供的方法。

您可以使用“Type.GetProperties”获取目标对象的属性列表。

[MSDN 文章在这里](http://msdn.microsoft.com/en-us/library/kyaxdd3x.aspx)

获取公共属性的示例：

```
PropertyInfo[] myPropertyInfo = myType.GetProperties(BindingFlags.Public|BindingFlags.Instance); 
```

# java - Java - 无法将窗口置于前面

> ID：11970570
> 
> 赞同：2
> 
> 时间：2012-08-15T13:54:38.257
> 
> 标签：java, swing

我正在尝试执行以下代码：

```
SwingUtilities.invokeLater(new Runnable() {
                            public void run() {
                                if (frame.getExtendedState() == Frame.ICONIFIED)
                                    frame.setExtendedState(Frame.NORMAL);
                                frame.getGlassPane().setVisible(!frame.getGlassPane().isVisible());

                                frame.toFront();
                                frame.repaint();

                            }
                        }); 
```

不幸的是，这并没有把它从其他窗户后面带到前面......有什么解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T14:18:55.923

根据 API 文档`setExtendedState`：

> 如果框架当前在屏幕上可见（Window.isShowing() 方法返回 true），**则开发人员应检查通过 WindowStateListener 接收到的 WindowEvent 的 WindowEvent.getNewState() 方法的返回值，以确定该状态实际上已经被改变了**。
> 
> 如果框架在屏幕上不可见，则可能会或可能不会生成事件。在这种情况下，开发人员可能会假设状态在此方法返回后立即更改。稍后，当调用 setVisible(true) 方法时，框架将尝试应用此状态。在这种情况下也不能保证接收任何 WindowEvent.WINDOW_STATE_CHANGED 事件。

但是，还有一个`windowDeiconified`回调可以挂接到 on `WindowListener`：

```
SwingUtilities.invokeLater(new Runnable() {
  private final WindowListener l = new WindowAdapter() {
    @Override
    public void void windowDeiconified(WindowEvent e) {
      // Window now deiconified so bring it to the front.
      bringToFront();

      // Remove "one-shot" WindowListener to prevent memory leak.
      frame.removeWindowListener(this);
    }
  };

  public void run() {
    if (frame.getExtendedState() == Frame.ICONIFIED) {
      // Add listener and await callback once window has been deiconified.
      frame.addWindowListener(l);
      frame.setExtendedState(Frame.NORMAL);
    } else {
      // Bring to front synchronously.
      bringToFront();
    }
  }

  private void bringToFront() {
    frame.getGlassPane().setVisible(!frame.getGlassPane().isVisible());
    frame.toFront();
    // Note: Calling repaint explicitly should not be necessary.
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-02T10:49:26.120

我发现 JDialog 上 toFront() 的以下解决方法适用于 Windows 7（尚未测试其他平台）：

```
boolean aot = dialog.isAlwaysOnTop();
dialog.setAlwaysOnTop(true);
dialog.setAlwaysOnTop(aot); 
```

保罗·范·贝梅伦

# java - 如何在每个对话中存储一个 bean

> ID：11970571
> 
> 赞同：0
> 
> 时间：2012-08-15T13:54:46.663
> 
> 标签：java, jsf, seam, jboss7.x, conversation-scope

有没有办法在对话上下文中存储一些 bean？即，对于每个新对话，都会创建一个属于它的新的单独 bean。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T14:05:53.603

做你想做的最简单的方法是声明一个 ConversationScoped 托管 bean 或 JSF2 管理范围的 EJB。

这里有一些很好的解释：

*   [http://docs.oracle.com/javaee/6/tutorial/doc/gjbbk.html](http://docs.oracle.com/javaee/6/tutorial/doc/gjbbk.html)
*   [http://www.ibm.com/developerworks/java/library/j-jsf2fu-0710/index.html#cdi](http://www.ibm.com/developerworks/java/library/j-jsf2fu-0710/index.html#cdi)
*   [http://www.theserverside.com/tip/Dependency-Injection-in-Java-EE-6-Conversations-Part-4](http://www.theserverside.com/tip/Dependency-Injection-in-Java-EE-6-Conversations-Part-4)
*   [http://www.andygibson.net/blog/article/cdi-conversations-part-1/](http://www.andygibson.net/blog/article/cdi-conversations-part-1/)
*   [http://www.andygibson.net/blog/tutorial/pattern-for-conversational-crud-in-java-ee-6/](http://www.andygibson.net/blog/tutorial/pattern-for-conversational-crud-in-java-ee-6/)
*   [http://blog.goyello.com/2011/06/08/jee6-cdi-and-conversation-scope/](http://blog.goyello.com/2011/06/08/jee6-cdi-and-conversation-scope/)

......其中任何一个都会比我做得更好。非常简短的版本是您使用注释对 bean 进行注释 - 它可以是遵循 bean 约定的普通 POJO `@ConversationScoped`。然后你`@Inject`是一个`Conversation`对象，你可以使用它`begin()`和`end()`对话。将这个`@ConversationScoped`bean 注入到其他东西中。`Conversation.begin`and`Conversation.end`方法控制它的生命周期。

这里有很多代码要发布，但上面的链接应该会有所帮助。

POJO 托管 bean的替代方案`@ConversationScoped`可以是`@Stateful @ConversationScoped`EJB。当您在对话中需要 EJB 服务时，它们会非常方便。

有关一些概念背景和详细信息，请阅读[关于范围的 CDI/Weld 参考](http://docs.jboss.org/weld/reference/latest/en-US/html/scopescontexts.html)- 以及 CDI/Weld 手册的其余部分。它写得非常好，非常好*。*

# coded-ui-tests - Javascript 菜单无法加载 - 但仅在编码 UI 测试与其交互时

> ID：11970572
> 
> 赞同：1
> 
> 时间：2012-08-15T13:54:48.317
> 
> 标签：coded-ui-tests

作为一组编码 UI 测试的一部分，单击菜单。但是，菜单（使用 Javascript）无法加载菜单选项。当我手动运行测试时，菜单工作正常。如果我在测试运行时刷新页面（或重新启动浏览器），则会加载菜单选项。

但更奇怪的是这只发生在远程测试环境中。当我在自己的机器上本地运行测试时，即使 Coded UI 测试正在执行测试，菜单也会起作用。

为什么菜单无法加载对我来说完全没有意义。编码的 UI 测试是否会阻止 Javascript 执行（以加载菜单选项）？但是为什么刷新页面时它会起作用？

比较我自己的环境和测试环境 - 我看不出有什么不同。我正在测试完全相同的 Web 应用程序（URL 指向同一个 Web 服务器）。这是相同版本的 Internet Explorer，所有设置都相同，我可以看到。同样的操作系统（Windows 7）。

有任何想法吗？

需要注意的一点是，测试在 IE7 文档模式下运行良好 - 尽管此处的 Javascript 行为可能会有所不同。目前，我在 IE9 文档模式下针对 Web 应用程序运行测试。将文档模式更改为 Quirks 模式也允许测试在某些情况下工作，但仅限于少数测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-22T17:37:06.157

I've figured out the reason for this is that I have been recording tests in IE9 Compatibility Mode and under IE9 Document Mode. IE9 Document mode is not supported for action recordings with VS2010\.

However, even if I switch the document mode to IE8 Document Mode during test playback on the remote environment, browser dialogs fail.

Therefore, there is no real solution to this problem.

Furthermore, I would thus contest Microsoft's claim that coded UI tests are compatible with IE9 (even with VS2010 SP1) for this reason.

So I'm left with no choice but to wait until VS2012 Coded UI test tools (which offer full support for IE9, supposedly) before I can test any web pages which have browser dialogs or JavaScript menus.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:25:42.987

我遇到了类似的问题——当测试代理运行的编码 UI 测试试图操纵它时，我页面上的一些高级 javascript 就会失败（VS2010，IE9 标准）。

当切换到兼容模式（IE9 兼容/IE7 文档模式）时，我们刚刚解决了一个不同的问题 - 控件的内部文本发生了显着变化，这破坏了我们的搜索/过滤器属性。

更新了这些属性，测试现在可以在 VM 上的兼容模式或我机器上的 IE9 标准下正常工作。

# java - Android MediaPlayer 未准备好。错误 (1, -4)

> ID：11970574
> 
> 赞同：0
> 
> 时间：2012-08-15T13:54:58.403
> 
> 标签：java, android, media-player, prepare

所以我一直在尝试为android制作一个简单的音效应用程序。以下是相关代码：

```
public static final String LOG_TAG = "BCA";

public MediaPlayer mp;

@Override
public void onCreate(Bundle savedInstanceState) 
{
        Log.v(LOG_TAG, "creating");
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main_list);

    mp = new MediaPlayer();
    mp.setAudioStreamType(AudioManager.STREAM_MUSIC);
        Log.v(LOG_TAG, "set stream type");
    playSound();
}

public void playSound()
{
    try {
        mp.setDataSource("R.raw.sound1");
            Log.v(LOG_TAG, "set data source");
        mp.setOnPreparedListener(this);
        mp.setOnErrorListener(this);
        mp.prepareAsync();
            Log.v(LOG_TAG, "preparing");
    } 
    catch (IllegalArgumentException e) {
        e.printStackTrace();
    } 
    catch (IllegalStateException e) {
        e.printStackTrace();
    } 
    catch (IOException e) {
        e.printStackTrace();
    }
}

public void onPrepared(MediaPlayer mediaPlayer)
{ 
                Log.v(LOG_TAG, "finished preparing; starting");
    mp.start();
        Log.v(LOG_TAG, "started music");
}

public boolean onError(MediaPlayer mp, int e, int f)
{
        Log.v(LOG_TAG, "There was an error");
        Log.v(LOG_TAG, mp + " " + e + " " + f);
    mp.reset();
    return true;
} 
```

基本上它会到达设置的“设置数据源”标签，但从未完成准备。错误代码是 (1, 4) 1 显然是未知错误。我使用了多个声音文件，我知道其中一个声音文件在仅使用 mp.create(etc...) 时就像播放器一样工作

我不确定这里发生了什么

提前致谢

编辑：所以我按照亚历克西斯卡地亚给出的链接示例，现在没有错误。但是， FileinputStream 永远不会完成。该程序似乎停滞不前。这是新代码：

```
public void playMusic()
{
    File file = new File("R.raw.music1");
        Log.v(LOG_TAG, "set file");
    try {
            Log.v(LOG_TAG, "in try block");
        FileInputStream is = new FileInputStream(file);
            Log.v(LOG_TAG, "set file input stream");
        mp.setDataSource(is.getFD());
            Log.v(LOG_TAG, "set data source");
        mp.setOnPreparedListener(this);
        mp.setOnErrorListener(this);
            Log.v(LOG_TAG, "set on prepared/error listeners");
        mp.prepareAsync();
            Log.v(LOG_TAG, "preparing");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:00:29.170

请参阅此问题的答案以修改您的代码：[MediaPlayer.setDataSource 导致 IOException for valid file](https://stackoverflow.com/questions/9657280/mediaplayer-setdatasource-causes-ioexception-for-valid-file)

但你做不到`mp.setDataSource("R.raw.sound1");`

# html - 覆盖大型下拉菜单的滑块

> ID：11970576
> 
> 赞同：0
> 
> 时间：2012-08-15T13:55:00.887
> 
> 标签：html, css, drop-down-menu, hover, slider

如果您可以将鼠标悬停在此处菜单中的“*更多*”按钮上：http: [//jsfiddle.net/H8FVE/3/](http://jsfiddle.net/H8FVE/3/) 您会注意到下方的宽大图片（#featured）覆盖了下拉 div。为什么以及如何解决？

这是我的 HTML 代码的一部分：

```
<div id="second-menu" class="clearfix">
    <ul id="secondary-menu" class="nav sf-js-enabled">
        <li class="manimation"><a href="" style="width:400px;border-bottom:9px solid #43cf61">Animation</a></li>
    </ul>

<ul id="mega">
    <li class="dif mmore" style="background:none;"><a href="#" style="font-style:italic;border-bottom:9px solid #4b5571">More...</a>
      <div>
    <ticman>
    <ul>
        <li class="mgames"><a href="" style="border-bottom:9px solid #e34328">Games</a></li>
        <li class="mliterature"><a href="" style="border-bottom:9px solid #2c8f83">Literature</a></li>
        <li class="marts"><a href="" style="border-bottom:9px solid #cc226a">Arts</a></li>
        <li class="mcontact" style="background:none;"><a href="" style="border-bottom:9px solid #9395aa">Contact</a></li>
    </ul>
    </ticman>
        <h2>Classes</h2>
        <p><a href="#">Times</a><a href="#">Schedual</a><a href="#">Map</a></p>
        <p><a href="#">Names</a><a href="#">Study</a><a href="#">Directions</a></p>
        <p><a href="#">Health</a><a href="#">Dance</a><a href="#">Biology</a></p>
        <h2>Teachers</h2>
        <p><a href="#">Billy</a><a href="#">Madeleine</a><a href="#">Lauren</a><a href="#">Steve</a></p>
        <p><a href="#">Paddington</a><a href="#">Stefan</a><a href="#">Michael</a><a href="#">Madeline</a></p>
        <p><a href="#">Shannon</a><a href="#">Mary</a><a href="#">Raffaello</a><a href="#">Lorence R</a></p>
        <h2>Location</h2>
        <p><a href="#">Carlsbad</a><a href="#">Oceanside</a><a href="#">El Cajon</a></p>
        <p><a href="#">Vista</a><a href="#">La Costa</a><a href="#">Encinitas</a></p>
        <p><a href="#">San Diego</a><a href="#">Los Angles</a><a href="#">Cardiff</a></p>
      </div>
    </li>
  </ul>
</div> <!-- end #second-menu -->

<div class="et_cycle" id="featured">
    <a href="#" id="left-arrow">Previous</a>
    <a href="#" id="right-arrow">Next</a>

    <div id="slides" style="position: relative; background-image: none;">
                                    <div class="slide" style="position: absolute; top: 0px; left: 0px; z-index: 3; opacity: 1; display: block;">
                        <img width="958px" height="340px" alt="10 moments in cinematic history changing faith" src="http://ftframes.com/delheat/wordpress/wp-content/uploads/et_temp/ip-man-donnie-yen-756651_958x340.jpg">                <div class="featured-top-shadow"></div>
                <div class="featured-bottom-shadow"></div>    
                <div class="featured-description">
                    <div class="feat_desc">
                        <p class="meta-info">Posted by <a rel="author" title="Posts by admin" href="http://ftframes.com/delheat/wordpress/?author=1">admin</a> on Aug 9, 2012</p>
                        <h2 class="featured-title"><a href="http://ftframes.com/delheat/wordpress/?p=43">Some random text here</a></h2>
                        <p>Well, I like this trailer a bit better than Chasing Mavericks’. Well for one, Gerry gets to keep his Scottish brogue, wahoo! Plus, I kind of like seeing him with kids. I mean the last time he played dad to a little boy was in the wonderful indie Dear Frankie, and he’s definitely a natural with them. Then there’s the supporting cast: Catherine Zeta-Jones, Jessica Biel, Uma Thurman, Dennis Quaid and...</p>
                    </div>
                    <a class="readmore" href="http://ftframes.com/delheat/wordpress/?p=43">Read More</a>
                </div> <!-- end .description -->
                    </div> <!-- end .slide -->
                                    <div class="slide" style="position: absolute; top: 0px; left: 0px; display: none; z-index: 2; opacity: 0;">
                        <img width="958px" height="340px" alt="More experimental testings" src="http://ftframes.com/delheat/wordpress/wp-content/uploads/2012/07/vlcsnap-2012-05-13-22h37m19s79-300x129.png">                <div class="featured-top-shadow"></div>
                <div class="featured-bottom-shadow"></div>    
                <div class="featured-description">
                    <div class="feat_desc">
                        <p class="meta-info">Posted by <a rel="author" title="Posts by admin" href="http://ftframes.com/delheat/wordpress/?author=1">admin</a> on Jul 30, 2012</p>
                        <h2 class="featured-title"><a href="http://ftframes.com/delheat/wordpress/?p=10">More experimental testings</a></h2>
                        <p>Lets see how this one turns out… Lets see how this one turLets see how this one turLets see how this one turLets see how this one turLets see how this one turLets see how this one turLets see how this one turLets see how this one tur
&nbsp;
Lets see how this one turLets see how this one turLets see how this one turLets see how this one turLets see how this one turLets see how this one turLets see how...</p>
                    </div>
                    <a class="readmore" href="http://ftframes.com/delheat/wordpress/?p=10">Read More</a>
                </div> <!-- end .description -->
                    </div> <!-- end .slide -->
                                    <div class="slide" style="position: absolute; top: 0px; left: 0px; display: none; z-index: 1; opacity: 0;">
                        <img width="958px" height="340px" alt="Testing this theme with image" src="http://ftframes.com/delheat/wordpress/wp-content/uploads/et_temp/251932_10151043115229294_310983318_n-39277_635x340.jpg">                <div class="featured-top-shadow"></div>
                <div class="featured-bottom-shadow"></div>    
                <div class="featured-description">
                    <div class="feat_desc">
                        <p class="meta-info">Posted by <a rel="author" title="Posts by admin" href="http://ftframes.com/delheat/wordpress/?author=1">admin</a> on Jul 30, 2012</p>
                        <h2 class="featured-title"><a href="http://ftframes.com/delheat/wordpress/?p=6">Testing this theme with image</a></h2>
                        <p>And this is how it looks, very interesting indeed.And this is how it looks, very interesting indeed.And this is how it looks, very interesting indeed.And this is how it looks, very interesting indeed.And this is how it looks, very interesting indeed.And this is how it looks, very interesting indeed.And this is how it looks, very interesting indeed.And this is how it looks, very interesting...</p>
                    </div>
                    <a class="readmore" href="http://ftframes.com/delheat/wordpress/?p=6">Read More</a>
                </div> <!-- end .description -->
                    </div> <!-- end .slide -->
                    </div> <!-- end #slides -->
</div> <!-- end #featured --> 
```

这是我的 CSS 的一部分：

```
ul#secondary-menu li { background: url(images/secondary-menu-bg.png) repeat-y top right; }
    ul#secondary-menu a { font-size: 16px; color: #48423f; text-decoration: none; text-transform: uppercase; font-weight: bold; padding: 22px 16px; }
    ul#secondary-menu a:hover { color: #ffffff; text-shadow: 1px 1px 0 #404747; }
    #second-menu ul.nav li:hover a {color: #ffffff; text-shadow: 1px 1px 0 #404747; }

    ul#secondary-menu > li.current_page_item > a { color: #919e9e !important; }    

    ul#secondary-menu li ul, #category_mobile_menu { width: 360px !important; padding: 7px 0 10px; background: #fff url(images/content-bg.png); top: 55px !important; -moz-box-shadow:3px 3px 7px 1px rgba(0, 0, 0, 0.1); -webkit-box-shadow: 3px 3px 7px 1px rgba(0, 0, 0, 0.1); box-shadow: 3px 3px 7px 1px rgba(0, 0, 0, 0.1); -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px; border-top-left-radius: 0px;-moz-border-radius-topleft: 0px; border-top-right-radius: 0px; -webkit-border-top-left-radius: 0px; -moz-border-radius-topright: 0px; -webkit-border-top-right-radius: 0px; z-index: 9999px; display: none; }
        ul#secondary-menu ul li, #category_mobile_menu li a { margin: 0 !important; padding: 8px 0 8px 30px !important; width: 150px; float: left; }
            ul#secondary-menu ul li a, #category_mobile_menu a { padding: 0 !important; }

            ul#secondary-menu li:hover ul ul, ul#secondary-menu li.sfHover ul ul { top: -8px !important; left: 180px !important; -moz-border-radius: 8px; -webkit-border-radius: 8px; border-radius: 8px; }
            ul#secondary-menu ul li.even-item { background: none; }

.mfilm:hover{
    background:#ea2e49 !important;
}
.mtv:hover{
    background:#2589cf !important;
}
.mwebvideos:hover{
    background:#5c58ac !important;
}
.manimation:hover{
    background:#43cf61 !important;
}
.manime:hover{
    background:#c142a5 !important;
}
.mmanga:hover{
    background:#e77848 !important;
}
.mcomics:hover{
    background:#e8eb05 !important;
}
.mwriters:hover{
    background:#ff3c75 !important;
}
.mmore:hover{
    background:#4b5571 !important;
}
.mliterature:hover{
    background:#2c8f83 !important;
}
.mgames:hover{
    background:#e34328 !important;
}
.marts:hover{
    background:#cc226a !important;
}
.mcontact:hover{
    background:#9395aa !important;
}

/* ---------- Mega Drop Down --------- */
ul#mega li { padding-right: 0px; background: url(images/secondary-menu-bg.png) repeat-y top right; }

#mega {
list-style:none;
font-weight:bold;
height:2em;

}
#mega li {
padding: 23px 0px;
background:#999;
border:0px solid #000;
float:left;
text-align:center;
position:relative;
}
#mega li:hover {
background:#eee;
border-bottom:0; /* border-bottom:0; and padding-bottom:1px; keeps <li> and <div> connected */
z-index:1; /* shadow above adjacent li */

}
#mega a { font-size: 16px; color: #48423f; text-decoration: none; text-transform: uppercase; font-weight: bold; padding: 22px 16px;}

ul#mega a:hover { color: #FFFFFF; text-shadow: 1px 1px 0 #404747; }

/* ----------- Hide/Show Div ---------- */
#mega div {
    -moz-border-bottom-colors: none;
    -moz-border-image: none;
    -moz-border-left-colors: none;
    -moz-border-right-colors: none;
    -moz-border-top-colors: none;
    background: none repeat scroll 0 0 #FFFFFF;
    border-color: -moz-use-text-color #48423F #48423F;
    border-right: 1px solid #48423F;
    border-style: none solid solid;
    border-width: 0 1px 1px;
    font-weight: normal;
    left: -999em;
    margin-top: 1px;
    position: absolute;
    text-align: left;
    width: 496px;
}
/* --------- Within Div Styles --------- */
#mega li:hover div {
    left: -1px;
    top: auto;
}
#mega li.dif:hover div {
    left: -407px;
    top: 72px;
}
#mega li.mmore:hover > a {
    color: #FFFFFF; text-shadow: 1px 1px 0 #404747; /* Ensures hover on MORE remains */
}
#mega div h2 {
    background: none repeat scroll 0 0 #999999;
    clear: both;
    float: left;
    font-size: 1em;
    margin: 10px 0 5px;
    padding: 0 10px;
    position: relative;
    width: 300px;
}
#mega div ticman {
    clear: both;
    float: left;
    position: relative;
margin-left:1px;
margin-right:1px;
    width: 495px;
    height: 74px;
    background-image: url(images/morebgwide.png);
    background-size:495px 74px;
    background-repeat:no-repeat;
}
#mega div p {
    float: left;
    padding-left: 10px;
    position: relative;
    width: 106px;
}
#mega div p a {
    clear: left;
    float: left;
    line-height: 1.4;
    text-decoration: underline;
    width: 100%;
}
#mega div a:hover, #mega div a:focus, #mega div a:active {
    text-decoration: none;
}

/*------------------------------------------------*/
/*--------------[FEATURED SLIDER]-----------------*/
/*------------------------------------------------*/

#featured { position: relative; padding-bottom: 20px; margin-left: -1px; margin-right: -1px; }    
    a#left-arrow, a#right-arrow { position: absolute; top: 136px; width: 32px; height: 68px; text-indent:-9999px; }
        a#left-arrow { background:url(images/left-arrow.png) no-repeat; left: -32px; }    
        a#right-arrow { background:url(images/right-arrow.png) no-repeat; right: -32px; }
            .featured-top-shadow { background:url(images/featured-top-shadow.png) repeat-x; position: absolute; top:0px; left: 0px; width: 958px; height: 7px; }
            .featured-bottom-shadow { background:url(images/featured-bottom-shadow.png) repeat-x; position: absolute; bottom:0; left: 0; width: 958px; height: 8px; }
            .featured-description { position: absolute; width: 333px; height: 196px; top: 40px; right:54px; background:url(images/featured-description.png); padding: 27px 32px 40px; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px; }
                .featured-description p.meta-info { font-family: Georgia, serif; font-style: italic; font-size: 12px; color: #747474; }
                    .featured-description p.meta-info a { text-decoration: none; color: #fff; }
                h2.featured-title { font-family: 'Kreon', Arial, sans-serif; font-weight: lighter;font-size: 30px; text-shadow: 1px 1px 1px rgba(0,0,0,0.4); margin-top: -4px; }
                    h2.featured-title a { text-decoration: none; color: #ffffff; }
                .featured-description p { color: #c9c8c8; text-shadow: 1px 1px 1px rgba(0,0,0,0.4); line-height: 19px; }    
                a.readmore { display: block; background: url(images/readmore.png); height: 27px; padding: 0 17px; color: #dfca81; font-size: 12px; line-height: 27px; position: absolute; bottom: 0px; right: 0px; text-shadow: none; }
                #featured a.readmore { -moz-border-radius-bottomright: 10px;-webkit-border-bottom-right-radius: 10px; border-bottom-right-radius: 10px;  }
                    #featured a.readmore:hover { color: #fff; } 
```

虽然，我建议忽略小提琴以直观地展示该问题：http: [//jsfiddle.net/H8FVE/3/](http://jsfiddle.net/H8FVE/3/)

我一整天都在努力解决这个问题，以至于我几乎把头发着火了。你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:09:22.707

无论您的 DOM 树如何，使用 z-index css 属性在 HTML 中直观地分层对象。我建议你测试你最终的跨浏览器实现，尤其是 IE7。该死的 IE7 你给我们带来的额外工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:04:29.427

尝试这个：

```
#mega li:hover {
background:#eee;
border-bottom:0; /* border-bottom:0; and padding-bottom:1px; keeps <li> and <div> connected */
z-index:10; /* shadow above adjacent li */
} 
```

我将 z-index 更改为 10，而不是 1。

[http://jsfiddle.net/H8FVE/5/](http://jsfiddle.net/H8FVE/5/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:07:33.507

请参阅[http://jsfiddle.net/H8FVE/6/](http://jsfiddle.net/H8FVE/6/)：

只需添加

```
#second-menu{
    z-index:4;position:relative;
} 
```

那是因为`slide`有`z-index:3`，所以如果你想看`second-menu`，它`z-index`必须更高。

而且您也必须添加`position:relative`，因为`z-index`对带有 . 的元素没有影响`position:static`。

**编辑**：

我看到你有

```
#mega div{
    left:-999em;
}
#mega li.dif:hover div {
    left: -407px;
    top: 72px;
} 
```

我认为这样会更好：

```
#mega > li.dif > div{
    display:none:
    left: -407px;
    top: 72px;
}
#mega > li.dif:hover > div {
    display: block;
} 
```

那是因为如果您设置`left:-999em;`为`#mega div`，您认为它不会显示，因为 -999em 很多。但如果你想隐藏它，不显示它不是更好吗？

我添加了子选择器（`>`），因为将来你可能会修改它并在里面添加更多的 div `#mega > li.dif > div`；子选择器应该比后代选择器快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T14:06:28.493

将 #second-menu 的 z-index 设为 3

将“#mega div”的 z-index 设为 2

将 #featured 的 z-index 设为 1

# game-center - 结束 GKTurnBasedMatch 时的问题

> ID：11970582
> 
> 赞同：1
> 
> 时间：2012-08-15T13:55:24.913
> 
> 标签：game-center

我一直在两台设备上测试我的回合制游戏应用程序。当设备 1 退出时（通过滑动并从 GKTurnBasedMatchmakerViewController 中删除比赛），它会更新设备 2 以显示比赛已经完成（但它仍然在 GKTurnBasedMatchmakerViewController 中显示比赛是轮到其他玩家），但设备 1 没有更新！

它在 Game Over 部分下的 GKTurnBasedMatchmakerViewController 中说结束了比赛，但说“没有结果”，并且来自苹果纪录片 - 参与者的结果尚未确定（通常是因为比赛仍在进行中）。

我想知道如何将其设置为其他东西，以及通过退出这种方式（应该）调用什么方法。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-13T02:20:51.303

```
- (void)turnBasedMatchmakerViewController:(GKTurnBasedMatchmakerViewController *)viewController playerQuitForMatch:(GKTurnBasedMatch *)match {

    if ([match.currentParticipant.playerID isEqualToString:[GKLocalPlayer        localPlayer].playerID]) {

        [match participantQuitInTurnWithOutcome:GKTurnBasedMatchOutcomeQuit nextParticipants:nextParticipant turnTimeout:GKTurnTimeoutNone matchData:data completionHandler:^(NSError *error) {

            [match removeWithCompletionHandler:^(NSError *error) {

                //Player quitted and match removed

            }];

        }];

    }
    else {

        [match participantQuitOutOfTurnWithOutcome:GKTurnBasedMatchOutcomeQuit withCompletionHandler:^(NSError *error) {

            [match removeWithCompletionHandler:^(NSError *error) {

                //Player quitted and match removed

            }];

        }];

    }

} 
```

对于设备 2

```
-(void)handleTurnEventForMatch:(GKTurnBasedMatch *)match {

    if (player2.matchOutcome==GKTurnBasedMatchOutcomeQuit){

        //Your opponent quitted do something

    }

} 
```

# apl - APL 从数组中删除元素

> ID：11970586
> 
> 赞同：3
> 
> 时间：2012-08-15T13:55:49.110
> 
> 标签：apl

我是 APL 的新手。如何从数组中删除不需要的元素？

例如：

```
 X←1 2 3 4 5 6 7 8 9 
```

现在我想删除等于 4 或 6 的 X 元素。我试过了

```
X←4↓X 
```

从 X 中删除 4，但它没有用。提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-14T14:58:07.613

The appropriate way to do this is using the without function (dyadic tilda):

```
 x←1 2 3 4 5 6 7 8 9
      x~4 6
1 2 3 5 7 8 9 
```

However, if you need the location of the items you want removed for additional purposes (perhaps to remove the corresponding items from some some other related array) then the technique by MrZander above is appropriate.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-21T05:28:48.030

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T03:50:06.843

You could create a binary mask such that 0 implies "element is 4 or 6" and 1 implies "element is neither 4 nor 6". Then you select from the array using this mask.

`(~(6=X)∨(4=X))/X`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-10T16:47:05.770

For most purposes, the without function mentioned by Paul Mansour is a better approach. but if you wanted to use a bit-mask, try:

```
(~(X¹4 6))/X 
```

(Note that "¹" is the "member" primitive, normally represented as an epsilon character.)

This selects all elements of X that are either 4 or 6, then applies a not to create a boolean that is 0 for all elements that are 4 or 6, and uses that to compress X, removing all 4s and 6s. Perhaps more useful would be:

```
((bv{gets}~X{member}4 6))/X 
```

This would save the compression vector (aka mask) in a separate variable bv. If there are several structures that should be kept in sync, bv could then be used to compress the others to match X. Of course, a more complex condition for bv would be likely in real working code. ({gets} stands for the assignment operation, normally represented by a leftward arrow.)

# php - PHP 和 SQL 上次登录

> ID：11970595
> 
> 赞同：0
> 
> 时间：2012-08-15T13:56:16.793
> 
> 标签：php, sql, ip-address

好的，所以我将尝试`$_SERVER['REMOTE_ADDR'];`在数据库的用户列中插入。所以它就像：

```
username |  192.168.0.1 
```

我尝试使用插入，使其插入列并在每次登录后覆盖，但它只是创建一个全新的行。

```
mysql_query("INSERT INTO `users` (`last-login`) VALUES ('$ip')"); 
```

所以，我的问题是如何让它覆盖一个全新的 IP 并将其插入到用户每次登录时的最后登录列中？

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T13:59:03.747

您将需要使用 UPDATE 语句，然后更新该列。我确定表中有用户名字段吗？如果是这样..这样的事情：

```
mysql_query("UPDATE users SET last-login='$ip' WHERE username='$username'"); 
```

希望这可以帮助你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T13:59:05.523

尝试更新命令： [http ://dev.mysql.com/doc/refman/5.0/en/update.html](http://dev.mysql.com/doc/refman/5.0/en/update.html)

# cocoa-touch - 如何跟踪两个 UIView 控制器之间的 UITouches？（使用遏制）

> ID：11970597
> 
> 赞同：2
> 
> 时间：2012-08-15T13:56:32.007
> 
> 标签：cocoa-touch, ios5, uiviewcontroller, uitouch

我有两个视图控制器同时出现在屏幕上，使用视图控制器包含，实现与 Apple 的代码示例相同。将它们称为视图控制器 A (vcA) 和视图控制器 B (vcB)，以及容器视图控制器 (containerVC)。

每个 vcA 和 vcB 都有一个对象网格，我希望能够将对象从 vcA 拖动到 vcB。更具体地说，我希望源自 vcA 的触摸在 vcB 中的 touchesMoved:withEvent 方法到达边界 vcB 内。

我已经覆盖了 containerVC 上的 touchesMoved:withEvent 方法，通过命中测试跟踪触摸，并尝试将触摸*向下*转发到 UIView 层次结构，如下所示：

```
// in the containerVC
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    CGPoint locationPoint = [[touches anyObject] locationInView:self.view];
    UIView* touchIsInViewControllerA = [vcA hitTest:locationPoint withEvent:event];
    if (touchIsInViewControllerA) {
        NSLog(@"Touch is in vcA");
        return;
    }
    UIView* touchIsInViewControllerB = [vcB hitTest:locationPoint withEvent:event];
    if (touchIsInViewControllerB) {
        NSLog(@"Touch is in vcB");
        [vcB touchesMoved:touches withEvent:event]; // this causes a crash
    }
} 
```

这似乎是递归的，containerVC 将触摸事件向下推送到层次结构，然后 vcB 将触摸事件向上传递到层次结构。

我的问题：有没有办法阻止 vcB 将触摸事件从响应者链传递到 containerVC？或者我应该以不同的方式处理这个问题 - 让 vcB 成为 vcA 的代表，而将 containerVC 排除在外吗？

**注意：**我猜一个常见的反应是放弃 VC 包含模式并将其全部保存在一个视图控制器中，但由于此示例中未显示的原因，我认为将它们分开对我来说会更好 - 除非这完全是精神错乱并且超级hacky这样做......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T09:46:56.257

这个问题可以通过为每个视图控制器设置单独的手势对象来轻松解决。

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

 if (touchIsInViewControllerA) {

// calls a delegate of view controller A

  }
else
 {

// calls a delegate of view controller B
 }
} 
```

# android - 如何创建用于自定义布局的自定义 LayoutParams？

> ID：11970601
> 
> 赞同：13
> 
> 时间：2012-08-15T13:56:58.150
> 
> 标签：android, android-layout

我相当精通基于 ViewGroup 创建复杂的自定义布局。我唯一缺少的是创建自定义 LayoutParams 的能力。我真的需要获得利润的能力，为什么不创建其他额外的参数来传递给父级。

如何创建自定义 LayoutParam 并通过 xml 使用它？我尝试使用 LinearLayout.LayoutParam 但它显然崩溃了，因为父级不是 LinearLayout。如何在自定义布局上使用 LayoutParams？

**更新：**

到目前为止，我坚持使用 FrameLayout 并覆盖 onMeasure 和 onLayout 函数来自己进行布局。这确实提供了 FrameLayout.LayoutParams。我猜孩子们必须支持自定义 LayoutParam？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-08-15T17:26:19.730

在您的自定义布局中，创建一个嵌套类扩展`ViewGroup.LayoutParams`. 然后覆盖一些方法（所有必需的方法都在我的示例中）。这是我的一个自定义布局的精简版：

```
public class MyLayout extends ViewGroup {

    public MyLayout(Context context) {

    }

    public MyLayout(Context context, AttributeSet attrs) {

    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {

    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {

    }

    @Override
    protected boolean checkLayoutParams(ViewGroup.LayoutParams p) {
        return p instanceof LayoutParams;
    }

    @Override
    protected LayoutParams generateDefaultLayoutParams() {
        return new LayoutParams();
    }

    @Override
    public LayoutParams generateLayoutParams(AttributeSet attrs) {
        return new LayoutParams(getContext(), attrs);
    }

    @Override
    protected LayoutParams generateLayoutParams(ViewGroup.LayoutParams p) {
        return generateDefaultLayoutParams(); // TODO Change this?
    }

    public static class LayoutParams extends ViewGroup.LayoutParams {

        public LayoutParams() {

        }

        public LayoutParams(int width, int height) {

        }

        public LayoutParams(Context context, AttributeSet attrs) {

        }

    }

} 
```

进一步说明：[如何创建 FlowLayout](http://www.parleys.com/#st=5&id=2191&sl=38)（感谢[Luksprog](https://stackoverflow.com/users/493939/luksprog)的链接！）

# java - 动态数组和列表

> ID：11970602
> 
> 赞同：0
> 
> 时间：2012-08-15T13:56:59.657
> 
> 标签：java, arrays, list

所以，我正在尝试创建一种用于创建问题列表的文本编辑器。我不确定如何实现这一目标。

到目前为止，我想出的是创建一个代表 A4 纸的 JPanel。然后，我想创建另一个 JPanel，其中包含几个文本框，可以在其中输入问题/答案。问题是我希望能够从“文档”中的任何位置添加/删除问题。用数组做这件事会很乏味，我会活下来，但主要问题是固定数组大小。

我的问题是，有什么方法可以创建某种动态列表，在我的情况下该怎么做？能够通过简单地调用其任何文本框来查明某个“问题”JPanel 也很重要（因为单击文本框并按下组合键会在调用的问题之后添加另一个问题，至少这是计划）。

任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:03:09.670

看看[ArryList](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)。[util包](http://docs.oracle.com/javase/7/docs/api/index.html?java/util/List.html)中还有很多其他的集合类也值得一看。但是，如果您不需要 List 并且希望能够通过已知键检索您的对象，则[HashMap](http://docs.oracle.com/javase/7/docs/api/index.html?java/util/List.html)将是更好的选择。例如，您应该能够使用 JPanel 或 TextField 作为键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:04:06.077

尝试使用`collections`, from`java.util.collection`包。

**1.**如果您创建的每个问题都附加了一个唯一标识符`Map`，那么请尝试使用`Integer``String`

```
Map<Integer, String> map = HashMap<Integer, String>(); 
```

**2.**如果你在存问题`sequence`，`List`也可以。

`List<String> list = ArrayList<String>();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:04:20.687

你的意思是[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)吗？

您还可以使用[Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)有一个键，然后 JPanel 作为一个实例？

听起来 ArrayList 更好，然后在单击时生成一个新的 JPanel，该 JPanel 偏向于 ArrayList 中的对象/字符串。

# mysql - 为什么 MySQL 没有按预期排序？

> ID：11970603
> 
> 赞同：2
> 
> 时间：2012-08-15T13:57:10.923
> 
> 标签：mysql, sql, sql-order-by

我有一个非常简单的 MySQL 表，其中包含团队名称和 ID。团队名称如下所示：

```
Damer
F11
F12
F15
Herrar
HJ18
HJ20
P15
P16
P11
P12
P8
... 
```

但是，当我根据团队名称通过 ASC 或 DESC 订购时，我并没有按照我期望的顺序得到它们，就像上面那样。相反，我得到一个这样的列表：

```
P15
P16
Damer
F11
F12
F15
Herrar
HJ18
HJ20
P11
P12
P8
... 
```

这没有任何意义，为什么 MySQL 以两个以 P 开头的名称开头，然后一个以 D 开头，然后是三个以 F 开头的名称……最后以三个以 P 开头的团队结束。

任何想法？

mysql代码：

```
SELECT *
FROM `team`
ORDER BY `team`.`teamname` ASC
LIMIT 0 , 30 
```

我正在使用 mysql collat​​ion utf8_swedish_ci。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T14:03:25.107

您可能在无序名称的第一个字符之前有一个空格。

# linux - 如何在期望中设置bash变量或从期望返回变量到bash

> ID：11970608
> 
> 赞同：0
> 
> 时间：2012-08-15T13:57:28.667
> 
> 标签：linux, bash, shell

```
 VAR=$(expect -c ' 
 spawn ssh-copy-id -i '"$SSH_KEY_PATH_PUB $REMOTE_HOST_USER@$REMOTE_HOST_IP"' 
 expect "*?assword:*" 
 send "'"$REMOTE_HOST_PASSWD"'\r"; 
 expect {
 "Permission denied, please try again."{ 
 send user "Wrong pass" 
 exit 5
 }
 }
 ')
 echo "$VAR" 
```

更新：所以当代码进入 Permission denied 块时我需要退出条件。我正在查看 $?

但它是 0，因为 "$VAR" 运行成功。

所以当它进入 Permission denied 块时我需要一个整数返回值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:58:38.320

Expect starts its own tcl shell, so you cannot use aliases defined in your bash environment.

Expect does have the variable `$env(YOURBASHVARIABLE)`, which allows Expect to grab your environment variables, but Expect can only modify them internal to the script. However, any modifications you make to the variable will not be kept once the expect script is finished.

If flag is going to be a number, you could use an exit status (e.g., `exit 5`) and then use `$?` in your script to get the exit status.

**Per your update** The expect script doesn't return anything, it just sets an exit code.

What you could do is simply:

```
$(expect -c ' 
  spawn ssh-copy-id -i '"$SSH_KEY_PATH_PUB $REMOTE_HOST_USER@$REMOTE_HOST_IP"' 
  expect "*?assword:*" 
  send "'"$REMOTE_HOST_PASSWD"'\r"; 
  expect {
    "Permission denied, please try again."{ 
      send user "Wrong pass" 
      exit 5
    }
  }
'); var=$? 
```

This way, `var` will be set to your exit status.

Also, you should take note of this:

> By convention, environment variables (PATH, EDITOR, SHELL, ...) and internal shell variables (BASH_VERSION, RANDOM, ...) are fully capitalized. All other variable names should have at least one lowercase letter. Since variable names are case-sensitive, this convention avoids accidentally overriding environmental and internal variables.

EDIT(mpapis): there is also other use case:

```
if output="$(expect ...)"
then
  echo "it worked: $output"
else
  result=$?
  echo "it failed($result): $output"
fi 
```

**EDIT(twmb)**

With the last use case, you have to be careful with what you are returning. It will take all output sent to the user. Unless you have logging turned off (with `log_user 0`) and you are controlling exactly what will be outputted in the expect script, you will probably get more information than needed.

Another drag with this is indicated in the comment below;

```
returned="$(expect -c '
  log_user 1  ;# turn to 0 and use send_user to control the exact output
  spawn bash
  expect "\\$"
  send "echo hello\r"
  send_user "this will be returned"
  expect "\\$" ;# without this line, the script would exit too fast 
               ;# for the "echo hello" to be sent to stdout by bash
               ;# and thus wont be recorded
  exit 6
  '
  )"; var=$?
echo "var: $var"
echo "returned: $returned" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T16:36:45.073

在这种情况下，`VAR`包含`output`命令的。

您必须使用`$?`，其中包含最后执行的命令的退出状态。设置一个变量不会改变`$?`，所以它仍然会包含 subshel​​l 的退出状态`$(...)`。

例子：

```
x=$(expect -c 'send "hello"; exit 5;')
echo $?; echo $x
5
hello 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:56:57.437

In expect you can use `set env` to manipulate environment variables. If a number, you can pass variable from expect to bash thanx to exit command. Let's see an example:

```
~/Desktop> cat test.exp
puts "From shell: FLAG=$env(FLAG)"
set env(FLAG) 22
puts "Set by expect: FLAG=$env(FLAG)"
exit $env(FLAG)
~/Desktop> export FLAG=0
~/Desktop> expect test.exp 
From shell: FLAG=0
Set by expect: FLAG=22
~/Desktop> echo $?
22
~/Desktop> 
```

# vb.net - 错误说 x 不是 y 的成员，但它是

> ID：11970610
> 
> 赞同：0
> 
> 时间：2012-08-15T13:57:31.657
> 
> 标签：vb.net, linq, linq-to-sql, stored-procedures

我有一个 sp 添加到我的 linq 设计器中，它生成了结果类：

```
Partial Public Class web_GetTweetsByUserIDResult

    Private _userid As Integer

    Private _tweetid As Integer

    Private _TweeterFeed As String

    Public Sub New()
        MyBase.New
    End Sub

    <Global.System.Data.Linq.Mapping.ColumnAttribute(Storage:="_userid", DbType:="Int NOT NULL")>  _
    Public Property userid() As Integer
        Get
            Return Me._userid
        End Get
        Set
            If ((Me._userid = value)  _
                        = false) Then
                Me._userid = value
            End If
        End Set
    End Property

    <Global.System.Data.Linq.Mapping.ColumnAttribute(Storage:="_tweetid", DbType:="Int NOT NULL")>  _
    Public Property tweetid() As Integer
        Get
            Return Me._tweetid
        End Get
        Set
            If ((Me._tweetid = value)  _
                        = false) Then
                Me._tweetid = value
            End If
        End Set
    End Property

    <Global.System.Data.Linq.Mapping.ColumnAttribute(Storage:="_TweeterFeed", DbType:="NVarChar(100)")>  _
    Public Property TweeterFeed() As String
        Get
            Return Me._TweeterFeed
        End Get
        Set
            If (String.Equals(Me._TweeterFeed, value) = false) Then
                Me._TweeterFeed = value
            End If
        End Set
    End Property
End Class 
```

但是，在我尝试使用结果类的“TweeterFeed”成员的这一段代码中，我收到错误消息，“错误 4 'TweeterFeed' 不是 'System.Data.Linq.ISingleResult(Of web_GetTweetsByUserIDResult)'。”

我在本节中的代码是：

```
<WebMethod()> _
    Public Function GetTweetsByUserID(ByVal userID As Integer) As List(Of SimpleTweet)
        Dim result As New List(Of SimpleTweet)
        Dim urlTwitter As String = "https://api.twitter.com/1/statuses/user_timeline.xml?include_entities=true&include_rts=true&screen_name={0}&count=20"
        Dim lq As New lqDFDataContext
        Dim var = lq.web_GetTweetsByUserID(userID).ToList()
        If Not var Is Nothing Then
            For Each twitterfeed In var

                Dim listURL As String = String.Format(urlTwitter, var.TweeterFeed)

                Dim tweetXML As XmlDocument = utils.GetXMLForURL(listURL)

                Dim tweetnodelist As XmlNodeList = tweetXML.ChildNodes(1).ChildNodes

                For Each node As XmlNode In tweetnodelist
                    Dim tweet As New SimpleTweet
                    tweet.CreatedAt = node.SelectSingleNode("created_at").InnerText
                    tweet.HTMLText = utils.ReturnTextWithHRefLink(node.SelectSingleNode("text").InnerText)
                    tweet.ID = node.SelectSingleNode("id").InnerText
                    tweet.Name = node.SelectSingleNode("user/name").InnerText
                    tweet.ScreenName = node.SelectSingleNode("user/screen_name").InnerText
                    tweet.Text = node.SelectSingleNode("text").InnerText
                    tweet.UserID = node.SelectSingleNode("user/id").InnerText
                    tweet.ProfileImageURL = node.SelectSingleNode("user/profile_image_url_https").InnerText
                    result.Add(tweet)
                Next
            Next
        End If
        Return result
    End Function 
```

有谁知道发生了什么？据我所知，“TweeterFeed”显然是该课程的成员，我不知道为什么会出现此错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:02:00.860

你在`var.TweeterFeed`应该使用的时候使用`twitterFeed.TweeterFeed`。`twitterFeed`是从中提取*的*`var`结果，是*一系列*结果。

使用更具描述性的变量名称`var`可能会使您更清楚:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-19T22:07:31.093

我有这门课

```
Public Class Tamano
    Private pWidth As Integer
    Private pHeight As Integer
    Public Property Width As Integer
    Public Property Height As Integer
End Class 
```

我`'Height' is not a member of 'Tamaño'`在 IIS 中收到编译错误消息

要修复它，请将 Set 和 Get 添加到属性并编译。

```
Public Class Tamano
    Private pWidth As Integer
    Private pHeight As Integer
    Public Property Width As Integer
        Get
            Return pWidth
        End Get
        Set(value As Integer)
            pWidth = value
        End Set
    End Property
    Public Property Height As Integer
        Get
            Return pHeight
        End Get
        Set(value As Integer)
            pHeight = value
        End Set
    End Property
End Class 
```

这可能与您的问题没有直接关系，但可能对其他人有所帮助。

# r - 将向量转换为逻辑矩阵

> ID：11970611
> 
> 赞同：0
> 
> 时间：2012-08-15T13:57:32.793
> 
> 标签：r

是否有一个本机 R 函数将采用输入向量并返回相应的二进制矩阵，其中矩阵的列数与输入向量中的唯一值相同？

例如，给定`x <- 1:3`，我想返回以下矩阵：

```
 [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1 
```

功能`contrasts`越来越接近，但我似乎无法绕过返回的 n-1 列：

```
> contrasts(as.factor(x))
  2 3
1 0 0
2 1 0
3 0 1 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T14:15:11.267

其实，`contrasts`就是你想要的。

```
contrasts(as.factor(1:3), contrasts=FALSE)

  1 2 3
1 1 0 0
2 0 1 0
3 0 0 1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-15T14:08:09.040

`model.matrix()`在这里可能会有所帮助，但您需要抑制拦截：

```
> model.matrix(~ factor(1:3) - 1)
  factor(1:3)1 factor(1:3)2 factor(1:3)3
1            1            0            0
2            0            1            0
3            0            0            1
attr(,"assign")
[1] 1 1 1
attr(,"contrasts")
attr(,"contrasts")$`factor(1:3)`
[1] "contr.treatment" 
```

稍微复杂一点的东西：

```
> set.seed(1)
> fac <- factor(sample(1:3, 10, replace = TRUE))
> model.matrix(~ fac - 1)
   fac1 fac2 fac3
1     1    0    0
2     0    1    0
3     0    1    0
4     0    0    1
5     1    0    0
6     0    0    1
7     0    0    1
8     0    1    0
9     0    1    0
10    1    0    0
attr(,"assign")
[1] 1 1 1
attr(,"contrasts")
attr(,"contrasts")$fac
[1] "contr.treatment" 
```

# version-control - 忽略超越比较中的语法差异

> ID：11970613
> 
> 赞同：1
> 
> 时间：2012-08-15T13:57:36.620
> 
> 标签：version-control, compare, beyondcompare

在一个代码分支中，我将所有代码从 更改`obj.varname`为`obj("varname")`，当我比较代码时，我想忽略这些差异，因为它们`varname`是相同的。

我有一个我认为需要的正则表达式，但遗憾的是无法使用 Scooter 的 Beyond Compare 忽略比较

`^obj\("\w*"\)|obj\.\w*$`

我正在关注本教程[http://www.scootersoftware.com/support.php?zz=kb_unimportantv3](http://www.scootersoftware.com/support.php?zz=kb_unimportantv3)

所以我的问题是：这甚至可能无法比拟吗？如果是，请分享一个解决方案，包括说明或发布您的屏幕截图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:19:29.563

Beyond Compare 3 的专业版通过其**文本替换**功能支持这一点。如果您已经购买了标准版许可证，则需要恢复到试用模式进行测试： [http ://www.scootersoftware.com/suppo...?zz=kb_evalpro](http://www.scootersoftware.com/suppo...?zz=kb_evalpro)

1.  在文本比较中加载您的两个文件。
2.  **从“会话**”菜单打开“**会话设置”**对话框，然后在“**替换**”选项卡上单击**“新建”**以创建新的替换。
*******   在要查找编辑的**文本中，使用**`(\w+)\.(\w+)`*   在**替换为**编辑中，使用`$1("$2")`*   选中**正则表达式**复选框。******

 ***** * *

另一种方法是将任何实例标记为`obj.varname`和`obj("varname")`不重要。基本步骤是这样的：

1.  在文本比较中加载您的两个文件。
2.  **从“会话**”菜单打开“**会话设置”**对话框，然后在“**重要性**”选项卡上单击“**编辑语法...”**按钮。
*******   在下一个对话框中，单击顶部列表框下方的**New...按钮。***   **将元素名称**字段更改为有用的名称（例如“PropertyAccess”）。*   **将Category***更改为**List**。*   在*Text in list* * edit 中，添加这两行：

    `obj.varname`
    `obj("varname")`

    *   单击**确定**关闭**语法项**对话框，然后再次单击**确定**关闭*文本格式**语法项。

    *   **在“会话设置”对话框的“****语法元素**”列表框中取消选中“PropertyAccess”（或您命名的任何名称），然后单击“**确定**”将其关闭。******

 ******这种方法不够灵活或干净。在上面的步骤中，您正在匹配特定的硬编码对象和变量名称，因此`obj.varname`不重要但不重要`obj.othervar`，即使它与`obj("othervar")`. 如果两边的文字都不重要，那么差异将不重要；如果一侧很重要，那将是一个重要的区别。因此，通过上述步骤，`obj.varname`并且`obj("varname")`在任何地方都不重要，但它会正常工作，因为它们要么匹配到也匹配这些定义（因此不重要）的其他情况，要么匹配到其他不匹配的情况这个定义很重要，也会使差异变得重要。

您可以使用正则表达式来匹配更一般的文本类别，但您可能不想这样做。例如，如果您想匹配遵循该模式的所有文本，您可以使用以下两行代码：

```
\w+\.\w+
\w+\("\w+"\) 
```

然后检查**语法项目对话框中的****正则表达式**复选框，以便它们以这种方式匹配。

 **这样做的好处/坏处是*任何*与这些模式匹配的文本都不重要。 `abc.newvar`vs.`def.varname`会被认为是一个不重要的区别，因为双方都符合不重要的定义。这对于诸如注释或空白更改之类的事情很有用，但可能不是您想要在这里做的。************

# pandas - 强制在 pandas 中显示浮点数的指数

> ID：11970614
> 
> 赞同：2
> 
> 时间：2012-08-15T13:57:39.430
> 
> 标签：pandas

我有一些数字`DataFrame`当前显示为：0.000000。当我尝试：

```
set_printoptions(precision = 12) 
```

我会得到类似的东西：0.00000049100

有没有办法将此列中的所有/部分数字显示为指数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T19:32:35.633

您可以使用“set_eng_float_format()”切换到工程符号，另请参见[http://pandas.pydata.org/pandas-docs/stable/basics.html#console-output-formatting](http://pandas.pydata.org/pandas-docs/stable/basics.html#console-output-formatting)

# c# - 带有编译错误的 WiFi 信号强度函数

> ID：11970618
> 
> 赞同：0
> 
> 时间：2012-08-15T13:57:49.503
> 
> 标签：c#, visual-studio-2008, compiler-errors, signal-strength

我正在使用一个函数来返回此处给出的当前 WiFi 信号强度值：http: [//www.dotnet247.com/247reference/msgs/42/211278.aspx](http://www.dotnet247.com/247reference/msgs/42/211278.aspx)

在 Visual Studio 2008 中运行代码时，出现编译错误：

找不到命名空间“ManagementObjectSearcher”的类型。

我正在使用“使用 System.Manangement”

我的总体目标是获取信号强度并将其插入 Windows 窗体上的文本框中，所以一旦我使用下面的函数获取值，我只需将其弹出到框中供用户查看。

知道为什么我会收到这些错误吗？

代码：

```
 public static void signalStrentgh()
        {
           ManagementObjectSearcher searcher = new  
           ManagementObjectSearcher(@"root\WMI", "select 
           Ndis80211ReceivedSignalStrength from MSNdis_80211_ReceivedSignalStrength 
           where active=true");

            foreach (ManagementObject mo in searcher.Get())
            {
                Console.WriteLine("{0}", mo["Ndis80211ReceivedSignalStrength"]);
            }
        } 
```

注意* 下面发布的是旧的、不正确的代码版本，用 C++ 完成。这是参考评论和帮助。

```
int GetSignalStrength()
{
  ManagementObjectSearcher *searcher = new ManagementObjectSearcher(
  "root\\WMI",
  "select Ndis80211ReceivedSignalStrength from
  MSNdis_80211_ReceivedSignalStrength where active=true");

  ManagementObjectCollection *queryCollection = searcher->Get();

  ManagementObjectCollection::ManagementObjectEnumer ator* queryEnum =
  queryCollection->GetEnumerator();
  while (queryEnum->MoveNext());

  ManagementBaseObject* object = queryEnum->get_Current();
  Object* signalStrength =
  object->GetPropertyValue(L"Ndis80211ReceivedSignalStrengt h");
  return (Convert::ToInt32(signalStrength->ToString()));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:13:32.063

我为 C# 找到的东西类似于 MSDN：[http ://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/34a66ee5-34f8-473d-b6f2-830a14e2300b/](http://social.msdn.microsoft.com/forums/en-US/netfxnetcom/thread/34a66ee5-34f8-473d-b6f2-830a14e2300b/)

仔细阅读。看来您正在使用或已改编 C++ CLR 代码。您的代码似乎几乎是正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:26:16.400

要回答您的问题，您不能将`object`其用作变量名。 `object`是一个关键字。尝试将变量重命名为`obj`or`o`并查看是否有效。

为了进一步参考，我认为您正在使用一些非常古老的句法技巧编译 c# 代码。而且我认为这让很多人无法确定这是否真的是 c#。

指针语法可能不是必需的。ManagementObjectSearcher 是 System.Management 命名空间的一部分，因此在没有不安全指针语法的情况下可以安全使用。

另外，为什么要使用[命名空间别名限定符](http://www.google.com/url?sa=t&rct=j&q=namespace%20alias%20qualifier&source=web&cd=1&ved=0CE4QFjAA&url=http://msdn.microsoft.com/en-us/library/c3ay4x3d%28v=vs.80%29.aspx&ei=X7ArUIiLCajz0gGr-IB4&usg=AFQjCNGBD6XXcWW44YeHRW4pzYmA3H4Xgg)( `::`) ？直接使用点运算符（ManagementObjectCollection.ManagementObjectEnumerator）应该是安全的。事实上，在这里使用点运算符而不是指针语法应该是安全的。

# python - 最短路径算法递归

> ID：11970619
> 
> 赞同：0
> 
> 时间：2012-08-15T13:57:50.647
> 
> 标签：python, recursion, shortest-path

作为一个编程练习，我正在尝试用 Python 解决一个益智游戏。为此，我使用了一种递归算法，我认为这是一种深度优先搜索实现。我的问题是达到最大递归限制时出现运行时错误，我还没有弄清楚如何解决它。

我看过关于游戏和算法的不同帖子，但我没有在这个设置中重新编码，而是希望对我所写的内容有所帮助。所以这是我的代码的伪简化版本。

```
# Keep track of paths that I have found for given states. 
best_paths = dict()

def find_path(state, previous_states = set()):

  # The output is a tuple of the length of the path and the path.
  if state in previous_states:
    return (infty,None)
  previous_states = copy and update with state

  if state in target_states: 
    best_paths[state] = (0,[])

  if state in best_paths:
    return best_paths[state]

  possible_moves = set((piece,spaces) that can be moved)
  (shortest_moves,shortest_path) = (infty,None)
  for (piece,spaces) in possible_moves:
    move_piece(piece,spaces)
    try_state = the resulting state after moving the piece
    (try_moves,try_path) = find_path(try_state,previous_states)

    if try_moves < shortest_moves:
      shortest_moves = try_moves + 1
      shortest_path  = try_path + [(piece,spaces)]

    # Undo the move for the next call
    move_piece(piece,-spaces)

  if shortest_moves < infty:
    best_paths[state] = shortest_path

  return (best_moves, shortest_path) 
```

所以我的问题是，如果在 for 循环之外返回是什么导致递归达到最大值？
感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:17:28.410

如果您遇到递归深度超出异常，则您可能遇到代码问题或需要不同的算法。看起来你的算法是 O(N*N) 其中 N 是节点数。N 不需要很大就可以达到极限。

有更好的方法来解决这个问题。

# android - 不会共享的应用程序是否需要 Content Provider？

> ID：11970624
> 
> 赞同：4
> 
> 时间：2012-08-15T13:58:15.023
> 
> 标签：android, android-contentprovider, android-cursorloader

因为我注意到 SimpleCursorAdapter 类已被弃用，我现在应该利用我非常喜欢的新 Loader API，但是当我尝试这样做时，我发现 CursorLoader 仅适用于 ContentProvider。

现在我的问题是，我真的需要内容提供商吗？甚至官方指南都说：

> 如果您不打算与其他应用程序共享数据，则无需开发自己的提供程序。但是，您确实需要自己的提供程序在您自己的应用程序中提供自定义搜索建议。如果要将复杂数据或文件从应用程序复制并粘贴到其他应用程序，您还需要自己的提供程序。

而且我认为我不需要任何这个+因此会产生不必要的复杂性。所以..我应该怎么做，破解我自己的 CursorLoader 以仅与我的数据库一起工作（[没有 ContentProvider 的 CursorLoader 使用](https://stackoverflow.com/questions/7182485/usage-cursorloader-without-contentprovider)），老实说我不太喜欢，或者我应该把它吸起来并遵守提供者？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T14:12:10.287

您可以编写一个`Loader`（或使用`CommonsWare`'s [`SQLiteCursorLoader`](https://github.com/commonsguy/cwac-loaderex)）来直接查询您的`SQLiteDatabase`。`ContentProvider`该文档是正确的，因为如果您的应用程序只需要简单地访问本地数据（而不是与不同的进程/应用程序共享该数据），您实际上并不需要 a 。

也就是说，`ContentProvider`确实提供了一些好处。例如，您需要一个`SyncAdapter`使用`SearchManager`. 我尝试将这些合并到我的应用程序中，所以我发现自己`ContentProvider`一直在实现 s。`ContentResolver`还提供了一种在进行更改时向底层数据源提供全局通知的简单方法。例如，将在其上`CursorLoader`注册一个，导致当您调用给定的 时收到通知。如果您要直接从您的网站加载数据，那么设置它需要更多的工作。`ContentObserver``Cursor``Cursor``ContentResolver#notifyChange(Uri uri, ContentObserver observer)``Uri``SQLiteDatabase`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:05:26.290

两个选项都和另一个一样好。这是一个偏好问题。

就我个人而言，我认为将内容提供程序用于不会与其他应用程序共享任何内容的应用程序烦人且背后有痛苦，但我在一次采访中听到了一个有效的建议（它来自那些大启动类型的应用程序，例如 Pocket 或 Flipboard）说：“即使一开始可能听起来很复杂，也可以按照 Android 的方式编写代码，因为这将在未来节省时间/精力”我认为建议关注事实使用推荐的方式，获得支持，修复错误并且更容易更快地扩展。

# perl - 如何在 Dancer 模板中制作特定于页面的标题？

> ID：11970625
> 
> 赞同：2
> 
> 时间：2012-08-15T13:58:21.377
> 
> 标签：perl, template-toolkit, dancer

我有一个标准的 Perl Dancer 应用程序，使用 Template::Toolkit 作为渲染引擎，有两条路线：

```
get '/' => sub {
    template 'index';
};

get '/foo' => sub {
    template 'foo';
}; 
```

我的`views/templates/main.tt`包含以下行：

```
<title><%= title %></title> 
```

我希望标题 var 的值是“/”页面上的“我的网站”，以及“/foo”页面上的“Foo - 我的网站”。

我知道我可以将这些值放在控制器文件中，如下所示：

```
 template 'index', { title => 'My Site' }; 
```

但我想在相应的模板文件中指定它们，`views/index.tt`并且`views/foo.tt`.

我怎样才能做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T02:37:34.693

本[文档](https://metacpan.org/module/Dancer%3a%3aCookbook#TTs-WRAPPER-directive-in-Dancer-META-variables-SETs-)清楚地解释了如何配置您的应用程序以在您的布局中提供模板中定义的变量。

对于标题标签，您可以省去使用变量在每个模板中定义标题的工作`template.name`。也许是这样的：

```
<title>
  <% template.name.match('(\w+).tt').0.ucfirst %> - <% settings.sitename %>
</title> 
```

# c++ - 无法获取派生类成员的值

> ID：11970626
> 
> 赞同：1
> 
> 时间：2012-08-15T13:58:22.770
> 
> 标签：c++, inheritance, interface

我有：

```
VirtualClass : public QObject
{
public:
    int m_number;
}

DerivedClass : public VirtualClass 
{
public:
    DerivedClass(int number) : m_number(number) {};
    int m_number;
    // some content goes here..
} 
```

客户端代码：

```
f(VirtualClass* instance)
{
std::cout << instance->m_number;
}

DerivedClass der(100); 
```

我想`f(der)`返回**与 DerivedClass 相关的 m_number**，但 *我得到了 VirtualClass* 的 m_number。我做错了什么？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T13:59:37.693

从. `int m_number;`_ `DerivedClass`否则你必须有不同的`m_number`成员。一个来自`VirtualClass`，另一个来自`DerivedClass`。

当你添加你隐藏`int m_number;`的`DerivedClass``m_number;``VirtualClass`

这是一个示例，它是如何工作的：

```
struct Foo
{
    int a;
};

struct Bar : Foo
{
    int a; //another a
};

int main()
{
    Bar *f = new Bar();
    f->a = 10; //Bar::a

    Foo *b = f;
    b->a = 20; //Foo::a

    cout << f->a << endl; //prints 10
    cout << b->a << endl; //prints 20
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:01:20.997

你已经宣布`int m_number;`了两次。你应该只声明一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T14:46:16.683

spin_eight：你可以保留你的初始化列表，如果你想通过在 VirtualClass 上提供一个适当的构造函数，并从派生的初始化列表中调用它，像这样：

```
VirtualClass : public QObject 
{ 
 public: 
 VirtualClass(int number) : m_number(number) { }
 int m_number; 
}

DerivedClass : public VirtualClass
{
 public: 
 DerivedClass(int number) : VirtualClass(number) {}; 
 // some content goes here.. 
} 
```

# c# - 如何在调试模式下浏览所有会话变量？

> ID：11970628
> 
> 赞同：8
> 
> 时间：2012-08-15T13:58:32.140
> 
> 标签：c#, visual-studio-2010, debugging, session-variables, code-behind

我正在使用 Microsoft Visual Studio 2010 Professional 并开发一个 asp.net / C# 应用程序。在调试模式下，我可以在“Locals”选项卡下看到局部变量，还有一个叫做“this”的东西可以扩展成多个树结构。但是，我无法在任何地方找到我的会话变量名称/值对。

一位朋友建议我使用“即时窗口”选项卡并输入我的 Session 变量的名称（即，Session["SomeValue"] 并按 Enter。这确实给了我 Session 变量的值。这对于单个会话变量，但在处理多个变量时它变得有点麻烦。

无论如何，我可以浏览到存储所有会话变量的键/值对的部分，就像我可以为局部变量一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:13:55.440

也许您可以尝试使用 Watch Windows。类型

```
httpContext.Session["your session variable name"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T14:23:37.893

可能有一种更优雅的方式，但如果我记得你可以在启用跟踪时转储会话名称/值对。

*   启用跟踪
*   执行一个页面
*   跟踪信息要么附加到底部，要么在`~/Trace.axd`

**在 web.config**

```
<configuration>
  <system.web>
    <trace enabled="true" requestLimit="40" pageOutput="true|false" />
  </system.web>
</configuration> 
```

[http://msdn.microsoft.com/en-us/library/bb386420.aspx](http://msdn.microsoft.com/en-us/library/bb386420.aspx)

当然，这仅在对象有有意义的字符串表示时才有用。

您还可以考虑编写一个自定义可视化器（我相信这是正确的术语），它可以让您使用自己的自定义功能检查类型。我已经看到这样做是为了检查动态方法，它非常有用，尽管我认为编写一个方法会很费力。

*   [如何创建 Visual-Studio 字符串可视化工具？](https://stackoverflow.com/questions/1294230/how-to-create-a-visual-studio-string-visualizer)
*   [http://msdn.microsoft.com/en-us/library/e2zc529c.aspx](http://msdn.microsoft.com/en-us/library/e2zc529c.aspx)

# sql-server - SQL Server 和 ORACLE 中的 STUFF 函数

> ID：11970632
> 
> 赞同：2
> 
> 时间：2012-08-15T13:58:46.787
> 
> 标签：sql-server, oracle8i

对于这个话题，我有两个`STUFF`问题。

第一个问题是`STUFF`SQL Server 中的函数。第二个问题是关于`STUFF`Oracle (8i) 中的功能。

问题 1：如何`,`从我想要填充的列中删除？

示例，给定表格：

```
ID      Country     Payment     Product
12345       USA     Cash        Red wine
12345       USA     Cash    
12345       USA     Cash 
```

使用此脚本，它会产生：

```
select distinct Country, Payment,
stuff(isnull((select ', ' + x.Product from #temp x where x.ID = t.ID
group by x.Product for xml path ('')), ''), 1, 2, '') as Product

ID      Country     Payment     Product
12345   USA         Cash       , Red wine 
```

如何删除结果以`Red wine`仅显示（删除逗号（，）？

请注意：我没有写这个`STUFF`函数。它是由一个叫 OMG Ponies 的人写的。

问题 2：与问题 1 相同，但语法在 Oracle 中：

```
select distinct ID, Country, Payment, WM_CONCAT(Product) AS Products
from
(
select distinct ID, Country, Payment, Product
from temp table
)x
group by ID, Country, Payment 
```

我希望我的结果`Red wine`只显示（删除逗号（，）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:43:32.893

**问题 1：** 就答案的 SQL Server 部分而言，您的 Product 字段中似乎有空字符串 - 如果没有空字符串，它们就不是空值。因此，您可以使用以下内容。我将该行添加`and (product != '' and product is not null)`到您的`Stuff()`部分，它将删除多余的逗号：

```
select distinct Country, Payment,
    stuff(isnull((select ', ' + x.Product 
                    from test x 
                    where x.ID = t.ID 
                      and (product != '' and product is not null)
                    group by x.Product for xml path ('')), ''), 1, 2, '') as Product
from test t 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/af2df/2)

**问题 2：**我无法访问 Oracle 8i 版本，但我猜如果您排除带有空字符串的值，逗号将消失。

# c# - 实体框架保存循环中的第一项，但没有其他

> ID：11970636
> 
> 赞同：2
> 
> 时间：2012-08-15T13:58:55.600
> 
> 标签：c#, asp.net, asp.net-mvc, entity-framework

在我的控制器中，我正在遍历项目并将它们保存到我的数据库中。问题是它保存了第一个项目，但没有保存其他项目。我在循环中的“SaveItem()”行上放了一个断点，它每次都会命中它，但对我来说奇怪的是它只通过第一项的方法。

我究竟做错了什么？

```
public void SubmitItem(Cart cart, ShippingDetails shippingDetails, ProcessedItems processedItem, string orderID)
{
    var cartItems = cart.Lines;
    //CartIndexViewModel cartIndex = new CartIndexViewModel();
    //var customID = cartIndex.OrderID;

    foreach(var item in cartItems)
    {
        processedItem.OrderID = orderID;
        processedItem.ProductID = item.Product.ProductID;
        processedItem.Name = item.Product.Name;
        processedItem.Description = item.Product.Description;
        processedItem.Price = item.Product.Price;
        processedItem.Category = item.Product.Category;
        processedItem.ImageName = item.Product.ImageName;
        processedItem.Image2Name = item.Product.Image2Name;
        processedItem.Image3Name = item.Product.Image3Name;

        processedItem.BuyerName = shippingDetails.Name;
        processedItem.Line1 = shippingDetails.Line1;
        processedItem.Line2 = shippingDetails.Line2;
        processedItem.Line3 = shippingDetails.Line3;
        processedItem.City = shippingDetails.City;
        processedItem.State = shippingDetails.State;
        processedItem.Zip = shippingDetails.Zip;
        processedItem.Country = shippingDetails.Country;

        processedItem.Status = "Submitted";

        processedItems.SaveItem(processedItem);

    } 

}

    public class EFProcessedItemsRepository : IProcessedItems
{
    private  EFDbContext context = new EFDbContext();

    public IQueryable<ProcessedItems> ProcessedItem
    {
        get { return context.ProcessedItems; }
    }

    public void SaveItem(ProcessedItems processedItem)
    {
        if(processedItem.ProcessedID == 0)
        {
            try
            {
                context.ProcessedItems.Add(processedItem);

                context.SaveChanges();
            }
            catch (Exception)
            {

                throw;
            }

        }
        else
        {
            context.Entry(processedItem).State = EntityState.Modified;

        }
    }

    public void DeleteItem(ProcessedItems processedItem)
    {
        context.ProcessedItems.Remove(processedItem);
        context.SaveChanges();
    }
} 
```

这是已处理项目的类：

```
public class ProcessedItems
{
    [Key]
    public int ProcessedID { get; set; }

    public string OrderID { get; set; }
    public int ProductID { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public decimal Price { get; set; }
    public string Category { get; set; }
    public string ImageName { get; set; }
    public string Image2Name { get; set; }
    public string Image3Name { get; set; }
    public string Status { get; set; }

    //shipping
    public string BuyerName { get; set; }
    public string Line1 { get; set; }
    public string Line2 { get; set; }
    public string Line3 { get; set; }
    public string City { get; set; }
    public string State { get; set; }
    public string Zip { get; set; }
    public string Country { get; set; }

} 
```

界面：

```
public interface IProcessedItems
{
    IQueryable<ProcessedItems> ProcessedItem { get; }
    void SaveItem(ProcessedItems processedItem);
    void DeleteItem(ProcessedItems processedItem);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:10:37.870

添加所有项目后尝试调用`context.SaveChanges(`），我认为它应该一次性将它们全部保留。

另一件事要尝试：

重构您的代码，以便 SaveItem 只接受一项要保存、添加并调用 SaveChanges()

循环遍历方法外部的购物车项目，并使用一个项目调用该方法以一次保存。

```
// set orderID, shippingDetails above

foreach(var item in cartItems)
{
    ProcessedItems processedItem = new ProcessedItems();
    processedItem.OrderID = orderID;
    processedItem.ProductID = item.Product.ProductID;
    processedItem.Name = item.Product.Name;
    processedItem.Description = item.Product.Description;
    processedItem.Price = item.Product.Price;
    processedItem.Category = item.Product.Category;
    processedItem.ImageName = item.Product.ImageName;
    processedItem.Image2Name = item.Product.Image2Name;
    processedItem.Image3Name = item.Product.Image3Name;

    processedItem.BuyerName = shippingDetails.Name;
    processedItem.Line1 = shippingDetails.Line1;
    processedItem.Line2 = shippingDetails.Line2;
    processedItem.Line3 = shippingDetails.Line3;
    processedItem.City = shippingDetails.City;
    processedItem.State = shippingDetails.State;
    processedItem.Zip = shippingDetails.Zip;
    processedItem.Country = shippingDetails.Country;
    SubmitItem(processedItem);

}

public void SubmitItem(ProcessedItems processedItem)
{
    processedItem.Status = "Submitted";
    processedItems.SaveItem(processedItem);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:09:02.053

我认为这是因为 processesItem 是每个循环迭代的相同实例。因此，在它通过 SaveItem 一次后，它的 ProcessedID 已设置，因此不会再次被处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:07:21.447

我的第一个猜测是你总是存储一个实体，它存储在 processesItem 中，它是一个输入参数。尝试在每个循环上创建新实体，然后保存它。换句话说，您将值分配给输入参数

```
processedItem.OrderID = orderID; 
```

然后每次都存储相同的实体，但字段已更改

```
processedItems.SaveItem(processedItem); 
```

# c++ - 调用 fortran 函数会使程序挂起

> ID：11970641
> 
> 赞同：0
> 
> 时间：2012-08-15T13:59:14.500
> 
> 标签：c++, fortran

我正在尝试从 C++ 中的静态 Fortran 库中调用函数。

根据问题的大小，我的程序开始挂起对 Fortran 库函数的初始调用。我无法理解这个问题的原因......

举个例子，如果问题大小是 133k，程序启动不挂，正常结束。但是，如果我将问题大小增加到 365k 或更多，这些大问题会导致程序在第一次函数调用中挂起。intel 和 gnu 编译器都会导致相同的行为。

这种挂起的原因可能是什么？

编辑：操作系统：Linux，我检查的是我的 shell 的堆栈大小，特定于库的环境变量，顺便说一句，库是 Watson 稀疏矩阵包，一个稀疏线性求解器，问题大小是矩阵的大小作为求解器输入的运算符。我不能发布任何代码，因为有很多依赖项，它会使过程更加复杂。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:02:33.640

你的机器有多少内存？换多少？

如果大量使用交换，您最终可能会花费大量时间来读写交换，这将使调用变得*非常*缓慢。

如果 Fortran 库中使用的算法具有更高的复杂性，那么您很可能会通过更多输入获得（更多）更长的调用时间。

# python - Amazon Elastic MapReduce - SIGTERM

> ID：11970646
> 
> 赞同：6
> 
> 时间：2012-08-15T13:59:33.400
> 
> 标签：python, hadoop-streaming, elastic-map-reduce, amazon-emr

我有一个 EMR 流作业 (Python)，它通常工作正常（例如 10 台机器处理 200 个输入）。但是，当我针对大型数据集（12 台机器处理总共 6000 个输入，每个输入大约 20 秒）运行它时，经过 2.5 小时的运算后，我收到以下错误：

```
java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 143
at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:372)
at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:586)
at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:135)
at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:57)
at org.apache.hadoop.streaming.PipeMapRunner.run(PipeMapRunner.java:36)
at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:441)
at org.apache.hadoop.mapred.MapTask.run(MapTask.java:377)
at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
at java.security.AccessController.doPrivileged(Native Method)
at javax.security.auth.Subject.doAs(Subject.java:396)
at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1132)
at org.apache.hadoop.mapred.Child.main(Child.java:249) 
```

如果我没看错，则子进程失败并显示代码 143，因为有人向流式作业发送了 SIGTERM 信号。

我的理解正确吗？如果是这样：EMR 基础设施何时会发送 SIGTERM？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-22T11:21:26.687

我弄清楚发生了什么，所以如果其他人遇到类似问题，这里有一些信息。

我的关键是查看“jobtracker”日志。这些位于 S3 上任务的日志/文件夹中，位于：

```
<logs folder>/daemons/<id of node running jobtracker>/hadoop-hadoop-jobtracker-XXX.log. 
```

有以下类型的多行：

```
2012-08-21 08:07:13,830 INFO org.apache.hadoop.mapred.TaskInProgress 
  (IPC Server handler 29 on 9001): Error from attempt_201208210612_0001_m_000015_0: 
  Task attempt_201208210612_0001_m_000015_0 failed to report status 
  for 601 seconds. Killing! 
```

所以我的代码超时了，它被杀死了（它超过了 10 分钟的任务超时）。10 分钟我没有进行任何 I/O，这当然是意料之外的（我通常会每 20 秒进行一次 I/O）。

然后我发现了这篇文章：

[http://devblog.factual.com/practical-hadoop-streaming-dealing-with-brittle-code](http://devblog.factual.com/practical-hadoop-streaming-dealing-with-brittle-code)

“在我们的一个科学项目中，我们有一些 Hadoop Streaming 作业在 ruby​​ 上运行并依赖 libxml 来解析文档。这造成了一场完美的糟糕风暴——网络上充满了非常糟糕的 html，而 libxml 偶尔会陷入无限循环或彻底的段错误。在某些文件上，它总是段错误。

它钉了它。我一定遇到了这些“libxml 进入无限循环”的情况之一（我大量使用 libxml —— 仅使用 Python，而不是 Ruby）。

对我来说最后一步是触发跳过模式（此处的说明：[使用 boto 设置 hadoop 参数？](https://stackoverflow.com/questions/12071436/setting-hadoop-parameters-with-boto)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-06T20:48:58.967

我遇到了来自 Amazon EMR 的输出（“子进程失败，代码 143”）。我的流式作业是使用 PHP curl 将数据发送到没有 MapReduce 作业服务器属于其安全组的服务器。因此减速器超时并被杀死。理想情况下，我想将我的工作添加到同一个安全组，但我选择在我的 API 前面简单地添加一个 URL 安全令牌参数。

# asp.net - DropDownList - 列表中的第一个项目未正确回发，但所有其他项目都有效

> ID：11970650
> 
> 赞同：3
> 
> 时间：2012-08-15T13:59:34.340
> 
> 标签：asp.net, drop-down-menu

我有这个下拉列表：

```
<asp:DropDownList id="ddlSort" runat="server" EnableViewState="true" OnSelectedIndexChanged="ApplyFilters" AutoPostBack="True">
   <asp:ListItem Value="0">Sort By Relevancy</asp:listitem>
   <asp:ListItem Value="1">Sort By Product Code</asp:listitem>
   <asp:ListItem Value="2">Sort By Product Description</asp:listitem>
   <asp:ListItem Value="3">Sort By Price - Lowest</asp:listitem>
   <asp:ListItem Value="4">Sort By Price - Highest</asp:listitem>
</asp:dropdownlist> 
```

我正在将选项设置为在`if (!Page.IsPostBack)`默认为“0”的 Page_Load 中初始选择。如果我选择`Sort By Product Code`（或任何其他选项），它将`ApplyFilters`毫无问题地调用。如果我随后将 Drop Down 更改为第一个选项，则会触发 AutoPostBack 但它不会进入`ApplyFilters`代码。

如果我将标记更改为：

```
<asp:DropDownList id="ddlSort" runat="server" EnableViewState="true" OnSelectedIndexChanged="ApplyFilters" AutoPostBack="True">
   <asp:ListItem Value="-1">First Option</asp:listitem>
   <asp:ListItem Value="0">Sort By Relevancy</asp:listitem>
   <asp:ListItem Value="1">Sort By Product Code</asp:listitem>
   <asp:ListItem Value="2">Sort By Product Description</asp:listitem>
   <asp:ListItem Value="3">Sort By Price - Lowest</asp:listitem>
   <asp:ListItem Value="4">Sort By Price - Highest</asp:listitem>
</asp:dropdownlist> 
```

然后在选择任何其他选项后选择按相关性排序将正常工作，但选择第一个选项不会（如第一个示例中所示）。

我正在使用 ASP.NET 2.0。

1.  我检查了控件层次结构并为所有控件启用了视图状态。
2.  我已经尝试明确设置 EnableViewState="true" 没有任何成功。

有没有人有任何想法，因为我在这方面看到的所有信息都表明视图状态是错误的并且在更新面板中 - 在我的情况下，这两者都不是真的。

编辑：我现在已经将一个虚拟条目作为第一个条目，但这并不理想。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:07:21.327

这是预期的行为。

您的事件是`OnSelectedIndexChanged`，如果打开下拉列表并选择已选择的选项，asp.net 不会将其检测为更改。

只有当您选择不同的值时，才会`OnSelectedIndexChanged`触发。

我建议设置一个默认值，就像在你的第二个示例中一样，更具可读性：

```
<asp:DropDownList id="ddlSort" runat="server" EnableViewState="true" OnSelectedIndexChanged="ApplyFilters" AutoPostBack="True">
   <asp:ListItem Value="-1">Select Sort order</asp:listitem>
   <asp:ListItem Value="0">Sort By Relevancy</asp:listitem>
   <asp:ListItem Value="1">Sort By Product Code</asp:listitem>
   <asp:ListItem Value="2">Sort By Product Description</asp:listitem>
   <asp:ListItem Value="3">Sort By Price - Lowest</asp:listitem>
   <asp:ListItem Value="4">Sort By Price - Highest</asp:listitem>
</asp:dropdownlist> 
```

如果您有默认排序顺序，则可以在页面加载时设置它

```
if (!Page.IsPostBack)
{
   ddlSort.Text = 0;
} 
```

# python - 使用聚类绘制直方图

> ID：11970654
> 
> 赞同：1
> 
> 时间：2012-08-15T13:59:42.093
> 
> 标签：python, cluster-analysis, histogram, frequency

我试图研究这个问题，但失败了。我是python的初学者，所以请耐心等待。

我有一个文本文件，每行都包含数字（它们是以度为单位的角度）。我想首先将角度聚类为 20 的聚类大小。然后我想将其绘制在直方图上。我有以下代码：

```
angle = open(output_dir+'/chi_angle.txt', 'r').read().splitlines()
array = numpy.array(map(float, angle))
hello = list(array)
from cluster import *
cl = HierarchicalClustering(hello, lambda x,y: abs(x-y))
clusters = cl.getlevel(20)
frequency = [len(x) for x in clusters]
average = [1.0*sum(x)/len(x) for x in clusters] 
```

现在。我的问题是：如何绘制直方图？

执行以下操作：

```
pylab.hist(average, bins=50)
pylab.xlabel('Chi 1 Angle [degrees]')
pylab.ylabel('#')
pylab.show() 
```

将显示带有正确放置条形的直方图（即每个簇的平均值），但它不会显示每个簇包含多少“角度”。

只是为了澄清。聚类数据如下所示：

```
clusters = [[-60.26, -30.26, -45.24], [163.24, 173.24], [133.2, 123.23, 121.23]] 
```

我想要每个集群的平均值，以及每个集群中的角度数。因此，在直方图上，第一个条形图将位于 -50 左右，高度为 3。我如何绘制这个？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:50:54.357

不确定我是否理解你的问题。无论如何尝试将您的直方图保存在这个数组中

```
 H=hist(average, bins=50) 
```

如果你想绘制它然后做

```
 plot(H[1][1:],H[0]) 
```

`H[1]`是一个数组，用于存储 bin 中心和`H[0]`每个 bin 中的计数。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:21:36.000

为什么不立即使用直方图？

聚类中心的直方图不是您数据的非常合理的表示。

# apache - 仅重写 url 中的一个参数

> ID：11970655
> 
> 赞同：1
> 
> 时间：2012-08-15T13:59:46.633
> 
> 标签：apache, .htaccess, mod-rewrite

我该如何重写：

`http://mystagingsite.com/website/?page_id=7&id=63&r_id=1-502ba82b9e926&event_id=1&attendee_action=post_payment&form_action=payment&type=paypal`

进入

`http://mystagingsite.com/website/?page_id=102&id=63&r_id=1-502ba82b9e926&event_id=1&attendee_action=post_payment&form_action=payment&type=paypal`

所以page_id参数需要改变......我需要将访问第一个url的用户发送到第二个url。我需要更改的只是 id 参数......所有其他参数都需要保留。

我正在尝试这个：

```
RewriteRule http://mystagingsite.com/website/?page_id=7 http://mystagingsite.com/website/?page_id=102  [QSA] 
```

但它似乎没有工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:31:22.730

您无法匹配重写规则中的查询字符串（之后的所有内容**`?`**）或协议/主机（the `http://mystagingsite.com`），您必须匹配重写条件中的`%{QUERY_STRING}`and`%{HTTP_HOST}`变量：

```
RewriteCond %{HTTP_HOST} mystagingsite.com [NC]
RewriteCond %{QUERY_STRING} ^(.*)page_id=7&(.*)$
RewriteRule ^website/$ /website/?%1page_id=102&%2 [L] 
```

虽然有点混乱。在您的问题中，您说要`page_id=7`重写为`page_id=102`，但在您的示例中，您已`63`重写为`102`。

# git - Cygwin：git的颜色编码和分支信息？

> ID：11970658
> 
> 赞同：18
> 
> 时间：2012-08-15T13:59:51.530
> 
> 标签：git, bash, cygwin, git-bash

似乎有问题，因为我最近将 gitbash 的客户端更改为 cygwin，但是当我执行 git status 时我缺少颜色编码，而且 bash 提示不包括当前分支/变基等

有谁知道如何让 cygwin 看起来像 gitbash？你可能想知道为什么我改变了，我想要更多可用的命令 :-)

surley 这必须支持

有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-08-15T14:18:23.620

听起来您只需要[`.gitconfig`](http://www.kernel.org/pub/software/scm/git/docs/git-config.html)为您的 cygwin shell 设置即可启用彩色输出。这是我的`~/.gitconfig`文件中的内容（在输出中我得到了彩色标记）：

```
[color]
        diff = auto
        status = auto
        branch = auto
        interactive = auto
        ui = true
        pager = true 
```

我认为这里最重要的一行是`ui = true`，如果您愿意，可以直接从命令行打开它：

```
git config --global color.ui true 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-27T17:15:25.283

@lee-netherton 的回答是正确的。

对于那些使用 Windows Git-1.8.1.2-preview20130201 的人 - 我必须创建一个 ~/.bashrc 来启用 git status 的颜色输出。

`[~/.bashrc]`

```
TERM=cygwin
export TERM 
```

# multithreading - .NET 任务：如何创建可以同步或异步执行的任务集合？

> ID：11970659
> 
> 赞同：0
> 
> 时间：2012-08-15T13:59:50.593
> 
> 标签：multithreading, .net-4.0, task

在我的应用程序中，我向 List(Of Task) 添加了一堆操作，如下所示：

```
Dim Tasks As New List(Of Task)

Tasks.Add(Task.Factory.StartNew(Sub()
                                    System.Threading.Thread.Sleep(3000)
                                End Sub))

Tasks.Add(Task.Factory.StartNew(Sub()
                                    System.Threading.Thread.Sleep(3000)
                                End Sub))

Task.WaitAll(Tasks.ToArray()) 
```

当我调用时`Task.WaitAll(Tasks.ToArray())`，它会按预期同时执行所有任务。但是，调试/单步执行线程方法有点困难，所以我希望能够同步执行所有这些（我会在我的配置文件中创建一个 AppSetting 来确定是否同步或异步运行任务）。但是，调用`.RunSynchronously()`使用创建的任务会`.StartNew()`引发异常。

我应该如何构建这个任务列表，以便在同步和异步执行之间切换？

**编辑：** 从概念上讲，这是我想做的：

```
If ConfigurationManager.AppSettings("ExecuteAsynchronously") = "1" Then
    Task.WaitAll(Tasks.ToArray())
Else
    Task.WaitAllAsynchronously(Tasks.ToArray())
End If 
```

我知道这`.WaitAllAsynchronously()`不存在，但你仍然可以看到我想要实现的最终结果。如果我必须创建一个名为`.WaitAllAsynchronously()`迭代每个任务并同步执行它的扩展方法，那么这就是我要做的。

由于`.StartNew()`不支持同步执行，我需要构建我的任务列表而不实际启动它们，但是以一种同时支持同步和异步执行的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:06:58.070

您可以使用`Parallel.Invoke`并将其设置为使用单个线程。

```
Dim po AS new ParallelOptions()
po.MaxDegreeOfParallelism = 1

Parallel.Invoke(po,
                Sub()
                   System.Threading.Thread.Sleep(3000)
                End Sub,
                Sub()
                   System.Threading.Thread.Sleep(3000)
                End Sub
                ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:47:02.073

我想出了一种使用 Tasks 做我想做的事情的方法。我打算删除我的问题，但我觉得其他人可能会从中受益，所以这就是我所做的：

```
Dim ExecuteSynchonously As Boolean = True

Dim Tasks As New List(Of Task)

Tasks.Add(New Task(Sub()
                       System.Threading.Thread.Sleep(3000)
                   End Sub))

Tasks.Add(New Task(Sub()
                       System.Threading.Thread.Sleep(3000)
                   End Sub))

'will create helper extension methods for these
If ExecuteSynchonously Then
    Tasks.ForEach(Sub(t)
                      t.RunSynchronously()
                  End Sub)
Else
    Tasks.ForEach(Sub(t)
                      t.Start()
                  End Sub)
    Task.WaitAll(Tasks.ToArray)
End If 
```

首先，我通过将未启动的任务添加到集合中来构建集合（而不是`.StartNew()`）。你可以关注其余的。我最终会为这些创建辅助方法，但这至少显示了我使用的核心代码。

如果有人看到更有效的方法来做到这一点，请告诉我。

# c#-4.0 - IP 摄像机 401 未经授权的错误

> ID：11970664
> 
> 赞同：1
> 
> 时间：2012-08-15T14:00:12.480
> 
> 标签：c#-4.0

在将 IP 摄像机与 C# 应用程序连接时，我在 Aforge/Samples/Player 中找到了简单的播放器。它只需要修改 ip 字符串，所以我添加了我的*admin:admin@192.168.1.239:81/videostream.cgi?rate=11*来获取 MJPEG 视频流。编译时出现错误，因为远程服务器返回错误 (401) 未经授权。Andre Kirillow 在 MJPEGstream.cs 文件中提到一些相机会产生 HTTP 标头，它不严格符合标准，导致 .NET 异常。为了避免这种异常，应该设置 httpWebRequest 的 useUnsafeHeaderParsing 配置选项，可以使用应用程序配置文件**来****完成**。

 **```
<configuration>
    <system.net>
        <settings>
            <httpWebRequest useUnsafeHeaderParsing="true" />
        </settings>
    </system.net>
</configuration> 
```

[好吧，正如Dinis Cruz](http://o2platform.wordpress.com/2010/10/20/dealing-with-the-server-committed-a-protocol-violation-sectionresponsestatusline/)所建议的，有两种方法可以做到这一点。我使用上面的代码添加了 .config 文件，并且还以编程方式进行了操作，但同样的错误仍然存​​在。Player程序编码是

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Diagnostics;

using AForge.Video;
using AForge.Video.DirectShow;

using System.Reflection;
using System.Net.Configuration;
using System.Net;

namespace Player
{
  public partial class MainForm : Form
   {
    private Stopwatch stopWatch = null;

    // Class constructor
    public MainForm( ) 
    {
        InitializeComponent( );
    }

    private void MainForm_FormClosing( object sender, FormClosingEventArgs e )
    {
        CloseCurrentVideoSource( );
    }

    // "Exit" menu item clicked
    private void exitToolStripMenuItem_Click( object sender, EventArgs e )
    {
        this.Close( );
    }

    // Open local video capture device
    private void localVideoCaptureDeviceToolStripMenuItem_Click( object sender, EventArgs e )
    {
        VideoCaptureDeviceForm form = new VideoCaptureDeviceForm( );

        if ( form.ShowDialog( this ) == DialogResult.OK )
        {
            // create video source
            VideoCaptureDevice videoSource = form.VideoDevice;

            // open it
            OpenVideoSource( videoSource );
        }
    }

    // Open video file using DirectShow
    private void openVideofileusingDirectShowToolStripMenuItem_Click( object sender, EventArgs e )
    {
        if ( openFileDialog.ShowDialog( ) == DialogResult.OK )
        {
            // create video source
            FileVideoSource fileSource = new FileVideoSource( openFileDialog.FileName );

            // open it
            OpenVideoSource( fileSource );
        }
    }

    // Open JPEG URL
    private void openJPEGURLToolStripMenuItem_Click( object sender, EventArgs e )
    {
        URLForm form = new URLForm( );

        form.Description = "Enter URL of an updating JPEG from a web camera:";
        form.URLs = new string[]
            {
                "http://195.243.185.195/axis-cgi/jpg/image.cgi?camera=1",
            };

        if ( form.ShowDialog( this ) == DialogResult.OK )
        {
            // create video source
            JPEGStream jpegSource = new JPEGStream( form.URL );

            // open it
            OpenVideoSource( jpegSource );
        }
    }

    // Open MJPEG URL
    private void openMJPEGURLToolStripMenuItem_Click( object sender, EventArgs e )
    {
        URLForm form = new URLForm( );

        form.Description = "Enter URL of an MJPEG video stream:";
        form.URLs = new string[]
            {
                "http://admin@192.168.1.239:81/videostream.cgi?rate=11",
                "mjpegSource by mobby"
            };

        if ( form.ShowDialog( this ) == DialogResult.OK )
        {
            // create video source
            MJPEGStream mjpegSource = new MJPEGStream( form.URL );

            // open it
            OpenVideoSource( mjpegSource );
        }
    }

    // Open video source
    private void OpenVideoSource( IVideoSource source )
    {
        // set busy cursor
        this.Cursor = Cursors.WaitCursor;

        // stop current video source
        //CloseCurrentVideoSource( );

        // start new video source
        videoSourcePlayer.VideoSource = source;
        videoSourcePlayer.Start( );

        // reset stop watch
        stopWatch = null;

        // start timer
        timer.Start( );

        this.Cursor = Cursors.Default;
    }

    // Close video source if it is running
    private void CloseCurrentVideoSource( )
    {
        if ( videoSourcePlayer.VideoSource != null )
        {
            videoSourcePlayer.SignalToStop( );

            // wait ~ 3 seconds
            for ( int i = 0; i < 30; i++ )
            {
                if ( !videoSourcePlayer.IsRunning )
                    break;
                System.Threading.Thread.Sleep( 100 );
            }

            if ( videoSourcePlayer.IsRunning )
            {
                videoSourcePlayer.Stop( );
            }

            videoSourcePlayer.VideoSource = null;
        }
    }

    // New frame received by the player
    private void videoSourcePlayer_NewFrame( object sender, ref Bitmap image )
    {
        DateTime now = DateTime.Now;
        Graphics g = Graphics.FromImage( image );

        // paint current time
        SolidBrush brush = new SolidBrush( Color.Red );
        g.DrawString( now.ToString( ), this.Font, brush, new PointF( 5, 5 ) );
        brush.Dispose( );

        g.Dispose( );
    }

    // On timer event - gather statistics
    private void timer_Tick( object sender, EventArgs e )
    {
        IVideoSource videoSource = videoSourcePlayer.VideoSource;

        if ( videoSource != null )
        {
            // get number of frames since the last timer tick
            int framesReceived = videoSource.FramesReceived;

            if ( stopWatch == null )
            {
                stopWatch = new Stopwatch( );
                stopWatch.Start( );
            }
            else
            {
                stopWatch.Stop( );

                float fps = 1000.0f * framesReceived / stopWatch.ElapsedMilliseconds;
                fpsLabel.Text = fps.ToString( "F2" ) + " fps";

                stopWatch.Reset( );
                stopWatch.Start( );
            }
        }
    }

    public static bool SetAllowUnsafeHeaderParsing20()
    {
        //Get the assembly that contains the internal class
        Assembly aNetAssembly = Assembly.GetAssembly(typeof(System.Net.Configuration.SettingsSection));
        if (aNetAssembly != null)
        {
            //Use the assembly in order to get the internal type for the internal class
            Type aSettingsType = aNetAssembly.GetType("System.Net.Configuration.SettingsSectionInternal");
            if (aSettingsType != null)
            {
                //Use the internal static property to get an instance of the internal settings class.
                //If the static instance isn't created allready the property will create it for us.
                object anInstance = aSettingsType.InvokeMember("Section",
                BindingFlags.Static | BindingFlags.GetProperty | BindingFlags.NonPublic, null, null, new object[] { });
                if (anInstance != null)
                {
                    //Locate the private bool field that tells the framework is unsafe header parsing should be allowed or not
                    FieldInfo aUseUnsafeHeaderParsing = aSettingsType.GetField("useUnsafeHeaderParsing", BindingFlags.NonPublic | BindingFlags.Instance);
                    if (aUseUnsafeHeaderParsing != null)
                    {
                        aUseUnsafeHeaderParsing.SetValue(anInstance, true);
                        return true;
                    }
                }
            }
        }
        return false;
    }
  }
} 
```

从谷歌我添加了一些开放的 ip 摄像头，那里的视频流被捕获并且工作正常，但我的摄像头返回错误 401。然后我使用了[Sean Tearney](http://www.ispyconnect.com/)最近制作的 ISPY 软件，该软件使用相同的 Aforge 库构建，它捕获了我的摄像头的视频流：页。现在我不知道简单播放器的编码有什么问题。**如果有人可以帮助我从相机获取视频流，请多多关照。谢谢**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T03:01:46.823

很可能是因为相机受密码保护。为了让您能够查看视频流，请提供您尝试访问的摄像机的用户名和密码。对于 jpeg 流：

```
jpegSource.Login = "your username";
jpegSource.Password = "your password"; 
```

对于 mjpeg 流：

```
mjpegSource.Login = "your username"; 
mjpegSource.Password = "your password"; 
```**

# c++ - Visual C++ 2010 中的可变参数宏

> ID：11970671
> 
> 赞同：1
> 
> 时间：2012-08-15T14:00:48.427
> 
> 标签：c++, visual-c++, c-preprocessor

我见过这个问题，但我需要知道一些非常具体的东西。

我正在使用 Visual Studio 2010。

为什么 C 预处理器在此处删除**__VA_ARGS__**之前的尾随逗号：

```
#define PRINTME(...) printf("hello", __VA_ARGS__); 
```

但不是在这里：

```
#define FINISH_IND(COUNT, ...) FINISH_X(,__VA_ARGS__, 1,2) 
```

我这辈子都想不通。

# iphone - 这两个会产生相同的编译时间吗？

> ID：11970673
> 
> 赞同：2
> 
> 时间：2012-08-15T14:00:56.440
> 
> 标签：iphone, objective-c, class

我知道@class 是为了加快编译时间，但如果我遇到这样的情况：

```
#import <Foundation/Foundation.h>
@class BNRItem;
@interface BNRItemStore : NSObject
@end 
```

* * *

```
#import "BNRItemStore.h"
#import "BNRItem.h"

@implementation BNRItemStore
@end 
```

我可以这样做并且仍然获得相同的编译时间：

```
#import <Foundation/Foundation.h>
#import "BNRItem.h"
@interface BNRItemStore : NSObject
@end 
```

* * *

```
#import "BNRItemStore.h"

@implementation BNRItemStore
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:16:25.280

（假设您实际上`BNRItem`在这些文件中使用了某个地方）

对于 s也是一样的`BNRItemStore.m`，但它可能会增加任何`#import`s 的编译时间和重新编译频率`BNRItemStore.h`——因为许多需要查看的类`BNRItemStore`通常不需要也查看`BNRItem`s `@interface`。

由于该模式扩展到项目中的许多标头，因此对一个标头的简单编辑可能需要重新编译大量文件，其中包含大量包含文件。它还会传播到索引器，该索引器会根据变化不断进行索引。

最好使用前向声明，除非您的项目（并且将保持）很小。

能够在`.m`- 中声明所有实例变量/属性实际上非常好，因为这是对 clang 的一个相当新的补充。抽象和构建时间可以显着改善。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:07:23.503

是和不是。

你不会在编译时得到相同的结果。`@class`只是告诉编译器它会看到那个类，所以把它当作一个类（把它拿出来，你会得到错误），而`#import`告诉编译器完全导入`.h`那个类的（头）文件。

所以它会更慢（正如你所建议的那样），特别是如果`.h`类的（头）文件`#import`是任何其他文件。对于不需要所有功能的接口，您只需要定义。

但就所有意图和目的而言，就您而言，感知到的功能是完全相同的，所以在这方面是的。

# javascript - 为什么 mongodb-native 驱动程序中有单独的 mongo.Server 和 mongo.Db？

> ID：11970674
> 
> 赞同：10
> 
> 时间：2012-08-15T14:00:58.733
> 
> 标签：javascript, node.js, mongodb, node-mongodb-native

我只是在学习 nodejs 的 mongodb-native 驱动程序。

我是这样连接的。

```
var mongo=require("mongodb")

var serv=mongo.Server("localhost", 27017)
var dbase=mongo.Db("MyDatabase", serv) 
```

那行得通。但是，如果我尝试使用同一台服务器创建新的数据库连接，则会出现错误。

```
var dbase2=mongo.Db("MyDatabase2", serv) 
```

**“错误：不能在多个数据库实例之间共享服务器或 ReplSet 实例”**

但是如果先建立一个新的服务器连接，它就可以工作。

```
var serv2=mongo.Server("localhost", 27017)
var dbase2=mongo.Db("MyDatabase2", serv2) 
```

所以我的问题是为什么有 2 个连接函数，一个用于服务器，一个用于 Db，而它们似乎必须始终一起使用？

为什么不这样。

```
var dbase=mongo.Db("localhost", 27017, "MyDatabase") 
```

我想创建自己的函数来执行此操作，但我想知道它们是分开的是否还有其他原因。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T01:42:44.510

对于它的价值，您可以通过 using 来做您想做的事情`Db#db()`，它似乎没有出现在官方文档中，但在源代码中`db.js`作为公共 API 列出：

```
/**
* Create a new Db instance sharing the current socket connections.
*
* @param {String} dbName the name of the database we want to use.
* @return {Db} a db instance using the new database.
* @api public
*/ 
```

所以你可以做

```
var serv=mongo.Server("localhost", 27017);
var dbase=mongo.Db("MyDatabase", serv);
var dbase2=dbase.db("MyDatabase2"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-29T15:38:02.670

这是 mongo 文档上解决方案的链接，供参考。（似乎与其他海报提到的相同解决方案）

[http://mongodb.github.com/node-mongodb-native/markdown-docs/database.html#sharing-the-connections-over-multiple-dbs](http://mongodb.github.com/node-mongodb-native/markdown-docs/database.html#sharing-the-connections-over-multiple-dbs)

将与 mongo 服务器的连接和 DB 分开的目的是在您想要连接到 ReplSet 服务器或其他自定义参数的情况下。这样，您就有了一个连接到 mongodb 服务器的单独进程。

数据库连接调用是分开的，只是因为您在这里遇到的情况：您不只是想连接到 mongo 服务器和单个数据库，而是多个数据库。这种连接到数据库和服务器的分离允许这种灵活性。

**另一种解决方案：使用 node-mongoskin**

[Mongoskin](https://github.com/kissjs/node-mongoskin)做你想做的事......它允许在一个命令中连接到服务器和数据库。不是 mongo-native 的解决方案，但值得考虑作为您未来项目的替代库。

```
var mongo = require('mongoskin');
var db = mongo.db('localhost:27017/testDB'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:17:27.100

因为这是两个独立且不同的操作 - 您必须连接（或已经连接）到数据库服务器（计算机）才能查询该特定服务器上的任何数据库。您可以为要使用的每个数据库创建不同的数据库查询连接，但同时您将使用与服务器的相同连接。
大多数情况下，您不想为每个数据库（如果有很多）创建单独的服务器连接，因为服务器通常会限制连接数。

# mysql - 如何在 MySQL 中查询以下内容？

> ID：11970675
> 
> 赞同：1
> 
> 时间：2012-08-15T14:01:02.730
> 
> 标签：mysql, sql, database

我想从名为 cars 的表中返回 3 行，每辆车都应该有一个不同的dealer_id ，并且我希望它们按 ID desc 排序（以便添加到数据库中的最新三辆车是返回的）

```
SELECT id,dealer_id,name,model_year 
FROM cars 
GROUP by dealer_id 
ORDER BY id DESC 
LIMIT 3; 
```

但是这个查询没有从每个不同的地方返回最新的 3 辆车`dealer_id`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T14:15:26.650

如果您想要最新的记录，则可以使用以下内容：

```
SELECT c1.id, 
  c1.dealer_id, 
  c1.name, 
  c1.model_year, 
  c1.date_Added
FROM cars c1
inner join
(
  select dealer_id, max(date_Added) mxdate
  from cars
  group by dealer_id
) c2
  on c1.dealer_id= c2.dealer_id
  and c1.date_Added = c2.mxdate
GROUP BY dealer_id
ORDER BY id desc
LIMIT 3; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/ffa8d/6)

# javascript - 多次克隆对象并在 jQuery 中附加克隆

> ID：11970677
> 
> 赞同：0
> 
> 时间：2012-08-15T14:01:11.353
> 
> 标签：javascript, jquery

我尝试提供一个预定义的对象*抓取*，以便稍后克隆它并使用更多功能填充克隆。我面临的问题是，我可以克隆对象，但之后只有一个对象附加到 DOM 中。

到目前为止的代码是：

```
var foo = jQuery.extend({}, Grab);
var bar = jQuery.extend({}, Grab);

$('body').append(foo);
$('body').append(bar); 
```

我使用*jQuery.extend()*因为我需要 Grab 的*.daggable*功能和克隆。

任何建议都非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T14:02:47.647

如果`Grab`是一个元素，您通常应该使用`.clone(true, true)`它来复制它，而不是`$.extend()`

这些`true`参数将使它成为原始对象的深层副本。

但是，这可能无法正确复制*可拖动*设置。仅仅因为对象已被克隆，您不能保证所有状态都已被复制。特别是如果任何可拖动状态存储在词法范围的私有变量中，它将不起作用。

同样，该`.draggable`函数第一次添加到元素时所做的任何其他设置也不会完成。

恕我直言，您最好的选择是使用`.clone(false)`浅拷贝，然后调用`.draggable`拷贝，然后重新附加它们的事件处理程序。

# unit-testing - Visual Studio 2012 测试项目混合模式运行时

> ID：11970686
> 
> 赞同：15
> 
> 时间：2012-08-15T14:01:30.470
> 
> 标签：unit-testing, .net-4.0, .net-2.0, visual-studio-2012

我目前正在使用测试项目在 Visual Studio 2012 RC 中工作。我已包括以下程序集：

*   微软.SqlServer.Smo
*   Microsoft.SqlServer.SmoExtend
*   Microsoft.SqlServer.ConnectionInfo
*   Microsoft.SqlServer.Management.Sdk.Sfc

这些程序集是在 2.0.50727 版本中构建的，我在 .NET 4.0 中有一个测试项目。因此，基于这些信息，我在项目中添加了一个 app.config 文件，其中包含以下几行：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0"/>
  </startup>
</configuration> 
```

当我要运行它时，我一直收到以下消息：

混合模式程序集是针对运行时版本“v2.0.50727”构建的，如果没有额外的配置信息，则无法在 4.0 运行时中加载。

这是 Visual Studio 2012 RC 测试项目中的一个错误，它忽略了 app.config 文件，还是我做错了什么？

有关其他信息，我还包括了我的测试代码：

```
 var connectionString = new SqlConnectionStringBuilder()
    {
        DataSource = @"(local)",
        IntegratedSecurity = true
    }.ConnectionString;

    var sql = "alter database [Test] set single_user with rollback immediate go ";
    sql += "drop database [Test] go ";
    sql += "create database [Test] go ";
    sql += Properties.Resources.Test;

    var connection = new SqlConnection(connectionString);
    var server = new Server(new ServerConnection(connection));

    server.ConnectionContext.ExecuteNonQuery(sql); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-30T20:37:09.313

**这似乎在 Visual Studio 2012 中得到修复，当它进入 RTM 时。无需更新配置文件**

我已经在 Visual Studio 2012 Update 4 和 Visual Studio 2013 Update 1 RC 中进行了测试，您的代码可以完美地与上述代码和程序集引用一起工作，并且无需更新测试运行程序的配置文件。这可能在 Visual Studio 2012 的 beta 或候选发布版本中被破坏，但如果是，它现在似乎已修复。

正如 Hans 提到的，您可以更新 . 的`.config`文件`vstest.executionengine.x86.exe.config`，但这会改变您机器上*所有*测试项目的行为，并且需要应用于所有在您的项目上工作的人（如果您正在使用构建服务器，则需要在构建服务器上）。**这应该是最后的手段！！**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T21:28:15.470

Check to make sure you don't have an older version of .Net 4.0 installed. If you downloaded either the 2010 VS beta or the 2012 VS beta, that can happen and then for some reason it will spool up the wrong one. Oh, and it would be a side-by-side install with the current .Net 4.0 . [reference](http://social.msdn.microsoft.com/Forums/en-US/windowsazuredevelopment/thread/6763b81d-62ba-461b-80fe-7e713d46c8df)

# php - 设置 PDO 连接全局的问题

> ID：11970696
> 
> 赞同：0
> 
> 时间：2012-08-15T14:02:18.430
> 
> 标签：php, pdo, global-variables

在阅读了很多帖子但没有让这个东西运行之后，也许有人可以帮助我。

我正在尝试包含一个 PHP (Module.php) 文件，该文件将 db 中的信息添加到我的 index.php 中。该 index.php 还包括与数据库连接的文件。问题是处理数据库选择的包含文件似乎不知道 PDO 对象，脚本死了这个错误：

```
Fatal error: Call to a member function prepare() on a non-object in 
```

我试图使 PDO 对象成为全局对象。但不幸的是，这不起作用。

非常感谢您的帮助（确保我不会发疯......）

托尼

索引.php

```
//DB Connection
require_once ("include/db_connect_inc.php");

$request = $_GET['Controll'];

switch ($request) {
case 0:
    echo "XY";
    break;
case 1:
    global $objDb;

//This file should be able to use the DB Object
    include("modules/Eat/Module.php");
    break; 
```

}

模块.php

```
global $objDb;

    $dbSelect = $objDb->prepare(
    "SELECT DISTINCT ON (nummer) nummer
    FROM tableX
    "  
);

$dbSelect->execute();

while($row = $dbSelect->fetch(PDO::FETCH_ASSOC)) { 
$all = $row['nummer'];
}
echo "1 - " . $all; 
```

db_connect_inc.php

```
$strDbLocation = 'pgsql:host=localhost;dbname=test';
$strDbUser = 'root';
$strDbPassword = 'root';

try{
    $objDb = new PDO($strDbLocation, $strDbUser, $strDbPassword);
    $objDb->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    $objDb->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    global $objDb;
}
catch (PDOException $e){
    //echo 'Fehler beim Öffnen der Datenbank: ' . $e->getMessage();
       print "Error!: " . $e->getMessage() . "<br/>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:08:56.427

由于您似乎没有使用任何函数，因此您的变量已经设置在全局范围内，因此您应该摆脱所有`global $objDb;`行。

只要连接到数据库的前 3 行没有错误，这应该可以解决问题。

除此之外，我会使用 OOP / classes 并使用依赖注入来确保我的`Module`类总是提供它需要的东西（在这种情况下是一个 db 连接）。

# xcode - 包含框架的标题而不明确包含框架的名称？

> ID：11970697
> 
> 赞同：3
> 
> 时间：2012-08-15T14:02:19.063
> 
> 标签：xcode, frameworks, import, header, include

我四处寻找，似乎不可能，但永远不知道。我在 MacOSX 应用程序 (Xcode) 中包含一个框架。如果我有，一切都很好

```
#include <MyFramework/MyHeader.h> 
```

但这对我来说并不理想，因为它是一个跨平台项目，其他操作系统不需要包含中的“额外”框架名称。如果我将框架的 Headers 符号链接路径添加到

```
HEADER_SEARCH_PATHS 
```

我只能使用

```
#include <MyHeader.h> 
```

虽然这不是一个理想的解决方案。那么真的不可能有其他方式吗？谢谢你！

# node.js - 如何有效地在 2 个 node.js 实例之间传输文件？

> ID：11970700
> 
> 赞同：3
> 
> 时间：2012-08-15T14:02:29.300
> 
> 标签：node.js, websocket, socket.io, file-transfer

我正在使用 webkit+node.js 框架 app.js 开发聊天应用程序。所以我在两边都有 node.js 和桥接的 Web 浏览器环境。我想让文件传输功能有点类似于 Skype。

所以，最初的想法是：

1.将客户端连接到主服务器。

2.每个客户端都得到对方的IP。

3.在两个客户端上启动socket或websocket服务器并相互连接。

4.Sender读取文件并将其传输给receiver。

问题是：

1.我不确定一个客户是否可以“看到”另一个客户。

2.file 是二进制数据，但是 websockets 是为文本消息制作的，所以我需要某种编码/解码的东西。我考虑过 base 64，但它有 30% 的“开销”信息。所以我需要更高效的东西（以 128 为基数？）。

3.如果使用 websocket 效率不高，我应该使用 TCP 套接字吗？如果我决定使用它们会出现什么问题？

是的，我知道[node2node](https://github.com/dotmaster/node2node-socket.io)和[BinaryJS](https://github.com/binaryjs/binaryjs)，我只是不知道我是否应该使用它们。我真的要自己做什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:41:35.760

好的，您的通信如下所示：

(C->N)<->N<->(N->C)

(...) 安装在一台客户的机器上。N 是节点服务器，C 是 Web 客户端。

1.  这是你无法控制的。一些文件共享应用程序从中央服务器向客户端发送测试数据包，以检查端口是否打开以及是否正确配置了 NAT 规则等。您的客户端将在某个端口上启动自己的服务器，您的主服务器可能会创建一个测试连接到这些服务器在告诉其他客户端他们可以发送文件之前，查看它们是否正确启动并打开到网络。

2.  Websocket 非常适合从服务器到 Web GUI 的状态消息以及一般的客户端到客户端通信。对于实际的文件传输，我会使用 TCP 套接字，请参阅下一个答案。另一方面，base64 编码确实不是一个缓慢的过程，使用它并对其性能进行基准测试，然后用一些数据来支持你的决定。

3.  您可以使用组合：从您的服务器到 Web GUI 的 websockets，但服务器本身之间的 TCP 通信。在 Node 中设置 TCP 服务器（和流）并不难，我认为没有缺点。它实际上可能没有`node2node`在这些服务器上安装那么复杂，因为 TCP 已经内置。

# liferay - 了解 Liferay 中的子页面层次结构

> ID：11970701
> 
> 赞同：3
> 
> 时间：2012-08-15T14:02:31.423
> 
> 标签：liferay, portlet, private

我将通过 4 个简单的问题来总结逻辑：

1.  私人页面可以/应该有公共子页面吗？（似乎私人页面正在为任何组/用户使用其他站点或上下文）
2.  公共页面可以/应该有私有子页面吗？
3.  隐藏页面可以/应该有非隐藏的子页面吗？
4.  某个用户不允许查看的页面是否可以/应该有一个允许某个用户查看的子页面？

之前的一些场景是否会改变父页面的行为？我的意思是，也许允许您对子页面的权利使您自动授权查看父页面。

**此外，隐藏**页面和 **非*隐藏*n 页面有什么区别？我可以通过链接浏览两者！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T14:34:32.900

回答您的问题（对于 Liferay 6.1，可能与早期版本不同）：

1.  私有页面只能有私有子页面
2.  公共页面只能有公共子页面但可以隐藏子页面（因此它们不会出现在导航中但可以通过URL直接访问）
3.  它们可以，但它们也不会出现在导航中，除非您更改了主题以便它们出现
4.  是的，它可以，这取决于你，你是否想让主题有这个限制

父页面行为不受子页面设置的影响。

**隐藏页面**：从导航中隐藏但可以通过链接直接访问或输入其 URL 的页面

**非隐藏页面**：可以在导航中看到，和隐藏页面一样可以访问。

**私人页面**：只能由他们所属社区的经过身份验证的成员访问。它们是有效的门控页面，因此无需为访客用户设置页面权限，就不会被公众查看。

我希望这能回答你所有的问题。

~~编辑~~

正如下面提到的 Julien Lafont： 隐藏的页面在搜索 portlet 中是可见的。如果您想对特定的用户组隐藏它们，请使用权限。谢谢朱利安。

# jquery - 让 jQuery 显示正确的子菜单（如果存在）

> ID：11970702
> 
> 赞同：1
> 
> 时间：2012-08-15T14:02:30.840
> 
> 标签：jquery, show-hide, submenu, bigcartel

这是我在这里的第一篇文章，所以我提前为任何不良做法道歉。我一直在寻找一段时间，但还没有找到适合我需求的解决方案 - 也许我只是做错了。但这里有：

我正在使用 Big Cartel CMS 构建一个站点，并且第一次深入研究了 jQuery。我正在尝试创建一个水平且居中的导航菜单，该菜单将在适当的情况下在下方显示一个子菜单。我对 html 和 CSS 很好，但在 jQuery 上苦苦挣扎。

加价如下：

```
<nav>
    <ul id="mainNav">
        <li><a href="expand-the-sub-menu">Option 1</a>
            <ul id="option1Nav">
                <li><a href="somewhere">Option 1 Link 1</a></li>
                <li><a href="somewhere">Option 1 Link 2</a></li>
                <li><a href="somewhere">Option 1 Link 3</a></li>
                <li><a href="somewhere">Option 1 Link 4</a></li>
                <li><a href="somewhere">Option 1 Link 5</a></li>
            </ul>
        </li>
        <li><a href="expand-the-sub-menu">Option 2</a>
            <ul id="option2Nav">
                <li><a href="somewhere">Option 2 Link 1</a></li>
                <li><a href="somewhere">Option 2 Link 2</a></li>
                <li><a href="somewhere">Option 2 Link 3</a></li>
                <li><a href="somewhere">Option 2 Link 4</a></li>
                <li><a href="somewhere">Option 2 Link 5</a></li>
            </ul>
        </li>
        <li><a href="somewhere">Option 3</a></li>
        <li><a href="somewhere">Option 4</a></li>
        <li><a href="somewhere">Option 5</a></li>
        <li><a href="somewhere">Option 6</a></li>
    </ul>
</nav> 
```

虽然这种格式不会改变，但带有子菜单的选项数量可能会（客户可以随意更改）。到目前为止我的 jQuery：

```
$('#mainNav ul').hide();
$('#mainNav li a').click(function(){
    $('#mainNav li:has("ul")').each(
        function(){
            $('nav').animate({bottom:'60px'},300,'easeOutQuint',function(){
            //Do magic stuff here - i.e. display the correct sub-menu.
            });
        }
    );
}); 
```

目前，当点击时，这针对所有选项（我无法理解为什么），我仍然没有深入了解如何只显示适当的子菜单。可以将类添加到任何 html 元素中，如果这有助于使事情变得更容易的话。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:15:14.900

这个怎么样：

[http://jsfiddle.net/qDX2q/3/](http://jsfiddle.net/qDX2q/3/)

```
$('#mainNav ul').hide();
$('#mainNav a')
    .click(function()
           {
                $('#mainNav ul').hide();
                $(this).siblings("ul").show();
                return false;
           });
​ 
```

我认为你缺少的东西是：

*   确保从 click 事件中返回 false，以便不遵循错误的 url。
*   `this`关键字。在上面的代码`this`中实际上是你所在的锚标记。所以你可以只寻找兄弟姐妹`ul`并展示他们

# jquery - jquery偏移值没有从onload动画创建新高度

> ID：11970704
> 
> 赞同：0
> 
> 时间：2012-08-15T14:02:34.093
> 
> 标签：jquery

我正在使用`.offset();`从变量顶部计算一个值...

```
pos = content.offset(); 
```

但我的问题是我有一个在加载 twitter api 时运行的动画。

所以这意味着这个动画在触发之前大约有 2-5 秒的延迟。这个动画增加了我的`content = $("#slider-container")`身高（大约 64 像素）。但有时如果 twitter 永远不会加载，那么动画将永远不会运行。

因此，当我在下面的脚本中使用此变量时，它会从 twitter 动画之前获取偏移值。即使动画已经运行。

正如你所看到的——我的第二个脚本，这是我的推特动画，它在推文加载时运行——并且`$('#tweetbar')`在里面`$("#slider-container")`

我该如何排序？

我的剧本...

```
$(window).bind("resize.browsersize", function() {

    var $tabs = $('#left-tab, #right-tab'),
        positionScroll = $(window).height() / 2,
        content = $("#slider-container"),
        pos = content.offset();

    $(window).scroll(function(){  

        if ( $(window).scrollTop() >= pos.top + 265 - positionScroll  ) {

            if ($(window).scrollTop() + positionScroll <= pos.top + content.height() - $tabs.height()) {

                $tabs.removeAttr('style').css({ position:'fixed', top: positionScroll + 'px'}); 

            } else {

                $tabs.removeAttr('style').css({
                    top: content.height() - $tabs.height()
                });

            }

        } else {

            $tabs.removeAttr('style').css({ top: '265px' });    

        }

    }); 

}).trigger("resize.browsersize"); 
```

* * *

我的动画脚本...

```
$("#tweetbar").tweet({
    username: "twitter",
    join_text: "auto",
    count: 1,
    auto_join_text_default: "we said,",
    auto_join_text_ed: "we",
    auto_join_text_ing: "we were",
    auto_join_text_reply: "we replied to",
    auto_join_text_url: "we were checking out",
    loading_text: "loading tweets..."
}).bind("loaded", function(){

    $('#tweetbar').slideDown();

}); 
```

# c# - 如果我的班级没有具有该名称的相应属性，我应该引发 INotifyPropertyChanged 事件吗？

> ID：11970705
> 
> 赞同：3
> 
> 时间：2012-08-15T14:02:35.293
> 
> 标签：c#, events, inotifypropertychanged

我有一个实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)的​​类，*也*有自己的属性概念，有点像这样：

```
class sealed MyClass : INotifyPropertyChanged
{
    private Dictionary<string, object> _properties;

    public object GetProperty(string name)
    {
        return _properties[name];
    }

    public object SomeProperty
    {
        get
        {
            return GetProperty("SomeProperty");
        }
    }
} 
```

请注意，一些常见的属性也有 C# 访问器。

我想引发一个事件来通知其他人某个属性（通过 GetProperty 方法访问其值）已更改，即使此属性没有相应的 C# 访问器也是如此。

假设没有发生冲突的风险（即无意中为值未更改的 C# 属性引发属性更改事件 - 请注意此类是密封的），是否有任何理由我不能只使用该`INotifyPropertyChanged.PropertyChanged`事件来通知其他人，还是我应该为此添加自己的事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:06:17.647

我建议你添加自己的。尽管没有特定原因会导致代码中断，`INotifyPropertyChanged`但具有特定的预期用途，并且许多潜在消费者都可以理解。我不会亲自编写与之相矛盾的代码，以防万一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:11:08.987

据我所知，`PropertyChanged`为不存在的房产筹集资金并没有什么坏处，但我认为这也不是很有用。`INotifyPropertyChanged`主要由数据绑定系统（在 WinForms、WPF、Silverlight ...）中使用，这些系统不知道如何访问您的自定义“属性”。

现在，您可以做的是实现`ICustomTypeDescriptor`以标准方式提供对自定义属性的访问。这适用于 Windows 窗体和 WPF，我不确定其他框架。

当然，如果您不打算将其用于数据绑定，您仍然可以使用此事件来通知您的类的消费者值已更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:38:47.407

从技术上讲，这取决于订阅者`PropertyChanged`以及*他们*对`PropertyChanged`事件的响应。如果他们不尝试读取 .NET “属性”，那没关系。

但是，这确实引入了耦合，而 INPC 的使用正试图解耦。一般情况下的 INPC 假定`PropertyChanged`意味着 .NET 属性（具有给定名称）已更改，并且预计所有使用 INPC 的地方都会出现这种情况。即，您实施 INPC 是因为您想在*任何*接受 INPC 的地方使用您的对象。如果您的对象不能这样做，那么它就违反了 INPC 的默示合同。如果您有一个`PropertyChanged`处理程序执行的操作与读取属性不同，并且您只是因为 INPC 存在而重用它，那么编写您自己的接口可能是一个好主意。

# c++ - vs2010中的函数错误

> ID：11970707
> 
> 赞同：0
> 
> 时间：2012-08-15T14:02:40.903
> 
> 标签：c++, visual-studio-2010

我在vs2010中写了以下内容：

```
int test() const; 
```

它告诉我`const`使用不正确。并说：

> 非成员函数不允许使用类型限定符

我想知道为什么，是vs的问题吗？或者如何在vs中使用这样的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:05:46.963

`const`应用于函数时仅适用于非静态成员函数，不适用于自由函数或静态成员函数。

```
class A
{
    void f1() const;        // OK
    static void f2() const; // Not OK
};

void f3() const; // Not OK 
```

从 C++ 标准：

*   *9.3.1 非静态成员函数*

> 非静态成员函数可以声明为 const、volatile 或 const volatile。

*   *9.4.1 静态成员函数*

> 静态成员函数不得声明为 const、volatile 或 const volatile。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:05:17.703

const 在该上下文中意味着此方法不会修改任何成员变量。如果它不是一个类的方法（即它是一个自由浮动函数），那么它就没有任何意义。

# python - (Alt, Az) 到 (Ra, Dec) 的 pyephem 转换并返回内部不一致

> ID：11970713
> 
> 赞同：4
> 
> 时间：2012-08-15T14:03:17.617
> 
> 标签：python, coordinate-transformation, astronomy, pyephem

我发现当我将 (Alt, Az) 转换为 (Ra, Dec) 然后再使用 PyEphem 时，我没有得到我开始的内容。下面是一个简单的例子。

```
import ephem
print ephem.__version__
# '3.7.3.4'

gbt = ephem.Observer()
gbt.long = '-79:50:23.4'
gbt.lat = '38:25:59.23'
gbt.pressure = 0 # no refraction correction.
gbt.epoch = ephem.J2000
# Set the date to the epoch so there is nothing changing.
gbt.date = '2000/01/01 12:00:00'

# Should get the north pole right?
ra, dec = gbt.radec_of(0, '38:25:59.23')
# Not the north pole... error might be abberation.
print dec
# 89:59:30.5

# Now check internal consistancy by reversing the calculation.
pole = ephem.FixedBody()
pole._ra = ra
pole._dec = dec
pole._epoch = ephem.J2000
pole.compute(gbt)
# Should get what I started with right?
alt = pole.alt
# Not what I started with... error unknown.
print alt
# 38:26:26.7 
```

正如评论中所指出的，虽然 30 英寸超过了维基百科规定的 20 英寸的最大效果，但没有准确地找到北极可能只是恒星像差。

当我做反向计算时，我没有得到同样的结果，这让我很困惑。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-19T01:10:57.177

由于畸变*和*章动，您得到的结果是关闭的。如果您要自己编译 PyEphem 并注释掉第 271 和 272 行，`circum.h`那么您会发现您得到的结果正是您所期望的——通过这些编辑，代码将如下所示：

```
 /* correct EOD equatoreal for nutation/aberation to form apparent 
     * geocentric
     */
    /* nut_eq(mjed, &ra, &dec); */
    /* ab_eq(mjed, lsn, &ra, &dec); */
    op->s_gaera = ra;
    op->s_gaedec = dec; 
```

当您要求 PyEphem 从观察到的 RA“倒退”并减速到它们后面的天空位置时，它只会反转折射（您已经关闭）和进动来生成它的答案。

为什么会停在那里？为什么它不尝试扭​​转章动和畸变？（除了实际原因：这些数量是通过昂贵的多项式估计的，不能轻易反转！）

它不尝试对章动和畸变进行反向补偿的原因是它不知道位于 RA 和 dec 处的对象的范围。例如，如果您因为看到一颗卫星从头顶经过而询问 RA 和 dec，那么像差将是无关紧要的——地球卫星在与地球相同的相对论框架中运行——而章动也无关紧要，因为你不会对地球“理想”极点的位置感兴趣——你会对在你抬头观察卫星从头顶经过的特定夜晚极点指向的位置感兴趣。

因此，在不知道你看到的物体是地球卫星、月球还是太阳系不同相对论框架中的行星，或者更远的东西的情况下，“libastro”图书馆做了最简单的事情并停在那里，而不是用甚至可能不适用于您的情况的反向效果来混淆答案。不过，当我接近 PyEphem 的下一个版本时，我会记住这一点，并考虑多种`radec_of()`技术是否不合适。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-18T11:41:51.907

我的版本是4.1。我刚刚测试了代码，得到了相同的结果。

```
alt:38:26:26.7 
```

然后我将输入 alt 角调整到远离杆子 10' 处。然后它给出了更好的结果。

```
ra, dec = gbt.radec_of(0, '38:35:59.23')
alt: 38:35:59.2 
```

也许在杆位附近，精度自然下降。而当它远离极点时，精度恢复正常。

# c - 在C中将二进制转换为数字字符串到十进制数

> ID：11970714
> 
> 赞同：1
> 
> 时间：2012-08-15T14:03:19.003
> 
> 标签：c, string, binary, decimal

我编写了一个程序，要求用户使用字符串输入一个数字，然后程序将该数字转换为十进制，但是当我编译（使用 -lm）并运行 a.out 时，我遇到了问题，我得到一个分段错误（核心转储），不确定在哪里查看或如何修复它，还有一个问题我需要什么才能打印转换结果（printf（“something..”））？

```
#include <stdio.h>
#include <string.h>
#include <math.h>

int main()
{

char string[100];
int s;
char a;
char j;
int sum;

printf("B = B to D\n");
printf("D = D to B\n");
printf("choose which one to convert to:");
scanf("%c%c", &a, &j);

if (a == 'B')
{
    printf("enter binary number to convert to decimal: ");
    scanf("%s", string);

    for(s = strlen-1; s >= 0; s--)
    {

            if(string[s] == '1')
            {
            sum = sum + pow(2,s);

            }
    }

}

return 0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:09:18.267

你可能打算拥有`strlen(string) - 1`，不是`strlen - 1`。我最好的猜测是你的程序被解释`strlen`为一个函数指针，而且在那之后会发生疯狂的事情。

实际上，您可能对[strtol](http://linux.die.net/man/3/strtol)函数感兴趣，它似乎完全符合您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-01T11:45:03.980

strlen 使用不正确。我认为您想做类似 strlen(string)-1 的事情。顺便说一句，您的逻辑无法转换小数部分。检查此代码：

```
#include <stdio.h>
#define MAX 1000

int main()
{
    double fraDecimal=0.0,dFractional=0.0 ,fraFactor=0.5;
    long dIntegral = 0,bIntegral=0,bFractional[MAX];
    long intFactor=1,remainder,i=0,k=0,flag=0;
    char fraBinary[MAX];

    printf("Enter any fractional binary number: ");
    scanf("%s",&fraBinary); 
    while(fraBinary[i]) //Separating the integral and fractional parts
    {

      if(fraBinary[i] == '.')
          flag = 1; //If dot is found start taking the fractional part.
      else if(flag==0)
          bIntegral = bIntegral * 10 + (fraBinary[i] -48); 
          /* char - 48 to get the numerical value.*/
      else
          bFractional[k++] = fraBinary[i] -48;
      i++;
    }

    while(bIntegral!=0){
     remainder=bIntegral%10;
     dIntegral= dIntegral+remainder*intFactor;
     intFactor=intFactor*2;
     bIntegral=bIntegral/10;
    }

    for(i=0;i<k;i++){
     dFractional  = dFractional  + bFractional[i] * fraFactor;
     fraFactor = fraFactor / 2;
    }

    fraDecimal = dIntegral + dFractional ;

    printf("Equivalent decimal value: %Lf",fraDecimal);   
    return 0;
} 
```

来源： [将二进制转换为十进制数的 C 程序](http://jabroo.blogspot.com/2013/08/convert-binary-to-decimal-c-language.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:12:36.837

您使用 strlen 作为整数。我想你的意思是 strlen(string)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T19:34:20.347

```
for(sum=0, j=0, s=strlen(string)-1; s >= 0; s--, ++j){
    if(string[s] == '1'){
        sum = sum + pow(2,j);
    }
}
printf("%d\n",sum); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T16:48:30.183

```
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <ctype.h>
#include <stdlib.h>

void reverse_string(char *string)
{
   int string_length = strlen(string);
   char temp;
   int i;
   for (i = 0; i < string_length/2; i++)
   {
      temp = string[i];
      string[i] = string[string_length - (i + 1)];
      string[string_length - (i + 1)] = temp;
   }
}

int main()
{

   char string[100];
   int s;
   char a;
   char j;
   int sum = 0;
   int string_length = 0;
   int number, original_number;
   int remainder;
   char binary_string[200];
   int i = 0;

   printf("B = B to D\n");
   printf("D = D to B\n");
   printf("choose which one to convert to:");
   scanf("%c%c", &a, &j);
   a = toupper(a);
   if (a == 'B')
   {
      printf("enter binary number to convert to decimal: ");
      scanf("%s", string);

      string_length = strlen(string);
      for(s = strlen(string)-1; s >= 0; s--)
      {
         if(string[s] == '1')
         {
            sum = sum + pow(2,string_length - (s + 1));
         }
      }
      printf("%s in binary is %d\n",string,sum);
   }
   else if (a == 'D')
   {
      printf("enter positive decimal number to convert to binary: ");
      scanf("%s",string);
      number = atoi(string);
      original_number = number;
      if ( number < 0 )
      {
         printf("ERROR: only positive numbers please\n");
         return 1;
      }
      do
      {
         remainder = number % 2;
         if ( remainder == 0 )
            binary_string[i] = '0';
         else
            binary_string[i] = '1';
         number = number / 2;
         i += 1;
      }
      while (number > 0);
      binary_string[i] = '\0';
      reverse_string(binary_string);
      printf("decimal %d is %s in binary\n",original_number,binary_string);
   }
   return 0;
} 
```

# wordpress - .htaccess 301 重定向整个 WordPress 站点，根域除外

> ID：11970718
> 
> 赞同：1
> 
> 时间：2012-08-15T14:03:38.437
> 
> 标签：wordpress, .htaccess

我一直在四处寻找，但找不到以下内容。我想知道是否可以将我的整个 WordPress 博客重定向到除根或主页本身之外的新域。任何朝着正确方向的推动都会很棒。我希望我不是在这里问一个愚蠢的问题！

提前感谢任何有时间查看我的问题的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:09:23.237

是的，你可以，试试这个代码：

```
RewriteEngine on

RewriteRule ^(index.php)?$ - [L]

RewriteCond %{HTTP_HOST} ^(www\.)?olddomain\.com$ [NC]
RewriteRule ^(.+)$ http://www.newdomain.com/$1 [R=301,QSA,L] 
```

# git - git：恢复到我的远程分支并在本地丢弃所有提交？

> ID：11970719
> 
> 赞同：0
> 
> 时间：2012-08-15T14:03:39.140
> 
> 标签：git

任何人都可以帮忙吗，我有我的本地分支，我从远程进行了拉取，然后我刚刚完成了大约 7 次提交，它们都是错误的 :-)

所以我想要做的是恢复到我的远程分支副本。

我不想创建另一个分支，我对“master”这个名字很满意，是否没有 UNDO 功能说 PULL 并在本地忽略所有内容？

目前，我的本地分支 Master 比我的远程原点早 6 次提交，我想将我的本地分支 Master 恢复为与我的原点 master 相同。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T15:19:06.687

很多方式去罗马。您可以做的最简单的事情可能是首先从您的遥控器获取（只需确保您的远程指针确实是您的遥控器所在的位置），然后将您的本地分支重置为它。

```
git fetch origin 
git reset --hard origin/master 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:55:35.523

`git reset --hard HEAD~6`将清除前 6 个提交。（也就是说，它将 master 设置为当前头部的第 6 个祖先，然后清除您的工作树和索引。提交将仍然存在，直到 git-gc 垃圾收集它们）

# java - 新 Mavenized 项目 - 找不到类路径

> ID：11970720
> 
> 赞同：1
> 
> 时间：2012-08-15T14:03:40.067
> 
> 标签：java, spring, maven

我有一个指向应用程序上下文文件的静态 main。在项目成为maven项目之前，我将“applicationContex.xml”保存在Netbeans的“”（即root）中。现在，当我运行我的代码时，我得到了显示的错误。

有人可以告诉我应用程序上下文文件的正确位置吗？

```
@Service
public class TestDriver {
    public static void main(String[] args) {
        ApplicationContext ctx = new ClassPathXmlApplicationContext("applicationContext.xml"); 
```

错误：

```
INFO: Loading XML bean definitions from class path resource [applicationContext.xml]
Exception in thread "main" org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from class path resource [applicationContext.xml]; nested exception is java.io.FileNotFoundException: class path resource [applicationContext.xml] cannot be opened because it does not exist

Directory of C:\NetBeansProjects\prj\trunk\src\main\java

8/15/2012  09:38 AM    <DIR>          .
8/15/2012  08:58 AM    <DIR>          ..
8/15/2012  09:38 AM               162 jcbc.properties
8/15/2012  09:38 AM               879 log4j.properties
8/15/2012  09:38 AM             1,691 applicationContext.xml
              3 File(s)          2,732 bytes 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:08:59.067

遵循`maven`约定，将 xml 文件保存在`src/main/resources`

来自[SpringSource](http://blog.springsource.org/2011/01/17/green-beans-getting-started-with-maven-and-spring/)

```
src/main/java 
```

包含项目的 Java 源代码

```
src/main/resources 
```

包含项目的任何类路径相关资源（如 Spring 应用程序上下文 .xml 文件）

```
src/test/java 
```

包含测试类的 java 源代码。此目录不会包含在最终构建中。这里的所有测试都将被编译并运行所有测试。如果测试失败，它将中止构建。

```
src/test/resources 
```

此目录不会包含在最终的 Java 构建中。此文件夹包含您的测试代码的任何类路径相关资源（如 Spring 应用程序上下文 .xml 文件）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:09:18.150

您需要将非java文件放入：

```
C:\NetBeansProjects\prj\trunk\src\main\resources 
```

# spring - JNDI、Spring、JMX的关系

> ID：11970721
> 
> 赞同：0
> 
> 时间：2012-08-15T14:03:41.707
> 
> 标签：spring, jndi, jmx

我想知道JNDI和Spring有什么关系？spring 是 JNDI 的高级版本吗？两者都用于从字符串名称创建对象。我们可以说对于 JNDI 来说，一个应用服务器是提供命名服务的必要条件吗？另一方面，对于 Spring，我们可能不需要应用程序服务器，因此它可以在 Java SE 中使用？

最后，我们可以将 JMX 放在 JNDI 和 Spring 之间的这种关系上吗？低层有一些共同的逻辑吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T14:48:24.323

只是为了澄清一些定义：

*   [Spring](http://en.wikipedia.org/wiki/Spring_Framework)：Spring Framework 是一个开源应用程序框架和控制反转容器。
*   [JNDI](http://en.wikipedia.org/wiki/JNDI)：Java 命名和目录接口，一种用于目录服务的 Java API，它允许 Java 软件客户端通过名称发现和查找数据和对象。
*   [JMX](http://en.wikipedia.org/wiki/JMX)：Java 管理扩展 (JMX) 是一种 Java 技术，它提供用于管理和监视应用程序、系统对象、设备（例如打印机）和面向服务的网络的工具。

JNDI 主要是一组 Java 接口，它们定义了命名系统在 Java 中的工作方式，从而可以将一组不同的服务抽象为一个简单的 JNDI 接口。例如，文件系统、LDAP 服务器和 DNS 服务器都可以作为 JNDI 服务进行访问。

Enterprise Java (Java EE) 广泛使用 JNDI 将对象存储在一个公共地址中，其他服务可以通过名称找到它们。JNDI 不需要应用程序服务器，但 Java EE 应用程序服务器几乎总是需要（并提供）JNDI 服务。

Spring 不是 JNDI 实现，*不需要*JNDI，但确实支持它，这意味着您可以在 Spring 容器中启动 JNDI 服务，访问基于 JNDI 的资源并使用 Spring 内置的 JNDI 支持类。

JMX 定义了一个关于如何向 Java 应用程序提供管理接口、工具和运行时“透明度”的标准。JNDI 和 JMX 之间没有太多重叠，除了 JMX 远程连接器经常以 java 远程对象的形式构建并绑定到 JNDI 服务（以便远程客户端可以查找它们并连接到 JMX 托管应用程序）。

Spring*不需要*JMX，但在其框架库中提供了对它的支持，这通常用作将基于 JMX 的服务添加到 Spring 托管应用程序或服务的简化方法。

听起来您*不需要*JNDI，正如您所说，如果您的应用程序将基于 Spring 管理的 Java SE，那么您将有一些相当专业的要求来调用 JNDI。

至于 JMX，Spring 确实使将 JMX“工具”添加到 Spring 管理的 Java SE 应用程序变得相当容易。***我的观点***：我觉得（并且可能是错误的）你需要在解决这个问题之前发展更多的专业知识，因为这对你来说可能是一个严重的偏离轨道。

# ruby-on-rails - Rails - 在视图或控制器中查询模型？

> ID：11970722
> 
> 赞同：1
> 
> 时间：2012-08-15T14:03:45.947
> 
> 标签：ruby-on-rails, rails-activerecord, separation-of-concerns

有`User`很多`Folder`s。为了实现 的`index`动作`Folder`，我可以在控制器中查询特定用户的文件夹：

```
class FoldersController < ApplicationController
  def index
    @folders = current_user.folders
  end
end

#app/views/folders/index.html.haml
- @folders.each
... 
```

但我也可以跳过控制器：

```
#app/views/folders/index.html.haml
- current_user.folders.each
... 
```

当然前者要优雅得多。但它们有本质的不同吗？我的意思是，他们是否有不同的表现或有时会输出不同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:49:48.237

这可能需要相同的时间，但您的视图中不应包含逻辑。

正如您在两个示例中的第一个示例中所述，您应该在控制器中执行此操作。文件夹视图显示文件夹，不必知道是当前用户的文件夹。

这样，您可以执行管理操作，您可以在其中检索所有文件夹并将其传递给变量“文件夹”中的同一视图。该视图不关心它只是代表您传递给它的任何文件夹列表的文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:13:35.227

There'll be no real performance difference. It's just a matter of style and code separation.

# asp.net - 用于 IIS 7 的 Powershell 命令，用于将一个字符串替换为另一个字符串

> ID：11970723
> 
> 赞同：1
> 
> 时间：2012-08-15T14:03:47.353
> 
> 标签：asp.net, powershell

我在 web.xml 中有一个配置设置。配置文件如下：

```
<param name="url" value="http://localhost/services.msc"> 
```

我想使用 powershell 编写一个批处理文件，用端口号替换 value="http://localhost/services.msc" 作为 value="http://localhost:808/services.msc"

是否可以用另一个文本替换一个文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:41:41.530

有几种方法可以做到这一点。如果我知道我要修改的值，我最喜欢的修改任何 XML 文件的方法是将内容转换为 XML，找到我知道的正确设置，修改它，然后设置config 文件到我现在在 powershell 中的内容。下面是一个例子。为了找到确切的值，我通常将其上方的项目通过管道传送到 | 直到我得到我正在看的东西。您可以阅读 XML 并可能更容易获取信息。

```
#Make sure you set the webconfigpath variable.  
#Make sure you know your keyname and where to find it in the XML doc.
$webConfig = [xml](Get-Content -path $webConfigPath)
$setting = $webConfig.configuration.appSettings.add | ?{$_.key -eq "KeyName"}
$setting.Value = "NewValue"
$webConfig.save($webConfigPath) 
```

这可能可以通过 Set-WebConfigurationProperty cmdlet 进行更改，但我不确定，也没有亲自使用过。

# windows - 对磁卡阅读器进行编程以读取员工编号

> ID：11970726
> 
> 赞同：0
> 
> 时间：2012-08-15T14:03:51.050
> 
> 标签：windows, magnetic-cards

我正在尝试对磁卡读卡器进行编程，但我不知道从哪里开始。我做了研究，但似乎没有太多。

1.  我可以将读卡器连接到计算机并通过 Eclipse 之类的 IDE 对其进行编程吗？
2.  它会是什么语言？
3.  如果可能的话，如何在 Windows 7 上查看设备（如拇指驱动器）？

我有我想要的文本格式。我只是不明白读者编程的过程。

非常感谢你的帮助。

# upload - Arduino 上传到 Mega256 失败

> ID：11970728
> 
> 赞同：0
> 
> 时间：2012-08-15T14:03:58.437
> 
> 标签：upload, ide, arduino

我得到了[SainSmart Mega2560 LCD Keypad Shield Sarter 套件](http://www.ebay.de/itm/SainSmart/320963105906)并想上传此 LCD 键盘的演示程序。我认为 IDE 在 Win7 x64 下运行并且驱动程序已正确安装。

我只收到错误消息

```
avrdude: stk500v2_ReceiveMessage(): timeout
avrdude: stk500v2_getsync(): timeout communicating with programmer
avrdude: stk500v2_command(): failed miserably to execute command 0x10
avrdude: initialization failed, rc=-1
         Double check connections and try again, or use -F to override
         this check. 
```

我如何检查连接是否真的存在？是否有任何已知问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T07:25:15.003

看来，很多用户都有同样的问题。我现在的解决方案是，我移除了 LCD 面板并且上传工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T19:51:26.997

这是一个非常奇怪的问题，我在尝试将IO扩展板与Arduino 2560连接时遇到了这个问题。我尝试了很多东西，但没有成功。经过多次尝试，我从 Arduino 中删除了 IO 扩展屏蔽，然后上传，它成功了。不知道为什么插上IO扩展板就不能上传。所以这是一个解决方案，但它正在工作。现在对我来说已经足够了。

--- 已修复 --- 通过检查 RS-485 网络上的所有接线，问题已得到解决。正确设置这些接线后，缺少 GND 和终端接线，问题已自动修复。如果你有这个问题，我建议再次检查接线。

# java - 如何快速将 BufferedImage 转换为 byte[]？

> ID：11970736
> 
> 赞同：0
> 
> 时间：2012-08-15T14:04:17.627
> 
> 标签：java, optimization, bufferedimage

我需要将 a 转换`BufferedImage`为 a `byte[]`，但它太慢了。该字节最终被 base64 编码并发送到 android 客户端。我一直使用的方法是这样的：

```
public static byte[] ImageToBytes(BufferedImage im) throws IOException
{

//make sure its NN
if(im!=null)
{

//create a ByteArrayOutputStream
ByteArrayOutputStream baos = new ByteArrayOutputStream();

//write our image to it
ImageIO.write( im, "png", baos );

//flush the stream
baos.flush();

//get the image in byte form
byte[] imageInByte = baos.toByteArray();

//close the stream
baos.close();

//return our value encoded in base64
return imageInByte;

}

return null;
} 
```

这对我的程序来说太慢了。更改`png`为`jpeg`使其在移动端失败。该`JpegCodec`版本在移动端也失败了。失败是指 Android 方法`BitmapFactory.decodeByteArray()`返回`null`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:35:16.693

您不会说为什么它太慢了，也没有太多可以使此代码更快的方法，因为这是将 a 转换`BufferedImage`为 PNG 字节流的唯一方法。但这里有一些提示：

1.  该类`ByteArrayOutputStream`是同步的，这会花费很多性能。[您可以在Commons IO](https://commons.apache.org/io/) ( `org.apache.commons.io.output.ByteArrayOutputStream`)中找到更快的实现

2.  根据图像的大小，分配算法`ByteArrayOutputStream`可能会出现问题。从 1 或 10 KiB 的初始大小开始。

3.  `toByteArray()`为您提供现有缓冲区的副本。如果您不需要（通常不需要），编写自己的`OutputStream`可能会给您带来额外的速度提升（更不用说避免 GC 运行）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:23:31.737

**不**转换为 byte[] 是一种选择吗？你说“[it] 最终被 base64 编码并发送到 android 客户端”。[将 OutputStream 包装成类似Base64OutputStream](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64OutputStream.html)的内容写入 Android 客户端并完全避免该问题怎么样？

# c# - 如何正确监控每会话 WCF 客户端

> ID：11970737
> 
> 赞同：0
> 
> 时间：2012-08-15T14:04:17.797
> 
> 标签：c#, wcf, web-services, .net-4.0, event-handling

因此，我正在使用具有 Reliable WSHttpBinding 的 Per Session WCF 服务。因为它是每次会话，所以我需要处理我在频道上遇到的任何问题，但我对 WCF 的了解还不是很好。

我决定订阅 ClientBase.InnerChannel 的错误事件，认为如果出现问题就会触发。然而，这似乎只在特定情况下触发。

例如，我连接了网络，然后从网络上拔下服务，并且没有抛出错误，即使我尝试做某事，我也只得到了 EndPointNotFound 异常。

无论如何，我是否可以监视在通道因任何原因变得不可用时触发的事件？我很乐意在我断开连接或发生超时的情况下这样做，但即使这是不可能的（不忙于等待不断检查），我会很高兴在我尝试某事时让我知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:12:36.547

您可以在 windows server appfabric 中托管 WCF 服务，这允许您使用很多工具来监控 wcf： [http ://www.dotnetcurry.com/ShowArticle.aspx?ID=771](http://www.dotnetcurry.com/ShowArticle.aspx?ID=771)

# java - Java 写入 ByteArrayOutputStream 内存泄漏

> ID：11970742
> 
> 赞同：3
> 
> 时间：2012-08-15T14:04:27.227
> 
> 标签：java, sockets, memory-leaks, bytearrayoutputstream

我正在写入图像字节`ByteArrayOutputStream`然后通过套接字发送它。问题是，当我这样做时

```
ImageIO.write(image, "gif", byteArray); 
```

内存上升非常多，有点内存泄漏。

我用这个发送

```
ImageIO.write(image, "gif", byteArrayO);         
byte [] byteArray = byteArrayO.toByteArray();
byteArrayO.flush();
byteArrayO.reset();
Connection.pw.println("" + byteArray.length);
int old = Connection.client.getSendBufferSize();
Connection.client.setSendBufferSize(byteArray.length);
Connection.client.getOutputStream().write(byteArray, 0, byteArray.length);
Connection.client.getOutputStream().flush();
image.flush();
image = null;
byteArrayO = null;
byteArray = null;
System.gc();
Connection.client.setSendBufferSize(old); 
```

如您所见，我已经尝试了所有方法，当我写入时出现错误`ByteArrayOutputStream`，而不是在传输时出现。接收器没有收到任何错误。

有什么办法可以清除 byteArray，并从内存中删除其中的所有内容？我知道`reset()`有，但这里没有。我想在`ByteArrayOutputStream`完成后直接处理掉。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T14:56:10.980

Why do you have to fiddle with the send buffer size? What kind of protocol are you using on top of this socket? It should be just as simple as:

```
ImageIO.write(image, "gif", Connection.client.getOutputStream()); 
```

If you have to use a `ByteArrayOutputStream`, at least use

```
byteArrayO.writeTo(Connection.client.getOutputStream()) 
```

so you don't make an extra redundant `byte[]`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-15T15:10:05.487

@Christoffer Hammarström 可能有最好的解决方案，但我会添加它以尝试解释内存使用情况。

这 2 行正在创建图像数据的 3 个副本：

```
ImageIO.write(image, "gif", byteArrayO);
byte [] byteArray = byteArrayO.toByteArray(); 
```

执行此操作后，您将获得一份存储在图像中的数据副本，一份在 ByteArrayOutputStream 中，另一份在字节数组中（toByteArray() 不返回它创建副本的内部缓冲区）。

调用 reset() 不会释放 ByteArrayOutputStream 内的内存，它只是将位置计数器重置为 0。数据仍然存在。

为了允许更早地释放内存，您可以在完成每个项目后立即将其分配为 null。如果垃圾收集器决定提前运行，这将允许内存被垃圾收集器收集。例如：

```
ImageIO.write(image, "gif", byteArrayO);
image = null;
byte [] byteArray = byteArrayO.toByteArray(); 
byteArrayO = null;
... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:50:50.320

这不是您想要的答案，而是您可能希望考虑的问题。

为什么不创建一个字节数组池并在每次需要时重新使用它们。这将更有效率，因为您不会一直创建新数组并将它们丢弃。使用更少的 gc 总是一件好事。您还可以保证应用程序有足够的内存来一直运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T14:56:25.703

What you are describing is pretty normal. It has to put the bytes of the image you are creating somewhere.

Instead of memory you can use a FileOutputStream to write the bytes to. You then have to make a FileInputStream to read from the file you wrote to and a loop which reads bytes into a byte array buffer of say 64k size and then writes those bytes to the connection's output stream.

You mention error. If you are getting an error what is the error?

If you use the client JVM (-client argument to java) then the memory might be given back to the OS and the Java process will shrink again. I'm not sure about this.

If you don't like how much memory JAI is using you can try using Sanselan: [http://commons.apache.org/imaging/](http://commons.apache.org/imaging/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T14:07:40.983

您可以请求虚拟机运行垃圾收集，`System.gc()`但这不能保证实际发生。虚拟机在确定有必要或适当的时候执行垃圾收集。

# c# - 使用 ASP.NET 生成可在 Android 上下载的 vCard

> ID：11970746
> 
> 赞同：4
> 
> 时间：2012-08-15T14:04:38.723
> 
> 标签：c#, android, asp.net, vcf-vcard

很长一段时间以来，我一直在尝试使用 ASP.NET (C#) 生成可以下载到 Android 设备上的 vCard。

生成卡片的过程非常简单，所以我不太担心。这是我无法开始工作的下载本身。

我将 vCard 附加到页面响应的代码如下所示：

```
public void downloadCard()
{
    //generate the vCard text
    string vCard = generateCard();

    //create the filename the user will download the file as
    string filename = HttpUtility.UrlEncode(username + ".vcf", System.Text.Encoding.UTF8);

    //get a reference to the response
    HttpResponse response = HttpContext.Current.Response;

    //clear the response and write our own one.
    response.Clear();
    response.ContentType = "text/x-vcard";
    response.AddHeader("Content-Disposition", "attachment; filename=" + filename + ";");
    response.Write(vCard);
    response.End();
} 
```

我不会费心展示生成过程，因为它并不是很重要，尽管页面采用的唯一参数是用于通过 RESFUL URL 接收的用户名，这要归功于 web.config 文件中的一些 URL 重写。因此 URL example.com/vcard/apbarratt 为用户 apbarratt 生成 vCard。

GET 请求为此代码生成的响应如下所示：

```
200 OK
Date: Wed, 15 Aug 2012 13:49:56 GMT
X-AspNet-Version: 4.0.30319
X-Powered-By: ASP.NET
Content-Disposition: attachment; filename=apbarratt.vcf;
Content-Length: 199
Server: Microsoft-IIS/7.5
Content-Type: text/x-vcard; charset=utf-8
Cache-Control: private
BEGIN:VCARD
VERSION:2.1
N;LANGUAGE=en-us:Andy Barratt
FN:Andy Barratt
TEL;CELL;VOICE:07000000000
URL;WORK:http://example.com
EMAIL;INTERNET:apbarratt@example.com
END:VCARD 
```

这在我测试过的每一个浏览器中都能完美运行（不是 iOS，这是另一个以另一种方式解决的问题），除了 Android 股票浏览器。在这些浏览器中，下载失败，文件名“未知”和“失败”一词，或者在其他设备上，用户名“apbarratt.vcf”和“进行中”一词似乎永远不会改变。

该问题在其他浏览器（例如opera mobile/mini）中不是问题。

我已经尝试了我能想到的所有可能的事情，阅读了很多关于类似问题的博客，以至于我梦想着整件事……它们真的很无聊……

无论如何，希望一些新鲜的眼睛能够帮助我。也许有人以前做过这个并且可以分享一些代码，期待一些帮助。

安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T19:58:18.990

我遇到了完全相同的问题：除了现有的 Droid Safari 浏览器之外，其他所有浏览器似乎都可以正常工作。我的解决方案是将文件作为文本读取，然后将其转换为 ASCII 字节。一旦我更改了我的代码，Droids（2.3 和 3.2）似乎很高兴。

这是一个代码片段（来自我的基于 MVC 的项目）：

```
public ActionResult GetContact()
{
    Response.Clear();
    Response.AddHeader("Content-disposition", string.Format("attachment; filename=\"{0}\";", "MyContact.vcf"));

               //  VERY IMPORTANT!!!

               //      Read the file as text, and then convert it to ASCII bytes.  
               //      If ReadAllBytes is used, extra stray characters seem to appear and DROID fails.

               //      Put the content type in the second parameter!!!

    var vCardFile = System.IO.File.ReadAllText(Server.MapPath("~/Contacts/MyContact.vcf"));
    return File(System.Text.Encoding.ASCII.GetBytes(vCardFile), "text/x-vcard");
} 
```

希望这可以帮助...

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T18:24:39.433

不知道你是否解决了，但我遇到了同样的问题，其中一个绊脚石是，N 字段似乎应该有 5 个值，所以你应该在末尾插入一个额外的分号（在您的示例中为 4 个），或者因此：

```
N;LANGUAGE=en-us:Barratt;Andy;;; 
```

另一件事是，最好将内容类型设置为 text/vcard，这是现在的标准。

# assembly - 英特尔 x64 架构的 Rex 前缀解码

> ID：11970750
> 
> 赞同：3
> 
> 时间：2012-08-15T14:05:22.093
> 
> 标签：assembly, x86-64, intel, opcode, machine-code

在英特尔文档[“Architectures Software Developer's Manual Vol 2A”](https://software.intel.com/en-us/articles/intel-sdm#three-volume)中，表 2-4 显示了 REX 前缀位的意义。

有人可以向我解释当 W=0 时如何解释吗？它说`0 = Operand size determined by CS.D`，但我不明白什么`CS.D`意思。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T17:47:45.597

`CS.D`代表与当前代码段相关的*段描述符的“默认操作大小”字段。*这控制地址和操作数的默认大小，并且可以设置为默认为 16 或 32 位操作数大小。

在 64 位又名长模式 (CS.L=1) 中，CS.D 的唯一有效设置 = 32 位，**因此清除了 W 位的 REX 前缀将默认操作数大小保留为 32 位。** （操作数大小前缀可以覆盖操作数大小到 16）。

长模式下的默认地址大小为 64 位（指令上的地址大小前缀将其覆盖为 32）。

* * *

段描述符在*第 3A 卷 - 系统编程指南，第 1 部分*，第*3.4.5章段描述符中有详细**描述***。

*第 1 卷 - 基本架构*的第*3.6章****操作数大小和地址大小属性***`D`也讨论了该字段的影响。

# css - Phonegap xcode jquery mobile css不要加载它

> ID：11970754
> 
> 赞同：1
> 
> 时间：2012-08-15T14:05:34.253
> 
> 标签：css, xcode, load, simulator

我在 xcode 上安装了 phonegap 并创建了一个新项目。我在我的项目中包含了 jquery mobile，但是当我在模拟器上启动它时，它不会加载 css 文件。当我在浏览器中打开相同的代码时，它会加载 jquery mobile 的 css 文件。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:13:27.947

我发现解决此问题的唯一方法是将样式作为标签包含在应用程序的*所有*HTML 页面`<style>`的标题中。

 *必须有更好的方法，但我从来没有让链接的 CSS 文件正常工作。*

# java - 正则表达式，捕获组中的特定最后一个字符类型

> ID：11970756
> 
> 赞同：0
> 
> 时间：2012-08-15T14:05:52.920
> 
> 标签：java, regex

我目前拥有的正则表达式是：

```
"^(?:(\\.\\.)|^([a-z]+[a-z.\\-]*)([\\*]?)[\\[]*([^\\]]*)[\\]]*)$"; 
```

它捕获“..”（第 1 组），第 2-4 组为空
**或**：
- 一组小写字母、点、破折号。以小写字母开头（第 2 组）
- 后跟可选星号（第 3 组）
- 后跟方括号内的可选内容（第 4 组）

我有几个问题，首先是让 group2 必须以字母结尾，我尝试了很多事情，包括：

```
"^([a-z]+[a-z.\\-]*[a-z]$)"
"^([a-z]+[a-z.\\-]*[a-z])$" 
```

杀死 3-4 组中的任何东西

```
"^([a-z]+[a-z.\\-]*[a-z])" 
```

这似乎没有什么不同

* * *

我遇到的另一个问题是第 4 组，它不依赖于方括号（这是有道理的，因为我有 * 字符）......但如果我删除该字符，它不会给我任何结果任何组。

非常需要和感谢任何帮助。

* * *

作为对以下评论的回应，以下内容应匹配：
`"string" - (group1)(group2)(group3)(group4)`

```
".." - (..)()()()
"blah" - ()(blah)()()
"blah.blah" - ()(blah.blah)()()
"blah.blah*" - ()(blah.blah)(*)()
"blah*" - ()(blah)(*)()
"blah.blah*[foobar] - ()(blah.blah)(*)(foobar)
"blah[foobar] - ()(blah)()(foobar) 
```

以下内容不应匹配：

```
 "."
 "..."
 ".blah"
 "blah."
 ".blah*"
 "blah.*[foobar] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:17:18.293

```
 ┌ one or more lowercase letters followed by
                   │ 
                   │   ┌ none or several occurrences of ───────────────────────┐
                   │   │     ┌ dot or dash                                     │
                   │   │     │     ┌ followed by one or more lowercase letters │
                   │   │     │     │     ┌─────────────────────────────────────┘
                   │   │     │     │     │ 
                   │   │     │     │     │  ┌ followed by optional asterisk
                   │   │     │     │     │  │
                   │   │     │     │     │  │   ┌ followed by optional square brackets
            ┌ or   │   │     │     │     │  │   │         ┌ with some content inside │
            │      │   │     │     │     │  │   │         │        ┌─────────────────┘
            │      │   │     │     │     │  │   │         │        │
^(?:(\\.\\.)|(?:([a-z]+(?:[.\\-]*[a-z]+)*)(\\*?)(?:\\[([^\\]]*)\\])?))$
│   │      │                                                          │
│   └ two  │                                                          │
│     dots ┘                                                          │
│                                                                     │
└ start of string                                       end of string ┘ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:24:35.510

这是我能想到的：

```
^(\.{2})?([a-z](?:\.*-*[a-z])*)?(\*)?(\[[^]]*\])?$ 
```

我不确定括号中允许的内容，因此它匹配其中的任何非括号字母。

（正确逃脱 `^(\\.{2})?([a-z](?:\\.*-*[a-z])*)?(\\*)?(\\[[^]]*\\])?$` ：）

此正则表达式：`[a-z](?:\.*-*[a-z])*`将始终匹配以小写字母开头和结尾的字符串。

# python - 在 Python 3 中确定类的元类

> ID：11970757
> 
> 赞同：5
> 
> 时间：2012-08-15T14:05:56.237
> 
> 标签：python, python-3.x, metaclass

在 Python 2 中，我可以检查一个类的`__metaclass__`属性来确定它的元类。

我如何在 Python 3 中做同样的事情？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-15T14:16:29.797

使用单参数`type`函数 ( `type(class)`)，或仅访问`class.__class__`. 顺便说一句，这两种方法都适用于 Python 2。

例如，

```
In [4]: class MyMetaclass(type): pass

In [5]: class MyClass(metaclass=MyMetaclass): pass

In [6]: type(MyClass)
Out[6]: __main__.MyMetaclass 
```

# c++ - 测试主体中抛出代码 0xc00000fd 的 SEH 异常

> ID：11970758
> 
> 赞同：2
> 
> 时间：2012-08-15T14:05:56.480
> 
> 标签：c++, googletest

我正在尝试使用 Google Test 测试课程。这是类定义。

```
class Base
{
    // Some functions

    Signal objSignal[10];
}; 
```

我正在为类 Base 编写测试。如果我不创建类 Signal 的对象 objSignal，我的测试运行良好并且没有问题。但是，当我创建对象时，出现以下错误：

Tests.exe 中 0x01274627 处的第一次机会异常：0xC00000FD：堆栈溢出。未知文件：错误：SEH 异常，代码 0xc00000fd 在测试主体中抛出。

我不确定可能出了什么问题。我试图在基类的析构函数中删除 objSignal。还是一样的错误。

你能帮帮我吗？

此致

钦坦

# jquery - 在 jQuery 代码中使用脚本效果

> ID：11970761
> 
> 赞同：0
> 
> 时间：2012-08-15T14:06:19.467
> 
> 标签：jquery, prototypejs, scriptaculous

jQuery 滑动动画不像脚本化的动画那样断断续续。所以我想用 Scritaculous 替换我的 jQuery .slideUp/Down()

基本上，在这段代码中使用 scriptaculous 向上/向下滑动 ->

```
jQuery('.button').on('click', function(){
jQuery('#box').slideUp();
}); 
```

可能吗？如果是，在上面的代码中使用 sciptaculous 幻灯片的正确方法是什么？

**注意：**我已经在页面中包含了prototype.js，我不想将我所有的jquery代码重写为原型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T23:33:46.623

您想使用 BlindUp 方法

如果您想在元素上使用 scriptaculous，我建议您使用prototypejs 附加事件-您不必这样做。

根据您的示例 jquery 代码，您将附加到所有`.button`类元素的 click 事件 - 下面的等效代码。

```
$$(".button").invoke("观察","点击",function(){
    $("盒子").blindUp()
});

```

[http://madrobby.github.com/scriptaculous/effect-blindup/](http://madrobby.github.com/scriptaculous/effect-blindup/)

# wpf - Prism 和 Ribbon：使用命令跨越区域

> ID：11970762
> 
> 赞同：1
> 
> 时间：2012-08-15T14:06:25.767
> 
> 标签：wpf, prism, ribboncontrolslibrary

我正在使用 Prism 构建复合 WPF 应用程序并使用功能区库。我遇到困难的一件事是跨区域命令。

例如，我的“RibbonRegion”中有一个功能区，“MainRegion”中有一个网格视图。假设我希望我的功能区中的一个按钮在网格视图中弹出一个带有当前选定项目的消息框，我该怎么做？

最简单的方法是使用 EventAggregator 但我担心如果我有一堆订阅者只是为了点击按钮而连接我只是在询问内存泄漏问题。

有没有办法拥有一个跨区域命令，以便单击我的“RibbonRegion”中的一个按钮将在网格视图中获取所选项目并弹出一个带有该值的消息框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T18:42:38.747

你可以使用一个`System.Windows.Input.RoutedUICommand`

首先，您需要如下声明您的命令：

```
public static class Commands
{
    public static readonly RoutedUICommand TestCommand = new RoutedUICommand("Test Command",
        "Test Command", typeof(Commands));
} 
```

然后在您的 RibbonRegion xaml 中：

```
<my:RibbonButton Command="{x:Static cmd:Commands.TestCommand}" ... 
```

然后在您的 MainRegion xaml 中：

```
<UserControl.CommandBindings>
    <CommandBinding CanExecute="OnTestCanExecute"
                    Command="{x:Static cmd:Commands.TestCommand}"
                    Executed="OnTestExecute" />
</UserControl.CommandBindings> 
```

然后在您的 xaml.cs 中：

```
public void OnTestRouteCanExecute(object sender, System.Windows.Input.CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = true;
    }

    public void OnTestRouteExecute(object sender, System.Windows.Input.ExecutedRoutedEventArgs e)
    {
        // do some stuff here
    } 
```

# java - 管理作业调度程序从 Java 应用程序调度时间

> ID：11970763
> 
> 赞同：2
> 
> 时间：2012-08-15T14:06:26.313
> 
> 标签：java, open-source, quartz-scheduler, job-scheduling

我有一个带有许多作业调度程序的 java 应用程序。到目前为止，我一直在使用 cron 作业调度程序来安排和运行这些作业。

现在我正在寻找调度程序中的以下功能：

*   调度（调整作业运行时间）和监控来自我的 Web 应用程序的作业
*   如果可能，请查看我的工作活动，如日志、运行时间等。

我不确定 cron 作业是否可以做到这一点。我读到**Quartz**非常适合此类活动。是这样吗？或者有任何其他更好的作业调度程序可以执行上述任务。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:08:56.007

如果您的 Web 应用程序是基于 Spring 的，我强烈推荐 JMS 控制台和 JMS 集成。它是基于注释的。您可以快速将任何 POJO 转换为 JMS 功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:11:34.533

我一直在成功使用 SOS Job Scheduler 来运行许多作业。您可以即时调整时间并检查它产生的日志。它在服务器上本地运行，并具有允许您执行所需操作的 Web 界面。

这是他们的主页： [http ://www.sos-berlin.com/modules/cjaycontent/index.php?id=osource_scheduler_introduction_en.htm](http://www.sos-berlin.com/modules/cjaycontent/index.php?id=osource_scheduler_introduction_en.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T16:59:58.823

Quartz 将是建立您的需求的良好基础。Quartz 提供监控 API，包括[枚举（CRON）触发器](http://quartz-scheduler.org/api/2.1.5/org/quartz/core/QuartzScheduler.html#getTriggerKeys(org.quartz.impl.matchers.GroupMatcher))、[查找下一次触发时间](http://quartz-scheduler.org/api/2.1.5/org/quartz/Trigger.html#getNextFireTime())、[记录作业执行](http://quartz-scheduler.org/api/2.1.5/org/quartz/plugins/history/LoggingTriggerHistoryPlugin.html)等。还有 3rd-party 插件[来监控过去的触发器](http://code.google.com/p/myschedule/wiki/QuartzExtraUserGuide)。

# 也可以看看

*   [https://stackoverflow.com/questions/1267737](https://stackoverflow.com/questions/1267737)

# jquery - 包含文件输入字段的居中 jQuery UI 对话框在 FF 中不起作用

> ID：11970765
> 
> 赞同：1
> 
> 时间：2012-08-15T14:06:36.900
> 
> 标签：jquery, jquery-ui, firefox, dialog

到目前为止，我已经广泛使用了 jQueryUi 对话框，没有任何问题。

我的问题是：如果我有一个带有文件输入字段的 div，并且我想用“幻灯片”过渡显示它，我在 Firebug 中收到以下错误：

`NS_ERROR_XPC_SECURITY_MANAGER_VETO: Security Manager vetoed action arg 0 [nsIDOMHTMLDivElement.compareDocumentPosition] file:///H:/Trabajo/Layout/2012jQueryMulti/js/jquery-1.8.0.js Line 4436`

对话框出现，但它位于左侧而不是中心。IE 工作正常。

这是一个失败的示例（使用 FF 14.0.1 测试）：

```
<html>
<head>
  <title>Test</title>
  <style type="text/css"> 
    div#infoFrame { border: 2px solid black; height: 300px; }
  </style>
</head>
<body>
  <form name="Form" method="post" action="list.do">
    <div id="infoFrame" style="display:none;">
      <input type="file" name="myFile">
    </div>  
  </form>
  <script src="js/jquery-1.8.0.js" type="text/javascript"></script>
  <script src="js/jquery-ui-1.8.22.custom.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    $('#infoFrame').dialog({modal: true, width: 500, show: 'slide'});
  </script>
</body>
</html> 
```

如果我从对话框中删除过渡，它工作得很好：

```
$('#infoFrame').dialog({modal: true, width: 500}); 
```

这让我快疯了。有任何想法吗？

# grep - 设置 pcregrep 颜色默认值

> ID：11970771
> 
> 赞同：2
> 
> 时间：2012-08-15T14:06:51.493
> 
> 标签：grep, defaults

我知道您可以使用环境变量`$GREP_OPTIONS`和设置 grep 颜色默认值`$GREP_COLOR`，但我似乎找不到任何方法来设置默认颜色选项`pcregrep`...

我现在有`export GREP_OPTIONS='--color=auto'`and`export GREP_COLOR='31'`在我的 /etc/profile 中，并且希望对`pcregrep`.

tldr：我如何`pcregrep`默认进行颜色匹配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T23:24:32.033

我从来没有弄清楚如何做我想要的，但我使用别名得到了相同的最终结果：

`alias pcregrep='pcregrep --color=auto'`

# module - 玩！2.0.2和Mailer模块

> ID：11970773
> 
> 赞同：1
> 
> 时间：2012-08-15T14:06:55.797
> 
> 标签：module, playframework-2.0

我正在尝试使用[邮件模块](https://github.com/typesafehub/play-plugins/tree/master/mailer)进行播放！2.0.3/斯卡拉。

1）更新`Build.scala`无助于使课程可用-我需要`play clean`吗？我最后残忍地把一个罐子扔进了`lib`.

2）比较疑惑，`use[]`教程中的方法是什么？( `use[MailerPlugin].email`)? 我从未在导入中看到它，也没有在教程的导入中看到它。

构建.scala：

```
import sbt._
import Keys._
import PlayProject._

object ApplicationBuild extends Build {

    val appName         = "some-some"
    val appVersion      = "1.0-SNAPSHOT"

    val appDependencies = Seq(
        "org.mindrot" % "jbcrypt" % "0.3m",
        "com.typesafe" %% "play-plugins-mailer" % "2.0.4"
    )

    val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
      // Add your own project settings here      
    )

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:09:41.973

1) 这只是 IDE (IntelliJ IDEA) 中的一个问题。

为了让它获取 Build.scala 依赖项，运行`play dependencies`和`play idea`. 新项目将包含 Maven 依赖项。

2）我应该更加专心。

编译器错误本身显示“添加导入 play.api.Play.current”，这确实解决了问题。

# iphone - 如何确定 iOS6 Safari 浏览器是全屏还是浏览器模式？

> ID：11970776
> 
> 赞同：0
> 
> 时间：2012-08-15T14:06:58.617
> 
> 标签：iphone, web, ios6

我正在 javascript/html5/css 中开发 Web 应用程序，在全屏和浏览器模式下具有不同的布局。如果用户在 iOS6 上在全屏和浏览器模式之间切换，有什么方法可以终止。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T21:04:03.843

```
var isOpenFromHomeScreen = navigator.standalone; //true false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-24T15:50:32.660

你可以在php中构建一个函数

就像是：

```
$user_agent     =   $_SERVER['HTTP_USER_AGENT'];

    function getBrowser() {
            global $user_agent;
            $browser        =   "Unknown Browser";
            $browser_array  =   array(
                                    '/msie/i'       =>  'Internet Explorer',    //Old version from IE
                                    '/Trident/i'    =>  'Internet Explorer',    //New version from IE
                                    '/firefox/i'    =>  'Firefox',
                                    '/safari/i'     =>  'Safari',
                                    '/chrome/i'     =>  'Chrome',
                                    '/opera/i'      =>  'Opera',
                                    '/netscape/i'   =>  'Netscape',
                                    '/maxthon/i'    =>  'Maxthon',
                                    '/konqueror/i'  =>  'Konqueror',
                                    '/mobile/i'     =>  'Handheld Browser'
                                );
            foreach ($browser_array as $regex => $value) { 
                if (preg_match($regex, $user_agent)) {
                    $browser    =   $value;
                }
            }
            return $browser;
        } 
```

然后你可以用它做你想做的事，比如：`echo getBrowser();`或者根据答案改变css。

# android - 如何传递哈希图 > 到一个简单的适配器？

> ID：11970782
> 
> 赞同：0
> 
> 时间：2012-08-15T14:07:20.410
> 
> 标签：android, hashmap, adapter, arrays

我有一个`ListView`以这种方式填充的简单适配器：

```
adapter = new SimpleAdapter(this, mylist ,   
                    R.layout.itemlist, new String[] { "item1", "items2" }, 
                    new int[] { R.id.item_id, R.id.item_title }); 
```

我调整了我的代码，`hashmap<string, hashmap<string,string>>`现在有一个，我无法将它传递给`new string[]{"item1","item2"};`

我应该如何解决这个问题？

这是我的 XML 结构：

```
<groups>
  <group>
    <id>...</id>
    <name>...</name>
    <description>...</description>
    <actions>
      <action>...</action>
      <action>...</action>
    </actions>
  </group>
  <group>
    <id>...</id>
    <name>...</name>
    <description>...</description>
    <actions>
      <action>...</action>
      <action>...</action>
      <action>...</action>
    </actions>
  </group>
  <group>
    <id>...</id>
    <name>...</name>
    <description>...</description>
    <actions>
      <action>...</action>
    </actions>
  </group>
</groups> 
```

我准备但卡住的代码是这样的：

```
public class ErrorCodeList extends ListActivity {

public static final String LANGUAGE = null;

public ArrayList<HashMap<String, String>> mylist;
public ListAdapter adapter;
public Dialog progDialog;
public ProgressBar progBar;
public TextView lblMessage;

private Intent myIntent;
private String  URLvariable;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listplaceholder);

    myIntent = getIntent();
    URLvariable = myIntent.getExtras().getString("urlType");

    mylist = new ArrayList<HashMap<String, String>>();

    adapter = new SimpleAdapter(this, mylist , R.layout.activity_error_list, 
                    new String[] { "tid", "tname" }, 
                    new int[] { R.id.item_id, R.id.item_title });

    final ListView lv = getListView();
    lv.setTextFilterEnabled(true);  
    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {              
            @SuppressWarnings("unchecked")
            HashMap<String, String> hashMap = (HashMap<String, String>) lv.getItemAtPosition(position);                 

            Intent myIntent = new Intent(view.getContext(),ErrorCodeDetails.class);
            myIntent.putExtra("map",hashMap);
            startActivity(myIntent);

        }
    });

    progDialog = new Dialog(this, R.style.progress_dialog);
    progDialog.setContentView(R.layout.progress_dialog);

    progBar = (ProgressBar) progDialog.findViewById(R.id.progBar);
    lblMessage = (TextView) progDialog.findViewById(R.id.txtProgMessage);
    lblMessage.setText("Please Wait.....");

    progDialog.show();
    new GetDataTask().execute();        

}

private Boolean isOnline()  {
    ConnectivityManager cm = (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
    NetworkInfo ni = cm.getActiveNetworkInfo();
    if(ni != null && ni.isConnected())
        return true;

    return false;
}

private class GetDataTask extends AsyncTask<Void, Void, Integer> {

    @Override
    protected Integer doInBackground(Void... params) {

        if(isOnline()){
            mylist.clear();                  
            }  

            // Start the http request
            String feedURL="http://...";        
            String xml = XMLfunctions.getXML(feedURL);
            Document doc = XMLfunctions.XMLfromString(xml);

            int numResults = 1;

            if((numResults <= 0)){
                Toast.makeText(ErrorCodeList.this, "Geen resultaten gevonden", Toast.LENGTH_LONG).show();  
                finish();
            }

            NodeList troubles = doc.getElementsByTagName("trouble");

            for (int i = 0; i < troubles.getLength(); i++) {                            
                HashMap<String, String> map = new HashMap<String, String>();    

                Element e = (Element)troubles.item(i);
                if((e.getAttributes().getNamedItem("type").getNodeValue().equals("error"))) {
                    //map.put("id", "ID:" + Integer.valueOf(e.getAttributes().getNamedItem("id").getNodeValue()));
                    //map.put("status", "Status:" + (e.getAttributes().getNamedItem("status").getNodeValue()));
                    map.put("tid", XMLfunctions.getValue(e, "id"));
                    map.put("tname", XMLfunctions.getValue(e, "name"));
                    map.put("tdescription", XMLfunctions.getValue(e, "description"));

                    mylist.add(map);
                }           
            }
            System.out.println(mylist);
        }else{
            Toast.makeText(ErrorCodeList.this, "No connection..", Toast.LENGTH_LONG).show();            
        }

        return 1;
    }

    @Override
    protected void onPostExecute(Integer result) {

        setListAdapter(adapter);
        progDialog.dismiss();
        super.onPostExecute(result);
    }
}
} 
```

这是在我尝试嵌套 hasmaps 之前。这是否阐明了我的目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:24:17.183

的构造函数`SimpleAdapter`需要 a `List<Map<String, String>>`，而不是`Map<String, Map<String, String>>`你所拥有的 a 。

你的内心是否有理由`Map`需要被另一个`Map`而不是被 a 包含`List`？如果没有，您可以更改类型。如果是这样，您可以使用以下内容提取`List`内部`Map`对象：

```
asList = new ArrayList<Map<String, String>>(outerMap.values()); 
```

* * *

注意：我假设您`Map`包含列表中每一行的数据，如此处所[指定](http://developer.android.com/reference/android/widget/SimpleAdapter.html#SimpleAdapter%28android.content.Context,%20java.util.List%3C?%20extends%20java.util.Map%3Cjava.lang.String,%20?%3E%3E,%20int,%20java.lang.String%5B%5D,%20int%5B%5D%29)。例如：

```
// Create an example row (you'd have many rows)
Map<String, String> row = new HashMap<String, String>();
row.put("author", "George Orwell");
row.put("title", "Nineteen Eighty-Four");
row.put("year", "1949");

// Create an example list of rows (this would contain many maps)
List<Map<String, String>> rows = new ArrayList<Map<String, String>>();
rows.add(row); 
```

`rows`将替换`myList`您上面的问题。您仍然有一个`String[]`包含来自`Map`(author, title, year) 的键，并且您仍然有一个`int[]`包含资源 ID `View`s 的布局中的关联值应该出现的位置（例如，`TextView`在您的 XML 布局中对 s的引用像`R.id.author`,`R.id.title`和`R.id.year`)。

# java - 使用 + 运算符分配字符串内存

> ID：11970785
> 
> 赞同：3
> 
> 时间：2012-08-15T14:07:23.317
> 
> 标签：java, string, memory, memory-management, heap-memory

`String a = "abc";`
`String b = "xyz";`
`String result = a + b;`

我想知道“结果”字符串是字符串池中分配的字符串常量内存还是在堆上创建的新对象。

我知道 new String() 在 permgen 字符串池空间中的上述示例中创建堆上的对象和字符串常量，如 a,b。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T14:14:27.700

重要说明：

```
String a = "abc";
String b = "xyz";
String result = a + b; 
```

是相同的

```
// creates a number of objects.
String result = new StringBuilder().append(a).append(b).toString(); 
```

但

```
final String a = "abc";
final String b = "xyz";
String result = a + b; 
```

是相同的

```
String result = "abcxyz"; // creates no new objects. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:12:47.933

如果你编译和反编译你的代码，它会给出以下结果：

```
String result = new StringBuilder().append(a).append(b).toString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:13:21.380

连接导致分配一个 StringBuilder 来创建连接的字符串。

来源：

```
public class Hello {

    public static final String CONST1 = "cafe";
    public static final String CONST2 = "babe";

    public static void main(String[] args){
        String a = "abc";
        String b = "xyz";
        String result = a + b;

        String result2 = CONST1 + CONST2;
    }
} 
```

通过 javap 反汇编：

```
public class Hello extends java.lang.Object{
public static final java.lang.String CONST1;

public static final java.lang.String CONST2;

public Hello();
  Code:
   0:   aload_0
   1:   invokespecial   #1; //Method java/lang/Object."<init>":()V
   4:   return

public static void main(java.lang.String[]);
  Code:
   0:   ldc     #2; //String abc
   2:   astore_1
   3:   ldc     #3; //String xyz
   5:   astore_2
   6:   new     #4; //class java/lang/StringBuilder
   9:   dup
   10:  invokespecial   #5; //Method java/lang/StringBuilder."<init>":()V
   13:  aload_1
   14:  invokevirtual   #6; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   17:  aload_2
   18:  invokevirtual   #6; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   21:  invokevirtual   #7; //Method java/lang/StringBuilder.toString:()Ljava/lang/String;
   24:  astore_3
   25:  ldc     #8; //String cafebabe
   27:  astore  4
   29:  return

} 
```

您可以`StringBuilder`在第 10 行看到用于连接 String`a`和`b`. 注意 CONST1 和 CONST2 的连接由编译器在第 25 行处理。所以如果你的字符串是`final`它不会导致`StringBuilder`分配

# apache - CF10 mod_jk.so 不会与 RHEL 5.6 和 Apache httpd 2.2.3 一起加载

> ID：11970793
> 
> 赞同：2
> 
> 时间：2012-08-15T14:07:55.167
> 
> 标签：apache, tomcat, coldfusion, mod-jk, rhel

有没有人对此有解决方案...运行 RHEL 5.6，使用 Apache httpd 2.2.3-65.el5_8 并在尝试启动网络服务器时出现此错误：

> httpd：/etc/httpd/conf/httpd.conf 第 445 行的语法错误：/etc/httpd/conf/mod_jk.conf 第 2 行的语法错误：无法加载 /data/cf10/config/wsconfig/1/mod_jk .so 进入服务器：/data/cf10/config/wsconfig/1/mod_jk.so：未定义符号：ap_get_server_description

我浏览了整个 Google，有一些建议可以编译我自己的连接器，但我需要 Adob​​e 提供的用于 CF10 的连接器。adobe 网站还列出了与 Apache HTTPD 2.2.21 的 CF10 兼容性，以及与 RedHat Enterprise 他们不向上移动版本号，它在应用程序存储库中得到反向修补......任何帮助都会很棒。

我们距离 CF10 上线（或计划上线）还有 50 天，并且真的可以使用一些帮助来解决这个问题。

作为对这里的一张海报的回应，我确实验证了我在基于 x64 OS 的系统中使用了 x64 连接器。

* * *

来自 Adob​​e 的回复 w/ SOLUTION！

这是响应和解决方法：您可以从以下“RHEL_mod_jk.zip”网络链接下载连接器： [http ://helpx.adobe.com/coldfusion/kb/rhel-connector-configuration.html](http://helpx.adobe.com/coldfusion/kb/rhel-connector-configuration.html)

请注意，您可以继续安装，选择最初不配置 Web 服务器。安装 CF 后，您可以继续使用位于 \ColdFusion10\cfusion\runtime\bin 的 wsconfig 工具创建连接器

在[http://help.adobe.com/en_US/ColdFusion/10.0/Admin/WSc3ff6d0ea77859461172e0811cbf364104-7fd9.html](http://help.adobe.com/en_US/ColdFusion/10.0/Admin/WSc3ff6d0ea77859461172e0811cbf364104-7fd9.html)找到说明 连接器就位后，您只需导航到 \ColdFusion10\config\wsconfig\ 文件夹并替换 mod_jk .so 文件与下载的副本并重新启动 Apache。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-16T17:36:15.203

我想在讨论中添加我在 CF 安装问题方面的经验。我在安装 CF 时遇到了两个常见问题，这些问题一直如此一致，以至于我写了一篇简短的“如何做”博文，这样下次我需要部署另一台服务器时就不会忘记了。虽然我的博客文章涉及 CF 10 和 Cent OS 6.4，但这种方法在我记忆中一直有效（例如：CF 8）

[http://www.greenvalleyconsulting.org/2013/05/16/installation-problem-coldfusion-10-and-centos-6-x/](http://www.greenvalleyconsulting.org/2013/05/16/installation-problem-coldfusion-10-and-centos-6-x/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-10T09:09:22.473

来自 Adob​​e 的回复 w/ SOLUTION！

这是响应和解决方法：您可以从以下“RHEL_mod_jk.zip”网络链接下载连接器：[http ://helpx.adobe.com/coldfusion/kb/rhel-connector-configuration.html](http://helpx.adobe.com/coldfusion/kb/rhel-connector-configuration.html)

请注意，您可以继续安装，选择最初不配置 Web 服务器。安装 CF 后，您可以继续使用位于 \ColdFusion10\cfusion\runtime\bin 的 wsconfig 工具创建连接器

在[http://help.adobe.com/en_US/ColdFusion/10.0/Admin/WSc3ff6d0ea77859461172e0811cbf364104-7fd9.html](http://help.adobe.com/en_US/ColdFusion/10.0/Admin/WSc3ff6d0ea77859461172e0811cbf364104-7fd9.html)找到说明连接器就位后，您只需导航到 \ColdFusion10\config\wsconfig\ 文件夹并替换 mod_jk .so 文件与下载的副本并重新启动 Apache。

# jquery - 是否可以在淘汰绑定声明中使用 jquery？

> ID：11970797
> 
> 赞同：1
> 
> 时间：2012-08-15T14:08:03.877
> 
> 标签：jquery, jquery-selectors, knockout.js

是否可以在淘汰绑定声明中使用 jquery？例如，我试图通过单击“全部”复选框来选择一组复选框。这就是我试图声明点击绑定的方式：

```
selectAll.bind($parent, $(this).is('checked')) 
```

但这似乎不起作用。我在 Chrome 中收到以下异常：

```
Uncaught Error: Unable to parse bindings.
Message: TypeError: Cannot call method 'toLowerCase' of undefined;
Bindings value: click: $parent.selectAllFacets.bind($parent, $(this).is('checked')) 
```

这可能吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:23:24.603

JFTR，使用“jQuery”而不是“$”。具体来说，对于上面的例子：

```
function(data, event) {selectAll($parent, jQuery(event.target).is(':checked'))} 
```

我无法使用“绑定”使其工作，但这个答案应该更兼容跨浏览器。

希望能帮助到你。

# php - 显示日期 31-12-1969

> ID：11970798
> 
> 赞同：-4
> 
> 时间：2012-08-15T14:08:05.850
> 
> 标签：php, database, date

我使用了数据库中归档的日期。我的 PHP 页面显示：

```
31-12-1969 
```

如何避免这种情况并显示日期空白或 0:0:0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:10:59.807

如您所知，UNIX 时间戳描述了从 1970 年 1 月 1 日午夜开始的秒数。因此，您的 0:0:0 没有任何意义，而 31-12-1969 实际上意味着~~零，零~~数据具有有效格式但自 UNIX 时代以来，在时间轴上没有任何位置。因此，如果您正确评估它，它是空白的。

（感谢Leigh的观察）

# tsql - 连接来自联接查询的字段

> ID：11970799
> 
> 赞同：0
> 
> 时间：2012-08-15T14:08:06.857
> 
> 标签：tsql, concatenation, for-xml-path

我需要使用来自使用 INNER JOIN 和 LEFT JOIN 的 T-SQL 查询的连接结果来更新字段。我可以通过更简单的查询使用 STUFF 和 FOR XML PATH 函数来做到这一点，但是我用更复杂的查询来完成相同过程的努力没有成功。

这是一个查询，它为我提供了我需要的结果，ID 字段最终将作为分组，而 Step 字段将是连接值需要位于每个 ID 的一个字段中的那个。

```
SELECT sc.ID, sc.STEP
FROM Table1 As sc
INNER JOIN Table2 As f
    ON sc.STEP = f.Step AND sc.STEP_TYPE = f.StepType AND   
sc.OldStep = f.OldStep
LEFT JOIN Table3 As l
ON sc.ID = l.ID
WHERE f.Group = l.Group AND sc.CompDate IS NULL 
```

这将使我的结果分解为每个 ID 的多个字段

## •ID-----STEP

*   01 - 101
*   01 - 102
*   01 - 103
*   02 - 107
*   02 - 113

我需要的是：

## •ID-----STEP

*   01 - 101、102、103
*   02 - 107, 113

这是我到目前为止所尝试的：

```
;With OA As 
(   SELECT s.ID, STUFF((
    SELECT ', ' + sc.STEP
    FROM Table1 As sc
    WHERE sc.ID = s.ID
    ORDER BY sc.ID
    FOR XML PATH('')),1,1,'') As Steps
FROM Table1 As s
INNER JOIN Table2 As f
    ON s.STEP = f.Step AND s.STEP_TYPE = f.StepType 
            AND s.OldStep = f.OldStep
LEFT JOIN Table3 As l
    ON s.ID = l.ID
WHERE f.Group = l.Group AND s.CompDate IS NULL
GROUP BY s.ID
)

SELECT * FROM OpenAuditSteps 
```

这里的问题是我得到了所有记录的串联，而不仅仅是按个人 ID 分组的记录。我尝试了各种安排连接的方法，但到目前为止没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:23:50.277

你就快到了：你的第一个查询已经在工作了。假设结果进入#Table1 然后

```
SELECT  Distinct
        sc1.ID,
    STUFF (( Select  ',' + sc2.STEP 
    FROM #Table1 AS SC2
    WHERE sc2.ID = sc1.ID
    FOR XML PATH('')),1,1,'') AS STEPS
FROM #Table1 AS SC1
ORDER BY sc1.ID 
```

因此，要使用 WITH 将其组合成一个查询，请尝试以下操作：

```
 ;WITH IDSteps AS (
SELECT sc.ID, sc.STEP
FROM Table1 As sc
INNER JOIN Table2 As f
    ON sc.STEP = f.Step AND sc.STEP_TYPE = f.StepType AND   
sc.OldStep = f.OldStep
LEFT JOIN Table3 As l
ON sc.ID = l.ID
WHERE f.Group = l.Group AND sc.CompDate IS NULL
)
SELECT  Distinct
        sc1.ID,
    STUFF (( Select  ',' + sc2.STEP 
    FROM IDSteps AS SC2
    WHERE sc2.ID = sc1.ID
    FOR XML PATH('')),1,1,'') AS STEPS
FROM IDSteps AS SC1
ORDER BY sc1.ID; 
```

# c++ - 无法将字符串转换为 const char

> ID：11970803
> 
> 赞同：3
> 
> 时间：2012-08-15T14:08:30.370
> 
> 标签：c++, string, char, strlen

我有这个函数，编译器对我大喊“无法将字符串转换为 const char”。

```
void 
DramaticLetters(string s, short TimeLength)
{
    for(int i = 0, sLen = strlen(s); i < sLen; i++){
        cout << s[i];
        Sleep(TimeLength);
    }
} 
```

我认为strlen有问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T14:11:36.280

`strlen()`用于 C`const char*`字符串。要获取字符串的长度`s`，请使用`s.size()`或`s.length()`。如果要从 a 中获取 C 字符串`string`，请使用`s.c_str()`.

尽管 C++ 使它*看起来*可以互换，但在`const char*`转换为.`string``const char*``string`

您没有理由要使用`strlen`其中任何一个。`strlen`最有可能用循环定义，它永远不会像 一样有效`size()`，这很可能只是`string`类的长度属性的吸气剂。只有`string`在调用没有 C++ 替代方案的 C 函数时才转换为 C 字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:12:03.250

您不应混合使用 C 和 C++ 字符串函数。而不是`strlen()`（一个C风格的函数），使用[`string::size()`](http://en.cppreference.com/w/cpp/string/basic_string/size)：

```
for(int i = 0, sLen = s.size(); i < sLen; i++) {
    cout << s[i];
    Sleep(TimeLength);
} 
```

在这里，您可以[参考](http://en.cppreference.com/w/cpp/string/basic_string)class 中的所有方法`string`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:12:14.653

正如克里斯在他的评论中所说， strlen 用于 a `const char *`，而您将其传递给 a `string`。代替

```
for(int i = 0, sLen = strlen(s); i < sLen; i++){
    cout << s[i];
    Sleep(TimeLength);
} 
```

用这个：

```
for(int i = 0, sLen = s.length(); i < sLen; i++){
    cout << s[i];
    Sleep(TimeLength);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-15T14:12:30.567

`strlen`上运行`char const *`。如果你真的想，你可以做`strlen(s.c_str())`，但`std::string`有很多功能，包括一个`length()`方法，它返回字符串中的字符数

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T14:12:58.807

几点说明：

*   您不要修改函数内的字符串，因此最好将 const 引用传递给它（const string& s）

*   字符串本身定义了获取其长度的方法 - s.size() 和 s.length() 都可以。额外的好处是这两种方法在复杂性方面都是恒定的，而不是 strlen 的线性复杂性

*   如果您真的想使用 strlen，请使用 s.c_str()：`strlen(s.c_str())`

# jquery - 延迟加载整个 DIV 而不是单个图像

> ID：11970804
> 
> 赞同：1
> 
> 时间：2012-08-15T14:08:31.093
> 
> 标签：jquery, html, css, scroll, lazy-loading

我有一个网页，它是一个侧滚动条。目前所有内容都在页面加载时加载，但这正在变成一个巨大的页面！我对图像等应用了一些延迟加载......但它并不流畅，页面在尝试导航时感觉很尴尬。

有 7 个“窗格”，每个窗格都有一个具有唯一 ID 的父 DIV 标记。我想做的是当窗格 2 进入视图时，显示加载 gif 并且 div 为空白，直到加载所有内容/图像。加载内容/图像后，加载器消失，内容淡入。这将在所有窗格 2 - 7 中重复。

我已经查看了许多 jquery 脚本和方法，但我似乎无法完全理解如何具体实现这一点。这就像延迟加载，但对于整个 div 而不仅仅是图像。我希望页面在后台加载，但要防止用户例如看到尚未下载的窗格 3，显示图像加载的尴尬景象。

这比我意识到的更容易吗？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:40:05.390

您可能想要 jQuery 的[出现插件](http://code.google.com/p/jquery-appear/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-05T17:02:55.067

您可以在过渡和媒体查询中使用 CSS 技巧，类似于我在这里为延迟图像加载所做的：http: [//podlipensky.com/2013/06/css-only-load-images-on-demand/](http://podlipensky.com/2013/06/css-only-load-images-on-demand/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:27:04.537

有很多方法可以实现这一点，我想最简单的一种方法是简单地使用 jQuery get 方法来获取活动幻灯片的实际 HTML：

```
$.get('slide2.html', function(respHTML) {
   $(respHTML).appendTo($("#contentFrame"));
},'html'); 
```

您可以在附加 html 之前选择所有图像并预加载它们，也有多种预加载图像的方法

```
var respHTML = $(respHTML);
var imagesToPreload = respHTML.find('img');
var imagesPreloaded = 0;
var imagesLength = imagesToPreload.length;
imagesToPreload.each(function(i,img) {
    // preload img
    imagesPreloaded++;
    if(imagesPreloaded == imagesLength) {
       // your images are ready
    }
}); 
```

# objective-c - 在 iPad 上启动后出现空白屏幕

> ID：11970806
> 
> 赞同：3
> 
> 时间：2012-08-15T14:08:35.130
> 
> 标签：objective-c, ios, ipad, ios5

一位用户发送了一封电子邮件，说在启动 ipad 应用程序时，他看到启动画面，然后 statusBar 变得可见，之后只有空白屏幕。所以他不能继续使用应用程序。用户拥有装有 iOS 5.1.1 的 iPad3。我已经测试了所有可能的 iOS 版本和不同的使用场景，但无法重现这种情况。有任何想法吗？

启动代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
[[UIApplication sharedApplication] setStatusBarHidden:NO];
[[UIApplication sharedApplication] setStatusBarStyle:UIStatusBarStyleBlackOpaque];

if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad)
{
    self.window.rootViewController = padMainNavigationController;
}
else
{
    self.window.rootViewController = self.tabBarController;
}
NSError *sessionError = nil;
[[AVAudioSession sharedInstance] setDelegate:self];
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayAndRecord error:&sessionError];

// 2\. Changing the default output audio route
UInt32 doChangeDefaultRoute = 1;
AudioSessionSetProperty(kAudioSessionProperty_OverrideCategoryDefaultToSpeaker, sizeof(doChangeDefaultRoute), &doChangeDefaultRoute);
[self.window makeKeyAndVisible];
int cacheSizeMemory = 4*1024*1024; // 4MB
int cacheSizeDisk = 60*1024*1024; // 60MB
NSURLCache *sharedCache = [[[NSURLCache alloc] initWithMemoryCapacity:cacheSizeMemory diskCapacity:cacheSizeDisk diskPath:@"nsurlcache"] autorelease];
[NSURLCache setSharedURLCache:sharedCache];

return YES;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T04:16:21.563

请参阅[使用 navigationController](https://stackoverflow.com/questions/7422658/white-screen-using-navigationcontroller)的白屏- 它解决了我的问题，类似于 OP 中描述的问题。

# c# - 选择所有datagridview行到另一个gridview

> ID：11970807
> 
> 赞同：0
> 
> 时间：2012-08-15T14:08:37.103
> 
> 标签：c#, excel

我正在尝试将第一个 datagridview 中的所有行复制到第二个，但我不希望第一个 datagridview 中的空行，我需要重新格式化第二个 datagridview 的布局。这让我发疯 - 需要帮助。

```
 private void btnConvert_Click(object sender, EventArgs e)
    {
    dgvData.SelectAll();

    DataTable dt = new DataTable();
        DataColumn dc;
        DataRow dr;

        //build cols
        dc = new DataColumn();
        dc.DataType = System.Type.GetType("System.String");
        dc.ColumnName = "DS";
        dc.Unique = false;
        dt.Columns.Add(dc);

        dc = new DataColumn();
        dc.DataType = System.Type.GetType("System.String");
        dc.ColumnName = "GLAccount";
        dc.Unique = false;
        dt.Columns.Add(dc);

        dc = new DataColumn();
        dc.DataType = System.Type.GetType("System.String");
        dc.ColumnName = "SubAccount";
        dc.Unique = false;
        dt.Columns.Add(dc);

        dc = new DataColumn();
        //dc.DataType = System.Type.GetType("System.DateTime");
        dc.DataType = System.Type.GetType("System.String");
        dc.ColumnName = "Date";
        dc.Unique = false;
        dt.Columns.Add(dc);

        dc = new DataColumn();
        dc.DataType = System.Type.GetType("System.String");
        dc.ColumnName = "Description";
        dc.Unique = false;
        dt.Columns.Add(dc);

        dc = new DataColumn();
        dc.DataType = System.Type.GetType("System.Decimal");
        dc.ColumnName = "Amount";
        dc.Unique = false;
        dt.Columns.Add(dc);

        //build rows
        foreach (DataGridViewRow row in this.dgvData.SelectedRows)
        {
            //how do i prevent copying over the empty row which happens to be the last row in the first datagridview?

        int i;
        i = dgvData.SelectedCells[0].RowIndex; //should this start with the first row?
        int month = 12;
        DateTime y = DateTime.Now;
        int year = y.Year;

        for (int ir = 1; ir <= month; ir++)
        {
            dr = dt.NewRow();
            dr["DS"] = dgvData.Rows[i].Cells[0].Value.ToString();
            dr["GLAccount"] = dgvData.Rows[i].Cells[1].Value.ToString();
            dr["SubAccount"] = dgvData.Rows[i].Cells[2].Value.ToString();

            if (ir == 7)
            {
                dr["Date"] = "1/01/" + (year + 1).ToString();
            }
            else if (ir == 8)
            {
                dr["Date"] = "2/01/" + (year + 1).ToString();
            }
            else if (ir == 9)
            {
                dr["Date"] = "3/01/" + (year + 1).ToString();
            }
            else if (ir == 10)
            {
                dr["Date"] = "4/01/" + (year + 1).ToString();
            }
            else if (ir == 11)
            {
                dr["Date"] = "5/01/" + (year + 1).ToString();
            }
            else if (ir == 12)
            {
                dr["Date"] = "6/01/" + (year + 1).ToString();
            }
            else if (ir == 1)
            {
                dr["Date"] = "7/01/" + year.ToString();
            }
            else if (ir == 2)
            {
                dr["Date"] = "8/01/" + year.ToString();
            }
            else if (ir == 3)
            {
                dr["Date"] = "9/01/" + year.ToString();
            }
            else if (ir == 4)
            {
                dr["Date"] = "10/01/" + year.ToString();
            }
            else if (ir == 5)
            {
                dr["Date"] = "11/01/" + year.ToString();
            }
            else
            {
                dr["Date"] = "12/01/" + year.ToString();
            }

            dr["Description"] = dgvData.Rows[i].Cells[3].Value.ToString();

            if (ir == 7)
            {
                if (dgvData.Rows[i].Cells[10].Value == null || dgvData.Rows[i].Cells[10].Value == "" || dgvData.Rows[i].Cells[10].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[10].Value);
                }
            }
            else if (ir == 8)
            {
                if (dgvData.Rows[i].Cells[11].Value == null || dgvData.Rows[i].Cells[11].Value == "" || dgvData.Rows[i].Cells[11].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[11].Value);
                }
            }
            else if (ir == 9)
            {
                if (dgvData.Rows[i].Cells[12].Value == null || dgvData.Rows[i].Cells[12].Value == "" || dgvData.Rows[i].Cells[12].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[12].Value);
                }
            }
            else if (ir == 10)
            {
                if (dgvData.Rows[i].Cells[13].Value == null || dgvData.Rows[i].Cells[13].Value == "" || dgvData.Rows[i].Cells[13].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[13].Value);
                }
            }
            else if (ir == 11)
            {
                if (dgvData.Rows[i].Cells[14].Value == null || dgvData.Rows[i].Cells[14].Value == "" || dgvData.Rows[i].Cells[14].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[14].Value);
                }
            }
            else if (ir == 12)
            {
                if (dgvData.Rows[i].Cells[15].Value == null || dgvData.Rows[i].Cells[15].Value == "" || dgvData.Rows[i].Cells[15].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[15].Value);
                }
            }
            else if (ir == 1)
            {
                if (dgvData.Rows[i].Cells[4].Value == null || dgvData.Rows[i].Cells[4].Value == "" || dgvData.Rows[i].Cells[4].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[4].Value);
                }
            }
            else if (ir == 2)
            {
                if (dgvData.Rows[i].Cells[5].Value == null || dgvData.Rows[i].Cells[5].Value == "" || dgvData.Rows[i].Cells[5].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[5].Value);
                }
            }
            else if (ir == 3)
            {
                if (dgvData.Rows[i].Cells[6].Value == null || dgvData.Rows[i].Cells[6].Value == "" || dgvData.Rows[i].Cells[6].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[6].Value);
                }
            }
            else if (ir == 4)
            {
                if (dgvData.Rows[i].Cells[7].Value == null || dgvData.Rows[i].Cells[7].Value == "" || dgvData.Rows[i].Cells[7].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[7].Value);
                }
            }
            else if (ir == 5)
            {
                if (dgvData.Rows[i].Cells[8].Value == null || dgvData.Rows[i].Cells[8].Value == "" || dgvData.Rows[i].Cells[8].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[8].Value);
                }
            }
            else
            {
                if (dgvData.Rows[i].Cells[9].Value == null || dgvData.Rows[i].Cells[9].Value == "" || dgvData.Rows[i].Cells[9].Value == DBNull.Value)
                {
                    dr["Amount"] = Convert.ToDecimal(0);
                }
                else
                {
                    dr["Amount"] = Convert.ToDecimal(dgvData.Rows[i].Cells[9].Value);
                }
            }

            dt.Rows.Add(dr);
        }
      }

        //bind
        dgvConverted.DataSource = dt;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:24:38.397

`row.IsNewRow`在循环开始时使用`foreach`以检查正在复制的行是否为空白行。

**添加的代码示例**

```
foreach (DataGridViewRow row in this.dgvData.SelectedRows)
  {
   if (!row.IsNewRow)
     {
        //Your other code here
     }
   } 
```

我不确定你为什么使用`i`迭代器，因为你可以简单地使用`row.Cells[]`而不是`dgvData.Rows[i].Cells[]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T15:51:09.477

问题是您正在使用`foreach`循环然后获取错误的行索引。

只需使用`for`循环并具有适当的索引。

# c# - C#\Dynamic\ 如果动态 var 为空（对象类型）或零（值类型），我可以签入一条语句吗

> ID：11970810
> 
> 赞同：1
> 
> 时间：2012-08-15T14:08:50.390
> 
> 标签：c#, dynamic, reference

C# 4.0 中是否支持在一行中做到这一点？

我为对象做了：

```
 if (ReferenceEquals(null, myDynamicVar)) 
```

所以现在我需要看看这是否为零。如何做到这一点，是否有一个可以同时做到的声明？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T14:13:09.960

```
if (ReferenceEquals(null, myDynamicVar) || Equals(0, myDynamicVar)) ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T14:15:33.017

```
public bool IsDefault<T>(T value)
{
    if(value == null) return true;
    return value.Equals(default(T));
}

int v = 5;
object o = null;
IsDefault(v); //False
IsDefault(0); //True
IsDefault(o); //True
IsDefault("ty"); //False 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T14:15:11.243

邋遢：

```
if (ReferenceEquals(null, myDynamicVar) || myDynamicVar ==
   (myDynamicVar.GetType().IsValueType ? Activator.CreateInstance(myDynamicVar.GetType()) : null)
{
    //Code greatness
} 
```

清洁器：

```
 public static bool IsDefault(dynamic input)
    {
        if (input == null)
        {
            return true;
        }
        else if (input.GetType().IsValueType)
        {
            return input == Activator.CreateInstance(input.GetType());
        }
        else
        {
            return false;
        }
    } 
```

# php - 学说2 mvc实体/控制器设计

> ID：11970816
> 
> 赞同：0
> 
> 时间：2012-08-15T14:09:01.203
> 
> 标签：php, model-view-controller, doctrine-orm

这是一个简单的问题，因为我是菜鸟。我正在学习如何在 mvc 设计模式中使用学说，我似乎总是对应该将查询实体的代码放在哪里感到困惑。我有一种查询实体用户的方法，它应该去哪里？它应该放在我的实体、控制器还是存储库中？

我的代码：

实体用户

```
<?php

namespace Entities;

use Doctrine\Common\Collections\ArrayCollection;

/** @Entity(repositoryClass="Entities\UserRepository") 
 *  @Table(name="users")
 */
 class Users {

/** @id @column */
protected $id;

/** @column */
protected $first;

/** @column */
protected $mi;

/** @column */
protected $last;

/** @column */
protected $userName;

/** @column */
protected $avatar;

/** @OneToMany(targetEntity="Blog", mappedBy="user") */
protected $blogs;

// Constructor
public function __construct() {
    $this->blogs = new ArrayCollection();
}

public function __get($property) {
    return $this->$property;
}

public function __set($property, $value) {
    $this->$property = $value;
}
} 
```

获取用户的方法：应该去哪里？

```
public function getUsers(){
    $query = $this->_em->createQuery('SELECT u FROM Entities\Users u');
    return $query->getResult(\Doctrine\ORM\Query::HYDRATE_ARRAY);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:23:55.033

最好的方法是使用 RepositoryClass 并在那里添加您的自定义方法，其优点是当我们使用存储库类时您不必重新定义 find 方法

[http://mackstar.com/blog/2010/10/04/using-repositories-doctrine-2](http://mackstar.com/blog/2010/10/04/using-repositories-doctrine-2)

# python - 池工作人员未完成所有任务

> ID：11970820
> 
> 赞同：3
> 
> 时间：2012-08-15T14:09:13.563
> 
> 标签：python, pandas, dataframe, multiprocessing, python-multiprocessing

我有一个相对简单的 python 多处理脚本，它设置了一个工作池，`dataframe`通过自定义管理器将输出附加到熊猫。我发现当我在池上调用 close()/join() 时，并不是所有由 apply_async 提交的任务都已完成。

这是一个简化的示例，它提交了 1000 个作业，但只完成了一半，导致断言错误。我是否忽略了一些非常简单的事情，或者这可能是一个错误？

```
from pandas import DataFrame
from multiprocessing.managers import BaseManager, Pool

class DataFrameResults:
    def __init__(self):
        self.results = DataFrame(columns=("A", "B")) 

    def get_count(self):
        return self.results["A"].count()

    def register_result(self, a, b):
        self.results = self.results.append([{"A": a, "B": b}], ignore_index=True)

class MyManager(BaseManager): pass

MyManager.register('DataFrameResults', DataFrameResults)

def f1(results, a, b):
    results.register_result(a, b)

def main():
    manager = MyManager()
    manager.start()
    results = manager.DataFrameResults()

    pool = Pool(processes=4)

    for (i) in range(0, 1000):
        pool.apply_async(f1, [results, i, i*i])
    pool.close()
    pool.join()

    print results.get_count()
    assert results.get_count() == 1000

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:26:08.017

**[编辑]**你看到的问题是因为这段代码：

```
self.results = self.results.append(...) 
```

这不是原子的。所以在某些情况下，线程会在读取之后`self.results`（或在追加时）但在它可以将新帧分配给之前被中断`self.results`-> 这个实例将丢失。

正确的解决方案是等待使用结果对象来获取结果，然后将它们全部附加到主线程中。

# atk4 - atk4 - 简单的 apicli 示例

> ID：11970821
> 
> 赞同：1
> 
> 时间：2012-08-15T14:09:14.320
> 
> 标签：atk4

我正在尝试使用 Apicli 制作从命令行运行的脚本。

这是我的测试代码（脚本在页面/命令中）

```
include '../../atk4/loader.php'; 
$api=new ApiCLI('reportes');
$api->addLocation('atk4-addons',array(
         'php'=>array(
            'mvc',
            'misc/lib',
            )))->setParent($api->pathfinder->base_location);

$api->dbConnect();
$db = $this->api->db->dsql()   
       ->table('test t')
       ->do_getAssoc(); 
```

这个的输出是

```
PHP Fatal error:  Uncaught exception 'ExceptionNotConfigured' with message 'You must  specify $config['dsn'] in your config.php' in /var/www/ossec/atk4/lib/ApiCLI.php:238
Stack trace:
#0 /var/www/ossec/atk4/lib/ApiCLI.php(276): ApiCLI->getConfig('dsn')
#1 /var/www/ossec/page/crons/reportes.php(13): ApiCLI->dbConnect()
#2 {main}
  thrown in /var/www/ossec/atk4/lib/ApiCLI.php on line 238 
```

这不读取 config-default.php 吗？我加了

```
$config['dsn']='mysql://user:pass@localhost/test'; 
```

但它不起作用。

谢谢大家

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-20T19:59:38.473

您可以通过更改 cron 执行的当前目录来解决问题。将这些行添加到文件的开头，该文件由 cron 执行：

```
$_SERVER['HTTP_HOST'] = 'site_name'; 
$_SERVER['REMOTE_ADDR'] = '127.0.0.1'; 
$_SERVER['REQUEST_METHOD'] = 'GET'; 
chdir('/home/user/...path_to_directory'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:36:38.827

查看 ApiCli.php 并查看了 db 定义，我已经通过方法传递了参数

```
$api->dbConnect('mysql://user:pass@localhost/test'); 
```

现在它工作正常。

问候亚历杭德罗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T09:51:58.283

ApiCLI 读取 config-default 然后读取 config.php 文件（来自 ApiCLI 的代码），因此它应该选择您的配置文件。很可能它正在查看错误的目录，因为它检查了当前目录：

```
function getConfig($path, $default_value = undefined){
    /**
     * For given path such as 'dsn' or 'logger/log_dir' returns
     * corresponding config value. Throws ExceptionNotConfigured if not set.
     */
    if(is_null($this->config)){
        $this->readConfig('config-default.php');
        $this->readConfig();
    }
    ......
}

function readConfig($file='config.php'){
    $orig_file = $file;
    if(is_null($this->config))$this->config=array();
    $config=array();
    if(strpos($file,'/')===false){
        $file=getcwd().'/'.$file;
        // ^^^^^^^
    }
    ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-21T19:31:53.923

我有同样的问题，但上面的解决方案没有奏效，所以像这样使用 setConfig：

```
$config['dsn']='mysql://root@localhost/databasename';
$api=new ApiCLI();
$api->setConfig($config); 
```

# javascript - highcharts 定位器工具提示 - 通用 javascript

> ID：11970824
> 
> 赞同：1
> 
> 时间：2012-08-15T14:09:18.807
> 
> 标签：javascript, mootools, highcharts, highstock

我无法让工具提示定位器功能工作。就好像这个函数根本不在这里一样，并像往常一样加载工具提示。它上面的事件函数起作用。我已经尝试了一切，但无法弄清楚为什么它只是忽略了这一点。我可以使用工具提示的任何其他属性，例如阴影，但定位器不起作用。该图表使用我的所有设置绘制，除了定位器设置。

这会在 domready mootools 函数内的 php 页面上回显。

```
 var chart_options = '.$chart_options.'
    chart_options.xAxis.events = {setExtremes:function (e){ChartSettings.load_zoom_data(e)}}
    chart_options.tooltip = {positioner: function () {return {x:10,y:30}}}

    window.chart = new Highcharts.StockChart(chart_options, function (chart){
        chart.addEvent("tooltipRefresh", function (){ChartSettings.set_hover_points(chart.hoverPoints)});
    }); 
```

非常感谢您的帮助。

这是此工作的示例：http: [//jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/stock/tooltip/positioner/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/stock/tooltip/positioner/)

**chart_options 对象**

![chart_options 对象](../Images/57051d32ed526f3a8f40dc7c020adcf5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T17:09:50.050

事实证明，这在我使用的 highstock 版本中是一个真正的问题。我升级到最新版本，现在它可以工作了。谢谢大家的帮助和指导。

它不工作的版本是 v1.1.5。

谢谢，

# java - 统计数据分析中的分散数据集

> ID：11970829
> 
> 赞同：0
> 
> 时间：2012-08-15T14:09:26.577
> 
> 标签：java, statistics, mean, scatter

我有一些统计数据。一些数据非常分散到大多数数据集，如下所示。我要做的是尽量减少数据集中高度分散的数据的影响。我想计算在我的案例中分散数据的影响最小的数据集的平均值。

```
My data set is as like this:
10.02, 11, 9.12, 7.89, 10.5, 11.3, 10.9, 12, 8.99, 89.23, 328.42. 
```

如下图所示： ![一个数据分散如下图（比方说）](../Images/07e84c3ba648d80636530876d979c9c2.png)

我需要不是 46.3 但更接近其他数据分布的平均值。实际上，我想最小化 89.23 & 328.42 在平均计算中的影响。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:34:26.173

你可能会注意到你真的不想要平均值。这里的问题是您为数据假设的分布与实际数据不同。如果您试图对这些数据进行正态分布拟合，您将得到不好的结果。您可以尝试将像柯西这样的重尾分布拟合到这些数据中。如果要使用正态分布，则需要过滤掉非正态样本。如果您觉得自己知道标准差应该是多少，则可以从上面的样本中删除所有内容，例如与平均值相差 3 个标准差（数字 3 必须取决于样本大小）。可以递归地完成此过程以删除非正常样本，直到您对标准偏差方面的异常值大小感到满意为止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T16:09:56.527

不幸的是，一组数据的平均值就是——平均值。你确定这个点实际上是一个异常值吗？您的数据包含关于聚类的单个异常值，但如果您查看您的图，您会发现这些数据似乎确实具有线性关系，所以它真的是异常值吗？

如果这个读数真的给你带来了问题，你可以完全删除它。除此之外，我唯一可以建议您的是计算某种加权平均值而不是真实平均值[http://en.wikipedia.org/wiki/Weighted_mean](http://en.wikipedia.org/wiki/Weighted_mean)。这样，您可以在计算平均值时为该点分配较低的权重（尽管如何选择权重值是另一回事）。这类似于加权回归，其中特定数据点与回归拟合相关的权重较小（例如，可能由于某些点的不可靠性）[http://en.wikipedia.org/wiki/Linear_least_squares_](http://en.wikipedia.org/wiki/Linear_least_squares_(mathematics)#Weighted_linear_least_squares) (mathematics)#Weighted_linear_least_squares 。

希望这会有所帮助，或者至少为您提供一些可以尝试追求的其他途径的指示。

# sql - 调整 SQL Varchar 的大小

> ID：11970830
> 
> 赞同：0
> 
> 时间：2012-08-15T14:09:29.667
> 
> 标签：sql, sql-server, sql-server-2005, resize

有没有办法在 sql 中调整本地 varchar 的大小？

喜欢：

```
DECLARE @MYVARIABLE AS VARCHAR(3)
REDIM @MYVARIABLE(50) 
```

这会将 @MYVARIABLE 的大小更改为 50 个字符。

注意：我需要保留变量，因为我之后会使用它。所以我不能用另一个。

样本 2：

```
DECLARE @MYVARIABLE AS VARCHAR(4)
SET @MYVARIABLE = 'TEST'
SET @MYVARIABLE = '12345'
SELECT @MYVARIABLE 
```

在这里，最后是 MYVARIABLE = '1234'。应该是'12345'怎么做（并保持我的变量）

我可以删除当前并创建一个新的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:18:51.290

将变量设置为您知道首先需要的最大尺寸，例如：

```
DECLARE @MYVARIABLE AS NVARCHAR(50) 
```

或者如果你不知道你需要多大，那么你总是可以使用 MAX：

```
DECLARE @MYVARIABLE AS NVARCHAR(MAX) 
```

如果变量的长度对您很重要，那么您可以在为其赋值后得到它：

```
DECLARE @MYVARIABLE AS NVARCHAR(MAX)
DECLARE @LENGTHOFMYVARIABLE AS INT
SET @MYVARIABLE = 'somerandomtext'
SET @LENGTHOFMYVARIABLE = LEN(@MYVARIABLE) 
```

在这种情况下`@LENGTHOFMYVARIABLE`为 14。

**更新**

我知道如何做到这一点的唯一其他方法是使用辅助临时变量：

```
DECLARE @MYVARIABLE AS NVARCHAR(3)
DECLARE @MYBIGGERTEMPVARIABLE AS NVARCHAR(50)
SET @MYBIGGERTEMPVARIABLE = @MYVARIABLE 
```

显然，如果变量再次传递，会有一些限制，但除此之外，唯一的另一种方法是将源变量长度更改为更合理的值。真的没有太多理由拥有如此小的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T08:29:42.123

不，您不能更改变量的定义，也不能取消声明变量。它的定义是固定的，从它被声明的那一刻起，直到批次结束。

如果声明似乎没有运行，它的定义甚至会生效：

```
if 1 = 0
begin
    declare @a varchar(3)
    print 'declared!'
end
else
begin
    print 'not declared?'
end
set @a = 'abc'
print @a 
```

印刷：

```
not declared?
abc 
```

由于您无法更改声明变量的方式，因此您将不得不放弃这种尝试解决您的整体问题的方法（但我无法提供建议，因为您没有描述您的整体问题）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:20:14.177

您可以使用临时变量：

```
DECLARE @MYVARIABLE AS VARCHAR(3)

DECLARE @myVal as VARCHAR(50)=@MYVARIABLE 
```

# php - 为什么我不断将“数组”作为查询的输出？

> ID：11970837
> 
> 赞同：1
> 
> 时间：2012-08-15T14:09:49.197
> 
> 标签：php, mysql, html, sql

我正在尝试进行查询以输出特定事件的参赛者人数。该表名为“payments”，事件的 ID 在“itemid”列中。这是我创建的，但它似乎在浏览器中不起作用，但在 phpMyAdmin 中运行良好。每次我加载页面而不是看到数字时，我都会看到“数组”作为查询的输出。

解决它：

```
$res = mysql_query("SELECT COUNT(*) AS entrants FROM payments WHERE itemid='Sample Event 1'") or die();
$row = mysql_fetch_array($res,MYSQL_ASSOC);

<?php echo $row['entrants']; ?> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-15T14:10:54.920

你不断得到一个数组，因为你用这个来获取它：

```
mysql_fetch_array($entrant_query); 
```

fetch_array 函数会将行作为数组返回。

还有许多其他方法可以从数据库中返回一行 - 虽然我猜你正在寻找的是[fetch_row](http://au2.php.net/manual/en/function.mysql-fetch-row.php)

您可以尝试[var_dump](http://au2.php.net/manual/en/function.var-dump.php)来查看您返回的内容。

```
<?php
$a = array(1, 2, array("a", "b", "c"));
var_dump($a);
?>

// output:

array(3) {
  [0]=>
  int(1)
  [1]=>
  int(2)
  [2]=>
  array(3) {
    [0]=>
    string(1) "a"
    [1]=>
    string(1) "b"
    [2]=>
    string(1) "c"
  }
} 
```

最后，这些`mysql_*`函数已被弃用，您可能希望改为考虑迁移到[PDO](http://au2.php.net/manual/en/book.pdo.php)。它更安全、更灵活，如果您刚刚开始，这是一个*更好*的学习选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:29:23.560

请检查文档

```
mysql_fetch_array($query); 
```

[http://pa.php.net/manual-lookup.php?pattern=mysql_fetch_array%28%29&scope=quickref](http://pa.php.net/manual-lookup.php?pattern=mysql_fetch_array%28%29&scope=quickref)

也尝试做这个代码

```
$f1 = mysql_fetch_array($entrant_query);
//this will  give u the print out of the associative array:
printr($f1);
//you can now access  each variable of the associative array by
//where the associative that prinr output
foreach($f1 as $value){
 echo $value;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:35:02.823

```
include ("includes/db.php");
// Get data from the database for content
$res = mysql_query("SELECT COUNT(*) AS entrants FROM payments WHERE itemid='Sample Event 1'") or die();
$row = mysql_fetch_array($res,MYSQL_ASSOC); 
```

和

```
<?php echo $row['entrants']; ?> 
```

现在工作正常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T14:12:12.987

该方法`mysql_fetch_array()`将查询结果加载到一个数组中，然后您可以使用该数组来访问您的数据。您可以遍历数组以提取所有数据，也可以直接访问特定数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-15T14:12:16.987

即使您的查询是返回记录数并返回 1 个字段，您也正在调用该函数`mysql_fetch_array`，因此它只返回该行中包含的字段的数组。

通常，如果你这样做了`SELECT * from users`，你会不断地转来转去，直到没有更多的行，然而，仅仅因为你的查询返回 1 个字段，它只是一个 1 的数组，因为它就是这样工作的。

# c# - 找出谁在 C# 中锁定了网络驱动器上的文件

> ID：11970841
> 
> 赞同：6
> 
> 时间：2012-08-15T14:10:04.210
> 
> 标签：c#, windows

一个程序在共享网络驱动器的多台机器上运行。它可以使用

```
... = new FileStream(path, FileMode.OpenOrCreate, FileAccess.Write, FileShare.Read); 
```

锁定文件以防止写入。然后所有其他实例只能读取它并显示一个警告，即该文件不可写。

*如何找出谁（即哪台机器）锁定了文件*，并在警告中显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:37:01.857

我见过的唯一方法是让打开文件的程序留下标记文件（.lock）或类似文件。这个 .lock 文件显然可以包含您想要的任何内容（用户名、机器等），并且可以单独读取。

这假设您可以控制正在另一台 PC 上读取它的软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:29:51.163

这是一个带有 C# 源代码的帖子，其中举例说明了如何查看进程列表并检查每个进程锁定的文件。

[如何找出使用 C# 锁定文件的进程](https://stackoverflow.com/questions/860656/how-does-one-figure-out-what-process-locked-a-file-using-c)。

下一步是在每台机器上的服务中使用此功能，以便进程可以发送对特定文件名的查询，然后接收关于该机器上的进程是否已锁定的响应。

数据可能包括进程名称、用户 ID 和进程列表中可用的其他信息。

这种方法工作量更大，但是它提供了一种访问信息的方法，而无需应用程序锁定文件来做一些特殊的事情。

另一方面，如果您感兴趣的文件在您的控制范围内并且您可以确定文件访问权限，那么这可能是矫枉过正。

# jsf - 仅当 inputtext 不为空时，JSF f:ajax 侦听器才调用 bean 方法

> ID：11970843
> 
> 赞同：0
> 
> 时间：2012-08-15T14:10:08.370
> 
> 标签：jsf, jsf-2

调用事件时是否可以调用`f:ajax`侦听`blur`器，但前提是 inputtest 字段值不为空？

当输入文本模糊时，我在托管 bean 中调用一个方法，该方法返回所有其他表单字段。问题是当我模糊一个 emtpy 字段时，因为它是一个必填字段，所以我会收到一条验证消息，但在这种情况下，我不希望它调用托管 bean 方法，前提是其中有一个值。

这是怎么做到的？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-19T15:11:35.287

使用`event="change"`而不是`event="blur"`或完全删除该`event`属性，它默认为`change`已经。这样，该字段将仅在它真正更改时才提交（并验证），因此当最终用户刚刚离开该字段时尚未提交。

# php - 写入模式下 fopen 的文件权限 - PHP

> ID：11970846
> 
> 赞同：3
> 
> 时间：2012-08-15T14:10:14.250
> 
> 标签：php, fopen, fputcsv

我有一个将一些行写入 CSV 文件的 PHP 脚本：

```
$fp = fopen($csv, 'w'); 
```

我正在使用模式 'w' 以便在文件不存在时创建文件，但是即使我为整个 /var/www/html/ 目录提供了 777 权限，该文件也会自动获得**644**权限（不是一个好的想法但适合测试）。

如何写入文件并事先授予它权限？还是有更好的方法来授予写权限？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T14:23:42.783

事先创建文件并设置权限：

```
touch('/file/path/here');
chmod('/file/path/here', 0775);
fopen('/file/path/here', 'w'); 
```

但是，这应该不是问题。如果 PHP/Apache 用户使用 来创建文件`fopen`，则他们有权写入该文件。

# php - 将连接的“列表”从 php 转换为 ruby

> ID：11970847
> 
> 赞同：0
> 
> 时间：2012-08-15T14:10:14.920
> 
> 标签：php, ruby

我不知道如何在 ruby​​ 上做同样的事情：

在 php 中，我可以使用以下结构：

```
while ((list($r_key, $r_value) = each($rule_arr)) 
        && (list($v_key, $v_value) = each($value_arr)) 
        && (list($s_key, $s_value) = each($stack_arr)))
      {
          $insert_rules_for_types = sprintf("INSERT INTO                  
                  `rules_for_types`(`types_id`, `rules_id`, `value`, `stackcount`) 
                   value('%d','%d','%d','%d')", intval($type_id), intval($r_value), 
                   intval($v_value), intval($s_value));

      commit_changes($insert_rules_for_types);
} 
```

我怎样才能在 ruby​​ 上做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:25:52.840

一个相当字面的重写将是这样的：

```
rule_arr.each do |r_key, r_value|
  value_arr.each do |v_key, v_value|
    stack_arr.each do |s_key, s_value|
      insert_rules_for_types = "INSERT INTO `rules_for_types`(`types_id`,`rules_id`,`value`,`stackcount`) value('%d','%d','%d','%d')" % [
        type_id.to_i,
        r_value.to_i,
        v_value.to_i,
        s_value.to_i
      ]

      commit_changes(insert_rules_for_types)
    end
  end
end 
```

无论您在 PHP 中做什么，您都可以通过使用范围非常广泛的[ActiveRecord](http://rubygems.org/gems/activerecord)或更轻量且更面向插件的[Sequel之类的 ORM 来避开构建 SQL 的许多麻烦。](http://rubygems.org/gems/sequel)

这两个，如果使用得当，将确保你已经**正确地转义了你的 SQL**。转换为整数是弱转义的标志，因为它不是通用解决方案。

Sequel 对许多 SQL 调用有一个 Ruby 接口，因此`INSERT`映射为一些直接的代码：

```
db[:rules_for_types].insert(
  :types_id => types_id,
  :rules_id => rules_id,
  :value => v_value,
  :stackcount => s_value
) 
```

这样做会使将未转义的值注入查询变得非常困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:12:56.717

我认为你可以使用 Ruby 的 %. 检查[此](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-25)以获取详细信息。

# ruby-on-rails - 指南针生成的精灵

> ID：11970862
> 
> 赞同：0
> 
> 时间：2012-08-15T14:11:00.203
> 
> 标签：ruby-on-rails, compass-sass, sass

我正在尝试将当前在导航中使用的背景图像转换为精灵以保存 http 请求，尽管我收到以下错误

```
 content: "\000a Sass::SyntaxError: Undefined mixin 'navigation-sprite'.\000a   (in \002f home\002f html\002f teammngt\002f app\002f assets\002f stylesheets\002f navigation.css.scss)"; 
```

.scss 文件

```
@import "compass"; 
```

`@import "navigation/main/*.png";`

```
a {
  display: table-cell;
  /* #header_main height + 1, to move it 1px into the header_main strip */
  height: 61px;
  width: 120px;
  @include navigation-sprite(bg-normal);
  //background: url('navigation/main/bg-normal.png') no-repeat;
  /* Concerning fonts/text */
  line-height: 26px;
  /* Concerning text align */
  text-align: center;
  vertical-align: bottom; 
```

肯定我在这里做错了什么，但我没有太多运气解决它

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:18:57.473

```
@import "compass";
@import "navigation/main/*.png";
@include all-main-sprites; 
```

像这样使用：

```
@include main-sprite(bg-normal); 
```

# ruby-on-rails - AbstractController::DoubleRenderError 与控制器异常处理

> ID：11970863
> 
> 赞同：2
> 
> 时间：2012-08-15T14:11:03.340
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

在我的 Rails 3.1 应用程序中，我`rescue_from`在基本 API 控制器之上有一个如下所示：

```
rescue_from Exceptions::InvalidApiKey, :with => :invalid_api_key 
```

在 invalid_api_key 看起来像这样：

```
def invalid_api_key
    Rails.logger.debug "Invalid API key"
    render :json => {:error => :invalid_api_key}, :status => :forbidden
end 
```

有一个`before_filter`检查 API 密钥并在需要时抛出 InvalidApiKey 异常。

但是，`AbstractController::DoubleRenderError`当我尝试使用错误的 API 密钥的控制器时，我得到一个错误，因为它试图在异常处理程序和原始操作中呈现。

我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:35:57.050

您需要停止控制器的链条`return false`。`before_filter`

否则，它首先呈现错误`invalid_api_key`并使用“常规”流程（因为您已经从异常中解救出来）转到调用的操作，然后尝试从操作中再次呈现。

所以

```
def invalid_api_key
    Rails.logger.debug "Invalid API key"
    render :json => {:error => :invalid_api_key}, :status => :forbidden 
    false
end 
```

应该解决问题

# matlab - 如何从 MATLAB 中由 ActiveX 控制的设备存储的内存中检索数据

> ID：11970864
> 
> 赞同：2
> 
> 时间：2012-08-15T14:11:04.020
> 
> 标签：matlab, camera, activex

我有一个 USB 摄像头 ( [DCC1645](http://www.thorlabs.com/NewGroupPage9.cfm?ObjectGroup_Id=4024&popupcart=yes) )，我试图通过 MATLAB 与之交互。我已通过 ActiveX 成功将其连接到它：

```
cam = actxcontrol('uc480.uc480Ctrl.1'); 
```

我可以在上面运行各种功能等等。我现在想知道如何检索图像数据；相关函数返回一个指向内存中图像的指针：

```
GetImageMem() returns the pointer to the internal image memory where the image is stored. 
```

所以如果我跑

```
loc = cam.GetImageMem(); 
```

然后`loc`是一些代表内存位置的大数字。获取存储多少内存的函数如下：

```
InquireImageMem(LONG* nWidth, LONG* nHeight, LONG*nBits, LONG* nPitch) 
reads the properties of the allocated image memory. The function returns 
the properties of the actual image buffer, as returned by GetImageMem

nWidth     Receives the width of the allocated image memory.
nHeight    Receives the height of the allocated image memory.
nBits      Receives the bits per pixel of the allocated image memory.
nPitch     Receives the pitch of the allocated image memory. The pitch 
           is the number of bytes from the start of a line to the start 
           of the next line. 
```

所以我的问题有两个：

1.  给定内存指针和大小，如何获取实际数据？
2.  如何传递对函数的引用（例如 LONG* nwidth）？我应该使用像 libpointer 这样的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-24T15:19:46.290

根据 IDS 的说法，COM 框架不再受支持，因此您应该考虑切换到 NET 框架。我认为来自 lunarquaker 的帖子指的是旧版本。这是一个代码片段，如果将其复制并粘贴到 Matlab 中，则无需修改相机型号即可使用 #UI-1220SE-M-GL（它适用于我）。您可以更改彩色相机的像素格式。

在 Matlab 8.3.0.532 (R2014a) 中测试，uEyeDotNet Version=1.5.3.0 和 IDS/uEye v4.40.0.0

**注意**- 在尝试再次初始化同一台相机之前，您必须“退出”，否则您会发现自己陷入了麻烦之中。

```
%   Add NET assembly if it does not exist
%   May need to change specific location of library
asm = System.AppDomain.CurrentDomain.GetAssemblies;
if ~any(arrayfun(@(n) strncmpi(char(asm.Get(n-1).FullName), ...
        'uEyeDotNet', length('uEyeDotNet')), 1:asm.Length))
    NET.addAssembly(...
        'C:\Program Files\IDS\uEye\Develop\DotNet\signed\uEyeDotNet.dll');
end

%   Create camera object handle
cam = uEye.Camera;

%   Open 1st available camera
%   Returns if unsuccessful
if ~strcmp(char(cam.Init), 'SUCCESS')
    error('Could not initialize camera');
end

%   Set colormode to 8-bit RAW
if ~strcmp(char(cam.PixelFormat.Set(uEye.Defines.ColorMode.SensorRaw8)), ...
        'SUCCESS')
    error('Could not set pixel format');
end

%   Set trigger mode to software (single image acquisition)
if ~strcmp(char(cam.Trigger.Set(uEye.Defines.TriggerMode.Software)), 'SUCCESS')
    error('Could not set trigger format');
end

%   Allocate image memory
[ErrChk, img.ID] = cam.Memory.Allocate(true);
if ~strcmp(char(ErrChk), 'SUCCESS')
    error('Could not allocate memory');
end

%   Obtain image information
[ErrChk, img.Width, img.Height, img.Bits, img.Pitch] ...
    = cam.Memory.Inquire(img.ID);
if ~strcmp(char(ErrChk), 'SUCCESS')
    error('Could not get image information');
end

%   Acquire image
if ~strcmp(char(cam.Acquisition.Freeze(true)), 'SUCCESS')
    error('Could not acquire image');
end

%   Extract image
[ErrChk, tmp] = cam.Memory.CopyToArray(img.ID); 
if ~strcmp(char(ErrChk), 'SUCCESS')
    error('Could not obtain image data');
end

%   Reshape image
img.Data = reshape(uint8(tmp), [img.Width, img.Height, img.Bits/8]);

%   Draw image
himg = imshow(img.Data, 'Border', 'tight');

%   Acquire & draw 100 times
for n=1:100
    %   Acquire image
    if ~strcmp(char(cam.Acquisition.Freeze(true)), 'SUCCESS')
        error('Could not acquire image');
    end

    %   Extract image
    [ErrChk, tmp] = cam.Memory.CopyToArray(img.ID); 
    if ~strcmp(char(ErrChk), 'SUCCESS')
        error('Could not obtain image data');
    end

    %   Reshape image
    img.Data = reshape(uint8(tmp), [img.Width, img.Height, img.Bits/8]);

    %   Draw image
    set(himg, 'CData', img.Data);
    drawnow;
end

%   Close camera
if ~strcmp(char(cam.Exit), 'SUCCESS')
    error('Could not close camera');
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T21:51:38.470

1) 简短的回答是“不”，即使您知道矩阵在哪里以及它有多大，您也无法在 MATLAB 中将矩阵从内存中拉出来。[但是，图像采集工具箱](http://www.mathworks.com/products/imaq/)支持此特定相机，[此处](http://www.mathworks.com/support/solutions/en/data/1-1CBPW/)提供相关教程。

长答案是，如果你用一些 mex/c 补充你的 MATLAB 代码，你可以让它工作，虽然我没有任何细节。

2）正如我在对原始问题的评论中所写，

```
[a,b,c,d] = cam.InquireImageMem(0,0,0,0); 
```

将工作。用于`cam.methods('-full')`获取库中所有可能方法的列表，以及它们所需的输入/输出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-21T05:50:56.417

尝试使用 uEye .NET 用户层 [http://en.ids-imaging.com/manuals/uEye_SDK/EN/uEye_DotNET_Manual/index.html?ueyeinstallation.htm](http://en.ids-imaging.com/manuals/uEye_SDK/EN/uEye_DotNET_Manual/index.html?ueyeinstallation.htm)

下面是一些示例 MATLAB 代码

* * *

```
clear all

close all

computer_type=computer;

if strcmp (computer_type,'PCWIN64')

NET.addAssembly('C:\Program Files\IDS\uEye\Develop\DotNet\x64\uEyeDotNetUserLayer.dll');

NET.addAssembly('C:\Program Files\IDS\uEye\Develop\DotNet\x64\uEyeDotNetApiLayer.dll');

elseif strcmp (computer_type,'PCWIN')

NET.addAssembly('C:\Program Files\IDS\uEye\Develop\DotNet\x86\uEyeDotNetUserLayer.dll');

NET.addAssembly('C:\Program Files\IDS\uEye\Develop\DotNet\x86\uEyeDotNetApiLayer.dll');

end

cam = uEye.Camera;

cam.Exit();

CAM_ID=2;

exposure_ms=2;

cam.Init(CAM_ID);

ColorMode=uEye.Defines.ColorMode.SENSOR_RAW8;

cam.PixelFormat.Set(11);

cam.Trigger.Set(uEye.Defines.TriggerMode.Software);

[tmp, memId] = cam.Memory.Allocate(true);

[tmp, imgWidth] = cam.Memory.GetWidth(memId);

[tmp, imgHeight] = cam.Memory.GetHeight(memId);

[tmp, imgBpp] = cam.Memory.GetBitsPerPixel(memId);

imgBpp = imgBpp / 8;

imgSize = imgWidth * imgHeight * imgBpp;

bufArr = NET.createArray('System.Byte', imgSize);

soft = uEye.Software(CAM_ID);

soft.SetEnableAutoWhiteBalance(false);

soft.SetEnableAutoGain(false);

soft.SetEnableAutoShutter(false);

cam.Timing.Exposure.Set(exposure_ms); % msec

cam.Acquisition.Freeze(1);

[tmp, camMemPtr] =  cam.Memory.ToIntPtr;

System.Runtime.InteropServices.Marshal.Copy(camMemPtr, bufArr, 0, imgSize);

img = uint8(bufArr);

myImage=reshape(img, imgWidth, imgHeight)'; 
```

# ios - 使用 UIPasteboard 与 iOS Numbers App 共享数据

> ID：11970868
> 
> 赞同：2
> 
> 时间：2012-08-15T14:11:19.563
> 
> 标签：ios, pasteboard

我想通过粘贴板与 iOS Numbers 共享我的应用程序中的数据。我写了以下代码： -

```
 NSData *data1 = [@"Col1,1\tCol1,2\n\nCol2,1\tCol2,2\n" dataUsingEncoding:NSASCIIStringEncoding];

[[UIPasteboard generalPasteboard] setData:data1 forPasteboardType:@"com.apple.iWork.TSPNativeData"]; 
```

但是，当您使用 NSLog 检查粘贴板中存储的内容时 - 它是空的？

最初我尝试使用基本代码： -

```
[UIPasteboard generalPasteboard].string = @"Col1,1\tCol1,2\n\nCol2,1\tCol2,2\n"; 
```

但是，当粘贴到 Numbers 中时，所有文本都存储在一个单元格中，而不是输出到单独的单元格中。

有没有人尝试从他们的应用程序和 Numbers 中共享数据？

谢谢，

马丁

# c# - 从 Ajax 发送 C# 类，错误 500

> ID：11970870
> 
> 赞同：0
> 
> 时间：2012-08-15T14:11:23.760
> 
> 标签：c#, jquery, ajax, webmethod

我有 webmethods 作为“插入”和“更新”，我的记录有 C# 类作为“DataParam”......我通过使用 AJAX 调用来做到这一点。对于更新方法，没有问题，我通过 Ajax 调用发送类并进行更新，但是插入我有错误 500。我无法克服它。

这是我的课：

```
 public class DataParam
{

    public string ATC1 { get; set; }
    public string ATC2 { get; set; }
    public string ATC3 { get; set; }
    public string ATC4 { get; set; }
    public string CurentlyProjectMark { get; set; }
    public int Dosage { get; set; }
    public string Dosage_Title { get; set; }
    public string FirstMark { get; set; }
    public int Form { get; set; }
    public string Form_Title { get; set; }
    public long Id { get; set; }
    public Guid Key { get; set; }
    public string LicensedTradeMark { get; set; }
    public long Molecule { get; set; }
    public string Molecule_Title { get; set; }
    public string ProductName { get; set; }
    public int ProjectCode { get; set; }
    public string ProjectCode_Title { get; set; }
    public DateTime RD_DataProtectionEndDate { get; set; }
    public string RD_Description { get; set; }
    public int RD_Document_Author { get; set; }
    public DateTime RD_Document_CheckDate { get; set; }
    public string RD_Document_CheckDescription { get; set; }
    public DateTime RD_Document_ComingDate { get; set; }
    public string RD_Document_ComingDescription { get; set; }
    public int RD_Document_Controller { get; set; }
    public DateTime RD_Document_DoneDate { get; set; }
    public string RD_Document_DoneDescription { get; set; }
    public DateTime RD_Document_RealesedDate { get; set; }
    public string RD_Document_RealesedDescription { get; set; }
    public int RD_Document_Status { get; set; }
    public DateTime RD_Document_TargetDate { get; set; }
    public string RD_Document_TargetDescription { get; set; }
    public int RD_ProjectedFirm { get; set; }
    public string RD_ProjectedName { get; set; }
    public int RD_Responsible { get; set; }
    public int RD_Status { get; set; }
    public string Title { get; set; }
    public string TradeMark { get; set; }
} 
```

这是方法

```
 [WebMethod(EnableSession = true)]
    public static object Update(DataParam param = null)
    {
        try
        {
            CPI.RD.Product product = new CPI.RD.Product();
            object objProduct = (CPI.RD.Product)product;
            product = (CPI.RD.Product)CPI.RD.Helper.FillBussinesObject(param, ref objProduct);

            CPI.RD.ProductManagement.Update(product);

            return true;
        }
        catch (Exception ex)
        {
            return new { Result = "ERROR", Message = ex.Message };
        }
    }

    [WebMethod(EnableSession = true)]
    public static object Insert2(DataParam param = null)
    {
        try
        {

            CPI.RD.Product product = new CPI.RD.Product();
            object objProduct = (CPI.RD.Product)product;
            product = (CPI.RD.Product)CPI.RD.Helper.FillBussinesObject(param, ref objProduct);

            CPI.RD.ProductManagement.Insert(product);

            return true;
        }
        catch (Exception ex)
        {
            return new { Result = "ERROR", Message = ex.Message };
        }
    } 
```

这是 AJAX 调用

```
 var param = cpiGrid.getRecordForm(record);

        // Check if it is new record
        if ($(div).attr("data-new") == "true") {

            url += "Insert2";

            record = cpiGrid.getRecordForm(record);

            data = JSON.stringify(record);
            console.log("send to add: ", record, " data: ", data);

            cpiGrid.getJSON(url, data, function () {
                cpiGrid.listRecords();
                $(".close-button").trigger("click");
            });
        } 
```

详细错误信息：

```
{"Message":"Invalid web service call, missing value for parameter: \u0027param\u0027.","StackTrace":"   at System.Web.Script.Services.WebServiceMethodData.CallMethod(Object target, IDictionary`2 parameters)\r\n   at System.Web.Script.Services.WebServiceMethodData.CallMethodFromRawParams(Object target, IDictionary`2 parameters)\r\n   at System.Web.Script.Services.RestHandler.InvokeMethod(HttpContext context, WebServiceMethodData methodData, IDictionary`2 rawParams)\r\n   at System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType":"System.InvalidOperationException"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T06:20:48.543

您需要在 JSON.stringify 部分指定参数名称，如下所示：

```
 // Check if it is new record 
    if ($(div).attr("data-new") == "true") { 

        url += "Insert2"; 

        record = cpiGrid.getRecordForm(record); 

        data = JSON.stringify({param: record}); 
        console.log("send to add: ", record, " data: ", data); 

        cpiGrid.getJSON(url, data, function () { 
            cpiGrid.listRecords(); 
            $(".close-button").trigger("click"); 
        }); 
    } 
```

检查：data = JSON.stringify({param:record});

# java - 安卓平板、路由器、2台设备单向连接

> ID：11970871
> 
> 赞同：0
> 
> 时间：2012-08-15T14:11:32.457
> 
> 标签：java, android, sockets

我有问题，我还没有找到答案。我有 2 个带 wifi 的设备，它们都在发送特殊数据。我想在平板电脑上同时显示这些数据。有一个带网络的路由器，平板电脑和设备都连接到这个网络。

如何解决这个问题？我应该使用服务器套接字吗？不知道我解释的是否清楚，如果没有，请追问。感谢您的任何回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:18:40.127

我在我工作的公司上运行相同的应用程序。“设备”是一个基于微控制器的设备，它实现了 lwIP（轻量级 IP 协议），它监听端口 83，平板电脑每隔 500 毫秒读取一次新数据并将其绘制在图表中。奇迹般有效。

（如果您要绘制图表，我使用了 AChartEngine，您可以在我的个人资料上查看问题/答案以及一些有用的信息）

下面的代码是我正在做的简化版本。完整版本包括**几个** `try{ } catch() { }`，以防它捕捉到异常，它会尝试关闭套接字并返回 null；

```
public static String SendMessage(String message, String ip, int port) {

    // Connect to host ==================================
    Socket socket = new Socket();
    socket.setSoTimeout(TIMEOUT);
    InetSocketAddress addr = new InetSocketAddress(ip, port);
    socket.connect(addr, TIMEOUT);

    // Send Message ======================================
    byte[] outputBuffer = message.getBytes();
    socket.getOutputStream().write(outputBuffer);

    // Zero the input buffer =============================
    for (int i = 0; i < inputBuffer.length; i++) {
        inputBuffer[i] = 0;
    }

    // Read the response ==================================
    int count = 0;
    do {
        count = socket.getInputStream().read(inputBuffer);
    } while (count != -1);

    // Close connection ====================================
    close(socket);

    // Return message ======================================
    return new String(inputBuffer).trim();
} 
```

希望它有所帮助，快乐编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:42:46.457

**1.** Socket 会是个好主意。

**发送 ：**

```
Socket s = new Socket();
s.connect(new InetSocketAddress("IP_ADDR",PORT_NO);

OutputStream o = s.getOutputStream();
PrintWriter pw = new PrintWriter(o);
pw.write(msg);   // msg will be the data needed to send 
```

**对于接收：**

```
Socket s = new Socket();
s.connect(new InetSocketAddress("IP_ADDR",PORT_NO);

InputStream i = s.getInputStream();
InputStreamReader isr = new InputStreamReader(i);
BufferedReader br = new BufferedReader(isr);
String str = new String();

while((str=br.readLine())!=null){

   System.out.println(str);  // do whatever u want to do with str, the data read

 } 
```

# sql - 查看一个值如何与其他值进行比较并分为几类

> ID：11970874
> 
> 赞同：0
> 
> 时间：2012-08-15T14:11:42.147
> 
> 标签：sql, oracle-apex

我做了一个简单的查询来检查客户买了多少钱单身：

```
SELECT k.voornaam || ' ' || k.familienaam as "Naam", sum( b.aantal * s.prijs) as "Omzet"  

from bestellingen b 
left join klanten k on k.klantid = b.klantid
left join singles s on s.singleid = b.singleid
where b.klantid = 12
group by k.voornaam,k.familienaam 
```

这返回：

![在此处输入图像描述](../Images/58a2cd3987f14985520953a287f311c6.png) 但我还需要一个名为类型客户的第三列

>

我必须找出这个收入与所有其他客户相比有多好

*   前 25% = 我必须返回“非常好”
*   25% 到 50% = 返回“好”
*   50% 到 75% = 返回“平均”
*   75% 到 100% = '不好'

所以我需要计算每个客户的收入，看看它与他们相比如何。

我该怎么做呢？如果我正在构建一个 oracle 项目（apex），我也可以使用 PL/SQL 如果这更适合这项工作。

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:21:16.533

我假设 Oracle Apex 具有 Oracle 底层的功能。您可以使用百分位数分析函数执行此操作：

```
with t as (
     SELECT k.voornaam || ' ' || k.familienaam as "Naam",
            sum( b.aantal * s.prijs) as "Omzet"
     from bestellingen b left join
          klanten k
          on k.klantid = b.klantid left join
          singles s
          on s.singleid = b.singleid
     where b.klantid = 12
     group by k.voornaam,k.familienaam 
    )
 select t.*,
        (case when percentile between 0 and 0.25 then 'VeryGood'
              when percentile between 0.25 and 0.5 then 'Good'
              when percentile between 0.5 and 0.75 then 'Average'
              else 'Bad'
         end) as CustGrp
 from (select t.*,
              percent_rank() over (order by omzet desc) as percentile
       from t
      ) t 
```

我假设“omzet”是指收入。

# c# - c# 正则表达式捕获重复的关键字值

> ID：11970875
> 
> 赞同：3
> 
> 时间：2012-08-15T14:11:46.607
> 
> 标签：c#, regex, capture, repeat

我正在尝试捕获由另一个关键字分隔的关键字的值，或者关键字的行尾可能以任何顺序重复或没有要捕获的数据：

关键词：K1,K2

输入数据：somedatahereornotk1capturethis1k2capturethis2k2capturethis3k1k2

我希望捕获的数据是

```
1\. capturethis1
2\. capturethis2
3\. capturethis3
4\. 
5. 
```

我试过`k1|k2(?<Data>.*?)k1|k2`了，但捕获的数据总是空的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:16:49.453

你在交替的正确轨道上。缺少的部分是使用look-behind 和look-ahead 来断言某些东西必须在分隔符之前和之后。

```
(?<=k1|k2)(?<Data>.*?)(?=k1|k2) 
```

Lookbehind`(?<=…)`和lookahead`(?=…)`是零宽度断言，因此它们必须满足但不成为匹配的一部分。

您捕获连续分隔符实例的愿望有点棘手，因为您无法真正捕获“无”——两个字符之间的空间。一种方法是捕获后视（或前瞻）：

```
(?<=(?<Delimiter>k1|k2))(?<Data>.*?)(?=k1|k2) 
```

这将产生 4 个结果而不是 3 个结果，因为它将包括`k1k2`样本数据末尾的连续结果。您只需忽略每个匹配项的额外数据（`k1`, `k2`, `k2`, `k1`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T14:16:54.307

首先，请注意交替运算符`|`的优先级较低，因此

```
k1|k2(?<Data>.*?)k1|k2 
```

实际上是在寻找`k1`or `k2(?<Data>.*?)k1`or `k2`。使用分组：

```
(?:k1|k2)(?<Data>.*?)(?:k1|k2) 
```

其次，考虑使用零宽度的lookahead 和lookbehind 断言：

```
(?<=k1|k2)(?<Data>.*?)(?=k1|k2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:54:50.243

```
string s="somedatahereornotk1capturethis1k2capturethis2k2capturethis3k1k2";

Regex r=new Regex("(?<=k1|k2).*?(?=k1|k2)");
foreach(Match m in r.Matches(s))
Console.WriteLine(m.Value); 
```

# r - Remove special characters from data frame

> ID：11970891
> 
> 赞同：10
> 
> 时间：2012-08-15T14:12:37.690
> 
> 标签：r, regex, gsub, non-printing-characters

I have a matrix that contains the string "Energy per �m". Before the 'm' is a diamond shaped symbol with a question mark in it - I don't know what it is.

I have tried to get rid of it by using this on the column of the matrix:

```
a=gsub('Energy per �m','',a) 
```

[and using copy/paste for the first term of gsub], but it does not work.[unexpected symbol in "a=rep(5,Energy per"]. When I try to extract something from the original matrix with grepl I get:

```
46: In grepl("ref. value", raw$parameter) :
input string 15318 is invalid in this locale 
```

How can I get rid of all this sort of signs? I would like to have only 0-9, A-Z, a-z, / and '. The rest can be zapped.

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-15T14:25:36.223

There is probably a better way to do this than with regex (e.g. by changing the `Encoding`).

But here is your regex solution:

```
gsub("[^0-9A-Za-z///' ]", "", a)
[1] "Energy per m" 
```

But, as pointed out by @JoshuaUlrich, you're better off to use:

```
gsub("[^[:alnum:]///' ]", "", x)
[1] "Energy per m" 
```

# uri - 如何使用 IRC URI 方案打开查询窗口？

> ID：11970897
> 
> 赞同：2
> 
> 时间：2012-08-15T14:12:54.880
> 
> 标签：uri, irc

通常，IRC URI 方案 URL 是这样加入频道的：

```
irc://irc.example.com/channel 
```

你会认为它前面`channel`应该有一个哈希 ( `#`) 来表示它是一个频道并导致你的客户加入它，而没有哈希它只会打开一个带有 nick 的查询窗口`channel`。

但是，似乎没有哈希它只会加入频道，而添加哈希它只会加入`##channel`。

我搜索了很多，但找不到使用 URI 方案查询用户的方法。

这里有谁知道这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T19:16:24.383

这里有 IRC URL 方案的草稿：http: [//ftp.ics.uci.edu/pub/ietf/uri/draft-mirashi-url-irc-01.txt](http://ftp.ics.uci.edu/pub/ietf/uri/draft-mirashi-url-irc-01.txt)

不能保证所有客户端或资源定位器都会遵守草案，但根据文档，您需要如下所示的内容：

```
irc://foobar.org/Mmmm,isnick 
```

`Mmmm`缺口在哪里。关键是您需要`,isnick`目标中的字符串，否则 URL 将被视为通道。此外，您还可以在 URL 中包含身份信息：

```
irc://foobar.org/Mmmm!mandar@*uoknor.edu,isnick 
```

# c++ - 样式和命名空间

> ID：11970898
> 
> 赞同：7
> 
> 时间：2012-08-15T14:12:55.313
> 
> 标签：c++, coding-style

> **可能重复：**
> [为什么是“使用命名空间标准；” 在 C++ 中被认为是一种不好的做法？](https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-a-bad-practice-in-c)

例如，我已经看到了一些人们使用的代码示例，`std::cout`而在其他地方，为了简单起见，人们会将其`using namespace std;`放在顶部。一般首选哪个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:26:06.197

用于`std::cout`避免任何潜在的名称冲突。如果您使用 using `using namespace std;`，您将使用可能与您或团队中其他人编写的类或函数名称冲突的所有标准名称填充您的全局命名空间。这在[C++ faq lite](http://www.parashift.com/c++-faq-lite/using-namespace-std.html)和[SO中有很好的解释](https://stackoverflow.com/questions/1452721/why-is-using-namespace-std-considered-a-bad-practice-in-c)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:18:44.400

我个人在编写代码时使用完整的命名空间命名，例如`std::string`，等等。它使任何阅读该命名空间的人都更清楚，开发人员想要使用哪个功能。

我看过下面的一段话：

> *写一次，读一千遍……*

:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T15:08:59.457

首先请注意，您*永远不* `using namespace`应该在标题中 - 您可能已经意识到这一点。原因是它将带入`using`包含它的任何源文件中。

即使在源文件级别，我也更喜欢明确限定标准库函数和类 liek `std::cout`。但是在某些情况下，为了方便起见，我会使用特定的 using（`using std:endl`例如）。但是，我通常更喜欢显式限定。

# php - MySQL 查询结果在 Memcached 中进行处理？

> ID：11970902
> 
> 赞同：0
> 
> 时间：2012-08-15T14:13:02.683
> 
> 标签：php, mysql, optimization, memcached

我正在处理包含**数百万**条记录的表，并且经常必须运行查询以报告针对它的原因，这可能需要数小时，具体取决于连接级别和其他原因。我知道有很多方法可以优化查询，但我对另一种方法的可能性很感兴趣。

是否有可能通过 PHP（不是 MySQL 原生）获取 MySQL 查询的结果（比如“SELECT * FROM table”），将其作为数组存储在 Memcached 中，然后针对该缓存版本运行查询？会更快吗？粗略地说，这将如何工作？通过查询我的意思是，搜索一个可能看起来像这样的数组：

```
Array[0] {
   Array[0] {
      'field1' => 'value1',
      'field2' => 'value2',
      'field3' => 'value3'
   },
   Array[1] {
      'field1' => 'value1',
      'field2' => 'value2',
      'field3' => 'value3'
   }
   Array[2] {
      'field1' => 'value1',
      'field2' => 'value2',
      'field3' => 'value3'
   }
} 
```

有没有办法比允许 MySQL 进行查询更有效地“查询”PHP 数组？真的，这一切听起来像是利用 NoSQL 解决方案的绝佳机会，但是，唉，我无法控制它。

**[编辑]**

我们正在处理分布在大约 50 个数据库中的数据，每个数据库可能包含 50 个表，每个表的行数从 50 万到 5000 万不等。这都是遗留问题并且优化不佳。只是想用我所拥有的东西工作。

所有数据库都在同一个从服务器上，是的，需要进行跨数据库的查询。这是一个混乱的情况，我只是希望看看我是否可以通过代码更好地处理它而不是让 MySQL 完成工作（据我所知，答案可能是**否定**的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:20:53.270

这取决于您正在运行的查询类型，但最有可能的是，您会看到性能大幅下降（更不用说您必须首先将数百万行加载到内存缓存中，这可能需要相当多的时间）。您可以运行报告，然后将结果存储到内存缓存中，但这实际上取决于访问它们的频率以及其他几个考虑因素。

根据您正在运行的报告类型，通常不应该花费数小时来仅针对数百万行进行报告。您是否尝试过针对您的报告查询运行 EXPLAIN 以确定您是否没有在某处使用正确的索引，或者您是否可以为您正在运行的查询类型创建更有效的结构？

另一种可能性是您的数据库服务器超载，您可能会通过设置从属服务器并针对该服务器运行报告查询来获得更好的性能提升。

编辑：在获得有关您当前不幸情况的更多信息后，仍有几个可能的选择。在没有任何模式或 EXPLAIN 输出的情况下尝试帮助优化这种情况确实很难，但我认为如果您仔细分析所有查询并进行任何可能的优化（例如添加索引），您可能能够提高性能）。这会很乏味。

另一种可能性是分别针对每个不同的数据库运行报告，然后将结果合并到某个共同的地方。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-15T14:28:16.790

Memcached 是一个对象级缓存。它不提供 SQL 接口。因此，您的想法与 memcached 不兼容。但是，有几种可能性。

对于您遇到的每个查询，首先计算一个哈希码。哈希必须包括进入查询的所有参数。当您检索数据时，将结果转换为数据传输对象（XML/文本等）并将哈希和数据对象存储在内存缓存中。

现在，每次要运行查询时，首先创建它的哈希，查找它是否存在于缓存中，如果存在，则取它，否则，从数据库中获取并将其放入缓存中。

当您更新数据库时出现问题，缓存过时并且您需要刷新它。如果你的业务是这样的，你可以忽略最新的数据，你可以周期性地使缓存失效。也就是说，即使数据存在于缓存中，但它是在 1 小时前取回的，你会再次取回。这是一种策略。

您还可以创建一个后台进程来扫描缓存和数据库，并使用数据库中的触发器以伪实时方式刷新它。对数据库的每次更新都会创建一条消息，用于更新缓存。

一种更复杂的方法是，预处理所有数据库更新，并在进行更新之前使受影响的缓存条目无效。

缓存很容易。使其无效很难。您需要在缓存数据之前找出失效。

- 附录

有时您无法进行查询。标准的 jdbc 接口太慢了。您将碰壁，您无法进行足够的调用，因此此时，它不是数据库，而是数据库的路径。如果您想了解更多相关信息，请阅读 handlersocket 以及 Facebook 如何扩展他们的查询。

[http://gigaom.com/cloud/facebook-shares-some-secrets-on-making-mysql-scale/](http://gigaom.com/cloud/facebook-shares-some-secrets-on-making-mysql-scale/)

处理程序套接字：

[http://yoshinorimatsunobu.blogspot.com/search/label/handlersocket](http://yoshinorimatsunobu.blogspot.com/search/label/handlersocket)

# javascript - Javascript 命名空间/最佳实践

> ID：11970906
> 
> 赞同：1
> 
> 时间：2012-08-15T14:13:12.677
> 
> 标签：javascript, namespaces

```
var google = google || {};
google.Test = google.Test || {};
google.Test.Render = google.Test.Render || {}; 
```

上面和下面有什么区别。

`var MyCompany = MyCompany || { MyApplication: { Model: {} } };`

|| 的目的是什么？?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:16:23.930

第一个片段测试命名空间的每个级别是否存在，如果不存在，则创建它（尽管第一行可能应该是`var google = google || {};`）。

第二个只测试顶层是否存在。例如：

```
var MyCompany = {};

// later in the same scope

var MyCompany = MyCompany || { MyApplication: { Model: {} } }; 
```

由于`MyCompany`已定义，因此该表达式的计算结果为`MyCompany = MyCompany`，即`MyCompany`保持为空元素，不会创建嵌套对象。如果以下代码依赖`MyCompany.MyApplication`' 的存在，它将失败。

`||`这里描述了如何工作：[在 Javascript 中，当变量声明中有逻辑运算符时，这意味着什么？](https://stackoverflow.com/questions/3088098/in-javascript-what-does-it-mean-when-there-is-a-logical-operator-in-a-variable)

# android - 安卓中的蓝牙配对

> ID：11970907
> 
> 赞同：0
> 
> 时间：2012-08-15T14:13:13.110
> 
> 标签：android, design-patterns, authentication, bluetooth

在配对两个移动设备的过程中是否可以使用基于模式的身份验证（如屏幕锁定模式）而不是使用 PIN 码？如果可以，该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-07T09:32:36.360

我当然希望不会！[安全简单配对](http://en.wikipedia.org/wiki/Bluetooth#Pairing_mechanisms)怎么样？这意味着没有 PIN，没有用户交互，没有“模式”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-13T11:02:15.367

是的，这是可能的。最简单的解决方案是向用户显示屏幕锁定模式，但在后端将连接点转换为数字，然后使用 PIN 配对。

# wpf - 如何将输入键绑定到wpf中的itemscontrol

> ID：11970921
> 
> 赞同：2
> 
> 时间：2012-08-15T14:14:03.813
> 
> 标签：wpf, xaml, itemscontrol, key-bindings, inputbinding

我有一个项目控件，它在画布上有项目，当我按删除时，我想从画布中删除一个项目：

```
<ItemsControl.InputBindings>
    <KeyBinding Command="{Binding DeleteItemCommand}" Key="Delete"/>
</ItemsControl.InputBindings> 
```

但是，永远不会调用 DeleteItemCommand 中的方法。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-15T14:17:27.993

（或可能是内部的`ItemsControl`东西）需要[`Focusable`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.focusable.aspx)接收键盘输入。

# sql - 从随机数组为 WebService 创建 SQL 表

> ID：11970922
> 
> 赞同：-1
> 
> 时间：2012-08-15T14:14:12.097
> 
> 标签：sql, sql-server, sql-server-2008, select, create-table

我有一个我正在工作的小项目，我想要做一些具体的事情，但似乎无法找到一个可行的解决方案。基本上，我在 Visual Studio 中创建了一个用于移动应用程序的 Web 服务，我们希望添加一个新功能，允许从多个用户检索客户端。为此，我需要能够将一组值传递给 WHERE IN 子句，我发现这几乎是不可能的，但我读过的其他解决方案（没有真实的过程示例）是创建一个数组值的表，然后到一个 WHERE IN (SELECT * from TEMPTABLE) 类型的场景。

所以这就是我卡住的地方，我如何将一组值传递给我的 SQL 语句，然后创建一个包含这些值的临时表（范围可以从 1 到 30 个值），这样我就可以运行其他查询那些价值观。我见过的大多数示例都有用值硬编码的临时表，但我需要能够为该表传递随机数量的值，所以如果将它们作为带有逗号的单个字符串传递更容易，或者如果它们需要以特定格式传递，我也可以在调用 Web 服务之前在 iOS 端执行此操作，但我似乎无法弄清楚如何执行这种动态类型的表以继续下一部分.

**编辑（根据评论添加一些信息）**

所以一些关于系统和目的的背景信息有助于更好地理解我在做什么。数据库是一个 SQL Server (2008)，已经存在表和数据，因为我正在处理的是现有 Web 应用程序的移动应用程序端口。例如，我可以使用的两个表是代理表（针对员工）和客户表（针对他们的客户），因此在某些情况下，我们的团队可以查看彼此的客户。因此，通常如果我想从一组代理中提取客户列表，我会使用 WHERE IN 语句，但对于 Web 服务，它需要将该组作为变量，因为代表可能只想看到几个团队成员或所有团队成员（这将是 iOS 应用程序中设置的选项）。

我并没有真正有效的代码，而且我知道我尝试过的大部分内容都不起作用，所以我会放一些伪代码来解释我想要做什么。起初我以为我可以这样做：

```
SELECT C.first_name + ' ' + C.last_name as [Client Name]
FROM dbo.agent as A INNER JOIN
dbo.contact as C ON C.agent_id = A.id
WHERE (A.id IN (@RepList)) 
```

在此示例中，@RepList 将是从 iOS 应用程序传递到 Web 服务的字符串，其中包含在应用程序中选择的所有 ID。正如我所研究的那样，我在 WHERE IN 语句中不能有变量，但我已经读过，如果我用变量创建一个临时表，那么我可以像这样引用它：

```
CREATE TABLE #TempTable (TempID VARCHAR(MAX))
INSERT INTO #TempTable (TempID)
VALUES (@RepList)

SELECT C.first_name + ' ' + C.last_name AS [Client Name]
FROM dbo.agent AS A INNER JOIN
                    dbo.contact AS C ON A.id = C.agent_id
WHERE (A.id IN (SELECT #TempTable.* FROM #TempTable)) 
```

同样，@RepList 将是从 iOS 应用程序传递到将运行此查询的 Web 服务的 ID 列表。这就是我卡住的地方，因为我似乎无法弄清楚如何将值列表作为变量传递到 TempTable 中。这最终可能只是 Visual Studio 中的一个问题（因为我遇到了 SQL 查询设计器的问题并且它不接受最终在 WebService 中工作的某些东西）但我想确保这是正确的做事格式所以在前进之前。最后，WebService 需要能够根据人们想要查看的代理数量返回一个客户端列表（范围可以从 1 个代理到 20 个代理）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:46:40.973

由于您使用的是 SQL Server 2008 和 VS2010，因此最好的解决方案可能是使用表值参数。此链接（[此处](http://msdn.microsoft.com/en-us/library/bb675163%28VS.110%29.aspx)）描述了如何从 .Net 客户端使用它们。

基本思想是，您的 Web 服务代码将调用 SQL Server 上的过程、函数或参数化查询，其中一个参数是值表。然后 SQL 代码将使用该表值参数作为其源匹配表而不是临时表。

# c# - 执行查询时 JOIN 操作中的语法错误

> ID：11970923
> 
> 赞同：0
> 
> 时间：2012-08-15T14:14:12.713
> 
> 标签：c#, asp.net, sql, database

```
string sel = "SELECT NAAM, PLAATS, tblAfstanden.AFSTAND 
                FROM tblInschrijvingen 
                INNER JOIN tblAfstanden 
                    ON tblInschrijvingen.AFSTAND = tblAfstandenID.AFSTAND"; 
```

大家好！我对上面的查询有疑问。

它给出以下错误：

> 'JOIN 操作中的语法错误'

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:20:28.727

执行以下操作：

```
string sel = "SELECT NAAM, PLAATS, A.AFSTAND FROM tblInschrijvingen I
              INNER JOIN tblAfstanden A ON A.AFSTAND = I.AFSTAND"; 
```

您的语法有错误。因为在我看来实际上你没有 tblAfstandenID.. 最好的方法是使用别名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:30:45.700

如果 NAAM，PLAATS 是 tblInschrijvingen 表的成员

```
string sel = "SELECT tblInschrijvingen.NAAM, tblInschrijvingen.PLAATS, tblAfstanden.AFSTAND 
            FROM tblInschrijvingen 
            INNER JOIN tblAfstanden 
                ON tblInschrijvingen.AFSTAND = tblAfstandenID.AFSTAND"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-15T14:38:35.850

看起来这是一个简单的错字：你真的有一张名为 的表`tblAfstandenID`吗？

应该是这样的：

`"SELECT NAAM, PLAATS, tblAfstanden.AFSTAND FROM tblInschrijvingen INNER JOIN tblAfstanden ON tblInschrijvingen.AFSTAND = tblAfstanden.AFSTAND"`

# c# - 可以刷新用户控件吗？

> ID：11970924
> 
> 赞同：1
> 
> 时间：2012-08-15T14:14:14.483
> 
> 标签：c#

如果我做了一个用户控件，然后通过移动按钮或面板大小来更新它，我注意到它仍然是 Windows 窗体上的旧版本。而当我删除它并再次从工具箱中拖出时，它仍然是旧的！

有没有办法刷新用户控件，还是我必须从头开始重新创建？

# .net - 通过应用程序控制电话功能（即使用 TAPI 的 .NET）？

> ID：11970928
> 
> 赞同：1
> 
> 时间：2012-08-15T14:14:27.990
> 
> 标签：.net, telephony, tapi, pbx

一位同事最近问我是否有可能不使用大型 PBX 系统或不得不使用更多涉及的 Asterisk 技术来...

.. 找到一个电话，只需插入电话插座，即可用于正常电话功能，但也可以连接到位于电话旁边的 PC/笔记本电脑，一旦打开，就可以使用 TAPI 或类似的连接到电话并使用 .NET 应用程序/TAPI、接听电话、拨打电话等来自电话的线路？

我想知道这里是否有人知道这是否可能？

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-08T03:12:21.893

我知道您可以获得一部可以轻松运行两个连接的电话。至于在没有 PBX 的情况下运行 TAPI，我不确定。我认为 Windows 确实有它自己的 TAPI 解决方案。

# java - 如何获取 Swing 小部件的图像？

> ID：11970929
> 
> 赞同：1
> 
> 时间：2012-08-15T14:14:33.613
> 
> 标签：java, swing, java-canvas

> **可能重复：**
> [Java Swing：获取`Image`JFrame](https://stackoverflow.com/questions/5853879/java-swing-obtain-image-of-jframe)

我正在开发一个小的拖放式 Java GUI 构建器。到目前为止它工作正常，但我拖放的小部件只是我在画布上动态绘制的矩形。

如果我有一个代表像 JButton 这样的小部件的矩形，有没有办法让我创建一个 JButton，设置大小并获取该 JButton 的图像（如果它是在屏幕上绘制的）？然后我可以将图像绘制到屏幕上，而不仅仅是我无聊的矩形。

例如，我目前正在这样做以绘制一个（红色）矩形：

```
public void paint(Graphics graphics) {
    int x = 100;
    int y = 100;
    int height = 100;
    int width = 150;

    graphics.setColor(Color.red);
    graphics.drawRect(x, y, height, width);
} 
```

我该怎么做：

```
public void paint(Graphics graphics) {
    int x = 100;
    int y = 100;
    int height = 100;
    int width = 150;

    JButton btn = new JButton();
    btn.setLabel("btn1");
    btn.setHeight(height); // or minHeight, or maxHeight, or preferredHeight, or whatever; swing is tricky ;) 
    btn.setWidth(width);
    Image image = // get the image of what the button will look like on screen at size of 'height' and 'width'

    drawImage(image, x, y, imageObserver);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:18:27.173

基本上，您会将组件绘制到图像上，然后在您想要的任何位置绘制该图像。在这种情况下，可以直接调用`paint`，因为您不是在屏幕上绘画（而是在内存位置）。

如果您想比我在这里所做的更多地优化您的代码，您可以保存图像，并在移动时将其重新绘制到不同的位置（而不是每次屏幕重新绘制时都从按钮计算图像）。

```
import java.awt.*;
import java.awt.image.BufferedImage;

import javax.swing.*;

public class MainPanel extends Box{

    public MainPanel(){
        super(BoxLayout.Y_AXIS);
    }

    @Override
    public void paintComponent(Graphics g){
        super.paintComponent(g);

        // Create image to paint button to
        BufferedImage buttonImage = new BufferedImage(100, 150, BufferedImage.TYPE_INT_ARGB);
        final Graphics g2d = buttonImage.getGraphics();

        // Create button and paint it to your image
        JButton button = new JButton("Click Me");
        button.setSize(button.getPreferredSize());
        button.paint(g2d);

        // Draw image in desired location
        g.drawImage(buttonImage, 100, 100, null);
    }

    public static void main(String[] args){
     final JFrame frame = new JFrame();
     frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
     frame.add(new MainPanel());
     frame.pack();
     frame.setSize(400, 300);
     frame.setLocationRelativeTo(null);
     frame.setVisible(true);
    }
} 
```

# ruby-on-rails - Rails 验证：如果带有复选框

> ID：11970930
> 
> 赞同：2
> 
> 时间：2012-08-15T14:14:36.527
> 
> 标签：ruby-on-rails, validation, activerecord

我正在使用具有 2 个复选框的表单：`option_one`和`option_two`.

`option_two`如果选中且未选中，我不想允许提交表单`option_one`。

换句话说，如果有人检查`option_two`，他们也必须检查`option_one`。

所以在我的 MyModel 中我写道：

```
validates :option_one, :presence => true, :if => option_two_active?, :message => "Dummy message." 
```

然后在 MyController 中，我添加了：

```
def option_two_active?
    params[:option_two] == "1"
end 
```

但它一直给我以下错误：

```
NoMethodError in MyController#index 
```

我的方法正确吗？我怎样才能做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:21:12.333

您引用该方法的方式，它将在第一次加载类时直接调用。但是，该`:if`参数应与随后在验证期间调用的 proc 一起使用，或者与表示方法名称的符号一起使用。在您的情况下，您应该像这样设置您的验证：

```
validates :option_one, :presence => true, :if => :option_two?, :message => "Dummy message." 
```

注意方法名称前的冒号。此外，验证方法需要定义在模型上，而不是控制器上。幸运的是，ActiveRecord 已经为布尔字段定义了正确的方法，如此处使用的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:21:18.813

您必须使用符号指定条件方法：

```
validates :option_one, :presence => true, :if => :option_two_active?, :message => "Dummy message." 
```

此外，由于您不能从模型中使用，您应该使用、或手动`params`将该值从控制器分配给模型。如果你想持久化这个字段，那么它应该是一个数据库列，否则你可以创建一个属性访问器：`create``update_attributes``option_two`

```
attribute_accessor :option_two 
```

# c# - 从 C# 将多个变量传递给 PowerShell

> ID：11970933
> 
> 赞同：2
> 
> 时间：2012-08-15T14:14:40.473
> 
> 标签：c#, powershell, pipeline

我正在从 C# 调用 PowerShell 脚本，我正在使用哈希表来传递参数，但是在调用 PowerShell 脚本时，我得到了

> *找不到接受参数的位置参数*

PowerShell 脚本有两个参数。哈希表有两个键，每个键都有一个值。下面的 PowerShell 脚本：

```
param([string]$username,[string]$path)
#Gets SID
$objUser = New-Object System.Security.Principal.NTAccount($username)
$strSID = $objUser.Translate([System.Security.Principal.SecurityIdentifier])
$SID = $strSID.Value
# delets user
net user $username /DELETE
# removes folder
rmdir /q $path
Remove-Item -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList\$SID" 
```

调用 PowerShell 脚本的 C#：

```
class RunScript
{
    public static void FireScript(String script, Hashtable var)
    {
        RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();
        Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
        runspace.Open();
        RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);

    Pipeline pipeline = runspace.CreatePipeline();

    String scriptfile = "..\\..\\Resources\\" + script + ".ps1";

    Command myCommand = new Command(scriptfile, false);

    foreach (DictionaryEntry entry in var)
    {
        CommandParameter testParam = new CommandParameter(entry.Key.ToString(),entry.Value);

        //CommandParameter testParam = new CommandParameter(null, entry.Value);
        myCommand.Parameters.Add(testParam);
    }

    pipeline.Commands.Add(myCommand);
    Collection<PSObject> psObjects;
    psObjects = pipeline.Invoke();
    runspace.Close();
}
} 
```

调用firescript的代码：

```
Hashtable var = new Hashtable();
var.Add("username","testb");
var.Add("path", "C:\\Documents and Settings\\testb");
RunScript.FireScript("remove user",var); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:12:07.223

我认为您需要设置此参数属性：符合[此链接](http://msdn.microsoft.com/en-us/library/ms714348%28VS.85%29.aspx)的 ValueFromPipeline表示“可选命名参数”。True 表示 cmdlet 参数从管道对象中获取其值。如果 cmdlet 访问完整的对象，而不仅仅是对象的属性，请指定此关键字。默认为假。

您还可以查看[此链接](http://tfl09.blogspot.ro/2009/01/parameter-attributes-in-powershell-v2.html)以获取一些示例。代码可能是这样的：

```
param(
      [parameter(Position=0, ValueFromPipeline=$true)][string]$username
      [parameter(Position=1, ValueFromPipeline=$true)][string]$path
     ) 
```

# c# - windows窗体生命周期中发生的事件

> ID：11970935
> 
> 赞同：0
> 
> 时间：2012-08-15T14:14:43.987
> 
> 标签：c#, winforms, .net-4.0, .net-3.5, .net-2.0

哪个事件发生在`Form Load`事件之前？

因为我有一个`timer`控件，我在表单加载事件中为其编写`timer.start()`了方法，并且当前时间显示在`Label`控件中。

`Timer`当表单加载时开始，但显示时间需要几秒钟，那么有没有其他方法可以快速显示时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T14:16:30.173

有一个名为 ShowTheTime 的函数。在表单加载中调用它。还要在表单加载中启动您的计时器。您的计时器处理程序也调用 ShowTheTime。

我在这里错过了什么吗？这似乎有点微不足道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T14:25:00.367

您可能正在使用 Forms 命名空间中的 Timer。该组件与 UI 紧密耦合。您应该查看与 UI 无关的[Threading.Timer](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)类。您将完全控制它，并且可以从表单的构造函数（甚至更早，在创建表单之前）启动它。

这是一篇[非常古老的文章](http://msdn.microsoft.com/en-us/magazine/cc164015.aspx)，但其中的概念仍然成立。（比较不同的 Timer 类。）基本上是上一篇文章的[缩写版本](http://csharptips.wordpress.com/2010/08/24/thread-timer/)。

# java - Java Html解析器提取特定数据？

> ID：11970938
> 
> 赞同：1
> 
> 时间：2012-08-15T14:15:03.127
> 
> 标签：java, html-parsing, web-scraping

我有一个如下的html文件

```
...
<span itemprop="A">234</span>
...
<span itemprop="B">690</span>
... 
```

在这我想提取值作为A和B。
你能推荐任何可以轻松做到这一点的java html解析器库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T14:21:16.877

就个人而言，我更喜欢**[JSoup](http://jsoup.org/cookbook/extracting-data/attributes-text-html)**而不是**JTidy**。它有类似 CSS 的[选择器](http://jsoup.org/apidocs/org/jsoup/select/Selector.html)，而且文档要好得多，恕我直言。使用 JSoup，您可以使用以下几行轻松提取这些值：

```
Document doc = Jsoup.connect("your_url").get();
Elements spans = doc.select("span[itemprop]");

for (Element span : spans) {
  System.out.println(span.text()); // will print 234 and 690
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T14:16:15.847

[http://jsoup.org/](http://jsoup.org/)

JSoup 是要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:17:18.737

[JTidy](http://jtidy.sourceforge.net/)是一个名称混乱但受人尊敬的 HTML 解析器。

# perl - 如何在 DBIx::Class 中创建包含相关对象的行对象？

> ID：11970939
> 
> 赞同：2
> 
> 时间：2012-08-15T14:15:05.460
> 
> 标签：perl, relationship, dbix-class

当您[`create`](http://search.cpan.org/dist/DBIx-Class/lib/DBIx/Class/ResultSet.pm#create)使用 Row 对象时，`DBIx::Class`您可以将相关对象作为值传递，例如

```
my $author = $authors_rs->find(1);
my $book = $books_rs->create({ author => $author, title => 'title' }); 
```

但是，如果您稍后使用`author`访问器，则会再次从数据库中检索该对象。是否可以创建一个对象，以便无需额外查询即可访问关联的对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T15:17:56.080

将你想要的东西从 $author 复制到一些普通的旧 Perl 变量中怎么样？

如果您想复制整个结构，[克隆](http://search.cpan.org/~rdf/Clone-0.31/Clone.pm)模块可能会有所帮助（我没有使用此模块的经验；我只是在网上找到的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T17:01:07.153

我不确定我是否正确地理解了您，但如果我是的话，也许您想研究一下[`prefetch`](https://metacpan.org/module/DBIx%3a%3aClass%3a%3aResultSet#prefetch)自动准备好调用那些其他相关行对象的功能。

例如，在[`Galileo`](http://p3rl.org/Galileo)列出所有页面（文章）时，我使用这种机制来获取每个页面对象的相关作者对象（[参见此处](https://github.com/jberger/Galileo/blob/master/lib/Galileo/files/templates/admin/pages.html.ep#L4)）。

* * *

好的，如果关键是将一个对象存储在另一个对象中，您可能希望将一些额外的数据注入到对象中。

未经测试：

```
## some initial checks (run these only once)

# check that method name is available
die "Cannot use method 'extra_data'" if $book->can('extra_data');

# check that the reftype is a hash
require Scalar::Util;
die "Incorrect underlying type" unless Scalar::Util::reftype($book) eq 'HASH';

# check that the key is available
die "Key unavailable" if exists $book->{'my_extra_data'};

{
  no strict 'refs';
  # create a simple accessor for a hash stored in an object
  *{ ref($book) . '::extra_data' } = sub {
    my $self = shift;

    #return all extra data if called without args
    return $self->{my_extra_data} unless @_; 

    my $key = shift;
    if (@_) {
      $self->{my_extra_data}{$key} = shift;
    }

    return $self->{my_extra_data}{$key};
  };
}

$book->extra_data( author => $author );

#then later

my $stored_author = $book->extra_data('author'); 
```

# php - Socialcast - 使用 PHP 登录

> ID：11970945
> 
> 赞同：0
> 
> 时间：2012-08-15T14:15:15.413
> 
> 标签：php, api, curl

我正在尝试从 PHP 访问 SocialCast 的 API。他们只有一个例子，用 curl 完成：

```
# Curl Example
curl -X POST -d 'password=demo&amp;amp;amp;email=emily@socialcast.com' -v https://demo.socialcast.com/api/authentication.xml 
```

如何使用 PHP 进行登录？

这是 API 文档：http: [//developers.socialcast.com/api-documentation/http-basic-authentication/#authentication_api_create](http://developers.socialcast.com/api-documentation/http-basic-authentication/#authentication_api_create)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T14:17:05.960

您可能想使用 php curl 包装器[http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

像这样的东西：

```
 $ch = curl_init("https://demo.socialcast.com/api/authentication.xml");
 curl_setopt($ch, CURLOPT_POST, 1);
 curl_setopt($ch, CURLOPT_POSTFIELDS, "password=demo&amp;amp;amp;email=emily@socialcast.com");
 curl_setopt($ch, CURLOPT_FOLLOWLOCATION , 1);
 curl_setopt($ch, CURLOPT_HEADER , 0);
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);  
 $resp = curl_exec($ch); 
```

# c# - 在 SharePoint 列表项中切换/反转字符串

> ID：11970948
> 
> 赞同：0
> 
> 时间：2012-08-15T14:15:20.393
> 
> 标签：c#, sharepoint-2010, listitem

我有一个问题，是否可以在代码后面的 SharePoint 列表项中切换/反转字符串值的顺序，然后显示处理后的字符串的结果。

因此，目前为了说明这一点，我有一个“员工”SharePoint 列表，其中包含以下列：

*   标题
*   位置

现在标题列具有以下值：

*   特德贝克
*   乔皮尔斯

我有一个显示列表项值的简单 Web 部件，但对于“标题”字段而不是显示“Ted Baker”，我希望它显示为“Baker Ted”，因此基本上首先显示最后一个字符串值。

这是可能的吗？如果可以，最好的方法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T17:47:34.717

```
string name = "Ted Baker";
string newname = String.Join(" ",name.Split(' ').Reverse()); 
```

# c# - 强制子类初始化字段

> ID：11970956
> 
> 赞同：11
> 
> 时间：2012-08-15T14:15:45.447
> 
> 标签：c#, oop

我有抽象基类，其中包含一些字段和一些作用于这些字段的方法。例如：

```
public abstract class A
{
    protected double _field;

    public double SquaredField { get { return _field * _field; } }

    ... some other abstract methods
} 
```

我想在其构造函数中强制 A 的所有子项初始化 _field

```
public class B : A
{
    public B(double field)
    {
         _field = Math.Sqrt(field);
    }

    ... some other method implementations
} 
```

实现这一目标的正确模式是什么？

**- 编辑**

我最终做的是：

```
public abstract class A
{
    protected readonly double _field;

    public A(double field)
    {
         _field = field;
    }

    public double SquaredField { get { return _field * _field; } }

    ... some other abstract methods
}

public class B : A
{
    public B(double field) : base(field)
    {
    }

    public static B CreateNew(double val)
    {
         return new B(Math.Sqrt(field));
    }

    ... some other method implementations
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-15T14:18:40.297

根本不要向派生类公开*字段。*相反，创建一个受保护的抽象*属性*：

```
public abstract class A
{
    protected double Field { get; }

    public double SquaredField { get { return Field * Field; } }
} 
```

或者，如果该字段对于特定实例应该始终是常量，则将其设为构造函数参数并保持私有：

```
public abstract class A
{
    private readonly double _field;

    public double SquaredField { get { return _field * _field; } }

    protected A(double field)
    {
        _field = field;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-15T14:19:19.293

不要让类`A`有一个无参数的构造函数：

```
public abstract class A
{
    protected double _field;

    public double SquaredField { get { return _field * _field; } }

    // Require any fields that must be initialized in the base class's
    // constructor. If there are a lot of such fields, consider encapsulating
    // them all in their own class, e.g. AArgs.
    protected A(double field)
    {
        _field = field;
    }
}

public class B : A
{
    // You must call a base class constructor as below, because class A
    // no longer has a parameterless constructor to use by default.
    public B(double field)
        : base(field)
    {
    }
} 
```

### 附录

如果您不能在构造函数中进行初始化，则可以将字段设置为抽象属性：

```
public abstract class A
{
    protected abstract double Field { get; }

    public double SquaredField { get { return Field * Field; } }
} 
```

现在，派生类必须实现该属性，因此您将为依赖`SquaredField`属性做好准备。不过我会更改名称，因为它们不再是字段。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-15T14:33:16.383

这可能是一个信号，表明字段组比`A`自身更紧密耦合，因此应该将其移动到一个类中，例如`AParams`.

然后`A`你可以声明一个`abstract protected AParams createParams()`方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T14:26:08.740

您可以使用单独的抽象函数来完成此操作。子类将被迫实现它。

```
public abstract class A
{
    protected double _field;

    protected A()
    {
        InitializeField();
    }

    protected abstract void InitializeField();

    public double SquaredField { get { return _field * _field; } }
}

public class B : A
{
    protected override void InitializeField()
    {
        // Initialize...
    }
} 
```

# salesforce - 如何在我的自定义 apex:pageBlockTable for Cases 上获得“新建”按钮？

> ID：11970958
> 
> 赞同：0
> 
> 时间：2012-08-15T14:15:49.970
> 
> 标签：salesforce, apex-code, visualforce

我有一个自定义案例顶点页面，我使用 a`apex:pageBlockTable`来显示我的案例列表。这是它的代码：

```
<apex:page standardController="Case" recordSetVar="Case" sidebar="true" showHeader="true">
    <apex:form >
        <apex:pageBlock title="Cases">
              <apex:outputLabel value="View:"/>
              <apex:selectList value="{!filterId}" size="1">
                <apex:actionSupport event="onchange" rerender="cases_table"/>
                <apex:selectOptions value="{!listviewoptions}"/>
              </apex:selectList>
            <apex:pageBlock >
                <apex:pageBlockButtons >
                </apex:pageBlockButtons>
                <apex:pageBlockTable value="{!case}" var="c" rows="50" id="cases_table" >
                    <apex:column >
                        <a target="_parent" href="{!URLFOR($Action.Case.View, c.id)}">{!c.CaseNumber}</a>
                        <apex:facet name="header">Case Number</apex:facet>
                    </apex:column>
                    <apex:column value="{!c.ContactId}" />
                    <apex:column value="{!c.Subject}" />
                    <apex:column value="{!c.Status}" />
                    <apex:column value="{!c.Priority}" />
                </apex:pageBlockTable>
            </apex:pageBlock>
        </apex:pageBlock>
    </apex:form>
    <base target="_parent"/>
</apex:page> 
```

我想`apex:pageBlockButtons`在默认案例页面中获得一个按钮。当用户单击按钮时，我希望它将用户带到新的案例页面。我试过这个：

```
<apex:commandButton action="{!new}" value="New"/> 
```

但这给了我一个错误。如何制作一个按钮，将我带到新的案例页面？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-15T16:34:04.267

尝试这个：

```
<apex:commandButton onclick="window.location.href='{!URLFOR($Action.Case.NewCase)}'" value="New" immediate="true" rerender="blank"/> 
```

需要注意的是需要重新渲染标签，否则页面将进行回发。通过使用虚拟重新渲染标签，重定向将起作用。立即可以避免在点击时运行任何验证规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-29T14:09:34.637

我有一个自定义`Cases apex`页面，我使用 a`apex:pageBlockTable`来显示我的案例列表。这是它的代码（自定义对象）：

```
<apex:commandButton action="{!URLFOR($Action.Your_Custom_Object__c.New)}" ...> 
```

# json - 响应中的有效 JSON

> ID：11970962
> 
> 赞同：15
> 
> 时间：2012-08-15T14:16:13.620
> 
> 标签：json, api, http, rest

我正在开发客户端和服务器应用程序，遇到了一个有趣的问题。我们正在创建一个 RESTful API 并使用 JSON 响应与客户端通信。执行 DELETE 时，我们返回 200 OK 并返回空白响应。我们的客户得到了 200 OK，但解析 JSON 失败。

我们完全理解失败的解析（没有什么可解析的），但我们有一个更大的问题。发送一个空白响应是有效的 JSON，还是我们应该返回`{}`或类似的东西？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-15T14:52:10.943

从关于 DELETE 方法的[HTTP/1.1 定义中：](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.7)

> 如果响应包含描述状态的实体，则成功的响应应该是 200（OK），如果操作尚未制定，则为 202（已接受），或者如果操作已经制定但响应不包括，则应为 204（无内容）一个实体。

因此，如果您的服务器立即删除该项目，那么建议的响应将是：

*   200 OK - 返回某种状态码（如布尔值 true，或表示“成功”的字符串）
*   204 No Content - 不返回任何内容，并让您的客户端注意此响应并且不尝试 JSON 解析，同时仍然知道请求成功

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-15T14:18:49.520

在这里做一个快速测试：http: [//jsonlint.com/](http://jsonlint.com/)显示空白不是有效的 JSON，`{}`而是有效的 JSON。

# c++ - 我应该使用什么函数签名来返回对可能不存在的对象的引用？

> ID：11970974
> 
> 赞同：5
> 
> 时间：2012-08-15T14:16:49.973
> 
> 标签：c++, reference, parameters

我正在用 C++ 编写一个简单的容器类，类似于存储由键索引的对象的映射。我想提供一个访问器功能，例如：

```
V& getValue(const K &key); 
```

我在其中返回对该值的**引用。**

但我也想处理键/值不存在并能够向用户返回一些状态的情况（可能有一些原因导致我想通过某种状态类型与调用者通信回不存在）。

我想我可以执行以下操作，但调用它需要在调用此函数之前构造一个 V 对象，我只是要将内部 V 对象复制到通过引用传入的对象中，所以这看起来很糟糕.

```
Status getValue(const K &key, V& v); 
```

我也可以这样做：

```
V &getValue(const K &key, Status &s); 
```

但是由于某种原因，这似乎有点笨拙，因为焦点从状态中移开，用户可能会忘记检查它（但也许这不是我的问题）。

那么无论如何有没有类似的功能

```
Status getValue(const K &key, V& v); 
```

在调用它之前不需要构造一个虚拟的 V 对象吗？您不能将引用传递给引用。我想我可以使用指针并且很乐意这样做，但是对于创建一个简单易用和关于函数的推理来说不太理想。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T14:35:13.400

您可以使用原始函数`V& getValue(const K &key)`，并引发异常以指示不成功的`Status`值。

然后，调用者可以选择延迟他们处理问题的方式（通过让异常冒泡到适当的处理程序），但他们不能完全忘记它，因为否则程序会崩溃。呼叫站点不必堆满状态检查和错误报告代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:25:44.020

通常的解决方案是提供一个`bool contains(const K &key)`函数，如果您不希望访问器静默创建条目，请让它抛出异常。（有两个访问器，一个抛出异常，另一个创建条目也很常见）

当然，这可能不是你想要的。您想将所有这些都放入一个函数中的原因是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:19:34.303

`boost::optional`如果您不想使用 boost，我会使用或创建一个类似的模板。使用`boost::optional`您的功能将如下所示：

```
boost::optional<MyClass &> getValue(const K &key) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-15T14:25:09.173

我看到 3 个选项：

1.  返回一个可以转换为 V& 的“包装器”对象，并且可以判断它是否存储了有效的引用（可以围绕 V* 实现）。
2.  返回一个指针。
3.  如果未找到密钥，则返回引用并抛出异常。

我个人会带一个指针。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T14:58:17.823

First I'll answer your question as written: I would suggest returning a `boost::optional<boost::ref<V> >` so that you can still return by reference, but optionally so.

However, I wouldn't suggest this interface. The standard containers already have an interface that solves this exactly problem, namely returning iterators rather than values. I would suggest just using an "iterator" interface (it doesn't have to be a real full-blown iterator) and returning an `end`/one past the end to indicate that the iter is not found, rather than returning by reference or not. The more you make your container's interface look like a standard container, the greater your options for using standard algorithms AND plugging it in anywhere you want as a substitution.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-15T14:22:53.977

考虑返回`boost::variant<V &, Status>`or (equivalently) `boost::variant<std::reference_wrapper<V>, Status>`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-15T14:25:49.123

我会遵循 std::map 接口的一个想法：

```
std::pair<iterator,bool> getValue(const K& key); 
```

值对象可通过迭代器访问，`bool`标志显示该值是否存在。

# facebook - Rails + omniauth + facebook - 检测到 csrf

> ID：11970977
> 
> 赞同：4
> 
> 时间：2012-08-15T14:16:58.113
> 
> 标签：facebook, ruby-on-rails-3.2, omniauth

我正在通过现有`facebook`帐户登录网站。所以我注册了一个 facebook 应用程序并将api**和**secret**存储**在文件中。然后我用+来实现这个。它工作完美。`development.rb``production.rb``omniauth-facebook gem``devise gem`

顺便说一句，用户可以通过内部身份验证（通过设计）或使用 facebook 帐户登录。

然而有一个奇怪的问题。**只有**当我在注册应用程序时登录到 Facebook 帐户时，它才能完美运行。

所以我注册了另一个在我的 Rails 应用程序中没有使用应用程序的 Facebook 帐户并尝试登录。它导致错误“发生错误。请稍后再试。” ... **“无法通过 Facebook 帐户对您进行身份验证，因为“检测到 Csrf””**

我尝试使用 1.4.0 omniauth-facebook gem 而不是 1.4.1，但它也导致了错误“ `must pass either a`code `parameter or a signed request (via`signed_request `parameter or a`fbsr_XXX `cookie)`”

宝石

```
oauth2 (0.8.0) 
omniauth (1.1.0) 
omniauth-oauth2 (1.1.0) 
omniauth-facebook (1.4.1) 
warden (1.2.1)
devise (2.1.2) 
```

你的想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T16:39:02.243

我也遇到了这个问题，结果我的 Facebook 应用程序中仍然启用了“沙盒”模式。听起来这也可能是您的问题:)

如果没有，您能否发布任何相关的日志条目？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-20T21:58:23.083

对我来说，我需要添加`provider_ignores_state: true`到我的 Omniauth 配置中：

```
config.omniauth :facebook, ENV['FACEBOOK_APP_ID'], ENV['FACEBOOK_APP_SECRET'], {
  strategy_class: OmniAuth::Strategies::Facebook,
  provider_ignores_state: true
} 
```

这是在`omniauth-facebook`gem 版本 1.6.0 上。

[https://github.com/mkdynamic/omniauth-facebook/issues/73](https://github.com/mkdynamic/omniauth-facebook/issues/73)上还有更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-28T20:49:24.887

我在删除“omniauth.rb”时解决了这个问题，因为我在 devise.rb 中已经有了这个配置：

```
 config.omniauth :facebook, ENV["FB_ID"], ENV["FB_SECRET"],
    scope: 'email',
    info_fields: 'email, first_name, last_name',
    image_size: 'large',  # 50x50, guaranteed ratio
    secure_image_url: true 
```

记得重启服务器进行测试。

# javascript - MVC Razor 在 javascript 视图中从控制器获取值

> ID：11970978
> 
> 赞同：0
> 
> 时间：2012-08-15T14:17:03.447
> 
> 标签：javascript, asp.net-mvc, razor

我必须从视图中的控制器方法获取值才能写入一些 javascript。在网页中它就像 <%=functionName()%> 一样简单。有没有办法在 MVC 中做到这一点。我无法使用该模型，因为 javascript 必须在页面加载时可用。任何见解表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T14:18:25.913

> 有没有办法在 MVC 中做到这一点

是的当然。

> 我无法使用该模型，因为 javascript 必须在页面加载时可用。

当然，您可以使用视图模型，没有什么可以阻止您这样做。所以你首先定义它：

```
public class MyViewModel
{
    public string Foo { get; set; }
} 
```

然后有一个控制器动作来填充这个视图模型并将其传递给视图：

```
public ActionResult Index()
{
    var model = new MyViewModel();
    model.Foo = "Hello World"; 
    return View(model);
} 
```

最后对该视图模型有一个强类型视图，其中：

```
@model MyViewModel
<script type="text/javascript">
    $(function() {
        var foo = @Html.Raw(Json.Encode(Model.Foo));
        alert(foo);
    });
</script> 
```

但是现在让我们假设您不想用 javascript 污染您的视图，而是将它放在一个单独的 js 文件中（这当然是正确的方法）。

您可以将值嵌入到 DOM 中的某个位置，例如使用 HTML5`data-*`属性：

```
<div id="foo" data-model="@Html.Raw(Html.AttributeEncode(Json.Encode(Model)))">
    Click me to surprise you
</div> 
```

然后在一个单独的 javascript 中订阅该元素的 click 事件并读取`data-*`我们已在其中 JSON 序列化整个视图模型的属性：

```
$(function() {
    $('#foo').click(function() {
        var model = $(this).data('model');
        alert(model.Foo);
    });
}); 
```

# ms-access - SELECT DISTINCT 在包含空值或太多值的字段上出现多选列表框错误

> ID：11970982
> 
> 赞同：1
> 
> 时间：2012-08-15T14:17:13.807
> 
> 标签：ms-access, ms-access-2003

我下面的代码显示了在多选列表框中选择的项目的不同值。它完美地工作，除非在以下条件下：

1.  字段包含部分或全部 null 值（无效使用 Null）
2.  字段包含太多不同的值，例如包含 11,000 条记录的文件中的姓氏。错误消息在（内存不足）和（超出系统资源）之间变化

编码 ...

```
Private Sub ShowScrubbedDistinct_Click()
Dim cn1 As ADODB.Connection
Dim rs1 As New ADODB.Recordset
Dim cmd1 As New ADODB.Command
Dim varItem As Variant
Dim aFields() As aArray
Dim NumRows As Integer
Dim NumFields As Integer
Dim colcount As Integer
Dim colwidths As String
Dim strRow As String
Dim cnt1 As Integer
Dim cnt2 As Integer

Me.ScrubbedFieldVal2.RowSource = ""

ReDim aFields(50)
For cnt1 = 1 To 50
    ReDim aFields(cnt1).fValue(12000)
Next

NumRows = 0
colcount = 0

For Each varItem In Me!ScrubbedList.ItemsSelected
    colcount = colcount + 1
    aFields(colcount).fName = Me!ScrubbedList.ItemData(varItem)
    NumFields = 0

    rs1.Open "SELECT DISTINCT " & Me!ScrubbedList.ItemData(varItem) & "  FROM Scrubbed", 
CurrentProject.Connection, adOpenKeyset, adLockOptimistic

    If rs1.RecordCount > NumRows Then NumRows = rs1.RecordCount
    strRow = strRow & Me!ScrubbedList.ItemData(varItem) & ";"

    While Not rs1.EOF
        NumFields = NumFields + 1
        If NumFields > NumRows Then
            NumRows = NumFields
        End If

         aFields(colcount).fValue(NumFields) = rs1(0)

        rs1.MoveNext
    Wend
    rs1.Close
Next varItem
strRow = Left(strRow, Len(strRow) - 1)

Me.ScrubbedFieldVal2.ColumnCount = colcount
Me.ScrubbedFieldVal2.ColumnWidths = Mid(colwidths, 2)
Me.ScrubbedFieldVal2.AddItem (strRow)

For cnt1 = 1 To NumRows

    strRow = ""
    For cnt2 = 1 To colcount
        If aFields(cnt2).fValue(cnt1) = "" Then
            strRow = strRow & ";"
        Else
            strRow = strRow & aFields(cnt2).fValue(cnt1) & ";"
        End If
    Next
    strRow = Left(strRow, Len(strRow) - 1)
    Me.ScrubbedFieldVal2.AddItem (strRow)

    Next

    End Sub 
```

# css - CSS - 如何在不更改任何其他内容的情况下删除第二个垂直滚动条？

> ID：11970984
> 
> 赞同：9
> 
> 时间：2012-08-15T14:17:15.353
> 
> 标签：css, scrollbar, overflow

我正在尝试摆脱出现在我整理的此页面上的明显不需要的第二个垂直滚动条，请参阅[http://abchealth.info/doc-mike-special/test3/](http://abchealth.info/doc-mike-special/test3/)。

我在这里的研究使我尝试从我的 CSS 中删除“溢出”，但这绝对破坏了我的布局，所以我正在寻找一种解决方案，可以在不更改任何其他内容的情况下删除内部垂直滚动条......

非常感谢您的帮助，谢谢！

这是我的CSS：

```
/* Generated by KompoZer */

body {
background-image: url(http://abchealth.info/images/bg.png);
}

html, body {
margin: 0;
padding: 0;
height: 100%;
min-height: 100%;

}

div#wrap {min-height: 100%;}

div#mastercontainer {
overflow:auto;  width: 100%;
height: 100%;
min-height: 100%;
}

div#header {
background-image: url(http://abchealth.info/images/header-bg.jpg);  background-repeat:   
repeat-x;
position: top; height: 96px;}

div#content {
}

div#innercontentmiddle {
margin: 0 auto;
width: 540px;
padding:10px;    padding-bottom:510px;}

div#footerclear {
}

div#footer {
position:relative;  margin-top: -510px; height: 510px; clear:both;
background-image: url(http://abchealth.info/images/footer-bg.jpg);  background-repeat:   
repeat-x;}

/*Opera Fix*/
body:before {
content:"";
height:100%;
float:left;
width:0;
margin-top:-32767px;/
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-15T14:21:14.260

改变这个：`#mastercontainer {overflow:auto;}`到`#mastercontainer {overflow: visible;}`

如果内容对于框架来说太大，正在发生的事情是“自动”使用滚动条。也就是 div 或 w/e 需要放大以避免滚动。可见会让它像我想的那样溢出。可见甚至隐藏都可以与此代码一起使用——css 就是关于玩耍和试验的。

***大多数浏览器都提供一个名为“FireBug”的插件 -> 下载它。它允许您在查看时编辑网页的 css 等。对于 css 样式错误非常有用。强烈推荐用于此类问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-15T14:20:46.353

这有效

`#mastercontainer { overflow: hidden; }`

或上述解决方案也有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-15T14:20:03.683

`overflow:auto`从中删除`div#mastercontainer`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-02T11:02:35.523

如果问题是由于 html, body { overflow-x: hidden;} 那么尝试使用 html, body{height: 100%;} 它对我来说很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-26T00:44:40.993

在许多情况下，将overflow-y 设置为'hidden' 可以移除垂直滚动条。可以将其设置为“可见”，因为这意味着溢出是可见的，这意味着不需要滚动，因此滚动条不可见。

然而，这些设置并不总是有效，因为 [https://developer.mozilla.org/en-US/docs/Web/CSS/overflow](https://developer.mozilla.org/en-US/docs/Web/CSS/overflow)上所说的：

> 为了使溢出产生效果，块级容器必须具有设置高度（高度或最大高度）或空白设置为 nowrap。

上面的链接是尝试了解“溢出”一般如何工作的好资源，它并不像您希望的那么简单。

例如，另一个注释，从那里：

> 将一个轴设置为可见（默认），而将另一个轴设置为不同的值会导致可见行为为自动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-06T03:19:22.217

对于使用***ion-icons 和 bootstrap***的任何人，问题可能在 ionic/structure.css 中。我在网站和**ionic/structure.css**中使用了 ion-icons，我发现这两个属性导致了问题，并且更改它们解决了问题。

```
{
  overflow: hidden;
  overscroll-behavior-y: none;
} 
```

**变成：**

```
{
  overflow: scroll;
  overscroll-behavior-y: scroll;
} 
```

# crystal-reports-2010 - Crystal Reports 找不到文件

> ID：11970991
> 
> 赞同：2
> 
> 时间：2012-08-15T14:17:40.593
> 
> 标签：crystal-reports-2010, crystal-reports-server

我在构建使用 Crystal Reports for VS 2010 的新应用程序时收到以下错误。在我的桌面上运行报告，移动到服务器导致以下结果。

无法加载文件或程序集“CrystalDecisions.ReportAppServer.ClientDoc，版本=13.0.2000.0，文化=中性，PublicKeyToken=692fbea5521e1304”或其依赖项之一。该系统找不到指定的文件。

我在 32 位操作系统上开发报告并移至 64 位服务器。运行时下载和安装版本为 13_0_4。

是否有我遗漏的参考资料或者我需要重新安装运行时？我还需要安装合并模块吗？

任何帮助表示赞赏。

# vbscript - 如何验证 Windows Server 中未使用的 NIC 是否已禁用？

> ID：11970994
> 
> 赞同：0
> 
> 时间：2012-08-15T14:17:49.373
> 
> 标签：vbscript, wmi

我需要检查一个 Windows Server（一天很多），然后验证未使用的 NIC 是否被禁用。这只是我正在做的许多检查之一。

我试图弄清楚我该如何做到这一点，这是我的以下代码。它给了我一个 objNetwork.PhysicalAdapter 说的错误

> 对象不支持此属性或方法：'objNetwork.PhysicalAdapter'

```
Sub CheckUnusedNICs()
   WScript.Echo("Check for unused NICs")
   WScript.Echo("------------------------------------")
   Set colNetwork = objWMISrvc.ExecQuery("SELECT * from Win32_NetworkAdapter")
   For each objNetwork in colNetwork
      WScript.Echo objNetwork.AdapterTypeID & vbCrLf
      WScript.Echo objNetwork.PhysicalAdapter
     'If (objNetwork.AdapterTypeID = 0 AND objNetwork.PhysicalAdapter = True) Then
    '    WScript.Echo("Placeholder")
     ' End If
   Next
End Sub 
```

我绝不精通 VBScript，但我正在学习它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T17:07:46.813

WMI`Win32_NetworkAdapter`类没有`PhysicalAdapter`属性。

改为使用`NetConnectionStatus`和`ConfigManagerErrorCode`属性。

设备将是：

*   在以下情况下启用并连接：
    `NetConnectionStatus = 2`

*   在以下情况下启用且未插入电缆：
    `NetConnectionStatus = 7`

*   在以下情况下因禁用设备而断开连接：
    `(NetConnectionStatus = 0) and (ConfigManagerErrorCode = 22)`

有关课程的更多详细信息，`Win32_NetworkAdapter`包括上述代码的完整列表，请访问：http:
[//msdn.microsoft.com/en-us/library/windows/desktop/aa394216 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394216(v=vs.85).aspx)

# android - Web 服务在 Android 中返回 null

> ID：11970996
> 
> 赞同：1
> 
> 时间：2012-08-15T14:17:56.417
> 
> 标签：android, web-services, ksoap2, android-ksoap2

我有一个在我的 android 项目中使用的 Web 服务。我的网络服务中的一种方法在带有 ksoap2 的 android 中返回 null。当我调试项目时，信封返回如下：

```
GPSYerBilgisiGetirResponse{GPSYerBilgisiGetirResult=anyType{}; } 
```

在 android 之外，我运行 Web 服务并为方法提供参数，返回如下数据：

```
<ArrayOfFirma xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://tempuri.org/">
<Firma>
<gpsilce>BEYOĞLU</gpsilce>
<gpssemt>KASIMPAŞA</gpssemt>
</Firma>
</ArrayOfFirma> 
```

这是我使用连接到网络服务的功能

```
private String[] konumGetir(String ParamPK){
    PropertyInfo pk = new PropertyInfo();
    pk.name= "pk";
    pk.setValue(ParamPK);
    pk.type = PropertyInfo.STRING_CLASS;

    SoapObject request = new SoapObject(NAMESPACE, "GPSYerBilgisiGetir");
    request.addProperty(pk);
    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.bodyOut=request;
    envelope.dotNet = true;
    envelope.setOutputSoapObject(request);
    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
    androidHttpTransport.debug = true;

   try {

   androidHttpTransport.call("http://tempuri.org/GPSYerBilgisiGetir", envelope);
   SoapObject response = (SoapObject) envelope.getResponse();
   konumList=new String[1];

   for(int i=0;i<response.getPropertyCount();i++){    
       Object property = response.getProperty(i);
       if(property instanceof SoapObject){
           SoapObject firmalar = (SoapObject) property;
           konumList[0]=firmalar.getProperty("gpssemt") + "-" + firmalar.getProperty("gpsilce");
       }
    }
} 
    catch (Exception e) {           
        e.printStackTrace();
   }
    return konumList;

    } 
```

这是我的网络服务方法：

```
<WebMethod()> _
    Public Function GPSYerBilgisiGetir(ByVal pk As String) As List(Of Firma)
        Dim konumlist As New List(Of Firma)

        Dim dg As New dgetir("SELECT DISTINCT ILCE,SEMT FROM GPSYERBILGISI WHERE PK='" + pk + "'")
        While dg.dtr.Read
            Dim gpskonum As New Firma

            gpskonum.gpsilce = dg.dtr.Item("ILCE")
            gpskonum.gpssemt = dg.dtr.Item("SEMT")
            konumlist.Add(gpskonum)

        End While
        dg.close()

        Return konumlist

    End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T16:40:48.880

试试这个代码。

```
private String[] konumGetir(String ParamPK){
   SoapObject request = new SoapObject(NAMESPACE, "GPSYerBilgisiGetir");
   request.addProperty("pk", ParamPK);
   SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
   envelope.dotNet = true;
   envelope.setOutputSoapObject(request);
   HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
  try {
     androidHttpTransport.call(SOAP_ACTION_NAME, envelope);
     SoapObject result = (SoapObject) envelope.getResponse();
     int childCount = result.getPropertyCount();
     konumList = new String[childCount];
     SoapObject tempArray[] = new SoapObject[childCount];
     int i;
     for (i = 0; i < childCount; i++) {
        tempArray[i] = (SoapObject) result.getProperty(i);
        konumList[i] = tempArray.getProperty(0).toString();
     }
  } catch (Exception e) {           
     e.printStackTrace();
  }
  return konumList;

} 
```

希望能帮助到你。

# solr - 在 Solr 中使用 DIH 导入时如何从 rss 提要转换 pubDate？

> ID：11970997
> 
> 赞同：0
> 
> 时间：2012-08-15T14:18:08.397
> 
> 标签：solr, dih, pubdate

我在 solr 中使用 RSS DIH 来索引各种 rss 提要。我面临的问题是日期字段。RSS 中的 pubDate 返回不是 Solr 期望的格式，因此当我使用这个 rss-data-config.xml 文件启动我的 Solr 时出现异常。有人能告诉我如何将 rss 日期转换为 rss-data-config.xml 文件中的 solr 预期日期格式吗？

在 Schema.xml 中，我将 pubDate 定义为日期。

这是我的 rss-data-config.xml 的外观：

```
<dataConfig>
    <dataSource type="URLDataSource" name="dsurl"/>
    <dataSource type="JdbcDataSource" name="dsdb" driver="com.mysql.jdbc.Driver" url="jdbc:mysql://localhost:3306/HCDACoreDB" user="root" password="CDA@318"/>
    <document>
        <entity name="rssimports"
                pk="link"
                url="${dataimporter.request.feedurl}"
                processor="XPathEntityProcessor"
                forEach="/rss | /rss/channel | /rss/channel/item"
                transformer="HTMLStripTransformer"
                dataSource="dsurl">

            <field column="source" xpath="/rss/channel/title" commonField="true" dataSource="dsurl"/>
            <field column="source-link" xpath="/rss/channel/link" commonField="true" dataSource="dsurl"/>
            <field column="Source-desc" xpath="/rss/channel/description" commonField="true" dataSource="dsurl"/>

            <field column="title" xpath="/rss/channel/item/title" dataSource="dsurl"/>
            <field column="link" xpath="/rss/channel/item/link" dataSource="dsurl"/>
            <field column="description" xpath="/rss/channel/item/description" stripHTML="true" dataSource="dsurl"/>
        <field column="pubDate" xpath="/rss/channel/item/pubDate" dataSource="dsurl"/>

            <field column='${dataimporter.functions.formatDate('${dataimporter.request.pubDate}', 'EEE, dd MMM YYYY HH:mm:ss z')}' name="pubDate"/>
            <field column="guid" xpath="/rss/channel/item/guid" dataSource="dsurl"/>
            <field column="content" xpath="/rss/channel/item/content" dataSource="dsurl"/>
            <field column="author" xpath="/rss/channel/item/creator" dataSource="dsurl"/>

        <entity name="feedcategory" 
                query="select category.CategoryName from feeds, category where feeds.FeedUrl = '${dataimporter.request.feedurl}' AND feeds.FeedCategory = category.CategoryId"
                processor="SqlEntityProcessor" 
                dataSource="dsdb">
            <field column="CategoryName" name="category" dataSource="dsdb"/>
        </entity>
        </entity>
    </document>
</dataConfig> 
```

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T15:33:42.133

You want to set up the DateFormatTransformer to deal with getting the date to the format solr is expecting.

[http://wiki.apache.org/solr/DataImportHandler#DateFormatTransformer](http://wiki.apache.org/solr/DataImportHandler#DateFormatTransformer)